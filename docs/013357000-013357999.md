# StackOverflow 问答 13357000-13357999

# postgresql - 你怎么知道 PGBouncer 是否在工作？

> ID：13357005
> 
> 赞同：3
> 
> 时间：2012-11-13T07:34:33.940
> 
> 标签：postgresql, pgbouncer

我已经设置了 PGBouncer 并将其配置为连接到我的 postgres 数据库，并且一切都连接得很好，但是我不确定它是否真的有效。

我有一个 php 脚本，它作为守护进程运行并获取 beanstalk 作业。问题是对于系统上的每个不同的用户/操作，它都会打开一个与 postgres 的新连接，然后使该连接处于空闲状态，因为守护程序实际上并未停止运行，因此连接永远不会终止（对此的快速解决方法是重置脚本循环结束时的连接，但是对于许多连接来说效率很低）。

无论如何，这导致 postgres 最终耗尽连接并锁定......

所以 PGBouncer 似乎是答案。

但是现在当我运行它时，我在执行 ps ax | 时多次看到相同的数据库连接。grep postgres。

PGBouncer 不应该只打开 1 个连接到数据库并通过该连接路由所有流量吗？然后打开一个新连接，如果那个连接已满？

目前我有 3 个用于一个数据库连接（我的访问控制系统）和 2 个用于另一个数据库（我的客户端特定数据）。

对我来说，感觉就像如果我推出这些更改，那么我将面临同样的问题，即连接将再次被吃掉，因为它们没有被释放。

我希望这足以解释某人提供任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T07:46:34.697

听起来这里的一个重要步骤是修复脚本，以便它们在完成后释放连接。一旦你这样做了，PgBouncer 将有助于减少连接设置/拆除开销，但在连接池模式下，它不会让你能够维持比其他方式更多的 Pg 连接。

但是，您也可以在事务池模式下使用 PgBouncer。当用于事务池时，PgBouncer 会保留一个空闲后端事务池，并且仅在客户端执行`BEGIN`. `COMMIT`客户端执行 a或后，连接将返回到池中`ROLLBACK`。这意味着在事务池模式下，您可以拥有大量与 PgBouncer 的打开连接；它们并不都需要到 PostgreSQL 后端的相应连接，只要它们中的大多数在任何时间点都处于空闲状态并且没有任何事务打开。

事务池模式唯一真正的缺点是它破坏了期望`SET`会话级变量的应用程序，跨事务保留准备好的语句等。应用程序可能需要修改，例如使用`SET LOCAL`.

# c# - 调用特定打印机来打印 C# WPF

> ID：13357009
> 
> 赞同：4
> 
> 时间：2012-11-13T07:34:37.760
> 
> 标签：c#, wpf

我想调用特定的打印机在我的 WPF 应用程序中打印。我有三台打印机假设打印机 1 用于酒吧账单 打印打印机 2 用于厨房账单 打印打印机 3 用于客人账单 打印打印机名称已保存在数据库中，打印时我从数据库获取打印机名称并希望从特定打印机打印，而不是默认打印机这是我的代码

```
var v = new PrinterDAL().GetPrinterSettings();
try
{
   System.Threading.Thread thread = new System.Threading.Thread(new 
      System.Threading.ThreadStart(
            delegate()
            {   
                gridPrint.Dispatcher.Invoke(DispatcherPriority.Normal,
                    new Action(
                    delegate()
                    {
                            PrintDialog printDialog = new PrintDialog();
                            printDialog.PrintQueue = new PrintQueue(
                                new PrintServer(@"\\" + v.BarPrinter), "");
                            printDialog.PrintVisual(gridPrint, "");
                            this.Close();
                    }
                ));
            }
            ));
            thread.Start();
}
catch (Exception ex)
{
     Xceed.Wpf.Toolkit.MessageBox.Show(ex.Message, "", MessageBoxButton.OK, 
                                       MessageBoxImage.Error);
} 
```

我从这段代码中得到一个异常

“创建 PrintServer 对象时发生异常。Win32 错误：打印机名称无效。”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T08:43:03.187

PrintServer 必须是使用 UNC 格式 ( `\\resource`) 而非打印机名称的计算机或打印机服务器设备的实例：

例如，如果您的计算机名称在您的域中是 KashifPC，并且您已经配置了一台名为“Printer1”的打印机，您可以使用：

```
//example code. no error handling.
PrintServer localPS = New PrintServer(@"\\KashifPC")
PrinterQueue printer1 = localPS.GetPrintQueue("Printer1") //v.BarPrinter???
PrintDialog printDialog = new PrintDialog();
printDialog.PrintQueue = printer1
//rest of code 
```

# iphone - 控制 iPhone 应用程序在连接到旧 Web 服务时得到更新

> ID：13357010
> 
> 赞同：0
> 
> 时间：2012-11-13T07:34:41.847
> 
> 标签：iphone, ios, web-services, xamarin.ios, updates

我们正在寻求开发一个与客户站点内部托管的网络服务通信的 iPhone 应用程序。请注意，这是我们的第一个 iPhone 原生应用程序并使用 monotouch 来完成这项工作。

我们将定期维护代码并发布更新。但是，用户只需要根据他们的本地 Web 服务和后端进程更新所需的版本。例如，如果用户仍在使用版本 1 的 web 服务，则根本不需要更新 App，而版本 2 的用户需要更新到匹配的 App 等等。

我们想要控制更新过程，或者至少找到一个解决方案，如果用户更新到最新的应用程序，它不会因为连接的 web 服务过期而出现错误。

我们正在考虑以下过程，但似乎没有任何解决问题的方法。

1) 将应用留在应用商店，但根据 Web 服务版本以某种方式控制更新过程。因此，当用户尝试更新时，除非所需的 Web 服务可用，否则它不会更新。（烦人的部分是用户可能会提示有可用的更新，即使这些更新对他们来说是无关紧要的。）

2) 在 AppStore 之外控制更新。类似于内部开发的东西。

3）完全从客户端停止更新过程，只从webservices端触发更新。

```
i.e Inform the client that it needs to update when the webservices updated, and the client will run the update process at that point.

However, it could be tricky, if the customer's updated to the webservices version that is not the latest. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:42:38.443

我会提出第四个选项：不要控制/限制更新:)

发布一个使用 Wrapper 对象访问服务的应用程序，该对象在内部处理不同版本的 Web 服务。

* * *

除此之外。

*   1）不起作用（如果我明白你在做什么：试图影响应用商店更新）
*   2）听起来可行，如果你不关心应用商店，它可以工作
*   3）为什么？用户喜欢更新 :) + 会有严重的错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:35:18.137

1）没有办法用Apple的AppStore做你想做的事，一个应用程序可以更新或不能更新，你不能添加需要在设备本身上运行代码的额外条件。

2) 剩下的是内部企业部署——但这仅限于部署到您自己的公司，您不能以这种方式部署到不同的客户。

3）您无法停止应用程序的更新，因为更新应用程序时您无法运行代码。

有一个 4)，但它需要你做更多的工作：

4）让您的应用程序支持支持较旧的网络服务，或者通过用户可以设置的某种配置，或者查询网络服务的版本并相应地选择。这还有一个额外的好处，即可以首先将更新部署到所有设备，一旦所有设备都更新完毕，就可以更新 Web 服务。

# java - 多个运行时之间的文件输出？

> ID：13357015
> 
> 赞同：0
> 
> 时间：2012-11-13T07:35:43.760
> 
> 标签：java, xml, jaxb

我正在处理这个项目，用户输入一些写入 XML 文件的数据。这部分工作正常。现在，当用户运行程序时，他应该能够附加到该文件。相反，它会创建一个只有一个条目的新文件！文件输出流也不是解决方案。

这是序列化为 XML 的代码

```
String medicine=medicfield.getText();
    String doctor=dnamefield.getText();
    int duration=Integer.parseInt(dodfield.getText());
    int amount=Integer.parseInt(cyclefield.getText());

    int inter=Integer.parseInt(intval.getText());
    PrescripManager pm=new PrescripManager();
    pm.setDcycle(amount);
    pm.setDosage(duration);
    pm.setInterval(inter);
    pm.setmedName(medicine);
    pm.setdocName(doctor);

    try{
        FileOutputStream file = new FileOutputStream("file.xml");

    JAXBContext jaxbContext = JAXBContext.newInstance(PrescripManager.class);
    Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

    // output pretty printed

    jaxbMarshaller.marshal(pm, file);

    }
    catch(Exception ex)
    {
    erlbl.setText(ex.getMessage());
    } 
```

和类::

```
@XmlRootElement
public class PrescripManager {
private String medname,docname;
private int interval,dcycle,dosage;
private Date dt;
public String getmedName() {
    return medname;
}

public void setmedName(String medname) {
    this.medname = medname;
}
public String getdocName() {
    return docname;
}

public void setdocName(String docname) {
    this.docname = docname;
}
public int getInterval() {
    return interval;
}

public void setInterval(int interval) {
    this.interval = interval;
}
public int getDcycle() {
    return dcycle;
}

public void setDcycle(int dcycle) {
    this.dcycle = dcycle;
}
 public int getDosage() {
    return dosage;
}

public void setDosage(int dosage) {
    this.dosage = dosage;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:25:42.627

首先，您正在编写一个 XML 文件。您不能只附加到 XML 文件，因为这意味着您在关闭顶级标签之后编写，导致 XML 文件无效。

你至少有三个选择：

*   读入旧文件，添加到实际数据，然后写回整个 XML 文件。
*   写入多个文件，每个文件都是有效的 XML 文件，文件名中带有序列号或时间戳。
*   不要使用 XML，使用可以附加到的格式

附带说明，如果要附加到文件，可以在附加模式下打开它。这将使对它的每次写入都附加（至少在 Unix 上，当文件以附加模式打开时，我认为它在 Windows 中的工作方式相同）。

如何在 Java 中以附加模式打开文件：[http://docs.oracle.com/javase/6/docs/api/java/io/FileOutputStream.html#FileOutputStream(java.io.File, boolean)](http://docs.oracle.com/javase/6/docs/api/java/io/FileOutputStream.html#FileOutputStream%28java.io.File,%20boolean%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:47:57.020

您正在使用 JAXB 处理 XML 文件，因此最好更改您的 XML 文件格式和 Java 类以支持它。

您可以添加一个新类作为`PrescripManager`类实例的集合。类似的东西`PrescripManagerList`。

```
public class PrescripManagerList{

  @XmlElementWrapper(name = "prescripManagers")
  @XmlElement(name = "prescripManager")
  private ArrayList<PrescripManager> prescripManagers;
} 
```

运行代码时，尝试使用 JAXB 解组器读取现有 XML 文件以获取`PrescripManagerList`对象，然后将新`PrescripManager`对象添加到`ArrayList`，然后使用 JAXB 编组器将更新的`PrescripManagerList`对象写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:17:57.990

您可以使用允许您在文件末尾写入的“FileWriter”类。看

[http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html](http://docs.oracle.com/javase/6/docs/api/java/io/FileWriter.html)

此链接应该可以帮助您：

[http://www.coderanch.com/t/276346//java/do-open-file-append-mode](http://www.coderanch.com/t/276346//java/do-open-file-append-mode)

我认为如果你使用它应该可以工作

```
FilterWriter file = new FileWriter( "file.xml" , true ); 
```

代替

```
FileOutputStream file = new FileOutputStream("file.xml"); 
```

# javascript - 从 Chrome 扩展弹出窗口中获取价值

> ID：13357016
> 
> 赞同：6
> 
> 时间：2012-11-13T07:36:00.560
> 
> 标签：javascript, html, google-chrome

我想知道，如果我有一个 chrome 扩展程序，当您单击图标时会弹出一个弹出窗口，并且该弹出窗口有一个用于输入数据的文本框，那么 javascript 在文本框中获取文本会是什么样子？

更新：我知道如何从文本框中获取值，但我的问题是，我如何专门访问我的 popup.html 文件的元素？我尝试访问 document.getElementById 等，但它获取实际页面内容中的元素，而不是我的自定义弹出窗口。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-03-26T09:04:38.910

我们可以通过以下方式为某些事件（例如按钮的单击事件）绑定事件侦听器，从弹出页面的文本框中获取值：

假设 manifest.json 文件是这样的：

```
{
  "manifest_version": 2,

  "name": "Wonderful extension",
  "description": "Wonderful extension - gets value from textbox",
  "version": "1.0",

  "browser_action": {
   "default_icon": "images/icon.png",
   "default_popup": "popup.html"
  } 
} 
```

popup.html 是这样的：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Wonderful Extension</title>
    <script src="popup.js"></script>     
  </head>
  <body>   

    <div style="padding: 20px 20px 20px 20px;">           
        <h3>Hello,</h3>
        <p>Please enter your name : </p>         
        <input id="name_textbox" />                   
         <button id="ok_btn" type="button">OK</button>
    </div>      

  </body>
</html> 
```

然后我们可以通过以下方式绑定文档中的事件以从文本框中获取值：

文件 popup.js ：

```
document.addEventListener('DOMContentLoaded', documentEvents  , false);

function myAction(input) { 
    console.log("input value is : " + input.value);
    alert("The entered data is : " + input.value);
    // do processing with data
    // you need to right click the extension icon and choose "inspect popup"
    // to view the messages appearing on the console.
}

function documentEvents() {    
  document.getElementById('ok_btn').addEventListener('click', 
    function() { myAction(document.getElementById('name_textbox'));
  });

  // you can add listeners for other objects ( like other buttons ) here 
} 
```

要访问弹出页面的其他元素，我们可以使用类似的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-20T02:05:26.420

也可以这样使用 chrome.storage.sync：

```
function handleButtonClick(){
   // Use stored sync value.
   chrome.storage.sync.get("textBoxValue", ({ textBoxValue }) => {
      alert(textBoxValue);
   });
}

document.getElementById("popupButton").addEventListener("click", async () => {
   let [tab] = await chrome.tabs.query({ active: true, currentWindow: true });

   // Store sync value before the script is executed.
   let textBoxValue = document.getElementById('textBox').value;
   chrome.storage.sync.set({ textBoxValue });

   chrome.scripting.executeScript({
       target: { tabId: tab.id },
       function: handleButtonClick,
   });
}); 
```

# c - 如何知道 Linux 系统调用是否可重新启动？

> ID：13357019
> 
> 赞同：12
> 
> 时间：2012-11-13T07:36:17.310
> 
> 标签：c, linux, posix, system-calls

`SA_RESTART`根据 man [signal(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/signal.7.html) ，如果在安装信号处理程序时使用了标志，则内核可以透明地重新启动一些系统调用：

> 如果对以下接口之一的阻塞调用被信号处理程序中断，**则如果使用了 SA_RESTART 标志，则在信号处理程序返回后将自动重新启动调用**；否则调用将失败并出现错误 EINTR：

然后它提到了一些可以（也不能）重新启动的系统调用，但`close()`在任何一个地方都没有提到，我怎么知道`close()`或任何其他功能是否可重新启动？确实`POSIX`指定了它还是特定于 Linux 的行为？我在哪里可以找到更多信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T02:52:45.547

`close`是一个比较特殊的情况。它不仅不能在 Linux 上重新启动；当在 Linux 上`close`返回时`EINTR`，它实际上已经成功，并且在单线程进程中再次调用`close`将失败，并`EBADF`在多线程进程中导致极其危险的文件描述符竞争。

从发布的 POSIX 2008 开始，允许这种行为：

> 如果 close() 被要捕获的信号中断，它应返回 -1 并将 errno 设置为 [EINTR] 并且 fildes 的状态未指定。

这个问题是由 Austin Group 提出的（作为[Issue #529](http://austingroupbugs.net/view.php?id=529)），并已解决修改规范，以便返回 with`EINTR`表示文件描述符仍然打开；这与当前的 Linux 行为相反。如果在处理信号时文件描述符已经关闭，则该`close`函数现在需要返回`EINPROGRESS`而不是`EINTR`. 这可以在 Linux 的用户空间中修复，并且有一个开放的[glibc 错误报告，#14627](http://sourceware.org/bugzilla/show_bug.cgi?id=14627)，但截至撰写本文时，它还没有收到任何回复。

这个问题对 POSIX 线程取消也有严重影响，其副作用是根据返回时的副作用来指定的`EINTR`。Austin Group 跟踪器上有一个相关问题，[问题 #614](http://austingroupbugs.net/view.php?id=614)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-13T08:09:42.743

根据[POSIX.1-2008](http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html)，该`SA_RESTART`标志适用于所有可中断函数（所有记录失败的函数`EINTR`）：

> SA_RESTART
> 
> 该标志影响可中断函数的行为；也就是说，那些指定为失败且 errno 设置为 [EINTR] 的。如果设置，并且指定为可中断的功能被此信号中断，则该功能应重新启动，并且除非另有说明，否则不应因 [EINTR] 而失败。如果重新启动使用超时的可中断函数，则重新启动后的超时持续时间将设置为不超过原始超时值的未指定值。如果未设置该标志，则被此信号中断的可中断功能将失败，并将 errno 设置为 [EINTR]。

也就是说，未重新启动的函数列表是特定于 Linux 的（并且可能算作一个错误）。

# git - 我使用的 Git 代码删除了所有内容

> ID：13357020
> 
> 赞同：0
> 
> 时间：2012-11-13T07:36:20.153
> 
> 标签：git

我尝试了一个解决我遇到的 git 问题的方法：

> 从当前目录开始，通过递归删除不受版本控制的文件来清理工作树。
> 
> ```
> -d = Remove untracked directories in addition to untracked files
> -f = Force (might be not necessary depending on clean.requireForce setting) 
> ```
> 
> 运行 git help clean

是否可以取回我的更改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T07:42:17.130

您的更改将永远丢失。`git clean -d`完全清除更改（对于未跟踪的文件）。

您唯一能做的就是在终端中向上滚动，希望能看到最近`git diff`的一个。
另一种选择是恢复已删除的未跟踪文件。

下次，在进行任何危险操作之前，我建议您创建一个独立的补丁文件，以便在遇到问题时轻松重新应用它。

# php - 重定向到另一个域并显示一个不存在的 url

> ID：13357022
> 
> 赞同：0
> 
> 时间：2012-11-13T07:36:39.967
> 
> 标签：php, .htaccess, mod-rewrite, redirect

不确定之前是否有人问过这个问题，因为我一直在搜索和阅读 htaccess 编码并尝试它，但没有运气。

我有一个域 abc.com.sg 并有一个 php 重定向脚本，可以立即将用户重定向到 abc.com。问题是，我希望他们看到他们已被重定向到 abc.com/sg/，同时仍显示来自 abc.com 的内容。

我知道这可以通过某种 modrewrite 来完成。这是某种相似但属于同一个域，我在技术上是同一服务器上的不同域。[重定向但不显示 URL redirec :: htaccess？](https://stackoverflow.com/questions/12391661/redirect-but-not-show-the-url-redirec-htaccess).

谢谢。

# java - RESTful Web 服务，如何铺设路径

> ID：13357029
> 
> 赞同：2
> 
> 时间：2012-11-13T07:37:02.710
> 
> 标签：java, web-services, jakarta-ee, jax-rs

我正在创建一个遵循 REST 样式的 Web 服务，所以我使用的是 JAX-RS。但是，问题是更一般的形式，因此技术无关紧要。

假设您的系统中有三个资源。测验、问题和问题反馈。现在假设您为 Quiz 资源创建了一个路径：`/quiz`

一个测验对象有一个问题列表，每个问题都有一个反馈列表。

我也有问题的路径：`/questions`您可以`POST`就问题对子资源（这是正确的术语吗？）进行反馈，所以让我们说：`/question/1/feedback`.

但是，这条路径是否也可以通过测验获得？对此是否有任何规则，或者这取决于开发人员（当然是..，但这是通常的）？

示例：`/quiz/questions/1/feedback`。我想问的是边界在哪里。您是否应该在嵌套路径中提供相同的操作，就像它们是“顶级”路径时一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:28:57.577

我们一直在我们的 Web 服务实现中使用组合与聚合规则。基本前提是组合资源的生命周期完全由其父资源管理。而那些聚合的仅从关联的角度进行管理

因此，给定一个父资源，我们（通常）将 HTTP 动词映射到子资源上的管理操作，如下所示：

```
           组合       聚合
POST 创建关联
GET 读读
PUT 更新重新关联
DELETE 删除 解除关联

```

对于复合 GET，我们定义了足够的端点来完全查询子资源。对于聚合的 GET，我们只返回足够的信息来定义实际的端点来进行完整的查询。

Som 如果我们编写一个 Quiz API，我们会有

*   /测验/问题/1
*   /问题/1
*   /问题/1/反馈

但不是：

*   /测验/问题/1/反馈

# c# - 使用按钮大小制作背景图像

> ID：13357032
> 
> 赞同：6
> 
> 时间：2012-11-13T07:37:18.703
> 
> 标签：c#, winforms, user-interface

我正在尝试向我的 Win Forms 应用程序中的几个按钮添加一些背景图像。这三个图像的大小不同（即像素尺寸不匹配，一个是 128x128，另一个是 256x256）。我需要按钮大小相同（否则 GUI 非常不对称）。在不更改实际图像文件的情况下，如何使图像随按钮大小缩放？

我尝试创建自己的类，并为按钮调整大小事件添加事件处理程序，但这似乎不起作用。我的代码：

```
class CustomButton : Button {

        internal void CustomButton_Resize( object sender, EventArgs e ) {
            if ( this.BackgroundImage == null ) {
                return;
            }

            var pic = new Bitmap( this.BackgroundImage, this.Width, this.Height );
            this.BackgroundImage = pic;
        }
    } 
```

并采用以下形式：

```
this.buttonOne.Resize += new System.EventHandler(this.buttonOne.CustomButton_Resize); 
```

忘了提一下，上面的代码根本没有调整图像的大小。按钮仍然需要具有不同的大小才能完全显示图像。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-06T23:35:54.563

**将背景图像添加到 .NET Button 对象并将其缩放以适合的最简单方法**

我使用这种方法来避免对新类和事件处理程序进行任何额外的编码。这也帮助我避免将所有 Button 对象转换为 Image 对象。

1.  将图像添加到 Resources.resx 文件。

2.  单击您选择的按钮。

3.  导航到`BackgroundImage`属性并选择您导入到项目的 resources.resx 文件中的图像。

4.  导航到`BackgroundImageLayout`属性并选择`Stretch`。

确保您没有为`Image`and`Text`属性输入任何内容，否则它们会干扰您的新背景图像。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-13T12:41:51.987

**简单的程序化方式**

假设我有一个按钮`btn1`，以下代码在 visual-studio-2010 中运行良好。

```
private void btn1_Click(object sender, EventArgs e)
{
    btn1.Width = 120;
    btn1.Height = 100;
}
void btn1_Resize(object sender, EventArgs e)
{
    if ( this.BackgroundImage == null )
          return;
    var bm = new Bitmap(btn1.BackgroundImage, new Size(btn1.Width, btn1.Height));
    btn1.BackgroundImage = bm;
} 
```

**更好的方法**

您可以在自定义按钮的构造函数中添加 eventHandler（只是为了确保您正确添加事件处理程序）

```
class CustomButton : Button
{    
    CustomButton()
    {
        this.Resize += new System.EventHandler(buttonOne.CustomButton_Resize);
    }
    void CustomButton_Resize( object sender, EventArgs e )
    {
       if ( this.BackgroundImage == null )
          return;
       var pic = new Bitmap( this.BackgroundImage, new Size(this.Width, this.Height) );
       this.BackgroundImage = pic;          
    }
} 
```

现在，当您在任何地方调整按钮大小时，您的图像将适合（缩放）到其新大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T08:36:42.453

你可以从这样的事情开始......

```
 public class ImageButton : Control
{
    public Image backgroundImage;

    public Image BackgroundImage
    {
        get
        {
            return backgroundImage;
        }
        set
        {
            backgroundImage = value;
            Refresh();
        }
    }

    public ImageButton()
    {

    }

    protected override void OnPaint(PaintEventArgs e)
    {
        e.Graphics.Clear(BackColor);

        if(BackgroundImage != null)
            e.Graphics.DrawImage(BackgroundImage, 0, 0, Width, Height);

        base.OnPaint(e);
    }

    protected override void OnPaintBackground(PaintEventArgs pevent)
    {
        //base.OnPaintBackground(pevent);
    }
} 
```

您可以自己处理油漆并绘制图像。您也可以尝试使用 PictureBox 或其他具有更多缩放选项的控件

# python - 如何在 python 中将 UTF8 十六进制转换为 Unicode 代码点

> ID：13357034
> 
> 赞同：0
> 
> 时间：2012-11-13T07:37:26.407
> 
> 标签：python, unicode, utf-8, iconv, emoji

我正在制作一个配置文件，其中包含表情符号的 Unicode 和 SoftBank Unicode 的映射。现在我正在使用 python 程序从[http://punchdrunker.github.com/iOSEmoji/table_html/ios6/index.html获取这些信息](http://punchdrunker.github.com/iOSEmoji/table_html/ios6/index.html)

但是有个问题，网页上的SoftBank Code是UTF8 hex，不是Unicode codepoint，怎么改成Unicode codePoint？

比如我想把EE9095改成E415（第一个emoji表情）

我试着这样做，但它没有用

```
code.decode('utf-8') 
```

但它只是没有用，代码是一样的，没有改变。unix 命令 iconv 也不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T10:00:04.177

这个怎么样：

```
>>> 'EE9095'.decode('hex').decode('utf-8')
<<< u'\ue415' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T07:45:30.867

你确定`code`实际上是用 UTF-8 编码的吗？这对我有用：

```
>>> b'\xee\x90\x95'.decode('utf-8')
u'\ue415' 
```

# mysql - 根据多个表选择数据的Mysql UPDATE

> ID：13357037
> 
> 赞同：3
> 
> 时间：2012-11-13T07:37:44.797
> 
> 标签：mysql, sql, phpmyadmin

我写了一个`SELECT`查询来选择特定的值，基本上它只选择所有 3 个表中的数据。

但是当我尝试更新时，它仍然会更新比应有的更多数据（行）

这里是选择

```
SELECT 
    i.id, i.group_id, i.name, u.item, u.value, u.shows, u.nr, u.type
FROM 
    items AS i
INNER JOIN 
    item_groups, item_properties2 AS u ON item_groups.id = i.group_id
WHERE 
    item_groups.idp = '1140503406'
    AND i.id = u.item
    AND u.type = 1140614900
LIMIT 
    30, 3000 
```

这是更新

```
UPDATE item_properties2 AS P
INNER JOIN items ON items.id = P.item
INNER JOIN item_groups ON item_groups.idp = '1140503406'
SET P.nr = '0'
WHERE
    P.type = 1140614900` 
```

似乎它忽略了我的 item_groups.idp = '1140503406' 而是更新其中的所有内容，而不仅仅是这个值。我不知道如何理解它应该只更新数据，如果它的 item_groups.idp = '1140503406' 而不是所有的 item_groups.idp。

帮助

样本数据

```
CREATE TABLE IF NOT EXISTS `item_groups` (
  `id` int(11) NOT NULL default '0',
  `idp` int(11) default '0',
  `text_id` int(10) unsigned default NULL,
  `name` text NOT NULL,
  `nr` int(11) default '0',
  `title` text,
  `description` text,
  `keywords` text,
  `seo_title` text,
  `seo_description` text,
  `seo_keywords` text,
  `active` tinyint(1) unsigned NOT NULL default '1',
  `type` tinyint(2) unsigned NOT NULL default '0',
  `ord_alias` varchar(128) NOT NULL default '',
  `another_title` text NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `idp` (`idp`)
) TYPE=MyISAM;

(1339999485, 1306487541, 0, 'Scandomestic||||||||{lv}', 20, NULL, '||||||||{lv}', NULL, 'Šaldytuvai vitrinos, šaldymo vitrinos, šaldytuvas vitrina, šaldymo vitrina||||||||{lv}', 'Šaldytuvai vitrinos, šaldymo vitrinos, Šalna — šaldytuvai pramonei, šaldikliai pramonei, šaldymo skrynios, šaldytuvai vitrinos, šaldymo vitrinos, šaldymo spintos, Minsk, Polair, Snaige||||||||{lv}', 'Šaldytuvai vitrinos, šaldymo vitrinos, Šalna, šaldytuvai pramonei, šaldikliai pramonei, šaldymo skrynios, šaldytuvai vitrinos, šaldymo vitrinos, šaldymo spintos, Minsk, Polair, Snaige||||||||{lv}', 1, 0, '003_003_009_020', '||||||||{lv}'),
(1340000121, 1273586684, 0, 'Šaldymo stalai||Refrigeration tables||??????????? ???????||||{lv}Saldešanas galdi', 6, NULL, '||||||||{lv}', NULL, 'Šaldymo stalai, šaldymo stalai||||||||{lv}', 'Šaldymo stalai, Šalna — šaldytuvai pramonei, šaldikliai pramonei, šaldymo skrynios, šaldytuvai vitrinos, šaldymo vitrinos, šaldymo spintos, Electrolux, Liebherr, Whirlpool, šaldymo iranga, šaldymo kameros, šaldymo vitrinos||||||||{lv}', 'šaldymo iranga, Šaldymo skrynios, Šalna, šaldytuvai pramonei, šaldikliai pramonei, šaldymo skrynios, šaldytuvai vitrinos, šaldymo vitrinos, šaldymo spintos, Electrolux, Liebherr, Whirlpool, šaldymo iranga, šaldymo kameros, šaldymo vitrinos||||||||{lv}', 1, 2, '003_006', '||||||||{lv}'),
(1340114091, 1140503406, 0, 'Panasonic||||||||{lv}', 45, NULL, '||||||||{lv}', NULL, '||||||||{lv}', '||||||||{lv}', '||||||||{lv}', 1, 0, '002_001_045', '||||||||{lv}'),
(1340351314, 1339500892, 0, 'Mawi||Mawi||Mawi||||{lv}Mawi', 209, NULL, '||||||||{lv}', NULL, '||||||||{lv}', '||||||||{lv}', '||||||||{lv}', 1, 2, '003_004_018_209', '||||||||{lv}'),
(1340687392, 1140503406, 0, 'UPO||||||||{lv}', 47, NULL, '||||||||{lv}', NULL, 'Sharp||Sharp||Sharp||||{lv}', 'Sharp šaldytuvas-šaldiklis||Sharp fridges||Sharp||||{lv}', 'Sharp, šaldytuvas, šaldytuvai, šaldikliai, šaldiklis, šaldymo iranga, šaldymo iranga buiciai||Sharp, fridges, freezers||Sharp||||{lv}', 1, 0, '002_001_047', '||||||||{lv}');

DROP TABLE IF EXISTS `item_properties2`;

CREATE TABLE IF NOT EXISTS `item_properties2` (
  `id` int(11) NOT NULL auto_increment,
  `type` int(11) default NULL,
  `item` int(11) default NULL,
  `value` text,
  `shows` int(11) default NULL,
  `nr` int(11) default NULL,
  PRIMARY KEY  (`id`)
) TYPE=MyISAM AUTO_INCREMENT=78180 ; 
```

--

## -- 为表转储数据`item_properties2`

```
INSERT INTO `item_properties2` (`id`, `type`, `item`, `value`, `shows`, `nr`) VALUES
(44774, 1140614843, 1146145783, '30', 0, 6),
(44775, 1140764279, 1146145783, '+1°C - +65°C', 1, 7),
(44776, 1140614891, 1146145783, 'Deže (išore ir vidus): šviesiai pilka/tamsiai pilka; dangtis: šviesiai pilka.', 1, 8),
(42360, 1140614891, 1242137094, 'Nerudijancio plieno', 1, 8),
(42361, 1140614900, 1242137094, 'Japonija', 1, 9),
(46368, 1140764407, 1209560120, 'Erdve 2l buteliui, šaldytuvas gali buti pastatomas vertikaliai, šaldymo - šildymo funkcijos.', 1, 10),
(44874, 1140614900, 1250520801, 'Vokietija', 1, 9),
(46380, 1146127137, 1277976190, 'Waeco CoolMatic CDF-035', 0, 0),
(46367, 1140614900, 1209560120, 'Vokietija', 1, 9),
(46366, 1140614891, 1209560120, 'Juoda / balta', 1, 8),
(44730, 1140614900, 1146144811, 'Vokietija', 1, 9),
(44728, 1140614891, 1146144811, 'Deže (išore ir vidus): šviesiai pilka, dangtis: tamsiai pilka', 1, 8),
(44727, 1140764279, 1146144811, '+1°C - +65°C', 1, 7),
(44726, 1140614843, 1146144811, '19', 0, 6),
(44725, 1140614826, 1146144811, '33', 0, 5),
(44724, 1140614802, 1146144811, '28', 0, 4),
(44723, 1157531440, 1146144811, '36 W', 0, 3),
(44721, 1140614775, 1146144811, '12/230 voltu DC/AC', 0, 1),
(44669, 1140764407, 1146140235, 'Šviesa viduje, elektroninis valdymas, patogios rankenos nešimui, erdve 2 l buteliui, išimamas metalinis krepšys', 1, 10),
(44668, 1140614900, 1146140235, 'Vokietija', 1, 9),
(44665, 1140764279, 1146140235, '+10 iki -18 (nustatoma elektroniniu termostatu)', 1, 7),
(44666, 1140614891, 1146140235, 'Tamsiai/šviesiai pilka', 1, 8),
(78120, 1140614792, 1352201554, '327', 1, 5),
(25927, 1140614900, 1176359569, 'USA', 0, 7),
(25926, 1141204836, 1176359569, 'yra', 0, 6),
(44664, 1140614843, 1146140235, '58', 0, 6),
(44653, 1140614900, 1146137735, 'Vokietija', 1, 9),
(44651, 1140614891, 1146137735, 'Tamsiai/šviesiai pilka', 1, 8),
(44648, 1140614826, 1146137735, '36', 0, 5),
(44647, 1140614802, 1146137735, '38,5', 0, 4),
(44707, 1146127137, 1207641727, 'Waeco Coolfreeze CF-110 AC', 0, 0),
(44682, 1140764407, 1207639997, 'Šviesa viduje, elektroninis valdymas, nuimamos rankenos nešimui, erdve 2 l buteliui', 1, 10),
(44680, 1140614900, 1207639997, 'Vokietija', 1, 9),
(44679, 1140614891, 1207639997, 'pilka', 1, 8),
(44678, 1140764279, 1207639997, '+10 iki -18', 1, 7),
(44677, 1140614843, 1207639997, '63', 0, 6),
(44676, 1140614826, 1207639997, '36', 0, 5),
(44675, 1140614802, 1207639997, '48', 0, 4),
(44674, 1157531440, 1207639997, 'Vidut. 45W', 0, 3),
(44673, 1140614792, 1207639997, '49', 0, 2),
(22032, 1140764407, 1146135011, 'Patogi rankena, mechaninis valdymas', 1, 10),
(22029, 1140614891, 1146135011, 'Tamsiai/šviesiai pilka', 1, 8),
(22031, 1140614900, 1146135011, 'Vokietija', 1, 9),
(22007, 1140764407, 1146133201, 'DC pajungimo laidas', 1, 10),
(22006, 1140614900, 1146133201, 'Vokietija', 1, 9),
(22028, 1140764279, 1146135011, '+10 iki -18 (nustatoma elektroniniu termostatu)', 1, 7),
(22027, 1140614843, 1146135011, '46.5', 0, 6),
(22026, 1140614826, 1146135011, '30', 0, 5),
(22025, 1140614802, 1146135011, '41.4', 0, 4),
(22004, 1140614891, 1146133201, 'Tamsiai/šviesiai pilka', 1, 8),
(22003, 1140764279, 1146133201, 'nuo +10 iki -18 (nustatoma elektroniniu termostatu)', 1, 7),
(22002, 1140614843, 1146133201, '56', 0, 6),
(22001, 1140614826, 1146133201, '34', 0, 5),
(22000, 1140614802, 1146133201, '47.5', 0, 4),
(21999, 1157531440, 1146133201, 'Vidut. 45W', 0, 3),
(21998, 1140614792, 1146133201, '39', 0, 2),
(46390, 1140764407, 1277976190, 'Šviesa viduje, elektroninis valdymas, patogios rankenos nešimui, erdve 2 l buteliui, išimamas metalinis krepšys', 1, 10),
(21997, 1140614775, 1146133201, '12/24 DC', 0, 1),
(46389, 1140614900, 1277976190, 'Vokietija', 1, 9),
(46388, 1140614891, 1277976190, 'Tamsiai/šviesiai pilka', 1, 8),
(46387, 1140764279, 1277976190, '+10 iki -18 (nustatomas elektroniniu termostatu)', 1, 7),
(42201, 1140764407, 1224489821, '', 1, 8),
(46110, 1140764407, 1140784557, '1 durys, 6 stalciai', 1, 11),
(42066, 1140614900, 1140784557, 'Baltarusija', 1, 9),
(42067, 1140614900, 1140784557, 'Baltarusija', 1, 10),
(46386, 1140614843, 1277976190, '56', 0, 6),
(46385, 1140614826, 1277976190, '34', 0, 5),
(46383, 1157531440, 1277976190, 'Vidut. 45 W', 0, 3),
(42065, 1140614891, 1140784557, 'balta', 1, 8),
(43302, 1140614900, 1140788581, 'Lietuva', 1, 9),
(43471, 1140614900, 1140790207, 'Lietuva', 1, 9),
(43470, 1140614891, 1140790207, 'balta', 1, 8),
(43469, 1140771001, 1140790207, '245', 1, 7),
(43468, 1140784675, 1140790207, '-', 1, 6),
(43467, 1140614792, 1140790207, '245', 1, 5),
(43466, 1140614843, 1140790207, '60', 0, 4),
(43465, 1140614826, 1140790207, '60', 0, 3),
(43464, 1140614802, 1140790207, '145', 0, 2),
(43463, 1140770892, 1140790207, '0.73', 0, 1),
(43462, 1140614720, 1140790207, 'A', 0, 0),
(53894, 1140771001, 1304447043, '-', 1, 7),
(43448, 1140614900, 1140789961, 'Lietuva', 1, 9),
(43447, 1140614891, 1140789961, 'Balta', 1, 8),
(43446, 1140771001, 1140789961, '100', 1, 7),
(43445, 1140784675, 1140789961, '-', 1, 6),
(43444, 1140614792, 1140789961, '100', 1, 5),
(43443, 1140614843, 1140789961, '60', 0, 4),
(43442, 1140614826, 1140789961, '56', 0, 3),
(43441, 1140614802, 1140789961, '85', 0, 2),
(43460, 1140614900, 1140786679, 'Lietuva', 1, 9),
(43459, 1140614891, 1140786679, 'balta', 1, 8),
(43458, 1140771001, 1140786679, '245', 1, 7),
(43457, 1140784675, 1140786679, '-', 1, 6),
(43456, 1140614792, 1140786679, '245', 1, 5),
(43455, 1140614843, 1140786679, '60', 0, 4),
(43454, 1140614826, 1140786679, '60', 0, 3),
(43453, 1140614802, 1140786679, '145', 0, 2),
(43452, 1140770892, 1140786679, '0.73', 0, 1),
(43451, 1140614720, 1140786679, 'A', 0, 0),
(23707, 1140614900, 1140786959, 'Italija ', 1, 10),
(23706, 1140614891, 1140786959, 'balta ', 1, 9),
(23705, 1140771001, 1140786959, '140 ', 1, 8),
(23704, 1140784675, 1140786959, '-', 1, 7),
(23703, 1140614792, 1140786959, '140 ', 1, 6),
(23702, 1140614843, 1140786959, '60 ', 0, 5),
(23701, 1140614826, 1140786959, '60 ', 0, 4),
(23700, 1140614802, 1140786959, '105 ', 0, 3),
(23699, 1140770892, 1140786959, '0.84 ', 0, 2),
(23698, 1140614720, 1140786959, 'B ', 0, 1),
(23696, 1140614909, 1140787174, 'Rusija ', 1, 11),
(23695, 1140614900, 1140787174, 'Italija ', 1, 10),
(23694, 1140614891, 1140787174, 'balta ', 1, 9),
(23693, 1140771001, 1140787174, '275 ', 1, 8),
(23692, 1140784675, 1140787174, '-', 1, 7),
(23691, 1140614792, 1140787174, '275 ', 1, 6),
(23690, 1140614843, 1140787174, '60 ', 0, 5),
(23689, 1140614826, 1140787174, '60 ', 0, 4),
(23688, 1140614802, 1140787174, '167 ', 0, 3),
(23687, 1140770892, 1140787174, '1.1 ', 0, 2),
(23686, 1140614720, 1140787174, 'B ', 0, 1),
(23717, 1140614891, 1140787419, 'balta ', 1, 9),
(23716, 1140771001, 1140787419, '275 ', 1, 8),
(23715, 1140784675, 1140787419, '-', 1, 7),
(23714, 1140614792, 1140787419, '275 ', 1, 6),
(23713, 1140614843, 1140787419, '60 ', 0, 5),
(23712, 1140614826, 1140787419, '60 ', 0, 4),
(23711, 1140614802, 1140787419, '167 ', 0, 3),
(23710, 1140770892, 1140787419, '1.1 ', 0, 2),
(23709, 1140614720, 1140787419, 'B ', 0, 1),
(43785, 1140764407, 1159857676, 'Plasmacluster technologija, greito šaldymo funkcija.', 1, 10),
(43783, 1140614900, 1159857676, 'Japonija', 1, 9),
(43782, 1140614891, 1159857676, 'Sidabro', 1, 8),
(43781, 1140771001, 1159857676, '215', 1, 7),
(43780, 1140784675, 1159857676, '358', 1, 6),
(41632, 1140614900, 1140787900, 'Kinija', 1, 8),
(41631, 1140614891, 1140787900, 'balta||white', 1, 7),
(41630, 1140771001, 1140787900, '-', 1, 6),
(41629, 1140784675, 1140787900, '-', 1, 5),
(41628, 1140614792, 1140787900, '45', 1, 4),
(41627, 1140614826, 1140787900, '44', 0, 3),
(41626, 1140614802, 1140787900, '82', 0, 2),
(41625, 1140770892, 1140787900, '0.8', 0, 1),
(41624, 1140614720, 1140787900, 'A', 0, 0),
(42079, 1140764407, 1140788111, '1 durys, tik šaldytuvas be šaldiklio.', 1, 10),
(42077, 1140614900, 1140788111, 'Baltarusija', 1, 9),
(42076, 1140614891, 1140788111, 'Balta', 1, 8),
(42075, 1140771001, 1140788111, '-', 1, 7),
(42074, 1140784675, 1140788111, '285', 1, 6),
(42073, 1140614792, 1140788111, '285', 1, 5),
(42072, 1140614843, 1140788111, '60', 0, 4),
(42071, 1140614826, 1140788111, '60', 0, 3),
(42070, 1140614802, 1140788111, '150', 0, 2),
(42759, 1140614900, 1140788367, 'Lietuva', 1, 9),
(42758, 1140614891, 1140788367, 'balta', 1, 8),
(42757, 1140771001, 1140788367, '-', 1, 7),
(42756, 1140784675, 1140788367, '127', 1, 6),
(42755, 1140614792, 1140788367, '127', 1, 5),
(42754, 1140614843, 1140788367, '60', 0, 4),
(42753, 1140614826, 1140788367, '56', 0, 3),
(43293, 1140614720, 1140788581, 'A', 0, 0),
(43294, 1140770892, 1140788581, '0.46', 0, 1),
(43301, 1140614891, 1140788581, 'balta', 1, 8),
(43300, 1140771001, 1140788581, '-', 1, 7),
(43299, 1140784675, 1140788581, '275', 1, 6),
(42191, 1140614900, 1140788826, 'Baltarusija', 1, 9),
(42190, 1140614891, 1140788826, 'balta', 1, 8),
(42189, 1140771001, 1140788826, '115', 1, 7),
(42188, 1140784675, 1140788826, '220', 1, 6),
(42187, 1140614792, 1140788826, '335', 1, 5),
(42186, 1140614843, 1140788826, '60', 0, 4),
(42185, 1140614826, 1140788826, '60', 0, 3),
(42184, 1140614802, 1140788826, '176', 0, 2),
(42179, 1140614900, 1140789085, 'Baltarusija', 1, 9),
(42178, 1140614891, 1140789085, 'balta', 1, 8),
(42177, 1140771001, 1140789085, '80', 1, 7),
(42176, 1140784675, 1140789085, '268', 1, 6),
(42175, 1140614792, 1140789085, '348', 1, 5),
(42174, 1140614843, 1140789085, '60', 0, 4),
(43522, 1140614891, 1140789239, 'balta ', 1, 9),
(43521, 1140771001, 1140789239, '- ', 1, 8),
(43520, 1140784675, 1140789239, '245 ', 1, 7),
(43519, 1140614792, 1140789239, '245 ', 1, 6),
(43518, 1140614843, 1140789239, '60 ', 0, 5),
(43517, 1140614826, 1140789239, '60 ', 0, 4),
(43516, 1140614802, 1140789239, '131 ', 0, 3),
(43515, 1140770892, 1140789239, '1,2 ', 0, 2),
(43514, 1140614720, 1140789239, 'B ', 0, 1),
(46661, 1140614826, 1283262225, '', 1, 1),
(41743, 1140784675, 1224573246, '106', 1, 6),
(43500, 1140614900, 1228469272, 'Vokietija', 1, 9),
(28009, 1140614900, 1140790832, 'Italija ', 1, 10),
(28008, 1140614891, 1140790832, 'balta ', 1, 9),
(28007, 1140771001, 1140790832, '40 ', 1, 8),
(28006, 1140784675, 1140790832, '178 ', 1, 7),
(28005, 1140614792, 1140790832, '218 ', 1, 6),
(28004, 1140614843, 1140790832, '57 ', 0, 5),
(28003, 1140614826, 1140790832, '50 ', 0, 4),
(28002, 1140614802, 1140790832, '154 ', 0, 3),
(28001, 1140770892, 1140790832, '0.75 ', 0, 2),
(28000, 1140614720, 1140790832, 'A ', 0, 1),
(40313, 0, 1141202290, '', 0, 6),
(41145, 1140614900, 1221565412, 'Vokietija', 1, 9),
(41280, 1140614900, 1222331102, 'Italija', 1, 9),
(41124, 1140614900, 1140791004, 'Italija', 1, 9),
(41123, 1140614891, 1140791004, 'gelsva', 1, 8),
(41122, 1140771001, 1140791004, '83', 1, 7),
(41121, 1140784675, 1140791004, '218', 1, 6),
(41120, 1140614792, 1140791004, '301', 1, 5),
(41119, 1140614843, 1140791004, '65', 0, 4),
(41118, 1140614826, 1140791004, '60', 0, 3),
(41117, 1140614802, 1140791004, '188', 0, 2),
(28047, 1140614909, 1140791385, 'Italija ', 1, 11),
(28046, 1140614900, 1140791385, 'Italija ', 1, 10),
(28045, 1140614891, 1140791385, 'balta ', 1, 9),
(28044, 1140771001, 1140791385, '35 ', 1, 8),
(28043, 1140784675, 1140791385, '179 ', 1, 7),
(28042, 1140614792, 1140791385, '214 ', 1, 6),
(28041, 1140614843, 1140791385, '58 ', 0, 5),
(28040, 1140614826, 1140791385, '50 ', 0, 4),
(28039, 1140614802, 1140791385, '141 ', 0, 3),
(28038, 1140770892, 1140791385, '0.75 ', 0, 2),
(28037, 1140614720, 1140791385, 'A ', 0, 1),
(28036, 1140764407, 1140791820, '\\"automatinis šaldytuvo atitirpinimas, kamera viršuje\\"', 1, 12),
(28035, 1140614909, 1140791820, 'Italija ', 1, 11),
(28034, 1140614900, 1140791820, 'Italija ', 1, 10),
(28033, 1140614891, 1140791820, 'inox ', 1, 9),
(28032, 1140771001, 1140791820, '49 ', 1, 8),
(28031, 1140784675, 1140791820, '194 ', 1, 7),
(28030, 1140614792, 1140791820, '243 ', 1, 6),
(28029, 1140614843, 1140791820, '58 ', 0, 5),
(28028, 1140614826, 1140791820, '55 ', 0, 4),
(28027, 1140614802, 1140791820, '141 ', 0, 3),
(28026, 1140770892, 1140791820, '1.1 ', 0, 2),
(28025, 1140614720, 1140791820, 'B ', 0, 1),
(28059, 1140614909, 1140791988, 'Italija ', 1, 11),
(28058, 1140614900, 1140791988, 'Italija ', 1, 10),
(28057, 1140614891, 1140791988, 'inox ', 1, 9),
(28056, 1140771001, 1140791988, '55 ', 1, 8),
(28055, 1140784675, 1140791988, '216 ', 1, 7),
(28054, 1140614792, 1140791988, '271 ', 1, 6),
(28053, 1140614843, 1140791988, '58 ', 0, 5),
(28052, 1140614826, 1140791988, '54 ', 0, 4),
(28051, 1140614802, 1140791988, '154 ', 0, 3),
(28050, 1140770892, 1140791988, '0.8 ', 0, 2),
(35415, 1140764407, 1140792326, 'automatinis šaldytuvo atitirpinimas, šaldiklis - \\"no frost\\"', 1, 12),
(35414, 1140614909, 1140792326, 'Turkija ', 1, 11),
(35413, 1140614900, 1140792326, 'Turkija ', 1, 10),
(35412, 1140614891, 1140792326, 'balta ', 1, 9),
(35411, 1140771001, 1140792326, '96 ', 1, 8),
(35410, 1140784675, 1140792326, '162 ', 1, 7),
(35409, 1140614792, 1140792326, '258 ', 1, 6),
(23595, 0, 1140792462, '', 0, 14);

CREATE TABLE IF NOT EXISTS `item_property_groups2` (
  `id` int(11) NOT NULL default '0',
  `name` text,
  `unit` text,
  `nr` tinyint(4) default '0',
  PRIMARY KEY  (`id`)
) TYPE=MyISAM; 
```

--

## -- 为表转储数据`item_property_groups2`

```
INSERT INTO `item_property_groups2` (`id`, `name`, `unit`, `nr`) VALUES
(1140614720, 'Energijos klasė||Energy Class||Класс электронергии||Energijos klasė||{lv}Enerģijas klase', '||||||||{lv}', 9),
(1140614775, 'El. įtampa||Voltage||Эл. напряжение||El. įtampa||{lv}Elektriskais spriegums', '||||||||{lv}', 11),
(1140614792, 'Bendras tūris, L||Total capacity, L||Общий объем, Л||Bendras tūris||{lv}Kopējais apjoms (litri)', 'litrai||litrai||litrai||litrai||{lv}litri', 4),
(1140614802, 'Aukštis (cm.)||Height||Высота (см)||Aukštis||{lv}Augstums (cm)', 'cm||cm||cm||cm||{lv}cm', 1),
(1140614826, 'Plotis (cm.)||Width (cm.)||Ширина  (см.)||Plotis||{lv}Platums (cm)', 'cm||cm||cm||cm||{lv}cm', 37),
(1140614843, 'Gylis (cm)||Depth (cm)||Глубина (см)||Gylis||{lv}Dziļums (cm)', 'cm||cm||cm||cm||{lv}cm', 16),
(1140614891, 'Spalva||Color||Цвет||Farbe||{lv}Krāsa', '||||||||{lv}', 38),
(1140614900, 'Gamintojas||Producer||Производитель||Gamintojas||{lv}Ražotājs', '||||||||{lv}', 24); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T07:52:31.517

将谓词移动`items_groups.idp = '1140503406'`到`WHERE`子句，用`JOIN`条件`item_groups.idp = items.group_id`代替它，如下所示：

```
UPDATE item_properties2 AS P
INNER JOIN items ON items.id = P.item
INNER JOIN item_groups ON item_groups.idp = items.group_id 
SET P.nr = '0'
WHERE P.type = 1140614900
  AND items_groups.idp = '1140503406'; 
```

# ios - iOS：静音右声道音量

> ID：13357038
> 
> 赞同：8
> 
> 时间：2012-11-13T07:38:04.673
> 
> 标签：ios, audiounit

除了我控制的音频流之外，我正在尝试将所有音频的正确通道静音。

我正在使用许多库来播放音频，包括用于文本到语音的 OpenEars，我希望它们都只播放左耳机扬声器，而我从右扬声器播放其他东西。

我知道如何播放正确的扬声器来创建音频单元流，但是我没有为其他库创建音频流。有没有办法更改默认音频通道？或者是否可以创建一个应用于所有音频输出的努力或混音器，以使正确的通道静音？

任何帮助/提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T12:55:16.903

如果您不需要 wich`AudioUnit`提供的低延迟音频，您可以尝试使用`AudioQueues`它来播放音频，`AudioQueues`在 iOS 中对音频具有最高程度的控制（它支持同步、通道控制、音量增益、缓冲等）。这是苹果文档的一些链接:-)

音频队列服务编程指南介绍：[http ://bit.ly/10ikt4G](http://bit.ly/10ikt4G)

关于音频队列：[http ://bit.ly/YfnVI8](http://bit.ly/YfnVI8)

使用 AudioQueue 播放音频：http: [//bit.ly/10ikAgT](http://bit.ly/10ikAgT)

# java - 尝试使用 ImageLoader 加载本地图像时出现 NullPointerException

> ID：13357039
> 
> 赞同：3
> 
> 时间：2012-11-13T07:38:21.790
> 
> 标签：java, android, nullpointerexception, universal-image-loader

我正在尝试在一项活动中使用 nostra13/ImageLoader ( [https://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader) )，该活动允许用户从媒体库中选择图像或使用新的相机。当这个动作完成后，我有一个完整的图片路径，格式为“/mnt/sdcard/DCIM/100ANDRO/whatever.jpg”，也就是说保存在sdcard中的图片。当我尝试使用 ImageLoader 加载此图像时，出现以下错误：

> 11-12 16:05:18.966: E/ImageLoader(12905): null
> 11-12 16:05:18.966: E/ImageLoader(12905): java.lang.NullPointerException
> 11-12 16:05:18.966: E/ImageLoader (12905)：在 com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.saveImageOnDisc(LoadAndDisplayImageTask.java:239)
> 11-12 16:05:18.966：E/ImageLoader(12905)：在 com.nostra13.universalimageloader.core.LoadAndDisplayImageTask。 tryLoadBitmap(LoadAndDisplayImageTask.java:138)
> 11-12 16:05:18.966: E/ImageLoader(12905): at com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.run(LoadAndDisplayImageTask.java:72)
> 11-12 16:05: 18.966: E/ImageLoader(12905): 在 java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:444)
> 11-12 16:05:18.966: E/ImageLoader(12905): 在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
> 11-12 16:05:18.966: E/ImageLoader(12905) : 在 java.util.concurrent.FutureTask.run(FutureTask.java:138)
> 11-12 16:05:18.966: E/ImageLoader(12905): 在 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088 )
> 11-12 16:05:18.966: E/ImageLoader(12905): 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
> 11-12 16:05:18.966: E/ImageLoader(12905 ): 在 java.lang.Thread.run(Thread.java:1019)

我并没有真正理解错误，图像的路径不为空，我试图加载图像的图像视图也不为空。我对清单具有必要的权限，并且能够加载远程图像，但不能加载本地图像。关于会发生什么的任何想法？

先感谢您！

这是我的配置：

```
 imageLoader = ImageLoader.getInstance();
 DisplayImageOptions defaultOptions = new DisplayImageOptions.Builder()
 .cacheInMemory()
 .cacheOnDisc()
 .showImageForEmptyUri(R.drawable.image_broken)
 .build();
 ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(this)
 .memoryCache(new WeakMemoryCache())
 .threadPoolSize(4)
 .defaultDisplayImageOptions(defaultOptions)
 .build();
 imageLoader.init(config); 
```

这就是我尝试将图像加载到图像视图中的方式：

```
ImageView m_ivAvatar = (ImageView) findViewById(R.id.pdi_image_detail);
imageLoader.displayImage(imagen.getUrl(), m_ivAvatar); 
```

和xml：

```
<RelativeLayout 
        android:id="@+id/pdi_header_detail"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">

    <ImageView 
        android:id="@+id/pdi_image_detail"
        android:layout_width="80dp"
        android:layout_height="80dp"
        android:scaleType="fitCenter"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"/>

    <RelativeLayout 
        android:id="@+id/pdi_detail_action_icons_container"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true">

        <ImageButton 
            android:id="@+id/pdi_detail_icon_share"
            android:layout_width="30dp"
            android:layout_height="30dp"
            android:scaleType="fitCenter"
            android:layout_alignParentTop="true"
            android:layout_alignParentLeft="true"/>

        <ImageButton 
            android:id="@+id/pdi_detail_icon_map"
            android:layout_width="30dp"
            android:layout_height="30dp"
            android:scaleType="fitCenter"
            android:layout_below="@id/pdi_detalle_icon_share"
            android:layout_alignParentLeft="true"/>

    </RelativeLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T11:55:51.133

ImageLoader 的本地文件路径应以**file://**开头。例如文件：///mnt/sdcard/...

# javascript - 如何在 Javascript 中将文本替换为图像 URL？

> ID：13357048
> 
> 赞同：-3
> 
> 时间：2012-11-13T07:40:13.853
> 
> 标签：javascript, image, text, replace

我想在单击链接时更改链接的文本。我正在使用以下代码，但它不适用于我：

```
<a id="pp" href="#" title="" onclick="playPause()">play</a>
function playPause(){
  if($('.controls li #pp').text() == 'play'){
    inter = setInterval(function() {
      changeBannerImg(num,1);
    }, 4600);
    document.getElementById('pp').innerHTML = 'pause';
  } else if($('.controls li #pp').text() == 'pause'){
    clearInterval(inter);
    document.getElementById('pp').innerHTML = 'play';
  }
}
function stopAni(){
  clearInterval(inter);
  document.getElementById('pp').innerHTML = 'play';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T07:49:07.490

不清楚的问题 - 这是真的..
不知道第二句是什么意思，但无论如何。假设您要将文本更改为图像，只需将“播放”和“暂停”文本替换为链接到您的图像的 html 图像标记。

# mysql - 休眠分离条件 - 如何添加本机 sql 语句

> ID：13357052
> 
> 赞同：1
> 
> 时间：2012-11-13T07:40:22.073
> 
> 标签：mysql, spring, hibernate, detachedcriteria

嗨，我有很大的问题。我有一个 DetachedCriteria 并命名它`dc`。我是这样声明的`DetachedCriteria dc = getDetachedCriteria()`。我想在 order by 之前添加一个排序规则。整理的目的是为了处理`ñ`。我要添加的语句是`COLLATE utf8_spanish_ci`. 我是这样做的`dc.add(Restrictions.sqlRestriction(" COLLATE utf8_spanish_ci "))`。当然我得到了一个错误，因为这是错误的。我不知道该怎么做。请帮忙。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-29T19:27:55.530

您可以执行本机 SQL 查询以利用您的特定数据库功能，这是在休眠中使用分离条件完成的方式......

```
List<YourEntity> list = (List<YourEntity>) yourEntityDAO.getHibernateTemplate().execute(
    new HibernateCallback() {
    @Override
    public Object doInHibernate(Session session) throws HibernateException {
        SQLQuery sq = session.createSQLQuery("SELECT * FROM MY_TABLE");
        return sq.addEntity(YourEntity.class).list();
    }
}); 
```

# java - 如何在 Java 中使用 XPath 访问值读取 XML

> ID：13357054
> 
> 赞同：0
> 
> 时间：2012-11-13T07:40:33.233
> 
> 标签：java, xml, xpath

我想在 Java 中使用 XPath 读取 XML 数据。

我有下一个名为的 XML 文件`MyXML.xml`：

```
<?xml version="1.0" encoding="iso-8859-1" ?>
<REPOSITORY xmlns:LIBRARY="http://www.openarchives.org/LIBRARY/2.0/"
            xmlns:xsi="http://www.w3.prg/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.openarchives.org/LIBRARY/2.0/ http://www.openarchives.org/LIBRARY/2.0/LIBRARY-PHM.xsd">
    <repository>Test</repository>
    <records>
        <record>
            <ejemplar>
                <library_book:book
                        xmlns:library_book="http://www.w3c.es/LIBRARY/book/"
                        xmlns:book="http://www.w3c.es/LIBRARY/book/"
                        xmlns:bookAssets="http://www.w3c.es/LIBRARY/book/"
                        xmlns:bookAsset="http://www.w3c.es/LIBRARY/book/"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        xsi:schemaLocation="http://www.w3c.es/LIBRARY/book/ http://www.w3c.es/LIBRARY/replacement/book.xsd">
                    <book:bookAssets count="1">
                        <book:bookAsset nasset="1">
                            <book:bookAsset.id>value1</book:bookAsset.id>
                            <book:bookAsset.event>
                                <book:bookAsset.event.id>value2</book:bookAsset.event.id>
                            </book:bookAsset.event>
                        </book:bookAsset>
                    </book:bookAssets>
                </library_book:book>
            </ejemplar>
        </record>
    </records>
</REPOSITORY> 
```

我想要访问`value1`和`value2`价值观。为此，我试试这个：

```
// Standard of reading a XML file
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setNamespaceAware(true);
DocumentBuilder builder;
Document doc = null;
XPathExpression expr = null;
builder = factory.newDocumentBuilder();
doc = builder.parse("MyXML.xml");

// Create a XPathFactory
XPathFactory xFactory = XPathFactory.newInstance();

// Create a XPath object
XPath xpath = xFactory.newXPath();

expr = xpath.compile("//REPOSITORY/records/record/ejemplar/library_book:book//book:bookAsset.event.id/text()");

Object result = expr.evaluate(doc, XPathConstants.STRING);

System.out.println("RESULT=" + (String)result); 
```

但我没有得到任何结果。仅打印`RESULT=`。

¿ 如何访问`value1`和`value2`取值？¿ 要应用的 XPath 过滤器是什么？

提前致谢。

我正在使用JDK6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:10:21.957

您在命名空间方面遇到问题，您可以做的是

1.  考虑到他们
2.  `local-name()`使用 XPath函数忽略它们

解决方案 1 意味着实现一个`NamespaceContext`映射命名空间名称和 URI 的方法，并`XPath`在查询之前将其设置在对象上。

解决方案 2 很简单，您只需要更改您的 XPath（但根据您的 XML，您可以微调您的 XPath 以确保选择正确的元素）：

```
XPath xpath = xFactory.newXPath();
expr = xpath.compile("//*[local-name()='bookAsset.event.id']/text()");
Object result = expr.evaluate(doc, XPathConstants.STRING);
System.out.println("RESULT=" + result); 
```

[ideone 上的可运​​行示例](http://ideone.com/A4YoFs)。

您可以查看[以下博客文章](http://blog.davber.com/2006/09/17/xpath-with-namespaces-in-java/)，以更好地了解 Java 中命名空间和 XPath 的使用（即使是旧的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:06:47.760

尝试

```
Object result = expr.evaluate(doc, XPathConstants.NODESET);

    // Cast the result to a DOM NodeList
    NodeList nodes = (NodeList) result;
    for (int i=0; i<nodes.getLength();i++){
      System.out.println(nodes.item(i).getNodeValue());
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:59:29.607

一种方法是实现名称空间上下文，例如：

```
public static class UniversalNamespaceResolver implements NamespaceContext {
    private Document sourceDocument;

    public UniversalNamespaceResolver(Document document) {
        sourceDocument = document;
    }

    public String getNamespaceURI(String prefix) {
        if (prefix.equals(XMLConstants.DEFAULT_NS_PREFIX)) {
            return sourceDocument.lookupNamespaceURI(null);
        } else {
            return sourceDocument.lookupNamespaceURI(prefix);
        }
    }

    public String getPrefix(String namespaceURI) {
        return sourceDocument.lookupPrefix(namespaceURI);
    }

    public Iterator getPrefixes(String namespaceURI) {
        return null;
    }

} 
```

然后像这样使用它

```
 xpath.setNamespaceContext(new UniversalNamespaceResolver(doc)); 
```

您还需要将所有命名空间声明上移到根节点 (REPOSITORY)。否则，如果您有两个不同级别的命名空间声明，则可能会出现问题。

# winapi - 将我自己的界面添加到桌带

> ID：13357060
> 
> 赞同：0
> 
> 时间：2012-11-13T07:41:05.877
> 
> 标签：winapi, com, proxy, atl, deskband

我在 Windows 7 SP1 x64 上使用 Visual Studio 2010。

我需要制作一个与 win32 应用程序通信的自定义桌带，编译为 32 位应用程序。

我使用这篇 CodeProject 文章作为起点： http: [//www.codeproject.com/Articles/39189/Shell-Extensibility-Explorer-Desk-Band-Tray-Notifi](http://www.codeproject.com/Articles/39189/Shell-Extensibility-Explorer-Desk-Band-Tray-Notifi)

桌带 dll（为 x64 编译）工作正常 - 我在任务栏等中看到它。

它是使用“以管理员身份运行”的 cmd.exe 中的 regsvr32 注册的。rgs 文件是这样的：

```
HKCR
{
    NoRemove CLSID
    {
        ForceRemove {8D330AEA-90D1-4632-804B-4710F2358A18} = s 'my deskbar'
        {
            InprocServer32 = s '%MODULE%'
            {
                val ThreadingModel = s 'Apartment'
            }
        }
    }
} 
```

基于这个stackoverflow答案：[How to add and implementation a new interface to an Inproc COM server](https://stackoverflow.com/questions/6662783/how-to-add-and-implement-a-new-interface-to-an-inproc-com-server)

我在 IDL 文件中创建了一个接口：

```
import "oaidl.idl";
import "ocidl.idl";

[
object,
uuid(35662650-07D0-4F31-B5F0-3C21FCA4BDA2),
version(1.0),
oleautomation
//dual,
//pointer_default(unique)
]
interface IGEDeskBand : IDispatch
{
        HRESULT BadgeSet([in] long arg);
        HRESULT BadgeClear(void);
        HRESULT BadgeBlink(void);
};

[
    uuid(33EB8C00-F66A-493C-8607-529060FAA378),
    version(1.0),
    helpstring("GamEffective DeskBand Library")
]
library GEDeskBandLib
{
  importlib("stdole32.tlb");

    [
        uuid(8D330AEA-90D1-4632-804B-4710F2358A18),
        helpstring("GEDeskBand Class")
    ]
    coclass GEDeskBand
    {
        [default] interface IGEDeskBand;
    };

  cpp_quote("const size_t MAX_GUID_STRING_LEN = 39;")
}; 
```

，Visual Studio 使用 midl 编译它生成生成的头文件，我包含生成的代码：`#include "GEDeskBand_i.h"`，我让我的类继承自

```
public IDispatchImpl<IGEDeskBand, &__uuidof(IGEDeskBand), &LIBID_GEDeskBandLib, /* wMajor = */ 1, /* wMinor = */ 0> 
```

，向`COM_INTERFACE_ENTRY`COM MAP 添加了一个 with 接口并添加了方法：

```
STDMETHOD(BadgeSet)(/* [in] */ long arg);
STDMETHOD(BadgeClear)();
STDMETHOD(BadgeBlink)(); 
```

（好吧，我使用了Visual Studio Wizard：类视图->右键单击类，添加->实现接口），目前方法的实现只是`return E_NOTIMPL;`，我希望这不是问题。这就是我对服务器上的代码所做的所有事情，关于我的界面并尝试从另一个进程与这个对象进行通信。

使用`#define _ATL_DEBUG_QI`本文（[http://msdn.microsoft.com/en-us/library/ezs95xhx%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ezs95xhx%28v=vs.80%29.aspx)），我在附加到 explorer.exe 时在 Visual Studio 的输出窗口中看到（加载deskbar dll并且我的COM对象存在的位置）使用正确的接口查询QueryInterface并且没有说“失败”。

这是加载桌面栏的时间：

```
CComClassFactory - IClassFactory
CGEDeskBand - IDeskBand
CGEDeskBand - IPersistStreamInit
CGEDeskBand - IDeskBand2
CGEDeskBand - IDeskBand
CGEDeskBand - {EA5F2D61-E008-11CF-99CB-00C04FD64497} - failed
CGEDeskBand - IObjectWithSite
CGEDeskBand - {7FE80CC8-C247-11D0-B93A-00A0C90312E1} - failed
CGEDeskBand - IOleCommandTarget - failed
CGEDeskBand - IDeskBandInfo - failed
CGEDeskBand - IDeskBand
CGEDeskBand - IOleWindow
CGEDeskBand - IPersist
CGEDeskBand - IDeskBand2 
```

这是我运行演示问题的测试器时：

```
CGEDeskBand - IDeskBand
CGEDeskBand - {00000003-0000-0000-C000-000000000046} - failed
CGEDeskBand - {00000003-0000-0000-C000-000000000046} - failed
CGEDeskBand - {0000001B-0000-0000-C000-000000000046} - failed
CGEDeskBand - IUnknown
CGEDeskBand - {00000018-0000-0000-C000-000000000046} - failed
CGEDeskBand - {00000019-0000-0000-C000-000000000046} - failed
CGEDeskBand - {4C1E39E1-E3E3-4296-AA86-EC938D896E92} - failed
CGEDeskBand - IDeskBand
CGEDeskBand - IDeskBand
CGEDeskBand - IPersist
CGEDeskBand - IPersist
CGEDeskBand - {1C733A30-2A1C-11CE-ADE5-00AA0044773D} - failed
CGEDeskBand - {35662650-07D0-4F31-B5F0-3C21FCA4BDA2} 
```

最后一个是我的 IID，它没有说失败。

这是演示问题的测试代码：

```
#include <Shobjidl.h>
#include "GEDeskBand_i.h"
#include "GEDeskBandGuids.h"

int _tmain(int argc, _TCHAR* argv[])
{
    HRESULT hr;
    CComPtr<IUnknown> spBandService;
    CComPtr<IBandSite> spBandSite;
    CoInitialize(NULL);
    hr = spBandService.CoCreateInstance(CLSID_TrayBandSiteService);
    if (SUCCEEDED(hr)) {
        hr = spBandService->QueryInterface(&spBandSite);
        if (SUCCEEDED(hr)) {
            DWORD dwBandId = 0;
            UINT num_bands = spBandSite->EnumBands((UINT)-1, &dwBandId);
            for (UINT uBand = 0; uBand < num_bands; uBand++) {
                if (SUCCEEDED(spBandSite->EnumBands(uBand, &dwBandId))) {
                    IDeskBand *band;
                    if (SUCCEEDED(spBandSite->GetBandObject(dwBandId, IID_IDeskBand, (void**)&band))) {
                        IPersist* pPersist = NULL;
                        if (SUCCEEDED(band->QueryInterface(IID_IPersist, (void**)&pPersist))) {
                            CLSID clsid = CLSID_NULL;
                            if (SUCCEEDED(pPersist->GetClassID(&clsid))) {
                                if (clsid == CLSID_GEDeskBand) {
                                    // reaches here fine
                                    IGEDeskBand *pGEDeskBand = NULL;
                                    hr = band->QueryInterface(IID_IGEDeskBand, (void**)&pGEDeskBand);
                                    if (SUCCEEDED(hr)) {
                                        // never reaches here, always get E_NOINTERFACE
                                        pGEDeskBand->BadgeSet(1);
                                    }
                                    break;
                                }
                            }
                        }
                    }
                }
            }
            spBandSite.Release();
        }
        spBandService.Release();
    }
    CoUninitialize();
    return 0;
} 
```

问题是，虽然我看到了我的 DeskBand 对象的 IDeskBand 或 IPersist（CLSID 匹配，我知道它是我的对象，并且我知道它实现了该接口），但使用我的接口 IID_IGEDeskBand 的 QueryInterface 永远不会成功。

QueryInterface 确实找到了 IID，但它没有到达我的客户端。我想是因为编组。

我尝试将测试仪编译为 x64，但没有奏效。

Raymond Chen 写道：http: [//blogs.msdn.com/b/oldnewthing/archive/2004/12/13/281910.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2004/12/13/281910.aspx)

我从那篇博文中了解到的只是我需要处理编组。我以为它应该是自动的？

我看到解决此问题的一种方法是构建中间生成的代理存根：[CoCreateInstance 返回 E_NOINTERFACE 即使找到接口](https://stackoverflow.com/questions/1781906/cocreateinstance-returning-e-nointerface-even-though-interface-is-found)

我已经建立并注册了一个代理存根 dll，一个 32 位的，通过让 midl 创建 32 位代理代码和来自这里的配方：http: [//msdn.microsoft.com/en-us/library/aa366768%28VS。 85%29.aspx](http://msdn.microsoft.com/en-us/library/aa366768%28VS.85%29.aspx)

这也不起作用 - 运行测试器时，我没有看到在测试器进程中加载​​了代理存根 DLL。我是不是该？它似乎注册正确。

我不太了解 COM 甚至一般的 win32，但我已经搜索了几个小时，但我不明白我做错了什么。

# php - 从 PHP 生成的 XML 编码

> ID：13357061
> 
> 赞同：0
> 
> 时间：2012-11-13T07:41:36.647
> 
> 标签：php, xml, dom, servlets, character-encoding

我正在为班级做作业，我必须使用在 Tomcat 上运行的 Java Servlet 并让它向一个 php 文件发送消息以从 IMDB 中抓取电影信息并将其作为 XML 返回给 servlet。它似乎不想接受我给它的任何编码，因为我不断获得 XML 标记，如下面的标记。

```
 <result cover="url" title="Pok&#xE9;mon" year="1998 TV Series" director="N/A" rating="7.8" details="http://www.imdb.com/title/tt0176385/"/> 
```

口袋妖怪的标题应该在 e («é») 上带有重音。我有以下 php 代码来生成 xml。（仅重要部分）

```
 <?php header("Content-Type: text/xml; charset=utf-8");
    $xml = new DOMDocument();
    $rsp = $xml->appendChild($xml->createElement("rsp"));
    $xml->encoding = 'utf-8';

    $titleNames[$i] = utf8_encode($title_tmp[1]);

    $results = $rsp->appendChild($xml->createElement("results"));
    $results->setAttribute("total", $tableRows);

    $item->setAttribute("title", $titleNames[$i]);

    echo $xml->saveXML();
    ?> 
```

在弄清楚如何正确显示特殊字符方面的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:15:52.070

不可能从您的代码片段（甚至不运行）中说出什么问题，但`$xml->encoding = 'utf-8'`应该可以工作。请比较：

```
$xml = new DOMDocument();
$rsp = $xml->appendChild($xml->createElement("rsp"));
$rsp->setAttribute("title", 'Pokémon');
echo $xml->saveXML();
/*
<?xml version="1.0"?>
<rsp title="Pok&#xE9;mon"/>
*/ 
```

... 和：

```
$xml = new DOMDocument();
$xml->encoding = 'utf-8';
$rsp = $xml->appendChild($xml->createElement("rsp"));
$rsp->setAttribute("title", 'Pokémon');
echo $xml->saveXML();
/*
<?xml version="1.0" encoding="utf-8"?>
<rsp title="Pokémon"/>
*/ 
```

（这些片段预计将保存为 UTF-8）。

# java - 正则表达式模式匹配

> ID：13357062
> 
> 赞同：2
> 
> 时间：2012-11-13T07:41:39.033
> 
> 标签：java, regex, string

我正在使用 java 正则表达式库来查找模式“String_OneOrMoreDigits”。例如，“linenumber_1”或“linenumber_31”或“linenumber_456”。我正在尝试以下模式，假设我将获得“linenumber_2”或“linenumber_44”类型的字符串。但是，我只得到“linenumber_2”类型的字符串，它最后不匹配多个数字。如何去匹配这样的字符串？

`Pattern pattern = Pattern.compile("(linenumber_[0-9])|(linenumber_[0-9][0-9])");`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T07:43:11.760

无需交替，只需在 : 上使用“一个或多个”限定符`[0-9]`：

```
Pattern pattern = Pattern.compile("linenumber_[0-9]+"); 
```

这将匹配“linenumber_1”、“linenumber_44”和“linenumber_12345984”。如果您*只想*匹配一位或两位数字，您可以通过更明确地说明允许的位数来做到这一点：

```
Pattern pattern = Pattern.compile("linenumber_[0-9]{1,2}"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T08:06:12.453

如果您想要特定数量的数字，请添加，而不是

```
Pattern pattern = Pattern.compile("linenumber_[0-9]{1,2}"); 
```

你也可以使用

```
Pattern pattern = Pattern.compile("linenumber_[0-9]{1|4|8}"); 
```

这将指定您想要 1 位、4 位或 8 位。就像克劳德说的，

```
Pattern pattern = Pattern.compile("linenumber_[0-9]+"); 
```

将匹配任意数量的数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T11:59:32.590

您还可以使用：

```
Pattern pattern = Pattern.compile("linenumber_\d+"); 
```

如果您需要不区分大小写的匹配，`(?i)`请在开头附加如下：

```
Pattern pattern = Pattern.compile("(?i)linenumber_\d+"); 
```

`(?i)`允许正则表达式引擎执行不区分大小写的匹配。 `\d`将匹配任何数字`0 to 9`

# c++ - OpenMP 如何处理嵌套循环？

> ID：13357065
> 
> 赞同：56
> 
> 时间：2012-11-13T07:42:05.590
> 
> 标签：c++, loops, parallel-processing, openmp

下面的代码只是并行化第一个（外部）循环，还是并行化整个嵌套循环？

```
 #pragma omp parallel for
    for (int i=0;i<N;i++)
    { 
      for (int j=0;j<M;j++)
      {
       //do task(i,j)//
      }
    } 
```

我只是想确定上面的代码是否会并行化整个嵌套的for循环（因此一个线程直接相关的任务（i，j）），或者它只并行化外部for循环（因此它确保对于每个parallel循环索引为 i 的线程，其内部循环将在单个线程中顺序完成，这非常重要）。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-11-13T07:51:37.103

您编写的行将仅并行化外部循环。要并行化两者，您需要添加一个`collapse`子句：

```
#pragma omp parallel for collapse(2)
    for (int i=0;i<N;i++)
    { 
      for (int j=0;j<M;j++)
      {
       //do task(i,j)//
      }
    } 
```

您可能需要查看[OpenMP 3.1](http://www.openmp.org/mp-documents/OpenMP3.1.pdf)规范（第 2.5.1 节）以了解更多详细信息。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-05-22T10:36:25.183

通过以下示例，您将能够更好地理解这一点。让我们用两个线程来做这件事。

```
#pragma omp parallel for num_threads(2)
for(int i=0; i< 3; i++) {
    for (int j=0; j< 3; j++) {
        printf("i = %d, j= %d, threadId = %d \n", i, j, omp_get_thread_num());
    }
} 
```

那么结果将是，

```
i = 0, j= 0, threadId = 0 
i = 0, j= 1, threadId = 0 
i = 0, j= 2, threadId = 0 
i = 1, j= 0, threadId = 0 
i = 1, j= 1, threadId = 0 
i = 1, j= 2, threadId = 0 
i = 2, j= 0, threadId = 1 
i = 2, j= 1, threadId = 1 
i = 2, j= 2, threadId = 1 
```

这意味着，当您将 #pragma omp parallel for 添加到最上面的 for 循环时，该 for 循环的索引将在线程之间划分。如您所见，当 i 的索引相同时，线程 ID 也相同。

取而代之的是，我们可以并行嵌套 for 循环中的组合。在这个例子中，我们可以有以下 i 和 j 的组合。

```
i = 0, j= 0
i = 0, j= 1
i = 0, j= 2
i = 1, j= 0
i = 1, j= 1
i = 1, j= 2
i = 2, j= 0
i = 2, j= 1
i = 2, j= 2 
```

为了明智地并行化代码组合，我们可以添加折叠关键字，如下所示。

```
#pragma omp parallel for num_threads(2) collapse(2)
for(int i=0; i< 3; i++) {
    for (int j=0; j< 3; j++) {
        printf("i = %d, j= %d, threadId = %d \n", i, j, omp_get_thread_num());
    }
} 
```

那么结果将如下所示。

```
i = 0, j= 0, threadId = 0 
i = 0, j= 1, threadId = 0 
i = 1, j= 2, threadId = 1 
i = 2, j= 0, threadId = 1 
i = 2, j= 1, threadId = 1 
i = 2, j= 2, threadId = 1 
i = 0, j= 2, threadId = 0 
i = 1, j= 0, threadId = 0 
i = 1, j= 1, threadId = 0 
```

然后你可以看到，与以前不同，对于相同的索引 i，可以有不同的线程 id（当 (i=1 and j=2 threadId=1) 也 (i=1 and j=0 threadId=0)）。这意味着在这种情况下，i 和 j 的组合在线程之间进行划分。

# scala - 在 Slick 中描述可选字段

> ID：13357067
> 
> 赞同：4
> 
> 时间：2012-11-13T07:42:24.530
> 
> 标签：scala, scalaquery, slick

Slick DSL 允许两种方法在表中创建可选字段。

对于这个案例类：

```
case class User(id: Option[Long] = None, fname: String, lname: String) 
```

您可以通过以下方式之一创建表映射：

```
object Users extends Table[User]("USERS") {
    def id = column[Int]("id", O.PrimaryKey, O.AutoInc)
    def fname = column[String]("FNAME")
    def lname = column[String]("LNAME")
    def * = id.? ~ fname ~ lname <> (User, User.unapply _)
  } 
```

和

```
 object Users extends Table[User]("USERS") {
    def id = column[Option[Long]]("id", O.PrimaryKey, O.AutoInc)
    def fname = column[String]("FNAME")
    def lname = column[String]("LNAME")
    def * = id ~ fname ~ lname <> (User, User.unapply _)
  }
} 
```

两者有什么区别？一种是*旧方式*，另一种是*新方式*，还是它们有不同的用途？

我更喜欢将身份定义为可选作为 id 定义的一部分的第二种选择，因为它更加一致。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T12:37:40.850

第一个中的`.?`运算符允许您将选择字段的选择推迟到定义预测的那一刻。有时这不是您想要的，但是将您的 PK 定义为 an`Option`可能有点有趣，因为人们可能期望 PK 为`NOT NULL`.

除了 之外，您还可以`.?`在其他投影中使用`*`，例如：

```
def partial = id.? ~ fname 
```

然后你可以做`Users.partial.insert(None, "Jacobus")`而不用担心你不感兴趣的领域。

# c# - 如何使用 SQL 查询 DataGridView？

> ID：13357068
> 
> 赞同：2
> 
> 时间：2012-11-13T07:42:29.970
> 
> 标签：c#, sql, winforms, datagridview

我需要`DataGridView`使用 SQL 查询但不显示到`DataGridView`.

```
public chkTime()
{
    InitializeComponent();
}

HRTaffDataContext db = new HRTaffDataContext();
SqlConnection Conn;
SqlCommand cmd = new SqlCommand();
SqlDataAdapter da;
DataTable dt = new DataTable();
DataSet ds = new DataSet();
StringBuilder sb = new StringBuilder();
string appConn = ConfigurationManager.ConnectionStrings["connDB"].ConnectionString;
string strDate;

private void chkTime_Load(object sender, EventArgs e)
{
    connStr();
    return;
}

public void connStr()
{
    Conn = new SqlConnection();
    if (Conn.State == ConnectionState.Open)
    {
        Conn.Close();
    }
    Conn.ConnectionString = appConn;
    Conn.Open();
}

private void button2_Click(object sender, EventArgs e)
{
    SqlConnection conn = new SqlConnection(appConn);

    string sql = "SELECT [filesTA].EmpNo,[Employee].[First Name],[filesTA].ChkDate,[filesTA].ChkIn,[filesTA].ChkOut,[CompanyData].ShortName"
    + " From [WebSP].[dbo].[filesTA] inner join [WebSP].[dbo].[Employee] on [Employee].EmployeeNo=[filesTA].EmpNo INNER JOIN [WebSP].[dbo].[CompanyData] On [CompanyData].Company = [Employee].Company"
    + " WHERE [filesTA].ErrorCode = 0"; // It's work
    + " WHERE [filesTA].ErrorCode = 0 and [filesTA].ChkDate ='" + dateTimePicker.Text.ToString() + "'";

    da = new SqlDataAdapter(sql, Conn);
    DataSet ds = new DataSet();
    da.Fill(ds);
    Conn.Close();

    dgvShow.DataSource = ds.Tables[0];
} 
```

*   `"WHERE [filesTA].ErrorCode = 0"`工作正常。

*   `"WHERE [filesTA].ErrorCode = 0 and [filesTA].ChkDate ='" + dateTimePicker.Text.ToString() + "'"`不起作用。

我需要设置 where `DateTime`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T07:57:29.700

$dateTimePicker.Text 返回一个供人类阅读的字符串，您的服务器可能不喜欢它。

尝试类似：

```
string sql = string.Format("SELECT [filesTA].EmpNo,[Employee].[First Name],[filesTA].ChkDate,[filesTA].ChkIn,[filesTA].ChkOut,[CompanyData].ShortName"
            + " From [WebSP].[dbo].[filesTA] inner join [WebSP].[dbo].[Employee] on [Employee].EmployeeNo=[filesTA].EmpNo INNER JOIN [WebSP].[dbo].[CompanyData] On [CompanyData].Company = [Employee].Company"
            + " WHERE [filesTA].ErrorCode = 0 and [filesTA].ChkDate ='{0}-{1}-{2}'",
                dateTimePicker.Value.Year,
                dateTimePicker.Value.Month,
                dateTimePicker.Value.Day); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:47:54.813

您需要使用`dateTimePicker.Value.ToString()`而不是`dateTimePicker.Text.ToString()`

使用它的一个简单示例可以是`dateTimePicker.Value.ToString("yyyy-MM-dd")`

# javascript - 在两个方向上动态加载用户控件

> ID：13357069
> 
> 赞同：6
> 
> 时间：2012-11-13T07:42:35.617
> 
> 标签：javascript, jquery, asp.net, .net, css

我正在开发一个类似评论的平台，用户可以在其中发表评论，其他用户可以回复该评论。但这些评论可以从两个方向回复（回复和展开）。这个想法是用户可以回复并且用户也可以扩展该讨论。请看图片。

![在此处输入图像描述](../Images/c1785587ae7b3e7dc99bd5432eea87bf.png)

我开发了一个控件，只要用户回复或展开评论，就会动态添加该控件。

如果用户将回复控件，则将在该消息（评论）下添加一个新控件，如果用户展开该消息（评论），则将在该消息（评论）的右侧添加一个具有扩展回复（消息）的控件。多个用户可以展开消息，用户还可以回复展开的消息。

我不确定应该在其中添加这些控件的占位符或容器是什么。

*   我应该使用服务器`Table`控件并动态创建`TableRows`吗`TableCells` ？
*   我应该使用什么容器以使页面不会太重？
*   我应该`divs`在运行时创建和调整它的位置并在每个中添加控制 `div`吗？

我不清楚的其他问题是：

*   多个用户可以展开一条消息，在这种情况下如何处理 UI。隐藏/显示控件或任何其他解决方案。
*   我应该`scrollbar`在扩展上显示水平还是有其他解决方案？

任何帮助/建议？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T17:22:18.037

你可以用不同的方式做到这一点，我不会给你代码，因为我希望你尝试学习。因此，您可以使用 JQuery 完成所有这些操作，您不需要 Asp.net 控制器，因为有时它们使用起来很复杂。

**所以 1º 步骤：** 您可以创建一个包含 2 列和`N`行的简单表格，具体取决于您拥有的消息数量（尝试过滤一些，例如：您有 100 条，仅显示 10 条并有一个“下一页”）或使用一些插件表为您保存大数据。

**2º 步骤：** 当您回复消息时，`<tr>`在您的表格中创建一个“回复第一条消息”（注意：您需要创建一个结构来轻松处理您在表格上的导航`ID's`）

**3º步骤：** 在您的第二列中`<div>`准备好在用户单击“展开”时接收并显示展开消息，并在展开新消息时始终清除它。

这应该对你有用，还有其他方法，但试着用简单的方式思考

**其他问题：**

1º - 我不明白这个问题，但如果您的网站将在服务器上运行，user1 和 user2，... userN 使用相同的页面但在不同的地方呈现，您只需要重新加载数据让每个人都知道有人评论或回复或消息中的任何内容。

2º - UI 由您选择，看看什么最适合您；）

请享用 ;）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T09:27:13.393

我认为其他答案很复杂。对我来说，你似乎需要

```
 <div class="rowContainer">
      <div style="float:right">
         <uc:YourControl>
      </div>
   <div> 
```

用于可扩展控件的行。当用户快速展开按钮页面时，会将另一个 YourControls 添加到 div.rowContainer 与父另一个具有浮动权的 div：

```
 <div class="rowContainer">
      <div style="float:right">
         <uc:YourControl>
      </div>
      <div style="float:right">
         <uc:YourControl>
      </div>
   <div> 
```

当用户将添加另一行消息时，使用 div.rowContainer 添加另一个行容器：

```
 <div class="allMessagesContainer">
      <div class="rowContainer">
         <div style="float:right">
            <uc:YourControl>
         </div>
      <div>
      <div style="clear:both">
      <div class="rowContainer">
         <div style="float:right">
            <uc:YourControl>
         </div>
      <div>
   </div> 
```

`clear:both`很重要，因为将浮动中断到下一行。我认为创建 3 个控件会很好：1.`<uc:YourControl>`使用单个消息 2\. 控件从轻松附加消息到左侧，只需在同一控件内`div.rowContainer`添加另一个到服务器即可。3.控制所有消息，以便在下一行轻松添加消息。只需向容器添加另一个行控件。`div``float:right`

控件的浮动也不会强制用户无限向左滚动。这不好，他们讨厌那样。

还有一个：asp.net 不适合这类网站。事情很快变得复杂起来。如果嵌套控件之一中的按钮应该在 Page 上执行某些操作怎么办？您是否应该向 Page 添加方法并将其强制转换为控件？`((MyPage)Page).DoSomeWork()` 如果页面类型发生变化怎么办？创建界面？也许代之以委托。把他放在哪里？在页面中？控制？创建事件并通过所有父母对其进行冒泡？一些上下文类？

更不用说重新初始化动态控件树的必要性，每次回发都是发送的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T10:28:12.733

> 1 味精 2 味精响应 ...等...

...你可以这样做:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T16:47:46.997

说到 CSS，简单更好。

我的建议，如果您必须在布局方面采用这种方式：

```
<div class="row">
    <div class="message"><FirstMessage /></div>
    <div class="message"><ExpandedFirstMessage /></div>
</div>
<div class="row">
    <div class="message"><Reply /></div>
    ...etc...
</div> 
```

您为每个“行”或扩展响应创建一个 div，使用“row.”类的 div。然后，每条消息都有自己的带有“消息”类的 div，使用以下 CSS：

```
.message {
    width: 200px; // or whatever size you want here
    height: 100px; // or whatever size you want here
    display: inline-block; // This is the important part!
    ...etc // your extra padding, margin, whatnot.
} 
```

内联块允许您避免浮动和诸如此类的东西，这应该会使事情变得更简单。（作为奖励，具有 RTL 阅读顺序的人将自动为他们完成这项工作。）

*现在，这是你的问题。*

从您描述的图像来看，似乎任何人都可以回复任何消息，或展开任何消息；从逻辑上讲，这意味着您描述的网格布局可能无法正常工作。（例如，如果有人回复了扩展的第一条消息，而其他人扩展了对第一条消息的回复呢？您将不得不向竞争相同空间的用户控件发送消息。这将如何工作？）我建议实施不同的设计这将适应您的使用流程，除非您有更具体的计划。

我希望这个答案对你有所帮助。祝你好运。

# matlab - 基于另一个数组删除数组的某些元素（MATLAB）

> ID：13357072
> 
> 赞同：1
> 
> 时间：2012-11-13T07:42:48.850
> 
> 标签：matlab

我有数组

```
A = [7 4 6 1 2 3 5]
B = [1 5 4 0 0 2 0] 
```

（数组`A`将始终具有`length=7`随机顺序的数字。）

我想保持 A 的顺序，但只保留其对应索引为的`B`值`>0`。

因此，从上面的示例中，我想更改`A`为`[6 1 2 3]`. 意思是，B 中的第 7、4 和 5 个元素等于 0，因此从 中删除值 7、4 和 5 `A`。

我想在没有循环的情况下做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:05:16.933

> A(B(A)>0)

或者：

> A(找到(B(A)))

虽然我相信后者效率较低

# javascript - 使用 JavaScript 识别计算机

> ID：13357073
> 
> 赞同：6
> 
> 时间：2012-11-13T07:42:57.100
> 
> 标签：javascript

我正在构建一个 webapp，我可以使用一个解决方案来唯一地识别用户的计算机。

这样做的原因是，一旦用户登录到应用程序，他/她可以启动与应用程序相关的多个会话（存储在 mySQL 中） - 但是，会话应该只能从会话所在的计算机获得发起了。

我不能使用 cookie，因为应用程序应该允许用户关闭浏览器、重新启动计算机等，而不会有任何丢失用户会话的风险。

起初我以为我可以得到类似主板序列号的东西。Naaah，不会发生的。

然后我想到了根据用户远程地址 + MAC 地址生成一个 MD5 哈希，直到我发现这只能使用带有 ActiveX 的旧版本的 IE。

然后我开始想，如果所有 Chrome 安装都有某种我可以使用的唯一浏览器 ID？... 没有找到任何有用的东西。

关于如何根据用户计算机生成唯一字符串的任何好主意？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T07:45:49.680

您将不得不放松您的限制：即使使用[浏览器数字打印](https://panopticlick.eff.org/)，您也无法保证不更改且不丢失 UID。

我通常的解决方案（效果很好但不能保证）是从服务器向浏览器发送一个 UID 并将其存储在[localstorage](https://developer.mozilla.org/en-US/docs/DOM/Storage)中。请注意，精通计算机的用户可以删除或更改它。但如果用户不是你的敌人，这很好用。

喜欢 localstorage 而不是 cookie 的原因是：

*   没有过期
*   没有工具可以“清理”它们，因为它们从一开始就是原始绑定的，因此没有 cookie 侵犯隐私的声誉
*   当然，对于 javascript 应用程序来说，界面更干净、更健全

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T07:44:54.660

> 我不能使用 cookie，因为应用程序应该允许用户关闭浏览器、重新启动计算机等，而不会有任何丢失用户会话的风险。

计算重启时 cookie 不会丢失。**您可以使用 cookie。**

# colors - JavaFX ProgressBar：如何更改条形颜色？

> ID：13357077
> 
> 赞同：15
> 
> 时间：2012-11-13T07:43:33.370
> 
> 标签：colors, progress-bar, javafx-2

我正在尝试更改 ProgressBar 中的条形颜色

```
pBar.setStyle("-fx-accent: green"); 
```

但我遇到了一个问题：这似乎不适合我！（或者我只是不明白一些东西）

这是代码：

```
public class JavaFXApplication36 extends Application {

@Override
public void start(Stage primaryStage) {
AnchorPane root = new AnchorPane();
ProgressBar pbRed = new ProgressBar(0.4);
ProgressBar pbGreen = new ProgressBar(0.6);
pbRed.setLayoutY(10);
pbGreen.setLayoutY(30);

pbRed.setStyle("-fx-accent: red;");       // line (1)
pbGreen.setStyle("-fx-accent: green;");   // line (2)

root.getChildren().addAll(pbRed, pbGreen);
Scene scene = new Scene(root, 150, 50);
primaryStage.setTitle("Hello World!");
primaryStage.setScene(scene);
primaryStage.show();
}
} 
```

我总是得到 2 个红色进度条！似乎第 (1) 行中的代码更改了 ProgressBar 类的样式，而不是实例。

另一个奇怪的时刻是删除第 (1) 行不会导致 2 个绿色进度条。所以我可以认为第 (2) 行完全没用！！为什么？！这肯定会变得很奇怪。

有没有办法为单独的进度条设置单独的颜色？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-14T02:16:38.547

*更新答案以添加一个带有多个进度条的简单非动画示例*

您问题中的代码应该显示两个不同颜色的进度条，事实上它不是 JavaFX css 处理系统中的错误。在此处针对运行时项目记录错误：http: [//javafx-jira.kenai.com](http://javafx-jira.kenai.com)。

作为一种解决方法，不要在进度条上调用 setStyle，而是定义用于在样式表中为进度条着色的强调色，并将样式类添加到进度条。然后，您可以在同一个应用程序中创建多个进度条，它们都具有不同的颜色。

正如 Uluk 所指出的，您可以将[JavaFX 2.2 caspian.css](http://hg.openjdk.java.net/openjfx/2.2/master/rt/raw-file/tip/javafx-ui-controls/src/com/sun/javafx/scene/control/skin/caspian/caspian.css)与[JavaFX 2 css 参考指南](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html)和[JavaFX 2 css 教程](http://docs.oracle.com/javafx/2/css_tutorial/jfxpub-css_tutorial.htm)结合使用来确定如何设置样式。

这是一些示例代码，它根据这些参考资料中的信息自定义进度条。

示例 CSS：

```
/** progress.css
    place in same directory as 
    ColoredProgressBarStyleSheet.java or SimpleColoredProgressBar.java
    ensure build system copies the css file to the build output path */

.root { -fx-background-color: cornsilk; -fx-padding: 15; }

.progress-bar { -fx-box-border: goldenrod; }

.green-bar  { -fx-accent: green;  }
.yellow-bar { -fx-accent: yellow; }
.orange-bar { -fx-accent: orange; }
.red-bar    { -fx-accent: red;    } 
```

简单的示例程序：

```
import javafx.application.Application;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.ProgressBar;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;

// shows multiple progress bars drawn in different colors.
public class SimpleColoredProgressBar extends Application {
     public static void main(String[] args) { launch(args); }

     @Override public void start(Stage stage) {
         final VBox layout = new VBox(10);
         layout.setAlignment(Pos.CENTER);
         layout.getChildren().setAll(
             new ColoredProgressBar("red-bar",    0.2),
             new ColoredProgressBar("orange-bar", 0.4),
             new ColoredProgressBar("yellow-bar", 0.6),
             new ColoredProgressBar("green-bar",  0.8)
         );
         layout.getStylesheets().add(getClass().getResource("progress.css").toExternalForm());
         stage.setScene(new Scene(layout));
         stage.show();
    }

    class ColoredProgressBar extends ProgressBar {
        ColoredProgressBar(String styleClass, double progress) {
            super(progress);
            getStyleClass().add(styleClass);
        }
    }
} 
```

简单的示例程序输出：

![彩条](../Images/6bf93bd972415d297db9c2b7f8dd6438.png)

更复杂的示例程序，带有一个动画进度条，它会根据进度动态改变颜色：

```
import javafx.animation.*;
import javafx.application.Application;
import javafx.beans.value.*;
import javafx.event.*;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;
import javafx.util.Duration;

// shows a progress bar whose bar changes color depending on the amount of progress.
public class ColoredProgressBarStyleSheet extends Application {
  public static void main(String[] args) { launch(args); }

  private static final String RED_BAR    = "red-bar";
  private static final String YELLOW_BAR = "yellow-bar";
  private static final String ORANGE_BAR = "orange-bar";
  private static final String GREEN_BAR  = "green-bar";
  private static final String[] barColorStyleClasses = { RED_BAR, ORANGE_BAR, YELLOW_BAR, GREEN_BAR };

  @Override public void start(Stage stage) {
    final ProgressBar bar = new ProgressBar();

    final Timeline timeline = new Timeline(
      new KeyFrame(Duration.millis(0),    new KeyValue(bar.progressProperty(), 0)),
      new KeyFrame(Duration.millis(3000), new KeyValue(bar.progressProperty(), 1))
    );

    Button reset = new Button("Reset");
    reset.setOnAction(new EventHandler<ActionEvent>() {
      @Override public void handle(ActionEvent event) {
        timeline.playFromStart();
      }
    });

    bar.progressProperty().addListener(new ChangeListener<Number>() {
      @Override public void changed(ObservableValue<? extends Number> observable, Number oldValue, Number newValue) {
        double progress = newValue == null ? 0 : newValue.doubleValue();
        if (progress < 0.2) {
          setBarStyleClass(bar, RED_BAR);
        } else if (progress < 0.4) {
          setBarStyleClass(bar, ORANGE_BAR);
        } else if (progress < 0.6) {
          setBarStyleClass(bar, YELLOW_BAR);
        } else {
          setBarStyleClass(bar, GREEN_BAR);
        }
      }

      private void setBarStyleClass(ProgressBar bar, String barStyleClass) {
        bar.getStyleClass().removeAll(barColorStyleClasses);
        bar.getStyleClass().add(barStyleClass);
      }
    });    

    final VBox layout = new VBox(10);
    layout.setAlignment(Pos.CENTER);
    layout.getChildren().setAll(bar, reset);
    layout.getStylesheets().add(getClass().getResource("progress.css").toExternalForm());
    stage.setScene(new Scene(layout));
    stage.show();

    timeline.play();
  }    
} 
```

更复杂的示例程序输出：

![示例程序输出](../Images/d167a854b5456c45280e4d7f63456741.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-13T08:24:32.817

您应该使用 JavaFX CSS 选择器覆盖（或自定义）样式。有关更多信息，请参阅 caspian.css。在您自己的样式表中定义：

```
.progress-bar .bar {
    -fx-background-color:
        -fx-box-border,
        linear-gradient(to bottom, derive(-fx-accent,95%), derive(-fx-accent,10%)),
        red; /* this line is the background color of the bar */
    -fx-background-insets: 0, 1, 2;
    -fx-padding: 0.416667em; /* 5 */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-21T02:53:05.973

对于那些想要一个简单答案（并且不需要添加 CSS 文件）的人：

```
ProgressBar pbGreen = new ProgressBar(0.6);
pbGreen.setStyle("-fx-accent: green"); 
```

# qt-creator - 将 QTCreator 中的库与 QMake 链接？

> ID：13357080
> 
> 赞同：1
> 
> 时间：2012-11-13T07:43:50.543
> 
> 标签：qt-creator, qmake

我是 QTCreator 的一个相对较新的用户，我以前使用过标准库和 QT 库，但这是我尝试添加外部库的第一个项目，但我遇到了问题。

我正在尝试使用[点云库](http://pointclouds.org/)，据我所知，我已正确安装它，`usr/lib`但当我尝试执行[此](http://pointclouds.org/)简单教程时，包含不起作用：

```
#include <boost/thread/thread.hpp>
#include <pcl/common/common_headers.h>
#include <pcl/features/normal_3d.h>
#include <pcl/io/pcd_io.h>
#include <pcl/visualization/pcl_visualizer.h>
#include <pcl/console/parse.h> 
```

给我这个错误：

`/home/george/Documents/QT/EditorPCL-build-desktop-Qt_4_8_1_in_PATH__System__Release/../EditorPCL/editor.cpp:7: error: pcl/common/common_headers.h: No such file or directory`

现在我通过 GUI 添加了库，所以在语法上我认为 QMake 文件是正确的，但我不知道有什么问题。

这是 QMake 文件的相关部分：

```
win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/      -lpcl_visualization
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/   -lpcl_visualizationd
else:symbian: LIBS += -lpcl_visualization
else:unix: LIBS += -L$$PWD/../../../../../usr/lib/ -lpcl_visualization

INCLUDEPATH += $$PWD/../../../../../usr/lib
DEPENDPATH += $$PWD/../../../../../usr/lib

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/release/ -lpcl_common
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/debug/ -lpcl_common
else:symbian: LIBS += -lpcl_common
else:unix: LIBS += -L$$PWD/../../../../../usr/lib/ -lpcl_common

INCLUDEPATH += $$PWD/../../../../../usr/lib
DEPENDPATH += $$PWD/../../../../../usr/lib

 win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/release/ -lpcl_apps
 else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../usr/lib/debug/ -lpcl_apps
 else:symbian: LIBS += -lpcl_apps
 else:unix: LIBS += -L$$PWD/../../../../../usr/lib/ -lpcl_apps

 INCLUDEPATH += $$PWD/../../../../../usr/lib
 DEPENDPATH += $$PWD/../../../../../usr/lib 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T14:19:40.637

编译器在尝试查找标头时会抛出您的错误。

```
... error: pcl/common/common_headers.h: No such file or directory 
```

这告诉我它没有找到正确的包含路径。查看您的 QMake 文件，我看到您正在将包含路径设置为

```
INCLUDEPATH += $$PWD/../../../../../usr/lib 
```

在大多数 Linux/Unix（甚至 Windows）系统上，包含不在 subdirectory`lib`中，而是在 subdirectory 中`include`。

此外，我不喜欢您指定 LIBPATH 和 INCLUDEPATH 的方式。如果 PWD 和文件的安装位置都从不移动，它们将起作用。一个更好的建议（至少对于 Unix/Linux）是使用 pkg-config 实用程序。您可能想阅读文章[Using pkg-config with Qmake](http://www.developer.nokia.com/Community/Wiki/Using_pkg-config_with_qmake)，看看它是否有帮助。

# jquery - 将动态插入的元素绑定到 DOM 并在其上执行插件

> ID：13357082
> 
> 赞同：0
> 
> 时间：2012-11-13T07:43:57.640
> 
> 标签：jquery, ajax, json

在我的一个应用程序中，我从 php 获取 json 数据并使用 ajax/jquery 渲染 html

我使用一些星级插件呈现产品列表。问题是该插件在最初通过页面刷新呈现时工作正常。当我应用价格过滤器（这实际上获取 json 并使用 ajax 呈现）时，插件停止工作，因为它无法绑定到使用 ajax 动态插入的列表。

插件初始化代码是这样的

```
jQuery.noConflict ();
var jq = jQuery;
jq(document).ready(function(e) {
    jq('.auto-submit-starc').rating({
        callback: function(value, link){
            product_id=this.name;
            rating=value;
            jq.post('<?PHP echo base_url();?>index.php/showproducts/awardRating',{id:product_id,rating:rating},function(data){});
        }
    });   
}); 
```

这就是获取 json 的内容：

```
 // Price range
('select#valueA, select#valueB').selectToUISlider({
    labels:8,
    sliderOptions: {
        stop: function(e,ui) {
            jq(".list-items").css('width','100%').css('height','700px').css('background-color','#EFEFEF').css('opacity','0.5').css('text-align','center').html("<img src='http://tharhandloom.in/images/preloader.gif'/>");

            var startk = jq('#valueA').val();
            var endk = jq('#valueB').val();

            var start=startk.replace('k', '000')
            var end=endk.replace('k', '000')

            var catid="<?PHP echo @$category['id'];?>";   
           jq.post('<?PHP echo base_url()?>index.php/showproducts/ajaxFilterProducts',
                   {start:start,end:end,catid:catid},
                   function(data){          
                       var json=jQuery.parseJSON(data);                
                       var html="";
                       jq(json).each(function(index,element){
                           if(element.name.length>21)
                               productName=element.name.substring(0,21)+"...";
                           else
                               productName=element.name;
                           html+='<div class="single-item"><span class="title"><a href="#">'+productName+'</a></span><input class="auto-submit-starc" type="radio" name="'+element.id+'" value="1"/><input class="auto-submit-starc" type="radio" name="'+element.id+'" value="2" id="rate_second"><input class="auto-submit-starc" type="radio" name="'+element.id+'" value="3" id="rate_third" /><input class="auto-submit-starc" type="radio" name="'+element.id+'" value="4" id="rate_fourth" /><input class="auto-submit-starc" type="radio" name="'+element.id+'" value="5" id="rate_fifth"/><span class="price">Rs '+element.price+'</span><img src="http://tharhandloom.in/product_images/thumbnails/'+element.product_image+'" alt="Item"/><div style="text-align:center"><a href="<?PHP echo base_url();?>cart/'+element.id+'" class="general-button float-left"><span class="button">Add to cart</span></a></div><br class="clear"/></div>';     
                        });
                        jq(".list-items").css('background-color','').css('opacity','').css('text-align','').css('width','').css('height','').html(html);

                    });

             }
         }          
}); 
```

可以看出，在 html 中我正在插入单选按钮。该插件实际上捕获了单选按钮的类别并将功能应用于它们。但是当通过 ajax 插入新的单选按钮时，插件无法捕获那里的类。

我想它可以用 .live 方法完成，但不知道如何使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:36:47.863

您应该简单地`jq('.auto-submit-starc').rating(...);`在此行之后运行：

```
jq(".list-items").css('background-color','').css('opacity','').css('text-align','').css('width','').css('height','').html(html); 
```

`.live`是绑定事件，它不会帮助您应用插件，因为它只是捕获所有事件`document`并查找与`event.target`选择器或类似内容相关的事件。它不检查页面上是否有更改。此外，`.live`在较新版本的 jQuery 中已弃用。你应该`.on`改用。

# yii - 用于在表单下拉列表中使用的数据库内容缓存

> ID：13357084
> 
> 赞同：1
> 
> 时间：2012-11-13T07:44:12.587
> 
> 标签：yii

我想在 yii 中缓存数据库内容并在 Yii 下拉列表中使用该数据。在下拉列表中要从数据库中加载国家名称。（有 2 个表用户和国家）。在用户表单中需要下拉列表。使用缓存从国家表中选择的。查询放置在哪里以及何时可以在用户表单中使用缓存结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:41:53.797

为了缓存表中的结果，然后在下拉列表中使用它，您需要首先在配置文件中设置缓存，如权威指南的[缓存概述中所述。](http://www.yiiframework.com/doc/guide/1.1/en/caching.overview)如果你想使用 memCache，你可以这样设置；

```
array(
    ......
    'components'=>array(
        ......
        'cache'=>array(
            'class'=>'system.caching.CMemCache',
        ),
    ),
); 
```

Yii 可以使用许多不同的缓存，这些缓存在上面的缓存概述链接中列出。

然后你需要使用 Yii 的[数据缓存](http://www.yiiframework.com/doc/guide/1.1/en/caching.data#query-caching)功能。例如，您可以在您的 user/_form.php 视图中执行此操作；

```
...

echo $form->dropDownList($model,'country_id',CHtml::listData(Country::model()->cache(1000)->findAll(),'id','name'));

... 
```

但是更多的 MVC 方法是在您的控制器中执行此操作，类似这样的方法会起作用；

在您的用户控制器中：

```
...

public function actionUpdate()
{
    ...

    $this->render('update',array(
        'model'=>$model,
        'countryList=>Country::model()->cache(1000)->findAll();,
    );
}

... 
```

在您的 user/update.php 视图中：

```
...

echo $this->renderPartial('_form', array('model'=>$model,'countryList'=>$countryList));

... 
```

在您的 user/_form.php 视图中：

```
...

echo $form->dropDownList($model,'country_id',CHtml::listData($countryList,'id','name'));

... 
```

上面的示例对缓存没有使用依赖关系，因此缓存值将保持有效，直到时间（在本例中为 1000 秒）到期。

要阅读有关使用缓存依赖项的更多信息，您可以阅读数据缓存文档的[缓存依赖](http://www.yiiframework.com/doc/guide/1.1/en/caching.data#cache-dependency)项部分。

[**编辑**]

如果您需要安装 memcached，并且在 Windows 上使用 xampp，这是一个很好的指南来让它工作：[如何在 WINDOWS 7 上的 XAMPP 上安装 MEMCACHED](http://www.leonardaustin.com/technical/how-to-install-memcached-on-xampp-on-windows-7)

# javascript - 按日期计算 span id 的数量

> ID：13357085
> 
> 赞同：0
> 
> 时间：2012-11-13T07:44:39.357
> 
> 标签：javascript, jquery, html

在 PHP 页面中，我有一个结果列表。我想按日期获取结果数以显示饼图。

这就是我所拥有的：

```
<span id="tweetdate_1_12-11-2012">...</span> 
<span id="tweetdate_2_12-11-2012">...</span>
<span id="tweetdate_3_12-11-2012">...</span> 
<span id="tweetdate_4_12-11-2012">...</span>
<span id="tweetdate_1_11-11-2012">...</span> 
<span id="tweetdate_2_11-11-2012">...</span>
<span id="tweetdate_1_10-11-2012">...</span> 
<span id="tweetdate_2_10-11-2012">...</span> 
```

我想进入 javascript ： 1\. 这样的日期：10-11-2012、11-11-2012、12-11-2012 2\. 按日期划分的结果数：2、2、4

我已经恢复了日期，但顺序不正确（首先是旧的），而不是这些日期的数量。

可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:03:58.583

您可以使用以下 jQuery 代码，并会得到一个以日期为键的对象。

```
$(function(){
 var ret = {};
  $('span[id^="tweetdate"]').each(function(){
      var tmp_array = this.id.split('_');
      var date = tmp_array[tmp_array.length-1];
      if(ret[date]){
          ret[date] ++;
      }else{
          ret[date] = 1;
     }
  });
  console.log(ret);
}); 
```

结果似乎井然有序。或者如果您不确定，您可以在使用前对其进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:40:44.057

更简洁一点：

```
var count = $('span[id*=12-11-2012]').length;
$('#count').html(count); 
```

[http://api.jquery.com/attribute-contains-selector/](http://api.jquery.com/attribute-contains-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:29:59.387

你可以用这种方式

***jQuery代码***

```
<script language="javascript" type="text/javascript" src="jquery-1.8.2.js"></script>
<script language="javascript" type="text/javascript">
$(document).ready(function() {
   count = 0;
   $('span').each(function(){
     if($(this).attr('id').match(/12-11-2012/)) {
          count++;
     }
  });
  $('#count').html(count);
}); 
</script> 
```

***html代码***

```
<span id="tweetdate_1_12-11-2012">...</span> 
<span id="tweetdate_2_12-11-2012">...</span>
<span id="tweetdate_3_12-11-2012">...</span> 
<span id="tweetdate_4_12-11-2012">...</span>
<span id="tweetdate_1_11-11-2012">...</span> 
<span id="tweetdate_2_11-11-2012">...</span>
<span id="tweetdate_1_10-11-2012">...</span> 
<span id="tweetdate_2_10-11-2012">...</span>
<div id="count"></div> 
```

# jquery - data-ajax="false" 到底是做什么的？

> ID：13357088
> 
> 赞同：17
> 
> 时间：2012-11-13T07:45:03.410
> 
> 标签：jquery, html, ajax, jquery-mobile

我网站上的链接不起作用，我得到了一个`data-ajax="false"`在没有得到真实解释的情况下使用锚的解决方案。有人能帮我吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-13T07:51:02.833

`data-ajax`是 jQuery Mobile 的一个特性。默认情况下，JQM 将尝试通过 ajax 加载页面以改善用户体验和转换。如果您设置`data-ajax='false'`，那么 JQM 将执行正常的页面请求，而不是使用 ajax。这可以用于表单和链接。

从[文档](http://jquerymobile.com/demos/1.0a4.1/docs/pages/docs-pages.html)：

> 这告诉框架重新加载整个页面以清除 URL 中的 Ajax 哈希

如果您想在所有链接上禁用 ajax，那么`data-ajax`您可以这样做：

```
$(document).bind("mobileinit", function () {
    $.mobile.ajaxEnabled = false;
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T07:47:16.630

什么都没有。

[`data-*`](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)是一组通用属性，您可以在其中存储数据以供 JavaScript 访问。

除非你有一些 JavaScript 来处理它们，否则它们是没有意义的。

jQuery 没有内置任何东西可以对它们做任何事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-13T07:55:14.737

如果将元素的属性设置为 data-name，则可以通过 jQuery 使用`$('element').data('name')`而不是 来获取它`$('element').attr('data-name');`，但`data-*`属性仍然可以用于事件委托，例如`$(document).on('click', '[data-name]', function(){});`

# php - 重定向到上一页

> ID：13357094
> 
> 赞同：0
> 
> 时间：2012-11-13T07:45:22.063
> 
> 标签：php, codeigniter

所以在这里我有“也许是另一个愚蠢的问题”所以在这里我想问一下如果情况是这样的话如何重定向到上一页：我有观点：

一个。home_view b. about_view c. 联系人视图

然后我有登录视图（现在我登录后它会将我重定向到home_view）

我希望如果我从 about_view 访问 login_view，那么重定向功能会将我重定向到 about_view，或者如果我从 contact_view 访问 login_view，那么重定向功能会将我重定向到 contact_view 等等。如何使重定向功能到上一页（不是单页）？也许一些使用php的技巧？还是codeigniter本身？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T07:51:56.890

您可以使用查询字符串来解决此问题。就像当您从 about us 页面访问 url 调用登录脚本时一样**login.php?page=1**其中 page=1 用于 aboutus 页面同样您可以 page=2 用于联系我们页面。在登录页面，您可以通过查询字符串获取重定向页面，可以在成功登录后使用标题功能重定向到相应的页面。例如`Header('Location:about.php');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:22:52.853

当您登录并转到 login_view 时，这很简单，只需在登录时将默认重定向设置为 about_view 或 contact_view。但是，如果您想重定向到上一页，则必须使用 session 来欺骗必须设置 session ex : `$SESSION['last_view'] = $yourlastview;`。$yourlastview 可以在您在 about_view 或 contact_view 或其他视图中设置，当您转到 login_view 时，只需检查`$SESSION['last_view']`并重定向到该视图。

问候

杰弗里

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-13T07:49:06.507

只需使用重定向($_SERVER['HTTP_REFERER'],'refresh')

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-13T07:49:55.640

这行得通。

```
$this->load->library('user_agent');
redirect($this->agent->referrer()); 
```

# php - 了解stripos偏移？

> ID：13357100
> 
> 赞同：1
> 
> 时间：2012-11-13T07:45:53.890
> 
> 标签：php, stripos

假设我有一个小数组 () ：

```
 $array = array(
        'Pantin',
        'Paris',
        'Paris',
        'Puhahaa',
        'Ptdr',
        'Roumanie',
        'Rlolo'
    ); 
```

我想做的事？只需获取所有以“r”字母开头的单词

```
$dataLen = sizeof($array);
$results = array();

for ($i = 0; $i < $dataLen && count($array) < 10; $i++) {
    if (stripos($array[$i], 'r', 0)) { // 

        array_push($results, $array[$i]); 
    }
}

print_r($results); // Output : Array ( [0] => Paris [1] => Paris [2] => Ptdr ) 
```

我不明白.. 我把 0 作为偏移量，但它给了我以 P 字母开头并且“包含” R 字母的单词。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T07:50:57.580

零是默认值，所以这些东西是等价的；

```
stripos($array[$i], 'r', 0)
stripos($array[$i], 'r') // Same 
```

也就是说，它们从位置 0 开始并尝试找到字母`r`or `R`。如果它不在位置 0，他们检查第二个字母，然后是第三个字母，依此类推。

Stripos 返回找到的字母的位置。对于*Paris*，返回 2，对于*Rlolo*，返回 0。如果未找到，则返回 false。

默认情况下，0 和 false 都被解释为 false。因此，如果第一个字母是`R`，则`stripos`返回 0 并且不执行 if 语句。要解决此问题，请使用以下代码：

```
if (stripos($array[$i], 'r') !== false) { ... } 
```

如果您只想检查第一个字母而不是后面的字母，您可以执行以下操作：

```
$word = $array[$i];
$firstLetter = $word[0];
if ($firstLetter == 'r' || $firstLetter == 'R') { ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T07:52:29.870

另一种方法是使用带有回调的array_filter。

```
$results = array_filter($array, function($var) {
    return strtolower($var[0]) == 'r';
}); 
```

（当然你也可以使用`return stripos($var, 'r') === 0;`）

# php - 发送邮件后带有问号的php菱形

> ID：13357103
> 
> 赞同：1
> 
> 时间：2012-11-13T07:46:10.520
> 
> 标签：php

我有一个显示考试（希伯来语）的 php 页面，它显示正确，在底部我有一个考试的发送邮件按钮给自己。

问题在于，在我将邮件发送给自己之后，邮件是希伯来语的，但是我看到了一些字母“�”。

字符集：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

我的标题字符集也在 UTF-8 中，我也尝试了 ISO-8859-1，但它给了我同样的结果。

最奇怪的是，当我将标题字符集更改为 Big5（中文）时，我需要在我的电子邮件乱码中看到，但我看到了相同的消息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:48:14.320

这是我的代码：

```
$content = 
    writeExamDetails() .
    writeStudnetDetails() .
    writeAnswers($numOfQuestions);

    if ($_POST['studentComments']!=null) {
        $content .= "<p align=\"" . $text['align'] . "\"><strong>" . 
                    $text['studentComments'] .
                    ":</strong><br />" .
                    formatStr($_POST['studentComments']) . 
                    "</p>";
    }

    $body = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" >
    <html>
    <head>
    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />
    <title>" . 
    $text['emailResultsPageTitle'] . 
    "</title>
    <style>
    body {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 0.9em;
    direction: " . $text['dir'] . ";
    text-align: " . $text['align'] . ";
    }
    </style>
    </head>
    <body>
    <p dir=\"ltr\" style=\"color:#999999;\">
    If you cannot view the following contents properly, change the Encoding to Unicode (UTF-8).</p>" .
    $content;

    $body .= "<hr noshade=\"noshade\" height=\"1\" /><p>" . 
            $text['emailResultsDurationTitle'] . ": " . 
            duration((int)($_POST['lapsedTime']/1000)) .
            "</p>
            </body>
            </html>";

    $subject = "" . trim(stripslashes(stripslashes($_POST['examTitle'])));
                //formatStr2html($_POST['examTitle']);
    if (isset($_POST['studentId'])){
        $subject .= " (ID: " . $_POST['studentId'] . ")";
    }

    $headers = "From: " . $from . "\n" . $cc . 
                "Subject: " . $subject ."\n" .
                "X-Mailer: PHP/" . phpversion() . "\n" .
                "MIME-Version: 1.0\n" .
                "X-Priority: 1\n" . "Importance: High\n" . "X-MSMail-Priority: High\n" .
                "Content-Type: text/html; charset=iso-8859-1\n";
                "Content-Transfer-Encoding: 8bit\r\n\r\n";

    $result = mail ($to, $subject, $body, $headers); 
```

这就是它在希伯来语中的样子（我希望你理解希伯来语）

在浏览器中（正确）--->“אחת שתים בדיקה אחת שתים בדיקה”

在电子邮件中（不正确）--->“אחת שת�ם בדיקה אחת שתים בדי�קה”

# java - 跑步 在上下文创建开始时

> ID：13357109
> 
> 赞同：6
> 
> 时间：2012-11-13T07:46:54.997
> 
> 标签：java, spring, properties

我需要在 Spring 的上下文中初始化`SQL`之前执行脚本`PropertyPlaceholderConfigurer`，只要应用程序属性存储在数据库中并且该脚本应该插入它们。但是当前占位符初始化较早，这会导致错误。

有没有办法在 Spring`<jdbc:initialize-database data-source="dataSource" ...`之前执行？`<bean id="placeholderConfig" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" ...`

或者有没有办法`placeholderConfig`稍后初始化bean？我尝试为这个 bean 使用`depends-on`,`lazy-init`属性，但没有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-29T10:52:11.573

另一种不创建任何 Bean 的解决方案：如果你有一个`<jdbc:initialize-database />`，你可以将此属性添加`depends-on="org.springframework.jdbc.datasource.init.DataSourceInitializer#0"`到你的 bean`<bean id="placeholderConfig" />`

如果你有不止一个`<jdbc:initialize-database />`适应`#0`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-13T12:37:19.797

这就是我解决这个问题的方法。我创建了一个类`Initializer`。此类在其构造函数中执行普通的旧 sql 语句 ( `java.sql.Statement`)，创建表（如果它不存在），并插入属性（如果它们不存在）。bean在`dataSource`上下文中传递给此构造函数，并且`placeholderConfig`bean 使用`depends-on="initializerBean"`. 因此，属性在使用之前出现在数据库中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-27T12:09:30.633

这个脚本

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xsi:schemaLocation="http://www.springframework.org/schema/jdbc">

    <jdbc:initialize-database data-source="dataSource">
        <jdbc:script location="classpath:database/drop_schema.sql" />
        <jdbc:script location="classpath:database/create_schema.sql" />
        <jdbc:script location="classpath:database/sample_data.sql"/>
    </jdbc:initialize-database>
    <!-- Other bean definitions -->
</bean> 
```

本质上是一个捷径

```
<bean class="org.springframework.jdbc.datasource.init.DataSourceInitializer" id="dataSourceInitializer">
    <property name="databasePopulator" ref="resourceDatabasePopulator"/>
    <property name="dataSource" ref="dataSource"/>
</bean>
<bean id="resourceDatabasePopulator"
      class="org.springframework.jdbc.datasource.init.ResourceDatabasePopulator">
    <property name="scripts">
        <array>
            <value>classpath:database/drop_schema.sql</value>
            <value>classpath:database/create_schema.sql</value>
            <value>classpath:database/sample_data.sql</value>
        </array>
    </property>
</bean> 
```

请注意，我已将 id 添加到 DataSourceInitializer bean。现在您可以在 PropertyPlaceholderConfigurer 的`depends-on`属性中引用它。这样你就声明你的 PropertyPlaceholderConfigurer 应该在 DataSourceInitializer 之后创建。

```
<bean id="placeholderConfig" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" depends-on="dataSourceInitializer"/> 
```

在我的情况下，数据库是在创建 LocalContainerEntityManagerFactoryBean 之后初始化的，并且 Hibernate 无法验证我的模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T11:11:32.297

文档解释了如何处理这些问题： [http ://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch12s09.html](http://static.springsource.org/spring/docs/3.0.0.RC3/reference/html/ch12s09.html)

```
12.9.1.1 Initialization of Other Components that Depend on the Database 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-06T06:38:33.530

我们的用例可以说更加复杂。我们使用[flyway](http://flywaydb.org/)进行数据库迁移，它需要在`entityManagerFactory`创建之前启动。对我们而言，问题在于`<jdbc:initialize-database />`它仅在我们的迁移测试中使用，因此在`flyway`与`entityManagerFactory`. 所以我们不能简单地使用[L. BIZE](https://stackoverflow.com/a/21428833/398441)答案并让我们的`flyway`bean 依赖，`org.springframework.jdbc.datasource.init.DataSourceInitializer#0`因为它可能不存在（即在生产中它不存在）。我们最终创建了一个自定义工厂 bean，如下所示：

```
class OptionalBeanInitializer extends AbstractFactoryBean implements BeanFactoryAware {
    private String beanName;
    private BeanFactory beanFactory;

    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        this.beanFactory = beanFactory;
    }

    @Override
    public Class<?> getObjectType() {
        return OptionalBeanInitializer.class;
    }

    public void setBeanName(String beanName) {
        this.beanName = beanName;
    }

    @Override
    protected Object createInstance() throws Exception {
        if (beanFactory.containsBean(beanName)) {
            // Initialize
            beanFactory.getBean(beanName);
        }
        return new OptionalBeanInitializer();
    }
} 
```

我们可以使用它来依赖我们的可选依赖项，如下所示：

```
<bean id="optionalDataSourceInitializer" class="com.x.y.z.OptionalBeanInitializer">
       <property name="beanName" value="org.springframework.jdbc.datasource.init.DataSourceInitializer#0"/>
</bean>   

 <bean id="flyway" class="com.googlecode.flyway.core.Flyway" init-method="migrate" depends-on="optionalDataSourceInitializer">
       <property name="dataSource" ref="dataSource"/>
 </bean>

 <bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory"
          depends-on="flyway, optionalDataSourceInitializer">
       <property name="dataSource" ref="dataSource"/>
 </bean> 
```

*仅*当bean 存在时才`OptionalBeanInitializer`负责初始化`org.springframework.jdbc.datasource.init.DataSourceInitializer#0`bean 。

 ** * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-05T08:54:11.460

有两种更简单的方法可以仅为测试上下文添加依赖属性，而不是为生产上下文添加依赖属性。

1/覆盖测试上下文中的bean。在我们的例子中，这里是生产环境：

```
<bean id="placeholderConfig" /> 
```

和单元测试上下文：

```
<bean id="placeholderConfig" depends-on="org.springframework.jdbc.datasource.init.DataSourceInitializer#0" /> 
```

确保在生产上下文之前加载单元测试上下文，并且在 jdbc:initialize-database 阶段之后将实例化好的 placeholderConfig bean。

2/另一种方法是使用配置文件

```
<beans profile="!test">
    <bean id="placeholderConfig" .../>
</beans>
<beans profile="test">
    <jdbc:initialize-database data-source="dataSource" .../>
    <bean id="placeholderConfig" depends-on="org.springframework.jdbc.datasource.init.DataSourceInitializer#0" .../>
</beans> 
```*

# python - Django wsgiref/handlers.py 像往常一样抛出异常

> ID：13357110
> 
> 赞同：1
> 
> 时间：2012-11-13T07:47:10.437
> 
> 标签：python, django, postgresql, sqlite

[在这篇文章http://www.tdd-django-tutorial.com/tutorial/1/](http://www.tdd-django-tutorial.com/tutorial/1/)之后，我正在做一些 django TDD 示例。

但是当我尝试运行我的测试时，我总是遇到这个问题，

```
Creating test database for alias 'default'...
Traceback (most recent call last):
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py", line 85, in run
self.result = application(self.environ, self.start_response)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/staticfiles/handlers.py", line 67, in __call__
return self.application(environ, start_response)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/staticfiles/handlers.py", line 68, in __call__
return super(StaticFilesHandler, self).__call__(environ, start_response)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/handlers/wsgi.py", line 241, in __call__
response = self.get_response(request)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/staticfiles/handlers.py", line 63, in get_response
return super(StaticFilesHandler, self).get_response(request)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/handlers/base.py", line 153, in get_response
response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/handlers/base.py", line 228, in handle_uncaught_exception
return callback(request, **param_dict)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/utils/decorators.py", line 91, in _wrapped_view
response = view_func(request, *args, **kwargs)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/views/defaults.py", line 32, in server_error
t = loader.get_template(template_name) # You need to create a 500.html template.
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/template/loader.py", line 145, in get_template
template, origin = find_template(template_name)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/template/loader.py", line 138, in find_template
raise TemplateDoesNotExist(name)
TemplateDoesNotExist: 500.html 
```

我试过 Postgres 和 Sqlite3，同样的输出折磨了我很多。

有谁知道我为什么得到这个？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:25:10.940

异常消息说明出了什么问题。

```
TemplateDoesNotExist: 500.html 
```

似乎您`500.html`在 django 正在寻找您的模板的任何地方都缺少该文件。确保此文件存在。

我会假设您的应用程序存在内部错误，并且 Django 正在尝试呈现它的`500 Internal Server Error`页面，但找不到该页面。Django 可能在此异常发生之前捕获了一个较早的异常。

# javascript - 未创建 SQLITE DB - PhoneGap

> ID：13357112
> 
> 赞同：3
> 
> 时间：2012-11-13T07:47:17.350
> 
> 标签：javascript, android, sqlite, cordova

我有一个 Phonegap (2.1.0) 应用程序，它 onDeviceready 创建一个数据库并用信息填充一个表。

在 Chrome 上本地运行（使用 Ripple 模拟器）可以工作。正在根据需要创建和填充表。

在我的 Android 设备上安装 build .apk 后，我的 Eclipse logcat 显示：

```
 sqlite returned: error code = 14, msg = cannot open file at line 27712 of [8609a15dfa], db=/data/data/<project>/databases/webview.db

    sqlite returned: error code = 14, msg = os_unix.c: open() at line 27712 - "" errno=2 path=/CachedGeoposition.db, db=/data/data/<project>/databases/webview.db 
```

[根据这里](https://stackoverflow.com/questions/7316191/android-sqlite-returned-error-code-14)的这篇文章，我相信- 可以忽略。

但是 - 我在 logcat 中也注意到了这个错误：

```
 sqlite returned: error code = 1, msg = no such table: latest_events, db=/data/data/<project>/databases/webview.db 
```

我还 - 通过 adb shell - 确认没有创建数据库：这里：/data/data/com.application/databases。或在这里：/data/data/com.application/app_databases

所以 - 我的代码：

```
 if (!window.openDatabase) {
        doMessage('Databases are not supported on this device. Sorry','error');
        return;
    }else{
        consoleLog('all good for storage');
        var db;
        var shortName = 'MyDB';
        var version = '1.0';
        var displayName = 'MyDB';
        var maxSize = 102400;

        function errorHandler(transaction, error) {consoleLog('Error: ' + error.message + ' code: ' + error.code);}

        function nullHandler(){};
        db = window.openDatabase(shortName, version, displayName,maxSize);

            consoleLog('starting table creation');
            db.transaction(function(tx){
                tx.executeSql( 'CREATE TABLE IF NOT EXISTS latest_events (id integer PRIMARY KEY AUTOINCREMENT,EventID integer,EventLocation text,EventName text,EventDateFrom varchar,EventTime timestamp,EventPresentedBy varchar,EventVenue varchar,EventScript text,RequireRSVP varchar)',[],nullHandler,errorHandler);
                db.transaction(function(tx){
                    tx.executeSql('SELECT count(id) as RowCount FROM device_info ', [],
                        function(tx, result) {
                            if (result != null && result.rows != null) {
                                for (var i = 0; i < result.rows.length; i++) {
                                    var row = result.rows.item(i);
                                    consoleLog('rowcount: '+row.RowCount);
                                    if(row.RowCount==0){
                                        tx.executeSql('INSERT INTO device_info (device_name, device_platform, device_uuid, device_os_ver, date_last_used) VALUES (?,?,?,?,?)',[device.name, device.platform, device.uuid, device.version, window.bowman_config.siteDate],nullHandler,errorHandler);
                                        //doMessage('device info row added','notice');
                                    }
                                }
                            }
                        },errorHandler);
                },errorHandler,successCallBack('2'));
                //doMessage('device info row added','notice');
            },errorHandler,successCallBack('1'));
} 
```

为了增加我的麻烦 - 在我的 logcat 上，我确实看到了 console.log 输出“一切都适合存储”，以及“开始创建表”消息。

My errorHandler functions are not returning anything and my successCallBack functions are triggered...but no DB created.

Thanks for the help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T19:18:44.020

When you pass in successCallBack("2") and successCallBack("1") then you are actually invoking them directly so you may be getting false positives on whether or not success has actually been called. You should provide two separate success call backs or just in-line some functions that call console.log("1") for instance.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T16:18:50.463

Today this issue cost me 3 hours. What I tried:

*   Rewriting the copy database code.
*   Deleting the app from the emulator / device
*   Wiping emulator(s)
*   Cleaning eclipse
*   Changing file permissions
*   Validate a working SQLite database file

I solved the problem by copying the code from a shared Dropbox account to another location and refactoring the code in the Android Manifest and java files with another package name.

The application runs beautifully now, i.e. nothing wrong with the code, but somewhere it's muxed up by Dropbox.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T15:36:40.050

I broke the nested functions up into single functions and 'chained' them based on their success or fail. It's actually been a lot simpler than I thought. RTFM it seemed. Thanks for all the help.

simplified:

```
var db = window.openDatabase("TheApp", "1.0", "The App", 50000000);
db.transaction(queryDB, errorCB, successCB);

// Query the database   //
function queryDB(tx) {
    //tx.executeSql('SELECT * FROM table", [], querySuccess, errorCB);
}

function querySuccess(tx, results) {
    //do more functions here
}

function errorCB(err) {
    console.log("Error processing SQL: "+err.code);
} 
```

# android - 修改动画列表中的图片大小

> ID：13357114
> 
> 赞同：0
> 
> 时间：2012-11-13T07:47:24.787
> 
> 标签：android

我想实现动画中动态显示的图片——列表。但我不知道如何修改图片大小。因为我想让图片以 px 样式显示而不是 dip 。但动画中的图片 - 列表显示默认。如何修改动画 - 列出图片大小？又如何改成图片显示的px默认值？

# c++ - 从其他专用函数调用专用函数

> ID：13357116
> 
> 赞同：4
> 
> 时间：2012-11-13T07:47:44.770
> 
> 标签：c++, templates, visual-c++

我有一个错误

```
C2910: 'TEMPLATE_TEST::FuncTemplateTest::InnerFunc' : cannot be explicitly specialized, 
```

在编译下面的代码时。有两个模板函数，它们都是专门的。当我删除`InnerFunc`专用外部调用中的调用时，一切正常。那么，问题出在哪里？（我正在使用 MS VS 2008。）

```
class FuncTemplateTest {

public:
    template<typename T>
    const int OuterFunc(const T& key) const;

private:
    template<typename T>
    const int InnerFunc(const T& key) const;
};

template<typename T>
inline const int FuncTemplateTest::OuterFunc(const T &key) const 
{
     std::cout<<"Outer template\n";
     return InnerFunc(key);
}

template<>
inline const int FuncTemplateTest::OuterFunc<std::string>(const std::string &key) const 
{
    std::cout<<"Outer special\n" << key << '\n';
    InnerFunc(key); //remove this line to compile!!!
    return 1;
}

template<typename T>
inline const int FuncTemplateTest::InnerFunc(const T &key) const
{
     std::cout << "Inner template\nTemplate key\n";
     return 0;
}   

template<>
inline const int FuncTemplateTest::InnerFunc<std::string>(const std::string &key) const
{
    std::cout << key << '\n';
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:53:36.013

我相信问题的原因是您`InnerFunc`在`OuterFunc`.

如果您**将 的定义移到 的定义`InnerFunc`之前`OuterFunc`**，您应该没问题。（在 GCC 上，这确实解决了这个问题。）

* * *

单独说明：您的函数的返回类型是`const int`，这不是不正确的，但也很无用（`const`当基本数据类型通过复制返回时被忽略）。

# php - PHP 从 postgresql 数据库构建一个特定的 JSON 字符串

> ID：13357118
> 
> 赞同：2
> 
> 时间：2012-11-13T07:47:54.777
> 
> 标签：php, string, postgresql, json

我想用我的 postressql 数据库使用 zachhunters json 到 html tabel 脚本，所以我需要一个特定的 JSON 字符串格式，但我不知道如何构建它......（我是 json 新手）

[链接到脚本](http://www.zachhunter.com/2010/04/json-objects-to-html-table)

我使用

```
$result = pg_fetch_array($rs, NULL, PGSQL_ASSOC); 
```

当我使用`json_encode($result)`我得到这个：

```
{"id":"2","surname":"Max","name":"Muster"} etc. 
```

对于脚本，我需要类似的东西：

```
{ "d": "[{\"id\":1,\"Username\":\"Sam Smith\"},{\"id\":2,\"UserName\":\"Fred Frankly\"}]" } 
```

我该如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T07:50:51.493

在从数据库中获取元素的每个循环中，将其存储`$result`在一个数组`$rows`中。

在循环之后，只需使用`json_encode(array('d' => $rows))`创建包含所有数据的 JSON。

# c# - 在位图周围绘制边框

> ID：13357121
> 
> 赞同：7
> 
> 时间：2012-11-13T07:48:28.503
> 
> 标签：c#, graphics, bitmap, compact-framework

我的代码中有一个`System.Drawing.Bitmap`。

宽度是固定的，高度是变化的。

我想要做的是在位图周围添加一个白色边框，大约 20 像素，到所有 4 个边缘。

这将如何工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T08:56:55.383

您可以使用 Bitmap 类的 'SetPixel' 方法，用颜色设置必要的像素。但更方便的是使用['Graphics'](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.aspx)类，如下图：

```
bmp = new Bitmap(FileName);
//bmp = new Bitmap(bmp, new System.Drawing.Size(40, 40));

System.Drawing.Graphics gr = System.Drawing.Graphics.FromImage(bmp);

gr.DrawLine(new Pen(Brushes.White, 20), new Point(0, 0), new Point(0, 40));
gr.DrawLine(new Pen(Brushes.White, 20), new Point(0, 0), new Point(40, 0));
gr.DrawLine(new Pen(Brushes.White, 20), new Point(0, 40), new Point(40, 40));
gr.DrawLine(new Pen(Brushes.White, 20), new Point(40, 0), new Point(40, 40)); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-13T08:20:12.720

您可以在位图后面绘制一个矩形。矩形的宽度为 (Bitmap.Width + BorderWidth * 2)，位置为 (Bitmap.Position - new Point(BorderWidth, BorderWidth))。或者至少我会这样做。

编辑：这是一些实际的源代码，解释了如何实现它（如果你有一个专门的方法来绘制图像）：

```
private void DrawBitmapWithBorder(Bitmap bmp, Point pos, Graphics g) {
    const int borderSize = 20;

    using (Brush border = new SolidBrush(Color.White /* Change it to whichever color you want. */)) {
        g.FillRectangle(border, pos.X - borderSize, pos.Y - borderSize, 
            bmp.Width + borderSize, bmp.Height + borderSize);
    }

    g.DrawImage(bmp, pos);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-05-08T07:39:20.917

下面的函数将在位图图像周围添加边框。原始图像的大小将增加边框的宽度。

```
private static Bitmap DrawBitmapWithBorder(Bitmap bmp, int borderSize = 10)
{
    int newWidth = bmp.Width + (borderSize * 2);
    int newHeight = bmp.Height + (borderSize * 2);

    Image newImage = new Bitmap(newWidth, newHeight);
    using (Graphics gfx = Graphics.FromImage(newImage))
    {
        using (Brush border = new SolidBrush(Color.White))
        {
            gfx.FillRectangle(border, 0, 0,
                newWidth, newHeight);
        }
        gfx.DrawImage(bmp, new Rectangle(borderSize, borderSize, bmp.Width, bmp.Height));

    }
    return (Bitmap)newImage;
} 
```

# .net - 从“System.IO.Stream”隐式向下转换为“System.IO.MemoryStream”

> ID：13357122
> 
> 赞同：1
> 
> 时间：2012-11-13T07:49:04.260
> 
> 标签：.net, casting, unity3d, downcast, unityscript

```
function SerializeObject(pObject : Object)
{
   var XmlizedString : String  = null;
   var memoryStream : MemoryStream  = new MemoryStream();
   var xs : XmlSerializer = new XmlSerializer(typeof(XmlData));
   var xmlTextWriter : XmlTextWriter  = new XmlTextWriter(memoryStream, Encoding.UTF8);
   xs.Serialize(xmlTextWriter, pObject);
   memoryStream = xmlTextWriter.BaseStream;
   XmlizedString = UTF8ByteArrayToString(memoryStream.ToArray());
   return XmlizedString;
} 
```

问题在于：

```
memoryStream = xmlTextWriter.BaseStream; 
```

我知道 xmlTextWriter.BaseStream 属于流类型，但是我将如何进行类型转换呢？

感谢您在高级的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:09:36.580

您可以使用`as`参考类型。

尝试：

```
memoryStream = xmlTextWriter.BaseStream as MemoryStream; 
```

有关更多详细信息，请参阅此问题：[如何在 UnityScript 中执行显式类型转换？](http://answers.unity3d.com/questions/279809/how-to-perform-explicit-typecasting-in-unityscript.html)

# c - c fscanf 按模式保存

> ID：13357128
> 
> 赞同：1
> 
> 时间：2012-11-13T07:49:37.683
> 
> 标签：c

这是我试图拆分的行，从开始到`:`，吃掉任何空格，然后从那里开始：

```
file1: file2,file3,file4 
```

我的代码是：

```
while(fscanf(fp,"%s: %s",map[i].name, map[i].filesNeeded) == 1)
{
   printf("%s %s\n",map[i].name, map[i].filesNeeded);
   i++;
} 
```

第二个参数永远不会保存。结果是：

```
file1: 
file2,file3,file4 
```

代替：

```
file1 file2,file3,file4 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:56:53.157

首先， fscanf 将为每个匹配的项目增加返回值，所以它应该是 == 2。

此外，您将需要使用 %[^:] 而不是 %s，因为 %s 不知道何时停止。

```
int main(int argc, char** argv)
{
  char test[] = "one: two,three";

  char part1[20];
  char part2[20];

  printf("%i\n", sscanf(test, "%[^:]: %s", part1, part2));

  printf("%s %s\n", part1, part2);
} 
```

输出：

```
2
one two,three 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:54:32.407

```
while(fscanf(fp,"%[^:]: %s",map[i].name, map[i].filesNeeded) == 2)
{
   printf("%s %s\n",map[i].name, map[i].filesNeeded);
   i++;
} 
```

我修改了代码，你可以试试看。

# javascript - 如何选择一个 在按值下拉列表中并为其分配“选定”属性？

> ID：13357131
> 
> 赞同：0
> 
> 时间：2012-11-13T07:49:43.310
> 
> 标签：javascript, jquery, html

对于下拉列表 ( `<select>`)，有时我需要找到具有给定值的选项并将`selected`属性分配给它。

例如：

```
<select id="font-size">
    <option value="12">12px</option>
    <option value="13">13px</option>
    <option value="14">14px</option>
</select> 
```

在上面的示例中，如何将“selected='selected'”属性添加到`option`值为 14 的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:51:13.333

这会做到：

```
$('#font-size').val(14); 
```

注意：这会在所需元素上设置`selected` *属性- 该**属性*表示页面首次加载时下拉菜单的*初始*值。`<option>`

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:03:44.660

如果您需要在页面加载时设置初始值，请使用，

```
 $(document).ready(function() {
    $('#font-size').val(14);
   }); 
```

否则，如果您想要加载后用户选择的值，请使用它，

```
 $(document).ready(function() {
     $('#font-size').change(function() {
       alert($(this).val());
     });
   }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:29:01.900

```
document.getElementById("font-size").value = "14"; 
```**

# java - java：匿名类

> ID：13357132
> 
> 赞同：1
> 
> 时间：2012-11-13T07:49:49.483
> 
> 标签：java, anonymous-class

在java中这是有效的

```
new Thread(new Runnable()
    {   
        public void run()
        {
            for(int i=0;i<5;i++)
                System.out.println("From anonymous:"+i);
        }
    }   
).start(); 
```

但这不是：

```
Thread t=new Thread(new Runnable()
    {   
        public void run()
        {
            for(int i=0;i<5;i++)
                System.out.println("From anonymous:"+i);
        }
    }   
).start(); 
```

我可以用匿名类来实现吗？如果是，那么如何

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T07:51:10.243

您的代码不起作用，因为它想将`start()`方法的结果分配给变量`t`。你可以这样做：

```
Thread t=new Thread(new Runnable()
    {   
        public void run()
        {
            for(int i=0;i<5;i++)
                System.out.println("From anonymous:"+i);
        }
    }   
);
t.start(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T08:45:56.570

此外，在这种情况下，您不需要使用 Runnable 接口，因为它是由 Thread 类实现的。

```
 new Thread() {
        @Override
        public void run() {
            for(int i=0;i<5;i++)
               System.out.println("From anonymous:"+i);
        }
    }.start(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T09:04:44.797

这里需要注意的一点是Thread的[start方法返回 void。](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#start%28%29)这就是为什么您不能将其分配给变量的原因。

# hadoop - 带有数据挖掘的 MapReduce 项目

> ID：13357136
> 
> 赞同：1
> 
> 时间：2012-11-13T07:49:57.453
> 
> 标签：hadoop, parallel-processing, mapreduce, data-mining

我打算做一个涉及**Hadoop库的****MapReduce 项目，并在****AWS**上传的大数据上对其进行测试。我还没有最终确定一个想法。但我确信它将涉及某种数据处理、**MapReduce 设计模式**以及可能的**图形算法、Hive 和 PigLatin**。如果有人能给我一些想法，我将不胜感激。我的想法很少。

 ******最后，我必须处理一些大型数据集并获取一些信息并得出一些结论。为此，我之前使用**Weka**进行数据挖掘（使用 Trees）。

但我不确定这是否是我现在唯一可以使用的东西（使用 Weka）。有没有其他方法可以处理大数据并得出关于大数据集的结论？

另外，我如何在其中涉及图表？

基本上我想做一个研究项目，但我不确定我到底应该做什么以及应该是什么样的？有什么想法吗 ？暗示性链接/想法？知识共享 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:57:23.293

我建议你检查一下[Apache Mahout](http://mahout.apache.org/)，它是一个可扩展的机器学习和数据挖掘框架，应该与 Hadoop 很好地集成。

Hive 为您提供了类似 SQL 的语言来查询大数据，本质上它将您的高级查询转换为 MapReduce 作业并在数据集群上运行它。

另一个建议是考虑使用 R 进行数据处理算法，它是一个统计软件（类似于 matlab），我建议使用[R Revolution](http://www.revolutionanalytics.com/products/revolution-r.php)代替标准 R 环境，这是一个开发 R 的环境，但使用用于大数据和集群的强大工具。

**编辑：**如果你是学生，R Revolution 有一个免费的学术版。

**编辑：**第三个建议是查看[GridGain](http://www.gridgain.com/)，它是 Java 中的另一个 Map/Reduce 实现，相对容易在集群上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T12:27:35.370

由于您已经在使用 MapRedude 和 Hadoop，您可以使用[Mahout](http://mahout.apache.org/)从数据中提取一些知识，或者您可以从这本非常好的书中获得一些想法：

[http://infolab.stanford.edu/~ullman/mmds.html](http://infolab.stanford.edu/~ullman/mmds.html)

这本书提供了挖掘社交网络图的想法，并以其他几种方式处理图。

希望能帮助到你！******

# php - 为什么我的表单验证不起作用？

> ID：13357137
> 
> 赞同：-1
> 
> 时间：2012-11-13T07:50:23.113
> 
> 标签：php, forms, validation, header, preg-match

我在验证表单时遇到问题。如何使用 PHP 验证表单？我尝试了很多不同的方法，但没有任何效果。我可以让输入显示（尽管复选框并不总是显示），但它不会验证。

我还想将用户的输入（经过验证后）显示到另一个页面上，我该怎么做？

这是我的代码；

形式：

```
<form action="<?php $_SERVER['PHP_SELF'];?>" method="post">
<label for="name">Your Name:</label>
<input type="text" name="name" id="name" value="" required>
<br><br>
<label for="email">Your Email:</label>
<input type="text" name="email" id="email" value="" required>

<br>
<br>
<label for="subject">Subject:</label>
<input type="text" name="subject" id="subject" value="" required>
<br>
<br>
Recipient:
<div>
 <label for="admin">
  <input type="checkbox" name="recipient[]" id="admin"  value="Administrator">
  Administrator</label>
 <br>
 <label for="editor">
  <input type="checkbox" name="recipient[]" id="editor"  value="Content Editor">
  Content Editor</label>
  <br>
 </div>
<br>
<label for="message">Message:</label>
<br>

<textarea name="message" id="message" cols="45" rows="5" required></textarea>
<input type="hidden" name="submitted" value="1">
<br>
<input type="submit" name="button" id="button" value="Send">
<br>
</form> 
```

PHP：

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$subject = $_POST['subject'];
$message = $_POST['message'];

 if ($_POST['submitted']==1) {  

        if ($_POST['name']){  
            $name = $_POST['name'];

        }  
        else{  
             echo "<p>Please enter a name.</p>" ;  
        }  

        if (preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/i", $email))
          $email = $_POST['email'];

        }  
        else{  
            echo "<p>Please enter a valid email.</p>";  
        } 
        if ($_POST['subject']){  
            $subject = $_POST['subject'];

        }  
        else{  
             echo "<p>Please enter a subject.</p>"; 

      if(empty($_POST['recipient'])){
        echo "<p>Please select a recipient</p>"; 
       }else{
              for ($i=0; $i < count($_POST['recipient']);$i++) {
                  echo $_POST['recipient'][$i] . " ";
              }
      } 

        }   
        if ($_POST['message']){  
            $message = $_POST['message'];

        }  

/* go to form.php
display results
echo "<strong>Your Name:</strong> ".$name. "<br />";
echo "<strong>Your Email:</strong> ".$email. "<br />";
echo "<strong>Subject:</strong> ".$subject. "<br />";
echo "<strong>Recipient:</strong> "; 
echo "<br />"; 
echo "<strong>Message:</strong> <br /> " .$message;  
*/
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:26:15.297

if (preg_match("/^[_a-z0-9-]+(.[_a-z0-9-]+) *@[a-z0-9-]+(.[a-z0-9-]+)* (.[az]{2,3})$/i", $email)

在这种情况下您不能使用电子邮件，因为 $email 是空的！

# google-apps-script - 打开电子表格

> ID：13357139
> 
> 赞同：1
> 
> 时间：2012-11-13T07:50:29.797
> 
> 标签：google-apps-script, google-sheets

当我使用 SpreadsheetApp.openById("abc12s4562") 打开共享的谷歌文档电子表格时，我想知道是否有人正在阅读电子表格，如果是真的，我想显示一个弹出窗口来通知读者。你认为有可能做到这一点吗？如何 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:05:39.233

当有人*打开*电子表格时可以“检测”到，但事实并非如此。您所拥有的是可以挂钩以触发脚本的事件`onOpen`和`onEdit`事件，然后您可以向用户弹出一些内容。

弹出窗口不能被这样的脚本任意触发。而且没有办法知道是否有人正在查看电子表格，您只有`onEdit`.

如果您想警告用户脚本正在处理电子表格，他们应该稍等片刻。您可以更改电子表格本身的一些视觉设置。可能会更改部分或所有单元格的背景颜色。甚至以编程方式保护工作表以真正避免并发问题。

# sql-server - 如何根据 SSRS 中的变量报告表格？

> ID：13357140
> 
> 赞同：0
> 
> 时间：2012-11-13T07:50:33.273
> 
> 标签：sql-server, reporting-services

您如何根据用户选择列出任何表（或所有表）的详细信息？例如，我想要一个包含查询的数据集：

```
SELECT * FROM @TableName 
```

然后`@TableName`将从 sys.tables 中获取表列表。我的数据库版本是 SQL 2008 R2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T00:15:38.803

要填充您的`@TableName`参数，您可以使用：

```
SELECT name FROM sys.tables 
```

那么你的 Dataset 的 Sql Statement 可以是一个表达式：

```
="SELECT * FROM " & Parameters!TableName.Value 
```

但是，这不会特别有用。当 Sql 语句将执行时，字段名称将是什么？我想，这对于数据库中的每个表都会有所不同。当 Sql 语句是表达式时，字段名称不会自动填充，您必须手动添加它们。然后你必须以某种方式将这些字段映射到你的表列。

所以虽然理论上你可以做你想做的事，但实际上你不能使用结果。

所以不，您不能为数据库中的每个表都有一个通用报告（除非由于某种原因这些表具有完全相同的结构）。

# c# - 如何将查询字符串重写为 asp.net 中的域？

> ID：13357142
> 
> 赞同：1
> 
> 时间：2012-11-13T07:50:39.703
> 
> 标签：c#, asp.net, iis, url-rewriting

如何将查询字符串重写为 asp.net 和 c# 中的域？

例如 ：

改写

```
http://www.site.com/site.aspx?SiteID=1001 
```

到

```
http://www.WebSite1.com/ 
```

和

```
http://www.site.com/site.aspx?SiteID=1002 
```

到

```
http://www.WebSite2.com/ 
```

* * *

我见过一些博客提供商这样做

您创建一个博客，例如[http://example.blogspot.com](http://example.blogspot.com)并设置一个域，您的博客地址设置为 www.yourdomain.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:41:41.943

我不知道该怎么做。但这就是它背后的想法。我之前做过一个类似的项目

您应该有一个“主”表，其中包含用户的详细信息，包括用户将使用的域。域应指向您的服务器 IP。当用户在浏览器中输入他的域时，代码应该检查与域匹配的记录。您还可以为您的应用程序使用不同的皮肤。

您要问的不仅仅是 URL 重写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T08:29:33.657

在您的页面加载中，检查查询字符串并重定向到相应的页面。它会是这样的：

```
if(Request.QueryString["SiteId"] == "1001")
Response.Redirect("http://www.WebSite1.com/")
else if(Request.QueryString["SiteId"] == "1002")
Response.Redirect("http://www.WebSite2.com/") 
```

这是如果你想重定向。否则您需要在 IIS 中安装重写器模块，然后在 web.config 中重写

# java - “If 语句”不断检查 for 循环的索引计数的倍数

> ID：13357143
> 
> 赞同：4
> 
> 时间：2012-11-13T07:50:41.180
> 
> 标签：java, if-statement, console

我有一个 for 循环检查每 5 个位置。在每第五个位置，我正在执行一个这样的动作（有效）：

```
for(int i = 0; i < foo().length; i++)
{
    System.out.print(i);

    if(i == 5 || i == 10 || i == 15)
        System.out.println();
} 
```

有没有办法写 if 语句，所以无论多长时间`foo().length`，我都不必不断回来调整它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T07:51:48.420

使用`modulus(%)`运算符：-

```
if (i % 5 == 0) {

} 
```

*   `5 % 5 == 0`, `10 % 5 == 0`, ...

* * *

由于您使用的是 a `for loop`，因此您可以简单地将增量从 更改`i++`为`i += 5`，并保留 if 条件。

```
for (int i = 0; i < someNum; i += 5) {
    // No need to check for `i` against `modulus 5`.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T07:57:42.047

您可以使用下一个`for`witout`if`语句

```
for(int i = 0; i < foo().length; i+=5)
{ 
```

`5`逐步添加`i`_

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T07:53:01.130

使用以下内容：

```
if ( i % 5 == 0 ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T07:59:32.470

如果你想把它放在一个单独的打印语句中，这也可以。

```
for(int i = 0; i < foo().length; i++)
{
    System.out.printf("%d%s", i, (i%5==0) ? "\n" : "");
} 
```

# mysql - 如何在 MySQL 中选择字段具有最小值的数据？

> ID：13357144
> 
> 赞同：46
> 
> 时间：2012-11-13T07:50:40.260
> 
> 标签：mysql, sql, aggregate-functions, greatest-n-per-group

我想从 MySQL 中特定字段具有最小值的表中选择数据，我试过这个：

```
SELECT * FROM pieces WHERE MIN(price) 
```

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-11-13T07:51:53.763

这将为您提供所有记录中价格最低的结果。

```
SELECT *
FROM pieces
WHERE price =  ( SELECT MIN(price) FROM pieces ) 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/954a5/2)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-11-13T07:58:35.173

假设我理解这个问题，我会这样做。

```
SELECT * FROM pieces ORDER BY price ASC LIMIT 1 
```

如果您尝试选择多行，其中每行可能具有相同的最低价格，那么@JohnWoo 的回答就足够了。

基本上在这里，我们只是按价格升序 (ASC) 对结果进行排序，并获取结果的第一行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-13T08:06:53.840

这也有效：

```
SELECT
  pieces.*
FROM
  pieces inner join (select min(price) as minprice from pieces) mn
  on pieces.price = mn.minprice 
```

（由于此版本没有子查询的 where 条件，如果您需要 UPDATE 表可以使用它，但如果您只需要 SELECT 我建议使用 John Woo 解决方案）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-17T12:34:41.567

使用**HAVING MIN(...)**

就像是：

```
SELECT MIN(price) AS price, pricegroup
FROM articles_prices
WHERE articleID=10
GROUP BY pricegroup
HAVING MIN(price) > 0; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-02-06T11:03:45.320

有效的方式（任意数量的记录）：

```
SELECT id, name, MIN(price) FROM (select * from table order by price) as t group by id 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-10T18:48:21.593

事实上，取决于你想得到什么： - 只是最小值：

```
SELECT MIN(price) FROM pieces 
```

*   具有最小值的表（多行）：正如 John Woo 上面所说的那样。

*   但是，如果可以是具有相同最小值的不同行，最好是从另一列中对它们进行排序，因为之后或之后您将需要这样做（从 John Woo answere 开始）：

    SELECT * FROM pieces WHERE price = ( SELECT MIN(price) FROM pieces) ORDER BY stock ASC

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-03-05T16:20:17.813

为了改进@sberry 的答案，如果该列有一个`null`值，那么只需做`ORDER BY`就会选择一个有`null`值的行。添加一个`WHERE`子句以获得正确的结果：

```
SELECT * FROM pieces 
WHERE price>0
ORDER BY price ASC 
LIMIT 1; 
```

或者，如果有可能出现负值和/或`VARCHAR`等，请执行以下操作：

```
SELECT * FROM pieces 
WHERE price IS NOT NULL
ORDER BY price ASC 
LIMIT 1; 
```

* * *

## 回答 #8

> 赞同：-8
> 
> 时间：2016-10-03T12:41:00.290

为了让它更简单

> SELECT *,MIN(price) FROM prod LIMIT 1

*   放 * 所以它会显示最小值的所有记录

# php - 如何从简单的xml中获取元素值

> ID：13357145
> 
> 赞同：0
> 
> 时间：2012-11-13T07:50:46.013
> 
> 标签：php, xml

我有以下 xml 文档：

```
<?xml version="1.0"?>  
<root> 
<offers count="3009">
<offer>
    <offerId>25</offerId>
    <offer_type>for sale</offer_type>
    <offer_status>available</offer_status>
     <building_floors></building_floors>
    <title>title</title> 
<photos count="4">
<photo zIndex="1">1.jpg</photo>
<photo zIndex="2">2.jpg</photo>
<photo zIndex="3">3.jpg</photo>
<photo zIndex="4">4.jpg</photo>
     </photos>
  </offer>
</offers>
</root> 
```

我正在使用这个 php 代码从 xml 中获取结果：

```
$xml = simplexml_load_file("offers.xml") 
       or die("Error: Cannot create object");
foreach($xml->children() as $offers){
    foreach($offers->children() as $offer => $data){
    echo $data->offerId;echo "<br />";//and so on for each element
          foreach ($xml->offers->offer->photos->photo as $aaa){
         $photos=$aaa; echo "<br />";
         //echo $xml;
         $photo = explode("<br /> ", $photos);
            foreach($photo as $value) echo $value; echo '<br />';//echo $value
        }
    }
} 
```

当我尝试循环照片元素时，我会得到所有照片，但仅限于第一个报价。我的问题是我做错了什么以及为什么我没有为每个报价获取照片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:48:54.827

问题在于您检索照片元素的方式。您从根元素开始，因此它始终为您提供相同的节点。你应该像这样使用 $data ：

```
foreach ($data->photos->photo as $aaa){ 
```

清理一下您的代码，您应该使用它来显示照片元素：

```
$xml = simplexml_load_file("offers.xml") or die("Error: Cannot create object");
foreach($xml->children() as $offers){
    foreach($offers->children() as $offer){
        echo "Offer id : " . $offer->offerId . "<br>";
        foreach ($offer->photos->photo as $photo){
            $val = (string) $photo;
            echo $val . "<br>";
        }
    }
} 
```

# svn - 如何在 Jenkins 中获取最新的 SVN 标签

> ID：13357151
> 
> 赞同：3
> 
> 时间：2012-11-13T07:51:08.663
> 
> 标签：svn, jenkins

我需要将最新的 SVN 标签签出到我的 Jenkins 构建作业工作区。标签是指复制的文件夹，通常用于创建里程碑。

我从一些stackoverflow问题中读到，一个可以得到最新的例如

```
"svn ls .../path/to/repo/tags | tail -n 1" 
```

，但我认为这不能交给 Jenkins SCM 领域。我相信 Jenkins 需要 SVN 中的确切位置。有任何想法吗？我相信这实际上是大型项目中相当普遍的要求....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:25:29.960

在以下假设下，建议的答案*几乎是正确的：*

*   使用增量字母数字永久命名方案
*   BASE 路径以某种方式添加到管道的结果（ls 输出到标签/的**相对路径）**

如果上述条件**不满足**，您必须使用稍微不同的命令和一些业务逻辑“最新标签具有最高修订号”

```
>svn ls -v http://mayorat.ursinecorner.ru:8088/svn/Hello/tags/
     22 lazybadg              июл 17  2010 ./
     11 lazybadg              июл 17  2010 1.0/
     22 lazybadg              июл 17  2010 1.1/ 
```

*这个*ls的输出可以是 gawk'ed，最近的修订在 $1 中找到，所需标签的相对路径在 $6（或 $5，我懒得测试）

# objective-c - 在应用程序中仅更改一个 UIViewController 的 UIInterfaceOrientation

> ID：13357156
> 
> 赞同：1
> 
> 时间：2012-11-13T07:51:27.257
> 
> 标签：objective-c, ios, uiinterfaceorientation

我有一个 iPhone 应用程序，其结构类似于“带有表格的导航控制器 -> 带有表格的下一个视图控制器 -> QLPreviewController”。通过在第一个视图控制器（带有导航控制器）中点击表格的单元格，会出现带有另一个表格的新视图控制器，通过点击它的单元格显示 QLPreviewController。

**例如：**在第一个表中有组，在第二个表中 - 所选组的文档，以及用于预览所选文档的 QLPreviewController。

我的应用程序中的每个 ViewController 必须仅以纵向（而不是向上）方向出现，但 QLViewController 还必须支持横向（左右）。

在 QLPreviewController 出现之前，我将标志 canRotate 设置为 YES。在 AppDelegate 中，如果`canRotate == YES`我为任何方向返回 YES，则旋转 QLPreviewController。方法 previewControllerWillDismiss:(QLPreviewController *)controller 中的 QLPreviewControllerDelegate 将标志 canRotate 设置回 NO。但是如果在 QLPreviewController 关闭之前方向是横向，我所有的 ViewControllers 都保持横向方向......

如何在 WillDismiss 方法中将 ViewController 旋转回纵向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:01:13.627

我在我的应用程序上所做的（它或多或少像你的）是：

1) 为两个屏幕设置 shouldRotate `Yes`。

2）为第一个视图设置以下掩码：

```
return UIInterfaceOrientationMaskPortrait 
```

对于第二个视图放：

```
return UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskLandscape; 
```

# c# - 每个 Asp.net 回发中的 JQuery BlockUI 进度指示器

> ID：13357157
> 
> 赞同：5
> 
> 时间：2012-11-13T07:51:33.067
> 
> 标签：c#, javascript, jquery, asp.net, jquery-blockui

我想实现一个 jquery`blockUI`以在`Asp.Net`. 我该如何实施？我正在使用`masterpages`，所以我想知道是否可以在一个地方实现此代码以使其保持简单。这甚至可能吗？期待听到您对此的看法。

提前致谢。

* * *

我能够开发这个。我已经在答案中包含了这些步骤。如果您有任何问题，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T20:23:36.473

我自己想通了。

1.  创建一个新的 Asp.net Web 项目。
2.  在 Site.Master 标记中包含以下内容：

    ```
    <script type="text/javascript" src="../Scripts/jquery-1.4.1.min.js"></script>
    <script type="text/javascript" src="../Scripts/jquery.blockUI.js"></script>
    <script language="javascript" src="../Scripts/General.js" type="text/javascript"></script>

    <style>
      div.blockOverlay {
        background-color: #666;
        filter: alpha(opacity=50) !important;
        -moz-opacity:.50;
        opacity:.50;
        z-index: 200000 !important;
      }
      div.blockPage {
        z-index: 200001 !important;
        position: fixed;
        padding: 10px;
        margin: -38px 0 0 -45px;
        width: 70px;
        height: 56px;
        top: 50%;
        left: 50%;
        text-align: center;
        cursor: wait;
        background: url(ajax-loader.gif) center 30px no-repeat #fff;
        border-radius: 5px;
        color: #666;
        box-shadow:0 0 25px rgba(0,0,0,.75);
        font-weight: bold;
        font-size: 15px;
        border: 1px solid #ccc;
      }
    </style> 
    ```

3.  在 default.aspx 中添加以下标记：

    ```
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
      <ContentTemplate><asp:Button ID="Button1" runat="server" Text="Button" 
            onclick="Button1_Click" /></ContentTemplate>
    </asp:UpdatePanel> 
    ```

4.  将进度指示器图像 (ajax-loader.gif) 添加到项目根目录

5.  在 General.js 中添加以下内容

    ```
    // BlockUI setup

    $.extend({
      // Block ui during ajax post back
      initializeUiBlocking: function () {
        if (typeof ($.blockUI) != 'undefined') {
          $.blockUI.defaults.message = 'LOADING';
          $.blockUI.defaults.overlayCSS = {};
          $.blockUI.defaults.css = {};

          var request = Sys.WebForms.PageRequestManager.getInstance();
          request.add_initializeRequest(function (sender, args) {
            request.get_isInAsyncPostBack() && args.set_cancel(true);
          });
          request.add_beginRequest(function () { $.blockUI(); });
          request.add_endRequest(function () { $.unblockUI(); });
        }
      }
    });

    $(document).ready(function () {
      $.initializeUiBlocking();
    }); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:10:33.347

看看这个
[http://www.malsup.com/jquery/block/#overview](http://www.malsup.com/jquery/block/#overview)
这适用于 ajax 调用。

并且您需要将以下行
`$(document).ajaxStart($.blockUI).ajaxStop($.unblockUI);`
放置在所有页面都可用的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-09T07:57:21.783

**介绍：**

要在提交数据时阻止页面，我们有多种选择，我们可以使用基于 Ajax 的 UpdateProgress 或一些 jQuery Stuff。但有时由于复杂性，Ajax UpdateProgress 并不是很有用。因此，更好的方法是使用 jQuery UI Block Plug-In。

执行：

从以下网址下载 jQuery UI 块插件： http: [//www.malsup.com/jquery/block/](http://www.malsup.com/jquery/block/)

```
<script type="text/javascript" src="js/jquery.1.4.2.js"></script>
<script type="text/javascript" src="js/jquery.blockUI.js"></script>

  $("#<%= btnSubmit.ClientID%>").click(function() {

 $.blockUI({ 
                            message: "<h3>Processing, Please Wait...</h3>" ,
                            css: { 
                                border: 'none', 
                                padding: '15px', 
                                backgroundColor: '#000', 
                                '-webkit-border-radius': '10px', 
                                '-moz-border-radius': '10px', 
                                opacity: .5, 
                                color: '#fff' 
                 }  });

}); 
```

上面的代码是没有任何 AJAX 或其他复杂脚本的简单代码。

[我在网站](https://www.codeproject.com/Articles/667424/How-to-Block-the-Page-When-Data-is-Submitting)上找到了这篇文章并进行了测试，它的工作正常

# twitter-bootstrap - 引导内容轮播

> ID：13357164
> 
> 赞同：1
> 
> 时间：2012-11-13T07:52:05.560
> 
> 标签：twitter-bootstrap, carousel

我想实现这样的目标：[循环内容轮播](http://tympanus.net/Development/CircularContentCarousel/) ，但我正在使用 Bootstrap 并且它已经拥有它的轮播组件。

有什么方法可以使用 Bootstrap 的 Carousel 和一些 jquery 来实现相同的功能/效果？或者任何人都知道任何其他方式来实现这一目标？由于网格布局，我很困惑。

PS 我对在引用站点上单击“阅读更多”时的效果不感兴趣。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:01:52.977

好的，我只是尝试了一些过期，我想我得到了我想要的。基本上，我试图在 span10 div 中放置 5 个盒子。但是 5 个盒子不是静态的，所以它可能会变成 6 个或 7 个或更多。所以我试图一次显示 5 个框（即 1 个“行”）作为“活动项目”。每 5 个盒子（实际上是 div）是 1 个项目。

所以我想，你已经明白了。下面是我的静态数据代码：

```
<div class="span10">
<div id="myCarousel" class="carousel slide">
    <div class="carousel-inner">
        <div class="active item">
            <div class="row">
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
            </div>                          
        </div>
        <div class="item">
            <div class="row">
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>
                <div class="span2 logs">                                                               
                    <h4>Span 2</h4>
                    <p>Carousel caption text<p>                            
                </div>                  
            </div>                          
        </div>                             
    </div>                  
    <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
    <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>                     
</div> 
```

它基本上会在每个向右或向左滚动中显示 5 个框。除非最后一组小于 5。

# facebook - 基本权限和扩展权限 - 好友列表

> ID：13357166
> 
> 赞同：1
> 
> 时间：2012-11-13T07:52:13.020
> 
> 标签：facebook, permissions

我查看了基本信息权限列表：

> id
> 名称
> first_name
> last_name
> 链接
> 用户名
> 性别
> 区域设置

并且在**扩展**时有这个权限：

> 阅读好友列表

我看到这个权限的部分描述：

> “所有用户的朋友都作为基本数据的一部分提供......”

所以我的问题是：用户朋友列表是基本信息权限的一部分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:49:41.677

> 所以我的问题是：用户朋友列表是还是不是基本信息权限的一部分？

用户的朋友列表是基本权限的一部分——您可以通过以下方式阅读它们`/userid/friends`

*但是“朋友列表*”是不同的——`/userid/friendlists`给你用户的朋友被分类到的列表——其中一些是由 Facebook 自动创建的，一些可能是由用户自己创建的。这些列表可以有不同的类型：close_friends、acquaintances、restricted、user_created、education、work、current_city 或 family。

 *要阅读这些*好友列表*，您需要`read_friendlists`获得许可（线索已经在此处的名称中）。

如果花一分钟时间在文档中查找这些用户连接的描述，那么一切都应该很明显：[https ://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-05T19:57:14.797

我相信这已经过时了，您可能不会查看用户的好友列表。这很不幸，因为我一直在从事一个基于该想法的项目。*

# javascript - 嵌套 for 语句中使用的变量

> ID：13357170
> 
> 赞同：1
> 
> 时间：2012-11-13T07:52:45.297
> 
> 标签：javascript, jquery

```
function abc()
{
    var str = "";  //  -------------------(4) 
    for (var i = 0; i < 100 ; i++)
    {
        str = "<tr><td>"; // ------------------(1)
            for(var m = 1 ; m <= cnt_chapter ; m++)
        {
            str = str + "<span>" + m +"</span> "; //  -------------(2) 
        }
        str = str + "</td></tr>"; // ------------(3) 
    }                       
    $(".title").append(str);
} 
```

此代码是 jquery 代码的一部分。我想在 (1) 和 (3) 之间编写代码

但不要工作（2）代码。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T07:57:59.030

`cnt_chapter`这里是 undifiend 也有附加问题

```
var cnt_chapter = 10;
function abc()
{
    var str = "";
    for (var i = 0; i < 10 ; i++)
    {
        str += "<tr><td>";
        for(var m = 1 ; m <= cnt_chapter ; m++)
        {
            str = str + "<span>" + m +"</span> ";
        }
        str = str + "</td></tr>";
    }                       
     $(".title").append(str);
}

abc(); 
```

[演示](http://jsfiddle.net/VdSGS/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T08:30:03.147

```
function abc()
{
    var str = "";  //  -------------------(4) 
    for (var i = 0; i < 100 ; i++)
    {
        str += "<tr><td>"; // ------------------(1)
            for(var m = 1 ; m <= cnt_chapter ; m++)
        {
            str += "<span>" + m +"</span> "; //  -------------(2) 
        }
        str += "</td></tr>"; // ------------(3) 
    }                       
    $(".title").append(str);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T07:57:00.963

我想你想要：

```
function abc() {
    var str = "";
    for (var i = 0; i < 100 ; i++) {
        str += "<tr><td>";
        for(var m = 1 ; m <= cnt_chapter ; m++){ 
            str = str + "<span>" + m +"</span> ";
        }
        str += "</td></tr>";
    }
    $(".title").append(str);
} 
```

请注意，您需要保留上一次迭代的 HTML，因此您应该将 附加`<tr>`到现有`str`值，而不是替换它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T07:55:39.890

您每次都在外部循环周围擦除字符串，因此它只有一个 HTML 行。

您标记的行`(1)`也应该使用`str = str + ...`，而不是`str = ...`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T08:57:41.003

虽然这是一个写得很糟糕的代码，但它没有被执行的原因`cnt_chapter`是没有定义变量。人们提到没有分号，正在构建的字符串在外循环中被替换等。这些都是逻辑错误。即使有这些逻辑错误，如果变量`cnt_chapter`被正确声明和初始化，代码应该可以很好地执行以产生一些错误的结果。

# java - MouseEvent 在 JScrollPane 中丢失

> ID：13357177
> 
> 赞同：4
> 
> 时间：2012-11-13T07:53:31.513
> 
> 标签：java, swing, jframe, jpanel, jscrollpane

这是我用来显示我在另一个项目中面临的问题的代码。

如果我使用 JScrollPane 作为 panel2 的包装器，我不会得到任何这样的行。**为什么？** 我想点击 JscrollPane 并打印如下事件。

```
java.awt.event.MouseEvent[MOUSE_CLICKED,(800,469),absolute(808,499),button=1,modifiers=Button1,clickCount=1] on javax.swing.JPanel[,0,0,934x612,layout=java.awt.FlowLayout,alignmentX=0.0,alignmentY=0.0,border=javax.swing.border.LineBorder@cc0e01,flags=9,maximumSize=,minimumSize=,preferredSize=java.awt.Dimension[width=880,height=630]] 
```

如果现在我改变

```
panel1.add(pane); 
```

到

```
panel1.add(panel2); 
```

然后上面的消息被打印出来。

```
public class LostMouseEvent {

public static void main(String[] args) {
    new LostMouseEvent();
}

public LostMouseEvent() {
    EventQueue.invokeLater(new Runnable() {
        @Override
        public void run() {
            JFrame frame = new JFrame();
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setLayout(new BorderLayout());

            JPanel panel1 = new JPanel();
            JPanel panel2 = new JPanel();
            JScrollPane pane = new JScrollPane(panel2);

            panel1.setPreferredSize(new Dimension(880, 630));
            panel1.setBorder(BorderFactory.createLineBorder(Color.blue));
            panel2.setPreferredSize(new Dimension(840, 610));
            panel2.setBorder(BorderFactory.createLineBorder(Color.green));

            panel1.add(pane);
            frame.add(panel1);

            frame.pack();
            frame.setVisible(true);
            frame.setSize(950, 650);

            panel1.addMouseListener(new MyMouseListener());
        }
    });
}

private class MyMouseListener extends MouseAdapter {
    @Override
    public void mouseClicked (MouseEvent me) {
        System.out.println(me);
    }
}
} 
```

**UPD：**事实上，在我的项目中，不止一个 panel2。最初，我有 panel1 和许多 panel2 里面。然后我想用 JScrollPane 包装每个 panel2 并开始面对这个问题。

我只需要一个 MouseListener 就可以最大限度地减少对代码的更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T08:02:24.787

*   使用[EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)创建和操作 Swing 组件
*   在设置可见之前不要调用`setSize()`而调用。`pack()``JFrame`
*   不要打电话`setPrefferedSize()`宁愿覆盖`getPrefferedSize()`

您的代码按预期工作，它只会在`panel1`单击时打印消息，注意`panel1`在后面`JScrollPane`，因此绿色边框之外的任何内容都是`panel1`. 要使其同时适用于`JScrollpane`/`panel2`和`JPanel`/`panel1`只需将**BOTH**`MouseListener`添加到所需组件中：

 **```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;

public class LostMouseEvent {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
        new LostMouseEvent();
            }
        });
    }

    public LostMouseEvent() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());

                JPanel panel1 = new JPanel() {

                    @Override
                    public Dimension getPreferredSize() {
                        return new Dimension(880, 630);
                    }

                };
                JPanel panel2 = new JPanel() {

                    @Override
                    public Dimension getPreferredSize() {
                        return new Dimension(840, 610);
                    }
                };
                JScrollPane pane = new JScrollPane(panel2);

                panel1.setBorder(BorderFactory.createLineBorder(Color.blue));
                panel2.setBorder(BorderFactory.createLineBorder(Color.green));

                panel1.add(pane);
                frame.add(panel1);

                MouseListener ml=new MyMouseListener();

                //add mouse listener to panel1 and panel2
                panel1.addMouseListener(ml);
                panel2.addMouseListener(ml);

                //alternatively add to pane
                //pane.addMouseListener(ml);

                frame.pack();
                frame.setVisible(true);

            }
        });
    }

    private class MyMouseListener extends MouseAdapter {

        @Override
        public void mouseClicked(MouseEvent me) {
            System.out.println(me);
        }
    }
} 
```

**编辑：**

不过我个人不会推荐这个

要将单个侦听器添加到`JFrame`将捕获所有`MouseEvent`s 使用`Toolkit`类并[`addAWTEventListener`](http://docs.oracle.com/javase/6/docs/api/java/awt/Toolkit.html#addAWTEventListener%28java.awt.event.AWTEventListener,%20long%29)像这样调用：

```
Toolkit.getDefaultToolkit().addAWTEventListener(new AWTEventListener() {
    @Override
    public void eventDispatched(AWTEvent awte) {//all mouse events will be processed here you will have to check for the mouse events you are interested in
    System.out.println(awte);
    }
}, AWTEvent.MOUSE_EVENT_MASK);//for Mouse events only 
```

**更新 1：**

您还可以通过不要忘记在设置可见后将*玻璃窗格*`MouseListener`设置为可见来将其添加到您`JFrame`的*玻璃窗*格中。这将允许您只需要添加一个. 看这里：`JFrame.getGlassPane().addMouseListener(ml)`*`JFrame``Listener`*

 *```
...

MouseListener ml = new MyMouseListener();

//add mouse listener to panel1 and panel2
//panel1.addMouseListener(ml);
//panel2.addMouseListener(ml);

//alternatively add to pane
//pane.addMouseListener(ml);

frame.getGlassPane().addMouseListener(ml);

frame.pack();
frame.setVisible(true);

frame.getGlassPane().setVisible(true);

... 
```

**更新 2：**

`MouseEvent`您遇到迷路问题的主要原因`JScrollPane`是因为它是一个错误。见[这里](https://forums.oracle.com/forums/thread.jspa?threadID=1362237)。

显示的解决方法是：

```
public Test()
  {
    setUI(new javax.swing.plaf.metal.MetalScrollPaneUI(){
      public void installListeners(JScrollPane scrollPane){}
    });
    JPanel canvas = new JPanel();
    canvas.add( new JLabel("Test") );

    setViewportView( canvas );
    setVisible(true);
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T10:45:55.863

> MouseEvent 在 JScrollPane 中丢失

*   答案非常/非常简单，请确保没有关于丢失事件的内容，也没有 JScrollPane，

*   Swing JComponent 只有在添加了适当的侦听器时才能触发事件

*   您没有将 MouseListener 添加到第二个 JPanel，

*   此 JPanel 被放入父 JPanel，此父已添加 MouseListener 然后触发 mouseEvent，确保在您的情况下仅在添加到此容器的第二个 JPanel 的边界之外

*   然后第二个 JPanel 是 deepestComponentAt，如果没有从父级到子级的重新调度坐标，则不可能触发事件

*   您也可以以编程方式重新调度事件，***

# c++ - 实现 C++ 异常链接的正确/优雅方式？

> ID：13357178
> 
> 赞同：17
> 
> 时间：2012-11-13T07:53:34.577
> 
> 标签：c++

我想在 C++ 中实现一个模仿 .NET 框架的异常类（Java 也有类似的东西），用于以下目的：

1.  异常链接：我想实现“异常转换”的概念，当在较高级别捕获的异常包装并“转换”较低级别的异常时，还以某种方式保留这些较低级别的异常（`InnerException`在这种情况下，在成员中） . 为此，应该有一些机制来存储内部异常以及上层抛出的每个异常。`InnerException`成员在下面的实现中提供了这个。

2.  异常继承：例如应该可以`IoException`从`Exception`和`SerialPortException`从派生`IoException`。虽然这看起来微不足道，但应该能够动态识别捕获的异常类型（例如，用于记录目的或显示给用户），最好没有 RTTI 和`typeid`.

这是我希望实现的示例异常处理逻辑：

```
try
{
    try
    {
        try
        {
            throw ThirdException(L"this should be ThirdException");
        }
        catch(Exception &ex)
        {
            throw SubException(L"this should be SubException", ex);
        }
    }
    catch(Exception &ex)
    {
        throw SubException(L"this should be SubException again", ex);
    }
}
catch(Exception &ex)
{
    throw Exception(L"and this should be Exception", ex);
} 
```

并且在最上层捕获“最外层”异常时，我希望能够通过`InnerException`成员解析和格式化整个异常链，以显示如下内容：

![异常链格式化](../Images/b246fe9b4f41fddec30835d78ff9105f.png)

到目前为止，我已经提出了以下实现：

*小提示：`CString`是 Microsoft 特定的字符串类（仅适用于不熟悉 Visual C++ 内容的人）。*

```
class Exception
{
protected:

    Exception(const Exception&) {};
    Exception& operator= (const Exception&) {};

public:

    Exception(const CString &message) : InnerException(0), Message(message) {}
    Exception(const CString &message, const Exception &innerException) : InnerException(innerException.Clone()), Message(message) {}

    virtual CString GetExceptionName() const { return L"Exception"; }

    virtual Exception *Clone() const
    {
        Exception *ex = new Exception(this->Message);
        ex->InnerException = this->InnerException ? this->InnerException->Clone() : 0;
        return ex;
    }

public:

    virtual ~Exception() { if (InnerException) delete InnerException; }

    CString Message;
    const Exception *InnerException;
}; 
```

现在我们在这里有什么。复制构造函数和赋值运算符是`protected`为了防止复制。每个对象都将“拥有”其内部异常对象（并在析构函数中将其删除），因此默认的浅拷贝是不可接受的。然后我们有两个非常标准的构造函数和删除`InnerException`对象的虚拟析构函数。`Clone()`虚方法负责对对象进行深拷贝，主要用于存储内部异常对象（见第二个构造函数）。最后，`GetExceptionName()`虚拟方法为识别异常类名称提供了 RTTI 的廉价替代方法（我不认为这看起来很酷，但我想不出更好的解决方案；作为比较：在 .NET 中可以简单地使用`someException.GetType().Name`）。

现在这完成了工作。但是......我不喜欢这个解决方案有一个特殊的原因：每个派生类所需的编码量。考虑我必须派生`SubException`类，它为基类功能提供绝对零添加，它只提供自定义名称（“SubException”，可能是“IoException”，“ProjectException”，......）以区分它的用法设想。我必须为每个这样的异常类提供几乎相同数量的代码。这里是：

```
class SubException : public Exception
{
protected:

    SubException(const SubException& source) : Exception(source) {};
    SubException& operator= (const SubException&) {};

public:

    SubException(const CString &message) : Exception(message) {};
    SubException(const CString &message, const Exception &innerException) : Exception(message, innerException) {};

    virtual CString GetExceptionName() const { return L"SubException"; }

    virtual Exception *Clone() const
    {
        SubException *ex = new SubException(this->Message);
        ex->InnerException = this->InnerException ? this->InnerException->Clone() : 0;
        return ex;
    }
}; 
```

我不喜欢每次都必须提供`protected`复制构造函数和赋值运算符的事实，我不喜欢`Clone`每次都必须克隆方法，甚至复制复制基本成员的代码（`InnerException`... )，简单地说......我认为这不是优雅的解决方案。但我想不出更好的。您对如何“正确”实施这个概念有任何想法吗？或者这可能是 C++ 中这个概念的最佳实现？或者，也许我这样做完全错了？

PS：我知道 C++11（也在 Boost 中）为此目的（异常链接）存在一些机制，并带有一些新的异常类，但我主要对自定义的“旧 C++ 兼容”方式感兴趣。但是，另外，如果有人可以提供任何 C++11 中的代码来完成同样的事情，那就太好了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-13T08:04:22.523

C++11 已经有了[nested_exception](http://en.cppreference.com/w/cpp/error/nested_exception)。在 Boostcon/C++Next 2012 上讨论了 C++03 和 C++11 中的异常。视频在 youtube 上：

1.  [http://www.youtube.com/watch?v=N9bR0ztmmEQ&feature=plcp](http://www.youtube.com/watch?v=N9bR0ztmmEQ&feature=plcp)
2.  [http://www.youtube.com/watch?v=UiZfODgB-Oc&feature=plcp](http://www.youtube.com/watch?v=UiZfODgB-Oc&feature=plcp)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T08:05:23.560

有很多额外的代码，但好的是它真的很简单，从一个类到另一个类根本不会改变，所以可以对它进行预处理宏。

```
#define SUB_EXCEPTION(ClassName, BaseName) \
  class ClassName : public BaseName\
  {\
  protected:\
  \
      ClassName(const ClassName& source) : BaseName(source) {};\
      ClassName& operator= (const ClassName&) {};\
  \
  public:\
  \
      ClassName(const CString &message) : BaseName(message) {};\
      ClassName(const CString &message, const BaseName &innerException) : BaseName(message, innerException) {};\
  \
      virtual CString GetExceptionName() const { return L"ClassName"; }\
  \
      virtual BaseName *Clone() const\
      {\
          ClassName *ex = new ClassName(this->Message);\
          ex->InnerException = this->InnerException ? this->InnerException->Clone() : 0;\
          return ex;\
      }\
  }; 
```

然后，您可以通过执行以下操作来定义各种实用程序异常：

```
SUB_EXCEPTION(IoException, Exception);
SUB_EXCEPTION(SerialPortException, IoException); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-03T06:32:03.073

请不要遵循 boost::exception 方法。Boost::exception 适用于不同的用例 - 特别是当您想要收集分布在调用堆栈上的精确异常上下文时，它很有用。考虑以下示例：

```
#include "TSTException.hpp"

struct DerivedException: TST::Exception {};

int main() try
{
    try
    {
        try
        {
            try
            {
                throw std::runtime_error("initial exception");
            }
            catch(...)
            {
                throw TST::Exception("chaining without context info");
            }
        }
        catch(...)
        {
            TST_THROW("hello world" << '!');
        }
    }
    catch(...)
    {
        TST_THROW_EX(DerivedException, "another exception");
    }
}
catch(const TST::Exception& ex)
{
    cout << "diagnostics():\n" << ex;
}
catch(const std::exception& ex)
{
    cout << "what(): " << ex.what() << endl;
} 
```

据我了解，“异常链接”解决方案应该产生类似于以下的输出：

```
$ ./test
diagnostics():
Exception: another exception raised from [function: int main() at main.cpp:220]
Exception: hello world! raised from [function: int main() at main.cpp:215]
Exception: chaining without context info raised from [function: unknown_function at unknown_file:0]
Exception: initial exception 
```

如您所见，存在相互链接的异常，并且诊断输出包含所有异常以及上下文信息和可选堆栈跟踪（此处未显示，因为它取决于编译器/平台）。使用新的 C++11 错误处理功能（std::current_exception 或 std::nested_exception）可以自然地实现“异常链接”。这是 TSTException.hpp 的实现（请多多包涵）：

```
#include <iostream>
#include <sstream>
#include <stdexcept>
#include <exception>
#include <vector>
#include <string>
#include <memory>
#include <boost/current_function.hpp>
#include <boost/foreach.hpp>

using namespace std;

namespace TST
{

class Exception: virtual public std::exception
{
public:
    class Context
    {
    public:
        Context():
            file_("unknown_file"),
            line_(0),
            function_("unknown_function")
        {}
        Context(const char* file, int line, const char* function):
            file_(file? file: "unknown_file"),
            line_(line),
            function_(function? function: "unknown_function")
        {}
        const char* file() const { return file_; }
        int line() const { return line_; }
        const char* function() const { return function_; }
    private:
        const char* file_;
        int line_;
        const char* function_;
    };
    typedef std::vector<std::string> Stacktrace;
    //...
    Exception()
    {
        initStacktraceAndNestedException();
    }
    explicit Exception(const std::string& message, const Context&& context = Context()):
        message_(message),
        context_(context)
    {
        message.c_str();
        initStacktraceAndNestedException();
    }
    ~Exception() throw() {}
    //...
    void setContext(const Context& context) { context_ = context; }
    void setMessage(const std::string& message) { (message_ = message).c_str(); }
    const char* what() const throw () { return message_.c_str(); }
    void diagnostics(std::ostream& os) const;
protected:
    const Context& context() const { return context_; }
    const std::exception_ptr& nested() const { return nested_; }
    const std::shared_ptr<Stacktrace>& stacktrace() const { return stacktrace_; }
    const std::string& message() const { return message_; }
private:
    void initStacktraceAndNestedException();
    void printStacktrace(std::ostream& os) const;
    std::string message_;
    Context context_;
    std::shared_ptr<Stacktrace> stacktrace_;
    std::exception_ptr nested_;
};

std::ostream& operator<<(std::ostream& os, const Exception& ex)
{
    ex.diagnostics(os);
    return os;
}

std::ostream& operator<<(std::ostream& os, const Exception::Context& context)
{
    return os << "[function: " << context.function()
              << " at " << context.file() << ':' << context.line() << ']';
}

void Exception::diagnostics(std::ostream& os) const
{
    os << "Exception: " << what() << " raised from " << context_ << '\n';
    if (const bool haveNestedException = nested_ != std::exception_ptr())
    {
        try
        {
            std::rethrow_exception(nested_);
        }
        catch(const TST::Exception& ex)
        {
            if(stacktrace_ && !ex.stacktrace())//if nested exception doesn't have stacktrace then we print what we have here
                    printStacktrace(os);
            os << ex;
        }
        catch(const std::exception& ex)
        {
            if(stacktrace_)
                printStacktrace(os);
            os << "Exception: " << ex.what() << '\n';
        }
        catch(...)
        {
            if(stacktrace_)
                printStacktrace(os);
            os << "Unknown exception\n";
        }
    }
    else if(stacktrace_)
    {
        printStacktrace(os);
    }
}

void Exception::printStacktrace(std::ostream& os) const
{
    if(!stacktrace_)
    {
        os << "No stack trace\n";
        return;
    }
    os << "Stack trace:";
    BOOST_FOREACH(const auto& frame, *stacktrace_)
    {
        os << '\n' << frame;
    }
    os << '\n';
}

void Exception::initStacktraceAndNestedException()
{
    nested_ = std::current_exception();
    if(const bool haveNestedException = nested_ != std::exception_ptr())
    {
        try
        {
            throw;
        }
        catch(const TST::Exception& ex)
        {
            if(ex.stacktrace())
            {
                stacktrace_ = ex.stacktrace();
                return;
            }
        }
        catch(...) {}
    }
    /*TODO: setStacktrace(...); */
}

}//namespace TST

#ifdef TST_THROW_EX_WITH_CONTEXT
#error "TST_THROW_EX_WITH_CONTEXT is already defined. Consider changing its name"
#endif /*TST_THROW_EX_WITH_CONTEXT*/

#define TST_THROW_EX_WITH_CONTEXT(                                      \
    CTX_FILE, CTX_LINE, CTX_FUNCTION, EXCEPTION, MESSAGE)               \
    do                                                                  \
    {                                                                   \
        EXCEPTION newEx;                                                \
        {                                                               \
            std::ostringstream strm;                                    \
            strm << MESSAGE;                                            \
            newEx.setMessage(strm.str());                               \
        }                                                               \
        newEx.setContext(                                               \
            TST::Exception::Context(                                    \
                CTX_FILE, CTX_LINE, CTX_FUNCTION));                     \
        throw newEx;                                                    \
    }                                                                   \
    while(0)

#ifdef TST_THROW_EX
#error "TST_THROW_EX is already defined. Consider changing its name"
#endif /*TST_THROW_EX*/

#define TST_THROW_EX(EXCEPTION, MESSAGE)                                       \
    TST_THROW_EX_WITH_CONTEXT(__FILE__, __LINE__, BOOST_CURRENT_FUNCTION, EXCEPTION, MESSAGE)

#ifdef TST_THROW
#error "TST_THROW is already defined. Consider changing its name"
#endif /*TST_THROW*/

#define TST_THROW(MESSAGE)                                              \
    TST_THROW_EX(TST::Exception, MESSAGE) 
```

我使用具有部分 C++11 支持的编译器（gcc 4.4.7），因此您可以在这里看到一些旧式的代码和平。仅供参考，您可以使用以下编译参数来构建此示例（-rdynamic 用于堆栈跟踪）：

g++ main.cpp TSTException.hpp -rdynamic -o test -std=c++0x

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-15T08:10:24.013

几年前我写了这个：[Unchaining Chained Exceptions in C++](http://www.drdobbs.com/cpp/unchaining-chained-exceptions-in-c/191100567)

基本上，异常不会相互嵌套，因为很难捕获原始异常，但是另一种机制会在异常到达其捕获点时跟踪异常访问的所有函数。

可以在 Bitbucket 上的 Imebra 库中找到它的重新访问版本，[这里](https://bitbucket.org/binarno/imebra/src/41b5421a1b7f910edf827b90f36eeb238f2a47c2/project_files/library/base/include/exception.h?at=default)和[这里](https://bitbucket.org/binarno/imebra/src/41b5421a1b7f/project_files/library/base/src/exception.cpp?at=default)。

现在我将通过一些改进来重写它（例如，使用本地线程存储来保持堆栈跟踪）。

使用这种方法，您可以捕获引发的原始异常，但在异常返回到 catch 语句时，仍然具有堆栈跟踪和可能由异常访问的函数添加的其他信息。

# solr - 查询应该返回结果和类型计数？

> ID：13357181
> 
> 赞同：0
> 
> 时间：2012-11-13T07:53:54.053
> 
> 标签：solr

当前查询示例（搜索“测试”）：

```
q=lastName:test*^10 firstName:test*^9 userLastNameLowerBoost:test*^8      
  userFirstNameLowerBoost:test*^7 member:test*^6 title:test*^5 
  message:test*&start=0&rows=5 
```

现在我的 solr 索引得到了几种类型的结果（人员、消息等），我的结果只包含按 boost 排序的前 5 个结果。但我还需要将所有类型的计数作为结果（例如人数 = 40，消息计数 = 54，..）。如果我不通过“开始”和“行”限制查询，我可以在 java 中计算，但这不应该是分页的感觉（加载整个结果）。所以我可以添加一个子查询如何计算类型（字段名'documentType'->可以是1 = person，2 = messages，..）。

我希望你明白我想要什么:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:58:11.423

您应该能够只添加`&facet=true&facet.field=documentType&facet.mincount=1`以获取整个索引中的 documentTypes 计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:07:54.073

[您可以使用此处](http://wiki.apache.org/solr/FieldCollapsing)描述的字段分组。或者，[方面搜索](http://searchhub.org/2009/09/02/faceted-search-with-solr)，这取决于您的查询类型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T09:09:58.603

您可以为每个文档添加一个字段，并按类型填充它，例如 PERSON、MESSAGE。
然后，您可以在此字段上进行分面，这将为您提供结果集中每种类型的计数。

# java - Hibernate + Spring 的意外缓存

> ID：13357182
> 
> 赞同：1
> 
> 时间：2012-11-13T07:54:06.987
> 
> 标签：java, spring, hibernate, caching

当我使用 Spring + Hibernate 时，我得到了一些奇怪的缓存。

A行将新的一行数据插入到数据库中，年份为2012。B
行从DB中获取，发现年份是2012。C行将年份
更新为1970。D
行发现年份仍然是2012，我不明白为什么会发生这种情况? 但是如果我注释掉 B 行，D 行得到 1970，这似乎是某种缓存。或者如果在 findLock() 中，我使用 openSession() 而不是 getCurrentSession()，则 D 行也会得到 1970。abybody 可以解释这种行为吗？

试驾

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("/applicationContext-Test.xml")
@TransactionConfiguration(defaultRollback = true,transactionManager="transactionManager")
@Transactional
public class OperationLockDAOTest {

    @Autowired
    private OperationLockDAO operationLockDAO;
    @Autowired
    private APIOperationDAO apiOperationDAO;

    private APIOperation operation;

    @Before
    public void setup() {
        operation = apiOperationDAO.findOperationById(Constants.OP_CREATE_SUBSCRIBER);  
    }

    @Test
    public void testAddNewLockAndReleaseLock() throws DBException{
        String userKey = "testUserKey1" + Math.random();

        boolean bGetLock = operationLockDAO.lockOperationByUser(userKey, operation);//line A, insert 2012
        List<OperationLock> locks1 = operationLockDAO.findLock(userKey, operation);//line B
        OperationLock lock1 = locks1.get(0);
        Calendar cb = Calendar.getInstance();
        cb.setTime(lock1.getModifytime());//get 2012

        operationLockDAO.unlockOperationByUser(userKey, operation);//line C, update to 1970

        List<OperationLock> locks2 = operationLockDAO.findLock(userKey, operation);//line D
        OperationLock lock2 = locks2.get(0);

        Calendar cr = Calendar.getInstance();
        cr.setTime(lock2.getModifytime());
        int crYear = cr.get(Calendar.YEAR);// still get 2012

        assertTrue(crYear == Constants.LongBeforeYear);//assert time stamp of lock is set to 1970 after release 
    }
} 
```

OperationLockDAOImpl.java

```
@Repository("operationLockDAOImpl")
public class OperationLockDAOImpl implements OperationLockDAO{

    protected static final Logger logger = LoggerFactory.getLogger(OperationLockDAOImpl.class);

    /**
     * return true - this operation is not locked by another thread, lock behavior is successful this time
     *        false - this operation is locked by another thread, lock behavior failed this time
     */
    @SuppressWarnings("unchecked")
    @Override
    @Transactional(isolation = Isolation.SERIALIZABLE)
    public boolean lockOperationByUser(String userKey, APIOperation lockoperation) {

        String selecSsql = "select * from operation_lock where userKey=:userKey and lockoperationId=:lockoperationId";
        Session session = this.factory.getCurrentSession();
        Query selectQuery = session.createSQLQuery(selecSsql).addEntity(OperationLock.class);
        selectQuery.setString("userKey", userKey);
        selectQuery.setLong("lockoperationId", lockoperation.getId());
        List<OperationLock> operationLockList = selectQuery.list();

        if(operationLockList == null || operationLockList.size() == 0){//no record for this userKey and operation, insert one anyway
            String insertSql = "insert into operation_lock(`userKey`,`lockoperationId`,`modifytime`) values (:userKey, :lockoperationId, :updateTime)";
            Query insertQuery = session.createSQLQuery(insertSql);
            insertQuery.setString("userKey", userKey);
            insertQuery.setLong("lockoperationId", lockoperation.getId());
            insertQuery.setTimestamp("updateTime", new Date());
            insertQuery.executeUpdate();
            return true;
        } else {
            return false;
        }
    }

    @Override
    @Transactional(isolation = Isolation.SERIALIZABLE)
    public void unlockOperationByUser(String userKey, APIOperation lockoperation) {

        Date currentTime = new Date();
        Calendar time = Calendar.getInstance();
        time.setTime(currentTime);
        time.set(Calendar.YEAR, Constants.LongBeforeYear);//it's long before
        String sql = "update operation_lock set modifytime=:updatetime where userKey=:userKey and lockoperationId=:lockoperationId";
        Session session = this.factory.getCurrentSession();
        Query query = session.createSQLQuery(sql);
        query.setTimestamp("updatetime", time.getTime());
        query.setString("userKey", userKey);
        query.setLong("lockoperationId", lockoperation.getId());
        query.executeUpdate();
    }

    @SuppressWarnings("unchecked")
    @Transactional(isolation = Isolation.SERIALIZABLE)
    @Override
    public List<OperationLock> findLock(String userKey, APIOperation lockoperation) {

        String sql = "select * from operation_lock where userKey=:userKey and lockoperationId=:lockoperationId";
//      Session session = this.factory.openSession();
        Session session = this.factory.getCurrentSession();
        Query query = session.createSQLQuery(sql).addEntity(OperationLock.class);
        query.setString("userKey", userKey);
        query.setLong("lockoperationId", lockoperation.getId());

        List<OperationLock> result =  query.list();
//      session.close();
        return result;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:03:26.137

我认为问题在于 Hibernate（和 JPA）并不是真正打算作为本机 SQL 的接口，尤其是 SQL 更新查询。Hibernate 将维护一个会话级缓存。通常它知道实体何时更新，以便条目不会在会话缓存中过时（至少不在同一个线程中）。但是，由于您使用 SQL 更新查询更新实体，Hibernate 不知道您正在更改其缓存中的实体，因此它不能使其无效。

总之，Hibernate 缓存不适用于本机 SQL 更新查询。要使其正常工作，您必须在其自己的独立事务中维护每个操作（从测试类中删除 @Transactional），但这最终会导致性能问题。在 Hibernate 中修改实体的首选方法是......

```
Entity foo = session.get(Entity.class,entityId);
foo.x = y;
Entity fooModified = session.get(Entity.class,entityId);
//fooModified.x == y 
```

# ruby-on-rails - select2 不显示正确的选择字段

> ID：13357185
> 
> 赞同：0
> 
> 时间：2012-11-13T07:54:43.420
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery-select2

我有一个这样的表单搜索：

[![筛选](../Images/27ed0c7076f7d8887aead1fd155fb300.png)](https://i.stack.imgur.com/KYuUn.png)

当我使用[select2](https://ivaynberg.github.io/select2/)时`select#search_topic`，这变成：

[![过滤器错误](../Images/3eb3cb299f1dc4d0bf13f4b8177a967a.png)](https://i.stack.imgur.com/yWnVf.png)

这是我的 select2 代码：

```
<% content_for :head do %>
  <script type="text/javascript">
$(document).ready(function() {
  $('#search_topic').select2();
});
  </script>
<% end %> 
```

我的表格：

```
<%= form_tag({ controller: 'questions', action: 'search_filter' }, method: 'get', class: 'form-inline') do %>
  <%= label_tag 'search_topic', 'Filter:', class: 'label_search' %> 
  <%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name), :prompt => "Select topic" %>
  <%= select_tag 'search_type', options_from_collection_for_select(@question_types, :id, :name), :prompt => "Select type question" %>
  <%= submit_tag "Search", name: nil, class: 'btn' %>
<% end %> 
```

我已将`select2.js`and `select2.css.scss`（从 select2.css 更改名称）复制到`vendor/javascript`and `vendor/stylesheet`。

我将`url('select2.png')`scss 文件更改为`image_url("select2.png")`. 我也复制`select2.png`到`app/assets/images`.

在`application.js`我有`//= require select2`。在`application.css.scss`我有`@import "select2";`。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:44:46.520

您应该能够为选择设置默认宽度。

[http://ivaynberg.github.com/select2/index.html](http://ivaynberg.github.com/select2/index.html)

搜索页面的宽度

此外，如果您添加 :multiple => "" 它使用多个文本框版本

# sql - SQL 在触发器中使用临时表

> ID：13357186
> 
> 赞同：3
> 
> 时间：2012-11-13T07:54:46.483
> 
> 标签：sql, sql-server, triggers, sql-server-2008-r2, hashtable

我在 MSSQL Server 2008R2 中有一个触发器：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER [dbo].[trg_HosFile_Delete] 
    ON [dbo].[hosfile] FOR DELETE 
AS 
    insert into #pys(pyGuid)
    SELECT EntryGuid AS pyGuid FROM er000 AS er

    insert into t2(C1) select pyGuid from #pys 
```

触发器执行后，`t2`表为空。为什么是空的？

如果我在没有触发器的情况下执行上面的查询，则`t2`表已填充。

在触发器中使用临时表有什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-12-09T17:37:19.957

Damien 的回答是正确的：您可以在触发器中使用临时表，但强烈建议在此处定义它们，因为触发器可以在各种上下文中触发。

如果您在触发器中使用临时表，请检查临时表是否存在，因为您不控制上下文并且它可能已经存在：

```
IF OBJECT_ID('tempdb..#pys') IS NOT NULL
    DROP TABLE #pys 
```

此外，可以动态创建临时表：

```
SELECT * INTO #tmp
FROM inserted 
```

这在触发器包含需要访问在动态 SQL 范围内不可见的插入或删除的特殊表的动态 SQL 时特别有用。

避免使用##tmp（全局临时变量），因为它们是全局可见的，并且当多个 SPID 触发您触发时可能会导致麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T15:47:40.260

使用临时表没有问题，只要它们在触发器触发时在范围内。

鉴于触发器可以在任何时间、任何连接上触发，唯一有意义的范围是在触发器的主体内：

```
ALTER TRIGGER [dbo].[trg_HosFile_Delete] 
    ON [dbo].[hosfile] FOR DELETE 
AS 
    CREATE TABLE #pys (pyGuid uniqueidentifier not null/*I'm guessing*/)

    insert into #pys(pyGuid)
    SELECT EntryGuid AS pyGuid FROM er000 AS er

    insert into t2(C1) select pyGuid from #pys 
```

（老实说，我不确定您是否可以从外部范围访问临时表，并且没有方便的实例来测试它。但是，即使可以，它也会导致非常脆弱的触发器）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T16:05:36.877

如果您使用##pys（注意双# 符号），它将在创建后全局可用。这可能对你的情况有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-15T12:37:08.413

尝试使用 SELECT INTO 创建和填充临时表。在触发器中使用临时表时有一些限制。

# java - 当android手机处于深度睡眠模式时捕捉按键

> ID：13357187
> 
> 赞同：11
> 
> 时间：2012-11-13T07:54:48.003
> 
> 标签：java, android, sleep, keypress

## 问题描述

我正在尝试编写一个应用程序，该应用程序将捕获音量增大/减小以及蓝牙耳机按钮在应用程序处于时按下

*   背景
*   前景
*   背景和手机处于睡眠模式（按下电源按钮）
*   前台和手机处于睡眠模式（按下电源按钮）

对于前两点，我已经编写了一些测试应用程序，并且在我的情况下一切正常，我将应用程序发送到后台并按音量增大/减小，我的应用程序会捕获此事件。按下电源按钮后，我的手机进入睡眠模式。然后我按下音量增大/减小按钮，手机对这些事件没有反应，而且我在 logcat 中看不到任何日志，就像一切都停止工作一样。

## 在睡眠模式下检测按键的应用程序。

我认为这个问题无法解决，但我记得当你在音乐播放时按下音量增大/减小按钮时，Android 标准媒体播放器会捕捉到这个事件。我认为这个应用程序可以做到这一点，因为它是系统应用程序，但是我下载了 Winpm 播放器，它以相同的方式工作。Winapm 在手机处于睡眠模式时捕获音量增大/减小事件。音乐播放器应用程序就是这样做的。

## 问题

我想了解如何做到这一点？我如何编写一个简单的应用程序来捕捉音量增大/减小按钮的按下。那个时候我需要播放一些音乐，或者我可以这样做吗？我的意思是，Winamp 和其他应用程序捕获该事件的主要原因可能是当时正在播放音乐。或者这个问题可能无法解决，如果无法解决，我想知道为什么？我需要一些论据，为什么它无法解决。

## 源代码

我已经测试了一些应用程序，这是结果，我编写了一个简单的应用程序，可以在后台和前台以及应用程序处于睡眠模式时捕获音量增大和减小按键。当应用程序在后台和前台时一切正常，我的测试应用程序捕获事件，但是当我按下电源按钮时它停止这样做，然后***我按下媒体 pleyer 上的开始，它开始播放一些音乐，在我按下电源按钮后再按一次音量加减键，我的应用程序统计捕捉音量加减键***。这意味着然后播放音乐我的应用程序可以捕捉到这些事件，所以我的下一个问题是如何模拟我的手机播放某些音乐？可能这是解决方案吗？

***清单.xml***

```
<receiver android:name="com.vito.backgroundworker.VolumeBroadcast" android:enabled="true">
    <intent-filter>
    <action android:name="android.media.VOLUME_CHANGED_ACTION" />
    </intent-filter>
</receiver>

<receiver android:name="RemoteControlReceiver">
    <intent-filter>
    <action android:name="android.intent.action.MEDIA_BUTTON" />
    </intent-filter>
</receiver> 
```

***MainActivity.java***

```
public class MainActivity extends Activity {
    private PowerManager.WakeLock wl;
    //private BroadcastReceiver vol = new VolumeBroadcast();
    private AudioManager mAudioManager;
    private ComponentName mRemoteControlResponder;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
        wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "DoNjfdhotDimScreen");

        mAudioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
        mRemoteControlResponder = new ComponentName(getPackageName(),
                RemoteControlReceiver.class.getName());
    }

    @Override
    protected void onPause() {
        super.onPause();
        mAudioManager.registerMediaButtonEventReceiver(
                mRemoteControlResponder);
        wl.release();
    }//End of onPause

    @Override
    protected void onResume() {
        super.onResume();
        wl.acquire();
    }//End of onResume

    @Override
    public void onDestroy() {
        super.onDestroy();
        mAudioManager.unregisterMediaButtonEventReceiver(
                mRemoteControlResponder);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:33:42.260

看看[registerMediaButtonEventReceiver()](http://developer.android.com/reference/android/media/AudioManager.html#registerMediaButtonEventReceiver%28android.content.ComponentName%29)。您必须将您的应用程序注册为这些事件的接收者才能接收它们。

以下是您应该查看的更多链接：

*   [http://android-developers.blogspot.se/2010/06/allowing-applications-to-play-nicer.html](http://android-developers.blogspot.se/2010/06/allowing-applications-to-play-nicer.html)
*   [http://developer.android.com/training/managing-audio/volume-playback.html](http://developer.android.com/training/managing-audio/volume-playback.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T23:44:45.010

以我的经验，当设备处于睡眠状态时，应用程序无法接收媒体按钮广播，即使它是前台服务（媒体按钮不会唤醒它）。保持部分唤醒锁定可防止其进入睡眠状态，因此可以检测到按钮按下。我怀疑您的音乐播放应用程序持有唤醒锁，这就是它起作用的原因。我想被证明是错误的，虽然不需要唤醒锁......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-03T05:01:00.757

我发现了一个开源应用程序，它实际上通过按音量按钮将手机从睡眠中唤醒。 [https://github.com/praslnx8/volume_Screen_Lock](https://github.com/praslnx8/volume_Screen_Lock)

这个应用程序使用服务来播放媒体。

在播放媒体时，即使手机屏幕被锁定，音量按钮操作也将始终发送到相应的接收者...

# jquery - 从动态添加的行中选择表数据

> ID：13357196
> 
> 赞同：0
> 
> 时间：2012-11-13T07:55:46.773
> 
> 标签：jquery, json

这与我之前的问题有关：[How to add onclick function for programmatically created button](https://stackoverflow.com/questions/13267552/how-to-add-onclick-function-for-programmatically-created-button)。

现在，我目前有一个带有两个文本框、一个按钮和一个隐藏表格的表单。单击按钮时，将显示表格并添加一行，其中两列上的文本框的值和第三列上的删除按钮。我现在可以在单击删除按钮时删除选定的行。我的新问题是如何获取第一列和第二列的数据以便更新数据库？

我使用 JSON 来更新数据库。这是我目前拥有的代码：

```
$("#addToDisplay").click(function (event) {
    $("#tblProducts").removeClass("hide");
    var counter = 1;
    event.preventDefault();
    counter++;
    var prod = {prodName: $("#txtProducts").val(), prodQty: $("#txtQty").val()}
    $.ajax({
        type: "POST",
        traditional: true,
        url: "/Service/JsonUpdateProduct",
        dataType: "json",
        data: prod,
        success: function (result) {
            var newRow = "<tr><td id='rowProd" + counter + "'>" + $("#txtProducts").val() + "</td><td id='rowQty" + counter + "'>" + $("#txtQty").val() + "</td><td><input type='button' value='Remove' id='btnRemove" + counter + "' class='remove' /></td></tr>";
            $("#tblProducts").append(newRow);

            $("#tblProducts").on("click", ".remove", function () {
                $(this).closest("tr").remove();
                var rowCount = $("#tblProducts tr").length;
                var removeProd = {revertName: $("#rowProd" + counter).val(), revertQty: $("#rowQty" + counter).val()}
                $.ajax({
                    type: "POST",
                    traditional: true,
                    url: "/Service/JsonRemoveProduct",
                    dataType: "json",
                    data: removeProd,
                    success: function (result) {
                        if (rowCount == 1) {
                            $("#tblProducts").addClass("hide");
                        }
                    }
                });
                $("#productQty").val("");
                $("#autoCompleteText").val("");
            });
        }
    });
}); 
```

我一直在尝试该代码，但我得到的只是导致错误的数量的空值。那么如何从所选行中准确获取所选 ProductName 和 Quantity 的数据？

我基本上想得到这样的东西：

```
var data = { prodName: $("#selectedRowCell1")} 
```

所以我可以将它传递给我的类中的方法并更新数据库。

此外，是否可以获取不同表的当前 ID 并将其插入到另一个表 + 1。这样的事情：

```
Select id from Details
then
Update Products set detailId = Details.id + 1 
```

? 我知道这不起作用，因为我已经尝试过了。那么这样的事情可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:31:06.343

首先，这些应该是单独的点击事件，不要在 ajax 回调中定义点击事件。这就是您使用该`on()`方法的原因。`.on()`充当`event delegator`. 是`selector`一个`static element`绑定到文档`on page load and not after`。这意味着，我们可以将事件绑定到这个父元素，如果作为第二个参数提供，他们的子元素将把事件委托给他们。

```
 $("#addToDisplay").click(function (event) {
    //nothing to change here, omitted for length
 }); 
```

在这里，问题是如何获得`productData`. `.remove`根据您的定义，产品数据是单击类元素​​时行中的前两列。我们开始做吧。

```
$("#tblProducts").on("click", ".remove", function() {
    //when you do the following, you remove the entire row we need
    //lets not do that yet.
    //$(this).closest("tr").remove();

    var $this = $(this); //cachable -- save some performance, reference success

    var col1 = $this.closest('tr').find('#rowProd').text(), // first column
        col2 = $this.closest('tr').find('#rowQty').text(), //second column
        productData = { 'product' : col1, 'quantity' : col2};

    //now productData is properly populated with the values we need.

    $.ajax({
        type: "POST",
        traditional: true,
        url: "/Service/JsonRemoveProduct",
        dataType: "json",
        data: productData,
        success: function(result) {

            //ajax successful, NOW we'll remove the row.      
            $this.closest("tr").remove();

            if ($this.find('tr').length;) {
                $("#tblProducts").addClass("hide");
            }
        }
    });
    $("#txtQty").val("");
    $("#txtProducts").val("");
});​ 
```

# class - 所有国家/地区的地址类别

> ID：13357198
> 
> 赞同：0
> 
> 时间：2012-11-13T07:56:16.990
> 
> 标签：class, business-logic, street-address

我正在尝试为我的全球电子商务项目开发全球地址类。必须可以为不同的地址格式构造不同的地址形式，因此我需要全局地址类。哪些属性在这个类中必须是通用的？您对此有何建议？

注意：我发现这个[网站](http://www.addressdoctor.com/en/countries-data/address-formats.html)有许多国家的地址格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T04:00:23.530

[万国邮联](http://www.upu.int/en/resources/postcodes/addressing-systems.html)有您正在寻找的文档和建议。

# symfony - 使用 symfony 2 的 swift mailer，收到一封电子邮件，但在电子邮件中收到不必要的回复

> ID：13357202
> 
> 赞同：8
> 
> 时间：2012-11-13T07:56:55.300
> 
> 标签：symfony, twig, swiftmailer

通过电子邮件收到此响应“HTTP/1.0 200 OK Cache-Control: no-cache Content-Type: text/html; charset=UTF-8 Date: Tue, 13 Nov 2012 04:56:14 GMT”。

这是我的代码：

```
 public function sendEmail($subject, $template, $templateParams)
    {
        $userEmail = $this->session->get('email');
        $name = $this->session->get('name');
        $adminEmail = $this->container;
        $templateParams['username'] = $name; 
        $message = \Swift_Message::newInstance()
                ->setSubject($subject)
                ->setFrom($adminEmail)
                ->setTo($userEmail)
                ->setBody($this->templating->render('SocialDonSocialBundle:Email:'.$template,$templateParams), 'text/html'); 
        $this->mailer->send($message); 
```

另请注意，此方法属于“电子邮件”服务。我创建了一个负责发送电子邮件的服务“电子邮件”。有人知道可能是什么问题吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-09-12T13:17:19.280

您需要使用renderView() 而不是render()，因为render() 总是显示标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-26T14:33:46.337

在较新版本的 Symfony2 中，例如 2.5.*

解决方案是使用 renderResponse 并对其执行 getContent() ：

```
$content = $this->container->get('templating')->renderResponse(
        'YOUR_TEMPLATE.twig',
        templateParams)
    )->getContent(); 
```

或具有与问题相同的值：

```
$this->templating->renderResponse('SocialDonSocialBundle:Email:'.$template,$templateParams)->getContent(); 
```

# java - 打开 javamail 文件夹失败

> ID：13357204
> 
> 赞同：0
> 
> 时间：2012-11-13T07:56:59.797
> 
> 标签：java, email, jakarta-mail, james

我使用 javamail 和 apache-james 开发了一个电子邮件网站，它大部分都运行良好。但是一些用户得到了 Open failed Exception 并且无法接收新邮件。接收邮件代码：

```
Session mailSession = Session.getInstance(System.getProperties(), null);
mailSession.setDebug(false);
Store store = null;
Folder folder = null; //javax.mail.Folder
try {
    store = mailSession.getStore(SParam.PROTOCOL);
    store.connect(Property.getPop3(), userName, password);
    logger.info("trying to receive emails from james server...");
    folder = store.getFolder("INBOX");
    try {
        if (!folder.isOpen()) {
            folder.open(Folder.READ_WRITE); //the point of throwing the exception
        }
    } catch (Exception e) {
        // TODO: handle exception
        e.printStackTrace();
    }
    //receive email from james server.
} catch (Exception e) {
    logger.error("Email Receive Error!" + StackTraceStr.st2str(e));
    try {
        folder.close(true);
    } catch (Exception e2) {
}
} finally {
    try {
        store.close();
    } catch (Exception cloex) {
    }
} 
```

在大多数情况下，它工作得很好。但是偶尔还是会报错：

```
javax.mail.MessagingException: Open failed;
nested exception is:
java.io.IOException: STAT command failed: null
at com.sun.mail.pop3.POP3Folder.open(POP3Folder.java:228)
at com.csc.mail.jsh.mail.core.ReceiveMail.receive(ReceiveMail.java:82)
at com.csc.mail.jsh.mail.core.ReceiveMail.run(ReceiveMail.java:222)
at java.lang.Thread.run(Thread.java:619)
Caused by: java.io.IOException: STAT command failed: null
at com.sun.mail.pop3.Protocol.stat(Protocol.java:366)
at com.sun.mail.pop3.POP3Folder.open(POP3Folder.java:203)
... 3 more 
```

等待您的帮助，非常感谢！

我调试调试，终于发现STAT命令失败了！当 STAT 命令出错时，有 james 的异常，但这没有任何意义！

```
21/11/12 14:39:16 ERROR pop3server: Exception during connection from 127.0.0.1     
    (127.0.0.1) : An exception occurred getting a database connection.
    org.apache.avalon.framework.CascadingRuntimeException: An exception occurred getting a database connection.
at org.apache.james.userrepository.AbstractJdbcUsersRepository.openConnection(AbstractJdbcUsersRepository.java:617)
    at org.apache.james.userrepository.AbstractJdbcUsersRepository.getUserByName(AbstractJdbcUsersRepository.java:521)
    at org.apache.james.userrepository.AbstractUsersRepository.test(AbstractUsersRepository.java:270)
    at org.apache.james.core.LocalUsersRepository.test(LocalUsersRepository.java:90)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.avalon.phoenix.components.application.BlockInvocationHandler.invoke(BlockInvocationHandler.java:134)
    at $Proxy4.test(Unknown Source)
    at org.apache.james.pop3server.POP3Handler.doPASS(POP3Handler.java:537)
    at org.apache.james.pop3server.POP3Handler.parseCommand(POP3Handler.java:479)
    at org.apache.james.pop3server.POP3Handler.handleConnection(POP3Handler.java:277)
    at org.apache.james.util.connection.ServerConnection$ClientConnectionRunner.run(ServerConnection.java:432)
    at org.apache.excalibur.thread.impl.ExecutableRunnable.execute(ExecutableRunnable.java:55)
    at org.apache.excalibur.thread.impl.WorkerThread.run(WorkerThread.java:116)
Caused by: java.sql.SQLException: Listener refused the connection with the following error:
    ORA-12519, TNS:no appropriate service handler found
    The Connection descriptor used by the client was: 192.168.250.23:1521:csmis
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:261)
    at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:387)
    at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:439)
    at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:165)
    at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)
    at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:37)
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:290)
    at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:771)
    at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)
    at org.apache.james.util.dbcp.JdbcDataSource.getConnection(JdbcDataSource.java:220)
    at org.apache.james.userrepository.AbstractJdbcUsersRepository.openConnection(AbstractJdbcUsersRepository.java:614)
... 15 more 
```

所有应用程序都在同一台服务器上运行，并且只有少数用户在线（当我测试它时，只有我使用它）。错误只是偶尔出现。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:16:13.073

好像是邮件服务器的问题。`STAT`命令用于显示消息的数量。通常`STAT`是成功连接到邮件服务器后运行的第一个命令。

尝试使用`mailSession.setDebug(true)`进入调试模式以获取更多错误日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T02:09:52.520

我与 Apache James 有过接触，终于找到了答案。你可以在这里找到它：[STAT 命令偶尔失败](http://www.mail-archive.com/server-user@james.apache.org/msg14115.html)。在页面的末尾，已列出该线程。

# django - 面向初学者的 Django/MongoDB 教程

> ID：13357218
> 
> 赞同：3
> 
> 时间：2012-11-13T07:57:58.317
> 
> 标签：django, mongodb

我是初学者，之前没有任何 Web 应用程序开发经验。到目前为止，我只做了一些 CLI 编程。谁能建议我如何开始使用 Django 和 MongoDB？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T11:25:04.290

有一个针对 MongoDB 的免费教育课程，一个专注于[开发人员](https://education.10gen.com/courses/10gen/M101/2012_Fall/about)，另一个[专注于管理](https://education.10gen.com/courses/10gen/M102/2012_Fall/about)。仍然有时间注册 afaik，所以我建议看一下开发人员课程（由 10gen 首席执行官 Dwight Merriman 教授）。

可以在[此处](http://docs.mongodb.org/manual/tutorial/)找到 MongoDB 教程。

有一个关于在 Django 中使用[MongoEngine](http://mongoengine-odm.readthedocs.org/en/latest/django.html)的简短文档。MongoEngine 维护者在[这里](http://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-django-mongodb-engine/)写了一篇关于使用 MongoEngine 和 Django 编写应用程序的教程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T08:04:57.687

当您想学习 Web 应用程序开发时，您应该首先学习如何使用文本编辑器创建静态 HTML 页面，这样您才能了解 WWW 的实际工作原理。

当您对 HTML 和 CSS 有了扎实的了解后，您可以从使用 Django 生成动态网站开始。

在学习了如何在服务器端生成网站之后，使用像 MongoDB 这样的数据库是一个完全不同的问题。

# java - 如何理解 Java 泛型的这种用法

> ID：13357222
> 
> 赞同：6
> 
> 时间：2012-11-13T07:58:20.600
> 
> 标签：java, generics

在我的学习书中，有这个例子：

```
import java.util.*;
public class RentalGeneric<T> {

  private List<T> rentalPool;

  private int maxNum;
  public RentalGeneric(int maxNum, List<T> rentalPool) {

  this.maxNum = maxNum;
  this.rentalPool = rentalPool;
}
public T getRental() {
  return rentalPool.get(0);
}
  public void returnRental(T returnedThing) {
    rentalPool.add(returnedThing);
  }
} 
```

我觉得它编译起来很奇怪，因为没有`Class<T>`. 这有什么故事？它在我的书中说`T`是用于类型参数但我怎么知道何时使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:02:08.783

你可以用它来租汽车、自行车……你可以像这样直接使用它：

```
RentalGeneric<Car> carRental = new RentalGeneric<Car>(10, aList); 
```

然后，当你这样做时，`getRental`它会返回一个`Car`对象。你就可以放回一个`Car`with`returnRental(aCar);`

或者您可以创建一个`CarRental`扩展`RentalGeneric<Car>`.

对于您想租用的任何物品也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:00:17.847

T 在这里是通用类型。它将在创建`RentalGeneric`类的对象时被初始化。

```
RentalGeneric<Double> rgS =new RentalGeneric<Double>(10, new ArrayList<Double>());
RentalGeneric<Integer> rgS =new RentalGeneric<Integer>(10, new ArrayList<Integer>()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:03:08.343

`T`你是对的，你的代码中没有直接的定义。但是，它可以在运行时在此代码之外找到。确实在您创建列表实例的地方。当你这样做时，你必须提供类型信息，例如

`List<String> mylist = new ArrayList<String>();`

这里我们定义列表包含字符串。现在我们调用您的代码：

`new RentalGeneric(123, mylist)`

`mylist`是一个字符串列表，所以`RentalGeneric`的类型参数`String`也是。

# json - WWW::Wunderground::API 不能保佑非参考值

> ID：13357224
> 
> 赞同：3
> 
> 时间：2012-11-13T07:58:32.690
> 
> 标签：json, perl, bless, wunderground

我想使用模块 WWWW::Wunderground::API 使用 JSON 下载带有天气的数据。

这是我的 PERL 脚本：

```
use WWW::Wunderground::API;

my $wun = new WWW::Wunderground::API(location=>'KIAD', api_key=>'my key');
print 'JSON source:'.$wun->json if $wun->api_type eq 'json'; 
```

它给了我一个错误：

> 无法祝福 /usr/local/share/perl5/Hash/AsObject.pm 第 82 行的非参考值。

我无法修复它。我一直在尝试更新 cpan 和其他模块，但它没有给出任何结果。

你能告诉我如何修理它吗？

先感谢您

* * *

与鲤鱼::总是：

> 无法在 /usr/local/share/perl5/Hash/AsObject.pm 第 82 行祝福非参考值 Hash::AsObject::AUTOLOAD('Hash::AsObject', undef) 在 /usr/local/share 调用/perl5/WWW/Wunderground/API.pm 第 37 行 WWW::Wunderground::API::update('WWW::Wunderground::API=HASH(0x1e5b178)', 'KIAD') 在 /home/xyz/workspace 调用/WeatherTest/scr.pl 第 4 行 eval {...} 在 /home/xyz/workspace/WeatherTest/scr.pl 第 4 行调用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T08:17:23.587

它来自缺乏错误检查。以下意外返回`undef`：

```
JSON::Any->jsonToObj($json)->{current_observation} 
```

您可能想查看使用以下内容获取的内容：

```
use LWP::Simple qw( get );
my $api_key  = 'my key';
my $location = 'KIAD';
print get("http://api.wunderground.com/api/$api_key/conditions/q/$location.json"); 
```

也许您可以解决的响应中有错误消息。例如，错误的 API 密钥会导致以下响应：

```
{
        "response": {
                "version": "0.1"
                ,"termsofService": "http://www.wunderground.com/weather/api/d/terms.html"
                ,"features": {
                }
                ,
        "error": {
                "type": "keynotfound"
                ,"description": "this key does not exist"
        }
        }
} 
```

# java - Robot Framework - 使用用户库

> ID：13357227
> 
> 赞同：2
> 
> 时间：2012-11-13T07:58:39.560
> 
> 标签：java, python, robotframework

我在尝试运行测试时遇到了困难。这是我所做的：

1.  使用一个类创建一个 java 项目，该类具有一个名为 hello(String name) 的方法
2.  将其导出为 jar 并将其保存在我保存测试用例文件的同一目录中。
3.  我的测试用例看起来像这样。

    *   设置 * * 值 * * 值 * * 值 * * 值 * * 值 *

        图书馆我的图书馆

    *   变量 * * 值 * * 值 * * 值 * * 值 * * 值 *

        *   测试用例 * * 动作 * * 参数 * * 参数 * * 参数 * * 参数 * MyTest
            hello World

        *   关键字 * * 动作 * * 参数 * * 参数 * * 参数 * * 参数 *

我总是收到以下错误：

表“设置”中的文件“C:\Users\yahiya\Desktop\robot-practice\testcase_template.tsv”出错：导入测试库“MyLibrary”失败：ImportError：没有名为 MyLibrary 的模块

我已经在我的 Windows 机器的系统变量中配置了 Pythopath。

请让我知道我在这里做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T09:28:02.860

导入库的方式可能存在问题。我对 Java 库没有太多经验，但您需要在导入库时提供全名，包括包名。

在指南中[阅读更多内容。](http://robotframework.googlecode.com/svn/tags/robotframework-2.1/doc/userguide/RobotFrameworkUserGuide.html#test-library-names)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T09:41:45.910

尝试将您的库放入此文件夹：

...YourPythonFolder\Lib\site-packages\

或者，如果这不起作用，请在文件夹“site-packages”文件夹中创建名为“MyLibrary”的文件夹并将您的库放在那里。

这应该有效。

# django - 在视图中构建美味的资源？

> ID：13357231
> 
> 赞同：0
> 
> 时间：2012-11-13T07:59:00.433
> 
> 标签：django, django-views, tastypie

我已经知道如何在 sweetpie 中创建 ModelResource。例如，我在 resources.py 中有 UserResource，在 models.py 中有 User。但是在views.py 中，我有一个名为match_user 的视图，它获取所有用户的列表并匹配到request.user。它返回一个名为 mymatch.html 的 render_to_response html。一切都在浏览器上运行，但我想为这个特定的 match_user 创建一个 API。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-17T19:10:28.043

我认为以下内容回答了您的问题：

```
class UserResource(ModelResource):
    class Meta:
        queryset = User.objects.all()
        resource_name = "user"
        authentication = SessionAuthentication()

    # User is only authorized to view his own details   
    def apply_authorization_limits(self, request, object_list):
        return object_list.filter(pk=request.user.pk) 
```

如果用户具有活动会话并且已经登录，则会话身份验证将起作用。有关更多身份验证选项，请参阅[https://django-tastypie.readthedocs.org/en/latest/authentication_authorization.html?highlight=authentication#authentication-options](https://django-tastypie.readthedocs.org/en/latest/authentication_authorization.html?highlight=authentication#authentication-options)

# php - 解析错误：语法错误，第 76 行 /srv/disk1/1185368/www/mashcraft.atwebpages.com/profile.php 中的意外 T_VARIABLE

> ID：13357232
> 
> 赞同：-1
> 
> 时间：2012-11-13T07:59:03.417
> 
> 标签：php, sql

请帮忙看看这段代码有什么问题？（第 76 行是中间那一行）

```
require("dbConfig.php");
$sql = 'SELECT * FROM dbUsers WHERE username='$_SESSION["valid_user"]'';
$r = mysql_query($sql); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:02:21.593

请连接你的字符串

```
$sql = 'SELECT * FROM dbUsers WHERE username="'.mysql_real_escape_string($_SESSION["valid_user"]).'"'; 
```

建议：

1.学会防止MySQL注入：[好链接](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

2.不推荐使用Mysql扩展来编写新代码。相反，应该使用 mysqli 或 PDO_MySQL 扩展。更多阅读：[PHP 手册](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T07:59:46.120

你错过`.`了：

```
$sql = 'SELECT * FROM dbUsers WHERE username='$_SESSION["valid_user"]''; 
```

应该：

```
$sql = "SELECT * FROM dbUsers WHERE username='".$_SESSION["valid_user"]."'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:00:11.127

尝试这个：

```
$sql = 'SELECT * FROM dbUsers WHERE username='.$_SESSION["valid_user"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:02:27.553

试试这个（如果你清理用户输入，你将防止 SQL 注入）：

```
<?php
require("dbConfig.php");
$sql = "SELECT * FROM dbUsers WHERE username='".filter_var(mysql_real_escape_string($_SESSION["valid_user"]),FILTER_SANITIZE_STRING)."'";
$r = mysql_query($sql);
?> 
```

编辑：添加了 mysql_real_escape_string() 用于转义输入字符串，但即使这样也不是 100% 有效地防止 SQL 注入，如[这里](http://ilia.ws/archives/103-mysql_real_escape_string-versus-Prepared-Statements.html)所讨论的。

# c# - 如何获取 DeploymentItem 的名称？

> ID：13357237
> 
> 赞同：4
> 
> 时间：2012-11-13T07:59:15.577
> 
> 标签：c#, mstest, deploymentitem

我想摆脱这段代码中的一些重复。遵循 DRY 原则。
如您所见，文件/deploymentItem 的名称是重复的。

```
[TestMethod]
[DeploymentItem("TestData/TestExcel.xlsx")]      <-- 
public void GivenAnExcel_ConverToPDF()
{
    const string filename = "TestData/TestExcel.xlsx";     <-- 
    var result = pdfConverter.ConvertExcelDocument(filename);
    AssertIsPdf(result);
} 
```

*   有没有办法在不使用文件名的情况下以编程方式访问 DeploymentItem？
    或者
*   我可以以某种方式以编程方式获取文件名吗？

*不，我不能使用除 mstest 之外的其他测试框架；-)*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:15:43.890

你可以简单地这样做：

```
[TestClass]
public class Test
{
    const string filename = "TestData/TestExcel.xlsx";

    [TestMethod]
    [DeploymentItem(filename)] 
    public void GivenAnExcel_ConverToPDF()
    {
        var result = pdfConverter.ConvertExcelDocument(filename);
        AssertIsPdf(result);
    }
} 
```

# c# - Unicode 字符串转汉字

> ID：13357241
> 
> 赞同：0
> 
> 时间：2012-11-13T07:59:50.973
> 
> 标签：c#, unicode, character-encoding, bytearray, cjk

我有一个 unicode 字符串，比如说“U+660E”，我想显示相应的字符，在这种情况下是明。请参阅[此页面](http://smontagu.damowmow.com/genEncodingTest.cgi?family=windows&codepage=950) （ctrl-F 查找明）。

到目前为止我的代码：

```
string unicodeString = reader.GetString(0);
unicodeString.Trim();

Encoding codepage = Encoding.GetEncoding(950);
Encoding unicode = Encoding.Unicode;
byte[] encodedBytes = codepage.GetBytes(unicodeString);
//unicodeString = Encoding.Convert(codepage, unicode, encodedBytes).ToString();
unicodeString = unicode.GetString(encodedBytes);
richTextBox1.Text = unicodeString; 
```

我的输出是“⭕㘶䔰�”。知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:04:41.480

.net 直接处理 unicode。您不必**玩**编码游戏。只需告诉读者输入是 UTF-8 还是 UTF-16，然后将其作为普通字符串处理即可。

```
richTextBox1.Text = reader.GetString(0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:05:10.353

无需转换为 CP-950；C# 是彻头彻尾的 Unicode。除非您要输出到您知道必须是 CP-950 的文件，否则只需输入和打印为 Unicode。

# c# - 如何在 C# 中获取英语中所有 4 个字母单词的列表

> ID：13357243
> 
> 赞同：3
> 
> 时间：2012-11-13T08:00:14.127
> 
> 标签：c#

我是初学者，一直在玩 C#。我最近为非常流行的“牛和牛”文字游戏编写了代码。它适用于 2 名玩家，即；一个玩家想到一个词，另一个人必须猜它。我只给出 10 次猜测的机会。

我现在想为单人游戏制作游戏（电脑对人）。我想知道是否有没有字母重复的英语语言中的所有 4 个字母单词（我将游戏限制为仅 4 个字母单词）。我知道我可以使用枚举并写下所有 4 个字母的单词。但这是对单词的硬编码。那将是我最后的选择。我可以输入所有的单词，但如果我玩游戏，我会对这个词有一些了解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:21:11.857

假设您有一个名为`words`list 的单词列表

您可以使用正则表达式选择 4 个字母的唯一词

```
 List<string> 4letterUniqueWords=words
.Where(x=>Regex.IsMatch(x,"^(?=^[a-zA-Z]{4}$)(?!^.*?(.).*?\1.*?$).*?$"))
.Select(y=>y)
.ToList<string>(); 
```

* * *

```
^(?=^[a-zA-Z]{4}$)(?!^.*?(.).*?\1.*?$).*?$
  ---------------  ------------------ ---
        |                  |           |->matches if both the lookaheads are true
        |                  |->checks if there are any repeating words
        |->checks if the words contains 4 letter alphabetic words 
```

# c# - 一起运行两个 parallel.foreach()

> ID：13357248
> 
> 赞同：4
> 
> 时间：2012-11-13T08:00:38.523
> 
> 标签：c#, .net, multithreading, backgroundworker, task-parallel-library

我有一个后台工作人员，它为列表项调用并行线程

```
 doWork()
    {
    Parallel.foreach(list1, a=>
    {
       while(true)
       {
             //do some operations
       }
    });

    Parallel.foreach(list2, b=>
    {
        while(true)
        {
            //do some operations
        } 
    });
    } 
```

如果我想同时运行这两个列表，我应该创建另一个线程作为它们的父线程还是其他方式？我分别获取这两个列表，因此不能将它们组合在一起。而且我在它们两个内部都运行无限循环。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:07:24.900

您可以使用任务在不同的线程上运行这两个循环。使用正常`foreach`循环。

```
var t1 = Task.Factory.StartNew(() => 
{
    foreach(var a in list1)
    {
        //do some operations
    }
});

var t2 = Task.Factory.StartNew(() => 
{
    foreach(var a in list1)
    {
        //do some operations
    }
});

// This will block the thread until both tasks have completed
Task.WaitAll(t1, t2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:03:06.287

为两个“foreach”循环创建两个单独的线程。

# django - `__unicode__()` 添加在 Django 教程中的基本投票应用程序中不起作用

> ID：13357251
> 
> 赞同：6
> 
> 时间：2012-11-13T08:00:56.340
> 
> 标签：django

在从源代码安装了 Django 的开发源代码以及 PostgreSQL 以及从源代码需要的所有其他内容之后，我正在完成 Django 教程。我正在尝试在 Ubuntu 12.10 上使用 python3 而不是 python 来做所有事情。

一切似乎都很顺利，直到我进入教程中的部分，我们应该重新定义`__unicode__()`以便在我们从表中请求 objects.all() 时返回合理的结果。它根本不起作用。我决定试一试`__str__()`，它奏效了！

但是，本教程解释说我们不应该重新定义`__str__()`. 那么，我的安装有什么问题`__unicode__()`吗`__str__()`？本教程中的其他方法工作正常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T08:14:05.197

在 Python 3 和 2 中，字符串的处理方式不同。

2、`__str__()`返回字节，同时`__unicode__()`返回字符。在 3 中，`__str__()`现在返回字符，因为字符串现在是原生 unicode，并且`__unicode__()`不存在。如果你真的需要旧的 2 行为`__str__()`，我相信它是现在`__bytes__()`。

简短的回答，如果您使用的是 Python 3，请坚持`__str__()`使用，并意识到 Django 教程明确声明它们是为 2.x 编写的，因此会有差异。

# java - 我如何在 php 中生成这个 java 代码？

> ID：13357252
> 
> 赞同：-3
> 
> 时间：2012-11-13T08:01:06.163
> 
> 标签：java, php, math

我想在 php 中生成这个 java 代码，我该怎么做？

爪哇：

```
Math.round(Math.random()*999999); 
```

PHP：

```
 ???? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:03:56.130

阅读有关 rand(); - 查看链接，它应该为您提供更多信息： http: [//php.net/manual/en/function.rand.php](http://php.net/manual/en/function.rand.php)

但是如果我可以添加一个旁注，如果你在互联网上搜索“随机函数 PHP”，你会得到很多结果，包括我上面的..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:03:38.607

就这么简单，因为你得到了一个范围，而 Java 给出了 0 到 1 之间的浮点数。

```
rand(0,999999); 
```

# jdbc - JDBC2：我们如何保证数据访问层是隔离的？

> ID：13357254
> 
> 赞同：1
> 
> 时间：2012-11-13T08:01:08.987
> 
> 标签：jdbc

我正在做一个学校作业，我必须提交一个问题的演示文稿 - “我们如何确保数据访问层是隔离的。”。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T06:44:13.523

[@Polppan 介绍的这个](http://balusc.blogspot.com/2008/07/dao-tutorial-data-layer.html)网站清楚地提到了数据访问层以及如何进行。

# python - 嵌套字段的xml解析

> ID：13357262
> 
> 赞同：0
> 
> 时间：2012-11-13T08:01:56.883
> 
> 标签：python, xml

我有这样的 XML：（这是汤变量）

```
<?xml version="1.0" encoding="utf-8"?>
<results>
 <status code="ok">
 </status>
 <principal-list>
  <principal account-id="1013353221" has-children="false" is-hidden="false" is-primary="false" principal-id="1013353225" training-group-id="" type="user">
   <name>
    First Last
   </name>
   <login>
    first.last
   </login>
   <email>
    first.last@domain.com
   </email>
   <display-uid>
    first.last
   </display-uid>
  </principal>
  <principal account-id="1013353221" has-children="false" is-hidden="false" is-primary="false" principal-id="1115269931" training-group-id="" type="user">
   <name>
    First Last
   </name>
   <login>
    first.last
   </login>
   <email>
    first.last@domain.com
   </email>
   <display-uid>
    first.last
   </display-uid>
  </principal>
 </principal-list>
</results> 
```

我试过这段代码：

```
loginlist = [el.string for el in soup.findAll('login')]
for entry in loginlist:
    print entry 
```

它返回：

```
first.last 
```

对于每个用户。

我还想找到`principal-id`嵌套的`login`

我的输出看起来像：

```
`'first.last', '1013353225'`
`'first.last', '1115269931'` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:11:17.030

而是寻找`<principal>`元素：

```
for principal in soup.findAll('principal'):
    login = principal.find('login')
    if login is None:
        continue
    print principal['principal-id'], login.string 
```

# sql-server - 从 Number 中删除小数，在 Sql server 中保留数千个分隔符？

> ID：13357265
> 
> 赞同：1
> 
> 时间：2012-11-13T08:02:08.020
> 
> 标签：sql-server, sql-server-2008

我有一个数字：`12345.678`

我希望它像：（`12,345`删除其余部分！）

*添加千位分隔符*的一种解决方案是：

```
 select convert(varchar(100), cast(12345.678 as money), 1) 
```

产生：`12,345.68`

现在我应该删除`.68`

我偶然发现了一个漂亮的 **[parseName](http://msdn.microsoft.com/en-us/library/ms188006.aspx)**解决方案 ：

```
 select    parsename(convert(varchar(100), cast(12345.678 as money), 1),2) 
```

产生：`12,345`

问题：这个问题有*更好*的解决方案吗？（也许不涉及其他函数/字符串操作？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T08:39:26.297

在 SQL Server 2008 中没有简单的方法来做到这一点。SQL Server 2012 引入了[FORMAT](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28FORMAT_TSQL%29;k%28SQL11.SWB.TSQLRESULTS.F1%29;k%28SQL11.SWB.TSQLQUERY.F1%29;k%28MISCELLANEOUSFILESPROJECT%29;k%28DevLang-TSQL%29&rd=true)函数，它使您能够执行以下操作：

```
SELECT FORMAT(12345.67, '#,###') 
```

（尽管这会将数字四舍五入为 12,346）

格式化结果通常不在数据库范围内 - 它应该留给您的前端程序/网站/报告/电子表格等。但是，如果您确实需要在 SQL Server 中执行此操作，我怀疑您的解决方案与您将获得的一样接近，除非您使用 CLR 集成从 .NET 链接到 String.Format 函数。

如果您确实使用 parseName 使用您的解决方案，请注意它可能无法在国际范围内使用（例如，在`,`用作小数分隔符的欧洲部分地区）。这对您来说可能不是问题，但如果是，那么您将需要一个允许您显式控制格式的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T08:49:34.373

Parsename 确实是一个创造性的解决方案。我一直在使用

```
select replace(convert(varchar,cast(floor(12345.678) as money),1), '.00', '');
--     parsename(convert(varchar,cast(12345.678 as money),1), 2); 
```

虽然它更长。但也许直接替换比解析例程更快？无论如何，从某种意义上说，即使它运行得快了 21ns，但在更大的方案中，你想通过这样的问题改进什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T08:10:40.370

首先使用 floor() 将其转换为整数：

```
select convert(varchar(100), cast(floor(12345.68) as money), 1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T09:18:23.130

我支持理查兹的评论，即这通常在“表示”层中完成。为什么需要在 SQL Server 中格式化？您是否直接在 SQL Server 中查看报告？通常有人做的第一件事就是复制并粘贴到 Excel 中。

无论如何，如果您总是可以将上面的表达式包装在更多的字符串函数中：

```
select replace(
convert(
    varchar(100), 
    cast(floor(12345.68) as money),
    1
),'.00','') 
```

这仍然可能存在错误，我再次建议不要在 SQL Server 上执行此操作，除非您正在生成类似 COBOL 的文本报告。

# php - 处理列的单数记录

> ID：13357266
> 
> 赞同：1
> 
> 时间：2012-11-13T08:02:12.787
> 
> 标签：php, mysql

我有一个这样的数据库：

```
 ----------------------------------------------
  | ID |  Time  |    Typeop     |   Operator   |
  ----------------------------------------------
  |  1 |  10:01 |  withdrawal   |     John     |
  |  2 |  10:01 |  deposit      |     Mike     |
  |  3 |  10:01 |  deposit      |     Andrew   |
  |  4 |  10:02 |  check        |     John     |
  |  5 |  10:02 |  withdrawal   |     Simon    |
  |  6 |  10:03 |  withdrawal   |     Dorothy  | 
```

通过以下查询，我选择最后三行：

```
 SELECT * from mytable ORDER BY ID DESC LIMIT 0,3 
```

问题：我需要在 php 脚本中“回显”我脚本不同位置和不同顺序的最后三个运算符，因此我将每个名称分配给不同的变量。在这个例子中：

*   $name0 = 多萝西
*   $name1 = 西蒙
*   $name3 = 约翰

所以我可以将它们（例如）放在这样的文本中......“多萝西是西蒙之后最后一个进行手术的人。约翰今天在三个之前停止了......”

提前考虑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:21:30.707

您需要将结果存储在一个独立的 php 数组中

```
$ops = array();
$result = mysql_query("SELECT Operator from mytable ORDER BY ID DESC LIMIT 0,3");
$i = 0;
if($result)
{
    while($row = mysql_fetch_assoc($result))        
        $ops[$i++] = $row[0];        
} 
```

这里`$row`每次都会改变，它只会保留最新的值，但`$ops`会存储所有

现在你可以在任何地方使用这个数组来获得你想要的输出（直到你改变数组`$ops`），例如

```
$st = $ops[0]." has been the last to make an operation after ".$ops[1].". ".$ops[2]." today stopped before the three...";
echo $st; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:10:18.513

将结果放入数组并使用键`0`、`1`和`2`来定位它们：

```
$operators = array();

$result = $mysqli->query("SELECT Operator from mytable ORDER BY ID DESC LIMIT 0,3");

if($result)
{
    while($row = $result->fetch_assoc())
    {
        $operators[] = $row['Operator'];
    }
}

if(count($operators) >= 3)
{
    echo htmlentities($operators[0]) . " has been the last to make an operation after " . htmlentities($operators[1]) . ". " . htmlentities($operators[2]) . " today stopped before them";
} 
```

这个例子使用 MySQLi 并假设总是有 3 条记录。

**编辑：**任何 MySQL 库的原理都是一样的，例如使用本机 mysql_* 库：

```
$operators = array();

$result = mysql_query("SELECT Operator from mytable ORDER BY ID DESC LIMIT 0,3");

if($result)
{
    while($row = mysql_fetch_assoc($result))
    {
        $operators[] = $row['Operator'];
    }
}

if(count($operators) >= 3)
{
    echo htmlentities($operators[0]) . " has been the last to make an operation after " . htmlentities($operators[1]) . ". " . htmlentities($operators[2]) . " today stopped before them";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:10:35.017

> // 从表中收集数据

```
$data = mysql_query("SELECT * from mytable ORDER BY ID DESC LIMIT 0,3") or  die(mysql_error()); 
```

> // 将“mytable”信息放入 $info 数组

```
 $info = mysql_fetch_array( $data ); 
```

> //打印信息

```
while($info = mysql_fetch_array( $data )) 
{ 
   echo "<b>Operator:</b> ".$info['Operator'] . " "; 
} 
```

# java - Apache Mahout K-means 集群简介

> ID：13357280
> 
> 赞同：1
> 
> 时间：2012-11-13T08:03:22.207
> 
> 标签：java, apache, mahout, k-means

我正在尝试使用 K-means 算法对稀疏矩阵进行聚类。我将使用 Apache mahout，但我没有找到任何关于如何使用 Java 实现它的示例。有没有关于它的教程或功能javadoc？

我试过 KmeansDriver 的 run() 函数，但我没有给出真实的参数。老实说，我不明白这个功能的实现。是否有一个关于采用矩阵、数据集或文件并提供聚类数据的明确示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:42:25.253

这是一个使用 KMeansDriver 的示例，并解释了其运行方法的更多参数：http: [//svn.apache.org/viewvc/mahout/trunk/examples/src/main/java/org/apache/mahout/clustering/合成控制/kmeans/Job.java?view=markup](http://svn.apache.org/viewvc/mahout/trunk/examples/src/main/java/org/apache/mahout/clustering/syntheticcontrol/kmeans/Job.java?view=markup)

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T07:34:36.717

这是“Mahout in Action”一书中的 Hello World 集群示例的更新版本。该示例使用 Mahout 版本 0.9。 [http://develop.nydi.ch/2014/04/02/mahout-clustering-example/](http://develop.nydi.ch/2014/04/02/mahout-clustering-example/)

# c# - 在一个 uiviewimage 的动画完成后触发一个事件以动画主动画（单触摸）

> ID：13357281
> 
> 赞同：1
> 
> 时间：2012-11-13T08:03:26.987
> 
> 标签：c#, iphone, .net, ios, xamarin.ios

在一个 uiviewimage 的动画完成后，触发一个事件来为主动画制作动画。ViewDidLoad() 具有主要的动画逻辑。加载后，屏幕上会出现一个动画圈。

屏幕上有一个按钮，它会触发另一个动画，持续时间仅为 6 秒。

我想要一种逻辑和方法，可以运行之前的动画。

在我看来，可以通过回调或线程来完成吗？

请给出您的建议作为答案，如果您建议回调方法，一段代码将是完美的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T07:20:10.030

这是 Omar Johari 的示例，转换为 MonoTouch：

```
UIView.Animate(0.6, 0d, UIViewAnimationOptions.CurveEaseOut, 
               () => {
                      // Animations here
               }, 
               () => {
                      // After animation completes
               }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:20:48.560

```
[UIView animateWithDuration:0.6f
                      delay:0.0f
                    options:UIViewAnimationOptionCurveEaseOut
                 animations:^{
                     // Do your animations here.
                 }
                 completion:^(BOOL finished){
                     if (finished) {
                         // Do your method here after your animation.
                     }
                 }]; 
```

如果你使用块你可以允许在动画完成后调用你想要的任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T08:29:40.247

尝试做这样的事情。

为您的主屏幕动画制作一个功能

```
 -(void)mainScreenAnimation
       {
          // do ur code here
       } 
```

现在，当使用按钮触发动画时，将这样的内容添加到按钮事件中

```
 -(IBAction)btnPressed:(id)sender
   {
        // try implementing a timer which starts after 6seconds and the selector of the timer should be @selector(mainAnimationScreen)

         timer=  [NSTimer scheduledTimerWithTimeInterval:6.0 target:self selector:@selector(mainAnimationScreen) userInfo:nil repeats:NO];

     // if u want to repeat the animation then use this

       timer=  [NSTimer scheduledTimerWithTimeInterval:6.0 target:self selector:@selector(mainAnimationScreen) userInfo:nil repeats:YES];

   } 
```

# grails - iReports 和 grails。设置javabeans数据源和连接

> ID：13357286
> 
> 赞同：0
> 
> 时间：2012-11-13T08:03:47.010
> 
> 标签：grails, jasper-reports, ireport, grails-domain-class, jasper-plugin

我在配置 iReports 时遇到了一些问题，我正在使用`iReport4.8.0`（我之前尝试`iReport4.7.1`过并且发生了同样的问题）和`grails ggts 3.0.0`.

我在一个名为 Consultas 的包中有一个名为 Consulta 的域类，我想列出它们并使用 ireports 创建一个报告，我按照我在书中找到的步骤进行操作：从新手到专业的 Groovy 和 Grails 第 9 章它说从 groovy 类创建报告非常容易（理论上是这样），您只需创建一个包含已编译类的 jar 并将其放在报告 lib 目录中，然后从数据连接中选择“javabeans 设置数据源选项”，其中唯一的字段要填写的是名称，它说将其他设置为空白，当我测试它时会出现一个错误弹出窗口，说 ClassNotFoundError，我确定有一些缺失的步骤，但我不知道是哪个。

在我的咨询控制器中，我有以下代码：

```
def report ={
    def consultas = Consulta.list()
    chain(controller: "jasper", action: "index", model: [data: consultas], params:params)       
} 
```

我认为jassper插件还可以。

# vb6 - 水印 VB MDI 表格

> ID：13357288
> 
> 赞同：1
> 
> 时间：2012-11-13T08:03:56.010
> 
> 标签：vb6, mdi, watermark

我有一个 VB6 MDI 应用程序，用户可以选择他们想要连接的数据库（例如“存档”或“实时”）。当用户访问“存档”数据库时，我希望将其突出显示。理想情况下作为跨表格的水印。所有控件仍然可见并正常工作。当他们使用打印屏幕时，我需要这个水印持续存在。事实上，只在打印屏幕上加水印的解决方案就可以了。

此外，我更喜欢可以在 MDI 父窗体中实现的解决方案，因此我不必更改所有单个子窗体。

到目前为止，我已经尝试过了。

1.  给 MDI 父背景添加水印，并使 MDI 子背景半透明。不幸的是，您似乎无法使 MDI 子窗体透明 - 整个 MDI 应用程序（父和子）变得透明。

2.  使 MDI 应用程序透明，然后在 MDI 父窗体后面添加一个带有水印的非子窗体（此窗体根据 MDI 父窗体移动和调整大小）。这个看起来还可以，如果有点晕，但是 Alt-PrintScreen 只截取了 MDI 窗口，所以没有截取水印效果。PrintScreen 没问题。所以，我可以考虑添加一个键盘挂钩来禁用 Alt-Printscreen。

3.  添加一个键盘挂钩以捕获 PrintScreen 按键，然后在 MDI 应用程序上显示带有水印的透明表单。和2一样，Alt-PrintScreen只截取MDI表单，不显示水印效果。此外，此解决方案仅对打印屏幕输出添加水印。

4.  向 MDI 表单添加背景图像。这不会通过其他控件显示，并且对于具有很多框架的表单，水印不是那么明显。

是否有一些巧妙的方法可以在表单窗口上呈现水印图形？您能否在其他控件上方放置一个透明图片框，并且这些控件仍然可以正常工作？

所有建议表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:55:51.773

除了您要查找的水印措辞之外，我将创建一个透明的新表单。该表单将使用代码来确保它始终位于顶部，并且前面没有其他表单。MDI 表单会启动这个表单并控制表单是否显示存档或实时水印以及表单的位置。

就个人而言，我一直使用应用程序标题或状态栏来始终显示此信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T14:34:19.063

此修复的主要原因是防止来自“存档”系统的任何报告或屏幕截图与“实时”系统混淆。我本来想给屏幕加水印，但这似乎太尴尬了。更改表单背景的颜色/图像或在标题中添加内容等有用的建议是好的、简单的解决方案。

但是，我确实需要确保任何印刷材料或屏幕截图都被清楚地标记。

为报告添加水印非常简单，因为它们使用 Word/Excel 自动化等 - 所以我可以在从“存档”数据库打印时添加透明文本框等。

区分“存档”/“实时”之间的屏幕截图有点尴尬。最终，我采用了设置键盘钩子来捕获任何打印屏幕按键的方法。这仅在“归档”系统上激活。在打印屏幕的按键事件中，我将位图从剪贴板复制到图片框（在隐藏表单上）；在其上平铺透明水印图像；然后将图片框图像复制回剪贴板。因此，如果将其粘贴到另一个应用程序中，则它具有水印。似乎运作良好。当然，这将为所有屏幕截图添加水印，无论它们是否属于申请表——但这对用户来说是可以的。

# python - (Python MySQLdb) 尝试将 UTF-8 插入 MySQL 时

> ID：13357289
> 
> 赞同：2
> 
> 时间：2012-11-13T08:04:02.430
> 
> 标签：python, mysql, utf-8

我找不到解决方案。你能帮我解决这个问题吗？

```
 dic={'username':u'\uc774\ud55c\ub098','userid':u'david007', 'nation':u'\ub300\ud55c\ubbfc\uad6d'}
    c=MySQLdb.connect(host=ddb['host'],user=ddb['user'],passwd=ddb['passwd'],db=ddb['db'], use_unicode=True, charset="utf8")
    s=c.cursor()
    sql="INSERT INTO "+db+" "+col+" VALUES "+str(tuple(dic.values()))
    s.execute(sql)

    "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''\\uc774\\ud55 ... at line 1")

    print sql
    INSERT INTO user_tb (username, userid, nation) VALUES (u'\uc774\ud55c\ub098', u'david007', u'\ub300\ud55c\ubbfc\uad6d') 
```

错误是：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:35:39.327

您需要使用参数化查询：

```
sql = "INSERT INTO " + db + " " + col + " VALUES (%s, %s, %s)"
s.execute(sql, dic.values()) 
```

当您简单地将元组连接到查询时，`u`unicode 字符串的前缀将使这些字符串无效 SQL。使用参数 MySQLdb，将使用参数替换做正确的事情（即将 unicode 字符串编码为字节表示）并生成有效的 SQL。

无论如何，作为一般原则，您应该**始终**在查询中使用参数来防止 SQL 注入。

# jsf-2 - ui:repeat 中的 jsf2.0 commandLink 不起作用

> ID：13357294
> 
> 赞同：2
> 
> 时间：2012-11-13T08:04:49.940
> 
> 标签：jsf-2

我遇到了 commandLink 的问题，它首先在我的表中工作，但其他的在 ui:repeate 中进行，并且那里的 commandLink 不起作用

```
<tr>
                            <td rowspan="#{form25Bean.forms1size}">Наименования научных
                                лабораторий:</td>

                            <td>#{form25Bean.forms1first.sciencenName}</td>
                            <td>#{form25Bean.forms1first.innovationName}</td>
                            <td>#{form25Bean.forms1first.ppcPortion}</td>
                            <td><h:commandLink value="удалить" id="cl2"
                                    action="#{form25Bean.remove}">
                                    <f:setPropertyActionListener
                                        target="#{form25Bean.selectedForm}" value="#{form25Bean.forms1first}" />
                                </h:commandLink> <h:column>
                                    <h:commandLink value="изменить" action="#{form25Bean.edit}">
                                        <f:setPropertyActionListener
                                            target="#{form25Bean.selectedForm}" value="#{form}" />
                                    </h:commandLink>
                                </h:column></td>
                        </tr>
                        <ui:repeat var="f1" value="#{form25Bean.forms1}">
                        <h:form>
                            <tr>
                                <td>#{f1.sciencenName}</td>
                                <td>#{f1.innovationName}</td>
                                <td>#{f1.ppcPortion}</td>
                                <td><h:commandLink value="удалить" id="cl2"
                                        action="#{form25Bean.remove}">
                                        <f:setPropertyActionListener
                                            target="#{form25Bean.selectedForm}" value="#{f1}" />
                                    </h:commandLink>
                                     <h:column>
                                         <h:commandLink value="изменить" action="#{form25Bean.edit}">
                                            <f:setPropertyActionListener
                                                target="#{form25Bean.selectedForm}" value="#{f1}" />
                                         </h:commandLink>
                                    </h:column></td>
                            </tr>
                            </h:form>
                        </ui:repeat> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:14:32.640

看起来你有嵌套表格

有一个表格包裹着你的整个桌子（因为你在`h:commandLink`上面有几个`<ui:repeat`）

而且里面有`form`一个`ui:repeat`

看看你生成的源代码（html），你得到了`<form>.... <form>....</form></form>`

摆脱嵌套形式...（例如删除`<h:form>`from `ui:repeat`）

# asp.net - 当 Web 表单基于母版页时，UseSubmitBehavior=False 不能与 OnClientClick 一起使用

> ID：13357295
> 
> 赞同：2
> 
> 时间：2012-11-13T08:04:51.890
> 
> 标签：asp.net, onclientclick

我正在编写一个管理页面，其中有一个用户名文本框和一个刷新按钮，单击时显示用户详细信息。在其他控件中，我有一个“删除用户”按钮来删除用户。在尝试此操作之前，我有 javascript 代码来获得确认。因为我不希望这个删除用户按钮具有提交行为，所以我设置了 UseSubmitBehavior=False。但是，这导致服务器端事件没有被触发。所以我写了一个小的客户端函数来显式调用__doPostBack。

最终代码有效，但仅适用于*不*基于母版页或嵌套母版页的页面。可悲的是，我所有的网页都是基于母版页的。想知道我是否遗漏了什么或者是否有办法解决？我刚开始使用asp.net，所以请原谅任何明显的错误。

提前谢谢了。

## 代码示例：

以下代码有效（没有母版页的网络表单）

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm_with_NoMasterPage.aspx.cs" Inherits="WebApplication1.WebForm_with_NoMasterPage" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
            <script type="text/javascript">
                function GetConfirmation(btn, msg) {
                    if (confirm(msg)) {
                        __doPostBack(btn.id, '');
                        return true;
                    }
                    else {
                        return false;
                    }
                }
            </script>

            <asp:Button ID="btnRemoveUser" runat="server" Text="Remove User" OnClick="btnRemoveUser_Click" 
                OnClientClick="return GetConfirmation(btnRemoveUser, 'Really remove?');"
                UseSubmitBehavior="false"
                Height="37px" Width="230px" />

    </div>
    </form>
</body>
</html> 
```

后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public partial class WebForm_with_NoMasterPage : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnRemoveUser_Click(object sender, EventArgs e)
        {
            // put a breakpoint here and see if it is hit.
            int x = 0;
        }
    }
} 
```

以下不起作用（相同的片段，但在基于母版页的 Web 表单中）：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="WebForm_WITH_MasterPage.aspx.cs" Inherits="WebApplication1.WebForm_WITH_MasterPage" %>
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="FeaturedContent" runat="server">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="MainContent" runat="server">
            <script type="text/javascript">
                function GetConfirmation(btn, msg) {
                    if (confirm(msg)) {
                        __doPostBack(btn.id, '');
                        return true;
                    }
                    else {
                        return false;
                    }
                }
            </script>

            <asp:Button ID="btnRemoveUser" runat="server" Text="Remove User" OnClick="btnRemoveUser_Click" 
                OnClientClick="return GetConfirmation(btnRemoveUser, 'Really remove?');"
                UseSubmitBehavior="false"
                Height="37px" Width="230px" />

</asp:Content> 
```

后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication1
{
    public partial class WebForm_WITH_MasterPage : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnRemoveUser_Click(object sender, EventArgs e)
        {
            // put a breakpoint here and see if it is hit
            int z = 0;
        }
    }
} 
```

# c# - 在 TWAIN 中是否可以强制扫描仪将区域设置为整个宽度？

> ID：13357297
> 
> 赞同：4
> 
> 时间：2012-11-13T08:05:00.190
> 
> 标签：c#, .net, twain

我正在编写一个需要在 .net 中扫描的应用程序（`c#`版本`4.0`，Visual Studio 2010）。我正在使用`TWAIN`API 进行扫描，但布局功能有问题。以下代码在 a `Microtek i800`、 a`CanoScan 9000F`和 a上运行得非常好，`Microtek Artix Scan F2`但是当我在[Epson Perfection V700](http://www.epson.com/cgi-bin/Store/jsp/Product.do?sku=B11B178011)上运行它时，会发生一些非常奇怪的事情。

即使我将布局的左边距设置为`0`图像的左边缘也会被切断。我尝试将其设置为负值，但这没有任何区别。似乎有些奇怪，它迫使它变成胶片大小（也许是因为我正在打开灯）。如果我使用扫描仪附带的工具，它允许我选择一个包括两个边缘的区域（并打开灯），所以它必须是可能的。此外，顶部和底部坐标工作得很好。

所以我的问题是...

> 有谁知道我可以让它扫描整个宽度？我可以先设置 TWAIN 中的其他设置以使其忘记其纸张尺寸吗？（我也尝试将 PaperDetectable 设置为 false，但没有任何区别）。

另一件事： *如果我不设置布局，它仍然会切断边缘的图片（只是不是顶部和底部）但如果我也没有设置灯光（或者我没有设置灯光但我做了设置大小）它符合我的预期：专门从最左边扫描整个图片（但问题是，我真的需要光线和扫描的整个宽度 - 当然这不是太多要求。 ..)。*

* * *

这是代码（它是一个带有单个按钮的 1 窗体 windows 窗体应用程序的代码）：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Imaging;
using System.Linq;
using System.Windows.Forms;

namespace TwainLayoutWindowsFormsApplication
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {            
            TwainIdentity appid = null;
            TwainIdentity scanner = null;
            bool enabled = false;

            try
            {
                appid = InitializeTwain(Handle);

                scanner = GetSource(appid, "EPSON Perfection V700/V750");

                Open(appid, scanner);

                SetLightOn(appid, scanner);

                SetLayout(appid, scanner);

                Enable(appid, scanner, Handle);
                enabled = true;

                var bmps = Scan(appid, scanner);

                Disable(appid, scanner);
                enabled = false;

                bmps.First().Save(@"c:\users\public\scan.bmp", ImageFormat.Bmp);

            }
            catch(Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
            finally
            {
                if (appid != null && scanner != null)
                {
                    if (enabled)
                    {
                        try
                        {
                            Disable(appid, scanner);
                        }
                        catch(InvalidOperationException)
                        {
                        }
                    }

                    Close(appid, scanner);
                }
            }
        }

        private static void SetLayout(TwainIdentity appid, 
                                      TwainIdentity scanner)
        {
            TwainImageLayout layout = new TwainImageLayout();

            var rc = NativeMethods.DSilayout(appid,
                                             scanner,
                                             TwainDataGroups.Image,
                                             TwainDataArgumentType.ImageLayout,
                                             TwainMessage.Get,
                                             layout);

            // 1 inch from the top and 0 from the left
            layout.Frame.Top = new TwainFix32();
            layout.Frame.Top.Whole = 1;

            layout.Frame.Left = new TwainFix32();
            layout.Frame.Left.Whole = 0;

            layout.Frame.Right = new TwainFix32();
            layout.Frame.Right.Whole = 6;

            layout.Frame.Bottom = new TwainFix32();
            layout.Frame.Bottom.Whole = 3;

            layout.FrameNumber = 1;
            layout.PageNumber = 1;
            layout.DocumentNumber = 1;

            rc = NativeMethods.DSilayout(appid,
                                         scanner,
                                         TwainDataGroups.Image,
                                         TwainDataArgumentType.ImageLayout,
                                         TwainMessage.Set,
                                         layout);
            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Failed to set layout");

            var s = new TwainStatus();

            rc = NativeMethods.DSstatus(appid,
                                        scanner,
                                        TwainDataGroups.Control,
                                        TwainDataArgumentType.Status,
                                        TwainMessage.Get, s);

            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Failed to get layout");
        }

        private IEnumerable<Bitmap> Scan(TwainIdentity appid, 
                                         TwainIdentity scanner)
        {
            var pictures = new List<Bitmap>();          

            TwainReturnCode rc;
            IntPtr hbitmap;
            var pxfr = new TwainPendingXfers();

            do
            {
                pxfr.Count = 10;
                hbitmap = IntPtr.Zero;

                var iinf = new TwainImageInfo();
                rc = NativeMethods.DSiinf(appid, 
                                          scanner, 
                                          TwainDataGroups.Image, 
                                          TwainDataArgumentType.ImageInfo, 
                                          TwainMessage.Get, 
                                          iinf);
                if (rc != TwainReturnCode.Success)
                    throw new InvalidOperationException("Could not INF");

                rc = NativeMethods.DSixfer(appid, 
                                           scanner, 
                                           TwainDataGroups.Image, 
                                           TwainDataArgumentType.ImageNativeXfer, 
                                           TwainMessage.Get, 
                                           ref hbitmap);
                if (rc != TwainReturnCode.XferDone)
                    throw new InvalidOperationException("Could DSI XFER");

                rc = NativeMethods.DSpxfer(appid, 
                                           scanner, 
                                           TwainDataGroups.Control, 
                                           TwainDataArgumentType.PendingXfers, 
                                           TwainMessage.EndXfer, 
                                           pxfr);
                if (rc != TwainReturnCode.Success)
                    throw new InvalidOperationException("Could DSP XFER");

                var bmp = TwainBitmapConvertor.ToBitmap(hbitmap);
                pictures.Add(bmp);
            }
            while (pxfr.Count != 0);

            NativeMethods.DSpxfer(appid, 
                                  scanner, 
                                  TwainDataGroups.Control, 
                                  TwainDataArgumentType.PendingXfers, 
                                  TwainMessage.StopFeeder, 
                                  pxfr);

            return pictures;
        }

        private static void Enable(TwainIdentity appid, 
                                   TwainIdentity scanner, 
                                   IntPtr hwnd)
        {
            var guif = new TwainUserInterface();
            guif.ShowUI = 0;
            guif.ModalUI = 1;
            guif.ParentHand = hwnd;

            var rc = NativeMethods.DSuserif(appid, 
                                            scanner, 
                                            TwainDataGroups.Control, 
                                            TwainDataArgumentType.UserInterface, 
                                            TwainMessage.EnableDS, 
                                            guif);
            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Could not enable");
        }

        private static void Disable(TwainIdentity appid, TwainIdentity scanner)
        {
            var guif = new TwainUserInterface();

            var rc = NativeMethods.DSuserif(appid,
                                            scanner, 
                                            TwainDataGroups.Control, 
                                            TwainDataArgumentType.UserInterface, 
                                            TwainMessage.DisableDS, 
                                            guif);

            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Could not disable");
        }        

        private static void SetLightOn(TwainIdentity appid, TwainIdentity scanner)
        {
            using (var capability = new TwainCapability(TwainCapabilityType.Lightpath, 1))
            {
                var rc = NativeMethods.DScap(appid,
                                             scanner,
                                             TwainDataGroups.Control,
                                             TwainDataArgumentType.Capability,
                                             TwainMessage.Set,
                                             capability);

                if (rc != TwainReturnCode.Success)
                    throw new InvalidOperationException("Failed to set light");
            }
        }

        private static void Close(TwainIdentity appid, TwainIdentity scanner)
        {
            NativeMethods.DSMident(appid,
                                   IntPtr.Zero,
                                   TwainDataGroups.Control,
                                   TwainDataArgumentType.Identity,
                                   TwainMessage.CloseDS,
                                   scanner);
        }

        private static void Open(TwainIdentity appid, TwainIdentity scanner)
        {
            var rc = NativeMethods.DSMident(appid, 
                                            IntPtr.Zero, 
                                            TwainDataGroups.Control, 
                                            TwainDataArgumentType.Identity, 
                                            TwainMessage.OpenDS, 
                                            scanner);

            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Failed to open");
        }

        private static TwainIdentity InitializeTwain(IntPtr hwndp)
        {
            var appid = new TwainIdentity();

            appid.Version.MajorNum = 1;
            appid.Version.MinorNum = 0;
            appid.Version.Language = 13;
            appid.Version.Country = 1;
            appid.Version.Info = "Test";

            appid.Id = IntPtr.Zero;
            appid.ProtocolMajor = 1;
            appid.ProtocolMinor = 9;
            appid.SupportedGroups = (int)(TwainDataGroups.Image | TwainDataGroups.Control);
            appid.Manufacturer = "Test Manufacturer";
            appid.ProductFamily = "Test Family";
            appid.ProductName = "Test Product";

            var rc = NativeMethods.DSMparent(appid,
                                             IntPtr.Zero,
                                             TwainDataGroups.Control,
                                             TwainDataArgumentType.Parent,
                                             TwainMessage.OpenDSM,
                                             ref hwndp);

            if (rc != TwainReturnCode.Success)
                throw new InvalidOperationException("Could Not DSMParent");

            return appid;
        }

        private static TwainIdentity GetSource(TwainIdentity appid, string name)
        {
            var device = new TwainIdentity { Id = IntPtr.Zero };

            var rc = NativeMethods.DSMentry(appid, 
                                            IntPtr.Zero, 
                                            TwainDataGroups.Control, 
                                            TwainDataArgumentType.Identity, 
                                            TwainMessage.GetFirst, 
                                            device);

            if (rc != TwainReturnCode.EndOfList && 
                device.ProductName.Equals(name, 
                                          StringComparison.OrdinalIgnoreCase))
            {
                return device;
            }

            while (rc != TwainReturnCode.EndOfList)
            {
                device = new TwainIdentity { Id = IntPtr.Zero };
                rc = NativeMethods.DSMentry(appid, 
                                            IntPtr.Zero, 
                                            TwainDataGroups.Control, 
                                            TwainDataArgumentType.Identity, 
                                            TwainMessage.GetNext, 
                                            device);

                if (rc != TwainReturnCode.EndOfList && 
                   device.ProductName.Equals(name, 
                                          StringComparison.OrdinalIgnoreCase))
                {
                    return device;
                }
            }

            throw new InvalidOperationException("Could not find device");
        }
    }
} 
```

为了完整起见，这里是我用来将 HBITMAP 转换为[System.Drawing.Bitmap](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Diagnostics;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Globalization;

namespace TwainLayoutWindowsFormsApplication
{
    internal static class TwainBitmapConvertor
    {
        [StructLayout(LayoutKind.Sequential, Pack = 2)]
        private class BitmapInfoHeader
        {
            public int Size;
            public int Width;
            public int Height;
            public short Planes;
            public short BitCount;
            public int Compression;
            public int SizeImage;
            public int XPelsPerMeter;
            public int YPelsPerMeter;
            public int ClrUsed;
            public int ClrImportant;
        }

        internal static Bitmap ToBitmap(IntPtr dibHandle)
        {
            var bitmapPointer = NativeMethods.GlobalLock(dibHandle);

            var bitmapInfo = new BitmapInfoHeader();
            Marshal.PtrToStructure(bitmapPointer, bitmapInfo);

            var rectangle = new Rectangle();
            rectangle.X = rectangle.Y = 0;
            rectangle.Width = bitmapInfo.Width;
            rectangle.Height = bitmapInfo.Height;

            if (bitmapInfo.SizeImage == 0)
            {
                bitmapInfo.SizeImage =
                    ((((bitmapInfo.Width * bitmapInfo.BitCount) + 31) & ~31) >> 3)
                    * bitmapInfo.Height;
            }

            // The following code only works on x86
            if (Marshal.SizeOf(typeof(IntPtr)) != 4)
                throw new NotSupportedException("Only x86 is supported");

            int pixelInfoPointer = bitmapInfo.ClrUsed;
            if ((pixelInfoPointer == 0) && (bitmapInfo.BitCount <= 8))
            {
                pixelInfoPointer = 1 << bitmapInfo.BitCount;
            }

            pixelInfoPointer = (pixelInfoPointer * 4) + bitmapInfo.Size
                + bitmapPointer.ToInt32();

            IntPtr pixelInfoIntPointer = new IntPtr(pixelInfoPointer);

            var bitmap = new Bitmap(rectangle.Width, rectangle.Height);

            using (Graphics graphics = Graphics.FromImage(bitmap))
            {
                IntPtr hdc = graphics.GetHdc();

                try
                {
                    NativeMethods.SetDIBitsToDevice(hdc,
                        0, 0, rectangle.Width, rectangle.Height, 0, 0, 0,
                        rectangle.Height, pixelInfoIntPointer, bitmapPointer, 0);
                }
                finally
                {
                    graphics.ReleaseHdc(hdc);
                }
            }

            bitmap.SetResolution(PpmToDpi(bitmapInfo.XPelsPerMeter),
                PpmToDpi(bitmapInfo.YPelsPerMeter));

            NativeMethods.GlobalUnlock(dibHandle);
            NativeMethods.GlobalFree(dibHandle);

            return bitmap;
        }

        private static float PpmToDpi(double pixelsPerMeter)
        {
            double pixelsPerMillimeter = (double)pixelsPerMeter / 1000.0;
            double dotsPerInch = pixelsPerMillimeter * 25.4;
            return (float)Math.Round(dotsPerInch, 2);
        }
    }
} 
```

这里是 p/invokes：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace TwainLayoutWindowsFormsApplication
{
    internal static class NativeMethods
    {

        [DllImport("kernel32.dll", ExactSpelling = true)]
        internal static extern IntPtr GlobalAlloc(int flags, int size);

        [DllImport("kernel32.dll", ExactSpelling = true)]
        internal static extern IntPtr GlobalLock(IntPtr handle);

        [DllImport("kernel32.dll", ExactSpelling = true)]
        internal static extern bool GlobalUnlock(IntPtr handle);

        [DllImport("kernel32.dll", ExactSpelling = true)]
        internal static extern IntPtr GlobalFree(IntPtr handle);

        [DllImport("gdi32.dll", ExactSpelling = true)]
        public static extern int SetDIBitsToDevice(IntPtr hdc, int xdst, int ydst, int width, int height,
            int xsrc, int ysrc, int start, int lines, IntPtr bitsptr, IntPtr bmiptr, int color);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMparent([In, Out] TwainIdentity origin, IntPtr zeroptr, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, ref IntPtr refptr);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMident([In, Out] TwainIdentity origin, IntPtr zeroptr, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainIdentity idds);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMentry([In, Out] TwainIdentity origin, IntPtr zeroptr, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainIdentity idds);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMstatus([In, Out] TwainIdentity origin, IntPtr zeroptr, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainStatus dsmstat);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSuserif([In, Out] TwainIdentity origin, [In, Out] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, TwainUserInterface guif);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSevent([In, Out] TwainIdentity origin, [In, Out] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, ref TwainEvent evt);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSstatus([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainStatus dsmstat);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DScap([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainCapability capa);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSiinf([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainImageInfo imginf);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSixfer([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, ref IntPtr hbitmap);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMemixfer([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainImageMemXfer memxfr);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSpxfer([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainPendingXfers pxfr);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSilayout([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainImageLayout layout);

        [DllImport("twain_32.dll", EntryPoint = "#1")]
        internal static extern TwainReturnCode DSMEntry([In, Out] TwainIdentity origin, [In] TwainIdentity dest, TwainDataGroups dg, TwainDataArgumentType dat, TwainMessage msg, [In, Out] TwainSetupFileXfer fileXf);
    }
} 
```

最后，需要工作的其他东西（结构和诸如此类）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace TwainLayoutWindowsFormsApplication
{
    [StructLayout(LayoutKind.Sequential, Pack = 2, CharSet = CharSet.Ansi)]
    internal class TwainIdentity
    {                                   
        public IntPtr Id;
        public TwainVersion Version;
        public short ProtocolMajor;
        public short ProtocolMinor;
        public int SupportedGroups;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 34)]
        public string Manufacturer;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 34)]
        public string ProductFamily;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 34)]
        public string ProductName;
    }

    internal enum TwainReturnCode : short
    {                                   
        Success = 0x0000,
        Failure = 0x0001,
        CheckStatus = 0x0002,
        Cancel = 0x0003,
        DSEvent = 0x0004,
        NotDSEvent = 0x0005,
        XferDone = 0x0006,
        EndOfList = 0x0007,
        InfoNotSupported = 0x0008,
        DataNotAvailable = 0x0009
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2, CharSet = CharSet.Ansi)]
    internal struct TwainVersion
    {                                   
        public short MajorNum;
        public short MinorNum;
        public short Language;
        public short Country;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 34)]
        public string Info;
    }

    [Flags]
    internal enum TwainDataGroups : short
    {
        Control = 0x0001,
        Image = 0x0002,
        Audio = 0x0004
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal struct TwainEvent
    {                                   
        public IntPtr EventPtr;
        public short Message;
    }

    internal enum TwainDataArgumentType : short
    {                                   
        Null = 0x0000,
        Capability = 0x0001,
        Event = 0x0002,
        Identity = 0x0003,
        Parent = 0x0004,
        PendingXfers = 0x0005,
        SetupMemXfer = 0x0006,
        SetupFileXfer = 0x0007,
        Status = 0x0008,
        UserInterface = 0x0009,
        XferGroup = 0x000a,
        TwunkIdentity = 0x000b,
        CustomDSData = 0x000c,
        DeviceEvent = 0x000d,
        FileSystem = 0x000e,
        PassThru = 0x000f,

        ImageInfo = 0x0101,
        ImageLayout = 0x0102,
        ImageMemXfer = 0x0103,
        ImageNativeXfer = 0x0104,
        ImageFileXfer = 0x0105,
        CieColor = 0x0106,
        GrayResponse = 0x0107,
        RGBResponse = 0x0108,
        JpegCompression = 0x0109,
        Palette8 = 0x010a,
        ExtImageInfo = 0x010b,

        SetupFileXfer2 = 0x0301
    }

    internal enum TwainMessage : short
    {                                   
        Null = 0x0000,
        Get = 0x0001,
        GetCurrent = 0x0002,
        GetDefault = 0x0003,
        GetFirst = 0x0004,
        GetNext = 0x0005,
        Set = 0x0006,
        Reset = 0x0007,
        QuerySupport = 0x0008,

        XFerReady = 0x0101,
        CloseDSReq = 0x0102,
        CloseDSOK = 0x0103,
        DeviceEvent = 0x0104,

        CheckStatus = 0x0201,

        OpenDSM = 0x0301,
        CloseDSM = 0x0302,

        OpenDS = 0x0401,
        CloseDS = 0x0402,
        UserSelect = 0x0403,

        DisableDS = 0x0501,
        EnableDS = 0x0502,
        EnableDSUIOnly = 0x0503,

        ProcessEvent = 0x0601,

        EndXfer = 0x0701,
        StopFeeder = 0x0702,

        ChangeDirectory = 0x0801,
        CreateDirectory = 0x0802,
        Delete = 0x0803,
        FormatMedia = 0x0804,
        GetClose = 0x0805,
        GetFirstFile = 0x0806,
        GetInfo = 0x0807,
        GetNextFile = 0x0808,
        Rename = 0x0809,
        Copy = 0x080A,
        AutoCaptureDir = 0x080B,

        PassThru = 0x0901
    }

    [StructLayout(LayoutKind.Sequential, Pack = 4)]
    internal struct TwainWindowMessage
    {
        public IntPtr hwnd;
        public int message;
        public IntPtr wParam;
        public IntPtr lParam;
        public int time;
        public int x;
        public int y;
    }

    internal enum TwainOn : short
    {                               
        Array = 0x0003,
        Enum = 0x0004,
        One = 0x0005,
        Range = 0x0006,
        DontCare = -1
    }

    internal enum TwainCapabilityType : short
    {
        XferCount = 0x0001,

        ICompression = 0x0100,
        IPixelType = 0x0101,
        IUnits = 0x0102,
        IXferMech = 0x0103,

        Author = 0x1000,
        Caption = 0x1001,
        FeederEnabled = 0x1002,
        FeederLoaded = 0x1003,
        Timedate = 0x1004,
        SupportedCapabilities = 0x1005,
        Extendedcaps = 0x1006,
        AutoFeed = 0x1007,
        ClearPage = 0x1008,
        FeedPage = 0x1009,
        RewindPage = 0x100a,

        Indicators = 0x100b,
        SupportedCapsExt = 0x100c,
        PaperDetectable = 0x100d,
        UIControllable = 0x100e,
        DeviceOnline = 0x100f,
        AutoScan = 0x1010,
        ThumbnailsEnabled = 0x1011,
        Duplex = 0x1012,
        DuplexEnabled = 0x1013,
        Enabledsuionly = 0x1014,
        CustomdsData = 0x1015,
        Endorser = 0x1016,
        JobControl = 0x1017,
        Alarms = 0x1018,
        AlarmVolume = 0x1019,
        AutomaticCapture = 0x101a,
        TimeBeforeFirstCapture = 0x101b,
        TimeBetweenCaptures = 0x101c,
        ClearBuffers = 0x101d,
        MaxBatchBuffers = 0x101e,
        DeviceTimeDate = 0x101f,
        PowerSupply = 0x1020,
        CameraPreviewUI = 0x1021,
        DeviceEvent = 0x1022,
        SerialNumber = 0x1024,
        Printer = 0x1026,
        PrinterEnabled = 0x1027,
        PrinterIndex = 0x1028,
        PrinterMode = 0x1029,
        PrinterString = 0x102a,
        PrinterSuffix = 0x102b,
        Language = 0x102c,
        FeederAlignment = 0x102d,
        FeederOrder = 0x102e,
        ReAcquireAllowed = 0x1030,
        BatteryMinutes = 0x1032,
        BatteryPercentage = 0x1033,
        CameraSide = 0x1034,
        Segmented = 0x1035,
        CameraEnabled = 0x1036,
        CameraOrder = 0x1037,
        MicrEnabled = 0x1038,
        FeederPrep = 0x1039,
        Feederpocket = 0x103a,

        Autobright = 0x1100,
        Brightness = 0x1101,
        Contrast = 0x1103,
        CustHalftone = 0x1104,
        ExposureTime = 0x1105,
        Filter = 0x1106,
        Flashused = 0x1107,
        Gamma = 0x1108,
        Halftones = 0x1109,
        Highlight = 0x110a,
        ImageFileFormat = 0x110c,
        LampState = 0x110d,
        LightSource = 0x110e,
        Orientation = 0x1110,
        PhysicalWidth = 0x1111,
        PhysicalHeight = 0x1112,
        Shadow = 0x1113,
        Frames = 0x1114,
        XNativeResolution = 0x1116,
        YNativeResolution = 0x1117,
        XResolution = 0x1118,
        YResolution = 0x1119,
        MaxFrames = 0x111a,

        Tiles = 0x111b,
        Bitorder = 0x111c,
        Ccittkfactor = 0x111d,
        Lightpath = 0x111e,
        Pixelflavor = 0x111f,
        Planarchunky = 0x1120,
        Rotation = 0x1121,
        Supportedsizes = 0x1122,
        Threshold = 0x1123,
        Xscaling = 0x1124,
        Yscaling = 0x1125,
        Bitordercodes = 0x1126,
        Pixelflavorcodes = 0x1127,
        Jpegpixeltype = 0x1128,
        Timefill = 0x112a,
        BitDepth = 0x112b,
        Bitdepthreduction = 0x112c,
        Undefinedimagesize = 0x112d,
        Imagedataset = 0x112e,
        Extimageinfo = 0x112f,
        Minimumheight = 0x1130,
        Minimumwidth = 0x1131,
        Fliprotation = 0x1136,
        Barcodedetectionenabled = 0x1137,
        Supportedbarcodetypes = 0x1138,
        Barcodemaxsearchpriorities = 0x1139,
        Barcodesearchpriorities = 0x113a,
        Barcodesearchmode = 0x113b,
        Barcodemaxretries = 0x113c,
        Barcodetimeout = 0x113d,
        Zoomfactor = 0x113e,
        Patchcodedetectionenabled = 0x113f,
        Supportedpatchcodetypes = 0x1140,
        Patchcodemaxsearchpriorities = 0x1141,
        Patchcodesearchpriorities = 0x1142,
        Patchcodesearchmode = 0x1143,
        Patchcodemaxretries = 0x1144,
        Patchcodetimeout = 0x1145,
        Flashused2 = 0x1146,
        Imagefilter = 0x1147,
        Noisefilter = 0x1148,
        Overscan = 0x1149,
        Automaticborderdetection = 0x1150,
        Automaticdeskew = 0x1151,
        Automaticrotate = 0x1152,
        Jpegquality = 0x1153,
        Feedertype = 0x1154,
        Iccprofile = 0x1155,
        Autosize = 0x1156,
        AutomaticCropUsesFrame = 0x1157,            
        AutomaticLengthDetection = 0x1158,          
        AutomaticColorEnabled = 0x1159,             
        AutomaticColorNonColorPixelType = 0x115a,   
        ColorManagementEnabled = 0x115b,            
        ImageMerge = 0x115c,                        
        ImageMergeHeightThreshold = 0x115d,       
        SupoortedExtImageInfo = 0x115e,             
        Audiofileformat = 0x1201,
        Xfermech = 0x1202
    }

    internal enum TwainType : short
    {                                   
        Int8 = 0x0000,
        Int16 = 0x0001,
        Int32 = 0x0002,
        UInt8 = 0x0003,
        UInt16 = 0x0004,
        UInt32 = 0x0005,
        Bool = 0x0006,
        Fix32 = 0x0007,
        Frame = 0x0008,
        Str32 = 0x0009,
        Str64 = 0x000a,
        Str128 = 0x000b,
        Str255 = 0x000c,
        Str1024 = 0x000d,
        Str512 = 0x000e
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainStatus
    {                                   
        public short ConditionCode;     
        public short Reserved;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainUserInterface
    {                                   
        public short ShowUI;            
        public short ModalUI;
        public IntPtr ParentHand;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainImageInfo
    {                                   
        public int XResolution;
        public int YResolution;
        public int ImageWidth;
        public int ImageLength;
        public short SamplesPerPixel;
        [MarshalAs(UnmanagedType.ByValArray, SizeConst = 8)]
        public short[] BitsPerSample;
        public short BitsPerPixel;
        public short Planar;
        public short PixelType;
        public short Compression;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwMemory
    {
        public uint Flags;
        public uint Length;
        IntPtr TheMem;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainImageMemXfer
    {
        public ushort Compression;
        public uint BytesPerRow;
        public uint Columns;
        public uint Rows;
        public uint XOffset;
        public uint YOffset;
        public uint BytesWritten;
        [MarshalAs(UnmanagedType.Struct)]
        TwMemory Memory;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal struct TwainFix32
    {                                               
        public short Whole;
        public ushort Frac;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainFrame
    {
        public TwainFix32 Left;
        public TwainFix32 Top;
        public TwainFix32 Right;
        public TwainFix32 Bottom;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainImageLayout
    {
        public TwainFrame Frame;
        public int DocumentNumber;
        public int PageNumber;
        public int FrameNumber;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainPendingXfers
    {                                   
        public short Count;
        public int EOJ;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainSetupFileXfer
    {
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 255)]
        public string FileName;
        public ushort Format;
        public short VRefNum;
    }

    [StructLayout(LayoutKind.Sequential, Pack = 2)]
    internal class TwainCapability : IDisposable
    {                                   

        internal TwainCapability(TwainCapabilityType cap)
        {
            Cap = (short)cap;
            ConType = -1;
        }

        internal TwainCapability(TwainCapabilityType cap, short sval)
        {
            Cap = (short)cap;
            ConType = (short)TwainOn.One;
            Handle = NativeMethods.GlobalAlloc(0x42, 6);
            IntPtr pv = NativeMethods.GlobalLock(Handle);
            Marshal.WriteInt16(pv, 0, (short)TwainType.Int16);
            Marshal.WriteInt32(pv, 2, (int)sval);
            NativeMethods.GlobalUnlock(Handle);
        }

        ~TwainCapability()
        {

            Dispose(false);
        }

        public short Cap;

        public short ConType;

        public IntPtr Handle;

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (Handle != IntPtr.Zero)
                NativeMethods.GlobalFree(Handle);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:11:36.077

所以，万一有人感兴趣，我最终完全放弃了[TWAIN——](http://twain.org/)我认为这根本不可能。

我所做的是安装：

*   [Cygwin](http://www.cygwin.com/)（基本安装加和`gcc-core`包）`make``libusb-win32`
*   [libusb-win32](http://sourceforge.net/apps/trac/libusb-win32/wiki)
*   [理智](http://www.sane-project.org/)的。

经过一大堆配置、制作和安装后，我终于能够从[Cygwin](http://www.cygwin.com/)提示符下发出这个命令：

```
scanimage -t 30 -y 30 --mode Color --depth 8 --resolution 1200 --sharpness 2 --format=tiff --source TPU8x10 > out.tiff 
```

你会相信它`out.tiff`宽而锐利，而且比我用[TWAIN](http://twain.org/)所能达到的要好得多。

所以，我知道这是一个可怕的问题，但我没有一大堆选择（它必须是一个 Windows，在连接了扫描仪的机器上运行的胖客户端应用程序），所以我只是启动这个：

```
c:\cygwin\bin\bash.exe --login -c "scanimage -t 30 -y 30 --mode Color --depth 8 --resolution 1200 --sharpness 2 --format=tiff --source TPU8x10 > ~/out.tiff" 
```

通过 .NET 应用程序中的[进程](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)，当它返回时，我将文件加载[到位图](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)中并继续进行，就好像没有发生任何奇怪的事情一样（意味着应用程序现在有一大堆额外的先决条件和繁琐的配置步骤，但是，好吧，嗯，起诉我）。

# forms - 我可以以编程方式触发淘汰视图模型更新吗？

> ID：13357299
> 
> 赞同：0
> 
> 时间：2012-11-13T08:05:13.177
> 
> 标签：forms, binding, knockout.js

我编写了一个带有各种值绑定的表单和一个淘汰视图模型。表单由 AJAX 帖子提交（由表单按钮上的单击绑定触发）。我注意到当我在文本字段中进行更改时，模型在发布之前没有正确更新，将光标留在其中并直接单击提交按钮。

我知道值绑定的“afterkeydown”选项，但我不想使用它，因为它也会触发我在每次按键时的验证。有没有办法在我的 ajax 提交函数中以编程方式强制模型更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:18:39.403

尝试使用提交绑定而不是单击：

```
<form data-bind="submit: doSomething">
    ... form contents go here ...
    <button type="submit">Submit</button>
</div>

<script type="text/javascript">
    var viewModel = {
        doSomething : function(formElement) {
            // ... now do something 
        }
    };
</script> 
```

提交的文档页面：http: [//knockoutjs.com/documentation/submit-binding.html](http://knockoutjs.com/documentation/submit-binding.html)

# java - 如何在期望称为协方差的超类型的方法中返回子类型？

> ID：13357304
> 
> 赞同：2
> 
> 时间：2012-11-13T08:05:56.933
> 
> 标签：java, covariance

维基百科定义`covariance`为

> 从较宽的（动物）转换为较窄的（猫）。

但是在类似的语言中`Java`，返回类型协方差被定义为将子类型分配给超类型，例如：

```
public Animal getAnimal(){
   return new Cat();
} 
```

在这里，我们将子类型分配给超类型，但根据`Wikipedia`定义，协方差将超类型分配给子类型。我怎样才能调和两者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:27:24.313

您对协变返回类型的含义有误解。

它仅在您覆盖方法时才相关，它不涉及返回语句中使用的类型或调用者对方法的期望。协变返回类型意味着您可以覆盖子类型中的方法并在覆盖期间更改返回类型（使其返回类型比超类型中的方法更窄）。

例子：

```
public class SuperType {
  public Animal getAnimal() { ... }
}

public class SubType extends SuperType {
  public Cat getAnimal() { ... }
} 
```

这里与维基百科的定义相匹配。

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/index.html)在第[8.4.8.3 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.3)中确认了这一点（参见[示例 8.4.8.3-1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.3)）。

请注意，对于方法参数，Java 需要逆变类型。如果采用in`getAnimal`类型的参数，则该类不能将此参数缩小到，但可以将其扩大到 (eg) 。`Animal``SuperType``SubType``Cat``Object`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:03:01.580

通用术语“协变”意味着可以沿轴变化的两个实体，并且它指出这些实体是相关的，因此当一个生成*zig*时，另一个也生成*zig*。相反，“逆变”意味着当一个人做*zig*时，另一个人做*zag*。

具体来说，在类型理论中，如果当我们缩小一种类型时，另一种类型也被缩小，则两种类型是协变的。

将此应用于 Java 返回类型，当我们从一个类到其子类时，方法的返回类型可以以相同的方式进行：从类到子类。

将此与对方法参数有意义的情况进行对比：从类到子类，参数类型可能从类到*超类*。Java 中不存在此功能，但如果存在，这将是它的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:09:27.053

正如您所说，维基百科协方差的定义与 Java 函数所做的相同。该函数返回一个动物，但在这种情况下，它将其范围缩小为一只猫（因此变化更多）。

您可能在“根据维基百科的定义，协方差将超类型分配给子类型”时出错了。因为这与从更宽（动物）转换为更窄（猫）不同，但恰恰相反。

```
//This is covariance, as you go from wider, to narrower
Animal someAnimal = new Animal();
someAnimal = getAnimal(); //now someAnimal is a cat, as by your code example. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:36:29.393

您也许应该尝试通过以下方式查看它：

方法是说：“我给你一只动物”，如果它后来给你一只猫，它就没有撒谎。它从较宽的类型变为较窄的类型。

# ruby-on-rails-3 - 显式获取路线引发错误

> ID：13357307
> 
> 赞同：0
> 
> 时间：2012-11-13T08:06:15.527
> 
> 标签：ruby-on-rails-3, routing, rails-routing, named-routing

我定义了一个自定义路线：

`match 'folio/:id' => 'posts#show', :as => :folio, :via => :get`

当我运行`rake routes`命令时，我有：

```
post  GET    /posts/:id(.:format)     posts#show
folio GET    /folio/:id(.:format)     posts#show 
```

我把这个元素的链接放在我的另一个页面中：`link_to post.title, folio_path`，但是当我进入它时，我会抛出一个路由错误：

`No route matches {:controller=>"post", :action=>"show"}`

为什么会失败？当我`post#show`以正常方式使用它时，它就像一个魅力，但我的自定义路线失败了 - 请帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:11:56.280

您需要指定柱子，以便导轨可以填充该`id`部分：

```
link_to post.title, folio_path(post) 
```

# tsql - SELECT 语句中没有 TOP xxx 的 TSQL 游标无限循环

> ID：13357308
> 
> 赞同：1
> 
> 时间：2012-11-13T08:06:21.803
> 
> 标签：tsql, cursor

我对 TSQL 游标中的无限循环有一个奇怪的问题。当我没有将 TOP 300 添加到游标的定义选择语句时，游标会无限循环。以下是代码示例：非常感谢对此问题的任何帮助。

```
DECLARE @Done BIT
SET @Done = 0

DECLARE cursOut CURSOR LOCAL FAST_FORWARD
FOR
SELECT
    --TOP 300
    FirstName FirstName
    ,LastName LastName
    ,MiddleName MiddleName
    ,Email Email
    ,Address1 Address1
    ,Address2 Address2
    ,City City
    ,[State] [State]
       FROM StagedUsers

OPEN cursOut;

WHILE (@Done = 0)
   BEGIN       
 --Fetch next row
    FETCH NEXT
    FROM cursOut
    INTO ,@v_FirstName
        ,@v_LastName
        ,@v_MiddleName
        ,@v_Email
        ,@v_Address1
        ,@v_Address2
        ,@v_City
        ,@v_State

    IF (@@FETCH_STATUS <> 0)
    BEGIN
        SET @Done = 1
        BREAK
    END

    --if @batch = 0
    BEGIN TRANSACTION

    --process statements
    --updates or insert statements

    --Commit transaction    
    COMMIT TRANSACTION

--End While             
    END 

--CleanUp:
CLOSE cursOut
DEALLOCATE cursOut 
```

谢谢， 雷内格林

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-07T22:19:24.230

首先我认为你在这里不需要事务，我假设它只执行了一个语句，所以从代码中删除事务。

其次在没有@done 标志的情况下这样做，这很令人困惑（这里可能不是问题）。

```
DECLARE @v_FirstName VARCHAR(500),@v_LastName VARCHAR(500),@v_MiddleName VARCHAR(500),@v_Email VARCHAR(500),@v_Address1 VARCHAR(500),@v_Address2 VARCHAR(500),@v_City VARCHAR(500),@v_State VARCHAR(500)

DECLARE cursOut CURSOR FAST_FORWARD FOR
SELECT FirstName FirstName,LastName LastName,MiddleName MiddleName,Email Email,Address1 Address1,Address2 Address2,City City,[State] [State]
FROM StagedUsers

OPEN cursOut;

FETCH NEXT FROM cursOut INTO @v_FirstName,@v_LastName,@v_MiddleName,@v_Email,@v_Address1,@v_Address2,@v_City,@v_State

declare @i int = 1

WHILE @@FETCH_STATUS = 0
BEGIN       
print cast(@i as varchar(10))

--> statement here

FETCH NEXT FROM cursOut INTO @v_FirstName,@v_LastName,@v_MiddleName,@v_Email,@v_Address1,@v_Address2,@v_City,@v_State

set @i = @i + 1     
END 

CLOSE cursOut
DEALLOCATE cursOut 
```

你想更新光标指向的当前行吗？如果是这样，有办法做到这一点。

表上有索引吗？您可以发布更新查询吗？

# ios - 使iOS App验证失败的确定方法？

> ID：13357309
> 
> 赞同：3
> 
> 时间：2012-11-13T08:06:29.937
> 
> 标签：ios, appstore-approval

对不起，如果有一个明显的答案，但我没有找到任何东西。

有没有一种已知的方法可以肯定地使 App Store 验证过程（上传应用程序时的验证过程）失败但仍适用于 Ad-Hoc-Distributions？在代码中，而不是 info.plist 配置或其他内容。我尝试了诸如“[UIApplication addStatusBarImageNamed:....]”之类的私有 API，但它们似乎只在实际审查期间进行检查，这不是我想要的。

我对我的构建配置有点偏执（并且使用错误的配置进行实时提交）并希望在其中有一个“断言”样式失败选项，以确保我不会上传使用错误配置创建的构建.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:52:42.983

您可以为“错误”的构建配置使用不同的（开发人员）代码签名身份。这将使上传过程失败。

或者，也许您可​​以使用 iOS 要求/支持的架构的“无效”组合。例如仅支持 armv7 但最低要求 iOS 3.0 - 应该能够编译，但不能在设备上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T10:52:48.327

添加一个权利文件，该文件使用特定应用程序的代码签名身份进行签名。只需添加它，通常它不会构建。

# windows-runtime - 在 WinRT 中创建只读依赖属性的最佳方法是什么？

> ID：13357310
> 
> 赞同：6
> 
> 时间：2012-11-13T08:06:44.903
> 
> 标签：windows-runtime, dependency-properties

WinRT 中似乎没有等效的 RegisterReadOnly。

有没有好的解决方法？

WinRT 中的控件如何实现诸如 ActualWidthProperty 之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:40:30.613

在实现依赖属性时，通常使用元数据定义静态属性类型，然后使用 getter 和 setter 创建可访问属性，因此如果要创建只读属性，只需使用 getter 创建可见属性。

# c - Arduino伺服结构“没有命名类型”

> ID：13357312
> 
> 赞同：2
> 
> 时间：2012-11-13T08:06:48.553
> 
> 标签：c, memory-management, struct, arduino

我正在尝试运行一个使用包含伺服对象的结构的 arduino 程序，它给了我这个错误：

```
error: 'leg' does not name a type 
```

我认为我在内存管理方面做错了，但我对此很陌生，因此感谢您的帮助。

这是我的代码：

```
#include <Servo.h> 

typedef struct{
 Servo hip;
 Servo shin;
 Servo foot;
}leg;

int currentPin = 0; //this is the pin that the leg will be attached to

leg getLeg(void){
  leg newLeg;
  newLeg.hip.attach(currentPin++);
  newLeg.shin.attach(currentPin++);
  newLeg.foot.attach(currentPin++);

  return newLeg;  

}

void setup() 
{ 
  leg frontLeft = getLeg();
  leg frontRight = getLeg();
  leg backRight = getLeg();
  leg backLeft = getLeg();
} 

void loop() 
{ 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:22:26.623

试试这个

```
struct legtype {
    Servo hip;
    Servo shin;
    Servo foot;
};

typedef legtype leg; 
```

那样有用吗？

干杯，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-20T00:02:59.723

在头文件中定义结构为我解决了这个问题。在arduino中创建一个名为：“ `whatever.h`”的新选项卡，在whatever.h中定义结构，在主文件中包含whatever.h。

# c# - Facebook C# SDK + 活动参加

> ID：13357314
> 
> 赞同：0
> 
> 时间：2012-11-13T08:06:54.760
> 
> 标签：c#, facebook

我正在尝试通过这样的 FB api 加入一个活动，但它给了我一个错误：

```
Parameter count mismatch. 
```

击中线后：

```
JsonObject result = facebookClient.Post("/" + eventid + "/attending") as JsonObject; 
```

我已检查访问令牌和事件 ID 是否到位。有人可以帮忙吗。谢谢。

```
if (Session["FBAcctoken_Event"] != null)
            {
                var accessTok = Session["FBAcctoken_Event"].ToString();
                var eventid = hdnEventId.Value;
                eventid = eventid.Substring(11, eventid.Length - 11);
                FacebookClient facebookClient = new FacebookClient(accessTok);

                JsonObject result = facebookClient.Post("/" + eventid + "/attending") as JsonObject;

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T05:59:11.180

这应该工作 -

```
Dictionary<string,object> fbParams = new Dictionary<string,object>();
fbParams[access_token] = accessTok;         
JsonObject result = facebookClient.Post("/" + eventid + "/attending", fbParams) as JsonObject; 
```

# php - 如何通过php发送电子邮件

> ID：13357319
> 
> 赞同：-3
> 
> 时间：2012-11-13T08:07:41.297
> 
> 标签：php, sendmail, status

如何使用 php 发送电子邮件是一个非常困难的问题。当我使用函数 mail() 发送电子邮件时，无法正确获取发送电子邮件的状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:16:25.687

我建议使用 Zend Framework 邮件发送选项。它比标准的 PHP mail() 函数给你更多的灵活性。

更多信息可以在这里找到：

[http://framework.zend.com/manual/1.12/en/zend.mail.html](http://framework.zend.com/manual/1.12/en/zend.mail.html)

# javascript - 本地存储查看每个域使用了多少空间

> ID：13357327
> 
> 赞同：0
> 
> 时间：2012-11-13T08:08:42.357
> 
> 标签：javascript, html, local-storage

在通过 HTML5 存储规范后：http: [//www.whatwg.org/specs/web-apps/current-work/multipage/webstorage.html#event-storage](http://www.whatwg.org/specs/web-apps/current-work/multipage/webstorage.html#event-storage)

在第**11.3 节磁盘空间**中，我已阅读

> 用户代理应该允许用户查看每个域使用了多少空间。

但是没有关于我如何做到这一点的信息。

我想出的唯一解决方案是这样的 hack：

```
JSON.stringify(localStorage).length 
```

有没有一种正常的方法可以做到这一点，因为在我的情况下，您只能看到一个域，而不是每个域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:43:15.537

没有人给出任何回应，我将用我能找到的任何信息添加我自己的答案。

`JSON.stringify(localStorage).length`近似数字适用于每个浏览器

**IE：** 可以通过JS使用：`window.localStorage.remainingSpace`

**Chrome：** 通过*设置>内容设置>Cookies & Site data*

# ios - PayPal fetchDeviceReferenceTokenWithAppID 返回空

> ID：13357328
> 
> 赞同：2
> 
> 时间：2012-11-13T08:09:11.700
> 
> 标签：ios, paypal

要集成 PayPal MECL，我执行了以下步骤。

1.  添加了库。我在项目中添加了 MECL 库（libPayPalEC.a、PayPal.h）、libxml2.dylib。
2.  实现了 DeviceReferenceTokenDelegate 并添加了委托方法。
3.  通过点击按钮调用以下方法。

    [[PayPal getPayPalInst] fetchDeviceReferenceTokenWithAppID:@"APP-80W284485P519543T" forEnvironment:ENV_SANDBOX withDelegate:self];

4.  然后由委托'receivedDeviceReferenceToken:'调用方法

问题出在第 4 步。收到的令牌始终为空。

我只是按照手册进行操作，仅此而已。

我有什么问题吗？

# delphi - TIdTCPServer.OnExecute in a console application

> ID：13357329
> 
> 赞同：1
> 
> 时间：2012-11-13T08:09:12.447
> 
> 标签：delphi, delphi-2009

I need to write a Delphi 2009 application, which reads data from a socket. To do this, I need to write an event handler for the `TIdTCPServer.OnExecute` event.

I found lots of examples for implementing this in GUI applications, but I need to do it in a **console** application (without any windows).

How should I modify the code below in order to add an event handler (attach it to `TCPServer`), which prints every received message into the debug output?

```
unit ReceivingThreadUnit;

interface

uses
  Classes,
  IdTCPServer,
  IdSocketHandle,

  SysUtils,
  Windows;

type
  ReceivingThread = class(TThread)
    private
      TCPServer: TIdTCPServer;
    public
      procedure Run();

  end;

implementation

procedure ReceivingThread.Run();
var
  Bindings: TIdSocketHandles;
begin
  TCPServer := TIdTCPServer.Create(nil);

  //setup and start TCPServer
  Bindings := TIdSocketHandles.Create(TCPServer);
  try
    with Bindings.Add do
    begin
      IP := '127.0.0.1';
      Port := 9998;
    end;
    try
      TCPServer.Bindings:=Bindings;
      // Here I want to attach TCPServer to an OnExecute event handler
      TCPServer.Active:=True;
    except on E:Exception do
      OutputDebugString(PChar(E.ToString));
    end;
  finally
    Bindings.Free;
    TCPServer.Free;
  end;
  TCPServer.Active := true;
end;

end. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T20:35:20.190

As David said (but did not fully show), you need to declare a method in your thread class and then assign it to the `OnExecute` event.

On a side note, you should not be creating a `TIdSocketHandles` collection manually. Call `Add()` on the existing `TIdTCPServer.Bindings` collection instead.

Try this:

```
unit ReceivingThreadUnit;

interface

uses
  Classes,
  IdTCPServer,
  IdSocketHandle,
  IdContext,

  SysUtils,
  Windows;

type
  ReceivingThread = class(TThread)
  private
    TCPServer: TIdTCPServer;
    procedure ExecuteHandler(AContext: TIdContext);
  public
    procedure Run;
  end;

implementation

procedure ReceivingThread.ExecuteHandler(AContext: TIdContext);
begin
  //...
end;

procedure ReceivingThread.Run;
begin
  //setup and start TCPServer
  TCPServer := TIdTCPServer.Create(nil);
  try
    with TCPServer.Bindings.Add do
    begin
      IP := '127.0.0.1';
      Port := 9998;
    end;
    TCPServer.OnExecute := ExecuteHandler;
    try
      TCPServer.Active := True;
    except
      on E: Exception do
        OutputDebugString(PChar(E.ToString));
    end;
    while not Terminated do
      Sleep(1000);
    TCPServer.Active := False;
  finally
    TCPServer.Free;
  end;
end;

end. 
```

With that said, your receiveing thread is actually pretty redundant since `TIdTCPServer` is already multi-threaded, so you could alternatively just eliminate the thread class altogether:

```
program MyApp;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  Classes,
  IdTCPServer,
  IdSocketHandle,
  IdContext,

  SysUtils,
  Windows;

type
  TCPServerEvents = class
  public
    class procedure ExecuteHandler(AContext: TIdContext);
  end;

class procedure TCPServerEvents.ExecuteHandler(AContext: TIdContext);
begin
  //...
end;

var
  TCPServer: TIdTCPServer;
begin
  //setup and start TCPServer
  TCPServer := TIdTCPServer.Create(nil);
  try
    with TCPServer.Bindings.Add do
    begin
      IP := '127.0.0.1';
      Port := 9998;
    end;

    TCPServer.OnExecute := TCPServerEvents.ExecuteHandler;

    try
      TCPServer.Active := True;
    except
      on E: Exception do
        OutputDebugString(PChar(E.ToString));
    end;

    while (not stop condition) do
      Sleep(1000);

    TCPServer.Active := False;
  finally
    TCPServer.Free;
  end;
end. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:48:14.257

You need to add an event handler to your class. And then connect it up:

```
TCPServer.OnExecute := Self.ExecuteHandler; 
```

# php - 根据移动或桌面 css 更改导航 url

> ID：13357333
> 
> 赞同：0
> 
> 时间：2012-11-13T08:09:25.333
> 
> 标签：php, jquery, css, url, linker

当我的网站使用移动 CSS 时，导航会变得很长，以至于除非向下滚动，否则用户看不到内容。

然后我想更改导航 urs 以链接到 div，这样它就可以直接跳转到内容

示例：

当@media only screen and (min-width: 480px) 正在使用时，导航链接具有 url

site1.php#内容

site2.php#内容

site3.php#内容

当@media only screen and (min-width: 992px) 正在使用时

站点1.php

站点2.php

站点3.php

我该怎么做？PHP 和 jQuery 吗？

我看了这段代码：

```
$("a[href^='http://stackoverflow.com']")
   .each(function()
   { 
      this.href = this.href.replace(/^http:\/\/beta\.stackoverflow\.com/, 
         "http://stackoverflow.com");
   }); 
```

是否有可能以某种方式修改它，以便在我的情况下工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:19:06.603

如果您正在设置您希望页面滚动到的元素的名称，我们可以做到。

```
$(function(){
    var hash = (window.location.hash) ? window.location.hash : null;
    if(null !== hash){
        //now I don't know how the markup is designed, so we'll just use `id`
        $(window).scrollTop($('[id='+hash+']').scrollTop());
    }
}); 
```

在页面加载时，我们创建一个名为 的变量`hash`，我们查看 是否`hash`存在，如果存在，我们使用哈希值，否则，我们将其设为空。在我们的条件中，我们告诉窗口滚动，直到窗口到达我们定义为值的元素的 to，在我们的示例中，它是元素的`id`to `matching the hash value`。

现在，我不知道你是如何生成变量的，你的元素中`content`必须有一些属性包含你想要的值。`<a>`如果您向我展示您打算如何引用该元素，我将连接缺少的链接。

**编辑**- 回应您的评论。

```
$('.main-menu a').prop('href', function(a,b){
    return b+'#content';
}); 
```

[这是你的 jsFiddle——](http://jsfiddle.net/ugzup/)检查控制台，这样你就不必浪费时间进行检查了。

**编辑#2——**响应移动检测。

我没有使用媒体查询，而是使用用户代理嗅探。这是一种很常见的技术。[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)上的人提供了一个脚本，我们可以使用它来检查用户代理是否存在**许多**已知和流行的移动设备。

[检查 jsFiddle 在这里](http://jsfiddle.net/kPd5J/)。

只需将大块代码放在类似“mobileDetect.js”的文件中即可。

下面的任何内容`//comments`都是我上面编写的代码的实现，并相应地放置在条件语句中。我在一些设备上对此进行了测试，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T08:39:35.533

好的，开始工作了！..

我替换

```
$('.main-menu a').prop('href', function(a,b){
    return b+'#content';
}); 
```

对此：

```
$(function () {

     $('.main-menu a').each(function () {
    var href = $(this).attr('href');
    $(this).attr('href', href + '#content');
});
 }); 
```

# html - 向左浮动而不包含在电子邮件中

> ID：13357335
> 
> 赞同：0
> 
> 时间：2012-11-13T08:09:28.910
> 
> 标签：html, css, email

我正在对发送给客户的邮件进行样式设置，并且我希望图像浮动，但文本不应包裹在其下方。我试过了

```
#left-image {
float:left;
}
#right-text {
display:table-cell;
} 
```

和

```
#left-image {
left: 0; 
position: absolute;
}
#right-text {
padding: 0 0 0 100px;
position: relative;
} 
```

第一个代码仍然将文本包裹在图像周围，第二组代码将图像放在文本之上。在发送之前，我一直在为我的确认页面使用第二个代码，它按我想要的方式工作，但我的邮件怎么会不一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T18:44:14.857

今天用了刚刚写的align(html)属性

```
 <table align="left"></table> 
```

这解决了我的浮动问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:13:13.797

你为什么要混合方法？坚持一个，要么浮动，要么在*两个元素*上使用显示表格单元格。

```
#left-image {
    float:left;
}
#right-text {
    float: left;
} 
```

* * *

```
#left-image {
    display: table-cell;
}
#right-text {
    display: table-cell;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:22:18.440

我假设您正在使用普通的 div 标签创建电子邮件，不建议实现跨平台兼容性。使用没有浮动和边距的 HTML 电子邮件结构，然后您可以看到浏览器以及独立于平台的邮件。如果您使用的是 html 表格，则可以使用 text-align:left 而不是 float:left。

# fonts - 您能否为我彻底解释一下“字体”？

> ID：13357337
> 
> 赞同：2
> 
> 时间：2012-11-13T08:09:37.983
> 
> 标签：fonts

在我不关心字体之前，我对各种字体知之甚少。最近遇到一个与字体有关的问题，因此我搜索了几篇有关字体的文章。

我有些疑惑。

1.  **san-serif, san, serif**代表什么？它们是特定的字体还是唯一的标准？
2.  **Helvetica, Arial**代表什么？它们是特定的字体吗？

**san-serif、san、serif、Helvetica、Arial**之间有什么关系，我很困惑。

以下是我的测试。

我正在使用**jasperreport**生成 PDF 报告，如果我使用**Helvetica**配置我的 pdf 字体，以下是我在 Linux 操作系统上执行命令**fc-list时的结果。**

```
[clodev@localhost pdf]$  fc-list
Bitstream Vera Sans Mono:style=Bold
Bitstream Vera Sans:style=Oblique
Bitstream Vera Sans:style=Roman
Bitstream Vera Sans Mono:style=Oblique
Bitstream Vera Sans:style=Bold
Bitstream Vera Serif:style=Roman
Bitstream Vera Sans Mono:style=Bold Oblique
Bitstream Vera Sans:style=Bold Oblique
Bitstream Vera Sans Mono:style=Roman
Bitstream Vera Serif:style=Bold 
```

能否成功生成PDF报告？我在上面的结果中找不到字体**Helvetica 。**但是我的测试结果是OK的，但是生产环境报了一个找不到字体的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:28:28.220

**“衬线”**是每个笔画末尾字体中的细节。比如看《Times New Roman》：在每一笔的末尾，都有一条小横线。这支持打印文本中的阅读器，但由于屏幕分辨率低，屏幕阅读可能会出现问题。高分辨率屏幕（如果您使用 Apple，则为“Retina”）可能会改变这一点。

**Sans Serif**的意思是“没有衬线”（sans 是法语中“没有”的意思）。

Helvetica 和 Arial（以及 Bitstream Vera）是不同的“字体”（字体）。这三个都是“无衬线”，三个看起来都非常相似。

你绝对应该阅读 Robin Williams 的“非设计师设计书”，即使你只是对这个话题感兴趣。

我不知道 Jasper Reports，但可能选择了“Bitstream Vera”，因为它与 Helvetica 非常相似，并且具有非常自由的许可证。

进一步阅读：

*   [http://en.wikipedia.org/wiki/Helvetica](http://en.wikipedia.org/wiki/Helvetica)
*   [http://en.wikipedia.org/wiki/Bitstream_Vera](http://en.wikipedia.org/wiki/Bitstream_Vera)
*   [http://en.wikipedia.org/wiki/Serif](http://en.wikipedia.org/wiki/Serif)
*   [http://en.wikipedia.org/wiki/Sans-serif](http://en.wikipedia.org/wiki/Sans-serif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:16:19.257

Serif 和 Sans-serif 都指代两种不同类别的字体。在**衬线**体中，例如 Times New Roman 和 Georgia 字体。

**Sans-serifs**是一种“[投影特征较少](http://en.wikipedia.org/wiki/Sans-serif)”的字体，其中有 Arial 或 Helvetica 等字体

对 Jasper Reports 了解不多，但通常您可以引用特定类别，而不是特定字体，并且渲染器会根据可用字体调整其字体选择，或者您可以指定要渲染的特定字体，在这种情况下，字体文件必须安装在您的环境中。

# html - 使用 websockets 和画布的多人乒乓球游戏

> ID：13357339
> 
> 赞同：0
> 
> 时间：2012-11-13T08:09:44.507
> 
> 标签：html, node.js, websocket, socket.io, html5-canvas

我正在使用 sockets.io 和 html5 画布创建一个多人乒乓球游戏。

我的节点服务器正在计算球位置 (x,y) 并以 30 fpr 将其发送到客户端的画布。

我的问题是是否可以使用 websocket 每秒向客户端发送 30 条消息？我的服务器和客户端位于很远的地方（我们的服务器和澳大利亚的浏览器）。

如果可以通过任何其他更好的方式完成，请建议我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:13:30.643

是的，像 websockets 这样的持久连接是你最好的选择。但是，高延迟并没有什么魔力，为什么您不能在客户所在的地方拥有服务器？

# php - PHP 类函数在新函数中返回新文件中的变量

> ID：13357340
> 
> 赞同：1
> 
> 时间：2012-11-13T08:09:44.770
> 
> 标签：php

我需要一些帮助来解决我遇到的这个疯狂问题

我有一个类，我使用 Curl 从 URL 获取数据，并使用该信息 $_GET 的每个变量一个值。

所以我有这个类，我正在使用一个新文件来获取发布在一个新函数中的项目的 $name 但每次我将短语变量放在新函数中我都会得到 NULL 这里是我的类简而言之

```
class AppStore {

  public $name;

public function getData() {
       $requestUrl = self::APPSTORE_LOOKUP_URL . $this->appIdentity;

       $ch = curl_init($requestUrl);
                curl_setopt($ch, CURLOPT_URL, $requestUrl);
                curl_setopt($ch, CURLOPT_FOLLOWLOCATION, false);
                curl_setopt($ch, CURLOPT_REFERER, "");
                curl_setopt($ch, CURLOPT_COOKIESESSION, true);
                curl_setopt($ch, CURLOPT_USERAGENT, $this->iTunesUserAgent);
                curl_setopt($ch, CURLOPT_ENCODING, 0);
                curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
                curl_setopt($ch, CURLOPT_FAILONERROR, true);
                curl_setopt($ch, CURLOPT_TIMEOUT, 30);
                $response = curl_exec($ch);
                $errno = curl_errno($ch);
                curl_close($ch);

        $parsedResponse = json_decode($response, true);
        if ($parsedResponse['resultCount'] == 1)
         {
            $parsedResponse = $parsedResponse['results'][0];

            $this->name = $parsedResponse['trackName'];
             require_once('func.ini.php'); // new function to save images etc
        } else {
            throw new AppStoreService_Exception("mInvalid data returned from the AppStore Web Service. Check your app ID, and verify that the Appstore is currently up.");
        }

} 

}

// This is the func.ini.php code
echo $parsedResponse['trackName']; // Works here output equals a Name like Baraka etc
function save_image($img){

    $dirs = "data/Apps/".$name; // Gets the name of the ID in the appIdentity so we can use CURL to download images and move the images to new folder else it'll fail and won't move 
    $path = $dirs."ScreenShots";
    $fullp = basename($img);
    $fullpath = "$path/$fullp";
    $something = $dirs.'ScreenShots'

    var_dump($parsedResponse['trackName']); // Null same if i echo it i get a white page etc

    /* Sample Code 
    $ch = curl_init ($img);
    curl_setopt($ch, CURLOPT_URL,$img);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
    */

} 
```

基本上，如果您可以查看我是否尝试添加我的类的变量以在新函数中获取 appIdentity 的名称，save_image 它将为空，我不确定如何返回 $this-> name ($parsedResponse['trackName']) 对于新函数等中的所有使用都是全局的，因为我的类使用公共 getData() 然后 $this->name (getData()->name)

这仅适用于任何函数，因此如果有函数，则设置为 name 的变量将仅具有函数上方的值，我希望这是可以理解的。

不确定我是否需要在 $this->name 中进行返回或什么，因为我尝试在 getName() 下方的类中创建一个新的公共函数，结果也为 null，因此我无法在其中设置公共变量a = 语句，因为它会从 try{} 中捕获（e），询问它期望 T_FUNCTION 比 T_VARIABLE 即 public $name = $name; // 错误 public $name = 'Test'; // 有效 '{$name}' 无效

```
class Test {

public $test = 'Help me out please!';
  function GetMe() {
      echo $this->test;
  } 

}

$open = new Test;
echo $open->GetMe(); // Outputs "Help me out please" 
```

/* 我不能用变量来做这件事:( ig $this->name / $parsedResponse['trackName'] */

如果有人可以帮助我，我将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:02:11.710

创建您的类的实例并运行设置`name`变量的函数。

```
// Create an instance of AppName
$app_store = new AppName();

// Run the function
$app_store->getData(); 
```

然后，您可以在类之外的其他函数中使用生成的 $name 变量：

```
// By Making the instance global
function save_image()
{
    global $app_store;

    // Show the value of name
    echo $app_store->name;
} 
```

或者...通过将它传递给您想要使用它的任何函数

```
function save_image2($name_var)
{
    echo $name_var;
}

// Called like
save_image2($app_store->name); 
```

# java - MigLayout + JScrollPane 宽度问题

> ID：13357343
> 
> 赞同：2
> 
> 时间：2012-11-13T08:10:02.710
> 
> 标签：java, swing, jscrollpane, miglayout

我想模仿一个带有滚动条的表格，但是宽度有问题。这是一个极其简化的代码（但它是完整的应用程序，因此您可以轻松编译它并直接查看所有内容）。

```
package view;

import java.awt.BorderLayout;
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;

import net.miginfocom.layout.AC;
import net.miginfocom.layout.CC;
import net.miginfocom.layout.LC;
import net.miginfocom.swing.MigLayout;

public class AppView
{
    private final JFrame main_frame;

    public AppView()
    {
        main_frame = new JFrame();
        main_frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        main_frame.setTitle("Example");

        JPanel main_panel = new JPanel() {
            private static final long serialVersionUID = 1L;

            public Dimension getPreferredSize()
            {
                return new Dimension(300,  200);
            }
        };
        main_panel.setLayout(new MigLayout("fill"));

        JPanel table_panel = new JPanel();
        table_panel.setLayout(new MigLayout(new LC(), new AC().gap("0"), new AC().gap("0")));

        JScrollPane scroll_pane = new JScrollPane(table_panel);
        scroll_pane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);

        int[] width_arr = {20, 20, 20, 20, 20};
        for (int i = 0; i < 60; i++) {
            for (int j = 0; j < width_arr.length; j++) {
                if (j == width_arr.length - 1)
                    table_panel.add(new JLabel(i + 1 + ", " + (j + 1)), new CC().width(width_arr[j] + "%").wrap());

                else
                    table_panel.add(new JLabel(i + 1 + ", " + (j + 1)),  new CC().width(width_arr[j] + "%"));
            }
        }

        main_frame.getContentPane().add(main_panel, BorderLayout.CENTER);
        main_panel.add(scroll_pane, new CC().grow());
        main_frame.pack();
        main_frame.setVisible(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run() 
            {
                new AppView();
            }
        });
    }
} 
```

如您所见，我创建了一个`table_panel`并用`scroll_pane`. 然后我添加 60 行，每行有 5 个 JLabel。问题是，如果我指定每列的宽度以使总行宽为 100%，则滚动元素的宽度开始迅速增加。这是两个屏幕截图 - 一个用于禁用水平滚动的情况，另一个用于启用水平滚动的情况。 ![在此处输入图像描述](../Images/44fcdf9e7bdf9ee7c7255d70308c436c.png)![在此处输入图像描述](../Images/6c4cfa84c0803b75a8bb381c58637248.png)

我对这种行为的建议是`JScrollPane`元素的宽度非常大，但似乎这个建议是不正确的，因为如果我为每一列定义宽度，使总宽度为 98%，一切正常。

![在此处输入图像描述](../Images/8fef0205aa6749936fd87ead49068a53.png)

请帮助我理解这些奇怪的事情。提前致谢。

**[更新]**

我决定使用另一种方法来实现我所需要的。这种方法基于网格功能。有一个小条件 - 所有宽度值都应该是 5 的倍数。我想这个条件不是限制性的，因为很难想象需要超过 5% 精度的情况。首先，我添加了 20 个不可见元素（用于进一步调用`span()`方法）：

```
Box empty;
for (int i = 0; i < 20; i++) {
    empty = new Box(BoxLayout.X_AXIS);
    empty.setVisible(false);
    if (i == 19) 
        table_panel.add(empty, "wrap");
    else
        table_panel.add(empty);
} 
```

没有这些元素，`span()`方法就没有效果。这是完整的代码示例：

```
package view;

import java.awt.BorderLayout;
import java.awt.Dimension;

import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.SwingUtilities;

import net.miginfocom.layout.AC;
import net.miginfocom.layout.CC;
import net.miginfocom.layout.LC;
import net.miginfocom.swing.MigLayout;

public class AppView
{
    private final JFrame main_frame;

    public AppView()
    {
        main_frame = new JFrame();
        main_frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        main_frame.setTitle("Example");

        JPanel main_panel = new JPanel() {
            private static final long serialVersionUID = 1L;

            public Dimension getPreferredSize()
            {
                return new Dimension(300,  200);
            }
        };
        main_panel.setLayout(new MigLayout("fill"));

        JPanel table_panel = new JPanel();
        table_panel.setLayout(new MigLayout(new LC().fill().debug(1).hideMode(2), new AC().gap("0"), new AC().gap("0")));

        JScrollPane scroll_pane = new JScrollPane(table_panel);
        scroll_pane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);

        Box empty;
        for (int i = 0; i < 20; i++) {
            empty = new Box(BoxLayout.X_AXIS);
            empty.setVisible(false);
            if (i == 19) 
                table_panel.add(empty, "wrap");
            else
                table_panel.add(empty);
        }

        int[] width_arr = {20, 20, 20, 20, 20};
        for (int i = 0; i < 60; i++) 
            for (int j = 0; j < width_arr.length; j++) {
                if (j == width_arr.length - 1)
                    table_panel.add(new JLabel(i + 1 + ", " + (j + 1)), new CC().span(width_arr[j] / 5).wrap());

                else
                    table_panel.add(new JLabel(i + 1 + ", " + (j + 1)),  new CC().span(width_arr[j] / 5));
            }

        main_frame.getContentPane().add(main_panel, BorderLayout.CENTER);
        main_panel.add(scroll_pane, new CC().grow());
        main_frame.pack();
        main_frame.setVisible(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run() 
            {
                new AppView();
            }
        });
    }
} 
```

这实际上工作得很好，并且不再需要水平滚动，但是不可见框的宽度存在问题 - 它们的宽度不是恒定的并且对于所有框都相等，它取决于 JLabels 宽度。所以比例不对。这里有一些截图，说明：

1) 最简单的情况：五列，每列 20% 的宽度，工作正常。 ![在此处输入图像描述](../Images/feebb1bcc15411a10f27f433f9bed4e4.png)

2）更复杂的例子：三列 - 10%、40%、50%。比例无效，因为第二列没有比第一列宽 4 倍。

![在此处输入图像描述](../Images/13e607cc826e9634d6be206fb7c9b090.png) ![在此处输入图像描述](../Images/36aa145818735c62b0d8b612d853ce5f.png)

好吧，现在我不知道下一步该做什么。我所有在互联网上寻找东西的尝试都是徒劳的。

# vb6 - VB6 - IIF (ISNULL(rs),"TRUE",Replace())

> ID：13357344
> 
> 赞同：0
> 
> 时间：2012-11-13T08:10:07.873
> 
> 标签：vb6, recordset

为什么我不能使用：

```
 rep8_bc = IIf(IsNull(rs(8)), "null", Replace(rs(8), "'", "''")) 
```

它说“无效使用 Null”

但如果我删除替换，它的工作。然后得到错误，因为记录有一个撇号字符，所以我将代码更改为：

```
 rep8_bc = "null"
 If IsNull(rs(8)) = False Then rep8_bc = Replace(rs(8), "'", "''") 
```

或这个 ：

```
 If IsNull(rs(8)) = False Then
     rep8_bc = Replace(rs(8), "'", "''")
 else
     rep8_bc = "null"
 end if 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:19:12.690

很可能编译器不会在 IIF() 语句中短路。编译器在返回一个之前将其作为一个完整的语句（两个值）。那就是你得到错误的地方。因此，分解成适当的条件语句将是这里的关键。所以你的答案已经实现了。进一步补充一点，IIF()的执行速度比 IF-ELSE 语句要*慢得多。*

# ruby-on-rails - 选择元素，simple_form 助手

> ID：13357356
> 
> 赞同：4
> 
> 时间：2012-11-13T08:11:07.713
> 
> 标签：ruby-on-rails, simple-form

我正在尝试在我的表单中创建一个使用简单表单+引导程序的元素。这个想法是允许用户从下拉列表中选择一种货币。

Customer_currency 可从 USD- 美元、LRD - 利比里亚元等中进行选择。

我在表格中使用了以下内容

但是，它不起作用，我所看到的只是我的表单中有一个下拉菜单（不在位置），带有选项但没有标签。

如何使用简单的表单创建带有标签的良好选择元素

```
<%= simple_form_for @customer, :html => { :class => 'form-horizontal' } do |f| %>
<%= f.input :name %>
<%= f.select :customer_currency, [['UGX- Uganda Shillings',1],['USD- US Dollars',2]] %>
<%= f.input :payment_terms %>
<%= f.input :billing_address %>
<%= f.input :first_name %>
<%= f.input :last_name %>
<%= f.input :mobile %>
<%= f.input :email %>
<div class="form-actions">
<%= f.button :submit, :class => 'btn-primary' %>
<%= link_to t('.cancel', :default => t("helpers.links.cancel")),
            customers_path, :class => 'btn' %>
</div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T16:59:05.097

```
<%= f.input :customer_currency, :collection => [['UGX- Uganda Shillings',1],['USD- US Dollars',2]] %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:24:31.427

`label_method`将和添加`value_method`到您的选择中，表示更改：

```
<%= f.select :customer_currency, [['UGX- Uganda Shillings',1],['USD- US Dollars',2]] %> 
```

至：

```
<%= f.select :customer_currency, [['UGX- Uganda Shillings',1],['USD- US Dollars',2]], label_method: :first, value_method: :last %> 
```

**更新：其他解决方案**

```
<%= f.input :customer_currency, as: :select, [['UGX- Uganda Shillings',1],['USD- US Dollars',2]], label_method: :first, value_method: :last %> 
```

# google-app-engine - 在 Google App Engine 上运行时出现初始化失败异常

> ID：13357363
> 
> 赞同：1
> 
> 时间：2012-11-13T08:12:14.113
> 
> 标签：google-app-engine

我有一个在 localhost 环境中执行时可以与 Eclipse + Google 插件一起正常工作的 GAE 应用程序，但是当我将它上传到 GAE 服务器时，（appspot）我收到此错误：

```
Uncaught exception from servlet
javax.servlet.UnavailableException: Initialization failed.
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.createHandler(AppVersionHandlerMap.java:228)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.getHandler(AppVersionHandlerMap.java:194)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:134)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:447)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:679) 
```

我不确定我的应用程序是否有问题，因为它在 localhost 中运行良好

# caching - spring-data：缓存一个查询总数

> ID：13357364
> 
> 赞同：1
> 
> 时间：2012-11-13T08:12:17.427
> 
> 标签：caching, spring-data

我正在使用带有 querydsl 的 spring data jpa。我有一种方法可以在包含总计数的页面中返回查询结果。获取总数很昂贵，我想缓存它。这怎么可能？

我幼稚的做法

```
@Cacheable("queryCount")
private long getCount(JPAQuery query){
    return query.count();
} 
```

不起作用（为了使其起作用，他们希望缓存的实际键不应该是整个查询，而只是条件）。无论如何测试它，没有工作，然后我发现这个：[Spring 3.1 @Cacheable - 方法仍然执行](https://stackoverflow.com/questions/10343885/spring-3-1-cacheable-method-still-executed)

我理解这一点的方式我只能缓存公共接口方法。但是在所述方法中，我需要缓存返回值的属性，例如。

```
Page<T> findByComplexProperty(...) 
```

我需要缓存

```
page.getTotalElements(); 
```

注释整个方法有效（它被缓存）但不是我想要的方式。假设获取总数需要 30 秒。因此，对于每个新页面请求，用户需要等待 30 秒。如果他返回一个页面，则使用缓存，但我希望计数只运行一次，然后从缓存中获取计数。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T05:50:27.540

我的解决方案是在创建复杂查询的类中自动连接缓存管理器：

```
@Autowired
private CacheManager cacheManager; 
```

然后创建一个简单的私有方法 getCount

```
private long getCount(JPAQuery query) {
    Predicate whereClause = query.getMetadata().getWhere();
    String key = whereClause.toString();        
    Cache cache = this.cacheManager.getCache(QUERY_CACHE);        
    Cache.ValueWrapper value = cache.get(key);
    if (value == null) {
        Long result = query.count();
        cache.put(key, result);
        return result;
    }
    return (Long)value.get();
} 
```

# sybase - 声明表变量时，关键字 table 附近的语法不正确

> ID：13357366
> 
> 赞同：3
> 
> 时间：2012-11-13T08:12:28.580
> 
> 标签：sybase

我正在使用 Sybase 数据库 ISQL.exe。当我使用此子句声明表变量时：

```
declare @tabVar table (fid int, name varchar(10)) 
```

我收到错误：无法执行语句。关键字“table”附近的语法不正确

没看出哪里不对，有大神帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T11:07:32.987

这不是正确的构造。您不能在 sybase 中使用表类型变量。对于这个解决方案，我建议使用如下临时表：

```
create table #tabVar 
(
 fid int, 
 name varchar(10)
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-14T15:57:13.070

这在 Sybase 中必须是新的；我现在正在使用它。

`DECLARE LOCAL TEMPORARY TABLE @tabVar (fid int, name varchar(10))`

# osgi - 如何以编程方式使用蓝图？

> ID：13357368
> 
> 赞同：2
> 
> 时间：2012-11-13T08:12:41.487
> 
> 标签：osgi, blueprint-osgi

是否可以不使用 XML（以声明方式）而是在运行时连接蓝图服务？我想要的是一个类似于创建[BeanDefinition的界面](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/beans/factory/config/BeanDefinition.html)

```
ctx.registerBeanDefinition(beanName, BeanDefinition) 
```

不知何故，这应该从一个单独的包中调用，该包将启动/停止来自其他包的服务

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T12:43:02.117

您应该能够查找捆绑包的蓝图上下文，因为它是一个已注册的服务，并且从那里您应该能够通过注册 bean 等做您喜欢的事情。

# phpmyadmin - 在 phpmyadmin 中添加 FOREIGN KEY 的错误在哪里？

> ID：13357369
> 
> 赞同：1
> 
> 时间：2012-11-13T08:12:54.390
> 
> 标签：phpmyadmin, foreign-keys

> **可能重复：**
> [在 phpMyAdmin 中设置外键？](https://stackoverflow.com/questions/459312/setting-up-foreign-keys-in-phpmyadmin)

```
ALTER table podcategory add FOREIGN KEY (category_id) 
           REFERENCES category(category_id)
ON UPDATE RESTRICT
ON DELETE CASCADE 
```

当我在 phpmyadmin 中发送脚本时出现错误

```
Can't create table './C292729_T25027/#sql-be0_30ed238.frm' (errno: 150) 
```

如何添加这个外键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:15:57.067

试试这个类型：

```
ALTER TABLE `aaaa` ADD CONSTRAINT fk_comp_id FOREIGN KEY ( `comp_id` ) REFERENCES `comps` ( `id` ); 
```

或者这个 SO 答案/问题可能可以帮助您确定： [在 phpMyAdmin 中设置外键？](https://stackoverflow.com/questions/459312/setting-up-foreign-keys-in-phpmyadmin)

# css - 有谁知道如何用css获得这种背景效果？

> ID：13357375
> 
> 赞同：0
> 
> 时间：2012-11-13T08:13:28.203
> 
> 标签：css

我正在尝试创建一个与本网站具有相似背景的网站。

[http://citymob.co.za](http://citymob.co.za)

有谁知道它是怎么做的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:19:55.510

如果您正在谈论页面背景，它是通过使用一个大背景图像来完成的，其中一个绝对定位的 div 覆盖整个屏幕，另一个绝对定位的 div 具有重复的点背景分层在顶部。

如果您正在谈论两个背景图像之上主要元素的透视效果，则可以使用`opacity: .5;/*value*/;`或来完成`background: rgba(125, 125, 125, .5)/*grey half opaque*/`。

您可以按 F12（在好的浏览器中，IE 的开发工具非常糟糕）并查看标记和 CSS 来查看自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:07:16.960

我想说，看一下网站的来源并分析代码。（在您的浏览器中，右键单击 --> 查看源代码）

网页的容器使用位于外部 .css 文件中的 bg9 类，该文件引用了一些图像。通常，网站使用外部图像作为背景以获得良好、吸引人的美学外观。

# sql - 10 位数值被存储为 E 升幂形式 如何避免这种情况？

> ID：13357377
> 
> 赞同：0
> 
> 时间：2012-11-13T08:13:29.863
> 
> 标签：sql, sql-server, floating-point

我的数据库表中有一个浮点型列。当我从前端将 10 位值解析为浮点数并存储在表中时。它存储在 E raise to power 形式

而如果我在 SQL 数据库中手动输入一个 10 位数的值，则不会发生这种情况

我该怎么办？

数据也被四舍五入，例如我输入 5666666666

这就是发生的事情

![在此处输入图像描述](../Images/53f98ae3a7beaed4250bf27131755d7b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:14:36.047

更好地`DECIMAL(12,2)`用于这种领域。

*   [十进制和数字 (T-SQL)](http://msdn.microsoft.com/en-us/library/ms187746.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:40:50.977

似乎您的前端只接受尾数中的 7 位数字，而数据库接受 15 位数字。您可以通过提高前端数据类型的精度来实现您想要的。

话虽如此，请尝试让您的客户对此列使用精确（十进制）类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T10:49:26.063

检查前端应用程序天气，它确实会收集浮动并告诉您的客户使用金钱来获取数据类型。浮点数的替代方法是使用具有精度的数字或小数（您将确保它是您想要保持的精度）。由于 floater 是一个以 2 为底数计算的数字，因此您可能会出现与您在保存数据时提出的差距一样的差距。这就是为什么你从不使用浮点数来获取货币数据。

# azure - Caching Diagnostics 建议使用 20GB 的本地存储（！）。为什么？

> ID：13357378
> 
> 赞同：2
> 
> 时间：2012-11-13T08:13:42.633
> 
> 标签：azure, azure-diagnostics, azure-caching

我安装了 Azure 1.8 工具/SDK，并将我的项目共存缓存从预览版升级到了最终版。但是，它还决定向角色的本地存储 ( `DiagnosticStore`) 添加 20GB。我手动将其调低至 500MB，但随后我在角色的属性页面中收到以下消息（云 proj => 角色 => 右键单击​​角色 => 属性，即 ServiceDefinition.csdef 的 GUI）：

> Caching Diagnostics 建议使用 20GB 的本地存储。如果您减小本地存储的大小，则需要完全重新部署，这将导致此云服务的虚拟 IP 地址丢失。

我不知道谁在 MS 中签署了这种运营模式，但它乞求一个简单的***为什么？***. 为了更好地理解，我将“为什么”分解为 3 个“为什么”子问题，以便在 Azure SDK 1.8 中进行缓存：

1.  为什么缓存的诊断与缓存本身相结合？我们只需要缓存来提高性能...
2.  为什么推荐高达 20Gigs？如果我把它拨到 500MB 会怎样？
3.  有点离题但仍然相关：为什么本地存储的减少需要完全重新部署？这尤其令人痛苦，因为 Azure 没有提供任何强大的控制来保留 IP 地址。因此，如果您需要与使用白名单 IP 的第三方合作 - 太糟糕了！？

PS：我确实考虑将其分解为 3 个单独的问题。但是鉴于它们是紧密耦合的，这似乎对未来的读者来说是一种更有帮助的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T08:21:46.623

诊断存储用于存储缓存诊断数据，其中包括 - 服务器日志、故障转储、计数器数据等，这些数据可以通过配置缓存诊断自动上传到 Azure 存储（在 OnStart 方法中调用 CacheDiagnostics.ConfigureDiagnostics - 如果没有此调用，则数据为在本地 VM 上生成但未上传到 Azure 存储）。收集的数据量由诊断级别控制（级别越高，收集的数据越多），可以动态更改。有关缓存诊断的更多详细信息，请访问：http: [//msdn.microsoft.com/en-us/library/windowsazure/hh914135.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh914135.aspx)

1.  由于您启用了缓存，它将带有默认诊断级别，如果发生缓存问题，应该有助于诊断缓存问题。此数据存储在本地，除非您在 OnStart 中调用 ConfigureDiagnostics 方法（该方法将数据上传到 Azure 存储）。
2.  如果提供了较低的存储值（例如 2GB），则无法使用更高的诊断级别，因为它们需要更多空间（对于 XL VM，故障转储本身可能需要 12GB 以上）。如果您想要更高的级别，那么您可能希望通过更改诊断存储大小来升级部署，这违背了目的 - 在不重新部署/升级/更新/重新启动的情况下更改诊断级别。这就是为什么设置 20GB 的限制来满足所有诊断级别的原因（并且可以在运行的部署中通过 cscfg 更改来更改它们）。
3.  上面已经回答了。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:06:18.923

我将回答问题 #3 - 本地存储*减少*是唯一无法就地完成的部署更改之一（增加很好，以及 VM 大小更改和其他一些更改现在可能无需重新部署）。有关就地更新的详细信息，请参阅[此帖子。](http://blogs.msdn.com/b/windowsazure/archive/2011/10/19/announcing-improved-in-place-updates.aspx)

# java - Android startActivityForResult 和 onActivityResult 具有不可预知的行为

> ID：13357383
> 
> 赞同：0
> 
> 时间：2012-11-13T08:14:10.387
> 
> 标签：java, android

我有一个应用程序，其中多个活动按特定顺序显示，可以根据当前活动中的事件进行更改。我有一个“主”活动来管理显示哪些活动。每个活动都以该活动`startActivityForResult()`的`requestCode`独特性开始。

当活动结束时，我将 设置`resultCode`为对主活动有意义的值。在主活动的`onActivityResult`方法中，我有一个`switch (requestCode)`，它将告诉我哪个活动已返回，并且在每种情况下，我都会使用`resultCode`来确定接下来要开始哪个活动。

我遇到的问题是，有时，看似随机的应用程序行为非常不稳定，显示活动不按顺序。

我在调试时无法复制这个问题，所以我所拥有的所有信息看起来都不错，但最终用户一直在抱怨这种不稳定的行为。

如何测试以查看问题出在哪里？

* * *

来自主活动的 onActivityResult 的代码：

```
 @Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    switch (requestCode) {
    case Settings.SCREEN_UPDATE:
        ShowActivity(LoginActivity.class, Settings.SCREEN_LOGIN);
        break;
    case Settings.SCREEN_LOGIN: 
        if (resultCode == RESULT_OK) {
            Settings.CurrentReport = new Report();
            Settings.CurrentReport.setUserId(data.getIntExtra("userId", -1));

            selectStore();
        } else {
            finish();
        }
        break;
    case Settings.SCREEN_PRODUCT: // Coming back from the product selection screen
        if (resultCode == RESULT_OK) {
            ShowActivity(ActionActivity.class, Settings.SCREEN_ACTION);
        } else if (resultCode == RESULT_CANCELED){
            ShowActivity(OptionsActivity.class, Settings.SCREEN_OPTIONS);
        }
        break;
    case Settings.SCREEN_ACTION: // Coming back from the action screen, regardless of result, show options screen.
        ShowActivity(OptionsActivity.class, Settings.SCREEN_OPTIONS);
        break;
    case Settings.SCREEN_OPTIONS: // All choices return result_ok.  Check the "mode" extra
        String mode = data.getStringExtra("mode");
        processOption(mode);
        break;
    case Settings.SCREEN_SESSION:
        if (resultCode == RESULT_CANCELED) {
            ShowActivity(OptionsActivity.class, Settings.SCREEN_OPTIONS);
        } else if (resultCode == RESULT_OK ){
            ShowActivity(ActionActivity.class, Settings.SCREEN_ACTION);
        }
        break;
    } // switch (requestCode)
} // protected void onActivityResult(int requestCode, int resultCode, Intent data) {

private void processOption(String mode) {
    if (mode.equals("select")) {
        ShowActivity(ProductActivity.class, Settings.SCREEN_PRODUCT);
    } else if (mode.equals("repeat")) {
        Settings.CurrentReport.repeatItem();
        ShowActivity(ActionActivity.class, Settings.SCREEN_ACTION);
    } else if (mode.equals("session")) {
        ShowActivity(SessionActivity.class, Settings.SCREEN_SESSION);
    } else { // mode equals "end"
        confirmFinish();
    }
}

private void ShowActivity(Class cls, int requestCode) {
    Intent activity = new Intent(this, cls);
    startActivityForResult(activity, requestCode);
} 
```

* * *

然后，处理完成（）事件的其他活动之一的代码：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    setContentView(R.layout.options);

    Button btn;

    btn = (Button)findViewById(R.id.btnSelect);
    btn.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            Intent intent = getIntent();
            intent.putExtra("mode", "select");
            setResult(RESULT_OK, intent);
            finish();
        }
    });

    btn = (Button)findViewById(R.id.btnRepeat);
    btn.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            Intent intent = getIntent();
            intent.putExtra("mode", "repeat");
            setResult(RESULT_OK, intent);
            finish();
        }
    });
    btn.setEnabled(Settings.CurrentReport.hasPreviousItem());

    btn = (Button)findViewById(R.id.btnSession);
    btn.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            Intent intent = getIntent();
            intent.putExtra("mode", "session");
            setResult(RESULT_OK, intent);
            finish();
        }
    });

    btn = (Button)findViewById(R.id.btnEnd);
    btn.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            Intent intent = getIntent();
            intent.putExtra("mode", "end");
            setResult(RESULT_OK, intent);
            finish();
        }
    });

}

public boolean onKeyDown(int keyCode, KeyEvent event) {
    switch (keyCode) {
        case KeyEvent.KEYCODE_BACK:
            Intent i = getIntent();
            i.putExtra("mode", "end");
            setResult(RESULT_OK, i);
            finish();
            break;

    }
    return super.onKeyDown(keyCode, event);
}
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:01:28.693

我只是猜测，但可能`Intent intent = getIntent();`是造成问题的原因。您可以尝试将其替换为`Intent intent = new Intent();`

getIntent() 返回启动当前活动的意图，不应将其用作结果。

# javascript - 无论如何在Backbone中绑定具有“if”依赖的事件？

> ID：13357389
> 
> 赞同：1
> 
> 时间：2012-11-13T08:14:42.677
> 
> 标签：javascript, events, backbone.js, bind

我想知道是否有依赖于Backbone中“if”的事件绑定。

例如，如果我有用户配置文件模型，并且我想仅在属性“acceptMsgs”设置为 true 时绑定“发送消息”按钮事件。

我目前的解决方案是在事件触发时检查它，如果有更好的方法，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:24:11.767

我不确定这是否是一种*更好*的方法，但您可以使用返回事件哈希的哈希的函数（当然，在函数中您可以检查某些条件）。

例如类似的东西

```
myView = Backbone.Views.extend({

    events: function () {
      if (someCondition) {
         return { "#someButton click" : "nameOfFunction"}
      }
    }

 //the rest of your view
}); 
```

或者，您可以放弃事件哈希并在初始化方法中绑定您的事件，例如

```
initialize: function (options) {
   if (someCondition) {
     this.$el.on("click", "#someButton", nameOfFunction);
   }
} 
```

# c# - 加入两个不同类型的列表并按日期排序

> ID：13357392
> 
> 赞同：6
> 
> 时间：2012-11-13T08:15:02.950
> 
> 标签：c#, list

我有这样的实体的第一个列表：

```
public partial class Networking :EntityBase
{

    public virtual int NetWorkingId
    {
        get;
        set;
    }

    public virtual string NetWorkingParam
    {
        get;
        set;
    }

    public virtual System.DateTime NetWorkingDate
    {
        get;
        set;
    }
} 
```

我有第二个这样的实体列表：

```
public partial class PrivateNetwork :EntityBase
{
    public virtual int PrivateNetworkId
    {
        get;
        set;
    }

    public virtual int ContaId
    {
        get { return _contaId; }
        set
        {
            if (_contaId != value)
            {
                if (Contact != null && Contact.ContaId != value)
                {
                    Contact = null;
                }
                _contaId = value;
            }
        }
    }

    public virtual Nullable<System.DateTime> DateCreation
    {
        get;
        set;
    }
} 
```

我想将这两个列表合二为一，并按日期对所有元素进行排序。

那可能吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T08:22:57.450

你可以这样做，虽然它不是很漂亮，但你最终会得到一个，`IEnumerable<object>`所以你必须在使用它之前检查每个项目的类型：

```
IEnumerable<object> sorted = myNetworkingList
    .Concat<object>(myPrivateNetworkList)
    .OrderBy(n => n is Networking
                 ? (DateTime?)((Networking)n).NetWorkingDate
                 : ((PrivateNetwork)n).DateCreation);

foreach (object either in sorted)
{
    if (either is Networking)
        // Networking; do something
    else
        // PrivateNetwork; do something else
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-13T08:20:58.410

使用多态可以很容易地解决这个问题；为这两个类使用一个公共基类或接口，它具有`DateTime`您要排序的属性。

例子：

```
public abstract class NetworkingBase : EntityBase
{
    public DateTime DateToSortOn { get; set; }
} 
```

或者

```
public interface INetworking
{
    public DateTime DateToSortOn { get; set; }
} 
```

然后让你的类派生自`NetworkingBase`或实现`INetworking`：

```
public partial class Networking : NetworkingBase
{
    ...
}

public partial class PrivateNetwork : NetworkingBase
{
    ...
} 
```

或者

```
public partial class Networking : EntityBase, INetworking
{
    ...
}

public partial class PrivateNetwork : EntityBase, INetworking
{
    ...
} 
```

对结果集合执行 LINQ[`Union`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.union.aspx)或[`Concat`](http://msdn.microsoft.com/en-us/library/bb302894.aspx)然后执行。[`OrderBy`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T14:38:53.707

我应该早先问的是。. .

**对它们进行排序后，您想做什么？**

这个问题的答案可能会对潜在的解决方案产生重大影响。

如果答案类似于*我需要显示日期列表*，您只需要按顺序排列日期。如果是这样，那么您不需要合并这两个列表，您可以获取仅排序日期的序列并使用它，例如

```
var orderedDates = networks.Select(n => n.NetworkingDate)
                   .Union(privateNetworks.Select(n => n.DateCreation))
                   .OrderBy(date => date); 
```

如果答案是*我需要显示一个链接列表，显示链接到对象 Id 的日期，以及标识对象类型的内容*，那么您可以使用匿名对象来摆脱与上述非常相似的事情。

```
var orderedDates = networks.Select(n => new {Date = n.NetworkingDate, Id = n.NetWorkingId, NetworkType = n.GetType().Name})
                   .Union(privateNetworks.Select(n => new {Date = n.DateCreation, Id = n.PrivateNetWorkingId, NetworkType = n.GetType().Name}))
                   .OrderBy(n => n.Date); 
```

但是，如果答案是*我需要向 10 个最旧的网络发送 Shutdown() 命令，*那么**您确实需要一个多态解决方案**，其中您有一个可以调用`Shutdown()`方法的单一类型，它将解析为特定的`Shutdown()`方法您正在使用的类型。

**仅当用户[khillang 的答案](https://stackoverflow.com/questions/13357392/joining-two-lists-of-different-types-and-sort-them-by-date/13357460#13357460)对您不起作用时才使用的多态解决方案**

从对另一个答案的评论

> @BinaryWorrier我选择这个答案是因为我已经在数据库中有记录，所以如果我选择添加一个新接口，我将如何处理在添加接口之前已经存储的记录？

我发现很难相信您的 ORM 不允许您向实体类添加接口，并且不以某种方式标记该接口和/或其成员，因此 ORM 会忽略它们。

但是，假设您不能添加新的接口或基类，您仍然可以多态地执行此操作。

添加接口，添加一个实现每个网络类（`Abstractor`类）的接口的类，然后将网络类转换为`Abstractor`类，将它们添加到 a`List<INetwork>`并对该列表进行排序。

```
public interface INetwork
{
    DateTime? Date { get; }
}

public class PrivateNetworkAbstractor
    :INetwork
{
    private PrivateNetwork network;
    public PrivateNetworkAbstractor(PrivateNetwork network)
    {
        this.network = network;
    }
    public DateTime? Date
    {
        get { return network.DateCreation; }
    }
}

public class NetworkingAbstractor
    : INetwork
{
    private Networking networking;
    public NetworkingAbstractor(Networking networking)
    {
        this.networking = networking;
    }
    public DateTime? Date
    {
        get { return networking.NetWorkingDate; }
    }
}
...

public IEnumerable<INetwork> MergenSort(IEnumerable<Networking> generalNetWorks, IEnumerable<PrivateNetwork> privateNetWorks)
{
    return generalNetWorks.Select(n => new NetworkingAbstractor(n)).Cast<INetwork>()
    .Union(privateNetWorks.Select(n => new PrivateNetworkAbstractor(n)).Cast<INetwork>())
    .OrderBy(n=> n.Date);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T08:23:53.800

创建一个具有日期并在两个类中实现的接口。之后排序很容易。

```
public interface INetwork
{
    DateTime? Date { get; }
}

public partial class Networking :EntityBase, INetwork
{
    public DateTime? Date
    {
        get { return NetWorkingDate; }
    }
}

public partial class PrivateNetwork :EntityBase, INetwork
{
    public DateTime? Date
    {
        get { return DateCreation; }
    }
}

var commonList = new List<INetwork>();
// Add instances of PrivateNetwork and Networking to the list

var orderedByDate = commonList.OrderBy(n => n.Date); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T19:14:28.883

第一个解决方案是使用匿名类型

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Example1
{
    class Program
    {
        class Human
        {
            public string Name { get; set; }
            public string Hobby { get; set; }
            public DateTime DateOfBirth { get; set; }
        }
        class Animal
        {
            public string Name { get; set; }
            public string FavouriteFood { get; set; }
            public DateTime DateOfBirth { get; set; }
        }

        static void Main(string[] args)
        {
            var humans = new List<Human>
            {
                new Human
                {
                    Name = "Kate",
                    Hobby = "Fitness",
                    DateOfBirth = DateTime.Now.AddYears(-27),
                },
                new Human
                {
                    Name = "John",
                    Hobby = "Cars",
                    DateOfBirth = DateTime.Now.AddYears(-32),
                },
            };

            var animals = new List<Animal>
            {
                new Animal
                {
                    Name = "Fluffy",
                    FavouriteFood = "Grain",
                    DateOfBirth = DateTime.Now.AddYears(-2),
                },
                new Animal
                {
                    Name = "Bongo",
                    FavouriteFood = "Beef",
                    DateOfBirth = DateTime.Now.AddYears(-6),
                },
            };

            var customCollection = (from human in humans
                                    select new
                                        {
                                            Name = human.Name,
                                            Date = human.DateOfBirth,
                                        }
                                        ).Union(from animal in animals
                                                select new
                                                    {
                                                        Name = animal.Name,
                                                        Date = animal.DateOfBirth,
                                                    }).OrderBy(x => x.Date);

            foreach (dynamic customItem in customCollection)
                Console.WriteLine(String.Format("Date: {0}, Name: {1}",      customItem.Date, customItem.Name));

            Console.Read();
        }
    }
} 
```

或没有匿名类型（创建的 CustomClass）：

```
...
class CustomClass
        {
            public string Name { get; set; }
            public DateTime Date { get; set; }
        }
...
var customCollection = (from human in humans
                                    select new CustomClass
                                        {
                                            Name = human.Name,
                                            Date = human.DateOfBirth,
                                        }
                                        ).Union(from animal in animals
                                                select new CustomClass
                                                    {
                                                        Name = animal.Name,
                                                        Date = animal.DateOfBirth,
                                                    }).OrderBy(x => x.Date);

            foreach (CustomClass customItem in customCollection)
                Console.WriteLine(String.Format("Date: {0}, Name: {1}", customItem.Date, customItem.Name));

... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-24T06:11:20.853

我只是添加了一个基类并将其分配为两个列表的类的父类。然后简单地做了 union 。它成功了

# google-code - 如何将谷歌代码项目的描述置于版本控制之下？

> ID：13357393
> 
> 赞同：1
> 
> 时间：2012-11-13T08:15:17.123
> 
> 标签：google-code

Google 托管将 wiki 页面置于版本控制之下。如何将谷歌代码项目的描述置于版本控制之下？

“谷歌代码项目描述”支持 wiki 语法并呈现到主页[http://name_of_project.googlecode.com](http://name_of_project.googlecode.com)

# php - 如何使 apache 进程 TCP 连接？

> ID：13357395
> 
> 赞同：1
> 
> 时间：2012-11-13T08:15:20.830
> 
> 标签：php, apache, sockets, tcp, subdomain

我有一个问题困扰了我将近 24 小时，此刻我不知道如何解决它。

事情是这样的：我想在我的服务器上有一个“主”套接字来处理所有传入的数据并使用 PHP 将其发送到其他客户端。那部分很好，但我想使用多个子域连接该套接字，例如 ex.example.com。问题是，除非你有一个正在运行的套接字，否则你无法连接到该子域，这只会填满你的端口，这就是我想要阻止的。

最好的解决方案是让 Apache 处理传入的 TCP 请求，将数据保存在您正在连接的域上，然后将客户端重定向到主套接字，主套接字处理接收到的数据并在客户端被接受时立即执行。

老实说，我不知道该怎么做。我正在寻找几个小时，但我发现的唯一东西是 Stackoverflow 上接近它的东西：[Apache - 处理 TCP 连接，但不是 HTTP 请求](https://stackoverflow.com/questions/3917167/apache-handling-tcp-connections-but-not-http-requests)

但是使用那段脚本，我无法保存数据（您正在使用的域）并将其发送到主套接字。

我不知道这是否可以由 Apache 完成，或者是否有可能，或者是否有任何其他解决方法。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:14:39.203

您对子域感到困惑。套接字、TCP 和 IP对名称*一无所知。*直到网络堆栈已经存在多年，DNS 才被发明出来。

因此，您可以将任意数量的域指向机器上的单个“套接字”端口。

Apache 可以根据传入连接的目标 IP 地址 (1) 或 HTTP/1.1 “主机” 标头 (2) 将传入请求路由到不同的“网络空间”（即虚拟主机）。前者是虚拟主机过去的做法，但现在几乎每个人都使用后者。

(1) 即使只有一个网卡，一台机器也可以有多个 IP 地址，但端口对于该机器上的任何给定协议都是唯一的。您将不同的域指向不同的地址，并在网络服务器上定义反向映射，以便它可以判断请求是如何开始的。

(2) “host”的值是提供给浏览器的 DNS 名称。由于这个值是显式传递给网络服务器的，所以该服务器不需要依赖 #1 之类的技巧。

# python - 如何修复这个 Django/MySQL 设置灾难？

> ID：13357397
> 
> 赞同：0
> 
> 时间：2012-11-13T08:15:28.317
> 
> 标签：python, mysql, django, macos, mysql-python

我一直在搜索 SO、论坛和博客文章超过 24 小时。坦率地说，我完全不知道发生了什么。这似乎是一个复杂的问题，所以我会尽可能清楚地发布。

我正在使用 Django，并试图从 sqlite 切换到 mysql。我按照此 SO 答案中的说明进行操作：[https ://stackoverflow.com/a/3036241](https://stackoverflow.com/a/3036241)

当我运行最后一行时`python manage.py loaddata datadump.json`（或者当我尝试为此运行时`python manage.py syncdb`），我收到以下错误：

```
File "manage.py", line 10, in <module>
execute_from_command_line(sys.argv)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/management/__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/management/__init__.py", line 69, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/management/commands/loaddata.py", line 13, in <module>
    from django.core import serializers
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/serializers/__init__.py", line 21, in <module>
    from django.core.serializers.base import SerializerDoesNotExist
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/core/serializers/base.py", line 7, in <module>
    from django.db import models
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/db/__init__.py", line 40, in <module>
    backend = load_backend(connection.settings_dict['ENGINE'])
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/db/__init__.py", line 34, in __getattr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/db/utils.py", line 92, in __getitem__
    backend = load_backend(db['ENGINE'])
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/db/utils.py", line 24, in load_backend
    return import_module('.base', backend_name)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/Django-1.4-py2.7.egg/django/db/backends/mysql/base.py", line 16, in <module>
    raise ImproperlyConfigured("Error loading MySQLdb module: %s" % e)
django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb 
```

所以，我四处寻找如何解决这个问题，并尝试了这个：

```
pip install MySQL-python 
```

一旦我运行该行，我就收到以下错误：

```
Downloading/unpacking MySQL-python
  Running setup.py egg_info for package MySQL-python
    sh: mysql_config: command not found
    Traceback (most recent call last):
      File "<string>", line 16, in <module>
      File "/var/folders/9q/bvqtzkbx1hg1934b36zgk0y40000gn/T/pip-build/MySQL-python/setup.py", line 18, in <module>
        metadata, options = get_config()
      File "setup_posix.py", line 43, in get_config
        libs = mysql_config("libs_r")
      File "setup_posix.py", line 25, in mysql_config
        raise EnvironmentError("%s not found" % (mysql_config.path,))
    EnvironmentError: mysql_config not found
    Complete output from command python setup.py egg_info:
    sh: mysql_config: command not found

Traceback (most recent call last):

  File "<string>", line 16, in <module>

  File "/var/folders/9q/bvqtzkbx1hg1934b36zgk0y40000gn/T/pip-build/MySQL-python/setup.py", line 18, in <module>

    metadata, options = get_config()

  File "setup_posix.py", line 43, in get_config

    libs = mysql_config("libs_r")

  File "setup_posix.py", line 25, in mysql_config

    raise EnvironmentError("%s not found" % (mysql_config.path,))

EnvironmentError: mysql_config not found 
```

用easy_install试了一下，只是为了确保。同样的错误。

因此，然后我尝试按照此 SO 答案中的**步骤 5 和 6**更改 setup_posix.py 中 mysql_config 的路径： [https ://stackoverflow.com/a/1448476/1337422](https://stackoverflow.com/a/1448476/1337422)

当我继续执行该答案的**第 7 步**`sudo python setup.py build`并运行时，出现以下错误：

```
running build
running build_py
copying MySQLdb/release.py -> build/lib.macosx-10.3-fat-2.7/MySQLdb
running build_ext
building '_mysql' extension
gcc-4.0 -fno-strict-aliasing -fno-common -dynamic -g -O2 -DNDEBUG -g -O3 -Dversion_info=(1,2,4,'beta',4) -D__version__=1.2.4b4 -I/usr/local/mysql/include -I/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c _mysql.c -o build/temp.macosx-10.3-fat-2.7/_mysql.o -Os -g -fno-common -fno-strict-aliasing -arch x86_64
unable to execute gcc-4.0: No such file or directory
error: command 'gcc-4.0' failed with exit status 1 
```

为此，我没有找到治疗方法。

* * *

顺便说一句，我也按照这个答案的说明：[https://stackoverflow.com/a/1448446/1337422](https://stackoverflow.com/a/1448446/1337422)，并运行： `sudo port install py26-mysql`

这似乎没有解决任何问题。

（我在 Mac OS 10.8.1 上运行）

* * *

在这一点上，我很迷茫，也很绝望。我不知道还能去哪里……帮帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:17:55.297

线索在这里：

```
unable to execute gcc-4.0: No such file or directory
error: command 'gcc-4.0' failed with exit status 1 
```

你需要安装编译器......我不是 Mac 用户，但谷歌快速想出了[http://www.tech-recipes.com/rx/726/mac-os-x-install-gcc-编译器/](http://www.tech-recipes.com/rx/726/mac-os-x-install-gcc-compiler/)这可能会有所帮助

看起来`sudo port install gcc_select`，然后`sudo port install gcc<nnn>`是关于正确的线条......

# javascript - 如何列出文件夹中的文件名？

> ID：13357398
> 
> 赞同：1
> 
> 时间：2012-11-13T08:15:29.393
> 
> 标签：javascript, html

我有这样的文件夹结构。

```
docs/doc1.html
docs/doc2.html
docs/spec1.html
index.html 
```

我想注入`index.html`with `<ul>`，只是文件夹中的文件名（不带扩展名）`docs`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:17:10.773

不，这是不可能的，您无法使用 javascript 访问机器文件。

你可以向浏览器推荐这个功能，我会建议给我免费的钱给我的银行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:20:50.730

仅 Javascript 是不可能的，但是，您可能需要 Java 小程序或 ActiveX 组件，但这些解决方案将面临与用户浏览器的兼容性。在 ActiveX 中，用户必须使用 Windows。对于 Java Applets，用户必须在他们的机器上安装 JVM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:22:41.997

您可以向 Web 服务器发送 HTTP 请求并接收带有所需数据的 JSON 或 XML 响应。但是你首先需要一个网络服务器:-)。如果您使用 node.js，请查看[http://blog.rassemblr.com/2011/04/a-working-static-file-server-using-node-js/](http://blog.rassemblr.com/2011/04/a-working-static-file-server-using-node-js/)

# php - PHP - 将图像覆盖在另一个图像上

> ID：13357399
> 
> 赞同：1
> 
> 时间：2012-11-13T08:15:30.530
> 
> 标签：php, imagemagick

我有一张图片（想想一棵树的照片），我想在上面放一个“播放”箭头。我也有 1000 张图像可以做到这一点。有没有比使用 imagemagick 更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:48:23.633

可能这段代码可以帮助你......在这个我有一个图像周围的边框

```
$water_mark = imagecreatefrompng('your/image/path.png');   
$water_mark_width = imagesx($water_mark);   
$water_mark_height = imagesy($water_mark);   
$image = imagecreatetruecolor($water_mark_width, $water_mark_height);   
$image = imagecreatefromjpeg('image_path.jpg');   
$size = getimagesize('image_path.jpg');   
$dest_x = $size[0] - $water_mark_width - 0;   
$dest_y = $size[1] - $water_mark_height - 0;   
imagecopymerge($image, $water_mark, $dest_x, $dest_y, 0,0, $watermark_width, $watermark_height, 100); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T10:53:57.630

如果您可以使用“插件”而不是编写自己的代码。我会建议 Asido，它可以使用 imagemagick、gd 等。 [http://sourceforge.net/projects/asido/](http://sourceforge.net/projects/asido/)

# usb - USB 1.1 更多的大容量带宽

> ID：13357400
> 
> 赞同：0
> 
> 时间：2012-11-13T08:15:33.057
> 
> 标签：usb, bandwidth, bulk

我有以下问题：

带有 usb1.1 的微控制器，用于批量传输的 32 字节缓冲区和大量实时数据以移动到 Linux (kernel2.6) PC。

据我了解，在这种情况下，可用于批量传输的最大理论带宽为 19 次传输 * 32 字节/帧 (1ms) = 608 KB/秒

对我来说，问题是这仍然不足以实时移动数据，并且无法更改为 USB 2.0 uC ...

我可以在 SW 中做些什么（为 linux2.6 创建补丁）以获得每帧 1 或 2 个额外的批量传输？

谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:19:09.193

由于物理 USB 硬件施加了限制，因此除非在传输的两侧实施压缩，否则无法加快传输速度。

即使那样，您也不太可能大大加快传输速度。

# ajax - 使用 AJAX/Jquery 从 SQL Server 2008 检索和更新数据

> ID：13357403
> 
> 赞同：4
> 
> 时间：2012-11-13T08:15:44.267
> 
> 标签：ajax, json, jquery, scripting, get

我目前正在进行一项新的开发，我真的需要我的项目有它需要的丝滑感觉，所以我想使用 Ajax 或 jQuery 从 SQL Server 2008 检索数据。我是 JSON 及其功能的新手。

这是html：

```
Enter Employee ID
<br />
<asp:TextBox ID="txtEmpId" runat="server"></asp:TextBox>&nbsp;
<br />
<input type="button" id="BtnSearch" runat="server" value="Search" />
<div id="emp" style="display: none; margin-top: 40px">
    ID:<span id="txtId"></span><br />
    Title:<span id="txtTitle"></span><br />
    Name:<span id="txtName"></span><br />
    Department:<span id="txtDepartment"></span><br />
</div> 
```

Ajax 是这样的：

```
<script type="text/javascript">
$(document).ready(function () {

    $("#MainContent_BtnSearch").click(function () {

        $("#emp").hide("slow");

        var empId = $("#MainContent_TxtEmpId").val();
        $.ajax({
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: "",
            data: "{'employeeId': '" + empId.toString() + "'}",
            success: function (data) {
                $("#txtId").html(data.d.ID);
                $("#txtName").html(data.d.FullName);
                $("#txtTitle").html(data.d.Title);
                $("#txtDepartment").html(data.d.Department);
                /// show employee details
                $("#emp").show("slow");
            },
            error: function () {
                alert("Error calling the web service.");
            }
         });
     });
}); 
```

有什么方法可以让我的代码变得更好，使其从 SQL Server 2008 中的数据库中获取数据，并且还能够更新该记录并保存数据库更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:01:21.163

您在 ajax 调用中的 URL 可能类似于：`Page.aspx/Method`so:`default.aspx/GetEmployeeById`并将其设为 Post

```
public class Employee
{
    // properties: ID, FullName, Title, Department
}

[WebMethod]
public static Employee GetEmployeeById(string employeeId)
{
  Employee emp = new Employee();
  string connect = "your connection string";
  string query = "SELECT * FROM Employees WHERE Id = @employeeId";

  using (SqlConnection conn = new SqlConnection(connect))
    {
      using (SqlCommand cmd = new SqlCommand(query, conn))
      {
        cmd.Parameters.AddWithValue("Id", employeeId);
        conn.Open();
        SqlDataReader rdr = cmd.ExecuteReader();
        if (rdr.HasRows)
        {
          while (rdr.Read())
          {
            // fill your employee object
          }
        }
      }
    }
  return emp;
} 
```

这只是一个示例，因此您的连接字符串和 sql 不应该真正使用此方法。还要确保你的`employeeid`参数有一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T05:21:04.633

` $('#sqlLoadPerson').sqlRun(); 我在 mojoportal 中工作，我通过调用函数 sqlRun(); 将 jquery 与 sql 连接起来；例如，我们可以取一个 div

我们必须使用这个 div id 并使用这个调用 sql run

这将执行程序，我们将在前端得到结果

# node.js - Winginx NPM 全局包文件夹

> ID：13357407
> 
> 赞同：1
> 
> 时间：2012-11-13T08:16:04.080
> 
> 标签：node.js, npm, winginx

我是 node.js 的初学者。实际上我的意图是在 Windows 上为开发 node.js 设置可移植环境。Wingnix 是很好的候选者，因为它包括 nginx、mysql 和 php。

我通过 -g （全局标志）安装 npm 包，但是，由于 C:\Winginx\nodejs\node_modules\npm 上的 npmrc 文件，它存储在我的 ${APPDATA}\npm 中

但是，正如在 Winginx for node.js 部分的文档中一样

> 如您所知，Node.js 支持包（模块）。全局包文件夹是 \winginx\nodejs\node_modules。
> 
> 包括 Node.js 包管理器 NPM、流行的 Node.js Web 框架 Express.js 和模板引擎 Jade。

这让我很困惑，我如何安装额外的全局包并管理它们？Winginx是否提供命令shell来管理？因为我在环境变量***中将 \winginx\nodejs***设置为路径，以便通过 Windows 中的 Bash/CMD 进行访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T14:32:25.697

使用这个 bat 文件：X:\winginx\nodejs\npm.cmd

# c - 单片机PIC16F877A c编码，同时控制占用传感器和光电二极管

> ID：13357410
> 
> 赞同：1
> 
> 时间：2012-11-13T08:16:16.720
> 
> 标签：c, microcontroller, sensors, pic

我目前正在做一个结合了 2 个传感器的原型，即 cytron 的 PIR 运动传感器。

和一个光电二极管（很小，有 3 条腿，型号未知）

原型的工作方式是，当没有光且有运动时，LED 会亮起。否则，它将关闭。

我已经编写了代码来分别测试两个传感器，它工作得很好。

当我结合 2 个代码时，我面临 LED 输出的问题。如下图所示：

```
//  include
//==========================================================================

 # include <pic.h>

 # include <htc.h>

//  configuration
//==========================================================================
__CONFIG (0x3F32);

//  define
//==========================================================================
 #define    sensor   RB3    
 #define    led      RA5
 #define led2    RB7
 #define light   RB5
 #define _XTAL_FREQ 4000000
 #define delay ms(x) _delay((unsigned long)((x)*(_XTAL_FREQ/4000.0)))

//  main function
//==========================================================================

void main(void)
{
//  unsigned long delay_time=5000;

TRISA = 0b00000000;
TRISB = 0b01111111;             //Configure Port B     as Input

ADCON1   =0B00000110;

led=0;
led2=0;
int i;

while(1)                    //Infinity Loop
{

    if(!light)
    {   
        if(sensor)
        {
            for(i=5;i>0;i--)
            {
                led2=0;
                led=1;
                __delay_ms(10000);
            }   
        }

        else if(!sensor)
        {   
            if (i>0)
            {   for(i=5;i>0;i--)
                {
                    led2=0;
                    led=1;
                    __delay_ms(10000);
                }
            }
            else if(i<=0)
            {
                led=0;  
                led2=1;
            }
        }
    }

    else if(light)
    {
        led=0;  
        led2=1;
    }

}
} 
```

我提前感谢您的帮助。请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T21:41:06.760

您声明变量 i 但随后不将其初始化为值（我不认为 C 编译器也将其初始化为 0，我不确定）。如果不是这样，那么想象以下场景：在执行的第一个开始：它是 (!light) 和 (!sensor)，它开始比较 i>0 或 i<=0 但什么是我最初？？

您只假设 if （传感器）主体至少执行了一次以给 i 一个初始值。我不知道您的程序要求或流程的详细信息，但我认为这是一个不安全且隐藏的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-10T15:08:45.713

虽然我不是 PIC micro 的专家，但我想知道您用于访问 RAx 和 RBx 的方法是否合适，即“led = 0”，而不是“led &= ~(1 << led)”或类似的东西。

您似乎也没有初始化“int i”变量，我认为这会导致 if 语句出现问题。

最好的祝福。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:38:54.363

怎么样：

```
while (1)
{
    led_on = 0;

    if (!light && !sensor)
    {
        if (led_on == 0)
        {
            /* Turn on LED... */
            led_on = 1;
        }
    }
    else if (led_on == 1)
    {
        /* Turn off LED... */
        led_on = 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:42:49.327

当我使用汇编语言处理 pic24 系列时，如果我需要连续分配 2 个端口，结果证明第二个分配不起作用（除非您使用三态缓冲区......我不知道确切的原因，但那是案例...）。无论如何...我想说的是，尝试在每个 led 值分配后延迟几毫秒，例如：

```
 for(i=5;i>0;i--)
        {
            led2=0;
            _delay_ms(50);
            led=1;
            __delay_ms(10000);
        } 
```

# php - 导出magento订单，自定义查询

> ID：13357418
> 
> 赞同：1
> 
> 时间：2012-11-13T08:17:02.580
> 
> 标签：php, database, magento-1.7

我需要以 magento 顺序导出以下订单信息。我需要查询来获取数据并将其导出到 csv 文件。任何人都可以帮忙吗？任何提示？

订单号、SKU、商品名称、数量、商品价格、总行价、每件商品的成本（不知道是不是自定义属性）、总行成本、订单总成本、运费、订单总价

例如

```
1001  SKU1 NAME_1 2 3.00 6.00 2.50 5.00 8.00 3.65 11.65

   SKU2 NAME_2 3 2.00 6.00 1.00 3.00 8.00 3.65 11.65 
```

其中#1001 是订单号 SKU1，SKU2 是该订单中的商品 2,3 是每件商品的数量 3.00 和 2.00 是每件商品的售价 6.00 是数量 x 售价 2.50 和 1.00 是每件商品的成本项目 5.00 和 3.00 是成本 x 数量 8.00 是 5 + 3（订单总额） 3.65 是运费 11.65 是订单总额

在此先感谢您的帮助

# android - 使用 phonegap 和 localnotification 插件在 android 中创建警报

> ID：13357422
> 
> 赞同：0
> 
> 时间：2012-11-13T08:17:16.457
> 
> 标签：android, cordova, alarm

我正在使用 phonegap 创建 Android 应用程序。我在这里使用插件 localnotification 在 android 的通知栏上成功创建了一个通知：[https ://github.com/phonegap/phonegap-plugins/tree/master/Android/LocalNotification](https://github.com/phonegap/phonegap-plugins/tree/master/Android/LocalNotification)

现在我想创建一个闹钟（一种时钟闹钟），我看到这个插件中的一些 .java 文件的标题带有 [alarm...]，我想我可以用这个插件做点什么。但我找不到这方面的例子。

请给我一些这类的例子。

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T03:00:48.183

在谷歌上搜索后，我看到 phonegap 不支持通知/警报。而安卓插件[localnotification]只支持在通知栏显示通知。而已。

也许为了显示警报，我们需要用一些 java 代码编写另一个插件，并使用教程如何在这里创建一个带有 phonegap 的插件：http: [//docs.phonegap.com/en/2.1.0/guide_plugin- development_android_index.md.html#Developing%20a%20Plugin%20on%20Android](http://docs.phonegap.com/en/2.1.0/guide_plugin-development_android_index.md.html#Developing%20a%20Plugin%20on%20Android)

# python - SCons 长命令行 TEMPFILE 与 MinGW

> ID：13357425
> 
> 赞同：5
> 
> 时间：2012-11-13T08:17:53.097
> 
> 标签：python, mingw, scons

我正在尝试在 Windows 上使用 SCons 和 MinGW 从 gcc 和 gfortran 对象构建一个共享库，但在最终链接期间，命令行太长，超过 18000 个字符。我知道我需要使用临时文件（响应文件？）来传递命令行，但我找不到让 SCons 直接执行此操作的方法。我在这个库中使用了 CMake，它在不受我干扰的情况下处理了响应文件。

SCons 似乎正在使用 CommandGeneratorAction 来生成共享库命令行。有没有办法告诉这个动作使用响应文件机制？还有另一种处理我忽略的长命令行的方法吗？

相关SConscript：

```
sqllib = env.SharedLibrary(target='fvssql', source=sqllib_sources, LIBS=['odbc32',])
ffelib = env.SharedLibrary(target='fvspncffe', source=ffelib_sources, LIBS=[sqllib,], LIBPATH=['.',])

fvsobjs = env.SharedObject(fvslib_sources)
fvsobjs = [obj for obj in fvsobjs if obj.get_suffix()=='.o']

fvslib = env.SharedLibrary(target='fvspnc', source=fvsobjs, LIBS=sqllib+ffelib, LIBPATH=['.',]) 
```

env.Dump() 的相关输出：

```
'SHLIBSUFFIX': '.dll',
'SHLINK': '$LINK',
'SHLINKCOM': <SCons.Action.CommandGeneratorAction object at 0x02DDF770>,
'SHLINKFLAGS': ['$LINKFLAGS', '-shared'], 
```

我可以在我的环境中准备命令行模板`env['SHLINKCOM']="${TEMPFILE('$SHLINK -o $TARGET ... $SOURCE')}"`，但这似乎很脆弱，如果可能的话，我更愿意让 SCons 处理它。

我尝试使用字符串替换`env['SHLINKCOM']='${TEMPFILE("%s")}' % (env['SHLINKCOM'],)`，但结果是一个不完整的命令行，现在无论如何都是响应文件。

**编辑**

我已经看到了[LongCmdLinesOnWin32](http://scons.org/wiki/LongCmdLinesOnWin32)解决方法。如果可能，我更愿意使用 TEMPFILE、TempFileMunge、命令行间接机制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T18:08:24.887

你看过[http://scons.org/wiki/LongCmdLinesOnWin32](http://scons.org/wiki/LongCmdLinesOnWin32)吗？看起来在链接阶段有一个关于长命令的确切问题的答案。

# c# - 使用 MVVM 模式验证 ViewModel 中绑定的 ObservableCollection

> ID：13357429
> 
> 赞同：5
> 
> 时间：2012-11-13T08:18:05.930
> 
> 标签：c#, wpf, mvvm

我是 MVVM 的新手，最近才开始遵循 MVVM 模式的第一个项目。我在尝试使用 IDataErrorInfo 接口验证 ObservableCollection 时遇到问题。我的 ObservableCollection 看起来像这样：

```
ObservableCollection<Magazine> magazineRepository;
    public ObservableCollection<Magazine> MagazineRepository
    {
        get { return magazineRepository; }
        set
        {
            if (value != null)
            {
                bladRepository = value;
                OnPropertyChanged("MagazineRepository");
            }
        }
    } 
```

我的 XAML 是这样的：

```
<ListBox x:Name="listMagazineRepository"
                 Grid.ColumnSpan="2"
                 ItemsSource="{Binding}" 
                 DataContext="{Binding MagazineRepository}"
                 DisplayMemberPath="Navn" 
                 SelectedItem="{Binding Path=SelectedItem}"/>

        <TextBox x:Name="txtName" Grid.Row="1" Grid.Column="0"
                    Text="{Binding ElementName=listMagazineRepository, Path=SelectedItem.Navn, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" />
        <TextBox x:Name="txtPrice" Grid.Row="2" Grid.Column="0"
                    Text="{Binding ElementName=listMagazineRepository, Path=SelectedItem.Pris, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /> 
```

它只是一个包含对象的简单列表框，当您选择一个项目时，所选对象的属性会显示在文本框中，然后绑定到列表框对象。

我的问题是，当我像这样设置我的代码时，我能弄清楚如何验证我的数据的唯一方法是在域模型中，这真的不是一个好习惯，我想在 ViewModel 中验证在它到达那里之前。基本上，我想在 ViewModel 中验证 MagazineRepository 中的每个属性，你会怎么做呢？

PS：如果我的问题缺乏信息，我是在这个板上（以及一般的编程板）发帖的新手，请告诉我，我会提供所需的详细信息。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T10:37:15.920

如果我理解正确，您想验证 Magazine 对象。如果是这种情况，一种方法是将该类包装在一个视图模型中，我们称之为 MagazineVM，它实现了 IDataErrorInfo 并保持杂志对象的更新。然后将 MagazineVM 列表绑定到视图。作为一个非常简单的例子：

```
public class MagazineVM : IDataErrorInfo, INotifyPropertyChanged
{
   private Magazine _magazine;

   public int FirstMagazineProperty
   {
      get { return _magazine.FirstMagazineProperty; }
      set { _magazine.FirstMagazineProperty = value; RaisePropertyChanged("FirstMagazineProperty"); }
   }

   //INotifyPropertyChanged implementation

   //IDataErrorInfo implementation
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-29T12:16:38.790

首先，正如 Dtex 所说，您应该使用 MagazineViewModel 类而不是 Magazine 类。例如

```
public class MagazineViewModel : INotifyPropertyChanged, IDataErrorInfo
{
  private string navn;
  private string pris;
  private string error;

  public string Navn
  {
    get { return navn; }
    set
    {
      if (navn != value)
      {
        navn = value;
        RaisePropertyChanged("Navn");
      }
    }
  }
  public string Pris
  {
    get { return pris; }
    set
    {
      if (pris != value)
      {
        pris = value;
        RaisePropertyChanged("Pris");
      }
    }
  }
  public string Error
  {
    get { return error; }
    set
    {
      if (error != value)
      {
        error = value;
        RaisePropertyChanged("Error");
      }
    }
  }

  public event PropertyChangedEventHandler PropertyChanged;

  public string this[string columnName]
  {
    get
    {
      var result = string.Empty;

      switch (columnName)
      {
        case "Pris":
          if (string.IsNullOrWhiteSpace(Pris))
          {
            result =  "Pris is required";
          }
          break;
        case "Navn":
          if (string.IsNullOrWhiteSpace(Navn))
          {
           result =  "Navn is required";
          }
          break;
      }

      return result;

    }
  }

  private void RaisePropertyChanged(string PropertyName)
  {
    var e = PropertyChanged;
    if (e != null)
    {
      e(this, new PropertyChangedEventArgs(PropertyName));
    }
  }

} 
```

需要注意的重要属性是“public string this[string columnName]”。ColumnName 将是您的绑定属性之一，您可以在此处进行验证。

接下来要考虑的是您的 MainViewModel（您的 DataContext）。例如

```
public class MainViewModel : INotifyPropertyChanged
{
  //Use a readonly observable collection. If you need to reset it use the .Clear() method
  private readonly ObservableCollection<MagazineViewModel> magazines = new ObservableCollection<MagazineViewModel>();

  private MagazineViewModel selectedItem;

  //Keep the item being edited separate to the selected item
  private MagazineViewModel itemToEdit;

  public ObservableCollection<MagazineViewModel> Magazines { get { return magazines; } }
  public MagazineViewModel SelectedItem
  {
    get { return selectedItem; }
    set
    {
      if (selectedItem != value)
      {
        selectedItem = value;
        RaisePropertyChanged("SelectedItem");
        //When the selected item changes. Copy it to the ItemToEdit
        //This keeps the the copy you are editing separate meaning that invalid data isn't committed back to your original view model
        //You will have to copy the changes back to your original view model at some stage)
        ItemToEdit = Copy(SelectedItem);
      }
    }
  }
  public MagazineViewModel ItemToEdit
  {
    get { return itemToEdit; }
    set
    {
      if (itemToEdit != value)
      {
        itemToEdit = value;
        RaisePropertyChanged("ItemToEdit");
      }
    }
  }

  public event PropertyChangedEventHandler PropertyChanged;

  public MainViewModel()
  {
    //Ctor...
  }

  //Create a copy of a MagazineViewModel
  private MagazineViewModel Copy(MagazineViewModel ToCopy)
  {
    var vm = new MagazineViewModel();
    vm.Navn = ToCopy.Navn;
    vm.Pris = ToCopy.Pris;
    return vm;
  }

  private void RaisePropertyChanged(string PropertyName)
  {
    //...
  }
} 
```

这里唯一缺少的是如何将更改复制回原始视图模型。您可以在所选项目更改之前执行此操作（如果 ItemToEdit 有效），或者有一个仅在 ItemToEdit 有效时启用的提交按钮。如果您可以让原始视图模型进入无效状态，则无需担心复制。

最后是 XAML

显示错误工具提示的隐式样式

```
<Style
  TargetType="{x:Type TextBox}">
  <Setter
    Property="ToolTip"
    Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors)[0].ErrorContent}" />
</Style> 
```

以及控件和绑定

```
<ListBox
  ItemsSource="{Binding Magazines}"
  DisplayMemberPath="Navn"
  SelectedItem="{Binding Path=SelectedItem, Mode=TwoWay}" />
<TextBox
  Margin="5"
  x:Name="txtName"
  Grid.Row="1"
  Grid.Column="0"
  Text="{Binding ItemToEdit.Navn, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" />
<TextBox
  Margin="5"
  x:Name="txtPrice"
  Grid.Row="2"
  Grid.Column="0"
  Text="{Binding ItemToEdit.Pris, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /> 
```

文本框绑定到 ItemToEdit。ItemToEdit 将是 SelectedItem 的同步副本。

# css - 浏览器在减小尺寸时弄乱了侧边栏

> ID：13357433
> 
> 赞同：1
> 
> 时间：2012-11-13T08:18:46.537
> 
> 标签：css, wordpress, sidebar

[http://rusticblonde.hostizzo.com/](http://rusticblonde.hostizzo.com/)

你好呀，

请有人帮忙。我已经在具有％边距等的“浮动”样式上完成了此操作......但是当例如我调整浏览器的大小时，侧边栏变得一团糟......

这是我的 CSS 标记

```
#MainContent {
width: 53%;
float: left;
margin-left: 110px;
margin-top: -247px;
padding-top: 0px;
background-color: #ffffff;
font-family: verdana;
padding-left: 10px;
padding-right: 10px;
font-weight: 100;
font-size: 8pt;
color: #000000;
}
#rightsidebar {
background-color: #ffffff;
width: 26%;
float: left;
margin-left: 15px;
margin-top: -247px;
}
 #FooterWrapper {
width: 81.2%;
clear:both;
height: 20px;
background-color: #145618;
color: #ffffff;
margin-top: 0px;
margin-left: 110px;
padding-bottom: 10px;
}
 #chunkyfooter {
 clear: both;
overflow: hidden;
width: 81.2%;
padding-top: 8px;
margin-left: 110px;
text-align: center;
font-family: verdana;
font-size: 10px;
} 
```

任何想法如何解决这一问题？

谢谢 ：）

柯斯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:47:53.797

尽量不要在同一个元素中混合两个单元，也许这就是你的问题的原因。有些人喜欢混合使用两种单位，像素和百分比，但我总是尽量使用像素。

我的建议是，选择你最喜欢的那个并坚持下去，只要你不在同一个元素中混合不同的单位，你应该没问题。

# ruby-on-rails - 是否有与 inverse_of 相关的成本？我们是否应该尽可能将其添加到关系中？

> ID：13357436
> 
> 赞同：10
> 
> 时间：2012-11-13T08:18:56.870
> 
> 标签：ruby-on-rails, ruby-on-rails-3

rails 方法 :inverse_of 可用于在对象之间建立内存关联，从而可以减少数据库中的查询：http: [//mediumexposure.com/better-memory-associations-inverseof/](http://mediumexposure.com/better-memory-associations-inverseof/)

与 inverse_of 相关的成本是多少？为什么我们不对存在的每个关系都写 inverse_of 以减少查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-09T15:16:09.447

摘自 Ernie Miller[在 Railsconf 2013 的演讲](http://www.confreaks.com/videos/2460-railsconf2013-an-intervention-for-activerecord)（大约 15:30）

> [...] inverse_of 是您没有使用的最古老的 ActiveRecord 功能，您完全应该使用。[...]

# c# - 表格自行关闭

> ID：13357442
> 
> 赞同：0
> 
> 时间：2012-11-13T08:19:23.903
> 
> 标签：c#, winforms, visual-studio-2012

我是 C# 新手（从 Java 切换），我在理解 C# 中的 GUI 时遇到了一些麻烦

生病只是粘贴我的代码，让它解释大部分。

主类：

```
 Frame frame;
 keepRunning = true;

 public GraphicsComponent()
 {
     frame = new Frame();
     frame.Show();
 }

 public void run()
 {
    while (keepRunning)
    {
       Console.WriteLine("Running");
    }
 }

 public static void Main()
 {
    GraphicsComponent gameComponent = new GraphicsComponent();

    gameComponent.run();
} 
```

使用 frame.Show() 方法，它会出现和消失一会儿。但是“运行”循环正在运行。

我看到的另一种方法是另一种称为 ShowDialoge() 的方法，它使窗口保持打开状态，但阻止其余代码运行，直到它关闭。

我想使用它的方式基本上是 GUI 在 Java 中的工作方式。我可以在其余代码中根据需要引用对象（及其组件）。

多谢！

编辑：有很多混乱，所以这是我的 Frame 类：

```
public partial class Frame : Form
{
    public Frame()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:26:48.787

启动 winforms 应用程序的正常方法是通过 file->new winforms project。执行此操作时，您将获得“Program.cs”，其中包含您的 Main 方法 - 应用程序的入口点。从那里你有这样的代码：

```
 [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new ConfigForm());
    } 
```

在这个例子中，我启动了一个新的“ConfigForm”，它是一个表单，并在它的 ctor 中包含一些看起来像这样的代码：

```
 public ConfigForm()
    {
        InitializeComponent();

        // Other init work here

    } 
```

我通过右键单击项目并添加新表单来创建表单。

您可能想研究该`Application.Run`方法，请参见[此处](http://msdn.microsoft.com/en-us/library/ms157900.aspx)。您可以指定一个“主窗体”，它将成为在应用程序期间运行的主窗体，以及在关闭时结束应用程序，或者您可以根据需要指定其他选项。也许最简单的解决方案是启动一个主窗体，并且由于该窗体在应用程序期间处于活动状态，因此您可以在该窗体内启动其他长时间运行的代码。如果您希望一直执行某种后台操作的代码，那么您可能希望在它自己的线程中触发它。但是，线程很难，所以如果您不熟悉 c# / .net，除非您需要，否则我会尽量远离线程。

# tfs - 是否可以从 vs2012 连接到 tfs 2005 服务器？

> ID：13357449
> 
> 赞同：1
> 
> 时间：2012-11-13T08:20:02.593
> 
> 标签：tfs, visual-studio-2012, tfs-2005

我们有一个带有一些旧代码的 TFS 2005 服务器，我得到了 VS2012。是否可以从 VS2012 连接到 TFS 2005 服务器？还是我需要安装 TFS explorer 2010？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:53:10.540

TFS 兼容性矩阵 - [http://msdn.microsoft.com/en-us/library/vstudio/dd997788.aspx](http://msdn.microsoft.com/en-us/library/vstudio/dd997788.aspx)

根据上面的链接，VS2012 和 VS2010 都无法连接到 TFS 2005。

您可能需要使用 MSSCCI 提供程序。

# iphone - 是否可以进行 for 循环更改属性

> ID：13357451
> 
> 赞同：0
> 
> 时间：2012-11-13T08:20:12.430
> 
> 标签：iphone, objective-c, xcode

正如问题所问的那样，我想知道是否有可能通过 for 循环的 int 更改属性。

例子：

控制器.h：

```
 @property (weak, nonatomic) IBOutlet UILabel *lblTeamName1;
 @property (weak, nonatomic) IBOutlet UILabel *lblTeamName2;
 @property (weak, nonatomic) IBOutlet UILabel *lblTeamName3; 
```

控制器.m

```
 @synthesize property lblTeamName1;
 @synthesize property lblTeamName2;
 @synthesize property lblTeamName3;     

 for(int i = 0;i <= 3;i++)
 {
  lblTeamName(i).text = @"something";
 } 
```

我要问的是一种可行的方法，我不知道这是否可行或无法完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:26:08.367

您可以将属性放在一个`NSMutableArray`和循环中。

```
NSMutableArray *arr = [[NSMutableArray alloc] init];
[arr addObject:lblTeamName1];
[arr addObject:lblTeamName2];
[arr addObject:lblTeamName3];

for(UILabel *label in arr) {
  label.text = @"something";
} 
```

我不是 100% 确定，但我认为没有像 Java 反射这样的东西，您可以手动获取定义的属性并更改值。所以你必须使用一个额外的数组来获得这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:29:09.873

你可以做这样的事情......

```
for (int i=1; i<4; i++) {
    UILabel *label = [self objectForKey:[NSString stringWithFormat:@"lblTeamName%i", i]];
    label.text = @"blah";
} 
```

这将依赖于标签的标准命名约定。

哦，还有，只是一个注释。您不再需要输入@synthesize。如果您使用的是 Xcode 4.5，那么他们不再需要使用 @synthesize。如果它被忽略，编译器会推断它。

# php - 如何在php中检测字符串中的Json

> ID：13357452
> 
> 赞同：0
> 
> 时间：2012-11-13T08:20:15.030
> 
> 标签：php, arrays, json

我遇到了一个问题，我有一个包含完整描述的字符串以及一个包含一些 Id 的 json。如何将 Json 从字符串中取出并对其执行任何事件..

我的数据如下所示

```
The description of xxxxxxxxxxxxxxxxxxxxxxxxxx
[{"id":"613"},{"id":"614"},{"id":"615"}] 
```

有什么方法可以让我拥有完整的描述并拥有 ID，以便我可以解码它们并在我想要的地方使用？

预先感谢您的支持

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:26:03.203

尝试这个

```
$string = 'The description of xxxxxxxxxxxxxxxxxxxxxxxxxx    [{"id":"613"},{"id":"614"},{"id":"615"}] asdasd';

if(false !== preg_match('/\[(.*)\]/', $string, $matches)) {
    for($n = 1; $n < count($matches); $n++) {
        $json_result = json_decode('['.$matches[$n].']', true);
        if(null === $json_result) {
            //cannot parse json
        }
        print_r($json_result);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:28:18.823

如果您的 json 在新行中，这将找到具有 JSON 代码的第一行！！！

```
$string = 'The description of xxxxxxxxxxxxxxxxxxxxxxxxxx
[{"id":"613"},{"id":"614"},{"id":"615"}]';
$strings = explode("\n",$string);

foreach($strings as $str){
    $json = json_decode($str,TRUE); //TRUE for array responde
    if(!empty($json)){
       break;
    }
}

var_dump($json); 
```

# google-maps - 加速谷歌地图渲染

> ID：13357453
> 
> 赞同：1
> 
> 时间：2012-11-13T08:20:16.377
> 
> 标签：google-maps, optimization, rendering

谷歌地图的渲染速度取决于什么，优化它的最佳方法是什么？

在那个问题中，我们假设互联网连接/浏览器没有问题……更多的是关于如何优化渲染的一般情况。

谷歌地图的呈现是在一个网站 (mydomain.com) 中完成的。

# ruby-on-rails - 作用域的使用方法

> ID：13357454
> 
> 赞同：0
> 
> 时间：2012-11-13T08:20:25.047
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我可以使用某种方法作为范围吗？例如。我创建了检查来自json的参数的方法，然后根据参数从数据库中查询一些数据并用作默认范围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:30:56.410

我猜问题是，普通方法作为实例方法，而作用域方法作为类方法

```
class MyClass

  def self.klass_method

  end

  def ins_method

  end 

end

Myclass.klass_method => will work
Myclass.ins_method   => will not work
Myclass.new.ins_method  => will work 
```

尝试将您的普通方法变成类方法

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T10:23:49.837

范围方法是类方法，应该返回范围。

您可以使用程序范围，因为您的范围会根据参数进行更改：

```
scope :colored, lambda { |color| where(:color => color) } 
```

并像这样使用它：

```
Product.colored("red") 
```

但问题是 Rails 不接受过程范围作为默认范围。

# php - inmobi API 使用示例

> ID：13357455
> 
> 赞同：0
> 
> 时间：2012-11-13T08:20:30.263
> 
> 标签：php, curl, inmobi

我必须开发一个应用程序来与 inmobi API 交互。我尝试了一些代码但失败了。请帮助我如何使用 API。

它的 API 文档 URL 是[http://developer.inmobi.com/wiki/index.php?title=API_Guide_for_Onboarding_Publishers#API_Key](http://developer.inmobi.com/wiki/index.php?title=API_Guide_for_Onboarding_Publishers#API_Key)

我正在尝试创建需要在标头中发送值的会话。我也尝试了带有帖子数据和标题的以下代码，但失败了。没有得到所需的输出。

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://api-sandbox.inmobi.com/v1.0/generatesession/generate");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, true);

$data = array(
    'username' => 'xxxxxxx',
    'password' => 'xxxxx',
    'secretKey' => 'xxxx',
    'Content-type'=> 'application/json'
);
//curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_HTTPHEADER,  $data);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch);
echo "<pre>";
print_r( $info); 
```

如果我对方式有疑问，请建议一些合适的方法。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:28:26.847

您的代码中有两个问题：

1）“https://api-sandbox.inmobi.com/v1.0/generatesession/generate”的方法不是POST，是GET方法

2) CURLOPT_HTTPHEADER 需要一个数组，而不是键值对。

示例代码：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://api-sandbox.inmobi.com/v1.0/generatesession/generate");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
//curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HEADER,  truea);
$data = array(
    'username: XXXXXXXX',
    'password: XXXXXXXX',
    'secretKey: XXXXXXXXXXXXXXX'
);
//curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_HTTPHEADER,  $data);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch);
echo "<pre>";
print_r( $info);
print_r($output); 
```

# jquery - 追加 至 jQuery手机

> ID：13357456
> 
> 赞同：0
> 
> 时间：2012-11-13T08:20:45.950
> 
> 标签：jquery, listview, dynamic, html-lists, append

我有 2 个带有列表的可折叠 div。每个列表都应该动态显示 JSON 信息。我有以下 HTML：

```
<body>
    <div data-role="collapsible-set" data-theme="c" id="set">
        <div data-collapsed="true" data-role="collapsible" data-theme="b" id="trip1">
            <h3>Trip 1</h3>
            <ul data-role="listview" id="info1">
                <li>Name 1</li>
            </ul>
        </div>
        <div data-collapsed="true" data-role="collapsible" data-theme="b" id="trip2">
            <h3>Trip 2</h3>
            <ul data-role="listview" id="info2">
                <li>Name 2</li>
            </ul>
        </div>
    </div>
</body> 
```

和以下脚本：

```
<script>
    $(function() {
        $('#trips').collapsible();
    });
    $.getJSON('http://141.219.205.44:8080/json/trip/list', function(data) {

        for ( var i = 0; i < 2; i++) {
             $('#info1 ul').append('<li>' + data[i].name + '</li>').listview('refresh');
        }

</script> 
```

我知道它可以很好地检索 JSON 数据，但我无法将它附加到 !

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:23:13.193

`$('#info1 ul')`不存在它试图找到一个名为 #info1 的元素，其中包含一个 ul 删除 ul 并将其附加到`ul#info1`.

数据对象是什么样子的？你确定你的数据中有那么多项目（0-1）吗？

在您的 dom-ready 方法周围添加 getJSON 以确保 DOM 已加载：

```
$(function() {
    $('#trips').collapsible();
    $.getJSON('http://141.219.205.44:8080/json/trip/list', function(data) {
        for ( var i = 0;l=data.length; i < l; i++) {
            $('#info1').append('<li>' + data[i].name + '</li>').listview('refresh');
        }
    }
}); 
```

# ios5 - 如何从所选项目中隐藏标签栏的白色阴影

> ID：13357463
> 
> 赞同：1
> 
> 时间：2012-11-13T08:21:14.950
> 
> 标签：ios5, uitabbarcontroller, uitabbar, uitabbaritem

有没有办法从它的选定项目中隐藏 UITabBar 的阴影颜色。

出于某种原因，我根据选定的标签索引将不同的背景图像分配给标签栏，而不是将图像分配给单个标签。所选选项卡后面有白色阴影。我们可以禁用或删除这个阴影吗？

![在此处输入图像描述](../Images/d39fffefa70f80e6d39c8f41d2c3f543.png)

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-25T19:09:07.493

您不需要创建透明图像。这就是你所需要的：

```
[[UITabBar appearance] setSelectionIndicatorImage:[[UIImage alloc] init]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T13:40:08.797

对于 iOS 5+

在 AppDelegate 中设置类似：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [[UITabBar appearance] setSelectionIndicatorImage:[UIImage imageNamed:@"transparent_image.png"]];

    return YES;
} 
```

其中 transparent_image.png 是一个完全透明的图像 =)

不知道这是否是我最近开始使用 iOS 以来的最佳方法，但认为这可以帮助您。

# javascript - 如何在 jquery if 语句中获取我的标签 ID？

> ID：13357464
> 
> 赞同：0
> 
> 时间：2012-11-13T08:21:18.533
> 
> 标签：javascript, jquery, html

我有这个为数组中的每个数据条目生成标签的for循环吗？我现在需要做的是编写一个 if 语句来检查是否单击了某个标签，因为只有一个 id 中包含更多数据以显示在下一页中，对于其余按钮，我只想弹出警报说没有可用的数据！以下是结果图片和实际代码！

图片： ![在此处输入图像描述](../Images/1f905641c3dd28d4046c6b7cc2afd475.png)

我只想购买杂货标签的 ID 转到下一页，其余的应该发出警报！

这是代码：

```
 $(document).ready(function() {
    $.getJSON("http://41.134.206.60/wf7_api/api/inbox/johnny", function(data){
        for(var i = 0; i < data.length; i++) {
        var high = data[i].High;
        var medium = data[i].Medium;
        var low = data[i].Low;
        var sum = high + medium + low;
        $("#showdata").html("tasks");
        $("#shownames").append("<label id="+ data[i].ProcessID +" onclick="+"redirectme();"+" style="+"text-align:center;"+"font-size:x-large;"+">"+ data[i].ProcessName +"</label><label style="+"font-size:x-large;"+">("+sum+")</label><labels class="+"lowpic"+" id="+"righty"+">"+low+"</labels><labels class="+"mediumpic"+" id="+"righty"+">"+medium+"</labels><labels class="+"highpic"+" id="+"righty"+">"+high+"</labels></br>");
        };
    } , 'json');
});​

function redirectme(){
var r = document.getElementById("76");

window.location.href = "Datapage.html";
} 
```

当前发生的情况是每个标签都将转到 Datapage.hmtl，我只希望具有特定 id 的一个标签转到 datapage.html，其余的应该发出警报？我该怎么做？我是新来的！

使用cordova/html5/javascript/jquery/visual studio 2010

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:41:47.970

整个代码部分都需要重写，但如果您只需要它工作，那么这就是您需要更改的内容：

```
$("#shownames").append("<label id="+ data[i].ProcessID +" onclick="+"redirectme(" + data[i].ProcessID + ");"+" style="+"text-align:center;"+"font-size:x-large;"+">"+ data[i].ProcessName +"</label><label style="+"font-size:x-large;"+">("+sum+")</label><labels class="+"lowpic"+" id="+"righty"+">"+low+"</labels><labels class="+"mediumpic"+" id="+"righty"+">"+medium+"</labels><labels class="+"highpic"+" id="+"righty"+">"+high+"</labels></br>"); 
```

和处理功能：

```
function redirectme(processId){
    if(processId == 76)
    {
        window.location.href = "Datapage.html";
    } else {
        // write your logic to show the popup or w/e.
    }
} 
```

如果您有兴趣，我很高兴以一种更容易维护和更改的方式为您做一个小提琴，只需在下面发表评论即可。

# c# - Windows 8 应用 FileNotFound 异常

> ID：13357465
> 
> 赞同：0
> 
> 时间：2012-11-13T08:21:26.437
> 
> 标签：c#, exception, windows-8

我正在使用 Visual Studio 2012 Ultimate 在 C# 中编写一个 Windows 8 应用程序。

当尝试加载存储在资产文件夹中的图像资源时，我总是收到异常 FileNotFoundException “系统找不到指定的文件。（HRESULT 中的异常：0x80070002）”即使该文件存在于 /Assets 文件夹中该项目。

```
 private async void LoadImage(string ImageFile)
    {
        Uri imageUri = new Uri("ms-appx:///Assets/Apple.jpg");

        StorageFile pictureFile = await StorageFile.GetFileFromApplicationUriAsync(imageUri);

        BitmapImage bitmap = new BitmapImage();

        bitmap.SetSource(await pictureFile.OpenAsync(FileAccessMode.Read));

        imgPicture.Source = bitmap;
    } 
```

任何人都可以看到有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:26:46.737

没关系，我找到了解决方案。您似乎只能访问已添加到项目中的文件。然而，这是有道理的。

# email - 如何在 Jenkins 电子邮件报告中呈现单元测试图？

> ID：13357466
> 
> 赞同：6
> 
> 时间：2012-11-13T08:21:41.563
> 
> 标签：email, junit, jenkins, report, surefire

我正在使用 Jenkins 来执行我们的单元测试并向开发人员发送电子邮件。我正在使用 Jelly Script 将通过/失败结果包含在电子邮件中。但是，我还想包括在您的测试构建完成后，surefire 报告向您显示的通过/失败图表。毕竟，这是我们感兴趣的图表，对吧？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T14:53:44.860

如果您的邮件是 html 格式，那么您可以通过以下 url 访问图像：

[JENKINS_URL]/job/[JOB_NAME]/test/trend

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T21:51:01.637

顺便说一句，非常有用的问题。现在没有人阅读 :) 无论如何，从心理学的角度来看，使用图形形式确实更好，所以有几种方法可以实现这一点。

**解决方案 #1 - 放置链接或参考**

使用正确的 URL 放置链接或图像标签很容易（正确的 URL 是 Shurik 建议的），但是您必须将 Jenkins 公开才能让您的收件人看到该图像。顺便说一句，这是一种非常危险的方法。

**解决方案 #2 - 上传图片**

将图像上传到一些公共图像托管并遵循解决方案 #1。

**解决方案 #3 - 附加图像**

这个想法是将编码图像放在电子邮件的单独部分中。Jenkins 将生成图像（可以通过 URL 访问），因此您可以对其进行编码并包含在您的邮件中。[更多细节](http://www.campaignmonitor.com/blog/post/1759/embedding-images-revisited/)和例子：

![在此处输入图像描述](../Images/7b953992950af4cbebf72e91cbeefc81.png)

# c# - 如何从父级访问嵌套的用户控件视图模型

> ID：13357471
> 
> 赞同：1
> 
> 时间：2012-11-13T08:22:26.710
> 
> 标签：c#, wpf, mvvm

我有一个用户控件，说一个我想在其他几个控件中重用的键盘。键盘响应 INotifyPropertyChanged 但我想捕获父控件中的更改以更新其中的文本框。

我试图从父视图模型访问控件，但这不是使用 MVVM 执行此操作的正确方法。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:45:51.493

我认为你有点混淆了想法。

MVVM 方式是有两个视图模型和两个视图。

`MasterControlViewModel`&`MasterControlView`

`KeypadControlViewModel`&`KeypadControlView`

`MasterControlViewModel`将订阅在`KeypadControlViewModel`.

但是，您似乎推断这`KeypadControl`只是一个标准控件，没有自己的视图模型。考虑到它与视图的密切关系（它提供键盘输入，插入取决于光标所在的位置等），这将是有意义的。如果是这种情况，拥有一个“目标”依赖属性可能更合适，`KeypadControl`该属性可以绑定到`MasterControlView`. 当一个键被点击时，它`KeypadControl`只是更新目标控件，或者，可能更好的是，它可以触发键盘 RoutedEvents，它会像真正的键盘事件一样沿着可视化树向上移动，从而不需要目标属性。

这样，您的所有输入内容都会在视图中处理，并且`MasterControlViewModel`唯一关心的是字符串已更改的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:28:08.013

我想说，如果你想做 MVVM 风格，那么键盘控件应该公开一个 ICommand 属性，命令本身由父级提供，并在单击某个键时执行该命令。

该命令将获取在命令参数中单击的键。

实际的命令实现将在父控件中（您可以为此使用[RelayCommand 模式](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090030)），然后可以更新其 TextBox。

键盘类应包括如下内容：

```
class Keypad : UserControl
{
     ...
     public DependencyProperty OnKeypadKeyClickedCommandProperty = ... ;
     ...
     void OnZeroButtonClicked(object sender, RoutedEventArgs e)
     {
         OnKeypadKeyClickedCommand.Execute(this, new SomeKeyIdentifier('0'));
     }
     ...
} 
```

XAML 应包括如下内容：

```
<local:Keypad OnKeypadKeyClickedCommand="{Binding HandleKeypadKeyClickCommand, ElementName=parentControlName}" /> 
```

父控件中的实现应该是这样的：

```
class ParentControl : ...
{
    DependencyProperty HandleKeypadKeyClickCommand = ...;

    void Init()
    {
        HandleKeypadKeyClickCommand = new RelayCommand(new Action<SomeKeyIdentifier>(DoKeyPress));
    }
    ...
    void DoKeyPress(SomeKeyIdentifier key)
    {
         _Textbox.Text += key.Char;
    }
    ...
} 
```

# javascript - 为什么“this”在闭包中被捕获？

> ID：13357478
> 
> 赞同：0
> 
> 时间：2012-11-13T08:22:52.523
> 
> 标签：javascript

如果我创建一个变量，比如 _this，并将其分配给 this，它会被捕获为一个闭包，而不是对 this 的当前版本的引用。为什么？

示例代码：

```
var AnimCore = (function () {
    function AnimCore(ctx) {
        this.ctx = ctx;
    }
    AnimCore.prototype.beginAnimation = function () {
        this.animLoop();
    };
    AnimCore.prototype.animLoop = function () {
        var _this = this;
        this.ctx.drawSomething(); // removed actual drawing code, this is a proxy for it.
        window.setTimeout(function () {
            _this.animLoop();
        }, 1000 / 60);
    };
    return AnimCore;
})(); 
```

在这种情况下，每次调用函数时，_this 都绑定到初始 this 而不是新的 this。为什么？

[更新] 我现在明白，闭包发生在匿名函数中，这就是为什么 _this 总是指同一件事。然而，下一个问题是为什么 this.ctx 每次都有效？如果我不使用匿名函数，它会在第一次之后失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:34:25.580

`this`是一个特殊的变量。它很特别，因为它的上下文是在您调用`this`内部函数时确定的。

但是，如果您要`this`在闭包内分配给变量：

```
var myFunc = (function () {
    var staticThis = this;
    return function () {
        staticThis.doStuff();
    };
}).call(myObj); 
```

看看我做了什么？
我有一个名为 的变量`staticThis`，我明确将其设置为等于`myObj`。
`staticThis`保留 的***值***（`this`恰好是指向特定对象的指针），而不是保留`this`为`this`关键字保存的“神奇”动态上下文解析。

# symfony - SonataAdminBundle 与 sonata_type_collection 并上传图片

> ID：13357482
> 
> 赞同：5
> 
> 时间：2012-11-13T08:23:05.190
> 
> 标签：symfony, symfony-2.1, symfony-sonata, sonata-admin

在 Sonata Admin 中，我想在 sonata_type_collection 中使用上传和预览图片文件。

在我的 Admin/ItemAdmin.php ：

```
class ItemAdmin extends Admin
{

    protected function configureFormFields(FormMapper $formMapper)
    {
        $formMapper
            ->add('title')
            ->with('Photos')
            ->add('pictures', 'sonata_type_collection', array(
                'label' => 'Pictures',
                'by_reference' => false,
                'required' => false,
                ), array(
                'edit' => 'inline',
                'inline' => 'table',
                'sortable' => 'id'
            ))
            ->end()
        ;
    } 
```

在我的 Admin/ItemPictureAdmin.php 中：

```
class ItemPictureAdmin extends Admin {

    protected function configureFormFields(FormMapper $formMapper) {
        $obj = $this->getSubject();

        $formBuilder = $formMapper->getFormBuilder();

        if(is_object($obj) && $obj->getPicture())
        {   
            $formMapper
            ->add('picturePreview', 'image_preview', array(
                'required' => false,
                'property_path' => false,
                'upload_dir' => '/uploads/picture/',
                'file_name' => $obj->getPicture()
            ));
        }
        $formMapper->add('pictureFile', 'file', array('label' => 'Pic'));
    } 
```

“image_preview”类型是我用一个简单的模板树枝创建的一种新类型，用于显示图片。

预览：http: [//i.stack.imgur.com/AC0ih.png](https://i.stack.imgur.com/AC0ih.png)

问题 1：我在数据库中记录了两张图片，其中包含两个不同的图片文件，但在列表中，它只显示第一张。

问题2：无法更新图片...我必须删除记录并重新上传新文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-25T09:11:41.237

我自己碰到了问题 1。我尝试了所有可能的解决方案，但没有任何效果。我尝试了一些解决方案，其中一个很好。
我做了什么：

*   我在会话中保存了子实体的索引（在您的情况下为 ItemPictureAdmin），当我需要一个实体时，我会从会话中获取索引并从父实体的列表中获取具有该索引的元素。

*   首先，我保存在会话索引 0 中，在 ItemPictureAdmin 中，我使用索引 0 访问他的 ItemPictureAdmin 父列表

*   在此之后，我增加了会话中的索引。从列表中获取所有元素后，我删除了保存索引的会话参数。

该解决方案是对 caponica 解决方案的[改编](https://stackoverflow.com/questions/18106502/how-to-get-child-object-in-embedded-admin-class-in-sonata-admin/22815329#22815329)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T15:02:40.463

我有同样的问题，我可以通过“自定义表单类型扩展”来做到这一点，链接“ [http://symfony.com/doc/current/cookbook/form/create_form_type_extension.html](http://symfony.com/doc/current/cookbook/form/create_form_type_extension.html) ”上给出了文档。

这是完美的解决方案..

# hibernate - 如何在 JPA 2 实体中映射 postgresql“带有时区的时间戳”

> ID：13357487
> 
> 赞同：35
> 
> 时间：2012-11-13T08:23:56.817
> 
> 标签：hibernate, postgresql, jpa, jpa-2.0

我有一个使用 Postgresql（带有 9.0-801.jdbc3 JDBC 驱动程序）的 JPA 2 应用程序（使用 Hibernate 3.6 作为 JPA 实现）。

我无法将“带有时区的时间戳”字段映射到我的 JPA 实体中。

这是一个例子：

```
CREATE TABLE theme
(
  id serial NOT NULL,
  # Fields that are not material to the question have been edited out
  run_from timestamp with time zone NOT NULL,
  run_to timestamp with time zone NOT NULL,
  CONSTRAINT theme_pkey PRIMARY KEY (id ),
  CONSTRAINT theme_name_key UNIQUE (name )
) 
```

我试图映射如下：

```
@Entity
@Table(schema = "content", name = "theme")
public class Theme extends AbstractBaseEntity {
    private static final long serialVersionUID = 1L;

    @Column(name = "run_from")
    @NotNull
    @Temporal(TemporalType.TIMESTAMP)
    private Date runFrom;

    @Column(name = "run_to")
    @NotNull
    @Temporal(TemporalType.TIMESTAMP)
    private Date runTo;

    /* The rest of the entity has been edited out */ 
```

我不断收到以下根本原因的异常：`Caused by: org.hibernate.HibernateException: Wrong column type in public.backend_themetopic for column created. Found: timestamptz, expected: date`

**我试过的**

*   替换`java.util.Calendar`为`java.util.Date`- 没有区别
*   using `java.sql.Timestamp`- 抱怨我无法将`@Temporal`注释应用于`Timestamp`
*   `org.joda.time.DateTime`与自定义`@Type`注释 ( ) 一起使用`@Type(type="org.joda.time.contrib.hibernate.PersistentDateTimeTZ")`也不起作用

**约束**

*   此应用程序与“旧系统”交互 - 因此，更改日期字段的类型不是一个好的选择

我的问题是：我应该如何将这些时区感知时间戳映射到我的 JPA 实体中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-14T07:19:39.307

我最终通过关闭模式验证以一种骇人听闻的方式完成了这项“工作”。

以前，我`<property name="hibernate.hbm2ddl.auto" value="validate"/>"hibernate.hbm2ddl.auto"`在我的 persistence.xml 中。当我注释掉这个属性时，我的应用服务器启动并且模型“工作”。

我的实体的最终形式是：

```
@Entity
@Table(schema = "content", name = "theme")
public class Theme extends AbstractBaseEntity {
    private static final long serialVersionUID = 1L;

    @Column(name = "run_from", columnDefinition = "timestamp with time zone not null")
    @NotNull
    @Temporal(TemporalType.TIMESTAMP)
    private Date runFrom;

    @Column(name = "run_to", columnDefinition = "timestampt with time zone not null")
    @NotNull
    @Temporal(TemporalType.TIMESTAMP)
    private Date runTo;

    /* Getters, setters, .hashCode(), .equals() etc omitted */ 
```

在阅读了相当多的内容之后，我的印象是没有简单的方法将 Postgresql 时间戳与时区列映射。

一些 JPA 实现 + 数据库组合本身支持这一点（EclipseLink + Oracle 就是一个例子）。对于休眠，使用 jodatime 扩展，可以使用普通时间戳 + 时区的 varchar 字段来存储时区感知时间戳（我不能这样做，因为我无法更改数据库模式）。[Jadira 用户类型](http://usertype.sourceforge.net/)或完全自定义的用户类型也可以用来解决这个问题。

我需要注意，我对这个实体的用例是“只读的”，所以我可以用一个看似天真的“解决方案”逃脱。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-11T18:25:37.983

添加`@Column(columnDefinition= "TIMESTAMP WITH TIME ZONE")`

```
@Column(name = "run_from", columnDefinition= "TIMESTAMP WITH TIME ZONE")
@NotNull
@Temporal(TemporalType.TIMESTAMP)
private Date runFrom; 
```

# ruby-on-rails - 带有子目录的 Rails 路由

> ID：13357490
> 
> 赞同：0
> 
> 时间：2012-11-13T08:24:02.573
> 
> 标签：ruby-on-rails, routing

我有“标准”mvc ......在布局中，我正在渲染部分，`art_lookups` 看起来是这样的：

```
= form_tag :controller => 'art_lookups', :action => 'search' do
  = text_field_tag :search, params[:search], :pattern=>".{4,24}", :class => "search-input", :placeholder => "Введите код детали"
  = submit_tag "Поиск", :name => nil, :class => "search-submit" 
```

和布局部分：

```
= render :partial => 'art_lookups/search' 
```

一切正常。

但现在我正在创建管理部分......而且我在子目录中有控制器和视图`admin`，如果我尝试在管理中转到某个视图，我会收到类似的错误

```
No route matches {:controller=>"admin/art_lookups", :action=>"search"} 
```

如何解决？

也是路线的一部分：

```
namespace :admin do
    resources :orders
  end 
```

如果我部分评论，一切都很好......当我写在 admin/orders/index

```
= link_to "Редактирование", edit_admin_orders(o) 
```

我收到路由错误...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:45:46.900

改为`edit_admin_orders(o)`，`edit_admin_order_path(o)`不会出现路由错误。

**更新：**为搜索操作添加路线

```
namespace :admin do
  resources :orders do
    collection do
      get 'search'
    end
  end
end 
```

# delphi - 从 Delphi 中的 32 位应用程序在 x64 上运行 cleanmgr

> ID：13357491
> 
> 赞同：2
> 
> 时间：2012-11-13T08:24:04.273
> 
> 标签：delphi, delphi-7, manifest

我的主应用程序是一个 win32 应用程序，以管理员身份运行（启动时会提示 UAC）。

我需要运行 cleanmgr。

我`createprocess`用来启动cleanmgr。

```
 GetStartupInfo(stinfo);
  stinfo.wShowWindow := SW_SHOWNORMAL;
  CreateProcess(nil,PChar(ExpandEnvironment('%systemroot%') + '\System32\cleanmgr.exe  /sagerun:3'),nil,nil, False,DETACHED_PROCESS,  nil,PChar(ExpandEnvironment('%systemroot%')),stinfo,procinf); 
```

它适用于 XP 32 位，但不适用于 Win7 64 位。Cleanmgr 通过配置`cleanmgr.exe /sageset:3`来清理回收站。

如上图所示使用时`CreateProcess`，回收站在 XP 上清空，但在 Win7 上没有。

我看到`cleanmgr`正在运行，但它对回收站没有影响。

为什么 ？

# java - 缺少@AnnotationDrivenTx Spring3

> ID：13357498
> 
> 赞同：0
> 
> 时间：2012-11-13T08:24:54.150
> 
> 标签：java, spring, annotations, spring-3

我的同事说我应该将 spring 的 app-context.xml 转换为 java。

为此，我需要有我找不到的@AnnotationDrivenTx-Annotation。

这里有什么解决方法吗？

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:00:04.253

你的意思是[`@EnableTransactionManagement`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/transaction/annotation/EnableTransactionManagement.html)

见[http://blog.springsource.com/2011/06/10/spring-3-1-m2-configuration-enhancements/](http://blog.springsource.com/2011/06/10/spring-3-1-m2-configuration-enhancements/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-17T10:50:15.560

您可以将其作为单独的 jar 从 MavenRepository 下载：

```
<dependency>
    <groupId>org.springframework.javaconfig</groupId>
    <artifactId>spring-javaconfig</artifactId>
    <version>1.0.0.m3</version>
</dependency> 
```

但它是从 2008 年开始的，似乎不再开发了。这些功能可以在 spring-tx 组件中找到，@EnableTransactionManagement 是查尔斯所说的要走的路。

# android - 服务中有空指针异常

> ID：13357501
> 
> 赞同：0
> 
> 时间：2012-11-13T08:25:13.393
> 
> 标签：android, android-layout

我已经制作了这个示例流程应用程序但无法运行它我不断收到这个空指针异常请告诉我如何解决它以及为什么我有它

我的主要活动课：

```
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class SimpleServiceController extends Activity {

Button start1 = (Button)findViewById(R.id.start);
Button stop1 = (Button)findViewById(R.id.stop);
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    start1.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            startService(new     Intent(SimpleServiceController.this,Service1.class));
        }
    });

    stop1.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            stopService(new Intent(SimpleServiceController.this,Service1.class));

        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
} 
```

我的服务等级

```
 import android.app.Service;
 import android.content.Intent;
import android.os.IBinder;
import android.widget.Toast;

public class Service1 extends Service {

@Override
public IBinder onBind(Intent arg0) {
    // TODO Auto-generated method stub
    return null;
}
@Override
public void onCreate() {
    super.onCreate();
    Toast.makeText(this,"Service created ...", Toast.LENGTH_LONG).show();
}

@Override
public void onDestroy() {
    super.onDestroy();
    Toast.makeText(this, "Service destroyed ...", Toast.LENGTH_LONG).show();
}

} 
```

我的 maifest.xml

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="dom.example.serviceapp"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".SimpleServiceController"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

    </activity>
    <service android:name=".Service1" ></service>

</application> 
```

请告诉我我哪里错了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T08:26:59.130

按钮的初始化应该在`onCreate()`方法内部，就在之后`setContentView()`

```
start1 = (Button)findViewById(R.id.start);
stop1 = (Button)findViewById(R.id.stop); 
```

`findViewById`除非您设置内容视图，否则将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:45:56.337

尝试返回一个活页夹`bind(),`而不是`null`. 例如：

```
// onbind example:
@Override
public IBinder onBind(Intent intent) {
    return mBinder;
}

// This is the object that receives interactions from clients.  See
// RemoteService for a more complete example.
private final IBinder mBinder = new LocalBinder(); 
```

# c# - EF：保存数据以在数据库中查看

> ID：13357502
> 
> 赞同：1
> 
> 时间：2012-11-13T08:25:20.773
> 
> 标签：c#, asp.net, .net, database, entity-framework

我在数据库中有两个表，

我使用 a`view`将它们映射到我的应用程序中的一个对象（使用 EF）

我该如何执行`save()`此视图？

会`EfContect.SaveChanges();`足够吗？

或者我应该得到两个相关的项目（2表）

根据视图的变化修改它们然后应用`EfContect.SaveChanges();`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:01:57.313

[在 ADO.NET 实体框架中制作可更新视图接受更新](http://www.bitsinsight.com/making-an-updateable-view-accept-updates-in-ado-net-entities-framework/)：

> *   将 store:Type=”Views” 更改为 store:Type=”Tables”</p>
>     
>     
> *   从 Schema 属性中删除 store: 前缀
>     
>     
> *   删除 store:Name 属性
>     
>     
> *   注释掉元素

# release - 下一个版本什么时候发布？

> ID：13357503
> 
> 赞同：0
> 
> 时间：2012-11-13T08:25:26.387
> 
> 标签：release, g-wan

有关路线图的任何信息？我知道这不是问的最佳位置......但我认为有些人想知道同样的问题！

我迫不及待想和 ruby​​ & gwan 一起玩 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:50:50.100

我猜这个月应该会出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:41:35.277

奥格拉是对的。

没有固定的日期，因为人们会来询问看起来相当重要的新事物。由于这不仅是兼容性问题或错误修复，因此我将举几个最近所做的示例：

*   修复了嵌入式 Javascript 注释的损坏的 HTML 缩小
*   添加返回0；让 servlet 关闭连接而不发送回复的功能
*   修复了与 XFS 文件系统的不兼容问题（它不返回所有 libc 标志）
*   修复了特定于托管多个多核 CPU的*某些*系统的 NUMA 关联性问题
*   重写异步调用以使它们与 PHP、Perl、Python、Lua 等一起工作。
*   为那些可能需要几秒钟才能执行的脚本重写超时逻辑
*   必须完成并测试所有新功能，编写文档和示例等。

目标是节省时间，因为现在解决问题将使以后更容易。

# netbeans - Netbeans Git 与 Github 客户端的比较

> ID：13357507
> 
> 赞同：0
> 
> 时间：2012-11-13T08:25:40.283
> 
> 标签：netbeans, version-control, github, versioning

我对 git 和版本控制相当陌生。所以我看到 Netbeans 有 git 选项 Commit 和 Clone。在 netbeans 中使用内置的 git 控件与实际的 windows github 客户端相比有什么缺点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:35:29.660

没有优点或缺点。他们都执行相同的任务。如果您在 Netbeans 中执行任务，那么我建议您使用 Netbeans git 的东西。

但总的来说，从命令行使用 git 是一种为新手学习基础知识的好方法，然后在熟悉后继续使用 GUI 的东西。

# z3 - 是否可以访问与 Z3 中的 de-Bruijn 索引关联的名称？

> ID：13357509
> 
> 赞同：1
> 
> 时间：2012-11-13T08:25:44.367
> 
> 标签：z3

因此，我可以使用在表示量词的表达式上调用 Z3_get_quantifier_bound_name 来获取与量词的边界相关联的名称。但是假设我正在遍历量化子公式的 AST。那时是否可以访问索引的名称？谢谢你。

```
if (z3_expr.is_var())
{
    // is it possible at this point to get the name of the quantified variable, 
    // which was associated with it at quantifier creation?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:44:23.607

作为变量的表达式没有与其直接关联的名称。我们访问名称的方式是维护一个堆栈，这些名称来自在向下遍历的量词中。因此，维护符号的向量（堆栈/列表），并且每当您遍历量词时，将来自量词的绑定名称推送到向量上。遍历完量词后，您必须弹出名称。

您可以使用以下 API 访问绑定变量的名称：

```
 unsigned Z3_API Z3_get_quantifier_num_bound(__in Z3_context c, __in Z3_ast a);

 Z3_symbol Z3_API Z3_get_quantifier_bound_name(__in Z3_context c, __in Z3_ast a, unsigned i); 
```

请注意，量化变量的索引从右到左排序。因此，如果 Z3_get_quantifier_num_bound(context, expr) 返回 2，并且 x = Z3_get_quantifier_bound_name(context, expr, 0) y = Z3_get_quantifier_bound_name(context, expr, 1) 那么 y 的索引为 0，x 的索引为 1。

# java - 如何将spring集成消费者配置为事件驱动？

> ID：13357510
> 
> 赞同：1
> 
> 时间：2012-11-13T08:25:43.837
> 
> 标签：java, spring, jms, publish-subscribe, spring-integration

如何配置 Spring 集成以使用消息驱动的消费者。使用以下配置，我的消费者正在轮询消息，我无法弄清楚如何使其事件驱动而不是轮询..

```
 <bean id="dataQueue" class="org.apache.activemq.command.ActiveMQQueue">
        <constructor-arg name="name" value="${jms.data.queue.name}" />
    </bean>

    <jms:message-driven-channel-adapter channel="dataInputChannel" destination="dataQueue"  />
    <int:channel id="dataInputChannel" />    
    <int:channel id="persistDataChannel" />
    <int:channel id="processDataChannel" />

    <int:recipient-list-router id="customRouter" input-channel="dataInputChannel" timeout="10000" ignore-send-failures="true" apply-sequence="true">
        <int:recipient channel="persistDataChannel"/>
        <int:recipient channel="processDataChannel"/>
    </int:recipient-list-router> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:34:45.990

我不确定你的意思；它*是*事件驱动的。线程阻塞在客户端库的代码中，直到消息到达，或发生接收超时。如果您担心底层侦听器容器在 TRACE 调试下看到的活动，只需增加其 receiveTimeout。

# sql - 如何在 Derby 中使用关键字作为列名

> ID：13357511
> 
> 赞同：3
> 
> 时间：2012-11-13T08:25:47.460
> 
> 标签：sql, derby

我可以在 Derby 中使用保留关键字作为列名吗？我正在尝试将数据库模式迁移到 Derby 以进行测试。出于这个原因，我真的不想更改架构结构（列名等）。

所以问题是，如何在 Derby 中创建列名为“open”的表？例如表：

```
create table test ( open integer ); 
```

试图引用列名，但到目前为止没有成功......

```
java.sql.SQLSyntaxErrorException: Syntax error: Encountered "open" at line 1, column 21.
    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T08:34:30.640

引用保留字的标准方式（并且 Derby 遵循几乎所有 DBMS 在这方面所做的标准）是使用双引号。

```
create table test ( "OPEN" integer ); 
```

但请注意，一旦您这样做，列（或表）名称就会区分大小写。`"OPEN"`是与`"open"`or不同的列`"Open"`。

我强烈建议您不要**使用**需要您引用它们的名称。

# javascript - 如何使用 JavaScript 动态更改样式标签？

> ID：13357515
> 
> 赞同：14
> 
> 时间：2012-11-13T08:26:13.343
> 
> 标签：javascript, css

我想在生成内容后更改样式标签。如何将样式添加到样式标签？我尝试使用：

```
document.getElementById('style').appendChild(styleContents); 
```

但它没有用

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-13T08:30:52.240

您可能正在尝试将 css 添加到样式标签。这可以使用以下方法完成：

```
document.getElementsByTagName('style')[0].innerHTML=""; //some css goes here 
```

您还可以使用：

```
document.styleSheets[0].cssText = ""; //some css goes here 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-09-18T18:33:51.070

我知道这是一个老问题，但我一直在尝试找出一种方法来动态更新这些，而不直接将样式应用于元素。

如果你给一个样式标签一个 ID 并选择它，你就可以使用 sheet 属性访问它的 CSS。

从这里你可以更新你想要的任何东西。通过替换标签内的整个 CSS 或更新单个类。

```
document.getElementById('somestyletagid').sheet.cssRules[0].selectorText 
```

这是你的类选择器。

```
document.getElementById('somestyletagid').sheet.cssRules[0].style 
```

这些是该类的所有单独的 css 属性。

您可以通过执行以下操作更新背景颜色：

```
document.getElementById('somestyletagid').sheet.cssRules[0].style.backgroundColor = 'red' 
```

这是一种访问 html 中任何样式标签的方法。不幸的是，我能找到的每个 CSSStyleRule 都没有严格唯一的 ID。最接近的是 selectorText 但显然可以重复。无论哪种方式至少满足我的需要，这正是我所需要的。

您还可以使用 document.styleSheets 更新任何包含的 CSS 文件，并以通常相同的方式访问它们。

```
document.styleSheets[0].href 
```

包含的 css 文件的 href。

```
document.styleSheets[0].cssRules 
```

表中的所有类。

希望这对某人有帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-13T08:48:38.687

一个`style`元素没有子元素，因为它的内容根据定义只是文本（就 HTML 而言）。但这意味着您可以使用该`innerHTML`属性附加到其内容。如果你的元素有`<style id=foo>`，那么你写：

```
document.getElementById('foo').innerHTML += styleContents; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-13T09:06:48.317

我在[http://jsfiddle.net/fttS5/1/](http://jsfiddle.net/fttS5/1/)上放了一个简单的例子。

您可以将 id 附加到样式标签，就像在 HTML 中的任何其他元素一样。

`<style id="style"></style>`

现在您可以使用您尝试使用 appendChild 的代码并添加一个快速更改

`document.getElementById('style').appendChild(document.createTextNode(styleContents));`

这应该可以解决问题。祝你好运。

您也可以只使用下面我的答案中列出的 innerHTML 方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-13T08:29:40.073

试试这个

```
var currentElement = document.getElementById('style');
var currentStyle = currentElement.getAttribute('style');
var stylePieces = [];
if(currentStyle) {
    stylePieces = currentStyle.split(';');
}
stylePieces.push('new-style: true;');
currentElement.setAttribute('style', stylePieces.join(';')); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-13T08:28:51.897

为什么不使用 jQuery 库并直接将新的 CSS 附加到 DOM 元素？

例如：

```
<script>
$(document).ready(function(){
    $("#an_element").css("border", "1px solid #333");
});
</script>

<div id="an_element">Test</a> 
```

这将在 ID 为“an_element”的元素周围添加边框。

[jQuery 选择器](http://api.jquery.com/category/selectors/)

[jQuery CSS](http://api.jquery.com/category/css/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-19T01:31:34.923

如果您想将规则附加到现有样式表，官方的做法是使用 insertRule 方法。在浏览器上可能会比仅附加文本要容易得多。此外，如果你像下面那样做，如果有一个特定的 css 规则不是有效的语法，它会跳过它，从而保护你的文档的完整性。

仅将 jQuery 用于字符串计时，可能无论如何都不需要。

您必须给它样式标签的 ID。

```
function AddMoreStyles(code, styleTagId) {

    var sheet = document.getElementById('#' + styleTagId);

    let lines = code.replace(/[\r\n\t]/gm, ' ').split(/}/);
    if (!sheet) {
        return;
    }
    sheet = sheet.styleSheet || sheet.sheet || sheet;
    lines.forEach(function (str) {
        str = $.trim(str) + '}';
        let m = str.match(/(.+?)\{(.*?)}/), m1, m2;
        if (m) {
            m1 = $.trim(m[1]);
            m2 = $.trim(m[2]);
            try {
                if (sheet.insertRule) sheet.insertRule(m1 + '{' + m2 + '}', sheet.cssRules.length);
                else sheet.addRule(m1, m2);
            } catch (e) {
                console.log("!ERROR in css rule: " + e.message);
            }
        }
    });
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-27T12:46:49.067

添加到`@AtheistP3ace`的答案，这是一个使用纯 JavaScript 更改样式块内容的函数：

```
// Change the CSS in the style section.
// Property is the name of the class or id E.G. ".mdc-card" or "#main".
// Style is the name of the CSS style. E.G. "Background".
// Value is the setting that the style will use, E.G. "Red"
// WARNING: STOPS AND EXECUTES ON THE FIRST MATCH DOES NOT PROCESS MORE AFTER THAT!!!
function changeCSS(property, style, value, cssSectionID) {
    if (cssSectionID === undefined) {
        cssSectionID = "mainCSS";
    }
    // Get the current CSS sheet.
    var mainCSS = document.getElementById("mainCSS");
    var changeStatus = false;
    // Refine the stylesheet into a more easily processed form.
    // It is done here as making it part of the variable definition produces issues where you still need to call the sheet property.
    mainCSS = mainCSS.sheet;

    // Only execute if the user has specified values for each of the required parameters.
    if (property !== undefined && style !== undefined && value !== undefined) {
        // Loop through all of the CSS Properties until the specified property is found.
        for (var index = 0; index < mainCSS.cssRules.length; index++) {

            // Only apply the value of the property matches.
            if (mainCSS.cssRules[index].selectorText === property.toString()) {
                // Apply the specified property value to the.
                mainCSS.cssRules[index].style[style.toString()] = value.toString();

                // Sets the exit status and breaks the loop's execution.
                changeStatus = true;
                break;
            }
        }   
    }
    // Returns the result of the operation. True being successful and false being unsuccessful.
    return changeStatus;
} 
```

# c# - c# 处理空格键事件

> ID：13357517
> 
> 赞同：2
> 
> 时间：2012-11-13T08:26:36.790
> 
> 标签：c#, wpf

首先，这可能是之前问题的重复，但这些答案都不起作用。
对于许多示例，我什至没有得到列出的正确程序。

我有一个`TextBox`和一个`ListBox`。我想在文本框中输入一封电子邮件，然后当我按下`Space`键时，我需要将电子邮件添加到列表框中，然后清除文本框。

正如标题所示，我没有运气绑定空格键。

我试过了：

```
 private void txtEmailAddr_KeyDown(object sender, KeyEventArgs e)
    {
        KeyEventArgs ke = e;
        if (ke != null && ke.Key == Key.Space)
        {
            ke.Handled = false;
        }

        if (ke.Key == Key.Space)
        {
                lstEmails.Items.Add(txtEmail.Text);
        }
    } 
```

和

```
 private void txtEmailAddr_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Space)
        {
                lstEmails.Items.Add(txtEmail.Text);
        }
    } 
```

请有人帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T09:02:39.937

而不是`KeyDown`事件挂钩`PreviewKeyDown`您的文本框的事件 -

```
<TextBox PreviewKeyDown="txtEmailAddr_KeyDown"/> 
```

从 MSDN 文档 -

某些按键（例如 TAB、RETURN、ESC 和箭头键）通常会被某些控件忽略，因为它们不被视为输入按键。例如，默认情况下，Button 控件会忽略箭头键。按箭头键通常会使焦点移动到上一个或下一个控件。箭头键被视为导航键，按下这些键通常不会引发 Button 的 KeyDown 事件。但是，按 Button 的箭头键确实会引发 PreviewKeyDown 事件。通过处理 Button 的 PreviewKeyDown 事件并将 IsInputKey 属性设置为 true，您可以在按下箭头键时引发 KeyDown 事件。但是，如果您处理箭头键，焦点将不再移动到上一个或下一个控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T08:35:54.677

使用

```
public class SelectableTextBlock : TextBox
{
    public SelectableTextBlock()
    {
        AddHandler(KeyDownEvent, new RoutedEventHandler(HandleHandledKeyDown), true);
    }

    public void HandleHandledKeyDown(object sender, RoutedEventArgs e)
    {
        KeyEventArgs ke = e as KeyEventArgs;
        if(ke != null && ke.Key == Key.Space)
        {
            ke.Handled = false;
        }
    }
} 
```

我能够添加没有处理 SpaceKey 事件的自定义文本框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:37:51.857

看起来这两种方法都应该调用该行`lstEmails.Items.Add(txtEmail.Text);`

您是否尝试过在该行设置断点以确保它被调用？

您确定已将文本框的 KeyDown 事件绑定到您的方法吗？

像这样：

```
nameOfYourTextBox.KeyDown += new EventHandler(txtEmailAddr_KeyDown); 
```

# xaml - Windows 应用商店绑定问题

> ID：13357520
> 
> 赞同：0
> 
> 时间：2012-11-13T08:26:58.503
> 
> 标签：xaml, binding, windows-8, windows-runtime

我有一个 Windows Store 项目，如下所示：

```
class MyModel
{
    private int _testVar;
    public int TestVariable
    {
        get { return _testVar; }
        set
        {
            _testVar = value;
            NotifyPropertyChanged("TestVariable");
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(property));
    }

} 
```

我的绑定如下：

```
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <TextBlock Text="{Binding Path=TestVariable}" />
    <Button Click="Button_Click_1"></Button>
</Grid> 
```

以及背后的代码：

```
 MyModel thisModel = new MyModel();

    public MainPage()
    {
        this.InitializeComponent();

        thisModel.TestVariable = 0;
        DataContext = thisModel;
    } 
```

至此，当我得到显示为 0 的文本块时，绑定似乎可以工作。但是，当我按如下方式处理按钮单击事件时：

```
 private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        thisModel.TestVariable++;
    } 
```

我没有看到这个数字在增加。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:33:42.747

看来您的课程没有实现`INotifyPropertyChanged`. 我的意思是我希望看到`class MyModel : INotifyPropertyChanged`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:45:56.930

首先，视图模型必须实现 INotifyPropertyChanged 或更好地使用某种 MVVM 库，如[MVVM Light](http://mvvmlight.codeplex.com/)，这将对您有很大帮助。
其次，我不确定，调用 thisModel.TestVariable++ 是否真的更新了值？尝试使用 thisModel.TestVariable = thisModel.TestVariable + 1;

# mysql - MySQL 查询优化 - （不需要连接）

> ID：13357522
> 
> 赞同：-2
> 
> 时间：2012-11-13T08:27:03.823
> 
> 标签：mysql, sql

我已经按照查询使用连接进行处理。除了使用这些计数和连接之外，还有其他选择吗？

```
select 
    ipd.data_city as city,
    count(distinct f.dim_ipinfo_id) as visitors, 
    count(distinct f.dim_visit_id) as visits,
    count(f.dim_Pageview_id) as pageviews
from fact_table f
left join dim_data ipd on ipd.dim_data_id = f.dim_data_id
where f.dim_member_id = 725
group by city 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:35:20.643

不知道你的目标和数据结构是不容易理解的。
但是乍一看，*JOIN*似乎是**必要**的，因为分组是在似乎在 *dim_data* 表上的*city字段上完成的。*
如果您在 *fact_table* 数据中有一个引用城市的字段，您可以将其用于分组并删除连接，如果没有，您必须坚持使用它。
此外，如果您不需要对城市进行分组，则可以避免加入，但 id 似乎并非如此。

# java - 使用 SimpleXML 读取 XML

> ID：13357525
> 
> 赞同：3
> 
> 时间：2012-11-13T08:27:35.940
> 
> 标签：java, android, xml, xml-serialization, simple-framework

嗨，任何人都可以告诉我如何使用 SimpleXML btw 读取 xml 标签及其值。我正在构建一个安卓应用程序。

我需要获取根元素内的所有标签和值：

```
<RootElement>
   <UnknownTab>UnkownValue</UnkownTab>
   <AnotherUnknownTab>UnkownValue</AnotherUnknownTab>
</RootElement> 
```

RootElement 中的元素数量也是未知的，并且每次都可能不同。

**更新：**

我已经将 SimpleXml 用于我正在做的所有其他序列化，所以我不想使用另一个 XML 解析工具。问题是如何用 SimpleXml 做到这一点，而不是如何序列化 xml。

**更新 2：** 我已经查看了 XML（它有点复杂），定义如下：

xsd定义：

```
<element-sequence> 
   <element name="actualName" ..../>
   <element name="actualName" ..../>
   <element name="actualName" ..../>
   .
   .
   .
</element-sequence> 
```

element-sequence 的大小是可变的，并且 RootElement 内元素的标签是实际名称

```
<RootElement>
   <actualName>UnkownValue</actualName>
   <actualName>UnkownValue</actualName>
   .
   .
   .
</RootElement> 
```

如果可能的话，有什么方法**可以用 SimpleXML序列化它**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T13:39:43.797

使用 SimpleXML 看起来这是不可能的，使用 XPath 完成了这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:53:08.987

你可以使用`SAXParser`Android的来解析String。Parser所需的 InputSource 需要`XMLReader`输入流，因此您必须将 String 转换为输入流。您可以`ByteArrayInputStream`为此使用 a：

```
InputStream is = new ByteArrayInputStream( myString.getBytes( charset ) ); 
```

也可以看看：

[将字符串转换为 Srim](https://stackoverflow.com/questions/247161/how-do-i-turn-a-string-into-a-stream-in-java)

[Android 使用 SAX 解析器解析 XML](http://developer.android.com/reference/javax/xml/parsers/SAXParser.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T09:41:32.437

您可能想使用[访客策略](http://simple.sourceforge.net/download/stream/doc/javadoc/org/simpleframework/xml/strategy/VisitorStrategy.html)

覆盖“读取”方法：

```
@Override
public void read(Type type, NodeMap<InputNode> node) throws Exception { 
```

使您可以访问 NodeMap。使用 node.getNode() 您可以检索实际的当前 InputNode 并查询它的名称和值。您可能需要确保在 RootElement 注释中使用了“strict=false”，以确保没有为非映射标签引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:30:08.447

看看非常简单的教程可能会对您有所帮助：[Java and XML](http://www.vogella.com/articles/JavaXML/article.html) and [Parsing XML Data](http://developer.android.com/training/basics/network-ops/xml.html)

# c# - OleDbConnection 中的 IMEX

> ID：13357526
> 
> 赞同：0
> 
> 时间：2012-11-13T08:27:38.660
> 
> 标签：c#, excel, connection-string, oledb

我正在尝试将 excel 文件读入 DataTable，但 IMEX 驱动程序不会读取列中的所有数据。这有什么问题？

```
OleDbConnection dCon = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + fileName + ";Extended Properties=HDR=YES;Excel 12.0;IMEX=1"); 
```

这是代码。

```
OleDbConnection dCon = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" +
            fileName + ";Extended Properties=HDR=YES;Excel 12.0;IMEX=1");

OleDbDataAdapter dAdp = new OleDbDataAdapter("SELECT * FROM [Sheet1$]", dCon);
dAdp.TableMappings.Add("tbl", "Table");
dAdp.Fill(dSet);
DataTable dT = dSet.Tables[0];

for (int i = 0; i < dT.Rows.Count; i++)
{
     //code for getting the values.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:00:43.063

问题是这样做有 255 个字符的限制。

您可能需要考虑使用该`Microsoft.Office.Interop.Excel`程序集以获得更好的解决方案。

[http://www.dotnetperls.com/excel](http://www.dotnetperls.com/excel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T17:55:03.893

我意识到这对于 OP 来说有点晚了，但是因为我遇到了它，所以我想补充一点，我认为扩展属性部分在此示例中格式不正确。扩展属性需要单独括在自己的引号中，以便进行适当处理。

OPs 示例使用了这个

> ```
> OleDbConnection dCon = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" +
>         fileName + ";Extended Properties=HDR=YES;Excel 12.0;IMEX=1"); 
> ```

我相信这应该是

> ```
> OleDbConnection dCon = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" +
>         fileName + ";Extended Properties=\"HDR=YES;Excel 12.0;IMEX=1\""); 
> ```

使用这种格式错误的连接，可能无法识别 IMEX 属性。

有关可能的连接字符串语法选项（包括扩展属性的选项）的信息，请参阅[此 MS 文章。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms722656%28v=vs.85%29.aspx)

# javascript - 使用javascript刷新iframe？

> ID：13357527
> 
> 赞同：-4
> 
> 时间：2012-11-13T08:27:43.713
> 
> 标签：javascript, html, iframe, refresh

我最近一直在研究一个包含 2 个 iframe 的项目，其中一个包含一个按钮。单击该按钮时，应重新加载下一个 iframe。我怎样才能做到这一点？任何帮助将不胜感激。

其实这是我的问题。代码很大，我不能粘贴。我不认为即使我粘贴它你会读完它！所以，请试着理解我要解释的内容。

我有一个包含 2 个 iframe 的页面。第一个 iframe 包含一个带有属性的按钮，`src='notification.php'` 第二个 iframe 包含`'contactlist.php'`.

问题是当用户单击第一个 iframe 中的按钮时，我正在尝试重新加载/刷新第二个 iframe。

我试图在主页上创建一个 javascript 函数，但没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:30:38.497

在父窗口中创建一个 JavaScript 函数，该函数重新加载第二帧并从第一帧调用该函数。

请注意，为此，第一帧和父窗口必须在同一个域中（[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)）

相关：[从 iframe 调用父窗口函数](https://stackoverflow.com/questions/2161388/iframe-function-calling-from-iframe-to-parent-page-javascript-function)

# php - 使用 php / mysql 解析 EDI 文件

> ID：13357529
> 
> 赞同：0
> 
> 时间：2012-11-13T08:27:51.187
> 
> 标签：php, mysql, parsing, edi

我有一个 40K 行 EDI（固定长度）文件，我必须将其解析为 csv。如果您知道 edi，您就会知道每个元素都有自己的固定长度。

我是解析 EDI 的新手，只需要一点帮助。我的第一个想法是建立一个表格，将元素长度保存为数组或这样

```
Table EDIInfo
EDI_ID           |  EDI_ElemLengths

1                |  3,22,7s2,30,30,22
2                |  30,5s2,9s2,3,1,23 
```

** 上面数组中的 s 表示从右数第二位的小数。

因此，一旦我将这些数据输入数据库，我不知道如何将其拉出以将其应用于我位于服务器上的文件。该文件此时是无扩展名的，它是一个简单的文本文件。我想直接把它解析成一个新的文件 XXXX.csv。

任何指向 tuts 或任何帮助/方向的链接将不胜感激。

如果你不知道 EDI，它基本上是一个文本文件，每行都有一个由“元素”组成的“记录”。每个“元素”在该行上允许有固定数量的字符，即使它不占用所有分配的空间。一个元素类似于一个字段（就像一个字段被定义为 varchar 64，一个元素由它在文本文件中允许使用的空格量定义）。元素相互碰撞，元素空间分配之外没有分隔符。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:00:08.617

EDI 元素不是传统定义中的“固定长度”。不知道你从哪里得到这个想法。您的陈述：“如果您了解 edi，您就会知道每个元素都有自己的固定长度。” 是假的。您的陈述：“它基本上是一个文本文件，每行由“元素”组成的“记录”也是不正确的。如果您的段终止符是 CR 或 LF，您的文本编辑器会将其呈现为每行一个段。如果您的段终止符是波浪号 (~)？那么您的文件将是文本流。

根据 EDI 字典，一个元素可以有一个最小值/最大值。如果一个元素的最小值为 4 / 最大值为 8，则该元素是可变长度的，因为它不会填充到完整的 8 个字符。EDI 是结构化的分隔文件。唯一的固定长度段是 ISA（在 ANSI X12 中）

如果您使用 ANSI X12，则有三个分隔符：段、元素和子元素。您可以通过解析 ISA 段找到它们。一旦有了分隔符，就可以解析文件的其余部分。如果您通过分隔符进行解析，则唯一需要担心元素长度的情况是您是否根据标准字典进行语法检查——您可能对此不感兴趣。

如果您正在使用 EDIFACT，则适用相同的一般想法（您从包络中获取分隔符，但可以有六个分隔符）。我只是假设您正在使用 ANSI X12。

那里有大量的解析器。你正在重新发明轮子。现有的解析器甚至可能内置了 FA 生成和通信工具。如果您正在查看大量原始 EDI 数据并需要了解数据含义的上下文，请查看这个免费的 EDI 记事本工具：[http://liaison。 com/产品/集成/编辑记事本](http://liaison.com/products/integrate/edi-notepad)

# java - 集成 JPA 和 SpringIOc

> ID：13357533
> 
> 赞同：2
> 
> 时间：2012-11-13T08:28:08.533
> 
> 标签：java, spring, jpa-2.0

嗨，我编写了小型应用程序并尝试连接 jpa。在我的spring配置文件中我写了这个：

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driver.manager}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.login}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean">
    <property name="dataSource">
        <ref bean="dataSource" />
    </property>
    <property name="packagesToScan">
        <list>
            <value>com.epam.newsmanagement.entity</value>
        </list>
    </property>
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="database" value="ORACLE" />
        </bean>
    </property>
</bean>

<bean id="jpaDao" class="com.epam.newsmanagement.dao.JPANewsDao" /> 
```

当我启动我的应用程序浏览器给我 404 错误和控制台给出这样的错误

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/jpa-configuration.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'dataSource' of bean class [org.springframework.orm.jpa.LocalEntityManagerFactoryBean]: Bean property 'dataSource' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter? 
```

请帮忙）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:35:39.740

org.springframework.orm.jpa.LocalEntityManagerFactoryBean 没有定义 dataSource/getDataSource() 字段/方法。这就是为什么你得到那个例外。

改用 LocalContainerEntityManagerFactoryBean

[这](https://stackoverflow.com/questions/6156832/what-is-the-difference-b-w-localcontainerentitymanagerfactorybean-and-localentit)可能会帮助你

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T09:01:31.173

在集成`JPA`和`Spring`，如果配置`PersistenceUnit`在`LocalContainerEntityManagerFactoryBean`。确保使用与`PersistenceUnit`in`persistence.xml`和相同的名称`spring-bean.xml`。如果是这样，`DataSource`配置`LocalEntityManagerFactoryBean`可能是可选的。您可能需要配置`JpaTransactionManager`.

（假设：`jpa-configuration.xml`可能是spring bean配置。）

**可选：** `org.springframework.orm.jpa.vendor.HibernateJpaDialect`或`com.company.util.HibernateExtendedJpaDialect`用于`jpaDialect`。

示例：spring-bean.xml

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driver.manager}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.login}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <!--<property name="dataSource" ref="dataSource"/>-->
    <property name="persistenceUnitName" value="your_persistence_unit_name"/>
    <property name="jpaVendorAdapter" ref="jpaVendorAdapter"/>
    <property name="jpaDialect">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaDialect"/>
    </property>
    <!--<property name="jpaPropertyMap"></property>-->
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver">
        </bean>
    </property>
</bean>

<bean id="jpaVendorAdapter" class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
    <!-- For MySQL-->
    <property name="databasePlatform" value="org.hibernate.dialect.MySQL5Dialect"/>
    <property name="generateDdl" value="false"/>
    <property name="showSql" value="true"/>
</bean> 
```

# eclipse - CFEclipse 中的文件夹被无故删除

> ID：13357536
> 
> 赞同：0
> 
> 时间：2012-11-13T08:28:30.337
> 
> 标签：eclipse, aptana

我们在同一项目的两台计算机上使用**CFEclipse**（带有**Aptana插件），该项目在本地服务器上运行。**昨天有些文件夹被无缘无故删除了。没有人删除文件和文件夹，但它们已经消失了。有人知道为什么会这样？

# vba - 从电源点导出数据到访问数据库

> ID：13357537
> 
> 赞同：0
> 
> 时间：2012-11-13T08:28:35.147
> 
> 标签：vba, ms-access-2010, powerpoint

在有一个带有文本框的 powerpoint，带有信息的组合框。我想将数据从 power point 导出到 aceess 数据库。我想像表格一样使用 powerpoint 来完成数据库。

解决方案是有一个按钮来更新这个数据库。谁有这个按钮的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:51:03.203

以下是关于一种方法的一些粗略说明。还有许多其他的可能性。

```
''Library reference: Microsoft ActiveX data Objects x.x Lubrary

Dim cmd As ADODB.Command
Dim cn As ADODB.Connection
Dim scn As String, ssql As String

''See also http://ConnectionStrings.com
scn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=Z:\Docs\Test.accdb;"
Set cmd = CreateObject("ADODB.Command")
Set cn = CreateObject("ADODB.Connection")

cn.Open scn
ssql = "insert into table1 (atext,amemo) values( p1,p2)"
With cmd
    .CommandText = ssql
    .ActiveConnection = cn
    .CommandType = adCmdText
    .Parameters.Append .CreateParameter( _
        "p1", adVarChar, adParamInput, 50, Me.ComboBox1)
    .Parameters.Append .CreateParameter( _
        "p2", adVarChar, adParamInput, 50, Me.TextBox1)
    .Execute recs
End With

MsgBox recs 
```

# android - 在 Google Play 商店应用中找不到应用

> ID：13357539
> 
> 赞同：0
> 
> 时间：2012-11-13T08:28:45.470
> 
> 标签：android, android-manifest, google-play

我在 Google Play 商店中有一个应用程序“Kilim Mobilya”。我有三星galaxy s3。如果我在手机上的 google play 应用程序上搜索应用程序，我找不到它。但是，如果我搜索 google play 网站，我可以找到它并且它正在工作。为什么在应用程序中找不到它？我的清单文件有这些权限

```
 <uses-sdk android:minSdkVersion="15" />

     <uses-permission android:name="android.permission.INTERNET" />
      <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

我可以在手机上安装apk，但不能在平板电脑上安装。我应该怎么做才能在每台设备上安装？我的 min sdk 应该是什么？谢谢干得好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:33:17.607

你`android:minSdkVersion="15"`太高了。试着让它更低。

在您的应用程序的网页上，应该有一个您的设备列表，清楚地标明此应用程序是否与设备兼容。尝试查看您的表格是否在该列表中。很可能不是，因为您的应用程序列表中有“需要 Android：4.0.3 及更高版本”。

# sql - PostgreSQL查询效率

> ID：13357541
> 
> 赞同：2
> 
> 时间：2012-11-13T08:28:55.910
> 
> 标签：sql, postgresql, aggregate-functions, postgresql-8.4, postgresql-performance

我正在使用 PostgreSQL（我是数据库领域的新手），我想知道您对我在使用的代码中发现的此类查询的效率的看法。这些查询有很多 JOIN，其中一个（粗体）按请求有很多行。这迫使我们 GROUP BY request.id 以便按请求获取行和包含所有这些行数据的字段（粗体）。

我认为这种查询必须花费大量时间来寻找所有这些最大值，但我想不出另一种方法来做到这一点。关于其效率以及如何改进它的任何想法？

```
SELECT
  request.id AS id,
  max(request_type.name) AS request_type,
  to_char(max(request.timestamp),'DD/mm/YYYY HH24:mi') AS timestamp,
  to_char(max(request.timestamp),'YYYY-mm-DD') AS timestamp_filtering,
  max(state.name) AS request_state,
  max(users.name || ' ' || COALESCE(users.surname,'')) AS create_user,
  max(request.id_create_user) AS id_create_user,
  max(enterprise.name) AS enterprise,
  max(cause_issue.name) AS cause,
  max(request_movements.id_request_state) AS id_state,
  array_to_string(array_agg(DISTINCT act_code.name || '/' || req_res.act_code), ', ') AS act_code, /* here */
  max(revised.code) AS state_revised, 
  max(request_shipment.warehouse) AS warehouse,
  max(req_res.id_warehouse) AS id_warehouse
FROM
  request
  LEFT JOIN users
    ON users.id=request.id_create_user
  LEFT JOIN enterprise
    ON users.id_enterprise=enterprise.id
  LEFT JOIN request_movements
    ON request_movements.id=request.id_request_movement
  LEFT JOIN request_versions
    ON request_versions.id = request_movements.id_version
  LEFT JOIN state
    ON request_movements.id_request_state=state.id
  INNER JOIN request_type
    ON request.id_request_type=request_type.id
  LEFT JOIN cause_issue
    ON request.id_cause_issue=cause_issue.id
  LEFT JOIN request_reserve req_res
    ON req_res.id_request = request.id /* here */
  LEFT JOIN act_code
    ON req_res.id_act_code=act_code.id
  LEFT JOIN request_shipment
    ON (request_shipment.id_request=request.id)
  LEFT JOIN warehouse_enterprise
    ON (warehouse_enterprise.id = request_shipment.id_warehouse_enterprise)
  LEFT JOIN revised
    ON (revised.id = request_shipment.id_revised)
WHERE
  request.id_request_type = "any_type"  
GROUP BY
  request.id 
```

解释返回[this](http://explain.depesz.com/s/wWs)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T16:14:47.723

您可以通过将值聚合到大连接中`request_reserve`和`act_code` **之前来大大简化此查询。**`JOIN`这避免了对所有其他列的聚合函数的需要，并且对于大量行通常应该更快。

```
SELECT r.id
      ,rt.name AS request_type
      ,to_char(r.timestamp, 'DD/mm/YYYY HH24:mi') AS timestamp
      ,to_char(r.timestamp, 'YYYY-mm-DD') AS timestamp_filtering
      ,s.name AS request_state
      ,u.name || COALESCE(' ' || u.surname, '') AS create_user
      ,r.id_create_user
      ,e.name AS enterprise
      ,c.name AS cause
      ,rm.id_request_state AS id_state
      ,rr.act_code
      ,rd.code AS state_revised
      ,rs.warehouse
      ,rr.id_warehouse
FROM      request              r
LEFT JOIN users                u  ON u.id = r.id_create_user
LEFT JOIN enterprise           e  ON e.id = u.id_enterprise
LEFT JOIN request_movements    rm ON rm.id = r.id_request_movement
LEFT JOIN request_versions     rv ON rv.id = rm.id_version
LEFT JOIN state                s  ON s.id = rm.id_request_state
     JOIN request_type         rt ON rt.id = r.id_request_type
LEFT JOIN cause_issue          c  ON c.id = r.id_cause_issue
LEFT JOIN request_shipment     rs ON rs.id_request = r.id
LEFT JOIN warehouse_enterprise w  ON w.id = rs.id_warehouse_enterprise
LEFT JOIN revised              rd ON rd.id = rs.id_revised
LEFT JOIN (
   SELECT rr.id_request, rr.id_warehouse
         ,array_to_string(array_agg(
             DISTINCT a.name || '/' || rr.act_code), ', ') AS act_code
   FROM   request_reserve rr
   LEFT   JOIN act_code   a ON r.id_act_code = a.id
   GROUP  BY rr.id_request, rr.id_warehouse
   )  rr ON rr.id_request = r.id
WHERE  r.id_request_type = "any_type";  -- use single quotes for values! 
```

对于大型查询，您必须拥有一种人眼可以轻松解析的格式。因此，我在改进查询之前重新格式化。我使用表别名来尽可能避免笨拙的标识符。

`create_user`对: 没有尾随空格的小改进。如果名称的任何一部分都可以是`NULL`，我建议这样做以避免悬空：

```
COALESCE(u.name || ' ' || u.surname, u.name, u.surname) 
```

在 PostgreSQL 9.1 或更高版本中，您可以使用[`concat_ws()`](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER).

# android - 作为内核驱动程序开发人员，我如何知道应该为 Android 提供哪些 IOCTL 和函数？

> ID：13357545
> 
> 赞同：1
> 
> 时间：2012-11-13T08:29:26.220
> 
> 标签：android, linux-kernel, embedded, driver

[http://www.kandroid.org/online-pdk/guide/display_drivers.html](http://www.kandroid.org/online-pdk/guide/display_drivers.html)

*   通过在 /dev/fb0 上调用 open 来访问驱动程序
*   使用 FBIOGET_FSCREENINFO 和 FBIOGET_VSCREENINFO 输入/输出控制 (ioctl) 调用来检索有关屏幕的信息
*   使用 FBIOPUT_VSCREENINFO ioctl 尝试创建两倍于物理屏幕大小的虚拟显示器，并将像素格式设置为 rgb_565。如果成功，则使用视频内存完成双缓冲。

`IOCTLS`作为内核驱动程序开发人员，我是否需要向 Android 介绍任何更具体的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T11:55:12.060

至于我，您引用的上述要求的文字清楚地回答了您的问题：

> Android 对驱动程序提出**了两个**要求：可直接写入的可映射内存的线性地址空间以及支持 rgb_565 像素格式。

如果您在实施此 ioctl/功能/等时遇到一些具体问题，欢迎您寻求支持。

# ios - 需要的想法：在 iOS 中显示数据列表的方法

> ID：13357551
> 
> 赞同：0
> 
> 时间：2012-11-13T08:29:49.697
> 
> 标签：ios, ipad, cocoa, list, tableview

我目前正在开发一个 iPad 应用程序。

在特定视图上，我必须以这种形式显示一些信息：

*   第 1 项：数据
*   *   项目 1-1：数据
*   *   项目 1-2：数据
*   *   第 1-3 项：数据
*   *   *   项目 1-3-1：数据
*   第 2 项：数据
*   *   项目 2-1：数据
*   *   项目 2-2：数据
*   第 3 项：数据
*   第 4 项：数据
*   ...

information1 : DATA 可以多于一行。information2 : 有时一个项目会有一个动作 information3 : 我认为所有内容都显示在同一个视图中会更好，而不是在不同的级别（即！=而不是单击标题将您转到带有列表的另一个视图）

子列表深度没有真正的限制，尽管我不应该有超过几个嵌套列表。我想以一种比显示带有很多 < ul > < li > ...

我虽然在`UITableView`里面`UITableViewCell`，但我担心它最终会变得一团糟。

有任何想法吗 ？谢谢 ！

编辑：我不知道是否真的很清楚我想要的是一种表示 html-< table >-like 的方式，而不是真正的嵌套列表。我表示它的方式不是带有子项目等的项目，但子项目应该只缩进。所有数据必须从同一视图中可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:37:32.417

显示此类信息的规范方法是通过`UINavigationController`链接`UITableViewController`s。您可能会在周围找到许多这种设计的示例，尤其是在许多 Apple 应用程序（邮件、系统设置等）中。

如果您正在寻找更原始的演示文稿，您可以从[Clear 应用程序](https://itunes.apple.com/us/app/clear/id493136154?mt=8)中获得灵感，它以一种新颖的方式处理嵌套表格做了很多工作。Clear 还做了很多自定义手势处理：您不必也实现它，但有趣的一点是它们“就地”隐藏和显示嵌套表格行的方式，而不是完全改变视图。

还有一个[github 项目](https://github.com/mystcolor/JTGestureBasedTableViewDemo)展示了该技术。

# javascript - 获取网页中所有输入字段更改的最佳方法

> ID：13357559
> 
> 赞同：0
> 
> 时间：2012-11-13T08:30:32.127
> 
> 标签：javascript, html, jsf, primefaces

我想为处理页面更改创建确认。例如`gmail`，或其他许多其他网站都有一个系统，当您更改页面中的字段以及想要离开页面或清除表单输入时，该站点将创建一个确认对话框，帮助您保存所做的更改。忘记了。这是我的解决方案，但我想知道是否有更好的方法。该项目也是JSF项目并使用primefaces 3.4
**解决方案：**
1. 创建一个全局js变量

> ```
> var isChanges = false; 
> ```

1.  将处理程序放在所有输入字段的 onchanges 方法上。

> < p:inputText value="#{someMB.someValue}" id="id" onkeydown="isChanges=true"></p:inputText>
> 或
> < p:selectOneMenu value="#{someMB.someValue}" id= "#{cc.attrs.id}" >
> < p:ajax event="change" onsuccess="isChanges=true" />
> </p:selectOneMenu>
> 等....

检测用户是否离开页面或清除表单输入：

```
< script language="JavaScript">
  window.onbeforeunload = confirmExit;
  function confirmExit()
  {
      if(isChanged && window.confirm("sometext")){
        // Call servers save method
      }
  }

< /script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:52:00.897

在我的 Web 应用程序中，我这样做：

1.  当页面加载时，抓取所有表单，除了那些有特殊`noHash`类的
2.  对于在上述步骤中找到的每个表单，获取除具有特殊`noHash`类的字段之外的所有字段
3.  序列化字符串中的字段名称和值，例如“var1=1&var2=2[...]”
4.  计算上面定义的字符串的sha1
5.  将结果存储为全局变量

然后，当用户尝试离开时，我会按照上述方法重新计算哈希值并查看哈希值是否不同，如果不同，我会在离开页面前提示用户进行确认。

请注意，这**一切**都是使用 javascript 完成的，因此与您的服务器端脚本语言无关。

# mysql - 错误 # 1045 - 无法登录 MySQL 服务器 -> phpmyadmin

> ID：13357561
> 
> 赞同：15
> 
> 时间：2012-11-13T08:30:32.397
> 
> 标签：mysql, login, passwords, phpmyadmin, windows-server-2008-r2

我们在运行 IIS 7.0 的 Windows 机器上安装了 PHPMyAdmin。
我们可以使用命令行连接到 MySQL，但我们无法使用 PHPMyAdmin 进行连接。
显示的错误是：`Error #1045 Cannot log in to the MySQL server.`
有人可以帮忙吗？

`PHP Version 5.4.0`
`mysqlnd 5.0.10 - 20111026 - $Revision: 323634 $`
`phpMyAdmin-3.5.4-rc1-all-languages.7z`

**编辑：**
我点击下面的链接没有成功，意味着我更改了密码，但 phpmyadmin 仍然有那个错误......
[C.5.4.1.1。重置 Root 密码：Windows 系统](http://dev.mysql.com/doc/refman/5.0/en/resetting-permissions.html)

在堆栈中也有类似下面的线程没有帮助：
[随机错误：#1045 无法登录到 MySQL 服务器](https://stackoverflow.com/questions/11370667/random-error-1045-cannot-log-in-to-the-mysql-server)
，但该错误不是随机的 -> 我总是有那个错误...

这是 phpmyadmin 文件夹中的 config.inc.php 文件：

```
<?php
/* vim: set expandtab sw=4 ts=4 sts=4: */
/**
 * Config file view and save screen
 *
 * @package PhpMyAdmin-setup
 */

if (!defined('PHPMYADMIN')) {
    exit;
}

/**
 * Core libraries.
 */
require_once './libraries/config/FormDisplay.class.php';
require_once './setup/lib/index.lib.php';
require_once './setup/lib/ConfigGenerator.class.php';

$config_readable = false;
$config_writable = false;
$config_exists = false;
check_config_rw($config_readable, $config_writable, $config_exists);
?>
<h2><?php echo __('Configuration file') ?></h2>
<?php display_form_top('config.php'); ?>
<input type="hidden" name="eol" value="<?php echo htmlspecialchars(PMA_ifSetOr($_GET['eol'], 'unix')) ?>" />
<?php display_fieldset_top('', '', null, array('class' => 'simple')); ?>
<tr>
    <td>
        <textarea cols="50" rows="20" name="textconfig" id="textconfig" spellcheck="false"><?php
            echo htmlspecialchars(ConfigGenerator::getConfigFile())
        ?></textarea>
    </td>
</tr>
<tr>
    <td class="lastrow" style="text-align: left">
        <input type="submit" name="submit_download" value="<?php echo __('Download') ?>" class="green" />
        <input type="submit" name="submit_save" value="<?php echo __('Save') ?>"<?php if (!$config_writable) echo ' disabled="disabled"' ?> />
    </td>
</tr>
<?php
display_fieldset_bottom_simple();
display_form_bottom();
?> 
```

我应该更改这些代码的哪些部分？

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-26T09:44:55.113

在 Linux 中，我通过转到根命令提示符类型来解决此问题：

```
# mysqladmin -u root password 'Secret Phrase Here' 
```

然后返回并登录。每次都有效！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-13T09:01:49.383

按照您在帖子中提到的链接后，您需要做两件事：

必须在 phpmyadmin 的*config.inc.php中映射更改的登录凭据*

其次，您需要重新启动您的 web 和 mysql 服务器。

php版本不是这里的问题..您需要转到*phpmyadmin*安装目录并找到文件`config.inc.php`，并在该文件中将您当前的mysql密码放在行

```
$cfg['Servers'][$i]['user'] = 'root'; //mysql username here
$cfg['Servers'][$i]['password'] = 'password'; //mysql password here 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-03T09:23:01.960

如果您是第一次安装，请尝试以 root 用户名和密码登录

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-08-13T18:47:38.307

在一切都没有之后对我有用的另一件事 - 将 config.inc.php 中的“localhost”更改为 127.0.0.1

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-07T18:25:32.700

在 mysql 5.7 中，auth 机制发生了变化，文档可以在官方手册中[找到](http://dev.mysql.com/doc/refman/5.7/en/authentication-plugins.html)。

使用系统 root 用户（或`sudo`），您可以通过 CLI 使用 mysql 'root' 用户连接到 mysql 数据库。所有其他用户也将工作。

然而，在 phpmyadmin 中，所有 mysql 用户都可以使用，但 mysql 'root' 用户不行。

这来自这里：

```
$ mysql -Ne "select Host,User,plugin from mysql.user where user='root';"
+-----------+------+-----------------------+
| localhost | root | auth_socket |
|  hostname | root | mysql_native_password |
+-----------+------+-----------------------+ 
```

要“修复”此安全功能，请执行以下操作：

```
mysql -Ne "update mysql.user set plugin='mysql_native_password' where User='root' and Host='localhost'; flush privileges;" 
```

更多相关信息也可以[在](https://dev.mysql.com/doc/refman/5.7/en/account-upgrades.html)手册中找到。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-03T07:33:24.717

对于 ubuntu 用户，你的 config.inc.php 文件应该是这样的

```
/* Authentication type */
$cfg['Servers'][$i]['auth_type'] = 'cookie';
$cfg['Servers'][$i]['user'] = 'username';
$cfg['Servers'][$i]['password'] = 'password';
/* Server parameters */
$cfg['Servers'][$i]['host'] = '127.0.0.1';
$cfg['Servers'][$i]['connect_type'] = 'tcp';
$cfg['Servers'][$i]['compress'] = false;
$cfg['Servers'][$i]['AllowNoPassword'] = false;
/**
 * phpMyAdmin configuration storage settings.
 */
/* User used to manipulate with storage */
// $cfg['Servers'][$i]['controlhost'] = '';
// $cfg['Servers'][$i]['controlport'] = '';
// $cfg['Servers'][$i]['controluser'] = 'pma';
// $cfg['Servers'][$i]['controlpass'] = ''; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-03T14:42:18.330

当您在安全选项卡中更改密码时，有两个部分，一个在上面，一个在下面。我认为这里的常见错误是其他人尝试使用他们设置的帐户“低于”用于 htaccess 的帐户登录，而他们应该使用他们在上述部分设置的密码登录。我就是这样修的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-20T10:21:48.367

一些答案；也看看这个；确保没有 mysql 实例正在运行，这总是由于没有很好地结束会话而带来的。获得超级用户权限

> 须藤

并在提示时输入您的密码（请记住，当您输入密码时不会出现任何内容，因此，不用担心，只需输入并按 Enter 键）。接下来转到您的终端并停止所有 mysql 实例：

/etc/init.d/mysql 停止

之后，去重新启动mysql服务（或重新启动整个xampp）。这解决了我的问题。祝一切顺利。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-20T17:26:58.847

如果您登录“phpmyadmin”，然后退出，您可能无法尝试在同一浏览器窗口中重新登录。注销将浏览器发送到如下所示的 URL：

```
http://localhost/phpmyadmin/index.php?db=&token=354a350abed02588e4b59f44217826fd&old_usr=tester 
```

但对我来说，在 Safari 浏览器中的 Mac OS X 上，该 URL 只是不想工作。因此，我必须输入干净的 URL：

```
http://localhost/phpmyadmin 
```

不知道为什么，但截至今天，2015 年 10 月 20 日，这就是我所经历的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-04T06:36:55.273

```
sudo service mysql stop 
```

* * *

```
sudo mysqld --skip-grant-tables & 
```

* * *

```
mysql -u root mysql 
```

* * *

```
Change MYSECRET with your new root password

UPDATE user SET Password=PASSWORD('MYSECRET') WHERE User='root'; FLUSH PRIVILEGES; exit; 
```

# gwt - KineticGWT：无法解析导入 com.google.gwt.canvas

> ID：13357567
> 
> 赞同：0
> 
> 时间：2012-11-13T08:31:09.697
> 
> 标签：gwt

尝试将 KineticGWT 与 Maven 一起使用，但出现以下错误。任何帮助表示赞赏。我的 Application.gwt.xml 也附在下面。

应用程序.gwt.xml：

```
<!DOCTYPE module PUBLIC "//gwt-module/" "http://google-web-toolkit.googlecode.com/svn/tags/1.6.2/distro-source/core/src/gwt-module.dtd">
<module>
  <inherits name='com.google.gwt.user.User'/>
  <inherits name='com.google.gwt.user.theme.standard.Standard'/>
  <inherits name="net.edzard.kinetic"/>
  <entry-point class='org.gaoshin.openflier.client.Application'/>
  <stylesheet src='Application.css' />
</module> 
```

Maven命令错误：

```
$ mvn install
[INFO] Compiling module org.gaoshin.openflier.Application
[INFO]    Refreshing module from source
[INFO]       Validating newly compiled units
[INFO]          Removing units with errors
[INFO]             [ERROR] Errors in 'jar:file:/Users/kzhang/.m2/repository/net/edzard/kineticgwt/0.9.2-SNAPSHOT/kineticgwt-0.9.2-SNAPSHOT-sources.jar!/net/edzard/kinetic/Canvas.java'
[INFO]                [ERROR] Line 3: The import com.google.gwt.canvas cannot be resolved
[INFO]                [ERROR] Line 5: The import com.google.gwt.dom.client.CanvasElement cannot be resolved
[INFO]                [ERROR] Line 15: Context2d cannot be resolved to a type 
```

在 pom.xml 文件中，我包含了 gwt-user 依赖项。我的 gwt 版本是 1.7.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:41:15.533

Canvas 已经在 GWT 2.2 中加入，所以升级你的中年 GWT。

另请注意，KineticGWT 0.9.2-SNAPSHOT 是针对 GWT 2.5.0 构建的，因此您可能希望使用该版本（GWT 开发中的经验法则：尽快升级到最新的稳定版本；这是一般建议，但特别适用于 GWT）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:51:32.610

您还记得包含 GWT 依赖项吗？

```
<dependency>
    <groupId>com.google.gwt</groupId>
    <artifactId>gwt-user</artifactId>
    <version>${gwtVersion}</version>
</dependency> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T17:26:47.410

感谢 Thomas 的 gwt 版本建议。我还从 Kineticgwt 的开发人员那里得到了一些帮助。事实证明，我需要升级两件事。一个用于 gwt，另一个用于 gwt maven 插件。

插件版本：

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>gwt-maven-plugin</artifactId>
            <version>2.5.0-rc2</version>
            <executions>
                <execution>
                    <goals>
                        <goal>compile</goal>
                    </goals>
                </execution>
            </executions> 
```

gwt版本：

```
 <dependency>
        <groupId>com.google.gwt</groupId>
        <artifactId>gwt-servlet</artifactId>
        <version>2.5.0</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>com.google.gwt</groupId>
        <artifactId>gwt-user</artifactId>
        <version>2.5.0</version>
        <scope>provided</scope>
    </dependency> 
```

# javascript - 如何在 xcode 控制台上查看 phonegap javascript 日志消息

> ID：13357568
> 
> 赞同：25
> 
> 时间：2012-11-13T08:31:09.260
> 
> 标签：javascript, cordova, logging

我正在尝试在 Xcode 上使用 phonegap 开发一个基本的 hello world 应用程序。但我在 Xcode 控制台上看不到日志消息。我已经尝试过*console.log*和*debug.log*但它们对我不起作用？

如何在 xcode 控制台上查看 javascript 日志消息？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-08-23T19:07:46.757

在 Phonegap 3.0 中，您必须为 console.log 添加一个插件才能在 xcode 控制台中工作。

```
$ phonegap local plugin add https://git-wip-us.apache.org/repos/asf/cordova-plugin-console.git 
```

更多信息：[http ://docs.phonegap.com/en/edge/guide_cli_index.md.html#The%20Command-line%20Interface](http://docs.phonegap.com/en/edge/guide_cli_index.md.html#The%20Command-line%20Interface)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-02T20:02:55.810

1.  在您真正的 iDevice 或 iOS 模拟器中，转到`Settings > Safari > Advanced`并打开`Web Inspector`.
2.  桌面 Safari： `Safari > Preferences > Advanced`并选中该`Show develop menu in menu bar`复选框。
3.  现在您已经打开了 iOS 模拟器或者您的 iDevice 已连接到您的 Mac，开始在您的网站上使用 Web 检查器：在您的 Mac 上，打开 Safari 并转到`Develop`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-13T09:13:26.967

[Phonegap 在这里](http://phonegap.com/2011/05/18/debugging-phonegap-javascript/)有一篇关于此的非常好的博客文章。

他们提到的其中一件事包括我个人使用相当数量的[JSLint 。](http://www.jslint.com/)您只需在此处发布您的 JS 代码，它就会扫描错误和良好的样式。我还建议尝试将代码放在一个简单的 html 文件中并在浏览器上运行它。任何可能看起来与电话有关的东西，只要摆脱它。在浏览器端对您的 javascript 进行沙箱处理，然后使用 Firebug 或 Chrome 的调试器之类的东西，这很好。（我也肯定`console.log()`会在那里工作：D）

我也看到很多人提到，包括在博客文章中，关于[Weinre](http://people.apache.org/~pmuellr/weinre/docs/latest/)，所以这是值得一试的。

其他可能有帮助的相关问题：

[Phonegap - Xcode 中的 Javascript 调试](https://stackoverflow.com/questions/4827213/phonegap-javascript-debugging-in-xcode)

[iOS PhoneGap 调试工作流程](https://stackoverflow.com/questions/11207001/ios-phonegap-debug-workflow)

[如何在 Xcode 中查看 PhoneGap 应用程序的 javascript 错误？](https://stackoverflow.com/questions/4022152/how-to-see-the-javascript-errors-of-phonegap-app-in-xcode)

希望这可以帮助。

编辑：最近发现了这个：[在 Phonegap 中调试](https://github.com/phonegap/phonegap/wiki/Debugging-in-PhoneGap)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-13T09:13:25.533

`console.log("msg here: "+var);`应该管用。它将显示为`...[INFO] msg here: hi!`（在日期、时间、应用程序等之后）。

要查看消息，请转到查看 > 调试区域 > 激活控制台（或 shift+cmd+C）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-29T00:50:51.187

正如@NickBreen 所说，您必须添加正确的插件，但我们还需要在控制台显示日志语句之前等待`deviceready`事件触发。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-12T12:07:22.570

在更高版本的 phonegap/cordova 中，在项目中添加调试控制台插件：

**科尔多瓦插件添加 org.apache.cordova.console**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-11T14:18:57.657

就我而言，我只需要在 cordova.js 中注释以下几行：

> if(typeof window.console === "undefined") { window.console = { log:function(){} };

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-06T21:13:47.203

1.  [添加调试控制台插件](http://docs.phonegap.com/en/edge/guide_cli_index.md.html#The%20Command-line%20Interface)
2.  在示例 phonegap 代码或之后运行的代码中的 onDeviceReady 中添加一条 console.log 消息。

重要提示：控制台消息在“deviceready”事件之后显示。Console.log在此之前**不会**生成消息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-28T06:01:53.137

**问题**

通过命令行界面将控制台插件添加到 ios 平台（或重新安装后）时，会出现以下或类似的错误消息：

> **“CDVPlugin 类 CDVLogger (pluginName: Console) 不存在。”**

**解决方案**

打开您的 Xcode 项目并转到“构建阶段”选项卡。现在打开名为“Compile Sources”的下拉菜单。单击列表末尾的“+”号并添加“CDVLogger.m”或任何其他缺少的源。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-11-13T09:25:16.190

```
confirm("msg here: "+var); 
```

或者

```
console.log("msg here: "+var); 
```

# c - 使用 pty 编译 GCC 时出错

> ID：13357569
> 
> 赞同：1
> 
> 时间：2012-11-13T08:31:13.327
> 
> 标签：c, linux, gcc, pty

我用 C 搞乱了 pty，但由于某种原因，代码无法编译

```
#include <pty.h>
#include <stdlib.h>
#include <stdio.h>

void main(){
    int fd;
    ptyfork(&fd,NULL,NULL,NULL);
} 
```

我用 -lutil 编译，并输出下一个错误：

```
gcc -lutil test3.c -o test3
/tmp/ccgTfZvt.o: In function 'main':
test3.c:(.text+0x24): undefined reference to `ptyfork'
collect2: ld returned 1 exit status 
```

我错过了什么？

注意：我在 ubuntu 12.04 LTS 64 位中编译

编辑：尝试`gcc test3.c -o test3 -lutil`没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:37:35.820

函数是`forkpty`，不是`ptyfork`。请参阅[文档](http://www.kernel.org/doc/man-pages/online/pages/man3/openpty.3.html)。

# php - 如何正确获取数据

> ID：13357570
> 
> 赞同：-1
> 
> 时间：2012-11-13T08:31:21.147
> 
> 标签：php, loops

您好，我将从 for 获取数组数据。我有一个代码，但在之前的代码 cs=2 中效果不佳

```
for($k=0;$k<$cs;$k++)
{ 

$SQL = "SELECT duration FROM core_network WHERE location=('".$location_c[$k]."')";
$result = mysql_query($SQL);

$cks="0";
$duration=array();
while ($db_field = mysql_fetch_array($result)) {
$duration_c[$cks]= $db_field['duration']; //*here must save to data
 $cks++;

} 
 } 
```

我已将此代码保存在 search_l.php

```
 <?php include("lib/search_l.php"); ?>

  <?php
if($cs!=0){
for($i=0;$i<$cs;$i++)
{ 

?>

 <div id="alarmdisplay">
   <table class width="634" border="0" cellspacing="3" cellpadding="3">
  <tr class="search">
    <td width="256"><?php echo $location_c[$i] ?></td>
    <td width="154" class="247"><?php  echo $duration_c[$i]
?></td>
    <td width="194">&nbsp;</td>
  </tr>
 </table> 
```

在这里它必须是打印 2 持续时间。但它只打印另一个有错误注意：未定义的偏移量：1 如何正确打印它？

当我测试它以检查正确时，我注意到：

```
$result)) {
$duration_c[$cks]= $db_field['duration'];
 $cks++;

} echo $duration_c[$cks]   //*it prints correct i meant prints 2 test data
} 
```

在那之后

```
$result)) {
$duration_c[$cks]= $db_field['duration'];
 $cks++;

}  
}
echo $duration_c[$cks]  //*it prints not correct i meant prints only first test data 
```

如何纠正它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:37:43.540

好的，然后尝试这样的事情，这将得到你插入数组的结果。

```
<?php

for($i = 0; $i < count($duration); ++$i) {
    echo $duration[$i];
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:42:58.367

您的代码中有一个简单的类型错误：

```
$duration=array(); 
```

应该

```
$duration_c=array(); 
```

否则这将是范围界定的问题，因为 在你的循环`$duration_c`之外不会知道。`while`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:43:22.023

```
$duration_c=array();//Should be declared outside loop

for($k=0;$k<$cs;$k++)
 { 
  $SQL = "SELECT duration FROM core_network WHERE location=('".$location_c[$k]."')";
  $result = mysql_query($SQL);
  $cks = 0;//String variable
  while ($db_field = mysql_fetch_array($result,MYSQL_ASSOC)) {
                                                    //^---------returns associative array
      $duration_c[$cks]= $db_field['duration'];
      $cks++;
   } 
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:32:52.297

如果您想要一个键类型结果（关联数组），请使用

```
mysql_fetch_assoc(); 
```

反而

```
mysql_fetch_array(); 
```

# jquery - 使用 Show/Hide Fade & Slide 切换文本

> ID：13357575
> 
> 赞同：0
> 
> 时间：2012-11-13T08:31:44.440
> 
> 标签：jquery, text, toggle, show-hide, fade

这是我关于堆栈溢出的第一篇文章。

我有一个带有淡入淡出和幻灯片的显示/隐藏，它在页面加载时打开。它工作得很好。

我只想在打开时将文本从“x”更改为在关闭时更改为“-”。

这是我正在使用的脚本，它是从关于 stackoverflow 的另一个问题中得到的。

```
function toggleSlider() {
    if ($(".slidingDiv").is(":visible")) {
        $("#contentThatFades").animate(
            {
                opacity: "0"
            },
            600,
            function(){
                $(".slidingDiv").slideUp();
            }
        );
    }
    else {
        $(".slidingDiv").slideDown(600, function(){
            $("#contentThatFades").animate(
                {
                    opacity: "1"
                },
                600
            );
        });
    }   
} 
```

* * *

```
 <!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Untitled</title>

    <!-- The 1140px Grid - http://cssgrid.net/ -->
    <link rel="stylesheet" href="css/1140.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="css/styles.css" type="text/css" media="screen" />

    <script type="text/javascript" src="js/css3-mediaqueries.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">

function toggleSlider() {
        if ($(".slidingDiv").is(":visible")) {
            $("#contentThatFades").fadeTo(600, 0, function(){
                    $(".slidingDiv").slideUp();
                    $("#closebutton").text("-");
                }
            );
        } else {
            $(".slidingDiv").slideDown(600, function(){
                $("#closebutton").text("x");
                $("#contentThatFades").fadeTo(600, 1);
            });
        }   
    }

    $('#closebutton').on('click', function(e){
        e.preventDefault();
        toggleSlider();
        });</script>

</head>

<body>

<div class="container top">
    <div class="row">
        <div class="threecol">
        <a href="#" id="closebutton">x</a>
        </div>
        <div class="twocol">
        Text
        </div>
        <div class="twocol">
        Text
        </div>
        <div class="threecol">
        </div>
        <div class="twocol last">
        Text
        </div>
    </div>
</div>

<div class="container slidingDiv">
    <div id="contentThatFades" style="opacity:1;filter:alpha(opacity=1);">
        <div class="row">
            <div class="threecol">
            <h1>Text</h1>
            </div>
            <div class="fivecol">
            Text
            </div>
            <div class="fourcol last">
            </div>
        </div>
    </div>
</div>​

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:54:20.417

这应该可以解决问题：

```
$(document).ready(function(){

    function toggleSlider() {
        if ($(".slidingDiv").is(":visible")) {
            $("#contentThatFades").fadeTo(600, 0, function(){
                    $(".slidingDiv").slideUp();
                    $("#closebutton").text("-");
                }
            );
        } else {
            $(".slidingDiv").slideDown(600, function(){
                $("#closebutton").text("x");
                $("#contentThatFades").fadeTo(600, 1);
            });
        }   
    }

    $('#closebutton').on('click', function(e){
        e.preventDefault();
        toggleSlider();
    });
}); 
```

# android - 我可以让我的 listView 行更大吗？

> ID：13357579
> 
> 赞同：0
> 
> 时间：2012-11-13T08:32:10.160
> 
> 标签：android, android-layout, listview

我有一个 listView 使用 toString 将文本写入 listView 行。但是对于我所看到的 listView 只能取两行文本，例如..我想写出：“姓名：Niklas，年龄：20，位置：赫尔辛堡，电话号码：xxxxxx”但 listView 不够大以显示所有信息。

所以它只显示：“姓名：Niklas，年龄：20，地点：赫尔辛堡，Phon ..”

我的问题：您能否以某种方式使 listView 行更大，以便它可以写出例如三行文本而不是两行？还是我必须将我的 listView 更改为另一个 View？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:58:22.433

检查以下链接 [自定义列表视图](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/) 和 列表[视图](http://www.mkyong.com/android/android-listview-example/)

这个想法是通过为其分配自己的行布局来自定义 lisView。

对于 TextView，您可以分配 android:maxLines="" 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T10:24:57.333

您可以定义一个扩展`BaseAdapter`和覆盖该`getView`方法的适配器。

# python - OpenERP onchange 事件从父表中获取详细信息

> ID：13357580
> 
> 赞同：1
> 
> 时间：2012-11-13T08:32:12.693
> 
> 标签：python, xml, openerp

对不起，这是一个初学者的问题。

我在 OpenERP 中有以下表格：

付款表（父表）

```
---------------------------------
| ID | OR_DATE     | TRANS_TYPE |
---------------------------------
| 1  | 2010-10-15  | 1          |
---------------------------------
| 2  | 2010-10-30  | 2          |
---------------------------------
| 3  | 2010-10-15  | 1          |
--------------------------------- 
```

付款明细表（子表）

```
---------------------------------------------------------------------
| ID | OTH_PYMT_ID  | DESCRIPTION      | ACCOUNT_TITLE_ID  | AMOUNT |
---------------------------------------------------------------------
| 1  | 1            | Cash Payment  1  | 1                 |  1,000 |
---------------------------------------------------------------------
| 2  | 1            | Check Payment 1  | 2                 |  1,000 |
---------------------------------------------------------------------
| 3  | 2            | Cash Payment  2  | 1                 |  1,000 |
--------------------------------------------------------------------- 
```

付款类型表（参考表）

```
-----------------------------------------
| ID  | DESCRIPTION      | ACCOUNT_CODE | 
-----------------------------------------
| 1   | Cash             | ACCCODE001   |
-----------------------------------------
| 2   | Check            | ACCCODE002   |
-----------------------------------------
| 3   | Credit Card      | ACCCODE003   |
----------------------------------------- 
```

我在 OpenERP 中有 2 个类，其结构如下：

蟒蛇代码：

```
payment(osv.osv):
    """
    OpenERP Model : payment
    """

    _name = 'payment'
    _description = __doc__

    _columns = {
        'or_date': fields.date('OR Date'),
        'trans_type':fields.many2one('payment.type', "Transaction Type"),
        'oth_pymt_det_ids':fields.one2many('payment.detail', 'oth_pymt_id', 'Details'),
    }
class payment()

class payment_detail(osv.osv):
    """
    OpenERP Model : payment_detail
    """

    _name = 'payment.detail'
    _description = __doc__

    #onchange_description function goes here

    _columns = {
        'oth_pymt_id':fields.many2one('payment', 'Payment'),
        'description':fields.char('Description', size=100 ),
        'account_title_id':fields.char('Account Title', size=20),
        'amount': fields.float('Amount', digits=(16, 2)),
    }

payment_detail() 
```

XML 代码：

```
<record model="ir.ui.view" id="payment_form">
    <field name="name">Payments</field>
    <field name="model">payment</field>
    <field name="type">form</field>
    <field name="arch" type="xml">
        <form string="Payments">
            <group col="4" colspan="4">
                <field name="trans_type" />
                <field name="or_date" />                                              
                <field name="oth_pymt_det_ids" mode="tree" nolabel="1" colspan="4">
                    <tree string="Payment Details" editable="top">
                        <field name="description" on_change="onchange_description()"/>
                        <field name="account_title_id"/>
                        <field name="amount"/>
                    </tree>
                </field>
            </group> 
        </form>
    </field>
</record> 
```

如何在类中添加一个自动从“付款”表中获取和打印详细信息的`onchange_description`事件？`payment_detail`

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T07:53:08.360

您可以使用**父**参数。[您可以在销售模块](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/7066/sale/sale_view.xml#L135)中找到一个示例（[python 文件](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/7066/sale/sale.py#L1189)）

在你的情况下，尝试使用类似的东西

```
<field name="description" on_change="onchange_description(description, parent.or_date)"/> 
```

# powershell - Powershell：通过哈希表计算唯一字符串

> ID：13357581
> 
> 赞同：4
> 
> 时间：2012-11-13T08:32:13.410
> 
> 标签：powershell, hashtable, unique

“它有效——但它是最佳实践吗？” 问题。在 Perl 中，有一种紧凑的方法可以跟踪在文件中找到的字符串的出现情况：将它们存储在哈希表中。例如：

```
$HashTable{'the string in question'}++; 
```

Perl 增加 key 的值的`the string in question`次数与完成的次数一样多。它在跟踪事件发生的同时确保独特的“命中”。随便看看，我发现我可以用 Powershell 做很多相同的事情：

`$HashTable['a']++`甚至
`$Hashtable.a++`（这让我感到惊讶——甚至）
`$Hashtable."this is a key"++`

好的，所以它起作用了。但是 Powershell 中是否有一种被认为是更好的做法的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:57:32.763

您的方法看起来相当不错，至少对于带有哈希表助手的 PowerShell 而言。请记住，定义为的哈希表`@{}`不区分大小写。如果您需要区分大小写的哈希表，请像`New-Object System.Collections.Hashtable`.

例子：

```
# case insensitive
$hash = @{}
$hash['a']++
$hash['A']++
$hash

'------------------------'

# case sensitive
$hash = New-Object System.Collections.Hashtable
$hash['a']++
$hash['A']++
$hash 
```

输出：

```
Name                           Value
----                           -----
a                              2
------------------------
a                              1
A                              1 
```

在 C# 中使用`Dictionary<string, int>`可能是一种“更好的做法”。这在 PowerShell 中也是可能的，但不太可能在 PowerShell 中让事情变得“更好”。

类似 PowerShell 的解决方案可能是使用`Group-Object -NoElement`. 这是更好的方法还是实践？我不知道。这取决于一些因素，包括偏好。这是示例：

```
'a', 'A', 'foo', 'foo' , 'bar' | Group-Object -NoElement 
```

输出：

```
Count Name
----- ----
    2 a
    2 foo
    1 bar 
```

# ibm-sbt - IBM Social Business Toolkit SDK 支持哪些平台？

> ID：13357583
> 
> 赞同：-2
> 
> 时间：2012-11-13T08:32:36.510
> 
> 标签：ibm-sbt

IBM Social Business Toolkit SDK 支持哪些平台？我可以在 IBM Domino/XWork 服务器上运行 SDK 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:35:57.757

支持以下平台：

*   WebSphere 应用服务器 7
*   门户网站 8
*   多米诺服务器 8.5
*   雄猫 7

所以是的，您可以在 IBM Domino/XWork 服务器上使用 SDK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T18:16:59.857

SDK 应该可以在任何 J2EE 服务器上以最少的工作量工作。

WebSphere Application Server、Portal 8、Domino 8.5、Tomcat 7 是经过测试的版本。

# asp.net-mvc - 基于安全性更改 Kendo UI MVC 命令按钮

> ID：13357588
> 
> 赞同：0
> 
> 时间：2012-11-13T08:32:52.427
> 
> 标签：asp.net-mvc, kendo-ui

我有一个使用服务器绑定的 Kendo Grid，并在 Razor 视图中定义，例如 @(Html.Kendo().Grid 等...

我正在使用内联编辑，它可以找到但是我只想在用户属于某个角色时显示销毁按钮。

关于实现这一目标的最佳方法的任何想法？理想情况下，我想编写某种扩展方法，以便可以执行以下操作：

```
columns.Command(command => { command.Destroy().If(IsInRole("Admin")) }; 
```

任何指针都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:14:07.737

我会这样做：

```
columns.Command(command =>
{
    if (IsInRole("Admin"))
    {
        command.Destroy();
    }
}); 
```

# codeigniter - 会话空代码点火器

> ID：13357589
> 
> 赞同：2
> 
> 时间：2012-11-13T08:32:53.457
> 
> 标签：codeigniter, session, codeigniter-form-helper

首先，对不起我的英语：D

我尝试在 Codeigniter 上进行简单的登录，但没有成功。我阅读了官方文档并将脚本减少到最低限度。每次我重定向或刷新页面或转到另一个控制器时，我的会话都是空的。如果我只创建一个控制器并进行简单的读取和写入，它会运行良好，直到我刷新或重定向。

这就是我想要做的：1）第一个控制器是主控制器。使用登录表单加载视图。此表单对方法 validation_form 和 username_check 回调有一个操作。

2）如果用户能够登录，我设置我的用户数据并重定向到受限控制器，这是我的受限区域。

PS我在自动加载中使用库会话，并且选项数据库处于活动状态。我也有自动加载的数据库库。

主控制器

```
class Main extends CI_Controller {

public function __construct(){
    parent::__construct();

}

public function index()
{
    $this->load->view('login_view');
}

public function validation_form()
{
    $this->load->library('form_validation');
    $this->form_validation->set_rules('email', 'Email', 'required|callback_username_check');
    if ($this->form_validation->run() == FALSE){
       echo 'validation_error';
    }else{
       redirect('/restricted');
    }
}

public function username_check(){
    $this->load->model('login_model');
    $email=$this->input->post('email');
    $login=$this->login_model->validate($email);
    if ($login != FALSE){                    
                return true;
    }
    return false;
} 
```

}

登录模式

```
class Login_model extends CI_Model{

public function __construct(){
    parent::__construct();
}

 public function validate($email){

    // Prep the query
    $this->db->where('EmailDatore', $email);

    // Run the query
    $query = $this->db->get('Datore');
    // Let's check if there are any results
    if($query->num_rows() == 1)
    {
        // If there is a user, then create session data
        $row = $query->row();
        $data = array(
                'email' => $row->EmailDatore,
                'nome' => $row->Nome,
                'cognome' => $row->Cognome,                    
                'validated' => true
                );
        $this->session->set_userdata($data);
        return true;
    }
    // If the previous process did not validate
    // then return false.
    return false;
} 
```

}

RESTRICTED CONTROLLER 类 受限扩展 CI_Controller{

```
 public function __construct(){
    parent::__construct();
    $this->check_isvalidated();
}

public function index(){
    // If the user is validated, then this function will run
    echo 'Congratulations, you are logged in.';
}

private function check_isvalidated(){
    if(! $this->session->userdata('validated')){
        redirect('main');
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:45:17.020

模型中的错字，不确定是否还有其他错误，但至少有这个错误，这意味着您永远无法完成成功代码。

```
 if($query->num_rows() == 1) 
```

编辑 - 这里也有错误，你传递了 $data 但填充了 $email。因此模型得到一个空字符串。

```
public function username_check(){
$this->load->model('login_model');
$email=$this->input->post('email');
$login=$this->login_model->validate($email);
if ($login != FALSE){                    
            return true;
}
return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:19:21.163

我认为回调函数也可以是这样的。

```
public function username_check($str){
   $this->load->model('login_model');
   $login=$this->login_model->validate($str);
   if ($login != FALSE){                    
            return true;
   }
return false; 
```

您的代码是到达模型还是回调失败？它没有到达代码的哪些部分？放置 vardump(); 或者死（）; 去检查。

# asp.net - Web 应用程序托管 Asp.net

> ID：13357598
> 
> 赞同：1
> 
> 时间：2012-11-13T08:33:35.427
> 
> 标签：asp.net, iis, web-applications, frameworks, windows-server-2003

我托管了一个 Web 应用程序`Windows 7`，现在我希望它托管在`Windows Server 2003`.

我收到这个错误。

我将应用程序复制到服务器并添加了一个指向它的新虚拟目录。

当我想从 IIS 浏览应用程序时，会出现此错误：

```
Configuration Error:

Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately.

Parser Error Message: Unrecognized attribute 'type'.

Source Error: 

    <configuration>
       <configSections>
           <sectionGroup name="system.web.extensions" 
                         type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, 
                         Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"> 
```

有什么解决方案可以解决这个错误，或者有没有其他方法可以从 过渡`Windows 7`到`Windows Server 2003`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:53:44.020

安装 .NET Framework 4.0 后，确保其状态在 IIS 内的 Web 服务扩展中设置为允许。

![IIS Web 服务扩展](../Images/88f52b7166134a9341148a159ef28c9c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:35:58.953

我不确定，但发生这种情况是因为您的服务器没有安装 .net 框架，因为您在自己的计算机中有目标。

2天前我有同样的问题。在我的情况下，我已经更新了服务器没有新版本 .net 的 web.config。

在您的情况下，您需要将新版本的 .net 安装到服务器 2003。

# c - 不用叉子能用管子吗？

> ID：13357599
> 
> 赞同：9
> 
> 时间：2012-11-13T08:33:37.137
> 
> 标签：c, linux, posix, fork

我可以在两个进程之间使用管道而不使用 fork 并与例如 socket 共享文件描述符吗？我不需要其他解决方案，我需要两个未分叉的进程之间的管道。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T08:43:54.630

您可以使用命名管道（FIFO）：

如果你这样做`mkfifo <common path>`，你可以在两个进程中使用这个路径，一个用于读取，一个用于写入。然后您的行为与普通管道相同。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T09:52:38.587

最简单的解决方案是使用命名管道，它是在文件系统中具有名称的管道，以便两个进程都可以引用它。通过`mkfifo()`调用创建命名管道，并打开命名管道`open()`（一个进程应该打开它以进行读取，而另一个用于写入）。

您*也可以*将匿名管道与两个不相关的进程一起使用，但要这样做，您需要以某种方式将创建管道的进程中的打开文件描述传递给另一个进程。您可以通过`SCM_RIGHTS`在 UNIX 域套接字上使用消息来做到这一点，但如果您有一个 UNIX 域套接字，那么您可以使用它而不是管道来进行通信。Linux 特定的方法是让第二个进程在第一个进程中表示管道末端`open()`的`/proc/<pid>/fd/<fd>`符号链接上使用，但这是非常巴洛克式的。

# java - listCellRenderer 内的 java jcombobox

> ID：13357603
> 
> 赞同：0
> 
> 时间：2012-11-13T08:34:09.913
> 
> 标签：java, swing, jpanel, jcombobox, listcellrenderer

我想创建一个包含数据项和 jCombobox 的列表。我使用这个 listCellRenderer ：

```
public class DeliveryListCellRenderer extends JPanel implements ListCellRenderer{

     JLabel[] lbl = new JLabel[2];  
     JComboBox combo;

  public DeliveryListCellRenderer()  
  {  
    setLayout(new GridLayout(0,2,15,0));  
    lbl[0] = new JLabel("",JLabel.RIGHT);  
    add(lbl[0]);  
    lbl[1] = new JLabel("",JLabel.LEFT);  
    add(lbl[1]);
    String[] timeZones = {"timeZone 1", "timeZone 2", "timeZone 3", "timeZone 4"};

    combo = new JComboBox(timeZones); 
    combo.setSelectedIndex(1);

    add(combo);
  }  
  public Component getListCellRendererComponent(JList list,Object value,  
                      int index,boolean isSelected,boolean cellHasFocus)  
  {  
    Delivery delivery = (Delivery)value;  
    lbl[0].setText("X : "+delivery.getNode().getX());  
    lbl[1].setText("Y : "+delivery.getNode().getY());
    if(isSelected) setBackground(Color.CYAN);  
    else setBackground(Color.WHITE);  
    return this;  
  }  
} 
```

当我运行应用程序时，一切正常，但是当我单击组合框时没有任何反应。

有人有想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:56:43.520

> 当我运行应用程序时，一切正常，但是当我单击组合框时没有任何反应。

*   这不是`Renderer`( `When I run the application, everything appears ok`) 的工作，必须使用`XxxEditor`

*   基本上这是不可能的`JList`，看看`JTable`

*   [具有一列和/或没有 JTableHeader 的 JTable](https://stackoverflow.com/a/6355910/714968)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:26:02.647

您需要使用您的对象映射要在组合框中显示的内容。

我建议以下几点：（T 是您的对象的类型）。

```
 public class CustomComboBoxRenderer extends JLabel implements ListCellRenderer<T> {

    @Override
    public Component getListCellRendererComponent(JList<? extends T> list, T value, int index, boolean isSelected, boolean cellHasFocus) {

    if (isSelected) {
        setBackground(list.getSelectionBackground());
        setForeground(list.getSelectionForeground());
    }
    else {
        setBackground(list.getBackground());
        setForeground(list.getForeground());
    }
    if (index == -1) {
        setOpaque(false);
        setForeground(list.getForeground());
    }
    else {
        setOpaque(true);
    }
    setFont(list.getFont());

    if (value != null) {
        setText(value.getName());
    }

    return this;
    }
} 
```

组合框创建：

```
 JComboBox<T> comboBox = new JComboBox<T>();
    comboBox.setRenderer(new CustomComboBoxRenderer ());
    add(comboBox); 
```

希望这可以帮助。

# javascript - Require.js 模板“跨源请求仅支持 HTTP”错误

> ID：13357607
> 
> 赞同：5
> 
> 时间：2012-11-13T08:34:14.010
> 
> 标签：javascript, backbone.js, requirejs

我一直在使用 Require.js 和 Backbone.js 等。我一直在尝试制作一个简单的 todo 应用程序，我通过从桌面双击 index.html 并在浏览器中显示并使用它来运行它。

但是，当通过 Require.js 获取模板时，它给了我以下错误：

```
XMLHttpRequest cannot load file:///C:/bada/js/templates/headerTemplate.html. Cross origin requests are only supported for HTTP. 
```

我知道这是因为我没有从服务器发出请求。我知道在 Chrome 中，这个错误可以通过在启动 Chrome 时使用一些参数来抑制，但我也打算在我的手机上使用这个应用程序，通过在本地运行 index.html。

有没有办法防止这个错误发生并且让应用程序正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T07:43:20.813

使用 Google Chrome，您可以使用标志 --allow-file-access-from-files 来执行此操作。这样它就可以访问您的本地文件系统。

我建议更改 Chrome 图标的属性并默认启用该标志。其他浏览器可能有类似的东西，但我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:46:40.683

简短的回答：没有。

更长的答案：查看应用程序缓存。

在您的应用程序完成构建之前不要这样做。但是在它建成之后，如果你设置一个离线缓存并利用`localStorage`（如果需要），它应该可以在最受尊敬的手机/平板电脑/笔记本电脑/PC 上运行。

但就像我说的，***在***您准备好冻结所有文件数据之前，***不要***设置缓存清单。 它在缓存数据方面做得非常好，这很棒... ...但是如果您对任何文件进行更改，则使缓存无效以下载最新版本，使用新内容重置缓存变得非常痛苦...

 *...如果您喜欢像我一样每 5 分钟按一次 CTRL+S，只是为了安全起见... ...如果您想看到这些微小的变化，那么您会头疼的。*

# ruby-on-rails - Ruby on Rails - 如何隐藏物理图像路径

> ID：13357608
> 
> 赞同：0
> 
> 时间：2012-11-13T08:34:14.083
> 
> 标签：ruby-on-rails

我们如何在 Rails 应用程序中隐藏物理图像路径。目前我有以下 RoR 代码来在我的应用程序中显示图像。

```
<%= image_tag("student_pictures/#{@student.admission_no}.jpg") %> 
```

找到了几种使用 PHP 执行此操作的解决方案，但到目前为止我还没有在 RoR 中遇到过解决方案。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:18:49.513

我不确定您最终要达到什么目标，据我所知，以下是您留下的两条路径。

1 - 显示网址（因为基本上浏览器显示图像它应该在一个可以公开访问的地方，所以如果你获取网页的源代码，你应该能够查看图像网址，如果你发布它在浏览器 url 你应该看到图像）

2 - 动态生成图像（我在 Java 中完成了此操作，但没有使用 rails）（而是将图像物理存储在磁盘中，当用户需要时将图像作为字节流写入浏览器）

但如果你能告诉我们你该怎么做，我们可能会想出一个替代方案:)

# magento - Magento 缓存 product_id

> ID：13357611
> 
> 赞同：0
> 
> 时间：2012-11-13T08:34:27.560
> 
> 标签：magento, caching, containers, product

如何从容器中检索 ProductId 参数？

回答：您不是从容器中检索参数，而是从您的块中检索参数。我已经阅读了堆栈上的答案，但没有一个告诉我如何从容器中检索参数..

编辑：感谢我重新提出我的问题的答案！下面的工作代码。

View.php：/app/code/local/Stackoverflow/Testcase/Block

```
class Stackoverflow_Testcase_Block_View extends Mage_Core_Block_Template
{

public function getParameters() {

    if (Mage::registry('current_product')) { 

        $product_id = Mage::registry('current_product')->getId(); 

    } else { 

        $product_id = $this->getProductId(); 

    }

    //Make sure we are not cached

    echo "time:".time()."<br/>";

    //This variable will be visible after the second load because it must be cached first!
    //NOTE that you are not able to save variables with an underscore ;-)

    echo "test_var:".$this->getTestVar()."<br/>";

    return "product_id: ".$product_id;

}

public function getCacheKeyInfo()
{
    $info = parent::getCacheKeyInfo();
    if (Mage::registry('current_product'))
    {
        $info['product_id'] = Mage::registry('current_product')->getId();
    }

    $info['test_var'] = "first second third";

    return $info;
}

} 
```

Testcase.php：/app/code/local/Stackoverflow/Testcase/Model/Container

```
class Stackoverflow_Testcase_Model_Container_Testcase extends Enterprise_PageCache_Model_Container_Abstract { 

protected function _getIdentifier()
{
    return $this->_getCookieValue(Enterprise_PageCache_Model_Cookie::COOKIE_CUSTOMER, '');
}

protected function _getCacheId()
{
    return 'TESTCASE' . md5($this->_placeholder->getAttribute('cache_id') . ',' . $this->_placeholder->getAttribute('product_id')) . '_' . $this->_getIdentifier();
}

protected function _renderBlock()
{
    $blockClass = $this->_placeholder->getAttribute('block');
    $template = $this->_placeholder->getAttribute('template');

    $block = new $blockClass;
    $block->setTemplate($template)
        ->setProductId($this->_placeholder->getAttribute('product_id'))
        ->setTestVar($this->_placeholder->getAttribute('test_var'));

    return $block->toHtml();
}

protected function _saveCache($data, $id, $tags = array(), $lifetime = null) { return false; }  

} 
```

testcase.phtml：app/design/frontend/xxx/default/template/stackoverflow

```
 $block_html = $this->getParameters();

    echo $block_html;

?> 
```

Catalog.xml：app/design/frontend/ll/default/layout

`

```
 <label>Catalog Product View (Simple)</label>

    <reference name="product.info">

        <block type="catalog/product_view_type_simple" name="product.info.simple" as="product_type_data" template="catalog/product/view/type/default.phtml">

            <block type="core/text_list" name="product.info.simple.extra" as="product_type_data_extra" translate="label">

                <label>Product Extra Info</label>

            </block>

            <block type="testcase/view" name="testcase" as="testcase" template="stackoverflow/testcase.phtml"/>

        </block>

    </reference>

</PRODUCT_TYPE_simple> 
```

`

default.phtml：app/design/frontend/xxx/default/template/catalog/product/view/

```
<?php echo $this->getChildHtml('testcase') ?> 
```

下面的代码可能无关紧要，但是.... config.xml: /app/code/local/Stackoverflow/Testcase/etc

```
<?xml version="1.0"?>
<config>
    <modules>
        <Stackoverflow_Testcase>
            <version>0.1.0</version>
        </Stackoverflow_Testcase>
    </modules>
    <global>
        <blocks>
            <testcase>
                <class>Stackoverflow_Testcase_Block</class>
            </testcase>
        </blocks>
    </global>
</config> 
```

cache.xml：/app/code/local/Stackoverflow/Testcase/etc

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <placeholders>
        <stackoverflow_testcase>
            <block>testcase/view</block>
            <name>testcase</name>
            <placeholder>STACKOVERFLOW_TESTCASE</placeholder>
            <container>Stackoverflow_Testcase_Model_Container_Testcase</container>
            <cache_lifetime>1</cache_lifetime>
        </stackoverflow_testcase>
    </placeholders>
</config> 
```

Stackoverflow_Testcase.xml：/app/etc/modules

```
<?xml version="1.0"?>
<config>
    <modules>
        <Stackoverflow_Testcase>
            <active>true</active>
            <codePool>local</codePool>
        </Stackoverflow_Testcase>
    </modules>
</config> 
```

谢谢，

马汀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:16:01.803

以`Enterprise_PageCache_Model_Container_Sidebar_Cart`容器为例：

> 文件：app/code/core/Enterprise/PageCache/Model/Container/Sidebar/Cart.php

```
$renders = $this->_placeholder->getAttribute('item_renders'); 
```

为了访问容器中的变量，您需要将其添加到`cachekeyinfo`Block 类中：

> 文件：app/code/core/Mage/Checkout/Block/Cart/Sidebar.php

```
public function getCacheKeyInfo()
    {
        $cacheKeyInfo = parent::getCacheKeyInfo();
        $cacheKeyInfo['item_renders'] = $this->_serializeRenders();
        return $cacheKeyInfo;
    } 
```

**编辑：**

在你的容器中试试这个：

```
protected function _renderBlock()
    {
        $blockClass = $this->_placeholder->getAttribute('block');
        $template = $this->_placeholder->getAttribute('template');

        $block = new $blockClass;
        $block->setTemplate($template)
            ->setProductId($this->_placeholder->getAttribute('product_id'););
        return $block->toHtml();
    } 
```

并在你的街区试试这个：

```
public function getCacheKeyInfo()
    {
        $cacheKeyInfo = parent::getCacheKeyInfo();
        $cacheKeyInfo['product_id'] = $this->getRequest()->getParam('ProductId');
        return $cacheKeyInfo;
    } 
```

# google-app-engine - 为什么我从谷歌应用引擎得到 XMLHttpRequest 错误状态 0？

> ID：13357614
> 
> 赞同：0
> 
> 时间：2012-11-13T08:34:38.727
> 
> 标签：google-app-engine, servlets

我在谷歌应用引擎上有一个应用程序。我只需要更新它并添加一些额外的功能。我为此写了一个servlet。并使用我之前在整个应用程序中使用的 jQuery.ajax() 发送请求。请求转到 servlet 并执行我想做的所有操作。并为响应创建一个 json 字符串。servlet 也不例外。但我在客户端收到 XMLHttpRequest 错误状态 0。我尝试了很多搜索并查看了文档，但无法解决。有人知道为什么会这样吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T14:50:12.977

可能是 google app engine 的跨域问题，部分 google 站点会忽略 XMLHttpRequest 生成的跨域 HTTP OPTION 请求。

XMLHttpRequest POST/PUT 将首先向另一个域上的资源发送一个 HTTP OPTIONS 请求标头，以确定实际请求是否可以安全发送。但有些谷歌网站总是针对这个请求回复“404 Not Found”。您将在回调函数中收到 http_request.status = 0。

您可以使用 Chrome 浏览器并按“F12”以使用开发人员工具来监控 HTTP OPTIONS 问题。

# java - javax.servlet.ServletException：缺少 jspFile

> ID：13357615
> 
> 赞同：0
> 
> 时间：2012-11-13T08:34:42.900
> 
> 标签：java, tomcat

我使用tomcat 7.0.29，当我部署我的应用程序（一个小程序）并从eclipse启动tomcat时，我收到了这个错误。

严重：Servlet /test 引发 load() 异常`javax.servlet.ServletException`：缺少 jsp 文件

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:53:35.253

维基百科告诉我

> Java 小程序可以在使用 Java 虚拟机 (JVM) 的 Web 浏览器中运行，也可以在[Sun 的 AppletViewer](http://en.wikipedia.org/wiki/AppletViewer)（一种用于测试小程序的独立工具）中运行

为此：

> 严重：Servlet /test 抛出 load() 异常 javax.servlet.ServletException：缺少 jspFile

你的 Applet 真的包含 JSP 文件吗？如果是这样，那么您可以运行它`TOMCAT`

要运行`Java Applet`嵌入`<applet>`标签，如下所示：

```
<!DOCTYPE HTML PUBLIC 
  "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<HTML>
<HEAD>
<TITLE>HelloWorld_example.html</TITLE>
</HEAD>
<BODY>
<H1>A Java applet example</H1>
<P>Here it is: <APPLET code="HelloWorld.class" WIDTH="200" HEIGHT="40">
This is where HelloWorld.class runs.</APPLET></P>
</BODY>
</HTML> 
```

[或者您可以使用 appletviewer，如此处](http://www.cs.colostate.edu/helpdocs/JavaInDOS.html)所示

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-30T16:44:38.243

我有同样的问题，我发现在我的 web.xml 中提到了一个 JSP 文件。我将此 JSP 文件放在其他目录中，但忘记更新 web.xml 中的路径。一旦我更新了 web.xml 中的路径。错误已解决。

```
 <servlet>
    <servlet-name>TH</servlet-name>
    <jsp-file>/Representation/th.jsp</jsp-file>
  </servlet>

   <servlet-mapping>
     <servlet-name>TH</servlet-name>
     <url-pattern>/th.html</url-pattern>
  </servlet-mapping> 
```

# javascript - 可调整大小 里面 。如何不影响身高？

> ID：13357619
> 
> 赞同：0
> 
> 时间：2012-11-13T08:35:11.693
> 
> 标签：javascript, jquery, resizable, jquery-resizable

我`div`在单元格中有可调整大小（JQuery UI Resizable）`td`。`td`有 css 属性`height=18px`。但是当我调整这个大小时`div`，表格单元格也调整了大小。

那么是否有可能调整大小`div`而不影响`td`高度？

**解决了！**

# c++ - boost::shared_ptr 上的 BOOST_FOREACH 崩溃？

> ID：13357633
> 
> 赞同：1
> 
> 时间：2012-11-13T08:36:32.583
> 
> 标签：c++, boost

尝试在 shared_ptr 向量上做一个简单的事情并崩溃？我怀疑我做错了什么？

```
std::vector< shared_ptr<SUBCLASS> > m_vecSections;

shared_ptr<SUBCLASS> hoodSection;
BOOST_FOREACH(hoodSection, m_vecSections ){
   //do something
} 
```

我正在崩溃

```
 void add_ref_copy()
{
    atomic_increment( &use_count_ );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:44:30.577

我认为你的语法应该是：

```
BOOST_FOREACH(shared_ptr<SUBCLASS> hoodSection , m_vecSections ){
   //do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T10:00:44.880

`m_vecSections`您是否从内部添加或删除元素`BOOST_FOREACH`？

这可能会导致未定义的行为，因为`BOOST_FOREACH`缓存了结束迭代器（因此如果向量发生更改，它将变得无效）。见[http://www.boost.org/doc/libs/1_52_0/doc/html/foreach/pitfalls.html](http://www.boost.org/doc/libs/1_52_0/doc/html/foreach/pitfalls.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T10:17:26.733

谢谢你们

你没有机会找到它，这样的电话......

weak_ptr 弱罩（shared_ptr（这个））；

释放 m_vecSections 并导致崩溃......

# sql - PL/SQL 调用 webservice https ORA-03113 通信通道上的文件结尾

> ID：13357634
> 
> 赞同：3
> 
> 时间：2012-11-13T08:36:36.190
> 
> 标签：sql, web-services, oracle, plsql, google-calendar-api

我正在尝试与 Google 日历交谈。我的身份验证有问题。我写下下面的代码。

```
create or replace function authenticate_service(
        p_email in varchar2,
        p_password in varchar2)    return varchar2  is
        l_request           utl_http.req;
        l_response          utl_http.resp;
        l_params            varchar2(255);
        l_resp_data         varchar2(4000);
        l_auth_token        varchar2(4000);     begin

        -- access the oracle wallet to allow us to make an https request
        utl_http.set_wallet(
            path => 'file: ***',
            password => '***');

        -- set up the request body with our credentials
        l_params := 'Email=' || p_email || '&Passwd=' || p_password ||
                        '&service=cl' || '&source=e-DBA-test-1.0';

        l_request := utl_http.begin_request(
                        'https://www.google.com/accounts/ClientLogin',
                        'POST',
                        'HTTP/1.1');

        -- set the request headers
        utl_http.set_header(
            l_request,
            'Content-Type',
            'application/x-www-form-urlencoded');
        utl_http.set_header(
            l_request,
            'Content-Length',
            length(l_params));

        -- write out the request body
        utl_http.write_text( l_request, l_params );

        -- get the response
        l_response := utl_http.get_response( r => l_request );

        dbms_output.put_line('Status Code: '||l_response.status_code);

     begin
        loop
            utl_http.read_line( r => l_response, data => l_resp_data,remove_crlf => TRUE);
            if substr(l_resp_data, 1, 5) = 'Auth=' then
                l_auth_token := substr(l_resp_data, 6);
            end if;
        end loop;
     exception
        when utl_http.end_of_body then
            null;
     end;
        utl_http.end_response ( l_response );
    dbms_output.put_line(l_auth_token);      return l_auth_token;
        end authenticate_service; 
```

一切正常，但是...当我尝试连续调用几次身份验证时，有时我发现此错误 Oracle ORA-03113: end-of-file on communication channel 然后 ORA-03114: not connected to ORACLE。我不知道它为什么会发生以及如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:48:14.473

你应该请求甲骨文的支持，提出一个焦油。该功能“nzos_Create_Ctx”与证书区域相关，但我可以看到此错误的 Oracle 支持没有匹配项。您可能想玩弄钱包，因为它可能在某些方面不兼容。即你确定钱包是有效的等等。oracle 会希望你发送跟踪转储文件 + 测试用例来诊断这个。

你是如何创建钱包的以及你在里面放了什么证书（没有客户端证书对吗？）

跟进，我尝试了你的代码，它在这里的测试数据库（11g）上正常工作。我使用 oracle 钱包管理器（没有提出证书请求）创建了一个钱包（标准类型，而不是 pkcs11 选项）并添加了中间 Thwarte 证书。然后我调用了你的函数（将钱包位置更改为：

```
 utl_http.set_wallet(
        path => 'file:/u01/app/oracle/product/11.2.0/owm/wallets/oracle',
        password => 'test1234'); 
```

并得到了正确的回应：

```
SQL> select authenticate_service('xxxx@gmail.com', 'foo') from dual;

AUTHENTICATE_SERVICE('XXXX@GMAIL.COM','foo')
--------------------------------------------------------------------------------
DQAAAMUAAAA5n...etc... 
```

即我的证书存储看起来像这样：

![Linux上的OWM](../Images/0222c60f45a628965ecf05b62b959d37.png)

# javascript - History Api：如何告诉浏览器页面正在加载？

> ID：13357641
> 
> 赞同：13
> 
> 时间：2012-11-13T08:36:56.443
> 
> 标签：javascript, jquery, ajax, api, browser-history

当我通过 javascript/jquery 异步加载页面时，我一直在使用历史 API。我想知道如何告诉浏览器该站点正在加载，以便浏览器可以显示加载图片（如 Firefox 中的旋转轮）。

编辑：

更加具体：

如果我在我的网站上加载一个页面，则 url 会更改，会显示新内容，但 Firefox 不会将旋转轮显示为页面正在加载的信号。

如果我从 Facebook 的时间线上打开一张图片，图片正在加载，url 发生变化，Firefox 显示旋转轮显示，图片正在后台加载。

我也想要那个纺车！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T12:39:30.717

我在这些问题中找到了答案：

[如何让 AJAX 触发浏览器的加载](https://stackoverflow.com/questions/1918218/how-to-have-ajax-trigger-the-browsers-loading)

```
var i = $('<iframe>');
console.log(i);
i.appendTo('body');
function start() {
    i[0].contentDocument.open();
    setTimeout(function() {
        stop();
    }, 1000);
}
function stop() {
    i[0].contentDocument.close();
    setTimeout(function() {
        start();
    }, 1000);
}

start(); 
```

来源：[jsFiddle](http://jsfiddle.net/KSXkS/1/)

该脚本创建一个 iframe，由 ajax.start 和 ajax.stop-event 触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:48:27.063

好吧，异步请求知道正在加载某些内容。您只需要自己在其他地方传播该事件。例如，使用 beforeSend 钩子：

```
$.ajax('/your_stuff', 
       beforeSend: function() {
         $(document).trigger('loading');
       }
       ....) 
```

接着：

```
$(document).on('loading', function() { alert("request is loading");} 
```

我建议您在使用历史 API 更新 URL 的同时触发该事件。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-13T08:56:39.847

我从标签中假设您正在为您的 AJAX 使用 jQuery。您可以使用全局 AJAX 处理程序，无论您在代码中的何处调用 ajax 方法`$.ajaxStart()`，这些都会触发`$.ajaxComplete()`

```
$('#myLoadingDiv').ajaxStart(toggleLoading).ajaxComplete(toggleLoading);

function toggleLoading(){
   $(this).toggle();
} 
```

API 参考 [http://api.jquery.com/ajaxStart/](http://api.jquery.com/ajaxStart/)

我认为根据您的问题措辞，您希望能够控制实际浏览器选项卡本身的加载图像。你无法控制它。在页面内使用您自己的图像或文本对用户来说也更明显

**编辑**您必须在元素中提供您自己的加载动画`id=myLoadingDiv`才能使此代码正常工作

# php - php json_encode & 解码

> ID：13357642
> 
> 赞同：0
> 
> 时间：2012-11-13T08:37:16.280
> 
> 标签：php, json

我有一个 json 数组存储在一个文件中，如下所示：

```
["bla bla","bla bla2","bla bla3"] 
```

如果我想使用下面的代码从 json 数组中删除其中一个对象，则 json 将转换为另一种类型的数组，如下所示：

```
{"1":"bla bla","2":"bla bla2","3":"bla bla3"} 
```

我不希望这种情况发生，因为它在另一个地方搞砸了代码。我怎样才能做到这一点？

```
$eng = json_decode($en_banners, false);

unset($eng[$id]);

$myFile = "languages/banners.php";
$fh = fopen($myFile, 'w') or die("can't open file");
$stringData = "<?php \$de_banners='".json_encode($eng) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:48:11.200

JavaScript 数组是从零开始的，因此除非您填补空白，否则无法从带有间隙的 PHP 数组创建 JavaScript 数组：

```
$en_banners = '["bla bla","bla bla2","bla bla3"]';
$eng = json_decode($en_banners, false);
var_dump($eng);
$id = 0;
$eng[$id] = null; // Rather than: unset($eng[$id]);
var_dump(json_encode($eng)); 
```

如果数组键不相关，您可以简单地忽略它们：

```
$en_banners = '["bla bla","bla bla2","bla bla3"]';
$eng = json_decode($en_banners, false);
var_dump($eng);
$id = 0;
unset($eng[$id]);
var_dump(json_encode(array_values($eng))); 
```

如果这些解决方案都不适用，我们需要更多数据:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:40:22.193

将您的 json_decode false 设置为 true。如果它为 false，则解码器生成 php 对象，如果它为 true，则从该 json 生成 PHP 数组。

```
$eng = json_decode($en_banners, TRUE); 
```

之后 json_encode 将 php 对象转换为 json 对象，将 php 数组转换为 json 数组..

附言

取消设置后添加...

```
 $eng = array_values($eng); 
```

清理数组键

```
$eng = json_decode($en_banners, TRUE);

unset($eng[$id]);
$eng = array_values($eng);
$myFile = "languages/banners.php";
$fh = fopen($myFile, 'w') or die("can't open file");
$stringData = "<?php \$de_banners='".json_encode($eng); 
```

# html - 如何创建透明框架集？

> ID：13357654
> 
> 赞同：1
> 
> 时间：2012-11-13T08:38:28.907
> 
> 标签：html, css, frameset

我想在一个框架集中创建一个包含 3 个框架的页面。

My`Home.html`是主页，有 3 个框架，即`Header.html`,`Announcement.php`和`Footer.html`.

```
<frameset rows="10%,*,5%" noresize frameborder="NO" FRAMESPACING="0" scrolling="NO" >
   <frame src="Header.html" scrolling="NO">
   <frame src="Announcement.php" name="container">
   <frame src="Footer.html" scrolling="NO">
</frameset><noframes></noframes> 
```

在里面`Header.html`，我将html的样式定义为在`Frame.css`. 其他 2 帧也是如此。

```
html
{
    background-color : transparent;
} 
```

但`Home.html`不显示的背景。但是当我删除 时`frameset`，会显示背景。

我上传到[这里](http://anonynewbie.site11.com/IMS/Home.html)。

那么我该如何解决这个问题呢？

编辑 ：

基于[这个](http://code.google.com/p/doctype-mirror/wiki/FrameAllowtransparencyAttribute)页面，`allowtransparency`属性浏览器是否可靠？

解决 ：

我尝试使用 Mozilla Firefox 查看页面，似乎使用`allowtransparency`属性，但是当我使用 chrome、IE9 和 Opera 12 查看页面时，它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:41:21.413

采用：

```
<frame allowtransparency="true" ...> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:41:54.877

尝试设置

```
<frame allowtransparency="true"> 
```

[http://www.webreference.com/js/tips/010209.html](http://www.webreference.com/js/tips/010209.html)

# json - 如何在 JQuery 中读取 json 键名

> ID：13357655
> 
> 赞同：1
> 
> 时间：2012-11-13T08:38:41.963
> 
> 标签：json, jquery

在这种情况下，我有一种读取或获取密钥名称的方法（如果我的术语是正确的），我指的是“homedata”或“faq”。我想知道是“homedata”还是“faq”，以便我可以将它存储在一个变量中并用于比较。对于我的 jquery，这是我的脚本：

```
var varHolder ="";  
$.ajax({
type: "POST",
//data: data_json,
dataType: "json",
url: "sql_queries.php",
success: function(data) {
$.each(data, function(key, val) {

            //read the index name here and store it to varholder
            varHolder = data[key];

            //then compare it like this
            if(varHolder == "homedata"){
                //write something to the dome
            }else if(varHolder == "faq"){
                //write something to the dome
            }
        });

    },
    error:function(){
           console.log("error fetching data. please refresh the page");//alert("Send Email Failure,Please try again");
    },
    complete:function(){
        console.log("complete");//alert("Send Email Failure,Please try again");
    }
}); 
```

这是我的 json 结果：

```
[
{
"homedata":
    {
    "approve_title":"home bla blah",
    "approve_desc":"this is the approve JSON"
    }
},
{
"homedata":
    {
    "approve_title":"another home bla blah",
    "approve_desc":"tthis is the approve JSON",
    "approve_path":"backend/pdf/this is the approve JSON.pdf"
    }
},
{
"faq":
    {
    "progproj_title":"whatever JSON",
    "progproj_details":"sos sos sos"
    }
} 
```

]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:41:05.740

您可以使用点符号如果您的 json 响应看起来像

```
data = [{ key : value }, { key2 : value2} ] 
```

您可以将键下的值设置为

```
var value = data[0].key;
var value2 = data[1].key; 
```

**编辑**

好的，我在[这里做了一个粗略的小提琴](http://jsfiddle.net/QkTZ6/5/)它将遍历您的 json 响应并将“homedata”或“faq”键的名称写入 div。请注意，它每次都会覆盖，因此 json 数组中的最后一个键将显示在最后。这只是为了说明如何获取键名。希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:49:03.063

“console.log（数据）；” // 这已经保存了索引的名称，所以你可以这样做 elementIndexName = ''+data; 或“ $.each(data, function(key, val) {

```
 //read the index name here and store it to varholder
        varHolder = ""+data;

        //then compare it like this
        if(varHolder == "homedata"){
            //write something to the dome
        }else if(varHolder == "faq"){
            //write something to the dome
        }
    });

}, 
```

"

# c# - 将 EF LINQ 方法语法转换为查询语法

> ID：13357656
> 
> 赞同：5
> 
> 时间：2012-11-13T08:38:43.897
> 
> 标签：c#, linq, linq-query-syntax

您将如何使用 LINQ 查询语法编写这个***完全相同的查询？***

```
var q2 = list.GroupBy(x => x.GroupId)
             .Select(g => g
                 .OrderByDescending(x => x.Date)
                 .FirstOrDefault()); 
```

我虽然这应该工作，但它没有：

```
var q1 = from x in list
         group x by x.GroupId into g
         from y in g
         orderby y.Date descending
         select g.FirstOrDefault(); 
```

如果你想玩它，这里有一个测试程序：

```
public class MyClass
{
    public int Id { get; set; }
    public string GroupId { get; set; }
    public DateTime Date { get; set; }

    public override bool Equals(object obj)
    {
        var item = obj as MyClass;
        return item == null ? false : item.Id == this.Id;
    }
}

static void Main(string[] args)
{
    var list = new List<MyClass> 
    {
        new MyClass { GroupId = "100", Date=DateTime.Parse("01/01/2000"), Id = 1},
        new MyClass { GroupId = "100", Date=DateTime.Parse("02/01/2000"), Id = 2},
        new MyClass { GroupId = "200", Date=DateTime.Parse("01/01/2000"), Id = 3},
        new MyClass { GroupId = "200", Date=DateTime.Parse("02/01/2000"), Id = 4},
        new MyClass { GroupId = "300", Date=DateTime.Parse("01/01/2000"), Id = 5},
        new MyClass { GroupId = "300", Date=DateTime.Parse("02/01/2000"), Id = 6},
    };

    var q1 = from x in list
                group x by x.GroupId into g
                from y in g
                orderby y.Date descending
                select g.FirstOrDefault();

    var q2 = list.GroupBy(x => x.GroupId)
                    .Select(g => g
                        .OrderByDescending(x => x.Date)
                        .FirstOrDefault());

    Debug.Assert(q1.SequenceEqual(q2));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:43:09.117

理解查询语法中没有`FirstOrDefault`运算符（如果项目被分组，那么至少一个项目将出现在组中，所以你需要`First`），但其他的东西是这样翻译的：

```
var q1 = from c in list
         orderby c.Date descending
         group c by c.GroupId into g
         select g.First(); 
```

诀窍是，如果您按有序顺序进行分组，则会对组中的项目进行排序。瞧：

`q1.SequenceEqual(q2)`返回真

**顺便说一句**，根据 LINQ Pad，此查询生成**完全相同的 SQL**，与嵌套查询`from x in g orderby x.Date descending select x`

**更新**也是我的坏 -`First`将与 LINQ to Objects 或 LINQ to SQL 一起使用，但与 LINQ to Entities 你应该使用`FirstOrDefault`. 第二个注意事项 - 这些查询（我的查询和嵌套查询）将为 LINQ to SQL 生成相同的 SQL，但使用 EF 我的排序不适用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T08:48:24.547

反射器给了我以下信息：

```
var q2 = from x in list
         group x by x.GroupId into g
         select (
             from x in g
             orderby x.Date descending
             select x).FirstOrDefault(); 
```

看起来是对的。

（如前所述`Lazy`，没有*必要*`FirstOrDefault`代替，因为`First`组不会是空的，但它不会*受到伤害*。）

# node.js - 如何更新正在运行的 Node.js 服务器？

> ID：13357662
> 
> 赞同：5
> 
> 时间：2012-11-13T08:39:30.680
> 
> 标签：node.js, versioning, reverse-proxy

据我了解，Node.js 服务器基本上是一个 JavaScript 文件，由`node`可执行文件运行。是否可以在不停止请求处理的情况下更新此文件？

我想必须为此停止节点可执行文件，所以我认为我应该使用反向代理。例如：

1.  原始服务器版本在 localhost:50001 上侦听
2.  代理服务器监听 webinterface:80 上的请求并将它们转发到 localhost:50001
3.  新的服务器版本应该在 localhost:50002 上启动
4.  代理服务器转发目标应更改为 localhost:50002
5.  应该停止原始服务器版本

这是一种有效的方法吗？如何在多台服务器机器上自动完成这样的版本更新（可从同一个 LAN 访问）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T12:43:45.593

一个不同的“纯节点”解决方案是使用内置的[集群](http://nodejs.org/api/cluster.html)模块：

您的代码作为一个集群客户端（许多）运行。集群服务器进程绑定到端口并在客户端之间进行自动负载平衡。更改代码后，您可以向集群服务器发送信号，它会优雅地重新启动您的客户端，而不会断开任何现有连接。

以下是一些可以为您进行集群服务器管理的项目：

*   [https://npmjs.org/package/cluster-master](https://npmjs.org/package/cluster-master)
*   [https://github.com/daeq/node-cluster-manager](https://github.com/daeq/node-cluster-manager)。

优点：

*   堆栈中的组件更少。（更易于部署/管理。）
*   可以为 CPU 上的每个核心自动启动一个节点进程，因此您的程序可以充分利用底层硬件。
*   无需学习 nginx 的配置语法

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T10:11:06.173

基本上，您可以（应该）做的事情如下：

*   运行 Nginx 等网络服务器作为反向代理
*   在它后面至少使用两个（！）Node.js 实例
*   将会话放入 Redis 等数据库中

当您需要更新系统时，请关闭两个 Node.js 实例之一，对其进行更新，然后重新启动它。然后对另一个做同样的事情。

基本上，这应该做到。

不利的一面是，您可能会在短时间内同时运行不同版本的应用程序，并且您的数据库（例如）需要能够赶上这一点。

# rubygems - 宝石未出现在 JRuby 宝石列表中（已成功安装）

> ID：13357664
> 
> 赞同：0
> 
> 时间：2012-11-13T08:39:33.483
> 
> 标签：rubygems, jruby

这个问题有两个部分：

1.  我今天使用 rvm 安装了 JRuby，安装很顺利。我的系统上还安装了 Ruby 1.9.3。有没有一种简单的方法可以将我在 1.9.3 中拥有的相同 gem 重新安装到 JRuby 中？
2.  我试图在 JRuby 中安装 json gem。首先，我通过执行以下操作从我的默认 Ruby 切换到 JRuby：（`rvm jruby`并通过执行检查以确保我使用的是 jruby `rvm current`）。然后我做到了`jruby -S gem install json`。它成功安装：

    ```
    Successfully installed json-1.7.5-java 
    ```

    但是当我这样做`gem list`（或`jruby -S gem list`）时，我只会得到安装 JRuby 时安装的 gem。我尝试退出终端，然后再次执行 gem list，但它仍然没有显示。

任何帮助表示赞赏。谢谢

# 更新

我发现 gem env 中的 gempath 与安装 gem 的位置不同。如何在此列表中添加另一个新的 gempath（在 bash 中）？**或者最好**如何确保将 gem 安装在正确的 GEM PATH 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:07:22.213

由于我使用 rvm 安装 jruby，因此我使用它将 gem 安装在正确的位置：

```
sudo rvm jruby do gem install json 
```

# qt - Qt 线程信号槽问题

> ID：13357667
> 
> 赞同：0
> 
> 时间：2012-11-13T08:39:43.710
> 
> 标签：qt, qthread

我的线程检查.h

```
 #include <QThread>
        #include <QDebug>
        #include <QMutex>
        class ThreadCheck : public QThread
        {
            Q_OBJECT
        public:
            explicit ThreadCheck(QObject *parent = 0);
            int Val() const;

        signals:
            void signalReceived();

        protected:
            void run();
        public slots:
            void slotReceived();
        private:
            QMutex mutex;
            int num;

        }; 
```

我的 threadcheck.cpp 文件是

```
 #include "threadcheck.h"
        ThreadCheck::ThreadCheck(QObject *parent) :
            QThread(parent)
        {
            connect(this,SIGNAL(signalReceived()),this,SLOT(slotReceived()));
            num = 0;
        }

        int ThreadCheck::Val() const
        {
            return num;
        }

        void ThreadCheck::slotReceived()
        {
            mutex.lock();
            qDebug() << "hello";
            mutex.unlock();
        }

        void ThreadCheck::run()
        {
            while(1)
            {
                emit signalReceived();
            }

        } 
```

主要的.cpp是

```
 #include <QCoreApplication>
        #include "threadcheck.h"
        int main(int argc, char *argv[])
        {
            QCoreApplication a(argc, argv);
            ThreadCheck threadCheck;
            threadCheck.start();
            while(1);
            return a.exec();
        } 
```

当我从 main 启动这个线程时，它没有显示任何输出槽永远不会执行。理想情况下，它应该继续打印你好。

请提出解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:08:33.780

删除 main 函数中的 while(1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-13T19:56:07.250

没有太多关于它的噪音，子类化 QThreads 和覆盖 run() 方法不再是在 Qt 中使用线程的方式。

请阅读[此博客](http://mayaposch.wordpress.com/2011/11/01/how-to-really-truly-use-qthreads-the-full-explanation/)。它为我节省了数小时的头痛。目前尚不清楚此更改何时发生，但该帖子中的示例代码现在在 Qt 5.x 的官方文档中

# web-services - 如何在 AX 2012 中通过 AIF 制作一个简单的吸气剂？

> ID：13357668
> 
> 赞同：1
> 
> 时间：2012-11-13T08:39:55.337
> 
> 标签：web-services, axapta, x++, dynamics-ax-2012, aif

我在 AX 中有一个简单的 getter 类，并希望通过外部程序的 AIF Web 服务使用它。类看起来像这样：

```
static Email getEMail(HcmWorkerRecId _hcmWorkerRecId)
{
    ;
    email = HcmWorker::find(_hcmWorkerRecId).Email();
    return email;
} 
```

我需要什么才能从中获得 AIF Web 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:50:52.673

我只需要添加 SysEntryPointAttribute 元数据属性并将方法设置为公共：

```
[SysEntryPointAttribute]
public Email getEMailByItemValueId(HcmWorkerRecId _hcmWorkerRecId)
{
    ;
    email = HcmWorker::find(_hcmWorkerRecId).Email();
    return email;
} 
```

然后我添加了一个服务和一个服务组并部署了它。

这篇博文有一个很好的帮助：http: [//dynamics-ax.blogspot.de/2011/08/microsoft-dynamics-ax-2012-dive-into_10.html](http://dynamics-ax.blogspot.de/2011/08/microsoft-dynamics-ax-2012-dive-into_10.html)

# pascal - 过程处理帕斯卡

> ID：13357669
> 
> 赞同：0
> 
> 时间：2012-11-13T08:40:01.553
> 
> 标签：pascal, procedure

我正在用帕斯卡编写一个程序。但不知何故，我不明白其原因的错误。你能帮忙吗？

```
Program main;

Procedure A(n : longint);
Procedure B(n : longint);
    Procedure E(n : longint);
        Procedure D(n : longint);
        begin
        WriteLn ('In D. No Call...');
        end;

    begin
    WriteLn ('In E ');
    D(n);
    end;

begin
WriteLn ('In B ');
WriteLn ('Calling A Do -1 ',n);
if n = 1 
 then 
A(1);

end;

begin
  WriteLn ('In A ');
  B(n);
  WriteLn ('Calling B  ',n);
  if(n<1)
  then 
  begin
  C(n);
  end;
  end;

   begin
   A(1);
   end. 
```

我正在尝试从主 proc 调用 proc A，然后 A 调用 B 等等。但是我在 C 中遇到编译错误：

```
Here are the errors I get:
Free Pascal Compiler version 2.2.0 [2009/11/16] for i386
Copyright (c) 1993-2007 by Florian Klaempfl
Target OS: Linux for i386
Compiling prog.pas
prog.pas(32,14) Error: Identifier not found "C"
prog.pas(32,17) Error: Illegal expression
prog.pas(37,4) Fatal: There were 2 errors compiling module, stopping
Fatal: Compilation aborted
Error: /usr/bin/ppc386 returned an error exitcode (normal if you did not specify a source file to be compiled) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T10:05:19.863

只是为了补充 SteB 的答案，这里有几件事可能是错误的。

*   没有命名的过程`C`
*   即使您重命名`E`为`C`，您仍然会收到编译器错误，因为`A`无法调用`C`，因为它不在范围内，因为过程的嵌套（它在范围内`B`）。请参阅[嵌套过程中的静态范围](http://www.cs.washington.edu/education/courses/cse341/03wi/imperative/scoping.html)
*   除此之外，您可能会在运行时遇到堆栈溢出异常，因为`A(1)`调用...`B(1)``A(1)`

例如，如果重命名`E`并`C`缩进：

```
Program main;

Procedure A(n : longint);
    Procedure B(n : longint);
        Procedure C(n : longint);
            Procedure D(n : longint);
                begin
                    WriteLn ('In D. No Call...');
                end;
            begin
                WriteLn ('In C ');
                D(n);
            end;
        begin
            WriteLn ('In B ');
            WriteLn ('Calling A Do -1 ',n);
            if n = 1 
                then A(1);  (* Compiles OK, B is nested within A, but watch recursion *)
        end;
    begin
        WriteLn ('In A ');
        B(n);
        WriteLn ('Calling B  ',n);
        if(n < 1)
            then 
                begin
                    C(n); (* Doesnt compile, since C is nested within B and not in scope of A *)
                end;
    end;
begin
    (* You are in Main here *)
    A(1);
end. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:52:06.057

我认为您错过了“程序C”。
我没有在任何地方看到定义的“过程 C”，错误表明程序也看不到这个例程。

一些更好的缩进可以使事情更清晰，您使用的是嵌套过程（不是真正的最佳实践），但过程 A 和 B 具有相同的缩进级别。

# hudson - 在哈德森的电子邮件分机插件中遵循 cppcheck 的果冻脚本模板有什么问题

> ID：13357670
> 
> 赞同：2
> 
> 时间：2012-11-13T08:40:03.543
> 
> 标签：hudson, jelly, cppcheck, email-ext

在 hudson 的 email-ext 插件中遵循 cppcheck 的 jelly 脚本模板有什么问题。

```
<!-- CppCheck TEMPLATE -->
<!--<j:set var="cppClassName" value="CppcheckBuildAction" />-->
<j:set var="cppcheckAction" value="${it.getAction('com.thalesgroup.hudson.plugins.cppcheck.CppcheckBuildAction')}" />
<TABLE width="100%">
    <TR><TD class="bg1" colspan="2"><B>CppCheck Result</B></TD></TR>
         <TR bgcolor="white"><TD class="test_failed" colspan="2"><B><li>Failed: ${cppcheckResult.summary} </li></B></TD></TR>
</TABLE>
<j:if test="${cppcheckAction!=null}">
  <j:set var="cppcheckResult" value="${cppcheckAction.result}" />
  <j:if test="${cppcheckResult!=null}">
  <TABLE width="100%">
    <TR><TD class="bg1" colspan="2"><B>CppCheck Result</B></TD></TR>
         <TR bgcolor="white"><TD class="test_failed" colspan="2"><B><li>Failed: ${cppcheckResult.getSummary} </li></B></TD></TR>
  </TABLE>
  </j:if>
<BR/>
</j:if> 
```

# asp.net - 使用 Redth PushSharp 发送 iOS 推送通知失败

> ID：13357672
> 
> 赞同：0
> 
> 时间：2012-11-13T08:40:08.183
> 
> 标签：asp.net, ios, apple-push-notifications

您好，我正在使用[Redth PushSharp](https://github.com/Redth/PushSharp)库开发推送通知服务。我已经成功地能够从本地电脑向我的 ipad 发送通知。但是当我将它上传到我的托管服务时，它会发生异常！查看我的代码：

```
 Boolean bsandbox = true;
        string p12fileName =AppDomain.CurrentDomain.BaseDirectory + "CPDDevelopmentPushNotificationCertificate.p12";
        string p12password = "1234";

        string deviceID1 = "2909b25e0c699b2dc4864b4b9f719e67aac7e0fab791a72a086ffb788ba28f6a"; //
        string msg = "This is the message sent at : ";
        string alert = "Hello world at " + DateTime.Now.ToLongTimeString();
        int badge = 1;
        string soundstring = "default";
        var payload1 = new NotificationPayload(deviceID1, alert, badge, soundstring);
        payload1.AddCustom("custom1", msg); 

        var notificationList = new List<NotificationPayload> { payload1 };

        var push = new PushNotification(bsandbox, p12fileName, p12password);

        var rejected = push.SendToApple(notificationList);` 
```

我从[MoonApns PushNotification.cs](https://github.com/arashnorouzi/Moon-APNS/blob/master/Application/MoonApns/PushNotification.cs)获得了 PushNotification 类。

当我发送通知时，它会出现以下错误：

*对 SSPI 的调用失败。System.ComponentModel.Win32Exception (0x80004005)：收到的消息意外或格式错误。*

System.Net.Security.SslState.CheckThrow(Boolean authSucessCheck) 在 System.Net.Security.SslState.get_SecureStream()

*在 System.Net.Security.SslStream.BeginRead（字节 [] 缓冲区，Int32 偏移量，Int32 计数，AsyncCallback asyncCallback，对象 asyncState）*

*在 PushNotification.cs:line 121 中的 PushNotification.SendQueueToapple(IEnumerable1 queue)*

*在 PushNotification.cs:line 92 中的 PushNotification.SendToApple(List1 queue)*

*在 PushNotificationIOS.cs:line 48 中的 PushNotificationIOS.SendPushNotification()*

这是推送服务网址：[测试我的推送服务错误](http://www.createplaydate.com.asp1-21.ord1-1.websitetestlink.com/api/PushNotificationIOS/SendPushNotification)

我正在使用[RackSpace 云托管](http://www.rackspace.com/)

任何人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T17:38:37.367

重要提示：确保使用正确的推送证书。

```
//Make sure you upload the certificate with your project Develop or Production
//Make sure your path to certificate is correct
//I use a appsetting key/value  in web.config to save the name of push certificate 

var appleCert = File.ReadAllBytes(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, System.Configuration.ConfigurationManager.AppSettings["appleCert"]));

push.StartApplePushService(new ApplePushChannelSettings(false,appleCert, strYourPasswordCert));

push.QueueNotification(NotificationFactory.Apple()
                    .ForDeviceToken(IosIpadDeviceTocken)
                    .WithAlert(strTitle)
                    .WithSound("default")
                    .WithBadge(1)

                    );

push.StopAllServices(true);

//This code work for me. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T19:31:15.337

检查这个：

```
string deviceID1 = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX";
    string msg = "This is the message sent at : ";
    string alert = "Hello world at " + DateTime.Now.ToLongTimeString();
    int badge = 1;
    string soundstring = "default";
    var payload1 = new NotificationPayload(deviceID1, alert, badge, soundstring);
    payload1.AddCustom("custom1", msg); 

    var notificationList = new List<NotificationPayload> { payload1 };

    var push = new PushNotification(bsandbox, p12fileName, p12password);

    var rejected = push.SendToApple(notificationList);` 
```

让沙盒成为现实！

**也检查证书**

# spring - 如何处理弹簧控制器中的“ñ”？

> ID：13357674
> 
> 赞同：1
> 
> 时间：2012-11-13T08:40:20.480
> 
> 标签：spring, character-encoding, special-characters

嗨，我有一个很大的问题。在我的 jsp 页面中，我使用 javascript 函数对参数进行编码`encodeURIComponent`。我真的`ñ`性格有问题。在我的 jsp 中，编码值为`%C3%B1`. 在我的控制器中，它的`Ã±`. jsp和controller之间的转换不知道是谁做的。在我的控制器中，我期待编码值为`%C3%B1`.

# java - 无法连接到 postgres SQL

> ID：13357676
> 
> 赞同：3
> 
> 时间：2012-11-13T08:40:24.890
> 
> 标签：java, spring, hibernate, postgresql, maven

我正在使用`Spring + Maven + Hibernate`并想在`PostgreSQL`环境中运行测试。

添加正确的依赖项并更改我的 xml 文件后，`mvn clean install`在 cmd 中运行时出现以下错误：

```
Coult not open JPA EntityManager for transaction; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection 
```

测试的输出日志类似于：

```
 Tests run: 9, Failures: 0, Errors: 9, Skipped: 0, Time elapsed: 23.695 sec <<< FAILURE!
testFlush(com.mms.pone.portal.domain.AccountAllocationIntegrationTest)  Time elapsed: 15.432 sec  <<< ERROR!
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:427)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener$TransactionContext.startTransaction(TransactionalTestExecutionListener.java:513)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.startNewTransaction(TransactionalTestExecutionListener.java:271)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.beforeTestMethod(TransactionalTestExecutionListener.java:164)
    at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:358)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:73)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:172)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:104)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:70)
Caused by: javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1387)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)
    at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:1397)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:63)
    at org.springframework.orm.jpa.DefaultJpaDialect.beginTransaction(DefaultJpaDialect.java:70)
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:377)
    ... 31 more
Caused by: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)
    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    at org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)
    at org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)
    at org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:60)
    ... 33 more
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.)
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1549)
    at org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:71)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    ... 38 more
Caused by: org.postgresql.util.PSQLException: Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:136)
    at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:66)
    at org.postgresql.jdbc2.AbstractJdbc2Connection.<init>(AbstractJdbc2Connection.java:125)
    at org.postgresql.jdbc3.AbstractJdbc3Connection.<init>(AbstractJdbc3Connection.java:30)
    at org.postgresql.jdbc3g.AbstractJdbc3gConnection.<init>(AbstractJdbc3gConnection.java:22)
    at org.postgresql.jdbc4.AbstractJdbc4Connection.<init>(AbstractJdbc4Connection.java:30)
    at org.postgresql.jdbc4.Jdbc4Connection.<init>(Jdbc4Connection.java:24)
    at org.postgresql.Driver.makeConnection(Driver.java:393)
    at org.postgresql.Driver.connect(Driver.java:267)
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38)
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582)
    at org.apache.commons.dbcp.BasicDataSource.validateConnectionFactory(BasicDataSource.java:1556)
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1545)
    ... 42 more
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:69)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
    at java.net.Socket.connect(Socket.java:579)
    at java.net.Socket.connect(Socket.java:528)
    at java.net.Socket.<init>(Socket.java:425)
    at java.net.Socket.<init>(Socket.java:208)
    at org.postgresql.core.PGStream.<init>(PGStream.java:62)
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:76)
    ... 54 more
testMarkerMethod(com.mms.pone.portal.domain.AccountAllocationIntegrationTest)  Time elapsed: 1.003 sec  <<< ERROR!
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:427)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener$TransactionContext.startTransaction(TransactionalTestExecutionListener.java:513)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.startNewTransaction(TransactionalTestExecutionListener.java:271)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.beforeTestMethod(TransactionalTestExecutionListener.java:164)
    at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:358)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:73)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:172)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:104)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:70)
Caused by: javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1387)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)
    at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:1397)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:63)
    at org.springframework.orm.jpa.DefaultJpaDialect.beginTransaction(DefaultJpaDialect.java:70)
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:377)
    ... 31 more
Caused by: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)
    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    at org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)
    at org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)
    at org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:60)
    ... 33 more
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.)
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1549)
    at org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:71)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    ... 38 more
Caused by: org.postgresql.util.PSQLException: Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:136)
    at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:66)
    at org.postgresql.jdbc2.AbstractJdbc2Connection.<init>(AbstractJdbc2Connection.java:125)
    at org.postgresql.jdbc3.AbstractJdbc3Connection.<init>(AbstractJdbc3Connection.java:30)
    at org.postgresql.jdbc3g.AbstractJdbc3gConnection.<init>(AbstractJdbc3gConnection.java:22)
    at org.postgresql.jdbc4.AbstractJdbc4Connection.<init>(AbstractJdbc4Connection.java:30)
    at org.postgresql.jdbc4.Jdbc4Connection.<init>(Jdbc4Connection.java:24)
    at org.postgresql.Driver.makeConnection(Driver.java:393)
    at org.postgresql.Driver.connect(Driver.java:267)
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38)
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582)
    at org.apache.commons.dbcp.BasicDataSource.validateConnectionFactory(BasicDataSource.java:1556)
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1545)
    ... 42 more
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:69)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
    at java.net.Socket.connect(Socket.java:579)
    at java.net.Socket.connect(Socket.java:528)
    at java.net.Socket.<init>(Socket.java:425)
    at java.net.Socket.<init>(Socket.java:208)
    at org.postgresql.core.PGStream.<init>(PGStream.java:62)
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:76)
    ... 54 more
testFindAccountAllocation(com.mms.pone.portal.domain.AccountAllocationIntegrationTest)  Time elapsed: 1.008 sec  <<< ERROR!
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:427)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener$TransactionContext.startTransaction(TransactionalTestExecutionListener.java:513)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.startNewTransaction(TransactionalTestExecutionListener.java:271)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.beforeTestMethod(TransactionalTestExecutionListener.java:164)
    at org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:358)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:73)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:172)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:104)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:70)
Caused by: javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1387)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)
    at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:1397)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:63)
    at org.springframework.orm.jpa.DefaultJpaDialect.beginTransaction(DefaultJpaDialect.java:70)
    at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:377)
    ... 31 more
Caused by: org.hibernate.exception.GenericJDBCException: Cannot open connection
    at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)
    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    at org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)
    at org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)
    at org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)
    at org.hibernate.ejb.TransactionImpl.begin(TransactionImpl.java:60)
    ... 33 more
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.)
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1549)
    at org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:71)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    ... 38 more 
```

显然我的登录凭据有问题，但我不确定到底是什么。

我的`database.properties`文件：

```
########################################################
#                                                      #
#  This configuration is used for unit-testing only.   #
#                                                      #
########################################################

database.driverClassName=org.postgresql.Driver
database.url=jdbc:postgresql://localhost/test
database.username=postgres
database.password= 
```

持久性.xml`文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="2.0" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="persistenceUnit" transaction-type="RESOURCE_LOCAL">

    <provider>org.hibernate.ejb.HibernatePersistence</provider> 
```

`ApplicationContext.xml`文件

```
 <context:property-placeholder location="classpath*:META-INF/spring/test-database.properties"/>

<bean id="externalProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
   <property name="ignoreResourceNotFound"><value>true</value></property>
   <property name="locations">
      <list>
        <value>classpath*:META-INF/conf/configuration.properties</value>
      </list>
   </property>
</bean>

    <!-- OMITTED FOR THE SAKE OF CLARITY AND SPACE -->

     <bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" id="dataSource">
    <property name="driverClassName" value="${database.driverClassName}"/>
    <property name="url" value="${database.url}"/>
    <property name="username" value="${database.username}"/>
    <property name="password" value="${database.password}"/>
    <property name="testOnBorrow" value="true"/>
    <property name="testOnReturn" value="true"/>
    <property name="testWhileIdle" value="false"/>
    <property name="timeBetweenEvictionRunsMillis" value="1800000"/>
    <property name="numTestsPerEvictionRun" value="1"/>
    <property name="maxActive" value="1" />
    <property name="minEvictableIdleTimeMillis" value="1800000"/>
</bean>

<bean class="org.springframework.orm.jpa.JpaTransactionManager" id="transactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>
    <tx:annotation-driven mode="aspectj" transaction-manager="transactionManager"/>

    <bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory">
        <property name="persistenceUnitName" value="persistenceUnit"/>
        <property name="dataSource" ref="dataSource"/>

            <property name="persistenceXmlLocation" value="classpath*:META-INF/test-persistence.xml" />
    </bean> 
```

我刚开始使用 Spring Tool Suite (Spring + Maven + Hibernate)，因此非常欢迎任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T08:45:53.670

由于您收到连接被拒绝错误，您应该检查 postgres 是否在 localhost 上运行/侦听。`netstat -a`您可以使用命令检查 postgres 是否正在侦听 5432 端口。

# ios - 仪器，iPhone应用程序分配增加

> ID：13357677
> 
> 赞同：0
> 
> 时间：2012-11-13T08:40:27.193
> 
> 标签：ios, cocoa-touch, memory-management, instruments, xcode-instruments

我正在使用 UIPageViewController 加载多个视图控制器。当我在 Instruments 工具中运行我的应用程序时。我发现分配正在向高利润转移。虽然我正在释放并使类对象为零。当我来回移动时，分配继续增加。我错过了什么？

请找到截图![在此处输入图像描述](../Images/504cf8ef0b6f070e2cadd95ff50e289a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:12:41.707

关闭僵尸。默认情况下，僵尸永远不会被删除，因此在 Instruments 中，您所看到的只是增加了内存使用量。请注意，这些条都是纯蓝色的，没有任何内容被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:51:13.760

您正在查看“总体分配”图。这个数字告诉你自进程开始以来已经创建了多少对象——数量永远不会减少。

如果您想知道在给定时间有多少对象，您必须查看“# Living”列。

# objective-c - Objective-C sqlite 在 LIKE 子句中添加查询参数

> ID：13357689
> 
> 赞同：5
> 
> 时间：2012-11-13T08:41:42.130
> 
> 标签：objective-c, c, sqlite, sql-like

我`sqlite`通过 C API 在 Objective-C 中使用。我的应用程序的预期功能之一是用户可以搜索一个人名，并且对于他们输入的每个新字符，`LIKE`执行一个 SQL 查询来查找所有姓名符合匹配条件的人。我遇到的问题是参数化 LIKE 内的匹配，而不是按字面解释问号。也就是说，我相信该应用程序目前正在寻找包含`?`在其中的人的姓名（即没有人）。

我的代码如下所示：

```
const char *sql = "SELECT rowid, name, email FROM person WHERE name LIKE '%?%'";
sqlite3_stmt *sqlStatement;
if(sqlite3_prepare_v2(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK) {
    NSLog(@"Problem preparing getFilteredPeopleStubs statement.");
}
if(sqlite3_bind_text(sqlStatement, 1, [searchText UTF8String], -1, SQLITE_TRANSIENT) != SQLITE_OK){
    NSLog(@"Problem binding search text param.");
} 
```

基本上，`searchText`是我*希望*名字来自的地方，但目前我相信它只是在搜索名字包含的人`?`，因为`'%?%'`. 是否有解决这个问题的方法仍然让我使用参数化查询（防止 SQL 注入）并实现我所追求的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T09:00:20.137

将`%`字符放入`searchText`中，例如（请原谅双关语）：

```
const char *sql = "SELECT rowid, name, email FROM person WHERE name LIKE ?";
sqlite3_stmt *sqlStatement;
if(sqlite3_prepare_v2(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK) {
    NSLog(@"Problem preparing getFilteredPeopleStubs statement.");
}
NSString *bindParam = [NSString stringWithFormat:@"%%%@%%", searchText];
if(sqlite3_bind_text(sqlStatement, 1, [bindParam UTF8String], -1, SQLITE_TRANSIENT) != SQLITE_OK){
    NSLog(@"Problem binding search text param.");
} 
```

# python-2.7 - 当我在我的 Mac 上安装 lxml 时，安装过程中显示“未找到 gcc-4.2，使用 clang”

> ID：13357690
> 
> 赞同：0
> 
> 时间：2012-11-13T08:41:42.457
> 
> 标签：python-2.7, lxml, llvm-gcc

当我在我的 mac 上安装 lxml 时，安装过程中显示“未找到 gcc-4.2，使用 clang”。

我只需输入以下命令，然后得到上面的答案，我怎样才能用 llvm-gcc-4.2 指定 gcc-4.2？

```
python setup.py build 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T00:54:02.220

您可以创建软链接，但 clang 是 OS X 上的默认系统编译器，因此您可能应该使用它，除非您有充分的理由不这样做。

# ajax - AJAX 调用不显示数据

> ID：13357695
> 
> 赞同：0
> 
> 时间：2012-11-13T08:42:00.640
> 
> 标签：ajax, asp.net-mvc-3

我得到了在 MVC3 应用程序中调用局部视图的代码：

```
$("#TypeID").change(function ()  {

    var taskID = $('#TypeID').val();

    $.ajax({
        url: '/controller/_causeList',
        type: 'GET',
        dataType: 'html',
        data: "Id=" + taskID,
        success: function (data) {
            $('#CauseID').html(data)

        }
    });

}); 
```

我想在这里发生的是，当我更改一个下拉列表时，另一个列表将重新加载到表单的其他位置。但是重新加载的下拉列表是空的。检查 firebug 中的脚本显示响应包含 selectList 的正确 HTML，它的外观和工作方式与我预期的完全一样。但我无法将返回的数据重新插入页面。我在做一些明显不正确的事情吗，我对 AJAX 很陌生。

# django - 如何解决 Embers Handlebar 和 Django 模板之间的冲突

> ID：13357697
> 
> 赞同：1
> 
> 时间：2012-11-13T08:42:22.680
> 
> 标签：django, django-templates, ember.js, handlebars.js

我正在使用 Ember 和 Django，很快发现 Handlebar 中的模板分隔符与 Django 模板的分隔符冲突。

所以我安装了 Django-embers [http://pypi.python.org/pypi/django-ember/0.1](http://pypi.python.org/pypi/django-ember/0.1)

但它似乎无法正常工作。这就是问题：

如果我在 APP.js 中有这样的东西

```
var Ab = Em.Application.create({
  appDescription : 'HelloWorldApp'
}); 
```

我可以像这样在模板中轻松渲染它

```
{% load ember %}
{% handlebars "" %}
    {{Ab.appDescription}}
{% endhandlebars %} 
```

这行得通。但是当我尝试使用模板标签时，例如 {{#each}} 事情失败了。例如我在 APP.js 中有这个

```
Songs.songsController = Ember.ArrayController.create({
    content: [],
    init: function(){
        // create an instance of the Song model
        var song = Songs.Song.create({
            title: 'Son of the Morning',
            artist: 'Oh, Sleeper',
            genre: 'Screamo'
        });
        this.pushObject(song);
    }
}); 
```

并尝试使用以下方式渲染它：

```
{% load ember %}
{% handlebars "" %}
{{#each Songs.songsController}}
        <h3>{{title}}</h3>
        <p>{{artist}} - {{genre}}</p>
{{/each}}
{% endhandlebars %} 
```

什么都没有输出！

它与我的代码无关，因为我将模板和 JS 文件移到了 django 外部并测试了代码，然后它按预期工作。

一定要告诉这里出了什么问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:01:45.283

该`init`函数是所有 Ember 对象的构造函数。基本上，为了在创建对象时放置所有绑定/观察者的东西，在覆盖构造函数时必须调用类层次结构的构造函数。事实上，这就像你在其他编程语言中所做的一样。

# jquery - 使用 jQuery 检索字符串中的元素

> ID：13357701
> 
> 赞同：0
> 
> 时间：2012-11-13T08:42:50.783
> 
> 标签：jquery, dom, element

我有一个这样的字符串：

```
<fieldset>
<legend>Sondage</legend>
<input type="hidden" value="formulaire_test/poll1352736068616/testencode" name="pollpost">
<p class="question">Q1</p>
<p class="response">
<input id="R010101" type="radio" value="A" name="R0101">
<label for="R010101">R11</label>
</p>
<p class="response">
<input id="R010102" type="radio" value="B" name="R0101">
<label for="R010102">r12</label>
</p>
<p class="question">Q2</p>
<p class="response">
<input id="R010201" type="radio" value="A" name="R0102">
<label for="R010201">r2</label>
</p>
<p class="response">
<input id="R010202" type="radio" value="B" name="R0102">
<label for="R010202">r22</label>
</p>
<p class="submit">
<input type="submit" value="Votez">
</p>
</fieldset> 
```

我想用 jQuery 检索例如值`<legend>`、值`<p class=question>`或所有输入值..

你有什么主意吗 ？

我可以把这个字符串放到一个 jQuery 对象`$(mystring)`中，然后呢？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:46:07.767

您可以使用以下代码将输入值推送到数组中：

```
var arr = new Array();
$(mystring).find('input').each(function() {
    arr.push($(this).val());
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:46:46.437

您可以使用

```
$(mystring).find('legend').text(); 
```

或者

```
$(mystring).find('input').val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:45:30.113

做就是了

```
$('legend').html(); // Text inside Legend

var questions = new Array();
$('p.question').each(function(){
     questions.push( $(this).html() ) ; // Questions class text into array
});

var inputs = new Array();
$('input').each(function(){
     inputs.push(this.value) ; // Input values into array
}); 
```

如果你想在里面找到这些，`$(mystring)`只需在选择器前面加上

```
$('mystring').find( selector ) 
```

# asp.net-mvc-3 - Mvc 4 单元测试概念

> ID：13357711
> 
> 赞同：3
> 
> 时间：2012-11-13T08:43:39.660
> 
> 标签：asp.net-mvc-3, unit-testing, asp.net-mvc-4, theory

我试图理解 MVC 4 应用程序中 TDD 的概念。我在网上找到的所有示例都没有向我解释在 MVC 4 应用程序的情况下应该测试什么单元测试的概念。

因此，当您编写单元测试时，您尝试在控制器中测试的要点是什么？

如果可能，请解释这个例子。

```
public class UsersIDentController : AuthorizedController
{    
    private readonly IUserDetailsService userDetailsService;

    public UsersIDentController(IUserDetailsService userDetailsService,
            IServiceLocator serviceLocator): base(serviceLocator)
    {
    }    

    //
    // GET: /UsersIdentification/
    [AllowAnonymous]
    public ActionResult ShowDetails()
    {
        UsersIdentificationViewModel model = new UsersIdentificationViewModel();
        return View(model);
    }
} 
```

如果您要为此控制器编写单元测试（获取用户数据），您将在单元测试中测试什么。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T10:30:26.753

对于您当前的示例，我无法详细说明单元测试。因为你所得到的只有一个方法`ShowDetails`，它返回一个`View`与 绑定的`UsersIdentificationViewModel`. 由于您只返回`View`，因此您可以将返回类型更改为`ViewResult`. 然后，您所能测试的就是与 绑定的模型`View`是否为 type `UsersIdentificationViewModel`。

如果我们举一个简单的例子，我可以更好地解释 MVC 中的单元测试。如果您创建一个新的 MVC 应用程序，`internet template`您会看到一个`AccountController`被定义为默认值，它包含*登录*、*注册*、*更改密码*等操作。

让我们采取`LogOn`行动`AccountController`。

**AccountController.cs**

```
public class AccountController : Controller
{
    private readonly IAuthProvider _authProvider;

    public AccountController(IAuthProvider authProvider)
    {
        _authProvider = authProvider;
    }

    [HttpPost]
    public ActionResult LogOn(LogOnModel model, string returnUrl)
    {
        if (ModelState.IsValid)
        {
            if (_authProvider.ValidateUser(model.UserName, model.Password))
            {
                _authProvider.SetCookie(model.UserName, model.RememberMe);

                if (!String.IsNullOrEmpty(returnUrl))
                {
                    return Redirect(returnUrl);
                }
                else
                {
                    return RedirectToAction("Index", "Home");
                }
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }

        return View(model);
    }

    ...
} 
```

为了避免与`FormsAuthentication`密封类的依赖关系，`AccountController`我使用了一个接口`IAuthProvider`来简化单元测试。

**IAuthProvider.cs**

```
public interface IAuthProvider
{
    bool ValidateUser(string username, string password);

    void SetCookie(string username, bool rememberMe);

    bool CreateUser(string username, string password, string email, out string error);

    bool ChangePassword(string username, string oldPassword, string newPassword);

    void SignOut();
} 
```

**登录模型.cs**

```
public class LogOnModel
{
    [Required]
    [Display(Name = "User name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [Display(Name = "Remember me?")]
    public bool RememberMe { get; set; }
} 
```

您可以在操作中注意到许多**if..else**条件，`LogOn`它们是单元测试的良好候选者。

我会为这个动作写至少四个单元测试。

1.  验证输入有效凭据时，操作应重定向到传递的 url。
2.  验证是否传递有效凭据，而不`returnUrl`应将`AccountController`用户重定向到`Home`操作。
3.  验证传递无效凭据时，帐户控制器应返回带有错误的视图。
4.  验证当存在验证错误时，控制器应返回带有错误的视图。

这是我使用`MSTest`and编写的单元测试`RhinoMocks`。

**AccountControllerTests.cs**

```
[TestClass]
public class AccountControllerTests
{
   private AccountController _accountController;
   private IAuthProvider _mockAuthProvider;

   [TestInitialize]
   public void SetUp()
   { 
       //** Arrange
       _mockAuthProvider = MockRepository.GenerateStub<IAuthProvider>();
       _accountController = new AccountController(_mockAuthProvider);
   }

   [TestCleanup]
   public void CleanUp()
   {      
   }

   /// <summary>
   /// This test is to verify on entering valid credentials the action should redirect   to the passed url.
   /// </summary>
   [TestMethod]
   public void LogOn_Action_Valid_Credentials_With_ReturnUrl_Test()
   {
       //** Arrange
       var logonModel = new LogOnModel
       {
          UserName = "trigent",
          Password = "password",
          RememberMe = true
       };

       // stub the ValidateUser to return "true" to pretend the user is valid.
       _mockAuthProvider.Stub(x => x.ValidateUser(logonModel.UserName, logonModel.Password)).Return(true);

       //** Act
       var actual = _accountController.LogOn(logonModel, "/");

       //** Assert

       // verify RedirectResult is returned from action
       Assert.IsInstanceOfType(actual, typeof(RedirectResult));

       // verify the redirect url is same as the passed one.
       Assert.AreEqual(((RedirectResult)actual).Url, "/");
   }

   /// <summary>
   /// This test is to verify on passing valid credentials without returnUrl the account controller
   /// should redirect the user to the "Home" action.
   /// </summary>
   [TestMethod]
   public void LogOn_Action_Valid_Credentials_Without_ReturnUrl_Test()
   {
       //** Arrange
       var logonModel = new LogOnModel
       {
           UserName = "trigent",
           Password = "password",
           RememberMe = true
       };

       // stub the ValidateUser to return "true" to pretend the user is valid.
       _mockAuthProvider.Stub(x => x.ValidateUser(logonModel.UserName, logonModel.Password)).Return(true);

       //** Act
       var actual = _accountController.LogOn(logonModel, string.Empty);

       //** Assert

       // verify RedirectToRouteResult is returned from action
       Assert.IsInstanceOfType(actual, typeof(RedirectToRouteResult));

       // verify the controller redirecting to "Home" action.
       var routeValues = ((RedirectToRouteResult)actual).RouteValues;
       Assert.AreEqual("Home", routeValues["controller"].ToString());
       Assert.AreEqual("Index", routeValues["action"].ToString());
   }

   /// <summary>
   /// This test is to verify on passing invalid credentials the account controller should return the login view 
   /// with error messages.
   /// </summary>
   [TestMethod]
   public void LogOn_Action_Invalid_Credentials_Test()
   {
       //** Arrange
       var logonModel = new LogOnModel
       {
          UserName = "trigent",
          Password = "password",
          RememberMe = true
       };

       // stub the ValidateUser to return "false" to pretend the user is invalid.
       _mockAuthProvider.Stub(x => x.ValidateUser(logonModel.UserName, logonModel.Password)).Return(false);

       //** Act
       var actual = _accountController.LogOn(logonModel, string.Empty);

       //** Assert

       // verify ViewResult is returned from action
       Assert.IsInstanceOfType(actual, typeof(ViewResult));

       // verify the controller throws error.
       var modelStateErrors = _accountController.ModelState[""].Errors;
       Assert.IsTrue(modelStateErrors.Count > 0);
       Assert.AreEqual("The user name or password provided is incorrect.", modelStateErrors[0].ErrorMessage);
   }

   /// <summary>
   /// This test is to verify when there is a validation error the controller should return the same login view.
   /// </summary>
   [TestMethod]
   public void LogOn_Action_Invalid_Input_Test()
   {
       //** Arrange
       _accountController.ModelState.AddModelError("UserName", "UserName is Required.");

       //** Act
       var actual = _accountController.LogOn(new LogOnModel(), string.Empty);

       //** Assert

       // verify ViewResult is returned from action
       Assert.IsInstanceOfType(actual, typeof(ViewResult));
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:33:21.413

如果您测试 ShowDetails 方法，您可以验证它是否返回具有正确类型模型的视图。

为此，您可以使用[MVC Contrib](http://mvccontrib.codeplex.com/)，它具有您可以使用的单元测试断言。你可以在这里找到所有的单元测试文档：http: [//mvccontrib.codeplex.com/wikipage ?title=TestHelper&referringTitle=Documentation](http://mvccontrib.codeplex.com/wikipage?title=TestHelper&referringTitle=Documentation)

# r - 在表的不同列中绘制某一行的值

> ID：13357713
> 
> 赞同：1
> 
> 时间：2012-11-13T08:43:46.030
> 
> 标签：r

我有一张巨大的桌子，我想绘制一张图，让我们说这张桌子上有两个不同的行。

下面你可以看到我的数据集的一个小概述。

我现在想为国家 4 绘制 1,2 和 3 年的生产，以便有人可以看到随着时间的变化

与国家 6 相同

X 轴上应该是年份，Y 轴上应该是值。

有人可以帮助我吗？

提前致谢！

```
 country    year1        unit        year2        unit    year3
    1          5.1         tonnes       1.4         tonnes   5
    2          4.9         tonnes       1.4         tonnes   2
    3          4.7         tonnes       1.3         tonnes   3.5
    4          4.6         tonnes       1.5         tonnes   8
    5          5.0         tonnes       1.4         tonnes   8
    6          5.4         tonnes       1.7         tonnes   6 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T10:05:38.410

这些是创建情节的步骤。

数据：

```
dat <- read.table(text="country    year1      unit      year2      unit    year3
   1          5.1         tonnes       1.4         tonnes   5
   2          4.9         tonnes       1.4         tonnes   2
   3          4.7         tonnes       1.3         tonnes   3.5
   4          4.6         tonnes       1.5         tonnes   8
   5          5.0         tonnes       1.4         tonnes   8
   6          5.4         tonnes       1.7         tonnes   6", header = TRUE) 
```

1.  选择数据的子集：

    ```
    subdat <- dat[dat$country == 4, c("year1", "year2", "year3")] 
    ```

2.  以长格式排列数据：

    ```
    subdat_l <- data.frame(Value = unlist(subdat), Year = factor(1:3)) 
    ```

3.  阴谋：

    ```
    plot(Value ~ Year, subdat_l) 
    ```

![在此处输入图像描述](../Images/0e103008ad64afc73b7d6ea56f7e9f1c.png)

* * *

如果实际数据框包含超过三年的数据，则可以使用这种通用方法：

```
years <- grep("^year", names(dat), value = TRUE) # find the columns with the data
subdat <- dat[dat$country == 4, years]
subdat_l <- data.frame(Value = unlist(subdat),
                       Year = substr(years, 5, nchar(years))) 
```

# jquery - jQuery 工作删除 id 但不是元素

> ID：13357715
> 
> 赞同：0
> 
> 时间：2012-11-13T08:44:04.627
> 
> 标签：jquery, css, attr

我有一堆跨度，我可以单击每个跨度，例如，这个元素将带有 id="active"。但是如何从前一个元素中删除 id="active" 呢？

```
$('#active').attr("id",'');  
$(this).attr("id","active"); 
```

我用这个，这个有效吗？在此代码之后，曾经是活动元素但现在不活动的元素具有 id 但看起来像

```
<span class="bunch_of_spans" id> // not active anymore (but can be active if i pick it)
<span class="bunch_of_spans" id="active"> // active now
<span class="bunch_of_spans"> // never was active 
```

这是否有效并且可能有从不活动的元素中删除 id 的方法？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:45:48.157

使用[removeAttr](http://api.jquery.com/removeAttr/)

```
$('#active').removeAttr("id"); 
```

工作示例：http:
[//jsfiddle.net/nWtYc/](http://jsfiddle.net/nWtYc/)

虽然这会起作用，但我建议您使用其他一些非唯一标识符来识别活动元素。课程对此很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T08:46:15.743

要回答您的具体问题，请使用：

```
$('#active').removeAttr("id"); 
```

但从语义上讲，id 永远不会改变，所以我建议您改用类，例如：

```
<span class="bunch_of_spans active"> 
```

然后像这样添加/删除类：

```
$('#active').addClass("active");
$('#active').removeClass("active"); 
```

# c - c: fscanf 故障，包括换行符

> ID：13357717
> 
> 赞同：0
> 
> 时间：2012-11-13T08:44:18.677
> 
> 标签：c

我正在从文件中读取此文本：

```
file1: file2,file3,file4
file10: testfile.h
file1: file9 
```

并将其拆分

```
while(fscanf(fp,"%[^:]: %s",map[i].name, map[i].filesNeeded) == 2)
{
    printf("%s %s",map[i].name, map[i].filesNeeded);
    i++;
} 
```

问题是第二个和第三个变量是用前导换行符保存的：

```
Details:{name = "\\nfile10", '\\000' <repeats 56 times>, filesNeeded = "testfile.h", '\\000' <repeat 
```

如何在没有前导换行符的情况下保存它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:46:26.930

为`" %[^:]: %s "`

```
while(fscanf(fp," %[^:]: %s ",map[i].name, map[i].filesNeeded) == 2) 
```

scanf中的空格吸收空格字符、制表符、换行符

# ios - ASIHTTPRequestErrorDomain 代码=3 需要验证

> ID：13357719
> 
> 赞同：2
> 
> 时间：2012-11-13T08:44:20.693
> 
> 标签：ios, asihttprequest

我正在使用 ASIHTTPRequest ，而我可以使用 safari 或 firefox 来获得响应，asihttprequest 返回 ASIHTTPRequestErrorDomain Code=3 需要身份验证，有人帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-19T07:25:19.470

您的请求应包含您尝试访问的服务器的用户名和密码。

在您的请求中添加以下代码：

```
[request setUsername:@"test"];
[request setPassword:@"test123"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:49:05.777

它可能是您请求的 API 或网站的用户代理。用户代理将与 safari 不同。

您可以像这样更改用户代理：

```
[request addRequestHeader:@"User-Agent" value:@"ASIHTTPRequest"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-28T07:01:37.263

我也有同样的问题，因为我在 setPostValue:forKey 中输入了错误的参数名称：

# osgi - OSGI 中的多个服务注册表

> ID：13357720
> 
> 赞同：-1
> 
> 时间：2012-11-13T08:44:22.473
> 
> 标签：osgi, blueprint-osgi

我可以在 OSGI 容器中使用多个服务注册表吗？我想以类似交易的方式在它们之间切换

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:09:09.150

您是指 OSGi 服务注册表——调节依赖关系和模块之间交互的框架的核心——还是指外部的，可能是远程的服务注册表（SOAP、.NET Web 服务等）？

如果您指的是 OSGi 服务注册表——不，这是不可能的。OSGi 服务注册是框架核心功能的一部分。它负责模块（包）之间的数据共享，这是通过 OSGi 服务（实现不同接口的对象）完成的。它与包依赖处理、OSGI 安全性和其他核心功能紧密集成，并且可以通过每个包的系统对象 BundleContext 访问。没有可能覆盖或扩展它，即使有，它也会由于许多原因在框架中造成严重破坏 - 例如，有像 ConfigurationAdmin 这样的单例服务不应该被复制。

但是，如果您指的是 Web 服务（或 OSGi 核心之外的其他类型的服务）的注册表，那么是的，这是可能的。事实上，这些类型的注册表可能也会在 OSGi 中注册为服务，您可以在它们之间进行选择或在它们之间切换。

# cakephp - 相当于 CakePHP $this->params 来检索 Yii 上的所有 POST/GET？

> ID：13357723
> 
> 赞同：1
> 
> 时间：2012-11-13T08:44:27.490
> 
> 标签：cakephp, yii, params

在 CakePHP 上，我们可以使用 ALL POST/GET

```
$this->params 
```

在 Yii 上，我不确定它是否有等价物。只看到我是否想获得一个字段值，无论是否（POST/GET），但我需要指定它。

```
Yii::app()->request->getParam('email') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T09:34:08.170

在 Yii 中，直接使用`$_REQUEST`, , 完全没问题。`$_POST``$_GET`

真正的作用是`getParam`直接使用这些数组，但不同的是，如果*参数*不存在，则`null`默认返回，或者您指定为`getParam`调用的第二个参数的值：

[来源](https://github.com/yiisoft/yii/blob/1.1.12/framework/web/CHttpRequest.php#L158)：

```
public function getParam($name,$defaultValue=null)
{
    return isset($_GET[$name]) ? $_GET[$name] : (isset($_POST[$name]) ? $_POST[$name] : $defaultValue);
} 
```

# weblogic - JaxWS WSDL 自定义

> ID：13357725
> 
> 赞同：0
> 
> 时间：2012-11-13T08:44:41.280
> 
> 标签：weblogic, jax-ws

我正在使用**start-from-java**方法开发 webservice ，它将发布到 WebLogic 10.3.6。我正在使用注释来定义 WS Beans 、方法和类型。我正在使用**JWSC** ant 任务来生成可部署服务和**clientgen** ant 任务来生成客户端工件。

输出（如预期）很好，但我对生成的 WSDL 文件有一定的限制，我找不到解决方案。我尝试过使用**绑定 xml 文件**，但更改仅适用于生成的客户端工件。限制是：

1.  模式导入必须定义一个 targetNamespace="" 元素

尽管指定了 targetNamespace 元素是 xsd 模式文件

1.  留言部分

必须具有`*Request` 注释参数的命名约定，`@WebParam(name="someRequest")`并没有更改 wsdl 中的消息部分，而是在 xsd 模式文件中。

# ruby-on-rails - 实现音乐愿望清单，如哈希哈希

> ID：13357728
> 
> 赞同：1
> 
> 时间：2012-11-13T08:44:46.263
> 
> 标签：ruby-on-rails, arrays, cookies, hash-of-hashes

我正在尝试使用 iTunes rails gem，例如：

```
>> itunes = ITunes::Client.new
>> songs = itunes.music('green day she')
=> <#Hashie::Rash result_count=15 results=[...]> 
```

所以我需要制作一个愿望清单，其中包含使用 iTunes gem 创建的曲目并将其保存在 cookie 中（是的）。我想到了类似的事情：

```
 cookies => {:wishlist=> {
    :track1=>#<Hashie::Rash result_count=1 results=[#<Hashie::Rash artist_id=423861127 artist_name="Amenra"], 
    :track2=>#<Hashie::Rash result_count=1 results=[#<Hashie::Rash artist_id=192738438 artist_name="65daysofstatic"]}} 
```

但是如何在 Rails 中正确执行此操作以及如何从任何轨道获取艺术家姓名？

# oracle - Oracle Exadata - 为查询高和 pctfree 压缩子分区

> ID：13357729
> 
> 赞同：0
> 
> 时间：2012-11-13T08:45:04.790
> 
> 标签：oracle, exadata

如何使用`FOR QUERY HIGH`和`PCTFREE`选项仅压缩分区中的几个子分区

我的陈述看起来是这样的：

```
alter table table_name move subpartition subpartition_name PCTFREE 10 compress for query high; 
```

这个错误发生在它之后：

```
ORA-14160:this physical attribute may not be specified for a table subpartition. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:08:02.677

子分区不可独立压缩。

11gR2 文档将堆组织表的以下部分标识为可压缩的：

*   对于整个表，在relational_table 或object_table 的physical_properties 子句中
*   对于范围分区，在 range_partitions 子句的 table_partition_description
*   对于复合范围分区，在 range_partition_desc 的 table_partition_description
*   对于复合列表分区，在 list_partition_desc 的 table_partition_description
*   对于列表分区，在 list_partitions 子句的 table_partition_description
*   对于系统或参考分区，在 reference_partition_desc 的 table_partition_description 中
*   对于嵌套表的存储表，在nested_table_col_properties 子句中

[http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_7002.htm#SQLRF01402](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_7002.htm#SQLRF01402)

# php - 如何获取标题和帖子摘要？

> ID：13357731
> 
> 赞同：-3
> 
> 时间：2012-11-13T08:45:09.563
> 
> 标签：php, wordpress

假设安装的 wordpress 的 url 是`example.com/blog`. 现在我想在一个名为 test.php 的文件中获取我博客的最新五个标题。`test.php`网址是：.如果`example.com/test.php`我想随机获得五个帖子标题和指定类别下的摘要。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:33:15.677

您需要将 test.php 设为模板页面并使用此模板分配您的博客页面。

将此用作参考[http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

# android - 公共静态方法中的异步任务返回 null

> ID：13357732
> 
> 赞同：-1
> 
> 时间：2012-11-13T08:45:14.890
> 
> 标签：android, json, android-asynctask

所以我有一个异步任务，我已经将它放在一个公共静态方法中，以避免挂起 UI 线程（因为它进行网络调用），同时仍然能够从我的应用程序的几个部分调用它。Async 任务成功运行并返回一个 JSONOBJECT（我已经记录了部分代码以确认这一点）。但是问题是因为我使用公共静态方法，它应该有一个返回类型（在可能的情况下应该返回 JSONOBJECT）但它总是返回 null ..我怎样才能重新编写我的代码才能返回我的异步任务获取的 JSONOBJECT。代码如下。

```
public class JSONmethod {
    static InputStream is = null;
    static String res = "";
    static JSONObject jArray = null;
public static JSONObject getJSONfromURL(final String url){

    new AsyncTask<String, Void, JSONObject>() {

        @Override
        protected JSONObject doInBackground(String... params) {

    try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(url);
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();

    }
    catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
    }

    try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
            }
            is.close();
            res=sb.toString();
    }
    catch(Exception e){
            Log.e("log_tag", "Error converting result "+e.toString());
    }
    Log.i("Result BG ", res);
    try{

        jArray = new JSONObject(res);            
    }catch(JSONException e){
            Log.e("log_tag", "Error parsing data "+e.toString());
    }
    return jArray; //at this point the JSONOBJECT has been fetched

     }

    }.execute();
    return jArray;  //Always null
 } 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T08:52:14.310

如果您的方法应该是异步的，那么它现在无法返回 JSON 结果......

你可以做的是为你的异步任务提供一个回调，当结果可用时将调用它：

```
 public class JSONmethod {
    static InputStream is = null;
    static String res = "";
    static JSONObject jArray = null;

    public static interface JSONCallback {
        public void onResult(JSONObject result);
    }

    public static void getJSONfromURL(final String url, final JSONCallback callback) {

        new AsyncTask<String, Void, JSONObject>() {

            @Override
            protected JSONObject doInBackground(String... params) {

                try {
                    HttpClient httpclient = new DefaultHttpClient();
                    HttpPost httppost = new HttpPost(url);
                    HttpResponse response = httpclient.execute(httppost);
                    HttpEntity entity = response.getEntity();
                    is = entity.getContent();

                } catch (Exception e) {
                    Log.e("log_tag",
                            "Error in http connection " + e.toString());
                }

                try {
                    BufferedReader reader = new BufferedReader(
                            new InputStreamReader(is, "iso-8859-1"), 8);
                    StringBuilder sb = new StringBuilder();
                    String line = null;
                    while ((line = reader.readLine()) != null) {
                        sb.append(line + "\n");
                    }
                    is.close();
                    res = sb.toString();
                } catch (Exception e) {
                    Log.e("log_tag",
                            "Error converting result " + e.toString());
                }
                Log.i("Result BG ", res);
                try {

                    jArray = new JSONObject(res);
                } catch (JSONException e) {
                    Log.e("log_tag", "Error parsing data " + e.toString());
                }

                callback.onResult(jArray);

                return jArray; // at this point the JSONOBJECT has been
                                // fetched

            }

        }.execute();
    }
} 
```

你会这样使用它：

```
 JSONmethod.getJSONfromURL(url, new JSONCallback() {

        @Override
        public void onResult(JSONObject result) {
            // Do whatever you want with the result
        }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T08:57:01.530

异步任务的基础是，在调用方法作为返回值后，您不会立即得到它的结果。

您的调用（无论是否静态）只会执行创建任务的过程（不执行它！）并立即返回。系统可能不会立即执行真正的任务流程代码（可能队列中有一些先前的任务等）。一旦它完成 AsyncTask.doInBackground() 方法，并在调用 AsyncTask.onPostExecute() 之后，任务将完成。默认情况下，它不会调用您的任何方法。在 AsyncTask.onPostExecute() 方法上更新 UI 是您的责任。

# java - SWT 在表单中动态绘制表格

> ID：13357736
> 
> 赞同：1
> 
> 时间：2012-11-13T08:45:25.070
> 
> 标签：java, eclipse, swt, dynamically-generated

我有一个表单，在表单的一部分中，我在工具栏上有一个操作。运行该操作应导致在表单中绘制一个具有动态列和行的 swt 表。

问题是我设法做到这一点的唯一方法是最初创建一个空表，然后将表句柄传递给稍后将填充它的操作。

如果我有绘制表格的操作代码，表格不会展开（滚动）以显示整个表格。

有没有办法在不创建初始表的情况下实现我想要的？

我使用 Composite 的代码是这样的：在表单构造中创建复合：

```
 gd = new GridData();
    gd.widthHint = 400;
    gd.heightHint = 200;

    tableComposite = new Composite(this.client, SWT.None);
    tableComposite.setLayoutData(gd); 
```

在动作代码中：

```
 GridData gd = new GridData();
    gd.widthHint = 400;
    gd.heightHint = 200;

    if (this.viewer != null) {
        this.viewer.getTable().setRedraw(false);

        while (this.viewer.getTable().getColumnCount() > 0) {
            this.viewer.getTable().getColumns()[0].dispose();
        }
        this.viewer.getTable().dispose();
        this.viewer = null;
    }
    this.viewer = new TableViewer(composite, SWT.BORDER
            | SWT.FULL_SELECTION);
    this.viewer.setContentProvider(new FeatureContentProvider());
    this.viewer.setLabelProvider(new FeatureLabelProvider());
    this.viewer.getTable().setLayoutData(gd);
    this.viewer.getTable().setHeaderVisible(true);
    this.viewer.getTable().redraw();
    this.viewer.refresh();

    List<String> columnNames = getColumnNamesForTable();
    for (String name : columnNames) {
        TableColumn c = new TableColumn(this.viewer.getTable(), SWT.NONE);
        c.setText(name);
        c.setWidth(100);
    }

    this.viewer.getTable().redraw();
    this.viewer.refresh();

    this.viewer.setInput(iterations);
    this.composite.layout(true, true); 
```

其中复合是从动作代码中的表单传递的参数。该表似乎已分配，复合空间也已分配，但未显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:13:21.253

我会这样做：

*   `Composite`在要添加表格的位置（占位符）创建表单时创建一个空白。在添加表格之前，它将不可见。

*   当您需要创建表时，处置占位符组合的所有子项（例如，删除以前的表）

*   `Table`使用占位符复合作为父级创建

*   创建列并填充表格

*   调用`layout(true, true)`表格（或顶级复合材料）以显示表格。

**编辑**

根据我对您的代码的了解，您至少需要将布局设置为`tableComposite`：

```
tableComposite.setLayout(GridLayoutFactory.fillDefaults().create()); 
```

并且重新布局应该在更高级别完成（可能使用`getParent()`一次或多次，直到您达到顶级复合材料，但如果您将它作为一个字段会更好）。例子：

```
this.composite.getParent().layout(true, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T22:09:05.717

更好的解决方案应该是：

1) 在创建表单时添加空表2) 通过将表的属性设置为 true
从 UI 中排除表 3) 需要时向表中添加列和行 4) 将属性设置为 5) 重绘或表的容器。`exclude``GridData`

`exclude``false`
`layout`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:47:16.580

上面的代码中缺少的`redraw`是`Composite`：

```
this.composite.redraw(); 
```

# streaming - zlib，如何解压缩压缩数据块的流？

> ID：13357745
> 
> 赞同：3
> 
> 时间：2012-11-13T08:46:01.837
> 
> 标签：streaming, zlib

我在通过网络传输压缩数据时遇到问题。

数据大小约为几百 MB。我的计划是将数据分成 1MB 块并用 zlib 压缩每个块，然后通过网络传输压缩数据。在网络的另一端，数据将被 zlib 解压。

我的问题是，由于我流式传输压缩数据，因此不会有关于每个压缩块在流中开始和结束的位置的信息。我不确定 zlib 是否可以解压缩这样的压缩数据流。

如果 zlib 可以，请告诉我应该在放气/充气方法中使用什么刷新模式？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-14T03:30:50.423

如果您使用的策略是必须的，您可以在主机和远程之间建立一个协议，例如：

```
02 123456 the-compressed-data 654321 the-compressed-data 
```

这3个数字分别是：1.数据块的数量，这里是2个块2.第一个块的字节数3.第二个块的字节数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T18:24:33.263

不清楚为什么要将数据分成块，或者为什么需要进行任何特殊的刷新。如果您只是将数据以块的形式提供给 zlib，那么这就是通常使用 zlib 的方式。zlib 不在乎你如何向它提供数据——大块、小块、一次一个字节、一个大块等，都不会改变压缩结果。

冲洗确实会改变压缩结果，根据您冲洗的频率和冲洗方式，稍微或显着降低它。

当您希望确保在压缩数据的已知边界处完全接收到部分数据时，或者如果您希望能够恢复部分数据（如果未接收到全部数据），则使用刷新。

# firefox - 字体在 Firefox、Opera、IE 中不起作用

> ID：13357750
> 
> 赞同：0
> 
> 时间：2012-11-13T08:46:21.010
> 
> 标签：firefox, google-chrome, internet-explorer-9, opera, font-face

[该站点](http://brinkley.doig.com.au/)使用@font-face 在顶部导航栏中显示 Myriad Pro。我认为这是违反许可证的行为。我会尽快寻找替代版本。我可能会看Cufon？我想先让@font-face 规则起作用，然后放入不同的字体。

该网站有CSS：

```
<!--[if IE]>
@font-face {
    font-family: 'MyriadPro-BoldCond';
        src: url('.../myriadpro-boldcond.eot');
}
<![endif]-->

@font-face {
    font-family: 'MyriadPro-BoldCond';
        src: url('.../myriadpro-boldcond.eot?#iefix') format('embedded-opentype'),
            url('.../myriadpro-boldcond.woff') format('woff'),
            url('.../myriadpro-boldcond.ttf') format('truetype'),
            url('.../myriadpro-boldcond.svg#myriadpro-boldcond') format('svg');
        font-weight: normal;
        font-style: normal;
} 
```

但是，该字体仅在 Chrome 中显示，在 IE9、Opera 或 Firefox 中不显示。

**更新**：我已将 IE 条件条目移到其他条目下方，但问题仍然存在于 IE 中：

```
@font-face {
    font-family: 'MyriadPro-BoldCond';
        src: url('http:/.../myriadpro-boldcond.eot?#iefix') format('embedded-opentype'),
               url('.../myriadpro-boldcond.woff') format('woff'),
               url('.../myriadpro-boldcond.ttf') format('truetype'),
               url('...myriadpro-boldcond.svg#myriadpro-boldcond') format('svg');
        font-weight: normal;
        font-style: normal;
}

<!--[if IE]>
@font-face {
    font-family: 'MyriadPro-BoldCond';
        src: url('...myriadpro-boldcond.eot');
}
<![endif]--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T10:33:02.967

在 Firefox 错误控制台中，加载您的站点时：

> [02:31:52.279] 可下载字体：下载失败（字体系列：“MyriadPro-BoldCond”样式：正常重量：正常拉伸：正常 src 索引：1）：不允许 URI 或跨站点访问来源：[http： //www.doig.com.au/wp-content/themes/brinkley/myriadpro-boldcond.woff](http://www.doig.com.au/wp-content/themes/brinkley/myriadpro-boldcond.woff) @ [http://brinkley.doig.com.au/wp-content/themes/brinkley/style.css?ver= 3.4.2](http://brinkley.doig.com.au/wp-content/themes/brinkley/style.css?ver=3.4.2)

请注意，该站点位于`brinkley.doig.com.au`但正在从 加载字体`www.doig.com.au`。并且大概服务器不提供正确的 CORS 标头。

它在 Chrome 中工作的唯一原因是 Chrome 没有正确实现[http://dev.w3.org/csswg/css3-fonts/#default-same-origin-restriction](http://dev.w3.org/csswg/css3-fonts/#default-same-origin-restriction)

# asp.net - SocketException (0x274c) 通过 ASP.net、.net 4.0、IIS 7

> ID：13357752
> 
> 赞同：0
> 
> 时间：2012-11-13T08:46:29.673
> 
> 标签：asp.net, .net, iis-7, xml-parsing

我在 IIS 7 上部署了我的网站，编译时没有错误，但是在远程 IIS 7 上部署应用程序时，检查页面时，索引页面很好，但错误消息显示在以下页面。

问题是，当用户开始搜索信息（这是一个 xml 文件请求）时，页面会显示一些错误，例如：

```
Server Error in '/' Application.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Net.Sockets.SocketException:  A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. xx.xx.xx.xx:xx

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below. 
```

堆栈跟踪：

```
[SocketException (0x274c):  A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. xx.xx.xx.xx:xx]
System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress) +305
System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress& address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception& exception) +699

[WebException: Unable to connect to the remote server]
System.Net.HttpWebRequest.GetResponse() +7863572
System.Xml.XmlDownloadManager.GetNonFileStream(Uri uri, ICredentials credentials, IWebProxy proxy, RequestCachePolicy cachePolicy) +160
System.Xml.XmlUrlResolver.GetEntity(Uri absoluteUri, String role, Type ofObjectToReturn) +310
System.Xml.XmlTextReaderImpl.OpenUrlDelegate(Object xmlResolver) +75
System.Threading.CompressedStack.runTryCode(Object userData) +136
System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData) +0
System.Threading.CompressedStack.Run(CompressedStack compressedStack, ContextCallback callback, Object state) +118
System.Xml.XmlTextReaderImpl.OpenUrl() +5030375
System.Xml.XmlTextReaderImpl.Read() +120
System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace) +172
System.Xml.XmlDocument.Load(XmlReader reader) +144
System.Xml.XmlDocument.Load(String filename) +205
parkWebService.page2.GmarkersCreator() in c:\Users\61085\Documents\C_parksystem_Web\C_parksystem_Web\parkWebService\parkWebService\search_map.aspx.cs:87
System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25
System.Web.UI.Control.LoadRecursive() +71
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3064 
```

我想知道这是否是 IIS 7 设置的问题，但直到现在我无法修复它。我的服务器环境是 Windows 7 上的 .NET 4.0 和 IIS 7。

我不知道如何追踪这个错误，如果需要提供更多信息或代码，请提醒我，感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:43:02.773

从堆栈跟踪的外观来看，您正在将 URL 传递给`XmlDocument.Load`函数。如果文件位于本地服务器上并且正在执行的应用程序池可以访问该文件夹，请尝试使用`Server.MapPath`( [docs](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath%28v=vs.100%29.aspx) ) 获取文件系统位置并将其传递给该文件夹`XmlDocument.Load`。

如果传递 URL 是所需的行为，请检查应用程序是否可以实际访问外部资源（服务器上的代理设置等）。

# installation - 将安装程序合并为一个安装程序 [语言不明确]

> ID：13357753
> 
> 赞同：1
> 
> 时间：2012-11-13T08:46:34.620
> 
> 标签：installation, bundle

我有一个关于安装程序的问题。

在我的工作场所，我们有一个开发环境，其中包含很多 IDE 和这些 IDE 的插件。

我刚刚开始在那里工作，我还没有建立我的开发环境。但是请记住，他们将在接下来的几个月内雇用新的 Juniors，我认为创建一个调用所有其他安装程序的安装程序可能是一个好主意，基本上是制作 IDE 的安装包。

现在这是问题所在。我知道 Visual Studio 应该可以，但我只能拿到 Express 版，而且我怀疑他们是否会为我获得专业版。

**所以我的问题是，如何创建这样的捆绑安装？**我几乎可以在任何环境中工作，但在工作中我们有 Eclipse，在家里我有 VS Professional（但无法访问我需要的文件）。

欢迎任何帮助，绳索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T07:34:50.963

由于您对免费的强大工具感兴趣，我唯一推荐的是 Wix，它的新功能称为[Burn，用于处理安装包捆绑](http://wix.sourceforge.net/manual-wix3/authoring_bundle_intro.htm)。有付费工具可以帮助您更快地完成这项工作，但您需要一点预算。

# c# - 如何在使用 Bouncy Castle 加密之前填充数据

> ID：13357758
> 
> 赞同：6
> 
> 时间：2012-11-13T08:47:14.953
> 
> 标签：c#, cryptography, aes

我正在尝试使用 CBC 模式的 AES 算法加密我的数据。出于这个原因，我使用 .Net 库“Bouncy Castle”。我没有加密背景，所以我试图以一种简单的方式使用它。这是我的加密代码

```
public byte[] encrypt(byte[] key, byte[] iv,byte[] data) 
    {
        IBlockCipher engine=new AesFastEngine();
        KeyParameter keyParam = new KeyParameter(key);
        CbcBlockCipher cipher = new CbcBlockCipher(engine);

        ICipherParameters parameters = new ParametersWithIV(keyParam, iv);

        byte[] output=new byte[16+data.Length];
        cipher.Init(true, parameters);
        cipher.ProcessBlock(data, 0, output, data.Length);

        //process output
        byte[] cipherArray = new byte[data.Length];
        /*
        int k=0;
        for (int i = 0; i < output.Length; i++) 
        {
            if (output[i]!= 0) 
            {
                cipherArray[k++] = output[i];
            }
        }
         */
        return cipherArray;

    } 
```

当我尝试输入不是 16 的倍数时，我得到一个异常。当我用左边的零填充数组到右边时，我可以得到一个结果。但结果对我来说也是一个问题。它给了我这样的结果：

```
[0][0][0][0[111][22][33][44][66][77][33][12][32][23][0][0][0][0][0] 
```

左右两边都是零。

我认为这可能与我对`ProcessBlock(data, 0, output, data.Length)`功能的使用有关。我使用它的假设是输出将是我的密文，但似乎输出应该比输入长度长。由于我没有有关此功能的文档，因此我可能以错误的方式使用它。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T17:16:00.587

Bouncy Castle 将为您做填充，首先您需要将密码设置为：

```
 PaddedBufferedBlockCipher cipher = new PaddedBufferedBlockCipher(new CbcBlockCipher(engine), new Pkcs7Padding()); 
```

为了使您的其余代码正常工作，需要使用`cipher.GetOutputSize(data.Length)` `ProcessBytes`，`DoFinal`因此正确添加了填充。

```
byte[] output = new byte[cipher.GetOutputSize(data.Length)];
int len = cipher.ProcessBytes(data, 0, data.Length, output, 0);
cipher.DoFinal(output, len); 
```

我有一个关于[在 CodeReview 上的 Bouncy Castle 中使用 AES-GCM的简单示例](https://codereview.stackexchange.com/questions/14892/review-of-simplified-secure-encryption-of-a-string)

AES-GCM 增加了鉴权加密，但是使用 api 的基本原理是一样的。

I also have a C# port of high level encryption framework, [Kecyzar](http://keyczar.org), that I used Bouncy Castle as the backend, although it's a harder example, the abstracted encryption code [SymmetricStream](https://github.com/jbtule/keyczar-dotnet/blob/master/dotnet/Keyczar/Keyczar/Crypto/Streams/SymmetricStream.cs) is setup for using AES-CBC in [BouncyAesKey](https://github.com/jbtule/keyczar-dotnet/blob/master/dotnet/Keyczar/KeyczarTest/PerfTest.cs#L108)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T16:03:28.417

通常，人们会使用标准填充算法来确保明文数据与密码的块大小对齐。

您目前正在手工编码[零填充](http://en.wikipedia.org/wiki/Padding_%28cryptography%29#Zero_padding)。这不是一个很好的选择，因为它禁止以零字节结尾的原始数据 - 您如何将其与填充区分开来？

我建议您使用标准填充，例如[PKCS #7 padding](http://en.wikipedia.org/wiki/Padding_%28cryptography%29#Byte_padding)。请注意，这通常被称为“ *PKCS #5 padding* ”，因为它们非常相似。

您可能希望参考这个其他 SO 问题 - [Encrypt/Decrypt using Bouncy Castle in C#](https://stackoverflow.com/questions/5910454/encrypt-decrypt-using-bouncy-castle-in-c-sharp) - 以获取使用标准填充的示例。

# mysql - mysql 如果不存在则创建用户

> ID：13357760
> 
> 赞同：108
> 
> 时间：2012-11-13T08:47:42.730
> 
> 标签：mysql, user-management

我有一个查询来检查 mysql 用户列表以创建新用户。

```
IF (SELECT EXISTS(SELECT 1 FROM `mysql`.`user` WHERE `user` = '{{ title }}')) = 0 THEN
    CREATE USER '{{ title }}'@'localhost' IDENTIFIED BY '{{ password }}'
END IF; 
```

但我得到这个错误：

```
ERROR 1064 (42000) at line 3: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF (SELECT EXISTS(SELECT 1 FROM `mysql`.`user` WHERE `user` = 'cms_localhost')) = 0 ' at line 1 
```

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2013-05-16T16:24:28.407

In 5.7.6 and above, you should be able to use [`CREATE USER`](http://dev.mysql.com/doc/refman/5.7/en/create-user.html)

```
CREATE USER IF NOT EXISTS 'user'@'localhost' IDENTIFIED BY 'password'; 
```

Note that the 5.7.6 method doesn't actually grant any permissions.

* * *

If you aren't using a version which has this capability (something below 5.7.6), you can do the following:

```
GRANT ALL ON `database`.* TO 'user'@'localhost' IDENTIFIED BY 'password'; 
```

This will create the user if it doesn't exist

* * *

Note, if you are on MySQL 8, the `GRANT ALL` method will not create a user.

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2015-05-15T08:11:56.447

我用

SELECT EXISTS (SELECT DISTINCT `user`FROM `mysql`. `user`WHERE `user`= "username") as is_user

如果存在则返回 1，如果不存在则返回 0

# c# - Amazon.S3.IO S3DirectoryInfo

> ID：13357761
> 
> 赞同：1
> 
> 时间：2012-11-13T08:47:47.747
> 
> 标签：c#, .net, amazon-s3, timeout

> **可能重复：**
> [如何将大于 5 MB（大约）的文件上传到 Amazon S3（官方 SDK）？](https://stackoverflow.com/questions/3871430/how-to-upload-files-to-amazon-s3-official-sdk-that-are-larger-than-5-mb-appro)

我尝试使用 Amazon.S3.IO API。如果我写 10mb 没有问题。如果我写 21mb 我得到一个例外：

> 请求被中止：请求被取消。
> 
> 堆栈跟踪：
> 在 System.Net.ConnectStream.CloseInternal(Boolean internalCall, Boolean aborting) 在 System.Net.ConnectStream.System.Net.ICloseEx.CloseEx(CloseExState closeState) 在 System.Net.ConnectStream.Dispose(Boolean disposing) 在 System.IO。 Stream.Close() at System.IO.Stream.Dispose() 在 Amazon.S3.AmazonS3Client.getRequestStreamCallback[T](IAsyncResult 结果) 在 Amazon.S3.AmazonS3Client.endOperation[T](IAsyncResult 结果) 在 Amazon.S3。 AmazonS3Client.EndPutObject(IAsyncResult asyncResult) 在 Amazon.S3.AmazonS3Client.PutObject(PutObjectRequest request) 在 Amazon.S3.IO.S3FileStream.Flush(Boolean flushToS3) 在 Amazon.S3.IO.S3FileStream.Dispose(Boolean disposing) 在 System。 IO.Stream.Close() 在 System.IO.StreamWriter.Dispose(Boolean disposing) 在 System.IO.TextWriter.Dispose() 在 S3FileSystem_Sample.Program。c:\Program Files (x86)\AWS SDK for .NET\Samples\S3FileSystem_Sample\S3FileSystem_Sample\Program.cs 中的 createFile(S3DirectoryInfo rootDirectory, String filename)：c 中 S3FileSystem_Sample.Program.Main(String[] args) 的第 106 行:\Program Files (x86)\AWS SDK for .NET\Samples\S3FileSystem_Sample\S3FileSystem_Sample\Program.cs：System.AppDomain._nExecuteAssembly（RuntimeAssembly 程序集，String[] args）的第 59 行在 System.AppDomain.ExecuteAssembly（字符串 assemblyFile , 证据 assemblySecurity, String[] args) 在 Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() 在 System.Threading.ThreadHelper.ThreadStart_Context(Object state) 在 System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state , Boolean preserveSyncCtx) 在 System.Threading.ExecutionContext。Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Threading.ThreadHelper.ThreadStart()

```
static void createFile(S3DirectoryInfo rootDirectory, string filename)
{ 

    // Creates a file at the root of the bucket.
    S3FileInfo readme = rootDirectory.GetFile(filename);
    char[] buffer = new char[buffersize];  
    fillBuffer(buffer);

    using (StreamWriter writer = new StreamWriter(readme.OpenWrite()))
    {              

        writer.Write(buffer);

    }
} 
```

知道我可以设置超时吗？

[单击此处](https://stackoverflow.com/questions/3871430/how-to-upload-files-to-amazon-s3-official-sdk-that-are-larger-than-5-mb-appro)和[此处](https://stackoverflow.com/questions/9408458/cannot-upload-files-larger-than-30mb-to-amazon?rq=1)了解更多相关问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T22:21:21.563

不幸的是，Amazon.S3.IO API 不支持设置超时，但作为 SDK 的开发人员，我会将该功能请求添加到我们的待办事项中。

请记住，Amazon.S3.IO API 是一个非常容易使用 S3 的接口，但它不太适合大文件，因为它会将它们缓冲到内存中，直到您将文件的全部内容传递给 API，然后将其写入 S3。对于大文件，您应该使用 Amazon.S3.Transfer 命名空间中的 TransferUtility。

# c# - ConfigurationManager.AppSettings[Key] 是否每次都从 web.config 文件中读取？

> ID：13357765
> 
> 赞同：76
> 
> 时间：2012-11-13T08:48:01.473
> 
> 标签：c#, asp.net, web-config, configurationmanager

我想知道它是如何`ConfigurationManager.AppSettings[Key]`工作的。

每次我需要密钥时它都会从物理文件中读取吗？如果是这样，我是否应该在缓存中读取我的 web.config 的所有应用程序设置，然后从中读取？

还是 ASP.NET 或 IIS 在应用程序启动时只加载一次 web.config 文件？

如何验证每次读取是否访问了物理文件？如果我更改 web.config，IIS 会重新启动我的应用程序，因此我无法以这种方式对其进行验证。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-11-13T09:13:46.717

它在第一次访问属性时被缓存，因此每次请求值时它都不会从物理文件中读取。这就是为什么必须重新启动 Windows 应用程序（或[刷新](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.refreshsection.aspx)配置）以获取最新值的原因，以及为什么 ASP.Net 应用程序会在您编辑 web.config 时自动重新启动。答案中的参考资料讨论了为什么 ASP.Net 硬连线以重新[启动在修改 web.config 时如何防止 ASP.NET 应用程序重新启动](https://stackoverflow.com/a/613836/1073107)。

我们可以使用[ILSpy](http://ilspy.net/)并查看 System.Configuration 的内部结构来验证这一点：

```
public static NameValueCollection AppSettings
{
    get
    {
        object section = ConfigurationManager.GetSection("appSettings");
        if (section == null || !(section is NameValueCollection))
        {
            throw new ConfigurationErrorsException(SR.GetString("Config_appsettings_declaration_invalid"));
        }
        return (NameValueCollection)section;
    }
} 
```

起初，这确实看起来每次都会获得该部分。查看 GetSection：

```
public static object GetSection(string sectionName)
{
    if (string.IsNullOrEmpty(sectionName))
    {
        return null;
    }
    ConfigurationManager.PrepareConfigSystem();
    return ConfigurationManager.s_configSystem.GetSection(sectionName);
} 
```

这里的关键是`PrepareConfigSystem()`方法；这将初始化`IInternalConfigSystem`ConfigurationManager 持有的字段的实例 - 具体类型是`ClientConfigurationSystem`

作为此负载的一部分，[Configuration](http://msdn.microsoft.com/en-us/library/system.configuration.configuration.aspx)类的一个实例被实例化。此类实际上是配置文件的对象表示，并且似乎由静态字段中的 ClientConfigurationSystem 的 ClientConfigurationHost 属性持有 - 因此它被缓存。

您可以通过执行以下操作（在 Windows 窗体或 WPF 应用程序中）凭经验对此进行测试：

1.  启动您的应用程序
2.  访问 app.config 中的值
3.  对 app.config 进行更改
4.  检查新值是否存在
5.  称呼`ConfigurationManager.RefreshSection("appSettings")`
6.  检查是否存在新值。

事实上，如果我只是阅读有关[RefreshSection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.refreshsection.aspx)方法的评论，我本可以为自己节省一些时间 :-)

```
/// <summary>Refreshes the named section so the next time that it is retrieved it will be re-read from disk.</summary>
/// <param name="sectionName">The configuration section name or the configuration path and section name of the section to refresh.</param> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-13T09:21:55.950

简单的答案是否定的，它并不总是从文件中读取它。正如一些人所建议的那样，如果文件被更改，那么 IIS 会执行重新启动，但并非总是如此！如果你想保证你从文件中读取最新的值而不是缓存，你需要调用这样的东西：

```
ConfigurationManager.RefreshSection("appSettings");
string fromFile = ConfigurationManager.AppSettings.Get(key) ?? string.Empty; 
```

我在我的代码中使用的一个例子：

```
/// ======================================================================================
/// <summary>
/// Refreshes the settings from disk and returns the specific setting so guarantees the
/// value is up to date at the expense of disk I/O.
/// </summary>
/// <param name="key">The setting key to return.</param>
/// <remarks>This method does involve disk I/O so should not be used in loops etc.</remarks>
/// <returns>The setting value or an empty string if not found.</returns>
/// ======================================================================================
private string RefreshFromDiskAndGetSetting(string key)
{
    // Always read from the disk to get the latest setting, this will add some overhead but
    // because this is done so infrequently it shouldn't cause any real performance issues
    ConfigurationManager.RefreshSection("appSettings");
    return GetCachedSetting(key);
}

/// ======================================================================================
/// <summary>
/// Retrieves the setting from cache so CANNOT guarantees the value is up to date but
/// does not involve disk I/O so can be called frequently.
/// </summary>
/// <param name="key">The setting key to return.</param>
/// <remarks>This method cannot guarantee the setting is up to date.</remarks>
/// <returns>The setting value or an empty string if not found.</returns>
/// ======================================================================================
private string GetCachedSetting(string key)
{
    return ConfigurationManager.AppSettings.Get(key) ?? string.Empty;
} 
```

这使您可以非常轻松地选择（并在阅读代码时查看）是否每次都获取最新值，或者您是否不希望从应用程序启动时更改该值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T09:17:49.937

```
var file = new FileInfo(@"\\MyConfigFilePath\Web.config");

DateTime first  = file.LastAccessTime;

string fn = ConfigurationManager.AppSettings["FirstName"];
Thread.Sleep(2000);

DateTime second = file.LastAccessTime;

string sn = ConfigurationManager.AppSettings["Surname"];
Thread.Sleep(2000);

DateTime third = file.LastAccessTime; 
```

全部显示相同的 LastAccessTime，这意味着它在启动时被缓存。

```
string fn1 = ConfigurationManager.AppSettings["FirstName"];
Thread.Sleep(2000);

DateTime fourth = file.LastAccessTime; 
```

# javascript - Chrome 在我的主干页面上冻结：如何调试？

> ID：13357772
> 
> 赞同：1
> 
> 时间：2012-11-13T08:48:32.947
> 
> 标签：javascript, google-chrome, backbone.js, google-chrome-devtools

我正在处理的项目涉及一个“计划”屏幕，它完全由backbone.js 制作（应用程序的其他页面不是）。

我的问题是，Chrome 有时会冻结，并且 Web 视图会停止响应任何交互。有时，我可以设法退出 chrome，但通常控件也不会响应。

我很确信这与 js 代码有关。在我看来，当脚本花费太多时间或无限循环时，Chrome 可以检测到这一点并中断脚本。但是，由于情况并非如此，我认为太多的 js 对象留在内存中。

不管是什么原因，我想知道哪些 chrome 开发工具可以帮助我。虽然我不是 js 的初学者，除了设置断点和调用之外`console.log`，我不知道如何调试 JS 应用程序。如果开发工具更适合，我不反对使用其他浏览器。

非常感谢您的时间！

FTR：这是一个 rails 3.2.8 应用程序，使用 mongodb 和 Backbone.js 0.9.2。js代码是用coffeescript编写的。这个问题发生在我运行山狮的 macbook air 2012 以及在 Windows 7 上运行的客户端机器上。这个问题至少出现在 chrome 22 和 23 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:17:57.490

Using the Javascript CPU profiler, I was able to find the group of functions that seems to be responsible for the freezing.

I'm still open to any advice/ressource on debugging javascript code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:53:32.230

在循环中创建一个 console.log 并检查它是否在所有 chrome 版本上冻结相同的点。有一个限制，请参阅[浏览器 Javascript 堆栈大小限制](https://stackoverflow.com/questions/7826992/browser-javascript-stack-size-limit)。

也许添加一些代码？因为可能会有一些内存泄漏，尤其是事件处理程序！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T04:20:57.780

当然你知道你可以设置断点吗？甚至是条件断点

我目前正在努力解开一个类似的探测循环 - 我想在紧急情况下`alert()`你的代码中的一些调用至少会减慢循环速度

~~或者可能是一些等待电话~~（[坏主意](https://stackoverflow.com/questions/15694470/javascript-wait-function)）

我的循环运行得如此之快，以至于我丢失了控制台日志！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T02:26:40.553

我要做的是用console.log弄脏你的手的漫长而疲惫的方法。 - - 在这种情况下。在您的情况下，顺便提一下 THX（使用 CPU 分析器找到违规者，我会在下一轮尝试），我猜违规者可能是某些函数自己“回调”.. 可能通过某种事件处理/冒泡/回调组合。

然后发生的通常是它无法识别无限循环，因为回调堆栈有点“损坏”。因此它永远不会抛出浏览器错误。

如果你有任何运气，它不会足够快地杀死浏览器来杀死控制台。我有时确实遇到过这种情况，控制台被杀死（保持沉默），甚至没有在调试器中加载咖啡脚本文件（我在 JS-MVC 中使用 JIT-coffee-to-js-translator）......页面冻结或什么都不做...

所以，如果你真的很幸运，并且调试器会吐出你的 console.logs，那么你就可以猜测你不需要的循环隐藏在哪里。只需查看输出语句的重复顺序即可。

# scala - 将 logback.xml 与 Scala 工作表一起使用

> ID：13357774
> 
> 赞同：2
> 
> 时间：2012-11-13T08:48:41.383
> 
> 标签：scala, scala-ide, slick

Scala Worsheet 将记录器输出设置为调试，这会导致第三方库（在本例中为 Slick）打印出大量的日志信息。有什么方法可以自定义记录器以将特定库置于“信息”级别。

我的资源目录中有一个 logback.xml 文件，但 Scala Worksheet 忽略了这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:24:12.817

这似乎是 Scala-IDE 或 Worksheet nightly 的问题。最近更新后，工作表停止打印外部库的调试信息。伟大的！

# objective-c - 将 Objective-C 代码拆分为多个文件

> ID：13357775
> 
> 赞同：11
> 
> 时间：2012-11-13T08:48:45.190
> 
> 标签：objective-c, xcode

我经常觉得需要将 Objective-C 代码拆分为多个文件以提高可读性。我想避免上课并打电话给他们。我想要简单的导入（比如在 php 中）。

如果有人可以请参考一个工作示例。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-13T09:03:23.317

我认为您在这种情况下正在查看类别：

您所要做的就是在 .h 文件中创建一个新的 .h .m 对：

```
#import MyClass.h

@interface MyClass(Networking)

//method declarations here

@end 
```

在 .m 文件中：

```
#import MyClass+Networking.h

@implementation MyClass(Networking)

//method definitions here

@end 
```

在 MyClass.m 文件中 - 执行 #import MyClass+Networking.h 就可以了。这样你就可以扩展你的类。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-13T09:05:04.430

你说“我想避免上课并打电话给他们。” 您需要克服[对添加课程的恐惧](http://c2.com/cgi/wiki?FearOfAddingClasses)。如果您觉得需要将一个类的实现拆分为多个文件，那么您很可能试图在一个类中做太多事情。您需要让该类将一些职责移交（“委派”）给其他类。

也就是说，有几种方法可以拆分类的实现。除了修复臃肿的类设计之外，更好的方法是使用类别或类扩展。[*您可以在The Objective-C Programming Language*](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)中阅读有关类别和扩展的所有信息。请注意，链接器在创建可执行文件时会将类别和扩展合并到类中，因此在您自己的类上使用类别或扩展不会造成运行时损失。

更糟糕的方法是使用 C 预处理器的`#include`指令将多个文件粘贴在一起。您可以从实现文件中取出一些方法并将它们粘贴到新的“片段”文件中，然后`#include`将片段文件放入实现文件中。 **这样做会使您更难理解您的源代码。** 我**不**建议这样做，但无论如何这里有一个例子：

### 我的对象.m

```
#import "MyObject.h"

@implementation MyObject

- (void)aMethod { ... }

#include "MyObject-moreMethods.m"

@end 
```

### MyObject-moreMethods.m

```
// Note: do not include this target in the “Compile Sources” build phase of your target.
// And **NO** @implementation statement here!

- (void)methodTwo { ... }

- (void)methodThree { ... } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-09T21:03:25.840

[编辑/更新——我已经放弃了下面描述的方法，转而使用类别，正如其他一些答案中提到的那样。我的典型情况是，当视图添加了控件组件时，视图控制器文件变得笨拙，因为添加了代码以适应控件的各种委托和数据源方法。现在我在视图控制器文件中添加代码存根，然后在类类别中真正实现它们。例如，我可能有一个具有搜索栏和集合视图的 AlbumViewController 屏幕，因此我创建了 AlbumViewController+SearchBar 和 AlbumViewController+CollectionView 类别。这允许 View Controller 类保持在合理的大小，而不会产生我在下面列出的包含文件的任何缺点。唯一的缺点是任何实例变量，即属性，

我也想拆分我的文件，但认为类别在某些情况下不是正确的解决方案。例如，随着 nib 增长到包含多个对象（例如表格、按钮、导航栏、选项卡等），需要将所有支持方法放在 viewcontroller.m 文件中可能会导致文件非常大且难以处理。

在本次讨论中，我将原始/标准 .m 文件称为父文件，将子 .m 文件称为子文件。

目标是拥有一个父 .h 和 .m，以及多个子 .m 文件，每个文件都可以独立编辑，但编译时就像所有子 .m 文件都在父 .m 文件中一样。

例如，如果您希望能够将所有与表相关的方法放在一个文件中，对其进行编辑，然后让它像包含在 viewcontroller.m 实现文件中一样进行编译，这将很有用。这似乎是可能的，但需要一点努力，并且有一个（可能是严重的）缺点。

要记住的是，使用了两种不同的工具：IDE（提供智能源代码编辑）和编译器/制作系统，它将项目的源代码转换为可运行的应用程序。

要使 IDE 按预期工作，子文件需要看起来是类实现的一部分。这可以通过将@implementation 和@end 指令包装在条件编译宏中来实现。单独编辑文件时，IDE 将子文件视为类的主体，但编译器不会。

为了让编译器不抱怨，您不能将子文件视为目标的一部分——而是通过预处理器 #include 指令将它们拉入。这可以通过在创建文件（或添加到项目）时不将它们添加到目标来完成，或者通过在“构建阶段”->“编译源”窗格中删除它们来完成。

然后，您可以在父 .m 文件的正文中 #include 子 .m 文件。编译器“就地”加载它们并根据需要编译源代码而不会抱怨。

这种方法的缺点（到目前为止）是调试器无法识别子方法，并且不会在放置在它们上的断点处中断。出于这个原因，我建议仅在对代码进行彻底测试之后使用这种方法，或者用于相对琐碎且众所周知的代码块，例如表委托和数据源方法。

以下是项目的 .h 和 .m 文件，在 nib 中有一个表格和一个文本字段，支持的委托方法在子 .m 文件中定义。在 nib 中，接口对象正常连接，并将委托设置为文件所有者。

文件（父）“MyViewController.h”：

```
#import <UIKit/UIKit.h>

@interface MyViewController : UIViewController

@property (retain, nonatomic) IBOutlet UITableView *myTable;
@property (retain, nonatomic) IBOutlet UITextField *myTextField;

@end 
```

文件（父）MyViewController.m：

```
#import "MyViewController.h"

#define VIEW_CONTROLLER_MAIN_BODY   1

@interface MyViewController ()

@end

@implementation MyViewController

#include "MyViewController_TableMethods.m"
#include "MyViewController_TextFieldMethods.m"

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)dealloc {
    [_myTable release];
    [_myTextField release];
    [super dealloc];
} 
```

文件（子）MyViewController_TableMethods.m：

```
#import <UIKit/UIKit.h>
#import "MyViewController.h"

#ifndef VIEW_CONTROLLER_MAIN_BODY
@implementation ViewController
#endif

#pragma mark -
#pragma mark Table View Common Methods

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section;
{
    return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;
{
    static NSString *myIdentifier =    @"myCellIdentifier";
    static UITableViewCellStyle myStyle = UITableViewCellStyleSubtitle;

    UITableViewCell *cell = [self.myTable dequeueReusableCellWithIdentifier:myIdentifier];
    if (cell == nil)
    {
        cell = [[[UITableViewCell alloc] initWithStyle:myStyle reuseIdentifier:myIdentifier] autorelease];
    }

    cell.textLabel.text = @"Title";
    cell.detailTextLabel.text =  @"Details";
    cell.accessoryType = UITableViewCellAccessoryNone; 

    return cell;
}

#ifndef VIEW_CONTROLLER_MAIN_BODY
@end
#endif 
```

文件（子）MyViewController_TextFieldMethods.m：

```
#import <UIKit/UIKit.h>
#import "MyViewController.h"

#ifndef VIEW_CONTROLLER_MAIN_BODY
@implementation MyViewController
#endif

- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    self.myTextField.text = @"Woo hoo!";

    return YES;
}

#ifndef VIEW_CONTROLLER_MAIN_BODY
@end
#endif 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-13T09:03:41.483

这很好地表明您的班级太大了。

一种方法：使用类别。声明通常可以保留在标题中。那么你的实现可能会被划分。只需确保指定您正在实现的类别，以便编译器可以将其与其声明相匹配，并在您错过定义时通知您。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-08T10:58:12.967

分解大类的一个好方法是类别中的分组功能**（**就像 Apple 在 UIViewController 中所做的那样）。对于一个大类，我通常将与其相应功能相关的方法和属性分组，然后在基本头文件中，我拆分

```
@interface SomeClass : NSObject
@property (strong, nonatomic) BaseProperty *sp;
- (void)someMethodForBase;
@end

@interface SomeClass (FunctionalityOne)
@property (strong, nonatomic) FuncOne *fpOne;
- (void)someMethodForFunctionalityOne;
@end

@interface SomeClass (FunctionalityTwo)
@property (strong, nonatomic) FuncTwo *fpTwo;
- (void)someMethodForFunctionalityTwo;
@end 
```

因为您不能在类别中添加属性（您不能在类别中添加新的 iVar 和属性不合成）所以您再次在基本扩展的实现中声明它。

```
@interface SomeClass()
@property (strong, nonatomic) FuncOne *fpOne;
@property (strong, nonatomic) FuncTwo *fpTwo;
@end

@implementation SomeClass
//base class implementation
- (void)someMethodForBase {
}
@end 
```

在 SomeClass+FunctionalityOne.m 中实现各自的功能

```
@implementation SomeClass (FunctionalityOne)
@dynamic fpOne;
//Functionality one implementation
- (void)someMethodForFunctionalityOne {
}
@end 
```

在 SomeClass+FunctionalityTwo.m 中实现各自的功能

```
@implementation SomeClass (FunctionalityTwo)
@dynamic fpTwo;
//Functionality two implementation
- (void)someMethodForFunctionalityTwo {
}
@end 
```

通过这种方式，我将我的大类实现清晰地组织成小类，所有类功能信息都分组在单个基本标头中以供读取和导入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-29T07:34:56.687

最好在 iOS 中使用类别保持代码干净。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-19T22:24:47.500

我知道这是一个旧线程，Objective C 之神不会喜欢这个解决方案，但是如果您需要拆分文件，请创建一个新的 .m 文件并将您的代码粘贴到那里。然后，在要包含它的 .m 文件中的 @implementation 之后 #include "yournewfile.m" 。避免编译器错误的诀窍是进入构建阶段并从编译源中删除“yournewfile.m”。

# objective-c - 如何在 xcode 中的单元测试目标上运行分析

> ID：13357782
> 
> 赞同：3
> 
> 时间：2012-11-13T08:49:15.060
> 
> 标签：objective-c, ios, xcode, unit-testing

我有一个测试用例用于测试目标中的性能测试，所以我想使用 Profile 工具查看分配，但我看到菜单配置文件无法执行，我是否有方法来分析我的单元测试目标。

# php - 在页面的两个单独部分中的两个 iframe 中显示页面的一部分

> ID：13357783
> 
> 赞同：0
> 
> 时间：2012-11-13T08:49:22.507
> 
> 标签：php, javascript, html, iframe

是否可以在两个单独的 iframe 中显示页面的某些部分，我在其中一个 iframe 中所做的更改将反映在另一个 iframe 中？

部分.html

```
+-------------+--------------------------------------------------------------------+
|             |                                                                    |
|   part 1    |                                                                    |
|             |                                                                    |
+-------------+                                                                    |  
|                                                                                  |
|                                                                                  |  
+-------------+                                                                    |         |             |                                                                    |
|   part 2    |                                                                    |
|             |                                                                    |
+-------------+                                                                    |             |                                                                                  |
|                                                                                  |
+----------------------------------------------------------------------------------+ 
```

第 1 帧将加载 part.html 的第 1 部分

第 2 帧将加载 part.html 的第 2 部分

main.html

```
+----------------------------------------------------------------------------------+
|                                                                                  |
|                                                                                  |
|  +----------------+                                                              |
|  |                |                                                              |
|  |                |                                                              |
|  |     frame 1    |                                                              |
|  |                |                                                              |
|  |                |                                                              |
|  +----------------+                                                              |
|                                                                                  |
|                                                                                  |
|                                                        +---------------+         |
|                                                        |               |         |
|                                                        |               |         |
|                                                        |     frame 2   |         |
|                                                        |               |         |
|                                                        |               |         |
|                                                        +---------------+         |
+----------------------------------------------------------------------------------+ 
```

我希望 iframe 仍然作为一页运行，就好像它们没有单独加载一样，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:02:17.967

有几种方法可以实现这一点。首先，您可以在每个页面调用中简单地附加一个参数（part.php?part=1 / part.php?part=2），并在 part.php 文件中添加一些逻辑，以相应的内容进行响应。

但我很确定有更好的方法来实现您尝试实施的内容。首先，您应该阅读此内容，并了解为什么有比使用框架更好的方法：

[http://www.hobo-web.co.uk/website-frames/](http://www.hobo-web.co.uk/website-frames/)

[http://www.free2code.net/tutorials/view/replace_frames_with_php_tables-27/page1.html](http://www.free2code.net/tutorials/view/replace_frames_with_php_tables-27/page1.html)

（第二个示例使用表格，但您应该将重点放在“包含”上）

然后你应该看看你的结构，也许找到一个解决方案来拆分你的“part.htm”文件。所有内容的一个文件可能会变得非常不方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:32:07.360

我不会使用 iframe，而是自己编写某种框架。

通过使用两个 div 作为视口，并将两个文本嵌入到具有共享类的 div 中，您可以上下移动它们。然后视口会阻塞页面的其余部分。使用 jquery 您可以捕获滚动事件，然后您应该能够上下移动两个页面。（现在通过单击其中一个文本来触发意图）。

为了给你一个想法，我给你做了一个小提琴：http: [//jsfiddle.net/SGSDs/5/](http://jsfiddle.net/SGSDs/5/)

**更新：** 您可以使用 AJAX 加载外部页面。这是一个很好的教程：[http ://webhole.net/2009/06/13/ajax-page-loading-with-jquery/](http://webhole.net/2009/06/13/ajax-page-loading-with-jquery/)

HTML：

```
<div class="viewport"><div class="remotepage" id="part1">Lorem ipsum dolor sit amet...</div></div>
<hr>
<div class="viewport"><div class="remotepage" id="part2">Lorem ipsum dolor sit amet...</div></div> 
```

CSS：

```
.viewport {
  width: 200px;  
  height: 200px; 
  overflow: hidden;
  position: relative;
}

.remotepage {
  position: absolute;
  top: 0px;
}

#part2 {
    margin-top: -200px;
} 
```

jQuery：

```
$(function() {   
    $(document).on("click", ".remotepage", function() {
        $(".remotepage").animate({ top: "-=50px" }, 0);
    });
}); 
```

# git - 如何避免提交 DW 动态文件？

> ID：13357784
> 
> 赞同：4
> 
> 时间：2012-11-13T08:49:22.150
> 
> 标签：git, dreamweaver, commit, gitignore

在提交 git 时要求我处理 DreamWeaver 动态文件 (*/_notes/dwsync.xml)。它们有很多，我不知道如何隐藏它们，因为它们是动态的（所以不可能将它们添加到 .gitignore 中）。有谁知道如何解决这个问题？

==================================

得到解决方案后的UPD

如果您仍然看到 dwsync.xml 出现，请清理 git cash：

```
git rm . -r --cached 
```

它应该有帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-15T23:25:02.197

将此添加到存储库根目录中的 .gitignore 文件中：

```
[_]notes/ 
```

让我知道你的情况，它对我有用。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-13T09:10:24.750

.gitignore`_notes`目录？

您**必须阅读 git-docs**才能使用 git

# objective-c - 一个视图一次最多只能关联一个视图控制器（UISegmentedControl）

> ID：13357788
> 
> 赞同：21
> 
> 时间：2012-11-13T08:49:41.347
> 
> 标签：objective-c, ios6

您好 iOS 6 上的模拟器出现错误。

> 由于未捕获的异常“UIViewControllerHierarchyInconsistency”而终止应用程序，原因：“一个视图一次最多只能与一个视图控制器相关联！查看 <UIView: 0xa3ae880; 帧 = (0 0; 320 367); 自动调整大小 = W+H；layer = <CALayer: 0xa3ae8e0>> 与 <SearchHotelsViewController: 0xa3a6a20> 相关联。在将此视图与 <SecondViewController: 0xa1a9e90> 关联之前清除此关联。

初始化代码

```
UISegmentedControl *segmentedControl = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:@"Поиск туров", @"Выбор отеля", nil]];

segmentedControl.segmentedControlStyle = UISegmentedControlStyleBar;
self.navigationItem.titleView = segmentedControl;

[segmentedControl addTarget:self action:@selector(changeSegments:) forControlEvents:UIControlEventValueChanged];
segmentedControl.selectedSegmentIndex = 0;
self.navigationItem.title = [segmentedControl titleForSegmentAtIndex:segmentedControl.selectedSegmentIndex];
[self setView:searchTours];

SearchHotelsViewController *searchHotelsController = [[SearchHotelsViewController alloc] initWithNibName:@"SearchHotelsViewController" bundle:[NSBundle mainBundle]];
selectHotels = searchHotelsController.view; 
```

`selected == 1`应用程序在何时崩溃`true`

```
-(void)changeSegments:(id)sender {
    NSInteger selected = [sender selectedSegmentIndex];
    if (selected == 0) {
        [self setView:searchTours];
    }
    if (selected == 1) {
        [self setView:selectHotels];
    }
    self.navigationItem.title = [sender titleForSegmentAtIndex:selected];
} 
```

我无法理解问题出在哪里。

SearchHotelsViewController.xib

[![SearchHotelsViewController.xib](../Images/c0679451cb93c8633931bf0119e4d068.png)](https://i.stack.imgur.com/d9WOV.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-09T16:58:35.977

确保您的 ViewController 不包含另一个视图控制器对象。例如，如果您的主视图控制器有一个 tableview，请不要将 UITableViewController 放在其中。它曾经在 iOS 5 中传递，但在 iOS 6 中他们不会允许这样做。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-05-29T16:40:10.810

当我是个白痴时，我遇到了这个问题，并将“UITableViewController”对象拖入笔尖以用作视图而不是“UITableView”。哎呀！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-05-08T03:13:47.643

我也遇到了这个，这是我的情况。

为了方便起见，我将故事板中的“UIViewController”对象拖到了 nib 文件中

**无需删除和重新创建。**

在 nib 文件中，我从控制器对象中拖动视图对象，然后删除控制器对象。

并将视图对象出口设置**为其真正的唯一所有者**“viewController 类”，也在 nib 中。

[![111](../Images/2aa8a4fb6ec639f29009a50fe97e0766.png)](https://i.stack.imgur.com/2IxhQ.png)

* * *

更多细节：

*   原始的，你复制的

[![111](../Images/103f2cd978347984fce377a28cad7f3d.png)](https://i.stack.imgur.com/Hz8Xx.png)

*   第一步，拖拽删除

[![222](../Images/33b34c6cd606a5c7487bc548c87e44fb.png)](https://i.stack.imgur.com/7vhrg.png)

*   第二步，链接

[![333](../Images/9d333d09f06d239dd7ba99afc6bbd28c.png)](https://i.stack.imgur.com/1miLP.png)

*   完成，检查一下

[![666](../Images/5fd8dcbe441d6a18129f27eff21592c8.png)](https://i.stack.imgur.com/wVJia.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-03-31T08:42:08.783

当我从 Storyboard 复制/粘贴到 xib 文件中时，我遇到了这个问题。从 xib 重新创建界面为我解决了这个问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-07T11:20:25.887

我有一个类似的问题。多个 xib 文件，有些有效，有些无效，都有一个 UITableView。我不得不删除损坏的 xib 文件并创建新文件。之后他们都工作了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-04T14:06:19.103

如果您尝试将 xib 文件设置为视图控制器，则您的 xib 文件对象必须是窗口对象而不是视图控制器，并且您的 xib 文件的所有者类必须是您的目标视图控制器类。然后，您应该在主视图与文件的所有者出口之间添加关系。

# c# - 使用多个表格在 ASP.net 中构建和设计 Crystal Report

> ID：13357793
> 
> 赞同：1
> 
> 时间：2012-11-13T08:49:59.660
> 
> 标签：c#, asp.net, database, crystal-reports, dataset

我想使用 ASP.net 使用 Crystal Report 构建和设计报表。对我来说最大的挑战是如何在数据集中存储多个表。这是数据集的结构：

[点击查看数据集结构](http://postimage.org/image/62zpk9egt/)

我想知道如何为特定员工（按 ID）构建报告并添加所有员工信息（来自员工表）和来自其他两个表的所有相关信息（（来自 FK 的 AppraisalForm 表：ID_employee）和来自 internalChallenges FK 的表：emp_id 和 FK：form_id))

但是所有这些数据都在一个数据集中，并将这个数据集作为我的水晶报告的来源。

# c++ - 错误：在 ':' 标记之前应有 '='、','、';'、'asm' 或 '__attribute__'

> ID：13357798
> 
> 赞同：2
> 
> 时间：2012-11-13T08:50:51.763
> 
> 标签：c++, c, class, arduino

当我将此代码上传到 Arduino Atmega2560 时发生错误。这是我为程序中的 .c 文件创建的库文件。

错误是：
`herkulex.c:16: error: expected '=', ',', ';', 'asm' or '__attribute__' before ':' token`

出现错误时突出显示“类”一词，该错误位于文件中（代码如下所示）

```
#ifndef herkulex_lib
#define herkulex_lib

#include <Arduino.h>
#include <Wire.h> 
#include<inttypes.h> 

class herkulex
{
  public: 
    herkulex();
    void hklx_Init(unsigned long ulBaudRate);
    void hklx_SendPacket(DrsPacket stPacket);
    unsigned char hklx_ucReceivePacket(DrsPacket *pstPacket);
    void hklx_RemoveInvalidData(void);

//no private  
};

#endif /* HERKULEX_H_ */ 
```

我可以知道这段代码有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T08:52:42.180

您正在编译一个包含 C++ 的 C 文件。C 编译器拒绝 C++ 语法。

而是将其编译为 C++ 程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:00:00.313

这里是不是少了一个`space`：？

```
#include<inttypes.h> 
```

# objective-c - 获取通过 iOS 上所有网络接口发送/接收的总字节数

> ID：13357802
> 
> 赞同：2
> 
> 时间：2012-11-13T08:51:23.790
> 
> 标签：objective-c

我想捕获通过 iPhone 的所有网络接口和特定接口发送/接收的字节总数。我没有从谷歌那里找到任何类似代码的帮助。有没有人可以为此提供有关目标 C 代码的帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:13:23.893

这是不可访问的信息，如果您尝试在设备上访问此信息，则会违反私有框架规则。

所以恐怕这是不可能的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-13T09:17:29.017

![IOS服务层](../Images/6db46eeec0fab04408789bccc320d4ef.png)

我不认为你能做到。正如[iOS技术概述](http://developer.apple.com/library/ios/#documentation/Miscellaneous/Conceptual/iPhoneOSTechOverview/Introduction/Introduction.html)所提到的，你描述的功能是核心服务级别的，在官方文档中没有找到。它可能有一些私有 API，但 Apple 肯定会阻止您使用它们。

所以，我很抱歉。

# json - 从 jQuery DataTables ajax 调用获取错误请求 400 的 json 到 WCF 服务？

> ID：13357803
> 
> 赞同：0
> 
> 时间：2012-11-13T08:51:30.563
> 
> 标签：json, wcf, jquery-datatables

我在从 jQuery DataTables.Net ajax POST 调用到我的 WCF 服务 (4.0) 服务中获取有效 json 时遇到问题。我尝试了很多组合，但无法将这些`aoData`值传递给我的服务。

*[Apols 有这么多代码……我想我最好把我能想到的都贴上去！]*

这是来自 IE F12 调试的调用：

```
Key Value
Request POST /CustomerService.svc/json/GetCustomerDataTable HTTP/1.1
Accept  application/json, text/javascript, */*; q=0.01
Content-Type    application/json; charset=utf-8
Referer http://localhost:51901/Home/ListCustomers
Accept-Language en-gb
Accept-Encoding gzip, deflate
User-Agent  Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
Host    localhost:51900
Content-Length  1651
Connection  Keep-Alive
Cache-Control   no-cache 
```

和请求正文

```
"{ jsonAOData : [{"name":"sEcho","value":1},{"name":"iColumns","value":7},{"name":"sColumns","value":""},{"name":"iDisplayStart","value":0},{"name":"iDisplayLength","value":10},{"name":"mDataProp_0","value":"CustomerNumber"},{"name":"mDataProp_1","value":"FirstName"},{"name":"mDataProp_2","value":"FamilyName"},{"name":"mDataProp_3","value":"MobileNumber"},{"name":"mDataProp_4","value":"CustomerIdNumber"},{"name":"mDataProp_5","value":"CustomerIdType"},{"name":"mDataProp_6","value":"DateOfBirth"},{"name":"sSearch","value":""},{"name":"bRegex","value":false},{"name":"sSearch_0","value":""},{"name":"bRegex_0","value":false},{"name":"bSearchable_0","value":true},{"name":"sSearch_1","value":""},{"name":"bRegex_1","value":false},{"name":"bSearchable_1","value":true},{"name":"sSearch_2","value":""},{"name":"bRegex_2","value":false},{"name":"bSearchable_2","value":true},{"name":"sSearch_3","value":""},{"name":"bRegex_3","value":false},{"name":"bSearchable_3","value":true},{"name":"sSearch_4","value":""},{"name":"bRegex_4","value":false},{"name":"bSearchable_4","value":true},{"name":"sSearch_5","value":""},{"name":"bRegex_5","value":false},{"name":"bSearchable_5","value":false},{"name":"sSearch_6","value":""},{"name":"bRegex_6","value":false},{"name":"bSearchable_6","value":false},{"name":"iSortCol_0","value":0},{"name":"sSortDir_0","value":"asc"},{"name":"iSortingCols","value":1},{"name":"bSortable_0","value":true},{"name":"bSortable_1","value":true},{"name":"bSortable_2","value":true},{"name":"bSortable_3","value":true},{"name":"bSortable_4","value":true},{"name":"bSortable_5","value":false},{"name":"bSortable_6","value":false}]}" 
```

这给出了错误：

```
There was an error deserializing the object of type System.String. The token 'null' was expected but found 'name'. 
```

我尝试了各种构建方式，`data: '"{ jsonAOData : ' + jsonAOData + '}"',`但还没有找到任何有效的组合。

我已经浏览了很多关于 SO 的东西，但还没有找到解决方案。

**注意：**
如果我发送：

```
data: '{ "jsonAOData" : "' + 'BOBBLE' + '"}', 
```

然后我得到了错误：

```
There was an error deserializing the object of type System.String. End element 'root' from namespace '' expected. Found element 'jsonAOData' from namespace ''. 
```

TBH：我不知道这意味着什么！这是一个字符串，而不是 XML，所以它为什么要寻找“根”——此外，我想要 jsonAOData，不是吗？

**注意**
如果我用相同的调用（只是不同的 URI）调用我的 MVC3 控制器，那么它会按预期工作并且我的 jsonAOData 字符串是否正确传递？

代码

* * *

```
[ServiceContract]
public interface ICustomerService
{
    [OperationContract]
    [WebInvoke(Method="POST",
        BodyStyle= WebMessageBodyStyle.Bare, 
        RequestFormat=WebMessageFormat.Json, 
        ResponseFormat=WebMessageFormat.Json,
        UriTemplate = "GetCustomerDataTable")]
    string GetCustomerDataTable(string jsonAOData);
} 
```

-

```
public string GetCustomerDataTable(string jsonAOData)
{
    var log = LogManager.GetLogger
    //Code omitted for brevity...

    var result = serializer.Serialize(jsonDataTable);
    return result;
} 
```

-

```
 $(document).ready(function () {
        jQuery.support.cors = true; // cross site
        var dt = $('#dataTable').dataTable({
            "bProcessing": true,
            "bSort": true,
            "bServerSide": true,
            //"sAjaxSource": "JsonSearch", //Call to MVC controller...works as expected
            "sAjaxSource": "http://localhost:51900/CustomerService.svc/json/GetCustomerDataTable",
            "sServerMethod": "POST",
            "fnServerData": function (sSource, aoData, fnCallback) {
                var jsonAOData = JSON.stringify(aoData);
                //alert(jsonAOData);
                $.ajax({
                    dataType: 'json',
                    crossDomain: true,
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    url: sSource,
                    data: '"{ jsonAOData : ' + jsonAOData + '}"', //I have tried many combinations of this!
                    dataType: "json",
                    success: function (data) {
                        //alert('success');
                        fnCallback($.parseJSON(data));
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert("Status: " + XMLHttpRequest.status + "\r\n" + textStatus + "\r\n" + errorThrown);
                    }
                });
            },
            "aoColumnDefs": [
                        { "aTargets": [0], "sTitle": "Customer Number", "mData": "CustomerNumber", "bSearchable": true, "bSortable": true },
                        { "aTargets": [1], "sTitle": "First Name", "mData": "FirstName", "bSearchable": true, "bSortable": true },
                        { "aTargets": [2], "sTitle": "Family Name", "mData": "FamilyName", "bSearchable": true, "bSortable": true },
                        { "aTargets": [3], "sTitle": "Mobile Number", "mData": "MobileNumber", "bSearchable": true, "bSortable": true },
                        { "aTargets": [4], "sTitle": "Customer Id", "mData": "CustomerIdNumber", "bSearchable": true, "bSortable": true },
                        { "aTargets": [5], "sTitle": "Id Type", "mData": "CustomerIdType", "bSearchable": false, "bSortable": false },
                        { "aTargets": [6], "sTitle": "Date Of Birth", "mData": "DateOfBirth", "bSearchable": false, "bSortable": false },
                ],
            "sScrollY": "500",
            "bScrollCollapse": true
        });

        dt.fnSetFilteringDelay(1000);

    }); 
```

-

```
<system.serviceModel>
  <bindings>
    <webHttpBinding>
      <binding name="jsonCustomerServiceBinding" maxBufferSize="26214400"
        maxReceivedMessageSize="26214400" />
    </webHttpBinding>
  </bindings>
  <services>
    <service name="Ibq.WcfService.CustomerService">
      <endpoint address="json" behaviorConfiguration="json" binding="webHttpBinding"
        bindingConfiguration="jsonCustomerServiceBinding" name="jsonCustomerService"
        contract="Ibq.WcfService.ICustomerService" kind="webHttpEndpoint"
        endpointConfiguration="" />
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:51900/" />
        </baseAddresses>
      </host>
    </service>
  </services>
  <behaviors>
    <endpointBehaviors>
      <behavior name="json">
        <webHttp helpEnabled="true" defaultOutgoingResponseFormat="Json"
          faultExceptionEnabled="false"/>
      </behavior>
    </endpointBehaviors>
    <serviceBehaviors>
      <behavior name="">
        <serviceMetadata httpGetEnabled="true" />
        <serviceDebug includeExceptionDetailInFaults="false" />
        <dataContractSerializer maxItemsInObjectGraph="2147483647" />
      </behavior>
    </serviceBehaviors>
  </behaviors>
  <serviceHostingEnvironment multipleSiteBindingsEnabled="false" />
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:32:14.240

通过大量谷歌搜索解决了它：

将我的服务修改为

`string GetCustomerDataTable(List<NameValuePair<string, string>> jsonAOData);`

ajax 调用现在是：

```
"fnServerData": function (sSource, aoData, fnCallback) {
                var jsonAOData = JSON.stringify(aoData);
                //alert(aoData.toString());
                $.ajax({
                    dataType: 'json',
                    crossDomain: true,
                    contentType: "application/json; charset=utf-8",
                    type: "POST",
                    url: sSource,
                    **data: jsonAOData,**
                    dataType: "json",
                    success: function (data) {
                        //alert('success');
                        fnCallback($.parseJSON(data));
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert("Status: " + XMLHttpRequest.status + "\r\n" + textStatus + "\r\n" + errorThrown);
                    }
                }); 
```

并添加了一个 DataContract

```
[DataContract]
    public class NameValuePair<TName, TValue>
    {
        [DataMember(Name="name")]
        public TName Name { get; set; }

        [DataMember(Name = "value")]
        public TValue Value { get; set; }

        public NameValuePair(TName name, TValue value)
        {
            Name = name;
            Value = value;
        }

        public NameValuePair() { }
    } 
```

这现在序列化为一个 NameValue 对列表......但这正是我需要的 DataTables :)

# android - 如何在 LinearLayout 中获取 ImageView 的坐标和大小

> ID：13357804
> 
> 赞同：2
> 
> 时间：2012-11-13T08:51:30.577
> 
> 标签：android, android-layout, android-canvas

当我点击按钮时，调用drawDigit()，puzzleview只是Activity中的一个LinearLayout

```
protected void drawDigit(Canvas canvas, int digit) {
        // TODO Auto-generated method stub
        if(num < diff){
            int x = tiles.get(num).getScrollX();  // get the X coordinate of ImageView，it's 0
            int y = tiles.get(num).getScrollY();  // get the Y coordinate of ImageView，it's 0
            float height = tiles.get(num).getHeight(); // height is 0
            float width = tiles.get(num).getWidth();   // width is 0
            background.setTextSize(height * 0.75f);
            background.setStyle(Style.FILL);
            background.setTextScaleX(width/height);
            background.setTextAlign(Paint.Align.CENTER);
            canvas.drawText(digit + "", x, y, background);
            //num++;
        }
    } 
```

如何将`ImageView`布局分配给瓷砖，然后获取坐标和大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:26:25.963

你可以试试这个：

**//这是为了获取布局中固定的ImageView大小**

```
int imageHeight;
int imageWidth;

ImageView imageViewObj = (ImageView)findViewById(R.id.image_view_id);
ViewTreeObserver treeObsObj = imageViewObj.getViewTreeObserver();
treeObsObj.addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {

    public boolean onPreDraw() {
    imageWidth= imageViewObj.getMeasuredWidth();
    imageHeight = imageViewObj.getMeasuredHeight();
    return true;
}
}); 
```

**// 获取 ImageView 中图像的大小，并且大小将根据
您放置在 ImageView 中的图像而有所不同 **//**

```
ImageView imageObj = (ImageView)findViewById(R.id.image_view_id);
int imageWidth = imageObj.getWidth();
int imageHeight = imageObj.getHeight(); 
```

# jena - 问题得到一个类的限制

> ID：13357810
> 
> 赞同：2
> 
> 时间：2012-11-13T08:51:41.097
> 
> 标签：jena

我有一个使用 Protégé 3.4 设计的简单本体。我已经介绍了一些“必要且充分”的条件，比如在 Table 类的定义中：

[http://postimage.org/image/f37xliqad/](http://postimage.org/image/f37xliqad/)

忘记第一个条件，第三个更容易理解:)

生成的OWL代码是：

```
<?xml version="1.0"?>
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:protege="http://protege.stanford.edu/plugins/owl/protege#"
    xmlns:xsp="http://www.owl-ontologies.com/2005/08/07/xsp.owl#"
    xmlns:assert="http://www.owl-ontologies.com/assert.owl#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:sqwrl="http://sqwrl.stanford.edu/ontologies/built-ins/3.4/sqwrl.owl#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:swrl="http://www.w3.org/2003/11/swrl#"
    xmlns:swrlb="http://www.w3.org/2003/11/swrlb#"
    xmlns="http://www.owl-ontologies.com/Ontology1317586695.owl#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:swrla="http://swrl.stanford.edu/ontologies/3.3/swrla.owl#"
  xml:base="http://www.owl-ontologies.com/Ontology1317586695.owl">
  <owl:Ontology rdf:about="">
    <owl:imports rdf:resource="http://swrl.stanford.edu/ontologies/3.3/swrla.owl"/>
    <owl:imports rdf:resource="http://sqwrl.stanford.edu/ontologies/built-ins/3.4/sqwrl.owl"/>
  </owl:Ontology> 
```

...

```
 <owl:Class rdf:ID="Table">
    <owl:disjointWith>
      <owl:Class rdf:ID="Chair"/>
    </owl:disjointWith>
    <owl:equivalentClass>
      <owl:Class>
        <owl:intersectionOf rdf:parseType="Resource">
          <rdf:first>
            <owl:Restriction>
              <owl:onProperty>
                <owl:ObjectProperty rdf:ID="has_coarseArea"/>
              </owl:onProperty>
              <owl:someValuesFrom>
                <owl:Class>
                  <owl:unionOf rdf:parseType="Collection">
                    <owl:Class rdf:about="#MMAround09"/>
                    <owl:Class rdf:about="#MMAround1"/>
                    <owl:Class rdf:about="#MMAround12"/>
                    <owl:Class rdf:about="#MMAround15"/>
                    <owl:Class rdf:about="#MMAround2"/>
                  </owl:unionOf>
                </owl:Class>
              </owl:someValuesFrom>
            </owl:Restriction>
          </rdf:first>
          <rdf:rest rdf:parseType="Resource">
            <rdf:first>
              <owl:Restriction>
                <owl:someValuesFrom>
                  <owl:Class>
                    <owl:unionOf rdf:parseType="Collection">
                      <owl:Class rdf:about="#MMAround07"/>
                      <owl:Class rdf:about="#MMAround08"/>
                    </owl:unionOf>
                  </owl:Class>
                </owl:someValuesFrom>
                <owl:onProperty>
                  <owl:ObjectProperty rdf:ID="has_coarseCentroidHeight"/>
                </owl:onProperty>
              </owl:Restriction>
            </rdf:first>
            <rdf:rest>
              <rdf:List>
                <rdf:first>
                  <owl:Restriction>
                    <owl:someValuesFrom>
                      <owl:Class rdf:about="#Horizontal"/>
                    </owl:someValuesFrom>
                    <owl:onProperty>
                      <owl:ObjectProperty rdf:about="#has_orientation"/>
                    </owl:onProperty>
                  </owl:Restriction>
                </rdf:first>
                <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
              </rdf:List>
            </rdf:rest>
          </rdf:rest>
        </owl:intersectionOf>
      </owl:Class>
    </owl:equivalentClass>
    <rdfs:subClassOf>
      <owl:Class rdf:ID="Furniture"/>
    </rdfs:subClassOf>
  </owl:Class> 
```

如果我理解得很好，这些条件被解释为限制，并作为 Table 类的超类进行管理。

所以，如果我用 Jena 加载我的本体和类表：

```
1\. String NS = "http://www.owl-ontologies.com/Ontology1317586695.owl#";
2\. OntModel model = ModelFactory.createOntologyModel(PelletReasonerFactory.THE_SPEC);
3\. model.read(OWL_FILE_NAME);
4\. OntClass Table = model.getOntClass( NS + "Table" ); 
```

NS 变量具有正确的值，因为表 OntClass 已正确加载。然后，在执行以下代码时，应该到达第 10 行，但不是：

```
5\. for (Iterator<OntClass> supers = Table.listSuperClasses(true); supers.hasNext(); ) {
6\.            OntClass  superClass = supers.next();
7\.           
8\.            if (superClass.isRestriction())
9\.            {
10\.               System.out.println("Restriction found");
11\.            }
12\. } 
```

我也试过 Table.listEquivalentClasses() 没有成功。

知道我在路上失去了什么吗？

**更新**

测试由 Ian 很好地实现并在此处共享的代码：[https](https://gist.github.com/4065533) ://gist.github.com/4065533 ，它工作正常。但改变

```
OntModel m = ModelFactory.createOntologyModel( OntModelSpec.OWL_MEM_MICRO_RULE_INF ); 
```

经过

```
OntModel m = ModelFactory.createOntologyModel( PelletReasonerFactory.THE_SPEC ); 
```

它停止工作。似乎 Pellet 不承认这些限制是该类的超类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:11:33.240

此类问题的最常见原因是 URI 不完全*匹配*。如果您已经包含了实际数据的片段，如 Turtle 或 RDF XML，并且您已经说明了值`NS`是什么，那么可以明确地排除或排除。

一般来说，发布编辑工具用户界面的屏幕截图对于想要帮助您的人来说几乎没有发布源代码本身有用。

**更新**

好吧，它对我有用。我已将我的（提示：可运行）代码放在 gist[`https://gist.github.com/4065533`](https://gist.github.com/4065533)中。我可以发现我的代码和你的代码之间的唯一区别是`OWL_FILE_NAME`var （大概你已经检查过你正在加载正确的输入源？），以及我目前没有可用的 Pellet 的使用。您可以通过切换到 Jena 规则推理器来检查问题的根源不是 Pellet，但我强烈怀疑 Pellet 是否会成为一个因素。

请尝试我的要点代码，看看是否有助于阐明问题。如果您仍然无法让您的代码正常工作，请发布一个可运行的最小测试用例。它应该是可运行的，无需猜测或填写任何缺失的信息。

# javascript - 在加载时显示默认页面

> ID：13357816
> 
> 赞同：0
> 
> 时间：2012-11-13T08:52:32.513
> 
> 标签：javascript, jquery

在我的代码中，我想在页面上显示第一个链接的默认内容。下面是我的代码，当我点击某个链接时，它会加载它的内容，而不是我想在页面加载时显示第一个链接内容，在用户点击任何链接后，内容必须得到改变

```
<!DOCTYPE html>
<html> 
<head>
   <script src="jquery.js" type="text/javascript"></script>
</head>

<body>
<div id="nav">
    <a href="" id="#content1">Show content 1</a>
    <a href="" id="#content2">Show content 2</a>
    <a href="" id="#content3">Show content 3</a>
</div>

<div id="contents" style="width: 200px; height: 40px; border: dotted; margin-top: 20px;">
<div id="content1" class="toggle" style="display:none">show the stuff1</div> 
<div id="content2" class="toggle" style="display:none">show the stuff2</div>
<div id="content3" class="toggle" style="display:none">show the stuff3</div>
</div>
 <script>
     $("#nav a").click(function(e){
     e.preventDefault();
     $(".toggle").hide();
     var toShow = $(this).attr('id');
     $(toShow).show();
     });
 </script>
 </body>
 </html> 
```

下面是 JSFiddle 链接

[http://jsfiddle.net/vP3Wj/](http://jsfiddle.net/vP3Wj/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:55:40.183

```
<!DOCTYPE html>
<html> 
<head>
   <script src="jquery.js" type="text/javascript"></script>
</head>

<body>
<div id="nav">
    <a href="" id="content1">Show content 1</a>
    <a href="" id="content2">Show content 2</a>
    <a href="" id="content3">Show content 3</a>
</div>

<div id="contents" style="width: 200px; height: 40px; border: dotted; margin-top: 20px;">
<div id="content1" class="toggle" style="">show the stuff1</div> 
<div id="content2" class="toggle" style="display:none">show the stuff2</div>
<div id="content3" class="toggle" style="display:none">show the stuff3</div>
</div>
 <script>
     $("#nav a").click(function(e){
     e.preventDefault();
     $(".toggle").hide();
     var toShow = $(this).attr('id');
     $('#'+toShow).show();
     });
 </script>
 </body>
 </html> 
```

这样，您可以通过在您想要的内容上省略 display:none 来在页面加载时打开一个 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T08:57:22.527

只需为您的默认内容添加另一个 div，但不会像其他 div 那样默认隐藏，所以像这样：

```
<div id="contents" style="width: 200px; height: 40px; border: dotted; margin-top: 20px;">
<div id="defaultcontent" class="toggle">Default Content</div> <!-- HERE -->
<div id="content1" class="toggle" style="display:none">show the stuff1</div> 
... 
```

查看工作[**示例**](http://jsfiddle.net/vP3Wj/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:55:24.093

`#content1`不是有效的身份证件。尝试改用 href 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T08:59:18.403

我会稍微更改您的标记，我不确定 # 在有效的 ID 值中，您可以将它用作链接上的哈希/锚点：

[http://jsfiddle.net/vP3Wj/2/](http://jsfiddle.net/vP3Wj/2/)

当页面加载时，每个块都是隐藏的，我们找到所有的 a 元素并在它们上绑定一个点击事件。之后我们过滤掉第一个并用jquery触发它的点击事件。

html: 显示内容 1 显示内容 2 显示内容 3

```
<div id="contents">
    <div id="content1" class="toggle">show the stuff1</div>
    <div id="content2" class="toggle">show the stuff2</div>
    <div id="content3" class="toggle">show the stuff3</div>
</div> 
```

和javascript：

```
$("#nav a").click(function(e){
    e.preventDefault();
    $(".toggle").hide();
    var toShow = $(this).attr("href");
    $(toShow).show();
}).filter(":first").click(); 
```

# mysql - Mysql用正则表达式替换论坛报价标签的查询

> ID：13357819
> 
> 赞同：2
> 
> 时间：2012-11-13T08:52:45.380
> 
> 标签：mysql, regex

我正在寻找一种运行查询的方法，它只替换“[QUOTE=XXX]”标签中的短语。

*例如：*

> [QUOTE=**用户彼得**]你好。此文本不应受到影响。[/QUOTE]
> 
> [QUOTE=**主持人约翰**]你好。此文本不应受到影响。[/QUOTE]

我想使用 mysql 查询删除短语**用户**和**版主。**

但是，以下内容也不应受到影响：

> [QUOTE=Tom]主持人约翰你好。[/QUOTE]

这是我当前的查询：

```
UPDATE post SET pagetext = REPLACE(REPLACE(pagetext, 'User', '') , 'Moderator', '') WHERE pagetext REGEXP '\\[QUOTE=*\\]'; 
```

我需要一些关于正则表达式部分的帮助。

我希望你们明白我在这里想要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:56:41.273

试试看这是否有效；

`UPDATE post SET pagetext = REPLACE(REPLACE(pagetext, 'User', '') , 'Moderator', '') WHERE pagetext LIKE '%[QUOTE=%';`

# php - 单击按钮时显示数据库的不同行

> ID：13357821
> 
> 赞同：4
> 
> 时间：2012-11-13T08:52:57.813
> 
> 标签：php, mysql

我有一个包含以下字段的清真寺数据库：mosque_id、mosque_name、prefecture、address、postal_code、website、email1、phone1。我要做的是在表单中显示第一个清真寺（mosque_id=1）的信息，当我点击“下一步”时，将显示第二个清真寺（mosque_id=2）的信息。

到目前为止，我已经能够使用 mosque_id 来选择一整行并显示信息，但我一直在努力寻找一种方法来切换到下一个。我对 PHP 和 MYSQL 很陌生，任何帮助将不胜感激。

```
<?
$mosque_id = 1;
$result = mysql_query("SELECT * FROM Mosque WHERE mosque_id='$mosque_id'");
$row = mysql_fetch_assoc($result);
?>

<form action="insert.php" method="post">
Mosque Name: <?php print('<input type="text" name="firstname" value="' . $row['mosque_name'] . '"/><br>')?>
Prefecture: <?php print('<input type="text" name="firstname" value="' . $row['prefecture'] . '"/><br>')?>
Address: <?php print('<input type="text" value="' . $row['address'] . '"/><br>')?>
Postal Code: <?php print('<input type="text" value="' . $row['postal_code'] . '"/><br>')?>
Website: <?php print('<input type="text" value="' . $row['website'] . '"/><br>')?>
Email 1: <?php print('<input type="text" value="' . $row['email1'] . '"/><br>')?>
Contact number 1: <?php print('<input type="text" value="' . $row['phone1'] . '"/><br>')?>

<input type="button" value="Next Mosque" onclick=""/>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T09:08:45.700

```
 <?php
$mosque_id = (isset($_GET['mosque_id']) ? intval($_GET['mosque_id']) : 1); // suppose you know that '1' is the first id in your table
$result = mysql_query("SELECT * FROM Mosque WHERE mosque_id>='$mosque_id' limit 2");
$row = mysql_fetch_assoc($result); // this is the row you're gonna display in the form
$row2 = mysql_fetch_assoc($result); // this will tell us about the next row
?>
<form action="insert.php" method="post">
Mosque Name: <?php print('<input type="text" name="firstname" value="' . $row['mosque_name'] . '"/><br>')?>
Prefecture: <?php print('<input type="text" name="firstname" value="' . $row['prefecture'] . '"/><br>')?>
Address: <?php print('<input type="text" value="' . $row['address'] . '"/><br>')?>
Postal Code: <?php print('<input type="text" value="' . $row['postal_code'] . '"/><br>')?>
Website: <?php print('<input type="text" value="' . $row['website'] . '"/><br>')?>
Email 1: <?php print('<input type="text" value="' . $row['email1'] . '"/><br>')?>
Contact number 1: <?php print('<input type="text" value="' . $row['phone1'] . '"/><br>')?>

<input type="button" value="Next Mosque" onclick="window.location = 'path-to-your-page?mosque_id=<?php echo $row2['mosque_id'];"/>
</form> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:58:35.760

第一：请使用 mysqli 函数或 PDO 类，而不是 mysql 函数，它们已被弃用。

其次：使用长PHP标签

但你在正确的轨道上：

将您的第一行替换为：

```
$mosque_id = (isset($_GET['mosque_id']) ? intval($_GET['mosque_id']) : 1); 
```

最后

```
<input type="button" value="Next Mosque" onclick="javascript: document.location = '?mosque_id=<?php echo ($mosque_id + 1);?>"/> 
```

您还需要在查询后编写一些检查，如果这样的 id 存在，实际上，如果您进一步开发，您还需要检查下一个 mosque_id，因为如果您删除一些行，id-s 可能不是像 1 那样的正确顺序， 2、3、4 但 1、3、7、9（提示：对于下一个 id，在 MySQL 中使用 WHERE mosque_id > current_id ORDER BY mosque_id DESC LIMIT 1）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T08:58:41.480

只需有一个隐藏的输入来保存 ID，并在页面加载时增加它。然后，当您提交时，ID 也将被提交。

```
<?
if (isset($_POST['id']) {
   $id = $_POST['id'];
}
else {
    $id = 1;
}

$result = mysql_query("SELECT * FROM Mosque WHERE mosque_id='$id'");
...
?>

<form action="insert.php" method="post">
...

<input type='hidden' name='id' value='<?php echo $mosque_id++; ?> />
<input value="Next Mosque" />
</form> 
```

顺便说一句，使用[PDO](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)。它非常容易学习，并为您的应用程序增加了高度的安全性。

# asp.net - 从页面导航时，当页面加载错误时，signalR 中断

> ID：13357825
> 
> 赞同：6
> 
> 时间：2012-11-13T08:53:25.503
> 
> 标签：asp.net, asp.net-mvc, signalr, signalr-hub, signalr.client

当导航离开具有 signalR 连接/连接集线器的页面时，我收到以下错误消息。

> **连接到**“http://localhost:53604/signalr/signalr/connect?transport=serverSentEvents&connectionId=0b308c0d-2122-4e60-a9fa-f6e3f3eb1f4e&connectionData=%5B%7B%22name%22%3A%22packageactionstatus%20%22%7D %5D&tid=9"**在页面加载时被中断**。

我确实了解由于离开页面而导致连接丢失（这很好），但是在离开当前页面之前是否有安全的方法来停止连接？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T08:56:04.170

您可以在卸载时关闭连接：

```
$.connection.hub.stop(); 
```

虽然我不确定你为什么关心这个错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-08T23:47:43.393

要正确执行此操作，您需要捕获**onbeforeunload**事件，并且您希望这样做：

```
window.onbeforeunload = function () {
    $.connection.hub.stop();
}; 
```

用 Firefox 为我解决了这个问题。

# sql - 索引字段无济于事：如何提高查询时间

> ID：13357826
> 
> 赞同：-3
> 
> 时间：2012-11-13T08:53:28.233
> 
> 标签：sql, sql-server

如果我检查 [deliverybody] 字段是否包含“x”，则第一个/未缓存的查询需要很长时间，以消除带有“x”的行。如果我不检查“x”，[deliverytime] 会被索引并在一秒钟内完成查询。

使用*AND [deliverybody] <> 'x'*部分，查询执行时间为 10+ 秒，没有；1秒。似乎索引字段 [deliverytime] 不会有太大帮助。

查询只返回 1600 行。扫描额外的 1600 个字段需要 10 多秒。查询有什么问题？

**更新：**从 NTEXT 升级到 NVARCHAR(MAX)。内部查询的执行计划：

*   SLOW 保存的执行计划：http: [//pastebin.com/7X7uf6iV](http://pastebin.com/7X7uf6iV)

此查询需要 10 多秒：

```
 SELECT MAX([deliveryid]) AS deliveryid, COUNT(*) AS cnt  
  FROM [_hMaiServer].[dbo].[hm_deliverylog]
  WHERE [deliverytime] > DATEADD(HOUR, -24, GETDATE()) 
  AND [deliverybody] <> 'x' 
  GROUP BY deliverysubject 
```

*   保存的 FAST 执行计划：http: [//pastebin.com/EEnPGf4X](http://pastebin.com/EEnPGf4X)

查询在一秒钟内完成：

```
SELECT MAX([deliveryid]) AS deliveryid, COUNT(*) AS cnt  
FROM [_hMaiServer].[dbo].[hm_deliverylog]
WHERE [deliverytime] > DATEADD(HOUR, -2400, GETDATE()) 
--AND [deliverybody] <> 'x' 
GROUP BY deliverysubject 
```

以及带有索引的表结构：http: [//pastebin.com/W0PsDnqS](http://pastebin.com/W0PsDnqS)

**我的结论：**

检查 5000 行需要 10 多秒。较小的**{HOUR}**值使执行时间更快。如果这没问题，这没问题，但对我来说似乎很慢。

```
SELECT COUNT(*) FROM [hm_deliverylog]
WHERE [deliverybody] <> 'x' 
AND [deliverytime] > DATEADD(HOUR, -__{HOUR}__ , GETDATE()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T21:41:00.397

您尚未提供要求的`SET STATISTICS IO ON;`结果。

然而，一种可能的改进可能是而不是使用

```
WHERE [deliverybody] <> 'x' 
```

使用

```
WHERE NOT (LEN([deliverybody]) = 1 AND LEFT([deliverybody],1) = 'X') 
```

下面是一个有益的示例。

```
CREATE TABLE T1
  (
     Id             INT,
     [deliverybody] VARCHAR(MAX)
  )

INSERT INTO T1
VALUES     (1, Replicate(Cast('A' AS VARCHAR(MAX)), 2000000000)),
           (2,'X')

SET STATISTICS IO ON;

SELECT id
FROM   T1
WHERE  NOT ( Len([deliverybody]) = 1
             AND LEFT([deliverybody], 1) = 'X' )

SELECT id
FROM   T1
WHERE  [deliverybody] <> 'X'

DROP TABLE T1 
```

两者的 IO 结果如下

```
Table 'T1'. Scan count 1, logical reads 1, physical reads 0, read-ahead reads 0
            , lob logical reads 6, lob physical reads 0, lob read-ahead reads 0. 
```

* * *

```
Table 'T1'. Scan count 1, logical reads 1, physical reads 0, read-ahead reads 0
    lob logical reads 2209665, lob physical reads 0, lob read-ahead reads 642255. 
```

第一个读取次数明显减少，因为它避免拖出整个 2GB 值以发现它不是`X`

# shell - 什么是 .shar 文件？

> ID：13357829
> 
> 赞同：5
> 
> 时间：2012-11-13T08:53:37.420
> 
> 标签：shell, unix, makefile, archive

阅读 make 的手册页：

> `shar' 创建源文件的 shell 存档（shar 文件）。

什么是共享？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:17:47.173

它是一个 shell 存档，一个自解压的可执行 shell 脚本，旨在提供一种方便的方式来传送文件存档并通过运行脚本让它们出现。

下面的文字记录中显示了一个示例，该示例仅提供存档中的一个文件`output.txt`：

```
pax> cat shar.bash 
#!/bin/bash
tr '[A-Za-z]' '[N-ZA-Mn-za-m]' >output.txt <<EOF
    Uryyb sebz Cnk.
EOF

pax> ./shar.bash 
pax> cat output.txt 
    Hello from Pax. 
```

这是一个相当简单的文件，因为它只提供一个文件，并且根本不压缩它，但它应该给你一个大致的想法。

一个真实的可能会给你一些类似于 tar、gzip 和 uuencode 组合的文件，然后通过 uudecode、gunzip 和 tar 传递原始内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T08:55:57.333

自解压存档：提取其中包含的一些数据的 shell 脚本。

维基百科有更多：[http ://en.wikipedia.org/wiki/Shar](http://en.wikipedia.org/wiki/Shar)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:55:19.117

[它是一种自解压档案](http://en.wikipedia.org/wiki/Shar)。

这有点危险（就像 Windows 上的自解压 .exe），因为它会自行运行以解压自己，因此它可能会执行您未预料到的各种其他事情。

我认为这就是 Oracle 用来在 Linux 上分发 JVM 的方法（让您首先点击许可协议）。

通常，人们只会使用 tar 存档（不能执行任意代码，也不会显示任何对话框）。

# c++ - 在 C++ 中编译复数类时出错

> ID：13357834
> 
> 赞同：0
> 
> 时间：2012-11-13T08:54:11.477
> 
> 标签：c++, compiler-errors, complex-numbers

我的代码应该显示复数的加法、减法等，而无需用户输入。我有三个类：test.cpp、complex.cpp 和 complex.h 来运行程序，定义构造函数和方法，并分别创建一个头类。然而，当我运行我的代码时，我得到了一系列我一直试图弄清楚的错误。

复杂的.h

```
//complex class definition
#ifndef COMPLEX_H
#define COMPLEX_H

//class complex
class Complex
{
public:
    Complex(); //default no arg constructor
    Complex(double a); //one arg constructor
    Complex(double a, double b); //two arg constructor
    Complex operator+(const Complex &) const; //addition method
    Complex operator-(const Complex &) const; //subtraction method
    Complex operator*(const Complex &) const; //multiplication method
    Complex operator/(const Complex &) const; //division method
    void print() const; //output
private:
    double a; //real number
    double b; //imaginary number
}; //end class Complex

#endif 
```

复杂的.cpp

```
#include "stdafx.h"
#include <iostream>
#include "complex.h"
using namespace std;

//no arg constructor
Complex::Complex()
{
    a = 0;
    b = 0;
}

//one arg instructor
Complex::Complex(double real)
{
    a = real;
    b = 0;
}

//two arg constructor
Complex::Complex(double real, double imaginary)
{
    a = real;
    b = imaginary;
}

//addition
Complex Complex::operator+(const Complex &number2) const
{
    return a + number2.a, b + number2.b;
}

//subtraction
Complex Complex::operator-(const Complex &number2) const
{
    return a - number2.a, b - number2.b;
}

//multiplication
Complex Complex::operator*(const Complex &number2) const
{
    return a * number2.a, b * number2.b;
}

//division
Complex Complex::operator/(const Complex &number2) const
{
    return a / number2.a, b / number2.b;
}

//output display for complex number
void Complex::print() const
{
    cout << '(' << a << ", " << b << ')';
} 
```

测试.cpp

```
#include <iostream>
#include <complex>
#include "complex.h"
#include "stdafx.h"
using namespace std;

int main()
{
    Complex b(1.0, 0.0);
    Complex c(3.0, -1.0);

    /*cout << "a: ";
    a.print();

    system ("PAUSE");*/

}; 
```

现在在测试中，因为代码显示下部已被注释掉，我试图只调用三个构造函数中的两个，看看我是否能让其中任何一个工作。

我收到的错误：

```
 error C2065: 'Complex' : undeclared identifier
    error C2065: 'Complex' : undeclared identifier
    error C2146: syntax error : missing ';' before identifier 'b'
    error C2146: syntax error : missing ';' before identifier 'c'
    error C3861: 'b': identifier not found  
    error C3861: 'c': identifier not found 
```

我正在尝试在 Visual Studio 2010 中运行它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T10:19:44.327

我认为问题出在您的 Complex.cpp 中。如果编译类的代码有错误，则该类是未知的，因此标识符 Complex 也是如此。

快速查看后，一切似乎都是正确的，但您的操作员功能有一些错误：

不正确：

```
 //addition
    Complex Complex::operator+(const Complex &number2) const
    {
        return a + number2.a, b + number2.b;
    } 
```

正确的：

```
 //addition
    Complex Complex::operator+(const Complex &number2) const
    {          
        return Complex(a + number2.a, b + number2.b);
    } 
```

问题是您的运算符方法的返回类型。它们必须与声明的相同。您也不能同时返回两个变量。如果你想这样做，你必须使用[结构](http://www.cplusplus.com/doc/tutorial/structures/)或类（通过使用新值调用你的类 Complex 的构造函数）。

如果要操作成员 a 和 b，则不能将方法定义为“const”。如果你说一个函数是 const，这意味着所有类成员的值都不会通过调用这个方法来操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:07:53.727

您可能会遇到 stdafx.h 问题

至少您应该尝试`#include "stdafx.h`在所有其他包含之前放置或者您可以尝试将您的项目属性设置为不使用 stdafx.h

```
1\. right click on project and select Properties
2\. go to C/C++ -> Precompiled Headers 
3\. select "Not Using Precompiled Headers" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T10:35:58.590

```
#include <complex>
#include "complex.h" 
```

那是难闻的气味。这两个#include 文件可能对标头保护使用相同的名称。

试着像这样改变你的。

```
#ifndef MY_COMPLEX_H
#define MY_COMPLEX_H 
```

.. 并且可能将您的模块从“复杂”重命名为其他名称，以避免与同名的系统头文件发生冲突。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T09:45:09.440

尝试使其尽可能简单。然后重新添加零件，直到找到错误为止。

这行得通吗？

```
#include "complex.h"

int main()
{
    Complex c(3.0, -1.0);

    return 0;
}; 
```

# android - 列表视图上的媒体播放器问题

> ID：13357835
> 
> 赞同：1
> 
> 时间：2012-11-13T08:54:12.840
> 
> 标签：android, android-listview, android-mediaplayer

我想在单击按钮时播放声音，我有不同的声音，我用 listview 列出声音，当我在 listview 上选择项目时，singlelistitem 打开布局，我单击 singlelistitem 布局上的按钮，但是当我单击时应用程序正在关闭，不能用，请问问题出在哪里，谢谢

AndroidListViewActivity.class（用于列表和选择项）

SingleListItem.class(显示选中项)

按钮单击（在 SingleListItem 布局上，播放选定的声音）

日志信息：

```
11-11 16:18:09.285: E/dalvikvm(17161): VM aborting
11-11 16:18:09.285: A/libc(17161): Fatal signal 11 (SIGSEGV) at 0xdeadd00d (code=1) 
```

AndroidListViewActivity 类；

```
public class AndroidListViewActivity extends ListActivity {
    int [] sounds;
 MediaPlayer mediaPlayer;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
sounds= new int[] {R.raw.sound1,R.raw.sound2,R.raw.sound3,R.raw.sound4,R.raw.sound5};        

    // storing string resources into Array
    String[] sounds= getResources().getStringArray(R.array.sounds);        
    // Binding Array to ListAdapter
    this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.label,   sounds));

    ListView lv = getListView();

    // listening to single list item on click
    lv.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View view,
          int position, long id) {     

          // selected item 
          String selectedsound= ((TextView) view).getText().toString();
          String selectedFromList = getItemAtPosition(position);

            @SuppressWarnings("unused")
            int resId = getResources().getIdentifier(selectedFromList, "raw", getPackageName());

  // Launching new Activity on selecting single List Item
          Intent i = new Intent(getApplicationContext(), SingleListItem.class);
          Intent intent = new Intent(getApplicationContext(), SingleListItem.class);
          // sending data to new activity
          i.putExtra("selectedsound", selectedsound);
          intent.putExtra("position", position);
          startActivity(i);
          startActivity(intent);            
      }

    private String getItemAtPosition(int position) {
        // TODO Auto-generated method stub
        return null;
    }
    });
}
} 
```

SingleListItem 类；

```
public class SingleListItem extends Activity{

 int [] sounds;
 MediaPlayer mediaPlayer;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    sounds= new int[]   {R.raw.sound1,R.raw.sound2,R.raw.sound3,R.raw.sound4,R.raw.sound5};

           this.setContentView(R.layout.single_list_item_view);

    TextView txtProduct = (TextView) findViewById(R.id.product_label);

    Intent i = getIntent();

    Intent intent = getIntent();

    // getting attached intent data
    String product = i.getStringExtra("selectedsound");

    int position = intent.getExtras().getInt("position");
    // displaying selected sound
    txtProduct.setText(selectedsound);
    mediaPlayer = MediaPlayer.create(this, sounds[position]); 
    Button b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new View.OnClickListener(){

     public void onClick(View arg0) {                            
    mediaPlayer.start();   
    //start the progress dialog
     }
    }); 
 }    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:34:29.833

删除`resId`（您已经没有使用它），因为您将 a 传递`Null`给它：

```
String selectedFromList = getItemAtPosition(position);

int resId = getResources().getIdentifier(selectedFromList, "raw", getPackageName());

private String getItemAtPosition(int position) {
    // TODO Auto-generated method stub
    return null;
} 
```

# php - 如何将城市列表添加到 Magento 单页结帐？

> ID：13357839
> 
> 赞同：0
> 
> 时间：2012-11-13T08:54:50.130
> 
> 标签：php, magento

我正在为本地企业开发 Magento 网站。因此，我需要从结帐页面中删除国家/地区列表并添加城市列表。

我该怎么做 ？

![在此处输入图像描述](../Images/25e808791ca9f7028275f211ccc57eb7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:24:38.840

一旦我们的一位客户遇到同样的问题，并且由于他们不想为功能齐全的模块付费，我们使用了一个技巧。我们只是将地区视为国家，将城市视为地区。为此，您应该将您的区域名称添加到 Zend 各自的语言环境数据文件中，并分别修改这三个表：

1- directory_country 2- directory_country_region 3- directory_country_region_name

# ios - 当我必须查询 Apple 的反馈服务时

> ID：13357840
> 
> 赞同：2
> 
> 时间：2012-11-13T08:55:01.553
> 
> 标签：ios, push-notification, apple-push-notifications

我没有发现的一件事是**何时**调用 Apple 的反馈服务以获取推送通知。本地和[推送通知编程指南](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008194-CH1-SW1)说：

> 提供商**应定期查询**反馈服务以获取其应用程序的设备令牌列表，每个设备令牌都由其主题标识。然后，在验证应用程序最近没有在识别的设备上重新注册后，提供商应该停止向这些设备发送通知。

但是有没有最佳实践可以遵循？例如：

1.  *每个人在发送任何通知之前都会*调用它，或者
2.  每个人每天调用*一次*，或者
3.  每个人每周调用*一次*，或者
4.  ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:39:36.460

您可以每天致电反馈服务，或者如果您在一天内发送大量通知，如果对您没有问题，则可以每小时发送一次。

调用反馈服务的原因是为了减少下一次发送中包含的订阅者数量。

调用频率取决于发送通知的频率。

# matlab - Matlab、Simulink、导入的使用

> ID：13357843
> 
> 赞同：0
> 
> 时间：2012-11-13T08:55:10.853
> 
> 标签：matlab, simulink

我尝试创建一个可以运行 simulink 模型的 matlab 文件。但是将数据从 MATLAB 发送到 simulink 模型时存在问题。在`Import Block`我想要从 matlab 发送数据流的模型中。

我当前的matlab代码是。

```
function result = CallSimulinkModel(modelName, timeStep, inputMatix, key)
    if(timeStep<=0) 
        error('MATLAB:CallSimulinkModel','Timestep is lower or equal with 0');
    end
    endTime = max(size(inputMatix))*timeStep;
    result = SubCallSimulinkModel(modelName, 0:timeStep:endTime, inputMatix, key);
    %OutVector.const = inConst;
end

function [result,constants] = SubCallSimulinkModel(var_model,time_var,inputMatix, K)
    var_setting = simset(...
        'SrcWorkspace','current'... 
    );
    % How to feed the sim model with the data from input matrix as Inport
    % 1, Inport 2, ...?
    [~,~,result] = sim(var_model, time_var, var_setting);
    constants = K;
end 
```

模型是![Simulink 模型](../Images/defcede5485af580639fc2b25750f931.png)

我从 simulink 获取结果或设置常量 K.in1 没有问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:31:08.957

找到了一个可行的解决方案。

```
% For MATLAB R2012a
function [result,time] = RunSimulinkModel(modelName, timeStep, inputMatix, key)
    if(timeStep<=0) 
        error('MATLAB:RunSimulinkModel','Timestep is lower or equal with 0');
    end
    endTime = max(size(inputMatix))*timeStep-timeStep;

    %CCC = [time_var;D]'
    % Is a 2 or more column that the first column is a time vector that
    % hold all time and the other columns hold the data.
    dataMatrix = [0:timeStep:endTime;inputMatix]';

    [result,time] = RunSimulinkModelSub(modelName, timeStep,dataMatrix,key);

end

function [result,time] = RunSimulinkModelSub(var_model,var_steptime, D,K)  %#ok<INUSD>
    var_setting = struct(...
        'SrcWorkspace','current',... 
        'SaveTime','on','TimeSaveName','tout', ...
        'SaveOutput','on','OutputSaveName','yout', ...
        'LoadExternalInput', 'on', 'ExternalInput', 'D',...
        'FixedStep', 'var_steptime' ...
    );
    var_row_result = sim(var_model, var_setting);
    result = var_row_result.get('yout');
    time = var_row_result.get('tout');
end 
```

这`'LoadExternalInput', 'on', 'ExternalInput', 'D',...`将告诉模型使用来自`D`时间向量和数据向量的数据。

# objective-c - 删除以前的 UIView

> ID：13357844
> 
> 赞同：0
> 
> 时间：2012-11-13T08:55:11.427
> 
> 标签：objective-c, ios

我有三个具有三个不同 XIB 的视图控制器，比如说 ViewControllerA、ViewControllerB 和 ViewControllerC，并且每个视图控制器在其属性中都有名为 view 的 UIView 变量。所以它会是这样的：

```
@property (readwrite, retain) UIView *view; 
```

首先，场景 ViewControllerA 加载，然后在我触摸 ViewControllerB 的按钮场景后出现。但我故意不从超级视图中删除 ViewControllerA 的 UIView。然后在我触摸一个按钮后，场景导航到 ViewControllerC。在这里，在导航到 ViewControllerC 之前，我想从超级视图中删除 ViewControllerA 和 ViewControllerB 的 UIView

删除 ViewControllerB 的 UIView 不是问题，我可以在 ViewControllerB 方法中执行以下操作：

```
[self.view removeFromSuperview]; 
```

但是如何删除 ViewControllerA 的 UIView？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:09:10.387

如果你想完全独立于其他视图控制器，你可以在 appDelegate.window.rootViewController 中切换它们。只创建指向 UIApplication 的变量 appDelegate。
并自己处理动画。

例子：

```
AppDelegate *appDelegate = (AppDelegate *)[UIApplication sharedApplication].delegate;
UIViewController *controller1 = [ViewControllerA alloc] initWithNibName:@"ViewControllerA" bundle:nil];
UIViewController *controller2 = [ViewControllerB alloc] initWithNibName:@"ViewControllerB" bundle:nil];

appDelegate.window.rootViewController = controller1;
appDelegate.window.rootViewController = controller2; 
```

# git - 有没有更简单的方法来编辑 git 笔记？

> ID：13357847
> 
> 赞同：0
> 
> 时间：2012-11-13T08:55:20.363
> 
> 标签：git

有没有其他方法来编辑 git 注释，比如设置默认编辑器等，而不是`git notes --ref=$ABC edit $COMMIT`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:58:41.387

git notes 自 1.7.1 [http://git.661346.n2.nabble.com/git-notes-and-core-editor-config-td5910253.html](http://git.661346.n2.nabble.com/git-notes-and-core-editor-config-td5910253.html)遵循您的编辑器设置。

编辑：如果你*真的*想，你可以学习[http://alblue.bandlem.com/2011/11/git-tip-of-week-git-notes.html](http://alblue.bandlem.com/2011/11/git-tip-of-week-git-notes.html)和

```
git checkout notes/commits
[point editor at the commit hash you want to]
git commit -am 'whatever'
git update-ref refs/notes/commits 1234567 
```

其中 1234567 是 [提交报告的哈希]。啊。但可行。

# java - 在不手动保存所有内容的情况下避免 JPA TransientObjectException

> ID：13357851
> 
> 赞同：1
> 
> 时间：2012-11-13T08:55:44.343
> 
> 标签：java, hibernate, jpa, cascade

我有一个像这样的对象层次结构（忽略所有字段，如 id、setter/getter 等）：

```
@Entity
class A {
    @OneToOne(cascade=CascadeType.ALL)
    private B b;
}

@Entity
class B {
    @OneToOne(cascade=CascadeType.ALL)
    private A a;

    @OneToOne(cascade=CascadeType.ALL)
    private C c;
}

@Entity
class C {
    private int x;
} 
```

所有实体都有`@Id @GeneratedValue private Long id;`

我将 JPA 与 Hibernate 和 MySQL 一起使用，并有一个 DAO 可以为`A`它做一个简单的`entityManager.merge(a); entityManager.flush();`

现在，这个结构被用在一个 JSF 项目中，我`A`用一个新的创建了一个新的，`B`但值`C`是从数据库中获取的，因此它是一个现有的实体。这个新填充的对象显示在页面上，并且仅在我单击保存按钮时才保存，因此创建和保存是在两个不同的事务中完成的。

当我尝试 do a`dao.save(a)`时，我得到一个`org.hibernate.TransientObjectException`，这并不奇怪，因为`c`in 类的值`B`已经存在于数据库中。

现在的实际问题是：我可以在不手动级联保存的情况下以某种方式避免这个问题吗？我说的是几十个`B`-type 类，每个类都有几十个`C`s - 这完全违背了我的级联想法......

任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:43:14.213

There may be a problem due to annotation. You can get help from this [Example](http://viralpatel.net/blogs/hibernate-one-to-one-mapping-tutorial-using-annotation/) to solve your problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:09:35.113

我通过执行以下操作解决了这个问题：

在`A`中，我创建了一个`List<B> getBs()`获取所有 B 类的方法。在`B`中，我创建了一个方法`List<C> getCs()`。现在，在我做的道

```
public void save(A a) {
    for (B b : a.getBs()) {
        for (C c : b.getCs()) {
            if (c != null) {
                if (c.getId() == null) {
                    entityManager.persist(c);
                } else {
                    entityManager.merge(c);
                }
            }
        }
    }
    super.save(a);
} 
```

现在我只需要跟踪`B`s和`C`s，但它仍然比遍历整个对象树要好......

# spring - 使用java spring在HTML5中从前端到后端调用什么是好的解决方案

> ID：13357854
> 
> 赞同：0
> 
> 时间：2012-11-13T08:56:03.990
> 
> 标签：spring

我对我的项目有点困惑如何从前端调用后端，

有两种解决方案可用。

Frontned 是 HTML5/jQuery，并在 spring 提供了 rest 服务：

1.  在 url 上传递 JSESSIONID
2.  在标头 -md5 安全性上传递用户名和密码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:06:37.750

是否有任何东西阻止您将 JSESSIONID 作为 cookie 传递，就像“正常”的方式一样？

# java - 如何修复 Android 上 Spongy Castle 的错误：找不到类 java.awt.datatransfer.DataFlavor

> ID：13357855
> 
> 赞同：2
> 
> 时间：2012-11-13T08:56:06.167
> 
> 标签：java, android, email, bouncycastle, spongycastle

根据[此示例](https://github.com/rtyley/spongycastle/blob/spongy-master/scmail-jdk15on/src/main/java/org/spongycastle/mail/smime/examples/SendSignedAndEncryptedMail.java)，我使用 lib Spongy Castle 对 Android 上的邮件进行签名和加密。

```
 /* Add BC */
            Security.addProvider(new BouncyCastleProvider());
            /* Open the keystore */
            KeyStore keystore = KeyStore.getInstance("PKCS12", "SC");
            keystore.load(new FileInputStream(pkcs12Keystore),
                    password.toCharArray());
            Certificate[] chain = keystore.getCertificateChain(keyalias);

            /* Get the private key to sign the message with */
            PrivateKey privateKey = (PrivateKey) keystore.getKey(keyalias,
                    password.toCharArray());

            /* Create the SMIMESignedGenerator */
            SMIMECapabilityVector capabilities = new SMIMECapabilityVector();
            capabilities.addCapability(SMIMECapability.dES_EDE3_CBC);
            capabilities.addCapability(SMIMECapability.rC2_CBC, 128);
            capabilities.addCapability(SMIMECapability.dES_CBC);

            ASN1EncodableVector attributes = new ASN1EncodableVector();
            attributes.add(new SMIMEEncryptionKeyPreferenceAttribute(
                    new IssuerAndSerialNumber(new X500Name(
                            ((X509Certificate) chain[0]).getIssuerDN()
                                    .getName()), ((X509Certificate) chain[0])
                            .getSerialNumber())));
            attributes.add(new SMIMECapabilitiesAttribute(capabilities));

            SMIMESignedGenerator signer = new SMIMESignedGenerator();
            signer.addSignerInfoGenerator(new JcaSimpleSignerInfoGeneratorBuilder()
                    .setProvider("SC")
                    .setSignedAttributeGenerator(new AttributeTable(attributes))
                    .build("DSA".equals(privateKey.getAlgorithm()) ? "SHA1withDSA"
                            : "MD5withDSA", privateKey,
                            (X509Certificate) chain[0]));

            /* Add the list of certs to the generator */
            List certList = new ArrayList();
            certList.add(chain[0]);
            Store certs = new JcaCertStore(certList);
            signer.addCertificates(certs);

            /* Sign the message */
            MimeMultipart mm = signer.generate(originalMessage, "SC");
            signedMessage = new MimeMessage(session);

            /* Set all original MIME headers in the signed message */
            Enumeration headers = originalMessage.getAllHeaderLines();
            while (headers.hasMoreElements()) {
                signedMessage.addHeaderLine((String) headers.nextElement());
            }

            /* Set the content of the signed message */
            signedMessage.setContent(mm);
            signedMessage.saveChanges();

            ByteArrayOutputStream out = new ByteArrayOutputStream();
            signedMessage.writeTo(out);

            FileOutputStream f = new FileOutputStream(new File(
                    "/sdcard/MobilePKI/out.txt"));
            f.write(out.toByteArray());
            f.close(); 
```

当我运行我的应用程序时，它返回以下错误：

```
11-13 08:54:11.867: E/dalvikvm(13188): Could not find class '[Ljava.awt.datatransfer.DataFlavor;', referenced from method org.spongycastle.mail.smime.handlers.multipart_signed.<clinit>
11-13 08:54:11.890: E/AndroidRuntime(13188): FATAL EXCEPTION: main
11-13 08:54:11.890: E/AndroidRuntime(13188): java.lang.VerifyError: org.spongycastle.mail.smime.handlers.multipart_signed
11-13 08:54:11.890: E/AndroidRuntime(13188):    at java.lang.Class.newInstanceImpl(Native Method)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at java.lang.Class.newInstance(Class.java:1409)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.activation.MailcapCommandMap.getDataContentHandler(MailcapCommandMap.java:609)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.activation.MailcapCommandMap.createDataContentHandler(MailcapCommandMap.java:563)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.activation.DataHandler.getDataContentHandler(DataHandler.java:626)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.activation.DataHandler.writeTo(DataHandler.java:329)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.mail.internet.MimeBodyPart.writeTo(MimeBodyPart.java:1403)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.mail.internet.MimeMessage.writeTo(MimeMessage.java:1745)
11-13 08:54:11.890: E/AndroidRuntime(13188):    at javax.mail.internet.MimeMessage.writeTo(MimeMessage.java:1721) 
```

Spongy Castle lib的源代码似乎需要java.awt.datatransfer：

```
package org.spongycastle.mail.smime.handlers;

import org.spongycastle.mail.smime.SMIMEStreamingProcessor;

import javax.activation.ActivationDataFlavor;
import javax.activation.DataContentHandler;
import javax.activation.DataSource;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.internet.ContentType;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMultipart;

import java.awt.datatransfer.DataFlavor;

import java.io.BufferedInputStream;
import java.io.FilterOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.Enumeration; 
```

（链接：[https](https://github.com/rtyley/spongycastle/blob/spongy-master/scmail-jdk15on/src/main/java/org/spongycastle/mail/smime/handlers/multipart_signed.java) ://github.com/rtyley/spongycastle/blob/spongy-master/scmail-jdk15on/src/main/java/org/spongycastle/mail/smime/handlers/multipart_signed.java ）

我认为它必须导入包 java.awt 并且我将 rt.jar（包括 java.awt.*）导入到我的项目中，但它仍然有这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T02:11:33.137

我修正了我的错误：
+ 我下载了[spongycastle lib](https://github.com/rtyley/spongycastle)
的源代码 + 替换行“import java.awt.datatransfer.DataFlavor;” 通过“导入 myjava.awt.datatransfer.DataFlavor；” （包 myjava.awt.datatransfer 包含在[附加库](http://code.google.com/p/javamail-android/downloads/list)中）
+ 重建 spongycastle 库
+ 使用新的 spongycastle 库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-20T21:40:33.737

我设法解决了这个问题：

0）在邮件包上运行 become-spongy.sh 脚本（来自“spongy-scripts”分支） 1）在 mail/src/main/ 中创建 AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.spongycastle">
</manifest> 
```

2) 更改邮件/build.gradle

```
apply plugin: 'com.android.library'
dependencies {
    compile 'com.sun.mail:android-mail:1.5.5'
    compile 'com.sun.mail:android:1.5.5'
    compile 'com.madgag.spongycastle:pkix:1.54.0.0'
    compile 'com.madgag.spongycastle:prov:1.54.0.0'
    compile 'com.madgag.spongycastle:core:1.54.0.0'
    testCompile 'junit:junit:4.12'
}

android {
    compileSdkVersion 24
    buildToolsVersion "24.0.0"

    defaultConfig {
        minSdkVersion 15
        targetSdkVersion 24
        versionCode 1
        versionName "1.0"
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
} 
```

3) 在处理程序文件 (spongycastle/mail/src/main/java/org/spongycastle/mail/smime/handlers/) 中：a) 删除`import java.awt.datatransfer.DataFlavor` b) 删除用 javax 替换 java.awt.datatransfer.DataFlavor 变量/返回类型.activation.ActivationDataFlavor

4）在您的android项目中将该文件夹包含为模块

5) 建造并玩得开心；D

在这里你可以看到一个工作的 spongycastle 邮件包是什么样子的：[https ://github.com/Skywalker-11/spongycastle](https://github.com/Skywalker-11/spongycastle)

[这是一个关于如何使用固定版本通过 smtp https://github.com/Skywalker-11/SpongyCastleMailTestApp](https://github.com/Skywalker-11/SpongyCastleMailTestApp)发送加密的 smime 消息的 android 应用程序的示例

# entity-framework-4.3 - 实体框架代码优先并发控制

> ID：13357856
> 
> 赞同：2
> 
> 时间：2012-11-13T08:56:23.747
> 
> 标签：entity-framework-4.3

那里

我首先使用 EF 代码按照以下顺序保存数据：过滤器 => 删除 => 添加，运行附加示例（两个线程同时运行），有时我注意到过滤后没有现有记录返回，有时过滤后有两条记录，我认为/预期的是 - 每次过滤器应该有一个现有的记录返回。此外，在保存更改期间还会出现一些异常。

据我所知，EF默认使用Read Committed隔离级别来执行事务，我认为这意味着在过滤期间，共享锁被放在资源上，但是为什么我可以观察到不存在记录或两个现有记录过滤之后，remove 和 add 操作一起应该是原子操作吧？如果我是对的，过滤后应该只有一条记录。

有什么我错过的吗？如何正确处理这种情况？

请帮忙。

另一个问题： 使用 LastUpdated 列作为并发标记，如何正确处理以下情况： 1\. 如果数据库中的实体比上下文中的实体更新，则启动另一个线程将实体归档到历史数据库。2\. 如果数据库中的实体比上下文中的实体旧，重试保存覆盖数据库中的实体。

我是否正确使用下面的代码来处理此案：

```
internal void SaveChangesEx()
    {
        bool saveFailed;

        do
        {
            saveFailed = false;
            try
            {

                base.SaveChanges();
            }
            catch (DbUpdateConcurrencyException ex)
            {
                saveFailed = false;
                ex.Entries.ToList().ForEach(entry =>
                {
                    if (entry.State == System.Data.EntityState.Deleted)
                    {
                        var current = base.Set<Customer>().FirstOrDefault();
                        Customer rfqInDb = (Customer)entry.GetDatabaseValues();
                        // If the newer one aready exists, start the archive,                     otherwise, retry by reloading the entity from DB and marking the state as deleted
                        if (current.LastUpdated < customerInDb.LastUpdated)
                        {
                            using (var archiver = new CustomerArchiveDBContext())
                            {
                                                           archiver.RFQS.Add(current);
                                                           archiver.SaveChangesEx();
                            }
                            saveFailed = false;
                        }
                        else
                        {
                            //Refresh the context and retry
                            entry.Reload();
                            entry.State = System.Data.EntityState.Deleted;
                        }
                        }
                        });
                        }
        } while (saveFailed);
    } 
```

脚本：========

```
CREATE TABLE [dbo].[Customers](
 [FirstName] [nvarchar](20) NOT NULL,
 [LastName] [nvarchar](60) NULL,
 [Company] [nvarchar](250) NULL,
 [Telephone] [nvarchar](20) NULL,
 [LastUpdated] [datetime] NULL
 ) ON [PRIMARY] 
```

代码 ========

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Transactions;
using System.Data.Entity.Validation;
using System.Threading.Tasks;
using System.Threading;
using System.Data.Entity.ModelConfiguration;
using System.Data.Entity;
using System.Data.Entity.ModelConfiguration.Conventions;

namespace EFOptimisticConcurrency
{
public abstract class Entity
{
  public int Id { get; set; }
}

public class Customer
    : Entity
{
    public string FirstName { get; set; }

    /// <summary>
    /// Get or set the surname of this customer
    /// </summary>
    public string LastName { get; set; }

    /// <summary>
    /// Get or set the telephone 
    /// </summary>
    public string Telephone { get; set; }

    /// <summary>
    /// Get or set the company name
    /// </summary>
    public string Company { get; set; }

    public DateTime LastUpdated { get; set; }
}

class CustomerEntityConfiguration
    : EntityTypeConfiguration<Customer>
{
    /// <summary>
    /// Create a new instance of customer entity configuration
    /// </summary>
    public CustomerEntityConfiguration()
    {
        //configure keys and properties
        this.HasKey(c => c.FirstName);

        this.Ignore(c => c.Id);

        this.Property(c => c.FirstName)
            .HasMaxLength(20)
            .IsRequired();

        this.Property(c => c.LastName)
            .HasMaxLength(60)
            .IsRequired();

        this.Property(c => c.Company)
            .HasMaxLength(250);

        //this.Property(c => c.LastUpdated).IsConcurrencyToken();

        this.Property(c => c.Telephone)
            .HasMaxLength(20);
        this.ToTable("Customers");
    }
}

public class CustomerContext : DbContext
{
    public DbSet<Customer> Customers { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();
        modelBuilder.Configurations.Add(new CustomerEntityConfiguration()); ;
    }
}

public class Program
{
    public static volatile int showStopper = 0;
    static void Main(string[] args)
    {
        var color = Console.ForegroundColor;
        EntityFrameworkProfiler.Initialize();
        Task.Factory.StartNew(() =>
            {
                while (true)
                {
                    Customer customer = new Customer();
                    customer.FirstName = "FirstName";
                    customer.LastName = "Last " + new Random().Next(0, 10000).ToString();
                    customer.Telephone = "686868";
                    customer.Company = "MyCity";
                    customer.LastUpdated = DateTime.Now;

                    if (showStopper == 2)
                    {
                        Console.ReadLine();
                        showStopper = 0;
                    }
                    try
                    {
                        Console.WriteLine("Start the Store => " + customer.LastName + " , " + customer.LastUpdated.ToString());
                        {
                            int i = 0;
                            using (var customerConext = new CustomerContext())
                            {
                                Console.WriteLine("Start the filter 1 => " + customer.Telephone + " , " + customer.LastUpdated.ToString());
                                var matched = customerConext.Customers.Where(c => c.Telephone == "686868" && c.LastUpdated < customer.LastUpdated);
                                foreach (var hit in matched)
                                {
                                    i++;
                                    customerConext.Customers.Remove(hit);
                                }

                                if (i == 2)
                                {
                                    Console.WriteLine("1 - 2 exist, has the problem now");
                                    showStopper = 2;
                                }
                                else if (i == 0)
                                {
                                    Console.WriteLine("1 - 0 exist, has the problem now");
                                    showStopper = 2;
                                }

                                Console.WriteLine("Start Adding 1 => " + customer.LastName + " , " + customer.LastUpdated.ToString());

                                try
                                {
                                    customerConext.Customers.Add(customer);
                                    customerConext.SaveChanges();         
                                    Console.WriteLine("SaveChanges 1 => " + customer.LastName + " , " + customer.LastUpdated.ToString());
                                }
                                catch (Exception ex)
                                {
                                    Console.WriteLine("Exception 1 : " + ex.Message + " => " + customer.LastName + " , " + customer.LastUpdated);
                                    if (ex.InnerException != null)
                                    {
                                        Console.WriteLine("Inner Exception 2 : " + ex.InnerException.Message + " => " + customer.LastName + " , " + customer.LastUpdated);
                                    }
                                }
                            }

                        }
                    }
                    catch (Exception ex)
                    {
                        Console.WriteLine("Exception 1 " + ex.Message);
                        if (ex.InnerException != null)
                        {
                            Console.WriteLine(ex.InnerException.Message);
                        }
                        showStopper = 2;
                    }
                }
            });

        Thread.Sleep(10000);

        Task.Factory.StartNew(() =>
        {
            while (true)
            {
                Console.ForegroundColor = color;
                try
                {
                    Customer customer = new Customer();
                    customer.FirstName = "FirstName";
                    customer.LastName = "Last " + new Random().Next(0, 10000).ToString();
                    customer.Telephone = "686868";
                    customer.Company = "MyCity2";
                    customer.LastUpdated = DateTime.Now;

                    if (showStopper == 3)
                    {
                        Console.ReadLine();
                        showStopper = 0;
                    }

                    Console.WriteLine("Start the store 2 => " + customer.LastName + " , " + customer.LastUpdated.ToString());
                    {
                        int i = 0;
                        using (var customerConext = new CustomerContext())
                        {
                            Console.WriteLine("Start the filter 2 => " + customer.Telephone + " , " + customer.LastUpdated.ToString());
                            var matched = customerConext.Customers.Where(c => c.Telephone == "686868" && c.LastUpdated < customer.LastUpdated);
                            foreach (var hit in matched)
                            {
                                i++;
                                customerConext.Customers.Remove(hit);
                            }

                            Console.WriteLine("Start Adding 2 => " + customer.LastName + " , " + customer.LastUpdated.ToString());
                            try
                            {
                                customerConext.Customers.Add(customer);
                                customerConext.SaveChanges();
                                Console.WriteLine("SaveChanges 2 => " + customer.LastName + " , " + customer.LastUpdated.ToString());
                            }
                            catch (Exception ex)
                            {
                                Console.WriteLine("Exception 2 : " + ex.Message + " => " + customer.LastName + " , " + customer.LastUpdated);
                                if (ex.InnerException != null)
                                {
                                    Console.WriteLine("Inner Exception 2 : " + ex.InnerException.Message + " => " + customer.LastName + " , " + customer.LastUpdated);
                                }

                                showStopper = 2;
                            }
                        }

                        if (i == 2)
                        {
                            Console.WriteLine("1 - 2 exist, has the problem now");
                            showStopper = 2;

                        }
                        else if (i == 0)
                        {
                            Console.WriteLine("1 - 0 exist, has the problem now");
                            showStopper = 2;
                        }
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Exception 2 " + ex.Message);
                    if (ex.InnerException != null)
                    {
                        Console.WriteLine(ex.InnerException.Message);
                    }   
                }
            }
        });

        Console.WriteLine("PRESS ANY KEY TO END");
        Console.ReadLine();
    }
} 
```

}

# opencv - 旋转矩形 - 角度返回 - Opencv

> ID：13357863
> 
> 赞同：2
> 
> 时间：2012-11-13T08:56:43.730
> 
> 标签：opencv, rotation, orientation, rectangles

当涉及到 RotatedRect 时，我无法理解 OpenCV 的工作原理。

我已经提取了一个轮廓，然后我尝试在它上面放置一个旋转的矩形。我不断获得的角度范围仅在 0 到 -90 之间。即使我通过翻转轮廓使轮廓指向另一个方向，我仍然可以得到 0 到 -90 个角度。

我的问题是确保轮廓位于 0' 度。为此，我必须计算方向，然后相应地旋转。

这些角度在 OpenCV (2.4.3) 中是如何表示的？

问候瓦吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:28:25.977

在某些情况下`RotatedRect`，轮廓旋转 180 度的角度可能相同。确定它是否发生在您的情况下的最佳方法是绘制拟合的 RotatedRect。

我认为更适合您的情况是轮廓矩。

在此处查看我的答案： [OpenCV 中的旋转和缩放不变模板匹配](https://stackoverflow.com/questions/12601583/rotation-and-scale-invariant-template-matching-in-opencv/12608877#12608877) 以及： [查找图像的方向](https://stackoverflow.com/questions/11330269/find-the-orientation-of-an-image?answertab=active#tab-top)

您可以计算时刻`cv::Moments`：[http ://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=moments#cv.Moments](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=moments#cv.Moments)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T09:19:33.517

我发现角度在计数器和 Y 轴之间（来自 LearningOpenCV）。你期望它来自 X 轴吗？

# c# - 单元测试 IHttpModule 的最佳实践

> ID：13357865
> 
> 赞同：3
> 
> 时间：2012-11-13T08:56:59.487
> 
> 标签：c#, unit-testing, httpmodule

我正在用 C# 编写一个 HttpModule，并编写了许多单元测试来测试代码。

该模块非常简单，它所做的只是检查一些 cookie，并根据我们的业务逻辑使需要过期的那些过期。

但我想确保这不会破坏任何东西。所以我想好好测试一下！

我已阅读有关使用 System.Web.Abstractions 模拟请求和响应对象的文章。这很棒，而且有效！有关更多信息，请查看：[http ://www.kongsli.net/nblog/2009/05/03/aspnet-35-improving-testability-with-systemwebabstractions/](http://www.kongsli.net/nblog/2009/05/03/aspnet-35-improving-testability-with-systemwebabstractions/)

但是我想知道在编写 HttpModules 时是否真的需要测试一些东西。与我的业务逻辑代码没有直接关系的东西。例如，要测试我正确处理模块的东西，或者可能会破坏的其他东西。

谢谢，JP

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:05:15.520

简单的：

1.  不要将逻辑放在`IHttpModule`实现中。
2.  由于您只修改 cookie，因此只需将它们传递给您自己的类。

例子：

```
void InYourHttpModule()
{
    myLogic.Invoke(Request.Cookies, Response.Cookies);
} 
```

通过这种方式，很容易验证您的逻辑是否按照它所说的去做，而不是其他任何事情。

# php - 当 mysql_query 中包含“AND”时，Ajax 响应不起作用

> ID：13357867
> 
> 赞同：1
> 
> 时间：2012-11-13T08:57:05.343
> 
> 标签：php, jquery, mysql, sql, ajax

所以这是我的问题简短版本：

**这有效：**

```
$query = mysql_query("SELECT * FROM `some_table` 
                     WHERE IF (LENGTH('$some_variable') > 0, `$other_variable` LIKE
                               '%$some_variable%' , 0)"); 
```

我得到了一个结果，一段时间后将其全部打包到一个数组中，并使用 json_encode 将其发送回我的 ajax 文件，我在其中列出了结果。而且效果很好。

但是，当我在查询中再添加一件事时，它只会返回空，所以**这不起作用：**

```
$query = mysql_query("SELECT * 
                      FROM `some_table` 
                      WHERE `something` = `some_other_thing` AND 
                          IF (LENGTH('$some_variable') > 0, `$other_variable` 
                               LIKE '%$some_variable%' , 0)"); 
```

因此，有了这个**，**事情就不起作用了，但只有 ajax，我的意思是，如果我只是简单地将数组打印出来，php 就可以很好地工作。

提前致谢。

这是我的 php 的其余部分

```
while ($value = mysql_fetch_array($query)) {

$result[] = array
            (       
                gyarto => $value['gyarto'],
                termekcsalad => $value['termekcsalad'],
                kiszereles => $value['kiszereles']
            );
}

echo json_encode($result); 
```

和我的jQuery：

```
$.ajax({
                    url:"updates/isu.php",
                    type:"POST",
                    data: form,
                    dataType: "json",
                    success: function(data) {

                    $.each(data, function(i)                            
                    {
                       $("#result table").append('<tr><td>'+data[i].gyarto+' '+data[i].termekcsalad+' '+data[i].kiszereles+'</td></tr>');

                    }); 

                }
            });

        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:07:15.267

```
I think you are mixing php language in a mysql query. 
```

尝试：

```
$query = mysql_query("SELECT * FROMsome_table WHEREsomething=some_other_thing AND  (LENGTH('$some_variable') > 0 AND '$other_variable` LIKE '%$some_variable%')"); 
```

这里还有一个关于如何使用 mysql_fetch_array 的例子

```
mysql_connect("localhost", "mysql_user", "mysql_password") or
    die("Could not connect: " . mysql_error());
mysql_select_db("mydb");

$result = mysql_query("SELECT id, name FROM mytable");

while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
    printf("ID: %s  Name: %s", $row["id"], $row["name"]);
}

mysql_free_result($result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:01:47.520

尝试这个;

```
 $sql = "SELECT *, LENGTH('$some_variable') as 'length_of_var'  
                     FROM some_table 
                     WHERE something=some_other_thing AND 
                           length_of_var > 0 AND 
                           `$other_variable` LIKE '%$some_variable%';";

 die($sql);//we will stop here and see how the query looks like.. If it's an AJAX request, you will need to check in your browser console. Use firebug or chrome developer tools.

$query = mysql_query($sql); 
```

您是否还可以在执行和共享之前记录 sql 字符串。这可以帮助您在执行之前查看查询的外观，然后我们可以对其进行修改，然后编辑您的 php 代码以修复任何问题。您连接到 SQL 查询的一些变量是空字符串或 null 等，这很冷。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T09:31:20.343

使用一些“合成”示例数据，查询“按假设”工作

```
<?php
mysql_connect('localhost', 'localonly', 'localonly') or die(mysql_error());
mysql_select_db('test')  or die(mysql_error());
setup();

$other_variable = 'foo';
$some_variable = 'hell';
$query = mysql_query("SELECT * 
                      FROM `some_table` 
                      WHERE `something` = `some_other_thing` AND 
                          IF (LENGTH('$some_variable') > 0, `$other_variable` 
                               LIKE '%$some_variable%' , 0)");                          
if (!$query) die(mysql_error());
while( false!==($row=mysql_fetch_assoc($query)) ) {
    echo join(', ', $row), "\n";
}

function setup() {
    mysql_query('
        CREATE TEMPORARY TABLE some_table ( 
            id int auto_increment,
            something int,
            some_other_thing int,
            foo varchar(32),
            primary key(id)
        )
    ') or die(mysql_error());

    mysql_query("INSERT INTO some_table (something, some_other_thing, foo) VALUES
        (1, 1, 'hello'),
        (1, 1, 'lalala'),
        (2, 2, 'hellboy')
    ") or die(mysql_error());
} 
```

印刷

```
1, 1, 1, hello
3, 2, 2, hellboy 
```

但我怀疑该查询是否符合您的预期。
例如，如果`$some_variable`为空，则更容易在 php 端进行测试并完全跳过查询 - 在这种情况下，没有记录可以满足条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T09:14:42.170

用php计算长度`$some_variable`，为什么要用mysql `LENGTH`？如果您可以在 PHP 中检测到长度`$some_variable`大于 0，只需将您的查询分开：

```
if (strlen($some_variable) > 0) {
   mysql_query("
      SELECT * 
      FROM `some_table` 
      WHERE `something` = `some_other_thing`
        AND `$other_variable` LIKE '%$some_variable%'")
} else {
   // do nothing because your where clause has condition like: something = another AND 0
   // so for each row it's false
} 
```

# javascript - AngularJS $资源和超媒体

> ID：13357868
> 
> 赞同：7
> 
> 时间：2012-11-13T08:57:12.340
> 
> 标签：javascript, rest, angularjs, hypermedia

我有一个像这样定义的 AngularJS $resource：

```
var Menus = $resource('http://cafe.com/api/menus'); 
```

和一个 RESTful API。所以当我做一个`GET`我`Menus`得到这个回来：

```
<cafe>
  <collection href="http://cafe.com/api/menus" type="menus">
    <template>
      <data name="Name" prompt="Menu name" />
    </template>
    <items>
      <item href="http://cafe.com/api/menus/1">
        <link href="http://cafe.com/api/menus/1/ingredients" rel="ingredients" />
        <data name="Name" prompt="Menu name">Morning</data>
      </item>
      <item href="http://cafe.com/api/menus/2">
        <link href="http://cafe.com/api/menus/2/ingredients" rel="ingredients" />
        <data name="Name" prompt="Menu name">Happy Hour</data>
      </item>
    </items>
  </collection>
</cafe> 
```

**问题是**，如何删除菜单 2？（鉴于它有自己的超媒体链接`http://cafe.com/api/menus/2`：）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-22T22:44:39.180

假设您已经从 XML 转到 Angular 管理的 JavaScript 对象数组，您可以使用它来呈现您的对象：

```
<tr ng-repeat="cafe in cafes">
    <td>{{cafe.name}}</td>
    <td>
        <button class="btn" ng-click="deleteCafe($index, cafe)">Delete</button>
    </td>
</tr> 
```

在你的控制器中你可以这样做：

```
function ListCtrl($scope, $http, CafeService) {
  CafeService.list(function (cafes) {
    $scope.cafes = cafes;
  });

  $scope.deleteCafe = function (index, cafe) {
    $http.delete(cafe.self).then(function () {
      $scope.cafes.splice(index, 1);
    }, function () {
      // handle error here
    });
  }
} 
```

看，没有客户端创建 URL！:)

*更新：*修复了 splice 命令中的错误，是`splice(index, index)`，但应该是`splice(index, 1)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T08:33:26.927

如果您的 REST 服务将 JSON 返回到 Angular，并且 JSON 在返回的数据中包含菜单 ID。

```
var Menu = $resource('http://cafe.com/api/menus/:id', { id: '@id' }); // replace @id with @<the id field in your json object>

// Delete menu 2
Menu.delete({id: 2}, function(){ // Success callback
  // Get all menus, 
  var menus = Menu.query(function() { // Success callback
    // alternative delete syntax:
    var lastMenu = menus.pop();
    lastMenu.$delete();
  });
}); 
```

# c# - 添加 WCF 服务后方法签名更改

> ID：13357871
> 
> 赞同：0
> 
> 时间：2012-11-13T08:57:34.787
> 
> 标签：c#, wcf, service-reference

在我的解决方案中，我创建了一个 WCF 服务，它将消息合同类作为参数。

```
[ServiceContract]
public interface IServiceClass
{
    [OperationContract]
    Employee AddEmployee(Employee employee);

}

 public class ServiceClass : IServiceClass
 {
    public Employee AddEmployee(Employee employee)
    {
       //do something
    }
 }

[MessageContract]
public class Employee
{
    [MessageHeader]
    public string EmployeeNumber { get; set; }

    [MessageBodyMember]
    public string FirstName { get; set; }
    [MessageBodyMember]
    public string LastName { get; set; }
    [MessageBodyMember]
    public DateTime DOB { get; set; }
} 
```

然后我使用添加服务引用选项将此服务添加到我的客户端应用程序。服务添加成功。然后在我的客户端程序中，我使用了这种方法。但是方法签名已更改。它改变如下。

```
 public void AddEmployee(ref string EmployeeNumber, 
    ref System.DateTime DOB, ref string FirstName, ref string LastName) 
```

我在客户端中使用该服务如下。

```
TcpServiceReference.ServiceClassClient service =
            new TcpServiceReference.ServiceClassClient(); 
```

注意：TcpServiceReference 是服务名称

我无法理解原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T10:12:53.563

不完全确定为什么 WCF 有时会这样做，但如果您使用服务接口，您将获得“正确”的方法签名：

```
TcpServiceReference.IServiceClass service = 
    new TcpServiceReference.ServiceClassClient(); 
```

（假设这`IServiceClass`是svcutil（添加服务引用）为您生成的服务接口的*客户端名称。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T10:02:01.583

你解决了问题吗？

看起来代理没有成功生成，除非你还有一个返回 void 的 AddEmployee 方法（并接受四个参数）？

我建议您重新生成（删除和创建）服务引用。

干杯——乔克

# php - Moodle 在安装过程中使我的服务器崩溃

> ID：13357874
> 
> 赞同：0
> 
> 时间：2012-11-13T08:57:57.667
> 
> 标签：php, apache, moodle

我有 Moodle 2.3.3+，在安装的“扩展检查页面”中按“继续”后，服务器将停止，当我尝试访问服务器上的任何域时，将出现此消息：

`The connection was reset`

3-5 分钟后，服务器将再次响应，安装将继续“管理员注册”，当我按下“提交”时，服务器将再次崩溃而不保存管理员信息。

服务器规格：

*   专用服务器
*   Intel® Core™ i7-920 四核
*   内存 24 GB DDR3 内存
*   Apache/2.2.16 (Debian)
*   PHP/5.3.3-7

PHP日志：

```
PHP Notice:  Undefined variable: CFG in /var/www/clients/client1/web4/web/index.php on line 32 
PHP Notice:  Trying to get property of non-object in /var/www/clients/client1/web4/web/index.php on line 32
PHP Warning:  require_once(/course/lib.php): failed to open stream: No such file or directory in /var/www/clients/client1/web4/web/index.php on line 32
PHP Fatal error:  require_once(): Failed opening required '/course/lib.php'(include_path='.:/usr/share/php:/usr/share/pear') in /var/www/clients/client1/web4/web/index.php on line 32 
```

任何想法为什么会这样？

# entity-framework - 实体框架和 System.Data.Sqlite 日期时间问题

> ID：13357877
> 
> 赞同：4
> 
> 时间：2012-11-13T08:58:13.580
> 
> 标签：entity-framework, sqlite, datetime, system.data.sqlite

我首先将现有的 sqlite3 数据库（通过 system.data.sqlite）映射到实体框架（版本 5）代码时遇到问题。

数据库中有一个名为 notes 的表，我映射到我的实体类：

```
public class Note
{   
    [Column("ZNAME")
    public string Name { get; set; }

    [Column("ZDATE")]
    public DateTime Date  { get; set; }

    [Column("ZNOTE")]
    public string Description { get; set; }
} 
```

例如，在数据库中，我有 2 行，其中 ZDATE 字段为空，其他有一些日期（例如：30/12/1899 21:00:05）。当我对其进行单元测试时，当我试图获取整个集合或第一行的空日期时间字段时，我得到了臭名昭著的异常：“字符串未被识别为有效的日期时间。” 试图只获得其他行（带日期），我的测试通过了。

起初我认为将 DateTime 更改为字符串会解决问题，但它给了我同样的例外。我尝试使用 DateTime?，同样的错误。

看起来，也许我错了，System.Data.Sqlite 试图将该字段转换为日期时间（因为名称或其他原因）。

这是我的异常的堆栈跟踪：

```
at System.DateTimeParse.ParseExactMultiple(String s, String[] formats, DateTimeFormatInfo dtfi, DateTimeStyles style)
   at System.DateTime.ParseExact(String s, String[] formats, IFormatProvider provider, DateTimeStyles style)
   at System.Data.SQLite.SQLiteConvert.ToDateTime(String dateText, SQLiteDateFormats format, DateTimeKind kind)
   at System.Data.SQLite.SQLiteConvert.ToDateTime(String dateText)
   at System.Data.SQLite.SQLiteConvert.ToDateTime(IntPtr ptr, Int32 len)
   at System.Data.SQLite.SQLite3.GetDateTime(SQLiteStatement stmt, Int32 index)
   at System.Data.SQLite.SQLite3.GetValue(SQLiteStatement stmt, Int32 index, SQLiteType typ)
   at System.Data.SQLite.SQLiteDataReader.GetValue(Int32 i)
   at System.Data.Common.Internal.Materialization.Shaper.ErrorHandlingValueReader`1.GetUntypedValueDefault(DbDataReader reader, Int32 ordinal)
   at System.Data.Common.Internal.Materialization.Shaper.ErrorHandlingValueReader`1.GetValue(DbDataReader reader, Int32 ordinal)
   at System.Data.Common.Internal.Materialization.Shaper.GetPropertyValueWithErrorHandling[TProperty](Int32 ordinal, String propertyName, String typeName)
   at lambda_method(Closure , Shaper )
   at System.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly[TEntity](Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet)
   at lambda_method(Closure , Shaper )
   at System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper)
   at System.Data.Common.Internal.Materialization.Shaper`1.SimpleEnumerator.MoveNext()
   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source) 
```

有人可以给我一些见解如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:00:39.267

您需要使用日期时间吗？作为类型

```
[Column("ZDATE")]
public DateTime? Date  { get; set; } 
```

这将允许 Date 字段的空值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:39:26.727

在 SQLite 中，[日期的格式必须为`yyyy-mm-dd`](http://www.sqlite.org/lang_datefunc.html).

# sql - SQL：使用子查询比较平均值

> ID：13357878
> 
> 赞同：1
> 
> 时间：2012-11-13T08:58:16.810
> 
> 标签：sql

我一直在尝试设置此查询。

```
SELECT P.ProductNo,P.Description, AVG(OrderLine.ActualPrice)
FROM Product P
INNER JOIN OrderLine
     ON OrderLine.ProductNo = P.ProductNo
WHERE AVG(ActualPrice) > 
                 (SELECT AVG(ActualPrice)
                          FROM OrderLine) 
```

我的目标是将产品的平均实际价格与所有产品的平均价格进行比较。但我似乎没有让它发挥作用。我在哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:59:59.917

*   采用`GROUP BY`
*   使用聚合条件时，使用`HAVING`代替`WHERE`

询问，

```
SELECT  P.ProductNo, P.Description, AVG(OrderLine.ActualPrice)
FROM    Product P
        INNER JOIN OrderLine
              ON OrderLine.ProductNo = P.ProductNo
GROUP BY P.ProductNo, P.Description
HAVING AVG(ActualPrice) > (SELECT AVG(ActualPrice)  FROM OrderLine) 
```

# c++ - 检查 fopen 不支持的文件名

> ID：13357880
> 
> 赞同：1
> 
> 时间：2012-11-13T08:58:32.603
> 
> 标签：c++, qt, unicode, filenames, fopen

我正在尝试打开一个文件以便稍后处理它。我的问题是，如果我的文件名不是 ANSI（阿拉伯语、印地语...）`fopen_s`并`fopen`拒绝打开它并给我一个`Invalid argument`错误。我不能`CreateFile()`这样做，所以我想检查我的文件名是否受支持`fopen`（尝试打开它）并创建一个临时文件：

```
QString fileN=QString::fromWCharArray(fname); 
QFileInfo file(DIRPath+"/"+fileN);
bool Supported=true;
if(file.exists()) {
    QString temp;   
    char* Fname=(char*)malloc(260*sizeof(char));
    strcpy(Fname,(QString(DIRPath+"/"+fileN).toStdString()).c_str());
    FILE* Filedesc;
    errno_t err=fopen_s(&Filedesc,Fname,"rb");
    if(Filedesc!=NULL) {
        qDebug()<<"\nfile opened ";
        fclose(Filedesc);
    } else if(err==22) {
        qDebug()<<"\nfail to open file error 22: Invalid argument";
        temp=QString(DIRPath+"/Temp"+QString::number(nb));
        Supported=false;
    } else qDebug()<<"\nfail to open file error"<<GetLastError()<<"errno"<<errno<<"strerrno"<<strerror(errno);
    Fname=NULL;
    free(Fname);
    ... 
```

我的问题是：谁能为我澄清 UNICODE/ANSI 的混淆？到目前为止我是安全的还是有更多的预防措施需要考虑？有没有更安全的方法来检查给定名称是否不是 ANSI？

提前感谢您，任何帮助将不胜感激。

**编辑 1**

我试过这个但徒劳无功：`CreateFile()`return an `INVALID_HANDLE_VALUE`and `GetLastError()`return 0

```
//WCHAR fname[]=L"D:/أحدالأنشطة.txt";
char* name="D:/أحدالأنشطة.txt";
wchar_t* nameW=(wchar_t*)malloc(sizeof(wchar_t)*17);
qDebug()<<"s :"<<mbstowcs(nameW,name,17);
//QString path=QString::fromWCharArray(fname,17);
//QString path=QString::fromLatin1(name,17);

HANDLE fileHandle = CreateFile(    nameW,                 // file to open
                                   GENERIC_READ,          // open for reading
                                   FILE_SHARE_READ,       // share for reading
                                   NULL,                  // default security
                                   OPEN_EXISTING,         // existing file only
                                   FILE_ATTRIBUTE_NORMAL, // normal file
                                   NULL);

if (fileHandle == INVALID_HANDLE_VALUE)
    {
      qDebug()<<"CreateFile failed!\n"<<GetLastError();
      nameW=NULL;
      free(nameW);
      return 2;
     }else
          qDebug()<<"CreateFile succeeded!\n";

int fd = _open_osfhandle((intptr_t) fileHandle, _O_RDONLY);
FILE* fstr = _fdopen(fd, "r");
QFile indirect;
if (!indirect.open(fstr, QIODevice::ReadOnly))
    qDebug()<<"QFile open against file descriptor failed!\n";
    else
        {
          qDebug()<<"QFile open against file descriptor succeeded!\n";                    
          indirect.close();
        }

// This will fail 
QFile direct(path);
if (!direct.open(QIODevice::ReadOnly))
    qDebug()<<"QFile open of filename directly failed!\n";
    else
    {
     qDebug()<<"QFile open of filename directly succeeded!\n"; 
     direct.close();
    }
   nameW=NULL;
   free(nameW); 
```

**编辑 2**

```
QString fname(QFile::decodeName("D:/أحدالأنشطة.txt"));
           QFile qFile(fname);

           bool b=qFile.open(QIODevice::ReadOnly);
           if(b)
           {
               FILE* filedesc = fdopen(qFile.handle(), "rb");
               if(filedesc!=NULL)
               {
                   char* nb=(char*)malloc(2*sizeof(char));
                   qDebug()<<"opened ";
                   size_t size=fread(nb,sizeof(char),2,filedesc);
                   fclose(filedesc);
                   qDebug()<<"filedesc closed size "<<size<<"nb "<<QString::fromAscii(nb,2);
                   nb=NULL;
                   free(nb);

               }else qDebug()<<"filedesc failed   error"<<strerror(errno);

            }else
                qDebug()<<"qFile failed   error"<<strerror(errno); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T16:03:48.353

您可能应该使用 QFile 打开文件，然后传递`QFile::handle()`给您的 C 函数。然后，在 C 代码中，您将使用将流与文件描述符`fdopen()`相关联。`FILE*`请注意，您使用的模式`fdopen()`应该与您使用的模式兼容`QFile::open()`。例如：

```
void c_func(int fd)
{
    FILE* file = fdopen(fd, "rb");
    // ...
} 
```

# android - 在 android 应用程序中使用预构建的 db4o 数据库

> ID：13357881
> 
> 赞同：0
> 
> 时间：2012-11-13T08:58:33.290
> 
> 标签：android, db4o

我真的很难让一个预烘焙的 db4o 数据库在我的 android 应用程序中工作。如果我将它包含在 /res/raw 文件夹中然后阅读它，它就不起作用。如果我将它复制到 app_data 或 sdcard 然后尝试读取它，它将就像我打开一个新数据库并为我提供 0 个查询条目。以前我只是在应用程序首次打开时创建所有条目，但随着数据库的增长，创建时间也达到了不可持续的水平。我真的非常感谢你能给我的任何帮助。如果我可以在应用程序中包含我预先填充的 db4o 文件，那将是完美的。附加信息：我已经用 ome 仔细检查了 db4o 文件，并且在我的本地计算机上创建 db 没有问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T08:40:32.913

如果有人和我落入同一个陷阱，答案是：

在 android 上，该类被注入到 db4o db 中，包名以默认的类名作为前缀。因此，从另一个应用程序访问将寻找 +。

# objective-c - 在 NSUserDefaults 之间切换

> ID：13357886
> 
> 赞同：1
> 
> 时间：2012-11-13T08:58:44.347
> 
> 标签：objective-c, ios, xcode

也许有人会知道，如何“标记”NSuserdefaults。

我有 10 个用户默认值：姓名密码等...

我想制作另一个对象，它与其他对象具有相同的默认值（相同的变量但不同的值）。像一个版本，如果`object == 1`然后加载一个用户默认值，如果`object == 0`另一个。但是如何实现呢？

试图做这样的事情

```
[NSUserDefaults setVersion:object.intValue]; 
```

但我想这不是这样做的方法。所以也许有人可以帮助如何完成它？

更具体地说，一个简单的例子将有助于如何做到这一点：

对象（1 或 0）

```
[[NSuserDefaults  standartUserDefaults] setObject: @"something"
                                                 forKey: @"Name"];
[[NSUserDefaults standartUserDefaults] synchronize];

NSString *name = [[NSUserDefaults standartUserDefaults] stringForKey:"@name"]; 
```

如何根据对象值设置和获取此名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:10:52.963

您可以使用持久域。

```
NSMutableDictionary *defaults = [[[NSUserDefaults standardUserDefaults] persistantDomainForName:@"aString"] mutableCopy];

// make changes to the dictionary here

[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:@"aString"];
[[NSUserDefaults standardUserDefaults] setPersistantDomain:defaults forName:@"aString"]; 
```

请注意，如果您这样做，您将需要通过字典访问所有默认值。

# jsf-2 - Omnifaces ValidateEqual 不执行验证

> ID：13357888
> 
> 赞同：1
> 
> 时间：2012-11-13T08:58:52.800
> 
> 标签：jsf-2, omnifaces

我正在尝试 Omnifaces 验证器，尤其是 validateEqual，所以我创建了一个这样的测试页面。

```
<p:messages autoUpdate="true" showDetail="false" />
<h:form id="registerForm" prependId="false">
    <p:panelGrid columns="2" styleClass="register-grid">

        <h:outputLabel for="password" value="Password *" />
        <p:inputText id="password" value="" label="Password"
            requiredMessage="Password is required" size="30">
            <f:validateRequired />
        </p:inputText>

        <h:outputLabel for="confirmPassword" value="Confirm Password *"
            requiredMessage="Confirm Password is required" />
        <p:inputText id="confirmPassword" value="" label="Confirm Password" requiredMessage="Confirm password is required"
            size="30">
            <f:validateRequired />
        </p:inputText>

        <o:validateEqual components="password confirmPassword" message="Passwords are not equal"/>

        <f:facet name="footer">
            <p:commandButton value="Register" action="/pages/public/login"/>
            <p:commandButton value="Cancel" immediate="true" action="/pages/public/login"/>
        </f:facet>
    </p:panelGrid>
</h:form> 
```

不确定，但什么都没有发生，我从下面的错误中看到了萤火虫。

```
<partial-response>
    <error>
        <error-name>class javax.faces.component.UpdateModelException</error-name>
        <error-message>/pages/public/register.xhtml @26,57 value="": Illegal Syntax for Set Operation</error-message>
    </error>
    <changes>
        <extension ln="primefaces" type="args">{"validationFailed":true}</extension>
    </changes>
</partial-response> 
```

可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:33:39.420

```
/pages/public/register.xhtml @26,57 value="": Illegal Syntax for Set Operation 
```

这基本上说明不可能对空值表达式执行“设置”操作（setter 方法调用）。

要么`value`完全删除该属性（至少从“确认”字段中删除），要么指定一个有效的值表达式，例如`value="#{bean.password}"`（至少对于第一个字段）。所以，基本上：

```
<p:inputText id="password" value="#{bean.password}" label="Password"
    requiredMessage="Password is required" size="30" required="true" />
<p:inputText id="confirmPassword" label="Confirm Password" 
    requiredMessage="Confirm password is required" size="30" required="true" />
<o:validateEqual components="password confirmPassword" 
    message="Passwords are not equal" /> 
```

这与使用无关`<o:validateEqual>`。不使用它时，您会遇到完全相同的问题。但是，您可能希望使用 OmniFaces[`FullAjaxExceptionHandler`](http://showcase.omnifaces.org/exceptionhandlers/FullAjaxExceptionHandler)在 ajax 请求期间获得有关异常的真正错误页面，而不是完全缺乏视觉反馈。

# heroku - 如何廉价地处理大量数据（本地设置或云）？

> ID：13357899
> 
> 赞同：2
> 
> 时间：2012-11-13T09:00:13.837
> 
> 标签：heroku, nlp, cloud, scaling, bigdata

我想尝试针对网络和其他语料库的转储（有时大于 4 TB）测试 NLP 工具。

如果我在mac上运行它会很慢。加快此过程的最佳方法是什么？

*   部署到 EC2/Heroku 并扩展服务器
*   购买硬件并创建本地设置

只是想知道这通常是如何完成的（在几分钟/几秒内处理 TB），如果在云中进行试验是否更便宜/更好，还是我需要自己的硬件设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:18:24.933

不管你的云是什么品牌，云计算的整体理念是能够以灵活的方式扩大和缩小规模。

在企业环境中，您可能会遇到始终需要相同数量的计算资源的场景，因此，如果您已经拥有它们，那么使用云将是相当困难的情况，因为您只是不需要提供的灵活性。

另一方面，如果您的处理任务不太可预测，那么最好的解决方案是云，因为当您使用更多计算能力时，您将能够支付更多费用，而当您不需要那么多计算能力时支付更少费用。

但请注意，并非所有云解决方案都是相同的，例如，Web 角色是一个高度专注于 Web 的节点，其主要目的是为 Web 请求提供服务，服务的请求越多，您支付的费用就越多。

而在虚拟角色中，几乎就像您获得了计算机系统的排他性，您可以将其用于任何您想要的东西，无论是 linux 还是 windows 操作系统，即使您没有以最佳状态使用它，系统也会继续运行。

总体而言，成本取决于您自己的方案以及它与您的需求的匹配程度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:17:23.337

我想这在很大程度上取决于你想做什么样的实验，目的是什么，持续多长时间。

如果您正在考虑购买硬件并运行自己的集群，那么您可能需要 Hadoop 或 Storm 之类的东西来管理计算节点。我不知道在几秒钟内处理 4TB 的数据有多可行，但这真的取决于您想要进行的处理类型。计算 4TB 语料库中单词的频率应该很容易（甚至是你的 mac），但是构建 SVM 或在地段上做类似 LDA 之类的事情就不会了。您将遇到的一个问题是您没有足够的内存来容纳所有这些，因此您需要一个可以从磁盘运行方法的库。

如果您不确切知道您的要求是什么，那么我将使用 EC2 设置一个测试台，以更好地了解您想要做什么以及需要在一段时间内完成多少 grunt/memory你需要。

我们最近购买了两个计算节点，每个节点有 128 个内核，每个内核都有 256Gb 的内存和几 TB 的磁盘空间，我认为它大约是 2 万英镑左右。这些是 AMD interlagos 机器。也就是说，计算集群已经有无限带宽存储，所以我们只需要连接到那个，只需购买两个计算节点，而不是整个基础设施。

这里要做的显而易见的事情是从较小的数据集开始，比如几千兆字节。这将使您开始使用您的 Mac，您可以尝试使用数据和不同的方法来了解哪些有效，哪些无效，然后将您的管道移动到云端，并使用更多数据运行它。如果您不想从单个样本开始实验，您始终可以从完整语料库的不同部分获取多个样本，只需将样本大小保持在您可以在自己的工作站上管理的范围内即可。

顺便说一句，我强烈推荐 GitHub 上的[scikit-learn](http://github.com/scikit-learn)项目用于机器学习。它是用 Python 编写的，但大多数矩阵运算都是在 Fortran 或 C 库中完成的，因此速度非常快。开发者社区对该项目也非常活跃。另一个可能更平易近人（取决于您的专业水平）的好库是[NLTK](http://nltk.org/)。如果您不熟悉将所有内容都视为矩阵，那么它远没有那么快，但更有意义。

**更新**

我忘记提到的一件事是您的项目将运行的时间。或者换一种说法，您将在多长时间内使用您的专业硬件。如果这是一个应该在未来 10 年为欧盟议会服务的项目，那么你绝对应该购买硬件。如果这是一个让您熟悉 NLP 的项目，那么花钱可能有点多余，除非您还计划开始自己的云计算租赁服务:)。

也就是说，我不知道使用 EC2 的实际成本是多少。我从来没有使用过它们。

# android - EditText 最大字符限制超出回调

> ID：13357904
> 
> 赞同：4
> 
> 时间：2012-11-13T09:00:47.320
> 
> 标签：android, android-edittext

我的想法是在达到最大字符限制时`View`设置一个错误。`EditText`有没有关于这个事件的回调，或者可能有另一种方法来实现这个效果？提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T09:05:59.420

EditText 中的 maxLength 属性实际上是一个 InputFilter，您可以自己编写并从代码中提供。

可以看InputFilter.LengthFilter的实现，基本没有溢出就返回null。（见[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.1.1_r1/android/text/InputFilter.java#InputFilter.LengthFilter.filter%28java。 lang.CharSequence%2Cint%2Cint%2Candroid.text.Spanned%2Cint%2Cint%29](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/5.1.1_r1/android/text/InputFilter.java#InputFilter.LengthFilter.filter%28java.lang.CharSequence%2Cint%2Cint%2Candroid.text.Spanned%2Cint%2Cint%29) )

您可以为 InputFilter.LengthFilter 创建一个扩展，在其中调用 super 并将其与 null 进行比较以确定是否需要显示警报。

## 编辑 - 带代码

```
editText.setInputFilters(new InputFilter[] {
    new InputFilter.LengthFilter(max) {
        public CharSequence filter(CharSequence source, int start, int end, Spanned dest, int dstart, int dend) {
            CharSequence res = super.filter(source, start, end, dest, dstart, dend);
            if (res != null) { // Overflow
                editText.setError("Overflow");
            }
            return res;
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-13T09:03:51.150

您可以使用编辑文本的[`setError`](http://developer.android.com/reference/android/widget/TextView.html#setError%28java.lang.CharSequence%29)：

```
editText.addTextChangedListener(new TextWatcher() {         
        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }

        @Override
        public void afterTextChanged(Editable s) {
            if(s.length() > max)
                editText.setError("Error");
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T09:04:45.303

我认为最好的解决方案是使用[TextChangedListener](http://developer.android.com/reference/android/widget/TextView.html#addTextChangedListener%28android.text.TextWatcher%29)并检查 EditText 测试的长度与您的限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-05T10:23:08.753

谢谢但是-

```
editText.setFilters() not editText.setInputFilters() 
```

# c# - 如何使用 C# 向 SQL Server 插入/更新行

> ID：13357905
> 
> 赞同：1
> 
> 时间：2012-11-13T09:00:57.613
> 
> 标签：c#, .net, sql, sql-server, asp-classic

我正在忙着将旧的经典 asp 网站转换为 .NET 网站。我现在也在使用 SQL Server。

现在我有一些旧代码

```
strsql = "select * FROM tabel WHERE ID = " & strID & " AND userid = " & struserid 
rs1.open strsql, strCon, 2, 3

if rs1.eof THEN
   rs1.addnew
end if

if straantal <> 0 THEN
   rs1("userid") = struserid
   rs1("verlangid") = strID
   rs1("aantal") = straantal
end if

rs1.update
rs1.close 
```

我想在 SQL Server 中使用它。更新方式。我怎样才能做到这一点？

*   如何检查数据读取器是否为 EOF/EOL
*   如何插入一个行 id 它是 EOF/EOL
*   如何使用一个函数更新一行或删除一行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:13:21.900

如果你想使用原始 SQL 命令，你可以尝试这样的事情

```
using (SqlConnection cnn = new SqlConnection(_connectionString))
using (SqlCommand cmd = new SqlCommand())
{
    cnn.Open();
    cmd.Connection = cnn;

    // Example of reading with SqlDataReader
    cmd.CommandText = "select sql query here";

    using (SqlDataReader reader = cmd.ExecuteReader())
    {
        while (reader.Read())
        {
            myList.Add((int)reader[0]);
        }
    }

    // Example of updating row
    cmd.CommandText = "update sql query here";

    cmd.ExecuteNonQuery();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:07:24.313

这取决于您使用的方法...您打算使用实体框架和 LINQ 吗？你打算使用直接的 SQL 连接吗？我强烈建议沿着 EF 路线走，但一个简单的直接 SQL 片段看起来像：

```
using (var connection = new SqlConnection("Your connection string here"))
{
    connection.Open();
    using (var command = new SqlCommand("SELECT * FROM xyz ETC", connection))
    {                
        // Process results
        using (SqlDataReader reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                int userId = (int)reader["UserID"];
                string somethingElse = (string)reader["AnotherField"];
                // Etc, etc...
            }
        }
    }

    // To execute a query (INSERT, UPDATE, DELETE etc)
    using (var commandExec = new SqlCommand("DELETE * FROM xyz ETC", connection))
    {
        commandExec.ExecuteNonQuery();
    }
} 
```

您会注意到**using**中包含的各种元素，这是因为您需要在完成后释放内存/连接。这应该很快回答你的问题，但正如其他人（包括我）所建议的那样，我会调查实体框架，因为它更强大但有一个学习曲线！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T12:31:28.317

您可以使用 SQL 存储过程进行更新。并通过 C# 调用此存储过程。

创建过程 [dbo].[xyz_Update] (@para1 @para2) AS BEGIN 更新表名 Set Fieldname1=@para1, Set Feildname2=@para2

结尾

# java - 用java将视频上传到youtube

> ID：13357906
> 
> 赞同：4
> 
> 时间：2012-11-13T09:01:04.347
> 
> 标签：java, jsp, servlets, youtube-api

我的本地磁盘中有一个视频，我想通过我的应用程序将其上传到 youtube。你能给我遵循同样的指导方针吗？请给我执行该操作的步骤或代码或链接。提前致谢。

在提出解决方案后，我尝试使用：gdata.youtube.com/feeds/api/users/users/uploads（用户作为用户名），但我收到 IOException.ie 与服务通信时出现问题。

```
 java.net.SocketException: Connection reset
 java.net.SocketInputStream.read(SocketInputStream.java:189)
        at java.net.SocketInputStream.read(SocketInputStream.java:121)
        at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
        at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)
        at java.io.BufferedInputStream.read(BufferedInputStream.java:334)
        at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:641)
        at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:589)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1319)
        at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:468)
        at com.google.gdata.client.http.HttpGDataRequest.checkResponse(HttpGDataRequest.java:490)
        at com.google.gdata.client.http.HttpGDataRequest.execute(HttpGDataRequest.java:470)
        at com.google.gdata.client.http.GoogleGDataRequest.execute(GoogleGDataRequest.java:534)
        at com.google.gdata.client.media.MediaService.insert(MediaService.java:353)
        at ytupload.YouTubeWriteClient.uploadVideo(YouTubeWriteClient.java:508)
        at ytupload.YouTubeWriteClient.main(YouTubeWriteClient.java:828) 
```

请帮忙...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T09:05:57.537

你检查了谷歌开发者指南上的[Youtube API ，检查了](https://developers.google.com/youtube/2.0/developers_guide_java)[视频上传](https://developers.google.com/youtube/2.0/developers_guide_java#Uploading_Videos)部分吗？你会发现这样的东西：

```
VideoEntry newEntry = new VideoEntry();

YouTubeMediaGroup mg = newEntry.getOrCreateMediaGroup();
mg.setTitle(new MediaTitle());
mg.getTitle().setPlainTextContent("My Test Movie");
mg.addCategory(new MediaCategory(YouTubeNamespace.CATEGORY_SCHEME, "Autos"));
mg.setKeywords(new MediaKeywords());
mg.getKeywords().addKeyword("cars");
mg.getKeywords().addKeyword("funny");
mg.setDescription(new MediaDescription());
mg.getDescription().setPlainTextContent("My description");
mg.setPrivate(false);
mg.addCategory(new MediaCategory(YouTubeNamespace.DEVELOPER_TAG_SCHEME, "mydevtag"));
mg.addCategory(new MediaCategory(YouTubeNamespace.DEVELOPER_TAG_SCHEME, "anotherdevtag"));

newEntry.setGeoCoordinates(new GeoRssWhere(37.0,-122.0));
// alternatively, one could specify just a descriptive string
// newEntry.setLocation("Mountain View, CA");

MediaFileSource ms = new MediaFileSource(new File("file.mov"), "video/quicktime");
newEntry.setMediaSource(ms);

String uploadUrl =
  "http://uploads.gdata.youtube.com/feeds/api/users/default/uploads";

VideoEntry createdEntry = service.insert(new URL(uploadUrl), newEntry); 
```

在上传视频之前，您可能会成功验证：

```
YouTubeService service = new YouTubeService(clientID, developer_key); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:06:57.660

您必须创建一个新`VideoEntry`对象

以下代码上传视频：

```
VideoEntry newEntry = new VideoEntry();

YouTubeMediaGroup mg = newEntry.getOrCreateMediaGroup();
mg.setTitle(new MediaTitle());
mg.getTitle().setPlainTextContent("Title goes here");
mg.addCategory(new MediaCategory(YouTubeNamespace.CATEGORY_SCHEME, "Autos"));
mg.setKeywords(new MediaKeywords());
mg.getKeywords().addKeyword("keyword-here");
mg.setDescription(new MediaDescription());
mg.getDescription().setPlainTextContent("My description");
mg.setPrivate(false);
mg.addCategory(new MediaCategory(YouTubeNamespace.DEVELOPER_TAG_SCHEME, "mydevtag"));
mg.addCategory(new MediaCategory(YouTubeNamespace.DEVELOPER_TAG_SCHEME, "anotherdevtag"));

newEntry.setGeoCoordinates(new GeoRssWhere(37.0,-122.0));
// alternatively, one could specify just a descriptive string
// newEntry.setLocation("Mountain View, CA");

MediaFileSource ms = new MediaFileSource(new File("file.mov"), "video/quicktime");
newEntry.setMediaSource(ms);

String uploadUrl =
"http://uploads.gdata.youtube.com/feeds/api/users/default/uploads";

VideoEntry createdEntry = service.insert(new URL(uploadUrl), newEntry); 
```

请参阅[https://developers.google.com/youtube/2.0/developers_guide_java#Uploading_Videos](https://developers.google.com/youtube/2.0/developers_guide_java#Uploading_Videos)

# iphone - 限制我的 iPad 模拟器的网络速度

> ID：13357907
> 
> 赞同：0
> 
> 时间：2012-11-13T09:01:14.517
> 
> 标签：iphone

我想在 iPad 模拟器上测试我的应用程序在所有网络速度的情况下，所以我想知道如何限制我的模拟器的网络速度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:04:30.723

使用 Network Link Conditioner，它适用于 Mac OS Lion 及更高版本

请参阅此链接[http://mattgemmell.com/2011/07/25/network-link-conditioner-in-lion/](http://mattgemmell.com/2011/07/25/network-link-conditioner-in-lion/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T11:00:00.873

我将 SpeedLimit 用于 MAC [SpeedLimit 链接](http://the.taoofmac.com/space/apps/SpeedLimit)

# c# - 在 Canvas 中拖放后获取 TextBox 的值

> ID：13357920
> 
> 赞同：1
> 
> 时间：2012-11-13T09:02:04.310
> 
> 标签：c#, wpf, visual-studio-2010, wpf-controls

我有一个允许您绘制活动图的应用程序，我需要从该图中生成一个算法。

我的问题是如何在拖放后获取文本框的值？

这是我在按钮中编写的代码：

```
private void generat_algo(object sender, ExecutedRoutedEventArgs e)
    {
        {
           IEnumerable<DesignerItem> designerItems = this.Children.OfType<DesignerItem>();
           IEnumerable<Connection> connections = this.Children.OfType<Connection>(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:37:55.743

If you only have one textbox then just access the textbox by name:

```
textbox1.Text 
```

Or, if you need to support multiple textboxes then you can simply get the text when the drag/drop is complete. Just handle the Drop event and check if it is a textbox that was moved:

```
private void Canvas_Drop(object sender, DragEventArgs e)
{
    bool itemIsTextbox = (e.Data.GetDataPresent(typeof(TextBox)) == true);

    //get the textbox then get hte text out of it
    if (itemIsTextbox)
        string text = (TextBox)e.Data.GetData(typeof(TextBox)).Text;
} 
```

# c - 使用二维数组的 malloc 和 strtok

> ID：13357921
> 
> 赞同：1
> 
> 时间：2012-11-13T09:02:06.743
> 
> 标签：c, segmentation-fault, malloc, strtok

该程序应该采用`num`二维数组的数组（在文件中）和名称（第一，最后，初始）。但是我不断收到段错误，我不知道为什么。我所做的是分配内存，然后用于`fscanf`获取行数并`fgets`获取名称，同时将所有更改`'\n'`为`'\0'`. 然后，我使用`strtok`将单独的数组放入令牌中，我相信我可能在某个地方出错。

编辑：现在我正在传递 'strcpy' 的参数 1 使指针从整数而不进行强制转换。我要怎么修

这是我的代码：

```
int main (int argc, char *argv[])
{
   int num;
   FILE *fp;
   fp = fopen(argv[1], "r");

   fscanf(fp, "%d", &num);

   int j;
   char **f, **l, *m;
   int i = 0;

   f = (char**) malloc(num * sizeof (char*))

   for (i = 0; i < num;i++)
       ;
   f[i] = (char*) malloc(num * sizeof (char));
   l = (char**)malloc(num*sizeof(char*));

   for (i=0; i<num;i++)

   l[i] = (char*) malloc(num * sizeof (char));

   m = (char*) malloc(num*sizeof(char));

   read_names(fp, f, l, m, num);

//  sort(fp, num, f, l, m);
//  display(num, ar);

   for (j = 0; j < num; j++) {
       free(f[j]);
       free(l[j]); 
   }

   free(f);
   free(l);
   free(m);
   fclose(fp);

   return(0);
}

     void read_names (FILE *fp, char **f, char **l, char m,int num)
     {
     int i=0;

    char temp[80];

    for (i=0; i<num; i++)
    {  fgets(temp, 80,fp );
    char *ptr=strtok (temp,"," );
    strcpy(*f[i], ptr);
    char *ptr1=strtok (temp, " ");
    strcpy(*l[i], ptr1);
    char *ptr2=strtok (temp, ". ");
    strcpy(m[i],ptr2);
}

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:38:30.003

你的 for 循环有问题。不是用分号封闭它们下面的行，而是用分号终止 for() 循环。去掉分号，或者更好，养成经常使用`{`and的习惯，`}`你就不会再遇到这个问题了。

编辑：如果你正确缩进你的代码，你可能已经发现了错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T09:34:19.990

```
f=(char**)malloc (num*sizeof(char*));
for (i=0; i<num;i++);
f[i]=(char*)malloc (num*sizeof(char));

l=(char**)malloc (num*sizeof(char*));
for (i=0; i<num;i++);
l[i]=(char*)malloc (num*sizeof(char));

m=(char*)malloc (num*sizeof(char)); 
```

您应该确保 f,f[i],l,l[i] 不为 NULL。

# windows-8 - 打包 Windows 8 应用程序数据文件

> ID：13357924
> 
> 赞同：0
> 
> 时间：2012-11-13T09:02:21.440
> 
> 标签：windows-8, windows-runtime

我正在开发一个 Win 8 应用程序，我想在应用程序中包含一个数据文件。每个用户的数据文件都是唯一的，因此它应该真正位于 /Users/(user)/AppData/Packages/(MyAppPackage) 下

是否可以使用部署/安装包来做到这一点，如果可以，怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:57:01.657

据我所知，CMIIW，

您不能包含您的包中的数据文件，除非您将数据文件放在应用程序目录/安装目录中，然后在第一次运行后，您可以将它（数据文件）移动到 /Users/(user)/AppData

我相信您不会将敏感数据保存到 Users/(user)/AppData，因为用户可以通过 Windows Explorer 轻松访问该文件夹，或者如果您必须将其保存到 AppData，我建议您先加密您的数据。

干杯 Yusak Setiawan [http://apptivate.ms/apps/1271/mathboard](http://apptivate.ms/apps/1271/mathboard)

# ajax - jquery mobile ajax从对话框提交

> ID：13357925
> 
> 赞同：0
> 
> 时间：2012-11-13T09:02:34.653
> 
> 标签：ajax, html, jquery-mobile

我有在普通 jquery 移动页面上工作的 ajax 表单，但是当我在对话框上传输它时它不起作用。我的脚本没有读取 w/c 设置的点击事件，默认情况下它会在同一页面上发送所有值，这是错误的。我错过了什么吗？任何想法？提前致谢。

值正在发送到此 url，这是错误的：

```
http://localhost/MyFolder/views/maintenance/RegionAdd.html?triggerActivity=region&triggerAction=add&regionDesc=test&area=test222 
```

代替：

```
http://localhost/MyFolder/model/maintenance/maintenance_process.php?triggerActivity=region&triggerAction=add&regionDesc=test&area=test222 
```

请参阅下面的脚本。

JS：（位于 RegionAdd.html 上）

```
$(document).bind("pageinit", function(){
    $("#submit-region").click(function(){
        //var regionDesc = $("#regionDesc").val();
        //console.log(regionDesc);
        var formData = $("#ajaxForm").serialize();
        $.ajax({
             type: "GET",
             url: "../../model/maintenance_process.php",
             cache: false,
             data: formData,
             success: onSuccess
        });
            //e.preventDefault();
    });
}); 
```

HTML5：（位于 RegionAdd.html 上）

```
<body>
    <div data-role="page">
        <form id='ajaxForm'>
            <div data-role="header">
                <h1>Add Region</h1>
                <button type='submit' data-theme="a" data-icon="check" data-mini="true" id="submit-region">Save</button>
            </div><!-- /header -->

            <div data-role="content">
                <div class="content-primary">
                    <input type="hidden" name="triggerActivity" id="triggerActivity" value="region"  />
                    <input type="hidden" name="triggerAction" id="triggerAction" value="add"  />
                    <ul data-role="listview">
                        <li data-role="fieldcontain">
                            <label for="regionDesc">Region</label>
                            <input type="text" name="regionDesc" id="regionDesc" value=""  />
                        </li>
                        <li data-role="fieldcontain">
                            <label for="area">Area</label>
                            <input type="text" name="area" id="area" value=""  />
                        </li>
                    </ul>
                    <h4 id="message"></h4>
                </div>
            </div><!-- /content -->
        </form>
    </div><!-- /page --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T10:57:11.180

尽管您进行了绑定，但看起来表单正在以默认方式提交。

你可以尝试这样的事情：

```
$("form.ajaxForm").live("submit", handleForm); 
```

并在 handleForm 函数上实现您的 ajax 调用。

# php - 在php的范围内四舍五入到最接近的5的倍数

> ID：13357928
> 
> 赞同：0
> 
> 时间：2012-11-13T09:02:47.437
> 
> 标签：php, if-statement, get, integer, rounding

我有这个 if 语句：

```
if($_GET["angle_1"] > 39) {
    $markers["###ANGLE###"] = "45"; 
} elseif($_GET["angle_1"] > 29 && $_GET["angle_1"] < 40) { 
    $markers["###ANGLE###"] = "35"; 
} elseif($_GET["angle_1"] < 30) {
     $markers["###ANGLE###"] = "25"; 
} else { 
     $markers["###ANGLE###"] = "45"; 
} 
```

有没有更好/更简单的方法来做这个检查，fx with round 会将整数四舍五入到最接近的 5，即 28 -> 25 或 34 -> 35 等，如果整数小于 25，它将始终为 25，如果整数大于 45，则始终为 45，如果整数在 30 和 40 之间，则始终为 35。

该返回值将用于显示图像。

编辑：

我有 3 张图片：image_25、image_35 和 image_45，因此需要四舍五入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T09:06:38.513

假设`$x`有数字：

```
$x = 39; 
```

如果你想要最接近 5 的倍数（39 --> 40）：

```
$x = round($x / 5) * 5; 
```

如果你想四舍五入（36 --> 40）：

```
$x = ceil($x / 5) * 5; 
```

如果你想向下取整（39 --> 35）：

```
$x = floor($x / 5) * 5; 
```

定义后`$x`，您可以使用以下内容确保其在 25-45 范围内：

```
$x = ($x > 45) ? 45 : ($x < 25) ? 25 : $x; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T09:05:46.790

试试这个：

```
$var = 5 * round($n / 5); 
```

取自[这里](https://stackoverflow.com/questions/12913353/round-integer-to-nearest-multiple-of-5-in-php)

# playframework - websocket中的HTTP重定向（播放框架）

> ID：13357932
> 
> 赞同：1
> 
> 时间：2012-11-13T09:03:21.603
> 
> 标签：playframework, websocket, playframework-2.0

我正在按照以下教程构建 websocket：[http ://blueprintforge.com/blog/2012/02/13/websockets-in-play-2-dot-0](http://blueprintforge.com/blog/2012/02/13/websockets-in-play-2-dot-0)

这个对我有用。但是，我想使用 websocket 来显示表单提交/作业的进度。在我的工作完成运行后，我想将用户重定向到一个静态 url。

在play框架中，可以返回

```
WebSocket<String> 
```

代替

```
Result 
```

但是结果会让你通过返回 redirect('www.domain.com/job8273') 来重定向

这可以使用 websockets 重定向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T09:28:35.720

您可以获得上传完成的消息并使用 JavaScript 重定向：

```
websocket.onmessage = function(evt){
    if(evt.data=="finished") 
      window.location.href = 'www.domain.com/job8273';
} 
```

# c# - 通过注册表启用后找到 U盘

> ID：13357940
> 
> 赞同：0
> 
> 时间：2012-11-13T09:04:18.627
> 
> 标签：c#, registry, usb

我正在尝试找到一种以编程方式启用和禁用计算机上的 USB 大容量存储设备的好方法，更具体地说是它使用的端口。我希望只有在执行特定导出功能时才能访问 USB 驱动器。我们的安全要求非常严格，因此我们不希望将 USB 中的程序传输到计算机或运行。

拥有 USB 功能总是有风险的，我们永远不能指望完全安全，但我们希望将攻击的可能性降到最低。

我尝试将 USBSTOR 的 reg 键值设置为 4： `Microsoft.Win32.Registry.SetValue(@"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR", "Start", 4, Microsoft.Win32.RegistryValueKind.DWord);`

这会禁用 USB 设备，使其不会在 USB 驱动器插入插槽后自动加载。现在，当我将其重新“打开”时： `Microsoft.Win32.Registry.SetValue(@"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR", "Start", 3, Microsoft.Win32.RegistryValueKind.DWord);`

如果 USB 设备已插入插槽，则不会自动加载它。只有在新插入的情况下才会加载它。

打开此注册表项后，有什么方法可以强制扫描并查找 USB 设备？

或者是否有另一种方式以编程方式启用/禁用我的 USB 端口？

我研究过`LibUsbDotNet`，但它似乎使用硬件 ID，但问题是这些 ID 对于不同的 USB 驱动器是不同的，我想支持它们。如果可能的话，我想在端口级别切换访问，而不是在实际驱动器级别。

有什么建议吗？

**编辑**：我找到了港口的“位置”，它是`Port_#0004.Hub_#0008`，我能用这个信息做些什么吗？

**Edit2**：我找到了我的 USB 驱动器的“父”，它是一个 USB 根集线器。启用和禁用它有一个预期的效果，现在来了解如何通过代码来做到这一点。

# asp.net-mvc - signalR 未找到元素错误消息

> ID：13357944
> 
> 赞同：0
> 
> 时间：2012-11-13T09:04:42.153
> 
> 标签：asp.net-mvc, asp.net-mvc-3, signalr, signalr-hub, signalr.client

在包含 signalR 的页面上，我在 firebug 中收到以下错误：

```
http://localhost:53604/signalr/signalr/negotiate?_=1352797361490
no element found 
```

一切仍然正常，但只是想看看这是否会成为一个问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T01:16:18.690

由于您使用的是 Firebug，这意味着您使用的是 Firefox。你使用的是什么传输（如果使用 Fiddler 记得打开 Streaming）？应该是： 1\. 长轮询 2\. 服务器发送事件 3\. WebSockets

如果传输是长轮询，那么我们可能在底层代码中存在问题（Firefox 应该在 LP 之前优先考虑 WebSockets/SSE）。

但是，如果不是，那么我们就有一个基于内容的问题。话虽如此，您从服务器检索什么类型的数据？通常，未找到元素错误来自无效标记。

尝试剥离应用程序的所有部分，看看是否仍然出现此错误。AKA 只是一个 $.connection.hub.start()。

# ios - iOS会自动处理http缓存吗？

> ID：13357949
> 
> 赞同：0
> 
> 时间：2012-11-13T09:05:14.093
> 
> 标签：ios, http

我们的 iOS 开发人员使用自定义缓存来处理 HTTP 图像请求。

但据我所知，HTTP 协议有它自己的缓存控制。但是我无法说服客户团队，他们说网络传输太多了。

那么，iOS http 层是否支持 HTTP 缓存头？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:53:23.753

不，您不能直接依赖于图像，特别是如果您希望缓存在应用程序启动时持续存在等。您最好使用提供缓存选项和图像添加的网络框架：

*   AFNetworking 提供了方便的 UIImageView 添加（setImageURL：在 UIImageView 上，具有占位符支持等）。

*   MKNetworkKit

# algorithm - 魔方扫描算法

> ID：13357951
> 
> 赞同：1
> 
> 时间：2012-11-13T09:05:18.937
> 
> 标签：algorithm, augmented-reality, scanning, rubiks-cube

我正在开发一个增强现实魔方解决方案。我们希望用户能够使用智能手机应用程序来收集解决魔方的提示。

为此，我们需要在智能手机内存中重建立方体。我们无法找到仅扫描魔方一侧即可重建魔方的扫描算法。

有人知道可以做到这一点的魔方扫描算法吗，或者至少可以提及该算法在数学上是否可行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:21:57.837

仅扫描一侧后，您无法推断出立方体的位置**。**大多数求解器扫描所有 6 个面，但是，您可能只扫描其中的 5 个而侥幸逃脱，但我真的对此表示怀疑。

换句话说，您只需要 5 次扫描即可证明立方体已完全解决。不确定 5 次扫描是否为您提供了足够的信息来重新创建任何随机立方体位置的完整状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T09:21:00.393

您可能想检查它以抓取扫描图片中的所有边缘。

[http://www.codeproject.com/Articles/93642/Canny-Edge-Detection-in-C](http://www.codeproject.com/Articles/93642/Canny-Edge-Detection-in-C)

这是使用矩阵的霍夫变换解决的问题。

另一方面，您必须比较这两个图像以检测每个字段的颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-19T08:32:09.250

我不知道什么是立方体扫描算法。但是您在谈论找到立方体的算法是否已解决？

要检查这一点，您需要扫描 6 个立方体的四个侧面（仅适用于 3 x 3 立方体）甚至，您必须选择 4 个侧面，就像剩余的 2 个侧面必须彼此并排一样。（其余侧面应该' t彼此相反）

因为我也是cuber。并且从 5 年开始做立方体。我可以向您保证上述扫描是最佳的。

# c++ - c++11中正则表达式的使用

> ID：13357953
> 
> 赞同：0
> 
> 时间：2012-11-13T09:05:22.197
> 
> 标签：c++, regex

我正在使用VS2010。

我有正则表达式的问题

我应该使用什么正则表达式来搜索字符串

```
std::string foo("s:{foo} s1:{bar}"); 
```

单词 foo、bar 并且可能知道它们的位置。

我以为像

```
std::regex r("\\{.*\\}"); 
```

应该管用。但事实并非如此。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:28:42.263

对于字符串`s:{foo} s1:{bar}`

`{.*}`会匹配`{foo} s1:{bar}`

`.*`**贪婪地**匹配，在你的情况下它会匹配到**最后一个** `}`

* * *

`{.*?}`会匹配`{foo}`，并且在下一场比赛中会匹配`{bar}`

`.*?`**懒惰地**匹配，在你的情况下它会匹配到第**一个** `}`

# c# - 按子集合中的属性对父实体进行排序

> ID：13357961
> 
> 赞同：3
> 
> 时间：2012-11-13T09:06:31.430
> 
> 标签：c#, linq, linq-to-sql

我有以下课程：

```
public class Order
{
     public int Oid {get; set;}
     public DateTime OrderDate {get; set;}
     public List<OrderDetails> OrderDetails {get; set;}     
}

public class OrderDetail
{
     public int Oid {get; set;}
     public int Price {get; set;} 
     public Order Order {get; set;}     
     public EventSchedule EventSchedule {get; set;}            
}

public class EventSchedule
{
     public int Oid {get; set;}                 
     public BaseEvent BaseEvent {get; set;}     
     public List<OrderDetail> OrderDetails {get; set;}           
}  

public class BaseEvent
{
     public int Oid {get; set;}  
     public string Name {get; set;}               
     public List<EventSchedule> EventSchedules {get; set;}
} 
```

我有以下代码：

```
var result = Database.Orders.Where(o => o.DateTime == dateTime); 
```

现在，我想对`result`：

```
case "Date":
       result = (sortingOrder == "desc") ? result.OrderByDescending(c => c.OrderDate) : result.OrderBy(c => c.OrderDate);
       break;

 // the problem is here this code not works
case "EventName":
      result = (sortingOrder == "desc") ? result.All(o=>o.OrderDetails.OrderBy(d=>d.EventSchedule.BaseEvent.Name)) : ...;
      break; 
```

有`Order`一个集合`OrderDetail`。`OrderDetail`有`EventSchedule`。而且，`EventSchedule`有`BaseEvent`。这可以按属性对`Order`对象进行排序？ `Name``BaseEvent`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T09:21:03.663

那这个呢

```
case "EventName":
    result = results.OrderBy(
        r => r.OrderDetails.Select(
            od => od.EventSchedule.BaseEvent.Name).Distinct().FirstOrDefault());
//... 
```

# javascript - 使用下拉菜单动态更新谷歌图表

> ID：13357962
> 
> 赞同：0
> 
> 时间：2012-11-13T09:06:33.683
> 
> 标签：javascript, jquery, asp.net, google-visualization

我正在尝试使用 Bortosky Library 使用谷歌图表（可视化 api）从数据库中绘制一组数据

[http://code.google.com/p/bortosky-google-visualization/](http://code.google.com/p/bortosky-google-visualization/)

将 ASP.NET 数据表转换为 Google 数据表。我希望用户使用下拉菜单选择应该从数据库中检索的数据表。我读过一个解决方案

[使用 ajax 和 php 在下拉列表中动态更新谷歌图表](https://stackoverflow.com/questions/13100390/updating-google-chart-dynamically-on-dropdown-using-ajax-and-php)

但我不知道 AJAX 或 PHP 可以做到这一点。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:25:25.793

我在 youtube 上制作了一个视频，并在此网站上向其他用户回答了您的具体问题。让我知道这是否是您正在寻找的。 [将数组从 vb 代码隐藏到 javascript 数据表中](https://stackoverflow.com/questions/13333664/putting-array-from-vb-codebehind-into-javascript-datatable/13333744#13333744)

# c# - 使用计时器每小时运行一次 if 语句

> ID：13357964
> 
> 赞同：1
> 
> 时间：2012-11-13T09:06:40.250
> 
> 标签：c#, asp.net, asp.net-mvc-3, timer

我一直在阅读有关计时器的负载，以及实现目标的选项，我相信我需要使用 system.timers.timer 并正确设置间隔。

我想我知道该怎么做，但我不确定在哪里做，在我看来，我的控制器 global.asax 是否这样做？

也许我根本不应该使用计时器？

我正在寻找的是每小时运行 if 语句的最佳方式，每小时，并根据 if 的结果更新视图

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T09:18:26.540

通常，Web 应用程序（MVC 或 WebForms）并不是运行计划任务的最佳场所。可以做到，但你会得到诸如 IIS 回收应用程序池和其他异常的东西，虽然这对 Web 应用程序很有用，但可能会妨碍可靠地调度任务。

许多开发人员（也是我最喜欢的）在[Windows 服务](http://www.codeproject.com/Articles/3990/Simple-Windows-Service-Sample)中安排他们的任务。这可以安装并且可以设置为在服务器启动和关闭时优雅地启动和停止。然后，您可以设置日志记录和其他运行状况监控来监控调度程序服务的状态。

但是，如果您的任务是纯基于 SQL 的，您可能希望使用 SQL Server 的内置调度（或类似的任何其他数据库）。另一种选择是使用操作系统的调度程序。

**编辑**

关于使用结果更新视图，您可以使用“TaskStatus”（新建、等待、正在运行、已中止、失败、已取消、已完成）和“TaskResult”等列在数据库中存储和更新计划任务的状态（可能为空表示成功或失败的错误消息）。然后，您可以通过从数据库中检索这些信息来在结果视图中显示和过滤这些信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T09:34:46.853

`JavaScript - On Your Page:` 您可以通过 JavaScript 重定向到您需要的功能的控制器 > 操作：

```
<script type="text/JavaScript">
setTimeout("location.href = '/YourDefineUrlPathHere';",1500);
</script> 
```

`HTML Meta tag - On Your Page:` 其他是如果你想再次调用你的视图操作，你可以通过元标记来完成（换句话说，刷新它）

```
<head>
<meta http-equiv="Refresh" content="15;url='/YourDefineUrlPathHere'"> 
<!—‘15’ is number of seconds you want to wait-- >
</head> 
```

`Timers – in your controller`

```
aTimer = new System.Timers.Timer(10000);
aTimer.Elapsed += new ElapsedEventHandler(YourMethodHere);
aTimer.Interval = 2000;
aTimer.Enabled = true; 
```

请参阅[MSDN：计时器](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)

*   如果您想长时间保持校准，计时器不是非常有效的解决方案

但是，如果您想朝这个方向追求它，那么另一种方式，我猜想实现您的结果的更“标准”方式可能是通过窗口服务，这个链接可能会对您有很大帮助。 [Windows 服务应用程序简介](http://msdn.microsoft.com/en-us/library/d56de412%28v=vs.110%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T09:33:51.350

“更新视图”是什么意思？

MVC 视图是一个类——您只能“更新”具有值的对象。当用户请求页面时，视图被实例化。

如果您的意思是您希望用户始终在他们的浏览器中打开一个页面并且它每小时刷新一次，那么您可以在客户端的 javascript 中使用计时器每小时重新加载页面。

如果您的意思是要根据每小时更改的数据更新任何用户打开页面的结果，您可以将上次更新时间存储在数据库中，然后在视图运行时检查数据是否超过一个小时。如果是，请在控制器中运行 if 语句。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-04-03T23:52:42.430

使用 Azure 函数。您可以使用计时器触发器运行计划任务。这是相当不错。

[https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview](https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview)

# sql-server - 如何摆脱僵局

> ID：13357965
> 
> 赞同：1
> 
> 时间：2012-11-13T09:06:41.920
> 
> 标签：sql-server, transactions, parallel-processing, deadlock

我在这里描述了这个问题： [ReadCommited IL 下](https://stackoverflow.com/q/13310472/1632632)的死锁 并得到了答案：

```
So a deadlock can occur when running SELECTs because the transaction running 
those selects had acquired write locks before running the SELECT. 
```

好的，那我该怎么做才能摆脱这个？有一些常见的死锁类型可以通过添加覆盖索引或更改更改 sql 命令文本的隔离级别、使用表提示等来解决，但我想不出适合我的情况的解决方案。

似乎这是最常见和最简单的死锁原因：

1.  进程**A**获得资源**R1**上的锁，进程**B**获得资源**R2上的锁**
2.  进程**A**等待资源**R2**被释放，进程**B**等待**R1**

所以这在很大程度上是一个并行问题，也可能是业务逻辑。

如果将锁应用于行，也许我可以避免死锁，但似乎一个页面中有几个行锁，然后发生锁升级，然后我锁定了整个页面。

你有什么建议？禁用锁升级？我可以在本地进行 1 次交易吗？或者也许应用一些表格提示（WITH ROWLOCK）或其他东西...... idk

现在不能选择将隔离级别更改为快照（或其他类型）。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:22:14.590

修复死锁主要是特定于正在考虑的特定事务的任务。几乎没有给出一般性建议（除了启用快照隔离，这是您无法做到的）。

但是，一种模式作为标准修复出现了：使用正确的锁定模式以正确的顺序获取所有必要的锁定。这可能意味着选择`WITH (UPDLOCK, ROWLOCK, HOLDLOCK)`以主动 U 形锁定行。

我还没有看到锁升级是问题，因为它需要非常多的锁才能启动。当然这可能是原因，但大多数情况下，行锁足以触发死锁。

# version-control - 使用 Mercurial 维护 CMS 和网站

> ID：13357966
> 
> 赞同：2
> 
> 时间：2012-11-13T09:06:45.160
> 
> 标签：version-control, mercurial

我对 mercurial 很陌生，在阅读了一些教程之后，我仍然怀疑什么是最好的方法来做我打算用它做的事情。

我的目标是维护我正在开发的 CMS（添加新功能、修复错误等），并能够轻松地将这些更新分发到我使用所述 CMS 制作的网站。

我首先为 CMS 本身创建一个存储库，然后当我想创建一个新网站时，克隆 CMS 存储库并对其进行处理。

现在的问题是：在网站上工作时会有一些特定的变化，以及我希望在主 CMS 存储库上看到的变化。如何区分它们？

我是否应该创建一个新分支并将所有网站特定更改提交到该分支并将一般更改提交到默认分支？还是我应该使用标签？

我正在寻找一种简单的方法来将更改推送到 CMS 存储库，然后继续开发 CMS（例如在其他网站中）并最终更新我使用 CMS 制作的所有网站，并提供新功能和错误修复很麻烦。

处理我描述的情况的最佳方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:47:09.233

好吧，你真的至少问了两个问题（如我所见）

*   如何保持不同的发展路线？
*   如何轻松地将更改从一个（？）DEVEL env 分发到不同的 PRODs env

第二个问题的完整最终答案需要澄清许多具体细节，我建议我们将其推迟一段时间。

关于第一个问题：你是对的，单个 repo 内的站点的命名分支（您定期将默认分支与共享更改合并到其中）可能是不错的选择（不是标签，这只是变更集的容易记忆的标签）。

替代解决方案*可以*在单个默认分支之上使用 mq（每个站点都有单独的 mq 队列）

# jquery - 如果单击导航栏中的按钮，如何在 mynavbar 下打开第二行

> ID：13357969
> 
> 赞同：0
> 
> 时间：2012-11-13T09:06:57.317
> 
> 标签：jquery, mobile, navbar

我的移动网站有以下代码：

```
<div data-role="page" id="home">

    <div data-role="header">
        <h1>home</h1>
    </div><!-- /header -->

    <div data-role="content">   
        <p>some text</p>

    </div><!-- /content -->

<div data-role="footer" data-position="fixed"> 
    <div data-role="navbar"> 
        <ul>  
        <li><a href="#home" data-iconpos="right" data-icon="star" data-transition="slide">home</a></li> 
        <li><a href="#contact" data-iconpos="right" data-icon="info" data-transition="slide">contact</a></li> 

        </ul> 
    </div> 
</div> 

</div><!-- /page home --> 
```

现在我想要一个 2 行导航栏：

第一行带有显示/隐藏导航栏的按钮，第二行带有导航栏，只有当我单击该按钮时才会显示。

我的问题是我在 jquerymobile 中找不到该导航栏的显示/隐藏按钮之类的东西。所以我希望有人有其他解决方案。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T09:25:47.813

查看 jquery .toggle 函数，下面是一些我拼凑但未经测试的代码，它所做的只是在单击按钮时使用 jquery 切换函数来显示/隐藏 id=navbar 的 html 元素。你必须用css自己定位按钮和导航栏......

```
<a id="showHideNav" onclick="$.("#navbar").toggle();" data-role="button">Show/Hide Nav</a>

    <div id="navbar" data-role="navbar"> 
        <ul>  
        <li><a href="#home" data-iconpos="right" data-icon="star" data-transition="slide">home</a></li> 
        <li><a href="#contact" data-iconpos="right" data-icon="info" data-transition="slide">contact</a></li> 

        </ul> 
    </div> 
</div> 
```

# matlab - Matlab循环直到击键

> ID：13357970
> 
> 赞同：2
> 
> 时间：2012-11-13T09:07:05.570
> 
> 标签：matlab

我有一个循环，在其中我不断使用 ginput 将点输入到图中。我希望循环一直运行，直到用户按下一个键，这就是我所拥有的：

```
function enter_points()
    f = figure();
    axis([-1 1 -1 1]);

    coorX = [];
    coorY = [];

    while 1
        [x, y] = ginput(1);
        coorX = [coorX x];
        coorY = [coorY y];

        waitforbuttonpress;
        key = get(f,'CurrentCharacter');
        if (key == 'e')
            display('End of cycle.')
            break;
        else
            display('Enter next point')
        end
    end

    coor = [transpose(coorX) transpose(coorY)];
    display(size(coor));
    display(coor);
end 
```

这段代码的问题是，我必须按一个键才能继续输入点。另一个问题是，Matlab 在运行此代码时有时会冻结（我不确定代码是原因还是其他原因）。以及如何检测按“enter”而不是“e”？谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:33:14.940

AFAIK，在 OOP 和面向事件的编程中处理问题的一般方法是生成给定事件的侦听器，在您的情况下是类似`keypress`事件。在定义侦听器时，通常会传递一个[回调](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)函数，以便在事件生成时调用（-back）。

可以在 matlab GUI 中定义侦听器（[参考](http://www.mathworks.it/it/help/matlab/matlab_oop/events-and-listeners--syntax-and-techniques.html#brb6i6i)）。尽管如此，我不确定*在控制台级别*生成事件时是否可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T09:47:24.937

你为什么不使用内置：

> [X,Y] = ginput 收集无限数量的点，直到按下返回键。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T11:47:07.393

bdecaf 已经为您提供了最简单的答案，但您也可以尝试以下几个更改：

1）改变这个：

```
[x, y] = ginput(1); 
```

对此：

```
[x, y, key] = ginput(1); 
```

ginput 还会返回您按下的键，甚至返回哪个鼠标按钮（1:LB、2:RB 或 3:MB）。

2）删除这些行：

```
waitforbuttonpress;
key = get(f,'CurrentCharacter'); 
```

通过这些更改，您的例程应该按预期工作。点之间没有停顿，按[e]退出。

# javascript - JavaScript 扫描单词并制作成链接

> ID：13357971
> 
> 赞同：0
> 
> 时间：2012-11-13T09:07:06.110
> 
> 标签：javascript

我需要纯 JavaScript 来使用一组指定的单词和 URL 来读取网页并将任何匹配的单词转换为链接。谷歌之神忽略了返回任何有用的例子：（任何帮助都会很棒！

我在某处的网站上找到了这个：

```
FUNCTION linkWord(obj){
  FOR(i IN obj){
    VAR x = document.body.innerHTML;
    VAR linkStart = '<a href="'+obj[i]+'">';     
    VAR linkEnd = '</a>';     
    VAR reg = NEW RegExp ('\\b' + i + '\\b','g');
    x = x.replace(reg, linkStart + i + linkEnd);
    document.body.innerHTML = x;
  }
}

linkWord ({
  'funny':'http://www.example.com',
  'another':'http://icant.co.uk'
}); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-13T09:46:17.077

```
<html>
<head></head>

<body>
funny another

<script>
var linkWord = function(obj){
  for(i in obj){
    var x = document.body.innerHTML;
    var linkStart = '<a href="'+obj[i]+'">';
    var linkEnd = '</a>';
    var reg = new RegExp("\\b(" + i + ")\\b","g");
    x = x.replace(reg, linkStart + i + linkEnd);
    document.body.innerHTML = x;
  }
}

linkWord({
  'funny':'http://www.example.com',
  'another':'http://icant.co.uk'
});
</script>
</body>

</html> 
```

研究它。找出为什么你的不起作用。

# javascript - 使用 javascript 而不使用 eval() 检查文本是否有效 javascript

> ID：13357974
> 
> 赞同：1
> 
> 时间：2012-11-13T09:07:14.783
> 
> 标签：javascript, eval

有没有办法做到这一点？或限制执行时间`eval()`（例如不超过 1 秒）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:16:57.663

您可以尝试其中一种缩小器，例如[UglifyJS](https://github.com/mishoo/UglifyJS)。它们都包含一个可能相当容易提取的解析器（UglifyJS 包含一个名为“parse-js.js”的文件，尽管我没有详细查看它）。

# .net - Wix 3.6 可以在独立构建中使用吗？

> ID：13357980
> 
> 赞同：0
> 
> 时间：2012-11-13T09:07:37.387
> 
> 标签：.net, msbuild, wix, wix3.6

我在自包含构建中使用 Wix 3.5，这意味着其他开发人员（和构建服务器）不必在他们的机器上安装 Wix 来构建工作。我尝试升级到 Wix 3.6，但无法让自包含部分工作。这是 3.5 中的 .wixproj 中的内容：

```
<PropertyGroup>
  <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
  <Platform Condition=" '$(Platform)' == '' ">x86</Platform>
  <ProductVersion>3.5</ProductVersion>
  <ProjectGuid>{76b3b6eb-1ea0-4c4c-91aa-da489c0eec25}</ProjectGuid>
  <SchemaVersion>2.0</SchemaVersion>
  <OutputName>Setup</OutputName>
  <OutputType>Package</OutputType>
  <WixToolPath>$(MSBuildProjectDirectory)\..\Lib\WiX\bin\</WixToolPath>
  <WixTasksPath>$(MSBuildProjectDirectory)\..\Lib\WiX\WixTasks.dll</WixTasksPath>
  <WixTargetsPath>$(MSBuildProjectDirectory)\..\Lib\WiX\Wix.targets</WixTargetsPath>
</PropertyGroup> 
```

这是我所做的：

*   替换了 ..\Lib\WiX 中的所有 Wix 文件
*   更改`ProductVersion`为 3.6
*   删除了“bin”，`WixToolPath`因为所有 bin 文件现在都在 WiX 根目录中

除此之外，我不知道该怎么做。Visual Studio 2012 抱怨“找不到此项目类型所基于的应用程序”。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T03:32:44.510

如果您使用的是 MSBuild，则可以参考此 Wix 文档页面以在自包含构建中使用 Wix。 [http://wix.sourceforge.net/manual-wix3/daily_builds.htm](http://wix.sourceforge.net/manual-wix3/daily_builds.htm)

但是，仍然使用 Visual Studio 构建相去甚远。但是，您可能可以在此模型中编辑您的 Wix 项目文件以某种方式实现此目的。

# android - 如何避免微调器影响其他地方？

> ID：13357981
> 
> 赞同：0
> 
> 时间：2012-11-13T09:07:38.307
> 
> 标签：android, android-spinner

我的代码很长，所以我将描述我的问题。它是关于 a 的大小和位置`Spinner`。我`ListView`有项目，每个项目都有一个`TextView`和一个`Spinner`。s中的数据`Spinner`不同。我只在单击时操作第一个的数据`Spinner`。它会弹出。中的数据`Spinner`来自数据库列表。事实上，当我编辑数据（删除、移动、添加）时，我编辑的是数组中的数据。问题是当我弹出微调器时，它会填满整个屏幕，显示在屏幕中央，它周围的区域将是灰色的，如果我单击灰色区域，`Spinner`它将再次隐藏，但我需要它保持状态，所以我可以对其数据做一些事情而不影响其他区域（灰色区域）。有人会帮我吗？非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:08:21.733

如果您试图检测`Spinner`隐藏的时间，那么您应该`OnItemSelectedListener`在您的`Activity`.

```
public void onItemSelected(AdapterView<?> parent, View view, 
        int pos, long id) {
    // An item was selected. Handle your data here
}

public void onNothingSelected(AdapterView<?> parent) {
    // No item was selected
} 
```

# java - 在 Java 日期/日历对象中发现神秘的毫秒数

> ID：13357983
> 
> 赞同：13
> 
> 时间：2012-11-13T09:07:42.103
> 
> 标签：java, date, calendar

使用`Date`s 和`Calendar`. 重点是我想创建一个特定的日期，例如

```
Calendar cal = Calendar.getInstance();
cal.set(1970, 0, 1, 0, 0, 0);
Date date = cal.getTime(); 
```

现在的问题是：它显示了正确的日期，但是在调试时，我在日期变量下看到了 eg 的“fasttime” `-3599459`。这使我的`JUnit`测试失败，因为预期值为`-3600000`. 似乎日历在初始化时增加了 541 毫秒或类似的时间......

问题是：如果没有这个“我在后台添加一些毫秒”-ghost 函数，就不可能简单地创建一个固定日期吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T09:11:40.887

从[`set`](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html#set%28int,%20int,%20int,%20int,%20int,%20int%29)您正在调用的方法的文档中：

> 设置字段 YEAR、MONTH、DAY_OF_MONTH、HOUR、MINUTE 和 SECOND 的值。保留其他字段的先前值。如果不需要，请先调用 clear()。

所以它保留了毫秒值。它不会*增加*几毫秒 - 它会在您调用时占用系统时间`getInstance`，因为它已记录在案。

首先调用[`clear()`](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html#clear%28%29)，或显式设置毫秒值。（我个人会使用`clear()`。我还会明确设置时区，只是为了更清楚您期望的时间。

或者，使用[Joda Time](http://joda-time.sf.net)开始 - 这是一个*更*令人愉快的日期/时间 API。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T09:11:01.703

在调用之前添加此行`cal.getTime()`：

```
cal.set(Calendar.MILLISECOND, 0); 
```

这将确保您将毫秒设置为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T09:13:26.600

一个常用的最佳实践是引入一个`Clock`对象来包装对日期/时间 API 的所有访问。

本质上，您有两个实现 - 一个`SystemTimeClock`将所有内容转发到您选择的日期/时间提供程序，以及一个用于测试的模拟实现。

这样，您的代码就变得独立于 API 的细节，并且您的测试可以顺利运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T09:16:19.583

在处理日期时，我对 Joda Time 库非常满意。我知道这不完全是您问题的答案，但也许值得研究：http: [//joda-time.sourceforge.net/](http://joda-time.sourceforge.net/) JavaDocs：http: [//joda-time.sourceforge.net/apidocs/org/joda /time/DateTime.html](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T09:17:14.343

问题是“set”没有设置“毫秒”值，所以毫秒值仍然是你用getInstance创建日历时的值。你可以打电话

```
cal.set(Calendar.MILLISECOND, 0); 
```

在调用 getTime 之前，这将确保毫秒为 0。您也可以直接创建公历：

```
Calendar cal = new GregorianCalendar(1970, 0, 1, 0, 0, 0);
assertEquals(0, cal.get(Calendar.MILLISECOND)); 
```

如果您想要更完整地实现日历和时间功能，您可以使用 Joda Time 而不是标准的 Java Calendar API。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-11-17T12:07:47.923

```
Calendar cal = Calendar.getInstance(); 
cal.setTime(new Date()); 
```

# json - 将 json 文件中的静态数据导入骨干模型

> ID：13357987
> 
> 赞同：5
> 
> 时间：2012-11-13T09:08:06.923
> 
> 标签：json, url, backbone.js, model, fetch

我有以下代码，想知道为什么我的数据没有被拉入我的模型？我正在使用静态 json 文件，我猜这可能是我的问题，但似乎找不到任何关于它的文档。

```
var DataModel = Backbone.Model.extend({
    initialize: function () {
        console.log('initiliazed model')
    },

    url: "data/data.json"

});

var StructureView = Backbone.View.extend ({
    initialize: function () {
        console.log('initiliazed view')
        _.bindAll(this);
        this.model.fetch();
        this.render();
        this.model.on('change',this.render);
    },
    el : '#ev-wrapper',
    render: function () {
        $('#ev-wrapper').empty().append(Handlebars.compile($('#ev-template').html())(this.model.toJSON()));
        $('.ev-asset-loader').fadeOut('slow');
    }

});

var structureView = new StructureView({model: new DataModel()}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T19:23:45.847

你需要打电话`fetch`。这将发出一个 AJAX 请求，使用`url`

```
var model = new DataModel();
model.fetch(); 
```

打开 Firebug 或您喜欢的浏览器的网络控制台以查看 AJAX 请求并检查它是否正常

# jquery - 使用 jQuery 按命名空间查找 XML 节点

> ID：13357988
> 
> 赞同：5
> 
> 时间：2012-11-13T09:08:07.917
> 
> 标签：jquery, xml, namespaces, find

我们有一个 XML 文件，其中一些节点是命名空间的。基本上该文件如下所示：

```
<foo>
    <bar xmlns:x="http://www.example.com/">
        <x:bla foo="bar" />
    </bar>
</foo> 
```

我们要实现的是我们要选择`x:bla`节点，可惜我们事先并不知道节点的名字，只知道它的命名空间。因此，我们所知道的基本上是它是一个`x:*`节点。

`find`现在，问题是：一旦我们使用 解析了 XML 文件，我们如何使用 jQuery 的方法选择这个节点`$.parseXML`？

使用`$(xml).find("x\\:bla, bla")`有效，但前提是我知道该节点被调用`bla`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T10:36:03.370

您可以使用属性包含 jQuery 选择器（请参阅[此处](http://api.jquery.com/attribute-contains-selector/)）

```
xml.find("[nodeName*='x:']") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T10:21:32.093

`.parseXML()`给我 XML 解析错误，它似乎无法处理`<x:bla..`语法。

所以我只是使用带有自定义选择器的 jQuery 来按命名空间查找元素：

```
$.expr[':'].findNS = function(obj, idx, meta, stack) {
    if (obj.nodeName.indexOf(meta[3].toUpperCase()+':') === 0) {
        return true;
    }
    return false;
};

var xml="<foo><bar><x:bla atr='attvalue' /></bar></foo>";

alert( $(xml).find(':findNS(x)').attr('atr') ); // Alerts 'attvalue' 
```

查看工作[**演示**](https://tinker.io/2dc74)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T10:28:42.030

[带有命名空间的 jQuery XML 解析](https://stackoverflow.com/questions/853740/jquery-xml-parsing-with-namespaces)展示了如何搜索文字命名空间前缀。我认为这是一种“邪恶”的解决方法，因为它不是真正的 XML 处理。但看起来 jQuery 不支持任何真正的命名空间处理。因此，您可能必须寻求该解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-21T01:26:55.357

我有类似的需求，并且想正确处理命名空间。这是一个对我有用的例子。在这种情况下，我正在阅读一个包含 MediaRSS 属性的 RSS 提要。

```
var xmlDoc = $.parseXML(data);
var $xml = $(xmlDoc);
var ns = {};
$xml.find('item').each(function() {
    console.log('title = ' + $(this).find('title').text());
    console.log('link  = ' + $(this).find('link').text());
    console.log('thumb = ' + 
        $(this.getElementsByTagNameNS('http://search.yahoo.com/mrss','thumbnail')).attr('src'));
}); 
```

# javascript - 在从搅拌机导入的模型上运行时在 Three.js 中更改面部颜色

> ID：13357989
> 
> 赞同：5
> 
> 时间：2012-11-13T09:08:21.370
> 
> 标签：javascript, three.js, blender

我已经从搅拌机（通过 JSON 加载器）导入了一个足球模型（截断的二十面体），我想在点击时更改面部颜色。正确识别面我可以更改整个模型的颜色，但不能更改特定面。我挖得更深了，我发现颜色被正确分配给了 footballball.geometry.faces[i] 但没有显示新的面颜色。

我经历了所有类似的线程并尝试了所有建议的解决方案（不同的材料、dirtyColors、动态、colorsNeedUpdate 等），但没有任何帮助。

这就是我导入模型的方式：

```
var loader = new THREE.JSONLoader(  );
var onGeometry = function(geom) {
soccer = new THREE.Mesh( geom, new THREE.MeshLambertMaterial());
soccer.position.set( 0, 0, 0 );
soccer.scale.set( 2, 2, 2 );
soccer.geometry.dynamic  = true;
soccer.geometry.dirty = true;
soccer.overdraw = true;
objects.push(soccer);
scene.add(soccer);
};

loader.load("models/model.js", onGeometry); 
```

你能帮我么？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:07:32.907

```
soccer.material.vertexColors = THREE.VertexColors ; 
```

或者

```
soccer.material.vertexColors = THREE.FaceColors; 
```

如果这不起作用，那么我需要对模型本身进行一些测试。

# objective-c - 使用 NSPredicate 从 NSArray 中提取唯一 NSDates 的方法？

> ID：13357992
> 
> 赞同：2
> 
> 时间：2012-11-13T09:08:49.647
> 
> 标签：objective-c, nsarray, nspredicate

我有一个 NewsArticle 对象的 NSArray：

```
@interface NewsArticle : NSObject

@property (nonatomic, strong) NSString *title;
@property (nonatomic, strong) NSDate *dateTime;
@property (nonatomic, strong) NSString *content;

@end 
```

而且我想创建一个`NSArray`存储在每个日期中的唯一日期（忽略时间）`article.dateTime`- 我知道我可以通过枚举数组并自己进行检查来做到这一点，但我希望有一个更简单的解决方案。

我来自 C# 背景，我知道在 C# 中我可以用一个简单的`LINQ`语句来做到这一点 - 似乎`NSPredicate`可以提供这个功能，但我无法弄清楚如何，或者在网上找到任何合适的例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T09:17:39.063

`NSPredicate`设计用于过滤对象集合，但您想从集合的每个成员中提取一个属性。

您可以（正如 CAMOBAP 在他的评论中所说）使用键值编码 (KVC) 来获取所有`dateTime`值的数组。然后您可以使用 an`NSSet`来消除重复项：

```
NSArray *allDateTimes = [articles valueForKey:@"dateTime"];
NSSet *uniqueDateTimes = [NSSet setWithArray:allDateTimes]; 
```

您甚至可以在一条 KVC 消息中完成所有操作，使用有点深奥的`@distinctUnionOfObjects`键：

```
NSArray *uniqueDateTimes = [articles valueForKeyPath:@"@distinctUnionOfObjects.dateTime"]; 
```

请注意，第二个示例使用`valueForKeyPath:`，而不是`valueForKey:`。

[*您可以通过阅读Key-Value Coding Programming Guide*](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/KeyValueCoding.html)了解更多信息（哦，更多！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-10T11:10:10.163

`NSPredicate`如前所述，您不能使用 来执行此操作。这是一个替代解决方案：

```
 NSMutableOrderedSet *dailySet = [[NSMutableOrderedSet alloc] init]; //Or NSMutableSet if the order isn't important
    NSCalendar* calendar = [NSCalendar currentCalendar];
    for (NSDate *date in [articles valueForKey:@"dateTime"]) {

        if ([date isEqual:[NSNull null]]) {
            [dailySet addObject:date]; //or don't add it
            continue;
        }

        NSDateComponents *components = [calendar components:NSCalendarUnitYear|NSCalendarUnitMonth|NSCalendarUnitDay fromDate:date];
        [dailySet addObject:[calendar dateFromComponents:components]];
    } 
```

# google-analytics - Google Analytics：访问者流量：仅显示 100% 下降的根，无页面

> ID：13357993
> 
> 赞同：5
> 
> 时间：2012-11-13T09:08:57.217
> 
> 标签：google-analytics, flow, visitors

我想使用谷歌分析访客流工具，但它没有显示任何特定页面。所有访问都在一个大块“/”中。如果我点击“组详细信息”页面列出就好了。

我的网站使用诸如 mypage.com?p=products 之类的 url 参数在页面之间切换。我设法设置了分析，以便它理解这一点并在“内容”页面和任何地方工作。我怎样才能使它也与“访问者流”一起显示特定页面？

这可能是同一个问题：[Google Analytics: 100% Drop off fromlanding page](https://stackoverflow.com/questions/11111783/google-analytics-100-drop-off-from-landing-page)

编辑：这是我的页面：[已编辑]

编辑2：刚刚注意到我页面上的链接在“？”之前缺少斜杠。将添加斜线并报告回来。

编辑3：虽然我猜这是一种改进，但它并没有解决问题。我到处都在使用绝对链接 (http:/mysite.com/?p=contact)。我应该尝试相对链接以使其正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:34:32.450

Yes, you need to put a / before the ? in your links or else Analytics could interpret your full URL as the domain/sub-domain and not report any page paths or levels (like you're observing).

Additionally, are you sure the Analytics script is firing whenever a new page is loaded? Clicking through your site it looks like the base page template may not be reloading whenever you click to a different page (only the content is reloaded). If this is the case and the Analytics script is part of your base template, it would only fire once when the visitor first enters the site and load the page template and never again. Since Google Analytics calculates pageviews and time on site/page based on the difference in time between when the _trackPageview() is fired, it could explain your problem.

I would suggest moving your Analytics script to a portion of the markup that is reloaded every time someone clicks to a new page to see if this does the trick.

# php - 访问位于服务器根目录之前/之外的文件？

> ID：13357994
> 
> 赞同：13
> 
> 时间：2012-11-13T09:08:57.297
> 
> 标签：php, document-root

我正在为售后客户服务企业制作内部网。员工需要能够将 img 文件上传到 Intranet 的服务器，我需要将它们存储在一个目录中，并且是 BEFORE `www`（网站的根目录）。

使用 php 执行此操作非常简单，但是一旦上传这些 img，如何将它们包含在网站上？我试过这段代码

```
<img src="../img/img.png"/> 
```

这不起作用，因为如果文件位于服务器`www`目录之外，我将无法发送文件...

有什么合适的方法吗？

当前树视图：

```
server root directory
           |www
               |(all server files)
           |img
               |(all img files) 
```

（服务器的 index.php 位于，`www`文件位于`img`）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-13T09:26:39.657

您不能直接访问 Web 目录之外的任何文件。由于您的问题也包括标签 PHP，我假设您可能想要使用它。

您可以执行以下操作：

在您的 www 目录中，创建一个“image.php”文件，其内容类似于：

```
<?php
  header('Content-Type: image/png');
  readfile("../img/" . $_GET['img']);
?> 
```

并调用你的图像

```
<img src="image.php?img=myimage.png" /> 
```

请注意，您的 PHP 文件不应该那么简单 :) 因为您可能想要处理多种图像格式（并为它们提供正确的标题），检查恶意文件路径/包含（您不想使用 $ _GET 没有验证/清理输入），额外的缓存等等等等。

但这应该让您了解如何针对您的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-13T09:29:05.803

这取决于您要完成什么以及如何完成。使用“简单”的 html 命令，就像您发现的那样。您不能转到 www 根目录之外的目录。（例如，对于 C 上的 xampp 应用程序，大部分时间是 c:\xampp\htdocs）。

如果您可以使用服务器端命令来完成您想要实现的目标，那么您可以使用 php 来解决问题，方法是通过 PHP 读取相应的文件。例如，如果您的文件名为“myimg.gif”并且位于“c:\pics”

```
<img SRC="data:image/gif;base64,<?php echo base64_encode(file_get_contents("c:\pics\myimg.gif"));?>"> 
```

这样您就可以读取文件的内容并将其直接写入 img 标签。请注意，您需要将 image/gif 更改为您真正需要的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-13T09:17:51.213

您不能直接访问根目录（www 或 public_html）之外/之上的文件。

您可以在 Apache 服务器配置中创建虚拟目录。谷歌“apache 虚拟目录”了解更多信息。

虚拟目录配置示例：

```
<IfModule alias_module>
  Alias /uploaded_images/ "/home/someuser/somewhere"
  <Directory "/home/someuser/somewhere">
    Allow from all
  </Directory>
</IfModule> 
```

`uploaded_images`目录将像 www 目录中的普通目录一样从网络上可用。您可以将文件从那里复制到另一个位置（一种缓冲）。

您也可以通过 ftp 从 php 级别打开/复制该文件，而无需更改 apache 中的任何内容，但这可能非常慢（仅在您无法控制 apache 配置时使用它，虚拟目录要好得多）。

[php.net: FTP](http://php.net/manual/en/book.ftp.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T09:49:20.413

我同意@kamil 关于创建虚拟目录的想法。但是，如果你想走 php 路线，我写了一些代码，在 WWW 之前的目录中打开图像并将它们复制到 www/images 文件夹。

```
<?php 
$imagepath = "../images/";
define('IMGPATH', realpath($imagepath).DIRECTORY_SEPARATOR);
$cachewwwimg = "images/";
$imagename = 'image.jpg';
copy(IMGPATH.$imagename, $cachewwwimg.$imagename)
?>

<img src="<?php echo $cacheimg.$imagename;?>"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-27T15:56:51.930

我通过简单地创建一个指向我主机上的全局物理文件夹的符号链接来解决这个问题。我没有 root 访问权限，所以我创建了一个简单的 PHP 文件，将其命名为 symbolic_link.php，我将它放在我网站的根目录中，并为我创建了符号链接。这里是：

```
<?php
$target = '/home/<user>/images/';   // hosting physical directory
$link = 'images';                   // symbolic link inside root of web site
unlink($link);
symlink($target, $link); 
```

创建符号链接后，我删除了该文件。

这是托管目录结构：

```
/home/<user>                        // hosting root   
|
+--/images                          // hosting global dir
|  |
|  +--/logo.png                     // global image
|
+--/www.website.com                 // hosting website dir
   |
   +--/images                       // symbolic link 
```

现在您可以像在您的网站文件夹中一样使用图像：

```
<img src="https://www.website.com/images/logo.png" alt="..."> 
```

# php - MySQL 不使用 textarea 更新文本字段

> ID：13357995
> 
> 赞同：0
> 
> 时间：2012-11-13T09:08:59.947
> 
> 标签：php, mysql, textarea

我想更新我的 mysql 数据库中的一个文本字段，但是当我运行查询时它不会改变。我试过去掉特殊字符，但还是不行。

更新：它返回以下错误：它给出以下错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 'datatext='LET OP! 附近使用的正确语法！Aantal Mate' 在第 1 行

这是数据：

的HTML

```
<form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">
<input type="hidden" name="nr" value="1">
<textarea rows="20" cols="50" name="text"></textarea>
</form> 
```

PHP的

```
$change_text = $_POST['text'];
$change_nr = $_POST['nr'];
if ((!empty($change_text))&&(!empty($change_nr)))
{
mysql_query("UPDATE table SET datatext='$change_text' WHERE datanr='$change_nr'");
} 
```

结构 MySQL（表名 = 表）

```
datanr = int(6)
order = text utf8_general_ci 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:37:49.473

文本区域不应该受到责备。您的 sql 引用了您的表似乎没有的列名。

您的架构有`datanr`and`order`而更新查询有`datanr`and `datatext`。

还有一些提示：

1.  如果必须，不要使用 mysql 关键字作为列名或表名，或者至少使用 `backticks` 转义它们。
2.  始终验证/清理您的用户输入
3.  不要使用`mysql`但使用[mysqli](http://php.net/mysqli)，[pdo](http://php.net/pdo)或更好的，一个很好的[数据访问层](https://www.google.nl/search?q=php%20data%20access%20layer&ie=UTF-8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T10:54:47.643

哈哈！我知道问题所在！它是查询。您必须在列名周围使用这些特殊引号。像这样：mysql_query("UPDATE table SET `datatext`='$change_text' WHERE datanr='$change_nr'");

注意数据文本周围的 ` 引号。现在你的脚本应该可以工作了。如果没有，我将关闭我的电脑并立即上床睡觉哈哈

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T09:20:03.930

调试你的代码

```
var_dump($_POST);

$change_text = $_POST['text'];
$change_nr = $_POST['nr'];

if ((!empty($change_text))&&(!empty($change_nr)))
{
    $sqlString = "UPDATE table SET datatext='$change_text' WHERE datanr='$change_nr'";
    var_dump($sqlString);
    mysql_query($sqlString) or die(mysql_errno() . " " . mysql_error()); 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T11:15:50.737

您的查询应该是这样的：

```
mysql_query("UPDATE table SET datatext='".$change_text."' WHERE datanr=".$change_nr); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T10:04:42.233

您的表单缺少 <input type="submit" />。没有提交按钮，无法提交表单（和数据）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T09:12:05.527

尝试检查 key 是否存在而不是空

```
 if (array_key_exists('nr', $_POST)) {
        $change_text = $_POST['text'];
        $change_nr = $_POST['nr'];
        mysql_query("UPDATE table SET datatext='$change_text' WHERE datanr='$change_nr'");
    } 
```