# StackOverflow 问答 14939000-14939999

# c# - 隐写术 - 在 c#.net 中的另一个文本文件中隐藏文本文件

> ID：14939001
> 
> 赞同：-1
> 
> 时间：2013-02-18T14:50:03.127
> 
> 标签：c#

我已经看到了在图像或音频文件中隐藏文本文件或消息的解决方案。但我想要在另一个文本文件（.txt、.doc、.pdf）中隐藏文本文件的解决方案。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T14:54:57.567

隐写术是基于稍微变化的数据来“隐藏”这些变化中的一些其他数据集。这就是为什么带有隐写术的图像与原始图像略有不同的原因。如果您不知道它的存在，您不会注意到，但事实是您将数据保存为像素颜色信息中的变化。

.txt 文件只不过是一大块字符。如果您试图以某种方式更改数据以隐藏其中的某些内容，则会导致无法阅读的文本。如果您将像素的颜色从 215 Red 更改为 217 Red，您不会真正注意到。但是将 A 更改为 F 或 Ł 非常明显。

所以不，我不相信它可以做到。至少不是 .txt 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-23T00:38:47.610

虽然我同意@stonehead 的观点，如果你在文件中放了一些东西，那么有人可以找到它，但是有一些技巧可能被证明是可行的选择。

由于大多数用户并不生活在他们的命令提示符下，因此最直接的方法是将文件歪曲到 GUI 中。这是一个非常方便的技巧。

[http://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/](http://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/)

如果您将数据存储在 pdf 中，那么问题应该很小。我会使用 PdfClown。不要太深入，但你会想要阅读关于 pdf 的结构。使用小丑 pdf，您可以在内部存储资产，而无需连接到表示层。鉴于 pdf 文件的复杂性，我几乎敢打赌没有人会查看，我会对该块进行 base64 编码以使其与图像和其他数据混合在一起，因此仅通过打开文件就很难找到它。

Be For Warned ClownPDF C# 库不适合胆小的人，这将有助于拥有一些 Java 经验，因为他们的很多文档都是针对 Java 的。

希望这些选项有所帮助。

# azure - 有没有办法在 Windows Azure 中更改 cloudapp.net DNS 名称

> ID：14939002
> 
> 赞同：2
> 
> 时间：2013-02-18T14:50:06.763
> 
> 标签：azure

我在 Windows Azure 中设置了我的 VM，当时我并不完全了解它如何协同工作，所以我给我的云服务一个奇怪的 DNS 名称，现在我想更改它。有没有办法更改我的 .cloudapp.net DNS 名称？我真的不想为了更改云服务 DNS 而删除我的整个云服务和所有虚拟机。我知道我可以使用带有 CNAME 或 A 记录的自定义域，但这只会影响生产和转发等...我希望我的 cloudapp.net DNS 具有不同的名称。那可能吗？还是我必须删除所有内容并从头开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-31T12:53:08.547

这是一个旧帖子，但我可以帮助别人。

当您创建 VM（云服务）时，它会自动创建一个单独的存储。因此，您可以使用此存储创建另一个云服务 - 使用您想要的新名称 - 并删除旧的。我已经成功了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T13:02:07.320

目前无法在不删除并重新创建服务的情况下更改名称。我认为这是因为他们必须动态保留昂贵的 (DNS) 资源，并且他们试图将这些系统的压力降到最低，但这纯粹是猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-11T22:16:17.770

此外，您可以使用来自任何域名注册服务的名称来定位 IP。

例如，如果在 Azure 上创建了一个名为古怪小丑.cloudapp.net 的站点，并且您希望它是 trustbank.com，则可以执行以下操作：

1）在任何地方注册一个名字（这里有一个为你准备好的搜索：[https](https://www.google.com/search?q=domain+name+registration) ://www.google.com/search?q=domain+name+registration ）

2）在azure上找到你的服务器的IP地址

3）在域名注册站点的网站上输入该IP地址作为目标。

# qt - 在 QStyledItemDelegate 中使用 QStyle::drawControl 时 QMessageBox 崩溃

> ID：14939003
> 
> 赞同：0
> 
> 时间：2013-02-18T14:50:06.770
> 
> 标签：qt, crash, qmessagebox

我有一个奇怪的问题。

我正在使用`QStyle`'s在自定义的 paint()`drawControl()`中绘制进度条。`QStyledItemDelegate`

现在应用程序崩溃了，当我尝试使用其中一个或什么打开`QMessageBox`一个`show()`时`exec()`。

我很确定，这不是我的错，而正是这种组合。

我写了一个非常小的示例项目，它显示了问题。

这是代表的`paint()`：

```
void ItemDelegate::paint(QPainter *painter, const QStyleOptionViewItem &option, const QModelIndex &index) const
{
QStyleOptionProgressBar progressBarOption;
progressBarOption.rect = option.rect;
progressBarOption.minimum = 0;
progressBarOption.maximum = 100;
progressBarOption.progress = index.data().toInt();

// This line crashes a QMessageBox. CE_ProgressBarContents and CE_ProgressBar lead to a crash. 
// All other values of QStyle::CE_*** work fine.
// drawComplexControl has no problem either.
QApplication::style()->drawControl(QStyle::CE_ProgressBarContents, &progressBarOption, painter);
} 
```

如果我在 QTreeView（当然有项目）上设置此委托并打开 QMessageBox，应用程序将崩溃。

示例项目可以[在我的 GitHub 上找到](https://github.com/Kampfgnom/QMessageBoxCrash)。

我还用其他信息打开了[关于 qtcentre 的讨论。](http://www.qtcentre.org/threads/53346-QMessageBox-crash-when-using-QStyle-drawControl-somewhere-else?p=238976#post238976)

我在 Mac OS X 10.8.2 上使用 Qt 5.0.1。这是一个Qt错误吗？你将如何解决它？

# vb.net - 如何从继承自它的类型的对象中获取 BaseType 类型的对象？

> ID：14939005
> 
> 赞同：0
> 
> 时间：2013-02-18T14:50:09.537
> 
> 标签：vb.net, inheritance

假设我有：

```
Class Vehicle
    Public Property NumberOfWheels As Integer
End Class

Class Bicycle
    Inherits Vehicle

End Class 
```

我愿意：

```
Dim b = New Bicycle() With {.NumberOfWheels = 2}
Dim v As Vehicle = CType(b, Vehicle) 
```

当我调试代码并用鼠标悬停对象时`v`仍然如此。`Bicycle`如何从 Bicycle 类型的对象中获取 Vehicle 类型的对象？我必须手动完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:10:59.453

我会给你一个明显的解决方案：

```
Class Bicycle
    Inherits Vehicle

    Public Shared Widening Operator CType(value As Bicycle) As Vehicle
        Return New Vehicle With {.NumberOfWheels = value.NumberOfWheels}
    End Operator

End Class 
```

但是，这也会弹出编译器错误：

> 转换运算符不能从一个类型转换为它的基类型

在 MSDN 上进行快速搜索会得到以下解释：

> 在编译时，Visual Basic 认为存在从任何引用类型到其继承层次结构中的任何类型的预定义转换，即从其派生或派生自它的任何类型。这样的转换可能在运行时失败，但编译器无法预测运行时结果，因此它允许编译任何这样的转换。

长话短说，我认为您需要实现`ISerializable`并`Vehicle`为从它派生的每个类提供自定义实现。

# json - 带有 Json-Data 的 jsTree，不获取元数据

> ID：14939008
> 
> 赞同：0
> 
> 时间：2013-02-18T14:50:14.640
> 
> 标签：json, jstree, oracle-apex

我阅读了许多关于 jsTree/Json/metadat 的建议，但我没有找到可行的解决方案。如果单击节点，我想获取元数据（例如 id）。

第一个我的 Json 数据：

```
[
  {
    "data":{
      "title":"TEST",
      "icon":"/i/small_folder.gif",
      "attr":{
        "id":"1000000000000000021"
      },
      "metadata":{
        "id":"1000000000000000021"
      }
    }
  }
] 
```

第二个 JS 函数，它创建树并应该获得点击的 id（ajax 调用和一些 oracle apex 的东西）

```
function populateTree(pRegionId) {
  console.log('---Js Tree---');
  $.ajax({
    type : 'POST',
    async : true,
    url : 'wwv_flow.show',
    data : {
      "p_request" : 'APPLICATION_PROCESS=GET_TREE',
      "p_flow_id" : $v('pFlowId'), // app id
      "p_flow_step_id" : $v('pFlowStepId'), // page id
      "p_instance" : $v('pInstance'), // session id

    },
    ggg : pRegionId,
    success : function (data) {
      console.log(data);

      var jsonobj = JSON.parse(data);
      apex.jQuery("#" + this.ggg).jstree({
       "themes" : {
          "theme" : "default",
          "dots" : false,
          "icons" : true
        },
        "json_data" : {
          "data" : [jsonobj]
        },
        "plugins" : ["themes","json_data", "ui"]
      //}).bind("select_node.jstree", function (e, data) { alert(data.rslt.obj.data("jstree").id); });
        }).bind("select_node.jstree", function (e, data) {
          console.log(data);

        });

    }
  });
} 
```

第三个id应该是的对象（firebug domview）：

```
 args [a#1000000000000000301.jstree-clicked #, true, Object { originalEvent=Event click,  type=  "click",  timeStamp=30977664,  mehr...}]

inst  Object { data={...}, get_settings=function(), _get_settings=function(), mehr...}

rlbk false

rslt Object { obj={...}, e={...}}
  e Object { originalEvent=Event click, type="click", timeStamp=30977664, mehr...}  
  obj   jQuery(li.jstree-closed) 
```

如您所见，没有ID。所以我猜元数据部分的东西很乱，但我不知道错误在哪里。

在此先感谢 马里奥

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T08:38:39.553

最后我追查了我的错误。如果您可以从上面的 json 代码中看到：

```
[
  {
    "data":{
      "title":"TEST",
      "icon":"/i/small_folder.gif",
      "attr":{
        "id":"1000000000000000021"
      },
      "metadata":{
        "id":"1000000000000000021"
      }
    }
  }
] 
```

元数据对象（？）像 attr 一样在数据对象中，所有在线验证都表明我的 jason 代码是有效的。但是元数据的正确位置是在数据之后：

```
[
  {
    "data":{
      "title":"TEST",
      "icon":"/i/small_folder.gif",
      "attr":{
        "id":"1000000000000000021"
      }
    },
    "metadata":{
      "id":"1000000000000000021"
    }
  }
] 
```

现在我得到了下面的 js 的 id

```
.bind("select_node.jstree", function (e, data) {
          console.log(data.rslt.obj.data("id"));         
        }); 
```

如果您想在 li 标签中添加一个 id，请在数据对象之前放置一个 attr-object，例如：

```
[
  {
    "attr":{
      "id":"1000000000000000021"
    },
    "data":{
      "title":"TEST",
      "icon":"/i/small_folder.gif",
      "attr":{
        "id":"1000000000000000021"
      }
    },
    "metadata":{
      "id":"1000000000000000021"
    }
  }
] 
```

很快马里奥

# javascript - 从文本区域获取值

> ID：14939010
> 
> 赞同：71
> 
> 时间：2013-02-18T14:50:27.050
> 
> 标签：javascript, html, jquery, textarea

# 当它不等于“”时如何从 textarea 字段中获取值。

我试过这段代码，但是当我在 textarea 中输入文本时，alert() 不起作用。如何解决？

```
<textarea name="textarea" placeholder="Enter the text..."></textarea>

$(document).ready(function () {
    if ($("textarea").value !== "") {
        alert($("textarea").value);
    }

}); 
```

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2013-11-05T13:44:55.780

## 香草JS

```
document.getElementById("textareaID").value 
```

## jQuery

```
$("#textareaID").val() 
```

* * *

不能反过来（知道自己在做什么总是好的）

```
document.getElementById("textareaID").value() // --> TypeError: Property 'value' of object #<HTMLTextAreaElement> is not a function 
```

jQuery：

```
$("#textareaID").value // --> undefined 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-18T14:56:17.843

用于`.val()`获取 textarea 的值并用于`$.trim()`留空。

```
$(document).ready(function () {
    if ($.trim($("textarea").val()) != "") {
        alert($("textarea").val());
    }
}); 
```

或者，这就是我要为干净的代码做的事情，

```
$(document).ready(function () {
    var val = $.trim($("textarea").val());
    if (val != "") {
        alert(val);
    }
}); 
```

演示：http: [//jsfiddle.net/jVUsZ/](http://jsfiddle.net/jVUsZ/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T14:53:55.410

```
$('textarea').val(); 
```

`textarea.value`将是纯 JavaScript，但在这里您尝试将 JavaScript 用作无效的 jQuery 方法 ( `.value`)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T14:51:47.200

使用 val() 方法：

```
$(document).ready(function () {
    var j = $("textarea");
    if (j.val().length > 0) {
        alert(j.val());
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T14:52:22.297

你需要不`.val()`使用`.value`

```
$(document).ready(function () {
  if ($("textarea").val() != "") {
    alert($("textarea").val());
  }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T14:52:53.347

使用`val()`：

```
 if ($("textarea").val()!== "") {
        alert($("textarea").val());
    } 
```

# jquery - 通过 vb.net 和 Ajax 到服务器的 Html5 画布

> ID：14939012
> 
> 赞同：1
> 
> 时间：2013-02-18T14:50:30.073
> 
> 标签：jquery, asp.net, ajax, vb.net, html5-canvas

我正在尝试实现我在网上找到的一段代码，以在 html5 画布上上传一些绘图，以便我可以将图像附加到电子邮件中。

```
<script type="text/javascript">
    // Send the canvas image to the server.
        $(document).ready(function () {
        $('#btnSave').live('click', function () {

            var image = document.getElementById("tools_sketch").toDataURL();
            image = image.replace('data:image/png;base64,', '');
            $.ajax({
                type: 'POST',
                url: 'upload.aspx/UploadImage',
                data: '{ "imageData" : "' + image + '" }',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (msg) {
                    alert('Image sent!');
                }, 
                error: function (msg2) {
                    alert('Image problem!' + msg2.toString());
                 }

            });
         });

     });

        </script> 
```

***上传.aspx***

```
<%@ Page Language="VB" AutoEventWireup="true" CodeFile="upload.aspx.vb" Inherits="CanvasToServer._upload" %> 
```

***上传.aspx.vb***

导入 System.IO 命名空间 CanvasToServer 部分类 _upload 继承 System.Web.UI.Page Public Shared Sub UploadImage(ByVal imageData As String)

```
 Dim fs As New FileStream("C:\uploaded\image.png", FileMode.Create)
        Dim bw As New BinaryWriter(fs)
        Dim data As Byte() = Convert.FromBase64String(imageData)

        bw.Write(data)
        bw.Close()
    End Sub
End Class 
```

结束命名空间

该行导致编译错误“属性说明符不是完整的语句。使用续行将属性应用于以下语句。” 如果我删除该行代码编译但画布图像仍然没有上传到服务器。我在 localhost 上运行此代码，并且我的机器上确实存在文件夹 c:\uploaded。

# windows - 在 Windows 2008 中设置 appConcurrentRequestLimit

> ID：14939017
> 
> 赞同：1
> 
> 时间：2013-02-18T14:50:49.873
> 
> 标签：windows, iis

我从 SO（[HTTP 错误 503.2 - 服务不可用。超出 serverRuntime@appConcurrentRequestLimit 设置](https://stackoverflow.com/questions/9774826/http-error-503-2-service-unavailable-the-serverruntimeappconcurrentrequestli)）和 MSDN（[http://technet.microsoft.com/en-us/library/dd425294](http://technet.microsoft.com/en-us/library/dd425294(v=office.13).aspx) (v=office.13).aspx ) 我需要将 AppConCurrentRequestLimit 设置为更大的数字，如果站点显示 appconcurrentlimit 超出错误（我的就是这样）。

但是在执行 MSDN 提供的命令时，我得到了错误

```
c:\Windows\System32\inetsrv>appcmd.exe set config /section:serverRuntime /appCon
currentRequestLimit:100000
ERROR ( message:Unknown attribute "appConcurrentRequestLimit".  Replace with -?
for help. ) 
```

1.  我尝试在谷歌中搜索，但似乎没有人和我有同样的问题。
2.  我尝试在 XML 中手动输入 ASPNET.Config 但是无论我更改站点似乎都不会重新启动，即使我在配置中放置了随机错误文本，我的站点仍然没有显示错误，是否正在使用 ASPNET.Config 配置，为什么即使配置是故意出错也没有错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-27T14:06:37.687

如果您有其他部分（例如 ftpsection），则会失败。为了编辑 system.webserver 部分的 serverRuntime，您应该运行：

```
cd %windir%\system32\inetsrv
appcmd.exe set config /section:system.webserver/serverRuntime /appConcurrentRequestLimit:100000 
```

# python - 将 MIMEText 编码为引用的可打印文件

> ID：14939018
> 
> 赞同：13
> 
> 时间：2013-02-18T14:50:52.247
> 
> 标签：python, encoding, quoted-printable

Python 支持一个非常实用[的 MIME 库](http://docs.python.org/2/library/email.mime.html)，称为`email.mime`.

我想要实现的是获得一个包含纯 UTF-8 文本的 MIME 部分，以编码为带引号的可打印文件，而不是 base64。尽管库中提供了所有功能，但我没有设法使用它：

例子：

```
import email.mime.text, email.encoders
m=email.mime.text.MIMEText(u'This is the text containing ünicöde', _charset='utf-8')
m.as_string()
# => Leads to a base64-encoded message, as base64 is the default.

email.encoders.encode_quopri(m)
m.as_string()
# => Leads to a strange message 
```

最后一条命令导致一条奇怪的消息：

```
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Transfer-Encoding: quoted-printable

GhpcyBpcyB0aGUgdGV4dCBjb250YWluaW5nIMO8bmljw7ZkZQ=3D=3D 
```

这显然没有编码为引用的可打印文件，双`transfer-encoding`标头最后很奇怪（如果不是非法的话）。

如何在 mime 消息中将我的文本编码为引用的可打印文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-18T15:16:21.937

好的，我得到了一个非常 hacky 的解决方案，但至少它导致了一些方向：`MIMEText`假设 base64，我不知道如何改变它。出于这个原因，我使用`MIMENonMultipart`：

```
import email.mime, email.mime.nonmultipart, email.charset
m=email.mime.nonmultipart.MIMENonMultipart('text', 'plain', charset='utf-8')

#Construct a new charset which uses Quoted Printables (base64 is default)
cs=email.charset.Charset('utf-8')
cs.body_encoding = email.charset.QP

#Now set the content using the new charset
m.set_payload(u'This is the text containing ünicöde', charset=cs) 
```

现在消息似乎编码正确：

```
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable

This is the text containing =C3=BCnic=C3=B6de 
```

甚至可以构造一个隐藏复杂性的新类：

```
class MIMEUTF8QPText(email.mime.nonmultipart.MIMENonMultipart):
  def __init__(self, payload):
    email.mime.nonmultipart.MIMENonMultipart.__init__(self, 'text', 'plain',
                                                      charset='utf-8')

    utf8qp=email.charset.Charset('utf-8')
    utf8qp.body_encoding=email.charset.QP

    self.set_payload(payload, charset=utf8qp) 
```

并像这样使用它：

```
m = MIMEUTF8QPText(u'This is the text containing ünicöde')
m.as_string() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-08-02T08:16:40.807

在 Python 3 中，您不需要 hack：

```
import email

# Construct a new charset which uses Quoted Printables (base64 is default)
cs = email.charset.Charset('utf-8')
cs.body_encoding = email.charset.QP

m = email.mime.text.MIMEText(u'This is the text containing ünicöde', 'plain', _charset=cs)

print(m.as_string()) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-28T12:57:12.567

改编自[issue 1525919](http://bugs.python.org/issue1525919)并在 python 2.7 上测试：

```
from email.Message import Message
from email.Charset import Charset, QP

text = "\xc3\xa1 = \xc3\xa9"
msg = Message()

charset = Charset('utf-8')
charset.header_encoding = QP
charset.body_encoding = QP

msg.set_charset(charset)
msg.set_payload(msg._charset.body_encode(text))

print msg.as_string() 
```

会给你：

```
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: quoted-printable

=C3=A1 =3D =C3=A9 
```

另请参阅Python 提交者的[此响应](https://stackoverflow.com/a/9509718/253049)。

# sql - SQL获取不在角色中的用户列表

> ID：14939022
> 
> 赞同：1
> 
> 时间：2013-02-18T14:50:55.873
> 
> 标签：sql, join

我有三张桌子：

1.  用户：用户 ID、用户名
2.  角色：角色 ID、角色名称
3.  UsersInRoles : 用户 ID、角色 ID

如何获取用户 ID 列表以及它们不在其中的角色 ID？

我正在使用 SQL Server 2012。

感谢您的任何帮助，您可以提供。

亚伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T14:54:52.497

```
select users.userid, roles.roleid
    from users
    cross join roles
    left outer join usersinroles on
        usersinroles.userid = users.userid and
        usersinroles.roleid = roles.roleid
    where usersinroles.userid is null 
```

`cross join`将每个角色加入每个用户。

`left outer join`加入表，但不删除不匹配的行。相反，当没有匹配项时，它将连接的字段保留为空。*仅*获取字段为空的情况具有仅获取不匹配的行的效果——用户没有的角色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:00:15.807

我认为@dan1111 的解决方案更好，但这个可能更具可读性：

```
SELECT u.Userame,
    r.RoleName
FROM Users u
CROSS JOIN Roles r

EXCEPT

SELECT u.Userame,
    r.RoleName
FROM Users u
INNER JOIN UsersInRoles ur
    on u.UserID = ur.UserID
INNER JOIN Roles r
    on ur.RoleID = r.RoleID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T14:54:04.893

这适用于 a`CROSS JOIN`和 a `LEFT JOIN`：

```
SELECT U.UserId, R.RoleId
FROM Roles R CROSS JOIN Users U
   LEFT JOIN UserRoles UR ON U.UserId = UR.UserId AND R.RoleId = UR.RoleId
WHERE UR.UserId IS NULL 
```

这是示例小提琴：[http ://sqlfiddle.com/#!6/46e48/1](http://sqlfiddle.com/#!6/46e48/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T14:52:55.100

考虑使用 LEFT JOIN 并将其与 IS NULL 条件结合使用。

# java - 为什么 JPanel 会自动重绘？

> ID：14939027
> 
> 赞同：1
> 
> 时间：2013-02-18T14:51:07.987
> 
> 标签：java, swing, user-interface, jpanel

我需要在运行时将 30`JPanel`秒添加到一个大的`JPanel`（具有`FlowLayout`布局管理器）。我想在最后显示添加的面板，当所有的都被添加时，所以我`reValidate();`和`rePaint();`最后但大面板显示每个添加的面板只是在添加时，它似乎是自动重新绘制的：

```
public class CalendarsManager implements Runnable
{

    public CalendarsManager(int mode, DecorateCalendarContainer container)
    {
        status = mode;
        containerPanel = container.getContainer();
        dayPanelsCategory = container.getDayPanels();
    }
    public void run()
    {
        for(int i=1;i<=30;i++)
        {
            containerPanel .add(dayPanelsCategory);
        }
        containerPanel.revalidate();
        containerPanel.repaint();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:51:23.200

仅从 EDT（事件调度线程）更改您的 Swing 组件，从任何其他线程添加/删除组件会导致未定义的行为，并可能导致非常难以跟踪竞争条件。

您应该使用 SwingUtilities.invokeLater()/invokeAndWait() 之类的调用来执行更改 EDT 上的 GUI 的代码。关于绘制，这也使您调用的代码具有原子性（EDT 绘制 GUI，因为当它忙于执行更改代码时，它不能同时重新绘制）。

# c# - 查找和替换几个单词而不影响以后的替换

> ID：14939028
> 
> 赞同：4
> 
> 时间：2013-02-18T14:51:10.467
> 
> 标签：c#

我想做的是某种“禁用词”突出显示。

以下是我的价值观：

我有一个数组中的禁用词列表

```
{ "word1", "word2", "word3", "word4" } 
```

我有一个代表评论的字符串

```
"i want to word1ban this word3 stupidword4 comment" 
```

我想在 html 粗体标签 ( `<b> </b>`) 中突出显示这些内容。因此，例如，此注释字符串将变为：

```
"i want to <b>word1</b>ban this <b>word3</b> stupid<b>word4</b> comment" 
```

我实际上这样做的方式是使用正则表达式替换，它工作得很好，除了一件对我来说很烦人的事情。

```
foreach (var word in words)
{
    value = Regex.Replace(value, string.Format(@"{0}", Regex.Escape(HttpUtility.HtmlEncode(word))), "<b>" + word + "</b>", RegexOptions.IgnoreCase);
} 
```

问题在于，它还取决于数组中单词的顺序，是被禁止的单词之一是否会影响您的替换（`<b>`或`</b>`）

例如，如果您将其添加到禁用词中：`<b`

按照代码，第一个迭代结果将是：

```
"i want to <b>word1</b>ban this <b>word3</b> stupid<b>word4</b> comment" 
```

然后替换为`<b`after 将是：

```
"i want to <b><b</b>>word1</b>ban this <b><b</b>>word3</b> stupid<b><b</b>>word4</b> comment" 
```

我不想影响我的替换。我想知道我们怎么能做到这一点。我尝试向我的正则表达式添加例外以排除`<b>`和`</b>`替换但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:07:03.927

忽略问题的整个“HTML”方面，只是从

> 我想查找并替换几个单词，但我不希望我所做的替换会影响将来的替换

您可以做一件事：一次完成所有替换！

```
var pattern = "(" + String.Join("|", words.Select(w => Regex.Escape(w))) + ")";
// e.g. (word1|word2|word3|word4)
value = Regex.Replace(
    value,
    pattern,
    "<b>$1</b>",
    RegexOptions.IgnoreCase); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:23:08.090

在一般情况下，您需要在这里替换输入中的一些术语，而不是迄今为止生成的输出中的一些术语。这并不难手动完成，但首先您必须确定哪个术语优先被替换。

假设您有一个术语和替换字典，选择替换哪个术语的策略是“替换最接近输入开头的术语；如果多个术语出现在同一位置，则替换最长的一个” . 这是一种方法：

```
string ReplaceWithoutOverlap(string input, IDictionary<string, string> replacements)
{
    var processedCharCount = 0;
    var sb = new StringBuilder();
    while (processedCharCount < input.Length) {
        var replacement = replacements
                .Select(r => Tuple.Create(r.Key, input.IndexOf(r.Key, processedCharCount)))
                .Where(t => t.Item2 != -1)
                .OrderBy(t => t.Item2)
                .ThenByDescending(t => t.Item1.Length)
                .FirstOrDefault();

        if (replacement == null)
        {
            break;
        }

        sb.Append(input, processedCharCount, replacement.Item2 - processedCharCount);
        sb.Append(replacements[replacement.Item1]);
        processedCharCount = replacement.Item2 + replacement.Item1.Length;
    }

    sb.Append(input.Substring(processedCharCount));
    return sb.ToString();
} 
```

**[看到它在行动](http://ideone.com/H98GiS)**。

当然，这并不是您*想要*在这里做的（事实上，用一个正则表达式一次替换所有内容可能是最方便的），但您可以看到它是如何工作的。

# android - 安卓消息

> ID：14939029
> 
> 赞同：0
> 
> 时间：2013-02-18T14:51:11.813
> 
> 标签：android, messaging

我正在尝试创建一个 android 消息传递应用程序。这是我的代码，当我运行它时，我收到一条错误消息“不幸的是应用程序已停止”。

```
public class SMSActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    EditText ed = (EditText)findViewById(R.id.edit);
    String message1 = ed.getText().toString();

    public void onClick(View v) { sendSMS("5556", message1); }

    private void sendSMS(String phoneNumber, String message) {
        SmsManager sms = SmsManager.getDefault();
        sms.sendTextMessage(phoneNumber, null, message, null, null);
    }
} 
```

另外请告诉我如何查看在第二个模拟器上发送的消息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T14:56:09.117

添加到您的`AndroidManifest.xml`此权限：

```
 <uses-permission android:name="android.permission.READ_SMS"/>
 <uses-permission android:name="android.permission.WRITE_SMS"/>

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        EditText ed = (EditText)findViewById(R.id.edit);
        String message1 = ed.getText().toString();
    } 
```

# html - 如何使用 Perl 查找和清理字符串中的子字符串？

> ID：14939032
> 
> 赞同：1
> 
> 时间：2013-02-18T14:51:15.663
> 
> 标签：html, perl

我有一些需要编辑的 HTML 文件。我需要在文件中找到一些值并清理它的形式。

例如我有 html 文件：

```
    .
    .
    诊断
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”

    配置
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
    .
    .

```

我需要找到并清理

```
    诊断
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”
      对齐=“正确”

```

来自我的 HTML 文件。

多么简单又快速的方法呢？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:00:33.043

[`HTML::TreeBuilder`](http://search.cpan.org/~cjm/HTML-Tree-5.03/lib/HTML/TreeBuilder.pm)查看一个用于在 Perl 中解析 HTML的模块，例如。这不是一项非常简单的任务，但链接的文档有一些示例。我建议您尝试一下，如果遇到问题，请提出具体问题。

另一种方法是使用[正则表达式](http://perldoc.perl.org/perlre.html)。通常不建议在解析 HTML 时使用这种方法——用正则表达式可靠地解析任意 HTML 是不可能的。 *但是*，如果您只是想从具有可预测格式的文件中快速删除一种东西，那么它可能是一个不错的选择。只要确保你的问题真的像你想象的那样简单，然后再走这条路。

# python - 使用 python OpenSSL 从私钥获取公钥

> ID：14939033
> 
> 赞同：5
> 
> 时间：2013-02-18T14:51:18.227
> 
> 标签：python, openssl, pyopenssl

好吧，我用 pyOpenSSL 生成了一个私钥，如下所示：

```
from OpenSSL import crypto
k = crypto.PKey()
k.generate_key(crypto.TYPE_RSA, 2048)
print crypto.dump_privatekey(crypto.FILETYPE_PEM, k) 
```

如何从中获取公钥字符串？我还没有找到这个库的什么方法。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T14:58:16.630

如果

```
cert = crypto.dump_certificate(crypto.FILETYPE_PEM, k) 
```

不做你想做的事，那么它看起来不`pyOpenSSL`支持公钥转储。[这里](https://code.launchpad.net/~shanemhansen/pyopenssl/dump_publickey)有一个未合并的分支，它添加了该功能，但我不能声称它做了所声称的事情。

# eclipse-juno - Eclipse Juno - 更新后工具栏中的空白

> ID：14939035
> 
> 赞同：5
> 
> 时间：2013-02-18T14:51:23.370
> 
> 标签：eclipse-juno

我刚刚将我的**Eclipse IDE for Java Developers**插件更新为`1.5.1.20121004-1506`导致主工具栏中出现荒谬空白的版本：

![在此处输入图像描述](../Images/ee8fc173f1a40ecc5887036b3a9f0ad5.png)

是的，我知道在 Indigo 之后更新 Eclipse 基本上是个坏主意，因为每个新版本似乎都越来越差，但是除了重新安装一些旧版本之外，还有什么简单的方法可以解决这个问题（我真的不想丢失我的设置和安装的插件）？这个错误是否在某处被跟踪？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-07T16:13:50.430

In my case this happened because I opened the workspace in an Eclipse version which missed some of the plugins of the previous Eclipse installation (in fact it was STS before and plain Eclipse J2EE afterwards). Creating a new workspace and importing all projects fixed the issue for me.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-22T15:07:13.683

尝试切换到经典主题并重新启动。它适用于火星。

# php - PHP 中 Split('sunset.jpg') 的替代方案将如何显示输出？

> ID：14939041
> 
> 赞同：-2
> 
> 时间：2013-02-18T14:51:45.460
> 
> 标签：php

请帮我在 5.3.5 及以上版本中找到以下 php 代码的答案。

```
$file_name ="sunset.jpg";
if(isset($file_name))
{
    $exts = split("[/\\.]", $file_name) ;
    $n = count($exts)-1;
    echo $n;
    $exts = $exts[$n];
    echo $exts;
}
else
{
    echo "error";
} 
```

我知道 split() 函数已被弃用，我们必须使用 preg_split (或) explode 来代替。但我的问题是我应该如何修改我的代码以仅将输出作为“jpg”。当我尝试使用explode 和preg_split 时，我得到的结果是'sunset.jpg'。帮助查找结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T14:56:12.797

试试这个

```
$exts = pathinfo($file_name, PATHINFO_EXTENSION); 
```

[请参阅http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)上的文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T14:54:44.157

只需分解字符串并使用它的最后一个元素：

```
$file_name = "sunset.jpg";
if( isset( $file_name ) ) {
    echo $exts = end( explode( '.', $file_name ) );
} else {
    echo "error";
} 
```

# javascript - 如何打破 async.js 每个循环？

> ID：14939050
> 
> 赞同：9
> 
> 时间：2013-02-18T14:52:04.077
> 
> 标签：javascript, node.js, loops, callback

嗨，我正在使用node.js 的[异步](https://github.com/caolan/async)模块来异步实现 for 循环。

我的问题是：如何中断循环执行并跳出循环？我尝试给予`return`，`return false`但没有运气。

这是示例代码：

```
async.until( 

    function() { return goal; },

    function(callback) {

        async.each(_rules, 

            function(rule,callback) {

                var outcome = true;
                .... some code ....
                if(changes){ 
                      console.log("hi");
                      return false;// HERE I NEED TO BREAK
                } 
                else
                callback();

            }, 

            function(err){  }
        );

        if (!changes || session.process)                
            goal = true;

        callback();
    },

    function(err){ callback(session); }     
); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T14:57:28.910

`async.until`重复调用函数，直到测试返回 true。所以 test 必须返回 true 才能退出循环。这与`async.whilst`在测试评估为真时重复运行相反。

`async.each`并行调用函数，因此它返回的内容无关紧要。它不是一个可以中断的循环，而是一个遍历数组的迭代器。您停止使用的条件`async.each`应该经过测试`async.until`，您应该自己迭代规则。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-18T15:06:10.933

没有真正的“循环”可以打破。您收藏中的所有物品都被并行使用

“打破”“循环”的唯一方法是使用错误参数调用回调。由于没有什么可以阻止您将其他东西放在那里，您可以稍微破解它。

从文档：

> 请注意，由于此函数将迭代器并行应用于每个项目，因此无法保证迭代器函数将按顺序完成。

即使您返回错误，您仍然可能有几个未完成的请求，因此您真的想限制一次性使用的项目数量。要限制未完成请求的数量，您可以使用 eachSeries 或 eachLimit。

例如：

```
 async.each(_rules, 
        function(rule,callback) {
            if(changes){                       
                  return callback({ data: 'hi'}); // stop
            } 
            ...
            if(realerror){
               return callback({ error: realerror}); // stop with an error
            }
            callback(); // continue
        }, 

        function(result){
          if(!result){
            return othercallback('no results');
          }
          // check if we have a real error:
          if(result.error){
            return othercallback(result.error);
          }
          return othercallback(null, result.data);
        }
    ); 
```

PS：如果你不做异步，使用[下划线](http://underscorejs.org/#each "下划线")

# razor - 在带有 ASP.NET MVC 的 RAZOR 中使用带有扩展方法的 ViewBag

> ID：14939058
> 
> 赞同：0
> 
> 时间：2013-02-18T14:52:34.023
> 
> 标签：razor, asp.net-mvc-4, extension-methods

我正在艰难地学习 ASP.NET MVC。我最近编写了一个扩展方法，可以帮助我决定是否应该选择下拉列表中的项目。我知道 HTML 辅助方法。我只是想了解这里的工作原理。无论如何，我目前有以下代码：

```
<select id="Gender">
  <option value="-1" @Html.IsSelected(Convert.ToString(ViewBag.Gender), "-1")>Unspecified</option>
  <option value="0" @Html.IsSelected(Convert.ToString(ViewBag.Gender), "0")>Male</option>
  <option value="1" @Html.IsSelected(Convert.ToString(ViewBag.Gender), "1")>Female</option>
</select> 
```

当我执行这个时，我在视图上得到一个编译错误，上面写着：

```
 CS1973: 'System.Web.Mvc.HtmlHelper<dynamic>' has no applicable method named 'IsSelected' but appears to have an extension method by that name. Extension methods cannot be dynamically dispatched. Consider casting the dynamic arguments or calling the extension method without the extension method syntax. 
```

我的问题是，如何使用 ViewBag 中的值执行扩展方法？如果我用硬编码值替换 ViewBag.Gender ，它就可以工作。这让我认为问题在于 ViewBag 是一种动态类型。但是，我还有什么其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-21T17:24:24.537

我也有同样的问题。改用 ViewData .. 例如，替换

```
 @using (Html.BeginSection(tag:"header", htmlAttributes:@ViewBag.HeaderAttributes)) {} 
```

和

```
@using (Html.BeginSection(tag:"header", htmlAttributes:@ViewData["HeaderAttributes"])) {} 
```

它工作正常；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T08:51:19.757

这可能会有所帮助：

```
public static class HtmlHelperExtensions
    {
public static MvcHtmlString GenderDropDownList(this HtmlHelper html, string name, int selectedValue, object htmlAttributes = null)
        {
            var dictionary = new Dictionary<sbyte, string>
            {
                { -1, "Unspecified" },
                { 0, "Male" },
                { 1, "Female" },
            };

            var selectList = new SelectList(dictionary, "Key", "Value", selectedValue);
            return html.DropDownList(name, selectList, htmlAttributes);
        }

        public static MvcHtmlString GenderDropDownListFor<TModel>(this HtmlHelper<TModel> html, Expression<Func<TModel, bool?>> expression, object htmlAttributes = null)
        {
            var dictionary = new Dictionary<sbyte, string>
            {
                { -1, "Unspecified" },
                { 0, "Male" },
                { 1, "Female" },
            };

            var selectedValue = ModelMetadata.FromLambdaExpression(
                expression, html.ViewData
            ).Model;

            var selectList = new SelectList(dictionary, "Key", "Value", selectedValue);
            return html.DropDownListFor(expression, selectList, htmlAttributes);
        }
} 
```

像这样使用它：

```
@Html.GenderDropDownList("Gender", 0) 
```

或者：

```
@Html.GenderDropDownListFor(m => m.Gender) 
```

# arrays - 计算向量中的元素或检查元素是否在 D 中的数组中

> ID：14939060
> 
> 赞同：1
> 
> 时间：2013-02-18T14:52:34.647
> 
> 标签：arrays, d

如何检查元素是否在数组中或计算特定元素的出现次数？

我知道我可以自己破解：

```
int main()
{
  int [] a = [1,2,3,4,3,4,5,6,6,3,3,3];
  assert(count(a,6) == 2);
  assert(contains(a,7) == false);
  return 0;
}

uint count(T)(T[] a, T t){
  uint cnt = 0;
  foreach(elem; a){
    if(elem == t) ++cnt;
  }
  return cnt;
}

bool contains(T)(T[] a, T t){
  foreach(elem; a){
    if(elem == t) return true;
  }
  return false;
} 
```

但必须有一个“图书馆方式”来做到这一点！

**编辑：**我只是比较了 std.algorithm`canFind()`和我的`contains()`，结果证明`contains`更快。奇怪但真实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:02:05.880

有关*计数，*请参阅：[`std.algorithm.count`](http://dlang.org/phobos/std_algorithm.html#count)。

对于*包含*：[`std.algorithm.canFind`](http://dlang.org/phobos/std_algorithm.html#canFind)。对于排序数组，您可以使用[`SortedRange`](http://dlang.org/phobos/std_range.html#.SortedRange)（`contains`方法使用二进制搜索）。

# asp.net-mvc-4 - 报告查看器未在 MVC aspx 视图中显示报告

> ID：14939062
> 
> 赞同：1
> 
> 时间：2013-02-18T14:52:34.967
> 
> 标签：asp.net-mvc-4, visual-studio-2012, reporting

从这几天开始，我试图在 MVC 4 中创建 rdlc 报告。我只是制作了一个测试控制器和 ReportTest 其返回视图的操作。当我点击这个 url /test/ReportTest 报告页面打开但只有标题页面显示为附件。当我尝试在萤火虫中观察此页面行为时，萤火虫会显示一条错误消息。 ![萤火虫中的错误消息](../Images/554279959c7c18c7a2eb398312cac0f3.png)

```
[HttpGet]
    public ViewResult ReportTest()
    {
        return View("MyReports");
    } 
```

这仅在我尝试通过控制器时发生。如果我将报告文件放在视图文件夹之外并访问此页面，它可以根据需要正常工作。请帮我解决这个问题。我正在使用 aspx 视图引擎 + SQL Server 2008 R2 开发 MVC 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T14:59:30.250

ReportViewer 是一个服务器端控件，在 WebForms 中使用。当您将它移到 Views 文件夹之外时，它会使用 WebForms 管道。

您要么必须像将其移出 Views 文件夹或从 MVC 页面中的 iframe 一样将其作为独立页面访问。

# android - 在 HTTPS 中插入数据

> ID：14939064
> 
> 赞同：1
> 
> 时间：2013-02-18T14:52:39.990
> 
> 标签：android

想要插入 body 变量中的数据并想要得到响应。插入 URL 和数据时应采用加密格式

Web 服务采用 JSON 格式，带有 https URL

ERROR LOG**错误转换结果 java.lang.NullPointerException**

**MainActivity.java**

```
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.HttpVersion;
import org.apache.http.auth.UsernamePasswordCredentials;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.conn.ClientConnectionManager;
import org.apache.http.conn.scheme.PlainSocketFactory;
import org.apache.http.conn.scheme.Scheme;
import org.apache.http.conn.scheme.SchemeRegistry;
import org.apache.http.conn.ssl.SSLSocketFactory;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.auth.BasicScheme;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpParams;
import org.apache.http.params.HttpProtocolParams;
import org.apache.http.protocol.HTTP;
import org.json.JSONArray;
import org.json.JSONObject;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.security.KeyStore;
import android.widget.Toast;

public class MainActivity extends Activity {

    private InputStream is;
    private StringBuilder sb;
    private String result;
    private JSONArray data;
    private JSONObject json_data11;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        InputStream is = null;
        String result = "";
        JSONObject jArray = null;

        // http post
        try {

            HttpClient httpclient = getNewHttpClient();
            final String body = String
                    .format("{\"block_face_line\" : [{\"longitude\" : -71.34345555,\"latitude\" : 42.7794343 },{\"longitude\" : -71.4473179666667,\"latitude\" : 42.7336227666667  },  {\"longitude\" : -71.4461721166667,\"latitude\" : 42.7321493333333  },{\"longitude\" : -71.4473179662267,\"latitude\" : 42.726227666667  } ],\"block_face_curb_side\" : \"LEFT\",\"block_face_collector_id\" : \"3\"}");
            HttpPost httppost = new HttpPost(
                    "https://parkme.goldenware.com/cgi-bin/db.test?COMMAND=add&TABLE=block_faces&USER=1&SUBSYSTEM=walker");
            httppost.setHeader("Accept", "application/json");
            httppost.setHeader("Content-type",
                "application/json; charset=utf-8");

        httppost.setHeader("Content-length",
                Integer.toString(body.length()));

            httppost.addHeader(BasicScheme.authenticate(
                    new UsernamePasswordCredentials("parkme", "parkme"),
                    "UTF-8", false));

            httppost.setEntity(new StringEntity(body, "utf-8"));

            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();

        } catch (Exception e) {
            Log.e("log_tag", "Error in http connection " + e.toString());
        }

        // convert response to string
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            result = sb.toString();
        } catch (Exception e) {
            Log.e("log_tag", "Error converting result " + e.toString());
        }

        // try parse the string to a JSON object

        Toast.makeText(getApplicationContext(), result, Toast.LENGTH_LONG)
                .show();
        Log.e("msg", result);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public HttpClient getNewHttpClient() {
        try {
            KeyStore trustStore = KeyStore.getInstance(KeyStore
                    .getDefaultType());
            trustStore.load(null, null);

            SSLSocketFactory sf = new MySSLSocketFactory(trustStore);
            sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

            HttpParams params = new BasicHttpParams();
            HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
            HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);

            SchemeRegistry registry = new SchemeRegistry();
            registry.register(new Scheme("http", PlainSocketFactory
                    .getSocketFactory(), 80));
            registry.register(new Scheme("https", sf, 443));

            ClientConnectionManager ccm = new ThreadSafeClientConnManager(
                    params, registry);

            return new DefaultHttpClient(ccm, params);
        } catch (Exception e) {
            return new DefaultHttpClient();
        }
    }
} 
```

**MySSLSocketFactory**

```
import java.io.IOException;
import java.net.Socket;
import java.net.UnknownHostException;
import java.security.KeyManagementException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.UnrecoverableKeyException;
import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;

import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManager;
import javax.net.ssl.X509TrustManager;

import org.apache.http.conn.ssl.SSLSocketFactory;
public class MySSLSocketFactory extends SSLSocketFactory {
    SSLContext sslContext = SSLContext.getInstance("TLS");

    public MySSLSocketFactory(KeyStore truststore) throws NoSuchAlgorithmException, KeyManagementException, KeyStoreException, UnrecoverableKeyException {
        super(truststore);

        TrustManager tm = new X509TrustManager() {
            public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {
            }

            public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException {
            }

            public X509Certificate[] getAcceptedIssuers() {
                return null;
            }
        };

        sslContext.init(null, new TrustManager[] { tm }, null);
    }

    @Override
    public Socket createSocket(Socket socket, String host, int port, boolean autoClose) throws IOException, UnknownHostException {
        return sslContext.getSocketFactory().createSocket(socket, host, port, autoClose);
    }

    @Override
    public Socket createSocket() throws IOException {
        return sslContext.getSocketFactory().createSocket();
    }
} 
```

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:00:15.060

您应该使用“HttpsURLConnection”类。

```
URL url = new URL(<Your URL>));
HttpsURLConnection  conn = (HttpsURLConnection )url.openConnection(); 
```**

# shell - 使用数组&awk - 对文件进行排序

> ID：14939068
> 
> 赞同：0
> 
> 时间：2013-02-18T14:52:47.393
> 
> 标签：shell

输入文件：

```
Ganesh
Gowri
Sam
Dave
Peter
Sheela 
```

输出文件：

```
Dave
Ganesh
Gowri
Peter
Sam
Sheela 
```

有人可以建议使用数组和awk对上述文件进行排序的脚本...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T14:57:45.963

数组 & awk：**`asort()`**

```
kent$  echo "Ganesh
Gowri
Sam
Dave
Peter
Sheela"|awk '{a[NR]=$0}END{asort(a);for(i=1;i<=NR;i++)print a[i]}'
Dave
Ganesh
Gowri
Peter
Sam
Sheela 
```

数组 & awk：**`asorti()`**

```
kent$  echo "Ganesh
Gowri
Sam
Dave
Peter
Sheela"|awk '{a[$0]}END{asorti(a);for(i=1;i<=NR;i++)print a[i]}' 
Dave
Ganesh
Gowri
Peter
Sam
Sheela 
```

# objective-c - IOS UIWebView，分成多个UIWebViews ？

> ID：14939074
> 
> 赞同：1
> 
> 时间：2013-02-18T14:52:55.977
> 
> 标签：objective-c, uiwebview

我有一个`UIWebView` 加载很长的页面，可以说是它的高度的 4 倍。

有没有办法可以将长页面的每 25% 分成 4 `UIWebViews`？

我可以滚动`UIWebView`长页面的内容，并为 4 个即将出现的结果感到难过吗`UIWebView`？？？

我正在使用下面的代码进行滚动及其工作，但是我无法保存滚动的内容，当我将其`UIWebView`用于两个不同的位置时，它会从第一个位置删除

```
 NSString* goToOffsetFunc = [NSString stringWithFormat:@" function pageScroll(xOffset){ window.scroll(xOffset,0); } "];
  NSString* goTo =[NSString stringWithFormat:@"pageScroll(%f)", pageOffset];

    [webView stringByEvaluatingJavaScriptFromString:goToOffsetFunc];
    [webView stringByEvaluatingJavaScriptFromString:goTo]; 
```

# elasticsearch - 关于嵌套与父/子文档的缩放

> ID：14939078
> 
> 赞同：13
> 
> 时间：2013-02-18T14:53:29.313
> 
> 标签：elasticsearch

我正在为我们运行一个概念证明，以便在 ES 中对更多“规范化”数据运行嵌套查询。

例如嵌套

客户 -> - 姓名
- 电子邮件 - 事件 -> - 创建 - 类型

现在我有一种情况，可以将给定客户的事件列表移动到另一个客户。例如，客户 A 有 50 个事件 客户 B 有 5000 个事件

我现在想将所有事件从客户 A 转移到客户 B

在规模庞大的数百万客户和查询上运行 UI 中的图形是父/子更合适还是应该嵌套能够处理它？

在我的情况下有什么优点和缺点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-18T17:25:09.477

很难为您提供诸如“嵌套足够好”之类的粗略性能指标，但我可以为您提供一些有关嵌套与父/子的详细信息，这可能会有所帮助。我仍然建议进行一些基准测试以验证性能是否可以接受。

**嵌套**

*   嵌套文档彼此存储在同一个 Lucene 块中，这有助于提高读取/查询性能。阅读嵌套文档比等效的父/子更快。
*   更新嵌套文档（父级或嵌套子级）中的单个字段会强制 ES 重新索引*整个*嵌套文档。对于大型嵌套文档来说，这可能非常昂贵
*   更改“父”意味着 ES 将：删除旧文档，用更少的嵌套数据重新索引旧文档，删除新文档，用新嵌套数据重新索引新文档。

**家长/孩子**

*   子项与父项分开存储，但被路由到同一个分片。因此，父/子在读取/查询上的性能略低于嵌套
*   父/子映射有一些额外的内存开销，因为 ES 在内存中维护一个“连接”列表
*   更新子文档不会影响父文档或任何其他子文档，这可能会节省大量对大型文档的索引
*   更改父级意味着您将删除旧的子文档，然后在新父级下索引相同的文档。

Nested 可能会正常工作，但如果您认为有可能进行大量“数据洗牌”，那么 Parent/Child 可能更合适。嵌套最适合嵌套数据不经常更新但经常读取的情况。父/子更适合数据移动更频繁的安排。

# jpa - JPA 事务范围

> ID：14939084
> 
> 赞同：1
> 
> 时间：2013-02-18T14:53:43.183
> 
> 标签：jpa, transactions

我有一个容器管理的事务和三个 Enterprise Java Bean。第一个 bean 是其他两个 EJBS 之间的链接：

```
@Stateful
public class UserManagement 
{
    @EJB
    UsersFacade usersFacade;
    @EJB
    UserDetailsFacade userDetailsFacade;

    public void addUser()
    {
       //Point 1
       UserEntity ue = new UserEntity();
       UserDetailsEntity ude = new UserDetailsEntity();
       ue.setDetails(ude);
       userFacade.create(ue); //Wrapper around EntityManager.persist method
       userDetailsFacade.create(ude); Wrapper around EntityManager.persist method
       //Point 2
    }
} 
```

问题： addUser() 中的所有操作是否会在单个事务中执行（userFacade.create 和 userDetailsFacade.create）？@TransactionAttribute(TransactionAttributeType.REQUIRED) 是否意味着事务与 addUser 方法一起开始，它包括从 addUser 方法中执行的所有方法。并且事务在 addUser 结束的那一刻结束？

以及如何确保 addUser 将拥有自己的私有事务（其中将包括其中的方法）以及该事务将在方法终止时提交。?

# c# - 无法在 c# 中加载在浏览器中加载良好的 rss 提要（400 错误）

> ID：14939085
> 
> 赞同：0
> 
> 时间：2013-02-18T14:53:47.230
> 
> 标签：c#, html, rss, webclient

我正在尝试使用“XMLTextReader”从[RSS 提要中提取数据。](http://marketplaceedgeservice.windowsphone.com/v8/catalog/apps/4aef0ee8-2378-e011-986b-78e7d1fa76f8?os=8.0.9903.0&cc=GB&oc=&lang=en-GB&hw=520170499&dm=RM-821_eu_euro1_111&oemId=NOKIA&moId=vod-gb&cf=99-1)尽管它在 Web 浏览器中加载得非常好，但是当我使用我的代码时，我收到 400 错误（“远程服务器返回错误：（400）错误请求。”）：

```
XmlTextReader reader = new XmlTextReader(url);
while (reader.Read())
{ //Do something } 
```

我也试过'WebClient'无济于事。

任何人都可以告诉我为什么它可以在浏览器中工作但不适用于我的代码吗？

PS - 它适用于类似格式的[数据](http://marketplaceedgeservice.windowsphone.com/v3.2/en-US/apps/4aef0ee8-2378-e011-986b-78e7d1fa76f8?clientType=WinMobile%207.1&store=Zest&store=&store=Nokia)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:15:37.207

> 任何人都可以告诉我为什么它可以在浏览器中工作但不适用于我的代码吗？

也许远程网站希望您设置 UserAgent。例如：

```
using (var client = new WebClient())
{
    client.Headers[HttpRequestHeader.UserAgent] = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17";
    using (var stream = client.OpenRead(url))
    using (var reader = XmlReader.Create(stream))
    {
        while (reader.Read())
        {
            // ...
        }
    }
} 
```

或者网站可能希望您通过身份验证才能调用此资源？在这种情况下，您需要将身份验证 cookie 与请求一起发送。如果您不确定，请联系网站管理员以获取有关如何使用其 API 的更多信息。

哦，顺便说一句，您将[`SyndicationFeed`](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx)类内置到 .NET 框架中正是为此目的。使用 an`XmlReader`来解析 RSS 似乎相当费力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:22:10.673

可能使用 WebClient 下载它并以这种方式将其输入 XmlTextReader？

```
var url = "http://marketplaceedgeservice.windowsphone.com/v8/catalog/apps/4aef0ee8-2378-e011-986b-78e7d1fa76f8?os=8.0.9903.0&cc=GB&oc=&lang=en-GB&hw=520170499&dm=RM-821_eu_euro1_111&oemId=NOKIA&moId=vod-gb&cf=99-1";
var data = "";

using (var wc = new WebClient())
{
    wc.Headers.Add("user-agent", "Mozilla/5.0 (Windows; Windows NT 5.1; rv:1.9.2.4) Gecko/20100611 Firefox/3.6.4");
    data = wc.DownloadString(url);                
}

var reader = new XmlTextReader(new System.IO.StringReader(data));
while (reader.Read())
{
    //
} 
```

# jsf - 有没有办法改变丰富的行为：panelMenu 折叠/展开？

> ID：14939097
> 
> 赞同：0
> 
> 时间：2013-02-18T14:54:26.450
> 
> 标签：jsf, jsf-2, richfaces

[http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=panelMenu&skin=blueSky](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=panelMenu&skin=blueSky)

上面的链接有一个演示，类似于我们在应用程序上的演示，但我们希望折叠/展开行为的行为有所不同。

我们的菜单开始完全展开，但我们基本上希望用户能够完全控制折叠和展开菜单。例如，如果您在演示中打开第一个，然后打开第二个，则第一个关闭。有没有办法只折叠和展开onclick？这似乎应该是默认行为。

所以基本上这就是我所拥有的：

```
<rich:panelMenu>
    <a4j:repeat>
        <rich:panelMenuGroup>
           <a4j:repeat>
               <h:link />
           </a4j:repeat>
        </rich:panelMenuGroup>
     </a4j:repeat>
</rich:panelMenu> 
```

我希望能够在`rich:panelMenuGroup`不影响其他元素的情况下打开和关闭每个`rich:panelMenuGroup`元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-10T13:07:03.773

它很简单：`<rich:panelMenu expandSingle="false">`

# android - 使用动态库交叉编译 C 代码时出错

> ID：14939101
> 
> 赞同：3
> 
> 时间：2013-02-18T14:54:44.123
> 
> 标签：android, c, arm, cross-compiling, codesourcery

我有两个文件：

库文件

```
#include<stdio.h>

void hi() {
  printf("Hi i'm a library function in lib.so\n");
} 
```

和 main.c

```
#include<stdio.h>
#include<dlfcn.h>
/* based on Jeff Scudder's code */
int main() {
  void *SharedObjectFile;
  void (*hi)();

  // Load the shared libary;
  SharedObjectFile = dlopen("./lib.so", RTLD_LAZY);

  // Obtain the address of a function in the shared library.
  ciao = dlsym(SharedObjectFile, "hi");

  // Use the dynamically loaded function.
  (*hi)();

  dlclose(SharedObjectFile);
} 
```

我尝试使用以下命令构建可执行文件：

> 导出 LD_LIBRARY_PATH=`pwd`
> 
> gcc -c -fpic lib.c
> 
> gcc -shared -lc -o lib.so lib.o
> 
> gcc main.c -ldl

而且效果很好。然后我尝试使用以下命令在 Android（Nexus One，带有 ARM-v7-0a 架构）上导出我的程序：

> 导出 LD_LIBRARY_PATH=`pwd`
> 
> arm-none-linux-gnueabi-gcc -c -fpic lib.c
> 
> arm-none-linux-gnueabi-gcc -shared -lc -o lib.so lib.o
> 
> arm-none-linux-gnueabi-gcc main.c -ldl -o main
> 
> 亚行推送主/系统/应用程序

在我的智能手机上的正确文件夹上执行 ./main 的结果只是：

> ./main: 未找到

即使我的文件就在那里！

我在交叉编译过程中遗漏了什么吗？有什么帮助吗？我正在使用来自 CodeSourcery 的交叉编译器，它适用于没有 .so 库的静态程序。谢谢

***编辑***：正如 Igor 下面所说，这是一个链接器问题。此命令修复它：

> arm-none-linux-gnueabi-gcc -o test main.c -Wl,--dynamic-linker=/system/bin/linker -ldl

就我而言，我需要其他库，因为在 /system/lib/ 中没有很多 .so 文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T15:44:38.887

“未找到”消息不是指共享对象，而是指动态链接器。Linux 使用`/lib/ld-linux.so.2`（或`/lib64/ld-linux-x86-64.so.2`用于 x64），而 Android 使用 `/bin/linker`. 您可以检查您的程序使用哪个动态加载器`readelf -l`，例如：

```
Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  PHDR           0x000034 0x08048034 0x08048034 0x00100 0x00100 R E 0x4
  INTERP         0x000134 0x08048134 0x08048134 0x00013 0x00013 R   0x1
      [Requesting program interpreter: /lib/ld-linux.so.2] 
```

您可以指定一个链接器与 ld 的`--dynamic-linker`开关一起使用，但可能存在其他差异。例如，Android 使用称为仿生的精简 libc 实现，它可能缺少您的程序所依赖的功能，或者具有不同的行为。

在为 Android 编译程序时，您应该使用 NDK 或其他针对 Android 的工具链。尽管它是基于 Linux 内核的，但差异足够大，以 Linux 为目标的工具链是不够的。

# c# - 来自 MemoryStream() 的 PdfReader

> ID：14939102
> 
> 赞同：1
> 
> 时间：2013-02-18T14:54:51.193
> 
> 标签：c#, itext, memorystream, pdf-reader

谁能给我一个如何`PdfReader`从 a中获取 a 的示例`MemoryStream`？我可以看到`PdfReader`该类有几个方法看起来像可能的候选人（`GetStreamBytes`& `GetStreamBytesRaw`），但是这些似乎需要`iText`特定的流，我的只是一个常规的`Byte[]`or `MemoryStream`。

这是使用 C# 和 .NET 4。

```
iTextSharp.text.pdf.PdfReader rdr = iTextSharp.text.pdf.PdfReader.GetStreamBytesRaw 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-18T16:31:00.847

您可以从 MemoryStream 创建 PdfReader，只要 MemoryStream 是有效的 PDF 对象。如果 MemoryStream 是一个有效的 PDF 对象，那么启动 PdfReader 的一种方法是：

```
PdfReader _reader = new PdfReader((byte[])_memoryStream.ToArray()); 
```

在下面的代码中，PdfReader 是从 .Net Resource 初始化的，当从 Properties.Resources 对象调用时，该资源作为 byte[] 返回，因此 Resource 和 MemoryStream 向 PdfReader 返回相同的类型，即 byte[]。然后，我从 PdfReader 对象创建一个 PdfStamper 对象，并使用 MemoryStream 作为 PdfStamper 的结果容器。

```
PdfReader _srcDoc = new PdfReader(Properties.Resources.Resource1);
MemoryStream _output = new MemoryStream();
PdfStamper _scratchDoc = new PdfStamper(_srcDoc, _output); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-22T13:52:53.060

也许有点晚了。尝试将流位置设置为 0。

```
...
stream.Flush(); // Don't know if this is necessary
stream.Position = 0;
PdfReader reader = new PdfReader(stream.ToArray());
... 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-02-18T15:09:04.707

如果您只想使用字节在浏览器中打开 pdf，请执行以下操作：

```
public void ReturnPDF(byte[] contents, string attachmentFilename)
        {
            var response = HttpContext.Current.Response;
            try
            {
                if (!string.IsNullOrEmpty(attachmentFilename))
                {
                    response.ContentType = "application/pdf";
                    response.AddHeader("Content-Disposition", "attachment; filename=" + attachmentFilename);
                }

                response.ContentType = "application/pdf";
                response.BinaryWrite(contents);
            }
            catch (Exception ex)
            {
                throw ex;
            }
            finally
            {
                response.End();
                response.Flush();
                response.Clear();
            }

        } 
```

# javascript - 从回调调用方法时如何从方法中获取正确的类上下文

> ID：14939105
> 
> 赞同：2
> 
> 时间：2013-02-18T14:54:59.040
> 
> 标签：javascript, oop, class, callback

我正在使用[Class.js](https://github.com/rauschma/class-js)来创建类。

从回调函数调用时，我没有在方法中获得正确的上下文

我的代码是

```
WordCloud = MyClass.extend({
    init: function(data) {
        var me = this;
        (......).on("onComplete", this.draw);
    },
    show: function(word) {
        alert(word)
    },
    draw : function(words){
        console.debug(this); // prints element that triggred `onComplete` action
        console.debug(words); // "Hi"
        console.debug(me); // me is not defined
        me.show(words) // Need to call this method
    }
}); 
```

问题是`draw`方法在动作完成时被触发，但内部`draw`方法`this`不是实际的`class`实例，而是触发回调动作的元素。

我不能在调用时传递 exta 参数，`this.draw`因为它是一个回调函数并且`onComplete`只有一个参数。

我怎样才能调用该`show`方法`draw`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:01:02.483

如果您不必支持 Internet Explorer 8 或更低版本，则可以使用[bind()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
init: function(data) {
    var me = this;
    (......).on("onComplete", this.draw.bind(this));
} 
```

否则，如果您已经在使用 jQuery，则可以利用[$.proxy()](http://api.jquery.com/jQuery.proxy/)，其工作方式相同：

```
init: function(data) {
    var me = this;
    (......).on("onComplete", $.proxy(this.draw, this));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T14:59:28.680

对于这些情况，我使用辅助函数。

```
function hitch(obj, func) {
    return function() {
        return obj[func].apply(obj, arguments || [])
    };
} 
```

要调用它，您将使用`hitch(this, 'draw');`而不是`this.draw`.

或者为了更简单，您可以在基类中添加简化版本

```
function hitch(func) {
    var that = this;
    return function() {
        return that[func].apply(that, arguments || [])
    };
} 
```

只是打电话`this.hitch('draw');`。

# javascript - 在 Javascript 中乘以浮点数时，这是否是处理舍入错误的可靠方法？

> ID：14939106
> 
> 赞同：2
> 
> 时间：2013-02-18T14:55:00.660
> 
> 标签：javascript, floating-point, rounding, multiplication

我正在向我的订单页面添加客户端小计计算，以便在用户进行选择时显示批量折扣。

我发现有些计算在这里或那里偏离了一美分。除了总数与最终计算的服务器端总数不匹配（在 PHP 中）之外，这并不是什么大问题。

我知道舍入误差是处理浮点数时的预期结果。例如，149.95 * 0.15 = 22.492499999999996 和 149.95 * 0.30 = 44.98499999999999。前者根据需要进行循环，后者则不需要。

我搜索了这个主题并找到了各种讨论，但没有一个能令人满意地解决这个问题。

我目前的计算如下：

```
discount = Math.round(price * factor * 100) / 100; 
```

一个常见的建议是以美分而不是美元为单位工作。但是，这需要我转换我的起始数字，将它们四舍五入，将它们相乘，将结果四舍五入，然后再将其转换回来。

本质上：

```
discount = Math.round(Math.round(price * 100) * Math.round(factor * 100) / 100) / 100; 
```

我正在考虑在四舍五入之前将数字加 0.0001。例如：

```
discount = Math.round(price * factor * 100 + 0.0001) / 100; 
```

这适用于我尝试过的场景，但我想知道我的逻辑。添加 0.0001 是否总是足够，而且永远不会太多，以强制获得所需的舍入结果？

注意：出于我的目的，我只关心每个价格的单一计算（因此不会复合错误）并且永远不会显示超过两位小数。

**编辑**：例如，我想将 149.95 * 0.30 的结果四舍五入到小数点后两位并得到 44.99。但是，我得到 44.98，因为实际结果是 44.98499999999999 而不是 44.985。错误不是由`/ 100`. 在那之前就已经发生了。

测试：

```
alert(149.95 * 0.30); // yields 44.98499999999999 
```

因此：

```
alert(Math.round(149.95 * 0.30 * 100) / 100); // yields 44.98 
```

考虑到乘法的实际结果，44.98 是预期的，但不是期望的，因为它不是用户所期望的（并且与 PHP 结果不同）。

**解决方案**：我要将所有内容都转换为整数来进行计算。正如公认的答案所指出的，我可以稍微简化我原来的转换计算。我添加 0.0001 的想法只是一个肮脏的黑客。最好为工作使用正确的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:33:55.300

我认为添加少量不会对您有利，我想在某些情况下添加太多了。它还需要正确记录，否则可能会被视为不正确。

> 以美分工作 [...] 需要我转换我的起始数字，将它们四舍五入，将它们相乘，将结果四舍五入，然后将其转换回：
> 
> `discount = Math.round(Math.round(price * 100) * Math.round(factor * 100) / 100) / 100;`

我认为它应该只在之后进行四舍五入。但是，您应该首先将结果相乘，以便[有效数字](http://en.wikipedia.org/wiki/Significant_figures)是前面两个 sig 数字的总和，即在您的示例中为 2+2=4 个小数位：

```
discount = Math.round(Math.round( (price * factor) * 10000) / 100) / 100; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:07:52.253

在您的数字中添加少量将不是很准确。您可以尝试使用库来获得更好的结果：[https](https://github.com/jtobey/javascript-bignum) ://github.com/jtobey/javascript-bignum 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T17:50:01.780

Bergi 的回答显示了一个解决方案。这个答案显示了一个数学证明，它是正确的。在此过程中，它还建立了输入中可以容忍多少错误的界限。

你的问题是这样的：

*   您有一个浮点数 x，它已经包含舍入误差。例如，它旨在表示 149.95，但实际上包含 149.94999999999998863131622783839702606201171875。
*   您想将此浮点数 x 乘以折扣值 d。
*   您想知道乘法到最接近的一分钱的结果，就像使用理想数学一样，没有错误。

假设我们再添加两个假设：

*   x 总是代表某个确切的美分数。也就是说，它表示一个精确到百分之几的数字，例如 149.95。
*   x 的误差很小，例如小于 0.00004。
*   折扣值 d 表示整数百分比（即，也是精确的百分之几，例如 0.25 表示 25%）并且在区间 [0%, 100%] 内。
*   错误是 d 很小，总是将小数点后两位的十进制数字正确转换为双精度（64 位）二进制浮点的结果。

考虑价值`x*d*10000`。理想情况下，这将是一个整数，因为 x 和 d 都是 0.01 的理想倍数，因此将 x 和 d 的理想乘积乘以 10,000 会产生一个整数。由于 x 和 d 的误差很小，因此四舍五入`x*d*10000`将产生理想的整数。例如，我们有 x 和 d 加上小误差 x+e0 和 d+e1，而不是理想的 x 和 d，我们正在计算 (x+e0)•(d+e1)•10000 = (x•d+ x•e1+d•e0+e0•e1)•10000。我们假设 e1 很小，所以主要误差是 d•e0•10000。我们假设 x 中的误差 e0 小于 0.00004，并且 d 最多为 1 (100%)，因此 d•e0•10000 小于 0.4。这个错误，加上 e1 的微小错误，不足以改变四舍五入`x*d*10000`从理想整数到其他整数。（这是因为误差必须至少为 0.5 才能更改应该为整数的结果的舍入方式。例如，3 加上 0.5 的误差将舍入为 4，但 3 加上 0.49999 不会。）

因此，`Math.round(x*d*10000)`产生所需的整数。然后`Math.round(x*d*10000)/100`是一个近似值`x*d*100`，精确到远小于一美分，因此将其四舍五入，`Math.round(Math.round(x*d*10000)/100)`精确地产生所需的美分数。最后，将其除以 100（以产生整数的百分比，而不是美分的整数）会产生新的舍入误差，但误差非常小，以至于当结果值正确转换为带两位小数的十进制，显示正确的值。（如果使用此值执行进一步的算术运算，则可能不正确。）

从上面我们可以看出，如果 x 的误差增长到 0.00005，这个计算就会失败。假设一个订单的价值可能增长到 100,000 美元。表示 100,000 左右的值的浮点误差最多为 100,000•2 ^(-53)。如果有人订购了 10 万件出现此错误的商品（他们不能，因为这些商品的单个价格会小于 100,000 美元，因此它们的错误会更小），然后将价格单独加起来，执行 10 万（减一）添加十万个新错误，那么我们有将近二十万个错误，最多 100,000•2 ^(-53)，所以总错误最多为 2•10 ⁵ •10 ⁵ •2 ^(-53)，大约是 0.00000222。因此，此解决方案应该适用于正常订单。

请注意，如果折扣不是整数百分比，则需要重新考虑解决方案。例如，如果折扣表示为“三分之一”而不是 33%，则`x*d*10000`预计不会是整数。

# google-maps-api-3 - Onclick 谷歌地图标记，但不是在平移地图时

> ID：14939107
> 
> 赞同：1
> 
> 时间：2013-02-18T14:55:02.837
> 
> 标签：google-maps-api-3

我正在使用这样的东西（javascript）：

```
google.maps.event.addDomListener(new_marker, 'click', function(e) {
  alert("hi");
}); 
```

但是我不希望它在用户移动地图时触发，他们只是在点击标记时碰巧这样做了。需要明确的是：我只希望代码在用户单击标记时运行，而不移动地图。我怎样才能做到这一点？

# ruby-on-rails - Rails mongoid 动态字段 - 没有方法错误

> ID：14939111
> 
> 赞同：0
> 
> 时间：2013-02-18T14:55:19.107
> 
> 标签：ruby-on-rails, mongoid

环境：

Rails-3.2.12

Ruby-1.9.3

Mongoid-3.1.1

我有模型：

```
class Item
   include Mongoid::Document
   field :name, type: String
   field :type, type: String
end 
```

但是如果我尝试在视图中添加动态字段，比如说“颜色”，我会得到一个未定义的方法错误。

`allow_dynamic_fields: true`在配置文件中启用。

_form.html.erb：

```
<%= form_for(@item) do |f| %>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
<div class="field">
  <%= f.label :type %><br />
  <%= f.text_field :type %>
</div>
<div class="field">
  <%= f.label :color %><br />
  <%= f.text_field :color %>
</div> 
```

如果我尝试编辑已经具有颜色属性的项目，一切正常。我需要添加几个取决于 item.type 但没有这样的动态属性：

```
<% if @item[:color] %>
  <%= f.text_field :color %>
<%else%>
  <%= text_field_tag 'item[color]' %>
<% end %> 
```

**编辑：**

错误：

项目中的 NoMethodError#new

显示第 31 行引发的 /app/views/items/_form.html.erb ：

#Extracted source 的未定义方法“color”（在第 31 行附近）：

```
28:     <%= f.number_field :type %>
29:   </div>
30:    <%= f.label :color %><br />
31:     <%= f.text_field :color %>
32:     <div class="actions">
33:       <%= f.submit %>
34:     </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:45:48.860

Mongoid 文档说：

“如果文档中不存在该属性，Mongoid 将不会为您提供 getter 和 setter，并将强制执行正常的 method_missing 行为。在这种情况下，您必须使用其他提供的访问器方法：([] 和 []=) 或（read_attribute 和 write_attribute）。”

您可以做的最简单的事情是使用 write_attribute 或 []= 在控制器#new 方法中设置“颜色”

```
@item['color'] = '' 
```

或者您可以将“颜色”属性动态添加到您的新 Item 单例类中：

```
class << @item
  field :color, type: String
end 
```

# c# - 从列表中获取数据到 JavaScript MVC 3？

> ID：14939122
> 
> 赞同：0
> 
> 时间：2013-02-18T14:56:00.770
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3, razor

我正在尝试使用 jq plot 绘制每天汽车租赁的条形图，因此 - x 轴将包含日期，然后包含两个条形 - 已租/未租。我目前将此返回到我的控制器中的列表。如果我设置了一个断点，我可以看到数据被返回，并且列表中的计数为 4（最大值将是 10，因为我对数据库的 Linq 查询执行了 Take(10)。

因此，我可以将以下内容视为列表中的一行示例

```
Date         Rented   Not Rented
18/02/2013   100      200 
```

jq plot 的 javascript 下面只是带有硬编码的值，以查看它是否显示它执行的操作，所以我现在想尝试得到的是 S1 中的值替换为我列表中的每个租用值和 s2 中的值替换我没有租用，然后将刻度替换为该行的相应日期

```
//s1 = Rented Values
//s2 = Not Rented Values
var s1 = [200, 600, 700, 1000];
var s2 = [460, 210, 690, 820];
// Can specify a custom tick Array.
// Ticks should match up one for each y value (category) in the series.
var ticks = ['Date', 'Date', 'Date', 'Date']; 
```

我在我的cshtml页面上寻找理想的东西，比如隐藏的东西，它将包含结果列表并以某种方式在JS中访问它？那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:05:08.483

一如既往地从定义视图模型开始：

```
public class MyViewModel
{
    public int Rented { get; set; }
    public int NotRented { get; set; }
    public DateTime Date { get; set; }
} 
```

然后让您的控制器操作查询您的后端并填充此视图模型：

```
public ActionResult SomeAction()
{
    IEnumerable<MyViewModel> model = ... go query your backend
    return View(model);
} 
```

最后在您的强类型视图中：

```
@model IEnumerable<MyViewModel>
...
<script type="text/javascript">
    var s1 = @Html.Raw(Json.Encode(Model.Select(x => x.Rented)));
    var s2 = @Html.Raw(Json.Encode(Model.Select(x => x.NotRented)));
    var ticks = @Html.Raw(Json.Encode(Model.Select(x => x.Date.ToString("dd/MM/yyyy"))));

    // Now that you have the 3 arrays plot them up.
</script> 
```

# cognos - 如何在cognos的pdf中显示来自blob的图像

> ID：14939124
> 
> 赞同：1
> 
> 时间：2013-02-18T14:56:00.947
> 
> 标签：cognos, cognos-8

我们最近采用了 Cognos 进行报告，事实证明它在许多情况下都能很好地工作。但现在我面临一个我认为很奇怪的问题，因为大多数用于报告的工具都支持这一点。我在数据库中有一个表，我将图像存储为 blob。我想在我的 Cognos 报告中显示这些图像，以发现它不支持开箱即用。

如果报表格式是 HTML，那么解决方案是在报表上放置一个图像控件并构造 URL 以指向您创建的某个 Web 应用程序，该应用程序访问数据库并在调用该 URL 时返回图像（可能有其他解决方案，但这是我知道的“A”解决方案）。

但就我而言，我使用 PDF 报告格式，我在整个互联网上进行了搜索，但找不到任何关于它的内容。所以我的问题是，无论如何要在 Cognos PDF 报告中显示 blob 图像，还是根本不支持它，我对此无能为力？是否有任何 cognos 版本支持这一点，或者我没有希望拥有这样的东西？

PS我正在使用cognos 8.4.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:00:56.207

我认为您不走运，因为 Cognos 在生成 PDF 时需要从磁盘读取图像。

以下是一些替代解决方案：

尝试从数据库中提取您需要的图像并将它们写入磁盘，然后您可以使用 Cognos 使用 Cognos 的标签或图像工具从磁盘读取图像。

或者

构建一个充当图像但从数据库（代理）读取数据的 Web 服务，因此当在标记中调用图像时，Web 服务会从数据库返回字节。虽然我从未尝试过，但它可以工作。值得一试 imo ;)

你可以在这里找到一些例子：

1.  [http://www.codeproject.com/Questions/466769/save-and-retrieve-some-online-image-in-database-us](http://www.codeproject.com/Questions/466769/save-and-retrieve-some-online-image-in-database-us)
2.  [http://forums.aspfree.com/code-bank-54/create-webservice-retrieve-image-database-23738.html](http://forums.aspfree.com/code-bank-54/create-webservice-retrieve-image-database-23738.html)

# android - 来自 ApiDemos 示例的 FragmentLayout 类中的奇怪 FragmentTransaction

> ID：14939126
> 
> 赞同：7
> 
> 时间：2013-02-18T14:56:05.073
> 
> 标签：android, android-fragments, sample, fragmenttransaction

很抱歉，这个问题是针对那些在**Eclipse**上工作并可以访问**ApiDemo 示例代码**的人。
具体来说，我正在尝试将片段活动基于名为**FragmentLayout的示例**

以下代码对我来说是有问题的（*您可以在 ApiDemo **FragmentLayout.java**，**ShowDetails()**方法*中找到完整的代码）：

```
 // Execute a transaction, replacing any existing fragment
                // with this one inside the frame.
                FragmentTransaction ft = getFragmentManager().beginTransaction();
                if (index == 0) {
                    ft.replace(R.id.details, details);
                } else {
                    ft.replace(R.id.a_item, details);
                }
                ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
                ft.commit(); 
```

我有两个问题：

1.  `index == 0`和有什么区别`index != 0`？

2.  资源R.id_a_item（仅在所有ApiDemo中出现，搜索后）属于某种菜单快捷资源，完全不清楚为什么在这里使用它。

android.developers 指南没有解释这段代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T17:21:02.203

> index == 0 和 index != 0 有什么区别？

位置和列表的其他位置之间不应该有任何区别，`0`因为代码设置为简单地用新的细节片段替换以前的细节片段。

> 资源R.id_a_item（仅在所有ApiDemo中出现，搜索后）属于某种菜单快捷资源，完全不清楚为什么在这里使用它。

很可能这是示例中的错误，因为使用该 id 会引发异常，因为它在当前布局中不存在（我已经运行了`API Demos`在 4.2 模拟器上找到的项目，它抛出*没有找到视图异常......等*该ID）。可能在样本的最后一个版本中出现了错误，因为您质疑的代码段在其他版本中不存在。

# ruby-on-rails - Rails+passenger+nginx 使用 url 运行应用程序，但没有 :port

> ID：14939127
> 
> 赞同：1
> 
> 时间：2013-02-18T14:56:07.660
> 
> 标签：ruby-on-rails, nginx, passenger

我有一个 rails 应用程序...我安装了 chain: nginx+passenger 并运行 rails server。但我的问题是，在浏览器中我必须设置 url，如：

```
page.com:3000 
```

但是如何只使用page.com？

我无法运行`passenger start -e=development -p=80`用户限制命令....

我的 nginx 配置文件是这样的：

```
server {
        listen      80;
        server_name  localhost;

        #charset koi8-r;
        #root /home/prog/OnlineAuto/Shop/public;
        #passenger_enabled on;
        #access_log  logs/host.access.log  main;
        location / {
                root /home/prog/OnlineAuto/Shop/public;
                index  index.html index.htm;
                passenger_enabled on;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
} 
```

那么如何在没有任何端口的情况下按域获取我的 rails 应用程序？（但在 3000 端口上运行 rails 服务器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:22:16.147

您正在尝试在 Nginx 使用的同一端口上启动乘客，这可能是您收到错误的原因。

我对 Unicorn 更熟悉，但根据我读过的文档，您不必在单独的进程中启动Passenger。正确安装乘客后，我认为您只需要 Nginx 指令即可使其工作。

在http块中配置你的passenger_root和passenger_ruby `nginx.conf`，然后

```
http {
  passenger_root /<path_to_passenger_install>;
  passenger_ruby /usr/local/bin/ruby;

  server {
    listen 80;
    server_name page.com;
    charset utf-8;
    root /www/page.com/public;
    passenger_enabled on;
    rails_spawn_method smart;
    rails_env development;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-10T17:46:35.243

如果你在这里使用乘客，我必须使用它来让它在 www.mysite.com 上运行，而无需在 centos 服务器上使用 www.mysite.com:80：

在 etc/httpd/conf 中，关键是取消注释 NameVirtualHost *:80 并将 * 更改为我的服务器的 IP 地址。确保未注释 Listen 80。还将您的 ip 添加到 VirtualHost 标签。它必须在端口 80 上运行，而不是 8080 或您选择的端口。

```
NameVirtualHost xx.xx.xx.xx:80  

Listen 80  

<VirtualHost xx.xx.xx.xx:80>
    ServerName www.mysite.com
    # !!! Be sure to point DocumentRoot to 'public'!
    DocumentRoot /var/www/vhosts/mysite.com/httpdocs/public/
    <Directory /var/www/vhosts/mysite.com/httpdocs/public/>
       # This relaxes Apache security settings.
       AllowOverride all
       # MultiViews must be turned off.
       Options -MultiViews
    </Directory>
</VirtualHost> 
```

# javascript - 随机移动的图像被屏幕的左上角吸引

> ID：14939129
> 
> 赞同：1
> 
> 时间：2013-02-18T14:56:12.670
> 
> 标签：javascript, graphics, random, dhtml, entropy

我正在尝试制作在屏幕上随机移动的图像。

图像在屏幕上随机定位，然后每 10 毫秒从 -15 像素移动到 15 像素。

但是几秒钟后，图像会集中在屏幕的左上角，而不是分散在整个屏幕上（或者至少集中在屏幕的另一个角落）......

你可以在这里看到我的代码：http: [//secretlabs.alwaysdata.net/bug.html](http://secretlabs.alwaysdata.net/bug.html)

```
window.onload = function() {
    var imgUrl = 'http://image.jeuxvideo.com/smileys_img/18.gif';
    var imgs = [];
    var imgPos = [];

    for(var i = 0; i < 50; i++) {
        // Create 50 images.

        imgs.push(new Image());
        imgs[i].src = imgUrl;
        imgs[i].style.position = 'absolute';

        // Position them randomly on the screen.

        imgPos[i] = [Math.floor(Math.random() * window.innerWidth),
                    Math.floor(Math.random() * window.innerHeight)];

        imgs[i].style.left = imgPos[i][0] + 'px';
        imgs[i].style.top = imgPos[i][1] + 'px';
        document.body.appendChild(imgs[i]);
    }

    window.setInterval(function() {
        for(var i = 0; i < 50; i++) {
            // Move randomly each image from -15px to 15px, vertically and horizontally.

            imgPos[i][0] += Math.floor(Math.random() * 30) - 15;
            imgPos[i][1] += Math.floor(Math.random() * 30) - 15;

            // Avoid images to go out of the screen.

            if(imgPos[i][0] < 0)
                imgPos[i][0] = 0;
            if(imgPos[i][1] < 0)
                imgPos[i][1] = 0;
            if(imgPos[i][0] > window.innerWidth - 16)
                imgPos[i][0] = window.innerWidth - 16;
            if(imgPos[i][1] > window.innerHeight - 16)
                imgPos[i][1] = window.innerHeight - 16;

            imgs[i].style.left = imgPos[i][0] + 'px';
            imgs[i].style.top = imgPos[i][1] + 'px';
        }
    }, 10);
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:00:13.983

如果您想要更少的偏见，请不要四舍五入为负值。

代替

```
Math.floor(Math.random() * 30) - 15 
```

和

```
Math.round(Math.random() * 30  - 15) 
```

* * *

我只是用这段代码做了一个小测试：

```
var N = 1000000;
for (var j=0; j<20; j++) {
  var sum = 0;
  for (var i=N; i-->0;) sum += Math.round(Math.random() * 30  - 15);
  console.log(sum/N);
} 
```

[好像没问题](http://jsbin.com/ivotun/1/)（打开控制台）

# php - MySql find_in_set() 与 PHP PDO 不兼容

> ID：14939136
> 
> 赞同：2
> 
> 时间：2013-02-18T14:56:20.200
> 
> 标签：php, pdo

关于以下为什么会引发参数错误的任何想法。我已经查看了关于 SO 的所有其他答案，但无论如何我都以与那些解决方案相同的方式来解决这个问题，但这似乎仍然不起作用。将应用程序从 adodb 切换到 pdo。

```
$possible_keys = implode( ",", $possible_keys_array ); 
```

sql片段

```
WHERE
FIND_IN_SET(table.key,:possible_keys)

$STH = $DBH->prepare( $sql );

$STH->execute( array( $possible_keys ) );

$STH->setFetchMode( PDO::FETCH_ASSOC ); 
```

我只放了代码的快照。但是，如果我将 :possible_keys 占位符替换为 possible_keys 变量的实际文本，则一切正常。我正在为为什么这不起作用，因为变量只是一个字符串而摸不着头脑。它不断抛出以下错误：

```
SQLSTATE[HY093]: Invalid parameter number: parameter was not defined 
```

ps 我只包含了被证明是问题的子句，而不是整个查询。我知道其余的都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:05:20.710

您正在使用命名参数，但没有将其绑定。您需要指定名称：

```
$STH->execute(array(':possible_keys' => $possible_keys)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:06:22.137

1）您正在使用命名占位符，但您正在传递一个非关联数组。

如果您使用问号作为占位符，请像这样传递一个数组：

```
$STH->execute(array("a", "b", "c")) 
```

如果您使用命名占位符，请像这样传递一个数组：

```
$STH->execute(array("name" => "a", "name2" => "b", "name3" => "c")) 
```

编辑：在我的回答中，我首先声明您不能将参数放置在您现在拥有的位置（在 IN() 语句中）。显然，这*应该*有效。

# optimization - 需要关于曲线处理的建议（曲线拟合、插值）

> ID：14939138
> 
> 赞同：0
> 
> 时间：2013-02-18T14:56:26.157
> 
> 标签：optimization, interpolation, curve-fitting

我有一组点形成一些曲线，见图。这条曲线由直线和曲线部分组成，我不知道它们的确切起点或终点。在展示的图片中，我至少知道五个部分：两个直线部分，一个具有恒定半径的部分，另外两种类型的曲线。我希望能够识别这些部分，将它们彼此分开并像使用单独的曲线一样使用它们。

更新。

在我看来，样条曲线不会按照我想要的方式工作，而且肯定不是 Besier。我在考虑非线性最小二乘，但不确定它是否适合这种情况。如果我能够分离零件，那么我可以将线性最小二乘法用于直线，而将一些非线性用于其他部分。否则，我需要一些适用于所有类型曲线的通用方法：1、2 和 3 次方。

请分享你的想法。谢谢你。 ![曲线](../Images/e3bc83eb1069dec993eb0b2572a96007.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T12:37:04.690

对于弯管，我建议使用多维样条拟合。您的管子看起来不像是由直线部分和弯曲部分组成，而是一路平滑地弯曲。

[http://en.wikipedia.org/wiki/Spline_interpolation](http://en.wikipedia.org/wiki/Spline_interpolation)

如果您想进一步阅读，这是起点。猜测一下，我想您对样条曲线没有经验，因此如果您可以将数据集以表格形式呈现给我，或者其他一些读者可以使用 3D 样条曲线插入给定数据。

# php - 将数据加载到水平时间轴

> ID：14939140
> 
> 赞同：0
> 
> 时间：2013-02-18T14:56:29.633
> 
> 标签：php, html, mysql

我想创建一个全屏时间轴 Web 应用程序，它可以水平左右滚动，显示一些 html 和 css 格式的文本，可能带有添加的图像、视频和/或音频文件。

时间线应该从它最右边的位置（“今天的日期”）开始，提供一个滚动条，允许用户向左滚动以查看较早的事件，并向右滚动以查看稍晚的事件，一直回到最右边位置（已经提到的“今天的日期”）。

有很多数据要加载到时间线中（价值 150 多年的事件，仅大约 200 页文本）——这让我认为，如果我将所有数据转储到一个水平格式化、可滚动的 html 页面中，它可能会导致一个需要永远加载的超重页面，在某些（大多数？）浏览器中可能难以滚动，甚至可能导致浏览器崩溃。（不过，我可能弄错了。请参阅我的问题＃1。）

因此，我正在考虑解决方案，当页面滚动“靠近”页面（左侧或右侧）时将所需数据加载到页面中，并在页面滚动到离它足够远时再次卸载。

不是网络编程“大师”，我对这项任务有点困惑，希望得到一些建议。

我的问题：

1.  假设不应该立即将所有数据加载到水平页面中，我错了吗？也许这样做可以吗？

2.  处理整个过程的更浏览器友好的方式是什么：a）花几秒钟从数据库中*预加载*整个时间线的所有数据，然后在需要时将这些数据的片段*回*显到一个*div*中？- 或 b) 仅在需要时从数据库中加载数据？

3.  如何使用 PHP/HTML 实际完成预加载/打印或加载？

4.  也许有人知道已经完成我所描述的开源或商业水平时间线？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:01:11.253

我不确定这是否满足您的所有需求，但看起来可能很接近 - 试试[http://timeline.verite.co/](http://timeline.verite.co/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:31:32.430

1.  这取决于你的情况。但我认为这个想法很棒（我只是觉得你的时间线看起来像一个画廊、一张专辑……）。

2.  我的答案是`a`和`b`。我会在需要时从数据库中加载这些数据（但是当页面滚动“关闭”到它时我会加载这些数据）例如：我在 2013 年，我会花几秒钟来加载 2011 年，和 2012 年（或最后 100 项）

3.  我认为我们可以通过`ajax`.

4.  我真的不知道，但我认为您可以从框架中自定义/继承某些东西，这是在 Raad 的回答中介绍的。

-5。您可以创建自己的时间线。也许你会花很多时间来做这件事。

我们如何创建这个时间线？您可以使用关键字搜索：`infinite scroller`。

# google-chrome - 当标签在后台时，Chrome 是否使用不同的事件计时？

> ID：14939142
> 
> 赞同：0
> 
> 时间：2013-02-18T14:56:35.013
> 
> 标签：google-chrome, javascript-events, jquery

我注意到选择标签时，Chrome会完美播放：

[http://static.echonest.com/InfiniteGangnamStyle/](http://static.echonest.com/InfiniteGangnamStyle/)

但是选择不同的选项卡时，以一致的模式分解。我很好奇为什么 - 当标签在后台时，这似乎暗示 Chrome 有不同的事件模型或时间或优先级。没有其他运行，唯一的变化是选定的选项卡。

我已经尝试对此进行分析，但没有成功——使用扩展，但它们似乎同样容易受到变化的影响。

当然，也可能只有我。假设这是 Chrome 中的预期行为，有谁知道为什么会发生这种情况，以及它是否会影响我编写 JavaScript 以在后台正常运行的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:35:25.983

我猜你正在使用 setTimeout 或 setTinterval 所以当你切换其他选项卡计时器时每秒只运行 1 次

[https://code.google.com/p/chromium/issues/detail?id=66078](https://code.google.com/p/chromium/issues/detail?id=66078)

# elasticsearch - 在嵌套资源上使用 AND 过滤器

> ID：14939146
> 
> 赞同：1
> 
> 时间：2013-02-18T14:56:51.357
> 
> 标签：elasticsearch

我的问题是：Elasticsearch 计数与我的数据库不同。

我索引了“用户”表，每个用户可以有一个或多个 apps_events ：

```
curl localhost:9200/users/_count
{"count":190291,"_shards":{"total":5,"successful":5,"failed":0}}

SELECT COUNT(*) FROM users
count : 190291 
```

=> 相同的计数，一切正常！

但是，当我对 2 个过滤器进行搜索时，一个术语和一个术语是嵌套资源：

```
curl -X GET 'http://localhost:9200/users/user/_search?load=&size=10&pretty' -d '
{
"query": {
  "match_all": {
  }
},
"filter": {
  "and": [
    {
      "terms": {
        "apps_events.type": [
          "sale"
        ]
      }
    },
    {
      "term": {
        "apps_events.status": "active"
      }
    }
  ]
},
"size": 10
}

total : 63756 
```

在我的数据库中：

```
SELECT
  COUNT(DISTINCT(users_id))
FROM
  apps_event
WHERE
  apps_event_state_id = 1 AND apps_event_project_id = 2;

count : 63340 
```

因为实际上elasticsearch SQL等效查询是：

```
SELECT
  COUNT(DISTINCT(users_id))
FROM apps_event
WHERE apps_event_state_id = 1
AND users_id IN
  (SELECT DISTINCT(users_id) FROM apps_event WHERE apps_event_project_id = 2)

count : 63756 
```

===> 我如何为每个资源做一个简单的“与”？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:17:19.677

您可能已经检查过这个，但`apps_event_project_id`正确的推论是`apps_events.type`？从表面上看，它们似乎不一样，但您肯定会知道。另外，是否`users_id`直接映射到 ES `_id`？可能是您的索引中有重复项，这增加了它的计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T17:24:25.853

“嵌套资源”的最佳资源： [http ://www.spacevatican.org/2012/6/3/fun-with-elasticsearch-s-children-and-nested-documents/](http://www.spacevatican.org/2012/6/3/fun-with-elasticsearch-s-children-and-nested-documents/)

# php - 如何清理 PHP 中的 POST 和 GET 变量以进行 XSS 和 SQL 注入

> ID：14939148
> 
> 赞同：1
> 
> 时间：2013-02-18T14:57:06.513
> 
> 标签：php, http-post, xss, http-get

在我的网络应用程序中是一个配置文件，其中包括即数据库连接设置 ans 总是在 PHP 脚本的第一行加载。我想包含一个函数，它可以清除所有 POST 和 GET 数据，以应对可能存在的 XSS 和 SQL 注入风险。

我不确定该功能是否真的足够

```
function make_safe($variable) 
{
   $variable = strip_tags(mysql_real_escape_string(trim($variable)));
   return $variable; 
}

foreach ($_POST as $key => $value) {
   $_POST[$key] = make_safe($value);
}
//Same for $_GET & $_SESSION 
```

你有这个问题的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:02:28.600

这个功能：

```
function make_safe($variable) 
{
   $variable = strip_tags(mysql_real_escape_string(trim($variable)));
   return $variable; 
} 
```

不管用

SQL 注入和 XSS 是两种不同的野兽。因为它们每个都需要不同的转义，所以您需要分别使用每个转义函数 strip_tags 和 mysql_real_escape_string。加入他们将破坏每个人的安全性。

将数据输入数据库时​​使用标准的 mysql_real_escape_string()。在将内容输出到屏幕之前从数据库中查询内容时使用 strip_tags()。

为什么结合这两个功能是危险的从马口中： http: [//php.net/manual/en/function.strip-tags.php](http://php.net/manual/en/function.strip-tags.php)

因为`strip_tags()`实际上并不验证 HTML，部分或损坏的标签可能会导致删除比预期更多的文本/数据。

因此，通过将格式错误的 html 输入到数据库字段中，聪明的攻击者可以使用您的幼稚实现来击败`mysql_real_escape_string()`您的组合。

# windows-phone-7 - 位置服务坐标系

> ID：14939151
> 
> 赞同：0
> 
> 时间：2013-02-18T14:57:19.480
> 
> 标签：windows-phone-7, windows-mobile-gps

Windows Phone 7 设备正在使用哪个坐标系？如果我使用 WP 7 获取纬度和经度，它们是否等同于 WGS84 和墨卡托坐标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:14:50.853

这里有两个部分..如果您使用内置 GPS 并询问坐标，它们会为您提供 GeoPosition，它会显示纬度/经度等

与 WP7 一起使用的 Bing 地图使用墨卡托瓦片系统

[http://msdn.microsoft.com/en-us/library/bb259689.aspx](http://msdn.microsoft.com/en-us/library/bb259689.aspx)

如果您搜索 msdn，您会发现各种示例。这是我不久前修改的一个 [http://invokeit.wordpress.com/2012/06/30/bing-mapcontrol-offline-tiles-solution-wpdev-wp7dev/](http://invokeit.wordpress.com/2012/06/30/bing-mapcontrol-offline-tiles-solution-wpdev-wp7dev/)它包含许多助手。

# google-app-engine - GAE 数据存储：按日期间隔过滤

> ID：14939152
> 
> 赞同：2
> 
> 时间：2013-02-18T14:57:20.963
> 
> 标签：google-app-engine, google-cloud-datastore

我有这个模型：

```
class Vehicle(db.Model):
    ...
    start_production_date = db.DateProperty()
    end_production_date = db.DateProperty() 
```

例如，我需要过滤所有在生产中的车辆，比如 2010 年：

我以为我可以这样做：

```
q = (Vehicle.all()
    .filter('start_production_date >=', datetime(2010, 1, 1))
    .filter('end_production_date <', datetime(2011, 1, 1))) 
```

买我得到`BadFilterError`：

```
BadFilterError: invalid filter: Only one property per query may have inequality filters (<=, >=, <, >).. 
```

那么，我该如何实现呢？此外，在我看来，这似乎是一项相当普遍的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:34:57.023

一种方法是将模型更改为以下内容：

```
class Vehicle(db.Model):
    ...
    start_production_date = db.DateProperty()
    start_production_year = db.IntegerProperty()
    start_production_month = db.IntegerProperty()
    start_production_day = db.IntegerProperty()

    end_production_date = db.DateProperty()
    end_production_year = db.IntegerProperty()
    end_production_month = db.IntegerProperty()
    end_production_day = db.IntegerProperty() 
```

在每个 put 上更新这些新值（您可以[覆盖 put](https://stackoverflow.com/a/2753747/8418)）并且简单地说：

```
# specific year

q = (Vehicle.all()
    .filter('start_production_year =', 2010))

# specific year, different months

q = (Vehicle.all()
    .filter('start_production_year =', 2010)
    .filter('start_production_month IN', [1, 2, 3, 4]))

# different years

q = (Vehicle.all()
    .filter('start_production_year IN', [2010, 2011, 2012])) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T18:35:06.353

我选择了这个解决方案：

我在模型中设置了一个`ListProperty`包含模型制作年份的项目：

```
vhl.production_years = range(start_production_date.year, end_production_date + 1) 
```

然后测试：

```
q = (Vehicle.all()
    .filter('production_years =', 2010)) 
```

# jquery - 将 jquery 转换为 jquery noConflict

> ID：14939157
> 
> 赞同：1
> 
> 时间：2013-02-18T14:57:38.093
> 
> 标签：jquery

我有这段 javascript 代码，我必须使用 jquery noConflict 对其进行转换，以使其与 wordpress jquery 一起使用。你有什么线索可以做到这一点吗？

```
var initCharts = function() {
var charts = $('.percentage');
  charts.easyPieChart({
    animate: 2000
  });
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T14:59:59.493

[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

```
jQuery.noConflict();
(function($) {
  $(function() {

var initCharts = function() {
var charts = $('.percentage');
  charts.easyPieChart({
    animate: 2000
  });
}

  });
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:00:41.733

```
$.noConflict();

(function($) { 
  $(function() {
    // more code using $ as alias to jQuery
  });
})(jQuery);
// other code using $ as an alias to the other library 
```

根据您的代码：

```
(function($){
    $(document).ready(function() {
      var initCharts = function() {
      var charts = $('.percentage');
      charts.easyPieChart({
      animate: 2000
      });
    } 
  });
})(jQuery); 
```

# android - 使屏幕上的所有 EditText 失焦

> ID：14939160
> 
> 赞同：1
> 
> 时间：2013-02-18T14:57:51.333
> 
> 标签：android, android-edittext, autocompletetextview

我有一个包含 20-25 个相似行的 XML 布局，用于设置不同的参数。这些行包含一个`AutoCompleteTextView`和一个`ImageButton`。每当在这些视图之一中设置选项时，都会调用一个方法来设置我的代码中的变量，然后刷新所有视图。可以通过三种方式设置每个变量... `AutoCompleteTextView:`OnKeyListener, OnItemSelectedListener.... `ImageButton:`OnClickListener

以下是其中一行的这一部分的示例：

```
pumpCountAutoText = new AutoCompleteTextView( this );
pumpCountAutoText.setHint( R.string.anti_pump_pump_count_hint );
pumpCountAutoText.setTextSize( 12.0f );
pumpCountAutoText.setLayoutParams( editLP );
pumpCountAutoText.setThreshold( 1 );
pumpCountAutoText.setId( 11001 );
pumpCountAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, pumpCountList);
pumpCountAutoText.setAdapter( pumpCountAdapter );
pumpCountAutoText.setOnKeyListener(new OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        // if keydown and "enter" is pressed
        if ((event.getAction() == KeyEvent.ACTION_DOWN)
            && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                String item = pumpCountAutoText.getText().toString();
                hideSoftKeyboard( MoreParameters.this );
                pumpCountAutoText.dismissDropDown();
                if( hasRead ) {
                    if(pumpCountList.contains( item ) ) {
                         if( !( item.equals( " " ) ) ) {
                                int val = Integer.parseInt( item );
                                //Log.i( "pumpCountSpinner", Integer.toString( val ) );
                                RelayAPIModel.NativeCalls.SetParmJava( RelayAPIModel.PARM_PUMPCOUNT, val );
                            }
                        }
                    }
                    return true;
                }
                return false;
            }
         });
        pumpCountAutoText.setOnItemClickListener( new OnItemClickListener() {

            public void onItemClick(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                // TODO Auto-generated method stub
                hideSoftKeyboard( MoreParameters.this );
                String item = pumpCountAutoText.getText().toString();
                if( !( item.equals( " " ) ) ) {
                    int val = Integer.parseInt( item );
                    //Log.i( "pumpCountSpinner", Integer.toString( val ) );
                    RelayAPIModel.NativeCalls.SetParmJava( RelayAPIModel.PARM_PUMPCOUNT, val );
                }
            }

        });

        pumpCountDropdownButton = new ImageButton( this );
        pumpCountDropdownButton.setLayoutParams( dropLP );
        pumpCountDropdownButton.setId( 11002 );
        pumpCountDropdownButton.setImageResource( R.drawable.arrow_down_float );
        pumpCountDropdownButton.setOnClickListener( new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                AlertDialog.Builder ab=new AlertDialog.Builder(MoreParameters.this);
                ab.setTitle( R.string.anti_pump_pump_count_hint );
                ab.setItems( pumpCountList.toArray( new String[pumpCountList.size()]), new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int pos ) {
                        String item = pumpCountList.get( pos );
                        if( !( item.equals( " " ) ) ) {
                            int val = Integer.parseInt( item );
                            RelayAPIModel.NativeCalls.SetParmJava( RelayAPIModel.PARM_PUMPCOUNT, val );
                        }
                    }
                });
                ab.show();
            }

        }); 
```

我的问题是，在设置任何这些项目后，屏幕顶部的文本字段会自动获得焦点并显示该视图的下拉菜单。这非常烦人。我想在任何视图中选择一个项目并且不显示这些下拉菜单。

我尝试了两件事：

1) 我添加了 AutoCompleteTextView.setCursorVisible(false);

2）我也试过这个：

```
specialCTAutoText.setFocusable( false );
specialCTAutoText.setFocusableInTouchMode( false );
specialCTAutoText.setText( temp );
specialCTAutoText.setFocusable( true );
specialCTAutoText.setFocusableInTouchMode( true ); 
```

当我的所有视图都在此处未显示的第二种方法中刷新时，我尝试的第二件事被调用。这工作正常。但是，一旦我编辑了这三种方式之一的文本视图，它仍然会自动选择顶部的编辑文本视图。

我希望这足够清楚，但需要任何澄清让我知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:10:39.607

> 但是，一旦我编辑了这三种方式之一的文本视图，它仍然会自动选择顶部的编辑文本视图。

`requestFocus()`当您“以这三种方式之一编辑文本视图”时，请尝试在某个时间点调用其他小部件。

# wcf - 为 WCF Web 服务部署创建 WIX 合并模块之前的注意事项

> ID：14939162
> 
> 赞同：0
> 
> 时间：2013-02-18T14:58:08.963
> 
> 标签：wcf, wix, installation

我想使用 WIX 将我的 WCF Web 服务部署到 IIS，我想为此创建一个合并模块项目。我想将此合并模块包含在其他主包中吗？我怎样才能做到这一点？有什么例子吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T20:10:50.873

你用什么来消费合并模块。安装盾牌？维克斯？其他？上述所有的？

当它被添加到产品中时，它总是相同的网站/vdir/端口还是可以不同？

这可能很棘手，并且可能不适合合并模块。至少我会创建两个合并模块（1 个用于文件，1 个用于 IIS 扩展块），这样产品可以使用文件，但如果需要，可以创建自己的 IIS。

如果你只做 WiX，片段和库将是一条更好的下路。这样，某人可以引用正确的组件组集来获得相同的粒度。

# c# - 应用程序未在 Windows Azure 上使用 CS0101 编译

> ID：14939163
> 
> 赞同：0
> 
> 时间：2013-02-18T14:58:09.037
> 
> 标签：c#, .net, azure

我一直在 Windows Azure 中的 .NET 站点上工作。昨晚我进行了部署并开始收到以下错误：

```
Server Error in '/' Application.
Compilation Error
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 
Compiler Error Message: CS0101: The namespace 'Avviato.PVSA.Objects' already contains a definition for 'LogProccess'

Source Error:
    Line 13: namespace Avviato.PVSA.Objects
    Line 14: {
    Line 15:     public class LogProccess
    Line 16:     {
    Line 17:         public long logId { get; set; }
>Source File: c:\DWASFiles\sites\pvsadev\VirtualDirectory0>\site\wwwroot\App_Code\Objects\LogProcess.cs    Line: 15 
```

我做了一些研究，根据 MSDN，当您对所涉及的类有多个声明时会触发此错误。但是，我浏览了我的代码，并且该类没有第二个声明`LogProcess`。该项目在本地运行。有人暗示这可能是缓存在 Azure 上的一些编译错误，所以我尝试在 Azure 的新站点上进行部署，一切正常。

所以问题是：是否有任何其他原因可能触发此错误？如果缓存理论是真的，有没有办法清除 Azure 上的编译缓存？

我已经使用 VS2012 中的 Windows Azure SDK 进行了部署。如果它有帮助，这里是生成错误的类的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.SqlClient;
using System.Data;
using System.Configuration;
using Avviato.PVSA.Utils;
namespace Avviato.PVSA.Objects
{
    public class LogProccess
    {
        public long logId { get; set; }
        public DateTime createDate { get; set; }
        public GlobalEnums.LogStatus status { get; set; }
        public GlobalEnums.ObjectType objectType { get; set; }
        public string errorMessage { get; set; }
        public GlobalEnums.LogErrorType errorType {get; set;}
        public long localId { get; set; }
        public string externalId { get; set; }
        public string parameters { get; set; }
        public string testAzure { get; set; }
        public LogProccess()
        {
        }
        public bool  Save()
        {
            bool saved = false;
            SqlCommand command = new SqlCommand();
            SqlConnection connection = new SqlConnection(ConfigurationManager.ConnectionStrings["PVSA_BD_CONNECTION"].ToString());
            try
            {
                connection.Open();
                command.Connection = connection;
                if (this.logId == 0) // actually the story only can be create, not updated
                {
                    command.CommandText = @"INSERT INTO [tblLog] ([createdDate],[status],[typeObject],[errorMessage],[typeError],[localId],[externalId],[parameters])
                                          VALUES(
                                            @createdDate,@status,@typeObject,@errorMessage,@typeError,@localId,@externalId,@parameters
                                           )";

                    command.Parameters.AddWithValue("@createdDate", DateTime.Now);
                    command.Parameters.AddWithValue("@status", this.status);
                    command.Parameters.AddWithValue("@typeObject", this.objectType);
                    command.Parameters.AddWithValue("@errorMessage", (string.IsNullOrEmpty(this.errorMessage)) ? System.Data.SqlTypes.SqlString.Null : this.errorMessage);
                    command.Parameters.AddWithValue("@typeError", this.errorType);
                    command.Parameters.AddWithValue("@localId", this.localId);
                    command.Parameters.AddWithValue("@externalId", (string.IsNullOrEmpty(this.externalId)) ? System.Data.SqlTypes.SqlString.Null : this.externalId);
                    command.Parameters.AddWithValue("@parameters", (string.IsNullOrEmpty(this.parameters)) ? System.Data.SqlTypes.SqlString.Null : this.parameters);
                    command.ExecuteNonQuery();
                }
            }
            catch (SqlException sqlEx)
            {
                Util.LogExceptionWithQuery(sqlEx, "Registering log", command);
            }
            catch (Exception ex)
            {
                Util.LogException(ex, "Registering log");
            }
            finally
            {
                connection.Close();
            }
            return saved;
        }
    }
} 
```

# c# - 针对非异步服务的异步编程

> ID：14939164
> 
> 赞同：2
> 
> 时间：2013-02-18T14:58:11.047
> 
> 标签：c#, asp.net, asynchronous, threadpool

在过去的一年里，我们一直在开发一个调用我们公司现有服务层的新 Web 应用程序。

我们决定将所有面向服务的调用包装到我们自己的服务层（我将其称为我们的 Web 服务层），以便我们使用哪些服务的详细信息（我们将转移到新的 API在未来的某个时候）对 Web 层本身隐藏。

我们还决定我们的大多数 Web 服务层方法将返回`Task<T>`.

就目前而言，我们调用的底层服务不是异步的，因此有人担心我们的 Web 服务层会最大化可用线程并在我们拥有大量用户时导致问题。

我正在寻找一种或另一种方式的信息，以进一步了解我们的退货决定`Task<T>`将如何影响我们的网站，以及我们是否需要考虑更改我们的退货类型。

我们将在某个时候迁移到 VS2012，但现在我们使用的是 VS2010，而不是使用`async`and `await`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:11:40.507

> 就目前而言，我们调用的底层服务不是异步的，因此有人担心我们的 Web 服务层会最大化可用线程并在我们拥有大量用户时导致问题。

是的，这是你应该关心的事情。我建议您仅在具有真正的异步方法时才这样做。但是，简单地将阻塞同步方法包装到异步 API 中会比直接从使用代码中调用同步方法更糟糕。在 ASP.NET 应用程序中，只有当底层 API 依赖于 I/O 完成端口时，您才能从异步调用中受益。否则只是浪费资源。

您可以这样做的唯一有用的场景是您的方法可以并行调用而不是顺序调用。这是可能的，只是它们之间没有连接不同的方法。在这种情况下，您确实可以将同步方法包装在异步任务中。

# database - 数据库设计汽车模型/汽车分类

> ID：14939173
> 
> 赞同：1
> 
> 时间：2013-02-18T14:58:32.070
> 
> 标签：database, database-design

我正在开发汽车分类广告，但我不确定如何设计一些东西的最佳方式，汽车有一些特点，比如它是否有 2,4 门，如果它是 4x4 或 4x2，发动机 1.6、2.0。

所有这些功能都是汽车特有的，但它们必须仅限于该模式所具有的功能，因此每次有人发布自行车时，它都不会在下拉列表中显示 4x4 或比该型号发动机的选项。

我不想让这个通用，它只适用于汽车，所以思考它如何最适合通用分类它不一定。

设计这个的最佳方法是什么？

更多信息：

我的问题是如何设计汽车模型和实际汽车之间的关系，例如模型年可以从 1990 年到 2000 年，当有人要添加该模型的汽车时，我只希望他们能够选择从模型的选项中。我如何将其存储在数据库中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T19:12:11.883

您需要区分汽车模型实例（“my car vin xxx”）和汽车模型规范（“2009 Mazda 3”）。一般来说，模型规范有一个型号，一个模型实例有一个序列号（在这种情况下是 VIN）。

您还需要区分模型规范的可用选项和模型实例的实际安装选项。

```
/* the model specifications: */
vehicle_model
id
model_name
from_year
to_year (nullable)
manufacturer_id

/* engine specifications */
engine
id
name (ex. "Cummings Turbo Diesel")
...

/* available engines for a model. you would use this table to show only the appropriate engines for a given model spec */
vehicle_model_engine
model_id
engine_id

/* vehicle instances: */
vehicle
id
vin
model_id FK vehicle_model
engine_id FK engine 
```

您可以将一个多列外键从 vehicle(model_id, engine_id) 放到 vehicle_model_engine(model_id, engine_id)，或者只将一个键放到 engine(id) 并在保存前使用应用程序逻辑进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T17:28:36.920

我在一家汽车公司工作，我建议从年份、品牌、型号和装饰开始。所有汽车都有这些值。您可以将它们硬编码到数据库结构中。

除此之外，只需制作一个包含这些附加属性的属性表。

不要费心尝试专门为引擎、门数等创建字段。您会惊讶于有些汽车有多个引擎（！）。

YMMT 和属性表：

```
 # Vehicle

vehicle_id int not null (auto increment),
year int,
make varchar(100),
model varchar(100),
trim varchar(100)

# Vehicle_Attribute

vehicle_id int,
attribute_name varchar(100),
attribute_value varchar(100) 
```

# drupal-7 - “连接已重置”

> ID：14939174
> 
> 赞同：3
> 
> 时间：2013-02-18T14:58:32.313
> 
> 标签：drupal-7, installation, wamp

我已将 Drupal 站点从实时服务器复制到测试环境，以便进一步开发。我已经在 WAMP 环境中进行了设置，成功导入了数据库并为该站点设置了虚拟主机。

我可以毫无问题地连接到该站点并登录。当我想访问管理页面时，我从浏览器（[http://www.MYSITE.local/da/admin/modules](http://www.MYSITE.local/da/admin/modules)）收到以下消息：

```
The connection has been reset 
```

当我检查 Firebug 的网络时，Firefox 将请求报告为“已中止”。

Apache 日志文件中没有错误。另外，我启用了 PHP 错误进行调试，但没有显示任何内容。

我已重置缓存，在 phpMyAdmin 中查找 CSS 和 Javascript 的压缩设置，但没有找到我可以禁用的任何设置。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:58:46.113

迁移后，如果您遇到问题，请运行 [rebuild_registry](http://drupal.org/project/registry_rebuild)并解决。**请注意，它不是 drupal 的模块。**它可用作 drush 的一个非常有用的子模块。

我强烈建议为 Windows 手动安装 drush。按照[说明](http://drupal.org/node/594744)安装 drush。

安装运行后，

```
drush dl registry_rebuild 
```

从哪个目录运行此命令并不重要，因为它是 drush 扩展而不是 drupal 扩展。Drush 将下载所需的文件并将其放置在适当的位置。

完成后，您可以访问您的站点文件夹并运行

```
drush rr 
```

那应该重建注册表并清除缓存。大多数迁移问题都会自动修复。如果它不能解决您的问题，请发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-11T18:08:34.590

如果它没有帮助 - 就像在我的情况下，将以下代码添加到您的 httpd.conf 这将增加堆栈大小（默认 1MB）

```
<IfModule mpm_winnt_module>
  ThreadStackSize 8388608
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T17:48:58.010

手动截断所有缓存表和可以解决的会话：

例如：

```
Truncate table myprefix_cache;
Truncate table myprefix_cache_admin_menu;
Truncate table myprefix_cache_block;
Truncate table myprefix_cache_bootstrap;
Truncate table myprefix_cache_field;
Truncate table myprefix_cache_filter;
Truncate table myprefix_cache_form;
Truncate table myprefix_cache_image;
Truncate table myprefix_cache_l10n_update;
Truncate table myprefix_cache_libraries;
Truncate table myprefix_cache_media_xml;
Truncate table myprefix_cache_menu;
Truncate table myprefix_cache_page;
Truncate table myprefix_cache_path;
Truncate table myprefix_cache_rules;
Truncate table myprefix_cache_token;
Truncate table myprefix_cache_update;
Truncate table myprefix_cache_variable;
Truncate table myprefix_cache_views;
Truncate table myprefix_cache_views_data;
Truncate table myprefix_sessions; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-19T13:07:45.127

我通过访问性能并禁用聚合和压缩 CSS 来解决这个问题。

# jquery - Internet Explorer 10 上的 JqueryUI 句柄不可点击

> ID：14939175
> 
> 赞同：4
> 
> 时间：2013-02-18T14:58:36.010
> 
> 标签：jquery, jquery-ui, internet-explorer-10, jquery-ui-resizable

我对 jQueryUI 可调整大小和 Internet Explorer 有疑问。我正在创建一个可调整大小的 div，其中包含一个带有一些文本的跨度。在 IE10 中，如果文本大于容器 div，则 div 的句柄只能在文本上方和下方单击。在 Chrome 中它可以完美运行。

这是代码（我做了一个[jsFiddle](http://jsfiddle.net/goffreder/9Dtzd/5/)进行测试）：

HTML

```
<div id="event">
    <span>some text some text</span>
</div> 
```

CSS

```
#event {
    float: left;
    position: absolute;
    border: 2px solid #197ea3;
    background: #aee3f4;
    height: 16px;
    overflow: hidden;
    font-family: Verdana, Geneva, Arial, Helvetica, sans-serif;
    font-size: 10px;
    line-height: 16px;
    padding-left: 3px;
    white-space: nowrap;
    text-overflow: ellipsis;
} 
```

Javascript

```
$(document).ready(function() {
    $("#event").resizable({
        handles : "e"
    })
}); 
```

编辑：我添加了`text-overflow: ellipsis`属性并更新了 jsFiddle

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:16:08.203

啊，是的，IE 是最好的（最差的）。不幸的是，我正在工作，所以当我回到家时，我必须更彻底地研究这个问题，但这里有一个快速的建议：

首先，我建议不仅考虑 IE 10，还要考虑早期版本的 IE（降到 7 或 8）。是的，有些人（尤其是公司计算机）陷入了石器时代。

现在在您的标题部分中，我将添加：

```
<meta http-equiv="X-UA-Compatible" content="IE-7;IE-8;IE-9;IE-10;" /> 
```

让我知道这是否对您有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:31:51.783

感谢我的老板，我找到了一个简单而优雅的解决方案：`text-overflow: ellipsis`. 如果文本大于容器，则此 css 属性（我不知道，真丢脸）在文本末尾添加三个点。这些点显然不算作“标准文本”，所以不要超过句柄。

不幸的是，这不是一个完整的解决方案，因为如果文本与容器完全一样大，则不会出现点并且句柄仍然无法访问......

我将使用新属性编辑该问题的 jsFiddle 链接。

# php - 根据更改的权限注销用户

> ID：14939181
> 
> 赞同：0
> 
> 时间：2013-02-18T14:58:49.927
> 
> 标签：php, database, administration

我是一个新手 php 程序员，在 codeigniter 中构建一个多用户应用程序。

现在，我的老板告诉我要研究根据更改的用户访问权限注销人员的能力。

外汇。一个人以半管理员身份登录，但刚刚被真正的管理员降级为普通用户状态。现在半管理员应该在发生这种情况时被注销，但这是我的问题发生的地方。

我可以想出几种方法来做到这一点，但它们都围绕着在大多数情况下进行多余的检查（这是一种罕见的情况，但它已经发生了，我被告知）

目前我最好的选择是在会话数据库中记录所有活动用户，并在他们的用户角色发生变化时强制他们重新登录。

然而，这将在服务器上为一个罕见的“问题”生成大量流量，因为用户会话数据更适合放入常规会话中。

因此，简而言之，我的问题是，如何在用户权限发生更改时注销用户，而又不让我的服务器工作太辛苦。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:05:25.643

在页面上添加一个javascript监听器，然后当超级管理员将半管理员权限更改为普通用户时，触发注销事件。确保应用程序启用了 javascript，否则将无法运行。许多基于 ACL 的应用程序都使用此解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:06:25.137

您可以检查权限是否定期更改，例如每 10 分钟一次，这应该会减少“无用”查询的数量，并仍然确保对更改的登录用户权限有可接受的响应时间。

# javascript - 使用 Ajax 加载 html 后执行代码

> ID：14939184
> 
> 赞同：0
> 
> 时间：2013-02-18T14:59:08.690
> 
> 标签：javascript, jquery, ajax

当使用 Ajax 将 html 页面加载到我的页面中时，我想运行一些代码，如下所示：

```
$( ".content" ).load("game.html"); 
```

我想在该 html 完成加载后执行操作，请问它是如何完成的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:01:44.777

```
$( ".content" ).load("game.html", function() {
    // add your code here
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:02:05.373

只需附加一个回调函数，

```
$( ".content" ).load("game.html", function(){
    //YOUR CODE TO EXECUTE
    alert('completed');
}); 
```

查看 jQuery 文档以获取更多信息，[http://api.jquery.com/load/](http://api.jquery.com/load/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:01:23.437

如果您[阅读有关 .load() 方法的文档](http://api.jquery.com/load/)，您会看到它允许您提供一个回调函数，该回调函数将在加载完成时调用。

```
$(".content").load("game.html", function() {
    //put your code that you want to run here
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:01:31.347

你检查过 jQuery 文档吗？

[http://api.jquery.com/load/](http://api.jquery.com/load/)

```
$('#result').load('game.html', function() {
  alert('Load was performed.');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T15:01:43.610

您可以为此使用回调：

```
$( ".content" ).load("game.html",function(e){
    // use e, like $(e).find("#some-id")
}); 
```

# google-analytics - 从脚本设置动态目标值，无需电子商务跟踪

> ID：14939185
> 
> 赞同：1
> 
> 时间：2013-02-18T14:59:09.240
> 
> 标签：google-analytics, goal-tracking

有没有办法在目标页面中设置动态目标值？

我用过这段代码（显然没有用）：

```
<script type="text/javascript">
    _gaq.push(['_setAccount', 'UA-XXXXXXX-1']);
    _gaq.push(['_trackEvent', 'GoalValue', 'BookingForm', 'Finalize', 120]);
    _gaq.push(['_trackPageview', '/final-page']);
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:04:23.703

您可以创建一个事件目标，然后将该事件用作目标，并将该事件的价值用作目标值。但是，如果您选择使用基于事件的目标，您将没有渠道。

在这种情况下，我会同时创建一个基于 Url 的目标，其值为 0 仅用于跟踪渠道，另一个基于事件的目标用于为转化设置正确的值。

# android - 使用 savedInstanceState.getInt("Phase", 1); 时出现空指针异常？

> ID：14939189
> 
> 赞同：0
> 
> 时间：2013-02-18T14:59:13.707
> 
> 标签：android

我在 OnCreate 函数内的这一行上遇到空指针异常：

```
int Phase = savedInstanceState.getInt( "Phase", 1 ); 
```

根据我阅读的内容，如果键“Phase”没有映射存在，则此函数应返回与“Phase”关联的值或 1。但是由于某种原因，我得到了这个例外，关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:03:19.440

可能是您的 savedInstanceState 对象是`null`. 例如，如果您的活动或片段是从布局更改中重新创建的，则它不会为空。

尝试使用：

```
if(savedInstanceState != null) {
  Phase = savedInstanceState.getInt( "Phase", 1 );
} else {
  Phase = ...some other meaningful value...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:01:54.760

我相信你得到的错误不是因为缺少键，而是因为变量 `savedInstanceState`为空。你检查过吗？

# c++ - 提升 shared_from_this 和多重继承

> ID：14939190
> 
> 赞同：13
> 
> 时间：2013-02-18T14:59:15.150
> 
> 标签：c++, shared-ptr, multiple-inheritance, enable-shared-from-this

我目前在使用 boost`enable_shared_from_this`和多重继承时遇到了一些麻烦。

该场景可以描述如下：

1.  类`A`实现了一些功能，应该继承自`enable_shared_from_this`

2.  类`B`实现了另一个功能，应该继承自`enable_shared_from_this`

3.  类从和( )`D`继承功能`A``B``class D : public A, public B {}`

4.  当使用类中的某些类`B`功能时，`D`我遇到了异常（`bad_weak_ptr`）

5.  `enable_shared_from_this`从类继承`D`不是我的选择

我不确定如何解决这个问题。

哦，我正在使用 Visual C++ 2010。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T17:25:16.190

扩展 Potatoswatter 的解决方案，如果您可以更改 A 和 B 以使用与 enable_shared_from_this 略有不同的东西。代码使用标准库版本，但 boost 实现应该类似。下面的解释

```
#include <memory>
template<typename T>
struct enable_shared_from_this_virtual;

class enable_shared_from_this_virtual_base : public std::enable_shared_from_this<enable_shared_from_this_virtual_base>
{
    typedef std::enable_shared_from_this<enable_shared_from_this_virtual_base> base_type;
    template<typename T>
    friend struct enable_shared_from_this_virtual;

    std::shared_ptr<enable_shared_from_this_virtual_base> shared_from_this()
    {
        return base_type::shared_from_this();
    }
    std::shared_ptr<enable_shared_from_this_virtual_base const> shared_from_this() const
    {
       return base_type::shared_from_this();
    }
};

template<typename T>
struct enable_shared_from_this_virtual: virtual enable_shared_from_this_virtual_base
{
    typedef enable_shared_from_this_virtual_base base_type;

public:
    std::shared_ptr<T> shared_from_this()
    {
       std::shared_ptr<T> result(base_type::shared_from_this(), static_cast<T*>(this));
       return result;
    }

    std::shared_ptr<T const> shared_from_this() const
    {
        std::shared_ptr<T const> result(base_type::shared_from_this(), static_cast<T const*>(this));
        return result;
    }
}; 
```

因此，其意图是`struct A`公开继承`enable_shared_from_this_virtual<A>`并`struct B`公开继承`enable_shared_from_this_virtual<B>`. 由于它们都共享相同的公共虚拟对象，因此层次结构中只有一个`std::enable_shared_from_this`。

当您调用任一 classes`shared_from_this`时，它执行从`enable_shared_from_this_virtual<T>*`到 T* 的转换，并使用 shared_ptr 的别名构造函数，以便新的 shared_ptr 指向 T* 并与单个共享指针共享所有权。

使用顶部的朋友是为了防止任何人直接访问虚拟基地的 shared_from_this() 成员。他们必须通过提供的那些`enable_shared_from_this_virtual<T>`。

一个例子：

```
#include <iostream>

struct A : public enable_shared_from_this_virtual<A>
{
    void foo()
    {
        shared_from_this()->baz();
    }

    void baz()
    {
        std::cout << __PRETTY_FUNCTION__ << std::endl;
    }
};

struct B : public enable_shared_from_this_virtual<B>
{
    void bar()
    {
        shared_from_this()->baz();
    }

    void baz()
    {
        std::cout << __PRETTY_FUNCTION__ << std::endl;
    }
};

struct D: A, B {};

int main()
{
 std::shared_ptr<D> d(new D);
 d->foo();
 d->bar();
 return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T16:00:50.070

A`shared_ptr`是不可见容器对象或“控制块”的观察者。这个容器总是在堆上，从不在栈上，你不能直接处理它。尽管`shared_ptr`并`weak_ptr`提供了唯一的观察手段，但仍然有一个隐藏层拥有该对象。填充的是那个隐藏层`enable_shared_from_this`。

`enable_shared_from_this`不允许多重继承，因为所有`enable_shared_from_this`基础都需要单独初始化，但控制块无法获取给定类型的所有基础子对象的列表。它所能得到的只是一个模棱两可的基本错误。

我看到的唯一解决方案是添加一个`virtual`基类，`A`它`B`继承自`enable_shared_from_this`. 您可以为此目的指定一个特定的类：

```
struct shared_from_this_virtual_base
    : std::enable_shared_from_this< shared_from_this_virtual_base >
    {};

struct shared_from_this_base : virtual shared_from_this_virtual_base {};

struct A : shared_from_this_base { … };
struct B : shared_from_this_base { … }; 
```

但是，还有另一个问题：你不能从`virtual`基础向下转换，因为它是否包含`A`或`B`包含`shared_from_this_virtual_base`. 要恢复`A*`or`B*`您必须将这些指针添加到`shared_from_this_virtual_base`. 这可能会通过将另一个 CRTP 模式添加到`shared_from_this_base`. 对于 C++ 来说，这比平时多一些步法，但我没有看到任何概念上的捷径。

**编辑：**啊，获得沮丧的最简单方法是放入一个`void*`成员，`shared_from_this_virtual_base`然后将其转换`D*`为任何客户端代码所知道的`D`. 相当可行，即使不是非常优雅。或者`boost::any`可以提供更安全的替代方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T15:30:26.057

该标准对于应该如何实现有点模糊`shared_from_this`，但所有实现似乎都同意，因为 Boost 提供了一个参考实现。

当您创建构造函数时`boost::shared_ptr<D> myD(new D())`，`shared_ptr`检查是否存在从`D*`to`enable_shared_from_this<X>*`的明确转换`X`（这意味着`D`具有 type 的基类`enable_shared_from_this<X>`）。如果转换有效，则`weak_ptr<X>`基类中的 a 将设置为引用新创建的`shared_ptr`.

在您的代码中，有两种可能的转换， to`enable_shared_from_this<A>`和`enable_shared_from_this<B>`，这是不明确的，因此 no`weak_ptr`设置为引用`myD`. `B`这意味着如果稍后调用的成员函数`shared_from_this()`将得到一个`bad_weak_ptr`异常，因为它的`enable_shared_from_this<B>`成员从未设置过。

# android - Android：一个接一个地播放两种声音

> ID：14939191
> 
> 赞同：1
> 
> 时间：2013-02-18T14:59:24.393
> 
> 标签：android, media-player, android-mediaplayer

我正在尝试播放两个声音项目，一个接一个

```
MediaPlayer mp        = null;

 protected void produceErrorSound(int index) {
        if (mp != null) {
            mp.reset();
            mp.release();
        }

        mp = MediaPlayer.create(this, index);

        mp.start();
    }

public void correctAnswerAndNext(){
    produceErrorSound(R.raw.right1) ;
    produceErrorSound(R.raw.right1) ;
} 
```

但只产生第二种声音。有没有其他方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T15:05:57.380

我在您的代码中看不到任何等待机制。

当您的第一个 MediaPlayer 完成播放时，您可以使用[onCompletionListener](https://developer.android.com/reference/android/media/MediaPlayer.OnCompletionListener.html)接收回调。此时您可以启动第二个 MediaPlayer。

Jellybean（和更高版本）中的另一种方法是使用音频链接功能（即[setNextMediaPlayer](https://developer.android.com/reference/android/media/MediaPlayer.html#setNextMediaPlayer%28android.media.MediaPlayer%29)）在当前播放完成后立即自动启动另一个 MediaPlayer。像这样的东西（为简洁起见，我省略了对`setDataSource`etc 的调用）：

```
mediaPlayer1.prepare();
mediaPlayer2.prepare();   
mediaPlayer1.start();
mediaPlayer1.setNextMediaPlayer(mediaPlayer2); 
```

# javascript - javascript数组只显示第一个字符

> ID：14939193
> 
> 赞同：4
> 
> 时间：2013-02-18T14:59:27.373
> 
> 标签：javascript, jquery, plugins, ckeditor

我目前正在开发一个 ckeditor 插件，选择框从数据库中获取其数据，我只能让第一个字符出现在选择框中。

get_pages.php

```
$query = selectQuery('
    SELECT title, pageID
    FROM  `page_info` 
    WHERE partnerID =?',array($partnerId));
$test = '';
foreach ($query as $key => $value) {
$test .= $value['title'].",";
} 
```

**插件.js**

```
var pages = $.post(
        "/action/ac_select_pages.php",
        { pid: "1" },
        function(data) {
            return (data);         
    }
);

pages = pages.responseText.split(','); 
```

我的变量：

```
pages: Array[31]  
    0: "Home"  
    1: "Control Panel"  
    2: "24/7 Support"  
    3: "Script / Databases"  
    4: "Last Announcment"  
    5: "E-mail: No Limit"  
    6: "Webmail & Push Mail" 
```

等等..

我做什么来制作我的选择框：

```
{
    type : 'select',
    id : 'moreinfo',
    label : 'Meerinfo Link',
    style : 'width:300px;',
    items : pages ,
    setup : function( element )
    {
    this.setValue( element.getAttribute( "moreinfo" ) );
    },
    commit : function( element )
    {
    var id = this.getValue();
    // If the field is non-empty, use its value to set the element's id attribute.
    if ( id )
    element.setAttribute( 'moreinfo', id );
    // If on editing the value was removed by the user, the id attribute needs to be removed.
    // http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.dom.element.html#removeAttribute
    else if ( !this.insertMode )
        element.removeAttribute( 'moreinfo' );
    }
} 
```

如您所见，我只是将数组放入 items 中，但它只显示第一个字符 ![对话块](../Images/0a3be04948a947387981d2ede5914c58.png)

那么我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T19:01:08.513

所以，总结...

[`split()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split) *通过将字符串拆分为子字符串，将 String 对象拆分为字符串数组。*

所以，大概你的`pages.responseText`样子是这样的：

```
Home,Control Panel,24/7 Support,Script / Databases,Last Announcment,E-mail: No Limit,Webmail & Push Mail 
```

这意味着在做之后`pages = pages.responseText.split(',');`，`pages`看起来像这样（一个数组）：

```
["Home", "Control Panel", "24/7 Support", "Script / Databases", "Last Announcment", "E-mail: No Limit", "Webmail & Push Mail"] 
```

根据您[之前的评论](https://stackoverflow.com/questions/14939193/javascript-array-only-first-character-displayed#comment-20966890)，这有效：

```
var pages = [{0: 'Home', 1: 'Control Panel', ...}]; 
```

如您所见（具有多个值的数组）：

```
["Home", "Control Panel", ...] 
```

与（一个具有多个属性的对象的数组）不同**：**

```
[{0: 'Home', 1: 'Control Panel', ...}] 
```

* * *

如果所有这些仍然是正确的，那么这样的事情应该可以工作：

```
var pagesObject = {};
for (var i=0, max=pages.length; i<max; i += 1) {
  pagesObject[i] = pages[i];
}

var correctPages = [ pagesObject ]; 
```

演示在这里：http: [//jsbin.com/ikazes/1/edit](http://jsbin.com/ikazes/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T11:24:58.217

基于**Ayman Sadadi**的 for 循环，我终于明白了：）

```
// page1, 1,00,page2, 12,00,page3, 23 \\
pages = pages.responseText.split(',00,');
// ["page1, 1","page2, 12","page3, 23"] \\
var a = [];
a[0] = '';
for (var b = 0; b < pages.length; b++) {
    var c = pages[b].split(', ');
    var pageName = c[0];
    var pageId = c[1];
    a[b] = [ pageName, c ];
}; 
```

现在是：

```
a: Array[31]
  0: Array[2]
    0: "Home"
    1: Array[2]
      0: "Home"
      1: "1"
    length: 2
    __proto__: Array[0]
 1: Array[2]
    0: "Control Panel"
    1: Array[2]
      0: "Control Panel"
      1: "152"
    length: 2
    __proto__: Array[0] 
```

这与所需的相同`[['Home']['Control Panel']]`。如果我使用它作为我的项目，它可以正常工作。

之前的对话：

> 尝试将本地数据放在选择中。var pages = [{0: '主页', 1: '控制面板', ...}];。...
> 
> * * *
> 
> 我试过了:)它可以工作，但是由于页面不断添加和删除，我无法在选择中对页面进行硬编码
> 
> * * *
> 
> Ayman Safadi：根据你之前的评论，这行得通……

仅当我对其进行硬编码时，它`[['home']['Control Panel']]`才能正常工作。`[{0: 'Home', 1: 'Control Panel', ...}]` 不工作。我很抱歉有点不清楚我的意思。

谢谢你帮我解决我的问题。
**归功于 Ayman Safadi / pbaris :)**

# c# - 如何获取文本框中写入的最新字符？

> ID：14939200
> 
> 赞同：8
> 
> 时间：2013-02-18T14:59:42.287
> 
> 标签：c#, textbox, windows-phone-7.1, windows-phone-8, windows-phone

我想知道如何获取用 TextBox 编写的最新字符。这并不意味着字符串的最后一个。例如，我这样写：

> 这是一个测试。

但是我忘记了 's'，所以我将手指移到了 'i' 上，然后添加了 's'：

> 这是一个测验。

那么，我怎样才能得到's'？

我想得到它的字符或字符串，但我不知道该怎么做......

我希望很清楚。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T15:07:25.647

如果要获取最后写入的字符，则将[TextBox](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.controls.textbox%28v=vs.105%29.aspx)订阅到[KeyDown](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.uielement.keydown%28v=vs.105%29.aspx)事件：

C＃：

```
textBox.KeyDown += textBox_KeyDown; 
```

XAML：

```
<TextBox x:Name="textBox" KeyDown="textBox_KeyDown" /> 
```

然后：

```
private void textBox_KeyDown(object sender, KeyEventArgs e)
{
    /* e.Key contains the keyboard key associated with the event. */
} 
```

如果要获取最后写入字符的索引，那么这个就比较复杂了。解决方案之一可能是在`TextBox`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T15:14:15.050

yBee 的答案几乎是正确的，除了事件被调用`KeyDown`，而不是`KeyPress`，至少在 Windows Phone 8 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T04:52:12.287

看看吧，也许有帮助。要获取 Text 的最后一个字符，另一个建议是附加一个

`"\n"`( `nameTextbox.Append("\n")`)

然后，使用

`int lineCount = nameTextbox.Lines.Count();`

最后，使用方法

`nameTextbox.GetFirstCharIndexFromLine(lineCount)`.

在那里，您可能将 (index-1) （或无论如何，小心并用较小的文本对其进行测试）作为最后一个字符的索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-04T22:37:26.127

使用此代码获取插入文本框中的最后一个字符

```
 private void Textbox1_KeyDown(object sender, KeyEventArgs e)
            {
                lastchar_inserted = e.KeyValue.ToString(); // global string variable
            } 
```

# dojo - 使用 inlineditbox 和 dgrid 进行验证

> ID：14939202
> 
> 赞同：0
> 
> 时间：2013-02-18T14:59:44.853
> 
> 标签：dojo

我搜索了一个小部件来验证表单，但只找到了`validateTextBox widget`一个小部件，但我需要一个小部件来验证`inlineEditBox`和 Dgrid。
是否有任何其他验证工具`validateTextBox`可以做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:13:49.860

嗯，我认为 InlineEditBox 和 dgrid 都应该能够使用 ValidationTextBox。您是否尝试过类似的方法：

```
A <span data-dojo-type="dijit/InlineEditBox" 
        data-dojo-props="editor:'dijit/form/ValidationTextBox', 
            editorParams:{regExp:'\\w+'}">chicken</span> crossed the road. 
```

# c++ - 如何正确使用 istream::get ( char* s, streamsize n, char delim );

> ID：14939204
> 
> 赞同：2
> 
> 时间：2013-02-18T14:59:45.057
> 
> 标签：c++

文档说：

```
istream::get ( char* s, streamsize n, char delim );

// Extracts characters from the stream and stores them as a 
// c-string into the array beginning at s 
```

我试图分析这个函数的作用。它需要一个“按值”的指针。那就是它不能分配动态内存并设置指向`s`它的指针。它只能更改指针`s`指向的内容。

但是如果函数不能执行动态内存分配，它怎么能返回一个长度未知的输出呢？我应该如何使用这个功能？我应该预先分配内存并将指针传递给它`s`，然后自己删除它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T15:02:49.487

文档很清楚：

> 将它们作为 c 字符串存储到从 s 开始的数组中

–`s`必须指向一个足够大以容纳读取字符串的有效数组。

> 它如何返回长度未知的输出

*最大长度*是已知的，它是（`n`实际上`n - 1`，因为一个字符是为 C 字符串的空终止保留的）。

[但是，鉴于您的`std::string``getline`](http://en.cppreference.com/w/cpp/string/basic_string/getline)问题，[使用](http://en.cppreference.com/w/cpp/string/basic_string/getline).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-18T15:02:24.387

您应该预先分配 size 的内存（由 指向`s`）`n`，并将其传递`s`给函数的第一个和 `n`第二个参数。这样，`get`将读取最大`n`字节（包括终止 null）并将它们复制到指向的缓冲区`s`

如果您的缓冲区是本地的（可以说是堆栈上的一个数组），您不必删除它（实际上您不能）但是如果它是动态的（即，由 new[]、malloc、operator new 分配或其他）然后你必须相应地释放它。

例子：

```
const int n = 50;
char *s = new char[n];

cin.get(s, n);
//...

delete []s; 
```

注意：虽然这是有效的，正如其他人评论的那样，更好地使用`std::string`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-18T15:04:26.513

你应该像这样使用它：

```
const int size = 10;
char s[size]; //large enough to fit string
stream.get(&s[0], size, '\n'); 
```

您预先分配所需的缓冲区并确保它足够大以适合目标字符串。

# tfs - 如何在 Team Foundation Server/Microsoft 测试管理器中创建多值列表？

> ID：14939206
> 
> 赞同：1
> 
> 时间：2013-02-18T14:59:54.280
> 
> 标签：tfs, microsoft-test-manager

我正在开发 VSTS 2010 并使用 Microsoft 测试管理器来管理我们团队的测试用例。我只想按照[此处](http://www.dotnetcurry.com/ShowArticle.aspx?ID=755)和[此处](http://blogs.msdn.com/b/vstsqualitytools/archive/2011/09/21/customize-your-test-case-work-item-template-to-enable-query-on-test-suites-test-plans-test-categories-and-execution-statistics.aspx)的步骤将测试类别的自定义字段（具有 BVT、FVT、回归等值）添加到现有的测试用例模板中。但我无法选择多个值。我可以创建一个下拉列表，其中可以选择其中一个值，但不能超过一个。但是由于一个测试用例可以是多个测试类别的一部分，我怎样才能做到这一点？

我的步骤：

1.  在流程编辑器中，工作项类型创建一个名为测试类别的新字段，引用名称为 MyCustomField
2.  在规则中，我选择了 AllowedValues 作为 BVT、FVT、回归。
3.  之后，在 Layout 选项卡中创建了一个名为 Test Categories 4.The field name of the control is set to MyCustomField
4.  当我签入 MTM 以创建新的测试用例时，控件显示为下拉菜单，而不是[此处显示的](http://blogs.msdn.com/b/vstsqualitytools/archive/2011/09/21/customize-your-test-case-work-item-template-to-enable-query-on-test-suites-test-plans-test-categories-and-execution-statistics.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:04:47.053

您尝试使用的控件严格为 1 到 1（不允许多个值），因此对于这个问题并没有真正简单的答案，但这里有一些选项：

1- 创建 3 个自定义字段 BVT、FVT 和回归，每个字段都有一个是/否输入。

2-按照此处的步骤操作：[多值列表控件](http://blogs.msdn.com/b/visualstudioalm/archive/2013/02/15/multivaluelist-control-in-tfs-work-item-tracking.aspx)

3-升级到VS2012并使用标记。

# c# - 是否存在置换

> ID：14939207
> 
> 赞同：3
> 
> 时间：2013-02-18T14:59:56.773
> 
> 标签：c#, sql, linq, linq-to-sql

我试图找出 linq to sql 中的正确查询，但我不知道该怎么做。假设我有一个包含以下内容的表（该表基本上是一对多的关系）

```
Id (PK) | SupervisorId | EmployeeId
    1          1            5
    2          1            6
    3          1            7
    4          2            5
    5          2            6
    6          3            7
    7          4            7
    8          4            8 
```

我希望我的 linq to sql 查询找到具有 employeeId 5 和 6 的 supervisorId。该查询将仅返回 2。我可以使用 2 个 where 子句，但假设我想输入 3 个employeeId，我的查询必须修改。如果一个匹配的 SupervisorId 不存在传递的排列（例如：在这种情况下为 5,6,8），则结果将为 null 或空。

该函数如下所示：

```
int FindSuperVisorId(List<int> employeeIds); 
```

对于这种情况，我真的不知道从哪里开始 linq to sql。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:17:15.747

我必须将您的表建模为多对多关系，如下所示：

```
CREATE TABLE [dbo].[Employee](
    [Name] [nvarchar](50) NOT NULL,
    [Id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_Employee] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)

CREATE TABLE [dbo].[SupervisorEmployees](
    [SupervisorId] [int] NOT NULL,
    [EmployeeId] [int] NOT NULL,
 CONSTRAINT [PK_SupervisorEmployees] PRIMARY KEY CLUSTERED 
(
    [SupervisorId] ASC,
    [EmployeeId] ASC
)
GO

ALTER TABLE [dbo].[SupervisorEmployees]  WITH CHECK ADD  CONSTRAINT [FK_SupervisorEmployees_Employee] FOREIGN KEY([SupervisorId])
REFERENCES [dbo].[Employee] ([Id])
GO

ALTER TABLE [dbo].[SupervisorEmployees] CHECK CONSTRAINT [FK_SupervisorEmployees_Employee]
GO

ALTER TABLE [dbo].[SupervisorEmployees]  WITH CHECK ADD  CONSTRAINT [FK_SupervisorEmployees_Employee1] FOREIGN KEY([EmployeeId])
REFERENCES [dbo].[Employee] ([Id])
GO

ALTER TABLE [dbo].[SupervisorEmployees] CHECK CONSTRAINT [FK_SupervisorEmployees_Employee1]
GO 
```

然后首先使用实体​​框架数据库（不幸的是不是 Linq to SQL）以下 LINQPad 代码可以正常工作：

```
void Main()
{
    FindSupervisorIds( new List<int>{5,6} ).Dump();
}

IEnumerable<int> FindSupervisorIds(List<int> employeeIds)
{
    // two Excepts to do 'sequence equals'
    var supervisors = Employees.Where (e =>
        !e.Employees.Select (em => em.Id).Except(employeeIds).Any()
        && !employeeIds.Except(e.Employees.Select (em => em.Id)).Any() 
    );

    return supervisors.Select (s => s.Id).Distinct();
}

int? FindSupervisorId(List<int> employeeIds)
{
    var supervisors = FindSupervisorIds(employeeIds).ToList();

    if(supervisors.Count == 1)
    {
        return supervisors.First ();
    }

    return null;
} 
```

FindSupervisorIds 生成单个 SQL 查询。如果您需要检查只有一个匹配的主管，最好在返回的主管列表上调用 ToList()，如 FindSupervisorId 中所示。

尝试对 LINQ to SQL 执行相同操作失败，因为调用了 except 异常 **“NotSupportedException：本地序列不能在查询运算符的 LINQ to SQL 实现中使用，但包含运算符。”**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:27:14.350

所以我很确定这个查询应该被转换为 LINQ to SQL 的属性，但我不完全确定。

因此，首先我们按主管分组，以便我们为该主管提供员工序列。然后我们`Except`在两个方向上与您感兴趣的员工一起使用。如果这两个`Except`调用的计数为零，则集合完全相等。有更有效的方法可以确定两个集合在 linq-to-objects 中是否相等，但我怀疑它们是否会正确转换为 SQL 代码。

```
var supervisorId = table.GroupBy(item => item.SupervisorId)
    .Select(group => new
    {
        additionalItems = group.Select(item => item.EmployeeId).Except(employees),
        missingItems = employees.Except(group.Select(item => item.EmployeeId)),
        group = group
    })
    .Where(queries => queries.additionalItems.Count() == 0
    && queries.missingItems.Count() == 0)
    .Select(queries => queries.group.Key)//gets the supervisorID
    .FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:11:59.760

一种可能性：

```
public int FindSuperVisorId(IEnumerable<Employee> employes)
{
    var distinctSupervisors = employes.Select(e => e.SuperVisor).Distinct();
    var superVisor = distinctSupervisors.Where(supervisor => employes.All(employee => employee.SuperVisor.Equals(supervisor))).FirstOrDefault();
    return superVisor;
} 
```

如果您想要相同主管的所有匹配项：

```
public IEnumerable<int> FindSuperVisorId(IEnumerable<Employee> employes)
{
    var distinctSupervisors = employes.Select(e => e.SuperVisor).Distinct();
    var equalSupervisors = distinctSupervisors .Where(supervisor => employes.All(employee => employee.SuperVisor.Equals(supervisor)));
    return equalSupervisors;
} 
```

或直接：

```
public IEnumerable<int> FindSuperVisorId(IEnumerable<Employee> employes)
{
    return employes.Select(e => e.SuperVisor).Distinct()
        .Where(supervisor => employes.All(employee => employee.SuperVisor.Equals(supervisor)));
} 
```

# python - 如何在 QtQuick 中查找属性和更改值

> ID：14939212
> 
> 赞同：5
> 
> 时间：2013-02-18T15:00:14.870
> 
> 标签：python, pyqt, qml, qt-quick

如何在我的 qtquick 项目中查找**Text元素的属性****颜色**和更改值？ my.qml 文件中的内容。

 **```
Rectangle {
    width: 300
    height: 200

    Text {
        x: 12
        y: 34
        color:red
    }  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T16:23:05.760

您需要设置 objectName 属性，如下所示：

```
Rectangle {
    width: 300
    height: 200

    Text {
      objectName: "text1"  
               x: 12
               y: 34
               color: "red"
    }  
} 
```

现在您可以找到并访问元素和属性。
例如，我在 Text 元素中找到颜色并更改为绿色：

```
view = QDeclarativeView(QUrl('widget.qml'),parent = object)
property = QDeclarativeProperty(view.rootObject().findChild(QDeclarativeItem, name="text1"),"color")
property.write("green") 
```**

# c# - 按下“Ctrl + C”按钮处理 C# 控制台应用程序

> ID：14939217
> 
> 赞同：6
> 
> 时间：2013-02-18T15:00:31.813
> 
> 标签：c#, event-handling, console-application

如何处理同时按下的两个按钮（'Ctrl' + 'C'），而不是在 WindowsForms 应用程序中，而是在控制台 C# 应用程序中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T15:01:34.933

我怀疑你想设置[`Console.TreatCtrlCAsInput`](http://msdn.microsoft.com/en-us/library/system.console.treatcontrolcasinput.aspx)为`true`. （假设您*不*希望这终止应用程序。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T15:02:35.367

查看**[Console.TreatControlCAsInput](http://msdn.microsoft.com/en-us/library/system.console.treatcontrolcasinput.aspx)**属性；

> 获取或设置一个值，该值指示将 Control 修饰键和 C 控制台键 (Ctrl+C) 的组合视为普通输入还是操作系统处理的中断。

# iphone - 使用 url 方案传递参数

> ID：14939219
> 
> 赞同：4
> 
> 时间：2013-02-18T15:00:39.783
> 
> 标签：iphone, ios, cocoa-touch, url-scheme

我正在开发一个可以通过 URL 启动的应用程序。我已经在信息页面上使用 xcode 定义了我的 url 方案。我填写了标识符 my Bundle 标识符和 URL Schemes myapp。

现在，如果我尝试在 safari myapp://foo 中打开，它会启动我的应用程序并在我的断点处停止

```
- (BOOL)application:(UIApplication *)application
        openURL:(NSURL *)url
sourceApplication:(NSString *)sourceApplication
     annotation:(id)annotation 
```

方法。

问题是注解，url，application，sourceapplication 参数都是 nil。所以我不能传递参数......

![在此处输入图像描述](../Images/b40290bf675881d1d53398d300597818.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T09:49:46.420

经过不必要的时间损失，我发现问题出在调试器上。它显示 url 为零，如果我尝试打印描述，它会说

```
Printing description of url:
<nil> 
```

但是如果我尝试 NSLog 它会显示 url。如果将以下代码放入方法中

```
if (! url) {
    return NO;
} 
```

调试器还显示 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T11:01:49.387

您确定您的项目处于调试模式！？见这里[http://nerdwa.com/index.php/2011/09/debugrelease-schemes-in-xcode-4/](http://nerdwa.com/index.php/2011/09/debugrelease-schemes-in-xcode-4/)

# ruby - Ruby：带有 open-uri 的 CLI 进度条

> ID：14939227
> 
> 赞同：0
> 
> 时间：2013-02-18T15:00:56.883
> 
> 标签：ruby, progress-bar, command-line-interface

我正在尝试使用 open-uri 并想要制作一个命令行界面进度条。

我已经浏览了 OpenURI::OpenRead 的文档，其中有一个进度条代码示例。

```
pbar = nil
open('latest.zip', 'wb') do |fo|
  fo.print open('http://wordpress.org/latest.zip',
    :content_length_proc => lambda { |t|
    if t && 0 < t
      pbar = ProgressBar.new("...", t)
      pbar.file_transfer_mode
    end
    },

    :progress_proc => lambda {|s|
      pbar.set s if pbar
    }).read
end 
```

但我可以不断收到以下错误：

```
zip_dowloader.rb:11:in `block (2 levels) in <main>': uninitialized constant ProgressBar (NameError) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:04:21.983

`gem install progressbar`

然后加：

```
require 'progressbar' 
```

到脚本的顶部。

或者，在启用捆绑器的项目中，添加：

```
gem 'progressbar' 
```

到你`Gemfile`并运行`bundle install`。

# java - Hibernate 用户缺少权限或找不到对象错误

> ID：14939231
> 
> 赞同：1
> 
> 时间：2013-02-18T15:01:05.400
> 
> 标签：java, hibernate

我创建了一个java应用程序，它将从表中选择ceratin值并使用hibernate打印它。我使用HSQLDb作为后端。但执行后我收到错误用户缺少权限或找不到对象：但我正在获取查询当我第一次执行时

休眠：从 IF_MAIN ifmain0_ 中选择 ifmain0_.IF_ID 作为 IF1_0_，ifmain0_.IF_NAME 作为 IF2_0_

但在那之后我得到了上述错误。所以我删除了 sample.lck 文件，再次执行两次后我得到了同样的错误

错误 org.hibernate.util.JDBCExceptionReporter - 用户缺少权限或找不到对象：IF_MAIN

```
org.hibernate.exception.SQLGrammarException: could not execute query
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:92)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.loader.Loader.doList(Loader.java:2545)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2276)
    at org.hibernate.loader.Loader.list(Loader.java:2271)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:459)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:365)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1268)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
    at org.mock.Mainclass.listNAMES(Mainclass.java:31)
    at org.mock.Mainclass.main(Mainclass.java:22)
Caused by: java.sql.SQLException: user lacks privilege or object not found: IF_MAIN
    at org.hsqldb.jdbc.Util.sqlException(Util.java:224)
    at org.hsqldb.jdbc.JDBCPreparedStatement.<init>(JDBCPreparedStatement.java:3885)
    at org.hsqldb.jdbc.JDBCConnection.prepareStatement(JDBCConnection.java:641)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:534)
    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:452)
    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1700)
    at org.hibernate.loader.Loader.doQuery(Loader.java:801)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)
    at org.hibernate.loader.Loader.doList(Loader.java:2542)
    ... 9 more
Caused by: org.hsqldb.HsqlException: user lacks privilege or object not found: IF_MAIN
    at org.hsqldb.error.Error.error(Error.java:77)
    at org.hsqldb.SchemaManager.getTable(SchemaManager.java:685)
    at org.hsqldb.ParserDQL.readTableName(ParserDQL.java:5297)
    at org.hsqldb.ParserDQL.readTableOrSubquery(ParserDQL.java:1662)
    at org.hsqldb.ParserDQL.XreadTableReference(ParserDQL.java:1074)
    at org.hsqldb.ParserDQL.XreadFromClause(ParserDQL.java:1061)
    at org.hsqldb.ParserDQL.XreadTableExpression(ParserDQL.java:996)
    at org.hsqldb.ParserDQL.XreadQuerySpecification(ParserDQL.java:990)
    at org.hsqldb.ParserDQL.XreadSimpleTable(ParserDQL.java:974)
    at org.hsqldb.ParserDQL.XreadQueryPrimary(ParserDQL.java:903)
    at org.hsqldb.ParserDQL.XreadQueryTerm(ParserDQL.java:869)
    at org.hsqldb.ParserDQL.XreadQueryExpressionBody(ParserDQL.java:848)
    at org.hsqldb.ParserDQL.XreadQueryExpression(ParserDQL.java:822)
    at org.hsqldb.ParserDQL.compileCursorSpecification(ParserDQL.java:5449)
    at org.hsqldb.ParserCommand.compilePart(ParserCommand.java:133)
    at org.hsqldb.ParserCommand.compileStatement(ParserCommand.java:63)
    at org.hsqldb.Session.compileStatement(Session.java:906)
    at org.hsqldb.StatementManager.compile(StatementManager.java:335)
    at org.hsqldb.Session.execute(Session.java:1009)
    at org.hsqldb.jdbc.JDBCPreparedStatement.<init>(JDBCPreparedStatement.java:3882)

My hibernate config file is 
```

org.hsqldb.jdbcDriver jdbc:hsqldb:file:C:/Users/298637/SAMPLE;hsqldb.lock_file=false org.hibernate.dialect.HSQLDialect sa sa 1 线程 org.hibernate.cache.NoCacheProvider true none

映射文件是

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
 "-//Hibernate/Hibernate Mapping DTD//EN"
 "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"> 

<hibernate-mapping package="org.mock">
   <class name="IFMAIN" table="IF_MAIN ">
      <meta attribute="class-description">
         This class contains the employee detail. 
      </meta>
      <id name="number" type="string" column="IF_ID">
         <generator class="native"/>
      </id>
      <property name="name" column="IF_NAME" type="string"/>
   </class>
</hibernate-mapping> 
```

Pojo CLASS

```
public class IFMAIN {
    private String number;
    private String name ;
    public IFMAIN()
    {

    }
    public String getNumber() {
        return number;
    }
    public void setNumber(String number) {
        this.number = number;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }

} 
```

主班

```
import java.util.Iterator;
import java.util.List;
import org.hibernate.HibernateException;
import org.hibernate.Query;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.Configuration;

public class Mainclass {
     private static SessionFactory factory; 
       public static void main(String[] args) {
          try{
             factory = new Configuration().configure().buildSessionFactory();
          }catch (Throwable ex) { 
             System.err.println("Failed to create sessionFactory object." + ex);
             throw new ExceptionInInitializerError(ex); 
          }
          Mainclass ME = new Mainclass();
          ME.listNAMES();
}

public void listNAMES( ){
   Session session = factory.openSession();
   Transaction tx = null;
   try{
      tx = session.beginTransaction();
      List sample = session.createQuery("FROM IFMAIN").list();
      int i=0;
      for (Iterator iterator = sample.iterator(); iterator.hasNext();){
         IFMAIN count = (IFMAIN) iterator.next(); 
         System.out.println("SITE CODE: " + count.getNumber()); 
         System.out.println("SITE DESCRIPTION: " + count.getName());  
      }

      tx.commit();
   }catch (HibernateException e) {
      if (tx!=null) tx.rollback();
      e.printStackTrace(); 
   }finally {
      session.close(); 
   }
}
} 
```

谁能告诉我为什么我会收到这个错误。我尝试使用其他数据库，如 mysql 和 oracle 10g。我能够连接并获得结果，但是当我使用 HSQL Db 时出现此错误

# appmobi - 向 PushMobi 添加新用户

> ID：14939233
> 
> 赞同：0
> 
> 时间：2013-02-18T15:01:13.153
> 
> 标签：appmobi, pushmobi

在新设备上，但有一个现有的 PushMobi 用户，我是否需要调用 checkPushUser 或 addPushUser 将用户添加到设备？是否可以使用 web 服务 API 将推送消息发送到模拟器中托管的应用程序，或从应用程序实验室？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:43:33.580

为了将现有用户添加到新设备，您需要调用`AppMobi.notification.checkPushUser`

# node.js - node.js 应该监听哪些端口？如何以及为什么？

> ID：14939239
> 
> 赞同：9
> 
> 时间：2013-02-18T15:01:33.980
> 
> 标签：node.js, http, https, port

我的 node.js 应用程序在端口 80 上监听 http，在端口 443 上监听 https，我认为这是相当标准的做法。

然而，我最近阅读的一些示例使用其他端口（例如 8080 和 8081）来侦听 http/https，然后使用其他方式（例如`iptables`或`ufw`规则）通过将数据包重新路由到/来自其他端口来为端口 80 / 443 提供服务。

[请参阅此处](https://gist.github.com/kentbrew/776580)和[此处](https://gist.github.com/benatkin/939400)的两个示例。

所以我的问题是**为什么我不想直接监听端口 80 和 443？**

是否存在安全问题？这仅仅是这些作者没有权限监听低于 1024 的端口的情况（我会觉得这很奇怪吗？）？大多数人是否在侧节点上运行 Apache？（我不）。

假设我不想直接收听 80 和/或 443 有充分的理由，**我应该使用哪种方法将流量从 80 / 433 中继到我选择的替代端口？**

我在上面提到了 iptables 和 ufw，其中一个比其他更好，还是我应该使用其他一些方法？答案是否取决于我是否在进程之间平衡负载？

提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-18T15:05:38.130

您链接到的第一篇文章的第一行提到了原因。

```
Standard practices say no non-root process gets to talk to
the Internet on a port less than 1024. 
```

要将 node 绑定到 port`80`或`443`，您需要以 root 身份运行它，这不是一个好主意。

您用于将流量重新路由到更高端口的方法取决于您。是`iptables`资源最少和最简单的。另一种方法是使用 NginX/Apache 代理到 Node.js。我想说这种方法的主要好处是您还可以从那里提供静态文件之类的东西，而不必通过 Node.js 提供它们。

Apache 和 NginX 都被明确地设计为非常擅长处理静态文件，因此它们非常擅长，而 Node 是一个完整的 JS 环境，涉及所有开销。Node 擅长处理大量同时连接，它当然可以完美地为正常负载提供文件，但它会比 NginX 使用更多的资源来完成它。

Using an HTTP-aware proxy like Apache/NginX also means that you can very easily set up multiple instances of Node to run different subdomains, or even different paths on the same domain.

# c++ - 编译 libcvd 时出现未定义的引用错误

> ID：14939242
> 
> 赞同：0
> 
> 时间：2013-02-18T15:01:37.697
> 
> 标签：c++, reference, makefile

我正在尝试编译 libcvd 以使用 PTAM。当我在编译时到达命令“make”时，它给了我以下错误：

```
ln -s libcvd.so.0.7 libcvd.so.0
ln -s libcvd.so.0 libcvd.so
g++ -o progs/se3_exp progs/se3_exp.o -L.  -lcvd  -ltiff -ljpeg -lpng -llapack -lGLU -lGL -ldc1394  -L -lX11 -lXext -pthread
./libcvd.so: error: undefined reference to 'XQueryPointer'
./libcvd.so: error: undefined reference to 'XPending'
./libcvd.so: error: undefined reference to 'XNextEvent'
./libcvd.so: error: undefined reference to 'XFlush'
./libcvd.so: error: undefined reference to 'XSelectInput'
./libcvd.so: error: undefined reference to 'XStoreName'
./libcvd.so: error: undefined reference to 'XUnmapWindow'
./libcvd.so: error: undefined reference to 'XDestroyWindow'
./libcvd.so: error: undefined reference to 'XCloseDisplay'
./libcvd.so: error: undefined reference to 'XOpenDisplay'
./libcvd.so: error: undefined reference to 'XCreateColormap'
./libcvd.so: error: undefined reference to 'XCreateWindow'
./libcvd.so: error: undefined reference to 'XMapWindow'
./libcvd.so: error: undefined reference to 'XDefineCursor'
./libcvd.so: error: undefined reference to 'XUndefineCursor'
./libcvd.so: error: undefined reference to 'XWarpPointer'
./libcvd.so: error: undefined reference to 'XMoveWindow'
./libcvd.so: error: undefined reference to 'XResizeWindow'
./libcvd.so: error: undefined reference to 'XGetWindowAttributes'
./libcvd.so: error: undefined reference to 'XSetClassHint'
./libcvd.so: error: undefined reference to 'XInternAtom'
./libcvd.so: error: undefined reference to 'XSetWMProtocols'
./libcvd.so: error: undefined reference to 'XLoadQueryFont'
./libcvd.so: error: undefined reference to 'XCreateGlyphCursor'
./libcvd.so: error: undefined reference to 'XFreeFont'
./libcvd.so: error: undefined reference to 'XLookupString'
collect2: ld returned 1 exit status
make: *** [progs/se3_exp] Error 1 
```

我找不到任何合适的解决方案来解决这个错误。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-27T11:21:15.620

我做了两件事。

首先，我在以下位置添加了一个额外的 -lX11。新线看起来像这样 -

```
thirdparty/libcvd/installfiles/configure:  LIBS="-lX11 -lX11 $LIBS"
thirdparty/libcvd/installfiles/configure:       LIBS="$LIBS -L$x_libraries -lX11 -lX11 -lXext"
thirdparty/libcvd/installfiles/configure.in:        APPEND(LIBS, [-L$x_libraries -lX11 -lX11 -lXext]) 
```

接下来，我按照这个答案安装了下面提到的所有 3 个（注意：您还需要安装 liblapack-dev。我刚刚安装了 liblapack3，但也需要 dev）。 [https://stackoverflow.com/a/21432657/771650](https://stackoverflow.com/a/21432657/771650)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:36:09.010

我找到了解决方案，

在 makefile 中，按以下顺序更改库引用的顺序：

```
LOADLIBES = -lX11 -ltiff -ljpeg -lpng -llapack -lGLU -lGL -ldc1394  -L -lXext -pthread 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T16:34:42.743

你的问题在这里：

> g++ -o progs/se3_exp progs/se3_exp.o -L。-lcvd [...] -ldc1394 **-L -lX11** -lXext -pthread

与第一个不同`-L.`，第二个库路径 (-L) 选项后面没有路径参数，因此它会窃取接下来用作（不太可能！）路径的任何内容。要真正解决这个问题，您需要查看 Makefile 的`LOADLIBES`定义并弄清楚这个不完整`-L` 的选项是如何进入其中的。最有可能的是，Makefile 有 ... `-L$(SOME_PATH)`... 或类似的，并且`SOME_PATH`变量意外为空。

# android - 跨活动传递字符串值？

> ID：14939251
> 
> 赞同：0
> 
> 时间：2013-02-18T15:01:58.007
> 
> 标签：android

我目前正在尝试跨活动传递字符串。该字符串用于在第二个活动中设置图像。因此，用户在第一个活动中单击一个按钮，然后根据选择的内容在第二个活动中加载适当的图像。第一个活动中有三个按钮，它们都应该向下一个活动发送一个字符串值。

这是我在第一个活动中的内容：

```
Button archerButton = (Button) findViewById(R.id.Button_Archer);
archerButton.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        String selection = "archer";
        Bundle basket = new Bundle();
        basket.putString("key", selection);
        Intent i = new Intent(SelectCharacterActivity.this, LevelOneActivity.class);
        i.putExtras(basket);
        startActivity(i);
        finish();
        }
    });
} 
```

接收活动具有以下代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
    setContentView(R.layout.level_one);

    ImageView img = (ImageView) findViewById(R.id.Character_Chosen);

    Bundle extras = getIntent().getExtras();
    String Toon = extras.getString("key");

    if(Toon=="archer"){
        img.setImageResource(R.drawable.archer);
    }

    if(Toon=="mage"){
        img.setImageResource(R.drawable.mage);
    }
    if(Toon=="warrior"){
        img.setImageResource(R.drawable.warrior);
    }
} 
```

我知道接收 if 语句部分有效，因为如果我手动设置值 Toon 图像将加载。因此，某处信息未正确发送或读取。我在网上遵循了一个教程，但对此感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:08:16.750

你在比较你的字符串错误，

```
Toon=="Anything" 
```

永远不会是真的，你需要使用

```
Toon.equals("Anything") 
```

让它工作。

编辑：

这是真的，因为“==”只会比较字符串的内存地址，而“Anything”只会被分配，绝对不会匹配 Toon。.equals 但是实际上比较了字符串中的字符。

还要测试这样的事情，尝试放入

```
Log.i("YourAppName", "Toon value is: " + Toon); 
```

后

```
String Toon = extras.getString("key"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:08:37.903

问题是 Java 101。字符串相等性测试是使用该`equals`方法完成的。

```
Toon.equals("archer"); 
```

额外提示：反转您的测试以避免空指针异常：

```
"archer".equals(Toon); 
```

额外提示：考虑到您的案例是互斥的，请使用 if else if 以避免测试所有案例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:04:15.720

尝试使用`SharedPreferences`，在单击按钮之后/使用它进行设置，然后在 2\. Activity 上获取它`OnCreate`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:07:00.283

如果您只想传递一个简单的字符串，您可以使用以下内容：

发送时：

```
 Intent i = new Intent(SelectCharacterActivity.this, LevelOneActivity.class);
    i.putExtra("key", selection);
    startActivity(i); 
```

收到时：

```
 String selection = getIntent().getStringExtra("key"); 
```

如果此键没有参数，则选择将为空。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T15:07:01.420

试试这个

`Intent i = new Intent(FirstActivity.this, SecondActivity.class); i.putExtra("email", "lol@hotmail.com"); startActivity(i);`

和

`Intent i = getIntent(); String myemail = i.getStringExtra("email");`

此外，要比较字符串，请使用`.equals()`not`==`

# php - 只执行一个函数

> ID：14939255
> 
> 赞同：0
> 
> 时间：2013-02-18T15:02:07.320
> 
> 标签：php, javascript

我有一个`.js`包含这两个功能的文件：

```
function download510(form) { 
    if (form.pass.value=="tokheim") {              
        location="../pdf/quantium-510.pdf" 
    } else {
        alert("Invalid Password")
    }
};

function download410(form) { 
    if (form.pass.value=="tokheim") {              
        location="../pdf/quantium-410.pdf" 
    } else {
        alert("Invalid Password")
    }
}; 
```

还有两个`.php`文件：

# 1：

```
<form name="login">
    <input name="pass" type="password"> 
    <input type="button" value="Download" onClick="download510(this.form)">
</form> 
```

# 2：

```
<form name="login">
    <input name="pass" type="password"> 
    <input type="button" value="Download" onClick="download410(this.form)">
</form> 
```

只有第一个函数`download510(form)`, 有效。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:17:06.023

这个功能

```
function download510(form) { 
   if (document.getElementById("pass").value=="tokheim") {              
      location="../pdf/quantium-510.pdf" ;
   } else {
      alert("Invalid Password");
   }
} 
```

有了这个 php 文件

```
<form name="login">
    <input name="pass" id="pass" type="password"> 
    <input type="button" value="Download" onClick="download510(this.form)">
</form> 
```

而且，这个其他功能：

```
function download410(form) { 
    if (document.getElementById("pass").value=="tokheim") {              
        location="../pdf/quantium-410.pdf" ;
    } else {
        alert("Invalid Password");
    }
} 
```

使用这个 php 文件：

```
<form name="login">
    <input name="pass" id="pass" type="password"> 
    <input type="button" value="Download" onClick="download410(this.form)">
</form> 
```

不要同时使用这两个功能；与表单相同....如果您尝试将其一起使用，请更改值输入的名称，例如：

```
<input name="pass1" id="pass1" type="password"> 
```

和

```
<input name="pass2" id="pass2" type="password">; 
```

对每个 JS 函数的名称执行相同的操作。

萨卢多斯。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-18T15:13:51.897

您没有说明“不工作”是什么意思，但一种可能的途径是使用`onSubmit`而不是`onClick`您的表格。如果您想在密码不正确的情况下阻止提交，请从函数中返回 false。否则表格将被提交。

当然，这是除此代码中固有的所有其他问题之外的问题......可见密码、链接、缺少分号......等等......

# c# - 为什么我不能在字节变量中存储负值？

> ID：14939257
> 
> 赞同：9
> 
> 时间：2013-02-18T15:02:10.583
> 
> 标签：c#, byte

我正在转换适用于 Java 但不适用于 C# 的代码

```
byte[] buffer = new byte[64];
this.buffer[((int)this.count & 0x3F)] = -128; 
```

这会生成一个编译时错误“常量值 '-128' 无法转换为 'byte'”。如何存储一个字节的负数？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-18T15:07:25.710

在 C# 中，a`byte`表示一个*无符号*的8 位整数，因此不能保存负值（有效值范围从`0`到`255`）。另一种方法是`sbyte`，它是一个有*符号*`-128`的 8 位整数（从到的有效值`127`）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-18T15:08:40.353

Java 中的`byte`数据类型是有*符号*的(-128–127)。C# 中的等效数据类型是`sbyte`.

所以等效的C#代码如下：

```
sbyte[] buffer = new sbyte[64];
buffer[..] = -128; 
```

*如果您想要一个无符号*字节数组(0–255)，则`byte`与 -128 具有相同位模式的`sbyte`128 (0x80)。

```
byte[] buffer = new byte[64];
buffer[..] = 128; 
```

*另请参阅：* [积分类型表（C# 参考）](http://msdn.microsoft.com/en-us/library/exx3b86w.aspx)

# r - 基准分析和显示分析结果和基准？

> ID：14939258
> 
> 赞同：2
> 
> 时间：2013-02-18T15:02:13.763
> 
> 标签：r, benchmarking

可能，我只是错过了一个参数......但是，也许有人可以指出它：如何在 R 基准测试中运行分析并仍然将结果存储回某处？我知道 R 函数只能返回一个对象，但我可以在此处使用列表或粘贴基准测试结果并将分析结果存储在函数的返回值中。

但是，有没有办法评估基准（或`system.time`）和分析而不像这样运行两次？：

```
require(rbenchmark)
bmark <- function(x){
    res <- list()
    res[[1]] <- benchmark(x^6)
    res[[2]] <- x^6
    res
} 
```

编辑：对不起，我对我真正想做的事情造成了一些困惑。也许用例更清楚：我没有典型的基准测试情况，我想检查我的自定义函数是否比其他函数更快。而是我在不同的机器上用不同的数据运行同样的东西。我在测试环境中不需要它，但在生产环境中——我只想让脚本的用户知道它花了多长时间。如果那是一个小时或更长时间，人们可以计划他们的午休时间:)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T15:07:02.483

这是一个使用两个函数的示例。第一个使用`plyr`，第二个使用`data.table`。

```
# dummy data
require(plyr)
require(data.table)
set.seed(45)
x1 <- data.frame(x=rnorm(1e6), grp = sample(letters[1:26], 1e6, replace=T))
x1.dt <- data.table(x1, key="grp")
# function that uses plyr   
DF.FUN <- function(x) {
    ddply(x1, .(grp), summarise, m.x = mean(x))
}

# function that uses data.table
DT.FUN <- function(x) {
    x1.dt[, list(m.x=mean(x)),by=grp]
}

require(rbenchmark)
> benchmark( s1 <- DF.FUN(), s2 <- DT.FUN(), order="elapsed", replications=2)

#             test replications elapsed relative user.self sys.self user.child sys.child
# 2 s2 <- DT.FUN()            2   0.036    1.000     0.031    0.006          0         0
# 1 s1 <- DF.FUN()            2   0.527   14.639     0.363    0.163          0         0 
```

现在，`s1`包含`s2`每个函数的结果，基准测试结果将显示在屏幕上。

```
# > head(s1)
#   grp           m.x
# 1   a  0.0069312201
# 2   b -0.0002422315
# 3   c -0.0129449586
# 4   d -0.0036275338
# 5   e  0.0013438022
# 6   f -0.0015428427

# > head(s2)
#    grp           m.x
# 1:   a  0.0069312201
# 2:   b -0.0002422315
# 3:   c -0.0129449586
# 4:   d -0.0036275338
# 5:   e  0.0013438022
# 6:   f -0.0015428427 
```

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-17T11:12:56.440

我不确定 StackOverflow 对回答旧问题的看法，但在您编辑后似乎没有人真正回答。所以这里是：

要在 R 中为进程计时，您可以使用两种方法。第一个使用`system.time(expression)`并为您提供计算括号内表达式所需的时间。如果这在您的情况下不实用，您可以`Sys.time()`在操作之前和操作之后获得系统时间，然后减去两者。

如果这最终回答了您的问题，请接受解决方案:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T17:52:47.923

我读这个问题的方式与 Arun 有点不同。这将是我认为被问到的答案：

```
 > bres <- bmark(2)
> bres
[[1]]
  test replications elapsed relative user.self sys.self user.child sys.child
1  x^6          100   0.001        1     0.001    0.001          0         0

[[2]]
[1] 64 
```

bmark 函数返回默认 100 次复制的结果。如果您想注释结果，您可以使用 paste() 并且如果您想添加代表次数的参数：

```
bmark2 <- function(x, reps=100){
    res <- list()
    res[[1]] <- benchmark(x^6, replications=reps)
    res[[2]] <- paste(reps, " replications of ", x, "to the 6th in", res[[1]]$elapsed)
    res
} 
```

# android - Eclipse、PyDev 和 Kivy

> ID：14939259
> 
> 赞同：1
> 
> 时间：2013-02-18T15:02:16.337
> 
> 标签：android, python, kivy

我已经安装了 Eclipse、pyDev 和 Kivy，并使用此处的说明使用 main.py 文件设置了我的第一个项目：

[http://www.ocularsoftware.com/2012/11/how-to-use-pydev-to-develop-and-run-kivy-applications-on-windows/](http://www.ocularsoftware.com/2012/11/how-to-use-pydev-to-develop-and-run-kivy-applications-on-windows/)

但我现在坚持如何创建一个 Hello World Android 应用程序并将其安装在我的 Android 模拟器上。

我需要导入 Android SDK 的任何部分吗？我错过了什么吗？我什至不知道在我的 main.py 中放什么，除了

print("你好，世界！")

编辑：好的，我想出了如何让它在测试窗口中运行，但我仍然无法让它在 Android 虚拟设备中运行。

这是新代码：

```
from kivy.app import App
from kivy.uix.button import Button

class TestApp(App):
    def build(self):
        return Button(text='Hello World')

if __name__ in ('__main__', '__android__'):
    TestApp().run() 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T16:48:10.250

您链接到的教程与 Android 没有任何关系。

标题是：

> 如何使用 PyDev 开发和运行 Kivy 应用程序（在 Windows 上）

注意*（在 Windows 上）*部分。

所以我认为不会把你带到任何地方。

可以为 android 编写 python 应用程序。见这里： [https ://code.google.com/p/python-for-android/](https://code.google.com/p/python-for-android/)

在这里： [http ://code.google.com/p/android-scripting/](http://code.google.com/p/android-scripting/)

我不认为 kivy 会在 sl4a 上工作。我确实相信他们对 GUI 应用程序有一些支持，但它并不像 java SDK 那样彻底。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T18:26:32.637

不支持在 android 虚拟机上运行 kivy 应用。您需要使用实际设备。详情看[这里](http://kivy.org/docs/guide/packaging-android.html)。

目前在 Windows 上最简单的方法是：

1.  下载[预建的 VM](https://docs.google.com/uc?export=download&confirm=no_antivirus&id=0B1WO07-OL50_bTR0SElrLTZGWEU)（ubuntu 12.10 警告 930+MB），它是一个 virtualbox 磁盘
2.  创建一个使用此磁盘的新 VirtualBox VM
3.  启动虚拟机并按照虚拟机桌面上自述文件中提到的说明进行操作。

您应该很快准备好一个 apk。

# nuget - 一次自动将 NuGet 添加到多个解决方案

> ID：14939262
> 
> 赞同：2
> 
> 时间：2013-02-18T15:02:27.783
> 
> 标签：nuget

我正在处理一个相当大的代码库，我想自动化以下相关任务，使 NuGet 在多个解决方案中可用：

1.  在源树的多个文件夹中添加一个 .nuget 文件夹（带有 nuget.exe、nuget.targets、nuget.config）
2.  在 #1 的每个文件夹中，将适当的配置添加到每个文件夹中包含的解决方案文件中

```
项目（“{2150E333-8FDC-42A3-9474-1A3956D46DE8}”）=“.nuget”，“.nuget”，“{F3BA244B-3E6B-4A37-B0C0-B490885DED86}”
        ProjectSection(SolutionItems) = preProject
        .nu​​get\NuGet.Config = .nuget\NuGet.Config
        .nu​​get\NuGet.exe = .nuget\NuGet.exe
        .nu​​get\NuGet.targets = .nuget\NuGet.targets
    结束项目节
结束项目

```

另一个问题（出于好​​奇） - 我们已经手动将 NuGet 添加到几个解决方案中，我注意到每个解决方案的第一个 GUID 都是相同的，但第二个 GUID 似乎与一个解决方案不同下一个 - 每个解决方案中是否必须是不同的 GUID，还是所有解决方案中都可以存在相同的 GUID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T03:20:07.710

回答您关于 GUID 的问题：第一个 GUID 表示项目的类型，而第二个 GUID 用于标识项目，这就是为什么第一个 GUID 相同，但第二个 GUID 不同的原因。有关项目类型 GUID 的列表，请参阅[http://www.mztools.com/articles/2008/mz2008017.aspx](http://www.mztools.com/articles/2008/mz2008017.aspx)。

# unit-testing - Grails：Groovy：无法解析类 grails.test.mixin.TestFor

> ID：14939264
> 
> 赞同：2
> 
> 时间：2013-02-18T15:02:28.660
> 
> 标签：unit-testing, grails, sts-springsourcetoolsuite

我是Grails的新手。

在 Grails 自动生成的单元测试中，有 grails.test.mixin 的导入

导入 grails.test.mixin.TestFor

但是，STS 抱怨 Groovy:unable to resolve class grails.test.mixin.TestFor 这个类在哪里定义，我应该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:27:03.490

正如 Sérgio Michels 建议的那样，在您的项目上运行刷新依赖项。如果这不起作用，请在项目上运行 Project -> Clean...。

此外，请确保您使用的是兼容版本的 grails（即 2.0 或更高版本）。

# c++ - 获取 cv::Mat 的值

> ID：14939266
> 
> 赞同：0
> 
> 时间：2013-02-18T15:02:33.543
> 
> 标签：c++, c, opencv, scilab

我有一个程序，我在其中计算多个帧的平均值，当我保存这个平均值时，我得到一个 965KB 的文件，但是我用基于 OpenCV 的 SCILAB 做同样的事情，我得到一个 5.93MB听起来更合乎逻辑。无论如何，我决定使用 fwrite 编写我的框架，这里做了什么：

```
 cv::Mat meanFrame= cv::Mat::zeros(height,width,CV_32FC3);
cv::Mat frameR;
FILE* inpR = NULL;
...... //after calculating the meanFrame
inpR = fopen("d:\\red.txt","wb+");
for(int row = 0; row < meanFrame.rows; ++row) {
    for (int col = 0; col < meanFrame.cols; ++col) {
        std::cout << meanFrame.at<cv::Vec3f>(row, col)[1] <<std::endl;
        std::cout << meanFrame.at<cv::Vec3f>(row, col)[2] <<std::endl;
        fwrite(&resultframe.at<cv::Vec3f>(row,col )[0],sizeof(float),1,inpR);
    }
}
fcloseall(); 
```

我可以看到 pf 通道 1 和 2，但是当我打开文件 red.txt 时，我得到：

```
 €€<€€<€€<€€<€€<€€<€€<€€<€€<€€<€€<€€<€€....... 
```

知道我在这里缺少什么，之后我想在 SCILAB 中加载这些文件，而不是将框架保存为文件。感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T17:20:47.913

您正在编写二进制数据 - 浮点数如何存储在内存中。

当您查看文件（在编辑器中或命令行上）时，它认为这是文本数据并试图将其解释为字符。

如果您需要将此值读入另一个程序，那么您可以使用 fwrite 和 fread（尽管如果您有不同的 CPU，您可能会遇到字节顺序问题）

如果您只是想查看结果，或者想要稍微多做一些工作以将它们读入另一个程序，您可以打印这些值

```
printf("%f", resultframe.at<cv::Vec3f>(row,col )[0]); 
```

# batch-file - 将目录文件夹列出到变量

> ID：14939268
> 
> 赞同：0
> 
> 时间：2013-02-18T15:02:35.337
> 
> 标签：batch-file

我觉得最好单独提出这个问题，而不是期待我对之前帖子的评论得到答案。

我已经`%jobn%`为唯一的目录号设置了变量有没有一种方法可以搜索未知元素以添加到另一个变量中，我知道通过命令行我可以运行`Dir D09854*`，我会得到一个带有全名的报告，可以以某种方式收集并添加到命名变量吗？

```
S:\SWDA\HBOS>dir d09854*
 Volume in drive S is Images
 Volume Serial Number is FE8F-38FE

 Directory of S:\SWDA\HBOS

18/02/2013  10:29    <DIR>          D09854_Parent Test 
```

我想将元素添加`"_"`到变量之后，这样我就可以通过组合来`%DirDesc%`创建完整路径`%jobn%%DirDesc%``"D09854_Parent Test"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:44:09.687

`dir d09854* /b`将在一行中恢复完整的文件夹名称，没有多余的东西，如果有什么用处？你在用什么写这个小部件？它必须是老式的 DOS，还是可以使用较新的命令扩展？

在有限的旧 DOS 下，我想不出一种方法将其放入 SET 变量中，而不将其通过管道传输到临时批处理文件中，首先将 ECHO`set variable=`放入其中，然后在管道中使用 >> 附加到它。 ..然后调用临时批处理文件执行命令！

# c# - 显示页面时出错 -MVC 初学者

> ID：14939273
> 
> 赞同：0
> 
> 时间：2013-02-18T15:02:49.583
> 
> 标签：c#, asp.net, asp.net-mvc

为什么我会收到此错误

```
The current request for action 'Index' on controller type 'MyController' is ambiguous between the following action methods:
System.Web.Mvc.ActionResult Index() on type MyProj.Controllers.MyController
System.Web.Mvc.ActionResult Index(MyProj.Models.MyModel) on type MyProj.Controllers.MyController 
```

控制器类：

```
public class MyController : Controller
    {
        //
        // GET: //
        public ActionResult Index()
        {
            return View();

        }

        public ActionResult Index(MyModel model)
        {
            string x = "Hello "+ model.name;

            return View();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T15:04:00.827

它们都是 GET 动作。

在第二种方法之前添加：

```
[HttpPost] 
```

像这样：

```
public class MyController : Controller
{
    //
    // GET: //
    public ActionResult Index()
    {
        return View();

    }

    [HttpPost]
    public ActionResult Index(MyModel model)
    {
        string x = "Hello "+ model.name;

        return View();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:05:04.100

如果要重载，则需要添加属性来更改方法名称：

```
[ActionName("OverloadedName")] 
```

# java - 如何使用注释排除java类在maven中编译

> ID：14939276
> 
> 赞同：5
> 
> 时间：2013-02-18T15:03:04.943
> 
> 标签：java, maven, annotations

我已经有**工作**的解决方案，我可以使用 maven 指定在使用特定 maven 配置文件时不编译哪些类。

但我想使用通用解决方案并改用注释

我目前的解决方案就像

```
<plugin>
    <!-- Exclude some web services used only for internal testing -->
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <optimize>true</optimize>
        <excludes>
            <exclude>**/something/*ClassPattern.java</exclude>
        </excludes>
        <testExcludes>
            <exclude>**/something/*ClassPatternTest.java</exclude>
        </testExcludes>
    </configuration>
</plugin> 
```

但是有些东西像

```
@NotCompiledForProduction 
```

在课堂上会相当不错。

在我看来，如果不改变 Maven 的行为，这可能很难（或不可能做到）。这不是这里的范围。而这种注解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-09T01:40:30.257

您不能（我假设）使用注释来确定将哪些源代码呈现给 java 编译器，因为您首先需要编译源代码来处理注释。

似乎您需要在 maven 项目中创建不同的模块：一个生成带有生产代码的 jar 文件，一个生成带有测试实现的 jar 文件的模块，该文件依赖于生产工件。

如果代码确实需要在同一个 Maven 模块中，那么代码应该*总是*被编译。但是，您可以`maven-jar-plugin`在该阶段使用创建多个工件`package`：默认*`artifactId`.jar*和*`artifactId`-test-lib.jar*工件。您可以通过为插件指定多个执行，并根据需要使用`<includes>`和`<excludes>`拆分 jar 文件来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:05:57.803

你可以试试这个...

```
<build> <plugins>
  <!-- Run annotation processors on src/main/java sources -->
  <plugin>
    <groupId>org.bsc.maven</groupId>
    <artifactId>maven-processor-plugin</artifactId>
    <executions>
      <execution>
        <id>process</id>
        <goals>
          <goal>process</goal>
        </goals>
        <phase>generate-sources</phase>
      </execution>
    </executions>
  </plugin>
  <!-- Disable annotation processors during normal compilation -->
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
      <compilerArgument>-proc:none</compilerArgument>
    </configuration>
  </plugin>
</plugins> </build> 
```

# php - PHP preg_replace 替换符号后的字母

> ID：14939279
> 
> 赞同：1
> 
> 时间：2013-02-18T15:03:55.887
> 
> 标签：php, preg-replace

我目前的问题是，我有一个完整的表，其中包含我输入两个数组以供以后使用的单词及其缩写`preg_replace`。

```
$search[] = '/\b'.$row['word'].'\b/i';  --WORDS TO ABBREVIATE
$abbrev[] = $row['abbrev'];             --LIST OF ABBREVIATIONS

//search and replace 
for($i = 0; $i<count($search); $i++)
{
     $title = = preg_replace($search[$i],$abbrev[$i], $title);
} 
```

一切似乎都正常，但我遇到了转换不正确的问题。

天堂的地下室 --> 天堂的。地下室

S. 是 South 的缩写

我将如何确保符号/标点符号后的单词或字符不会被替换？任何帮助都将不胜感激，因为我对正则表达式的理解有限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:30:36.193

而不是`\b`您可以使用[**断言**](http://php.net/manual/en/regexp.reference.assertions.php)并检查空格`\s`并开始（`^`）：

```
'/(?<=\s|^)' . $row['word'] . '\b/i' 
```

现在，单词前面必须有空格（或字符串的开头），而不是任何“非单词”字符。

在单独的说明中，您不需要循环，[`preg_replace`](http://php.net/preg-replace)也适用于**数组**：

```
$title = preg_replace($search, $abbrev, $title); 
```

**更新：** 我的断言语法有误。现在它可以工作了：[运行示例](http://sandbox.onlinephpfunctions.com/code/baf0c454f411908c5d0e89c3ff91fb286f8299c1)

**测试代码：**

```
$rows = [
  ['word' => 'S', 'abbrev' => 'South'],
  ['word' => 'W', 'abbrev' => 'West'],
  ['word' => 'N', 'abbrev' => 'North'],
  ['word' => 'E', 'abbrev' => 'East'],
];
foreach ($rows as $row) {
  $search[] = '/(?<=\s|^)' . preg_quote($row['word'], '/') . '\b/i';
  $abbrev[] = $row['abbrev'];
}

$title = "Heaven's Basement in W Virginia";
echo preg_replace($search, $abbrev, $title); 
```

**测试结果：**

```
Heaven's Basement in West Virginia 
```

**更新2：**您可以在单词之后使用**前瞻**断言和`$`（字符串结尾）而不是`^`（字符串开头）执行相同操作

```
'/(?<=\s|^)' . preg_quote($row['word'], '/') . '(?=\s|$)/i'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:22:26.440

您可以使用[负面的lookbehind](http://www.regular-expressions.info/lookaround.html) like `'/(?<![\'])\b'.$row['word'].'\b/i'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:22:51.500

您最好对输入进行标记并在回调中检查替换，而不是多次搜索要替换的每个单词。

```
function abbreviate($str, $abbr) {
    // Define a "word" as a utf-8 string beginning with a letter character
    // followed by as many letter characters or apostrophes as possible.
    // You will probably have to tweak this.
    $re = '/\w[\w\']*/u';
    $callback = function($matches) use ($abbr) {
        $replacement = $matches[0];
        $word = mb_strtolower($matches[0], 'utf-8');
        if (isset($abbr[$word])) {
            $replacement = $abbr[$word];
        }
        return $replacement;
    };
    return preg_replace_callback($re, $callback, $str);
}

echo abbreviate("Heaven's Basement\n", array('s'=>'S.'));
echo abbreviate("S College Rd\n", array('s' => 'South', 'rd'=> 'Road')); 
```

印刷：

```
Heaven's Basement
South College Road 
```

# xpath - 错误元素//.....未找到

> ID：14939282
> 
> 赞同：1
> 
> 时间：2013-02-18T15:03:57.910
> 
> 标签：xpath, selenium

`[error] Element //div[@id='newslist_config']//button[@type='button'] not found`当我使用自动运行运行我的 selenium 测试时出现错误，但如果我单击命令并选择`Execute this command`测试通过。你能告诉我为什么硒找不到那个元素吗？

我的硒测试是

```
<tr>
    <td>click</td>
    <td>//div[@id='newslist_config']//button[@type='button']</td>
    <td></td>
</tr> 
```

html是

```
<div id="newslist_config" class="section-box span8">
<div class="accordion-group">
<div class="accordion-heading">
<h3>News-List Configuration</h3>
<a class="btn btn-danger close_newslist_config" data-dismiss="modal" href="#">remove widget</a>
<button class="btn btn-info collapse-btn" type="button" href="#collapse_newslist" data-parent="#newslist_config" data-toggle="collapse">
<span class="edit-btn-txt">
<span class="collapse-btn-txt">
</button>
</div>
<div id="collapse_newslist" class="collapse collapse-box">
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T10:57:01.160

方法：

1.从给定的 DOM 导出 CSS 选择器。

css=#newslist_config .collapse-btn

2.执行点击

driver.findElement(By.cssSelector("#newslist_config .collapse-btn")).click();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T21:06:00.470

您可以改为尝试 xpath：`//div[@id='accordion-heading']/button[@type='button']` 这是更直接的路径；如果它不起作用，我建议尝试单击包含跨度之一，因为有时，由于样式的原因，单击元素跨度可以获得更一致的结果。在 KendoUI 中使用 WebDriver 时，我有时会遇到这个问题。

# ruby-on-rails - Git 推送到 Heroku 会引发 Bundler 错误

> ID：14939284
> 
> 赞同：0
> 
> 时间：2013-02-18T15:04:06.913
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, heroku, bundler

我试图让一个旧的 Heroku 应用程序运行，但到目前为止失败了。`$ heroku stack`返回

```
=== <app_name> Available Stacks
  bamboo-ree-1.8.7
  cedar
* bamboo-mri-1.9.2 (prepared, will migrate on next git push) 
```

推动时，我得到以下信息：

```
$ git push heroku master
Counting objects: 48, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (31/31), done.
Writing objects: 100% (31/31), 4.00 KiB, done.
Total 31 (delta 18), reused 0 (delta 0)
-----> Ruby/Rails app detected
-----> Detected Rails is not set to serve static_assets
       Installing rails3_serve_static_assets... done
-----> Configure Rails 3 to disable x-sendfile
       Installing rails3_disable_x_sendfile... done
-----> Configure Rails to log to stdout
       Installing rails_log_stdout... done
-----> Gemfile detected, running Bundler version 1.0.7
       Unresolved dependencies detected; Installing...
       /tmp/build_3cljt2m8e8r7e/Gemfile:2:in `evaluate': undefined method `ruby' for #<Bundler::Dsl:0x00000003221778> (NoMethodError)
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/dsl.rb:7:in `instance_eval'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/dsl.rb:7:in `evaluate'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/definition.rb:17:in `build'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler.rb:128:in `definition'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/cli.rb:225:in `install'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `run'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor.rb:246:in `dispatch'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/lib/bundler/vendor/thor/base.rb:389:in `start'
        from /usr/ruby1.9.2/lib/ruby/gems/1.9.1/gems/bundler-1.0.7/bin/bundle:13:in `<top (required)>'
        from /usr/ruby1.9.2/bin/bundle:19:in `load'
        from /usr/ruby1.9.2/bin/bundle:19:in `<main>'
       FAILED: http://devcenter.heroku.com/articles/bundler
 !     Heroku push rejected, failed to install gems via Bundler

To git@heroku.com:<app_name>.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:<app_name>.git' 
```

当前的 Gemfile：

```
source 'https://rubygems.org'
ruby '1.9.3'

gem 'bundler', '1.3.0.pre.8'
gem 'rails', '~> 3.2'
gem 'jquery-rails', '~> 2.2'
gem 'slim', '~> 1.3'
gem 'dynamic_form', '~> 1.0'
gem 'state_machine', '~> 1.1'
gem 'draper', '~> 1.1'
gem 'bcrypt-ruby', '~> 3.0', :require => 'bcrypt'
gem 'thin', '~> 1.5'
gem 'twitter-bootstrap-rails', '~> 2.2'

group :assets do
  gem 'sass-rails', '~> 3.2.3'
  gem 'less-rails', '~> 2.2'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'therubyracer', '~> 0.11', :platforms => :ruby
  gem 'uglifier', '>= 1.0.3'
end

group :development do
  gem 'sqlite3', '~> 1.3'
  gem 'pry', '~> 0.9'
  gem 'better_errors', '~> 0.3'
  gem 'binding_of_caller', '~> 0.6'
end

group :production do
  gem 'pg', '~> 0.14'
end 
```

Bundler似乎有问题，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:10:49.967

问题是由 Gemfile 的第 2 行引起的：

```
ruby '1.9.3' 
```

从输出中我们可以看到正在运行的 Bundler 版本：

```
Gemfile detected, running Bundler version 1.0.7 
```

但`ruby`指令似乎是 Bundler 1.2 的功能，不适用于旧的 Bundler。我认为您现在可以安全地删除此`ruby '1.9.3'`行。

* * *

当然，您`gem 'bundler', '1.3.0.pre.8'`的 gemfile 中有。但这是先有鸡还是先有蛋的问题：在解析 Gemfile 之前不会安装新的 Bundler，但旧的 Bundler 无法解析它。

# javascript - 在 Node.js 下存储 JSON 的简单方法

> ID：14939289
> 
> 赞同：45
> 
> 时间：2013-02-18T15:04:23.147
> 
> 标签：javascript, json, node.js, database

我正在寻找一种超级简单的方法来在**Node.js下以持久方式存储一个****JSON**数组。它不需要有任何特殊功能。我只想在其中放置一个 JSON 对象，并能够在下次服务器重新启动时读取它。

 **（像**MongoDB**和**CouchDB**这样的解决方案对于这个目的来说似乎都过大了。）

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-02-18T15:11:10.257

为什么不写入文件？

```
// Writing...
var fs = require("fs");
var myJson = {
    key: "myvalue"
};

fs.writeFile( "filename.json", JSON.stringify( myJson ), "utf8", yourCallback );

// And then, to read it...
myJson = require("./filename.json"); 
```

请记住，如果您需要反复读写，则必须为您反复读取的每个文件清除 Node 的缓存，否则 Node 将不会重新加载您的文件，而是产生它在第一次`require`调用期间看到的内容。幸运的是，清除特定需求的缓存非常容易：

```
delete require.cache[require.resolve('./filename.json')] 
```

另请注意，如果（从节点 12 开始）您使用的是 ES 模块而不是 CommonJS，则该`import`语句没有相应的缓存失效。相反，使用[动态 import()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import#dynamic_imports)，然后因为导入来自 URL，您可以添加查询字符串作为缓存清除的形式作为导入字符串的一部分。

或者，为了避免任何内置缓存，请使用`fs.readFile()`/`fs.readFileSync()`而不是 require（如果您正在编写基于 Promise 的代码，则使用`fs/promises`而不是`fs`使用 async/await 显式或隐式）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-01-16T22:54:45.227

试试 NeDB：[https ://github.com/louischatriot/nedb](https://github.com/louischatriot/nedb)

“Node.js 的嵌入式持久数据库，用 Javascript 编写，没有依赖项（当然 npm 模块除外）。您可以将其视为 Node.js 项目的 SQLite，可以与简单的 require 语句一起使用。API是 MongoDB 的子集。您可以将其用作持久性或仅内存数据存储。”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-06-25T15:48:29.140

我找到了一个名为[json-fs-store 的库](https://github.com/alexkwolfe/json-fs-store)，用于将 JavaScript 对象序列化为文件中的 JSON 并稍后检索它。

通过该`store.load`方法（目前未在文档中描述）检索文件时，它被解析`JSON.parse`为比`require`在另一个答案中执行类似操作更好：

*   当内容格式错误时，您会得到适当的错误处理
*   如果有人设法将 JavaScript 代码潜入文件中，则会导致解析错误，而不是 JS 被执行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-08T08:33:29.833

如果您正在寻找性能考虑：LokiJS

[https://www.npmjs.com/package/lokijs](https://www.npmjs.com/package/lokijs)

[http://lokijs.org/#/](http://lokijs.org/#/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-06-14T05:59:10.577

如果您需要简单的数据存储，无需外部进程，性能非常高且稳定，您可能会喜欢[Rocket-store](https://www.npmjs.com/package/rocket-store)。它使用起来非常简单，包含该模块，您就可以立即开始插入记录。

它具有三个主要方法：**put**、**get**和**delete**（以及一些特殊的方法和选项设置）

**例子：**

```
// collection/table = "cars", key = "Mercedes"
result = await rs.post("cars", "Mercedes", {owner: "Lisa Simpson", reg: "N3RD"});

// Get all records from "cars" collection
result = await rs.get("cars","*");

// Delete records in collection "cars" where keys match "*cede*"
result = await rs.delete("cars","*cede*"); 
```

它依靠底层文件系统缓存来优化速度，并且可以处理数百万条记录。

你会得到简单的序列、自动递增和其他次要的便利，但仅此而已。没有什么花哨。当我需要一个简单的存储解决方案时，我非常喜欢它，但作为作者，我也非常有偏见；）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-18T15:07:23.417

您可以将 JSON 数据保存在一个简单的文本文件中，并在服务器重新启动时读取它。

```
const data = require("yourarrayfile.json"); 
```

然后像往常一样使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-10-30T13:48:29.817

试试[LowDB](https://github.com/typicode/lowdb)

Lowdb 是一个由 Lodash 提供支持的小型本地 JSON 数据库（支持 Node、Electron 和浏览器）。如果您了解 Lodash，那么您已经知道如何使用 Lowdb。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-28T13:25:31.867

虽然 LokiJS 和 NeDB 看起来都有更多的用户，但我只是遇到了[TaffyDB](http://www.taffydb.com/)。虽然我自己没有尝试过，但我想我应该在这里添加它以保持完整性。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-06-06T13:44:18.257

建议节点的 fs 系统的用户我必须同意。如果 mongoDB 等已经过大了，其他人都在建议对我来说似乎总体上的东西。简单的语言环境存储或节点的 fs 库。

我记得当我开始我的 web 开发之旅时，我对通过 mongoDB 等学习持久数据存储技术的了解还不够。但是 node 的 fs 库为我的一些早期应用程序做了诀窍。即使重新启动本地服务器，所有数据也保持不变**

# excel - Excel 2013 数据透视表在导航到手动之前不会更改当前页面

> ID：14939292
> 
> 赞同：3
> 
> 时间：2013-02-18T15:04:37.673
> 
> 标签：excel, pivot-table, office-2013, office-2016, vba

我们有一小段 VBA 代码可以完美运行多年。本质上是：

```
Me.PivotTables("APivot").PivotFields("AField").CurrentPage = "Some text" 
```

这一直有效，直到 Excel 2013，该行将失败并出现非特定错误：

> 运行时错误 5：
> 无效的过程调用或参数。

通过反复试验，我们发现在 Excel 2013 中，在用户使用 Excel 界面手动导航到该页面之前，您无法使用代码导航到数据透视表页面。一旦用户导航到一个页面，使用代码导航到该页面将始终成功（直到您关闭工作簿）。因此，为了让代码能够导航到任何页面，我们首先需要用户手动浏览所有页面。

一种解决方法是更改​​底层单元格的值：

```
Me.PivotTables("APivot").PivotFields("AField").CurrentPage.LabelRange.Value = "Some text" 
```

我们目前被迫使用这种解决方法，但感觉很hackish。

Excel 2013 中究竟是什么导致了这种行为？现在是否需要先做一些事情才能导航到页面（戳一些东西，以某种方式加载一些数据等）？

编辑：Office 2016 中出现同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-11T21:16:23.453

我不确定它们最初是如何“隐藏”的，但我遇到了同样的问题并找到[了这篇文章](http://www.mrexcel.com/forum/excel-questions/567299-visual-basic-applications-pivot-table-filter-setting-run-time-error-5-a.html)。

那里的解决方案是右键单击过滤器字段（在电子表格单元格上，而不是字段列表上）并在字段设置下，确保项目没有被隐藏。

# php - Wordpress 插件 cpage 变量

> ID：14939294
> 
> 赞同：0
> 
> 时间：2013-02-18T15:04:40.517
> 
> 标签：php, wordpress

我正在制作一个插件来隐藏评论页面标题中的规范元素。

我完整的插件代码是：

```
global $cpage; 
if($cpage > 1){
remove_action('wp_head', 'rel_canonical');
} 
```

因此，如果评论页码 > 1，那么它将删除规范。

如果我只是`remove_action('wp_head', 'rel_canonical');`没有 IF 那么它可以工作......但我正在尝试使用变量 $cpage （它在 wordpress 中给出评论页码）仅在评论页面上删除......

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:06:03.910

如果它不适用于`IF`语句，那么`$cpage`显然不大于 1。在语句`echo $cpage;`之前尝试`IF`检查你得到的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:31:27.233

尝试：

```
function kill_comments_canonical() {
  global $cpage; 
  if(!empty($cpage) && $cpage > 1){
    remove_action('wp_head', 'rel_canonical');
  }
}
add_action('wp_head','kill_comments_canonical',9); 
```

原始代码可能有几个问题。首先，`$cpage`当你需要它时可能不会被设置——当你的插件中的代码运行时，所以将它挂钩到`wp_head`何时设置。其次，您需要`remove_action`在`rel_canonical`添加之后但在打印之前运行，因此`add_action`最后一行的第三个优先级参数。顺便说一句，我是通过跟踪和错误得出这个数字的。

# makefile - 在 Makefile 中使用变量

> ID：14939295
> 
> 赞同：1
> 
> 时间：2013-02-18T15:04:42.017
> 
> 标签：makefile, gnu-make

这是一个简单的 Makefile。

```
FILENAME=test.`date +"%Y.%m.%d %H:%M:%S"`.txt
test:
    @echo ${FILENAME}
    @sleep 2s
    @echo ${FILENAME} 
```

的输出`make test`是

```
test.2013.02.18 15:30:23.txt
test.2013.02.18 15:30:25.txt 
```

问题是`FILENAME`每次使用时都在计算。我希望它只计算一次并且在脚本运行时是相同的。我做错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:12:51.320

GNU Make 有两种变量。您使用了*递归扩展*变量，但您想要一个*简单扩展*变量。见[http://www.gnu.org/software/make/manual/html_node/Flavors.html#Flavors](http://www.gnu.org/software/make/manual/html_node/Flavors.html#Flavors)

对于您当前的 Makefile，该变量包含确切的文本，并且每次您引用它时，该文本都会被逐字替换，因此您的 Makefile 相当于：`test.`date +"%Y.%m.%d %H:%M:%S"`.txt`

```
test:
    @echo test.`date +"%Y.%m.%d %H:%M:%S"`.txt
    @sleep 2s
    @echo test.`date +"%Y.%m.%d %H:%M:%S"`.txt 
```

这样看来，shell 运行`date`命令两次应该很明显。

要获得您想要的行为，您需要设置一个简单扩展的变量，并且您需要在定义它的位置运行 shell 命令，它不能使用反引号，因为它们是 shell 元字符，但 Make 会忽略它们，所以你改用 Make 的`shell`函数：

```
FILENAME := test.$(shell date +"%Y.%m.%d %H:%M:%S").txt 
```

# javascript - 从字符串中提取图像 src

> ID：14939296
> 
> 赞同：21
> 
> 时间：2013-02-18T15:04:47.487
> 
> 标签：javascript, regex, node.js

我正在尝试将所有图像元素匹配为字符串，

这是我的正则表达式：

```
html.match(/<img[^>]+src="http([^">]+)/g); 
```

这有效，但我想提取`src`所有图像。所以当我在这个字符串上执行正则表达式时：

`<img src="http://static2.ccn.com/ccs/2013/02/img_example.jpg />`

它返回：

`"http://static2.ccn.com/ccs/2013/02/img_example.jpg"`

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-21T22:29:24.683

您需要使用捕获组`()`来提取网址，如果您想要全局匹配`g`，即不止一次，当使用捕获组时，您需要`exec`在循环中使用（`match`全局匹配时忽略捕获组）。

例如

```
var m,
    urls = [], 
    str = '<img src="http://site.org/one.jpg />\n <img src="http://site.org/two.jpg />',
    rex = /<img[^>]+src="?([^"\s]+)"?\s*\/>/g;

while ( m = rex.exec( str ) ) {
    urls.push( m[1] );
}

console.log( urls ); 
// [ "http://site.org/one.jpg", "http://site.org/two.jpg" ] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-18T15:16:49.913

```
var myRegex = /<img[^>]+src="(http:\/\/[^">]+)"/g;
var test = '<img src="http://static2.ccn.com/ccs/2013/02/CC_1935770_challenge_accepted_pack_x3_indivisible.jpg" />';
myRegex.exec(test); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-18T15:18:50.500

正如 Mathletics 在评论中提到的，还有其他更直接的方法可以从标签中检索*src*属性，`<img>`例如通过 id、name、class 等检索对 DOM 节点的引用，然后仅使用您的引用来提取您的信息需要。如果您需要对所有`<img>`元素执行此操作，则可以执行以下操作：

```
var imageTags = document.getElementsByTagName("img"); // Returns array of <img> DOM nodes
var sources = [];
for (var i in imageTags) {
   var src = imageTags[i].src;
   sources.push(src);
} 
```

但是，如果您有一些限制迫使您使用正则表达式，那么提供的其他答案就可以了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-18T15:15:27.320

也许这就是您正在寻找的：

我所做的只是稍微修改了您的正则表达式，然后使用该`exec`函数来获取匹配字符串的数组。如果您有超过 1 场比赛，其他比赛将继续`results[2]`，`results[3]`...

```
var html = '<img src="http://static2.ccn.com/ccs/2013/02/CC_1935770_challenge_accepted_pack_x3_indivisible.jpg" />';

var re = /<img[^>]+src="http:\/\/([^">]+)/g
var results = re.exec(html);

var source = results[1];
alert(source); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-31T14:28:48.153

您可以使用 html 解析器并完全避免使用正则表达式。

```
var parser = require('node-html-parser');

var html = '<img src="http://static2.ccn.com/ccs/2013/02/CC_1935770_challenge_accepted_pack_x3_indivisible.jpg" />'

parser.parse(html).querySelector('img').getAttribute('src')

=> 'http://static2.ccn.com/ccs/2013/02/CC_1935770_challenge_accepted_pack_x3_indivisible.jpg' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T15:14:40.283

您可以使用**组**`src`访问该值

 **```
 |->captured in group 1
                                   ----------------------------------                
var yourRegex=/<img[^>]+src\s*=\s*"(http://static2.ccn.com/ccs[^">]+)/g;
var match = yourRegex.exec(yourString);
alert(match[1]);//src value 
```**

# java - 使用 selenium 处理弹出窗口

> ID：14939298
> 
> 赞同：8
> 
> 时间：2013-02-18T15:04:55.790
> 
> 标签：java, selenium, popup, selenium-webdriver

我有一种情况，单击链接网页会打开一个弹出窗口。弹出窗口打开后，焦点在弹出窗口中，主窗口被禁用。而且我无法将控件转移到弹出窗口。请看下面的代码。

```
driver.findElement(By.linkText("Click me")).click();// when this line of code is reached then a popup window opens.

System.out.println("After Clicking me"); // After the popup window opens this line of code is never executed. 
```

我无法将控件从父窗口转移到弹出窗口。我知道以下命令。

```
driver.switchTo().window("popup window"); 
```

但它没有多大帮助。请帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-18T19:24:52.843

这是我在需要使用以下弹出窗口时使用的代码，将其关闭并返回到我的主窗口。当然，为了这个答案，它已经被简化了。它维护原始窗口（主）的句柄，因此可以在其他窗口之间产生差异。

它需要一个明确的 WebDriverWait 因为我在开发过程中确实遇到了代码在窗口实际打开之前运行的问题，所以这可能不是一个理想的条件，

```
function manipulatePopUp(final WebDriver driver, final WebDriverWait wait) {
    final String mainWindowHandle = driver.getWindowHandle();
    driver.findElement(By.id("linkThatOpensPopUp")).click();

    wait.until(new ExpectedConditions<Boolean>() {
        @Override
        public Boolean apply(WebDriver d) {
            return (d.getWindowHandles().size() != 1);
        }
    });

    for (String activeHandle : driver.getWindowHandles()) {
        if (!activeHandle.equals(mainWindowHandle)) {
            driver.switchTo().window(activeHandle);
        }
    }

    driver.close();
    driver.switchTo().window(mainWindowHandle);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-19T06:28:54.653

> driver.findElement(By.linkText("Click me")).click();// 当到达这行代码时，会打开一个弹出窗口。
> 
> System.out.println("点击我后"); // 弹出窗口打开后，这行代码永远不会执行。

这行代码永远不会执行，因为进程正在等待处理弹出窗口。

getWindowHandles() 在这种情况下可以正常工作。

例子：

```
//handle of the master window before clicking the link
String master = driver.getWindowHandle();

driver.findElement(By.linkText("Click me")).click();

//logic for waiting for the popup, checking the size to become greater than 1 or breaking after sometime to avoid the infinite loop.
int timeCount = 1;

do
{
   driver.getWindowHandles();
   Thread.sleep(200);
   timeCount++;
   if ( timeCount > 50 ) 
   {
       break;
   }
}
while ( driver.getWindowHandles().size == 1 );

//Assigning the handles to a set
Set<String> handles = driver.getWindowHandles();
//Switching to the popup window.
for ( String handle : handles )
{
    if(!handle.equals(master))
    {
         driver.switchTo().window(handle);
    }
} 
```

现在驱动程序切换到弹出窗口。如果弹出窗口有一个框架，那么您需要在识别其中的元素之前切换到该框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T11:36:12.867

```
public class socialSignOn extends masterBaseClassNewSiteStage {

    @Test
    public void testSocialSignOn() throws Throwable {
        openParticularUrl("/my-lfc/join/user-details?user_type=free");

        driver.findElement(By.cssSelector("#socialSignOn > div.left.socialLogin.googleButton")).click();

        String MainWindow = driver.getWindowHandle();

        for (String activeHandle : driver.getWindowHandles()) {
            if (!activeHandle.equals(MainWindow)) {
                driver.switchTo().window(activeHandle);
            }
        }
        driver.findElement(By.cssSelector("#Email")).sendKeys("");
        driver.findElement(By.cssSelector("#next")).click();
        pauseFiveSeconds();
        driver.findElement(By.cssSelector("#Passwd")).sendKeys("");
        driver.findElement(By.cssSelector("#signIn")).click();
        pauseOneSecond();
        driver.switchTo().window(MainWindow);
        pauseTenSeconds();
        closeDriver();
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-09-27T21:57:59.850

```
// delay : max number of seconds
new WebDriverWait(driver, delay * 1000).until(ExpectedConditions.alertIsPresent());
drive`enter code here`r.switchTo().alert().accept(); 
```

# angularjs - 邮件验证 angularjs

> ID：14939303
> 
> 赞同：0
> 
> 时间：2013-02-18T15:05:21.730
> 
> 标签：angularjs, angularjs-directive

我对 angularjs 和电子邮件输入类型有疑问。

我想使用指令创建动态输入，但输入类型验证可能有问题。这是我测试的 jsfiddle [http://jsfiddle.net/NPCHr](http://jsfiddle.net/NPCHr)

为了避免一些麻烦，我必须使用这个技巧

```
element.find('input')[0].type = input.type; 
```

当我在输入中有第二个字符时，模型字段消失（在 html 面板中）

我不知道为什么这是一个错误或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:28:04.250

您的指令的问题不在于电子邮件验证不起作用，而是`type`AngularJS（和jQuery BTW）不支持动态属性这一事实。这是因为 IE 不允许即时更改输入的类型（[使用 JavaScript 更改 IE 中的 <input> 类型](https://stackoverflow.com/questions/2566394/changing-the-input-type-in-ie-with-javascript)）。

该主题在 AngularJS 邮件列表中进行了详细讨论，以下是参考：[https](https://groups.google.com/forum/#!topic/angular/Itl-fYzeF18) ://groups.google.com/forum/#!topic/angular/Itl-fYzeF18有人遇到与您完全相同的问题。

摆脱这种情况的方法是使用`$compile`服务手动编译模板。不幸的是，这不是微不足道的，你可以在这里看到一些实验的证据：[https ://github.com/angular-ui/angular-ui/pull/191](https://github.com/angular-ui/angular-ui/pull/191)

另一种更简单的方法是使用`ngInclude`指令来根据类型包含不同的输入。另一种可能性是使用编译功能并手动转换模板的标记。但是，是的，所有这些技术都需要几行重要的代码。

# postgresql - PostgreSQL VCL 控件

> ID：14939305
> 
> 赞同：1
> 
> 时间：2013-02-18T15:05:25.393
> 
> 标签：postgresql, vcl

我编写软件的产品之一是会计类型的应用程序。它是用 C++ 编写的，使用 C++ Builder 和 VCL 控件，连接到在 Linux 上运行的 PostgreSQL 数据库。

PostgreSQL 数据库当前版本为 8.4.x。我们使用 UTF8 编码。一切都很好。

我们正在使用完全相同的编码针对 PostgreSQL v9.2.3 运行我们的软件测试，并且发现了一个问题，即我们所有的文本编辑输入都用 \r\n 字符替换了多行。

因此，例如，您输入 3 行文本并在每行后按回车键，然后保存并读回，我得到一行，其中行尾字符被删除。当我们从数据库中获取数据时，我们会得到如下一行： line1\r\nline2\r\nline3\r\n 其中显示“\r\n”，而不是在流中获取 0x0A、0x0D。

我们的应用程序不支持 Unicode。Borland 的 AnsiString。（在将此应用程序迁移到 C++ Builder XE 的过程中）。有谁知道可能是什么原因造成的，或者提供一些东西来尝试在当前代码库中解决这个问题，同时进行更大的转换？

我已经尝试过 Borland DBText 和 DBrichText 控件，它们都做同样的事情。

我应该提到的另一点是我们只在服务器上针对新的 PostgreSQL 进行了测试，并且仍在使用 8.x PostgreSQL 客户端库 (psql.lib)。所以客户端和服务器版本并不完全在同一级别，但我不怀疑这是一个问题，但任何见解当然欢迎。

更新：

以下是 PostgreSQL 两个版本的一些命令行结果。

版本 9.2.3 testdb=# select * from notes where oid=5146352; 顺从 | 文档 | 用户名 | 创建 | 跟进 | 提醒 | 主题 | 评论
-------+----------+----------+------- ------------+---------+----------+-----------+--- -------------------------- 3001 | 11579522 | 埃里克 | 2013-02-15 22:38:24.136517+00 | f | f | 测试笔记 | 第 1 行\r\n第2行\r\n第3行\r\n

版本 8.4.8 testdb=# select * from notes where oid=16490575; 顺从 | 文档 | 用户名 | 创建 | 跟进 | 提醒 | 主题 | 评论-------+----------+----------+------- ------------+----------+----------+--------------+- --------- 3001 | 11579522 | 埃里克 | 2013-02-18 20:15:23.10943-05 | f | f | <> | line1\r : line2\r : line3\r :

不知道如何为 SO 格式化，但在 8.4.8 命令行输出中，我在屏幕上打印了 3 行新行，因为 9.2.3 版本连接了输出。

两个数据库的插入是同一个客户端。所以 PostgreSQL 处理换行符的方式发生了一些变化，我想知道是否有一个配置设置来恢复旧的行为，或者我可以在我的 select 语句中做些什么来恢复旧的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:54:47.983

8.4默认设置为[standard_conforming_strings](http://www.postgresql.org/docs/9.2/static/runtime-config-compatible.html)`off`，9.2`on`默认设置。

当 it's`off`在文字字符串中时，`'\n'`表示 C 语言中的换行符，而当 it's 时`on`，它表示后跟字符的反斜杠字符`n`。

要回到 8.4 的行为，您可以`SET standard_conforming_strings=off`在会话中发出或

```
ALTER DATABASE yourdb SET standard_conforming_strings=off; 
```

使其持久存在并成为与该数据库的新连接的默认值。

从长远来看，建议调整您的代码以应对，`standard_conforming_strings`因为`on`这是前进的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T02:28:53.253

您的问题看起来与 postgres config variable 有关`standard_conforming_strings`。在 Postgres 9.1 之前，默认情况下这是关闭的。这就是为什么 postgres 没有按字面意思对待反斜杠，而是解释它们。但根据 SQL 标准，反斜杠应该按字面意思对待。所以，从 postgres 9.1 开始，这个配置变量已经打开，你会看到你`\r\n`的文字而不是解释。

虽然这不是正确的方法，但要使其适用于您的情况，您需要编辑服务器的配置文件（postgresql.conf）并关闭此设置（`standard_conforming_strings=on`）

# google-app-engine - GWT：解密 GAE-JDO 密钥以访问父级

> ID：14939306
> 
> 赞同：3
> 
> 时间：2013-02-18T15:05:29.933
> 
> 标签：google-app-engine, gwt, key, jdo

GAE-JDO 文档建议可以从子键中检索父键：

> 另请注意，密钥的字符串表示未加密：用户可以解码密钥字符串以提取其组件，包括实体及其祖先的种类和标识符。

REF：[“实体、属性和键”](https://developers.google.com/appengine/docs/java/datastore/entities#Generating_Keys)

我正在使用以下内容生成密钥：

```
@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
@Extension(vendorName = "datanucleus", key = "gae.encoded-pk", value = "true")
private String id; 
```

检查数据存储时，我的实体键如下所示：

```
parent.id = agpzfnZpdmVlbGFichQLEgdTZXNzaW9uGICAgICgwMsIDA
child1.id = agpzfnZpdmVlbGFiciYLEgdTZXNzaW9uGICAgICgwMsIDAsSBVN0YWdlGICAgICAwK8KDA
... 
```

（其中 Parent 有 Child 类型的孩子）。所以，我正在寻找的是一个像这样的 GWT 函数：

```
String getParentIdFromChildId(String childId) {
    String parentId = ...        
    return parentId;
} 
```

这样我就可以从客户端（GWT）引用子对象（首先找到它的父对象）：

```
Child child = data.getParent(getParentIdFromChildId(childId)).getChild(childId); 
```

我也可以通过跟踪父 id 来解决这个问题，但是如果父信息已经嵌入到子 id 中，那么这是低效的。

提前致谢。

~欧文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T01:16:22.783

`child1.getParent()`返回实体父级的键`child1`。

因此，如果您有一个 entity `child1`，并且想要其父 ID，只需调用：

```
String parentId = child1.getParent().id; 
```

返回它的父母的身份证。

在这里阅读更多： [实体'getParent（）'方法文档](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/Entity#getParent%28%29)

不确定这是否是您想要的，但我会这样做。

谢谢，

~萨米尔

# php - 如何避免电子邮件正文中的硬编码换行符？

> ID：14939307
> 
> 赞同：0
> 
> 时间：2013-02-18T15:05:30.313
> 
> 标签：php, email, newline

我有一个应用程序发送包含以下内容的电子邮件..

```
$message= "Hi, some_content  \n some_content_on_new_line". 
```

我希望 some_content_on_new_line 在电子邮件的换行上，但是在发送电子邮件时，“\n”不会插入换行符。相反，它显示为反斜杠，后跟“n”。我怎样才能防止这种情况？这是我的电子邮件配置。

```
mail($to, $subject, $message, $headers) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:13:03.417

如果`\n`显示在电子邮件内容中，那么问题很可能是使用单引号来定义字符串文字。

```
$message= 'Hi, some_content  \n some_content_on_new_line';
// this will show the \n

$message= "Hi, some_content  \n some_content_on_new_line";
// this will interpolate the newline properly 
```

# ios - CCTexture2D 创建的 texture.size 不等于 image.size（仅在 iPad 上 --> iPad 模拟器工作正常）

> ID：14939309
> 
> 赞同：1
> 
> 时间：2013-02-18T15:05:43.380
> 
> 标签：ios, ipad, cocos2d-iphone

我有一个很奇怪的问题。当我运行这段代码

```
CCTexture2DMutable * texture = [[CCTexture2DMutable alloc] initWithCGImage:image.CGImage resolutionType: kCCResolutioniPadRetinaDisplay];

    CGFloat heightOfImage = image.size.height;
    CGFloat heightOfTexture = texture.contentSize.height; 
```

**initWithCGImage**是从 CCTexture2D 继承的方法。图像 <-- UIImage

我得到非常奇怪的结果：

**在 iPad 模拟器上**（工作正常）：

高度图像 = 1024

纹理高度 = 1024

**在 iPad（视网膜）上**（不等于？？？）：

高度图像 = 1024

纹理高度 = 512

有谁知道为什么？它让我疯狂。

如果我将 kCCResolutioniPadRetinaDisplay 更改为 kCCResolutioniPad，问题是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:44:34.180

Cocos 使用点进行测量，而不是像素（不再）。这就是为什么图像大小（以像素为单位）与纹理大小（以点为单位）不同的原因

# c# - 估计将集合 x 映射到集合 y 的三次多项式

> ID：14939311
> 
> 赞同：0
> 
> 时间：2013-02-18T15:05:51.167
> 
> 标签：c#, math, polynomial-math

我有一组（采样的）来自设备的未校准值（x）和一组它们应该是的值（y）。我正在寻找/估计`y=ax^3 + bx^2 + cx + d`将任何映射`x`到的三次多项式`y`。

所以我认为我需要做的是首先进行多项式回归，然后找到它的逆，但我不太确定；我想知道是否有更好的解决方案，比如最小二乘法。

我将不胜感激朝着正确的方向轻推和/或任何指向有用的数学库的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:16:33.887

你检查过朗朗日插值吗？它是关于给定函数的多项式逼近。

您可以在独立变量的适当范围内停止对多项式的给定次数（假设是 3 次）的逼近。

参考：

*   [http://en.wikipedia.org/wiki/Lagrange_polynomial](http://en.wikipedia.org/wiki/Lagrange_polynomial)

*   [https://math.stackexchange.com/a/108623](https://math.stackexchange.com/a/108623)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T08:49:07.737

看起来它只是多项式回归；我只需要输入原始 (x) 值和预期值 (y)。

[Rosetta Code](http://rosettacode.org/wiki/Polynomial_regression)中的代码，使用[Math.Net Numerics](http://mathnetnumerics.codeplex.com/)

```
using MathNet.Numerics.LinearAlgebra.Double;
using MathNet.Numerics.LinearAlgebra.Double.Factorization;
public static class PolyRegression
{
    public static double[] Polyfit(double[] x, double[] y, int degree)
    {
        // Vandermonde matrix
        var v = new DenseMatrix(x.Length, degree + 1);
        for (int i = 0; i < v.RowCount; i++)
            for (int j = 0; j <= degree; j++) v[i, j] = Math.Pow(x[i], j);
        var yv = new DenseVector(y).ToColumnMatrix();
        QR qr = v.QR();
        // Math.Net doesn't have an "economy" QR, so:
        // cut R short to square upper triangle, then recompute Q
        var r = qr.R.SubMatrix(0, degree + 1, 0, degree + 1);
        var q = v.Multiply(r.Inverse());
        var p = r.Inverse().Multiply(q.TransposeThisAndMultiply(yv));
        return p.Column(0).ToArray();
    }
} 
```

# soap - Apache Camel 使用 SOAP 端点进行节流 -> TransformerException

> ID：14939319
> 
> 赞同：0
> 
> 时间：2013-02-18T15:06:11.250
> 
> 标签：soap, cxf, apache-camel, throttling

我们有一个提供 SOAP 服务的 Apache Camel 应用程序。“初始路由”从 Apache CFX 提供的端点开始。

我们需要一个简单的机制来防止消息被“过快”处理（并且没有大量的可扩展性需求）。

因此我们最终尝试了[Throttler](http://camel.apache.org/throttler.html)。现在，问题是在我们的路由添加节流阀后，出现了问题。

最初的路线，有些清洁：

```
from("cxf:bean:sapEndpoint").routeId(SOAP_ENDPOINT)
    .throttle(1)
    .onException(Exception.class)
        .to("direct:emailFaultNotification").handled(false)
    .end()
    .transacted(joinJpaTx)
    .to(xsltRemoveEmptyElements) // Cleaning done with XSLT endpoint
    .to("direct:inboundWorkOrderXml"); // Forward to actual processing

// direct:inboundWorkOrderXml contains various validation, persistance & response 
```

我们的日志中的错误：

```
2013-02-18 16:50:16,257 [tp1636587648-50] ERROR DefaultErrorHandler            - Failed delivery for exchangeId: ID-...-4\. Exhausted after delivery attempt: 1 caught: javax.xml.transform.TransformerException: javax.xml.transform.TransformerException: com.sun.org.apache.xml.internal.utils.WrappedRuntimeException: Content is not allowed in prolog.
javax.xml.transform.TransformerException: javax.xml.transform.TransformerException: com.sun.org.apache.xml.internal.utils.WrappedRuntimeException: Content is not allowed in prolog.
    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:735)[:1.6.0_37]
    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:336)[:1.6.0_37]
    at org.apache.camel.builder.xml.XsltBuilder.process(XsltBuilder.java:98)[camel-core-2.7.0.jar:2.7.0]
    at org.apache.camel.impl.ProcessorEndpoint.onExchange(ProcessorEndpoint.java:102)[camel-core-2.7.0.jar:2.7.0]
    at org.apache.camel.impl.ProcessorEndpoint$1.process(ProcessorEndpoint.java:72)[camel-core-2.7.0.jar:2.7.0]
    ... 
```

我想节流阀不会像我想象的那样直接工作。

似乎启用限制后，XSLT 端点接收到空的或无效的 XML？没有油门定义一切正常。通过短暂的尝试，消息体似乎仍然包含 XML 字符串？

一些想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T17:06:26.740

当使用 Camel 错误处理进行重新传递时，请注意流式有效负载。有关流缓存的信息，请参见：http: [//camel.apache.org/stream-caching.html](http://camel.apache.org/stream-caching.html)

Camel CXF 文档页面顶部还有一个提示：http: [//camel.apache.org/cxf](http://camel.apache.org/cxf)关于此

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T12:00:49.897

最后解决方案比我想象的要简单。我没有在从“cxf:bean:sapEndpoint”开始的路由中使用节流阀，而是在路由处理“direct:inboundWorkOrderXml”中添加了节流阀。

不知道确切的原因，可能与节流功能的某些部分可能会因路由的起点而异。（所以直接端点没有遇到 cxf-endpoint 的问题）

# sql - 了解关于 INSERT 错误的 SSMS 错误消息：

> ID：14939320
> 
> 赞同：1
> 
> 时间：2013-02-18T15:06:15.620
> 
> 标签：sql, sql-server, ssms, sql-server-2008

当我运行 SSMS 命令插入数据时，我收到此错误：

> *消息 206，级别 16，状态 2，第 1 行
> 操作数类型冲突：int 与 ntext 不兼容*

什么是ment by`Level 16, State 2`

我的插入是标准插入：

```
insert into surveys 
values (18964, 'CD9E8ACE-0D22-4969-B324-620DAFF06F97', 19959, 486,  etc etc 
```

我如何找到我的错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:07:19.700

可能您在字符串列上插入没有单引号的值。字符串值需要被引用，因为它们是文字而不是标识符。

# mysql - Doctrine - Empty leftJoin SQL

> ID：14939324
> 
> 赞同：0
> 
> 时间：2013-02-18T15:06:28.373
> 
> 标签：mysql, doctrine

我构建了我的实体的以下部分：

```
/**
* @var Application_Model_Ticket
* 
* @OneToMany(targetEntity="Application_Model_Ticket",mappedBy="contacts_id")
* @JoinColumn(name="id", referencedColumnName="contacts_id")
*/
private $tickets;    
public function getTickets() {
    return $this->tickets; 
} 

/**
* @var Application_Model_Contact
*
* @ManyToOne(targetEntity="Application_Model_Contact",cascade={"persist"})
* @JoinColumn(name="contacts_id", referencedColumnName="id")
*/
private $contact;
public function getContact() {
     return $this->contact; 
} 
```

当我现在尝试以下 Doctrine Code 时：

```
$this->oQueryBuilder->select('contact','ticket')
                    ->from('Application_Model_Contact', 'contact')
                    ->leftJoin('contact.tickets', 'ticket')
                    ->orderBy('contact.id', 'DESC'); 
```

我得到一个 MYSQL 错误。发生以下情况：

```
FROM contact c0_ LEFT JOIN  ORDER BY c0_.id DESC 
```

似乎 Doctrine 没有正确填写 LEFT JOIN。有谁知道，为什么会这样？

更新：

```
->leftJoin('contact.tickets', 'ticket', 'WITH','contact.id = ticket.contactsId') 
```

给我

```
LEFT JOIN  AND (c0_.id = t1_.contacts_id) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:20:00.943

尝试这个：

```
$this->oQueryBuilder->select('contact','ticket')
                    ->from('Application_Model_Contact', 'contact')
                    ->leftJoin('contact.tickets', 'ticket', 'WITH', 'contact.id = ticket.contacts_id')
                    ->orderBy('contact.id', 'DESC'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:12:59.833

你错过了`ON`你的查询

```
$this->oQueryBuilder
     ->select('contact','ticket')
     ->from('Application_Model_Contact', 'contact')
     ->leftJoin('contact', 'on contact.ticket=Application_Model_Contact.field')
     ->orderBy('contact.id', 'DESC'); 
```

将其`Application_Model_Contact.field`替换为匹配字段以应用`JOIN`

所以你的查询应该是这样的：

```
....FROM contact c0_ LEFT JOIN ON table1.field=table2.field ORDER BY c0_.id DESC 
```

来源： http: [//oldforum.symfony-project.org/index.php/m/69061/](http://oldforum.symfony-project.org/index.php/m/69061/)

Mysql 加入：[http ://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

# d3.js - 处理多个多边形 d3

> ID：14939325
> 
> 赞同：3
> 
> 时间：2013-02-18T15:06:36.987
> 
> 标签：d3.js

下面关于绘制多边形的答案适用于单个多边形。但是，如果有多个多边形怎么办？简单地添加一个带有点的额外多边形似乎不起作用，即使使用“全选”似乎表明可以毫无问题地添加更多多边形。

我们有一个多边形数组，每个多边形都有一个属性 Points，它是一个点数组。

第一个带有多边形的数组显然应该被映射，并且每个成员的点数组都按描述处理。但是如何用 d3 加速这个两级结构呢？

[在 D3 中绘制多边形数据的正确格式](https://stackoverflow.com/questions/13204562/proper-format-for-drawing-polygon-data-in-d3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:10:45.820

答案很简单直接。只需将多边形数组作为数据传递给 d3 选择。在您的情况下，您似乎正在使用一个多边形数组，这些多边形是复合对象，每个对象都有一个名为“Points”的键。我认为它看起来像这样-

```
var arrayOfPolygons =  [{
    "name": "polygon 1",
    "points":[
      {"x":0.0, "y":25.0},
      {"x":8.5,"y":23.4},
      {"x":13.0,"y":21.0},
      {"x":19.0,"y":15.5}
    ]
  },
  {
    "name": "polygon 2",
    "points":[
      {"x":0.0, "y":50.0},
      {"x":15.5,"y":23.4},
      {"x":18.0,"y":30.0},
      {"x":20.0,"y":16.5}
    ]
  },
  ... etc.
]; 
```

在编写等效的 map 函数时，您只需要使用`d.Points`而不是`d`，它可以写成如下 -

```
vis.selectAll("polygon")
  .data(arrayOfPolygons)
  .enter().append("polygon")
  .attr("points",function(d) { 
    return d.points.map(function(d) { 
      return [scaleX(d.x),scale(d.y)].join(",");
    }).join(" ");
  })
  .attr("stroke","black")
  .attr("stroke-width",2); 
```

您可以检查以下工作[JSFiddle](http://jsfiddle.net/arunkjn/xubZf/)进行验证。

**编辑 - 与上面**相同的示例，用于渲染完整多边形的凸包实现。[http://jsfiddle.net/arunkjn/EpBCH/1/](http://jsfiddle.net/arunkjn/EpBCH/1/)注意多边形#4 的区别

# android - 导入 com.google.android.maps 时出错

> ID：14939326
> 
> 赞同：1
> 
> 时间：2013-02-18T15:06:40.760
> 
> 标签：android

嗨，我正在玩一个 android 地图应用程序教程，但我遇到了很多错误，因为我似乎没有正确导入 com.google.andoid.maps 包，因为 eclipse 给我一个导入错误及其任何错误类。有什么理由让它不应该工作。

```
import com.google.android.maps.*;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.Window;

import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class ShowTheMap extends MapActivity {

    private static double lat;
    private static double lon;
    private int latE6;
    private int lonE6;
    private MapController mapControl;
    private GeoPoint gp;
    private MapView mapView;

    private Button overlayButton, accessButton;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);  // Suppress title bar for more space
        setContentView(R.layout.showthemap);

        // Add map controller with zoom controls
        mapView = (MapView) findViewById(R.id.mv);
        mapView.setSatellite(false);
        mapView.setTraffic(false);
        mapView.setBuiltInZoomControls(true);   // Set android:clickable=true in main.xml

        int maxZoom = mapView.getMaxZoomLevel();
        int initZoom = maxZoom-2;

        mapControl = mapView.getController();
        mapControl.setZoom(initZoom);
        // Convert lat/long in degrees into integers in microdegrees
        latE6 =  (int) (lat*1e6);
        lonE6 = (int) (lon*1e6);
        gp = new GeoPoint(latE6, lonE6);
        mapControl.animateTo(gp);    

        // Button to control food overlay
        overlayButton = (Button)findViewById(R.id.doOverlay);
        overlayButton.setOnClickListener(new OnClickListener(){      
            public void onClick(View v) {   

            }
        });

        // Button to control access overlay
        accessButton = (Button)findViewById(R.id.doAccess);
        accessButton.setOnClickListener(new OnClickListener(){      
            public void onClick(View v) {   

            }
        });

    }

    // Method to insert latitude and longitude in degrees
    public static void putLatLong(double latitude, double longitude){
        lat = latitude;
        lon =longitude;
    }

    // This sets the s key on the phone to toggle between satellite and map view
    // and the t key to toggle between traffic and no traffic view (traffic view
    // relevant only in urban areas where it is reported).

    public boolean onKeyDown(int keyCode, KeyEvent e){
        if(keyCode == KeyEvent.KEYCODE_S){
            mapView.setSatellite(!mapView.isSatellite());
            return true;
        } else if(keyCode == KeyEvent.KEYCODE_T){
            mapView.setTraffic(!mapView.isTraffic());
            mapControl.animateTo(gp);  // To ensure change displays immediately
        }
            return(super.onKeyDown(keyCode, e));
    }

    // Required method since class extends MapActivity
    @Override
    protected boolean isRouteDisplayed() {
            return false;  // Don't display a route
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:12:33.813

您的项目不应基于“Android 4.2”，而是基于平台 4.2 的“Google API”。

这可以在您的项目属性 - Android - 项目构建目标中更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:08:34.600

这听起来可能只是您缺少所需的软件包。确保在 Eclipse 中使用**SDK Manager下载****Google API**。

 **看看这个页面了解一些细节。[https://developers.google.com/android/add-ons/google-apis/installing](https://developers.google.com/android/add-ons/google-apis/installing)

该页面的一个快速片段提到了这类问题

> 选择您要安装的 Google APIs Add-On，​​然后单击 Install Selected。插件会下载到您的计算机并安装在您的 SDK 环境中。
> 
> 当您准备好针对附加组件进行开发时。设置您的应用程序的属性，以便它使用 Google APIs Add-On 作为构建目标。要运行该应用程序，请创建一个使用附加组件作为目标的 Android 虚拟设备。确保选择适合您应用的版本（按 API 级别）。
> 
> 要让您的应用程序访问附加组件中包含的地图库，您需要正确配置您的开发和运行时环境。地图概述文档中描述了执行此操作的过程，您应该接下来阅读该文档。

1.  在 Eclipse 中打开**SDK 管理器**
2.  查找您的 API 版本
3.  **选中Google Inc 的 Google API**复选框
***   点击**安装#个包***   重启 Eclipse**

 **例如

![在此处输入图像描述](../Images/1b4c7f481c9432ba1181833192750def.png)

之后您要引用这些新包，因此您需要更改您的**项目构建目标**

1.  右键单击您的项目
2.  打开**属性**
3.  转到**Android**部分
4.  选中您要查找的 API 版本的**Google API**旁边的框

例如

![在此处输入图像描述](../Images/5cdbc1c5a4ee963134047bea24231f8c.png)****

# text - 合并许多 txt 文件内容并跳过批处理命令文件中的第一行

> ID：14939327
> 
> 赞同：3
> 
> 时间：2013-02-18T15:06:40.697
> 
> 标签：text, batch-file, merge, batch-processing, skip

我想创建一个批处理命令文件来合并扩展名为“.mf”的文本文件但是，每个文件的第一行都包含日期，我不希望在最终输出文件中出现，请建议我如何摆脱日期行从每个文件合并成一个大的txt文件。

我使用以下命令将 txt 文件合并为批处理文件。

```
copy *.mf big.one
ren big.one filename.mf 
```

例子：

```
2013218;
a
b
c
d 
```

-

```
2013218;
u
v
w
x
y
z 
```

输出必须如下所示：

```
2013218;
a
b
c
d
u
v
w
x
y
z 
```

排序无关紧要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T00:11:58.857

```
@echo off
del big.one 2> NUL
for %%f in (*.mf) do (
   if not exist big.one (
      copy "%%f" big.one
   ) else (
      for /F  "usebackq skip=1 delims=" %%a in ("%%f") do (
         echo %%a>> big.one
      )
   )
)
set /P fileDate=< big.one
ren big.one filename_%fileDate:~0,-1%.mf 
```

此解决方案不会保留第二个文件中的空行；如果需要，这可能是固定的。

# asp.net - 在 gridview 的 itemTemplate 中将 autopostback 设置为 true 会减慢数据绑定

> ID：14939334
> 
> 赞同：0
> 
> 时间：2013-02-18T15:07:09.880
> 
> 标签：asp.net, .net, vb.net, gridview, checkbox

我有一个 asp 网格视图。其中一个字段是“ItemTemplate”，我使用内存数据表和 linq 动态绑定它，以根据其他因素过滤它。

如果我留下这样的标记

```
<asp:CheckBox ID="chkSelectSite" runat="server" /> 
```

500 行的数据绑定大约需要 0.5 秒。

如果我添加

```
<asp:CheckBox ID="chkSelectSite" runat="server" AutoPostBack="true" /> 
```

相同的 EXACT 数据绑定大约需要 10/15 秒，而代码没有其他更改。是否有任何原因会发生这种情况或有什么方法可以避免这种情况？我真的需要回发复选框以获取何时为网格中的每一行触发checkedChange。

# java - Java MXBean 自定义类型

> ID：14939335
> 
> 赞同：5
> 
> 时间：2013-02-18T15:07:09.837
> 
> 标签：java, jmx, mbeans

我正在尝试使用自定义属性创建 MXBean，但我得到 javax.management.NotCompliantMBeanException IJmsDestinationMBean.getAttributes 具有无法转换为开放类型的参数或返回类型

我读过 MXBean 属性必须与 OpenType 兼容。我将如何使我的属性以这种方式工作？以下所有类都在同一个包中。

```
class JmsDestinationMBean implements IJmsDestinationMBean{

  protected JmsDestinationAttributes attributes = new JmsDestinationAttributes();

  @Override
  public JmsDestinationAttributes getAttributes() {
    return this.attributes;
  }
}

@MXBean
interface IJmsDestinationMBean {
  JmsDestinationAttributes getAttributes()
}

class JmsDestinationAttributes {

  protected String name
  protected int messagesCurrentCount
  protected int consumersCurrentCount

  String getName() {
    this.name;
  }

  int getMessagesCurrentCount() {
    this.messagesCurrentCount;
  }

  int getConsumersCurrentCount() {
    this.consumersCurrentCount;
  }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-18T16:32:23.230

问题是接口**IJmsDestinationMBean**。它返回一个不是开放类型的**JmsDestinationAttributes类型。**这是我在执行此操作时遵循的经验法则：

*   实际注册的 MBean（具有复杂的类型属性）称为**Foo**，它的管理接口称为**FooMXBean**。
*   复杂类型（**Foo**的属性称为**Bar并有一个称为****BarMBean**的管理接口。这家伙***不能***返回任何不是开放类型或其他正确公开的复杂类型的值。

因此（对于本示例）“主机”MBean 需要是 MXBean 才能支持复杂类型，并且复杂类型需要有一个名为**<ClassName>MBean**的接口。请注意，一个具有 M **X** Bean 接口，另一个具有 MBean 接口。

这是我的例子：

*   **JMSDestination**实现**JMSDestinationMXBean**
*   **JmsDestinationAttributes**实现**JmsDestinationAttributesMBean**

...为松散的案例标准道歉。这是一个即时的例子。

这里是 JMSDestination 代码，**主要**用于创建和注册。我只是使用用户名属性来提供名称。：

```
public class JmsDestination implements JmsDestinationMXBean {
    protected JmsDestinationAttributes attrs = new JmsDestinationAttributes(System.getProperty("user.name"));

    public JmsDestinationAttributes getAttributes() {
        return attrs;
    }

    public static void main(String[] args) {
        JmsDestination impl = new JmsDestination();
        try {
            ManagementFactory.getPlatformMBeanServer().registerMBean(impl, new ObjectName("org.jms.impl.test:name=" + impl.attrs.getName()));
            Thread.currentThread().join();
        } catch (Exception ex) {
            ex.printStackTrace(System.err);
        }
    }
} 
```

JMSDestinationMXBean 代码：

```
public interface JmsDestinationMXBean {
    public JmsDestinationAttributes getAttributes();
} 
```

JmsDestinationAttributes 代码使用相同的名称和随机数作为值：

```
public class JmsDestinationAttributes implements JmsDestinationAttributesMBean {
    protected final String name;
    protected final Random random = new Random(System.currentTimeMillis());
    public JmsDestinationAttributes(String name) {
        this.name = name;
    }
    public String getName() {
        return name;
    }

    public int getMessagesCurrentCount() {
        return Math.abs(random.nextInt(100));
    }

    public int getConsumersCurrentCount() {
        return Math.abs(random.nextInt(10));
    }
} 
```

.... 和 JmsDestinationAttributesMBean：

```
public interface JmsDestinationAttributesMBean {
    public String getName();
    public int getMessagesCurrentCount();
    public int getConsumersCurrentCount();
} 
```

JConsole 视图如下所示：

![MXBean 的 JConsole 视图](../Images/15a5e6417662f3317ae0657b654e0544.png)

MXBean 属性的 JConsole 视图如下所示：

![MXBean 属性的 JConsole 视图](../Images/513939ba714b902fee489e1041955717.png)

有道理 ？

# maven - 在 maven-plugin-testing-harness 中注入 DefaultRepositorySystem 时出错

> ID：14939341
> 
> 赞同：8
> 
> 时间：2013-02-18T15:07:27.597
> 
> 标签：maven, maven-plugin, aether

我正在尝试基于现有 (2.0) 插件创建一个新的 maven (3.0.3) 插件，并促进 aether 拾取一些依赖项。

我尝试使用 maven-plugin-testing-harness（版本 2.0.1）创建一个简单的测试来加载 mojo，但是 lookupMojo 失败并出现 guice 异常：

```
1) Error injecting: org.sonatype.aether.impl.internal.DefaultRepositorySystem
at ClassRealm[plexus.core, parent: null]
at ClassRealm[plexus.core, parent: null]
while locating org.sonatype.aether.RepositorySystem
while locating org.codehaus.griffon.maven.plugin.MvnValidateMojo
at ClassRealm[plexus.core, parent: null]
while locating org.apache.maven.plugin.Mojo annotated with @com.google.inject.name.Named(value=org.codehaus.griffon:griffon-maven-plugin:1.3.0-SNAPSHOT:validate) 
```

这当然是因为我需要在某个时候引用存储库系统，但不是现在：

```
@Component
private RepositorySystem repoSystem; 
```

我已经尝试过（实际上是从 2.1 版开始），但在 AbstractMojoTestCase#setUp() 方法中遇到了问题。

```
org.codehaus.plexus.component.repository.exception.ComponentLookupException: java.util.NoSuchElementException
  role: org.apache.maven.repository.RepositorySystem
roleHint:
    at org.codehaus.plexus.DefaultPlexusContainer.lookup(DefaultPlexusContainer.java:247) 
```

无论哪种方式，不知道我需要包括什么以及在哪里进行类似于食谱的香草魔力负载测试。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-02-07T20:48:20.033

7年后，我遇到了同样的问题。

解决方案是将[maven-compat](https://maven.apache.org/ref/3-LATEST/maven-compat/)工件添加为测试范围依赖项，因为[maven-plugin-testing-harness](https://maven.apache.org/plugin-testing/maven-plugin-testing-harness/)显然仍然依赖于旧的 Maven 2 API。

```
<dependency>
    <groupId>org.apache.maven</groupId>
    <artifactId>maven-compat</artifactId>
    <version>[REQUIRED_MAVEN_VERSION_HERE]</version>
    <scope>test</scope>
</dependency> 
```

感谢用户[smoke](https://stackoverflow.com/users/826765/smoke)在这里的回答[https://stackoverflow.com/a/16707144/5116073](https://stackoverflow.com/a/16707144/5116073)

# ruby-on-rails - 用作参数时`*`的含义（不像*arg，只是*）

> ID：14939344
> 
> 赞同：8
> 
> 时间：2013-02-18T15:07:44.080
> 
> 标签：ruby-on-rails, ruby

当我阅读 Rails 代码时，我发现了这个

```
def save(*)
  create_or_update || raise(RecordNotSaved)
end 
```

做什么的`*`？:O 我知道当我们使用它时会发生什么`*args`，但在这种情况下，它只是简单的`*`。

参考[https://github.com/rails/rails/blob/master/activerecord/lib/active_record/persistence.rb#L119](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/persistence.rb#L119)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-18T15:26:47.613

它的含义与使用参数名称时的含义相同：吞噬所有剩余的参数。除了，因为没有名称可以绑定它们，所以参数是不可访问的。换句话说：它接受任意数量的参数，但忽略它们。

请注意，实际上*有*一种使用参数的方法：当您在`super`没有参数列表的情况下调用时，参数会按原样转发到超类方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:11:12.690

在这种特定情况下， save 不接受任何参数。这就是赤裸裸的啪啪声所发生的事情。但是，您可能知道，在`ActiveRecord`模型上调用 save 接受选项，因为此方法在此处被覆盖`ActiveRecord::Validations`：

[https://github.com/rails/rails/blob/v3.1.3/activerecord/lib/active_record/validations.rb#L47](https://github.com/rails/rails/blob/v3.1.3/activerecord/lib/active_record/validations.rb#L47)

```
# The validation process on save can be skipped by passing <tt>:validate => false</tt>. The regular Base#save method is
# replaced with this when the validations module is mixed in, which it is by default.
def save(options={})
 perform_validations(options) ? super : false
end 
```

# ajax - Primefaces：手风琴面板中的可编辑对象，Dynamic = True

> ID：14939345
> 
> 赞同：0
> 
> 时间：2013-02-18T15:07:48.433
> 
> 标签：ajax, jsf-2, primefaces, accordion

我正在尝试实现根据列表动态生成相应面板中的选项卡的功能。

列表是说一些对象，例如人

现在属性对应于每个人，我在表格的每个选项卡中显示。值已正确加载，但是当我编辑这些值时，我没有在支持 bean 处获得更新的值，我只得到旧值。

有人可以解释为什么吗？

这是代码。

**人物对象**

```
public class Person {

    String name;

    //getter setter

    @Override
    public String toString() {
        return name;
    }
} 
```

**支持豆**

```
@ManagedBean(name = "editor")
public class EditorBean {

    private List<Person> persons = new ArrayList<Person>();

    @PostConstruct
    void init() {
        persons.add(new Person("dhruv"));
        persons.add(new Person("tarun"));
    }

    public void testAction() {
        System.out.println(persons);
    }

    // Getter Setter*****************//
    public List<Person> getPersons() {
        return persons;
    }

    public void setPersons(List<Person> persons) {
        this.persons = persons;
    }
} 
```

XHTML 代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui">

<h:head>
</h:head>
<h:body>
    <h1>Hello World PrimeFaces</h1>

    <h:form>
        <p:accordionPanel value="#{editor.persons}" var="person" dynamic="true">

            <p:tab title="#{person}">
                <p:inputText value="#{person.name}"></p:inputText>
            </p:tab>

        </p:accordionPanel>

        <p:commandButton action="#{editor.testAction()}" value="testAction"></p:commandButton>
    </h:form>

</h:body>
</html> 
```

当我使用 dynamic="false" 运行相同的操作时。这工作正常。但在我的真实场景中，我有很多数据无法一次性绘制，这就是为什么我要使用动态 = true。

如果不是通过 dynamic = true ，有人可以解释如何实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:29:09.720

您的手风琴中有陈旧值的原因是动态手风琴默认为`cache="true"`. 此属性导致手风琴不重新加载新的/更新的值。要在打开选项卡时进行 ajax 刷新，`cache="false"`请在手风琴上设置

# smarty - Smarty 检查是否是数组来修复错误不能使用字符串偏移量作为数组

> ID：14939347
> 
> 赞同：0
> 
> 时间：2013-02-18T15:07:54.330
> 
> 标签：smarty, smarty3

根据我有的面包屑的数量：

```
[trail] => Array
        (
            [crumb] => Array
                (
                    [url] => /app/system
                    [label] => System
                )

[trail] => Array
        (
            [crumb] => Array
                (
                    [0] => Array
                        (
                            [url] => /app/system
                            [label] => Sytem
                        )

                    [1] => Array
                        (
                            [url] => /app/system/edit
                            [label] => System Edit
                        )

                )

        ) 
```

在聪明的我有：

```
{if $trail.crumb}
<ul class="breadcrumbs">
    {foreach $trail.crumb as $crum}
        <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
            <a href="{$crum.url}" itemprop="url" title="{$crum.label}"><span itemprop="title">{$crum.label|truncate:20}</span></a>
        </li>
    {/foreach}
</ul>
{/if} 
```

在第一个示例中，这显示：

> 致命错误：不能将字符串偏移量用作数组

有没有办法在不复制 HTML 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:15:52.617

想通了，没有 smarty3 就无法做到这一点。

```
 {if isset($trail.crumb.0)}
        {assign var="crumbs" value=$trail.crumb}
    {else}
        {assign var="crumbs" value=[$trail.crumb]}
    {/if}
    {foreach $crumbs as $crum} 
```

Smarty 3 很棒，他们修复了 Smarty 2 中缺少的所有内容。

# c++ - 为什么不调用子类方法？

> ID：14939350
> 
> 赞同：11
> 
> 时间：2013-02-18T15:08:01.010
> 
> 标签：c++, class, polymorphism

我对子类化和使用方法有疑问。

我创建了一个类的实例`B`并将其存储为指向`A`. 但是当我使用指针调用重载方法时，输出是“A”而不是“B”。为什么？

这适用于其他语言，我做错了什么？

```
#include <iostream>
using namespace std;

class A {
public:
    void f() {
        cout << "A";
    }
};

class B : public A {
public:
    void f() {
        cout << "B";
    }
};

int main() {
    A *a = new B();
    a->f();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-18T15:10:28.153

`f()`需要`virtual`在基类A中声明：

```
class A {
public:
    virtual void f() {
        cout << "A";
    }
}; 
```

您已经使用过的其他语言可能默认为虚拟方法，但 C++ 没有（不要为您不使用的东西付费：虚拟方法在调用它们时会产生间接性，这意味着它们比普通方法调用稍慢） .

通过添加`virtual`，绑定将被推迟到运行时（称为[动态绑定](http://en.wikipedia.org/wiki/Dynamic_dispatch)），哪个`f()`函数调用将取决于*值的类型*。

因为您没有将函数声明`f()`为虚拟函数，所以绑定是静态的（在编译时），并且将使用*变量的类型*（但不是值）来确定`f()`调用哪个。所以在你现在的代码语句中`a->f();`调用`A`类的`f()`因为`a`是指向类的指针`A`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-18T15:09:29.817

为了实现多态行为，基类的方法必须是`virtual`.

因此，`class A`您需要更改`void f()`为`virtual void f()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T15:20:36.300

该函数必须声明`virtual`为能够覆盖它：

```
#include <iostream>
using namespace std;

class A {
public:
    virtual void f() {// Here you must define the virtual.
        cout << "A";
    }
};

class B : public A {
public:
    virtual void f() { //Here the "virtual" is optional, but a good practice
        cout << "B";
    }
};

int main() {
    A *a = new B();
    a->f();
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-19T21:33:35.400

当没有指向基类的指针但没有指向基类的指针时，您可能会遇到此问题*（不适用于此问题中的示例）*

就我而言，我有一个类`Token`及其子类`Word`：

```
class Token {
   public: virtual string toString() { ... }
}
class Word: public Token {
   public: string toString() { ... }
} 
```

将它们存储在其中`std::map<string, Token>`并从中检索我希望调用`Word::toString()`这样的代码：

```
std::map<string, Token> words;
words.insert("test", Word(...));
words["test"].toString(); 
```

相反，我`Token::toString()`每次都打电话。

**解决方案：**使用这样的指针`std::map<string, Token*>`并将所有实例视为指针（TBH，我已经讨厌指针了）

# excel - 如何在一个Excel工作表中搜索多个值并将其复制到另一个工作表

> ID：14939352
> 
> 赞同：-1
> 
> 时间：2013-02-18T15:08:05.413
> 
> 标签：excel, sqlbulkcopy

再会

我有一个大问题

我有一个在线商店，需要更新产品和价格我有一个包含所有当前在线产品的 Excel 表，并收到了一个新的价目表现在的问题是我处理超过 5000 种产品，我不能一个一个地更新它们

我现在需要的是从一张纸上复制价格并将其移动到另一张纸上对应的 SKU/产品代码的代码

我还有一个需要从当前 Excel 表中删除的 EOL 产品列表所以我需要一个代码来在 EOL 表上找到产品代码/SKU，然后删除另一张表上对应 SKU 的整行

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:21:06.600

假设您的产品具有在所有三个表中都可用的唯一 ID，这应该是一项不需要任何编程的简单任务。

**1\. 更新价格**

你所需要的只是一个`VLOOKUP`公式。我假设您包含所有产品和价格的列表在 A 列中具有产品 ID，在 B 列中具有（旧）价格。我的新价格表具有相同的格式。然后将以下公式放在单元格 B2 中（您当前有旧价格）：

```
=VLOOKUP(A2,[NewPriceFile]Sheet1!$A:$B,2,0)

```

这将为您返回新价格。

**2\. 删除旧产品** 这里我假设您只有一个 EOL 产品 ID 列表。将以下公式放入 C 列：

```
=ISERROR(MATCH(A2,[EOLFile]Sheet1!$A:$A,0))

```

`FALSE`每次在 EOL 列表中找到该产品时，这将返回`TRUE`。

现在您只需对完整列表（*数据*选项卡->*排序和过滤器*->*过滤器*）应用自动过滤器并过滤列 C 为`FALSE`. 选择所有行并删除它们 ( `Ctrl`- `-`)。

以同样的方式，如果找到所有产品，您也可以检查 B 列。如果未找到产品，`#N/A!`则会显示，您可以对其进行过滤。`IFERROR`或者，如果没有找到新价格，您可以将公式与 an 结合使用并使用旧价格：

```
=IFERROR(VLOOKUP(A2,[NewPriceFile]Sheet1!$A:$B,2,0),D2)

```

（这里假设旧价格存储在 D2 中）

# informatica - informatica 中的唯一约束无效错误

> ID：14939353
> 
> 赞同：0
> 
> 时间：2013-02-18T15:08:07.333
> 
> 标签：informatica

我正在使用排序器转换来选择不同的排序输入。

我的映射：源-源限定符-表达式-排序器-目标。

我得到了违反唯一约束的错误。错误代码是 22050。我尝试将错误停止设置为 0。但是，它反映了结果。我的源表中有 654 行。但是，设置上述属性后，它返回 448 行。我知道，此属性用于拒绝无效行。此属性是否仅删除重复项或其他任何内容？它是无效的行。什么是无效行？

# android - 将 ImageView 存储在 ArrayList 和 Stack Android 中

> ID：14939355
> 
> 赞同：0
> 
> 时间：2013-02-18T15:08:13.307
> 
> 标签：android, arraylist, stack, imageview, sharedpreferences

我正在编写一个纸牌游戏应用程序。

我用 表示卡片组`ArrayList<ImageView>`，并且我表示在`Stack<ImageView>`.

如何存储 the`ArrayList<ImageView>`和 the的状态，`Stack<ImageView>`以便从我之前离开的地方继续。我只能想到`SharedPreferences`，它只支持原语和集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:15:52.470

您可能需要考虑为此使用 SQLite 数据库。您的列将是您要存储的对象的属性。如果添加“订单”属性，则可以使用 SQL 逻辑

```
order by `order` DESC 
```

在您的查询结束时让它们以正确的顺序返回。

这是一个指南： [http ://www.androidhive.info/2011/11/android-sqlite-database-tutorial/](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

# java - 如何在Tomcat中启用WebDAV相关方法

> ID：14939363
> 
> 赞同：3
> 
> 时间：2013-02-18T15:08:46.083
> 
> 标签：java, apache, jakarta-ee, tomcat, servlets

如何在 Tomcat 中启用 WebDAV 相关方法：LOCK、UNLO​​CK、PROPFIND 等？我已经安装了一个处理这些方法的 servlet，但是当我尝试连接到它时，服务器返回 501 Not Implemented 错误。

标准 GET、POST 等方法工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:10:55.493

通过更改 web.xml 内容解决：

```
<servlet-mapping>
  <servlet-name>DemoWebDAVServlet</servlet-name> 
  <url-pattern>/dav</url-pattern> 
</servlet-mapping> 
```

必须改为

```
<servlet-mapping>
  <servlet-name>DemoWebDAVServlet</servlet-name> 
  <url-pattern>/dav/*</url-pattern> 
</servlet-mapping> 
```

# css - 大的居中背景图像

> ID：14939364
> 
> 赞同：0
> 
> 时间：2013-02-18T15:08:55.763
> 
> 标签：css, background

我正在构建一个设计为 960 像素的网站，但设计师还要求页面上有一张*全*宽的背景照片。他为此提供了一个 2000 像素的图像。

然而，棘手的是，照片的一部分是页面导航不可或缺的一部分，因此图像需要居中。所以我希望左右边缘溢出视口。我尝试使用 CSS 来做到这一点，但失败了。

当文档加载并调整窗口时，我可以做一个 javascript 版本来根据视口调整左边距，但我预计它可能会表现不佳，特别是在调整时。该网站的许多目标受众都有一些严重的遗留硬件，因此将使用运行 IE6 的慢速计算机。有没有一种好的 CSS 方法可以更好地执行此操作？

更新：对不起，我对“全角”的东西不是很清楚。该网站的内容都被限制在一个 960 像素的列中，*除了*这个特定的图像，它应该是浏览器窗口的全宽，即使它大于 960 像素。使用背景位置是我已经尝试过的方法，但是如果我将特定 div 的大小设置为 2000px 宽，那么我无法将 div 居中，而如果我将其设置为 100% 背景位置：中心似乎不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:18:56.980

您可以这样做的一种方法是`background-position: center top;`，将 2000 像素的图像作为背景放置到 960 像素的 div 中，如下所示：

[演示](http://jsfiddle.net/Bg4Hs/7/)

据我所知，这在 IE6+ 上受支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:26:29.253

只需使用背景定位。

```
body {
    background: url(blah.jpg) center top no-repeat;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-18T15:23:24.097

在图像上尝试这样的事情：

```
position: absolute;
left:50%;
margin-left:-1000px; /* half the width of the image */ 
```

但是，如果图像的一部分将用于导航，并且它具有固定的 2000 像素宽度，我会在你的未来看到很多眼泪。

考虑将图像划分为可以单独操作的层。

编辑：正如迈克尔所说，这种方法不好。

# actionscript-3 - NetConnection.call 方法中的代码错误

> ID：14939365
> 
> 赞同：2
> 
> 时间：2013-02-18T15:09:01.123
> 
> 标签：actionscript-3, flash, client, server-side, flash-media-server

我是 ActionScript 3 的新手。我正在尝试使用该`nc.call()`方法从客户端调用服务器，以查看这是否是用于客户端在聊天应用程序中来回通信的好选择。

我收到一条编译错误消息：

```
1118: Implicit coercion of a value with static type Object to a possibly unrelated type flash.net:Responder. 
```

有人可以帮我解决这个错误吗？

这是我下面的客户端代码：

```
 import flash.net.NetConnection;
 import flash.events.NetStatusEvent;

 var nc:NetConnection = new NetConnection();

 nc.connect("rtmfp:/fms/textchatexample");

 nc.addEventListener(NetStatusEvent.NET_STATUS, netHandler);

 function netHandler(event:NetStatusEvent):void {
     switch(event.info.code) {
         case "NetConnection.Connect.Success":
             trace("Your Connected UP");
             break;
     }
 }

 var test:Object = new Object();
 test.onResult = function(arg) {
     trace(arg);
 };
 nc.call("sendMsg", test, "just, a test call"); ERROR LINE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:32:08.217

尝试将您的`Object`实例替换为`Responder`：

```
var test:Responder = new Responder(
    function(result):void
    {
        trace('ok :', result);
    },
    function(status):void
    {
        trace('status :', status);
    }); 
```

而不是你的`Object`

# java - 如何在java中向后拆分字符串

> ID：14939368
> 
> 赞同：0
> 
> 时间：2013-02-18T15:09:04.713
> 
> 标签：java, split

我有一个要拆分的二进制字符串。字符串是可变长度的，需要分成3段；标签、索引和块偏移量。我有索引的长度和块偏移量，但没有标签，我试图将标签与字符串的其余部分分开。当索引的长度和块偏移量已知时，有没有办法做到这一点？（我想将它们向后拆分，因为标签的长度可变，但索引和块偏移量是恒定的）

* * *

示例（为简单起见以十六进制编写）：

```
String[1]: 400341a0
String[2]: df7c48
index length: 2 hex
block offset length: 3 hex    
Output[0]: {400, 34, 1a0}
Output[1]: {d, f7, c48} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:12:27.703

不确定+-1，但我认为这很好。

```
int length = s.length;
int blockOffsetIndex = length - BLOCK_OFFSET_LENGTH;
blockOffset = s.substring(blockOffsetIndex  - 1, length );

int indexIndex = blockOffsetIndex - INDEX_LENGTH;
indexStr = s.substring(indexIndex - 1, indexIndex + INDEX_LENGHT);

rest = s.substring(0, indexIndex -1); 
```

正如@sdk 建议的那样，[Apache StringUtils](http://commons.apache.org/lang/api/org/apache/commons/lang3/StringUtils.html#substring%28java.lang.String,%20int%29)也是一个非常好的解决方案。

# c# - 在水晶报表中显示两列的乘积之和？

> ID：14939369
> 
> 赞同：0
> 
> 时间：2013-02-18T15:09:06.073
> 
> 标签：c#, dataset, formula, crystal-reports-2010

我有一个水晶报表连接到一个数据集，其中包含 c# 中的三个链接表。

**员工**
EmpID*
EmpName
...Blah blah
**Leave**
LeaveNo*
EmpID
DateTaken
Days
Rate
**Slip**
SlipNo
EmpID
Month-Year

现在我想显示特定月份的 EmpID、EmpName、LeaveDeduction，其中 LeaveDeduction=Days * Rate 用于特定 EmpID
(i)。我应该使用什么来显示 LeaveDeduction 字段？
(二)。如何为特定月份执行此计算？（因为 Leave 表将存储所有月份的记录，但我只想显示一个月）

我是 Crystalreports 的新手，我只在一个教程上运行，并且尝试和错误很多，所以请比你通常做的更多地解释你的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T09:55:18.250

您可以使用水晶报表提供的“公式字段”进行一些计算。在字段探索选项卡中，您可以找到公式字段。在公式字段中，您可以通过给出列名来键入公式。

# java - 任何人都可以告诉我Java中匿名块的范围吗？

> ID：14939375
> 
> 赞同：0
> 
> 时间：2013-02-18T15:09:40.023
> 
> 标签：java

我怀疑 JVM 为匿名块维护了所有外部类全局变量的单独副本。这是真的吗？谢谢你帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:38:48.337

你的意思是匿名类？

如果在非静态上下文中创建匿名类的实例，那么它将包含对创建它的外部类实例的隐式引用。匿名实例将有权访问外部类的私有字段和方法。尽管名称冲突将有利于匿名类的解决。

要访问存在名称冲突的字段和方法，请使用以下语法：

```
OuterClass.this.methodCall(); 
```

例子：

```
public class Outer {

    public static void main(String[] args) {

        Outer o1 = new Outer(1);
        Outer o2 = new Outer(2);

        o1.doSomething();
        o2.doSomething();

    }

    private int i;
    private int j = 10;

    public Outer(int i) {
        this.i = i;
    }

    public void doSomething() {
        new Runnable() {

            private int i = 0;

            public void run() {
                System.out.println("Inner i = " + i);
                System.out.println("Outer i = " + Outer.this.i);
                System.out.println("Outer j = " + j);
            }
        }.run();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:24:23.193

如果对象是可变的，您可以修改匿名内部类之外的对象。但是，您不能重新分配它们，因为它们必须被声明为 final。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:38:42.610

我将您的问题解释为要问：“当匿名块更改在块外声明的变量时，变量会在块结束后保留​​这些更改吗？”

我创建了一个小测试程序来演示结果：

```
public class AnonymousTest {
    private static int i = 0;
    public static void main(String[] args) {
        int j = 0;
        System.out.println("Before anonymous block: i=" + i + " j=" + j);

        //begin anonymous block
        {
            i = 5; j = 5;
            System.out.println("Inside anonymous block: i=" + i + " j=" + j);
        }
        //end anonymous block

        System.out.println("After anonymous block: i=" + i + " j=" + j);
    }
} 
```

输出是：

```
Before anonymous block: i=0 j=0
Inside anonymous block: i=5 j=5
After anonymous block: i=5 j=5 
```

如您所见，在匿名块内修改的任何变量都保持修改状态，因此 JVM 不会为匿名块创建变量的副本。但是，在匿名块内声明的变量仅属于该块，并在块的末尾被销毁。

# sql - 从两个不同的表中按时间戳和名称排序查询

> ID：14939377
> 
> 赞同：2
> 
> 时间：2013-02-18T15:09:42.780
> 
> 标签：sql, sql-server, sql-server-2008r2-express

注意：我对 SQL Server 有点陌生，所以这应该是一个简单的问题，对于格式化这个问题的错误，我深表歉意。

这是 SQL Server 2008 R2。

我有两张桌子。

*   表 1：`DATA`有键`ID`和列`PROD_ID, COLLECT_TS`

*   表2：`PRODUCT`有key`PROD_ID`和column`PROD_NAME`

我希望我的查询`PROD_NAME`按最新列出`COLLECT_TS`

到目前为止，这是我所拥有的：

```
SELECT MAX(COLLECT_TS), PROD_ID
FROM dbo.SG_DATA
GROUP by PROD_ID 
```

这成功地返回了所有最新`COLLECT_TS`的 a `PROD_ID`，但`PROD_ID`只是一个数字，对用户没有任何意义。

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:17:28.350

您需要连接这两个表，然后按 COLLECT_TS 列排序：

```
Select TB2.PROD_NAME , TB1.COLLECT_TS  From [Table_1] as TB1
Join [Table_2] as TB2 on TB1.PROD_ID = TB2.TB1.PROD_ID 
Order by TB1.COLLECT_TS desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:15:29.390

```
Select max(p.prod_name) as prod_name, max(d.collect_ts) as collect_ts
From product p
Join data d -- left join if you want products with no data
    On d.prod_id = p.prod_id
Group by p.prod_id 
```

这个想法是连接产品和数据，因此我们为每个数据条目获取一行，并附加来自产品的额外信息。然后我们按产品 id 分组，并从每个组中获取最大收集 ts。我们也采用最大名称，但这没关系，因为名称在整个组中是不变的，所以我们只需要一些聚合来选择单个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:16:01.490

```
SELECT MAX(COLLECT_TS), MAX(PROD_NAME)
FROM dbo.SG_DATA a
inner join dbo.PRODUCT b on a.prod_id = b.prod_id
GROUP by PROD_ID 
```

# java - 绘制背景使我的应用程序变慢

> ID：14939383
> 
> 赞同：2
> 
> 时间：2013-02-18T15:10:01.470
> 
> 标签：java, android

我正在尝试制作一个非常简单的游戏。用户必须尝试使用​​由他的手指移动的篮子来接住苹果。一切似乎都运行良好，但我有一个问题：我想为应用程序绘制背景。但是使用图像作为背景会使应用程序非常缓慢并导致很多延迟。如果我使用白色背景，我没有问题。

有人可以告诉我我做错了什么吗？

我认为这是因为每次应用更新时我都会绘制背景，但我不知道有什么方法可以改变它。

也许我的代码有点混乱，我还在学习。

谢谢您的帮助！

```
package com.cris9696.mela;

import java.util.Random;

import com.cris9696.mela.R;

import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Rect;
import android.graphics.Typeface;
import android.graphics.Paint.Align;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.View.OnTouchListener;

public class Game extends Activity implements OnTouchListener {

ClasseCanvas View;
float xApple, yApple, xBasket, yBasket;
Bitmap Apple, Basket, BackG;
Random rnd = new Random();
int win = 0, score = 0, level = 1;
int record = 0;
Typeface Font;
Paint TextP = new Paint();
Rect dest;
Paint paint;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Font = Typeface.createFromAsset(getAssets(), "TF2.ttf");
    View = new ClasseCanvas(this);
    View.setOnTouchListener(this);
    TextP.setColor(Color.RED);
    TextP.setTextSize(50);
    TextP.setTypeface(Font);
    xApple = yApple = xBasket = yBasket = 0;
    xApple = rnd.nextInt(600);
    Apple = BitmapFactory.decodeResource(getResources(), R.drawable.apple);
    BackG = BitmapFactory
            .decodeResource(getResources(), R.drawable.bg);
    Basket = BitmapFactory.decodeResource(getResources(),
            R.drawable.basket);

    setContentView(View);

}

// /////////////////////////////////////////////////////////////////////////////

@Override
public boolean onTouch(View v, MotionEvent event) {
    // TODO Auto-generated method stub

    xBasket = event.getX();
    yBasket = event.getY();
    /*
     * switch (event.getAction()) { // ci dice cosa succede
     * 
     * case MotionEvent.ACTION_DOWN:
     * 
     * case MotionEvent.ACTION_UP:
     * 
     * break; }
     */
    return true;
}

// ///////////////////////////////////////////////////////////////////////////

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    View.pause();
}

// /////////////////////////////////////////////////////////////////////////////

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    View.resume();
}

// ///////////////////////////////////////////////////////////

public class ClasseCanvas extends SurfaceView implements Runnable {

    SurfaceHolder Holder;
    Thread thread = null;
    boolean isRunning = true;

    public ClasseCanvas(Context context) {
        super(context);
        Holder = getHolder();

        // TODO Auto-generated constructor stub
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        while (isRunning) {
            if (!Holder.getSurface().isValid())
                continue;

            Canvas canvas = Holder.lockCanvas();

            dest = new Rect(0, 0, getWidth(), getHeight());
            paint = new Paint();
            paint.setFilterBitmap(true);
            canvas.drawBitmap(BackG, null, dest, paint);
            TextP.setColor(Color.RED);
            canvas.drawText(Integer.toString(score), 56, 56, TextP);
            TextP.setColor(Color.BLACK);
            canvas.drawText("Level " + Integer.toString(level), 115,
                    56, TextP);
            if (xBasket != 0 && yBasket != 0) {
                canvas.drawBitmap(Basket, xBasket - Basket.getWidth() / 2,
                        yBasket - Basket.getHeight() / 2, null);
            }
            canvas.drawBitmap(Apple, xApple, yApple, null);
            if (yApple < canvas.getHeight())
                if (score >= 0)
                    yApple += 5 * level;
                else
                    yApple += 5;
            else {
                yApple = 0;
                score--;
                xApple = rnd.nextInt(canvas.getWidth() - Apple.getWidth());
            }
            if (score > record)
                record = score;
            if (score == 10) {
                level++;
                score = 0;
            }
            if ((xApple >= xBasket - (Basket.getWidth() / 2)
                    && xApple + (Apple.getWidth()) <= xBasket
                            + (Basket.getWidth() / 2) && yApple >= yBasket && yApple <= yBasket
                    + Basket.getHeight())
                    || (xApple >= xBasket - (Basket.getWidth() / 2)
                            && xApple <= xBasket + (Basket.getWidth() / 2)
                            && yApple >= yBasket && yApple <= yBasket
                            + Basket.getHeight())
                    || (xApple + (Apple.getWidth()) >= xBasket
                            - (Basket.getWidth() / 2)
                            && xApple + (Apple.getWidth()) <= xBasket
                                    + (Basket.getWidth() / 2)
                            && yApple >= yBasket && yApple <= yBasket
                            + Basket.getHeight())) {
                win = 1;
                xApple = rnd.nextInt(canvas.getWidth());
                yApple = 0;
                score++;
            }

            Holder.unlockCanvasAndPost(canvas);
        }
    }

    public void pause() {
        isRunning = false;
        while (true) {
            try {
                thread.join();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            break;
        }
        thread = null;
        // TODO Auto-generated method stub
    }

    public void resume() {
        // TODO Auto-generated method stub
        isRunning = true;
        thread = new Thread(this);
        thread.start();
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:22:25.600

不要在 SurfaceView 的 onDraw 方法中绘制背景图片。每次surfaceView 更改时，它都会重绘整个位图。

最好的办法是将 SurfaceView 添加到 LinearLayout 中，然后在 onCreate 方法中将 LinearLayout 设置为 ContentView。将linearLayout的背景设置为`R.drawable.bg`这样它只绘制一次。

**编辑**

因此，您的 xml 文件将 SurfaceView 包装在线性布局中并设置线性布局的 bg。问题是您没有在 onCreate 方法中使用此布局。

在您的 XML 中，更改`<SurfaceView`为`<com.cris9696.mela.game.ClasseCanvas`. 然后在您的 onCreate 方法中，您可以执行以下操作：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main); // the XML layout you created.

    View = (ClasseCanvas) findViewById(R.id.View); // the ClasseCanvas view in your XML file.
    View.setOnTouchListener(this);

    Font = Typeface.createFromAsset(getAssets(), "TF2.ttf");

    TextP.setColor(Color.RED);
    TextP.setTextSize(50);
    TextP.setTypeface(Font);

    xApple = yApple = xBasket = yBasket = 0;
    xApple = rnd.nextInt(600);

    Apple = BitmapFactory.decodeResource(getResources(), R.drawable.apple);
    BackG = BitmapFactory.decodeResource(getResources(), R.drawable.bg);
    Basket = BitmapFactory.decodeResource(getResources(),R.drawable.basket);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:18:43.453

似乎您的应用程序是填充率绑定的。您是否尝试过关闭背景的过滤和抗锯齿功能？此外，尝试使用分析器运行应用程序并查找绘图背景。将 CPU 在绘制背景上花费的时间与游戏的其余部分进行比较。如果它太高，则意味着您的设备无法足够快地传输像素，您应该考虑关闭过滤器，至少在绘制背景时。

[维基上的填充率](http://en.wikipedia.org/wiki/Fillrate)

# html - href 覆盖 Angular.js 中的 ng-click

> ID：14939385
> 
> 赞同：120
> 
> 时间：2013-02-18T15:10:12.830
> 
> 标签：html, angularjs, anchor, markup

如果同时定义了 href 和 ng-click 属性：

```
<a href="#" ng-click="logout()">Sign out</a> 
```

该`href`属性优先于 ng-click。

我正在寻找一种方法来提高 ng-click 的优先级。

`href`Twitter Bootstrap 需要，我无法删除它。

* * *

## 回答 #1

> 赞同：246
> 
> 时间：2013-08-26T18:06:02.443

这个来自 Angular 文档站点的示例`href`甚至没有将其分配给空字符串：

```
[<a href ng-click="colors.splice($index, 1)">X</a>] 
```

[http://docs.angularjs.org/api/ng.directive:select](http://docs.angularjs.org/api/ng.directive:select)

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2014-09-18T22:35:00.177

您可以直接在模板中简单地阻止单击事件的默认行为。

```
<a href="#" ng-click="$event.preventDefault();logout()" /> 
```

根据[角度文档](https://docs.angularjs.org/guide/expression#-event-)，

> 像 ngClick 和 ngFocus 这样的指令在该表达式的范围内公开了一个 $event 对象。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2013-04-03T18:07:44.970

这是另一个解决方案：

```
<a href="" ng-click="logout()">Sign out</a> 
```

即只需从 href 属性中删除 #

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2013-02-18T15:18:22.280

如果您不需要 uri，您可能应该只使用按钮标签。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2014-11-18T23:22:04.720

只是多了一个提示。如果您需要真实的 URL（以支持浏览器可访问性），您可以执行以下操作：

模板：

```
<a ng-href="{{link}}" ng-click="$event.preventDefault(); linkClicked(link)">{{link}}</a> 
```

指示：

```
$scope.linkClicked = function(link){
    // your code here
    $location.path(link);
}; 
```

这样，您在 linkClicked() 中的代码将有机会在导航到链接之前执行

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-10-16T15:07:31.027

在 Angular 中，[`<a>`s 是指令](https://docs.angularjs.org/api/ng/directive/a)。因此，如果你有一个空的`href`或没有的`href`，Angular 会调用`event.preventDefault`.

从[来源](https://github.com/angular/angular.js/blob/master/src/ng/directive/a.js#L3)：

```
 element.on('click', function(event){
      // if we have no href url, then don't navigate anywhere.
      if (!element.attr(href)) {
        event.preventDefault();
      }
    }); 
```

这是一个演示缺失场景的[plnkr 。](http://plnkr.co/svnjb7UAMETe5mf2iWiU?p=preview)`href`

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2014-09-24T20:25:24.013

这在 IE 9 和 AngularJS v1.0.7 中对我有用：

```
<a href="javascript:void(0)" ng-click="logout()">Logout</a> 
```

感谢[鸭蛋](https://stackoverflow.com/questions/14939385/href-overrides-ng-click-in-angular-js#comment28887838_15794760)对工作解决方案的评论！

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-12-19T17:01:47.413

这个问题有很多答案，但似乎对这里实际发生的事情有些困惑。

首先，你的前提

> *“href 覆盖 Angular.js 中的 ng-click”*

是错的。实际发生的是，单击后，单击事件首先由 angular 处理（由`ng-click`angular 1.x 和`click`angular 2.x+ 中的指令定义），然后继续传播（最终触发浏览器导航到使用`href`属性定义的 url ）。（有关javascript 中事件传播的更多信息，请参阅[此内容）](https://javascript.info/bubbling-and-capturing)

如果你想避免这种情况，那么你应该使用[Event 接口的`preventDefault()`方法](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)取消事件传播：

```
<a href="#" ng-click="$event.preventDefault();logout()" /> 
```

（这是纯 JavaScript 功能，与 Angular 无关）

现在，这已经解决了您的问题，但这不是最佳解决方案。Angular 理所当然地促进了[MVC 模式](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。使用此解决方案，您的 html 模板将与 javascript 逻辑混合。您应该尽量避免这种情况，并将您的逻辑放入角度控制器中。所以更好的方法是

```
<a href="#" ng-click="logout($event)" /> 
```

在您的 logout() 方法中：

```
logout($event) {
   $event.preventDefault();
   ...
} 
```

现在点击事件不会到达浏览器，所以它不会尝试加载`href`. （但要注意，如果用户右键点击链接，直接打开链接，那么根本不会有点击事件，而是直接加载`href`属性指向的url。）

关于浏览器中访问链接颜色的评论。同样，这与角度无关，如果`href="..."`默认情况下您指向浏览器访问的 url，则链接颜色会有所不同。这由[CSS :visited Selector](https://www.w3schools.com/cssref/sel_visited.asp)控制，您可以修改您的 CSS 以覆盖此行为：

```
a {
   color:pink;
} 
```

**PS1**：

一些答案建议使用：

```
<a href .../> 
```

`href`是一个角度指令。当您的模板由角度处理时，这将转换为

```
<a href="" .../> 
```

这两种方式本质上是一样的。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-03-08T09:20:48.993

只需在 href 之前写 ng-click ..它对我有用

```
<!DOCTYPE html>
<html>

  <head>
    <script data-require="angular.js@1.5.0" data-semver="1.5.0" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.js"></script>
    <script>
    angular.module("module",[])
.controller("controller",function($scope){

  $scope.func =function(){
    console.log("d");
  }

})</script>
  </head>

  <body ng-app="module" ng-controller="controller">
    <h1>Hello ..</h1>
    <a ng-click="func()" href="someplace.html">Take me there</a>
  </body>

</html>
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-02-11T19:22:45.623

我认为您不需要从 href 中删除“#”。以下适用于 Angularjs 1.2.10

```
<a href="#/" ng-click="logout()">Logout</a> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-04-27T10:26:52.387

你也可以试试这个：

```
<div ng-init="myVar = 'www.thesoftdesign'">
        <h1>Tutorials</h1>
        <p>Go to <a ng-href="{{myVar}}">{{myVar}}</a> to learn!</p>
</div> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-17T14:22:29.740

我将为您添加一个对我有用的示例，您可以根据需要更改它。

我在我的控制器中添加了波纹管代码。

```
 $scope.showNumberFct = function(){
        alert("Work!!!!");
     } 
```

对于我的视图页面，我添加了以下代码。

```
<a  href="" ng-model="showNumber" ng-click="showNumberFct()" ng-init="showNumber = false" >Click Me!!!</a> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-14T10:13:49.937

您是否尝试在注销功能本身内部进行重定向？例如说你的注销功能如下

```
$scope.logout = function()
{
  $scope.userSession = undefined;
  window.location = "http://www.yoursite.com/#"
} 
```

然后你可以有

```
<a ng-click="logout()">Sign out</a> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-27T15:16:49.913

请检查这个

```
<a href="#" ng-click="logout(event)">Logout</a>

 $scope.logout = function(event)

 {
event.preventDefault();
alert("working..");
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-01-31T10:26:22.160

```
//for dynamic elements - if you want it in ng-repeat do below code

angular.forEach($scope.data, function(value, key) {
     //add new value to object
    value.new_url  = "your url";
});

 <div ng-repeat="row in data"><a ng-href="{{ row.url_content }}"></a></div> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-07T05:14:10.587

这对我有用

```
<a href (click)="logout()">
   <i class="icon-power-off"></i>
   Logout
</a> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-06-10T06:54:11.333

```
 <a href="#">
       <span ng-click="logout()"> Sign out </span>
 </a> 
```

我确实喜欢这个，它对我有用。

# java - 如何通过反射实现抽象类

> ID：14939387
> 
> 赞同：2
> 
> 时间：2013-02-18T15:10:20.553
> 
> 标签：java, reflection

我有一个私人抽象类作为听众。我只能通过反射访问它。我如何实现该类？

```
public class A {

    private abstract class OnWorkListener {
        public abstract void onWork(int param);
    }

    private OnWorkListener mListener;

    public A(OnWorkListener listener) {
        mListener = listener;
    }

    public void work() {
        // some working
        if(mListener != null) {
            mListener.onWork(0);
        }
    }
}

public class B {

    private static final String TAG = B.class.getSimpleName();

    public B() {
                //How to overwrite it?
        WorkListener listener = new WorkListener() {
            public void onWork(int what) {
                Log.d(TAG, "onWork "+what);
            }
        };
        A a = new A(listener);
        a.work();
    }
} 
```

问题是我无法创建抽象类的实例。我需要先实现它。但我找不到答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:14:15.550

没有办法用反射来实现类或接口——在某种意义上，反射是“只读的”，让你检查和操作已经存在的东西。

您需要发出 Java 代码才能在运行时构建实现。有几个选项可供选择 - 查看[这个答案](https://stackoverflow.com/q/2259323/335858)以获得一些非常好的参考资料。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:29:09.647

实际上有两个错误： - A.WorkListener 在 B 中不可见（因为它是私有的） - A.WorkListener 需要 A 的“封闭实例”（因为它不是静态的）

由于 A 的构造函数是公共的，因此将 WorkListener 声明为公共也是有意义的。（但如果 A 和 B 在同一个包中，包可见性也可以工作）。

公共类 A {

```
 public abstract class WorkListener {
        public abstract void onWork(int param);
    }
...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:33:53.257

您正在尝试在 B 类中实现位于 A 类中的**私有**类。B 类无论如何都看不到该类，这就像试图从类外部访问私有属性一样。

如果您的问题涉及实现以及为什么 B 看不到它，只需重构类 A 并执行“将内部级别移动到外部级别”，这意味着使您的私有类成为像 A 或 B 一样的类。另一种选择是将其公开。

# python - 检索特定用户集的订阅数和订阅者数

> ID：14939388
> 
> 赞同：3
> 
> 时间：2013-02-18T15:10:25.607
> 
> 标签：python, youtube-api

我正在尝试检索特定用户集的订阅数和订阅者数。我正在使用适用于 Python 的 YouTube API。

我为订阅数量编写了以下代码。此代码从列表中逐一读取用户的 ID，计算其订阅数并将 ID 和数字写入 CSV 文件。但它不能正常工作。在少数第一个用户之后，它停止在文件中写入数字，无论如何数字并不都是正确的。我认为应该有比这个烂摊子更简单的东西。

谢谢，感谢您的建议和意见。

```
import os
import gdata.youtube
import gdata.youtube.service
import time

def GetUserUrl (username):

    yt_service = gdata.youtube.service.YouTubeService()
    uri = 'https://gdata.youtube.com/feeds/api/users/%s/subscriptions?max-results=50&start-index=1' % username
    subscription_feed = yt_service.GetYouTubeSubscriptionFeed(uri)
    T1 = GetUserSub(subscription_feed)
    final = 0
    j = 1
    total = 0
    while j<800:
      j = j + 50
      sj = str(j)
      uri = 'https://gdata.youtube.com/feeds/api/users/%s/subscriptions?max-results=50&start-index=' % username+sj
      subscription_feed = yt_service.GetYouTubeSubscriptionFeed(uri)
      T2 = GetUserSub(subscription_feed)
      total = total + T2

    final = total + T1
    usersub.writelines([str(username),',',str(final),'\n'])

def GetUserSub (subscription_feed):

  i = 0
  for entry in subscription_feed.entry:
    i = i +1
  return i

usersub = open ('usersubscribtions.csv','w')
users=[]
userlist = open("user_ids_noduplicates1.txt","r")
text1 = userlist.readlines()

for l in text1:
        users.append(l.strip().split()[0])
x = 0
while (x<len(users)):

 try:
    GetUserUrl(users[x])
    time.sleep(0.4)
    x = x+1
 except:
    usersub.writelines([str(users[x]),'\n'])
    x = x+1
    pass

usersub.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T07:54:02.840

如果您只是想获取订阅者总数，则无需计算提要中的项目 - 它是数据 API v3 中提供的值。

您只需使用您正在查找的用户的 channelId 调用 Channels 资源： [https://www.googleapis.com/youtube/v3/channels?part=statistics&id=UCDsO-0Yo5zpJk575nKXgMVA&key={YOUR_API_KEY}](https://www.googleapis.com/youtube/v3/channels?part=statistics&id=UCDsO-0Yo5zpJk575nKXgMVA&key=%7BYOUR_API_KEY%7D)

回复：

```
{
 "kind": "youtube#channelListResponse",
 "etag": "\"O7gZuruiUnq-GRpzm3HckV3Vx7o/wC5OTbvm5Z2-sKAqmTfH4YDQ-Gw\"",
 "pageInfo": {
  "totalResults": 1,
  "resultsPerPage": 1
 },
 "items": [
  {
   "id": "UCDsO-0Yo5zpJk575nKXgMVA",
   "kind": "youtube#channel",
   "etag": "\"O7gZuruiUnq-GRpzm3HckV3Vx7o/xRjATA5YtH9wRO8Uq6Vq4D45vfQ\"",
   "statistics": {
    "viewCount": "80667849",
    "commentCount": "122605",
    "subscriberCount": "4716360",
    "videoCount": "163"
   }
  }
 ]
} 
```

如您所见，subscriberCount 包含在响应中。

# asp.net - 绑定后使中继器中的特定标签可见

> ID：14939392
> 
> 赞同：1
> 
> 时间：2013-02-18T15:10:34.103
> 
> 标签：asp.net, repeater

我试图在绑定后使中继器中的特定标签可见。我不希望转发器中每个项目的所有标签都可见。只是我单击按钮的那个。当我单击按钮更新时，我正在更新我的数据库中的锦标赛项目的信息，然后我想显示一个标签来说明更改是成功的，但仅适用于我更新的项目。

这是后面的代码。[...] 是我在数据库中进行更新的地方

```
protected void repeatTourney_ItemCommand(object source, RepeaterCommandEventArgs e)  
           {  
               if (e.CommandName == "btnUpdate_Click")  
               {  
                   [...]
                   Label lblSuccess= (Label)e.Item.FindControl("lblUpdateSuccess");
                    bindRepeater(ddlEvents.Text);
                    lblSuccess.Visible = true;
               }
           } 
```

这是aspx。[...] 是包含我的数据库项目信息的文本框和其他内容。

```
<asp:Repeater ID="repeatTourney" runat="server" OnItemDataBound="repeatTourney_ItemDataBound"
                    OnItemCommand="repeatTourney_ItemCommand">
    <ItemTemplate>
        <div class="form">
           [...]
            <asp:Label ID="lblUpdateSuccess" runat="server" Text="Update success" Visible="false" />
            <asp:Button ID="btnUpdate" runat="server" Text="Update" CssClass="button" CommandName="btnUpdate_Click" />
            [...]
        </div>
     </ItemTemplate>
 </asp:Repeater> 
```

最后它应该看起来像这样

```
Item
 Info
 BtnUpdate
 lblSuccess.Visible = false

Item
 Info
 BtnUpdate <== Clicked
 lblSuccess.Visible = true 
```

感谢您提供的任何帮助。

编辑：这是我的 bindRepeater 代码

```
 private void bindRepeater(string name)
        {
            List<Tourney> list = TourneyDAL.GetByNameEvent(name);
            [...]
            repeatTournois.DataSource = list;
            repeatTournois.DataBind();
            [...]
        } 
```

编辑 2：感谢您提供一个 ID 来告诉绑定后哪个需要可见的想法。

工作得很好。:)

这是我的新代码

```
private void bindRepeater(string name, int index)
    {
        List<Tourney> list = TourneyDAL.GetByNameEvent(name);
        [...]
        repeatTourney.DataSource = list;
        repeatTourney.DataBind();
        [...]
        if (index != 0)
        {
            Label lblReussie = (Label)repeatTourney.Items[index].FindControl("lblUpdateSuccess");
            lblSuccess.Visible = true;
        }

protected void repeatTourney_ItemCommand(object source, RepeaterCommandEventArgs e)  
       {  
           if (e.CommandName == "btnUpdate_Click")  
           {  
               [...]
               Label lblSuccess= (Label)e.Item.FindControl("lblUpdateSuccess");
                bindRepeater(ddlEvenements.Text, e.Item.ItemIndex);
                lblSuccess.Visible = true;
           }
       }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:18:52.287

你还没说怎么回事，你有例外吗？

您可以使用`ItemDataBound`设置可见性。但是因此您必须存储您上次更新的索引/ID，例如在一个字段中：

```
protected void repeatTourney_ItemCommand(object source, RepeaterCommandEventArgs e)  
{  
    if (e.CommandName == "btnUpdate_Click")  
    {  
        updatedID = int.Parse(e.CommandArgument.ToString());
        bindRepeater(ddlEvents.Text);
    }
}

private int? updatedID = null;

protected void repeatTourney_ItemDataBound(Object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        var tourney = (Tourney) e.Item.DataItem;
        Label lblUpdateSuccess = (Label)e.Item.FindControl("lblUpdateSuccess");
        lblUpdateSuccess.Visible = updatedID.HasValue && tourney.Id == updatedID.Value;
    }
} 
```

# java - Gson 是否搞乱了时间戳变量

> ID：14939395
> 
> 赞同：5
> 
> 时间：2013-02-18T15:10:41.753
> 
> 标签：java, timestamp, gson

我正在尝试通过套接字发送一个类，这一切都很好。然而，其中一个变量无缘无故地被弄乱了。让我进一步解释一下。

我正在使用的代码如下（对于创建 GSon 的客户端套接字）：

```
while(!someQueueVariable.isEmpty()){
     QueryHolder h = this.someQueueVariable.poll();
     Gson g = new Gson();
     String send = g.toJson(h);
     out.println(send);
} 
```

QueryHolder 是一个简单的类，它包含两个`Strings`和一个`Object[]`.

我尝试了 Netbeans 的内置调试器，并且出现了这些变量： ![变量](../Images/96ae810f26b7242d9a4bf9bfa807828f.png) 以蓝色突出显示的变量是您应该查看的变量。如您所见，首先有一个值为 的 Timestamp 对象`2013-02-18 15:49:36.415`，它变成了`Feb 18, 2013 3:49:36PM`。我在这里做错了吗？这是GSon中的错误吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-18T18:37:13.117

[Gson 用户指南](https://sites.google.com/site/gson/gson-user-guide)在讨论创建自定义序列化器/反序列化器时提到了这一点。您所看到的是您的`java.sql.Timestamp`对象（它是 的子类`Date`）的默认序列化，它以您的语言环境的格式输出/格式化它。

如果您查看[GsonBuilder() 的 Javadoc，](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/GsonBuilder.html)您会发现`setDateFormat()`专门为您的问题创建的方法 - 它不再需要自定义序列化程序。您只需要在 JSON 中提供所需的模式：

```
public static void main(String[] args)
{
    Timestamp t = new Timestamp(System.currentTimeMillis());
    System.out.println(t);
    System.out.println(t.toLocaleString());
    String json = new Gson().toJson(t);
    System.out.println(json);
    json = new GsonBuilder()
               .setDateFormat("yyyy-MM-dd hh:mm:ss.S")
               .create()
               .toJson(t);

    System.out.println(json);
} 
```

输出（显然，截至目前）：

> 2013-02-18 11:32:21.825
> 2013 年 2 月 18 日上午 11:32:21
> “2013 年 2 月 18 日上午 11:32:21”
> “2013-02-18 11:32:21.825”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:12:13.993

> 2013-02-18 15:49:36.415，变成了2013年2月18日下午3:49:36

这些有什么不同呢？这看起来像是一个渲染问题，您的时间戳正在通过[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)或类似的方式转换为字符串。

# c# - 将一个类的所有对象放在一个列表中

> ID：14939397
> 
> 赞同：0
> 
> 时间：2013-02-18T15:10:50.227
> 
> 标签：c#, list

我在 c# 中有一个名为 C 的类。当我执行程序时，我创建了这个类的新对象。在某些时候，我需要创建一个列表来`List<C> listC = new List();`放置我创建的所有对象。当然，我可以在创建此对象后使用 list.Add 为每个对象执行此操作。但是由于某些难以解释的原因，我宁愿只将 thiiss 类创建的所有对象添加到列表中。

这有可能吗？我不确定是否有解决方案:-)。

提前感谢所有回答的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:17:07.140

您需要的是[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)。您使用一个类来构建您的类并跟踪构建的内容。

```
public class CFactory
{
    public CFactory()
    {
        CreatedCBacking = new List<C>();
    }

    private List<C> CreatedCBacking;

    public IList<C> CreatedC
    {
        get
        {
             return CreatedCBacking.AsReadonly();
        }
    }

    public C NewC(String s, string t, bool b)
    {
       C temp = new C(s, t, b);
       CreatedCBacking.Add(temp);
       return temp;
    }

}

public class C
{
     public C(String s, string t, bool b)
     {
         //You class here
     }
} 
```

你使用它的方式是这样的

```
public static void Main()
{
    var factory = new CFactory();
    var c1 = factory.NewC("string", "string", true);
    var c2 = factory.NewC("string2", "string2", false);

    foreach(var c in factory.CreatedC)
    {
        //loops over c1 and c2
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:13:14.847

您可以在创建对象时直接添加到列表中，例如：

```
List<C> list = new List<C>();

for(var i = 0; i < 10; i++) {
    list.Add(new C());
} 
```

或者你可以将列表传递给类并让它自己添加：

```
List<C> list = new List<C>();

public class C
{

    public C(List<C> list)
    {
        list.Add(this);
    }

} 
```

如果您将其设为静态，您可以在不通过列表的情况下逃脱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:15:46.937

解决该问题的方法可能是这样的：
不可能“找到”特定类型的所有对象，您可以做的是从一开始就构建和维护这个列表。你可以通过创建一个“工厂”方法来创建一个新`c`对象，将它添加到语音列表中，并返回它的引用。“工厂”函数和列表可以（也许应该）是单例，取决于你将如何使用它。

# google-fusion-tables - 带有侧边栏地图的融合表条件标记样式

> ID：14939398
> 
> 赞同：0
> 
> 时间：2013-02-18T15:10:51.163
> 
> 标签：google-fusion-tables

我已经拼凑了一个脚本，该脚本显示带有侧边栏的融合地图：

```
 <script type="text/javascript">
  google.load('visualization', '1', {'packages':['table']});
  var map;
  var markers = [];
  var infoWindow = new google.maps.InfoWindow();

  function initialize() {
    var us = new google.maps.LatLng(38.24676420846342, -94.82073772499997);

    map = new google.maps.Map(document.getElementById('map_canvas'), {
     center: us,
     zoom: 4,
     mapTypeId: google.maps.MapTypeId.ROADMAP
   });

//info window to contain link to map marker Sales Region, rep name, rep contact and contact email 
//sidebar contains rep name and rep contact
    var sql = encodeURIComponent("SELECT 'State - Sales Region', 'Representative Name', 'Representative Contact', 'Contact Email', Lat, Lon FROM 555 ORDER BY 'State - Sales Region'");
    var query = new google.visualization.Query('http://www.google.com/fusiontables/gvizdata?tq=' + sql);

    query.send(getData);
  }

  function getData(response) {
    var dt = response.getDataTable();  

    var side_html = '<table style="border-collapse: collapse" border="1" \
                       cellpadding="5"> \
                       <thead> \
                         <tr style="background-color:#e0e0e0"> \
                           <th>Area</th> \
                           <th>Name</th> \
                         </tr> \
                       </thead> \
                       <tbody>';

    for (var i = 0; i < dt.getNumberOfRows(); i++) {
      var lat = dt.getValue(i,4);
      var lng = dt.getValue(i,5);
      var area = dt.getValue(i,0);
      var name = dt.getValue(i,2);
      var company = dt.getValue(i,1);
      var contact = dt.getValue(i,3);
      var pt = new google.maps.LatLng(lat, lng);
      var html = "<strong>" + area + "</strong><br />" + company + "<br />" + name + "<br /><a href='mailto:" + contact + "'>" + contact + "</a>";

      side_html += '<tr> \
                      <td><a href="javascript:myclick(' + i + ')">' + area + '</a></td> \
                      <td>' + name + '</td> \
                    </tr>';

      createMarker(pt, html);

    }

    side_html += '</tbody> \
                </table>';
    document.getElementById("side_bar").innerHTML = side_html;
  }

//use simple default marker
function createMarker(point,info) {  
  var marker = new google.maps.Marker({
      position: point,
      map: map
     });
    }
    markers.push(marker);

    google.maps.event.addListener(marker, 'click', function() {
      infoWindow.close();
      infoWindow.setContent(info);
      infoWindow.open(map,marker); 
    });

    google.maps.event.addListener(marker, 'onChange', function() {
      infoWindow.close();
      infoWindow.setContent(info);
      infoWindow.open(map,marker); 
    });
  }

  function myclick(num) {
    google.maps.event.trigger(markers[num], "click");
    map.setCenter(markers[num].getPosition());
  }
  </script> 
```

现在，我想在标记显示中添加一个条件。条件与下表中的联系人姓名匹配。我被困在哪里可以改变标记样式的条件。谢谢！

```
var image = "./beachflag_with_shadow.png";
if(contact == "Joe Smith"){
var marker = new google.maps.Marker({
      position: point,
      icon: image,
      map: map
     });     
} else {
  var marker = new google.maps.Marker({
      position: point,
      map: map
     });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:32:52.323

我以为我以前试过这个，但现在它工作得很好：

只需将变量传递给 createMarker 函数：

```
createMarker(pt, html, contact);

    }

    side_html += '</tbody> \
                </table>';
    document.getElementById("side_bar").innerHTML = side_html;
  }

//use simple default marker
function createMarker(point,info,contact) {  
var image = "./beachflag_with_shadow.png";
if(contact == "Joe Smith"){
var marker = new google.maps.Marker({
      position: point,
      icon: image,
      map: map
     });     
} else {
  var marker = new google.maps.Marker({
      position: point,
      map: map
     });
    } 
```

# ruby-on-rails-3 - 在 Rails 中覆盖 ActiveRecord 构造函数“未定义的方法‘stringify_keys’”错误

> ID：14939401
> 
> 赞同：2
> 
> 时间：2013-02-18T15:11:02.963
> 
> 标签：ruby-on-rails-3, activerecord

我正在尝试覆盖 ActiveRecord 对象的构造函数。我想选择在构造时传入参数，像这样

```
token = LinkedinToken.new("these_permissions") 
```

但我收到错误消息

```
NoMethodError: undefined method `stringify_keys' for "these_permissions":String 
```

这是我的课

```
class LinkedinToken < ActiveRecord::Base
  attr_accessible :permissions,
              :access_token,
              :access_secret,
              :last_updated

  belongs_to :linkedin_info

  def initialize(perms = nil)
    super
    permissions = perms
  end
end 
```

注意：如果我删除构造函数中的第二行，我会得到同样的错误。

有任何想法吗？

# mongodb - 如何检查 MongoDB 是否仍在索引？

> ID：14939405
> 
> 赞同：1
> 
> 时间：2013-02-18T15:11:11.507
> 
> 标签：mongodb, indexing

刚刚插入了一些数据，并使用脚本告诉 MongoDB 索引数据，但是是否有 Mongo shell 命令可以检查索引是否完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T15:39:48.737

在 shell 中运行`db.currentOp()`以查看您的索引操作是否仍在进行中。

[在此处](http://docs.mongodb.org/manual/administration/indexes/#monitor-and-control-index-building)的文档中查看更多信息。

# ssl - Glassfish 管理控制台加载空白页

> ID：14939407
> 
> 赞同：5
> 
> 时间：2013-02-18T15:11:18.293
> 
> 标签：ssl, console, glassfish, admin

我在不同服务器上的四个相同（至少理论上）配置的域之一上登录 Glassfish 3.1.2 的管理控制台时遇到问题。当我登录不起作用的那个时，我被重定向到一个空白页面：

https://{服务器}:{管理端口}/j_security_check

它伴随着这条日志消息：

```
[#|2013-02-18T09:58:02.912-0500|SEVERE|glassfish3.1.2|org.glassfish.admingui|_ThreadID=20;_ThreadName=Thread-2;|javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path validation failed: java.security.cert.CertPathValidatorException: signature check failed; javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path validation failed: java.security.cert.CertPathValidatorException: signature check failed; restRequest: endpoint=https://localhost:9048/management/domain/anonymous-user-enabled attrs={} method=GET|#] 
```

其他信息：

我启用了安全管理，并且禁用了匿名用户。

我可以使用相同的用户/密码请求 https://{server}:{admin port}/management/domain 并成功启动 REST 接口。请求 /management/domain/enable-anonymous-user 确实会触发相同的问题（空白页面，记录错误）。

我可以使用相同的用户/密码运行“asadmin -p {admin port}”并成功运行命令行命令。

我似乎记得有一次跟踪到管理控制台试图从 sun.com 域上的服务器中提取文件，SSL 证书已过期，但我似乎找不到我应用的解决方案当时。

我尝试使用其中一台正在运行的服务器中的 cacerts.jks 文件，但没有帮助。

我在 keystore.jks 中的 s1as 证书的到期日期仍然是 8 年。

服务器上的日期/时间设置正确。

感谢您的任何建议。

史蒂夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-05T16:57:19.983

当我启用“默认主体到角色映射”时，我遇到了这种情况：

![默认主体到角色映射](../Images/4f48c48996525cc6abe2419fc4a2ffa6.png)

启用此功能并重新启动域后，我将永远无法再次登录。我不得不更改 domain.xml 上的以下行（域已停止）：

```
<security-service default-principal-password="admin" activate-default-principal-to-role-mapping="true" default-principal="admin"> 
```

对此：

```
<security-service> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-20T14:00:21.303

这可能是[此错误报告](https://java.net/jira/browse/GLASSFISH-16137)中描述的问题。

Anissa Lam 在 2011 年 3 月 3 日写道：

```
In v2, you enable https by just simply enable security on the admin-listener.
In v3, you have to run the enable-secure-admin command, and then restart the server. Then you can access the console by https, and http will also be redirected to https.
%asadmin start-domain 
%asadmin enable-secure-admin
%asadmin stop-domain 
%asadmin start-domain
then launch GUI.
Please do the above and if you still have problem, reopen the bug. thanks 
```

这是对我造成的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-16T09:51:22.703

嗨，如果您从未找到解决此问题的方法。我可以通过在我的应用程序中启用默认主体到角色映射设置来解决这个问题，方法是将以下几行添加到您的 WEB-INF 文件夹中的 glassfish-web.xml 文件中。

```
 <security-role-mapping>
    <role-name>roleName</role-name>
    <group-name>groupName</group-name>
  </security-role-mapping> 
```

您可以根据应用程序中的内容相应地修改角色名称和组名称。在撰写此答案时，该错误仍然存​​在于所有 glassfish 版本中。但我所做的一项观察是，它没有出现在与 netbeans IDE 捆绑的 glassfish 服务器中。

# xpages - 全局从 XPage 中删除 Dojo

> ID：14939408
> 
> 赞同：2
> 
> 时间：2013-02-18T15:11:23.537
> 
> 标签：xpages

在[http://www.dominoguru.com/pages/11182010085538.html](http://www.dominoguru.com/pages/11182010085538.html)和[http://dpastov.blogspot.dk/2011/01/trying-to-get-full-control-over-xpage.html](http://dpastov.blogspot.dk/2011/01/trying-to-get-full-control-over-xpage.html)它被解释为设置

`xsp.client.script.libraries=none`

在 xsp.properties 文件中。

我这样做了，但后来出现以下错误

[http://pastebin.com/9qiUVPri](http://pastebin.com/9qiUVPri)

它在 Domino 8.5.3FP2 上运行

出于什么原因有任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T15:34:59.987

您还需要禁用资源聚合：

```
xsp.resources.aggregate=false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:35:45.510

我有一个解决方案。首先是 xsp.properties 中的这个设置

```
xsp.resources.aggregate=true 
```

如果设置为 false，那么也可以使用

```
xsp.client.script.libraries=none 
```

页面上不再出现错误。html 现在看起来像这样

```
<!DOCTYPE html>
<html lang="de">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
</head>
<body>
<span id="view:label1">Test</span></body>
</html> 
```

# mediaelement.js - Mediaelements.js：覆盖特征属性

> ID：14939414
> 
> 赞同：0
> 
> 时间：2013-02-18T15:11:46.307
> 
> 标签：mediaelement.js

我需要覆盖 mediaelements.js 组件的“功能”属性。场景是这样的： - 以小控制（仅音量）开始第一个宣传视频 - 当视频结束时，内容视频开始并且必须显示更多控制。

这是代码：

```
<video width="640" height="360" src="promo.mp4" type="video/mp4"  
id="player1" poster="../media/echo-hereweare.jpg" 
controls="controls" preload="true"></video>

<script>

$(function () {
   promoVideo();
});

function promoVideo() {

 $("#player1").mediaelementplayer({

    features: ['volume'],       
    success: function(player, node) {

        // add event listener
        player.addEventListener('ended', function(e) {
            contentVideo(e.target);         

        }, false);
    }
 });
}   

function contentVideo(player) {

 var contentVideoSrc = "content.mp4";

 player.features = ['playpause','progress','fullscreen','current','duration'];

 player.pause();
 player.setSrc(contentVideoSrc);
 player.play();     
}       

</script> 
```

使用此代码，促销视频开始并且只有音量控制。结束后，正确启动内容视频，但“功能”属性中设置的其他控件不出现。我还必须以这种方式添加功能：

```
$("#player1").mediaelementplayer({              
    features: ['playpause','progress','fullscreen','current','duration']
}); 
```

和这个：

```
var player = new MediaElementPlayer(
    "#player1"
    ,
    {           
        features: ['playpause','progress','fullscreen','current','duration']            
    }
); 
```

但无论如何都行不通。有什么建议吗？

谢谢！朱塞佩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:17:25.883

One quick solution is this:

*You have 2 videos in your page*. The first one immediately plays the promo video. The latter is hidden and will play the content video when the former ends playing. When the promo video ends playing, you create another mediaelement that is now related to the second video, you destroy the first mediaelement and eventually show the second video playing.

```
<video width="640" height="360" src="promo.mp4" type="video/mp4"  
id="player1" poster="../media/echo-hereweare.jpg" 
controls="controls" preload="true"></video>

<video style="display: none;" width="640" height="360" src="content.mp4" type="video/mp4" id="player2" controls="controls" preload="true"></video>

<script>

$(function () {
   promoVideo();
});

function promoVideo() {

$("#player1").mediaelementplayer({

    features: ['volume'],       
    success: function(player, node) {

        // add event listener
        player.addEventListener('ended', function() {
            contentVideo();         

        }, false);
    }
 });
}    

function contentVideo() {

$("#player2").mediaelementplayer({
features : ['playpause','progress','fullscreen','current','duration'],
    success: function(player, node) { player.play(); }
});

mejs.players[0].remove(); 
$('#video:eq(1)').show();

}  

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-17T12:35:27.537

```
 $(function(){
                    $('#audio-player').mediaelementplayer({
                        alwaysShowControls: true,
                        features: ['playpause','progress','volume'],
                        audioVolume: 'horizontal',
                        audioWidth: width,
                        audioHeight: 70,
                        iPadUseNativeControls: true,
                        iPhoneUseNativeControls: true,
                        AndroidUseNativeControls: true
                    });
                }); 
```

# php - 在php中计算两个日期之间的天数

> ID：14939416
> 
> 赞同：0
> 
> 时间：2013-02-18T15:11:56.730
> 
> 标签：php

我正在尝试计算两个日期之间的天数

日期格式为 dd/mm/yy

日期是可变的：

```
$getarrival   = $_GET["arrival"];
$getdeparture = $_GET["departure"]; 
```

我试过了，但是当你更改日期格式时它不起作用。

```
$start = strtotime('2010-01-25');
$end   = strtotime('2010-02-20');

$days_between = ceil(abs($end - $start) / 86400); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:12:24.953

由于我的日期格式是 dd/mm/yyyy 我将日期格式更改为 yyyy/mm/dd 并将其传递给一个新变量

```
list($arrivalday, $arrivalmonth, $arrivalyear) =explode("/",$getarrival);
list($departureday, $departuremonth, $departureyear) =explode("/",$getdeparture);
$newarrival = ($arrivalyear.'/'.$arrivalmonth.'/'.$arrivalday);
$newdeparture = ($departureyear.'/'.$departuremonth.'/'.$departureday);
$start = strtotime($newarrival);
$end = strtotime($newdeparture);
$totaldays = ceil(abs($end - $start) / 86400); 
```

# c# - 文本框的文本覆盖

> ID：14939419
> 
> 赞同：0
> 
> 时间：2013-02-18T15:12:04.100
> 
> 标签：c#, asp.net, textbox

如何为 .net c# 文本框添加说明性文本覆盖？

我想获得与此页面上的标题文本框相同的效果：

![在此处输入图像描述](../Images/1b0670110f334f167a863b3dcb525969.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:13:08.087

您可以使用[JQuery](http://code.google.com/p/jquery-watermark/)来做到这一点：

样本：

```
$('#inputId').watermark('watermark you want to show'); 
```

或者你可以使用 javascript：

```
function watermark(inputId,text){
  var inputBox = document.getElementById(inputId);
    if (inputBox.value.length > 0){
      if (inputBox.value == text)
        inputBox.value = '';
    }
    else
      inputBox.value = text;
}

<input id="inputTextboxId" type="text" value="type here" onfocus="watermark('inputTextboxId','type here');" onblur="watermark('inputTextboxId','type here');" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:16:18.413

您可以使用 ajax TextBox Watermark 控件：

```
<ajaxToolkit:TextBoxWatermarkExtender ID="TBWE2" runat="server"
        TargetControlID="TextBox1"
        WatermarkText="Type First Name Here"
        WatermarkCssClass="watermarked" /> 
```

你可以从[这里得到它](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/TextBoxWatermark/TextBoxWatermark.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:17:52.720

如果您使用 asp.net，则可以使用 Ajax-Control-Kit 中的 TextBoxWatermarkExtender

[http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/](http://www.asp.net/ajaxlibrary/AjaxControlToolkitSampleSite/)

* * *

它是一个扩展器，而不是文本框的替代品，像这样使用它：

```
<asp:textbox id="txtSalesEventNo" runat="server" CssClass="textbox" Width="30%" />
<act:TextBoxWatermarkExtender ID="wmSalesEventNo" TargetControlID="txtSalesEventNo" WatermarkText="Sales Event Number" WatermarkCssClass="watermarked_border" runat="server" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:18:00.050

你可能会喜欢这个[解决方案](http://forum.imasters.com.br/topic/419900-como-fazer-um-overlay-no-jquery/)

```
/* Full overlay */
$(function () {
    $('.full_overlay .content').hide();
    $('.full_overlay').mouseenter(function () {
        $(this).find('.content').stop(true, true).fadeIn('slow');
    }).mouseleave(function () {
        $(this).find('.content').stop(true, true).fadeOut('slow');
    })
}); 
```

# dynamic - 谷歌图表 - XLS y 轴刻度数据

> ID：14939423
> 
> 赞同：1
> 
> 时间：2013-02-18T15:12:20.093
> 
> 标签：dynamic, charts, xls

早上好，我遇到了一个动态站点，该站点生成 Google Chart 的图形作为发送到服务器的 xls 电子表格。

每月，是 5 个工作表。3张工作表，刻度值在0到50之间，取值为0、12.5、25、37.5和50。其中两张，取值在0到60之间，取值为0、15 , 30, 45 和 60。

两种秤的 PHP 代码相同。但在某些情况下，电子表格是正确的（值为 0、12.5 等，或 0、15、30 等），而在其他情况下，它只是忽略它，只播放 0 的数据， 15、30 等...

我想知道谷歌图表在哪里提取数据以生成刻度，以及如何始终正确显示刻度（表 1、2 和 3，分数在 0 到 50 之间，以及表 4 和 5，范围在 0 到60)。

附上代码。

```
 <?php 
function showDate( $current ){

    $ano = substr($current, 0, 4);
    $mes = substr($current, 5);

    switch ($mes){
        case 1: $mes = 'Janeiro'; break;
        case 2: $mes = 'Fevereiro'; break;
        case 3: $mes = 'Março'; break;
        case 4: $mes = 'Abril'; break;
        case 5: $mes = 'Maio'; break;
        case 6: $mes = 'Junho'; break;
        case 7: $mes = 'Julho'; break;
        case 8: $mes = 'Agosto'; break;
        case 9: $mes = 'Setembro'; break;
        case 10: $mes = 'Outubro'; break;
        case 11: $mes = 'Novembro'; break;
        case 12: $mes = 'Dezembro'; break;
    }

    printf("%s/%s", $mes, $ano);

}

define('WP_USE_THEMES', false);
require('../../../wp-blog-header.php');
status_header('200');

$produto = get_post(esc_html($_GET['pro']));

$produto_sheet = array(
    'cp-ii-f-32'    => "CP II-F",
    'cp-ii-z-32'    => "CP II-Z",
    'cp-iv-32'      => "CP IV",
    'cp-v-ari'      => "CP V",
    'cp-v-ari-rs'   => "CP V-RS"
);

require( dirname( __FILE__ ) . '/_theme/PHPExcel.php' );

$meta = get_option('opcoes_relatorio');
$directories = wp_upload_dir();

$current = isset($_GET['chave']) ? $_GET['chave'] : '';

foreach($meta as $key => $value){

    if(substr($key, 5) == 13) continue;

    $menu[] = array(
        'class' => $current == $key ? ('current') : (''),
        'label' => substr(getMonthName(substr($key, 5)), 0, 3) . ' ' . substr($key, 0, 4),
        'chave' => $key
    );

    $ano[] = substr($key, 0, 4);
    $mes[] = substr($key, 5);

}

array_multisort($ano, $mes, $menu, SORT_NUMERIC);
if($current == ''){

    $current =  $menu[count($menu)-1]['chave'];
    foreach($menu as &$m){
        if($m['chave'] == substr($current, 0, 4) . '-' . (int)substr($current, 5)){
            $m['class'] = 'current';
        }
    }
}

$xls['file'] = $directories['basedir'];
$xls['sub'] = preg_replace('~(.*)?([0-9]{4}/[0-9]{2}/.*\.xls)~', '$2', $meta[$current]);

if( (int)substr($current, 5) != 13 ){
    $rows = getValuesRelatorio($xls['file'].'/'.$xls['sub'], $produto_sheet[$produto->post_name]);
    //$minimo[0] = 0; 
    //$minimo[1] = 10; 
    //$minimo[2] = 20; 
    //$minimo[3] = 32; 
    $minimo = getMinimoAnualRelatorio($xls['file'].'/'.$xls['sub'], $produto_sheet[$produto->post_name]);
} else {
    $rows = getMediaAnualRelatorio($xls['file'].'/'.$xls['sub'], $produto_sheet[$produto->post_name]);
    $minimo = getMinimoAnualRelatorio($xls['file'].'/'.$xls['sub'], $produto_sheet[$produto->post_name], 34);
}

$media = array();
foreach($rows['media'] as $row){
    if($row[0] == "Média"){
        for($i = 1; $i < 5; $i++){
            $media[] = $row[count($row)-$i];
        }
    }
}

foreach ($minimo as $key => $value) {
    $minimo[$key] = str_replace(',', '.', $minimo[$key]);
}

foreach ($media as $key => $value) {
    $media[$key] = str_replace(',', '.', $media[$key]);
} 
```

?>

```
<body>

    <div id="logo"><img src="_assets/images/master/header-logo.png" alt="" /></div>

    <h2><?php echo $produto->post_title; ?> <br /><span><?php showDate($current); ?></span></h2>

    <div class="wrap">

        <table cellpadding="0" cellspacing="0" border="0" class="green-table">
            <thead>
                <tr>
                    <th rowspan="3" class="data">Data</th>
                    <th colspan="10">QUÍMICOS</th>
                    <th colspan="11" class="fisicos">FÍSICOS</th>
                </tr>
                <tr class="gray-01">
                    <th>Al<sub>2</sub>O<sub>3</sub></th>
                    <th>SiO<sub>2</sub></th>
                    <th>Fe<sub>2</sub>O<sub>3</sub></th>
                    <th>CaO</th>
                    <th>MgO</th>
                    <th>SO<sub>3</sub></th>
                    <th>P. Fogo</th>
                    <th>CaO&nbsp;L.</th>
                    <th>R. Ins.</th>
                    <th>Eq. Alc</th>
                    <th>Exp.</th>
                    <th colspan="2">Tempo de<br />Pega (h:min)</th>
                    <th>Cons.<br />Normal</th>
                    <th>Blaine</th>
                    <th>#<br />200</th>
                    <th>#<br />325</th>
                    <th colspan="4">Resist&ecirc;ncia &agrave;<br />Compress&atilde;o (MPa)</th>
                </tr>
                <tr  class="gray-02">
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>%</th>
                    <th>mm</th>
                    <th>Início</th>
                    <th>Fim</th>
                    <th>%</th>
                    <th>cm&sup2;/g</th>
                    <th>%</th>
                    <th>%</th>
                    <th>1 dias</th>
                    <th>3 dias</th>
                    <th>7 dias</th>
                    <th>28 dias</th>
                </tr>
            </thead>
            <tbody>
                <?php
                    $duasCasas = array(1,2,3,4,5,6,7,8,9,10,11,16,17);
                    $umaCasa = array(14,18,19,20,21);
                    $nenhumaCasa = array(0,15);
                    $duasCasasSd = array(1,2,3,4,5,6,7,8,9,10,11,16,17);
                    $umaCasaSd = array(14,18,19,20,21);
                    $nenhumaCasaSd = array(0);
                ?>
                <?php if(isset($rows['values'])): foreach($rows['values'] as $row): ?>
                <tr>
                    <?php foreach($row as $key=>$cell): ?>
                    <?php 
                    if(!is_numeric($cell)){
                        preg_match("~[0-9]~", $cell, $matches);

                        if(empty($matches)){
                            $cell = "-";
                        }
                    } else if (in_array($key,$nenhumaCasa)) {
                        $cell = number_format($cell,0,',','.');
                    } elseif (in_array($key,$umaCasa)) {
                        $cell = number_format($cell,1,',','');
                    } elseif (in_array($key,$duasCasas)) {
                        $cell = number_format($cell,2,',','');
                    }  ?>
                    <td><?php echo $cell; ?></td>
                    <?php endforeach; ?>
                </tr>
                <?php endforeach; endif;    ?>

                <?php foreach($rows['media'] as $rowKey=>$row): ?>
                <tr style="font-weight: bold;">
                    <?php foreach($row as $key=>$cell): ?>
                    <?php 

                    if($cell == "Sd"){
                        $sd = true;
                    }
                    if ($sd && $key == 15){
                        #$cell = number_format($cell,2,',','.');
                        $cell = explode(".", $cell);
                        $cell = number_format($cell[0],0,',','.') . "," . substr($cell[1], 0, 2);
                        $sd = null;
                    } else if($rowKey == 15 && $key == 15)
                    {
                        $cell = number_format($cell,2,',','');
                    } else if($rowKey == 24 && $key == 15)
                    {
                        $cell = number_format($cell,0,',','.');
                    } else {
                        if (in_array($key,$nenhumaCasa) && $key != 0) {
                            $cell = number_format($cell,0,',','.');
                        } elseif (in_array($key,$umaCasa)) {
                            $cell = number_format($cell,1,',','');
                        } elseif (in_array($key,$duasCasas)) {
                            $cell = number_format($cell,2,',','');
                        }
                    } 
                      ?>
                    <td><?php echo $cell; ?></td>
                    <?php endforeach; ?>
                </tr>
                <?php endforeach; ?>
            </tbody>
        </table>

        <?php 
            foreach($minimo as $val){
                $nMinimo[] = intval($val);
            }
            foreach(array_reverse($media) as $val){
                $nMedia[] = number_format($val, 1);
            }
        ?>

        <img class="chart" src="http://chart.apis.google.com/chart?chxl=0:|1|3|7|28|1:|Dias|2:|12%2C5|25%2C5|37%2C5|50%2C0&chxt=x,x,y&chxp=0,3.5,10.5,17.5,24.5,0|1,1.7|2,12.5,25.5,37.5,50&chxr=0,0,28|1,4,0|2,-5,50&chxs=0,676767,11.5,0,lt,676767&chxtc=0,10&chbh=a,0,11&chs=400x260&cht=bvg&chco=e6a736,60791b&chds=0.1,50,0.1,50&chd=t:<?php echo implode(',', $nMinimo); ?>|<?php echo implode(',', $nMedia); ?>&chdl=Minimos|Médios&chtt=<?php urlencode($produto->post_title); ?>&chm=N,666666,0,-1,11|N,666666,1,-1,11" width="400" height="260" alt="Vertical bar chart" />

        <div class="produtos-obs">
            <dl class="green-box">
                <dt>Obs</dt>
                <dd>
                    <p>
                        <small>
                            <?php echo get_post_meta($produto->ID, 'observacoes', true); ?>
                        </small>
                    </p>
                </dd>
            </dl>
        </div>

        <dl id="legend" class="green-box">
            <dt></dt>
            <dd>
                <p><small>
                    Valores mínimos - NBR <?php echo get_post_meta($produto->ID, "nbr", true); ?> <br />
                    Valores médios - <?php echo $produto->post_title; ?>
                </small></p>
            </dd>
        </dl>

    </div>
</body>

<script type="text/javascript">
    window.print();     
</script> 
```

谷歌图表代码

```
 <img class="chart" src="http://chart.apis.google.com/chart?chxl=0:|1|3|7|28|1:|Dias|2:|12%2C5|25%2C5|37%2C5|50%2C0&chxt=x,x,y&chxp=0,3.5,10.5,17.5,24.5,0|1,1.7|2,12.5,25.5,37.5,50&chxr=0,0,28|1,4,0|2,-5,50&chxs=0,676767,11.5,0,lt,676767&chxtc=0,10&chbh=a,0,11&chs=400x260&cht=bvg&chco=e6a736,60791b&chds=0.1,50,0.1,50&chd=t:<?php echo implode(',', $nMinimo); ?>|<?php echo implode(',', $nMedia); ?>&chdl=Minimos|Médios&chtt=<?php urlencode($produto->post_title); ?>&chm=N,666666,0,-1,11|N,666666,1,-1,11" width="400" height="260" alt="Vertical bar chart" /> 
```

谢谢

# python - Python 3：TCP 客户端/服务器断开管道错误

> ID：14939428
> 
> 赞同：1
> 
> 时间：2013-02-18T15:12:37.793
> 
> 标签：python, tcp, python-3.x, client-server, broken-pipe

我正在编写一个 TCP 客户端/服务器，并且在代码的后半部分遇到了这个损坏的 pip 错误。由于对 Python 和套接字编程的了解有限，我无法找出原因，因此无法解决问题。我将不得不包含所有代码，因为可能存在某种冲突导致我不知道的这个问题，对于长篇文章感到抱歉。

我已经在下面标记了我遇到问题的位置，到目前为止一切正常。

服务器代码：

```
import os
from socket import *
import urllib
import time

HOST = '' #We are the host
PORT = 29876
PORT2 = 29877
ADDR = (HOST, PORT)
ADDR2 = (HOST, PORT2)

BUFFSIZE = 4096

serv =  socket( AF_INET,SOCK_STREAM)
serv.bind(ADDR,)
serv.listen(5)
print ('listening... \n')

conn,addr = serv.accept()
print (conn,addr)
print ('...connected \n')

with open(os.path.expanduser("~/.ssh/id_rsa.pub")) as f:
    key = f.read()
    conn.sendall(key)
print("Key Sent... \n")

data = conn.recv(BUFFSIZE)
with open('ip.txt', 'w') as myfile:
    myfile.write(str(data))

with open("ip.txt", "r") as myfile:
    ip=myfile.read().replace('\n','')
print("The client IP is: " + ip + "\n")

conn.close()

ver = socket(AF_INET,SOCK_STREAM)
ver.bind(ADDR2,)
ver.listen(5)
print('listening...\n')

build,addr = ver.accept()
print (build,addr)
print('...connected\n')

#Get Version
version = urllib.urlopen("http://p.b.r.com/pa/b/latest.txt")
print(version.read())

#IT IS SENDING THIS LAST PIECE OF DATA THAT CAUSES THE BROKEN PIPE ERROR
version = str(version.read())
ver.send(version) 
```

客户代码：

```
from socket import *
from winreg import *
import os
import socket
import platform
import string
import time

#Detect OS
os = platform.system()
print("Your system is running "+ os)

#Set Host address and port
HOST = 'xxx.xxx.xxx.xxx'
PORT = 29876
PORT2 = 29877
ADDR = (HOST,PORT)
ADDR2 = (HOST, PORT2)
BUFFSIZE = 4096

cli = socket.socket( AF_INET, SOCK_STREAM)
cli.connect(ADDR,)

#Get and send IP
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.connect(("gmail.com",80))
ip = ((s.getsockname()[0]))
ip = ip.encode('utf-8')
cli.send(ip)
print("IP Sent... \n")

#Set received key to write to known hosts
data = cli.recv(BUFFSIZE)
with open('C:\cygwin\home\scollins\.ssh\known_hosts', 'w') as myfile:
    myfile.write(str(data,'utf-8'))
print("Key Saved To Known Hosts")

#Close opened sockets
s.close()
cli.close()

ver = socket.socket( AF_INET, SOCK_STREAM)
ver.connect(ADDR2,)

#Get version/build number
if os == "Windows":
    #Connect to the registry
    regKey = ConnectRegistry(None, HKEY_LOCAL_MACHINE)
    subKey = OpenKey(regKey, r"SOFTWARE\R\R Client")
    buildno = QueryValueEx(subKey, "Version")
else:
    if os == "Darwin":
        buildno = open("\Library\R\buildno")
    else:
        if os == "Linux":
           buildno = open("\r\buildno")

print("You are running software build number " + str(buildno))

#Receive and write server software version to file. Read file and compare build number
data = ver.recv(BUFFSIZE)

#THIS NEXT PRINT COMMAND RETURNS NOTHING WHICH I ASSUME IS DUE TO NOTHING BEING RECEIVED DUE TO THE BROKEN PIPE
print(str(data))
with open('version.text', 'w') as myfile:
    myfile.write(str(data,'utf-8'))

with open('version.txt', 'r') as myfile:
    version = myfile.read()
print("The software on the server is version: " + version)

if buildno in version == True:
    print("Your sofware version is up to date")
else:
    print("Your software is out of date. Updating your software.")
    os.system('')

ver.close() 
```

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:20:54.663

好吧，我没有在这里安装 python3 工作，但仅从查看代码来看，您似乎正在尝试使用服务器部分中的服务器套接字发送一些东西。

你在ver上调用accept：

```
build,addr = ver.accept() 
```

然后你尝试发送版本，而不是构建：

```
ver.send(version) 
```

通常它是这样工作的：在服务器端，你有一个“服务器”套接字，你调用绑定然后接受，等待传入的连接。每次客户端连接时，accept 都会产生一个套接字来与这个特定的客户端（“客户端”套接字）对话。如果所有通信都通过服务器套接字进行，那么您如何拥有多个客户端并知道您正在与哪个客户端“交谈”？

代码中的第二个错误是，调用 version.read() 来打印值，然后再次发送它。read() “消耗”数据，因此第二个 read() 给出了一个空结果。

此外，您应该在循环中调用 send()，检查其返回值，以确保所有数据都已实际发送。可能会发生部分发送。

# java - 手动参考支持

> ID：14939433
> 
> 赞同：1
> 
> 时间：2013-02-18T15:12:50.013
> 
> 标签：java, mongodb, jongo

考虑类：

```
class Person {
    String name;
    Person father;
    Person mother;
    List<Person> children;
} 
```

有没有办法向 jongo 表明`father`，`mother`并且`children`应该[手动引用](http://docs.mongodb.org/manual/applications/database-references/#manual-references)同一集合中的其他对象而不是嵌入对象？

注意：这与[DBRefs](http://docs.mongodb.org/manual/applications/database-references/#dbrefs)不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:21:01.053

还没有。

最简单的方法是手动发出第二个查询。

不过，您可以适当地创建一个 Jackson de/serializer 来在解组过程中获取文档。几个月前，我们为在解组期间获取 DBRef 创建了一个尖峰，这段代码可以提供帮助：[Handle DBRef during (un)marshalling](https://github.com/bguerout/jongo/issues/29)

随意添加[功能请求](https://github.com/bguerout/jongo/issues/new)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-05T13:56:58.170

我用一种方法来处理它。不确定它是否完美，但它适用于我自己。

假设您有这些课程

```
public class MyObject {

    @Id
    private String id;
    private MyEmbeddedObject embeddedObject;

    public String getId() {
        return this.id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public MyEmbeddedObject getEmbeddedObject() {
        return this.embeddedObject;
    }

    public void setEmbeddedObject(MyEmbeddedObject embeddedObject) {
        this.embeddedObject = embeddedObject;
    }

}

public class MyEmbeddedObject {

    @Id
    private String id;

    public String getId() {
        return this.id;
    }

    public void setId(String id) {
        this.id = id;
    }

} 
```

您希望将 MyEmbeddedObject 存储在集合“embed”中，并将 Object 存储在集合“object”中，并手动引用“embed”集合 ID。例如 ：

```
object : { id:1, embeddedObjectId: 99 }
embed : { id : 99 } 
```

您可以为 MyEmbeddedObject 实现自定义序列化器和反序列化器

```
public class MyEmbeddedObjectSerializer extends JsonSerializer<MyEmbeddedObject> {

    @Override
    public void serialize(MyEmbeddedObject value, JsonGenerator jgen, SerializerProvider provider) throws IOException, JsonProcessingException {
        jgen.writeText(value.getId());
    }
}

public class MyEmbeddedObjectDeserializer extends JsonDeserializer<MyEmbeddedObject> {

    @Override
    public MyEmbeddedObject deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {
        MyEmbeddedObject obj = new MyEmbeddedObject();
        obj.setId(jsonParser.getString());
        return new MyEmbeddedObject();

    }
 } 
```

如果您在 Jongo 中注册您的序列化程序，问题是它将作为 MyObject 的成员用于 MyEmbeddedObject，但当它单独存储在“嵌入”集合中时，也用于 MyEmbeddedObject。

为了仅在 MyEmbeddedObject 嵌入 MyOBject 时应用自定义序列化器/反序列化器，我使用 Mixin 注释。

```
public interface MyObjectMixIn {

    @JsonSerialize(using=MyEmbeddedObjectSerializer .class)
    public MyEmbeddedObject getEmbeddedObject();

    @JsonDeserialize(using=MyEmbeddedObjectDeserializer.class)
    public void setEmbeddedObject(MyEmbeddedObject embeddedObject);

} 
```

然后定义一个模块

```
public class MyModule extends SimpleModule {
    @Override
    public void setupModule(SetupContext context) {
        context.setMixInAnnotations(MyObject.class, MyObjectMixIn.class);
    }
} 
```

最后在 Jongo 中注册模块

```
Jongo jongo = new Jongo(db, JacksonMapper.Builder().registerModule(new MyModule ()).build()); 
```

现在将其用于存储在 Mongo

1.  将 embeddedObject 本身存储在集合“embed”中以获取 id
2.  确保 object 的 embeddedObject 成员包含 id
3.  将对象存储在集合“对象”中。仅存储嵌入对象的 id

并读取数据存储

1.  从集合“对象”中读取对象。嵌入对象将仅使用其 ID 进行初始化
2.  如果需要，请阅读“嵌入”集合中的嵌入对象。

编辑：为了避免延迟加载并在反序列化时加载完整的对象， Jackson 的[HandlerInstantiator](http://wiki.fasterxml.com/HandlerInstantiator)对象对于自定义序列化器和反序列化器构造机制很有用。

希望有帮助。

# javascript - 防止 IconMenuIcon 在单击时突出显示

> ID：14939435
> 
> 赞同：-1
> 
> 时间：2013-02-18T15:12:51.740
> 
> 标签：javascript, html, dojo, selected

我正在使用 html、javascript 和 dojo 库。

我拥有的是一个带有 6 个 IconMenuItems 的 IconMenu。现在，每当我单击 IconMenuIcon 时，它都会突出显示，但我想阻止突出显示效果。IconMenuIcon 的属性“selected”在单击事件中设置为“true”，我认为这是突出显示的原因。

**我现在尝试对 dojo 提供的每个“on”功能（onclick、onmouseover 等）执行以下操作：**

> this.set("选中", false);

不幸的是 IconMenuItem 仍然被突出显示-.-

编辑：这是小部件的代码：

[http://svn.dojotoolkit.org/src/dojox/trunk/mobile/IconMenuItem.js](http://svn.dojotoolkit.org/src/dojox/trunk/mobile/IconMenuItem.js)

它有这个属性：

> selColor: "mblIconMenuItemSel"

如何将其设置为 luicid？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:32:00.407

没有使用过dojo，但我认为突出显示是用CSS完成的，看看应用于“选定”元素的类，看看它是否匹配突出显示样式并根据需要进行编辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T13:40:38.953

感谢官方dojo irc中的好心人，我来到了这个简单的javascript。ItemMenuItem 具有确定突出显示颜色的属性：

> dojo.ready(function(){ // dojo 就绪时执行的逻辑放在这里 alert("dojo.ready");
> 
> var portalButton1 = dijit.byId("portalButton1"); portalButton1.set("selColor", "RED");
> 
> });

# perspective - 在opengl上获取透视函数的参数

> ID：14939440
> 
> 赞同：0
> 
> 时间：2013-02-18T15:13:06.127
> 
> 标签：perspective

我正在尝试使用 GetPerspevtive 函数来检查 Perspective 函数是否返回预期的答案。

我的观点是：

```
Mat4<Real> Perspective(Real fovy, Real aspect, Real zNear, Real zFar)
{
        Real Cotan_fovy = (Real)1.0/Tan(fovy * (Real)0.5);

        Mat4<Real> r;
        r.SetRow(0, Cotan_fovy/aspect,  (Real)0.0,                         (Real)0.0,                                 (Real)0.0);
        r.SetRow(1,         (Real)0.0, Cotan_fovy,                         (Real)0.0,                                 (Real)0.0);
        r.SetRow(2,         (Real)0.0,  (Real)0.0,  -(zFar + zNear) / (zFar - zNear), ((Real)2.0* zFar * zNear )/ (zNear - zFar));
        r.SetRow(3,         (Real)0.0,  (Real)0.0,                        (Real)-1.0,                                 (Real)0.0);
        return r;
} 
```

这就是我的 GetPerspective：

```
void GetPerspective(const Mat4<Real>& m, Real& fovy, Real& aspect, Real& zNear, Real& zFar)
{
    Real right = (Real)0.0;
    Real left = (Real)0.0;
    Real top = (Real)0.0;
    Real bottom = (Real)0.0;
    GetFrustum(m, left, right, bottom, top, zNear, zFar);

    fovy = Atan(top / zNear) - Atan(bottom / zNear);
    aspect = (right - left) / (top - bottom);
} 
```

问题是：不管我的输入矩阵是什么，我的 GetPerspective 总是在位置 (2,3) 设置 -1

# php - 在每个目录文件夹中自动运行 PHP 和 HTML

> ID：14939441
> 
> 赞同：0
> 
> 时间：2013-02-18T15:13:06.840
> 
> 标签：php, photo-gallery

我正在制作一个包含图像文件夹和子文件夹的照片库。我不想在每个文件夹中都放一个 HTML 文件。如何才能做到这一点？这是我的PHP：

```
<?php

$directory = "thumbs/";
$files = glob($directory."*");
$photoCount = 0;

buildStage();

function buildStage() {
    global $directory, $files;

    foreach($files as $file) {
        if(is_dir($file)) showFolder($file);
        else showPhotos($directory);    
    }
}

function showPhotos($imagePath) {
    global $photoCount;
    $imageFile = glob($imagePath."/*.*");
    echo '<img src="'.$imageFile[$photoCount].'" id="thumbPic"
            onmouseover="imageOver(this)" 
            onmouseout="imageOut(this)" 
            />'."\n";
    $photoCount++;
}

function showFolder($imagePath) {
    $imageFile = glob($imagePath."/*.*");
    echo '<a href="' .$imagePath. '<img src="'.$imageFile[1].'"  id="folder"
            onmouseover="imageOver(this)" 
            onmouseout="imageOut(this)" 
            onmousedown="imageDown(this)"
            />'."\n";
}

?> 
```

这是我的 HTML：

```
<body>

<div id="container">
<?php include 'jellybox.php'; ?>
</div>

</body> 
```

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:18:45.253

您可以使用 htaccess 将每个文件映射到您的 php 代码：

```
Options +FollowSymLinks

RewriteEngine On
RewriteBase /dependsOnyourPathes/
RewriteRule ^[images|thumb]/(.+).jpg$  script.php?file=$1.pdf [L,NC,QSA] 
```

这会在浏览器栏中显示旧图像 url，但会在内部调用您的 php 脚本。我不太确定你到底在尝试什么。您还可以重写现有文件夹并将其发送到您的脚本。要获得更准确的答案，我们需要有关文件在您的服务器上的位置的更多信息。

# r - R字符串到对象

> ID：14939443
> 
> 赞同：-5
> 
> 时间：2013-02-18T15:13:13.203
> 
> 标签：r

我试图返回对象的值而不是 TRUE 或 FALSE，尽管我很挣扎：到目前为止，我有一个数据列表，我可以调用返回值的列表，很好。我还想返回 > 0 的列表值。我不只想要 True 或 FALSE。然后我想对零以上的值求和....

```
with_Gain = (Count_Return1 > 0)
get("with_Gain") 
```

请指教，非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:24:29.950

我想你正在寻找`which()`.

```
Count_Return1 <- c(3,2,-1)

Count_Return1[which(Count_Return1 > 0)]
 #[1] 3 2 
 #returns the values above 0 
```

`which()`这里并不真正需要`Count_Return1[Count_Return1 > 0]`将做同样的工作。

但是，如果您想要索引而不是值，请使用：

```
which(Count_Return1 > 0)
#[1] 1 2 
#returns the index for the values above 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:18:38.577

您可以像这样移动左括号：

```
(with_Gain = Count_Return1 > 0)
[1] TRUE 
```

当然，这假设您已经定义了 Count_Return1 ..

**编辑**

要获取对象的值，您可以执行类似的操作

```
 Count_Return1[Count_Return1 > 0] 
```

并获得条件的索引

```
 which(Count_Return1 > 0) 
```

例如 ：

```
set.seed(1234)
> Count_Return1 <- sample(c(-1,1),10,rep=T)
> Count_Return1[Count_Return1 > 0]
[1] 1 1 1 1 1 1 1
> Count_Return1 > 0
 [1] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE 
```

# mysql - MySQL查询优化：如何优化投票计算？

> ID：14939447
> 
> 赞同：5
> 
> 时间：2013-02-18T15:13:37.740
> 
> 标签：mysql, sql, sql-optimization

希望你一切都好。

我需要这个数据库的帮助：

![在此处输入图像描述](../Images/157521bcca4026dc62d3f5e7ee035eab.png)

这是一个存储选票的数据库。用户选择他们喜欢的音轨，然后投票给他们。他们可以投票“赞成”或“反对”。非常简单。但是，当涉及到计算数据时，它会变得毛茸茸的。

# 元

这是一个键值样式表，存储最常用的统计信息（只是某种缓存）：

```
mysql> SELECT * FROM Meta;
+-------------+-------+
| Key         | Value |
+-------------+-------+
| TRACK_COUNT | 2620  |
| VOTE_COUNT  | 3821  |
| USER_COUNT  | 371   |
+-------------+-------+ 
```

# 投票

投票表持有投票本身。这里唯一有趣的字段是`Type`, 的值意味着：

1.  `0`- 应用程序投票，用户使用 UI 为曲目投票
2.  `1`- 导入投票（来自外部服务）
3.  `2`- 合并投票。实际上与 Imported Vote 相同，但它实际上做了一个注释，该用户已经使用外部服务为该曲目投票，现在他正在使用应用程序重复自己。

# 追踪

轨道是为自己保存总统计数据。喜欢、不喜欢、来自外部服务的喜欢 ( `LikesRP`)、来自外部服务的不喜欢 ( `DislikesRP`)、喜欢/不喜欢调整的数量。

# 应用程序

该应用程序需要获得以下投票：

1.  过去 7 天内投票最多的 5 首曲目
2.  过去 7 天内投票最多的 5 首曲目
3.  过去 7 天内投票最多的 5 首曲目，其中的投票来自外部服务 ( `Vote.Type = 1`)
4.  上个月投票最多的 100 首曲目

为了获得 100 个投票最多的曲目，我使用以下查询：

```
SELECT
    T.Hash,
    T.Title,
    T.Artist,
    COALESCE(X.VotesTotal, 0) + T.LikesAdjust as VotesAdjusted
FROM (
    SELECT
        V.TrackHash,
        SUM(V.Vote) AS VotesTotal
    FROM
        Vote V
    WHERE
        V.CreatedAt > NOW() - INTERVAL 1 MONTH AND V.Vote = 'up'
    GROUP BY
        V.TrackHash
    ORDER BY
        VotesTotal DESC
) X
RIGHT JOIN Track T
    ON T.Hash = X.TrackHash
ORDER BY
    VotesAdjusted DESC
LIMIT 0, 100; 
```

此查询工作正常，它支持调整（客户想要调整列表中的轨道位置）。几乎相同的查询用于获得 5 个最上/下投票的曲目。任务 #3 的查询是这样的：

```
SELECT
    T.Hash,
    T.Title,
    T.Artist,
    COALESCE(X.VotesTotal, 1) as VotesTotal
FROM (
    SELECT
        V.TrackHash,
        SUM(V.Vote) AS VotesTotal
    FROM
        Vote V
    WHERE
        V.Type = '1' AND
        V.CreatedAt > NOW() - INTERVAL 1 WEEK AND
        V.Vote = 'up'
    GROUP BY
        V.TrackHash
    ORDER BY
        VotesTotal DESC
) X
RIGHT JOIN Track T
    ON T.Hash = X.TrackHash
ORDER BY
    VotesTotal DESC
LIMIT 0, 5; 
```

问题是第一个查询需要大约 2 秒的时间来执行，而我们的票数少于 4k。到年底，这个数字将是大约 20 万张选票，这很可能会扼杀这个数据库。所以我正在想办法解决这个难题。

现在我归结为这些问题：

1.  我是否使数据库设计错误？我的意思是，它会更好吗？
2.  我是不是查询错了？
3.  还有什么我可以改进的吗？

我做的第一件事是缓存。但是，好的，这彻底解决了问题。但我对 SQL 相关的解决方案很好奇（总是倾向于完美）。

我有一个想法的第二件事是将这些计算值放到`Meta`表中并在投票过程中更改它们。但是我的时间很短，只是尝试一下。顺便说一句，这值得吗？或者，企业级应用如何解决这些问题？

谢谢。

## 编辑

我不敢相信我忘了包括索引。他们来了：

```
mysql> SHOW INDEXES IN Vote;
+-------+------------+-------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table | Non_unique | Key_name                | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+-------+------------+-------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Vote  |          0 | UNIQUE_UserId_TrackHash |            1 | UserId      | A         |         890 |     NULL | NULL   |      | BTREE      |         |
| Vote  |          0 | UNIQUE_UserId_TrackHash |            2 | TrackHash   | A         |        4450 |     NULL | NULL   |      | BTREE      |         |
| Vote  |          1 | INDEX_TrackHash         |            1 | TrackHash   | A         |        4450 |     NULL | NULL   |      | BTREE      |         |
| Vote  |          1 | INDEX_CreatedAt         |            1 | CreatedAt   | A         |        1483 |     NULL | NULL   |      | BTREE      |         |
| Vote  |          1 | UserId                  |            1 | UserId      | A         |        1483 |     NULL | NULL   |      | BTREE      |         |
+-------+------------+-------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+

mysql> SHOW INDEXES IN Track;
+-------+------------+----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table | Non_unique | Key_name       | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+-------+------------+----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Track |          0 | PRIMARY        |            1 | Hash        | A         |        2678 |     NULL | NULL   |      | BTREE      |         |
| Track |          1 | INDEX_Likes    |            1 | Likes       | A         |          66 |     NULL | NULL   |      | BTREE      |         |
| Track |          1 | INDEX_Dislikes |            1 | Dislikes    | A         |          27 |     NULL | NULL   |      | BTREE      |         |
+-------+------------+----------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T18:35:13.553

这是一个非常主观的问题，因为它在很大程度上取决于您的确切要求，以及这里没有人可以对您的数据进行的性能测试。但我可以回答您的问题并添加一些可能对您有用的通用解决方案：

* * *

**我是否使数据库设计错误？我的意思是，它会更好吗？**

不，这是 OLTP 的理想设计。

* * *

**我是不是查询错了？**

否（尽管`ORDER BY`子查询中的 是多余的）。查询的性能在很大程度上取决于`Vote`表上的索引，因为查询的主要列将在这一部分中：

```
SELECT  V.TrackHash, SUM(V.Vote) AS VotesTotal
FROM    Vote V
WHERE   V.CreatedAt > NOW() - INTERVAL 1 MONTH AND V.Vote = 'up'
GROUP BY V.TrackHash 
```

我建议使用 2 个索引，一个 on`TrackHash`和一个 on `CreatedAt`，`Vote`AND `Type`（​​作为 3 个单独的索引，这可能会更好地执行，值得两种方式进行测试）。200k 行并不是那么多数据，因此使用正确的索引应该不会花费太长时间来查询上个月的数据。

* * *

**还有什么我可以改进的吗？**

这在很大程度上是一种平衡行为，它实际上取决于您对最佳方式的确切要求。有 3 种主要方法可以解决问题。

**1.你目前的做法（每次查询投票表）**

正如之前提到的，我认为这种方法应该可以针对您的应用程序进行扩展。优点是它不需要任何维护，并且发送到应用程序的所有数据都是最新且准确的。缺点是性能，插入数据（由于更新索引）和选择数据可能需要更长的时间。这将是我的首选方法。

**2\. OLAP 方法**

这将涉及维护一个汇总表，例如：

```
CREATE TABLE VoteArchive
(       TrackHash           CHAR(40) NOT NULL,
        CreatedDate         DATE NOT NULL,
        AppMadeUpVotes      INT NOT NULL,
        AppMadeDownVotes    INT NOT NULL,
        ImportedUpVotes     INT NOT NULL,
        ImportedDownVotes   INT NOT NULL,
        MergedUpVotes       INT NOT NULL,
        MergedDownVotes     INT NOT NULL,
    PRIMARY KEY (CreatedDate, TrackHash)
); 
```

这可以通过运行一个简单的查询每晚填充

```
INSERT VoteArchive
SELECT  TrackHash,
        DATE(CreatedAt),
        COUNT(CASE WHEN Vote = 'Up' AND Type = 0 THEN 1 END),
        COUNT(CASE WHEN Vote = 'Down' AND Type = 0 THEN 1 END),
        COUNT(CASE WHEN Vote = 'Up' AND Type = 1 THEN 1 END),
        COUNT(CASE WHEN Vote = 'Down' AND Type = 1 THEN 1 END),
        COUNT(CASE WHEN Vote = 'Up' AND Type = 2 THEN 1 END),
        COUNT(CASE WHEN Vote = 'Down' AND Type = 2 THEN 1 END)
FROM    Votes
WHERE   CreatedAt > DATE(CURRENT_TIMESTAMP)
GROUP BY TrackHash, DATE(CreatedAt); 
```

然后，您可以使用此表代替您的实时数据。它的优点是日期是聚集索引的一部分，因此任何受日期限制的查询都应该非常快。这样做的缺点是，如果您查询此表，您只能获得准确到上次填充它的统计信息，但您将获得更快的查询。维护查询也是一项额外的工作。但是，如果我不能查询实时数据，这将是我的第二选择。

**3\. 投票时更新统计**

为了完整起见，我将其包括在内，但恳请您不要使用此方法。您可以在您的应用程序层或通过触发器实现这一点，尽管它确实允许查询最新数据而无需查询“生产”表，但它对错误是开放的，而且我从未遇到过真正提倡的人这种方法。对于每次投票，您都需要执行插入/更新逻辑，这应该将非常快速的插入查询变成更长的过程，这取决于您如何进行维护，有机会（尽管并发问题非常小）。

**4.以上组合**

您始终可以拥有 2 个与您的投票表格式相同的表格，以及解决方案 2 中规定的一个表格，一个投票表仅用于存储今天的投票，一个用于存储历史投票，并且仍然维护一个汇总表，您可以然后将今天的数据与汇总表结合起来，在不查询大量数据的情况下获得最新的结果。同样，这是额外的维护，并且更有可能出错。

# c# - 实体框架子项为空

> ID：14939450
> 
> 赞同：2
> 
> 时间：2013-02-18T15:13:45.233
> 
> 标签：c#, entity-framework-5

我是 EntityFramework 的新手，所以这个问题可能有点愚蠢，但我试图搜索谷歌却一无所获。

我在数据库中有一张桌子：

```
 [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public Guid Id { get; set; }
    [Required]
    public UserProfile Owner { get; set; }
    [Required]
    public string Mask { get; set; }
    [Required]
    public string Key { get; set; }
    public DateTime Generated { get; set; }
    public DateTime DateTo { get; set; }
    public bool isElite { get; set; } 
```

其中 UserProfile Owner 是指向另一个表的链接。当我做出这样的选择时：

```
 db.Keys.Where(s=>s.Owner.UserId == WebSecurity.CurrentUserId && s.DateTo > DateTime.UtcNow).ToList() 
```

它运作良好，但是当我试图从许可证中联系所有者时，它总是为空。有人可以帮助如何获得所有者的许可证吗？感谢您的时间！

编辑：我认为我犯了一个错误，并且有点错误地发布了一个问题。我真正需要的是当我通过它的 ID 搜索许可证时： `License license = db.Keys.Find(id);` 我可以让所有者喜欢： `var a = license.Owner;` 我以前使用过 Active Record，并且它“按需”加载这些数据（仅当我调用它时）。我可以用 EF 以某种方式做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:17:10.023

使用您拥有的代码，您可以通过将所有者标记为`virtual`许可证类来延迟加载所有者。

由于您仍在上下文中（使用 db），EF 将自动调用以水合`Owner`.

有关加载相关实体的好文章，[请查看此](http://msdn.microsoft.com/en-us/magazine/hh205756.aspx)。

编辑（使用 linq 查询）：

下面是 linq 查询的示例，但您仍然可能需要延迟或急切加载 Owners。

```
var query = from k in db.Keys
            where k.Owner.UserId.Equals(WebSecurity.CurrentUserId)
            && k.DateTo > DateTime.UtcNow
            select k;

var list = query.ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:30:04.527

使用 DbQuery.Include(string path) 方法 [点击这里](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28System.Data.Entity.Infrastructure.DbQuery%601.Include%29;k%28TargetFrameworkMoniker-.NETFramework "这里")

这至少对我有用。

这将是您的代码：

> db.Keys.Include("Owner").Where(s=>s.Owner.UserId == WebSecurity.CurrentUserId && s.DateTo > DateTime.UtcNow).ToList()

如果您希望“键”查询返回大量结果，这可能不是最好的方法。但是只有有限数量的结果，它就像一个魅力。

# java - 在 Java 中可视化麦克风音频

> ID：14939468
> 
> 赞同：1
> 
> 时间：2013-02-18T15:14:52.650
> 
> 标签：java, visualization, microphone

有没有办法以一种波形可视化 Java 中的音频？

我应该如何开始，我已经设置了一个麦克风选择和一个线程，以将 TargetDataLine 中的字节读取到缓冲区中。但我现在该怎么办？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:20:20.720

如果您使用的是 Java Sound API，那么您读取的数据是 8 位或 16 位 PCM。如果是 8-bit 就可以了，否则你可能需要调整[endianess](http://en.wikipedia.org/wiki/Endianness)。

如果您正在读取 8 位 PCM，每个字节都是一个样本，那么该字节的值就是声音样本。如果您正在阅读 16 位 PCM，则根据字节顺序将样本打包为`hi,lo,hi,lo`或`lo,hi,lo,hi`（其中 hi 和 lo 是高位字节和低位字节）。在这种情况下，您应该将其转换为短值。

对于绘图，您将需要一个 3rd 方库，例如[freechart](http://sourceforge.net/projects/jfreechart/)或[jahuwaldt.plot](http://thehuwaldtfamily.org/java/Packages/Plot/PlotPackage.html)。（我在实时波形可视化程序中使用了后者）。

# c# - 自动记录传递给某个方法的所有参数

> ID：14939472
> 
> 赞同：1
> 
> 时间：2013-02-18T15:15:18.430
> 
> 标签：c#, log4net

假设我有一些接受两个整数的函数。是否可以自动记录这样的消息 `"[Date][MethodNam]([first param],[second param]) - "`

到目前为止我尝试了什么 - 指定以下布局模式：

```
<conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] [%C.%M] – %message%newline" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:35:19.420

如果您使用的是 Windsor 等 IoC 框架，您可以使用 AOP（面向方面​​的编程）在您的接口周围注入一个包装器。然后，您可以记录方法调用。这是一个使用 Windsor 和 IInteceptor 接口的示例，这是我们使用的精简版本，但有各种可用示例。

```
public class LoggingInterceptor : IInterceptor
{
    public void Intercept(IInvocation invocation)
    {
        Type targetType = invocation.TargetType ?? invocation.Method.DeclaringType;

        ILog logger = LogManager.GetLogger(targetType);

        //Probably want to check logger.IsDebugEnabled

        if(invocation.Arguments.Count() == 0)
        {
            logger.DebugFormat("Method '{0}' called.", invocation.Method);
        }
        else
        {
            var stringBuilder = new StringBuilder("{" + invocation.Arguments.Length + "}");

            for (int i = invocation.Arguments.Length - 1; i > 0; i--)
            {
                stringBuilder.Insert( 0, "{" + i + "}, " );
            }

            logger.DebugFormat("Method '{0}' called with parameters: " + stringBuilder, new[] { invocation.Method }.Union(invocation.Arguments).ToArray());
        }

        try
        {
            invocation.Proceed();

            if (invocation.Method.ReturnType != typeof(void))
            {
                logger.DebugFormat("Method '{0}' returned: {1}", invocation.Method, invocation.ReturnValue);
            }
        }
        catch(Exception ex)
        {
            logger.Error(string.Format("Method '{0}' threw exception:", invocation.Method), ex);
            throw;
        }
    }
} 
```

根据您的 IoC 框架，您应该能够连接各个组件。

注意事项：

这仅适用于接口方法，它不会连接对象上的私有方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:22:19.660

不知道什么是 log4net，但是您可以使用反射来获取运行时数据或调试功能，然后保存，请[在此处](https://stackoverflow.com/questions/615940/retrieving-the-calling-method-name-from-within-a-method-c)阅读更多内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:30:12.613

你需要什么，我称之为`Aspect Oriented Programming`(AOP)[这](http://csharp-source.net/open-source/aspect-oriented-frameworks)是 AOP 框架的列表。不知道是否允许您插入参数记录，但[Loom.net](http://loom.codeplex.com/documentation)看起来很有希望。

# scala - 在 Scalaz 中仅累积验证错误

> ID：14939473
> 
> 赞同：5
> 
> 时间：2013-02-18T15:15:20.463
> 
> 标签：scala, scalaz

我是函数式编程工作的初学者，我有一个 ValidationNEL[A,B] 序列，我想将错误累积到一个新的 ValidationNEL[A,B] 中。这取决于 B 是来自遗留代码的可变数据结构这一事实，因此保存 Seq[B] 会过于冗长。

我从其他帖子中知道，通过序列方法可以累积错误和成功：[处理 Scalaz6 验证列表](https://stackoverflow.com/questions/14233511/processing-a-list-of-scalaz6-validation/14234662#comment20962290_14234662)

根据我的理解，这一切都是为了编写一个合适的 Applicative 并且可能是一个合适的 Traverse。

```
 trait MA[M[_], A] extends PimpedType[M[A]] with MASugar[M, A] {

    def sequence[N[_], B](implicit a: A <:< N[B], t: Traverse[M], n: Applicative[N]): N[M[B]] =
    traverse((z: A) => (z: N[B]))

  def traverse[F[_],B](f: A => F[B])(implicit a: Applicative[F], t: Traverse[M]): F[M[B]] =
    t.traverse(f, value)
  } 
```

我该如何开始？当我试图查看 Scalaz 源代码以了解如何实现我的 Applicative 时，我感到非常困惑。我什至无法找出哪个应用程序允许在验证中累积失败和成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-12T11:10:39.157

迟到了，但从 Scalaz 7.0.4 开始，我们可以这样做：

```
 def takeLastSuccess[A, B](seq: Seq[ValidationNel[A, B]]) = {
      implicit val useLast = Semigroup.lastSemigroup[B]
      seq reduceLeft (_ +++ _)
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T02:52:35.670

现在我更好地理解了你的问题，这很简单：

```
def takeLastSuccess[A, B](seq:Seq[ValidationNEL[A, B]]) = 
    seq.sequence[({type l[a] = ValidationNEL[A, a]})#l, B].map(_.last) 
```

当您对这个 Scala 进行排序时，类型会出现一些问题，因此您需要使用类型 lambda。序列是从 Seq[Something[X]] 到 Something[Seq[X]] 的一个很好的捷径。最后，我们只是映射成功并从 B 的序列中获取最后一个 B。

[从您引用的帖子](https://stackoverflow.com/questions/14233511/processing-a-list-of-scalaz6-validation/14234662#comment20962290_14234662)中删除示例，这是我从 REPL 中得到的：

```
scala>   import scalaz._, Scalaz._
import scalaz._
import Scalaz._

scala>   type ExceptionsOr[A] = ValidationNEL[Exception, A]
defined type alias ExceptionsOr

scala>   val successResults: Seq[ExceptionsOr[Int]] = Seq(
     |     "13".parseInt.liftFailNel, "42".parseInt.liftFailNel
     |   )
successResults: Seq[ExceptionsOr[Int]] = List(Success(13), Success(42))

scala>   val failResults: Seq[ExceptionsOr[Int]] = Seq(
     |     "13".parseInt.liftFailNel, "a".parseInt.liftFailNel, "b".parseInt.liftFailNel
     |   )
failResults: Seq[ExceptionsOr[Int]] = List(Success(13), Failure(NonEmptyList(java.lang.NumberFormatException: For input string: "a")), Failure(NonEmptyList(java.lang.NumberFormatException: For input string: "b")))

scala>   def takeLastSuccess[A, B](seq:Seq[ValidationNEL[A, B]]) = seq.sequence[({type l[a] = ValidationNEL[A, a]})#l, B].map(_.last)
takeLastSuccess: [A, B](seq: Seq[scalaz.Scalaz.ValidationNEL[A,B]])scalaz.Validation[scalaz.NonEmptyList[A],B]

scala>   takeLastSuccess(successResults)
res0: scalaz.Validation[scalaz.NonEmptyList[Exception],Int] = Success(42)

scala>   takeLastSuccess(failResults)
res1: scalaz.Validation[scalaz.NonEmptyList[Exception],Int] = Failure(NonEmptyList(java.lang.NumberFormatException: For input string: "a", java.lang.NumberFormatException: For input string: "b")) 
```

# r - compileCode中的rcpp内联包错误

> ID：14939474
> 
> 赞同：2
> 
> 时间：2013-02-18T15:15:22.097
> 
> 标签：r, inline, rcpp

我已经安装了 R 以及这两个包 Rcpp 和 inline。（我正在做一个项目，该项目包括在 R 中加速一个非常缓慢的程序，我决定使用 Rcpp）......我知道我做错了什么......可能错过了一个步骤，但我无法弄清楚。如果您正在阅读本文，请向 Dirk 推荐！感谢 Rcpp 和全新的内联包 pdf 但是......它仍然没有运行。请注意，我是新手。如前所述，我清除了所有其他软件包，并且仅使用 Rcpp 和内联安装了 R（当然我也安装了 c++）。

```
 library(Rcpp)
    library(inline)
    x<-as.numeric(1:10)
    n<-as.integer(10)
    code<-"
    integer i 
    do 1 i=1, n(1)
    1 x(i)=x(i)**3
    "
    cubefn<-                       cfunction(signature(n="integer",x="numeric"),code,convention=".Fortran")
     ERROR(s) during compilation: source code errors or   compiler      configuration errors!
                Program source:
      1: #include <R.h>
      2: 
      3: 
      4: extern "C" {
      5:   void filef2424e34d61 ( int * n, double * x );
      6: }
      7: 
      8: void filef2424e34d61 ( int * n, double * x ) {
      9: 
     10: integer i
     11: do 1 i=1, n(1)
     12: 1 x(i)=x(i)**3
     13: 
     14: }
    Error in compileCode(f, code, language, verbose) : 
      Compilation ERROR, function(s)/method(s) not created! 
    In addition: Warning message:
    running command 'C:/R/R-2.15.2/bin/x64/R CMD SHLIB filef2424e34d61.cpp 2> filef2424e34d61.cpp.err.txt' had status 1 
```

如果是缺少包骨架的构造：我尝试了简单的 rcpp_hello_world() 示例：

```
 rcpp_hello_world <- function(){

    .Call( "rcpp_hello_world", PACKAGE = "mypackage" )
    }

    Folder PATH listing for volume OS
    Volume serial number is 769C-A616
    C:. 
```

剩下的是一长串奇怪的符号，但我能读到的是我拥有的 c++ 项目的名称，我没有包括它们，因为它太长了

```
 rcpp_hello_world <-function(){

    .Call("rcpp_hello_world",PACKAGE="mypackage")

    }

    rcpp_hello_world()

    Error in .Call("rcpp_hello_world", PACKAGE = "mypackage") : 
      "rcpp_hello_world" not available for .Call() for package "mypackage" 
```

任何事情都会有所帮助，我也安装了 linux，所以如果这是一个更好的选择，请告诉我。我现在对任何事情都持开放态度，一点点进步都是一种喜悦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:26:44.900

你真的安装了 Fortran 编译器吗？

如果你不知道，或者你不知道，试试你的 Linux 机器。如果要使用 Rcpp 和内联构建， Windows 上的 R*必须*能够编译源包。一个好的快速测试是尝试类似的东西

```
R> myroot <- cppFunction('double myroot(double x) { return ::sqrt(x); }')
R> myroot(16)
[1] 4
R> 
```

或等效地通过内联（调用`rcpp`的包装器在哪里`cxxfunction(..., plugin="Rcpp")`，您需要最新的内联包）

```
R> myroot2 <- rcpp(signature(xs="numeric"), 
+                  body='double x=as<double>(xs); return wrap(::sqrt(x));')
R> myroot2(16)
[1] 4
R> 
```

如果这不起作用，请阅读安装 Rtools for Windows 等的 R 基础知识。我们在 Rcpp 常见问题解答中还有一些附加说明。

# php - 在 PHP 中使用数据库信息作为常量

> ID：14939475
> 
> 赞同：1
> 
> 时间：2013-02-18T15:15:23.173
> 
> 标签：php, mysql, database, constants

我不知道该怎么说，所以我会尽力而为。我正在尝试从我的数据库中的某个列中创建一个常量。它是什么网站，您可以在其中预订正在举行的某些活动。在数据库中，有一列表示特定场地的最大座位数（num_seats）。在网站上，它显示了剩余/可用座位的最大数量（当有人预订座位时减去数量）。我想要做的是，在一定数量的情况下，可用性从可用到有限再到无。“无”部分很简单，我正在寻找的是有限的。我希望在只有大约 1/3 的场地可用时将其更改为“有限”。

现在，当所有者输入座位数（我们会说 100）时，数据库填充 100，所以 1/3 大约是 34。我的问题是，当一个人注册时，数字会下降，所以 99 = 33, 90 = 31, 80 = 26。它总是会改变，所以如果我说：

```
if($num_seats < $row['num_seats'] / .33) {
    echo "Limited";
} 
```

这永远不会是真的，因为它总是在变化。我的问题（抱歉“啰嗦”）是，是否在我的 php 代码中将数字设为常量，或者将新列添加到数据库并命名为 max_num_seats 和另一个名称是否会更容易席位可用？

先谢谢了...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:28:06.287

使用两张表：一张用于存储座位总数的“所有者”，另一张用于预订。然后做你的加入/选择并弄清楚要显示的内容。

# c++ - 用于存储大量索引的数据结构，每个索引都指向一个集合

> ID：14939480
> 
> 赞同：1
> 
> 时间：2013-02-18T15:15:37.503
> 
> 标签：c++, memory-management, data-structures, map

我在 C++ (std::map) 中使用红黑树实现，但目前，我看到我的 unsigned long long int 索引变得越来越大，以进行更大的实验。我打算使用 700,000,000 个索引，每个索引都存储一个 std::set ，其中包含更多的 int 元素（大约 1-10 个）。我们有 128 GB 的 RAM，但我发现我们开始不够用了；事实上，如果可能的话，我什至想在我的实验中减少到 1,000,000,000 个索引。

我对此进行了一些思考，并且正在考虑将几张地图放在一起的森林。基本上，在映射达到某个大小阈值后（或者可能在开始抛出 bad_alloc 时），将其保存到磁盘，将其从内存中清除，然后创建另一个映射并继续执行，直到我得到所有索引。但是，在加载部分，这将非常低效，因为我们一次只能在 RAM 中保存一张地图。更糟糕的是，我们需要检查所有地图的一致性。

那么在这种情况下，我应该寻找哪些数据结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:29:37.430

看起来是时候切换到 B 树（可能是 B+ 或 B*）了——这种结构在数据库中用于管理索引。看看[这里](https://code.google.com/p/cpp-btree/)——这是对内部带有 btree 的类 std 关联容器的替代品......但是 btree 可用于将索引保存在内存和磁盘上......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T16:26:03.330

根据你的描述，我认为你有这个：

```
typedef std::map<long long, std::set<int>> MyMap; 
```

其中`map`非常大，而单个集合非常小。这里有几个开销来源：

*   中的各个条目`map`，每个条目都是单独的分配；
*   s中的各个条目`set`，同上；
*   描述每个的结构`set`，独立于它们的内容。

使用标准库组件，不可能消除所有这些开销；关联容器的语义很好地要求每个条目的单独分配，并且使用红黑树需要为每个条目添加几个指针（理论上，只需要两个指针，但是如果没有迭代器的有效实现是困难的父指针。）

`map`但是，您可以通过将 s与`set`s 组合使用这样的数据结构来减少开销而不会丢失功能：

```
typedef std::set<std::pair<long long, int>> MyMap; 
```

您仍然可以回答所有相同的查询，尽管其中一些不太方便。请记住，`std::pair`默认比较器按字典顺序排序，因此具有相同`first`值的所有元素都是连续的。因此，例如，您可以使用以下方法查询给定索引是否有任何`int`关联的 s：

```
it = theMap.lower_bound(std::make_pair(index, INT_MIN));
if (it != theMap.end() && it->first == index) {
  // there is at least one int associated with index
} 
```

相同的调用`lower_bound`将为您提供 int `s associate with the key, while a call to`upper_bound(std::make_pair(key, INT_MAX))` 的开始迭代器，将为您提供相应的结束迭代器，因此您可以轻松地迭代与给定键关联的所有值。

这可能仍然不足以在 128GB 中存储 7 亿个带有相关整数集的索引，除非平均集大小非常小。下一步必须是某种形式的 b 树，它不在标准库中。B-树通过将多个条目组合到一个集群中来避免单个条目的开销；这应该足以满足您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:28:22.977

对于如此大规模的数据集，您应该真正使用适当的[数据库服务器](http://en.wikipedia.org/wiki/Database_server)，例如**SQL 服务器**。这些服务器旨在处理缓存的大规模数据集。SQL 服务器将数据保存到诸如 HDD 之类的永久缓存中，同时通过缓存经常访问的页面等来保持良好的读/写性能。

# php - 如何在 PHP 中获取用户的经度和纬度？

> ID：14939481
> 
> 赞同：0
> 
> 时间：2013-02-18T15:15:37.343
> 
> 标签：php

我希望我的页面能够针对用户查看进行个性化，并且需要一些帮助来查找他们的经度和纬度，而不是将其设置为英国柴郡。

```
<?php
    $info = date_sun_info(mktime(0,0,0), 53.3761, -2.1897); // Cheshire UK

    $rise = new datetime(date('Y-m-d H:i:s', $info['sunrise']));
    $set = new datetime(date('Y-m-d H:i:s', $info['sunset']));

    list($daylightHrs, $daylightMins) = explode(':', $set->diff($rise)->format('%h:%i'));
    list($elapsedHrs, $elapsedMins) = explode(':', $rise->diff(new DateTime())->format('%h:%i'));

    $daylight = $daylightHrs*60 + $daylightMins;
    $elapsed = $elapsedHrs*60 + $elapsedMins;
    $percent = $elapsed*100/$daylight;

    printf('Rises: %s<br>Sets: %s<br>Day length: %d minutes<br>Day elapsed: %d minutes (%d%%)',
    $rise->format('H:i'),
    $set->format('H:i'),
    $daylight,
    $elapsed,
    $percent
    );
?> 
```

有人可以帮忙吗？我希望该页面能够告诉用户日出和日落，无论他们身在何处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:18:56.887

您将需要使用 GeoIP 数据库根据他们的 IP 地址查找纬度和经度。请记住，这可能不是很精确。虽然它可能会让一个国家正确，但它可能会在城市中消失。

# android - Android：以编程方式将多个视图添加到线性布局

> ID：14939482
> 
> 赞同：2
> 
> 时间：2013-02-18T15:15:41.927
> 
> 标签：android, android-edittext, android-linearlayout, android-view, dynamically-generated

我不确定如何处理。我需要线性布局，它需要有 20 多个 TextView 和 EditText 组件。我可以在顶部定义 ImageView 和按钮，但我不知道如何生成下面的其余组件，然后在最后放置一个按钮。

它看起来像这样：

```
---Button-----Button-------

--------ImageView----------

TextView -------- EditText

Item1.............[-------]

Item2.............[-------]

Item3.............[-------]

Item4.............[-------]

.

.

.

------------Button------------ 
```

确实会有很多组件，所以我想避免在 XML 中手动定义所有组件。单击按钮后，所有组件都需要成对保存“名称”：“值”（“Item1”：“EditText value”）。我有一个项目名称列表，用户将写入这些项目的值并将它们保存到 JSON 文件。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:33:34.273

你必须实现这样的类。

```
public class DetailedTicketSystemView extends LinearLayout 
{
    static int inc = 100;
    ArrayList<XmlScommessaInCorso> _viewData;
    ArrayList<xmlSistemaMovimenti> _systems;
    Context _context;

    public DetailedTicketSystemView(Context context, int res, AttributeSet attrs, ArrayList<XmlScommessaInCorso> viewData, ArrayList<xmlSistemaMovimenti> systems) 
    {
        super(context, attrs);

        _context = context;
        _viewData = viewData;
        _systems = systems;

        LayoutInflater.from(context).inflate(res, this, true);
        setId(inc);
        inc++;

        setLayout();
    }

    private void setLayout()
    {
        TextView textView;
        String text;

        for (int i = 0; i < _systems.size(); i++)
        {       
            View quotesView = (View) LayoutInflater.from(_context).inflate(R.layout.row_ticket_detail_system_layout, null, true);
            quotesView.setId(i);

            // System Id
            textView = (TextView) quotesView.findViewById(R.id.systemId);
            text = "" + _context.getString(R.string.id_sistema) + " " + _systems.get(i).getAttributeOrVoidString(xmlSistemaMovimenti.ATTR_id) +
                    " / " + _viewData.size();
            textView.setText(text);

            // System Columns
            textView = (TextView) quotesView.findViewById(R.id.systemColumns);
            text = "" + _context.getString(R.string.colonne) + " " + _systems.get(i).getAttributeOrVoidString(xmlSistemaMovimenti.ATTR_n_multiple_sis);
            textView.setText(text);

            // System Bet Text
            textView = (TextView) quotesView.findViewById(R.id.systemBetText);
            textView.setText(R.string.importoPerColonna);

            // System bet Value
            textView = (TextView) quotesView.findViewById(R.id.systemBetValue);
            text = "€ " + XmlScommessaInCorso.getQuotaFormattedOrVoid(_systems.get(i).getAttributeOrVoidString(xmlSistemaMovimenti.ATTR_impo_sistema));
            textView.setText(text);

            LinearLayout primaryLayout = (LinearLayout) findViewById(R.id.primaryLayout);
            primaryLayout.addView(quotesView);
        }
    }
} 
```

# git - 调试 git hook 的执行

> ID：14939484
> 
> 赞同：2
> 
> 时间：2013-02-18T15:15:44.287
> 
> 标签：git, groovy, githooks

我将如何设置我的开发环境来捕获断点并调试 git 钩子的执行？可以说重点钩子是预先提交的，并且需要调试以下 groovy 脚本？

```
#!/usr/bin/env groovy

// Arguments for git log command.
def logArgs = ['max-count': '1', 'pretty': 'format:%an commited %s {%h}']

// Invoke git log command.
def gitLog = logArgs.inject(['git', 'log']) { cmd, k, v -> 
    cmd << "--$k=$v" 
}.execute()

// Get git log message to be used as notification message.
def message = gitLog.text
println(message) 
```

我会怎么看输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T23:50:52.593

我建议您执行以下操作：

1.  创建一个`actual_hook_file.groovy`并将所有挂钩代码放在那里。
2.  在您现有的钩子中仅使用：`groovy -Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,address=9090,server=n,suspend=y actual_hook_file.groovy`
3.  触发钩
4.  `Remote Java Application in Eclipse`使用调试工具（例如）附加到 9090 端口上的 JVM 。
5.  调试！

因此，我们的想法是以调试模式运行 JVM（Java 可能与 Groovy 略有不同）。实现这一点的最简单方法是通过包装文件。

# c# - 如何在扩展管理器中卸载 Microsoft Web 开发人员工具

> ID：14939485
> 
> 赞同：8
> 
> 时间：2013-02-18T15:15:44.757
> 
> 标签：c#, visual-studio-2012

我的 VS 2012 Update 1 启动非常缓慢，即使我已经升级到 Update 2，它仍然是一样的。所以，我猜（可能是错误的）因为 VS 2012 中的一些扩展崩溃了，我无法卸载它们。

![在此处输入图像描述](../Images/18dc11390d5dcb516871fa5d13162dc2.png)

在图片上，我有 2 个扩展程序崩溃（卸载按钮被禁用）：

1.  微软网络开发工具。
2.  适用于 JavaScript 的 Windows 库的 Visual Studio 扩展。

有什么方法可以同时卸载两者吗？

我也按照右下角的提示在程序和功能中卸载，但我找不到。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-16T20:25:09.257

这里也有同样的问题。注册表搜索发现了卸载 Microsoft Web Developer Tools 2012.2 - Visual Studio 2012 的命令。这是 UninstallString：

```
MsiExec.exe /X{8762B098-374D-4900-B68E-34BF2840E694} 
```

只需复制到命令行（确保以管理员身份运行命令行）并按 Enter。

对于适用于 JavaScript 的 Windows 库的 Visual Studio Extensions，命令为：

```
MsiExec.exe /x{1228E4A3-8371-4F9B-BA6F-3D34113811B9} 
```

高温高压

# vb.net - 在 VB.NET 中准备查询

> ID：14939490
> 
> 赞同：1
> 
> 时间：2013-02-18T15:15:55.517
> 
> 标签：vb.net, parameters

**我在VB.NET**中准备带有 2 个参数的查询时遇到了麻烦。

这是我的代码：

```
Dim username As String = loginUsername.Value
Dim password As String = EncryptMD5standard(loginPassword.Value)
Dim valid As Boolean = False
Dim connectionString As String = ConfigurationManager.ConnectionStrings("myConnectionString").ConnectionString
        Dim queryString As String = "SELECT id, user_name, role FROM users WHERE user_name = '@user' AND paswd = '@pass'"
        Dim ds As New DataSet()
        Try
            Using connection As New SqlConnection(connectionString)
                Dim command As New SqlCommand(queryString, connection)
                connection.Open()
                command.CommandText = queryString
                command.Parameters.Add("@user", SqlDbType.NVarChar, 15).Value = username
                command.Parameters.Add("@pass", SqlDbType.NVarChar, 32).Value = password
                Dim adapter As New SqlDataAdapter()
                adapter.SelectCommand = command

                adapter.Fill(ds, "login")
                If ds.Tables("login").Rows.Count > 0 Then
                    valid = True
                End If
            End Using
        Catch ex As Exception
            errorLabel.Text = DirectCast(GetLocalResourceObject("erroreDB"), String) & ": " & ex.ToString
        End Try 
```

但是，通过这样做，我的`valid`值始终为“假”，因此行计数失败。我使用了一些调试，看起来我的表`login`里面`ds`是空的。查询有效，我在 SQLServer 替换参数中手动尝试过，但我不明白为什么我的结果为空。

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:18:42.283

您不需要将参数用单引号括起来，因为参数系统会处理这一点。

# javascript - jquery/javascript 创建注销计时器

> ID：14939504
> 
> 赞同：0
> 
> 时间：2013-02-18T15:16:26.753
> 
> 标签：javascript, jquery

我一直在尝试创建一个计时器，当他们成为偶像超过 10 分钟时，它将让我的客户退出。我已经创建了下面的代码，只要用户不打开第二个选项卡，它就可以正常工作。我有许多客户打开第二个窗口或选项卡，当第二个选项卡打开时，计数器加速。我正在寻找一种改进以下代码的方法，以便选项卡/窗口可以更好地同步。

```
var cookies='off'; // var to check if cookies are turned off
var alertTimes=0; // alturnative to cookies
$(function(){
    resetCookies();
    var loginTime=getCookie("loginTime");
    if (loginTime!=null && loginTime!=""){ cookies='on'; }
    checkAlerts();
});

function resetCookies(){
    setCookie("loginTime",'10',1);
    alertTimes=0;
}
function checkTime() {
    if(cookies=='on'){
        var loginTime=getCookie("loginTime");
        if (loginTime!=null && loginTime!=""){ 
            var newTime=loginTime-1;
            if(newTime==0){ autoLogout(); return false;}
            setCookie("loginTime",newTime,1);
        }else{ autoLogout(); return false;}
    }else{
        alertTimes++;
        if(alertTimes>=10){ autoLogout(); return false;}
    }
    setTimeout(checkTime, 600000);
}
function setCookie(c_name,value,exdays){
    var exdate=new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
    document.cookie=c_name + "=" + c_value;
}
function getCookie(c_name){
  var i,x,y,ARRcookies=document.cookie.split(";");
  for (i=0;i<ARRcookies.length;i++){
    x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
    y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
    x=x.replace(/^\s+|\s+$/g,"");
    if (x==c_name){ return unescape(y); }
  }
}
function autoLogout(){
    window.location.href=("logout.php");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:22:24.120

也许这个例子会满足你的需求？

```
( function ( $ ) {
  $.loginTimeout = function ( options ) {

    var opts = $.extend( {}, $.loginTimeout.defaults, options ),
    callback = function() {
      $.getJSON( opts.url, function ( data ) {
        if(data.status === "signed_out")
        document.location = opts.redirectTo;
      });
    };
    setInterval( callback, opts.timeout * 1000 );
  };

  $.loginTimeout.defaults = {
    timeout: 60,
    redirectTo: "/login",
    url: "/check_login"
  };
} ( jQuery ) );
// ...
$.loginTimeout({
  redirectTo: "/users/sign_in",
  url: "/users/check_status"
}); 
```

还请记住，在此示例中，服务器应用程序正在确定用户会话是否已过期

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T18:45:35.440

您提供的代码几乎就在那里。我的代码需要同样的东西。我在 cookie 中添加了信息（上次修改）并将其与当前时间进行比较。如果两者之间有足够的空间（在本例中为 1 秒），则修改 cookie 信息。即使您打开了 15 个选项卡，这也有效。
*我检查了他们是否打开了cookies。*

```
$(function(){
    resetCookies();
    setTimeout(checkTime, 1000);
});

function resetCookies(){
    setCookie("loginTime",'10',1);
}
function checkTime() {

    var arrloginTime=getCookie("loginTime").split("--");
    var loginTime=arrloginTime[0];
    var dtmLastMod=new Date(arrloginTime[1]);
    console.log(loginTime);
    if (loginTime!=null && loginTime!=""){ 
        var dtmNow = new Date();
        if ((dtmNow.getTime() - dtmLastMod.getTime()) >= 1000){
            var newTime=loginTime-1;
            if(newTime==0){ autoLogout(); return false;}
            setCookie("loginTime",newTime,1);
        }
    }else{ autoLogout(); return false;}
    setTimeout(checkTime, 1000);
}
function setCookie(c_name,value,exdays){
    var exdate=new Date();
    var dtmLastMod = new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + "--" + dtmLastMod + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
    document.cookie=c_name + "=" + c_value;
}
function getCookie(c_name){
  var i,x,y,ARRcookies=document.cookie.split(";");
  for (i=0;i<ARRcookies.length;i++){
    x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
    y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
    x=x.replace(/^\s+|\s+$/g,"");
    if (x==c_name){ return unescape(y); }
  }
}
function autoLogout(){
    console.log('You have been logged out of this document due to inactivity.');
} 
```

# android - android：如何从应用程序的 webview 中访问浏览器 cookie

> ID：14939508
> 
> 赞同：0
> 
> 时间：2013-02-18T15:16:34.503
> 
> 标签：android, cookies, webview

假设我访问了一些专门的网站 www.mysite.com，该网站在我的浏览器中放置了一个 cookie。稍后，我想在某个应用程序中使用该 cookie，该应用程序打开同一个网站的 web 视图，因此我可以以某种方式关联他用户通过浏览器完成的活动，以及他现在在本机应用程序的 WebView 中所做的活动.

可以共享这样的cookie吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T15:18:08.140

> 可以共享这样的cookie吗？

不，出于明显的隐私和安全原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-02T03:38:44.860

现在使用 OkHttpClient，您可以向浏览器发送请求并访问其 cookie

# asp.net-mvc - 通过 ajax 发布更新部分视图时更新主视图模型

> ID：14939509
> 
> 赞同：1
> 
> 时间：2013-02-18T15:16:40.540
> 
> 标签：asp.net-mvc, jquery, razor

我试图在通过 ajax 帖子更新部分视图时更新页面上的视图模型。部分视图正确更新，但在下一次更新调用时，模型似乎已恢复到原始状态。

部分视图是一个表，我正在添加或删除一行。该代码包含在有关如何完成此操作的任何想法下方。

页面代码是

*   ```
     <div class="filters">
                <fieldset class="source">
                    <legend>Search Attributes</legend>
                    <div id="attributes-filter">
                        @Html.Partial("_EditSearchQuery")
                    </div>
                </fieldset>
            </div>
            <div>              
                <a id="addRowLink" class="add-row-link" href="#">Add new clause</a>                
            </div>
        </div>
    </div> 
    ```

    -- 部分观点是

    ```
    <table id="searchClauses" class="clauses">
    <tbody>
        <tr class="header">
            <td class="add-remove"></td>                                                      
            <td class="logical">And/Or</td>
            <td class="field">Field</td>
            <td class="operator">Operator</td>
            <td class="value">Value</td>
        </tr>
            @foreach (SearchClause item in Model.searchClauses)
            { 
                <tr class="clause clause-row" id=@item.RowID>
                    <td class="add-remove">   
                        <a href="#" title="Remove this filter line" id=@item.ID >Delete</a>                      
                    </td>
                    <td>  
                        @Html.DropDownListFor(modelitem => item.logicalTypeValue, new SelectList(item.logicalTypeList, "Value", "Text", "Selected"), new { style = "width: 60px" })                                                                
                    </td>
                    <td>
                        @Html.DropDownListFor(modelitem => item.fieldListValue, new SelectList(item.fieldList, "Value", "Text", "Selected"))                               
                    </td>
                    <td>                              
                        @Html.DropDownListFor(modelitem => item.operatorListValue, new SelectList(item.operatorList, "Value", "Text", "Selected"), new { style = "width: 60px" })                    
                    </td>
                    <td>                               
                        @Html.TextBoxFor(modelitem => item.valuesList[0], new { style = "width: 130px" })
                    </td>
                </tr>    
            }                   
    </tbody> 
    ```

    - 脚本

    ```
    <script type="text/javascript">     
    $(function () {
        // Save quiz view - new or existing.
        $("#attributes-filter").on("click", "a", function () { // A jQuery delegated event - #EditQuiz is always present, a.SaveQuiz only exists when the _ElearningQuiz partial view is loaded.
            deleteRow($(this).attr("id"));
        });

        function deleteRow (id) {
            var rowData = {
                'id': id,
                'model' : @Html.Raw(Json.Encode(Model))
                };

            $.ajax({
                url: "/Participant/DeleteClause",
                type: "POST",
                data: JSON.stringify(rowData),
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    $("#attributes-filter").html(result);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert("Status: " + textStatus + " Error: " + errorThrown);
                }
            });
        };

        $("#addRowLink").click(function () {
            var model = @Html.Raw(Json.Encode(Model))

            $.ajax({
                url: "/Participant/AddClause",
                type: "POST",
                data: JSON.stringify(model),
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    $("#attributes-filter").html(result);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert("Status: " + textStatus + " Error: " + errorThrown);
                }
            });
        });
    }); 
    </script> 
    ```

    -- 控制器

    ```
    [HttpPost]
        public ActionResult AddClause(DynamicSearchModel model)
        {
            int campaignId = SessionManager.CampaignId;
            int clientId = SessionManager.ClientId;

            var newClause = _participantServiceClient.NewSearchClause(campaignId, clientId, 2);
            newClause.ID = model.searchClauses.Count + 1;

            model.searchClauses.Add(newClause);

            return PartialView("_EditSearchQuery", model);
        }

        [HttpPost]
        public ActionResult DeleteClause(string id, DynamicSearchModel model)
        {
            int _id = int.Parse(id);

            model.searchClauses.RemoveAt(_id - 1);

            return PartialView("_EditSearchQuery", model);
        } 
    ```

# xcode - ipad uisplitview：将数据从 masterviewcontroller 传递到 uiviewcontroller（通过 segue 重定向）

> ID：14939510
> 
> 赞同：0
> 
> 时间：2013-02-18T15:16:49.597
> 
> 标签：xcode, ipad, uitableview, uiviewcontroller, uisplitviewcontroller

我是 iOS 编程的新手，所以我想从头开始制作这个东西，以便能够理解整个东西是如何工作的。因此，我没有使用主详细信息模板，而是从头开始这样做。

在主视图和详细视图之间传递数据方面，我遇到了巨大的障碍。目前，每当我点击主视图的项目时，它都会在细节视图控制器上查找第一个视图，我们称之为`mainswitchviewcontroller`. 它是第一个`ViewController`通过 segue 连接到`UINavigationController`详细控制器部分（请参见下图）。

这发生在登录后显示`viewcontroller`，我希望用户在访问整个应用程序之前选择一个选项。这将引导他们进入`ViewController`流程的最后一个（请参阅下图 - 红色圆圈）。

![流程图](../Images/55420e29e226b6e2e6f954aa15bd47f7.png)

现在我想做的是：

```
@interface MasterListViewController : UITableViewController{
}

@property (nonatomic) int matNum;
@property (strong, nonatomic) DetailStaffMainContentViewController *detailViewController;
@end

:
:

@implementation MasterListViewController
@synthesize matNum;
:
:
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    for(UIViewController *vc in self.splitViewController.viewControllers){
        NSLog(@"%@)", vc.title);
    }

    self.detailViewController.teststring = @"gronk";
} 
```

这是我的 detailViewController（我想访问的那个）

```
@implementation DetailStaffMainContentViewController
@synthesize tableView;
@synthesize teststring;
@synthesize lblOutput; 
```

现在在选择行时，我分配了`teststring`我想用来填充控制器上的标签的行。这就是我所做的。

我的问题是：

1.  我收到一个错误。想知道我做错了什么？

    ```
    [MainSwitchBoardViewController setTeststring:]: unrecognized selector
    sent to instance 0x7572190 
    ```

2.  这是传递数据的推荐方式吗？还是我应该坚持使用通知中心？

想法？

**编辑** 只是为了让您了解应用程序的流程：

1.  用户登录（如果用户名不存在，会弹出浮动视图控制器并强制用户登录。

2.  一旦用户登录，弹出窗口就会消失，然后询问用户在当前会话中使用什么类型的角色（例如，职员或战士）。

3.  如果用户选择斗士，则将用户推到顶部 VC 如果用户选择人员，则将用户推到底部 VC（集合控制器）

4.  对于员工：目前我正在使用这个 [self perfermSegueWithIdentifier:sender:self] 推送到最后一个 VC

    一旦用户看到最后一个 VC (DetailsS​​taffView)，我希望这是用户进行交易的主要详细信息视图。还有几个弹出窗口？（或者可能需要为特定交易添加另一个推送到另一个 VC）。但最终我**不希望**用户访问第**一个 Viewcontroller (MasterSwitchBoard)**

**编辑 2** 这是控制登录后第一个 VC 的主交换机板类。

```
@interface MainSwitchBoardViewController : UIViewController{

}

@property (strong, nonatomic) IBOutlet UILabel *txtLabel;
- (IBAction)btnStaff:(id)sender;
- (IBAction)btnAdmin:(id)sender;

@end 
```

这是 atm 自动推送到最后一个 VC 的集合 VC。一开始我使用了一个通知，但似乎没有必要，所以我把它拿出来了。

```
@interface MatListCollectionViewController ()

@end

@implementation MatListCollectionViewController
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    [self performSegueWithIdentifier:@"SeguePushToStaffDetailFromMats" sender:self];
} 
```

然后是细节工作人员

```
@interface DetailStaffMainContentViewController : UIViewController{

}

@property (strong, nonatomic) IBOutlet UITableView *tableView;
@property (nonatomic, retain) IBOutlet UILabel *lblOutput;
@property (nonatomic, retain) NSString *teststring;

@end

    @implementation DetailStaffMainContentViewController
    @synthesize tableView;
    @synthesize teststring;
    @synthesize lblOutput; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T05:24:59.050

我将以相反的顺序处理这些问题：

> 这是传递数据的推荐方式吗？还是我应该坚持使用通知中心？

理论上你可以使用通知中心，但在这种情况下我不会。就个人而言，我只在以下情况下使用`NSNotificationCenter`：

*   我正在做异步过程，它没有合理的方式知道视图控制器的状态（例如，我有一些后台任务正在从服务器更新一些耗时的数据，并且用户可以导航到几乎任何地方在我准备好通知视图控制器更新完成时应用程序）；和/或

*   我可能有多个对象要通知某些事件。

这些条件都不适用于这里。当然你可以使用`NSNotificationCenter`，但这应该是不必要的。显式设置属性通常是可取的。

> 我收到一个错误。想知道我做错了什么？

不幸的是，根据您迄今为止提供的证据，很难说。但是根据您的代码和注释，我无法协调一些事情：

*   您已声明`detailViewController`为一个`DetailStaffMainContentViewController`（这就是您为其合成`teststring`访问器的类）；

*   但是您的错误消息表明这`detailViewController`显然是一个`MainSwitchBoardViewController`对象（它不理解`setTeststring`访问器方法）；和

*   你还没有向我们展示你是如何设置`detailViewController`的，所以很难说你在哪里出错了。

就个人而言，在这种情况下，我总是不愿定义属性来维护指向视图控制器的指针。我通常倾向于问分裂`UISplitViewController`中有什么。`detail`因此，在我的主视图控制器中，我没有一个类属性/ivar，而是有一个类似的方法：

```
- (UIViewController *)detailViewController
{
    return [[self.splitViewController.viewControllers lastObject] topViewController];
} 
```

这基本上是说“从我的拆分视图控制器的`viewControllers`（详细拆分）数组中获取最后一个对象，并且因为我（个人）总是在该详细拆分中使用导航控制器，所以让我们使用`topViewController`来获取指向我的子类的指针`UIViewController`，即详细信息拆分（嵌入在导航控制器中）。

然后我`didSelectRowAtIndexPath`检查该视图控制器是否是我所期望的。如果没有，我继续使用它（并将`prepareSegue`我想要的数据传递给该控制器）。

因此，例如，考虑这个故事板：

![示例故事板](../Images/11c5a4ba2fbfa352f305aa105e6f21f4.png)

在这里，“A”是我的默认细节控制器。“B”可能是我可能用“A”替换的一些随机场景。“C”是我真正的细节视图控制器，我可以在其中看到我从主视图控制器的表视图中选择的项目的详细信息。因此，我`didSelectRowAtIndexPath`的主视图控制器可能看起来像：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIViewController *controller = [self detailViewController];

    if (![controller isKindOfClass:[DetailCViewController class]])
    {
        // if I'm not already showing "C" in my detail split, then let's segue to it

        [self performSegueWithIdentifier:@"GoToC" sender:self];
    }
    else
    {
        // if I'm already showing "C" in my detail split, let's just set the item of data I want to pass to it

        DetailCViewController *cController = (DetailCViewController *)controller;

        cController.detailItem = self.objects[indexPath.row];
    }

    // I have a method I call to make sure that the popover menu for the master view
    // controller disappears (in case it popped up since I was in portrait mode) and
    // adds the master view controller button to the navigation bar if I need it.

    [self removePopoverAndAddNavigationButton];
} 
```

如果我需要转到“C”，我还让我的`prepareSegue 根据需要传递detailItem：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"GoToC"])
    {
        DetailCViewController *cController = (DetailCViewController *)[segue.destinationViewController topViewController];

        cController.detailItem = self.objects[[[self.tableView indexPathForSelectedRow] row]];
    }
} 
```

正如我所说，试图弄清楚为什么你`detailViewController`的对象类型错误很难说，但这就是我可能解决这样的事情的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:52:49.107

也许你应该先看看[上届 WWDC](https://developer.apple.com/videos/wwdc/2012/)上一些描述 Storyboard Segues 的好电影。

在您提供的代码中，没有任何关于 segue 的内容。请务必通过 IB 或以编程方式通过`[self performSegueWithIdentifier:]`. [请参阅 Apple 文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-DontLinkElementID_4)

然后你可以在你的视图控制器中提供额外的操作：

*   `[view shouldPerformSegueWithIdentifier:sender:]`
*   `[view prepareForSegue:sender:]`

第一个决定是否执行segue。第二个是在 segue 执行之前执行的。在第二个操作中，您可以向destinationViewController 提供信息。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"showIssuesByProject"]){
        if (_searchActive) {
            ((IssueListViewController *)segue.destinationViewController).project = [_filteredProjects projectAtIndex:[self.tableView indexPathForSelectedRow].row];
        } else {
            ((IssueListViewController *)segue.destinationViewController).project = [_projects projectAtIndex:[self.tableView indexPathForSelectedRow].row];
        }
    }
    if ([segue.identifier isEqualToString:@"showIssuesByFilter"]) {
        ((IssueListViewController *)segue.destinationViewController).filter = [_filters filterAtIndex:[self.tableView indexPathForSelectedRow].row];
    }
} 
```

注意： UISplitViewControll.viewControllers 只有两个控制器：主控制器和细节控制器。

# php - 如果加载失败，则为 Jquery 或 Ajax

> ID：14939514
> 
> 赞同：0
> 
> 时间：2013-02-18T15:17:01.460
> 
> 标签：php, jquery

当您使用 Jquery 或 Ajax 调用加载到 div 中的页面或脚本时，或示例

```
$.post('pagename.php', $(#cpay'.$id.'").serialize(), function(data) { $('#conSupp".$id."').html(data); 
```

如果页面加载失败，有没有办法在 div 中显示错误消息

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:20:32.300

如果您使用的是 jquery 1.5 或更高版本，该帖子将返回一个 jqXhr 对象。如果是这样，您可以执行以下操作：

```
$.post('pagename.php', data, function(data) {
    //success, do stuff with the data object
}).fail(function(jqXhr, ajaxOptions, thrownError){
    //something went wrong
    alert('Error: ' + thrownError);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:20:41.667

是的，通过调用调用返回[`.fail()`](http://api.jquery.com/jQuery.ajax/#jqXHR)的对象上的函数来绑定错误处理程序：`jqXhr``$.post()`

```
$.post(url, data, function(data) {
    ...
}).fail(function(jqXhr, textStatus, errorThrown) {
    // an error occurred - do something here
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:22:08.787

我更喜欢这样做：

```
$.ajax({
    type: 'POST',
    url : 'pagename.php',
    data: $(#cpay'.$id.').serialize()
}).done(function(data {
    $('#conSupp".$id."').html(data);
}).fail(function() {
    $('#conSupp".$id."').html('An error occured');
}); 
```

它有点长，但我发现阅读对我需要的任何内容的更改要容易得多，而且这正是 $.post 在内部所做的，所以为我节省了一个函数调用？

# c# - 带有信号量的 UnauthorizedAccessException

> ID：14939518
> 
> 赞同：3
> 
> 时间：2013-02-18T15:17:09.847
> 
> 标签：c#, semaphore

我正在创建一个信号量：

```
System.Security.Principal.SecurityIdentifier sid = new System.Security.Principal.SecurityIdentifier(System.Security.Principal.WellKnownSidType.WorldSid, null);
try
{
    bool createdNew;
    System.Security.AccessControl.SemaphoreSecurity semaphoreSecurity = new System.Security.AccessControl.SemaphoreSecurity();
    semaphoreSecurity.SetAccessRule(new System.Security.AccessControl.SemaphoreAccessRule(sid, System.Security.AccessControl.SemaphoreRights.FullControl, System.Security.AccessControl.AccessControlType.Allow));
    this.semaphore = new Semaphore(1, 1, semaphoreName, out createdNew, semaphoreSecurity);
    if (!this.semaphore.WaitOne(timeoutInMilliSeconds))
        throw new TimeoutException("Timeout while waiting " + semaphoreName + " semaphore (" + timeoutInMilliSeconds + " ms)");
}
catch (System.UnauthorizedAccessException e)
{
    this.semaphore = null;
    throw new UnauthorizedAccessException("Semaphore '" + semaphoreName + "'. " + e.Message);
}
catch
{
    this.semaphore = null;
    throw;
} 
```

并且在 Semaphore 构造函数中有 UnauthorizedAccessException 和下一条消息：

> 信号量'Global\Program.Req.Sem'。拒绝访问端口”

怎么了？如何解决？

附加信息：我猜它只发生在非管理员用户身上，即使他们是“管理员”组的成员。

# youtube-dl - Youtube-dl 错误

> ID：14939520
> 
> 赞同：0
> 
> 时间：2013-02-18T15:17:13.410
> 
> 标签：youtube-dl

尝试将 youtube-dl 与许多不同类型的 youtube 视频一起使用，但我不断收到“无法下载视频信息网页：HTTP 错误 500：内部服务器错误”消息：

```
>youtube-dl 'http://www.youtube.com/watch?v=t-eWAc1Knlw' -v

 [debug] youtube-dl version 2013.02.02
 [debug] Python version 2.7.3
 [debug] Proxy map: {}
 [youtube] Setting language
 [youtube] t-eWAc1Knlw: Downloading video webpage
 [youtube] t-eWAc1Knlw: Downloading video info webpage

ERROR: unable to download video info webpage: HTTP Error 500: Internal Server Error

File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
"__main__", fname, loader, pkg_name)
File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
exec code in run_globals
File "/usr/bin/youtube-dl/__main__.py", line 17, in <module>
youtube_dl.main()
File "/usr/bin/youtube-dl/youtube_dl/__init__.py", line 512, in main
_real_main()
File "/usr/bin/youtube-dl/youtube_dl/__init__.py", line 496, in _real_main
retcode = fd.download(all_urls)
File "/usr/bin/youtube-dl/youtube_dl/FileDownloader.py", line 505, in download
videos = ie.extract(url)
File "/usr/bin/youtube-dl/youtube_dl/InfoExtractors.py", line 93, in extract
return self._real_extract(url)
File "/usr/bin/youtube-dl/youtube_dl/InfoExtractors.py", line 397, in _real_extract
self._downloader.trouble(u'ERROR: unable to download video info webpage: %s' % compat_str(err))
File "/usr/bin/youtube-dl/youtube_dl/FileDownloader.py", line 230, in trouble
tb_data = traceback.format_list(traceback.extract_stack()) 
```

通过使用 --update 选项运行它，我已将 youtube-dl 更新到版本 2013.02.02（最新版本），但它仍然会产生相同的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-03T14:35:46.520

请重新安装 youtube-dl

```
sudo curl https://yt-dl.org/downloads/2014.03.03/youtube-dl -o /usr/local/bin/youtube-dl

sudo chmod a+x /usr/local/bin/youtube-dl 
```

更多信息：[http ://rg3.github.io/youtube-dl/download.html](http://rg3.github.io/youtube-dl/download.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-30T05:25:44.417

**尝试重新安装您的 youtube-dl**

1.先更新

```
sudo apt-get update 
```

2.然后删除现有的 youtube-dl

```
sudo apt-get remove youtube-dl 
```

3.然后重新安装

```
sudo apt-get install youtube-dl 
```

您现在应该可以再次通过 youtube-dl 下载 youtube 视频

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-04T03:51:48.900

我试过你的答案

```
sudo curl https://yt-dl.org/downloads/2014.03.03/youtube-dl -o /usr/local/bin/youtube-dl

sudo chmod a+x /usr/local/bin/youtube-dl 
```

当我尝试下载视频时，它就停在这里

[youtube] B07iK9uh9qY：下载js播放器vfl4_saJa

我尝试了几个不同的视频

更新：

我跑了

```
/usr/local/bin/youtube-dl -U 
```

现在它再次下载视频。谢谢你的帮助 ：）

# excel - 锁定具有宏的 Excel 工作表

> ID：14939526
> 
> 赞同：1
> 
> 时间：2013-02-18T15:17:28.427
> 
> 标签：excel, vba

我已经锁定了几个单元格和工作表，并且我有一个用于工作表的宏，但是我找不到锁定工作表并同时运行宏的方法。每次我尝试在宏被锁定时运行宏都会给我一个错误。

```
 Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim g As Long
Dim r As Long
Dim y As Long
Dim overallhealth As Range
Dim varaincerange As Range
Set varaincerange = Sheets("D").Range("B5:B9")
Set overallhealth = Sheets("D").Range("B4")
y = Application.WorksheetFunction.CountIf(varaincerange, "y")
g = Application.WorksheetFunction.CountIf(varaincerange, "g")
r = Application.WorksheetFunction.CountIf(varaincerange, "r")
If g = 5 Then
overallhealth = "G"
ElseIf g = 4 And y = 1 Then
overallhealth = "G"
ElseIf r >= 2 Then
overallhealth = "R"
ElseIf y = 1 And r = 1 Then
overallhealth = "Y"
ElseIf y > 1 And r >= 1 Then
overallhealth = "R"
ElseIf y = 1 And r > 1 Then
overallhealth = "R"
ElseIf y >= 3 Then
overallhealth = "R"
ElseIf g = 3 And y = 2 Then
overallhealth = "Y"
ElseIf g = 4 And r = 1 Then
overallhealth = "Y"
End If
End Sub 
```

如何在单元格和工作表被锁定和保护时运行宏？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:24:01.543

您可以简单地在宏的开头取消保护它

```
表格（“D”）。取消保护“密码”
```

最后用

```
表格（“D”）。保护“密码”
```

# asp.net-mvc-3 - 使用 ISA 公开内部 MVC 网站

> ID：14939528
> 
> 赞同：0
> 
> 时间：2013-02-18T15:17:38.167
> 
> 标签：asp.net-mvc-3, iis-7, instruction-set

我们有一个运行 MVC3 应用程序的**内部服务器**，它已通过使用 ISA 服务器在我们的**外部服务器上可用。**

然而; 它没有应用 CSS，因为对外部站点的引用未正确映射。

我可以看到，两者之间的主要区别在于它在**内部**作为应用程序在内部服务器上运行（`http://InternalServer/MVCSite`）

**外部服务器**被视为在子站点 ( ) 中作为应用程序运行`http://ExternalDomain/SubSite/MVCSite`，这就是世界所得到的。

查看生成的 URL 的源代码，我可以看到它的行为类似于**内部站点**，返回：`@Url.Content("~/Content/Site.css")`as `/MVCSite/Content/Site.css`。

我一直在看这篇文章，看看它是否能说明问题：http: [//support.microsoft.com/kb/885186](http://support.microsoft.com/kb/885186)

我认为可能是重定向无法处理站点结构的差异？因此，修改内部站点以反映外部布局将修复任何用途。内部`InternalServer/MVCSite`变成`ExternalDomain/SubSite/MVCSite`

当我发现事情时，我会添加更多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:01:38.617

这个答案与 isa 无关，并且可能有一种正确的方法来配置它。但是，如果您找不到正确的解决方案，`HttpRuntime.AppDomainAppVirtualPath`可能会对您有所帮助。

而不是使用: `@Url.Content("~/Content/Site.css")`，您可以尝试`@Url.Content(HttpRuntime.AppDomainAppVirtualPath + "Content/Site.css")`

如果这不起作用，您可以使用反射覆盖 AppDomainAppVirtualPath 的值。看看这里：[http](http://www.experts-exchange.com/Programming/Languages/.NET/ASP.NET/Q_24475811.html#a24591595) ://www.experts-exchange.com/Programming/Languages/.NET/ASP.NET/Q_24475811.html#a24591595 。

```
Dim vpathTypeName As String = "System.Web.VirtualPath, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
Dim virtualPath As Object = ReflectionHelper.Instantiate(vpathTypeName, New Type() {GetType(String)}, New Object() {"/"})
ReflectionHelper.SetPrivateInstanceFieldValue("_appDomainAppVPath", runtime, virtualPath) 
```

它基本上用你需要的任何值更新一个静态字段。您可以使用 : 验证主机标头`HttpContext.Current.Request.Url.Host`并将值设置为`/`或`/SubSite/`

# jquery - jquery ui dilog 关闭点击

> ID：14939529
> 
> 赞同：0
> 
> 时间：2013-02-18T15:17:40.780
> 
> 标签：jquery, jquery-ui

我创建 jQuery UI 对话，如果显示，当我点击它时关闭

```
 $('#myDial').dialog({
        autoOpen: false,
        resizable: false,
        width: 230,
        height: 170,
        modal: false,
        open: function() {
            window.closedialog = 1;
            $(document).bind('click', function(){
                if (window.closedialog) {
                    $('#myDial').dialog('close');
                }
                //set to one because click on dialog box sets to zero
                window.closedialog = 1;
            });
        },
        focus: function() {
            window.closedialog = 0;
        },
        close: function() {
            $(document).unbind('click');
        }

    }) 
```

行。

**我的问题：当我点击退出时，对话框**是否存在关闭它的任何方法或选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T16:03:29.117

您可以使用 jQuery 上下文菜单

[https://github.com/medialize/jQuery-contextMenu](https://github.com/medialize/jQuery-contextMenu)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:35:27.483

这个功能对我来说只有模式对话框才有意义。您可以在对话框周围的叠加层上使用点击事件：

```
$('.ui-widget-overlay').on("click", function() {
    $(document).find(".dialog").dialog("close");
}); 
```

# sql - PostGIS 的自联接查询问题

> ID：14939533
> 
> 赞同：2
> 
> 时间：2013-02-18T15:17:59.810
> 
> 标签：sql, geospatial, postgis

我有一张桌子，我正在使用 PostgreSQL 的地理空间功能对其进行自我连接。现在我期望建立每个交叉点的交叉点，除了那些具有相同值的属性“tunnel_road”的交叉点。

因此，我有两行包含值“隧道”，我不想在它们之间建立一个交点。

我正在使用的查询如下，尽管它无法正常工作，因为它仍在两条线之间创建一个交点。

```
insert into temp_intersect
select nextval('road_intersection_id_seq'), a.road_id, b.road_id, st_intersection(a.road, b.road), st_centroid(st_intersection(a.road, b.road))
from polygon_road a, polygon_road b
where st_intersects(a.road, b.road) AND a.road_id < b.road_id AND a.tunnel_road != b.tunnel_road 
```

请问有什么建议吗？

以下是我从中获取数据的表。可以注意到有两行包含相同值的 tunnel_road 列，其中 id = 47 和 73

![在此处输入图像描述](../Images/8324fc234e563ae1f0dcbd6d120489a1.png)

# ios - ios 6 iPhone window.rootViewController 崩溃

> ID：14939536
> 
> 赞同：0
> 
> 时间：2013-02-18T15:18:10.693
> 
> 标签：ios, uiwindow

我的应用程序在 iPad 和 iPhone 上都可以在 iOS 5.1 上正常运行。在 iOS 6 中，应用程序在 iPad 上运行良好，但在设置`window.rootViewController = navigationViewController`. 我已经设置了异常断点，它在`application didFinishLaunchingWithOptions`. 我什至尝试添加它，`[window addSubView:navigationViewController.view]`但没有运气。有没有人遇到过类似的问题。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:    (NSDictionary *)launchOptions
{
     self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
     rootViewController = [[SpringboardViewController alloc] initWithNibName:@"SpringboardViewController" bundle:nil];   
     UINavigationController *nav = [[UINavigationController alloc] initWithRootViewController:rootViewController];

    self.window.rootViewController = nav;
    self.window makeKeyAndVisible];
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T06:14:10.247

你能写一个例外吗？

看看这些问题

[预期具有根视图控制器控制台的应用程序](https://stackoverflow.com/questions/8190567/applications-expected-to-have-a-root-view-controller-console)

[应用程序在应用程序启动结束时应该有一个根视图控制器](https://stackoverflow.com/questions/7520971/applications-are-expected-to-have-a-root-view-controller-at-the-end-of-applicati)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T07:33:39.880

感谢您的回复，我发现了问题，问题出`application supportedInterfaceOrientationsForWindow`在我返回的位置，`UIInterfaceOrientationPortrait`而不是`UIInterfaceOrientationMaskPortrait`因为应用程序调试器在**self.window.rootViewController = nav**处被击中，我认为问题出在这个语句上。

感谢拉文达兰和食人魔。

# html-agility-pack - 从具有跨度类的表中选择两个单元格

> ID：14939539
> 
> 赞同：1
> 
> 时间：2013-02-18T15:18:20.537
> 
> 标签：html-agility-pack

如何根据跨度类选择表中的两个单元格？我的 html 看起来像这样。我想要的是选择 span class="store-name-span" 和 span class="price" 的内部文本

```
<table class="list mixed zebra-striped">
<tbody>

    <tr data-pris_typ="normal">

        <td class="span4-5">
            <span class="store-name-span">Electroworld</span>
            <a data-drg="store-2641" class="drg-sidebar"></a>
        </td>

        <td class="span3 cell-bar">
            <span class="chart-bar price" style="width:50px"></span>
            <span class="price" title="Uppdaterad 2013-02-18 08:23">1&nbsp;690:-</span>
        </td>

    </tr>
        <tr data-pris_typ="normal">

        <td class="span4-5">
            <span class="store-name-span">Webhallen</span>
            <a data-drg="store-113" class="drg-sidebar"</a>
        </td>

        <td class="span3 cell-bar">
            <span class="chart-bar price" style="width:50px"></span>
            <span class="price" title="Uppdaterad 2013-02-18 13:55">1&nbsp;690:-</span>
        </td>
</tr>
</tbody>
</table>

var Nodes = from x in doc2.DocumentNode.Descendants()
                        //where x.Attributes["class"].Value == "store-name-span"
                        where x.Name == "span" && x.Attributes["class"].Value == "store-name-span"
                        select x.InnerText; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:45:40.513

我会为此使用xpath：

```
var nodes = doc.DocumentNode.SelectNodes("//span[@class='store-name-span' or @class='price']");
foreach (var node in nodes)
    Console.WriteLine(node.InnerText); 
```

通过使用 LINQ：

```
var nodes = doc.DocumentNode.Descendants("span")
    .Where(s => 
        s.GetAttributeValue("class", null) == "store-name-span" || 
        s.GetAttributeValue("class", null) == "price"
    ); 
```

这会让你：

```
Electroworld
1&nbsp;690:-
Webhallen
1&nbsp;690:- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:44:29.193

我会使用[querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelector)和获取 innerHTML 的组合。

查询选择器既适用于全局调用（在文档上），也适用于单个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T02:10:47.757

在该特定的 HTML 布局中，您可以执行以下操作：

```
var items = doc.DocumentNode.SelectNodes("//tr[@data-pris_typ='normal']").Select(x => new
    {
        Store = x.SelectSingleNode(".//span[@class='store-name-span']").InnerText,
        Price = x.SelectSingleNode(".//span[@class='price']").InnerText
    }); 
```

`items`你会得到你需要的东西。每个项目都将是一个带有`Store`and`Price`字段的匿名类型。

**一件重要的事：**

您可能想`Price`使用`HttpUtility.HtmlDecode()`. 为此，您必须添加对`System.Web`程序集的引用。

# java - 在设备之间建立蓝牙连接

> ID：14939541
> 
> 赞同：0
> 
> 时间：2013-02-18T15:18:25.000
> 
> 标签：java, android, eclipse, bluetooth

我对java很陌生，目前正在做一个项目。我已经设法从我的应用程序中打开和关闭蓝牙。我还有一个包含配对设备列表的列表视图。我创建了一个“onListItemClick”方法。但是，我似乎无法弄清楚如何与其中一个配对设备建立连接。任何帮助，将不胜感激。谢谢你。

```
import java.util.Set;
import android.app.ListActivity;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class Devices extends ListActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    ArrayAdapter<String> btArrayAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
    BluetoothAdapter btAdapter = BluetoothAdapter.getDefaultAdapter();
    Set<BluetoothDevice> pairedDevices = btAdapter.getBondedDevices();

    if(pairedDevices.size()>0){
        for (BluetoothDevice device :pairedDevices){
            String name = device.getName();
            btArrayAdapter.add(name);
        }
    }

    setListAdapter(btArrayAdapter);
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {

    super.onListItemClick(l, v, position, id);

        //Here, I want to establish a connection with the device chosen by the user

}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:48:35.800

我为你做了例子：

```
 public class MainActivity extends Activity{
       private BluetoothAdapter mBluetoothAdapter;
       private ArrayAdapter<String> mPairedDevicesArrayAdapter;
       private ListView PairedListView;
       private BluetoothService mBluetoothService = null;

      public void onCreate(Bundle savedInstanceState){
         super.onCreate(savedInstanceState);
         setContentView(R.layout.layout);
         mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
         // Initialize ArrayAdapter for paired devices
         mPairedDevicesArrayAdapter = new ArrayAdapter<String>(this, R.layout.device_name);
         PairedListView = (ListView)findViewById(R.id.listView_paired_devices);
         PairedListView.setAdapter(mPairedDevicesArrayAdapter);
         PairedListView.setOnItemClickListener(this);
         getPairedDevices();
      }

      private void getPairedDevices(){
          // Get a set of currently paired devices
          Set<BluetoothDevice> pairedDevices = mBluetoothAdapter.getBondedDevices();
          // If there are paired devices, add each one to the ArrayAdapter
               if (pairedDevices.size() > 0) {

                   for (BluetoothDevice device : pairedDevices) {
                       // Add paired devices to ArrayAdapter
                       // ArrayAdapter will be connected to LisView
                       mPairedDevicesArrayAdapter.add(device.getName() + "\n" + device.getAddress());
                       }
               } else {
                   String noDevices = getResources().getText(R.string.title_none_paired).toString();
                   mPairedDevicesArrayAdapter.add(noDevices);
               }

           }

    }

@Override
public void onItemClick(AdapterView<?> av, View v, int arg2, long arg3) {
    // Cancel discovery because it's costly and we're about to connect
    mBluetoothAdapter.cancelDiscovery();
    // Get the device MAC address, which is the last 17 chars in the View
    String info = ((TextView) v).getText().toString();
    String adress = info.substring(info.length() -17);

    BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(adress);
    // Attempt to connect to the given bluetooth device in separate thread
    // Reason for this is because connecting and sending bytes are blocking calls
    mBluetoothService.connect(device);

}

public class BluetoothService {
   // Unique UUID for this application
    private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); 
private ConnectThread mConnectThread;
    private ConnectedThread mConnectedThread;
    private BluetoothAdapter mBluetoothAdapter;

    public synchronized void connect(BluetoothDevice device){
        // Start ConnectThread to connect to given device
        mConnectThread = new ConnectThread(device);
        mConnectThread.start();

    }
        private class ConnectThread extends Thread {
        private final BluetoothSocket mBluetoothSocket;
        private final BluetoothDevice mBluetoothDevice;

        public ConnectThread(BluetoothDevice device){
            // Use a temporary object that is later assigned to mmSocket,
            // because mmSocket is final
            mBluetoothDevice = device;
            BluetoothSocket tmp = null;
            // Get a BluetoothSocket to connect with the given BluetoothDevice
            try{
                // MY_UUID is the app's UUID string
                tmp = device.createInsecureRfcommSocketToServiceRecord(MY_UUID);
            } catch (IOException e){

            }
            mBluetoothSocket = tmp;
        }

        public void run(){
            // Because BuluetoothAdapter.discovery() is 
            // heavy weight procedure, cancel any on
            // going discovery before attempting to connect
            mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
            mBluetoothAdapter.cancelDiscovery();
            // Connect the device through the socket. This is blocking call so it
            // will return on a successful connection or an exception

            // Make a connection to the BluetoothSocket
            try {
                // Connect the device through the socket. This is blocking call so it
                // will return on a successful connection or an exception
                mBluetoothSocket.connect();
            } catch (IOException e) {
                try {
                    // Unable to connect, close the socket and get out
                    mBluetoothSocket.close();
                    setState(STATE_CONNECTION_FAILED);
                } catch (IOException e1) {
                    e1.printStackTrace();
                }
            }
            // Reset the ConnectThread because we're done
            synchronized (BluetoothService.this) {
                mConnectThread = null; 
            }
            // Do work to manage the connection (in a separate thread)
            if(mBluetoothSocket.isConnected()){
            connected(mBluetoothSocket, mBluetoothDevice); }
        }

        public void cancel(){
        // This method will cancel an in-progress connection and close the socket
            try {
                mBluetoothSocket.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }
} 
```

# multithreading - 具有多线程的 Lucene NIOFSDirectory 和 SimpleFSDirectory

> ID：14939556
> 
> 赞同：3
> 
> 时间：2013-02-18T15:18:52.857
> 
> 标签：multithreading, lucene, niofsdirectory

我的基本问题是：当有多个线程需要对同一索引进行查询（读取）时，创建/使用 NIOFSDirectory 和 SimpleFSDirectory 实例的正确方法是什么。更重要的是：应该为每个需要执行查询并检索一些结果的线程创建一个 XXXFSDirectory 的实例（然后在同一个线程中立即关闭它），还是应该创建一个“全局”（单例?) 传递给所有线程的实例，然后它们都同时使用它（并且不再由每个线程在完成查询时关闭它）？

这里有更多细节：

我已经阅读了 NIOFSDirectory 和 SimpleFSDirectory 的文档，我得到的是：

*   它们都支持多线程：

NIOFSDirectory ：“*使用 java.nio 的 FileChannel 的位置读取的 FSDirectory 实现，它允许多个线程从同一个文件中读取而无需同步。* ”

SimpleFSDirectory ：“*使用 java.io.RandomAccessFile 的 FSDirectory 的简单实现。但是，此类具有较差的并发性能（多线程将成为瓶颈），因为当多个线程从同一个文件中读取时它会同步。通常最好使用 NIOFSDirectory 或 MMapDirectory 。* ”

*   NIOFSDirectory 在多线程上下文中比 SimpleFSDirectory 更适合（基本上更快）（见上文）

*   NIOFSDIrectory 在 Windows 上无法正常工作。建议在 Windows 上使用 SimpleFSDirectory。但是在 *nix OS NIOFSDIrectory 上工作正常，并且由于多线程时性能更好，建议在 SimpleFSDirectory 上使用。

"*注意：不建议在 Windows 上使用 NIOFSDirectory，因为在 Sun 的 JRE 中实现 FileChannel.read 的方式存在错误。在实现内部，位置显然是同步的。* "

我问这个的原因是我看过一些实际的项目，其中目标操作系统是 Linux，NIOFSDirectory 用于从索引中读取，但它的一个实例是为每个请求（来自每个线程）创建的，并且一旦查询完成并返回结果，线程就会关闭该实例（仅在下一个请求时创建一个新实例，等等）。所以我想知道这是否真的比简单地让所有线程共享一个 NIOFSDirectory 实例更好的方法，并且只是在应用程序启动时打开它，然后在某个（多线程）作业完成后关闭它。 ..

更重要的是，对于 Web 应用程序，拥有一个上下文侦听器之类的东西不是更好吗当应用程序关闭时关闭它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:28:10.200

[Lucene 官方常见问题解答](http://wiki.apache.org/lucene-java/ImproveSearchingSpeed)建议如下：

> 跨查询和应用程序中的线程共享单个 IndexSearcher。

`IndexSearcher`需要 single `IndexReader`，后者可以用 a 生成`DirectoryReader.open(Directory)`，它只需要 . 的单个实例`Directory`。

# jquery - 图片库 - Jquery Mobile

> ID：14939560
> 
> 赞同：1
> 
> 时间：2013-02-18T15:19:00.160
> 
> 标签：jquery, jquery-mobile, swipe

我正在使用 Jquery Mobile 制作我的图片库。我已成功创建了此[链接](http://jsfiddle.net/Gajotres/NV6Py/)中的内容。我在这样的代码中替换图像而不是“文章”......

```
> <image data-role="page" id="article1">
>     <div data-role="header" data-theme="b" data-position="fixed" data-id="footer">
>       <h1>Image1</h1>
>     </div>
>     <div data-role="content">
>       <img src=im1.jpg/>
>     </div>
>     <div data-role="footer" data-theme="b" data-position="fixed" data-id="footer">
>       <h1>Footer</h1>    
>     </div>   </Image> 
```

现在我需要已替换​​的“图像”左右两侧的图像。它也应该使用滑动事件。谁能告诉我我该怎么做？

# c++ - 获取APDU请求错误c ++

> ID：14939565
> 
> 赞同：0
> 
> 时间：2013-02-18T15:19:44.870
> 
> 标签：c++, smartcard, apdu

所以.. 我有 pcsc 阅读器、智能卡和 C++ 代码。寻找读者，选择他们，联系并获得 ATR - 工作得很好。

但是在 ATR-get 之后我需要获取 APDU 请求，这段代码

```
SCARD_IO_REQUEST ioRecv;
byte  pbRecvBuffer[255]; 
int pbRecvLength=255;
byte   pbSendBuffer[] ={ 0x00, 0xb0, 0x00, 0x00}; //any comand
int cbSendLength = sizeof(pbSendBuffer);//size of comand
ioRecv.cbPciLength = 255;
DWORD  dwSize=255; 

//our Transmit those return error
lReturn = SCardTransmit(hSC,
                        (LPCSCARD_IO_REQUEST)dwAP,
                        pbSendBuffer,
                cbSendLength,
                        NULL,
                        pbRecvBuffer,
                        &dwSize);

if(lReturn==SCARD_S_SUCCESS){
//do smt with pbRecvBuffer   
printf("success");
}
else {
    printf("error "); 
} 
```

总是返回“错误”......如果你能帮助我或指出我的错误，我将非常感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:14:11.213

> 在 SCardTransmit() 的第一个参数中发现错误 - 根据 MSDN 在 SCardTransmit() 中的描述不需要传递 hSC。所以必须通过 m_hCardHandle 从 SCardConnect() 接收。通过 (LPCSCARD_IO_REQUEST)dwAP 也是错误的

是的。它已经解决了问题

# c - 我可以在同一个字符串上多次调用 sscanf 吗？

> ID：14939571
> 
> 赞同：2
> 
> 时间：2013-02-18T15:20:23.780
> 
> 标签：c, scanf

我正在尝试从文件中读取一行，我`line`使用`fgets`. 然后我尝试使用`sscanf`它来解析它。有时我会打电话`sscanf`发现它返回的参数数量错误。那么我会尝试重新解析相同的`line`字符串。有时有效，有时无效（这让我相信问题不`sscanf`在于我的代码中的其他问题）。这是我的意思的一个例子：

```
i = sscanf(line,"%d/%d/%d %d/%d/%d %d/%d/%d %d/%d/%d\n", &faceV1, &faceUV1, &faceN1, &faceV2, &faceUV2, &faceN2, &faceV3, &faceUV3, &faceN3,
                &faceV4, &faceUV4, &faceN4);

if(i == 12) {
    //We gotta quad...
    printf("Model.c: Quads not supported\n");
} else if(sscanf(line,"%d/%d/%d %d/%d/%d %d/%d/%d\n", &faceV1, &faceUV1, &faceN1, &faceV2, &faceUV2, &faceN2, &faceV3, &faceUV3, &faceN3) == 9) {
    //Doesn't do what I expect!
    ... 
```

但是，如果我摆脱`i = sscanf...`并检查`i == 12`并直接进入`if(sscanf(line,"%d/%d/%d %d/%d/%d %d/%d/%d\n", &faceV1, &faceUV1, &faceN1, &faceV2, &faceUV2, &faceN2, &faceV3, &faceUV3, &faceN3) == 9)`它将按预期工作。

那么回到这个问题的标题，我可以`sccanf`在同一个字符串上多次调用吗？我叫错了吗？或者我应该在我的代码中的其他地方寻找问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T16:27:13.047

简短回答是的，您可以多次扫描相同的字符串。

您的问题是在您的字符串中包含“\n”并不符合您的预期......它匹配任何空白字符空间、制表符、\r，而不仅仅是\n。

所以你需要在scanf'ing之后检查行尾。

# php - foreach ($_POST)

> ID：14939574
> 
> 赞同：0
> 
> 时间：2013-02-18T15:20:32.760
> 
> 标签：php, arrays, foreach

所以我在表单中使用了多个复选框并毫无问题地查询数据库。现在我想添加一个下拉列表并将其与带有复选框的查询结合起来。当我运行这个时，我得到一个

```
 Warning: Invalid argument supplied for foreach() 
```

这是我的表格

```
 <form name="search_form" method="post" action="event_list">
     <table>
     <tr>
     <td>Venue</td>
     <td><input type="checkbox" name="check_list[]" value="AAC"><label >AAC</label><br />
     <input type="checkbox" name="check_list[]" action="" value="AKC" id="check_list[]"/><label >AKC</label><br />
     <input type="checkbox" name="check_list[]" action="" value="ASCA"/><label >ASCA</label><br />
     <input type="checkbox" name="check_list[]" action="" value="CKE"/><label >CKE</label><br />
     <input type="checkbox" name="check_list[]" action="" value="CPE"/><label >CPE</label><br />
     <input type="checkbox" name="check_list[]" action="" value="DOCNA"/><label >DOCNA</label><br />
     <input type="checkbox" name="check_list[]" value="NADAC"><label >NADAC</label><br />
     <input type="checkbox" name="check_list[]" action="" value="TDAA"/><label >TDAA</label><br />
     <input type="checkbox" name="check_list[]" action="" value="UKC"/><label >UKC</label><br />
     <input type="checkbox" name="check_list[]" action="" value="UKI"/><label >UKI</label><br />
     <input type="checkbox" name="check_list[]" action="" value="USDAA"/><label >USDAA</label><br />
     </td>
     </tr>
     <tr>
     <td style="text-align: left;">State:</td>
     <td style="text-align: left;">
     <select name="state" id="state" onChange="setCities();">
     <option name="drop_down[]" value="Alabama">Alabama</option>
     <option name="drop_down[]" value="Texas">Texas</option>
     </select>
     </td>
     </tr>
     <td align="right"><input type="submit" name="submit" value="Submit"></td>
     </tr>
     </table>
     </form> 
```

这是我的PHP

```
 <?php 
     $options = Array();
     $options2 = Array();
     foreach ($_POST['check_list'] as $check)
     $options[] = 'venue=' . "'$check'"; 

     foreach ($_POST['drop_down'] as $drop)
     $options2[] = 'state=' . "'$drop'";

     $sql = "SELECT * FROM venue_event_all";
     if (count($options))
     $sql .= " WHERE " . implode(' OR ', $options);
     if (count($options2))
     $sql .= " AND " . implode(' OR ', $options2);

    $result=mysql_query($sql) or die(mysql_error());

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:27:40.240

在`<select>`输入中， 的值`<option>`与选择的名称配对发送到 POST/GET。

`name`在自身上设置 a`option`不会做任何事情。下拉值仍将与选择的名称一起使用。

您可以使用它来检查它

```
echo $_POST['state']; 
```

因此，使用此值设置到您的查询中。

编辑：强制 - 请不要使用 MySQL，因为它已被弃用并且不再由 PHP 维护。使用 MySQLi 或 PDO。此外，请在查询中使用之前清理您的输入。[当你不这样做时，就会发生这种情况。](http://bobby-tables.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:27:48.890

如果数组为空或未设置，foreach 将显示错误，因此您需要先检查它：

```
if(isset($_POST[0]) and count($_POST) > 0)
{
 foreach...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:40:09.627

我不会只对sql注入进行咆哮，而是给你一个解决方案。使用合理数量的代码使查询**安全**
的唯一方法是[safeMysql](https://github.com/colshrapnel/safemysql/blob/master/safemysql.class.php)库（基于 Jeffrey 代码，未经测试，但可在生产中自由使用）：

 **```
<?php 
include 'safemysql.class.php';
$db = new SafeMysql();
$options = array();

if (!empty($_POST['check_list'])) {
    $options[] = $db->parse('venue IN (?a)', $_POST['check_list']);
}
if (!empty($_POST['drop_down'])) {
    $options[] = $db->parse('state IN (?a)', $_POST['drop_down']);
}
$sql = "SELECT * FROM venue_event_all";
if ($options) {
    $sql .= " WHERE " . implode(' AND ', $options);
}
$data = $db->getAll($sql); 
```**

# c++ - Eclipse、C++ 和 Mysql

> ID：14939576
> 
> 赞同：0
> 
> 时间：2013-02-18T15:20:41.237
> 
> 标签：c++, mysql, eclipse, eclipse-cdt, ubuntu-12.04

我正在阅读以下文章[使用 Eclipse CDT 开发 MySQL 应用程序](http://ftp.nchu.edu.tw/MySQL/tech-resources/articles/mysql-capi-tutorial.html)。我的 Eclipse 版本是**Indigo**，我的**Ubuntu**版本是 12.04。当我尝试构建时，出现以下错误：

```
/usr/bin/ld: cannot find -lz.a
/usr/bin/ld: cannot find -lmysqlclient.a 
```

我喜欢请寻求帮助。我搜索`mysqlclient.a`了`z.a`图书馆，但没有找到这些。但我发现`libmysqlclient.a`并`libz.a`在目录中`/usr/lib/x86_64-linux-gnu`添加了这个库搜索路径，但得到了错误。

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T15:30:23.613

你通过`z.a`并`mysqlclient.a`作为图书馆。您需要`.a`放弃项目构建设置中的后缀：它不是库名称的一部分。应该是`-lz`和`-lmysqlclient`。

`-L`此外，可能不需要添加库搜索路径 ( )。`/usr/lib`并且`/usr/lib/$arch$`通常位于默认搜索路径中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-18T15:24:36.723

您需要安装 MySQL 客户端库和 libz 压缩库。对其中任何一个进行“apt-cache search”。

这个问题可能更适合 serverfault.com。

# c# - 保存用户排序 DataGrid Silverlight

> ID：14939579
> 
> 赞同：0
> 
> 时间：2013-02-18T15:20:46.630
> 
> 标签：c#, silverlight, web

我在 Silverlight 中有一个 DataGrid，用户可以对其进行排序。现在，如果数据得到更新，它会回到标准排序。无论如何我可以轻松实现它，用户选择的排序会保留吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:11:38.153

有一些方法可以做到这一点，

当 Collection 改变时，即

```
 ObservableCollection.CollectionChanged +=(sender,args)=>
 {

   ReSort(); 
   /* You may trigger CollectionViewSource's populete event here  
       It can sort,filter ,group etc. 
    */

} 
```

对于 CollectionViewSorting [http://www.codeproject.com/Articles/83906/Silverlight-4-Datagrid-Sorting-Grouping-Filtering](http://www.codeproject.com/Articles/83906/Silverlight-4-Datagrid-Sorting-Grouping-Filtering)

另一个基本设置排序成员路径

```
 datePickerColumn.SortMemberPath = "Birthday"; 
```

[http://blogs.msdn.com/b/scmorris/archive/2008/06/10/sorting-data-in-the-silverlight-datagrid.aspx](http://blogs.msdn.com/b/scmorris/archive/2008/06/10/sorting-data-in-the-silverlight-datagrid.aspx)

希望有帮助。

# lua - 从 addBody 对象中移除重力

> ID：14939584
> 
> 赞同：0
> 
> 时间：2013-02-18T15:20:57.763
> 
> 标签：lua, coronasdk, corona-storyboard

嗨，我的“直升机物体”需要有一个身体来与敌人的物体互动。所以我得到了：

```
helicopterspriteSheet = sprite.newSpriteSheet("helicopters.png", 113, 55)
helicoptersprites = sprite.newSpriteSet(helicopterspriteSheet, 1, 4)
sprite.add(helicoptersprites, "helicopters", 1, 4, 1000, 0)
helicopter = sprite.newSprite(helicoptersprites)
helicopter.x = -80
helicopter.y = 350
helicopter:prepare("helicopters")
helicopter:play()
helicopter.collided = false
helicopter:setReferencePoint(display.CenterReferencePoint);
physics.addBody(helicopter, "static", {density=.1, bounce=0.1, friction=.2, radius=10})
screenGroup:insert(helicopter) 
```

但是我怎样才能阻止重力干扰直升机，因为它是由“加速度计”控制的，但重力一直把它拉下来。

也许我可以通过 `self:applyForce(0, -1.5, self.x, self.y)` 倾斜来修复它，但如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T14:13:18.433

通过添加直升机.gravityScale = 0 修复

# html - 强制 html5 url 输入验证器允许空白方案

> ID：14939586
> 
> 赞同：0
> 
> 时间：2013-02-18T15:21:08.157
> 
> 标签：html, forms, validation

我有以下输入：

```
<input required type="url"> 
```

这会强制用户`http://`在提交 url 之前添加。有没有办法解决这个问题，而不必恢复到老式的文本输入？

我觉得人输入是很常见的`www.mysite.net`，当一个url无效时弹出的浏览器验证气泡并没有提到是因为缺少scheme。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:31:55.727

您可以`http://`在表单加载时将 放入输入框中。

```
<input required type="url" value="http://" /> 
```

可能不是您正在寻找的答案，但它是一个解决方案。

# nmake - 将'makefile' build.exe 重命名为不会发生冲突的东西？

> ID：14939587
> 
> 赞同：0
> 
> 时间：2013-02-18T15:21:11.990
> 
> 标签：nmake, wdk

在 DDK/WDK 中，`build.exe`需要文件夹中的某些文件。一旦您提供一个`sources`文件，您也应该`makefile`在同一个文件夹中拥有一个。`make`显然，这个名称与构建在各种平台和工具链上的混合源代码树中的各种变体发生冲突。

有没有办法将其命名为其他名称，例如`makefile.ddk`并让`nmake.exe`（此步骤的后端`build.exe`）使用该其他名称？

我不害怕编写脚本，但如果我可以将选项传递给`build.exe`，例如通过`/nmake args`开关，我会更喜欢。我正在使用从 2003 Server IFS Kit 到最新的 Windows 7 和 8 WDK 的一系列 DDK/WDK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:57:34.330

/nmake 选项将完成这项工作。我刚刚对此进行了测试，并且可以正常工作：

```
build /nmake "/f makefile.ddk" 
```

引号是必要的。

# parallel-processing - SCons：并行构建中的目录依赖

> ID：14939588
> 
> 赞同：1
> 
> 时间：2013-02-18T15:21:13.807
> 
> 标签：parallel-processing, scons

我在 SCons 的并行构建中遇到了目录依赖问题。考虑以下（简化）层次结构中具有单个 SConstruct 的两个项目：

```
- SConstruct
- project1
  - src
- project2
  - src
- build
  - project1
  - project2
- dist
  - project1
  - project2 
```

project1 和 project2 中的每一个都应该构建在相关的构建目录下（使用变体目录），并且需要在相关的 dist 目录下安装几个目标。

项目 2 依赖于项目 1 的 dist。我已经使用如下语句明确声明了这种依赖关系`Depends()`：

```
Depends('project2', 'dist/project1') 
```

当我使用非并行构建时，没有问题。项目 1 完全构建，目标安装在`dist`目录中，然后才构建项目 2。但是，当我使用多个作业 (4) 时，项目 2 正在与正在运行的构建器同时构建，以便在项目 1 的目录`Install()`中安装需要安装的文件。`dist`

所以，我的问题是：

*   该`Depends(project2, dist/project1)`语句是指目录的创建`dist/project1`还是目录的所有子目录的构建完成？
*   我应该如何解决这个问题？

非常感谢，

BUGOK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T17:53:16.987

不要在 Depends() 函数中将实际目录指定为字符串，而是尝试指定 SCons project1 和 project2 构建器返回的实际目标。每个 SCons 构建器（或至少其中大多数）都将受影响的目标作为对象返回，最好使用此对象而不是文件/目录名称，因为如果您不使用完全相同的文件/目录路径，则不会考虑作为同一个目标。

下面是一个例子，相应地填写内容：

```
project2Target = Install()
# Im not sure how you're building project1, so replace the builder
project1Target = Proj1DistBuiler()

Depends(project2Target, project1Target) 
```

# c# - 通过通用接口包装 C# 类以与多态一起使用

> ID：14939589
> 
> 赞同：2
> 
> 时间：2013-02-18T15:21:18.837
> 
> 标签：c#, .net, design-patterns, polymorphism

我有几个 C# 类，每个类都具有相似的属性。（它们是 SDK 的一部分，不能更改它们的代码。）

*   人名
*   产品名称
*   订单名称

我想多态地使用这些类，但它们没有实现公共接口或从公共基类派生，所以这是不可能的。为了解决这个问题，我想将每一个都包装在另一个实现公共接口的类中，并将每个类属性连接到其对应的接口属性。

包装类的合适名称是什么？包装器、装饰器、适配器、代理？这种模式有名字吗？有更好的方法吗？

（我不想使用动态鸭子打字或[即兴界面](http://code.google.com/p/impromptu-interface/)。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:24:25.133

它看起来像适配器，因为您正在使现有接口适应特定要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T15:23:59.263

> （我不想使用动态鸭子打字或即兴界面。）

那么 NamedObject 有什么问题呢？

```
public class NamedObject
{
    public string Name { get; set; }
} 
```

它从字面上说明它是什么，仅此而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T15:28:50.457

我会坚持 CodeCaster 的想法，也许`Func<T>` ~~除了我在不使用尖括号时出现戒断症状之外没有其他原因~~......

```
public class NamedEntity
{
    public string Name { get { return _getName(); } }

    private Func<string> _getName;

    public NamedObject(Func<string> getName)
    {
        _getName = getName;
    }
} 
```

然后这样调用：

```
var named = new[] 
    { 
        new NamedEntity(() => person.Name),
        new NamedEntity(() => product.Name),
        new NamedEntity(() => order.Name)
    }; 
```

这样做的额外好处是，当目标对象上的属性值发生变化时，它`NamedEntity`也会通过 在引用中发生变化`Func`，这意味着在对象的生命周期内，您可以只包装一次。您还可以使用`Func`设置值和获取值的 s 进行逆操作，并且可以调整更多属性。

我不确定这代表什么模式（如果有的话），但我猜适配器模式（这是一种包装模式）。然而，它也可以被认为是一种[代理模式](http://www.c-sharpcorner.com/UploadFile/rmcochran/csharp_wrapper202112006124804PM/csharp_wrapper2.aspx)。真的不确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-18T15:27:47.477

也许您可以更改名称空间并保留原始类的名称。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-18T15:31:06.593

从技术上讲，我认为最正确的名称是适配器，请参阅[这个](https://stackoverflow.com/questions/350404/how-do-the-proxy-decorator-adaptor-and-bridge-patterns-differ)问题。

> 当您有一个抽象接口并且您希望将该接口映射到另一个具有相似功能但接口不同的对象时，将使用适配器。

您没有抽象接口，而是“类似的功能角色，但不同的接口”。

# iphone - 延迟动画 – Objective-C

> ID：14939591
> 
> 赞同：0
> 
> 时间：2013-02-18T15:21:19.113
> 
> 标签：iphone, objective-c, cocoa-touch

我正在使用以下代码为圆圈设置动画。但是，它一直在闪烁。我想将动画的重启延迟 5 秒。我怎样才能做到这一点？

```
-(void)start
{    
    [self removeExistingAnimation];

    //create the image
    UIImage* img = [UIImage imageNamed:@"redCircle.png"];
    imageView = [[UIImageView alloc] initWithImage:img];
    imageView.frame = CGRectMake(0, 0, 0, 0);
    [self addSubview:imageView];

    //opacity animation setup
    CABasicAnimation *opacityAnimation;

    opacityAnimation=[CABasicAnimation animationWithKeyPath:@"opacity"];
    opacityAnimation.duration = ANIMATION_DURATION;
    opacityAnimation.repeatCount = ANIMATION_REPEAT;
    //theAnimation.autoreverses=YES;
    opacityAnimation.fromValue = [NSNumber numberWithFloat:0.6];
    opacityAnimation.toValue = [NSNumber numberWithFloat:0.025];
    //resize animation setup
    CABasicAnimation *transformAnimation;

    transformAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale"];

    transformAnimation.duration = ANIMATION_DURATION;
    transformAnimation.repeatCount = ANIMATION_REPEAT;
    //transformAnimation.autoreverses=YES;
    transformAnimation.fromValue = [NSNumber numberWithFloat:MIN_RATIO];
    transformAnimation.toValue = [NSNumber numberWithFloat:MAX_RATIO];

    //group the two animation
    CAAnimationGroup *group = [CAAnimationGroup animation];

    group.repeatCount = ANIMATION_REPEAT;
    [group setAnimations:[NSArray arrayWithObjects:opacityAnimation, transformAnimation, nil]];
    group.duration = ANIMATION_DURATION;

    //apply the grouped animaton
    [imageView.layer addAnimation:group forKey:@"groupAnimation"];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:27:28.660

像这样做 ：

```
-(void)start
{    
    [self removeExistingAnimation];

    //create the image
    UIImage* img = [UIImage imageNamed:@"redCircle.png"];
    imageView = [[UIImageView alloc] initWithImage:img];
    imageView.frame = CGRectMake(0, 0, 0, 0);
    [self addSubview:imageView];

    [self doAnimation];

    [NSTimer scheduledTimerWithTimeInterval:5.0 target:self selector:@selector(doAnimation) userInfo:nil repeats:YES];
}

-(void)doAnimation
{

//opacity animation setup
    CABasicAnimation *opacityAnimation;

    opacityAnimation=[CABasicAnimation animationWithKeyPath:@"opacity"];
    opacityAnimation.duration = ANIMATION_DURATION;
    opacityAnimation.repeatCount = ANIMATION_REPEAT;
    //theAnimation.autoreverses=YES;
    opacityAnimation.fromValue = [NSNumber numberWithFloat:0.6];
    opacityAnimation.toValue = [NSNumber numberWithFloat:0.025];
    //resize animation setup
    CABasicAnimation *transformAnimation;

    transformAnimation = [CABasicAnimation animationWithKeyPath:@"transform.scale"];

    transformAnimation.duration = ANIMATION_DURATION;
    transformAnimation.repeatCount = ANIMATION_REPEAT;
    //transformAnimation.autoreverses=YES;
    transformAnimation.fromValue = [NSNumber numberWithFloat:MIN_RATIO];
    transformAnimation.toValue = [NSNumber numberWithFloat:MAX_RATIO];

    //group the two animation
    CAAnimationGroup *group = [CAAnimationGroup animation];

    group.repeatCount = ANIMATION_REPEAT;
    [group setAnimations:[NSArray arrayWithObjects:opacityAnimation, transformAnimation, nil]];
    group.duration = ANIMATION_DURATION;

    //apply the grouped animaton
    [imageView.layer addAnimation:group forKey:@"groupAnimation"];

} 
```

这看起来像肮脏的方法，但对我有用，希望对你有帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:02:04.363

这不是更干净一点吗？或者有什么理由不能使用块来制作动画？

```
 - (void) start {
        //create the image
        UIImage* img = [UIImage imageNamed:@"redCircle.png"];
        imageView = [[UIImageView alloc] initWithImage:img];
        [self addSubview:imageView];

        [self animateWithDelay:0.0];
    }

    - (void) animateWithDelay:(CGFloat)delay {

        imageView.alpha = 0.0;
        imageView.transfrom = CGAffineTransformScale(myImage.transform, MIN_RATIO, MIN_RATIO);
        [UIImageView animateWithDuration:ANIMATION_DURATION delay:delay options:0 animations:^{

            imageView.alpha = 1.0;
            imageView.transfrom = CGAffineTransformScale(myImage.transform, MAX_RATIO, MAX_RATIO);

        } completion:^{
            animationCount++;
            if (ANIMATION_REPEAT != animationCount) {
                [self animateWithDelay:5.0];
            }
        }]; 

    } 
```

你应该在你的类的某个地方定义 animationCount，这样你就知道他什么时候应该停止重复。

（未经测试，因此可能包含一些错误）

# c# - 从 javascript 中的 aspx 请求动态 .txt 文件

> ID：14939593
> 
> 赞同：-1
> 
> 时间：2013-02-18T15:21:26.987
> 
> 标签：c#, javascript, asp.net, .net

我正在尝试在 javascript 中发出请求以调用 aspx 函数，目的是在 IE 中将 .txt 文件作为另存为对话框返回（仅需要 IE 支持）。

*问题是我需要 Javascript 向 aspx 发送一个字符串，然后它使用该字符串动态生成一个 .txt 文件以发送回以进行保存。*

类似于此处的动态示例，**但带有 txt 文件**：[http ://www.west-wind.com/weblog/posts/2007/May/21/Downloading-a-File-with-a-Save-As-Dialog- ASPNET 内](http://www.west-wind.com/weblog/posts/2007/May/21/Downloading-a-File-with-a-Save-As-Dialog-in-ASPNET)

我需要向服务器发出什么请求才能将其恢复为“另存为”提示？

例子会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:39:12.663

好的，我知道了！所以我们在这里为任何感兴趣的人：

Asp.net 服务器（保存.aspx 文件）：

```
 string txtString = Request["txtString"];

        Response.Clear();

        Response.AppendHeader(
        "Content-Disposition", 
        "attachment; 
        filename=myFile.txt"
        );

        Response.ContentType = "application/x-download";

        Response.Write(txtString);

        Response.End(); 
```

并感谢这篇文章！： [JavaScript 发布请求，如表单提交](https://stackoverflow.com/questions/133925/javascript-post-request-like-a-form-submit)

Javascript：

```
function saveTxt() {

    var myString = getTxtString();

    var form = document.createElement("form");
    form.setAttribute("method", "POST");
    form.setAttribute("action", "save.aspx");

    var hiddenField = document.createElement("input");
    hiddenField.setAttribute("type", "hidden");
    hiddenField.setAttribute("name", "jsonString");
    hiddenField.setAttribute("value", myString);

    form.appendChild(hiddenField);

    document.body.appendChild(form);
    form.submit();
} 
```

# python - 使用 GUI 控制中断循环中途运行

> ID：14939595
> 
> 赞同：1
> 
> 时间：2013-02-18T15:21:33.570
> 
> 标签：python

我目前正在使用 pygtk 和 glade 创建一个程序，该程序将控制两个电压之间的电压扫描。

我想知道如果输出发生问题，如何将扫描作为安全功能中断。我已经在下面发布了我的扫描代码。基本上我想要的是一个连接到“停止”按钮的函数，我可以将其插入到我的脚本中，而无需运行 sys.exit() 并关闭 GUI 或程序。

```
def drange(start, stop, step):
    r = start
    while min(start, stop) <= r <= max(start, stop):
        yield r
        r = r + step

def setchan(self, widget, N, v_f=None):
    delay = float(self.delayer.get_text())/1000
    if (v_f == None): float( self.volt_widgets[int(N-1)][0].get_text())
    self.min = float( self.volt_widgets[int(N-1)][1].get_text())
    self.max = float( self.volt_widgets[int(N-1)][2].get_text())
    if v_f > self.max:
        print "The channel voltage would be set to more than the allowed maximum"
        raise ValueError
    if v_f < self.min:
        print "The channel voltage would be set to less than the allowed minimum"
        raise ValueError
    v_f = self.translate_Vf_to_Vb(self.poldacs[int(N-1)], v_f)
    self.device.do_set_dac( v_f, N )

def sweepchan(self, widget, N):
    self.get_pol()
    delay = float(self.delayer.get_text())/1000
    numstep = int(self.stepper.get_text())
    v_i = self.translate_Vb_to_Vf(self.poldacs[N-1], self.device.do_get_dac(N))
    v_f = float( self.volt_widgets[int(N-1)][0].get_text())
    self.min = float( self.volt_widgets[int(N-1)][1].get_text())
    self.max = float( self.volt_widgets[int(N-1)][2].get_text())

    if v_f > self.max:
        print "The final voltage is set to higher than the allowed maximum"
        return
    if v_f < self.min:
        print "The final voltage is set to less than the allowed minimum"
        return

    vstep = (v_f - v_i)/numstep
    if abs(vstep) <= 0.00001:
        print "The current voltage and final voltage are the same"
        return
    for V in drange(v_i, v_f, vstep):
        self.setchan( None, N, V)
        time.sleep(delay) 
```

# c# - 更新没有重复的 SQL Server 数据库

> ID：14939599
> 
> 赞同：-1
> 
> 时间：2013-02-18T15:22:04.680
> 
> 标签：c#, sql-server

几个月前我编写了这个程序，用于分隔这些大`.CSV`文件并将它们上传到 SQL Server 数据库中。由于该`.CSV`文件基本上每次都附加新数据，因此我只是对其进行了设置，以便每次用户上传数据时，它都会从表中删除所有内容并上传新附加的数据，如下所示：

```
myConnection.Open();
string sql = @"DELETE FROM TestTable;";
SqlCommand cmd = new SqlCommand(sql, myConnection);
cmd.ExecuteNonQuery();
myConnection.Close(); 
```

现在我必须设置它来上传数据而不删除以前的条目到表中，但问题是我不能有重复的数据。幸运的是，该`.CSV`文件带有我用作主键的每一行的唯一标识符，但我无法提出算法来执行此操作。是否有类似于`DELETE`上述语法的东西可以与 SQL Server 一起使用以仅更新唯一数据？我问你们，因为在 SQL Server 方面我不是最大的专家。

我有几个不同的班级和后台工作人员，所以不想过去所有的代码，因为它很多，但如果你们需要任何细节，请告诉我。

编辑

这里有一个例子：http: [//msdn.microsoft.com/en-us/library/y06xa2h1 (v=vs.80).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-1](http://msdn.microsoft.com/en-us/library/y06xa2h1(v=vs.80).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-1)

我很确定我需要做什么，但我唯一感到困惑的是什么是 dataSet1 以及它来自哪里？我只是使用连接字符串来打开与 SQL Server 数据库的连接，然后使用它`SqlDataAdapter`来执行诸如插入和东西之类的功能。

如果有人对此有任何澄清，那将有很大帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T17:06:27.223

实现此目的的一种*廉价方法是在 SQL Server 中的唯一标识列上创建一个唯一索引，并告诉它只是简单地忽略任何重复项。*

```
CREATE UNIQUE INDEX UIX_YourIndexNameHere
ON dbo.YourTableNameHere(YourUniqueColumnNameHere)
WITH (IGNORE_DUP_KEY = ON); 
```

这表示：

*   SQL Server 将只允许此列中的唯一值 - 没有重复
*   如果插入了任何重复项，它们将被丢弃而不会引发任何错误（可以说是“默默地忽略”）

这也意味着：

*   可能的重复将被忽略 - 该唯一 ID 的现有行将保持*原样*（无更新）
*   正在插入新行

如果您需要使用其 ID 更新预先存在的行，我建议您这样做：

*   将 .CSV 批量加载到临时登台表中
*   使用`MERGE`命令（希望您使用的是 SQL Server **2008**或更高版本！）从临时表更新真实表；这允许轻松插入新行并**更新**（而不是忽略）预先存在的行

# php - 格式正确的 PDF 到 HTML

> ID：14939604
> 
> 赞同：0
> 
> 时间：2013-02-18T15:22:15.037
> 
> 标签：php, html, pdf, text

我正在将 PDF 文件转换为文本`(HTML)`，转换成功，但丢失了所有 ots 转换。有什么方法可以保持原来在 Pdf 文件中的正确格式？我从[这里获得了 pdf 到文本的帮助](http://webcheatsheet.com/php/reading_clean_text_from_pdf.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:26:58.870

基本上 PDF 是使用固定格式的文档，而 html 通常使用流体格式。您不会得到与 PDF 完全一样的 HTML 文档。

此外，html 甚至不支持某些 PDF 功能。

# java - Java 通过 gmail 发送电子邮件

> ID：14939607
> 
> 赞同：3
> 
> 时间：2013-02-18T15:22:20.700
> 
> 标签：java, gmail

大家好，我一直在尝试获取一些 java 代码以通过 gmail 向 java 中的用户发送电子邮件，这就是我所拥有的：

```
@ManagedBean
@ViewScoped
public class email {

    // Set up the SMTP server.
    java.util.Properties props = new java.util.Properties();

    public void mail() {
        System.out.println("Called mail");
        props.put(
                "mail.smtp.gmail", "smtp.gmail.com");
        props.put("mail.smtp.port", "587");

        Session session = Session.getDefaultInstance(props, null);
// Construct the message
        String to = "cam01342@myport.ac.uk";
        String from = "richard.dennis@port.ac.uk";
        String subject = "Hello";
        Message msg = new MimeMessage(session);

        try {
            System.out.println("Setting up the email");
            msg.setFrom(new InternetAddress(from));
            msg.setRecipient(Message.RecipientType.TO, new InternetAddress(to));
            System.out.println("here");

            msg.setSubject("Print Job");
            msg.setText("Hi,\n\nHow are you?");

            Transport.send(msg);
            System.out.println("Sending message"); //does not get to this part
        } catch (MessagingException e) {
            // Error.
        }
    }
} 
```

它在运行等时没有错误，我没有在控制台中收到发送消息，它只是 Transport.send(msg) 卡在我做错了什么的地方？gmail的设置都可以吗？

编辑：

```
@ManagedBean
@ViewScoped
public class email {

    // Set up the SMTP server.
    java.util.Properties props = new java.util.Properties();

    public void mail() {
        System.out.println("Called mail");
        String host = "smtp.gmail.com";
        String from = "------------";
        String pass = "----";

        props.put("mail.smtp.starttls.enable", "true"); // added this line
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.user", from);
        props.put("mail.smtp.password", pass);
        props.put("mail.smtp.port", "587");
        props.put("mail.smtp.auth", "true");

        Session session = Session.getDefaultInstance(props, null);
// Construct the message
        String to = "--------";
        String subject = "Hello";
        Message msg = new MimeMessage(session);

        try {
            System.out.println("Setting up the email");
            msg.setFrom(new InternetAddress(from));
            msg.setRecipient(Message.RecipientType.TO, new InternetAddress(to));
            System.out.println("here");

            msg.setSubject("Print Job");
            msg.setText("Hi,\n\nHow are you?");

            Transport.send(msg);
            System.out.println("Sending message"); //does not get to this part
        } catch (MessagingException e) {
            // Error.
        }
    }
} 
```

编辑：尝试提供给我的链接之一中的示例：

```
@ManagedBean
@ViewScoped
public class email {

    // Set up the SMTP server.
    public void mail() throws MessagingException {
        String host = "smtp.gmail.com";
        String from = "------------";
        String pass = "------";
        Properties props = System.getProperties();
        props.put("mail.smtp.starttls.enable", "true"); // added this line
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.user", from);
        props.put("mail.smtp.password", pass);
        props.put("mail.smtp.port", "587");
        props.put("mail.smtp.auth", "true");

        String[] to = {"-----------"}; // added this line

        Session session = Session.getDefaultInstance(props, null);
        MimeMessage message = new MimeMessage(session);
        message.setFrom(new InternetAddress(from));

        InternetAddress[] toAddress = new InternetAddress[to.length];

        // To get the array of addresses
        for (int i = 0; i < to.length; i++) { // changed from a while loop
            toAddress[i] = new InternetAddress(to[i]);
        }
        System.out.println(Message.RecipientType.TO);

        for (int i = 0; i < toAddress.length; i++) { // changed from a while loop
            message.addRecipient(Message.RecipientType.TO, toAddress[i]);
        }
        message.setSubject("sending in a group");
        message.setText("Welcome to JavaMail");
        Transport transport = session.getTransport("smtp");
        transport.connect(host, from, pass);
        transport.sendMessage(message, message.getAllRecipients());
        transport.close();
    }
} 
```

这引发了这个错误：

```
INFO: To
WARNING: #{email.mail()}: javax.mail.MessagingException: Could not connect to SMTP host: smtp.gmail.com, port: 25;
  nested exception is:
    java.net.ConnectException: Connection timed out: connect
javax.faces.FacesException: #{email.mail()}: javax.mail.MessagingException: Could not connect to SMTP host: smtp.gmail.com, port: 25;
  nested exception is:
    java.net.ConnectException: Connection timed out: connect
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.faces.el.EvaluationException: javax.mail.MessagingException: Could not connect to SMTP host: smtp.gmail.com, port: 25;
  nested exception is:
    java.net.ConnectException: Connection timed out: connect
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    ... 36 more
Caused by: javax.mail.MessagingException: Could not connect to SMTP host: smtp.gmail.com, port: 25;
  nested exception is:
    java.net.ConnectException: Connection timed out: connect
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1934)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:638)
    at javax.mail.Service.connect(Service.java:295)
    at javax.mail.Service.connect(Service.java:176)
    at richard.fileupload.email.mail(email.java:101)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at javax.el.BeanELResolver.invokeMethod(BeanELResolver.java:779)
    at javax.el.BeanELResolver.invoke(BeanELResolver.java:528)
    at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:257)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:248)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at org.jboss.weld.util.el.ForwardingMethodExpression.invoke(ForwardingMethodExpression.java:39)
    at org.jboss.weld.el.WeldMethodExpression.invoke(WeldMethodExpression.java:50)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    ... 37 more
Caused by: java.net.ConnectException: Connection timed out: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:69)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
    at java.net.Socket.connect(Socket.java:579)
    at java.net.Socket.connect(Socket.java:528)
    at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:288)
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:231)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1900)
    ... 54 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T16:29:04.603

我认为您需要使用**465**端口和**smtps**（不是 smtp）进行传输。

来自开源项目的完整可行代码：

[http://jstock.hg.sourceforge.net/hgweb/jstock/jstock/file/d9290c44d19c/src/org/yccheok/jstock/alert/GoogleMail.java](http://jstock.hg.sourceforge.net/hgweb/jstock/jstock/file/d9290c44d19c/src/org/yccheok/jstock/alert/GoogleMail.java)

```
/**
 * Send email using GMail SMTP server.
 *
 * @param username GMail username
 * @param password GMail password
 * @param recipientEmail TO recipient
 * @param ccEmail CC recipient. Can be empty if there is no CC recipient
 * @param title title of the message
 * @param message message to be sent
 * @throws AddressException if the email address parse failed
 * @throws MessagingException if the connection is dead or not in the connected state or if the message is not a MimeMessage
 */
public static void Send(final String username, final String password, String recipientEmail, String ccEmail, String title, String message) throws AddressException, MessagingException {
    Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());
    final String SSL_FACTORY = "javax.net.ssl.SSLSocketFactory";

    // Get a Properties object
    Properties props = System.getProperties();
    props.setProperty("mail.smtps.host", "smtp.gmail.com");
    props.setProperty("mail.smtp.socketFactory.class", SSL_FACTORY);
    props.setProperty("mail.smtp.socketFactory.fallback", "false");
    props.setProperty("mail.smtp.port", "465");
    props.setProperty("mail.smtp.socketFactory.port", "465");
    props.setProperty("mail.smtps.auth", "true");

    /*
    If set to false, the QUIT command is sent and the connection is immediately closed. If set 
    to true (the default), causes the transport to wait for the response to the QUIT command.

    ref :   http://java.sun.com/products/javamail/javadocs/com/sun/mail/smtp/package-summary.html
            http://forum.java.sun.com/thread.jspa?threadID=5205249
            smtpsend.java - demo program from javamail
    */
    props.put("mail.smtps.quitwait", "false");

    Session session = Session.getInstance(props, null);

    // -- Create a new message --
    final MimeMessage msg = new MimeMessage(session);

    // -- Set the FROM and TO fields --
    msg.setFrom(new InternetAddress(username + "@gmail.com"));
    msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(recipientEmail, false));

    if (ccEmail.length() > 0) {
        msg.setRecipients(Message.RecipientType.CC, InternetAddress.parse(ccEmail, false));
    }

    msg.setSubject(title);
    msg.setText(message, "utf-8");
    msg.setSentDate(new Date());

    SMTPTransport t = (SMTPTransport)session.getTransport("smtps");

    t.connect("smtp.gmail.com", username, password);
    t.sendMessage(msg, msg.getAllRecipients());      
    t.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:33:59.253

```
props.put("mail.smtp.port", "587"); 
```

尝试将上面的代码更改为：

```
props.put("mail.smtp.port", "465"); 
```

你在哪里`javax.mail.Authenticator();`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:49:26.663

尝试使用 Transport 执行此操作：

```
 final Transport transport = session.getTransport("smtp");
    transport.connect(host, from, pass);
    transport.sendMessage(msg, msg.getAllRecipients());
    transport.close(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-15T16:06:48.870

试试这个代码。它完全可以工作...

```
package my.test.service;
import java.util.Properties;
import javax.mail.Authenticator;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Message;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
public class Sample {
    public static void main(String args[]) {
        final String SMTP_HOST = "smtp.gmail.com";
        final String SMTP_PORT = "587";
        final String GMAIL_USERNAME = "xxxxxxxxxx@gmail.com";
        final String GMAIL_PASSWORD = "xxxxxxxxxx";

        System.out.println("Process Started");

        Properties prop = System.getProperties();
        prop.setProperty("mail.smtp.starttls.enable", "true");
        prop.setProperty("mail.smtp.host", SMTP_HOST);
        prop.setProperty("mail.smtp.user", GMAIL_USERNAME);
        prop.setProperty("mail.smtp.password", GMAIL_PASSWORD);
        prop.setProperty("mail.smtp.port", SMTP_PORT);
        prop.setProperty("mail.smtp.auth", "true");
        System.out.println("Props : " + prop);

        Session session = Session.getInstance(prop, new Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(GMAIL_USERNAME,
                        GMAIL_PASSWORD);
            }
        });

        System.out.println("Got Session : " + session);

        MimeMessage message = new MimeMessage(session);
        try {
            System.out.println("before sending");
            message.setFrom(new InternetAddress(GMAIL_USERNAME));
            message.addRecipients(Message.RecipientType.TO,
                    InternetAddress.parse(GMAIL_USERNAME));
            message.setSubject("My First Email Attempt from Java");
            message.setText("Hi, This mail came from Java Application.");
            message.setRecipients(Message.RecipientType.TO,
                    InternetAddress.parse(GMAIL_USERNAME));
            Transport transport = session.getTransport("smtp");
            System.out.println("Got Transport" + transport);
            transport.connect(SMTP_HOST, GMAIL_USERNAME, GMAIL_PASSWORD);
            transport.sendMessage(message, message.getAllRecipients());
            System.out.println("message Object : " + message);
            System.out.println("Email Sent Successfully");
        } catch (AddressException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (MessagingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-10T13:29:01.347

```
import java.util.Properties;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class MessageSender {

    public static void sendHardCoded() throws AddressException, MessagingException {
        String to = "a@a.info";
        final String from = "b@gmail.com";

        Properties properties = new Properties();
        properties.put("mail.smtp.starttls.enable", "true");
        properties.put("mail.smtp.auth", "true");
        properties.put("mail.smtp.host", "smtp.gmail.com");
        properties.put("mail.smtp.port", "587");

        Session session = Session.getInstance(properties,
                new javax.mail.Authenticator() {
                    protected PasswordAuthentication getPasswordAuthentication() {
                        return new PasswordAuthentication(from, "BeNice");
                    }
                });

        MimeMessage message = new MimeMessage(session);
        message.setFrom(new InternetAddress(from));
        message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
        message.setSubject("Hello");
        message.setText("What's up?");

        Transport.send(message);
    }

} 
```

# c++ - 如何将 Emacs 结构缩进从 4 个空格更改为 2 个空格

> ID：14939608
> 
> 赞同：2
> 
> 时间：2013-02-18T15:22:20.390
> 
> 标签：c++, emacs, struct

```
;; C++ Mode
(c-set-offset 'access-label '-2)
(c-set-offset 'inclass '4)
(setq c-default-style "k&r"
      c-basic-offset 2) 
```

那是我的 C++ 配置。我希望 Emacs 用 2 个空格缩进结构，就像缩进函数 if/while/for 块一样，但目前它这样做：

```
struct plane {
    //4 spaces'?
}; 
```

但是，它这样做：

```
typedef car {
  //2 spaces!
} 
```

我尝试使用`c-mode`and `c++-mode`。当我`M-x c-set-offset`在一个结构内（它当前缩进 4 个空格）时，它会将其检测为`topmost-intro`（0 个空格），即使在 C++ 模式下也是如此。

基本上，我希望内部结构缩进 2 个空格，而不是现在的 4 个空格。（GNU Emacs 24.2.1）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T16:08:34.147

您应该删除您的配置并开始

```
(custom-set-variables
 '(c-basic-offset 2)) 
```

这会将所有缩进设置为 2 个空格。然后你可以从那里改进。

例如，您可以设置`c-offsets-alist`为各种元素自定义缩进。或者`c-hanging-braces-alist`在同一行或下一行配置大括号应设置的位置。等等。

如果您已经安装了 CC 模式信息文件，您可以使用

`Ctrl-h i m``CC Mode``RET`

CC 模式不区分`class`and `struct`，因为两者的句法元素都是`inclass`. 您可以基于 struct 仅使用[自定义 Line-Up 函数具有不同的缩进](http://www.gnu.org/software/emacs/manual/html_mono/ccmode.html#Custom-Line_002dUp)

```
(defun my/c-lineup-inclass (langelem)
  (let ((inclass (assoc 'inclass c-syntactic-context)))
    (if (not inclass)
        0
      (save-excursion
        (goto-char (c-langelem-pos inclass))
        (if (looking-at "struct") 0 '+))))) 
```

如果您在内部或外部，此函数会查找`class`并`struct`相应地返回缩进级别。然后你可以在你的`c-offsets-alist`

```
(custom-set-variables
 '(c-offsets-alist (quote ((access-label . 0)
                           (topmost-intro . my/c-lineup-inclass))))) 
```

# javascript - jQuery/JS 查找提交表单的元素

> ID：14939613
> 
> 赞同：1
> 
> 时间：2013-02-18T15:22:31.500
> 
> 标签：javascript, jquery, forms

我制作了一个 jQuery 插件，它重新编程表单的提交按钮以使用 ajax 请求。

当提交按钮不是`<submit>`元素时会出现问题，如下所示：

```
<div class="home" onclick="document.form.submit()">
     <h2>Save</h2>
</div> 
```

有没有办法让我以*“优雅”*的方式找到这些元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:25:24.800

您可以绑定到自身的[提交](http://api.jquery.com/submit/)事件，而不是修改所有可能触发表单提交的元素：`<form>`

```
$("form").submit(function(e) {
    e.preventDefault();  // Inhibit default submission.
    // Now submit form through AJAX...
}); 
```

# jquery - jQuery Promises 参数失败回调未定义

> ID：14939617
> 
> 赞同：2
> 
> 时间：2013-02-18T15:23:01.513
> 
> 标签：jquery, promise

我正在为演示准备一些示例材料，其中还涵盖了 jQuery 承诺的基础知识，并且我正在计算一些奇怪的行为。希望你们能帮我解决这个问题。

我有以下代码可以正常工作。

```
var getHTML1 = $.ajax({
        url: "jquerypromises.html",    
        type: "GET"
});

getHTML1.done(function(responseText, state, jqXHR){
    console.log("success from AJAX request with promises : getHTML1!");
});

getHTML1.fail(function(){
    console.log("error from AJAX request with promises : getHTML1!");
});

//this one will call the failure callback!!!!!!
var getHTML2 = 
$.ajax({
        url: "somenonexistingpage.html", //<== THIS WILL call the failure callback   
        type: "GET"
})
.then(
    function(){
        console.log("success from AJAX request with promises : getHTML2!");
    }
, 
    function(jqXHR, state){
        console.log("error from AJAX request with promises : getHTML2!");
    }
); 
```

此代码按照调用`getHTML1`完成处理程序和调用`getHTML2`失败处理程序的预期运行。

现在，当我在上面看到的代码下方添加以下代码时。

```
$.when(getHTML1, getHTML2).then(
    function(response1, response2) {
        // both arguments are arrays with[responseText, "success", jqXHR] 
        console.log("Both promises went successfull");
        console.dir(response1);
        console.dir(response2);
    },
    function(jqXHR, status) {   
        console.log("One of both promises went wrong!");        
        console.log(jqXHR);
        console.log(status);        
    }   
); 
```

再次调用适当的处理程序。在这种情况下，正在调用失败回调，但它的所有参数都是未定义的。为什么是这样？

现在，当我删除块中的失败处理程序时，`then()`代码`getHTML2`变成这样：

```
var getHTML2 = 
$.ajax({
        url: "somenonexistingpage.html", //<== THIS WILL call the failure callback   
        type: "GET"
})
.then(
    function(){
        console.log("success from AJAX request with promises : getHTML2!");
    }
); 
```

现在一切都像预期的那样工作，第二个 then() 块中的失败处理程序被调用并填充了参数。

使用 jQuery 1.9.1 在 Chrome 中测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:42:06.893

基本上，那是因为[then()](http://api.jquery.com/deferred.then/)的文档说（强调我的）：

> 这些过滤器函数可以返回**一个新值**以传递给Promise`.done()`或`.fail()`回调，或者它们可以返回另一个可观察对象（Deferred、Promise 等），它将其已解决/拒绝状态和值传递给 Promise 的回调。如果使用的过滤器函数是`null`或未指定，则承诺将被解析或拒绝**，并使用与原始相同的值**。

因此，您可以从失败过滤器返回单个值，这不是您想要的（您想要两个值），或者完全省略失败过滤器以`then()`传递与原始承诺相同的值。

如果你想实现一个返回多个值的失败过滤器，你可以返回一个新的 Deferred 对象，你立即用这些值拒绝它：

```
var getHTML2 = $.ajax({
    url: "somenonexistingpage.html", //<== THIS WILL call the failure callback   
    type: "GET"
}).then(function() {
    console.log("success from AJAX request with promises : getHTML2!");
}, function(jqXHR, state) {
    console.log("error from AJAX request with promises : getHTML2!");
    return $.Deferred().reject(jqXHR, state);
}); 
```

# ajax - 确认删除？

> ID：14939618
> 
> 赞同：0
> 
> 时间：2013-02-18T15:23:06.067
> 
> 标签：ajax, mootools

我有这个 mootools 代码，单击按钮会删除记录，现在我想当用户单击删除按钮时弹出一个确认对话框，询问我是否确定要删除记录，并回答是和否...这是我的代码...如果用户回答“是”以继续此请求，如果他回答“否”则不要继续，如果我有另一条消息说在他单击“是”后记录已被删除，那也很棒...

```
<script>
window.addEvent('domready',function() {

$$('a.delete').each(function(el) {
el.addEvent('click',function(e) {
  e.stop();
  var parent = el.getParent('div');
  var request = new Request({
    url: '/delete.php',
    link: 'chain',
    method: 'get',
    data: {
      'delete': parent.get('id').replace('record-',''),
      ajax: 1
    },
    onRequest: function() {
      new Fx.Tween(parent,{
        duration:300
      }).start('background-color', '#fb6c6c');
    },
    onSuccess: function() {
      new Fx.Slide(parent,{
        duration:300,
        onComplete: function() {
          parent.dispose();
        }
      }).slideOut();
    }
  }).send();
});
 });

});

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T11:55:40.403

这很简单。

```
if (confirm('message')){ 
    // code when yes
}
else {
    // code when no
} 
```

因此。

```
$$('a.delete').each(function (el) {
    el.addEvent('click', function (e) {
        e.stop();
        var parent = el.getParent('div');
        if (confirm('are you sure you want to delete this?')) {
            new Request({
                url: '/delete.php',
                link: 'chain',
                method: 'get',
                data: {
                    'delete': parent.get('id').replace('record-', ''),
                    ajax: 1
                },
                onRequest: function () {
                    new Fx.Tween(parent, {
                        duration: 300
                    }).start('background-color', '#fb6c6c');
                },
                onSuccess: function () {
                    new Fx.Slide(parent, {
                        duration: 300,
                        onComplete: function () {
                            parent.dispose();
                        }
                    }).slideOut();
                }
            }).send();
        } // confirm
    });
}); 
```

# java - Bean Scope("Request") 不起作用

> ID：14939620
> 
> 赞同：1
> 
> 时间：2013-02-18T15:23:13.447
> 
> 标签：java, spring, annotations, scope, request

我正在尝试将 Spring Scoped Beans 与`@Scope("Request")`. 根据[文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-factory-scopes-other)，如果使用 ServletDispatcher，则不需要其他设置。

即使我标记了一些 bean，因为`@Scope("Request")`我仍然为每个请求获取相同的 bean 对象，这意味着我得到了默认的 Singleton 行为。

在下面的代码中，我试图提出`statusService`范围请求。

控制器代码：

```
@Controller
public class CrawlerController {
    private final Log log = LogFactory.getLog(getClass());

    @Autowired
    private ScrappingService scrappingService;
    @Autowired
    private RepositoryService repositoryService;
    @Autowired
    private StatusService statusService;

    @RequestMapping(value = "/test", method = RequestMethod.GET)
    public String index(HttpServletRequest request) {
        return "candleAndVolume";
    }

    @RequestMapping(value = "/status", method = RequestMethod.GET)
    @ResponseBody
    public String getStatus(HttpServletRequest request) {
        return statusService.getStatus();
    } 
```

状态服务：

```
@Scope (value = WebApplicationContext.SCOPE_REQUEST)
public class StatusService {
    String status;

    public String getStatus(){
        return status;
    }
    public void setStatus(String status){
        this.status = status;
    }
} 
```

Web.xml - 以防万一。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         metadata-complete="false">

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <filter>
        <filter-name>hibernateFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>

        <init-param>
            <param-name>sessionFactoryBeanName</param-name>
            <param-value>sessionFactory</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- listener to load the root application context -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>health</servlet-name>
        <jsp-file>/health.jsp</jsp-file>
    </servlet>
    <servlet-mapping>
        <servlet-name>health</servlet-name>
        <url-pattern>/health</url-pattern>
    </servlet-mapping>

</web-app> 
```

应用环境：

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:annotation-config/>

    <bean name="scrapper" class="net.crawler.service.scrap.DefaultScrapperImpl"/>

    <bean name="statusService" class="net.crawler.service.StatusService"/>

    <bean name="scrappingService" class="net.crawler.service.scrap.ScrappingService"/>

    <bean id="propertyConfigurer"
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>/WEB-INF/jdbc.properties</value>
                <value>/WEB-INF/app.properties</value>
            </list>
        </property>
        <property name="ignoreUnresolvablePlaceholders" value="true"/>
    </bean>

    <bean id="dataSource"
          class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close"
          p:driverClassName="${jdbc.driverClassName}"
          p:url="${jdbc.databaseurl}" p:username="${jdbc.username}"
          p:password="${jdbc.password}"/>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="configLocation">
            <value>classpath:hibernate.cfg.xml</value>
        </property>
        <property name="configurationClass">
            <value>org.hibernate.cfg.AnnotationConfiguration</value>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${jdbc.dialect}</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
    </bean>

    <bean id="transactionManager"
          class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <bean name="gmailDefaultSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
        <property name="host" value="${app.mail.host}"/>
        <property name="port" value="${app.mail.port}"/>
        <property name="username" value="${app.mail.userName}"/>
        <property name="password" value="${app.mail.password}"/>

        <property name="javaMailProperties">
            <props>
                <prop key="mail.smtp.auth">true</prop>
                <prop key="mail.smtp.starttls.enable">true</prop>
            </props>
        </property>

    </bean>

    <bean name="pendingPages" class="net.crawler.general.PendingPages"/>

    <bean id="utils" class="net.crawler.general.Utils">
        <property name="exporterMap">
            <map>
                <entry key="CrawlerExporter" value-ref="crawlerExporter"/>
                <entry key="CsvMailExporter" value-ref="csvMailExporter"/>
                <entry key="SendCustomMailExporter" value-ref="sendCustomMailExporter"/>
            </map>
        </property>
    </bean>

    <bean name="crawlerExporter" class="net.crawler.service.export.CrawlerExporter"/>

    <bean name="csvMailExporter" class="net.crawler.service.export.CsvMailExporter">
        <property name="sendTo" value="${app.mail.recipient}"/>
        <property name="sender" ref="gmailDefaultSender"/>
    </bean>

    <bean name="sendCustomMailExporter" class="net.crawler.service.export.SendCustomMailExporter">
        <property name="sendTo" value="${app.mail.recipient}"/>
        <property name="sender" ref="gmailDefaultSender"/>
    </bean>

</beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:59:20.873

You need to enable

```
<aop:scoped-proxy/> 
```

so that you get a proxy instead of the bean directly. Check out the [scoped beans as dependencies](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/beans.html#beans-factory-scopes-other-injection) section in the documentation.

# backbone.js - 从 collection.where 访问 Backbone 模型

> ID：14939621
> 
> 赞同：0
> 
> 时间：2013-02-18T15:23:20.497
> 
> 标签：backbone.js

我`where`在我的 Backbone 集合上使用该方法，如下所示：

`var quote = app.Collections.quotes.where({Id: parseInt(id, 10)});`

但是，要访问唯一的结果/模型（因为它是通过 ID，只有一个） - 我怎样才能获得实际的模型而不求助于使用它：

`var onlyModel = quote[0]`?

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:28:58.633

一个更好的方法是`get`在集合上使用。[http://backbonejs.org/#Collection-get](http://backbonejs.org/#Collection-get)

```
var quote = app.Collection.quotes.get(parseInt(id, 10)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:32:47.233

骨干代理 集合上的下划线函数，特别是[findWhere](http://underscorejs.org/#findWhere)将返回找到的第一个匹配项。

> **findWhere** _.findWhere(list, properties)
> 查看列表并返回与属性中列出的所有键值对匹配的第一个值。

您的查询可以写成

```
var quote = app.Collections.quotes.findWhere({Id: parseInt(id, 10)}); 
```

但是在您的情况下，如果您确实在寻找具有给定 id 的模型，则可以直接使用[get](http://backbonejs.org/#Collection-get)方法

> **get** *collection.get(id)*
> 从集合中获取模型，由 id、cid 或通过传入模型指定。

```
 var quote = app.Collection.quotes.get(id); 
```

# javascript - kineticjs随鼠标角度旋转

> ID：14939622
> 
> 赞同：0
> 
> 时间：2013-02-18T15:23:23.237
> 
> 标签：javascript, rotation, kineticjs, mouse-position

我正在尝试根据在该图像上单击的鼠标以及鼠标与对象中心的角度来使图像对象旋转。

考虑一个单位圆，并根据鼠标在该圆上的位置使图像围绕该圆旋转。

我目前有

```
var stage = new Kinetic.Stage({
container: "container",
width: 800,
height: 500,
id: "myCanvas",
name: "myCanvas"
});
var layer = new Kinetic.Layer();
//gets the canvas context
var canvas = stage.getContainer();
var mousePosX;
var mousePosY;
var mouseStartAngle;
var selectedImage;
var mouseAngle;
var mouseStartAngle;
console.log(canvas)

var shiftPressed
window.addEventListener('keydown', function (e) {
if (e.keyCode == "16") {
    shiftPressed = true;
}
console.log(shiftPressed)
}, true);

window.addEventListener('keyup', function (e) {
if (e.keyCode == "16") {
    shiftPressed = false;
}
console.log(shiftPressed)
}, true);

function drawImage(imageObj) {

var dynamicImg = new Kinetic.Image({
    image: imageObj,
    x: stage.getWidth() / 2 - 200 / 2,
    y: stage.getHeight() / 2 - 137 / 2,
    width: 100, //imageObj.width,
    height: 100, // imageObj.height,
    draggable: true,
    offset: [50,50] //[(imageObj.width/2), (imageObj.height/2)]

});

dynamicImg.on('mousedown', function () {

    selectedImage = this;
    console.log("x: " + this.getX())
    console.log("y: " + this.getY())

    var mouseStartXFromCenter = mousePosX - (this.getX() + (this.getWidth() / 2));
    var mouseStartYFromCenter = mousePosY - (this.getY() + (this.getHeight() / 2));
    mouseStartAngle = Math.atan2(mouseStartYFromCenter, mouseStartXFromCenter);

    if (shiftPressed) {
        //console.log("trying to switch draggable to false");
        //console.log(this)
        this.setDraggable(false);
    }
});

dynamicImg.on('mouseup mouseout', function () {
    //console.log('mouseup mouseout')
    this.setDraggable(true);
});

dynamicImg.on('mouseover', function () {
    document.body.style.cursor = 'pointer';
});
dynamicImg.on('mouseout', function () {
    document.body.style.cursor = 'default';
});

imageArray.push(dynamicImg);
layer.add(dynamicImg);
stage.add(layer);
}
var imageObj = new Image();
imageObj.onload = function () {
drawImage(this);

};
imageObj.src = 'http://localhost:60145/Images/orderedList8.png';

function getMousePos(evt) {

var rect = canvas.getBoundingClientRect();
return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
};
}

canvas.addEventListener('mouseup', function () {
selectedImage = undefined;
});

canvas.addEventListener('mousemove', function (evt) {
mousePos = getMousePos(evt);
//console.log('Mouse position: ' + mousePos.x + ',' + mousePos.y)
mousePosX = mousePos.x;
mousePosY = mousePos.y;

if (selectedImage != undefined) {

    mouseXFromCenter = mousePosX - selectedImage.getX();
    mouseYFromCenter = mousePosY - selectedImage.getY();
    mouseAngle = Math.atan2(mouseYFromCenter, mouseXFromCenter);

    var rotateAngle = mouseAngle - mouseStartAngle;

    selectedImage.setRotation(rotateAngle);

}
}, false); 
```

代码有几件事。- 如果按下“shift”并且在图像上发生 mousedown 事件，它应该只允许旋转。

- 它需要维护动态图像绘制，因为它们将在页面的整个生命周期内动态填充画布。

这是我想要发生的类似事情的一个很好的例子，但只是无法让它在 canvas/kineticjs 中工作。 [http://jsfiddle.net/22Feh/5/](http://jsfiddle.net/22Feh/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T06:22:51.177

我会使用dragBoundFunc 更简单的方法。[http://jsfiddle.net/bighostkim/vqGmL/](http://jsfiddle.net/bighostkim/vqGmL/)

```
dragBoundFunc: function (pos, evt) {
    if (evt.shiftKey) {
        var x = this.getX() - pos.x;
        var y = this.getY() - pos.y;
        var radian = Math.PI + Math.atan(y/x);
        this.setRotation(radian);
        return {
            x: this.getX(),
            y: this.getY()
        }
     } else {
        return pos;
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T21:40:07.030

我的错误，我看错了你的问题。你基本上错过了一行：

```
 layer.draw(); 
```

按住 shift 并移动鼠标，您会看到它很好地旋转。 [http://jsfiddle.net/WXHe6/2/](http://jsfiddle.net/WXHe6/2/)

```
 canvas.addEventListener('mousemove', function (evt) {
            mousePos = getMousePos(evt);
            //console.log('Mouse position: ' + mousePos.x + ',' + mousePos.y)
            mousePosX = mousePos.x;
            mousePosY = mousePos.y;

            if (selectedImage != undefined) {

            mouseXFromCenter = mousePosX - selectedImage.getX();
            mouseYFromCenter = mousePosY - selectedImage.getY();
            mouseAngle = Math.atan2(mouseYFromCenter, mouseXFromCenter);

            var rotateAngle = mouseAngle - mouseStartAngle;

            selectedImage.setRotation(rotateAngle);
            layer.draw(); // <--------------- right here
  }
  }, false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T21:36:23.000

您应该更清楚 .on() 事件的作用。在您的代码中，除了计算 mouseStartAngle 之外，形状上的 mousedown 不执行任何操作，但不执行任何操作。而且你在 shape 事件上的 mouseUp 也没有多大作用。完成所有工作的是您的浏览器/客户端 mousedown/mouseup，这就是为什么它在某些点击而不是其他点击时正确旋转的原因。

要设置旋转，您有很多选项，这里有两个：

选项一：在 mousedown 上手动设置弧度

```
 dynamicImg.on('mousedown', function () {   
    dynamicImg.setRotation(mouseStartAngle); //set the rotation degree
    layer.draw(); // redraw the layer
  } 
```

选项二：让 kineticJS 为您设置旋转动画

```
 dynamicImg.on('mousedown', function () { 
    dynamicImg.transitionTo({  
        duration: 1,       // length of animation in seconds
        rotation: mouseStartAngle   // your angle, in radians
    });
  } 
```

您更新的 jsfiddle：http: [//jsfiddle.net/WXHe6/1/](http://jsfiddle.net/WXHe6/1/)

以下是一些附加说明：

您遇到问题的原因是因为您的代码结构有点混乱，很抱歉。您正在将浏览器事件与画布混合并向画布添加侦听器，而不是使用内置的 kineticJS 功能，例如，您可以使用 stage.getUserPosition() 来获取鼠标坐标。除非您迫切需要以这种方式构建项目，否则请尽量避免使用它。

我喜欢的是您创建了分解代码的函数，但不利的一面是，您有多个函数在做同样的事情，比如计算和更新旋转角度。为什么不只做一个函数来获得角度？

一些技巧：

1.  尝试主要使用 KineticJS 来实现功能（我知道您需要像 SHIFT 这样的按钮的事件侦听器）。我的意思是，使用类似 stage.getUserPosition(); 要获取鼠标/触摸坐标，而不是 evt.clientX，它更干净，并且已经为您完成了工作，无需重新发明轮子。

2.  制作一个用于设置/获取形状旋转的功能。然后，您可以随时调用它。（使用较少重复的代码）

3.  如果您不希望在单击 shift 时可以拖动形状，则应在单击项目之前进行设置。您有按钮侦听器，因此您可以在按下 shift 时禁用所有形状的旋转，或者只禁用光标下方的形状。

4.  imageArray.push(dynamicImg); 不确定你是否真的需要这个，如果你需要以数组的形式访问所有元素，你总是可以做 layer.getChildren(); 获取图层中的所有图像，或者像 layer.getChildren()[0] 一样以数字方式访问它们；（按创建顺序）

# javascript - 使用单击功能 jQuery 附加 HTML 不起作用

> ID：14939627
> 
> 赞同：0
> 
> 时间：2013-02-18T15:23:38.100
> 
> 标签：javascript, jquery

[http://jsfiddle.net/CCKUz/](http://jsfiddle.net/CCKUz/)

所以我有一个盒子，`<span class="open">`它会增加可折叠 div 的高度以查看内容。它可以简单地通过 CSS 高度折叠，并且打开的点击功能将高度设置为自动。很容易，这很有效。

当我去追加打开和关闭跨度时，就会出现问题。当我将它们包含在实际的 html 中时，它们可以正常工作。当我附加它们时，它们不再起作用。我想这可能是由于 js 无法将 .click 函数应用于它们，因为它们是在加载后创建的，但即使创建它们并在同一函数中应用 .click 也无济于事。

你在那里看到什么可能会影响到这一点吗？谢谢。

HTML：

```
<div class="box collapsible">
    <h3>Title</h3>
    <p>This is a sample paragraph that is here for placer purposes.</p>
</div> 
```

CSS：

```
.box { height: 20px; border: 1px solid #000000; padding: 10px; margin: 20px; position:   relative; overflow: hidden; }
h3 { margin: 0 0 20px 0; line-height: 20px; }
.open, .close { text-indent: -9999px; width: 20px; height: 20px; position: absolute; top:  10px; right: 10px; }
.open { background: #00ff00; }
.close { background: #0000ff; } 
```

JS：

```
$(function(){
        var box = $(".collapsible");
        var close = $(".collapsible span.close");
        var open = $(".collapsible span.open");
        box.each(function(){
            box.append('<span class="open">Open</span>');
            open.each(function(i){
                open.click(function(){
                    alert("You clicked open");
                    $(this).parent(box).css("height","auto").append('<span class="close">Close</span>');
                    $(this).hide();
                    $(this).parent().find(close).show();
                });
            });
            close.each(function(i){
                close.click(function(){
                    $(this).parent(box).css("height","15px");
                    $(this).hide();
                    $(this).parent().find(open).show();
                });
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:29:43.250

不需要循环，jQuery 会在内部完成，并且您需要具有动态元素的委托事件处理程序，如下所示：

```
$(function () {
    var box = $(".collapsible");
    box.append( $('<span />', {'class':'open'}) )
       .on('click', '.close', function () {
         $(this).hide()
                .closest('.collapsible')
                .css("height", "auto")
                .append( $('<span />', {'class':'close'}).show() );
    })
      .on('click', '.close', function () {
          $(this).hide()
                 .closest('.collapsible')
                 .css("height", "15px")
                 .find('.open').show();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:29:32.623

在添加它们之前选择开放元素：

```
var open = $(".collapsible span.open"); 
```

试试这个：

```
$(function(){
        var box = $(".collapsible");
        var close = $(".collapsible span.close");

        box.each(function(){
            box.append('<span class="open">Open</span>');
            var open = $(".collapsible span.open"); //do it here!!
            open.each(function(i){
                open.click(function(){
                    alert("You clicked open");
                    $(this).parent(box).css("height","auto").append('<span class="close">Close</span>');
                    $(this).hide();
                    $(this).parent().find(close).show();
                });
            });
            close.each(function(i){
                close.click(function(){
                    $(this).parent(box).css("height","15px");
                    $(this).hide();
                    $(this).parent().find(open).show();
                });
            });
        });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:27:18.237

无需`.each`委托功能

```
$(document).on('click','.collapsible span.open',function(){ 
```

在这里演示[http://jsfiddle.net/CCKUz/2/](http://jsfiddle.net/CCKUz/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:34:40.027

问题是您正在`.close`动态添加跨度，因此您的初始搜索将找不到任何内容，因此它不会向它们添加任何点击处理程序。您可以使用事件委托轻松解决此问题。

```
.on('click', 'span.close', function(evt){ 
```

您还可以大大简化您的代码：

```
$(".collapsible")
  .append('<span class="open">Open</span>')
  .on('click', 'span.open', function(evt){
    // Search within the parent '.collapsible'.
    $(evt.delegateTarget)
      .css("height", "auto")
      .append('<span class="close">Close</span>');

    // Hide the '.open' span.
    $(this).hide();
  })
  .on('click', 'span.close', function(evt){
    // Search within the parent '.collapsible'.
    $(evt.delegateTarget)
      .css("height","15px");
      .find('.open').show();

    // Remove the old '.close' button since the
    // open handler will make a new one.
    $(this).remove();    
  }) 
```

# wpf - 相对源和弹出

> ID：14939632
> 
> 赞同：8
> 
> 时间：2013-02-18T15:24:03.660
> 
> 标签：wpf, silverlight, data-binding, binding

问题是`RelativeSource`在以下情况下不起作用。我用银光5。

```
//From MainPage.xaml
<Grid x:Name="LayoutRoot" Background="White" Height="100" Width="200">
    <Popup IsOpen="True">
        <TextBlock Text="{Binding Path=DataContext, RelativeSource={RelativeSource AncestorType=Grid}}" />
    </Popup>
</Grid>

//From MainPage.xaml.cs
public MainPage()
{
    InitializeComponent();
    DataContext = "ololo";
} 
```

如果我在绑定上设置断点，我会得到错误：

> System.Exception：BindingExpression_CannotFindAncestor。

如果我使用`ElementName=LayoutRoot`而不是`RelativeSource`，一切都会好起来的。

为什么相对源绑定不起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-18T16:41:35.547

Popup 就像 ContextMenu 、 ToolTip 控件，它们没有添加到 VisualTree 中。为此，您将不得不这样做

```
<Grid x:Name="LayoutRoot" Height="100" Width="200" Background="Black">
    <Popup Grid.Row="0"  x:Name="popup" DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Mode=Self}}">
        <TextBlock Text="{Binding DataContext, ElementName=popup}" Background="Red" Width="30" Height="30" />
    </Popup>
</Grid>

public MainWindow()
    {
        InitializeComponent();
        DataContext = "abcd";
        popup.PlacementTarget = LayoutRoot; 
    } 
```

我希望这会有所帮助。不像 ContextMenu 或 Tooltip 的情况，在这里您还必须指定 PlacementTarget。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-27T14:42:37.920

正如其他人所提到的，这是因为 Popup 不是视觉树的一部分。相反，您可以使用 Popup 的[PlacementTarget](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.placementtarget.aspx)属性返回可视化树：

```
<Grid x:Name="LayoutRoot" Background="White" Height="100" Width="200">
    <Popup IsOpen="True">
        <TextBlock Text="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Popup}}, 
                                  Path=PlacementTarget.DataContext}" />
    </Popup>
</Grid> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-27T13:45:29.223

您可以做一些小技巧：通过资源设置 DataContext。

```
<Grid.Resources>
    <Style TargetType="TextBlock">
        <Setter Property="DataContext" Value="{Binding ElementName=myGrid, Path=DataContext}" />
    </Style>
</Grid.Resources> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-18T16:37:52.197

弹出窗口不是可视化树的一部分。

相对源“通过指定绑定源相对于绑定目标 (MSDN) 的位置来获取或设置绑定源”。由于弹出窗口不是显示它的控件的可视树的一部分，因此它将无法解析弹出窗口之外的任何内容。

# actionscript-3 - 如何将带有鼠标单击事件的特定键事件分配给 AS3 中的此按钮数组

> ID：14939633
> 
> 赞同：0
> 
> 时间：2013-02-18T15:24:06.017
> 
> 标签：actionscript-3

我正在创建一个虚拟鼓组，它使用特定的外部声音按钮，在调用鼠标事件和按键事件时播放。目前我的鼠标事件工作正常。我不知道如何将特定的键事件（使用 T、R、P、O、E、I、U、W、Y、Q）添加到数组中的每个按钮。测试 butt1 我有一个问题是在允许关键事件之前单击按钮。这是我的代码：

```
 //initialise variables 

   //Array for buttons instances.
   var buttonsArray:Array = new Array();
   buttonsArray[0] = butt1;
   buttonsArray[1] = butt2;
   buttonsArray[2] = butt3;
   buttonsArray[3] = butt4;
   buttonsArray[4] = butt5;
   buttonsArray[5] = butt6;
   buttonsArray[6] = butt7;
   buttonsArray[7] = butt8;
   buttonsArray[8] = butt9;
   buttonsArray[9] = butt10;

   //Array for the sound clip names.
   var soundArray:Array = new Array();
   soundArray[0] = 't.mp3';
   soundArray[1] = 'r.mp3';
   soundArray[2] = 'p.mp3';
   soundArray[3] = 'o.mp3';
   soundArray[4] = 'e.mp3';
   soundArray[5] = 'i.mp3';
   soundArray[6] = 'u.mp3';
   soundArray[7] = 'w.mp3';
   soundArray[8] = 'y.mp3';
   soundArray[9] = 'q.mp3';

   //This function doesn't work as i have to click the symbol before I can 
   //use a key event. Same for all other buttons in the array. 
   butt1.addEventListener(KeyboardEvent.KEY_DOWN, tsymbolkeyhit);
   function tsymbolkeyhit(e:KeyboardEvent):void
   {
      if (e.keyCode == 84)
    {
        var s:Sound = new Sound();
        s.load(new URLRequest(soundArray[0]));
        s.play();
    }
   }

//playing acapella track with loading extertnal sound file
var my_sound:Sound = new Sound();
my_sound.load(new URLRequest("acapella.mp3"));
var my_channel:SoundChannel = new SoundChannel();
clicktoplaymusic.addEventListener(MouseEvent.CLICK, playSound);
function playSound(event:MouseEvent):void
{
    my_channel = my_sound.play();
}

//pausing the acapella track
pausebutton.addEventListener(MouseEvent.CLICK, stopSound);
function stopSound(event:MouseEvent):void
{
    my_channel.stop();
}

//custom mouse cursor;
Mouse.hide();

stage.addEventListener(Event.ENTER_FRAME, MoveMouse);

function MoveMouse(Event)
{
    drum_stick.x = mouseX;
    drum_stick.y = mouseY;

}

//This adds the mouse click event to the buttons. 
for (var i:uint = 0; i < buttonsArray.length; i++)
{
        buttonsArray[i].addEventListener(MouseEvent.CLICK, buttonClicked);
}

//plays the sound file thats clicked.;
function buttonClicked(e:MouseEvent):void
{
    for (var i:uint = 0; i < buttonsArray.length; i++)
    {
        if (e.target == buttonsArray[i])
        {
            var s:Sound = new Sound();
            s.load(new URLRequest(soundArray[i]));
            s.play();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T18:06:25.050

首先，您的键盘事件被绑定到一个对象而不是舞台。舞台接收这些事件，因此您需要在那里添加事件的侦听器。

我已经整合了你的代码。值得注意的是，我已将每个鼓声的按钮、声音文件路径和击键绑定到 soundArray 中的相同索引。优点是，当您需要将按钮/击键与适当的声音文件配对时，您的数据已经在一起，从而使播放（和设置）更容易维护。

我现在无法测试这个，它是徒手写的，所以一定要测试。希望能帮助到你。

-干杯

```
// Replace the mouse with Drumsticks.
stage.addEventListener(Event.ENTER_FRAME, MoveMouse);
Mouse.hide();
function MoveMouse(Event) {
    drum_stick.x = mouseX;
    drum_stick.y = mouseY;
}

// The array now holds the button objects, the filename, and the corresponding keys.
var soundArray:Array = [
    { "btn": butt1, "file": 't.mp3', "key": 84 },
    { "btn": butt2, "file": 'r.mp3', "key": 82 },
    { "btn": butt3, "file": 'p.mp3', "key": 80 },
    { "btn": butt4, "file": 'o.mp3', "key": 79 },
    { "btn": butt5, "file": 'e.mp3', "key": 69 },
    { "btn": butt6, "file": 'i.mp3', "key": 73 },
    { "btn": butt7, "file": 'u.mp3', "key": 85 },
    { "btn": butt8, "file": 'w.mp3', "key": 87 },
    { "btn": butt9, "file": 'y.mp3', "key": 89 },
    { "btn": butt10, "file": 'q.mp3', "key": 81 } ]

//This adds the mouse click event to the buttons. 
for each (var item:Object in soundArray) {
    item.btn.addEventListener(MouseEvent.CLICK, buttonClicked);
}
// This was registered to a button.  It needs to be on the stage.
stage.addEventListener(KeyboardEvent.KEY_DOWN, tsymbolkeyhit);

function tsymbolkeyhit(e:KeyboardEvent):void {
    // Handles playing the sound when hitting keyboard buttons.
    for each (var item:Object in soundArray) {
        // If the key we hit matches the keystroke in the array, play the appropriate sound, and break the loop.
        if (item.key == e.keyCode) {
            playKey(item.file);
            break;
        }
    }
}

function buttonClicked(e:MouseEvent):void {
    // Handles playing sound when hitting onscreen buttons.
    for each (var item:Object in soundArray) {
        // If the button we clicked matches the button in the array, play the appropriate sound, and break the loop.
        if (item.btn == e.currentTarget) {
            playKey(item.file);
            break;
        }
    }
}

function playKey(filePath:String):void {
    // Simply plays the specified file.
    var snd:Sound = new Sound();
    var channel:SoundChannel = new SoundChannel();
    snd.load(new URLRequest(filePath));
    channel = snd.play();
}

var mySound:Sound = new Sound();
mySound.load(new URLRequest("acapella.mp3"));
var myChannel:SoundChannel = new SoundChannel();
clicktoplaymusic.addEventListener(MouseEvent.CLICK, playSound);

function playSound(event:MouseEvent):void {
    myChannel = mySound.play();
}

pausebutton.addEventListener(MouseEvent.CLICK, stopSound);
function stopSound(event:MouseEvent):void {
    channel.stop();
} 
```

# php - 没有提交按钮的选择框

> ID：14939640
> 
> 赞同：0
> 
> 时间：2013-02-18T15:24:25.813
> 
> 标签：php, javascript, jquery

我想在没有提交按钮的情况下从选择框中发布我的值。并希望获取值，因为自动下拉菜单选择值

尝试下面的示例代码，但没有得到所需的输出

```
<form action="cal1.php" method="post">
  <select name="modelS" onChange="submit();">
    <option value="all" selected>Show All</option>
    <option value="3 Dr">3 Dr</option>
    <option value="5 Dr">5 Dr</option>
    <option value="Cabriolet">Cabriolet</option>
  </select>
  <input type="submit" value="confirm bike" name="alldetails">
</form> 
```

现在，能够使用以下代码获取发布值：但是如果我删除提交行（删除提交按钮）并且需要获取 POST 值，我该如何获取它们（即没有提交按钮）。我尝试使用隐藏但无法解决。

```
 <?php if(isset($_POST['submit'])){ echo $_POST['modelS'];}?>

<form action="cal1.php" method="post"> 
<select name="modelS" onchange="this.form.elements['submit'].click();">
     <option value="A" selected>Show All</option>
     <option value="B">B</option>
     <option value="C">C</option>
     <option value="D">D</option>
</select>
<INPUT TYPE="hidden" name=post VALUE=$_POST['modelS']>
<INPUT TYPE="submit" VALUE="search" name="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:27:44.017

由于您依赖提交按钮值，因此您需要模拟单击它：

```
<select name="modelS" onchange="this.form.elements['alldetails'].click();"> 
```

仅提交表单不会在`$_POST['alldetails']`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:27:10.787

```
<select name="modelS" onChange="submit(this);">
<script language="text/javascript">
    function submit(formField) {
        jQuery(formField).closest('form').submit();         
    }
</script> 
```

# xpages - 禁用扩展库

> ID：14939644
> 
> 赞同：0
> 
> 时间：2013-02-18T15:24:38.530
> 
> 标签：xpages

我新设置的数据库生成以下行

```
<script type="text/javascript">dojo.registerModulePath('extlib', '/xsp/.ibmxspres/.extlib');</script>
<script type="text/javascript" src="/xsp/.ibmxspres/.mini/dojo/.de-de/@Eya.js"></script> 
```

据我所知，它来自扩展库。但我没有在 xsp.properties 文件/页面生成 > XPages 库中激活它

我怎样才能摆脱它。我认为这与我之前的问题有关[Remove Dojo from XPages global](https://stackoverflow.com/questions/14939408/remove-dojo-from-xpages-globally)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T16:10:22.780

OneUI2.1 Theme 设置了这个值。我删除了它，一切都在我的控制之下:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:31:04.587

转到 domino 数据库的 Application Properties/Advanced 并取消选择 extlib 库。

[禁用 extlib](http://i.stack.imgur.com/3kdDG.png)

# asp.net-mvc-3 - ASP.NET MVC3 Razor 中的 KeyPairValue

> ID：14939645
> 
> 赞同：0
> 
> 时间：2013-02-18T15:24:38.513
> 
> 标签：asp.net-mvc-3, razor

我有一个奇怪的问题。

我在 Razor 中制作动态表格。我正在使用字典来存储动态添加的输入。我生成这样的代码：

```
<input type="hidden" value="96" name="Inputs[0].Key">
<input type="text" name="Inputs[0].Value"> 
```

我在我的控制器中收到 this `dictionary`。它总是有我添加的许多元素，但它们都是空的。

这是我的模型的一部分：

```
public class MetriceModelTaskSchedule
{
     public IEnumerable<KeyValuePair<long, string>> Inputs { get; set; }
} 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:27:00.253

> 这里有什么问题？

`KeyValuePair<TKey, TValue>`该类具有只读的[`Key`](http://msdn.microsoft.com/en-us/library/ms224760.aspx)和[`Value`](http://msdn.microsoft.com/en-us/library/ms224761.aspx)属性这一事实。它们没有设置器，意味着模型绑定器根本无法设置它们的值。

所以一如既往地从定义一个视图模型开始：

```
public class InputViewModel
{
    public long Key { get; set; }
    public string Value { get; set; }
} 
```

接着：

```
public class MetriceModelTaskSchedule
{
    public IEnumerable<InputViewModel> Inputs { get; set; }
} 
```

或者，您可以使用字典：

```
public class MetriceModelTaskSchedule
{
    public IDictionary<long, string> Inputs { get; set; }
} 
```

还要确保您尊重[`standard naming convention`](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)视图中的输入字段，以便模型绑定器可以成功地将它们绑定到您的模型：

```
<div>
    <input type="text" name="Inputs[0].Key" value="1" />
    <input type="text" name="Inputs[0].Value" value="value 1" />
</div>
<div>
    <input type="text" name="Inputs[1].Key" value="2" />
    <input type="text" name="Inputs[1].Value" value="value 2" />
</div>
... 
```

# hibernate - 在 Hibernate 中创建别名以引用子类问题

> ID：14939647
> 
> 赞同：0
> 
> 时间：2013-02-18T15:24:54.167
> 
> 标签：hibernate, mapping, subclass, criteria, joined-subclass

我正在尝试创建一些别名来建立一个标准来搜索许多子类的属性。这是我的模型：

```
public abstract class Entity {

protected int id;
protected PartyBasicGroup partyBasicGroup;

}

public class Person extends Entity {

}

public class Organization extends Entity {

protected PartyBasicGroup signatoryBasicGroup;
protected String jobTitle;  
} 
```

我正在尝试为 Person 和 Organization 创建一些别名，如下所示：

```
criteria = criteria.createAlias("entity.person", "person", JoinType.LEFT_OUTER_JOIN);
criteria = criteria.createAlias("entity.organization", "organization", JoinType.LEFT_OUTER_JOIN); 
```

但我收到一个错误：

```
Couldn't resolve property person for Entity 
```

任何帮助解决这个问题？我只想知道如何创建别名来引用子类以访问子类属性。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:48:28.300

我不明白你为什么要在这里使用别名。以下应该足够了：

```
Criteria criteria = session.createCriteria(Organization.class);
criteria = criteria.add(Restrictions.eq("jobTitle", "XYZ"));
List<Organization> organizations = (List<Organization>) criteria.list(); 
```

# c# - 使用 AutoMapper 映射未知类型

> ID：14939648
> 
> 赞同：11
> 
> 时间：2013-02-18T15:25:12.770
> 
> 标签：c#, .net, entity-framework, automapper

我`AutoMapper`用来将一个对象的属性复制到另一个对象：这是我的代码：

```
// Get type and create first object
Type itemType = Type.GetType(itemTypeName);
var item = Activator.CreateInstance(itemType);

// Set item properties
.. Code removed for clarity ..

// Get item from Entity Framework DbContext
var set = dataContext.Set(itemType);
var itemInDatabase = set.Find(id);
if (itemInDatabase == null)
{
    itemInDatabase = Activator.CreateInstance(itemType);
    set.Add(itemInDatabase);
}

// Copy item to itemInDatabase
Mapper.CreateMap(itemType, itemType);
Mapper.Map(item, itemInDatabase);

// Save changes
dataContext.SaveChanges(); 
```

问题是`Mapper.Map()`抛出一个`AutoMapperMappingException`：

```
Missing type map configuration or unsupported mapping.

Mapping types:
Object -> MachineDataModel
System.Object -> MyProject.DataModels.MachineDataModel

Destination path:
MachineDataModel

Source value:
MyProject.DataModels.MachineDataModel 
```

我真的不明白问题是什么，我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-18T15:28:00.993

您需要使用以下非泛型重载`Map`：

```
Mapper.Map(item, itemInDatabase, item.GetType(), itemInDatabase.GetType()); 
```

原因是您当前使用的通用版本不使用您传递的实例的运行时类型。相反，它使用编译时类型 - 编译时类型`item`是`object`因为这是`Activator.CreateInstance`.

# c# - 如何在 C# 中读出外部应用程序对话框或窗口中存在的文本

> ID：14939655
> 
> 赞同：0
> 
> 时间：2013-02-18T15:25:44.627
> 
> 标签：c#

我想要求我当前打开的文档应用程序的文件名（如 pdf、docx、xls 等），以便从我的访问数据库中自动检测密码。但是当我点击我的外部应用程序时，“密码”窗口会打开，因为我的文件应用程序受密码保护，但文件应用程序仍然没有打开，因为我还没有输入密码，我想提供这个密码作为数据库的自动检测。对于这个项目，我得到了当前活动窗口的标题，即密码，但我想知道应用程序的文件名。

带有扩展名的文件名出现在外部应用程序（pdf、docx、xls）“输入密码”对话框或窗口中。所以我的问题是，有什么方法可以读出外部应用程序（如 pdf、docx、xls 等）的“输入密码”对话框上的“文件名+扩展名”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:44:41.607

为此，您需要通过 PInvoke 访问 Windows API。

首先，您需要获取您感兴趣的窗口的句柄，请看[这里](https://stackoverflow.com/questions/11065026/get-window-state-of-another-process)的一些示例代码。

[然后，您可以使用此处描述](http://www.csharphelp.com/2006/08/get-current-window-handle-and-caption-with-windows-api-in-c/)的方法从标题栏中获取文本。

希望这足以让您入门。

# c++ - 从四元数计算向量有效，从向量计算四元数不

> ID：14939657
> 
> 赞同：1
> 
> 时间：2013-02-18T15:25:58.020
> 
> 标签：c++, math, 3d, rotation, quaternions

所以我使用四元数在 3D 空间中创建一个由两个点组成的段，并稍后尝试重新计算一个类似的四元数（一个表示穿过空间的相同向量；我知道该段围绕自身的旋转是未定义的）。我正在创建这样的细分：

```
sf::Vector3<float> Start(0, 0, 0);
sf::Vector3<float> End = Start;

//Create a vector from the start to the end
sf::Vector3<float> Translation = Orientation.MultVect(sf::Vector3<float>(0, 1, 0));

//Add that vector onto the start position
End.x += Translation.x * Length;
End.y += Translation.y * Length;
End.z += Translation.z * Length; 
```

Orientation::MultVect() 看起来像这样：

```
sf::Vector3<float> Quaternion::MultVect(sf::Vector3<float> Vector)
{
    //From http://www.idevgames.com/articles/quaternions
    Quaternion VectorQuat = Quaternion();
    VectorQuat.x = Vector.x;
    VectorQuat.y = Vector.y;
    VectorQuat.z = Vector.z;
    VectorQuat.w = 0.0;

    Quaternion Inverse = (*this);
    Inverse.Invert();

    Quaternion Result = Inverse * VectorQuat * (*this);

    sf::Vector3<float> ResultVector;
    ResultVector.x = Result.x;
    ResultVector.y = Result.y;
    ResultVector.z = Result.z;

    return ResultVector;
} 
```

现在这个函数似乎在其他情况下工作得相当好，所以我认为问题不在这里，但你永远不知道。我还应该提到，考虑到我提供的四元数 if（我从欧拉角构造，有时与其他四元数相乘），这一点最终会在我期望的地方结束。

对我来说，问题似乎在于从`Start`和重新计算四元数`End`。为此，我使用了这个函数，它在将场景中的对象定向到其他对象时效果很好（除非有问题的对象沿着完全相同的 Y 轴，在这种情况下，我得到具有 NaN 值的四元数）。我是这样做的：

```
Quaternion Quaternion::FromLookVector(sf::Vector3<float> FromPoint, sf::Vector3<float> ToPoint)
{
    ///Based on this post:
    ///http://stackoverflow.com/questions/13014973/quaternion-rotate-to
    //Get the normalized vector from origin position to ToPoint
    sf::Vector3<double> VectorTo(ToPoint.x - FromPoint.x,
                                 ToPoint.y - FromPoint.y,
                                 ToPoint.z - FromPoint.z);
    //Get the length of VectorTo
    double VectorLength = sqrt(VectorTo.x*VectorTo.x +
                               VectorTo.y*VectorTo.y +
                               VectorTo.z*VectorTo.z);
    //Normalize VectorTo
    VectorTo.x /= -VectorLength;
    VectorTo.y /= -VectorLength;
    VectorTo.z /= -VectorLength;

    //Define a unit up vector
    sf::Vector3<double> VectorUp(0, -1, 0);

    //The X axis is the cross product of both
    //Get the cross product as the axis of rotation
    sf::Vector3<double> AxisX(VectorTo.y*VectorUp.z - VectorTo.z*VectorUp.y,
                              VectorTo.z*VectorUp.x - VectorTo.x*VectorUp.z,
                              VectorTo.x*VectorUp.y - VectorTo.y*VectorUp.x);
    //Normalize the axis
    //Get the length of VectorTo
    double AxisXLength = sqrt(AxisX.x*AxisX.x +
                              AxisX.y*AxisX.y +
                              AxisX.z*AxisX.z);

    //Normalize VectorTo
    AxisX.x /= AxisXLength;
    AxisX.y /= AxisXLength;
    AxisX.z /= AxisXLength;

    //Get the adjusted Y vector
    //Get the cross product of the other two axes
    sf::Vector3<double> AxisY(VectorTo.y*AxisX.z - VectorTo.z*AxisX.y,
                              VectorTo.z*AxisX.x - VectorTo.x*AxisX.z,
                              VectorTo.x*AxisX.y - VectorTo.y*AxisX.x);
    //Normalize the axis
    //Get the length of VectorTo
    double AxisYLength = sqrt(AxisY.x*AxisY.x +
                              AxisY.y*AxisY.y +
                              AxisY.z*AxisY.z);
    //Normalize VectorTo
    AxisY.x /= AxisYLength;
    AxisY.y /= AxisYLength;
    AxisY.z /= AxisYLength;

    //A matrix representing the Thing's orientation
    GLfloat RotationMatrix[16] = {(float)AxisX.x,
                                  (float)AxisX.y,
                                  (float)AxisX.z,
                                  0,
                                  (float)AxisY.x,
                                  (float)AxisY.y,
                                  (float)AxisY.z,
                                  0,
                                  (float)VectorTo.x,
                                  (float)VectorTo.y,
                                  (float)VectorTo.z,
                                  0,
                                  0,
                                  0,
                                  0,
                                  1};

    Quaternion LookQuat = Quaternion::FromMatrix(RotationMatrix);

    //Reset the quaternion orientation
    return LookQuat;
} 
```

因此，当我计算段时，我还会检查它们的重构值，如下所示：

```
sf::Vector3<float> Start(0, 0, 0);
sf::Vector3<float> End = Start;

//Create a vector from the start to the end
sf::Vector3<float> Translation = Orientation.MultVect(sf::Vector3<float>(0, 1, 0));
//Add that vector onto the start position
End.x += Translation.x * Length;
End.y += Translation.y * Length;
End.z += Translation.z * Length;

std::cout << "STATIC END     (";
std::cout << End.x << ",";
std::cout << End.y << ",";
std::cout << End.z << ")\n";

///TEST
Quaternion Reconstructed = Quaternion::FromLookVector(Start, End);
Translation = Reconstructed.MultVect(sf::Vector3<float>(0, 1, 0));
sf::Vector3<float> TestEnd = Start;
TestEnd.x += Translation.x * Length;
TestEnd.y += Translation.y * Length;
TestEnd.z += Translation.z * Length;

std::cout << "RECONSTRUCTED END (";
std::cout << TestEnd.x << ",";
std::cout << TestEnd.y << ",";
std::cout << TestEnd.z << ")\n"; 
```

而且两者不相配。例如，如果静态终点是 (0,14.3998,0.0558498)，那么重新计算的点是 (0,8.05585,-6.39976)。不过，两者应该是相同的。旋转的未定义部分不应该改变终点的位置，只有滚动（或 Z 旋转，或任何你想称之为的），因为这是一个段，所以无关紧要。

请注意，当我最终将它用于除简单线段以外的其他事物时，滚动*将*很重要，这就是为什么我使用向上向量来确保我沿着这些线段放置的对象将始终使其顶部尽可能朝上（如果需要，可以单独确定垂直向上或向下看的物体的特殊任意滚动）。另一个目标是创建多个串在一起的片段，每个片段都相对于它之前的片段的方向旋转，而不是相对于全局空间旋转。

那么我在这里做错了什么？为什么我不能重新计算与第一个执行相同翻译的第二个四元数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T13:49:39.010

我不完全确定您如何计算两个向量之间的“旋转”四元数，但我很确定它非常麻烦。至少，如果我理解正确的话，你有指向某个方向的“看”向量，并且对象从原点（0,0,0）沿着那个方向“看”，对吗？

如果是上述情况，应该不会太难。我觉得很奇怪的一件事是你的四元数 - 向量乘法似乎是相反的顺序。我将四元数 * 向量定义为：

```
quat qt = *this * quat(0, vec.x, vec.y, vec.z) * inverse();
return vec3(qt.x, qt.y, qt.z); 
```

其中 quat 构造函数定义为 quat(w, x, y, z) 并且 inverse() 方法返回一个副本。逆等于共轭，定义为(w, -x, -y, -z)。但是，要做到这一点，你的四元数必须被归一化，只有这样它们才能真正代表一个方向（只有这样，逆才能等于共轭）。然后我将四元数乘法定义如下：

```
// This describes A * B (not communative!)
w = A.w * B.w - A.x * B.x - A.y * B.y - A.z * B.z;
x = A.w * B.x + A.x * B.w + A.y * B.z - A.z * B.y;
y = A.w * B.y + A.y * B.w + A.z * B.x - A.x * B.z;
z = A.w * B.z + A.z * B.w + A.x * B.y - A.y * B.x; 
```

有了这个，你希望能够从“角轴”构造一个四元数。这意味着它应该采用一个旋转轴，以及一个围绕该轴旋转的角度（以弧度为单位）。我将只给你那个算法，因为它在直觉上没有多大意义：

```
// if axis is already unit length, remove the division
double halfAngle = angle * 0.5f; // In radians
double scale = sin(halfAngle) / axis.magnitude();

w = cos(halfAngle);
x = axis.x * scale;
y = axis.y * scale;
z = axis.z * scale; 
```

所以现在我们只需要计算一个要旋转的轴，以及我们想要围绕它旋转多少，以弧度为单位。乍一看，这可能看起来很复杂，但这只是了解正在发生的事情的一个例子。你有两个向量，A 和 B。你想计算一个描述从 A 到 B 的旋转的四元数。为了让轴旋转，我们只需要一个与两者垂直的轴，显然这可以通过取交叉产品。如果您使用右手坐标系，它将是：

```
axis = A × B 
```

如果您使用的是左手坐标系，我认为您应该颠倒顺序，但不要相信我的话。现在得到两个向量之间的角度。这可以通过采用点积来非常简单地完成。唯一的问题是您必须对两个向量进行归一化，因此它们的长度为 1，并且不会改变点积的结果。这样，点积将返回角度的余弦，因此要获得实际角度，我们可以这样做：

```
angle = acos(normalize(A) * normalize(B)) 
```

乘号当然代表点积。现在我们只需将轴和角度插入我上面给你的算法中，我们有一个四元数描述从外观向量 A 到外观向量 B 的“旋转”。现在如果向量指向完全相同的方向，那将是不明智的应用算法，因为轴将是（0,0,0）。如果您查看算法，我希望您看到它要么尝试除以零，要么简单地输出全零。因此，每当我应用该算法时，我首先检查轴是否不全为零。

您当前使用的公式对我来说似乎很奇怪且效率低下。我也不明白为什么你首先要计算矩阵，从矩阵计算四元数是一项非常昂贵的计算。事实上，我相信计算相反的四元数矩阵会更快。

Anyway, good luck getting it to work!

# asp.net-mvc - 带有列表的 ASP.NET MVC3 模型

> ID：14939659
> 
> 赞同：0
> 
> 时间：2013-02-18T15:26:07.140
> 
> 标签：asp.net-mvc, list, validation

我在 MVC 3 中遇到了一个小问题。我正在创建一个应用程序，其中我的模型，一个装运，包括以下内容：

*   用户 ID（字符串，必填）
*   参考 ID（字符串，可选）
*   订单 ID 列表（字符串，不能为空）

应用程序的索引视图是用户创建货件（模型）的位置。完成此操作后，用户将不再与它进行交互（没有编辑、详细信息或列表视图）。

我的问题是这个。我正在尝试使用一种表单来添加订单 ID 和创建货件本身，使用两个单独的按钮进行提交（“添加”用于添加订单 ID，“发送”用于创建货件）。似乎当我使用控制器的创建操作时，按下“发送”会用一个空的订单 ID 覆盖我的订单 ID 列表。但是，如果我提交到索引操作，并在按下“发送”时重定向到创建，我的模型验证就消失了（ModelState 只包含“提交”）。

现在我正在使用会话在我的控制器操作周围传递数据，这可能不是最好的方法。

TLDR；我需要一种方法将项目添加到模型中的列表中，一次一个，同时保留其他表单数据，并且仍然能够验证它。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:26:07.173

最好看一下您的操作，因为不太清楚您在那里做什么，但看起来您仍然在尝试使用相同的数据结构来传递不同的参数提示（一个包含列表，另一个包含一般数据） . 我认为最好在每个动作中提交不同的数据结构并构建所需的结果数据对象。

# asp.net - 为使用证书和签名保护的第 3 方 Web 服务配置 ASP.Net 客户端

> ID：14939662
> 
> 赞同：0
> 
> 时间：2013-02-18T15:26:13.113
> 
> 标签：asp.net, wcf, soap, .net-3.5, certificate

我正在尝试从头开始为**第 3 方 Web服务创建客户端。**我在**soapUI**中有一个有效的解决方案，它使用带有下图所示签名的证书。

![在此处输入图像描述](../Images/b7b24b6da6acbbfc3a97b8cb397b1f39.png)

我**对 SOA 和 SOAP 很陌生**，我的主要问题是如何开始使用**.NET 3.5 和 ASP.Net**。该服务通过使用“添加服务引用”链接到我的项目，但现在怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:22:51.467

我解决了我的问题，但由于我是新手，所以遇到了 10 个问题。

例如**“Timestamp must be signed error in response”**，您可以在[此处](https://stackoverflow.com/questions/15199181/timestamp-must-be-signed-error-in-response)阅读解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T19:38:45.133

通常，会在您配置服务引用时提供的命名空间中为您创建一个处置 Web 服务消费者类。此类消费者的默认命名空间将位于 under `ServiceReference1`，并且客户端将使用约定命名`WebServiceNameClient`。该消费者将拥有代表可以在 Web 服务上调用的所有请求的成员方法，例如：

**C＃**

```
My.Project.Root.ServiceReference1.WebServiceNameClient client = new My.Project.Root.ServiceReference1.WebServiceNameClient();
string action = "GET";
int id = 1;
var result = client.DoWebServiceWork(action, id); 
```

**VB.NET**

```
Dim client As New My.Project.Root.ServiceReference1.WebServiceNameClient()
Dim action As String = "GET"
Dim id As Integer = 1
Dim result = client.DoWebServiceWork(action, id) 
```

# mysql - 在 MySQL 中按子查询的结果排序

> ID：14939663
> 
> 赞同：4
> 
> 时间：2013-02-18T15:26:22.820
> 
> 标签：mysql, subquery

我有一个表，其中包含所有可下载项目的记录，另一个表包含每个下载的记录，其中包括下载日期和项目的 id 以及下载它的用户。

当我从数据库中获取项目列表时，我希望查询查找项目已下载多少次并将其与其他项目数据一起包含。

这是我的 SQL：

```
SELECT t1.*, 
(SELECT COUNT(*) 
    FROM tl_downloads 
    WHERE item_id = t1.id
    AND download_date > ?) 
AS downloads_count 
FROM tl_items AS t1 
ORDER BY downloads_count DESC 
```

上面的查询工作正常，因为我在结果中得到一个名为“downloads_count”的额外列，其中包含正确的计数，但它不会让我按这个值排序。

我需要做什么才能按子查询中返回的值对我的结果进行排序？

如果您需要更多信息，请告诉我！

编辑 - 示例数据

```
tl_items                tl_downloads

id  name                id  item_id  download_date
1   Item 1              1   1        1385964000 
2   Item 2              2   1        1385964000
3   Item 3              3   3        1385964000 
```

我期望的结果是：

```
Item 1 - Downloads 2
Item 3 - Downloads 1
Item 2 - Downloads 0 
```

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-18T15:29:02.033

尝试，

```
SELECT  t1.*, 
        s.totalCount AS downloads_count 
FROM    tl_items AS t1 
        LEFT JOIN
        (
            SELECT  item_id, COUNT(*) totalCount 
            FROM    tl_downloads 
            WHERE   download_date > ?
            GROUP   BY item_id
        )  s ON s.item_id = t1.id
ORDER   BY downloads_count DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:54:00.467

除非我忽略了它，否则期望结果中包含 0 次下载并且有下载日期限制似乎与我相矛盾。

```
SELECT tt1.id, COUNT(tt2.id) AS DOWNLOAD_COUNT
FROM t1_items tt1
LEFT JOIN t1_downloads tt2 ON tt1.id = tt2.item_id
WHERE download_date > 1385963000 OR download_date IS NULL
GROUP BY tt1.id
ORDER BY DOWNLOAD_COUNT DESC 
```

上面的查询将返回预期的结果。

[http://www.sqlfiddle.com/#!2/29b39/13](http://www.sqlfiddle.com/#!2/29b39/13)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-24T16:28:28.567

尚未测试，但另一种方法：

```
SELECT t1.* 
FROM tl_items AS t1 
ORDER BY 
(SELECT COUNT(*) totalCount
FROM tl_downloads 
WHERE item_id = t1.id
AND download_date > ? ORDER BY totalCount [desc]) 
```

对？由于没有连接，可能更快。

# java - 如何通过 ID 和 NamedNodeMap 获取 XML 节点 - Java DOM XML

> ID：14939667
> 
> 赞同：2
> 
> 时间：2013-02-18T15:26:30.343
> 
> 标签：java, xml, dom

我有一个带有消息的 xml 文件：

```
<bus>
    <message id="58afdb36-9080-4dd8-922e-ee516b2b5073">
    <retrievedDate>Mon Feb 18 14:43:23 GMT 2013</retrievedDate>
    <addedDate>Mon Feb 18 14:43:23 GMT 2013</addedDate>
    <state>initialised</state>
    <content>content placeholder</content>
    </message>
</bus> 
```

我正在创建一种方法来更改给定 ID 的消息状态。

但是，当我尝试获取具有所需 ID 的节点时，我不断收到 NullPointerException。尝试过使用***getElementById***和***getElementsByTagName***，但我总是得到 null 而不是我想要的节点。

```
public static int updateMessageState(UUID messageID, String newState) 
        throws ParserConfigurationException, 
                SAXException, IOException, TransformerException {

    String filepath = "data.xml";
    DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder docBuilder = docFactory.newDocumentBuilder();
    Document doc = docBuilder.parse(filepath);

    // Get Message
    Node message = doc.getElementById(messageID.toString());

    // Find and update the state
    NamedNodeMap atrMap = message.getAttributes();
    Node nodeAtr = atrMap.getNamedItem("state");
    nodeAtr.setTextContent(newState);

    // Save write to XML
    TransformerFactory transformerFactory = TransformerFactory.newInstance();
    Transformer transformer = transformerFactory.newTransformer();
    DOMSource source = new DOMSource(doc);
    StreamResult result = new StreamResult(new File(filepath));
    transformer.transform(source, result);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:53:22.350

使用`getElementById()`时必须确保属性“id”的**类型**是`ID`，否则方法将返回 null。见[这里](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Document.html#getElementById%28java.lang.String%29)。

我没有看到您如何使用的示例，`getElementsByTagName(String str)`因此我将提供一个示例。使用时，`getElementsByTagName()`您实际上会得到一个`NodeList`对应于具有标签的元素。在您的示例中，您将使用`doc.getElementsByName("message")`它来检索消息元素的节点列表。然后，您可以使用节点列表来查找您要查找的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-30T16:29:50.763

您可以使用 Element 获取 ID：

```
// Get the main element by tag name
Node bus = doc.getElementsByTagName("bus").item(0);

//get a NodeList
NodeList list = bus.getChildNodes();
for (int i = 0; i < list.getLength(); i++) {
    Node node = list.item(i);
    System.out.println("\nCurrent Element :" + node.getNodeName());
    if (node.getNodeType() == Node.ELEMENT_NODE) {
        Element eElement = (Element) node;
        System.out.println(" id : " + eElement.getAttribute("id"));
    }
} 
```

# debugging - dbxtool：调试可执行文件并使用参数运行

> ID：14939668
> 
> 赞同：2
> 
> 时间：2013-02-18T15:26:33.830
> 
> 标签：debugging, unix

如何从 unix 的命令行调试可执行文件并使用 dbxtool 中的参数运行？根据帮助应该是：

`-r <executable> <arg> ...`

这有效：

```
dbxtool -r /home/user/mybinaryfile 
```

但是，如果我添加这样的参数：

```
dbxtool -r /home/user/mybinaryfile -s1 
```

或像这样：

`dbxtool -r /home/user/mybinaryfile '-s1'`

我收到以下错误：

```
dbxtool: Unrecognized option '-s1' 
```

该参数是可执行文件的参数，而不是 dbxtool 的参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T07:22:37.420

答案可以在这个链接中找到：[https ://forums.oracle.com/forums/thread.jspa?messageID=8530395](https://forums.oracle.com/forums/thread.jspa?messageID=8530395)

\\-s1 对我有用，但“'-s1'”没有。

# php - 在 PHP 中提交表单后显示弹出消息

> ID：14939671
> 
> 赞同：1
> 
> 时间：2013-02-18T15:26:43.533
> 
> 标签：php

我在这个论坛上尝试了很多东西，但我无法让重定向工作或任何事情。按照我写的方式，它会显示一个带有成功消息的新页面，但用户必须通过浏览器备份才能发现自己的所有信息仍然显示。

我需要清除这些框并弹出成功消息。我该怎么做呢？

谢谢，

这是我的 php

```
<?php
if(isset($_POST['email'])) {

// EDIT THE 2 LINES BELOW AS REQUIRED
$email_to = "lotusms@outlook.com";
$email_subject = "Your email subject line";

function died($error) {
    // your error code can go here
    echo "We are very sorry, but there were error(s) found with the form you submitted. ";
    echo "These errors appear below.<br /><br />";
    echo $error."<br /><br />";
    echo "Please go back with the browser back button and fix these errors.<br /><br />";
    die();
}

// validation expected data exists
if(!isset($_POST['name']) ||
    !isset($_POST['phone']) ||
    !isset($_POST['email']) ||
    !isset($_POST['service']) ||
    !isset($_POST['bedrooms']) || 
    !isset($_POST['bathrooms'])){
    died('We are sorry, but there appears to be a problem with the form you submitted.');       
}

$name = $_POST['name']; // required
$phone = $_POST['phone']; // required
$email_from = $_POST['email']; // required
$service = $_POST['service']; // required
$bedrooms = $_POST['bedrooms']; // not required
$bathrooms = $_POST['bathrooms']; // not required

$error_message = "";
$email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
   if(!preg_match($email_exp,$email_from)) {
     $error_message .= 'The Email Address you entered does not appear to be valid.<br />';
     }
     $string_exp = "/^[A-Za-z .'-]+$/";
     if(!preg_match($string_exp,$name)) {
     $error_message .= 'The name you entered does not appear to be valid.<br />';
     }

    $string_exp = "/^[0-9]{3}-[0-9]{3}-[0-9]{4}$/";
  if(!preg_match($string_exp,$phone)) {
     $error_message .= 'The number you entered does not appear to be valid.<br />';
    }

    if(strlen($error_message) > 0) {
      died($error_message);
     }
     $email_message = "The following quote has been requested. \n\n";

function clean_string($string) {
  $bad = array("content-type","bcc:","to:","cc:","href");
  return str_replace($bad,"",$string);
}

$email_message .= "Name: ".clean_string($name)."\n";
$email_message .= "Phone: ".clean_string($phone)."\n";
$email_message .= "Email: ".clean_string($email_from)."\n";
$email_message .= "Service: ".clean_string($service)."\n";
$email_message .= "Bedrooms: ".clean_string($bedrooms)."\n";
$email_message .= "Bathrooms: ".clean_string($bathrooms)."\n";

 // create email headers
  $headers = 'From: '.$email_from."\r\n".
  'Reply-To: '.$email_from."\r\n" .
  'X-Mailer: PHP/' . phpversion();
  @mail($email_to, $email_subject, $email_message, $headers); 
 ?>

 <!-- include your own success html here -->

 <?php
  }
  ?> 
```

这是我的表格

```
<form action="bin/quote.php" method="post" id="search" enctype="multipart/form-data" onSubmit="alert('Thank you!')"; >
   <table summary="Search form" cellspacing="2" cellpadding="5">                     
      <tr>
          <th style="color:#c1c2c3; font-weight:bold">REQUEST A QUOTE</th>
        </tr>                       
      <tr>
          <td colspan="5">Name: <input style="margin-left: 55px" type="text" class="text" name="name" /></td>
        </tr>
      <tr>
          <td colspan="10">Phone:<input style="margin-left: 55px" type="text" class="text" name="phone" placeholder="XXX-XXX-XXXX" /></td>
        </tr>
      <tr>
          <td colspan="5">Email:<input style="margin-left: 55px" type="text" class="text" name="email" /></td>
        </tr>
      <tr>
          <th>Service Required:</th>
        <td colspan="3">
           <select name="service">
              <option value="Residential Move">Residential Move*</option>
              <option value="Commercial Move">Commercial Move*</option>
              <option value="Storage Unit Loading">Storage Unit Loading</option>
              <option value="Storage Unit Unloading">Storage Unit Unloading</option>
              <option value="Furniture Consignment">Furniture Consignment</option>
              <option value="Assembly/Removal">Assembly/Removal</option>
              <option value="Landscaping">Landscaping</option>
              <option value="Cleanout">Cleanout</option>
              <option value="General Help">General Help</option>
           </select>
        </td>
      </tr>
      <tr>
        <td style="color:#c1c2c3"><b>*If a move...</b></td>
      </tr>
      <tr>
        <th>Bedrooms:</th>
        <td>
           <select name="bedrooms">
               <option value="1">1</option>
               <option value="2">2</option>
               <option value="3">3</option>
               <option value="4">4</option>
               <option value="5">5+</option>
           </select>
        </td>                          
        <th>Bathrooms:</th>
        <td>
           <select name="bathrooms">
               <option value="1">1</option>
               <option value="2">2</option>
               <option value="3">3</option>
               <option value="4">4</option>
               <option value="5">5+</option>
           </select>
        </td>
      </tr>
      <tr>                              
        <td><a onclick="document.getElementById('search').submit()"><button type="submit" value="SEND" class="more">Send</button></a></td>
      </tr>
   </table>
</form> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:34:45.080

使用重定向：

```
...
@mail($email_to, $email_subject, $email_message, $headers);
header('location: success.php'); //send them wherever you want so they don't have to use back button
die(); 
```

# ruby-on-rails - 通过 Rails 3.2.12 + Heroku 缓慢加载资源

> ID：14939673
> 
> 赞同：1
> 
> 时间：2013-02-18T15:26:47.477
> 
> 标签：ruby-on-rails, heroku, cdn, assets

我有一个使用 Rails 3.2.12 部署到 Heroku 的应用程序，并且在尝试加载一些已编译的资产时遇到了很多缓慢 - 有时甚至失败。我检查了使用 Firebug 的网络面板并检查了我的 NewRelic 报告。这也发生在客户应用程序中。

我尝试将资产部署到 CloudFront，但我使用的是 FontAwesome 图标集，并且由于 CORS 问题，Firefox 无法正确显示这些图标 - 到目前为止，我无法使用任何描述的库或技术正确解决该问题。以下是我尝试过的总结：

*   使用 Rack::Cache、Dalli 和 MemCachier 进行缓存：有点帮助，但不能解决问题。
*   使用 Rack::Deflater 压缩资产：同样，有帮助，但仍不能解决问题。
*   使用 Cloudfront：打破 Firefox 上的自定义字体。
*   使用带有 rack-cors / before_filter 的 Cloudfront 插入 CORS 标头 / 自定义中间件插入 CORS 标头：什么都没有。我可以用 curl 检查是否提供了正确的 CORS 标头，但是……没有成功。
*   使用 S3 和 assets_sync: 不起作用。未提供任何资产。
*   使用 font_assets: 不起作用，与直接使用 Cloudfront 的问题相同。
*   在 assets_host 配置上使用 proc 在本地提供字体以及来自 CDN 的所有其他内容：破坏 assets:precompile 任务。

那么，有没有人遇到过类似的问题或知道如何解决这个问题？

干杯!

# perl - 将 csh 开关转换为 perl

> ID：14939679
> 
> 赞同：0
> 
> 时间：2013-02-18T15:27:11.053
> 
> 标签：perl, csh

我目前正在将一些脚本从 csh 翻译成 perl。我遇到了一个具有以下开关控制的脚本

```
#And now some control
set get_command = h
set finish = 0

while (1)

    switch ($get_command)
    case "h":
    case "H":
    set cine_command = ""

cat << EOF
Control synchronised cine by (case insensitive):
  A        - A view data
  B        - B view data
  a        - accelerate
  d        - decelerate
  r        - real time heart rate
  <num>    - rate (frames per second)
  i        - toggle interpolation
  s        - step through (may lose a little synchronisation)
  c        - continue (restart) after stepping
  y        - reverse direction
  h        - help (repeat this)
  f        - finish (quit)
  q        - quit (finish)
  <return> -  quit
EOF

    breaksw

    case "":
    case "f":
    case "F":
    case "q":
    case "Q":
        set cine_command = '-f'
        set finish = 1
    breaksw

    case "a":
        set cine_command = '-a'
    breaksw

    case "d":
    case "D":
        set cine_command = '-d'
    breaksw

    case "r":
        case "R":
        set cine_command = "-t $time_per_frame"
    breaksw

    case "i":
    case "I":
        set cine_command = '-i'
    breaksw

    case "s":
    case "S": 
        set cine_command = "-s"
    breaksw

    case "c":
    case "C":
        set cine_command = "-c"
    breaksw

    case "y":
    case "Y":
        set cine_command = "-y"
    breaksw

    case '[0-9]*':
        set cine_command = "-r $get_command"
    breaksw

    default:
        echo "$get_command ignored"
        set cine_command = ""
    endsw

    if ('$cine_command' != '') then
    select_tv $FIRST_TV
    cine $cine_command
    select_tv $SECOND_TV
    cine $cine_command
    endif

    #
    # If we're stopping then get out of this loop.
    #
    if ($finish) break

    echo -n "cine > "
    set get_command = $<

end 
```

我在我的系统上安装了 Perl 5.8.8，`use Strict;`并且我知道在下一个 perl 版本中可能会弃用它，我尝试了以下

```
#Add some fine control to script
my $get_command = 'h';
my $finish = 0;
my $cine_command;

while(<>)
  {
      switch ($get_command)
      {

    case [hH] {$cine_command = "";}

    print STDOUT << 'END';
Control synchronised cine by (case insensitive):
  A        - A view data
  B        - B view data
  a        - accelerate
  d        - decelerate
  r        - real time heart rate
  <num>    - rate (frames per second)
  i        - toggle interpolation
  s        - step through (may lose a little synchronisation)
  c        - continue (restart) after stepping
  y        - reverse direction
  h        - help (repeat this)
  f        - finish (quit)
  q        - quit (finish)
  <return> -  quit
END

      case [fFqQ] 
        {
         $cine_command = '-f';
         $finish = 1;
         }

      case "a"
        {
         $cine_command = '-a';
        }

      case [dD]
        {
         $cine_command = '-d';
         }

      case [rR]
        {
         $cine_command = "-t $time_per_frame";
         }

      case [iI]
        {
         $cine_command = '-i';
         }

      case [sS]
        {
         $cine_command = '-s';
         }

      case [cC]
        {
         $cine_command = '-c';
         }

      case [yY]
        {
         $cine_command = '-y'
         }

      case /\d/
        {
         $cine_command = "-r $get_command";
        }

      else 
        {
          print "$get_command ignored\n";
          $cine_command = "";
          }

    if ($cine_command ne "") 
      {
        `select_tv $FIRST_TV`;
        `cine $cine_command`;
        `select_tv $SECOND_TV`;
        `cine $cine_command`;
      }

    exit if( $finish == 1);

    print STDOUT "cine > \n";
    chomp(my $get_command = <STDIN>);

      }

  } 
```

当我按下回车键时，我会在终端上打印出所需的选项。但是，当我在 STDIN 中输入任何选项时——例如 a、h 或 d——我没有得到任何响应。当我输入 retirn - 我得到消息“h被忽略”按预期打印到终端。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T21:02:13.357

对于那些说*获得更新版本的 Perl 的*人：不是每个人都可以控制他们的系统。如果 OP 在 Red Hat 上，它可能是公司机器，这意味着 OP 无法控制它。Redhat 上 Perl的**最新版本是 5.8.8。**我们可能认为它过时和过时，但许多企业版的 Perl 都使用它。

我在我控制的本地机器上拥有最新最好的 Perl 版本，但我必须使用 Perl 5.8.8 语法编写，而且我不得不假设我无法下载任何 CPAN 模块。

这是真实的生活，它可能很糟糕。但是，你必须忍受它......

* * *

首先，Perl 和 Csh 完全是两种语言，将任何一种语言逐行翻译成另一种语言并不是一个好主意。Perl 是一种更强大的语言，使用许多功能来改进您的 csh 脚本可能会很好。

如果您正在解析命令行，请考虑使用模块[Getopts::Long](http://perldoc.perl.org/5.8.8/Getopt/Long.html)，它将为您完成大量工作，并且在 Perl 5.8.8 中可用。这可能完全符合您对 switch 语句所做的工作，并且工作量更少，并且更加灵活。

我会避免`switch`在 Perl 中使用该语句。它从来没有真正运作得很好。新的`given/when`东西效果更好，但可惜的是，它只能从 Perl 5.10 开始使用。

相反，忘记 switch 的东西并使用`if/elsif`结构然后 case 语句：

```
my $usage =<<USAGE;
Control synchronised cine by (case insensitive):
  A        - A view data
  B        - B view data
  a        - accelerate
  d        - decelerate
  r        - real time heart rate
  <num>    - rate (frames per second)
  i        - toggle interpolation
  s        - step through (may lose a little synchronisation)
  c        - continue (restart) after stepping
  y        - reverse direction
  h        - help (repeat this)
  f        - finish (quit)
  q        - quit (finish)
  <return> -  quit
USAGE

$cine_command;
$finish;
while ( my $command = get_command() ) {
    if   ( $command =~ /^h$/i ) {
        print "$usage\n";
        exit 0;
    }
    elsif ( $command =~ /^(fq)$/i ) {
        $cine_command = '-f'
        $finish = 1
    }
    elsif ( $command =~ /^a$/i ) {
        $cine_command = '-a';
    }
    elsif ... 
```

它不像*switch*语句那样优雅，但它可以完成工作并且易于理解和维护。还可以利用正则表达式匹配。例如`$command =~ /^(fq)$/i is checking to see if`$command `is equal to`F `,`f `,`q `, or`Q` 同时进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T17:34:19.703

`while(<>){}`在 perl 中不等同于`while(1)`在 csh 中。`while(<>)`在 perl 中相当于`while(defined($_ = <>))`which is a read and check to see that eof has not been reached。尝试替换`while(<>)`为`while(1)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T01:42:46.043

您可能会查看[App::Cmd](https://metacpan.org/module/App%3a%3aCmd%3a%3aTutorial)之类的内容，以获得具有很多选项的大型程序。否则，子引用的散列可能适用于委派而不是 switch 语句。

# android - 使用没有 Activity / EasyTracker 的 Google Analytics v2

> ID：14939689
> 
> 赞同：3
> 
> 时间：2013-02-18T15:27:28.003
> 
> 标签：android, google-analytics

使用 EasyTracker 时：

```
@Override
    protected void onStart() {
        super.onStart();

        EasyTracker.getInstance().activityStart(this);
    } 
```

它工作得很好，我从旧版本的分析中集成的问题，我在服务中而不是在活动中使用它，所以我不能使用 activityStart 方法。

我尝试使用：

```
GoogleAnalytics googleAnalytics = GoogleAnalytics.getInstance(getApplicationContext());
final Tracker tracker = googleAnalytics.getTracker("UA-xxxxxx-y");
tracker.setStartSession(true);

tracker.sendView("/page"); 
```

而且我在分析中看不到任何东西（即使在 GAServiceManager.getInstance().dispatch() 之后）......

有没有办法在没有活动的情况下使用新版本的分析？？？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T08:59:38.430

找到了不使用 EasyTracker 的方法。它实际上在官方网站上： [https ://developers.google.com/analytics/devguides/collection/android/v2/advanced](https://developers.google.com/analytics/devguides/collection/android/v2/advanced)

基本上这就是你需要做的：起初跟踪器是这样的：

```
// Get the GoogleAnalytics singleton.
mGaInstance = GoogleAnalytics.getInstance(this);

// Use the GoogleAnalytics singleton to get two Trackers with
// unique property IDs.
mGaTracker = mGaInstance.getTracker("UA-XXXX-Y"); 
```

然后你可以像这样得到跟踪器：

```
mGoogleAnalytics.getDefaultTracker(); 
```

并像这样使用它：

```
mGoogleAnalytics.sendEvent(.....);

mGaTracker.sendView(....); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:34:39.037

在服务中，您需要在发送视图之前设置上下文

试试这个：

```
EasyTracker.getInstance().setContext(this);
EasyTracker.getTracker().sendView("/page"); 
```

# php - 带有过滤器的 mongodb geoNear 命令

> ID：14939698
> 
> 赞同：0
> 
> 时间：2013-02-18T15:27:50.907
> 
> 标签：php, mongodb

在使用 mongodb 的 geoNear 命令和附加查询来过滤结果时，我遇到了一些问题。以下查询是使用 rockmongo 进行的。

在我的集合“poi”中，文档有“profiles”，它是一个包含 objectids 的数组。搜索它们时：

```
{
  geoNear : "poi",
  near : [19,47],
  query : {profiles : ObjectId("511f360901c610e813000004")}
} 
```

我没有结果。

```
Response from server: {    "ns": "local.poi",    "near": "1100010010100011101101101111001010100011101101101111",    "results": [
        ],    "stats": {
     "time": NumberInt(2),
     "btreelocs": NumberInt(0),
     "nscanned": NumberInt(510),
     "objectsLoaded": NumberInt(510),
     "avgDistance": 0,
     "maxDistance": 0    },    "ok": 1  } 
```

但是，如果没有查询，甚至使用简单的 {profiles : ObjectId("511f360901c610e813000004")} 查询，我都会得到预期的结果。

另一个问题是当我有大约一半的文档带有“name”“x”，而另一半带有“y”时，查询

```
{
  geoNear : "poi",
  near : [47,19.5],
  query : {"$and" : [{name : { "$in" : [/.*y.*/i]}}]}
} 
```

当简单的 {"$and" : [{name : { "$in" : [/. *是的。*/i]}}]} 给他们。这个示例查询实际上可以很简单，尽管结果没有区别，这更像是我在项目中的实际查询。

当我用 PHP 尝试这些时，无论是否传递了额外的查询，我都会得到结果，因此每个文档都按距离排序。

请帮我看看我是否做错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T16:18:04.793

好的，问题出在 PHP 驱动程序上。我发现它可以在 mongo shell 中工作，所以我切换回 1.3.1，现在它可以工作了！

# html - 用一个滚动条滚动两个容器

> ID：14939699
> 
> 赞同：0
> 
> 时间：2013-02-18T15:28:00.533
> 
> 标签：html, css, scrollbar, overflow

我正在尝试仅使用一个滚动条来控制两个容器。我有一个大容器，我移动（使用 CSS 翻译）以显示另一个粘在屏幕和右侧的容器。你可以在这里看到我的实验：

[http://codepen.io/anon/pen/ipaCI](http://codepen.io/anon/pen/ipaCI)

我想要的是仅使用外部滚动条（控制大 div 和大 div）来滚动两者。我不是在寻找任何同步滚动，我希望滚动条首先向右滚动小容器，当它到达末尾时，我希望它向左滚动大容器。

我已经尝试尝试在包含这两者的主体上设置一个溢出-y：滚动 - 但我似乎无法控制右侧的那个。是因为固定了吗？如果我将其设置为绝对位置，它只会像页面的一部分一样跟随 - 这不是预期的效果。

有没有人成功实施过这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T12:18:02.957

我已经搜索了插件来执行此操作，但找不到任何插件。我自己使用 jquery 想出了一个解决方案：

```
var $window = $(window),
  $panel = $('.right-panel'),
  windowPos = $window.scrollTop(),
  scrollPos = $window.scrollTop(),
  maxPos = $('.panel', $panel).height() - $window.height();

$window.on('scroll.panels-handler', function() {
  var scrollDelta = $window.scrollTop() - windowPos;
  windowPos = $window.scrollTop();
  scrollPos += scrollDelta;

  if (scrollPos < 0) {
    scrollPos = 0;
  } else if (scrollPos > maxPos) {
    scrollPos = maxPos;
  }
  $panel.scrollTop(scrollPos);
}); 
```

我为容器添加了最小和最大滚动值。基本上 - 它总是先滚动侧边栏 - 直到它到达终点 - 然后只滚动主窗口。

我不知道如何只滚动侧边栏（主总是滚动） - 但我对解决方案感到满意。

请参阅原始代码笔以获取工作演示

[http://codepen.io/anon/pen/ipaCI](http://codepen.io/anon/pen/ipaCI)

# python - Python中的数组操作

> ID：14939703
> 
> 赞同：3
> 
> 时间：2013-02-18T15:28:06.687
> 
> 标签：python, arrays, cycle

如何在 Python 中执行以下操作：

```
array_1 = [x1, x2, x3, x4, x5, x6, ....]
array_2 = [y1, y2, y3]

array_3 = [(x1-y1), (x2-y2), (x3-y3), (x4-y1), (x5-y2), (x6-y3)] 
```

中的元素数`array_2`总是小于 中的元素数`array_1`。

`array_1`并且`array_2`有任意数量的元素。

`[num of elements in array_1]`模`[number of elements in array_2]`数 = 0

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-18T15:31:43.943

```
from itertools import izip, cycle

array_3 = [a - b for a, b in izip(array_1, cycle(array_2))] 
```

这将适应 array_2 的任意大小。

这里[`itertools.izip()`](http://docs.python.org/2/library/itertools.html#itertools.izip)将两个列表中的元素组合成对，该[`itertools.cycle()`实用程序](http://docs.python.org/2/library/itertools.html#itertools.cycle)将一遍又一遍地重用第二个列表以提供配对的东西。

如果您不需要列表作为输出，只需要遍历结果，您也可以使用[`itertools.imap()`](http://docs.python.org/2/library/itertools.html#itertools.imap)and [`operator.sub`](http://docs.python.org/2/library/operator.html#operator.sub)：

```
from itertools import imap, cycle
import operator

for result in imap(operator.sub, array_1, cycle(array_2)):
    # do something with the result 
```

对于大型输入列表，这使您不必将中间结果存储在另一个列表中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-18T15:32:42.957

Itertools 有很多工具可以解决您的问题

了解您的问题

1.  一个数组比另一个短
2.  较短的数组应该[循环](http://docs.python.org/2/library/itertools.html#itertools.cycle)，直到较长的数组用完
3.  [创建一对](http://docs.python.org/2/library/itertools.html#itertools.izip)较长的阵列和循环的较短阵列
4.  [减去对中的元素](http://docs.python.org/2/library/itertools.html#itertools.starmap)

所以这里是实现

```
>>> arr1 = range(1,10)
>>> arr2 = range(20,23)
>>> from operator import sub
>>> from itertools import izip, cycle, starmap
>>> list(starmap(sub, izip(arr1, cycle(arr2))))
[-19, -19, -19, -16, -16, -16, -13, -13, -13] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-18T15:30:03.537

您可以`operator.sub`使用`map`：

```
array_3 = map(operator.sub,array_1,array_2+array_2) 
```

或者，你可以这样做`zip`：

```
array_3 = [x-y for x,y in zip(array_1,array2+array2)] 
```

[您可以使用itertools.cycle](http://docs.python.org/2/library/itertools.html#itertools.cycle)摆脱 array2 与自身的愚蠢连接

```
array_3 = [x-y for x,y in zip(array_1,cycle(array_2))] 
```

# java - 添加天数后如何获得 Joda-Time 的确切月差

> ID：14939706
> 
> 赞同：1
> 
> 时间：2013-02-18T15:28:16.073
> 
> 标签：java, jodatime

我试图找到两个日期之间的月数。任何帮助表示赞赏。我在下面的示例中使用[Joda-Time](http://www.joda.org/joda-time/)。

```
DateMidnight start = new DateMidnight(new Date()); 
DateMidnight dtEndDate  = start.plusDays(11);   //adding Days

int months = Months.monthsBetween(start, dtEndDate).getMonths();

System.out.println("Months between " +
                    start.toString("yyyy-MM-dd") + " and " +
                    dtEndDate.toString("yyyy-MM-dd") + " = " +
                    months + " month(s)"); 
```

以上代码在 2013 年 2 月 18 日至 2013 年 3 月 1 日返回“0”

我无法将 +1 添加到月份，因为我需要找到同一个月的差异，我还需要找到两个经过期间之间的差异，即“2012 年 12 月 4 日”和“2013 年 1 月 6 日”之间应该返回 -1 ;

```
scenario1:

date1:  2013-02-18
    date1.plusDays(11);
date2:  2013-03-01
Output : 0 month(s)   //but I need as 1 Month

scenario2:
date1:  2013-02-18
    date1.plusDays(1);
date2:  2013-02-19
Output : 0 month(s)   //returns correctly exactly what I need

scenario3:
date1:  2013-03-18
date2:  2013-02-19
Output should be : -1 month(s) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T15:51:50.660

`1`在比较之前将两个日期的日期设置为：

```
startModified = start.withDayOfMonth(1); 
endModified = end.withDayOfMonth(1);
int months = Months.monthsBetween(startModified, endModified).getMonths(); 
```

# java - JMF + mp3plugin.jar mp3 文件无法播放

> ID：14939709
> 
> 赞同：1
> 
> 时间：2013-02-18T15:28:21.780
> 
> 标签：java, mp3, javasound, jmf

我有这个代码：

```
 package test;

import java.io.File;

import javax.media.Format;
import javax.media.Manager;
import javax.media.MediaLocator;
import javax.media.Player;
import javax.media.PlugInManager;
import javax.media.format.AudioFormat;

public class AudioTest {
    public static void main(String[] args) {
        Format input1 = new AudioFormat(AudioFormat.MPEGLAYER3);
        Format input2 = new AudioFormat(AudioFormat.MPEG);
        Format output = new AudioFormat(AudioFormat.LINEAR);
        PlugInManager.addPlugIn(
            "com.sun.media.codec.audio.mp3.JavaDecoder",
            new Format[]{input1, input2},
            new Format[]{output},
            PlugInManager.CODEC
        );
        try{
            Player player = Manager.createPlayer(new MediaLocator(new File("1.mp3").toURI().toURL()));
            player.realize();
                        player.start();
        }
        catch(Exception ex){
            ex.printStackTrace();
        }
    }
} 
```

我正在尝试播放 mp3 文件，将 mp3plugin 添加到项目库以及 jmf jar 中。控制台上没有错误，但听不到声音。

文件没有播放。.wav 文件播放正常。

任何想法 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T14:42:13.113

JMF 是一个糟糕的选择。该项目很久以前就被放弃了。我在这里回答了一个类似的问题：

[Java - 尝试使用 mp3plugin 播放 mp3 文件时出错](https://stackoverflow.com/questions/14959566/java-error-when-trying-to-use-mp3plugin-for-playing-an-mp3-file/14959818#14959818)

它可能对你有用 - 我正在使用 Java Sound

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-31T18:15:06.753

以下是我播放音乐所需的全部内容。

```
public static void main(String args[]) throws NoPlayerException, CannotRealizeException, IOException {
    MediaLocator ml = new MediaLocator((new File("roar_of_future.mp3").toURL()));
    Player player = Manager.createRealizedPlayer(ml);
    player.start();
} 
```

所以请确保[mp3plugin.jar](https://www.oracle.com/technetwork/java/javase/download-137625.html)在类路径中，并且您的 javasdk 是 Java 8（32 位）或 7（32 位），因为 JMF 不适用于 Java 9 及更高版本。

# html - Outlook 2013 在每个嵌套表的右侧创建黑色边框线

> ID：14939712
> 
> 赞同：0
> 
> 时间：2013-02-18T15:28:26.833
> 
> 标签：html, html-table, border, html-email, outlook-2013

请帮助，当我试图制作一封响应式电子邮件时，我无所适从，从两列到一列，一切都很完美，直到我到达 Outlook2013，它在每个表的右侧添加了一条黑线即彼此相邻对齐。我尝试使用 border-collapse:collapse 功能重置它，但它没有任何效果。我基本上有两个表格在表格单元中左对齐。

```
 <tr>
        <td align="left" style="border-collapse:collapse"><table width="300" border="0" style="border-collapse:collapse" cellspacing="0" cellpadding="0" class="contenttable" align="left">
          <tr>
            <td align="left" class="headercell" height="399" width="300" style="line-height:399px"><p style="mso-table-lspace:0;mso-table-rspace:0;"><img src="image" style="display:block; width:100% height:auto" alt="" border="0px" height="399" width="300" /></p></td>
        </table> <table width="300" border="0" cellspacing="0" cellpadding="0" class="contenttable" style=" border-collapse:collapse" align="left">
          <tr>
            <td align="left" class="headercell"><p style="mso-table-lspace:0;mso-table-rspace:0;"><img src="image" style="display:block; width:100% height:auto" alt="" /></p></td>
        </table></td>
      </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T23:59:10.433

是的。那是 Outlook 显示它在浮动表格之间保留的 1px 间隙/边框。你无法摆脱它。有点。不过你可以重新着色。

对于您需要添加的小 1px 间隙/线条：

```
border: 1px solid #COLOR; 
```

对于每个浮动表格，请务必调整表格的宽度以避免“浮动下降”。其中#COLOR 是表格的背景颜色。

如果您遇到 BIG gaps 的问题，则需要将其放在样式标签中：

```
table {mso-table-lspace:0pt;mso-table-rspace:0pt; border-collapse:collapse;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-10T02:38:59.167

通常我发现神秘边框的颜色与元素`background-color`上的颜色相同。`body`例如，如果您有一个带有白色内容区域的绿色背景，则线条将是白底绿。

要在这种情况下修复它，您可以将`body`背景设置为白色，这样就可以修复它。差距仍然存在，但你看不到它们。然后，您将改为将绿色背景颜色应用于容器表。

# markup - 纺织编号的标题

> ID：14939713
> 
> 赞同：6
> 
> 时间：2013-02-18T15:28:29.300
> 
> 标签：markup, textile

像[这个类似的问题](https://stackoverflow.com/questions/2362197/restructuredtext-numbered-headers)，但是对于纺织品，是否可以指示纺织品，标题应该编号？

所以

```
h1\. first section
h1\. second section
h2\. subsection 
```

将呈现为：

# 1.第一节

# 2\. 第二节

## 2.1。小节

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-20T15:00:42.827

最简单的方法是使用 <ol><li> 标签，见下文。请注意，在示例中看不到的标题标签 .h1{space} 后面有一个空格。

```
<ol> 

.h1 
<li>first section

.h1 
<li>second section

<ol>

h2\. 
<li>subsection 
```

# apache - 阻止网络蜘蛛

> ID：14939715
> 
> 赞同：1
> 
> 时间：2013-02-18T15:28:32.977
> 
> 标签：apache, web-crawler

我想阻止所有网络蜘蛛清理我的网站。

有办法吗？

我只发现了 2008 年的一些 Apache 规则（比如这个） [http://perishablepress.com/ultimate-htaccess-blacklist/](http://perishablepress.com/ultimate-htaccess-blacklist/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:35:14.517

不幸的是，没有办法阻止所有脚本访问您的站点：如果人类可以，没有什么能阻止任何人编写行为与人类相似的蜘蛛，因此可以查看每个页面。您可以查找一些技术来阻止某些机器人访问您的网站（您可以使用大多数搜索引擎来做到这一点），但如果它保持足够长的时间并获得一些访问，它很可能最终会出现在某个数据库中。

看看[这里](http://www.robotstxt.org/)。

# symfony - 创建一个实现 ContainerAwareInterface 的 Base-Controller 类

> ID：14939720
> 
> 赞同：3
> 
> 时间：2013-02-18T15:28:46.287
> 
> 标签：symfony, dependency-injection

我遵循了 Fabien Potiencier 的教程，关于[如何在 Symfony 组件之上创建自己的框架](http://fabien.potencier.org/article/62/create-your-own-framework-on-top-of-the-symfony2-components-part-12)。现在我需要一个方法。而且我想将依赖容器注入到我的所有控制器中，而不是将每个控制器都定义为服务。

在原始 Symfony2 框架中，所有控制器都扩展了`Controller`位于以下位置的类`Symfony\Bundle\FrameworkBundle\Controller\Controller.php`：

```
namespace Symfony\Bundle\FrameworkBundle\Controller;

class Controller extends ContainerAware
{
   // ...
} 
```

该类`Controller`扩展了`ControllerAware`该类，因此您可以在控制器中执行以下操作：

```
use Symfony\Bundle\FrameworkBundle\Controller\Controller;

class MyController extends Controller
{
   public function someAction()
   {
      $this->container->get('dependencie_xyz);
   }
} 
```

所以我的问题是：**我怎样才能在我的框架中完成同样的事情？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:53:58.747

我花了一段时间，但我终于弄清楚了 Symfony2 框架是如何做到的。在 SymfonyFrameworkBundle 中有一个自定义的 ControllerResolver，它在解析的控制器上调用 setContainer 方法。控制器必须是 ContainerAwareInterface 的一个实例。

简化版：

```
class ContainerAwareControllerResolver extends ControllerResolver
{
    private $container;

    public __construct(ContainerInterface $container)
    {
        $this->container = $container;
            parent::__construct();
    }

    public function getController(Request $request)
    {
        $controller = parent::getController($request);
        if($controller instanceof ContainerAware ){
            $controller->setContainer($this->container);
        }
    }
} 
```

来源：

[https://github.com/symfony/symfony/blob/master/src/Symfony/Bundle/FrameworkBundle/Controller/ControllerResolver.php](https://github.com/symfony/symfony/blob/master/src/Symfony/Bundle/FrameworkBundle/Controller/ControllerResolver.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T12:10:47.030

太简单了。下一个代码将为您提供帮助

```
namespace Symfony\Bundle\FrameworkBundle\Controller;

use Symfony\Component\DependencyInjection\ContainerInterface as Container;
use Symfony\Component\DependencyInjection\ContainerAware as ContainerAware;

class TestService extends ContainerAware
{
   public function __construct(Container $container) {
      // in your example from official doc 'dependencie_xyz' is a name of service
      $this->setContainer($container); // call parent setContainer() method, for identifying container variable, from now you can access to ServiceContainer using $this->container variable
      $test_param = $this->container->getParameter('test_param'); // get test_param from config.yml
   }

} 
```

在 service.yml

像这样写东西

```
services:
    test_service:
        class: Symfony\Bundle\FrameworkBundle\TestService
        arguments: ['@service_container'] 
```

并将服务容器作为参数发布

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-18T07:57:29.360

如果您没有在控制器上实现任何接口，您可以添加这种方式，它会起作用。这是对 c4pone 实现的一个小修改。

```
/**
* Description of ContainerAwareControllerResolver
*
* @author sbc
*/
use Psr\Log\LoggerInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;
use Symfony\Component\HttpKernel\Controller\ControllerResolver;

class ContainerAwareControllerResolver extends ControllerResolver {

private $container;

public function __construct(LoggerInterface $logger = null, ContainerInterface $container = null) {

    parent::__construct($logger);

    $this->container = $container;
}

protected function instantiateController($class) {

    $new_class = new $class();

    $new_class->setContainer($this->container);

    return $new_class;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-18T19:15:16.733

> Controller 类扩展了 ControllerAware 类，因此您可以在 Controller 中执行以下操作：

好吧，这不是真的。如果我们看一下[class](http://api.symfony.com/2.2/Symfony/Component/DependencyInjection/ContainerAware.html)[的签名`ContainerAware`](http://api.symfony.com/2.2/Symfony/Component/DependencyInjection/ContainerAware.html)，我们会看到它添加了一个`setContainer`方法，因此我们可以设置容器。Symfony2 创造了`Controller::get`一种让生活更轻松的方法。

我们可以[在源代码](https://github.com/symfony/symfony/blob/master/src/Symfony/Bundle/FrameworkBundle/Controller/Controller.php#L243-253)中看到他们是如何做到的：

```
/**
 * Gets a service by id.
 *
 * @param string $id The service id
 *
 * @return object The service
 */
public function get($id)
{
    return $this->container->get($id);
} 
```

您可以将它放在您自己的`Controller`类中，并让您的所有控制器扩展该控制器类。

# ms-access - 语句结束错误

> ID：14939722
> 
> 赞同：1
> 
> 时间：2013-02-18T15:28:50.500
> 
> 标签：ms-access, vba, ms-access-2010

我正在尝试组装一个带有多个换行符的插入语句。插入包括数字和文本数据。我不断收到错误消息，我找不到语法错误的地方。谁能看到我的错误？

```
CurrentDb.Execute "INSERT INTO tblCustParts (CustPartNum,CustomerID,Alloy,Temper,Finish,FormType,Gauge,GaugeAimPlus,GaugeAimMinus," & _
        "GaugeGuarPlus,GaugeGuarMinus,Width,WidthAimPlus,WidthAimMinus,WidthGuarPlus,WidthGuarMinus,Length,LengthAimPlus,LengthAimMinus," & _
        "LengthGuarPlus,LengthGuarMinus,Diameter,DiameterAimPlus,DiameterAimMinus,DiameterGuarPlus,DiameterGuarMinus,CircleShear,IDMin," & _
        "ODMin,ODMax,LabelAs,ProduceAs,ShopPaperNotes,EyeOrientation,CoreType,PackingNotes,AQ,PaperInterleave,HeatTreatedSkids,HasRecipeFlag," & _
        "QRRExists,TensionLevel,MSKCoreSpec,ChemCertsReq,PhysCertsReq,PhysAndChemCertsReq,AAStandard,ASTM_B209_10)" & _
        "VALUES('" & Part & "', " & Me.Customer & ", '" & Alloy & "', '" & Temper & "', '" & Finish & "', '" & FormType & "', " & Me.Gauge & ", "" & _
        " & Me.Gauge & ", " & Me.GaugeAimPlus & ", " & Me.GaugeAimMinus & ", " & Me.GaugeGuarPlus & ", " & Me.GaugeGuarMinus & ", "" & _
        " & Me.WidthEntry & ", " & Me.WidthAimPlus & ", " & Me.WidthAimMinus & ", " & Me.WidthGuarPlus & ", " & Me.WidthGuarMinus & ", "" & _
        " & Me.LengthEntry & ", " & Me.LengthAimPlus & ", " & Me.LengthAimMinus & ", " & Me.LengthGuarPlus & ", " & Me.LengthGuarMinus & ", "" & _
        " & Me.Diameter & ", " & Me.DiameterAimPlus & ", " & Me.DiameterAimMinus & ", " & Me.DiameterGuarPlus & ", "" & _
        " & Me.DiameterGuarMinus & ", " & Me.CS & ", " & Me.IDMin & ", " & Me.ODMin & ", " & Me.ODMax & ", '" & Me.LabelAs & "', '"" & _
        " & Me.ProduceAs & "', '" & Me.ShopPaperNotes & "', '" & Me.EyeOrientation & "', '" & Me.CoreType & "', '" & Me.PackingNotes & "', "" & _
        " & Me.AQ & ", " & Me.PaperInterleave & ", " & Me.HeatTreatedSkids & ", " & Me.HasRecipeFlag & ", " & Me.QRRExists & ", "" & _
        " & Me.TensionLevel & ", " & Me.MSKCoreSpec & ", " & Me.ChemCertsReq & ", " & Me.PhysCertsReq & ", " & Me.PhysAndChemCertsReq & ", "" & _
        " & Me.AAStandard & ", " & Me.ASTM_B209_10 & ")" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:36:27.083

我不确定额外的引号和 & 符号是做什么用的，但它们导致了问题。它们出现在每条价值线的开始和结束处。最好把你的字符串放在一个单独的变量中，然后执行，这样更容易发现问题。您可能还想考虑参数，在这种情况下它们会让您的生活更轻松。

```
ssql = "INSERT INTO tblCustParts (CustPartNum,CustomerID,Alloy,Temper,Finish,FormType,Gauge,GaugeAimPlus,GaugeAimMinus," & _
        "GaugeGuarPlus,GaugeGuarMinus,Width,WidthAimPlus,WidthAimMinus,WidthGuarPlus,WidthGuarMinus,Length,LengthAimPlus,LengthAimMinus," & _
        "LengthGuarPlus,LengthGuarMinus,Diameter,DiameterAimPlus,DiameterAimMinus,DiameterGuarPlus,DiameterGuarMinus,CircleShear,IDMin," & _
        "ODMin,ODMax,LabelAs,ProduceAs,ShopPaperNotes,EyeOrientation,CoreType,PackingNotes,AQ,PaperInterleave,HeatTreatedSkids,HasRecipeFlag," & _
        "QRRExists,TensionLevel,MSKCoreSpec,ChemCertsReq,PhysCertsReq,PhysAndChemCertsReq,AAStandard,ASTM_B209_10)" & _
        "VALUES('" & Part & "', " & Me.Customer & ", '" & Alloy & "', '" & Temper & "', '" & Finish & "', '" & FormType & "', " & Me.Gauge & ", " & _
        Me.Gauge & ", " & Me.GaugeAimPlus & ", " & Me.GaugeAimMinus & ", " & Me.GaugeGuarPlus & ", " & Me.GaugeGuarMinus & ", " & _
        Me.WidthEntry & ", " & Me.WidthAimPlus & ", " & Me.WidthAimMinus & ", " & Me.WidthGuarPlus & ", " & Me.WidthGuarMinus & ", " & _
        Me.LengthEntry & ", " & Me.LengthAimPlus & ", " & Me.LengthAimMinus & ", " & Me.LengthGuarPlus & ", " & Me.LengthGuarMinus & ", " & _
        Me.Diameter & ", " & Me.DiameterAimPlus & ", " & Me.DiameterAimMinus & ", " & Me.DiameterGuarPlus & ", " & _
        Me.DiameterGuarMinus & ", " & Me.CS & ", " & Me.IDMin & ", " & Me.ODMin & ", " & Me.ODMax & ", '" & Me.LabelAs & "', '" & _
        Me.ProduceAs & "', '" & Me.ShopPaperNotes & "', '" & Me.EyeOrientation & "', '" & Me.CoreType & "', '" & Me.PackingNotes & "', " & _
        Me.AQ & ", " & Me.PaperInterleave & ", " & Me.HeatTreatedSkids & ", " & Me.HasRecipeFlag & ", " & Me.QRRExists & ", " & _
        Me.TensionLevel & ", " & Me.MSKCoreSpec & ", " & Me.ChemCertsReq & ", " & Me.PhysCertsReq & ", " & Me.PhysAndChemCertsReq & ", " & _
        Me.AAStandard & ", " & Me.ASTM_B209_10 & ")"

Dim db As database
Set db = CurrentDB
db.Execute ssql dbFailOnError 
```

最后插入的记录 ID

```
Set rs = db.OpenRecordset("select @@identity as id")
LastID = rs("id") 
```

参数示例：

```
ssql = "INSERT INTO Table1 (Atext,Anumber) Values (@AText,@Anumber)"
Dim qdf As QueryDef
Set qdf = CurrentDb.CreateQueryDef("", ssql)
qdf.Parameters("@atext") = "abc"
qdf.Parameters("@Anumber") = 1
qdf.Execute dbFailOnError 
```

最后插入的记录 ID

```
qdf.SQL = "select @@identity as id"
Set rs = qdf.OpenRecordset
LastID = rs("id") 
```

# macos - 如何在终端（或applescript）中打开和关闭远程登录

> ID：14939723
> 
> 赞同：3
> 
> 时间：2013-02-18T15:28:51.907
> 
> 标签：macos, terminal, applescript

我需要通过终端或applescript打开和关闭远程登录。我需要它与 os x leopard 兼容。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T16:26:35.907

我还没有完全检查，但我认为这些可以追溯到 v10.4。要打开远程登录 (ssh)：

```
sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist 
```

要关闭它：

```
sudo launchctl unload -w /System/Library/LaunchDaemons/ssh.plist 
```

请注意，这些不会调整服务访问控制列表，即允许哪些帐户通过 ssh 进入。这是由名为“com.apple.access_ssh”（长名称：“远程登录 ACL”）的隐藏系统组的成员资格控制的。

# javascript - 了解 Chrome 性能计数器

> ID：14939724
> 
> 赞同：1
> 
> 时间：2013-02-18T15:28:53.047
> 
> 标签：javascript, performance, google-chrome

所以，嗯，我正在阅读[**这篇**](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)关于 js 性能之类的文章，我想我会在我的网站上试用时间线分析器。而且我看到了一些相当惊人的结果，内存中有超过 7k DOM 节点和 1k 事件侦听器，而页面在执行时只有约 300 个 DOM 元素`$('*').length`，那么其他 7k 元素在哪里？那么事件监听器呢？我`.empty`在这样做之前放置新 HTML 的容器，所以我不确定这是从哪里来的。

![在此处输入图像描述](../Images/9e4393f3261fb168ec2eb1686d0f40f0.png) [放大](https://i.stack.imgur.com/LAbwW.png)

我的网站是一场迫在眉睫的灾难吗？这是正常行为吗？

我应该提到时间线描述了几个视图呈现后的页面，并且该站点是带有 ajax 调用的单个页面。视图基本上清除了一个容器并将它们的 html 放在那里，它来自用 mustache 编译的模板函数。

PD：如果有人关心，[这就是网站](http://www.ponyfoo.com)

# powershell - 在 powershell 脚本终止时运行代码以关闭文件？

> ID：14939727
> 
> 赞同：4
> 
> 时间：2013-02-18T15:29:01.877
> 
> 标签：powershell, terminate

我有一个脚本正在咀嚼很多对象，有时我想在运行中间杀死它，因为我看到有东西往南走。不幸的是，我正在使用 System.IO.StreamWriter 写入日志文件，每当我发送 Ctrl-C 时，我的日志文件都会卡在打开状态。

有什么方法可以定义某种处理程序或退出函数，让我可以优雅地关闭我打开的文件句柄和连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:37:05.187

可以尝试使用 Try/Catch/Finally，将 close() 命令放在 finally 块中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T17:01:26.770

使用 PowerShell 2.0 及更高版本，您可以定义[`Trap`](http://technet.microsoft.com/en-us/library/hh847742.aspx)在发生终止错误时触发的。您可以定义多个陷阱来捕获不同的异常。这可能会产生比`try/catch`到处乱扔的代码更干净的代码，或者将整个脚本包装在一个大的`try/catch`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:39:58.673

要终止脚本，请使用`exit`。如果抛出异常，请使用`try/catch/finally`中的 close() 命令`finally`。如果它只是一个 if 测试，请尝试以下操作：

```
function Close-Script {
    #If stream1 is created
    if($stream1) { 
        $stream1.Close()
    }

    #Terminate script
    exit
}

$stream1 = New-Object System.IO.StreamWriter filename.txt

If(a test that detects your error) {
    Close-Script
} 
```

如果 streamwriter 的数量不时变化，您可以将它们收集到一个数组并关闭它们。前任：

```
function Close-Script {
    #Close streams
    $writers | % { $_.Close() }

    #Terminate script
    exit
}

$writers = @()
$stream1 = New-Object System.IO.StreamWriter filename.txt
$writers += $stream1
$stream2 = New-Object System.IO.StreamWriter filename2.txt
$writers += $stream2

If(a test that detects your error) {
    Close-Script
} 
```

# javascript - 使用 documentFragment 会导致回流/重绘吗？

> ID：14939728
> 
> 赞同：0
> 
> 时间：2013-02-18T15:29:05.163
> 
> 标签：javascript, html, css

只是出于兴趣，有人知道这个问题的答案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:36:09.180

documentFragments 的全部意图是*不*引起任何重新绘制/流动。通过使用 documentFragment 来反映您的更改，然后将其附加到 DOM，您可以节省大量重新流/绘制的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:32:02.387

来自 MozDev ( [https://developer.mozilla.org/en-US/docs/DOM/document.createDocumentFragment](https://developer.mozilla.org/en-US/docs/DOM/document.createDocumentFragment) )

> 由于文档片段在内存中而不是主 DOM 树的一部分，因此将子片段附加到它不会导致页面重排（计算元素的位置和几何形状）。因此，使用文档片段通常会带来更好的性能。

# c# - 获取SQL关键字（保留词）是否是一种程序化方式

> ID：14939731
> 
> 赞同：7
> 
> 时间：2013-02-18T15:29:14.080
> 
> 标签：c#, sql, sql-server-2008, keyword, reserved-words

我需要验证以编程方式创建的 SQL 列的**名称...**

应该有2个验证规则：

1.  **名称**不应是 C#关键字
2.  **名称**不应是 SQL 关键字( *SQL Server 2008 R2)*

* * *

**第一条规则的解决方案很好：**

CSharpCodeProvider类具有**IsValidIdentifier**方法，这使得验证的实现变得容易**。**

（前任：

```
string myColumnName = "blabla";
var isValid = _cSharpCodeProvider.IsValidIdentifier(myColumnName); 
```

)

* * *

**第二条规则的解决方案有点冗长：**

我发现进行谷歌搜索的唯一方法是从[MSDN 中获取关键字 - 保留关键字 (Transact-SQL) SQL Server 2008 R2](http://msdn.microsoft.com/en-us/library/ms189822%28v=sql.105%29.aspx)

构建一个将返回所有这些关键字的字符串 [] 属性...

（前任：

```
public static class SqlReservedKeywords {

     public static string[] SqlServerReservedKeywords {
        get { return SqlServerKeywords; }
     }

     private static readonly string[] SqlServerKeywords = new[] { 
        "ADD","EXISTS","PRECISION",   

    //. . .

        "EXEC","PIVOT","WITH",
        "EXECUTE","PLAN","WRITETEXT"
     };
} 
```

//外部代码

```
var isValid = SqlReservedKeywords.SqlServerReservedKeywords.Contains(myColumnName); 
```

)

* * *

你能告诉我关于第二个验证规则的实施吗？这是一个好习惯吗？也许它存在另一种实现方式，我没有通过谷歌搜索找到......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:44:31.543

保留字是一个移动的目标。如果 dbms 不通过公共接口公开它们，那么通常没有一种好的编程方式来获取它们。

如果您不想用括号保护它们，则可能会合并在当前使用的 SQL Server 版本中未保留但在将来的某个版本*中保留的符号。*

我认为您最好的选择是使用您的 dbms 提供的引用机制，因为它旨在处理这个问题。对于 SQL Server，这意味着方括号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T16:00:59.100

由于有一个函数可以调用 C#，真正的问题是如何查找 SQL 保留字。您在此处实现查找的方式不是最有效的 C#。您应该使用 HashSet -- 未经测试的快速代码示例如下：

```
public static class SqlReservedKeywords {

   public bool isReserved(string in)
   {
      return SqlServerKeywords.Contains(in.ToUpper());
   }

   private static HashSet<string> SqlServerKeywords = new HashSet<string>();

   static SqlReservedKeywords() 
   {
      SqlServerKeywords.Add("ADD");
      SqlServerKeywords.Add("EXISTS");
      SqlServerKeywords.Add("PRECISION");

   //. . .

      SqlServerKeywords.Add("EXEC");
      SqlServerKeywords.Add("PIVOT");
      SqlServerKeywords.Add("WITH");
      SqlServerKeywords.Add("EXECUTE");
      SqlServerKeywords.Add("PLAN");
      SqlServerKeywords.Add("WRITETEXT");
   }   
} 
```

这是一篇不错的文章（@theburningmonk），展示了使用 Contains 时 HashSet 的速度

（不想点击的，HashSet为零）

[http://theburningmonk.com/2011/03/hashset-vs-list-vs-dictionary/](http://theburningmonk.com/2011/03/hashset-vs-list-vs-dictionary/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:37:46.323

通常，该方法看起来是正确的。由于任何未记录的内容，获取任何给定语言的关键字都涉及（希望很小）一些试验和错误，但主要来源始终是语言规范本身。我不知道任何语言都有自己的验证器，但这并不是说它们不存在。

Visual Studio 本身有一组 xml 文件，可帮助它对任何给定语言进行验证。如果你正在开发一个 IDE，你可能有一个看起来像这样的表；

```
Keyword     | MatchWithRegEx | Color
------------+----------------+---------
for         | \wfor          | #FF0000 
```

...你明白了。在您的情况下，您只想过滤掉可能的问题关键字，以便它们不会引发异常。允许抛出异常并专门捕获和处理它*是*一种有效的方法，尽管不是一种非常干净的方法。

至于您的情况，我要做的唯一真正的调整是不在编译时将关键字列表埋入程序中，而是将列表存储在一个外部文件中，该文件在您的应用程序的起点加载。如果您忘记任何事情或需要支持更高版本的语言而不需要重新构建应用程序，这将提供一定的灵活性。

# c# - 在后台线程中产生返回 IEnumerable

> ID：14939734
> 
> 赞同：2
> 
> 时间：2013-02-18T15:29:34.340
> 
> 标签：c#, backgroundworker, yield

我有以下方法可以返回目录中的文件列表：

```
 public IEnumerable<FileInfo> GetFilesRecursiveEnumerable(DirectoryInfo dir)
    {
        if (dir == null) throw new ArgumentNullException();
        IList<FileSystemInfo> files = new List<FileSystemInfo>();
        try
        {
            files = dir.GetFileSystemInfos();
        }
        catch (UnauthorizedAccessException) { } //ignore
        catch (PathTooLongException)
        {
            MessageBox.Show("Path too long in directory: " + dir.FullName);
        }

        foreach (FileSystemInfo x in files)
        {
            DirectoryInfo dirInfo = x as DirectoryInfo;
            if (dirInfo != null)
            {
                foreach (FileInfo f in GetFilesRecursiveEnumerable(dirInfo))
                {
                    yield return f;
                }
            }
            else
            {
                FileInfo fInfo = x as FileInfo;
                if (fInfo != null) yield return fInfo;
            }
        }
    } 
```

此方法会阻止 GUI。我想在后台线程中运行它（仅限单个），以便在`FileSystemInfo`对象可用时将其提供给调用者。

我已经能够让这个方法在后台工作人员中运行并返回一个`ICollection`of `FileSystemInfo`s - 但这会返回整个列表，而我想在找到项目时产生它们。

编辑

似乎我可能需要重新评估我想要实现的目标（也许这需要回调而不是 IEnumerable）

本质上，我希望索引一个驱动器价值的文件，但我想在后台线程中运行它。这样，我可以逐个文件处理（可能是 Dir by Dir），如果需要，我可以在稍后阶段恢复该过程。如此有效，我希望调用者（GUI 线程）运行此方法，但在目录扫描期间收到通知，而不是在其完全完成时收到通知。例如，

```
//My original thoughts, but maybe need to tackle this a different way
public void ScanDrive()
{
  foreach(FileInfo f in GetFilesRecursiveEnumerable())
  {
     //index file
     //record the directory I am up to so I can resume later
     /Keeping my application responsive to perform other tasks
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:37:33.580

`yield`将控制权返回给*调用者*，直到*调用者*再次调用枚举器，因此链中的下一个值（如果有）再次`yielded`返回给*调用者*。

所以我想说，这`yield`本身不符合您的要求。为了实现您的想法，您可以使用简单的线程同步，其中*调用者*（主线程）在另一个线程上调用返回*下一个文件信息*的方法。

或者干脆使用一些“回调机制”：

简单的例子：

```
void Main() {

   //start thread
    Thread t = new Thread(GetFilesRecursiveEnumerable)
    t.Start(..);
}

//called by thread as soon as FileInfo is ready
void FileReady(FileInfo fi) {
   ...
}
... 
```

并在方法内部：

```
public IEnumerable<FileInfo> GetFilesRecursiveEnumerable(DirectoryInfo dir)
{
    ...
    foreach (FileSystemInfo x in files)
    {
        DirectoryInfo dirInfo = x as DirectoryInfo;
        if (dirInfo != null)
        {
            foreach (FileInfo f in GetFilesRecursiveEnumerable(dirInfo))
            {
                FileReady(f);
            }
        }
        ...
    }
} 
```

代码自然不是生产就绪的，提供它只是为了让您对主题有所了解。

# python - 正则表达式 python Fasta

> ID：14939736
> 
> 赞同：0
> 
> 时间：2013-02-18T15:29:39.190
> 
> 标签：python, regex, dna-sequence

感谢您之前的建议，

我有另一个正则表达式问题：

现在我有一个带有这种模式的列表：

```
*7  3   279 0
*33 2   254 0.0233918128654971
*39 2   276 0.027431421446384 
```

以及 Fasta 格式的 DNA 测序文件：

*编辑*重新格式化的行

```
>OCTU1
GCTTGTCTCAAAGATTAAGCCATGCATGTATAAGCACAAGCCTAAAATGGTGAAGCCGCGAATAGCTCATTACAACAGTCGTAGTTTATTGGAAAGTTCACTATGGATAACTGTGGTAATTCTAGAGCTAATACATGTTCCAATCCTCGACTCACGGAGAGGTGCATTTATTAGAACAAAGCTGATCAGACTATGTCTGTCTCAGGTTGACTCTGAATAACTTTGCTAATCGCACAGTCTTTGTACTGGCGATGTATCTTTCATGCTATGTA
>OCTU2
GCTGCTTCCTTGGATGTGGTAGCCGTTTCTCAGGCTCCCTCTCCGGAATCGAACCCTATTCCCCGTTACCCGTTCAACCATGGTAGGCCCTACTACCATCAAAGTTGATAGGGCAGATATTTGAAAGACATCGCCGCACAAAGGCTATGCGATTAGCAAAGTTATTAGATCAACGACGCAGCGATCGGCTTTGACTAATAAATCACCCCTCCAGTTGGGGACTTTTACATGTATTAGCTCTAGAATTACCACAGTTATCCATTAGTGAAGTACCTTCCAATAAACTATACTGTTTAATGAGCCATTCGCGGTTTCACCGTAAAATTAGGTTGTCTTAGACATGCATGGCTTAATCTTTGTAGACAAGC 
```

我需要在 Fasta 文件（例如，>OCTU7 和 >OCTU33）中找到带有*（例如，7 或 33）的列表中的数字，并仅将列表中存在的 Fasta 序列复制到另一个文件中，这个是我的脚本：

```
regex=re.compile(r'.+\d+\s+')
OCTU=b.readlines()
while OCTU:
    for line in a:
        if regex.match(OCTU)==line:
              c.write(OCTU) 
```

脚本似乎可以工作，但我认为模式不正确，因为创建的文件是空的。

提前感谢您的宝贵建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T13:24:58.120

您可以先将文件中的 id 号收集`a`到一组以便稍后快速查找：

```
seta = set()
regexa = re.compile(r'\*(\d+)') #matches asterisk followed by digits, captures digits
for line in a:
    m = regexa.match(line)      #looks for match at start of line
    if m:
        seta.add(m.group(1)) 
```

然后循环b。在循环内使用`b.next()`以获取序列所在的第二行。

```
regexb = re.compile(r'>OCTU(\d+)')  #matches ">OCTU" followed by digits, captures digits
for line in b:
    m = regexb.match(line)
    if m:
        sequence = b.next() 
        if m.group(1) in seta:
            c.write(line)
            c.write(sequence) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-18T09:39:12.163

您可能想使用 Biopython 来解析 fasta 文件。

然后你可以切出数字并在你的列表中查找它并更可靠地访问序列和序列名称......如果fasta文件有换行上述方法可能会遇到问题......

```
import collections
from Bio import SeqIO

infile = "yourfastafile.fasta"
outfile = "desired_outfilename.fasta"

dct = collections.OrderedDict()
for record in SeqIO.parse(open(infile), "fasta"):
    dct[record.description()] = str(record.seq).upper()

for k,v in dct.items():
    if int(k[4:]) in seta: #from answer above
        with open(outfile, "a") as handle:
            handle.write(">" + k + "\n" + str(v) + "\n") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-28T11:48:46.207

# 编码=utf8

# 上面的标签定义了这个文档的编码并且是为了兼容 Python 2.x

```
import re

regex = r">.+\n[acgtnACGTN\n]+"

test_str = (">AB000263 |acc=AB000263|descr=Homo sapiens mRNA for prepro cortistatin like peptide, complete cds.|len=368\n"
    "ACAAGATGCCATTGTCCCCCGGCCTCCTGCTGCTGCTGCTCTCCGGGGCCACGGCCACCGCTGCCCTGCC\n"
    "CCTGGAGGGTGGCCCCACCGGCCGAGACAGCGAGCATATGCAGGAAGCGGCAGGAATAAGGAAAAGCAGC\n"
    "CTCCTGACTTTCCTCGCTTGGTGGTTTGAGTGGACCTCCCAGGCCAGTGCCGGGCCCCTCATAGGAGAGG\n"
    "AAGCTCGGGAGGTGGCCAGGCGGCAGGAAGGCGCACCCCCCCAGCAATCCGCGCGCCGGGACAGAATGCC\n"
    "CTGCAGGAACTTCTTCTGGAAGACCTTCTCCTCCTGCAAATAAAACCTCACCCATGAATGCTCACGCAAG\n"
    "TTTAATTACAGACCTGAA")

matches = re.finditer(regex, test_str)

for matchNum, match in enumerate(matches):
    matchNum = matchNum + 1

    print ("Match {matchNum} was found at {start}-{end}: {match}".format(matchNum = matchNum, start = match.start(), end = match.end(), match = match.group()))

    for groupNum in range(0, len(match.groups())):
        groupNum = groupNum + 1

        print ("Group {groupNum} found at {start}-{end}: {group}".format(groupNum = groupNum, start = match.start(groupNum), end = match.end(groupNum), group = match.group(groupNum))) 
```

# 注意：为了兼容 Python 2.7，请使用 ur"" 作为正则表达式的前缀，使用 u"" 作为测试字符串和替换的前缀。

# javascript - 为什么这个脚本只给出一半的输出？

> ID：14939740
> 
> 赞同：0
> 
> 时间：2013-02-18T15:29:46.593
> 
> 标签：javascript

这是功能：

```
function funct1()
{
    document.getElementById("demo").innerHTML="Something";
    document.write("Mexico!");
} 
```

输出只有：

```
Mexico 
```

当我单击页面上的按钮时，我希望输出为：

```
Something
Mexico 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:33:02.487

在这种情况下`document.write()`，不会按照您的想法行事。它清除文档的内容，并写入`Mexico!`（有关原因的更详细解释，请参阅 Quentin 的回答）。如果删除此行，您可以看到您的第一条语句已正确执行。

如果要更新第一段并添加另一个，则应使用以下代码：

```
function funct1()
{
    document.getElementById("demo").innerHTML = "Something";  

    // Create a new <p> element, set its HTML and then append it:
    var newP = document.createElement('p');
    newP.innerHTML = 'Mexico!';
    document.body.appendChild(newP);
} 
```

你可以在这里看到一个工作的[**jsFiddle**](http://jsfiddle.net/VQVDA/1/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:33:11.800

设置好`innerHTML`demo后，调用`document.write`. 由于此时文档处于关闭状态，这会进行隐式调用，`document.open`从而*擦除整个现有文档*（包括您刚刚分配的内容`innerHTML`）。*然后*你写*墨西哥！*到新文档。

切勿`document.write`在 DOM 准备好后调用（并避免在其他任何时间这样做）。请改用 DOM 操作。

# kendo-ui - 隐藏 Kendo UI 网格工具栏

> ID：14939743
> 
> 赞同：0
> 
> 时间：2013-02-18T15:30:04.263
> 
> 标签：kendo-ui, kendo-grid

如何隐藏 KendoUI 网格的工具栏（寻呼机）？

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T16:03:11.687

```
$("#grid").kendoGrid({
     dataBound: function() {
    $("#grid .k-grid-pager").css('display','none');
     }
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T17:29:42.540

如果要显示`pageSize`记录数但没有分页，则只需`pageSize`在 dataSource 中定义，但`pageable`在网格定义中为 false：

```
$("#grid").kendoGrid({
    ...
    pageable: false
}); 
```

# php - php写入XML文件（到JW播放器）

> ID：14939748
> 
> 赞同：1
> 
> 时间：2013-02-18T15:30:11.993
> 
> 标签：php, xml, xml-parsing, jwplayer

我使用 JW 播放器加载 XML 播放列表。当我手动编写 XML 文件时它工作正常，但当我使用 php 解析时就不行了......

我希望它看起来像这样：

```
<rss version="2.0" xmlns:media="http://search.yahoo.com/mrss/" xmlns:jwplayer="http://developer.longtailvideo.com/trac/"> 
<channel>
  <item>
    <title>Albert</title>
    <media:content url="../movies/hi.mp4" />
    <description></description>
    <jwplayer:duration>10</jwplayer:duration>
  </item>
</channel>
</rss> 
```

第一个问题是`<rss version="2.0" ...` 它强制标题为：`<?xml version="1.0"?>`

第二个问题是`<media:content url="" ...` 我如何用 php 打印出来？

第三个问题是如何添加end rss`</rss>`

我的代码是：

```
<?php 
  $channel = array(); 
  $channel [] = array( 
  'title' => 'Albert', 
  'content' => 'filmer/c1.jpg', 
  'duration' => "10" 
  ); 
  $channel [] = array( 
  'title' => 'Claud', 
  'content' => 'filmer/c2.jpg', 
  'duration' => "10" 
  ); 

  $doc = new DOMDocument();
  $doc->formatOutput = true; 

  $r = $doc->createElement( "channel" ); 
  $doc->appendChild( $r ); 

  foreach( $channel as $item ) 
  { 
  $b = $doc->createElement( "item" ); 

  $title = $doc->createElement( "title" ); 
  $title->appendChild( 
  $doc->createTextNode( $item['title'] ) 
  ); 
  $b->appendChild( $title ); 

  $content = $doc->createElement( "media:content" ); 
  $content->appendChild( 
  $doc->createTextNode( $item['content'] ) 
  ); 
  $b->appendChild( $content ); 

  $duration = $doc->createElement( "jwplayer:duration" ); 
  $duration->appendChild( 
  $doc->createTextNode( $item['duration'] ) 
  ); 
  $b->appendChild( $duration ); 

  $r->appendChild( $b ); 
  } 

  echo $doc->saveHTML(); 
  $doc->save("write.xml") 
  ?> 
```

有任何想法吗？我是 PHP/XML 的新手，对不起：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T18:19:12.880

此行：`<?xml version="1.0"?>`称为[XML 声明](http://www.w3.org/TR/REC-xml/#sec-prolog-dtd)，它是可选的。因此，只要您使用有效的 XML，无论该行是否存在都不会产生任何影响并造成任何问题。

由于 RSS 是基于 XML 的，因此您不必担心该行是否存在。

我希望这能澄清你问题的这一部分。

由于问答通常最适合每个问题，因此以下是另外两个问题：

*   在 php / [PHP DomDocument 输出](https://stackoverflow.com/q/5706086/367456)[中创建 xml 时删除 xml 版本标记](https://stackoverflow.com/q/5947695/367456)[`<?xml version=“1.0” encoding=“UTF-8”?>`](https://stackoverflow.com/q/5706086/367456)
*   [在 PHP 中使用命名空间 URI 生成 XML](https://stackoverflow.com/q/1306313/367456)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-05T01:16:47.867

有必要在 xml 中的 php 代码之前放置一个标头，以告知 jwplayer 正在加载什么。

```
 header("Content-type: text/xml"); 
```

# google-apps-script - 如何通过 API 从 Google 群组中获取昵称？

> ID：14939750
> 
> 赞同：1
> 
> 时间：2013-02-18T15:30:21.517
> 
> 标签：google-apps-script

如何通过 Google Apps 脚本获取群组的昵称？

这似乎不起作用：

```
 var groups = GroupsManager.getAllGroups();
  for (var i in groups) {
    var group = groups[i];
    var nicknames = NicknameManager.getAllNicknames(group.getName()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:17:00.237

**编辑：** *我意识到我误解了你的问题，我会把它留在那里以防万一有人感兴趣，但它不能回答你关于组本身昵称的真正问题......对不起*

需要的参数`getAllNickNames(String username)`不是组名，而是该组中的用户名。（使用 control+space 来查看自动完成）

试试这段代码来查看用户和他们的昵称（我将执行限制为 10，因为我的域中有很多组，而且花了很长时间 ;-)

```
function myFunction() {
  var groups = GroupsManager.getAllGroups();
  for (var i in groups) {
    if(i>10){break}
    var groupName = groups[i].getName()
    var groupUsers = groups[i].getAllMembers()
    for(var u in groupUsers){
      Logger.log('groupName : '+groupName+' = '+groupUsers[u])
    }
  }
    var nicknames = NicknameManager.getAllNicknames()
    for(n in nicknames){
      Logger.log('user '+nicknames[n].getUsername()+' has nickName = '+nicknames[n].getNickname())
    }
} 
```

# video-streaming - 博世视频流式传输到网页

> ID：14939753
> 
> 赞同：2
> 
> 时间：2013-02-18T15:30:24.167
> 
> 标签：video-streaming, activex, http-live-streaming, live-streaming

我有大约 10 台博世`IP`相机，我正在尝试使用相机的`ActiveX`控件将相机视频流式传输到网页。知道如何使用`ActiveX`控件来实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T09:17:03.403

我在客户端（BOSH 相机集成商）提供的 SDK 的帮助下，通过使用 VB6 创建 ActiveX 控件解决了这个问题

SDK 具有 VB6 实现来流式传输摄像机的实时视频。

我在这里不提供任何 VB6 代码实现，因为我的解决方案特定于我的集成器 SDK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T10:31:04.080

这可能是题外话，但如果有人需要这个，我有一个基于 RCP Plus 3.0 版规范的 C 库[here](https://github.com/hawell/rcpplus)

# jsp - 如何将bean消息分配给jsp参数

> ID：14939756
> 
> 赞同：0
> 
> 时间：2013-02-18T15:30:34.550
> 
> 标签：jsp, message, param, jspinclude

如何分配 bean 消息，例如：`<bean:message key="leftmenu.dailyreport"/>` 给`JSP`参数？我试过了：

```
<jsp:include page="/pages/common/common006-tabmenu.jsp" flush="true">
    <jsp:param name="upperMenu1" value=<bean:message key="leftmenu.dailyreport"/> >
    </jsp:param>        
</jsp:include> 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:45:25.197

您可以像这样使用，在我的情况下，通过使用 bean 消息将显示消息“输入电子邮件”，该消息分配在电子邮件属性中，并且在它旁边，它将从用户那里获取电子邮件的输入值。

```
 <table border="0" cellspacing="1" cellpadding="3" align="center" width="100%">
     <tr>
        <td class="back" width="38%"><bean:message                    key="createUser.email"/></td>
          <td class="tableback" width="62%">
            <html:text property="email" value='<%=email%>'       readonly="true" onkeydown="return false;" onfocus = "return false;" onkeypress="return false;"/>
        </td>
        </tr> 
```

# java - 使用单个 TCP/IP 套接字从多个并发线程发送数据的问题

> ID：14939760
> 
> 赞同：2
> 
> 时间：2013-02-18T15:30:47.327
> 
> 标签：java, multithreading, sockets, tcp

在浏览了有关我的问题的其他一些线程后，我想我已经明白我需要重新设计我的应用程序。但只是为了澄清：我`TCP/IP`在客户端和服务器之间有一个连接。在客户端，有许多线程同时运行。这些线程中的一个或多个随机使用该`TCP/IP`连接与服务器进行通信。我发现，例如，当长时间运行的文件传输处于活动状态时，同时使用与另一个线程的连接可能会导致错误。虽然我在每条消息之前都有一个特定的标题，包括数据长度，但在我看来，`IP`stack 有时会向我的程序传递多条消息的混合，这意味着尽管一条消息尚未完全传递，但另一条消息的一部分将传递给我的 read 方法。这是符合预期`TCP/IP`行为的正确观察吗？提前致谢 - 马里奥

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++++++++++++++++++++++++++

对于任何感兴趣的人：以下是我的测试程序的源代码。您可以使用不同的 BUFFER_SIZE 值和用于轰炸服务器套接字的线程数，并发 TCP/IP 发送使用相同的套接字。我省略了一些错误处理并删除了更复杂的终止，包括关闭套接字。使用大于 64KB 的 BUFFER_SIZE 进行测试总是会导致我的机器出错。

```
import java.io.*;
import java.net.*;
import java.nio.ByteBuffer;

public class TCPTest
{
  private final static String INPUT_FILE   = "c:/temp/tcptest.in";
  private final static int    BUFFER_SIZE  = 64 * 1024 - 8; //65536;
  private final static int    MESSAGE_SIZE = 512 * 64 * 1024;
  private final static int    THREADS      = 3;
  private final static int    SIZE_OF_INT  = 4;
  private final static int    LENGTH_SIZE  = SIZE_OF_INT;
  private final static int    ID_SIZE      = SIZE_OF_INT;
  private final static int    HEADER_SIZE  = LENGTH_SIZE + ID_SIZE;
  private final static String NEW_LINE     = System.getProperty("line.separator");

  private ServerSocket m_serverSocket = null;
  private Socket       m_clientSocket = null;
  private int          m_iThreadCounter;

  public static void main(String[] args)  
  {
    new TCPTest();
  } // main

  public TCPTest() 
  {
    final String id = "ReaderThread[*]";
    // start a new thread creating a server socket waiting for connections 
    new Thread(new Runnable() 
    {
      public void run() 
      {
        try 
        {
          // create server socket and accept client requests
          m_serverSocket = new ServerSocket(12345);
          m_clientSocket = m_serverSocket.accept();
          // client request => prepare and read data
          long       startTime       = System.currentTimeMillis();
          byte[]     buffer          = new byte[BUFFER_SIZE];
          ByteBuffer header          = ByteBuffer.allocate(HEADER_SIZE);
          int        iTotalBytesRead = 0;
          boolean    fTerminate      = false;
          int        iBytesRead;
          // get hold of socket's input stream
          InputStream clientInputStream = m_clientSocket.getInputStream();
          // loop
          while (false == fTerminate)
          {
            // loop to read next header
            for (int i = 0; i < HEADER_SIZE; i++)
              clientInputStream.read(header.array(), i, 1);
            header.rewind();
            // get information of interest
            int iLength      = header.getInt();
            int iId          = header.getInt();
            int iLengthSoFar = 0;
            int iBytesLeft   = iLength;
            int iBytesToRead;
            // any length given?
            if ((0 < iLength) && (BUFFER_SIZE >= iLength))
            {
              // that's the case => read complete message
              while (iLengthSoFar < iLength)
              {
                // calculate number of bytes left
                iBytesLeft = iLength - iLengthSoFar;
                 // calculate maximum number of bytes to read
                if (iBytesLeft > BUFFER_SIZE)
                  iBytesToRead = BUFFER_SIZE;
                else
                  iBytesToRead = iBytesLeft;
                // read next portion of bytes
                if ((iBytesRead = clientInputStream.read(buffer, 0, iBytesToRead)) != -1)
                {
                  // maintain statistics
                  iTotalBytesRead += iBytesRead;
                  iLengthSoFar += iBytesRead;
                } // if
                else
                {
                  // finish => print message
                  System.out.println("==> "+id+": ERROR length=<-1> received " +
                        "for id=<"+iId+">");
                  fTerminate = true;
                  break;
                } // else
              } // while
            } // if
            else
            {
              System.out.println("==> "+id+": ERROR data length <= 0 for id=<"+iId+">");
              dump(header, 0, HEADER_SIZE / SIZE_OF_INT, "Error header");
            } // else
          } // while
          System.out.println("==> "+id+": "+ iTotalBytesRead + " bytes read in " 
                              + (System.currentTimeMillis() - startTime) + " ms.");
        } // try 
        catch (IOException e) 
        {
          e.printStackTrace();
        } // catch
      } // run
    }).start();
    // create the socket writer threads
    try
    {
      // ensure server is brought up and request a connection
      Thread.sleep(1000);
      System.out.println("==> "+id+": just awoke");
      Socket       socket             = new Socket("localhost", 12345);
      OutputStream socketOutputStream = socket.getOutputStream();
      System.out.println("==> "+id+": socket obtained");
      // create some writer threads
      for (int i = 0; i < THREADS; i++)
        // create a new socket writer and start the thread
        (new SocketWriter(socket, 
                          (i+1),
                          BUFFER_SIZE,
                          new String("WriterThread["+(i+1)+"]"),
                          socketOutputStream)).start();
    } // try
    catch (Exception e)
    {
      e.printStackTrace();
    } // catch
  } // TCPTestEx

  private final static void dump(ByteBuffer bb, int iOffset, int iInts, String header)
  {
    System.out.println(header);
    bb.rewind();
    for (int i = 0; i < iInts; i++)
      System.out.print(" " + Integer.toHexString(bb.getInt()).toUpperCase());
    System.out.print(NEW_LINE);
  } // dump

  private class SocketWriter extends Thread
  {
    Socket       m_socket;
    int          m_iId;
    int          m_iBufferSize;
    String       m_id;
    OutputStream m_os;

    protected SocketWriter(Socket socket, int iId, int iBufferSize, String id, OutputStream os)
    {
      m_socket       = socket;
      m_iId          = iId;
      m_iBufferSize  = iBufferSize;
      m_id           = id;
      m_os           = os;
      // increment thread counter
      synchronized (m_serverSocket)
      {
        m_iThreadCounter++;
      } // synchronized
    } // SocketWriter

    public final void run()
    {
      try 
      {
        long       startTime        = System.currentTimeMillis();
        ByteBuffer buffer           = ByteBuffer.allocate(m_iBufferSize + HEADER_SIZE); 
        int        iTotalBytesRead  = 0;
        int        iNextMessageSize = 512 * m_iBufferSize; 
        int        iBytesRead;
        // open input stream for file to read and send
        FileInputStream fileInputStream = new FileInputStream(INPUT_FILE);
        System.out.println("==> "+m_id+": file input stream obtained");
        // loop to read complete file
        while (-1 != (iBytesRead = fileInputStream.read(buffer.array(), HEADER_SIZE, m_iBufferSize))) 
        {
          // add length and id to buffer and write over TCP
          buffer.putInt(0, iBytesRead);
          buffer.putInt(LENGTH_SIZE, m_iId);
          m_os.write(buffer.array(), 0, HEADER_SIZE + iBytesRead);
          // maintain statistics and print message if so desired
          iTotalBytesRead += iBytesRead;
          if (iNextMessageSize <= iTotalBytesRead)
          {
            System.out.println("==> "+m_id+": <"+iTotalBytesRead+"> bytes processed");
            iNextMessageSize += MESSAGE_SIZE;
          } // if
        } // while
        // close my file input stream
        fileInputStream.close();
        System.out.println("==> "+m_id+": file input stream closed");
        System.out.println("==> "+m_id+": <"+ iTotalBytesRead + "> bytes written in " 
                            + (System.currentTimeMillis() - startTime) + " ms.");
        // decrement thread counter
        synchronized (m_serverSocket)
        {
          m_iThreadCounter--;
          // last thread?
          if (0 >= m_iThreadCounter)
            // that's the case => terminate
            System.exit(0);
        } // synchronized
      } // try 
      catch (Exception e) 
      {
        e.printStackTrace();
      } // catch
    } // run
  } // SocketWriter
} // TCPTest 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:36:21.897

耶。TCP 是一种面向字节的流协议。这意味着应用程序接收到一个（未定界的）字节流。“消息”的概念应该由应用程序提供（或使用面向消息的协议）。

# c# - 为什么我的 C# 结构在传递给方法时被重置

> ID：14939763
> 
> 赞同：1
> 
> 时间：2013-02-18T15:30:53.027
> 
> 标签：c#, struct, parameter-passing, reset

我正在创建一个简单的文本游戏。我的`Character`结构不断重置它的`Can`值。我做错了什么，我该如何解决？这是代码：

```
namespace MyNamespace
{
   struct Character
   {
      public float Can;
      //...
   }

   class MainClass
   {
      public static void Move (Character a)
      {
         bool cal = true;

         while (cal) 
         {
            Thread.Sleep(500);

            if(a.Can <= 100)
            {
               a.Can += 1;
            }
            else
            {
               cal = false;
            }
         }
     }
  }

  //...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:48:57.797

A`struct`是一个**值类型**。当您将其传递给方法或将其分配给另一个变量时，数据将被**复制**。然后，您将对副本进行操作。

考虑您的方法调用**`Dinlen (oyuncu);`**。它复制 Karakter `oyuncu`，然后更改`Can` *副本*的字段。

考虑改用引用类型 ( `class`)。如果您使用 a `struct`，请考虑将其*设为不可变*类型。阅读线程*[为什么可变结构是邪恶的？](https://stackoverflow.com/questions/441309/)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:35:11.600

当您将 struct 实例传递给方法时，会创建 struct 的副本（它是按值传递的）。对结构内部方法的任何更改都不会影响您传递的原始结构。

解决方案？使用类而不是结构。通过引用传递的类的实例。好吧，您可以通过引用传递结构，但是为什么要尝试使用类之类的结构呢？改用类。

```
class Karakter
{
    public string Isim { get; set; }
    public float Can { get; set; }
    public int Seviye { get; set; }
    public int Exp { get; set; }
    public float Guc { get; set; }
    public string Irk { get; set; }
    public int vExp { get; set; }

    public override string ToString()
    {
        return String.Format("Adınız:{0}\nIrkınız:{1}\nCan:{2}\nGuc:{3}", 
                             Isim, Irk, Can, Guc);
    }
} 
```

顺便说一句，我认为阅读.NET 中的[值和引用类型](http://msdn.microsoft.com/en-us/library/4d43ts61%28v=vs.90%29.aspx)对您很有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:36:32.523

我相信问题是您将`struct`作为变量传递给您的第一个方法，但结构是值类型 - 即它们是复制的，而不是通过引用传递的。

改变你`struct`将`class`有你需要的行为。

PS你选择a有什么原因`struct`吗？它们通常用于更高级的场景，开发人员更了解使用这种类型的好处和缺陷。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:48:35.443

您可能需要考虑使用类而不是结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T15:52:59.960

如前所述，结构是一种值类型，并通过副本传递。您可以像这样通过 ref 传递它：

```
public static void Move (ref Character a)
{
...
} 
```

并这样称呼它：

```
var a = new Character();
MainClass.Move(ref a); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T17:10:56.467

如果要将结构传递给方法以使该方法对其进行修改，则该方法必须`ref`在参数上使用限定符。如果将结构传递给不带`ref`参数的方法，则该方法无法修改该结构的任何字段。

请注意，有些人可能会建议将结构替换为类，这样就不必使用`ref`限定符。这是一个危险的概念，因为每个接收到对可变类对象的引用的方法都可以自由地导致该对象在此后的任何时间发生变异。没有干净的方法来传递对可变类对象的引用而不允许接收者对其进行变异，也没有任何方法可以确定给定类对象引用的代码不会持久保存它并使用它来修改在任意未来时间的对象。结构没有这些问题。

如果一个对象包含一个值类型字段，例如`MyBounds`type `Drawing.Rectangle`，并且我打电话给我，`Foo(MyBounds)`我可以确信它不可能发生`Foo`变化`MyBounds`。此外，如果我打电话，`Bar(ref MyBounds)`我可以预期这`Bar`可能会改变`MyBounds`，但所有的改变都将*在方法返回之前*完成。如果`Rectangle`它是一个可变类类型，那么如果不进行检查`Foo`，`Bar`我将无法知道`MyBounds`未来的任何时候是否会更改 的属性。

不了解结构体与类不同的人可能会对结构体的行为方式感到困惑，但*所有具有公开公共字段的结构体的行为方式都是相同的*，因此，如果了解一个这样的结构体是如何工作的，就会理解所有结构体。结构有一个邪恶的方面，即在结构上定义的实例方法和属性将`this`作为`ref`参数接收，但如果尝试执行以下操作：

```
readonly System.Drawing.Rectangle myRect = whatever;
...
myRect.Offset(4,2); 
```

系统将识别出`myRect`不能作为`ref`参数传递（因为它是只读的）并且将在没有任何诊断的情况下将代码更改为：

```
readonly System.Drawing.Rectangle myRect = whatever;
...
System.Drawing.Rectangle temp = myRect;
temp.Offset(4,2); 
```

然而，那里的邪恶不是`Rectangle`可变的事实，而是编译器假定上述代码替换在调用任何和所有值类型方法时是合法的这一事实。除非或直到 Microsoft 开始添加一个属性以指示在只读结构上调用特定方法会导致错误而不是执行此类替换，否则对结构上操作的结构方法进行编码的唯一安全方法“in- place" 将使用类似: 的格式`static void Offset(ref Rectangle it, int x, int y);`，在这种情况下`Rectangle.Offset(ref myRect, 4, 2);`会失败。

# api - 为什么 API 中存在整数错误代码？

> ID：14939764
> 
> 赞同：0
> 
> 时间：2013-02-18T15:30:55.130
> 
> 标签：api, error-handling

在几乎每一种 API 中，都有整数错误代码，例如 (ex. `123`)，它指示错误类型。我想知道使用描述性字符串代码是否更好，例如`user_not_found`or `invalid_request`。在我看来，它们更实用：假设您在几个月后回到您的代码，您可以轻松地完成错误处理部分，而无需在文档中搜索错误代码。

为什么 API 中仍然存在整数错误代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:34:31.073

在 API 中，客户端通常是使用条件测试响应代码的计算机。

测试整数比测试字符串要快得多，仅此而已**。**

此外，错误代码具有一定的逻辑：API 通常使用 HTTP 代码，因此当您（作为人类）阅读它们时，您知道`2xx`指示成功、`4xx`指示客户端错误和`5xx`指示服务器端错误，即使您不知道。对他们都熟记于心。

**编辑：**

你的问题让我想到了[这个答案](https://stackoverflow.com/a/14510566/1225541)，关于网站的加载时间如何影响利润。您应该阅读它以说服自己，即使是几毫秒有时也很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:35:33.707

但是大多数错误都有好听的名字。标准 C、POSIX 和 Windows 都有错误代码的名称。当然，这些名称中的大多数都是作为预处理器宏制作的，但也有一些函数可以从这些消息中获取漂亮的字符串或消息。

# sql - 使用 Excel 宏 (ADODB) 在 SQL Server 2008 中创建临时表

> ID：14939766
> 
> 赞同：6
> 
> 时间：2013-02-18T15:31:03.153
> 
> 标签：sql, sql-server-2008, vba, excel

经过大量的谷歌搜索，我最终得到了以下宏，我希望它可以连接到数据库，删除任何现有的临时表，然后创建一个新表（填充它并查看结果）。

```
Dim adoCn As ADODB.Connection
Dim adoRs As ADODB.Recordset
Dim adoCm As ADODB.Command
Dim strSQL As String

Set adoCn = New ADODB.Connection
With adoCn
    .ConnectionString = "Provider=SQLOLEDB;" & _
                        "Initial_Catalog=XXX;" & _
                        "Integrated Security=SSPI;" & _
                        "Persist Security Info=True;" & _
                        "Data Source=XXX;" & _
                        "Extended Properties='IMEX=1'"
    .CursorLocation = adUseServer
    .Open
End With

Set adoCm = New ADODB.Command

With adoCm
    Set .ActiveConnection = adoCn
    .CommandType = adCmdText
    .CommandText = "IF OBJECT_ID('tempdb..#AgedProducts') IS NOT NULL DROP TABLE #AgedProducts"
    .Execute
    .CommandText = "CREATE TABLE #AgedProducts " & _
                   "(Source_Order_Number VARCHAR(255)) " & _
                   "INSERT INTO #AgedProducts VALUES ('AB-123-456') " & _
                   "SELECT * FROM #AgedProducts (NOLOCK) "
    .Execute
End With

Set adoRs = New ADODB.Recordset
With adoRs
    Set .ActiveConnection = adoCn
    .LockType = adLockBatchOptimistic
    .CursorLocation = adUseServer
    .CursorType = adOpenForwardOnly
    .Open "SET NOCOUNT ON"
End With
adoRs.Open adoCm

MsgBox "Recordset returned...", vbOKOnly

While Not adoRs.EOF
    Debug.Print adoRs.Fields(0).Value
    adoRs.MoveNext
Wend

adoCn.Close

Set adoCn = Nothing
Set adoRs = Nothing 
```

当我运行查询时，我收到以下错误消息：

`Run-time error '-2147217887 (80040e21)':`

`The requested properties cannot be supported`

该`NOCOUNT`行来自[http://support.microsoft.com/kb/235340](http://support.microsoft.com/kb/235340)（与上述大部分代码一样）。我添加`IMEX=1`了考虑到订单号可能有多种类型，但我怀疑这就是问题所在。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T16:17:35.940

修改recodset的打开方式，将select从命令移到recodset open方法调用。

```
With adoCm
    Set .ActiveConnection = adoCn
    .CommandType = adCmdText
    .CommandText = "IF OBJECT_ID('tempdb..#AgedProducts') IS NOT NULL DROP TABLE #AgedProducts"
    .Execute
    .CommandText = "CREATE TABLE #AgedProducts " & _
                   "(Source_Order_Number VARCHAR(255)) " & _
                   "INSERT INTO #AgedProducts VALUES ('AB-123-456') "
    .Execute
End With

Set adoRs = New ADODB.Recordset
With adoRs
    Set .ActiveConnection = adoCn
    .LockType = adLockBatchOptimistic
    .CursorLocation = adUseServer
    .CursorType = adOpenForwardOnly

End With
adoRs.Open "SELECT * FROM #AgedProducts (NOLOCK)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:40:14.880

我对临时表的理解是它们仅对创建它们的连接可用。在这种情况下，试图从另一个连接中删除一个是不明智的。

错误消息没有说明是哪一行代码导致了它。既然如此，我建议您逐个测试您的代码。首先创建连接。然后打开并关闭它。然后在连接打开时开始做事，但一次做一件事。

# php - 使用 php 的 shell_exec 运行多个命令

> ID：14939769
> 
> 赞同：0
> 
> 时间：2013-02-18T15:31:06.517
> 
> 标签：php, command-line-interface

我已经尝试了一段时间我可能知道的所有方法，但还没有破解这个东西，它可能非常微不足道，但找不到答案。

例如，我想使用 php shell_exec 一次运行多个命令，`shell_exec("cd ..; dir")` 但我无法找到如何执行几个命令，分隔符是什么？是吗；是/n吗？似乎没有任何效果。

请注意我正在使用 Windows 运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:34:05.073

[https://superuser.com/a/62854](https://superuser.com/a/62854)

> `&&`如果命令 1 没有失败，`&`将在命令 1 完成时执行命令 2，无论如何都会执行。

# progress-4gl - 将临时表“转储”为 SQL 格式的最简单方法是什么

> ID：14939770
> 
> 赞同：0
> 
> 时间：2013-02-18T15:31:13.553
> 
> 标签：progress-4gl, openedge

版本：10.2b

所以可以说我有一个正在进行的餐桌狗：

```
table: dogs 
fields: name, age, breed 
```

我想使用标准加载实用程序将它们加载到 oracle 数据库中。但是oracle中的表是这样的

```
table: dog
fields: name, age, date_last_updated 
```

所以如果我制作一个与之匹配的临时表，有没有办法将临时表“转储”到 sql 中？（这样我就可以将它加载到 oracle 中）

如果不是，那也是一个很好的答案。

谢谢你的帮助！！

编辑：通过“sql转储”我的意思是：

```
INSERT INTO dog
VALUES (Max, 5, Feb 18, 2013) 
```

除了将“INSERT INTO”字样导出到我的文件中之外，有没有办法以这种格式获取表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T02:07:21.093

使用支持 ODBC 的数据库管理工具（例如[DBeaver](http://dbeaver.jkiss.org/)），您可以连接到进度数据库并将表和视图导出到 SQL 插入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:48:39.653

感谢您的澄清。

在 4GL 中，转储表（真实表或临时表）的“自然”方式是使用 EXPORT 语句创建文本文件。像这样：

```
/* export the dog record as-is
 */

output to "dog.d".
for each dog no-lock:
  export dog.
end.
output close. 
```

或者：

```
/* export modified dog records
 */

output to "dog.d".
for each dog no-lock:
  export dog.name dog.age now.
end.
output close. 
```

这个[Oracle: Import CSV file](https://stackoverflow.com/questions/6198863/oracle-import-csv-file-using-sqlplus)建议可以将 CSV 文件导入 Oracle，因此您可以像这样修改上面的代码以创建一个逗号分隔的文件，而不是使用 Progress 的默认空格分隔符：

```
/* export modified dog records to a CSV file
 */

output to "dog.csv".
for each dog no-lock:
  export delimiter "," dog.name dog.age now.
end.
output close. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T16:06:18.877

根据您的问题，这样的事情会起作用。您还可以将“TT”引用替换为实际的表名。

```
OUTPUT TO VALUE("sqldump").

FOR EACH tt-dogs:

  PUT UNFORMATTED
     "INSERT INTO dog VALUES (" tt-dogs.dog-name tt-dogs.age TODAY ")" SKIP.

END.

OUTPUT CLOSE. 
```

# java - Java 绘图生成器

> ID：14939771
> 
> 赞同：1
> 
> 时间：2013-02-18T15:31:18.583
> 
> 标签：java, graph, plot

我想实现一种绘图生成器（xy 图、x-time 图、条形图而不是复杂图），用户可以在其中定义通用属性。结果应该是一些模板，可以在运行时（拖放）在另一个应用程序中使用，在该应用程序中决定要绘制的数据。您是否知道一些要集成到 java 中的工具或一些文章从哪里开始。我试图猜测JFreeChart或Gral是否能够用于此类事情或直接通过购买一些产品。

谢谢马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:39:20.193

您当然可以为此使用[JFreeChart](http://www.jfree.org/jfreechart/) - 它是一个很好的库，图表非常灵活，可以从常规绘图中完成您可能需要的所有事情。

尽管您需要做一些额外的工作来实现“拖放”和特殊的数据链接功能。我预计这将是困难的部分，无论您使用什么图表工具。

# networking - UNC 上的 PowerShell 操作挂起时间过长

> ID：14939777
> 
> 赞同：4
> 
> 时间：2013-02-18T15:31:42.413
> 
> 标签：networking, powershell, timeout, unc

```
$to="\\SERVER\Share\Folder"
if(!(test-path $to))
{
    ...
} 
```

如果服务器离线（解析名称但没有 ping），来自测试路径的调用永远不会返回（在我对脚本时间的狭隘理解中）。失败的时间太长了。最后我得到了期待已久的结果 False 在用黄油烤面包后，发现没有咖啡，跑出去买一些，等待水再次沸腾，发现我的烤面包很冷。回到屏幕上，看到它就在那里出现......

与经典 DOS 目录相同的路径在一些实际时间后按预期失败：

```
dir "\\SERVER\Share\Folder" 
```

说“找不到网络路径”。不到3分钟！

PS 的这种行为真的破坏了我的脚本。

准确地说

```
$t0 = get-date; test-path "\\SERVER\Share\Folder"; $t1 = get-date; ($t1-$t0).TotalSeconds 
```

给我

```
False
595.2214875 
```

提示：用解析本地网络离线 PC 名称替换 SERVER

啊问题是：1）你如何处理这个？2）那里的麻烦到底是什么？

更新：使用离线 IP 地址时的时间是相同的。DNS 已退出游戏。

更新2：我想知道，有没有人经历过同样的浪费时间？在 64 位 W2k8R2 服务器上试过，没有问题。呼叫最多在 30 秒内返回。我的问题是在 32 位 Windows XP PC 上。

谢谢，罗伯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T15:47:18.797

我无法模拟这种情况，但我有一个建议。首先尝试 ping 服务器，然后尝试建立连接。

```
 $(Test-Connection -ComputerName SERVER -ErrorAction SilentlyContinue -Count 1).StatusCode 
```

如果 ping 成功，此命令将返回 0，因此您可以在条件语句中使用它。

# php - PHP 到 XML 插入数组

> ID：14939779
> 
> 赞同：0
> 
> 时间：2013-02-18T15:31:45.413
> 
> 标签：php, xml

我有一个使用以下示例构建的 XML 字符串：

```
//add root
$Add = $dom->appendChild($dom->createElement('Add')); 
//pCase
$pCase = $Add->appendChild($dom->createElement('pCase')); 

//add elements
$LeadGenID = $pCase->appendChild($dom->createElement('LeadGenID'));
$LeadGenID->appendChild($dom->createTextNode('22'));

$Debtor = $pCase->appendChild($dom->createElement('Debtor'));
//address fields
$Addresses = $Debtor->appendChild($dom->createElement('Addresses'));
$Address = $Addresses->appendChild($dom->createElement('Address'));
//array of address objects should go here

$test1 = $dom->saveXML();
$sxe = simplexml_load_string($test1);

if ($sxe === false) {
echo 'Error while parsing the document';
    exit;
}

    $dom_sxe = dom_import_simplexml($sxe);
    if (!$dom_sxe) {
       echo 'Error while converting XML';
       exit;
    }

    $dom = new DOMDocument('1.0', 'utf-8');
    $dom_sxe = $dom->importNode($dom_sxe, true);
    $dom_sxe = $dom->appendChild($dom_sxe);

    echo $dom->save('application.xml'); 
```

然后在我的 XML 中输出以下内容：

```
<Add>
<pCase>
    <LeadGenID>22</LeadGenID>
    <Debtor>
        <Addresses><Address/></Addresses>
    </Debtor>
</pCase> 
```

我还需要将一个数组输出到这个 XML 中，这样完整的输出如下：

```
<Add>
<pCase>
    <LeadGenID>22</LeadGenID>
    <Debtor>
        <Addresses>
            <Address>
                <Street>Some street</Street>
                <Postcode>Some postcode</Postcode>
            </Address>
        </Addresses>
    </Debtor>
</pCase> 
```

我试图用

```
$address_array = array (
    $_POST['Street'] => 'Street',
    $_POST['Postcode'] => 'Postcode'
);
$xml = new SimpleXMLElement('<Address/>');
array_walk_recursive($address_array, array ($xml, 'addChild')); 
```

但此时我完全迷失了。至少可以说，我得到的 API 在文档上很少，但我越来越接近它，但我需要输入地址作为网关的数组。我是 PHP 新手，因为我主要是一名前端开发人员，通常只在 PHP 中完成简单的联系表格等。

如何输出上面给出的 XML 示例？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:47:00.997

我发现的随机奇怪的东西：

*   你开始，`new SimpleXMLElement('<Address/>')`但你的根节点是`<Addresses>`
*   一个`$Address`变量不知从何而来
*   一个`$dom`物体不知从哪里冒了出来
*   你打电话给`createTextNode()`哪个：
    1.  它不是 SimpleXML 方法，而是 DOMDocument 方法
    2.  期望一个字符串作为参数，但它被提供了一个`SimpleXMLElement`实例
    3.  创建一个**文本**节点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T14:40:28.533

看看[http://www.lalit.org/lab/convert-php-array-to-xml-with-attributes/](http://www.lalit.org/lab/convert-php-array-to-xml-with-attributes/) 如果您只需要数组到 xml，它是一个非常小且易于使用的库。

# php - 用字符串连接数组元素

> ID：14939785
> 
> 赞同：0
> 
> 时间：2013-02-18T15:32:04.193
> 
> 标签：php, arrays, codeigniter, implode

我想用字符串连接数组元素（例如`-`：），我用 implode 尝试过，但它在我的代码中不起作用。

如何解决？

**PHP：**

```
<?php

   $count = 1;
   $ttttt = json_decode('["110,2"]');
   $nnnnn = array("110","1","2");
   $fffff = array('name','day','last');
   $Rtp = str_replace($nnnnn, $fffff, $ttttt, $count);
   echo implode(" - ", $Rtp); // This output is as: name,last

?> 
```

**演示：** [http ://codepad.viper-7.com/ZNiBWy](http://codepad.viper-7.com/ZNiBWy)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:35:25.957

您的 JSON 不像您期望的那样有效，它只生成一个值`110,2`。

将其更改为`["110","2"]`，您的内爆应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:38:21.017

你有一个数组 $ttttt = array(110, 2) 。然后，您使用 str_replace 替换此数组中的所有值，如下所示 110 -> name、2 -> last 和 1 -> day。

所以 (110, 2) 变成 ("name", "last")

# mysql - MySQL 存储函数：包含 SQL 还是没有 SQL？

> ID：14939786
> 
> 赞同：3
> 
> 时间：2013-02-18T15:32:04.743
> 
> 标签：mysql, stored-functions

对于下面的存储函数，哪个是正确的标志：CONTAINS SQL 还是 NO SQL？

```
CREATE FUNCTION BigIntHash(str VARCHAR(255)) RETURNS BIGINT UNSIGNED DETERMINISTIC
RETURN CONV(SUBSTRING(CAST(SHA(str) AS CHAR), 1, 15), 16, 10) 
```

和

```
CREATE FUNCTION upi(a VARCHAR(14), b INT(8) UNSIGNED, c VARCHAR(13)) RETURNS BIGINT UNSIGNED DETERMINISTIC
RETURN IF(a IS NULL, 
  IF(b IS NULL, 
    IF(c IS NULL, 
      NULL, 
      BigIntHash(CONCAT("a-", a))
    ), 
    BigIntHash(CONCAT("b-", b))
  ), 
  BigIntHash(CONCAT("c-", c))
) 
```

定义在[http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html](http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html)但我仍然不确定：

*   **CONTAINS SQL**表示例程不包含读取或写入数据的语句。如果没有明确给出这些特征，则这是默认设置。此类语句的示例是 SET @x = 1 或 DO RELEASE_LOCK('abc')，它们执行但既不读取也不写入数据。

*   **NO SQL**表示例程不包含 SQL 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:44:19.203

两者都是`NO SQL`因为它们不访问表、游标或变量中的数据。

有关什么构成 SQL 语句的参考，请参阅：[http ://dev.mysql.com/doc/refman/5.1/en/sql-syntax.html](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax.html)

请注意本章中提到`CONV()` `SHA()`或未提及的函数。`CONCAT()`

# entity-framework-4 - 在 EntityFramework 中导航属性时，如何防止延迟加载已经手动加载的实体

> ID：14939788
> 
> 赞同：1
> 
> 时间：2013-02-18T15:32:22.330
> 
> 标签：entity-framework-4, lazy-loading, objectcontext

**背景：** 我正在使用 EF4 和`ObjectContext`. 为了优化复杂对象层次结构的检索，我手动执行数据库查询，然后使用`ObjectContext.Translatey<T>(DataReader, entitySetName, mergeOptions.AppendOnly)`将数据行转换为实体。然后我将实体附加到`ObjectContext`with`Attach`方法。这也修复了实体之间的关系。

**问题：** 加载并设置完所有内容后，我尝试从父实体导航到子实体（例如 Parent.Childs.First()），但 EF 命中数据库以加载孩子，即使所有子实体都是已经存在于 ObjectContext 和 EntitySet 中。看起来原因是 parent.Childs.IsLoaded 设置为 false 这使 EF 认为它仍然需要加载关系。

**问题：** 如何告诉 EF EntitySet 已经加载？

是否有支持的方式设置`RelatedEnd.IsLoaded`为 true。我不想搞乱调用`RelatedEnd.SetIsLoaded`内部方法。

[我在这里](http://social.msdn.microsoft.com/Forums/en/adonetefx/thread/c8d7733c-da9b-4f25-9648-0c64cda9a8b1)发现了一个 smilar 问题，但它与 DbContext 相关并且没有令人满意的答案；-)

马特拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-27T04:32:43.680

看起来这是在此更改中实现的：http: [//entityframework.codeplex.com/workitem/269](http://entityframework.codeplex.com/workitem/269)

您现在可以遍历您的实体并告诉他们他们的子集合已经加载：

```
foreach (var entity in loadedEntities)
  context.Entry(entity).Collection(a => a.SomeChildCollection).IsLoaded = true; 
```

`SomeChildCollection`这将防止在从 访问实体时加载它们`entity`。

我不确定这出现在哪个版本的 EF 中，但我猜是 6.0.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T19:30:51.517

解决这个问题的唯一方法是关闭延迟加载。您在 MSDN 上找到的问题询问`DbContext`但答案提到无法更改底层库中的值 - ObjectContext API（在您的情况下为 EF4）是底层库。即使在 .NET 4.5 (EF5) 中`IsLoaded`，公共 API 上的设置仍然不可用。

# php - 充当 get 而不是 post 的 HTML 表单

> ID：14939791
> 
> 赞同：1
> 
> 时间：2013-02-18T15:32:28.563
> 
> 标签：php, html, mysql

我对整个 PHP/HTML 交易很陌生，我遇到了一个我不知道如何解决的问题。这是一个非常简单的表格，可让您将数据输入数据库。PHP代码如下：

```
<?

    include("../sqlcontext.php");
    $foo = mysql_query("SELECT*FROM users WHERE checksum='".$_COOKIE['userCookie']."'");
    if($_COOKIE['userCookie'] == '' || !mysql_num_rows($foo)){
        echo 'Du er ikke logget ind :( <a href="login.php">log ind her</a>';
    }
    else{ 

    if($_POST['genreKnap']){
        $nameGenre = $_POST['nameGenre'];
        $textGenre = $_POST['textGenre'];       
        $succes = mysql_query("INSERT INTO genre VALUES('null','$nameGenre','$textGenre')");

        if($succes){
            echo 'Yay!';
        }else {
            echo 'Oh no';
        }
    } 

?> 
```

表格如下：

```
<form name="form1" method="post" enctype="text/plain" action="">
  <table>
    <tr>
        <td>Genre navn:</td>
        <td><input type="text" name="nameGenre" id="nameGenre" style="width:100%; padding-right: 1px" /></td>
    </tr>
    <tr>
        <td>Genre beskrivelse:</td>
        <td><textarea name="textGenre" id="textGenre" style="width:100%; padding-right: 1px"></textarea></td>
    </tr>
    <tr>
        <td></td>
        <td><input type="submit" name="genreKnap" id="genreKnap" value="Go!"/></td>
    </tr>
  </table>    
</form> 
```

每当我按下提交按钮时，它似乎就像是一个 get 方法而不是一个帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:41:21.457

啊哈！！！

您没有正确张贴表格。设置

`action=""`

至

`action="code.php"`

假设您的 php 页面名为 code.php。只需将其更改为 php 页面的名称/路径，表单就会将数据发送到您的 php 代码进行处理。

当您`action=""`留空时，它会将数据发布到自身（同一页面）。它不是充当 GET，它仍然充当 POST，但发布到错误的位置。我认为你用错了问题的标题。

* * *

你是什​​么意思它表现得像get而不是post。您不能在 PHP 中读取 $_POST 变量吗？

删除`'enctype="text/plain"'`表单代码中的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T09:42:23.177

如果您通过表单发送没有任何文件的正常数据。那么`enctype` 并不总是需要的。

但即使你想包含它，正确的方法是：

```
enctype="multipart/form-data" 
```

还要在表单的 action 方法中给出一个 url：`<form action='example.php'>`

我希望它能解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T16:09:19.047

你们都忽略了主要问题并专注于不相关的项目。

首先，最重要的是他使用了一个简短的 php 开瓶器，现在`<?`并不是`<?php`每个 Web 服务器都接受简短的开瓶器，首先检查一下。

回显您的 $_POST 变量，看看他们是否返回了正确的项目

```
echo "POSTS BELOW<br />";
echo $_POST['nameGenre']."<br />";
echo $_POST['textGenre']."<br />"; 
echo "<br />GETS BELOW<br />";
echo $_GET['nameGenre']."<br />";
echo $_GET['textGenre']."<br />"; 
```

把这段代码直接放在你的 php opener 下，看看它返回了什么数据。

此外，这`if($_POST['genreKnap']){`通常是一种不好的方法，因为它的用户输入最安全的方法是隐藏字段`<input type="hidden" name="action" id="action" value="dopost" />`并将您的 if 子句更改为`if($_POST['action']=="dopost && isset($_POST['action'])){`

还将您的表单 action="" 设置为实际页面名称而不是空白

试一试，如果它仍然不起作用，我们将尝试不同的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:46:01.333

有效的表单编码类型：

```
application/x-www-form-urlencoded: This is the default content type

multipart/form-data 
```

> 内容类型“application/x-www-form-urlencoded”对于发送大量二进制数据或包含非 ASCII 字符的文本效率低下。内容类型“multipart/form-data”应用于提交包含文件、非 ASCII 数据和二进制数据的表单。

来源：[http ://www.w3.org/TR/html401/interact/forms.html#h-17.13.3.4](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.3.4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T15:40:37.397

> enctype="文本/普通"

把它拿出来。它仅用于调试目的，不会生成任何可以用机器解析的东西。

# javascript - 如果输入没有数组，如何禁用按钮？

> ID：14939793
> 
> 赞同：1
> 
> 时间：2013-02-18T15:32:36.927
> 
> 标签：javascript, jquery, html, css

我的 HTML 内容中有以下内容，输入值将由用户选择填充，并以数组（`45[45, 6, 33], 67[67,2,5] and so on..`）的格式存储值。基本上该值将如下所示：

```
<input id="question_string" type="hidden" value="{}">
<input class="submit_updates" name="commit" type="submit" value="Process"> 
```

现在，如果输入在`{}`.

更新：

```
var question_hash_element = document.getElementById('question_string');
var question_hash = JSON.parse(question_hash_element.value);

   var myArray = new Array();
      myArray[0] = window.batch_question_id;
      myArray[1] = window.answer_id || window.answer_text || window.batch_answer_checkbox
      myArray[2] = window.build_id 
```

上面这段代码将值存储到`{}`. 我只想禁用并让用户选择所有字段来处理表单。如果值为`{}`，则应禁用该按钮。和里面的任何值，它应该被启用。

我试过如下：

```
 $('.submit_updates').click(function () {
    if ($('#question_string') == {}) {
      return false;
      alert("Select all the Values");
    } else {
      return true;
    }
  }); 
```

它不工作..

任何帮助，将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:40:33.917

```
$('.submit_updates').on('click', function (e) {
   e.preventDefault();
   if ( $.trim($('#question_string').val())=='{}' ) {
       alert('no question !');
   }else{
       this.form.submit();
   }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:38:32.610

您在提醒消息之前返回 false 。

尝试这个：

```
$('.submit_updates').on("click", function () {
  if ($('#question_string').val() == "{}") { //Adjusted condition
    //Alert message
    alert("Select all the Values");

    //Disable the submit button
    $(".submit_updates").prop("disabled", true);
    return false;
  } else {
  return true; //Not really needed
 }
}); 
```

正如@adeneo 建议的那样，使用[`on`](http://api.jquery.com/on/)and[`prop`](http://api.jquery.com/prop/)而不是`click`and更好。`attr`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:41:04.193

尝试这个

```
$(function(){
     $('.submit_updates').on('click', function () {
        if ($('#question_string').val() == "{}") {
              $(this).prop('disabled', 'disabled'); 
              alert("Select all the Values");
        } else {
        }
      });
}); 
```

***[演示](http://jsfiddle.net/vT5wz/2/)***

# perl - 正则表达式与预期不匹配

> ID：14939796
> 
> 赞同：0
> 
> 时间：2013-02-18T15:32:44.040
> 
> 标签：perl

**我正在执行以下代码：**

```
#!/usr/bin/perl -w

my $filter1="^p1c|^p2c|^p3c|^p11c|^p23c|^p105csi1m1|^p105csi1m2|^p105csi1m13|^p105csi2m14|^p101csi1m1|^p101csi1m2|^p101csi1m13|^p101csi2m14|^p103csi1m1|^p103csi1m2|^p103csi1m13|^p103csi2m16|^p102csi1m1|^p102csi1m2|^p102csi1m13|^p102csi2m16|^p100csi1m4|^p100csi1m5|^p100csi2m13|^p100csi1m14";
my $filter2="^p105csi2m13|^p105csi1m14";

$n1="p105csi1m14";

my $m1 .= "$n1 " if($n1 =~ m/$filter1/);
my $m2 .= "$n1 " if($n1 =~ m/$filter2/);

print "\nmatch 1 => $m1\n";
print "\nmatch 2 => $m2\n"; 
```

**上述代码的输出如下：**

```
match 1 => p105csi1m14

match 2 => p105csi1m14 
```

**预期结果如下：**

```
match 1 => 

match 2 => p105csi1m14 
```

我不确定它为什么会这样。有人可以帮助解决上述问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T15:39:09.597

您没有定义匹配的结束，并且`p105csi1m1`是`p105csi1m14`.

解决方案是在正则表达式中添加 a`$`以表示行尾。此外，通过使用组，您可以使其更具可读性并为自己节省很多`^`字符`$`。

```
my $filter1="^(p1c|...|p105csi1m1)$";
my $filter2="^(p105csi2m13|p105csi1m14)$"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:37:14.403

它是匹配的，因为它以 p105csi1m1 开头；该标准出现在您提供的两个过滤器中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:48:52.713

一方面，您正在为自己制造困难。您的正则表达式比它应该匹配的更多，因为它只锚定在字符串的开头。您还需要在最后锚定它以避免部分匹配。此外，您还有很多可以简化的重复文本：

```
my @words = qw(p1c p2c p3c p11c p23c p105csi1m1 p105csi1m2 p105csi1m13 
               p105csi2m14 p101csi1m1 p101csi1m2 p101csi1m13 p101csi2m14 
               p103csi1m1 p103csi1m2 p103csi1m13 p103csi2m16 p102csi1m1 
               p102csi1m2 p102csi1m13 p102csi2m16 p100csi1m4 p100csi1m5 
               p100csi2m13 p100csi1m14);
my $filter1 = '^(?:' . join('|', @words) . ')$'; 
```

虽然这可能通过哈希查找更好地解决：

```
my %lookup = map { $_ => 1 } @words;   # create a key for each word
my $m1 .= "$n1 " if($lookup{$n1});     # check if key exists 
```

请注意，哈希键完全匹配，因此您将没有正则表达式带来的任何灵活性。但在这种情况下，看起来这是一件好事。

# excel - Excel - 在二维中找到一个值

> ID：14939798
> 
> 赞同：3
> 
> 时间：2013-02-18T15:32:50.717
> 
> 标签：excel

我有一个这样的数据表：

```
 a    b    c    d
1    1    2    3    4
2    5    6    7    8
3    9    10   11   12
4    13   14   15   16 
```

我想要一个找到最大值（16）并返回其行号（在本例中为4）的公式。我怎么做？

`INDEX(a1:d1,MATCH(MAX(a1:h4),a1:h4,0),)`不工作:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:54:27.570

工作表布局：：
`B1:E1`列标题
`A2: A5`：行标题
`B2:E5`：数据

数组公式：

```
{MAX(IF(B2:E5=MAX(B2:E5);ROW(B2:E5)-1;""} 
```

由于问题最初要求“d”作为结果，相应的数组公式如下：

```
{=OFFSET(A1;MAX(IF(B2:E5=MAX(B2:E5);ROW(B2:E5)-1;""));0)} 
```

Shift-Ctrl-Enter 在公式窗口中插入。花括号由 Excel 插入，而不是由用户插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T16:14:48.353

还有一位谦虚的女孩的意见：

`=ADDRESS(ROW(OFFSET(A1,MAX(IF(B2:E5=MAX(B2:E5),ROW(B2:E5)-1,"")),0)),COLUMN(OFFSET(A1,0,MAX(IF(B2:E5=MAX(B2:E5),COLUMN(B2:E5)-1,"")))),4)`- 但通过 , 输入为**ARRAY**公式`Ctrl+Shift+Enter`将返回`E5`（假设`@Jüri Ruut`区域），这只是所需单元格的地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:52:47.213

希望这个附加的截图是不言自明的？

![在此处输入图像描述](../Images/8b7d3ec0fed7fc1d9f1768a490c1faf2.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T15:39:38.270

好的，我会编写一个这样的宏：遍历每一行 - 找到该行的最大值。将值存储在数组中，然后再次计算最大值。

可能它也适用于公式。只需计算单独列中每一行的最大值，然后计算该列的最大值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-18T16:07:23.977

试试这个数组公式

`=MIN(IF(A1:H4=MAX(A1:H4),ROW(A1:H4)))`

确认`CTRL+SHIFT+ENTER`

如果在 A1:H4 中多次出现 MAX 值，那么公式将为您提供 它出现的**第一行**

# java - 在java中使用正则表达式进行验证

> ID：14939800
> 
> 赞同：-3
> 
> 时间：2013-02-18T15:32:54.363
> 
> 标签：java, regex, validation

我想在java中使用正则表达式来验证用户输入以将其限制为字母数字字符和'_'。此外，第一个字符必须是字母数字。但是，我对正则表达式一无所知。非常感谢任何帮助。

谢谢阿什什

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T15:36:35.870

尝试这个：

```
String regex = "[a-zA-Z0-9]\\w*";

if (input.matches(regex)) {
    // input is OOK
} 
```

仅供参考，正则表达式`\w`是“字母数字和下划线”的简写，即`[a-zA-Z0-9_]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T15:37:50.210

[阅读精美手册](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)(java.util.regex.Pattern)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:39:59.443

您可以尝试这样的事情（正确 - 如果存在受限字符）：

```
Pattern p = Pattern.compile("[a-zA-Z0-9_]");
Matcher m = p.matcher("12A3");
System.out.println(m.find());

m = p.matcher("&*#");
System.out.println(m.find());

>> true
>> false 
```

# android - 如何启动android活动而不在后面显示主要活动

> ID：14939804
> 
> 赞同：1
> 
> 时间：2013-02-18T15:33:00.980
> 
> 标签：android, android-activity, stack

我正在开发一个包含 2 个活动的应用程序：

1.  主要活动在用户启动应用程序的地方启动。

2.  第二个活动在用户单击主屏幕上的按钮小部件时启动。

我创建了我的小部件和当用户单击小部件按钮时将显示的视图。

**我的问题**：第二个活动UI显示在主活动上方，因为第二个活动布局是透明的，所以主活动可见，因为我想让主屏幕在小部件中单击时仍然可见。

我怎样才能只启动第二个活动而不启动它下面的主要活动？我试图`<action android:name="android.intent.action.MAIN" />`从清单文件中删除主要活动，小部件可以工作，但是当我在手机中安装我的应用程序时，没有安装应用程序图标，因此我无法启动主要活动。

我希望我已经表达了我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:36:04.077

您必须`Activity`在开始第二个后立即完成第一个`Activity`

```
startActivity(<secondActivity>);
finish(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:41:31.107

您可以在开始第二项活动后完成主要活动：

```
startActivity(secondActivity.class);
finish(); 
```

或者在您的应用程序清单中，您可以在您的主要活动上使用 noHistory 标志，因此当您离开它时它会自行调用完成。

```
android:noHistory="true" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T16:00:14.767

也许与第二个活动相关联的不同意图操作和意图过滤器将起作用。看看[文档](http://developer.android.com/guide/components/intents-filters.html)。记事本应用程序示例应该与想要做的类似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T16:18:35.867

我这样解决了我的问题：

1-我在清单文件中添加了主要活动属性：

```
android:launchMode="singleTask" 
```

我测试了它不会使重新启动活动时的加载时间比通常更长，因为此属性不会擦除应用程序缓存并将意图实例保留在内存中。

2-将此添加到主要活动类：

```
@Override
void onPause()
    {
    super.onPause();
    finish();
    } 
```

感谢大家的帮助。

# twitter-bootstrap - 使用响应式设计重新组织 div

> ID：14939807
> 
> 赞同：0
> 
> 时间：2013-02-18T15:33:10.010
> 
> 标签：twitter-bootstrap, responsive-design

我想知道如何使用响应式设计重新组织我的标题。

这是我的代码：

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3">NAME</div>
    <div class="span6">123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789</div>
    <div class="span3">AVATAR</div>
  </div>
</div> 
```

它在水平模式下看起来像我想要的那样（左侧的名称，中间的长消息和同一行右侧的我的头像）。但是在垂直模式下，我有 3 行，最好有这个组织：

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span6">NAME</div>
    <div class="span6">AVATAR</div>
  </div>
  <div class="row-fluid">
    <div class="span12">123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789</div>
  </div>
</div> 
```

因为我的 div 包含`NAME`并且`AVATAR`可以在垂直模式下适合同一行。

我的应用程序中有很多这样的情况，这种情况下的最佳做法是什么？我唯一看到的是用 JQuery 更改 div 顺序，但我想有更好的东西......？

谢谢 ！

# ios - 尝试使用谓词对数组进行排序时出错

> ID：14939810
> 
> 赞同：0
> 
> 时间：2013-02-18T15:33:21.830
> 
> 标签：ios, xcode, arrays, ios6

我在尝试使用另一个数组的过滤结果填充数组时遇到错误。

我在 .h 文件中定义了一个名为 allArray 的全局数组，该数组包含大约 100 个对象。然后，我希望用户能够搜索特定对象，并且我尝试使用谓词来开发它：

```
 -(IBAction)searchChanged:(id)sender {
    //The searchfield's value has been changed.

    NSString *searchString = searchField.text;
    NSPredicate *searchPredicate = [NSPredicate predicateWithFormat:@"self CONTAINS[c] %@", searchString];
    NSMutableArray *tempSearchArray = [allArray filterUsingPredicate:searchPredicate];
    [filteredArray removeAllObjects];
    [filteredArray addObjectsFromArray:tempSearchArray];
} 
```

当我创建 tempSearchArray 时，我最终得到了一个错误。

> 使用不兼容类型“void”的表达式初始化“NSMutableArray *__strong”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:40:54.913

filterUsingPredicate 不返回数组，它什么都不返回（void）。

从描述：

“根据数组的内容评估给定的谓词，只留下匹配的对象”

您应该改用：

```
filteredArrayUsingPredicate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:47:23.680

正如文档将告诉您的，filterUsingPredicate 有一个 void 返回值。看这里：

[NSMutableArray 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)

这意味着您不能将该返回值分配给另一个数组。您需要在原始数组上使用此方法，沿线

```
[allArray filterUsingPredicate:somePredicate]; 
```

arrArray 将被删除任何与谓词不匹配的元素。

现在按照您的意愿处理这些结果。

玩得开心

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:56:44.000

filterUsingPredicate 返回一个 void 而不是一个数组。您可能要考虑改用filteredArrayUsingPredicate

# html - 优化阴影渲染

> ID：14939812
> 
> 赞同：0
> 
> 时间：2013-02-18T15:33:36.673
> 
> 标签：html, css

您对如何提高阴影渲染性能有任何想法吗？

每当我申请

```
-webkit-box-shadow: 
-moz-box-shadow:
box-shadow: 
```

浏览器资源使用量急剧增加。

我绘制 div 阴影与`transform()`.

根据我的测试，与 Firefox 和 Safari 相比，Chrome 的性能最快。对于 IE 和其他浏览器，我还没有测试过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:36:16.390

尝试这个

```
-webkit-box-shadow: 10px 10px 5px #888 !important;
-moz-box-shadow: 10px 10px 5px #888 !important;
box-shadow: 10px 10px 5px #888 !important; 
```

# iphone - ios 6.1.1 设备无法运行 xcode 4.6

> ID：14939814
> 
> 赞同：2
> 
> 时间：2013-02-18T15:33:38.153
> 
> 标签：iphone, ios, xcode, xcode4.6, ios6.1

我刚刚在周末将我的 iphone 4S 从 6.1 更新到 ios 6.1.1，b/c 它说这是一个关键更新。但是，现在当我尝试使用 Xcode 4.6 在手机上测试我的应用程序时，它显示“Xcode 无法使用所选设备运行”。我检查了苹果网站的更新，但没有看到任何 xcode 更新。有任何想法吗？

编辑：我打开了 Xcode 首选项并检查了更新，它说没有，但后来我的手机突然又开始工作了。感谢您的评论和输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:10:44.860

检查 xcode 首选项中的更新后问题自行修复。

# c# - VS2010 C#网站开发进程无法访问该文件，因为它正在被另一个进程使用

> ID：14939815
> 
> 赞同：1
> 
> 时间：2013-02-18T15:33:41.813
> 
> 标签：c#, visual-studio-2010, .net-4.0, crystal-reports, windows-7-x64

我正在 Windows 7 Professional x64 上的 VS2010 Professional 中开发 ASP.NET 4 C# Web 应用程序。

当我使用本地主机进行调试并更改 .cs 文件并保存（ctrl-s）时，会弹出一个另存为对话框，当我单击“是”时“[...] 已经存在。做你想换吗？” 我收到以下错误：“该进程无法访问文件 [...]，因为它正被另一个进程使用”（尽管在过去 2 年的调试中能够保存）。

当我停止调试时，存在相同的行为。我尝试删除其目录中的 .cs 文件，但出现以下错误：“此操作无法完成，因为该文件已在 Microsoft Visual Studio 2010 中打开”

停止调试后可能需要 5 分钟，以便最终能够保存文件。

与其他项目的区别：

*   Windows 更新的完整列表，包括 .net 4 的安全更新 (KB2789642)
*   在我的开发环境中安装水晶报表 7。
*   在我的 web.config 中包含水晶报表程序集。

我已经尝试使用 Unlocker 并且行为仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:38:20.580

这很奇怪，也许有人可以提供更好的答案，但有时 VS 会遇到无法访问它自己锁定的文件的情况。我找到的唯一解决方案是重新启动 Visual Studio。抱歉，我无法提供更多帮助。

# macos - 如何使用 AppleScript 在 Outlook Mac 中打开新的未保存联系人？

> ID：14939823
> 
> 赞同：1
> 
> 时间：2013-02-18T15:34:13.840
> 
> 标签：macos, outlook, applescript

我可以使用 AppleScript 创建一个新联系人并将其打开以在 Mac Outlook 2011 中显示：

```
tell application "Microsoft Outlook"
    set newContact to make new contact with properties {first name:"Fred", last name:"Flintstone"}
    open newContact
end tell 
```

但此联系人已保存。有没有办法打开一个新的*未保存*的Outlook 联系人，填写属性，并允许用户决定是否保存？

我已经修改了“制作新窗口”，但我无法到达那里。我一直收到错误：

```
error "Microsoft Outlook got an error: AppleEvent handler failed." number -10000 
```

我想我需要以不同的方式来解决这个问题，但 Outlook AppleScript 字典中的任何内容看起来都没有希望。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T01:18:41.710

您可以通过编写 UI 元素脚本来打开一个新联系人来做到这一点：

```
tell application "System Events"
  click menu item "Contact" of menu 1 of menu item "New" of menu 1 of menu bar item "File" of menu bar 1 of application process "Outlook"
end tell 
```

更新：但需要注意的是，新联系人在添加到 Outlook 数据库之前不是 AppleScriptable 对象，即它被保存。如果将这些行添加到上述脚本中，您可以看到：

```
tell application "Microsoft Outlook"
  set contactWindow to item 1 of (windows whose index is 1)
  get object of contactWindow
end tell 
```

contactWindow 的对象是缺失值。

因此，如果您想使用 Outlook Applescript 字典 API 编辑新联系人的字段，则必须先保存该联系人。

第二次更新：以下内容在创建联系人后放置在“告诉应用程序“系统事件”块中时，将使用 UI 元素脚本设置该联系人的姓氏、名字和电子邮件地址：

```
set lastName to "Einstein"
set firstName to "Albert"
set emailAddress to "a.einstein@relativity.com"

set value of text field 1 of splitter group 1 of window 1 of application process "Outlook" to lastName
set value of text field 2 of splitter group 1 of window 1 of application process "Outlook" to firstName
set value of text field 6 of scroll area 1 of window 1 of application process "Outlook" to emailAddress 
```

如评论中所述，需要启用“启用辅助设备访问”才能使其正常工作。这也可以通过 AppleScript 以编程方式完成：

```
-- turn on UI automation - may throw a permissions dialog
if UI elements enabled is false then
  set UI elements enabled to true
end if 
```

# c++ - 是否有任何技巧可以检测在执行另一个析构函数期间是否创建了对象？

> ID：14939825
> 
> 赞同：11
> 
> 时间：2013-02-18T15:34:17.600
> 
> 标签：c++, destructor, uncaught-exception, stack-unwinding

这是对[为什么 Alexandrescu 不能使用 std::uncaught_exception() 在 ScopeGuard11 中实现 SCOPE_FAIL 的一种跟进？](https://stackoverflow.com/questions/14927328/why-exactly-cant-alexandrescu-use-stduncaught-exception-to-implement-scope-f)

我想检测是否有人`MyClass`在另一个类的析构函数中创建（或在调用堆栈中的某处使用活动的析构函数）。

```
class MyClass
{
public:
    MyClass(){
        assert(???what to put here????);
    }
}

void f(){
    MyClass m;    //whether this asserts should be context dependant
}

class OtherClass{
    ~OtherClass(){
        MyClass m; //this should assert
        f();       //this should too;
    }
}

int main()
{
    MyClass m;   //this should not assert
    f();         //this should also not assert
} 
```

一种尝试可能是：

```
assert(!std::uncaught_exception()); 
```

但这仅在由于异常而调用析构函数时才有效，而不是因为对象超出范围而被调用时才有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:02:40.223

你无法检测到这一点，你也不想。这不关你的课。如果有人从 noexcept 析构函数中调用你，他会捕获异常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T18:08:08.520

除非您让调用者提供该信息，否则您无法检测到您的函数是如何被调用的。

另外，我记得 Visual C++ 从未实现`std::uncaught_exception`，因此即使已知没有析构函数调用任何`try`块，这也将是不利的（对于可移植代码）。

但是，检测范围是否由于异常而退出是微不足道的。

只需将该范围放在`try`-block 中；这就是它的用途。

例如，

```
class Transaction
{
private:
    bool failed_;
    Transaction( Transaction const& );  // deleted
    Transaction& operator=( Transaction const& ); // deleted

public:
    void fail() { failed_ = true; }

    void commit() { ... }

    // More functionality, then

    ~Transaction()
    {
        if( failed_ ) { rollback(); }
    }

    Transaction(): failed_( false ) {}
};

void foo()
{
    Transaction transaction;

    try
    {
        // blah blah
    }
    catch( ... )
    {
         transaction.fail();
         throw;
    }
} 
```

免责声明：我没有使用过该模式，因此无法证明它的实用性。

# java - 为方法链接配置检查样式？

> ID：14939827
> 
> 赞同：7
> 
> 时间：2013-02-18T15:34:22.850
> 
> 标签：java, maven, checkstyle

我们的项目在方法链流式风格中包含许多语句：

```
 int totalCount = ((Number) em
        .createQuery("select count(up) from UserPermission up where " +
            "up.database.id = :dbId and " +
            "up.user.id <> :currentUserId ")
        .setParameter("dbId", cmd.getDatabaseId())
        .setParameter("currentUserId", currentUser.getId())
        .getSingleResult())
        .intValue(); 
```

我的 checkstyle 主要配置为匹配我们现有的代码样式，但现在它在这些片段上失败了，而是更喜欢：

```
 int totalCount = ((Number) em
        .createQuery("select count(up) from UserPermission up where " +
            "up.database.id = :dbId and " +
            "up.user.id <> :currentUserId ")
            .setParameter("dbId", cmd.getDatabaseId())
                .setParameter("currentUserId", currentUser.getId())
                    .getSingleResult())
                        .intValue(); 
```

这是完全不合适的。无论如何配置 checkstyle 以接受方法链接样式？有没有我可以从 maven 运行的替代工具来强制执行这种缩进？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2015-02-23T20:54:06.470

我从来没有在 Eclipse 中完成这项工作，所以我们几乎不使用 Format Source。最后，通常最好延长。我们很努力，但失败了。那是一年半前的事了。最后，我们仅在 Eclipse 中通过选择行或在手动格式化之前预格式化来使用格式化文本。

通常由工程师完成的格式化具有一定的含义。所以自动格式永远不会起作用。特别是如果你做类似的事情

`public static void myMethod( int value, String value2, String value3)`

如果您自动格式化它，它会与您的示例类似地失败。

因此，在以人为方式格式化之前，请随时加入不使用自动格式化的俱乐部。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2015-02-24T15:05:05.730

使用 intellij ，可以通过在“方法链调用”的情况下选择“多行对齐”来完成，所以我猜这个属性在配置中配置错误。

# javascript - jquery和缓动效果循环和暂停

> ID：14939830
> 
> 赞同：0
> 
> 时间：2013-02-18T15:34:29.537
> 
> 标签：javascript, jquery, jquery-easing

[http://jsfiddle.net/6jxQs/18/](http://jsfiddle.net/6jxQs/18/)

这是我的代码，我想以某种方式将元素一一显示，超时为 700 毫秒。

目前所有元素都同时显示。

我尝试使用 setInterval 和 setTimeout 函数但没有成功。

任何人都可以帮助我或向我指出一些教程如何做到这一点？

代码：

```
<!DOCTYPE html>
<html> 
<head> 
<title>.::Efekat::.</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="css/stil.css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
<script>
$(document).ready(function(){
    $('.mydiv').css('opacity','0');
    $("#demo").click(function(){
        $("div").each(function(index){
            var self = $(this);
            self.not(':animated').css(
                {'opacity': 0.8}
                ).effect(
                    "scale", 
                    {
                        origin:['middle','center'], 
                        from:{width:self.width()+20,height:self.height()+20}, 
                        percent: 100, 
                        direction: 'both', 
                        easing: "linear" 
                    }, 
                    700, 
                    function(){
                        $(this).animate({"opacity": 1}) 
                    });

        });
    });
});
</script>

</head>
<body>
<span id="demo">klikni!</span>
<div class="mydiv">Element 1</div>
<div class="mydiv">Element 2</div>
<div class="mydiv">Element 3</div>
<div class="mydiv">Element 4</div>
<div class="mydiv">Element 5</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:41:54.357

使用 jquery 的[delay()](http://api.jquery.com/delay/)

```
$("div").each(function(index){
            var self = $(this);
            self.not(':animated').css(
                {'opacity': 0.8}
                ).delay(700 * index)
                 .effect(
                    "scale", 
                    {
                        origin:['middle','center'], 
                        from:{width:self.width()+20,height:self.height()+20}, 
                        percent: 100, 
                        direction: 'both', 
                        easing: "linear" 
                    }, 
                    700, 
                    function(){
                        $(this).animate({"opacity": 1}) 
                    });

            }, 100);
        }); 
```

# javascript - 谷歌地图 V3 忽略中心值

> ID：14939841
> 
> 赞同：1
> 
> 时间：2013-02-18T15:35:13.593
> 
> 标签：javascript, jquery, google-maps-api-3

我创建了一个谷歌地图，上面有一些标记。但是其中一个标记与其他标记不同，我希望这个标记位于地图的中心。当我正在构建地图时，我将它的中心设置为与该标记相同的位置，但是它似乎被忽略了。这是我的代码：

```
var map; // Global declaration of the map
        var iw = new google.maps.InfoWindow(); // Global declaration of the infowindow
        var lat_longs = new Array();
        var markers = new Array();
        var markerCluster;
        function initialize() {

            centerlat = '53.1957381200000';
            centerlong = '-2.8940324870000';

            if(centerlat=='FALSE' && centerlong=='FALSE') {
                var myLatlng = new google.maps.LatLng(51.4734,-0.137329);
            } else {
                var myLatlng = new google.maps.LatLng(53.1957381200000,-2.8940324870000);
            }
            var myOptions = {
                //zoom: 13,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            var myLatlng = new google.maps.LatLng(52.6274684, -1.1290035);

            var markerOptions = {
                map: map,
                position: myLatlng,
                title: "Head Office"        
            };
            marker_0 = createMarker(markerOptions);

            marker_0.set("content", '<h4>Head Office</h4><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque quis urna nibh, sed venenatis felis. In hac habitasse platea dictumst. Sed suscipit lobortis luctus. Quisque vestibulum facilisis risus, in suscipit nisl hendrerit et.</p><p><a href="#contact_form" class="btn btn-primary contact-office" data-office_id="13">Contact This Office</a></p>');

            google.maps.event.addListener(marker_0, "click", function(event) {
                iw.setContent(this.get("content"));
                iw.open(map, this);

            });

            var myLatlng = new google.maps.LatLng(51.489827, -0.196938);

            var markerOptions = {
                map: map,
                position: myLatlng,
                title: "London"     
            };
            marker_1 = createMarker(markerOptions);

            marker_1.set("content", '<h4>London</h4><p>Our London office is based at the Earls Court Exhibition centre. Our central location allows us to offer our award winning services to all venues across the capital.</p><p><a href="#contact_form" class="btn btn-primary contact-office" data-office_id="12">Contact This Office</a></p>');

            google.maps.event.addListener(marker_1, "click", function(event) {
                iw.setContent(this.get("content"));
                iw.open(map, this);

            });

        /* IF the user has performed a search then add a marker showing the center of the search */
        if(centerlat!=='FALSE' && centerlong!=='FALSE') 
        {
            var myLatlng = new google.maps.LatLng(centerlat, centerlong);

            var markerOptions = {
                map: map,
                position: myLatlng,
                title: "Your Location",
                icon : "http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png"
            };
            marker_you = createMarker(markerOptions);

            marker_you.set("content", '<h4>Your Location</h4><p>This is the approximate location of your search</p>');

            google.maps.event.addListener(marker_you, "click", function(event) {
                iw.setContent(this.get("content"));
                iw.open(map, this);

            });
        }

        var clusterOptions = {
            gridSize: 60,
            minimumClusterSize: 5
        };
        markerCluster = new MarkerClusterer(map, markers, clusterOptions);

        fitMapToBounds();

        }

    function createMarker(markerOptions) {
        var marker = new google.maps.Marker(markerOptions);
        markers.push(marker);
        lat_longs.push(marker.getPosition());
        return marker;
    }

    function fitMapToBounds() {
        var bounds = new google.maps.LatLngBounds();
        if (lat_longs.length>0) {
            for (var i=0; i<lat_longs.length; i++) {bounds.extend(lat_longs[i]);}
            map.fitBounds(bounds);
        }
    }

    window.onload = initialize; 
```

# visual-studio-2012 - Team Foundation 2012 我的工作报告

> ID：14939849
> 
> 赞同：0
> 
> 时间：2013-02-18T15:35:32.490
> 
> 标签：visual-studio-2012

在我的一生中，我找不到任何关于如何在 2012 年新的“我的工作”功能中查看工作项的文档。我希望这最终会出现在 SSRS 报告中。

我在仓库里到处找，还有 sql db。我也查找了文档，但找不到任何文档。我还查看了对象模型，虽然我可以找到其中的痕迹，但还不足以让我知道在哪里可以找到它。

我认为这是一个很好的仪表板，可以查看我的开发人员目前正在做什么，关于我可以在哪里查看的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:04:22.803

默认情况下，这适用于您的个人工作项，而不是用于监视所有开发人员的工作项。但是，由于它是基于查询的，您可以根据需要修改查询。单击窗格`Open Query`中任何类别下的 ，`My Work`然后将其修改为适合您的任何套件。

# java - SQLite db 高分表未正确插入和排序 - Android

> ID：14939856
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:13.737
> 
> 标签：java, android, sqlite, sorting, insert

我的数据库保留前 10 条记录。db为空时，db记录分数，一路正确插入，直到有10条记录。然后，例如，当 db 有 10 个分数，并且用户得到一个应该是新的 #1 分数的分数时，它只是用新的分数替换当前的 #1 分数，而不是插入并将其下方的所有内容向下颠倒一个并且删除最低分数。希望我解释得很好，但如果不只是评论，我会尝试进一步澄清。

我的问题是我怎样才能让高分正确执行，因为当高分已经满了 10 条记录时，一条新记录被插入到正确的位置，而它下面的其余部分全部向下移动，最后一条记录得到完全撞倒了（因为它是新的#11）。

**数据库助手.java**

```
public class DatabaseHelper extends SQLiteOpenHelper { 

    SQLiteDatabase db;

    private static final int DATABASE_VERSION = 6; 
    private static final String DB_NAME = "test3"; 
    private static final String DB_PATH = "/data/data/matt.lyons.bibletrivia/databases/";
    private static final String TABLE = "HighscoresList"; 

    // Table columns names. 
    private static final String RANK = "_id"; 
    private static final String SCORE = "score"; 
    private static final String PERCENTAGE = "percentage";
    private static final String TOTAL_SCORE = "total_score";
    private static final String CATEGORY = "category";

    //Constructor for a DatabaseHelper.
    public DatabaseHelper(Context context) { 
        super(context, DB_NAME, null, DATABASE_VERSION); 
    }

    //Open the DB so it is editable.
    public SQLiteDatabase openDB() {
        db = this.getWritableDatabase();
        return db;
    }

    //Delete a selected one row.
    public void delete(long lowScore) {
        lowScore = getLowest();
        db.delete(TABLE, TOTAL_SCORE + "=" + lowScore, null);
    }

    //Sort rows in order of the TOTAL_SCORE column.
    public long getLowest() {
        Cursor c = db.rawQuery("SELECT * FROM " + TABLE + " ORDER BY " + TOTAL_SCORE, null);
        long count = c.getCount();
        long lowScore = -1;
        if(count == 10) {
            c.moveToLast();
            lowScore = c.getInt(c.getColumnIndex(TOTAL_SCORE));
        }
        return lowScore;
    }

    //Calculate the TOTAL_SCORE based on the SCORE and PERCENTAGE of a game.
    public long calculateTotalScore(long score, int percentage) {
        long i;
        return i = (percentage * 1000) + score;
    }

    //Check if new record makes the top 10.
    public long check(long score, int percentage, long sum) {
        Cursor c = db.rawQuery("SELECT " + TOTAL_SCORE + " FROM " + TABLE, null);
        long count = c.getCount();
        long low_score;
        if(count == 10) {
            c.moveToLast();
            low_score = c.getInt(c.getColumnIndex(TOTAL_SCORE));
            return low_score;
        } else {
            return count;
        }
    }

    //Insert new record.
    public long insert(long score, int percentage, long total_score, String category) {
        ContentValues values = new ContentValues();
        values.put(SCORE, score);
        values.put(PERCENTAGE, percentage);
        values.put(TOTAL_SCORE, total_score);
        values.put(CATEGORY, category);

        return db.insert(TABLE, null, values);
    }

    //Create the table and all columns.
    public void onCreate(SQLiteDatabase db) {
        db.execSQL("CREATE TABLE " + TABLE + " ("
                + RANK + " INTEGER PRIMARY KEY AUTOINCREMENT,"
                + SCORE + " LONG,"
                + PERCENTAGE + " INTEGER,"
                + CATEGORY + " STRING,"
                + TOTAL_SCORE + " LONG"
                + ");");
    }
} 
```

**结果.java**

```
public class Results extends Activity {

    DatabaseHelper dh;

    public void onCreate(Bundle savedInstanceState) {

        dh = new DatabaseHelper(this);
        dh.openDB();
        showResults();
    }

    public void showResults() {

        total_score = dh.calculateTotalScore(score, percentage);
        if(dh.getLowest() == -1) {
            dh.insert(score, percentage, total_score, category);
        } else {
            dh.delete(dh.getLowest());
            dh.insert(score, percentage, total_score, category);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:48:53.913

为什么不只是：

```
"SELECT LIMIT 10 * FROM " + TABLE + " ORDER BY TOTAL_SCORE DESC" 
```

这样你就可以得到前十名而不必一直插入/删除？

# php - 如何在 PHP 中的元素内回显所有 XML？

> ID：14939857
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:15.113
> 
> 标签：php, html, xml

我有一段看起来像这样的 XML：

```
<root>
<element>Normal,<b>Bold</b></element>
</root> 
```

如何使用 PHP 来回`<element>`显其中的所有内容，以便输出为“ `Normal,<b>Bold</b>`”？

编辑：这是我的代码：

```
<?php
$xml = simplexml_load_file('xml_file.xml');
$element = $xml->element;
echo $element[1];
?> 
```

我只是得到“正常”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:45:20.797

```
$xml = '<root>
<element>Normal,<b>Bold</b></element>
</root>';

$sxe = new SimpleXMLElement($xml);
echo strip_tags($sxe->element->asXML()); 
```

匹配元素时必须剥离标签。

# javascript - 输入类上的Javascript按键

> ID：14939861
> 
> 赞同：-1
> 
> 时间：2013-02-18T15:36:20.347
> 
> 标签：javascript

我正在尝试使用 javascript 在我的页面上的输入上按下一个键。

需要作为一行代码，例如：

```
javascript:oninputmyInput.pressKeynum1(); 
```

可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:48:02.493

根据我发布的评论，这甚至`jquery`没有被标记

```
// dummy event listener
$("input").keydown(function() { return true; });

var keyEvent = jQuery.Event("keydown");
keyEvent.keyCode = 13;
$("input").trigger(keyEvent); 
```

有了这个你手动触发`keydown`事件，这是`enter`事件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:50:40.863

[参考答案](https://stackoverflow.com/questions/596481/simulate-javascript-key-events)

如果您可以使用 jQuery [Workig JsFiddle](http://jsfiddle.net/6Djsb/)：

```
 // jQuery plugin. Called on a jQuery object, not directly.
jQuery.fn.simulateKeyPress = function(character) {
  // Internally calls jQuery.event.trigger
  // with arguments (Event, data, elem). That last arguments is very important!
  jQuery(this).trigger({ type: 'keypress', which: character.charCodeAt(0) });
};

jQuery(document).ready( function($) {
  // Bind event handler
  $( 'body' ).keypress( function(e) {
    alert( String.fromCharCode( e.which ) );
    console.log(e);
  });
  // Simulate the key press
  $( 'body' ).simulateKeyPress('x');
}); 
```

适用于 webkit 和 gecko 的非 jquery 版本：

```
var keyboardEvent = document.createEvent("KeyboardEvent");
var initMethod = typeof keyboardEvent.initKeyboardEvent !== 'undefined' ? "initKeyboardEvent" : "initKeyEvent";

keyboardEvent[initMethod](
                   "keydown", // event type : keydown, keyup, keypress
                    true, // bubbles
                    true, // cancelable
                    window, // viewArg: should be window
                    false, // ctrlKeyArg
                    false, // altKeyArg
                    false, // shiftKeyArg
                    false, // metaKeyArg
                    40, // keyCodeArg : unsigned long the virtual key code, else 0
                    0 // charCodeArgs : unsigned long the Unicode character associated with the depressed key, else 0
);
document.dispatchEvent(keyboardEvent); 
```

# nhibernate - 使用 NHibernate 从数据库视图加载数据

> ID：14939863
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:23.910
> 
> 标签：nhibernate, fluent-nhibernate

我正在使用 NHibernate 并希望将数据库视图中的单个字段加载到我的模型中。情况如下：

我有一个 USERS 表，其中有一列名为 AVATAR_ID。在名为 VIEW_RESOURCES 的数据库中还定义了一个单独的视图。此视图包含一个 ID 和一个 PATH 列。ID 可以与存储在 AVATAR_ID 列中的值匹配。

在 SQL 中，我将执行以下操作：

```
select U.ID, U.USERNAME, R.PATH
from USERS U
left join VIEW_RESOURCES R on R.ID = U.AVATAR_ID
where U.ID = ... 
```

我在 C# 代码中定义了模型的属性，如下所示：

```
public virtual Id { get; protected set; }
public virtual string UserName { get; set; }
public virtual string AvatarPath { get; protected set; } 
```

我正在使用 FluentNHibernate 进行映射，如下所示：

```
Table("USERS");
Id(x => x.Id).GeneratedBy.Identity().Column("ID");
Map(x => x.UserName).Column("USERNAME").Not.Nullable().Length(256); 
```

用于加载单个用户的代码如下所示：

```
User user = session
.QueryOver<User>()
.Where(x => x.Id == id)
.SingleOrDefault(); 
```

到目前为止一切顺利，但我需要知道的是：

*   如何定义 AvatarPath 的映射？
*   如何将 VIEW_RESOURCES 视图的 PATH 列加载到我的用户对象的 AvatarPath 属性中？我宁愿不将它作为与用户有关系的单独模型加载。如果可能的话，我希望它作为用户的属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T19:12:32.347

您可以将其映射为公式

```
Map(x => x.AvatarPath).Formula("(SELECT R.PATH FROM VIEW_RESOURCES R WHERE R.ID = AVATAR_ID)"); 
```

除此之外，您可以将模型和引用设为私有，这样它就不会出现在外面

# excel - VBA：为所有系统日期格式设置excel日期格式

> ID：14939867
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:29.753
> 
> 标签：excel, vba

在应该支持所有类型的系统日期格式的excel中使用哪种日期格式比较好？？？

问题：如果系统日期格式是“dd.mmm.yyyy”，它会`s not working when I put my date value format as 'dd-mmm-yyyy' -> it`显示为“14.02.2013”​​而不是“14.Feb.2013”​​。

请建议我一种支持所有系统类型日期格式（英语、德语、西班牙语、墨西哥语）的日期格式。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:53:21.567

ISO8601 格式 - yyyy-mm-dd - 示例 2013-02-14

# api - 根据管理面板中选择的类别获取 joomla 文章

> ID：14939871
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:38.947
> 
> 标签：api, content-management-system, joomla2.5

一旦在管理面板中选择了所需的类别，我试图了解幻灯片模块如何从 joomla 获取内容。此类模块从网站所有者在网站管理面板中选择的类别中获取文章的标题、全文、图像、链接等。

因此，一旦模块具有从中获取文章的类别，

1.  什么 api 用于从类别中获取文章 ID？
2.  获取文章 ID 后，使用什么 api 来获取每篇文章的内容？
3.  或者是否有一个 API 可以通过传递类别来获取文章的所有必需元素？

我正在使用 Joomla 2.5.9

我试图了解是否可以通过查看现有代码并进行自己的修改来覆盖此“根据类别获取文章”功能。甚至为了我的目的破解 joomla 核心。所有这些都是为了为我想到的功能调整创建一个插件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T03:11:17.703

嗨，Joomla 使用 MVC 结构来访问数据。

如果您从所有您需要的信息中选择信息，请设置它想要的“模型状态”。

在默认内容管理器中的 joomla 2.5 中，您会喜欢这样

```
$model = JModelLegacy::getInstance('Articles', 'ContentModel', array('ignore_request' => true));
$model->setState('filter.category_id' 'YOURIDYOUWANTTOFILTERON');
$model->getItems(); 
```

该代码将为您提供一个对象数组，因此您可以像使用 foreach 循环一样循环。有大量的模型状态，

无论如何，您没有理由需要破解核心以获取内容模型中的数据

# c# - 我可以使用 SynchronizationContext 将工作发布或发送到当前正在运行消息泵的线程吗？

> ID：14939872
> 
> 赞同：0
> 
> 时间：2013-02-18T15:36:40.730
> 
> 标签：c#, multithreading

如果我有一个要运行的线程：

```
Application.Run(); 
```

如果我将工作发布或发送到该线程，该工作会在该线程中运行吗？

***编辑以获取更多信息。**

确切的用例如下。如果我从 Forms UI 线程中拉出 SynchronizationContext。如果我使用 SynchronizationContext 对象的 Post() 或 Send() 方法将工作发布或发送到该线程，那么 UI 线程会执行该工作还是有其他一些机制可以执行该工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T18:37:58.360

是的，它确实有效。答案来自：

[http://www.codeproject.com/Articles/31971/Understanding-SynchronizationContext-Part-I](http://www.codeproject.com/Articles/31971/Understanding-SynchronizationContext-Part-I)

# java - 编写神经网络和可视化数据的语言

> ID：14939875
> 
> 赞同：-2
> 
> 时间：2013-02-18T15:36:45.057
> 
> 标签：java, interface, neural-network, pattern-recognition

我希望创建一个人工神经网络，能够识别几天内发生的简单股市模式，然后我希望能够以图形方式显示输出。例如，如果用户输入公司名称然后单击“GO”，则程序将查看过去 10 天内是否有任何模式并输出“发现模式”。

我只是在开始时遇到了一些麻烦。我很擅长用 Java 编程，但我对神经网络完全陌生。我正在考虑将接口/输出部分编写为网页，然后可能用 JavaScript 编写神经网络。

我更喜欢用 Java 编写神经网络，但我不确定如何用 Java 编写图形等。

谁能给我一些关于如何为股市编写模式识别神经网络的指导？如果找到模式，我可以使用价格作为输入，然后只使用布尔值 1 或 0 作为输出吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:47:19.780

我想Java是一个不错的选择！

事实上，您可以使用 JSP 技术来呈现您的网页并使用 javascript 库（例如使用 canva 标记）显示所有图形内容。对于神经网络，您可以使用众所周知的 weka 库，该库可以使用数十种机器学习算法（参见[此处](http://www.cs.waikato.ac.nz/ml/weka/)）。

# ios - Collectionview contentSize 错误

> ID：14939879
> 
> 赞同：2
> 
> 时间：2013-02-18T15:37:14.713
> 
> 标签：ios, cocoa-touch, uicollectionview

我目前正在使用`UICollectionView`. 我需要知道我正在做的 contentSize 的高度

```
self.collectionView.collectionViewLayout.collectionViewContentSize.height 
```

现在这是可行的，但返回的值对于纵向模式总是不正确的。我应该怎么做才能达到我的需要？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:02:26.660

只需在 viewDidAppear 和 didRotateFromInterfaceOrientation 中获取 self.colletonView.contentSize

```
- (void)viewDidAppear:(BOOL)animated{
     NSLog(@"%0.0f-%0.0f",self.collectionView.contentSize.width,self.collectionView.contentSize.height);
}

-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation{
    NSLog(@"%0.0f-%0.0f",self.collectionView.contentSize.width,self.collectionView.contentSize.height);
} 
```

# php - 将变量添加到 wordpress 存档小部件中的链接

> ID：14939880
> 
> 赞同：1
> 
> 时间：2013-02-18T15:37:17.527
> 
> 标签：php, wordpress, widget, str-replace

我的默认 wordpress 档案小部件有问题。我想为它输出的每个链接添加一个变量。但由于某种原因，它似乎没有将变量添加到链接或任何普通文本中。

这就是我到目前为止所得到的（我正在我自己的主题中重新设计小部件，因此无需编辑 wp 核心文件。）：

```
$archive = wp_get_archives(apply_filters('widget_archive_args', array('type' => 'monthly', 'show_post_count' => $c, 'echo' => 0)));
$archive = explode( '</li>' , $archive );
foreach( $archive as $link ) {
    $catid='?catid='.$category.'/"';
    $link = str_replace('/"',$catid, $link);
    echo $link;
} 
```

但这仍然像没有 str_replace 的情况一样正常输出链接。当我查看我的页面源时，我仍然得到这个：

```
<a title="bla" href="http://www.mysite.com/2013/02/">February 2013</a> 
```

代替

```
<a title="bla" href="http://www.mysite.com/2013/02/?catid=24">February 2013</a> 
```

那么有人可以告诉我我做错了什么吗？谢谢！

这是完整的课程：

```
<?php class WP_widget_archive_by_category extends WP_Widget {

function __construct() {
    $widget_ops = array('classname' => 'widget_archive_by_category', 'description' => __( 'A monthly archive of your site&#8217;s posts from selected category') );
    parent::__construct('Archives-By-Category', __('Archives By Category'), $widget_ops);
}

function widget( $args, $instance ) {
    extract($args);
    $c = ! empty( $instance['count'] ) ? '1' : '0';
    $d = ! empty( $instance['dropdown'] ) ? '1' : '0';
    $title = apply_filters('widget_title', empty($instance['title']) ? __('Archives By Category') : $instance['title'], $instance, $this->id_base);
    if( ! $category = $instance["cat"] )  $category='';

    echo $before_widget;
    if ( $title )
        echo $before_title . $title . $after_title;

    if ( $d ) { ?>
<select name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'> <option value=""><?php echo esc_attr(__('Select Month')); ?></option> <?php wp_get_archives(apply_filters('widget_archive_dropdown_args', array('type' => 'monthly', 'format' => 'option', 'show_post_count' => $c))); ?> </select>
<?php //'cat' => $category
    } else { ?>
    <ul>
    <?php // 'cat' => $category,
    $archive = wp_get_archives(apply_filters('widget_archive_args', array('type' => 'monthly', 'show_post_count' => $c, 'echo' => 0)));
$archive = explode( '</li>' , $archive );
foreach( $archive as $link ) {
$catid='?catid='.$category.'/"';
$link = str_replace('/"',$catid, $link);
echo $link;

}
?>

    </ul>
<?php
    }

    echo $after_widget;
}

function update( $new_instance, $old_instance ) {
    $instance = $old_instance;
    $new_instance = wp_parse_args( (array) $new_instance, array( 'title' => '', 'count' => 0, 'dropdown' => '') );
    $instance['title'] = strip_tags($new_instance['title']);
    $instance['count'] = $new_instance['count'] ? 1 : 0;
    $instance['dropdown'] = $new_instance['dropdown'] ? 1 : 0;
    $instance['cat'] = (int) $new_instance['cat'];

    return $instance;
}

function form( $instance ) {
    $instance = wp_parse_args( (array) $instance, array( 'title' => '', 'count' => 0, 'dropdown' => '') );
    $title = strip_tags($instance['title']);
    $count = $instance['count'] ? 'checked="checked"' : '';
    $dropdown = $instance['dropdown'] ? 'checked="checked"' : '';
    $category  = isset( $instance['cat'] ) ? absint( $instance['cat'] ) : 1;
?>
    <p><label for="<?php echo $this->get_field_id('title'); ?>"><?php _e('Title:'); ?></label> <input class="widefat" id="<?php echo $this->get_field_id('title'); ?>" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo esc_attr($title); ?>" /></p>
    <p>
        <input class="checkbox" type="checkbox" <?php echo $dropdown; ?> id="<?php echo $this->get_field_id('dropdown'); ?>" name="<?php echo $this->get_field_name('dropdown'); ?>" /> <label for="<?php echo $this->get_field_id('dropdown'); ?>"><?php _e('Display as dropdown'); ?></label>
        <br/>
        <input class="checkbox" type="checkbox" <?php echo $count; ?> id="<?php echo $this->get_field_id('count'); ?>" name="<?php echo $this->get_field_name('count'); ?>" /> <label for="<?php echo $this->get_field_id('count'); ?>"><?php _e('Show post counts'); ?></label>
    </p>
<p>
<label>
<?php _e( 'Category' ); ?>
:
<?php wp_dropdown_categories( array( 'name' => $this->get_field_name('cat'), 'selected' => $instance['cat'], 'show_option_all' => 'All Categories', 'hide_empty' => '0') ); ?>
</label>
</p>
<?php }} ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:17:28.897

Possible solution using the filter [**`get_archives_link`**](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/general-template.php#L825):

```
add_filter( 'get_archives_link', 'add_parameter_to_archive_link_so_14939880' );

function add_parameter_to_archive_link_so_14939880( $html )
{
    $dom = new DOMDocument();
    $dom->loadHTML($html);

    foreach ($dom->getElementsByTagName('a') as $item) 
    {
        $href = $item->getAttribute( 'href' );
        $item->setAttribute( 'href', $href.'?CUSTOM_PARAM' ); // <-- Adjust here
        $return = str_replace( 
            array( '<html>', '</html>', '<body>', '</body>' ), 
            array( '', '', '', '' ),
            $dom->saveHTML()
        );
        return $return;
    }
    return $html;
} 
```

# django - git push heroku master：Heroku push 被拒绝，没有检测到 Cedar 支持的应用程序

> ID：14939881
> 
> 赞同：17
> 
> 时间：2013-02-18T15:37:25.730
> 
> 标签：django, heroku, github

我尝试运行：

```
$ git push heroku master    
-----

Total 7121 (delta 2300), reused 6879 (delta 2228)
 !     Heroku push rejected, no Cedar-supported app detected

To git@heroku.com:fierce-atoll-4127.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:fierce-atoll-4127.git' 
```

我发现的唯一可能的答案表明，如果您的应用名称中有下划线，则可能会导致此问题。我有一个“-”并删除了它，但我仍然无法完成这项工作。

以下是我的 requirements.txt，它位于我的 src 文件夹下，旁边是 settings.py 和 manage.py。

```
Django==1.4.3
South==0.7.6
distribute==0.6.31
ipython==0.13.1
wsgiref==0.1.2
dj-database-url==0.2.0 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-06-21T13:35:10.763

刚刚也有这个问题。我做了以下解决它：（假设你在项目目录中）

```
rm -rf .git
git init 
git add .
git commit -m "First commit"
heroku create --stack cedar
git push heroku master 
```

创建一个新应用程序的一个稍微复杂的解决方案，但至少它可以工作。希望有帮助！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-18T15:40:12.010

您可能需要添加一个`requirements.txt`文件。检查 python 应用程序文档

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-12-04T21:43:43.087

我有一个类似的问题，在我的情况下是因为我的应用程序不在我的项目文件夹中。Heroku 期望有这样的结构：

```
Procfile
requirements.txt
static/
myproject/
  manage.py
  app1/
  app2/
  .. 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-24T15:04:04.353

```
rm -rf .git
git init 
git add .
git commit -m "First commit"
heroku create --stack cedar
git push heroku master 
```

这对我也有用！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-18T17:16:56.933

我的愚蠢错误是拼写`requirements.txt`错误`requirments.txt`。我不需要`setup.py`。

此外，我需要将 git 存储库实际存储在 Github 中。仅在本地创建它是不够的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-28T16:01:02.353

对于每个人都删除他们的 Git 历史以使其工作......唯一有效的原因是因为新存储库中的初始提交包含 Heroku 识别您的应用程序所需的文件。

我遇到了这个问题，因为我为我的应用程序添加了`Procfile`and`requirements.txt`并在实际提交之前尝试推送到 Heroku。所以当我推送到 Heroku 时，我并没有推送那些文件！

使用所有必要的文件进行提交*然后*推送应该可以解决这个问题，并且比删除整个 Git 历史记录要好得多。

希望这可以帮助！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-18T19:28:20.547

由于 Django 是一个 python 应用程序，因此您需要拥有`requirements.txt`并`setup.py`位于 repo 的根目录中，而不是 src 子目录。请参阅[https://github.com/heroku/heroku-buildpack-python/blob/master/bin/detect](https://github.com/heroku/heroku-buildpack-python/blob/master/bin/detect)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-08T19:46:01.933

我在这个问题上挣扎了很长时间，唯一的解决方案是[Vincent van Leeuwen 的](https://stackoverflow.com/a/17236643/5764461)，但我不明白为什么。问题原来是我在 master 以外的本地分支工作。所以当我跑步的时候

```
git push heroku master 
```

我实际上是在推动

```
(local) master->(heroku) master 
```

并不是

```
(local) current_branch -> (heroku) master 
```

如我所愿。这失败了，因为我的本地 master 分支没有 requirements.txt、Procfile 等。

解决方案是：

```
git push heroku current_branch:master 
```

有关更多信息，请参阅[heroku 文档](https://devcenter.heroku.com/articles/multiple-environments)。

希望这可以帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-16T09:09:55.620

Heroku 需要一个 requirements.txt 文件，它可以帮助 Heroku 了解需要为您的 Django 项目安装哪些依赖项。您可以使用工具生成您的 requirements.txt 文件。

在命令行中运行

`pip freeze > requirements.txt`

这将创建一个包含所有已安装包的 requirements.txt 文件，例如 Django、django-registration 等...

此链接可能会有所帮助：[http ://tutorial.djangogirls.org/deploy/README.html](http://tutorial.djangogirls.org/deploy/README.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-03-22T19:56:54.343

我的情况是我的代码需要保存在 Github 和 Heroku 上，如果我使用以下解决方案，`rm -rf .git`将删除与我的 Github 的连接，因此我无法将我的代码推送到 Github。

```
rm -rf .git
git init 
git add .
git commit -m "First commit"
heroku create --stack cedar-14
git push heroku master 
```

相反，我的解决方案如下：

```
$ heroku create
$ heroku config:add BUILDPACK_URL=git://github.com/heroku/heroku-buildpack-python.git
$ git push heroku master 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-16T03:33:20.687

上述所有解决方案都没有提到重要的是您的 .git 在哪里初始化。实际上，当您尝试推送 heroku 时，您应该从您初始化 git 本身的目录中执行此操作。此外，您要上传的目录应该是您拥有类似文件的目录

*   requirements.txt、Procfile、virtualenv、manage.py 和 .gitignore

    等等。简而言之，Heroku 需要所有文件来了解您要上传的项目类型，因此这些文件应该可以在根目录中访问。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-11-25T16:01:33.857

您需要将 requirements.txt 文件添加到 git，然后推送它肯定会起作用。

# scala - 自引用泛型

> ID：14939893
> 
> 赞同：5
> 
> 时间：2013-02-18T15:38:09.603
> 
> 标签：scala

我搜索了一下，但找不到这种结构的示例：

```
Person[P <: Person[P]] 
```

这是以我理解的方式解释的。

这是如何解决的？对我来说，这有点像无休止的递归，但似乎我对这个结论有误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T16:02:06.227

该结构本身在[Twitter Scala School](http://twitter.github.com/scala_school/advanced-types.html#fbounded)中进行了解释，称为 F 有界多态性。

```
// you define it like this
trait X extends Person[X]

// it then gets expanded to this
trait Person[X extends Person[X]] 
```

当 trait 需要引用它正在扩展的对象的类型时，使用此结构。如果 Scala 学校的解释还不够，您可以在互联网上搜索“F-bounded polymorphism”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-18T16:11:05.053

这有时被称为*自类型*（不要与 Scala 的显式类型自引用混淆），它通常用于具有足够强大的方法签名，以表示该方法可以与与接收者具有相同类型的对象一起使用.

让我们看一个例子。比如说，你有一个`Animal`带有泛型`breed`方法的基本特征，它接受另一个`Animal`并返回一个`Animal`.

```
trait Animal {
  def breed(a: Animal): Animal
} 
```

好的，但是您真正想要的是一种`breed`方法，该方法表示每个具体的动物只与同一类的动物繁殖，并且还返回同一类的动物。下面的实现

```
class Cow extends Animal {
  def breed(c: Cow) = new Cow
} 
```

不可能，因为 this`breed`的签名不匹配。覆盖也是不可能的，因为您需要协变地更改参数类型，这是被禁止的。

自我类型的救援：

```
trait Animal[A <: Animal[A]] {
  def breed(a: A): A
}

class Cow extends Animal[Cow] {
  def breed(c: Cow) = new Cow
} 
```

正如 EECOLOR 已经指出的那样，其背后的类型论称为*F-bounded polymorphism*。

# java - 如何将多个对象的数据渲染到一个视图

> ID：14939894
> 
> 赞同：0
> 
> 时间：2013-02-18T15:38:10.173
> 
> 标签：java, hibernate, jsp, spring-mvc

我在理解如何在单个视图中呈现数据时遇到了另一个问题。

首先，我有一个控制器，它返回我搜索过的汽车列表。这会渲染到屏幕的右侧。现在我需要一个在屏幕左侧的表单，它允许我用要过滤的数据填充一些组合框，例如：

选择要搜索汽车的州：|--| <--- 这是一个包含所有状态的组合框。

选择要搜索的城市：|--| <-- 我们要搜索的城市列表

上面列出的每个组合框都来自不同的实体。

那么如何填充汽车搜索列表（来自 carSearchListController）以及城市和州的

我听说为一个视图调用多个控制器是不好的做法。

我得到的是这样做的最佳做法是什么？我还没有找到任何关于如何以最佳方式做到这一点的好信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:58:13.620

您添加到模型或会话中的任何内容都将在您的视图中可用。如果它需要在会话的生命周期中存在，请将其添加到会话中。如果它只需要在请求的生命周期内存在，请将其添加到模型中。有很多方法可以做到这一点，无论是使用注释还是模型对象或 ModelAndView ......这一切都取决于你如何在控制器中编码以及你喜欢使用什么。Spring MVC 以这种方式非常灵活。

如果您希望页面更加“动态”，则解决您的问题的另一种方法是在控制器中加载静态数据位，然后使用 AJAX 请求获取更多动态片段。例如，当大多数网站进行搜索自动完成时，他们通常使用 AJAX 调用后端来加载自动完成的文本列表。

# c# - 将 html 表放入数据网格

> ID：14939895
> 
> 赞同：1
> 
> 时间：2013-02-18T15:38:12.250
> 
> 标签：c#, asp.net, .net

我有一个包含值的表的 html 文件源，我想将每个值传输到我构建的数据网格视图中。例子 ：

```
<tr><td>32</td><td>jon</td><td>smith</td></tr> 
```

在我的数据网格视图中我想要：

```
age    firstName    lastName
32     jon          smith 
```

（我已经用列头建立了一个网格）等等......

我怎样才能将每个 td 中的值“钓鱼”到正确的位置？tnx :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:53:06.747

强大的解决方案 - 通过解析。将html文件读入一个字符串，然后逐个字符读入另一个字符串，当你读到时`>`，你应该有一个完整的标签read( `<tr>`,,或) `</tr>`，检查哪个，如果是，则设置X=0,Y++,如果它是，然后是 X++，在读取标签后 - 明文，重复，如果你阅读并且已经读取了一些数据，那么这个数据是一个文本，应该放在数据网格中的 [X,Y] 位置（你可以初始化解析后，只需找到最大 X 即可知道列数）...`<td>``</td>``</tr>``</td>``<`

..我希望将所说的放入C#代码中没有困难=D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:52:48.120

这些值是否已经在某种 DataTable 或 DataSet 中？GridView 本身呈现为表格，所以您是否试图做一些不必要的事情？

好的，我看到您已经修改了问题。有一种叫做 HTML Agility 包的东西可以解析 HTML 并提取值。虽然我自己没有使用它，但如果您的 HTML 表格是有效的 HTML，它可以节省您将表格代码解析为字符串的时间。

[http://htmlagilitypack.codeplex.com/](http://htmlagilitypack.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T16:26:17.430

肮脏的版本。而不是`List<IList>`您可以生成自己的数据源。谨防格式错误的 HTML：

```
class Program {

    static Regex cell = new Regex("<td>(.+?)</td>", RegexOptions.IgnoreCase);
    static string htmlTable = "<tr><td>32</td><td>41</td></tr><tr><td>123123</td><td>123123123</td></tr>";

    static void Main(string[] args) {
        var table = new List<IList<string>>(); //list of lists, kind of data table

        foreach (var rowString in htmlTable.Split(new [] { "</tr>" }, StringSplitOptions.RemoveEmptyEntries)) //split into rows
            table.Add(GetRowValues(rowString)); //get and add row values
    }

    static IList<string> GetRowValues(string rowString) {
        return new List<string>(cell.Matches(rowString).Cast<Match>().Select(m => m.Groups[1].Value)); //extract cells values by regex
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T16:26:42.687

如果你的 HTML*真的*这么简单，行或单元格上*没有属性，内容中也**没有*有趣的字符，那么正则表达式是一个快速而肮脏的解决方案：

```
string html = "<table><tr><td>32</td><td>jon</td><td>smith</td></tr></table>";
string pattern = "<tr>(?:<td>(.*?)</td>)*?</tr>";
foreach (Match m in Regex.Matches(html, pattern, RegexOptions.IgnoreCase))
{
    // Add row
    var row = grid.AddRow();
    foreach (Capture c in m.Groups[1].Captures)
    {
        // Add cell
        var cell = row.AddCell();
        cell.Contents = c.Value;
    }
} 
```

如果您的 HTML 有*可能*不是这么简单，请使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)：

```
string html = "<table><tr><td>32</td><td>jon</td><td>smith</td></tr></table>";
var table = new HtmlDocument();
table.LoadHtml(html);
foreach (var tr in table.DocumentNode.Descendants("tr"))
{
    // Add row
    var row = grid.AddRow();
    foreach (var td in tr.Descendants("td"))
    {
        var cell = row.AddCell();
        cell.Contents = td.InnerText;
    }
} 
```

（我已经猜到你是如何在这里实际添加行和单元格的；希望你能自己解决这个问题。）

# java - 在 glassfish 3.1.2.2 上部署 jersey/helloworld-osgi-webapp 时出错

> ID：14939901
> 
> 赞同：1
> 
> 时间：2013-02-18T15:38:22.800
> 
> 标签：java, jersey, osgi, glassfish-3, apache-felix

尝试在[_](https://github.com/jersey/jersey-1.x/tree/master/jersey/samples/helloworld-osgi-webapp) Glassfish 3.1.2.2，我收到以下 osgi 错误：

```
remote failure: Error occurred during deployment: Exception while loading the app: 
  org.osgi.framework.BundleException: Unresolved constraint in bundle war-bundle [344]:
  Unable to resolve 344.0: missing requirement [344.0] osgi.wiring.package; (&(osgi.wiring.package=com.sun.jersey.api.core)(version>=1.18.0)(!(version>=2.0.0))).
  Please see server.log for more details.
  Command deploy failed 
```

为什么 maven felix 插件没有在战争中嵌入库？
提前感谢，M。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:51:38.723

直接原因是在您的应用程序中它没有被配置为这样做，并且它不是的原因是在 OSGi 世界中它不应该这样做。

从[pom](https://github.com/jersey/jersey-1.x/blob/master/jersey/samples/helloworld-osgi-webapp/war-bundle/pom.xml)它在提供的范围内：

```
<groupId>com.sun.jersey</groupId>
<artifactId>jersey-servlet</artifactId>
<version>${project.version}</version>
<scope>provided</scope>
<classifier>cobertura</classifier> 
```

它只会嵌入运行时和编译范围：

```
<Embed-Dependency>*;scope=compile|runtime</Embed-Dependency> 
```

并使用 OSGi 标准 import-package 将 jersey-servlet 依赖项导入为 OSGi 服务：

```
<Import-Package>com.sun.jersey.api.core,com.sun.jersey.spi.container.servlet,*</Import-Package> 
```

在 OSGi 世界中，依赖项应该部署为单独的 OSGi 包，而不是嵌入到战争中。这就是你的例子正在做的事情。因此，您应该将 jersey 部署为单独的 OSGi 包。

# html - rem 通过媒体查询调整大小在 webkit 中不起作用？

> ID：14939902
> 
> 赞同：3
> 
> 时间：2013-02-18T15:38:25.000
> 
> 标签：html, css

我在我的 CSS 中使用以下代码进行媒体查询：

```
@media all {html { font-size: 62.5%; }  }/* 62.5%: 1em = 10px */
@media all  and (max-width: 1200px) {   html,body { font-size: 50%; }   }
@media all  and (max-width: 1000px) {   html,body { font-size: 45%; }   }
@media all  and (max-width: 800px) {    html,body { font-size: 40%; }   } 
```

但是当字体大小 > 62.5% 使用 webkit 正确调整大小时，大小 <62.5% 仅调整文本大小，而不是元素的宽度、高度、填充等。

例如：

```
.loader {
    width:38rem;
    height:36rem;
    position:relative;
} 
```

只会放大其中的文本，而不是元素的宽度和高度。

这个问题只出现在 webkit 浏览器中，不会出现在 Firefox 中： ![](../Images/0fc31b42dc730a24c93ed1fe6fc24838.png)

经过大量研究，我找不到任何解决这个问题的方法，有什么想法吗？您可以在这里找到现场演示：http: [//partytube.eu01.aws.af.cm/](http://partytube.eu01.aws.af.cm/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T11:51:16.633

我认为您只需更改您的媒体查询

```
@media  (max-width: 800px) {    html,body { font-size: 40%; }   }
@media (min-width:801px) and (max-width: 1000px) {   html,body { font-size: 45%; }   }
@media (min-width: 1001px) and (max-width: 1200px) {   html,body { font-size: 50%; }   } 
```

# heroku - Heroku 不加载图像，尽管它们是预编译的并且 url（在 html 中）是正确的

> ID：14939903
> 
> 赞同：0
> 
> 时间：2013-02-18T15:38:27.597
> 
> 标签：heroku, ruby-on-rails-3.2, asset-pipeline

我在处理图像时遇到问题，我在视图中使用 assets_path 来确定图像的最终路径（员工照片）。然后我让 Heroku 在推送 repo 时预编译所有资产。以前可以，但是现在照片不显示了。

更奇怪的是，在运行应用程序时，html 是正确生成的（如查看页面源代码中所见......照片 src url 可以复制并粘贴到浏览器中，它们会检索正确的资产！）但照片没有显示在页面上.

这是视图。'assets_path' 用于确定预编译后的最终路径：

```
<ol class="employees_list">
  <% employees.each do |employee| %>
  <li>
     <%= link_to employee_path(employee) do %>
       <div data-picture data-alt="Photo of <%= employee.name %>" class="photo">
         <% if employee.photo %>
           <div data-src="<%= asset_path employee.photo %>"></div>
           <div data-src="<%= asset_path employee.photo('small', 2) %>" data-media="(min-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2)"></div>
           <noscript>
             <img src="<%= asset_path employee.photo %>" alt="Photo of <%= employee.name %>">
           </noscript>
         <% end %>
       </div>
     <% end %>
  </li>
 <% end %>
</ol> 
```

奇怪的是，Heroku 输出的 html 看起来像这样（片段 - 一个列表项）：

```
<li>
    <a href="/employees/586">
      <div data-picture data-alt="Photo of Marcy Dakss" class="photo">
        <div data-src="/assets/employees/small/marcy_dakss-84bb6d3482d0af4667d24f8cd7017c7f.jpg"></div>
        <div data-src="/assets/employees/small/marcy_dakss@2x-de98d9acfea2e840aa039854c385007b.jpg" data-media="(min-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2)"></div>
        <noscript>
          <img src="/assets/employees/small/marcy_dakss-84bb6d3482d0af4667d24f8cd7017c7f.jpg" alt="Photo of Marcy Dakss">
        </noscript>
      </div>
    </a>  
</li> 
```

...现在，当您手动将资产 url 复制并粘贴到浏览器标签中时 (/assets/employees/small/marcy_dakss-84bb6d3482d0af4667d24f8cd7017c7f.jpg)，照片就会显示出来！

我觉得我已经尝试了一切，你有解决类似图像问题的经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T18:58:56.650

我对 data-src 属性不熟悉，您是否尝试使用[图片填充](https://github.com/scottjehl/picturefill/)系统？如果是这样，我猜问题出在该系统的某个地方，而不是在 Heroku 的资产编译中。例如，如果您将图像标签移到 noscript 和 div 之外，我猜它会起作用。

# c# - 如何通过 SWIG 公开命名空间 C++ 字符串常量？（C＃）

> ID：14939910
> 
> 赞同：2
> 
> 时间：2013-02-18T15:38:52.043
> 
> 标签：c#, c++, string, swig

有多种方法可以在 C++ 中公开命名空间的编译时常量字符串。

我有一堆这些我想通过 SWIG 在 C++ 和 C# 之间共享，以便我可以在 C++ 中像这样引用它们：

```
Foo::Bar::SomeConstant 
```

在 C# 中就像这样：

```
Foo.Bar.SomeConstant 
```

我真的不在乎 C++ 方面是否是`const char*`or `std::string`，但我确实需要命名空间以避免冲突。

我宁愿把它放在头文件中：

```
namespace Foo
{
    namespace Bar
    {
        const char* const SomeConstant = "hello world";
    }
} 
```

但我似乎无法让 C# 方面使用 SWIG 打球。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T22:04:54.737

我最终通过在命名空间中嵌套结构并为它们提供私有构造函数和公共静态 const std::string 成员（填充在单独的 cpp 文件中）来解决这个问题。

这会在 SWIG 使用仅带有 getter 的静态只读 C# 属性包装的 pinvoke 生成代码中创建 getter，这几乎正是我想要的。

值得注意的是，每次使用 C# 属性时都会创建一个 C# 字符串（而不是在 C#-land 中创建单个静态实例），但这对我的用例来说很好。

# json - MongoDB 原生 HttpClient

> ID：14939912
> 
> 赞同：1
> 
> 时间：2013-02-18T15:38:56.533
> 
> 标签：json, mongodb, rest, httpclient, http-request

我正在寻找一种从我的 REST 服务中获取 HTTP 响应的方法，该服务返回一个 JSON 对象，对其进行评估并将其保存在我的 Mongo 存储过程中。

有人知道怎么做这个吗？我注意到 MongoDB 有一个本机 HttpClient，但它似乎从服务器端 Javasript 中不可见。

# javascript - 如何简化 mongodb 收集？

> ID：14939913
> 
> 赞同：1
> 
> 时间：2013-02-18T15:39:02.030
> 
> 标签：javascript, mongodb, mongoose

我有一个名为的集合`Org`，其中包含`Resources`在团队之间共享的资源（模式）（`Teams`模式）

```
{
   "_id": ObjectId("511cfbc9d593e5290c000005"),
   "name": "Some org name",
   "resources": [
       {
           "_id": ObjectId("511cfbc9d593e5290c000007"),
           "name": "Printer1",
           /* mongoose.Schema.Types.Mixed */
           "details": {
              "ip": "192.168.1.99"
           }
       }, {
           "_id": ObjectId("511cfbc9d593e5290c000008")
           "name": "Fax1",
           "details": {
               "number": "XXXXXXXXXXXX"
           }
       }
   ],
   "teams" : [
       {
            "_id": ObjectId("511cfbc9d593e5290c000012"),
            "name": "sales",
            /*"resources": {type: [mongoose.Schema.Types.ObjectId], ref: 'Resources'}*/
            "resources": [ObjectId("511cfbc9d593e5290c000007")]
       }, {
            "_id": ObjectId("511cfbc9d593e5290c000006"),
            "name": "developer",
            "resources": [ObjectId("511cfbc9d593e5290c000007"), ObjectId("511cfbc9d593e5290c000008")]
       }
   ]      
} 
```

还有一个`People`集合，它是团队的一部分。

```
{
    "name": "Peter",
    "designation": "senior s/w engg.",
    "contact": {}
    /*"teams": {type: [mongoose.Schema.Types.ObjectId], ref: 'Teams'}*/
    "teams": [ObjectId("511cfbc9d593e5290c000006")]
} 
```

现在，如果资源或团队发生更改，我想跳过多次更新，所以我没有使用嵌套文档。我无法`ref` `Resources`从架构中进行`Teams`架构。结果，要获得以下结果，我必须通过非常复杂的聚合函数。

```
{   
    "name": "Peter",
    "designation": "senior s/w engg.",
    "contact": {}
    "teams": [{
                "_id": ObjectId("511cfbc9d593e5290c000006"),
                "name": "developer",
                "resources": [{
                    "_id": ObjectId("511cfbc9d593e5290c000007"),
                    "name": "Printer1",
                    "details": {
                        "ip": "192.168.1.99"
                    }
                 }, {
                    "_id": ObjectId("511cfbc9d593e5290c000008")
                     "name": "Fax1",
                     "details": {
                         "number": "XXXXXXXXXXXX"
                    }
                 }]              
     }]
} 
```

有人可以建议我是否在数据库设计中做错了什么。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T19:43:37.083

> 现在，如果资源或团队发生更改，我想跳过多次更新，所以我没有使用嵌套文档。

您会发现这是 MongoDB 模式设计中要考虑的常见权衡。实际上，这将归结为您跳过多个更新的重要性。通常，多次更新并不像您想象的那么具有挑战性，并且被证明是正确的决定，尤其是在需要读取简单性和性能时。

> 有人可以建议我是否在数据库设计中做错了什么。有没有更简单的方法？

鉴于您声明避免多次更新的意图，我认为您的方法没有问题。不过，就个人而言，在这种情况下，我会采用嵌套文档方法并尝试解决多个更新问题。这意味着查询更简单，性能也更好（这通常是应用程序开发中最重要的考虑因素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T15:54:46.537

在猫鼬中，您可以简单地执行以下操作：

```
People.find({ name: "Peter" }).populate("teams").exec( callback ); 
```

如果这不带来`teams.resources`人口（我怀疑，因为猫鼬非常灵活），试试这个：

```
People.find({ name: "Peter" })
    .populate("teams")
    .populate("teams.resources")
    .exec( callback ); 
```

另外，不要忘记添加架构`ref`的`teams`属性。`People`

# ruby-on-rails - 如何在单独的窗口中打开 :Rpreview？

> ID：14939916
> 
> 赞同：1
> 
> 时间：2013-02-18T15:39:03.530
> 
> 标签：ruby-on-rails, vim, awesome-wm

我正在使用很棒的 WM，每次我使用 :Rpreview （T-Pope rails.vim 插件）时，它都会在另一个选项卡上打开 localhost，我已经打开了我的浏览器（铬）。如何在新窗口的当前选项卡下打开它？

# windows-phone-8 - 与 windows phone 中的“页面”相比，“屏幕”是什么？并将其用作弹出登录屏幕

> ID：14939921
> 
> 赞同：0
> 
> 时间：2013-02-18T15:39:18.197
> 
> 标签：windows-phone-8

我读到屏幕与此处的页面不同：http: [//msdn.microsoft.com/en-us/library/windowsphone/design/hh202911 (v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/design/hh202911(v=vs.105).aspx)

那么屏幕的基本类是什么？如何利用它？实际上我想在文章中实现相同的场景。每当需要身份验证时，我都需要一个弹出屏幕，有什么最佳做法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T16:39:17.037

实际上，Windows Phone 中并没有 Screen 之类的东西。您提到的文章提到了一个关于某些 UI 结构的屏幕，例如 UserControl，它可以嵌入到页面中。

至于弹幕，你应该使用文章中提到的[Popup类，并在必要时显示或隐藏它。](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.controls.primitives.popup%28v=vs.105%29.aspx)或者，您仍然可以创建一个单独的页面（例如 PhoneApplicationPage 实例）并在需要登录操作时导航到该页面。

您采用哪种方法（弹出窗口或单独页面）取决于您认为您的应用程序在不同情况下的行为方式。例如，如果您的应用程序通常无需登录，那么我想您可以将登录视图实现为单独的页面。但是，如果您的应用在没有登录的情况下基本上已经失效，您可以实现弹出窗口并在确定需要登录后立即显示它。

至于最佳实践，如果您要使用 Popup 变体，我建议您创建一个 UserControl，其中包含 Popup。这样您就可以将您的登录代码（视图 + 行为）封装到一个单独的实体中，以便在不同的页面中轻松地重用它。

# iphone - 如何为 onWillEnterForgroundNotification 编写 NSNotification 测试用例

> ID：14939924
> 
> 赞同：1
> 
> 时间：2013-02-18T15:39:28.007
> 
> 标签：iphone, ipad, ocunit

应用程序进入前台时如何编写ocUnit测试用例通知

```
-(void)onWillEnterForgroundNotification:(NSNotification)notification{

[self message:@"Hi" Value:@"G"];

} 
```

@全部

任何人都建议我如何实现上述方法的测试用例。

# .net - ServiceStack 会话 ID 是否足够安全？

> ID：14939926
> 
> 赞同：6
> 
> 时间：2013-02-18T15:39:36.737
> 
> 标签：.net, security, guid, servicestack

据我了解，在使用 ServiceStack 的[身份验证](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)时，您通常会在会话开始时进行身份验证，然后将服务器端的会话标记为已通过身份验证。随后的 Web 服务请求将使用该会话 ID，并且不需要重新验证。（到目前为止，如果我错了，请纠正我）。

新会话 id 的生成是使用[SessionExtensions.cs](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/SessionExtensions.cs#L75)中的 Guid.NewGuid() 执行的，它[不会生成加密的奇妙值](https://stackoverflow.com/a/6267578/8479)。是否有任何理由不切换到使用加密安全值，例如使用[RNGCryptoServiceProvider](https://stackoverflow.com/questions/1228085/function-asp-net-uses-to-generate-session-id)？

更新：

实际上，在进一步考虑之后，ASP.NET 并没有使用它的 Session Id 来确认请求者是经过身份验证的。它使用一个 FormsAuthenticationTicket，它已经用机器密钥加密并散列（[这里是 ASP.NET 2.0 过程的一个很好的描述](http://msdn.microsoft.com/en-us/library/ff647070.aspx)）。

我不是安全专家，所以如果您要比较 ASP.NET Forms Auth 提供的安全级别和随机值提供的安全级别，我不知道这意味着什么。我想这一切都归结为密钥和数据长度......但对表单身份验证进行暴力攻击所需的时间可能要高得多，因为它不需要只尝试一大堆随机数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T22:25:34.870

Right [ServiceStack](http://www.servicestack.net)使用 Authenticating + Set session cookie 的标准 HTTP 方法来为后续请求设置经过身份验证的会话，这是所有 Web 框架的通用方法。

尽管我从未听说过 .NET 中存在能够预测和反向工程 GUID 的漏洞，[但似乎](https://stackoverflow.com/a/6902739/85785)ASP.NET 自己的 SessionId 不如 Guid 强（2^120 对 2^128 位熵）。但鉴于它不是真正随机的，我们将在下一个版本中更改 ServiceStack 的实现以使用真正随机的标识符。

# c# - 找不到角色数据库

> ID：14939928
> 
> 赞同：0
> 
> 时间：2013-02-18T15:39:44.107
> 
> 标签：c#, asp.net

我目前正在开发一个需要登录系统的 ASP.NET 网站。然而，当错误地假设角色数据库的连接字符串与我的 Microsoft SQL 数据库的连接字符串相同时，我意识到我不知道角色数据库在哪里。我通过我的计算机搜索类似于角色数据库的东西（搜索角色和 .mdf），但没有发现任何我可以识别的东西。你知道我在这里犯了什么错误吗？我是否必须专门创建此角色数据库？到目前为止，我的 web.config 代码读取为（没有个人识别顶部的连接字符串）：

```
 <system.web>
    <compilation debug="true" targetFramework="4.5"/>
    <httpRuntime targetFramework="4.5"/>
    <roleManager  enabled="true" defaultProvider="providerForLogin">
      <providers>
        <add name="providerForLogin" type="System.Web.Security.SqlRoleProvider" applicationName="WebSite4" connectionStringName="ConnectionString" />
      </providers>
    </roleManager>
  </system.web>
</configuration> 
```

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T15:44:05.377

如果您指定相同的数据库连接字符串，ASP.Net 成员资格不会创建单独的数据库。

您所做的方式是正确的，它将用户、角色、成员资格表保存在您的表所在的同一数据库中。

仅供参考：如果您的应用程序是新的，请使用[Universal Providers](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)替代旧的 ASP.Net Membership（您当前使用的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:52:37.063

有一个名为`aspnet_regsql.exe`您需要运行的可执行文件才能创建成员模式。按照[本教程](http://www.shiningstar.net/ASPNet_Articles/SqlMembershipProvider.aspx)

但是，就像@Win 所说，这是一个旧的。如果您使用 VS2012 进行开发，请使用[Universal Providers 。](http://dotnet.dzone.com/articles/stronger-password-hashing-net)

# c# - TypeScript 数组的别名

> ID：14939930
> 
> 赞同：1
> 
> 时间：2013-02-18T15:39:48.117
> 
> 标签：c#, javascript, typescript

我想将`C#`下面的代码翻译成`TypeScript`：

```
[JsType(JsMode.Json)]
public class position : JsArray<JsNumber>
{
}

[JsType(JsMode.Json)]
public class coordinateArray : JsArray<position>
{
}

[JsType(JsMode.Json)]
public class polygonRings : JsArray<coordinateArray>
{
} 
```

我试着这样做：

```
export interface position {
    (): number[];
}

export interface coordinateArray {
    (): position[];
}

export interface polygonRings {
    (): coordinateArray[];
} 
```

但是当我尝试投射它时，我遇到了一些问题：

> 无法将“坐标数组”转换为“位置 []”。

在代码中：

```
(<position[]> lineString.coordinates).push(position); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:35:40.457

```
export interface coordinateArray {
    (): position[];
} 
```

您所描述的不是数组，而是一种函数类型，在调用时会返回一个数组：

```
var x: coordinateArray = ...;
var y = x(); // y: position[] 
```

您可能想要定义一个索引签名：

```
export interface coordinateArray {
    [index: number]: position;
} 
```

This won't convert directly to a `position[]` because it's still not actually an array (a real `position[]` would have methods like `splice` and `push`, but `coordinateArray` doesn't), but is at least correct about what the shape of the type is.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T16:03:27.643

在 的实例上调用构造函数方法`coordinateArray`将返回 type `position[]`，但将接口用作类型不会给您提供与`position[]`.

如果您有其他工作的代码，除了编译器警告之外，您可以使用以下方法告诉编译器您更了解：

```
(<position[]><any> ca) 
```

# image - 在 IrfanView 中设置透明图像背景

> ID：14939935
> 
> 赞同：120
> 
> 时间：2013-02-18T15:40:07.113
> 
> 标签：image, transparency, alpha, irfanview

我有一些由黑色形状和透明背景组成的 PNG 图像。不幸的是，IrfanView 将透明背景显示为黑色，所以我只看到黑底黑字。我在 Irfan 设置中发现可以更改窗口的背景颜色，但它仅在图像周围更改，透明颜色仍然是黑色。

有什么方法可以将显示的颜色更改为透明，或者最好使用 Photoshop 之类的白灰色方块？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2013-06-06T15:32:30.040

你走在正确的轨道上。IrfanView 将透明度的背景设置为与图像周围的查看颜色相同。

您只需将视图颜色更改为白色后，使用 IrfanView 重新打开图像。

要更改 Irfanview 中的查看颜色，请访问：

```
Options > Properties/Settings > Viewing > Main window color 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-19T21:12:55.207

如果您使用的是批量转换，在窗口中点击“批量转换设置-输出格式”中的“选项”，勾选“保存透明色”两个框（一个在“PNG”下，另一个在“ICO”下）。

# android - Android 可以自动选择最佳位置提供商吗？

> ID：14939940
> 
> 赞同：0
> 
> 时间：2013-02-18T15:40:15.707
> 
> 标签：android

有没有一个选项，我们可以让 Android Pick the best Provider。在 iOS 中，有一个叫做 best 或 bestForNavigation Option 的东西。

我知道我们可以在请求位置更新之前指定一个标准并选择提供商，如下所示：

```
LocationManager locationManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
Criteria criteria = new Criteria(); criteria.setAccuracy(Criteria.ACCURACY_FINE);
criteria.setCostAllowed(false);
String providerName = locManager.getBestProvider(criteria, true); 
```

但除了设置标准之外，Android OS 是否有自动选择最佳提供商的方法。基本上，我试图在 Android 中找到一个类似于 Apple IOS 上可用的选项（如 best 或 bestForNavigation）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:42:07.710

使用空`Criteria`对象 ( `new Criteria()`)。默认情况下，它是为最广泛的合规位置提供商设置的。

# node.js - 节点 js curl 与 http.request

> ID：14939941
> 
> 赞同：3
> 
> 时间：2013-02-18T15:40:17.333
> 
> 标签：node.js, http, curl, request

我需要向另一台服务器发送一个 http 请求。我可以通过两种方式做到这一点：1）使用 http.request() 2）使用 child_process.exec

```
// ... define timeout, data, url
var __exec = require('child_process').exec;
exec('curl --max-time ' + timeout + ' -d \'' + data + '\' '  + url, function (error, stdout, stderr) {}); 
```

在第一种情况下，最短执行时间为 0.08 秒。在第二种情况下 - 0.04 秒

如果我使用第二个选项，会出现哪些问题？特别是在服务器负载高的情况下。

谢谢。

基准1：

```
//...
timeStart = +new Date().getTime();
request = http.request(options, function (result) {
    //...
    result.on('end', function () {
         timeEnd = (+new Date().getTime() - timeStart) / 1000;
         // log timeEnd
    });
});
request.on('error', function (error) {
    timeEnd = (+new Date().getTime() - timeStart) / 1000;
    // log timeEnd
});
request.end(); 
```

基准2：

```
// ...
timeStart = +new Date().getTime();
exec('curl --max-time ' + timeout + ' -d \'' + data + '\' ' + url, function (error, stdout, stderr) {
     timeEnd = (+new Date().getTime() - timeStart) / 1000;
     // log timeEnd
 }); 
```

# vb.net - 使用 vb.net 从其他表单获取标签的值

> ID：14939942
> 
> 赞同：2
> 
> 时间：2013-02-18T15:40:24.070
> 
> 标签：vb.net

它不起作用，标签只会恢复为默认值。你认为是什么问题？

好的，这是我的代码：

实际上我在这里使用mysql作为我的数据库

这是生成标签值的形式：

```
Private Sub ProfileControl_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Try
        Dim conn As New MySqlConnection(ServerString)
        Dim dap As New MySqlDataAdapter("select * from employee where LogInID = '" & Main.ID.Text & "'", conn)
        Dim dt As New DataTable
        dap.Fill(dt)

        employeenum = dt.Rows(0).Item("EmployeeID")
        position = dt.Rows(0).Item("Position")
        employeename = dt.Rows(0).Item("FirstName") + " " + dt.Rows(0).Item("LastName")

        lblemployeename.Text = employeename
        lblemployeenum.Text = employeenum
        EmpPosition.Text = position

    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
End Sub 
```

这是将检索 3 个标签的值的表单。

```
Private Sub addsavebutton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles addsavebutton.Click
    Dim profile As New ProfileControl

    If txtbranchname.Text <> "" Then
        If addsavebutton.Text = "ADD" Then

            Dim zero As Integer = 0
            Dim SQLStatement As String = "INSERT INTO branch(BranchName,Centers)VALUES('" & txtbranchname.Text & "','0') "
            SaveCenter(SQLStatement)
            logdate = Convert.ToDateTime(Date.Now).ToString("yyyy-MM-dd hh:mm:ss")
            logdate2 = Format(Date.Now, "yyyy-MM-dd")
            status = "Added Branch " + txtbranchname.Text
            SQLStatement = "INSERT INTO log(EmployeeID,Name,EmployeePosition,Date,DateTime,Status)VALUES('" & profile.lblemployeenum.Text & "','" & profile.lblemployeename.Text & "','" & profile.EmpPosition.Text & "','" & logdate2 & "','" & logdate & "','" & status & "' )"
            Savelog(SQLStatement)
            txtbranchname.Clear()
        ElseIf addsavebutton.Text = "SAVE" Then
            Dim Query As String

            Dim con As MySqlConnection = New MySqlConnection(ServerString)
            con.Open()

            Query = "UPDATE branch SET  BranchName = '" & txtbranchname.Text & "' WHERE BranchCode = '" & txtbranchcode.Text & "'"

            Dim cmd As MySqlCommand = New MySqlCommand(Query, con)
            Dim i As Integer = cmd.ExecuteNonQuery()
            If (i > 0) Then

                'success
                Dim Successtext As New MsgSuccess
                Successtext.PassedText = "Record is Successfully Updated"
                Successtext.ShowDialog()

                Dim SQLStatement As String
                logdate = Convert.ToDateTime(Date.Now).ToString("yyyy-MM-dd hh:mm:ss")
                logdate2 = Format(Date.Now, "yyyy-MM-dd")
                status = "Updated Branch: " + txtbranchcode.Text + ", " + txtbranchname.Text
                SQLStatement = "INSERT INTO log(EmployeeID,Name,EmployeePosition,Date,DateTime,Status)VALUES('" & profile.lblemployeenum.Text & "','" & profile.lblemployeename.Text & "','" & Main.lbldate.Text & "','" & logdate2 & "','" & logdate & "','" & status & "' )"
                Savelog(SQLStatement)

                srchTextBox.Clear()
                con.Close()

            Else
                'error
                Dim Errortext As New Msgerror
                Errortext.PassedText = "Record is not Updated"
                Errortext.ShowDialog()

            End If

        End If
    Else
        Dim Errortext As New Msgerror
        Errortext.PassedText = "All Entries with * must be filled"
        Errortext.ShowDialog()

    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:43:03.833

首先，在 form1 中创建一个 form2 的实例。

```
Dim secondform As New Form2 
```

在您的 form2 上，转到三个标签的“修饰符”属性并将其更改为公共。

然后您可以在 form1 中设置变量以获取标签的值，如下所示；

```
Dim a As String = secondform.lblemployeename.Text
Dim b As String = secondform.lblemployeenum.Text
Dim c As String = secondform.lblEmpPosition.Text 
```

这应该使“a”、“b”和“c”成为标签的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:54:06.400

看起来您正在创建表单 ( `Dim profile As New ProfileControl`) 的实例，然后您尝试访问他的控件值。你不是`ProfileControl`已经创建了吗？

无论如何，如果`ProfileControl`是一个表单，该`Load`事件只会在表单加载时执行（当您显示表单时），因此标签的值不会被加载。

如果您已经在显示表单，请不要创建该实例并使用您显示的表单名称来访问标签。

如果您没有显示表单，则应考虑在另一个变量中创建该值，然后将其分配给标签或创建自己的类等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:42:12.903

只需添加表单名称中的控件：

```
Form2.lblemployeename.Text
Form2.lblemployeenum.Text
Form2.lblEmpPosition.Text 
```

对我来说，在带有 VS2005 的 VB.NET 2.0 中，创建了控件`Friend`。检查表单设计器并将您的控件放在`Public`或`Friend`（`With Events`如果需要）上，以便在其他表单中使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-03T14:46:01.337

知道这有点晚了，但我花了 2 天时间才弄清楚（我从 Google、stackoverflow、VBforums 阅读了 100 多页……）。这里是解决方案：

创建constants.vb（类）并输入以下代码：

```
Public Shared Property loading_window_status As String = "" 
```

现在您可以从 form1、form2.ShowDialog()、form3.Show() 访问 loading_window_status。

表格1：

```
constants.loading_window_status = "Test" 
```

表格2：

```
dim a as string
a = constants.loading_window_status 
```

对我来说，当我想从 loading_screen timer1.tick 关闭 loading_screen.ShowDialog() 时，没有其他工作，但关闭的触发器在 form1 上。

**例子：**

```
Public Class form1
    Private Sub form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        'set status to show
        Constants.loading_window_status = "Show"
        'multitreads for spinner to run on loading_screen
        Application.DoEvents()
        'use ShowDialog or System.Threading.ThreadPool.QueueUserWorkItem(New System.Threading.WaitCallback(AddressOf form_loader_window.ShowDialog), Me)
        loading_screen.ShowDialog()

    End Sub
    Private Sub Button1_Click(sender As Object, e As EventArgs)
        'close screen loader
        Constants.loading_window_status = "Close"
    End Sub
End Class 
```

```
Public Class loading_screen

    Private Sub loading_screen(sender As Object, e As EventArgs) Handles MyBase.Load

        Timer1.Interval = 500
        Timer1.Start()

    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
        Dim what_todo As String
        'get status from "form1"
        what_todo = Constants.loading_window_state

        If what_todo = "Close" Then
        'if status close, close me (ShowDialog)
            Me.Close()
            Timer1.Stop()

        End If

    End Sub
End Class 
```

在 Microsoft Visual Studio Community 2019 Preview 上测试。

# android - 未找到处理 Intent { act=android.service.wallpaper.CHANGE_LIVE_WALLPAPER 的活动（有附加功能）}

> ID：14939943
> 
> 赞同：2
> 
> 时间：2013-02-18T15:40:27.177
> 
> 标签：android, live-wallpaper, activitynotfoundexception

我正在为 android 创建一个动态壁纸应用程序。我已经写了一些代码，但我收到以下错误**原因：android.content.ActivityNotFoundException：没有找到处理 Intent { act=android.service.wallpaper.CHANGE_LIVE_WALLPAPER (has extras) }**

请帮忙

**MyPoint.java**

```
public class MyPoint {
public String text;
public float x;
public float y;

public MyPoint(String text, float x, float y) {
    this.text = text;
    this.x = x;
    this.y = y;
}

} 
```

**MyPreferencesActivity.java**

```
public class MyPreferencesActivity extends PreferenceActivity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.prefs);

    Preference circlePreference = getPreferenceScreen().findPreference(
            "numberOfCircles");
    circlePreference.setOnPreferenceChangeListener(numberCheckListener);
}

Preference.OnPreferenceChangeListener numberCheckListener = new OnPreferenceChangeListener() {

    @Override
    public boolean onPreferenceChange(Preference preference, Object newValue) {
        if (newValue != null && newValue.toString().length() > 0
                && newValue.toString().matches("\\d*")) {
            return true;
        }
        Toast.makeText(MyPreferencesActivity.this, "Invalid Input",
                Toast.LENGTH_SHORT).show();
        return false;
    }
};
} 
```

**MyWallpaperService.java**

```
public class MyWallpaperService extends WallpaperService {

@Override
public Engine onCreateEngine() {
    return new MyWallpaperEngine();
}

private class MyWallpaperEngine extends Engine {
    private final Handler handler = new Handler();
    private final Runnable drawRunner = new Runnable() {
        @Override
        public void run() {
            draw();
        }

    };
    private List<MyPoint> circles;
    private Paint paint = new Paint();
    private int width;
    int height;
    private boolean visible = true;
    private int maxNumber;
    private boolean touchEnabled;

    public MyWallpaperEngine() {
        SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(MyWallpaperService.this);
        maxNumber = Integer
                .valueOf(prefs.getString("numberOfCircles", "4"));
        touchEnabled = prefs.getBoolean("touch", false);
        circles = new ArrayList<MyPoint>();
        paint.setAntiAlias(true);
        paint.setColor(Color.WHITE);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeWidth(10f);
        handler.post(drawRunner);
    }

    @Override
    public void onVisibilityChanged(boolean visible) {
        this.visible = visible;
        if (visible) {
            handler.post(drawRunner);
        } else {
            handler.removeCallbacks(drawRunner);
        }
    }

    @Override
    public void onSurfaceDestroyed(SurfaceHolder holder) {
        super.onSurfaceDestroyed(holder);
        this.visible = false;
        handler.removeCallbacks(drawRunner);
    }

    @Override
    public void onSurfaceChanged(SurfaceHolder holder, int format,
            int width, int height) {
        this.width = width;
        this.height = height;
        super.onSurfaceChanged(holder, format, width, height);
    }

    @Override
    public void onTouchEvent(MotionEvent event) {
        if (touchEnabled) {

            float x = event.getX();
            float y = event.getY();
            SurfaceHolder holder = getSurfaceHolder();
            Canvas canvas = null;
            try {
                canvas = holder.lockCanvas();
                if (canvas != null) {
                    canvas.drawColor(Color.BLACK);
                    circles.clear();
                    circles.add(new MyPoint(
                            String.valueOf(circles.size() + 1), x, y));
                    drawCircles(canvas, circles);

                }
            } finally {
                if (canvas != null)
                    holder.unlockCanvasAndPost(canvas);
            }
            super.onTouchEvent(event);
        }
    }

    private void draw() {
        SurfaceHolder holder = getSurfaceHolder();
        Canvas canvas = null;
        try {
            canvas = holder.lockCanvas();
            if (canvas != null) {
                if (circles.size() >= maxNumber) {
                    circles.clear();
                }
                int x = (int) (width * Math.random());
                int y = (int) (height * Math.random());
                circles.add(new MyPoint(String.valueOf(circles.size() + 1),
                        x, y));
                drawCircles(canvas, circles);
            }
        } finally {
            if (canvas != null)
                holder.unlockCanvasAndPost(canvas);
        }
        handler.removeCallbacks(drawRunner);
        if (visible) {
            handler.postDelayed(drawRunner, 5000);
        }
    }

    // Surface view requires that all elements are drawn completely
    private void drawCircles(Canvas canvas, List<MyPoint> circles) {
        canvas.drawColor(Color.BLACK);
        for (MyPoint point : circles) {
            canvas.drawCircle(point.x, point.y, 20.0f, paint);
        }
    }
}
} 
```

**SetWallpaperActivity.java**

```
public class SetWallpaperActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_set_wallpaper);
}

public void clickMe(View view) {
    Intent intent = new Intent(
            WallpaperManager.ACTION_CHANGE_LIVE_WALLPAPER);
    intent.putExtra(WallpaperManager.EXTRA_LIVE_WALLPAPER_COMPONENT,
            new ComponentName(this, MyWallpaperService.class));
    startActivity(intent);
}

} 
```

**activity_set_wallpaper.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".SetWallpaperActivity" >

<Button 
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:onClick="clickMe"
    android:text="Click Me!" />

</RelativeLayout> 
```

**我的壁纸.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<wallpaper xmlns:android="http://schemas.android.com/apk/res/android"
android:description="@string/wallpaper_description"
android:settingsActivity="de.vogella.android.wallpaper.MyPreferencesActivity"
android:thumbnail="@drawable/icon" /> 
```

**首选项.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

<CheckBoxPreference
    android:key="touch"
    android:title="Enable Touch" >
</CheckBoxPreference>

<EditTextPreference
    android:key="numberOfCircles"
    android:title="Number of Circles" >
</EditTextPreference>

</PreferenceScreen> 
```

**日志猫**

```
02-18 21:08:07.630: E/AndroidRuntime(9406): FATAL EXCEPTION: main
02-18 21:08:07.630: E/AndroidRuntime(9406): java.lang.IllegalStateException: Could not execute method of the activity
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.view.View$1.onClick(View.java:3095)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.view.View.performClick(View.java:3567)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.view.View$PerformClick.run(View.java:14224)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.os.Handler.handleCallback(Handler.java:605)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.os.Looper.loop(Looper.java:137)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.app.ActivityThread.main(ActivityThread.java:4517)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at java.lang.reflect.Method.invokeNative(Native Method)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at java.lang.reflect.Method.invoke(Method.java:511)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at dalvik.system.NativeStart.main(Native Method)
02-18 21:08:07.630: E/AndroidRuntime(9406): Caused by: java.lang.reflect.InvocationTargetException
02-18 21:08:07.630: E/AndroidRuntime(9406):     at java.lang.reflect.Method.invokeNative(Native Method)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at java.lang.reflect.Method.invoke(Method.java:511)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.view.View$1.onClick(View.java:3090)
02-18 21:08:07.630: E/AndroidRuntime(9406):     ... 11 more
02-18 21:08:07.630: E/AndroidRuntime(9406): Caused by: android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.service.wallpaper.CHANGE_LIVE_WALLPAPER (has extras) }
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1536)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1388)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.app.Activity.startActivityForResult(Activity.java:3195)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at android.app.Activity.startActivity(Activity.java:3302)
02-18 21:08:07.630: E/AndroidRuntime(9406):     at de.vogella.android.wallpaper.SetWallpaperActivity.clickMe(SetWallpaperActivity.java:23)
02-18 21:08:07.630: E/AndroidRuntime(9406):     ... 14 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-28T22:04:52.597

我不知道您要构建的目标是什么，但[文档](https://developer.android.com/reference/android/app/WallpaperManager.html#ACTION_CHANGE_LIVE_WALLPAPER)说这`WallpaperManager.ACTION_CHANGE_LIVE_WALLPAPER`是在 API 级别 16 中添加的，因此如果您在旧设备上使用此代码，它将引发此错误。[这个答案](https://stackoverflow.com/questions/14317167/getting-error-at-wallpapermanager-action-change-live-wallpaper)显示了如何检查正确的 API 级别。

除了检查 API 级别，您还可以将意图包装在 try/catch 中。虽然这通常是不好的做法，但我认为这在这里可能是有益的，因为有些人偶尔会在 API 级别大于 16 时报告此错误（尽管这种情况很少见，并且可能与用户不使用库存 android ROM 有关）。

# android - Create thin divider using a 9-patch png

> ID：14939947
> 
> 赞同：2
> 
> 时间：2013-02-18T15:40:47.627
> 
> 标签：android, nine-patch

I'm trying to create a simple divider using a 9-patch png but I can't seem to get it to stretch correctly. Below is what I have set up on the left and what I want it to do on the right (i scaled it up by 10x to make it easier to see, the real thing is only 16x6 pixels).

![enter image description here](../Images/20ab3a1aabf96d44f80e3b1432290080.png)

I'm using it as a background on an imageview:

```
<ImageView 
    android:layout_width="fill_parent"
    android:layout_height="2dip"
    android:src="@drawable/divider"
    android:contentDescription="@string/blank"> 
```

Here is a screenshot from the app itself:

![enter image description here](../Images/c17c6cb9fedb4932c57565ed225652fd.png)

Where am I going wrong? 9-patch pngs seem to confuse me each time I try to use them.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:05:57.500

Change `android:src` to `android:background` in your xml. ImageViews are used for the actual image, and their scaling depends on `scaleType`. They don't scale 9patch images the way you'd think. Using `background` tells it to use it that way.

Side note: You don't even need to use an `ImageView`, just a simple `View` with `background` set will do it.

# html - 溢出时的假滚动条：隐藏

> ID：14939949
> 
> 赞同：3
> 
> 时间：2013-02-18T15:40:55.413
> 
> 标签：html, scroll, html5-canvas, fabricjs

我有一个大画布包裹在一个较小的 div 容器中，并隐藏了溢出。

我想创建一个（假 div/css 甚至画布？）滚动条来移动包装器内的画布位置，就好像它是一个真实的（溢出：自动）滚动条一样。

首先，我试图实现的目标是否可行？

我可以用 javascript 在包装器内“移动”我的画布位置吗？

为什么是假滚动条？

*   画布是一个“活动”区域，用户可以在其中绘制和移动形状。

*   原生滚动条在 ipad 上不起作用。

*   CSS 自定义

我看到很多 Jquery 库在做类似的事情，但它们使内容可拖动，而我只希望滚动条“栏”是可拖动的。

这是我尝试的演示：

[http://jsbin.com/otinuy/1/edit](http://jsbin.com/otinuy/1/edit)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T21:19:18.877

是的，您只需要使画布的左侧位置与水平滚动条“栏”的左侧位置相关，如下所示

令 W 为画布的宽度，令 D 为包含 div 和滚动条的宽度，B 为滚动条“条”的宽度。W>D

相对于包含 div 的初始值，画布的左侧为 0，并且滚动条的“bar”为 left=0。

可查看的画布比例为 D/W，因此 B=D*D/W

“条”左侧边缘的范围是 0 到 DB，随着“条”向右移动，画布按比例向左移动。

令 L 为滚动条左侧边缘的“条”的当前位置，移动的分数为 L/D，因此画布向左移动 L*W/D

即当 (bar).style.left= L (canvas).style.left=-L*W/D

这是一个使用 JQuery 的小提琴，希望能满足您的要求。

[http://jsfiddle.net/GdsEa/](http://jsfiddle.net/GdsEa/)

Javascript代码如下所示

```
var W=2000;
var D=500;
var B=D*D/W;
document.getElementById("wrap1").style.width=D+"px";
document.getElementById("hbar").style.width=B+"px";
var canv=document.getElementById("mycanvas");
canv.width=W;
var ctx=canv.getContext("2d");
ctx.beginPath();
ctx.moveTo(100,100);
ctx.lineTo(200,100);
ctx.lineTo(200,200);
ctx.lineTo(100,200);
ctx.closePath();
ctx.fillStyle="rgb(255,0,0)";
ctx.fill();

ctx.beginPath();
ctx.moveTo(W-100,100);
ctx.lineTo(W,100);
ctx.lineTo(W,200);
ctx.lineTo(W-100,200);
ctx.closePath();
ctx.fillStyle="rgb(0,0,255)";
ctx.fill();

$( ".bar" ).draggable({ containment:"parent" });
$( ".bar" ).on( "drag", function( event, ui ) {var L=ui.position.left;
                                               canv.style.left=(-L*W/D)+"px"} ); 
```

请注意，包含 div、canvas、scrollbar 和 bar 的宽度在代码中通过设置 W 和 D 被覆盖，以便于更改这些值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T19:07:02.890

要在大于屏幕的画布上导航，您可以将大画布放在屏幕外，然后在屏幕上放置第二个较小的画布。

**通过显示较大画布的一部分**，第二个画布就像一个进入较大画布的视口。

您可以创建导航系统以允许用户通过视口滚动浏览更大的画布。

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/BBwW8/](http://jsfiddle.net/m1erickson/BBwW8/)

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
    $(function(){

        var canvas=document.getElementById("canvas");
        var ctxCanvas=canvas.getContext("2d");
        var view=document.getElementById("view");
        var ctxView=view.getContext("2d");

        var col=0;
        var row=0;

        var img=new Image();
        img.onload=function(){
            ctxCanvas.drawImage(this,0,0,canvas.width,canvas.height);
            drawToViewport();
        }
        img.src="http://www.gospelgifs.com/art_pages_15/imgs/house2.gif";

        $("#left").click(left);
        $("#right").click(right);
        $("#up").click(up);
        $("#down").click(down);

        function drawToViewport(){
            ctxView.clearRect(0,0,view.width,view.height);
            ctxView.drawImage(canvas,
                col*canvas.width/4,row*canvas.height/4,view.width,view.height,
                0,0,view.width,view.height);   
        }
        function right(){
            if(col+1<=3){ col++; drawToViewport(); }
        }
        function left(){
            if(col-1>=0){ col--; drawToViewport(); }
        }
        function down(){
            if(row+1<=3){ row++; drawToViewport(); }
        }
        function up(){
            if(row-1>=0){ row--; drawToViewport(); }
}

    }); // end $(function(){});
</script>

</head>

<body>

<canvas id="canvas" width=300 height=300></canvas><br/>
<canvas id="view" width=97 height=67></canvas>
<button id="left">Left</button>
<button id="right">Right</button>
<button id="up">Up</button>
<button id="down">Down</button>

</body>
</html> 
```

# matlab - 有什么方法可以调用 Matlab 来计算图片相似度？

> ID：14939950
> 
> 赞同：0
> 
> 时间：2013-02-18T15:40:59.460
> 
> 标签：matlab, neural-network

我们正在开展我们的项目，该项目涉及实施神经网络来检测网络钓鱼

目前，我们计划使用在浏览器中打开的网站的 URL 和屏幕截图，并将其作为字符串和 JPEG 文件传递​​给程序。我们希望这个程序调用 Matlab 并搜索

a) 我们列入白名单的网站图像数据库中的类似图像。b) 在我们的黑名单网站数据库中以 XML 文件获得的类似 URL

我们将根据这些评估计算分数，并为网站分配网络钓鱼评级。

我们处于初始阶段，所以只是想知道这是否可行？帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T16:57:29.333

您的问题很不寻常，但是在阅读了两次之后，我认为您的主要问题是：

> 我可以在 Matlab 中做上面提到的事情吗？

在这种情况下，答案肯定*是肯定*的。

例如，Matlab 当然可以：

1.  比较图像（您可能想要获取高级事物的图像处理工具箱）
2.  识别字符串中的模式
3.  连接到数据库/读取文件
4.  从其他程序调用
5.  训练神经网络

只要确保您可以访问正确的工具箱/资源，这些可能包括：

图像处理工具箱、神经网络工具箱、编译器

# java - 在 rfb 协议中提交 (x,y)-位置

> ID：14939952
> 
> 赞同：1
> 
> 时间：2013-02-18T15:41:04.293
> 
> 标签：java, network-programming, protocols, vnc

rfb 协议定义，对于位置传输 (x,y)，每个值必须用两个字节表示。那么如何在协议定义参数的字节数组中表示（108,284）如下：

```
byte[] clientMessage = new byte[] { messageType, btnMask, x, x, y, y} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T09:55:14.260

正如我认为的那样，这很容易。用两个字节表示整数值：

```
int x = 108;
byte x1 = (byte)((x >> 8) & 0xFF);
byte x2 = (byte)((x >> 0) & 0xFF); 
```

# python - 将一个数字的位数相加

> ID：14939953
> 
> 赞同：92
> 
> 时间：2013-02-18T15:41:06.823
> 
> 标签：python, sum, digits

如果我想找到一个数字的数字之和，即：

*   输入：`932`
*   输出：`14`，即`(9 + 3 + 2)`

最快的方法是什么？

我本能地做了：

```
sum(int(digit) for digit in str(number)) 
```

我在网上找到了这个：

```
sum(map(int, str(number))) 
```

哪个最适合速度，还有其他更快的方法吗？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2013-02-18T15:45:41.913

你发布的两行都很好，但你可以纯粹用整数来做，这将是最有效的：

```
def sum_digits(n):
    s = 0
    while n:
        s += n % 10
        n //= 10
    return s 
```

或与`divmod`：

```
def sum_digits2(n):
    s = 0
    while n:
        n, remainder = divmod(n, 10)
        s += remainder
    return s 
```

* * *

更快的是没有增加分配的版本：

```
def sum_digits3(n):
   r = 0
   while n:
       r, n = r + n % 10, n // 10
   return r 
```

* * *

```
> %timeit sum_digits(n)
1000000 loops, best of 3: 574 ns per loop

> %timeit sum_digits2(n)
1000000 loops, best of 3: 716 ns per loop

> %timeit sum_digits3(n)
1000000 loops, best of 3: 479 ns per loop

> %timeit sum(map(int, str(n)))
1000000 loops, best of 3: 1.42 us per loop

> %timeit sum([int(digit) for digit in str(n)])
100000 loops, best of 3: 1.52 us per loop

> %timeit sum(int(digit) for digit in str(n))
100000 loops, best of 3: 2.04 us per loop 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-09-27T21:13:35.470

如果你想继续对数字求和，直到得到一个***位数***（我最喜欢的数字可以被 9 整除的特征之一），你可以这样做：

```
def digital_root(n):
    x = sum(int(digit) for digit in str(n))
    if x < 10:
        return x
    else:
        return digital_root(x) 
```

事实证明，这本身就相当快......

```
%timeit digital_root(12312658419614961365)

10000 loops, best of 3: 22.6 µs per loop 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-06T09:31:17.773

这可能会有所帮助

```
def digit_sum(n):
    num_str = str(n)
    sum = 0
    for i in range(0, len(num_str)):
        sum += int(num_str[i])
    return sum 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-01-22T20:19:09.667

在解决问题的挑战网站之一上找到了这个。不是我的，但它有效。

```
num = 0            # replace 0 with whatever number you want to sum up
print(sum([int(k) for k in str(num)])) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-29T16:20:17.050

Doing some Codecademy challenges I resolved this like:

```
def digit_sum(n):
    digits = []
    nstr = str(n)
    for x in nstr:
        digits.append(int(x))
    return sum(digits) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-09-11T11:34:56.100

最好的方法是使用数学。
我从学校知道这一点。（有点也来自代码战）

```
def digital_sum(num):
    return (num % 9) or num and 9 
```

只是不知道这在代码中是如何工作的，但我知道这是数学

如果一个数字可以被 9 整除，那么它的 digital_sum 将是 9，
如果不是这种情况，那么`num % 9`它将是数字和。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-22T13:42:03.607

尝试这个

```
 print(sum(list(map(int,input("Enter your number "))))) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-23T12:33:38.610

这是一个没有任何循环或递归但仅适用于非负整数的解决方案（Python3）：

```
def sum_digits(n):
    if n > 0:
        s = (n-1) // 9    
        return n-9*s
    return 0 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-22T08:37:26.760

***您也可以使用名为 divmod() 的 built_in_function 尝试此操作；***

```
number = int(input('enter any integer: = '))
sum = 0
while number!=0: 
    take = divmod(number, 10) 
    dig = take[1] 
    sum += dig 
    number = take[0] 
print(sum) 
```

**你可以取任意位数**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-21T17:49:13.353

```
def sumOfDigits():

    n=int(input("enter digit:")) 
    sum=0
    while n!=0 :

        m=n%10
        n=n/10
        sum=int(sum+m)

    print(sum)

sumOfDigits() 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-24T17:23:35.983

我想出了一个递归解决方案：

```
def sumDigits(num):
#   print "evaluating:", num
  if num < 10:
    return num

  # solution 1
#   res = num/10
#   rem = num%10
#   print "res:", res, "rem:", rem
#   return sumDigits(res+rem)

    # solution 2
  arr = [int(i) for i in str(num)]
  return sumDigits(sum(arr))

# print(sumDigits(1))
# print(sumDigits(49))
print(sumDigits(439230))
# print(sumDigits(439237)) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-11-14T12:48:09.277

```
def digits_sum(a):
    sum = 0
    for i in range(len(str(a))):
        sum += a // 10 ** i % 10
    return sum 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-22T21:05:08.863

```
def digitsum(n):
    result = 0
    for i in range(len(str(n))):
        result = result + int(str(n)[i:i+1])
    return(result) 
```

“结果”初始化为 0。

在 for 循环中，将 number(n) 转换为字符串，然后用循环 index(i) 进行拆分并获取每个数字。---> **str** (n)[ **i:i+1** ]

这个切片数字被转换回一个整数----> **int** (str(n)[i:i+1])

因此添加到结果中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-10-24T10:56:06.687

我自己就是这样做的，它可以在没有任何 BigInt 库的情况下正确处理任意精度整数：

```
function sumdigits(x,k,z){

    gsub(/[^1-9]+/,"",x)    # throw away junk, and all 0's
    z += gsub(++k, "",x)    # get rid of all the 1's

    while ( x!="" ) {  

       # process 2 numbers at a time, so 
       # even in worst case, the while() loop
       # is only called 4 cycles, while offering 
       # rapid early-exit.

       z +=  (++k * gsub(k,"",x))+\
             (++k * gsub(k,"",x)) ;
    }
    return z 
} 
```

为了好玩，我随机生成了 3 个综合大整数，每个都有`46,539,361`十进制数字，每个数字的总和超过 2 亿

> `214,942,897` `217,165,213` `223,275,043`

在我 2018 年的系统上，它平均约为 1.75 秒左右。

对于较小的输入：

长整数总和为 0.807 秒`23,019,933-digit`长整数总和为0.109`102,221,680` 秒 `2,829,207-digit` `13,258,766`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-07-08T11:44:55.943

```
reduce(op.add,map(int,list(str(number)))) 
```

测试：

```
from datetime import datetime
number=49263985629356279356927356923569976549123548126856926293658923658923658923658972365297865987236523786598236592386592386589236592365293865923876592385623987659238756239875692387659238756239875692856239856238563286598237592875498259826592356923659283756982375692835692385653418923564912354687123548712354827354827354823548723548235482735482354827354823548235482354823548235482735482735482735482354823548235489235648293548235492185348235481235482354823548235482354823548235482354823548234

startTime = datetime.now()

for _ in  range(0,100000) :
    out=reduce(op.add,map(int,list(str(number))))

now=datetime.now()
runningTime=(now - startTime)

print ("Running time:%s" % runningTime)
print(out) 
```

> 运行时间：0:00:13.122560 2462

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-25T09:33:53.630

一个以 10 为底的数可以表示为一系列形式

> a × 10^ ^p + b × 10^ ^(p-1) .. z × 10^ ⁰

所以数字的数字之和是各项系数的和。

基于此信息，可以像这样计算数字的总和：

```
import math

def add_digits(n):
    # Assume n >= 0, else we should take abs(n)
    if 0 <= n < 10:
        return n
    r = 0
    ndigits = int(math.log10(n))
    for p in range(ndigits, -1, -1):
        d, n = divmod(n, 10 ** p)
        r += d
    return r 
```

这实际上是接受答案中连续除以 10 的逆过程。鉴于与接受的答案相比，此函数中的额外计算，发现这种方法相比之下表现不佳也就不足为奇了：它慢了大约 3.5 倍，大约慢了两倍

```
sum(int(x) for x in str(n)) 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-08-13T16:09:02.160

你可以试试这个

```
def sumDigits(number):
    sum = 0
    while(number>0):
        lastdigit = number%10
        sum += lastdigit
        number = number//10

    return sum 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2018-02-27T18:35:22.357

```
num = 123
dig = 0
sum = 0
while(num > 0):
  dig = int(num%10)
  sum = sum+dig
  num = num/10 
```

print(sum) // 确保在此行上方添加空格

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2020-09-23T07:04:52.527

它只适用于三位数字，但它有效

```
a = int(input())
print(a // 100 + a // 10 % 10 + a % 10) 
```

* * *

## 回答 #20

> 赞同：-5
> 
> 时间：2017-06-09T13:59:37.203

```
n = str(input("Enter the number\n"))

list1 = []

for each_number in n:

        list1.append(int(each_number))

print(sum(list1)) 
```

# c - 返回指向结构的指针

> ID：14939954
> 
> 赞同：-2
> 
> 时间：2013-02-18T15:41:07.977
> 
> 标签：c

我正在尝试定义一个将返回指向结构的指针的函数。我认为我正确地遵循了这一点，（[返回一个结构指针](https://stackoverflow.com/questions/2702928/returning-a-struct-pointer)）但是当我尝试访问指针的成员时，我的代码一直抱怨这个错误消息，“错误：取消引用指向不完整类型的指针”。

这是我的代码

```
#include <stdio.h>  
#include <string.h>   
#include <assert.h>  

struct lnode  
{  
  char* word;  
  int   line;  
  int   count;  
  struct lnode* nn;     /* nn = next node */  
};

struct lnode* newNode (char* word, int line) 
{
  struct lnode* newn = (struct lnode*) malloc(sizeof (struct lnode));
  if (!newn)
    return NULL;
  strcpy (newn->word, word);
  newn->line  = line;
  newn->count = 1;
  newn->nn    = NULL;
  return newn;
}

int main()
{
  char* p = "hello";
  struct lnode* head = newNode (p, 5);
  //the following lines are causing errors
  assert (!strcmp (head->word, p));     
  assert (head->line  == 5);
  assert (head->count == 1);
  assert (!head->nn);
  return 0;
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:16:22.403

除了明显的问题，你错过了 include `stdlib.h`，还有你如何处理字符串的问题。

在 C 中，您（是的）必须管理用于字符串的所有内存。这包括成员指向的内存`word`。

您的代码执行以下操作（在去除一些绒毛之后）：

```
struct lnode* newn = malloc(...);
strcpy (newn->word, word); 
```

在这里，`newn->word`未初始化，因此可能会崩溃。

您将需要分配内存来存储字符串，例如通过`malloc()`第二次调用：

```
struct lnode* newn = malloc(...);
newn->word = malloc(strlen(word) + 1);
strcpy (newn->word, word); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:47:49.460

代码必须能够访问`struct lnode`.

正如 Alok Save 暗示的那样，您可能在另一个文件（可能是标题）中有声明，而您忘记了`#include`它。

# javascript - 带有扩展 div 的 Javascript 类打开按钮

> ID：14939956
> 
> 赞同：0
> 
> 时间：2013-02-18T15:41:22.453
> 
> 标签：javascript, jquery, html, css

我有一个网站，在标题上方的顶栏中有一个扩展的小部件区域。你可以在这里看到这个：http: [//khill.mhostiuckproductions.com/siteLSSBoilerPlate/](http://khill.mhostiuckproductions.com/siteLSSBoilerPlate/)

当点击箭头展开该区域时，您可以看到它切换到了另一个面向相反方向的按钮。当第二次单击它以恢复该区域时，箭头不会切换回其原始位置。

我已经在 SO 尝试了许多与类切换主题有关的事情，但我无法让它发挥作用。[使用 JavaScript 更改元素的类](https://stackoverflow.com/questions/195951/change-an-elements-css-class-with-javascript)

如何使用下面已有的代码最好地将这个按钮上的类从展开箭头切换到折叠箭头？在这种情况下，我是否应该简单地删除下面的代码并使用更容易/更好的东西？

**CSS：**

```
.collapse-arrow {
    display: inline-block;
    width: 24px;
    height: 24px;
    background: url('../../../images/collapse-arrow.png');
}

.expand-arrow {
    display: inline-block;
    width: 24px;
    height: 24px;
    margin-top: 5px;
    background: url('../../../images/expand-arrow.png');
} 
```

**Javascript**

```
<script language="javascript"><!-- THIS IS THE SLDING TOP BAR -->
    (function() {
      var open = false;     
      toggle = function() {
        var ele = document.getElementById("toggleText");
        var text = document.getElementById("displayText");
        ele.style.height = (open ? 0 : ele.scrollHeight)+"px";
        document.getElementById("displayText").className = 
        document.getElementById("displayText").className.replace
        ( /(?:^|\s)expand-arrow(?!\S)/g , '' );                     
        open = !open;                   
      }
    })();   
    </script> 
```

**HTML：**

*按钮：*

```
<a class="expand-arrow" id="displayText" href="javascript:toggle();"></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:38:37.797

您只需要这样：

```
<script language="javascript">

function toggle(){
    document.getElementById("displayText").classList.toggle('expand-arrow');
}

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:01:41.120

你有没有尝试过：

`if (className indexOf("class1")){}`

我建议您使用 jQuery 的 `.removeClass('class1')`，`.addClass('class2')`以获得更易读、更符合浏览器的代码。

# perl - Perl 日志文件命名为时间戳问题

> ID：14939957
> 
> 赞同：1
> 
> 时间：2013-02-18T15:41:24.280
> 
> 标签：perl, filenames, log4perl

我正在编写一个 Log4perl 记录器，并且正在使用 localtime() 函数。问题是，每次我调用重新实例化 log4perl 记录器的模块（对于不同的文件）时，localtime() 都会有所不同，当我希望它们都在一个文件中时会创建几个不同的日志文件。
想法？

```
use strict;
use warnings;
use Config::IniFiles;
use File::Copy;
use Cwd 'abs_path';
use Path::Class; 
```

以上是我做之前的代码`use LIB::Paths`，也是第一个使用Paths.pm的文件。下面的代码是 Paths.pm 文件。第一个文件调用`use LIB::Paths`，第二个文件也是如此[可以添加，但我不想把所有代码都扔给你们]。 **这会产生两个单独的时间戳。**

```
my @now = localtime();
### May want to add something from the input name to the log file
our $timeStamp = sprintf("%04d_%02d%02d_%02d%02d%02d", 
                    $now[5]+1900, $now[4]+1, $now[3],
                    $now[2],      $now[1],   $now[0]);

my $logFile = "$timeStamp.log";
our $fullLogPath = $output_dir . "/" . $log_dir . "/" . $logFile;
qx(touch $fullLogPath);

# write path and level to log configuration file
our $logLevel = $parms->val('MAIN','LogLevel');

open FILEHANDLE, '>', "$base_dir/CONFIG/log.conf";

print FILEHANDLE "log4perl.rootLogger=$logLevel, LOGFILE\n";
print FILEHANDLE "log4perl.appender.LOGFILE=Log::Log4perl::Appender::File\n";
print FILEHANDLE "log4perl.appender.LOGFILE.filename=$fullLogPath\n";
print FILEHANDLE "log4perl.appender.LOGFILE.mode=append\n";
print FILEHANDLE "log4perl.appender.LOGFILE.layout=PatternLayout\n";
print FILEHANDLE "log4perl.appender.LOGFILE.layout.ConversionPattern=%F{1} %8L %10p %n     %m%n";

close (FILEHANDLE);
open SECONDFILE, '>', "$base_dir/CONFIG/log2.conf";

print SECONDFILE "log4perl.rootLogger=$logLevel, LOGFILE\n";
print SECONDFILE "log4perl.appender.LOGFILE=Log::Log4perl::Appender::File\n";
print SECONDFILE "log4perl.appender.LOGFILE.filename=$fullLogPath\n";
print SECONDFILE "log4perl.appender.LOGFILE.mode=append\n";
print SECONDFILE "log4perl.appender.LOGFILE.layout=PatternLayout\n";
print SECONDFILE "log4perl.appender.LOGFILE.layout.ConversionPattern=%F{1} %n     %m%n";

close (SECONDFILE); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:59:53.187

首先，您不必使用文件来存储 log4perl 配置，您可以使用字符串来初始化记录器。

其次，您可以使用 filerotate appender 每天创建一个新的日志文件，保留最后 n 个文件。

在您的示例中，每次调用都会创建一个新文件。如果您只使用一天“特定”模式，它将每天创建一个新文件：

```
our $timeStamp = sprintf("%04d_%02d%02d",  $now[5]+1900, $now[4]+1, $now[3]);
                ); 
```

问候，

文件旋转：

```
my $fullLogPath = $output_dir . "/" . $log_dir . "/" . "testlogger.log";
# Logger config
my $log_conf = q(
    log4perl.category = INFO, FileAppndr
    log4perl.appender.FileAppndr             = Log::Dispatch::FileRotate
    log4perl.appender.FileAppndr.filename    = $fullLogPath
    log4perl.appender.FileAppndr.mode        = append
    log4perl.appender.FileAppndr.DatePattern = yyyy-MM-dd
    log4perl.appender.FileAppndr.max         = 10
    log4perl.appender.FileAppndr.TZ          = GMT
    log4perl.appender.FileAppndr.layout      = PatternLayout
    log4perl.appender.FileApp.layout.ConversionPattern = %F{1} %n     %m%n
);
# Initialize Logger 
Log::Log4perl::init_once(\$log_conf); 
```

# c# - 在 LINQ to Entities 查询中不支持强制转换为十进制

> ID：14939961
> 
> 赞同：12
> 
> 时间：2013-02-18T15:41:34.963
> 
> 标签：c#, asp.net, linq-to-sql, casting, decimal

我有一个数据库表事务（transactionID，LocalAmount ...）。其中 Localamount 属性的数据类型是**float**。在 UI 上，我试图在按钮单击事件的一行中返回列 (Localamount) 的总和**。**

我用**十进制**而不是**浮点数**

但是，我在转换为**十进制的代码上遇到错误**

```
System.NotSupportedException was unhandled by user code
Message=Casting to Decimal is not supported in LINQ to Entities queries, because the required precision and scale information cannot be inferred. 
```

这

```
 public static IEnumerable<TransactionTotalForProfitcenter> GetTotalTransactionsForProfitcenter(int profitcenterID)
    {
        List<TransactionTotalForProfitcenter> transactions = new List<TransactionTotalForProfitcenter>();
        using (var context = new CostReportEntities())
        {
          transactions = (from t in context.Transactions
                            join comp in context.Companies on t.CompanyID equals comp.CompanyID
                            join c in context.Countries on comp.CountryID equals c.CountryID
                            where c.CountryID.Equals(comp.CountryID) && t.CompanyID == comp.CompanyID 

                            join acc in context.Accounts
                                 on t.AccountID equals acc.AccountID
                            join pc in context.Profitcenters
                                on t.ProfitcenterID equals pc.ProfitcenterID
                            group t by pc.ProfitcenterCode into tProfitcenter

                            select new TransactionTotalForProfitcenter
                            {
                                ProfitcenterCode = tProfitcenter.Key,
                    //the error is occurring on the following line           
                                TotalTransactionAmount = (decimal)tProfitcenter.Sum(t => t.LocalAmount),  
                   //the error is occurring on the following line       
                                TotalTransactionAmountInEUR = (decimal)tProfitcenter.Sum(t => t.AmountInEUR) //the error is occurring on this line 
                            }
                            ).ToList();

        }
        return transactions;

    } 
```

我从以下帖子中尝试了几个选项，但没有运气。

*   [LINQ to SQL 奇怪的浮点行为](https://stackoverflow.com/a/1817557/1108500)
*   [从十进制转换为浮点数](https://stackoverflow.com/a/1817557/1108500)

谁能指出我可以尝试的其他选择。如果它太琐碎，请原谅我对 LINQ 知之甚少。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-18T16:11:38.620

实体框架表明它不支持您想要的转换。一种解决方法是在数据库中尽可能多地执行工作，然后在内存中完成该过程。在您的情况下，您可以计算其本机类型的总和，将结果作为匿名类型拉入内存，然后在构造实际需要的类型时执行转换。要获取原始查询，您可以进行以下更改：

```
select new // anonymous type from DB
{
    ProfitcenterCode = tProfitcenter.Key,
    // notice there are no conversions for these sums
    TotalTransactionAmount = tProfitcenter.Sum(t => t.LocalAmount),       
    TotalTransactionAmountInEUR = tProfitcenter.Sum(t => t.AmountInEUR)
})
.AsEnumerable() // perform rest of work in memory
.Select(item =>
     // construct your proper type outside of DB
    new TransactionTotalForProfitcenter
    {
        ProfitcenterCode = item.ProfitcenterCode,
        TotalTransactionAmount = (decimal)item.TotalTransactionAmount
        TotalTransactionAmountInEUR = (decimal)item.TotalTransactionAmountInEUR
    }
).ToList(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-12-14T21:39:36.573

如果您碰巧没有调用 AsEnumerable 的奢侈，那么您可以`int`通过一些数学将其转换为十进制。

```
 (((decimal)((int)(x.Discount * 10000))) / 10000) 
```

每个零实际上代表转换将具有的精度。

[从这个](https://github.com/dagilleland/Winded/blob/master/NorthWindSystem/BLL/NorthwindManager.cs)得到这个答案。只需看一下文件的末尾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T15:48:53.227

我建议您在查询完成后进行演员表

```
var somevar = (decimal)transactions.YourValue 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-21T07:19:04.110

有时需要铸造，如果超过两位小数的宫殿

```
 double TotalQty;
     double.TryParse(sequence.Sum(x => x.Field<decimal>("itemQty")).ToString(),out TotalQty); 
```

# java - 设置默认活动 Android

> ID：14939962
> 
> 赞同：0
> 
> 时间：2013-02-18T15:41:38.063
> 
> 标签：java, android

尝试创建一个默认活动（在应用程序启动时加载的活动）。

我在 manifest.xml 中的代码如下：

```
 <activity
            android:name=".Start"
            android:label="@string/title_activity_start" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity> 
```

但是，这是行不通的。有人有想法么？我之前设置为默认的活动正在加载。

这是我的完整清单

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.samstone.ringoffire"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="7"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >
         <activity
            android:name=".Start"
            android:label="@string/title_activity_start" >
           <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
        </activity>
        <activity
            android:name="com.samstone.ringoffire.RingOfFire"
            android:label="@string/app_name"
            android:screenOrientation="portrait" >

        </activity>
        <activity
            android:name="com.samstone.ringoffire.AddRules"
            android:label="@string/title_activity_add_rules" >
        </activity>

    </application>

</manifest> 
```

它默认加载 RingOfFire 活动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-22T05:07:06.127

put in the full name for your starting activity just like you did for your other activities and get rid of android.intent.category.DEFAULT

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-20T14:24:11.797

我有同样的问题。我正在使用 IDEA。在 Run => Edit Configurations... 中，您可以设置首先启动哪个 Activity（您可以在那里设置一个默认 Activity 来解决您的问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:53:06.253

> 我之前设置为默认的活动正在加载。

重新启动有问题的设备或模拟器。主屏幕可以选择缓存此类信息，因此可能无法检测到您的`<intent-filter>`值更改。

# javascript - 使用 socket.io/node.js 上传文件块不适用于非文本文件

> ID：14939971
> 
> 赞同：1
> 
> 时间：2013-02-18T15:42:13.167
> 
> 标签：javascript, node.js, socket.io

只是搞乱node.js，我试图让一个文件上传器工作，在客户端对文件进行分块，通过socket.io将片段发送到服务器，然后重新组装。这是一个相当幼稚的实现，但只是试图学习。目前，如果我提交一个文本文件，它会移动并正确重新组合，但如果我尝试上传一个图像文件，编码就会混乱并且文件已损坏。

我在客户端读取二进制字符串，节点 fs 编码设置为二进制。还需要发生什么？

**客户代码**

```
while(start < fileSize)
{
    var reader = new FileReader();
    reader.onload = function(e){
        var data = {
            "data" : e.target.result,
            "sequence" : chunkCount++
        };
        socket.emit("sendChunk", data, function(data){
            console.log("Confirmation recieved");
        });
        console.log("Log: Sent");
    };

    reader.onerror = function(e){
        alert(e.getMessage());
    };

    var blob = file.slice(start, end);
    reader.readAsBinaryString(blob);
    start = end;
    end = end + chunkSize;

} 
```

**服务器代码**

```
socket.on('sendChunk', function (data) {
    fs.appendFileSync(path + fileName, data.data, 'binary');
    console.log(data.sequence + ' - The data was appended to file ' + fileName);
}); 
```

# **更新**

根据给出的建议，我更新了代码以使用 base64 解码。有时仍然会出现一些排序问题，但大多数情况下文件正在正确传输。

**客户代码：**

```
var data = {
    "data" : window.btoa(e.target.result),
    "sequence" : chunkCount++
};
socket.emit("sendChunk", data, function(data){
    console.log("Confirmation recieved");
}); 
```

**服务器代码：**

```
var decoded =  new Buffer(data.data, 'base64').toString('binary');
fs.appendFileSync(path + fileName, decoded, 'binary'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T17:13:41.747

`socket.emit()`是用 JavaScript 编写的，因此将有效负载视为 JavaScript `String`。您在服务器上收到乱码数据，因为在 JavaScript 中，字符串以 UCS-2 表示，并且某些控制字符正在转义。换句话说：JavaScript 字符串不是`Array`字节大小的字符，它不适合存储或传输二进制数据。

传输图像最安全的方法是在客户端[将二进制数据编码为 base64](https://developer.mozilla.org/en-US/docs/DOM/window.btoa)，并在服务器上使用[Buffer 类](http://nodejs.org/api/buffer.html#buffer_buf_tostring_encoding_start_end)进行解码。

# jquery - 存储使用 json 输入的动态表单和数据

> ID：14939973
> 
> 赞同：2
> 
> 时间：2013-02-18T15:42:37.457
> 
> 标签：jquery, json, forms, dynamic

我是使用 JSON 的新手。我知道这可能已经在这里被问过了，但是，我只是想咨询一下我是否在做正确的事情。

我需要为不同的页面创建一个动态表单。我需要能够为每个页面添加一个动态表单。从管理面板，我可以在页面模板中添加/编辑/删除字段——更改字段的顺序、名称、类型、值等。

所以，我所做的，我将动态表单字段存储在 json 中，对于每个页面中输入的数据，我也将其存储在 json 中。以下是存储在我的数据库中的示例 JSON 数据：

**具有 2 个字段的动态表单的 JSON 结构：**

```
{
"0":{
  "id":"511ddf15cb8ae_1", // generated using uniqid() and counter, to generate a unique id for each field
  "name":"Page Name #1",
  "type":"textfield",
  "validation":"email", 
  "require":"on",
  "value":""  //default value
},
"1":{
  "id":"511ddf15cb8ae_2",
  "name":"Field Name #2",
  "type":"checkbox",
  "validation":"none",
  "require":"on",
  "value":["item 1","item 2","item 3"]  //selection
}
} 
```

**存储输入值的 JSON：**

```
{
"511ddf15cb8ae_1":   //the field id, used as key to be able to directly access the data
  "test new data",
"511ddf15cb8ae_2":
  ["item 1","item 2"]
} 
```

我的主要问题是，是否可以使用 json 将输入的值存储在数据库中，还是应该单独存储输入的值 - db 表行。

任何想法以更好的方式做到这一点，或者这已经很好了吗？谢谢。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:01:55.233

取决于你接下来的计划:)。

如果您只打算稍后重建表单并使用输入的值填充（我相信您也在存储动态表单），那么您采用的方法非常好，因为您不需要重新构建使用复杂查询从输入值返回 json。

但是，如果您稍后对在各个字段中输入的值进行一些复杂的发现/查询，例如“特定用户在特定字段中输入特定值多少次？”，那将是乏味的。有点儿。如果您打算这样做，那么我建议您使用关系方法并将它们存储在表格中；动态表单和输入的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:03:34.960

将它作为字符串存储在 SQL 数据库中是可以的，因为你总是可以`stringify`，`parse`但我发现这非常乏味，特别是当我想做 JOIN 操作或持久表示复杂结构时。既然您已经在 J​​SON 中拥有它，为什么不使用像[MongoDB](http://docs.mongodb.org/manual/)这样的 NoSQL 持久存储机制并存储 JSON 本身。

[MongoDB 允许您以 BSON 格式保存 JSON 文档](http://www.mongodb.org)，然后对它们进行查询，这是您当前的实现所缺乏的。

事实上，您可以在他们的网站上打开交互式 MongoDB shell，并从那里使用以下方式对您的数据库进行原型设计：

```
> var page = {"name":"Page Name #1",   "type":"textfield",   "validation":"email",    "require":"on",   "value":"aValue"};
{
 "name" : "Page Name #1",
 "type" : "textfield",
 "validation" : "email",
 "require" : "on",
 "value" : "aValue"
 }
> db.pages.save(page);
"ok" 
```

从那里开始，一旦添加了所有页面，您现在就可以进行强大的查询，例如，这将找到所有文本字段类型的页面：

```
db.pages.find({"type":"textfield"}); 
```

您还可以使用 values 字段执行更复杂和更强大的查询，但我将把它留给您。

# php - PHP 替换表格标签 cellspacing=”0”

> ID：14939974
> 
> 赞同：0
> 
> 时间：2013-02-18T15:42:45.137
> 
> 标签：php, cellspacing

表格单元格间距在 html 表格标签内编码

php 5 可以在没有任何表格标签“cellspacing”的情况下设置所有表格 cellspacing="0" 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T23:57:44.653

PHP 只是生成东西（通常是 HTML，但有时是图像或其他任何东西）。在这种情况下，结果仍然只是 HTML。

但是，您可以只使用`border-spacing:0`CSS 规则。这会删除单元格之间的空间，而不会实际折叠边框，因此不会破坏您的布局。

# jira - 如何在 Greenhopper 燃尽图计算中包含子任务？

> ID：14939979
> 
> 赞同：6
> 
> 时间：2013-02-18T15:43:01.400
> 
> 标签：jira, jira-agile, burndowncharts

我们目前在“问题计数”模式下使用 Greenhopper 中的燃尽图。目前在计算燃尽时只考虑标准问题类型（错误、任务、故事）。

**问题：**在燃尽计算中是否还有考虑子任务的选项？

***示例：** 假设我们有 3 个故事和 8 个与之相关的子任务。如果我关闭一个故事，燃尽图就会受到影响。但是如果我关闭一个子任务，图表不会受到影响。*

我已经检查了项目过滤器，其中还包括子任务。但由于某种原因，它们没有在图表中考虑（这对我们来说很糟糕）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T06:22:12.750

目前它不受支持，正如您在问题中看到[的那样 Rapidboard 上的原始时间估计不是子任务的总和](https://jira.atlassian.com/browse/GHS-5653)：

> 我们不打算修改这种行为，因为原始估计的主要目的是计算速度。使用子任务估计会破坏[本答案帖子](https://answers.atlassian.com/questions/84349/rapid-board-time-estimates-with-sub-tasks?page=1#84605)中讨论的速度。
> 
> 在 GreenHopper 6.0.3 中，我们已将剩余估计值显示为 sprint 页脚的汇总。请查看[发行说明](https://confluence.atlassian.com/display/GH/GreenHopper+6.0.3+Release+Notes#GreenHopper6.0.3ReleaseNotes-EasiermanagementofRemainingEstimate)以获取更多信息。

# c++ - C/C++ 如何计算数值数据集的条纹？

> ID：14939983
> 
> 赞同：1
> 
> 时间：2013-02-18T15:43:32.627
> 
> 标签：c++, c, algorithm, math, statistics

有人知道如何使用 C/C++ 来计算数据的条纹吗？条纹的定义是与平均值有多少偏差（即运行平均一个数值数据条纹。谢谢您的帮助。

[编辑] 来自我们公司的首席软件架构师，这是对统计度量的要求。有人可以根据我们架构师对数据条纹的定义定义一个统计公式吗？-- 2013 年 2 月 19 日上午 8:00

相同的数字是连续的。1,2,3,3,3,4,5 连续 7 次。

案例 A：1,2,3,4,5,6,7,8,9,10,11,12,13 的最长连击数为 13。

案例 B：1,2,3,4,5,6,7,3,8,9,10,11,12 最长的连续为 7，第二个较小的连续为 6。

案例 C：1,2,3,4,5,6,7,1,2,3,4,5,6 最长的连续为 7，第二个较小的连续为 6。

案例 D：1,2,3,4,5,6,7,1,2,3,1,2,1 最长的连击数为 7，第二小的连击数为 3，第三小的连击数为 2

案例 E：1,2,3,4,5,6,7,6,5,4,1,2,3 最长的连续为 7，第二个较小的连续为 3。

案例 F：1,2,3,4,5,6,7,6,5,4,3,2,1 的最长条纹为 7，没有更小的条纹。

案例 A - F 按“排序最多到排序最少”的顺序排列，但都具有相同的最长条纹。使用条纹长度的平均值是不合适的：

答：平均 = 13/1 = 13

B：平均 = (7+6)/2 = 6.5

C：平均 = (7+6)/2 = 6.5

D：平均 = (7+3+2)/3 = 4

E：平均 = (7+3)/2 = 5

F：平均 = 7/1 = 7

考虑非条纹（将它们计为 1）：

答：平均 = 13/1 = 13

B：平均 = (7+6)/3 = 4.3

C：平均 = (7+6)/2 = 6.5

D：平均 = (7+3+2+1)/4 = 3.25

E：平均值 = (7+1+1+1+3)/5 = 2.6

F：平均值 = (7+1+1+1+1+1+1)/7 = 1.85

变量 R 可用于指示与特定条纹的平均值有多少偏差。根据所公开的实施例，条纹的水平不仅可以定义为距平均值的(整数*偏差)距离，还可以定义为(整数*fraction_of_deviation)距离。为此，可以使用可变 R 因子。R 因子以偏差的一小部分表示两个连续 R 水平之间的分离。通过改变 R 因子，可以根据需要对条纹进行排序。但是，连胜的“可信度”也应该考虑在内，并包含在排名机制中。条纹内的偏差是衡量数据在条纹内的交错程度的明显指标。一个好的连胜应该更少交错，或者换句话说，有更少的偏差。为此原因，一个非常高的连续性被认为是好的，即使它的偏差超过了通常的期望值。因此，虽然水平 R 对排名产生积极影响，但连续性内的偏差对其产生负面影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T02:12:43.630

抱歉，如果这不正常，但我是从图像处理的角度来看的。

我见过的用于分析散点图的更有趣的方法之一是 Tukey 提出的“图论 scagnostics”或简称为“scagnostics”（散点图诊断），后来由 Wilkinson 编写。除了“stringiness”之外，还有其他几个有趣的形状/簇标识符。

如果您的数据在 2 空间或 3 空间中，则有一些图像处理算法可以识别数据条纹，但我必须查看一些示例数据图/图像以提供任何进一步的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T14:35:13.930

根本不清楚你想从这个措施中得到什么。如果您不关心条纹内容，您可以使用条纹长度的平方和除以总长度的平方。该度量值始终介于 0 和 1 之间。如果整个序列是单个条纹，则它正好为 1，如果它主要是一个长条纹，则它会稍微小一些，如果它根本没有条纹，它会是 1/length。对于您的情况，此措施为

```
A: Average = 13²/13² = 1.0000
B: Average = (7²+6²)/13² = 0.5030
C: Average = (7²+6²)/13² = 0.5030
D: Average = (7²+3²+2²+1²)/13² = 0.3728
E: Average = (7²+1²+1²+1²+3²)/13² = 0.3609
F: Average = (7²+1+1+1+1+1+1)/13² = 0.3254 
```

# codeigniter - codeigniter - 哪些值引用实际文件，哪些引用类/函数？

> ID：14939984
> 
> 赞同：0
> 
> 时间：2013-02-18T15:43:32.917
> 
> 标签：codeigniter, model, reference, controller

我正在做一些 codeigniter 的教程，并且对一些基本的东西感到沮丧。

我有一个模型名为`math.php`

```
 <?php

class math extends CI_Model{
    public function add($val1, $val2){
        return $val1 + $val2;
    }
} 
```

该模型由名为的控制器调用`site.php`

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Site extends CI_Controller {

    public function index()
    {
        echo "Hi Internet<br> ";
        $this->addStuff();
    }

    public function addStuff()
    {
        $this->load->model("math");
        echo $this->math->add(2,2);
    }
} 
```

这完美地工作。但是为了我自己的清楚，我想重命名`math.php`为`model_math.php`

这显然打破了页面。

我的问题是，在我的控制器中，`site.php`

`$this->load->model("model_math");`和

`echo $this->model_math->add(2,2);`

哪个`model_math`引用了物理 php 文件，哪个引用了我在物理模型 php 文件中创建的类名？

我无法使用模型类名称`math`和物理 php 文件名“model_math.php”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:48:51.897

在 Codeigniter 中，您必须将类命名为与 PHP 文件名相同。如果您的 PHP 文件名为“model_math.php”并且在您的文件中有：

```
Class Math extends CI_Model 
```

我想 Codeigniter 的局限性……但是通过使用相同的约定（即*名称*_model.php；*名称*_controller.php）来命名所有模型和控制器来标准化它们并没有什么坏处。您只需将类命名为相同的名称。

# phpstorm - 如何配置 PhpStorm 以便它识别带有嵌入式 php 的 javascript

> ID：14939989
> 
> 赞同：2
> 
> 时间：2013-02-18T15:40:05.057
> 
> 标签：phpstorm

在我的框架中，我可以拥有嵌入 php 的 javascript 文件。

例如

```
$(document).ready(function(){
   alert(<?php echo $message ?>);
}); 
```

如何让 PhpStorm 检测到正确的语言，以便 javascript 和 php 获得正确的语法突出显示？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-18T16:39:57.683

3个步骤：

1.  给这样的文件自定义（例如`*.phpjs`）或复杂（`*.js.php`或`*.php.js`）文件扩展名
2.  将此类模式分配给设置中的**PHP 文件****| 文件类型**。
    如果您不想给它这样的自定义扩展名（出于任何“宗教”/您可能有的其他原因），那么您必须将完整的文件名指定为模式（如果您有另一个文件，这可能会导致问题/混乱在另一个文件夹中具有相同的文件名，即使在另一个项目中也是如此）。**请注意**——此设置是 IDE 范围的，因此会影响所有项目，因此自定义/复杂扩展是唯一*安全*的方法。
3.  **设置 | 模板数据语言**——在此处找到您的文件并将**JavaScript**分配给它（或整个文件夹，如果其中的所有文件都将被类似处理）——这将设置`JavaScript`为主要（外部）语言而不是默认 HTML。

# javascript - javascript mocha，节点异常测试用例

> ID：14939991
> 
> 赞同：0
> 
> 时间：2013-02-18T15:43:59.423
> 
> 标签：javascript, rest, testing, mocha.js

我正在编写的应用程序已注册，用户注册后他们会收到一封电子邮件，该电子邮件包含激活链接的唯一 URL，例如：

```
Welcome. Click <a href="https://api.app.com/users/{id}/activate/{token}">here</a> to activate your account. 
```

问题是，我使用 mocha 自动测试我在 Node.js 中编写的 restful JSON 应用程序（这是激活 url 上的链接）。

这种解决方案的解决方案是什么，我的意思是为用户电子邮件收件箱编写解析器对我来说似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T12:32:32.337

你应该写 3 个测试

*   在您的系统中插入激活令牌
*   激活 API 在调用时正常工作
*   在将 URL 插入邮件模板之前构建 URL 的组件（并依靠模板引擎来保存此正确数据）

单独运行此测试，不要尝试运行完整的历史记录。组件之间的更少耦合意味着更好的质量。一方面测试您的 API，另一方面测试您的邮件生成器。

# jquery - JQuery Cookies 设置过期时间

> ID：14939994
> 
> 赞同：13
> 
> 时间：2013-02-18T15:44:09.080
> 
> 标签：jquery, cookies

我有这个：

```
if (typeof options.expires == 'number') {
date = new Date();
date.setTime(date.getTime() + (options.expires * 5 * 1000));
} else {
date = options.expires;
}
expires = '; expires=' + date.toUTCString(); 
```

如何让 cookie 在 10 分钟后过期？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-18T15:45:37.000

```
 var date = new Date();
 var m = 10;
 date.setTime(date.getTime() + (m * 60 * 1000));
 $.cookie("cookie", "value", { expires: date }); 
```

或者，您可以使用一个函数：

```
function ExpireCookie(minutes) {
 var date = new Date();
 var m = minutes;
 date.setTime(date.getTime() + (m * 60 * 1000));
 $.cookie("cookie", "value", { expires: date });
} 
```

然后做`ExpireCookie(10);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T15:49:56.530

***`10 minutes is 10 * 60 * 1000 milliseconds.`***

```
var date = new Date();
date.setTime(date.getTime() + (10 * 60 * 1000));
$.cookie("example", "foo", { expires: date }); 
```

# google-maps - 如何使用WebDriver在具有谷歌地图的页面上单击X，Y坐标？

> ID：14939995
> 
> 赞同：1
> 
> 时间：2013-02-18T15:44:11.977
> 
> 标签：google-maps, webdriver, selenium-webdriver

我想使用 webDriver 在 85% 的空间中单击具有谷歌地图的页面的随机 X、Y 元素。是否有 webdriver 提供的任何功能。谷歌告诉我这个 [解决方案](https://stackoverflow.com/questions/4305590/selenium-2-0-webdriver-clickat-method-unsupported)。但是***clickAt()***需要一个元素，但我只是想点击页面。AWT的***Robot API***有什么帮助吗。这似乎是 webdriver 的基本功能，但由于缺乏经验，我找不到任何可行的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T09:13:37.587

我肯定知道一个可行的解决方案，但在安装时需要小心（至少在 Linux 上）。一个`SikuliFirefoxDriver`利用 webdriver API 和[Sikuli的出色 OpenCV 工具的存在](http://code.google.com/p/sikuli-api/)

这允许您在需要时使用 webdriver，并在需要时添加 Sikuli 图像识别和单击。非常强大的自动化谷歌地图

[你可以在这里](http://code.google.com/p/sikuli-api/wiki/SikuliWebDriver)找到一个例子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T16:23:20.513

你试过[`Action`](http://code.google.com/p/selenium/wiki/AdvancedUserInteractions)界面吗？

```
int xOffset, yOffset;

Actions actions = new Actions(this.drivy);

Action move = actions.moveByOffset(xOffset, yOffset).build();
move.perform(); 
```

唯一的问题是，偏移量是相对于最后一个光标位置的。

请问你需要那个干什么？

我不想使用它（也不推荐使用它）。

如果您的浏览器大小发生变化怎么办？

如果你改变你的分辨率怎么办？

**编辑：**

也许这也可以帮助你：[谷歌地图的硒测试](https://stackoverflow.com/q/5779102/1300626)

# apache - 托管服务器中的最佳配置 defaultCharSet 是什么？

> ID：14939997
> 
> 赞同：0
> 
> 时间：2013-02-18T15:44:15.753
> 
> 标签：apache, character-encoding, webserver, cloud-hosting

在我的托管中，我的客户使用了不同的字符集（utf-8、iso-8859-1 等）。

如果我这样配置：

```
AddDefaultCharset "utf-8" 
```

另一个客户（使用 utf-8 以外的字符集）遇到了字符集问题。他们的网页显示不好。

如果我这样配置：

```
AddDefaultCharset "iso-8859-1" 
```

另一个客户有问题。

什么是最好的解决方案？为什么所有浏览器都没有在 html 头标签中看到正确的字符集？

# c# - Outlook VSTO - 当我调用约会.Display() 时如何显示“邀请与会者”文本框？

> ID：14939999
> 
> 赞同：2
> 
> 时间：2013-02-18T15:44:21.330
> 
> 标签：c#, outlook, vsto, outlook-2010, appointment

我有以下代码来弹出一个 Outlook 应用程序。它工作得很好，除非我点击“邀请与会者”，否则我无法在弹出窗口中看到实际的与会者文本框。当我单击 appt 项目上的该按钮时，它确实显示了我在下面填充的人员列表。

```
 public void BookAppt(List<string> rooms, DateTime startTime, DateTime endTime)
    {
        var PacktAppointmentItem = (Microsoft.Office.Interop.Outlook.AppointmentItem)Globals.ThisAddIn.Application.CreateItem(Microsoft.Office.Interop.Outlook.OlItemType.olAppointmentItem);
        PacktAppointmentItem.Subject = "Test Meeting";
        PacktAppointmentItem.Location = "My Room";
        PacktAppointmentItem.Start = startTime;
        PacktAppointmentItem.End = endTime;
        PacktAppointmentItem.Body = "Test Meeting";
        PacktAppointmentItem.RequiredAttendees = String.Join(";", rooms);
        PacktAppointmentItem.Display(true);
    } 
```

有什么方法可以自动显示与会者的文本框而无需单击“邀请与会者”按钮？另外，无论如何以编程方式调用“检查名称”以便解决与会者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T01:22:39.983

我认为你想要的是一个会议项目，而不是一个约会项目。您不能直接创建 MeetingItem，但您几乎无处不在：只需在代码中添加以下行：

```
PacktAppointmentItem.MeetingStatus = Outlook.OlMeetingStatus.olMeeting; 
```

所以你的最终代码应该像

```
var PacktAppointmentItem = (Microsoft.Office.Interop.Outlook.AppointmentItem)Globals.ThisAddIn.Application.CreateItem(Microsoft.Office.Interop.Outlook.OlItemType.olAppointmentItem);
PacktAppointmentItem.Subject = "Test Meeting";
PacktAppointmentItem.Location = "My Room";
PacktAppointmentItem.Start = DateTime.Now;
PacktAppointmentItem.MeetingStatus = Outlook.OlMeetingStatus.olMeeting;
PacktAppointmentItem.End = DateTime.Now.AddHours(1.0);
PacktAppointmentItem.Body = "Test Meeting";
PacktAppointmentItem.RequiredAttendees = String.Join(";", rooms);
PacktAppointmentItem.Display(true); 
```

快速背景：来自微软： http: [//msdn.microsoft.com/en-us/library/office/microsoft.office.interop.outlook.meetingitem (v=office.14).aspx](http://msdn.microsoft.com/en-us/library/office/microsoft.office.interop.outlook.meetingitem(v=office.14).aspx)

> 与其他 Microsoft Outlook 对象不同，您不能创建此 [例如 MeetingItem] 对象。当您将 AppointmentItem 对象的 MeetingStatus 属性设置为 olMeeting 并将其发送给一个或多个用户时，它会自动创建。他们在收件箱中将其作为 MeetingItem 接收。