# StackOverflow 问答 12552000-12552999

# objective-c - Objective-C：将特定的 NSDictionary 值复制到另一个 NSDictionary

> ID：12552000
> 
> 赞同：1
> 
> 时间：2012-09-23T11:35:26.537
> 
> 标签：objective-c, xcode, nsdictionary, copying

我有一个字典网络，它是字典的字典
我试图从网络复制特定条目到比较地址

```
- ( NSDictionary * ) compareAddr
{
    NSMutableDictionary *result = [[NSMutableDictionary alloc] init];

    for (id key in networks)
    {
        NSMutableDictionary *result = [[NSMutableDictionary alloc] initWithObjectsAndKeys: @\    [[networks objectForKey: key] objectForKey:@"RSSI"]\, @\key\];
    }                                
    return [NSDictionary ? ? ? :result];
} 
```

但这对我不起作用！

可能吗 ？： 我究竟做错了什么 ？

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:45:49.543

从您的问题中我可以理解，我认为您只需要以这种方式在结果数组中插入所需的提取对象和键：

```
- ( NSDictionary * ) compareAddr
{
    NSMutableDictionary *result = [[NSMutableDictionary alloc] init];

    for (id key in networks)
    {
        [result setObject:[[networks objectForKey: key] objectForKey:@"RSSI"]  forKey:key];
    }                                
    return result;
} 
```

# fortran - 如何编译 Fortran 代码？

> ID：12552002
> 
> 赞同：1
> 
> 时间：2012-09-23T11:35:46.243
> 
> 标签：fortran

我写了 Fortran 代码，我想编译它们。抱歉，我不知道有关此问题的更多信息，因为这是我朋友的问题之一。是否有用于编译 Fortran 代码的特定程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T11:43:05.613

您可以通过键入类似于以下内容的行来编译 fortran 程序：

```
f77 -o myprogram myprogram.f 
```

了解这里发生的事情很重要：

`f77`是 的名称`Fortran compiler`。您的编译器可能有不同的名称，例如`g77, ifc. or pgf77`. 该`-o`选项告诉编译器下一个单词（此处为 myprogram）将是程序二进制版本的名称。如果省略此选项，大多数系统将使用默认名称`a.out`无论您的程序名称如何，都适用于二进制版本。可以使用此默认值，但使用更有意义的名称通常会有所帮助。二进制文件通常被称为可执行文件，因为计算机可以运行（执行）它。myprogram.f 是包含程序源代码的文件的名称。源代码是您实际编辑和键入的指令文件。您的源文件可以命名为 myprogram.f 以外的名称，例如 homework1.f。或其他一些描述性的名称。在许多系统上，源文件的名称必须以 结尾，`suffix .f`否则编译器很容易变得不高兴。要运行该程序，只需键入可执行文件的名称：

```
myprogram 
```

你也可以[在这里](http://www.fortran.gantep.edu.tr/compiling-g95-basic-guide.html)找到更多关于它的信息

# amazon-ec2 - 未显示附加卷

> ID：12552008
> 
> 赞同：3
> 
> 时间：2012-09-23T11:36:39.073
> 
> 标签：amazon-ec2

我有一个实例，我需要为其附加并安装一个卷。我有一些不成功的尝试，最后，我卸载了该卷。

`sudo df -h`然后，在从公共快照附加卷之前，我执行了以下命令以了解卷。我有：

```
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1      8.0G  989M  6.7G  13% /
udev             17G  8.0K   17G   1% /dev
tmpfs           6.7G  164K  6.7G   1% /run
none            5.0M     0  5.0M   0% /run/lock
none             17G     0   17G   0% /run/shm
/dev/xvdb       827G  201M  785G   1% /mnt 
```

然后，我将一个卷（我从公开可用的快照创建）附加到我的实例。看： ![在此处输入图像描述](../Images/0afd2492269abb6feb3f59f4f9d8fdca.png)

然后，我确保卷的状态附加到我的实例。我再次执行命令。在附加卷之前，我得到了相同的先前输出。

```
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1      8.0G  989M  6.7G  13% /
udev             17G  8.0K   17G   1% /dev
tmpfs           6.7G  172K  6.7G   1% /run
none            5.0M     0  5.0M   0% /run/lock
none             17G     0   17G   0% /run/shm
/dev/xvdb       827G  201M  785G   1% /mnt 
```

我这样做的原因是我需要挂载新附加的卷。如果您需要有关我的问题的更多信息，这篇文章中有几次不成功的尝试：[如何在 Linux Ubuntu 机器中搜索文件或目录](https://stackoverflow.com/questions/12547409/how-to-search-for-a-file-or-directory-in-linux-ubuntu-machine)

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T03:56:05.760

我在 Unix 系统管理员方面仍然相当缺乏经验（足够危险？），但我确实遇到了这个问题 - 根据 AWS 控制台，卷应该附加在 /dev/sdj，但事实并非如此。

然后我注意到我以前的卷（列为 /dev/sda1）也不存在，而是被称为 /dev/xvda1。后来进行了一点点模式识别，我意识到我的卷列在 xvdj 下

```
sudo mount /dev/xvdj /path/to/your/directory 
```

...安装的卷是我要找的卷。

也许有人可以在评论中向我解释为什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T11:40:17.313

附加卷后，您仍然需要安装它：

```
mount -t <fs_type> /dev/xvdf /path/to/your/directory 
```

# java - Android缓存实例

> ID：12552009
> 
> 赞同：2
> 
> 时间：2012-09-23T11:36:39.103
> 
> 标签：java, android, performance, instance

在 a 的性能关键`onDraw()`方法中`View`，将实例存储在变量中并稍后重用它会更好，还是应该将我的实例称为`this`？

前任：

```
public class ScheduleListView extends ListView {

    private Paint paint = new Paint();

    public ScheduleListView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        paint.setColor(Color.GRAY);
        paint.setAlpha(100);
        paint.setColor(Color.parseColor("#47B3EA"));
        canvas.drawRect(this.getLeft(), 10, this.getRight(), 10, paint);
        super.onDraw(canvas);
        canvas.restore();
    }

} 
```

和`this`中提到的`this.getRight()`，`this.getLeft()`如果我进行以下修改，我是否会有任何性能改进：

```
private ScheduleListView scheduleListView  = this;

... ...

@Override
protected void onDraw(Canvas canvas) {
    ....
    //refer to my instance using scheduleListView instead of this
    scheduleListView.getLeft() 
    ....
} 
```

这是好习惯吗？这会有任何性能提升吗？如果没有，这样做的更好方法是什么？

**PS：我问这个是因为在 jQuery(javascript) 中，如果我要多次使用一个对象，我会将对象缓存在一个变量**中，真的不知道这对 Java 是否有帮助......

前任：

```
var myDiv = $(".myDiv");
myDiv.html();//do stuff 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:49:19.600

不，那不会有任何改善。

您可以从代码中做出的最大改进是将对您的绘画对象的调用移动到视图的构造函数：

```
public ScheduleListView(Context context, AttributeSet attrs) {
    super(context, attrs);
    paint.setColor(Color.GRAY);
    paint.setAlpha(100);
    paint.setColor(Color.parseColor("#47B3EA"));

}

@Override
protected void onDraw(Canvas canvas) {
    canvas.drawRect(this.getLeft(), 10, this.getRight(), 10, paint);
    super.onDraw(canvas);
    canvas.restore();
} 
```

# php - 优化多语言站点，每种语言的地址相同

> ID：12552010
> 
> 赞同：2
> 
> 时间：2012-09-23T11:36:40.570
> 
> 标签：php

当您根据访问者的浏览器语言在 google 上搜索我的网站时，如何更改显示的标题和描述？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:43:59.920

您可以使用

```
$browserlocale = locale_accept_from_http( $_SERVER['HTTP_ACCEPT_LANGUAGE'] );
$language = substr($browserlocale, 2); 
```

从浏览器中获取*首选语言。*

话虽如此，从那里您可以使用[gettext 扩展](http://php.net/manual/en/book.gettext.php)来本地化您的应用程序。有一个用于翻译 gettext 字符串的[不错的编辑器。](http://www.poedit.net/)

你必须告诉谷歌你的网站是多语言的。您可以通过[向 google bot 提供 sitemap.xml 来](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156184)做到这一点。

# asp.net - ReportViewer 中的类似 DataBound 的事件

> ID：12552014
> 
> 赞同：0
> 
> 时间：2012-09-23T11:37:09.687
> 
> 标签：asp.net, reporting-services, reportviewer

有什么方法可以在填充后访问 ReportViewer DataSet？

ReportViewer中没有**DataBound事件，因此我可以访问数据。**

我想要实现的是：

1- 在提交到报告之前访问数据...
2- 获取例如：`dataset.Tables(0).Rows(0).Item("Price")`
3- 对其进行一些操作：`Dim newPrice = DoSomething(Price)`
4- 将`newPrice`数据分配给报告参数。
5-将**参数值**分配给报告内的特定**文本框**。

谢谢。

# ios - 如何在顶部左侧有 UIPopOverController 的箭头？

> ID：12552016
> 
> 赞同：0
> 
> 时间：2012-09-23T11:37:20.507
> 
> 标签：ios, ipad, uipopovercontroller

我有一个 UIPopover 正在显示。它直接位于按钮下方，箭头指向按钮。

这个箭头在弹出框宽度上居中对齐，我可以让它稍微靠近弹出框的左上角吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:14:25.543

始终以`UIPopOverController`您呈现它的 UI 元素为中心，假设它完全适合。如果您的按钮在屏幕左侧，而您的控制器无法放在其下方，那么只有控制器位于右侧，而箭头才会出现在左侧。

给它，你可以`popoverLayoutMargins`在视图的左边设置一个很大的边距（如果你不知道确切的位置，你需要一些试验和错误）将弹出框本身向右移动，因此箭头会出现顶部的左侧。

我假设您正在使用`presentPopoverFromRect:myRect inView:self.view permittedArrowDirections: UIPopoverArrowDirectionUp animated:YES`.

# perl - 如何（继续）学习 Moose 以“公平”地使用它？

> ID：12552027
> 
> 赞同：16
> 
> 时间：2012-09-23T11:38:34.573
> 
> 标签：perl, moose

虽然我不是 Perl 大师，但我使用 Perl 并且可以以“古老”的方式编写面向对象的程序。

现在我想学习Moose。我已经 (so-as) 咀嚼了基本文档，我的第一个 Moose 和角色已经开始工作了，但我离理解 Moose 的实际工作方式还有很长的路要走。

**问题 1：了解 Moose 如何编写“相当不错”的程序是绝对必要的吗？**

老实说，我不太了解旧的对象系统。我隐约记得读过的东西是它实际上是对数据结构的引用，但我从未深入探索过。我知道如何以及何时需要使用等就足够了`bless`，`autoload`而且事情很简单。也许我的一些旧模块可以更有效地编写。但对我来说，它们工作得很好。

这和Moose一样吗？还是有人用 Moose 编写“足够好”的程序需要了解它“内部”是如何工作的？

出现这个问题的原因如下：

METACPAN 中有几十个模块，可以帮助更轻松、更简单地编写 Moose 对象。

随机示例：

*   [https://metacpan.org/module/MooseX::StrictConstructor](https://metacpan.org/module/MooseX::StrictConstructor)（好的，容易理解）
*   [https://metacpan.org/module/MooseX::HasDefaults](https://metacpan.org/module/MooseX::HasDefaults)（好的，简单）
*   [https://metacpan.org/module/Method::Signatures::Simple](https://metacpan.org/module/Method::Signatures::Simple)（凹凸！不知道什么是签名，这个模块是“简单”的。）
*   [https://metacpan.org/module/MooseX::AlwaysCoerce](https://metacpan.org/module/MooseX::AlwaysCoerce) /hmm.... :(/
*   [https://metacpan.org/module/MooseX::LazyRequire](https://metacpan.org/module/MooseX::LazyRequire) /hmm... :(/
*   [https://metacpan.org/module/MooseX::AbstractMethod](https://metacpan.org/module/MooseX::AbstractMethod)
*   [https://metacpan.org/module/MooseX::AttributeShortcuts](https://metacpan.org/module/MooseX::AttributeShortcuts)（常用属性选项的简写 - 所以它可能是一个助手 - 但是，学习真的有用吗？）

还有更多（不想在这里引用另外 10-20 个模块）

现在主要问题是：

是否有任何包含以下说明、示例和建议（良好做法）的好书：

*   **建议从上面列出的**模块中从一开始就常规使用****哪些**模块？**

 **上面的模块肯定不是开发出来的，只是因为作者没有做什么。当然，它们是有用且有帮助的。但是学习（阅读：试图理解）数十个不同的模块（尤其是那些使用 Moose 内部组件的模块）是一个极其漫长的过程。另一方面，如果不使用它们，我的程序将变得不必要地复杂，我将处理已经解决的问题。

Moose 应该是（并且可能是）一个革命性的系统。只有我开始迷路了。

**编辑**：我刚找到[驯鹿](https://metacpan.org/module/Reindeer)。可能这个模块是对这个问题的部分回答： **从一开始（或大部分时间）什么模块是有用的**

PS：我不确定这个问题是否适合SO。如果没有，请将其移至某处或将其关闭。我在这里问它是因为 SO-perl 社区是一个非常有帮助的地方，我不知道如何继续学习 Moose。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-24T02:27:53.257

Ricardo Signes 的“ [Moose is Perl: A Guide to the New Revolution](http://www.oscon.com/oscon2011/public/schedule/detail/17828) ”包含许多有价值的信息和建议。在此处获取 PDF：[http ://rjbs.manxome.org/talks/moose/](http://rjbs.manxome.org/talks/moose/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T12:08:51.620

回答你的第一个问题：不知道内部是如何工作的就是抽象的全部意义所在。虽然了解内部情况有时会让您更好地了解为什么事情会以它们的方式工作（对于像 Moose 这样复杂的东西更是如此），但没有它您也可以编写代码。当您遇到问题时，您可能会更深入地了解问题所在。

第二个问题，如何学习 Moose，对于 Stack Overflow 来说确实不太合适。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T13:18:33.873

谷歌“驼鹿在飞”。你会在那里找到你需要的一切**

# jquery - jQuery - 尝试将 div 显示为弹出窗口在页面布局中显示 div

> ID：12552028
> 
> 赞同：0
> 
> 时间：2012-09-23T11:38:38.067
> 
> 标签：jquery

我试图在我的 jQuery 中做这样的事情：

```
$("#loading").show(); 
```

这是`#loading`我`display:none`在屏幕底部的 div：

```
<div id="loading" style="display:none; ">
  <p><img src="img/ajax-loader.gif" /> Please Wait</p>
</div> 
```

我意识到这个`.show()`功能只是让事情出现，但是我怎么能把它显示在屏幕的内容上，因为那个 div 只有一个`.gif`微调器图标，向用户发出等待的信号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T11:44:24.850

我这样做的一种方法是创建一个对话框。

```
 $("#loading").dialog({
                    height: 140,  
                    width:160,
                    modal: true,
                    resizable : false, 
                    draggable : false,
                    closeOnEscape: false   //So that dont close on escape
                   });
$(".ui-dialog-titlebar").hide();   //No title bar
         $(".ui-dialog").css("padding","0px");  //Remove extra spacing 
```

并在 ajax 调用结束时将其删除。

**其他方法：：**

1.  [使用 JQUERY BLOCK UI 插件](http://www.malsup.com/jquery/block/)
2.  [使用 CSS 固定位置](https://stackoverflow.com/a/3674753/1085285)

# c# - “存在显式转换” - LINQ

> ID：12552029
> 
> 赞同：1
> 
> 时间：2012-09-23T11:38:54.927
> 
> 标签：c#, linq, c#-4.0, compiler-errors, enumerable

**迄今为止的故事......**

我现在正在学习 MVC(4)。我已经编写了充满**控制器膨胀**的应用程序，所以我决定开始添加存储库/UnitOfWork/服务层等。

所以我决定创建一个通用存储库来封装一般的 CRUD 和记录搜索功能。

**“停止喋喋不休，你有什么问题”我听到你说**

我想我会创建一个**Get**方法，它需要两个 Lambda 参数：

1.  filter = 选择/取消选择记录逻辑
2.  singleOrDefault = 根据参数提供一条记录或默认值。

以下是包含 get 方法的精简**Generic Repository代码：**

```
 public class GenericRepository<TEntity> :
    IRepository<TEntity> where TEntity : class 
{

    internal AccountsContext context;
    internal DbSet<TEntity> dbSet;

    /// <summary>
    /// Default Constructor.
    /// </summary>
    /// <param name="context"></param>
    public GenericRepository(AccountsContext context)
    {
        this.context = context;
        this.dbSet = context.Set<TEntity>();
    }

    public virtual IEnumerable<TEntity> Get(Expression<Func<TEntity, bool>> filter, 
        Expression<Func<TEntity, bool>> singleOrDefault)
    {
        IQueryable<TEntity> query = dbSet;

        if (filter != null && singleOrDefault == null)
        {
            query = query.Where(filter);
        }

        if (filter != null && singleOrDefault != null)
        {
            query = query.Where(filter)
                         .SingleOrDefault(singleOrDefault);
        }

        return query.ToList();
    } 
```

现在，当我尝试构建这个时，下面的编译器：

**错误 1 ​​无法将类型“TEntity”隐式转换为“System.Linq.IQueryable”。存在显式转换（您是否缺少演员表？） G:\Accountable\Accountable\DataAccessLayer\GenericRepository.cs 90 30 Accountable**

错误位于**.SingleOrDefault(singleOrDefault)**行。

为了您的方便，我提供了我使用的扩展方法签名：

```
 public static IQueryable<TSource> Where<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate);
    public static TSource SingleOrDefault<TSource>(this IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate); 
```

我多年来一直在盯着这个问题试图解决它，任何帮助将不胜感激。

**供参考**

在我臃肿的代码中，我的控制器中有以下类型的代码，我想用我的存储库方法替换它们，这就是我试图复制的内容。

```
 LedgerCustomer LedgerCustomer = db.LedgerCustomers.Where(l => l.RecordStatus != "X").SingleOrDefault(l => l.id == id);

 CurrencyType currencyType = db.CurrencyTypes.Where(c => c.RecordStatus != "X")
                .SingleOrDefault(c => c.id == LedgerCustomer.CurrencyTypeId); 
```

**问题是：**

A）我使用正确的 LINQ 方法吗？我臃肿的代码中的上述查询是：

***选择 RecordStatus 不等于 X（逻辑删除）且 id 等于特定 id 的 Ledger customer。***

因为 LedgerCustomer PER id 应该只有一条记录（因为它们是唯一的，所以我使用 SingleOrDefault 和 Where 来取消选择任何逻辑删除的 LedgerCustomer。

B）有关编译器错误的帮助会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:45:12.530

问题出在（如您所料）就行了；

```
query = query.Where(filter).SingleOrDefault(singleOrDefault); 
```

`query`是一个 IQueryable，所以`Where(filter).SingleOrDefault(singleOrDefault)`在它上面使用是可以的。

问题在于您试图**将返回的结果分配`SingleOrDefault`给`query`**.
`SingleOrDefault`不返回 IQueryable，而是仅返回`TEntity`.

# ios - 设备方向期间阴影出错

> ID：12552033
> 
> 赞同：2
> 
> 时间：2012-09-23T11:39:16.990
> 
> 标签：ios, rotation, calayer

我正在向视图添加阴影（包括 shadowPath 以便性能更好），如下所示：

```
CALayer *layer=aView.layer;
layer.shadowColor=[UIColor blackColor].CGColor;
layer.shadowOpacity=0.8f;
layer.shadowOffset=CGSizeMake(4.0f,4.0f);
layer.shadowRadius=6.0f;
layer.masksToBounds=NO;
layer.shouldRasterize=YES;
layer.shadowPath=[UIBezierPath bezierPathWithRect:aView.bounds].CGPath; 
```

但是当设备旋转并且视图框架发生变化时，阴影会出错（偏移很远等）

我尝试在 layoutSubviews 方法中重置阴影，但在旋转过程中，您可以看到阴影在屏幕上移动。

在旋转过程中处理阴影路径的正确方法是什么？

（作为最后的手段，我要移除阴影，然后在旋转后将其放回原处，但它很笨重，然后必须在其控制器完成设备方向时告知我的视图：

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation 
```

有没有更好的方法让 VIEW 可以知道旋转已经完成？）

# php - 将一段文本保存到mysql

> ID：12552035
> 
> 赞同：4
> 
> 时间：2012-09-23T11:39:40.537
> 
> 标签：php, mysql

我正在使用 php 和 mysql 做一个项目（我是新手），现在我必须将一段文本存储到我的数据库中（在一个表中，一个列中）。

我在创建表格时尝试过`"varchar(5000)"`，但它不允许我。所以请给我一个解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:42:40.887

你的 mysql 字段类型应该

```
TEXT or BLOB 
```

这里 mysql 链接提供了有关数据类型的更多信息

[http://dev.mysql.com/doc/refman/5.0/en/blob.html](http://dev.mysql.com/doc/refman/5.0/en/blob.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T11:40:59.320

> 在 MySQL 5.0.3 及更高版本中，大于 255 的 CHAR 长度是非法的，并且失败并出现错误

利用`text`

```
create table t (long_field text); 
```

`text`最多可存储 65,535 个字符。

# jquery - 每帧jquery函数

> ID：12552037
> 
> 赞同：0
> 
> 时间：2012-09-23T11:39:45.190
> 
> 标签：jquery, image, html

我正在尝试使用 jQuery 进行“实时”图像预览，但现在我只有这个想法。所以这个想法是有一个 div(100px/100px) 和一个输入表单，当你把链接放在那里以在 div 中将图像“缩小”到 100px/100px 时可视化。但是如果用户不完全复制链接并开始要键入它，代码应检查链接是否正确显示图像（例如 .../image.jpg），然后显示它。我可能会制作这个 div 来可视化带有 .attr 外部链接的图像，但整个事情对我来说很难。如果有人想提供帮助，欢迎您:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:31:15.517

简单的方法并不复杂，只有一个文本框，一个占位符和一些jQuery代码。

假设这是文本框：

```
<input type="text" id="txtImagePreview" /> 
```

为预览本身提供这样的容器：

```
<div id="ImagePlaceHolder"><span class="error">Invalid image URL</span></div> 
```

最后这是所需的 jQuery 代码：

```
$(document).ready(function() {
    var timer = 0;
    $("#ImagePlaceHolder .error").hide();
    var oPreviewImage = $("<img />");
    oPreviewImage.bind("error", function() {
        $(this).hide();
        $(this).parent().find(".error").show();
    });
    $("#ImagePlaceHolder").append(oPreviewImage);
    oPreviewImage.hide();
    $("#txtImagePreview").bind("keyup paste", function() {
        window.clearTimeout(timer);
        var txtPreview = $(this);
        timer = window.setTimeout(function() {
            $("#ImagePlaceHolder").find(".error").hide();
            var imageURL = txtPreview.val();
            oPreviewImage.attr("src", imageURL);
            oPreviewImage.show();
        }, 500);
    });
});​ 
```

[现场测试用例](http://jsfiddle.net/v6EPJ/)。

请注意，在 URL 中检查“.jpg”是没有意义的，许多图像 URL 没有任何扩展名，例如您的 gravatar 是`http://www.gravatar.com/avatar/b4a2d7e5c786e61fab787097b2d4f27b?s=32&d=identicon&r=PG`您所看到的，仅通过 URL 无法判断这是否是图像。

逻辑很简单：将给定的 URL 分配到`<img>`占位符中并将其显示在占位符中。如果图像对象`onerror`触发，则表示图像无效，将其隐藏并可选择显示自定义友好消息。

使用定时器有两个原因：

*   事件发生后新文本不可用`paste`，因此获取新值的唯一方法是稍等片刻。

*   当用户打字时，没有必要在他快速打字时输入每个字符后分配 - 让他先完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T11:48:01.953

[http://cssglobe.com/easyest-tooltip-and-image-preview-using-jquery/](http://cssglobe.com/easiest-tooltip-and-image-preview-using-jquery/)

你检查过上面的链接吗

# c# - 将字符串属性限制为一组字符串值的最佳方法

> ID：12552038
> 
> 赞同：0
> 
> 时间：2012-09-23T11:39:54.723
> 
> 标签：c#, properties

我想以与使用枚举相同的方式使用一个小字符串数组。我想

1.  将可能的属性值限制为这些预设选项
2.  让智能显示这些选项
3.  与我项目中的其他对象共享此“OptionList”

**这是我目前拥有的：**

```
public enum StatusOptions
{
        OptionOk = 1, OptionDisabled = 0
}

public class User()
{
        public StatusOptions Status { get; set; }
} 
```

**这是我想做的-但不能因为枚举仅限于 int**

```
public string[] StatusOptions
{
        "ok", "disabled"
}

public class User()
{
        public StatusOptions Status { get; set; }
} 
```

**这样做的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T11:42:59.480

您可以使用`DescriptionAttribute`枚举值——当您需要获取字符串时，您可以使用[反射来检索此属性的值](https://stackoverflow.com/questions/695730/how-to-access-the-description-attribute-on-either-a-property-or-a-const-in-c)。

```
public enum StatusOptions
{
        [Decription("ok")]
        OptionOk = 1, 
        [Decription("disabled")]
        OptionDisabled = 0
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T11:49:56.383

请参阅此[C# 字符串枚举](https://stackoverflow.com/questions/424366/c-sharp-string-enums)

这应该满足您的大多数条件：

```
public sealed class StatusOptions {

    private readonly int value;
    public int Value
    {
     get{ return value;}
    }

    private readonly string desc;
    public string Description
    {
     get{ return desc;}
    }

    public static readonly StatusOptions OptionDisabled  = new StatusOptions (0,"Disabled");
    public static readonly StatusOptions OptionOk   = new StatusOptions (1, "Ok");

    private StatusOptions(int value, string desc){
        this.value = value;
            this.Description = desc;
    }

} 
```

用法：

```
StatusOptions s1 = StatusOptions.OptionOk;
int val = s1.Value;
string desc = s1.Description; 
```

# jquery - jQuery .slideDown() .hide() .show() 在 iPhone (Safari Mobile) 上不起作用

> ID：12552042
> 
> 赞同：4
> 
> 时间：2012-09-23T11:40:26.743
> 
> 标签：jquery, iphone, ios, jquery-mobile, mobile-safari

我在移动网站上遇到了 jQuery slideDown()、show()、hide() 功能的问题。该功能适用​​于 Safari、Chrome 和 FF 的桌面版本。它也适用于用户代理设置为 iPhone 的 Safari。但是，当加载页面 iPhone (Safari) 时，该功能不起作用……当您选择应该切换显示/隐藏的链接时，没有任何反应（没有错误）。该网站使用以下版本的 jQuery 和 jQuery 移动版：

```
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script> 
```

下面是脚本中引用的 HTML 示例以及 jQuery 脚本：

[HTML 示例]

```
<div id="body" class="body-content default-copy">
    Sed eget vehicula dui. Ut feugiat, augue ac ullamcorper varius, tellus nunc aliquam...
    <br>
    <p class="body-content-more default-copy-hidden-more" style="float: right; width: 150px;
        text-align: right; text-decoration: none;">
        <a href="#" class="see_more" style="text-decoration: none;">&gt; See More</a></p>
    <br>
</div>
<div id="body" class="body-content default-copy-full" style="display: none;">
    Sed eget vehicula dui. Ut feugiat, augue ac ullamcorper varius, tellus nunc aliquam
    metus, sed cursus magna felis vel enim. Maecenas elementum, odio eget gravida suscipit,
    felis diam aliquam magna, ut vestibulum augue magna in tortor. Sed nibh justo, iaculis
    ac lacinia non, pellentesque eu erat. Nam mollis, urna at gravida sodales, felis
    nisl hendrerit velit, non ornare sapien purus ut orci. Donec nec augue libero, eu
    tincidunt ipsum. Pellentesque at lacus augue, et egestas enim. Quisque ac dui mi,
    et eleifend nulla. Integer quis elit eget nisl fermentum blandit at in eros. Vestibulum
    a est nisl. Maecenas eget nisl arcu, quis tincidunt risus. Aliquam erat volutpat.
    Nullam lacinia venenatis libero, non imperdiet turpis vestibulum eget. Donec fermentum
    ullamcorper elementum.<br>
    <p class="body-content-more default-copy-hidden-less" style="float: right; width: 150px;
        text-align: right; text-decoration: none;">
        <a href="#" class="see_less" style="text-decoration: none;">&gt; See Less</a></p>
    <br>
</div> 
```

​</p>

[jQuery脚本]

```
$(document).ready(function () {

    $('.see_more').click(function () {

        //divs to hide
        $(".body-content.default-copy").hide();
        $("p.body-content-more.default-copy-hidden-more").hide();

        //divs to show
        $(".body-content.default-copy-full").slideDown(500); 
        $("p.body-content-more.default-copy-hidden-less").show();

    });

    $('.see_less').click(function () {

        //divs to hide
        $(".body-content.default-copy-full").hide();
        $("p.body-content-more.default-copy-hidden-less").hide();

        //divs to show
        $(".body-content.default-copy").slideDown(500);
        $("p.body-content-more.default-copy-hidden-more").show();

    });

});​ 
```

如果有帮助，这里还有一个 jsfiddle 链接：http: [//jsfiddle.net/GwfJ8/](http://jsfiddle.net/GwfJ8/)

有人遇到过这个问题或有什么建议吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T08:44:16.777

感谢 Kiran & sachin kulkarni 抽出时间来看看这个和你的回复。该问题与 jQuery Mobile 的 Ajax 导航选项有关。它默认启用，并导致我的脚本（和其他一些功能）出现问题。显然这是一个常见问题，经验丰富的 jQuery 移动开发人员通常首先禁用此选项。添加以下代码：

```
<script type="text/javascript"> 
    $(document).bind("mobileinit", function () {
        // jQuery Mobile's Ajax navigation does not work in all cases (e.g.,
        // when navigating from a mobile to a non-mobile page), especially when going back, hence disabling it.
        $.extend($.mobile, {
            ajaxEnabled: false
        });
    }); 
</script> 
```

...在 jQuery 移动脚本之前：

```
<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script> 
```

... 禁用 Ajax 导航。禁用 Ajax 导航后，问题得到解决……我在此处发布的原始脚本没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T17:14:18.800

您的代码的一个问题是您正在使用 $(document).ready() ，根据此不应该使用它：http: [//jquerymobile.com/test/docs/api/events.html](http://jquerymobile.com/test/docs/api/events.html)。

`Use $(document).bind('pageinit'), not $(document).ready()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T06:21:35.053

您可以尝试附加一个事件处理程序来单击选择器的事件（'.see_less' / '.see_more'）。

这是代码。

```
$(".see_more").live("click", function(){
        //divs to hide
        $(".body-content.default-copy").hide();
        $("p.body-content-more.default-copy-hidden-more").hide();

        //divs to show
        $(".body-content.default-copy-full").slideDown(500); 
        $("p.body-content-more.default-copy-hidden-less").show(); 
}); 

$(".see_less").live("click", function(){ 

     //divs to hide
        $(".body-content.default-copy-full").hide();
        $("p.body-content-more.default-copy-hidden-less").hide();

        //divs to show
        $(".body-content.default-copy").slideDown(500);
        $("p.body-content-more.default-copy-hidden-more").show();

}); 
```

您可以参考链接以附加事件处理程序[http://api.jquery.com/live/](http://api.jquery.com/live/)

# php - CodeIgniter 再次上传类

> ID：12552043
> 
> 赞同：1
> 
> 时间：2012-09-23T11:40:49.033
> 
> 标签：php, codeigniter, upload

嗨，我已经建立一个网站大约 3 个月了，今天让我的女朋友用虚拟内容填充它以进行测试。在那里，她很高兴地测试和上传文件，突然，一旦她完成了大约 8 篇文章，上传者决定不更改代码等，开始拒绝上传，说文件类型是不允许的。

现在不用说我已经通过这个上传图像一个多月了，这是第一次出现这个问题。更令人困惑的是，我在其他部分使用 CI 上传类，具有相同的 mime 参数，而且效果很好！我检查了 $_FILES 中的 mime，这是 image/jpg 或 image/png 等，所有这些都被 CI 识别。我也看到了 CI 2.1.0 中的错误，但我在 2.1.1 上，我认为错误已修复（或未修复），因为之前错误所在的上传库中的代码略有不同。

无论哪种方式，我都推断这是一个 mime 错误，因为将允许的类型配置参数设置为 * 工作正常！当然，这远非理想，因为潜在的安全漏洞是惊人的。我现在正处于关键时刻，因为我还有其他工作要做。我已经附上了处理此上传的代码部分，以防我做一些非常愚蠢的事情，但如果其他人不知从哪里发现了这个问题，我很想知道任何解决方法/解决方案......还有关于这怎么可能只是抬起它丑陋的头来，那就太好了。我经常与这些事情的神秘面作斗争。

```
if(isset($_FILES['article_main_image']) && $_FILES['article_main_image']['size'] > 0){

    $filename = $this->input->post('article_title') . '_' . time();

    $config['upload_path'] = './resource/data/tmpstore/';
    $config['allowed_types'] = 'gif|jpg|png|jpeg';
    $config['file_name'] = $filename;

    $this->load->library('upload', $config);

    if ($this->upload->do_upload('article_main_image'))
    {

        $uploadData = $this->upload->data();
        $filename = $uploadData['file_name'];

        //Other stuff here

    } else {

       $this->session->set_flashdata('validationErrors', $this->upload->display_errors());
       $this->session->set_flashdata('postVars', $this->input->post());

       redirect('/admin/contenteditor/editarticle?id=' . $this->input->post('articleId'));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T01:47:52.817

尝试通过使用调试您的上传数据数组`print_r($uploadData);`并查看内容`file_type`，也许她尝试上传的图像可能没有正确的 mime 类型。

# .htaccess - 如何将 .htaccess 代码转换为 web.config？

> ID：12552045
> 
> 赞同：1
> 
> 时间：2012-09-23T11:41:05.003
> 
> 标签：.htaccess, web-config, translate

我在 Apache 中有一个 PHP CMS，我`.htaccess`在下面：

```
 # -FrontPage-

IndexIgnore .htaccess */.??* *~ *# */HEADER* */README* */_vti*

# AuthType Basic
# AuthUserFile /home/tcdgroup/.htpasswd
# AuthName tadbir-group

# Require user test 

RewriteEngine On

RewriteRule ^\.htaccess$ - [F]

RewriteCond %{REQUEST_URI} =""
RewriteRule ^.*$ /public/index.php [NC,L]

RewriteCond %{REQUEST_URI} !^/public/.*$
RewriteRule ^(.*)$ /public/$1

RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^.*$ - [NC,L]

RewriteRule ^public/.*$ /public/index.php [NC,L] 
```

我想将它转换为 IIS Web 服务器的 web.config。

我搜索并找到了“URL重写”工具来翻译格式，总结如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="Imported Rule 1">
                    <match url="^\.htaccess$" ignoreCase="false" />
                    <action type="CustomResponse" statusCode="403" statusReason="Forbidden" statusDescription="Forbidden" />
                </rule>
                <rule name="Imported Rule 2" stopProcessing="true">
                    <match url="^.*$" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{URL}" pattern="^&quot;&quot;$" ignoreCase="false" />
                    </conditions>
                    <action type="Rewrite" url="/public/index.php" />
                </rule>
                <rule name="Imported Rule 3">
                    <match url="^(.*)$" ignoreCase="false" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{URL}" pattern="^/public/.*$" ignoreCase="false" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="/public/{R:1}" />
                </rule>
                <rule name="Imported Rule 4" stopProcessing="true">
                    <match url="^.*$" />
                    <conditions logicalGrouping="MatchAll">
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" />
                    </conditions>
                    <action type="None" />
                </rule>
                <rule name="Imported Rule 5" stopProcessing="true">
                    <match url="^public/.*$" />
                    <action type="Rewrite" url="/public/index.php" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

但是当我将它上传到我的服务器时，会出现以下错误：

> **500 - 内部服务器错误**。您要查找的资源有问题，无法显示。

此错误的原因可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-21T15:45:14.013

请确保在您的 IIS 上安装并启用 URL 重写模块。否则，IIS 无法理解 web.config 文件中的标记。

# php - Javascript 到 PHP 而不是使用 Ajax？

> ID：12552046
> 
> 赞同：1
> 
> 时间：2012-09-23T11:41:06.830
> 
> 标签：php, javascript, call

我需要调用 PHP 脚本并在服务器上运行（一个函数）.. 通过使用 Javascript 从客户端调用。我只知道来自 Javascript 的 Ajax 调用。

*   有没有其他标准化的方式来从 Javascript 到 PHP 进行通信？
*   如果我在发牢骚，请纠正我。XMLRPC 是另一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:44:38.397

没有什么得到很好的支持或实用。

Ajax 只是“在不离开页面的情况下从 JavaScript 发出 HTTP 请求”的简写。

PHP 非常适合作为服务器端 Web 语言（因此它针对通过 HTTP 访问进行了优化）。浏览器专注于通过 HTTP 访问内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:10:20.103

据我所知，XMLHttpRequest 是最好的方法，但也有其他技术。有些网站仍然使用老式的方式。使用**隐藏的 iframe**并通过它发送请求。您使用 javascript 创建一个 iframe，将其附加为 0 宽度和高度，并请求 php 文件。输出必须是以某种方式与父窗口脚本通信的脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T11:45:02.770

不，您使用 XmlHttpRequest（也就是说，我假设您不希望用户体验任何类型的页面刷新）。

为了轻松地跨浏览器工作，我建议使用像[jQuery](http://api.jquery.com/category/ajax/)这样的库来为你处理一切，一切都被很好地封装和抽象，所以你不需要担心任何细节。这样调用你的脚本就变得非常容易。

# java - Java contains 无法按预期工作，因为 "someString" != "someString"

> ID：12552048
> 
> 赞同：7
> 
> 时间：2012-09-23T11:41:07.673
> 
> 标签：java, string, list, equals, contains

我想检查一个字符串值`val`是否包含在字符串列表中，我们称之为 stringList。

我正在这样做

```
if(stringList.contains(val)){
  System.out.println("The value is in there");
}
else{
  System.out.println("There's no such value here");
} 
```

但似乎总是不包括该值。这是因为具有相同字符的两个字符串值实际上并不相等吗？对于“自制”类，我可以实现 hashCode() 和 equals() 并解决这个问题，我可以为 String 数据做什么？

编辑：

这里概述了我获得 val 的方式：

```
List<String> stringList = new ArrayList<String>();
    stringList.add("PDT");
stringList.add("LDT");
stringList.add("ELNE");

String myFile = "/folder/myFile";
InputStream input = new FileInputStream(myFile);
CSVReader reader = new CSVReader(new InputStreamReader(input), ',','"', 1);
String[] nextLine;
try {
    while ((nextLine = reader.readNext()) != null) {
    if (nextLine != null) {
        if (nextLine[6] != null){
          String val = nextLine[6];
            if(stringList.contains(val)){
            System.out.println("Success");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T11:47:32.757

`ArrayList.contains()`用于`Object.equals()`检查是否相等（`hashCode()`不涉及`List`）。这适用于字符串。可能，您的字符串确实不包含在列表中...

您可能忽略了一些空格或大写/小写或编码差异......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T11:47:43.173

这听起来不对：`contains`使用`equals`而不是`==`，因此如果字符串在列表中，则应该找到它。这可以在 使用的超类 AbstractList 的方法[中](http://hg.openjdk.java.net/jdk7/jdk7/jdk/file/9b8c96f96a0f/src/share/classes/java/util/AbstractList.java)`indexOf`得到验证。`ArrayList`

在您进行编辑之后，请确保`trim`在执行 之前先使用字符串`contains`，否则它们可能包含`newline`字符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-23T11:49:47.897

请更多代码！

这有效：

```
import java.util.*;

public class Contains {
    public static void main(String[] args) {
        List<String> stringList = new ArrayList<String>();
        stringList.add("someString");
        String val = new String("someString");
        if (stringList.contains(val)) {
            System.out.println("The value is in there");
        } else {
            System.out.println("There's no such value here");
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T11:49:32.283

尝试以下操作，首先通过迭代列表并分别检查每个元素来使检查更加具体。比，当你击中你期望相等的元素时，这就是你应该看到的。检查它们是否真的相等。也许有一个案例差异？（或其他一些难以捉摸但明显的区别，如空白？）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-14T14:21:26.253

尝试重写equals(){}，这样你就可以指定哪个属性需要比较相等性....：P

# jsf - 从 URL 请求调用托管 bean 中的方法

> ID：12552051
> 
> 赞同：0
> 
> 时间：2012-09-23T11:41:45.673
> 
> 标签：jsf, spring-mvc, managed-bean

我正在使用 Richfaces 开发 Spring MVC。有没有办法从 URL 调用托管 bean 控制器中的方法？

例如：website.com/somecontroller/somemethod?x=1

我尝试了@RequestMapping，但没有奏效。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T18:13:15.913

当浏览器客户端想要访问一个 URL 时，页面中声明的托管 bean 将被创建，构造函数和`@PostConstruct`方法将被调用服务器端。

您可以使用 BalusC 建议的方法恢复参数`@ManagedProperty`（正如他所说，JSF-ish 方式）：

*   [URL JSF 2 中的参数](https://stackoverflow.com/q/3355611/1065197)

如果该答案不符合您的需求，您可以恢复请求对象并一一获取参数，如问题中所述：

```
HttpServletRequest request = (HttpServletRequest)FacesContext.
    getCurrentInstance().getExternalContext().getRequest();
String clipId = request.getParameter("x"); 
```

# php - File_Get_Contents 整个数组

> ID：12552053
> 
> 赞同：1
> 
> 时间：2012-09-23T11:41:54.100
> 
> 标签：php, file-get-contents

我想要我数组中的每个链接的 file_get_contents。因此，我可以应用 preg_match 代码，然后匹配检测到的前 p 个标签中的所有前 20 个字符。

我的代码如下：

```
 $links = array(0 => "http://en.wikipedia.org/wiki/The_Big_Bang_Theory", 1=>  "http://en.wikipedia.org/wiki/Fantastic_Four");
   print_r($links);
  $link = implode(", " , $links);
  $html = file_get_contents($link);

  preg_match('%(<p[^>]*>.*?</p>)%i', $html, $re);
  $res = get_custom_excerpt($re[1]);
  echo $res; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T11:48:04.533

您可以在 中一次使用一个网址`file_get_contents`。组合链接将不起作用，而是您需要循环每个链接并获取内容。

```
 $links = array(0 => "http://en.wikipedia.org/wiki/The_Big_Bang_Theory", 1=>  "http://en.wikipedia.org/wiki/Fantastic_Four");
  print_r($links);

  foreach($links as $link){
    $html = file_get_contents($link);
    preg_match('%(<p[^>]*>.*?</p>)%i', $html, $re);
    $res = get_custom_excerpt($re[1]);
    echo $res;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T11:50:20.640

为什么不使用他们的 API？

您仍然可以使用它`file_get_contents`来检索内容，但您可以决定更适合您需要的格式。

他们的 API 记录得很好，请参阅：[http ://www.mediawiki.org/wiki/API:Main_page](http://www.mediawiki.org/wiki/API:Main_page)

URLs 会变成一些东西

# c# - 控制器中自定义方法的 WebApi 路由

> ID：12552054
> 
> 赞同：4
> 
> 时间：2012-09-23T11:42:06.807
> 
> 标签：c#, routing, asp.net-web-api

我最近拿起了 ASP.NET Web API 的东西，虽然我已经破解了授权和身份验证，但我无法破解路由。这是一场噩梦！

我创建了一个`Authenticate()`带有`AuthenticationController`. 我将`[HttpGet]`属性添加到`Authenticate()`，但每当我点击 API 时，我都会得到一个`404`.

这是我目前的`WebApiConfig`：-

```
public static void Register(HttpConfiguration config)
{
     config.Routes.MapHttpRoute("DefaultApiWithId", "{controller}/{id}", new { id = RouteParameter.Optional }, new { id = @"\d+" });
     config.Routes.MapHttpRoute("DefaultApiWithAction", "{controller}/{action}");
     config.Routes.MapHttpRoute("DefaultApiGet", "{controller}", new { action = "Get" }, new { httpMethod = new HttpMethodConstraint(HttpMethod.Get) });
     config.Routes.MapHttpRoute("DefaultApiPost", "{controller}", new { action = "Post" }, new { httpMethod = new HttpMethodConstraint(HttpMethod.Post) });
} 
```

我正在尝试的地址是：`/authentication`.

控制器看起来像这样：-

```
[BasicHttpAuthorize(RequireAuthentication = true)]
public class AuthenticationController : ApiController
{
     [HttpGet]
      public string Authenticate(string email, string password, string agent, string ip)
      {

      }
} 
```

谁能指导我正确的方向？我试过打多个地址/端点：-

*   `/authentication/authenticate`
*   `/authentication/`
*   `/authentication`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:22:07.877

as per my comment:

why do you have 4 routes? I'm not sure what you're trying to achieve exactly exactly but you could most likely achieve it with the top (default) route only. if you remove or comment out the last 3 routes and youre using web api then your Authenticate method should be hit when you perform a GET

# iphone - 在 UIWebView 的 iframe 中播放 Youtube 视频

> ID：12552056
> 
> 赞同：1
> 
> 时间：2012-09-23T11:42:46.057
> 
> 标签：iphone, xcode, cocoa-touch, ipad, uiwebview

您好，我正在将 html 字符串解析为 Web 视图，这是我检查 youtube 视频并将它们添加到 iframe 的方法：

```
- (NSString *)extendYouTubeSupportInHtml:(NSString *)html {
    static dispatch_once_t onceToken;
    static NSRegularExpression *youtubeEmbedRegex;
    dispatch_once(&onceToken, ^{
        youtubeEmbedRegex = [[NSRegularExpression alloc] initWithPattern:@"<object.*src.*/v/(.*?)['|\"].*object\\s*>" options:NSRegularExpressionCaseInsensitive error:nil];
    });
    NSArray *matchs;
    if (html != nil) {

        matchs = [youtubeEmbedRegex matchesInString:html options:0 range:NSMakeRange(0, html.length)];

    }else{
        matchs = nil;
    }

    NSInteger rangeOffset = 0;
    for (NSTextCheckingResult *match in matchs) {    
        NSRange objectRange = NSMakeRange([match rangeAtIndex:0].location + rangeOffset, [match rangeAtIndex:0].length);
        NSRange idRange = NSMakeRange([match rangeAtIndex:1].location + rangeOffset, [match rangeAtIndex:1].length);
        NSString* youtubrId = [html substringWithRange:idRange];

        // Add uniq id to img tag
        NSString* iframe = [NSString stringWithFormat:@"<iframe src=\"http://www.youtube.com/embed/%@\" frameborder=\"0\" allowfullscreen></iframe>", youtubrId];
        html = [html stringByReplacingCharactersInRange:objectRange withString:iframe];

        rangeOffset += iframe.length - objectRange.length;
    }

    return html;
} 
```

这是我显示网络视图的方式：

```
- (id)initWithFrame:(CGRect)frame dict:(NSDictionary *)dict {
    self = [super initWithFrame:frame];
    if (self) {
        self.webView = [[[UIWebView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)] autorelease];
        self.webView.backgroundColor = [UIColor clearColor];
        self.webView.opaque = NO;
        self.webView.delegate = self;
        self.webView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
        self.webView.scalesPageToFit = NO;
        self.webView.allowsInlineMediaPlayback = YES;
        self.webView.mediaPlaybackRequiresUserAction = NO;

        [self removeBackgroundFromWebView:self.webView];      
        [self addSubview:self.webView];
        self.dictionary = dict;

    }
    return self;
} 
```

我的问题是，当我开始播放视频时 - 内存使用量高达 30MB，视频开始卡顿，音频/视频不匹配，当我关闭它时 - 内存使用量仍然相同。

我在 AudioToolbox 中也有一些漏洞。我正在使用 iOS 6 SDK 和 iOS 6。iOS 6 sdk 破坏了代码 - 现在它在 iOS 5 中没有显示任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T05:05:52.263

这是我在应用程序中播放 youtube 视频的方式。

我正在使用 iFrame 在我的应用程序中加载 youtube 视频。

按照这个步骤，你也会。

创建一个 uiwebview 并将其连接到您的 .h 文件。我的是 _webView。

将此方法添加到您的 .m 文件中。

```
-(void)embedYouTube{

    NSString *embedHTML = @"<iframe width=\"300\" height=\"250\" src=\"http://www.youtube.com/embed/rOPI5LDo7mg\" frameborder=\"0\" allowfullscreen></iframe>";

    NSString *html = [NSString stringWithFormat:embedHTML];

    [_webView loadHTMLString:html baseURL:nil];
    [self.view addSubview:_webView];

} 
```

我正在使用 youtube 视频中的嵌入代码。（我希望你知道它是什么）

在您的 viewdidload 中调用此方法

```
[self embedYouTube]; 
```

运行应用程序，您将在视图中看到视频。这种方式对我来说非常有效，我认为这对你也有帮助。

# c# - 从数据集导入到 Combobox C#

> ID：12552058
> 
> 赞同：0
> 
> 时间：2012-09-23T11:42:49.410
> 
> 标签：c#, winforms, combobox, dataset

我有一个包含要导入组合框的表的数据集。所以基本上我想将每个表的每个名称导入我的组合框中。

这是一个 Winform 应用程序

这是否可能无需手动添加每个名称？

这样做的原因是能够选择一个表以便稍后在数据网格中显示该表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:01:05.283

创建 TableName & Table ( `Dictionary<string,DataTable>`) 的字典并将其绑定到 ComboBox 的[DataSource](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.datasource.aspx)。

利用

`DisplayMember`（从 DataSource 分配 DisplayMember）是 ComboBox 项中显示的数据源中的项。

`ValueMemeber`（从 DataSource 分配 ValueMember）是 DataSource 中用作项的实际值的项。

**代码**

```
Dictionary<string, DataTable> dictionary = new Dictionary<string, DataTable>();
foreach (DataTable table in ds.Tables)
{
    dictionary.Add(table.TableName, table);
}

comboBox1.DataSource = new BindingSource(dictionary, null);
comboBox1.DisplayMember = "Key";
comboBox1.ValueMember = "Value"; 
```

**或** 使用 Linq 查询创建`Dictionary<string,DataTable>`

```
Dictionary<string, DataTable> dictionary = ds.Tables.Cast<DataTable>().ToDictionary(x => x.TableName, t => t);

comboBox1.DataSource = new BindingSource(dictionary, null);
comboBox1.DisplayMember = "Key";
comboBox1.ValueMember = "Value"; 
```

这里`Dictionary`用作DataSource。`Dictionary`有两个属性`Key`& `Value`。Key(TableName) 用作 DisplayMember 和 Value(DataTable) 用作 ValueMember。

在组合框上`SelectedIndexChanged`绑定网格`DataSource`

```
 private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
 {
        dataGridView1.DataSource = comboBox1.SelectedItem;
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T11:55:18.663

怎么样

```
mycombobox.ItemSource = mydataset.Tables.Cast<DataTable>().Select(x => x.Name); 
```

然后在每个 ComboBox Selected Index changed 事件上做

```
mydatagrid.ItemSource = mydataset.Tables(mycombobox.SelectedIndex); 
```

# php - PHP中的数字格式列类型和计算

> ID：12552060
> 
> 赞同：1
> 
> 时间：2012-09-23T11:42:51.947
> 
> 标签：php, mysql, numbers

1.  我想将这种类型的数字格式插入到我的数据库中。

    ```
    $value = "20.000,00"; 
    ```

    我尝试使用`FLOAT`and `DOUBLE`，但他们无法处理。剩下的唯一选择是我知道哪个有效`VARCHAR`？

2.  虽然如果我稍后在处理数字时这样做并尝试从彼此中减去数字：

    ```
    $value2 = "15.933,50";
    $calc = $value - $value2; 
    ```

    `$calc`现在`4.067`，应该是`4.066,50`——这怎么可能是正确的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T11:46:42.290

对于财务数字，您应该使用[DECIMAL 类型](http://dev.mysql.com/doc/refman/5.1/en/fixed-point-types.html)。它具有固定的精度，不受浮点数舍入问题的影响。

切勿将货币号码存储在 VARCHAR 或 FLOAT 中。

如果你想在数据库中引入你的`$value`，你必须解析它，以便你可以引入数字：

```
$fmt = new NumberFormatter( 'da_DK', NumberFormatter::DECIMAL );
$num = $fmt->parse($value, NumberFormatter::TYPE_INT32) 
```

要将您从数据库中获得的数字显示为“20.000,00”，您可以使用

```
$display_value = $fmt->format($num); 
```

**编辑 ：**

如果您不能使用 NumberFormatter，您可以使用它来构建一个可以在 DECIMAL 字段中引入的字符串（也可以在浮点字段中，但不要）：

```
$v = str_replace(',', '.', str_replace('.', '', $value)); 
```

数据库可以理解的`"20.000,00"`这种变化。`"20000.00"`但是要求数据库将字符串解析为数字总是很危险的（稍后您可能会更改语言环境）。我建议您在 PHP 中解析数字并明确指定语言环境。

# sql - SQL 选择不同的列

> ID：12552062
> 
> 赞同：5
> 
> 时间：2012-09-23T11:43:00.127
> 
> 标签：sql, sql-server-2008, stored-procedures

我有一个返回以下数据的查询

![在此处输入图像描述](../Images/dfe4e1419d122e9f58b941cd58ae891b.png)

正如您在图像中看到的那样，彩色组对于“A”列是相似的，我想将这些行的第一次出现与“A”列相关，并丢弃其余的。

所以我可以得到这个结果。

![在此处输入图像描述](../Images/18f47a2d7fc05ed4fa1450f148d655fc.png)

任何解决方案？

谢谢 ：）

**更新：**

这是原始查询结果 ![在此处输入图像描述](../Images/e433258570c496c5a0dd9515b6b0733d.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T12:00:38.493

我会这样做：

```
WITH T(A, B, C, D, RowNum) AS 
(
    SELECT A, B, C, D, ROW_NUMBER() OVER (PARTITION BY A ORDER BY A)
    FROM MyTable
)
SELECT * FROM T
WHERE 
    RowNum = 1 
```

# object - 在不修改原件的情况下正确加载关卡

> ID：12552064
> 
> 赞同：0
> 
> 时间：2012-09-23T11:43:06.250
> 
> 标签：object, static, copy, loading, xna-4.0

目前，我的游戏是这样工作的：

```
public class TheGame: Microsoft.Xna.Framework.Game
{
    public static Level CurrentLevel;
    private Level level1, level2, level3;

    protected override void LoadContent()
    {
        level1 = new Level(//param);
        level2 = new Level(//param);
        level3 = new Level(//param);
    }

    protected override void Update(GameTime gameTime)
    {
        If(something)
          LoadLevel(level1);

        currentLevel.Update(gameTime);
        //
    }

    LoadLevel(Level theLevel)
    {
        currentLevel = theLevel;
    }
} 
```

问题是，当我使用 Update() 修改 currentLevel 时，也会修改 Level1。

```
For example :
Level1 has a crate with position (100,200).
if currentLevel.Update() modifies the crate's position (120,200),
that modifies the crate's position in CurrentLevel AND the crate's position in Level1. 
```

所以当我重新加载Level1时，这个级别与原来的level1不同。

是因为静态吗？因为我必须克隆 Level1 ？还有什么？:s 感谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T14:15:08.833

您始终加载相同的变量，因为您将`level1`,`level2`和`level3`作为主 Game 类的实例变量并在实例方法中将它们分配给 currentLevel 。static 修饰符与它无关。

相反，您应该每次都重新加载关卡，或者从您加载的任何数据中重建它。另一种选择是使用一种方法将其恢复到其原始状态，但这要求关卡中的所有内容都可以恢复到已知的初始状态。通常，简单地重新加载资产或克隆它们会更容易。

# assembly - MASM 段指令

> ID：12552072
> 
> 赞同：1
> 
> 时间：2012-09-23T11:44:17.573
> 
> 标签：assembly, masm

我正在阅读一些 MASM 程序集，但我无法理解段指令的目的。在装配过程中地址计算与标签有何不同？假设表单指令只是`name segment at addr`，我不太关心它具有的其他选项。什么是

```
BootSeg segment at 0x7c0
BootSeg end 
```

如果它里面什么都没有呢？

如果你这样做，你在 ax 中会有什么价值：

```
mov ax, BootSeg 
```

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T20:36:14.363

该`segment`指令具有多种用途。

第一个用途是将事物组合成段。

第二种用途是正确引用（=计算地址）各个段中的对象。根据代码中访问的对象段，汇编器可以将适当的`segment override prefixes`( `es:`, `ss:`, `cs:`, `fs:`, `gs:`) 插入到生成的代码中。`procedure`同样，当从不同的代码段调用 a 时，汇编器可以生成`far call`指令而不是`near call`. AFAIR，为此您实际上需要将其`procedure`本身标记为`far`（这也将在例程中变得很简单）`rets`。`far rets`

然后这些段由链接器处理并转换为操作系统使用的重定位信息。

为什么我们有这些细分市场？因为 CPU 有它们，我们不能总是忽略它们的存在。有 DOS .COM 程序将它们的代码、数据和堆栈放入单个段中，在这种情况下，程序不必因段的概念而变得复杂（除了需要访问一些“外部”代码的情况/数据，而不是来自其自己的段）。

是的，这个`AT`东西基本上将一个对象覆盖在另一个对象之上。所以`mov ax, BootSeg`应该得到你`ax`= 0x7c0，就像任何其他段一样，除了这里段在“编译”时是已知的。

使用调试器，进行实验。

# javascript - xml解析错误语法错误行号1在jquery ajax中的第1列

> ID：12552074
> 
> 赞同：0
> 
> 时间：2012-09-23T11:44:22.777
> 
> 标签：javascript, java, jquery, ajax

以下是我用于 ajax 调用的代码。执行此操作时，它给了我一个错误**xml parsing error syntax error line number 1 column 1** in fiebug。我查看了一些说明相同问题的问题，他们认为存在一些语法问题。我再次检查，但找不到真正的罪魁祸首。请告诉我我做错了什么。

```
 $.ajax({type: "GET",
            cache: false,
            url: 'url',
            data : 'param1='+ param1val+ '&param2='+param1val,
            dataType: 'json',
            success: function(Obj){
                if(Some Condition){
                   //Some Code
                }else{
                  //else code
                }
            },

        }); 
```

这里有一些控制器代码。

```
 @RequestMapping(value = "url", method = RequestMethod.GET)
    public @ResponseBody SomeObject url(@RequestParam(value="param1val") String  abc ,@RequestParam(value="param2val") String xyz) 
   { //some code} 
```

**编辑** 我向 JS 和控制器代码添加了一些调试代码。令我惊讶的是，控制执行成功首先出现（在 JS 中），然后进入控制器。它应该像这样发生吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-09-18T17:16:09.913

如果响应类型设置不正确，Firefox 会显示此错误。它尝试将响应解析为 XML。要修复它，请为您发送回客户端的内容设置响应类型，例如使用 Spring 的 JSON：

```
@RequestMapping(value = "url", 
                method = RequestMethod.GET, 
                produces = "application/json") 
```

# jquery - 为什么单击项目后禁用 jQuery Accordion 菜单？

> ID：12552076
> 
> 赞同：1
> 
> 时间：2012-09-23T11:44:32.083
> 
> 标签：jquery, jquery-ui, jquery-plugins

我的项目中有 Jquery 菜单。
这些项目来自站点地图
。我的问题是：单击项目并打开该页面后，手风琴菜单被禁用！为什么？
感谢任何机构指导我。

```
<ul id="accordion">
    <li>
        <div> صفحه اصلی</div>
        <ul>
            <li><a href="Default.aspx">بازگشت به صفحه اصلی</a></li>
        </ul>
    </li>
    <li>
        <div>عملیات مربوط به واحدها</div>
        <ul>
            <li><a href="Units/Reports/SelledUnitReport.aspx">گزارش واحدهای فروخته شده</a></li>
            <li><a href="Units/Reports/BlockedUnitReport.aspx">گزارش واحدهای بلوکه شده</a></li>
            <li><a href="Units/Reports/ReservedUnitReport.aspx">گزارش واحدهای رزرو شده</a></li>
            <li><a href="Units/Reports/FreeUnitReport.aspx">گزارش واحدهای قابل فروش</a></li>
            <li><a href="Units/UnitStateForm.aspx">تعیین وضعیت یک واحد</a></li>
        </ul>
    </li>
    <li>    
        <div>
            عملیات مربوط به مشتریان</div>
        <ul>
            <li><a href="Customers/Reports/DeptorCustomerReport.aspx">گزارش مشتریان بدهکار</a></li>
            <li><a href="Customers/ContractReport/ContractCustomerReport.aspx">مشتریان دارای قرارداد</a></li>
            <li><a href="Customers/ContractReport/WaitContractCustomerReport.aspx">مشتریان در انتظار
                قرارداد</a></li>
            <li><a href="Customers/CustomerStateForm.aspx">تعیین وضعیت یک مشتری</a></li>
            <li><a href="Customers/CustomerContractsList.aspx">تعیین وضعیت یک قرارداد</a></li>
            <li><a href="Customers/ContractChequesList.aspx">گزارش چک های یک قرارداد</a></li>
            <li><a href="Customers/ContractNaghdiList.aspx">گزارش پرداخت های نقدی یک قرارداد</a></li>
        </ul>
    </li>
    <li>
        <div>
            عملیات مالی</div>
        <ul>
            <li><a href="Fiscal/States/DocumentStateForm.aspx">تعیین وضعیت اسناد دریافتی</a></li>
            <li><a href="Fiscal/CollectedDocumentReport.aspx">گزارش اسناد دریافتی وصول شده</a></li>
            <li><a href="Fiscal/ReversalDocumentReport.aspx">گزارش اسناد دریافتی برگشت شده</a></li>
        </ul>
    </li>
</ul> 
```

这是该功能：

```
<script type="text/javascript">
    $("#accordion > li > div").click(function () {
        if (false == $(this).next().is(':visible')) {
            $('#accordion ul').slideUp(300);
        }
        $(this).next().slideToggle(300);
    });
    $('#accordion ul:eq(0)').show();
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T05:50:14.933

抱歉，我忘了在我的页面中使用 jquery 核心！

# cuda - 运行时错误：在此过程中设备处于活动状态时无法设置

> ID：12552077
> 
> 赞同：1
> 
> 时间：2012-09-23T11:44:37.007
> 
> 标签：cuda, gpgpu, nvidia

我正在尝试使用 CUDA 作为我正在开发的更大应用程序的一部分来实现可分离的卷积滤波器。我的代码有多个 CUDA 内核，它们一个接一个地被调用（每个执行一个阶段的过程）。问题是我不断收到这个奇怪的错误，我不确定它到底是什么意思或导致它的原因。除了几个与 OpenGL 和 CUDA 互操作性相关的 Stack Overflow 问题（我没有这样做，即我根本没有使用 OpenGL）之外，我在 Internet 上也找不到任何关于它的信息。

有人可以向我解释为什么会发生这样的错误吗？

谢谢。

# javascript - websocket 游戏 - 持久化玩家数据

> ID：12552084
> 
> 赞同：2
> 
> 时间：2012-09-23T11:45:40.493
> 
> 标签：javascript, html, websocket

如果你看像[browserquest](http://browserquest.mozilla.org/)这样的 websocket 游戏，玩家数据存储在哪里？它在 websocket 服务器 .js 文件中吗？

因为，例如，如果有新玩家加入游戏，游戏必须以其当前状态渲染，包括所有玩家、物品等。这些数据存储在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T11:51:39.863

在线游戏通常有一个管理世界状态的中央服务器组件。每个客户端都直接与服务器通信。服务器向每个客户端发送有关周围环境的数据（这就是地图的外观，有一个暴徒 A，有一个项目 B），客户端向服务器发送有关它正在做什么的信息（我走到 x:y；我攻击暴徒A；我拿起物品B）。

在 Mozilla Browserquest 中，这个服务器组件是用 NodeJS 编程[的](http://nodejs.org/)。

关于保持当前退出玩家的游戏状态：这也应该在服务器上通过将这些数据存储在某种数据库中来完成。一个可能但更糟糕的选择是将玩家进度存储在客户端的本地 Webstorage 中（另一个新的 HTML5 功能）。这将减轻服务器的责任，但会给玩家一个容易作弊的机会，因为他们能够编辑他们的游戏状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T11:51:58.867

这取决于您将其保存在服务器端的位置。昨天我在看一些关于流星的不错的截屏视频，它使用 node.js、mongoDB。它是一个框架，可以完全按照您所说的去做。

# objective-c - 如何正确深度复制多维 NSMutableArray？

> ID：12552086
> 
> 赞同：3
> 
> 时间：2012-09-23T11:45:45.223
> 
> 标签：objective-c, multidimensional-array, nsmutablearray, deep-copy

嗨，之前有人问过这个问题：[您如何深度复制多维 NSMutableArray 及其内容？](https://stackoverflow.com/questions/10968021/how-do-you-deep-copy-a-multidimensional-nsmutablearray-and-its-contents) 但答案对我不起作用。

我试过：

```
NSMutableArray *copy = [[NSMutableArray alloc] initWithArray:multiDimArray copyItems:YES]; 
```

和：

```
NSMutableArray *mutableArray = [multiDimArray mutableCopy];
NSMutableArray *copy = [[NSMutableArray alloc] initWithArray:mutableArray copyItems:YES]; 
```

复制有效，但是当我尝试替换对象时出现错误：

-[__NSArrayI replaceObjectAtIndex:withObject:]：无法识别的选择器发送到实例 0x1073b1790

我做错了什么，还是无法在其元素不可变的情况下深度复制多维数组？

有解决方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:33:34.257

尝试

```
NSMutableArray *mutableArray = [multiDimArray mutableCopy]; 
```

用。。。来代替

```
NSMutableArray *mutableArray = [[NSMutableArray arrayWithArray:multiDimArray] mutableCopy]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:34:54.033

我得到了它的工作：

```
NSMutableArray *originalArray = [NSMutableArray new];

NSMutableArray *copyArray = [NSMutableArray new];
for(NSArray *subarray in originalArray) {
    NSMutableArray *subCopy = [NSMutableArray new];
    for (id item in subarray){
        [subCopy addObject:[item copy]];
    }
    [copyArray addObject: subCopy];
} 
```

我是为二维数组做的。如果有更多维度，您可能必须为每个维度添加额外的 for 循环。

# sql - 如何在 Access 中忽略查询中的空白条件

> ID：12552089
> 
> 赞同：-1
> 
> 时间：2012-09-23T11:45:52.920
> 
> 标签：sql, forms, ms-access, criteria

我目前正在使用更新查询，该查询按预期工作，直到我添加使查询不显示任何结果的条件（这是我预期的）。该标准当前来自表单上的文本框。

我想要做的是，在标准行中，指定如果文本框是空白的，其中没有任何内容，那么标准应该跳过它。

我在 Criteria 行中尝试过：

```
[Forms]![Formname].[txtboxName] OR [Forms]![Formname].[txtboxName] Is Null 
```

但这不起作用。

感谢您的任何帮助或指导！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:13:55.593

您应该能够使用通配符：

```
Like [Forms]![Formname].[txtboxName] & "*" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:31:19.517

怎么样：

```
where [whatever your field is] = [Forms]![Formname].[txtboxName]
OR Nz([Forms]![Formname].[txtboxName]) = "" 
```

的使用`Nz`将捕获空值和零长度字符串，它们看起来为空但不是。

如果这不起作用，请按照 Remou 的要求进行。IE 使用实际的 SQL 查询更新您的问题，而不仅仅是其中的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T07:13:41.767

尝试这个：

```
Like IIF(IsNull([Forms]![Formname].[txtboxName])=Fasle;[Forms]![Formname].[txtboxName];"*") 
```

***注意**：我的系统默认分隔符是“;”，请确定你的。
享受车程

# android - 用户说话时如何捕捉语音输入

> ID：12552091
> 
> 赞同：1
> 
> 时间：2012-09-23T11:45:54.643
> 
> 标签：android, voice

当用户开始说话时如何捕捉语音输入，就像说话的汤姆应用程序一样。谁能帮我 ？我想在用户开始说话时开始录音，当用户停止说话时它必须停止，就像会说话的汤姆应用程序如何工作一样。有人可以帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:14:32.290

您必须使用一些语音活动检测[(VAD)](http://en.wikipedia.org/wiki/Voice_activity_detection)算法。这种信号处理的东西通常是用 C 编写的，所以你还必须学习一些关于使用[NDK的知识](http://developer.android.com/tools/sdk/ndk/index.html)

# php - 如果空格还没有，如何在子字符串周围添加空格？

> ID：12552096
> 
> 赞同：5
> 
> 时间：2012-09-23T11:46:58.757
> 
> 标签：php, parsing, spaces, emoticons

示例输入字符串：`test:)test:)test:) :) test:p test`
想要的输出字符串：`test :) test :) test :) :) test :p test`

正如您在上面的示例中所看到的，我想解析字符串并生成一个输出字符串，并在所有预定义的笑脸代码周围添加空格。

我试图用几个循环来做到这一点，但最终它并没有像预期的那样 100% 工作，而且在大文档上速度非常慢。

所以我想知道用 PHP 进行这种解析的最好和最有效的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:01:14.923

嵌套替换：

```
preg_replace("/\s\s+/", " ", 
    str_replace( Array( ":)", ":p" ),
        Array( " :) ", " :p " ), $str) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T07:04:21.007

```
<?php

$lspace =   str_replace(":"," :","test:)test:)test:) :) test:p");
$rspace =    str_replace(")",") ",$lspace);
$out    =    preg_replace("/\s\s+/"," ",$rspace);

echo $out;
?> 
```

输出：`test :) test :) test :) :) test :p`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T10:44:11.497

如果您还没有解决问题，我想出了一个可行的解决方案。首先用空格作为分隔符来分解字符串，用额外的空格替换笑脸，然后用 implode 重新组合它们。

检查[php fiddle](http://codepad.org/8STsYwGa)的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T13:14:13.600

应该有一个更优雅的解决方案，但下面的代码应该可以工作

```
$patterns = array();
$replacements = array();

$str = ':) test :)test:) test :)';

$smileys = array(':)', ':p');

foreach($smileys as &$s) {
    $s = preg_quote($s, '/');
}unset($s);
$escaped_smiley = implode('|', $smileys);

$patterns[] = '/([^\s])('.$escaped_smiley.')([^\s])/'; // no spaces
$patterns[] = '/([\s])('.$escaped_smiley.')([^\s])/';  // space on left
$patterns[] = '/([^\s])('.$escaped_smiley.')([\s])/';  // space on right

$patterns[] = '/^('.$escaped_smiley.')([\s])/';   // line starting, space succeding
$patterns[] = '/^('.$escaped_smiley.')([^\s])/';  // line starting, no space
$patterns[] = '/([\s])('.$escaped_smiley.')$/';   // line ending, space preceeding
$patterns[] = '/([^\s])('.$escaped_smiley.')$/';  // line ending, no space

$replacements[] = '$1 $2 $3'; // no spaces 
$replacements[] = '$1$2 $3';  // space on left
$replacements[] = '$1 $2$3';  // space on right

$replacements[] = ' $1$2';    // line starting
$replacements[] = ' $1 $2';   // line starting
$replacements[] = '$1$2 ';    // line ending
$replacements[] = '$1 $2 ';   // line ending

$result = preg_replace($patterns, $replacements, $str);
echo str_replace(' ', '^', $result); 
```

[使用从@Prinzhorn 借来的代码进行编辑]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T11:57:14.753

相反，您可以使用正则表达式`str_replace`函数。PHP函数`str_replace`可以接收数组作为参数，所以你可以试试这个：

```
$input = 'test:)test:)test:) :) test:p test';
$smileys = array( ':)', ':p' );
$smileys_with_spaces = array( ' :)', ' :p' );
$output = str_replace( $smileys_with_spaces, $smileys, $input ); // test:) :) -> test:):)
$output = str_replace( $smileys, $smileys_with_spaces, $input ); // test:):) -> test :) :) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T11:59:15.503

尝试：

```
$str = "test:)test:)test:) :) test:p test";
$str = preg_replace('/(?<=[a-z])(?=[^a-z\s])|(?<=[^a-z]{2})(?=[a-z])/', ' ', $str); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-23T12:01:08.183

更新支持 N 个笑脸

```
$smile = array(':)', ':p');

//Escape smiley chars for use in rx
foreach($smile as &$s) {
    $s = preg_quote($s, '/');
}unset($s);

$rx = implode('|', $smile);

$str = 'test:)test:)test:) :) test:p test';

$str = preg_replace('/ *('.$rx.') */', ' $1 ', $str);
$str = preg_replace('/('.$rx.') +/', '$1 ', $str);

echo $str; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-23T13:08:53.537

If you also want to not have extra spaces at the beginning/end, try this:

```
$str = ':):)test:)test:)test:) :) test:p:) test';
$codes = array(
    ':)', ':p', // Add smileys here.
);

// We build the $regexp automatically
$regexp = array();
foreach($codes as $smiley)
    $regexp[] = preg_quote($smiley, '#');
$regexp = implode('|', $regexp);
// Afterwards, we might replace the above with $regexp = 'VERYCOMPLICATEDSYNTAX';

// Split the string at smileys, trimming the smileys as we go,
// and returning an array of smiley-and-non-smiley parts, except for empty ones
$parts = preg_split("#\s*($regexp)\s*#", $str, -1,
    PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);

// The new delimiter is a single space.
$str = implode(' ', $parts); 
```

Note that I have used the whitespace matcher `\s` instead of a literal space; this can have unwanted results if you have line feeds in the original string. If that is the case, replace "`\s`" with a " " literal space.

# java - 洪水填充优化：尝试使用队列

> ID：12552098
> 
> 赞同：5
> 
> 时间：2012-09-23T11:47:36.913
> 
> 标签：java, recursion, queue, flood-fill

我正在尝试创建一个填充方法，该方法采用用户指定的初始坐标，检查字符，然后根据需要更改它。这样做之后，它会检查相邻的方格并重复该过程。经过一番研究，我遇到了洪水填充算法，并在尝试之后（它可以工作，但不能满足我对 250 x 250 个字符的数组的最大要求）。

我原来的洪水填充算法如下：

```
public static void fillArea (int x, int y, char original, char fill){

   if (picture[y-1][x-1] != original){
      return;
   }
   picture[y-1][x-1] = fill;
   fillArea (x-1, y, original, fill);
   fillArea (x+1, y, original, fill);
   fillArea (x, y-1, original, fill);
   fillArea (x, y+1, original, fill);

   return;
} 
```

测试后，我开始尝试 Queue 方法，如[Wikipedia](http://en.wikipedia.org/wiki/Flood_fill#Alternative_implementations)上解释的那样，[这个问题之前](https://stackoverflow.com/questions/2783204/flood-fill-using-a-stack)就类似的问题提出过。到目前为止，我已经想出了以下代码：

```
public static void fillArea (int x, int y, char original, char fill){
  if (x != 0)
     x--;
  if (y!= 0)
     y--;
  Queue<Point> queue = new LinkedList<Point>();
  if (picture[y][x] != original){
      return;
  }
  queue.add(new Point(x, y));

  while (!queue.isEmpty()){
      Point p = queue.remove();
      if (picture[p.y][p.x] == original){
         picture[p.y][p.x] = fill;
         queue.add(new Point(p.x-1, p.y));
         queue.add(new Point(p.x+1, p.y));
         queue.add(new Point(p.x, p.y-1));
         queue.add(new Point(p.x, p.y+1));
      }
   }

   return;
} 
```

虽然第一种递归方法能够处理较小的值，但当数组变得太大时它就不起作用了。但是，第二种方法将我带入某种无限循环，由于我对队列缺乏经验，我无法识别这种循环。如何优化第一个代码示例以处理更大的示例或修复第二个代码示例以提供结果？谁能解释如何编写这两者中的任何一个或我做错了什么？

谢谢！

编辑：我能够在第二个代码中找到无限循环错误（已修复），但基于队列的方法没有填满整个区域。事实上，它比基于递归的方法填充的区域更少。编辑 2：它现在适用于方形数组。如何确保它也适用于矩形阵列（第二种方法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:36:52.287

不应该

```
if (picture[p.y][p.x] == original){
     picture[p.y-1][p.x-1] = fill; 
```

是

```
if (picture[p.y][p.x] == original){
     picture[p.y][p.x] = fill; 
```

在队列中 - 方法？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:42:27.200

作为参考，该问题已通过在它正在处理的数组周围添加一个缓冲区边框来解决。例如，如果要填充的数组是

```
000
000
000 
```

它被制成

```
 #####
   #000#
   #000#
   #000#
   ##### 
```

在被处理之前。

# javascript - Facebook + 仅提示发布流

> ID：12552101
> 
> 赞同：0
> 
> 时间：2012-09-23T11:47:48.497
> 
> 标签：javascript, facebook

如果我有一个用户已经登录到 facebook 但从他/她的帐户中删除了我的应用程序，我如何才能在用户已经登录后再次输入我的应用程序时才提示发布流？

谢谢。

```
 FB.getLoginStatus(function (response) {
            if (response.status === 'connected') {
                // the user is logged in and has authenticated your
                // app, and response.authResponse supplies
                // the user's ID, a valid access token, a signed
                // request, and the time the access token 
                // and signed request each expire
                uid = response.authResponse.userID;
                accesstoken = response.authResponse.accessToken;
                SrReferral = '@ViewBag.Referral';
                window.fbuserid = uid;
                var postData = { facebookUID: uid, facebookAccessTok: accesstoken, facebookSrReferral: SrReferral };
                $.ajax({
                    url: '@Url.Action("DisplayGolfers")',
                    type: 'POST',
                    data: postData,
                    dataType: 'html',
                    success: function (responseText) {
                        $("#container").html(responseText);
                    }
                });
            } else if (response.status === 'not_authorized') {
                // the user is logged in to Facebook, 
                // but has not authenticated your app 
            } else {
                // the user isn't logged in to Facebook.
                window.FB.login(function (response) {
                    if (response.authResponse) {
                        uid = response.authResponse.userID;
                        accesstoken = response.authResponse.accessToken;
                        SrReferral = '@ViewBag.Referral';
                        window.fbuserid = uid;
                        var postData = { facebookUID: uid, facebookAccessTok: accesstoken, facebookSrReferral: SrReferral };
                        $.ajax({
                            url: '@Url.Action("DisplayGolfers")',
                            type: 'POST',
                            data: postData,
                            dataType: 'html',
                            success: function (responseText) {
                                $("#container").html(responseText);
                            }
                        });
                    } else {
                        console.log('User cancelled login or did not fully authorize.');
                        alert('User cancelled login');
                    }
                }, { scope: 'publish_stream' });
            };
        });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T11:52:49.747

似乎我误解了您的问题，并且您希望用户保持登录状态，即使他从 Facebook 上的帐户中删除了应用程序。这真的很糟糕，很容易成为安全问题。

一旦用户删除了您的应用程序，他就不应该登录！

如果您不想在用户下次访问您的应用程序之前提示用户权限，您应该定义您的情况下的“下一次”（小时/天/浏览器会话/等）并设置一些 cookie/会话检查每次访问是否是正确的提示时间。

* * *

您可以使用第二个参数`FB.getLoginStatus`来始终获取用户的最新状态（对于删除您的应用程序的用户不会返回`connected`）。

```
FB.getLoginStatus(function(response) {
  // this will be called when the roundtrip to Facebook has completed
}, true); 
```

请参阅[文档](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)*的“往返 Facebook 的服务器”*部分[`FB.getLoginStatus`](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)

# objective-c - 简单的 NSOperationQueue 以 EXC_BAD_ACCESS 结尾

> ID：12552105
> 
> 赞同：0
> 
> 时间：2012-09-23T11:48:19.443
> 
> 标签：objective-c

```
NSBlockOperation *blockOperation = ^{NSLog(@"This is an NSBlockOperation");};
NSOperationQueue *ownQueue = [[NSOperationQueue alloc] init];
[ownQueue setMaxConcurrentOperationCount:2];        
[ownQueue addOperation:blockOperation]; 
```

我只是在尝试`NSBlockOperation`，但是这个简单的代码以`EXC_BAD_ACCESS`. 代码位于 main 中，并由`@autorelease`.

```
libsystem_c.dylib`OSAtomicCompareAndSwapIntBarrier$VARIANT$mp:
0x7fff8b8dc524:  movl   %edi, %eax

libsystem_c.dylib`OSAtomicCompareAndSwap32$VARIANT$mp + 2:

0x7fff8b8dc526:  lock   
0x7fff8b8dc527:  cmpxchgl%esi, (%rdx)
0x7fff8b8dc52a:  sete   %al
0x7fff8b8dc52d:  movzbl %al, %eax
0x7fff8b8dc530:  ret    
0x7fff8b8dc531:  nopl   (%rax) 
```

程序停止并指向`0x7fff8b8dc526: lock`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:18:09.367

您尝试将块分配给 a `NSBlockOperation`，但这是不同的类型。正确的是

```
NSBlockOperation *blockOperation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"This is an NSBlockOperation");
}]; 
```

# php - Paypal - 使用 php 加密 buynow 动态结帐按钮

> ID：12552124
> 
> 赞同：1
> 
> 时间：2012-09-23T11:51:19.263
> 
> 标签：php, paypal, localhost, paypal-ipn, paypal-sandbox

上周我一直在尝试制作一个加密的“使用贝宝结帐”按钮。

最后我在这个网站“https://ppmts.custhelp.com/app/answers/detail/a_id/502”中找到了使用php的加密网络支付

我试图根据我在本地主机中的站点在该示例中实现。但显示错误“收到错误 #3”

这是我的代码 Example.php

```
 <?php
         $config = array("cert_id" => "PHCVJS6GDV6TY", "business" => "roki_1347003608_biz@gmail.com","basedir" => "./",
          "certstore" => "./", "tempdir" => "./", "my_private" => "my-prvkey.pem",          "my_public" => "my.pubcert.pem",
         "paypal_public" => "paypal_cert_pem.txt");
          $paypal = new PayPal_EncryptedButtons($config);

      // You can add parameters to the button one by one (name, value) or you can pass two
       // arrays of names and values, as documented below.
    $names = array("amount", "currency_code", "item_name", "item_number");
        $values = array("2.56", "USD", "Dave's secret encryption sauce (encryption via PHP)", "123456");
     $paypal->addButtonParam($names, $values);

     // We can now generate our code
     $result = $paypal->encryptButtonData();
     if ($result !== PP_ERROR_OK) {
     // Something went wrong
      echo "Received Error #".$result."\n";
       exit;
         }

   // Get the string of encrypted button data

           echo '<form action="https://www.sandbox.paypal.com/cgi-bin/webscr"       method="post">';
     echo '<input type="hidden" name="cmd" value="_s-xclick">';
         echo '<input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/x-click-but23.gif" border="0" name="submit" alt="Make payments with PayPal - it\'s fast, free and secure!">';             
     echo '<input type="hidden" name="encrypted" value="';
        echo $paypal->getButton();
         echo '">';
        echo "</form>\n";
         ?>
      </body>
         </html> 
```

加密按钮.php

```
 <?php

        define("PP_ERROR_OK", 0);
        define("PP_ERROR_FILE", 1);
        define("PP_ERROR_OPENSSL", 2);
        define("PP_ERROR_DATA", 3);
        define("PP_ERROR_PARAMS", 4);
        define("PP_ERROR_NOTFOUND", 5);
        define("PP_ERROR_UNKNOWN", 6);

       require_once "/wamp/www/var/Php/Config.php";

       class PayPal_EncryptedButtons {

        /** Button Data Array */
          var $buttonData = array();

        /** Config Pointer */
          var $config;

           /** Internal Data Handler */
               var $_data;

               /** Random Transaction ID */
            var $_rnd;

                var $debug = true;

          function PayPal_EncryptedButtons($config = array()) {
          $this->config = new PayPal_EncryptedButtons_Config;
               /*
               foreach ($config as $name => $val) {
            if ($this->config->$name) {
          $this->config->$name = $val;
              }
              else {
           return PP_ERROR_UNKNOWN;
             }
          }
              */
             return;
            }

              function changeConfig($name, $value = "") {
           if ($this->config->$name) {
           $this->config->$name = $value;
              return true;
                }
           else {
            return false;
             }
                   }

           function addButtonParam($names = "", $values = "") {
            if ((is_array($names) && !is_array($values)) || (!is_array($names) &&       is_array($values))) {
                  return PP_ERROR_PARAMS;
            }
            elseif (is_array($names) && is_array($values)) {
            if (count($names) !== count($values)) {
             return PP_ERROR_PARAMS;
               }
                $i = 0;
           while ($i < count($names)) {
              $this->buttonData[$names[$i]] = $values[$i];
           $i++;
         }
           return PP_ERROR_OK;
              }
          else {
         if ($names == "" || $values == "") {
        return PP_ERROR_PARAMS;
      }
         else {
         $this->buttonData[$names] = $values;
         return PP_ERROR_OK;
           }
         }
              }

            function delButtonParam($name = "") {
       if ($name == "") {
       return PP_ERROR_PARAMS;
     }
        if ($this->buttonData[$name] !== null) {
          $this->buttonData[$name] = null;
        return PP_ERROR_OK;
        }
           return PP_ERROR_NOTFOUND + 10;
              }

          function encryptButtonData() {
       $this->encryptedButton = null;
            if (!is_dir($this->config->basedir)) {
      if (!mkdir($this->config->basedir)) {
     return PP_ERROR_NOTFOUND + 20;
       }
           }
             @chdir($this->config->basedir);
          $this->_data = "cmd=_xclick\n";
        $this->_data .= "business=".$this->config->business."\n";
            $this->_data .= "receiver_email=".$this->config->receiver_email."\n";
           foreach ($this->buttonData as $name => $val) {
       if ($val == null) { continue; }
        $this->_data .= $name."=".$val."\n";
            }
         $this->_data .= "cert_id=".$this->config->cert_id;
          $this->_rnd = rand(100000, 999999);
       if (!is_dir($this->config->tempdir)) {
        if (!@mkdir($this->config->tempdir)) {
     return PP_ERROR_NOTFOUND + 30;
            }
       }
              $f = @fopen($this->config->tempdir.$this->_rnd.".1", "w");
           //if (!$f) { return PP_ERROR_FILE; }
              if (!$f) { return 41; }
                    fwrite($f, trim($this->_data), strlen(trim($this->_data)));
                fclose($f);
                    if (!file_exists($this->config->my_private)) {
                 return 145;
                     }
                  if (!file_exists($this->config->my_public)) {
                 return 245;
                  }
           if (!file_exists($this->config->paypal_public)) {
       return 345;
           }
            if (!file_exists($this->config->my_private) || !file_exists($this->config->my_public) || !file_exists($this->config->paypal_public)) {
             return PP_ERROR_NOTFOUND + 40;
            }
              $exec = $this->config->openssl." smime -sign -in ".$this->config->tempdir.$this->_rnd.".1 -signer ".$this->config->my_public." -inkey ".$this->config->my_private." -outform der -nodetach -binary > ".$this->config->tempdir.$this->_rnd.".2";
       $status1 = `$exec`;
           $exec = $this->config->openssl." smime -encrypt -des3 -binary -outform pem ".$this->config->paypal_public." < ".$this->config->tempdir.$this->_rnd.".2 > ".$this-    >config->tempdir.$this->_rnd.".3";
             $status2 = `$exec`;
             $this->encryptedButton = trim(file_get_contents($this->config->tempdir.$this->_rnd.".3"));
             @unlink($this->config->tempdir.$this->_rnd.".1");
           @unlink($this->config->tempdir.$this->_rnd.".2");
            @unlink($this->config->tempdir.$this->_rnd.".3");
            if (strpos($status1, "No such file or directory") !== false ||        strpos($status2, "No such file or directory") !== false) {
           return PP_ERROR_OPENSSL;
         }
          if (!$this->encryptedButton) {
         return PP_ERROR_DATA;
        }
            return PP_ERROR_OK;
       }

           function getButton() {
       if (!$this->encryptedButton) {
      return "";
          }
       return $this->encryptedButton;
        } 
```

配置文件

```
 <?php
      class PayPal_EncryptedButtons_Config {
      var $cert_id = "PHCVJS6GDV6TY";
       var $business = "roki_1347003608_biz@gmail.com";

       var $receiver_email = "";

        var $basedir = "/wamp/www/var/";

        var $certstore = "/wamp/www/key/cert/";

        var $tempdir = "/wamp/www/temp/";

        var $openssl = "openssl";

       var $my_private = "/wamp/www/key/cert/my-prvkey.pem";

       /* Your Public Certificate Filename */
       var $my_public = "/wamp/www/key/cert/my.pubcert.pem";

       /* PayPal's Public Certificate Filename */
        var $paypal_public = "/wamp/www/key/cert/paypal_cert_pem.txt";

      }

        ?> 
```

错误

```
 Received Error #3 
```

任何人都可以知道这是什么错误，任何人都可以帮助我如何解决这个问题，我真的帮助较少。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:48:36.030

问题是要使脚本正常工作，您需要拥有 OpenSSL。在脚本的注释中，它确实指定它使用它来加密 PayPal 按钮。

此行是导致问题的原因，因为它无法创建文件，因为尚未指定 OpenSSL。

```
$exec = $this->config->openssl." smime -encrypt -des3 -binary -outform pem ".$this->config->paypal_public." < ".$this->config->tempdir.$this->_rnd.".2 > ".$this->config->tempdir.$this->_rnd.".3"; 
```

您需要指定 OpenSSL 的路径才能使其工作。

以下内容来自您链接的网站。

配置：

```
/* OpenSSL Path - Path to the OpenSSL Binary */
/* If openssl isn't in your PATH, then change this to where it's located, otherwise leave it as it is */
/* No trailing slash */
var $openssl = "openssl"; 
```

有关在本地主机中使用 OpenSSL 的信息可以通过以下 google 查询找到： [https ://www.google.co.uk/search?q=openssl+for+localhost](https://www.google.co.uk/search?q=openssl+for+localhost)

OpenSSL：[http ://www.openssl.org/](http://www.openssl.org/)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T16:34:37.083

在某些托管计划中，设置它可能是一个真正的熊或不可能。另一个建议是不加密，而是使用篡改检测哈希技巧，然后在处理 IPN 时检查这一点。我在这里记录这个：

[如何使用自定义字段制作 PayPal 加密的“立即购买”按钮？](https://stackoverflow.com/q/14489512/105539)

# objective-c - 导航控制器（setTextColor）中自定义字体的颜色：灰色而不是白色

> ID：12552125
> 
> 赞同：0
> 
> 时间：2012-09-23T11:51:26.027
> 
> 标签：objective-c, fonts, uinavigationcontroller, uinavigationitem

我正在尝试为我的应用导航栏标题中的字体设置自定义字体和颜色（白色）。**而不是白色，我得到灰色文本颜色。**

这是我用来设置自定义字体的代码：

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 320, 30)];
label.textAlignment = UITextAlignmentCenter;
label.adjustsFontSizeToFitWidth = NO;
label.minimumFontSize = 10.0;
[label setFont:[UIFont fontWithName:@"HelveticaNeueLTCom-MdCn" size:24.0]];
[label setBackgroundColor:[UIColor clearColor]];
[label setTextColor:[UIColor whiteColor]];
[label setText:@"View title"];
[self.navigationItem setTitleView:label]; 
```

当我尝试在 UITableView 部分中设置自定义字体颜色时，也发生了同样的事情。

我知道 Helvetica Neue 在 iPhone 应用程序开发中的一些问题，但这种字体的颜色在我项目的其他部分中效果很好。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:29:09.047

您是否尝试过其他`.ttf`字体只是为了测试它们是否有效？我想知道字体文件本身是否有问题。[试试这个目录](http://www.nadimnabi.com/fonts/)，看看它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T11:39:45.047

问题是我（故意）覆盖了整个应用程序的默认字体，[如本答案中所述](https://stackoverflow.com/a/7607281/963881)。

解决方案是删除此覆盖（所有`#import`'s 和`.m`从目标中删除文件，或者只是删除两个类文件。

# android - 无连接时Android强制关闭

> ID：12552138
> 
> 赞同：2
> 
> 时间：2012-09-23T11:53:00.917
> 
> 标签：android

我正在制作一个使用互联网连接的应用程序。当我尝试下载数据，但没有互联网连接应用程序强制关闭。如果我希望应用程序不抛出强制关闭消息，而是我自己的消息，例如“没有连接......”，然后关闭活动，我需要做什么。谢谢！

我的 logcat 输出：

```
09-23 14:56:15.411: E/AndroidRuntime(20770): FATAL EXCEPTION: main
09-23 14:56:15.411: E/AndroidRuntime(20770): java.lang.RuntimeException: Unable to start activity ComponentInfo{lt.prasom/lt.prasom.GoodOffers}: java.lang.NullPointerException
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.os.Looper.loop(Looper.java:130)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread.main(ActivityThread.java:3683)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at java.lang.reflect.Method.invokeNative(Native Method)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at java.lang.reflect.Method.invoke(Method.java:507)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at dalvik.system.NativeStart.main(Native Method)
09-23 14:56:15.411: E/AndroidRuntime(20770): Caused by: java.lang.NullPointerException
09-23 14:56:15.411: E/AndroidRuntime(20770):    at java.io.StringReader.<init>(StringReader.java:46)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at lt.prasom.functions.XMLParser.getDomElement(XMLParser.java:73)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at lt.prasom.GoodOffers.onCreate(GoodOffers.java:68)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
09-23 14:56:15.411: E/AndroidRuntime(20770):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
09-23 14:56:15.411: E/AndroidRuntime(20770):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T15:18:24.173

以下函数用于检测设备是否连接到网络。

```
 public static boolean isNetworkAvailable(Context context) {
     ConnectivityManager connectivity = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
     if (connectivity != null) {
        NetworkInfo[] info = connectivity.getAllNetworkInfo();
        if (info != null) {
           for (int i = 0; i < info.length; i++) {
              if (info[i].getState() == NetworkInfo.State.CONNECTED) {
                 return true;
              }
           }
        }
     }
     return false;
  } 
```

您可以调用如下所示的函数...

```
if(!isNetworkAvailable(context))
     // Show Toast here...
else
     //perform action ... 
```

希望能帮助到你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:20:45.520

在进行网络连接之前，请检查网络连接是否可用。检查此[检测 Internet 连接](https://stackoverflow.com/questions/4238921/android-detect-whether-there-is-an-internet-connection-available)

如果网络连接可用，请继续进行处理，如果没有，您可以使用[Toast](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)消息或[AlertDialog](http://developer.android.com/reference/android/app/AlertDialog.html)向用户显示适当的消息。

如果您计划在互联网连接不可用时关闭活动，请显示 Toast 消息并调用[finish()](http://developer.android.com/reference/android/app/Activity.html#finish%28%29)方法。像这样的东西：

```
 if (noNetworkAvailable) {
        Toast.makeText(getApplicationContext(), "No network available",
                Toast.LENGTH_SHORT).show();
        finish();
    } 
```

注意：由于 finish() 方法会关闭活动，因此请使用 Toast 消息而不是 AlertDialog，因为它会导致“android.view.WindowLeaked”异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:16:16.573

在清单中，您必须添加互联网权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# c# - SlimDX Direct3D11 中的线框

> ID：12552140
> 
> 赞同：2
> 
> 时间：2012-09-23T11:53:28.043
> 
> 标签：c#, 3d, slimdx, direct3d11

我正在尝试使用 SlimDX 渲染线框 3D 模型。

谷歌搜索后，我只找到了高级主题，而不是如何在 SlimDX 中绘制线框。他们说我必须使用着色器来做到这一点。

由于我是 DirectX 的新手，我不太了解 HLSL。

我怎么画它？如果真的需要使用着色器，谁能给我一个例子或提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:55:31.047

由于您使用 Direct3D 11，因此您将需要使用着色器来绘制任何内容（固定功能已从 directx10 中删除）。

对于线框，您确实需要设置光栅化器状态，​​这是一个示例（我还在那里删除了剔除：

```
RasterizerStateDescription rsd = new RasterizerStateDescription()
{
    CullMode = CullMode.None,
    DepthBias = 0,
    DepthBiasClamp = 0.0f,
    FillMode = FillMode.Wireframe,
    IsAntialiasedLineEnabled = false,
    IsDepthClipEnabled = false,
    IsFrontCounterclockwise = false,
    IsMultisampleEnabled = false,
    IsScissorEnabled = false,
    SlopeScaledDepthBias = 0.0f             
}; 
```

然后应用这个状态，

```
RasterizerState rs = RasterizerState.FromDescription(device, rsd);
device.ImmediateContext.Rasterizer.State = rs; 
```

在我承认 SlimDX 的教程并不多之后，对于 c++ 有

[http://www.rastertek.com/tutdx11.html](http://www.rastertek.com/tutdx11.html)

您至少可以在其中找到一些基本的着色器示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T04:07:22.547

这是我发现的，它对我有用：

```
device.SetRenderState<FillMode>(RenderState.FillMode, FillMode.Wireframe); 
```

# java - 在 Java 中调整图像大小而不会失去透明度

> ID：12552144
> 
> 赞同：5
> 
> 时间：2012-09-23T11:55:11.140
> 
> 标签：java, image, resize, png, gif

我想在不丢失透明度的情况下调整图像（jpg、png、gif）的大小。

我想在调整大小后将调整大小的版本保存到磁盘。

我用谷歌搜索了很多，但我只找到了失去透明度并将透明空间填充为黑色的解决方案......

我正在寻找可以完成这项工作的片段或库:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-17T08:11:29.980

经过研究，我发现只有将缓冲区图像保留为 BufferedImage 而不将其转换为 ImageIcon 才能调整其大小

我这样解决问题：

```
public class NewJFrame extends javax.swing.JFrame {

/**
 * Creates new form NewJFrame
 */
public NewJFrame()  {
    try {
        initComponents();
        BufferedImage c = ImageIO.read(new File("60_Personnel.png"));
        JLabel lblMains = new JLabel( new ImageIcon(c));
        this.add(lblMains);                                       //add real size
        this.add(new JLabel(new ImageIcon((resize(c, 150)))));    //add converting image
        this.pack();
        this.setLocationRelativeTo(null);
        this.setVisible(true);
    } catch (IOException ex) {
        Logger.getLogger(NewJFrame.class.getName()).log(Level.SEVERE, null, ex);
    }

}

public static BufferedImage resize(Object img, int percent) {
    BufferedImage buff = (BufferedImage) img;
    return resize(buff, buff.getWidth() * percent / 100, buff.getWidth() * percent / 100);
}

public static BufferedImage resize(BufferedImage img, int newW, int newH) {
    Image tmp = img.getScaledInstance(newW, newH, Image.SCALE_SMOOTH);
    BufferedImage dimg = new BufferedImage(newW, newH, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2d = dimg.createGraphics();
    g2d.drawImage(tmp, 0, 0, null);
    g2d.dispose();
    return dimg;
} 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-03-27T21:30:25.087

更改如下内容：

```
public static BufferedImage resizeImage(BufferedImage originalImage, int targetWidth, int targetHeight) {
        BufferedImage resizedImage = new BufferedImage(targetWidth, targetHeight, BufferedImage.TYPE_INT_RGB);
        Graphics2D graphics2D = resizedImage.createGraphics();
        graphics2D.drawImage(originalImage, 0, 0, targetWidth, targetHeight, null);
        graphics2D.dispose();
        return resizedImage;
    } 
```

对此：

```
public static BufferedImage resizeImage(BufferedImage originalImage, int targetWidth, int targetHeight) {
        BufferedImage resizedImage = new BufferedImage(targetWidth, targetHeight, BufferedImage.TYPE_INT_ARGB);
        Graphics2D graphics2D = resizedImage.createGraphics();
        graphics2D.drawImage(originalImage, 0, 0, targetWidth, targetHeight, null);
        graphics2D.dispose();
        return resizedImage;
    } 
```

您基本上将“BufferedImage.TYPE_INT_RGB”更改为“BufferedImage.TYPE_INT_ARGB”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T13:25:04.613

这就是我解决问题的方法：

```
public static BufferedImage convertRGBAToIndexed(BufferedImage src) {
    BufferedImage dest = new BufferedImage(src.getWidth(), src.getHeight(), BufferedImage.TYPE_BYTE_INDEXED);
    Graphics g = dest.getGraphics();
    g.setColor(new Color(231, 20, 189));
    g.fillRect(0, 0, dest.getWidth(), dest.getHeight());
    dest = makeTransparent(dest, 0, 0);
    dest.createGraphics().drawImage(src, 0, 0, null);
    return dest;
}

public static BufferedImage makeTransparent(BufferedImage image, int x, int y) {
    ColorModel cm = image.getColorModel();
    if (!(cm instanceof IndexColorModel))
        return image; // sorry...
    IndexColorModel icm = (IndexColorModel) cm;
    WritableRaster raster = image.getRaster();
    int pixel = raster.getSample(x, y, 0);
    int size = icm.getMapSize();
    byte[] reds = new byte[size];
    byte[] greens = new byte[size];
    byte[] blues = new byte[size];
    icm.getReds(reds);
    icm.getGreens(greens);
    icm.getBlues(blues);
    IndexColorModel icm2 = new IndexColorModel(8, size, reds, greens, blues, pixel);
    return new BufferedImage(icm2, raster, image.isAlphaPremultiplied(), null);
}

public static Dimension getScaledDimension(Dimension imgSize, Dimension boundary) {
    int original_width = imgSize.width;
    int original_height = imgSize.height;
    int bound_width = boundary.width;
    int bound_height = boundary.height;
    int new_width = 0;
    int new_height = 0;

    if (original_width > original_height) {
        new_width = bound_width;
        new_height = (new_width*original_height)/original_width;
    } else {
        new_height = bound_height;
        new_width = (new_height*original_width)/original_height;
    }

    return new Dimension(new_width, new_height);
}

public static void resizeImage(File original_image, File resized_image, int IMG_SIZE) {
    try {
        BufferedImage originalImage = ImageIO.read(original_image);

        String extension = Files.getFileExtension(original_image.getName());

        int type = extension.equals("gif") || (originalImage.getType() == 0) ? BufferedImage.TYPE_INT_ARGB : originalImage.getType();

        Dimension new_dim = getScaledDimension(new Dimension(originalImage.getWidth(), originalImage.getHeight()), new Dimension(IMG_SIZE,IMG_SIZE));

        BufferedImage resizedImage = new BufferedImage((int) new_dim.getWidth(), (int) new_dim.getHeight(), type);
        Graphics2D g = resizedImage.createGraphics();
        g.drawImage(originalImage, 0, 0, (int) new_dim.getWidth(), (int) new_dim.getHeight(), null);
        g.dispose();            

        if (!extension.equals("gif")) {
            ImageIO.write(resizedImage, extension, resized_image);
        } else {
            // Gif Transparence workarround
            ImageIO.write(convertRGBAToIndexed(resizedImage), "gif", resized_image);
        }

    } catch (IOException e) {
        Utils.log("resizeImage", e.getMessage());
    }
} 
```

# android - Android ListView 抛出 NullPointerException

> ID：12552150
> 
> 赞同：1
> 
> 时间：2012-09-23T11:55:40.047
> 
> 标签：android, listview

我有一个从 web 服务获取 HTTP 响应的 android 应用程序，我将其处理成字符串数组。我尝试在 ListView 中显示这些字符串。它们不需要被点击来执行任何操作，只需显示并且可以滚动。
运行时，一切正常，但是当我尝试向下滚动超出我必须显示的项目数量时（因为列表上没有要显示的字符串），我得到一个 NullPointerException。显然我一定做错了什么。
我不太明白。我写了一个类似的例子作为测试，它工作得很好。示例中的列表仅在没有更多项目可显示时滚动并停止。我能想到的唯一区别是，在原始应用程序上，数组是在线程上创建的，然后线程使用处理程序运行可运行文件以在 gui 上显示列表。

当获取字符串并将它们命令到数组中显示的线程完成时，他使用处理程序运行此代码：

```
 scoreList = (ListView) findViewById(R.id.scorelist);
    ArrayAdapter<String> myAdapter =  new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,scoreResult);
    scoreList.setAdapter(myAdapter); 
```

比尝试滚动低于底部时应用程序崩溃。这是来自 adb logcat 的错误：

```
D/AndroidRuntime(  864): Shutting down VM
W/dalvikvm(  864): threadid=1: thread exiting with uncaught exception (group=0x4
001d800)
E/AndroidRuntime(  864): FATAL EXCEPTION: main
E/AndroidRuntime(  864): java.lang.NullPointerException
E/AndroidRuntime(  864):        at android.widget.ArrayAdapter.createViewFromRes
ource(ArrayAdapter.java:355)
E/AndroidRuntime(  864):        at android.widget.ArrayAdapter.getView(ArrayAdap
ter.java:323)
E/AndroidRuntime(  864):        at android.widget.AbsListView.obtainView(AbsList
View.java:1294)
E/AndroidRuntime(  864):        at android.widget.ListView.makeAndAddView(ListVi
ew.java:1727)
E/AndroidRuntime(  864):        at android.widget.ListView.fillDown(ListView.jav
a:652)
E/AndroidRuntime(  864):        at android.widget.ListView.fillGap(ListView.java
:623)
E/AndroidRuntime(  864):        at android.widget.AbsListView.trackMotionScroll(
AbsListView.java:2944)
E/AndroidRuntime(  864):        at android.widget.AbsListView.onTouchEvent(AbsLi
stView.java:2065)
E/AndroidRuntime(  864):        at android.widget.ListView.onTouchEvent(ListView
.java:3315)
E/AndroidRuntime(  864):        at android.view.View.dispatchTouchEvent(View.jav
a:3766)
E/AndroidRuntime(  864):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:897)
E/AndroidRuntime(  864):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:936)
E/AndroidRuntime(  864):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:936)
E/AndroidRuntime(  864):        at android.view.ViewGroup.dispatchTouchEvent(Vie
wGroup.java:936)
E/AndroidRuntime(  864):        at com.android.internal.policy.impl.PhoneWindow$
DecorView.superDispatchTouchEvent(PhoneWindow.java:1671)
E/AndroidRuntime(  864):        at com.android.internal.policy.impl.PhoneWindow.
superDispatchTouchEvent(PhoneWindow.java:1107)
E/AndroidRuntime(  864):        at android.app.Activity.dispatchTouchEvent(Activ
ity.java:2086)
E/AndroidRuntime(  864):        at com.android.internal.policy.impl.PhoneWindow$
DecorView.dispatchTouchEvent(PhoneWindow.java:1655)
E/AndroidRuntime(  864):        at android.view.ViewRoot.handleMessage(ViewRoot.
java:1785)
E/AndroidRuntime(  864):        at android.os.Handler.dispatchMessage(Handler.ja
va:99)
E/AndroidRuntime(  864):        at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime(  864):        at android.app.ActivityThread.main(ActivityThrea
d.java:4627)
E/AndroidRuntime(  864):        at java.lang.reflect.Method.invokeNative(Native
Method)
E/AndroidRuntime(  864):        at java.lang.reflect.Method.invoke(Method.java:5
21)
E/AndroidRuntime(  864):        at com.android.internal.os.ZygoteInit$MethodAndA
rgsCaller.run(ZygoteInit.java:868)
E/AndroidRuntime(  864):        at com.android.internal.os.ZygoteInit.main(Zygot
eInit.java:626)
E/AndroidRuntime(  864):        at dalvik.system.NativeStart.main(Native Method)

W/ActivityManager(   59):   Force finishing activity memo.ori.friend/.Highscores

W/ActivityManager(   59): Activity pause timeout for HistoryRecord{4503fed0 memo
.ori.friend/.Highscores}
W/WindowManager(   59): No window to dispatch pointer action 1
W/ActivityManager(   59): Launch timeout has expired, giving up wake lock!
W/ActivityManager(   59): Activity idle timeout for HistoryRecord{45023af0 memo.
ori.friend/.MemoFriendActivity}
D/dalvikvm(  261): GC_EXPLICIT freed 45 objects / 2128 bytes in 108ms
W/ActivityManager(   59): Activity destroy timeout for HistoryRecord{4503fed0 me
mo.ori.friend/.Highscores}
D/SntpClient(   59): request time failed: java.net.SocketException: Address fami
ly not supported by protocol
I/Process (  864): Sending signal. PID: 864 SIG: 9
I/ActivityManager(   59): Process memo.ori.friend (pid 864) has died.
I/WindowManager(   59): WIN DEATH: Window{45077ce0 memo.ori.friend/memo.ori.frie
nd.MemoFriendActivity paused=false}
I/WindowManager(   59): WIN DEATH: Window{4507cf60 memo.ori.friend/memo.ori.frie
nd.Highscores paused=false}
I/UsageStats(   59): Unexpected resume of com.android.launcher while already res
umed in memo.ori.friend
W/InputManagerService(   59): Got RemoteException sending setActive(false) notif
ication to pid 864 uid 10044
W/IInputConnectionWrapper(  126): showStatusIcon on inactive InputConnection
D/SntpClient(   59): request time failed: java.net.SocketException: Address fami
ly not supported by protocol 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:08:42.023

> 运行时，一切正常，但是当我尝试向下滚动超出我必须显示的项目数量时（因为列表上没有更多字符串要显示），我得到一个 NullPointerException。显然我一定做错了什么。

该异常来自您`null`传递`scoreResult`给`ArrayAdapter`. 这是因为默认情况下，如果该项目的类型不是（你有），`ArrayAdapter`则将调用（在它`getView`负责构建列表行的方法中）数据列表中每个项目的方法，以获得要在行中显示的该项目的文本表示。`toString``CharSequence``String`

因此，请检查`scoreResult`列表/数组并确保其中没有`null`值。我看到您谈到数组，请确保数组与数据所需的一样大，如果它比数据大，那么您将`null`在其末尾具有值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:01:20.290

```
request time failed: java.net.SocketException: Address fami
ly not supported by protocol 
```

请检查那里有什么，有些不好。

NullPointerException 它是初学者程序员的标志：它不验证参数并且他在 1 行中编写了多个语句。在这种情况下，我会检查`scoreResult`不为空，但至少不为空

# jpa-2.0 - JPA2 我应该更喜欢条件查询而不是 JPQL 吗？

> ID：12552154
> 
> 赞同：0
> 
> 时间：2012-09-23T11:56:21.353
> 
> 标签：jpa-2.0, criteria-api

所以我有三个模型.. Crag 有一个或多个 CragLocation，每个 CragLocation 都有一个 Location。我可以使用查询某个 crags 子集

```
public List<Crag> getCragsWithGridRef() {
        /**
         * we want to query select c.* from crag c join CragLocation cl on c.id
         * = cl.cragId join Location l on cl.locationId = l.id where
         * len(l.gridReference)>1
         */
        TypedQuery<Crag> query = 
                em.createQuery(
                        "SELECT c FROM Crag c JOIN c.CragLocations cl JOIN cl.location l where LENGTH(l.gridReference) > 1",
                        Crag.class);
        return query.getResultList();
    } 
```

我主要以这种方式查询，因为我的大脑无法处理标准查询。当我看着它们时，我很难解析它们的含义。

那么是否有性能或可维护性（或其他）理由更喜欢标准查询，如果是，您将如何表达此查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T14:34:01.777

不，没有理由比 JPQL 更喜欢条件查询，特别是如果您认为 JPQL 查询易于理解和维护，而条件查询难以理解和维护（我同意）。

条件查询，如果你使用自动生成的元模型，很难写，但一旦写出来，你可以确定没有语法错误。不过，这并不意味着查询完成​​了它应该做的事情。因此，无论如何，您都应该对查询进行单元测试。如果您有涵盖查询的单元测试，则使用您认为最易读和可维护的内容。即使生成底层 SQL 查询存在性能差异，与实际执行查询的成本相比，这种差异也可以忽略不计。

我只在这两种情况下使用 Criteria 查询（甚至不总是）：

1.  查询由一组可选的搜索条件动态组成
2.  有许多类似的查询共享一个公共部分，我想避免在每个查询中重复这个公共部分。使用标准允许将公共部分放在可重用的方法中。

# python - 在 wtform 中使用 onKeyDown 事件

> ID：12552155
> 
> 赞同：1
> 
> 时间：2012-09-23T11:56:23.380
> 
> 标签：python, flask

目前正在尝试使用flask和wtforms来制作一个html表单。我的 for 模板如下所示：

```
<ul><li>Description:</li>
<li> <textarea class="input" rows="10" cols="50" name="description" onKeyDown="limitText(this.form.description,this.form.countdown,150);" 
```

onKeyUp="limitText(this.form.description,this.form.countdown,150);"> 文章描述。您还有字符。

我想使用 wtforms 并替换：

```
<textarea..> with {{form.description}}. 
```

但是那我该如何合并 onkeydown 事件呢？我需要它来计算已经在 textarea 中输入的字符数。

顺便提一句。我使用 wtforms 制作的表单如下所示：

```
class ItemForm(Form):
title       = TextField("Title")
subtitle    = TextAreaField("Sub Title")
Description = TextAreaField("Description")
offervalue  = FloatField("Offer Value")
imagefile_1 = FileField("Image File 1")
imagefile_2 = FileField("Image File 2")
imagefile_3 = FileField("Image File 3") 
```

问题：即使在文本区域中发生的任何事情，我仍应如何将 JAVASCRIPT 包括在内？

感谢任何指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T21:12:31.863

您需要使用一些东西来选择文本区域并将键盘事件绑定到它。我建议像这样使用 jQuery：

```
$('textarea .input').keypress(function() {
  limitText(this.form.description,this.form.countdown,150);
}); 
```

`keypress`您可以在此处查看事件的文档：http: [//api.jquery.com/keypress/](http://api.jquery.com/keypress/) jQuery 也可以绑定到`keyup`或`keydown`事件。

如果您不熟悉 jQuery，这是一个很好的起点：[http ://docs.jquery.com/How_jQuery_Works](http://docs.jquery.com/How_jQuery_Works)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-29T18:58:58.130

看起来我有点晚了，但我的个人收据是：

1.  将您的脚本保存在单独的文件中，即`myscripts.js`
2.  通过附加`myscripts.js`到所需的 HTML 页面`<script url="<path/to/myscripts.js>"></scripts>`
3.  假设您在目标 HTML 页面中有函数`foo(eventObject)`,`myscripts.js`和元素。`bar`
4.  放入`myscripts.js`function `linker()`，这将粘合这些组件（我使用 jQuery 作为示例，但也可以使用纯 JavaScript 进行填充）：

    函数链接器（）{$（bar）.on（*事件*，函数blablabla（eventObject）{foo（eventObject）；}）}

5.  `linker()`从您的 HTML 页面调用。

# c - 我们可以将任何参数传递给主函数吗？

> ID：12552158
> 
> 赞同：2
> 
> 时间：2012-09-23T11:56:52.303
> 
> 标签：c, gcc

我见过一个可以打印自己的程序，如下所示：

```
main(a){printf(a,34,a="main(a){printf(a,34,a=%c%s%c,34);}",34);} 
```

我的问题是：为什么它可以在`a`不指定任何类型的情况下传递一个`main`函数？我知道`main`函数的参数是`void`or `argc, argv`。那么，`a`这里的意思是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:02:36.360

这是 C (K&R, C89) 的*隐式 int*特性。如果您遗漏了类型，`int`则由解析器假定。IIRC 它在 C99 中被标记为*已过时。*它还允许您编写声明，例如

```
 static foo;   /* static int foo; */ 
```

# tfs - TF30279: 无法加载 ID 为“Microsoft.ProjectCreationWizard.Build”的类型为“项目创建插件”的插件

> ID：12552165
> 
> 赞同：1
> 
> 时间：2012-09-23T11:57:36.457
> 
> 标签：tfs, visual-studio-2012

尝试从 VS2012 创建新的 TFS 团队项目时，按完成后收到以下错误。

TF30279: 无法加载 ID 为“Microsoft.ProjectCreationWizard.Build”的类型为“项目创建插件”的插件

TFS 和 VS 都安装在 Windows 7 笔记本电脑上进行评估。在设置 TFS 时，我没有错误地配置了构建服务器。

为了解决这个问题，我卸载了所有 2012 组件 VS、TFS 和 Sql Server，然后重新安装了它们。我尝试了 TFS express 和 VS2012 的 web express 和完整的 TFS 试用版和 VS2012 高级试用版（以排除这不是 express 版本的问题）

每次重新安装时错误都会持续存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T11:57:36.457

虽然我找不到问题发生的原因，但在阅读了流程模板并了解插件模型的来源后，我最终还是设法解决了这个问题。

1）我打开VS2012命令提示符并以管理员身份运行

2) 将目录更改为 %programfiles%\Microsoft Visual Studio 11.0\Common7\IDE\CommonExtensions\Microsoft\TeamFoundation\Team Explorer

3) 为看起来与构建有关的文件夹中的每个 dll 运行 gacutil /i。

# java - 如何在 win7 64bit 下使用 javaFX 在网络摄像头上拍摄图像？

> ID：12552167
> 
> 赞同：1
> 
> 时间：2012-09-23T11:57:37.437
> 
> 标签：java, webcam, javafx

我想从网络摄像头拍摄图像。我怎样才能做到这一点？
如果您的建议库有任何示例代码，那对我来说比其他代码更好。

我检查了这些：

*   杰迈伦
*   Java 媒体框架
*   JavaCV
*   民事

这些没有用。这些不起作用或没有示例代码。你有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T13:40:28.770

试试这个项目：

[http://github.com/rladstaetter/isight-java/](http://github.com/rladstaetter/isight-java/)

以及相应的博文

[http://ladstatt.blogspot.co.at/2013/04/using-isight-camera-with-javafx.html](http://ladstatt.blogspot.co.at/2013/04/using-isight-camera-with-javafx.html)

请记住，您必须为您的架构（x64）拥有正确的 opencv dll

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T13:34:11.273

我剥离了 OpenIMAJ Core Video Capture Library 以从网络摄像头获取图像。它适用于我的 macbook、linux 桌面和 windows 7 环境。

你不需要安装任何东西，你只需要两个罐子。您可以从我的网站上找到示例：

[http://www.sleepingdumpling.com/blog/download/jvideoinput/](http://www.sleepingdumpling.com/blog/download/jvideoinput/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:53:57.153

这是[使用 LTI-CIVIL 的演示 JavaFX 相机捕获应用程序的链接](http://code.google.com/p/jfxcamera/)

LTI-CIVIL 库只有 32 位是正确的，所以在你的情况下，如果 64 位是必要的，那么可能没用。

# arrays - cakephp 下拉框和数组

> ID：12552168
> 
> 赞同：1
> 
> 时间：2012-09-23T11:57:42.323
> 
> 标签：arrays, cakephp, find

大家好，我在视图上有一个下拉框。我有一个返回模板列表的 find 语句，当我调试 find 时，它会打印出正确的 template.id 和 template.name 列表，但是当我提交表单时，它带有它在列表中的数字如果我在列表中选择第 5 个模板，它会保存 template_id = 5 而不是实际的模板 ID 号。

```
//Retrieve Account Id of current User       
$accountid=$this->Auth->user('account_id');

//conditions for template arrays
$conditions=
array('AND' => array(
    array('Template.account_id' => $accountid),
    array('Template.active' => 1)
));

//An array of all Templates belonging to the current User's Account
$templates=$this->Template->find('list', array(
    'conditions' => $conditions)); 
```

当我调试 $templates 我得到这个打印出来

```
array(
    (int) 1 => 'Consulting- Bus',
    (int) 2 => 'Consulting- Pers',
    (int) 7 => 'ClientEdge',
    (int) 8 => '11111',
    (int) 9 => 'testSUn',
    (int) 10 => 'Test Bruce Review',
    (int) 11 => 'Test Bruce 3 = Final' 
```

例如，当我选择“Test Bruce Review”并点击提交并调试它打印出“6”的值时，当我希望它在调试时打印出 10 时，下拉框中的第 6 项。

这是与此下拉框相关的表单中的片段

```
<tr><td><?php echo "Template: "?></td>
<td><?php echo $this->Form->input('template_id', array('label'=>false,'type'=>'select','options'=>$templates));?></td></tr> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:23:01.493

我在合并数组时遇到问题，导致我的 template.id 死亡

# nsviewcontroller - 停止 NSPopover 多次打开

> ID：12552172
> 
> 赞同：1
> 
> 时间：2012-09-23T11:58:15.150
> 
> 标签：nsviewcontroller, nspopover

我有一个 NSButton，单击它时会打开一个 NSPopover，我唯一的问题是，当再次单击该按钮时，NSPopover 会在另一个按钮之上再次打开，弹出窗口使用以下命令打开：

```
- (IBAction)openSettingsPopover:(id)sender {
    NSViewController *controller = [[NSViewController alloc] initWithNibName:@"Settings" bundle:nil];
    NSPopover *popover = [[NSPopover alloc] init];
    [popover setContentSize:NSMakeSize(288.0f, 170.0f)];
    [popover setContentViewController:controller];
    [popover setAnimates:YES];
    [popover showRelativeToRect:[sender bounds] ofView:sender preferredEdge:NSMaxXEdge];
} 
```

如果用户在视图之外单击，我将如何关闭弹出窗口而不是打开另一个弹出窗口？提前致谢。

![（左=单击一次，右=单击多次）](../Images/8095cf7cc6ea3cd3ffe3eaaef398690d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T10:04:59.930

Keep a reference to the NSPopover instance, check if it's not-nil before opening a new one

```
- (IBAction)openSettingsPopover:(id)sender {
    if (self.settingsPopover) {
        // Close it when clicked again, or simply return
        [self.settingsPopover close];
    }

    self.settingsPopover = [[NSPopover alloc] init];
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T09:21:56.970

一个更简单的方法是改变它的行为。只需将行为属性设置为 NSPopOverBehaviourTransient ，当用户与不在弹出框中的另一个 UI 元素交互时，它将被关闭。

```
[popover setBehaviour:NSPopOverBehaviourTransient]; 
```

# php - 列出嵌套类别中的产品

> ID：12552173
> 
> 赞同：2
> 
> 时间：2012-09-23T11:58:29.560
> 
> 标签：php, mysql

我为我的项目工作分层类别和产品表。

类别表结构：

**ID - 父母 - 职务**

1 - 0 - 电脑

1 - 0 - 电话

...

第 25107 行的类别表计数。

产品表结构

**ID - 猫 - 标题**

1 - 1 - 产品名称在这里

我想要列表产品的当前类别和子类别。

```
echo $subcats = categoryChild(0); 
```

输出为：64198,18355,18356,95623,90504,6118,90505,6117,90506,90507,6119,6120,90508,90509,90510,90511,6103,90512,90513,9246701,905218,4,4 ，90516,905111951195119511905119511951195181195119511951811905119518119051891981981981981981818 ,3596

我正在使用这个输出 MySQL IN 语句。最后生成这个 SQL 查询：

```
SELECT * FROM products WHERE cat IN (64198,18355,18356,95623,90504,6118,90505,6117,90506,90507,6119,6120,90508,90509,90510,90511,6103,90512,90513,90514,90515,142686,142688,142790,90516,6105,90517,90518,90519,90520,90521,91691,91692,92189,92190,92312,92313,95618,95619,95620,95621,95622,142684,142690,142692,142694,142696,142698,142700,3596) 
```

这个查询很慢...请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:18:15.697

试试这个：

```
select p.id as id, p.title as title, c.title as category, c.id as catid
from products p JOIN
(select * from category where id = 1 OR parent = 1) c
on p.cat = c.id 
```

看看它在[SQLFIDDLE上是如何工作的](http://sqlfiddle.com/#!2/1e397/7)

要列出所有层次结构级别，请编写如下代码：

```
// return all childs of category with id $cat
function list_childs($cat){
    // run above query and change (select * from category where id = 1 OR parent = 1)
    // to (select * from category where parent = $cat) and return results
} 
```

然后在您的代码中为您想要获取儿童的每个类别调用此函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T19:35:14.027

使用它可以让你为 parent_id 参数获取 cat 和 sub cat。它是嵌套的，可以是 CSS 和 html 的样式。

`

```
 <ul class="" id="">

<?php
   function query($parent_id, $extension = null) { //function to run a query
   $query = mysql_query ( "SELECT * FROM exe_categories WHERE parent_id=$parent_id");
   return $query;
}
   function has_child($query) { //This function checks if the menus has childs or not
   $rows = mysql_num_rows ( $query );
   if ($rows > 0) {
    return true;
   } else {
    return false;
   }
}
function fetch_menu($query) {
   while ( $result = mysql_fetch_array ( $query ) ) {
     $id = $result ['id'];
     $title = $result ['title'];
     $menu_link = $result ['menu_link'];
     echo "<li><a href='{$menu_link}'><span>{$title}</span></a>";

        if (has_child ( query ( $id ) )) {
                    echo "<div>";
                    echo '<ul role="menu" class="fofc">';

                    fetch_menu ( query ( $id ) );
                    echo "</ul>";
                    echo "</div>";
        }

             echo "</li>";
      }
 }
   fetch_menu (query(1)); //call this function with 1 parent id

 ?>` 
```

# java - 限制号 Java中类的实例

> ID：12552178
> 
> 赞同：3
> 
> 时间：2012-09-23T11:59:28.297
> 
> 标签：java, subclass, multiple-instances

我想限制没有。类的直接实例（在Java中）对n说，即在任何时候，内存中不超过n个类的直接对象。但是没有这样的限制。间接对象​​，例如此类的任何子类。有没有办法在 Java 中实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T12:01:52.990

使用工厂设计模式，如果您的实例超过您的限制，则抛出异常。

[http://www.oodesign.com/factory-pattern.html](http://www.oodesign.com/factory-pattern.html)

下面是一个粗略的示例实现。

```
public class AnyClass {
    private static final int limit_ = 8;
    private static int count = 0;

    private AnyClass() {}

    public static synchronized AnyClass getInstance() {
        if (count < limit_) {
            AnyClass anyClass = new AnyClass();
            count++;
            return anyClass;
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:04:51.193

你可以做：

```
static final AtomicInteger count = new AtomicInteger();

// in your parent constructor.
if (getClass() == Parent.class && count.incrementAndGet() >= LIMIT)
   throw new IllegalStateException(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:05:44.597

Java 本身并不提供这种可能性。

我认为您可以使用池工厂或直接在类构造函数中管理自己的情况。在构造函数中，您检查静态计数器 INSTANCES（在您的类中定义为私有数字），如果 INSTANCES > MAX_LIMIT 则抛出异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T12:41:19.727

我认为这样做是一个坏主意（不知道你的用例），但无论如何......

您可以通过在该类的构造函数中放置一些代码来计算所有实例。如果需要忽略子类的实例，请检查`getClass()`.

要知道实例何时被释放，您可以使用[弱引用](http://docs.oracle.com/javase/7/docs/api/java/lang/ref/package-summary.html)和[WeakHashMap](http://docs.oracle.com/javase/7/docs/api/java/util/WeakHashMap.html)来估计仍在使用的实例数。实际使用的实例数可能会更少，因为垃圾收集会在不可预测的时间删除实例。对于一个确切的数字，当您知道不再使用某个实例时，您需要显式调用某个方法。

# jakarta-ee - Vaadin：CDI Inject 在引用后为空

> ID：12552179
> 
> 赞同：0
> 
> 时间：2012-09-23T11:59:47.107
> 
> 标签：jakarta-ee, jboss7.x, vaadin, cdi

再会。

有一个应用程序（使用 CDI 插件）：

```
@VaadinScoped(VaadinScope.APPLICATION)
public class AdminApplication extends AbstractCdiApplication {

   @Inject
   private Instance<Lang> lang;

   @Override
   public void init() {
    setMainWindow(new LoginWindow(this));
   }

   public void authenticate(String login, String password) throws Exception {
    lang.get(). ...
}
     ... 
```

和登录窗口：

```
public class LoginWindow extends Window {
     ...
     public LoginWindow(AdminApplication application) {
       super("LoginWindow Login");
       this.application = application;
       initUI();
       initLoginListener();
     }
      private void initLoginListener() {
         btnLogin.addListener(new Button.ClickListener() {
            public void buttonClick(Button.ClickEvent event) {
               try {
                   String username = (String) txtUsername.getValue();
                   String password = (String) txtPassword.getValue();

                   application.authenticate(username, password);
               } catch (Exception e) {
                showNotification(e.toString());
               }
           }
    });
} 
```

问题是当它是应用程序的初始化阶段`lang.get()`时不为空，但是当我在 LoginWindow 中调用`application.authenticate()`方法时，`lang.get()`它始终为空。似乎在使用引用时，该`Instance.get()`方法无法获取类的实例。

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-02T22:25:02.680

我在 Wildfly 8.1 和 8.2 中遇到了这个问题，但是当我在 WEB-INF 中添加一个空的 beans.xml 时，它就起作用了。因此，如果上述方法不起作用，请尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:38:55.667

在您的应用程序中，您通过“新建”创建登录窗口。这样，它就不会由 CDI 容器管理。您必须将窗口注入您的应用程序，然后在 init() 方法中设置它。

# macos - 以编程方式启动 OS X 的联系人应用程序显示联系人？

> ID：12552184
> 
> 赞同：2
> 
> 时间：2012-09-23T12:00:40.807
> 
> 标签：macos, cocoa, contacts, abaddressbook, appkit

假设我刚刚创建了一条`ABPerson`记录并设法将其保存在用户的通讯录中。如何以编程方式打开处理通讯录的默认应用程序（很可能是联系人，但在某些情况下可能是 Outlook 或其他应用程序）并显示我刚刚添加的新通讯录记录？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-17T02:02:58.973

`addressbook`URL 方案能够显示人员记录或对其进行编辑：

```
ABPerson * aPerson = <#assume this exists#>;

// Open the Contacts app, showing the person record.
NSString * urlString = [NSString stringWithFormat:@"addressbook://%@", [aPerson uniqueId]];
[[NSWorkspace sharedWorkspace] openURL:[NSURL URLWithString:urlString]]; 
```

更多信息在[地址簿编程指南](https://developer.apple.com/library/mac/documentation/userexperience/conceptual/AddressBook/Tasks/URLScheme.html)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-10T13:14:59.983

这是我使用联系人应用程序的看法，在 Swift 中，作为`CNContact`. 我希望现在大多数人都使用通讯录而不是地址簿。

（CNContact 的`identifier`和 ABPerson 的一样`uniqueId`。）

```
func showInContacts() {
  let path = 
    "/Users/someusername/Library/Application Support/AddressBook/Sources/05A62A31-9C1F-423F-A9F4-011E56EAAF29/Metadata/0A1F4FC2-7E01-4A40-92DE-840F8C84DE58:ABPerson.abcdp
  var url = URL(fileURLWithPath: path)
  url.deleteLastPathComponent()
  url.appendPathComponent(self.identifier)// self is a CNContact
  url.appendPathExtension("abcdp")
  NSWorkspace.shared.open(url)
} 
```

联系人位于单独的文件中，隐藏在用户库/应用程序支持中的一长串子文件夹的末尾。文件名只是联系人的标识符加上扩展名。您可以通过将其中一个拖动到您的 Xcode 编辑器，用引号括起来，并可能删除最后一个路径组件来保存一些输入。因为我的应用程序不适合分发，这对我来说已经足够了；否则你将不得不做一些修改：用户名将在第二个路径组件中。我不知道“源”后面的长 ID 号的意义，无论是用户还是系统特定的，但它是该子文件夹中的唯一项目，因此您应该能够以编程方式构建可行的路径。

# winapi - 使用自定义文件格式作为 Windows Explorer 文件系统

> ID：12552188
> 
> 赞同：1
> 
> 时间：2012-09-23T12:01:09.330
> 
> 标签：winapi, filesystems, windows-explorer

是否有关于如何在 Windows 资源管理器中将自定义存档文件格式加载为文件系统的教程，类似于 CAB 和 ZIP 文件？

我尝试搜索命名空间扩展教程，但它似乎是另一回事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T17:50:19.400

**请参阅此项目 - Mini Shell 扩展框架。**

1.  [第1部分](http://www.codeproject.com/Articles/8063/The-Mini-Shell-Extension-Framework-Part-I)
2.  [第2部分](http://www.codeproject.com/Articles/9421/The-Mini-Shell-extension-Framework-Part-II)
3.  [第 3 部分](http://www.codeproject.com/Articles/11674/The-Mini-Shell-Extension-Framework-Part-III)

对您来说最重要的是第一部分，来自项目描述：

> 为了展示如何使用这些类并提供如何创建 shell 扩展的示例，代码包含一个可以打开 .vvv 文件的小示例。VVV 文件只是重命名为充当容器的 .ini 文件。大多数外壳扩展都是容器视图（例如，Windows .zip 和 .cab 外壳扩展）。

# jquery - JQuery 模板渲染问题

> ID：12552189
> 
> 赞同：0
> 
> 时间：2012-09-23T12:01:09.730
> 
> 标签：jquery, jquery-templates

我正在使用 JQuery 模板在 asp.net 中创建表格网格。但是我遇到了渲染问题。这是代码：

```
<script id="housingTemplate" type="text/x-jquery-tmpl">
    <div class="oddrow togglestyle">
        <div class="oddFirst">
            ${ID}
        </div>
        <div class="oddFirst thirdWidth fourthWidth info-tooltip"
             title="{{ html ProjectName }}">
            ${ProjectName}
        </div>
        <div class="oddFirst thirdWidth fourthWidth info-tooltip"
             title="Ravi Joshi">
            ${Address}
        </div>
        <div class="oddFirst thirdWidth info-tooltip">
            ${ZipCode}
        </div>
        <div class="oddFirst thirdWidth info-tooltip">
            ${City}
        </div>
        <div class="oddFirst thirdWidth info-tooltip">
            ${Type}
        </div>
    </div>
<script>

$("#businessTemplate").tmpl($.parseJSON(data.ResponseData)).appendTo("#dataList"); 
```

DIV 的“title”标签不会在“#dataList”中呈现，jquery 模板会跳过该部分并呈现所有其余部分。

我想要 DIV 上的“标题”标签用于 TOOLTIP，因为插件只支持写在“标题”标签内的文本。

我在代码中写错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:05:06.447

您是否尝试过删除额外的内部空间：

```
{{html ProjectName}} 
```

代替：

```
{{ html ProjectName }} 
```

文档页面上的语法`{{html fieldNameOrExpression}}`没有任何内部空格。

[http://api.jquery.com/template-tag-html/](http://api.jquery.com/template-tag-html/)

# c++ - 定义和调用类的转换运算符

> ID：12552193
> 
> 赞同：0
> 
> 时间：2012-09-23T12:01:27.530
> 
> 标签：c++, templates

我正在阅读这篇文章：

[http://www.codeproject.com/Articles/257589/An-Idiots-Guide-to-Cplusplus-Templates-Part-1](http://www.codeproject.com/Articles/257589/An-Idiots-Guide-to-Cplusplus-Templates-Part-1)

我不明白某些观点。好的。如何“转换”将自己转换为任何数据类型？下面行末的 float() 和 double() 是什么意思？转换如何发生？您能否详细解释一下？

```
Convert<int>::operator<float> float();
Convert<int>::operator<double> double(); 
```

## 对于那些想要文章相关部分的人，我将其复制粘贴在下面，与我的问题相关的部分在最后。

当然，带有方法模板的“显式模板参数规范”也是可能的。考虑另一个例子：

```
template<class T>
class Convert
{   
   T data;
public: 
   Convert(const T& tData = T()) : data(tData)
   { }

   template<class C>   
   bool IsEqualTo( const C& other ) const      
   {        
       return data == other;   
   }
}; 
```

可以用作：

```
Convert<int> Data;
float Data2 = 1 ;

bool b = Data.IsEqualTo(Data2); 
```

它使用 float 参数实例化 Convert::IsEqualTo。如下所示，显式规范将用 double 实例化它：

```
bool b = Data.IsEqualTo<double>(Data2); 
```

令人震惊的事情之一是，在模板的帮助下，您可以通过在模板之上定义转换运算符来做到这一点！

```
template<class T>
operator T() const
{
    return data;
} 
```

只要有可能，就可以将 Convert' 类模板实例转换为任何类型。考虑以下使用示例：

```
Convert<int> IntData(40);
float FloatData;
double DoubleData;

FloatData = IntData;
DoubleData = IntData; 
```

这将实例化以下两种方法（完全限定名称）：

```
Convert<int>::operator<float> float();
Convert<int>::operator<double> double(); 
```

一方面，它提供了很好的灵活性，因为无需编写额外的代码，Convert 就可以将自身（特定的实例化）转换为任何数据类型——只要在编译级别可以进行转换。如果无法进行转换，例如从 double 类型转换为 string 类型，则会引发错误。

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:19:55.250

类类型可以有*用户定义的转换*。这允许您将类的实例转换为另一种类型。例如，这里有一个结构，当转换为 int 时，其值始终为 42：

```
struct A {
  operator int() { return 42; }
}; 
```

这是一个特殊的函数，`operator int`被调用以转换为 int。现在，如果我们有一个 A, 的实例`a`，我们可以轻松地将其转换为 int：

```
A a;
int x = a; // x now has the value 42 
```

在文章中，他们展示了如何使用模板为任何类型生成转换运算符。函数模板定义为：

```
template<class T>
operator T() const
{
  return data;
} 
```

现在，每当您尝试将对象转换为另一种类型时，都会生成该函数的新版本，将 T 替换为您要转换的类型。因此，如果我们这样做`float f = a`，将生成以下函数：

```
operator float() const
{
  return data;
} 
```

这是一个将内部数据作为浮点数返回的函数。

文章中让您感到困惑的两行只是向您展示了该示例将生成哪些函数：

```
Convert<int>::operator<float> float();
Convert<int>::operator<double> double(); 
```

第一个是`operator float`转换为浮点数。第二个是`operator double`转换为双精度。

# cocos2d-iphone - Cocos2d 2.0 在 Retina Display 中加载高清图像的问题

> ID：12552194
> 
> 赞同：1
> 
> 时间：2012-09-23T12:01:36.577
> 
> 标签：cocos2d-iphone, retina-display

我一直在使用 Cocos2d 2.0 开发 iPad 游戏，在为新 iPad（Retina 显示器）加载高清图像时遇到问题。但我无法弄清楚为什么在执行代码时没有自动加载高清图像：

即使添加`[director enableRetinaDisplay:YES];`了它仍然无法正常工作。这是加载图像时的代码示例：

```
MainBG = [CCSprite spriteWithFile:@"menuBackground-ipad.png"];
CGSize ScreenSize = [[CCDirector sharedDirector]winSize];
MainBG.position = ccp(ScreenSize.height/2,ScreenSize.width/2);
[self addChild:MainBG z:0]; 
```

我在项目资源中有另一个图像 menuBackground-ipadhd.png（我也可以从 Xcode 中看到它）。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:34:44.333

对我来说，它在 cocos2D 2.0 中工作

将 menuBackground-ipad.png 更改为 menuBackground.png 确保所有这些行都在你的 appDelegate 中找到，并在最后 pushScene。在图层类中也使用 onEnter 而不是 init。

```
 if( ! [director_ enableRetinaDisplay:YES] )
        { 
            CCLOG(@"Retina Display Not supported");
        }

    CCFileUtils *sharedFileUtils = [CCFileUtils sharedFileUtils];
    [sharedFileUtils setEnableFallbackSuffixes:NO];             // Default: NO. No fallback suffixes are going to be used
    [sharedFileUtils setiPhoneRetinaDisplaySuffix:@"-hd"];      // Default on iPhone RetinaDisplay is "-hd"
    [sharedFileUtils setiPadSuffix:@"-ipad"];                   // Default on iPad is "ipad"
    [sharedFileUtils setiPadRetinaDisplaySuffix:@"-ipadhd"];    // Default on iPad RetinaDisplay is "-ipadhd"

    [director_ pushScene: [IntroLayer scene]]; 
```

//在层..

```
-(void)onEnter
{
    [super onEnter];
    MainBG = [CCSprite spriteWithFile:@"menuBackground.png"];
    CGSize ScreenSize = [[CCDirector sharedDirector]winSize];
    MainBG.position = ccp(ScreenSize.height/2,ScreenSize.width/2);
    [self addChild:MainBG z:0];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T09:08:17.133

加载文件时不要指定 ipad/hd/etc 文件后缀。您的问题是由在此处使用 -ipad 后缀引起的：

```
MainBG = [CCSprite spriteWithFile:@"menuBackground-ipad.png"]; 
```

删除后缀以允许 cocos2d 选择正确的图像：

```
MainBG = [CCSprite spriteWithFile:@"menuBackground.png"]; 
```

# java - 如何在eclipse中重命名多个单词

> ID：12552195
> 
> 赞同：0
> 
> 时间：2012-09-23T12:01:46.810
> 
> 标签：java, eclipse

说我有这个清单

```
<li><a href="#"><img src="images/large/2.jpg" alt="image02" /></a></li>
<li><a href="#"><img src="images/large/3.jpg" alt="image03" /></a></li>
<li><a href="#"><img src="images/large/4.jpg" alt="image04" /></a></li>
<li><a href="#"><img src="images/large/5.jpg" alt="image05" /></a></li>
<li><a href="#"><img src="images/large/6.jpg" alt="image06" /></a></li>
<li><a href="#"><img src="images/large/7.jpg" alt="image07" /></a></li>
<li><a href="#"><img src="images/large/8.jpg" alt="image08" /></a></li>
<li><a href="#"><img src="images/large/9.jpg" alt="image09" /></a></li>
<li><a href="#"><img src="images/large/10.jpg" alt="image10" /></a></li>
<li><a href="#"><img src="images/large/11.jpg" alt="image11" /></a></li>
<li><a href="#"><img src="images/large/12.jpg" alt="image12" /></a></li>
<li><a href="#"><img src="images/large/13.jpg" alt="image13" /></a></li>
<li><a href="#"><img src="images/large/14.jpg" alt="image14" /></a></li>
<li><a href="#"><img src="images/large/15.jpg" alt="image15" /></a></li>
<li><a href="#"><img src="images/large/16.jpg" alt="image16" /></a></li>
<li><a href="#"><img src="images/large/17.jpg" alt="image17" /></a></li>
<li><a href="#"><img src="images/large/18.jpg" alt="image18" /></a></li>
<li><a href="#"><img src="images/large/19.jpg" alt="image19" /></a></li>
<li><a href="#"><img src="images/large/20.jpg" alt="image20" /></a></li>
<li><a href="#"><img src="images/large/21.jpg" alt="image21" /></a></li>
<li><a href="#"><img src="images/large/22.jpg" alt="image22" /></a></li>
<li><a href="#"><img src="images/large/23.jpg" alt="image23" /></a></li>
<li><a href="#"><img src="images/large/24.jpg" alt="image24" /></a></li>
<li><a href="#"><img src="images/large/25.jpg" alt="image25" /></a></li> 
```

我想用单词 "small" 替换 src="images/large/25.jpg" 中的单词 "large" 。如何在 eclipse html 文件编辑器中执行此操作？手动更改每个单词将是一项繁琐的任务。

有一个非常相似的功能可以在 aptana 中替换整个单词集（相同的单词被另一个单词替换）但是它似乎在 eclipse 中丢失了或者我做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:06:50.900

您可以使用`Edit -> Find/Replace`菜单选项为任何文本编辑器调出 Eclipse 的通用`Find/Replace`对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:09:03.193

在编辑器中使用 Ctrl+F 替换文本值。

您可以在编辑器中按 Ctrl + Shift + L 来查看 eclipse 中的所有快捷方式。

# java - 为什么 JTA 不支持嵌套事务

> ID：12552198
> 
> 赞同：10
> 
> 时间：2012-09-23T12:02:08.497
> 
> 标签：java, jakarta-ee, transactions, jta, nested-transactions

为什么 JTA 不支持嵌套事务？是因为实现它们的复杂性（我对此表示怀疑）还是一些设计原则？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T13:58:18.387

JTA 规范并不是说它不支持嵌套事务——它只是**不要求**实现者支持它。

以下摘自 JTA 1.1 规范：

页。11、13；*3.1 UserTransaction 接口*和*3.2 TransactionManager 接口*

> **“不需要**支持嵌套事务。”

页。13、3.2.1*开始交易*

> “**如果事务管理器实现不支持嵌套事务**，则当调用线程已与事务关联时，TransactionManager.begin 方法会抛出 NotSupportedException。”

实际上可能存在问题`XAResource`，您可能会尝试加入当前事务（我相信它可能与 X/Open XA 规范有关）：

*3.4.4 交易关联*

> **XAResource 不支持**嵌套事务。在当前与不同事务关联的连接上调用 XAResource.start 方法是错误的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T15:22:08.457

（正如@Piotr Nowicki 指出的那样，JTA*确实*允许嵌套事务，但这是可选的而非强制性的。）

为什么？这是无法确定回答的问题之一，除非您是做出决定时“在场”的人之一。

*   这可能是在规范中包含嵌套事务的固有复杂性。或者当时明显的复杂性；即他们不确定他们是否知道如何做好*指定*它们的工作。

*   可能是他们认为需求不足。

*   这可能是时间压力......或者只是简单的疲惫。

*   可能是“商业原因”；例如，某些供应商不想通过扩大规范范围来干扰产品发布计划。

但是，底线是，如果您想要*真正的*答案，您需要询问编写 JTA 规范的工作组中的人员。（我怀疑他们会告诉你......记录在案。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-08T15:34:49.483

答案都不是生意。

许多容器（如 JBoss）提供了更复杂的替代事务管理器，它们支持嵌套事务等概念，但 glassfish 等其他容器不支持。然而，这两者都符合 Java EE。这个想法是保持规范简单，以降低供应商的合规障碍。

为什么要强制某人实施仅涵盖 0.5% 事务用例的复杂事务管理器或放弃 Java EE 合规性？

没有什么能阻止雄心勃勃的供应商超越规范，但他们没有选择遗漏任何内容。

# android - Android- 带有溢出菜单的选项卡模式操作栏

> ID：12552200
> 
> 赞同：3
> 
> 时间：2012-09-23T12:02:38.373
> 
> 标签：android, android-actionbar, android-menu

我有一个没有主页/标题栏的应用程序，以及一个处于选项卡导航模式的操作栏。我在我的应用程序中添加了一个菜单，我想在 Android 4+ 中将其显示为选项卡操作栏中的溢出菜单。

听起来很简单，但是当我添加菜单时

```
 // Initiating menu XML file
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater menuInflater = getMenuInflater();
    menuInflater.inflate(R.layout.menu, menu);
    return true;
}

// Event handling for individual menu item selected
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_search:
        // Load search fragment
        return true;
    case R.id.menu_add:
        // Load add fragment
        return true;
    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

我在横向视图中得到了这个，这很好：

![在此处输入图像描述](../Images/6f2cf9738b253459bd969bcfed308e39.png)

但是我在纵向模式下得到了这个，这很糟糕：

![在此处输入图像描述](../Images/0c3c14ff703b03a8a873a27c5e9a2b65.png)

如何防止标签操作栏在纵向模式下拆分？

**编辑：**因此，当在 android 4 中创建菜单时，它会立即成为活动标题栏中的操作溢出菜单。问题是，我没有标题栏，只有一个标签导航操作栏。因此，活动创建了一个带有操作溢出选项的新标题/操作栏。

我需要找到一种方法让活动将操作溢出选项卡添加到选项卡导航操作栏。有没有办法做到这一点？

谢谢

# flash - 八哥的关键事件

> ID：12552205
> 
> 赞同：0
> 
> 时间：2012-09-23T12:03:06.750
> 
> 标签：flash, actionscript, listener, keyevent, starling-framework

所以有人知道为什么它不起作用吗？我想在我的八哥班上听关键事件，我需要集中注意力吗？如果是，我该怎么做？这是一个 Main 类，这是文档类：

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.KeyboardEvent;
    import starling.core.Starling;

public class Main extends Sprite{
    private var starling:Starling

    public function Main(){         
        if (stage)
            init();
        else
            addEventListener(Event.ADDED_TO_STAGE, init, false, 0, true);
    }

    private function init(e:Event = null):void{
        removeEventListener(Event.ADDED_TO_STAGE, init);                        
        starling = new Starling(ScreenCoorder, stage);
        starling.start();       
    }
} 
```

}

和 screencorder 类（从八哥开始）：

```
package  
{

import starling.display.Sprite;
import starling.events.Event;
import starling.events.KeyboardEvent;

public class ScreenCoorder extends Sprite{

    public function ScreenCoorder() {
        super();
        addEventListener(Event.ADDED_TO_STAGE, init);
    }

    private function init():void {
        removeEventListener(Event.ADDED_TO_STAGE, init);
        this.addEventListener(KeyboardEvent.KEY_DOWN, onDown);
    }       

    public function onDown(e:KeyboardEvent):void {
        trace("so serious");
    }   
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T17:43:57.080

Starling Sprite 不支持按键，您需要像这样将侦听器添加到本机 Stage 对象。

```
this.nativeStage.addEventListener(KeyboardEvent.KEY_DOWN, onDown); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T00:26:28.533

它不起作用，因为您已将键盘事件侦听器连接到 ScreenCoorder 对象，而不是八哥舞台。试试这个：

```
private function init():void {
    removeEventListener(Event.ADDED_TO_STAGE, init);
    this.stage.addEventListener(KeyboardEvent.KEY_DOWN, onDown);
} 
```

请注意，这是 Starling 阶段，而不是 Flash 阶段。

# c# - 如何减少页面加载时间（结合 javascript）？

> ID：12552207
> 
> 赞同：4
> 
> 时间：2012-09-23T12:03:44.160
> 
> 标签：c#, jquery, asp.net-mvc, visual-studio-2010, jqgrid

使用 ASP .NET MVC 2 创建的页面需要 1.7 秒才能加载。它包含 13 个 js 文件，如下所示。Firebug 显示每个 js 文件加载都会返回 304 响应，但由于有 13 个文件，因此可能会大大增加页面加载时间。Chrome 审核红色警报建议合并 js 文件。

如何使用 ASP.NET MVC 2 自动或其他方式将它们组合到单个文件以减少加载时间？项目中应该有单独的 js 文件以允许替换它们，但那些应该作为单个 js 文件交付。

jqgrid、jquery、jquery-ui、tinymce和一些jquery插件js文件如下图所示。使用 Visual Web Developer Express 2010。应用程序在 Mono 2.10/Apache 和 Windows/IIS 下运行

site.master 包含：

```
 <%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
    <!DOCTYPE html>
    <html>
    <head runat="server">
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=0.1" />
        <link rel="stylesheet" href="../../themes/redmond/jquery-ui-1.8.12.custom.css" type="text/css" />
        <link href="../../Scripts/jqgrid/css/ui.jqgrid.css" rel="stylesheet" />
        <link href="../../Content/Css/Site.css" rel="stylesheet" />
        <asp:ContentPlaceHolder ID="HeadContent" runat="server" />
        <title>
            <asp:ContentPlaceHolder ID="TitleContent" runat="server" />
        </title>
        <script type="text/javascript">
            "use strict";
            var BASE_URL = '<%= ResolveUrl("~/") %>';
        </script>
        <script src="<%= Url.Content("~/Scripts/jquery/jquery-1.7.1.js")%>" type="text/javascript"></script>
        <script src="<%= Url.Content("~/Scripts/jquery-ui-git.js")%>" type="text/javascript"></script>
        <script src="<%= Url.Content("~/Scripts/i18n/jquery.ui.datepicker-et.js")%>" type="text/javascript"></script>
        <script src="<%= Url.Content("~/Scripts/jquery.contextmenu-fixed2.js")%>" type="text/javascript"></script>
        <% if (CurUser.GetLanguage() == "EST")
           { %>
        <script src="<%= Url.Content("~/Scripts/jqgrid/js/i18n/grid.locale-et.js")%>" type="text/javascript"></script>
        <% }
           else
           { %>
        <script src="<%= Url.Content("~/Scripts/jqgrid/js/i18n/grid.locale-en.js")%>" type="text/javascript"></script>
        <% } %>
        <script type="text/javascript">
            $.jgrid.no_legacy_api = true;
            $.jgrid.useJSON = true;
    </script>
    <script type="text/javascript" src="<%= Url.Content("~/Scripts/jqgrid/jquery.jqGrid.src-multiselect1-deleteandsortpatches.js")%>"></script>
    <script type="text/javascript" src="<%= Url.Content("~/Scripts/jqgrid/jQuery.jqGrid.dynamicLink.js")%>"></script>
    <script src="<%= Url.Content("~/Scripts/json2.js")%>" type="text/javascript"></script>
    <script src="<%= Url.Content("~/Scripts/jquery.form.js")%>" type="text/javascript"></script>
    <script src="<%= Url.Content("~/Scripts/TinyMCE/tiny_mce_src.js")%>" type="text/javascript"></script>
    <script src="<%= Url.Content("~/Scripts/TinyMCE/jquery.tinymce.js")%>" type="text/javascript"></script>
    <script src="<%= Url.Content("~/Scripts/myscripts.js")%>" type="text/javascript"></script>
    <script type="text/javascript">
    var 
        $grid;
    $(function() {
        "use strict";

<% if (TempData["Message"]!=null) {
setTimeout( function() {
   showMessage ( '<%= TempData["Message"] as string %>');
... 
```

**更新**

我在回答中尝试了 Oleg 建议，但得到错误 jQuery 未定义，如下图所示。如何解决这个问题？IE 控制台不显示任何错误。

![jQuey 未定义](../Images/a8919e7db297260a25f4dd3cf335e883.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:15:48.867

我建议使用[head.js](http://headjs.com/)。

使用单独的 .js 文件确实可以帮助您减少页面加载时间。您只需包含一个文件，其中包含以下内容：

```
head.js("/path/to/jquery.js", "/google/analytics.js", "/js/site.js", function() {     
   // all done     
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:12:27.167

为了克服这些类型的情况，你有很多技巧。其中一些是：

**Page Specific JS :**尝试根据需求添加 javascript 文件。不要添加页面中没有使用的任何不必要的 JS。

**GZIP 压缩：** 对页面和静态 js 和 css 文件应用 GZIP 压缩。

**缓存**：在服务器级别（IIS），您可以将缓存应用于这些静态文件，如 JS 或 CSS

[http://sixrevisions.com/web-development/decrease-webpage-load-times/](http://sixrevisions.com/web-development/decrease-webpage-load-times/)

[将多个 JavaScript 文件合并为一个 JS 文件](https://stackoverflow.com/questions/5511989/combine-multiple-jquery-script-files-into-one-js-file)

祝你好运 ！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:40:01.517

我想建议您使用[Closure Compiler](http://closure-compiler.appspot.com/home)进行一项实验。

首先，您可以尝试*连接*您在页面上使用的所有 JavaScript 和所有内联 JavaScript 代码。您应该保留原因文件的顺序。在我看来，您将有两个版本的结果：一个 with`CurUser.GetLanguage() === "EST"`和另一个 with `CurUser.GetLanguage() !== "EST"`。

在您拥有一个 JavaScript 文件后，您可以使用带有`compilation_level`of的 Closure Compiler `ADVANCED_OPTIMIZATIONS`（参见[此处](https://developers.google.com/closure/compiler/docs/api-tutorial3)），它可以**删除所有未使用的 JavaScript 代码**。结果，您将获得您在页面上真正使用的 jQuery、jQuery UI 和其他库的*子集。*生成的 JavaScript 代码将与其他页面上的其他代码不同，但它可能非常小，并且可以更好地优化为任何单独的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T12:44:07.780

[http://combres.codeplex.com/](http://combres.codeplex.com/)允许您保留单独的 javascript 文件并在运行时合并和缩小。

真正的享受。

看起来他们已经在 asp.net 4.5 中加入了类似的东西：

[http://weblogs.asp.net/scottgu/archive/2011/11/27/new-bundling-and-minification-support-asp-net-4-5-series.aspx](http://weblogs.asp.net/scottgu/archive/2011/11/27/new-bundling-and-minification-support-asp-net-4-5-series.aspx)

[http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-28T21:06:28.133

**将文件捆绑在一起**

当前的大多数主要浏览器都将每个主机名的同时连接数限制为六个。这意味着在处理六个请求时，浏览器将对主机上的资产的其他请求进行排队

捆绑可以显着改善您的首页点击下载时间。

捆绑通过将多个 CSS 文件和 Javascript 文件组合成单个 CSS 文件和 javascript 文件来减少对服务器的单个 HTTP 请求的数量。

这个网站有一个很好的教程，介绍如何通过五个简单的步骤将捆绑添加到您的应用程序：[http ://websitespeedoptimizations.com/Bundling.aspx](http://websitespeedoptimizations.com/Bundling.aspx)

# android - 对 AAssetManager_fromJava 的未定义引用

> ID：12552208
> 
> 赞同：15
> 
> 时间：2012-09-23T12:04:27.483
> 
> 标签：android, android-ndk, android-assets

我正在尝试使用 AAssetManager 从 android apk 访问资产。但是，即使我已经包含了asset_manager.h 和asset_manager_jni.h，我仍然不断收到“对AAssetManager_fromJava 的未定义引用”。asset_manager.h 中的其他函数，如 AAssetManager_openDir(mgr, "") 等也无法被引用。

这是完整的代码

```
#define EXPORT_API

#include <string.h>
#include <jni.h>
#include <android\log.h>

#include <sys\types.h>
#include <android\asset_manager.h>
#include <android\asset_manager_jni.h>

#define LOGD(...) __android_log_print(ANDROID_LOG_DEBUG, "com.devin - native", __VA_ARGS__)

JNIEnv* env=0;

#ifdef __cplusplus
extern "C" {
#endif

JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM* vm, void* pvt){
    LOGD("JNI_OnLoad() called");
    vm->AttachCurrentThread(&env, 0);
    return JNI_VERSION_1_2;
}

EXPORT_API void LoadAsset(char* filename, jobject assetManager){
    AAssetManager* mgr = AAssetManager_fromJava(env, assetManager);
        /* More stuff */
}

#ifdef __cplusplus
};
#endif 
```

此代码位于 .cpp 文件中，并使用 NDK R8 进行编译。我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-23T12:29:15.893

My mistake. I didn't have "android" library added to the linker. I have actually setup NDK dev environment on Visual Studio Express and "android" library wasn't added to my project by default.

If you are using makefiles, be sure to add -landroid to your LOCAL_LDLIBS when using native AssetManager.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-04-04T13:45:13.510

Android Studio 开发人员，如果您有名为“CMakeList.txt”的 ExternalNativeBuild 文件，则必须将此代码附加到文件 CMakeList.txt

```
find_library( # Sets the name of the path variable.
          android-lib

          # Specifies the name of the NDK library that
          # you want CMake to locate.
          android )
target_link_libraries( 
                   ${log-lib}
                    ${android-lib}) 
```

如果您也有本机库，您可以像这样轻松添加

```
target_link_libraries( native-lib
                   ${log-lib}
                    ${android-lib}) 
```

它应该工作！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-31T02:24:44.693

```
find_library( # Sets the name of the path variable.
    log-lib

    # Specifies the name of the NDK library that
    # you want CMake to locate.
    log
)

find_library(android-lib android)

target_link_libraries( # Specifies the target library.
    hll
    ${log-lib}
    ${android-lib}
    # Links the target library to the log library
    # included in the NDK.
) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-18T17:38:05.943

我将以下内容添加到 gradle.build

`android.ndk { ldLibs.addAll(["android", "log"]) }`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-03T18:14:58.307

我通过将以下内容添加到 Android.mk 来修复它

```
LOCAL_SHARED_LIBRARIES += libandroid 
```

# java - 玩 2.0+Java 与玩 2.0+Scala？

> ID：12552210
> 
> 赞同：36
> 
> 时间：2012-09-23T12:04:44.523
> 
> 标签：java, scala, playframework-2.0

我正在考虑在玩 1.2 之后迁移到玩 2.0。困扰我的一件事是人们说 Scala 对于 play 2.0 应用程序更“首选”。我知道 1.2 和 2.0 的差异，但我不确定 Play 2.0 with Java 和 Play 2.0 with Scala 之间是否存在差异

所以我的脑海里有几个问题：

*   在 Play 2.0 应用程序中，有什么我不能用 java over scala 做的吗？
*   如果我开始在 play 2.0 应用程序中学习和使用 scala，我有什么优势？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-23T14:29:23.540

我刚刚使用 Java 的 Play 2.0 完成了一个原型，现在正在考虑学习 Scala，以便我可以切换到它进行进一步的开发。

这不仅仅是通常的*Java 与 Scala*的讨论——我在 Play 框架中看到的问题在于它将 Scala 习语强加到 Java 上。[文档中有关调用多个 Web 服务](https://www.playframework.com/documentation/2.0.3/JavaWS#composing-results)的示例：

```
public static Result feedComments(String feedUrl) {
  return async(
    WS.url(feedUrl).get().flatMap(
      new Function<WS.Response, Promise<Result>>() {
        public Promise<Result> apply(WS.Response response) {
          return WS.url(response.asJson().findPath("commentsUrl").get().map(
            new Function<WS.Response, Result>() {
              public Result apply(WS.Response response) {
                return ok("Number of comments: " + response.asJson().findPath("count"));
              }
            }
          );
        }
      }
    )
  );
} 
```

它可以工作，但看起来不像传统的 Java。那些括号看起来真的很可怕。甚至 Eclipse 也会感到困惑，并且永远不知道我需要或想要使用什么泛型——我总是必须手动选择它们。

另请注意，在文档中，他们通过删除`@Override`注释、仅使用两个空格进行缩进并整体选择一个非常简单的示例而没有验证或错误恢复，因此他们不使用太多行，从而使这看起来很漂亮。我什至不确定您是否可以配置代码格式化程序来像这样输出它而不会完全弄乱其他代码。

在实践中，我最终得到了一个可怕的 Java-Scala 可憎的不可读块，只是为了从另一个服务获取一些数据。

不幸的是，我找不到任何在 Scala 中组合响应的示例。至少[在 Scala 中调用单个 Web 服务](http://www.playframework.org/documentation/2.0.3/ScalaWS)看起来更短且更易于阅读。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-23T12:13:50.260

AFAIK，最好使用 Scala，因为它提供了更多功能。

例如（如果我错了，请纠正我），您可以直接将[Iteratees](https://github.com/playframework/Play20/wiki/Iteratees)与 Scala 一起使用（又名反应式编程），但我不知道如何使用 Java 来实现。

另外，Play 的 Java API 是 Play 架构的上层，核心是用 Scala 编写的；因此，如果您想了解内部发生的情况，请使用 Scala。

另请注意，您可以在同一个 Play 项目中混合使用 Java 和 Scala，因此您可以顺利迁移到 Scala。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-24T19:42:20.110

我是 Play 新手，刚刚编写了一个带有 Java 方面的中小型项目。

它有效且功能强大，但许多功能似乎都非常以 Scala 为中心，并且对 Java 的支持低于标准。Java API Doc 几乎不存在，这在 IDE 中带走了一些舒适感（IntelliJ - 我推荐它）。Java 世界中的集成不是很“自然”（SBT..），它不会构建为战争或 maven 模块（但似乎有插件可以做到这一点）。您有点失去了现有 Java 工具的好处。

将 Play 与其他框架区分开来的概念几乎都是 scala native 和 Java 其次。

我偶然发现了一些错误和怪癖，我总是会遇到我必须阅读和理解才能修复或解决它的 Scala 代码。（动作、RequestBody 的东西、异步、路由、模板隐式等等）

因此，Java 方面对我来说只是第二层，尽管他们显然正在努力使它们同样出色。

现在，在项目之后，我会说它非常有用，甚至会再次使用它（在 Java 中）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-30T00:39:44.863

> 如果我开始在 play 2.0 应用程序中学习和使用 scala，我有什么优势？

正如 djangofan 评论的那样，当您在 Google 上寻求 Play 帮助时，您会在 Scala 中获得示例。

> 在 Play 2.0 应用程序中，有什么我不能用 java over scala 做的吗？

但是，我还没有（仍然是初学者）为 Scala 找到等效的 Ebean。我发现的 Scala 示例都使用直接 SQL 来实现持久性。数据库抽象在哪里？

由于我还没有找到 Play with Scala 的数据库抽象，我将继续使用 Java ......

# python - 类属性的多个值

> ID：12552211
> 
> 赞同：2
> 
> 时间：2012-09-23T12:04:45.047
> 
> 标签：python, beautifulsoup

我正在尝试使用 beautifulsoup 为来自维基百科的人获取生日。例如[http://en.wikipedia.org/wiki/Ezra_Taft_Benson](http://en.wikipedia.org/wiki/Ezra_Taft_Benson)的生日是 1899 年 8 月 4 日。要到生日，我使用以下代码：

```
bday = url.find("span", class_="bday") 
```

`bday`但是，它正在获取作为另一个标签的一部分出现在 html 代码中的实例。即`<span class="bday dtstart published updated">1985-11-10 </span>`。

有没有办法只匹配确切的类标签`bday`？

我希望这个问题很清楚，因为目前我得到的`bday`是 1985-11-10，这不是正确的日期。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T13:45:53.470

当 BeautifulSoup 的所有其他匹配方法都失败时，您可以使用带有单个参数（标签）的函数：

```
>>> url.find(lambda tag: tag.name == 'span' and tag.get('class', []) == ['bday'])
<span class="bday">1899-08-04</span> 
```

上面搜索了一个`span`标签，其类属性是单个元素的列表（'bday'）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T15:46:42.693

我会这样做：

```
import urllib
from BeautifulSoup import BeautifulSoup

url = 'http://en.wikipedia.org/wiki/Ezra_Taft_Benson'
file_pointer = urllib.urlopen(url)
html_object = BeautifulSoup(file_pointer)

bday = html_object('span',{'class':'bday'})[0].contents[0] 
```

这将`1899-08-04`作为值返回`bday`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:13:51.167

尝试将[lxml](http://lxml.de/)与`beautifulsoup`解析器一起使用。以下查找`<span>`仅具有类的标签`bday`（在此页面的情况下只有一个）：

```
>>> from lxml.html.soupparser import fromstring
>>> root = fromstring(open('Ezra_Taft_Benson'))
>>> span_bday_nodes = root.findall('.//span[@class="bday"]')
[<Element span at 0x1be9290>]
>>> span_bday_node[0].text
'1899-08-04' 
```

# ruby-on-rails-3 - 如何在 ActiveAdmin 编辑页面中呈现部分内容

> ID：12552223
> 
> 赞同：3
> 
> 时间：2012-09-23T12:06:32.110
> 
> 标签：ruby-on-rails-3, activeadmin

如何在 ActiveAdmin 编辑页面中呈现部分内容？这是我的代码[http://paste.ubuntu.com/1222340/](http://paste.ubuntu.com/1222340/) 我想在提交按钮之后呈现一个页面。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T22:07:43.173

尝试这个

```
 form do |f|
        f.inputs do
          f.input :name
        end
        f.actions
        f.form_buffers.last << f.template.render('shared/test')

      end 
```

# javascript - 未捕获的类型错误：无法调用 null 的方法“getElementsByTagName”

> ID：12552224
> 
> 赞同：1
> 
> 时间：2012-09-23T12:06:40.803
> 
> 标签：javascript, wordpress, buddypress

我买了一个 WordPress 主题，我遇到了几个错误，希望能解决我的 BuddyPress 与主题的 jQuery 和 AJAX 的冲突。

我的问题是我收到 2 个错误：

1.  `Uncaught TypeError: Cannot call method 'getElementsByTagName' of null`

    `init:function(tabid, dselected){ var menuitems=document.getElementById(tabid).getElementsByTagName("a")`

    `Error: Uncaught TypeError: Cannot call method 'getElementsByTagName' of null (repeated 2 times)`

2.  `Uncaught TypeError: Cannot call method 'getElementsByTagName' of null`

    `buildcontentdivs:function(setting){ var alldivs=document.getElementById(setting.id).getElementsByTagName("div")`

    `Error: Uncaught TypeError: Cannot call method 'getElementsByTagName' of null`

我不知道如何解决这个问题，因为我不是程序员。我只知道 HTML、CSS 和基本的 WordPress PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:10:25.200

在每种情况下，getElementById 都没有找到所需的元素。由于您没有为这些调用提供任何上下文，因此无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:53:04.347

在渲染元素之前，您不能将 jquery 放入`<head>`它运行的程序中，这就是它可能返回 null 的原因。

# mysql - mysql查询帮助通过连接多个表来获取数据

> ID：12552228
> 
> 赞同：0
> 
> 时间：2012-09-23T12:06:52.863
> 
> 标签：mysql

我有以下表格：

根据： `id | domain`

扩展： `id | domain | country_code`

国家： `id | country_code | country_name`

禁止域名： `id | domain`

我将在banned_domains 中拥有数千个（超过500K）的域。现在我需要获取禁止域列表中不存在的数据“域、国家代码和国家名称”。我不太擅长 MySQL JOINS，任何人都可以指导我进行正确的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:12:24.580

```
SELECT b.domain, ex.country_code, c.country_name FROM base b 
INNER JOIN extended ex ON b.domain=ex.domain
INNER JOIN countries c ON ex.country_code=c.country_code
WHERE b.domain NOT IN (SELECT domain FROM banned_domains); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:16:10.257

您可以使用此查询。

```
select b.domain , e.country_code , c.country_name from base b join  extended e on b.domain = e.domain join countries c on e.country_code = c.country_code and b.domain not in (select domain from banned_domains); 
```

试试这个链接[http://sqlfiddle.com/#!2/f78ea/1](http://sqlfiddle.com/#!2/f78ea/1)。

# c++ - 垃圾值 - C++ 中的继承

> ID：12552229
> 
> 赞同：2
> 
> 时间：2012-09-23T12:07:06.513
> 
> 标签：c++, inheritance, constructor, virtual, abstract

我有一堂课如下：

```
class base
{
    protected:
        int x;
        int y;
        int z;
    public:
        base(int x, int y, int z)
        {
            x = x;
            y = y;
            z = z;
        }
        virtual void show();
}; 
```

我从上面派生一个类：

```
class derived : protected base
{
    public:
        int a;
        int b;
        int c;
        derived(int a, int b, int x, int y, int z) : base(x, y, z) //initialising the base class members as well
        {
            cout<<a<<b<<x<<y<<z; //works fine
            a = a;
            b = b;
        }
        void show()
        {
            cout<<a<<b<<x<<y<<z; //show junk values            
        }
        //some data members and member functions
}; 
```

在 main() 中，我使用：

```
 derived d(1, 2, 3, 4, 5);

    d.show(); 
```

数据成员似乎在构造函数中具有合法值。但是，当我使用类似的功能，即使用相同的可见性模式时，似乎会出现垃圾值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T12:09:20.897

```
a = a;
b = b; 
```

应该

```
this->a = a;
this->b = b; 
```

或者，更好的是，使用初始化列表：

```
derived(int a, int b, int x, int y, int z) : a(a), b(b),  base(x,y,z) 
{
    cout<<a<<b<<x<<y<<z; //works fine
} 
```

您正在做的是自行分配参数，因此不会设置成员。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T12:10:29.540

你永远不会初始化你的成员变量。`a=a;`将分配给局部变量`a`（参数），而不是成员变量。应该是`this->a=a;`。其他成员也一样。

# mysql - 合并对应的 MySQL 记录

> ID：12552234
> 
> 赞同：2
> 
> 时间：2012-09-23T12:08:05.830
> 
> 标签：mysql, merge, duplicates

我有一个名为“objecttable”的 MySQL 表，其中包含以下结构和数据。（数据只是一个序列，还有很多）。

```
ID    |  Name              |  posX  |  posY   | posZ |rotX | rotY | rotZ | rotW  |  
3562  |   LODpmedhos1_LAe  |  2062  |  -1703  |  16  |  0  |  45  |  22  |  1    |  
3559  |   LODpmedhos5_LAe  |  2021  |  -1717  |  15  |  0  |  45  |  34  |  1    |  
3561  |   LODpmedhos3_LAe  |  2021  |  -1717  |  15  |  0  |  45  |  34  |  1    | 
```

我想弄清楚哪些记录具有相同的 posX、posY、posZ、rotX、rotY 和 rotZ 值并将它们插入到一个名为“matchtable”的表中，最后我希望它看起来像这样（我有表结构准备好）

```
ID1     |       Name            |   ID2     |   Name          |  
3559    |   LODpmedhos5_LAe     |   3561    |  LODpmedhos3_LAe| 
```

如果有人能给我正确的 SQL 查询，我将不胜感激。我没有超过两个匹配的坐标，并且并非所有坐标都匹配。

抱歉，如果表格表示很糟糕，如有必要，我会尝试制作一个 HTML 表格。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:20:11.913

这个查询可以解决问题，但结果的数量可能比需要的多很多。例如，如果有*5 行*满足您的查询，则结果将为**20( = n*(n-1) )**个数。

```
SELECT ot.ID AS ID1, ot.Name AS Name1, ot2.ID AS ID2, ot2.Name AS Name
FROM objecttable ot
JOIN objecttable ot2
    ON ot.ID > ot2.ID
        AND ot.posX = ot2.posX
        AND ot.posY = ot2.posY
        AND ot.posZ = ot2.posZ
        AND ot.rotX = ot2.rotX
        AND ot.rotY = ot2.rotY
        AND ot.rotZ = ot2.rotZ 
```

# 编辑

回复[lserni](https://stackoverflow.com/users/1428679/lserni)的评论：

```
ON ot.ID <> ot2.ID 
```

上述条件可以删除结果，例如：

```
ID1     |       Name            |   ID2     |   Name          |
3559    |   LODpmedhos5_LAe     |   3559    |  LODpmedhos5_LAe| 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:20:25.530

尝试这个：

```
-- insert into matchtable -- uncomment to insert the data
select alias1.Id,
    alias1.Name, 
    alias2.Id
    alias2.Name
from objecttable as alias1
    join objecttable as alias2
        on alias1.posx = alias2.posx
            and alias1.posy = alias2.posy
            and alias1.posz = alias2.posz
            and alias1.roty = alias2.roty
            and alias1.roty = alias2.roty
            and alias1.rotz = alias2.rotz
            and alias1.Id > alias2.Id 
```

# algorithm - 在二叉搜索树中找到两个节点的最低共同祖先 - 高效

> ID：12552235
> 
> 赞同：1
> 
> 时间：2012-09-23T12:08:06.997
> 
> 标签：algorithm

只是想知道以下算法在二叉搜索树中找到两个节点的最低共同祖先的效率如何。

```
Node getLowestCommonAncestor (Node root, Node a, Node b) {

   Find the in-order traversal of Node root.
   Find temp1 = the in-order successor of Node a.
   Find temp2 = the in-order successor of Node b.

   return min (temp1, temp2);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T12:23:20.803

Searching for the lowest common ancestor in a binary search tree is simpler than that: observe that the LCA is the node where the searches for item A and item B diverge for the first time.

Start from the root, and search for A and B at the same time. As long as both searches take you in the same direction, continue the search. Once you arrive at the node such that searching for A and B take you to different subtrees, you know that the current node is the LCA.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T12:24:58.850

A node at the bottom of a large binary search trees can have an in-order successor close to it, for instance if it is the left child of a node, its in-order successor is its parent.

Two nodes descending from different children of the root will have the root as their least common ancestor, no matter where they are, so I believe that your algorithm gets this case wrong.

This is a discussion of efficient LCA algorithms (given time to build a preparatory data structure) at [http://en.wikipedia.org/wiki/Lowest_common_ancestor](http://en.wikipedia.org/wiki/Lowest_common_ancestor), with pointers to code.

An inefficient but simple way of finding the LCA is as follows: in the tree keep pointers from children to parents and a note of the depth of each node. Given two nodes, move up from the deepest one until the depth if the same. If you are pointing at the other node, it is the LCA. Otherwise move up one step from each node and check again, and so on, until you meet at the LCA.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-06T19:33:41.820

**找到 BST 的 LCA 是直接的：**

> 找到`node1`和`node2`存在于不同侧的节点。但如果`node1`是`node2` 比的祖先，我们也将不得不返回`node1`。下面的代码实现了这个算法。

* * *

```
TreeNode<K> commonAncestor(TreeNode t, K k1, K k2){
        if(t==null) return null;
        while(true)
        {
           int c1=t.k.compareTo(k1);
           int c2=t.k.compareTo(k2);
           if(c1*c2<=0)
           {
               return t;
           }
           else
           {
               if(c1<0)
               {
                   t = t.right;
               }
               else
               {
                   t = t.left;
               }
           }
        }
    } 
```

# python - 使用 lxml 解析 html

> ID：12552238
> 
> 赞同：2
> 
> 时间：2012-09-23T12:08:36.180
> 
> 标签：python, xpath, lxml

我有以下html代码

```
<a name="Audio-Encoders"></a>
<h1 class="chapter"><a href="ffmpeg.html#toc-Audio-Encoders">14\. Audio Encoders</a></h1>

<p>A description of some of the currently available audio encoders
follows.
</p>
<a name="ac3-and-ac3_005ffixed"></a>
<h2 class="section"><a href="ffmpeg.html#toc-ac3-and-ac3_005ffixed">14.1 ac3 and     ac3_fixed</a></h2>

<p>AC-3 audio encoders.
</p>
<p>These encoders implement part of ATSC A/52:2010 and ETSI TS 102 366, as well as
the undocumented RealAudio 3 (a.k.a. dnet).
</p>
<p>The <var>ac3</var> encoder uses floating-point math, while the <var>ac3_fixed</var>
encoder only uses fixed-point integer math. This does not mean that one is
always faster, just that one or the other may be better suited to a
particular system. The floating-point encoder will generally produce better
quality audio for a given bitrate. The <var>ac3_fixed</var> encoder is not the
default codec for any of the output formats, so it must be specified explicitly
using the option <code>-acodec ac3_fixed</code> in order to use it.
</p>
<a name="AC_002d3-Metadata"></a>
<h3 class="subsection"><a href="ffmpeg.html#toc-AC_002d3-Metadata">14.1.1 AC-3     Metadata</a></h3>

<p>The AC-3 metadata options are used to set parameters that describe the audio,
but in most cases do not affect the audio encoding itself. Some of the options
do directly affect or influence the decoding and playback of the resulting
bitstream, while others are just for informational purposes. A few of the
options will add bits to the output stream that could otherwise be used for
audio data, and will thus affect the quality of the output. Those will be
indicated accordingly with a note in the option list below.
</p>
<p>These parameters are described in detail in several publicly-available
documents.
</p><ul> 
```

如何从每个之后提取文本`<hX class="foobar">`？

例如 `<h1 class="chapter">` ，h1 标记后的内容是“以下是一些当前可用音频编码器的描述”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:58:55.793

**使用**：

```
/*/h1/following-sibling::p
         [name(preceding-sibling::*[starts-with(name(),'h')][1])
         = 'h1'
         ]//text() 
```

**针对以下 XML 文档评估此 XPath 表达式**（从提供的格式不正确的片段中获得，但删除尾随未闭合`ul`并将结果包装到单个顶部元素中）：

```
<html>
    <a name="Audio-Encoders"></a>
    <h1 class="chapter">
        <a href="ffmpeg.html#toc-Audio-Encoders">14\. Audio Encoders</a>
    </h1>
    <p>A description of some of the currently available audio encoders follows. </p>
    <a name="ac3-and-ac3_005ffixed"></a>
    <h2 class="section">
        <a href="ffmpeg.html#toc-ac3-and-ac3_005ffixed">14.1 ac3 and     ac3_fixed</a>
    </h2>
    <p>AC-3 audio encoders. </p>
    <p>These encoders implement part of ATSC A/52:2010 and ETSI TS 102 366, as well as the undocumented RealAudio 3 (a.k.a. dnet). </p>
    <p>The 
        <var>ac3</var> encoder uses floating-point math, while the 
        <var>ac3_fixed</var> encoder only uses fixed-point integer math. This does not mean that one is always faster, just that one or the other may be better suited to a particular system. The floating-point encoder will generally produce better quality audio for a given bitrate. The 
        <var>ac3_fixed</var> encoder is not the default codec for any of the output formats, so it must be specified explicitly using the option 
        <code>-acodec ac3_fixed</code> in order to use it. 
    </p>
    <a name="AC_002d3-Metadata"></a>
    <h3 class="subsection">
        <a href="ffmpeg.html#toc-AC_002d3-Metadata">14.1.1 AC-3     Metadata</a>
    </h3>
    <p>The AC-3 metadata options are used to set parameters that describe the audio, but in most cases do not affect the audio encoding itself. Some of the options do directly affect or influence the decoding and playback of the resulting bitstream, while others are just for informational purposes. A few of the options will add bits to the output stream that could otherwise be used for audio data, and will thus affect the quality of the output. Those will be indicated accordingly with a note in the option list below. </p>
    <p>These parameters are described in detail in several publicly-available documents. </p>
</html> 
```

**选择想要的文本节点**（在这种情况下只有一个）：

```
A description of some of the currently available audio encoders follows. 
```

**同样，这个 XPath 表达式**：

```
/*/h2/following-sibling::p
         [name(preceding-sibling::*[starts-with(name(),'h')][1])
         = 'h2'
         ]//text() 
```

**选择这些文本节点**：

```
AC-3 audio encoders. These encoders implement part of ATSC A/52:2010 and ETSI TS 102 366, as well as the undocumented RealAudio 3 (a.k.a. dnet). The 
        ac3 encoder uses floating-point math, while the 
        ac3_fixed encoder only uses fixed-point integer math. This does not mean that one is always faster, just that one or the other may be better suited to a particular system. The floating-point encoder will generally produce better quality audio for a given bitrate. The 
        ac3_fixed encoder is not the default codec for any of the output formats, so it must be specified explicitly using the option 
        -acodec ac3_fixed in order to use it. 
```

**最后，这个 XPath 表达式**：

```
/*/h3/following-sibling::p
         [name(preceding-sibling::*[starts-with(name(),'h')][1])
         = 'h3'
         ]//text() 
```

**选择这些文本节点**：

```
The AC-3 metadata options are used to set parameters that describe the audio, but in most cases do not affect the audio encoding itself. Some of the options do directly affect or influence the decoding and playback of the resulting bitstream, while others are just for informational purposes. A few of the options will add bits to the output stream that could otherwise be used for audio data, and will thus affect the quality of the output. Those will be indicated accordingly with a note in the option list below. These parameters are described in detail in several publicly-available documents. 
```

# java - 表单身份验证 - 侦听器

> ID：12552242
> 
> 赞同：2
> 
> 时间：2012-09-23T12:08:54.573
> 
> 标签：java, jsp, jakarta-ee, servlets, servlet-listeners

我在 Java JSP/Servlet 应用程序中使用基于 FORM 的身份验证方法。我想在成功登录后“做点什么”。有没有听众可以帮助我做到这一点？我不想在每一页的开头放置任何代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:12:34.457

通常，身份验证是一个横切关注点，您会将其提取到一个身份验证中，该身份验证[`ServletFilter`](http://docs.oracle.com/javaee/5/api/javax/servlet/Filter.html)应用于需要对用户进行身份验证的所有 servlet。如果您有这样的过滤器，则此逻辑将在成功验证后进入该过滤器。

# android - Android 应用发布

> ID：12552247
> 
> 赞同：1
> 
> 时间：2012-09-23T12:09:17.653
> 
> 标签：android

我正在为我的付费 Android 应用程序使用许可证验证库。
那么是否有必要将 eula（最终用户许可协议）添加到我的应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:49:39.507

不，如果您不想提供 EULA，则无需提供。这是可选的，完全取决于您。通过使用 LVL，您不必为您的应用程序提供 EULA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:56:15.567

不，EULA 不是强制性的。请阅读此[Google Play 发布清单](http://developer.android.com/distribute/googleplay/publish/preparing.html)

# apache - Mercurial 服务器和 apache

> ID：12552250
> 
> 赞同：1
> 
> 时间：2012-09-23T12:09:45.827
> 
> 标签：apache, mercurial

目前，我可以使用 hgadmin 通过 ssh 将我的存储库推送到 CentOS 服务器（example.com）到 /var/lib/mercurial-server/repos/SOMEREPO。有没有办法通过 example.com/SOMEREPO 访问 SOMEREPO？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T10:51:35.153

您可以通过多种方式发布存储库[。](http://mercurial.selenic.com/wiki/PublishingRepositories)

如果您熟悉 apache，可能最简单的解决方案是使用 hgweb.cgi，它是 mercurial 发行版附带的 cgi 脚本。

可以在[mercurial wiki](http://mercurial.selenic.com/wiki/HgWebDirStepByStep)上找到如何设置 hgweb 的详细分步指南。既然您提到了 CentOS，您可能想查看[RHEL4 的 hgweb 设置指南](http://mercurial.selenic.com/wiki/RHEL4HgWebDirSetup)。

如果您正在寻找更完整的基于 Web 的工具来管理您的存储库，您可能需要查看[SCM-Manager](http://mercurial.selenic.com/wiki/SCM-Manager)或[RhodeCode](http://rhodecode.org/)。

# ios - iOS6 音乐和时钟应用程序标签栏，带有分段按下按钮

> ID：12552258
> 
> 赞同：-2
> 
> 时间：2012-09-23T12:10:31.773
> 
> 标签：ios, ipad, uitabbar, ios6

有谁知道如何在 iPad 上的音乐和时钟应用程序中像 Apple 一样设置 uitabbar 的样式？![在此处输入图像描述](../Images/65f898a35dc3335d557e48abc59760e0.png)

我一直在网上搜索，但在那里找不到太多。

谢谢

**编辑：**

换个说法，我试图了解如何进行设置。我一直在尝试使用 uitabbarcontroller，但我不确定这是否是 uitabbaritems 的操纵样式，或者它是否使用分段控件。这似乎是苹果新应用程序中的常见视图，但我不确定需要多少定制才能达到效果。如果我想以与 Apple 的音乐和时钟应用程序类似的方式选择两个独特的视图，我会采用如下方法：

*   UIViewController（根）
    *   UI工具栏
        *   分段控制
            *   按钮 1
                *   加载 ViewController1
            *   按钮 2
                *   加载 ViewController2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:17:32.750

那是一个`UISegmentedControl`. 您可以使用以下方法设置其外观样式：

```
/* Default tintColor is nil. Only used if style is UISegmentedControlStyleBar or UISegmentedControlStyleBezeled
 */
@property(nonatomic,retain) UIColor *tintColor UI_APPEARANCE_SELECTOR;

/* If backgroundImage is an image returned from -[UIImage resizableImageWithCapInsets:] the cap widths will be calculated from that information, otherwise, the cap width will be calculated by subtracting one from the image's width then dividing by 2\. The cap widths will also be used as the margins for text placement. To adjust the margin use the margin adjustment methods.

 In general, you should specify a value for the normal state to be used by other states which don't have a custom value set.

 Similarly, when a property is dependent on the bar metrics (on the iPhone in landscape orientation, bars have a different height from standard), be sure to specify a value for UIBarMetricsDefault.
 In the case of the segmented control, appearance properties for UIBarMetricsLandscapePhone are only respected for segmented controls in the smaller navigation and toolbars that are used in landscape orientation on the iPhone.
 */
- (void)setBackgroundImage:(UIImage *)backgroundImage forState:(UIControlState)state barMetrics:(UIBarMetrics)barMetrics NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR; 
- (UIImage *)backgroundImageForState:(UIControlState)state barMetrics:(UIBarMetrics)barMetrics NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR;

/* To customize the segmented control appearance you will need to provide divider images to go between two unselected segments (leftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateNormal), selected on the left and unselected on the right (leftSegmentState:UIControlStateSelected rightSegmentState:UIControlStateNormal), and unselected on the left and selected on the right (leftSegmentState:UIControlStateNormal rightSegmentState:UIControlStateSelected).
 */
- (void)setDividerImage:(UIImage *)dividerImage forLeftSegmentState:(UIControlState)leftState rightSegmentState:(UIControlState)rightState barMetrics:(UIBarMetrics)barMetrics NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR;
- (UIImage *)dividerImageForLeftSegmentState:(UIControlState)leftState rightSegmentState:(UIControlState)rightState barMetrics:(UIBarMetrics)barMetrics  NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR;

/* You may specify the font, text color, text shadow color, and text shadow offset for the title in the text attributes dictionary, using the keys found in UIStringDrawing.h.
 */
- (void)setTitleTextAttributes:(NSDictionary *)attributes forState:(UIControlState)state NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR;
- (NSDictionary *)titleTextAttributesForState:(UIControlState)state NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR;

/* For adjusting the position of a title or image within the given segment of a segmented control.
 */
- (void)setContentPositionAdjustment:(UIOffset)adjustment forSegmentType:(UISegmentedControlSegment)leftCenterRightOrAlone barMetrics:(UIBarMetrics)barMetrics NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR; 
- (UIOffset)contentPositionAdjustmentForSegmentType:(UISegmentedControlSegment)leftCenterRightOrAlone barMetrics:(UIBarMetrics)barMetrics NS_AVAILABLE_IOS(5_0) UI_APPEARANCE_SELECTOR; 
```

此示例为不同的选择状态设置背景和分隔线图像（使用外观代理更改所有分段控件的外观）：

```
UIImage *segmentSelected = 
    [[UIImage imageNamed:@"segcontrol_sel.png"] 
        resizableImageWithCapInsets:UIEdgeInsetsMake(0, 15, 0, 15)];
UIImage *segmentUnselected = 
    [[UIImage imageNamed:@"segcontrol_uns.png"] 
        resizableImageWithCapInsets:UIEdgeInsetsMake(0, 15, 0, 15)];
UIImage *segmentSelectedUnselected = 
    [UIImage imageNamed:@"segcontrol_sel-uns.png"];
UIImage *segUnselectedSelected = 
    [UIImage imageNamed:@"segcontrol_uns-sel.png"];
UIImage *segmentUnselectedUnselected = 
    [UIImage imageNamed:@"segcontrol_uns-uns.png"];

[[UISegmentedControl appearance] setBackgroundImage:segmentUnselected 
    forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
[[UISegmentedControl appearance] setBackgroundImage:segmentSelected 
    forState:UIControlStateSelected barMetrics:UIBarMetricsDefault];

[[UISegmentedControl appearance] setDividerImage:segmentUnselectedUnselected 
    forLeftSegmentState:UIControlStateNormal 
    rightSegmentState:UIControlStateNormal 
    barMetrics:UIBarMetricsDefault];
[[UISegmentedControl appearance] setDividerImage:segmentSelectedUnselected 
    forLeftSegmentState:UIControlStateSelected 
    rightSegmentState:UIControlStateNormal 
    barMetrics:UIBarMetricsDefault];
[[UISegmentedControl appearance] 
    setDividerImage:segUnselectedSelected 
    forLeftSegmentState:UIControlStateNormal 
    rightSegmentState:UIControlStateSelected 
    barMetrics:UIBarMetricsDefault]; 
```

# r - 数值变量和 2 因子变量的汇总统计（SAS 中的这些命令在 R 中是什么？）

> ID：12552259
> 
> 赞同：0
> 
> 时间：2012-09-23T12:11:06.297
> 
> 标签：r, sas, summary

我是 R 新手 - 我习惯使用 SAS。我有一个包含很多变量的数据集，其中三个变量是`age`、`sex`和`agegroup`。我正在尝试`age`在`sex`和`agegroup`变量中生成变量的汇总统计数据（平均值、中位数、Q1-Q3、sd）。即女性年龄的汇总统计数据（`sex=0`）在`agegroup`1 中，然后`agegroup`是 2 等，对于男性（性别 = 1）也是如此。

在 SAS 中，我会使用：

```
proc univariate data=mydata;  
var age;  
class agegroup;  
class sex;  
run; 
```

这在 R 中会是什么？

另外，R中的SAS'等于什么`npar1way`？例如

```
proc npar1way data=mydata;  
where minutes ne 9;  
var minutes;  
class sex;  
run;` 
```

其中分钟不等于 9，因为 9 是缺失值。我如何在 R 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T15:14:42.810

```
# In R, missing values are denoted by "NA" instead of the number 9.

# save this data in a text file 
age agegroup sex
1 agegroup1 male
2 agegroup2 female
3 agegroup3 male
5 agegroup1 female
7 agegroup2 male
8 agegroup3 female
1 agegroup3 male
2 agegroup2 female
3 agegroup1 male

# Set the working directory to the location of the data file using the function 
setwd("PATH OF THE DIRECTORY")

data <- read.table("data", header=TRUE, sep=" ")
data
data$sex <- factor(data$sex, levels = c('male', 'female'), ordered=TRUE)
data$agegroup <- factor(data$agegroup, levels = c('agegroup1', 'agegroup2', 'agegroup3'), ordered=TRUE)

# Know the structure of your data
str(data)

# Summary of the data
summary(data)

# Std. Dev. of the variable "age"
std.dev.age <- sd(data$age)
std.dev.age

# Summary of three variables in a table form
table(data)

# Plot a dodged bar chart with age ~ sex + agegroup
library("ggplot2")

ggplot(data = data, aes(x = sex, y = age, ymin=0, ymax=8, fill = agegroup)) + geom_bar(position="dodge", stat="identity", width=0.50) + scale_fill_manual(values=c("red", "green", "blue")) + labs (x = "", y= "age(years)",  fill=" ") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T15:41:17.067

您可以使用`aggregate`函数 in`R`将数据拆分为子集，计算每个子集的汇总统计信息，并以方便的形式返回结果。

```
> age <- runif(100, 20, 60)
> sex <- sample(c(0, 1), 100, replace = T)
> agegroup <- sample(1:3, 100, replace = T)
# create some data 
```

然后，您可以计算按`sex`和分组`agegroup`的子集的分位数

```
> aggregate(x=age, by=list(sex=sex, agegroup=agegroup), FUN="quantile")
  sex agegroup     x.0%    x.25%    x.50%    x.75%   x.100%
1   0        1 26.70523 31.75807 37.09244 46.49449 59.77582
2   1        1 20.68903 34.49182 45.66960 48.69480 54.90620
3   0        2 20.22123 33.22948 40.57074 47.32490 58.85273
4   1        2 23.50579 31.38165 35.69254 45.13376 50.68572
5   0        3 23.46469 29.72909 42.53047 46.93867 58.30279
6   1        3 20.64256 27.22600 39.70127 48.66251 59.61565 
```

或计算平均值

```
> aggregate(x=age, by=list(sex=sex, agegroup=agegroup), FUN="mean")
  sex agegroup        x
1   0        1 39.95470
2   1        1 41.53341
3   0        2 40.53606
4   1        2 37.32189
5   0        3 40.68784
6   1        3 38.74829 
```

对于您要为每个子集计算的标准差或方差或其他统计数据，类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T22:42:44.153

```
# make some test data
age <- runif(100, 20, 60)
sex <- sample(c(0, 1), 100, replace = T)
agegroup <- sample(1:3, 100, replace = T)
test <- data.frame(age,sex,agegroup)

# define a new summary function to include the SD as well
# otherwise you will just get mean,median,min,max,Q1-Q3.
newsummary <- function(x) {c(summary(x),SD=sd(x))}

# get the summary stats by each agegroup/sex combo
by(test$age,test[c("sex","agegroup")],newsummary) 
```

结果看起来像这样，这是一个列表格式的输出。

```
> by(test$age,test[c("sex","agegroup")],newsummary)
sex: 0
agegroup: 1
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.       SD 
22.07000 27.72000 38.36000 38.41000 48.02000 54.93000 11.50681 
------------------------------------------------------------ 
sex: 1
agegroup: 1
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.       SD 
24.36000 38.20000 44.96000 44.55000 52.95000 58.03000 10.70105 
------------------------------------------------------------ 
sex: 0
agegroup: 2
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.       SD 
21.52000 28.54000 36.75000 38.52000 49.45000 57.12000 12.26674 
------------------------------------------------------------ 
sex: 1
agegroup: 2
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.      SD 
20.0900 26.9900 31.7700 35.9800 44.6200 57.3500 11.9548 
------------------------------------------------------------ 
sex: 0
agegroup: 3
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.      SD 
20.5100 30.4300 39.6300 39.4100 47.4100 57.6000 11.9816 
------------------------------------------------------------ 
sex: 1
agegroup: 3
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.       SD 
20.04000 25.01000 36.03000 37.58000 47.81000 59.65000 13.14822 
```

# asp.net - WebMatrix Razor 页面和全局 using 语句

> ID：12552261
> 
> 赞同：5
> 
> 时间：2012-09-23T12:11:11.653
> 
> 标签：asp.net, asp.net-mvc, razor, using, webmatrix

如何在 WebMatrix Razor 上下文（不是 ASP.NET MVC Razor）中为我的所有 .cshtml 页面设置全局使用？

因此，与其放在`@using System.Web.Optimization`我需要包含的每个 .cshtml 文件的顶部，不如`@Scripts.Render()`将它放在一个地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:19:46.090

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="webpages:Enabled" value="true" />
  </appSettings>
  <system.web.webPages.razor>
    <pages pageBaseType="System.Web.WebPages.WebPage">
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
      </namespaces>
    </pages>
  </system.web.webPages.razor>
</configuration> 
```

另请参阅：[使用 AngularJS 和 ASP.NET MVC 4 构建单页应用程序](http://tarkus.me/post/32121691785/angularjs-with-asp-net-mvc-4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:02:53.793

**已编辑** 请查看以下帖子。他们正在讨论你的问题，我相信你可以从那里得到关于做什么的想法：

[当前上下文中不存在名称“资产”](http://forums.asp.net/t/1811979.aspx/1)

希望对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-20T10:45:37.483

对于 webmatrix，在 web.config 配置中使用以下内容

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

# jquery-ui - jquery ui可排序，第一项中的div块不可见

> ID：12552263
> 
> 赞同：0
> 
> 时间：2012-09-23T12:11:18.013
> 
> 标签：jquery-ui, jquery-ui-sortable

我想让可排序列表的第一项中的 div -“small_box”始终不可见。我尝试使用 jquery first() 但它只工作一次，并且只适用于一个相同的元素，只要它被拖动。当我将它拖到第一个位置以外的位置然后为首先跳转的项目制作不可见的“small_box”时，我如何简单地让它重新可见？

我把现场例子放在这里：http: [//jsfiddle.net/kriskasper/3knnn/](http://jsfiddle.net/kriskasper/3knnn/)

```
<ul id="sortable" class='connectedSortable'>
<li>
    <div class="small_box">small box</div>     
    <div class="big_box">big box</div>
</li>        
<li>
    <div class="small_box">small box</div>     
    <div class="big_box">big box</div>
</li>        
<li>
    <div class="small_box">small box</div>     
    <div class="big_box">big box</div>
</li>

<li>
    <div class="small_box">small box</div>     
    <div class="big_box">big box</div>
</li>       
</ul> 
```

这是jquery ui函数：

```
 $(function() {
    $( "#sortable" ).sortable({
        connectWith: ".connectedSortable",
        placeholder: "ui-state-highlight",
        forcePlaceholderSize: true,
        opacity: 0.6,
        revert: 70

    });
}); 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:20:28.400

您应该使用可排序的插件事件。当连接的元素接收到一个项目时，会触发 sortreceive 事件。我的猜测是......

```
$("#sortable").bind("sortreceive", function(event, ui) {
    $(".connectedSortable .small_box").show();
    $("#sortable .small_box").first().hide();
}); 
```

# python - 使用 PySide 和 PyKDE4 移动窗口

> ID：12552266
> 
> 赞同：5
> 
> 时间：2012-09-23T12:11:57.077
> 
> 标签：python, pyqt4, pyside, xlib, pykde

我应该如何使用窗口管理器移动使用 PySide 创建的窗口？

我看到 kdeui 有`NETRootInfo`一个带有`moveResizeRequest`方法的类，这正是我想要的。以下：

```
from PySide.QtCore import Qt
from PyKDE4 import kdeui
from PySide.QtGui import QX11Info
import sys
from ctypes import CDLL
Xlib = CDLL('libX11.so.6')

def move_window(window, event):
    if event.buttons() & Qt.LeftButton:
        pos = event.buttonDownScreenPos(Qt.LeftButton)
        Xlib.XUngrabPointer(QX11Info.display(), QX11Info.appTime())
        rootinfo = kdeui.NETRootInfo(QX11Info.display(), kdeui.NET.WMMoveResize)
        rootinfo.moveResizeRequest(window.winId(), pos.x(), pos.y(), kdeui.NET.Move) 
```

给我：

```
TypeError: NETRootInfo(): arguments did not match any overloaded call:
  overload 1: argument 1 has unexpected type 'int'
  overload 2: argument 1 has unexpected type 'int'
  overload 3: argument 1 has unexpected type 'int'
  overload 4: argument 1 has unexpected type 'int' 
```

这个错误是因为`QX11Info.display()`返回一个长的（指针），而不是一个显示结构。

我可以使用 PyQt4`QX11Info.display()`作为构造函数的第一个参数，`NETRootInfo`而不是 PySide，例如：

```
...
from PySide.QtGui import QX11Info
from PyQt4.QtGui import QX11Info as QX11InfoQt
...

def move_window(window, event):
    if event.buttons() & Qt.LeftButton:
        pos = event.buttonDownScreenPos(Qt.LeftButton)
        Xlib.XUngrabPointer(QX11Info.display(), QX11Info.appTime())
        rootinfo = kdeui.NETRootInfo(QX11InfoQt.display(), kdeui.NET.WMMoveResize)
        rootinfo.moveResizeRequest(window.winId(), pos.x(), pos.y(), kdeui.NET.Move) 
```

但这除了 PySide 之外，还增加了对 PyQt4 的依赖。

此外，我尝试过使用 Xlib 的`XMoveWindow`功能，但这可以防止窗口部分拖出屏幕，并且不会提供 Compiz 或 KWin 等窗口管理器提供的移动反馈（例如透明效果）。

我的问题是：

1.  如何将 PySide 转换`QX11Info.display()`为可以传递给的“显示” `kdeui.NETRootInfo`，**或**
2.  如何使用 Python 和 Xlib（`python-xlib`通过 libX11.so 或通过 libX11.so）使用消息`_NET_WM_MOVERESIZE`，如移动窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T16:50:35.007

我怀疑你的最后一个电话实际上有不同的签名，也许是这样的：

`moveResizeRequest(<window object>, <int>, <int>, <const>)`

当您尝试压缩窗口 id (int) 时。

在对 pygtk（而不是 pykde）有一些经验之后，您可能必须枚举给定屏幕中的所有高级窗口才能获得窗口句柄对象。

同样，来自 c++ kde 文档：

```
display     An X11 Display struct.
supportWindow   The Window id of the supportWindow. The supportWindow must be created by the window manager as a child of the rootWindow. The supportWindow must not be destroyed until the Window Manager exits. 
```

当您尝试将一些常量挤入 supportWindow 时。

# c - 这两个位置有什么区别？

> ID：12552268
> 
> 赞同：0
> 
> 时间：2012-09-23T12:12:05.640
> 
> 标签：c, function, recursion

我有一个递归程序。在`printf`函数中使用时输出 123 ，在外部使用时输出 0123 。

```
#include <stdio.h>

fact(int);
int main()
{
    int x=3;
    fact(x);
    printf("\n");
    system("PAUSE");
}

int fact(int y)
{
    if (y > 0)
    {
         fact(y-1);
         printf("%d",y);  
    }
    //printf("%d",y);   
} 
```

我没有同时使用两者`printf`。此`printf`语句的位置会产生什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:16:35.750

由于您的`if`条件查找大于零的值，因此它按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:17:00.060

当使用`printf`该块的外部时，`IF`即使 y 为 0，它也会被执行，而块`printf`内部则不是这种情况`IF`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:29:36.990

我想说您自己没有看到答案的一个原因是您的代码草率。以下是一些抱怨：

1.  您的函数没有明确的返回语句，这对于理解递归代码尤其重要。
2.  system() 需要 stdlib，但不包括 stdlib.h。
3.  system("PAUSE") 是不可移植且不必要的。实际上，因此您的代码不会在我的系统上运行。见： [http ://www.gidnetwork.com/b-61.html](http://www.gidnetwork.com/b-61.html)
4.  你的问题看起来像作业，所以这个是作业的错，而不是你的错：因为 n！增长如此之快，使用'int'作为返回类型的阶乘函数只能计算n！对于 1<=n<=12，这是没用的。

`return`试试这个练习：使用单个和条件赋值编写一个单行阶乘函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T13:02:49.743

fact(int) 按以下顺序调用，

事实(3)-->事实(2)--->事实(1)--->事实(0)

最后一个调用是 fact(0)。根据 fact(int) 的实现，传入 0 时，如果在场外使用 printf()，则打印 0。如果内部使用了 printf()，则不打印 0。

事实上，所有传入 fact(int) 的值都会在外部使用 printf() 时打印出来。

# svn - SVN 将以前的版本合并到工作副本中

> ID：12552274
> 
> 赞同：11
> 
> 时间：2012-09-23T12:12:46.187
> 
> 标签：svn, version-control, merge

如果

*   我正在修订版本 5 的 SVN 分支上工作。
*   我进行了更改，承诺创建修订版 r6。
*   在 r6 引入问题时恢复到 r5，并提交，创建 r7
*   继续在 r7 上工作，最终提交到 r10 的更改

如何将 r6 中所做的更改合并回我的工作副本？

我试过了

```
svn merge -r5:6 . 
```

和

```
svn merge -r5:HEAD . 
```

两者似乎都无济于事。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-03T15:33:52.197

尝试这个：

```
svn merge --ignore-ancestry -r5:6 . 
```

或使用更新的语法：

```
svn merge --ignore-ancestry -c6 . 
```

顺便说一句：我建议始终指定要使用的文件而不是“。”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-04T15:59:43.940

如果您使用的是相对较新的 svn 版本，您可以使用：

```
svn merge -c -6 . 
```

（或您要还原的特定文件，而不是“。”）
这是以下的简写：

```
svn merge -r6:5 . 
```

因此，如果您使用的是较旧的 subversion 版本（1.6.x 之前），您可以使用此语法。

这可能会将属性引入您的存储库（svn:mergeinfo，如果有记忆的话），至少如果您对整个目录执行合并。将更改还原到单个文件或一组文件不会影响属性。如果您不希望将这些属性添加到存储库中，则可能需要回退到补丁（自动或手动）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T12:25:30.050

I am not too familiar with command line svn. But in case the correct usage does not get you the result you want here is what I would try:

1.  Create a patch out of revision r6 (differences between r6 and r5).
2.  Apply it on the working copy.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-29T17:47:20.940

尝试反转合并出初始还原的修订。

例如，代替 svn merge -r 5:6 尝试 svn merge -r 7:6 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-29T17:51:33.210

你可以恢复。创建一个标签。完成后，您可以将标记中的更改合并到您正在工作的分支中。

# nginx - Nginx 重写。只需要帮助重写 0-9a-z- 字符

> ID：12552275
> 
> 赞同：0
> 
> 时间：2012-09-23T12:13:08.370
> 
> 标签：nginx, rewrite

我的 nginx 虚拟主机文件中有这个指令：

```
try_files $uri $uri/ /profile.php?nickname=$uri&$args; 
```

它工作正常，但我只想重写 0-9a-z- 字符，以便用户有很好的个人资料地址，例如：

```
http://www/mydomain.com/john 
```

但是 nginx 重写了一切。例如，如果我输入地址：

```
http://www.mydomain.com/non-existing-holder/nonexisting-filename.html 
```

它不会返回 404 错误，而是重写所有内容。

有没有办法只重写 0-9-az- 字符？

```
server {
    listen 80;
    server_name www.mydomain.com;
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
    root /var/www/mydomain;
    error_page 404 /4044.html;
    location / {
        index index.html index.htm index.php;
        try_files $uri $uri/ /profile.php?nickname=$uri&$args;
        rewrite ^/forum/([0-9-]+)/([0-9a-z-]+).html$ /forum.php?tid=$1&title=$2 last;
    }

    location ~ \.php$ {
        try_files  $uri =404;
        include /etc/nginx/fastcgi_params;
        fastcgi_pass  127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:39:06.840

您可以尝试以下配置。

*   对 /testUSER 的请求将返回 404
*   对 /forum/100/something.html 的请求将转到 /forum.php?tid=100&title=something
*   /nickname 的请求将转到 /profile.php?nickname=nickname

.

```
location / {
    index index.html index.htm index.php;
    rewrite ^/([0-9a-z-]+)/?$ /profile.php?nickname=$1&$args last;
    try_files $uri $uri/ =404;
}
location /forum {
    rewrite ^/forum/([0-9-]+)/([0-9a-z-]+).html$ /forum.php?tid=$1&title=$2 last;
    alias /var/www/mydomain/forum;
} 
```

# c++ - 同时迭代两个或多个容器的最佳方法是什么

> ID：12552277
> 
> 赞同：132
> 
> 时间：2012-09-23T12:13:11.710
> 
> 标签：c++, c++11, iterator, containers

C++11 提供了多种迭代容器的方法。例如：

## 基于范围的循环

```
for(auto c : container) fun(c) 
```

## std::for_each

```
for_each(container.begin(),container.end(),fun) 
```

但是，推荐的方法是迭代两个（或更多）相同大小的容器以完成以下操作：

```
for(unsigned i = 0; i < containerA.size(); ++i) {
  containerA[i] = containerB[i];
} 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-09-25T13:19:57.697

派对迟到了。但是：我会遍历索引。但不是使用经典`for`循环，而是使用基于范围`for`的索引循环：

```
for(unsigned i : indices(containerA)) {
    containerA[i] = containerB[i];
} 
```

`indices`是一个简单的包装函数，它返回索引的（惰性求值）范围。由于实现（虽然简单）有点太长，无法在此处发布，[您可以在 GitHub 上找到实现](https://github.com/klmr/cpp11-range)。

此代码与使用手动经典循环**一样有效。**`for`

如果这种模式经常出现在您的数据中，请考虑使用另一种模式，它包含`zip`两个序列并生成一系列元组，对应于成对的元素：

```
for (auto& [a, b] : zip(containerA, containerB)) {
    a = b;
} 
```

的实现`zip`留给读者作为练习，但它很容易从`indices`.

（在 C++17 之前，您必须改为编写以下代码：）

```
for (auto items&& : zip(containerA, containerB))
    get<0>(items) = get<1>(items); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-09-23T15:04:59.103

对于您的具体示例，只需使用

```
std::copy_n(contB.begin(), contA.size(), contA.begin()) 
```

对于更一般的情况，您可以使用 Boost.Iterator 的`zip_iterator`一个小函数，使其可用于基于范围的 for 循环。在大多数情况下，这将起作用：

```
template<class... Conts>
auto zip_range(Conts&... conts)
  -> decltype(boost::make_iterator_range(
  boost::make_zip_iterator(boost::make_tuple(conts.begin()...)),
  boost::make_zip_iterator(boost::make_tuple(conts.end()...))))
{
  return {boost::make_zip_iterator(boost::make_tuple(conts.begin()...)),
          boost::make_zip_iterator(boost::make_tuple(conts.end()...))};
}

// ...
for(auto&& t : zip_range(contA, contB))
  std::cout << t.get<0>() << " : " << t.get<1>() << "\n"; 
```

[活生生的例子。](http://liveworkspace.org/code/df4ac8e496f12cc0d6bc9e2978af2feb)

但是，对于全面的通用性，您可能需要更像[这样](http://liveworkspace.org/code/10d97e566ef790b279b7599fc90437f4)的东西，这将适用于在其命名空间中没有成员`begin()`/`end()`但*有*`begin`/`end`函数的数组和用户定义类型。`const`此外，这将允许用户通过这些`zip_c...`功能专门获得访问权限。

如果你像我一样提倡漂亮的错误消息，那么你可能想要[this](http://liveworkspace.org/code/d52cf97bc56f5526292615659ea110c0)，它检查是否有任何临时容器被传递给任何`zip_...`函数，如果是，则打印一个漂亮的错误消息。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2016-03-28T10:36:01.503

我想知道为什么没有人提到这一点：

```
auto itA = vectorA.begin();
auto itB = vectorB.begin();

while(itA != vectorA.end() || itB != vectorB.end())
{
    if(itA != vectorA.end())
    {
        ++itA;
    }
    if(itB != vectorB.end())
    {
        ++itB;
    }
} 
```

PS：如果容器大小不匹配，那么您可能需要将每个容器特定代码放入其对应的 if 块中。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-09-23T14:40:41.710

有很多方法可以使用标题中提供的多个容器来执行*特定操作。*`algorithm`例如，在您给出的示例中，您可以使用`std::copy`而不是显式 for 循环。

另一方面，除了普通的 for 循环之外，没有任何内置方法可以通用地迭代多个容器。这并不奇怪，因为有*很多*迭代方法。想一想：你可以用一个步骤迭代一个容器，用另一个步骤迭代一个容器；或通过一个容器直到它到达末端，然后在您穿过另一个容器的末端时开始插入；或者每次您完全通过另一个容器时第一个容器的一个步骤然后重新开始；或其他模式；或一次超过两个容器；ETC ...

但是，如果您想创建*自己的*“for_each”样式函数，它只遍历两个容器，直到最短的一个容器的长度，您可以执行以下操作：

```
template <typename Container1, typename Container2>
void custom_for_each(
  Container1 &c1,
  Container2 &c2,
  std::function<void(Container1::iterator &it1, Container2::iterator &it2)> f)
  {
  Container1::iterator begin1 = c1.begin();
  Container2::iterator begin2 = c2.begin();
  Container1::iterator end1 = c1.end();
  Container2::iterator end2 = c2.end();
  Container1::iterator i1;
  Container2::iterator i2;
  for (i1 = begin1, i2 = begin2; (i1 != end1) && (i2 != end2); ++it1, ++i2) {
    f(i1, i2);
  }
} 
```

显然，您可以以类似的方式制定您想要的任何类型的迭代策略。

当然，您可能会争辩说，直接执行内部 for 循环比编写这样的自定义函数更容易……而且您是对的，如果您只打算执行一两次。但好的是，这是非常可重用的。=)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-04-29T19:01:23.413

如果您只需要同时迭代 2 个容器，则 boost 范围库中有标准 for_each 算法的扩展版本，例如：

```
#include <vector>
#include <boost/assign/list_of.hpp>
#include <boost/bind.hpp>
#include <boost/range/algorithm_ext/for_each.hpp>

void foo(int a, int& b)
{
    b = a + 1;
}

int main()
{
    std::vector<int> contA = boost::assign::list_of(4)(3)(5)(2);
    std::vector<int> contB(contA.size(), 0);

    boost::for_each(contA, contB, boost::bind(&foo, _1, _2));
    // contB will be now 5,4,6,3
    //...
    return 0;
} 
```

当您需要在一个算法中处理超过 2 个容器时，您需要使用 zip。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-06-09T20:15:04.963

另一种解决方案可能是在 lambda 中捕获另一个容器的迭代器的引用，并在其上使用后增量运算符。例如简单的副本将是：

```
vector<double> a{1, 2, 3};
vector<double> b(3);

auto ita = a.begin();
for_each(b.begin(), b.end(), [&ita](auto &itb) { itb = *ita++; }) 
```

在 lambda 中，你可以做任何事情`ita`，然后增加它。这很容易扩展到多个容器的情况。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-07-25T14:12:53.197

范围库提供了这个和其他非常有用的功能。以下示例使用[Boost.Range](http://www.boost.org/doc/libs/1_61_0/libs/range/doc/html/index.html)。[Eric Niebler 的 rangev3](https://github.com/ericniebler/range-v3)应该是一个不错的选择。

```
#include <boost/range/combine.hpp>
#include <iostream>
#include <vector>
#include <list>

int main(int, const char*[])
{
    std::vector<int> const v{0,1,2,3,4};
    std::list<char> const  l{'a', 'b', 'c', 'd', 'e'};

    for(auto const& i: boost::combine(v, l))
    {
        int ti;
        char tc;
        boost::tie(ti,tc) = i;
        std::cout << '(' << ti << ',' << tc << ')' << '\n';
    }

    return 0;
} 
```

C++17 将通过结构化绑定使这一点变得更好：

```
int main(int, const char*[])
{
    std::vector<int> const v{0,1,2,3,4};
    std::list<char> const  l{'a', 'b', 'c', 'd', 'e'};

    for(auto const& [ti, tc]: boost::combine(v, l))
    {
        std::cout << '(' << ti << ',' << tc << ')' << '\n';
    }

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-07-28T11:43:29.813

我也有点晚了；但你可以使用这个（C风格的可变参数函数）：

```
template<typename T>
void foreach(std::function<void(T)> callback, int count, ...) {
    va_list args;
    va_start(args, count);

    for (int i = 0; i < count; i++) {
        std::vector<T> v = va_arg(args, std::vector<T>);
        std::for_each(v.begin(), v.end(), callback);
    }

    va_end(args);
}

foreach<int>([](const int &i) {
    // do something here
}, 6, vecA, vecB, vecC, vecD, vecE, vecF); 
```

或者这个（使用函数参数包）：

```
template<typename Func, typename T>
void foreach(Func callback, std::vector<T> &v) {
    std::for_each(v.begin(), v.end(), callback);
}

template<typename Func, typename T, typename... Args>
void foreach(Func callback, std::vector<T> &v, Args... args) {
    std::for_each(v.begin(), v.end(), callback);
    return foreach(callback, args...);
}

foreach([](const int &i){
    // do something here
}, vecA, vecB, vecC, vecD, vecE, vecF); 
```

或者这个（使用大括号括起来的初始化列表）：

```
template<typename Func, typename T>
void foreach(Func callback, std::initializer_list<std::vector<T>> list) {
    for (auto &vec : list) {
        std::for_each(vec.begin(), vec.end(), callback);
    }
}

foreach([](const int &i){
    // do something here
}, {vecA, vecB, vecC, vecD, vecE, vecF}); 
```

或者你可以像这里一样加入向量：[连接两个向量的最佳方法是什么？](https://stackoverflow.com/questions/3177241/what-is-the-best-way-to-concatenate-two-vectors)然后迭代大向量。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-09-23T21:28:56.553

如果可能的话，我个人更喜欢使用 STL 中已经存在的内容（在`<algorithm>`标题中）。`std::transform`有一个可以接受两个输入迭代器的签名。因此，至少对于两个输入容器的情况，您可以这样做：

```
std::transform(containerA.begin(), containerA.end(), containerB.begin(), outputContainer.begin(), [&](const auto& first, const auto& second){
    return do_operation(first, second);
}); 
```

请注意，`outputContainer`也可以是输入容器之一。但一个限制是，如果您正在修改其中一个容器，则无法执行更新后操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-18T07:54:28.443

这是一种变体

```
template<class ... Iterator>
void increment_dummy(Iterator ... i)
    {}

template<class Function,class ... Iterator>
void for_each_combined(size_t N,Function&& fun,Iterator... iter)
    {
    while(N!=0)
        {
        fun(*iter...);
        increment_dummy(++iter...);
        --N;
        }
    } 
```

示例用法

```
void arrays_mix(size_t N,const float* x,const float* y,float* z)
    {
    for_each_combined(N,[](float x,float y,float& z){z=x+y;},x,y,z);    
    } 
```

# java - Java打印模板

> ID：12552278
> 
> 赞同：1
> 
> 时间：2012-09-23T12:13:21.923
> 
> 标签：java, html, printing

问题很简单，但我在网上找不到直接的解决方案。

我有一个文档模板，我希望能够填充信息（不同的信息，不止一次）然后打印。我最初的想法是创建一个 html 模板，然后将解析后的版本发送到 print。

我想这里不止一个问题：

*   解决此问题的最佳方法是什么？
*   如果 HTML 解析是最好的解决方案，有人可以指出我正确的方向，因为我不知道从哪里开始。

谢谢。

- 编辑：一个更好的例子来消除任何混乱。

在 java GUI 程序上，用户能够提取客户信息。我希望他们能够通过单击按钮打印发票。我目前的问题是决定如何用客户信息填充发票并将其发送到打印机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:18:30.990

我会选择一个网络[HTML 表单](http://www.w3schools.com/html/html_forms.asp)。当按下表单提交按钮时，让用户填充输入字段并在 POST 正文中传递它们。然后您分析输入并创建最终文档版本（在服务器上），然后才将文档返回给客户端，并在响应标头中使用适当的 MIME 类型（这就是您启用打印的方式）。

例如（带有提交按钮的简单表单）

```
<form name="input" action="html_form_action.asp" method="get">
     Username: <input type="text" name="user">
     <input type="submit" value="Submit">
</form> 
```

编辑：

对于构建文档模板，请查看[playframework](http://www.playframework.org/documentation/2.0/JavaHome)。

# javascript - Javascript时间比较

> ID：12552280
> 
> 赞同：0
> 
> 时间：2012-09-23T12:13:42.540
> 
> 标签：javascript, datetime, time, if-statement

我目前有以下脚本：

```
<script>
if(new Date().getHours() > 17 || (new Date().getHours() == 17 &&     
new Date().getMinutes()== 0 && new Date().getSeconds() == 0) && 
(new Date().getHours() < 21 && new Date().getMinutes() < 30 
&& new Date().getSeconds() == 0)){
        //do nothing.   
    } else {
    $(document).ready(function() {
        $(".inline").colorbox({inline:true, open:true, width:"50%"});
        });
    } 
```

所以基本上 if 中的内容：如果时间是 17:00 到 21:30，则什么也不做，否则显示该框。但是发生了什么事，盒子在 18:00 左右停止工作，并在午夜再次开始工作。有人看到这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:26:39.010

```
$(document).ready(function()
{
    var now = new Date(),
        block = $('div');

    if(now.getHours() >= 17 && (now.getHours() < 21 || (now.getHours() == 21 && now.getMinutes() <= 30)))
    {
        block.text('17:00 - 21:30');
        //do nothing.    
    }
    else
    {
        block.text('not 17:00 - 21:30');
        //$(".inline").colorbox({inline:true, open:true, width:"50%"});
    }
}); 
```

演示：http: [//jsfiddle.net/FwtRb/10/](http://jsfiddle.net/FwtRb/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:30:32.423

请注意，日期（包括小时）中的许多字段都是 0 索引的。这就是为什么您在 18:00 左右观察到此停止工作的原因。

我建议使用变量来使条件更易于推理。尝试这样的事情。如果您担心命名空间污染，请在其周围设置一个闭包。

```
var now = new Date();
var startQuietPeriod = new Date();
startQuietPeriod.setHours(16); startQuietPeriod.setMinutes(0); startQuietPeriod.setSeconds(0); startQuietPeriod.setMilliseconds(0);  // Today at 17:00
var endQuietPeriod = new Date();
endQuietPeriod.setHours(20); endQuietPeriod.setMinutes(30); endQuietPeriod.setSeconds(0); endQuietPeriod.setMilliseconds(0);  // Today at 21:30
if (startQuietPeriod < now && now < endQuietPeriod) {
  // don't show prompt
} else {
  // show prompt
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T12:47:06.200

我是这样写的：

```
var now = new Date();

if (now.getHours() >= 17 && now.getHours() <= 21) {
    if (now.getHours() == 21 && now.getMinutes() > 30) {
        return;
    }
}

// Do your document.ready stuff here 
```

首先，我确实将当前时间保存到一个变量中，这样我就可以少输入（记住：做一个懒惰的打字员！）。此外，这也稍微清理了您的条件，因此更容易发现任何逻辑错误。

其次，我将您的条件（在 17:00 和 21:30 之间什么都不做）分成两个单独的 if 条件。就个人而言，我更喜欢这种方式，因为它很简单，即使你在 2 年后回到你的代码。
您的代码与可读性一样好。永远记住这一点。复杂的 if 条件，即使评论很好，也只会让你和其他人在未来变得困难。忽略那些称你为菜鸟的人。

此外，我发现使用 a 更具可读性， 如果条件匹配`return`，它只会中止当前函数/ 。`<script>`这可以为您节省 1 个缩进级别 :-)

*Update*: You should also read [peakxu's answer](https://stackoverflow.com/questions/12552280/javascript-time-comparision#12552376) (and therefore the [MDN page for Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date#Methods)). Note that, as peakxu said, all of this is 0 indexed.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T12:24:11.953

```
var d = new Date();

if ( d.getHours() < 17 || 
     d.getHours() > 21 ||
    (d.getHours() == 21 && d.getMinutes() >= 30)) {

        $(document).ready(function() {
            $(".inline").colorbox({inline:true, open:true, width:"50%"});
        });
} 
```

# c# - 服务器端事件偶尔触发

> ID：12552282
> 
> 赞同：1
> 
> 时间：2012-09-23T12:13:54.513
> 
> 标签：c#, asp.net

我有一个产品下拉列表、一个显示已订购产品的网格视图和一个用于将下拉列表中的选定产品添加到网格视图的按钮。

当有人单击“添加新产品”按钮时，我的服务器端单击处理程序只会触发一些时间，而不会触发其他时间。可能是什么问题呢？

```
 private void AddNewProductToGridView()
    {
        if (lstProducts.SelectedIndex < 0) return;

        Response.Write("Selected Index: " + lstProducts.SelectedValue + 
            "<br />Selected Text: " + lstProducts.SelectedItem.Text + 
            "<br />Selected Value: " + lstProducts.SelectedValue);
    }

    protected void btnAddProduct_Click(object sender, EventArgs e)
    {
        AddNewProductToGridView();
    } 
```

**更新** 好的，在我发布问题后，按钮的服务器端点击事件每次都开始正常触发。:D

但是，还有另一个问题。我还有一个数量文本框。我希望该按钮充当页面的默认按钮，即当用户输入数量并按下回车键时，`AddNewProductToGridView`必须调用相同的服务器端方法。

因此，我将文本框的`AutoPostBack`属性设置为`True`并为文本框的文本更改事件添加了一个事件处理程序，如下所示：

```
 protected void txtQuantity_TextChanged(object sender, EventArgs e)
    {
        AddNewProductToGridView();
    } 
```

关于这一点，我很肯定这个事件处理程序不会触发，除非我第一次启动应用程序。

**稍后更新**

我想我找到了解决问题的方法并学到了一些新东西。

顾名思义，如果 TextBox 的 Text 属性自上次回发后未更改，则 TextBox 服务器端控件的 Text_Changed 事件不会触发。因此，它作为触发回发的手段是不可靠的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:01:42.580

> 我还有一个数量文本框。我希望该按钮充当页面的默认按钮

只需为该按钮指定默认按钮`<form>`，使其成为此按钮而不是最终提交表单的“最终”按钮（如果有的话）：

```
<form defaultbutton="btnAddProduct">
  ...
</form> 
```

不过，这里没有区分哪个`TextBox`或其他输入会在按 Enter 时导致提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:54:37.167

如果您想在 Enter 键上提交文本框更改，您可以简单地使用`<form>`，该按钮将是一个提交按钮。默认情况下，它会在按下 Enter 时提交。

# java - 如何刷新 JInternalFrame 或 JTable

> ID：12552284
> 
> 赞同：0
> 
> 时间：2012-09-23T12:14:02.137
> 
> 标签：java, swing, jtable, jinternalframe

我有`JInternalFrame`包含`JTable`. 如何刷新`JInternalFrame` 或`JTable`单击时`JButton ---> update`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:04:17.257

当你更新你的`TableModel`，`JTable`应该会自动刷新。如果不是，您`TableModel`应该更正，[例如](https://stackoverflow.com/a/7519403/230513).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:36:27.897

最简单的方法是调用`.repaint()`actionlistener。例如：

```
public class RefreshingButton extends JButton implements ActionListener{
    private static final long serialVersionUID = 1L;
    private final JComponent componentToRefsesh;

    public RefreshingButton(JComponent toRefresh) {
        super("Refresh JTable");
        this.componentToRefsesh = toRefresh;
        this.addActionListener(this);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        componentToRefsesh.repaint();
    }
} 
```

最好的方法是使用模型-视图-控制器设计模式。[http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

# sql - SQL WITH 子句示例

> ID：12552288
> 
> 赞同：257
> 
> 时间：2012-09-23T12:14:37.597
> 
> 标签：sql, with-clause

我试图了解如何使用该`WITH`条款以及该条款的目的`WITH`。

我所理解的是，该`WITH`子句是正常子查询的替代品。

谁能用一个小例子向我详细解释一下？

* * *

## 回答 #1

> 赞同：326
> 
> 时间：2012-09-23T12:20:01.933

SQL WITH 子句是 Oracle 在 Oracle 9i 第 2 版数据库中引入的。SQL WITH 子句允许您为子查询块命名（该过程也称为子查询重构），可以在主 SQL 查询中的多个位置引用该名称。分配给子查询的名称被视为内联视图或表。SQL WITH 子句基本上是普通子查询的替代品。

SQL WITH 子句的语法

以下是使用单个子查询别名时 SQL WITH 子句的语法。

```
WITH <alias_name> AS (sql_subquery_statement)
SELECT column_list FROM <alias_name>[,table_name]
[WHERE <join_condition>] 
```

使用多个子查询别名时，语法如下。

```
WITH <alias_name_A> AS (sql_subquery_statement),
<alias_name_B> AS(sql_subquery_statement_from_alias_name_A
or sql_subquery_statement )
SELECT <column_list>
FROM <alias_name_A>, <alias_name_B> [,table_names]
[WHERE <join_condition>] 
```

在上面的语法文档中，出现的`alias_name`是一个有意义的名称，您可以在 AS 子句之后为子查询指定。每个子查询都应该用逗号分隔[WITH 语句示例](http://docs.oracle.com/cd/B19306_01/server.102/b14200/img_text/subquery_factoring_clause.htm)。其余查询遵循简单和复杂 SQL SELECT 查询的标准格式。

欲了解更多信息：[http ://www.brighthub.com/internet/web-development/articles/91893.aspx](http://www.brighthub.com/internet/web-development/articles/91893.aspx)

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2012-09-23T12:23:26.543

This has been fully answered [here](https://stackoverflow.com/questions/324935/mysql-with-clause).

See [Oracle's docs on SELECT](http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_10002.htm#i2161315) to see how subquery factoring works, and Mark's example:

```
WITH employee AS (SELECT * FROM Employees)
SELECT * FROM employee WHERE ID < 20
UNION ALL
SELECT * FROM employee WHERE Sex = 'M' 
```

# html - 如何按比例调整多个图像的大小？

> ID：12552290
> 
> 赞同：1
> 
> 时间：2012-09-23T12:14:51.417
> 
> 标签：html, image-scaling

我正在创建一个具有多个图像层的新 HTML5 页面。第一层是背景层，它是全屏图像（与屏幕大小成正比）。

第二层是另一个图像对象，我希望它处于与第一层成比例的固定位置；所以如果我改变浏览器的大小，两张图片都会改变大小，所以它们彼此成比例。

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:01:24.217

所以，假设我们有一个“sky.jpg”背景图像和一个“sun.png”图像在它上面。

这是 HTML(5) 代码：

```
<div id="sky">
<img src="sun.png" id="sun">
</div> 
```

这是响应式 CSS：

```
#sky {
    width:100%; /* width in percentage, so it will adapt to user's screen */
    height:600px; /* here i've set a fixed height, but maybe it's not what you want */
    background:url(sky.jpg) top center no-repeat;
    text-align:center; /* #sun will be centered, not sure it's what you need */
    background-size:cover;
    -moz-background-size:cover;
}
#sun {
    width:15%; /* adjust it to the needed ratio */
    max-width:300px; /* max-width will prevent it from being bigger than the original image */
    min-width:20px; /* min-width is optional */
} 
```

[现场演示](http://jsfiddle.net/gionaf/YyQ8R/)（调整窗口大小）

* * *

注意`background-size`属性设置为`cover`（[更多信息here](http://www.css3.info/preview/background-size/)）。

这意味着纵横比将保持[为最小尺寸，使其宽度和高度都可以完全覆盖背景定位区域](http://www.w3.org/TR/css3-background/#the-background-size)。

这就是为什么您需要比大多数分辨率更大的图像（如果它是身体背景图像）。

此属性的其他可能值是“包含”和“自动”（[查看规范](http://www.w3.org/TR/css3-background/#the-background-size)）。

`background-size:cover;`IE8不[支持](http://www.standardista.com/css3/css3-background-properties/#bg11)（这就是我们仍然添加`top center`背景定位的原因），对于某些 FF 版本，您需要供应商前缀 ( `-moz-`)

* * *

现在您可以为#sun 设置百分比宽度，以便它与包含的 div 保持比例。为了防止它变得比原始大小大，您可以设置 a `max-width`（最后是 a `min-width`）。

图像的高度将在现代浏览器中自动调整。

* * *

如果您不想在#sky 上固定高度，请确保其容器的高度也不同于 auto（默认值）。

例如，如果#sky 是您的页面背景图片，您必须设置：

```
html, body { height:100%; }
#sky { height:100%; } 
```

# python - 使用 Python 2.7 从复杂数据文件中提取数据

> ID：12552292
> 
> 赞同：1
> 
> 时间：2012-09-23T12:14:59.293
> 
> 标签：python

我有一个大的 txt 文件，其中包含如下数据块：

```
AB x u z

1  0.00 1.00 4.23

2  0.34 2.33 1.44

3  4.23 3.55 6.22

AC x u z

AB x u z

1  0.88 1.00 4.27

2  0.36 2.33 1.44

3  4.23 3.55 6.22

AC x u z

AB x u z

1  0.66 1.77 8.23

2  0.44 2.33 1.44

3  4.23 3.55 6.44

AC x u z

AB x u z

1  0.44 1.99 8.22

2  0.34 2.33 1.44

3  4.23 3.55 6.22

AC x u z 
```

我正在使用 Python 2.7（该语言的新手），我只需要提取“AB xu z”和“AC xu v”行之间的行，例如第三个数据块，然后将这些行打印到另一个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:54:01.493

您可以尝试以下方法：

```
stored = []
with open("test.py") as f:
    for line in f:
        if line.startswith("AB x u z"):
            block = []
        elif line.startswith("AC x u z"):
            stored.append(block)
        else:
            block.append(line) 
```

这个想法是构建一个块列表 ( `stored`)，每个块包含 和 之间的`"AB x u z"`行`"AC x u z"`。请注意，您可能希望通过使用摆脱空行

```
elif line.strip():
    block.append(line) 
```

作为最后的测试。

因为我们使用的是`for...`循环，所以我们不会将整个文件加载到内存中（如果文件很大，这可能是个问题）。该`with...`语句将在读取时自动关闭您的文件。

**编辑** 正如评论中指出的那样，`stored`最终会将整个文件保存在内存中。然而，如果你只需要存储一些特定的块，你总是可以使用一个计数器，每次你找到一个结束行时你都会增加一个计数器`"AC x u z"`：如果这个计数器的值满足给定的要求，比如说`counter=3`，存储块，否则继续迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T11:01:15.097

@paulc，你可能已经解决了这个问题，但我只是想分享我的代码是一个“新人”

```
BLOCK_THREE = '3'
outStr = ""

# Read Data File
with open('rough_data.txt', 'r') as srcFile:
    for lnReader in srcFile:
        if lnReader.startswith(BLOCK_THREE):
            outStr += lnReader # lnReader reads each line as a String
        else:
            pass

# Write Data to a file
ofile = open('extracts2.txt', 'w')
ofile.write(u'' + outStr)
ofile.close()
print 'end' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:47:04.157

```
F = open ('yourfile.txt', 'r')

data = F.read.split('\n\n') #Assuming that there's two newlines between every 'block' 
```

这将为您提供一个列表（数据），在列表的每个位置都包含一个“块”。

# sas - 如果给出 EMI，如何找到 EMI 以及如何找到本金？

> ID：12552298
> 
> 赞同：-2
> 
> 时间：2012-09-23T12:15:56.480
> 
> 标签：sas

我有两个问题 2 问：-

(1).if principalamount =10,000 , Interest=4% abd Term=5Yrs(60 Months) 那么如何通过PMT函数找到EMI或者有什么函数可以找到？？？？？？

(2) 如果我有 EMI=350,Term=5yrs(60 Months) 和 Interest=4% 那么如何找到本金？？？？

5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:30:06.203

花了一些时间才知道 EMI 是“等量的每月分期付款”，所以如果这意味着我认为的那样，您可以使用该`MORT`功能，[记录在这里](http://support.sas.com/documentation/cdl/en/lefunctionsref/63354/HTML/default/viewer.htm#p1lu2y2jwy3twmn1mns17ix45c6o.htm)。

对于第一季度：

```
data _null_;
   principal = 10000;
   interest = .04/12; /* Monthly rate */
   term = 60;
   payment = .;

   payment = mort(principal, payment , interest, term);
   put payment=;
run; 
```

对于第二季度：

```
data _null_;
   principal = .;
   interest = .04/12; /* Monthly rate */
   term = 60;
   payment = 350;

   principal = mort(principal, payment, interest, term);
   put principal=;
run; 
```

请注意，该`MORT`函数返回缺少的任何值。

# selenium-webdriver - 如何在 selenium webdriver (java) 中发送键盘组合键？

> ID：12552300
> 
> 赞同：5
> 
> 时间：2012-09-23T12:16:06.010
> 
> 标签：selenium-webdriver

我想将 1999 发送到 Selenium WebDriver (java) 中的文本框。当我尝试在发送键之前将击键组合成一个字符串时，以下代码不起作用：

```
String allKeys = Keys.NUMPAD1 + Keys.NUMPAD9 + Keys.NUMPAD9 + Keys.NUMPAD9; 
```

收到此错误：

> 运算符 + 未定义参数类型 org.openqa.selenium.Keys、org.openqa.selenium.Keys

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T15:02:47.717

而不是使用：

```
String allKeys = Keys.NUMPAD1 + Keys.NUMPAD9 + Keys.NUMPAD9 + Keys.NUMPAD9; 
```

你应该使用：

```
driver.findelement(by.xpath(xpathExpr)).sendkeys(Keys.NUMPAD1, Keys.NUMPAD9, Keys.NUMPAD9, Keys.NUMPAD9); 
```

或使用：

```
String allKeys = "1999";
driver.findelement(by.xpath(xpathExpr)).sendkeys(allKeys); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-25T05:34:28.673

尝试这个。这个对我有用！

```
driver.findelement(by.xpath(xpathExpr)).SendKeys(keys.NumberPad1+keys.NumberPad9+keys.NumberPad9+keys.NumberPad9); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T18:47:31.447

为什么不使用发送键。

```
driver.findelement(by.xpath(xpathExpr)).sendkeys("1999"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-04T12:26:23.253

**问题**：如何在 selenium webdriver (java) 中发送键盘组合键？

**答**：您可以使用以下方法发送键盘按键

**方法一：**

```
driver.findElement(By.id("Year")).sendKeys(Keys.NUMPAD9); 
```

**方法二：**

```
String allKeys = "1999";

driver.findElement(By.id("Year")).sendKeys(allKeys); 
```

**方法3：**

```
driver.findElement(By.id("Year")).sendKeys("1999"); 
```

[![在此处输入图像描述](../Images/bbb6a4ee19c23918bc1f4acc134cb55d.png)](https://i.stack.imgur.com/yEtzR.png)

# php - 什么时候方法应该是静态的？PHP

> ID：12552305
> 
> 赞同：2
> 
> 时间：2012-09-23T12:16:40.167
> 
> 标签：php, oop, class, methods

我使用 PHP 作为我的编程语言。我真的不明白静态方法和变量的使用。

1.  什么时候方法应该是静态的？/什么方法应该是静态的？
2.  如何确定什么方法应该是静态的？
3.  优点和缺点静态方法和变量？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:20:07.887

将类属性或方法声明为静态使它们无需实例化即可访问。声明为静态的属性不能用实例化的类对象访问（尽管静态方法可以）。

当您处理基于 OOP 的大型项目时，您无疑会使用许多类（父类和子类）。这样做的一个不幸结果是，为了访问来自不同类的元素，必须手动将它们传递给每个类（或者更糟的是，将实例存储在全局变量中）。这可能会非常令人沮丧，并可能导致代码混乱和整体糟糕的项目设计。值得庆幸的是，静态元素可以从任何上下文（即脚本中的任何位置）访问，因此您可以访问这些方法，而无需在对象之间传递类的实例。

还要检查这个[PHP 中的静态方法与非静态方法有什么区别吗？](https://stackoverflow.com/questions/2439036/does-static-method-in-php-have-any-difference-with-non-static-method#answer-2439053)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T12:20:32.363

A method should be static when it is not bound to instance variables. If it is doing plane processing and taking all the variables from function inputs. It can be marked as static.

Its advantage is you need not to create instances to invoke functionality and hence saves memory.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:33:09.970

Declaring class properties or methods as static makes them accessible without needing an instantiation of the class. A property declared as static can not be accessed with an instantiated class object

```
<?php class Foo {
    public static function aStaticMethod() {
        // ...
    } }

$classname = 'Foo'; $classname::aStaticMethod(); // ( PHP 5.3.0) ?> 
```

"it can be initiated with out an OBJECT"

# php - 如何通过表单提交到数据库将 youtube 短 url 更改为可嵌入值？

> ID：12552313
> 
> 赞同：1
> 
> 时间：2012-09-23T12:17:46.717
> 
> 标签：php, mysql, forms

我希望能够将 youtube 视频的短网址输入到表单输入中，例如；

'http://youtu.be/rAndoMText'

并在“提交”时在处理表单的 php 文件中执行三个函数：

代替：

`'http://youtu.be/'`

和：

`'<a class='youtube' href="http://www.youtube.com/embed/'`

并添加：

`'?rel=0&amp;wmode=transparent">link</a>'`

到新值的末尾

然后将最终值提交到数据库。

我当前的 php 文件在下面，它的“逻辑”是基于我对 php 的基本知识和在互联网上搜索解决方案，我不希望它是正确的。

它确实在在线语法检查器中进行检查，并将其他表单输入发送到数据库，而不是我要修改的那个。

```
<?php

$original_link = $_POST["link"];
$prepender = "<a class='youtube' href=\"http://www.youtube.com/embed/\"";
$appender = "?rel=0&amp;wmode=transparent\">link</a>";

$modified_link = str_replace ("http://youtu.be/","$prepender","$original_link");

$modified_link . "" . $appender = $final_value;

$con = mysql_connect("localhost","username","password");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("database", $con);

$sql="INSERT INTO data (fieldone, fieldtwo, fieldthree, fieldfour, link)
VALUES
('$_POST[fieldone]','$_POST[fieldtwo]','$_POST[fieldthree]','$_POST[fieldfour]',
'$final_value')";

if (!mysql_query($sql,$con))
{
die('Error: ' . mysql_error());
}
header ('Location: http://return-to-your-website.com');

mysql_close($con);
?> 
```

我也尝试在上面的“modified_link”区域中使用它，但它返回了相同的结果：

```
$modified_link = "";
ob_start (); 
{
echo str_replace ("http://youtu.be/","$prepender","$original_link");
$modified_link = "ob_get_contents ()";
}
ob_end_clean (); 
$modified_link . "" . $appender = $final_value; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:05:16.047

这是将为您提供所需链接的代码：

```
$link_provided_by_user = 'http://youtu.be/rAndoMText';
$random_text = array_pop(explode('/',$link_provided_by_user)); // get the text after the last slash
$link_you_want = '<a class=\'youtube\' href="http://www.youtube.com/embed/'.$random_text.'?rel=0&amp;wmode=transparent">link</a>';

echo $link_you_want; // ex: <a class='youtube' href="http://www.youtube.com/embed/rAndoMText?rel=0&amp;wmode=transparent">link</a> 
```

## 请阅读[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)。

# .net - 现有连接被远程主机强行关闭

> ID：12552321
> 
> 赞同：2
> 
> 时间：2012-09-23T12:18:36.883
> 
> 标签：.net, sql-server, tcp

我从 .net 应用程序代码中收到以下错误。我将 VS2008 与 MS SQLServer Express 2005 一起使用。

与服务器成功建立连接，但在登录过程中出现错误。（提供者：TCP 提供者，错误：0 - 现有连接被远程主机强行关闭。）（.Net SqlClient 数据提供者）

我已经阅读了有关先前错误的博客和类似查询，即与服务器成功建立连接，但在登录过程中发生错误。（提供者：共享内存提供者，错误：0 - 管道的另一端没有进程）

按照这些博客上的说明，我现在已配置服务器以使用 TCP/IP 和命名管道进行远程连接。该顺序也类似于先 TCP/IP，然后是命名管道。

在 Windows 防火墙上，我为 SQL 端口配置了例外，允许在 1433 上使用，并且也允许使用 sqlbrowser.exe。

现在我得到“..现有连接被远程主机强行关闭。错误。

请提出任何帮助，因为我必须优先修复此应用程序部署。

使用的连接字符串是，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-30T21:30:37.510

我可以在 SQL Server 2008 上实现这一点，方法是尝试使用 SqlDb 接口插入一条“日期时间不为空”列设置为 C# 的 DateTime.MinValue 的记录。

@TestDate0=1/1/0001

向服务器发送请求时发生传输级错误。（提供者：TCP 提供者，错误：0 - 现有连接被远程主机强行关闭。）

这个案子肯定有奇怪的消息！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T19:57:58.477

请尝试延长连接保留时间，默认为 30 秒。连接超时并关闭后，如果你想对关闭的连接执行一些操作，你会看到这个错误。

# iphone - 如何读取 IBAction 中的 UITextField 值。我正在以编程方式创建 UITextField

> ID：12552322
> 
> 赞同：2
> 
> 时间：2012-09-23T12:19:23.200
> 
> 标签：iphone, objective-c, ios, ios5

如何读取`UITextField`中的值`IBAction`？我正在以`UITextField`编程方式创建。所以我不能设置`@property`和`@synthesize`使用 Xcode。生成的代码`UITextField`如下：

```
for(i=0; i<[fieldName count]; i++)
{
    UITextField *name = [fieldName objectAtIndex:i];
    frame = CGRectMake(fromLeft, fromTop, totalWidth, totalHeight);
    name = [[[UITextField alloc] initWithFrame:frame] autorelease];
    name.borderStyle = UITextBorderStyleRoundedRect;
    name.returnKeyType = UIReturnKeyDone;
    //name.placeholder = [fieldName objectAtIndex:i];
    name.autocapitalizationType = UITextAutocapitalizationTypeWords;
    name.adjustsFontSizeToFitWidth = TRUE;
    name.keyboardType = UIKeyboardTypeDefault;

    [name addTarget:self action:@selector(doneEditing:) forControlEvents:UIControlEventEditingDidEndOnExit];   
    [scroller addSubview:name];
    fromTop = fromTop + 40;
} 
```

现在我想在按钮单击（`IBAction`）中读取每个文本框的值。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T12:34:52.980

您可以使用类似这样的东西来遍历所有`UITextFields`的子视图`self.view`并将它们的文本添加到`NSMutableArray`：

```
for (UITextField *field in self.view.subviews) {
    if ([field isKindOfClass:[UITextField class]]) {
        if ([[field text] length] > 0) {
            [someMutableArray addObject:field.text];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T12:21:46.553

如果你`doneEditing:`看起来像这样，`doneEditing:(id)sender`那么你可以说：

```
UITextField *field = (UITextField *)sender;
NSString *myText = field.text; 
```

**编辑：**

要访问 UITextField 而不设置为实例变量，您需要在创建它时对其进行标记：

```
[textField setTag:1]; 
```

然后，无论何时您想访问它，都可以通过标签从其父视图中获取它：

```
UITextField *myTextField = [scroller viewWithTag:1];
NSString *myString = myTextField.text; 
```

在您的情况下，将标签设置`i+1`为例如让所有文本字段都带有唯一标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:22:36.137

```
NSString *value = sender.text; 
```

当然，如果在 IBAction 内部。

它忽略了有一组文本字段和一个按钮操作。

整个问题的最简单解决方案是将一组（或数组）文本字段存储在实例变量中，并在按钮操作中迭代该组。但这是一种相当粗略的方法。最好使用文本字段委托方法并将文本值直接存储在数组中，使用按钮触发保存。

此外，Apple HIG 会告诉您应该在编辑文本字段时更新您的数据模型，而不是使用“保存”按钮——这是糟糕的 UX 设计——当然，除非各个字段的值可以交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T12:30:23.490

实现 IBAction 函数，如下所示：

```
-(IBAction) doneEditing:(UITextField*)sender
{
    NSString * val = sender.text;

} 
```

尝试使用[UITextFieldDelegate](https://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)，我认为它更适合您的情况。

为每个 UITextField 添加一个标签，然后您将识别 UITextField。

# javascript - 是否可以在 CSS3 中的元素之间创建线？

> ID：12552332
> 
> 赞同：7
> 
> 时间：2012-09-23T12:20:29.000
> 
> 标签：javascript, html, css

我在我创建的应用程序中使用 jQuery Draggable，我想知道是否有可能以某种方式在网站上的对话框和元素之间创建一条线？我希望它在拖动时跟随可拖动框。

我正在寻找 CSS/HTML 方式而不是 jQuery/JS 方式。如果没有办法使用纯 CSS3/HTML5 创建它，那么我将从 JS 方法开始 - 只是想知道 :)

![在此处输入图像描述](../Images/4ac2b64f876dbb53d4e5e60c6f717d65.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T13:46:35.663

基本上：**不，**没有办法仅使用 CSS 来实现这一点。

但是，如果这被视为一个 CSS 谜题（我建议您不要在任何实际应用程序中使用以下解决方案），您可能能够实现类似的效果。同样，这将完全滥用 HTML 和 CSS。

你基本上创造了很多`divs`，每个代表一个“像素”。您更改`divs`' `background-color`on ，并使用（又一个滥用的）技巧（伪无限延迟）`:hover`保持`background-color`后状态消失。`:hover``transition`

这是一个演示：[小链接](http://jsfiddle.net/glee/6zCpW/)。尝试将鼠标悬停在顶部以查看移动鼠标时绘制的“面包屑”。

我再次夸大这完全是滥用，不应该在任何实际应用程序中使用。

这可以扩展为使用 CSS 创建一个小型绘画程序。我做了一个小片段来说明：[另一个小链接](http://dabblet.com/gist/3738326)（尝试通过单击和移动鼠标来绘制！）

**底线：**使用 JavaScript——在这种情况下，这是唯一的手段（没有 JavaScript，你无法控制 a `canvas`）。

# c#-4.0 - 带有异步等待的 MvvmLight IDataService

> ID：12552335
> 
> 赞同：1
> 
> 时间：2012-09-23T12:21:00.953
> 
> 标签：c#-4.0, mvvm-light, async-await

我正在尝试找到一种干净的方法来使用 async/await 来完成 MvvmLight 的 IDataService 模式。

最初我使用回调 Action 方法来与模板类似，但这也不会更新 UI。

```
public interface IDataService
{
    void GetData(Action<DataItem, Exception> callback);
    void GetLocationAsync(Action<Geoposition, Exception> callback);
}

public class DataService : IDataService
{
    public void GetData(Action<DataItem, Exception> callback)
    {
        // Use this to connect to the actual data service

        var item = new DataItem("Location App");
        callback(item, null);
    }

    public async void GetLocationAsync(Action<Geoposition, Exception> callback)
    {
        Windows.Devices.Geolocation.Geolocator locator = new Windows.Devices.Geolocation.Geolocator();
        var location = await locator.GetGeopositionAsync();
        callback(location, null);
    }
}

public class MainViewModel : ViewModelBase
{
    private readonly IDataService _dataService;

    private string _locationString = string.Empty;
    public string LocationString
    {
        get
        {
            return _locationString;
        }

        set
        {
            if (_locationString == value)
            {
                return;
            }

            _locationString = value;
            RaisePropertyChanged(LocationString);
        }
    }

    /// <summary>
    /// Initializes a new instance of the MainViewModel class.
    /// </summary>
    public MainViewModel(IDataService dataService)
    {
        _dataService = dataService;
        _dataService.GetLocation(
            (location, error) =>
            {
                LocationString = string.Format("({0}, {1})",
                location.Coordinate.Latitude,
                location.Coordinate.Longitude);
            });
    }
} 
```

**我正在尝试针对 gps 坐标进行数据绑定，但由于异步触发并且不在主线程上运行，因此它不会更新 UI。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T16:09:17.167

可能不相关，但 AFAICT 你错过了一些报价

```
 RaisePropertyChanged(LocationString); 
```

您传递更改的属性的名称，而不是其值。

# opengl-es - How to draw smooth lines with thickness in OpenGL [ES 2]

> ID：12552337
> 
> 赞同：2
> 
> 时间：2012-09-23T12:21:21.023
> 
> 标签：opengl-es, drawing, opengl-es-2.0

I'm looking for a way to draw lines with thickness and smoothness with OpenGL ES2 without using the build it glLineWidth function which has a lot of limitations. I think this can be done using shaders, but my glsl skills are limited.

What I've already tried is to actually construct a poly with rounded joints like in this [question's answer](https://gamedev.stackexchange.com/questions/28883/render-a-polyline-with-rounded-joints). However, for my purpose of free drawing this is an overkill and makes my app run very slow. So, I'm thinking, doing the same in the vertex shader will increase the performance, but not that much to become usable for my purpose (drawing).

So, right now I have a set of points that would describe the line nicely, if I would be able to connect them and give each connected segment thickness.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:30:52.360

在这种情况下经常做的是绘制一个没有平滑的四边形。然后使用平滑的单像素宽线画绘制四边形的轮廓。

# mercurial - Adjusting mercurial notify extension to send notification due to a certain string in the commit message?

> ID：12552340
> 
> 赞同：0
> 
> 时间：2012-09-23T12:22:37.857
> 
> 标签：mercurial, mercurial-hook, mercurial-extension

I need to send notifications to certain email due to a certain string in the commit message in the mercurial repository. I have now the notify extension working but it sends notifications at every push. thanx in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T17:26:36.680

您可以使用该`notify`扩展作为参考并推出您自己的钩子，该钩子将检查传入变更集中的提交消息，并在它们包含特定字符串时发送电子邮件。[Mercurial: The Definitive Guide](http://hgbook.red-bean.com/read/handling-repository-events-with-hooks.html)一书有一[章很棒的关于编写 hooks 的章节](http://hgbook.red-bean.com/read/handling-repository-events-with-hooks.html)，应该可以帮助您入门。

# php - 验证码刷新（未来的 Ajax）

> ID：12552345
> 
> 赞同：1
> 
> 时间：2012-09-23T12:23:31.927
> 
> 标签：php, ajax, submit, captcha

我在这里和那里遵循了一些 tuts 并制作了我自己的验证码会话，我想在我的更大项目中实施。验证码应该像其他地方一样在联系/发送电子邮件部分使用，以防止垃圾邮件重复。

问题 - 如果您错过了验证码并点击返回按钮，验证码不会刷新。这既好又坏，使用 ajax 意味着验证码不会刷新页面，验证码不会自行刷新。由于验证码是在不同的文件中制作的，我想再次调用同一个文件应该可以解决问题。

解决方案 - 我想要一个 3 次尝试系统，如果验证码没有被猜到 3 次，那么页面会被刷新。

PHP验证码：

```
<?php
session_start();
$text = rand(10000, 99999);
$_SESSION['captcha'] = $text;
// Create the image
$im = imagecreatetruecolor(400, 30);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 25, 25, 25);
$black = imagecolorallocate($im, 0, 0, 255);
imagefilledrectangle($im, 0, 0, 399, 29, $white);

$font = 'Candara.ttf';

imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

imagepng($im);
imagedestroy($im);
?> 
```

HTML 测试代码：

```
<form action="submit.php" method="post">
Message: <textarea name="comment"></textarea><br>
Captcha: <input type="text" name="val_code"/>&nbsp;&nbsp;<img src="generate captcha.php"><br>
<input type="submit" value="Submit" name="Submit"/>
</form> 
```

提交 PHP 代码：

```
<?php
session_start();
if($_POST["val_code"] != $_SESSION['captcha'] OR $_SESSION['captcha'] == '') {
echo "<b><font style='color: purple'>Wrong captcha value. Please go back and resend the message</font></b>";
}
else
{
echo "<b><font style='color: green'>Thank you for your message!</font></b>";
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:53:51.363

您需要使用一个计数器来跟踪尝试次数。另外，请确保取消设置验证码，使其无法重复使用。请参阅以下代码：

PHP验证码：

```
<?php
session_start();
if ($_SESSION['tries'] < 2 && $_SESSION['captcha']) {
    $text = $_SESSION['captcha'];
} else {
    $_SESSION['tries'] = 0;
    $text = rand(10000, 99999);
    $_SESSION['captcha'] = $text;
}
// Create the image
$im = imagecreatetruecolor(400, 30);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 25, 25, 25);
$black = imagecolorallocate($im, 0, 0, 255);
imagefilledrectangle($im, 0, 0, 399, 29, $white);

$font = 'Candara.ttf';

imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

imagepng($im);
imagedestroy($im);
?> 
```

PHP代码：

```
<?php
session_start();
if ($_SESSION['tries']>=2) {
   echo "<b><font style='color: purple'>Captcha has expired! You need to go back and reload the page</font></b>";
} else if($_POST["val_code"] != $_SESSION['captcha'] OR $_SESSION['captcha'] == '') {
echo "<b><font style='color: purple'>Wrong captcha value. Please go back and resend the message</font></b>";
$_SESSION['tries']++;
}
else
{
unset($_SESSION['captcha']);
unset($_SESSION['tries']);
echo "<b><font style='color: green'>Thank you for your message!</font></b>";
}
?> 
```

html测试代码：

```
<form action="submit.php" method="post">
Message: <textarea name="comment"></textarea><br>
Captcha: <input type="text" name="val_code"/>&nbsp;&nbsp;<img src="generate captcha.php" /><br>
<input type="submit" value="Submit" name="Submit" />
</form> 
```

# c++ - C++ Acces class array from other class

> ID：12552348
> 
> 赞同：-1
> 
> 时间：2012-09-23T12:23:53.970
> 
> 标签：c++, class

I got my main class Game:

Game.h:

```
class Game{
public:
    Galaxian galaxians[6][10];
}; 
```

Game.cpp:

Nothing interesting, just filling the variables of the class array

Galaxian.h:

```
class Galaxian{
public:
   void update();
}; 
```

Galaxian.cpp:

Here is my problem: I want to access the galaxians array from the Game class, but I have no idea how! When I try game::galaxians I get the error "A nonstatic member reference must be relative to a specific object"

What I am trying to accomplish is that I can loop trough that array and change a value of each key in it.

How can I do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:27:18.520

This is because the `galaxians` member is an instance member, not a class (i.e. not a static) member. You should either (1) make an instance of `Game` available at the point where you need to access `galaxians`, or (2) make `galaxians` a static member.

If you decide on the first way, consider making `Game` a *singleton*; if you decide on the second way, do not forget to *define* your `galaxians` array in a cpp file, in addition to declaring it `static` in the header file.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:27:05.263

Non-`static` members are bound to an instance of a class, not to the class itself. This is general OO, not specific to C++. So you either bind the access to an object, or the member to the class:

```
Game g;       //create an object of the class
g.galaxians;  //access the member through the object 
```

or

```
class Game{
public:
    static Galaxian galaxians[6][10];  //bind the member to the class
};

//...

Game::galaxians;  //access it through the class 
```

Which one you choose depends on your logic.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T12:27:38.813

You need to access an instance of `Game`:

```
Game g;
g.galaxians[3][4] = ....; 
```

# mysql - MySql SELECT COUNT ...不喜欢

> ID：12552350
> 
> 赞同：2
> 
> 时间：2012-09-23T12:24:00.397
> 
> 标签：mysql, sql, select, count, sql-like

我有这个查询

```
SELECT 
    COUNT(
            CASE 
                WHEN restricted LIKE '%us%' THEN 2 
                ELSE 1 
            END) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted LIKE '%us%' 
```

这会计算出现在列中的值（如“我们”）的总数（受限）。此列以这种“不寻常”的方式由来自多选复选框的值填充：

*us*ca*uk* 等

这有效。没问题。

现在，我需要计算这个值（我们）没有出现在哪里。我试图做到这一点，一个“经典”。

```
SELECT 
    COUNT(
            CASE 
                WHEN restricted NOT LIKE '%us%' THEN 2 
                ELSE 1 
            END
    ) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted NOT LIKE '%us%' 
```

我已经声明了语句 NOT LIKE 但现在......问题......它还计算未填充“受限”列的行（某些列表不使用此列）。而且计数是错误的。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:31:03.697

这个怎么样？

```
SELECT 
    COUNT(*) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted IS NOT NULL 
-- In case you expect restricted to contain spaces, the following line should be 
-- LTRIM(RTRIM(restricted)) != ''
AND restricted != '' 
AND restricted NOT LIKE '%us%' 
```

这将过滤掉限制为空或空的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:05:06.620

不需要 CASE 语句。您的 WHERE 子句意味着 ELSE 永远不会被击中。

匹配“我们”：

```
SELECT 
  COUNT(restricted) AS 'Count matching *us*' 
FROM 
  reviews 
WHERE 
  restricted IS NOT NULL 
  AND restricted LIKE '%us%' 
```

不匹配“我们”（包括 null）：

```
SELECT 
  COUNT(restricted) AS 'Count not matching *us*' 
FROM 
  reviews 
WHERE 
  restricted IS NULL 
  OR restricted NOT LIKE '%us%' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:33:11.973

'restricted' 列上的空值或空值将通过“restricted NOT LIKE '%us%'”语句。尝试更改为：

```
SELECT 
    COUNT(
            CASE 
                WHEN restricted NOT LIKE '%us%' THEN 2 
                ELSE 1 
            END
    ) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted NOT LIKE '%us%' 
    AND restricted != '' 
    AND restricted IS NOT NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-08T09:02:06.473

```
SELECT 
    COUNT(*) AS totalcount 
FROM 
    reviews 
WHERE 
    restricted IS NOT NULL 
```

如果您希望限制包含空格，则以下行应该是

```
LTRIM(RTRIM(restricted)) != ''
AND restricted != '' 
AND restricted NOT LIKE '%us%' 
```

# java - 一个类如何从其包含的复合类的父类（扩展 Activity）中引用一个变量？

> ID：12552358
> 
> 赞同：0
> 
> 时间：2012-09-23T12:26:16.463
> 
> 标签：java, android, android-activity, android-context

如何从“OtherClass”中获取“somevariable”的值？正如我在下面尝试的那样，我可以/应该使用 Activity 的上下文吗？

```
public class ParentActivity extends Activity {
  //This variable is reused by multiple Activities inheriting form this class
  protected static String somevariable = "text";   
  ...
}

public class MyActivity extends ParentActivity {
  @Override
  public void onCreate(Bundle icicle) {
  super.onCreate(icicle);
  myObject = new OtherClass(this);
  myObject.doSomething();
  ...
  }

...
}

public class OtherClass(){
  private Context c;
  private String b;

  OtherClass(Context context) {
    c = context;
  }

    doSomething() {
        // This does NOT work. 
        // How can I get somevariable from the ParentActivity????
        b = c.somevariable;   
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:43:00.510

如果您想访问`somevariable`类中定义的特定内容，`ParentActivity`那么您应该尝试访问它，`ParentActivity.somevariable`因为它已被声明`static`：

```
public class OtherClass { // Why were there extra parentheses ()
  private Context c;
  private String b;

  OtherClass(Context context) {
    c = context;
  }

  doSomething(){
  b = ParentActivity.somevariable; // Try this at home ;)
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:30:27.043

您可以像这样传递变量：

```
public void doSomething(String someVariable){
  b = someVariable;   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:36:34.637

```
a = ParentActivity.somevarible; 
```

那应该工作。

# matlab - MATLAB: Reset Vector at Index

> ID：12552360
> 
> 赞同：1
> 
> 时间：2012-09-23T12:26:42.603
> 
> 标签：matlab, vector

Consider the following vectors:

```
>> signals

signals =

 1
 1
 1
 1
 0
 0
 0
 0
 1
 1
 1
 1
 0
 0
 0
 0

>>exits

exits =

 2
10 
```

What I need to do is set the 1s to 0s in the `signal` matrix from each value in exits until the value in signals changes. For example, where `exits=2`, I would set the 1s to 0s in the `signal` vector at indicies 2, 3, and 4.

What I have done so far is to identify where the values change in the `signal` vector so that I can identify the start and stop index. For example:

```
>> find(diff(signals)~=0)

ans =

 4
 8
12 
```

By doing this, I know I have to set the 1s to 0s from `exits=2` to `signals=4` and `exits=10` to `signals=12`. I am stuck however in figuring out how to do this with no loops.

I realize this may be a bit vague, so here is a simpler example:

```
>> signals

signals =

 1
 1
 1
 1
 1
 0
 0
 0
 1
 1
 1

>> exit

exit =

 3

>> rst=exit:find(diff(signals)~=0)

rst =

 3     4     5

signals =

 1
 1
 0
 0
 0
 0
 0
 0
 1
 1
 1 
```

I am basically trying to generalize this simple example to cases where there are multiple `exit` values and multiple different sequences of `signals`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:49:10.197

循环肯定会是更简单、更易读的解决方案。没有循环的方法是重建`signals`-array，保持开始并丢弃冗余`exits`。

```
signals = [
 1
 1
 1
 1
 1
 0
 0
 0
 1
 1
 1];

exit = 3;

startEnd = diff([0;signals]);

%# add the new exit
startEnd(exit) = -1;

%# remove redundant "exits"

startEndIdx = find(startEnd);

deltaEvent = diff([0;startEnd(startEndIdx)]);

deltaIsZero = deltaEvent == 0; %# these are the bad exits

startEnd(startEndIdx(deltaIsZero)) = 0;

%# now we can reconstruct the signals vector
signals = cumsum(startEnd)

signals =

     1
     1
     0
     0
     0
     0
     0
     0
     1
     1
     1 
```

# asp.net-mvc - 父子连接未接线

> ID：12552365
> 
> 赞同：1
> 
> 时间：2012-09-23T12:27:19.377
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, relational-database

我在这里通过代码优先方法创建了一个基于 EntityFramework 的数据库。该数据库包含两个表，它们之间存在父子关系：

1.  `Orderlists`（基于模型*“订单列表”*）
2.  `Orders`（基于模型*“订单”*）

其中 Orderlists 包含*`ICollection<Order> Orders`*应该 (!) 列出所有相关订单。由于某种原因，它没有。

控制器的 DbContext 包含两个 DbSet：

1.  `DbSet<Orderlist>`
2.  `DbSet<Order>`

另一方面，模型*Order有两个属性（其类型在括号中）：*

1.  `int OrderlistId`
2.  `Orderlist OrderList`

在控制器中的 [HttpPost] *Create*方法的新*Order*对象中，我通过从 DbContext 中选择适当的*Orderlist*对象（具有正确提供/选择的 ID），设置新创建的*Order的**OrderlistId*和*Orderlist*来连接此关系适当的对象并将*Order*添加到所选择的*Orderlist的**Orders*集合中（如果它为 null，则创建集合）。

 ***然后我做了一个`db.SaveChages();`它应该做的事情。

当首先从模型的代码生成数据库时，关于关系，只有*OrderlistId*属性会在数据表中生成一个字段。*Orderlist*的*Orders*集合和*Order的**Orderlist*属性都不会在表中生成字段。没关系，因为它仍然是一个有效的关系：*Orderlist*的 ID是一个 PK，并且*OrderlistId*值设置正确。数据表的方案也反映了外键的关系。

 ***现在，问题是在我的应用程序的不同点处理数据时，关系没有恢复。当我从 DbContext 中选择*Orders* ICollection时，它**始终为** *空。*

我的问题是：创建对象时是否应该自动填写**订单** ？或者我是否必须通过迭代订单来手动填写它并将每个适当的订单手动添加到其相关的订单列表中？而且，如果我必须这样做，我必须在哪里以及如何做到这一点？`ICollection``DbContext``DbSet``DbContext`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:20:21.133

Entity Framework Code First 模型中的所有关联属性都必须用*virtual*关键字标记，如果您希望 Entity Framework 按需自动加载关联实体（延迟加载）。

以下（基本）模型定义应该有效。

```
public class OrderList
{
    public int OrderListId { get; set; }

    public virtual ICollection<Order> Orders { get; set; } // note the use of virtual
}

public class Order
{
    public int OrderId { get; set; }

    public int OrderListId { get; set; }
    public virtual OrderList OrderList { get; set; } // note the use of virtual
} 
```

另外，请注意，将订单添加到订单列表时，您不必在订单实体上设置关联属性。您可以简单地将新订单添加到 OrderList 实体上的 Orders 集合中，如下所示：

```
int orderListId = 1;
OrderList orderList = context.OrderLists.Find(orderListId);

Order newOrder = new Order();
orderList.Orders.Add(newOrder);
context.SaveChanges(); 
```

或者，您可以只在新订单上设置 OrderListId 属性，并将其添加到 DbContext Orders 集合中。

```
Order order = new Order();
order.OrderListId = 1;
context.Orders.Add(order);
context.SaveChanges(); 
```******

# jquery - 使用代理的跨站点ajax不起作用

> ID：12552368
> 
> 赞同：2
> 
> 时间：2012-09-23T12:28:32.170
> 
> 标签：jquery

我正在尝试使用 tinyproxy 作为反向代理来做跨站点 ajax。这是设置：

*   一个运行gentoo linux的桌面系统。IP 地址是 xxxx Boa（Web 服务器，端口 80）和 tinyproxy（http 代理，端口 8888）正在这个系统上运行。

以下是测试文件：

======= a.html ======

```
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Ajax test</title>
  </head>
  <body>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="a.js"></script>
  </body>
</html> 
```

======= a.js ========

```
$(document).ready( function() {

    function error_func()
    {
        alert("error occurred");
    }

    function ajax_func(data)
    {
        alert("ajax received");
    }

    $.get("http://x.x.x.x:8888/outside/xyz.txt", ajax_func).error(error_func);

}); 
```

我已经配置了 tinyproxy，以便[http://xxxx:8888/outside/](http://x.x.x.x:8888/outside/)将转到[http://www.outside.com/](http://www.outside.com/)。我控制了那个域，并在那里放置了一个文本文件 xyz.txt，其中包含“测试字符串”。

现在，当我将以下 url 放入 firefox：xxxx:8888/xyz.txt 时，一切正常，我看到浏览器窗口中显示“测试字符串”。但是当我将 xxxx/a.html 放入 Firefox 时，我得到了“发生错误”对话框。我已经在 IE、Safari、Firefox 和 Chrome 上尝试过这个，我在所有这些上都得到了“发生错误”对话框。

请注意，我知道“同源政策”，这就是为什么我使用 tinyproxy 来解决这个限制。

我在 gentoo linux 机器上使用了 wireshark 来观察流量。一切看起来都很好。我看到 firefox 和 xxxx 之间的 HTTP 事务，然后我看到 xxxx 和“外部”之间的 HTTP 事务，最后是 xxxx 和 firefox 之间的另一个 HTTP 事务。HTTP 200 OK 包含预期的“测试字符串”。但是，jquery 仍然不高兴，我没有得到“收到 ajax”对话框......

我怀疑的一件事是HTTP“服务器”标头。xxxx 系统说“服务器：Boa”，但最终的响应是“服务器：Apache”。我会因为这种差异而违反相同的原产地政策吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:55:41.533

Ajax 通信必须在以下三个条件下进行：

1.  同一主机
2.  相同的协议
3.  同一个端口

因此，从技术上讲，在不同端口之间进行通信时，您不能使用 Ajax 调用，但是有一个简单的解决方案。如果您定义一个 Access-Control-Allow-Origin 标头允许您从另一个主机/协议/端口获得访问权限，则可以忽略预先声明的条件。

您必须确保允许您的网页通过正确的标头访问您的代理。

有关更多信息，我建议您阅读以下内容：[https ://developer.mozilla.org/en-US/docs/HTTP_access_control](https://developer.mozilla.org/en-US/docs/HTTP_access_control)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:52:15.373

同源策略限制访问：

*   同一主机
*   相同的协议
*   **同一个端口**

相同的来源策略也适用于您的情况，因为您尝试`x.x.x.x:8888`从`x.x.x.x:80`.

您还需要通过同一端口交付内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:58:12.567

大约一个月前，我问了几乎相同的问题。你可以在这里找到答案： [Cross protocol cookie iFrame](https://stackoverflow.com/questions/12198166/cross-protocol-cookie-iframe)

# android - cvExtractSURF cannot be processed

> ID：12552369
> 
> 赞同：1
> 
> 时间：2012-09-23T12:28:43.043
> 
> 标签：android, opencv, javacv, surf

I'm trying to create an Android app which uses JavaCV to match images by their SURF features.

I'm trying to first load an image from the Assets folder, extract SURF features for it and save them in a database. Code seems to work okay until the cvExtractSURF function is executed. Actually, I'm not sure if it executed at all. The emulator/debugger starts thinking and a few minutes later, Eclipse says it was disconnected. Same problem on a real device: just goes to Home and the code is never executed further. No error is logged to Logcat, no exception seems to be thrown, nothing.... Here is the code where this happens.

```
 package com.landmark;

import java.io.IOException;
import java.io.InputStream;
import java.nio.FloatBuffer;

import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.graphics.*;
import android.widget.Toast;
import android.content.Context;
import android.content.res.AssetManager;

import static com.googlecode.javacv.cpp.opencv_core.CvSeq;
import static com.googlecode.javacv.cpp.opencv_core.IplImage;
import static com.googlecode.javacv.cpp.opencv_core.cvGetSeqElem;

import static com.googlecode.javacv.cpp.opencv_core.*;
import static com.googlecode.javacv.cpp.opencv_features2d.*;
import static com.googlecode.javacv.cpp.opencv_highgui.*;
import static com.googlecode.javacv.cpp.opencv_imgproc.*;

public class DatabaseHelper extends SQLiteOpenHelper {
    static final String dbName = "ImageDatabase.db";
    static final String imageTableName = "ImageData";
    static final String colImageID = "ImageID";
    static final String colInfo = "ObjectInformation";
    static final String surfTableName = "SURFData";
    static final String colSURFId = "SURFID";
    static final String colDir = "Dir";
    static final String colHessian = "Hessian";
    static final String colLaplacian = "Laplacian";
    static final String colCoordX = "CoordX";
    static final String colCoordY = "CoordY";
    static final String colSize = "Size";
    static final String colRefDescriptorID = "DescriptorID";
    static final String colRefImageID = "ImageRefID";
    static final String descriptorTableName = "DescriptorData";
    static final String colDescriptorID = "DescriptorRefID";
    static final String colDescriptorValue = "DescriptorValue";

private Context currentContext = null;

public DatabaseHelper (Context context){
    super(context, dbName, null, 1);
    this.currentContext = context;
}

@Override
public void onCreate (SQLiteDatabase database){
    database.execSQL("CREATE TABLE " + imageTableName + 
            " ( " + colImageID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
            + colInfo + " TEXT );");
    database.execSQL("CREATE TABLE " + surfTableName + 
            " ( " + colSURFId + " INTEGER PRIMARY KEY AUTOINCREMENT, "
            + colDir + " REAL, "
            + colHessian + " REAL, "
            + colLaplacian + " INTEGER, "
            + colCoordX + " REAL, "
            + colCoordY + " REAL, "
            + colSize + " INTEGER, "
            + colRefDescriptorID + " INTEGER, " 
            + colRefImageID + " INTEGER, " 
            + " FOREIGN KEY (" + colRefImageID + ") REFERENCES " + imageTableName + " (" + colImageID + "));");
    database.execSQL("CREATE TABLE " + descriptorTableName +
            " ( " + colDescriptorID + " INTEGER, "
            + colDescriptorValue + " REAL, "
            + "FOREIGN KEY (" + colDescriptorID + ") REFERENCES " + surfTableName + " (" + colDescriptorID + "));");

    //image 01
    AssetManager assets = currentContext.getAssets();
    String imageFilename = "HramAlexanderNevski03.jpg";
    InputStream imageStream = null;
    try {
        imageStream = assets.open(imageFilename);
    } catch (IOException e) {
        e.printStackTrace();
    }
    Bitmap bitmapImage = BitmapFactory.decodeStream(imageStream);
    int width = bitmapImage.getWidth();
    int height = bitmapImage.getHeight();
    IplImage image = IplImage.create(width, height, IPL_DEPTH_8U, 4);
    IplImage greyImage = IplImage.create(width, height, IPL_DEPTH_8U, 1);
    bitmapImage.copyPixelsToBuffer(image.getByteBuffer());
    cvCvtColor(image, greyImage, CV_BGR2GRAY);
    CvMemStorage storage = CvMemStorage.create();

    CvSeq imageKeypoints = new CvSeq();
    CvSeq imageDescriptors = new CvSeq();
    CvSURFParams params = cvSURFParams(500, 1);

    cvExtractSURF(greyImage, null, imageKeypoints, imageDescriptors, storage, params, 0);
    //storage.release();

    database.execSQL("INSERT INTO "+ imageTableName + " VALUES (" + null + ", " 
            + "'This is the Alexander Nevski memorial'" + ");");
    for(int i=0; i<imageKeypoints.total(); i++){
        CvSURFPoint point =  new CvSURFPoint(cvGetSeqElem(imageKeypoints, i));
        database.execSQL("INSERT INTO " + surfTableName + " VALUES (" + null + ", " + point.dir() + ", "
                + point.hessian() + ", " + point.laplacian() + ", "
                + point.pt().x() + ", " + point.pt().y() + ", "
                + point.size() + ", " + null + ", " + 0 + ");");
        for (int j=0; j<imageDescriptors.total(); j++){
            int size = imageDescriptors.elem_size();
            FloatBuffer descriptors = cvGetSeqElem(imageDescriptors, j).capacity(size).asByteBuffer().asFloatBuffer();
            for (int k=0; k<descriptors.capacity(); k++){
                database.execSQL("INSERT INTO " + descriptorTableName + " VALUES ( (SELECT LAST_INSERT_ROWID() - "
                        + j + "), " + descriptors.get(k) + ");");
            }
        }
    }
}

@Override
public void onUpgrade(SQLiteDatabase database, int oldVersion, int newVersion){

}

public void onOpen(SQLiteDatabase database){
    super.onOpen(database);
}
} 
```

I searched for similar problems but I can't seem to find any.

Forgot to add that I'm using OpenCV 2.3.1 (due to some issues with newer JavaCV), JavaCV from 29.03.2012, Eclipse Indigo, Windows 7 32-bit.

I'm still a newbie with Android development so a little help would be appreciated.

# python - Python program accessible from the internet

> ID：12552382
> 
> 赞同：0
> 
> 时间：2012-09-23T12:31:56.793
> 
> 标签：python, apache, web-applications, remote-access

I am busy writing a simple program in python which takes information from the serial port and displays a graph of this to the user. (It is basically a energy meter connected to the serial port and the python program should display the voltage, current and power curves.)

However, I would really like to make this program accessible from the internet (ie: one open's a web browser on the remote computer, types in the host pc's ip address and some port and you are confronted with the voltage, current and power curves)

I am very new to python and the whole object oriented programing language. Most of my programing was done in C# in the past.

Is there a relatively easy way to 'port' a python program to some form of web accessible program/script. Possibly by using it in conjunction with a Apache server running on the host machine?

Any help with this would be much appreciated. Even if it just points me in the right direction.

Thanks so much.

**EDIT:** I have now been playing around with CGI and Apache and I see that it is possible to execute .py files in Apache as cgi-binaries. However, when I attempted to execute my complete python program (containing a Qt form and many push buttons and combo boxes) the page just kept on loading forever, until it displayed a server timeout. Is this because I am using CGI and not FastCGI? or is it not possible to 'port' Qt framework to HTML? Should I rather create a new GUI framework out of HTML code?

Thanks so much.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:57:31.627

[最简单的方法（不影响机器的安全性）是让 python 脚本读取串行数据并使用matplotlib](http://matplotlib.org/)每分钟创建几个图形，并将它们写入 Web 服务器可以找到它们的地方，例如 PNG 文件。

然后您需要创建一个网页来显示图表。为安全起见，最好将其设为引用脚本制作的 PNG 文件的静态页面。也许放入一些 javastript 让页面[定期刷新](http://www.quackit.com/javascript/javascript_refresh_page.cfm)。

最后但并非最不重要的是，您需要一个网络服务器。我建议使用[nginx](http://wiki.nginx.org/)来提供这样的静态内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:35:53.533

有很多基于 Python 的 Web 开发框架，例如 Django：[https](https://www.djangoproject.com) ://www.djangoproject.com 。您可以使用 Django 在 Python 中开发一个网站，然后从其中一个视图中调用您的脚本。您可以使用 Apache 部署您的 Django 项目：[https ://docs.djangoproject.com/en/1.2/howto/deployment/modwsgi/](https://docs.djangoproject.com/en/1.2/howto/deployment/modwsgi/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:43:19.013

最简单的解决方案似乎是 CGI [http://docs.python.org/library/cgi.html](http://docs.python.org/library/cgi.html)和 WSGI [http://docs.python.org/library/wsgiref.html](http://docs.python.org/library/wsgiref.html)

但是，在这两种情况下，我都提醒您，Web 应用程序以其安全问题而闻名。当您是初学者时，您通常会打开许多​​安全漏洞，甚至不会注意到它……但互联网上的坏人会注意到。我建议至少使用用户名/密码保护页面。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-23T13:39:49.823

如果您可以在 Google App Engine 中运行 Python，为什么还要运行和维护自己的网络服务器。它简单、免费且几乎 100% 可靠。Google 负责网络服务器，您只需构建一个 Python 应用程序。串口客户端可以将数据发送到您的 App 引擎应用程序。

这是一个帮助您入门的教程：http: [//aleatory.clientsideweb.net/2012/08/16/financial-charts-app-engine-tutorial-web-scraping/](http://aleatory.clientsideweb.net/2012/08/16/financial-charts-app-engine-tutorial-web-scraping/)

这是向 App 引擎发送数据的 Python 示例：http: [//aleatory.clientsideweb.net/2012/08/16/financial-charts-app-engine-tutorial-web-scraping/](http://aleatory.clientsideweb.net/2012/08/16/financial-charts-app-engine-tutorial-web-scraping/)

# security - Struts2 授权

> ID：12552383
> 
> 赞同：2
> 
> 时间：2012-09-23T12:32:08.190
> 
> 标签：security, tomcat, struts2, spring-security, roles

我即将从大学毕业，需要在学校实施一个 Web 应用程序，一切都运行良好，这需要在 11 月之前准备好，但我在处理安全性方面遇到了真正的麻烦。应用程序必须能够拥有具有一个或多个不同角色的不同用户（用户 1：角色：学生；用户 2：管理员，用户 3：教授、老板）。

当用户登录时，应根据其所拥有的角色将其重定向到不同的视图，然后如果他尝试访问其角色不允许的资源，则应显示错误页面。

这是我迄今为止尝试过的：

**方法一：**

身份验证方法：在 web.xml 中指定为

```
<login-config>
   <auth-method>FORM</auth-method>
   <form-login-config>
      <form-login-page>/login.jsp</form-login-page>
   </form-login-config>
</login-config> 
```

然后在自定义 jsp 上使用名称 j_username 和 j_password 以及 j_security_check。

授权方法：通过[DataSourceRealm](http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html#DataSourceRealm)使用 Container Security (Tomcat) ，它允许我们连接到数据库并从需要映射到 server.xml 的 2 个表中获取用户和与他关联的角色：

```
<Resource auth="Container" driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver" maxActive="100" maxIdle="30" maxWait="1000" name="jdbc/sstt" password="pass" type="javax.sql.DataSource" url="jdbc:sqlserver://localhost;databaseName=BDTT" username="sa"/> 
```

网页.xml：

```
<security-constraint>

    <web-resource-collection>
        <web-resource-name>Students Only</web-resource-name>
        <url-pattern>/student/*</url-pattern>
    </web-resource-collection>

    <auth-constraint>
        <role-name>student</role-name>
    </auth-constraint>

</security-constraint>

// Same mapping for professor, admin, and boss (/professor/* maps to professor role) 
```

**结果：**每当我尝试访问受限区域时，例如 /members/（在 web.xml 中的安全约束中配置）它都会完美运行，从而实现了授权目标。

**问题：** 当我提交登录表单时，它会触发 j_security_check，因此我无法触发可以帮助我**根据用户角色进行重定向**的 Struts2 Action，这是主要问题。一切都很完美，但我在使用 Container 安全登录后找不到重定向的方法。

**方法二：**

Authentication Method：一个LoginAction 类，它查询数据库并检查密码是否正确。它还检查用户角色，在这里我们应该能够返回一个像“admin”或“student”这样的字符串并重定向到适当的 index.jsp 资源，但这**只有在用户被允许只有一个角色时才有效，但是他们可以有很多**，那么**应该如何根据总用户角色构建视图**？我们会返回什么字符串？

授权方法：我编写了一个自定义拦截器，它从会话中检索用户对象（只有当用户成功验证时，此用户对象才应在会话中），然后在此处执行授权逻辑。

**问题：** 无法找到根据多个角色构建视图的方法，而拦截器的问题是它只保护我的动作，所以授权目标已经实现但仅限于动作，这意味着我可以写 /students/并且 URL 将更改为 /students/index.jsp，甚至无需尝试授权。

**其他计划**

我在想也许我可以使用过滤器来获得授权（这样我可以保护动态和静态资源）但我不知道这是否是一个好习惯，因为我们已经配置了映射到 / 的 Struts2 过滤器*

我也在寻找我可以使用**JAAS**或**Spring Security**但我不知道我是否可以实现这一点，**身份验证，基于角色的重定向和授权**。我不想再花几个小时来发现我不能做我需要的事情，而且我只有很短的时间来完成这个。

**其他问题**

把jsp放到WEB-INF下真的是个好习惯吗？如果是这样，我应该将 struts.xml 中对我的 jsp 的所有访问重写为 WEB-INF/jsp/students/index.jsp？（ 例如 ）。或者我应该坚持 web.xml 中定义的安全约束以避免直接访问 /jsp/* url 模式？

非常感谢您的所有时间和帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:29:43.157

对于方法1中的问题：你可以编写Struts2拦截器来实现你想要的。

对于 Spring Security 示例，请参阅我对这个问题的回答[https://stackoverflow.com/questions/12615354/how-to-implement-role-based-login/12629731#12629731](https://stackoverflow.com/questions/12615354/how-to-implement-role-based-login/12629731#12629731)

是的，将 jsp 放在 WEB-INF 文件夹下是一个好习惯。请参阅[为什么将 JSP 放入 WEB-INF？](https://stackoverflow.com/questions/6825907/why-put-jsp-in-web-inf)

# wordpress - Wordpress 插件开发：当用户到达主页时，使用什么钩子来显示弹出窗口？

> ID：12552387
> 
> 赞同：0
> 
> 时间：2012-09-23T12:33:32.143
> 
> 标签：wordpress, wordpress-theming

我开始开发一个相对简单的 WP 插件，它应该能够在新访客到达时在主页上显示一个弹出框。

随着开发阶段的推进，我会有更多关于同一主题的问题，但现在，我还停留在开始阶段。

我不确定我应该使用什么钩子在主页上显示这样的框（页面居中）？

我试过使用动作钩子'init'，但这会以某种方式干扰 wp_admin_bar 中的类声明。

是否有合适的**过滤器**挂钩来完成此操作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:12:36.717

您可以使用以下插件作为指南并挑选出您需要的代码片段，它似乎可以完成您正在寻找的内容。

[WP问候框](http://omninoggin.com/wordpress-plugins/wp-greet-box-wordpress-plugin/)

# javascript - IE 7 中的 Highcharts JS 没有出现

> ID：12552390
> 
> 赞同：0
> 
> 时间：2012-09-23T12:33:57.233
> 
> 标签：javascript, highcharts

在我下面的代码示例中，[Highcharts](http://www.highcharts.com/documentation/compatibility)图没有出现在 Internet Explorer 7 中。 [http://jsfiddle.net/bVGTS/](http://jsfiddle.net/bVGTS/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:16:44.450

你有一个逗号后`animation:false,`- Internet Explorer 不喜欢这样。

[这是一个更正的 JSfiddle](http://jsfiddle.net/2ryzj/)。

# java - 从构造函数传递许多参数会减慢程序的速度吗？

> ID：12552394
> 
> 赞同：1
> 
> 时间：2012-09-23T12:34:59.770
> 
> 标签：java, performance

我一直在以下列方式设计课程：

```
public class add{
      private int firstEntry;
      private int secondEntry;

      public add(int a , int b){
          this.firstEntry= a;
          this.secondEntry=b
      }

      public int makeAddition(){
          return firstEntry+secondEntry;
      }

} 
```

这种程序模式会减慢java中的程序吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T12:36:56.803

首先 - 2 个参数并不多！其次，不，它不会减慢程序的速度——你会使用什么“更快”的替代方案？

专注于设计好的、可读的代码，然后当（且仅当）你需要优化时，你可以稍后再做。设计好的、可读的代码的能力更为重要，在这个阶段，这就是你应该关注的。

如果您有大量参数（您说 15，这很多），那么可能会查看[builder pattern](http://www.oodesign.com/builder-pattern.html)。与性能无关，但是当您的构造函数中有大量参数时，这样做通常会更好，因为这意味着当有人调用它时，他们可以清楚地看到他们每次引用的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T12:38:40.503

从构造函数传递许多参数不会减慢程序的速度，它会减慢需要阅读它的程序员的速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:44:35.627

传递2个参数不是很多，它不会减慢程序的速度。作为该代码的替代方案，您可以：

```
public class add{
    public int add(int a, int b){
        return a+b;
    }
} 
```

# javascript - 我应该使用什么 jQuery 选择器来选择 div 类？

> ID：12552397
> 
> 赞同：-1
> 
> 时间：2012-09-23T12:35:21.643
> 
> 标签：javascript, jquery, jquery-selectors

```
<div id="stage-1" class="stage">
    <div class="section">
        <section>
            <h3 class="formHeader">Choose a category</h3>
            <ul id="formNav">
                <li>
                    <h4>Bathrooms, Kitchens, Bedrooms &amp; Furniture</h4>
                    <div class="js-reveal">

                    </div>
                </li>
           </ul>
       </section>
   </div> 
```

我正在尝试选择`.js-reveal`元素。我应该使用什么 jQuery 选择器来选择它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:36:12.547

使用**.（类名）**：

```
$('.js-reveal').text('Selected'); 
```

另请注意，您最后错过了您的右方括号`</div>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T05:43:09.093

尝试这个

***HTML***

```
<div id="stage-1" class="stage">
    <div class="section">
        <section>
            <h3 class="formHeader">Choose a category</h3>
            <ul id="formNav">
                <li>
                    <h4>Bathrooms, Kitchens, Bedrooms &amp; Furniture</h4>
                    <div class="js-reveal">
                            Hello world
                    </div>
                </li>
            </ul>
        </section>
    </div>
</div> 
```

***JS代码***

```
$(document).ready(function(){
     /*to get html element*/
       alert($('.js-reveal').html());
});

$(document).ready(function(){
     /*to get containing text*/
       alert($('.js-reveal').text());
}); 
```

# android - 上下文菜单项监听器

> ID：12552408
> 
> 赞同：0
> 
> 时间：2012-09-23T12:37:12.073
> 
> 标签：android

我制作了一个上下文菜单，但我无法让 itemListener 工作，因为我不能对所选标题使用 switch-case（因为它仅适用于整数，而不是字符串）。

我想在单击该项目时做一些事情。虽然我可以用（IF 语句）来做到这一点。

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_overview);
        View view=findViewById(R.id.myView);
        registerForContextMenu(view);
    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v,
            ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);

    menu.setHeaderTitle("Context Menu");  
        menu.add(0, v.getId(), 0, "Item 1");  
        menu.add(0, v.getId(), 0, "Item 2");  
    }

    @Override
    public boolean onContextItemSelected(MenuItem item) {

        switch(item.getItemId()) {
        case 0: Toast.makeText(this, "Item selected 1", Toast.LENGTH_SHORT).show();

            break;
        case 1: Toast.makeText(this, "Item selected 2", Toast.LENGTH_SHORT).show();

            break;
        default:

    }

        return true;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T12:45:16.977

您将选项的两个 ID 设置为相同的东西，所以这不起作用。该[`add()`](http://developer.android.com/reference/android/view/Menu.html#add%28int,%20int,%20int,%20java.lang.CharSequence%29)方法中的第二个参数应该是一个唯一的 ID，以允许您确定稍后单击的选项。尝试类似：

```
//Class level variables
static int OPTION_ONE = 1;
static int OPTION_TWO = 2;

//Adding the options
menu.add(0, OPTION_ONE, 0, "Item 1");  
menu.add(0, OPTION_TWO, 0, "Item 2"); 

//Determining which one was clicked
switch(item.getItemId()) {
    case OPTION_ONE: 
        Toast.makeText(this, "Item selected 1", Toast.LENGTH_SHORT).show();

        break;
    case OPTION_TWO: 
        Toast.makeText(this, "Item selected 2", Toast.LENGTH_SHORT).show();

        break;
    default: 
```

# netbeans - PHPunit 和 netbeans 调试不会在断点处停止

> ID：12552410
> 
> 赞同：1
> 
> 时间：2012-09-23T12:37:45.063
> 
> 标签：netbeans, phpunit, xdebug

我正在尝试在 netbeans 中调试一些 PHPunit 测试，但它并没有在我的断点处停止。

但是，我可以在浏览器中调试该站点，它会在我的断点处停止。

我已将文件->项目属性->运行配置->高级修改为“不打开网络浏览器”。

我使用以下脚本来启动 phpunit ：

```
export XDEBUG_CONFIG="idekey=netbeans-xdebug";
phpunit $@ 
```

可能是什么问题呢？

附言。我过去曾让它工作，但它停止工作，我不得不重新安装 xdebug。我正在使用 ubuntu 11.10

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T06:39:40.937

这通常发生在您的端口未设置为侦听 xdebug 的默认侦听器端口 9000 时。

这是有关netbeans的mac上的一些说明，但即使您正在运行Windows，它也应该可以解决问题。

[http://netbeans.org/kb/docs/php/configure-php-environment-mac-os.html](http://netbeans.org/kb/docs/php/configure-php-environment-mac-os.html)

# objective-c - UIActivityViewControllerCompletionHandler 怎么做？

> ID：12552414
> 
> 赞同：25
> 
> 时间：2012-09-23T12:38:45.657
> 
> 标签：objective-c, event-handling, cocos2d-iphone, ios6

我正在尝试使用`UIActivityViewControllerCompletionHandler` ，但我不太明白如何..

我想检测用户何时完成或关闭此**视图控制器**（`UIActivityViewController`）。

有谁知道怎么做？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-02T01:21:09.553

这是显示共享对话框并设置其完成处理程序的方法

```
NSArray *imageArray = [NSArray arrayWithObject:shareImage];

UIActivityViewController *sharing = [[UIActivityViewController alloc] initWithActivityItems:imageArray applicationActivities:nil];

[sharing setCompletionHandler:^(NSString *activityType, BOOL completed) {
    NSLog(@"completed dialog - activity: %@ - finished flag: %d", activityType, completed);
}];

[self presentViewController:sharing animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-02-13T14:03:35.543

`completionHandler`不*推荐*使用 iOS 8 ，因此您需要提供替代方案`completionWithItemsHandler`。它还允许处理您设置的扩展修改数据（例如照片扩展）。查看[文档](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIActivityViewController_Class/index.html#//apple_ref/c/tdef/UIActivityViewControllerCompletionWithItemsHandler)

```
 UIActivityViewController *activityViewController = [[UIActivityViewController alloc] initWithActivityItems:@[text, URL, image] applicationActivities:nil];
    activityViewController.excludedActivityTypes = @[UIActivityTypePrint, UIActivityTypeCopyToPasteboard, UIActivityTypeAssignToContact, UIActivityTypeAirDrop, UIActivityTypeAddToReadingList];

    // check if new API supported
    if ([activityViewController respondsToSelector:@selector(completionWithItemsHandler)]) {
        activityViewController.completionWithItemsHandler = ^(NSString *activityType, BOOL completed, NSArray *returnedItems, NSError *activityError) {
            // When completed flag is YES, user performed specific activity
        };
    } else {
        activityViewController.completionHandler = ^(NSString *activityType, BOOL completed) {
            // When completed flag is YES, user performed specific activity
        };
    } 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-09-23T18:08:08.990

```
typedef void (^UIActivityViewControllerCompletionHandler)
    (NSString *activityType, BOOL completed); 
```

完成处理程序的第二个参数告诉您用户是否关闭了控制器。如果他们解雇了控制器，`completed`将设置为`NO`。

[完成处理程序的文档](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivityViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40011976-CH1-SW6)中有更多详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-16T19:42:48.183

**斯威夫特 5：**

```
func showShareOf(url: URL, title: String) {
    let shareItems: [Any] = ["\(title)\n", url]
    let activityVC = UIActivityViewController(activityItems: shareItems, applicationActivities: nil)
    activityVC.completionWithItemsHandler = doneSharingHandler
    self.present(activityVC, animated: true, completion: nil)
}

@objc func doneSharingHandler(activityType: UIActivity.ActivityType?, completed: Bool, _ returnedItems: [Any]?, error: Error?) {
    if (!completed) { return }
    // If here, log which activity occurred
    print("Shared activity: \(activityType)")
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-09-06T04:27:27.533

对于 Swift，这个对我有用……

```
    // 配置 UIActivityViewController
    让 activityViewController = UIActivityViewController(activityItems: objectsToShare, applicationActivities: nil)
    activityViewController.excludedActivityTypes = [UIActivityTypeAirDrop,
        UIActivityTypeAddToReadingList，
        UIActivityTypeAssignToContact,
        UIActivityTypePrint,
        UIActivityTypeCopyToPasteboard]

    // 显示 UIActivityViewController
    presentViewController（activityViewController，动画：真，完成：无）

    // 定义完成处理程序
    activityViewController.completionWithItemsHandler = doneSharingHandler

...

func doneSharingHandler（activityType：String！，完成：Bool，returnItems：[AnyObject]！，错误：NSError！）{

    // 如果取消则返回
    如果（！完成）{
        返回
    }
    // 如果在这里，记录发生了哪个活动
    println("共享视频活动：\(activityType)")
}

```

# uiimageview - 按下时使 UIImageView 全屏显示

> ID：12552419
> 
> 赞同：0
> 
> 时间：2012-09-23T12:39:08.727
> 
> 标签：uiimageview

我是新手，所以请原谅我错过的任何事情

对了，我已经在一个应用程序上工作了几个星期，我已经完成了我的大部分应用程序，现在在最后一个选项卡上（5 个选项卡中）最后一个选项卡是照片库

它有 12 个 UIImageViews，我有一个较小版本的图像，我想要做的是当每一个被按下时，我希望图像全屏显示一个正确的新图像（（全尺寸一）如果这是有道理的）

到目前为止，我还没有编写任何代码，因为我完全被困在这里。

任何提示或参考都会有很大帮助

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T09:10:45.660

将这 12 个图像显示为不同 12 个按钮的背景图像。然后您可以在每次单击这些按钮时触发一个事件。确保对 UIControlStateHighlighted 和 UIControlStateNormal 使用相同的图像。

# java - 将 ZipOutputStream 写入 OutPutStream 以阻止连接

> ID：12552421
> 
> 赞同：1
> 
> 时间：2012-09-23T12:39:22.400
> 
> 标签：java, android, apache-httpcomponents

嗨，我正在开发一个 android 文件资源管理器应用程序。当请求下载一个大文件夹时，我正在压缩文件夹并使用下面的代码将其写入输出流。但是在下载文件之前，任何进一步的请求都会被阻止。可能是什么问题？我是否应该考虑将其移至线程？我已经尝试了许多变化，但似乎都没有。任何正确方向的指针将不胜感激。

```
 if(f.isDirectory()&& action.equalsIgnoreCase("download")){
        File zip=new File(file);

        entity = new EntityTemplate(new ContentProducer() {
            public void writeTo(final OutputStream outstream) throws IOException {
                action=null;
                OutputStreamWriter writer=fileop.createZipFile(file, outstream);
                writer.flush();
            }
        });response.setHeader("Content-Type", "application/zip");
        response.setHeader("Content-Disposition","attachment; filename=\"" +zip.getName()+".zip\"");
        response.setEntity(entity);
    } 
```

**createZipFile 方法：**

```
 OutputStreamWriter createZipFile(String sourceDir,OutputStream os) {
    // TODO Auto-generated method stub
    OutputStreamWriter osw=null;
        try
    {
        //wrap object of OutputStream
        osw=new OutputStreamWriter(os,"UTF-8");                     
        //create object of ZipOutputStream from OutputStream
        ZipOutputStream zout = new ZipOutputStream(os);

        //create File object from source directory
        File fileSource = new File(sourceDir);

        addDirectory(zout, fileSource);

        //close the ZipOutputStream
        zout.close();

        System.out.println("Zip file has been created!");

    }
    catch(IOException ioe)
    {
        System.out.println("IOException :" + ioe);     
    }

    return osw;

}

private static void addDirectory(ZipOutputStream zout, File fileSource) {

    //get sub-folder/files list
    File[] files = fileSource.listFiles();

    System.out.println("Adding directory " + fileSource.getName());

    for(int i=0; i < files.length; i++)
    {
        //if the file is directory, call the function recursively
        if(files[i].isDirectory())
        {
            addDirectory(zout, files[i]);
            continue;
        }

        /*
         * we are here means, its file and not directory, so
         * add it to the zip file
         */

        try
        {
            System.out.println("Adding file " + files[i].getName());

            //create byte buffer
            byte[] buffer = new byte[1024];

            //create object of FileInputStream
            FileInputStream fin = new FileInputStream(files[i]);

            zout.putNextEntry(new ZipEntry(files[i].getName()));

            /*
             * After creating entry in the zip file, actually
             * write the file.
             */
            int length;

            while((length = fin.read(buffer)) > 0)
            {
                zout.write(buffer, 0, length);
            }

            /*
             * After writing the file to ZipOutputStream, use
             *
             * void closeEntry() method of ZipOutputStream class to
             * close the current entry and position the stream to
             * write the next entry.
             */

            zout.closeEntry();

            //close the InputStream
            fin.close();

        }
        catch(IOException ioe)
        {
            System.out.println("IOException :" + ioe);                             
        }
    }
} 
```

# java - 谷歌地理编码返回 ZERO_RESULTS

> ID：12552425
> 
> 赞同：0
> 
> 时间：2012-09-23T12:39:53.580
> 
> 标签：java, google-maps-api-3, geocoding, reverse-geocoding

我正在使用谷歌地理编码 api 来获取结果，但它返回“ZERO_RESULTS”。下面是代码

```
public class GeoCode {

public static void main(String[] args) throws Exception {
    GeoCode.geocode("latlng=40.714224,-73.961452");
    }
private static final String URL = "http://maps.googleapis.com/maps/api/geocode/json";

public static void geocode(String address) throws Exception {

    URL url = new URL(URL + "?" + URLEncoder.encode(address, "UTF-8") + "&sensor=false");
    URLConnection conn = url.openConnection();
    ByteArrayOutputStream output = new ByteArrayOutputStream(1024);
    IOUtils.copy(conn.getInputStream(), output);
    output.close();

    //JSONObject json = new JSONObject(output.toString());
    System.out.println(output.toString());
}
} 
```

当我在浏览器的地址栏上手动使用地址时，它会在浏览器上显示 json 结果。但是上面的代码实际上有什么问题，它在 json 中返回“ZERO_RESULTS”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T17:13:24.177

您无需使用 URLEncoder 对地址进行编码，只需执行以下操作：

```
URL url = new URL(URL + "?" + address + "&sensor=false");
URLConnection conn = url.openConnection();
ByteArrayOutputStream output = new ByteArrayOutputStream(1024);
IOUtils.copy(conn.getInputStream(), output);
output.close();
System.out.println(output.toString()); 
```

或者更好：

```
 URL url = new URL("http://maps.googleapis.com/maps/api/geocode/json?" + address + "&sensor=false");
try {
    output = new Scanner(url.openStream()).useDelimiter("\\A").next());
} catch (java.util.NoSuchElementException e) {
    //empty result
} 
```

# java - 字节数组操作

> ID：12552428
> 
> 赞同：3
> 
> 时间：2012-09-23T12:40:05.537
> 
> 标签：java, compression, bytearray

我有一个 ~30 长度的字节数组。
我正在寻找一种方法将此数据传递给具有以下要求的多个用户：

1\. 它必须很短.. 最多大约 16 个字符。
2\. 只接受可打印的字符（只有数字或只有字母会更好）。
3.它必须是可打印的输出（保存到文件或使用套接字不是我想要的）。
4.（感谢 Tudor）我希望能够将其解码回原始数组

数组包含相当随机的数据，这使得这个问题很难破解。
我尝试了许多压缩方法，但到目前为止都没有运气。
压缩后，我可能会将数据编码为 64 进制以使输出尽可能短（除非有更好的方法）

该项目基本上是在java中，但如果有其他语言的解决方案，我很乐意在这里讨论它。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:57:36.630

您的问题（以防以后编辑）：

> 我有一个 ~30 长度的字节数组。我正在寻找一种方法将此数据传递给具有以下要求的多个用户：
> 
> 1.  它必须很短..最多大约 16 个字符。
> 2.  只有可打印的字符是可接受的（只有数字或只有字母会更好）。
> 3.  它必须是可打印的输出（保存到文件或使用套接字不是我想要的）。
> 
> 数组包含相当随机的数据，这使得这个问题很难破解。

答：假设您有一个 30 字节的数组，其中包含“随机”数据。无法将其压缩为仅由数字和拉丁字母组成的 16 个字符。

与 16 个拉丁字符相比，30 个字节的信息太多了。

但是，您可以做的是使用更大的字母表，例如 unicode 的所有可打印字符。我不知道到底有多少个字符。但甚至有一些代码点（和代码点序列）具有相同的视觉呈现。您只需要总共 256*256 = 65536 个不同的外观字符。这样，您可以将两个字节编码为一个字符，并在 16 个字母的字符串中存储多达 32 个字节。

但是请注意，该技术不涉及压缩，它只是相同原始数据的不同编码。随机数据不可压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:21:20.803

真正的随机数据将使用与解码一样多的字节进行编码（如果不是更多）。

当你压缩数据时，你利用数据中固有的非随机结构来制作更随机但更小的东西。这就是为什么压缩已经压缩的数据非常困难的原因。

在您的情况下，您似乎想要将 30 * 8 位或 240 位编码为 16 * 6 位或 96 位。这意味着您的数据不能非常随机地压缩至少 2.5 次。每次都压缩这么多是非常困难的，而且你总是有可能你的压缩字符串会比你开始时更大。您所能做的就是使这种情况不太可能发生。

除非您的数据不具有固有的可压缩性，否则您不能使用无损压缩（这是可逆的） 如果有损压缩是一种选择，您仍然必须对可能丢失的信息做出假设。

* * *

如果您需要将代码与某些信息匹配，您可以做的是生成一个随机唯一代码并将其用作某个数据库的密钥。使用这种方法的好处是密钥可以任意短，前提是您永远不需要比您生成的更多的唯一密钥，并且您也可以将尽可能多的信息与密钥关联起来。

鉴于您的限制，我相信这是您的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T12:45:13.093

对不起，我真的不能很好地理解你的问题。您有 30 个二进制字节，并且您想将它们编码为长度小于 16 字节的可打印字符串？如果是的话，我只想说这是不可能的......但也许我只是不明白这个问题......

如果这 30 个字节可以包含所有 255 个可能的值，那么在所有可能的情况下都无法将它们压缩到 16 个字节。那不是Java问题，只是数学问题。相反，如果您的字节只能具有值的子集，那么也许您可以做一些事情，具体取决于子集需要多少位。要从 30 个字节减少到 16 个字节，如果您希望将随机的字节序列存储在数组中，则每个字节最多可以处理 4 位，这意味着 16 个字符的子集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T13:00:48.773

我确实相信一个字符是 1 个或 2 个字节，这意味着：16 个字符 = 16-32 个字节。一种解决方案可能是定义自己的字母表，如果您可以将字符限制为仅按字母顺序排列，则每个字节只需要 5 位（26 个字母），因此每 5 个字节可以存储 8 个字母。将您的字符转换为您自己的规范，当您解码时，您只需每 5 位拆分一次。

# c# - 根据另一列的值对数据表中的列求和

> ID：12552433
> 
> 赞同：1
> 
> 时间：2012-09-23T12:42:05.440
> 
> 标签：c#, sql

我有一个数据库表，我将其用作报告的来源。表格布局看起来像。表 1 是一个更大的数据库表的子集。但是对于报告我只需要某些列所以我正在使用下面给出的函数创建一个新的数据表

```
Value  Description   Hours
    1          A           2
    2          B           3
    3          C           5
    1          A           3
    2          B           4
    2          B           3
    3          C           3

private DataTable CreateFocusOfEffortData()
    {
        var dtChartData = new DataTable();
        dtChartData.Columns.Add("Description", typeof(string));
        dtChartData.Columns.Add("Hours", typeof(Double));
        var myDataView = ReportData.DefaultView;
        myDataView.RowFilter = "ActivityUnitID = " + _ActivityUnitID;
        for (var i = 0; i < myDataView.ToTable().Rows.Count; i++)
        {
            var dataRow = new Object[dtChartData.Columns.Count];
            dataRow[0] = ReportData.Rows[i]["Description"];
            dataRow[1] = csaConvert.ToDouble(ReportData.Rows[i]["Hours"]);
            dataRow[2] = ReportData.Rows[i]["Value"];
            dtChartData.Rows.Add(dataRow);
        }
        return dtChartData;
    } 
```

现在我需要用上表中的汇总数据设计另一个报告。此表应基于 Column["Value] 组合所有列的数据。例如，在我的情况下，我们在 Value 列 1、2、3 中有三个不同的值。结果表应该对所有三个值进行小时总和。

```
 Value   Description  Hours
    1         A           5
    2         B           10
    3         C           8 
```

现在我可以通过创建另一个存储过程在 sql 中执行此操作，但我宁愿使用我现有的数据表并编写一个 C# 函数来获取结果。有没有更简单的方法可以使用 LINQ 实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T12:51:27.663

你采取了错误的方法。在 SQL 中完成这项工作。

```
 SELECT value, description, sum(hours) as hours from tblData group by value, description; 
```

以上将为您提供您在问题中显示的第二个表格。

这样做的原因是，将数据传递给客户端应用程序只是为了将其直接传递回 SQL 会不必要地消耗内存和系统调用。此外，错误、错误、类型转换问题等的空间要小得多。

如果您真的想制作更窄的表格（这通常是一个坏主意），请这样做：

```
 SELECT value, description, hours from tblData into tblSkinnyData; 
```

一般来说，如果您出于某种原因需要这个瘦表，您会在主表上使用 VIEW。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T12:49:55.473

您可以使用`AsEnumerable()`in order 使用 LINQ，然后`GroupBy`通过`Value`and`Description`和 do `Sum`on`Hours`为第一行设置：

```
var result = dtChartData.AsEnumerable()
            .GroupBy(row => new
                {
                    Value = row.Field<int>("Value"),
                    Description = row.Field<string>("Description")
                })
            .Select(g =>
                {
                    var row = g.First();
                    row.SetField("Hours", g.Sum(r => r.Field<double>("Hours")));

                    return row;
                }); 
```

结果将返回`IEnumerable<DataRow>`，但如果您想`DataTable`返回，请使用：

```
var resultTable = result.CopyToDataTable(); 
```

# java - HQL 限制查询中的异常

> ID：12552434
> 
> 赞同：1
> 
> 时间：2012-09-23T12:42:11.987
> 
> 标签：java, spring, hibernate, dao

我需要检索表 phone_numbers 的前 n 条记录，其中 POJO PhoneNumbers 存在相应的 PhoneNumbersDAO 和 PhoneNumbersDAOImpl。我试过这个：

```
public List<PhoneNumbers> getNPhoneNumbersFromMthRow(int m, int n){
    Query query= getSession().createQuery("from PhoneNumbers");
    query.setFirstResult(m);
    query.setMaxResults(n);
    List<PhoneNumbers> lstPhoneNumbers = (List<PhoneNumbers>) query.list();
    return lstPhoneNumbers; 
} 
```

但是，这会引发空指针异常：

```
Exception in thread "main" java.lang.NullPointerException
at org.springframework.orm.hibernate3.support.HibernateDaoSupport.getSession(HibernateDaoSupport.java:143)
at com.pw.dao.PhoneNumbersDAOImpl.getNPhoneNumbersFromMthRow(PhoneNumbersDAOImpl.java:108)
at com.pw.ml.Test1.main(Test1.java:18) 
```

错误出现在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:34:53.307

这与您的 HQL 无关，您是否为您的 DAO 设置了休眠模板或会话工厂？根据[HibernateDaoSupport 来源](http://www.koders.com/java/fid15997C9E79ECD3145CAAC25AE0B05A2BCAD0863C.aspx)，您错过了一个。

# java - 我的 Java 代码有什么问题？

> ID：12552440
> 
> 赞同：0
> 
> 时间：2012-09-23T12:43:11.330
> 
> 标签：java, awt

我正在展示我的代码；我在单击提交按钮时显示输出时遇到问题。起初，我无法在我的内部类中使用本地变量，但是当我搜索时有人说使用`final`它。我做到了，但仍然没有得到任何输出，这是这个按钮后面的简单公式。

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import javax.swing.JOptionPane;

public class FtoC {

    public static void main(String[] args) {
        Frame frm = new Frame();
        Label lb = new Label("Calculater");
        frm.setSize(500, 300);
        frm.setVisible(true);
        frm.addWindowListener(new WindowAdapter() {

            public void windowClosing(WindowEvent e) {
                System.exit(0);
            }
        });

        Panel obj = new Panel();
        Panel obj2 = new Panel();
        Label F = new Label("F");
        final TextField Ft = new TextField(10);
        Label C = new Label("C");
        TextField Ftc = new TextField(10);
        obj.setLayout(new GridLayout(1, 1));
        obj.add(F);
        obj.add(Ft);
        obj.add(C);
        obj.add(Ftc);
        final String sFt = Ft.getText();
        Button submit = new Button("Calculate");
        submit.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {

                double Ftn = Double.parseDouble(sFt);
                double result = (Ftn - 32) * 5 / 9;
                //System.out.println(Ft);
                JOptionPane.showMessageDialog(null, result);
            }
        });

        obj.add(submit);
        obj2.add(obj);
        frm.add(obj2, BorderLayout.NORTH);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:50:30.503

```
final String sFt=Ft.getText(); 
```

这里的问题是您在用户输入任何文本之前从字段中分配值。

在触发动作事件时，从字段中获取文本，而不是使字符串成为最终的。

虽然我希望这是一个测试程序，但我建议您应该为自己创建一个自定义面板（从 JPanel 扩展的类），使表单元素成为私有成员。在那里，您将大大简化您的设计并减少您的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:46:35.890

您不希望`Ft`在构建后立即获得小部件的价值，不是吗？您想要，单击按钮时会出现什么，对吗？所以，移动

```
String sFt=Ft.getText() 
```

进入动作监听器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T12:59:09.583

此外，`pack()`您的框架和电话`setVisible()` *last*：

```
public static void main(String[] args) {
    ...
    frm.add(obj2, BorderLayout.NORTH);
    frm.pack();
    // frm.setSize(500, 300); // optional
    frm.setVisible(true);
} 
```

# .net - 手动创建临时证书

> ID：12552442
> 
> 赞同：4
> 
> 时间：2012-09-23T12:43:45.607
> 
> 标签：.net, windows-8, certificate, microsoft-metro

我想通过命令提示符创建一个临时证书（构建 Metro 应用程序所需）。我曾尝试用 CMD 做到这一点：

```
makecert.exe -n "CN=MY_DOMAIN" -r -a sha1 -sv MY_DOMAIN.pvk MY_DOMAIN.cer –ss root

pvk2pfx -pvk MY_DOMAIN.pvk -spc MY_DOMAIN.cer -pfx MY_DOMAIN.pfx 
```

但是当我在我的项目中使用这个 pfx 文件时，出现以下错误：

> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\AppxPackage\Microsoft.AppXPackage.Targets(1142,9)：错误：APPX0107：指定的证书对签名无效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T12:45:58.273

三个变化：

1.  证书在增强型密钥使用扩展中缺少代码签名 OID (1.3.6.1.5.5.7.3.3)。使用`-eku 1.3.6.1.5.5.7.3.3`参数将其添加到`makecert`.
2.  通过替换将证书放入`My`证书存储区而不是根证书存储区`-ss root`中`-ss My`。
3.  `-cy end`使用makecert的参数确保证书是基本约束扩展中的最终实体。

有关签署 Windows 应用商店应用程序的更多信息，请参阅 MSDN[签署应用程序包（Windows 应用商店应用程序）](http://msdn.microsoft.com/en-us/library/windows/apps/br230260%28v=vs.110%29) ，有关 makecert 参数的更多信息，请[参阅 MakeCert 。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa386968%28v=vs.85%29.aspx)

# java - 在android中拖放listview

> ID：12552454
> 
> 赞同：0
> 
> 时间：2012-09-23T12:45:44.627
> 
> 标签：java, android

我在我的 Listview 中使用 CursorAdapter 将数据直接映射到数据库。我的问题是当我创建拖放列表视图时。如何在Listview中拖放项目以在android中重新排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T18:22:49.017

Android SDK 中没有重新排序 ListView 的默认实现。这是我们在应用程序中使用的实现。github页面上有如何使用它的示例。

[https://github.com/terlici/DragNDropList](https://github.com/terlici/DragNDropList)

# php - 如何用php回显图像

> ID：12552457
> 
> 赞同：3
> 
> 时间：2012-09-23T12:46:22.970
> 
> 标签：php, wordpress, echo, image

我正在尝试从我的“_images”文件夹中回显图像，但如果我编写以下代码，它仅适用于我的网站：

```
echo '<img src="http://mywebsite.com/mytheme/wp-content/themes/my theme/_images/project3image1.jpg">'; 
```

我已经把它改成了这样，所以当其他人使用我的主题时，它会将他们带到他们自己的网站目录：

```
echo '<img src="<?php bloginfo('stylesheet_directory'); ?>/_images/project3image1.jpg">'; 
```

但是，当我放置并预览我的网站时，这段代码一定有问题，它给了我这个错误：

```
Parse error: syntax error, unexpected T_STRING, expecting ',' or ';' in /home/content/32/9825632/html/bomb/wp-content/themes/bomb/header.php on line 101 
```

我是一个 php 菜鸟，所以这可能是一个明显的错误！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T12:48:12.127

您已经在 php / echoing 中，因此您不需要使用 php 标签：

```
echo '<img src="' . bloginfo('stylesheet_directory') . '/_images/project3image1.jpg">'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T12:49:52.937

不要将标记与代码混合。你在自找麻烦，这一切都失去了可读性。像这样使用`printf`：

```
printf( '<img src="%s/_images/project3image1.jpg">', bloginfo('stylesheet_directory')); 
```

但你真正的问题是嵌套引号。如果您使用`'`分隔字符串边界，例如：

```
'foo' 
```

那么如果**字符串内容**也包含`'`：

```
'foo'bar' 
```

它必须像这样逃脱：

```
'foo\'bar' 
```

否则，您的内容引号将被视为字符串的右引号。或者您可以`"`改用：

```
"foo'bar" 
```

但同样 - 如果您的字符串内容包含`"`，则必须对其进行转义：

```
"foo\"bar" 
```

如果 string 包含两者`"`，`'`那么您只需要转义作为字符串分隔符的那个，即：

```
'foo"bar\'foo' 
```

或者

```
"foo'bar\"foo" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:15:08.193

要使用第二种风格的代码，您必须首先关闭 php 标签：

```
 //...your php code before echoing the img

    //here you close the tag 
    ?>

    <img src="<?=bloginfo('stylesheet_directory')?>/_images/project3image1.jpg" />

    <?php //here you open it again

    //your rest php code... 
```

如果您想在您的 php 代码中的任何位置回显一些 html，只需关闭 php 标签，编写您的 html 并再次打开 php 标签。但最好不要大量混合html和php。尝试在文件开头编写所有 php 代码，然后编写所有 html。在您的 php 代码中使用动态值创建变量，并在 html 中注入 php 代码以将它们输出到任何属性或标记内容中。

# java - MyEclipse 不突出匹配元素

> ID：12552458
> 
> 赞同：1
> 
> 时间：2012-09-23T12:46:24.113
> 
> 标签：java, eclipse, myeclipse

我正在`MyEclipse`用于开发项目。我使用了具有不同颜色的突出显示匹配元素的一个很好的功能，但现在它没有这样做，我在窗口`MyEclipse`中找不到任何设置。`Preferences`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:45:10.107

试试快捷键`Alt`++ 。`Shift``O`

# sql - 使用新的 id 值从另一个表中复制数据

> ID：12552462
> 
> 赞同：2
> 
> 时间：2012-09-23T12:46:35.190
> 
> 标签：sql

我有一个问题：我有 3 个表`Table A`，`Table B`和`Table C`。

`Table A`是主表，其 id 列使用`Table B`和进行 FK 键控`Table C`。

我想从每个表中复制相同的数据，并将这些复制的行插入到它自己的表中，新的 id 为`table A`.

我们通常做

```
insert into table A (id, name, age) 
   select name, age from table A 
```

在这里，新行得到一个新的 id，因为`id`列是自动递增的。

但是当我们将 的数据复制`Table B`到`Table B`自身时，我们如何从`Table A`???指定新的 id 这里是 FK 键控。

```
insert into table B (tab_B_Id, id, mark, subject) 
    select id, mark, subject 
    from tab B.

[id is the pk of `Table A` and FK to `Table B` and `Table C`] 
```

1.  如何将新创建的 id 值从表 A 插入到其他表？
2.  有什么方法可以在不指定两个选择子句中的所有列名的情况下做到这一点？？？

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:51:59.923

1.  在 SQL Server 中，您可以[`scope identity`](http://msdn.microsoft.com/en-us/library/ms190315.aspx)获取插入的 ID。或者，您可以[`OUTPUT`](http://msdn.microsoft.com/en-us/library/ms177564.aspx)在语句中使用子句`INSERT`。

2.  如果您要获取所有列，则无需指定它们，否则您需要。请注意，明确指定列是一种很好的做法。如果添加新列，您不希望旧代码的行为有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:25:02.960

对于问题1，这个怎么样：

```
insert into table B (tab_B_Id, mark, subject) select mark, subject from tab B 
```

然后

```
insert into table B(id) where tab_B_Id="THE ID VALUE THAT YOU GENERATED EARLIER" select id from table A 
```

虽然我没有测试代码。可能有一些语法错误。我不太明白你的问题2。

# linux - 递归删除文件和文件夹

> ID：12552463
> 
> 赞同：0
> 
> 时间：2012-09-23T12:46:42.517
> 
> 标签：linux, bash, shell

我有很多文件和文件夹。他们有这样的语法路径

/opt/logs/qnap/[hosta,hostb]/2012/03/12

## Qnap 数据存储上的所有日志文件，并且位于另一个位置。因此，当我想删除超过 180 天的文件和文件夹时，我无法使用 find 命令导致运行缓慢。所以我写了一个这样的脚本。

```
SixMonthAgo=$(date --date='190 day ago' "+%Y/%m/%d/%H")  = 2011/06/12/12
Hosts="hosta hostb"
maxDay=181
qnapFolder="/opt/logs/qnap"

for host in $(echo "${Hosts}"); do
        maxDayAgo=$(date --date="${maxDay} day ago" "+%Y/%m/%d")
        countCharacters=$(echo ${maxDayAgo} | wc -c)
        if [ ${countCharacters} -ge 10 ]; then
                rm -rf ${qnapFolder}/${host}/${maxDayAgo} #output of this just like 2012/03/12
        fi
done 
```

* * *

但有时我得到一个错误。这个解决方案不能正常工作，我想要的。我想在 180 天之前删除所有文件和文件夹。我怎样才能做到这一点 ？例如，必须在 2012/03/23 之前删除所有文件和目录。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:50:10.343

find 命令很慢？你确定吗？唯一的缺点是它无法删除目录结构。

`find /opt/logs/qnap -type f -mtime +180 -delete`

如果确实同时创建了目录，那么删除`-type f`可能对您有用。

`find /opt/logs/qnap -mtime +180 -delete`

find 很快就会提醒你......但如果你真的想用 shell 脚本来做......

```
CUTOFF=$(date --date='190 day ago' "+%s)
HOSTS="hosta hostb"
DIRECTORY="/opt/logs/qnap"

for HOST in $(ls -1 $DIRECTORY); do
    if [ -d $DIRECTORY$HOST ]; then
        for DATE in $(ls -1 $DIRECTORY$HOST); do
            if [ -d $DIRECTORY$HOST$DATE ]; then
                if [ "$CUTOFF" < "$(stat --format="%Y" $DIRECTORY$HOST$DATE)" ]; then
                    echo "Deleting $DIRECTORY$HOST$DATE"
                    rm -rf $DIRECTORY$HOST$DATE;
                fi
            fi
        done
    fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T15:02:23.030

我找到了解决方案，如下所示。例如，假设 180 天前的那一天是 2012/04/17 。这只会删除从 2012/04/17 到 2012/04/01 的所有目录。其次，它会在 2012/04 之前的每个月删除。删除的是 2012/03、2012/02 和 2012/01。

```
# SixMonthAgo=$(date --date='190 day ago' "+%Y/%m/%d/%H")  = 2011/06/12/12
maxDay=104
qnapFolder="/opt/logs/qnap"
for host in $(echo "${Hosts}"); do
    maxDayAgo=$(date --date="${maxDay} day ago" "+%Y/%m/%d")
    countCharacters=$(echo ${maxDayAgo} | wc -c)
    if [ ${countCharacters} -ge 10 ]; then
        year=$(echo ${maxDayAgo} |cut -d '/' -f 1)
        month=$(echo ${maxDayAgo} |cut -d '/' -f 2) #2012/06
        day=$(echo ${maxDayAgo} |cut -d '/' -f 3) #2012/06/04

        minday=00
        minmonth=00
        until [ $month -le $minmonth ]
        do
            until [ $day -le $minday ]
            do
                rm -rf ${qnapFolder}/${host}/2012/$month/$day
                    day=$(printf "%02d" $(expr $day - 01)) 

            done        

                    month=$(printf "%02d" $(expr $month - 01))
            rm -rf ${qnapFolder}/${host}/2012/$month
        done
    fi
done 
```

谢谢

# objective-c - 从 NSString 中提取字符串

> ID：12552475
> 
> 赞同：-3
> 
> 时间：2012-09-23T12:48:49.320
> 
> 标签：objective-c, cocoa, nsstring

```
NSString *str = [NSString stringWithString:@"The dog ate the cat"]; 
```

如何从上面以“at”开头的字符串中提取单词。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T12:55:29.413

```
NSArray *words = [str componentsSeparatedByString:@" "];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF BEGINSWITH %@", @"at"];
NSArray *wordsStartingWithAt = [words filteredArrayUsingPredicate:predicate]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T12:58:45.623

您需要使用[NSRegularExpression](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)类。

```
NSString *str = @"The dog ate the cat";
NSError *error = NULL;
NSRegularExpression *regex = [NSRegularExpression
                              regularExpressionWithPattern:@"(at\\w+)"
                              options:NSRegularExpressionCaseInsensitive
                              error:&error];
[regex enumerateMatchesInString:str options:0
                          range:NSMakeRange(0, str.length)
                     usingBlock:^(NSTextCheckingResult *match, NSMatchingFlags flags, BOOL *stop)
{
    NSString *result = [str substringWithRange:match.range];
    NSLog(@"%@", result);
}]; 
```

# c# - 如何将其与正则表达式匹配？C＃

> ID：12552476
> 
> 赞同：0
> 
> 时间：2012-09-23T12:48:49.350
> 
> 标签：c#, .net

我想匹配两个字符串之间的正则表达式。

输入文本是这样的：

```
 Back to previous › 

             › Send Message 

                             › Add as Buddy 
             › Add as Favorite 
             › Block this Person 

         People who like this (click to upvote) 
```

我想匹配**Back to previous >**和**People who like this (click to upvote)**之间的所有内容。

我尝试了最简单的正则表达式，`(?<=\ Back\ to\ previous\ ›\ ).*(?=People\ who\ like\ this\ profile\ \(click\ to\ upvote\)\ )`但没有运气。

想法是捕获 2 行\字符串之间的所有内容，即使您捕获的是换行符、制表符、字母数字等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:07:18.487

试试这个正则表达式：

**(?<=Back\sto\sprevious.*?›).?(?(?=People\swho\slike\sthis)**

```
string Input = @"Back to previous › 

         › Send Message 

                         › Add as Buddy 
         › Add as Favorite 
         › Block this Person 

     People who like this (click to upvote) ";
        foreach (Match M in Regex.Matches(Input, @"(?<=Back\sto\sprevious.*?›).*?(?=People\swho\slike\sthis)", RegexOptions.IgnoreCase | RegexOptions.Singleline))
        {
            MessageBox.Show(M.Value.Trim());
        } 
```

这将在消息框中显示以下内容：

```
› Send Message 

                         › Add as Buddy 

         › Add as Favorite 

         › Block this Person 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T12:56:59.590

如果您确定在不同的行上有字符串分隔符（例如“返回上一个”），那么您没有理由使用正则表达式：

```
string text = /* Get Text */;
string lines = text.Split();
IEnumerable<string> content = lines.Skip(1).Take(lines.length - 2); 
```

或者：

```
const string matchStart = "Back to previous >";
const string matchEnd = "People who like this (click to upvote)"
int beginIndex = text.IndexOf(matchStart) + matchStart.Length;
int endIndex = text.IndexOf(matchEnd);
string content = text.Substring(beginIndex, endIndex - beginIndex); 
```

（我发布的代码未经测试，但它应该可以工作）

# visual-studio-2012 - 如何在 vs 2012 中设置 /clr:nostdlib

> ID：12552479
> 
> 赞同：1
> 
> 时间：2012-09-23T12:49:18.413
> 
> 标签：visual-studio-2012, compiler-options, mscorlib

我正在尝试在我的 vs 2012 c# 项目中添加 /clr:nostdlib，因为我想使用 dotnet 4.0 的 System.Core，如[http://connect.microsoft.com/VisualStudio/feedback/details/750762/problems-中所述安装后构建-vs-2012-rc](http://connect.microsoft.com/VisualStudio/feedback/details/750762/problems-building-after-installing-vs-2012-rc)

现在我在 vs 2012 中收到“错误 1 ​​预定义类型‘System.Object’未定义或导入”错误。谁能告诉我如何一步一步地做到这一点。

# performance - erlang vs jvm（scala）递归性能

> ID：12552483
> 
> 赞同：5
> 
> 时间：2012-09-23T12:49:50.977
> 
> 标签：performance, scala, recursion, erlang, jvm

作为学习 scala 和函数式编程的练习，我实现了以下非尾递归 def 来计算任何位置的[帕斯卡数](http://en.wikipedia.org/wiki/Pascal%27s_triangle)。程序本身作为帕斯卡三角形的定义。如下图所示

```
 1
    1  1
   1  2  1
  1 3   3 1
 1 4  6  4 1
1 5 10 10 5 1
...

def pascal(c: Int, r: Int): Int =
  if (c == 0 || c == r) 1 else pascal(c - 1, r - 1) + pascal(c, r - 1) 
```

但是，当尝试在 Mac OS X 10.6.8 (2.53 GHz Intel Core 2 Duo) 上运行时，它在**20 min**`pascal(25,50)`后仍然没有完成运行。

 **只是为了和erlang比较，我安装了R15B02并编写了等效程序如下：

```
-module(pascal).
-export([calc_pascal/2]).

calc_pascal(0,_) -> 1;
calc_pascal(C,R) when C==R -> 1;
calc_pascal(C,R) when C<R  -> calc_pascal(C-1,R-1) + calc_pascal(C-1,R). 
```

`pascal:calc_pascal(25,50)`在**~4sec**内完成。

为什么可能是造成如此巨大的性能差异的原因？对于递归程序，jvm 是否不如 erlang 运行时先进？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-23T13:10:46.407

如果我在 Scala 程序中犯了与您在 Erlang 版本中相同的错误，它会运行得非常快。这可能是原因吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T14:49:59.217

帕斯卡的数字表现（以毫秒为单位）

```
c,r     Scala   Erlang
10,20   21      22
11,22   6       72
12,24   16      272
13,26   71      1034
14,28   299     3982
15,30   802     16124
16,32   3885    60420 
```**

# android - 如何构建基于 webview 的应用程序 Android

> ID：12552487
> 
> 赞同：0
> 
> 时间：2012-09-23T12:50:07.587
> 
> 标签：android, eclipse, web-applications, webview, avd

我想用Android构建一个原生webApplication，当我运行代码时，我的默认avd告诉我我的应用程序崩溃了......

我在 Google Android 文档上遵循本教程：http: [//developer.android.com/guide/webapps/webview.html](http://developer.android.com/guide/webapps/webview.html) 这是我的 java android 代码：

```
package com.example.mobilewebview;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.webkit.WebView;
//import android.webkit.WebSettings;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        WebView myWebView = (WebView) findViewById(R.id.webview);
        myWebView.loadUrl("http://www.google.com");
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:51:12.223

移动

```
setContentView(R.layout.activity_main); 
```

紧随其后：

```
super.onCreate(savedInstanceState); 
```

您收到错误是因为 findViewById() 在当前使用的布局中查找视图。当您尝试在其中找到视图后设置布局时，您遇到了错误。

# sql-server - 子查询返回多个结果错误

> ID：12552489
> 
> 赞同：1
> 
> 时间：2012-09-23T12:50:10.737
> 
> 标签：sql-server

我正在将基于 MSAccess 的应用程序（+VB 代码）转换为 Web 应用程序。数据库在这个过程中保持不变，这个访问应用程序使用了少数存储过程。

下面的代码执行一个存储过程。

```
Dim prmJ_YearSeq_pk As ADODB.Parameter
Set cmd1 = New ADODB.Command
cmd1.ActiveConnection = CurrentProject.Connection
cmd1.CommandType = adCmdStoredProc
cmd1.CommandText = "sp_delete_from_t_Job_and_t_Report"
Set prmJ_YearSeq_pk = 
    cmd1.CreateParameter("@J_YearSeq_pk", adInteger, adParamInput)
cmd1.Parameters.Append prmJ_YearSeq_pk
prmJ_YearSeq_pk.Value = Me.J_YearSeq_pk
cmd1.Execute 
```

现在从 SQL Management Studio 执行相同的存储过程

```
DECLARE @return_value int
EXEC    @return_value = [dbo].[sp_delete_from_t_Job_and_t_Report]
        @J_YearSeq_pk = 20110001
SELECT  'Return Value' = @return_value 
```

它抛出一个错误

> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。该语句已终止。

我不明白的是，为什么它在 Access 应用程序中工作得很好，但在 Management Studio 或我的 Web 应用程序（PHP PDO）中却不行？

# c# - XNA 4.0 中的 2D BoundingRectangle 旋转

> ID：12552490
> 
> 赞同：1
> 
> 时间：2012-09-23T12:50:21.593
> 
> 标签：c#, xna, rotation, xna-4.0, bounding-box

我无法确定我需要做什么才能让我的游戏中的精灵对象旋转和更新位置的 2D BoundingRectangle，具体取决于用户希望精灵旅行的方式。

我用它的旋转和缩放值画出精灵，如下所示：

```
spriteBatch.Draw(texture, position, null, Color.White, rotation, origin, scale, SpriteEffects.None, 1f); 
```

我目前获取 BoundingRectangle 的设置是：

```
public Rectangle BoundingRectangle
{
    get { return new Rectangle((int)position.X, (int)position.Y, texture.Width, texture.Height); }
} 
```

以上是非常基本的，显然不会随着精灵旋转。我已经阅读了一些 QA 帖子并尝试了各种方法，但它们似乎都没有达到我所追求的目标或产生非常奇怪的行为。

对于我需要做的一些建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T13:04:56.913

Rectangle 类不包含旋转信息，因此您需要一些结构来包含它。

一个不错的选择是返回一个包含四个点的列表，这些点基于您现在返回的矩形以及应用到它的旋转。

[您可以使用Matrix 类](http://msdn.microsoft.com/en-us/library/bb197911.aspx)对一组点应用旋转，如下所示：

```
var m = Matrix.CreateRotationZ(angle);
Vector3 rotatedVector = Vector3.Transform(vector, m); 
```

如果你想围绕某个点旋转，比如说你的精灵的中心，还应该进行平移：

```
var rotation = Matrix.CreateRotationZ(angle);
var translateTo = Matrix.CreateTranslation(vector);
var translateBack = Matrix.CreateTranslation(-vector);
var comnbined = translateTo * rotation * translateBack;
Vector3 rotatedVector = Vector3.Transform(vectorToRotate, combined); 
```

请务必查看可以使用矩阵完成的所有其他转换，矩阵是游戏/图形开发中的核心元素。

# iphone - iPhone - 如何关闭屏幕并保持视频播放？

> ID：12552492
> 
> 赞同：1
> 
> 时间：2012-09-23T12:50:56.623
> 
> 标签：iphone, objective-c, ios, xcode, ios6

我在我的 iPhone 应用程序中运行了一个 youtube 视频....我怎样才能让它到用户可以点击锁定按钮但仍然能够收听视频但看不到它的位置？

所以基本上你有一个 Youtube 视频在我的 iPhone 应用程序中播放。用户如何在转动屏幕的同时又不让音频消失？

如果可以的话，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:01:15.350

您可以通过搜索“实现长时间运行的后台任务”在 Apple 的开发人员文档中找到答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:02:03.733

如果您的设备没有越狱，这是不可能的。由于严格的规定，Apple 不允许应用程序开发人员发布此类应用程序。您可以在[此处查看 Apple 的人机界面指南](http://developer.apple.com/library/ios/DOCUMENTATION/UserExperience/Conceptual/MobileHIG/MobileHIG.pdf)

如果您的设备已越狱，那么 cydia 可能会为此进行一些调整。

# embedded-linux - 启动后busybox启动初始化脚本

> ID：12552494
> 
> 赞同：2
> 
> 时间：2012-09-23T12:51:14.733
> 
> 标签：embedded-linux, init, busybox, pppd, runlevel

我正在使用busybox 运行嵌入式Linux 设备。启动后我想启动 ppp 连接并做其他事情。我想在其他一切都完成并且系统启动时运行它。

我的 inittab 看起来像：

```
::sysinit:/bin/sh /etc/rc.d/rc.sysinit
::once:/bin/sh /flash/scripts/init.sh
::respawn:/sbin/getty -L ttyS0 115200 vt100 
```

脚本被执行并且 pppd 开始但它失败了。如果我在启动后手动运行命令，则完全没有问题。所以我想也许它的运行级别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T15:21:58.267

最有可能的是，您的 ppp 守护程序依赖于在 rc.sysinit 中启动的某些内容，并且它会在该依赖项完成加载之前尝试启动。接受锯末的建议 - 在其他所有操作完成后，从 rc.sysinit 启动您的 init.sh 脚本 (ppp)。

# javascript - 基本 Javascript + PHP Ajax 文件上传

> ID：12552497
> 
> 赞同：3
> 
> 时间：2012-09-23T12:51:46.450
> 
> 标签：javascript, ajax, html, file-upload

尽管 StackOverflow.com 上有很多关于 AJAX 文件上传的文章，但我没有找到一个完整的纯 JavaScript AJAX 上传器。

其中许多涉及JQuery，另一种是基于asp.net的，另一种说，由于安全问题，无法上传纯JavaScript的AJAX文件。

我也搜索了互联网，但似乎很难找到一个完整且干净的 JavaScript AJAX 示例，在服务器端使用 PHP 脚本。

请问，能否为我提供尽可能简单但功能强大且干净的 JavaScript AJAX 文件上传？我不希望包含拖放功能，但可以使用以下技术：

*   **HTML5**
*   **JavaScript 但没有 JQuery**
*   **PHP**
*   **type="file" 输入文件**
*   **请不要演示**，我只希望有一个我可以自己进一步修改的代码

也许，您甚至可以在 StackOverflow.com 上找到正确的示例。如果是，那么我也为没有找到它而道歉。但是，我确实做了功课并进行了搜索。谢谢你。

* * *

Alexander 刚刚指出这个问题不好，因为它要求提供代码示例。好吧，由于解释错误，我希望最后一个想法是关闭这个问题。

如果您愿意，请为我提供有关此主题的教程，或告诉我有关包含答案的书。我正在编写我的应用程序，我还没有用任何库污染它，也没有 JQuery。只要可能，我想保持这种状态。

答案是你的，你可以用你认为合适的方式来制定它。您可以避免提供代码，如果您认为这样做是错误的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T13:00:21.180

您可以采取两种方法。

1.  向隐藏的 iframe 提交表单（更好地支持）
2.  使用[File API](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications#Example.3A_Uploading_a_user-selected_file)（更强大）

# c - SO_RCVTIMEO 套接字选项不适用于 recvfrom()

> ID：12552501
> 
> 赞同：0
> 
> 时间：2012-09-23T12:52:34.557
> 
> 标签：c, network-programming

我设置了套接字选项 SO_RCVTIMEO 但它真的不适用于 UDP`recvfrom()`系统调用吗？有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T13:06:51.190

可能是您给出的超时太小，它返回 -1，EAGAIN 作为 errno。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T01:05:49.027

可能的错误可能是滥用 select() 函数。不要忘记检查其结果是否为零。

代码应该是这样的：

```
int nRes = 0;

fd_set socketset;
memset(&socketset, 0, sizeof(socketset));
socketset.fd_count = 1;
socketset.fd_array[0] = sock;
timeval timeout = {0, 0};
timeout.tv_sec = dwTimeout / 1000;
timeout.tv_usec = (dwTimeout % 1000) * 1000;    // microseconds

nRes = select(0, &socketset, NULL, NULL, &timeout);
if (nRes == SOCKET_ERROR)
{
    return WSAGetLastError();
}
if (nRes == 0)  // timeout
{
    return WSAETIMEDOUT;
}

int nDestLen = sizeof(dest);
nRes = recvfrom (sock, (char*) &buf[0], buf.size(), 0,
    (sockaddr*) &dest, &nDestLen); 
```

# actionscript-3 - 如何在 quickbox2d 中设置运动体类型？

> ID：12552502
> 
> 赞同：2
> 
> 时间：2012-09-23T12:52:41.157
> 
> 标签：actionscript-3, box2d

在 box2d 中创建运动体很简单：

bodyDef.type=b2Body.b2_kinematicBody;

无论是在初始化新的 quickbox2d 对象时，还是直接引用属性时，我都无法弄清楚如何使用 quickbox2d 来做到这一点？

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T04:01:21.623

在原始 Box2D AS 中，b2Body.b2_kinematicBody 只是一个引用唯一整数的静态变量。唯一整数如下：

```
b2_staticBody = 0;
b2_kinematicBody = 1;
b2_dynamicBody = 2; 
```

我不熟悉您正在使用的 Box2D 包装器，但我会冒险猜测您可以将任意整数直接传递给您的 b2BodyDef：

```
/* assuming your quick object is stored in the variable 'myQuickObject' */

myQuickObject.bodyDef.type = new uint(1);

/* you may or may not need to type-cast the integer as uint */ 
```

看到您可以通过 QuickObject.bodyDef 路由访问原始 b2BodyDef 对象，您应该能够将类型更改为必要的整数。

# sql - 连接表中没有条目的连接表中的数据

> ID：12552503
> 
> 赞同：0
> 
> 时间：2012-09-23T12:53:27.530
> 
> 标签：sql

我有一个答案表、一个问题表和一个连接表来加入它们。问题表有问题，答案表有这些问题的答案。问题是，这是一个多选设置。因此，对于某个问题，答案将有一些正确答案和一些错误答案。

答案是否正确由布尔值 - is_right 指示。

如何在答案表中找到*没有*正确答案的问题（同样，没有错误答案的问题）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T12:58:52.697

```
SELECT *
FROM questions
WHERE EXISTS (
  SELECT TRUE
  FROM answers a1
  WHERE a1.question_id = questions.question_id
  AND a1.is_right
)
AND NOT EXISTS (
  SELECT TRUE
  FROM answers a2
  WHERE a2.question_id = questions.question_id
  AND !a2.is_right
) 
```

如果出于某种原因要避免子选择：

```
SELECT question_id,
       SUM(is_right) AS right_answers,
       SUM(!is_right) AS wrong_answers
FROM questions
JOIN answers ON answers.question_id = questions.question_id
GROUP BY question_id
HAVING right_answers > 0
AND wrong_answers = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:37:37.290

我不知道你为什么有一个连接表，因为答案只有一个问题。

在没有连接表的情况下，查询没有正确答案的问题：

```
SELECT questions.*
FROM questions LEFT OUTER JOIN answers
  ON questions.id = answer.question_id AND answer.is_right = false
WHERE answer.id IS NULL 
```

使用名为 answers_questions 的连接表，SQL 将是：

```
SELECT questions.*
FROM questions
  LEFT OUTER JOIN answers_questions
    ON answers_questions.question_id = question.id
  LEFT OUTER JOIN answers
    ON answers_questions.answer_id = answer.id AND answer.is_right = false
WHERE answer.id IS NULL 
```

这还将为您提供没有链接答案的问题。要获得没有正确答案的问题，在与答案相关的问题中，将第一个 LEFT OUTER JOIN 更改为 INNER JOIN。

# c++ - 函数输入变化

> ID：12552506
> 
> 赞同：0
> 
> 时间：2012-09-23T12:53:55.607
> 
> 标签：c++, function, opencv, input

我正在研究一些`openCV`文档和标题，并尝试完全理解这里发生了什么。

在`core_c.h`：

```
CVAPI(CvMat*) cvInitMatHeader( CvMat* mat, int rows, int cols,
                          int type, void* data CV_DEFAULT(NULL),
                          int step CV_DEFAULT(CV_AUTOSTEP) ); 
```

首先，在声明中`cvInitMatHeader`

```
void* data CV_DEFAULT(NULL),
int step CV_DEFAULT(CV_AUTOSTEP) 
```

这种输入变量是什么意思？这和我们平时使用的声明有什么区别，比如

```
void* data 
int step 
```

其次，我阅读了我们实际上可以使用 cvInitMatHeader 的教程

```
double a[] = { 1,  2,  3,  4,
           5,  6,  7,  8,
           9, 10, 11, 12 };
CvMat Ma;
cvInitMatHeader(&Ma, 3, 4, CV_64FC1, a); 
```

输入变量的数量与标题不匹配，我找不到其他函数重载。

为什么这可以工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:01:29.440

从给定的代码中，我可以推断出这`CV_DEFAULT(x)`是一个扩展为`= x`. 如果您不熟悉默认参数，请参阅[默认参数。](http://en.wikipedia.org/wiki/Default_argument)

# php - PHP 从 mysql 获取数据，然后在不同的操作中使用它

> ID：12552509
> 
> 赞同：1
> 
> 时间：2012-09-23T12:54:02.850
> 
> 标签：php

所以我想从mysql中获取一些数据，并用它来创造一些条件。这是我的代码，但它只显示了 mysql 的最后一条记录。

```
 $result = mysql_query("SELECT * FROM system") or die(mysql_error());
while($row = mysql_fetch_array( $result )) {

$name_system = $row['name'];
$value_system = $row['value'];
}

if($name_system=='website_register' AND $value_system==1)
    $register_system = 1;
    else
    $register_system = 0;

if($name_system=='website_offline' AND $value_system==1)
    $offline_system = 1;
    else
    $offline_system = 0; 
```

然后，如果我试图在另一个页面中回显“$offline_system”或“$register_system”，它不会显示真实数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T12:59:42.647

您在 之后关闭了 while 循环`$value_system`。这意味着将获取并存储所有记录`$name_system`，`$value_system`但循环将覆盖先前的变量，因此只有最后一条记录存储在该变量中。

这似乎是一个不完整的代码。您可以做的是将右大括号移到您希望为每条记录执行的过程的末尾。

```
$result = mysql_query("SELECT * FROM system") or die(mysql_error());
while($row = mysql_fetch_array( $result )) {

$name_system = $row['name'];
$value_system = $row['value'];
} // you closed the WHILE loop here.

if($name_system=='website_register' AND $value_system==1)
    $register_system = 1;
    else
    $register_system = 0;

if($name_system=='website_offline' AND $value_system==1)
    $offline_system = 1;
    else
    $offline_system = 0; 
```

我想你的代码是这样的：

```
$result = mysql_query("SELECT * FROM system") or die(mysql_error());
while($row = mysql_fetch_array( $result )) {

$name_system = $row['name'];
$value_system = $row['value'];

if($name_system=='website_register' AND $value_system==1)
    $register_system = 1;
    else
    $register_system = 0;

if($name_system=='website_offline' AND $value_system==1)
    $offline_system = 1;
    else
    $offline_system = 0;

 // my imagination i was talking about:
 if ($offline_system) echo 'The system is offline<br />';
 else echo 'The system is online<br />';
 if ($register_system) echo 'The registration is online<br />';
 else echo 'The registration system is offline';

 } // curly brace MOVED. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:24:54.417

如果您希望数据在多个页面中可用，则需要将其存储在某个地方。SESSION 如果数据 si 小 SQLITE 或平面文件如果它更大 在这种情况下，您需要查看每个选项使用多少内存和时间并选择最便宜的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:46:27.050

使用`$_SESSION`变量，像这样：无论你得到`$register_system`什么，它都会变成`$_SESSION['register_system']`，并且可以在下一页上以. 的形式访问`$_SESSION['register_system']`。

类似地`$offline_system`，它会像在下一页一样被`$_SESSION['offline_system']`访问。`$_SESSION['offline_system']`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T14:06:01.527

你可以让这更简单。如果您正在从数据库中查找特定值，您只需查询它们，然后分配值。

例如

```
<?php

$registerResult = mysql_fetch_row(mysql_query("SELECT value FROM system WHERE name = 'website_register'"));
$offlineResult = mysql_fetch_row(mysql_query("SELECT value FROM system WHERE name = 'website_offline'"));

$registerSystem = ($registerResult[0] ? 1 : 0);
$offlineSystem  = ($offlineResult[0] ? 1 : 0);

?> 
```

# mysql - MySQL - 检查数据类型是否为 smallint

> ID：12552510
> 
> 赞同：0
> 
> 时间：2012-09-23T12:54:04.780
> 
> 标签：mysql

我正在研究现有的数据库实现（SQL 和 MySQL）。现在我需要将一列的数据类型从 更改`smallint`为`mediumint`。虽然这不是问题，但问题在于实现中处理更新的方式。

每次启动时，程序都会执行一个简单的 MySQL 语句（如`SELECT xyz FROM 'tablename'`）来测试是否需要更新。如果语句抛出错误（例如在“xyz”不存在的示例中），则执行更新本身（在示例中，将创建“xyz”）。所以我需要的是一个语句，如果列的数据类型是`smallint`. 我只能将大于 65535 的整数写入数据库，但这当然不是一个选项。

如果没有这种可能性并且我实际需要更改处理更新的方式，是否有一种简单的方法来检查列“xyz”的数据类型是否为`smallint`？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:06:47.500

*空结果集*是否算作*错误*？然后你可以使用

```
SHOW COLUMNS FROM tablename WHERE Field = "xyz" AND Type = "mediumint(9)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:21:55.083

使用异常处理流控制（逻辑）是糟糕的设计：异常是针对“异常”的。

考虑将您的设计更改为不需要例外。例如，查询目录以找出您需要的内容：

```
select * from information_schema.columns
where tablename = 'foo'
and columnname = 'bar' 
```

似乎您需要知道的一切都可以在`information_schema`表格中找到。

# vba - 在 Excel 2010 VBA 宏中显示 Outlook GAL

> ID：12552516
> 
> 赞同：1
> 
> 时间：2012-09-23T12:55:56.803
> 
> 标签：vba, excel-2010

您好我希望能够在 Excel 中访问 Outlook GAL。我正在使用 Office 2010（Excel 2010 和 Outlook 2010）。我正在寻找的是能够按下一个按钮，然后 GAL 将显示一个对话框，然后我可以在其中搜索我需要的收件人详细信息，然后插入到一个单元格中。在互联网上搜索后，我发现了适用于 Microsoft Word 的代码，但在 excel 中使用时会出现错误。
这是这里提供的代码[http://www.vbaexpress.com/forum/archive/index.php/t-24694.html](http://www.vbaexpress.com/forum/archive/index.php/t-24694.html)

```
Public Sub InsertAddressFromOutlook()   
    Dim strCode As String, strAddress As String
    Dim iDoubleCR As Integer

    'Set up the formatting codes in strCode
    strCode = "<PR_DISPLAY_NAME>" & vbCr & _
    "<PR_POSTAL_ADDRESS>" & vbCr & _
    "<PR_OFFICE_TELEPHONE_NUMBER>" & vbCr

    'Display the 'Select Name' dialog, which lets the user choose
    'a name from their Outlook address book

    strAddress = Application.GetAddress(AddressProperties:=strCode, _
                     UseAutoText:=False, DisplaySelectDialog:=1, _
                     RecentAddressesChoice:=True, UpdateRecentAddresses:=True)

    'If user cancelled out of 'Select Name' dialog, quit
    If strAddress = "" Then Exit Sub

    'Eliminate blank paragraphs by looking for two carriage returns in a row
    iDoubleCR = InStr(strAddress, vbCr & vbCr)
    Do While iDoubleCR <> 0
        strAddress = Left(strAddress, iDoubleCR - 1) & _
                     Mid(strAddress, iDoubleCR + 1)
        iDoubleCR = InStr(strAddress, vbCr & vbCr)
    Loop

    'Strip off final paragraph mark
    strAddress = Left(strAddress, Len(strAddress) - 1)

    'Insert the modified address at the current insertion point
    Selection.Range.Text = strAddress
End Sub 
```

因此，当运行此宏时，返回错误是运行时错误 438，Object 不支持此属性或方法
，并且突出显示的错误代码块是

```
strAddress = Application.GetAddress(AddressProperties:=strCode, _
    UseAutoText:=False, DisplaySelectDialog:=1, _
    RecentAddressesChoice:=True, UpdateRecentAddresses:=True) 
```

任何人都可以提供代码解决方案吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:49:17.203

为了获得该对话框，您需要打开 Word 的一个实例，然后在 Word 中打开该对话框。下面的代码会将结果返回给 ActiveCell。它使用后期绑定，这意味着它也应该在早期版本的 Office 中运行：

```
Sub GetEmail()

Dim objWordApp As Object
Dim strCode As String
Dim strAddress As String
Dim lngDoubleCR As Long
'Set up the formatting codes in strCode
strCode = "<PR_DISPLAY_NAME>" & vbNewLine & _
          "<PR_POSTAL_ADDRESS>" & vbNewLine & _
          "<PR_OFFICE_TELEPHONE_NUMBER>"

' As GetAddress is not available in MS Excel, a call to MS Word object
' has been made to borrow MS Word's functionality
Application.DisplayAlerts = False
'On Error Resume Next
' Set objWordApp = New Word.Application
Set objWordApp = CreateObject("Word.Application")
strAddress = objWordApp.GetAddress(, strCode, False, 1, , , True, True)
objWordApp.Quit
Set objWordApp = Nothing
On Error GoTo 0
Application.DisplayAlerts = True

' Nothing was selected
If strAddress = "" Then Exit Sub

strAddress = Left(strAddress, Len(strAddress) - 1)

    'Eliminate blank paragraphs by looking for two carriage returns in a row
    lngDoubleCR = InStr(strAddress, vbNewLine & vbNewLine)
    Do While lngDoubleCR <> 0
        strAddress = Left(strAddress, lngDoubleCR - 1) & _
                     Mid(strAddress, lngDoubleCR + 1)
        lngDoubleCR = InStr(strAddress, vbNewLine & vbNewLine)
    Loop
ActiveCell.Value = strAddress
End Sub 
```

# assembly - 指令的参数顺序

> ID：12552517
> 
> 赞同：1
> 
> 时间：2012-09-23T12:55:58.343
> 
> 标签：assembly, gdb, x86-64, att

函数 main 的汇编代码转储：

```
0x0000000100000de6 <main+0>:    push   %rbp
0x0000000100000de7 <main+1>:    mov    %rsp,%rbp
0x0000000100000dea <main+4>:    sub    $0x30,%rsp
0x0000000100000dee <main+8>:    mov    %edi,-0x14(%rbp) 
```

我学到了`mov %rsp,%rbp`意味着`move the value of rsp to rbp`
但我知道在英特尔架构中，这意味着`move the value of rbp to rsp` 根据英特尔手册（英特尔架构软件开发人员手册。第 2 卷。3-104 MOV 指令），`mov a, b`应该意味着`move b to a`

下一个`sub`指令是相同的。我知道`sub a,b`手段`a = a-b`。但这里的`sub $0x30, %rsp`意思是`rsp = rsp - 0x30`

我怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:00:02.043

你没什么问题。您在这里展示的是 AT&T 语法中的汇编代码（google it up），其中操作数的顺序与您在英特尔手册中看到的相反。

# android - 在 Android 中填充 admob 广告而不在屏幕上重置 FrameLayout

> ID：12552522
> 
> 赞同：2
> 
> 时间：2012-09-23T12:56:32.257
> 
> 标签：android, admob, android-framelayout

我想实现一个类似于 Facebook 应用程序的滑动菜单栏，我使用以下[github 示例](https://github.com/gitgrimbo/android-sliding-menu-demo)来实现它。

我的所有应用程序屏幕中都有一个添加布局。我的问题如下：

1.  我打开应用程序。
2.  我点击打开菜单的图标
3.  如果在我打开菜单期间加载应用程序，菜单会自动关闭。
4.  如果您单击打开菜单的图标，菜单就会跳动。
5.  仅当菜单打开时加载加载时才会发生这种情况。

这是我的典型布局文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
style="@style/Fill" >

<FrameLayout
    android:id="@+id/FL_home"
    style="@style/Fill"
    android:layout_above="@id/adView" >

    <include layout="@layout/app_com_menu" />

    <LinearLayout
        android:id="@+id/LL_app"
        style="@style/Fill.RL"
        android:orientation="vertical" >

        <include layout="@layout/app_com_title" />

        <ListView
            style="@style/FillWrap.List" />

        <include layout="@layout/network_error" />
    <include layout="@layout/error_no_live"/>
    </LinearLayout>
</FrameLayout>

<include layout="@layout/ad_layout" /> 
```

我的 ad_layout 文件如下：

```
<?xml version="1.0" encoding="utf-8"?>
<com.google.ads.AdView xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
android:id="@+id/adView"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
ads:adSize="BANNER"
ads:adUnitId="xxxxxxxxxxxx"
ads:loadAdOnCreate="true"
android:visibility="gone" /> 
```

而这就是滑动抽屉的主要逻辑

```
class AppMenuListener implements OnClickListener {
    public void onClick(View v) {
        doAnimation();
    }
}

class AppMenuCloseListener implements OnClickListener {
    public void onClick(View v) {
        if (menuOut) {
            doAnimation();
        }
    }
}

private void doAnimation() {
    AppBase me = AppBase.this;
    Animation animation = null;

    int width = appPage.getMeasuredWidth();
    int height = appPage.getMeasuredHeight();
    int left = (int) (appPage.getMeasuredWidth() * 0.67);
    if (menuOut) {
        if (appMenu.getVisibility() == View.VISIBLE) {
            animation = new TranslateAnimation(0, -left, 0, 0);
            animation.setDuration(300);
            animParams.set(0, 0, width, height);
        }
    } else {
        if (appMenu.getVisibility() == View.INVISIBLE) {
            animation = new TranslateAnimation(0, left, 0, 0);
            appMenu.setVisibility(View.VISIBLE);
            animParams.set(left, 0, left + width, height);
            animation.setDuration(400);
        }
    }

    animation.setAnimationListener(me);
    animation.setFillEnabled(true);
    appPage.startAnimation(animation);
}

public void onAnimationEnd(Animation animation) {
    menuOut = !menuOut;
    if (!menuOut) {
        appMenu.setVisibility(View.INVISIBLE);
    }
    appPage.layout(animParams.left, animParams.top, animParams.right,
            animParams.bottom);
}

public void onAnimationRepeat(Animation animation) {
}

public void onAnimationStart(Animation animation) {
}

static class AnimParams {
    int left, right, top, bottom;

    void set(int left, int top, int right, int bottom) {
        this.left = left;
        this.top = top;
        this.right = right;
        this.bottom = bottom;
    }
} 
```

我尝试使用 adListener 并在菜单出现时停止加载广告，但我没有太多运气。

有人可以建议我做什么不同的事情吗？

# environment-variables - 如何访问 ITCL 类中的环境变量？

> ID：12552533
> 
> 赞同：1
> 
> 时间：2012-09-23T12:57:36.480
> 
> 标签：environment-variables, tcl, env

我知道在普通的 tcl 脚本中可以像这样访问环境变量：

```
global env
puts "User: $env(USER)"

set env(IOFILE) "somefile.txt" 
```

但这似乎不适用于 ITCL 类方法。如何在 ITCL 类代码中获取和设置环境变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T16:54:39.267

Itcl 对变量发现做了复杂的事情，但是您可以通过提供变量的完全限定名称来覆盖这个技巧（该`global`命令会将本地范围内名称的最后一个组件绑定到命名变量）。因此：

```
global ::env  ;# <<<<<< Note this <<<<<<

puts "User: $env(USER)"
set env(FOO) "bar" 
```

# java - 如何更改函数中的引用

> ID：12552535
> 
> 赞同：0
> 
> 时间：2012-09-23T12:57:45.417
> 
> 标签：java

在下面的代码片段中p是二叉搜索树中的一个节点，如果p的左孩子不为null我想把p改成指向它的左孩子，但是java是传值的，当函数返回树的结构保持不变。

```
void remove(BSTNode p)
{
    if(p.ch[0]==null)
        p=p.ch[0];
} 
```

实际上我想实现类似下面的 C++ 代码：

```
void remove(BSTNode* &p)
{
    if(p->ch[0]==NULL)
        p=p->ch[0];
} 
```

由于其他原因，我不想使用以下方式返回 p.ch[0] 并在每次调用删除后设置 p 。

```
BSTNode remove(BSTNode p)
{
    if(p.ch[0]==null)
        return p.ch[0];
} 
```

如何做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:02:45.150

您可以使用一个简单的包装器：

```
class Wrapper<T> {
    public T value;
}

void remove(Wrapper<BSTNode> p)
{
    if(p.value.ch[0] == null)
        p.value = p.value.ch[0];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:01:25.773

传递引用并更改它在 Java 中根本不会产生任何影响，您只会更改新的本地引用。
尽管有其他原因，我还是建议您采用最后一种方法。

另一种解决方法是传入 的父节点`p`，并更改该对象中的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T13:03:37.787

@outlaw，您可能知道，Java 不支持指针。我不太了解您的要求，但我多次遇到这种情况。通常我所做的是：而不是赋值（`p = p.ch[0]`）转移属性`p.ch[0] to p`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T13:06:31.447

您可以保存指向节点父蚂蚁的指针，然后使用该引用更改它

```
void remove(BSTNode p)
{
    if(p.ch[0]==null){
    p.parent.ch[0] = p.ch[0];
} 
```

# backbone.js - 使用 Jasmine 进行主干.js 测试 - 设置

> ID：12552540
> 
> 赞同：1
> 
> 时间：2012-09-23T12:58:58.730
> 
> 标签：backbone.js, jasmine

我阅读了有关使用 Jasmine 测试backbone.js 应用程序的信息，但仍然有一个关于设置的问题：

在我的应用程序中，我有一个名为的代码模块`userHttpClient`，它依赖于其他`httpClient`仅依赖于`jQuery`. 它看起来像：

```
// userHttpClient.js
define(['jQuery','httpClient'], function( $ , httpClient ) {
    return {
            saveUser : function(name,password) {
            httpClient.post(....);
                }
...

// httpClient.js
define(['jQuery'], function( $ ) {
    return {
            post : function(...) {
            $.ajax(...);
               }
... 
```

如何让 jasmine 测试 .html 页面加载上面的模块？我应该在测试页面中包含 require.js 及其 main.js 文件并加载模块吗？

或者也许我应该将测试规范文件编写为backbone.js 模块并运行它们？

# django - 在 Django 中，我似乎真的需要动态字段名称。我究竟做错了什么？

> ID：12552542
> 
> 赞同：0
> 
> 时间：2012-09-23T12:59:22.690
> 
> 标签：django, database-schema

我是 Django 新手，在我目前的项目中，我有一个“名词”模型，其中包含 12 个平行感觉字段：“nominativeSingular”、“vocativeSingular”、“ablativePlural”等。

我似乎经常想从字符串的某种组合（'宾格'，'复数'）中获取给定名词的相关属性，虽然我可以手写一本 12 项的字典，但这似乎非常不雅。

这里的问题：[Django: OR queries with dynamic field](https://stackoverflow.com/questions/10340106/django-or-queries-with-dynamic-field-names) namesSuggested using "** dictionary-to-kw-args" - 这真的是我想要的吗？如果是这样，是否有可能解释它在这种情况下如何工作？或者，这整件事真的是糟糕的数据库设计的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:56:52.917

啊哈！我在这里想要的是 getattr，它正是这样做的，并且是 Python 事务而不是 Django 事务。

该页面对其进行了有用的解释：http: [//effbot.org/zone/python-getattr.htm](http://effbot.org/zone/python-getattr.htm) - 本质上，这些行是等效的：

```
value = obj.attribute; 
```

和

```
value = getattr(obj, "attribute") 
```

# eclipse - 从 Eclipse 运行时无法访问 Tomcat 7 Manager 应用程序

> ID：12552543
> 
> 赞同：2
> 
> 时间：2012-09-23T12:59:26.567
> 
> 标签：eclipse, tomcat, tomcat7

[我从这里](http://tomcat.apache.org/download-70.cgi)安装了 Tomcat 7并使用了[Windows Service Installer](http://tomcat.apache.org/download-70.cgi)。

但是，当我创建一个新的网络应用程序并尝试通过`http://localhost:8080/WSTest/`它访问它时，我的旧网络应用程序都不起作用，除非我附加 index.jsp ...

但是，最困扰我的一件事是，即使我在 conf/tomcat-users.xml 中定义了一个管理员用户，我也无法打开管理器应用程序：

```
<user name="admin" password="some-pwd" roles="admin-gui,manager-gui" /> 
```

奇怪的是，在我安装了 Tomcat 7 之后，甚至 Tomcat 6 中的管理器应用程序也不再工作了。

它只是显示没有内容的空白白页，甚至从不要求我提供凭据或任何东西。

有人知道这里发生了什么吗？

谢谢！

**编辑：**这似乎是一个 Firefox 问题，因为我能够访问 Chrome 上的管理器应用程序。

但是，一旦我连接 Eclipse 并从 Eclipse 启动 Tomcat，管理器应用程序再次损坏，即使在 Chrome 上也是如此。这里有一个 Eclipse 问题。我确实[按照这里的建议](http://www.coreservlets.com/Apache-Tomcat-Tutorial/tomcat-7-with-eclipse.html)将 ROOT 文件夹从 Tomcat 复制到了 Eclipse ，我什至复制了管理器文件夹以及示例和文档文件夹。

当我在 Eclipse 中运行我的测试网络应用程序时，我可以`http://localhost:8080/WSTest/`正确地看到它。我也可以正常看到Tomcat主页`http://localhost:8080/`。但是，我无法访问 Manager App `http://localhost:8080/manager/html`，因为它说：“*请求的资源不可用。* ”

如果我在 Eclipse 中停止 Tomcat 并启动 Windows 服务，那么我可以访问管理器应用程序，但它不会在列表中显示我的测试网络应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:11:46.623

我在适当的 Tomcat 文档中找不到“admin-gui”。也许使用这个角色会导致问题？

[http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Configuring_Manager_Application_Access](http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Configuring_Manager_Application_Access)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T11:00:50.547

显然问题出在我的 Firefox 安装上。在用尽所有选项并使用 Chrome、Safari、Opera 甚至 IE 进行测试后，一切正常，我决定卸载 Firefox，删除所有配置文件设置，然后重新安装。**新的安装工作。**

*ps 提示：如果您要完全卸载 Firefox，请不要忘记备份您的书签和密码并保存您的插件列表；) 可以直接从 Firefox 备份书签 可以使用名为 Password 的插件存储密码我用截图“保存”了出口商附加组件：D*

# android - Android中如何在自己的进程中与服务进行连接和通信

> ID：12552546
> 
> 赞同：0
> 
> 时间：2012-09-23T12:59:57.663
> 
> 标签：android, ipc, aidl

我正在构建一个 android 音乐应用程序，并且我已经实现了在后台运行的播放器服务，该服务具有一个控制所有播放 UI（如播放、暂停等）的活动。

起初，该服务在同一进程中运行。但是现在我让它在自己的进程中运行，因为它在执行网络 IO 时阻塞了 UI 线程。

目前我正在使用 bindservice 并将服务对象返回给活动。

现在我如何连接到服务并使用它的方法？

我知道需要一些 AIDL 的东西，但我是 java 和 android 的新手，所以你能告诉我一些例子吗？我如何开始使用 AIDL

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T22:48:49.180

您可以从此处的 Android 开发人员文档开始：http: [//developer.android.com/guide/components/aidl.html](http://developer.android.com/guide/components/aidl.html)

[http://developer.android.com/guide/components/bound-services.html](http://developer.android.com/guide/components/bound-services.html)

然后通过搜索 AIDL 查阅已经回答的其他类似问题，例如： [Android - Using method from a Service in an Activity?](https://stackoverflow.com/questions/2272378/android-using-method-from-a-service-in-an-activity?rq=1)

# objective-c - 当应用程序在主窗口上运行时如何添加 nib 文件？

> ID：12552548
> 
> 赞同：0
> 
> 时间：2012-09-23T13:00:12.650
> 
> 标签：objective-c, ios, xcode, ipad

我有一个示例应用程序，其中有委托方法和主控制器和 mainwindow.xib。当我的应用程序加载它直接加载。但我想做一些改变，比如添加按钮和其他 UI 的东西。但我没有 nib 文件。所以我添加了新的 nib 文件名，称为 Newview.xib。

所以我的要求是如何在启动时加载这个 nib 文件，我必须在 appdelegate 方法中进行哪些更改。正在运行的当前代码如下

```
(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {  

    mainController = [[MainController alloc] init];

    [window addSubview:mainController.view];
    [window makeKeyAndVisible];

    return YES;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:20:36.353

在您的示例应用程序中，应用程序`.xib`通过搜索与其视图控制器同名的文件来获取 -file。在您想要定义自己`.xib`使用哪个文件的新情况下，您可以实现：

```
initWithNibName:bundle: 
```

并将您的名称指定`.xib`为第一个参数（不附加“.xib”）。

# iphone - 多次传递的标准核心数据迁移不起作用

> ID：12552551
> 
> 赞同：1
> 
> 时间：2012-09-23T13:00:50.147
> 
> 标签：iphone, objective-c, ios, core-data, core-data-migration

我在这里遵循了关于核心数据标准迁移的教程：

[http://mipostel.com/index.php/home/70-core-data-migration-standard-migration-part-2](http://mipostel.com/index.php/home/70-core-data-migration-standard-migration-part-2)

然后在这里进行多次传递：

[多遍核心数据迁移的示例或解释？](https://stackoverflow.com/questions/5995231/example-or-explanation-of-core-data-migration-with-multiple-passes)

这给了我这里的结果代码：

```
- (NSManagedObjectContext *)managedObjectContext {

    if (managedObjectContext != nil) {
        return managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        managedObjectContext = [TICDSSynchronizedManagedObjectContext new];
        [managedObjectContext setPersistentStoreCoordinator: coordinator];
    }
    return managedObjectContext;
}
- (NSManagedObjectModel *)managedObjectModel {

    if (managedObjectModel != nil) {
        return managedObjectModel;
    }

    //    managedObjectModel = [[NSManagedObjectModel mergedModelFromBundles:nil] retain];
    NSString *modelPath = [[NSBundle mainBundle] pathForResource:@"EntryDatabase" ofType:@"momd"];
    NSURL *modelURL = [NSURL fileURLWithPath:modelPath];
    managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];

    return managedObjectModel;
}
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {

    if (persistentStoreCoordinator != nil) {
        return persistentStoreCoordinator;
    }

    NSString *storePath = [[self applicationDocumentsDirectory]
                           stringByAppendingPathComponent:@"CoreDataStore.sqlite"];

    NSFileManager *fileManager = [NSFileManager defaultManager];
    // If the expected store doesn't exist, copy the default store.
    NSLog(@"file exists at path: %@, %i", storePath, [fileManager fileExistsAtPath:storePath]);
    if (![fileManager fileExistsAtPath:storePath]) {
        NSString *defaultStorePath = [[NSBundle mainBundle] pathForResource:@"CoreDataStore" ofType:@"sqlite"];
        if (defaultStorePath) {
            [fileManager copyItemAtPath:defaultStorePath toPath:storePath error:NULL];
        }
    }

    persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];

    NSURL *storeUrl = [NSURL fileURLWithPath:storePath];
    NSError *error;
    NSDictionary *pscOptions = [NSDictionary dictionaryWithObjectsAndKeys:
                                [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                                [NSNumber numberWithBool:NO], NSInferMappingModelAutomaticallyOption,
                                nil];

    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                                  configuration:nil
                                                            URL:storeUrl
                                                        options:pscOptions
                                                          error:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }

    return persistentStoreCoordinator;
}

- (BOOL)checkForMigration
{
    BOOL migrationSuccess = NO;
    NSString *storeSourcePath = [[self applicationDocumentsDirectory]
                                 stringByAppendingPathComponent:@"CoreDataStoreNew.sqlite"];
    NSFileManager *fileManager = [NSFileManager defaultManager];

    if (![fileManager fileExistsAtPath:storeSourcePath]) {
        //Version 2 SQL has not been created yet, so the source is still version 1...
        storeSourcePath = [[self applicationDocumentsDirectory]
                           stringByAppendingPathComponent:@"CoreDataStore.sqlite"];
    }

    NSURL *storeSourceUrl = [NSURL fileURLWithPath: storeSourcePath];
    NSError *error = nil;
    NSDictionary *sourceMetadata = [NSPersistentStoreCoordinator
                                    metadataForPersistentStoreOfType:NSSQLiteStoreType
                                    URL:storeSourceUrl
                                    error:&error];
    if (sourceMetadata) {
        NSString *configuration = nil;
        NSManagedObjectModel *destinationModel = [self.persistentStoreCoordinator managedObjectModel];

        //Our Source 1 is going to be incompatible with the Version 2 Model, our Source 2 won't be...
        BOOL pscCompatible = [destinationModel isConfiguration:configuration compatibleWithStoreMetadata:sourceMetadata];
        NSLog(@"Is the STORE data COMPATIBLE? %@", (pscCompatible==YES) ?@"YES" :@"NO");

        if (pscCompatible == NO) {
            migrationSuccess = [self performMigrationWithSourceMetadata:sourceMetadata toDestinationModel:destinationModel];
        }
    }
    else {
        NSLog(@"checkForMigration FAIL - No Source Metadata! \nERROR: %@", [error localizedDescription]);
    }
    return migrationSuccess;
}

- (BOOL)performMigrationWithSourceMetadata :(NSDictionary *)sourceMetadata
                         toDestinationModel:(NSManagedObjectModel *)destinationModel
{

    BOOL migrationSuccess = NO;
    //Initialise a Migration Manager...
    NSManagedObjectModel *sourceModel = [NSManagedObjectModel mergedModelFromBundles:nil
                                                                    forStoreMetadata:sourceMetadata];
    //Perform the migration...
    if (sourceModel) {
        NSMigrationManager *standardMigrationManager = [[NSMigrationManager alloc]
                                                        initWithSourceModel:sourceModel
                                                        destinationModel:destinationModel];

        NSArray *mappingModelNames = [NSArray arrayWithObjects:@"StepOne", @"StepTwo", nil];
        NSDictionary *sourceStoreOptions = nil;

        NSString *destinationStorePath = [[self applicationDocumentsDirectory]
                                          stringByAppendingPathComponent:@"CoreDataStoreNew.sqlite"];

        NSURL *destinationStoreURL = [NSURL fileURLWithPath: destinationStorePath];

        NSString *destinationStoreType = NSSQLiteStoreType;

        NSDictionary *destinationStoreOptions = nil;

        for (NSString *mappingModelName in mappingModelNames) {

            NSError *error;

            NSURL *fileURL = [[NSBundle mainBundle] URLForResource:mappingModelName withExtension:@"cdm"];

            NSMappingModel *mappingModel = [[NSMappingModel alloc] initWithContentsOfURL:fileURL];

            migrationSuccess = [standardMigrationManager migrateStoreFromURL:destinationStoreURL
                                                                        type:NSSQLiteStoreType
                                                                     options:sourceStoreOptions
                                                            withMappingModel:mappingModel
                                                            toDestinationURL:destinationStoreURL
                                                             destinationType:destinationStoreType
                                                          destinationOptions:destinationStoreOptions
                                                                       error:&error];

            NSLog(@"Error: %@", error);
        }

    }

    return migrationSuccess;

} 
```

尽管如此，该应用程序的内存不足并在以下行崩溃`persistentStoreCoordinator`：

```
if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                              configuration:nil
                                                        URL:storeUrl
                                                    options:pscOptions
                                                      error:&error]) { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:45:57.903

我记得我也跟着这个教程。

其实我发现这不是正确的做法。顺便说一句，您是否阅读了该教程的最后一条评论并尝试删除提到的行？也许这可以解决您的情况？

无论如何，就我而言，我意识到（在遵循本教程之后，修改没有帮助）有一种更简单的方法。

但是，在你的情况下，我不知道，如果这个小小的修改不能解决它，我真的会寻找另一个参考 - 因为这确实不是正确的做法，并且会导致你走向错误的方向，因为它试图做一切本身，而不是使用苹果核心数据迁移过程背后的逻辑，因为我发现很难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T15:02:06.450

几年前我解决的问题是从一个存储库中取出一个子树并将其复制到另一个存储库中，我所做的应该对你有用。我在 Mac 上执行此操作，因此内存不是问题，但是通过按照核心数据编程指南“减少内存开销”进行适当的故障排除和减少内存，您应该能够使其正常工作。

以下解决方案基于 MOM 并非完全不同的假设。让我介绍现有上下文的术语“A”和新上下文的“B”。

1）第一步是将A中的每个对象复制到B中。如果类保持不变，那很好。这意味着对于每个对象，您都需要一个来自实体的所有值的列表。我建议使用键 - 每个实体类型的属性键数组，这将使编码更容易（如果可以的话）。否则，您实际上可以从 MOM 获取密钥——这就是我在旧代码中所做的。

现在是关键步骤 - 您必须创建一个翻译词典（也许您需要两个 - 我做了），对于 A 中的每个实体，您都知道“B”中的对应一个。您可以使用“objectID”属性（但对于 B，不要保存直到完成，因为一旦保存此值更改）。

2) 现在您已经完全重新创建了所有实体，您需要将它们“连接”起来——因此所有关系都已正确设置。同样，为每个实体类型创建一些键数组，然后在循环中查看“A”中的每个关系，获取它指向的实体，使用转换表在“B”中找到对应的实体，然后设置'B' 中的值。

瞧！完成。您显然是添加是删除，您是否执行上述操作以反映 A - B 的更改。

同样，我不需要太担心 Mac 上的内存，所以不需要技巧来降低内存。我相信故障 ('refreshObject:mergeChanges:') 会对您有所帮助，但再也不必这样做（即使如此，可能只是尺寸较大的对象）。

# java - 静态变量是否只能在同步代码中访问？

> ID：12552559
> 
> 赞同：-1
> 
> 时间：2012-09-23T13:01:41.033
> 
> 标签：java

在一个类中，如果有`Static Variable`，一些开发人员建议通过访问它们，`Synchronize Methods`因为当访问变量的进程正在运行时，另一个进程可以更改该变量的值。这是错的吗？是不是也有关系`Thread Safe`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:21:05.057

是的，这与线程安全有关，与进程无关（每个进程通常都有自己的内存，因此没有对变量的共享访问）。

每当一个变量可以被多个线程访问时，您需要添加某种形式的同步以确保在一个线程中所做的更改对其他线程可见，并且您对变量（以及可能相关的变量）的操作不会互相干扰。

同步访问静态变量通常是一个好主意，因为通常很难排除它会被多个线程访问，特别是如果变量也是公共的。

如果这个变量是一个常量，即它只在静态初始化期间设置并且之后永远不会改变，你可以将它设为final而不是同步访问。类似地，根据变量的用途，它也可能足以使其变为易失性，这至少可以确保对其值的更改立即对所有线程可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:17:19.923

如果包含变量的类预计将在并发环境中使用，并且静态变量不是最终的（或不可变的对象），那么您最好通过同步访问来控制它，否则，如果您不这样做会更好t 这样做是因为同步方法或块的性能较低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:08:05.090

仅仅因为一个变量是`static`并不意味着它需要被保护免受并发修改。

# cakephp - 使用 CakePHP 查找记录时出错

> ID：12552562
> 
> 赞同：0
> 
> 时间：2012-09-23T13:02:26.790
> 
> 标签：cakephp, find, php

我正在学习 CakePHP，其中包含一些使用 CakePHP 1.x 制作的视频教程。我使用的是最新版本的 CakePHP 2.2.2 stable，当我尝试实现编辑功能时，我遇到了这个错误：

> 警告 (2)：非法偏移类型 [CORE\Cake\Model\Model.php，第 2666 行]

这是编辑功能的代码：

```
function edit($id = null){
            if(!$id){
                $this->Session->setFlash('Tarea invalida');
                $this->redirect(array('action'=>'index'),null,true);
            }
            if(empty($this->data)){
                $this->data = $this->Tarea->find(array('id'=>$id));
            }else{
                if($this->Tarea->save($this->data)){
                    $this->Session->setFlash('La tarea ha sido salvada');
                    $this->redirect(array('action'=>'index'),null,true);
                }else{
                    $this->Session->setFlash('La tarea no ha podido ser salvada. Intentelo de nuevo');
                }
            }
        } 
```

而我改变了

```
$this->data = $this->Tarea->find(array('id'=>$id)); 
```

到

```
$this->data = $this->Tarea->find('all',array('conditions',array('id'=>$id))); 
```

并且错误没有出现，但没有从数据库中检索数据......如果我实现：

```
$this->data = his->Tarea->find('first',array('conditions',array('id'=>$id))); 
```

第一个值总是被检索。

希望你的帮助，丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:44:01.513

`find`您的陈述的以下部分是错误的： `array('conditions',array('id'=>$id))`。它必须是：`array('conditions' => array('id'=>$id))`。

# css - @import 缩小和连接 CSS 不适用于 h5bp 构建脚本

> ID：12552567
> 
> 赞同：3
> 
> 时间：2012-09-23T13:03:13.130
> 
> 标签：css, build, html5boilerplate

我已经使用@import 规则设置了我`main.css`的导入到两个样式表，因此 H5BP 构建脚本将缩小并连接它们。运行构建脚本后我得到的只是`main.css`没有两个导入文件的缩小版本。

我检查了构建脚本配置，它指向正确的文件，我还尝试更改路径相对性但没有成功。

这是 main.css ：

```
@import url("../css/html5bp.css");
@import url("../css/styles.css"); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T17:00:48.840

使用相对路径可能存在问题，几个月前有一篇关于 githug 的帖子。

构建脚本 xml 文件的第 763 行似乎是它开始的地方，并且似乎支持您正在寻找的内容。我建议为您的导入尝试一条完整的路径，看看是否可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T08:08:42.767

尝试检查`build/config/default.properties`文件，可以找到以下脚本：

```
#
# Root Stylesheet
# this is the file that contains the @import directives
#
file.root.stylesheet    = main.css 
```

# php - 自动装载机功能错误

> ID：12552571
> 
> 赞同：0
> 
> 时间：2012-09-23T13:03:52.640
> 
> 标签：php, autoloader

如果我想引入一个我从未使用过自动加载器功能的类，我总是使用包含。当我出于某种原因使用该功能时，我继续收到错误。

> " 警告：include_once(classes/user.class.php)：无法打开流：第 6 行 /home/mjcrawle/phpfiles/preprod/test/index.php 中没有此类文件或目录警告：include_once()：打开失败'classes/user.class.php' 包含在第 6 行的 /home/mjcrawle/phpfiles/preprod/test/index.php 中（include_path='.:/usr/share/php:/usr/share/pear'）致命错误：在第 42 行的 /home/mjcrawle/phpfiles/preprod/test/index.php 中找不到类“用户””

这就是我的 php 包含的样子。

```
require_once('classes/ registereduser.class.php'); 
```

这是我无法正常工作的自动加载器。我班上的第一个字母是一个大写字母，这就是我使用字符串来降低的原因。

```
function autoloader($class){
     include_once('classes/'.strtolower($class).'.class.php');
     } 
```

spl_autoload_register（自动加载器）；

我可以使用一些帮助来解决我在这方面做错了什么，我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:17:21.957

一些提示： - 目录“classes”不在您的包含路径中。由于 php 将在那里搜索自动加载，因此您会发现问题所在... - 使用 set_include_path 函数将类目录添加到您的包含路径。

我无法详细说明，因为我正在使用我的手机，它的键盘很痛苦。

# .htaccess - 从重定向重写规则中排除图像文件夹

> ID：12552575
> 
> 赞同：3
> 
> 时间：2012-09-23T13:04:13.030
> 
> 标签：.htaccess, mod-rewrite, rewrite

我已经在我的 .htacces 文件中进行了设置，以便任何尝试访问该站点的人都会被重定向到 index.html，这是一个正在建设的页面。我在那里有一张图片，不显示因为链接被重定向到 index.html，我如何从规则中排除图片，路径是`/images/underConstruction.png.`

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !=/index.html
RewriteRule ^ /index.html [R=301] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T01:12:28.680

在规则中添加排除条件：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !=/images/
RewriteCond %{REQUEST_URI} !=/index.html
RewriteRule ^ /index.html [R=301] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:07:40.947

尝试添加这一行

```
RewriteRule ^images/ - [L] 
```

# php - 根据 db 值选择下拉列表值

> ID：12552578
> 
> 赞同：0
> 
> 时间：2012-09-23T13:04:28.593
> 
> 标签：php

如果值与数据库中的值相对应，我希望选择下拉列表中的项目。

到目前为止，这是我的代码...

```
$hardware_type = $row['type'];

//pull names from hardware types from databse
$sql = "SELECT * FROM s_num_serialz_types ORDER BY type ASC";
$result = $mysqli->query($sql) or die($mysqli->error.__LINE__);
$type_dropdown = '<select id="serial_type" class="accounts_input_dropdown" type="text" name="serial_type" selected="'.$_POST['serial_type'].'"/><option></option>';
while($row = mysqli_fetch_assoc($result)){
    if($row['type'] != $hardware_type){
    $type_dropdown .= "\r\n<option value='{$row['type']}'>{$row['type']}</option>";
    }else{
        $type_dropdown .= "\r\n<option value='{$row['type']} selected=\"selected\">{$row['type']}</option>";
    }
}
$type_dropdown .= "\r\n</select>"; 
```

我尝试了几种编写此代码的方法，但似乎都没有。我第一次尝试...

```
while($row = mysqli_fetch_assoc($result)){
    if($row['type'] == $hardware_type){
    $type_dropdown .= "\r\n<option value='{$row['type']} selected=\"selected\">{$row['type']}</option>";
    }else{
        $type_dropdown .= "\r\n<option value='{$row['type']}'>{$row['type']}</option>";
    }
} 
```

这在列表中选择了正确的项目，但包含此列表的表单的其余部分不显示。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:07:29.940

`value='{$row['type']}`在您的第一次尝试（第二个代码示例）中缺少关闭单引号来关闭`value`属性值 - 这可能足以让浏览器在该元素之后退出呈现您的表单。

```
value='{$row['type']}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:07:59.873

你这里有错别字

```
<option value='{$row['type']} 
```

错过了结束`'`。您还混合了单引号和双引号，这不是标准的最佳选择。

我可以建议你这个紧凑的版本：

```
while($row = mysqli_fetch_assoc($result)){
    $selected = ($row['type'] == $hardware_type) ? " selected='selected'" : '';
    $type_dropdown .= "\r\n<option value='{$row['type']}'$selected>{$row['type']}</option>";
} 
```

# matrix - 如何在 prolog 中访问和使用矩阵

> ID：12552584
> 
> 赞同：1
> 
> 时间：2012-09-23T13:05:15.180
> 
> 标签：matrix, prolog

我需要随机访问序言（swipl）中的矩阵位置。建议我一个库，它提供了一种在矩阵中创建和访问随机位置的方法，而无需经历处理列表的过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T14:25:13.303

SWI-Prolog 有无限数量的术语，那么你真的不需要任何外部库。有几个用于访问术语参数的内置函数，我发现[arg](http://www.swi-prolog.org/pldoc/doc_for?object=arg/3)很方便。例如：

```
?- A = array(1,2,3,4,5,6,7), arg(3, A, X).
X = 3. 
```

根据您需要处理的数据以及访问这些矩阵的频率，您可以应用数据隐藏，为自己提供首选界面。

例如，您可能需要索引验证：

```
?- A = array(1,2,3,4,5,6,7), arg(8, A, X).
false. 
```

请注意，不会引发异常...

arg/3 也可以*搜索*匹配的参数：

```
?- A = array(1,2,3,4,5,6,7), arg(P, A, 4).
A = array(1, 2, 3, 4, 5, 6, 7),
P = 4 . 
```

**编辑**

在 Prolog 中，*分配*必须始终小心处理，因为编程*模型*并不真正适合这种情况。但是有一些内置函数，比如[nb_setarg](http://www.swi-prolog.org/pldoc/man?predicate=nb_setarg/3)，可以完成这项工作。请参阅相关文档[部分](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%274.20%27,swi%28%27/doc/Manual/manipterm.html%27%29%29)。

# php - 在非对象上调用成员函数 fetch_object()

> ID：12552588
> 
> 赞同：-1
> 
> 时间：2012-09-23T13:06:02.870
> 
> 标签：php

当我加载包含以下代码的 PHP 页面时，我收到错误“调用非对象上的成员函数 fetch_object()”。它与以单词while开头的行有关。为什么会弹出这个错误？**请忽略我的安全漏洞。**

PHP 片段：

```
header('Content-Type:application/json;charset=utf-8');

$file_absolute = "---placeholder for correct file path---";
include_once($file_absolute);
$mysql = new mysqli($db_host, $db_username, $db_password, $db_name);
$verb_value = $_POST['verb_value'];

$mysql->query("SET CHARACTER SET 'utf8'");

$result = $mysql->query("SELECT present_tense FROM $verb_value");

$queryResult = array();

while ($row = $result->fetch_object())
{
    $queryResult[] = $row->present_tense;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T13:08:03.507

您的代码中缺少错误检查：

```
$result = $mysql->query("SELECT present_tense FROM $verb_value");
if( !$result)
  die($mysql->error);

$queryResult = array();

while ($row = $result->fetch_object())
{
    $queryResult[] = $row->present_tense;
} 
```

您的查询结果是一个非对象，但您没有检查它。

注意：您的代码很容易发生 SQL 注入：`$verb_value = $_POST['verb_value']`导致在不检查的情况下将 SQL 代码注入数据库的可能性！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:43:50.290

```
$verb_value = $_POST['verb_value'];

$mysql = new mysqli($db_host, $db_username, $db_password, $db_name);

$mysql->query("SET CHARACTER SET 'utf8'");

if (mysqli_connect_errno()) {
       printf("Connect failed: %s\n", mysqli_connect_error());
       exit();
    }
$query = "SELECT present_tense FROM $verb_value";
$queryResult = array();
if ($result = $mysql->query($query)) {
  while ($row = $result->fetch_object()) {
     $queryResult[]=$row->present_tense;
  }
  $result->close();
 } 
```

# php - 两个表的 SQL 查询

> ID：12552599
> 
> 赞同：3
> 
> 时间：2012-09-23T13:07:55.563
> 
> 标签：php, mysql

我将尝试解释我面临的问题。

我有两个表：Team 和 Team_contacts

在第一个表中有如下信息：member_name、member_picture、电话和电子邮件

在 team_contacts 表中，只有成员负责的国家和城市。

所以第一个表看起来像这样：

```
member_id: 1
member_name: moonwalker
member_picture: mw.jpg
member_phone: 06xxxxxxxx
member_email: mw@moonwalker.com 
```

第二个表如下所示：

```
member_id: 1
country: USA
city: California

member_id: 1
country: USA
city: Miami

member_id: 1
country: NL
city: Amsterdam 
```

我需要的是一个显示以下内容的查询：

```
mw.jpg 
Moonwalker 
Phone: 06xxxxxxxx 
Email: mw@moonwalker.com 
Active in countries: USA, NL 
Active in cities: California, Miami, Amsterdam 
```

我尝试了不同的连接方法，但似乎没有任何效果。有没有办法用一个查询来做到这一点，还是我需要使用两个不同的查询？如何？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T13:10:17.187

当您使用*MySQL*时，您可以执行以下操作：

```
SELECT team.*,
       GROUP_CONCAT(team_contacts.country SEPARATOR ", ") AS active_in_countries,
       GROUP_CONCAT(team_contacts.city SEPARATOR ", ") AS active_in_cities
FROM team
JOIN team_contacts USING (team_id)
GROUP BY team.member_id 
```

请注意，列表的长度`group_concat_max_len`受默认为 1024 的限制，除非您使用以下示例进行更改：

```
SET SESSION group_concat_max_len = @@max_allowed_packet 
```

# java - 参数检查库 - 隐式/显式空值检查的参数

> ID：12552600
> 
> 赞同：2
> 
> 时间：2012-09-23T13:07:57.737
> 
> 标签：java, null, nullable, argument-validation

我目前正在[为 Java 编写一个小型参数检查库](http://better-checks.trick17.ch)。检查以流畅的界面方式编写，如下所示：

```
Check.that(name).matches("hello .*!").hasLenghtBetween(0, 20);
Check.that(list).isNullOr().hasSize(0);
Check.that(args).named("arguments").isNotEmpty(); 
```

到目前为止，这些检查的语义是它们还*隐式*断言参数不为空。要允许 null，可以使用`isNullOr()`第二个示例中的修饰符方法。

我要添加的下一件事是支持这样的检查反转：

```
Check.that(name).not().matches("hello .*!"); 
```

但是现在我觉得默认的 nullness 处理变得奇怪和不直观。反转测试的正确方法是现在允许 null 。要禁止 null，必须`isNotNull()`明确地预先检查：

```
Check.that(name).isNotNull().not().matches("hello .*!"); 
```

因此，我正在考虑更改语义，以便*始终*需要*显式*检查空值。我知道一个也这样做的项目：[Bean Validation](http://jcp.org/en/jsr/detail?id=303)。但不利的一面是，这可能会使大约 90% 的检查长 12 个字符，因为 null 通常是无效的参数。

所以，长话短说：支持和反对隐式空值检查的论据是什么？也许有任何其他库或标准可以这样做或以其他方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:02:09.367

我会保持 API 相当简单，并且对方法调用顺序*不敏感——基本上是一种*[流畅的](http://en.wikipedia.org/wiki/Fluent_interface) [构建器](http://en.wikipedia.org/wiki/Builder_pattern)模式。为此，请进行以下更改：

*   使其有状态（使用实例而不是静态方法）
*   进行最后一次方法调用的实际检查

每个方法调用都会建立要执行的标准，然后最后执行检查。

像这样：

```
new Check().matches("hello .*!").hasLengthBetween(0, 20).check(name); 
```

这也将允许重用`Check`实例——这是您的无状态 ( `static`) 版本无法做到的。

再者，如果方法调用的顺序无关紧要，则完全避免使用“逻辑运算符”方法，这只会导致悲痛，你在哪里停下来？考虑这个荒谬的场景：

```
new Check().matches("hello .*!").hasLengthBetween(0, 20)
    .and().openBracket().isLowerCase().or().containsNumbers().closeBracket(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T15:44:37.823

我想我找到了一个很好的折衷方案：所有检查*都*进行隐式 null 检查**，但** `not()`只反转实际检查而*不是 null 检查*。这样，我可以写

```
Check.that(message).not().containsAny(badWords); 
```

并假设消息既非空也不包含任何坏词。我认为这涵盖了 90% 以上的用例。

当然，我仍然可以通过编写明确地允许 null

```
Check.that(message).isNullOr().not().containsAny(badWords); 
```

第二个优点是这种设计将空值问题与其他检查分开，这可能也更直观。

# jquery - 嵌入式 youtube 播放器未静音

> ID：12552605
> 
> 赞同：0
> 
> 时间：2012-09-23T13:08:35.177
> 
> 标签：jquery, html, youtube, tubular

我正在使用将 YouTube 视频作为背景播放的 Tubular jQuery 插件，并且我试图在后台静音视频，默认情况下，在查看脚本代码时脚本应该这样做，但由于某些奇怪的原因它没有。

这是代码：

```
/* jQuery tubular plugin
|* by Sean McCambridge
|* http://www.seanmccambridge.com/tubular
|* Copyright 2012
|* licensed under the MIT License
|* Enjoy.
|* 
|* Thanks,
|* Sean */

// default params
var videoWidth = 853; // needed a default value -- this is overwritten almost immediately
var videoRatio = 16/9; // either 4/3 or 16/9 -- tweak as needed
var defaultDiv = 'wrapper';

jQuery.fn.tubular = function(videoId,wrapperId) {
    wrapperId = (typeof(wrapperId) == undefined) ? 'wrapper' : wrapperId;
    t = setTimeout("resizePlayer()",1000); // this is hacky, but i couldn't figure out why the yt player was behind

    jQuery('html,body').css('height','100%');
    jQuery('body').prepend('<div id="yt-container" style="overflow: hidden; position: fixed; z-index: 1;"><div id="ytapiplayer">You need Flash player 8+ and JavaScript enabled to view this video.</div></div><div id="video-cover" style="position: fixed; width: 100%; height: 100%; z-index: 2;"></div>');
    jQuery('#' + wrapperId).css({position: 'relative', 'z-index': 99});

    // initiailize vars
    var ytplayer = 0;
    var pageWidth = 0;
    var pageHeight = 0;
    var videoHeight = videoWidth / videoRatio;
    var duration;

    // iframe embedded yt player
    var iframe = '<iframe id="myytplayer" width="' + videoWidth + '" height="' + videoHeight + '" src="http://www.youtube.com/embed/' + videoId + '?autoplay=1&controls=0&modestbranding=1&showinfo=0&version=3&wmode=transparent&loop=1&playlist=' + videoId + '" frameborder="0" allowfullscreen></iframe>';

    /*

    // swfobject embed yt player
    var params = { allowScriptAccess: "always", wmode: "transparent" };
    var atts = { id: "myytplayer" };
    swfobject.embedSWF("http://www.youtube.com/v/" + videoId + "?enablejsapi=1&playerapiid=ytplayer&loop=1", "ytapiplayer", videoWidth, videoHeight, "8", null, null, params, atts);

    */

    jQuery('#ytapiplayer').html(iframe);

    jQuery(window).resize(function() {
        resizePlayer();
    });

    return this;
}

// player calls this function on ready
function onYouTubePlayerReady(playerId) {
    ytplayer = document.getElementById("myytplayer");
    ytplayer.setPlaybackQuality('medium');
    ytplayer.mute();
}

function resizePlayer() {
    var newWidth = jQuery(window).width(); // original page width
    var newHeight = jQuery(window).height(); // original page height
    jQuery('#yt-container, #video-cover').width(newWidth).height(newHeight);
    if (newHeight > newWidth / videoRatio) { // if window ratio becomes taller than video
        newWidth = newHeight * videoRatio; // overflow video to sides instead of bottom
    }
    jQuery('#myytplayer').width(newWidth).height(newWidth/videoRatio);
} 
```

如您所见，它一直等到 Youtube 播放器准备就绪，然后继续：

```
// player calls this function on ready
function onYouTubePlayerReady(playerId) {
    ytplayer = document.getElementById("myytplayer");
    ytplayer.setPlaybackQuality('medium');
    ytplayer.mute();
} 
```

但是，当视频播放器加载时，它不会执行任何这些功能，而是会在音频未静音的情况下开始播放。我将如何解决这个问题？谢谢你。

# image-processing - Open CV 特征提取和图像匹配

> ID：12552614
> 
> 赞同：6
> 
> 时间：2012-09-23T13:10:04.770
> 
> 标签：image-processing, opencv, textures, shape

我想开发一个自动图像注释器和一个图像搜索应用程序。我尝试使用 Open CV 教程中的颜色直方图。它没有给出好的结果。我使用了颜色直方图，以便我可以轻松区分夜景或日景。

我还想结合形状和纹理特征来匹配图像。我没有找到使用 Open CV 从图像中提取形状和纹理特征的任何东西。请让我知道如何使用 Open CV 提取这些特征，或者是否有任何其他库可以帮助我提取这些特征。

我已经尝试过 SURF 功能，但对于不同的图像，它们并没有很好的匹配。就像在完全不同的上下文中的两个马图像。

我有一组来自 Mir Flick 数据集的 15K 注释图像，我有一组大约 100 个标签。我已经阅读了许多研究论文，这些论文给出了解决这个问题的理论方法，但我无法实现它。

提前致谢 。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-24T20:42:42.430

你想做很多困难的事情，却不知道你将采用哪种方法。我建议您开始阅读有关该主题的本[教程。](https://stackoverflow.com/q/12283675/744859)

您需要提取特征，获取这些特征的描述符以便被识别。然后进行匹配。从比赛中，您可以获得 3D 位置。那是开始。一旦你能够做到这一点，你就可以专注于更困难的问题。

# android - Memory leak with setOnClickListener(this) and setOnClickListener(new View.OnClickListener(){})

> ID：12552616
> 
> 赞同：5
> 
> 时间：2012-09-23T13:10:14.313
> 
> 标签：android, memory-leaks

I read about [avoiding memory leaks](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)

to avoid context-related memory leaks, remember the following:

*   Try using the `context-application` instead of a `context-activity`

And I have 2 questions :

1.  If I use `setOnClickListener(this)`, will it cause a memory leak?
2.  If I use `setOnClickListener(new View.OnClickListener(){})`, will it cause a memory leak?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-12-21T02:18:54.370

*1 - 如果我使用 setOnClickListener(this)，会导致内存泄漏吗？*

没有必要，“this”实现了 OnClickListener，如果你自己不泄漏......例如在**onClick**中运行线程会泄漏，使用非静态内部类会泄漏，所以答案是 setOnClickListener(this) 仅在以下情况下才会泄漏您的**onClick(View view)**实现泄漏。

*2 - 如果我使用 setOnClickListener(new View.OnClickListener(){})，会导致内存泄漏吗？*

是同一个问题，取决于你为 OnClickListener.onClick 实现了什么......如果你实现了**新的 View.OnclickListener** ，请不要泄漏类......你会没事的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:17:37.903

I would say you can use both. Although, if you have more than one buttons (or any other widget), better to use first solution with getId() to diference them, the second one creates a diferent listener (object) for each button , so it reserves more memory. I dont think any of them causes memory leaks, because when you destroy an activity, and no links left for it, java GC gives back that memory (the listener objects) to dalvik.

hope it helps:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-05T09:01:23.170

这可能有点晚了，但是我想将其添加到上面的答案中：这取决于您在 OnClickListener 中做什么，假设您引用的是片段父级的 Activity 并且您为片段内的视图重新设置此 OnClickListener 则您可能需要删除您的引用，否则您有泄漏内存的风险：

```
onSettingsHeaderMenuItemClickedListener = View.OnClickListener {
            GuidedStepSupportFragment.add(requireActivity().supportFragmentManager, SettingsFragment.newInstance(), android.R.id.content)
} 
```

例如，上面的代码引用了父activity内部的fragment manager，并且发生在一个fragment中，所以这个引用必须被清除，否则它会将整个activity和fragment一起泄漏！

我更喜欢使用我可以从[Google architecture components sample](https://github.com/android/architecture-components-samples/blob/main/GithubBrowserSample/app/src/main/java/com/android/example/github/util/AutoClearedValue.kt)中挑选的 autoCleared 委托来解决这个问题。

因此，当在片段内并需要来自活动的引用时，单击侦听器的整个实现将类似于以下代码：

```
 class SomeFragment{
        private var onSettingsHeaderMenuItemClickedListener by autoCleared<View.OnClickListener>()
        fun onViewCreated(){
            onSomethingItemClickedListener = View.OnClickListener {
                GuidedStepSupportFragment.add(requireActivity().supportFragmentManager, SettingsFragment.newInstance(), android.R.id.content)
            }
            findViewById<View>(R.id.header_item_settings).setOnClickListener(onSettingsHeaderMenuItemClickedListener)
        }
    } 
```

# javascript - lbl：打破 lbl；在 JavaScript 中

> ID：12552620
> 
> 赞同：0
> 
> 时间：2012-09-23T13:11:27.280
> 
> 标签：javascript

显然，`lbl: break lbl;`在 JavaScript 中是完全有效的（但不是`lbl: continue lbl;`）。

这个结构有什么不为人知的用途吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:32:52.050

您可以在任何陈述之前添加标签。[正如boltclock](https://stackoverflow.com/users/106224/)在问题的评论中`continue`所说的那样，只允许在循环内（for，for-in，while，do-while） 。可以在循环、开关语句和任何语句中使用（正如[rob-w](https://stackoverflow.com/users/938089/)已经评论过的）。`break`

```
lbl: break lbl; 
```

上述说法是有效的。正如[frederic-hamidi](https://stackoverflow.com/users/464709/frederic-hamidi)已经评论的那样，“它会脱离自身”并且本身并不是很有用，但请参见下面的示例，了解它如何有用。

```
lbl: continue lbl; 
```

上述语句无效，因为它不是循环。

如何在块中使用**中断** ***标签***的示例：

```
function test() {
  var x='';
  lb1: {
    x+='1';
    if(x.length >2) break lb1;
    x+='2';
  }
  lb2: {
    x+='3';
    if(x.length >2) break lb2; //Can't break to lb1 because it isn't inside this block
    x+='4';
  }
  console.log(x);
}

test(); 
```

输出：

> 123

这是一个如何在循环中使用**中断** ***标签的示例：***

```
outer: for(var idxo=0; idxo < 5;++idxo) {
  inner: for(var idxi=0; idxi < 5;++idxi) {
    if (idxi==3) break outer;
    console.log(idxo,idxi);
  }
} 
```

输出：

> 0 0, 0 1, 0 2

这是一个如何在循环中使用**continue** ***标签的示例：***

```
outer: for(var idxo=0; idxo < 5;++idxo) {
  inner: for(var idxi=0; idxi < 5;++idxi) {
    if (idxi==3) continue outer;
    console.log(idxo,idxi);
  }
} 
```

输出：

> 0 0, 0 1, 0 2, 1 0, 1 1, 1 2, 2 0, 2 1, 2 2, 3 0, 3 1, 3 2, 4 0, 4 1, 4 2

[ECMA262:5 12.12](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)

> 12.12 标记语句
> 
> **句法**
> 
> 标签声明：
> 
> 标识符：声明
> 
> **语义**
> 
> 声明可以以标签为前缀。带标签的语句仅与带标签的 break 和 continue 语句一起使用。ECMAScript 没有 goto 语句。
> 
> 如果一个 ECMAScript 程序包含一个 LabelledStatement，该 LabelledStatement 由具有相同标识符的 LabelledStatement 包围，则认为它在语法上不正确。这不适用于出现在 FunctionDeclaration 主体中的标签，该标签直接或间接嵌套在带标签的语句中。
> 
> 产生式 Identifier : Statement 通过将 Identifier 添加到 Statement 的标签集然后评估 Statement 来评估。如果 LabelledStatement 本身有一个非空标签集，这些标签也会在评估之前添加到 Statement 的标签集。如果 Statement 的计算结果是 (break, V, L)，其中 L 等于 Identifier，则生成结果为 (normal, V, empty)。
> 
> 在评估 LabelledStatement 之前，包含的 Statement 被认为拥有一个空标签集，除非它是 IterationStatement 或 SwitchStatement，在这种情况下，它被认为拥有一个由单个元素组成的标签集，空。

# java - 抛出 NullPointerException 并且程序未按预期终止

> ID：12552621
> 
> 赞同：0
> 
> 时间：2012-09-23T13:11:35.967
> 
> 标签：java, arrays, data-structures, queue, circular-buffer

我正在创建一个证券交易所类型的程序，到目前为止，我的输入已经正常工作，因此它可以正确地接受用户的命令。然而，它对输入的作用并没有按预期工作。我感到困惑的第一件事是为什么在我运行代码时它会抛出 NullPointerException。

基本上，该程序将输入 3 个内容，然后是它们之间的空格。因此，例如，我想以每股 20 美元的价格购买 30 股，我会输入如下输入：

b 30 20

然后它将它分成 3 个部分并将其存储到一个数组中。之后它将比较数组的第一个索引以查看程序应该做什么，在本例中它将购买，因此它将调用购买方法并将份额数量和份额值存储到我的 CircularArrayQueue 中。

它获取存储到节点中的份额值和份额数量，但是当我尝试使用我的 CirularArrayQueue 调用入队方法以将节点存储到队列中时，它给了我一个 NullPointerException。

我遇到的另一个问题是程序的终止。当程序看到输入的第一个索引值为“q”时，程序应该终止。我做了一个while循环，说明当布尔退出为假时它将循环。然后在 while 循环中，我做了一个 if 语句来检查 stockParts[0] 的值是否为“q”。如果是这样，它会将 quit 的值更改为 true 以便它可以结束循环，但由于某种原因它没有终止并且它仍在循环。

几个小时以来，我一直在为这些问题摸不着头脑，但我似乎找不到问题的根源。有人可以帮助我吗？以下是我的主类和 CircularArrayQueue 类的代码：

```
import java.util.Scanner;
import java.lang.Integer;

public class StockTran {
String command = "";
String[] stockParts = null;
CircleArrayQueue Q;
boolean quit = false;

public StockTran(String inputCommand) {
    try {
        Scanner conReader = new Scanner(System.in);
        this.command = inputCommand.toLowerCase();
        this.stockParts = command.split("\\s"); // splits the input into three parts

        buyShares(Integer.parseInt(stockParts[1]), Integer.parseInt(stockParts[2]));        //testing purpose only

        while (quit == false) {
            if (this.stockParts[0] == "q") {        // ends transaction and terminates program
                System.out.println("Share trading successfully cancelled.");
                quit = true;    
            }

            if (this.stockParts == null || this.stockParts.length > 3) {
                throw new Exception("Bad input.");
            }

            if (stockParts[0] == "b") {     // checks to see if it is a buying of shares
                int shares = Integer.parseInt(stockParts[1]);       // stores share amount
                int value = Integer.parseInt(stockParts[2]);        // stores selling value
                buyShares(shares, value);       // calls buyShares method and adds share to queue
            }
            else if (stockParts[0] == "s") {        // checks to see if it is a selling of shares
                int shares = Integer.parseInt(stockParts[1]);       // stores share amount
                int value = Integer.parseInt(stockParts[2]);        // stores selling value
                sellShares(shares, value);      // calls sellShares method
            }
            else if (stockParts[0] == "c") {        // checks to see if it is capital gain
                capitalGain();      // calls capitalGain and calculates net gain
            }
            System.out.println("Enter your next command or press 'q' to quit: ");
            command = conReader.nextLine().toLowerCase();
            stockParts = command.split("\\s");
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
}

public void buyShares(int shareAmout, int shareValue) {     // takes in share total and values for each share
    Node temp = new Node(shareAmout, shareValue);       // stores values into node
    try {
        Q.enqueue(temp);        // enqueues the node into the CircularArrayQueue
        //System.out.println(Q.toString());

    } catch (FullQueueException e) {
        e.printStackTrace();
    }

}

public void sellShares(int shareAmount, int sharePrice) {   // ToDo

}

public int capitalGain() {  // ToDo
    return 0;
}

public static void main(String[] args) {
    String inputCommand = "";
    Scanner mainReader = new Scanner(System.in);

    System.out.println("Enter 'b' to purchase share, 's' to sell share, 'c' for capital gain, or 'Q' to quit: ");
    inputCommand = mainReader.nextLine();

    StockTran tran = new StockTran(inputCommand);
}
} 
```

```
public class CircleArrayQueue implements Queue {
protected Node Q[];     // initializes an empty array for any element type
private int MAX_CAP = 0;        // initializes the value for the maximum array capacity
private int f, r;

public CircleArrayQueue(int maxCap) {
    MAX_CAP = maxCap;
    Q = new Node[MAX_CAP];  // sets Q to be a specific maximum size specified
    f = 0;      // sets front value to be 0
    r = 0;      // sets rear value to be 0;
}

public int size() {
    return (MAX_CAP - f + r) % MAX_CAP;     // returns the size of the CircularArrayQueue
}

public boolean isEmpty() {      // if front and rear are of equal value, Queue is empty
    return f == r;
}

public Node front() throws EmptyQueueException {        // method to get the front value of the CircularArrayQueue
    if (isEmpty()) throw new EmptyQueueException("Queue is empty.");
        return Q[f];        // returns object at front of CircularArrayQueue
}

public Node dequeue() throws EmptyQueueException {  // method to remove from the front of the CircularArrayQueue
    if (isEmpty()) throw new EmptyQueueException("Queue is empty.");
        Node temp = Q[f];       // stores front object in local variable
        Q[f] = null;        // sets the value to be null in the array
        f = (f + 1) % MAX_CAP;      // sets the new front value to be this
        return temp;        // returns the object that was originally in the front
}

public void enqueue(Node element) throws FullQueueException {       // method to add to the end of the CircualarArrayQueue
    if (size() == MAX_CAP - 1) throw new FullQueueException("Queue has reached maximum capacity.");
        Q[r] = element;     // stores the new element at the rear of array
        r = (r + 1) % MAX_CAP;      // sets the new rear value to be the location after element insertion
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:15:02.797

您还没有初始化引用 Q。因为它是一个字段变量，所以它默认初始化为 null。

```
 CircleArrayQueue Q; 
```

当你遇到这样的问题时，你必须调试它。一种信息来源是异常的堆栈跟踪，它将告诉您异常是在哪里引发的。您还可以要求开发环境中的调试器在引发异常时自动停止。

其次，在 Java 中比较字符串时，使用 equals() 方法而不是 == 运算符。equals() 方法比较对象值。== 运算符比较指向对象的引用的值。您可以拥有两个具有不同参考值的相等对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:17:58.670

初始化你的 CircleArrayQueue Q. 如果你不初始化它。它采用 null 作为默认值。

```
CircleArrayQueue q= new CircleArrayQueue(size); 
```

# android - Android 手持设备上的 SSL 错误/警告，但桌面浏览器上没有

> ID：12552623
> 
> 赞同：-3
> 
> 时间：2012-09-23T13:11:59.527
> 
> 标签：android, apache, ssl, centos, ssl-certificate

当我在桌面上的 Chrome 上浏览我的网站[https://eightpointnine.com](https://eightpointnine.com)时，我没有遇到问题，但是当我使用 Chrome 浏览器（或默认浏览器）在我的 android 手机上访问相同的 URL 时，我收到一条错误消息，告诉我证书不是来自受信任的机构（它来自 globalsign）。任何想法我做错了什么？

我正在运行 Apache 服务器我有一个虚拟主机，其中提到了“SSLCertificateChainFile”，如果这有助于追踪问题。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T20:16:28.247

最好的猜测是这两个浏览器具有不同的受信任的根 CA 列表，并且颁发者包含在桌面的证书存储中，但不包含在 Android 设备上的存储中。

底线，服务器可能配置正确，这主要是客户端问题，您必须将颁发 CA 添加到失败客户端的受信任列表中，或者从您的客户群信任的不同提供商处获取证书.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T20:48:02.620

除了您的桌面和您的手机可能有不同的可信 CA 集这一事实之外，您的证书链是不完整的（根据[Qualys SSL Labs 测试](https://www.ssllabs.com/ssltest/)）：`SSLCertificateChainFile`. 您应该以正确的顺序包含所有中间证书。

# c# - 强制转换、解析和转换之间的区别

> ID：12552625
> 
> 赞同：13
> 
> 时间：2012-09-23T13:12:35.300
> 
> 标签：c#

我一直在研究一些代码。我有一个问题：强制转换、解析和转换之间有什么区别？我们什么时候可以使用它们？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-23T13:18:23.777

强制转换是当您获取一种类型的变量并将其更改为另一种类型时。您只能在某些情况下这样做，例如：

```
string str = "Hello";
object o = str;
string str2 = (string)o;  // <-- This is casting 
```

强制转换*不会*更改变量的值 - 值保持相同类型（字符串“Hello”）。

转换是从一种类型中获取一个*值*并将其转换为另一种类型：

```
 double d = 5.5;
 int i = (int)d;    // <---- d was converted to an integer 
```

请注意，在这种情况下，转换是以强制转换的形式完成的。

解析是获取一个字符串并通过了解其内容将其转换为不同的类型。例如，将字符串“123”转换为数字 123，或将字符串“Saturday, September 22nd”转换为 DateTime。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-23T13:28:59.373

**Casting**：告诉编译器一个对象实际上是别的东西而不改变它（尽管可能会导致一些数据丢失）。

```
object obj_s= "12345";
string str_i = (string) obj; // "12345" as string, explicit

int small = 12345;
long big = 0;
big = small; // 12345 as long, implicit 
```

**Parsing**：告诉程序解释（在运行时）一个字符串。

```
string int_s = "12345";
int i = int.Parse(int_s); // 12345 as int 
```

**转换**：告诉程序使用内置方法来尝试更改可能不能简单互换的类型。

```
double dub = 123.45;
int i = System.Convert.ToInt32(dub); // 123 as int 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T13:20:35.547

这是三个具有特定用途的术语：

*   铸造 - 改变一个`type`到另一个。为了做到这一点，类型必须*兼容*：`int`-> `object`; `IList<T>`->`IEnumerable<T>`
*   解析 - 通常是指读取字符串并提取有用的部分
*   转换 - 类似于强制转换，但通常转换将涉及将一种类型更改为其他不兼容的类型。一个例子是将对象转换为字符串。

从一种类型转换到另一种类型需要某种形式的兼容性，通常通过继承或实现接口。强制转换可以是隐式的或显式的：

```
class Foo : IFoo {
   // implementations
}

// implicit cast
public IFoo GetFoo() {
   return Foo;
}

// explicit cast
public IFoo GetFoo() {
   return Foo as IFoo;
} 
```

解析的方法有很多。我们阅读了 XML 解析；一些类型有`Parse`和`TryParse`方法；然后有时我们需要解析字符串或其他类型来提取“我们关心的东西”。

```
int.Parse("3") // returns an integer value of 3
int.TryParse("foo", out intVal) // return true if the string could be parsed; otherwise false 
```

转换可能需要将一种类型更改为另一种不兼容的类型。这也可能涉及一些解析。转换示例通常与 IMO 非常相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-29T12:25:58.760

不同的人用它来表示不同的东西。在 .net 世界之外不必是真的，但这是我在阅读 Eric Lippert 的博客的 .net 上下文中所理解的：

从一种形式到另一种形式的所有类型转换都可以称为*转换*。一种分类方式可能是

1.  **隐含的——**

    一个。**表示改变**（也称为强制）

    ```
    int i = 0;
    double d = i;

    object o = i; // (specifically called boxing conversion)
    IConvertible o = i; // (specifically called boxing conversion) 
    ```

    需要隐式转换运算符，转换总是成功（隐式转换运算符永远不应该抛出），更改正在转换的对象的引用标识。

    湾。**表示保留**（也称为隐式引用转换）

    ```
    string s = "";
    object o = s; 

    IList<string> l = new List<string>(); 
    ```

    仅对引用类型有效，从不更改被转换对象的引用标识，转换始终成功，在编译时保证，没有运行时检查。

2.  **显式**（也称为强制转换）-

    一个。**表示变化**

    ```
    int i = 0;
    enum e = (enum)i;

    object o = i;
    i = (int)o; // (specifically called unboxing conversion) 
    ```

    需要显式转换运算符，更改被转换对象的引用标识，转换可能成功也可能不成功，运行时检查兼容性。

    湾。**表示保留** （也称为显式引用转换）

    ```
     object o = ""; 
     string s = (string)o; 
    ```

    仅对引用类型有效，从不更改被转换对象的引用标识，转换可能成功也可能不成功，运行时检查兼容性。

虽然转换是*语言级别*的构造，但*Parse*在框架级别的意义上是完全不同的东西，或者换句话说，它们是为从输入获取输出而编写的*自定义方法*`int.Parse`，例如接受 a`string`并返回 a `int`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T13:20:23.063

强制转换（强制类型转换需要兼容） 数据类型之间的转换可以使用强制转换显式完成

```
static void _Casting()
{
    int i = 10;
    float f = 0;
    f = i;  // An implicit conversion, no data will be lost.
    f = 0.5F;
    i = (int)f;  // An explicit conversion. Information will be lost.
} 
```

parsing（解析是不同类型之间的转换：）将一种类型转换为另一种类型可以称为解析uisng int.parse

```
int num = int.Parse("500"); 
```

遍历XML之类的数据项也可以称为解析

当涉及到用户定义的转换时，这通常需要返回不同的对象/值。用户定义的转换通常存在于值类型而不是引用类型之间，因此这很少成为问题。

使用 Convert 类实际上只是帮助您解析它

有关更多信息，请参阅[http://msdn.microsoft.com/en-us/library/ms228360%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/ms228360%28VS.80%29.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-23T13:49:47.433

[**铸造：**](http://www.dotnetperls.com/cast)或解析

强制转换显式调用从一种类型到另一种类型的转换运算符。铸造变量并不简单。一组复杂的规则解决了强制转换。在某些情况下，数据会丢失，并且强制转换无法反转。在其他情况下，执行引擎中会引发异常。 `int.Parse`是一种最简单的方法，但它会在无效输入时引发异常。

[**尝试解析**](http://www.dotnetperls.com/int-parse)

`int.TryParse`是 C# 语言中解析整数的最有用的方法之一。此方法的工作方式与`int.Parse`. `int.TryParse`里面有try and catch结构。所以，它不会抛出异常

[**兑换：**](http://msdn.microsoft.com/en-us/library/system.convert%28v=vs.71%29.aspx)

将基本数据类型转换为另一种基本数据类型。Convert.ToInt32 及其兄弟 Convert.ToInt16 和 Convert.ToInt64 实际上是 int.Parse 方法的静态包装方法。

许多程序员推荐使用`TryParse`代替`Convert`或。`Cast`

来源：[www.dotnetperls.com](http://www.dotnetperls.com)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-23T13:38:36.117

这个问题其实挺复杂的……

通常，*强制转换*只是告诉运行时将一种类型更改为另一种类型。这些必须是兼容的类型。例如 an`int`总是可以表示为 a`long`所以可以将它转换为 a `long`。一些演员表有副作用。例如，`float`如果将 a 强制转换为 a ，则会降低其精度`int`。因此`(int)1.5f`将导致 int 值 1。强制转换通常是更改类型的最快方法，因为它是单个 IL 运算符。例如，代码：

```
 public void CastExample()
    {
        int i = 7;
        long l = (long)i;
    } 
```

通过运行 IL 代码执行转换：

```
conv.i8 //convert to 8-byte integer (a.k.a. Int64, a.k.a. long). 
```

* * *

*解析*是一些函数，它接受一种类型并返回另一种类型。它是一个实际的代码函数，而不仅仅是一个 IL 运算符。这通常需要更长的时间来运行，因为它运行多行代码。

例如，这段代码：

```
 public void ParseExample()
    {
        string s = "7";
        long l = long.Parse(s);
    } 
```

运行 IL 代码：

```
call       int64 [mscorlib]System.Int64::Parse(string) 
```

换句话说，它调用了一个实际的方法。在内部，Int64 类型提供了该方法：

```
 public static long Parse(String s) {
        return Number.ParseInt64(s, NumberStyles.Integer, NumberFormatInfo.CurrentInfo); 
    } 
```

和 Number.Parse：

```
 [System.Security.SecuritySafeCritical]  // auto-generated 
    internal unsafe static Int64 ParseInt64(String value, NumberStyles options, NumberFormatInfo numfmt) {
        Byte * numberBufferBytes = stackalloc Byte[NumberBuffer.NumberBufferBytes]; 
        NumberBuffer number = new NumberBuffer(numberBufferBytes); 
        Int64 i = 0;

        StringToNumber(value, options, ref number, numfmt, false);

        if ((options & NumberStyles.AllowHexSpecifier) != 0) {
            if (!HexNumberToInt64(ref number, ref i)) { 
                throw new OverflowException(Environment.GetResourceString("Overflow_Int64"));
            } 
        } 
        else {
            if (!NumberToInt64(ref number, ref i)) { 
                throw new OverflowException(Environment.GetResourceString("Overflow_Int64"));
            }
        }
        return i; 
    } 
```

等等......所以你可以看到它实际上是在做很多代码。

* * *

现在事情变得更复杂的是，尽管强制转换通常是最快的，但类可以覆盖隐式和显式强制转换运算符。例如，如果我编写课程：

```
public class CastableClass
{
    public int IntValue { get; set; }

    public static explicit operator int(CastableClass castable)
    {
        return castable.IntValue;
    }
} 
```

我已经覆盖了显式转换运算符 for `int`，所以我现在可以这样做：

```
 public void OverridedCastExample()
    {
        CastableClass cc = new CastableClass {IntValue = 7};
        int i = (int)cc;
    } 
```

这*看起来*像一个普通的演员表，但实际上它调用了我在课堂上定义的方法。IL代码是：

```
call       int32 UnitTestProject1.CastableClass::op_Explicit(class UnitTestProject1.CastableClass) 
```

* * *

所以无论如何，你通常想尽可能地投射。然后解析，如果你不能。

# r - 在 R 中附加数据集

> ID：12552627
> 
> 赞同：1
> 
> 时间：2012-09-23T13:13:01.037
> 
> 标签：r, merge

我有 2 个数据集：

**数据1：**

```
Var1 Var2   Var3    Var4
10    10      2   3
9      2      8   3
6      4      4   8
7      3     10   8 
```

**数据2：**

```
Var1 Var5   Var3    Var6
  3    6      6   4
  1    2      5   1
  9    2      2   9
  2    6      3   2 
```

现在我想附加这两个数据集

**最终数据：**

```
Var1  Var2    Var3  Var4  Var5 Var6
10      10       2     3        
9        2       8     3        
6        4       4     8        
7        3      10     8        
3                      4     6    6
1                      1     2    5
9                      9     2    2
2                      2     6    3 
```

我不能使用 rbind 来创建这个数据集。谁能告诉我创建这个数据集的方法？另外，假设我想附加多个（超过 2 个）数据集。程序是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T17:07:39.560

我推荐包的`rbind.fill`功能`plyr`：

```
library(plyr)
rbind.fill(Data1, Data2)

#  Var1 Var2 Var3 Var4 Var5 Var6
#1   10   10    2    3   NA   NA
#2    9    2    8    3   NA   NA
#3    6    4    4    8   NA   NA
#4    7    3   10    8   NA   NA
#5    3   NA    6   NA    6    4
#6    1   NA    5   NA    2    1
#7    9   NA    2   NA    2    9
#8    2   NA    3   NA    6    2 
```

这种技术的主要优点是它不限于两个数据帧，而是允许组合任意数量的数据帧。

如果仍然需要从磁盘读取数据，您可以执行以下操作：

```
file_list = list.files()
data_list = lapply(file_list, read.table)
data_combined = do.call("rbind.fill", data_list) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T13:47:46.610

```
merge(Data1, Data2, all=TRUE, sort=FALSE)

  Var1 Var3 Var2 Var4 Var5 Var6
1   10    2   10    3   NA   NA
2    9    8    2    3   NA   NA
3    6    4    4    8   NA   NA
4    7   10    3    8   NA   NA
5    3    6   NA   NA    6    4
6    1    5   NA   NA    2    1
7    9    2   NA   NA    2    9
8    2    3   NA   NA    6    2 
```

编辑：一种组合多个帧的方法，详见[此处](https://stackoverflow.com/a/8096127/1465387)。

## 合并超过 2 帧

```
Data3

  Var1 Var3 Var5 Var6
1    2    6    4    1
2   10    1    6    1
3    1    6    3    1
4    9    5    5    7 
```

我们需要将您的数据放入一个列表并使用一个名为`reshape`.

```
datalist <- list(Data1, Data2, Data3)
library(reshape)

merge_recurse(datalist)
   Var1 Var3 Var2 Var4 Var5 Var6
1    10    2   10    3   NA   NA
2     9    8    2    3   NA   NA
3     6    4    4    8   NA   NA
4     7   10    3    8   NA   NA
5     3    6   NA   NA    6    4
6     1    5   NA   NA    2    1
7     9    2   NA   NA    2    9
8     2    3   NA   NA    6    2
9     2    6   NA   NA    4    1
10   10    1   NA   NA    6    1
11    1    6   NA   NA    3    1
12    9    5   NA   NA    5    7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T17:31:33.547

```
# Open a new directory and keep only the data files to be combined
combinedfiles <- function(){
  # nullVar: Creating a Null Variable using as.null function
    nullVar <- function(x){ 
    x <- getwd(); 
    x <- as.null(x); 
    }

  # readTab: Read file using read.table function
    readTab <- function(y) { 
    read.table(y, header=TRUE, sep = " ") 
    }

    objectcontent <- nullVar(x);    

    for (i in 1:length(list.files(getwd()))) {
    y <- list.files(getwd())[i];
    objectcontent <- rbind(objectcontent, readTab(y));
    i <- i + 1
    }
  return(objectcontent)
}

#Then type the following in the console
  combinedfiles() 
```

使用应用循环的版本（不受 rbind 减速的影响）：

```
combined_files = function(file_path, extension = "csv") {
   require(plyr)
   file_list = list.files(file_path, pattern = extension)
   data_list = lapply(file_list, read.table, header = TRUE, sep = " ")
   combined_data = do.call("rbind.fill", data_list)
   return(combined_data)
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T14:27:15.733

试试这个：

```
data1 <- as.data.frame(read.table("data1", header=TRUE, sep=" "))
data2 <- as.data.frame(read.table("data2", header=TRUE, sep=" "))
merge(data1, data2, all=TRUE, all.x=TRUE, all.Y=TRUE) 
```

# pip - 输出全局包的pip需求

> ID：12552631
> 
> 赞同：6
> 
> 时间：2012-09-23T13:13:15.983
> 
> 标签：pip, virtualenv, requirements.txt

我的 django 项目有一个虚拟环境，但是当我点击 时`pip freeze`，我得到了一个必须是全局站点包列表的东西，其中包含太多的包，比如 ubuntu 包和很多不相关的东西。无论 virtualenv 是否处于活动状态，都会发生这种情况。我的站点包列表看起来也有点苗条，所以我想知道 venv 是否一直在工作。

```
(env)~/code/django/ssc/dev/env/lib/python2.7/site-packages> ls
django
Django-1.4-py2.7.egg-info
easy-install.pth
pip-1.0.2-py2.7.egg
setuptools-0.6c11-py2.7.egg
setuptools.pth 
```

我的问题是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T13:21:47.057

如果您的虚拟环境可以访问系统的 site-packages 目录（即您使用`virtualenv --system-site-packages`），那么列表较长是正常的。

比较以下内容：

```
$ virtualenv --system-site-packages v1 && source v1/bin/activate
$ (v1) pip freeze | wc -l  # 100

$ virtualenv v2 && source v2/bin/activate
$ (v2) pip freeze | wc -l  # 2 
```

您可以尝试重新创建 virtualenv 吗？

或者，添加一个`no-global-site-packages.txt`文件应该告诉 pip 忽略全局站点包：

```
$ touch $VIRTUAL_ENV/lib/python${version}/no-global-site-packages.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-31T15:42:58.117

我不明白为什么评论中只留下了最简洁的选项。由于我几乎错过了它，因此我将其作为单独的答案放在这里，并进行了一些调整。`--local`如果您正在运行启用 system-site-packages 的虚拟环境，则可以使用 pip freeze 添加标志。所以，如果你有：

```
py -m venv --system-site-packages env 
```

为确保您没有将所有系统依赖项放入您的`requirements.txt`.

```
python -m pip freeze --local > requirements.txt 
```

另一个更复杂的选项，但仍然可行，因为依赖项不应该经常更改，将进入位于虚拟环境库中的 pyvenv.cfg 文件并手动更改：

```
include-system-site-packages = true/false 
```

# vba - 打开外部 EXE。使用 VBA PowerPoint 文件

> ID：12552638
> 
> 赞同：0
> 
> 时间：2012-09-23T13:14:41.467
> 
> 标签：vba, powerpoint

请帮助我使此代码有效。我想使用 Powerpoint VBA 打开一个外部 EXE 文件。

```
Sub open_test()
Dim FileName, FSO, MyFile
FileName = "C:\test.exe"
Set FSO = CreateObject("Scripting.FileSystemObject")
Set MyFile = FSO.OpenTextFile(FileName, 1)
End Sub 
```

没有编译器错误，但是当我执行宏时，它什么也不做……我还有其他替代代码吗？请帮助我，*谢谢*！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T15:00:18.427

如果您只想启动程序，请尝试使用

```
Sub open_test()
    Dim sFullPathToExecutable as String
    sFullPathToExecutable = "C:\test.exe"
    Shell sFullPathToExecutable 
End Sub 
```

# android - 调整从 url 下载的位图大小以适应 imageview 空间：质量下降

> ID：12552642
> 
> 赞同：0
> 
> 时间：2012-09-23T13:15:20.197
> 
> 标签：android

我知道围绕这个主题有很多问题，但我找不到完全适合我的问题的东西，所以我打开这个问题是为了至少在这里收集问题的各个方面。

开始吧！我有我的 imageview，这个 imageview 必须有固定的尺寸：

```
<ImageView
        android:id="@+id/my_image"
        android:layout_width="250dp"
        android:layout_height="170dp"
        android:layout_gravity="center_horizontal"
        android:layout_marginBottom="20dp"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:layout_marginTop="10dp"
        android:contentDescription="@string/cell_item_image"
        android:scaleType="fitXY" /> 
```

我的位图来自一个 url 并且是 .jpg 格式，所以我的代码是：

```
bitmap = BitmapFactory.decodeStream(conn.getInputStream()); 
```

它的尺寸为 435x312 像素，比我的屏幕密度大，因此缩放它不会导致质量下降……我怎么会得到一个模糊的图像？

有没有办法重新缩放位图并保持质量？

也许是比例类型中的 fitXY ？但是在代码或布局中缩放之间有什么区别？我在代码中看到很多人这样做，但是尝试得到完全相同的结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:27:33.780

编辑：阅读 .jpg 部分

尝试：

```
Options options = new BitmapFactory.Options();
options.inScaled = false;
Bitmap source = BitmapFactory.decodeResource(a.getResources(), path, options); 
```

如果这不起作用，请尝试在不缩放的情况下显示图像（这样您可以查看导致模糊的原因、图像的加载或显示/缩放）

# javascript - 抑制 JSLint Strict Violation 以在使用正确上下文调用的内部函数中使用 this

> ID：12552644
> 
> 赞同：1
> 
> 时间：2012-09-23T13:15:27.920
> 
> 标签：javascript, jslint

考虑这个简单的 javascript 代码 - [http://jsfiddle.net/mark69_fnd/c2DRP/](http://jsfiddle.net/mark69_fnd/c2DRP/)

使用 JSLint 验证代码会触发函数`this`内部使用的 jslint“严格违规”错误。`inner`但是，使用正确的非全局上下文调用该函数。

所以，我想知道如何为那个特定的函数抑制这个 JSLint 错误？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:22:51.137

JSLint 不支持这一点，您必须忽略它。[名为JSHint](http://www.jshint.com/)的社区分支有一个名为的选项`validthis`，可以在像您这样的情况下抑制警告：

> > 当代码在严格模式下运行并且您在非构造函数中使用它时，此选项会抑制有关可能的严格违规的警告。当您确定在严格模式下使用 this 是有效的（例如，如果您使用 Function.call 调用您的函数）时，您应该只在函数范围内使用此选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T20:02:31.137

您应该声明对“this”的引用，例如：

```
function f() {
  "use strict";
  var ref = this;

  function inner() {
    alert(ref.msg);
  }

  inner.call({ msg:'hello' });
} 
```

# android - SearchWidget 不调用 onSearchRequested()

> ID：12552645
> 
> 赞同：4
> 
> 时间：2012-09-23T13:15:29.113
> 
> 标签：android, search

我有一个带有搜索小部件和列表视图的活动。如果有人搜索，所有与查询不匹配的项目当然应该被删除。所以我想删除列表中的所有项目并用较小的列表填充它。因此，我尝试通过将 ArrayList 添加到 onSearchRequested 方法中的 Bundle 来将其传递给新的可搜索 Activity。但是当我执行搜索时不会调用此方法。

这是我得到的代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sign_player);

    // Associate searchable configuration with the SearchView
    SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
    SearchView searchView = (SearchView) findViewById(R.id.sv_sign_search_name);
    searchView.setSearchableInfo(searchManager
            .getSearchableInfo(getComponentName()));
    searchView.setIconifiedByDefault(false);
    searchView.setFocusable(false);
    // Get the intent, verify the action and get the query
    Intent intent = getIntent();

    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
        String query = intent.getStringExtra(SearchManager.QUERY);
        Bundle bundle = intent.getBundleExtra(SearchManager.APP_DATA);
        player = bundle.getParcelableArrayList("players");
        player = searchPlayers(query);
        showPlayers();
    } else {
        initializeScreen();
    }
}

@Override
public boolean onSearchRequested() {
     Bundle appData = new Bundle();
     appData.putParcelableArrayList("players", player);
     startSearch(null, false, appData, false);
     return true;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-13T02:25:02.077

您需要在 Manifest 中为可搜索的活动设置指定元数据。例如：

```
<activity android:name=".activity.SuperDuperActivity">
     <meta-data
          android:name="android.app.default_searchable"
          android:value=".activity.SearchResultsActivity"/>
</activity> 
```

然后在你的**SuperDuperActivity** onSearchRequested() 肯定会被调用。

# c# - 从 BaseClass 中的子类获取自定义属性（C# .NET 4.0）

> ID：12552646
> 
> 赞同：2
> 
> 时间：2012-09-23T13:15:43.460
> 
> 标签：c#, inheritance, attributes, custom-attributes

好的，编辑了代码以进行澄清：

问题：如何`[MyAttr("...")]`从...`TestClassOne/Two`访问属性`BaseClass.TheAttribute`？

除 TestClassOne/Two 之外的所有类都将编译到我的“核心”中，并作为开发平台交付给客户。TestClassOne/Two 是客户开发的，所以“核心”中不可能有TestClassOne/Two 的知识。

下面的代码被编译成“核心”并作为 dll 交付给客户。

```
[TestMethod()]
public void AttrTest()
{
    var one = new TestClassOne();
    var attrOne = one.MyTestProperty.TheAttribute;

    var two = new TestClassTwo();
    var attrTwo = two.MyTestProperty.TheAttribute;
}

public class MyAttr : Attribute
{
    private string _test;
    public MyAttr(string test)
    {
        this._test = test;
    }
}

public class BaseClass
{
    public string TheAttribute
    {
        get { 
            // Here I would like to get the "[MyAttr("...")]" from the classes in the bottom

            return null;
        }
    }
}

public class SubClass : BaseClass
{

} 
```

下面的代码是由客户开发的（使用我的 dll）

```
public class TestClassOne
{
    [MyAttr("Attribute one")]
    public SubClass MyTestProperty = new SubClass();
}

public class TestClassTwo
{
    [MyAttr("Attribute two")]
    public SubClass MyTestProperty = new SubClass();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:20:08.630

**编辑3：**

您可以遍历调用堆栈，在相关类的相关成员中查找相关属性。尝试这个：

```
public class MyAttr : Attribute
{
    private string _test;
    public MyAttr(string test)
    {
        this._test = test;
    }

    public string getAttr()
    {
        return _test;
    }
}

public class BaseClass
{
    private string theString;

    public BaseClass()
    {
        StackTrace callStack = new StackTrace();

        for ( int i = 0; i < callStack.FrameCount; i++ )
        {
            Type t = callStack.GetFrame(i).GetMethod().DeclaringType;
            foreach ( MemberInfo m in t.GetMembers().Where(x => typeof(BaseClass).IsAssignableFrom(x.Type)) )
            {
                foreach ( var z in  m.GetCustomAttributes(typeof(MyAttr)) )
                {
                    MyAttr theAttr = z as MyAttr;
                    if ( z!= null )
                    {
                        theString = z.getAttr();
                        return;
                    }
                }
            }
        }
    }

    public string Test
    {
        get { 
            return theString;
        }
    }
} 
```

这要求您的客户始终在声明它的类中初始化 SubClass 成员。如果他们开始派生`TestClassOne`或拥有它并`TestClassTwo`从初始化成员的公共类派生，则此代码将中断。

通过巧妙地使用反射，您可以扩展上述代码以涵盖更多用例，但这超出了本问题的范围。

**编辑2：**

不，我很抱歉，但你想要做的事情是不可能的。没有“正常”方法可以让一个实例`SubClass`知道它是在某个其他对象的成员字段中声明的，还是在数组中的元素中或堆栈中的临时变量中声明的，或者其他什么。因此，该实例无法访问声明它的成员字段的属性。

（我想您可能想尝试访问垃圾收集器以找出`this`对象在内存中的位置，但这可能超出了这个问题的范围，而且无论如何，我都不知道该怎么做。）

我怀疑您的问题完全出在其他地方。也许您需要要求您的客户制作`TestClassOne`和`TestClassTwo`派生公共抽象类。也许他们需要从`BaseClass`自己身上获得。也许您需要向构造函数添加参数。也许您需要完全提供不同的界面。除非您提供有关您的特定业务要求的更多信息，否则我们无法知道。

**编辑：**

要访问在 MyTest 成员上声明的属性，请尝试以下方式：

```
public class BaseClass
{
    public string Test
    {
        get { 
            var attr = typeof(Test).GetMembers().Where(x => x.Type == this.GetType()).First().GetCustomAttributes(true);
            return null;
        }
    }
} 
```

这将在类中搜索`Test`与该成员具有相同类型的成员`this`并查找该成员的属性。

（我没有我的 Visual Studio 来检查确切的`Where`语法，但它应该非常接近......）

**原答案：**

您的属性是在`MyTest`class 的成员上声明的`Test`。但是，你`GetCustomAttributes`在上课`SubClass`本身。

尝试这个：

```
[MyAttr("apa")]
public class SubClass : BaseClass
{

}

public class Test
{
    public SubClass MyTest = new SubClass();
} 
```

应该得到你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T13:22:53.137

您可以直接从 type 获取`Test`：

```
var result = typeof (Test)
               .GetField("MyTest", BindingFlags.Public | BindingFlags.Instance)
               .GetCustomAttribute<MyAttr>(); 
```

# ruby - DataMapper 日期时间条件

> ID：12552647
> 
> 赞同：2
> 
> 时间：2012-09-23T13:15:51.227
> 
> 标签：ruby, datetime, sinatra, datamapper

我正在使用带有 DataMapper MySql 数据库的简单 Sinatra Web 应用程序。我声明了一个`Post`带有属性的 Datamapper 类

```
property :created_at, DateTime 
```

（用 初始化`Time.now`），现在想要获取过去 7 天的所有帖子的计数。我的查询

```
lastweek_posts = Post.count(:created_at.gte => 1.week.ago)
lastweek_posts = Post.count(:conditions => ["created_at >= ?", Time.now.utc - 1.week]) 
```

但是所有返回的计数均为 0（数据库包含多个条目，其中 created_at 为今天）。什么是正确的查询？

提前谢谢了！

更新：

```
Post.all(:created_at.gte => 1.week.ago).length 
```

返回正确的值，但是这是一个糟糕的选择，因为它会从我的远程 sql 数据库中获取所有帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T13:46:21.483

好的，我发现了错误，我只是错过了我的 Sinatra 脚本中的 require ，正如['Counting' 下](http://datamapper.org/docs/find.html)`dm-aggregates`的文档中明确说明的那样。

我为这个感到抱歉！

# android - 如何在同一个 webview Android 中加载 webview 链接

> ID：12552648
> 
> 赞同：3
> 
> 时间：2012-09-23T13:15:51.070
> 
> 标签：android, web-applications, webview, hyperlink

我想构建一个没有PhoneGap的Android webApplication，我有一个问题：当我点击一个链接时，它会打开android默认浏览器......：那么如何在同一个webview Android中加载webview链接？

这是我的代码：

```
package com.example.mobilewebview;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.webkit.WebView;
//import android.webkit.WebViewClient;
import android.webkit.WebSettings;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        WebView myWebView = (WebView) findViewById(R.id.webview);
        WebSettings webSettings = myWebView.getSettings();
        webSettings.setJavaScriptEnabled(true);
        myWebView.loadUrl("http://m.google.com");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T13:45:18.093

您必须拦截您`WebView`可能拥有的 URL 链接才能进行自定义实现。

`WebViewClient`你必须为你创建一个`WebView`然后重写`public boolean shouldOverrideUrlLoading(WebView view, String url)`方法来实现这样的事情。

示例代码：

```
//web view client implementation
private class CustomWebViewClient extends WebViewClient {
    public boolean shouldOverrideUrlLoading(WebView view, String url) 
    {
        //do whatever you want with the url that is clicked inside the webview.
        //for example tell the webview to load that url.
        view.loadUrl(url);
        //return true if this method handled the link event
        //or false otherwise
        return true;
    }
}}

//in initialization of the webview:
....
webview.setWebViewClient(new CustomWebViewClient());
.... 
```

告诉我这是否有帮助。

# ruby - Self 和 proc.call 参数

> ID：12552653
> 
> 赞同：-1
> 
> 时间：2012-09-23T13:16:41.817
> 
> 标签：ruby, self

我知道已经有很多关于 的问题`self`，但我只是想确保我已经理解它。

```
def buttonPressed
    @action.call(self)
end 
```

1.  在这段代码中，`self`指的是`@action`（因为`@action`是调用方法的接收者）。是对的吗？

    ```
    { songList.start } 
    ```

2.  如果 proc 对象没有像这种情况下的参数，为什么要`prc.call self`作为参数给出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:41:33.947

I. 在类之外，`self`返回`main`type `Object`。在类内部，它将返回该类的当前实例。

二、在这个特定块的情况下，确实不需要`self`传递，但传递`self`意味着您也可以潜在地拥有`action`可以访问的 s `self`。

# php - 如何在 zend 表单中使用相同的字段验证进行添加和编辑操作？

> ID：12552660
> 
> 赞同：3
> 
> 时间：2012-09-23T13:17:24.967
> 
> 标签：php, zend-framework, zend-form, zend-validate

我是zend框架的新手。我正在 Zend 中开发一个简单的用户注册应用程序。我的应用程序中同时具有添加和编辑功能。我可以使用我的应用程序完美地添加新用户。但是当我尝试编辑密码以外的用户信息时，用于密码和密码确认字段的验证器会出错。只有当我想编辑密码以外的用户信息时，我才需要删除/禁用密码和密码确认字段的验证器。

我的表格：

```
$password = new Zend_Form_Element_Password('password');
        $password->setRequired(true)
        ->addFilter('StringTrim')
        ->addFilter('StripTags')
        ->addValidator('NotEmpty', false, array('messages'=>'password cannot be empty'))
        ->addValidator('StringLength', false, array(2, 20, 'messages'=>'password must be 2-20 character'))
        ->setLabel('Password:');
        $this->addElement($password);

        $confirmPassword = new Zend_Form_Element_Password('confirmPassword');
        $confirmPassword->setRequired(true)
        ->addFilter('StringTrim')
        ->addFilter('StripTags')
        ->addValidator('NotEmpty', false, array('messages'=>'password do not match'))
        ->addValidator(new Application_Validate_PasswordConfirmation())
        ->setLabel('Retype password'); 
```

我的验证器类：

```
class Application_Validate_PasswordConfirmation extends Zend_Validate_Abstract
{
     const NOT_MATCH = 'notMatch';

     protected $_messageTemplates = array(
     self::NOT_MATCH => 'Password confirmation does not match'
     );

     public function isValid($value, $context = null)
     {
         $value = (string) $value;
         $this->_setValue($value);

         if (is_array($context)) {
            if (isset($context['password']) && ($value == $context['password']))
            {
                return true;
            }
         } elseif (is_string($context) && ($value == $context)) {
                return true;
           }

         $this->_error(self::NOT_MATCH);
         return false;
     }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T16:56:32.143

```
 $modelUsers = new Model_Users();
    $userId = $this->_getParam('userId');

    if ($userId) {
        $populateData = array();

        $user = $modelUsers->fetch($userId);

        if ($user instanceof Model_User) {
            $populateData = $user->toArray();
        }
        $form = $this->_getAddForm($user->email, $user->username, $user->phone);
        $password = $this->getRequest()->getPost('password');
        if (trim($password) == '') {
            $form->getElement('password')
            ->setRequired(false)
            ->clearValidators();

            $form->getElement('confirmPassword')
            ->setRequired(false)
            ->clearValidators();
        }

    }
   else {
        $form = $this->_getAddForm($mail=null, $username=null, $phone=null);
   }
    $request = $this->getRequest();

    if ($request->isPost()) {

        $post = $request->getPost();
        if ($form->isValid($post)) {
            $values = $form->getValidValues($post); 
```

这就是我在@drew010 的帮助下绝对解决这个问题的方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T16:17:55.210

在编辑模式下提交表单时，在调用之前使用以下代码删除验证器`$form->isValid()`：

```
$password = $this->getRequest()->getPost('password');
if (trim($password) == '') { // password field empty, remove validators
    $form->getElement('password')
         ->setRequired(false)
         ->clearValidators();

    $form->getElement('confirmPassword')
         ->setRequired(false)
         ->clearValidators();
}

if ($form->isValid($this->getRequest()->getPost())) {
    // ...
} 
```

# mysql - MySQL集群数据节点不同步

> ID：12552664
> 
> 赞同：0
> 
> 时间：2012-09-23T13:17:57.930
> 
> 标签：mysql

我有 2 台计算机在 Window 7 上运行，我想尝试 MySQL 数据库复制。配置如下。2 mgt 节点 2 数据节点 2 mysqlid 节点

我已经配置了文件 config.ini

```
[ndbd default]
noofreplicas=2

[ndbd]
hostname=192.168.0.1
NodeId=1

[ndbd]
hostname=192.168.0.2
NodeId=2

[ndb_mgmd]
hostname=192.168.0.1
NodeId=101

[ndb_mgmd]
hostname=192.168.0.2
NodeId=102

[mysqld]
NodeId=51
hostname=192.168.0.1

[mysqld]
NodeId=52
hostname=192.168.0.2 
```

和 my.cnf(.1)

```
[mysqld]
ndb-nodeid=51
ndbcluster
datadir=c:\\Users\\Brian\\my_cluster\\mysqld_data
basedir=c:\\Users\\Brian\\mysqlc
port=5000
server-id=51
log-bin 
```

和 my.cnf(.2)

```
[mysqld]
ndb-nodeid=52
ndbcluster
datadir=c:\\Users\\Brian\\my_cluster\\mysqld_data
basedir=c:\\Users\\Brian\\mysqlc
port=5000
server-id=52
log-bin 
```

但是，当我登录到节点（主）的数据库并创建一个新数据库并插入一个新表时，我意识到另一个节点无法同步它。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T08:56:19.627

布莱恩，

首先，只是为了检查术语-您似乎正在尝试使用“MySQL Cluster”（数据在数据节点中而不是在 mysqlds 中保存并同步复制）而不是“MySQL Replication”（其中在 mysqlds 之间异步复制数据）。

我假设 mysqlds 是 MySQL Cluster 软件包附带的（“常规”mysqlds 将无法正常工作）。

为了将表存储在数据节点中（因此通过所有 mysqld 可见）而不是本地 mysqld，您必须指定 MySQL Cluster 是要使用的存储引擎：“CREATE TABLE mytab (... .) 引擎=NDBCLUSTER；"。如果你不这样做，那么这些表将使用 InnoDB 存储引擎创建，并且对于每个 mysqld 都是本地的。

请注意，如果您希望您的 MySQL 集群完全容错，那么您应该将 ndb_mgmds 移动到它们自己的主机上，而不是将它们与数据节点放在一起；其原因在[MySQL 集群容错 – 部署决策的影响中进行了](http://www.clusterdb.com/mysql-cluster/mysql-cluster-fault-tolerance-impact-of-deployment-decisions/)解释。

安德鲁。

# mysql - 查询以选择 var REGEX MANY 列

> ID：12552665
> 
> 赞同：2
> 
> 时间：2012-09-23T13:18:08.697
> 
> 标签：mysql, regex, performance, database-performance

这是我想要优化此查询的内容

```
SELECT * 
FROM users 
where `username` like "%abc%" 
   or `name`     like "%abc%" 
   or `email`    like "%abc%" 
```

此搜索从用户那里得到结果，其中任何一个`username`，，，`name``email` `like %abc%`

所以我尝试使用 in with like **But**

我一直在寻找 mysql Like in，我找到了这个答案[stackoverflow :Mysql like in](https://stackoverflow.com/questions/1127088/mysql-like-in)

所以解决方案是**正则表达式**

但我想让正则表达式不使用 OR

我想变成这样

```
SELECT * from users where abc REGEXP 'username|name|email'; 
```

所以答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:25:21.390

你的意思是这样的吗？>>

```
SELECT * from users where CONCAT(username, ',', name, ',', email) REGEXP 'abc' 
```

# matlab - Matlab perfcurve标签格式？

> ID：12552671
> 
> 赞同：2
> 
> 时间：2012-09-23T13:18:49.713
> 
> 标签：matlab, statistics, plot, regression

我想在 Matlab 中使用该`perfcurve`函数创建一条 ROC 曲线（它用于逻辑回归，类似于[本示例（页面底部）](http://www.mathworks.co.uk/help/stats/perfcurve.html)所示）。我有 150 个数据点（二进制数据），但它们既不是正类也不是负类；它们是特定数据点内积极观察的数量。

示例（随机数据说明）：

```
datapoint   +ve observations    total observations
1               23                  35
2               27                  41
3               23                  36
4               18                  29
5               19                  39
6               21                  41
7               24                  40
8               29                  36
9               38                  45
10              12                  32 
```

mathworks 上的示例[（页面底部）](http://www.mathworks.co.uk/help/stats/perfcurve.html)仅演示了如何为仅对应于正类或负类的数据行创建标签。

为了

```
[X,Y,T,AUC] = perfcurve(labels,scores,posclass) 
```

为了使 ROC 曲线图起作用，我必须如何格式化我的标签和 posclass？

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-28T20:21:34.703

为了使用该`perfcurve`函数在 Matlab 中创建 ROC 曲线，您需要获得每个数据点的分数（使用`scores`参数传递给 perfcurve）。数据点的分数由您的分类器给出，对应于该数据点属于正类（由`posclass`参数定义）的“概率”[1]。鉴于您的数据，您没有足够的信息来使用该`perfcurve`功能。

[1] 一些分类器不返回严格的概率，但分数越高表示概率越高，所以没关系。更多信息在 Fawcett, Tom。“ROC 分析简介。” 模式识别字母 27.8 (2006): 861-874。

# android - 从 Android 上传图片时出现“org.apache.http.client.NonRepeatableRequestException”

> ID：12552672
> 
> 赞同：3
> 
> 时间：2012-09-23T13:19:07.577
> 
> 标签：android, apache, http, file-upload

我正在尝试从 Android 向 Rails 服务器发送图片。但是当我发送时，我收到以下错误。

```
09-19 23:22:11.810: W/System.err(2704): org.apache.http.client.ClientProtocolException                                                                                        
09-19 23:22:12.000: W/System.err(2704):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:557)
09-19 23:22:12.020: W/System.err(2704):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
09-19 23:22:12.020: W/System.err(2704):     at com.loopj.android.http.AsyncHttpRequest.makeRequest(AsyncHttpRequest.java:73)
09-19 23:22:12.050: W/System.err(2704):     at com.loopj.android.http.AsyncHttpRequest.makeRequestWithRetries(AsyncHttpRequest.java:92)
09-19 23:22:12.050: W/System.err(2704):     at com.loopj.android.http.AsyncHttpRequest.run(AsyncHttpRequest.java:54)
09-19 23:22:12.050: W/System.err(2704):     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:444)
09-19 23:22:12.050: W/System.err(2704):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
09-19 23:22:12.050: W/System.err(2704):     at java.util.concurrent.FutureTask.run(FutureTask.java:138)
09-19 23:22:12.050: W/System.err(2704):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
09-19 23:22:12.060: W/System.err(2704):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
09-19 23:22:12.070: W/System.err(2704):     at java.lang.Thread.run(Thread.java:1019)
09-19 23:22:12.250: W/System.err(2704): Caused by: org.apache.http.client.NonRepeatableRequestException: Cannot retry request with a non-repeatable request entity
09-19 23:22:12.320: W/System.err(2704):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:413)
09-19 23:22:12.360: W/System.err(2704):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
09-19 23:22:12.370: W/System.err(2704):     ... 10 more 
```

奇怪的是，我每次上传图片时都不会收到此错误，只是有时在执行相同的过程时。这是我的代码。我正在使用“AsyncHttpClient”（http://loopj.com/android-async-http/）进行 http 连接。

```
public class AsynchConnector{
    static AsyncHttpClient client = new AsyncHttpClient();
    private static final String BASE_URL = Environment.SERVER_URL;

    public static void post(String url, RequestParams params, AsyncHttpResponseHandler responseHandler){
        Log.w("web", "sending POST requset to " + getAbsoluteUrl(url));
        client.post(getAbsoluteUrl(url), params, responseHandler);
    }
}

public static void postPicture(String serverAlbumId, String serverUserId, String filePath){
    RequestParams params = new RequestParams();
    params.put("user_id", CameraApp.sp.getString("server_user_id", ""));
    params.put("picture[album_id]", serverAlbumId);
    params.put("picture[user_id]", serverUserId);

    try{
        params.put("picture[image]", StorageAccessor.getPictureAsFile(filePath));
    }catch(FileNotFoundException e){
        Log.e("---", "no image file found ");
    }

    Log.i("----------", "starting to post picture");
    AsynchConnector.post(PICTURE_PATH, params, new AsyncHttpResponseHandler(){
        public void onSuccess(String response) {
            Log.i("POST_PICTURE_RESOPNSE", response);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T03:43:43.030

这是由于在 AsynchHttpClient 中使用了 OutputStreamWriter 类。这篇文章可能有助于了解正在发生的事情。

[http://httpcomponents.10934.n7.nabble.com/Http-Multi-part-exception-when-using-InputStreamBody-td12820.html](http://httpcomponents.10934.n7.nabble.com/Http-Multi-part-exception-when-using-InputStreamBody-td12820.html)

我通过在 ResponseHandler 中实现 onFailure(Throwable error) 方法解决了这个问题，该方法再次执行相同的操作。（在我的例子中，调用 postPicture 方法。）

# javascript - 避免滚动条的 jQuery 图像视口计算算法

> ID：12552674
> 
> 赞同：9
> 
> 时间：2012-09-23T13:19:31.570
> 
> 标签：javascript, jquery, css

我正在创建图像悬停效果，但我遇到了问题。当我将鼠标悬停在某些图像上时，会出现我想避免但不知道该怎么做的**滚动条。**我相信它与视口和计算有关，但不确定是如何完成的。

**[示例在这里](http://jsbin.com/upuref/1)**

**[JSBin 代码](http://jsbin.com/upuref/1/edit)**

这是代码：

```
$('.simplehover').each(function(){
    var $this = $(this);        
    var isrc = $this[0].src, dv = null;

    $this.mouseenter(function(e){
        dv = $('<div />')
            .attr('class', '__shidivbox__')
            .css({
                display: 'none',
                zIndex : 9999,
                position: 'absolute',
                top: e.pageY + 20,
                left: e.pageX + 20
            })
            .html('<img alt="" src="' + isrc + '" />')
            .appendTo(document.body);           
        dv.fadeIn('fast');
    })
    .mouseleave(function(){
        dv.fadeOut('fast');
    });         

}); 
```

任何人都可以帮助我如何做到这一点，以便悬停的图像出现在滚动条不出现的地方？（当然，如果图像尺寸非常大，我们不能避免滚动条）

我只想在缩放时显示原始图像，同时尽可能避免滚动条。

**请注意**，我计划将其转换为 jQuery 插件，因此我不能强制插件用户`overflow`设置为`hidden`. 该解决方案与**viewport**、**left**、**top**、**scroll width**和**height**、**window width/height**属性有关，我稍后可以将其合并到插件中。

* * *

# 更新：

我想出了这个：

[http://jsbin.com/upuref/14](http://jsbin.com/upuref/14)

但是，它非常非常hacky，并不是100％完美。我正在寻找更好的算法/解决方案。我已经看到很多悬停插件可以很好地做到这一点，但由于我不擅长这一点，所以我不能做得很好。例如，[**悬停缩放 Chrome 插件**](https://chrome.google.com/webstore/detail/nonjdcjchghhkdoolnlbekcfllmednbl)在根据大小在适当位置显示悬停图像方面做得很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T15:45:15.893

像这样：

```
html{overflow-x:hidden;}
html{overflow-y:hidden;} 
```

您需要做的就是将这些定义添加到您的 CSS 中，然后您就完成了。

**使用调整大小更新：**这是用于在水平和垂直方向调整图片大小和重新定位图片的**mouseenter代码。**现在，无论 HOVER 图像出现在哪里，它的大小和位置都会被调整为始终完整显示且未剪切。就滚动条而言，如果您显示的缩略图多于页面无法容纳的数量，甚至在 HOVER 图像显示之前您就会有滚动条。

**最终和工作更新：**因为您专注于隐藏的滚动条，我认为您忽略了这样一个事实，即如果您放置的缩略图超过视口可以包含的数量，滚动条无论如何都会显示出来，因此，因为用户可以向下滚动文档，当你计算悬停图像的位置时，不仅需要考虑resize，还需要考虑scrollTop 位置！**[FINAL JSBIN HERE](http://jsbin.com/upuref/49/edit)**，无论scrollTop 在哪里，无论视口大小如何，所有图片都显示为RESIZED 和FULL。

```
$this.mouseenter(function () {

    dv = $('<div />')
          .attr('class', '__shidivbox__')
          .css({
            'display': 'none',
            'z-index': 9999,
            'position': 'absolute',
            'box-shadow': '0 0 1em #000',
            'border-radius': '5px'
          })
          .html('<img alt="" src="' + isrc + '" />')
          .appendTo(document.body);

    var DocuWidth = window.innerWidth;
    var DocuHeight = window.innerHeight;

    var DvImg = dv.find('img');

    var TheImage = new Image();
    TheImage.src = DvImg.attr("src");

    var DivWidth = TheImage.width;
    var DivHeight = TheImage.height;

    if (DivWidth > DocuWidth) {

        var WidthFactor = (DivWidth / DocuWidth) + 0.05;
        DivHeight = parseInt((DivHeight / WidthFactor), 10);
        DivWidth = parseInt((DivWidth / WidthFactor), 10);
    }

    var ThumbHeight = $this.height();
    var ThumbWidth = $this.width();
    var ThumbTop = $this.position().top;
    var ThumbLeft = $this.position().left;

    var SpaceAboveThumb = ThumbTop - $(document).scrollTop();
    var SpaceBelowThumb = DocuHeight - ThumbTop - ThumbHeight + $(document).scrollTop();

    var MaxHeight = Math.max(SpaceAboveThumb, SpaceBelowThumb);

    if (DivHeight > MaxHeight) {

        var HeightFactor = (DivHeight / MaxHeight) + 0.05;
        DivHeight = parseInt((DivHeight / HeightFactor), 10);
        DivWidth = parseInt((DivWidth / HeightFactor), 10);
    }

    var HoverImgLeft = 0;
    var HoverImgTop = 0;

    if (SpaceBelowThumb > SpaceAboveThumb) {
        HoverImgTop = ThumbTop + ThumbHeight;
    } else {
        HoverImgTop = ThumbTop - DivHeight;
    }

    HoverImgTop = (HoverImgTop < 0) ? 0 : HoverImgTop;

    HoverImgLeft = (DocuWidth - DivWidth) / 2;

    dv.find('img').css({
        'width': DivWidth,
        'height': DivHeight,
        'border-radius': '5px'
    });

    dv.css({
        'left': HoverImgLeft,
        'top': HoverImgTop
    });

    dv.fadeIn('fast');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T16:29:21.770

您可以根据可用宽度定位图像：http: [//jsbin.com/upuref/19/](http://jsbin.com/upuref/19/)

该演示考虑了用于定位图像的可用空间（即窗口宽度减去图像宽度）。我还改进了事件顺序，只有在加载图像*后*`div`弹出窗口才开始淡入。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T22:26:10.043

我的回答也是（[JSBin DEMO](http://jsbin.com/upuref/41/)）

```
$('.simplehover').each(function(){
        var $this = $(this);

        // make sure that element is really an image
        if (! $this.is('img')) return false;

        var isrc = $this[0].src, dv = null;

        if (! isrc) return false;

        $this.mouseenter(function(e){
            // mouse x position
            var initXPos = e.pageX;
            var initYPos = e.pageY+20-$(window).scrollTop();
            var windowWidth = $(window).width();
            var windowHeight = $(window).height();
            // load original image
            var $img = $('<img/>');
            $img.on('load',function(eload) {
                var widthImage = this.width;
                var heightImage = this.height;
                // set inline style for get sizes after (see problems webkit and cache)
                $(this).css('width',widthImage);
                $(this).css('height',heightImage);
                var ratio = widthImage/heightImage;

                var finalXPos = initXPos+widthImage>windowWidth? windowWidth-widthImage-5 : initXPos;
                var finalYPos = initYPos;

                var img = this;

                // resize image if is bigger than window
                if(finalXPos<0)  {
                    finalXPos = 0;
                    $img.css('width', windowWidth-10);
                    $img.css('height',(windowWidth-10)/ratio);
                }

                // If overflow Y

                if(finalYPos+getSize($img,'height')>windowHeight) {

                    // calculate where is more space (top or bottom?)
                    var showOnTop = (windowHeight-initYPos-10)<windowHeight/2;
                    if(showOnTop) {
                        if(initYPos<getSize($img,'height')) {
                            $img.height(initYPos-30);
                            $img.width(getSize($img,'height')*ratio);
                        }
                        finalYPos = 0;
                        finalXPos = initXPos+getSize($img,'width')>windowWidth? windowWidth-getSize($img,'width')-5 : initXPos;

                    }else {
                        // show on bottom
                        if(windowHeight-initYPos<getSize($img,'height')) {
                            $img.height(windowHeight-initYPos-10);
                            $img.width(getSize($img,'height')*ratio);

                        }
                        finalXPos = initXPos+getSize($img,'width')>windowWidth? windowWidth-getSize($img,'width')-5 : initXPos;
                    }
                }
                dv = $('<div />')
                .attr('class', '__shidivbox__')
                .css({
                    display: 'none',
                    zIndex : 9999,
                    position: 'absolute',
                    MozBorderRadius : '5px',
                    WebkitBorderRadius : '5px',
                    borderRadius : '5px',
                    top: finalYPos+$(window).scrollTop(),
                    left: finalXPos
                }).append($img)
                .appendTo(document.body);           
            dv.fadeIn('fast');
            });
            // load the original image (now is the same, but I think is better optimize it)
            $img.attr("src",$this.attr("src"));

            function getSize($el,widthOrHeight) {
                // horrible but working trick :)
                return +$el.css(widthOrHeight).replace("px","");
            }
        })
        .mouseleave(function(){
            dv.fadeOut('fast');
        });         

    }); 
```

此脚本使图像适应窗口大小并在需要时调整 x 位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T14:28:47.473

嗯，这看起来很有趣。无论如何，这是[我的答案](http://jsbin.com/upuref/50/)。我已经看了几天了，虽然我也会参与进来。以下将确保悬停的图像不会超出视口，并且如果图像的宽度大于可显示的可用空间，则图像的显示将被调整大小（您可以注释掉代码如果你不想要它就这样做。只需在代码中查找“resize”这个词）。

```
var $document = $(document);
$('.simplehover').each(function(){
    var $this = $(this);
    // make sure that element is really an image
    if (! $this.is('img')) return false;

    var isrc = $this[0].src, ibox = null;

    if (! isrc) return false;
    ibox = $('<img />')
            .attr('class', 'simpleimagehover__shidivbox__')
            .css({
                display: 'none',
                zIndex : 99,
                MozBoxShadow: '0 0 1em #000', 
                WebkitBoxShadow: '0 0 1em #000',
                boxShadow: '0 0 1em #000',
                position: 'absolute',
                MozBorderRadius : '10px',
                WebkitBorderRadius : '10px',
                borderRadius : '10px'
            })
            .attr('src', isrc)
            .appendTo(document.body);          

    $this.bind('mouseenter mousemove', function(e) {
        $('.simpleimagehover__shidivbox__').hide();

        var left = e.pageX + 5, 
            top = e.pageY + 5,
            ww = window.innerWidth,
            wh = window.innerHeight,
            w = ibox.width(),
            h = ibox.height(),
            overflowedW = 0,
            overflowedH = 0;

        // calucation to show element avoiding scrollbars as much as possible - not a great method though
        if ((left + w + $document.scrollLeft()) > ww)
        {
            overflowedW = ww - (left + w + $document.scrollLeft());
            if (overflowedW < 0)
            {
               left -= Math.abs(overflowedW);
            }
        }

        // 25 is just a constant I picked arbitrarily to compensate pre-existing scrollbar if the page itself is too long
        left -= 25;
        left = left < $document.scrollLeft() ? $document.scrollLeft() : left;

        // if it's still overflowing because of the size, resize it
        if (left + w > ww)
        {
            overflowedW = left + w - ww;
            ibox.width(w - overflowedW - 25);
        }

        if (top + h > wh + $document.scrollTop())
        {
            overflowedH = top + h - wh - $document.scrollTop();
            if (overflowedH > 0)
            {
                top -= overflowedH;
            }
        }

        top = top < $document.scrollTop() ? $document.scrollTop() : top;
        ibox.css({
            top: top,
            left: left
        });

        ibox.show();
    }); 

    $('.simpleimagehover__shidivbox__').mouseleave(function(){
        $('.simpleimagehover__shidivbox__').hide();
    });

    $document.click(function(e){
        $('.simpleimagehover__shidivbox__').hide();
    });

    $document.mousemove(function(e){
        if (e.target.nodeName.toLowerCase() === 'img') {
            return false;
        }

        $('.simpleimagehover__shidivbox__').hide();
    });
}); 
```

虽然我的解决方案本身并不完美，但您可能会在其中找到一些有用的东西来帮助您确定视口。此外，您可能需要考虑代码的性能。由于这是您正在构建的插件，因此您需要在将其公开之前进行一些优化。基本上，只要确保它不慢。*

# google-maps-api-3 - Google Geocoder Lookup 按国家和城市获取邮政编码

> ID：12552675
> 
> 赞同：2
> 
> 时间：2012-09-23T13:19:34.437
> 
> 标签：google-maps-api-3, geocoding, google-geocoder

我目前正在使用 Google Geocoder API 来确定我的网络服务的位置数据。获取给定国家和城市的邮政编码对我来说很重要，但谷歌似乎限制了结果。

这是 API 调用：

[http://maps.googleapis.com/maps/api/geocode/json?address=deutschland,+saarlouis&language=de&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=deutschland,+saarlouis&language=de&sensor=false)

结果是这样的：

```
{
   "results" : [
      {
         "address_components" : [
            {
               "long_name" : "Saarlouis",
               "short_name" : "Saarlouis",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "Landkreis Saarlouis",
               "short_name" : "Landkreis Saarlouis",
               "types" : [ "administrative_area_level_3", "political" ]
            },
            {
               "long_name" : "Saarland",
               "short_name" : "SL",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "Deutschland",
               "short_name" : "DE",
               "types" : [ "country", "political" ]
            }
         ],
         "formatted_address" : "Saarlouis, Deutschland",
         "geometry" : {
            "bounds" : {
               "northeast" : {
                  "lat" : 49.36187570,
                  "lng" : 6.815549499999999
               },
               "southwest" : {
                  "lat" : 49.26046930,
                  "lng" : 6.67501510
               }
            },
            "location" : {
               "lat" : 49.31346060,
               "lng" : 6.752286499999999
            },
            "location_type" : "APPROXIMATE",
            "viewport" : {
               "northeast" : {
                  "lat" : 49.36187570,
                  "lng" : 6.815549499999999
               },
               "southwest" : {
                  "lat" : 49.26046930,
                  "lng" : 6.67501510
               }
            }
         },
         "types" : [ "locality", "political" ]
      }
   ],
   "status" : "OK"
} 
```

谢谢帮助。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:56:53.917

地理编码不提供邮政编码。Goenames 有一个[德国](http://download.geonames.org/export/zip/DE.zip)数据库。其他国家也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-15T01:00:10.080

您没有得到邮政编码的原因是查询范围太广。如果您将街道名称添加到查询中，则结果将包含邮政编码。如果您没有街道名称或不想使用它，解决您的问题的方法是将地理编码分为两部分：

第一步：使用城市获取 GPS 坐标

```
https://maps.googleapis.com/maps/api/geocode/json?address=amsterdam 
```

第 2 步：使用 GPS 坐标获取邮政编码

```
https://maps.googleapis.com/maps/api/geocode/json?latlng=52.3182742,4.7288558 
```

（注意：此处发布的相同问题的两倍，由 MidnightMotion 回答。添加以更容易查找 [。https://gis.stackexchange.com/questions/33966/google-geocoder-lookup-get-postal-code-by-country -和城市](https://gis.stackexchange.com/questions/33966/google-geocoder-lookup-get-postal-code-by-country-and-city)）

# ruby-on-rails - 在 Apache 上使用 RoR Passenger 缓存 JS 和 CSS 文件

> ID：12552676
> 
> 赞同：1
> 
> 时间：2012-09-23T13:19:34.690
> 
> 标签：ruby-on-rails, caching, passenger

我刚刚将我的 Ruby On Rails 应用程序之一投入生产，并注意到它的加载时间真的很慢。

我的应用程序使用 apache 服务器上的乘客在 railsplayground.net 上运行。

我查看了几个站点，包括：[pingdom](http://tools.pingdom.com)、[webpagetest](http://www.webpagetest.org) 和我在我的应用程序中注意到的主要缺点是缓存不适用于我的 javascript 和 css 文件，如下所示： ![在此处输入图像描述](../Images/a57e77d01dded67e3d462a0aa6b7046c.png) ![在此处输入图像描述](../Images/9544eca414e9d3f659fcd217234d28d7.png) ![在此处输入图像描述](../Images/6fa3c861edb27c60cb65e7c0d168a9bd.png)

我已经尝试阅读有关如何缓存的各种指南，但我所有的努力都没有结果。

我把它放在我的头文件中：

```
 <meta http-equiv="cache-control" content="public" />
  <meta http-equiv="last-modified" content="Sun, 23 Sep 2012 08:00:00 GMT" /> 
```

这在我的production.rb中打开：

```
config.action_controller.perform_caching = true 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T15:10:18.860

这些项目抱怨的是，当您提供静态资产（图像、css、javascript）时，网络服务器没有告诉浏览器它们是可缓存的，因此它们会被重新获取而不是必要的频率。

当使用资产管道（如您所见）时，资产文件名包含其内容的 md5 校验和，因此您可以设置非常长的到期时间：如果您更改文件，则校验和将更改为，因此文件浏览器请求将具有一个不同的名字。

您通常在 apache 的配置中执行此操作，方法是将类似这样的内容粘贴到虚拟主机的块中

```
<Location /assets>
      ExpiresActive on
      ExpiresDefault "access plus 1000 days"
</Location> 
```

打开 javascript 和 css 文件的 gzip 压缩也是值得的，这可以节省大量时间。您可以通过向虚拟主机添加类似的内容来做到这一点：

```
<Location />
  AddOutputFilterByType DEFLATE text/html text/plain text/xml application/x-javascript text/css  application/javascript application/json text/javascript
</Location> 
```

较旧的浏览器可能不支持这个，但是这个支持非常广泛，所以我系统地打开了这个（给你一个想法，即使 IE 4 和 Netscape Navigator 4 也支持这个）

# android - ExpandableListView - 定位子小部件

> ID：12552677
> 
> 赞同：1
> 
> 时间：2012-09-23T13:19:54.607
> 
> 标签：android, expandablelistview, expandablelistadapter

我`ExpandableListView`在子节点中有各种小部件。这些小部件在子节点的单独布局 xml 文件中定义，当父组打开时，它会“膨胀”，即在`BaseExpandableListAdapter.getChildView`. 如何获得最近膨胀的子节点的视图，我需要这个视图以便我可以调用`findViewById`它并访问小部件？

这是微不足道的，但我需要从`BaseExpandableListAdapter.getChildView`我的 Main Activity 执行它（特别是因为我正在调用`getSupportLoaderManager`从数据库中填充一些小部件），或者从`BaseExpandableListAdapter.getChildView`. 在后一种情况下，我不知道如何从`BaseExpandableListAdapter.getChildView`.

# ruby-on-rails-3 - omn iauth (google_apps) 请求阶段已启动。阻止我的应用

> ID：12552678
> 
> 赞同：7
> 
> 时间：2012-09-23T13:20:02.610
> 
> 标签：ruby-on-rails-3, devise, omniauth

我只是实施 Omniauth+Devise 以使用 Google Apps 登录，但是在执行请求时，“请求阶段启动”我的应用程序被阻止，我在另一个窗口中尝试了一个请求，直到“请求阶段”结束才执行，几个几秒钟后。我正在使用omniauth-openid、omniauth-google-apps 和Devise gems。

# c# - 使用自定义验证属性时收到错误消息

> ID：12552687
> 
> 赞同：9
> 
> 时间：2012-09-23T13:20:56.320
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, data-annotations, customvalidator

我正在使用这样的 CustomValidationAttribute

```
[CustomValidation(typeof(MyValidator),"Validate",ErrorMessage = "Foo")] 
```

我的验证器包含此代码

> ```
> public class MyValidator {
>     public static ValidationResult Validate(TestProperty testProperty, ValidationContext validationContext) {
>         if (string.IsNullOrEmpty(testProperty.Name)) {
>             return new ValidationResult(""); <-- how can I get the error message  from the custom validation attribute? 
>         }
>         return ValidationResult.Success;
>     }
> } 
> ```

那么如何从自定义验证属性中获取错误消息呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-10-22T14:43:25.247

我知道这是一个有点旧的帖子，但我会为这个问题提供更好的答案。

提问者想要使用并使用该属性 `CustomValidationAttribute`传入错误消息。`ErrorMessage`

如果您希望您的静态方法使用您在装饰您的财产时提供的错误消息，那么您可以返回：

`new ValidationResult(string.Empty)`或`ValidationResult("")`或`ValidationResult(null)`。

`CustomValidationAttribute`覆盖其`FormatErrorMessage`基类的 并对 进行条件检查`string.IsNullOrEmpty`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-23T13:39:26.767

没有可靠的方法从属性中获取错误消息。或者，您可以编写自定义验证属性：

```
[MyValidator(ErrorMessage = "Foo")]
public TestProperty SomeProperty { get; set; } 
```

像这样：

```
public class MyValidatorAttribute : ValidationAttribute
{
    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var testProperty = (TestProperty)value;
        if (testProperty == null || string.IsNullOrEmpty(testProperty.Name))
        {
            return new ValidationResult(FormatErrorMessage(validationContext.DisplayName));
        }

        return null;
    }
} 
```

在这种情况下，将从自定义验证属性推断错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:37:09.970

您可以查看以下帖子以获取有关如何做您想做的事情的一些想法（他们使用 JS）：

[通过javascript自定义验证器错误文本？](https://stackoverflow.com/questions/4012387/custom-validator-error-text-through-javascript?lq=1)

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-10T21:10:12.393

我发现可行的唯一方法是使用 TryValidateObject 从回发方法验证模型，如果失败，请再次显示模型 - 然后会出现错误。

```
 [HttpPost]
    public ActionResult Standard(Standard model)
    {
        var valContext = new ValidationContext(model, null, null);
        var valResults = new List<ValidationResult>();;
        bool b = Validator.TryValidateObject(model, valContext, valResults, true);
        if(!b)
            return View(model);
        ... 
```

# c# - 在 C# 中获取最新的特定项目

> ID：12552690
> 
> 赞同：0
> 
> 时间：2012-09-23T13:21:19.083
> 
> 标签：c#, c#-4.0, tfs

我有一个项目应该是最新到特定日期的。我有这个代码：

```
 var serverFolder = pathInTfs;
            var localFolder = pathInLocalMachin;
            var workingFolder = new WorkingFolder(serverFolder, localFolder);
            // Create a workspace mapping
            workspace.CreateMapping(workingFolder);

            if (!workspace.HasReadPermission)
            {
                throw new SecurityException(
                    String.Format("{0} does not have read permission for {1}",
                                  versionControl.AuthorizedUser, serverFolder));
            }
            // Get the files from the repository
             workspace.Get(dateForLatest, GetOptions.Overwrite); 
```

一切都很好，但我想在“pathInLocalMachin”中获得最新的唯一目录“pathInTfs”，但是当程序运行 workspace.Get() 每个项目都是最新的。如何在我的项目中获得最新的一条路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:48:40.370

有几个重载`Get`允许您指定要获取的对象集。对于你正在做的事情，我想你想要[`Get(GetRequest, GetOptions)`](http://msdn.microsoft.com/en-US/library/bb139308%28v=vs.100%29.aspx)。

其中`GetRequest`包括`ItemSpec`您可以在其中指定要获取的文件夹，然后指明`RecursionType.Full`.

# qt - 如何按升序对 ListView 项目进行排序？

> ID：12552693
> 
> 赞同：2
> 
> 时间：2012-09-23T13:21:20.830
> 
> 标签：qt, sorting, qt4.7, qlistview, qstandarditemmodel

我试图按升序对我的 ListView 项目进行排序，所以我尝试了

```
Model->sort(int Column, Qt::AscendingOrder) 
```

它工作得很好，但我不喜欢 Qt::AscendingOrder 策略。实际上，该函数首先对以大写字符开头的单词进行排序，然后对以小写字符开头的其他单词进行排序。然后它将两个结果连接在一起。例如：

```
My ListView Items are: apple
                       Ball
                       rose
                       cat
                       Orange

And i'm getting the output as:  Ball
                                Orange
                                apple
                                cat
                                rose 
```

有没有办法自定义排序策略？请帮助我...在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T15:31:11.740

使用`QSortFilterProxyModel`并设置[`sortCaseSensitivity`](http://qt-project.org/doc/qt-4.8/qsortfilterproxymodel.html#sortCaseSensitivity-prop)为`Qt::CaseInsensitive`应该可以解决问题。

或者派生出自己的模型并覆盖[`sort()`](http://qt-project.org/doc/qt-4.8/qabstractitemmodel.html#sort)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:57:10.817

你可以应用一个技巧。添加具有相同标签的额外列，但将它们转换为小写。将排序应用于此列。

# entity-framework - 实体框架4多对多关系问题

> ID：12552696
> 
> 赞同：0
> 
> 时间：2012-09-23T13:22:08.083
> 
> 标签：entity-framework

考虑到这个数据库： ![在此处输入图像描述](../Images/3b4fa59e59354ed3312015afe9ac88c0.png)

这是 EF 生成的： ![在此处输入图像描述](../Images/0467efafb6f4a8eec2e772515a912cb8.png)

我认为 HeroesItem 类，没用，应该在 Hero 类上有一个导航属性 Items，在 Item 类上有一个导航属性 Heroes。

我看到这可以通过代码轻松完成，但是如何首先使用数据库完成呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:04:32.583

仅当您的`HeroesItems`表不包含`Id`列，而是使用`IdHero`and`IdItem`作为复合主键时，才可以这样做。将任何其他列添加到联结表后，您必须将其映射为实体才能控制该列。

# sql-server - ADO.NET 中可以创建多少个连接池

> ID：12552699
> 
> 赞同：3
> 
> 时间：2012-09-23T13:22:30.837
> 
> 标签：sql-server, ado.net, connection-pooling

我知道一个连接池默认可以有 100 个物理连接。在 ADO.NET 中可以创建多少个池？是否与机器的可用内存有关。

我了解到连接池的实现是基于提供程序的，因此 SQL 数据提供程序的连接池工作方式与 Oledb 的连接池工作方式不同。（参考： http: [//msdn.microsoft.com/en-us/library/8xx3tyca.aspx](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)）池的默认最大物理连接数为 100。如果我们有不同的连接字符串（或不同的字符串顺序但相同的数据库）或不同的 windows 身份（如果我们使用 windows 身份验证），将创建新的连接池。但我正在寻找有关可以创建多少个连接池的信息......

如果您不清楚我在问什么或需要更多信息，请告诉我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:37:05.073

正如 Tim Schmelter 所说，没有最大值`MaxPoolSize`。

这完全取决于单个 SQL Server 的最大并发连接数。所以 32767 将是分配给`MaxPoolSize`.

请参阅SQL Server文档`User connections`的[最大容量规范。](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

# java - 如何设计像 Quora 这样的自动完成框的服务器端？

> ID：12552701
> 
> 赞同：0
> 
> 时间：2012-09-23T13:22:40.440
> 
> 标签：java, autocomplete, lucene, full-text-search, search-engine

我不想使用 Lucene，因为我认为它**太重了**。

有没有更简单的方法来实现这个（数百万数据）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T04:21:45.383

首先，对于自动完成，如果您想要快速显示的内容，您的目标应该是在 <= 100 毫秒内将响应返回给用户。这应该是您首先关心的问题。任何无法做到这一点的设置可能对用户来说都不够好。在我自己使用 Firebug 在 Firefox 中进行的测试中，Google 的自动完成在大约 50 毫秒内返回返回，Quora 在大约 65 毫秒内返回。

见，例如

[http://stackoverflow.com/questions/536300/what-is-the-shortest-perceivable-application-response-delay](http://charlesleifer.com/blog/powerful-autocomplete-with-redis-in-under-200-lines-of-python/)

显然，Quora 使用前缀匹配，而不是全文搜索，这使得它更快。要推出您自己的基于前缀的快速自动完成功能，这对于许多情况来说应该足够了，但不会使用模糊匹配处理拼写错误等问题，请尝试使用 Redis 等内存数据存储。详细信息可以在这里看到：

[http://charlesleifer.com/blog/powerful-autocomplete-with-redis-in-under-200-lines-of-python/](http://charlesleifer.com/blog/powerful-autocomplete-with-redis-in-under-200-lines-of-python/)

我无法让 CloudSearch（浏览器中直接从端点获取 95-125 毫秒，由 Firebug 测量，并且通过 PHP 中的 cURL 访问端点的时间延长 20-30 毫秒）降低到我引用的谷歌和 Quora 的低延迟，无论搜索查询的简单性。Elasticsearch 集群要快一些。这些陈述显然取决于用例，可能不能很好地概括，但需要考虑一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T15:19:01.630

如果您不想担心性能，我建议您看看 Amazon Web Services 新的 CloudSearch 服务。它速度很快，并且可以随着您的需求扩展而扩展。它还可以毫无问题地处理数百万个文档并支持通配符搜索（例如：quo*，将检索 Quora）。

[在这里](http://aws.amazon.com/cloudsearch/)查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T11:42:53.347

显然，这不是 Quora 或 Google 的工作方式，因为我没有在任何一个工作过的乐趣......这就是我要做的事情。

首先要获得的是搜索词列表 - 我假设您不想知道这是如何完成的，因为它实际上取决于各种各样的事情，但基本上您要么要做一个`select distinct title from pages`(在维基百科上的自动完成的情况下）或在谷歌的情况下更先进的东西。

下一步在高层次上也非常简单：您需要`select title from titles where title like 'Qu%'`在用户输入`Qu`搜索框的情况下执行查询。然后将标题列表作为对某种 Ajax 请求的响应返回给浏览器，可能是 JSON 或类似的形式。你需要尽可能快地完成它——这就是它变得困难的地方。

他们怎么做的这么快？大概有四点需要注意。

1.  他们有很多机器处理请求。请记住，Google 的自动完成功能在默认情况下是打开的，并且适用于（几乎？）所有语言。这是针对自动完成索引的大量搜索。对网络索引本身的影响远不止于此：对于每个网络搜索请求，Google 可能已经处理了 3 或 4 个自动完成请求。
2.  他们可能是在记忆中这样做的。众所周知，谷歌将其网络索引存储在内存中，所以我希望他们也会这样做。
3.  专业软件（这是它真正有趣的地方）。虽然传统数据库或 NoSQL 数据库可以做到这一点并快速完成，但我希望大男孩们实际上会使用专门的代码来做到这一点，其唯一目的是提供自动完成建议。我上面提供的 SQL 语句纯粹是为了演示所需的逻辑请求。您可能正在查看某种专门的树，例如后缀树、基数树或类似树。
4.  分片。为了应对数据量和执行请求的机器数量，您需要进行分片。这是确保所涉及的所有机器的某个子集仅处理以一个或多个字母开头的请求请求。例如，一组 X 机器处理以某个字母或什至 2 个字母开头的搜索。这意味着你有更多的机器，但它们并不都必须手头有整个索引。如何选择一组特定的机器？一旦请求在您的数据中心，您要么路由，要么您可以在客户端路由（例如，在您的 Javascript 中，根据搜索词的前 X 个字母决定要查询的 IP）

所以，我就是这样做的。由于没有经历过 Google/Quora 处理的庞大数据集，我敢肯定有些事情我没有考虑过。但是，这是一个开始。

而且，我是这样做的，纯粹是在家里的实验环境中：

我有一个简单的列表，里面有几十万个标题要搜索。这些被加载到一个专用的 MongoDB 集合中，该集合上定义了一个索引。然后我在它前面有一个 Play Framework 控制器，并使用 jQuery 的自动完成插件来进行搜索。

显然，与您正在寻找的相比，这很小，但只要您遵循建议（即良好的硬件、大量的 RAM、将索引保存在内存中），MongoDB 应该为您的数据集提供相同的性能。此外，Mongo 支持分片，并且 Play 框架不共享任何内容，因此在这种情况下，如果您的用户群增长，添加新机器以应对负载将很简单。

顺便说一句，Mongo 绝不是唯一的解决方案，当然，传统的 SQL 数据库也可以胜任——我只是出于其他原因使用 Mongo。

# java - 如何创建和使用具有 Spring+JUnit 测试配置注解的自定义注解？

> ID：12552705
> 
> 赞同：6
> 
> 时间：2012-09-23T13:23:19.727
> 
> 标签：java, spring, junit, annotations

我有大量使用 Spring Junit Support 运行的测试用例，每个测试都有以下注释。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations="classpath:spring/applicationContext.xml")
@TransactionConfiguration(transactionManager="transactionManager")
@Transactional
@ActiveProfiles("test") 
```

我不想将所有这些注释放在每个测试类上，而是要创建一个自定义注释并使用它。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations="classpath:spring/applicationContext.xml")
@TransactionConfiguration(transactionManager="transactionManager")
@Transactional
@ActiveProfiles("test")

@Target({ ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE })
@Retention(RetentionPolicy.RUNTIME)
@Inherited
public @interface SpringJUnit4TestConfig {

} 
```

但是当我使用这个自定义注释时，Spring Injection 根本没有发生。

```
@SpringJUnit4TestConfig
public class UserServiceTest
{
} 
```

我在这里缺少什么？

PS：但是JUnit的@RunWith和Spring的@Transactional，@ContextConfiguration都有@Inherited..所以我认为它应该可以工作。但现在我通过解决它来解决它。创建了一个基于抽象类并将所有这些注释和扩展该基类的测试用例放在上面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T13:58:52.097

我不认为这种方法会起作用，就像`@RunWith`JUnit 注释一样，所以要让它起作用，JUnit 注释必须是可传递的。

> 当一个类使用@RunWith 注释或扩展一个使用@RunWith 注释的类时，JUnit 将调用它引用的类来运行该类中的测试，而不是 JUnit 中内置的运行器。我们在开发后期添加了此功能。虽然它看起来很强大，但我们希望 runner API 会随着我们了解人们如何真正使用它而改变。当前内部的一些类可能会被改进并公开。

所以测试 JUnit 测试调用似乎只适用于继承的类。

至于 Spring，它支持配置位置的[上下文配置继承，](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/testing.html#testcontext-ctx-management-inheritance)~~我不确定这是否适用于其他注释类型（如果您不这么认为，请指向文档）~~实际上，这可能适用于在测试配置类继承的情况下的其他注释，因为`@Transactional`注释本身是`@Inherited`在这种情况下声明的。

所以在这种情况下，由于缺少 JUnit 注释，它不会运行。

# android - 尝试显示 Facebook Android SDK 添加好友对话框时出错

> ID：12552706
> 
> 赞同：1
> 
> 时间：2012-09-23T13:23:28.800
> 
> 标签：android, facebook, dialog

我正在尝试通过 fb sdk 显示添加朋友对话框。

```
 Bundle parameters = new Bundle();
                parameters.putString("id", i.getUid());
                FacebookSession.getSession().dialog(getSherlockActivity(), "friends", parameters,
                          new Facebook.DialogListener()
                          {
                            public void onFacebookError( FacebookError e ) {   }
                            public void onError(DialogError e) {   }
                            public void onCancel() {  }
                            @Override
                            public void onComplete(Bundle values) {
                                // TODO Auto-generated method stub

                            }
                          } ); 
```

有一个加载屏幕并出现一个对话框框架，但内容只是：

> redirect_uri URL 协议必须是 HTTP 或 HTTPS

通常在创建 facebook 对话框时不需要指定 redirect_uri。即使我尝试手动指定一个，例如：

```
parameters.putString("redirect_uri", "http://www.facebook.com"); 
```

它返回相同的错误。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T18:24:53.163

Facebook 仅支持“对话”请求中的提要、Oauth 和 Apprequest 操作。对于这些请求，即使将redirect_uri 指定为“fbconnect://success”，也不会给出错误“redirect_uri URL 协议应为http 或https”。不幸的是，当我们发出朋友对话框时，facebook 将 redirect_uri 设置为 http/https 并且 redirect_uri 应该在 APP 设置中的“SITE URL”参数中定义域名。

无论如何，我们通过覆盖 facebook SDK 中的 redirect_uri 解决了这个问题。在 facebook.java 中，我们对对话框方法进行了以下更改：

```
public void dialog(Context context, String action, Bundle parameters,
    final DialogListener listener) {

String endpoint = DIALOG_BASE_URL + action;
parameters.putString("display", "touch"); 
```

开始代码更改--->> 如果操作是朋友，您将使用您的站点 URL 覆盖 redirect_uri

```
if(action.contentEquals("friends")) 
{
  parameters.putString("redirect_uri", "http://www.yourdomain.com");
} 
else 
{
  parameters.putString("redirect_uri", REDIRECT_URI);
} 
```

结束代码更改

```
if (action.equals(LOGIN)) {
    parameters.putString("type", "user_agent");
    parameters.putString("client_id", mAppId);
} else {
    parameters.putString("app_id", mAppId);
}

if (isSessionValid()) { 
```

开始代码更改--->> 在朋友对话期间我们不需要 access_token

```
 if(!action.contentEquals("friends")) 
         parameters.putString(TOKEN, getAccessToken()); 
```

结束代码更改

```
}
String url = endpoint + "?" + Util.encodeUrl(parameters);
if (context.checkCallingOrSelfPermission(Manifest.permission.INTERNET)
        != PackageManager.PERMISSION_GRANTED) {
    Util.showAlert(context, "Error",
            "Application requires permission to access the Internet");
} else {
    new FbDialog(context, url, listener).show();
} 
```

另一个棘手的部分是在 FbDialog.java 中有一个 Webview 客户端处理来自 facebook 的返回代码，您必须对 FbDialog.java 进行以下更改：

```
private class FbWebViewClient extends WebViewClient {

@Override
public boolean shouldOverrideUrlLoading(WebView view, String url) {
    Util.logd("Facebook-WebView", "Redirect URL: " + url);
    if (url.startsWith(Facebook.REDIRECT_URI)) {
        Bundle values = Util.parseUrl(url);

        String error = values.getString("error");
        if (error == null) {
            error = values.getString("error_type");
            Util.logd("Facebook-WebViewError", "error type: " + error);
        }
        else
              Util.logd("Facebook-WebViewError", "error: " + error);
        if (error == null) {
            mListener.onComplete(values);
        } else if (error.equals("access_denied") ||
                   error.equals("OAuthAccessDeniedException")) {
            mListener.onCancel();
        } else {
            mListener.onFacebookError(new FacebookError(error));
        }

        FbDialog.this.dismiss();
        return true;
    } else if (url.startsWith(Facebook.CANCEL_URI)) {
        mListener.onCancel();
        FbDialog.this.dismiss();
        return true;
    } else if (url.contains(DISPLAY_STRING)) {
        return false;
    } 
```

开始代码更改--->> 在好友对话期间，redirect_uri 是您的 SITE URL，因此请检查 url 变量并相应地处理成功和失败

```
 else  if (url.startsWith("http://www.yourdomain.com")) {
       Bundle values = Util.parseUrl(url);

         String error = values.getString("error");
         if (error == null) {
             error = values.getString("error_type");
             Util.logd("Facebook-WebViewError", "error type: " + error);
         }
         else
            Util.logd("Facebook-WebViewError", "error: " + error);
         if (error == null) {
             mListener.onComplete(values);
         } else if (error.equals("access_denied") ||
                    error.equals("OAuthAccessDeniedException")) {
             mListener.onCancel();
         } else {
             mListener.onFacebookError(new FacebookError(error));
         }

         FbDialog.this.dismiss();
         return true;
    }
   // launch non-dialog URLs in a full browser
   // getContext().startActivity(
   //         new Intent(Intent.ACTION_VIEW, Uri.parse(url))); 
```

结束代码更改

```
 return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T12:32:57.213

我在developers.facebook.com 提交了一份错误报告并得到了以下答案：

> 我们的 SDK 不支持添加好友。请参阅此处 >(https://developers.facebook.com/docs/reference/androidsdk/) 了解我们关于 > 支持的文档。
> 
> 如果您仍然遇到问题，请随时在我们的社区网站 >(http://facebook.stackoverflow.com/) 上发帖并标记为“android”。
> 
> 谢谢，杰西

我不明白，因为有一个添加朋友的对话框，现在不支持

# c# - Math.Max 方法 C# 对象

> ID：12552707
> 
> 赞同：0
> 
> 时间：2012-09-23T13:23:35.313
> 
> 标签：c#, max, minimum

> **可能的重复：**
> [C#找到最大的数字](https://stackoverflow.com/questions/5117251/c-sharp-find-biggest-number)

根据用户输入确定最大和最小数字。

```
Console.WriteLine ("For the Numbers " + (firstNo) + "," + (secondNo) + "," + (thirdNo));
Console.WriteLine("Largest is ") ;
Console.WriteLine("Smallest is "); 
```

在这种情况下，我很难使用 Math.Max 方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T13:27:45.007

另一种方法是使用Linq`Max`和`Min`方法来获取：

```
var list = new[] {firstNo, secondNo, thirdNo };
var max = list.Max();
var min = list.Min(); 
```

或者简而言之：

```
var max = (new[] {firstNo, secondNo, thirdNo}).Max();
var min = (new[] {firstNo, secondNo, thirdNo}).Min(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T13:28:09.207

您可以获取前两个数字的最大值，然后将其与第三个值的值进行检查：

```
var max = Math.Max(Math.Max(firstNo, secondNo), thirdNo)); 
```

同样可以应用于最小值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T13:30:12.733

[Math.Max](http://msdn.microsoft.com/en-us/library/system.math.max.aspx)只比较两个数字。如果要对数字列表进行排序，请将它们放入 List 并使用[OrderBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)或[OrderByDescending](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderbydescending.aspx)。例如：

```
 List<int> numbers = new List<int>();
    numbers.Add(1);
    numbers.Add(5);
    numbers.Add(7);
    numbers.Add(13);
    numbers.Add(4);
    // And so on
    Console.Write("Numbers in increasing order: ");
    foreach (int number in numbers.OrderBy(x => x))
    {
        Console.Write(number + " ");
    }
    Console.WriteLine(); 
```

结果是`Numbers in increasing order: 1 4 5 7 13`

# python - Python 装饰器是做什么的，它的代码在哪里？

> ID：12552708
> 
> 赞同：8
> 
> 时间：2012-09-23T13:23:48.627
> 
> 标签：python, django, decorator, login-required

> **可能的重复：**
> [理解 Python 装饰器](https://stackoverflow.com/questions/739654/understanding-python-decorators)

Python 装饰器有什么作用？当我将装饰器添加到方法时，我在哪里可以看到正在运行的代码？

例如，当我[`@login_required`](https://docs.djangoproject.com/en/dev/topics/auth/#the-login-required-decorator)在方法顶部添加时，是否有任何代码替换该行？这条线究竟是如何检查用户会话的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T13:39:07.067

> 当我`@login_required`在方法顶部添加时，是否有任何代码替换该行？

有点儿。在视图函数之前添加`@login_required`与执行此操作具有相同的效果：

```
def your_view_function(request):
    # Function body

your_view_function = login_required(your_view_function) 
```

有关 Python 中装饰器的说明，请参见：

*   [http://www.python.org/dev/peps/pep-0318/](http://www.python.org/dev/peps/pep-0318/)
*   [http://wiki.python.org/moin/PythonDecorators#What_is_a_Decorator](http://wiki.python.org/moin/PythonDecorators#What_is_a_Decorator)

所以装饰器函数接受一个原始函数，并返回一个（可能）调用原始函数的函数，但也做了其他事情。

在 的情况下`login_required`，我认为它会检查传递给视图函数的请求对象，以查看用户是否经过身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:32:24.033

装饰器实际上是包装另一个函数或类的函数。在您的案例中，装饰器背后的函数名为`login_required`. 查看您的导入以找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T13:36:40.137

装饰器是包装另一个函数的函数。假设你有一个函数 f(x) 并且你有一个装饰器 h(x)，装饰器函数将你的函数 f(x) 作为参数，因此实际上你将拥有一个新函数 h(f(x)) . 它使代码更简洁，例如在您的 login_required 中，您不必输入相同的代码来测试用户是否登录，而是可以将函数包装在 login_required 函数中，以便仅在用户已登录。研究下面的这段代码

```
def login_required(restricted_func):
"""Decorator function for restricting access to restricted pages.
Redirects a user to login page if user is not authenticated.
Args:
    a function for returning a restricted page
Returns:
    a function 
"""
def permitted_helper(*args, **kwargs):
    """tests for authentication and then call restricted_func if
    authenticated"""
    if is_authenticated():
        return restricted_func(*args, **kwargs)
    else:
        bottle.redirect("/login")
return permitted_helper 
```

# objective-c - libssh2，检查会话是否仍处于活动状态或是否已断开连接

> ID：12552711
> 
> 赞同：1
> 
> 时间：2012-09-23T13:24:00.843
> 
> 标签：objective-c, libssh2

我正在使用 libssh2 库，我想知道是否有任何方法可以知道会话是否仍处于活动状态或是否已断开连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:22:59.830

重要的是要注意，会话仅在执行握手后才变为活动状态，这将为关联的套接字设置传输层。

据我所知，我认为没有特定的功能可以测试会话是否仍处于活动状态。您必须查看附加到会话的套接字是否仍然处于活动状态。

# hibernate - 多对多休眠反面被忽略

> ID：12552714
> 
> 赞同：10
> 
> 时间：2012-09-23T13:24:55.320
> 
> 标签：hibernate, jpa-2.0

您好正在阅读休眠文档。

[http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html)

> 使用 @ManyToMany 注释在逻辑上定义多对多关联。您还必须使用 @JoinTable 注释来描述关联表和连接条件。如果关联是双向的，则一侧必须是所有者，一侧必须是反向端（即更新关联表中的关系值时将被忽略）：

我明白除了最后的一切

> （即更新关联表中的关系值时将被忽略）。

这是什么意思？例子？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-23T14:15:20.927

假设您有以下实体：

```
@Entity
public class Student {
    @ManyToMany
    private Set<Course> courses;
    ...
}

@Entity
public class Course {
    @ManyToMany(mappedBy = "courses")
    private Set<Student> students;
    ...
} 
```

所有者是学生（因为它没有`mappedBy`属性）。反面是 Course ((因为它有`mappedBy`属性)。

如果您执行以下操作：

```
Course course = session.get(Course.class, 3L);
Student student = session.get(Student.class, 4L);
student.getCourses().add(course); 
```

Hibernate 将在连接表中添加学生 4 和课程 3 的条目，因为您更新了关联的所有者端 ( `student.courses`)。

而如果您执行以下操作：

```
Course course = session.get(Course.class, 3L);
Student student = session.get(Student.class, 4L);
course.getStudents().add(student); 
```

什么都不会发生，因为 uou 更新了关联的反面 ( `course.students`)，但忽略了更新所有者的一面。Hibernate 只考虑所有者方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-01T17:12:43.483

要使其以两种方式工作，您需要在实体之间建立两个独立的关系。这可以由数据库中的一个连接表表示，但默认情况下它将由两个表示，因此您必须明确表示您想要一个连接表。

我将使用前面提到的学生和课程模型来演示它。

```
@Entity
public class Student {
    @ManyToMany
    @JoinTable(name = "student_course",
               joinColumns = {@JoinColumn(name = "courses_id")},
               inverseJoinColumns = {@JoinColumn(name = "students_id")})
    private Set<Course> courses;
    ...
}

@Entity
public class Course {
    @ManyToMany
    @JoinTable(name = "student_course",
               joinColumns = {@JoinColumn(name = "students_id")},
               inverseJoinColumns = {@JoinColumn(name = "courses_id")})
    private Set<Student> students;
    ...
} 
```

在上面的示例中，我们有 2 个关系，学生<->课程关系的每一方都是一个关系的所有者。因此，这解决了仅在所有者方保存对数据库的更改的问题，因为每一方都是一个关系的所有者。

但是我们必须记住一个事实，保存数据后，关系集合不会从数据库中重新加载，因此程序员需要自己处理关系集合。通过这样说，我想说最简单的方法是修改关系集合的设置器以重建实体之间的循环，如下所示：

```
public void setCourses(Set<Course> courses) {
    for(Course c : courses) {
        if (!c.getStudents().contains(this)) {
            c.getStudents().add(this);
        }
    }
    this.courses = courses;
}

public void setStudents(Set<Student> students) {
    for(Student s : students) {
        if (!s.getCourses().contains(this)){
            s.getCourses().add(this);
        }
    }
    this.students = students;
} 
```

# sql-server - 如何创建可以包含少量参数的列？

> ID：12552716
> 
> 赞同：1
> 
> 时间：2012-09-23T13:25:04.757
> 
> 标签：sql-server, tsql

我需要创建一个 SQL Server 表。

该表将有 4 列。

其中一列 ,`colour`必须带有 3 个参数 (HSL)。

它应该如下所示：

![在此处输入图像描述](../Images/9b5cf3c99e720f1c67b0dce8e1ab97be.png)

知道如何实现吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:29:27.597

要使您的表格[**标准化**](http://en.wikipedia.org/wiki/Database_normalization)，您必须将这三个值（`H`、`S`、`L`）移动到一个新表格中，例如`HSLValues`. 使用列的外键`UID`。那么这个创建的表应该看起来像：

**`HSLValues`**：

*   `Id`
*   `HValue`
*   `SValue`
*   `LValue`
*   `UID`外键引用 firsttable(UID)。

# php - “破2”是什么意思？

> ID：12552721
> 
> 赞同：28
> 
> 时间：2012-09-23T13:26:32.717
> 
> 标签：php, break, control-structure

我总是使用和看到只有“break”的例子。这是什么意思：

```
 <?php 
    while ($flavor = "chocolate") { 
      switch ($flavor) { 
        case "strawberry"; 
            echo "Strawberry is stock!"; 
            break 2;    // Exits the switch and the while 
        case "vanilla"; 
            echo "Vanilla is in stock!"; 
            break 2;   // Exits the switch and the while 
        case "chocolate"; 
            echo "Chocolate is in stock!"; 
            break 2;    // Exits the switch and the while 
        default;     
            echo "Sorry $flavor is not in stock"; 
            break 2;    // Exits the switch and the while 
      } 
    } 
    ?> 
```

'break' 语句是否有更多可用选项？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-23T13:27:48.567

来自[PHP 文档`break`](http://php.net/manual/en/control-structures.break.php)：

> break 接受一个可选的数字参数，告诉它有多少嵌套的封闭结构要被打破。

*如评论中所述，它从switch 和 while*中脱颖而出。

以下示例将打破所有`foreach`循环：

```
foreach (...) {
  foreach (..) {
    foreach (...) {
      if ($condition) {
        break 3;
      }
    }
  }
} 
```

# php - 如何正确重写友好的 URL？

> ID：12552726
> 
> 赞同：1
> 
> 时间：2012-09-23T13:27:22.607
> 
> 标签：php, apache, .htaccess, mod-rewrite

我有一个类似的 URL `index.php?url_id=u5531e3aas01fe5c2`，我也想让它像这样工作`/u5531e3aas01fe5c2`，它可以将参数传递给我的 PHP，但是我的代码有问题。

```
RewriteEngine On
RewriteBase /try/
RewriteRule /u[a-z0-9]{17} /index.php?url_id=$1 [L,QSA] 
```

PS 还有是否可以重写 URL，如果出现`index.php?url_id=u5531e3aas01fe5c2`，它将被重写为`/u5531e3aas01fe5c2`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:58:03.077

试试这个：

```
RewriteRule ^u([a-z0-9]{16}) /index.php?url_id=$1 [L,QSA] 
```

# seo - 博客网站的 SEO

> ID：12552737
> 
> 赞同：2
> 
> 时间：2012-09-23T13:28:56.737
> 
> 标签：seo, blogspot

我最近开始为我的博客写文章，然后意识到谷歌没有索引它。所以我在谷歌上浏览了一些关于如何做 SEO 的文章。我看到某些链接表明元标记不再有助于提高您的排名。从我到目前为止的实验中：我发现，元标记对关键字有帮助，仅此而已。通过在 FB、twitter 等社交网站上分享，获得更多的页面点击量，从而提高在搜索引擎上的排名。

我想知道我还能做些什么来增加。我知道这不是一步到位的解决方案，或者没有现成的答案，但我想知道这个论坛上的人有什么用:)

我的另一个疑问是谷歌尽可能地喜欢原创内容。我已经在我的博客和另一个网站上发布了我的一些体育文章，该网站发布了关于同一运动的文章，但我提供了指向我原始博客的链接。但是由于体育网站的页面排名更高，我在博客上的页面（相同内容的文章）在谷歌上已经找不到了。有没有办法阻止它？请不要只在一个位置发帖。如果有解决方案，我将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:43:49.847

如今，有几件事对 SEO 非常重要：新鲜的原创内容（您正在使用博客处理这些内容！）和社交信号。您应该在 Google+、Facebook 和 Twitter 上推广您的博客，并参与相关社区。

成为您感兴趣领域的一些小众博客的常客，并尝试发布一些客座博客，您会得到很好的服务。博客喜欢客座博主，这是将直接流量带回您自己的博客的好方法，以及增加您在作者简历中特定关键字的 SERP 位置。

参与论坛和其他在线讨论是提高网站流量的好方法。创建好的、值得链接的内容，SERP 将随之而来。

# google-api - 从 google api 客户端上传失败

> ID：12552739
> 
> 赞同：0
> 
> 时间：2012-09-23T13:29:13.200
> 
> 标签：google-api, google-api-client

Google API 给出了这个错误：

> 发送直接消息或获取响应时出错。

这发生在这一行：

```
request.Upload(); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:39:51.007

查看 Google Drive SDK 文档中的快速入门指南，了解如何将文件上传到 Google Drive：

[https://developers.google.com/drive/quickstart](https://developers.google.com/drive/quickstart)

# .net - 在 Windows 终端服务器上安装支持 com 的 .net 程序集

> ID：12552745
> 
> 赞同：0
> 
> 时间：2012-09-23T13:30:37.210
> 
> 标签：.net, vb.net, visual-studio-2010, com, terminal-services

我有一个用 VB.NET (MSVS 2010) 编写的小类库，启用了“Com visible”和“Register for COM interop”标志。此库旨在用于 Windows 2008 终端服务器。我遇到了两个问题：

1.  在服务器上注册我的库。显然，打电话`regasm.exe my_lib.exe /tlb`是不够的。虽然`regasm`确实将适当的键放入注册表，但调用 `CreateObject("My_lib_prog_id")`会导致失败。我通过在服务器上安装 MSVS2010 的试用版、以提升的权限运行它并在那里构建库来暂时解决了这个问题。而且效果很好，直到...

2.  以另一个用户身份运行的 COM 客户端程序试图调用该库。它失败了。

*编辑*：“失败”意味着 VBA 在执行时抛出“系统找不到指定的文件”异常`Set obj = CreateObject("MyLibProgID")`。它在 Visual Studio 注册 lib 的同一用户帐户中工作正常。

我试图向每个人提供对 lib 目录的读取和执行访问权限，但它没有工作......有什么想法吗？

**更新**

如果客户端在*任何*其他用户下运行，即使该用户具有管理员权限，也会出现问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T00:20:54.607

好的，首先，我发现 .net COM dll 与 VBA 交互存在许多问题。

首先，通过属性在 .net 中配置它们，因此在注册表中正确配置它们很重要。确保 Dll 项目已标记为注册 COM 互操作。

其次，如果您使用 MSI 项目，请确保该软件已标记为“安装所有用户”。MSI 项目在删除注册表项方面做得很差，所以如果你搞砸了 MSI 安装、.net 版本等，你的服务器最终会出现“错误的注册表项”。我最终使用 regasm.exe 正确注册组件。我最终转向 WIX 项目安装。

第三，对于终端服务器，您需要确保注册表条目是“机器/全局”范围的，因为每个用户将运行一组可能不同的“注册表”条目。如果您正确设置了命名空间，您应该能够在 VBA 中进行早期绑定，而不是风险更高的后期绑定“CreateObject”调用。只需确保 VBA 在启动期间检查“损坏的引用”即可。

第四，我使用一个非常干净的 VM 来测试我的安装和注册表项，在 MS Office VBA 参考的帮助下，确认 COM 部分已正确注册，因此“CreateObject”调用不会失败。

第五，注意终端服务器的 x86/x64 问题以及您运行的显式 Office 版本（尤其是 Office 2010 x64）。如果服务器是 x64，您可能必须显式使用编译器标志 /86（任何 CPU 都可能对 VBA .net COM 对象非常不利）。

第六，注意从 .net 向 COM 引发异常的方式。查看 System.Runtime.InteropServices.COMException 以了解正确的方法。

```
From cmd 
c:
cd C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727{or the edition your using}
COPY "\\Distribution Share\{YourCompany}\{Software}\{Edition}\{.net Com DLL name}.dll" "C:\Program Files\{YourCompany}\{Software}\{.net Com DLL name}.dll"
Regasm.exe "C:\Program Files\{YourCompany}\{Software}\{.net Com DLL name}.dll" /u
Regasm.exe "C:\Program Files\{YourCompany}\{Software}\{.net Com DLL name}.dll" /regfile:"C:\Program Files\{YourCompany}\{Software}\{.net Com DLL name}.reg" /codebase
cd C:\WINDOWS\System32\
Regedit.exe /s "C:\Program Files\{YourCompany}\{Software}\{.net Com DLL name}.reg" 
```

然后，我仔细查看了生成的注册表文件，以确保它们位于正确的注册表配置单元中。

# c++ - 当 AppVerifier 运行时，map/set 迭代器不可递增

> ID：12552747
> 
> 赞同：1
> 
> 时间：2012-09-23T13:30:43.327
> 
> 标签：c++, stl, map, application-verifier

我正在尝试运行一个在应用程序验证程序下通过网络处理客户端的应用程序。
应用程序持有一个映射来维护客户端，以及一个最大计数为 1 的信号量来锁定映射。
没有验证器，它运行时没有错误，但是当附加了验证器时，我收到以下运行时错误：

> 映射/设置迭代器不可递增

对于以下代码：

```
Lock l(_mapLock); // This object uses a semaphore for synchronization 

MapType::iterator it; 
ClientInfo info; 
it = _clientsMap.begin(); 
for (it = _clientsMap.begin(); it != _clientsMap.end(); it++) { 
  (*it).second->getInfo(&info); 
  if (strcmp(info.ip, clientIp.c_str()) == 0) { 
    return DUPLICATE_CLIENT; 
  } 
} 
```

任何可能的原因的想法？

提前致谢。

# java - 重绘一个 argb BufferedImage

> ID：12552755
> 
> 赞同：4
> 
> 时间：2012-09-23T13:31:41.103
> 
> 标签：java, bufferedimage

在我的小程序中，我使用了不同`BufferedImage`的 s 并将它们用作屏幕部件。每个屏幕部分只有在内容需要更改时才会重新绘制。

这是抽象`ScreenPart`类：

```
public abstract class ScreenPart extends BufferedImage{
    Graphics2D g;

    private BufferedImage buffer = new BufferedImage(getWidth(), getHeight(), BufferedImage.TYPE_INT_ARGB);

    public ScreenPart(int width, int height) {
        super(width, height, BufferedImage.TYPE_INT_ARGB);
        g = createGraphics();
        repaint();
    }

    public abstract void paint(Graphics2D g);

    public void repaint(){
        g.drawImage(buffer, 0, 0, null);
        paint(g);
    }
} 
```

但是缓冲区不起作用，因为缓冲区也是透明的。当我将`BufferedImage`缓冲区的类型从 ARGB 更改为 RGB 时它会起作用，但这也会显示黑色背景。所以我的问题是：我怎样才能正确地`BufferedImage`用缓冲区重新绘制它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:24:14.490

已经找到解决方案：

```
public void repaint() {
    g.setComposite(AlphaComposite.getInstance(AlphaComposite.CLEAR));
    g.fillRect(0,0, getWidth(), getHeight());
    g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER));
    paint(g);
} 
```

这不使用另一个`BufferedImage`.

# objective-c - CCLabelBMFont 对齐不起作用

> ID：12552756
> 
> 赞同：2
> 
> 时间：2012-09-23T13:31:42.980
> 
> 标签：objective-c, ios, cocos2d-iphone

我正在创建一个位图字体标签，如下所示：

```
CCLabelBMFont *label = [CCLabelBMFont labelWithString:@"Hello" fntFile:@"HeaderFont.fnt" width:300 alignment:kCCTextAlignmentLeft]; 
```

然后我将它定位在：

```
label.position =  ccp(0, size.height-100); 
```

所以我认为标签应该从屏幕的最左侧（0）开始绘制，并略低于顶部（size.height-100），但是当标签绘制时，它看起来向左偏移，就像它在 X 轴上以 -200 或其他方式绘制一样。它认为对齐根本不起作用。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T15:23:00.547

//x 轴左对齐：y 中心

```
label.anchorPoint = ccp(0.0f,0.5f);
label.position = startCharPos; 
```

//x轴右对齐：y-center

```
label.anchorPoint = ccp(1.0f,0.5f);
label.position = startCharPos; 
```

我猜你想左上对齐。所以试试这个

```
label.anchorPoint = ccp(0.0f,1.0f);
label.position = startCharPos; 
```

# android - 不需要的 FrameLayout 拉伸以包裹所有孩子的身高（而不是只尊重一个孩子的身高）

> ID：12552757
> 
> 赞同：1
> 
> 时间：2012-09-23T13:31:56.640
> 
> 标签：android, android-linearlayout, android-imageview, android-xml, android-framelayout

基本上，我使用一种流行的策略来将背景图像居中，方法是`LinearLayout`将其包装在 a 中`FrameLayout`并添加一个`fill_parent`在`LinearLayout`. 但是，当我`ScrollView`在游戏中添加 a 时，一切都变了。

问题是图像在垂直方向上非常大，并且由于height 属性而`ScrollView`尊重 the`ImageView`和 the的高度。当图像垂直大于它时，这会导致 LinearLayout 下方出现不需要的空白空间。`LinearLayout``wrap_content`

如何使`FrameLayout`' 的高度仅拉伸到子 LinearLayout 的高度？如果可能，不要在运行时/绘图时以编程方式修改其大小。

```
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" >

    <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <ImageView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:scaleType="center"
            android:src="@drawable/cash_bg" />

        <LinearLayout
            android:id="@+id/main_ll"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="vertical" >

            <!-- My main views are here -->

        </LinearLayout>
    </FrameLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T10:19:31.620

我遇到了同样的问题，并且疯狂地寻找答案。我认为这是一个Android错误。我所做的是将 FrameLayout 包含到 LinearLayout 中，以便能够在 FrameLayout 的高度上强制“fill_parent”，这增加了复杂性，但解决了问题。没有找到任何其他（更好的）解决方案。试试这个：

```
<ScrollView
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:fillViewport="true" >
  <LinearLayout
   android:layout_width="fill_parent"
   android:layout_height="wrap_content">
    <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <ImageView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:scaleType="center"
            android:src="@drawable/cash_bg" />

        <LinearLayout
            android:id="@+id/main_ll"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center"
            android:orientation="vertical" >

            <!-- My main views are here -->

        </LinearLayout>
    </FrameLayout>
   </LinearLayout>
</ScrollView> 
```

# drag-and-drop - 在 fullCalendar 组件中拖动具有特定持续时间的事件

> ID：12552758
> 
> 赞同：4
> 
> 时间：2012-09-23T13:32:04.347
> 
> 标签：drag-and-drop, fullcalendar

我已经看到了[在 fullcalendar 中拖放外部事件](http://arshaw.com/js/fullcalendar-1.5.4/demos/external-dragging.html)的解决方案。但是，在这个演示中，所有外部事件的持续时间都是 2 小时（因为 defaultEventMinutes 参数设置为 120）。我正在尝试更改此演示以管理具有不同持续时间的事件。比如说，“我的事件 1”是 45 分钟长，“我的事件 2”是 165 分钟，等等。

一开始我虽然可能有一个属性来存储 eventObject 中的持续时间，但根据文档，情况并非如此。然后，我认为在开始拖动事件时可以更改“defaultEventMinutes”的值。但显然，如果不重建整个日历，我就无法做到这一点。

根据您的说法，满足这一要求的最佳方法是什么？提前感谢您的建议...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T14:41:38.967

对此也进行了研究，并以这种方式解决了 fullCalendar 上显示的持续时间：

1.  具有用于 fullCalendar 的自定义“setOptions”功能。
2.  有一个名为“dragMinutes”的 fullCalendar 属性，可以在元素 $(this).draggable({start:...}) 期间设置。

这是自定义 setOptions 的代码：

```
 ...
    function Calendar(element, options, eventSources) {
        var t = this;

        // hack for setting options that updates
        function setOptions(new_options, refresh) {
            $.extend(options, new_options);
            if (refresh) {
                var viewName = currentView.name;
                changeView(viewName, true);
            }
        }
    // exports ... 
    t.setOptions = setOptions;
    ... 
```

下面是处理 fullCalendar 中“dragMinutes”选项的代码：

```
/* External Dragging
--------------------------------------------------------------------------------*/

function dragStart(_dragElement, ev, ui) {
    hoverListener.start(function (cell) {
        clearOverlays();
        if (cell) {
            if (cellIsAllDay(cell)) {
                renderCellOverlay(cell.row, cell.col, cell.row, cell.col);
            } else {
                var d1 = cellDate(cell);
                if (opt('dragMinutes'))
                    var d2 = addMinutes(cloneDate(d1), opt('dragMinutes'));
                else
                    var d2 = addMinutes(cloneDate(d1), opt('defaultEventMinutes'));
                renderSlotOverlay(d1, d2);
            }
        }
    }, ev);
} 
```

下面是我如何使事件可拖动并更新“dragMinutes”：

```
 // make the event draggable using jQuery UI
    $(this).draggable({
        containment: 'document',
        // return a custom styled elemnt being dragged
        helper: function (event) {
            return $('<div class="uv-planning-dragging"></div>').html($(this).html());
        },
        opacity: 0.70,
        zIndex: 10000,
        appendTo: 'body',
        cursor: 'move',
        revertDuration: 0,
        revert: true, 
        start: function (e, ui) {
            // set the "dragMinutes" option in fullCalendar so shown interval about to be added is correct.
            var data = $(this).data('eventObject');
            if (data) {
                var min = data.jsonProps.durationMsec / 1000 / 60;
                if (macroCalendar.calendar) {
                    macroCalendar.calendar.fullCalendar('setOptions', { dragMinutes: Math.round(min) }, false);
                }
            }
        },
        stop: function (e, ui) {
            // further process

        }
    }); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-01T12:09:10.633

如果有人仍然访问线程并且没有找到解决方案，解决方案是在事件 div 中设置持续时间参数...然后在该 div 上调用 draggable。

```
$(this).data('event', {
    title: 'new event title', // use the element's text as the event title
    id: $(this).attr('id'),
    stick: true, // maintain when user navigates (see docs on the renderEvent method)
    duration: '03:00:00' // will set the duration during drag of event
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T13:46:08.730

目前，我发现的最佳解决方案是在我的事件对象上添加一个*持续时间*属性，然后创建我的 fullCalendar 的代码如下所示：

```
 $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
        },
        editable: true,
        droppable: true, // this allows things to be dropped onto the calendar !!!
        drop: function(date, allDay) { // this function is called when something is dropped

            // retrieve the dropped element's stored Event Object
            var originalEventObject = $(this).data('eventObject');

            // we need to copy it, so that multiple events don't have a reference to the same object
            var copiedEventObject = $.extend({}, originalEventObject);

            // assign it the date that was reported
            copiedEventObject.start = date;
            // HERE I force the end date based on the start date + duration
            copiedEventObject.end = new Date(date.getTime() + copiedEventObject.duration * 60 * 1000);
            copiedEventObject.allDay = allDay;

            // render the event on the calendar
            // the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
            $('#calendar').fullCalendar('renderEvent', copiedEventObject, true);

            // is the "remove after drop" checkbox checked?
            if ($('#drop-remove').is(':checked')) {
                // if so, remove the element from the "Draggable Events" list
                $(this).remove();
            }

        }
    }); 
```

唯一的缺点是当您拖动事件时，事件持续时间看起来像*defaultEventMinutes*而不是实际持续时间，但我不知道如何修复它

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-27T02:02:37.887

这些特殊属性可以在提供的事件对象中指定，也可以是独立的数据属性：

```
<!-- DURATION OF 3 hours EVENT WILL PROPAGATE TO CALENDAR WHEN DROPPED -->
<div class='draggable' data-event='1' data-duration='03:00' /> 
```

[https://fullcalendar.io/docs/dropping/eventReceive/](https://fullcalendar.io/docs/dropping/eventReceive/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-04T13:44:55.960

使用最新的`fullcalendar v2.0.2`，如果您希望覆盖具有特定的持续时间，您可以在此功能中更新`fullcalendar-arshaw.js`

```
function dragStart(_dragElement, ev, ui) {
    hoverListener.start(function(cell) {
        clearOverlays();
        if (cell) {
            var seconds = duration_in_minutes * 1000 * 60 ;
           // we need to pass seconds into milli-seconds
            if (d1.hasTime()) {                 
                d2.add(seconds);
                renderSlotOverlay(d1, d2, cell.col);
            }
            else {
                d2.add(calendar.defaultAllDayEventDuration);
                renderDayOverlay(d1, d2, true, cell.col);
            }
        }
    }, ev);
} 
```

在这里，将您的持续时间传递给外部事件对象，您可以获取该对象`_dragElement`，然后将其转换为毫秒并将其传递给`d2.add(seconds)`. 这将在该日历上创建毫秒的阴影。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-30T14:47:00.577

自 v4 以来，上述某些选项根本不起作用。我面临的问题如下：

我的全天项目都有持续时间，但没有开始时间。当我通过拖动选择开始时间时，开始时间已设置，但一旦我设置结束日期（与上述答案类似），结束日期将再次重置.. setDate 中发生了一些错误功能......结束日期已设置，这部分工作，然后它自己进行比较以找出日期之间的时间差，但日期已经由系统本身设置，导致差异为0，这导致结束日期再次设置为空......

我不得不说我脖子上的巨大疼痛......当它停留在时间线内时效果很好，但仅此而已。

我设法“修复”，更像是通过在 eventDrop 事件中使用这一行来销毁它，但它也适用于您可能使用的任何其他事件：

*   在此处使用 ajax 更新您的活动，因为您有开始和结束日期 *
*   日历.refetchEvents(); 在成功函数中

这将重新获取所有事件，这听起来对性能非常不利，但似乎不会占用太多时间，自己尝试一下。这样我的标题、时间等总是最新的，日历显示正确的结束日期。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-25T18:17:28.643

对于非外部事件，您可以使用 fullcalendar 设置：

```
defaultTimedEventDuration: (hours+':00:00'),
forceEventDuration: true,
// defaultEventMinutes: hours*60, // not needed 
```

并且在事件数据中，您没有设置 end 属性（或者您将其设为 null）：

```
eventData = {
    title: title,
    start: start,
    // end: end, // MUST HAVE no end for fixedduration
    color: '#00AA00',
    editable: true, // for dragging
}; 
```

参考： http: [//fullcalendar.io/docs/event_data/defaultTimedEventDuration/](http://fullcalendar.io/docs/event_data/defaultTimedEventDuration/)

提示：如果您想防止由于 可能导致的事件大小调整`editable: true`，您可以使用 CSS 隐藏句柄：`.fc-resizer.fc-end-resizer { display:none; }`

# f# - 带函数应用的类型化抽象语法树

> ID：12552759
> 
> 赞同：5
> 
> 时间：2012-09-23T13:32:10.843
> 
> 标签：f#, dsl, abstract-syntax-tree

我正在尝试编写一个可以表示函数应用程序的类型化抽象语法树数据类型。

到目前为止我有

```
type Expr<'a> =
    | Constant    of 'a
    | Application of Expr<'b -> 'a> * Expr<'b> // error: The type parameter 'b' is not defined 
```

我认为 F# 中没有办法在最后一行写出类似“for all b”的东西——我是不是错误地处理了这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-23T14:02:43.773

通常，F# 类型系统的表达能力不足以（直接）将类型化抽象语法树定义为示例中的树。这可以使用F# 中不支持的[广义代数数据类型 (GADT)](http://en.wikipedia.org/wiki/Generalized_algebraic_data_type)来完成（尽管它们在 Haskell 和 OCaml 中可用）。在 F# 中使用它会很好，但我认为它会使语言更复杂一些。

从技术上讲，编译器抱怨是因为类型变量`'b`没有定义。但是，当然，如果您定义它，那么您会得到`Expr<'a, 'b>`具有不同含义的类型。

如果您想在 F# 中表达这一点，则必须使用基于接口的解决方法（接口可以具有通用方法，这为您提供了一种表达约束的方法，就像`exists 'b`您在此处需要的那样）。这可能很快就会变得非常难看，所以我认为这不是一个好方法，但它看起来像这样：

```
// Represents an application that returns 'a but consists
// of an argument 'b and a function 'b -> 'a
type IApplication<'a> =
  abstract Appl<'b> : Expr<'b -> 'a> * Expr<'b> -> unit

and Expr<'a> = 
  // Constant just stores a value...
  | Constant    of 'a 
  // An application is something that we can call with an 
  // implementation (handler). The function then calls the
  // 'Appl' method of the handler we provide. As this method
  // is generic, it will be called with an appropriate type
  // argument 'b that represents the type of the argument.
  | Application of (IApplication<'a> -> unit) 
```

要表示 的表达式树`(fun (n:int) -> string n) 42`，您可以编写如下内容：

```
let expr = 
  Application(fun appl -> 
    appl.Appl(Constant(fun (n:int) -> string n), 
              Constant(42))) 
```

评估表达式的函数可以这样编写：

```
let rec eval<'T> : Expr<'T> -> 'T = function
  | Constant(v) -> v   // Just return the constant
  | Application(f) ->
      // We use a bit of dirty mutable state (to keep types simpler for now)
      let res = ref None
      // Call the function with a 'handler' that evaluates function application
      f { new IApplication<'T> with
            member x.Appl<'A>(efunc : Expr<'A -> 'T>, earg : Expr<'A>) = 
              // Here we get function 'efunc' and argument 'earg'
              // The type 'A is the type of the argument (which can be
              // anything, depending on the created AST)
              let f = eval<'A -> 'T> efunc
              let a = eval<'A> earg
              res := Some <| (f a) }
      res.Value.Value 
```

正如我所说，这是一个非常极端的解决方法，所以我认为实际使用它不是一个好主意。我想 F# 这样做的方法是使用无类型的`Expr`类型。你能多写一些关于你项目的总体目标的内容吗（也许还有另一种好方法）？

# mysql - 为什么我的使用 nhibernate 的 asp.net-mvc 站点会简单地停止更新和删除？

> ID：12552761
> 
> 赞同：3
> 
> 时间：2012-09-23T13:32:17.590
> 
> 标签：mysql, asp.net-mvc, nhibernate, fluent-nhibernate, ninject

我有一个非常简单的 CRUD asp.net-mvc 站点，它使用 nhibernate 与 mySQL 数据库交互。我正在使用 UnitOfWork 和 Repository 模式。升级到 MVC 4 和最新的 nhibernate 和 mySQL 版本（通过 nuget）后，我突然看到一个奇怪的问题，更新和删除已停止工作。

这是我的控制器中停止工作的示例删除代码：

```
 public ActionResult Delete(int id)
    {
        MyEvent c = _eventRepository.FindBy(id);

        _unitOfWork.Begin();
        _eventRepository.Delete(c);
        _unitOfWork.End();

        return RedirectToAction("Index");
    } 
```

UnitOfWork 代码如下所示：

```
 public UnitOfWork(ISessionFactory sessionFactory)
    {
        _sessionFactory = sessionFactory;
        Session = _sessionFactory.OpenSession();
        Session.FlushMode = FlushMode.Auto;
    }

   public void End()
    {
        Commit();
        if (Session.IsOpen)
        {
            Session.Close();
        }
    }

    public void Commit()
    {
        if (!_transaction.IsActive)
        {
            throw new InvalidOperationException("No active transation");
        }
        _transaction.Commit();
    }

    public void Begin()
    {
        _transaction = Session.BeginTransaction(IsolationLevel.ReadCommitted);
    } 
```

我测试了添加一个工作正常的新项目（新行显示在数据库表中）但是当我测试更新或删除时，代码运行良好（我没有在代码中得到任何异常）但字段不是当我进行更新时更新，并且在我运行删除代码时记录没有被删除。

回顾一下，从 mySQL db 读取数据工作正常，添加工作正常，但更新和删除已停止对所有表工作（之前确实工作）。我使用 Toad for MySQL 进行了常规 SQL 测试，效果很好（使用与我在代码中连接的相同登录凭据）

为了帮助进行更多调试，我启动了 nhibernate profiler，这就是我看到的删除或更新条目：

![在此处输入图像描述](../Images/b476fd13aafef659fb26b4921617d7e7.png)

这就是我看到加载常规阅读页面的内容：

![在此处输入图像描述](../Images/6fe8214f704287f2f8444fd132114082.png)

不确定这是否有助于解释问题，但我认为添加屏幕截图不会有什么坏处。

关于可能发生的事情的任何建议。这可能是一个权利问题（相对于一些软件库错误？）。同样，如上所述，此代码以前肯定有效。

这是我的 Ninject Ioc 代码：

```
 string connectionString = ConfigurationManager.ConnectionStrings["LocalMySqlServer"].ConnectionString;

        var helper = new NHibernateHelper(connectionString);
        Bind<ISessionFactory>().ToConstant(helper.SessionFactory)
            .InSingletonScope();

        Bind<IUnitOfWork>().To<UnitOfWork>();

        var sessionProvider = new SessionProvider();
        Bind<ISession>().ToProvider(sessionProvider);

        var unitOfWork = new UnitOfWork(helper.SessionFactory);

        Bind(typeof(IIntKeyedRepository<>)).To(typeof(Repository<>));
    } 
```

这是我的 unitofwork.cs 代码：

```
public class UnitOfWork : IUnitOfWork
{
    private readonly ISessionFactory _sessionFactory;
    private ITransaction _transaction;

    public ISession Session { get; private set; }

    public UnitOfWork(ISessionFactory sessionFactory)
    {
        _sessionFactory = sessionFactory;
        Session = _sessionFactory.OpenSession();
        Session.FlushMode = FlushMode.Auto;
    }

    public void End()
    {
        Commit();
        if (Session.IsOpen)
        {
            Session.Close();
        }
    }

    public void Begin()
    {
        _transaction = Session.BeginTransaction(IsolationLevel.ReadCommitted);
    }

    public void Dispose()
    {
        if (Session.IsOpen)
        {
            Session.Close();
        }
    }

    public void Commit()
    {
        if (!_transaction.IsActive)
        {
            throw new InvalidOperationException("No active transation");
        }
        _transaction.Commit();
    }

    public void Rollback()
    {
        if (_transaction.IsActive)
        {
            _transaction.Rollback();
        }
    }
} 
```

这是我的存储库代码：

```
public class Repository<T> : IIntKeyedRepository<T> where T : class
{
    private readonly ISession _session;
    private ITransaction _trans;

    public T FindBy(int id)
    {
        return _session.Get<T>(id);
    }

    public Repository(ISession session)
    {
        _session = session;
    }

    public bool Add(T entity)
    {
        _session.Save(entity);
        return true;
    }

    public bool Add(IEnumerable<T> items)
    {
        foreach (T item in items)
        {
            _session.Save(item);
        }
        return true;
    }

    public bool Update(T entity)
    {
        _session.Update(entity);
        return true;
    }

    public bool Delete(T entity)
    {
        _session.Delete(entity);
        return true;
    }

    public bool Delete(IEnumerable<T> entities)
    {
        foreach (T entity in entities)
        {
            _session.Delete(entity);
        }
        return true;
    }

    #endregion

    #region IIntKeyedRepository<T> Members

    public T FindBy(int id)
    {
        return _session.Get<T>(id);
    }

    #endregion

    #region IReadOnlyRepository<T> Members

    public IQueryable<T> All()
    {
        return _session.Query<T>();
    }

    public T FindBy(Expression<Func<T, bool>> expression)
    {
        return FilterBy(expression).Single();
    }

    public IQueryable<T> FilterBy(Expression<Func<T, bool>> expression)
    {
        return All().Where(expression).AsQueryable();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T12:31:51.597

此代码包括单个会话范围内的 Find 和 Delete 函数调用。我认为，问题中的代码问题是使用不同的问题。

```
public T RemoveById(int id)
{
    _transaction = Session.BeginTransaction(IsolationLevel.ReadCommitted);
    T res=_session.Get<T>(id);
    _session.Delete(entity);
    _transaction.Commit(); 
} 
```

（行动呼吁：）

```
RemoveById<MyEvent>(id) 
```

# testing - iMacros 和返回命令？

> ID：12552763
> 
> 赞同：1
> 
> 时间：2012-09-23T13:32:47.010
> 
> 标签：testing, imacros

我正在使用 imacros 制作我的第一个（当然是糟糕的）宏，并且遇到了一个反复出现的问题，即 BACK 命令无法正常工作。

```
TAG POS=8 TYPE=A ATTR=CLASS:name&&TXT:*
WAIT SECONDS=5
'Extracting stuff 
TAG POS=1 TYPE=h1 ATTR=itemprop:name&&TXT:* EXTRACT=TXT
TAG POS=1 TYPE=span ATTR=itemprop:name&&TXT:* EXTRACT=TXT
BACK
TAG POS=9 TYPE=A ATTR=CLASS:name&&TXT:* 
```

问题是有时 BACK 命令会失败（没有明显的原因），然后宏将停止工作，因为它找不到下一个标签。我必须手动导航回页面（暂停并按回不起作用），然后恢复宏。

这是一个已知的问题？有什么办法绕过它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T00:22:27.573

尝试`WAIT`在 BACK 之后放置命令或增加`SET !TIMEOUT_PAGE`. 我还注意到 Imacros 有点不知所措，所以最好`TAB T=...`经常指定，这样他就会知道它在同一页面上。我希望这有帮助。

# sql - 如何从具有不同值的表中选择一个值两次

> ID：12552768
> 
> 赞同：3
> 
> 时间：2012-09-23T13:33:58.483
> 
> 标签：sql, database, sql-server-2005, stored-procedures

我有消息表，其中存在“senderid”和“receiverid”。我有用户表，其中找到了每个用户的用户名。

现在我想创建一个存储过程，在其中我选择userid=senderid 的用户名和userid=receivername 的用户名。

我试过这个，但它是错误的，因为我以前从未做过这样的事情。

```
SELECT       SystemUser.SU_Username Where SystemUser.SU_ID=MessageReciever As RecieverName, SystemUser.SU_Username where Message.SenderID = SystemUser.SU_ID As SenderName FROM            Message CROSS JOIN
                     SystemUser 
```

有没有办法做我想做的事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T13:44:26.037

从 SystemUser 表中选择两次，使用表别名：

```
SELECT       SUR.SU_Username  As RecieverName
           , SUS.SU_Username As SenderName 
FROM            Message 
               JOIN SystemUser SUR
                  on (SUR.SU_ID = Message.MessageReciever )
               JOIN SystemUser SUS
                  on (SUS.SU_ID = Message.SenderID ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:46:37.370

在查看了您的 sql 很长一段时间后，我想我想出了您想要做的事情：只需加入两次

```
select  r.SU_Username as RecieverName,
        s.SU_Username as SenderName
from    Message m
inner join SystemUser r on (r.SU_ID = m.MessageReciever)
inner join SystemUser s on (s.SU_ID = m.SenderID) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T13:47:40.433

给定类似的东西：

```
create table users ( name text, id integer );
create table messages ( receiver_id integer, sender_id integer ); 
```

您正在寻找的应该是：

```
select us.name as sender_name, ur.name as receiver_name
from users us, users ur, messages m
where us.id = m.sender_id and ur.id = m.receiver_id; 
```

# jquery - Jquery：如果 div 存在于特定*页面上，请执行

> ID：12552770
> 
> 赞同：1
> 
> 时间：2012-09-23T13:34:17.613
> 
> 标签：jquery

如果在我的网站的一个页面上出现一个 div，我正在尝试生成一个对话框（在所有网站的页面上）。更确切地说，我有这个网站，如果您在用户页面上收到友谊请求，我想要一个警报（或浮动框，我稍后会看到）通知您，无论您在网站上的哪个位置。

我尝试使用 if 指令 2 次：

```
if('http://'+location.hostname+location.pathname='/profile') 
```

和

```
if($(".friends .new").length) {
   alert("You have notifications pending");
} 
```

我没有结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:39:14.663

在第一个`if`，你用的`=`时候我认为你的意思`+`。无论如何，您`if`没有任何意义，因为非空字符串始终是真实的并且通过了测试。

至于第二个，如果您已经有创建这些元素的代码，它将起作用。如果元素实际上是`class="friends new"`，那么您应该删除选择器中的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:04:06.767

您可以使用追加，并追加一段 JS。如果元素不存在，则 append 不会触发。

```
 $('.friends .new').append('<script>alert("Hello World!");<\/script>');​​​​​​​​​​​​ 
```

如果 .friends 中存在元素 .new，这将提醒 hello world。

[http://jsfiddle.net/dcqxr/14/](http://jsfiddle.net/dcqxr/14/)

# ruby-on-rails - Ruby on Rails 设计宝石

> ID：12552773
> 
> 赞同：1
> 
> 时间：2012-09-23T13:34:36.440
> 
> 标签：ruby-on-rails, devise

我正在尝试将设计 gem 用于我的 rails 3.2 项目，但是当我尝试检查登录页面时，我收到以下错误：

```
wrong number of arguments (3 for 2) 
```

提取的源代码（在第 3 行附近）：

```
<h2>Sign in</h2>

<%= form_for(resource_name, resource, :url => session_path(resource_name)) do |f| %>
    <p><%= f.label :email %></p>
    <p><%= f.text_field :email %></p> 
```

我到底做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:42:54.853

您将错误数量的参数传递给该`form_for`方法，因为它只接受 2 个参数。

有关此方法的文档，请参阅[http://apidock.com/rails/ActionView/Helpers/FormHelper/form_for](http://apidock.com/rails/ActionView/Helpers/FormHelper/form_for)。

您可能应该将第 3 行写为：

```
<%= form_for(resource, :url => session_path(resource_name)) do |f| %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:31:15.933

```
<%= form_for(resource, :as => resource_name, :url => session_path(resource_name)) do |f| %> 
```

# c - 如何克服输入函数中链表第一个元素的奇数内存分配？

> ID：12552776
> 
> 赞同：0
> 
> 时间：2012-09-23T13:35:13.180
> 
> 标签：c, memory-management, linked-list

要求是一个`input`函数，它将 a 返回到从用户输入创建`Node*`的链表的根。`input`像：

```
Node *input()
{
     Node *root; //not yet allocated
     while(1)
     {    
           //take in numbers from the user and correspondingly add them 
           //to the linked list and quit when anything else is entered

           if(input character is a number)
           {
                //allocate memory to a fresh pointer and push the number to it
                //and add this new Node to the LL
           }
     }
     return root;
} 
```

**->**在 while 循环体之前 有预分配内存`root`并将第一个数字推送到它的解决方案。但是在这里，如果用户不输入任何内容，则必须立即删除。

**->**此外，还有一种可能的方法是在 while 循环中检查 root 是否为 NULL，如果是，则分配内存，以便它只发生一次。

但我想知道是否有解决方案可以消除由 LL 的根源引起的奇怪情况。

**->**也许我可以在第一个不包含任何值的虚拟节点。

但除此之外呢？如果有更好的方法来做整个事情，请提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:48:15.170

您可以执行以下操作：

```
struct Node* root = 0; // don't forget to initialize

while (...) {
  if (...) {
    struct Node * item = ... ;  // allocate
    item->data = ...;
    item->next = root;
    root = item;
  }
}

return root; 
```

你就完成了，第一个元素不需要特殊情况。列表的结尾由空`next`指针指示。

如果您希望列表按插入顺序排列，而不是每次都遍历整个列表，您可以：

```
struct Node* root = 0; // don't forget to initialize
struct Node* tail = 0;

while (...) {
  if (...) {
    struct Node * item = ... ;  // allocate
    item->data = ...;
    item->next = 0;

    if (tail)
      tail->next = item;
    tail = item;

    if (!root)
      root = item;
  }
}

return root; 
```

没有特殊情况分配，但特殊情况分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:46:39.543

没有一个解决方案看起来很复杂，但是使用一个虚拟节点，您将拥有一个非常干净的代码：

```
Node root; //stored on the stack
root->next = NULL;

//...

return root->next; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T15:38:52.360

这是一个避免特殊情况的版本，它使用指针到指针：

```
struct list {
        struct list *next;
        int val;
        };

struct list *input(void)
{
struct list *ret=NULL, **tail;
char buff[100];

for (tail= &ret; fgets(buff, sizeof buff, stdin);       ) {
        int val;
        if ( sscanf(buff,"%d", &val) < 1) continue;
        *tail = malloc (sizeof **tail);
        (*tail)->next = NULL;
        (*tail)->val = val;
        tail = &(*tail)->next;
        }
return ret;
} 
```

# asp.net-mvc - 代码编辑器插件

> ID：12552780
> 
> 赞同：-1
> 
> 时间：2012-09-23T13:35:42.470
> 
> 标签：asp.net-mvc, razor, code-editor

我正在寻找某种类似于此插件 stackoverflow 用于提问的插件。允许提出问题的人使用代码、图像、粗体字母等自定义他/她的问题。我喜欢它是如何知道你的键入代码的，例如，当你点击一次或两次时。我会将它用于 mvc4 项目，让用户在描述中使用一些代码键入教程。我尝试查看代码镜像，但使用起来似乎很复杂。有什么简单的方法或插件我可以在文本区域或某种输入中实现这样的东西吗？感谢您的任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T15:26:10.527

您可以查看以下几个库：

*   [http://steamdev.com/snippet/](http://steamdev.com/snippet/)
*   [http://www.tinymce.com/](http://www.tinymce.com/)
*   [http://codemirror.net/](http://codemirror.net/)

我个人使用第一个。虽然它们都很容易实现，但您在使用 codemirror 时遇到了什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T02:32:53.923

FWIW，StackOverflow 上使用的编辑器是[开源](https://blog.stackoverflow.com/2009/12/introducing-markdownsharp/)的，因此您可以将其合并到您正在处理的站点中。编辑器在 HTML 上使用 markdown 语法而不是完整的语法（例如 TinyMCE），因此它在支持哪种格式方面受到更多限制。它是否满足您的需求将取决于您需要提供多丰富的编辑体验以及生成的输出需要多么复杂。

# javascript - 错误：无法获取从“executeElementAnimation”引发的未定义或空引用的属性“样式”

> ID：12552783
> 
> 赞同：1
> 
> 时间：2012-09-23T13:36:20.610
> 
> 标签：javascript, windows, html

我正在制作一个win8应用程序并遇到以下错误：

```
{"exception":null,
 "error":
    [{"description":"Unable to get property 'style' of undefined or null reference",
    "number":-2146823281,
    "stack":"TypeError: Unable to get property 'style' of undefined or null reference\n
       at executeElementAnimation (ms-appx://microsoft.winjs.1.0/js/base.js:6652:13)\n
       at applyAction (ms-appx://microsoft.winjs.1.0/js/base.js:6754:25)\n
       at executeAnimation (ms-appx://microsoft.winjs.1.0/js/base.js:6815:13)\n
       at enterPage (ms-appx://microsoft.winjs.1.0/js/ui.js:1473:9)\n
       at navigated (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:114:21)\n
       at parentElement (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:94:29)\n
       at notifySuccess (ms-appx://microsoft.winjs.1.0/js/base.js:1404:21)\n
       at enter (ms-appx://microsoft.winjs.1.0/js/base.js:1091:21)\n
       at _run (ms-appx://microsoft.winjs.1.0/js/base.js:1307:17)\n
       at _completed (ms-appx://microsoft.winjs.1.0/js/base.js:1275:13)"},
    {"description":"Unable to get property 'style' of undefined or null reference","number":-2146823281,
    "stack":"TypeError: Unable to get property 'style' of undefined or null reference\n
       at executeElementTransition (ms-appx://microsoft.winjs.1.0/js/base.js:6575:13)\n
       at applyAction (ms-appx://microsoft.winjs.1.0/js/base.js:6754:25)\n
       at executeTransition (ms-appx://microsoft.winjs.1.0/js/base.js:6837:13)\n
       at enterPage (ms-appx://microsoft.winjs.1.0/js/ui.js:1484:9)\n
       at navigated (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:114:21)\n
       at parentElement (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:94:29)\n
       at notifySuccess (ms-appx://microsoft.winjs.1.0/js/base.js:1404:21)\n
       at enter (ms-appx://microsoft.winjs.1.0/js/base.js:1091:21)\n
       at _run (ms-appx://microsoft.winjs.1.0/js/base.js:1307:17)\n
       at _completed (ms-appx://microsoft.winjs.1.0/js/base.js:1275:13)"}],
    "promise":{"_oncancel":null,
    "_nextState":null,
    "_state":{"name":"error","done":null,"then":null},
    "_value":
    [{"description":"Unable to get property 'style' of undefined or null reference",
    "number":-2146823281,
    "stack":"TypeError: Unable to get property 'style' of undefined or null reference\n
       at executeElementAnimation (ms-appx://microsoft.winjs.1.0/js/base.js:6652:13)\n
       at applyAction (ms-appx://microsoft.winjs.1.0/js/base.js:6754:25)\n
       at executeAnimation (ms-appx://microsoft.winjs.1.0/js/base.js:6815:13)\n
       at enterPage (ms-appx://microsoft.winjs.1.0/js/ui.js:1473:9)\n
       at navigated (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:114:21)\n
       at parentElement (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:94:29)\n
       at notifySuccess (ms-appx://microsoft.winjs.1.0/js/base.js:1404:21)\n
       at enter (ms-appx://microsoft.winjs.1.0/js/base.js:1091:21)\n
       at _run (ms-appx://microsoft.winjs.1.0/js/base.js:1307:17)\n
       at _completed (ms-appx://microsoft.winjs.1.0/js/base.js:1275:13)"},
    {"description":"Unable to get property 'style' of undefined or null reference",
    "number":-2146823281,
    "stack":"TypeError: Unable to get property 'style' of undefined or null reference\n
       at executeElementTransition (ms-appx://microsoft.winjs.1.0/js/base.js:6575:13)\n
       at applyAction (ms-appx://microsoft.winjs.1.0/js/base.js:6754:25)\n
       at executeTransition (ms-appx://microsoft.winjs.1.0/js/base.js:6837:13)\n
       at enterPage (ms-appx://microsoft.winjs.1.0/js/ui.js:1484:9)\n
       at navigated (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:114:21)\n
       at parentElement (ms-appx://fa541b49-1aef-4f6c-9002-7d2e2fcadc25/js/navigator.js:94:29)\n
       at notifySuccess (ms-appx://microsoft.winjs.1.0/js/base.js:1404:21)\n
       at enter (ms-appx://microsoft.winjs.1.0/js/base.js:1091:21)\n
       at _run (ms-appx://microsoft.winjs.1.0/js/base.js:1307:17)\n
       at _completed (ms-appx://microsoft.winjs.1.0/js/base.js:1275:13)"}],"_isException":false,"_errorId":4},"id":4} 
```

我的 javascript 文件是：

```
(function () {
"use strict";

var ui = WinJS.UI;
var utils = WinJS.Utilities;

ui.Pages.define("/pages/itemDetail/itemDetail.html", {

    // Template tutorial code
    getAnimationElements: function () {
        return [[this.element.querySelector("header")], [this.element.querySelector(".content")]];
    },

    // This function is called whenever a user navigates to this page. It
    // populates the page elements with the app's data.
    ready: function (element, options) {
        var item = options && options.item ? Data.resolveItemReference(options.item) : Data.items.getAt(0);
        element.querySelector(".titlearea .pagetitle").textContent = item.group.title;
        //element.querySelector("article .item-title").textContent = item.title;
        //element.querySelector("article .item-subtitle").textContent = item.subtitle;
        //element.querySelector("article .item-image").src = item.backgroundImage;
        //element.querySelector("article .item-image").alt = item.subtitle;
        //element.querySelector("article .item-content").innerHTML = item.content;

        //element.querySelector(".detailfontstyle").textContent = item.mIOs.PrimaryObjective;

        // Template tutorial code
        appbar.winControl.disabled = false;
        appbar.winControl.hideCommands([labelSize, markItem]);
        appbar.winControl.showCommands([textSize]);
    },

    // Template tutorial code
    setPageFocus: function () {
        this.element.querySelector(".content").focus();
    },
});
})(); 
```

和 HTML 文件是：

```
<html>
<head>
<meta charset="utf-8" />
<title>itemDetailPage</title>

<!-- WinJS references -->
<link href="//Microsoft.WinJS.1.0/css/ui-light.css" rel="stylesheet" />
<script src="//Microsoft.WinJS.1.0/js/base.js"></script>
<script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

<link href="/css/default.css" rel="stylesheet" />
<link href="/pages/MarketIODetails/marketingIODetails.css" rel="stylesheet" />
<link href="/pages/itemDetail/itemDetail.css" rel="stylesheet" />
<script src="/js/data.js"></script>
<script src="/pages/itemDetail/itemDetail.js"></script>
</head>
<body>
<!-- The content that will be loaded and displayed. -->
<div class="itemdetailpage fragment">
    <header aria-label="Header content" role="banner">
        <button class="win-backbutton" aria-label="Back" disabled></button>
        <h1 class="titlearea win-type-ellipsis">
            <span class="pagetitle"></span>
        </h1>
    </header>
    <div class="details">
    <h1 style="font-family:'segoe ui'; color:orange;text-align:center; margin-     bottom:20px">Details</h1>
    <!--<h2 class="detailfontstyle">Primary obj: Put primary obj here</h2>-->
    <!--<h2 class="detailfontstyle org">Org: Put organisation here</h2>
    <h2 class="detailfontstyle sap">SAP IO: Put SAP IO here</h2>
    <h2 class="detailfontstyle editor1">Editor 1: Put editor name here</h2>
    <h2 class="detailfontstyle edito2">Editor 2: Put editor name here</h2>-->

</div>
<div class="tablecontainer">
    <div class="tableoutlay">
            <h1 style="font-family:'segoe ui'; color:orange; text-align:center">Budget Table</h1>
            <table class="forecastTable">
                <thead>
                    <tr style="height: 5px">
                        <th></th>
                        <th>Available</th>
                        <th>Assigned</th>
                        <th>Unassigned</th>
                        <th>Approved</th>

                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>Vendor</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>

                    </tr>
                    <tr>
                        <th>RevAdjust</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>

                    </tr>
                    <tr>
                        <th>Market</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>

                    </tr>
                </tbody>
            </table>
        </div>

<div class="tableoutlay" style="margin-top:43px">
    <h1 style="font-family: 'segoe ui'; color: orange; text-align:center">Forecast Table</h1>
    <table class="forecastTable">
            <thead>
                    <tr style="height: 5px">
                        <th></th>
                        <th>July</th>
                        <th>Aug</th>
                        <th>Sep</th>
                        <th>Oct</th>
                        <th>Nove</th>
                        <th>Dec</th>
                        <th>Jan</th>
                        <th>Feb</th>
                        <th>Mar</th>
                        <th>Apr</th>
                        <th>May</th>
                        <th>June</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th>Vendor</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>1289</td>
                    </tr>
                    <tr>
                        <th>Budget</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>1289</td>
                    </tr>
                    <tr>
                        <th>Market</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>1289</td>
                    </tr>
                    <tr>
                        <th>Some</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>1289</td>
                    </tr>
                    <tr>
                        <th>Some</th>
                        <td>1231</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>7292</td>
                        <td>9821</td>
                        <td>4325</td>
                        <td>1278</td>
                        <td>1289</td>
                    </tr>
                </tbody>
        </table>
        </div>          
    </div>
 </body>
 </html> 
```

关于如何解决这个问题的任何想法？

非常感谢。

# xpath - 获取特定节点元素下的节点

> ID：12552784
> 
> 赞同：0
> 
> 时间：2012-09-23T13:36:24.843
> 
> 标签：xpath, htmlcleaner

我需要帮助解决这里的问题，或者至少需要一些建议。我正在使用带有 XPATH 的 HTMLcleaner 解析 HTML 文档。

我有这样的事情：

```
<html>

[code and other <h4> tags]

<h4>Random name</h4>
<a href="link" target="target"> Text I want to get </a>
<a href="link2" target="target2"> Text I want to get 2 </a>
<a href="link3" target="target3"> Text I want to get 3 </a>
<a href="link4" target="target4"> Text I want to get 4 </a>
<h4> Random name 2 </h4>
<a href="link" target="target"> Text I don't want to get </a>

[code and other <h4> tags]
</html> 
```

好的。我有几个`<h4>`标签，每个标签都有`<a>`标签和一些文本。我的问题是我不知道如何从特定的文本中获取所有相应的*文本*，就像“h4 [i]”一样。我尝试了这样的事情，但没有奏效：

```
String xpath = "h4["+number+"]//a" //where number will increment 
```

谢谢你的建议对你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:33:16.397

**使用**：

```
/*/h4[1]/following-sibling::a[not(preceding-sibling::h4[2])]/text() 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
   <xsl:copy-of select=
   "/*/h4[1]/following-sibling::a[not(preceding-sibling::h4[2])]/text()"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**（提供的片段，包装在单个顶部元素中以成为格式良好的 XML 文档）时：

```
<html>
    <h4>Random name</h4>
    <a href="link" target="target"> Text I want to get </a>
    <a href="link2" target="target2"> Text I want to get 2 </a>
    <a href="link3" target="target3"> Text I want to get 3 </a>
    <a href="link4" target="target4"> Text I want to get 4 </a>
    <h4> Random name 2 </h4>
    <a href="link" target="target"> Text I don't want to get </a>
</html> 
```

**计算 Xpath 表达式并将所有选定的（文本）节点复制到输出：**

```
 Text I want to get  Text I want to get 2  Text I want to get 3  Text I want to get 4 
```

# ios - 调整图像大小以适应 UIImageView

> ID：12552785
> 
> 赞同：24
> 
> 时间：2012-09-23T13:36:38.440
> 
> 标签：ios, objective-c, uiimageview, uiimage

我对目标 c 非常陌生，我只是在了解我的方位。我想做一些非常简单的事情，但事实证明这是一个相当大的挑战：

我正在尝试将图像显示到`UIImageView`. 我显示的图像很大，我希望它按比例缩小以适应`UIImageView`. 我尝试设置`AspectFit`查看模式，但图像显示为原始大小并被`UIImageView`. 我的代码如下：

```
- (void)changeImages
{
    UIImage* img11 = nil;

    img11 = [UIImage imageWithContentsOfFile: [[NSBundle mainBundle] pathForResource:@"dog" ofType:@"jpeg"]];

    u11.contentMode = UIViewContentModeScaleAspectFit;
    u11.image = img11;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self changeImages];
} 
```

任何人都可以对此有所了解吗？

谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-23T14:02:37.300

嗨，我会试试这个...

```
- (void)changeImages
{
    UIImage *img11 = [UIImage imageNamed@"dog.jpeg"];

    u11.contentMode = UIViewContentModeScaleAspectFit;
    u11.clipsToBounds = YES;
    [u11 setImage:img11];
}

- (void)viewWillAppear:animated
{
    [super viewWillAppear:animated];

    [self changeImages];
} 
```

这将缩放图像（向上或向下），使其适合 imageView。拥有 clipsToBounds 不是必需的，但会阻止图像显示在 imageView 的框架之外。

HTH。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-24T11:53:07.067

添加到你的 UIViewController.m：

```
-(UIImage *)resizeImage:(UIImage *)image imageSize:(CGSize)size
{
    UIGraphicsBeginImageContext(size);
    [image drawInRect:CGRectMake(0,0,size.width,size.height)];
    UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
    // here is the scaled image which has been changed to the size specified
    UIGraphicsEndImageContext();
    return newImage;
} 
```

使用：

```
UIImage *image = [UIImage imageNamed:@"image.png"];
CGSize size = CGSizeMake(50, 63); // set the width and height 
UIImage *resizedImage = [self resizeImage:image imageSize:size]; 
```

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-23T05:19:21.110

```
CGSize size=CGSizeMake(79, 84);//set the width and height
UIGraphicsBeginImageContext(size);
[image drawInRect:CGRectMake(0,0,size.width,size.height)];
UIImage * newImage = UIGraphicsGetImageFromCurrentImageContext();
//here is the scaled image which has been changed to the size specified
UIGraphicsEndImageContext(); 
```

这肯定有效，不要忘记导入 QuartzCore FrameWork..

祝你编码愉快 (^_^)....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-15T04:14:26.757

您还可以在 Interface Builder 的 Attributes Inspector 中将 View:Mode 设置为 Aspect Fit

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-15T15:48:18.410

我知道这已经过时了，但我想根据斯坦福 193p 2017 第 11 讲（大约 18:45）添加一个响应，并且对于任何快速查看的人，因为这是为我显示的第一个搜索结果。

基本上，子类 UIView 并使其看起来像：

```
class U11: UIView {
    var myImage: UIImage? { didSet { setNeedsDisplay() }}
    override func draw(_ rect: CGRect) {
        myImage?.draw(in: bounds)
    }
} 
```

然后设置图像：

```
func changeImage() {
    if let img11 = UIImage(named: "dog.jpeg"){
            u11.myImage = img11
    }
} 
```

这非常简单，图像占据了视图边界内的整个空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-15T20:01:43.203

我做了以下操作，它帮助将模式从默认值“缩放填充”更改为“纵横比填充”

并添加如下代码行（我是在单元格配置中完成的）：

```
cell.photo.clipsToBounds = true 
```

# zend-framework - 教义错误=类不存在

> ID：12552789
> 
> 赞同：0
> 
> 时间：2012-09-23T13:37:16.793
> 
> 标签：zend-framework, frameworks, doctrine

不知道我在哪里出错了。刚接触 Doctrine，它可能很简单。

我试图将一个新的注册用户保存到 Account 表中，然后在相关的 Profile 表中创建一个条目，然后将 Profile id 存储在 Accounts profile_id 字段中。

我得到的错误是

```
Application error
Exception information:

Message: Class does not exist
Stack trace:

#0 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/Mapping/ClassMetadata.php(67): ReflectionClass->__construct('')
#1 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/Mapping/ClassMetadataFactory.php(350): Doctrine\ORM\Mapping\ClassMetadata->__construct(false)
#2 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/Mapping/ClassMetadataFactory.php(260): Doctrine\ORM\Mapping\ClassMetadataFactory->newClassMetadataInstance(false)
#3 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/Mapping/ClassMetadataFactory.php(169): Doctrine\ORM\Mapping\ClassMetadataFactory->loadMetadata(false)
#4 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/EntityManager.php(247): Doctrine\ORM\Mapping\ClassMetadataFactory->getMetadataFor(false)
#5 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/UnitOfWork.php(1222): Doctrine\ORM\EntityManager->getClassMetadata(false)
#6 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/UnitOfWork.php(1678): Doctrine\ORM\UnitOfWork->doPersist(1, Array)
#7 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/UnitOfWork.php(1252): Doctrine\ORM\UnitOfWork->cascadePersist(Object(GDS\Entity\Profile), Array)
#8 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/UnitOfWork.php(1201): Doctrine\ORM\UnitOfWork->doPersist(Object(GDS\Entity\Profile), Array)
#9 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Doctrine/ORM/EntityManager.php(454): Doctrine\ORM\UnitOfWork->persist(Object(GDS\Entity\Profile))
#10 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/application/controllers/MemberinfoController.php(81): Doctrine\ORM\EntityManager->persist(Object(GDS\Entity\Profile))
#11 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Zend/Controller/Action.php(516): MemberinfoController->registerAction()
#12 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Zend/Controller/Dispatcher/Standard.php(295): Zend_Controller_Action->dispatch('registerAction')
#13 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Zend/Controller/Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#14 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Zend/Application/Bootstrap/Bootstrap.php(97): Zend_Controller_Front->dispatch()
#15 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/library/Zend/Application.php(366): Zend_Application_Bootstrap_Bootstrap->run()
#16 /Library/Server/Web/Data/Sites/euphoriagaming/public_html/public/index.php(25): Zend_Application->run()
#17 {main} 
```

控制器内的 registerAction

```
if ($form->isValid($this->_request->getPost()))
        {   // Valid input
            $username = $this->getRequest()->getParam('username');
            $email = $this->getRequest()->getParam('email');
            $emailconfirm  = $this->getRequest()->getParam('emailconfirm');
            $password = $this->getRequest()->getParam('password');
            $passwordconfirm  = $this->getRequest()->getParam('passwordconfirm');

            $pwdMD5 = md5($password);
            $emailValidateString = md5($username);

            $em = $this->entityManager;

            $account = new GDS\Entity\Account;

            $account->setUsername($username);
            $account->setEmailaddress($email);
            $account->setPassword($pwdMD5);
            $account->setValidationstring($emailValidateString);
            $account->setAccountvalidated(false);

            $em->persist($account);
            $em->flush();

            $accounts = $account = $em->getRepository('GDS\Entity\Account')
                ->findOneBy(array('emailaddress' => $email));

            // Set up initial profile db entry
            $accountProfile = new GDS\Entity\Profile;
            $accountProfile->setAccountId($accounts->getId());

            $em->persist($accountProfile);
            $em->flush();

            $accountProfileDbEntry = $em->getRepository('GDS\Entity\Profile')
                                ->findOneBy(array('AccountId' => $accounts->getId()));

            $ProfileId = $accountProfileDbEntry->getId();

            // Update the Account table entry with the profile Id
            $account->setProfileId($ProfileId);
            $em->persist($account);
            $em->flush();
        } 
```

账户实体

```
namespace GDS\Entity;
/**
 * @Entity(repositoryClass="GDS\Entity\Repository\AccountRepository")
 */
class Account
{
    public function setAccountvalidated($accountvalidated)
    {
        $this->accountvalidated = $accountvalidated;
    }

    public function getAccountvalidated()
    {
        return $this->accountvalidated;
    }

    public function setEmailaddress($emailaddress)
    {
        $this->emailaddress = $emailaddress;
    }

    public function getEmailaddress()
    {
        return $this->emailaddress;
    }

    public function setPassword($password)
    {
        $this->password = $password;
    }

    public function getPassword()
    {
        return $this->password;
    }

    public function setUsername($username)
    {
        $this->username = $username;
    }

    public function getUsername()
    {
        return $this->username;
    }

    public function setProfileId($profile_id)
    {
        $this->profile_id = $profile_id;
    }

    public function getProfileId()
    {
        return $this->profile_id;
    }

    public function setValidationstring($validationstring)
    {
        $this->validationstring = $validationstring;
    }

    public function getValidationstring()
    {
        return $this->validationstring;
    }

    /**
     * @return int
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * @var integer $id
     * @Column(name="id", type="integer",nullable=false)
     * @Id
     * @GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @OneToOne(targetEntity="Profile", mappedBy="account", cascade={"persist"})
     */

    private $profile_id;

    /**
     * @Column(type="string", unique=true, length="25", nullable=false)
     */
    private $username;

    /**
     * @Column(type="string", length="25", nullable=true)
     */
    private $password;

    /**
     * @Column(type="string", unique=true, length="75", nullable=false)
     */
    private $emailaddress;

    /**
     * @Column(type="boolean", nullable=false)
     */
    private $accountvalidated;

    /**
    * @Column(type="string", length="125", nullable=true)
    */
    private $validationstring;
} 
```

个人资料实体

```
namespace GDS\Entity;
/**
 * @Entity(repositoryClass="GDS\Entity\Repository\ProfileRepository")
 */
class Profile
{
    public function setAboutme($aboutme)
    {
        $this->aboutme = $aboutme;
    }

    public function getAboutme()
    {
        return $this->aboutme;
    }

    public function setAccountId($account_id)
    {
        $this->account_id = $account_id;
    }

    public function getAccountId()
    {
        return $this->account_id;
    }

    public function setContactnameBattlelog($contactname_battlelog)
    {
        $this->contactname_battlelog = $contactname_battlelog;
    }

    public function getContactnameBattlelog()
    {
        return $this->contactname_battlelog;
    }

    public function setContactnameGw2($contactname_gw2)
    {
        $this->contactname_gw2 = $contactname_gw2;
    }

    public function getContactnameGw2()
    {
        return $this->contactname_gw2;
    }

    public function setFirstname($firstname)
    {
        $this->firstname = $firstname;
    }

    public function getFirstname()
    {
        return $this->firstname;
    }

    /**
     * @var integer $id
     * @Column(name="id", type="integer",nullable=false)
     * @Id
     * @GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @return int
     */
    public function getId()
    {
        return $this->id;
    }

    public function setImageprofile($imageprofile)
    {
        $this->imageprofile = $imageprofile;
    }

    public function getImageprofile()
    {
        return $this->imageprofile;
    }

    public function setLastname($lastname)
    {
        $this->lastname = $lastname;
    }

    public function getLastname()
    {
        return $this->lastname;
    }

    public function setTeamspeakname($teamspeakname)
    {
        $this->teamspeakname = $teamspeakname;
    }

    public function getTeamspeakname()
    {
        return $this->teamspeakname;
    }

    public function setWebsite($website)
    {
        $this->website = $website;
    }

    public function getWebsite()
    {
        return $this->website;
    }

    /**
     * @OneToOne(targetEntity="Account", inversedBy="profile", cascade={"persist"})
     * @JoinColumn(name="account_id", referencedColumnName="id")
     */

    private $account_id;

    /**
     * @Column(type="string", length="25", nullable=true)
     */
    private $firstname;

    /**
     * @Column(type="string", length="25", nullable=true)
     */
    private $lastname;

    /**
     * @Column(type="string", length="25", nullable=true)
     */
    private $imageprofile;

    /**
     * @Column(type="string", length="50", nullable=true)
     */
    private $website;

    /**
     * @Column(type="string", length="50", nullable=true)
     */
    private $teamspeakname;

    /**
     * @Column(type="string", length="50", nullable=true)
     */
    private $contactname_gw2;

    /**
     * @Column(type="string", length="50", nullable=true)
     */
    private $contactname_battlelog;

    /**
     * @Column(type="text", length="500", nullable=true)
     */
    private $aboutme;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:54:03.873

1.  您的映射不正确。
2.  你不需要调用persist两次

例如：

```
class Account
{ 
    /**
    * @OneToOne(targetEntity="Profile", mappedBy="account", cascade={"persist"})
    */
    private $profile;

    public function setProfile(Profile $profile)
    {
        $this->profile = $profile;
        $profile->setAccount($this);
    }
}

class Profile
{
    /**
    * @OneToOne(targetEntity="Account", inversedBy="profile", cascade={"persist"})
    */
    private $account;

    public function setAccount(Account $account)
    {
        $this->account = $account; 
    }
} 
```

进入你的控制器：

```
$account = new GDS\Entity\Account;
$profile = new GDS\Entity\Profile;

$account->setProfile($profile);
$em->persist($account);
$em->flush(); 
```

配置文件实体自动保留（cascade={“persist”}）

对不起我的英语不好。

# database-design - 什么时候可以不规范化？

> ID：12552790
> 
> 赞同：8
> 
> 时间：2012-09-23T13:37:25.277
> 
> 标签：database-design

考虑以下关系来说明我的问题：

```
Person( name, street, city, zipcode )

name -> street , city , zipcode
street + city -> zipcode 
```

所以如果我们知道名字，我们也知道这个人住在哪里。但是邮政编码也（瞬态）依赖于街道+城市。因此，这种关系中断`3NF`，应该分成两个表以符合要求。

但是在这种情况下，我们对将邮政编码作为一个单独的实体不感兴趣。它是地址的一部分，恰好是一个瞬态依赖。我们永远不会单独使用它。

我明白为什么标准化是一件好事。但是真的有必要*总是*规范化（从而使数据库更复杂）吗？如果没有，你怎么知道什么时候可以跳过？

*（如果我的术语或符号有误，欢迎您纠正我）*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T16:10:25.060

除了性能之外，未完全规范化的另一个原因可能是您的数据中是否存在某种“模糊性”。

据我了解¹，ZIP 可能特定于城市街区或区域，这意味着一条特别长的街道可能有多个 ZIP。即使 ZIP 确实对应于美国的城市+街道，如果您决定走向国际，其他国家的邮政编码可能并非如此。

但即使*假设*ZIP 确实是特定于城市+街道的，人类也可能自己输入地址信息，这意味着他们可能会犯错误，包括不正确的 ZIP。因此，您最终可能会为相同的城市和街道组合使用两个 ZIP。

完全规范化的数据库根本无法表示 - 您必须以*某种方式*选择其中一个 ZIP 。除非您有权访问所有 ZIP 的完整、最新数据库，否则您没有解决此冲突的好方法。如果您最终选择了错误的 ZIP，同一城市+街道上的**所有人都将拥有错误的 ZIP。**

另一方面，去规范化的数据库会让每个人都保留自己的 ZIP，然后在与其他人**隔离的情况下承受后果。**你甚至可以实现一个自动完成的建议，然后“你确定吗？” 警告如果用户为已经有 ZIP 的现有城市+街道输入不同的 ZIP，但如果他表示确定，则让他（或她）继续。

* * *

*¹而且我不住在美国，所以我可能会离开。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-23T20:35:49.830

规范化是一种用于分析依赖关系并确保正确实施表示为依赖关系的数据完整性规则（业务规则）的工具。规范化的一个基本假设是您知道或可以确定您实际想要实施的业务规则。如果您已经确定不想或不需要执行给定的业务规则，那么在为其设计数据库时将其视为依赖项可能没有什么价值。请记住，依赖关系的要点是，对于数据库中所有可能的数据，一条规则始终有效；不仅适用于当前数据或某些特定的数据子集。

可能存在依赖关系 {street,city} -> {zipcode} 并不是系统真正需要的业务规则，因此不应强制执行。例如，如果必须在没有地址验证软件的情况下输入数据，那么以这种方式确保邮政编码一致可能是不切实际的。这并不意味着您违反了任何规范化规则。它只是意味着函数依赖不打算持有也不持有，因此它不是任何真正意义上的传递依赖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-23T20:26:05.610

一路推动规范化的价值和成本取决于。这主要取决于您将如何处理数据。

（至少）有两种完全不同的方式来使用数据。一种是在线事务处理 (OLTP)。另一种是在线分析处理（OLAP）。

在 OLTP 中，不规范化的成本可能相当高。事务变得更复杂和更慢，并且瓶颈会降低性能。在 OLAP 中，规范化的好处是有限的，而且还有其他设计规程可以为同样的工作产生更多的好处。这些替代方案之一是星型模式设计，您可以查找它。

但与其说是不规范化或反规范化，不如说是遵循不同的设计原则，即使它不会产生规范化的数据库。

回到您概述的特定情况，有很多系统在客户活动中存在繁重的事务负载，但客户表在这些事务中用于只读目的。

不符合 3NF 只会在您必须输入新客户时伤害您，而当已经有其他客户具有相同的城市、街道和邮政编码时，您必须重新输入邮政编码。如果邮局更改给定街道的邮政编码分配，您将不得不更新大量地址，而不仅仅是规范化表中的一行。

这不是一个很高的成本，也不是一个很可能发生的事件。

另一方面，邮局选择一条街道并将这条街道分成两个邮政编码的可能性有多大，具体取决于地址所在街道的哪个街区？如果后一种情况发生，实际上你最好使用违反 3NF 的结构。您可以使用邮局提供的有关拆分的信息，为每个地址自由输入不同的邮政编码。

那么，第二种情况的可能性有多大？我认为这比第一次更有可能。但是您需要根据自己的猜测进行猜测，而不是我的猜测。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-23T22:31:08.233

我不是美国人，所以我很犹豫要不要这么说，但我认为你不了解邮政编码。一些*单独的建筑物*有自己的邮政编码。邮政编码可以跨越州界。邮政编码可以代表具有任何地理意义的邮政信箱。

所以，不管规范化的好处如何，你的例子都是一个不好的选择。（街道，城市）和邮政编码之间没有明确的相关性。

有可能我错了，但我知道在英国的街道（即使是很短的街道）可以有多个邮政编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T14:04:20.747

如果 {street, city}->{zipcode}，则需要让 dbms 知道该约束，以便 dbms 可以强制执行它。否则，您很快就会得到如下所示的数据。

```
name           street              city              zipcode
--
Barack Obama   Pennsylvania Ave    Washington, DC    90210 
```

90210 是一个邮政编码，但它是针对加利福尼亚州比佛利山庄的。

这是一个罕见的应用程序，可以真正容忍这样的不良数据。

# android - android中的自定义ListView不起作用

> ID：12552793
> 
> 赞同：0
> 
> 时间：2012-09-23T13:37:45.663
> 
> 标签：android, android-listview

当我想在 android 中制作自定义列表视图时遇到问题。

MyListView 类：

```
public class MyListView extends ArrayAdapter<Quotes> {

    Context context;
    int resource ;
    private final List<Quotes> items;
    public MyListView(Context context,int resourse , List<Quotes> items){
        super(context, resourse,items);
        this.resource = resourse;
        this.items = items;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

    try {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.list_item, null);
        }
        Quotes item = items.get(position);
        TextView text = (TextView) v.findViewById(R.id.listItemText);
        TextView id = (TextView) v.findViewById(R.id.listItemId);
        text.setText(item.getText());
        id.setText(item.getID());
    } catch (NullPointerException e) {
        e.printStackTrace();
        Log.e("Error Saeed", e.getMessage());
    }
    return convertView;
}

} 
```

并在 onCreate 方法的 MainActivity 中：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        DatabaseHandler db = new DatabaseHandler(this);
        final ListView lv = (ListView)findViewById(R.id.listView1);
        MyListView adapter = new MyListView(this, R.layout.list_item, db.getAllQuotes());
        lv.setAdapter(adapter);       
    } 
```

DatabaseHander 类

```
public class DatabaseHandler extends SQLiteOpenHelper {

....
....

        public List<Quotes> getAllQuotes(){
        SQLiteDatabase db = getWritableDatabase();
        Cursor c = db.rawQuery("select * from "+TABLE_QUOTE,null);
        List<Quotes> quotes = new ArrayList<Quotes>();
        if(c.moveToFirst()){
            do{
                Quotes q = new Quotes(Integer.parseInt(c.getString(0)),c.getString(1),c.getString(2));
                quotes.add(q);
            }while(c.moveToNext());
        }
        db.close();
        c.close();
        return quotes;
    }

...
...
} 
```

当我运行应用程序时，它会出错并关闭。

[在这个链接中你可以看到 log.txt](http://phpro.ir/log.txt)

哪里有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T13:48:09.590

您可能有一个`NullPointerException`，因为您没有`ViewHolder`在`getView`方法中初始化 when `convertView`is `null`：

```
ViewHolder holder = null;
Quotes item = items.get(position);
if(convertView == null){
        convertView = inflater.inflate(R.layout.list_item, null);
        holder = new ViewHolder();
        holder.txtTitle = (TextView) convertView.findViewById(R.id.listItemText);
        holder.txtID = (TextView)convertView.findViewById(R.id.listItemId);
        convertView.setTag(holder); 
} else {
        holder = (ViewHolder) convertView.getTag();
} 
```

您的代码中可能存在其他问题。

# .htaccess - 使用 htaccess 根据用户 IP 地址更改域名

> ID：12552797
> 
> 赞同：0
> 
> 时间：2012-09-23T13:38:49.347
> 
> 标签：.htaccess, mod-rewrite

我有一个服务于国际市场的网站，需要根据用户的 IP 使用 3 个不同的域名之一。

以下是用例：

*   来自英国的用户 IP，域名显示为 www.example.co.uk
*   来自澳大利亚的用户 IP，域名显示为 www.example.co.au
*   所有其他 IP，域名显示为 www.example.com

在答案中，我不需要知道每个国家/地区要使用的确切 IP 地址，因此您可以在答案中使用通用 IP - 除非您想加倍努力并根据国家/地区的实际 IP 创建它给定的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T01:01:20.203

你需要[安装 mod_geoip](http://dev.maxmind.com/geoip/mod_geoip2)然后你可以使用 mod_rewrite 来使用它：

```
# stuff for initializing mod_geoip
GeoIPEnable On
GeoIPDBFile /path/to/GeoIP.dat

RewriteEngine on

# rules per country
# User IP from the UK, domain name appears as www.example.co.uk
RewriteCond %{ENV:GEOIP_COUNTRY_CODE} ^GB$
RewriteCond %{HTTP_HOST} !example.co.uk [NC]
RewriteRule ^/?(.*)$ http://www.example.co.uk/$1 [R,L]

# User IP from Australia, domain name appears as www.example.co.au
RewriteCond %{ENV:GEOIP_COUNTRY_CODE} ^AU$
RewriteCond %{HTTP_HOST} !example.co.au [NC]
RewriteRule ^/?(.*)$ http://www.example.co.au/$1 [R,L]

# All other IPs, domain name appears as www.example.com
RewriteCond %{ENV:GEOIP_COUNTRY_CODE} !^GB$
RewriteCond %{ENV:GEOIP_COUNTRY_CODE} !^AU$
RewriteCond %{HTTP_HOST} !example.com [NC]
RewriteRule ^/?(.*)$ http://www.example.com/$1 [R,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T15:42:35.570

我认为在索引文件的开头使用 PHP 代码会更容易。`$_SERVER['REMOTE_ADDR']`

# javascript - 使用回调循环遍历数组

> ID：12552803
> 
> 赞同：0
> 
> 时间：2012-09-23T13:39:43.227
> 
> 标签：javascript, jquery, ajax, arrays, callback

我试图通过发送到 php 文件的数组运行，并在 php 完成下载后在回调中发送下一个值。这是我到目前为止所拥有的。

我的数组如下所示。

```
["http://example.com/test1.zip", "http://example.com/test2.zip", "http://example.com/test3.zip", "http://example.com/test4.zip", "http://example.com/test5.zip"] 
```

以上是 console.log(values) 的输出；以下。它从复选框值中获取一些 url。

```
$('.geturls').live('click',function(){

    var values = new Array();
    $.each($("input[name='downloadQue[]']:checked"), function() {
      values.push($(this).val());

       ajaxRequest($(this).val(),function(response){

            console.log(response);

       });  

    });

    console.log(values);

    return false;
}); 
```

然后这会调用一个 ajax 函数，我正在尝试对其进行回调。

```
function ajaxRequest(urlSend,callback){

    var send = {
            url: urlSend
        }

    $.ajax({
          type: "POST",
          url: "<?php echo base_url(); ?>index.php/upload",
          data: send,
          //dataType: "json",
          //timeout: 8000,
          beforeSend: function() {

          },
          success: function(response) {

             callback('added');

          },
          error: function (response) {

                     callback('false');

          }
     });

} 
```

然后这将发送到一个 php 文件。

```
function upload(){
   $output = shell_exec("wget {$_POST['url']} 2>&1");      
   return true;
} 
```

我想要做的是从一个已完全下载的 url 回调之后，然后从数组中获取下一个值并下载该 url，依此类推，直到数组中的所有 url 都被完全下载。

目前它只是下载第一个值然后崩溃，因为在返回 true 的返回值后它不会重新启动循环。

希望这对那些只是在寻找一些帮助的人有意义，以便在完成后通过回调循环遍历一组值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:53:47.877

可能这个结构可以帮助你。在这个变体中，只有在前一个 Ajax 调用成功完成后，您才会转到下一个 URL。

```
 var arr = ['url0','url1','url2','url3'];
    var index = 0;

    function Run(){
         DoAjax(arr[index]);
    }
    function Next( ){
        if(arr.count = index-1)
        {
             index =0;
             return;  
        }else{
           DoAjax(arr[index ]);
        }
    }    

    function DoAjax(url){

         $.ajax({
          type: "POST",
          url: url,
          data: send,
          beforeSend: function() {

          },
          success: function(response) {
             index ++;
             Next();
             // Addition logic if needed
          },
          error: function (response) {

          }
     });
    }

Run() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:38:21.447

现在我有更多的时间，我认为最好展示一个替代方案，它利用 jquery ajax 现在实现为延迟的事实。这意味着您可以使用管道链接为您完成所有工作。我还利用延迟行为消除了回调。

这应该给你的想法。

```
// Use jquery deferred pipe chaining to force 
// async functions to run sequentially

var dfd = $.Deferred(),
    dfdNext = dfd,
    x,
    values = [],

    // The important thing to understand here is that 
    // you are returning the value of $.ajax to the caller.
    // The caller will then get the promise from the deferred.
    ajaxRequest = function (urlSend) {

        var send = {
            url: urlSend
        }

        return  $.ajax({
            type: "POST",
            url: "<?php echo base_url(); ?>index.php/upload",
            data: send,
        });
    };

// Starts things running.  You should be able to put this anywhere 
// in the script, including at the end and the code will work the same.

dfd.resolve();

// Deferred pipe chaining.  This is the main part of the logic.
// What you want to note here is that a new ajax call will 
// not start until the previous
// ajax call is completely finished.
// Also note that we've moved the code that would
// normally be in the callback.
// Finally notice how we are chaining the pipes by
// replacing dfdNext with the return value from the
// current pipe.
for (x = 1; x <= 4; x++) {

    values.push(x);

    dfdNext = dfdNext.pipe(function () {
        var value = values.shift();
        return requestAjax(value).
            done(function(response) {
                // Code here that you would have 
                // put in your callback.
                console.log(response);
            }).
            fail(function(response) {
                console.log(response);
            };

    });

} 
```

[您可以在 jsFiddle 上玩的](http://jsfiddle.net/tchaffee/8qhwr/)工作示例。

# html - rtl HTML页面中的方向ltr

> ID：12552804
> 
> 赞同：12
> 
> 时间：2012-09-23T13:39:43.450
> 
> 标签：html, css, right-to-left

我试图在 rtl HTML 页面中显示一个负数。

标签似乎没有回应我的`direction: ltr`

我写了一个[jsFiddle](http://jsfiddle.net/opmaster/rWSXX/1/)来显示相反的场景（试图从右到左显示）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T13:42:48.190

添加`unicode-bidi: embed;`到您的 CSS。应该做的伎俩 -[更新小提琴](http://jsfiddle.net/henrikandersson/rWSXX/2/)

[你可以在这里](https://developer.mozilla.org/en-US/docs/Web/CSS/unicode-bidi)找到用法

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-23T20:12:33.860

`direction: ltr`不把减号放在数字左边的原因是周围的字符是从右到左的字符，使得像数字和减号（或连字符）这样的“中性”字符具有这种方向性。该[`direction`属性](http://www.w3.org/TR/CSS2/visuren.html#direction)影响盒子的*布局方向*和相关问题，而不是文本的书写方向。

考虑以下：

```
<p>א <label id="ProfitShk" class="labelVal">-9 ₪&lt;/label> ת
<p>a <label id="ProfitShk" class="labelVal">-9 ₪&lt;/label> b 
```

在第一种情况下，连字符出现在数字 9 的右侧，遵循周围文本的书写方向。第二种情况，顺序相反，因为周围的字符是拉丁字母，具有固有的从左到右的方向性。

这是一个棘手的问题，希伯来语中的某些页面似乎使用了将连字符放在 HTML 源代码中的数字后的技巧，因此当应用从右到左书写时，连字符出现在数字的左侧。

更合适的方法是：

1.  在`unicode-bidi: bidi-override`CSS 中与`direction`. 这意味着在内容中忽略固有的方向性，并`direction`应用 指定的顺序。
2.  在`unicode-bidi: embed`CSS 中与`direction`. 这会创建一个“方向性孤岛”，其中周围的文本不会影响方向性。当元素内容仅包含“中性”字符时，该`direction`属性设置文本方向。
3.  在 HTML 中使用`<bdo>`元素，带有`dir`属性。这是方法 2 的 HTML 对应物，更好的是，这不是关于样式表示建议（这是 CSS 的用途和最擅长的），而是关于让事情正确，处理方向性方面的一些基本问题。
4.  在字符串前后使用从左到右和从右到左的标记。它们可以在 HTML 中分别表示为`&lrm;`和`&rlm;`。这使得字符串之前的最后一个字符成为从左到右的标记，如果它只包含“中性”字符，则导致它从左到右显示。

这是一个复杂问题的简化介绍。无论如何，使用`<bdo>`可能是最好的方法。在所有方法中，方向性的设置都应限制为尽可能小的字符串，例如示例中的 -9：

```
<p>א <label id="ProfitShk" class="labelVal"><bdo dir="ltr">-9</bdo> ₪&lt;/label> ת 
```

用作减号的字符实际上应该是 Unicode 减号“-” U+2212 MINUS SIGN，在 HTML 中表示为`&minus;`，但这不会影响方向性问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T23:17:25.330

除了 Henrik 的回答之外，我还会在减号之前添加一个 LRM 控制字符，如下所示：

```
<label id="ProfitShk" class="labelVal">&lrm;-9 ₪&lt;/label>​​​​​​​​​​​​​​​​​​​​​​ 
```

这样，减号就会放在 9 之前（这可能是你想要的）

这个[微软文档](http://www.microsoft.com/middleeast/msdn/control.aspx)解释了 LRM 控制字符以及其他控制字符。

# php - 使用 curl https 站点发送表单

> ID：12552807
> 
> 赞同：0
> 
> 时间：2012-09-23T13:40:05.487
> 
> 标签：php, curl, https

我有个问题。我想使用 curl 发送表单，但它不起作用。表格在这个网址中：[https](https://www.reporo.com/analytics/inventory-advertiser-banner.php?clientid=1234&campaignid=12345&type=smrc) ://www.reporo.com/analytics/inventory-advertiser-banner.php?clientid=1234&campaignid=12345&type=smrc 。

这是表单代码：

```
<form name='bannerForm' id='bannerForm' action='inventory-advertiser-banner-update.php' method='POST' enctype='multipart/form-data'> 
```

问题是当我进入浏览器这个网址时：`https://www.reporo.com/analytics/inventory-advertiser-banner-update.php`- 它会将我重定向到登录页面。当我使用 curl 时也是如此，这是我的问题。

我不知道为什么当我点击表单页面中的“提交”时我只能手动发送表单 - 这个网址：`http://reporo.com/analytics/inventory-advertiser-banner.php?clientid=1234&campaignid=12345&type=smrc`

可能是什么问题？我该如何解决这个问题？

# c# - MouseHover 和 MouseLeave 事件控制

> ID：12552809
> 
> 赞同：3
> 
> 时间：2012-09-23T13:40:47.707
> 
> 标签：c#, opacity

我正在构建一个简单的表单，具有一个简单的效果——当鼠标不在表单上时，不透明度会降低，当鼠标在表单上时，表单会变得不透明。我目前遇到了几个困难：-

1.  首先，我这样做了——

    ```
     this.MouseHover += new EventHandler(Form1_MouseHover);
     this.MouseLeave += new EventHandler(Form1_MouseLeave); 
    ```

    但是我的表单中也有 1 个richtextbox，当鼠标移过它时，表单再次失去了不透明度。我也必须添加这个：-

    ```
     richTextBox1.MouseHover+=new EventHandler(Form1_MouseHover);
     richTextBox1.MouseLeave+=new EventHandler(Form1_MouseLeave); 
    ```

    想知道是否有更好的方法，因为richtextbox和表单边界之间仍然存在一些差距，当鼠标光标移到那里时，表单正在失去不透明度。

2.  如果鼠标不在表单上（假设最初），则表单不透明。现在，我希望一旦鼠标移过它，表单就会变得不透明，但只有当鼠标在表单上移动完全停止时才会发生这种情况。如果我继续将鼠标移到表单上，它不会变得不透明。这是事件存储在消息队列中的方式的问题吗？或者我能做些什么，因为我已经看到了我正在尝试实现的效果的应用程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T14:11:10.557

MouseEnter/Leave 事件太不可靠，无法执行此操作。最好的办法是使用一个计时器来检查鼠标是否仍在窗口内。在表单上放置一个 Timer 并使代码如下所示：

```
public partial class Form1 : Form {
    public Form1() {
        InitializeComponent();
        this.Opacity = 0.99;
        timer1.Interval = 200;
        timer1.Enabled = true;
        timer1.Tick += timer1_Tick;
    }
    protected override void OnLoad(EventArgs e) {
        base.OnLoad(e);
        timer1_Tick(this, e);
    }
    private void timer1_Tick(object sender, EventArgs e) {
        this.Opacity = this.Bounds.Contains(this.PointToClient(Cursor.Position)) ? 0.99 : 0.20;
    }
} 
```

顺便说一句：避免将不透明度增加到 1.0，这会强制重新创建本机窗口，并且可能会产生很多副作用。最好使用 0.99。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-23T13:46:31.247

我可能错了，但你为什么要使用 MouseHover 事件？[MouseHover](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousehover.aspx)检测鼠标何时停止在窗体上移动，通常用于显示工具提示。

您要查找的事件是[MouseEnter ，它与](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseenter.aspx)[MouseLeave](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseleave.aspx)相反，可检测鼠标何时进入窗口的客户端矩形。

在离开事件中，只需检查光标位置是否在窗口客户端矩形中，以了解它是否确实离开了表单，或者它是否只是在子控件的顶部。

Ofc 如果您使用区域，则必须调整代码。

```
 private void Form1_MouseEnter(object sender, EventArgs e)
    {
        this.Opacity = 1;
    }

    private void Form1_MouseLeave(object sender, EventArgs e)
    {

        if (!this.ClientRectangle.Contains(this.PointToClient(Cursor.Position)))
        {
            this.Opacity = 0.5;
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-08T00:25:17.000

添加一个计时器控件，然后在计时器的滴答事件中使用下面。如果您的表单中有自定义/用户控件，上述答案将不起作用。所以必须使用`ClientRectangle`

```
this.Opacity = this.ClientRectangle.Contains(this.PointToClient(Cursor.Position)) ? 0.99 : 0.20; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T13:54:13.357

```
private void Form1_MouseEnter(object sender, EventArgs e)
{
    this.Opacity = 1.0;
}

private void Form1_MouseLeave(object sender, EventArgs e)
{ 
    this.Opacity = 0.8;
} 
```

# c - OpenGL ES BlackBerry 10 2d 演练中 glMatrixMode() 和 glLoadIdentity() 的用途是什么

> ID：12552816
> 
> 赞同：0
> 
> 时间：2012-09-23T13:41:35.430
> 
> 标签：c, graphics, opengl-es, 3d, blackberry-playbook

在使用 opengl es 的黑莓 10 sdk 的演练中。它使用2个命令，即：

```
glMatrixMode(GL_PROJECTION);
glLoadIdentity(); 
```

然后：

```
glMatrixMode(GL_MODELVIEW);
glLoadIdentity(); 
```

我不明白这些在初始化视口时是用来做什么的。如果我去掉这些行，程序仍然可以完美运行，并且没有任何变化。

我看到它与渲染矩阵有关，但我不确定我是否理解哪个矩阵，因为这只是在我在任何类型的渲染之前进行初始化时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:50:34.910

在初始化例程中调用，它们什么都不做。两个矩阵的默认值都是标识，所以它只是将其设置为与它们已经相同的值。

至于它为什么存在，我猜有些人只是喜欢明确设置他们的上下文，以便他们确定当前值是什么，也许它更容易记住或者他们不相信上下文具有正确的默认值，我不知道。

# eclipse - 如何在 Eclipse 中仅与 SVN 共享源代码？

> ID：12552819
> 
> 赞同：0
> 
> 时间：2012-09-23T13:42:21.030
> 
> 标签：eclipse, svn, subversive

我想通过SVN分享我项目的源代码，但是我只能分享整个项目。如何仅共享项目中的源和/或特定文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:08:55.320

Right-click on the folders you don't want to put under SVN, and choose "Add to SVN ignore". Commit. The SVN will always ignore this folder.

# c++ - winapi - 清除 CBitmap 的一个区域

> ID：12552822
> 
> 赞同：2
> 
> 时间：2012-09-23T13:42:27.723
> 
> 标签：c++, windows, winapi

我有一个 32 位的`CBitmap`缓冲区，我在上面`AlphaBlend`做事。但是我想知道是否有一种方法可以完全“清除” CBitmap 的矩形区域（例如将特定区域中像素的所有 Alpha 值设置为 0 或完全清除该区域）。

我不能使用 GDI+！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T16:56:35.517

没有“清除”位图之类的东西。您只需更改像素的颜色。如果将“清晰”定义为纯黑色，则将像素设置为黑色。最简单的方法是使用[`CDC::FillRect`](http://msdn.microsoft.com/en-us/library/0421fewx.aspx).

# xcode4 - xcode 4.5 切换选项卡需要超过 2 秒

> ID：12552823
> 
> 赞同：5
> 
> 时间：2012-09-23T13:42:30.470
> 
> 标签：xcode4, xcode4.5

我升级到 XCode 4.5，当我单击一个选项卡打开它时，它需要超过 2 秒才能打开它。

任何人都经历过并解决了同样的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T18:26:46.880

看起来像一个常见的问题。[https://devforums.apple.com/thread/167765?tstart=0](https://devforums.apple.com/thread/167765?tstart=0)

错误报告已提交，希望能尽快修复。

**编辑 - 似乎已使用 XCode 4.5.1 修复**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T21:09:27.057

是的，我的经历完全一样。在我的机器上，在 Xcode 中切换标签可能需要 3-4 秒。

幸运的是，重新启动 xcode 后问题就消失了。（我知道，这是一种蹩脚的解决方法，但迄今为止我发现的唯一一个）。

# c# - 坚持 MethodInfo 作为属性

> ID：12552824
> 
> 赞同：2
> 
> 时间：2012-09-23T13:42:37.903
> 
> 标签：c#, reflection, methodinfo

我正在创建一个自定义 BindingSource 并希望将 MethodInfo 保留为私有字段。问题，在代码中：

```
public class MyBindingSource : BindingSource
{

    private MethodInfo MyMethod= null;

    protected override void OnBindingComplete(BindingCompleteEventArgs e)
    {
         this.MyMethod = GetMyMethod();
         //MyMethod is not null here
    }

    void UseMyMethod (object value)
    {
        MyMethod.Invoke(SomeObject, new object[] { value });
        //MyMethod is null here, exception thrown.
    }

} 
```

我成功存储了 MethodInfo，但是，当我尝试使用它时，它最终为空。没有调用特殊的构造函数（覆盖该字段）。OnBindingComplete 不会被调用两次。似乎没有什么暗示其他东西将其设置为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:40:34.137

`UseMethod`很可能您之前正在访问`OnBindingComplete`

但无论如何，为了防止这种情况，您可以执行以下操作：

```
public class MyBindingSource : BindingSource
{
    private MethodInfo _myMethod = null;

    private MethodInfo MyMethod
    {
        get
        {
            if(_myMethod != null) return _myMethod;

            _myMethod = GetMyMethod();
            return _myMethod;
        }
    }

    protected override void OnBindingComplete(BindingCompleteEventArgs e)
    {
    }

    void UseMyMethod (object value)
    {
        MyMethod.Invoke(SomeObject, new object[] { value });
    }
} 
```

# android - 是否可以创建锁屏功能？

> ID：12552825
> 
> 赞同：-1
> 
> 时间：2012-09-23T13:42:40.390
> 
> 标签：android

我目前正在做我最后一年的项目，正在开发一个防盗应用程序，我的想法是一旦手机被盗就用密码锁定手机屏幕，这样盗窃者将无法访问手机中的任何内容，除非他有正确的密码。是否可以创建此锁屏功能？任何人都可以给我一些指导或教程，因为我是 Android 编程的新手。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T13:45:39.687

如果您支持的最低操作系统是 2.2（Froyo，API 8），那么您可以使用[DevicePolicyManager lockNow()](http://developer.android.com/reference/android/app/admin/DevicePolicyManager.html#lockNow%28%29)方法。

如果您想了解更多有关 DevicePolicyManager 接口的信息，请尝试查看 ApiDemos 示例代码中的 DeviceAdminSample。Android SDK 随附所有示例，因此您可以轻松地将 ApiDemos 添加为 Eclipse 项目并在模拟器中运行它。

# kde - KDE和多显示器，如何在打开程序的屏幕上启动程序

> ID：12552829
> 
> 赞同：5
> 
> 时间：2012-09-23T13:43:14.603
> 
> 标签：kde, multiple-monitors

我一直在尝试 KDE，并根据自己的喜好对其进行了定制。我在每个屏幕上添加了面板和应用程序启动器，并在每个屏幕面板上显示打开的窗口。

但是，每当我从“开始菜单”或快速启动启动应用程序时，它都会出现在任何屏幕上。

有没有办法让应用程序在打开的屏幕上启动？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T18:35:53.623

在设置、谷歌和窗口规则上花了太多时间后，我终于找到了答案。

在系统设置 -> 窗口行为 -> 窗口行为 -> 焦点选项卡
中启用框“活动屏幕跟随鼠标”

# php - PHP OOP 没有返回对象

> ID：12552830
> 
> 赞同：0
> 
> 时间：2012-09-23T13:43:32.167
> 
> 标签：php, object, singleton

我无法在 php.ini 中返回对象。它只发生在我的数据库对象和所有其他工作正常，这里的代码：

```
class D {
private static $instance;
private $connected=false,$db,$mf;

public static function getInstance() {
    if (!isset(self::$instance)) {
        self::$instance = new self();
    }
    return self::$instance;
}

public function connect() {
    $mf = MF::getInstance();
    $this->r = R::getInstance();
    if($this->connected == false) {
        $this->db = new PDO('mysql:host='.$this->r->mysql_host.';dbname='.$this->r->mysql_database, $this->r->mysql_username, $this->r->mysql_password);
        if($this->db == true) {
            $this->connected = true;
            $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);  
        }else{
            $this->mf->report('Unable to connect to database',2);
        }
    }else{
        $this->mf->report('Connection already made.');
    }
}

public function query($sql) {
    try {
        $q = $this->db->query($sql);
    }
    catch(PDOException $e) { 
        trigger_error('<br>Regel: '.$e->getLine().'<br>
            Bestand: '.$e->getFile().'<br>
            Foutmelding: '.$e->getMessage().'<br>SQL: '.$sql,E_USER_ERROR); 
        die();
    } 
    return $q;
}
} 
```

现在，当我使用 D::getInstance(); 它没有返回应有的对象。只要我执行 query() 函数，它就会给我“致命错误：在非对象上调用成员函数 query()”错误。它只发生在 db 中，其他对象（如 R 和 MF）在使用 getInstance() 时工作​​正常；他们都使用相同的代码。

（是的，我首先做 $d = D::getInstance(); 然后 $d->connect(); 在我将它加载到另一个对象之前）

# qt3d - 在 QGLView 中的 QGLNode 上绘制 QWidget

> ID：12552832
> 
> 赞同：2
> 
> 时间：2012-09-23T13:43:50.063
> 
> 标签：qt3d

我使用 Qt3D 并使用 QGLView 绘制复杂的 3d 场景。

我需要在这个场景**中的 QGLNode**上绘制一些小部件，但我不知道如何。

这是我想做什么的一个最小示例（基于 qt3d 的“嵌套”演示）：

标题：

```
class CubeView : public QGLView
{
    Q_OBJECT
    Q_PROPERTY(qreal cubeAngle READ cubeAngle WRITE setCubeAngle)

public:
    CubeView(QWidget *parent = 0);
    ~CubeView();

    qreal cubeAngle() const { return cangle; }
    void setCubeAngle(qreal angle) { cangle = angle; update(); }

protected:
    void initializeGL(QGLPainter *painter);
    void paintGL(QGLPainter *painter);

private:
    QGLSceneNode *scene;
    QGLSceneNode *cube;
    QGLFramebufferObject *fbo;
    QGLFramebufferObjectSurface fboSurface;
    QGLCamera *innerCamera;
    qreal cangle;

    void drawCube(QGLPainter* painter);
    void drawFrameBuffer();
}; 
```

初始化：

```
void CubeView::initializeGL(QGLPainter *)
{
    fbo = new QGLFramebufferObject(512, 512);
    fboSurface.setFramebufferObject(fbo);
} 
```

油漆代码：

```
void CubeView::paintGL(QGLPainter *painter)
{
    painter->modelViewMatrix().push();
    painter->projectionMatrix().push();

#ifdef DRAW_GLNODE
    painter->pushSurface(&fboSurface);
#endif

    painter->setCamera(innerCamera);
    painter->modelViewMatrix().rotate(cangle, 0.0f, 1.0f, 0.0f);

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

#ifdef DRAW_GLNODE
    cube->draw(painter);
#else
    QPushButton button;
    button.resize(fbo->width(), fbo->height());
    button.render(fbo); // filling QGLFrameBuffer
#endif

    drawFrameBuffer(); // debug QPixmap with QGLFrameBuffer data

#ifdef DRAW_GLNODE
    painter->popSurface();
#endif

    painter->projectionMatrix().pop();
    painter->modelViewMatrix().pop();

    drawCube(painter);
} 
```

绘制立方体：

```
void CubeView::drawCube(QGLPainter *painter)
{
    painter->modelViewMatrix().push();

    painter->modelViewMatrix().rotate(cangle, 1.0f, 1.0f, 1.0f);

    painter->setStandardEffect(QGL::LitDecalTexture2D);

    glBindTexture(GL_TEXTURE_2D, fbo->texture());
    glEnable(GL_TEXTURE_2D);

    cube->draw(painter);

    glBindTexture(GL_TEXTURE_2D, 0);
    glDisable(GL_TEXTURE_2D);

    painter->modelViewMatrix().pop();
} 
```

当“#define DRAW_GLNODE”处于活动状态时，它将旋转立方体显示为另一个立方体内的纹理（您可以在左侧窗口中看到帧缓冲区数据）。

[http://i.stack.imgur.com/Ok4NT.png](http://i.stack.imgur.com/Ok4NT.png)

当我切换到“#define 0”时，它在 QGLView 中显示黑屏，但 QGLFrameBuffer 包含您可以看到的数据。

[http://i.stack.imgur.com/5R6Wz.png](http://i.stack.imgur.com/5R6Wz.png)

我究竟做错了什么？

# upx - UPX 不可压缩异常

> ID：12552836
> 
> 赞同：12
> 
> 时间：2012-09-23T13:44:08.047
> 
> 标签：upx

我最近做了一些关于可执行压缩的研究。在 Linux 而非 Windows 中编译`test.c`C 语言源并使用 UPX 对其进行压缩时。它在终端中列出：`UPX: test.so NotCompressibleException`。的源代码`test.c`是：

```
int main(){
    int i = 0;
    printf("HelloWorld\n");
    return 0;
} 
```

我猜是可执行文件太简单而无法压缩？或者我可能错过了什么？如果有人知道这个问题，请告诉我原因。如果没有人告诉我，我必须阅读源代码才能找出问题所在。啊! 阅读源代码的负担。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-07T21:49:01.710

输出 a 有几个原因`NotCompressibleException`，但在您的情况下，这仅仅是因为您的二进制文件的大小太小。UPX 无法处理 40Kb 以下的二进制文件。

解决此问题的最佳方法是在静态模式下编译二进制文件，以获得更大的可执行文件。因此，只需尝试：`gcc -static -o mytest mytest.c`然后`upx -o mytest-upx mytest`.

# php - MySQL - 在单个列中查询多个值

> ID：12552837
> 
> 赞同：0
> 
> 时间：2012-09-23T13:44:21.513
> 
> 标签：php, mysql, wordpress

我目前正在使用 Wordpress 的 WP-Property 插件的网站上工作。

基本上，我试图在特定价格范围的文本搜索链接旁边显示一个计数器。

下面是我正在运行的查询，它的价格范围非常好。

```
 $apartprice1 = $wpdb->get_var("SELECT COUNT(*) FROM $wpdb->postmeta WHERE meta_value BETWEEN 50000 AND 74999");
if (0 < $apartprice1) $apartprice1 = number_format($apartprice1); 
```

但是，我想对此进行扩展以仅显示此特定价格范围内的“公寓”。现在请记住，在`meta_value`列中还存储了属性类型值（公寓、房屋、永久业权）。

请问有谁可以为我揭开这个神秘面纱吗？

编辑：下面有一些进一步的阐述：

```
Table name is postmeta

meta_id     post_id     meta_key        meta_value

348         41          property_type   apartment
358         41          price           698000 
```

所以我希望能够计算一个特定的价格范围，该价格范围也基于特定的房产类型

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:49:10.053

如果您正在寻找显示每个属性值的计数`partments`, `houses`, `freeholds`，您应该添加一个`GROUP BY property_type`

```
SELECT  property_type, COUNT(*) 
FROM $wpdb->postmeta 
WHERE meta_value BETWEEN 50000 AND 74999
GROUP BY property_type 
```

**更新：**您必须将*行*转换为列，以便按照您描述的方式获取数据，如下所示：

```
SELECT t.property_type, COUNT(t.post_id) AS 'type count'
FROM
(
   SELECT t.post_id,
     MAX(CASE WHEN t.meta_key = 'property_type' THEN t.meta_value END) AS property_type,
     MAX(CASE WHEN t.meta_key = 'price' THEN CAST(t.meta_value AS DECIMAL) END) AS Price
   FROM postmeta t
   GROUP BY t.post_id
) t
WHERE t.property_type = 'apartment' 
  AND t.Price BETWEEN 600000 AND 700000
GROUP BY t.property_type 
```

请注意，该`meta_value`字段应该存储属性类型的字符串值以及`price`s 的数值，因此我`CAST`将其`DECIMAL`选择为数值数据类型，以便您稍后可以对其执行计算。我还用作`MAX`聚合函数来旋转行。

这是[**SQL fiddle 中的演示**](http://sqlfiddle.com/#!2/59a1d/5)。

这就是你通常在这样的设计模型中遇到的，他们称之为[**Entity-attribute-value model**](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)。[您可以在标签eav](/questions/tagged/eav "显示标记为“eav”的问题")下找到很多关于此数据模型的有用线程。您还可以在 [以下答案中找到有关此设计模型的更多有用页面](https://stackoverflow.com/a/8609588/722783)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T15:16:16.763

这种表结构使得执行您正在寻找的多面搜索类型有些困难/效率低下。为确保满足所有`WHERE`子句，您需要`INNER JOIN`将`meta`表设置为自身。这为您提供了一种更适合您的查询的临时数据格式。

```
SELECT m1.post_id
FROM meta m1
INNER JOIN meta m2 ON m1.post_id = m2.post_id
WHERE m1.meta_key = 'price'
AND m1.meta_value
BETWEEN 50000 AND 7000000 AND m2.meta_key = 'property_type'
AND m2.meta_value = 'apartment' 
```

请记住，对于您添加的每一个额外方面，您都需要执行额外的`INNER JOIN`. 另外，如果您还没有，我建议您在该`post_id`列上建立一个索引。

要获得计数，只需更改`SELECT`子句中的内容。

```
SELECT COUNT(*)
FROM meta m1
INNER JOIN meta m2 ON m1.post_id = m2.post_id
WHERE m1.meta_key = 'price'
AND m1.meta_value
BETWEEN 50000 AND 7000000 AND m2.meta_key = 'property_type'
AND m2.meta_value = 'apartment' 
```

# android - 屏幕顶部的黑线

> ID：12552839
> 
> 赞同：0
> 
> 时间：2012-09-23T13:44:27.410
> 
> 标签：android, xml

发生在我身上的事情非常棘手......我有这个 xml 文件作为列表视图对象的适配器的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    `android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@color/exBackGround"
    android:orientation="vertical" >
        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:background="@color/exBackGround" >
            <ImageView
                android:id="@+id/imgIcon"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:background="@color/exBackGround"
                android:src="@drawable/ic_launcher" />
            <TextView
                android:id="@+id/lblFolderName"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:layout_weight="1"
                android:background="@color/exBackGround"
                android:gravity="center_vertical"
                android:text="Medium Text"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/exForeGround" />
            <TextView
                android:id="@+id/lblNumber"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:background="@color/exBackGround"
                android:gravity="center_vertical"
                android:paddingRight="5dp"
                android:text="100"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/exForeGround" />
        </LinearLayout>
        <FrameLayout
            android:layout_width="match_parent"
            android:layout_height="1dp"
            android:background="@color/exGradEnd" >
        </FrameLayout>
</LinearLayout> 
```

我不明白为什么，这种布局导致了预期的结果，加上顶部的一条黑线，我无法理解它的来源。不幸的是，作为一个新用户，我不能发布图像，对不起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T07:39:36.517

好的问题解决了，我会自动回答我自己，以防其他人将来需要它。在 eclipse 的图形布局中看到的黑线是假的，只是来自我顶部的“显示类型”选择。我在最终应用程序中看到的黑线是 ListView 的默认分隔线。为了让它消失，我刚刚设置了 lv.setDividerHeight(0)。

# css - 动态调整ui标签、html的高度

> ID：12552840
> 
> 赞同：0
> 
> 时间：2012-09-23T13:44:35.270
> 
> 标签：css, html-lists

我正在尝试在 html 中使用 ul 标记创建表格视图。在链接中，我使用了两个 li 标签来创建两列。我使用了两张图片来展示 li 标签使用的空间，列点和行点。我提供了 html、css 和两个图像文件。

图片

![点列](../Images/13ad6eff0370f297db792dee886e2720.png) ![点行](../Images/7141ebf075ef2bb480231e8db783b56b.png) ![我得到的布局截图](../Images/7ff40e18d8eb96f73593640c0734bac9.png)

index.html -> [http://pastebin.com/d8nq8pfr](http://pastebin.com/d8nq8pfr)
style.css -> [http://pastebin.com/V7iR3ZqE](http://pastebin.com/V7iR3ZqE)

现在，如果您看到由提供的文件创建的布局，您可以看到表格布局的第二行具有不规则的高度。两个高度都来自不同的 ul 标签。

所以我的问题是，有什么方法可以使两者的高度相同（显然最高的应该被认为是相同的高度；））？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:21:25.303

Seriously consider whether this is tabular data - and if so, use `<table>`, `<tr>`, `<td>`, etc. Tables aren't evil, they just shouldn't be used for things that aren't tables. And the word "table" has a pretty broad definition... even using them for structuring forms isn't *incorrect* (although probably a bit of a semantic grey area).

However, if you decide that semantically this really is an unordered list, you can use the [CSS table model](http://www.w3.org/TR/CSS21/tables.html#table-display) to display elements "tabularly", by applying `display: table`, `display: table-row` and `display: table-cell` styles to the elements which could otherwise be `<table>`, `<tr>` and `<td>` elements respectively. See that link for the full set of values. These aren't supported in older browsers, mind (IE7 and earlier).

If you have to support IE7 (or even, god forbid, IE6), you'll have to resort to column layout patterns, which have thousands of articles dedicated to them around the internet.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:12:29.027

*如果*这是表格数据，它应该在表格中。您可以使其他元素表现得像有一些限制的表（没有行跨度/列跨度等）：

```
#title1, #title2 {
    display: table-cell;
} 
```

这在 IE7 或更早版本中不起作用。

# android - AsyncTask 和 Udp 数据包

> ID：12552841
> 
> 赞同：0
> 
> 时间：2012-09-23T13:44:38.487
> 
> 标签：android, android-asynctask

我收到“NetworkOnMainThreadException”

我正在从 AsyncTask 发送 UDP 数据包，**但从**Sensor 事件中，我猜测 Sensor 事件在主 UI 线程上触发。

我想在传感器提供新值时发送 UdpPackets，因为我无法从传感器事件中做到这一点，所以最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:23:59.450

@RaghavSood 的答案确实是可靠的（投票赞成），但我认为你应该尽量避免变通方法。所以基本上以下是Raghavs答案的2.的扩展。

我的解决方案将包括一个队列或堆栈，您可以在其中收集传感器数据，并且每隔 x 秒（不要缩小间隔）您应该启动 AsyncTask 并将数据发送到您的服务器。这有一个优点：

*   您可以防止垃圾邮件数据，包括连接和断开与您的服务器的连接。这应该可以减少手机的功耗并防止服务器被数据淹没。

还有一个缺点：

*   您的数据将在发送之前被收集，这意味着您的数据发送不会是即时的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:53:23.917

1.  将您的目标 SDK 更改为 Honeycomb 以下的任何内容，或禁用 StrictMode
2.  生成一个新线程或 AsyncTask 以将数据发送到服务器。

更改目标 SDK：

```
<uses-sdk android:minSdkVersion="<your-minimum>" android:targetSdkVersion="9" /> //9 is GB 
```

禁用严格模式：

```
StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T11:10:40.460

为每个传感器事件生成一个线程并不是很好，并且有一个单独的线程来轮询新数据也有问题（WarrenFaith 回答）。

我最终使用了一个 CyclicBarrier，就像这样，一个单独的线程内的无限循环

```
running = true;
worker = new Thread(new Runnable() {
    public void run(){

         while(running) {
             try {
                 sync.await();
                 Send();
             } catch(Exception e) {}
         }
         socket.disconnect();
    }
}); 
worker.start(); 
```

线程将停止`sync.await();`在线

直到传感器提供新数据

```
SensorEventListener allListener = new SensorEventListener() {
    public void onSensorChanged(SensorEvent event) {
        if(sendOrientation) {
            float R[] = new float[9];
            float I[] = new float[9];
            boolean success = sensorManager.getRotationMatrix(R, I, acc, mag);
            if (success) {  
                SensorManager.getOrientation(R, orientation);    
            }
        }

        if(sync.getNumberWaiting() > 0)
            sync.reset();   
    }
    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {    
    }
}; 
```

并被调用，这`sync.reset();`将使轮询线程继续进行

# objective-c - 如何定义函数宏来检查多个本地化字符串文件之间的键？

> ID：12552843
> 
> 赞同：4
> 
> 时间：2012-09-23T13:45:06.427
> 
> 标签：objective-c, ios, cocoa-touch, localization, macros

我有一个`Localizable.strings`用于项目 i18n 的文件，一个库使用`KYLocalizable.strings`.

我曾考虑从 中创建`Localizable.strings`“子类” `KYLocalizable.strings`，但据我所知，它不能。因此，我想定义一个函数宏，就像 SDK 所做的那样：

```
#define NSLocalizedString(key, comment) \
    [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:nil]
#define NSLocalizedStringFromTable(key, tbl, comment) \
    [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:(tbl)] 
```

伪代码：</p>

```
#define CustomLocalizedString(key, comment) \
    // if key exists in Localizable.strings
    //   use it
    [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:nil]
    // else
    //   search it in KYLocalizable.strings
    [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:@"KYLocalizable"] 
```

所以我可以`CustomLocalizedString(<key>, <comment>)`在我的项目中使用。
但是如何检查密钥是否存在`Localizable.strings`？

提前致谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T15:38:03.153

在本次通话中：

```
[[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:nil] 
```

如果使用指定键无法在字符串文件中找到字符串，则将使用 value 参数（当前为空字符串）**。**所以......您需要做的就是将您的第二次查找*放在 KYLocalizable.strings*作为该参数的值。代码看起来与此类似（我实际上并没有运行它，但它应该很接近）：

```
[[NSBundle mainBundle] localizedStringForKey:(key) 
    value:[[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:@"KYLocalizable"]
    table:nil] 
```

此时，如果找到，将使用*Localizable.strings中的字符串。*否则，将使用 KYLocalizable.strings 中的值。如果也没有找到，则将返回一个空白字符串（因为这是在嵌套**值**参数中指定的）。

但是，这种方法的一个低效之处在于，您的应用程序实际上会在每次尝试时首先尝试在 KYLocalizable.strings 中进行查找（以便随后可以在对*Localizable.strings*进行外部查找时将此结果作为**value**参数传入）。如果你真的想先检查*Localized.strings*，然后*只*在找不到字符串的情况下进行第二次查找，我认为你需要创建一个包含该逻辑的方法（例如，在NSBundle 上的类别）。

 **** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-23T15:06:46.620

如果密钥不存在，您将收到的字符串将是密钥本身。因此，只要您假设您永远不会将密钥用作本地化字符串，您就可以测试 NSLocalizableString 是否返回了密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T15:14:46.217

谢谢@Xval，我自己想出了一个简单的功能（如果您有更好的想法，请提供一些建议）：

```
#define KYLocalizedString(key, comment) \
  [[[NSBundle mainBundle] localizedStringForKey:(key) value:nil table:nil] isEqualToString:(key)] ? \
  [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:@"KYLocalizable"] : \
  [[NSBundle mainBundle] localizedStringForKey:(key) value:@"" table:nil] 
```

`localizedStringForKey:`将返回@Xval 所说的 NSString 。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-29T07:39:25.903

我为本地化字符串编写了这个方便的扩展，因此您可以使用该`localized()`函数来获取本地化字符串（您也可以传递参数）和`isLocalized`计算属性来检查字符串是否已本地化：

```
extension String {

    var isLocalized: Bool {
        return localized() != self
    }

    func localized(parameter: CVarArg? = nil) -> String {
        if let parameter = parameter {
            return String(format: NSLocalizedString(self, comment: ""), parameter)
        }
        else {
            return NSLocalizedString(self, comment: "")
        }
    }

    func localized(parameter0: CVarArg, parameter1: CVarArg) -> String {
        return String(format: NSLocalizedString(self, comment: ""), parameter0, parameter1)
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-30T10:12:57.497

对于斯威夫特：

```
var key = "your_key"
NSBundle.mainBundle().localizedStringForKey(key,
                                             value: NSBundle.mainBundle().localizedStringForKey(key, value:"", table: nil),
                                             table: "Your_Custom_Localizable_File") 
```

根据Apple的文档，只是为了澄清一些事情：

```
If key is not found and value is nil or an empty string, returns key. 
```

因此，使用这种技术，您可以嵌套调用任意数量的本地化文件。***

# mysql - 使用 MySQL 和 PHP 将数据分离到两个不同的数据库表中

> ID：12552848
> 
> 赞同：1
> 
> 时间：2012-09-23T13:45:29.780
> 
> 标签：mysql, database

我有一个产品提要，它多次列出服装项目，每种颜色和尺寸的项目都列出一次。

```
ProductID      Product Name               Colour      Size      Price

1              Men's Board Shorts         Blue        S         4.99
1              Men's Board Shorts         Blue        M         4.99
1              Men's Board Shorts         Blue        L         5.99
1              Men's Board Shorts         Red         S         4.99
1              Men's Board Shorts         Red         M         4.99
1              Men's Board Shorts         Red         L         5.99 
```

我有两张表：一张用于名称和 ID，另一张用于每种产品的 ID、颜色、尺寸和价格。

在第一个表中，我只希望每个产品的产品名称出现一次，而不考虑不同尺寸和颜色的数量。在第二个表中，我希望产品的 ID 代码、尺寸和价格出现在每种可用的不同颜色中。

所以我最终会得到以下数据：

```
Product Table
1     Men's Board Shorts

Options Table
1     Blue     S         4.99
1     Blue     M         4.99
1     Blue     L         5.99
1     Red      S         4.99
1     Red      M         4.99
1     Red      M         5.99 
```

将尺寸分成单独的记录而不是在一个字段中具有尺寸 S、M、L 的原因是，有时大件商品的价格与中小型商品的价格不同。

有什么想法可以让我开始/指出正确的方向吗？

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T14:30:11.487

第一张表：

```
CREATE TABLE IF NOT EXISTS `products` (
    `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
    `name` varchar(255) NOT NULL,
    PRIMARY KEY (`id`)
) AUTO_INCREMENT=1 ;

INSERT INTO `products` (`name`) SELECT `p_name` FROM `source_table`; 
```

第二张表：

```
CREATE TABLE IF NOT EXISTS `options` (
    `id` int(11) NOT NULL AUTO_INCREMENT,
    `colour` varchar(12) NOT NULL,
    `size` char(1) NOT NULL,
    `price` float unsigned NOT NULL,
    PRIMARY KEY (`id`)
)  AUTO_INCREMENT=1 ;

INSERT INTO `options` (`colour`, `size`, `price`) SELECT `p_colour`, `p_size`, `p_price` FROM `source_table`; 
```

我只是希望我正确理解了你的问题。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:53:56.263

创建2个表：

```
 CREATE TABLE product (
  id INT NOT NULL PRIMARY KEY,
  name VARCHAR() NOT NULL
  );
 CREATE TABLE options (
  product_id INT NOT NULL PRIMARY KEY,
  color VARCHAR(30),
  size VARCHAR(10),
  price DECIMAL(10,2)  
 ); 
```

在表中获取和插入记录：

```
 $result1 = mysql_fetch_assoc(mysql_query('SELECT * from ProductTemp GROUP BY ProductID', $conn));

 $result2 = mysql_fetch_assoc(mysql_query('SELECT * from ProductTemp', $conn));

 foreach( $result1 as $v ) {
  $retval1 = mysql_query("INSERT INTO product VALUES('$v['ProductID']','$v['Product Name']')", $conn);
  if(!$retval1) {
  echo 'Could not enter data into table product: ' . mysql_error(); 
  exit;
 }
 }

  foreach( $result2 as $v ) { 
 $retval2 = mysql_query("INSERT INTO options VALUES('$v['ProductID']','$v['Color']','$v['Size']' , $v['Price'])", $conn); 

if(!$retval2 ) {
  echo 'Could not enter data into table options: ' . mysql_error(); 
  exit;
 }
 } 
```

# javascript - 为什么我在 console.log() 中看不到 socket.io 的服务器代码？

> ID：12552849
> 
> 赞同：2
> 
> 时间：2012-09-23T13:45:35.670
> 
> 标签：javascript, node.js, socket.io

我开始学习如何使用 socket.io，过去几天我一直在努力解决这个问题，但我没有得到两件事。

1.  为什么在启动服务器并加载我各自的 url (localhost:8088) 后我的警报需要很长时间才能显示出来？

2.  为什么我看不到socket.io的服务器代码？例如，在下一段代码中，我从未在控制台中看到来自“我的其他事件”的数据。

服务器（app.js）：

```
var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server);

server.listen(8088);

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

io.sockets.on('connection', function (socket) { 

  socket.emit('news', { 
    hello: 'world' 
  });

  socket.on('my other event', function (data) {
    console.log(data);
  });

}); 
```

客户端（index.html）：

```
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect();

  socket.on('news', function (data) {
    console.log(data);
    alert(data.hello);

    socket.emit('my other event', { 
        my: 'data' 
    });

  });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T06:43:48.403

可能是 express 3.0 和 socket.io 不兼容

尝试这个：

```
var express = require('express'),;
var http = require('http');
var app = express();

var server = module.exports = http.createServer(app);
var io = require("socket.io").listen(server);

server.listen(8088); 
```

# ios - 如何在 iOS 中查看 iPhone 设备版本？

> ID：12552856
> 
> 赞同：4
> 
> 时间：2012-09-23T13:46:26.187
> 
> 标签：ios, iphone-5

嗨，我想检查 iOS 中的 iPhone 设备版本。

我的意思是，当前运行的设备是 iPhone 4 或 iPhone 5。

我需要检查设备，是不是 iPhone 5？

因为我的应用程序中有一些问题需要知道 iPhone 5 与否。

那我该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-23T13:49:55.440

添加此代码：

```
if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone){
        if ([[UIScreen mainScreen] respondsToSelector: @selector(scale)]) {
            CGSize result = [[UIScreen mainScreen] bounds].size;
            CGFloat scale = [UIScreen mainScreen].scale;
            result = CGSizeMake(result.width * scale, result.height * scale);

            if(result.height == 960) {
                NSLog(@"iPhone 4 Resolution");
                resolution_number = 1;
            }
            if(result.height == 1136) {
                NSLog(@"iPhone 5 Resolution");
            }
        }
        else{
            NSLog(@"Standard Resolution");
        }
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-25T12:09:03.677

将此宏添加到您的代码中：

```
#define HEIGHT_IPHONE_5 568
#define IS_IPHONE   ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
#define IS_IPHONE_5 ([[UIScreen mainScreen] bounds ].size.height == HEIGHT_IPHONE_5 ) 
```

然后只要你需要就检查..

```
if (IS_IPHONE_5) {
    //Code for iPhone5
}else{
    //Code for earlier version
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-28T13:25:40.150

根据这个[问题](https://stackoverflow.com/questions/448162/determine-device-iphone-ipod-touch-with-iphone-sdk)的答案，您可以通过以下方式确定您使用的模型：

```
NSString *deviceModel = [UIDevice currentDevice].model; 
```

结果可以是以下值之一：iPod touch、iPhone、iPad、iPhone Simulator、iPad Simulator

对于您正在使用的特定模型，可以通过在`UIDevice.h`类上创建一个 Category 来确定，如下所示：

UIDevice+Utilities.h

```
#import <UIKit/UIKit.h>

@interface UIDevice (Utilities)

- (CGFloat)deviceModelVersion;

@end 
```

UIDevice+Utilities.m

```
#import "UIDevice+Utilities.h"
#include <sys/types.h>
#include <sys/sysctl.h>

@implementation UIDevice (Utilities)

- (CGFloat)deviceModelVersion
{
    size_t size;
    sysctlbyname("hw.machine", NULL, &size, NULL, 0);
    char *machine = malloc(size);
    sysctlbyname("hw.machine", machine, &size, NULL, 0);
    NSString *platform = [NSString stringWithUTF8String:machine];
    free(machine);

    if ([platform rangeOfString:@"iPhone"].location != NSNotFound)
    {
        return [[[platform stringByReplacingOccurrencesOfString:@"iPhone" withString:@""] stringByReplacingOccurrencesOfString:@"," withString:@"."] floatValue];
    }
    else if ([platform rangeOfString:@"iPad"].location != NSNotFound)
    {
        return [[[platform stringByReplacingOccurrencesOfString:@"iPad" withString:@""] stringByReplacingOccurrencesOfString:@"," withString:@"."] floatValue];
    }
    else if ([platform rangeOfString:@"iPod"].location != NSNotFound)
    {
        return [[[platform stringByReplacingOccurrencesOfString:@"iPod" withString:@""] stringByReplacingOccurrencesOfString:@"," withString:@"."] floatValue];
    }
    else if ([platform rangeOfString:@"i386"].location != NSNotFound || [platform rangeOfString:@"x86_64"].location != NSNotFound)
    {
        return -1.0; //Currently it is not possible (or maybe it is, but I do not know)
                     //which type of simulator device model version your app is running
                     //so I am returning -1.0 device model version for all simulators types
    }

    return 0.0;
}

@end 
```

示例如何调用函数`deviceModelVersion`：

```
CGFloat deviceModelVersion = [UIDevice currentDevice].deviceModelVersion; 
```

可能的结果可能是 1.0, 1.1, ..., 2.0, 2.1, ..., 3.0, 3.1, ..., 4.0, 4.1, ..., 5.0, 5.1, ...

要确定它是否是 iPhone 5，您需要

```
deviceModel : "iPhone" 
```

和

```
deviceModelVersion : >=5.0 and < 6.0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-13T17:11:22.750

我实际上找到了一个可以解决问题的#define

```
#define IS_IPHONE_5 (fabs((double)[[UIScreen mainScreen] bounds].size.height - (double) 568) < DBL_EPSILON) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-21T03:25:33.983

```
#define IS_IPAD (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
#define IS_IPHONE (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
#define IS_IPHONE_4 (IS_IPHONE && [[UIScreen mainScreen] bounds].size.height == 480.0f)
#define IS_IPHONE_5 (IS_IPHONE && [[UIScreen mainScreen] bounds].size.height == 568.0f)
#define IS_IPHONE_6 (IS_IPHONE && [[UIScreen mainScreen] bounds].size.height == 667.0f)
#define IS_IPHONE_6PLUS (IS_IPHONE && [[UIScreen mainScreen] nativeScale] == 3.0f)
#define IS_IPHONE_6_PLUS (IS_IPHONE && [[UIScreen mainScreen] bounds].size.height == 736.0f)
#define IS_RETINA ([[UIScreen mainScreen] scale] == 2.0f) 
```

# iphone - 按下按钮时在视图之间传递图像

> ID：12552857
> 
> 赞同：0
> 
> 时间：2012-09-23T13:46:28.387
> 
> 标签：iphone, xcode, image, sdk

我正在寻找传递取决于按钮选择的图像。我的 FirstController 上有 Button1、Button2、Button3。

我希望当我按下 Button1 时，在 SecondController 上显示的名为 photo.png 的图像已插入到 Imageview 中。如果我按下按钮 2 也是一样，名为 photo2.png 的图像会显示在同一个 Imageview 上。我真的不知道该怎么做我想做的事。我想将图像的传递插入此代码：

```
- (IBAction)Button1:(id)sender {
    SecondController *dvController = [[SecondController alloc] 
initWithNibName:@"SecondController" bundle:[NSBundle mainBundle]];
    dvController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self presentModalViewController:dvController animated:YES];
    [dvController release];
    dvController = nil;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T13:51:14.673

`SecondController`应该有一个`property`类似的东西`UIImage* previousViewImage`，你可以从发件人那里传递`dvController.previousViewImage= [(UIButton*)sender imageForState:UIControlStateNormal].`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T13:55:28.460

一种方法是拥有一个图像名称数组，然后使用按钮的标签作为索引从数组中获取图像名称。

您首先将一个按钮和一个 IBAction 链接到它。然后复制并粘贴按钮。这为您提供了许多按钮，但只有一段代码。为每个按钮设置不同的标记属性，代码使用 [sender tag] 作为数组的索引。

然后 dvController 有一个 UIImage 属性，该属性在呈现之前从此数组中设置。在 dvController 的 viewWillAppear 中，UIImageView 然后设置为传递过来的 UIImage。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T09:29:05.477

嘿汤姆约翰你可以做的是在你的 SecondController.h 中声明并合成一个字符串，所以当第一个按钮被按下时，你可以用你想在第二个视图控制器中设置的图像的名称来设置字符串的值在您的方法中的图像视图为

```
 - (IBAction)Button1:(id)sender {
SecondController *dvController = [[SecondController alloc] 
```

initWithNibName:@"SecondController" bundle:[NSBundle mainBundle]]; dvController.imageName=@"photo", // imageName 是您将在第二个视图控制器中声明的字符串 dvController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve; [自我presentModalViewController：dvController动画：YES]；[dvController 发布]; dvController = nil; }

在第二个视图控制器的视图中确实加载了你可以这样做

```
imageView.image=[UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:imageName ofType:@"png"]];//  imageview is the name of your imageview outlet . 
```

同样对于第二个按钮，您可以设置`dvController.imageName=@"photo2"// put the name without png`. 希望这可以帮助。

# java - 在 try-with-resources 块中管理多个链接资源的正确习惯用法？

> ID：12552863
> 
> 赞同：179
> 
> 时间：2012-09-23T13:47:09.003
> 
> 标签：java, try-with-resources

Java 7 *try-with-resources*语法（也称为 ARM 块（*自动资源管理*））在仅使用一个`AutoCloseable`资源时非常好、简短且直接。但是，当我需要声明多个相互依赖的资源时，我不确定什么是正确的习惯用法，例如包装它的 a`FileWriter`和 a 。`BufferedWriter`当然，这个问题涉及`AutoCloseable`包装某些资源的任何情况，而不仅仅是这两个特定的类。

我想出了以下三个替代方案：

## 1)

我见过的幼稚习惯用法是仅在 ARM 管理的变量中声明顶级包装器：

```
static void printToFile1(String text, File file) {
    try (BufferedWriter bw = new BufferedWriter(new FileWriter(file))) {
        bw.write(text);
    } catch (IOException ex) {
        // handle ex
    }
} 
```

这很好，很短，但它被打破了。因为底层`FileWriter`没有在变量中声明，所以它永远不会在生成的`finally`块中直接关闭。它只会通过`close`wrapping 的方法关闭`BufferedWriter`。`bw`问题是，如果从的构造函数中抛出异常，`close`则不会调用它，因此`FileWriter` **不会关闭**底层。

## 2)

```
static void printToFile2(String text, File file) {
    try (FileWriter fw = new FileWriter(file);
            BufferedWriter bw = new BufferedWriter(fw)) {
        bw.write(text);
    } catch (IOException ex) {
        // handle ex
    }
} 
```

在这里，底层资源和包装资源都声明在 ARM 管理的变量中，所以它们都肯定会被关闭，但底层`fw.close()` **会被调用两次**：不仅直接调用，还通过 wrapping调用`bw.close()`。

对于这两个都实现的特定类`Closeable`（它是 的子类型`AutoCloseable`）来说，这应该不是问题，它们的合同规定`close`允许多次调用：

> 关闭此流并释放与其关联的任何系统资源。如果流已经关闭，则调用此方法无效。

但是，在一般情况下，我可以拥有仅实现`AutoCloseable`（而不是`Closeable`）的资源，这不能保证`close`可以多次调用：

> 请注意，与 java.io.Closeable 的 close 方法不同，此 close 方法不需要是幂等的。换句话说，多次调用此 close 方法可能会产生一些可见的副作用，这与 Closeable.close 不同，如果多次调用则要求无效。但是，强烈建议此接口的实现者使他们的 close 方法具有幂等性。

## 3)

```
static void printToFile3(String text, File file) {
    try (FileWriter fw = new FileWriter(file)) {
        BufferedWriter bw = new BufferedWriter(fw);
        bw.write(text);
    } catch (IOException ex) {
        // handle ex
    }
} 
```

这个版本理论上应该是正确的，因为只有`fw`代表需要清理的真实资源。本身不持有任何资源，`bw`它只委托给`fw`，所以只关闭底层就足够了`fw`。

另一方面，语法有点不规则，而且 Eclipse 发出警告，我认为这是一个误报，但它仍然是一个必须处理的警告：

> 资源泄漏：'bw' 永远不会关闭

* * *

那么，该采用哪种方法呢？还是我错过了其他一些*正确的*成语？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-09-30T21:27:58.083

Here's my take on the alternatives:

## 1)

```
try (BufferedWriter bw = new BufferedWriter(new FileWriter(file))) {
    bw.write(text);
} 
```

For me, the best thing coming to Java from traditional C++ 15 years ago was that you could trust your program. Even if things are in the muck and going wrong, which they often do, I want the rest of the code to be on best behaviour and smelling of roses. Indeed, the `BufferedWriter` might throw an exception here. Running out of memory wouldn't be unusual, for instance. For other decorators, do you know which of the `java.io` wrapper classes throw a checked exception from their constructors? I don't. Doesn't do code understandability much good if you rely upon that sort of obscure knowledge.

Also there's the "destruction". If there is an error condition, then you probably don't want to be flushing rubbish to a file that needs deleting (code for that not shown). Although, of course, deleting the file is also another interesting operation to do as error handling.

Generally you want `finally` blocks to be as short and reliable as possible. Adding flushes does not help this goal. For many releases some of the buffering classes in the JDK had a bug where an exception from `flush` within `close` caused `close` on the decorated object not be called. Whilst that has been fixed for some time, expect it from other implementations.

## 2)

```
try (
    FileWriter fw = new FileWriter(file);
    BufferedWriter bw = new BufferedWriter(fw)
) {
    bw.write(text);
} 
```

We're still flushing in the implicit finally block (now with repeated `close` - this gets worse as you add more decorators), but the construction is safe and we have to implicit finally blocks so even a failed `flush` doesn't prevent resource release.

## 3)

```
try (FileWriter fw = new FileWriter(file)) {
    BufferedWriter bw = new BufferedWriter(fw);
    bw.write(text);
} 
```

There's a bug here. Should be:

```
try (FileWriter fw = new FileWriter(file)) {
    BufferedWriter bw = new BufferedWriter(fw);
    bw.write(text);
    bw.flush();
} 
```

Some poorly implemented decorators are in fact resource and will need to be closed reliably. Also some streams may need to be closed in a particular way (perhaps they are doing compression and need to write bits to finish off, and can't just flush everything.

## Verdict

Although 3 is a technically superior solution, software development reasons make 2 the better choice. However, try-with-resource is still an inadequate fix and you should stick with the [Execute Around idiom](https://stackoverflow.com/questions/341971/what-is-the-execute-around-idiom), which should have a clearer syntax with closures in Java SE 8.

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-28T19:18:32.063

第一种样式是[Oracle 建议的](http://docs.oracle.com/javase/7/docs/technotes/guides/language/try-with-resources.html)样式。`BufferedWriter`不抛出已检查异常，因此如果抛出任何异常，程序预计不会从中恢复，使得资源恢复大多没有实际意义。

主要是因为它可能发生在线程中，线程死亡但程序仍在继续 - 例如，有一个临时内存中断，时间不足以严重损害程序的其余部分。不过，这是一个相当极端的情况，如果它经常发生足以使资源泄漏成为问题，那么 try-with-resources 是您的问题中最少的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-23T18:01:17.730

**选项 4**

如果可以，将您的资源更改为可关闭的，而不是自动关闭的。构造函数可以被链接的事实意味着关闭资源两次并非闻所未闻。（在 ARM 之前也是如此。）下面有更多内容。

**选项 5**

不要非常小心地使用 ARM 和代码，以确保 close() 不会被调用两次！

**选项 6**

不要使用 ARM 并在 try/catch 中调用 finally close() 。

**为什么我不认为这个问题是 ARM 独有的**

在所有这些示例中，finally close() 调用都应该在一个 catch 块中。为便于阅读而省略。

不好，因为 fw 可以关闭两次。（这对 FileWriter 很好，但在您的假设示例中则不然）：

```
FileWriter fw = null;
BufferedWriter bw = null;
try {
  fw = new FileWriter(file);
  bw = new BufferedWriter(fw);
  bw.write(text);
} finally {
  if ( fw != null ) fw.close();
  if ( bw != null ) bw.close();
} 
```

不好，因为如果构造 BufferedWriter 出现异常，fw 不会关闭。（同样，不可能发生，但在您的假设示例中）：

```
FileWriter fw = null;
BufferedWriter bw = null;
try {
  fw = new FileWriter(file);
  bw = new BufferedWriter(fw);
  bw.write(text);
} finally {
  if ( bw != null ) bw.close();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-30T23:57:48.733

同意前面的评论：最简单的是**(2)**使用`Closeable`资源并在 try-with-resources 子句中按顺序声明它们。如果`AutoCloseable`您只有. 在实践中，甚至 Oracle 也只是**(1)**链接了构造函数，并且没有正确处理链中的异常。`close``private bool isClosed;`

 **或者，您可以使用静态工厂方法手动创建链接资源；这封装了链，并在它中途失败时处理清理：

```
static BufferedWriter createBufferedWriterFromFile(File file)
  throws IOException {
  // If constructor throws an exception, no resource acquired, so no release required.
  FileWriter fileWriter = new FileWriter(file);
  try {
    return new BufferedWriter(fileWriter);  
  } catch (IOException newBufferedWriterException) {
    try {
      fileWriter.close();
    } catch (IOException closeException) {
      // Exceptions in cleanup code are secondary to exceptions in primary code (body of try),
      // as in try-with-resources.
      newBufferedWriterException.addSuppressed(closeException);
    }
    throw newBufferedWriterException;
  }
} 
```

然后，您可以在 try-with-resources 子句中将其用作单个资源：

```
try (BufferedWriter writer = createBufferedWriterFromFile(file)) {
  // Work with writer.
} 
```

复杂性来自处理多个异常；否则它只是“您迄今为止获得的关闭资源”。一种常见的做法似乎是首先将保存资源的对象的变量初始化为`null`（此处`fileWriter`），然后在清理中包含一个空检查，但这似乎没有必要：如果构造函数失败，则没有什么可清理的，所以我们可以让这个异常传播，这稍微简化了代码。

你可以一般地这样做：

```
static <T extends AutoCloseable, U extends AutoCloseable, V>
    T createChainedResource(V v) throws Exception {
  // If constructor throws an exception, no resource acquired, so no release required.
  U u = new U(v);
  try {
    return new T(u);  
  } catch (Exception newTException) {
    try {
      u.close();
    } catch (Exception closeException) {
      // Exceptions in cleanup code are secondary to exceptions in primary code (body of try),
      // as in try-with-resources.
      newTException.addSuppressed(closeException);
    }
    throw newTException;
  }
} 
```

同样，您可以链接三个资源等。

撇开数学不谈，您甚至可以通过一次链接两个资源来链接三次，并且它是关联的，这意味着您将在成功时获得相同的对象（因为构造函数是关联的），如果失败则相同的异常在任何构造函数中。假设你在上面的链中添加了一个*S*（所以你从一个*V*开始并以一个*S*结束，依次应用*U*，*T*和*S*），如果你先链接*S*和*T*，然后是*U* ，你会得到相同的结果，对应于*(ST)U*，或者如果您首先链接*T*和*U*，那么*S*，对应于*S(TU)*。但是，在单个工厂函数中写出显式的三重链会更清楚。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-26T15:28:48.557

由于您的资源是嵌套的，因此您的 try-with 子句也应该是：

```
try (FileWriter fw=new FileWriter(file)) {
    try (BufferedWriter bw=new BufferedWriter(fw)) {
        bw.write(text);
    } catch (IOException ex) {
        // handle ex
    }
} catch (IOException ex) {
    // handle ex
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-30T21:33:20.120

我只是想以 Jeanne Boyarsky 的建议为基础，即不使用 ARM，但要确保 FileWriter 始终只关闭一次。不要以为这里有什么问题...

```
FileWriter fw = null;
BufferedWriter bw = null;
try {
    fw = new FileWriter(file);
    bw = new BufferedWriter(fw);
    bw.write(text);
} finally {
    if (bw != null) bw.close();
    else if (fw != null) fw.close();
} 
```

我想由于 ARM 只是语法糖，我们不能总是用它来替换 finally 块。就像我们不能总是使用 for-each 循环来做一些迭代器可以做的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-26T06:23:03.023

我的解决方案是进行“提取方法”重构，如下所示：

```
static AutoCloseable writeFileWriter(FileWriter fw, String txt) throws IOException{
    final BufferedWriter bw  = new BufferedWriter(fw);
    bw.write(txt);
    return new AutoCloseable(){

        @Override
        public void close() throws IOException {
            bw.flush();
        }

    };
} 
```

`printToFile`可以写成

```
static void printToFile(String text, File file) {
    try (FileWriter fw = new FileWriter(file)) {
        AutoCloseable w = writeFileWriter(fw, text);
        w.close();
    } catch (Exception ex) {
        // handle ex
    }
} 
```

或者

```
static void printToFile(String text, File file) {
    try (FileWriter fw = new FileWriter(file);
        AutoCloseable w = writeFileWriter(fw, text)){

    } catch (Exception ex) {
        // handle ex
    }
} 
```

对于类库设计者，我会建议他们`AutoClosable`使用附加方法来扩展接口以抑制关闭。在这种情况下，我们可以手动控制关闭行为。

对于语言设计师来说，教训是添加新功能可能意味着添加很多其他功能。在这种 Java 案例中，显然 ARM 功能与资源所有权转移机制配合使用会更好。

**更新**

最初上面的代码需要`@SuppressWarning`，因为`BufferedWriter`函数内部需要`close()`.

正如评论所建议的，如果`flush()`要在关闭编写器之前调用，我们需要`return`在 try 块内的任何（隐式或显式）语句之前这样做。我认为目前无法确保调用者这样做，因此必须为`writeFileWriter`.

**再次更新**

上面的更新是`@SuppressWarning`不必要的，因为它需要函数将资源返回给调用者，所以它本身不需要被关闭。不幸的是，这将我们拉回到情况的开始：警告现在移回调用方。

所以要正确解决这个问题，我们需要一个自定义`AutoClosable`的，只要它关闭，下划线`BufferedWriter`就会被`flush()`编辑。实际上，这向我们展示了绕过警告的另一种方法，因为`BufferWriter`无论哪种方式都不会关闭。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-27T10:58:38.777

我会说不要使用ARM并继续使用Closeable。使用方法如，

```
public void close(Closeable... closeables) {
    for (Closeable closeable: closeables) {
       try {
           closeable.close();
         } catch (IOException e) {
           // you can't much for this
          }
    }

} 
```

此外，您应该考虑调用 close of，`BufferedWriter`因为它不只是委托 close to `FileWriter`，而且还会进行一些清理，例如`flushBuffer`.**

# android - 我如何包括 对于 NDK 工具链的 gcc

> ID：12552868
> 
> 赞同：2
> 
> 时间：2012-09-23T13:47:52.150
> 
> 标签：android, c, bluetooth, android-ndk

首先，我上次尝试将 ac 程序编译为 linux-arm 架构时遇到了一个问题，以便以后在 android 应用程序中使用它。我成功地做到了，稍后我会写一篇关于如何使用 NDK 独立工具链的文章。

现在我终于可以正常工作了，我正在尝试编译一个 .c 文件，其中有一行“包括蓝牙/蓝牙.h”。当我尝试编译该文件时，我得到一个：“没有这样的文件或目录”错误。我的 makefile 包含单词“-libbluetooth”。标准 NDK gcc 库不支持蓝牙，因此根据互联网上对该主题的简要研究，我已经从我的设备下载了“libbluetooth.so”，这是我让它工作所需要的。我仍然得到同样的错误。

我很高兴知道是否有人遇到过同样的问题。谢谢你德克尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-23T16:52:07.387

您需要蓝牙库来链接您的程序；但要编译它，您需要适当的标头。**libbluetooth.so**不是 Android 官方 API 的一部分，但幸运的是，如果您根据 Google 的[说明下载 AOSP 源代码树，您可以找到它的源代码和声明其公共](http://source.android.com/source/downloading.html)*（但非官方）* API 的包含文件。实际上，您对树的一小部分感兴趣：. 在那里你会找到包含文件。在您的中，您将有一行类似于：`./external/bluetooth/bluez/lib``bluetooth/bluetooth.h``Android.mk`

```
LOCAL_C_INCLUDES += $(AOSP_ROOT)/external/bluetooth/bluez/lib 
```

# emacs - el-get 便携式 emacs 配置解决方案

> ID：12552877
> 
> 赞同：11
> 
> 时间：2012-09-23T13:49:36.427
> 
> 标签：emacs

`el-get`在帮助实现便携式 emacs 配置设置方面大有帮助。这个想法是在 emacs 配置文件中声明你想要的包，将该文件推送到一个 repo，然后将它拉到你想要相同 emacs 配置的所有计算机上。这就是代码的外观`elisp`：

```
(setq my-packages (append '(el-get switch-window yasnippet ...)
    (mapcar 'el-get-source-name el-get-sources)))                  
(el-get 'sync my-packages) 
```

`el-get`将确保软件包自动安装并正确初始化。但是，我的理解是，当您取消引用一个包时，它不会被卸载。如果您手动卸载它，您将不得不在所有计算机上手动卸载它。换句话说，el-get 只是实现了真正可移植的解决方案的一半。我的问题是，是否有人编写了 elisp 代码，只需在 init.el 中取消引用它们就可以卸载这些包？或者我是否应该在其他地方寻找一个完全可移植的 emacs 声明性依赖管理解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T01:19:23.783

我在这里回答自己，因为最终我选择了替代解决方案。

phils 的回答仍然有效，但我发现将 .emacs.d 目录置于版本控制之下很麻烦，而且公平地说，我不想打扰假子模块。

我做了什么：我联系了 el-get 的维护者 Dimitri，并向他提出了这个问题。

迪米特里 说：

> 我可以看到我们添加了一个 el-get-cleanup 函数，您必须使用当前的软件包列表调用该函数，该函数将 el-get-remove 任何已在本地安装但不在提供的列表中的软件包。

```
(el-get-cleanup my-packages) 
```

> 然后，您可以根据需要从用户初始化文件中使用它，或者不时将其作为例程执行。

在他的指导下，我编写了有问题的函数。

```
(defun el-get-cleanup (packages)
  "Remove packages not explicitly declared"
  (let* ((packages-to-keep (el-get-dependencies (mapcar 'el-get-as-symbol packages)))
         (packages-to-remove (set-difference (mapcar 'el-get-as-symbol
                                                     (el-get-list-package-names-with-status
                                                      "installed")) packages-to-keep)))
    (mapc 'el-get-remove packages-to-remove))) 
```

啊，开源的乐趣……

（另见我的博[文](http://danielsz.github.io/towards-a-declarative-dependency-management-s/index.html)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-24T10:58:28.940

您应该将 el-get 与某种形式的版本控制结合使用。这提供了可移植性，因此当您删除一个包并将结果提交到您的存储库时，一旦其他实例提取了这些更改，该包也将被卸载。

如果您将包文件留给 el-get 进行管理，那么在从一个实例中删除包后，这些*文件*可能仍存在于其他副本上，但是，如果 el-get 的状态和自动加载文件在您的存储库中，我认为每个包的*状态*应该是正确的。

就个人而言，我建议在安装软件包后将所有文件提交到您的存储库。这样，当您删除一个包、提交更改并从另一个实例中提取这些更改时，两个副本都处于相同的状态。

此外，在设置我的 Emacs 配置的新实例时，我永远不会相信远程源的可用性、一致性或持久性——克隆我的存储库的行为是获得工作系统所需要的全部。

所以：使用 el-get 安装和更新软件包，并使用版本控制使其可移植。

# django - 如何在 uWSGI 中配置允许的 GET 参数字符数？

> ID：12552885
> 
> 赞同：5
> 
> 时间：2012-09-23T13:50:28.087
> 
> 标签：django, nginx, uwsgi

我正在使用 nginx + uWSGI 运行 Django。

刚刚从本地开发人员转移到登台服务器后，我发现我们发出的特定 GET 请求有一个很长的查询字符串。尝试调试时，uWSGI 似乎不接受基于长度的查询字符串 - 我可以传递短字符串并且它可以工作，超过一定长度我开始收到 502 bad gateway 错误。

我在 uWSGI 网站上或通过谷歌搜索找不到任何关于此的内容。有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-23T14:55:18.287

找到了解决方案，这很容易。只需要增加 uWSGI 缓冲区大小，例如：

缓冲区大小 = 32768

# php - 如何在 PHP 中动态设置错误报告

> ID：12552886
> 
> 赞同：0
> 
> 时间：2012-09-23T13:50:32.207
> 
> 标签：php, syntax-error

我正在尝试在 PHP 中动态设置错误报告，但我无法正确使用语法。

我试过 ：

```
ini_set('error_reporting',0); 
```

而不是这个：

```
error_reporting(0); 
```

但是两者都无法停止错误报告。请告诉我我在做什么错误？谢谢你。

（我是 PHP 新手，使用[此资源](http://thenewboston.org/list.php?cat=11)学习 PHP。）

编辑：整个代码是：

```
<?php

    ini_set('error_reporting',0);
    echo "hello world"
    $value = "abc";
    ?>
    <input type = "text" value = "<?php echo $value;?>"> 
```

我故意在第二行犯了一个错误来研究这个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T14:09:31.107

您有“PHP Parse error”，这意味着 PHP 无法编译您的代码，因此您的错误报告设置将不起作用。

试试这个：

```
error_reporting(0);
echo $foo; // This line produces notice about unset variable, but it is suppressed by error reporting level 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:10:39.127

这是一个语法错误。因此不会执行任何行，因此您不能使用`ini_set`or `error_reporting`。

如果您使用的是 Apache + mod_php，请使用`.htaccess`来抑制错误报告。

```
php_value error_reporting 0
php_flag display_errors off 
```

如果您使用 php cgi 或 fcgi，请使用自定义 php.ini 文件。

# php - 保护 Flash 到 PHP 的通信

> ID：12552887
> 
> 赞同：0
> 
> 时间：2012-09-23T13:50:38.777
> 
> 标签：php, flash, security, encryption, actionscript

我有一个带有 php 后端和 MySQL 数据库的 Flash 游戏。

要玩游戏，用户必须登录。在游戏过程中，客户端还将定期向数据库发送更新。例如，当用户购买新的游戏内物品时。

我有两个担忧。首先，用户名和密码以纯文本形式发送到服务器（但是它在我的数据库中加密）。其次，登录后，客户端将被发送一个用户ID，用于所有后续请求。这些请求也以纯文本形式发送。

这两种通信都存在数据包嗅探的风险。一旦有人了解了对服务器的请求的结构，他们就可以创建自己的虚假请求，替换自己的值/用户 ID，通常会引起很多麻烦。

我有哪些选择？购买 SSL 证书并使用 https 会是一种解决方案吗？我可以使用公钥/私钥类型的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T19:17:29.450

除了 SSL 的明显好处之外，还有一些缺点：

1.  您将不得不加密所有内容或什么都不加密。

    *   这意味着，如果您的网站显示第三方广告或类似内容，您必须确保所有这些都可以通过安全连接获得。

    *   SSL 加密的流量几乎是未加密流量的两倍。这对于您通常不想加密的图像和其他资产来说尤其痛苦。

    *   SSL 加密的计算成本很高，并且会在您的服务器上增加一些负载（不用担心，除非您有很多服务器端处理，但对于更大的应用程序，这是一个重要因素）

2.  证书要花钱，必须更新。

3.  Flash 通过 SSL 通信和不发送会话 cookie 存在一些已知问题，尤其是在使用加密连接时。

现在，通常情况下，您绝对不想自己实现安全性。如果赌注很高，我不会考虑它，但我不确定你的具体情况是什么，我会考虑进行选择性加密的可能性，只针对重要的事情，特别是因为用户不会’如果您在 Flash 中而不是在浏览器级别这样做，则不会收到关于“不安全”内容与“安全”内容混合的可怕消息。

有一些加密库可以在 Flash 中进行 RSA 加密，同样，您可以在服务器端进行 RSA。可能应该根据安全投资对项目的收益程度来决定这样做的方式。

# python - 带有 python 模块的 hadoop 流式传输

> ID：12552890
> 
> 赞同：0
> 
> 时间：2012-09-23T13:51:19.277
> 
> 标签：python, hadoop, hadoop-streaming

我已经看到了一种技术（在 stackoverflow 上），用于使用 zip 文件执行 hadoop 流作业来存储引用的 python 模块。

我在作业执行的映射阶段遇到了一些错误。我相当肯定它与压缩模块加载有关。

为了调试脚本，我使用命令行管道通过 sys.stdin/sys.stdout 将我的数据集运行到我的映射器和减速器中，如下所示：

头输入数据文件.txt | ./mapper.py | 排序-k1,1 | ./reducer.py

结果看起来很棒。

但是，当我通过 hadoop 运行它时，我开始遇到一些问题。即：映射器和reducer 失败，整个hadoop 作业完全失败。

我的压缩模块文件包含 *.pyc 文件 - 这会影响这件事吗？

另外，我在哪里可以找到在使用 hadoop 流的映射/缩减过程中产生的错误？

我已经使用 -file 命令行参数来告诉 hadoop 压缩模块的位置以及我的映射器和减速器脚本的位置。

我没有做任何疯狂的配置选项来增加工作中使用的映射器和减速器的数量。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:43:36.897

查看 sent_tokenize 的源代码后，看起来 nltk.sent_tokenize 和 nltk.tokenize.sent_tokenize 方法/函数依赖于一个 pickle 文件（用于进行 punkt 标记化的文件）来操作。

由于这是 Hadoop 流式传输，因此您必须弄清楚将 pickle 文件放置在何处/如何将其放入已添加到 hadoop 作业 jar 的 zip 代码模块中。

底线？我建议使用 RegexpTokenizer 类进行句子和单词级别的标记化。

# python - 如何使用其名称获取亚马逊产品价格

> ID：12552894
> 
> 赞同：4
> 
> 时间：2012-09-23T13:52:01.630
> 
> 标签：python, amazon-product-api

很抱歉，如果它被认为是重复的，但我已经尝试了所有可以与 Amazon API 通信的 python 模块，但遗憾的是，它们似乎都需要产品 ID 才能获得确切的价格！我需要的是产品名称的价格！

最后，我尝试了[Bottlenose](https://github.com/dlo/bottlenose)的扩展，它的名称是[python-amazon-simple-product-api](https://github.com/yoavaviram/python-amazon-simple-product-api)，但它有同样的问题：我如何只从产品名称中获取价格。

这是我尝试过的：

```
product = api.search(Keyword = "playstation", SearchIndex='All')

for i, produ in enumerate(product):
    print "{0}. '{1}'".format(i, produ.title) 
```

`produ.price_and_currency`（这与在文件的示例中使用 which 与 ID 一起使用的结果相同）

然后给我这个错误：

```
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "build\bdist.win-amd64\egg\amazon\api.py", line 174, in __iter__
File "build\bdist.win-amd64\egg\amazon\api.py", line 189, in iterate_pages
File "build\bdist.win-amd64\egg\amazon\api.py", line 211, in _query amazon.api.SearchException: Amazon Search Error: 'AWS.MinimumParameterRequirement', 'Your request should have atleast 1 of the following parameters: 'Keywords','Title','Power','BrowseNode','Artist','Author','Actor','Director','AudienceRati g','Manufacturer','MusicLabel','Composer','Publisher','Brand','Conductor','Orchestra','Tex Stream','Cuisine','City','Neighborhood'.' 
```

编辑：更正`Keyword`后`Keywords`我得到了一个长时间的响应（无限循环！并尝试了几次）！不像只返回整个 XML，但是当只使用宽吻时，我只会得到没有价格或其他东西的标签......

```
<ItemLink>
  <Description>Technical Details</Description>
    <URL>http://www.amazon.com/*****</URL>
</ItemLink> 
```

Update2：亚马逊似乎会返回`ALL`结果，所以如何将其限制为仅第一个存储桶（因为它按**10 个结果组给出结果**）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T15:02:47.293

如果没有使用 Amazon API 的经验：这是一个正确而智能地执行搜索的问题。仔细想想，通读一遍

[http://docs.amazonwebservices.com/AWSECommerceService/2011-08-01/DG/ItemSearch.html](http://docs.amazonwebservices.com/AWSECommerceService/2011-08-01/DG/ItemSearch.html)

这样您就不会错过任何重要的搜索功能。

响应包含 0 到数不胜数的项目，具体取决于您搜索查询的智能程度。在任何情况下，响应中的商品都会通过其 ASIN（产品 ID）来标识自己。例子：`<ASIN>B00021HBN6</ASIN>`

通过 收集 ASIN 后`ItemSearch`，您可以`ItemLookup`对这些商品执行 an 以查找更多详细信息，例如价格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T15:09:42.987

抱歉耽搁了，解决了：

分页使用`search_n`：

```
test = api.search_n(10, Keywords='example name', SearchIndex='All') # this will return only 10 results 
```

[关联](https://github.com/yoavaviram/python-amazon-simple-product-api/issues/7)

# javascript - socket.io 关于方法回调

> ID：12552895
> 
> 赞同：0
> 
> 时间：2012-09-23T13:52:08.703
> 
> 标签：javascript, html, node.js, websocket, socket.io

**服务器.js**

```
socket.on('adduser', username, successcallback){

if(users.hasOwnProperty(username)){

} else {

    socket.username = username;

    users[username] = { name: username };

    socket.emit('updatechat', 'SERVER', 'you have connected');

    socket.broadcast.emit('updatechat', 'SERVER', username + ' has connected');

    io.sockets.emit('updateusers', users);

    successcallback({ msg: 'User ' + username + ' has been successfully added' });
}

}); 
```

**索引.html**

```
socket.on('connect', function(){

    var username = prompt('Whats your name?');

    socket.emit('adduser', username, function(data){
        console.log(data);
    });

}); 
```

这使我的应用程序崩溃。这不是应该如何实现回调吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:14:28.240

adduser 消息处理程序的定义缺少`function(...)`. 它应该是：

```
socket.on('adduser', function(username, successcallback) {
  ...
}); 
```

# extjs - ExtJS 的地图组件

> ID：12552898
> 
> 赞同：1
> 
> 时间：2012-09-23T13:52:13.173
> 
> 标签：extjs, gis, extjs4.1, openstreetmap

是否有一个 ExtJS 组件，它允许

1.  在 ExtJS 应用程序中显示 OpenStreetMap 地图，
2.  在地图上的某些位置显示标记和
3.  对用户在地图上某些位置的点击做出反应

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:52:04.177

不。

GMap 只有一个扩展名：**[Ext.ux.GMapPanel](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.ux.GMapPanel)**和**[GMap Example](http://docs.sencha.com/ext-js/4-1/#!/example/window/gmap.html)**

GMap 和 OSM 都有自己的 API。您可以将它们包装到面板、窗口等容器中。如果您想处理 OSM 和 GMap 事件，请使用它们的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T03:00:07.843

不是 Ext JS 的核心组件，但 扩展 Ext JS 的[GeoExt](http://geoext.org/index.html "GeoExt")呢？它集成了 OpenLayers，它提供了所有地图服务和用户界面控件来完成所有硬地图工作。

# php - PHP：在 php 脚本中显示图像

> ID：12552899
> 
> 赞同：1
> 
> 时间：2012-09-23T13:52:33.310
> 
> 标签：php, wordpress

我想将其实现`<img src="<?php echo z_taxonomy_image_url($cat->term_id); ?>" />`到以下功能中。

```
function list_my_categories($exclude = '') {
    if (!empty($exclude)) {
        $exclude = 'exclude=' . $exclude;
    }
    $categories = get_categories($exclude);
    $html = '';

    foreach ($categories as $cat) {
            if($cat->category_parent == 0) {
            <img src="<?php echo z_taxonomy_image_url($cat->term_id); ?>" />
                $html .= '<p>' . $cat->cat_name . '</p>';
                                $html .= '<p>' . $cat->category_description . '</p>';
                $childcategories =  get_categories('child_of='.$cat->cat_ID.'');
                        if(!empty($childcategories)){
                  foreach ($childcategories as $ccat) {
                  $html .= '<p>' . $ccat->cat_name . '</p>';
                              $html .= '<p>' . $ccat->category_description . '</p>';
                      }
                        }
               }
    }

    return $html;
}
add_shortcode('show-cats', 'list_my_categories'); 
```

该功能显示 WordPress 中的类别列表，我有另一个插件，它允许您为每个类别设置图像，所以我试图显示它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T13:56:34.413

```
if($cat->category_parent == 0) 
{
    $html .= '<img src="' . z_taxonomy_image_url($cat->term_id) . '" />';
    $html .= '<p>' . $cat->cat_name . '</p>';
    $html .= '<p>' . $cat->category_description . '</p>';
    $childcategories =  get_categories('child_of='.$cat->cat_ID.'');
    if(!empty($childcategories))
    {
        foreach ($childcategories as $ccat) 
        {
            /*$html .= '<img src="' . z_taxonomy_image_url($ccat->term_id) . '" />';*/
            $html .= '<p>' . $ccat->cat_name . '</p>';
            $html .= '<p>' . $ccat->category_description . '</p>';
        }
    }
} 
```

# wordpress - 有没有办法通过内置插件安装程序安装不稳定版本的插件

> ID：12552900
> 
> 赞同：1
> 
> 时间：2012-09-23T13:52:36.703
> 
> 标签：wordpress

我想知道是否有办法安装已发布插件的不稳定版本。

假设我将插件版本 1.0 更新为 1.1。

然后我把文件放进`Stable tag: 1.0`去`readme.txt`让大家下载稳定版v1.0。

现在我的问题是，如果我想在其中一台远程服务器上测试不稳定版本，是否可以使用内置插件安装程序安装 v1.1？

我目前正在这样做：

1.  停用旧版本
2.  删除插件
3.  上传不稳定版本
4.  激活它。

如果可以通过这种方式缩短更新过程，那真的可以节省我的时间。

1.  在页面中搜索并找到要安装的插件名称`Add New`。
2.  点击不稳定版本链接。

感谢你的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T17:04:47.273

我不确定这是否是您正在寻找的答案，但是...

我遇到了同样的问题，而我选择做的实际上是在“测试床”站点上编辑我的插件。我有一个网站，我在发布之前测试了我的所有修改，并通过 FileZilla FTP 客户端直接访问文件。

这允许我从服务器获取最新的文件，在我的机器上编辑它（使用 Notepad++）并将更改上传到服务器进行测试。如果它以某种方式破坏了网站，我总是可以通过 FTP 重新上传原始网站，然后一切都恢复在线。

希望这可以帮助！

# python - Python。我可以检查 SMTP 服务器是否已断开连接（以便我可以再次连接吗？）

> ID：12552905
> 
> 赞同：12
> 
> 时间：2012-09-23T13:52:45.147
> 
> 标签：python, smtplib

我正在使用`smtplib`并且我正在从我的应用程序发送通知电子邮件。但是我注意到有时（尤其是当邮件发送之间有很多空闲时间时）我会收到`SMTPServerDisconnected`错误消息。

我想有两种解决方案（不过，一个都不知道）

1.  增加发送邮件之间的空闲时间
2.  连接断开时重新连接。

我认为第二种解决方案似乎更优雅。但我该怎么做呢？

编辑：我正在添加代码

```
from smtplib import SMTP
smtp = SMTP()
smtp.connect('smtp.server.com')
smtp.login('username','password')

def notifyUser():
    smtp.sendmail(from_email, to_email, msg.as_string()) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-03T23:11:41.970

是的，您可以检查连接是否打开。为此，请发出 NOOP 命令并测试状态 == 250。如果不是，则在发送邮件之前打开连接。

```
def test_conn_open(conn):
    try:
        status = conn.noop()[0]
    except:  # smtplib.SMTPServerDisconnected
        status = -1
    return True if status == 250 else False

def send_email(conn, from_email, to_email, msg):
   if not test_conn_open(conn):
       conn = create_conn()
   conn.sendmail(from_email, to_email, msg.as_string())
   return conn    # as you want are trying to reuse it. 
```

请注意，您这样做是因为打开连接（例如使用 gmail）会消耗时间，例如 2-3 秒。随后，为了优化发送您手头可能有的多封电子邮件，您还应该关注 Pedro 的回复（最后一部分）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-23T18:47:54.473

如果您的用例一次发送一条消息，对我来说最正确的解决方案是为每条消息创建一个新的 SMTP 会话：

```
from smtplib import SMTP

smtp = SMTP('smtp.server.com')

def notifyUser(smtp, smtp_user, smtp_password, from_email, to_email, msg):
    smtp.login(smtp_user, smtp_password)
    smtp.sendmail(from_email, to_email, msg.as_string())
    smtp.quit() 
```

如果您的 SMTP 服务器不需要您对自己进行身份验证（常见情况），则可以进一步简化为：

```
from smtplib import SMTP

smtp = SMTP('smtp.server.com')

def notifyUser(smtp, from_email, to_email, msg):
    smtp.sendmail(from_email, to_email, msg.as_string())
    smtp.quit() 
```

如果一次发送多条消息是很常见的，并且您希望通过为一组消息重用相同的 SMTP 会话来优化这种情况（如果您不需要登录到 SMTP，可以如上简化服务器）：

```
from smtplib import SMTP

smtp = SMTP('smtp.server.com')

def notifyUsers(smtp, smtp_user, smtp_password, from_to_msgs):
    """
    :param from_to_msgs: iterable of tuples with `(from_email, to_email, msg)`
    """
    smtp.login(smtp_user, smtp_password)
    for from_email, to_email, msg in from_to_msgs:
        smtp.sendmail(from_email, to_email, msg.as_string())
    smtp.quit() 
```

# graphics - 渲染到纹理时如何累积颜色？

> ID：12552909
> 
> 赞同：1
> 
> 时间：2012-09-23T13:53:33.607
> 
> 标签：graphics, directx, shader, lighting

我正在尝试使用 MRT 实现延迟着色。为此，我需要在两个渲染目标中累积颜色和法线。`R32G32B32A32`为此，我定义了两个纹理。

像素缓冲区输出到两个渲染目标。但是，我如何指示它**累积**值，而不是替换或混合它们？

我尝试定义以下混合状态：

```
blendState.RenderTarget[0].BlendEnable =            TRUE;
blendState.RenderTarget[0].RenderTargetWriteMask =  D3D11_COLOR_WRITE_ENABLE_ALL;
blendState.RenderTarget[0].SrcBlend =               D3D11_BLEND_ONE;
blendState.RenderTarget[0].DestBlend =              D3D11_BLEND_ONE;
blendState.RenderTarget[0].BlendOp =                D3D11_BLEND_OP_ADD;
blendState.RenderTarget[0].SrcBlendAlpha =          D3D11_BLEND_ONE;
blendState.RenderTarget[0].DestBlendAlpha =         D3D11_BLEND_ONE;
blendState.RenderTarget[0].BlendOpAlpha =           D3D11_BLEND_OP_ADD;
blendState.RenderTarget[1].BlendEnable =            TRUE;
blendState.RenderTarget[1].RenderTargetWriteMask =  D3D11_COLOR_WRITE_ENABLE_ALL;
blendState.RenderTarget[1].SrcBlend =               D3D11_BLEND_ONE;
blendState.RenderTarget[1].DestBlend =              D3D11_BLEND_ONE;
blendState.RenderTarget[1].BlendOp =                D3D11_BLEND_OP_ADD;
blendState.RenderTarget[1].SrcBlendAlpha =          D3D11_BLEND_ONE;
blendState.RenderTarget[1].DestBlendAlpha =         D3D11_BLEND_ONE;
blendState.RenderTarget[1].BlendOpAlpha =           D3D11_BLEND_OP_ADD; 
```

但是我得到的值很奇怪。

请帮忙！我如何积累价值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T19:21:48.150

要实现延迟着色，您在技术上不应累积法线或颜色，因为当您进行延迟处理（光计算/遮挡/景深...）时，每个 MRT 纹理像素（颜色/深度/法线）需要表示距离视点最近的物体。

因此，仅将深度状态设置为读/写和比较功能为更少/更少，完全不混合应该是要走的路。

# javascript - 我应该使用 JavaScript 还是使用服务器端语言设置 cookie？

> ID：12552915
> 
> 赞同：1
> 
> 时间：2012-09-23T13:54:15.857
> 
> 标签：javascript, cookies, server-side

我知道有些人使用 NoScript 插件禁用 JavaScript，因此他们的浏览器无法运行任何脚本。因此，我不会设置 cookie。那么我应该避免使用 Javascript 方式吗？

是否有设置 cookie 的首选方式？规则有例外吗？还是这一切都没有规则？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T13:56:26.590

如果 cookie 的设置与 JavaScript 有关，则使用 JavaScript 方式。对于其他所有内容，请让服务器设置它们。

`localStorage`但是，如果服务器不需要知道它们，您可以使用它们来替换那些“JavaScript cookie”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T13:56:05.620

通常，您应该使用服务器端技术，因为加密 cookie 的内容也变得更容易。

# tcpdf - 使用TCPDF在IE Vs FF中输出不同的PDF

> ID：12552918
> 
> 赞同：0
> 
> 时间：2012-09-23T13:55:14.610
> 
> 标签：tcpdf

在我们的 web 应用程序中，我们基于一些 XHTML 代码创建了一个 PDF。出于某些测试目的，我在 A PHP 变量中添加了一些静态 XHTML，并将其放入 TCPDF 中，然后根据它创建 PDF。奇怪的是，在 Firefox 中创建的 PDF 与我在 Internet Explorer 中创建的 PDF 不同。PDF 的相同 URL/相同代码/相同内容。

我已将 PDF 写入文件系统进行测试，并使用 Adob​​e 阅读器查看 PDF。

这怎么可能？我认为 TCPDF 是独立于浏览器的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T04:47:06.137

请尝试使用此代码，将其添加到 PHP 代码部分。还要检查 XHTML 内容在 IE 和 FF 中的工作方式是否相同。只需在创建 PDF 之前在浏览器中查看内容。

```
header('Content-type: application/pdf') 
```

# wpf - 从 WPF 中的其他表单监听事件

> ID：12552922
> 
> 赞同：0
> 
> 时间：2012-09-23T13:55:54.560
> 
> 标签：wpf, events

你知道如何从“MainForm”监听“Add_Form”的事件吗？我在 WPF 2010（Visual Studio）中编码。

我的程序有两种形式——“MainForm”和“Add_Form”。“MainForm”有“Student_DataGrid”，它有一个学生寄存器和按钮（“btn_add_student”），它调用“Add_Form”（表格有学生输入数据的文本块）。单击“btn_add_student”后显示“Add_Form”，进一步，我在文本块中填写数据并按下按钮“btn_add_student”。新学生被添加到数据库中并且“Add_form”被关闭。然后必须重新加载“MainForm”上的“Student_DataGrid”。

换句话说，我想从 MainForm 监听 Add_Form 上的事件。我可以在 C# 中做到这一点，但我不能在 WPF 中做到这一点。我很乐意提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T18:05:08.213

似乎您还没有探索 WPF 的优势，即`Binding`. 这些教程将帮助您学习[Binding 教程](http://www.codeproject.com/Articles/140621/WPF-Tutorial-Concept-Binding "装订教程")和[msdn](http://msdn.microsoft.com/en-us/library/ms752347.aspx "微软")中的一个。

在您的情况下，您需要做的就是将您的网格绑定到一个`ObservableCollection`和同时添加一个新学生，`add the object in this collection`. 网格将自动刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T16:41:29.237

如果“Add_Form”和“MainForm”绑定到同一个源，“MainForm”上的“Student_DataGrid”不需要重新加载。WPF 可以为你做这件事。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-24T13:15:25.303

我找到了解决它的方法:)。我刚刚做了一整堂课:)。 [给你！](http://www.codeproject.com/Articles/14122/Passing-Data-Between-Forms#_rating)

# mysql - MySQL插入表1更新表2，子查询还是事务？

> ID：12552924
> 
> 赞同：0
> 
> 时间：2012-09-23T13:56:15.313
> 
> 标签：mysql

我想插入或更新，然后将新日志插入另一个表。

我正在运行一个漂亮的小查询，将信息从临时表中提取到其他表中，例如

在重复键更新时插入选择

我想在没有 php 或触发器（主要开发人员不喜欢 em，而且我对它们也不熟悉）的情况下做的是将新记录插入日志记录表中。需要报告更新或插入的数据以及在什么表上。

有什么提示或例子吗？

注意：我用 php 做的很好，虽然处理 50K 行需要大约 4 个小时。使用 laravel php 框架，循环更新 4 个其他表中的每个条目，每个条目的数据和日志等于每行 8 个查询（这是使用 laravel 模型而不是原始 sql）。我能够通过将日志推送到数组和批处理来进行优化。但是你无法通过绕过所有吞吐量来击败 mysql 中 15 秒的处理时间。现在我迷上了用 sql 方式做一些很棒的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T15:26:07.733

如果您需要执行多个查询语句。我指的是使用事务然后触发来保证[原子性](http://en.wikipedia.org/wiki/Atomicity_%28database_systems%29)（[ACID](http://en.wikipedia.org/wiki/ACID)的一部分）。波纹管代码是[MySql 事务](http://dev.mysql.com/doc/refman/5.0/en/commit.html)的示例：

```
START TRANSACTION;
UPDATE ...
INSERT ...
DELETE ...
Other query statement
COMMIT; 
```

事务中的语句将全部执行或不执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T14:39:56.993

最好使用触发器，它通常用于记录目的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T15:33:55.777

如果你想做两件事（插入基本行和插入日志行），你需要两个语句。第二个可以（并且应该）是一个触发器。

# ruby-on-rails - 无法构建 gem 原生扩展 - Rails 安装

> ID：12552929
> 
> 赞同：74
> 
> 时间：2012-09-23T13:56:35.400
> 
> 标签：ruby-on-rails, ruby, rubygems

我一直在根据 edX 在线课程的说明安装 Ruby on Rails。

以下是终端命令列表，以及相关的相应输出：

```
$ sudo apt-get install ruby1.9.1 
```

安装成功

```
$ wget http://production.cf.rubygems.org/rubygems/rubygems-1.8.24.tgz
$ tar zxvf ruby-1.8.24.tgz
$ cd ruby-1..8.24
$ sudo ruby setup.rb
RubyGems 1.8.24 installed

== 1.8.24 / 2012-04-27

* 1 bug fix:

  * Install the .pem files properly. Fixes #320
  * Remove OpenSSL dependency from the http code path

------------------------------------------------------------------------------

RubyGems installed the following executables:
    /usr/bin/gem1.9.1 
```

到这里为止，一切看起来都很好，但是我尝试安装 rails 并失败了：

```
$ sudo gem install rails
Fetching: i18n-0.6.1.gem (100%)
Fetching: multi_json-1.3.6.gem (100%)
Fetching: activesupport-3.2.8.gem (100%)
Fetching: builder-3.0.3.gem (100%)
Fetching: activemodel-3.2.8.gem (100%)
Fetching: rack-1.4.1.gem (100%)
Fetching: rack-cache-1.2.gem (100%)
Fetching: rack-test-0.6.1.gem (100%)
Fetching: journey-1.0.4.gem (100%)
Fetching: hike-1.2.1.gem (100%)
Fetching: tilt-1.3.3.gem (100%)
Fetching: sprockets-2.1.3.gem (100%)
Fetching: erubis-2.7.0.gem (100%)
Fetching: actionpack-3.2.8.gem (100%)
Fetching: arel-3.0.2.gem (100%)
Fetching: tzinfo-0.3.33.gem (100%)
Fetching: activerecord-3.2.8.gem (100%)
Fetching: activeresource-3.2.8.gem (100%)
Fetching: mime-types-1.19.gem (100%)
Fetching: polyglot-0.3.3.gem (100%)
Fetching: treetop-1.4.10.gem (100%)
Fetching: mail-2.4.4.gem (100%)
Fetching: actionmailer-3.2.8.gem (100%)
Fetching: rake-0.9.2.2.gem (100%)
Fetching: rack-ssl-1.3.2.gem (100%)
Fetching: thor-0.16.0.gem (100%)
Fetching: json-1.7.5.gem (100%)
Building native extensions.  This could take a while...
ERROR:  Error installing rails:
    ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.9.1 extconf.rb
/usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:1:in `<main>'

Gem files will remain installed in /usr/lib/ruby/gems/1.9.1/gems/json-1.7.5 for inspection.
Results logged to /usr/lib/ruby/gems/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out 
```

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-09-23T13:59:08.413

`mkmf`是`ruby1.9.1-dev`包装的一部分。此包包含 Ruby 1.9.1 扩展库所需的头文件。您需要`ruby1.9.1-dev`通过执行以下操作安装软件包：

```
sudo apt-get install ruby1.9.1-dev 
```

然后你就可以正常安装 Rails 了。

一般来说，这样做更容易：

```
sudo apt-get install ruby-dev 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-12-29T19:47:41.580

建议的答案仅适用于某些版本的 ruby​​。一些评论者建议使用 ruby​​-dev；那对我也不起作用。

```
sudo apt-get install ruby-all-dev 
```

为我工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-10T10:12:57.143

```
sudo apt-get install ruby-dev 
```

为我工作

# scala - 在 List.map 中使用递归调用

> ID：12552933
> 
> 赞同：1
> 
> 时间：2012-09-23T13:56:58.803
> 
> 标签：scala, recursion

我对 Scala 中的列表操作有疑问。我正在尝试实现相同的逻辑，我已经在 J​​ava 中按顺序实现了（并且它有效），但它返回了我没想到的 0。我已经尽可能地调试了列表操作（将提供的映射调用替换为列表序列，其行为符合预期），但我无法跟踪最后一步（将列表成员映射到此函数的递归调用）。你能提供一些关于我的方法的想法吗？

```
@tailrec
def a(b: Int, cList: List[Int]): Int = {
    if (b == 0) 1
    else if (cList.isEmpty) 0
    else
      List.range(0, b / cList.head).
        map(n => a(b - n * cList.head, cList.tail)). 
        foldLeft(0)((b, a) => b + a)
  } 
```

我想，在`foldLeft`列表之前必须包含对所有元素的递归调用的结果。这样的电话有效吗？为清楚起见，我附上了我的 Java 程序，它的行为与假设的一样：

```
private static int a(int b, int[] cList) {
        if (b == 0) {
            return 1;
        } else {
            if (cList.length == 0)
                return 0;

            int head = cList[0];
            int[] tail = Arrays.copyOfRange(cList, 1, cList.length);
            int x = b / head;
            int sum = 0;
            for (int i = 0; i <= x; i++) {
                sum += a(b - (i * head), tail);
            }
            return sum;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T16:30:37.107

检查 List.range 的文档：

> 带有值的 $coll`start, start + 1, ..., end - 1`

补充说明：

*   在您的情况下，尾调用优化不可用。
*   `.foldLeft(0)((b, a) => b + a)`等于`.sum`
*   您将命令式循环解决方案与递归混合，尝试仅使用递归列表处理

# php - 我的 html 代码有什么问题？

> ID：12552934
> 
> 赞同：0
> 
> 时间：2012-09-23T13:57:00.800
> 
> 标签：php, html

**文件 omg.html**

```
<!DOCTYPE html>
<html>
    <head><title>:)</title></head>
        <body>
            <?php
                echo 'Hello world';
            ?>
        </body>
</html> 
```

它应该创建一个打印的网页`Hello world`，但它不打印任何东西。它出什么问题了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T13:58:36.683

PHP 不是 HTML。

您需要通过 PHP 解释器运行您的 PHP 程序以输出 HTML。

这通常使用以下方法执行：

*   具有 .php 文件扩展名的文件
*   网络服务器（例如[Apache](http://httpd.apache.org)）
*   安装[PHP](http://php.net/) _

其他选项可用：

*   您可以通过 PHP 的命令行版本运行该文件（尽管这会在当时为您提供输出，并且不会在每次浏览器访问页面时按需提供）。
*   您可以将服务器配置为使用不同的文件扩展名
*   您可以将服务器配置为使用文件扩展名以外的方法来确定什么是 PHP 程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-23T13:58:45.957

您的文件必须具有`.php`扩展名才能工作。

* * *

但是，如果您真的想将`.html`文件用作 PHP 文件，有一个技巧可以告诉 Apache 将 HTML 文件解析为 PHP 文件。[在这里](https://stackoverflow.com/a/6295204/1494505)阅读更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-23T13:58:25.167

您不能在 html 文件中包含 php 代码..

使其成为 php 文件，以便它可以被运行的服务器解析，很可能是 apache..

当服务器看到一个`.html`作为文件扩展名时，它只是将文件发送给客户端，由浏览器解释..要运行 php 脚本，您需要文件作为`.php`扩展名，以便服务器解释它..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T13:59:13.667

这不仅仅是 HTML 代码，还有 PHP 代码。如果文件被调用`omg.html`，那么 PHP 解释器可能不会解析它。惯例是使用`.php`扩展名命名 PHP 文件。您*可以*将 PHP 解释器配置为也解释 HTML 文件，但它是非标准的。

从一般的问题来看，我想知道是否涉及 PHP 解释器。单独的文件不能处理 PHP 代码，你需要一个解释器。你用的是什么设置？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-23T14:00:09.720

必须通过带有 php 的服务器运行。并且必须具有 .php 扩展名才能工作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-23T14:00:13.547

> 将其保存为 .php 并检查文件是否位于安装 php 解释器的 apache 根目录下

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-23T14:01:19.833

文件扩展名必须有 .php

文件名应为“omg.php”

# mysql - 我可以为 MySQL 的多个进程设置一个连接池吗？

> ID：12552935
> 
> 赞同：1
> 
> 时间：2012-09-23T13:57:13.400
> 
> 标签：mysql

我了解最常见的情况是维护一个每个进程的连接池，并且该池中的连接在多个线程之间共享。但是，当运行的进程实例过多时，此解决方案会出现一些问题。

因此，我们希望通过维护单个连接假脱机来改进这一点，并跨进程共享连接。但是，我不确定这是否可行，因为我不知道本机 MySQL 连接句柄（MYSQL 结构）是否可以跨进程共享。还是需要一些额外的设计工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:01:28.953

您可以为此使用 SQL Relay：[http ://sqlrelay.sourceforge.net/](http://sqlrelay.sourceforge.net/)

但我确实想知道你为什么要这样做？在 MySQL 中创建新连接是一个非常轻量级的过程，每个进程 1 个连接（甚至多个）应该不会导致任何问题。

# css - 将固定宽度列和可变宽度列组合在一个表中

> ID：12552945
> 
> 赞同：2
> 
> 时间：2012-09-23T13:58:56.820
> 
> 标签：css, width, css-tables

如何使用 CSS 创建一个表格，如下所示（前三列以 px 为固定宽度，以下列以 % 为宽度）：

[![](../Images/dc49666c19b2afaaeeb19fb49d14a2d0.png)](http://imageshack.us/a/img222/2860/css3t.png)

我知道如何创建具有可变或固定宽度的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:15:43.103

`table`为右侧的 4 列嵌套另一个。HTML 结构如下所示：

```
<table class = "big first">
<tr>
<td class = "px10">Cell1</td>
<td class = "px20">Cell2</td>
<td class = "px30">Cell3</td>
<td>
    <table class = "big">
    <td>1</td><td>2</td><td>3</td><td>4</td>
    </table>
</td>
</tr>
</table> 
```

CSS：

```
.big {
    width: 100%;
}
.first {
    table-layout: fixed;
}
.big, .big td {
    border: 1px sold black;
}
.big td {
    background: rgb(0, 162, 232);
}
.big .px10 {
    background: orange;
    width: 10px;
}
.big .px20 {
    background: green;
    width: 20px;
}
.big .px30 {
    background: yellow;
    width: 30px;
} 
```

还有一个小演示：[小链接](http://jsfiddle.net/glee/dhGjf/)。

**编辑：**事实证明可能不需要另一个`table`：[另一个小链接](http://jsfiddle.net/glee/dhGjf/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:11:58.323

您可以将最后四个单元格放置在主表的 td 中的表中 -[请参阅 Fiddle](http://jsfiddle.net/henrikandersson/uxHma/) - 如下所示：

```
<div class="wrapper">
    <table class="table-main">
        <tr>
            <td class="first"> </td>
            <td class="second"> </td>
            <td class="third"> </td>
            <td class="fluid">
                <table class="table-wrapped">
                    <tr>
                        <td class="td-quarter"> </td>
                        <td class="td-quarter"> </td>
                        <td class="td-quarter"> </td>
                        <td class="td-quarter"> </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>​

<style>
    .wrapper { min-width: 150px; max-width: 550px;}
    .table-main { width: 100%; background: blue; }
    td { border: 1px solid #000; background: #fc0; height: 20px; }

    .first { width: 10px; }
    .second { width: 20px; }
    .third { width: 30px; }

    .fluid { min-width: 100px; max-width:500px;border:0;}
    .table-wrapped { width:100%;}
    .td-quarter { width: 25%; background:blue; }
​&lt;/style> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-23T14:13:59.963

OP最初要求

> 使用 CSS3 设计表格

所以这里是 CSS3，代码尽可能少

```
<div id="first">
    <div>1</div>
    <div>2</div>
    <div>3</div>
</div>
<div id="second">
    <div>1</div>
    <div>2</div>
    <div>3</div>
    <div>4</div>
</div>​ 
```

CSS：

```
#first, #second {
    float:left;
    overflow:hidden;
}
#first > div, #second > div {
    float:left;
}
#first > div:first-child {
    width:10px;
}
#first > div:nth-child(2) {
    width:20px;
}
#first > div:nth-last-child(1) {
    width:30px;
}
#second {
    min-width:100px;
    max-width:500px;
}
#second > div {
    width:25%;
}
​ 
```

[现场演示](http://jsfiddle.net/gionaf/udhQ5/)

# mongodb - 在 Meteor App 中将复杂的 Mongo 文档渲染为模板

> ID：12552946
> 
> 赞同：1
> 
> 时间：2012-09-23T13:58:58.117
> 
> 标签：mongodb, meteor

在 Metoer 应用程序中，mongodb 集合包含描述项目的文档。他们在人员、头衔和其他事实方面差异很大。

当用户从侧边栏列表中选择一个项目时，我想将文档中的所有信息呈现给一个反应模板。

侧边栏列表可能如下所示：

*   **布鲁克林大桥**
*   **胡佛水坝埃菲尔**
*   **塔**

胡佛水坝的 mongo 文档可能如下所示：

```
{
"_id": "dksld888-aaaa-12345",
"name" : "Hoover Dam",
"year_built" : 1931,
... other facts... 
"architects" : 
    [
        {
          "person_id" : "1a2d528c-6509-4c3a",
          "title" : "Lead Designer"
        },
        {
           "person_id" : "4a3d-81e0-5a3f-2343",
            "title" : "Assistant"
        }
    ]
... other job descriptions... 
} 
```

person_id 字段包含另一个集合中条目的 ObjectID，该集合具有关于该人的更多详细信息。

该系统旨在允许用户从项目名称向下钻取到项目详细信息再到人员详细信息（或激活项目详细信息模板中的数据编辑）。

我不知道如何继续将项目详细信息文档呈现为反应性模板（递归循环并深入了解文档）。如果我做错了，我也很乐意更改项目集合的结构。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:53:33.367

首先，制作一个渲染项目的模板。然后在您的侧边栏上设置一个事件监听器，以便当用户单击一个项目时，会设置一个包含当前项目 ID 的 Session 值。让项目模板监听 Session 值来绘制相应的项目。

在项目模板中，使用 {{#each person}} 创建人员列表，然后让模板在项目中绘制人员。您可能应该编写一个方便的方法，通过给定的 person_id 获取人员。

我会在我的答案中添加代码，但这里有很多事情要做，所以如果你无法弄清楚，请说明你遇到了什么问题，我会尽力提供帮助。

# asp.net-mvc - MVC 中的 Windows 身份验证

> ID：12552950
> 
> 赞同：4
> 
> 时间：2012-09-23T13:59:47.037
> 
> 标签：asp.net-mvc, authentication, asp.net-mvc-4, windows-authentication

我想使用 Windows 身份验证检查用户的登录名。我有这个作为我的控制器的构造函数：

```
public class HomeController : BaseController
{
    public string UserIdentityName;

    public HomeController()
    {
        UserIdentityName = System.Web.HttpContext.Current.User.Identity.Name;// HttpContext.Current.User.Identity.Name;
    }
} 
```

但是 UserIdentityName 返回空字符串...

我的 web.config 中也有这个：

```
<authentication mode="Windows" /> 
```

任何的想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T11:57:57.930

在解决方案资源管理器窗格**中，选择 Web Project 并点击 F4**。（不是右键单击+属性，那是不同的）

在属性窗格中设置：
**Windows 身份验证**：启用
**匿名身份验证**：禁用

在 Web.config 中：`<authentication mode="Windows"></authentication>`

获取用户名：

```
HttpContext.Current.User.Identity.Name OR User.Identity.Name 
```

运行你的项目，Happy Days！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T14:02:23.127

不要尝试在控制器的构造函数中访问任何与 HttpContext 相关的内容。您应该访问它的最早阶段是[Initialize](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.initialize%28v=vs.98%29.aspx)方法或在控制器操作中。

例如：

```
[Authorize]
public ActionResult Index()
{
    string user = User.Identity.Name;
    ...
} 
```

还要确保在 Web 服务器上启用了 Windows 身份验证 (NTLM)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-09T13:11:19.987

伙计们，

如果您在 IISExpress 中运行。确保以下设置：

在 web.config

```
<authentication mode="Windows"/>
<authorization>
  <deny users="?"/>
</authorization> 
```

在记事本中打开 projectName.csproj 并更正以下设置：

```
<IISExpressAnonymousAuthentication>disabled</IISExpressAnonymousAuthentication>
<IISExpressWindowsAuthentication>enabled</IISExpressWindowsAuthentication>

<UseIIS>True</UseIIS> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T14:03:32.907

尝试添加：

```
<authorization>
  <deny users="?" />
</authorization> 
```

拒绝匿名用户的访问。

# c# - 使用 CLI 或任何其他方式将 C++ 库静态链接到 C# 进程

> ID：12552951
> 
> 赞同：2
> 
> 时间：2012-09-23T13:59:58.330
> 
> 标签：c#, c++, static-libraries, command-line-interface

是否可以采用用 C++ 编写的静态库并以某种方式将其集成到 .NET 进程中，以将 .NET 进程与 lib 集成到一个 exe 文件中？
我的意思是我知道我可以从 C# 进程中调用 C++ DLL，但用户仍然必须拥有 C++ DLL，但是是否可以使用 lib 而不是 DLL？（这样用户将不会甚至不知道 exe 使用我的库）。如果可能的话，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T14:10:41.307

在其他托管语言中独一无二的是，C++ 允许混合模式——在同一个编译单元 (dll/exe/lib) 中将托管 ( [C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI) ) 和本机 C++ 组合在一起，并进行来回调用。也许你可以利用它，创建一种粘合层。不过我从来没有尝试过。

关键是 /clr 编译器开关 - 您将其应用于项目中的某些文件，而不是其他文件。然后你创建一些托管的类/函数。非托管位可以看到它们并调用它们，反之亦然。传递原始类型是透明地完成的，对于字符串有一些编组技巧。我将能够在星期一发布更多内容。

编辑：似乎需要一些深刻的魔法。不在混合 C++ 方面 - 在将结果链接到 C# 方面。如您所见，Visual Studio IDE 并不容易支持该方案。很有可能，常规的构建过程不会有任何用处。

EDIT2：您可以通过将 /LN 命令行选项指定给编译器并将 /NOASSEMBLY 指定给链接器，将 C++ 位编译为 .netmodule。现在，将其链接到 C# exe...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T21:51:26.023

我用visual 2008做了类似的事情（我不知道它是否仍然可以用新版本的VC）。所以这是可能的。根据我的经验，您只能将本机 C++ 与托管 C++ 混合使用，而不是 C#。为此，我简单地创建了一个解决方案，其中包含（在我的情况下）几个用本机 C++ 编写的库，在托管 C++ 中创建一个 exe 项目并添加对项目的依赖项。您将需要编写一些包装托管 C++ 类，因为您不能直接在托管类中混合本机类型。（您将遇到一些编译错误，例如“错误 C4368：无法将 'nativeVar' 定义为托管 'ManagedClass' 的成员：不支持混合类型”。

我不知道你为什么要在你的库中使用 .NET，我个人想使用 .NET 接口，即使它对我有用，但如果我不得不这样做的话，这种混合对我来说是一个很大的痛苦再次，我将使用所有带有 MFC 或 GUI 库的本机 C++。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-09-23T14:02:37.877

不，这完全不可能。现在在 C++/CLI 中禁止使用混合模式——每一段代码要么完全是 .NET，要么完全是原生的，跨越边界的唯一方法是通过 P/Invoke 和 DLL。

# google-chrome - 检查是否打开某个 URL 并更改查询字符串值

> ID：12552953
> 
> 赞同：1
> 
> 时间：2012-09-23T14:00:05.840
> 
> 标签：google-chrome, google-chrome-extension

今天是个好日子！我决定第一次尝试为 Chrome 制作扩展程序，我有这个想法，但我不知道如何开始。我希望你能指出我正确的方向。

我想检测是否打开了某个 URL，然后更改其查询字符串之一的值。例如：

1.  我打开页面[http://downloadpage.url/?page=info&id=123456](http://downloadpage.url/?page=info&id=123456)
2.  扩展程序将检测到这一点并将查询字符串“page”值从“info”更改为“download”，并继续使用新值打开页面。

我该怎么做呢？我认为所需的权限是 WebRequest 和 WebRequestBlocking 但我不确定。我在这里尝试了这些步骤：[检测 URL 是否已打开 - Chrome 扩展](https://stackoverflow.com/questions/9326962/detect-if-url-is-opened-chrome-extension)，但即使将 background_page 更改为背景以说明我的清单版本（我的 Chrome 版本是 21.0.1180.89），它似乎也不起作用。我希望我可以在那里修改代码，但不幸的是它对我不起作用，现在我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T00:06:25.380

按照 Rob W 在上面评论中的链接（谢谢 Rob！），我想出了一些可以根据我想要的工作的代码。首先，当我在预期的 URL 中时，我将以下内容添加到清单中以运行内容脚本：

```
 "content_scripts": [
     {
       "matches": [
          "http://downloadpage.url/*"
       ],
       "js": ["background.js"]
     }
  ] 
```

显然网址是假的……

然后使用以下函数创建了一个名为 background.js 的文件，这使得获取查询字符串变得容易。原始代码来自[这里](https://stackoverflow.com/a/647272/344841)，我对其进行了一些修改以使其可重用于其他链接或字符串。：

```
function getQueryString(URL) {
  if (!URL) {
    URL = location.search;
  }
  else
  {
    var a = document.createElement('a');
    a.href = URL;
    URL = a.search;
  }

  var result = {}, queryString = URL.substring(1),
      re = /([^&=]+)=([^&]*)/g, m;

  while (m = re.exec(queryString)) {
    result[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
  }

  return result;
} 
```

最后，使用修改后的查询字符串进行重定向的代码如下：

```
if (page == "info")
{
  var ID = getQueryString()["id"];

  location.replace('http://downloadpage.url/?page=download&id='+ID;);
} 
```

我仍然愿意接受更好、更优雅的解决方案，但这正是我想做的。如果您有更好的想法，请告诉我。干杯!

# php - 为什么不在 NFS 卷上存储 PHP SESSION？

> ID：12552955
> 
> 赞同：2
> 
> 时间：2012-09-23T14:00:12.253
> 
> 标签：php, storage

我知道最好的存储方式`PHP SESSION`是 PHP 集群中的“在 memcached 中处理”。

但是，我想知道是否有人将 PHP SESSION 文件存储在*NFS*（网络文件系统）、*GFS*或*HDFS*中？

我想知道它是否有风险？还是性能不好？

我认为它可以提供 SSO。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T14:09:43.020

The short answer is that you shouldn't use something like NFS for session management because it doesn't handle locking correctly on the distributed session files that could be accessed by any of the client servers. Plus, a lot of solutions don't correctly handle asynchronous reads.

Plus, if your networked file system "goes away", you will be in a real mess, because you get into a situation where you need to start detecting the bad mount in your PHP application.

That said, you could roll out NFS for session management if you expect low throughput, but to be honest, there are better solutions out there.

If I had to rank... I'd say any of the in memory stores are best. Memcache/Redis. I like using Redis with 5 minute writes to disk.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:08:33.447

It can technically be done but the performance would be subpar. The fastest medium to store data is always the memory, which is why in-memory solutions like memcached are recommended for session data storage. There is overhead in writing the data back to disk, and even a bigger overhead in connecting to a networked hd, and then perform the write on that disk.

# php - 未找到 httpd.exe 入口点

> ID：12552957
> 
> 赞同：4
> 
> 时间：2012-09-23T14:00:44.580
> 
> 标签：php, xampp, apache

我需要升级我的本地 PHP 版本，所以我备份了我的`htdocs`文件夹，使用 Windows 安装程序重新安装了 XAMPP 并复制了我的备份。

我尝试运行 apache 模块以收到路径警告。因此，我检查了“”的每个实例`/xampp/`并将其更改为“ `/Utilities/server/`” `httpd.conf`，`httpd-xampp.conf`这非常烦人，因为我以前从未这样做过。

现在我得到错误：

> 无法在动态链接库 php5ts.dll 中定位程序入口点 php_checkuid

这些`.conf`文件很长，所以除非有人特别要求，否则我不会在这里发布它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-12T16:20:35.210

我的理解是，动态链接库基本上将 dll 文件与位置相关联。在您的实例中，位置已更改，重新安装 php（或 xampp）应该可以解决您的问题。

另一种解决方案是检查您的 PHP.INI 文件中是否有对任何 .dll 文件的引用，并确保这些引用对于您的新安装文件夹是正确的。

# javascript - Javascript 图像预加载无法正常工作

> ID：12552960
> 
> 赞同：2
> 
> 时间：2012-09-23T14:01:31.050
> 
> 标签：javascript, jquery, image, node.js, preload

我有一个 JS/jQuery 脚本，可以在页面上动态附加图像。我正在使用节点作为服务器。我添加了日志服务器端，我注意到每次“追加”完成时，页面都会向服务器询问图像，即使它总是附加的两个相同的图像。现在，这发生在 Chrome 上，但不是在 Mozilla 上，图像只加载一次。我认为这将是缓存；但缓存没有被禁用。另外，我尝试通过在页面开头使用正确的 src 创建一个 Image 对象来进行一些预加载：同样的问题。即使它是浏览器缓存设置，我也不想建立一个网站，其中禁用缓存的用户向我的服务器发送垃圾邮件，请求相同图像的无用请求......有什么建议吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-23T14:06:32.027

# html - 在 HTML5 中使用 HTML 表格进行布局

> ID：12552964
> 
> 赞同：1
> 
> 时间：2012-09-23T14:02:17.433
> 
> 标签：html, layout, html-table

我目前正在将 MediaWiki 安装从古老的 1.6.10 升级到 1.19.2。其中一个变化是新的 MediaWiki 使用了`<!DOCTYPE html>`，它稍微改变了布局。

现在，MediaWiki 扩展之一使用表格进行布局。例如：

```
<!DOCTYPE html>
<table>
 <tr style="background-color:lime;">
  <td><img src="pixel.gif"></td>
 </tr>
</table> 
```

现在即使 pixel.gif 只有 1x1 像素大，石灰矩形使用 3x22 像素。我的意图是该行应该只有 1 个像素高。有没有简单的使用方法`<table>`，还是我必须切换到使用`<div>`s？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:15:45.370

表格是表格和 html，与 HTML5 没有什么不同，但当然，表格不应该用于布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:53:07.480

添加这个CSS：`td { font-size:0;padding:0 }`

这实际上与表格无关。使用 div 也会遇到同样的问题。因此，同样地，使用`div { font-size:0; }`. 更现实地说，您需要使用类来限定您想要样式的 div。例如`div.myimagecontainer { font-size:0; }`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T01:45:24.383

如果您必须使用`<table>`布局，请确保`<table role="presentation">`按照 W3C html5 建议正确设置角色属性：

> 表格不应用作布局辅助工具。从历史上看，许多 Web 作者使用 HTML 格式的表格来控制他们的页面布局，这使得从此类文档中提取表格数据变得困难。特别是，辅助工具（如屏幕阅读器）的用户可能会发现使用用于布局的表格导航页面非常困难。如果要将表格用于布局，则必须使用属性 role="presentation" 标记，以便用户代理正确地将表格表示为辅助技术，并将作者的意图正确传达给希望提取表格的工具文档中的数据。

[http://www.w3.org/TR/html5/tabular-data.html#the-table-element](http://www.w3.org/TR/html5/tabular-data.html#the-table-element)

# c - c中数组的最大大小有什么限制吗？

> ID：12552968
> 
> 赞同：3
> 
> 时间：2012-09-23T14:02:31.637
> 
> 标签：c, arrays, multidimensional-array

> **可能重复：**
> [C 编程，为什么这个大数组声明会产生分段错误？](https://stackoverflow.com/questions/3049934/c-programming-why-does-this-large-array-declaration-produce-a-segmentation-faul)

我正在阅读 c 语言中的图像，但我无法这样做，因为我的程序在两者之间停止...调试后我发现这是由于数组大小...对数组的最大大小有任何限制吗？如果我声明大小为 1400X1400 的数组一切正常，但如果我定义大小为 1600X1400 的数组，我的程序将停止工作......为什么会这样......编译器或操作系统对数组大小有任何限制吗？如果是这样，c 中的解决方案是什么。

```
 unsigned char idata[1400][1400]; //working fine
    unsigned char idata[1600][1400]; //not working 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-23T14:04:58.577

我猜这`idata`是一个局部变量。问题是局部变量存储在堆栈中（技术上是“自动存储”），并且堆栈远小于您尝试在其上分配的 6400 兆字节。在其上分配这么多存储会导致堆栈溢出。

尝试

```
unsigned char** idata = new unsigned char*[DIM1];

for (int i = 0; i < DIM1; ++i)
    idata[i] = new unsigned char[DIM2];

// or

unsigned char (*idata)[DIM2] = new char[DIM1][DIM2]; 
```

在免费商店中分配它，你应该没有问题。

编辑：

我只是查看了标签，并没有看到您只是在谈论 C。如果是这样，您可以做同样的事情，但使用`malloc`代替`new`：

```
unsigned char** idata = malloc(sizeof(unsigned char*) * DIM1);

for (i = 0; i < DIM1; ++i)
    idata[i] = malloc(DIM2);

// or

unsigned char (*idata)[DIM2] = malloc(DIM1 * DIM2); 
```

并且不要忘记`free`（或`delete[]`对于 C++）您分配的内存以避免内存泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T14:05:29.823

如果您在堆栈上声明它（例如在某些函数中），那么是的，它将提供堆栈溢出。

您可以将其声明为静态（“全局变量”）或动态分配内存。

[Using malloc for allocation of multi-dimensional arrays with different row lengths](https://stackoverflow.com/questions/1970698/c-malloc-for-two-dimensional-array) 问题与此有关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-23T14:12:19.627

以下是您如何在 C 中的免费存储中分配和释放 2D 数组：

```
unsigned char (*idata)[1400] = malloc(1600 * 1400);
// ...
free(idata); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-23T14:08:43.950

当您使用诸如 之类的表达式`unsigned char idata[sz1][sz2]`时，数组的空间在堆栈中分配，而堆栈的空间在某种程度上非常小，这会导致您出现问题。

但是如果你使用 unsigned `char* idata = new char*[sz]`，需要的空间是在堆上分配的。通常你可以得到你想要的空间。

# tags - 标签语义替代用法

> ID：12552978
> 
> 赞同：2
> 
> 时间：2012-09-23T14:03:55.973
> 
> 标签：tags, semantics, line-breaks

好吧，我知道那
是毫无意义的。问题是当有以下段落时：

> 你好朋友。
> 今天我学到了一个新技巧，但我还不会告诉你。
> 
> 好吧，我只是在开玩笑。Lorem ipsum dolor sit amet, consectetur adipiscing elit。Rhoncus 在麦格纳。Nulla aliquam turpis ac magna scelerisque vel eleifend libero **malesuada** .
> Quisque facilisis leo et elit ultricies id suscipit leo ornare。Vestibulum mi odio, facilisis non fringilla vitae, imperdiet egestas mauris。Nunc enimerat, vehicula vel malesuada nec。

如您所见，有两段。它们在中间都有一个由`<br>`标签完成的换行符。为了语义的缘故，我怎么能不使用这个标签呢？

注意：插入粗体“malesuada”是为了帮助您轻松识别第二个换行符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:41:24.987

首先，换行符旨在用于必须在文本流中出现换行符的情况，例如在诗歌中。

像这样标记文本的普遍接受的方法是段落，它们是块级的，因此总是创建一个新行，并设置它们之间的边距。这里有两种段落样式，一种需要空间，一种不需要。你可以有两种不同风格的段落（我只是在这里说明垂直边距 - 水平边距设置为 0）。

```
p {margin:.1em 0;}

p.special {margin:0;} 
```

然后只需将“特殊”类添加到没有空格的段落中。请注意，垂直边距将折叠，因此您只会在每个段落之间获得 1em 的空间。

不过，我更大的问题是设计问题：为什么要这样组织段落？为什么不只是有一个标准的段落间距，也许使用标题来分组段落集？您正在做的事情是非常规的，这就是为什么您在寻找要使用的正确 HTML 元素时遇到问题的原因。hth，查尔斯

# c# - 在 c# 中除以 2 个 long 时得到 0 的值

> ID：12552980
> 
> 赞同：14
> 
> 时间：2012-09-23T14:04:10.863
> 
> 标签：c#, casting, int, long-integer

我正在尝试划分 DriveInfo.AvailableFreeSpace 和 DriveInfo.TotalSize 的值以尝试获取它的百分比以在进度条中使用。

我需要最终值是一个 int，因为 progressbar.value 需要一个 int 并且上述方法返回一个 long。

我有这个作为价值观：

164660715520---可用空闲空间

256058060800---总尺寸

当我尝试使用此方法设置 progressbar.value 时，我也会收到错误消息：

progressBar1.Value=(int)(dInfo.AvailableFreeSpace/dInfo.TotalSize)*100;

当我使用此代码尝试获取一个值时，它只返回一个 0。

```
label10.Text =  (((int)dInfo.AvailableFreeSpace/dInfo.TotalSize)*100).ToString(); 
```

我什至试过这个，但它不起作用：

```
label10.Text = ((dInfo.AvailableFreeSpace/dInfo.TotalSize)*100).ToString(); 
```

我知道我仍然需要进行一些格式化才能让它看起来不错，但是每当我运行代码时它只会返回一个 0。

它与从 long 到 int 的转换有关吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-23T14:08:04.137

整数除法仅返回整数部分。所以 3/5 将是 0。您需要将至少一个因素视为浮点数。试试这个：

```
label10.Text =  (((int)((double)dInfo.AvailableFreeSpace/dInfo.TotalSize)*100)).ToString(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-23T14:09:18.650

`dInfo.AvailableFreeSpace`立即转换的第一种方法`int`行不通，因为`164660715520`您尝试转换的数字不适合 32 位。您需要尽可能保持 64 位。

**避免浮点运算的诀窍是先乘以`100`，然后再进行除法。**

只要次数`100`在允许的大小范围内（在您的情况下是这样），结果就具有良好的精度：

```
label10.Text = ((100*dInfo.AvailableFreeSpace/dInfo.TotalSize)).ToString(); 
```

[ideone 上的演示（打印 64）。](http://ideone.com/r2tE6)

```
long total = 256058060800L;
long avail = 164660715520L;
var pct = (100*avail/total).ToString();
Console.WriteLine("{0}", pct); // 64 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-23T14:08:17.100

该值向下舍入为 0，因为`long`类型不能有小数位，只能有整数。

`decimal`在乘以 100 之前转换为类型

例如（在我计算 ProgressBar 的进度百分比的情况下）：

double someVariable = (double)longVariable1 / (double)longVariable2;

代码如下：

```
public partial class Form1 : Form
{
   public Form1()
    {
         web.ProgressChanged += new WebBrowserProgressChangedEventHandler(web_ProgressChanged);
    }

private void web_ProgressChanged(object sender, WebBrowserProgressChangedEventArgs e)
    {

        <strong>double t = (100 * (double)e.CurrentProgress / (double)e.MaximumProgress);</strong>
        if (t < 0)
            return;
        int c = (int)t;
        progressBar.Value = c;

        if (c == 100)
        {
            label1.Text = "Done";                
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-23T14:13:09.170

使您的 dInfo.AvailableFreeSpace 和 dInfo.TotalSize 十进制或双精度类型以避免强制转换或

采用`label10.Text = (((double)dInfo.AvailableFreeSpace/dInfo.TotalSize)*100).ToString();`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-27T21:46:03.663

我可能有点晚了，但是在尝试比较时间跨度时遇到了这个问题。最终我将每个 timepsan 转换为一个字符串并手动计算比率

```
 private static double Improvement(string efficientTime, string inefficientTime)
    {
        var magnitude = Math.Pow(10, (inefficientTime.Length - efficientTime.Length));
        var time2 = (double) Convert.ToInt32(efficientTime.Substring(0, 5));
        var time1 = (double) Convert.ToInt32(inefficientTime.Substring(0, 5));
        var sigRatio = (time2 / time1);

        var sigPercent = sigRatio * magnitude;

        var improvement = sigPercent;
        return improvement;
    } 
```

# python-3.x - Python 3：字符串有 __next__() 方法吗？

> ID：12552986
> 
> 赞同：3
> 
> 时间：2012-09-23T14:05:05.827
> 
> 标签：python-3.x

```
>>> s = 'spam'
>>> s.__next__() 
```

结果是： **Traceback（最近一次调用最后一次）：文件“”，第 1 行，在 s._ *next* _() 中 AttributeError: 'str' object has no attribute '_ *next* _'**

但是在文档[http://docs.python.org/py3k/library/stdtypes.html#iterator-types](http://docs.python.org/py3k/library/stdtypes.html#iterator-types)我们可以阅读有关迭代器类型的信息：

**Python 支持对容器进行迭代的概念。这是使用两种不同的方法实现的；这些用于允许用户定义的类支持迭代。*序列，下面更详细地描述，总是支持迭代方法。***

下面描述的是：序列类型——str、bytes、bytearray、list、tuple、range。

那么，为什么str不支持**next** ()呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T14:11:33.627

字符串没有`__next__`方法，但`str_iterator`对象有。
你必须调用`iter`你的字符串来接收一个可迭代的 ( `str_iterator`) 对象。

```
>>> s = 'spam'
>>> g = iter(s)
>>> g
<str_iterator object at 0xad91d0>
>>> next(g)
's'
>>> next(g)
'p'
>>> next(g)
'a'
>>> next(g)
'm'
>>> next(g)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
StopIteration 
```

重要的是要理解迭代器必须是一个单独的对象，否则您将无法同时为同一个对象拥有多个迭代器：

```
>>> g, h = iter(s), iter(s)
>>> next(h)
's'
>>> list(zip(g, h))
[('s', 'p'), ('p', 'a'), ('a', 'm')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:12:25.270

迭代器类型和容器类型不是一回事。

要获取迭代器对象，您需要调用`__iter__`，如您链接到的文档中所述：

```
'spam'.__iter__().__next__() 
```

或更好

```
next(iter('spam')) 
```

# python - 形式为“string#1”的 Django/Python URL 正则表达式

> ID：12552988
> 
> 赞同：1
> 
> 时间：2012-09-23T14:05:37.557
> 
> 标签：python, regex, django, url, expression

我想在 django 中匹配 URL 字符串“anything#1”。我的正则表达式是这样的：

```
r'^(?P<title>\w+[_]*)?/#(?P<id>\d+)/$' 
```

“#1”部分应该是可选的，所以我把问号放在那里。但是它向我显示了一个错误。我在做什么坏事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:23:24.990

Django 不控制图章（或片段），您可以通过以下方式在视图中获取它[`HttpRequest.get_full_path()`](https://docs.djangoproject.com/en/dev/ref/request-response/)：

仅通过以下方式获取：

```
 >>> request.get_full_path().split('#')[1]
 '1' 
```

# php - Love button not working

> ID：12552989
> 
> 赞同：-1
> 
> 时间：2012-09-23T14:05:51.193
> 
> 标签：php, jquery, html, button

I am trying to create a love it button the button is here www.dreamsynk.com.

I have taken code from different places and pasted them together, but there are things that are wrong i just am not sure what as i don't know PHP or ajax and my jquery is knowledge is minimal.

I have a database and a table called "loveit" with a field called "value".

Here is my code so far:

HTML:

```
<div class="love-it">
    <script type="text/javascript">
    jQuery(function() {
        jQuery('#like-it').click(function() {
        jQuery('#like-it').load('wp-content/themes/dreamsynk/value.php');
        });
    });​
    </script>
    <a href="#" class="btn btn-counter" id="like-it" data-count="0"><span>❤&lt;/span></a>
</div> 
```

script.js

```
jQuery(document).ready(function() {

(function($) {
$('.btn-counter').on('click', function(event, count) {
event.preventDefault();

var $this = $(this),
    count = $this.attr('data-count'),
    active = $this.hasClass('active'),
    multiple = $this.hasClass('multiple-count');

// First method, allows to add custom function
// Use when you want to do an ajax request
if (multiple) {
    $this.attr('data-count', ++count);
    $("#like-it").unbind().bind("click", function() {
        $.ajax({
        type: 'POST',
        url: 'wp-content/themes/dreamsynk/loveit.php',
        data: 'action=add',
        success: function(result) {
        $("#like-it").html(result);
        }
        });
        return false;
    });
} else {
    $this.attr('data-count', active ? --count : ++count).toggleClass('active');
    $("#like-it").unbind().bind("click", function() {
        $.ajax({
        type: 'POST',
        url: 'wp-content/themes/dreamsynk/loveit.php',
        data: 'action=add',
        success: function(result) {
        $("#like-it").html(result);
        }
        });
        return false;
    });
} 
})
})(jQuery); 
```

loveit.php

```
<?php mysql_connect("host", "database", "pass") or die    ("Error.");
mysql_select_db("database") or die ("error");

$increase = "UPDATE loveit SET value=value+1 WHERE id=1;";
$active_rate = mysql_query("SELECT * FROM loveit WHERE id=1;");
$val = 0;

if($rt = mysql_fetch_assoc($active_rate)) {
$val = $rt['value'];
}

if($_POST['action'] == 'add') {
mysql_query($increase);
print $val++;
}

$rat = mysql_query("SELECT * FROM loveit WHERE id=1;");

if($res = mysql_fetch_assoc($rat)) {
print '<a id="likeit'.($res['value']-1).' '; // id="likeit" 
}   
?> 
```

value.php

```
<?php mysql_connect("host", "database", "pass") or die ("Error.");
mysql_select_db("database") or die ("error");

$rat = mysql_query("SELECT * FROM loveit WHERE id=1;");

if($res = mysql_fetch_assoc($rat)) {
    print ($res['value']-1); 
}

?> 
```

And then obviously my stylesheet.

What have I done wrong here?

The button needs to be limited to one click like it is now and if they click it again it unloves me.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:14:53.717

This may not fully answer all your questions, but will indicate some of the things that are wrong.

I assume you copy-pasted the 'love' script from some other site/tutorial. When I open your site in firefug and look at the console, I get this:
![enter image description here](../Images/57de108eedd9fc265cf6b6300090fa04.png)

I copy and pasted the `<script>` bit from my firefox source view into notepad++ and got this:

```
<script type="text/javascript">
jQuery(function() {
    jQuery('#like-it').click(function() {
        jQuery('#like-it').load('wp-content/themes/dreamsynk/value.php');
    });
});?         // <---------- that question mark should not be there!
</script> 
```

Perhaps when you copy-pasted the script you also copied some hidden/bad symbols along with it.

**UPDATE**
Changing character encoding from UTF-8 to Western 8859-1 gets me this:
![enter image description here](../Images/8cd82226ab1ca76ed29d7e4e57dc7301.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T07:15:25.033

呃，我刚刚试了下你页面的脚本，但是好像不能正常工作，只有“倒计时”，没有“倒计时”，也没有控制IP，让一个访问者“爱”你的页面几次，这也很糟糕。

你可以看看这个教程。它可以帮助您：

[http://blog.deepscripts.com/how-to-build-a-like-my-page-script/](http://blog.deepscripts.com/how-to-build-a-like-my-page-script/)

# php - PHP SOAP Client with Special Characters (Encoding)?

> ID：12552990
> 
> 赞同：5
> 
> 时间：2012-09-23T14:06:00.970
> 
> 标签：php, soap, encoding, special-characters, soap-client

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:22:54.427

You can try setting the encoding to `UTF-8`

Example

```
$client = new SoapClient('http://www.example.com/webservice.asmx?WSDL', array('trace' => 1, 'encoding'=>' UTF-8')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:44:22.223

尝试

```
 $result_1 = urldecode($client->GetText());
 $result_2 = urldecode($client->GetText_withSpecialCharacter()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T16:34:59.767

也许你可以试试这个：

```
$myString = $client->GetText_withSpecialCharacter();
$result_2 = urldecode($myString);
if ($myString != urlencode($result_2)) {
  $result_2 = mb_convert_encoding($myString, "UTF-8", mb_detect_encoding($myString,"auto",true));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-15T17:45:33.323

这个问题很老，但有一个解决方案：

```
$result_2 = html_entity_decode($client->GetText_withSpecialCharacter(), ENT_QUOTES | ENT_XML1); 
```

但`&#xE;`似乎不是有效的 UTF-8 字符。`0xE`是移出字符。

# modx - modx - can't change suffix for html

> ID：12552992
> 
> 赞同：0
> 
> 时间：2012-09-23T14:06:14.430
> 
> 标签：modx, modx-revolution

I have just installed the latest modx revo an my server. I also turned on SEO friendly URL. My pages are now /page/subpage.html Wanted to turn off the .html suffix but all the time a change it (no matter what I enter .htm / or empty) it'll show up and after I reload the settings page it changes to .html again.

There is a little red triangle (like in excel) in the upper left corner after I change it. What does that mean?

Flushed the cache several times as well.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T14:18:09.093

I thought modx updates this via AJAX - it looks like that. In the sys settings it works the same way. But I had to save it explicitly. Didn't see the save button at the top :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:26:43.770

这不是系统设置：

系统 -> 内容类型 -> 将 .html 更改为 / 或只是空白。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T14:06:19.923

看起来这是地址并在此处解决：

[http://tracker.modx.com/issues/2279](http://tracker.modx.com/issues/2279)

# java - stringtokenizer 返回错误的标记

> ID：12552995
> 
> 赞同：3
> 
> 时间：2012-09-23T14:06:34.917
> 
> 标签：java, stringtokenizer

我想将给定的字符串“解析”成向量。向量以“[”开头，以“]”结尾。向量的值以及向量本身由“，”分隔。如果我使用整数作为值，我的代码可以正常工作“[1,2,3]，[5,2,3]，[1,6,3]”。但是当我将整数值与双精度值“[1, **2.5** ,3],[5,2,3],[1,6,3]” 混合时，stringtokenizer 返回错误值（在本例中为“1”“2.5”，但随后“ **3]** ”……）

```
String s = "[1,2.5,3],[5,2,3],[1,6,3]";

Vector<Vector<Double>> matrix = new Vector<Vector<Double>>();        
for(int j=0;j<s.length();j++) {
   if (s.charAt(j)=='[') {
      int k=s.indexOf("]");      
      StringTokenizer st = new StringTokenizer(s.substring(j+1, j+k));// j+k-1 does not work either
      Vector<Double> vector = new Vector<Double>();
      while (st.hasMoreTokens()) {
          vector.add(Double.parseDouble(st.nextToken(",")));//Exception in thread     "main" java.lang.NumberFormatException: For input string: "3]"
      }
      matrix.add(vector);
   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-23T14:24:33.957

```
if (s.charAt(j)=='[') {
    int k=s.indexOf("]"); 
```

`]`查找in的第一次出现的索引`s`，从字符串的开头开始。您真正想要的是在**当前向量开始后**找到第一次出现：

```
if (s.charAt(j)=='[') {
    int k = s.indexOf("]", j); 
```

当你有`2`而不是它时它起作用的原因`2.5`是每个向量中的字符数恰好是相同的，所以用第一次出现`]`来计算向量的长度是靠运气的。

请注意，您还必须将`substring`呼叫的结束索引更改为`k`：

```
StringTokenizer st = new StringTokenizer(s.substring(j+1, k)); 
```

作为旁注，`StringTokenizer`不建议使用。在这种情况下，您应该`split()`改用：

```
String[] elements = s.substring(j+1, k).split(",");
Vector<Double> vector = new Vector<Double>();
for (String element : elements) {
    vector.add(Double.parseDouble(element));
}
matrix.add(vector); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T14:36:01.447

矢量和 StringTokenizer ？：） 可爱的！

```
 while(s.contains("[")) {
        String s1 = s.substring(s.indexOf("[")+1, s.indexOf("]"));
        if(s1!=null && s1.isEmpty()!=true && s1.contains(",") ) {
            String[] sArr = s1.split(",");
            for (String string : sArr) {
                Double d = Double.valueOf(string);
                System.out.println(d);
                // put it where you need
            }
        }
        s = s.substring(s.indexOf("]")+1);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T14:25:32.453

StringTokenizer 已弃用，您应该使用字符串`split()`

# c++ - 在 C++ 中模拟 linux/bash shell？

> ID：12552997
> 
> 赞同：1
> 
> 时间：2012-09-23T14:06:44.730
> 
> 标签：c++, linux, bash, shell, terminal

所以我基本上在这里寻找最简单的方法，因此我想要的是一个游戏内 linux-shell（将使用 opengl 和 sfml 呈现），它将模拟/模拟一个 linux 盒子。它不需要那么花哨，我优先考虑的是基础知识（ls、grep、cat、echo..）、某种编辑器（vim/nano-like），以及游戏逻辑可以与 /开发，/等等

我曾考虑过对环境进行 chroot，但我看到的问题多于这样做的解决方案。还考虑过是否有某种流行的用 C++ 编写的 linux 模拟器可以与主机代码紧密集成，这是一个远景，我还没有找到任何东西。

非常感谢任何帮助我走上正确道路的帮助！

PS。最终产品将是跨平台的（至少对于 win/linux 而言）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T14:16:59.240

您可能对[BusyBox](http://www.busybox.net/)感兴趣，它是 Linux 命令行的许多功能的小型且免费的实现。您应该能够将它嵌入到您的游戏中，而不会有太多麻烦。当然，您还必须分别建模文件系统和 tty 接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:33:08.470

这就是我将如何做到的。

我会将目录结构实现为节点树（有点像链表，但是，每个父节点可以有任意数量的子节点）。然后，如果您想运行以下命令（我知道，这些不是 Linux 中的所有命令，但这仍然可以让您对我所说的内容有一个很好的了解），它们的行为应该是这样的：

*   `ls`- 简单查看当前节点并列出所有子节点

*   `ls -R`- 查看当前节点并递归列出所有子节点（参见[维基百科的树遍历页面](http://en.wikipedia.org/wiki/Tree_traversal)）

*   `cd /some/path``/some/path`-根据s 进行拆分`/`，然后尝试将当前工作目录（这可能应该实现为指向节点的指针）更改为用户指定的路径。如果路径是绝对的（即从`/`它在目录结构中的成员资格开始，应该很容易通过尝试从根节点定位它来验证。

这让我想到了另一点。由于您的结构是节点树，因此您*应该*有两种类型的节点：代表文件的节点和代表目录的节点。目录可能有孩子，文件可能没有。此外，文件节点可能有一组关联的数据（可能是一个字符串），这些数据可能是文件的内容（因为您希望能够编辑文件）。

*   `rm somefile`- 如果子节点存在于当前工作目录中，则简单地取消它。

*   `mkdir somedir`- 将一个新的目录节点附加到当前工作中，如果`somedir`不存在的话。

*   `rmdir somedir``somedir`-如果没有子节点，则从当前工作目录中删除一个名为的目录节点。

现在上面只真正讨论了目录结构，我可以继续列出命令以及它们将如何实现，但我认为你已经明白了这一点。因此，我将讨论您列出的其他命令（`grep`、、、、`cat`）。`echo``vim/nano`

*   就实现 grep 而言，使用我上面的结构，制作一个非常原始的实现会相当容易。您只需遍历文件的每一行（在这种情况下，这将是与文件节点关联的数据）并在每一行上进行字符串比较，打印匹配项。如果您允许使用正则表达式，那么我无法帮助您，我建议您查看[c++ 正则表达式库](http://www.cplusplus.com/reference/std/regex/)。但是，**还有另一种选择。** `grep`是开源的，因此您可以使用它的源代码或简单地阅读它并了解它是如何实现的。[Grep 的源代码](http://www.gnu.org/software/grep/)。

*   使用上述树形结构“分类”一个或多个文件将很简单。您只需`cout`按顺序排列与文件节点关联的所有数据。而且，`grep`像猫一样是OSS（开源软件）。

*   `echo`实施起来应该很简单。只需打印回它的论点。至少是一种补救形式的回声（尽管我不确定回声会比这更复杂。

*   至于实现 vim/nano 或类似的东西。我真的帮不了你。我再次倾向于将您引向他们的源代码（[vim](http://www.vim.org/sources.php)，[nano](http://www.nano-editor.org/download.php)）。但是，我意识到这可能不是很有帮助，因为两者都是大型项目。

# c++ - 在 C++ 中拥有大型抽象类好还是不好？

> ID：12552999
> 
> 赞同：0
> 
> 时间：2012-09-23T14:06:50.563
> 
> 标签：c++, performance, visual-c++, design-patterns, bridge

我想知道在 C++ 中创建一个具有多个纯虚方法的抽象类好不好？

例如，在某些情况下，例如实现会话启动协议的对话，我们发现它可以使用桥接模式来实现。但是为通用操作拥有抽象基类会导致拥有一个非常大的抽象类。现在从性能的角度来看，使用和实现此类的效果是什么？

考虑我们有不同的对话框，每个对话框都有自己的实现。（例如：InviteDialog、RegisterDialog、InfoDialog、...）

应用桥模式：

```
class IIDialog{
public:
/*there are multiple pure virtual methodes at least 15*/
virtual int32_t SendResponse(ISipMessage* response) = 0;
protected:
/*there are multiple methods that use pure virtual methods*/
int32_t Send_Response(){retun SendResponse(response);}
}

class IInviteDialog : public IIDialog
{
/*Implemet virtual methods*/
}

class IRegisterationDialog : public IIDialog
{
/*implement virtual methode*/
} 
```

**实现的其他部分被忽略（上述类使用的实际实现和实现抽象）**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T14:12:49.740

对于大多数现代 C++ 编译器，您可以假设构造对象时的性能开销不取决于虚拟方法的数量。

当实际调用这些方法时，我希望开销不会大于任何替代实现方法的开销。

如果这些函数调用执行诸如网络操作之类的“复杂”事情，那么无论如何您都不需要担心这种微优化，这将完全无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:12:29.403

从性能的角度来看，虚拟方法的数量在 C++ 中并不重要（无论方法的数量如何，都需要为间接支付一个小的固定价格）。