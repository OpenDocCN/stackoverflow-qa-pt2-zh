# StackOverflow 问答 12774000-12774999

# c# - 将dijkstra算法实现到windows窗体图表控件中

> ID：12774001
> 
> 赞同：0
> 
> 时间：2012-10-08T00:21:41.070
> 
> 标签：c#, algorithm, windows-forms-designer

我正在尝试实现一个dijkstra的模型来寻找连接图的最短路径。我所拥有的是一个图表，点击按钮后，它会在图表上随机生成节点。

我想做的是以下几点：

1.  判断图是否连通
2.  如果已连接，则选择三种不同方法中的一种来找到最短路径： a. 起点和终点之间距离的最短路径 b. 按边数计算的最短路径 c. 边总权重的最短路径（在这里，我们想要的是更小的权重......）

其他一些注意事项。

因为这些数据点是在这个图表控件中随机生成的，所以我实际上没有 Vertex 类来生成顶点。我一直在四处寻找，发现大多数寻路功能都使用顶点类。所以基本上我的列表将从图表控件之外的节点中填充。

任何人都可以就我如何解决上述两个问题提供任何见解吗？

```
 //TODO:  Change to a function with return bool.  Void for purposes of testing at the moment.
    public void isConnected()
    {

        List<DataPoint> ParentPoints = new List<DataPoint>();

        //Gather all the non data generator into the same point array
        foreach (DataPoint pNonDG in chtGraph.Series[0].Points)
        {
            ParentPoints.Add(pNonDG);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T19:35:48.113

计算科学图与我们在统计或数学中制作的“图表”图不同。计算机科学中的图是通过一系列“边”连接的“节点”的集合

一个节点是通过一条边连接的，但这并不意味着它是连接回来的。一些边可以是单向连接。

边缘通常具有与之相关的“权重”或“成本”。这就是您的 dijkstra 算法将派上用场的地方。它将使用此成本来计算到目标的最短路径。

让我们看看我们可能使用的一些数据类型

```
class GraphNode {
    List<GraphEdge> Edges = new List<GraphEdge>();
    public void AddEdge(GraphEdge edge) {
        Edges.Add(edge);
    }
    //you get the idea, this should have much more
    //it also manages edge connections
}

class GraphEdge { //this is a one way connection
    GraphNode ConnectedTo = null;
    //GraphNode ConnectedFrom = null; //if you uncomment this, it can be a two-way
                                      //connection, but you will need more code to
                                      //manage it
    float Cost = 0f;
    //you might consider adding a destructor that clears the pointers
    //otherwise gc might have a hard time getting rid of the nodes
}

class Graph {
    List<GraphNodes> Nodes = new List<GraphNodes>();
    //this class manages the nodes
    //it also provides help for connecting nodes
} 
```

# ios - 在我的个人设备上测试我的 iPhone 应用程序的问题

> ID：12774003
> 
> 赞同：0
> 
> 时间：2012-10-08T00:21:57.277
> 
> 标签：ios, xcode, ios6

我刚刚在 Xcode 4.3.2 中构建了我的第一个应用程序。我想在当前运行 iOS 6.0 的 iPhone 上对其进行测试。Xcode 中的 Organizer 窗口告诉我这是不匹配的情况。我已经阅读了关于此类错误消息的大量评论，但似乎唯一的解决方案是在 Xcode 4.5 上运行我的应用程序。这真的是我可以在 iPhone 上测试应用程序的唯一方法吗？正如我所说，我是 iOS 和 Xcode 的新手，我有点犹豫是否要在新版本中打开我的应用程序。谁能帮忙！？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T00:28:52.967

您需要 Xcode 4.5 才能在任何运行 iOS 6.0 的设备上运行您的应用程序。Xcode 与使用旧版本 Xcode 创建的项目高度向后兼容。升级是您唯一的选择，这样做不会导致任何问题。

# asp.net-mvc - 视图中的可重用模型格式

> ID：12774005
> 
> 赞同：1
> 
> 时间：2012-10-08T00:22:31.600
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, formatting

如何以任何我想要的方式格式化视图内的模型表示？能够实现我可以重用的自定义格式化程序。

例如 - 我有一个`Model.Name`值为“david kim”的值，我想将第一个字母大写。因此，它不会显示实际名称 - “ **david kim** ”，而是显示“ **David Kim** ”。

更多示例：

从字符串中删除数字：**helloworld123 -> helloworld**。

将文本转换为 leet 语音：**Hello world -> H3110 w0r1d**。

通过使用像这样简单的东西：

```
// Here I use the Capital Letter custom formatter.
@Html.DisplayFormatFor(model => model.Address, new CapitalLetterFormatter()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T00:22:31.600

这是我将模型格式化为优雅的可重用代码的实现。

有一个`HtmlStringFormatter.Create()`允许您传递委托并制作自己的匿名格式化程序。

**代码示例：**

```
// This just upper case all the letters.
@Html.DisplayFormatFor(model => model.Address, HtmlStringFormatter.Create(s=> s.ToUpper())) 
```

如果您要创建自定义格式化程序，请从其派生属性派生`HtmlStringFormatter`并将其设置为您想要执行的任何操作。

**代码示例：**

```
// Here I use the Capital Letter custom formatter.
@Html.DisplayFormatFor(model => model.Address, new CapitalLetterFormatter()) 
```

**所有课程：**

```
namespace MvcPlay.HelperExtensions
{
    public static class HelperExtensions
    {
        public static MvcHtmlString DisplayFormatFor<TModel, TValue>(this HtmlHelper<TModel> helper, Expression<Func<TModel, TValue>> expression, HtmlStringFormatter formatter)
        {
            var output = helper.DisplayFor(expression);
            string formatted = formatter.Delegate.Invoke(output.ToString());
            return MvcHtmlString.Create(formatted);
        }
    }
}

namespace MvcPlay.HtmlStringFormatting
{
    public class HtmlStringFormatter
    {
        public delegate string FormatDelegate(string s);

        public FormatDelegate Delegate;
        public Expression<FormatDelegate> formatExpression;

        private HtmlStringFormatter(FormatDelegate expression)
        {
            Delegate = expression;
        }

        protected HtmlStringFormatter()
        {

        }

        public static HtmlStringFormatter Create(FormatDelegate expression)
        {
            return new HtmlStringFormatter(expression);
        }
    }

    public class CapitalLetterFormatter : HtmlStringFormatter
    {
        public CapitalLetterFormatter()
        {
            Delegate =
                s => new CultureInfo("en-US", false).TextInfo.ToTitleCase(s).ToString(CultureInfo.InvariantCulture);

        }
    }
} 
```

不要忘记将以下行添加到 Web.Config 的 Views 文件夹中：

```
<add namespace="MvcPlay.HelperExtensions" />
<add namespace="MvcPlay.HtmlStringFormatting"/> 
```

这将自动包含格式化程序和帮助程序扩展，因此您无需将其包含在要使用它的每个视图中。

# java - Java中遗传算法的轮盘选择

> ID：12774014
> 
> 赞同：0
> 
> 时间：2012-10-08T00:24:11.550
> 
> 标签：java, genetic-algorithm, genetic-programming, roulette-wheel-selection

我正在为遗传算法实施轮盘赌选择方法。从本质上讲，我的问题非常简单，但我无法完全理解它。在我的适应度函数中，如果答案非常错误，它可能会返回 -3000% 左右。我的问题是，当我尝试为我的结果分配概率时，它们会倾向于错误的答案。

例如：如果我的百分比在一个数组中并且是 [92, 68, 5, -4, -3546]（从高到低），我需要让较低索引中的数字比数字更有可能被选中具有更高的指数。

忽略我的适应度函数，如何在考虑大负数的情况下基于此创建概率？

我在另一个问题中发现的一些基本代码：

```
public Individual rouletteWheelSelection() { 
    double randNum = m_rand.nextDouble() * this.totalFitness; 
    int idx; 
    for (idx=0; idx<POP_SIZE && randNum>0; ++idx) { 
        randNum -= m_population[idx].getFitnessValue(); 
    } 
    return m_population[idx-1]; 
} 
```

（此处的原始链接：[用 Java 编写的 GA](https://stackoverflow.com/questions/1575061/ga-written-in-java)）

我让我的 GA 使用不同的选择方法，但现在我正在尝试修改这个方法来代替它。任何帮助将不胜感激。

***编辑

以下代码是我修改过的 rouletteWheelSelection：

```
private Chromosome rouletteWheelSelection(){
    double randNum = Math.abs(rand_num.nextDouble() * totalFitness);
    int idx;
    for (idx=0;idx<NUM_CHROMOSOMES && randNum>0;++idx){
        randNum -= Math.abs(population[idx].getFitness());
    }
    return population[NUM_CHROMOSOMES-idx];
} 
```

这是我的健身功能：

```
public double getFitness()
{
    String working = bitString;
    int x1 = Integer.parseInt(working.substring(0,6),2);
    int x2 = Integer.parseInt(working.substring(6),2);
    double result = ScratchGA.functionTest(x1,x2);
    double percentAccuracy = (1- Math.abs(((ScratchGA.getDesired() - result)/ScratchGA.getDesired())))*100;
    if (percentAccuracy <= 100)
    {
    return percentAccuracy;
    }
    else
    {
    return -percentAccuracy;
    }
} 
```

当时的想法是，一个值与我需要的值相差超过 100%，我把它推到排序列表的末尾是负面的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:09:54.617

问题中显示的选择方法隐含地仅适用于正或空适应度值。

对于负值，关于计算 totalFitness 的第一个问题是：这是适应值的代数和还是应该与它的绝对值一起工作。

当 randNum [应该] 减少但不知何故负适应度值导致 RandNum 重新增长时，会出现更严重的问题。

一个建议是改变适应度函数，使其只返回正值。

一个简单的方法是这样的：

```
if (fitValue >= -5000)
  fitValue += 5000;
else
  fitvalue = 0; 
```

其中 -5000 被任意选择为您认为有意义的最负值。实际上，这为最不合理的解决方案提供了一种截断选择形式，这是您试图通过轮盘赌避免的事情，但显然当前的适应度函数似乎严重偏向范围的负侧（或者甚至可能在消极的一面）。

 **通过与 Abs 合作，根据添加的相关片段和您的评论有效地进行**编辑。**values*你的*版本`rouletteWheelSelection()`会处理我最初回复中列出的“更严重”的问题。
然而`getFitness()`，正如所怀疑的那样，该功能非常偏向于负值。它的操作范围是[some_potentially_very_negative_value, +100]。
看代码：返回的最大值是+100，但是当值与值`ScratchGA.functionTest(x1,x2)`相差很大时，有可能返回很大的负值`ScratchGA.getDesired()`。
似乎需要对排序进行某种标准化，以防止负回报远大于 100（绝对值）。

这个顺便说一句，**很好地解释了为什么*有了这样的适应度函数*，轮盘赌WheelSelection() 有利于表现不佳的染色体**。

例如，假设您有 5 条染色体，其适应度值分别为 80、70、30、20 和 -250。总和为 450，所有四个具有正适应度的染色体为 200，而具有负适应度的一个染色体为 250。在这个例子中，有比什至机会挑选更差的染色体！
轮盘选择背后的想法是提供*可能性*选择小于最佳适应度的染色体，但选择任何染色体的概率应与染色体对适应度值总和的贡献量成正比。您的实现有效地做到了这一点，但问题是对负适应度总和的贡献似乎与正适应度值提供的不成比例。**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T05:58:38.193

您可以使用窗口化，因为您总是添加或减去最差适应度的人群。这样选择的范围从 0 扩展到正值。最差的个人将永远没有机会被选中（类似于锦标赛选择）。因为如果您不将您的值视窗化，那么适合度为 98 的个体将具有与具有 95 和 96 的个体几乎相同的选择压力。只要您的群体包括较低质量的解决方案，那很好，但是当所有解决方案都在 90 年代时选择压力将显着降低。随着您的人口收敛到最佳解决方案，您将越来越像随机搜索。如果您考虑人口中越来越精细的细节（差异），您只能进行定向探索。**

# c++ - 代码崩溃数据结构操作

> ID：12774015
> 
> 赞同：0
> 
> 时间：2012-10-08T00:24:55.017
> 
> 标签：c++, memory-management, data-structures

在下面的代码中，对于每个 Node 都包含一个指向所有子节点（Node 类型）的指针的指针

在崩溃的行中，我将内存分配给 child_array 并返回类型为 node * 的指针。

现在在我的实际节点中，我将 child_array ptr-to-ptr 的值设置为

有人可以解释为什么这会崩溃。从数学上讲，等式的两边都是（节点*）。

我可以猜到的一件事是，当我取消引用 child_array 一次以分配节点 * 时，取消引用的值可能指向垃圾而不初始化。在那种情况下，我如何以及何时安全地初始化它？

```
#include "stdafx.h"
#include <iostream>

using namespace std;

struct node
{
    int val;
    int num_child;
    node** child_array;
};

node *head = NULL;

node* addelement(int parent_id)
{
    cout << " You are the child of " << parent_id << endl;

    int val, child_count;
    cout << "Enter value of element" << endl;
    cin >> val;

    cout << "Enter no of children" << endl;
    cin >> child_count;

    node* new_node = new node;
    if(new_node)
    {
        new_node->num_child = child_count;
        new_node->val = val;
        node *child_head = (node *)new node[child_count]; 
```

**下面的冲线**

```
 *(new_node->child_array) = child_head; 
    }
    else
    {
        //assert(false);
    }

    for( int i=0; i<child_count; i++)
    {
        new_node->child_array[i] = addelement(val);
    }

    return new_node;
}

void printTree(node *head)
{
    if(head!=NULL)
    {
        cout << head->val << endl;
        for( int i=0; i<head->num_child;i++)
        {
            printTree(head->child_array[i]);
        }
    }
}

int _tmain(int argc, _TCHAR* argv[])
{
    head = addelement(0);
    printTree(head);
    cout << endl;
    cout << " Tree Elements\n";
    printTree(head);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T00:34:43.170

You dereference an uninitialized pointer and write to unallocated memory:

```
*(new_node->child_array) = ... 
```

There is also a conceptual problem. Are you trying to create an array of `node`, or an array of `node*`?

# ruby - 如何将时间字符串解析为特定时区？

> ID：12774018
> 
> 赞同：5
> 
> 时间：2012-10-08T00:25:36.323
> 
> 标签：ruby, time, timezone

我有这个字符串：

> 10 月 7 日星期日下午 4:00

当我使用`Time.parse`时，Ruby 假定时区是 UTC。我如何告诉 Ruby 给我 -0700 时区？我试过使用

```
tz.utc_to_local(Time.parse(string)) 
```

但我仍然得到 UTC +0000 时区。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:03:46.933

**“在解析时间信息时，不要在未指定时区的情况下进行解析，这一点很重要。”**

这条建议的精华来自这篇有用的博文：[Working with time zone in Ruby on Rails](http://www.elabs.se/blog/36-working-with-time-zones-in-ruby-on-rails)。

无论您是否使用 Rails，时间字符串总是附加一个时区。在您的情况下，您假设时间字符串具有 -0700 偏移量，但没有将时区信息传递给 parse 方法（假设它是 UTC）。

```
> Rails.application.config.time_zone
=> "Mountain Time (US & Canada)" 
```

这是因为我有以下配置：

```
config.time_zone = 'Mountain Time (US & Canada)'

> string = "Sunday, Oct 7 4:00pm"
=> "Sunday, Oct 7 4:00pm"
> Time.parse(string)
=> 2012-10-07 16:00:00 -0600
> Time.parse(string).zone
=> "MDT" 
```

在纯红宝石中也以同样的方式工作：

```
> require 'time'
=> true
> Time.local( 2012, 10, 07 )
=> 2012-10-07 00:00:00 -0600
> Time.local( 2012, 10, 07 ).zone
=> "MDT" 
> string = "Sunday, Oct 7 4:00pm"
=> "Sunday, Oct 7 4:00pm"
> Time.parse(string)
=> 2012-10-07 16:00:00 -0600
> Time.parse(string).zone
=> "MDT" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:30:45.397

确保您的时区设置正确

```
config.time_zone = 'Eastern Time (US & Canada)' 
```

Time.parse 应该默认为当前时区，但您也可以尝试

```
Time.parse('####').in_time_zone 
```

# guice - Guice：如何绑定已绑定对象动态获取的类？

> ID：12774020
> 
> 赞同：5
> 
> 时间：2012-10-08T00:25:54.083
> 
> 标签：guice, guice-servlet

我正在使用 Guice 开发一个小型 Web 框架。我有一个*Router*对象，一旦初始化，就会公开一个*getControllerClasses()*方法。我必须遍历所有这些动态返回的类以使用 Guice 绑定（）它们。

我绑定路由器：

```
bind(IRouter.class).to(Router.class); 
```

但是，我怎样才能在一个模块中获得绑定的路由器实例，所以我也可以绑定它的*getControllerClasses()*方法返回的类？

我能够在模块中获取路由器实例的唯一方法是将此实例绑定到第一个模块中，然后将其注入第二个模块中，在 setter 上使用 @Inject ：

**模块 1**

```
bind(IRouter.class).to(Router.class);

Module2 module2 = Module2();
requestInjection(module2);
install(module2); 
```

**模块 2**

```
@Inject
public void setRouter(IRouter router)
{
    Set<Class<?>> controllerClasses = router.getControllerClasses();
    for(Class<?> controllerClass : controllerClasses)
    {
        bind(controllerClass);
    }
} 
```

方法被调用，Router 实例初始化良好，但是控制器类的绑定失败！*在 Guice 生命周期的这一步，module2 的binder*实例似乎为 NULL。

如何绑定动态获取的类，这些类已由已绑定的对象返回？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-08T01:17:48.887

此时 Binder 为空，因为 Guice 在调用 configure() 之前设置了 binder。在 Guice 调用模块的 configure() 方法之外，没有活页夹。请记住，a`Module`只是一个配置文件，它配置了`Injector`您创建文件时的行为方式。

`requestInjection`它的行为不像你想象的那样——也就是说，它不会立即绑定你传入的实例的字段。相反，你告诉它在有人创建`Injector`. 在创建 Injector 之前，不会将任何内容注入到传递的实例中。

如果您的路由器没有需要 Guice 的依赖项，则只需创建一个`new Router()`并将其作为构造函数参数传递给您的模块。然后你可以遍历你的控制类并绑定它们，还有`bind(Router.class).toInstance(myRouter);`.

但是，如果您的 Router 确实依赖于其他模块，那么您可以使用[子 Injector](http://google-guice.googlecode.com/git/javadoc/com/google/inject/Injector.html#createChildInjector%28com.google.inject.Module...%29)。首先，创建一个 Injector，从中获取一个 Router 实例，然后将该 Router 实例传递给绑定其控制类的另一个 Module。突然之间，您将拥有一个模块（我们称之为 controlClassesModule），您可以执行以下操作：

```
newInjector = originalInjector.createChildInjector(controllingClassesModule); 
```

然后，您`newInjector`将从您的绑定`originalInjector`以及路由器指定的所有控制类继承绑定。

希望有帮助！

# java - Combinations using memoization in java

> ID：12774025
> 
> 赞同：1
> 
> 时间：2012-10-08T00:27:08.943
> 
> 标签：java, recursion, combinations, memoization

I'm making a program that calculates a combination given two numbers, ex:

```
java Combination 5 3 
```

would give an answer of 10.

I have a method that looks like this:

```
public static int choose(int n, int k) {   // chooses k elements out of n total
  if (n == 0 && k > 0)
      return 0;
  else if (k == 0 && n >= 0)
      return 1;
  else return choose(n - 1, k - 1) + choose(n - 1, k); 
```

How would I be able to use memoization for this in order to make it calculate faster with larger numbers?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T00:40:18.263

使用更有效的公式可能会更好：[http ://en.wikipedia.org/wiki/Binomial_coefficient#Multiplicative_formula](http://en.wikipedia.org/wiki/Binomial_coefficient#Multiplicative_formula)

如果你想使用这个公式，那么这是一种记忆的方法（没有我可能有的拼写错误）：

```
private static Map<Pair<Integer, Integer>, Long> cache = new HashMap<>(); // you'll need to implement pair

public static int choose(int n, int k) {
... // the base cases are the same as above.
} else if (cache.contains(new Pair<>(n, k)) {
    return cache.get(new Pair<>(n, k));
} else {
    Long a = cache.get(new Pair<>(n - 1, k - 1));
    if (a == null) { a = choose(n - 1, k - 1); }
    Long b = cache.get(new Pair<>(n - 1, k));
    if (b == null) { b = choose(n - 1, k); }

    cache.put(new Pair<>(n, k), a + b);
    return a + b;
} 
```

# c++ - 包裹在 lambdas 中的 lambdas 的效率是多少？

> ID：12774026
> 
> 赞同：0
> 
> 时间：2012-10-08T00:27:14.067
> 
> 标签：c++, c++11

假设我正在遍历目录并且我有一堆过滤器

1.  如果文件匹配这个字符串
2.  如果目录与该字符串匹配
3.  排除这些文件扩展名
4.  如果您曾经点击目录 X，请排除
5.  ETC

每个文件有多个选项可以在此处检查，并在功能上将它们用作过滤器。我可以将每个打开的选项转换为 lambda，然后应用 lambda 列表来查看我是否包含或排除某个文件。我还可以将 lambda 封装成彼此，最终得到一个返回 true 或 false 的 lambda。我已经多次遇到这种模式的可能性，但我不知道正确的答案是什么。为方便起见，我通常选择制作一个 lambda 列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T22:16:40.003

它们应该与执行相同工作的手写函数对象一样高效，但输入更少。编译器不需要任何非常神奇的东西来实现 lambda，它们只需实现一个具有`operator()`定义的唯一命名的类，并为任何捕获的变量声明数据成员。

# python - 当前的 Python Beanstalkc 客户端实现是非阻塞的吗？

> ID：12774029
> 
> 赞同：1
> 
> 时间：2012-10-08T00:27:57.183
> 
> 标签：python, api, sockets, twisted, beanstalkd

我正在使用需要延迟写入 beanstalkd 的扭曲框架编写套接字 API，当前的 Python Beanstalkc 客户端实现是非阻塞的吗？

我已经在 Stackoverflow 上广泛搜索了有关此问题的答案，但没有运气，任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T11:24:12.497

当前可用的 beanstalkc v0.3.0 使用阻塞套接字 I/O 操作。

# c# - WCF - How do I return a success or failure message using Message Contracts

> ID：12774030
> 
> 赞同：1
> 
> 时间：2012-10-08T00:28:11.127
> 
> 标签：c#, xml, wcf, soap, messagecontract

Im using SOAP/XML with MessageContracts and **have to return a specified format** similar to the following:

If validation is successful:

```
<env:Envelope>
    <env:Body>
        <Success xmlns="http://tempuri.org"></Success>
    </env:Body>
</env:Envelope> 
```

If it is unsuccessful:

```
<env:Envelope>
    <env:Body>
        <Failure xmlns="http://tempuri.org"></Failure>
    </env:Body>
</env:Envelope> 
```

Take for instance, the following method. It returns a type of MyResponse. So how can I define MyResponse to return a Success or Failure XML Element?

```
public MyResponse SaveMessage(MyRequest request) 
{            
     return new MyResponse();            
} 
```

I can return a success message just fine, like this. It's unwrapped and has an XML element of Success. But I need to also be able to return an XML element of Failure and I can't do that using the same MyResponse type.

```
[MessageContract(IsWrapped=false)]
public class MyResponse
{
    [MessageBodyMember(Namespace = "http://tempuri.org")]
    public Success Success { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:10:11.173

我最终使用了无类型的消息并返回了如下消息（类似失败）：

```
MemoryStream stream = new MemoryStream(Encoding.ASCII.GetBytes("<Success xmlns=\"http://tempuri.org\"></Success>"));

XmlDictionaryReader xdr = XmlDictionaryReader.CreateTextReader(stream,new XmlDictionaryReaderQuotas());

return Message.CreateMessage(MessageVersion.Soap11, "xxx/xxx/xxxResponse", xdr); 
```

# c - pow 应该能够处理这样的事情：为什么我的代码此时会冻结？

> ID：12774031
> 
> 赞同：0
> 
> 时间：2012-10-08T00:28:27.640
> 
> 标签：c, double, pow

所以，我的代码不能超出这一行：

```
double correction = ((double) (1/(1 + pow(2, ((double) ((popsize - maxpop)/maxpop)))))) + 0.5; 
```

`popsize`is an`int`和`maxpop`is a`long int`由用户定义，并分别限制在 1 和 10,000 和 1 和 500,000 之间的值（尽管我将来可能会对 设置更高的限制`maxpop`，这就是它`long int`提前设置的原因）。我意识到其中大部分`double`都是多余的，但我想保持确定。代码在没有任何警告的情况下编译，但是一旦它真正开始*运行*它，它就会挂起。我尝试在声明后直接打印出来`correction`，但由于卡在该行上，所以甚至没有运行。另外，别担心，我没有忘记包含`math.h`（尽管我一开始就这样做了，并且遇到了同样的问题，还有一个额外的隐式声明错误）。怎么了？

编辑：这是我所有的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <math.h>

long double randomDouble() {
    long double r = (long double)rand()/(long double)RAND_MAX;
    return r;
}

int tryBernoulli(long double p) {
    if ((long double)rand()/(long double)RAND_MAX < p) {
        return 1;
    } else
        return 0;
}

int tryRademacher() {
    if (rand() % 2) {
        return 1;
    }
    return -1;
}

int calculateSeries(int arg) {
    int sum = 0;
    for (int i = 0; i <= arg; i++) {
        sum = sum + i;
    }
    return sum;
}

int main() {
    long double allp [1001] [33];
    long double p [33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int allalsum [33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int alsum [33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int nalsum [33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    long double selection [33] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int allgenotypes [467];
    for (int i = 0; i <= 465; i++) {
        allgenotypes[i] = 0;
    }
    int genotypes [467];
    for (int i = 0; i <= 465; i++) {
        genotypes[i] = 0;
    }
    int a,b; // The two alleles generated during generation for a single organism.
    int temp; // A temporary variable to store numbers in.
    long double randdbl = 0; // The number that randomDouble generates.
    int randint = 0; // A random integer (for safekeeping).
    int alnum = 2;
    int popsize = 1;
    int npopsize = 0;
    long int maxpop = 0;
    int gens = 1;
    long double fsum = 0; // For keeping track of what part of the probability distro you're in.
    int isum = 0; // For keeping track of what part of the gene pool you're in.
    int input = 0;
    long double finput = 0;
    long int linput = 0;
    printf("Hello! Welcome to Mike's Glorious Evolutionary Modeler. This models the genetic drift of a single gene in a population of arbitrary size. For a sufficiently large population, you should get no drift at all! To start, specify the starting population size (from 1 to 10,000, no commas please):\n");
    scanf("%d",&input);
    if (input < 1 || input > 10000) {
        while (input < 1 || input > 10000) {
            printf("That was outside of the limits (1 to 10,000)! Try again:\n");
            scanf("%d",&input);
        }
    }
    popsize = input;
    printf("\nAnd give the environmental population cap (between 1 and 500,000):\n");
    scanf("%ld",&linput);
    if (input < 1 || linput > 500000) {
        while (input < 1 || linput > 500000) {
            printf("That was outside of the limits (1 to 500,000)! Try again:\n");
            scanf("%ld",&linput);
        }
    }
    maxpop = linput;
    printf("\nNext, tell me how many alleles you would like (between 2 and 32):\n");
    scanf("%d", &input);
    if (input < 2 || input > 32) {
        while (input < 2 || input > 32) {
            printf("That was outside of the limits (2 to 32)! Try again:\n");
            scanf("%d",&input);
        }
    }
    alnum = input;
    printf("\nTime to specify the probabilities of all of the alleles (except the last one)! Specify each, up to four decimal places. They have to add up to 1\. ");
    for (int i = 1; i <= (alnum-1); i++) {
        printf("Please enter the probability of Allele %d, denoted A%d (between 0 and %Lf, inclusive):\n", i, i, (1-fsum));
        scanf("%Lf",&finput);
        if (fsum + finput > 1) {
            while (fsum + finput > 1) {
                printf("That put the sum over 1! Try again:\n");
                scanf("%Lf",&finput);
            }
        }
        p[i-1] = finput;
        fsum = fsum + finput;
        printf("Now please enter the selection coefficient for Allele %d. If you want the population growth to remain at 0, set it to 1\. In order to maintain a reasonable growth rate, this coefficient may be no more than 1.1.\n", i);
        scanf("%Lf",&finput);
        if (finput < 0 || finput > 1.1) {
            while (finput < 0 || finput > 1.1) {
                printf("Nice try. It should be between 0 and 1.1.\n");
                scanf("%Lf",&finput);
            }
        }
        selection[i-1] = finput;
    }
    fsum = 0;
    for (int i = 1; i <= (alnum-1); i++) {
        fsum = fsum + p[i-1];
    }
    p[alnum-1] = 1 - fsum;
    printf("Okay, the probability for A%d will be %Lf. What should its selection coefficient be?\n",alnum,p[alnum-1]);
    scanf("%Lf",&finput);
    if (finput <= 0 || finput > 1.1) {
        while (finput <= 0 || finput > 1.1) {
            printf("Nice try. It should be between 0 and 1.1.\n");
            scanf("%Lf",&finput);
        }
    }
    selection[alnum-1] = finput;
    printf("\nOkay! Enter the amount of generations that the calculations should be done for (between 1 and 1,000):\n");
    scanf("%d",&input);
    if (input < 1 || input > 1000) {
        while (input < 1 || input > 1000) {
            printf("That was outside of the limits (1 to 1,000)! Try again:\n");
            scanf("%d",&input);
        }
    }
    gens = input;
    printf("Okay! Ready to go. Give me a moment...\n\n");
    srand((unsigned int) time(NULL)); // Seed the generator. Only do this once!
    for (int j = 0; j <= popsize-1; j++) { // This part generates and files the alleles and genotypes of the first generation.
        randdbl = randomDouble();
        fsum = 0;
        for (int k = 0; k <= alnum-1; k++) {
            if (randdbl > fsum && randdbl < fsum + p[k]) {
                a = k+1;
                break;
            }
            fsum = fsum + p[k];
        }
        randdbl = randomDouble();
        fsum = 0;
        for (int k = 0; k <= alnum-1; k++) {
            if (randdbl > fsum && randdbl < fsum + p[k]) {
                b = k+1;
                break;
            }
            fsum = fsum + p[k];
        }
        if (a > b) {
            temp = a;
            a = b;
            b = temp;
        }
        allalsum[a-1]++;
        allalsum[b-1]++;
        alsum[a-1]++;
        alsum[b-1]++;
        if (b == a) {
            if (b == 1) {
                genotypes[0]++;
            } else {
                genotypes[calculateSeries(b)-b]++;
                allgenotypes[calculateSeries(b)-b]++;
            }
        } else {
            genotypes[calculateSeries(b-1)+a]++;
            allgenotypes[calculateSeries(b-1)+a]++;
        }
    }
    printf("\nStatistics for Generation 1:\n Population: %d\n Number of Genotype:\n", popsize);
    int index = 0;
    for (int i = 0; i <= alnum-1; i++) {
        printf("  A%dA%d: %d\n",(i+1),(i+1),genotypes[index]);
        index++;
        for (int j = 1; j <= i; j++) {
            printf("  A%dA%d: %d\n",j,(i+1),genotypes[index]);
            index++;
        }
    }
    printf("\n Number of Allele:\n");
    for (int i = 0; i <= alnum-1; i++) {
        printf("  A%d: %d\n",(i+1),alsum[i]);
    }
    printf("\n Percent Allele Composition:\n");
    for (int i = 0; i <= alnum-1; i++) {
        allp [gens] [i] = p[i]; // Store old probability values in array
        p[i] = ((long double) alsum[i])/((long double) (2*popsize)); // Generate new ones from current generation
        printf("  A%d: %Lf%%\n",(i+1),(p[i]*100));
    }
    // Clean up:
    for (int j = 0; j <= 465; j++) {
        genotypes[j] = 0;
    }
    /********************************************************************************************************
     ************************************************IMPORTANT***********************************************
     ********************************************************************************************************/
    for (int i = 2; i <= gens; i++) { // This part calculates the values for all the rest of the generations.
        double correction = ((double) (1/(1 + pow(2, ((double) ((popsize - maxpop)/maxpop)))))) + 0.5; // The logistic function that curves the population growth with respect to the population cap.
        for (int j = 0; j <= (alnum-1); j++) {
            for (int k = 0; k <= alsum[j]; k++) {
                while (tryBernoulli(((0.5+correction)*selection[j]))) {
                    nalsum[j]++;
                }
            }
        }
        popsize = 0;
        for (int j = 0; j <= (alnum-1); j++) {
            popsize = popsize+nalsum[j];
        }
        if ((popsize % 2) == 1) {
            popsize--;
            nalsum[rand()%alnum]--;
        }
        for (int j = 0; j <= (alnum-1); j++) {
            alsum[j] = nalsum[j];
            allalsum[j] = allalsum[j] + nalsum[j];
        }
        if (popsize == 0) {
            printf("\nOops! Your population has died out!");
            break;
        }
        npopsize = popsize/2;
        while (npopsize != 0) {
            isum = alsum[0];
            randint = rand()%popsize;
            for (int j = 0; j <= (alnum-1); j++) {
                if (nalsum[j] > 0) {
                    if (randint <= isum) {
                        a = j + 1;
                        nalsum[j]--;
                        break;
                    }
                }
                isum = isum + alsum [j+1];
            }
            isum = alsum[0];
            randint = rand()%popsize;
            for (int j = 0; j <= (alnum-1); j++) {
                if (nalsum[j] > 0) {
                    if (randint <= isum) {
                        b = j + 1;
                        nalsum[j]--;
                        break;
                    }
                }
                isum = isum + alsum [j+1];
            }
            if (b == a) {
                if (b == 1) {
                    genotypes[0]++;
                } else {
                    genotypes[calculateSeries(b)-b]++;
                    allgenotypes[calculateSeries(b)-b]++;
                }
            } else {
                genotypes[calculateSeries(b-1)+a]++;
                allgenotypes[calculateSeries(b-1)+a]++;
            }
            npopsize--;
        }
        popsize = popsize/2;
        printf("\nStatistics for Generation %d:\n Population: %d\n Number of Genotype:\n",i,popsize);
        int index = 0;
        for (int j = 0; j <= alnum-1; j++) {
            printf("  A%dA%d: %d\n",(j+1),(j+1),genotypes[index]);
            index++;
            for (int k = 1; k <= j; k++) {
                printf("  A%dA%d: %d\n",k,(j+1),genotypes[index]);
                index++;
            }
        }
        printf("\n Number of Allele:\n");
        for (int j = 0; j <= alnum-1; j++) {
            printf("  A%d: %d\n",(j+1),alsum[j]);
        }
        printf("\n Percent Allele Composition:\n");
        for (int j = 0; j <= alnum-1; j++) {
            /*allp [gens] [j] = p[j]; // Store old probability values in array */
            p[j] = ((long double) alsum[j])/((long double) (2*popsize)); // Generate new ones from current generation
            printf("  A%d: %Lf%%\n",(j+1),(p[j]*100));
        }
        // Clean up:
        for (int j = 0; j <= 465; j++) {
            genotypes[j] = 0;
        }
        for (int j = 0; j <= 31; j++) {
            nalsum[j] = 0;
        }
    }
    /*printf("\nGraph of Total Amounts of Each Genotype (one # represents 10):\n");
    int index = 0;
    for (int i = 0; i <= alnum-1; i++) {
        printf("  A%dA%d: ",(i+1),(i+1));
        for (int j = 0; j < (allgenotypes[index]/10); j++) {
            printf("#");
        }
        printf("\n");
        index++;
        for (int j = 1; j <= i; j++) {
            printf("  A%dA%d: ",j,(i+1));
            for (int k = 0; k <= (allgenotypes[index]/10); k++) {
                printf("#");
            }
            printf("\n");
            index++;
        }
    }*/
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T00:41:09.417

这会立即执行：

```
#include <stdio.h>
#include <math.h>

int
main (int argc, char *argv[])
{

  double popsize = 50;
  double maxpop = 100;
  double correction =
    ((double)(1/(1 + pow(2, ((double) ((popsize - maxpop)/maxpop)))))) + 0.5;
  printf ("correction= %f\n", correction);
  return 0;
} 
```

我编译并链接如下（CentOS Linux 5.5，GCC 4.1.2）：

`gcc -Wall -pedantic tmp.c -o tmp -lm`

这是时代（眨眼）：

```
 time ./tmp
correction= 1.085786

real    0m0.002s
user    0m0.000s
sys     0m0.001s 
```

问：你的操作系统和编译器是什么？

问：您需要在您的平台上显式链接数学库（“-lm”）吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T00:44:42.420

表达方式：

```
((popsize - maxpop)/maxpop) 
```

`maxpop`每当大于时将为零`popsize`。如果您对分数幂感兴趣，则需要尽快转换为双倍。

但是，零值不应导致冻结。你包括了`<math.h>`吗？（是的：你在问题中说了很多。）~~如果不是，那么你有更多的问题；第一个参数应该是一个明确的双精度。~~

你可以明智地写：

```
double correction = 1.0 / (1.0 + pow(2.0, ((double)popsize - maxpop)/maxpop)) + 0.5; 
```

这更具可读性，因为括号和演员表更少。

您是否尝试过在冻结时打印各种值？如果您不确定为什么会出现问题，首先要做的事情之一就是确保您知道您正在使用哪些价值观。

# javascript - Node.js 中的长循环：使用计时器产生？

> ID：12774035
> 
> 赞同：9
> 
> 时间：2012-10-08T00:29:22.263
> 
> 标签：javascript, node.js, performance

我正在使用[Node.js](http://nodejs.org/)来循环浏览*最终可能*是**大量**帖子的内容。

*如果我使用客户端 JavaScript*做类似的事情，我会使用[这里解释](http://oreilly.com/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html#yielding_using_timers)的计时器，以免阻塞线程。

我的问题是：“仍然是一个健全的实践服务器端？” 或“我应该以不同的方式解决问题吗？”

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-08T00:34:41.993

在 node.js 中执行此操作的正确方法是将您的工作分解为块，并[`process.nextTick`](http://nodejs.org/api/process.html#process_process_nexttick_callback)在当前块完成后用于将下一个块排队。这样，您就可以在每个工作块之间执行其他排队的回调。

**更新**：从 Node.js 0.10 开始，[`setImmediate`](http://nodejs.org/api/all.html#all_setimmediate_callback_arg)通常应该使用而不是`process.nextTick`用于此目的，因为`setImmediate`会产生事件循环以确保 I/O 不会被饿死，但`process.nextTick`不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T00:54:24.177

JohnnyHK 的建议是有效的。当任务可以稍后完成时（即：添加到队列中），我会考虑网络工作者。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-08T13:49:22.530

看看[异步](https://github.com/caolan/async)库。它提供了常用收集方法（map、filter、each...）的异步版本。AFAIK，异步处理您的数组不会阻塞其他进程或用户。

# c++ - std::streampos, std::streamoff and std::streamsize to long long int?

> ID：12774038
> 
> 赞同：10
> 
> 时间：2012-10-08T00:29:55.197
> 
> 标签：c++, file, c++11, stream, standards-compliance

To measure position/offsets/size of streams, the standard specify `std::streampos`, `std::streamoff` and `std::streamsize`, but they are implementation defined.

How to convert these types to `long long int` in a secure and portable way ? (for example to measure a file size and inject it in a function that take a long long int as argument)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T00:44:50.480

好吧，就 C++98/03 而言，*没有* `long long int`. 所以我假设你在问 C++11。

`streamsize`and`streamoff`必须是整数类型的类型定义（不是[`streampos`](http://en.cppreference.com/w/cpp/io/fpos)整数，所以你不会将它传递给任何需要 a 的东西`long long`）。由于整数类型是基本类型，它们只能由 C++ 定义或作为特定于编译器的定义。

因此，唯一的问题是：这些 typedef 是否*大于*`long long`？所有整数类型都可以转换为更大或相等大小的类型（尽管有符号/无符号，但这里的所有类型都是有符号的，所以没问题）。但如果它更大......你会怎么做呢？

假设您无法更改要“注入”它的函数的签名（因为如果可以，没有理由不将`streamsize`其作为参数类型从而避免问题），您没有任何选择。您的数据值大于函数采用的值。没有办法绕过它。

您可以在 a 中执行 static_cast`long long`以关闭编译器，但如果实际大小不适合 a ，这将无济于事`long long`。

归根结底，这是一个棘手的问题。您有一个函数，该函数接受的参数对于您传递的内容可能太小。您最多可以通过`static_assert`. 像这样的东西：

```
static_assert(sizeof(std::streamsize) <= sizeof(long long), "Oops."); 
```

老实说，我不会担心的。赔率很好，这`long long`将是您的编译器本机支持的最大整数大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T00:44:09.527

只需将值传递给需要 long long 的任何函数。`std::streamoff`和`std::streamsize`都是有符号整数类型，并且`std::streampos`可以隐式转换为`std::streamoff`.

编辑：我想断言streamsize/streamoff 不会比`long long`不会伤害更大，以防有人提出__int128 文件大小。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-02-08T13:25:32.813

MINGW-64 的短响应：`std::streampos`具有到 64 位有符号整数类型的转换运算`std::streamoff`符

```
std::streampos pos = ...;
std::streamoff ofs = (std::streamoff) pos; 
```

因此，例如要查找文件的长度，您只需打开`std::ifstream`并评估...

```
static unsigned long long getStreamSize(std::ifstream& is)
{
    std::streampos savePos = is.tellg();
    is.seekg(0, std::ios::end);
    std::streampos endPos = is.tellg();
    is.seekg(savePos);
    return (std::streampos)endPos;
} 
```

...或者认为 STL 是另一个岛屿 ...

# c# - Printout Constraints and Objective Function using Gurobi C# interface

> ID：12774039
> 
> 赞同：0
> 
> 时间：2012-10-08T00:30:01.203
> 
> 标签：c#, gurobi

Given a model, how to printout

1.  all added constraints
2.  its objective function?

in C#?

Says

```
GRBVar newVar=model.AddVar(0.0, 1.0, 0.0, GRB.BINARY, "newvar");
model.AddConstr(newVar<=1,"newConstraint");
model.SetObjective(newVar*2,GRB.MAXIMIZE);

//Printout all constraint in the model(suppose to be newVar<=1)
//Printout model objective function (suppose to be newVar*2) 
```

How do I achieve what is in the comments? Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T10:35:09.097

我认为没有简单的方法，但是您可以使用`model.write("model.lp")`然后读取文件并将其写入控制台。

否则我认为你必须通过迭代约束来自己构造字符串。

[您可以在此处](http://www.gurobi.com/documentation/5.0/reference-manual/node652#sec:Attributes)阅读有关如何从约束中提取属性的 信息。

# scala - What's the best way using Scala and SBT to create samples for a library that can be built from the SBT CLI?

> ID：12774042
> 
> 赞同：3
> 
> 时间：2012-10-08T00:30:36.897
> 
> 标签：scala, sbt

I'm creating a library in Scala and would like to include some usage samples with the source. However, I don't want those samples to reside within the main source directory (since they're not a part of the library proper), nor do I want them to be built by default when you build the library. But I would like to be able to do something like "build-samples" from the SBT prompt. What's the most straightforward way to do this?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T01:14:21.917

您可以在 SBT 中创建一个依赖于您的主项目的子项目。这允许您在不编译示例的情况下构建您的库，但是当您需要编译示例时，您可以使用单独的命令来执行此操作，该命令将在需要时构建库。

Twitter 的[Finagle](https://github.com/twitter/finagle)项目就是一个很好的例子。您可以看到他们有一个子项目“finagle-example”，其中包含一堆示例。查看[/project/Build.scala](https://github.com/twitter/finagle/blob/master/project/Build.scala)以了解它们如何定义所有子项目。你应该可以对你的做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:45:03.737

[您所描述的内容与giter8](https://github.com/n8han/giter8)的最常见用例听起来很多。检查[未过滤的示例](https://github.com/unfiltered/unfiltered#example-apps)，它们都是 giter8 模板。这是一个giter8 项目的[giter8 模板](https://github.com/n8han/giter8.g8)

# sharepoint - Get items from current view/filter in Sharepoint 2010 - using client object model

> ID：12774047
> 
> 赞同：4
> 
> 时间：2012-10-08T00:31:14.150
> 
> 标签：sharepoint, view, sharepoint-clientobject

How can I get just the items in the user's current view/filter? Using Sharepoint 2010 Client Object Model (i.e. Javascript/ECMAScript).

A user could select a view that shows a subset of the items available in the library or list, and they could then apply a filter to one or more columns. I want to get the net result of all that filtering. I want all the items visible to the user, in all pages.

I've seen lots of sample code that depends on knowing the current view in order to constuct a query - that doesn't really help in this case. I already know how to get just selected items, e.g.

`SP.ListOperation.Selection.getSelectedItems(SP.ClientContext.get_current());`

However, that only selects the items in the current page.

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-17T23:27:02.290

Sibirman 的首选答案将仅返回视图的原始查询。当用户应用过滤器操作时，用户指定的过滤器实际上附加到 URL（作为 InplviewHash 字符串的一部分）。

例如#InplviewHashf16272c0-c177-42d7-9638-35fd75c90348=WebPartID%3D%7BF16272C0--C177--42D7--9638--35FD75C90348%7D- **FilterField1** %3DProjectRef- **FilterValue1** %3DProject% **25201-** **FilterField2** % 3DADdress2

 **INPLVIEW.js 和 /_layouts 中的其他 SP JavaScript 文件中有一些函数，其中包括用于解码和重新初始化视图的函数，但我无法全部解密。

DecodeHashAsQueryString 和 InitGridFromView 是一个很好的起点。

我最终编写了自己的代码来检查哈希字符串，然后删除键/值对。

```
var uri = window.location.href;
var hashIndex = uri.search("#");

var filter = false;
if (hashIndex == -1) {
  // Wasn't found
  alert('No filters applied!');
  // ...go with default query.
} else {
  // # found. Get hashstring
  var hashStr = uri.substring(hashIndex);
  newStr = DecodeHashAsQueryString(hashStr);

  var trStr = newStr.substring(newStr.indexOf("FilterField"));
  var retStr = trStr.replace(/%3D|&/g,",").replace(/%2520/g," ");
  retStr = retStr.replace(/FilterField[0-9]+,|FilterValue[0-9]+,/g,"")
  var filtArray = retStr.split(','); // "MyField1","MyValue1",... 
```

并将它们应用于我自己的不包含限制的查询，因此返回所有符合过滤条件的项目。

如果要处理文本 opr 选择以外的字段，则需要更进一步并获取字段类型，以便可以根据需要修改每个字段的查询值类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T05:09:51.127

您可以通过两个请求来做到这一点：

```
function getItemsFromView(listTitle, viewTitle)
{

    var context = new SP.ClientContext.get_current();
    var list = context.get_web().get_lists().getByTitle(listTitle);
    var view = list.get_views().getByTitle(viewTitle);
    context.load(view);

    context.executeQueryAsync(
        function(sender, args) {getItemsFromList(listTitle, "<View><Query>" + view.get_viewQuery() + "</Query></View>")},
        function(sender, args) {alert("error: " + args.get_message());}
    );
}

function getItemsFromList(listTitle, queryText) 
{
    var context = new SP.ClientContext.get_current();
    var list = context.get_web().get_lists().getByTitle(listTitle);

    var query = new SP.CamlQuery();
    query.set_viewXml(queryText);

    var items = list.getItems(query);

    context.load(items);
    context.executeQueryAsync(
        function()
        {
            var listEnumerator = items.getEnumerator();
            var i = 0;
            while (listEnumerator.moveNext())
            {
                i++;
            }
            alert("items retrieved: " + i);
        },
        function(sender, args) {alert("error in inner request: " + args.get_message());}
   );

} 
```**

# ios - Ios "stop" button to correspond with "play" and "pause"

> ID：12774049
> 
> 赞同：0
> 
> 时间：2012-10-08T00:32:14.100
> 
> 标签：ios, graphics

In my IOS app, I play short snippets of audio. I want to give the user the option to stop what is playing, in the sense of abandoning it and moving on. So it's not really a pause. However, I find no system "stop" button, except for the "X". I was thinking more of the standard square block. Do I have to make my own?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T00:35:01.543

Yes, iOS provides no such icon to my knowledge. The icon should be trivially simple to create, seeing as it is simply that square block.

# vb.net - Grab Selected Text Using SendMessage and GETSELTEXT

> ID：12774054
> 
> 赞同：0
> 
> 时间：2012-10-08T00:33:46.273
> 
> 标签：vb.net, text, get, selected

Using SendMessage (http://www.pinvoke.net/default.aspx/coredll/SendMessage.html) + WM_GETSELTEXT how could I grab the currently selected text in VB.NET?

# java - java中的静态方法继承

> ID：12774055
> 
> 赞同：1
> 
> 时间：2012-10-08T00:34:08.157
> 
> 标签：java, inheritance, overriding

假设我有一个 POJO `User`，我添加了一些静态方法来执行 CRUD 操作：

```
public class User {
    private String name;
    private int age;

    // getter and setter omitted
    //
    public static void add(User user) {
        // add person
    }

    public static int delete(Object id) {
        // delete person
        return 1;
    }
} 
```

由于我有像用户这样的其他实体，所以我想让`add`and`delete`方法抽象，就像这样；

```
public class?interface Entity<T>{
    static add(T t);
    static delete(Object id);   
}

public class User extends Entity<User>{
    @override
    static add(User user){
        // add ...
    }

    ....
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T00:36:59.937

不，这是不可能的。

> 首先你不能在接口中定义静态方法。看到这个[讨论](https://stackoverflow.com/questions/512877/why-cant-i-define-a-static-method-in-a-java-interface)
> 
> 其次，您不能覆盖`static`方法。请参阅此[讨论](https://stackoverflow.com/questions/2223386/why-doesnt-java-allow-overriding-of-static-methods)。

我不确定您的要求，如果适用，我建议将它们保留为实例方法并允许每个类提供它自己的实现（如 Bohemian 建议的那样）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T00:47:22.613

不要在实体类中使[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)方法静态，而是创建一个通用[DAO](http://en.wikipedia.org/wiki/Data_access_object)接口，然后为每个实体类型实现具体的 DAO 类。

不要在这种情况下使用静态方法。一种更好且更 OOP 的方法是使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)框架，该框架仅创建每个具体 DAO 类的一个实例以节省内存和时间（用于一次又一次地创建新的 DAO 实例）并在应用程序中需要的所有位置重用这些实例访问它们。

```
public interface Dao<T> {

    // you can customise these signatures by your needs
    // these are just my suggestions

    T get(long id);

    List<T> getAll();

    T add(T t);

    T update(T t);

    void delete(T t);
}

public class UserDao implements Dao<User> {

    public User get(long id) { ... }

    public List<User> getAll() { ... }

    public User add(User user) { ... }

    public User update(User user) { ... }

    public void delete(User user) { ... }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T00:39:45.140

您不能覆盖静态方法，但没有充分的理由说明这些方法应该是静态的。使它们成为实例方法：

界面应如下所示：

```
public interface Entity<T> {
    T getId();
    void add();
    int delete();   
} 
```

通过实现：

```
public void add() {
    // add "this"
}

public int delete() {
    // delete "this"
    return 1;
} 
```

这种代码模式很常见——我见过很多次——而且效果很好。

如果不想使用实例方法，可以在实用程序类中创建静态方法来处理此类对象：

```
public class DaoUtil {

    public static <T> void add(Entity<T> entity) {
        // some impl
    }

    public static <T> int delete(Class<? extends Entity <T>> clazz, T id) {
        // some impl
    }
} 
```

# haskell - Haskell - 类型类的实例列表

> ID：12774056
> 
> 赞同：13
> 
> 时间：2012-10-08T00:34:10.853
> 
> 标签：haskell, typeclass

我对 Haskell 还很陌生，为了变得更好，我正在尝试制作一个简单的 Web 服务器。我想让我表示页面的方式可扩展，所以我的想法是让网页成为可渲染数据的列表（比如如何制作在 Java 中实现某个接口的对象列表），其中 Renderable 是

```
class Renderable a where
    render :: a -> IO String 
```

不幸的是，我了解到列表必须是具体类型，所以我只能列出一种类型的可渲染数据。此外，创建受类型类约束的数据似乎是不可能的，所以我不能制作像 RenderList 数据这样的东西。我的临时解决方案是这样的：

```
myPage =
    [render $ someData
    ,render $ someMoreData
    ,render $ someOtherData
    ...
    ] 
```

但这感觉很尴尬，使使用类型类没有任何好处，并且感觉应该有更好的方法。所以我想知道有什么方法可以重组我必须更清洁、更符合标准 Haskell 实践并且仍然易于扩展的东西？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-08T02:57:44.077

您正在尝试实现面向对象的设计风格。例如，在 Java 中，您将拥有 a`List<Renderable>`并且一切就绪。这种设计风格在 Haskell 中有点不自然；您需要为有界存在创建一个包装器类型，如[存在类型](http://www.haskell.org/haskellwiki/Existential_type#Dynamic_dispatch_mechanism_of_OOP)的 Haskell wiki 页面上所示。例如：

```
class Renderable_ a where
  render :: a -> IO String

data Renderable = forall a. Renderable_ a => Renderable a
instance Renderable_ Renderable where
  render (Renderable a) = render a 
```

然后，您可以获得一个 列表`Renderable`，您可以随意渲染它。不过，就像我说的那样，这是一种在 Haskell 中不太自然的 OO 风格。您可以通过重新考虑数据结构来避免这种情况。您说您“想要使您表示页面的方式可扩展”；考虑其他方法来代替。

无关：我猜`render`不需要产生`IO String`动作。`IO`如果可以的话，尽量避开设计的核心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-08T01:11:56.457

查看这个关于 haskell[异构集合](http://www.haskell.org/haskellwiki/Heterogenous_collections)的页面。它提供了几种方法的想法。

# ruby-on-rails - Rails - Validated protected attribute?

> ID：12774066
> 
> 赞同：1
> 
> 时间：2012-10-08T00:35:25.800
> 
> 标签：ruby-on-rails, ruby

I am creating a scheduling system in Ruby Rails. The system is composed of Customers, Resources, and Bookings. There is many to one with Booking to Customer and Resources. A customer and resource can have many bookings.

Booking has customer_id and booking_resource_id I thought should be protected. I also used booking_resource as the model because Resource conflicted with activeadmin.

I am using the validates_overlap gem that allows easily to create a overlapping validation with a scope to :booking_resource_id ( [https://github.com/robinbortlik/validates_overlap](https://github.com/robinbortlik/validates_overlap)) . The goal is we can never schedule the same resource at the same time.

The whole thing works under mass assignment but as soon as I put booking_resource_id as protected, add the individual assignments in the controller the validation is by passed.

How can I validate a protected attributed?

I read [http://www.davidverhasselt.com/2011/06/28/5-ways-to-set-attributes-in-activerecord/](http://www.davidverhasselt.com/2011/06/28/5-ways-to-set-attributes-in-activerecord/) but I seem a little bit cornered. If I used attributes= and override mass assignment protected what is the point?

```
class Booking < ActiveRecord::Base
  belongs_to :customer
  belongs_to :booking_resource
  attr_accessible :approved, :approvedBy, :end, :start, :title
  attr_protected :customer_id, :booking_resource_id
  validate :start_cannot_be_future
  validates :start, :end, :overlap => {:scope => :booking_resource_id}

  def start_cannot_be_future
    if self.start > self.end
      errors.add(:start, "Date can't be in the future")
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:09:20.497

首先，如果您使用 attr_accessible 那么您不需要使用 attr_protected 因为您无法访问的属性将自动受到保护。

其次，我不明白你为什么要保护`booking_resource_id`。我的意思是，你怎么知道要预订的资源是什么？是的，也许对于编辑它应该受到保护，但对于创建我不这么认为。

因此，如果您需要指定不同的受保护属性，我建议您查看将包含在新 Rails 版本中的新[strong_parameters gem。](https://github.com/rails/strong_parameters)这个 gem 为您提供了一种很好的方法来指定要在控制器中列入白名单的属性，并且您可以为每个控制器操作创建不同的白名单，我认为在这种情况下您需要这样做。

# cocoa - 在 Cocoa 应用程序中显示 HDD 上所有 PDF 文件的列表

> ID：12774068
> 
> 赞同：2
> 
> 时间：2012-10-08T00:35:50.310
> 
> 标签：cocoa, pdf, xcode4.2

我正在尝试在 Xcode 4.2 中制作一个简单的 OS x PDF 阅读器。我想要一个抽屉来显示用户计算机上的所有 PDF 文件，并且能够单击选择的 PDF 并让我的 PDFView 显示它。我目前已设置好所有内容，我的主窗口和抽屉以浏览器视图作为其内容视图。如何使用 HDD 上所有 PDF 文件的列表填充浏览器视图并选择列表以打开该 PDF 文件？这就是我被困住并且厌倦了搜索的地方，所以我崩溃了并决定寻求帮助。我对 Objective-C 相当陌生，并且在 Snow Leopard 10.6.8 上使用 Xcode 4.2。任何帮助/建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:21:28.630

`NSFileManager`包含枚举目录树中项目的方法，例如参见`enumeratorAtURL:includingPropertiesForKeys:options:errorHandler:`. 使用这样的枚举器，您可以根据您的标准检查每个找到的项目，在这种情况下是 PDF，并处理匹配的项目。

如果您想要一种较低级别的方式来执行此操作，请查看`fts(3)`手册页。

# python - PyDev 无法识别 Celery 任务装饰器

> ID：12774069
> 
> 赞同：6
> 
> 时间：2012-10-08T00:35:52.567
> 
> 标签：python, eclipse, pydev, celery

我在 Eclipse/PyDev 中的 Python/Celery 项目面临以下问题。我在 myapp.tasks 模块中定义了我的任务函数，如下所示：

```
@celery.task(max_retries=None)
def mytask(parm1):
    ...
    myapp.myfunction(parm1)
    ... 
```

然后，在另一个模块中，我希望向调用该函数的任务发送重试信号。所以，我喜欢这样：

```
import myapp.tasks
...
def myfunction(parm1):
    ...
    raise myapp.tasks.mytask.retry(countdown=60) 
```

出于某种原因，PyDev 用错误标记最后一行：'Undefined variable from import: retry' 但代码确实有效。这是一个无法识别装饰器的 PyDev 问题，还是我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:16:44.567

Pydev 显然在使用静态分析，这对于动态语言来说是相当奇怪的。但是我现在添加了一个 hack，它应该让 PyDev 成功地静态分析 celery 模块。您可以通过安装 3.0 分支进行尝试：

```
pip install https://github.com/celery/celery/zipball/3.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-25T18:26:09.917

PyDev 使用静态分析。您可以添加“强制内置”来解决错误标记。

1.  转到窗口-> 首选项
2.  在左侧窗格中选择 PyDev -> Interpreters -> Python Interpreters
3.  在右侧窗格中选择您用于 Celery 的 python 解释器
4.  在底部，选择“Forced Bultins”并点击“New...”
5.  添加 myapp.tasks.mytask 或任何其他需要的类型

就我而言，我需要添加“celery.decorators”来解决类似的错误。我使用的是 Eclipse Neon (4.6.3)，但界面变化很小。多年来，我一直使用这种技术来解决协议缓冲区中的错误。

# c++ - 删除动态分配的数组时出错

> ID：12774075
> 
> 赞同：1
> 
> 时间：2012-10-08T00:37:39.023
> 
> 标签：c++, arrays, dynamic

这门课是为期中作业准备的。它是一个像向量一样工作的动态数组。问题是当一个新的索引被添加到数组中时，析构函数被调用（当程序结束时）程序抛出一个异常并进入一个名为 dgbheap.c 的文件。当我仅在析构函数中删除原点时会发生这种情况。

动态数组.h

```
 #ifndef DYNAMICARRAY_H
#define DYNAMICARRAY_H
    #include <new>
    #include <cstdlib>
    using namespace std;

    template <class T>
    class DynamicArray
    {
        private:
            T *origin;
            T *allocator;
            int size;
            int current;

        public:
            DynamicArray();
            DynamicArray(int);
            DynamicArray(const DynamicArray&);
            ~DynamicArray();
            void add(int);
            void empty();
            void remove(int);
            int getSize();
            T &operator[](const int&);
            const T operator=(const DynamicArray&);
            void put(T&);
            void put(T);
    };
    template <class T>
    DynamicArray<T>::DynamicArray()
    {
        origin = new T[5];
        allocator = NULL;
        size = 5;
        current = 0;
    }

    template <class T>
    DynamicArray<T>::DynamicArray(int s)
    {
        size = s;

        try
        {
            origin = new T[s];
            allocator = NULL;
            current = 0;
        }
        catch(bad_alloc)
        {
            cout << "Error: Bad memery allocation\n";
            exit(EXIT_FAILURE);
        }
    }

    template <class T>
    DynamicArray<T>::DynamicArray(const DynamicArray& obj)
    {
        empty();
        for(int counter = 0; counter < obj.size - 1; counter++)
        {
            origin[counter] = obj.origin[counter];
        }
    }

    template <class T>
    DynamicArray<T>::~DynamicArray()
    {
        delete [] origin;
        delete [] allocator;
    }

    template <class T>
    void DynamicArray<T>::add(int size)
    {
        allocator = new T[size];
        for(int counter = 0; counter < this-> size - 1; counter++)
        {
            allocator[counter] = origin[counter];
        }
        delete [] origin;
        origin = new T[size];
        this->size = this->size + size;

        for(int counter = 0; counter < this->size - 1; counter++)
        {
            origin[counter] = allocator[counter];
        }
        allocator = NULL;
    }

    template <class T>
    void DynamicArray<T>::empty()
    {
        if(size >= 0)
            delete [] origin;
    }

    template <class T>
    int DynamicArray<T>::getSize()
    {
        return size;
    }

    template <class T>
    T &DynamicArray<T>::operator[](const int &index)
    {
        return origin[index];
    }

    template <class T>
    const T DynamicArray<T>::operator=(const DynamicArray &obj)
    {
        size = obj.size;
        delete [] origin;

        origin = new T[size];

        for(int counter = 0; counter < size; counter++)
            *(origin + counter) = *(obj.origin + counter);

        return *origin;
    }

    template <class T>
    void DynamicArray<T>::put(T &obj)
    {
        if(current == size - 1)
        {

            add(1);
            origin[size - 1] = obj;
            ++current; 
        }
        else
        {
            origin[current] = obj;
            ++current;
        }
    }

    template <class T>
    void DynamicArray<T>::put(T obj)
    {
        if(current > size - 1)
        {

            add(1);
            origin[size - 1] = obj;
            ++current; 
        }
        else
        {
            origin[current] = obj;
            ++current;
        }
    }

    template <class T>
    void DynamicArray<T>::remove(int location)
    {
        allocator = new T[size - 1];
        int skipper = 0;

        for(int counter = 0; counter < size - 1; counter++, skipper++)
        {
            if(counter != location)
                allocator[counter] = origin[skipper]
            else if(counter == location)
            {
                ++skipper;
                allocator[counter] = origin[skipper]
                continue;
            }
        }
    }

    #endif // !DYNAMICARRAY_H 
```

主文件

```
 #include <iostream>
    #include <string>
    #include "DynamicArray.h"

    using namespace std;

    int main()
    {
        DynamicArray<int> a(5);
        a.put(21);
        a.put(22);
        a.put(30);
        a.put(58);
        a.put(87);
        a.put(87);

        cout << a[0] << endl;
        cout << a[1] << endl;
        cout << a[2] << endl;
        cout << a.getSize() << endl;

        system("pause");
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T00:39:49.513

您的复制构造函数未初始化`origin`。它应该是这样的：

```
template <class T>
DynamicArray<T>::DynamicArray(const DynamicArray& obj)
  : origin(new T[obj.size]),
    size(obj.size),
    allocator(NULL),
    current(obj.current)
{
    for(int counter = 0; counter < obj.size; counter++)
    {
        origin[counter] = obj.origin[counter];
    }
} 
```

还要小心你的`empty()`方法：

```
template <class T>
void DynamicArray<T>::empty()
{
    delete [] origin;
    origin = NULL;
    size = 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T00:51:13.390

问题出在：

模板无效 DynamicArray::add(int size);

您混淆了具有相同名称 this->size 和参数大小的大小变量

这是更正后的成员函数：

```
template <class T>
void DynamicArray<T>::add(int size)
{
  allocator = new T[this->size]; // was just 'size', needs to be old size
  for(int counter = 0; counter < this->size - 1; counter++)
  {
    allocator[counter] = origin[counter];
  }
  delete [] origin;
  this->size = this->size + size; // was down one line
  origin = new T[this->size]; // was 'size'. ie old size, not new size set in line above

  for(int counter = 0; counter < this->size - 1; counter++)
  {
    origin[counter] = allocator[counter];
  }
  allocator = NULL;
} 
```

# sql - 插入记录并保留主键值

> ID：12774079
> 
> 赞同：2
> 
> 时间：2012-10-08T00:39:16.793
> 
> 标签：sql, sqlite, primary-key, rowid

我有一个 SQLite 数据库和一个使用自动递增 int 作为主键的表。我查看了文档，似乎如果我执行插入和替换，它会删除然后在找到重复项时插入一条记录。

这很好，但问题是自动递增键从它停止的地方继续，而不是从零开始。这意味着每次我运行该查询时，记录的增量都会发生变化。是否可以在不更改主键的情况下更新记录？我发现可行的一种方法是删除表和主键索引，但这似乎有点矫枉过正，并且随着表变大可能会导致更长的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:39:39.107

如果记录存在，您可以对其进行更新。这不会更改主键。

# python - 在 Heroku 上的 RQ 中处理异常处理和重新排队

> ID：12774085
> 
> 赞同：8
> 
> 时间：2012-10-08T00:40:29.550
> 
> 标签：python, heroku, queue, redis

我有一个在 Python 中的 Heroku 上运行的网站，我有一个工作人员作为后台进程来处理我不想阻止网页传递的任务，因此不适合`web`dynos。为此，我使用[`rq`](http://python-rq.org/)和 redis 设置了一个队列。

在我的过程中，有时可能会出现自定义异常。对于其中的特定子集，我不想让作业直接进入“失败”队列，而是要重新排队几次。我一直在查看主页上的[异常处理程序页面](http://python-rq.org/docs/exceptions/)`rq`，但我不清楚一些事情。特别是，它描述了以下编写异常处理程序的方法：

```
def my_handler(job, exc_type, exc_value, traceback):
    # do custom things here
    # for example, write the exception info to a DB
    ... 
```

现在，我打算按照以下方式做一些事情：

```
 from rq import requeue_job
   def my_handler(job, exc_type, exc_value, traceback):
        if exec_type == "MyCustomError":
           job.meta['MyErrorCount'] += 1
           job.save()

           if job.meta['MyErrorCount'] >= 10:
               return True
           else:
               requeue_job(job.id)
               return False 
```

**问题：**

*   `exc_type`、`exc_value`和是什么类型的对象`traceback`？（*例如*，这条线`if exec_type == "MyCustomError"`完全正确吗？）
*   我的错误处理程序是否会有效地检测它是否是特定错误，将这些作业重新排队，直到它失败 10 次，然后让它下降到`failed`? 它还会让所有其他错误落入`failed`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-01T21:37:36.153

[这是我的解决方案](https://gist.github.com/jokull/5498543)

```
queues = []

def retry_handler(job, exc_type, exc_value, traceback):
    # Returning True moves the job to the failed queue (or continue to
    # the next handler)

    job.meta.setdefault('failures', 1)
    job.meta['failures'] += 1
    if job.meta['failures'] > 3 or isinstance(exc_type, (LookupError, CorruptImageError)):
        job.save()
        return True

    job.status = Status.QUEUED
    for queue_ in queues:
        if queue_.name == job.origin:
            queue_.enqueue_job(job, timeout=job.timeout)
            break
    else:
        return True  # Queue has disappeared, fail job

    return False  # Job is handled. Stop the handler chain.

queues.append(Queue(exc_handler=retry_handler)) 
```

我决定重试所有错误 3 次，除非遇到某种已知的异常类型。这使我能够尊重可以理解的故障，例如如果在创建作业之后但在执行作业之前删除了用户，或者在图像调整大小作业的情况下，不再找到提供的图像 (HTTP 404)以可读的格式（基本上只要我知道代码将永远无法处理这项工作）。

回答您的问题： exc_type 是类， exc_value 是异常实例。`traceback`对于日志记录很有用。如果您关心这一点，请查看 Sentry。`SENTRY_DSN`如果在上下文中运行，工作人员会自动配置一个 Sentry 错误处理程序。比用错误日志污染自己的数据库要干净得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-07T15:12:25.603

Jökull[在这里](https://stackoverflow.com/a/16326962/6212082)分享的答案是正确的，只是答案（和帖子）已经很老了。我遇到过类似的情况，每当作业失败时，我都需要将重试逻辑放入我的 redis 队列中。这是队列工作人员的片段（必须将逻辑转移到工作人员）从 Jökull 的回答（和评论）、[redis-queue 文档](https://python-rq.org/docs/)和[这个](https://realpython.com/flask-by-example-implementing-a-redis-task-queue/)中获取灵感：

```
from rq import Worker, Connection, Queue
from redis import Redis
from app.config import Config

conn = Redis()
max_retries = 3

def retry_handler(job, exc_type, exc_value, traceback):
    # Returning True moves the job to the failed queue (or continue to
    # the next handler)
    job.meta.setdefault('failures', 1)
    job.meta['failures'] += 1
    if job.meta['failures'] > max_retries:
        job.save()
        return True
    # I was unable to locate Status in rq so added the status 'queued' that rq actually expects
    job.status = 'queued' 
    for queue_ in Queue.all(connection=conn):
        if queue_.name == job.origin:
            # at_front=True enqueues the job at the front of the queue for immediate retry.
            queue_.enqueue_job(job, at_front=True) 
            break
    else:
        return True  # Queue has disappeared, fail job

    return False  # Job is handled. Stop the handler chain.

if __name__ == "__main__":
    with Connection(conn):
            worker = Worker(list(map(Queue, ['your_queue_name'])), exception_handlers=[retry_handler])
            worker.work() 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-08T01:12:03.850

1.  [有关更多信息，请阅读sys](http://docs.python.org/library/sys.html#sys.exc_info)的文档。
2.  > False 表示停止处理异常，True 表示继续并落入堆栈中的下一个异常处理程序

同一个作业的多个异常处理程序，`type`是异常类型（一个类），你应该更正你的代码，其他错误将返回`None`解释为`True`rq 文档所说的。

# c# - .net framework 2.0 C# 和 json webquery 格式字符串

> ID：12774086
> 
> 赞同：1
> 
> 时间：2012-10-08T00:40:30.323
> 
> 标签：c#, json, web-services, formatting, httpwebrequest

我在 C# 中创建了一个 Web 服务，如下所示：

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string UpdateHeatCallJSON(string json)
    {
        HeatItem item = JsonConvert.DeserializeObject<HeatItem>(json);
        UpdateHeatCall(item);
        HeatItemResponse response = new HeatItemResponse();
        //... more code
        return JsonConvert.SerializeObject(response);
    } 
```

我基本上有一个对象 HeatItem，我想将其作为参数传入。

我目前在 C# 控制台应用程序中使用 Web 服务（用于测试）并且在寻找正确格式时遇到了挑战。这是我的电话：

```
 static void UpdateHeatItemJSON()
    {
        // corrected to WebRequest from HttpWebRequest
        WebRequest request = WebRequest.Create(requestServer + "/UpdateHeatCallJSON");

        request.Method = "POST";
        request.ContentType = "application/json; charset=utf-8";
        string postData = "";
        postData = @"{'json':'{""BusinessPartner"":""00000000-0000-0000-0000-000000000000"",""CaseNumber"":4,""CaseDescription"":""first case"",""CaseType"":"""",""CaseSeverity"":"""",""DueDate"":""0001-01-01T00:00:00"",""AssignmentNumber"":5,""AssignmentDescription"":"""",""AssignmentCreation"":""0001-01-01T00:00:00"",""AssignmentTime"":""0001-01-01T00:00:00"",""ChangeDate"":""0001-01-01T00:00:00"",""ChangeTime"":""0001-01-01T00:00:00"",""Group"":"""",""SubGroup"":"""",""Module"":"""",""AssignmentStatus"":"""",""KPIChallenge"":false,""KPI1Status"":"""",""KPI1User"":"""",""KPI1Date"":""0001-01-01T00:00:00"",""KPI1Time"":""0001-01-01T00:00:00"",""KPI2Status"":"""",""KPI2User"":"""",""KPI2Date"":""0001-01-01T00:00:00"",""KPI2Time"":""0001-01-01T00:00:00"",""SessionID"":null}'}";

        System.Diagnostics.Debug.Print(postData);

        //get a reference to the request-stream, and write the postData to it
        using (Stream s = request.GetRequestStream())
        {
            using (StreamWriter sw = new StreamWriter(s))
                sw.Write(postData);
        }

        //get response-stream, and use a streamReader to read the content
        using (Stream s = request.GetResponse().GetResponseStream())
        {
            using (StreamReader sr = new StreamReader(s))
            {
                string jsonData = sr.ReadToEnd();
                JObject jObject = JObject.Parse(jsonData);
                JToken jHeatItem = jObject["HeatItem"];
            }
        }
    } 
```

看看上面的 postData，格式化 json 字符串是可行的，但是当我在[http://jsonlint.com/](http://jsonlint.com/)验证字符串时，验证失败。当我像这样传入经过验证的 json 字符串时：

{“json”：{“BusinessPartner”：“00000000-0000-0000-0000-000000000000”，“CaseNumber”：4，“CaseDescription”：“第一个案例”，“CaseType”：“”，“CaseSeverity”：“” ，“DueDate”：“0001-01-01T00:00:00”，“AssignmentNumber”：5，“AssignmentDescription”：“”，“AssignmentCreation”：“0001-01-01T00:00:00”，“AssignmentTime”： “0001-01-01T00:00:00”、“更改日期”：“0001-01-01T00:00:00”、“更改时间”：“0001-01-01T00:00:00”、“组”：“” , "子组": "", "模块": "",“AssignmentStatus”：“”，“KPIChallenge”：假，“KPI1Status”：“”，“KPI1User”：“”，“KPI1Date”：“0001-01-01T00:00:00”，“KPI1Time”：“0001- 01-01T00:00:00”、“KPI2Status”：“”、“KPI2User”：“”、“KPI2Date”：“0001-01-01T00:00:00”、“KPI2Time”：“0001-01-01T00： 00:00", "SessionID": null } }0001-01-01T00:00:00”、“KPI2Status”：“”、“KPI2User”：“”、“KPI2Date”：“0001-01-01T00:00:00”、“KPI2Time”：“0001-01- 01T00:00:00", "SessionID": null } }0001-01-01T00:00:00”、“KPI2Status”：“”、“KPI2User”：“”、“KPI2Date”：“0001-01-01T00:00:00”、“KPI2Time”：“0001-01- 01T00:00:00", "SessionID": null } }

Web 服务返回 500 内部服务器错误，我认为这是因为它不喜欢传入的参数。我对此比较陌生，我想知道是否有人可以帮助我更好地理解这一点。

还查看响应（对于工作示例），返回 json 包含三个反斜杠 \\ 我相信可以转义引号。这使得这个电话

```
 JObject jObject = JObject.Parse(jsonData);
                JToken jHeatItem = jObject["HeatItem"]; 
```

失败。任何想法为什么？

谢谢托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:52:28.407

在设置请求时，我添加了`request.Accept = "application/json; charset=utf-8";`. 确保使用该`ScriptService`属性装饰服务。例如，

```
[System.Web.Script.Services.ScriptService]    
public class Service1 : System.Web.Services.WebService 
```

当您格式化您的帖子数据时，这种风格对我有用：

`@"{""json"":'{""test"": ""value""}'}";`

关键似乎是确保在初始冒号后的 JSON 中有一个单引号。

关于不需要的反斜杠字符，请查看此链接[http://encosia.com/asp-net-web-services-mistake-manual-json-serialization/](http://encosia.com/asp-net-web-services-mistake-manual-json-serialization/)。本质上，交易是您从服务中返回一个对象，而不是一个字符串。同样的事情也适用于将对象传递到您的服务中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T11:32:15.327

感觉自己像个白痴，在这上面浪费了很多时间，现在一切都那么容易。让 asp.net 处理它。按照这篇文章中的步骤进行操作，一切正常

[http://encosia.com/asp-net-web-services-mistake-manual-json-serialization/](http://encosia.com/asp-net-web-services-mistake-manual-json-serialization/)

# objective-c - 更改设置时更新 UIWebView

> ID：12774087
> 
> 赞同：1
> 
> 时间：2012-10-08T00:40:41.600
> 
> 标签：objective-c, ios, xcode

在`Settings.bundle`中，我有一个带有标识符的文本输入`url_preference`。

使用`ViewController.h`,`ViewController.m`和我的故事板我有一个`UIWebView`设置显示来自设置的 url：

```
- (void) updateBrowser {   
    NSString *fullURL = [[NSUserDefaults standardUserDefaults] stringForKey:@"url_preference"];
    NSURL *url = [NSURL URLWithString:fullURL];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [_EmbeddedBrowser loadRequest:requestObj];    
} 
```

这行得通。

但是，当设置中的 URL 发生更改时，`UIWebView`不会更新以反映新的 URL。

通过禁止应用在后台运行，解决了不反映更新 URL 的问题。但是，出现了一个新问题：如果设置中的 URL*保持不变*，则不会保留会话。`UIWebView`只有在`url_preference`更改时才应更新。

我一直在尝试使用`applicationWillEnterForeground`in`AppDelegate.m`来强制`UIWebView`重新加载，但是我遇到了麻烦。

在 ViewController 中，我可以运行：

```
- (void)viewDidLoad {
     [self updateBrowser];
} 
```

但是当我尝试在 App Delegate 中运行相同的东西时它不会更新：

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{

    ViewController *vc = [[ViewController alloc]init];
    [vc updateBrowser];
} 
```

（我也包括`- (void) updateBrowser;`在`ViewController.h`,`#import "ViewController.h"`和`AppDelegate.m`

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:06:08.383

```
- (void)viewDidLoad
{
    [self updateBrowser];
    [super viewDidLoad];
    NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
    [center addObserver:self
               selector:@selector(defaultsChanged:)
                   name:NSUserDefaultsDidChangeNotification
                 object:nil];
}

- (void)defaultsChanged:(NSNotification *)notification {
    [self updateBrowser];
}

- (void) updateBrowser {

    NSString *fullURL = [[NSUserDefaults standardUserDefaults] stringForKey:@"url_preference"];
    NSURL *url = [NSURL URLWithString:fullURL];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [_EmbeddedBrowser loadRequest:requestObj];

} 
```

幸运的是，这种情况不需要使用 AppDelegate。当默认设置更改时，您实际上会听到一个通知。您必须将 ViewController 设置为观察者，并在每次发送 NSUserDefaultsDidChangeNotification 时执行一个函数。每次在设置中更改应用程序的默认设置时，都会自动出现此通知。这样，您不必每次应用程序进入前台时都刷新，只有在设置更改时才需要刷新。

# apache - Apache mod_rewrite 忽略句点和额外的斜杠

> ID：12774090
> 
> 赞同：1
> 
> 时间：2012-10-08T00:41:42.060
> 
> 标签：apache, .htaccess, mod-rewrite

这是我的.htaccess：

```
Options +FollowSymLinks
RewriteEngine On

RewriteRule ^[0-9]+(/)?$ /hello.php [R=301] 
```

localhost/123 按预期重定向到 localhost/hello.php。

但是：localhost/123.... 和 localhost////123//// 也重定向到 localhost/hello.php。

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T06:00:36.247

我无法重现句号的问题。然而，对于斜线，如果它们不创建分层结构，Apache 将表现得好像只有一个斜线。就这样`////123///`变成了`/123/`。（请参阅[Stack Overflow - 为什么 Apache 删除多个斜杠](https://stackoverflow.com/questions/8699542/why-is-apache-removing-multiple-slashes)）。我建议您将重写更改为以下内容，因为您无需捕获斜线以供重用。

```
RewriteRule ^[0-9]+/?$ /hello.php [L,R=301] 
```

如果您决定要一起消除尾随斜杠，这也是一种可能性：

```
RewriteRule ^[0-9]+$ /hello.php [L,R=301] 
```

# javascript - jQuery 中的 JavaScript 作用域

> ID：12774099
> 
> 赞同：-1
> 
> 时间：2012-10-08T00:43:28.523
> 
> 标签：javascript, jquery, json

```
 function getData(jsonAddress) {
      var data = new Array();
      var xhr = $.getJSON(jsonAddress, function(meas) {
        for (var i = 0; i < meas.length ; i++) {
          var dt = datetimeSplitter(meas[i].valuedate);
          data[i] = [Date.UTC(dt[0],dt[1]-1,dt[2],dt[3],dt[4],dt[5]),parseInt(meas[i].value,10)];
        };
      });
      alert(data);
    } 
```

我想让变量“数据”对函数可用，`getData`这样我就可以返回它（在这种情况下是警报）。我理解这是一个范围问题，可以通过闭包来解决。我也了解什么是闭包，但绝对不知道这种特定情况的语法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T00:45:32.077

这不是范围的问题，而是异步回调的问题。

您需要将回调函数传递给此方法，以便获得`getJSON()`调用的响应。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T00:48:03.207

`$.getJSON(jsonAddress, function(meas)....`是一个异步调用，即警报语句将在回调函数（其中数据设置有响应值）被调用之前被调用。如果您将警报移动到回调函数中，您将看到它具有正确的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T01:16:00.020

如果你真的不能像之前多次建议的那样使用异步调用，你也可以使用 ($.ajax)[http://api.jquery.com/jQuery.ajax/] 代替 - $.getJSON 只是一个它的变体 - 并使其同步 - 请注意，这不是建议的方法，因为您的应用程序将在浏览器同步检索数据时阻塞。

# visual-studio-2010 - Visual Studio Web 性能测试 - 来自隐藏字段的动态查询字符串参数

> ID：12774107
> 
> 赞同：0
> 
> 时间：2012-10-08T00:44:56.063
> 
> 标签：visual-studio-2010, performance-testing

我们有一个生成报价的应用程序。在应用程序的早期阶段，会生成一个唯一的 QuoteId。此 id 可以在隐藏字段中找到，该字段以 MVC 部分视图（通过 ajax 请求）发送给客户端。

我需要能够提取此隐藏字段，然后在后续请求中重用该值。我可以看到如何添加动态查询字符串参数，但到目前为止我提取 id 的尝试没有奏效。

到目前为止，我一直专注于上一个请求的提取规则，以尝试获取数据（我尝试提取表单字段和隐藏字段）。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:25:36.980

找到了一个解决方案——我真正想做的是根据动态值修改 URL，而不是尝试添加查询字符串参数。

我在上一步中提取了一个表单字段，然后使用参数修改了 URL，使其显示为：

```
{{WebServer}}/Controller/Method/{{QuoteId}} 
```

# list - haskell - 指定 # 个条件为真

> ID：12774108
> 
> 赞同：2
> 
> 时间：2012-10-08T00:45:08.257
> 
> 标签：list, haskell, boolean, conditional-statements

如果我有 4 个布尔条件，并且我想说如果其中至少 3 个为真，那么做*_*，这可以在 Haskell 中实现吗？

还是我必须经历每个排列？（即 1.True、2.True、3.True、4.False 和 1.False、2.True、3.True、4.True 等）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T07:07:38.137

```
atleast :: Int -> [Bool] -> Bool
atleast n bools = length tn == n
  where  tn = take n . filter id $ bools 
```

除非我错过了什么，否则应该懒惰地工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-08T06:42:12.677

如果您希望它在找到 N 个数字后停止检查列表，您可以使用惰性自然数进行计数。

```
import Data.List
import Data.Number.Natural

atLeast :: Int -> [Bool] -> Bool
atLeast n = (>= (fromIntegral n :: Natural)) . genericLength . filter id 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-08T06:19:26.530

该解决方案与目前提供的其他解决方案的不同之处在于它短路（即，在找到`n` `Bool`s 后停止）。所以它可以在一些无限列表上运行（只有那些最终会评估为`True`的列表），并且不一定会强制评估列表中的每个元素（由于懒惰）。

```
atLeast :: Int -> [Bool] -> Bool
atLeast 0 _          = True
atLeast _ []         = False
atLeast n (True:bs)  = atLeast (n - 1) bs
atLeast n (False:bs) = atLeast n bs 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-08T00:47:46.500

每个排列？当然不是..您可以计算为真的条件的数量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-08T02:14:22.283

这不是最美丽的方式，但你可能会发现

```
atLeast :: Int -> [Bool] -> Bool
atLeast n bools = length (filter (==True) bools) >= n 
```

最容易理解。`filter`只保留清单中满足你给它的规则的东西。在这种情况下，规则是答案必须是`True`。接下来，`length`计算剩下多少。

（规则是一个函数`a -> Bool`，其中`a`是列表中元素的类型）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-08T02:01:50.773

```
atLeast3 :: Bool -> Bool -> Bool -> Bool -> Bool
atLeast3 b1 b2 b3 b4 = sum (map fromEnum [b1, b2, b3, b4]) >= 3 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-08T01:33:31.963

```
requireAtLeast :: Int -> [Bool] -> Bool
requireAtLeast n = (>= n) . length . filter id 
```

如果您更喜欢极端有意义或无意义的形式，它们分别是：

```
requireAtLeast threshold predicates = length (filter (\predicate -> predicate) predicates) >= threshold

requireAtLeast = (. length . filter id) . (<=) 
```

# c++ - 使用类对象时出错？

> ID：12774109
> 
> 赞同：1
> 
> 时间：2012-10-08T00:45:07.983
> 
> 标签：c++, class, constructor

我刚刚创建了一个人类并定义了 2 个重载的构造函数，如您所见，然后创建了一个包含 2 个对象的数组，但弹出了一些错误！

为什么我得到这两个错误？[-fpermissive] 错误是什么？

```
#include <iostream>
using namespace std;
class person
{
    int x;

public:
    person() {
        x=0;
    }
    person(int y){   //error
        x=y;
    }
};

int main()
{
    int n;

    cin>>n;

    person* Arr= new person[2];

    Arr[0]=new person(n);  //error
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T00:52:07.523

您没有发布错误，但我认为它们是，

```
: In function ‘int main()’:
:25:24: error: invalid conversion from ‘person*’ to ‘int’ [-fpermissive]
:11:5: error:   initializing argument 1 of ‘person::person(int)’ [-fpermissive] 
```

你有两个选择。第一，创建一个人员指针数组，这些指针指向您使用“new”关键字创建的人员对象，并且驻留在堆上。

```
person* Arr[2];
Arr[0]=new person(n); 
```

您还可以创建一个人员数组，然后将它们设置为等于另一个人，这不需要 new 关键字。这些将驻留在堆栈上。

```
person Arr[2];
Arr[0]= person(n); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:25:10.023

您分配了一个由 2 组成的数组`person`，然后尝试将指向新分配的*指针*存储到该数组中`person`的第一个中。`person`这是对您的代码的最小更改，使用指向`person`. （我不是在讨论这是否是好的设计。）

```
int main()
{
    int n;

    cin>>n;

    person** Arr= new person*[2];

    Arr[0]=new person(n);
    return 0;
} 
```

# java - 在 JDBC 中关闭后 Postgresql 连接保持空闲

> ID：12774110
> 
> 赞同：1
> 
> 时间：2012-10-08T00:45:16.327
> 
> 标签：java, postgresql, jdbc

我仔细检查了我的代码，并且在 finally 块中有 conn.close 但是当我执行 SELECT * FROM pg_stat_activity; 我看到许多空闲连接。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T01:21:53.240

最可能的原因是您的应用程序正在使用连接池。如果是这样，池将抓取连接并保持其中一部分打开，以便可以重用它们。在执行另一个命令或关闭应用程序之前，连接将显示为 IDLE。

如果连接没有被关闭，您可能会看到类似 IDLE - In Transaction 的内容，这意味着连接已打开并等待执行提交或回滚，但未收到任何命令。

另外，我知道你说你关闭了连接，所以我不确定这是否适用于你，但我只是想抛出我过去也遇到过问题，因为没有明确关闭 PreparedStatements。

# java - Java Applet 隐藏状态栏 Appletviewer

> ID：12774129
> 
> 赞同：1
> 
> 时间：2012-10-08T00:51:05.943
> 
> 标签：java, applet, statusbar, appletviewer

我正在开发一个使用 Java Applet 的游戏，该游戏旨在在 JDK AppletViewer 中播放，但我遇到了一个问题。小程序底部的状态栏（显示“小程序已启动”的褐色状态栏）在上面玩游戏时看起来很糟糕。根据以下建议： http: [//www.coderanch.com/t/256541/Applets/java/JFrame-applet](http://www.coderanch.com/t/256541/Applets/java/JFrame-applet) 我添加了权限“showWindowWithoutWarningBanner”。但是，将其添加到我的安全策略后：`permission java.awt.AWTPermission "showWindowWithoutWarningBanner";`

于是我打开小程序，但状态栏还在。我可以确认正在使用安全策略文件，因为我可以使用相同的策略文件进行读写。

第二次尝试，尝试将状态设置为空，`setStatus(null);`以查看是否会完成工作，但只删除了“Applet Started”文本，褐色状态栏仍然存在。如果我做错了什么，或者是否有任何后续步骤要采取，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:03:14.640

不要使用 Applet（在您的情况下绝对没有充分的理由），而是使用 Swing。

例如，这是一个让您入门的基本框架：

框架：

```
public class App extends JFrame {

    public App() {
        super("Title");
        add(new AppPanel());
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setLocationByPlatform(true);
        pack();
    }    

} 
```

控制板：

```
public class AppPanel extends JPanel {

    @Override
    public void paintComponent(Graphics g) {
        // Perform your painting here
    }    

} 
```

此外，请确保在 EDT 上对其进行初始化，如下所示：

```
SwingUtilities.invokeLater(new Runnable() {

    public void run() {
        new App().setVisible(true);
    }   

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T00:12:54.727

> ..非常讨厌Java Applets，有什么特别的原因吗..？

*   小程序比应用程序更难开发和部署。每隔一周，某些浏览器的某些变体中就会出现一个新的小程序错误，因此将浏览器排除在外是值得的。
*   小程序是网页中的客人，但实际上，网页包装器实际上对小程序有什么贡献？最好有应用程序。在桌面上自由浮动，在用户选择的任何位置，并在浏览器关闭后幸存下来。
*   网页中的小程序在 HTML 中设置为特定大小，而自由浮动框架可以是理想需要的任何大小。虽然小程序只能通过 JS 调整大小，但框架可以根据需要调整大小或不调整大小。
*   ...

真的，这是你应该问的一个单独的问题。然后我会把这个答案移到它上面。

# python - 为什么我的 django 模型会抛出错误？

> ID：12774134
> 
> 赞同：3
> 
> 时间：2012-10-08T00:52:33.687
> 
> 标签：python, django-models

我正在为博客应用程序构建一个模型。

这是模型：

```
from django.db import models

class Tag(models.Model):
    keyword = models.CharField(max_length=256)
    posts = models.ManyToManyField(Post)

    def __unicode__(self):
        return self.keyword

class Post(models.Model):
    title = models.CharField(max_length=512)
    image = models.ImageField
    body = models.TextField()
    visible = models.BooleanField()
    date_created = models.DateTimeField(auto_now_add=True)
    date_updated = models.DateTimeField(auto_now=True)
    tags = models.ManyToManyField(Tag)

    def __unicode__(self):
        return self.title 
```

我将博客包添加到settings.py。然后我跑了`python manage.py sql blog`。我收到以下错误：

```
 File "/pathto/blog/models.py", line 5, in Tag
    posts = models.ManyToManyField(Post)
NameError: name 'Post' is not defined 
```

我不明白为什么没有定义 Post，因为我在 models.py 文件中定义了它。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T00:55:59.570

## 问题

定义`Tag`类时，`Post`尚未定义类。因为你指的是它，所以你会得到`NameError`例外。

## 解决方案

因此，更改此行：

```
posts = models.ManyToManyField(Post) 
```

进入这一行：

```
posts = models.ManyToManyField('Post') 
```

## 解释

[该文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey)为您提供了解决方法：

> 如果需要在尚未定义的模型上创建关系，可以使用模型的名称，而不是模型对象本身：
> 
> ```
> class Car(models.Model):
>     manufacturer = models.ForeignKey('Manufacturer')
>     # ...
> 
> class Manufacturer(models.Model):
>     # ... 
> ```

## 替代解决方案

您也可以省略类`posts`中的定义`Tag`（“ `posts = models.ManyToManyField(Post)`”行），只为模型中的反向关系提供适当的名称`Post`。Django 会知道如何处理它。只需替换这一行：

```
tags = models.ManyToManyField(Tag) 
```

用这条线：

```
tags = models.ManyToManyField(Tag, related_name='posts') 
```

要了解更多信息，请阅读[`related_name`定义关系](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.related_name)(`ForeignKey`和`ManyToManyField`) 时的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:00:18.300

如前所述，您在实际定义模型（Post）之前已经引用了它——Python 文件中的定义顺序很重要[。](https://stackoverflow.com/questions/5618720/django-nameerror-during-manytomany-field-referencing)

为了解决这个问题，让 Django 解析该名称而不是 Python，方法是用单引号括起来：

`posts = models.ManyToManyField('Post')`

# c++ - 使用“struct”关键字进行结构实例化

> ID：12774135
> 
> 赞同：5
> 
> 时间：2012-10-08T00:52:36.417
> 
> 标签：c++, struct, keyword, declaration, instantiation

假设我声明了一个新的 C++ 结构类型：

```
struct my_struct {
   int a;
   int b;
}; 
```

我可以通过以下方式创建此结构类型的新实例：

```
my_struct foo; 
```

或者

```
struct my_struct foo; 
```

如果两者都有效，有什么区别吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-08T00:55:05.970

是的，您可以使用任何一种方法。不同的是这种形式：

```
my_struct foo; 
```

在 C 中是不合法的，所以你必须使用这种形式：

```
struct my_struct foo; 
```

C++ 支持它以向后兼容 C。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T00:56:55.200

两者都有效。第二个起作用的主要原因是与 C 的兼容性：在 C 中，第一个不起作用。因此，`struct`s 通常在 C 中编辑，并且s 和s`typedef`有两种不同的名称。`struct``typedef`

# iphone - 带有 Web 服务的 iPhone 和 HMAC-SHA1

> ID：12774136
> 
> 赞同：1
> 
> 时间：2012-10-08T00:53:11.483
> 
> 标签：iphone, web-services, xcode4, hmacsha1

这是我关于stackoverflow的第一个问题，所以请温柔。我正在与我的 iphone 应用程序中的网络服务进行通信，并且需要验证我对主机的请求。我需要做的是获取 url ex。“GET [http://api.host.com/](http://api.host.com/) ”连同一个通过类运行它并生成 HMAC-SHA1 哈希以验证我的身份的密钥。我在stackoverflow上尝试了一些例子，但我没有找到任何对我有用的例子。我得到了 .NET 类的示例代码，它可以完成我需要它做的事情，现在我需要类似的东西，它可以在 Xcode 中用于 iphone 应用程序。这是 NET 示例代码：

```
public static void CalculateUrlDigest(string url, string secretKey) 
    { 
        byte[] utf8Key = Encoding.UTF8.GetBytes(secretKey); 
        byte[] utf8Message = Encoding.UTF8.GetBytes(url); 
        HMACSHA1 crypto = new HMACSHA1(); 
        crypto.Key = utf8Key; 
        byte[] hash = crypto.ComputeHash(utf8Message); 

        Console.WriteLine("Base64: " + Convert.ToBase64String(hash)); 
    } 
```

因此，如果有人可以帮助我为 Xcode 提供类似的类/功能，那就太好了。

此致

哈坎

# mysql - 我的查询有什么问题（非常慢）？

> ID：12774137
> 
> 赞同：1
> 
> 时间：2012-10-08T00:53:17.223
> 
> 标签：mysql, sql, performance

以下查询在大约 50 万行的表上执行需要 20 多秒：

```
SELECT images.id, images.user_id, images_locale.filename, extension, size, width, height, views, batch, source, status, images.created_at, images.category_id, title, short_description, long_description, alternate, slugs.name as slug, images_locale.slug_id, path_cache AS category_path, full_name, users.username
FROM images
JOIN images_locale ON images_locale.image_id = images.id JOIN slugs ON images_locale.slug_id = slugs.id JOIN categories_locale ON images.category_id = categories_locale.category_id JOIN users ON users.id = images.user_id
WHERE slugs.name = 'THE_SLUG_HERE' AND images.status = '1' AND images_locale.locale_id = 1 AND categories_locale.locale_id = 1
LIMIT 1 
```

现在，当我删除时，`slugs.name = 'THE_SLUG_HERE' AND`我会在几毫秒内得到结果。

这是我的 slug 表：

```
CREATE TABLE `slugs` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(250) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '',
  `type` tinyint(4) NOT NULL,
  `locale_id` smallint(6) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=3611900 DEFAULT CHARSET=utf8; 
```

我尝试过，`CREATE INDEX test_speed ON slugs(name)`但它并没有加快速度。

请帮忙。

**编辑：**

以下是 EXPLAIN 的结果：

![<code>EXPLAIN</code> 的结果](../Images/46f53ae3be8a151cda45c7373de3fc4e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:23:05.650

将所有条件移到`ON`连接子句中：

```
SELECT ...
FROM images
JOIN images_locale ON images_locale.image_id = images.id
    AND images_locale.locale_id = 1
JOIN slugs ON images_locale.slug_id = slugs.id
    AND slugs.name = 'THE_SLUG_HERE'
JOIN categories_locale ON images.category_id = categories_locale.category_id
    AND categories_locale.locale_id = 1
JOIN users ON users.id = images.user_id
WHERE images.status = '1' 
LIMIT 1 
```

这样做的原因是`WHERE`子句过滤了*所有*可能的连接的结果，但是如果将条件移动到`ON`子句中，就可以避免为您*已经知道*不需要的行连接所有下表。

这可以避免进行*数百万*次不必要的连接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T01:03:20.943

尝试更改您的连接顺序。从解释结果可以看出，索引只能将images表切割到1.4k条记录。所以你的关节是从那个数字开始的。也许您可以使用 slug 表（我假设名称是唯一的）开始连接，然后将名称条件过滤器放入连接的 on 部分。

您可能还想研究复合键，以便所有使用的字段都可以在索引中。键扫描比文件扫描快。

最后，看看你的mysql是如何配置的。是否使用临时表进行查询。或者最糟糕的是，基于磁盘的临时表。

很难说因为我们不知道您数据库的全部范围。例如，所有表的大小、为键设置的缓冲区数量、排序缓冲区等。

# vim - VIM solarized 中奇怪的背景颜色变化

> ID：12774141
> 
> 赞同：4
> 
> 时间：2012-10-08T00:53:54.537
> 
> 标签：vim, terminal, syntax-highlighting, color-scheme, vim-syntax-highlighting

我不知道如何准确描述这个问题，但是在终端 vim 中使用 solarized colorscheme 主题时，我注意到当我编辑一些文本时，不同的行尾（不是“行尾”，而是从最后一个字母到缓冲区的末尾）将被突出显示。例如，一旦我使用`<C-e>`, 或移动`<C-y>`，奇怪的突出显示会自行修复并成为背景颜色。

理想情况下，我想解决这个问题，只是让我的背景始终是背景色。但是，任何关于正在发生的事情/被突出显示的见解都将受到高度赞赏。

谢谢，

****在按下****后刚​​刚编辑文本之后**![带有奇怪的突出显示](../Images/bbbfc17bb6695baa4b331bf763cdda49.png) **`<C-e>`** ![在此处输入图像描述](../Images/eab67d5a347914532399214dbfe4c522.png)**

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-07T19:17:38.520

[如此处所述](http://snk.tuxfamily.org/log/vim-256color-bce.html)，通过清除终端选项（在 Vim 中运行，然后按+刷新终端显示）禁用**背景颜色擦除**(BCE)，以便在 tmux 和 GNU 屏幕中使用 Vim 时颜色方案正常工作。`t_ut``:set t_ut=``Control``L`**

# php - 如何使用 foreach 循环动态执行 mysql 查询？

> ID：12774142
> 
> 赞同：0
> 
> 时间：2012-10-08T00:53:59.820
> 
> 标签：php, mysql, arrays, variables, foreach

我正在做一个简单的数据库构建器函数，它需要一个问题 id、4 个选项一个 id 和一个计数变量。

我要做的就是在 foreach 中，获取选项并对所有单独的选项变量执行 mysql_query() 。如您所见，我已将它们放在一个数组中，因此我可以在 foreach 中循环它们。

我认为 $var 变量，即选项值正在处理错误。mysql返回给我的错误是：

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在 'option, order) VALUES ('e3397df9241278bfcad1945420398baa817acd7a', '005e913c9c1a' at line 1'附近使用

这是我的代码：

```
$question_id = $_POST['question_id'];
$option1 = $_POST['option_1'];
$option2 = $_POST['option_2'];
$option3 = $_POST['option_3'];
$option4 = $_POST['option_4'];

$vars = array($option1, $option2, $option3, $option4);

$count = 1;
foreach ($vars as $var){

    $id = sha1(microtime());
    echo "ID: ".$id."<br/>Q ID: ".$question_id."<br/>Option: ".$var."<br/>Order: ".$count."<br/><br/>";

    $result = mysql_query("INSERT INTO question_options (id, question_id, option, order) VALUES ('$id', '$question_id', '$var', '$count') ") or die(mysql_error());
    $count++;
} 
```

如果你能帮助我告诉我哪里出了问题，我真的很感激。干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T00:58:44.007

Order 是一个 MySQL 关键字。你需要逃避它：

```
$result = mysql_query("INSERT INTO question_options (`id`, `question_id`, `option`, `order`) VALUES ('$id', '$question_id', '$var', '$count') ") or die(mysql_error()); 
```

你也应该看看 MySQLi 或 PDO 来参数化你的查询。这些`mysql_`功能已弃用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:01:01.810

术语`option`和`order`是 MySQL 的特殊名称。

请改用以下语句：

```
$result = mysql_query("INSERT INTO question_options (id, question_id, `option`, `order`) VALUES ('$id', '$question_id', '$var', '$count') ") or die(mysql_error()); 
```

# ios - 如何在 iOS 中通过经过身份验证的 url 下载文件？

> ID：12774150
> 
> 赞同：1
> 
> 时间：2012-10-08T00:55:19.147
> 
> 标签：ios, authentication, download, nsurlconnection, nsdata

我正在使用 NSURLConnection 通过 https 进行身份验证，效果很好，但是使用 NSData 下载文件时，我无法访问内容。如何通过经过身份验证的 url 下载文件？

**这是我试图读取下载文件内容的地方（此处未包含身份验证代码），服务器显示“用户未授权”：**

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {

 NSFileManager *fileManager = [NSFileManager defaultManager];

            // Attempt to open the file and write the downloaded data to it
          if (![fileManager fileExistsAtPath:documentsDirectory2]) { //download path
                [fileManager createFileAtPath:documentsDirectory2 contents:nil attributes:nil];
            }
            // Append data to end of file
            NSFileHandle *fileHandle = [NSFileHandle fileHandleForWritingAtPath:documentsDirectory2];
            [fileHandle seekToEndOfFile];
            [fileHandle writeData:data];
            [fileHandle closeFile];

            //data.txt exists, read me its content
            NSArray *paths8 = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
            NSString *documentsDirectory8 = [paths8 objectAtIndex:0];
            NSString *filePath8 = [documentsDirectory8 stringByAppendingPathComponent:@"data.txt"];
            NSString *content8 = [NSString stringWithContentsOfFile:filePath8 encoding:NSUTF8StringEncoding error:NULL];
            NSLog(@"WHATS INSIDE DATA.TXT? =%@", content8);

            [self.responseData appendData:data];
           } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:23:52.743

在实现 NSURLConnectionDelegate 时，您需要使用 NSURLCredential 进行身份验证。

这是一个例子：

```
-(BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace
{
    return YES;
}

-(void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
    NSURLCredential *credential = [NSURLCredential credentialWithUser:username
                                                             password:passwd]
                                                             persistence:NSURLCredentialPersistenceForSession];

    [[challenge sender] useCredential:credential forAuthenticationChallenge:challenge];
} 
```

# c# - 在网格视图中显示图像

> ID：12774151
> 
> 赞同：1
> 
> 时间：2012-10-08T00:55:43.037
> 
> 标签：c#, asp.net

在 gridview 控件中显示数据库中的图像期间，发生以下错误：`Parameter is not valid`

以下代码显示图像：

```
 var id = Convert.ToString(user_id);

        var category = (from data in db.Register1_db
                        where (data.User_ID == id)
                       select ( data.Student_Photo));

        int len = category.First().Length;
        // Output the binary data          
        // But first we need to strip out the OLE header          
        int OleHeaderLength = 78;
        int strippedImageLength = len - OleHeaderLength;
        byte[] imagdata = new byte[strippedImageLength];          
        Array.Copy(category.First().ToArray(), OleHeaderLength, imagdata, 0, strippedImageLength);          
        if ((imagdata) != null)          
        {              
            MemoryStream m = new MemoryStream(imagdata);

                //error occurred               
            System.Drawing.Image image = System.Drawing.Image.FromStream(m);              
            image.Save(context.Response.OutputStream, ImageFormat.Jpeg);          
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:08:44.037

在网格视图中显示图像的更好方法是使用图像处理程序。 [检查这个](https://stackoverflow.com/questions/21877/dynamically-rendering-aspimage-from-blob-entry-in-asp-net)

# heroku - Heroku 维护页面上的链接不起作用

> ID：12774155
> 
> 赞同：1
> 
> 时间：2012-10-08T00:56:14.023
> 
> 标签：heroku, maintenance-mode

当我发布我们的维护页面时，我包含了一些与我们联系的链接，一个指向我们的 twitter 提要以了解更多详细信息等的链接。但是，我只是注意到（至少在 chrome 中）这些链接没有打开。这显然是由于页面托管在 iframe 中。

控制台中显示以下错误： `Refused to display document because display forbidden by X-Frame-Options.`

正如heroku 所建议的，我们在S3 上托管我们的维护页面。这限制了我们修改标题等的能力。关于如何使这些链接工作的任何建议？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T01:42:05.790

我认为您的问题可能与链接响应中的标题有关。

[https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header](https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header)

我不知道 Heroku 是默认使用这些标头配置服务器还是您的应用程序添加了它们。但至少，你有一些东西可以咀嚼。

！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T08:09:32.103

我刚刚遇到了同样的问题。我使用 target='_blank' 解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T21:35:46.470

您可以将`target`每个锚标记上的属性设置为“_parent”，以便在父框架中打开链接：

```
<a target="_parent" href="http://example.com">click here</a> 
```

或者，您可以在页面头部使用`base`标签来定义页面`target`中所有链接的属性：

```
<base target="_parent"> 
```

# java - 关于在读取调用中使用偏移量的说明

> ID：12774162
> 
> 赞同：0
> 
> 时间：2012-10-08T00:57:40.503
> 
> 标签：java, inputstream

我发现此代码是为了将文件编码为 base64。它正在使用偏移量。

```
File filePath = new File("/sdcard/videooutput.mp4");
try{
    FileInputStream fin=new FileInputStream(filePath);
    long length = filePath.length();
    // Create the byte array to hold the data
    byte[] bytes = new byte[(int)length];
    // Read in the bytes
    int offset = 0;
    int numRead = 0;
    while (offset<bytes.length && (numRead=fin.read(bytes, offset, bytes.length-offset))>=0){
        offset += numRead;
    }
    // Ensure all the bytes have been read in
    if (offset < bytes.length) {
    throw new IOException("Could not completely read file "+filePath.getName());
}

Base64.encodeToString(bytes, Base64.DEFAULT); 
```

我不明白这段代码的是`while (offset < bytes.length && (numRead=fin.read(bytes, offset, bytes.length-offset)) >= 0)`.

谁能解释代码试图做什么？我只了解它检查偏移量是否小于字节长度，其余的我不确定。

我的下一个问题是，使用偏移量对文件进行编码的原因是什么？

[关于这个问题的任何答案都会非常有帮助。很抱歉问这种类型的问题，但我真的需要理解这段代码。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:03:40.203

[输入流#read()](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html#read%28byte%5B%5D,%20int,%20int%29)

`int numRead=fin.read(bytes, offset, bytes.length-offset)`

read 填充给定的字节数组，从给定的偏移量开始，填充给定数量的字节。但是，即使您请求 100 个字节，也不能保证您会得到它们。所以这段代码基本上是在每次调用 read() 后增加偏移量。

初始调用将尝试完全填充 byte[]。如果失败，它将偏移量向前移动成功复制的字节数，并尝试从新偏移量开始填充 byte[]。每次新尝试它只尝试读取足够的内容以填充缓冲区中剩余的内容。

# c - atoi(s) 和主要参数的问题。C

> ID：12774169
> 
> 赞同：0
> 
> 时间：2012-10-08T00:59:21.193
> 
> 标签：c, command-line-arguments, main, atoi

我在使用 atoi(s) 函数时遇到了一些问题。我正在尝试将命令行参数转换为整数，但是我从 atoi 函数接收到的整数表现得很奇怪。我检查了持有转换的变量，它们持有正确的整数，但是当它们通过我的程序运行时，它们不能正常工作。该程序接受三个参数；程序本身、函数编号 (1-3) 和任意整数。例如，命令行指令看起来像 lab4p2 3 10。

职能：

```
#include <stdio.h>
#include <stdlib.h>

//---------------------------------------------------------------------------
// Functions

// Sumation function adds all integers from 1 to the value.
int sumation(int x)
{
  int counter = 1;
  int value;
  while (counter < (x+1))
    {
      value += counter;
      counter++;
    }
  return value;
}

// Negation function returns the negation of the given value.
int negation(int x)
{
  int negator, value;

  negator = (x*2);
  value = (x - negator);
  return value;
}

// Square function returns the square of the input value.
int square(int x)
{
  int value;
  value = (x*x);
  return value;
}

//--------------------------------------------------------------------------- 
```

主要的：

```
main(int argc, char *argv[])
{

  int inputval, functionval, value;
  double doubleval;

  functionval = atoi(argv[1]);

  inputval = atoi(argv[2]);
  doubleval = atof(argv[2]);

  printf("%i", functionval);
  printf("%i", inputval);

  if(argc != 3)
    {
      printf("%s", "Invalid amount of arguments! 3 expected. \n");
    }
  else if ((functionval < 1)||(functionval > 3))
    {
      printf("%s", "Invalid function value. Expected values: 1-3 \n");
    }
  else if (inputval != doubleval)
    {
      printf("%s", "Invalid value! Integer expected. \n");
    }
  else if (functionval = 1)
    {
      value = sumation(inputval);

      printf("%s", "The sum from 1 to the input value = ");
      printf("%d", value);
    }
  else if (functionval = 2)
    {
      value = negation(inputval);

      printf("%s", "%d", "The negation of the input value = ", value);
    }
  else if (functionval = 3)
    {
      value = square(inputval);

      printf("%s", "%d", "The square of the input value = ", value);
    }
  else
    {
      printf("%s", "Something is wrong!");
    }

} 
```

所有的错误检查都正常工作，但函数 2 和 3 永远不会被访问（尽管输入）并且函数 1 显示不正确的答案。有谁知道问题可能是什么？

谢谢，马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T01:01:40.333

```
functionval = 1    assignment

functionval == 1   comparison 
```

~~顺便说一句，当你得到 doubleval 时也有一个错字~~ 现在我看到再次使用 argv[2] 和不同的转换函数是故意的，而不是 argv[3] 的错字，我建议如果你关心转换错误，你使用类似的东西：

```
errno = 0;
char* endptr;
long value = strtol(argv[2], &endptr, 10);
if (errno == ERANGE) {
  // Value was too big or too negative
} else if (endptr == argv[2] || errno == EINVAL) {
  // Not a number
} else if (endptr[0] != '\0') {
  // trailing characters.
}
// Value is OK. 
```

如果你经常使用它，它值得包装成更容易调用的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:03:27.477

```
else if (functionval = 1)
else if (functionval = 2)
else if (functionval = 3) 
```

应该

```
else if (functionval == 1)
else if (functionval == 2)
else if (functionval == 3) 
```

否则，您将执行分配而不是比较。

# html - 如何正确垂直对齐这些共享按钮？

> ID：12774172
> 
> 赞同：0
> 
> 时间：2012-10-08T01:01:20.703
> 
> 标签：html, css, facebook, twitter, google-plus

我在这里为我们做了一个测试用例：[http ://www.ranksland.com/align.html](http://www.ranksland.com/align.html)

我一直在尽我所能，但没有成功，有没有经验丰富的人解决这个难题？

# fonts - 如何将标准字体转换为网络字体

> ID：12774178
> 
> 赞同：2
> 
> 时间：2012-10-08T01:01:43.737
> 
> 标签：fonts, webfonts, google-font-api

是否可以采用标准字体`.ttf`并制作像 Google Web Fonts 这样的网络字体，嵌入到网页中？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T19:28:35.670

我已经构建[了一个名为 Fontie 的简单 webfont 生成器](https://fontie.pixelsvsbytes.com/webfont-generator)，这可能是您正在寻找的。

Fontie 获取一个 OTF 或 TTF 文件并为您生成一个 webfont-package，其中包含您在网站上使用字体所需的一切（所需的字体文件、CSS 等）。它甚至会做一些额外的工作来确保您的字体在任何浏览器中看起来都不错。如果您想详细了解它在做什么，您应该阅读[我在 Pixels vs. Bytes 上关于如何创建 webfonts 的帖子](http://pixelsvsbytes.com/2013/11/how-to-create-perfect-web-fonts-in-3-steps/)。

*PS：我知道链接到我自己的网站不会在这里受到赞赏，但我认为我的工具是解决问题的好方法，所以我还是发布了它。如果您希望我删除此帖子，请发表评论，我会这样做。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T09:44:29.873

WOFF（Web 开放字体格式 - 有关详细信息，请参阅 wikipedia）文件可以创建为 TTF 文件的包装器，然后作为 Web 字体托管。

首先，您必须确保您有权重新分发 TTF。

如果它是您自己的字体并且您特别想将其添加到 google 字体中，您可以在[http://code.google.com/p/googlefontdirectory/](http://code.google.com/p/googlefontdirectory/)提交它。Google Web Fonts 是一个开源项目。

源代码应包含用于将 TTF 文件与元数据打包以创建 WOFF 网络字体的工具。还有一个很棒的论坛，您可以在其中找到有关所涉及内容的更多信息：

[https://groups.google.com/forum/?fromgroups#!forum/googlefontdirectory-discuss](https://groups.google.com/forum/?fromgroups#!forum/googlefontdirectory-discuss)

开发者 API 是一个非常有用的资源，在 google 上搜索网络字体开发者 api。

网络字体机制不限于开源，相信您可以使用它来分发专有字体。例如，查看允许自定义/专有提供程序的 web 字体加载器 github 项目。

# sql - 一个子句从属于另一个子句的 SQL 选择

> ID：12774181
> 
> 赞同：0
> 
> 时间：2012-10-08T01:02:00.333
> 
> 标签：sql, database, sqlite, select

我有一个四分卫统计表。表中的每一行代表一个 QB 在一场比赛中的表现。每行的唯一 ID 称为 gameId，由玩家 ID 和游戏日期组成。

我想要做的是使用 select 语句生成表中所有独特四分卫的列表，他们至少完成了一次。

我试图用这个语句来做到这一点：

```
SELECT * FROM swdata
WHERE gameComp > 0 AND gameId IN (
   SELECT MAX(gameId) FROM swdata GROUP BY playerId)
ORDER BY playerLastName 
```

第一个子句是 gameComp > 0，第二个子句是从列表中筛选出独特的四分卫。

我想要发生的是运行第一个子句，然后在第一个子句的结果上运行第二个子句。

但实际发生的是它们同时运行，这导致结果中省略了一些玩家。

所以，我知道我的结构是错误的。任何人都可以帮我做对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:07:03.583

如果您想要唯一的 playerIds，以下方法不起作用吗？

```
select distinct playerId
from swdata
where gamecomp > 0 
```

如果您想要多于一列，则使用以下查询连接回原始表：

```
select s.*
from swdata s join
     (select playerId, max(gameId) as maxgameId
      from swdata
      group by playerId
     ) m
     on s.gameId = maxgameId 
```

这是为了回答您关于`distinct`. distinct 返回 select 子句中所有内容的不同值。因此，以下是等价的：

```
select distinct playerID, playerLastName, playerFirstName
from swdata 
```

和

```
select playerID, playerLastName, playerFirstName
from swdata
group by playerID, playerLastName, playerFirstName 
```

这两个都返回数据中出现的三列的所有唯一组合。

# xamarin.ios - Monotouch MTSplitViewController 取消选择行

> ID：12774189
> 
> 赞同：0
> 
> 时间：2012-10-08T01:05:54.070
> 
> 标签：xamarin.ios

我已经用 MTSplitViewController 替换了 UISplitViewController，除了一个问题外，效果很好。

在主视图上，我有导航控制器，一旦选择，我希望该行保持选中状态，例如蓝色，以便用户可以看到当前项目详细信息视图所属的。

我可以使用 Apple 的 UISplitViewController 轻松地做到这一点，方法是覆盖 Selected 方法而不是 base.Selected 如果 iPad：

```
 public override void Selected (DialogViewController dvc, UITableView tableView, NSIndexPath indexPath)
    {
        if (AppDelegate.IsPhone) 
            base.Selected (dvc, tableView, indexPath);
    } 
```

由于某种原因，相同的代码不适用于 MTSplitViewController，我不知道为什么。我研究了它的代码，但不明白为什么会这样。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:37:52.573

只花了我半天的时间就知道发生了什么，所以希望它能节省别人的时间:)

在您的主视图集中：

```
ClearsSelectionOnViewWillAppear = false; 
```

在 Xcode 中创建 Master/Detail 项目时发现了这一点。

# java - 如何编写适用于套件或类级别的 Junit 设置功能？

> ID：12774190
> 
> 赞同：2
> 
> 时间：2012-10-08T01:06:01.903
> 
> 标签：java, junit, categories

我已经`@BeforeClass`为测试套件运行了设置，如下所示：

```
@RunWith(Categories.class)
@IncludeCategory(IntegrationTest.class)
.
.
.
public class IntegrationTestSuite {
    @BeforeClass
    public static void initialise() throws Exception {
        // Integration test-specific config.
    }
} 
```

当我在套件中运行所有测试时，这很有效。但是，当我运行单个测试时，显然这些东西不会被执行。有没有更优雅的方法可以让我在测试用例级别重用测试类别设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T11:09:03.003

考虑创建一个只执行一次初始化的自定义规则（可能使用[ExternalResourse ）。](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/ExternalResource.html)使用一个测试为其他测试初始化​​的机制是一种反模式。它太脆弱了，因为它取决于测试运行的顺序，并且在只运行一个测试时也会失败。我认为该`@Rule`机制是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:58:45.627

我建议使用全局标志作为静态上下文或在属性文件中：

```
public static boolean runTestCaseStandAlone = false; 
```

或者

```
boolean runTestCaseStandAlone = properties.get("run.test.case.alone"); 
```

将测试套件方法更新为：

```
public class IntegrationTestSuite {
 @BeforeClass
 public static void initialise() throws Exception {
   if(!GLOBALCONTEXT.runTestCaseStandAlone){
       // Integration test-specific config.
   }
  }
 } 
```

为您的测试用例创建一个基类，例如

```
public class BaseTest ....
 @BeforeClass
 public static void initialise() throws Exception {
   if(GLOBALCONTEXT.runTestCaseStandAlone){
       // Integration test-specific config.
   }
  } 
```

确保您所有的个人测试用例都扩展了上述基类。

# java - NullPtrException Java 在 Map 中使用枚举

> ID：12774192
> 
> 赞同：0
> 
> 时间：2012-10-08T01:06:18.467
> 
> 标签：java

我正在尝试另一种方法来处理我已经拥有的一些代码，但我发现这些代码并不优雅，并且遇到了这个异常。我真的不明白发生了什么，我对 Java 还是很陌生。

如果代码有点多，我很抱歉，但我认为我不能削减更多。异常在 的第一行引发`Initialize()`。

这是确切的错误消息：

> 在simulationia.CritterInfo.Initialize(Critter.java:35) 在simulationia.SimulationIA.main(SimulationIA.java:21) 的线程“主” java.lang.NullPointerException 中的异常

第 35 行是`Initialize()`. SimulationIA 的第 21 行是对`Initialize()`.

```
// Critter.java
class CritterInfo { 
    static private Map<Object, String> enum_desc;

    public enum CRITTER_TYPE { CT_HERBIVORE, CT_CARNIVORE }
    public enum CRITTER_STATE { CS_FULL, CS_HUNGRY, CS_STARVING, CS_DEAD }

    /* ... */

    static void Initialize() {
        enum_desc.put((Object)CRITTER_TYPE.CT_HERBIVORE,    "Herbivore");
        enum_desc.put((Object)CRITTER_TYPE.CT_CARNIVORE,    "Carnivore");
        enum_desc.put((Object)CRITTER_STATE.CS_FULL,        "Full");
        enum_desc.put((Object)CRITTER_STATE.CS_HUNGRY,      "Hungry");
        enum_desc.put((Object)CRITTER_STATE.CS_STARVING,    "Starving");
        enum_desc.put((Object)CRITTER_STATE.CS_DEAD,        "Dead");
    }

    /* ... */
} 
```

另一个文件...

```
// SimulationIA.java
public class SimulationIA {
    public static void main(String[] args) {
        /* ... */

        CritterInfo.Initialize();

        /* ... */
    }
} 
```

基本上我想要做的是有一个单一的地图来保存所有枚举值，而不关心它的类型并且必须检查`instanceof`. 也许这只是不可行。

编辑：我认为这可能与我不使用实际对象的事实有关，只使用枚举的值，因此它抱怨空指针。那正确吗 ？我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T01:08:23.067

你永远不会创建地图，所以`put`在`null`.

您应该执行以下操作（例如）：

```
static private Map<Object, String> enum_desc = new HashMap<Object, String>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:18:51.063

根据您的评论，“我只想让文本描述与每个枚举值匹配”：

您可以利用 Java 的枚举：

```
public enum Enum {

    DOG("Dogs are cool"),
    CAT("Dogs are better"),
    GOAT("Free milk");

    private final String desc;

    private Enum(String desc) {
        this.desc = desc;
    }

    public String getDesc() {
        return desc;
    }    

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T01:20:02.133

让我们从基本...

```
public enum CRITTER_TYPE { CT_HERBIVORE, CT_CARNIVORE }
public enum CRITTER_STATE { CS_FULL, CS_HUNGRY, CS_STARVING, CS_DEAD }

public static void main(String[] args) {
    for (CRITTER_TYPE type : CRITTER_TYPE.values()) {
        System.out.println(type);
    }
} 
```

将输出

```
CT_HERBIVORE
CT_CARNIVORE 
```

所以我们知道 an`enum`将`enum`通过它的`toString`方法输出“名称”。

很高兴知道这一点，因为您可以使您`enum`的 s 具有描述性。

如果这还不够好（不支持空格，或者您想要更友好的东西），您可以执行类似...

```
public enum CRITTER_TYPE {
    CT_HERBIVORE("Herbivore"),
    CT_CARNIVORE("Carnivore");

    private String description;
    private CRITTER_TYPE(String desc) {
        description = desc;
    }

    public String getDescription() {
        return description;
    }

}

public static void main(String[] args) {
    for (CRITTER_TYPE type : CRITTER_TYPE.values()) {
        System.out.println(type.getDescription());
    }
} 
```

哪个输出

```
Herbivore
Carnivore 
```

`enum`在 Java 中是一种特殊类型的对象，您可能希望阅读[Enum Types](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)以获取更多信息

# sql - SQL MAX 命令仍然返回多个结果

> ID：12774196
> 
> 赞同：3
> 
> 时间：2012-10-08T01:07:15.677
> 
> 标签：sql, sql-server, tsql

我让这个 SQL 查询工作得很好。我对数据库做了一些小改动，然后重新运行它，它就停止了工作。

`master_followups`我的目标是加入`followups_fb_messages.message_text`但只为每个 UID 返回一行，`master_followups`其中最近`followups_fb_messages.message_text`加入了它。

```
SELECT master_followups.*, 
  followups_fb_messages.message_text, 
  followups_fb_messages.message_time 
FROM
  master_followups 
  LEFT JOIN followups_fb_messages 
    ON master_followups.UID = followups_fb_messages.FID 
    AND followups_fb_messages.message_time = 
      (SELECT
        MAX(followups_fb_messages.message_time) 
        FROM followups_fb_messages 
        WHERE  followups_fb_messages.FID = master_followups.UID
      ) 
```

我一直试图弄清楚过去一个小时发生了什么。

这不是按预期返回 100 个结果，而是返回 340。我检查了数据库，它显示 100 行 in`master_followups`和 340 行 in `followups_fb_messages`。

大约一个小时前，我有这个确切的查询工作正常，然后它停止了。也许我改变了一些东西，但我看不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:18:05.143

据推测，您得到重复的原因是不止一行具有最大消息时间。这是解决此问题的一种方法：

```
 SELECT master_followups.*, 
        ffm.message_text, 
        ffm.message_time 
FROM master_followups LEFT JOIN
     (select *, row_number() over (partition by fid order by message_time desc) seqnum
      from followups_fb_messages
     ) ffm 
     ON master_followups.UID = ffm.FID and
        seqnum = 1 
```

这会根据 message_time 找到最大行，但如果有重复则只选择一行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:13:19.650

试试这个。

```
SELECT  a.*, 
        b.*
FROM    master_followups a
        LEFT JOIN followups_fb_messages b
            ON a.UID = b.FID
        LEFT JOIN 
        (
            SELECT  FID, MAX(message_time) maxTime
            FROM    followups_fb_messages
            GROUP BY FID
        ) c ON b.FID = c.FID AND
                b.message_TIME = c.maxTime 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T01:26:25.677

约翰的答案略有修改呢？

```
SELECT  a.*, 
        b.*
FROM    master_followups a
    LEFT JOIN followups_fb_messages b
        ON (b.FID = c.FID AND b.message_time = c.maxTime)
    LEFT JOIN 
    (
        SELECT  FID, MAX(message_time) maxTime
        FROM    followups_fb_messages
        GROUP BY FID
    ) c ON a.UID = c.FID 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T01:24:43.367

让我们使用一些 TDQD — 测试驱动的查询设计。

### 每个ID最近的后续消息时间

```
SELECT FID, MAX(message_time) AS MostRecent
  FROM followups_fb_messages
 GROUP BY FID 
```

### 每个 ID 的最新后续消息信息

```
SELECT a.*
  FROM followups_fb_messages AS a
  JOIN (SELECT FID, MAX(message_time) AS MostRecent
          FROM followups_fb_messages
         GROUP BY FID
       ) AS b ON a.FID = b.FID AND a.message_time = b.MostRecent 
```

请注意，这是一个常规的内连接，而不是外连接。

### 掌握跟进信息和跟进消息信息

```
SELECT m.*, f.message_text
  FROM master_followups AS m
  LEFT JOIN
       (SELECT a.FID, a.message_text
          FROM followups_fb_messages AS a
          JOIN (SELECT FID, MAX(message_time) AS MostRecent
                  FROM followups_fb_messages
                 GROUP BY FID
               ) AS b ON a.FID = b.FID AND a.message_time = b.MostRecent
       ) AS f ON f.FID = m.UID 
```

# c# - 使用 Booksleeve 执行 ZINTERSTORE 的选项？

> ID：12774203
> 
> 赞同：1
> 
> 时间：2012-10-08T01:09:30.483
> 
> 标签：c#, redis, booksleeve

我一直在使用 Booksleeve 作为我在 C# 中的 redis 驱动程序，并且对它非常满意 - 但我遇到了对排序集进行一些工作的需要。似乎这些在 Booksleeve 中只得到最低限度的支持——例如，没有像 ZUNIONSTORE 或 ZINTERSTORE 这样的命令的实现。

我[在 Github 上找到了 scobrown 的 Booksleeve 分支，](https://github.com/scobrown/Booksleeve)它声称已经实现了这些操作，但我一直在使用 NuGet 的“官方”包，我不确定是否要切换到另一个分支。

有没有人有使用这个叉子的经验？它对于生产代码是否足够稳定和可靠？

否则，有没有人想出任何其他解决方法来需要在排序集上做交叉或联合之类的事情？我一直在做类似以下的事情：

```
var set = await conn.SortedSets.Range(db, firstSet, 0, -1);
set = set.Intersect(await conn.SortedSets.Range(db, secondSet, 0, -1));
set = set.Intersect(await conn.SortedSets.Range(db, thirdSet, 0, -1)); 
```

这有一个明显的缺点，即需要一次检索一个集合的全部内容，并使用 .NET 执行交集，`IEnumerable<>.Intersect()`而不是在 redis 中执行。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T09:08:18.053

我已合并到[johanalkemad 的分支](http://code.google.com/r/johanalkemade-booksleeve/source/list)中，其中包括`SortedSets.UnionAndStore`和`SortedSets.IntersectAndStore`. Build 1.1.0.9 已推送到 NuGet。

# python - 如何禁用 Matplotlib 中的键盘快捷键？

> ID：12774206
> 
> 赞同：15
> 
> 时间：2012-10-08T01:10:03.883
> 
> 标签：python, matplotlib

我正在 matplotlib 中处理一些事件。特别是'key_press_event'。但是预定义的键盘快捷键妨碍了我。有没有办法关闭这些？

他们说我可以通过使用“matplotlibrc (#keymap.*)”来覆盖这些键。但我不明白他们指的是什么，我还没有找到任何进一步的解释。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-08T01:23:28.557

您可以在`plt.rcParams`字典中修改。例如，禁用“save figure”按钮的“s”键盘快捷键：

```
>>> plt.rcParams['keymap.save']
['s', 'ctrl+s']
>>> plt.rcParams['keymap.save'].remove('s') 
```

如果您希望更改全局/永久应用，请在`matplotlibrc`文件中编辑并重新启动 Python 解释器。您可以通过调用辅助函数找到系统上配置文件的位置：

```
>>> matplotlib.matplotlib_fname()
'/Users/wim/.matplotlib/matplotlibrc' 
```

*注意：在旧版本的 matplotlib 中，键映射绑定是字符串而不是列表。如果您卡在旧版本上，您可以将值设置为空字符串，而不是调用 remove。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-07T03:13:47.433

请参阅[https://matplotlib.org/users/customizing.html](https://matplotlib.org/users/customizing.html)，了解您可以与上述方法一起使用的所有键盘映射关键字**plt.rcParams['keymap.*']**

# c++ - 使用标准 C++/C++11、14、17/C 检查文件是否存在的最快方法？

> ID：12774207
> 
> 赞同：563
> 
> 时间：2012-10-08T01:10:11.103
> 
> 标签：c++, c, file, stream

我想找到最快的方法来检查标准 C++11、14、17 或 C 中是否存在文件。我有数千个文件，在对它们进行操作之前，我需要检查它们是否都存在。我可以写什么而不是`/* SOMETHING */`在以下函数中？

```
inline bool exist(const std::string& name)
{
    /* SOMETHING */
} 
```

* * *

## 回答 #1

> 赞同：928
> 
> 时间：2012-10-08T01:43:22.110

好吧，我拼凑了一个测试程序，将这些方法中的每一个运行了 100,000 次，一半在存在的文件上，一半在不存在的文件上。

```
#include <sys/stat.h>
#include <unistd.h>
#include <string>
#include <fstream>

inline bool exists_test0 (const std::string& name) {
    ifstream f(name.c_str());
    return f.good();
}

inline bool exists_test1 (const std::string& name) {
    if (FILE *file = fopen(name.c_str(), "r")) {
        fclose(file);
        return true;
    } else {
        return false;
    }   
}

inline bool exists_test2 (const std::string& name) {
    return ( access( name.c_str(), F_OK ) != -1 );
}

inline bool exists_test3 (const std::string& name) {
  struct stat buffer;   
  return (stat (name.c_str(), &buffer) == 0); 
} 
```

运行 100,000 次调用的总时间结果平均超过 5 次运行，

| 方法 | 时间 |
| --- | --- |
| `exists_test0`（如果流） | **0.485s** |
| `exists_test1`（文件打开） | **0.302s** |
| `exists_test2`（posix 访问（）） | **0.202s** |
| `exists_test3`(posix stat()) | **0.134s** |

该`stat()`函数在我的系统（Linux，用 编译）上提供了最佳性能，如果您出于某种原因拒绝使用 POSIX 函数，则最好`g++`使用标准调用。`fopen`

* * *

## 回答 #2

> 赞同：213
> 
> 时间：2014-07-15T05:01:19.407

备注：在 C++14 中，一旦[文件系统 TS](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4099.html)完成并采用，解决方案将是使用：

```
std::experimental::filesystem::exists("helloworld.txt"); 
```

从 C++17 开始，只有：

```
std::filesystem::exists("helloworld.txt"); 
```

* * *

## 回答 #3

> 赞同：128
> 
> 时间：2013-11-07T16:45:31.030

我使用这段代码，到目前为止它对我来说还可以。这并没有使用 C++ 的许多花哨功能：

```
bool is_file_exist(const char *fileName)
{
    std::ifstream infile(fileName);
    return infile.good();
} 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2015-09-21T08:30:10.093

对于那些喜欢提升的人：

```
 boost::filesystem::exists(fileName) 
```

或者，从 ISO C++17 开始：

```
 std::filesystem::exists(fileName) 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2012-10-08T01:35:33.347

这取决于文件所在的位置。例如，如果它们都应该在同一个目录中，您可以将所有目录条目读入哈希表，然后根据哈希表检查所有名称。在某些系统上，这*可能*比单独检查每个文件更快。单独检查每个文件的最快方法取决于您的系统……如果您正在编写 ANSI C，最快的方法是`fopen`因为它是唯一的方法（文件可能存在但不可打开，但您可能真的希望可打开，如果您需要“做点什么”）。C++、POSIX、Windows 都提供了额外的选项。

当我在这里时，让我指出你的问题的一些问题。您说您想要最快的方法，并且您有数千个文件，但随后您要求提供用于测试单个文件的函数的代码（并且该函数仅在 C++ 中有效，而不是 C）。这与您的要求相矛盾，因为它对解决方案进行了假设…… [XY 问题](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)的一个案例。您还说“在标准 c++11(or)c++(or)c 中”……它们都是不同的，这也与您对速度的要求不一致……最快的解决方案是根据目标系统。问题中的不一致通过您接受的答案突出显示，该答案提供了与系统相关且不是标准 C 或 C++ 的解决方案。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2015-11-02T20:15:42.640

在不使用其他库的情况下，我喜欢使用以下代码片段：

```
#ifdef _WIN32
   #include <io.h> 
   #define access    _access_s
#else
   #include <unistd.h>
#endif

bool FileExists( const std::string &Filename )
{
    return access( Filename.c_str(), 0 ) == 0;
} 
```

这适用于 Windows 和 POSIX 兼容系统的跨平台。

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2014-03-12T09:56:29.177

与 PherricOxide 建议的相同，但在 C 中

```
#include <sys/stat.h>
int exist(const char *name)
{
  struct stat   buffer;
  return (stat (name, &buffer) == 0);
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-02-05T21:39:52.587

```
inline bool exist(const std::string& name)
{
    ifstream file(name);
    if(!file)            // If the file was not found, then file is 0, i.e. !file=1 or true.
        return false;    // The file was not found.
    else                 // If the file was found, then file is non-0.
        return true;     // The file was found.
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2018-05-05T04:51:34.277

我需要一个可以检查文件是否存在的快速函数，PherricOxide 的答案几乎就是我所需要的，只是它没有比较 boost::filesystem::exists 和 open 函数的性能。从基准测试结果我们可以很容易地看到：

*   使用 stat 函数是检查文件是否存在的最快方法。请注意，我的结果与 PherricOxide 的答案一致。

*   boost::filesystem::exists 函数的性能非常接近于 stat 函数，并且它也是可移植的。如果可以从您的代码访问 boost 库，我会推荐此解决方案。

使用 Linux 内核 4.17.0 和 gcc-7.3 获得的基准测试结果：

```
2018-05-05 00:35:35
Running ./filesystem
Run on (8 X 2661 MHz CPU s)
CPU Caches:
  L1 Data 32K (x4)
  L1 Instruction 32K (x4)
  L2 Unified 256K (x4)
  L3 Unified 8192K (x1)
--------------------------------------------------
Benchmark           Time           CPU Iterations
--------------------------------------------------
use_stat          815 ns        813 ns     861291
use_open         2007 ns       1919 ns     346273
use_access       1186 ns       1006 ns     683024
use_boost         831 ns        830 ns     831233 
```

以下是我的基准代码：

```
#include <string.h>                                                                                                                                                                                                                                           
#include <stdlib.h>                                                                                                                                                                                                                                           
#include <sys/types.h>                                                                                                                                                                                                                                        
#include <sys/stat.h>                                                                                                                                                                                                                                         
#include <unistd.h>                                                                                                                                                                                                                                           
#include <dirent.h>                                                                                                                                                                                                                                           
#include <fcntl.h>                                                                                                                                                                                                                                            
#include <unistd.h>                                                                                                                                                                                                                                           

#include "boost/filesystem.hpp"                                                                                                                                                                                                                               

#include <benchmark/benchmark.h>                                                                                                                                                                                                                              

const std::string fname("filesystem.cpp");                                                                                                                                                                                                                    
struct stat buf;                                                                                                                                                                                                                                              

// Use stat function                                                                                                                                                                                                                                          
void use_stat(benchmark::State &state) {                                                                                                                                                                                                                      
    for (auto _ : state) {                                                                                                                                                                                                                                    
        benchmark::DoNotOptimize(stat(fname.data(), &buf));                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                                         
}                                                                                                                                                                                                                                                             
BENCHMARK(use_stat);                                                                                                                                                                                                                                          

// Use open function                                                                                                                                                                                                                                          
void use_open(benchmark::State &state) {                                                                                                                                                                                                                      
    for (auto _ : state) {                                                                                                                                                                                                                                    
        int fd = open(fname.data(), O_RDONLY);                                                                                                                                                                                                                
        if (fd > -1) close(fd);                                                                                                                                                                                                                               
    }                                                                                                                                                                                                                                                         
}                                                                                                                                                                                                                                                             
BENCHMARK(use_open);                                  
// Use access function                                                                                                                                                                                                                                        
void use_access(benchmark::State &state) {                                                                                                                                                                                                                    
    for (auto _ : state) {                                                                                                                                                                                                                                    
        benchmark::DoNotOptimize(access(fname.data(), R_OK));                                                                                                                                                                                                 
    }                                                                                                                                                                                                                                                         
}                                                                                                                                                                                                                                                             
BENCHMARK(use_access);                                                                                                                                                                                                                                        

// Use boost                                                                                                                                                                                                                                                  
void use_boost(benchmark::State &state) {                                                                                                                                                                                                                     
    for (auto _ : state) {                                                                                                                                                                                                                                    
        boost::filesystem::path p(fname);                                                                                                                                                                                                                     
        benchmark::DoNotOptimize(boost::filesystem::exists(p));                                                                                                                                                                                               
    }                                                                                                                                                                                                                                                         
}                                                                                                                                                                                                                                                             
BENCHMARK(use_boost);                                                                                                                                                                                                                                         

BENCHMARK_MAIN(); 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-08-22T15:18:18.970

windows下的另外3个选项：

# 1

```
inline bool exist(const std::string& name)
{
    OFSTRUCT of_struct;
    return OpenFile(name.c_str(), &of_struct, OF_EXIST) != INVALID_HANDLE_VALUE && of_struct.nErrCode == 0;
} 
```

# 2

```
inline bool exist(const std::string& name)
{
    HANDLE hFile = CreateFile(name.c_str(), GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if (hFile != NULL && hFile != INVALID_HANDLE)
    {
         CloseFile(hFile);
         return true;
    }
    return false;
} 
```

# 3

```
inline bool exist(const std::string& name)
{
    return GetFileAttributes(name.c_str()) != INVALID_FILE_ATTRIBUTES;
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-08-22T14:01:00.077

你也可以这样做`bool b = std::ifstream('filename').good();`。如果没有分支指令（如 if），它必须执行得更快，因为它需要被调用数千次。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-05-21T13:30:22.087

如果您需要区分文件和目录，请考虑以下两者都使用 stat ，这是 PherricOxide 展示的最快的标准工具：

```
#include <sys/stat.h>
int FileExists(char *path)
{
    struct stat fileStat; 
    if ( stat(path, &fileStat) )
    {
        return 0;
    }
    if ( !S_ISREG(fileStat.st_mode) )
    {
        return 0;
    }
    return 1;
}

int DirExists(char *path)
{
    struct stat fileStat;
    if ( stat(path, &fileStat) )
    {
        return 0;
    }
    if ( !S_ISDIR(fileStat.st_mode) )
    {
        return 0;
    }
    return 1;
} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-07-12T08:59:55.103

您可以使用`std::ifstream`, 类似`is_open`,的功能`fail`，例如如下代码（cout“打开”表示文件存在与否）：

[![在此处输入图像描述](../Images/ddd9cc2b2e8c9474fbfa7248fc4c41a5.png)](https://i.stack.imgur.com/8R1UV.png)

[![在此处输入图像描述](../Images/c9f311a2760b2bfcb2d5c33d5f57a10f.png)](https://i.stack.imgur.com/ujA6w.png)

[从这个答案](https://stackoverflow.com/a/51300933/6329006)中引用

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-09-24T17:36:13.293

*所有其他答案都侧重于单独检查每个文件，但如果文件都在一个目录（文件夹）中，那么仅读取目录*并检查您想要的每个文件名是否存在可能会更有效。

即使文件分布在多个目录中，这甚至可能更有效，这取决于目录与文件的确切比例。一旦您开始接近位于其自己目录中的每个目标文件，或者在同一目录中有许多您不想检查的其他文件，那么我希望它最终会变得效率降低而不是单独检查每个文件。

一个很好的启发式方法：处理你已经拥有的一堆数据比向操作系统询问任何数量的数据要快得多。系统调用开销相对于单个机器指令来说是巨大的。因此，询问操作系统“给我这个目录中的整个文件列表”然后挖掘该列表几乎总是会更快，而询问操作系统“给我关于这个文件的信息”、“好的现在给我关于这个其他文件的信息”、“现在给我关于……的信息”等等。

每个好的 C 库都以一种有效的方式实现其“遍历目录中的所有文件”API，就像缓冲 I/O 一样 - 在内部它一次从操作系统读取目录条目的大列表，即使 API 看起来像分别向操作系统询问每个条目。

* * *

所以如果我有这个要求，我会

1.  尽一切可能鼓励设计和使用，以便所有文件都在一个文件夹中，并且该文件夹中没有其他文件，
2.  将我需要存在的文件名列表放入内存中具有 O(1) 或至少 O(log(n)) 查找和删除时间的数据结构中（如哈希映射或二叉树），
3.  列出该目录中的文件，并在我从内存中的“列表”（散列图或二叉树）中“检查”（删除）每个文件时。

除了取决于确切的用例，也许不是从哈希映射或树中删除条目，我会跟踪“我有这个文件吗？” 每个条目的布尔值，并找出一个数据结构，使 O(1) 询问“我有每个文件吗？”。也许是一棵二叉树，但每个非叶节点的结构也有一个布尔值，它是其叶节点的布尔值的逻辑与。这可以很好地扩展 - 在叶节点中设置布尔值之后，您只需沿着树走并设置每个节点的“有这个吗？” boolean`&&`及其子节点的 boolean （并且您不需要递归那些其他子节点，因为如果您每次将其中一个叶子设置为 true 时都始终如一地执行此过程，它们将被设置为当且仅当他们的所有孩子都是真实的。）

* * *

可悲的是，在 C++17 之前没有*标准*的方法来做到这一点。

C++17 得到[`std::filesystem::directory_iterator`](https://en.cppreference.com/w/cpp/filesystem/directory_iterator).

当然有一个对应的`boost::filesystem::directory_iterator`，我认为它可以在旧版本的 C++ 中工作。

最接近标准 C 方式的是`opendir`and `readdir`from `dirent.h`。那是一个标准的 C 接口，它只是在 POSIX 中标准化，而不是在 C 标准本身中。它在 Mac OS、Linux、所有 BSD、其他 UNIX/类 UNIX 系统和任何其他 POSIX/SUS 系统上开箱即用。对于 Windows，您只需下载一个[`dirent.h`实现并将其放入包含路径中即可。](https://github.com/tronkko/dirent)

但是，由于您正在寻找*最快*的方法，您可能希望超越便携式/标准的东西。

在 Linux 上，您可以通过使用原始系统调用手动指定缓冲区大小来优化性能`getdents64`。

在 Windows 上，经过一番挖掘，[它看起来像](https://stackoverflow.com/a/15776443/4372452)你想要使用的最大性能`FindFirstFileEx`，`FindExInfoBasic`并且`FIND_FIRST_EX_LARGE_FETCH`在你可以使用的情况下，很多像上面的 Windows 开源库`dirent.h`似乎都没有做到这一点。但是对于需要使用比最后几个 Windows 版本更旧的东西的代码，您不妨只使用`FindFirstFile`没有额外标志的简单代码。

计划 9 不会被上述任何内容所涵盖，您将需要`dirread`or `dirreadall`（如果您可以安全地假设您有足够的内存用于整个目录内容，则后者）。如果您想更好地控制缓冲区大小以提高性能，请使用纯文本`read`或`read`解码目录条目数据 - 它们采用与机器无关的文档格式，我认为提供了辅助函数。

我不知道任何其他操作系统。

* * *

稍后我可能会通过一些测试来编辑这个答案。欢迎其他人在测试结果中进行编辑。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-01-25T00:57:03.657

```
all_of (begin(R), end(R), [](auto&p){ exists(p); }) 
```

`R`您的路径类事物序列在哪里，并且来自`exists()`未来的标准或当前的提升。如果您自己动手，请保持简单，

```
bool exists (string const& p) { return ifstream{p}; } 
```

分支解决方案并不是绝对糟糕，它不会吞噬文件描述符，

```
bool exists (const char* p) {
    #if defined(_WIN32) || defined(_WIN64)
    return p && 0 != PathFileExists (p);
    #else
    struct stat sb;
    return p && 0 == stat (p, &sb);
    #endif
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-07-15T14:37:26.177

测试文件存在的最快和最安全的方法是根本不单独/显式测试它。也就是看能不能找到办法代替普通的

```
if(exists(file)) {                           /* point A */
    /* handle existence condition */
    return;
}

do_something_with(file);                     /* point B */ 
```

随着改进

```
r = do_something_with_unless_exists(file);

if(r == 0)
    success;
else if(errno == EEXIST)
    /* handle existence condition */
else
    /* handle other error */ 
```

除了更快之外，这消除了第一个解决方案中固有的[竞争条件](https://en.wikipedia.org/wiki/Race_condition)（特别是“ [TOC/TOU](https://en.wikipedia.org/wiki/Time-of-check_to_time-of-use) ”），即文件存在于 A 点和 B 点之间的可能性。

显然，第二种解决方案的前提是存在一种执行操作的原子方式`do_something_with_unless_exists`。通常有一种方法，但有时你必须四处寻找它。

*   创建文件：`open()`使用`O_CREAT`和调用`O_EXCL`。

*   如果您有 C11，则在纯 C 中创建文件：`fopen()`使用`"wx"`. （我昨天才知道这个。）

*   制作目录：只需调用`mkdir()`并稍后检查`errno == EEXIST`。

*   获取锁：任何有价值的锁定系统都已经有一个原子的获取锁，因为它没有任何其他人拥有其他人拥有它的原语。

（还有其他的，但我现在能想到的就这些了。）

[脚注：在 Unix 的早期，没有特定的专用设施可供普通进程使用来进行锁定，所以如果你想设置互斥锁，这通常通过创建某个空目录来实现，因为`mkdir`系统调用总是有能力根据先前的存在或不存在原子地失败或成功。]

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-08-28T16:25:59.543

在 C++17 中：

```
#include <experimental/filesystem>

bool is_file_exist(std::string& str) {   
    namespace fs = std::experimental::filesystem;
    fs::path p(str);
    return fs::exists(p);
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-08-04T09:11:20.543

好吧，还有更简单的方法

```
#include <fstream>
#include <iostream>

void FileExists(std::string myfile){
std::ifstream file(myfile.c_str());

if (file) {
    std::cout << "file exists" << std::endl;
}
else {
    std::cout << "file doesn't exist" << std::endl;
}
}

int main() {
FileExists("myfile.txt");

return 0;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-22T17:28:24.093

使用 MFC 可以通过以下方式

```
CFileStatus FileStatus;
BOOL bFileExists = CFile::GetStatus(FileName,FileStatus); 
```

`FileName`代表您正在检查是否存在的文件的字符串在哪里

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-03T14:14:42.903

这是一个简单的例子！

```
#include <iostream>
#include <fstream>
using namespace std;

void main(){
   SearchFile("test.txt");
}

bool SearchFile(const char *file)
{
   ifstream infile(file);
   if (!infile.good())
   {
    // If file is not there
    exit(1);
   }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-03-30T05:44:58.010

只有一种更快的方法来检查文件是否存在以及您是否有权读取它使用 C 语言的方式希望更快并且也可以在 C++ 的任何版本中使用

**解决方案**：在 C 中有一个库**errno.h**，它有一个名为 errno 的外部（全局）整数变量，其中包含一个可用于识别错误类型的数字

```
 #include <stdio.h>
    #include <stdbool.h>
    #include <errno.h>

    bool isFileExist(char fileName[]) {
        FILE *fp = fopen(fileName, "r");
        if (fp) {
            fclose(fp);
            return true;
        }
        return errno != ENOENT;
    }

    bool isFileCanBeRead(char fileName[]) {
        FILE *fp = fopen(fileName, "r");
        if (fp) {
            fclose(fp);
            return true;
        }
        return errno != ENOENT && errno != EPERM;
    } 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2021-07-15T14:17:42.007

检测文件是否存在于windows中。

```
bool DoesExistFile(std::wstring filePath)
{
    bool result = true;

    HANDLE fileHandle = CreateFile(
        filePath.c_str(),
        GENERIC_READ,
        0,
        NULL,
        OPEN_EXISTING,
        0,
        NULL);

    if ((fileHandle != NULL) && (fileHandle != INVALID_HANDLE_VALUE))
        CloseHandle(fileHandle);
    else
    {
        DWORD error = GetLastError();

        if ((error == ERROR_FILE_NOT_FOUND) || (error == ERROR_PATH_NOT_FOUND))
            result = false;
    }

    return result;
} 
```

* * *

## 回答 #23

> 赞同：-6
> 
> 时间：2014-09-17T21:19:28.303

尽管有几种方法可以做到这一点，但对您的问题最有效的解决方案可能是使用 fstream 的预定义方法之一，例如**good()**。使用此方法，您可以检查您指定的文件是否存在。

```
fstream file("file_name.txt");

if (file.good()) 
{
    std::cout << "file is good." << endl;
}
else 
{
    std::cout << "file isnt good" << endl;
} 
```

希望这个对你有帮助。

# r - 您如何专门订购 ggplot2 x 轴而不是字母顺序？

> ID：12774210
> 
> 赞同：105
> 
> 时间：2012-10-08T01:10:38.907
> 
> 标签：r, ggplot2, r-faq

我正在尝试`heatmap`使用`ggplot2`以下`geom_tiles`函数来使用我的代码：

```
p<-ggplot(data,aes(Treatment,organisms))+geom_tile(aes(fill=S))+
  scale_fill_gradient(low = "black",high = "red") + 
  scale_x_discrete(expand = c(0, 0)) + 
  scale_y_discrete(expand = c(0, 0)) + 
  theme(legend.position = "right", 
    axis.ticks = element_blank(), 
    axis.text.x = element_text(size = base_size, angle = 90, hjust = 0, colour = "black"),
    axis.text.y = element_text(size = base_size, hjust = 1, colour = "black")). 
```

数据是我的 data.csv 文件
我的 X 轴是治疗类型
我的 Y 轴是生物类型

我对命令和编程不太熟悉，而且我在这方面相对较新。我只想能够指定 x 轴上标签的顺序。在这种情况下，我试图指定“治疗”的顺序。默认情况下，它按字母顺序排列。如何以与原始 csv 文件相同的顺序覆盖此/保留数据？

我试过这个命令

```
scale_x_discrete(limits=c("Y","X","Z")) 
```

其中 x、y 和 z 是我的治疗条件顺序。但是它不能很好地工作，并且让我缺少热箱。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2012-10-08T13:53:27.693

如果没有完整的、可重复的示例，要回答您的具体问题有点困难。然而，这样的事情应该有效：

```
#Turn your 'treatment' column into a character vector
data$Treatment <- as.character(data$Treatment)
#Then turn it back into a factor with the levels in the correct order
data$Treatment <- factor(data$Treatment, levels=unique(data$Treatment)) 
```

在此示例中，因子的顺序将与`data.csv`文件中的顺序相同。

如果您喜欢不同的订单，您可以手动订购：

```
data$Treatment <- factor(data$Treatment, levels=c("Y", "X", "Z")) 
```

但是，如果您有很多级别，这是很危险的：如果您将其中任何一个弄错了，那将导致问题。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2018-02-26T22:53:39.337

接受的答案提供了一个需要更改基础数据框的解决方案。这不是必需的。人们也可以直接在`aes()`调用中进行因式分解，或者为此创建一个向量。

[这当然与用户 Drew Steen 的回答](https://stackoverflow.com/a/12783167/7941188)没有太大区别，但重要的区别是不更改原始数据框。

```
level_order <- c('virginica', 'versicolor', 'setosa') #this vector might be useful for other plots/analyses

ggplot(iris, aes(x = factor(Species, level = level_order), y = Petal.Width)) + geom_col() 
```

或者

```
level_order <- factor(iris$Species, level = c('virginica', 'versicolor', 'setosa'))

ggplot(iris, aes(x = level_order, y = Petal.Width)) + geom_col() 
```

或
直接在`aes()`没有预先创建的向量的调用中：

```
ggplot(iris, aes(x = factor(Species, level = c('virginica', 'versicolor', 'setosa')), y = Petal.Width)) + geom_col() 
```

[![这是第一个版本](../Images/5a9de26beab3366907d9761d34b6d584.png)](https://i.stack.imgur.com/qbe5e.jpg)

# c# - SetValue 不会更新 UI，但 OnPropertyChanged 会

> ID：12774216
> 
> 赞同：2
> 
> 时间：2012-10-08T01:11:46.017
> 
> 标签：c#, mvvm, microsoft-metro, windows-runtime

我有一个控制滑块值的 TwoWay 绑定：

```
<Slider Orientation="Vertical" Height="200" Value="{Binding Path=MapScale, Mode=TwoWay}" Maximum="{Binding MaxScale}" Minimum="{Binding MinScale}" StepFrequency="0.1" /> 
```

绑定在 ViewModel 中作为 DependencyProperty：

```
 public static readonly DependencyProperty MapScaleProperty =
         DependencyProperty.Register("MapScale", typeof(Double?), typeof(MappingPageViewModel), new PropertyMetadata(0.0));

    public Double? MapScale
    {
        get { return GetValue(MapScaleProperty) as Double?; }
        set { SetValue(MapScaleProperty, value); OnPropertyChanged("MapScale"); }
    } 
```

就像现在的代码一样，当我更新 MapScale（例如`MapScale += .1`）时，滑块会正确更新。但是，如果我删除该`OnPropertyChanged`方法（我印象`SetValue`中已经调用过该方法），滑块将无法正确更新。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:34:18.790

Slider.Value 的类型是`double`，而不是`Nullable<double>`。我注意到 WinRT 对匹配绑定类型非常挑剔。它不会像 WPF 和 Silverlight 那样为您自动转换大多数东西。

我的回答是：

`INotifyPropertyChanged`用作@Adi 已经提到并用作`double`属性类型。

如果您无法`Nullable<double>`在视图模型中使用，则创建一个`IValueConverter`将 null 转换为零的。

# macos - NSDocument 无法在具有多种文档类型的应用中打开

> ID：12774220
> 
> 赞同：2
> 
> 时间：2012-10-08T01:12:06.333
> 
> 标签：macos, cocoa, nsdocument, uti

我的应用程序有两种自定义文档类型。两者都在目标中声明，并导出它们的 UTI。两个 UTI 都符合 public.data 和 public.content；并且文档都使用 NSKeyedArchiver 来读写磁盘。

在 DocumentType1 的 NSDocument 子类中，在运行 NSOpenPanel 以找出要打开的 URL 后，我使用以下代码打开 DocumentType2 的文档：

```
self.docType2FileURL = [openPanel URLs][0];
NSLog(@"docType2FileURL: %@", self. docType2FileURL);
NSError *err = nil;
self.docType2FileSecurityScopedBookmark = [NSURL bookmarkDataWithContentsOfURL:self.docType2FileURL error:&err];
if (err != nil) {
    NSLog(@"bookmark error: %@", err);
}
NSLog(@"bookmark: %@", self.docType2FileSecurityScopedBookmark);
[[NSDocumentController sharedDocumentController] openDocumentWithContentsOfURL:self.docType2FileURL display:NO completionHandler:^(NSDocument *document, BOOL documentWasAlreadyOpen, NSError *error) {
    if (error) {
        NSLog(@"Error: %@", error);
    } else {
        NSLog(@"No error.");
    }
    self.docType2pointer = (DocumentType2 *)document;
}]; 
```

这是失败的，并导致以下日志语句：

> 2012-10-07 11:05:37.956 MyApp[64151:303] docType2FileURL: file://localhost/path/to/file2.docType2
> 
> 2012-10-07 11:05:37.958 MyApp [64151:303] 书签错误：错误域 = NSCocoaErrorDomain 代码 = 256“无法打开文件。”
> 
> 2012-10-07 11:05:37.959 MyApp [64151:303] 书签：（空）
> 
> 2012-10-07 11:05:38.015 MyApp[64151:303] 错误：错误域 = NSCocoaErrorDomain 代码 = 256“无法打开文档“文件名 .docType2”。MyApp 无法打开此类型的文件。” UserInfo=0x1001b2c30 {NSLocalizedFailureReason=MyApp 无法打开此类型的文件。, NSLocalizedDescription=无法打开文档“name of file.docType2”。MyApp 无法打开此类型的文件。NSUnderlyingError=0x1005db460 ""name of file.docType2" 无法处理，因为 MyApp 无法打开此类型的文件。"}

无论出于何种原因，不仅文档无法打开，而且应用程序也无法为其创建书签。你对为什么会这样有任何想法吗？

提前致谢。

# android - Android 操作系统上的滚动问题

> ID：12774222
> 
> 赞同：0
> 
> 时间：2012-10-08T01:13:12.850
> 
> 标签：android, jquery, mobile

因此，当我尝试在 Android 手机上查看我正在处理的网站时，我无法让屏幕滚动。如果您在桌面浏览器上查看站点：[CMB SOUND](http://cmbsound.net/temp)，您会看到我在导航中使用了锚链接。因此，当您单击链接时，您不会被带到一个实际的新页面。我正在使用 jquery 插件来帮助执行此操作。桌面运行正常，Safari 移动操作系统运行良好，但在 Android 上，“页面”或内容在底部导航下拉菜单中被截断，用户无法滚动超出它。谁能指出我如何在Android中解决这个问题的正确方向？如果我解释得不够好，请告诉我。提前致谢！

# php - 如何结合gwt和php？

> ID：12774229
> 
> 赞同：0
> 
> 时间：2012-10-08T01:13:54.563
> 
> 标签：php, javascript, eclipse, gwt

> **可能重复：**
> [GWT 是否支持 php？](https://stackoverflow.com/questions/3183743/does-gwt-support-php)

我是 GWT 的新手——事实上，我只是在查看它是否满足我的需求。首先，它的入门文档在很多地方都不正确，但我离题了……我的问题是，如果我使用 GWT 创建一个简单的 UI 并用它生成 js/html，我可以轻松地将 php 嵌入其中吗？

例如，如果我在从 gwt 生成 html/js 之后手动插入 php 代码，那么我对 gwt 项目进行了更改，我将不得不重做 php 编码。有没有自动执行此操作的好方法？我不应该开始使用 php 吗？任何方向将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:18:30.663

GWT 代码被编译成 JavaScript，并在浏览器的客户端完全运行。您不能在浏览器中执行 PHP 代码，所以这是不行的，但是您可以让 GWT 应用程序与服务器上的 PHP 代码通信。

例如，像 GMail 这样的邮件客户端是一个在浏览器中运行的 JavaScript 应用程序，但是当您单击邮件项来阅读它时，客户端需要联系服务器以获取电子邮件的文本以便显示。

所以简短的回答是不，你不能将 PHP 代码插入到你的 GWT 应用程序中，但是你可以让一个在浏览器中运行的 GWT 应用程序与服务器上的一个 PHP 应用程序通信（通过 XHR）。

# python - wx.FileDialog 没有显示？

> ID：12774230
> 
> 赞同：0
> 
> 时间：2012-10-08T01:14:02.350
> 
> 标签：python, wxpython

我已经成功地在我的 wxPython 应用程序中包含了一个 FileDialog 小部件而没有错误，但我无法让它显示出来。这是我的课：

```
class workingFrame(wx.Frame):
    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, 'UniStaller', size = (300, 200))
        panel = wx.Panel(self)
        basicDialog = wx.FileDialog(self, 'panel', 'Choose a file:', '/Users/student/Desktop/School') 
```

我的框架出现了，但我没有得到任何类型的对话框。我需要一条线让它出现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:29:25.370

```
basicDialog.ShowModal() 
```

你需要展示它

# apache-flex - Flex 4.6 无法看到设计视图移动应用程序

> ID：12774233
> 
> 赞同：0
> 
> 时间：2012-10-08T01:14:26.767
> 
> 标签：apache-flex, mobile, flex4.6, designview

我之前能够查看我的设计视图，但我认为我已经对 SDK 进行了一些更改。我已将其设置回 4.6，但我无法在移动项目中看到设计视图。

不过，我可以在常规的 flex 项目中看到它。

关于如何和什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T10:54:45.160

这是因为可能是你改变了你的偏好。

转到窗口菜单并选择选项 -`Enable Design Mode`

也进入`Preferences`对话框 - `Flash Builder`- `Editors`-`Design Mode`并检查选项

```
Automatically show design-related views 
```

# .net - 为什么在手动强制 GC 完成之前释放的 ArcObjects COM 对象没有最终确定？

> ID：12774236
> 
> 赞同：2
> 
> 时间：2012-10-08T01:15:17.713
> 
> 标签：.net, com, memory-leaks, garbage-collection, arcobjects

我正在开发一个 .NET 应用程序，用于处理通过 ESRI 自己的 .NET 互操作程序集使用 ESRI 的 ArcObjects COM 库的地理数据。

在生产环境中运行时，由于达到每个进程 2GB 的内存限制，该进程可能会在某些操作期间崩溃。（ArcObjects 是一个 32 位库。）这是因为某些处理步骤可以创建许多临时 ArcObjects 几何对象。[`FinalReleaseComObject`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.finalreleasecomobject.aspx)尽管使用和关联的辅助方法手动释放这些对象，但它会泄漏内存并最终耗尽内存。但是，我可以通过调用强制GC释放内存[`WaitForPendingFinalizers`](http://msdn.microsoft.com/en-us/library/system.gc.waitforpendingfinalizers.aspx)，并定期调用它`GC.Collect`并`FinalReleaseComObject`控制内存使用。否则，许多对象会保留在内存中，直到进程退出（正常或异常）。

**第一个问题**：为什么 ArcObjects COM 对象持有的内存没有立即释放？或者，为什么 GC 允许进程崩溃，而不是在崩溃之前完成释放的 COM 对象并回收内存？

该应用程序在 Windows 2008 64 位上运行，而我使用 Windows 7 32 位进行开发。我可以让进程在生产盒上崩溃，但不能在我的开发盒上崩溃。我认为这可能是因为我通常在本地使用 Debug 版本在 Visual Studio 中运行，但我也使用 Release 版本在没有调试器的情况下尝试过（不使用调试启动），但即便如此，它也没有使用任何地方。内存在生产中，不会崩溃。

**第二个问题**：为什么？

编辑：在我之前的实验中，我发现它`GC.Collect`本身是不够的，即使我明确地调用它。我有一个实用方法，在每次算法迭代后调用并调用它可以降低内存使用率`GC.Collect`。`GC.WaitForPendingFinalizers`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T01:21:10.250

托管应用程序中使用的 COM 对象位于运行时可调用包装器 (RCW) 后面，RCW 是一个托管对象，它将 COM 对象的接口复制到托管客户端（它是托管组件和非托管组件之间的桥梁）。如果我没记错的话，实际的 COM 接口引用由 RCW 保存，而不是由您的代码保存。当您释放 COM 对象时，实际上释放的是 RCW，但作为托管对象本身，它不会消失，直到 GC 开始清理它。发生这种情况时，RCW 被删除，对 COM 对象的最后一个引用也消失了，因此它可以自行销毁。（根据文档，`FinalReleaseComObject`应该将引用计数设置为 0，但我过去看到过类似的行为，所以我质疑文档是否正确。）

至于您的第二个问题，我有一个猜测：我在压力大的环境中看到，当系统处于重负载状态时，GC 根本没有机会运行。那时我们确定 GC 运行在优先级较低的线程上，并且我们的应用程序使用了太多的 CPU，以至于 GC 从来没有机会清理。我们不得不添加另一个`GC.Collect()`每隔一段时间定期调用的线程——这迫使 GC 线程唤醒并发挥它的魔力。你可能会遇到类似的事情。（这也可能是您在 #1 中出现问题的原因。）

# mysql - 在 MySQL 中使用嵌套集的分层产品计数

> ID：12774238
> 
> 赞同：0
> 
> 时间：2012-10-08T01:15:31.447
> 
> 标签：mysql, nested-sets

如果我有一个嵌套的类别集，如下所示：

```
Widgets
  Blue
  Red
  Green 
```

我使用关系表将产品引用到这些类别，例如

产品：

```
id    name
1     Glowing Widget
2     Flying Widget
3     Exploding Widet 
```

关系表：

```
id    productId    categoryId
1     1            2
2     2            3
3     3            4 
```

有没有什么方法可以创建一个查询来判断一个类别及其子类别引用了多少产品？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:43:21.553

```
SELECT COUNT(DISTINCT productId)
FROM categories
JOIN products_to_categories USING (categoryId)
JOIN products USING (productId)
WHERE categories.left >= {left value of category in question}
AND categories.right <= {right value of category in question} 
```

# directx - dx 纹理不会按时更改？

> ID：12774245
> 
> 赞同：1
> 
> 时间：2012-10-08T01:17:13.590
> 
> 标签：directx, textures, direct3d

我正在使用顶点缓冲区（DrawPrimitive）使用 DX9 渲染 2D 精灵。一些动画有不同大小的不同纹理文件。

现在我遇到了以下问题：在非常单一的帧上，我在两个具有不同纹理文件的动画之间切换（例如，当开始行走或完成行走并开始站立时），它使用*新*纹理的坐标进行渲染，但仍然呈现旧纹理。这看起来好像我没有为新动画设置纹理。唯一的问题是 - 我做到了。

我如何理解问题出在哪里：我在该帧上截取了一张屏幕截图，并注意到它渲染了一个纹理，其坐标与另一个纹理相匹配。

在我的渲染函数中，我首先获取新纹理并将其发送到 DX，然后计算坐标，最后我使用坐标和新纹理集渲染我的顶点。我检查并调试了数百万次，所有值都是正确的，但错误还是发生了。

任何想法为什么会发生这种情况？

谢谢！

编辑：添加了一些代码：

```
 // Render a quad using the vertex buffer
void CGraphicsManager::RenderQuadViaVertexBuffer(const SVertex* pVertices) const
{

    // Increase renders count
    this->m_RenderCount++;

    // vb_vertices now points to our vertices inside the Vertex buffer, so
    // to fill in our VB, we copy to vb_vertices.
    memcpy(this->m_pVertexBufferBuffPtr + this->m_OffsetInVertexBuffer, pVertices, sizeof(SVertex) * (VERTICES_IN_QUAD));

    // Render the rectanlge using the vertices we got. 
    this->m_pD3dDevice->DrawPrimitive(D3DPT_TRIANGLESTRIP, this->m_OffsetInVertexBuffer, PRIMITIVES_IN_QUAD);

    // Increment the offset in the vertex buffer
    this->m_OffsetInVertexBuffer += VERTICES_IN_QUAD;

}
// Render a quad
void CGraphicsManager::Render(const STexture& p_Texture, SLocation p_RenderLocation, SSize p_RenderSize, const SQuad& p_TextureQuad, SfColor p_RenderColor, ERenderEffects p_RenderEffect) const
{
    // Set render effect
    this->SetRenderEffect(p_RenderEffect);

    // Set texture
    this->SetTexture(p_Texture);

    // Set the vertex needed for the rendering
    VerticesForQuadRender[0].Position.x = p_RenderLocation.x;
    VerticesForQuadRender[0].Position.y = p_RenderLocation.y;
    VerticesForQuadRender[0].Position.z = 0.0f;
    VerticesForQuadRender[0].color      = p_RenderColor;
    VerticesForQuadRender[0].tv         = p_TextureQuad.left;
    VerticesForQuadRender[0].tu         = p_TextureQuad.top;

    VerticesForQuadRender[1].Position.x = p_RenderLocation.x + p_RenderSize.x;
    VerticesForQuadRender[1].Position.y = p_RenderLocation.y;
    VerticesForQuadRender[1].Position.z = 0.0f;
    VerticesForQuadRender[1].color      = p_RenderColor;
    VerticesForQuadRender[1].tv         = p_TextureQuad.right;
    VerticesForQuadRender[1].tu         = p_TextureQuad.top;

    VerticesForQuadRender[2].Position.x = p_RenderLocation.x;
    VerticesForQuadRender[2].Position.y = p_RenderLocation.y + p_RenderSize.y;
    VerticesForQuadRender[2].Position.z = 0.0f;
    VerticesForQuadRender[2].color      = p_RenderColor;
    VerticesForQuadRender[2].tv         = p_TextureQuad.left;
    VerticesForQuadRender[2].tu         = p_TextureQuad.bottom;

    VerticesForQuadRender[3].Position.x = p_RenderLocation.x + p_RenderSize.x;
    VerticesForQuadRender[3].Position.y = p_RenderLocation.y + p_RenderSize.y;
    VerticesForQuadRender[3].Position.z = 0.0f;
    VerticesForQuadRender[3].color      = p_RenderColor;
    VerticesForQuadRender[3].tv         = p_TextureQuad.right;
    VerticesForQuadRender[3].tu         = p_TextureQuad.bottom;

    this->RenderQuadViaVertexBuffer(VerticesForQuadRender);
}

// Starts a rendering frame
bool CGraphicsManager::StartFrame()
{
    // Clear texture
    this->ClearTexture();

    // Zero renders count
    this->m_RenderCount = 0;

    // Clear screen
    if (!this->ClearScreen())
    {
        this->ResetDevice();
        return false;
    }

    // Begin new rendering scene
    if (FAILED(this->m_pD3dDevice->BeginScene()))
    {
        this->ResetDevice();
        return false;
    }

    // Set render from our vertex buffer
    this->BeginRenderFromVertexBuffer();

    return true;
}

// Finish rendering
bool CGraphicsManager::EndFrame()
{
    // Unlock vertex buffer
    this->m_pVertexBuffer->Unlock();

    // Notify the device that we're finished rendering for this frame
    if (FAILED(this->m_pD3dDevice->EndScene()))
    {
        this->ResetDevice();
        return false;
    }

    // Present scene
    if(FAILED(this->m_pD3dDevice->Present(NULL,     //Source rectangle to display, NULL for all of it
                        NULL,                       //Destination rectangle, NULL to fill whole display
                        NULL,                       //Target window, if NULL uses device window set in CreateDevice
                        NULL )))                    //Dirty Region, set it to NULL
    {
        this->ResetDevice();
        return false;
    }

    // Finish rendering
    return true;
}

// This function must be called before rendering textured surfaces
void CGraphicsManager::BeginRenderFromVertexBuffer() const
{
        // Lock the vertex buffer (unlock on release) and get the pointer to the begining of the buffer
        HRESULT hr = this->m_pVertexBuffer->Lock
           (0,                                      // Offset, we want to start at the beginning
            0,                                      //SizeToLock, 0 means lock the whole thing
            (void**)&this->m_pVertexBufferBuffPtr,  //If successful, this will point to the data in the vertex buffer
            0); 

        ASSERT(SUCCEEDED(hr), "Failed to lock vertex buffer! (err: " << hr << ")");

    // Set offset in vertex buffer back to 0
    this->m_OffsetInVertexBuffer = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T07:44:41.860

当你说“新纹理的坐标”时，你指的是这个：[http](http://en.wikipedia.org/wiki/UV_mapping) ://en.wikipedia.org/wiki/UV_mapping ？

如果精灵在更新时获得旧纹理，则可能是一些原因。

1：你的渲染管道如何工作？你为每个drawcall设置每个纹理吗？- 我要找的是如果你只设置一次纹理而不是 perdrawcall （或者如果你用批处理排序）

2：你确定你绑定了你的新纹理吗？

你能在你的绘图功能上发布一些代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T10:57:57.920

好吧，我可以看到您将数据复制到锁定的顶点缓冲区然后渲染该数据的问题。你不能这样做。锁定的顶点缓冲区中的数据实际上还不是有效的。它只有在您解锁后才生效。这是因为您正在填写的数据在主内存中，实际上可能是图形卡上的阴影内存。当您解锁时，它将数据复制到图形卡。

因此，如果您为每个绘制调用锁定/解锁，一切正常，因为您正在强制复制。

但是，正如您所发现的，这远非最佳。

您应该做的是一次计算所有四边形顶点位置。然后，您需要遍历并渲染所有四边形（理想情况下，每次调用都无需交换纹理/着色器/等）。

一种方法是在你正在做的时候填充你的顶点缓冲区，然后将绘制命令存储在顶点缓冲区中。这将需要您存储诸如纹理、使用的效果等内容。然后您可以遍历列表并渲染您已经填充的顶点缓冲区中的所有内容。

如果您然后按纹理和着色器常量对事物进行排序（以最大程度地减少状态变化），您会发现您的性能要好很多倍。尽管您需要将顶点缓冲区标记为“动态”，并且建议在锁定顶点缓冲区时使用 D3DLOCK_DISCARD 标志，因为这将丢弃当前在顶点缓冲区中的数据（基本上它将返回一个全新的内存块填充并且不会从卡中复制任何内容）而不是阻塞并等待 GPU 完成使用它。

我希望那是一些帮助！

# c# - UNITY3D：将玩家控制更改为目标模型 (FPS)

> ID：12774248
> 
> 赞同：6
> 
> 时间：2012-10-08T01:17:52.137
> 
> 标签：c#, unity3d

我正在 Unity 3.5.5f 中开发一个小型游戏原型 - 玩家在其中控制一个小型心灵控制外星人。玩家需要能够控制目标人类 NPC，将所有摄像机和控件切换到相关人类。

注意到目前为止，我的所有代码都在 C# 中。

关于如何进步，我有两个想法，哪个更可行？（我很高兴听到其他想法）

1.  关卡中的每个人都有一个停用的 FPS 控制器脚本（以及随附的脚本）。这些脚本在受控时被激活（在此期间禁用外星人的脚本）。
2.  将当前脚本从外星人身上分离出来，并将它们附加到目标人类身上。

就我看来它们的优点和缺点：

1.  可以有单独的外星人/人类控制脚本（即不需要使用状态作为输入 - 例如可以在人类时开枪，而不是在 LMB 上作为外星人近战）。这种方法非常混乱。
2.  这种方法很干净，但是播放器的代码文件会大得多，因为我不能轻易地分离输入代码。

编辑：一位朋友指出，是的，NPC 有自己的脚本，需要禁用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:20:31.030

从概念上讲，这很简单。只需让 NPC 类似于玩家类，只要事情为真，它就会接受控制。
例如：

```
class NPC {
static bool isBeingControlled = false;
public void OnUpdate() {
    if (isBeingControlled)
    {
        //set camera position to NPC position (make sure you're using NPC as an instantiated class)
        //accept key input WASD or whatever you are using and move NPC according to input.
    }
} 
```

}

您必须为游戏中的每个 NPC 实例化 NPC。

# php - opencart 的搜索过滤器

> ID：12774249
> 
> 赞同：5
> 
> 时间：2012-10-08T01:17:55.683
> 
> 标签：php, search, opencart

我对某事感到困惑，需要您的帮助。opencart有一些不错的**产品过滤器**扩展，但是它们都没有在首页（登陆页面）上提供任何功能。

我想要的是像这个 Magento 主题[http://xhtml.webtemplatemasters.com/car-dealer](http://xhtml.webtemplatemasters.com/car-dealer)

我的意思是，浏览者应该能够根据自己的需要从我的网站首页（即按品牌、类型、价格等）进行搜索或过滤。

各位朋友能指导我如何实现这一目标吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:32:40.200

您可以查看搜索控制器和模板并提取与搜索相关的信息，然后无需处理同一页面上的信息，只需发布​​到当前搜索页面即可。这应该限制您深入研究搜索代码的需要，并将您需要更改的内容集中在控制器和视图上。

# javascript - 在滚动上堆叠 div

> ID：12774259
> 
> 赞同：0
> 
> 时间：2012-10-08T01:20:58.110
> 
> 标签：javascript, jquery, css, html, scrolltop

我试图在滚动时将一个 div 堆栈放在另一个堆栈之上。现在，第二个 div 的不透明度设置为 0，一旦到达第二个 div 的底部，不透明度就变为 1。我该如何调整它，以便当滚动到达 div 的顶部时不透明度变为 1？

```
 $(document).ready(function() {

    /* Every time the window is scrolled ... */
    $(window).scroll( function(){

        /* Check the location of each desired element */
        $('#thrillercontainer').each( function(i){

            var bottom_of_object = $(this).position().top + $(this).outerHeight();
            var bottom_of_window = $(window).scrollTop() + $(window).height();

            /* If the object is completely visible in the window, fade it it */
            if( bottom_of_window > bottom_of_object ){

                $(this).animate({'opacity':'1'},100);
                $('#horrorcontainer').slideUp(100);

            } 
```

# java - JOptionPane.showOptionDialog 中如何使用数组？

> ID：12774262
> 
> 赞同：1
> 
> 时间：2012-10-08T01:21:15.250
> 
> 标签：java, joptionpane

我目前`showOptionDialog`在我的程序中使用带有五个按钮的自定义。这些按钮中的每一个都“连接”到“if”语句。通常，我会使用这样的东西：

```
 if (a == JOptionPane.YES_OPTION){} 
```

但是，由于它是一个自定义数组，我不太清楚该怎么做。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T17:12:18.347

返回值是选项数组中所选选项的索引。

# c++ - 释放内存，windows已经触发断点

> ID：12774272
> 
> 赞同：1
> 
> 时间：2012-10-08T01:23:22.533
> 
> 标签：c++, memory-management

当我尝试为代码中的矩阵释放分配的内存时遇到问题。我正在使用这个功能：

```
void free_matrix(float **m, int row)
{
    for( int i=0; i<row; i++ ) 
    {
        free( m[i]);
    }
    free(m);

} 
```

但我不知道为什么它不起作用，我得到这个错误：

```
Windows has triggered a breakpoint in mycode.exe.

This may be due to a corruption of the heap, which indicates a bug in mycode.exe or any of the DLLs it has loaded.

This may also be due to the user pressing F12 while mycode.exe has focus. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:36:48.623

最有可能的是，您正在释放尚未分配的内存。检查您分配内存的代码，或者更好的是，将其发布给我们查看。确保您只在有效指针上调用 free 。另外，请确保您没有将“新”与“免费”混淆。

# ios - 如何在不检查 SignerIdentity 的情况下检测应用程序是否已被破解？

> ID：12774278
> 
> 赞同：9
> 
> 时间：2012-10-08T01:23:53.380
> 
> 标签：ios, iphone, ipad, app-store

曾经有一种方法可以检查应用程序是否是从 App Store 购买的，以防止破解：

```
NSBundle *bundle = [NSBundle mainBundle]; 
NSDictionary *info = [bundle infoDictionary]; 
if ([info objectForKey: @"SignerIdentity"] != nil) 
{ /* do something */  } 
```

但是这种方法不再有效，因为破解者已经找到了改变 Info.plist 的方法。我知道[这个较旧的问题](https://stackoverflow.com/questions/846309/reducing-piracy-of-iphone-applications)，但那里提供的答案依赖于上述技术，该技术不再有效。

在不读取 Info.plist 中的 SignerIdentity 的情况下，如何检测您的应用程序是否被破解或从 App Store 合法购买？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-19T14:10:44.040

我个人喜欢米克的回答，因为它简短而简单。

Greg 的响应无效——Mick 的代码只检查应用程序是否可以打开该 URL，因此应该没有崩溃的机会。

我已经在我的一个应用程序中实现了以下功能，之前对应用程序是否加密进行了更严格的检查，如果不是，它很可能是破解的应用程序：

从分析来看，这种方法为我阻止了成千上万的盗版用户，并且可能需要 5 分钟来实施，所以这样做的成本几乎为零——对我来说，我不在乎它是否会增加销售额（我确信它是无论如何都不会——更重要的是，我不希望人们从我的辛勤工作中白白浪费）。此外，在确定应用程序是否为盗版后，我的应用程序的大量内容会提供信息，如果是，则返回垃圾数据。

在 main.m

```
#import <dlfcn.h>
#import <mach-o/dyld.h>
#import <TargetConditionals.h>

#if TARGET_IPHONE_SIMULATOR && !defined(LC_ENCRYPTION_INFO)
#define LC_ENCRYPTION_INFO 0x21
struct encryption_info_command {
    uint32_t cmd;
    uint32_t cmdsize;
    uint32_t cryptoff;
    uint32_t cryptsize;
    uint32_t cryptid;
};
#endif

static BOOL isEncrypted();

static BOOL isEncrypted () {
    const struct mach_header *header;
    Dl_info dlinfo;

    /* Fetch the dlinfo for main() */
    if (dladdr(main, &dlinfo) == 0 || dlinfo.dli_fbase == NULL) {
        //NSLog(@"Could not find main() symbol (very odd)");
        return NO;
    }
    header = dlinfo.dli_fbase;

    /* Compute the image size and search for a UUID */
    struct load_command *cmd = (struct load_command *) (header+1);

    for (uint32_t i = 0; cmd != NULL && i < header->ncmds; i++) {
        /* Encryption info segment */
        if (cmd->cmd == LC_ENCRYPTION_INFO) {
            struct encryption_info_command *crypt_cmd = (struct encryption_info_command *) cmd;
            /* Check if binary encryption is enabled */
            if (crypt_cmd->cryptid < 1) {
                /* Disabled, probably pirated */
                return NO;
            }

            /* Probably not pirated <-- can't say for certain, maybe theres a way around it */
            return YES;
        }

        cmd = (struct load_command *) ((uint8_t *) cmd + cmd->cmdsize);
    }

    /* Encryption info not found */
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-27T20:32:20.203

苹果官方的回答：

```
Hello Dmitry,

Thank you for contacting Apple Developer Technical Support (DTS). 

DTS does not provide code-level support for DRM issues.  

Please try posting your inquiry to Apple Development Forum:

<https://devforums.apple.com>

While you were initially charged a Technical Support Incident (TSI) for this request, we have assigned a replacement TSI back to your account.

Thank you for understanding our support policies.

Best Regards,

Apple Developer Support 
Worldwide Developer Relations 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T21:18:58.787

我会建议一个更小的代码片段，它与@user1353482 建议的功能相同（并且方式相同）。我会写评论，但那时代码将不可读。此外，我可能是错的，但似乎即使在为模拟器编译时也不再需要额外的定义（至少这在 xcode 4.5.1 中有效，目标是 5.0）。

请注意，此代码在 debug 和 adhoc 二进制文件中返回 false，但我们谈论的是 appstore，对吗？最终加密的是苹果公司，你不应该在家里尝试这个:)

```
#include <execinfo.h>
#import <mach-o/ldsyms.h>

bool executableEncryption()
{
    const uint8_t *command = (const uint8_t *) (&_mh_execute_header + 1);
    for (uint32_t idx = 0; idx < _mh_execute_header.ncmds; ++idx)
    {
        if (((const struct load_command *) command)->cmd == LC_ENCRYPTION_INFO)
        {
            struct encryption_info_command *crypt_cmd = (struct encryption_info_command *) command;    
            if (crypt_cmd->cryptid < 1)
                return false;
            return true;
        }
        else
        {
            command += ((const struct load_command *) command)->cmdsize;
        }
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-10-12T08:32:36.437

虽然不是检查应用程序是否是从 App Store 购买的，但我使用此代码检查我的应用程序是否在越狱设备上运行：

```
+(BOOL)isJailbroken { 
    NSURL* url = [NSURL URLWithString:@"cydia://package/com.example.package"]; 
    return [[UIApplication sharedApplication] canOpenURL:url]; 
} 
```

# python - 如何检查变量是否等于一个字符串或另一个字符串？

> ID：12774279
> 
> 赞同：85
> 
> 时间：2012-10-08T01:24:07.093
> 
> 标签：python

```
if var is 'stringone' or 'stringtwo':
    dosomething() 
```

这不起作用！我有一个变量，当它是其中一个值时，我需要它来做某事，但它不会进入 if 语句。在 Java`if (var == "stringone" || "stringtwo")`中工作。我如何用 Python 写这个？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-10-08T01:32:20.237

这不符合您的预期：

```
if var is 'stringone' or 'stringtwo':
    dosomething() 
```

它与以下内容相同：

```
if (var is 'stringone') or 'stringtwo':
    dosomething() 
```

这始终是正确的，因为`'stringtwo'`被认为是“真实”值。

有两种选择：

```
if var in ('stringone', 'stringtwo'):
    dosomething() 
```

或者你可以编写单独的相等测试，

```
if var == 'stringone' or var == 'stringtwo':
    dosomething() 
```

不要使用`is`，因为`is`比较对象身份。有时你可能会侥幸逃脱，因为 Python 实习了很多字符串，就像你在 Java 中可能侥幸逃脱，因为 Java 实习了很多字符串。`is`但除非你真的想要对象身份，否则不要使用。

```
>>> 'a' + 'b' == 'ab'
True
>>> 'a' + 'b' is 'abc'[:2]
False # but could be True
>>> 'a' + 'b' is 'ab'
True  # but could be False 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-08T01:27:11.037

```
if var == 'stringone' or var == 'stringtwo':
    do_something() 
```

或者更多pythonic，

```
if var in ['string one', 'string two']:
    do_something() 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-08T01:26:47.893

```
if var == 'stringone' or var == 'stringtwo':
    dosomething() 
```

'is' 用于检查两个引用是否指向同一个对象。它比较内存地址。显然，“stringone”和“var”是不同的对象，它们只是包含相同的字符串，但它们是“str”类的两个不同实例。所以它们当然有两个不同的内存地址，'is' 将返回 False。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-08T01:27:34.413

两个单独的检查。此外，使用`==`而不是`is`检查相等性而不是身份。

```
 if var=='stringone' or var=='stringtwo':
     dosomething() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-31T09:54:18.697

```
for a in soup("p",{'id':'pagination'})[0]("a",{'href': True}):
        if createunicode(a.text) in ['<','<']:
            links.append(a.attrMap['href'])
        else:
            continue 
```

这个对我有用。

# delphi - 如何减小我的 Delphi dll 的大小？

> ID：12774283
> 
> 赞同：8
> 
> 时间：2012-10-08T01:25:13.520
> 
> 标签：delphi, dll, delphi-7, delphi-xe3

我最近从 Delphi 7 搬到了 Delphi XE3。

Delphi 7 中 107kb 的 dll 文件现在编译为 2.7 MB。另一个 114kb 现在是 4.7 MB！

这是正常的吗？我可以做些什么来减少文件大小？如果您需要更多信息，请询问。

更新：

这两个 dll 文件已经在发布模式下编译。

听从梅森的建议后：

4.7MB 文件减少到 834kb，2.7MB 文件减少到 2.1MB。这个 2.1MB 的文件利用了泛型和一个名为 nExcel 的外部库，用于生成 Excel 文件。虽然在文件大小较小时也使用了 nExcel，但使用泛型是代码的新增功能，我猜这可能是文件大小保持相当大的原因。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-08T01:37:21.037

其中一些是不可避免的；随着更多功能的添加，RTL 变得更大。然而，这个大小增加的很大一部分将是由于在 Delphi 2010 中添加了扩展的 RTTI。

您可以通过将以下两行放在主项目文件中的任何`uses`子句之前来解决此问题：

```
{$RTTI EXPLICIT METHODS([]) PROPERTIES([]) FIELDS([])}
{$WEAKLINKRTTI ON} 
```

这些将导致编译器在整个项目中最小化扩展 RTTI。（请注意，这意味着您将无法使用 RTTI 功能。但由于这是一个 Delphi 7 项目，您可能还没有使用它。您需要阅读扩展 RTTI 并查看您是否可以找到有用的事情来做。）

# android - 在测试用例中，第二个 getActivity() 没有调用 onCreate()

> ID：12774288
> 
> 赞同：0
> 
> 时间：2012-10-08T01:26:29.650
> 
> 标签：android, android-testing

我有一个单元测试，在我销毁并完成应用程序后，我再次调用 getActivity() 以验证它是否正确加载。但是，它没有调用 onCreate()！

```
public void testHistory() { 
            ...
    mActivity.onPause(); 
    mActivity.finish(); 
    assertTrue(mActivity.getExtractor() == null);
    assertTrue(mActivity.getSettings() == null);
    Log.d(TAG, "**************  Restarting app to verify load.");
    mActivity = getActivity(); 
    assertTrue(mActivity != null);
    assertTrue(mActivity.getExtractor() != null); //////// THIS FAILS!!! 
```

这是日志

```
10-07 21:11:40.467: D/SpeedyReader(15441): onPause()
10-07 21:11:40.514: D/SpeedyReader(15441): Saving 5 articles, 1 historical articles...
10-07 21:11:40.709: D/SpeedyReader(15441): Saved articles. success: true, length: 88218
10-07 21:11:40.764: D/SpeedyReader(15441): onStop()
10-07 21:11:40.764: D/SpeedyReader(15441): onDestroy()
10-07 21:11:40.772: D/SpeedyReader(15441): finish()
10-07 21:11:40.772: D/SpeedyReader(15441): **************  Restarting app to verify load.
10-07 21:11:40.772: D/SpeedyReader(15441): finish()
10-07 21:11:40.897: D/SpeedyReader(15441): onCreate()
10-07 21:11:40.944: D/SpeedyReader(15441): finalize()
10-07 21:11:40.944: D/SpeedyReader(15441): Settings.load() wpm:300
10-07 21:11:40.944: D/SpeedyReader(15441): Loading articles... 
```

我不知道为什么它在日志文件中说 onCreate 。就像 onCreate() 被异步调用一样！这是我的 onCreate()。

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Log.d(TAG, "onCreate()");
    ....
    extract = new Extractor(); 
```

我试过 waitForIdleSync()

```
 Log.d(TAG, "**************  Restarting app to verify load.");
    mActivity = getActivity(); // restart the app, reload the history
    getInstrumentation().waitForIdleSync(); // ------------ NEW 
```

但这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:40:40.030

我认为就框架而言，这是预期的行为。

我假设您正在扩展 ActivityInstrumentationTestCase2 或 ActivityUnitTestCase。[ActivityUnitTestCase](http://developer.android.com/reference/android/test/ActivityUnitTestCase.html)声明 finish() 什么都不做。至于你的异步行为，你通常从 InstrumentationThread 运行测试，我相信生命周期的回调需要从主线程调用。您的示例代码中没有这样做。

至于没有调用 onCreate 的实例，getActivity() 将断言 onCreate() 被正确调用，但其余的由您决定。就实际生命周期而言，在同一个测试调用中对活动调用 finish() 没有任何作用。它不会自动注销活动。仅在活动的 finish() 方法中运行代码。因为 getActivity() 可以被多次调用，并且只会在同一个实例上调用一次 onCreate()。它永远不会在同一个测试用例中再次调用 onCreate() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:16:48.617

找到了！采用

```
 getInstrumentation().callActivityOnCreate(mActivity, null); 
```

# php - 向所有用户发送自定义电子邮件 - PHP 代码问题

> ID：12774293
> 
> 赞同：0
> 
> 时间：2012-10-08T01:27:33.827
> 
> 标签：php, sql

我目前正在设计一个概念的原型，所以我正在使用 PHPMailer 来生成/发送电子邮件。我会尽快转向 SendGrid 之类的东西，但这不是目前的问题。我需要向数据库中的每个用户发送一封电子邮件，但电子邮件将根据存储在数据库中的元素（特定于单个用户）进行定制。

我让 PHPMailer 从数据库中提取字段并发送邮件。但是，当我尝试添加循环遍历所有用户并为每个用户生成电子邮件的功能时，我似乎遇到了一些 PHP/SQL 问题。

“用户”表包含以下字段：cid、email、fname、lname。我需要提取 cid 以提取数据库中的其他信息，并且我需要电子邮件，以便我知道将消息发送到哪里。这是我的 SQL/PHP：

```
require_once('/PHPMailer_v51/class.phpmailer.php');
include $_SERVER['DOCUMENT_ROOT'] . '/NG/includes/db.inc.php';

try
{
$sql = 'SELECT * FROM users';
$result = $pdo->prepare($sql);
$result->execute();
}

catch (PDOException $e)
{
$error = 'Error fetching user information.';
include 'error.html.php';
exit();
}

 foreach ($result as $row);
 {
  try
  {
    $high_result = $pdo->query('SELECT title FROM book WHERE topic = "high" and cid = $row['cid']');
  }
  catch (PDOException $e)
  {
  $error = 'Error fetching fields from database!';
  include 'error.html.php';
  exit();
  }
  .... the rest of the for statement.... 
```

我在 $high_result 行上遇到了意外的 T_STRING 错误。“用户”数据库具有以下字段：cid、电子邮件、fname、lname。我不能在 sql 语句中引用数组吗？如果没有，关于我应该如何尝试这样做的任何想法？

谢谢，

缠绕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:31:59.463

你有一个 ”;” 在你的 foreach 行，删除它，它应该可以工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:31:36.623

查询应该是

```
$high_result = $pdo->query('SELECT title FROM book WHERE topic = "high" and cid = $row[cid]'); 
```

你已经包含`'`在里面`$row['cid']`，那是错误的。在 foreach 循环中`;`也有一个错误删除它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T01:43:41.777

```
foreach ($result as $row) // The semicoln here is not required
 //... The rest of the statements

$high_result = $pdo->query("SELECT title FROM book WHERE topic = "high" and cid = '. $pdo->quote($row[cid])); 
```

引号，以防您的字段是字符串。

# android - Android：按名称获取自定义xml类对象的资源ID

> ID：12774295
> 
> 赞同：1
> 
> 时间：2012-10-08T01:28:12.330
> 
> 标签：android, android-xml, android-resources

我的“res”文件夹中有一个自定义文件夹、文件和自定义 XML 资源类。

我创建了一些自定义对象，我称之为：

```
<area id="@+id/someId" name="Some Name" /> 
```

我可以通过 R.id.someId 静态访问它们。

但是，我需要在运行时获取资源 ID，并且需要通过“名称”来执行此操作。换句话说，我在列表中显示“某个名称”，并且我需要获取知道用户从 ListView 中选择了“某个名称”的 id。（我**不是**在寻找 ListItem 的 id，我实际上是想搜索我的资源并获取区域 xml 对象的 id）

例如：

我想做以下事情：

```
int id = getIdFromResourceName("Some Name"); 
```

这可能吗？

我试过使用：

```
int i = this.getResources().getIdentifier("Some Name", "area", this.getPackageName()); 
```

...但这似乎不起作用。我总是得到0。

**编辑**

正如 Geobits 下面建议的那样，有没有办法从 res 文件中加载所有资源并将它们保存在数组/地图中，`Map<id,name>`以便我以后可以搜索它们？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:22:16.553

我不确定这是否是您需要的。但这是我的解决方案建议。如果您的资源是可绘制的，我会这样做：

```
 public int findResourceIdByName(String name) {
        Field[] fields = R.drawable.class.getFields();  // get all drawables
        try {
            for(int i=0; i<fields.length; i++) {        // loop through all drawable resources in R.drawable
                int curResId = fields[i].getInt(R.drawable.class); // Returns the value of the field in the specified object as an int.
                                                                  //This reproduces the effect of object.fieldName

                Drawable drawable = getResources().getDrawable(R.drawable.icon); // get the Drawable object
                if(drawable.getName().equals(name)) {   //getName() is NOT possible for drawable, this is just an example
                    return curResId;                    // return the corresponding resourceId
                                                        // or you could return the drawable object instead, 
                                                        // depending on what you need.
                }
            }

            return -1; // no ResourceId found for this name

        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    } 
```

这是使用反射，所以它不是最有效的方法。如果你经常调用这个方法，你可能需要缓存

```
Field[] fields = R.drawable.class.getFields(); 
```

至少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T01:35:44.860

试试这个：

```
int i = this.getResources().getIdentifier("someId", "id", this.getPackageName()); 
```

它想要的`defType`是它是什么形式的标识符。既然是`R.id.someId`，你要`id`。如果是`R.drawable.someDrawable`，你会使用`drawable`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T01:34:34.143

尝试使用，

```
int resID=getResources().getIdentifier("name", "id", getPackageName()); 
```

获取资源的 ID。

# c - Arduino草图中的字符长度

> ID：12774297
> 
> 赞同：2
> 
> 时间：2012-10-08T01:28:40.723
> 
> 标签：c, char, arduino

我`char`在 Arduino 草图中有以下内容：

```
char inData[80]; 
```

当我打印到串行控制台时：

```
Serial.print(strlen(inData) - 1); 
```

我期待看到：**79**而我看到：**655356553501234567**

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T01:34:32.333

`strlen`正在寻找终止的 nul。在未初始化的数组或指针上调用它会导致未定义的行为。你想要`sizeof(inData)`。

# ruby-on-rails - 我可以在不先调用条目的情况下获取 Mongoid::Criteria 中项目的索引吗？

> ID：12774298
> 
> 赞同：0
> 
> 时间：2012-10-08T01:28:59.977
> 
> 标签：ruby-on-rails, ruby, mongoid

就我而言：

```
portfolio_items.published.sorted.entries.index { |x| x.id == item.id } 
```

有没有办法不必调用“条目”，而是直接从 mongo(id) 获取这个值？

# node.js - Node.js 错误 Arduino 串行监视器输入

> ID：12774299
> 
> 赞同：1
> 
> 时间：2012-10-08T01:29:00.727
> 
> 标签：node.js, runtime-error

我正在尝试学习 Node.js 以尝试通过串行端口连接一个工作的 Arduino 示例。代码如下：

```
var serialport = require("serialport"); // include the serialport library
var SerialPort = serialport.SerialPort; // localize object constructor

var express =   require('express'),
    app     =   express()
    , http  =   require('http')
    , server =  http.createServer(app)
    , io    =   require('socket.io').listen(server);

// listen for new web clients:
server.listen(8080);        

// open the serial port. Change the name to the name of your port, just like in Processing and Arduino:
var sp = new SerialPort("/dev/ttyACM0", { 
    // look for return and newline at the end of each data packet:
    parser: serialport.parsers.readline("\r\n") 
});

// respond to web GET requests with the index.html page:
app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

// listen for new socket.io connections:
io.sockets.on('connection', function (socket) {
    // if there's a socket client, listen for new serial data:  
    sp.on('data', function (data) {
        // set the value property of scores to the serial string:
        scores.value = data;
        // for debugging, you should see this in Terminal:
        console.log(data);
        // send a serialdata event to the web client:
        socket.emit('serialEvent', scores);
    });
}); 
```

代码成功执行，输出如下：

```
 info  - socket.io started
   debug - served static content /socket.io.js
   debug - client authorized
   info  - handshake authorized Yh2i5KCqhagEnCIK41q3
   debug - setting request GET /socket.io/1/websocket/Yh2i5KCqhagEnCIK41q3
   debug - set heartbeat interval for client Yh2i5KCqhagEnCIK41q3
   debug - client authorized for 
   debug - websocket writing 1:: 
```

然后我在我的 Arduino 串行监视器中输入一些输入，我的 Node.js 脚本崩溃并出现以下错误：

```
/home/sisko/NodeJS/nodeSerialServer/serialServer.js:49
        scores.value = data;
        ^
ReferenceError: scores is not defined
    at SerialPort.<anonymous> (/home/sisko/NodeJS/nodeSerialServer/serialServer.js:49:3)
    at SerialPort.EventEmitter.emit (events.js:93:17)
    at parsers.readline (/home/sisko/NodeJS/nodeSerialServer/node_modules/serialport/serialport.js:36:17)
    at Array.forEach (native)
    at Object.parsers.readline [as parser] (/home/sisko/NodeJS/nodeSerialServer/node_modules/serialport/serialport.js:35:13)
    at process.nextTick.options.dataCallback (/home/sisko/NodeJS/nodeSerialServer/node_modules/serialport/serialport.js:89:15)
    at EventEmitter.emit (events.js:93:17)
    at ReadStream._emitData (fs.js:1365:10)
    at afterRead (fs.js:1347:10)
    at Object.wrapper [as oncomplete] (fs.js:362:17) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:11:47.033

您需要定义 score 变量并对其进行初始化。

```
var express =   require('express'),
    app     =   express(),
    http  =   require('http'),
    server =  http.createServer(app),
    io    =   require('socket.io').listen(server),
    scores = {}; 
```

# c++ - C++：关于链表的实现

> ID：12774302
> 
> 赞同：0
> 
> 时间：2012-10-08T01:29:28.650
> 
> 标签：c++, templates, linked-list

我不断收到我的一个函数的编译器错误。

```
LinkedList.hpp:81: error: `template<class T> class LinkedList' used without template parameters
LinkedList.hpp:81: error: expected constructor, destructor, or type conversion before '*' token
LinkedList.hpp:81: error: expected `;' before '*' token 
```

但问题是我有一个构造函数、析构函数和类型转换。我很确定实施是错误的

```
// This is the function i keep on getting an error for
template <class T>
ListNode* LinkedList<T>::find(int pos)//Finds the position of an item
{
    if(pos < 1)
        return NULL; //If pos is less than one then find returns NULL because pos is a illegal value.
    else
    {
        ListNode *temp = head;
        for(int i = 1; i < pos; i++)
            temp = temp -> next;
        return temp;
    } 
}

//The class 
template <class T>
class LinkedList : public ABCList<T> {
private:
    //T    a [LIST_MAX];

    struct ListNode
    {
        T data; // List item
        ListNode *next; //Pointer to next node
    };

    int  size;
    ListNode *head;
    ListNode *find(int pos);

public:
    LinkedList();
    LinkedList(LinkedList &other);
    ~LinkedList();
    virtual bool isEmpty () = 0;
    virtual int  getLength () = 0;
    virtual void insert (int pos, T item) = 0;
    virtual T    remove (int pos) = 0;
    virtual T    retrieve (int pos) = 0;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:37:30.757

1.  当标准库提供链表时，为什么要创建链表？`std::list`是一个双链表。
2.  你可以`ListNode*`在`typename LinkedList<T>::ListNode*`定义中`find()`重写
3.  您必须选择是否希望用户能够操作`ListNode`，（在这种情况下，您应该将其声明为公共），或者它是否是实现的一部分（在这种情况下，您可能想要创建某种迭代器）。

* * *

> 我仍然遇到同样的错误

如问题中所述，定义是否`find()`位于`LinkedList`类声明的顶部？如果是这种情况，您应该交换它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T01:38:39.000

我看到的一件事是 ListNode 是在 LinkedList 中定义的，因此必须以这种方式进行限定：

```
template <class T>
typename LinkedList<T>::ListNode* LinkedList<T>::find(int pos) {
    ...
} 
```

# transactions - 水平可扩展/可复制的数据库

> ID：12774303
> 
> 赞同：4
> 
> 时间：2012-10-08T01:29:33.050
> 
> 标签：transactions, nosql, cassandra, ravendb

我对存储金融相关交易有特定要求。这需要事务支持、高可用性、容错和水平可扩展性。我正在寻找一个开源解决方案。

现在据我了解，没有任何免费的 RDBMS（Postgres 或 MySql 之类的）提供此功能。我在以前的项目中使用过 cassandra，该项目在复制和分片方面非常方便。哇，我也喜欢它的性能。但不幸的是，Cassandra 不支持 ACID 事务，因为它是基于 CAP 定理构建的。

现在，我什至对出色/超快的性能都不是特别关注。我正在寻找一种性能略高于或等于 RDBMS，但具有复制和分片的性能。原因是我们正在寻找放置许多服务器来处理负载，并且每个实例都应该能够在任何时间点为某些 x 客户端提供服务。

任何人都可以想到一个免费的（或非常划算的低于 500 美元）RDBMS 数据库或没有 sql 存储 - 事务支持（提交/回滚） - 复制 - 分片。

目前我们在选择列表中有 ravendb。你觉得这合适吗？

PS：我看过以下链接 [你能推荐一个水平扩展的数据库吗？](https://stackoverflow.com/questions/42649/can-you-recommend-a-database-that-scales-horizontally)- 在 2008 年讨论过，而且很老。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T08:20:35.853

RavenDB 将是一个很好的批次。它可以水平扩展，支持开箱即用的分片和复制。它具有 ACID 事务和自动故障转移。

有关详细信息，请参见此处：[http ://ravendb.net/features](http://ravendb.net/features)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T19:34:06.830

您可以尝试使用同一数据库的多个实例/副本进行扩展，并使它们与提供分布式 ACID 的 JTA 保持同步，这对于轻松进行 ACID 水平扩展很有用。尽管写入是线性昂贵的，但读取可以分布在节点之间，并且通常读取比写入频繁得多。

本文展示了这种方法的一个示例，代码基于特定的 Java ORM 工具（[JEPLayer ）](http://java.dzone.com/articles/horizontal-scaling-rdbms-jta) [，](https://code.google.com/p/jeplayer/)但核心原理 JTA 可以应用于不同的数据库 JTA 兼容工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T11:41:39.410

看看伏特。（社区版）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-09T02:53:00.723

[HBase](https://hbase.apache.org/)适合您的用例。它符合 CAP 标准的 Consistency and Partition 容差（Consistency, Availability and Partition Tolerance）

几个突出的特点：

1.  线性和模块化的可扩展性。
2.  严格一致的读取和写入。
3.  自动和可配置的表分片
4.  RegionServers 之间的自动故障转移支持。

看看[架构](https://hbase.apache.org/book.html#_architecture)以获得更好的理解。

# php - jQuery Raty - 第一个值是从 PHP 传递的空值

> ID：12774305
> 
> 赞同：0
> 
> 时间：2012-10-08T01:29:44.267
> 
> 标签：php, jquery, raty

我正在尝试使用 jQuery 比率插件在同一页面上显示多个评级，并将值存储在 php 变量中。以下是我正在使用的代码：

```
<script>
$('.star').raty({score: <?php echo $slide['Article']['rating']; ?>});
</script>
<div class="star"></div> 
```

我遇到的问题是第一个评级是空的，然后由于第一个评级没有正确填充，之后的所有评级都是 1 分。我不是 jQuery 人，所以如果第一次填充后的变量，我不太确定我哪里出错了。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:37:30.413

将其转换为浮动：

```
$('.star').raty({
    score: <?php echo (float) $slide['Article']['rating']; ?>
}); 
```

这样`NULL`会产生一个值`0`而不是一个会导致 js 错误的空字符串，并且具有确保该值在您的 javascript 中 100% 安全使用的额外好处。其他无效值也将`0`在演员表之后。

# java - 什么是使用 BackOffPolicy 的“优雅”方法

> ID：12774306
> 
> 赞同：4
> 
> 时间：2012-10-08T01:29:58.027
> 
> 标签：java, google-drive-api

我偶尔注意到我的 Drive SDK 调用会定期失败并出现 500 错误，重试请求通常会立即修复错误。查看 Google 文档，它建议使用指数退避技术，我编写了自己的实现，效果很好，但是在调试时我碰巧碰到接口 BackOffPolicy，经过更多调查，我什至发现了 ExponentialBackOffPolicy 实现。

因此，与其自己管理这个，我认为最好删除我的实现并让 SDK 为我做这件事。退避策略（据我所知）可以通过构建的 HTTP 请求设置，因此在手动构建请求或使用批处理请求时非常容易使用，但是在使用核心 SDK 时我似乎找不到最简单的注入位置，例如，如果我想为以下内容设置退避策略：

```
drive.files().get(id).execute(); 
```

我不能做类似的事情：

```
drive.files().get(id)
     .setBackOffPolicy(new ExponentialBackOffPolicy())
     .execute(); 
```

我需要这样做：

```
drive.files().get(id)
     .buildHttpRequest()
     .setBackOffPolicy(new ExponentialBackOffPolicy())
     .execute(); 
```

但是，如果我这样做，那么我还需要重现 Drive.Files.Get 的执行方法的解析逻辑并将结果转换为 File 对象，这显然不是一个理想的方法。是否有一种更简单的方法可以“一般”将其添加到请求中，或者是否有一种方法可以为所有请求设置默认退避策略？

如果没有，也许这可以被引入到 Drive SDK 的未来版本中？

谢谢，大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T23:29:31.400

Google Drive SDK 文档包含一个示例，展示了如何使用 Drive API 正确实现指数退避：

[https://developers.google.com/drive/handle-errors](https://developers.google.com/drive/handle-errors)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-20T09:48:42.117

这是用于指数退避的代码：

```
boolean thisIsARetry = false;
boolean keepRetrying = true;
int delayTime = 2;
int maxDelayTime = 4;

while(keepRetrying && delayTime <= maxDelayTime) {
    if(thisIsARetry) {
        //sleep for delayTime seconds
        try {
            Thread.sleep(1000 * delayTime);
            delayTime *= 2;
        } catch (Exception e) {
            //print exception
            delayTime *= 2;
            continue;
        }
    } else {
        thisIsARetry = true;
    }

    //the actual network request or some other operation here
    if(ACTUAL_OPERATION_SUCCESS) {
        keepRetrying = false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:29:25.380

AFAIK Google 制造的指数退避仅在驱动 Java API 中下载或上传内容时使用。对于其他请求，您需要自己的实现。

我为任何请求实现它所做的是包装一个 Callable 执行一次请求并让包装类执行异常处理和重复请求。

# ruby - 使用 MacRuby 和 Scripting Bridge 关闭窗口

> ID：12774308
> 
> 赞同：2
> 
> 时间：2012-10-08T01:30:16.073
> 
> 标签：ruby, cocoa, macruby, scripting-bridge

我正在尝试编写一个快速脚本，该脚本将关闭终端应用程序的当前窗口以外的所有窗口。该脚本使用 MacRuby 和 Scripting Bridge。这是我到目前为止所拥有的：

```
#!/usr/local/bin/macruby

framework "Foundation"
framework "ScriptingBridge"

terminal = SBApplication.applicationWithBundleIdentifier("com.apple.Terminal")
terminal.windows[2].close while terminal.windows.count > 1 
```

当我尝试运行它时，我收到以下错误：

```
undefined method `close' for #<TerminalWindow:0x40033b0e0> (NoMethodError) 
```

这种方法似乎适用于 AppleScript。有谁知道它为什么在这里失败？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T09:28:00.430

[我在这里](http://www.mugginsoft.com/html/kosmictask/ScriptingBridgeDox/Apple/Terminal/OS-X-10.7/Terminal-2.2.2/html/interface_terminal_window.html#details)找到了`TerminalWindow`API的副本。使用它，我需要做的就是：

```
TerminalSaveOptionsNo = 'no  '.unpack('N').first
terminal.windows[1].closeSaving(TerminalSaveOptionsNo, savingIn: nil) 
```

# php - 修改 Avada Wordpress 主题的 header.php

> ID：12774311
> 
> 赞同：0
> 
> 时间：2012-10-08T01:30:45.230
> 
> 标签：php, wordpress, wordpress-theming

测试站点示例：[http ://cincinnati-website-design.net/sandbox/](http://cincinnati-website-design.net/sandbox/)

我正在使用 Avada 主题，但似乎无法通过支持获得帮助。他们只是告诉我去找开发商。

我试图让“页面标题容器”出现在主索引/主页上。它在所有其他页面上都正确显示，但显然它旨在不显示在主索引或主页上。

header.php 片段：

```
<?php if(of_get_option('page_title_bar', 'yes') == 'yes'): ?>
<?php if(((is_page() || is_single() || is_singular('avada_portfolio')) && get_post_meta($post->ID, 'pyre_page_title', true) == 'yes') && !is_front_page()): ?>
<div class="page-title-container">
    <div class="page-title">
        <h1><?php the_title(); ?></h1>
        <?php kriesi_breadcrumb(); ?>
    </div>
</div>
<?php endif; ?>
<?php if(is_home() && !is_front_page() && get_post_meta($slider_page_id, 'pyre_page_title', true) == 'yes'): ?>
<div class="page-title-container">
    <div class="page-title">
        <h1><?php echo of_get_option('blog_title', 'Blog'); ?></h1>
        <?php kriesi_breadcrumb(); ?>
    </div>
</div>
<?php endif; ?>
<?php if(is_search()): ?>
<div class="page-title-container">
    <div class="page-title">
        <h1><?php _e('Search results for:', 'Avada'); ?> <?php echo get_search_query(); ?></h1>
    </div>
</div>
<?php endif; ?>
<?php if(is_archive()): ?>
<div class="page-title-container">
    <div class="page-title">
        <h1><?php single_cat_title(); ?></h1>
        <?php kriesi_breadcrumb(); ?>
    </div>
</div>
<?php endif; ?>
<?php endif; ?>
<div id="main" style="overflow:hidden !important;">
    <div class="row"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T10:07:30.827

这段代码：

```
is_front_page() 
```

是检查首页的内容。

尝试从上面的代码中删除以下内容：

```
&& !is_front_page() 
```

它出现两次，并告诉脚本不要在首页上执行后续操作。

# opengl - OpenGL为什么取消选择着色器程序？

> ID：12774312
> 
> 赞同：4
> 
> 时间：2012-10-08T01:31:07.730
> 
> 标签：opengl, shader, opengl-3

> **可能重复：**
> [是否需要 glDisableClientState？](https://stackoverflow.com/questions/12773010/is-gldisableclientstate-required)

在 OpenGL 中，我经常看到遵循这种模式的代码：

```
glUseProgram(prog_id);
// ... do some stuff
glUseProgram(0); 
```

我知道`glUseProgram(0)`取消选择任何着色器程序。现在我的问题是取消选择着色器程序意味着什么？

例如，为什么我应该或不应该在渲染循环中做这样的事情？

```
while(render_loop_condition)
{
    glUseProgram(prog_id);
    // do some stuff
}
// various cleanup code
glUseProgram(0); 
```

在使用多个着色器程序的渲染循环中，我可以做这样的事情吗：

```
while(render_loop_condition)
{
    glUseProgram(prog_id1);
    // do some stuff
    glUseProgram(prog_id2);
    // do some other stuff
}
// various cleanup code
glUseProgram(0); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T02:16:58.463

它用于避免对之后绘制的内容产生任何意外的副作用。在方法内的程序之间切换是完全可以的（在我看来，更可取），但在`0`方法的末尾选择默认程序（ ）。这样你在调用该方法后就不会遇到任何奇怪的副作用。

我能想到的副作用并不多，但我想如果你以固定功能的方式绘制一些东西，你会不小心用你绑定的最后一个程序来绘制。

请注意，使用您发布的第二个代码块，您可以将第一个`glUseProgram`调用移到 while 循环之外，以防止多次绑定同一个程序。

# c# - Linq to Entity Where 通过循环数据构建

> ID：12774316
> 
> 赞同：0
> 
> 时间：2012-10-08T01:32:04.370
> 
> 标签：c#, linq, entity-framework, entity-framework-4

我有一个搜索框，我已将数据分解为单词。我现在需要将这些单词中的每一个与数据库中的几个字段进行比较。这是我的代码：

```
List<string> searchValues = searchString.Split(delimiters, StringSplitOptions.RemoveEmptyEntries).ToList();

using (DatabaseEntities context = new DatabaseEntities())
{
    IQueryable<DatabaseType> returnValue =
    context.DatabaseType.Where(y =>
        y.Field1.Contains(searchValues[0]) ||
        y.Field1.Contains(searchValues[0]));

    searchValues.Skip(1).ToList().ForEach(x =>
    {
        returnValue = returnValue.Where(y =>
            y.Field1.Contains(x) ||
            y.Field2.Contains(x));
    });

    return returnValue.ToList(); 
```

我的目标是在将项目实际加载到内存之前构建完整的查询。但是，当我尝试运行它时，我收到以下错误：

```
System.NotSupportedException: LINQ to Entities does not recognize the method &#39;System.String get_Item(Int32)&#39; method, and this method cannot be translated into a store expression. 
```

我曾认为这种类型的错误意味着我正在尝试的操作在转换为 SQL 时不起作用，但我相当确定我以前使用过 Contains as LIKE 语句。此外，数据库中的所有信息都是 nvarchars，因此它们等同于我的实体中的字符串。有谁知道问题是什么？使用 IQueryable 是最好的方法吗？如果可能的话，我宁愿延迟加载所有这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:44:26.173

get_Item(Int32) 调用将成为列表的索引。在您的情况下，它们是 searchValues[0]。利用：

```
var searchValue = searchValues[0];

IQueryable<DatabaseType> returnValue =
context.DatabaseType.Where(y =>
    y.Field1.Contains(searchValue) ||
    y.Field1.Contains(searchValue)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:37:31.990

我使用下面的扩展方法为 Linq to Entities 构建包含类型表达式（对原始源的引用在评论中）。我认为它在这种情况下也会起作用。

```
 /// <summary>
    /// Extension method that enables .Contains(obj) like functionality for Linq to Entities.
    /// 
    /// Source: http://www.velocityreviews.com/forums/t645784-linq-where-clause.html
    /// </summary>
    /// <typeparam name="TElement">The element being evaluated by the Where clause</typeparam>
    /// <typeparam name="TValue">The value to match</typeparam>
    /// <param name="valueSelector">Lamda for selecting matching values</param>
    /// <param name="values">IEnumerable of the values</param>
    /// <returns>Expression consumable by Linq to Entities that reflects semantics of .Contains(value)</returns>
    /// <remarks>
    /// Usage:
    /// 
    /// Replace expression like 
    /// 
    /// where ChildrenIDs.Contains(items.CategoryID)
    /// 
    /// with
    /// 
    /// .Where((BuildContainsExpression<Item, int>(item => item.CategoryID, ChildrenIDs))
    /// 
    /// NOTE: If the item collection is large, the SQL query will be as well.
    /// </remarks>
    static public Expression<Func<TElement, bool>> BuildContainsExpression<TElement, TValue>(Expression<Func<TElement, TValue>> valueSelector, IEnumerable<TValue> values)
    {
        if (null == valueSelector)
        {
            throw new ArgumentNullException("valueSelector");
        }
        if (null == values) { throw new ArgumentNullException("values"); }

        ParameterExpression p = valueSelector.Parameters.Single();
        if (!values.Any())
        {
            return e => false;
        }

        var equals = values.Select(value => (Expression)Expression.Equal(valueSelector.Body, Expression.Constant(value, typeof(TValue))));
        var body = equals.Aggregate<Expression>((accumulate, equal) => Expression.Or(accumulate, equal));
        return Expression.Lambda<Func<TElement, bool>>(body, p);
    } 
```

示例用法：

```
var exprWithContains = 
    LinqToEntitiesUtil.BuildContainsExpression<List<int?>, int?>
        (p => p.ProductYear, productYears);

var result = (from p in products select p).Where(exprWithContains); 
```

# r - 当我通过 impute.knn 运行 Matrix 时，它变成了别的东西。

> ID：12774318
> 
> 赞同：1
> 
> 时间：2012-10-08T01:32:17.767
> 
> 标签：r, statistics

我是 R 新手，但我有一个微阵列数据集。我在一个位置有一个 NA 值，我尝试使用 library(impute) 中的 impute.knn()，但是在通过 impute.knn() 函数运行矩阵之后，它似乎变成了另一种结构。谁能解释发生了什么？

```
> m <- as.matrix(m)

# checking structure
> str(m)
  num [1:22283, 1:20] 1942.1 40.1 72.1 4693.6 35.9 ...
  - attr(*, "dimnames")=List of 2
  ..$ : chr [1:22283] "1007_s_at" "1053_at" "117_at" "121_at" ...
  ..$ : chr [1:20] "GSM146778-Normal" "GSM146780-Normal" "GSM146782-Normal"

# checking missing value of cell
> m[x,y] 
[1] NA

# impute missing value
> m.i <- impute.knn(m, 6)

# check value of imputed value
> m.i[x,y]
Error in r.imp["206054_at", "GSM146784-Normal"] : incorrect number of dimensions

# check structure of imputed matrix
> str(m.i)
List of 3
$ data     : num [1:22283, 1:20] 1942.1 40.1 72.1 4693.6 35.9 ...
..- attr(*, "dimnames")=List of 2
.. ..$ : chr [1:22283] "1007_s_at" "1053_at" "117_at" "121_at" ...
.. ..$ : chr [1:20] "GSM146778-Normal" "GSM146780-Normal" "GSM146782-Normal" "GSM146784-Normal" ...
$ rng.seed : num 3.62e+08
$ rng.state: int [1:626] 403 50 1992223309 -108730617 1600482030 698744776 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:35:43.550

看起来该`impute.knn`函数返回一个列表，其中包含矩阵和其他有关插补的数据。尝试使用：

```
m.i$data[x,y] 
```

# ruby-on-rails - Rails - 如何引用另一个模块中的类

> ID：12774322
> 
> 赞同：0
> 
> 时间：2012-10-08T01:33:25.250
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

如果我有一个从 Devise 继承的控制器，并且我想访问 Devise 之外的模块（例如，如果我有一个产品模型），我如何在从 Devise 继承的控制器中访问它？以下给了我一个`NameError uninitialized constant`：

```
 class RegistrationsController < Devise::RegistrationsController
    define foo
       Products.find(1)
    end
 end

 class ProductsController < ApplicationController

 end 
```

我试过了：

```
ApplicationController::Products.find(1)
ActiveRecord::Base::Products.find(1) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T01:36:55.270

产品是模型的名称吗？

如果是这样，您可以使用以下语法访问任何顶级常量

```
::Product 
```

这样 ruby​​ 不会先搜索当前模块上下文

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:36:17.327

没有必要这样的事情。模型不在任何模块内。

我认为您可能会感到困惑，并且您的模型类实际上是`Product`而不是`Products`至少您应该按约定命名它

# recursion - 测试二叉树的成员

> ID：12774324
> 
> 赞同：0
> 
> 时间：2012-10-08T01:33:34.130
> 
> 标签：recursion, binary-tree, member

我目前正在尝试遍历二叉树以检查某些值是否在其中。for 循环正在测试从 1 到 50 的所有值，并且将为每个匹配的值返回 true。

这是当前树：

```
 8
            /    \
           4      38
          / \    /  \
         3  7   31  39
        /      / \   \
       1     16  33  45

IntegerData test(0);
for (int i = 0; i < 50; i++) {
  test.value = i;
  if (bt->member(&test)) {
   cout << "member true for " << i << endl;
  }
} 
```

现在我必须实现成员函数，并且我有正确的想法，但是它在检查根、根->左和根->右后停止。我觉得好像我使用了正确的递归形式，但我想不是。这是我的代码：

```
bool BinaryTreeNode::member(Data * data) {
BinaryTreeNode *newNode = new BinaryTreeNode(data);
   if (data->compareTo(this->nodeData) == 0) {
       return true;
   }
   else if (data->compareTo(this->left->nodeData) == 0) {
       return true;
       newNode->member(data);
   }
   else if (data->compareTo(this->right->nodeData) == 0) {
       return true;
       newNode->member(data);
   }
   return false;
} 
```

前面提到的 for 循环打印出来

```
member true for 8
member true for 4
member true for 38 
```

但没有别的。

有人会通过伪代码或脚本提供一些指导吗？你不必给我代码，因为我想自己解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:07:08.207

假设这是一个有序的 BST：

```
bfs(root) {
    if (root is null) 
        return false // if we get to leaves without finding the target, it's not there
    if (root is target value)
        return true // if we found it, then YAY
    if (root is less than target value)
        return bfs(right child) // if target > root, target must lie in right subtree
    return bfs(left child) // otherwise target < root, check left subtree 
```

您只想检查*根*处的值是否是目标值。如果你检查孩子，你会检查他们中的一些人两次（一次是孩子，一次是根）。它还使代码更加复杂，这可能是导致您的逻辑错误的原因。

* * *

编辑：刚刚找到了[这个](http://www.algolist.net/Data_structures/Binary_search_tree/Lookup)算法的解释。

编辑：我还想强调你犯的一个小错误，我见过很多人都这样做 - 调用一个返回一些东西但没有对返回值做任何事情的函数。

我所说的线条是`newNode->member(data);`线条。在那里你调用了递归的下一步，但你还没有使用结果。这意味着您的程序一旦在树中找到较低的目标就不会*回溯。*要在递归函数中使用返回值，您必须拥有`return next_call()`（在这种情况下`return newNode->member(data);`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:42:45.377

这是树遍历算法的一个不稳定的实现。但是，如果您想保留现有的内容，请考虑将 return 语句的位置与它下面的语句切换。

但是，这就是我重构您的代码的方式

```
bool member(BinaryTreeNode *node, Data *data) {
   // Create wrapper for data
   BinaryTreeNode *newNode = new BinaryTreeNode(data);

   if (data->compareTo(node->nodeData) == 0) { // Check the current node only!
       return true;
   else  // delegate the rest of the tree to recursion.
       if (member(node->left,  data)) // Check the left
       || (member(this->right, data)) // Check the right
           return true;
       else
         return false;
} 
```

再说一次，你应该测试一下，让我知道它是否有效。我来自 Ruby，有一段时间没有用 C++ 编程了。

哦，当您想在驱动程序代码中调用它时，将二叉树的根节点作为第一个节点传递。如果这是一个类或模块函数，请尝试传递`self`. 我的希望是`self`指向`root`节点

# c# - 将图像从 Form2 传递到 Form1

> ID：12774326
> 
> 赞同：0
> 
> 时间：2012-10-08T01:33:55.127
> 
> 标签：c#, winforms

我无法将`PictureBox`我的第二个表单中的图像传递给我已经打开的第一个表单。

我正在使用这段代码：

```
private void btnCancel_Click(object sender, EventArgs e)
{
    var frmAdd = new frmAdd();

    frmAdd.pctImage.Image = pctImage.Image;

    if (btnCancel.Text == "C&OPY")
    {
        this.Close();
        return;
    }
    if (btnCancel.Text == "C&ANCEL")
    {
        this.Close();
        return;
    }
} 
```

我希望有人可以帮助我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:20:32.910

```
var frmAdd = new frmAdd(); 
```

这一行看起来就像您正在创建第一个表单的新实例`frmAdd`。因此，您实际上不是将图像传递给打开的表单，而是将其传递给另一个不同的实例。

如果您的第二个表单是由 创建的`frmAdd`，您可以向第二个表单添加一个引用的属性，`frmAdd`然后使用该属性设置图像。

你可能有一些看起来像这样的东西：

**第一形式**

```
// Just a way to launch the 2nd form
private void LaunchPictureForm()
{
    frmPicture pictureForm = new frmPicture();
    pictureForm.MyFirstForm = this;
    pictureForm.Show();
} 
```

**第二种形式**

```
public frmAdd MyFirstForm { get; set; }

private void btnCancel_Click(object sender, EventArgs e)
{
    MyFirstForm.pctImage.Image = pctImage.Image;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:38:49.900

根据[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.image.aspx)，当您将图像从一种形式传递到另一种形式时，您应该创建图像的克隆。就像是：

```
frmAdd.pctImage.Image = pctImage.Image.Clone() as Image; 
```

**编辑：**正如 lumberjack4 指出的那样，您还创建了一个新的、不可见的`frmAdd`并将您的图像分配给该表格，而不是已经显示的表格。该图像实际上可能已正确分配（尽管您仍应克隆它），但它在屏幕上永远不可见，因为您的本地`frmAdd`从未显示。这里有一些代码会告诉你如何做到这一点：

在`frmAdd`---------：

```
public partial class frmAdd : Form
{
    // Stores a reference to the currently shown frmAdd instance.
    private static frmAdd s_oInstance = null;

    // Returns the reference to the currently shown frmAdd instance
    // or null if frmAdd is not shown. Static, so other forms can
    // access this, even when an instance is not available.
    public static frmAdd Instance
    {
        get
        {
            return ( s_oInstance );
        }
    }

    public frmAdd ()
    {
        InitializeComponent ();
    }

    // Sets the specified picture. This is necessary because picAdd
    // is private and it's not a good idea to make it public.
    public void SetPicture ( Image oImage )
    {
        picAdd.Image = oImage;
    }

    // These event handlers are used to track if an frmAdd instance
    // is available. If yes, they update the private static reference
    // so that the instance is available to other forms.
    private void frmAdd_Load ( object sender, EventArgs e )
    {
        // Form is loaded (not necessarily visible).
        s_oInstance = this;
    }

    private void frmAdd_FormClosed ( object sender, FormClosedEventArgs e )
    {
        // Form has been closed.
        s_oInstance = null;
    }

    // Whatever other code you need
} 
```

在 frmNew ---------:

```
public partial class frmNew : Form
{
    public frmNew ()
    {
        InitializeComponent ();
    }

    private void btnCancel_Click ( object sender, EventArgs e )
    {
        // Is there an active instance of frmAdd? If yes,
        // call SetPicture() with a copy of the image used by
        // this frmNew.
        frmAdd oFrm = frmAdd.Instance;

        if ( oFrm != null )
            oFrm.SetPicture ( picNew.Image.Clone () as Image );
    }
} 
```

涉及2 个`PictureBox`控件：`picAdd`on`frmAdd`和`picNew`on `frmNew`。单击时`btnCancel`，代码`frmNew`检查是否存在有效`frmAdd`实例，如果是，则设置其图像。

请注意，这`picAdd`不是公共控制 - 它应该是私有的。在表单中将控件设置为公共不是一个好主意，因为它允许不受控制地访问它们，并且表单不会确定它们的状态（因为其他人可能会在表单不知道的情况下更改这些控件。）这可能会导致变化很大- 修复大型程序中的错误。

如果您需要访问其表单之外的控件，请将控件保留为私有并在表单中创建一个公共属性/方法，以便在必要时更新控件 - 就像上面的`SetPicture`方法一样。这仍然允许您从表单外部分配图片，但表单可以控制如何发生，因为`SetPicture`可以验证图像等。如果您只是将控件设置为公共，这是不可能的。

# arrays - Fortran 90 - 更改原点

> ID：12774327
> 
> 赞同：2
> 
> 时间：2012-10-08T01:33:57.773
> 
> 标签：arrays, fortran

这就是我想做的。

我有一个 100 x 100 的值网格，我的原始原点是 (0,0)。该原点位于中心（因此我的数组边界位于 -99:99 等）。在这个原点，我检查它的值，以及围绕该原点的值。我让我的程序在远离原点的水平和垂直距离中读取，根据我的代码，我得到了一组像这样组织的整洁的值。一个名叫约翰的人遇到了这样的问题 - 所以希望他能找到这个！

X = 未收集的值。O = 收集的值。

```
X  X  O  X  X

X  O  O  O  X

O  O  O  O  O

X  O  O  O  X

X  X  O  X  X 
```

根据我对与原点的水平和垂直距离的选择，我可以做一些这样的简洁的事情：

```
X  X  O  O  O  X  X

X  O  O  O  O  O  X

O  O  O  O  O  O  O

X  O  O  O  O  O  X

X  X  O  O  O  X  X 
```

现在，问题来了：我不希望我的原点一直是 0,0！我希望我的程序询问我的首选来源是什么，然后让程序进行相应的计算。这是我遇到一个大障碍的地方。我应该在我声明数组的代码开头写一些东西吗？我应该创建另一个循环吗？我真的很想学习 Fortran，做这些练习非常有价值——我很想在这里得到一些帮助。我在这里想念什么？

到目前为止，这是我的代码：

```
!!!!! Declare Variables.
implicit none
integer i, j, k, dist, vdist, row, col, nsum
integer, dimension (-99:99,-99:99) :: values
!!!!!
open(1, file='sampledata.dat')
!!!!! Create a data set from a loop.
do 10 j = -99,99
    do 10 i = -99,99
            values(i,j) = ((j-1) * 2) + (i-3)
10 continue
write(1,*) values
!!!!!
print *, 'Column,Row'
read (*,*) col, row
print *, 'Horizontal Distance From Origin'
read (*,*) dist
print *, 'Vertical Distance From Origin'
read (*,*) vdist
!!!!!
nsum = 0
!!!!!   If the vertical distance is greater than the horizontal distance…
if (vdist .GT. dist) then
do col = -dist, dist
    do row = -vdist + abs(col), vdist - abs(col)
    write (6,*) values(row,col)
    nsum = nsum + values(col,row)
    end do
end do
end if
!!   If the horizontal distance is greater than or equal to the vertical distance…
if (dist .GE. vdist) then
do col = -vdist, vdist
    do row = -dist + abs(col), dist - abs(col)
    write (6,*) values(col,row)
    nsum = nsum + values(col,row)
    end do
end do
end if
!!!!!
print *, nsum
close(1)
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T04:51:28.570

您可以将阵列的中心放置在您想要的任何位置，甚至可以在运行时决定。代替

```
integer, dimension (-99:99,-99:99) :: values 
```

利用

```
integer, dimension (:, :), allocatable :: values 
```

然后在代码的可执行部分决定数组的开始和结束，并在运行时指定数组的大小：

```
allocate ( values (start: end, start: end) ) 
```

然后将其余代码基于*start*和*end*而不是您现在使用的固定值。

# javascript - 如何使用 jQuery 更改子 DIV 的类？

> ID：12774328
> 
> 赞同：0
> 
> 时间：2012-10-08T01:34:12.103
> 
> 标签：javascript, jquery

我有以下内容：

```
<li>
   <a id="show">
      <div class="sprite-blank" ></div></a></li> 
```

如何使用 jQuery 将其更改为：

```
<li>
   <a id="show">
      <div class="sprite-balloon" ></div></a></li> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T01:37:02.427

```
$('li a#show div').removeClass('sprite-blank').addClass('sprite-balloon'); 
```

你也可以使用`toogleClass()`：

```
$('li a#show div').toggleClass('sprite-blank sprite-balloon'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T01:35:35.763

```
$('.sprite-blank').toggleClass('sprite-blank sprite-balloon'); 
```

这将改变页面上的所有可用`.sprite-blank`元素，如果您需要更具体，只需更改初始选择器，例如

```
$('a > .sprite-blank').toggleClass('sprite-blank sprite-balloon'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T01:35:59.140

只需这样做：

```
$(".sprite-blank").removeClass("sprite-blank").addClass("sprite-balloon"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T01:47:44.500

我认为你需要这样的东西：

[http://jsfiddle.net/yUaZe/](http://jsfiddle.net/yUaZe/)

HTML

```
<li>
   <a class="show" href="#">Show
     <div class="sprite sprite-hide" >Test</div>
    </a>
</li>
<li>
   <a class="show" href="#">Show
     <div class="sprite sprite-hide" >Ha</div>
    </a>
</li> 
```

CSS

```
.sprite-balloon {
    display:block;
}
.sprite-hide {
 display:none;   
}
​ 
```

JS

```
$('.show').click(
    function(event) {
    var that=$(this);
    event.preventDefault();
    that.find('.sprite').toggleClass('sprite-balloon');
    that.find('.sprite').toggleClass('sprite-hide');
    console.log(that);
    }
    );​ 
```

# c# - 无法在 Main() 中调用表单的公共函数？

> ID：12774329
> 
> 赞同：0
> 
> 时间：2012-10-08T01:34:26.030
> 
> 标签：c#

如果这看起来微不足道，我深表歉意，但我似乎无法理解这一点。这里的其他问题略有不同，所以这是我的问题：

我有一个**MainForm**

```
public partial class MainForm : Form
{
    public MainForm()
    {
        InitializeComponent();
    }
    public void activateButton()
    {
        button1.PerformClick();
    }
//........ 
```

我想`activateButton()`从`Main()`那里打电话

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Form myForm = new MainForm();
    Application.Run(myForm);
    myForm.activateButton() // error
} 
```

为什么`activateButton()`看不到 public 方法`myForm`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:38:00.367

变量`myForm`的类型为`Form`。如果您将其声明为`MainForm`您将能够访问您的方法：

```
MainForm myForm = new MainForm();
myForm.activateButton() // No error. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T02:19:01.760

正如其他评论者指出的那样，由于您的变量是 Form 而不是 MainForm 类型，您将遇到错误。但是还有另一个问题。一旦调用 Application.Run(form)，应用程序就进入了主消息泵循环。这本质上是一个无限的 while() 循环，它只检查用户输入并处理 Windows 消息分发（您可以通过覆盖表单的 WndProc 方法来挂钩）。因此，在您关闭表单之前，不会调用 Main 中的任何代码。

如果您在表单打开后尝试调用 activateButton() 方法，请尝试在表单的构造函数中调用它，或者更好的是通过覆盖 OnLoad() 并在那里调用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T01:38:06.583

```
MainForm myForm = new MainForm(); 
```

在您的原始代码中，编译时类型是`Form`，因此`activateButton`不可见。

# android - 带有垂直滑动的 Android 月视图

> ID：12774332
> 
> 赞同：1
> 
> 时间：2012-10-08T01:34:37.607
> 
> 标签：android, android-animation, android-calendar

我的要求是开发一个垂直滑动的月视图。

情况1：

我尝试使用[在 ViewPager 中垂直滚动页面中](https://stackoverflow.com/questions/8936327/having-vertically-scrolling-pages-in-viewpager)建议的 Directional-Viewpager 进行开发。

我面临以下问题。

1) 月和年没有限制，是无限的。我们应该选择一些无限的循环适配器，或者我们应该给用户创造幻觉。如何处理？

2) 每次不调用视图创建/更新函数。有时，当我们遍历查看的视图时会显示缓存视图，并且由于没有地方可以捕捉到这一点，我无法将标题和数据更新到 gridview。

3）当gridview上有按钮时，滑动不起作用。

案例-2：

这是我只是将动画应用于视图的简单方法。当向下拖动视图然后从顶部应用新的视图动画时。如果向上拖动，则从底部开始新的视图动画。由于 Gridview 下方没有其他视图，因此底部的动画正在工作。1) 顶部的 gridview 动画出现在标题的顶部，看起来很难看。

2）当gridview上有按钮时，滑动不起作用。

![带有 Gridview 的 Android 日历](../Images/f98f7541424a69d7296296796fd161f1.png)

任何人都可以调查该问题并为上述两种情况中的任何一种或任何自定义组件或任何帮助建议我一些解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:15:15.077

如果您已将两个孩子添加到单亲，则会出现此问题。将子项添加到另一个布局，然后将此布局添加到实际布局。这将解决您的问题。

# sql - vb.net 在一个查询中将多个 SQL 值设置为同一行

> ID：12774336
> 
> 赞同：0
> 
> 时间：2012-10-08T01:35:09.510
> 
> 标签：sql, vb.net, set, sql-update

我有以下代码将在同一行中设置 2 个值，它真的很简单，但我不知道如何将它组合到一个查询中

```
 Dim cnn As New SqlConnection
            Dim sqlcmd As New SqlCommand("SELECT catalogid, delivered,nodilivary FROM supporder", cnn)
            sqlcmd.CommandText = "update supporder SET delivered=@delivered WHERE catalogid=@catalogid"
            sqlcmd.Parameters.Add(New SqlParameter("@delivered", GridControl2.GetCellValue(currentrowindex, "delivered")))
            sqlcmd.Parameters.Add(New SqlParameter("@catalogid", GridControl2.GetCellValue(currentrowindex, "catalogid")))
            cnn.Open()
            sqlcmd.ExecuteNonQuery()
            sqlcmd.Parameters.Clear()
            cnn.Close()
            sqlcmd.CommandText = "update supporder SET nodilivary=@nodilivary WHERE catalogid=@catalogid"
            sqlcmd.Parameters.Add(New SqlParameter("@nodilivary", GridControl2.GetCellValue(currentrowindex, "nodilivary")))
            sqlcmd.Parameters.Add(New SqlParameter("@catalogid", GridControl2.GetCellValue(currentrowindex, "catalogid")))
            cnn.Open()
            sqlcmd.ExecuteNonQuery()
            sqlcmd.Parameters.Clear()
            cnn.Close() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T01:39:47.253

使用逗号分隔要更新的每个字段。

```
UPDATE supporder SET nodilivary=@nodilivary, delivered=@delivered WHERE catalogid=@catalogid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T01:42:05.173

尝试这个：

```
Dim cnn As New SqlConnection

Dim sql as String = string.Format("update supporder set delivered={0}, nodilivary={1} where catalogid={2}", _
                    GridControl2.GetCellValue(currentrowindex, "delivered")  _
                    GridControl2.GetCellValue(currentrowindex, "nodilivary") _
                    GridControl2.GetCellValue(currentrowindex, "catalogid") )           

Dim sqlcmd As New Sqlsql, cnn)
cnn.Open()
sqlcmd.ExecuteNonQuery()
sqlcmd.Parameters.Clear()
cnn.Close() 
```

我手边没有VB，但这应该非常接近。

编辑：

这是上面使用命令参数的版本，它（感谢评论）再次简单地防御 SQL 注入，并且比上面的代码更安全：

```
Dim cnn As New SqlConnection

Dim sql as String = "update supporder set delivered=@delivered, nodilivary=@nodilivary where catalogid=@catalogid"

Dim sqlcmd As New Sql(sql, cnn)
sqlcmd.Parameters.Add(New SqlParameter("@delivered", GridControl2.GetCellValue(currentrowindex, "delivered"))
sqlcmd.Parameters.Add(New SqlParameter("@nodilivary", GridControl2.GetCellValue(currentrowindex, "nodilivary"))
sqlcmd.Parameters.Add(New SqlParameter("@catalogid", GridControl2.GetCellValue(currentrowindex, "catalogid"))
cnn.Open()
sqlcmd.ExecuteNonQuery()
sqlcmd.Parameters.Clear()
cnn.Close() 
```

# vba - VBA - 跨工作表查找和更改值

> ID：12774351
> 
> 赞同：1
> 
> 时间：2012-10-08T01:37:17.703
> 
> 标签：vba, excel

晚上好！一直在搜索，恐怕我刚刚得到了一些完全倒退的东西（我对 Excel/VBA 不太了解，而且 99% 的人确信我正在以最困难的方式做所有事情）。我想做的是从另一张纸上找到一个值，然后改变它。

```
For i = SORowStart To SORowEnd
'Grabbing this information PID and QTY from my main sheet. 

ProductID = Range("B" & i).Value
ProductQty = Range("A" & i).Value

'I then need to match up PID on another sheet, and modify its Qty
If (Len(ProductID) > 0) Then
    'Finding old quantity, successfully..but how do I change it?? 
    OldQty = Application.WorksheetFunction.VLookup(ProductID, Worksheets("Inventory").Range("List_InventoryTable"), 4, False)
    'MsgBox (ProductID & " - SELLING:" & ProductQty & "/" & OldQty)

    'SO HERES MY PROBLEM LINE! ****************************
    'I've tried with and without the "Set" keyword too. 
    'Set Application.WorksheetFunction.VLookup(ProductID, Worksheets("Inventory").Range("List_InventoryTable"), 4, False).Value = (OldQty - ProductQty)

End If 
```

接下来我

如果有人能指出我正确的方向或告诉我要搜索哪些关键字，那么任何东西都会非常有帮助......我已经为此困扰了几个小时 - *_* - 我试图找到 OldQty 的地址细胞，但没有成功。似乎可以在 Excel 单元格公式中执行（使用 =ADDRESS 和 =MATCH (?)），但我不知道在 VBA 中执行此操作。谢谢阅读 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:03:22.580

它看到 VLOOKUP 函数返回一个值而不是范围引用。我会给你一个使用 MATCH 和 INDEX 函数的例子：

```
Sub test()
    Dim ProductIDs As Range
    Dim OldQty As Range

    Set ProductIDs = Application.WorksheetFunction.Index(Sheets("Inventory").Range("List_InventoryTable"), 0, 1)

    For i = 1 To 2
        'Grabbing this information PID and QTY from my main sheet.

        ProductID = Range("B" & i).Value
        ProductQty = Range("A" & i).Value

        'I then need to match up PID on another sheet, and modify its Qty
        If (Len(ProductID) > 0) Then
            'Finding old quantity, successfully..but how do I change it??
            'MsgBox ProductID
            RowIndex = Application.WorksheetFunction.Match(ProductID, ProductIDs, 0)

            Set OldQty = Application.WorksheetFunction.Index(ProductIDs, RowIndex, 1).Offset(0, 3)
            'OldQty = Application.WorksheetFunction.VLookup(ProductID, Sheets("Inventory").Range("List_InventoryTable"), 4, False)
            MsgBox (ProductID & " - SELLING:" & ProductQty & "/" & OldQty)

            'SO HERES MY PROBLEM LINE! ****************************
            'I've tried with and without the "Set" keyword too.
            'Application.WorksheetFunction.VLookup(ProductID, Worksheets("Inventory").Range("List_InventoryTable"), 4, False) = (OldQty - ProductQty)
            OldQty = (OldQty - ProductQty)

        End If
    Next
End Sub 
```

检查此页面[http://www.techonthenet.com/excel/formulas/vlookup.php](http://www.techonthenet.com/excel/formulas/vlookup.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:42:32.497

我建议你在这样做之前保存，但试试这个：

```
Sub findstuff()

    Dim currQuantityCell As Range, _
        found As Range, _
        invSheetPIDCol As Range, _
        currQuantityRng As Range, _
        invQuantityRng As Range

    'The range containing your quantities
    Set currQuantityRng = Range("A1:A6")

    'Your PID col inside your range "List_InventoryTable"
    Const PIDCol As Long = 1

    'Your old quantity column inside your range "List_InventoryTable"
    Const oldQuantCol As Long = 4

    Set invSheetPIDCol = Sheets("Inventory").Range("List_InventoryTable").Columns(PIDCol)

    For Each currQuantityCell In currQuantityRng
        If currQuantityCell.Offset(0, 1).Value <> "" Then
            Set found = invSheetPIDCol.find(currQuantityCell.Offset(0, 1).Value, lookat:=xlwhole)
            If Not found Is Nothing Then
                Set invQuantityRng = found.Offset(0, oldQuantCol - PIDCol)
                invQuantityRng.Value = invQuantityRng.Value - currQuantityCell.Value
            Else
                MsgBox "Could not find PID for row " & currQuantityCell.Row
            End If
        End If
    Next currQuantityCell

End Sub 
```

如果您不确定其中的任何部分，请询问:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T16:55:48.297

感谢您的回复。这是我的最终结果：

```
Dim SORowStart As Integer       ' Sales Order - Starting row of line items
Dim SORowEnd As Integer         ' Sales Order - Ending row of line items
SORowStart = Range("OrderRowStart").Value
SORowEnd = Range("OrderRowEnd").Value

Dim ItemToSell As String        ' Sales Order - Selected item PID
Dim QtyToSell As Integer        ' Sales Order - Quantity of item to sell

Dim MatchedIDRow As Integer     ' Inventory sheet - Line # the PID is located on'
Dim Range_InventoryIDs As Range ' Inventory sheet - Range of selectable product IDs
Dim InventoryQty As Range       ' Inventory sheet - Range of selected products Qty

Set Range_InventoryIDs = Application.WorksheetFunction.Index(Sheets("Inventory").Range("List_InventoryTable"), 0, 1)

For i = SORowStart To SORowEnd

    ItemToSell = Range("B" & i).Value
    QtyToSell = Range("A" & i).Value

    If (Len(ItemToSell) > 0) Then
        MatchedIDRow = Application.WorksheetFunction.Match(ItemToSell, Range_InventoryIDs, 0)
        Set InventoryQty = Application.WorksheetFunction.Index(Range_InventoryIDs, MatchedIDRow, 1).Offset(0, 3)

        MsgBox ("Selling " & ItemToSell & " - " & QtyToSell & " / " & InventoryQty.Value)
        InventoryQty.Value = InventoryQty.Value - QtyToSell

        MsgBox ("Remaining " & ItemToSell & " = " & InventoryQty.Value)
    End If
Next i 
```

# c# - DotNetZip 提取文件导致“创建文件名时溢出”错误

> ID：12774370
> 
> 赞同：2
> 
> 时间：2012-10-08T01:39:57.887
> 
> 标签：c#, c#-4.0, dotnetzip

使用 DotNetZip 时遇到一个奇怪的问题，在尝试读取 zip 文件时，出现错误

> Ionic.Zip.ZipException：无法将其读取为 ZipFile ---> System.OverflowException：创建文件名时溢出

我正在使用的代码是

```
using (ZipFile zip = ZipFile.Read(file.FullName))
{
    zip.ExtractAll(extractedFolder, ExtractExistingFileAction.OverwriteSilently);
} 
```

我最初认为这是文件名错误，但它不是长文件名/路径，远低于 Windows 规定的 260 个字符限制，并且已提取具有相同长度的其他文件没有问题。

# search - vim 搜索和替换具有重新格式化一些中间字符的效果

> ID：12774375
> 
> 赞同：0
> 
> 时间：2012-10-08T01:40:42.753
> 
> 标签：search, vim, replace, save, character

所以，所以我在一些文件中有这个：

```
ABCxxx.yyyDEF 
```

我想把它改成：

```
HELLOxxx.yyyWORLD 
```

有没有办法做到这一点？/ 如何？

我在玩通配符，例如

```
:%s/ABC.*DEF/HELLO.*WORLD/g 
```

但是，被替换的 HELLO_WORLD 中的 .* 不会保存被替换的 .* 字符。它只是作为你好。*世界

帮助赞赏，

帕春

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:44:44.920

s/ABC\(xxx.yyy\)WORD/JJJ\1MOO/

\(\) 中的任何内容都将被记住并可以在替换字符串中使用。

请参阅： [vim 正则表达式反向引用](https://stackoverflow.com/questions/3339080/vim-regex-backreference)

# .htaccess - 需要重写php？url 到带有文件夹的 url

> ID：12774377
> 
> 赞同：0
> 
> 时间：2012-10-08T01:40:57.610
> 
> 标签：.htaccess, mod-rewrite, rewrite

我正在使用 php 驱动我的网站，并且需要重写对文件夹的特定 php url 调用...该示例在上传之前位于我的本地站点上，因此没有[http://www.etc](http://www.etc)

php 是一个简单的 href 调用`<a href="?id=blog"></a>`，在地址栏中显示为`wip_04/?id=blog`or `wip_04/index.php?id=blog`（取决于您是否从 index.php 开始） - wip_04 是我的离线站点根目录。

我想重写`wip_04/blog`甚至`wip_04/blog/index.php`.

完整的例子是 from `http://website.co.uk/?id=blog`to `http://website.co.uk/blog/`- blog/ 里面还有另一个 index.php

我不是在寻找一般的重写规则，而是针对这个特定实例的规则，我很难过。

非常感谢任何帮助。

//西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:47:46.217

内部重写：

```
RewriteCond %{QUERY_STRING} id=blog
RewriteRule ^/?(index\.php)?$ /blog/ [L] 
```

如果要重定向浏览器以使地址栏中的 URL 发生变化，`R`请在标志中添加 a 以使其看起来像`[L,R=301]`

# python - 否则，elif，如果 Python 中的问题

> ID：12774385
> 
> 赞同：1
> 
> 时间：2012-10-08T01:43:06.950
> 
> 标签：python, if-statement

```
instrument=(raw_input("Which kind of tab would you like to view? Enter 'Guitar' or 'Bass' for a random tab " ))
print
if instrument=='guitar' or 'Guitar':
    print ("0-3-5---0-3-6-5---0-3-5-3-0")
elif instrument=='bass' or 'Bass':
    print ("3-5-12--12-0-5-6-0-0-0-3")
else:
    print 'Sorry, please re-enter a proper answer' 
```

无论您为变量“instrument”输入什么，此代码每次都会打印出“吉他”选项卡（第一个 if 语句）。

我正在尝试自学 python，我只是在学习过程中学习，这是我正在开发并希望扩展的基本程序。

我在网上查看过，但从我读过的关于 if else 语句的内容来看，在我的新手眼中，这段代码应该可以工作。我错过了一些我无法弄清楚的东西

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T01:45:15.030

```
if instrument=='guitar' or 'Guitar': 
```

被解析为

```
if (instrument=='guitar') or ('Guitar'): 
```

非空字符串 like`'Guitar'`被评估为`True`，所以第一个条件总是`True`。

相反，使用

```
if instrument in ('guitar', 'Guitar'): 
```

或者，如果您愿意接受有趣的拼写，例如`'gUiTAR'`，您可以使用

```
if instrument.lower() == 'guitar': 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-08T01:44:46.143

```
instrument == 'guitar' or 'Guitar' 
```

应该

```
instrument == 'guitar' or instrument == 'Guitar' 
```

或更好，

```
instrument in ('guitar', 'Guitar') 
```

甚至

```
instrument.lower() == 'guitar' 
```

低音部分也是如此。

* * *

它总是输出第一个选项的原因是`a == b or c`......

...实际上读作`(a == b) or c`.

运算符没有按照`or`您的想法使用。它是一个逻辑或不是“多个选项”分隔符。

# c - 从 asm volatile 调用内部访问静态 C 变量

> ID：12774390
> 
> 赞同：2
> 
> 时间：2012-10-08T01:43:52.303
> 
> 标签：c, variables, assembly, volatile

当我尝试**直接**从 asm volatile 调用中访问静态变量时，我收到未定义的引用错误。我认为有一种方法可以在不使用输入和输出寄存器的情况下做到这一点，但是我的搜索结果是空的。

```
int main() {
   static unsigned int a = 0;
   __asm__ __volatile__("push a" : : :);
   return 0;
}

error: undefined reference to a 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-01T09:09:52.163

确实是老问题，但是由于没有公认的答案...

首先，让我说使用内联 asm 通常是个[坏主意](https://gcc.gnu.org/wiki/DontUseInlineAsm)。但如果你必须...

由于静态是在函数内部声明的，gcc 需要一些方法来区分`a`main() 中命名的静态变量和 foo() 中的静态变量。它是如何做到的是实现定义的，但是在我机器上的构建中，它使用了名称 a.2499。所以使用：

```
__asm__ __volatile__("push a.2499" : : :); 
```

工作。至少它做了一分钟。当我对周围的代码做了一些小改动时，它把它改成了 a.2500。当然，在执行此语句后不久，应用程序由于堆栈损坏而崩溃。

但是这种方法还有其他问题。其中一些来自 gcc[文档](https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html)中的这个声明：

> GCC 自己不解析汇编指令，也不知道它们的含义，甚至不知道它们是否是有效的汇编输入。

结果，做：

```
a++;
__asm__ __volatile__("push a.2500" : : :);
a++; 
```

不符合您的预期。即使是来自 -O1 的最小优化也将这两个`a++`语句组合成一个`addl $2, a.2500(%rip)`. 这样做是因为编译器看不到`a`asm 中的使用情况，而使用`a`作为输入的东西会提供。

您可以通过声明`a`为 volatile 来解决此问题。您可以（可能）通过使用全局变量来解决命名问题。

但最好的解决方案（如果你真的必须使用内联 asm）只是指定`a`为输入。我认为替代方案没有任何好处。

```
__asm__ __volatile__("push %0" 
  : /* no outputs */
  : "g" (a)  /* input as a register, memory, or immediate operand */
  : /* no clobbers, because there's no way to tell gcc we're unbalancing the stack and clobbering the red-zone */
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T01:46:50.323

尝试：

```
__asm__ __volatile__ ("push " (a) : : :); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-08T02:48:50.377

伙计，`a`从双引号中删除

```
__asm__ __volatile__ ("push " (a) : : :); 
```

# c# - 如何在 C# 中使用叠加效果在图像上写入文本

> ID：12774391
> 
> 赞同：0
> 
> 时间：2012-10-08T01:43:55.533
> 
> 标签：c#, image, text, graphics, overlay

我想在具有叠加混合效果的图像上写文字。不是简单的透明度，而是将图像的像素与文本的颜色混合。

我有这个功能可以在图像上写入文本，但这仅使用简单的透明度。

```
grPhoto.DrawString(strText,        //string of text
    crFont,                            //font
    semiTransBrush,                    //Brush
    new PointF(xCenterOfImg,yPosFromBottom),  //Position
    StrFormat);                               //Text alignment 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T01:55:59.923

这[是 Photoshop](http://www.pegtop.net/delphi/articles/blendmodes/overlay.htm)在使用叠加混合时用来计算像素值的公式。您可能必须在混合过程中自己计算每个像素 - 我不相信 GDI+ 对混合有如此特定的支持。（我可能错了，我已经有一段时间没有使用 GDI+了。）

Paint.NET 在其叠加混合实现中使用了类似的算法——Reflector 或许能给你一些想法。

# javascript - 使用 Ruby on Rails 进行 HTML5 文件拖放上传

> ID：12774394
> 
> 赞同：10
> 
> 时间：2012-10-08T01:44:21.937
> 
> 标签：javascript, ruby-on-rails, ruby, html

在我的 Ruby on Rails 应用程序中，我有一个简单的文件上传按钮，我试图用 HTML5 中的 File/FileReader API 的拖放框替换它，特别是使用[本教程](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)。照原样，我使用 Ruby 脚本将文件上传到我的 public/data 文件夹。我不确定如何将拖放脚本与之集成。我的想法是制作我已经隐藏的文件上传按钮，并在用户尝试提交时使用 Javascript 将其值设置为拖放图像的路径。

但是，当我尝试提交时，出现错误：

> 文件名太长 - public/data/data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QMtaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNj....

因为HTML5给出的临时文件存储名称太长了，我猜。

我尝试将字符串连接到前 60 个字符，然后它给出了错误：

> 没有这样的文件或目录 - public/data/data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAA

在任何情况下，该文件都不会添加到`public/data`文件夹中。

我的 HTML：

```
<%= form_tag( { :action => 'create' }, :multipart => true ) %>
<div id="dropbox"><span id="droplabel">Drop file here...</span></div>
<img id="preview" alt="[ preview will display here ]" />

<%= hidden_field_tag :uploadfile, :id => "uploadfile", :name => "uploadfile" %>
<br /><br />
<div id="submit">
<%= submit_tag( "Upload file" ) %>
</div> 
```

红宝石：

```
def create
    name = params[:uploadfile]
    directory = "public/data"
    path = File.join(directory, name)
    File.open(path, "wb") { |f| f.write(params[:uploadfile].read) }
     @project = Project.new({:filename => name, :location => path})

    respond_to do |format|
      if @project.save
        format.html { redirect_to @project, notice: 'Project was successfully created.' }
        format.json { render json: @project, status: :created, location: @project }
      else
        format.html { render action: "new" }
        format.json { render json: @project.errors, status: :unprocessable_entity }
      end
    end
  end 
```

和JS：

```
$("#submit input").click(function() {
    $("#uploadfile").val($("#preview").attr("src"));
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-02-01T01:10:45.173

问题看起来像您将文件作为 Base64 编码的数据 URL 发送，这很好，但是当您 POST 到服务器时文件名不会随之而来。您可能希望在将文件转换为数据 URL 之前提取文件名，以便您可以将其与参数中的文件一起发送。或者，像 Madao 建议的那样创建一个新的文件名 (UUID)。

这至少应该解决您的文件名问题：

```
def create
    ##
    file = params[:uploadfile]
    name = params[:filename] || SecureRandom.uuid
    ##
    directory = "public/data"
    path = File.join(directory, name)
    File.open(path, "wb") { |f| f.write(file.read) }
    @project = Project.new({:filename => name, :location => path})

    respond_to do |format|
      if @project.save
        format.html { redirect_to @project, notice: 'Project was successfully created.' }
        format.json { render json: @project, status: :created, location: @project }
      else
        format.html { render action: "new" }
        format.json { render json: @project.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-24T10:14:42.927

关键是使用 params[:uploadfile] 作为 name 值是不必要的，如果你想要一个唯一的键，你可以使用`SecureRandom.uuid`.

# android - MapView上视图的android z顺序

> ID：12774398
> 
> 赞同：1
> 
> 时间：2012-10-08T01:44:45.627
> 
> 标签：android, android-layout, z-order

我有一个带有 ItemizedOverlays 的谷歌 MapView。然后我添加一个 imageView（不是 Overlay）并附加到 MapView。如何让 ItemizedOverlays 位于 imageView 之上？我希望 MapView 标记位于顶部。

我知道添加叠加层的顺序决定了叠加层的 z 顺序，但是如何控制新附加视图的 z 顺序以及叠加层？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:06:07.577

MapView 扩展了 ViewGroup，所以我假设 Overlays 是作为 ViewGroup 的子级绘制的。这意味着您应该能够使用 ViewGroup.addView(View child, int index) 插入 ImageView 以使其显示在 Overlays 下方。

不过，更好的方法是自己扩展 MapView，并尝试覆盖 (a) ViewGroup.getChildAt(int index) 或 (b) ViewGroup.getChildDrawingOrder(int childCount, int i)。取决于 MapView 如何实现其绘制顺序（例如，LinearLayout 的 Z 顺序*是*它的子视图顺序）。

对于（a），请参阅此答案：[按字母顺序排序按钮](https://stackoverflow.com/questions/11098778/sort-buttons-alphabetically/11099054#11099054)

对于 (b)，您还需要通过调用 setChildrenDrawingOrderEnabled(boolean enabled) 来启用绘图顺序。

# c# - MVC 4 丢失会话

> ID：12774402
> 
> 赞同：0
> 
> 时间：2012-10-08T01:45:08.013
> 
> 标签：c#, asp.net-mvc, entity-framework, session

我有一个所有控制器都扩展的基本控制器，并且在基本控制器上我做了一些会话处理。比如存储用户id等。

此外，我有一个`User`类，它有其他类，例如：

```
class User
{
   public int Id {set;get;}
   public virtual Location Location {set;get;}
} 
```

当我从数据库中填充它时（我使用代码优先 EF），显然位置不会加载，我应该按照它的方式将它存储在会话中吗？

主要问题是我存储`Id`在基本控制器中并且每次重新启动应用程序时都会丢失会话。为什么会这样？我延长了会话超时并没有帮助。

会话处理的最佳实践是什么？有我可以使用的包装器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:54:52.013

回复：将用户存储在会话中：您可以，只需确保您在不将其重新附加到会话的情况下永远不会访问“位置”属性。如果您不需要数据，一个选项是将您需要的数据复制*到*一个没有“位置”的更简单的对象中，并将其存储在您的会话中。

回复：丢失会话上下文，这是因为默认将会话数据存储在内存中，每当应用程序重新启动时就会丢失。如果您希望该状态在应用程序重新启动时保持不变，请查看使用[StateServer](http://msdn.microsoft.com/en-us/library/ms178586%28v=vs.100%29.aspx)模式进行会话（尽管如果您希望保持服务器重新启动或在多服务器场中工作，您将需要使用 SQLServer 路由）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-19T02:05:35.383

这就是您所需要的 - 将此代码添加到 web.config/system.web：

```
<machineKey validationKey="C5034160419189092507195D247C6FCD9F54D7A967372A23078E09F6440087328A874AD69955F441B526A265CC3A17CDEAAE8AB21A16868F549C3077C39C8E9F" decryptionKey="078FAD13FAC4E41EB0762F0B34E3F4990A144897C3387A70A746187F3AECD8DE" validation="SHA1" decryption="AES" />   

    <sessionState timeout="300" mode="InProc"></sessionState> 
```

这个 machinKey 是从[http://aspnetresources.com/tools/machineKey生成的](http://aspnetresources.com/tools/machineKey)

# html - 如何在页面上居中 Facebook/G+/Twitter“喜欢”按钮？

> ID：12774405
> 
> 赞同：1
> 
> 时间：2012-10-08T01:45:42.707
> 
> 标签：html, css, facebook-like, google-plus-one

我正在使用[此解决方案](https://stackoverflow.com/a/7584434/963396)以内联方式在我的页面上放置“喜欢”按钮。基本上，按钮放置在`li`a 内的元素内`ul`。到目前为止，这行得通。

这些按钮位于我页面的页脚。问题是，当我希望它们居中时，它们与页面左侧对齐。我已经尝试了我能想到的一切，但似乎无法将它们水平居中。

我在[这里](http://jsfiddle.net/Ws7kC/)设置了一个 JSFiddle 。（您会注意到 Bootstrap 是一个依赖项。我的网站使用它，因此您的答案可以在必要时利用它，但不是必须的。）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:15:26.653

几件事；为什么你的 ul 向左浮动？无论您做什么，这都会迫使该元素向左移动。如果你给ul设置了一个宽度，我测试了350px，然后左右边距设置为auto，你应该很好，居中。您还需要向 ul 添加一个“clearfix”div，以便版权保留在底部。请参阅下面的代码：

HTML 示例：

```
<ul>
    <li>.....<li>
    <li>.....</li>
    etc....
    <div class="clearfix"></div>
</ul> 
```

CSS（您的已更正）：

```
ul.like-buttons{
list-style: none;
margin: 5px auto 20px auto;
padding: 0;
width: 350px;
} 
```

CSS 清除修复：

```
.clearfix {
    clear:both;
} 
```

所以，我所做的就是摆脱 ul 上的浮动，为 ul 定义一个宽度，然后将左右自动边距设置为居中，然后使用 clearfix 使 ul 具有受尊重的垂直高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:27:21.533

通过将你的 ul 包装在一个容器 div 中，它可以使用 margin:0 auto; 居中。诡计。

一种方法：

[http://jsfiddle.net/phoffman/zpMAF/1/](http://jsfiddle.net/phoffman/zpMAF/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T02:25:44.730

摆脱浮动并将 LI 的显示属性更改为“内联块”就可以了。

此外，需要对 Facebook iframe 内联样式进行小幅修改以调整高度，以便所有内容都内联。

[http://jsfiddle.net/amustill/Ws7kC/1/](http://jsfiddle.net/amustill/Ws7kC/1/)

# python - 当我尝试访问我的应用程序时，为什么 django 管理区域会抛出错误？

> ID：12774407
> 
> 赞同：0
> 
> 时间：2012-10-08T01:46:02.137
> 
> 标签：python, django

我已经启动了一个博客应用程序。该模型如下所示：

```
from django.db import models

class Post(models.Model):
    title = models.CharField(max_length=512)
    image = models.ImageField(upload_to='/pathto/blogImages')
    body = models.TextField()
    visible = models.BooleanField()
    date_created = models.DateTimeField(auto_now_add=True)
    date_updated = models.DateTimeField(auto_now=True)

    def __unicode__(self):
        return self.title

class Tag(models.Model):
    keyword = models.CharField(max_length=256)
    posts = models.ManyToManyField(Post)

    def __unicode__(self):
        return self.keyword 
```

运行 syncdb 后，我创建了一个 admin.py 文件，如下所示：

```
from blog.models import Post
from blog.models import Tag
from django.contrib import admin

class TagInline(admin.TabularInline):
    model = Tag
    extra = 3

class PostAdmin(admin.ModelAdmin):
    inlines = [TagInline]

admin.site.register(Post, PostAdmin) 
```

当我访问管理区域（http://localhost:8000/admin/blog/post/add/）时，我收到以下错误：

```
Exception at /admin/blog/post/add/
<class 'blog.models.Tag'> has no ForeignKey to <class 'blog.models.Post'>
Request Method: GET
Request URL:    http://localhost:8000/admin/blog/post/add/
Django Version: 1.4.1
Exception Type: Exception
Exception Value:    
<class 'blog.models.Tag'> has no ForeignKey to <class 'blog.models.Post'>
Exception Location: /usr/local/lib/python2.7/dist-packages/django/forms/models.py in _get_foreign_key, line 800
Python Executable:  /usr/bin/python
Python Version: 2.7.3 
```

当我在 django 中查找多对五关系时，我发现[https://docs.djangoproject.com/en/dev/topics/db/examples/many_to_many/](https://docs.djangoproject.com/en/dev/topics/db/examples/many_to_many/)。我一直无法找到我缺少的东西。如何避免错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:05:28.927

当您处理多对多关系时，您`InlineModelAdmin`应该[如下所示](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#working-with-many-to-many-models)：

```
class TagInline(admin.TabularInline):
    model = Tag.posts.through 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T09:01:47.767

您的多对多字段应该在帖子模型而不是标签模型上。对象必须按顺序定义，否则您必须使用 models.ManyToManyField('tag') 除非不可避免，否则不建议这样做。所以先定义标签然后发布，这样你就可以在发布模型下使用（标签）。我建议只使用 django 标记。它一直对我很有帮助。

毕竟，让 django 如此吸引人的是可重用的应用程序和快速的开发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T02:04:13.940

也许您可以尝试将帖子的模型字段设置为

`posts = models.ManyToManyField(Post, null=True, blank=True)`.

我猜可能没有创建帖子，因此它无法创建标签或将标签与帖子“连接”。

# python - 如何防止我的静态资产被我的 Flask 路由处理？

> ID：12774409
> 
> 赞同：2
> 
> 时间：2012-10-08T01:46:28.280
> 
> 标签：python, flask

我正在使用 Flask，python 网络框架。在我的应用程序中，我有一条类似`@route('/<book>/<chapter>/<verse>')`. 我的静态资产（css 和 js）正在通过这条路线处理，因此开发服务器将返回一个模板而不是 css 或 js 文件。

有没有办法保留这条路线但排除与我的静态资产匹配的路线？

看来我在这里遗漏了一些明显的东西，所以我提前道歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T01:50:44.440

使用 Flask 处理静态资产的正确方法是创建一个名为 的目录`static`，将资产放入其中，然后使用`'static'`端点名称。

[http://flask.pocoo.org/docs/quickstart/#static-files](http://flask.pocoo.org/docs/quickstart/#static-files)

* * *

或者，如果您使用单独的网络服务器来托管您的 Flask 应用程序（通过 WSGI 或类似方式），请配置该网络服务器以覆盖静态资产的路径，并且一开始就不要将它们传递给应用程序。

# php - php在上传时调整图像大小会在我不想要它时旋转图像

> ID：12774411
> 
> 赞同：8
> 
> 时间：2012-10-08T01:46:49.453
> 
> 标签：php, image, upload, rotation, image-resizing

我有一个上传脚本，可以调整上传图像的大小，但是，当我不希望某些图像被保存为旋转图像时，有什么方法可以保留原始图像方向？

```
 if (($resizeObj->width > 400) || ($resizeObj->height > 600)){

    // *** 2) Resize image (options: exact, portrait, landscape, auto, crop)
    $resizeObj -> resizeImage(400, 400, 'crop');

    // *** 3) Save image
    $resizeObj -> saveImage($path, 95);

    } 
```

这是我的类文件：

```
 <?php

   # ========================================================================#
   #
   #  Author:    Jarrod Oberto
   #  Version:   1.0
   #  Date:      17-Jan-10
   #  Purpose:   Resizes and saves image
   #  Requires : Requires PHP5, GD library.
   #  Usage Example:
   #                     include("classes/resize_class.php");
   #                     $resizeObj = new resize('images/cars/large/input.jpg');
   #                     $resizeObj -> resizeImage(150, 100, 0);
   #                     $resizeObj -> saveImage('images/cars/large/output.jpg', 100);
   #
   #
   # ========================================================================#

        Class resize
        {
            // *** Class variables
            private $image;
            public $width;
            public $height;
            private $imageResized;

            function __construct($fileName)
            {
                // *** Open up the file
                $this->image = $this->openImage($fileName);

                // *** Get width and height
                $this->width  = imagesx($this->image);
                $this->height = imagesy($this->image);
            }

            ## --------------------------------------------------------

            private function openImage($file)
            {
                // *** Get extension
                $extension = strtolower(strrchr($file, '.'));

                switch($extension)
                {
                    case '.jpg':
                    case '.jpeg':
                        $img = @imagecreatefromjpeg($file);
                        break;
                    case '.gif':
                        $img = @imagecreatefromgif($file);
                        break;
                    case '.png':
                        $img = @imagecreatefrompng($file);
                        break;
                    default:
                        $img = false;
                        break;
                }
                return $img;
            }

            ## --------------------------------------------------------

            public function resizeImage($newWidth, $newHeight, $option="auto")
            {
                // *** Get optimal width and height - based on $option
                $optionArray = $this->getDimensions($newWidth, $newHeight, $option);

                $optimalWidth  = $optionArray['optimalWidth'];
                $optimalHeight = $optionArray['optimalHeight'];

                // *** Resample - create image canvas of x, y size
                $this->imageResized = imagecreatetruecolor($optimalWidth, $optimalHeight);
                imagecopyresampled($this->imageResized, $this->image, 0, 0, 0, 0, $optimalWidth, $optimalHeight, $this->width, $this->height);

                // *** if option is 'crop', then crop too
                if ($option == 'crop') {
                    $this->crop($optimalWidth, $optimalHeight, $newWidth, $newHeight);
                }
            }

            ## --------------------------------------------------------

            private function getDimensions($newWidth, $newHeight, $option)
            {

               switch ($option)
                {
                    case 'exact':
                        $optimalWidth = $newWidth;
                        $optimalHeight= $newHeight;
                        break;
                    case 'portrait':
                        $optimalWidth = $this->getSizeByFixedHeight($newHeight);
                        $optimalHeight= $newHeight;
                        break;
                    case 'landscape':
                        $optimalWidth = $newWidth;
                        $optimalHeight= $this->getSizeByFixedWidth($newWidth);
                        break;
                    case 'auto':
                        $optionArray = $this->getSizeByAuto($newWidth, $newHeight);
                        $optimalWidth = $optionArray['optimalWidth'];
                        $optimalHeight = $optionArray['optimalHeight'];
                        break;
                    case 'crop':
                        $optionArray = $this->getOptimalCrop($newWidth, $newHeight);
                        $optimalWidth = $optionArray['optimalWidth'];
                        $optimalHeight = $optionArray['optimalHeight'];
                        break;
                }
                return array('optimalWidth' => $optimalWidth, 'optimalHeight' => $optimalHeight);
            }

            ## --------------------------------------------------------

            private function getSizeByFixedHeight($newHeight)
            {
                $ratio = $this->width / $this->height;
                $newWidth = $newHeight * $ratio;
                return $newWidth;
            }

            private function getSizeByFixedWidth($newWidth)
            {
                $ratio = $this->height / $this->width;
                $newHeight = $newWidth * $ratio;
                return $newHeight;
            }

            private function getSizeByAuto($newWidth, $newHeight)
            {
                if ($this->height < $this->width)
                // *** Image to be resized is wider (landscape)
                {
                    $optimalWidth = $newWidth;
                    $optimalHeight= $this->getSizeByFixedWidth($newWidth);
                }
                elseif ($this->height > $this->width)
                // *** Image to be resized is taller (portrait)
                {
                    $optimalWidth = $this->getSizeByFixedHeight($newHeight);
                    $optimalHeight= $newHeight;
                }
                else
                // *** Image to be resizerd is a square
                {
                    if ($newHeight < $newWidth) {
                        $optimalWidth = $newWidth;
                        $optimalHeight= $this->getSizeByFixedWidth($newWidth);
                    } else if ($newHeight > $newWidth) {
                        $optimalWidth = $this->getSizeByFixedHeight($newHeight);
                        $optimalHeight= $newHeight;
                    } else {
                        // *** Sqaure being resized to a square
                        $optimalWidth = $newWidth;
                        $optimalHeight= $newHeight;
                    }
                }

                return array('optimalWidth' => $optimalWidth, 'optimalHeight' => $optimalHeight);
            }

            ## --------------------------------------------------------

            private function getOptimalCrop($newWidth, $newHeight)
            {

                $heightRatio = $this->height / $newHeight;
                $widthRatio  = $this->width /  $newWidth;

                if ($heightRatio < $widthRatio) {
                    $optimalRatio = $heightRatio;
                } else {
                    $optimalRatio = $widthRatio;
                }

                $optimalHeight = $this->height / $optimalRatio;
                $optimalWidth  = $this->width  / $optimalRatio;

                return array('optimalWidth' => $optimalWidth, 'optimalHeight' => $optimalHeight);
            }

            ## --------------------------------------------------------

            private function crop($optimalWidth, $optimalHeight, $newWidth, $newHeight)
            {
                // *** Find center - this will be used for the crop
                $cropStartX = ( $optimalWidth / 2) - ( $newWidth /2 );
                $cropStartY = ( $optimalHeight/ 2) - ( $newHeight/2 );

                $crop = $this->imageResized;
                //imagedestroy($this->imageResized);

                // *** Now crop from center to exact requested size
                $this->imageResized = imagecreatetruecolor($newWidth , $newHeight);
                imagecopyresampled($this->imageResized, $crop , 0, 0, $cropStartX, $cropStartY, $newWidth, $newHeight , $newWidth, $newHeight);
            }

            ## --------------------------------------------------------

            public function saveImage($savePath, $imageQuality="100")
            {
                // *** Get extension
                $extension = strrchr($savePath, '.');
                $extension = strtolower($extension);

                switch($extension)
                {
                    case '.jpg':
                    case '.jpeg':
                        if (imagetypes() & IMG_JPG) {
                            imagejpeg($this->imageResized, $savePath, $imageQuality);
                        }
                        break;

                    case '.gif':
                        if (imagetypes() & IMG_GIF) {
                            imagegif($this->imageResized, $savePath);
                        }
                        break;

                    case '.png':
                        // *** Scale quality from 0-100 to 0-9
                        $scaleQuality = round(($imageQuality/100) * 9);

                        // *** Invert quality setting as 0 is best, not 9
                        $invertScaleQuality = 9 - $scaleQuality;

                        if (imagetypes() & IMG_PNG) {
                             imagepng($this->imageResized, $savePath, $invertScaleQuality);
                        }
                        break;

                    // ... etc

                    default:
                        // *** No extension - No save.
                        break;
                }

                imagedestroy($this->imageResized);
            }

            ## --------------------------------------------------------

        }
?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-26T17:41:43.250

这是我的代码，调整图像大小，不要旋转带有 exif 的图像

PHP 必须启用：extension=php_mbstring.dll extension=php_exif.dll if error, 查看更多：[PHP：exif_read_data() not defined](https://stackoverflow.com/questions/8573070/phpexif-read-data-not-defined/16720310#16720310)

```
function CreateThumbnail($pic,$thumb,$thumbwidth, $quality = 100)
{

        $im1=ImageCreateFromJPEG($pic);

        //if(function_exists("exif_read_data")){
                $exif = exif_read_data($pic);
                if(!empty($exif['Orientation'])) {
                switch($exif['Orientation']) {
                case 8:
                    $im1 = imagerotate($im1,90,0);
                    break;
                case 3:
                    $im1 = imagerotate($im1,180,0);
                    break;
                case 6:
                    $im1 = imagerotate($im1,-90,0);
                    break;
                } 
                }
        //}
        $info = @getimagesize($pic);

        $width = $info[0];

        $w2=ImageSx($im1);
        $h2=ImageSy($im1);
        $w1 = ($thumbwidth <= $info[0]) ? $thumbwidth : $info[0]  ;

        $h1=floor($h2*($w1/$w2));
        $im2=imagecreatetruecolor($w1,$h1);

        imagecopyresampled ($im2,$im1,0,0,0,0,$w1,$h1,$w2,$h2); 
        $path=addslashes($thumb);
        ImageJPEG($im2,$path,$quality);
        ImageDestroy($im1);
        ImageDestroy($im2);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-08T01:50:45.513

这个基本脚本可能会忽略 [EXIF数据。](http://www.impulseadventure.com/photo/exif-orientation.html)

使用 调查您的图像是否嵌入了旋转信息[`exif_read_data`](http://www.php.net/manual/en/function.exif-read-data.php)，然后使用[类似这样的函数](http://www.php.net/manual/en/function.exif-read-data.php#76964)自动更正旋转。

在你的情况下，

1.  拿我刚刚链接的脚本，
2.  将其粘贴到代码的第一行上方，
3.  将所有`$image->`位更改为`$resizeObj->`
    (vim-style grep: `%s/image->/resizeObj->/g`)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-09-15T08:08:33.783

当您拍照时，您的手机会将所有旋转元数据保存在 EXIF 标头中。当您将图像上传到服务器时，该元数据仍然存在，但您的工作是将其应用于图像以旋转它（如果您愿意）。在 PHP 中，您可以使用一个名为[exif_read_data](https://www.php.net/manual/en/function.exif-read-data.php)的函数：

```
function correctImageOrientation($filename)
{
    $exif = exif_read_data($filename);
    if ($exif && isset($exif['Orientation'])) {
        $orientation = $exif['Orientation'];
        if ($orientation != 1) {
            $img = imagecreatefromjpeg($filename);
            $deg = 0;
            switch ($orientation) {
                case 3:
                    $deg = 180;
                    break;
                case 6:
                    $deg = 270;
                    break;
                case 8:
                    $deg = 90;
                    break;
            }
            if ($deg) {
                $img = imagerotate($img, $deg, 0);
            }
            imagejpeg($img, $filename, 95);
        }
    }
} 
```

要按原样使用该函数，只需在保存文件后调用它。有关更多信息和其他 PHP 解决方案，请参阅[原始源](https://medium.com/thetiltblog/fixing-rotated-mobile-image-uploads-in-php-803bb96a852c)。

# vsto - 如何在功能区上设置键提示？

> ID：12774412
> 
> 赞同：6
> 
> 时间：2012-10-08T01:46:58.107
> 
> 标签：vsto, add-in, ribbon

我将`keytip`拆分按钮的属性值设置为“ *CKS* ”，但是当我在 Outlook 2010 中执行加载项时，我得到提示，可以使用“ *Y7* ”访问它。我猜这是一些默认的投掷和任意数字。

如何强制**我**选择的字符组合成为功能区上的有效组合？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-11T09:12:16.423

您应该能够通过使用功能区的 customUI XML 中的属性来使用自己的快捷方式`keytip`，但有时 Office 程序决定将其更改为*Y1*、*Y2*等，可能是因为与内置控件的键提示冲突.

我没有 Outlook，但我在 Excel 2010 中尝试了“ *CKS ”键提示，无论是在选项卡上还是在按钮上，它都有效。*下面是用于 Excel 功能区的 XML：

```
<customUI onLoad="RibbonLoad" 
          xmlns="http://schemas.microsoft.com/office/2009/07/customui">
  <ribbon>
    <tabs>
      <tab id="tabTest" 
           label="Test" 
           keytip="CKS" >
        <group id="grpTest" 
               label="Group #1" >
          <button id="btn1" 
                  label="Button #1" 
                  size="large" 
                  keytip="CKS" />
        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI> 
```

# multithreading - 如果 2 个线程执行 EnterCriticalSection 而线程 1 执行 DeleteCriticalSection 会发生什么

> ID：12774425
> 
> 赞同：6
> 
> 时间：2012-10-08T01:49:26.890
> 
> 标签：multithreading, winapi, deadlock, critical-section

我正在寻找我的程序中可能出现的死锁，并且我怀疑以下情况。如果 2 个线程同时调用 EnterCriticalSection 并且线程#1 在进入后立即调用 DeleteCriticalSection 会发生什么情况，那么仍在 EnterCriticalSection 调用中的线程#2 会发生什么情况？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-08T01:55:05.977

> 如果 2 个线程同时调用 EnterCriticalSection 并且线程#1 在进入后立即调用 DeleteCriticalSection 会发生什么情况，那么仍在 EnterCriticalSection 调用中的线程#2 会发生什么情况？

两个线程不能同时进入临界区。这将破坏关键部分的目的。要么 Thread #1 先进入临界区，要么 Thread #2 先进入临界区。这里有两种可能的交错。

假设交错是这样的：

```
    线程 1 线程 2
    -------- --------
       | |
       | |
    输入CS() |
    锁定 |
       | |
       | 输入 CS()
       | 被封锁
       | |
       | |
    删除CS() |
       | |
       | ？？？
       |
      ...

```

在这种情况下，线程#2 的状态[根据 MSDN 是未定义的](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682552.aspx)：

> ***DeleteCriticalSection 函数***
> 
> **评论**
> 
> 删除临界区对象会释放该对象使用的所有系统资源。
> 
> 删除临界区对象后，请勿在除 InitializeCriticalSection 和 InitializeCriticalSectionAndSpinCount 之外的任何对临界区进行操作的函数（如 EnterCriticalSection、TryEnterCriticalSection 和 LeaveCriticalSection）中引用该对象。如果您尝试这样做，可能会发生内存损坏和其他意外错误。
> 
> **如果一个临界区在它仍然拥有的时候被删除，那么等待被删除临界区所有权的线程的状态是未定义的。**

因此，如果您的两个线程不幸遇到上述交错，那么操作系统**无法保证**您的程序将继续按预期工作。例如，这可能包括死锁线程#2。

但如果交错是这样的：

```
    线程 1 线程 2
    -------- --------
       | |
       | |
       | 输入 CS()
       | 锁定
       | |
    输入CS() |
    封锁 |
       | |
       | |
       | 退出CS()
       | 锁已释放
       | |
    畅通|
    锁定 |
       | |
    删除CS() |
       | |
       | |
      ……

```

那么显然，由于线程#1 被阻塞，它不能删除临界区，直到线程#2 离开临界区。然后假设没有其他线程进入临界区，线程#1 将能够毫无问题地删除它。

您提出的方案本质上是一种竞争条件。根据线程的时间，它可能工作得很好或导致不可预知的问题。在这种情况下，您必须重新构建代码，以便在所有感兴趣的线程都释放了临界区之后销毁临界区。

在这种双线程场景中，修复它的一种方法是让 Thread #1 离开临界区并等待所有其他线程首先完成，然后再删除临界区。像这样的东西，例如：

```
// Pseudocode for exposition
void Thread1()
{
    EnterCS();
    // Do stuff
    ExitCS();
    WaitForThread2();
    DeleteCS();
}

void Thread2()
{
    EnterCS();
    // Do stuff
    ExitCS();
} 
```

现在，两种可能的交错看起来像这样：

```
    线程 #2 首先获取锁： . 线程 #1 首先获取锁：
                                    .
    线程 1 线程 2。线程 1 线程 2
    -------- -------- 。-------- --------
       | | . | |
       | 输入 CS() 。输入CS() |
       | 锁定。锁定 |
       | | . | |
    输入CS() | . // 做一些事情 EnterCS()          
    阻塞 // 做事。| 被封锁
       | | . | |
       | | . 退出CS() |
       | 退出CS() 。锁定释放 |
       | 锁已释放。| |
       | | . | 畅通
    畅通| . | 锁定
    锁定 | . | |
       | | . | // 做东西
   // 做事 | . | |
       | | . | 退出Cs()
    退出CS() | . | 锁已释放
    锁定释放 | . | |
       | | . | |
       | | . | |
    WaitForThread2() --+ 。WaitForThread2() --+
       | . |
    删除 CS() 。删除 CS()
       | . |
       | . |
      完毕 。完毕

```

的确切实现`WaitForThread2()`将取决于您的程序的性质，但肯定会涉及[`WaitForSingleObject()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687032.aspx)或其任何一个亲戚。

# asp.net - 我应该在复杂的 Web 应用程序中使用 orchard

> ID：12774426
> 
> 赞同：3
> 
> 时间：2012-10-08T01:49:51.600
> 
> 标签：asp.net, asp.net-mvc, orchardcms

我的客户想要开发 Web 应用程序，其中**将在未来 3 年内添加大量功能**。并且产品应该能够持续至少10年。
我建议以非常**模块化**的方式构建系统。

**必须有一个基础框架和一组核心模块，用于数据库抽象、帐户和其他特定于公司业务逻辑的东西，然后将模块化 MVC-Areas 用于依赖**于核心业务的大块功能模块。
该应用程序也必须支持主题。

我看着这个并想 *“他们希望我建立一个 CMS。”*
太好了，所以当我为所有这些东西构建功能时，我看到**Orchard**并自言自语*：“这有一个对可扩展性需求有迷恋的人的一切！”*

与果园的外观一样，我担心依赖 3rd-party 框架，以及在此过程中遇到的任何**问题**，尤其是在未来几年。

所以我将总结我**的兴趣点：**

1.  在这种特定情况下使用 Orchard（或任何其他 CMS）是否明智？（必须持续约 10 年）？
2.  使用这种架构，我需要依赖于其他“业务核心模块”的模块，果园是否支持这样的事情？
3.  以这种方式使用 Orchard 有哪些可能的问题或限制？
4.  以这种方式使用 Orchard 与完整的设计有什么不同的优点和缺点？从客户和开发人员的角度来看。

# java - 使用 JDialog 和 Tabbed Pane 绘制不同的图片

> ID：12774427
> 
> 赞同：0
> 
> 时间：2012-10-08T01:33:47.407
> 
> 标签：java, swing, graphics, jdialog, diagrams

我正在使用 NetBeans，并且我有一个扩展到 JDialog 的类，在该对话框中我创建了一个选项卡式窗格。选项卡式窗格包含 6 个不同的选项卡，当然有 6 个不同的面板。我想要做的是当我点击不同的选项卡时，应该用paint方法绘制一个图表。

我的问题是如何在从 Dialog 类调用的另一个类中仅使用一个绘制方法来绘制不同的面板？

这是我的 Dialog 类代码：

```
package GUI;    

public class NewJDialog extends javax.swing.JDialog{

    /**
     * Creates new form NewJDialog
     */
    public NewJDialog(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("FCFS", jPanel1);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("SSTF", jPanel2);

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("LOOK", jPanel3);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("LOOK C", jPanel4);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("SCAN", jPanel5);

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 466, Short.MAX_VALUE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 242, Short.MAX_VALUE)
        );

        jTabbedPane1.addTab("SCAN C", jPanel6);

        getContentPane().add(jTabbedPane1, java.awt.BorderLayout.CENTER);

        jLabel1.setText("Distancia:");

        jLabel2.setText("___________");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel2)
                .addContainerGap(331, Short.MAX_VALUE))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jLabel2))
                .addContainerGap(15, Short.MAX_VALUE))
        );

        getContentPane().add(jPanel7, java.awt.BorderLayout.PAGE_START);

        pack();
    }// </editor-fold>                        

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(NewJDialog.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(NewJDialog.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(NewJDialog.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(NewJDialog.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the dialog */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                NewJDialog dialog = new NewJDialog(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify                     
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JTabbedPane jTabbedPane1;
    // End of variables declaration  
} 
```

这是我为paint方法创建的另一个类：

```
import java.awt.Graphics;
import javax.swing.JPanel;

public class Lienzo {

    private int width = 5;
    private int height = 5;
    private int y = 5;
    private int x = 0;
    private int x1 = 0;

    public Graphics Draw(Graphics g, int[] pistas) { 
        //Im not sure if this is the correct way to do it
        //The diagram gets drawn according to values from an array
        //The array is not always the same thats why I used the different Panels

        for (int i = 0; i < pistas.length; i++) {
            x = pistas[i];
            x1 = pistas[i + 1];

            g.drawOval(x, y, width, height);
            g.drawString(Integer.toString(x), x, y);
            g.drawLine(x, y, x1, y);

        }
        return g;
    }
} 
```

我希望你们明白我想用我的程序做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:31:52.157

我会制作一个“GraphPane”，扩展类似`JPanel`. 在本课程中，我将提供一种方法，您可以通过该方法为图形提供数组信息。我会从您的`draw`方法中获取逻辑并添加`paintComponent`到`GraphPane`.

然后我会在每个选项卡中添加一个实例，`GraphPane`用适当的数组数据为每个选项卡播种。

根据数据的来源，您可能还需要在创建时将数组数据传递给对话框

# css - 悬停颜色变化的Jqplot条形图并显示自定义工具提示

> ID：12774428
> 
> 赞同：0
> 
> 时间：2012-10-08T01:50:11.697
> 
> 标签：css, jqplot, bar-chart

我正在尝试使用 jqplot 显示图表，并且我想在用户将鼠标悬停在任何图表元素上时更改颜色。目前，只要用户将鼠标悬停在图表上，它们就会设置默认颜色。

我在这方面有两个困难...

我无法理解如何更改悬停颜色以及如何拥有自定义工具提示。

我需要这样的东西![在此处输入图像描述](../Images/3c7cecf3de8864400782bfb8bc92f117.png)

截至目前，我得到了图表，但不知何故我无法在正确的位置显示工具提示，我也无法将颜色从蓝色更改为绿色。我的工具提示设置不正确。

我尝试将我的图表与 jqplotDataHighlight 绑定并使用鼠标 X 和 Y 位置来定位我的工具提示。但这不起作用。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T04:55:39.497

至于颜色，我发现了这个：“highlightColor”

至于工具提示，我假设您已经阅读了他们的文档，但只是以防万一，这里有一点提示：[http ://www.jqplot.com/docs/files/plugins/jqplot-highlighter-js .html](http://www.jqplot.com/docs/files/plugins/jqplot-highlighter-js.html)

你考虑过谷歌图表吗？我建议的是那个或 flotr2。否则，祝你好运！我希望我能更有用！

# java - Jframe 执行时大小不合适，有什么原因吗？

> ID：12774432
> 
> 赞同：0
> 
> 时间：2012-10-08T01:51:17.370
> 
> 标签：java, swing, netbeans, jframe, layout-manager

我正在制作游戏，但每当我运行第二个 jFrame 时，我必须调整它的大小以便为第二个 jFrame 获得正确的大小，有人知道为什么吗？

这是第一个 jFrame 类中打开第二个的方法：

```
 private void playButtonMouseClicked(java.awt.event.MouseEvent evt) {                                        
        if (playerOneNameText.getText().equals(""))
        {
        }

        if (playerTwoNameText.getText().equals(""))
        {
        }
        else{
        pOneName = playerOneNameText.getText();
        pTwoName = playerTwoNameText.getText();

        ChessBoardUI class1 = new ChessBoardUI(); // Creating object of Class1
        class1.setVisible(true);

        this.setVisible(false);
        }
    } 
```

这是第二个 jFrame 类，我必须调整其大小才能正确定位：

```
package chess;

public class ChessBoardUI extends javax.swing.JFrame {

    public ChessBoardUI() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        blackTeamName = new javax.swing.JLabel();
        whiteTeamName = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(null);
        getContentPane().add(jLabel2);
        jLabel2.setBounds(21, 49, 0, 0);

        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/chess/board.jpg"))); // NOI18N
        getContentPane().add(jLabel3);
        jLabel3.setBounds(0, 30, 400, 400);

        jLabel1.setText("Black:");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(400, 100, 34, 16);

        jLabel4.setText("White:");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(400, 150, 38, 16);

        blackTeamName.setText("jLabel5");
        getContentPane().add(blackTeamName);
        blackTeamName.setBounds(400, 120, 41, 16);

        whiteTeamName.setText("jLabel5");
        getContentPane().add(whiteTeamName);
        whiteTeamName.setBounds(400, 170, 41, 16);

        pack();
    }// </editor-fold>

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ChessBoardUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ChessBoardUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ChessBoardUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ChessBoardUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new ChessBoardUI().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JLabel blackTeamName;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel whiteTeamName;
    // End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T11:07:33.027

我读得很快，寻找一种特定的方法。

那个方法是：

```
pack(); 
```

JFrame中的这个方法非常有用但也很难处理，你需要非常了解如何设置每个组件的正确大小。同样，使用“null”布局可以让所有工作变得微不足道。

我的建议是忘记使用

```
setLayout(null) 
```

因为根据我的经验，它很少能提供比其他布局更好的结果。

我能告诉你的最好的事情是使用 BoxLayout。使用此布局，您可以精确设置每个组件的位置和大小。诀窍还在于您可以使用rigidArea 和Glue。

您的代码可以是：

```
// This is a BoxLayout with top to bottom orientation, the trick is to nest many JPanel
// with BoxLayout in both the direction to have all working
// What I want to achieve is:
//
//     1\. Having a main box top to bottom where I will put:
//           - Top margin (a rigid area with dimension (0,MARGIN)
//           - Main JPanel with BoxLayout and LINE_AXIS (left to right) orientation
//           - Bottom margin (a rigid area like top margin)
//
//     2\. In the main panel I will put:
//           - Left Margin (a rigid area with dimensions (MARGIN,0)
//           - A JPanel (leftPanel) Boxed top to bottom containing the things on the left that actually are jLabel3 and jLabel2
//           - A little separator between the two panel, a rigid area (10,0) i.e.
//           - A JPanel (rightPanel) Boxed top to bottom containing the remaining 4 JLabels
//           - Right Margin (as left)
//
//     3\. In rightPanel JPanel (BoxLayout.PAGE_AXIS, top to bottom) I will have:
//           - a rigid area space to match the position that I want
//           - the first label
//           - a rigid area.. etc so on
//     
//     For each JLabel I must set all:
//           - setPreferredSize(dimension)
//           - setMinimumSize(dimension)
//           - setMaximumSize(dimension)
//
//     Then, if you specify also the JFrame is better, but you can try to pack().
//     BoxLayout take care of sizes, not exceeding maximum and not making it smaller than minimum. Yust try it and you will love it.

getContentPane().setLayout(new BoxLayout(getContentPane(), BoxLayout.PAGE_AXIS);

JPanel main = new JPanel();
main.setLayout(new BoxLayout(main, BoxLayout.LINE_AXIS));

this.add(Box.createRigidArea(new Dimension(0,20))); // VERTICAL SPACE (top margin)
this.add(main);
this.add(Box.createRigidArea(new Dimension(0,20))); // VERTICAL SPACE (bottom margin)

JPanel rightPanel = new JPanel();
rightPanel.setLayout( new BoxLayout(rightPanel, BoxLayout.PAGE_AXIS));
JPanel leftPanel = new JPanel();
leftPanel.setLayout( new BoxLayout(leftPanel, BoxLayout.PAGE_AXIS));

main.add(Box.createRigidArea(new Dimension(20,0))); // HORIZONTAL SPACE (left margin)
main.add(leftPanel);
main.add(Box.createRigidArea(new Dimension(10,0))); // HORIZONTAL SPACE (between the two)
main.add(rightPanel);
main.add(Box.createRigidArea(new Dimension(20,0))); // HORIZONTAL SPACE (right margin)

// now you should have understood how it works, just try to fill the right and left panel with your labels. Remember to set preferredm, maximum and minimum sizes. 
```

我希望这对你有用编辑，我想念一些“）”

# php - array_map 应用于具有 2 个参数的函数

> ID：12774433
> 
> 赞同：1
> 
> 时间：2012-10-08T01:51:39.117
> 
> 标签：php, arrays

我有 2 个数组 (`$numbers`和`$letters`)，我想创建一个新数组，该数组基于将 every`$numbers`与 every结合在一起的函数`$letters`。该函数的参数包含`$numbers`和的值`$letters`。*（注意：$numbers 和 $letters 没有相同数量的值）*。我需要这样的东西：

```
$numbers = array(1,2,3,4,5,6,...);
$letters = array('a','b','c','d','e',...);

function myFunction($x,$y){
     // $output = some code that use $x and $y
     return $output;
};

$array_1 = array( (myFunction($numbers[0],$letters[0])), (myFunction($numbers[0],$letters[1])), myFunction($numbers[0],$letters[2]), myFunction($numbers[0],$letters[3]), etc);

$array_2 = array( (myFunction($numbers[1],$letters[0])), (myFunction($numbers[1],$letters[1])), myFunction($numbers[1],$letters[2]), myFunction($numbers[1],$letters[3]), etc);

$array_3 = array( (myFunction($numbers[2],$letters[0])), (myFunction($numbers[2],$letters[1])), myFunction($numbers[2],$letters[2]), myFunction($numbers[2],$letters[3]), etc);

...

$array_N = array( (myFunction($numbers[N],$letters[0])), (myFunction($numbers[N],$letters[1])), myFunction($numbers[N],$letters[2]), myFunction($numbers[N],$letters[3]), etc);

$array = array($array_1, $array_2, $array_3, etc.); 
```

我知道这可能有效，但它有很多代码，特别是如果我为每个数组有很多值。有没有办法用更少的代码获得相同的结果？我试过这个，但它不工作：

```
$array = array_map("myFunction($value, $letters)",$numbers)); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T03:33:52.257

如果你想使用`array_map`：

```
$numbers = array(1,2,3,4,5,6);
$letters = array('a','b','c','d','e');

$result = array_map(function($n) use ($letters) {
    return array_map(function($l) use ($n) {
         return myFunction($n, $l);
    }, $letters);
}, $numbers); 
```

***[这是演示。](http://codepad.viper-7.com/g972sf)***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T02:12:43.327

可能有很多方法可以解决这个问题，但为了可读性/可维护性，我会简单地使用几个循环：

```
$array = array();

foreach ($numbers as $number) {
    $row = array();

    foreach ($letters as $letter) {
        $row[] = myFunction($number, $letter);
    }

    $array[] = $row;
} 
```

# ruby-on-rails - 如何懒惰地执行初始化程序？

> ID：12774435
> 
> 赞同：2
> 
> 时间：2012-10-08T01:52:48.197
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, gem, lazy-loading

当`Gemfile`Rails 中有很多 gem 时，启动时间就很糟糕了。

但问题是我们并不总是需要加载所有的 gem。

*   （`rake db:migrate`和朋友）真的不需要任何与 ActiveRecord 无关的东西（甚至可能不需要）。
*   `rails c`另一方面，可能需要大部分。
*   `rake assets:precompile`可能根本不需要太多。
*   等等。

不幸的`initializers`是，它们与 gem 的绑定非常紧密（例如 simple_form 配置应该在需要 simple_form 时完成，因此会失败`gem 'simple_form', require: false`）。

所以问题是什么是**延迟执行所有初始化程序**以改善启动时间的最佳方法，但仍然不会破坏任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T04:47:34.817

您可以完全控制 Bundler 在启动时加载的 gem。在您的 application.rb 中，您将找到以下内容：

```
if defined?(Bundler)
  Bundler.require *Rails.groups(:assets => %w(development test))
end 
```

您可以稍微修改它以对 ENV 变量做出反应，以便告诉 bundler 加载您的 gem 的简化子集。

```
if defined?(Bundler)
  if ENV['RAKE_ENV']
    Bundler.require :rake
  else
    Bundler.require *Rails.groups(:assets => %w(development test))
  end
end 
```

现在，您可以通过检查是否设置了环境变量来切换初始化程序。

在您的 Gemfile 中，您必须创建一个名为“rake”的组，与创建“开发”和“测试”组的方式相同。

# linq - 有关 .NET Entity Framework 4 的一般问题

> ID：12774437
> 
> 赞同：0
> 
> 时间：2012-10-08T01:53:00.973
> 
> 标签：linq, linq-to-sql, entity-framework-4, asp.net-mvc-4

我有几个关于 EF 4.0 的问题，希望有人能帮助我。

先介绍一点背景知识：我使用了来自 visualstudiogallery.com 的工具将我的数据库逆向工程为类。就类、对象映射等而言，一切似乎都很好……在我的 dbcontext 类中，它为每个表生成了一个属性，这很好。现在这部分代码保存在一个项目中，并由 MVC 4 应用程序调用。我最终会把它变成一个完整的服务层来处理关注点分离，但现在直接链接就可以了。

无论如何，回到我的 EF 问题：

1.  当访问与表名匹配的 dbcontext 类中的属性时，我对 EF 在这里做了什么感到困惑？它实际上每次都返回所有行吗？如果确实如此，似乎很疯狂

2.  我尝试在 dbcontext 类中创建一个函数而不是属性，我想在其中提供一个参数并只返回与参数匹配的行，但是当我添加一个类并尝试在其中进行“LINQ”调用时，我收到以下错误：

找不到源类型“System.Data.Entity.DbSet ....”的查询模式的实现。找不到“选择”。您是否缺少对“System.Core.dll”的引用或“System.Linq”的 using 指令？

任何想法为什么会发生这种情况？

1.  我认为这更像是一个链接问题，但假设我们有一个用户表 (userid)、一个马表 (horseid) 和一个马与用户相关联的表 (horseid, userid)。

如果我创建了一个函数，假设 2 已解析，称为 GetMyHorses 并且我将 userId 作为参数传递，我如何使用 Linq 提供我通常通过存储过程中的简单连接查询获得的内容并返回与相关联的所有马用户通过参数提供。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T11:05:14.450

您的两个问题都与 LINQ 管道、`IQueryable`接口和延迟执行有关。您需要学习上述这些主题。

但要回答你的问题：

1.  `Horses`不，当您说时，实体框架不会全部加载（例如）

    var ctx = YourHorsesContext();

    ```
     // At this time, it simply builds a query that it will fire later.
        var horses = ctx.Horses;

        foreach(Horse horse in horses) // it fires a SQL query here
            Console.WriteLine(horse);  // if you don't foreach, it will never fire a SQL query 
    ```

2.  输入这个：

    使用 System.Linq；

在你的类文件的顶部。您的代码应该可以工作。

# oracle - ORA-00907: 创建表时缺少右括号错误？

> ID：12774439
> 
> 赞同：8
> 
> 时间：2012-10-08T01:53:17.743
> 
> 标签：oracle, ora-00907

我是 oracle 新手，我使用以下查询创建了两个表，

```
CREATE TABLE employee
(
 emp_name VARCHAR(20) NOT NULL,
 street VARCHAR(50) NOT NULL,
 city VARCHAR(20) NOT NULL,
 PRIMARY KEY(emp_name)
) 
```

和

```
CREATE TABLE company
(
 comp_name VARCHAR(20) NOT NULL,
 city VARCHAR(20) NOT NULL,
 PRIMARY KEY(comp_name)
) 
```

现在我正在尝试使用一些外键创建另一个表，

```
CREATE TABLE works
(
emp_name varchar(20) NOT NULL,
comp_name varchar(20) NOT NULL,
salary  int(10) NOT NULL,
FOREIGN KEY(emp_name) REFERENCES employee(emp_name),
FOREIGN KEY(comp_name) REFERENCES company(comp_name)
) 
```

出现错误：ORA-00907：缺少右括号

我也试过

```
CREATE TABLE works
(
emp_name varchar(20) NOT NULL,
comp_name varchar(20) NOT NULL,
salary  int(10) NOT NULL,
constraint wemployee FOREIGN KEY(emp_name) REFERENCES employee(emp_name),
constraint wcompany FOREIGN KEY(comp_name) REFERENCES company(comp_name)
) 
```

但得到同样的错误。谁能告诉我我在哪里做错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T02:06:54.080

我不是 oracle 专家，但是您可以指定`(10)`in`salary int(10) NOT NULL`吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-14T18:34:14.973

1：您应该有一个名为“test”的表，其中包含 id 和 testdata 两列。（这只是一个愚蠢的快速示例，所以我不会费心在 id 上指定任何约束。）

```
create table test (id number, testdata varchar2(255)); 
```

2：接下来，我们将创建一个序列用于测试表中的 id 编号。

```
create sequence test_seq 
start with 1 
increment by 1 
nomaxvalue; 
```

您可以将“从 1 开始”更改为您想要开始的任何数字（例如，如果表中已经有 213 个条目并且您想开始将其用于您的第 214 个条目，请替换为“以 214 开头”）。“increment by 1”子句是默认的，所以你可以省略它。如果您希望它跳过 id 编号之间的 n-1 个数字，您也可以将其替换为“increment by n”。“nomaxvalue”告诉它永远保持递增，而不是在某个时候重置。i（我确信 Oracle 对它可以得到的大小有一些限制，但我不知道那个限制是什么）。

3：现在我们已准备好创建触发器，该触发器将自动将序列中的下一个数字插入到 id 列中。

```
create trigger test_trigger
before insert on test
for each row beginselect test_seq.nextval into :new.id from dual;
end;
/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-13T09:22:59.557

创建带约束的表有两种不同的方法：

1)

```
 create table department(
   deptno number(5) primary key,
   deptname varchar2(30),
   empno number(5) references emp(empno)); 
```

2)

```
 create table department(
   deptno number(5),
   deptname varchar2(30),
   empno number(5),
   constraint pkey_deptno primary key(deptno),
   constraint fkey_empno foreign key(empno) references Emp(empno)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T02:06:36.593

当创建与表创建语句的其余部分内联的索引时，请尝试删除该`FOREIGN KEY`部分：

```
CREATE TABLE works
(
emp_name varchar(20) NOT NULL,
comp_name varchar(20) NOT NULL,
salary  int(10) NOT NULL,
emp_name REFERENCES employee(emp_name),
comp_name REFERENCES company(comp_name)
) 
```

有关更多详细信息，请参阅此问题：

[ORA-00907: 缺少右括号](https://stackoverflow.com/questions/6819869/ora-00907-missing-right-parenthesis?rq=1)

# java - 编译我的 java 小程序时的两个警告

> ID：12774440
> 
> 赞同：1
> 
> 时间：2012-10-08T01:53:39.897
> 
> 标签：java, applet, appletviewer

```
package homework1;

import java.applet.Applet;
import java.awt.Graphics;

public class Homework1A extends Applet {

    public  void paint( Graphics g ){
        g.drawString("CIS 35A Student Learning Outcomes ",40,60);
    }
} 
```

这是我得到的警告

```
The serializable class Homework1A does not declare a static final serialVersionUID field of type long 
Homework1A.java    /homework1/src/homework1    line 5    Java Problem 
```

还有另一个这样的警告

```
Warning: Can't read AppletViewer properties file: 
```

但是在我运行我的代码几次后它就消失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:01:13.940

您将需要一个串行版本的 UID，例如：`private static final long serialVersionUID = 1L;`在您的班级中。

您可以将其用作参考：[序列号](https://stackoverflow.com/questions/285793/what-is-a-serialversionuid-and-why-should-i-use-it)

# asp.net - 页面预初始化和页面加载仅在具有报告查看器的页面上被调用两次

> ID：12774447
> 
> 赞同：0
> 
> 时间：2012-10-08T01:55:05.813
> 
> 标签：asp.net, reporting-services

正如标题所说，仅对于包含报表查看器的页面， preinit 和 load 被调用两次。

已经尝试使脚本管理器的脚本模式发布。然后这些事件被无数次调用。

第一次是非回发，第二次是回发。帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-10T06:25:35.260

这是由在页面属性上设置 AutoEvenWireup=true 引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-08T08:45:29.337

将 `AsyncRendering`属性设置`reportviewer`为`false`。[此外，您可以在此处](https://msdn.microsoft.com/en-us/library/ms252090.aspx)找到更多信息。

# css - IE8 中的 CSS3 选择器？

> ID：12774448
> 
> 赞同：3
> 
> 时间：2012-10-08T01:55:20.627
> 
> 标签：css, internet-explorer-8, css-selectors, selectivizr

好的，所以我最近发现了这个名为“ [Selectivizr](http://selectivizr.com/) ”的脚本，我真的很兴奋，但是我将它插入到我的项目中，按照它说的进行设置，但它没有工作。

所以，我正在寻找的是任何类型的 JavaScript 库/脚本，它允许我`:checked`在 IE8 中使用 CSS3 选择器（尤其是 ）。

Selectivizr 似乎坏了，一年多没有更新了。其他人有运气吗？

有人知道任何其他允许在 IE8 中使用 CSS3 选择器的脚本吗？

不寻找 CSS3 样式，如边框半径、阴影等。只寻找选择器，如`:before`、`:after`、`:checked`等......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:03:37.650

Dean Edward 的 IE9.js 非常可靠，尽管我听说在使用其他库时也会出现一些不兼容问题。自己从未体验过它们，但很长时间没有在野外经常使用图书馆。即插即用，如果它没有损坏，那么一切就绪。

链接：[http ://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

演示：http: [//ie7-js.googlecode.com/svn/test/index.html](http://ie7-js.googlecode.com/svn/test/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:50:41.810

使用 jQuery 代码，您可以使用这几行来切换所有复选框（或其容器）上的类，无论何时选中或取消选中。然后，您可以在所有浏览器中使用常规 CSS 代码。

```
$("input[type='checkbox']").click(function() {
    $(this).parent().toggleClass("checked", this.checked);
});​ 
```

这里的工作示例：http: [//jsfiddle.net/jfriend00/7jA5r/](http://jsfiddle.net/jfriend00/7jA5r/)。

如果您动态创建复选框，那么您可以使用动态形式`.on()`来确保捕获它们。

我个人更愿意使用这样的几行代码的解决方案，而不是使用试图添加 CSS 样式文件功能的重型库。如果您打算使用它，请确保在采用它之前了解幕后实际发生的事情。

* * *

如果您只想要一个自己的选择器库，Sizzle 选择器库适用于各种浏览器，包括一直到 IE6。它将适应主机浏览器的功能，使用尽可能多的内置功能，并在主机浏览器不支持显式功能时使用它自己的代码。

您可以从[这里](http://sizzlejs.com/)只使用选择器库本身，或者它也是 jQuery 内部的选择器库。

使用起来非常简单。您只需执行以下操作：

```
var items = Sizzle(":checked"); 
```

您将拥有一个与选择器匹配的 DOM 元素数组。

# sql - 基于分层架构中的外键滚动 id

> ID：12774452
> 
> 赞同：2
> 
> 时间：2012-10-08T01:56:50.043
> 
> 标签：sql, postgresql, database-design

例如，考虑这个分层模式。 ![在此处输入图像描述](../Images/8ae831d9b6bd514e35aeb0987299069f.png)

假设所有 id 字段都是自动递增的主键，并且外键由**[parent_table_name]_id**约定命名。

## 问题

一旦数据库中有多个公司，那么公司将在它们之间共享所有主键序列。

例如，如果有两个**公司**行，**customer_group**表可能如下所示

```
| id | company_id |
-------------------
| 1  |     1      |
| 2  |     1      |
| 3  |     2      |
| 4  |     2      |
| 5  |     1      |
------------------- 
```

但它应该看起来像这样

```
| id | company_id |
-------------------
| 1  |     1      |
| 2  |     1      |
| 1  |     2      |
| 2  |     2      |
| 3  |     1      |
------------------- 
```

这种行为也应该展示给**customer**和树中直接或间接引用**company**的任何其他表。

请注意，我很可能会为此创建第二个**id**列（命名为**relative_id**），保持唯一**id**列不变，因为这实际上主要用于显示目的以及用户将如何引用这些数据实体。

* * *

现在，如果这只是一个层次结构，那将是一个相对简单的解决方案。我可以创建一个表（table_name、company_id、current_id）和一个在插入任何表之前触发的触发器过程，将当前 id 递增 1 并将行的**relative_id**设置为该值。当**company_id**就在插入查询中时，这很简单。

但是那些不直接引用**公司**的表格呢？与本示例中的最低层次结构一样，**workorder**仅引用**customer**。
是否有一个干净、可重复使用的解决方案从“customer_id”一直爬到最终检索育儿**company_id**？

在每个 INSERT 上使用 SELECT 递归地提升层次结构对我来说听起来不太有吸引力，性能方面。

我也不喜欢只为这些表中的每一个添加一个外键到公司的想法，每个附加表的架构会变得越来越丑陋。

但这是我能看到的两个解决方案，但我可能没有在正确的地方寻找。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T08:42:39.000

如果您使用生成的密钥，公司不应该关心主键是什么。它们应该是没有意义的；比较平等，仅此而已。我[之前对此抱怨过](https://stackoverflow.com/a/9985219/398670)，所以我很高兴看到你写：

> 请注意，我很可能会为此创建第二个 id 列（命名为 relative_id），保持唯一 id 列不变，因为这实际上主要用于显示目的以及用户将如何引用这些数据实体。

你做对了。

大多数时候，ID 是什么并不重要，所以你可以给他们任何来自序列的东西，而不关心孔/间隙。如果您担心公司间的泄漏（不太可能），您可以使用序列作为伪随机生成器的输入来混淆 ID。请参阅 Daniel Verité 几年前针对我的问题所写的函数[pseudo_encrypt](http://wiki.postgresql.org/wiki/Pseudo_encrypt)。

通常，您需要完全连续的无间隙 ID 用于特定目的，例如发票编号。对于那些你需要使用柜台和 - 是的 - 查找公司 ID 的人。这样的 ID 生成速度很慢，而且并发性很差，所以在索引键上增加`SELECT`一`JOIN`两个键不会有太大的伤害。但是不要使用`SELECT`s 递归地向上架构，只需使用一系列`JOIN`s。例如，对于插入到`workorder`您的密钥生成触发器，`workorder`将类似于（未经测试）：

```
 CREATE OR REPLACE FUNCTION workorder_id_tgfn() RETURNS trigger AS $$
   BEGIN
       IF tg_op = 'INSERT' THEN
           -- Get a new ID, locking the row so no other transaction can add a
           -- workorder until this one commits or rolls back.
           UPDATE workorder_ids
           SET next_workorder_id = next_workorder_id + 1 
           WHERE company_id = (SELECT company_id
                 FROM customer
                 INNER JOIN customer_group ON (customer.customer_group_id = customer_group.id) 
                 INNER JOIN company ON (customer_group.company_id = company.id)
               WHERE customer.id = NEW.customer_id)
           RETURNING next_workorder_id
           INTO NEW.id;
       END IF;
   END;
   $$ LANGUAGE 'plpgsql'; 
```

有关`UPDATE ... RETURNING ... INTO`语法，请参阅[使用单行结果执行查询](http://www.postgresql.org/docs/current/static/plpgsql-statements.html#PLPGSQL-STATEMENTS-SQL-ONEROW)。

即使没有多公司问题，正常序列中也可能存在间隙。观察：

```
CREATE TABLE demo (id serial primary key, blah text);

BEGIN;
INSERT INTO demo(blah) values ('aa');
COMMIT;

BEGIN;
INSERT INTO demo(blah) values ('bb');
ROLLBACK;

BEGIN;
INSERT INTO demo(blah) values ('aa');
COMMIT;

SELECT * FROM demo; 
```

结果：

```
regress=#     SELECT * FROM demo;
 id | blah 
----+------
  1 | aa
  3 | aa 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:18:17.790

*“但它应该看起来像这样”*

```
| id | company_id |
-------------------
| 1  |     1      |
| 2  |     1      |
| 1  |     2      |
| 2  |     2      |
| 3  |     1      |
------------------- 
```

我认为它不应该，我认为你想要多对多的关系。customer_group 表：

```
| id | name |
-------------
| 1  |  n1  |
| 2  |  n2  |
| 3  |  n3  |
------------- 
```

然后是 customer_group_company 表：

```
| group_id | company_id |
-------------------------
|    1     |     1      |
|    2     |     1      |
|    1     |     2      |
|    2     |     2      |
|    3     |     1      |
------------------------- 
```

# jquery - 使用 jQuery 切换按钮的标签

> ID：12774453
> 
> 赞同：0
> 
> 时间：2012-10-08T01:57:02.283
> 
> 标签：jquery

我正在尝试使用 jQuery 在每次单击时切换按钮的标签。

以下是我实现的代码：

```
<html>
<head>
    <script src="jquery-1.8.2.js"></script>
    <script>
        $(document).ready(function(){

            $("#details_button").click(function() {
                var button_text = $("#details_button").attr("text");
                button_text == "Hide" ? $("#details_button").text("Details") : $("#details_button").text("Hide");
            });

        });
    </script>
</head>
<body>
    <button id="details_button" type="button">Details</button>
</body>
</html> 
```

我希望“details_button”中的标签在每次单击时都会发生变化，从“**详细信息**”变为“**隐藏**”，反之亦然。

但它只更改一次，从“**详细信息**”到“**隐藏**”，然后在以后的点击中不会更改。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:01:13.303

试试这个： http: [//jsfiddle.net/rsnSx/](http://jsfiddle.net/rsnSx/) **或** [http://jsfiddle.net/z7mrs/](http://jsfiddle.net/z7mrs/) **或** [http://jsfiddle.net/dNzrq/](http://jsfiddle.net/dNzrq/)

使用的 API：

`.html()`- [http://api.jquery.com/html/](http://api.jquery.com/html/)

`.on`- [http://api.jquery.com/on/](http://api.jquery.com/on/)

希望它适合原因`:)`

**代码**

```
 $(document).on('click','#details_button',function() {

        var button_text = $(this).html();
        button_text == "Hide" ? $(this).text("Details") : $(this).text("Hide");;
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:01:31.213

这应该工作

```
 $("#details_button").html() == "Hide" ? $("#details_button").html("Details") : $("#details_button").html("Hide");; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T02:06:44.543

这对我有用：

```
$(document).ready(function() {
    $("#details_button").click(function(e) {
        var self = $(this); //cache object
        self.text(function () {
            var text = self.text();
            return text === 'Hide' ? 'Details' : 'Hide';
        });
        e.preventDefault();
        return false;
    });
});​​ 
```

工作小提琴：http: [//jsfiddle.net/TDr3Q/](http://jsfiddle.net/TDr3Q/)

这也可以缩短为：

```
$(document).ready(function() {
    $("#details_button").click(function(e) {
        $(this).text(function () {
            return $(this).text() === 'Hide' ? 'Details' : 'Hide';
        });
        e.preventDefault();
        return false;
    });
});​ 
```

工作小提琴：http: [//jsfiddle.net/TDr3Q/1/](http://jsfiddle.net/TDr3Q/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T02:08:15.513

更改`$("#details_button").attr("text");`为`$("#details_button").text();`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-08T02:08:38.347

只需更改以下行：

```
var button_text = $("#details_button").attr("text"); 
```

至：

```
var button_text = $("#details_button").html(); 
```

# matlab - 使用 Matlab 生成奇数随机数

> ID：12774454
> 
> 赞同：3
> 
> 时间：2012-10-08T01:57:28.883
> 
> 标签：matlab

我需要一些关于如何使用 Matlab 生成奇数随机数的帮助。你如何在给定的间隔内生成奇数随机数，比如在 1 到 100 之间？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-08T02:07:40.970

好吧，如果我可以在一个区间内生成偶数随机数，那么我只需加 1。:)

这并不像听起来那么愚蠢。

你能生成随机整数吗？如果可以，为什么不乘以 2？然后你会有 EVEN 随机整数。请参阅上文了解下一步该做什么。

MATLAB 中有一些工具可以在一个区间内生成随机整数。如果没有，那么您可以轻松编写自己的代码。例如，这是做什么的：

```
r = 1 + 2*floor(rand(N,1)*50); 
```

或这个：

```
r = 1 + 2*randi([0 49], N,1); 
```

请注意，Rody 编辑了这个答案，但在使用 randi 时犯了一个错误。我已经纠正了这个问题。请注意，当我更改它时，randi 故意在其采样中仅上升到 49。这是有效的，因为 2*49 + 1 = 99。

那么在兰特的情况下呢？为什么我在那里乘以 50，而不是 49？这取自 rand 的文档：

“r = rand(n) 返回一个 n×n 矩阵，其中包含从开区间 (0,1) 上的标准均匀分布中提取的伪随机值。”

所以 rand 永远不会生成一个精确的 1。它可以生成一个略小于 1 的数字，但永远不会生成 1。所以当我乘以 50 时，这会导致一个数字永远不会恰好是 50，而只是可能略小于 50。地板然后以基本相等的概率生成 0 到 49 之间的所有整数。我想有人会指出，因为 0 永远不是 rand 的可能结果，所以整数 0 将被这个表达式欠采样，数量为 eps 的数量级。如果您将生成这么多样本，您可以看到这种欠采样程度，那么您将需要一台更大、更快的计算机来完成您的工作。:)

# javascript - javascript可以检测是否打开了新窗口或浏览器？

> ID：12774455
> 
> 赞同：1
> 
> 时间：2012-10-08T01:57:38.737
> 
> 标签：javascript

好的！所以，我现在有一个看起来“太复杂的问题”。我必须在 10 秒后打开用户提供的 URL。一旦打开该窗口，我必须检查在接下来的 10 秒内是否打开了任何其他窗口或浏览器。如果没有，我只是关闭当前窗口并发出警报。如果打开了一个窗口或浏览器，我必须提醒用户通知它。

现在已经为此工作了4-5个小时。但是，还没有找到东西。

有人有什么主意吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:05:13.287

您可以做的最好的事情是使用页面可见性 api 来查看您的窗口是否已被另一个窗口隐藏，或者可能使用 onblur 处理程序来查看用户是否已从您的窗口切换到另一个窗口。请参阅此处：[有没有办法检测浏览器窗口当前是否处于活动状态？](https://stackoverflow.com/questions/1060008/is-there-a-way-to-detect-if-a-browser-window-is-not-currently-active).

# wpf - 在主窗口中处理 Kinect 并将此引用传递给 UserControls

> ID：12774456
> 
> 赞同：1
> 
> 时间：2012-10-08T01:57:39.430
> 
> 标签：wpf, user-controls, kinect

我在 WPF 中有一个包含很多 UserControls 的项目，一些用户控件使用 Kinect KinectColorViewer.xaml 我想在主窗口中处理传感器发现和设置（连接、断开等）并将其提供给我的 UserControls，如何最好怎么做？

[这](https://www.sugarsync.com/pf/D7317021_68786065_117250)是解释我的问题的项目。

如果您愿意，[这里](https://github.com/Ewerton/KinectWithUserControls.git)是 github 链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T14:59:20.160

从您的示例代码中，

假设您希望尽可能多地维护 Microsoft 提供的代码，您将需要在初始化应用程序时设置对 KinectSensorManager 的引用。我的构造函数通常看起来像这样：

```
private readonly KinectSensorChooser sensorChooser = new KinectSensorChooser();

public KinectSensorManager KinectSensorManager { get; private set; }

public MainViewModel()
{
    // initialize the Kinect sensor manager
    KinectSensorManager = new KinectSensorManager();
    KinectSensorManager.KinectSensorChanged += this.KinectSensorChanged;

    // locate an available sensor
    sensorChooser.Start();

    // bind chooser's sensor value to the local sensor manager
    var kinectSensorBinding = new Binding("Kinect") { Source = this.sensorChooser };
    BindingOperations.SetBinding(this.KinectSensorManager, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);
} 
```

KinectSensorManager 只是一个辅助类。您可以重写代码以轻松避免使用它，但它不会做任何坏事（为您做了很多好事）所以我一直在使用它。此外，由于我假设您希望尽可能多地重用代码，因此我们希望保持其使用。

对于您的控制，您可以扩展 KinectControl，它将为您设置一堆有用的项目。所以...

```
public partial class KinectUserControl : KinectControl
{
  ...
} 
```

这将使您的控件可以访问许多侦听各种事件的可覆盖函数（如 KinectSensorChanged）。检查我们的 KinectColorViewer 代码，您可以看到它是如何覆盖此功能的，如果您更换 Kinect，它可以自动开始显示新数据。

在 XAML 中声明您的控件时，您现在可以添加对 KinectSensorManager 的引用：

```
<my:KinectUserControl KinectSensorManager="{Binding KinectSensorManager}" /> 
```

因为您的控件现在具有 KinectSensorManager 属性，所以它也应该传递给您的 KinectColorViewer 控件。

# c++ - 打开时流不好？

> ID：12774459
> 
> 赞同：0
> 
> 时间：2012-10-08T01:58:03.157
> 
> 标签：c++, file, stream, standard-library

当我以二进制模式打开文件时，是否存在`is_open()`is `true`but `good()`is的情况`false`？

```
bool ok = false;
std::ifstream stream("test.dat", std::ios::binary)
if (stream.is_open())
{
    ok = stream.good();//Does a situation exist where the result of this is false ?
    stream.close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:12:31.560

否：`std::ifstream`如果文件打开失败，则需要两个参数的构造函数来设置失败位。

> §27.9.1.7[ifstream.cons]/2
> 
> `explicit basic_ifstream(const char* s, ios_base::openmode mode = ios_base::in);`
> 
> 来电`rdbuf()->open(s, mode | ios_base::in)`。如果该函数返回一个空指针，则调用`setstate(failbit)`.

并且，对于 open()，

> §27.9.1.4[filebuf.members]/2
> 
> `basic_filebuf<charT,traits>* open(const char* s, ios_base::openmode mode);`
> 
> 返回：`this`如果成功，则返回空指针

# c# - 如何将我的类转换为动态类型 通过使用泛型

> ID：12774461
> 
> 赞同：4
> 
> 时间：2012-10-08T01:58:26.137
> 
> 标签：c#, generics

我有一个功能如下。

```
private IList<ContactList> getEmptyRow()
{
    var _ContactList = new List<ContactList>();
    _ContactList.Add(new ContactList()
    {
        Email = string.Empty,
        Name = string.Empty
    });

    return _ContactList;
} 
```

我想把我的班级`ContactList`改成

```
private IList<T> getEmptyRow() {  ..... T.Add(new T().... 
```

这可能吗 ？如何 ？
每一个建议都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T02:02:48.310

大概是这样的？

```
public interface IPerson
{ 
    string Email {get;set;}
    string Name {get;set;}
}

public class SomeClass
{
    private IList<T> getEmptyRow<T>() where T : IPerson, new()
    {
        var t = new List<T>();
        t.Add(new T()
        {
            Email = string.Empty,
            Name = string.Empty
        });

        return t;
    }
} 
```

您需要一个接口或基类，以便您可以设置公共属性`Email`，`Name`并且您需要`new()`约束，以便您可以使用默认构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-08T02:31:04.650

有点晚了，因为您已经接受了答案，但作为替代方案，特别是如果`new()`不是一个选项，您可以使用预定义的构造函数/初始化语法设置提供程序，这应该会给您一些灵活性：

```
public static class EmptyRowProvider
{
    private static Dictionary<Type, object> TypeCreators = new Dictionary<Type, object>();

    public static void RegisterType<T>(Func<T> emptyTypeCreator)
    {
        TypeCreators.Add(typeof(T), emptyTypeCreator);
    }

    public static IList<T> GetEmptyRow<T>()
    {
        object typeCreatorUntyped;
        if (!TypeCreators.TryGetValue(typeof(T), out typeCreatorUntyped))
            throw new Exception("Type " + typeof(T).FullName + " not registered!");

        Func<T> typeCreator = (Func<T>)typeCreatorUntyped;

        IList<T> emptyRow = new List<T>();
        emptyRow.Add(typeCreator());
        return emptyRow;
    }
} 
```

在应用程序初始化期间的某个地方，您将注册类型及其工厂方法。稍后，您只需按将运行该方法的类型进行调用：

```
EmptyRowProvider.RegisterType(() => new ContactList() { Email = String.Empty, Name = String.Empty });

var emptyRow = EmptyRowProvider.GetEmptyRow<ContactList>();

Console.WriteLine(emptyRow.Count); //1
Console.WriteLine(emptyRow[0].Email == String.Empty); //true
Console.WriteLine(emptyRow[0].Name == String.Empty); //true 
```

假设您有一个没有无参数构造函数的类型，或者您后来决定更改它的初始化方式。稍后说您`ContactList`使用了不同的构造函数：

```
public ContactList(string email, string name, bool isPrivate)
{
    //initialize data here  
} 
```

然后您的新代码用法可能如下所示：

```
EmptyRowProvider.RegisterType(() => new ContactList(String.Empty, String.Empty, true));

var emptyRow = EmptyRowProvider.GetEmptyRow<ContactList>();

Console.WriteLine(emptyRow.Count); //1
Console.WriteLine(emptyRow[0].Email == String.Empty); //true
Console.WriteLine(emptyRow[0].Name == String.Empty); //true
Console.WriteLine(emptyRow[0].IsPrivate == true); //true 
```

或者说您将`ContactList`创建推送到特定的工厂方法：

```
EmptyRowProvider.RegisterType(() => ContactListFactory.Create(String.Empty, String.Empty)); 
```

最后，您可以使用不同的初始化注册多个不同的类型，但实现相同的用法：

```
EmptyRowProvider.RegisterType(() => new ContactList(String.Empty, String.Empty, true));
EmptyRowProvider.RegisterType(() => new Person("John", "Doe"));
EmptyRowProvider.RegisterType(() => UserProvider.SetupAnonymousUser("myusername", "mypassword", LoginType.Anonymous));

ContactList emptyContactList = EmptyRowProvider.GetEmptyRow<ContactList>();
Person emptyPerson = EmptyRowProvider.GetEmptyRow<Person>();
User emptyUser = EmptyRowProvider.GetEmptyRow<User>(); 
```

# java - Java 核心 MVC 框架

> ID：12774462
> 
> 赞同：-3
> 
> 时间：2012-10-08T01:58:30.350
> 
> 标签：java, model-view-controller

我想知道是否存在 Java SE MVC 框架之类的东西。我一直对 Hibernate 和 Spring 感到困惑，这两个框架用于 Java EE Web 应用程序，我喜欢在 Java SE (Core) 中编程，想知道是否存在 MVC 框架，或者是否有人可以提供教程链接如何在 Java SE 中构建一个。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-10-08T02:18:55.777

Hibernate 是一个将对象映射到关系数据库中的表的 ORM 框架。从[休眠文档](http://docs.jboss.org/hibernate/orm/4.1/quickstart/en-US/html_single/)：

> Hibernate 是用于 Java 环境的对象/关系映射解决方案。术语对象/关系映射是指将对象模型表示与关系数据模型表示之间的数据映射的技术。请参阅[http://en.wikipedia.org/wiki/Object-relational_mapping](http://en.wikipedia.org/wiki/Object-relational_mapping)以获得良好的高级讨论。
> 
> Hibernate 负责从 Java 类到数据库表以及从 Java 数据类型到 SQL 数据类型的映射。此外，它还提供数据查询和检索功能。它可以显着减少在 SQL 和 JDBC 中用于手动数据处理的开发时间。Hibernate 的设计目标是通过消除使用 SQL 和 JDBC 进行手动、手工数据处理的需要，将开发人员从 95% 的常见数据持久性相关编程任务中解脱出来。但是，与许多其他持久性解决方案不同，Hibernate 并没有向您隐藏 SQL 的强大功能，并保证您对关系技术和知识的投资一如既往地有效。

Spring MVC 是一个基于请求的框架，遵循 MVC 架构。[您可以在Spring MVC 文档](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html)中阅读有关它的更多信息。我还建议查看[Spring in Action，第 3 版](https://rads.stackoverflow.com/amzn/click/com/1935182358)一书以了解 Spring Framework 和 Spring MVC。

# ruby - 检查方法是否在 *this* 类中定义

> ID：12774466
> 
> 赞同：1
> 
> 时间：2012-10-08T01:59:28.920
> 
> 标签：ruby

我有以下一段代码。它实际上是三个独立的脚本，除了我将它们组合在一起。`Main`类是两个`Test`类继承的东西。他们可能会定义一种`out`方法，该方法可以满足开发人员的要求。这是一种插件式的设计，这样人们就可以`out`在自己的类中定义自己的方法，然后当我的主程序选择其中一个自定义类时，我可以说

`some_test.run`

如果他们决定实现一个`out`将被执行的方法。

有没有更好的方法来实现该`run`方法，以便我不需要显式编写`self.class.method_defined?`？该对象可以是任何`Test`对象，我不希望他们必须覆盖该`run`方法以将自己的类名放在`method_defined?`调用前面。

```
class Main
  def run
    send(:out) if self.class.method_defined?(:out)
  end
end

class TestA < Main

  def out
    p "Test A here"
  end
end

class TestB < Main

  def out
    p "Test B here"
  end
end

a = TestA.new
a.run
# will execute a's out method

b = TestB.new
b.run
# will execute b's out method 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-08T02:46:00.923

我只会`out`在父类中提供一个空方法并允许子类覆盖它，只是普通的 OO：

```
class Main
  def run
    out
  end

  def out
    #out will now always be defined
  end
end 
```

您也可以只使用`defined?`：

```
class Main
  def run
    out if defined? out
  end
end 
```

注意`defined`is的参数`out`，而不是符号`:out`。

或者，更惯用地说，您可以使用`respond_to?`：

```
class Main
  def run
    out if respond_to? :out
  end
end 
```

# .net - 什么决定了 Visual Studio 2012 是否需要“迁移”Visual Studio 2010 项目？

> ID：12774471
> 
> 赞同：4
> 
> 时间：2012-10-08T02:01:03.950
> 
> 标签：.net, visual-studio, migration, visual-studio-2012, projects-and-solutions

我有一个主要使用 MonoDevelop 开发的开源项目。我在 Visual Studio 2010 中对其进行了测试，那里一切正常。然后，我在 Visual Studio 2012 中对其进行了测试，它对我的​​项目和解决方案进行了“静默”迁移。

与 Visual Studio 2010 不同，它没有显示任何关于需要迁移的警告。相反，它只是进行了迁移并吐出了一份迁移报告。它还将我的项目重置为使用 .Net 2.0，之前它被设置为使用 4.0 ..（易于更改，但仍然如此）。在此迁移之后，它可以在 Visual Studio 2010 中正常工作，并且不会尝试迁移。

但是，我的问题是什么决定了它甚至需要进行迁移？在我的工作中，我们有一个 Visual Studio 2010 项目，它可以在 Visual Studio 2012 中完美运行，无需任何迁移（该项目文件之后甚至没有标记为已修改）。这里有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:12:47.970

至少 VS2012 将使用如下行更新您的解决方案文件：

```
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 2012 
```

至于您的解决方案/项目的其余部分，“迁移”的内容取决于许多因素 - 如果您有 VS2010 的 SP1，那么您将在两个版本的 VS 之间拥有更好的互操作性。最大的亮点是数据库项目（.dbproj 文件变为 .sqlproj），常规类库应该在任一版本中都可以正常打开。

这是一篇相当全面的 MSDN 博客文章讨论它：[Visual Studio 2012 新功能：兼容性（又名项目往返）](http://blogs.msdn.com/b/zainnab/archive/2012/06/05/visual-studio-2012-compatibility-aka-project-round-tripping.aspx)

# mysql - 是什么导致我的脚本选择部分出错？

> ID：12774481
> 
> 赞同：1
> 
> 时间：2012-10-08T02:02:32.050
> 
> 标签：mysql, sql, forms, select, syntax

我收到以下错误：错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'country FROM countries WHERE idcountry=4 VALUES ('','Almelo')' 附近使用正确的语法

提前感谢您帮助我解决这个问题，因为我现在尝试修复它 3 天。

我通过 $POST 从我的表单中获取 2 个数据。这是表格：

```
form action="inc/add/addcity.php" method="post">
Select country: 
$query="SELECT idcountry,country FROM countries ORDER BY country ASC";
$result = mysql_query ($query);
echo "<select name='countrybox' id='countrybox' value=''>Country</option>";
while($nt=mysql_fetch_array($result)){
echo "<option value=$nt[idcountry]>$nt[country]</option>";}
echo "</select>";<br>

City to add: <input type="text" name="addcity" id="addcity"/>
<input type="submit" name="sumit" value"sumit"/>
</form> 
```

选项值来自我的数据库现在操作 php 文件

```
include 'addmysql.php';
$data = $_POST;
$citypost = $data['addcity'];
$cityselected = $data['countrybox'];
$cityselected1 = "SELECT country FROM countries WHERE idcountry=$cityselected";
$citytable = "cities";
$citytable .= "$cityselected1";
$sql= "INSERT INTO $citytable VALUES ('','$citypost')";

if (!mysql_query($sql))
  {
  die('Error: ' . mysql_error());
  } 
echo "<script type='text/javascript'>window.location='../../add.php'; </script>" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:13:27.467

我认为这一行：

```
$citytable .= "$cityselected1"; 
```

正在引起悲伤。 `$citytable`最终将 SELECT 查询夹在 INSERT 中。这就是您看到的特定错误的原因。

但是，我不确定我是否完全理解您希望此代码执行的操作。

# asp.net - ASP.NET C# - 根据第一个下拉列表的选择刷新第二个下拉列表

> ID：12774483
> 
> 赞同：0
> 
> 时间：2012-10-08T02:02:33.797
> 
> 标签：asp.net

我是 ASP.NET 的新手

我有详细信息视图的代码 Page1.aspx：

```
 <InsertItemTemplate>
                    <asp:DropDownList id="VendorName" datasourceid="VendorSqlDataSource"
                        datatextfield="VendorName" DataValueField="VendorID"  
                        SelectedValue='<%# Bind("VendorID") %>' runat="server" AutoPostBack="true" />
                </InsertItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList id="VendorName" datasourceid="VendorSqlDataSource"
                    datatextfield="VendorName"  DataValueField="VendorID"  
                    SelectedValue='<%# Bind("VendorID") %>'   runat="server"  OnSelectedIndexChanged="dllVendor_OnSelectedIndexChanged"  AutoPostBack="true" />
                </EditItemTemplate>
            </asp:TemplateField>

        <asp:TemplateField HeaderText="Vendor BU">
                <ItemTemplate>
                    <asp:Label ID="VendorBUName" runat="Server" style="text-align:left; width:100%" Text='<%# Eval("VendorBUName")%>' Width="70%"/>
                </ItemTemplate>
                <InsertItemTemplate>
                    <asp:DropDownList id="VendorBUName" datasourceid="VendorBUSqlDataSource"
                        datatextfield="VendorBUName" DataValueField="VendorBUID"  
                        SelectedValue='<%# Bind("VendorBUID") %>' runat="server"/>
                </InsertItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList id="VendorBUName" datasourceid="VendorBUSqlDataSource"
                    datatextfield="VendorBUName"    DataValueField="VendorBUID"  
                    SelectedValue='<%# Bind("VendorBUID") %>'   runat="server"/>
                </EditItemTemplate>
            </asp:TemplateField> 
```

我正在尝试使 Page1.aspx.cs 后面的代码刷新此代码后面的第二个下拉列表：

```
(VendorBUName"), but keeps getting a error "".
    protected void OnSelectedIndexChanged(object VendorID)
    {
        string queryString = "SELECT VendorBUID, VendorBUName From MDF_VendorBU WHERE VendorID = @VendorID";
        System.Data.SqlClient.SqlConnection connection = new System.Data.SqlClient.SqlConnection("ConnectionString");
        System.Data.SqlClient.SqlCommand command = new System.Data.SqlClient.SqlCommand(queryString, connection);
        command.Parameters.AddWithValue("@VendorID", VendorID);
        connection.Open();

        DataTable dt = new DataTable();
        SqlDataAdapter ad = new SqlDataAdapter(command);
        ad.Fill(dt);

        /*
        VendorBUName.Items.Clear();
        if (dt.Rows.Count > 0)
        {

            VendorBUName.DataSource = dt;
            VendorBUName.DataTextField = "VendorBUName";
            VendorBUName.DataValueField = "VendorBUID";
            VendorBUName.DataBind();
        }
        */

        connection.Close(); 

    }

    //protected void dllVendor_OnSelectedIndexChanged(object sender, System.EventArgs e)
    //{ 
        //OnSelectedIndexChanged(VendorName.SelectedValue.ToString());
    //} 
```

我不断收到“当前上下文中不存在名称'VendorBUName'”，看起来后面的代码无法识别 Page1.aspx 中的第二个下拉列表

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:49:10.843

我会尝试在这里使用 FindControl 调用，因为您有一个标签和一个组合框，它们都具有相同的名称。所以在 OnSelectedIndexChanged 做类似的事情

```
 var control = (DropDownList) yourDetailsView.FindControl("VendorBUName");
if(control!=null)
{
   //do your stuff on the drop down
}

```

# python - 全局变量和局部变量的问题

> ID：12774484
> 
> 赞同：0
> 
> 时间：2012-10-08T02:02:40.567
> 
> 标签：python, python-2.7

我知道这是一个被广泛讨论的话题，我知道那里有很多关于它的话题（我都读过），但我仍然不明白。

未定义的变量（本地和全局）是我在 Python 中最大的问题，我不知道在尝试修复它们时我在做什么。我将通过并添加一个 x = 0 或一个 var = func(var) 在某些地方和某些时候它可以工作，有时它不会。这令人难以置信的沮丧，我真的需要一些帮助。我问过我的老师，但她通常需要一段时间才能回复我，我想解决这个问题。

这是我正在做的事情：http: [//pastebin.com/KTuh7D2p](http://pastebin.com/KTuh7D2p)（这是给学校的。）

有人可以向我解释变量的事情吗？

我不断收到这样的错误：

```
Traceback (most recent call last):
  File "Project1-v2.py", line 144, in <module>
    main()
  File "Project1-v2.py", line 12, in main
    itemsSave = tagYell(items, itemsSale, itemsSave)
UnboundLocalError: local variable 'itemsSave' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:08:58.370

在这种特殊情况下，我猜这是因为你试图用它`itemSave`来定义自己。这相当于说这样的话：

```
x = 5 + x 
```

您第一次定义`x`.

`itemSave`在您尝试使用它的价值之前，您需要提供一些关于什么是的上下文。

例如，这个程序：

```
myNum = 5
x = float(myNum+x)
print x 
```

会给我一个错误信息：

```
x = float(myNum+x)
NameError: name 'x' is not defined 
```

但是，这可以正常工作，并打印“15”：

```
myNum = 5
x = 10
x = float(myNum+x)
print x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T02:12:37.740

所以这是你要问的一段代码

```
def main():
    print "Welcome to the shop!"
    menu()
    itemsSale = 0
    items = getItems()
    itemsSave = tagYell(items, itemsSale, itemsSave)
    itemsSale = calcTax(itemsSale)
    taxTags(items)
    printInfo(items, itemsSale, itemsSave)
    enterItem = input("To enter another item number, press 1\. To end, press 0: ")
    print #Line break 
```

此行导致错误

```
itemsSave = tagYell(items, itemsSale, itemsSave) 
```

您正在尝试传递`itemsSave`给该`tagYell()`函数，但它还没有值。

Python 知道这一点，因为您`itemsSave`在同一范围内分配，即。`itemsSave = ...`它必须是一个未绑定的局部变量，因此它甚至不会查看全局变量来查看它是否在那里定义。

# ruby-on-rails - 设计自定义登录表单

> ID：12774488
> 
> 赞同：9
> 
> 时间：2012-10-08T02:03:25.077
> 
> 标签：ruby-on-rails, ruby, forms, devise

有没有办法将设计验证器指向我的自定义登录表单？标准的、无样式的表单无法使用（字段丢失、提交时抛出异常、实际上使我的运行时崩溃了一次。）而且看起来不太好看。我有一个 100% 可用的表单，它实际上可以让人们登录，但如果出现错误，标准表单会显示，也缺少错误消息。类似于“当被要求提供登录表单时，呈现 /views/sys/login.html.erb，并在出错时返回该视图并输入错误消息”注意：我已经尝试过以下问题，来自不同的问题

```
devise_for :users, :path => '', :path_names => {:sign_in => "system/login", :sign_out => "logout", :sign_up => "register" } 
```

这只是覆盖了我的表格

（我`/system/`的来自 HTTP 的文件是从`/sys/`视图目录中获取的，所以`http://localhost:3000/system/login`会渲染`/views/sys/login.html.erb`）

编辑：从未开发过使用 Web 表单登录或身份验证的 Rails 应用程序（仅标准 HTTP 身份验证）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-08T02:07:04.780

您可以使用以下命令（从您的 rails 项目根目录）将设计视图移动到您的视图目录：

```
rails g devise:views 
```

这将`devise`在您的`app/views/`. 在那里，您将获得所有视图，并且可以根据需要对其进行自定义。要自定义登录表单，您需要修改`sessions/new.html.*`文件。* 可能是`.erb`or`.haml`或其他东西

# iphone - 将 UISearchBar 锁定在 TableView 之上

> ID：12774489
> 
> 赞同：1
> 
> 时间：2012-10-08T02:03:31.313
> 
> 标签：iphone, ios, tableview, searchbar

当y边界达到0（或超过-值）时，我想锁定表格视图顶部的搜索栏

我试图在滚动视图委托方法中，但没有真正改变。事实上，搜索栏的框架发生了变化，但仍保持默认。

有任何想法吗？

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
   UISearchBar *searchBar = self.searchDisplayController.searchBar;
   CGRect rect = searchBar.frame;
   rect.origin.y = MAX(0, scrollView.contentOffset.y);

   self.searchDisplayController.searchBar.frame = CGRectMake(0,MAX(0,scrollView.contentOffset.y),320,44);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:37:58.583

在您的 viewdidload 方法中，您需要偏移表视图：

```
self.tableView.contentOffset = CGPointMake(0.0, 44.0); 
```

然后在 IB 中将搜索栏拖到 UINavigation 控制器中的 UITableview 上方或按语法添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T15:00:46.560

`setNeedsLayout`如果您在 iOS 6.0+ 上运行，则需要致电。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
   UISearchBar *searchBar = self.searchDisplayController.searchBar;
   CGRect rect = searchBar.frame;
   rect.origin.y = MAX(0, scrollView.contentOffset.y);
   [scrollView setNeedsLayout];                  // <-- Call setNeedsLayout here.
   self.searchDisplayController.searchBar.frame = CGRectMake(0,MAX(0,scrollView.contentOffset.y),320,44);
} 
```

# ios - 是否可以在 ios 中播放 h264-mpegts 格式？

> ID：12774490
> 
> 赞同：0
> 
> 时间：2012-10-08T02:03:35.493
> 
> 标签：ios, ffmpeg, h.264, mpeg2-ts

服务器将视频转码到h264/aac，同时将视频数据发送给客户端。为了同时播放和保存视频数据，我使用mpegts作为容器格式，但问题是ios MediaPlayer无法播放mpegts文件。

谷歌说我可以使用 ffmpeg 的 ios-build 来完成任务，但这似乎有点过头了。有没有其他方法可以仅使用 iOS SDK 在 iphone 中播放 mpegts？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T12:54:00.107

我对 ios 了解不多，但是是的，您可以在您的 ios 设备中播放 mp4(h264) 视频。我将我的 h264 视频 url 运行到 ios safari 网络浏览器，它检测到视频并且 quicktime 播放器开始播放该视频。因此您可以通过在您的 ios Safari 网络浏览器中输入视频网址（即：- [http://yourserver.com/yourvideo.mp4 ）来检查这一点。](http://yourserver.com/yourvideo.mp4)

注意：- 您的 mp4 视频应该是编解码器“h264”。使用 FFMPEG 转换 h264 编解码器中的视频

# c++ - 为什么当我输入名称时我的可执行文件不会运行？(Mac OS X 山狮) Mac OS X 10.8.2

> ID：12774492
> 
> 赞同：1
> 
> 时间：2012-10-08T02:03:46.000
> 
> 标签：c++, gcc, compiler-construction, g++, osx-mountain-lion

我正在尝试从 XQuartz (X11) 终端运行我的程序，当我编译我的可执行文件时没有星号并且它不会运行。它说当我输入名称时找不到该命令。我曾一度使用 Xcode，并且已经下载了命令行工具。我对 C++ 和一般编程非常陌生。为什么会这样，我该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:08:01.217

如果您已将其编译为二进制文件，请在二进制文件所在的文件夹中使用`./binary-name`. 通常，它应该运行。但是，如果它说二进制文件不可执行（非常不可能），请将可执行权限设置为`chmod +x binary-name`.

通常，如果可执行文件不在 中`PATH`，则必须在它前面加上`./`才能运行它。

# ruby-on-rails - 使用 Active Merchant 和 PayPal 时出现 SSL 错误

> ID：12774498
> 
> 赞同：4
> 
> 时间：2012-10-08T02:04:31.533
> 
> 标签：ruby-on-rails, ruby, ssl, paypal, activemerchant

我正在尝试使用 Active Merchant 和 PayPal 在暂存服务器上处理付款。我的所有设置如下。

1.  设置 PayPal 商家帐户
2.  将凭据放入 Active Merchant / PayPal 配置中
3.  下载 PayPal PEM 并将其放在我的服务器上
4.  从 PositiveSSL 购买并上传 SSL 证书

但是，当我运行代码（如下）时，我收到此错误：

```
OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read finished A: sslv3 alert handshake failure 
```

这是我正在使用的代码

```
ActiveMerchant::Billing::PaypalGateway.pem_file = File.read("#{Rails.root}/config/cert_key_pem.pem")

@credit_card ||= ActiveMerchant::Billing::CreditCard.new(:brand => "Visa", :number => "4242424242424242", :verification_value => "123", :month => "11", :year => "2016", :first_name => "John", :last_name => "Doe")

gateway = ActiveMerchant::Billing::PaypalGateway.new(:login => "sales_api1.example.com", :password => "password")

response = gateway.authorize(150, @credit_card, :ip=>"123.123.123.1") 
```

任何人都遇到过这个问题或知道 SSL 失败的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T19:37:31.207

好吧，我最终放弃了，我没有使用证书验证方法，而是使用了 PayPal 签名。

所以我删除了 PEM 文件，现在正在使用

```
gateway = ActiveMerchant::Billing::PaypalGateway.new(:login => "sales_api1.example.com", :password => "password", :signature => "fake_signature") 
```

而且效果很好。所以...是的，如果其他人在使用 Active Merchant 和 PayPal 时遇到问题，请尝试将您的身份验证方法从证书换成签名。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-08T04:47:44.690

试试这个， [http://railsapps.github.com/openssl-certificate-verify-failed.html](http://railsapps.github.com/openssl-certificate-verify-failed.html)

# java - GetSerializableExtra 返回 null

> ID：12774499
> 
> 赞同：8
> 
> 时间：2012-10-08T02:04:40.410
> 
> 标签：java, android, serialization, android-activity

我需要一点帮助来解决以下问题。

我有两个活动，A 和 B。活动 A 为结果启动 B，B 向 A 发送回一个可序列化的对象。

活动A开始活动B：

```
 ...
    Intent intent = new Intent(MainActivity.this, ExpenseActivity.class);       
    startActivityForResult(intent, EXPENSE_RESULT);  
    ... 
```

活动 B 向 A 发送数据：

```
 ...
    ExpensePacket packet = new ExpensePacket();
    ...
    Intent returnIntent = new Intent();
    returnIntent.putExtra(MainActivity.PACKET_INTENT,packet);
    setResult(RESULT_OK,returnIntent);     
    finish(); 
```

活动 A 获取从 B 发送的数据的点：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == EXPENSE_RESULT) {
        if(resultCode == RESULT_OK){                
            ExpensePacket result = (ExpensePacket)getIntent().getSerializableExtra(PACKET_INTENT);

            wallet.Add(result);
            PopulateList();
        }
        else{
             //Write your code otherwise
        }
    }
} 
```

我的 Serializable 对象，从 B 发送到 A 的对象：

```
class ExpensePacket implements Serializable {

    private static final long serialVersionUID = 1L;    
    private Calendar calendar;  

    public void SetCalendar(Calendar aCalendar){
        calendar = aCalendar;
    }

    public Calendar GetCalendar(){
        return calendar;
    }

    public String GetMonthYear() {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy");
        sdf.format(calendar.getTime());                 

        String returnString = "";
        returnString += sdf.toString();
        returnString += "/";
        returnString += Functions.GetMonthName(calendar);

        return sdf.toString();
    }   
} 
```

有人可以帮我弄清楚为什么从 B 发送到 A 的数据是空指针。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-08T09:56:41.537

我想我发现了你的错误：

在您的 onActivityResult() 方法中，您应该使用 Intent“数据”参数，而不是 getIntent() 方法。getIntent() 返回的是用来调用 Activity 的 Intent，而不是 startActivityForResult() 调用的 Activity 返回的 Intent。

结果 Intent 是 onActivityResult() 中传递的“数据”参数。您应该从那里恢复您的 Serializable 对象。

我用你的代码做了一个小项目，可以重现你的问题。使用 data 参数更改 getIntent() 解决了这个问题。

还有一件事：我认为您在 ExpensePacket.getMonthYear() 中还有另一个错误，因为您构造了 String returnString，但返回了其他内容。只需检查该部分，以确保您正在做您想做的事。

# sql - 具有复杂 WHERE 条件的高效 SELECT - 我是否需要存储具有计算值的列？

> ID：12774501
> 
> 赞同：3
> 
> 时间：2012-10-08T02:05:11.037
> 
> 标签：sql, django, database-design, normalization, django-orm

假设我有一个大表来存储整数范围。我可以用两个字段做到这一点：

```
start|end
  10 |210     (represents 10 to 210)
  5  |55      (represents 5 to 55) 
```

（快速按`end`列选择），或：

```
start|length
  10 | 200     (represents 10 to 210)
  5  | 50      (represents 5 to 55) 
```

（快速按`length`列选择）。

如果有时我需要选择 by `end`，有时需要选择 by `length`，并且两个查询都需要快速，该怎么办？我可以同时存储：

```
start|length|end
  10 | 200  |210
  5  | 50   |55 
```

但是这并没有标准化，每个人都必须记住更新这两个字段，这只是糟糕的设计。

我知道我可以选择 by `start + length`or`end - start`但是对于一个非常大的表，这不是非常慢吗？

**如何在不存储冗余数据的情况下通过计算值快速查询 - 或者我应该只存储额外的列？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:11:01.433

根据您使用的数据库类型，您可能希望使用触发器来计算派生字段。这样，他们永远不会失去同步。

这意味着每次开始或结束更改时都可以重新计算字段（长度）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T11:32:52.567

不幸的是，您的目标数据库都不支持计算列。我会做以下事情：

1.  首先，确定你是否真的有性能问题。确实，它的`WHERE end - start = ?`执行速度会比 慢`WHERE length = ?`，但是您没有定义应用程序中的“真正大的表”是什么，也没有定义所需的性能是什么。无需优化可能不存在的问题。
2.  确定您是否可以支持搜索中的任何延迟。如果是这样，您可以将计算的列添加到表中，但专门指定一个单独的任务，每五分钟、每小时或其他运行一次，以填充值。
3.  在 PostgreSQL 中，您可以考虑物化视图，~~我相信它在引擎级别得到支持~~。（见下文 Catcall 的评论）。
4.  最后，如果所有其他方法都失败，请考虑使用触发器来维护计算列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T02:11:26.960

我会存储长度，但我会确保计算是在我的插入和更新存储过程中完成的，这样只要每个人都使用你的存储过程，他们就不会产生更多的开销。

# iphone - 如何添加最简单的应用内购买？

> ID：12774515
> 
> 赞同：1
> 
> 时间：2012-10-08T02:07:21.580
> 
> 标签：iphone, ipad, app-store, in-app-purchase

AppStore上有很多关于应用内购买的问题和答案。但是如何添加最简单的应用内购买呢？

代码应尽可能短。没有比真正需要的命令更多的了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T09:21:40.400

您可以简单地关注[http://troybrant.net/blog/2010/01/in-app-purchases-a-full-walkthrough/](http://troybrant.net/blog/2010/01/in-app-purchases-a-full-walkthrough/)，这是一个好的开始。

# php - 找不到类 sfDoctrineRouteCollection

> ID：12774536
> 
> 赞同：0
> 
> 时间：2012-10-08T02:10:08.617
> 
> 标签：php, symfony1, doctrine, symfony-1.4, sfdoctrineguard

我正在使用 SF 1.4.18 和 sfDoctrine & sfDoctrineGuard 插件开始一个新项目。我在 config/ProjectConfiguration.class.php 都处于活动状态，如下所示：

```
public function setup() {
    $this->enablePlugins(
            array(
                'sfDoctrinePlugin',
                'sfDoctrineGuardPlugin'
            )
    );
} 
```

到目前为止一切都很好，但是当我尝试访问 URL [http://inventario.devserver/backend_dev.php/sfGuardUser 时出现](http://inventario.devserver/backend_dev.php/sfGuardUser)此错误：

> 致命错误：在第 59 行的 /var/www/html/inventario /plugins/sfDoctrineGuardPlugin/lib/routing/sfGuardRouting.class.php 中找不到类“sfDoctrineRouteCollection”

我不知道是什么导致了错误，因为我遵循插件文档中的每一步。有什么帮助或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T13:10:15.980

Symfony 1.4[附带 sfDoctrinePlugin](http://trac.symfony-project.org/browser/branches/1.4/lib/plugins)。您不应该自己添加插件。

`sfDoctrinePlugin`从您的文件夹中删除该文件`/plugins`夹，清除您的缓存，它将解决您的问题。

[这个人](http://oldforum.symfony-project.org/index.php/m/81639/)在 2009 年的 Symfony 官方论坛上遇到了同样的问题。

# wpf - WPF PRISM：不调用 IRegionMemberLifetime KeepAlive

> ID：12774539
> 
> 赞同：2
> 
> 时间：2012-10-08T02:10:31.177
> 
> 标签：wpf, silverlight, mvvm, prism

我需要根据特定条件切换正在显示的视图。我已经在**ViewModel的构造函数中实现了切换逻辑**

我`IRegionMemberLifetime`在**View**上实现并设置`KeepAlive`为，`false`以便始终获得 View 和 ViewModel 的新实例。

但是由于某种原因，当我单击**Navigation Button**时，我的断点`KeepAlive`永远不会到达，我得到的是**MainView**而不是**WelcomeView**。

这是供您参考的代码：

**导航按钮：**

```
<Controls:SignedButton VerticalAlignment="Top" Width="275" Height="45"
    Foreground="#FFFFFF" 
    LeftSign="&lt;" Text="Back to Accounts" 
    TextSize="20" ButtonBackground="#666666" 
    HoverBackground="#0FBDAC" HoverOpacity="1" Margin="0,25,0,0"
    Command="{x:Static Infrastructure:ApplicationCommands.NavigateCommand}"
    CommandParameter="{x:Type Views:MainView}"/> 
```

**查看型号：**

```
[RegionMemberLifetime(KeepAlive = false)]
public class MainViewModel : ViewModel, IMainViewModel
{
    private readonly IUnityContainer _container;
    private readonly IRegionManager _regionManager;

    public MainViewModel(IUnityContainer container, IRegionManager regionManager)
    {
        _container = container;
        _regionManager = regionManager;

        Accounts = new List<Account>();

        if (Accounts.Any()) return;

        IRegion region = _regionManager.Regions[Regions.Main];

        var views = region.Views;
        foreach (var view in views)
        {
            region.Remove(view);
        }

        region.Add(_container.Resolve<IWelcomeView>());
    }

    public IList<Account> Accounts { get; private set; }
} 
```

**查看模型库：**

```
public abstract class ViewModel : IViewModel
{
    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

**看法：**

```
[RegionMemberLifetime(KeepAlive = false)]
public partial class MainView : UserControl, IMainView
{
    public MainView(IMainViewModel mainViewModel)
    {
        InitializeComponent();

        ViewModel = mainViewModel;
    }

    public IViewModel ViewModel
    {
        get { return (IViewModel) DataContext; }
        set { DataContext = value; }
    }
} 
```

**外壳视图模型：**

```
public class ShellViewModel : ViewModel, IShellViewModel
{
    private readonly IRegionManager _regionManager;

    public ShellViewModel(IRegionManager regionManager)
    {
        _regionManager = regionManager;

        NavigateCommand = new DelegateCommand<object>(Navigate);
        ApplicationCommands.NavigateCommand.RegisterCommand(NavigateCommand);
    }

    private void Navigate(object navigatePath)
    {
        if (navigatePath != null)
        {
            _regionManager.RequestNavigate(Regions.Main, navigatePath.ToString());
        }
    }

    public DelegateCommand<object> NavigateCommand { get; private set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T18:19:43.577

查看 Prism 库中的 RegionMemberLifetimeBehavior 类对您很有用（对我来说，它位于 C:\Prism4\PrismLibrary\Desktop\Prism\Regions\Behaviors）

IRegionMemberLifetime 接口和 RegionMemberLifetimeAttribute 完成相同的事情，并且可以在您的 View 或 ViewModel 上定义（前提是 viewmodel 设置为 DataContext）。

这是相关的代码：

```
private void OnActiveViewsChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        // We only pay attention to items removed from the ActiveViews list.
        // Thus, we expect that any ICollectionView implementation would
        // always raise a remove and we don't handle any resets
        // unless we wanted to start tracking views that used to be active.
        if (e.Action != NotifyCollectionChangedAction.Remove) return;

        var inactiveViews = e.OldItems;
        foreach (var inactiveView in inactiveViews)
        {
            if (!ShouldKeepAlive(inactiveView))
            {
                this.Region.Remove(inactiveView);
            }
        }
    }

    private static bool ShouldKeepAlive(object inactiveView)
    {
        IRegionMemberLifetime lifetime = GetItemOrContextLifetime(inactiveView);
        if (lifetime != null)
        {
            return lifetime.KeepAlive;
        }

        RegionMemberLifetimeAttribute lifetimeAttribute = GetItemOrContextLifetimeAttribute(inactiveView);
        if (lifetimeAttribute != null)
        {
            return lifetimeAttribute.KeepAlive;
        }

        return true;
    } 
```

我什至可以单步执行此代码以查看它如何与我的应用程序交互。要回答您的问题，如果您的 KeepAlive 属性没有被击中，那么它不会从 ActiveViews 中删除。还要确保如果您通过 IoC 从容器解析视图，则您尚未将其注册为单例类型（每次解析时都会获得一个新实例）。属性/接口只会将其完全从区域中删除，不能保证您获得一个新实例。

# ajax - 在 joomla 的视图中禁用布局

> ID：12774540
> 
> 赞同：1
> 
> 时间：2012-10-08T02:10:40.750
> 
> 标签：ajax, joomla

可以禁用 Joomla 中视图的布局（模板）。

我正在使用 Ajax 加载表格，我只想加载没有模板的表格。

我发现了该功能`setLayout`，但我不知道是否存在禁用模板（布局）的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T06:21:38.813

如果您使用 Ajax 加载结果，您可以通过在回显所需的输出后添加以下代码来停止加载模板。

前任：

```
echo YOUR TABLE OUTPUT HERE
jexit(); 
```

现在它不会再渲染你的模板了。

# java - 将参数传递给 DLL 的主 Java

> ID：12774542
> 
> 赞同：0
> 
> 时间：2012-10-08T02:11:25.640
> 
> 标签：java, java-native-interface

如何通过 JNI 将参数传递给 Main？

目前我加载我的DLL，如：

```
class SharedLibrary {

    native void GetBuffer(ByteBuffer Buffer);;

    SharedLibrary(String[] exec_args) {
        String path = new File(exec_args[0]).getAbsolutePath();
        System.load(path);  //Load My DLL. I want to Pass this DLL some arguments.

        ByteBuffer Foo = ByteBuffer.allocateDirect(.....);
        GetBuffer(Foo);
    }
} 
```

如何传递 DLL 参数？我需要传递多个参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:30:14.360

将库加载到 Java 中的目的是实现使用`native`属性声明的 Java 方法，例如`native void methodname(_arguments go here_);`. 您可以在一个类中声明一个或多个本机方法，但所有这些方法都应在您的 DLL 中定义（使用 JNI 标准）。在 Java 中，您可以像调用任何其他方法一样调用它们（通过使用为该方法定义的任何参数）。

如果您希望 DLL 的初始化入口点接收数据元素，则需要使它们成为某个类的静态成员（或方法），并且 DLL 需要知道访问该类以获取它们。但是，这将是非常不正常的，并且可能不是执行您想要执行的任何操作的最佳方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T11:53:26.893

好吧，如果你需要“*多个参数*”，任何现有的“ *dll main* ”都不适合你。您很可能指的是[WinAPI`DllMain`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682583%28v=vs.85%29.aspx)，并且您可能认为此函数对于任何 DLL 都是必需的，就像每个 C 可执行文件都应具有`main()`函数一样。它不是。JNI 特别具有不带任何参数的功能，但是 DllMain根据您的要求[`JNI_OnLoad`](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/invocation.html)没有任何用户可定义的“*多个参数”。*如果需要自己的参数，为什么不能创建初始化方法呢？甚至`DllMain`医生也建议这样做。`DllMain`它所能做的非常有限。将 JNI 初始化方法设为静态，以便在实例化之前调用它`SharedLibrary`Java 中的对象。它有什么问题？说说你非常需要的“*多个参数*”。

# c++ - C++复制构造基类指针

> ID：12774551
> 
> 赞同：0
> 
> 时间：2012-10-08T02:12:26.647
> 
> 标签：c++, c++11, copy-constructor, abstract-base-class

环顾四周，找不到任何关于我的问题的建议。我正在尝试为具有包含指向抽象基类的指针的私有变量的类创建复制构造函数。

```
#include "BaseClass.hh"

ClassA::ClassA()
{ }
/* Copy construct a ClassA object */
ClassA::ClassA(const ClassA& obj)
{
    std::map<std::string, BaseClass*>::const_iterator it;
    //ClassA copy = obj;

    for(it = obj.ind.begin(); it != obj.ind.end(); it++)
    {
        copy.ind[it->first]=(it->second);
    }
}

//in .hh file
private:
std::map<std::string, BaseClass*> ind; 
```

我什至接近吗？如果没有，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:33:09.660

这里有几个问题。

1.  `++it;`在 for 循环中重复。
2.  `ClassA copy = obj;`一旦你从拷贝构造函数返回，变量拷贝就会被销毁。所以，你在这里没有做任何复制。
3.  如果您希望将值作为指针放入映射中，则需要为指针变量分配内存。
4.  由于您`value`在映射中具有 BaseClass 指针，因此您需要知道要为其分配内存的确切类型。可以在这里提供`key`帮助。

我在这里冒昧地使用 C++11 标签。这仅用于说明目的。接受这个想法并根据您的需要实施它。如果你观察，我没有释放这里的记忆。留给你。

```
class BaseA
{
public:
    virtual void Print() = 0;
};

class Derived1A : public BaseA
{
    virtual void Print() 
    {
        std::cout << "Derived1A\n";
    }
};

class Derived2A : public BaseA
{
    virtual void Print() 
    {
        std::cout << "Derived2A\n";
    }
};

std::map<std::string, std::function<BaseA*()>> factory;

class ClassA
{

public:
    ClassA()
    {
        for (auto it = factory.begin(); it != factory.end(); ++it)
        {
            typedef std::pair<const std::string, BaseA*> Pair;
            mapType_m.insert(Pair(it->first, it->second()));
        }
    }

    ClassA(const ClassA& other)
    {
        for (auto it = other.mapType_m.begin(); it != other.mapType_m.end(); ++it)
        {           
            typedef std::pair<const std::string, BaseA*> Pair;
            mapType_m.insert(Pair(it->first, factory[it->first]()));
        }
    }

    void Print()
    {
        for (auto it = mapType_m.begin(); it != mapType_m.end(); ++it)
        {
            std::cout << "key:" << it->first << "\tValue:";
            it->second->Print() ;
            std::cout << "\n";
        }
    }

private:
    std::map<std::string, BaseA*> mapType_m;

};

int main()
{
    factory["Derived1A"] = []() { return new Derived1A(); };
    factory["Derived2A"] = []() { return new Derived2A(); };

    ClassA c1;
    ClassA c2 = c1;
    c2.Print();
} 
```

# .net - Mono/ MVC3 只显示主页，其他都是 404

> ID：12774561
> 
> 赞同：0
> 
> 时间：2012-10-08T02:15:04.223
> 
> 标签：.net, asp.net-mvc-3, ubuntu, mono

在这里挠头。我正在运行带有最新单声道的 Ubuntu 12.04.1 LTS。我的 Windows 开发箱工作正常，但在 linux 箱上，唯一出现的页面是默认主页......少了 CSS 和脚本。查看调试工具，看起来其他所有东西都得到了 404。

IIS6 的 SO 也有类似的情况，这表明这可能是单声道尝试使用错误的框架版本的问题，但我不知道在哪里有不同的说法，我不相信这是问题所在。

有没有人对此有见识？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:26:29.807

好的，我发现了问题：我的 apache 配置设置不正确。我在一个启用的站点文件中有一个冲突的主机名，看起来 apache 很困惑。清理垃圾并重新启动 apache2 解决了这个问题。

# ios - 活动指示器 iOS

> ID：12774564
> 
> 赞同：1
> 
> 时间：2012-10-08T02:15:18.320
> 
> 标签：ios, xcode

使用顶部栏中的活动指示器更好还是使用窗口中的活动指示器更好？当我说得更好时，我的意思是，从苹果的角度来看。我不确定在任何给定情况下何时使用网络活动指示器或标准活动指示器。一个比另一个更可靠吗？我听说如果你有一个可以访问互联网的应用程序并且你没有运行指示器，那么苹果可能会拒绝你的应用程序。这就是我问这个的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:18:43.273

在执行网络任务时，您应该始终激活网络活动指示器。是否显示附加指标由您自行决定。例如，Safari 会激活网络活动指示器并拥有自己的加载栏。

**编辑：** 来自 Apple 的文档：

> 当您的应用访问网络超过几秒钟时，显示网络活动指示器以提供反馈。如果操作比这更早完成，您不必显示网络活动指示器，因为该指示器可能会在用户注意到它的存在之前消失。

如果你觉得任务在你的应用程序的最前沿，并且用户想知道它的进度或它正在运行的事实，你应该向他们展示你自己的某种附加指标。

# javascript - 有没有办法同时获得一个对象的许多属性？

> ID：12774566
> 
> 赞同：1
> 
> 时间：2012-10-08T02:15:26.983
> 
> 标签：javascript, jquery

我有以下内容：

```
 link = {
        action: $link.attr('data-action') || '',
        dialogType: $link.attr('data-dialogType') || '',
        params: $link.attr('data-params') || '',
        title: $link.attr('title') || '',
        viewURL: $link.attr('data-href') || '',
        entity: $link.attr('data-entity') || '',
        row: $link.attr('data-row')
    }; 
```

我只是想知道。有没有更干净的方法可以做到这一点，或者我是否坚持必须获得这样的属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:28:53.330

您可以为此窃取许多功能：[Get all Attributes from a HTML element with Javascript/jQuery](https://stackoverflow.com/questions/2048720/get-all-attributes-from-a-html-element-with-javascript-jquery)

或者，干掉它：

```
var link = {};

['action', 'dialogType', 'params', 'title', 'href', 'entity', 'row'].forEach(function(i) {
    link[i] = $link.attr('data-' + i) || $link.attr(i);
}); 
```

请注意，这需要将 viewURL 更改为 href。也需要`forEach`支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:18:28.023

简单用这个

```
link=$link.data();
link.title=$link.attr('title'); 
```

按照 Wesley Murch 的建议进行编辑

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T02:34:02.940

您可以使用[jQuery`extend()`方法](http://docs.jquery.com/Utilities/jQuery.extend)（除 之外的所有内容`title`）：

```
link = $.extend(link, $('a#mylink').data());
link.title = $('a#mylink').attr('title'); 
```

这是它的实际操作：http: [//jsfiddle.net/q4hqR/](http://jsfiddle.net/q4hqR/)

# php - 将 PHP 打印到 Javascript

> ID：12774576
> 
> 赞同：0
> 
> 时间：2012-10-08T02:18:07.430
> 
> 标签：php, javascript, mysql

我有以下 php 脚本，它返回一个用逗号分隔的数字字符串：

```
<?php include "printqueryrows.php"; ?> 
```

返回

```
 2.00 , 1.00 , 21.16 , 6.75 , 6.00 , 6.25 , 3.00 , 
```

我有一个 javascript 图表创建器，它需要以下格式的数据：

```
<script type="text/javascript"> ...
                {
                name: 'London',
                data: [2.00 , 1.00 , 21.16 , 6.75 , 6.00 , 6.25 , 3.00 , ]
              }
</script> 
```

为了将 php 文件的结果包含在数据字段中（以便打印出数字，用逗号分隔，我使用以下脚本：

```
<script type="text/javascript"> ...
    data: [<?php include "printqueryrows.php"; ?>]
</script> 
```

但是，这不是打印数据。如果我在另一个脚本中单独执行此行，则会打印数据。但是当我尝试将它打印到这个 javascript 文件中时它不会打印。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:23:25.983

您需要确保包含您的 Javascript 的文件*本身就是*一个 PHP 脚本 - 确保它以`.php`. 如果您不确定它是否有效，请检查生成的网页的来源。它不应包含`<?php`浏览器端源中的任何位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:39:14.077

检查两件事：

1.  确保 JS 嵌入到扩展名为 .php 的文件中

2.  确保您的 printqueryrows.php 确实：

    回声“2.00, 1.00, 21.16, 6.75, 6.00, 6.25, 3.00,”;

# javascript - 将单选按钮更改为图像 - 请提供一点帮助？

> ID：12774587
> 
> 赞同：0
> 
> 时间：2012-10-08T02:19:27.017
> 
> 标签：javascript, css

我正在尝试将此页面上的单选按钮更改为图像
[http://www.pazzle.co.uk/index.php?main_page=product_info&cPath=6_1&products_id=3](http://www.pazzle.co.uk/index.php?main_page=product_info&cPath=6_1&products_id=3)

我正在使用本教程来做到这一点：
[http ://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)

这个脚本似乎对我不起作用，有没有更好的解决方案可以将单选按钮更改为图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:42:10.657

那个教程很老了，它没有键盘支持，而且脚本看起来很复杂……试试这个 jQuery 插件[jq-customRadioCheck](https://github.com/elclanrs/jq-customRadioCheck)。

你需要一个像这样的图像精灵：http: [//i.imgur.com/KSNpJ.png](http://i.imgur.com/KSNpJ.png)。

**HTML：**

```
<label><input type="checkbox"/>Checkbox</label>
<label><input type="radio"/>Radio</label> 
```

**jQuery：**

```
;(function(){
$.fn.customRadioCheck = function() {

  return this.each(function() {

    var $this = $(this);
    var $span = $('<span/>');

    $span.addClass('custom-'+ ($this.is(':checkbox') ? 'check' : 'radio'));
    $this.is(':checked') && $span.addClass('checked'); // init
    $span.insertAfter($this);

    $this.parent('label').addClass('custom-label')
      .attr('onclick', ''); // Fix clicking label in iOS
    // hide by shifting left
    $this.css({ position: 'absolute', left: '-9999px' });

    // Events
    $this.on({
      change: function() {
        if ($this.is(':radio')) {
          $this.parent().siblings('label')
            .find('.custom-radio').removeClass('checked');
        }
        $span.toggleClass('checked', $this.is(':checked'));
      },
      focus: function() { $span.addClass('focus'); },
      blur: function() { $span.removeClass('focus'); }
    });
  });
};
}()); 
```

**CSS：**

```
.custom-label {
  display: inline-block;
  margin-right: .8em;
  cursor: pointer;
}
.custom-radio,
.custom-check {
    vertical-align: middle;
    display: inline-block;
    position: relative;
    top: -.15em; /* Adjust to for best fit */
    margin: 0 .4em;
    width: 20px;
    height: 20px;
    background: url(customRadioCheck.png) 0 0 no-repeat;
}
.custom-radio { background-position: 0 -20px; }
.custom-check.focus { background-position: -20px 0; }
.custom-radio.focus { background-position: -20px -20px; }
.custom-check.checked { background-position: -40px 0; }
.custom-radio.checked { background-position: -40px -20px; }
.custom-check.checked.focus { background-position: -60px 0; }
.custom-radio.checked.focus { background-position: -60px -20px; } 
```

**演示：http:** [//jsfiddle.net/elclanrs/BQp2F/](http://jsfiddle.net/elclanrs/BQp2F/)

# windows - “安全”文件命名

> ID：12774589
> 
> 赞同：0
> 
> 时间：2012-10-08T02:19:50.590
> 
> 标签：windows, file, character, ascii, naming

在 Windows、Mac OS、Linux 等中是否会遇到任何“不安全”的文件名？

例如：

*   `New Video 2012-External Room`
*   `GED Practice Sheet`
*   `RgRrE-re-_d Da-`

我听说即使使用空格、下划线、大写字母和破折号命名文件也可能存在问题，即使 Windows 没有将它们包含在禁止字符列表中。这是真的？我隐约记得看到不区分大小写字符的程序，并且我知道 HTML URL 将不安全的 ASCII 字符编码为`%`（例如，空格）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:28:14.013

它在很大程度上取决于使用环境。某些非禁止字符可能会导致某些程序出现问题，尽管绝大多数使用标准系统 API 的应用程序应该不会遇到任何问题。

某些程序（尤其是命令行工具）可能对文件名中是否存在空格很敏感。其他人可能只在内部使用 ASCII，因此无法处理包含基本 ASCII 之外的字符的文件名。（大多数现代操作系统，总的来说，将接受文件名中的几乎任何 Unicode 字符）。

一些工具可能需要对某些字符进行转义（例如`%`在批处理脚本中），而另一些工具可能不喜欢在文件名中包含引号。

最后，关于大写/小写的说明：大多数 Windows 文件系统都保留大小写，但不区分大小写，因此大写/小写差异通常无关紧要。

但是，请注意，几乎在所有情况下，即使需要一些变通方法才能使它们正常工作，这些文件仍然可以使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:28:56.653

类 Unix（包括 Linux 和 Mac OS）和 Windows 都应该没有下划线的问题。空格通常也应该没问题，但是您偶尔会发现无法处理它们的错误代码。

对于 Windows，并不是大写字母有问题。这是因为 Windows 文件系统不区分大小写，因此在某些情况下，在互操作时（例如，使用区分大小写的 git 存储库）您可能会遇到问题（例如，存储库最终会出现大小写不同的重复项）。

我不确定`-`。避免它的一个原因是它对`-`许多命令行程序（例如`rm -r`）具有特殊含义。所以你必须使用烦人的语法，比如`.\-r`. 我通常也会避免像 %.

# memory-leaks - 切换精灵纹理时 CoreGraphics 中的内存泄漏。里面的代码

> ID：12774590
> 
> 赞同：0
> 
> 时间：2012-10-08T02:20:05.547
> 
> 标签：memory-leaks, cocos2d-iphone, core-graphics, ccsprite, cgcontextref

编辑：我尝试使用 push/pop 的东西，但现在它崩溃了。

我有一种感觉，我正在尝试做的事情很遥远。有没有办法让核心图形出现在屏幕上？我需要能够每帧更新的东西，比如在总是四处移动的两点之间画一条线。即使有人知道一个完整的替代方案，我也会尝试一下。

在.h

```
CGContextRef context; 
```

米

在初始化方法中

```
int width = 100;
int height = 100;

void *buffer = calloc(1, width * height * 4);
context = CreateBitmapContextWithData(width, height, buffer);

CGContextSetRGBFillColor(context, 1, 1, 1, 1);
CGContextAddRect(context, CGRectMake(0, 0, width, height));
CGContextFillPath(context);

CGImageRef image = CGBitmapContextCreateImage(context);

hud_sprite = [CCSprite spriteWithCGImage:image key:@"hud_image1"];

free(buffer);
free(image);

hud_sprite.anchorPoint = CGPointMake(0, 0);
hud_sprite.position = CGPointMake(0, 0);

[self addChild:hud_sprite z:100]; 
```

在我想更新它时调用的方法中。

```
int width = 100;
int height = 100;

UIGraphicsPushContext(context);

    CGContextClearRect(context, CGRectMake(0, 0, width, height)); //<-- crashes here. bad access...

    CGContextSetRGBFillColor(context, random_float(0, 1),random_float(0, 1),random_float(0, 1), .8);
    CGContextAddRect(context, CGRectMake(0, 0, width, height));
    CGContextFillPath(context);

    CGImageRef image = CGBitmapContextCreateImage(context);

UIGraphicsPopContext();

//CGContextRelease(ctx);

[[CCTextureCache sharedTextureCache] removeTextureForKey:@"hud_image1"];
[hud_sprite setTexture:[[CCTextureCache sharedTextureCache] addCGImage:image forKey:@"hud_image1"]];

free(image); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:25:08.407

你在打电话`UIGraphicsPushContext(context)`。您必须与`UIGraphicsPopContext()`. 由于您没有调用`UIGraphicsPopContext()`，因此您将离开`context`UIKit 的图形上下文堆栈，因此它永远不会被释放。

此外，您正在调用`UIGraphicsBeginImageContext`，它会创建一个新的图形上下文，稍后您可以通过调用`UIGraphicsEndImageContext`. 但是你永远不会使用这个上下文。你可以通过调用来访问上下文`UIGraphicsGetCurrentContext`，但你永远不会调用它。

### 更新

**永远不要调用`free`Core Foundation 对象！**

您将`CGImage`通过以下语句获得一个（这是一个核心基础对象）：

```
CGImageRef image = CGBitmapContextCreateImage(context); 
```

然后稍后你会调用`free`它：

```
free(image); 
```

你绝**不能**那样做。

去阅读[*Core Foundation 的内存管理编程指南*](http://developer.apple.com/library/ios/documentation/CoreFoundation/Conceptual/CFMemoryMgmt/Concepts/Ownership.html#//apple_ref/doc/uid/20001148-CJBEJBHH)。当你完成了一个 Core Foundation 对象并且你拥有它的所有权（因为你是从一个 Create 函数或一个 Copy 函数得到它的），你必须用一个 Release 函数来释放它。在这种情况下，您可以使用`CFRelease`或`CGImageRelease`：

```
CGImageRelease(image); 
```

此外，您正在分配`buffer`using `calloc`，然后将其传递给`CreateBitmapContextWithData`（我猜这是您的包装器`CGBitmapContextCreateWithData`），然后释放`buffer`. 但`context`保留一个指向缓冲区的指针。所以在你之后`free(buffer)`，`context`有一个悬空指针。这就是你崩溃的原因。`buffer`在你释放之前你不能自由`context`。

处理这个问题的最好方法是`CGBitmapContextCreateWithData`通过`NULL`作为第一个 ( `data`) 参数传递来处理分配缓冲区本身。在这种情况下，没有理由自己分配缓冲区。

# asp.net - 将供应商与每个供应商的产品联系起来所需的数据源

> ID：12774591
> 
> 赞同：1
> 
> 时间：2012-10-08T02:20:20.863
> 
> 标签：asp.net, vb.net, datasource, code-behind, bulletedlist

我们希望在 GridView 中显示供应商和显示的每个产品的项目符号列表。

例如：

```
Supplier One               Product A
                           Product B

Supplier Two               Product A
                           Product B
                           Product C 
```

这是 GridView 的样子：

```
 <asp:GridView 
            ID="GridView1" 
            runat="server" 
            AutoGenerateColumns="False" 
            CssClass="DataWebControlStyle">

            <HeaderStyle CssClass="HeaderStyle" />

            <AlternatingRowStyle CssClass="AlternatingRowStyle" />

            <Columns>
                <asp:BoundField 
                    DataField="CompanyName" 
                    HeaderText="Supplier" />

                <asp:TemplateField HeaderText="Products">
                    <ItemTemplate>
                        <asp:BulletedList 
                            ID="BulletedList1" 
                            runat="server" 
                            DataSource='<%#  %>'
                            DataTextField="ProductName">
                        </asp:BulletedList>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView> 
```

这是将数据加载到 GridView 中的代码隐藏文件：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim suppliersAdapter As New SuppliersTableAdapter

    GridView1.DataSource = suppliersAdapter.GetSuppliers()
    GridView1.DataBind()
End Sub 
```

你能告诉我们在 asp:BulletedList DataSouce 中放置什么以便产品也可以显示吗？

*** 更新 ***

感谢大家的帮助。我删除了 DataSource='<%# %>' 行，这里是基于您在代码隐藏文件中的帮助的附加工作编码。

由于我正在学习 ASP.Net，因此我在代码中添加了很多注释，以帮助自己了解发生了什么以及是什么使它运行。如果我在评论中犯了错误，请调整评论。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    ' TableAdapter object.
    ' Provide communication between this application and the database.
    '-----------------------------------------------------------------
    Dim suppliersAdapter As New SuppliersTableAdapter

    ' Get the data from the TableAdapter into the GridView.
    '------------------------------------------------------
    GridView1.DataSource = suppliersAdapter.GetSuppliers()

    ' Display the result set from the TableAdapter in the GridView.
    '--------------------------------------------------------------
    GridView1.DataBind()
End Sub

Protected Sub GridView1_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound

    ' A GridView has DataRows, EmptyDataRows, Footers, Headers, Pagers, and Separators.
    ' The DataSource will be assigned to the BulletedList in this GridView only when the RowType is a DataRow.
    ' This will make sure the "Object reference not set to an instance of an object" error will not be thrown.
    '---------------------------------------------------------------------------------------------------------
    If e.Row.RowType = DataControlRowType.DataRow Then

        ' TableAdapter object.
        ' Provide communication between this application and the database.
        '-----------------------------------------------------------------
        Dim productsAdapter As New ProductsTableAdapter

        ' BulletedList object.
        ' This object is created from the BulletedList control in the aspx file for GridView 
        ' so it can be used to assign a DataSource to the BulletedList.
        '------------------------------------------------------------------------------------
        Dim BulletedList1 As BulletedList = DirectCast(e.Row.FindControl("BulletedList1"), BulletedList)

        ' Get the SupplierID into a variable for use as a parameter for the GetProductsBySupplierID method of the TableAdapter.
        '----------------------------------------------------------------------------------------------------------------------
        Dim supplier = DataBinder.Eval(e.Row.DataItem, "SupplierID")

        ' Get the data from the TableAdapter into the GridView.
        '------------------------------------------------------
        BulletedList1.DataSource = productsAdapter.GetProductsBySupplierID(supplier)

        ' Display the result set from the TableAdapter in the GridView.
        '--------------------------------------------------------------
        BulletedList1.DataBind()
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:05:20.577

每个列表都有不同的数据源。

`BulletedList`您可以通过在网格的on [RowDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件上设置数据源来实现您的目标。

`RowDataBound`按如下方式附加事件处理程序：

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
   if (e.Row.RowType==DataControlRowType.DataRow) 
   {       
       BulletedList BulletedList1 = (BulletedList)e.Row.FindControl("BulletedList1"); 
       var supplier = DataBinder.Eval(e.Row.DataItem, "CompanyName");
       BulletedList1.DataSource = GetProductListForSupplier(supplier);
       BulletedList1.DataBind();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T04:04:27.080

试试这个

```
 protected void GridView1_RowDataBound(Object sender, GridViewRowEventArgs e)
  {

    if(e.Row.RowType == DataControlRowType.DataRow)
    {
      // Display the company name in italics.
      string supplierName = e.Row.Cells[0].Text;
      //OR assuming you stored the SupplierID in hidden view - this can also be retrieved from GridView DataKeys value for each row
      string supplierID = ((HiddenField) e.Row.FindControl("hiddenFieldSupplierID")).Value;

      DataTable products = getProductsBySupplier(supplierID); //or by SupplierName
      BulletedList BulletedList1 = ((BulletedList) e.Row.FindControl("BulletedList1"))
      BulletedList1.DataSource = products;
      BulletedList1.DataBind()     

    }

  } 
```

# jquery - 使用 jQuery 定位父元素

> ID：12774598
> 
> 赞同：0
> 
> 时间：2012-10-08T02:22:31.803
> 
> 标签：jquery

我制作了一个下拉菜单，它使用选项卡来显示每个菜单项的特定内容。

这是我用于标签功能的 jQuery 教程的链接： [http ://www.jacklmoore.com/notes/jquery-tabs](http://www.jacklmoore.com/notes/jquery-tabs)

我已经修改了代码以满足我的需要，但是我无法找到一种方法来更改也应用了“活动”类的元素。出于 CSS 样式的原因，我希望将“活动”类应用于当前正在添加的父`<li>`类。`<a>`

我尝试了各种解决方案，包括该`.parent();`方法无济于事。这里的任何建议将不胜感激。

这是处理添加类的代码的快速片段：

```
// Keep track of which tab is active and it's associated content
var $active, $content, $links = $(this).find('li.activate-dropdown a');

// If the location.hash matches one of the links, use that as the active tab.
$active = $($links.filter('[rel="'+location.hash+'"]')[0]);
$active.addClass('active');
$content = $($active.attr('rel')); 
```

**编辑：** 示例实时代码 - [http://jsfiddle.net/jgfg7/3/](http://jsfiddle.net/jgfg7/3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:27:28.307

如果您的代码适用于该`<a>`元素，则这应该适用于父级：

```
// Keep track of which tab is active and it's associated content
var $active, $content, $links = $(this).find('li.activate-dropdown a');

// If the location.hash matches one of the links, use that as the active tab.
$active = $($links.filter('[rel="'+location.hash+'"]')[0]);
$active.parent().addClass('active');
$content = $($active.attr('rel')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:28:00.830

你有没有尝试过

```
$active.parents("li").addClass('active'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:53:57.630

在将[`.closest('li')`](http://api.jquery.com/closest/)类删除或添加到`$active`.

查看更新的小提琴：http: [//jsfiddle.net/jgfg7/4/](http://jsfiddle.net/jgfg7/4/)

# php - 如何从 php 和 mysql 向客户端发送递增密钥？

> ID：12774602
> 
> 赞同：0
> 
> 时间：2012-10-08T02:23:50.273
> 
> 标签：php, mysql

我有一张简单的桌子

```
CREATE TABLE `keys` (
`IDkey` int NOT NULL auto_increment,
`username` varchar(50) NOT NULL, 
PRIMARY KEY  (`IDkey`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

并在用户使用我的 webapp 调用时向他们提供递增的整数键“IDkey”。我还将他们的用户名存储在表中。

我有两个问题我坚持。

第一个问题：目前我正在执行以下操作以给出密钥，有没有办法将其组合成一个查询？

```
INSERT INTO keys VALUES (NULL, '$username');
SELECT IDkey FROM keys WHERE username='$username'; 
```

第二个问题：密钥过期，因此同一用户可能会返回新密钥，但这会导致问题，因为他们的用户名已经在数据库中。有没有办法编写我的 SELECT 查询，以便返回该用户的最新记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:26:19.600

如果您正在使用`PDO`，请查看[`PDO::lastInsertId()`](http://php.net/manual/en/pdo.lastinsertid.php)。

如果您正在使用`mysqli`，请查看[`mysqli::$insert_id`](http://us3.php.net/manual/en/mysqli.insert-id.php)。

如果您正在使用`mysql`，请将您的代码升级为使用`PDO`或`mysqli`。;-) （但说真的，你可以用[`mysql_insert_id()`](http://us3.php.net/manual/en/function.mysql-insert-id.php)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T02:27:57.807

插入此记录后立即调用此函数 mysql_insert_id()。它将为您提供最后插入的记录的 id。

# php - PHP以小写形式检索列

> ID：12774605
> 
> 赞同：-1
> 
> 时间：2012-10-08T02:24:44.043
> 
> 标签：php, mysql, database, pdo

> **可能重复：**
> [PHP PDO 用户名可用性检查器](https://stackoverflow.com/questions/12656617/php-pdo-username-availability-checker)

我有一个 php 脚本来检查用户名的可用性（如果它已经被使用了）。但是我想比较用户输入的用户名和数据库中小写的用户名。我已经将输入输入为小写，但是如何将检索到的列设为小写。这是php脚本

```
<?php 
    $usr = strtolower($_GET['username']);
    $link = new PDO('mysql:host=***;dbname=***;charset=UTF-8','***','***');
    $usr_check = $link->prepare("SELECT * FROM Conference WHERE Username = :usr");
    $usr_check->bindParam(':usr', $usr);
    $usr_check->execute();
    if($usr_check->rowCount()>0)
        echo "false";
    else
            echo "true";
?> 
```

如何将用户名列设置为小写，然后将其与`$usr`？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:27:53.830

请试试

```
 SELECT * FROM Conference WHERE LOWER(Username) = :usr 
```

[http://www.sqlinfo.net/mysql/mysql_function_upper_lower.php](http://www.sqlinfo.net/mysql/mysql_function_upper_lower.php)

好的，正如您在下面的评论中所说，我建议您执行以下操作。

1.  将结果转换为小写[http://sqlfiddle.com/#!2/bd50e/1](http://sqlfiddle.com/#!2/bd50e/1)

2.  使用 strtolower 将您的比较字符串转换为小写

3.  现在比较结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:29:25.233

你可以使用

```
SELECT * FROM Conference WHERE LOWER(Username) = :usr 
```

作为查询，但这会使您失去索引的好处。

但是，如果列使用“ci”排序规则，则比较无论如何都应该不区分大小写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T02:29:29.943

如果要在 MySQL 中将字符串转换为较低的值，请使用 LOWER(str) 函数。

# php - 邮件联系表

> ID：12774610
> 
> 赞同：0
> 
> 时间：2012-10-08T02:25:58.167
> 
> 标签：php, html, forms, contact-form

这段代码有什么问题？这是代码的第一页：

```
<strong>Contact Form</strong><form name="form1" method="post" action="sendcontact.php">Subject:<input name="subject" type="text" id="subject" size="50">Detail:<textarea name="detail" cols="50" rows="4" id="detail"> </textarea>Name:<input name="name" type="text" id="name" size="50">Email:<input name="email" type="text" id="email" size="50"><input type="submit" name="Submit" value="Submit"><input type="reset" name="Submit2" value="Reset"> 
```

这是 sendcontact.php 页面：

```
<?php $subject =$subject;$message =$detail;$mail_form =$email;$header ="from: $name<$mail_from>";mail("email@email.com",$subject,$message,$header);?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:33:28.070

要检索从 POST 表单提交的变量，您必须从`$_POST`数组中获取它们的值。

这应该完成你所追求的：

```
$subject = $_POST['subject'];
$message = $_POST['detail'];
$mail_from = $_POST['email'];
$header ="from: ".$_POST['name']."<$mail_from>";
mail("email@email.com",$subject,$message,$header); 
```

# actionscript-3 - URLRequest/URLLoader 将 POST 请求自动转换为 GET

> ID：12774611
> 
> 赞同：5
> 
> 时间：2012-10-08T02:25:58.443
> 
> 标签：actionscript-3, apache-flex, http

当我执行以下代码时：

```
var urlRequest:URLRequest = new URLRequest("http://somehost/with/some/path?andsomequerystring=true");
urlRequest.method = 'POST';
var urlLoader:URLLoader = new URLLoader(urlRequest);
urlLoader.addEventListener(Event.COMPLETE,  function(event:Event):void{
    trace('sweet');
}); 
```

由于查询字符串的存在，它将我的显式 POST 请求转换为 GET。如果我删除查询字符串（并作为 POST 正文的一部分进行序列化），它会成功发出相应的 POST 请求。有没有办法阻止它这样做？我的服务器要求使用查询字符串发出 POST 请求。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T02:41:27.163

啊，我想我找到了答案，看来您还必须指定一个正文，否则它仍会作为 GET 请求从他们的文档中发送：

> 注意：如果在 Flash Player 中运行并且引用的表单没有正文，则 Flash Player 会自动使用 GET 操作，即使该方法设置为 URLRequestMethod.POST。因此，建议始终包含一个“虚拟”主体，以确保使用正确的方法。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html#url](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html#url)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T05:32:08.123

这是因为您拥有网址的方式。如果你想让你的变量用于 POST 方法，你需要使用`URLVariables`.

```
var urlRequest:URLRequest = new URLRequest(YOUR_REQUEST_URL_HERE);
var variables:URLVariables = new URLVariables();
variables.andsomequerystring = true;

urlRequest.data = variables;
urlRequest.method = 'POST';
var urlLoader:URLLoader = new URLLoader(urlRequest);
urlLoader.addEventListener(Event.COMPLETE,  function(event:Event):void{
    trace('sweet');
}); 
```

# java - 多矩形生成

> ID：12774618
> 
> 赞同：1
> 
> 时间：2012-10-08T02:26:53.967
> 
> 标签：java, arrays, arraylist, slick2d, particles

> **可能重复：**
> [绘制多个像素/矩形](https://stackoverflow.com/questions/12766615/drawing-multiple-pixels-rectangles)

在我的代码中，我编写了一个在 mouseX、mouseY 处创建矩形的方法。但它所做的只是更新该矩形的位置，使其跟随鼠标，我希望它在每次运行该方法时在鼠标上创建一个新矩形，有人可以帮忙吗？

这是我的方法

```
public void drawParticle(float x, float y){
    g.drawRect(x, y, 4, 4);
} 
```

主类Control调用drawParticle方法；

```
import java.awt.Point;
import java.awt.geom.Point2D;

import org.newdawn.slick.GameContainer;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.state.BasicGameState;
import org.newdawn.slick.state.StateBasedGame;

public class Control extends BasicGameState {
    public static final int ID = 1;

    public Methods m = new Methods();
    public Graphics g = new Graphics();

    int mouseX;
    int mouseY;

    public void init(GameContainer container, StateBasedGame game) throws SlickException{
    }

    public void render(GameContainer container, StateBasedGame game, Graphics g) throws SlickException {
        m.drawParticle(mouseX, mouseY);
    }

    public void update(GameContainer container, StateBasedGame game, int delta) {
    }

    public void mousePressed(int button, int x, int y) {
        mouseX = x;
        mouseY = y;
    }

    public int getID() {
        return ID;
    }

} 
```

谢谢 - 沙姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:17:03.027

总而言之，您需要在每个绘制周期中维护一个要绘制的对象列表。

![在此处输入图像描述](../Images/6cebae54954e717991733c70247732b7.png)

```
public class ColorMeRectangles {

    public static void main(String[] args) {
        new ColorMeRectangles();
    }

    public ColorMeRectangles() {

        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setSize(400, 400);
                frame.setLocationRelativeTo(null);
                frame.setLayout(new BorderLayout());
                frame.add(new RectanglePane());
                frame.setVisible(true);

            }
        });

    }

    public class RectanglePane extends JPanel {

        private Point mousePoint;
        private List<Partical> particals;
        private Timer generator;
        private int min = -4;
        private int max = 4;

        public RectanglePane() {

            setBackground(Color.BLACK);

            particals = new ArrayList<Partical>(25);

            addMouseMotionListener(new MouseAdapter() {
                @Override
                public void mouseMoved(MouseEvent e) {
                    mousePoint = e.getPoint();
                    repaint();
                }
            });

            generator = new Timer(125, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {

                    if (mousePoint != null) {

                        int x = mousePoint.x + (min + (int) (Math.random() * ((max - min) + 1)));
                        int y = mousePoint.y + (min + (int) (Math.random() * ((max - min) + 1)));

                        Color color = new Color(
                                (int) (Math.random() * 255),
                                (int) (Math.random() * 255),
                                (int) (Math.random() * 255));

                        particals.add(new Partical(new Point(x, y), color));

                        repaint();

                    }

                }
            });
            generator.setRepeats(true);
            generator.setCoalesce(true);
            generator.start();

        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            for (Partical partical : particals) {

                partical.paint(g2d);

            }

            if (mousePoint != null) {

                g2d.setColor(Color.WHITE);
                g2d.drawRect(mousePoint.x - 2, mousePoint.y - 2, 4, 4);

            }

            g2d.dispose();

        }
    }

    public class Partical {

        private Point location;
        private Color color;

        public Partical(Point location, Color color) {
            this.location = location;
            this.color = color;
        }

        public Point getLocation() {
            return location;
        }

        public Color getColor() {
            return color;
        }

        public void paint(Graphics2D g2d) {
            g2d.setColor(color);
            g2d.drawRect(location.x - 4, location.y - 4, 8, 8);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:09:03.823

一种方法是创建一个`List`作为成员变量，并`Rectangle`在用户每次单击鼠标时添加一个新变量。然后在您的`render()`方法中，遍历`List`of`Rectangle`并绘制每个。

# ruby-on-rails - ruby on rails 3.0 TimeWithZone 添加小时不能被强制转换为 Fixnum

> ID：12774620
> 
> 赞同：3
> 
> 时间：2012-10-08T02:27:04.707
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, time, fixnum

我的代码中出现了一个非常奇怪的错误，我希望有人可以帮助我。我有一个模型，它有一个 created_at 列和一个我创建的 duration 列。持续时间只是一个整数，假定为小时数。然后我试图将当前时间与 created_at 时间 + 持续时间进行比较，以查看该行是否已过期。我的代码如下所示：

```
@expire_time = purchase.duration.hours + purchase.created_at
if(@expire_time > Time.current)
  #do some stuff if the current time isn't greater than the expiration time
end 
```

当我在控制台中运行第一行时它工作正常，但是当我保存我的代码并通过它的一部分的路由调用它时，我在该行收到以下错误。

ActiveSupport::TimeWithZone 不能被强制转换为 Fixnum

有没有人对可能是什么问题/我如何正确进行比较有任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-08T02:44:51.643

我发现了问题...

这不起作用：purchase.duration.hours + purchase.created_at

但这确实：purchase.created_at + purchase.duration.hours

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-03T14:51:40.853

你刚刚救了我的命（或至少过去两个小时......），谢谢！

`DateTime.current + 7.days` 效果很好，一周后返回日期时间

`7.days + DateTime.current`

> TypeError（不能将日期时间强制转换为整数）`

# python - Python - 停留在从 csv 读取特定行

> ID：12774622
> 
> 赞同：0
> 
> 时间：2012-10-08T02:27:05.857
> 
> 标签：python, csv, arcpy

我需要将列添加到基于 csv 的“匹配”形状文件中。我还有最后一步要完成，即从 csv 获取要输入 shp 的值。

我明白了

> > > > readCSV[rowID] Traceback（最近一次调用最后一次）：文件“”，第 1 行，类型错误：'_csv.reader' 对象不可下标

精简后的 CSV 是

![在此处输入图像描述](../Images/6cdb671d663a0ea9fbc188bf8efc7c97.png)

文件看起来像 ![在此处输入图像描述](../Images/0ef340b05970a20aaaf01047a90a525e.png)

该代码将 OVL_CAT + OVL2_DESC 与文件名匹配。

然后，我获取代码以添加名为 LGA_CODE 的列，并需要使用第 2 行第 1 列的“583094”填充它...当我无法调用 FileList [2](https://i.stack.imgur.com/dCWIY.jpg)以从 csv 获取第 2 行时，我该如何获取（在下面的示例中为 3，但在 python 中为 2）？

```
import os, sys, datetime, csv, arcpy, string
from subprocess import Popen
from itertools import islice

top = os.getcwd() # change to a specific path if required.
# This otherwise starts with the directory the script is in (preferred).
RootOutput = r'P:\2012\273_CCRC_Townplanning_Datasets\Working\scratch' # change if you want output somewhere else
top=RootOutput
SourceDIR = r'P:\2012\273_CCRC_Townplanning_Datasets\Working\scratch\OM_011' # source of your data (subdirectories searched as well
outDIR = top+"\\workingFiles" # directory where output is written to. Includes temp files
finalDIR = top+"\\final" # folder for final data only
AOI = 'AOI.csv' # name of the file containing the las file names in the second column
Compare_Column = 2
Compare_Column2 = 3

# END setting base paths
# NOTHING BELOW should need editing.
FileTypes=['shp']
SearchStrings=[]
filecount=0
List =[]
count=0
x=0
os.chdir(top)

#Generate list with unique file name codes from CSV

FileList = csv.reader(open(AOI))
SearchStrings=[]
rowID=0
for File in FileList:
    #SearchStrings.append(File[0]+","+File[1])
    SearchStrings.append(str(rowID)+'_'+File[Compare_Column]+'_'+File[Compare_Column2])
    rowID=rowID+1

for root, dirs, files in os.walk(SourceDIR, topdown=False):
    for fl in files:
      currentFile=os.path.join(root, fl)
      for FileType in FileTypes:
          status= str.endswith(currentFile,FileType)
          if str(status) == 'True':
              List.append(currentFile)
              for SearchString in SearchStrings:
                  #print currentFile
                  #print SearchString
                  if str(SearchString in currentFile) == 'True':
                    #print str(currentFile)+str(status)
                    List.append(currentFile)
      filecount=filecount+1

#del fl

# Get list of Column Names
headers_count = 1

with open(AOI) as fin:
  headers = list(islice(fin, headers_count))
  delimiter=','
  header=str(headers)
  header_list=header.split(delimiter)

# Process matching files
for fl in List:
    header_count=0
    for header in header_list:
        dfStore=fl
        #arcpy.AddField_management(dfStore, str(header) ,'TEXT')

        # Get RowID to read column data from
        filename=fl[fl.rfind('\\')+1:fl.rfind('_')]
        for field in SearchStrings:
            #print field, filename
            if field.endswith(filename):
                rowID=field[:field.find('_')]
                with open(AOI, 'rb') as f:
                    readCSV= csv.reader(f)
                    text=readCSV[rowID][1]

##        arcpy.CalculateField_management(fl, header, text,"PYTHON_9.3") 
```

=== 基于评论的更新代码 - 如果有人需要，一切都可以找到。

```
import os, sys, datetime, csv, arcpy, string
from subprocess import Popen
from itertools import islice

top = os.getcwd() # change to a specific path if required.
# This otherwise starts with the directory the script is in (preferred).
RootOutput = r'P:\2012\273_CCRC_Townplanning_Datasets\Working\scratch' # change if you want output somewhere else
top=RootOutput
SourceDIR = r'P:\2012\273_CCRC_Townplanning_Datasets\Working\scratch\OM_011' # source of your data (subdirectories searched as well
outDIR = top+"\\workingFiles" # directory where output is written to. Includes temp files
finalDIR = top+"\\final" # folder for final data only
AOI = 'AOI.csv' # name of the file containing the las file names in the second column
Compare_Column = 3
Compare_Column2 = 4

# END setting base paths
# NOTHING BELOW should need editing.
FileTypes=['shp']
SearchStrings=[]
filecount=0
List =[]
count=0
x=0
os.chdir(top)

#Generate list with unique file name codes from CSV

FileList = csv.reader(open(AOI))
SearchStrings=[]
rows=[]
#FinalList=[]
rowID=0
for File in FileList:
    #SearchStrings.append(File[0]+","+File[1])
    SearchStrings.append(str(rowID)+'_'+File[Compare_Column]+'_'+File[Compare_Column2])
    rows.append(File)
    #FinalList.append()
    rowID+=1

for root, dirs, files in os.walk(SourceDIR, topdown=False):
    for fl in files:
      currentFile=os.path.join(root, fl)
      for FileType in FileTypes:
          status= str.endswith(currentFile,FileType)
          if status:
              #List.append(currentFile)
              for SearchString in SearchStrings:
                  #print currentFile, SearchString
                  if str(SearchString[SearchString.find('_')+1:] in currentFile) == 'True':
                    #print str(currentFile)+str(status)
                    List.append(currentFile)
      filecount=filecount+1

#del fl

# Get list of Column Names
headers_count = 1

with open(AOI) as fin:
  headers = list(islice(fin, headers_count))
  delimiter=','
  header=str(headers)
  header_listT=header.split(delimiter)

header_list=[]

for hdr in header_listT:
    header_list.append(arcpy.ValidateTableName(hdr)[:10])

# Process matching files

columnID=1

for fl in List:
    header_count=0
    for header in header_list:
        print header
        dfStore=fl
        try:
            arcpy.AddField_management(dfStore, str(header) ,'TEXT')
        except:
            pass

        # Get RowID to read column data from
        filename=fl[fl.rfind('\\')+1:fl.rfind('_')]

        for field in SearchStrings:
        #print field, filename
            #print header, field
            if field.endswith(filename):
                #print 'FOUND......................'
                column_count=len(fl)
                if columnID < len(header_list):
                    rowID=int(field[:field.find('_')])
                    text = rows[rowID][columnID]
                    print filename, header, text
                    columnID+=1
                    arcpy.CalculateField_management(fl, header, "text" ,"PYTHON_9.3")

#arcpy.CalculateField_management("P:/2012/273_CCRC_Townplanning_Datasets/Working/scratch/OM_011/OM_011_Waterway_Envelopes_ccrc.shp","LGA_CODE","5","PYTHON","#") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:39:31.617

您的问题在于这两行：

```
readCSV= csv.reader(f)
text=readCSV[rowID][1] 
```

`csv.reader`是对文件行的可迭代；它不能被直接索引。您可以使用`islice`来获取您想要的元素 ( )，但更简洁的解决方案是在您第一次阅读时`islice(readCSV, rowID, rowID+1).next()`将字典映射存储`rowID`到该行（在循环中）：`AOI``SearchStrings`

```
FileList = csv.reader(open(AOI))
SearchStrings = []
rows = []
rowID=0
for File in FileList:
    #SearchStrings.append(File[0]+","+File[1])
    SearchStrings.append(str(rowID)+'_'+File[Compare_Column]+'_'+File[Compare_Column2])
    rows.append(File)
    rowID=rowID+1

... # later

rowID=int(field[:field.find('_')])
text = rows[rowID][1] 
```

# ruby-on-rails - Rails 3 异步外部程序

> ID：12774624
> 
> 赞同：1
> 
> 时间：2012-10-08T02:27:21.833
> 
> 标签：ruby-on-rails, asynchronous, ruby-on-rails-3.2

我正在 Rails 3.2.8 下设计一个 Web 服务，它将为用户执行外部程序，预期的用例是：

1) 用户填写参数表并提交请求

2) Rails 根据用户请求执行 Matlab 程序。它会持续几分钟（不到 3 分钟）并生成一个结果文件显示程序已完成

3) 在这个过程中，将用户重定向到一个页面显示“正在加载”状态，并监控是否生成了结果文件

4) 生成结果文件后，通过 AJAX 重新加载页面并显示结果。

有没有“rails”的方式来做到这一点？我以前在 JAVA SSH 框架中这样做过，但非常痛苦。我需要什么工具？例如，我是否需要像 backgroundjob 这样的 gem 来管理任务队列？或者是否有任何“单一”的宝石可以处理这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T04:04:49.267

我有点想通在整个过程中使用什么：

**1) 用户填写参数表并提交请求**

使用此 rails cast 中的方法：[http](http://railscasts.com/episodes/219-active-model) ://railscasts.com/episodes/219-active-model进行服务器端验证和 gem 'client-side-validations' 启用客户端检查。

**2) Rails 根据用户请求执行 Matlab 程序。它会持续几分钟（不到 3 分钟）并生成一个结果文件显示程序已完成**

使用 gem 'DelayedJob' 进行任务管理和 'ChildProcess' 来启动 Matlab 程序。

**3) 在这个过程中，将用户重定向到一个页面显示“正在加载”状态，并监控是否生成了结果文件**

监控子进程以及结果文件是否存在，检查任务是否完成。

**4) 生成结果文件后，通过 AJAX 重新加载页面并显示结果。**

使用此 rails cast 的轮询方法：[http](http://railscasts.com/episodes/229-polling-for-changes) ://railscasts.com/episodes/229-polling-for-changes更新结果页面。我没有使用推送，尽管它会更安全——因为轮询似乎是一种更轻量级的解决方案并且可以满足我的要求。

显然这不是最佳实践，但满足了我的需求并且易于实施。感谢所有的评论和回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T13:06:53.757

使用多个作业队列提供程序之一。示例包括 DelayedJob（最简单的一个，不需要额外的部分）、Resque 和 Sidekiq（快得多，但您需要一个小型 Redis 服务器来使用它们）。

“作业”将是（取决于提供者）实现执行的类或实例。如果它意味着在 shell 中运行某些东西，你可以这样做

```
%x[matlab command --options > output.ext] 
```

（这只是一个例子，你也可以使用字符串插值`%x[#{executable_name}]`：）

# sql-server - SQL Server 中的分页问题

> ID：12774625
> 
> 赞同：1
> 
> 时间：2012-10-08T02:27:23.237
> 
> 标签：sql-server, sql-server-2005, paging

我在 SQL Server 中搜索了分页。我发现大多数解决方案都是这样的

[在 SQL Server 中对结果进行分页的最佳方法是什么](https://stackoverflow.com/questions/109232/what-is-the-best-way-to-paginate-results-in-sql-server)

但这并不符合我的期望。

这是我的情况：

我在 JasperReport 上工作，为此：要导出报告，我只需将任何 Select 查询传递到模板中，它将自动生成报告

EX：我有一个这样的选择查询：

```
Select * from table A 
```

我不知道表 A 中的任何列名。所以我不能使用

```
Select ROW_NUMBER() Over (Order By columsName) 
```

而且我也不希望它按任何列排序。

任何人都可以帮我做吗？

PS：在 Oracle 中，它的 rownum 在这种情况下非常有用。

```
Select * from tableA where rownum > 100 and rownum <200 
```

[使用 Oracle 进行分页](https://stackoverflow.com/questions/241622/paging-with-oracle)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T09:35:26.433

您*应该*`ROW_NUMBER`与- 一起使用，`ORDER BY`因为没有 a`ORDER BY`就无法确定如何返回行。您可以运行相同的查询 3 次，然后以三种不同的顺序返回结果。特别是如果旋转木马扫描开始发挥作用。

因此，除非您希望您的报告有可能在多个页面上向用户显示相同的行，或者某些行从不在任何页面上，否则您需要找到一种方法来对结果集进行排序以使其具有确定性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T04:49:25.023

在我看来，您可以使用 sql 查询来找出一个表中有多少列，然后找出一个合适的列供 'order by' 依赖。如何获取表列的脚本参考：[How can I get column names from a table in SQL Server?](https://stackoverflow.com/questions/1054984/get-columns-of-a-table-sql-server)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T06:17:04.390

感谢您的所有帮助。因为在**MS SQL Server**中分页时需要**order by**，所以我使用 ResultSetMetaData 来获取 Columns 名称并进行分页。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T02:32:12.860

看看这个链接

[http://msdn.microsoft.com/en-us/library/ms186734.aspx](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

SQL Server 有类似的函数 ROW_NUMBER。虽然它的行为有点不同。

除非您在 order by 子句中指定了列，否则 SQL Server 不保证行顺序。我建议您给出具有唯一值的 order by 子句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T04:50:02.990

您也可以使用以下查询。

```
declare @test table(
id int,
value1 varchar(100),
value2 int)

insert into @test values(1,'10/50',50)
insert into @test values(2,'10/60',60)
insert into @test values(3,'10/60',61)
insert into @test values(4,'10/60',10)
insert into @test values(5,'10/60',11)
insert into @test values(6,'10/60',09)

select * 
from ( select row_number() over (order by (select 0)) as rownumber,* from @test )test 
where test.rownumber<=5 
```**

# g++ - Ubuntu 中 Eclipse Juno CDT 中的程序“g++ not found in path”

> ID：12774629
> 
> 赞同：6
> 
> 时间：2012-10-08T02:27:37.663
> 
> 标签：g++, eclipse-cdt, ubuntu-12.04

Eclipse June CDT 报告`g++ not found in path`，如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-08T03:10:32.607

通常，g++ 将在安装 gcc（GNU 编译器集合）时安装。首先确认你已经安装了 g++。

您可以通过在终端中键入以下内容来检查这一点：which g++。响应应该是 /usr/bin/g++。

如果您发现安装了 g++，请在 eclipse 中转到 project->properties->C/C++ Build->Discovery Options，在工具 GCC C++ Compiler 下，输入 g++ 而不是 g++ 的确切路径（如果单独使用 g++ 不起作用）。

你会发现这个链接很有用： [g++ 和 gcc 有什么区别？](https://stackoverflow.com/questions/172587/what-is-the-difference-between-g-and-gcc)

如果您仍然有问题，请回复反馈。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-04T23:44:27.963

我有类似的问题，它是由

1.  使用 ubuntu 软件中心安装 g++ GNU C++ 编译器和

2.  换人——

    Window -> Preferences -> C/C++ -> Build -> Settings -> Discovery -> CDT GCC Build in Complier Settings [共享]

    来自：${COMMAND} -E -P -v -dD "${INPUTS}"

    到：/usr/bin/${COMMAND} -E -P -v -dD "${INPUTS}"

我希望它有所帮助。我认为，如果您按照第一个答案中所述将其添加到项目中，则需要一直为新项目添加。如果您按照我写的方式添加，则无需为新项目添加它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-26T21:11:31.687

我有完全一样的问题。我以前在 linux 下从来没有遇到过 eclipse 的问题，现在它甚至不会编译代码。我试图将 g++ 和 gcc 编译器的名称更改为它们在 project->properties->c/c++ Build->discovery options 等中的确切位置。没有任何帮助，我尝试重新安装 eclipse 并进行了初始化，添加了路径变量等。没有什么效果这么好。我正在做的项目很安静，我宁愿让 eclipse 来管理源代码和 makefile，而不是手动进行

Linux Mint 15 Eclispe：版本：3.8.1（我也尝试过使用最新版本......没有任何变化）

g++ --version g++ (Ubuntu/Linaro 4.7.3-1ubuntu1) 4.7.3 版权所有 (C) 2012 Free Software Foundation, Inc. 这是免费软件；查看复制条件的来源。没有保修；甚至不考虑适销性或特定用途的适用性。

gcc --version gcc (Ubuntu/Linaro 4.7.3-1ubuntu1) 4.7.3 版权所有 (C) 2012 Free Software Foundation, Inc. 这是免费软件；查看复制条件的来源。没有保修；甚至不考虑适销性或特定用途的适用性。

例子：

 `````
#include // not resolved using namespace std;

int main() {
    std::cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
    return 0;
} 
````  `好吧，上面的代码并不困扰我，因为我可以通过添加确切的 c++ 包含路径的包含来修复它，但是代码不会编译。有线足够的日食给了我错误：

说明资源路径位置类型程序“g++”未在 PATH Preferences、C++/Build/Settings/Discovery、[CDT GCC Builtin Compiler Settings] 选项中找到 C/C++ 扫描仪发现问题

但在我看来可以编译单个文件，通过打开它们并按crt + b，但整个项目不会编译。

**修复了今天早上的问题：
- 得到了最新的 eclipse
- 创建了一个新的工作空间
- 创建了一个新的项目**

**几秒钟后，同样的错误消失了**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-30T19:41:16.787

一旦我删除了 eclipse 的 .metedata 文件夹，这个问题就解决了，从命令行调用 eclipse -initialize 并再次启动 eclipse。高温高压

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-08T22:18:05.573

在 Eclipse 启动时创建一个新的 Workspace 目录为我解决了这个问题。``

# xml - 如何正确引用georss：指向我的xsd？

> ID：12774641
> 
> 赞同：4
> 
> 时间：2012-10-08T02:29:45.247
> 
> 标签：xml, import, xsd, georss

我正在组合一个 XSD 模式来描述现有的 GeoRSS 提要，但我在尝试使用外部 georss.xsd 来验证 type 的元素时遇到了困难`georss:point`。因此，我已将问题减少到最小的组件：

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<this>
    <apoint>45.256 -71.92</apoint>
</this> 
```

XSD：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:georss="http://www.georss.org/georss">
<xs:import namespace="http://www.georss.org/georss"
           schemaLocation="http://georss.org/xml/1.1/georss.xsd"/>
    <xs:element name="this">
        <xs:complexType>    
            <xs:sequence>    
                <xs:element name="apoint" type="georss:point"/>   
            </xs:sequence>
        </xs:complexType>   
    </xs:element>
</xs:schema> 
```

如果我创建一个点类型“xs：string”而不是“georss：point”，XML 会根据 XSD 愉快地验证，但是一旦我引用导入的类型（georss：point），我的 XML 验证器（Notepad++ | XML 工具） “无法解析架构”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T13:46:52.883

在问题的上下文中，您指的是不存在的类型。以下是您正在使用的内容：

![在此处输入图像描述](../Images/c74edafee145bdd3512133d953355924.png)

如果你想要点元素，那么你引用它（就像你之后所做的那样）。如果您想用自己的标签重用类型（内容模型），那么您`apoint`的类型应该是`doubleList`.

重用类型并不少见，因为它是一种从实例 XML 中最大限度地“关闭”不需要的 XML 名称空间的方法（请参阅[威尼斯盲人创作风格](http://www.w3.org/2005/07/xml-schema-patterns.html#Naming)）。在您的情况下，您将获得一个无名称空间的 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T06:41:07.860

我试图实现的解决方案的最终工作示例如下：

XML:

```
<rss xmlns:georss="http://www.georss.org/georss">
    <georss:point>-41.295781753436 173.229502017379</georss:point>
</rss> 
```

XSD：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" xmlns:georss="http://www.georss.org/georss">
  <xs:import namespace="http://www.georss.org/georss" schemaLocation="georss.xsd"/>
  <xs:element name="rss">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="georss:point"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

关键是使用 'ref' 属性来引用导入的类型。

```
<xs:element ref="georss:point"/> 
```

# java - 赋值和 else if 语句

> ID：12774642
> 
> 赞同：0
> 
> 时间：2012-10-08T02:30:11.563
> 
> 标签：java

I am not to sure what the error is in my code but the order variable does not seem to initialise properly and hence my gui displays the wrong output, for example when cheese,tomato and chicken are selected it only displays Chicken with Tomato Tomato $12.75\. 任何帮助将不胜感激 ：）

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

class PizzaFrame extends JFrame 
{
// The following components are defined (but not created).
private JButton newButton, exitButton;
private JLabel priceLabel, grandTotalLabel;
private JCheckBox chkCheese, chkChicken, chkTomato;
private JTextArea jTA;

// Other values used throughout this frame
private double total, orderTotal, grandTotal;
private String order = "";
private static final String noOrder =  "Base price of basic pizza is $10.00";

// set up GUI
public PizzaFrame() 
{
    // Ensure there is a suitable title for the frame
    setTitle("Welcome to Mylo's Pizza world, please make an order");
    setLayout(new FlowLayout());

    // Create the buttons for the user to click, and add them to the frame
    newButton = new JButton("New Order");
    exitButton = new JButton("Exit \t \n");
    add(newButton);
    add(exitButton);

    // Create the Check Boxes and add these to the frame.
    chkCheese = new JCheckBox("Cheese");
    chkChicken = new JCheckBox("Chicken");
    chkTomato = new JCheckBox("Tomato");
    add(chkCheese);
    add(chkChicken);
    add(chkTomato);

    priceLabel = new JLabel(noOrder);
    add(priceLabel);

    // Create the TextArea in which to display the progressive orders.
    jTA = new JTextArea(10,10);
    //JScrollPane scroller = new JScrollPane(jTA);
    //jTA.setLineWrap(true);
    //scroller.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
    //scroller.setVerticalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
    add(jTA);
    //add(scroller);

    // Create the lower Label which displays the       
    grandTotalLabel = new JLabel("Startup - No orders taken yet. Total: $0");
    add(grandTotalLabel);

    ButtonHandler event_handler = new ButtonHandler();
    newButton.addActionListener(event_handler);
    exitButton.addActionListener(event_handler);

    // create and register listeners for the JCheckBoxes
    CheckBoxHandler box_listener = new CheckBoxHandler();
    chkCheese.addItemListener(box_listener);
    chkChicken.addItemListener(box_listener);
    chkTomato.addItemListener(box_listener);

    //set the size of the frame
    setSize( 250, 310 );

} 

private class ButtonHandler implements ActionListener 
{
    // start new order or exit on button event
    public void actionPerformed( ActionEvent event ) 
    {
        orderTotal = total;
        grandTotal += orderTotal;
        //boolean action = false;
        if (event.getSource() == newButton) 
        {
            // TO BE COMPLETED
            order = "";
            chkCheese.setSelected (false);
            chkChicken.setSelected(false);
            chkTomato.setSelected(false);
            //String order_total = Double.toString(orderTotal);
            jTA.append(order + " $" + Double.toString(orderTotal) + "\n");

        }
        else if (event.getSource() == exitButton) 
        {
            System.exit(0);
        }
    } 
} 

private class CheckBoxHandler implements ItemListener 
{
    static final double CHEESE_COST = 2.75;
    static final double CHICKEN_COST = 4.00;
    static final double TOMATO_COST = 0.50;

// respond to checkbox events by adding cost of pizza topping options to price
    public void itemStateChanged( ItemEvent event )
    {
            total = 10.00;
            // TO BE COMPLETED
            String selection = "";
            if (chkCheese.isSelected()) 
                total = total + CHEESE_COST;
            else if (chkChicken.isSelected()) 
                total = total + CHICKEN_COST;
            else if (chkTomato.isSelected()) 
                total = total + TOMATO_COST;

            if (chkCheese.isSelected() && chkChicken.isSelected() && chkTomato.isSelected()) 
            {
                selection = "Cheese with Chicken and Tomato ";
                order += selection;
            }
            else if(chkCheese.isSelected() && chkChicken.isSelected() && chkTomato.isSelected())
            {
                      //else
                          order += "Cheese with Chicken ";
            }
            else if(chkCheese.isSelected() && chkTomato.isSelected())
            {
                    //if (chkTomato.isSelected()) 
                        order += "Cheese with Tomato ";
            }

            else if (chkChicken.isSelected() && chkTomato.isSelected())
            {
                  //if (chkTomato.isSelected()) 
                      order += "Chicken with Tomato ";
            }
            else if(chkCheese.isSelected())
            {
                        order += "Cheese ";     
            }
            else if (chkChicken.isSelected())
            {
                      order += "Chicken ";
            }
            else if (chkTomato.isSelected())
            {
                      order += "Tomato ";
            }

        priceLabel.setText("Price of pizza is: $" +  Double.toString(total));
        grandTotalLabel.setText("Total income is: $" +  Double.toString(grandTotal));

    } 
} 

//----------------------------------------- Program Entry/Start point:

public static void main( String args[] ) 
{
    PizzaFrame pFrame = new PizzaFrame();
    pFrame.addWindowListener ( 

                                  // TO BE COMPLETED
            new WindowAdapter() 
            {   
                public void windowClosing (WindowEvent e) 
                {
                            System.exit(0); 
                }            
            }   

    );                          

    // Show the pizza frame ...
    pFrame.setVisible( true );
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:38:54.733

否则，如果满足条件，则退出。您希望价格是所有选定项目的总和，而不仅仅是第一个选定项目。您的文本显示条件也有一个小错误。

```
public void itemStateChanged( ItemEvent event )
    {
            total = 10.00;
            // TO BE COMPLETED
            String selection = "";
            if (chkCheese.isSelected()) 
                total = total + CHEESE_COST;
            if (chkChicken.isSelected()) 
                total = total + CHICKEN_COST;
            if (chkTomato.isSelected()) 
                total = total + TOMATO_COST;

            if (chkCheese.isSelected() && chkChicken.isSelected() && chkTomato.isSelected()) 
            {
                selection = "Cheese with Chicken and Tomato ";
                order += selection;
            }
            else if(chkCheese.isSelected() && chkChicken.isSelected())
            {
                          order += "Cheese with Chicken ";
            }
            else if(chkCheese.isSelected() && chkTomato.isSelected())
            { 
                        order += "Cheese with Tomato ";
            }

            else if (chkChicken.isSelected() && chkTomato.isSelected())
            {
                      order += "Chicken with Tomato ";
            }
            else if(chkCheese.isSelected())
            {
                        order += "Cheese ";     
            }
            else if (chkChicken.isSelected())
            {
                      order += "Chicken ";
            }
            else if (chkTomato.isSelected())
            {
                      order += "Tomato ";
            }

        priceLabel.setText("Price of pizza is: $" +  Double.toString(total));
        grandTotalLabel.setText("Total income is: $" +  Double.toString(grandTotal));

    } 
```

# php - PHP 递归目录迭代器

> ID：12774647
> 
> 赞同：2
> 
> 时间：2012-10-08T02:30:46.840
> 
> 标签：php, spl

所以我想显示整个目录和子目录。

根据 PHP 文档，

**RecursiveDirectoryIterator 提供了一个用于递归迭代文件系统目录的接口**

这是我的代码：

```
$it = new RecursiveDirectoryIterator("c:\php_win");

foreach ($it as $dir) {
    var_dump($dir->getFilename());
} 
```

以上代码只显示了一级目录，没有显示所有子目录。

我知道我必须使用 RecursiveIteratorIterator 来获取所有子目录，但我只是不知道为什么我需要使用 RecursiveIteratorIterator 迭代器。

“**递归地遍历文件系统目录**”是什么意思？任何可以解释为什么我们需要 IteratorIterator 的 Web 链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T02:36:19.043

`RecursiveDirectoryIterator`是一个实现`RecursiveIterator`接口的类。

`RecursiveIteratorIterator`是一个实现`Iterator`接口的类。

通过`foreach`遍历它，它将获取一个对象实现`RecursiveIterator`并对其进行递归遍历（树遍历），在 PHP 中不仅是倒带、获取当前、前进下一步和检查有效性*，而且还*检查子节点是否存在，然后在内部迭代这些孩子也是。

![RecursiveIteratorIterator 和 RecursiveDirectoryIterator 图](../Images/282ec160d2b66be48f59e680df50a4aa.png)

因此，`RecursiveIteratorItertor`它以线性顺序提供对象遍历，*同时*在具体实现上执行树遍历`RecursiveIterator`。

所以`RecursiveDirectoryIterator`是唯一的容器。您可以立即对其进行迭代（例如使用 foreach），但是线性顺序对象迭代不会进行树遍历。

这就是为什么`RecursiveIteratorIterator`存在，它提供了树遍历。

这正是你的情况：直接迭代`RecursiveDirectoryIterator`只进行线性对象遍历。只有`RecursiveIteratorIterator`知道如何对实现`RecursiveIterator`接口的对象进行树遍历。由于它实现了`Iterator`接口本身，因此可以在树遍历上进行线性对象遍历。

另请参阅我[*对 RecursiveIteratorIterator How dos RecursiveIteratorIterator works in php*](https://stackoverflow.com/a/12236744/367456)[的回答](https://stackoverflow.com/a/12236744/367456)*，它涵盖了目录迭代器示例，以显示可能的不同树遍历模式。*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T11:09:36.620

我已经将一个类`RecursiveDirectoryIterator`（

[https://gist.github.com/jonataswalker/3c0c6b26eabb2e36bc90](https://gist.github.com/jonataswalker/3c0c6b26eabb2e36bc90)

和输出的树查看器

[http://codebeautify.org/jsonviewer/067c13](http://codebeautify.org/jsonviewer/067c13)*

# mysql - 在视图中忽略 Where 子句

> ID：12774648
> 
> 赞同：0
> 
> 时间：2012-10-08T02:31:03.980
> 
> 标签：mysql, sql, view

考虑一个表和同一个表的视图。

```
CREATE TABLE t (a VARCHAR(10), b VARCHAR(10), c VARCHAR(10)) 
```

我有一个针对带有两个 where 子句的表运行的查询。

```
SELECT * FROM t WHERE b = "foo" AND c="bar" 
```

我想创建视图，以便可以使用相同的查询，但忽略两个 where 子句之一。

这可能吗（我怀疑不是）？

喜欢

```
CREATE VIEW v AS SELECT a, b, [whatever is asked for in the query] AS c FROM t; 
```

（原因是不能修改查询而不是创建一个新视图。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T02:59:42.293

由于数据库视图只能用于定义投影和从一个或多个表中检索投影的条件，因此您不能在视图定义中包含仅选择项目的某些部分或仅选择某些过滤器的条件逻辑。这些只能在视图定义之上指定，例如

```
SELECT <subset of projection> from <VIEW> 
```

或者

```
SELECT * FROM <VIEW> WHERE <more filters> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:02:25.997

我认为您自己给出了唯一的解决方案。如果您知道 WHERE 子句中要求的内容，您可以查看该条件始终为真的情况：

```
CREATE VIEW v AS
SELECT a, b, "bar" AS c FROM t; 
```

如果值`c`是有限的，你可以摆脱这样的事情：

```
CREATE VIEW v AS
SELECT a, b, "bar" AS c FROM t;
UNION
SELECT a, b, "bar1" AS c FROM t;
UNION
SELECT a, b, "barsomething" AS c FROM t; 
```

# python - 如何使用方法有条件地覆盖 Python 类属性

> ID：12774650
> 
> 赞同：2
> 
> 时间：2012-10-08T02:31:07.057
> 
> 标签：python, class

是否可以使用属性方法有条件地覆盖类属性？

如果我有这个类，我可以通过传入一个字典来实例化：

```
def Foo(Object):
    def __init__(self, **kwargs):
        self.__dict__.update(kwargs)

    # pseudo code (this doesn't work)
    if not self.bar:
        @property
        def bar(self):
            return u"I have overridden foo's bar" 
```

我创建了这个实例并设置`bar`为`''`or `None`：

```
my_foo = Foo(**{'bar':u''}) 
```

然后我调用该`bar`属性：

```
my_foo.bar 
```

并得到

```
u"I have overridden foo's bar" 
```

我希望`bar`返回属性方法，而不是`bar`创建对象时传入的值。

我能以某种方式做到这一点吗？任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T05:55:39.113

要覆盖一个属性，您必须对类而不是实例进行操作，因为它们在实例上的机器在`__dict__`查找之前被调用，并且最终得到`AttributeError`s。相反，您可以在类上设置不同的属性。

但要做到这一点，您要么必须在每次创建实例时修改类（我敢打赌你不想要），要么必须动态生成新类。

例如：

```
class Foo(object):
    def __init__(self, val):
        self._val = val
    @property
    def val(self):
        return self._val

class SubType(Foo):
    def __new__(cls, val):
        if val % 2:
            #random condition to change the property
            subtype = type('SubFoo', (SubType,),
                           {'val': property((lambda self: self._val + 1))})
                return object.__new__(subtype)
            else:
                return object.__new__(cls) 
```

结果是：

```
>>> d = SubType(3)  #property changed
>>> d.val
4
>>> f = SubType(2)  #same property as super class
>>> f.val
2 
```

我不太喜欢这种黑客行为。可能更简单的方法是调用计算属性值的私有方法，例如：

```
class Foo(object):
    def __init__(self, val):
        self._val = val
    def _compute_val(self):
        return self._val
    @property
    def val(self):
        return self._compute_val()

class SubFoo(Foo):
    def _compute_val(self):
        if self._val % 2:
                return self._val + 1
        else:
                return self._val 
```

产生与以前相同的结果：

```
>>> d = SubFoo(3)
>>> d.val
4
>>> f = SubFoo(2)
>>> f.val
2 
```

我相信这个技巧可以被视为模板方法设计模式的应用，即使它应用于属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:44:08.223

Python 属性不能被覆盖，因为这样做会引发`AttributeError`. 但是，您可以尝试存储覆盖值，然后在执行属性时查找它们：

```
def overridable(of):
    def nf(self):
        if hasattr(self, "_overrides") and of.__name__ in self._overrides:
            return self._overrides[of.__name__]
        return of(self)
    return nf

class Foo(object):
    _overrides = {}

    def __init__(self, **kwargs):
        for k, v in kwargs.iteritems():
            try:
                setattr(self, k, v)
            except AttributeError:
                self._overrides[k] = v

    @property
    @overridable
    def bar(self):
        return u'I have overridden foo\'s bar'

my_foo = Foo(bar=3)
print my_foo.bar 
```

# iphone - 在 NSUserDefaults 中保存 NSMutableArray

> ID：12774656
> 
> 赞同：0
> 
> 时间：2012-10-08T02:32:04.983
> 
> 标签：iphone, objective-c, ios

在下面的 my 和 successBlock 中，我将其保存`info`到我的`NSMutableArray` `selectedPhotos`. 顺便说一句，这`info`是一个`ALAsset url`. 我的相机胶卷中的 URL。

```
 } andSuccessBlock:^(NSArray *info) 
            [self.selectedPhotos setArray:info]; 
```

我需要做的是通过`NSUserDefaults`. 这是我保存它的方法`NSUserDefaults`：

```
 [[NSUserDefaults standardUserDefaults] setObject:self.selectedPhotos forKey:@"PickedImage"];
            self.selectedPhotos = [[NSUserDefaults standardUserDefaults] objectForKey:@"PickedImage"];
            [[NSUserDefaults standardUserDefaults] synchronize];
            NSLog(@"SelectedPhotos:: %@", self.selectedPhotos); 
```

但问题是，当我记录它时，它说`NULL`. 如何通过`NSUserDefaults`. 谢谢您的帮助。

日志：

```
SelectedPhotos:: (null)
*** -[NSUserDefaults setObject:forKey:]: Attempt to insert non-property value '(
    "ALAsset - Type:Photo, URLs:assets-library://asset/asset.JPG?id=119A0D2D-C267-4B69-A200-59890B2B0FE5&ext=JPG",
    "ALAsset - Type:Photo, URLs:assets-library://asset/asset.JPG?id=92A7A24F-D54B-496E-B250-542BBE37BE8C&ext=JPG",
    "ALAsset - Type:Photo, URLs:assets-library://asset/asset.JPG?id=77AC7205-68E6-4062-B80C-FC288DF96F24&ext=JPG" )' of class '__NSArrayM'.  Note that dictionaries and arrays in property lists must also contain only property values. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:41:26.327

看看你得到的日志：

> 请注意，属性列表中的字典和数组也必须只包含属性值。

An`ALAsset`对存储在 中无效`NSUserDefaults`。只有`NSString`, `NSNumber`, `NSData`, `NSDate`, `NSArray`, 和`NSDictionary`可以存储在那里。

您必须弄清楚要存储资产中的哪些数据，并将其存储起来。我怀疑 URL 是您真正有兴趣存储的全部内容，但在不知道您打算如何处理数据的情况下，我无法确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:33:31.583

要将 NSMutableArray 保存`ALAsset`到 NSUserDefaults 中，您需要将其转换为 NSData 并保存。看一看：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
NSData *arrayData = [NSKeyedArchiver archivedDataWithRootObject:self.selectedPhotos];
[userDefaults setObject:arrayData forKey:@"selectedPhotos"]; 
```

要记录（和阅读）它，您需要简单地：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
NSData *arrayData = [defaults objectForKey:@"selectedPhotos"];
NSLog(@"%@", [NSKeyedUnarchiver unarchiveObjectWithData:data]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T05:51:16.900

- 存档后尝试保存（即转换为 NSData）。请查看以下答案[Why NSUserDefaults failed to save NSMutableDictionary in iPhone SDK?](https://stackoverflow.com/questions/471830/why-nsuserdefaults-failed-to-save-nsmutabledictionary-in-iphone-sdk)

# postgresql - 如何将oracle数据迁移到postgres？

> ID：12774659
> 
> 赞同：1
> 
> 时间：2012-10-08T02:32:27.317
> 
> 标签：postgresql

我有一个 oracle 数据库，其中包含我必须迁移到 postgreSQL 的大约 2TB 数据。我正在学习 pgsql 和 pgloader 的 onCOPY 命令。

问题是....

1.  复制命令具有分隔符选项，该选项指定分隔文件每一行（行）内的列的字符。根据手册，这必须是单个单字节字符。如果我需要辅助分隔符怎么办（比如包含在 oracle 的选项中）？

2.  [http://pgloader.projects.postgresql.org] 自 2010 年 4 月以来没有更新......所以我不认为这是推荐的方式......

我还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T06:16:11.427

I think You should write some program in any lang or use [http://www.enterprisedb.com/solutions/oracle-migration-assessment](http://www.enterprisedb.com/solutions/oracle-migration-assessment)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T04:46:10.447

几点。首先，您可以将 COPY 与 CSV 格式一起使用，例如，如果您担心逗号的处理，您可以复制为 CSV 并让引用规则来处理。无论如何，CSV 作为一种数据导出格式得到了广泛的支持，因此这可能是处理这种情况的最佳方式。

其次，如果需要，您的定界符可以用反斜杠转义。

# nutch - Nutch : 当前 URL 的锚文本

> ID：12774660
> 
> 赞同：1
> 
> 时间：2012-10-08T02:32:32.713
> 
> 标签：nutch, web-crawler

在索引过滤器中，有没有办法找出当前 URL/文档源自的锚文本？我尝试了链接，但这似乎是空的。

```
public NutchDocument filter(NutchDocument doc, Parse parse, Text url, CrawlDatum datum,          Inlinks inlinks) IndexingException {

    //Need to know the anchor text from which the current document originated from at this  point

} 
```

如果当前 URL 是[http://foo.com/pagex ，则必须在](http://foo.com/pagex)[http://foo.com](http://foo.com)找到指向 pagex 的链接。我需要知道这个链接的锚文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-02T06:41:06.010

锚文本可以在链接中找到，但是要填充它，两者`db.ignore.internal.links`都`linkdb.ignore.external.links`必须设置为`false`in `nutch-default.xml`。或者，它们可以在`nutch-site.xml`.

# javafx-2 - 是否有任何工具可以通过解析表的 FXML 描述文件来生成表数据模型的 java 代码？

> ID：12774664
> 
> 赞同：0
> 
> 时间：2012-10-08T02:33:16.317
> 
> 标签：javafx-2, datamodel

我知道如何创建描述表格的 FXML 文件。同时，根据[Oracle 教程](http://docs.oracle.com/javafx/2/fxml_get_started/fxml_tutorial_intermediate.htm#CACFEHBI)，实现一个定义数据模型并提供方法和字段以进一步处理表的类是最佳实践。

但是，键入代码相当麻烦且耗时。那么，是否有任何工具可以通过解析表的 FXML 描述文件来生成表数据模型的 java 代码？

问候，秦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T15:11:53.123

我不知道任何从 FXML 生成的 java，虽然它不会那么难构建。相反，您是否尝试过 PropertyValueFactory 类？您可以在 TableColumn 的 cellValueFactory 上设置它，并为其指定对象中 getter 的字符串名称。只需要一行代码即可设置，可能更容易吗？

请参阅[http://docs.oracle.com/javafx/2/api/javafx/scene/control/cell/PropertyValueFactory.html](http://docs.oracle.com/javafx/2/api/javafx/scene/control/cell/PropertyValueFactory.html)

# java - Java 7 - 堆栈图帧不一致 - 需要帮助了解解决方案为何有效

> ID：12774672
> 
> 赞同：5
> 
> 时间：2012-10-08T02:34:17.900
> 
> 标签：java, dependency-injection, guice, proguard, java-7

当我使用 JDK7 或 JDK6 在 Eclipse 中编译和运行我的项目时，一切都很好。但是，在我使用 ANT 构建它然后尝试使用系统 JDK7 运行它之后，我收到错误消息：

**方法 myClass.myMethod() [[Ljava/lang/Object; 中分支目标 25 处的堆栈图帧不一致；在偏移 14**

我到处找，在 StackOverFlow 上发现了几个很好的问题：

*   [Eclipse 中的 Java 7 JVM 验证错误](https://stackoverflow.com/questions/7970622/java-7-jvm-verifyerror-in-eclipse)
*   [Akka Actors 失败，VerifyError: Inconsistent stackmap frames at branch target](https://stackoverflow.com/questions/8079504/akka-actors-fails-verifyerror-inconsistent-stackmap-frames-at-branch-target)

*两者基本上都建议添加`-XX:-UseSplitVerifier`为确实解决了该问题的 JVM 选项。*我仍然不完全理解为什么，但显然[这个错误报告](https://bugs.eclipse.org/bugs/show_bug.cgi?id=353467)应该会有所帮助。可惜我还是没看懂……

我确实注意到有人在使用面向方面的编程的问题之一，这让我觉得我正在使用[Guice](http://code.google.com/p/google-guice/)（谷歌的 DI 框架），这可能会导致问题，但我不知道如何。假设支持JDK7。

我也在使用 Proguard，但这也应该适用于 JDK7。

无论如何，在这一点上，我不知道为什么这种解决方法有效，除了它基本上回退到以前的 JDK（在这种情况下是 JDK6）版本时，当代码的某些部分试图使用字节码时（这就是为什么我认为它与DI）代码有关。但我仍然无法建立正确的链接。而且我也可能会离开！

如果有人可以解释发生了什么或为什么会发生这种情况，我将非常感激。此外，我真的很讨厌不得不使用解决方法，因为这不是我认为的长期解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T00:51:21.563

从 Java 7 开始，编译后的字节码必须包含额外的 StackMapTable 属性。这些有助于 JVM 内部的验证器在类加载时检查类的构造是否正确。Java 的早期版本更加宽松，在没有属性的情况下使用较慢的验证。

修改原始编译字节码的工具（编译后的 ProGuard，执行前的 AOP 框架，......）需要与修改后的代码一致地更新属性。如果他们不这样做，您将收到错误消息“不一致的堆栈图帧”。

ProGuard 应执行此预验证罚款；我不知道它有任何问题。如果在没有应用 ProGuard 的情况下仍然看到错误，则问题一定出在 DI 或 AOP 上。

# jquery - 对于大型布局，哪个更快？CSS3 还是 jQuery？

> ID：12774674
> 
> 赞同：2
> 
> 时间：2012-10-08T02:34:59.820
> 
> 标签：jquery, css, css-transitions, css-animations

我的网站上有一个流畅的布局，一个元素动画并且在悬停时有一个过渡。主要问题是在更宽的屏幕上（例如，比大约 1600 像素宽），CSS3 悬停过渡变得明显不连贯，并开始吞噬内存。使用 jQuery 来实现这一点会使效果在更大的显示器上更快吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T04:23:41.207

**编辑：**查看这个[动画速度测试](http://www.greensock.com/js/speed.html)，它可以将[GreenSock Animation Platform](http://www.greensock.com/)的性能与少数其他能够动画的库（包括 jQuery）进行实时比较。TweenLite (GreenSock) 的性能实际上相当可观，尤其是与 Zepto 基于 CSS3 的动画相比。

--

在性能方面，CSS3 动画比 jQuery 动画快得多。（[来源](http://dev.opera.com/articles/view/css3-vs-jquery-animations/)）

> 性能上的巨大差异是因为浏览器的 CSS 处理器是用 C++ 编写的，并且本机代码执行速度非常快，而 jQuery (JavaScript) 是一种解释性语言，浏览器无法及时预测 JavaScript，就接下来会发生什么事件而言.

但是，正如文章中所说，jQuery 在浏览器兼容性方面要好得多，因为 IE<=9 不支持 CSS3 过渡

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T05:38:18.737

CSS3 要快得多。它使用本机浏览器动画而不是 javascript 计时器。CSS3 动画也可以进行 GPU 加速。

但它不是灵丹妙药，如果你的页面很慢，你需要优化它。Chrome 开发工具中的时间线选项卡很好地提示了导致缓慢的原因。您还可以在 chrome://flags 下启用“合成渲染层边框”。该选项显示哪个元素正在被 GPU 加速

您的悬停过渡可能会触发整个网站的 GPU 加速，从而导致速度变慢。如果是这样的话，一些放置得当的 z-index 可能会避免这个问题。

# java - 如何使用休眠更新 POJO 集

> ID：12774679
> 
> 赞同：0
> 
> 时间：2012-10-08T02:36:43.150
> 
> 标签：java, mysql, hibernate, netbeans-7

作为休眠新手，我使用的是 netbeans 7.2、Glassfish 3.x 和 mysql。从我的数据库模式中，我使用 hibernate.cfg.xml 和 hibernate.reveng.xml 来创建 POJO。Netbeans 中的选项是`Hibernate Mapping files and POJOs`.

我的问题是：在数据中添加了一个新表后，如何将其作为 POJO 引入？我尝试手动更新 hibernate.cfg.xml 和 hibernate.reveng.xml 并执行`clean and build`然后`run`，但这不起作用。

编辑以添加 HIBERNATE.CFG.XML

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
<session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/anims</property>
    <property name="hibernate.connection.username">mouser</property>
    <property name="hibernate.connection.password">my password</property>
    <property name="hibernate.show_sql">true</property>
    <property name="hibernate.current_session_context_class">thread</property>
    <property name="hibernate.query.factory_class">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</property>
    <!-- Names the annotated entity class -->
    <mapping class="ccvd.Photo"/>
    <mapping class="ccvd.Dogs"/>
    <mapping class="ccvd.Cats"/>
    <mapping class="ccvd.Birds"/>
      </session-factory> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:55:51.370

不确定，你做了什么。以下是基本步骤。

[hibernate 网站](http://docs.jboss.org/hibernate/orm/4.1/quickstart/en-US/html_single/)特别是[第 2 章](http://docs.jboss.org/hibernate/orm/4.1/quickstart/en-US/html/ch02.html)提到了一个很好的例子。

```
 1\. Create POJO class
   2\. Create entries in mapping config file
   3\. Get Hibernate Session through Hibernate Session Factory
   4\. Use session API methods to perform CRUD operation 
```

请注意：最近有使用`Annotation`基于实体类的趋势，这可以更好地简化流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:54:28.963

可能是您忘记在映射中添加资源

```
<mapping class="ccvd.Birds" resource="a/b/c.java"/> 
```

并且 a/b/c.java 是你在包中的类。替换为 / 并且整个条目表示类到文件的映射。

1小贴士，我强烈推荐使用注解。这样在开发中非常方便。只需在类文件上添加@entity，并在配置文件中添加搜索路径，一切就完成了！

享受 Java Web 开发的乐趣！

# javascript - 提取链接详细信息，例如 Google 和 Facebook

> ID：12774682
> 
> 赞同：0
> 
> 时间：2012-10-08T02:37:11.080
> 
> 标签：javascript, asp.net, html, facebook

我想提取 Facebook 和 Google 等链接详细信息。但问题是细节（如 manin 文本和图像）不确定。有时正文在 p 标签中，有时它是从元标签中提取的。那么有没有想过要搜索哪些地方？

```
 http://forums.asp.net/p/1847212/5162336.aspx/1?extract+certain+part+of+text+like+google+and+bing 
```

我将此链接粘贴到 facebook 中，它提取的详细文本位于 p 标签中，该标签位于另一个 p 标签下方，其中也有一个文本。那么如何决定呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:47:08.143

如果有问题的网站启用了[Open Graph 协议](http://ogp.me/)，那么您可以解析该标准定义的元数据。由于它与 Facebook 使用的系统相同（我相信 Google+），因此您可能会期望相当多的网站支持它。我不会 100% 依赖它，但它是一个不错的工具。

# html - 将 HTML 表格粘贴到 Excel 中，如何在单元格中保留换行符

> ID：12774684
> 
> 赞同：22
> 
> 时间：2012-10-08T02:37:58.180
> 
> 标签：html, excel, copy, paste

我有一个简单的html表格，例如只有一个单元格，但是当我复制dom节点并将其粘贴到excel中时，它将被识别为两行，如何使Excel获得正确的粘贴数据。

```
 <table><tr><td>1<br>2</td><tr></table> 
```

我尝试添加 css 样式

```
br {mso-data-placement:same-cell;}, 
```

但它只适用于IE。

注意，复制纯文本是不行的，我需要在单元格上添加颜色、字体信息。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-16T05:15:10.320

许多人可能知道，您可以将数据（例如报告）输出为 Excel 文件，只需添加正确的 content-type 和 content-disposition 标题：

```
Response.ContentType = “application/vnd.ms-excel“;

Response.AppendHeader(“content-disposition“, “inline; filename=report.xls“); 
```

如果客户端安装了 MS Excel，您的输出 HTML 页面将在其中打开，而不是 Web 浏览器。Excel 将解释所有格式（边框、字体等）和 TABLE 标签，这可以生成漂亮的格式化工作表，而无需使用重量级的服务器端控件。

我挣扎了一段时间的问题是多行单元格。我需要在单元格中换行，但是当我将`<br>`标签放入 HTML 输出时，Excel 将其解释为新行，而不是现有单元格中的换行符。

添加到样式表中：

```
br {mso-data-placement:same-cell;} 
```

然后它就像一个魅力。我希望它有用:)

提示：您可以使 ContentType 和 header 有条件，通过一个文件提供备用 HTML/XLS 报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T11:25:28.653

看起来 Firefox 完全忽略了**mso-data-placement**指令；它不会出现在 Firebug 样式面板中。也许这就是为什么它不会像您期望的那样粘贴？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T17:38:49.607

使用带有以下代码的宏怎么样？

• `TransformingPaste1()`：但是，这在我的机器上失败了（仍然是多个单元格）

*   获取剪贴板文本
*   使用粘贴转换后的版本`mso-data-placement:same-cell`
*   恢复原始剪贴板文本

• `TransformingPaste2()`：在我的机器上粘贴到单个单元格中，保留格式等，但结果是空格而不是换行符，因为您仍在粘贴 HTML

*   获取剪贴板文本
*   使用粘贴转换后的版本`vbCrLf`
*   恢复原始剪贴板文本

• `TransformingPaste3()`：在我的机器上粘贴到单个单元格中，带有换行符，但会丢失格式等（当前实现） - 请参阅带有链接的注释！

*   获取剪贴板文本
*   使用自定义标记粘贴转换后的版本
*   恢复原始剪贴板文本
*   对单元格进行后处理，用换行符替换标记——可能会得到改进……</li>

修改为最适合您需要的内容，例如使用正则表达式执行替换，但我希望这能让您上路：]

```
Function GetClipboardText() As String
    Dim BufObj As MSForms.DataObject
    Set BufObj = New MSForms.DataObject
    BufObj.GetFromClipboard
    GetClipboardText = BufObj.GetText
End Function

Function SetClipboardText(ByRef text As String)
    Dim BufObj As MSForms.DataObject
    Set BufObj = New MSForms.DataObject
    BufObj.SetText text
    BufObj.PutInClipboard
End Function

Function PreProcess(ByRef text As String, ByRef find As String, ByRef replace As String) As String
    PreProcess = Application.WorksheetFunction.Substitute(text, find, replace)
End Function

Function PostProcess(ByRef find As String, ByRef replace As String)
    Dim rCell As range
    For Each rCell In Selection
        'TODO: e.g. combine with answers from http://stackoverflow.com/questions/2192730/merge-contents-of-2-excel-cells-keeping-character-format-intact-using-vba
        rCell.Formula = Application.WorksheetFunction.Substitute(rCell.Formula, find, replace)
    Next
End Function

Sub TransformingPaste1()
    Dim OrigText As String
    Dim TempToken As String
    Dim PasteText As String
    Dim sSelAdd As String
    OrigText = GetClipboardText
    PasteText = PreProcess(OrigText, "<html>", "<html><style>br{mso-data-placement:same-cell;}</style>")
    SetClipboardText PasteText
    'Selection.PasteSpecial "Unicode Text"
    ActiveSheet.Paste
    SetClipboardText OrigText
    Application.CutCopyMode = False
End Sub

Sub TransformingPaste2()
    Dim OrigText As String
    Dim TempToken As String
    Dim PasteText As String
    Dim sSelAdd As String
    OrigText = GetClipboardText
    PasteText = PreProcess(OrigText, "<br>", vbCrLf)
    SetClipboardText PasteText
    ActiveSheet.Paste
    SetClipboardText OrigText
    Application.CutCopyMode = False
End Sub

Sub TransformingPaste3()
    Dim OrigText As String
    Dim TempToken As String
    Dim PasteText As String
    Dim sSelAdd As String
    OrigText = GetClipboardText
    TempToken = "#mybr#"
    PasteText = PreProcess(OrigText, "<br>", TempToken)
    SetClipboardText PasteText
    ActiveSheet.Paste
    SetClipboardText OrigText
    PostProcess TempToken, vbLf
    Application.CutCopyMode = False
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-21T02:56:43.640

我通常会遇到这个问题，因为我必须从一个站点下载 excel 文件，这些文件实际上是用 xls 扩展名包装在 table 标记中的 html 文件，无论 br 标记在单元格中的何处，都会创建一个新行。所以，我创建了一个小 vbscript 用逗号替换 br 标签，然后我在 excel 中打开文件。它对我很有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-18T10:08:31.707

如果您确实需要进行复制粘贴，最好在复制数据之前在 Excel 工作表中编辑“单元格属性”。右键单击excel中的列名，然后选择单元格属性。对您的数据进行适用的更改并保存。现在您可以复制您的数据并希望它在 MS-Excel 中被正确解释。不过，我还没有将它用于 HTML 内容。

# c++ - 带有 __attribute__ 的 C++ 结构代码

> ID：12774689
> 
> 赞同：2
> 
> 时间：2012-10-08T02:39:09.113
> 
> 标签：c++, attributes, struct

这段 C++ 代码有什么作用？怎么`__attribute__`会有？

```
struct foo { double t[4] __attribute__((aligned(64))); }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T02:42:06.357

来自[http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Type-Attributes.html](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Type-Attributes.html)：

> `aligned (alignment)`
> 
> 此属性为指定类型的变量指定最小对齐方式（以字节为单位）。例如，声明：
> 
> ```
>  struct S { short f[3]; } __attribute__ ((aligned (8)));
>          typedef int more_aligned_int __attribute__ ((aligned (8))); 
> ```
> 
> 强制编译器确保（尽可能）类型为 struct S 或 more_aligned_int 的每个变量将被分配并至少在 8 字节边界上对齐。在 SPARC 上，将 struct S 类型的所有变量对齐到 8 字节边界允许编译器在将 struct S 类型的一个变量复制到另一个变量时使用 ldd 和 std（双字加载和存储）指令，从而提高运行时效率.
> 
> 请注意，ISO C 标准要求任何给定结构或联合类型的对齐至少是相关结构或联合的所有成员的对齐的最小公倍数的完美倍数。这意味着您可以通过将对齐属性附加到此类类型的任何一个成员来有效地调整结构或联合类型的对齐方式，但是上面示例中说明的符号是一种更明显、直观和易读的方式请求编译器调整整个结构或联合类型的对齐方式。

因此，有问题的代码有效地要求编译器`t`在 64 字节边界上对齐（通常，它会在 8 字节边界上对齐，因为它是 的数组`double`）。

# c++ - 删除多个元素时出错。删除方法。单链表

> ID：12774691
> 
> 赞同：0
> 
> 时间：2012-10-08T02:39:22.913
> 
> 标签：c++, segmentation-fault, singly-linked-list, delete-method

我（在一点帮助下）用 C++ 制作了一个单链表，它将输入的元素从最小到最大排序。我想从同一个值中删除几个元素，但是当代码似乎删除更多时，我使用的 Delete 方法似乎只能删除一个。我尝试使用一个调用 Delete 方法的循环来删除几个元素，当它删除一个元素时，它就变成了分段错误。我会很感激一些帮助。谢谢你。

```
void List::Append(float time, char type, int cell, long id) {

// Create a new node
Node* newNode = new Node();
newNode->SetTime(time);
newNode->SetType(type);
newNode->SetCell(cell);
newNode->SetId(id);
newNode->SetNext(NULL);

// Create a temp pointer
Node *tmp = head;

if ( tmp ) {
    if ( tmp->Time() < newNode->Time() ) {
        newNode->SetNext(tmp);
        head = newNode;
    }
    else {
        // Nodes already present in the list
        // Parse to end of list anytime the next data has lower value
        while ( tmp->Next() && tmp->Next()->Time() >= newNode->Time() ) {
            tmp = tmp->Next();
        }

        // Point the lower value node to the new node
        Node* _next = tmp->Next();
        tmp->SetNext(newNode);
        newNode->SetNext(_next);
    }
}
else {
    // First node in the list
    head = newNode;
} 
```

}

```
void List::Delete(long id) {

// Create a temp pointer
Node *tmp = head;

// No nodes
if ( tmp == NULL )
    return;

// Last node of the list
if ( tmp->Next() == NULL ) {
    delete tmp;
    head = NULL;
}
else {
    // Parse thru the nodes
    Node *prev;
    do {
        if ( tmp->Id() == id ) break;
        prev = tmp;
        tmp = tmp->Next();
    } while ( tmp != NULL );

    // Adjust the pointers
    prev->SetNext(tmp->Next());

    // Delete the current node
    delete tmp;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:32:13.097

在列表::删除代码中：

```
 if ( tmp->Id() == id ) break;<-------- 
```

如果您*break*，则 do{}while 循环结束。导致只有1个删除。

# c# - 防止此插入命令中的重复

> ID：12774694
> 
> 赞同：-4
> 
> 时间：2012-10-08T02:39:31.210
> 
> 标签：c#, validation, compare

```
private void Save_Click(object sender, EventArgs e)
{
    if (idTextBox.Text != "" & nameTextBox.Text != "")
    {
        conn.Open();
        cmd.CommandText = "insert into item_details (id, Name, MFD, EXP, QTY, damaged, MP, CP) values ('" + idTextBox.Text + "','" + nameTextBox.Text + "','" + MFDTextBox.Text + "','" + EXPTextBox.Text + "','" + QTYTextBox.Text + "','" + damagedTextBox.Text + "','" + MPTextBox.Text + "','" + CPTextBox.Text + "')";
        cmd.ExecuteNonQuery();
        cmd.Clone();
        MessageBox.Show("record inserted");
        conn.Close();
    }
    Admin_welcome newChild = new Admin_welcome();
    newChild.MdiParent = MdiParent;
    newChild.Show();
    this.Hide();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T02:47:15.480

在这里我想说几句，

首先，您需要设置考虑记录重复的标准 - 即重复名称或重复名称以及 MFD、到期等。完成后，您首先必须使用匹配条件进行选择查询，如果您发现匹配记录，您将插入重复项，因此不应插入并显示错误。

其次，你的代码容易出现sql注入。我建议您使用存储过程和 sqlparameters 来确保代码是安全的。您还可以在存储过程本身中嵌入检查重复项的过程。

# php - 未设置从数组中删除值的麻烦

> ID：12774695
> 
> 赞同：0
> 
> 时间：2012-10-08T02:40:38.927
> 
> 标签：php, mysql, arrays

我正在尝试使用 unset 从数组中删除值，但它无法正常工作

说我有以下数组

```
$array =
 [0]=>a
 [1]=>b
 [2]=>c 
```

这些项目显示在一个表格中，可以删除一个。假设我按下“b”的值。设置了一个隐藏值（在本例中为 $removeID），当我回显它时出现“b”，所以我知道该值正在正确发送。

无论如何，这是我的代码：

```
$removeID = $_POST['removeID']; //value to be removed. when echoe'd, it appears
$key = array_search($removeID,$array); //finds the key of the value
unset($array[$key]); 
```

有什么我做错了吗？它每次都会删除数组中最大的键。

**编辑 - 似乎没有正确找到密钥并设置为布尔值而不是整数**

我尝试了 gettype($key) 并显示为布尔值。当我回显 $removeID 时，它会显示我要从数组中删除的值，那么为什么在使用 array_search 时找不到它？我不能搜索变量吗？

# python - Django-Compressor 无法找到实际存在的文件

> ID：12774696
> 
> 赞同：6
> 
> 时间：2012-10-08T02:40:58.083
> 
> 标签：python, django, google-app-engine, django-compressor

我刚刚将 django-compressor 安装到我的项目中，并且收到以下错误消息。

> TemplateSyntaxError at / Caught UncompressableFileError while rendering: 'js/jquery-1.7.2.min.js' 无法在 COMPRESS_ROOT '/Users/taelimoh/Dropbox/gluwa-git/static' 或静态文件中找到。

当我尝试压缩 css 文件时也会发生这种情况。

当然，这些文件在那里，当我不尝试使用 django-compressor 压缩它们时它工作正常。

下面是我的模板

```
...
    {% compress js %}
        <!--Javascripts-->
        <!--Libraries-->
        <script type="text/javascript" src="/static/js/jquery-1.7.2.min.js"></script>
    {% endcompress %}
... 
```

这是我的 settings.py

```
COMPRESS_ENABLED = True

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
    'compressor.finders.CompressorFinder',
)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    'django.contrib.admindocs',
    'django.contrib.humanize',
    ##############################################
    'appconf',# required by django-compressor
    'versiontools',# required by django-compressor
    'compressor',#https://github.com/jezdez/django_compressor
    ...
) 
```

我正在使用谷歌应用引擎，我的 django 版本是 1.3。该问题是在我的开发服务器上产生的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-17T00:15:23.143

这可能有点晚了，但文档指出，`app.yaml`应用程序无法读取任何在您的静态处理程序中配置的文件。值得庆幸的是，还有一个开关可以让您的应用程序读取这些文件。你可以在[这里](https://developers.google.com/appengine/docs/python/config/appconfig?csw=1#application_readable_1)阅读。本质上，你会想要这样做

```
handlers:
- url: /static
- static_dir: staticfiles
- application_readable: true 
```

在你的`app.yaml`（注意`application_readable`）。我为此挣扎了一段时间，因为`os.path.exists`总是失败。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T05:10:54.630

GAE 应用程序对文件没有写入权限。如果 Django-compressor 试图将压缩文件写入文件系统，那将会失败。

# qt - 在 Ubuntu 下使用 Qt Creator 中的 QJson 库

> ID：12774697
> 
> 赞同：2
> 
> 时间：2012-10-08T02:41:07.747
> 
> 标签：qt, qt-creator, qjson

我正在尝试在 Qt Creator 中创建的应用程序中使用 QJson 库。操作系统为 Ubuntu 12.04 32 位。

我使用突触安装 libqjson0 (0.7.1-6)。该库安装在

```
/usr/lib/i386-linux-gnu/libqjson.so.0
/usr/lib/i386-linux-gnu/libqjson.so.0.7.1 
```

我试图通过右键单击我的项目并选择“添加库..”来将库添加到 Qt Creator。当我输入上面显示的 2 个路径中的任何一个时，文件名是红色的，表示它不正确。我创建了一个符号链接**libqjson.so**链接到 libqjson.so.0.7.1。我现在可以使用 /usr/lib/i386-linux-gnu/libqjson.so 路径添加库。

现在是菜鸟问题：在应用程序的顶部，我添加了#include <parser.h>。我得到一个错误'parser.h：没有这样的文件或目录。我在 /usr/libs/i386-linux-gnu 中搜索 parser.h 并没有返回任何结果。我需要在 parser.h 之前添加一些东西还是我错过了其他东西？

**编辑：** .pro 文件附在下面

```
#-------------------------------------------------
#
# Project created by QtCreator 2012-10-05T20:40:21
#
#-------------------------------------------------

QT       += core gui
QT       += network

TARGET = zf
TEMPLATE = app

SOURCES += main.cpp\
        zftest.cpp \
    api1_6.cpp

HEADERS  += zftest.h \
    api1_6.h

FORMS    += zftest.ui

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/qt4/plugins/crypto/release/ -lqca-ossl
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/qt4/plugins/crypto/debug/ -lqca-ossl
else:symbian: LIBS += -lqca-ossl
else:unix: LIBS += -L$$PWD/../../../../../../usr/lib/qt4/plugins/crypto/ -lqca-ossl

INCLUDEPATH += $$PWD/../../../../../../usr/lib/qt4/plugins/crypto
DEPENDPATH += $$PWD/../../../../../../usr/lib/qt4/plugins/crypto

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/release/ -lqca
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/debug/ -lqca
else:symbian: LIBS += -lqca
else:unix: LIBS += -L$$PWD/../../../../../../usr/lib/ -lqca

INCLUDEPATH += $$PWD/../../../../../../usr/include
DEPENDPATH += $$PWD/../../../../../../usr/include

OTHER_FILES += \
    README.txt

win32:CONFIG(release, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/i386-linux-gnu/release/ -lqjson
else:win32:CONFIG(debug, debug|release): LIBS += -L$$PWD/../../../../../../usr/lib/i386-linux-gnu/debug/ -lqjson
else:symbian: LIBS += -lqjson
else:unix: LIBS += -L$$PWD/../../../../../../usr/lib/i386-linux-gnu/ -lqjson

INCLUDEPATH += $$PWD/../../../../../../usr/lib/i386-linux-gnu
DEPENDPATH += $$PWD/../../../../../../usr/lib/i386-linux-gnu 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T07:22:33.293

您还需要**libjson-dev**包。基于 deb 的发行版通常在 *-dev 包中提供包含文件。

安装后，您会在 /usr/include/qjson 中找到 parser.h 和其他头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T07:21:50.740

您的 .pro 文件中缺少这些行：

```
INCLUDEPATH += folderwhereisinstalled/qjson/include

LIBS += -Lfolderwhereisinstalled/qjson/lib -lqjson 
```

# json - 使用 Jackson ACCEPT_SINGLE_VALUE_AS_ARRAY 从 String 反序列化 ArrayList

> ID：12774703
> 
> 赞同：9
> 
> 时间：2012-10-08T02:42:57.100
> 
> 标签：json, serialization, jackson

使用 Jackson 2 将数组反序列化为字符串的问题

[这与使用 Jackson 将 String 中](https://stackoverflow.com/questions/10247639/deserialize-arraylist-from-string-using-jackson/12716423#12716423)的 ArrayList 反序列化类似的问题

传入的 JSON（我无法控制）有一个元素“thelist”，它是一个数组。但是，有时这会以空字符串而不是数组的形式出现：

例如。而不是**"thelist" : [ ]**
它以**"thelist" : ""的形式出现**

我无法解析这两种情况。

工作正常的**“sample.json”**文件：

```
{
   "name" : "widget",
   "thelist" : 
    [
       {"height":"ht1","width":"wd1"}, 
       {"height":"ht2","width":"wd2"}
    ]
} 
```

课程：

```
public class Product { 
    private String name; 
    private List<Things> thelist; 
    // with normal getters and setters not shown
}

public class Things {
        String height;
        String width;
        // with normal getters and setters not shown
} 
```

工作正常的代码：

```
import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;

public class Test2 {
 public static void main(String[] args) 
    {
        ObjectMapper mapper = new ObjectMapper(); 
        Product product = mapper.readValue( new File("sample.json"), Product.class);
    }
} 
```

但是，当 JSON 有一个空字符串而不是一个数组时，即。**“thelist”：“”**
我得到这个错误：

```
com.fasterxml.jackson.databind.JsonMappingException: Can not instantiate value of type [collection type; class java.util.ArrayList, contains [simple type, class com.test.Things]] from JSON String; no single-String constructor/factory method (through reference chain: com.test.Product["thelist"]) 
```

如果我添加这一行（这适用于 Ryan 在[Deserialize ArrayList from String using Jackson](https://stackoverflow.com/questions/10247639/deserialize-arraylist-from-string-using-jackson/12716423#12716423)并且似乎受到文档的支持），

```
mapper.configure(DeserializationFeature.ACCEPT_SINGLE_VALUE_AS_ARRAY, true); 
```

没什么区别。

**还有其他设置，还是我需要编写自定义反序列化器？**
如果是后者，是否有使用 Jackson 2.0.4 执行此操作的简单示例？
我是杰克逊的新手（也是第一次发帖，所以要温柔）。我做了很多搜索，但找不到一个好的工作示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T20:47:02.833

问题是虽然单元素到数组有效，但您仍在尝试从（空）字符串转换为对象。我假设这是您面临的问题，尽管很难说无一例外。

但也有`DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT`可能与第一个功能相结合的技巧。如果是这样，您将获得一个`List`带有单个“空对象”的 a，这意味着`Things`没有值的实例。

现在理想情况下应该发生的是，如果你只启用`ACCEPT_EMPTY_STRING_AS_NULL_OBJECT`了，那可能会做你想做的事：`thelist`属性的空值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-11T15:37:04.473

嗨，当我得到这样的对象时，我正在解决类似的问题

```
{  
   "name" : "objectname",
   "param" : {"height":"ht1","width":"wd1"}, 
} 
```

来自外部系统，所以“参数”对我来说是我试图反序列化的对象。当此对象在外部系统中定义时，它可以正常工作。但是当外部系统中的对象“参数”未定义时，我得到空数组而不是空对象

```
{  
   "name" : "objectname",
   "param" : [], 
} 
```

这会导致映射异常。[我通过创建自定义 json 反序列化器来解决它，这里](https://stackoverflow.com/questions/11376304/right-way-to-write-json-deserializer-in-spring-or-extend-it)有很好的例子，对于测试类型，我使用了类似的东西

```
 ObjectCodec oc = jsonParser.getCodec();
    JsonNode node = oc.readTree(jsonParser);
    if (JsonNodeType.OBJECT == node.getNodeType()) {
        ParamObject result = new ParamObject();
        result.setHeight(node.get("height").asText());
        result.setWidth(node.get("width").asText());
        return result;
    }
    // object in MailChimp is not defined
    return null; 
```

# mysql - MySQL的alter table查询非常慢

> ID：12774709
> 
> 赞同：64
> 
> 时间：2012-10-08T02:44:06.977
> 
> 标签：mysql, sql, alter-table

为什么简单地更新此表以添加一列需要一个多小时？该表有 15M 行。它有 2 个索引和一个单键主键。ALTER TABLE 查询现在已经处于“复制到 tmp 表”状态 1 小时 15 分钟。

```
ALTER TABLE `frugg`.`item_catalog_map` 
ADD COLUMN `conversion_url` TEXT NULL DEFAULT NULL 
```

桌子：

```
mysql> describe item_catalog_map;
+------------------------+---------------+------+-----+---------+-------+
| Field                  | Type          | Null | Key | Default | Extra |
+------------------------+---------------+------+-----+---------+-------+
| catalog_unique_item_id | varchar(255)  | NO   | PRI | NULL    |       |
| catalog_id             | int(11)       | YES  | MUL | NULL    |       |
| item_id                | int(11)       | YES  | MUL | NULL    |       |
| price                  | decimal(10,2) | YES  |     | 0.00    |       |
+------------------------+---------------+------+-----+---------+-------+

mysql> show index from item_catalog_map;
+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+
| Table            | Non_unique | Key_name             | Seq_in_index | Column_name            | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+
| item_catalog_map |          0 | PRIMARY              |            1 | catalog_unique_item_id | A         |    15485115 |     NULL | NULL   |      | BTREE      |         |
| item_catalog_map |          1 | IDX_ACD6184FCC3C66FC |            1 | catalog_id             | A         |          18 |     NULL | NULL   | YES  | BTREE      |         |
| item_catalog_map |          1 | IDX_ACD6184F126F525E |            1 | item_id                | A         |    15485115 |     NULL | NULL   | YES  | BTREE      |         |
+------------------+------------+----------------------+--------------+------------------------+-----------+-------------+----------+--------+------+------------+---------+ 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-10-08T02:58:10.470

MySQL 的 ALTER TABLE 性能可能会成为非常大的表的问题。MySQL 通过创建具有所需新结构的空表、将旧表中的所有数据插入新表并删除旧表来执行大多数更改。这可能需要很长时间，特别是如果您的内存不足且表很大并且有很多索引。许多人都曾经历过需要数小时或数天才能完成的 ALTER TABLE 操作。

无论如何，如果您需要继续使用 alter table，也许以下资源可以帮助您：

*   [https://www.percona.com/doc/percona-toolkit/2.2/pt-online-schema-change.html](https://www.percona.com/doc/percona-toolkit/2.2/pt-online-schema-change.html)
*   [https://github.com/soundcloud/lhm](https://github.com/soundcloud/lhm)
*   [https://githubengineering.com/gh-ost-github-s-online-migration-tool-for-mysql/](https://githubengineering.com/gh-ost-github-s-online-migration-tool-for-mysql/)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2016-02-22T21:26:32.597

如果您不关心停机时间，我的建议是使用三个单独的`ALTER TABLE`语句。第一条语句删除所有现有的二级索引。第二条语句应用所有与列相关的更改。最后一条语句将删除的二级索引添加回来并应用其他索引更改。

另外两个提示：

1.  在应用索引更改之前，请执行以下两条语句，并在完成索引更改后将值更改回 1。

    ```
    SET unique_checks=0;
    SET foreign_key_checks=0; 
    ```

2.  创建多个二级索引时，将它们放在一个`ALTER TABLE`语句中，而不是多个单独的`ALTER TABLE`语句中。

下图显示了性能差异。方法 1 是您的方法，方法 2 是我的方法。**与 50m 表的方法 1 相比，方法 2 大约需要 3.47% 的时间。**该解决方案仅适用于 MySQL (>=5.5) InnoDB 引擎。

![在此处输入图像描述](../Images/740e63b6d7d3f45fd9b1a05ba6e25fbd.png)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-09T23:00:08.300

为了最大限度地减少我要更改的大表的锁定，我执行以下操作：

*   基于现有表创建一个新的空表并更改这个新的空表。
*   对大表执行 mysqldump，使其在大表中的每条记录都有一个完整的插入语句（开关 -c 和 --skip-extended-insert）
*   将此 mysqldump 导入具有重命名为 large_table 的不同（空）数据库。
*   从另一个数据库中获取这个新重命名表的 mysqldump 并将其导入原始数据库
*   重命名原始数据库中的 large_table 和 large_table_new。

    ```
    mysql> create table DATABASE_NAME.LARGE_TABLE_NEW like DATABASE_NAME.LARGE_TABLE;
    mysql> alter table DATABASE_NAME.LARGE_TABLE_NEW add column NEW_COLUMN_NAME COL_DATA_TYPE(SIZE) default null;

    $ mysqldump -c --no-create-info --skip-extended-insert --no-create-db -u root -p DATABASE_NAME LARGE_TABLE > LARGE_TABLE.sql

    mysql> create table test.LARGE_TABLE like DATABASE_NAME.LARGE_TABLE;

    $ mysql -u root -p -D test < LARGE_TABLE.sql

    mysql> rename table test.LARGE_TABLE to test.LARGE_TABLE_NEW;

    $ mysqldump -c --no-create-info --skip-extended-insert --no-create-db -u root -p test LARGE_TABLE_NEW > LARGE_TABLE_NEW.sql

    $ mysql -u root -p -D DATABASE_NAME < LARGE_TABLE_NEW.sql

    mysql> rename table DATABASE_NAME.LARGE_TABLE to DATABASE_NAME.LARGE_TABLE_OLD, DATABASE_NAME.LARGE_TABLE_NEW to DATABASE_NAME.LARGE_TABLE; 
    ```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-08-15T12:46:58.717

Percona 工具是这些带有大桌子的东西的救星。

[http://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html](http://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html)

他们基本上：

1.  创建重复表
2.  创建触发器以同步表
3.  批量复制数据
4.  核实
5.  交换表

需要永远，但谁在乎，因为这意味着您可以在不停机的情况下更改列。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-10-08T02:51:55.760

您的表有 1500 万行，这很重要。ALTER TABLE 涉及复制表中的所有数据并重新创建索引。作为第一次测量，尝试在文件系统中复制数据文件（item_catalog_map.MYD，如果它是 MyISAM）并查看需要多长时间。这是 ALTER TABLE*至少*需要的时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-01-04T23:09:38.040

我遇到了同样的问题，我刚刚使用以下命令重新启动了 MySQL 服务：

`sudo service mysql restart`

在 Ubuntu 中，在此之后`ALTER TABLE`命令立即通过。

# java - Android：设置铃声，一切正常，但不响，无法播放

> ID：12774721
> 
> 赞同：2
> 
> 时间：2012-10-08T02:47:27.727
> 
> 标签：java, android, eclipse, playback, ringtone

我正在做我的第一个应用程序：我想放置一个按钮以将 .mp3 设置为铃声，一切正常，Logcat 一个 Eclipse 不会显示任何类型的错误，但是当我拨打电话时（在模拟器中和真正的手机）它没有声音！此外，当我转到“音乐”应用程序并尝试播放这些铃声（我在“最近添加”中找到它们）时，它会显示：“对不起，播放器不支持音频文件类型”。

我做错了什么？

这是我的代码：

```
 setringtone.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                        Toast msg = Toast.makeText(TonosSet.this, "Sound set as ringtone!", Toast.LENGTH_LONG);
                        msg.show();

                        File k = new File("/sdcard/media/ringtone", "song_file.mp3");
                        Uri mUri = Uri.parse("android.resource://com.app/"+R.raw.song_file);
                        ContentResolver mCr = getContentResolver();
                        AssetFileDescriptor soundFile;
                        try {
                            soundFile= mCr.openAssetFileDescriptor(mUri, "r");
                        } catch (FileNotFoundException e) {
                            soundFile=null;   
                        }

                        try {

                            InputStream ins = TonosSet.this .getResources().openRawResource (R.raw.song_file);
                                    byte[] buffer = new byte[ins.available()];
                                    ins.read(buffer);
                                    ins.close();
                                    String filename = Environment.getExternalStorageDirectory().toString()+File.separator+R.raw.song_file;
                                    FileOutputStream fos = new FileOutputStream(filename);
                                    fos.write(buffer);
                                    fos.close();
                        } catch (IOException io) {
                        }

                        ContentValues values = new ContentValues();  
                        values.put(MediaStore.MediaColumns.DATA, k.getAbsolutePath());  
                        values.put(MediaStore.MediaColumns.TITLE, "Name sound");  
                        values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/mp3");  
                        values.put(MediaStore.Audio.Media.ARTIST, "Artist");  
                        values.put(MediaStore.Audio.Media.IS_RINGTONE, true);  
                        values.put(MediaStore.Audio.Media.IS_NOTIFICATION, true);  
                        values.put(MediaStore.Audio.Media.IS_ALARM, true);  
                        values.put(MediaStore.Audio.Media.IS_MUSIC, false);  

                        //Insert it into the database  
                        Uri uri = MediaStore.Audio.Media.getContentUriForPath(k.getAbsolutePath());

                        getContentResolver().delete(uri, MediaStore.MediaColumns.DATA + "=\"" + k.getAbsolutePath() + "\"", null);

                        Uri newUri = getContentResolver().insert(uri, values);

                        RingtoneManager.setActualDefaultRingtoneUri(
                            TonosSet.this,
                            RingtoneManager.TYPE_NOTIFICATION,
                            newUri);

            }
            }); 
```

请帮帮我，我不知道该怎么办，我一直在寻找解决方案大约 5 个小时，但我不能 =(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T08:21:42.727

也许你应该看看下面的帖子，它似乎给出了与你不同的版本（关于 isNotification 和其他参数）。

[如何通过我的活动在 Android 中设置铃声？](https://stackoverflow.com/questions/1271777/how-to-set-ringtone-in-android-from-my-activity)

# wcf - 不使用 WIF 将 SAML 断言添加到 WCF 客户端

> ID：12774722
> 
> 赞同：0
> 
> 时间：2012-10-08T02:47:29.430
> 
> 标签：wcf, mono, wif, saml, claims-based-identity

我有一个 WCF 服务，它托管在一个 WebApp 内，它使用基于声明的身份验证通过 ACS 和 ADFS 对用户进行身份验证。

客户端在 Mono 上运行，因此我无法[使用 WIF 使其“正常工作”](https://stackoverflow.com/questions/3003330/in-a-wcf-client-how-can-i-add-saml-2-0-assertion-to-soap-header)。

[我可以使用此处描述的方法](http://bit.ly/Ux0RIu)请求断言（SAML 票证）。

是否有另一种方法可以将断言插入到 WCF 客户端的请求中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T06:25:14.657

Microsoft Solutions UK 的这篇文章提供了一种方法来做到这一点：

[http://blogs.msdn.com/b/mcsuksoldev/archive/2011/08/17/federated-security-how-to-setup-and-call-a-wcf-service-secured-by-adfs-2- 0.aspx](http://blogs.msdn.com/b/mcsuksoldev/archive/2011/08/17/federated-security-how-to-setup-and-call-a-wcf-service-secured-by-adfs-2-0.aspx)

# java - 使用自定义类在 hashmap 上调用 containsKey

> ID：12774723
> 
> 赞同：9
> 
> 时间：2012-10-08T02:47:36.713
> 
> 标签：java, hashmap

我有一个要放入哈希图中的 Color 类。我想调用`containsKey`hashmap 以确保对象是否已经存在于 hashmap 中

颜色类

```
public class Color {
  public String name;
  Color (String name) {this.name = name;}
  //getters setters for name 
} 
```

哈希映射

```
HashMap<Color, List<String>> m = new HashMap<Color, List<String>>();
Color c = new Color("red");
m.put(c, new ArrayList<String>());
Color c1 = new Color("red");
System.out.println(m.containsKey(c1)); //I'd like to return this as true 
```

既然`c1`已经`name`红了。我想`System.out`返回 true 因为地图中已经存在的键`c`, 有`name`红色

如何做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-08T02:48:29.763

您的自定义类`Color`应该覆盖`equals()`和`hashcode()`方法来实现您想要的。

当您使用自定义对象作为键`collections`并希望**使用 object 进行查找**时，您应该正确覆盖`equals()`和`hashcode()`方法。

**另请阅读：**

[在 Java 中覆盖 equals 和 hashCode](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java)

# c++ - 在 Windows 上部署 Qt 应用程序？

> ID：12774724
> 
> 赞同：3
> 
> 时间：2012-10-08T02:47:42.707
> 
> 标签：c++, windows, qt, mingw, qt-creator

我是 Qt 新手，不知道如何在 Windows 上部署一个简单的 Qt 应用程序。从 Qt Creator 内部运行时运行良好，但直接执行时不会运行。我安装了最新版本的 Qt SDK 并使用所有默认设置。

我已经阅读了几十个“如何做”指南，所有这些都提供了相互矛盾的信息，此外还有几十个论坛主题、博客文章和这里的问题。我根本找不到清楚解释如何在 Windows 上部署 Qt 应用程序的说明。

我尝试将我能找到的所有 DLL 放在应用程序目录中，但这不起作用。我也尝试过静态构建 Qt，但这也不起作用。

谁能帮我吗？

编辑：谢谢你们的回复。以下是一些附加信息：

我正在使用“Qt Creator 2.4.1，基于 Qt 4.7.4”

我在不同的文件中包含以下内容：

```
#include <QtGui/QApplication>
#include <QDebug>
#include <QTextEdit>
#include <QtGui>
#include <QNetworkAccessManager>
#include <QNetworkRequest>
#include "qthread.h"
#include "windows.h"
#include <QMessageBox> 
```

我正在使用 Qt 附带的默认编译器 MinGW。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T02:51:12.503

简单的解决方案是在您的部署中包含 Qt dll，将它们放在与可执行文件相同的位置。请注意，Qt 使用不同的 dll 进行发布和调试构建，因此不要意外部署调试构建。

使用静态库也是可行的。您的编辑表明您已经尝试了静态和同目录部署。如果这些（尤其是静态构建）都不起作用，那么您做错了严重的事情，并且很难在像 SO 这样的板上进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T02:54:37.667

首先，请发布详细信息，例如

您正在使用哪个 qt 版本？您使用什么模块 - QtNetwork、QTGui 等？

最后，您使用的是什么编译器，MinGW，MSVC？

您需要做的就是在应用程序目录中为您的项目中包含的模块部署 QTCore dll 和其他 dll。

此外，如果您使用的是 MSVC 编译器，则必须部署 MSVC 运行时。您可以在 microsoft 网站上找到可再发行组件。

或者，如果您使用的是 mingw，那么您可能需要部署正确的 g++ 运行时。

如果您仍然无法使用上述信息部署应用程序，请提供其他详细信息，以便我建议正确的方法。

# php - 等效于存储在 CSV 文件中的数据的 MySQL SELECT DISTINCT

> ID：12774735
> 
> 赞同：0
> 
> 时间：2012-10-08T02:49:23.930
> 
> 标签：php

所以我有一个类似于下面的记录列表，存储在一个制表符分隔的文件中。

```
AgentID Date
HA  13-09-2012
BC  13-09-2012
DE  13-09-2012
BC  14-09-2012
AB  14-09-2012
AB  15-09-2012
HA  15-09-2012
BC  18-09-2012
BC  19-09-2012 
```

我想显示每个用户 ID 的最后更新日期并将其回显到屏幕上。所以对于上面的例子，输出将是

```
AgentID Date
DE  13-09-2012
AB  15-09-2012
HA  15-09-2012
BC  19-09-2012 
```

使用 PHP 执行此操作的最有效方法是什么？我想我需要将结果读入一个数组并按日期对数组进行排序 - 我不知道如何删除我不想要的数组条目。

我的真实文件中有多个 AgentID，日期超过几个月，每天会更改多次（显然插入 AgentID 和日期）。我还想在输出中包含其他列，但在处理数据时不考虑这些列。

提前致谢

# python - 一种方法如何比另一种更 Pythonic？

> ID：12774736
> 
> 赞同：4
> 
> 时间：2012-10-08T02:49:32.737
> 
> 标签：python

显然

方法一

```
if var in ['string one', 'string two']:
    do_something() 
```

比 Pythonic 更多：

方法二

```
if var == 'stringone' or var == 'stringtwo':
    dosomething() 
```

为什么方法 1 被认为比方法 2 更 Pythonic？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-08T02:53:56.463

> 成为 Pythonic 就是将 Python 构造和数据结构与干净、易读的习语一起使用。

来自：[*什么是 Pythonic？*](http://faassen.n--tree.net/blog/view/weblog/2005/08/06/0)

简单地说，第一个比第二个更容易阅读——它的样板更少，开销也比第一个少。任何 Python 程序员都可以查看第一个并看到有一个正在检查的内容列表，它读起来更像是简单的英语而不是第二个。考虑是否扩展了要检查的内容列表 - 第一个示例如下所示：

```
if var in ['string one', 'string two', 'string three']:
    # If var is one of string one, string two, or string three.
    do_something() 
```

而第二个听起来像：

```
if var == 'stringone' or var == 'stringtwo' or var == stringthree:
    # If var is equal to stringone, or var is equal to stringtwo, or var is equal to stringthree.
    dosomething() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T02:54:20.217

将第一种方法扩展到更多字符串更容易：

```
if var in ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight']: 
```

第二种方法很快变得笨拙：

```
if  var == 'one' or var == 'two' or var == 'three' or ...: 
```

此外，第一种方法可用于测试函数调用的返回值，并且只计算一次：

```
if bigCalculation() in ['one', 'two', 'three']: 
```

第二种方法必须每次都重新评估调用，导致性能更差（特别是如果调用计算量很大）。

```
if bigCalculation() == 'one' or bigCalculation() == 'two' or ...: 
```

# database - Drupal - 多模式

> ID：12774737
> 
> 赞同：-1
> 
> 时间：2012-10-08T02:49:37.380
> 
> 标签：database, drupal, shared-data

我的任务是开发一个有 2 个端点的站点；前端和后端。我被指示使用 drupal 7.x。现在，我的问题是，在 drupal 中是否有可能从具有共享数据库的“mysite.com”中为“admin.mysite.com”提供不同的 ui？这两个站点是安装在drupal 中的多站点。请告诉我。

非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T19:40:27.427

为了能够查看您的 Drupal 站点的管理员端，具有适当管理员权限的用户只需访问**yoursite.com/user/login**输入他们的用户名和密码。登录后，他们将能够查看他们有权查看的相应管理员级别的内容（例如内容管理部分、用户管理部分等）。

您可以拥有任意数量的具有不同类型权限的管理员，他们可能能够查看管理页面的全部或子部分。

那有意义吗？

# c++ - 如何确定流程的完整性级别？

> ID：12774738
> 
> 赞同：4
> 
> 时间：2012-10-08T02:49:54.213
> 
> 标签：c++, security, winapi

我最近需要获得一个进程的完整性级别，我从 MSDN 找到了帮助。示例代码如下所示：

```
if (GetTokenInformation(hToken, TokenIntegrityLevel, 
     pTIL, dwLengthNeeded, &dwLengthNeeded))
 {
  dwIntegrityLevel = *GetSidSubAuthority(pTIL->Label.Sid, 
    (DWORD)(UCHAR)(*GetSidSubAuthorityCount(pTIL->Label.Sid)-1));

  if (dwIntegrityLevel == SECURITY_MANDATORY_LOW_RID)
  {
   // Low Integrity
   wprintf(L"Low Process");
  }
  else if (dwIntegrityLevel >= SECURITY_MANDATORY_MEDIUM_RID && 
       dwIntegrityLevel < SECURITY_MANDATORY_HIGH_RID)
  {
   // Medium Integrity
   wprintf(L"Medium Process");
  }
  else if (dwIntegrityLevel >= SECURITY_MANDATORY_HIGH_RID)
  {
   // High Integrity
   wprintf(L"High Integrity Process");
  }
  else if (dwIntegrityLevel >= SECURITY_MANDATORY_SYSTEM_RID)
  {
   // System Integrity
   wprintf(L"System Integrity Process");
  }
 } 
```

众所周知，

```
SECURITY_MANDATORY_LOW_RID == 0x00001000L
SECURITY_MANDATORY_MEDIUM_RID == 0x00002000L
SECURITY_MANDATORY_HIGH_RID == 0x00003000L
SECURITY_MANDATORY_SYSTEM_RID == 0x00004000L. 
```

**这是我的问题：**如果此示例代码是正确的，那么如果进程 A 具有of ，
那么它的完整性级别是多少？和？是不是说有层次的过程也有层次？`dwIntegrityLevel``0x00004100L``SECURITY_MANDATORY_HIGH_RID``SECURITY_MANDATORY_SYSTEM_RID``SECURITY_MANDATORY_SYSTEM_RID``SECURITY_MANDATORY_HIGH_RID`

如果示例代码错误，那么确定进程完整性级别的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T11:46:46.080

请注意 WinNT.h 中的等效声明：

```
#define SECURITY_MANDATORY_MEDIUM_PLUS_RID  (SECURITY_MANDATORY_MEDIUM_RID + 0x100) 
```

所以听起来你遇到了一个 SYSTEM_PLUS 进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-13T13:28:09.113

我建议您查看[https://github.com/chromium/chromium/blob/master/base/process/process_info_win.cc](https://github.com/chromium/chromium/blob/master/base/process/process_info_win.cc)`GetCurrentProcessIntegrityLevel`上的 Chrome/Chromium实现。这可能是一个值得信赖的参考。

# android - Android：在 xml 中创建一个可变模块

> ID：12774740
> 
> 赞同：1
> 
> 时间：2012-10-08T02:50:14.820
> 
> 标签：android, xml

是否可以创建一个 xml 模块/结构，我可以使用自定义设置将其包含在另一个 xml 中？

这个想法是制作一个带有搜索栏、文本和文本输入的模块。我将在另一个 xml 中需要这个模块大约 20 次，但它的值（如文本和 id）对于每个实例都是不同的。

有没有办法在xml中做到这一点？

或者有没有办法制作一个使用这个基本 xml 模块并让我通过 xml 设置所需值的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:03:02.573

是的，您可以在 xml 布局中使用合并和包含标签。例如在 grid_layout_view.xml 你有这个代码：

```
<?xml version="1.0" encoding="utf-8"?><GridLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:orientation="vertical">
    <include android:id="@+id/my_inside_grid_layout" 
             layout="@layout/grid_layout_inside"/>    </GridLayout> 
```

请注意使用标签导入 grid_layout_inside.xml 文件的内容，该文件包含以下内容：

```
 <?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:background="#FFFFFFFF"
        android:layout_gravity="fill">
    </ListView>
    <LinearLayout
        android:layout_gravity="fill_horizontal"
        android:orientation="horizontal"
        android:padding="5dp">

        <Button
            android:text="Cancel"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1" />
        <Button
            android:text="OK"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1" />
     </LinearLayout>

</merge> 
```

跳这有帮助，鲁本

# java - HtmlUnit 异常

> ID：12774746
> 
> 赞同：4
> 
> 时间：2012-10-08T02:51:18.960
> 
> 标签：java, htmlunit

我无法理解这个 HTMLUnit 异常的含义。当我在网页上的链接上调用 click() 时会发生这种情况。

```
Exception class=[net.sourceforge.htmlunit.corejs.javascript.WrappedException]
com.gargoylesoftware.htmlunit.ScriptException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot read property "offsetWidth" from null (http://webapps6.doc.state.nc.us/opi/scripts/DHTMLmessages.js#95) (javascript url#297)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:534)
at net.sourceforge.htmlunit.corejs.javascript.Context.call(Context.java:537)
at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.call(ContextFactory.java:538)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:432)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine.execute(JavaScriptEngine.java:407)
at com.gargoylesoftware.htmlunit.html.HtmlPage.executeJavaScriptIfPossible(HtmlPage.java:965)
at com.gargoylesoftware.htmlunit.html.HtmlAnchor.doClickAction(HtmlAnchor.java:87)
at com.gargoylesoftware.htmlunit.html.HtmlAnchor.doClickAction(HtmlAnchor.java:121)
at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1329)
at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1288)
at com.gargoylesoftware.htmlunit.html.HtmlElement.click(HtmlElement.java:1257)
at testapp.TestApp.main(TestApp.java:61)
Caused by: net.sourceforge.htmlunit.corejs.javascript.WrappedException: Wrapped com.gargoylesoftware.htmlunit.ScriptException: TypeError: Cannot read property "offsetWidth" from null (http://webapps6.doc.state.nc.us.js#95) (javascript url#297)
at net.sourceforge.htmlunit.corejs.javascript.Context.throwAsScriptRuntimeEx(Context.java:1802)
at net.sourceforge.htmlunit.corejs.javascript.MemberBox.invoke(MemberBox.java:196)
at net.sourceforge.htmlunit.corejs.javascript.FunctionObject.call(FunctionObject.java:479)
at net.sourceforge.htmlunit.corejs.javascript.Interpreter.interpretLoop(Interpreter.java:1701)
at net.sourceforge.htmlunit.corejs.javascript.Interpreter.interpret(Interpreter.java:854)
at net.sourceforge.htmlunit.corejs.javascript.InterpretedFunction.call(InterpretedFunction.java:164)
at net.sourceforge.htmlunit.corejs.javascript.ContextFactory.doTopCall(ContextFactory.java:429)
at com.gargoylesoftware.htmlunit.javascript.HtmlUnitContextFactory.doTopCall(HtmlUnitContextFactory.java:267)
at net.sourceforge.htmlunit.corejs.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3183)
at net.sourceforge.htmlunit.corejs.javascript.InterpretedFunction.exec(InterpretedFunction.java:175)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$5.doRun(JavaScriptEngine.java:423)
at com.gargoylesoftware.htmlunit.javascript.JavaScriptEngine$HtmlUnitContextAction.run(JavaScriptEngine.java:528)
... 11 more 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-07-31T16:53:48.550

当您单击此链接并调用另一个页面时，htmlUnit 在导航期间的异常可能会非常冗长。如果您单击浏览器并打开控制台，可能会看到这些错误、缺少链接或图像、调用脚本时出错..

这些不是 HtmlUnit 的必要 Javascript 问题。

就像我在这里说的[HtmlUnit 不创建 HtmlPage 对象](https://stackoverflow.com/questions/29973664/htmlunit-not-creating-htmlpage-object?answertab=active#tab-top)，您可以设置或修改 htmlUnit 以防止不必要的日志。您还可以设置 log4j 并禁用一些异常。

因此，我们使用这些选项来保持 html 导航，而不会停止我们使用的第一个错误/问题：

```
webClient.getOptions().setThrowExceptionOnScriptError(false);
webClient.getOptions().setThrowExceptionOnFailingStatusCode(false); 
```

您还可以实现空类来阻止 htmlUnity 在控制台上详细说明 css/javaScript 错误：

```
webClient.setCssErrorHandler(new SilentCssErrorHandler());    
webClient.setJavaScriptErrorListener(new JavaScriptErrorListener(){}); 
```

小样本测试用例：

```
@Test
public void TestCall() throws FailingHttpStatusCodeException, MalformedURLException, IOException {      
    WebClient webClient = new WebClient(BrowserVersion.CHROME);
    webClient.getOptions().setUseInsecureSSL(true); //ignore ssl certificate
    webClient.getOptions().setThrowExceptionOnScriptError(false);
    webClient.getOptions().setThrowExceptionOnFailingStatusCode(false);
    String url = "https://www.wearvr.com/#game_id=game_4";
    HtmlPage myPage = webClient.getPage(url);
    webClient.waitForBackgroundJavaScriptStartingBefore(200);
    webClient.waitForBackgroundJavaScript(20000);
    //do stuff on page ex: myPage.getElementById("main")
    //myPage.asXml() <- tags and elements
    System.out.println(myPage.asText());

} 
```

你也可以在这里看到更多[关闭 HtmlUnit 警告](https://stackoverflow.com/questions/3600557/turning-htmlunit-warnings-off)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T15:14:59.527

JS 再次与 HtmlUnit 发生问题。您需要更正您的 JS 代码，因为它很可能包含错误。如果您不拥有 JS 代码，那么 HtmlUnit 将无法解决此问题。看看我在[这里](https://stackoverflow.com/questions/12721277/syntaxerror-missing-before-statement-exception-with-htmlunitdriver/12738479#12738479)提供的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-20T07:48:25.203

Htmlunit 通常不能很好地处理 js 代码。如果要单击链接，最好使用 htmlunit api 查找元素，例如。

```
 page.getHtmlElementById("some_div_id");
    page.getByXPath("//div"); 
```

# php - PHP PDO 将远程主机更改为本地主机名

> ID：12774747
> 
> 赞同：1
> 
> 时间：2012-10-08T02:51:49.287
> 
> 标签：php, mysql, pdo

我正在尝试使用 PDO 连接到远程 mysql 服务器。但是，无论我在 dsn 中提供的主机名或 IP 地址如何，当脚本运行时，它总是将地址恢复为运行 Web 服务器的本地服务器的主机名。

谷歌建议这可能与 SELinux 和 apache 连接到远程数据库的能力有关，但是我禁用了 SELinux。

发行版：Ubuntu 11.04 x64

阿帕奇版本：2.2.17

PHP 版本：带有 Suhosin-Patch (cli) 的 PHP 5.3.5-1ubuntu7.11

编辑：

按要求添加代码。虽然我不认为这是我的编码问题，因为它在本地服务器上工作正常，但不允许远程连接。

```
public function db_connect($driver, $dbhost, $dbname, $user, $pass) {
    $dsn = $driver . ':host=' . $dbhost . ';dbname=' . $dbname;
    try {
        $this->DB = new PDO($dsn, $user, $pass);
    }
    catch (PDOException $err) {
        print 'Database Connection Failed: ' . $err->getMessage();
        die();
    }
}

$remote_db = new DB('mysql', 'remote_server.domain.tld', 'database_name', 'user_name', 'password'); 
```

这是我收到的错误消息。

> 数据库连接失败：SQLSTATE [28000] [1045] 用户 'user_name'@'local_server.domain.tld' 的访问被拒绝（使用密码：YES）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:33:41.050

该错误并不是说您已连接到`local_server.domain.tld`，而只是说明您正在**从**那里进行连接。该错误必须与您的 GRANT 或其他身份验证问题有关。

# automated-tests - 如何在商业智能系统 (BI) 中执行自动化测试

> ID：12774757
> 
> 赞同：3
> 
> 时间：2012-10-08T02:54:29.600
> 
> 标签：automated-tests, birt, business-intelligence, talend

我目前正在开发一个商业智能（BI）系统，现在我想尽可能地创建一些自动化测试。

我不知道如何在这个 BI 项目上开发自动化测试。有没有人有过 BI 测试的经验？

我只需要这个测试的一些想法。

这是我的项目的简短描述。

1.  我的项目将使用 talend 作为 ETL 工具从任何感兴趣的数据源查询数据到我们称为 ReportDB（MySql 方案）的数据源
2.  从 ReportDB 中，我将数据导出为以下格式
    *   使用 Talend 作为导出和汇总数据的工具的 CSV 文件
    *   使用 Eclipse BIRT 作为导出和汇总数据的工具的静态 Web

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:09:10.703

我也在调查类似的东西，但对于 MS 堆栈。

BI 系统的自动化测试似乎更难，因为代码往往更封闭或更难隔离。

我们已经完成/调查的事情包括：

*   将代码移动到 DLL 等外部单元并使用测试适配器/线束对其进行测试
*   将外部规则编码到测试工具中，测试源和目标数据库以捕获垃圾数据或无效转换等内容
*   使用模型驱动的方法来统一构建公共方面——etls、表和多维数据集结构，并确保它们与测试模式保持完整性
*   使用源代码控制来控制实时/测试/开发配置并添加测试以验证这些与所需方法是否一致。
*   通过隔离查询生产者和消费者来使用通用组件构建报告

还有很多事情要做，这是一个进化过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T08:41:11.453

自动化测试的一种方法是使用黑盒方法并定义一组输入记录，您有一组已定义的预期输出。然后，每次对 ETL 流程进行更改时，您都将验证是否保留了预期的输出。

您可以维护一个测试数据源或一组测试 csv 文件，具体取决于您的流程期望的输入类型。使用 Talend，您可以使用上下文变量来使您能够在生产和测试之间切换源，而无需重新编译流程。

要构建目标输出，您可以手动完成，也可以先在测试数据上运行该过程，然后逐行检查输出以验证它们。

然后，您可以实现一个相当简单的自动验证过程，将测试运行的输出与标准测试结果集进行比较。这将必须打开两个结果集并比较每一行和每一列的相等性。

这会给您的项目增加一些开销，因为对于添加到流程中的每个新列，您需要将该列添加到测试输入和自动验证中。但是，您可能会争辩说，这种额外的开销降低了导致数据问题的错误的风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T23:53:00.880

您可以使用 Selenium WebDriver 在静态报告页面上运行集成测试。为您的报告预定义数据。运行 Eclipse birt 并让 selenium 在浏览器中访问报告。编写 selenium 测试以验证页面上是否存在预期数据。

# javascript - JavaScript 中的“x = x || {}”技术是什么——它如何影响这个 IIFE？

> ID：12774762
> 
> 赞同：3
> 
> 时间：2012-10-08T02:56:01.753
> 
> 标签：javascript, syntax, iife

首先，一个伪代码示例：

```
;(function(foo){

    foo.init = function(baz) { ... }

    foo.other = function() { ... }

    return foo;

}(window.FOO = window.FOO || {})); 
```

像这样调用：

```
FOO.init(); 
```

### 我的问题：

*   什么是技术名称/描述：`window.FOO = window.FOO || {}`？

我了解代码的作用...请参阅下面的询问原因。

* * *

### 问的原因：

我这样调用传入的全局变量：

```
;(function(foo){
    ... foo vs. FOO, anyone else potentially confused? ...
}(window.FOO = window.FOO || {})); 
```

......但我只是不喜欢称那个小写“ `foo`”，考虑到全局被称为大写`FOO`......它看起来很混乱。

如果我知道这种技术的技术名称，我可以说：

```
;(function(technicalname){
    ... do something with technicalname, not to be confused with FOO ...
}(window.FOO = window.FOO || {})); 
```

我看过一个最近的（很棒的）例子，他们称之为“ `exports`”：

```
;(function(exports){
    ...
}(window.Lib = window.Lib || {})); 
```

我想我只是想标准化我的编码约定......我想了解专业人士的工作以及他们的想法（这就是我在这里问的原因）！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T03:24:00.970

[图案]

```
(function (foo) {
    ...code...
    foo.bar = baz;
    ...more code...
}(window.FOO = window.FOO || {}); 
```

您描述的模式没有正式名称，因为它是三个独立的模式组合在一起。每个模式都有多个名称，但在这篇文章中，我将使用以下术语：

*   关闭
*   别名
*   命名空间扩展

## 关闭

整个模式的基础是`closure`. 它只是一个用于限定变量和函数范围的函数，这样它们就不会污染全局命名空间：

[没有关闭]

```
//these declare window.foo and window.bar respectively
//as such, they pollute the global namespace
var foo;
function bar() {} 
```

[闭包，在这种情况下，是[立即调用的功能表达式 (IIFE)](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)]

```
(function () {
    //these declare foo and bar within the function
    //but they are not accessible outside the function
    var foo;
    function bar() {}
}()); 
```

将变量保存在闭包中的好处是您不必担心有人会覆盖您正在使用的变量。这对于诸如`i`或`j`经常使用的临时变量尤其重要。

## 别名

这种模式的第二个重要部分是混叠。别名允许在闭包中定义和使用变量，而无需担心它驻留在哪个全局命名空间中。

[无别名]

```
(function () {
    ...
    foo = window.SomeFunction(bar, baz);
    ...
}()); 
```

[带别名]

```
(function (sf) { //local name
    ...
    foo = sf(bar, baz);
    ...
}(window.SomeFunction)); //global namespace 
```

这一点尤其重要，因为这意味着可以通过在单个位置更改名称来跨大型 JavaScript 文件更改全局命名空间。这是一件好事™。此外，缩小器可以将内部别名缩短为单个字母变量名，例如`a`，从而在缩小时显着节省字节。

## 命名空间扩展

命名空间扩展模式依赖于 or 运算符 ( `||`) 的合并行为。在许多语言中，`&&`返回`||`一个`true`or `false`，但在 JavaScript 中，`&&`返回第一个`falsey`值（`false`, `0`, `''`, `null`, `undefined`），然后`||`返回第一个`truthy`值（任何不是`falsey`）。对于这两个运算符，如果未找到相应的类型，则返回最后一个参数。这使得`||`操作符成为一种方便的方式，*仅当它不存在时才*定义一个新的命名空间。

[没有命名空间扩展]

```
if (typeof window.Foo === 'undefined') {
    window.foo = {};
} 
```

[带有命名空间扩展]

```
window.foo = window.foo || {}; 
```

这很有用，因为它允许使用其他属性和方法扩展命名空间，而不必担心定义属性和方法的顺序。

在第一个示例中，`FileA`需要在之前执行`FileB`：

[文件A.js]

```
window.foo = {};
window.foo.bar = 'baz'; 
```

[文件B.js]

```
window.foo.fizz = 'buzz'; 
```

在第二个示例中，`File1`可以`File2`按任何顺序执行：

[文件1.js]

```
window.foo = window.foo || {};
window.foo.bar = 'baz'; 
```

[文件2.js]

```
window.foo = window.foo || {};
window.foo.fizz = 'buzz'; 
```

## 现在都在一起了

将每种模式一起使用会创建一个非常强大的模块化脚本：

```
//use foo internally so that you don't have to worry about
//what the global namespace is called
(function (foo) {
    //declare variables internally that you want to keep local to the script
    var i,
        len,
        internal,
        qux;
    //declare functions/properties on the alias when you want to expose them
    foo.bar = function () {...};
//extend the global namespace so that existing extensions are persistent
}(window.FOO = window.FOO || {})); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T03:28:28.847

我一直将其理解为[“Null Coalescing”](https://www.google.com/search?q=Null%20Coalescing)。

至于影响你的 IIFE，`window.FOO`如果它已经实例化，你就传入，如果没有实例化，你就传入一个空对象。

您也可以将其解读为：

```
window.FOO = window.FOO || {};
;(function(foo){

    foo.init = function(baz) { ... }

    foo.other = function() { ... }

    return foo;

}(window.FOO)); 
```

就个人而言，我更喜欢不同的模式：

```
var FOO;
if (!FOO) {
    FOO = {};
}
(function () {
    "use strict";
    FOO.prop1 = 'bar';
    FOO.bar = function (z) {
        return z + 1;
    };
}()); 
```

我发现它不那么令人困惑，并帮助我确保干净的命名空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T03:36:15.680

为了补充皮特的答案，另一种形式：

```
;(function() {
  var Foo = window.Foo = window.Foo || {};

  Foo.foo  = 'bar';
  Foo.baz  = function() {
    return "Hello World!";
  };
})(); 
```

我通常使用 local`var`来给 minifier 节省几个字节的机会。当您在命名空间深处的多个级别（例如 on ）上工作时，这会产生更大的影响`var MyView = window.MyApp.Views.MyView`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-08T03:59:29.833

正如其他人所指出的，您的第一个问题完全独立于您的第二个问题。除了您决定将它们组合在一个语句中而不是在两个语句中这样做之外，它们彼此没有任何关系。

对于您的第一个问题，Douglas Crockford 将其称为**default assignment**。如，如果变量存在，则不理会它，否则将其初始化为指定的默认值。当您看到如下内容时：

```
foo = foo || {}; 
```

你的大脑应该将其解读为：

```
foo defaults to `{}` 
```

从技术上讲，它实际上是“如果 foo 是虚假的，则分配`{}`给 foo”，但我们假设任何虚假的东西，例如零、空或未定义，`foo`在我们使用它时都是无效值。此外，这个词`default`已经暗示“如果 foo 没有定义”。

但是，话虽如此，并且知道您的第二个问题，但很明显**default**作为传递给您的 IIFE 的参数名称并不是一个合适的词。该参数所做的只是将方法和属性附加到传入的对象。在这种情况下，**导出**是合适的，如“这些是对象的公共导出成员”。我认为**附加**也是一个合适的名称，如“将这些东西附加到对象”中。我个人的偏好只是简单地将其命名为**obj**为 in object，这是您希望传入的东西的类型。

# cakephp - cakephp 中的出站链接

> ID：12774764
> 
> 赞同：0
> 
> 时间：2012-10-08T02:56:29.320
> 
> 标签：cakephp, hyperlink, outbound

我现在正在检查/测试软件。要检查它是否正常工作，我必须使用带有出站链接的现有网站。我有另一个用 cakephp 编码的网站。在这个网站中，我必须放置一个锚文本来指向另一个网站，即出站链接。这将用于检查软件是否正常工作。你能帮我如何在 cakephp 中添加出站链接，我是新手。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T05:06:18.917

您可以通过这种方式使用 Html Helper 放置链接：

```
<?php echo $this->Html->link('Site Name', 'http://www.example.com'); ?> 
```

# maps - 谷歌地图与 JavaFX 应用程序的坐标

> ID：12774765
> 
> 赞同：1
> 
> 时间：2012-10-08T02:56:30.940
> 
> 标签：maps, javafx

我想知道点击发生时如何从谷歌地图获取坐标到 JavaFX 应用程序？这是我尝试调用 Java 函数的代码示例：

来自 JavaScript 'click' 处理程序的 'showCoordinates'：

```
public class JavaFXApplication extends Application {
public void showCoordinates(String coords)
{
    System.out.println("Coordinates: " + coords);
}

@Override public void start(Stage stage) 
{   
    final WebView webView = new WebView();
    final WebEngine webEngine = webView.getEngine();
    webEngine.load(getClass().getResource("googlemap.html").toString());

    webEngine.getLoadWorker().stateProperty().addListener(
            new ChangeListener<State>() {
                @Override
                public void changed(ObservableValue<? extends State> ov, State oldState,     State newState) {
                    if (newState == State.SUCCEEDED) {
                        JSObject window = (JSObject) webEngine.executeScript("window");
                        window.setMember("java", new JavaFXApplication());
                    }
                }
            });  
    BorderPane root = new BorderPane();
    root.setCenter(webView);
    stage.setTitle("Google maps");
    Scene scene = new Scene(root,1000,700, Color.web("#666970"));
    stage.setScene(scene);
    stage.show();
}

public static void main(String[] args){
    Application.launch(args);
}
}

// googlemap.html file
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0px; padding: 0px }
        #map_canvas { height: 100%; background-color: #666970; }
    </style>        
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
    </script>
    <script type="text/javascript">            
        function initialize() {
            var latlng = new google.maps.LatLng(40.75089, -73.93804);
            var myOptions = {
                zoom: 10,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                mapTypeControl: false,
                panControl: true,
                navigationControl: true,
                streetViewControl: false,
                backgroundColor: "#666970"
            };

            var map = new     google.maps.Map(document.getElementById("map_canvas"),myOptions);     
            document.map = map;

    google.maps.event.addListener(map, 'click', function(event) {
        //java.showCoordinates(event.latLng); ???
    });
    map.setCenter(location);
}       
    </script>
</head>
<body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T09:39:23.980

经过一些实验，我得出了一个简单的基于计时器的解决方案。这个想法是计时器函数定期轮询 javascript 文档并解析结果。

```
var latlng = new google.maps.LatLng(52.3, 4.59 );
var myOptions = {
  zoom: 9,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.TERRAIN,
  mapTypeControl: true,
  navigationControl: true,
  streetViewControl: true,
  backgroundColor: "#FFFFFF"
};

document.geocoder = new google.maps.Geocoder();
document.map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);

document.updateJavaFX = function updateJavaFX() {
    document.currentCenter  = document.map.getCenter();
    document.currentBounds  = document.map.getBounds();
    document.currentHeading = document.map.getHeading();
    document.currentZoom    = document.map.getZoom();
} 
```

当调用 updateJavaFX() 函数时，文档变量（位置的 currentCenter）被填充。

在 JavaFX 代码中，以下部分（这部分在 AnimationTimer 中调用）用于检索地图的当前纬度位置。

```
 if ((mMapAutoUpdate.get()) && (mLastNow < pNow - 10000000)) {
    mLastNow = pNow;
    mMapView.getEngine().executeScript("document.updateJavaFX()");
    JSObject jdoc = (JSObject) mMapView.getEngine().getDocument();
    if (jdoc != null) {
        try {
            JSObject ds = (JSObject) jdoc.getMember("currentCenter");
            String cc = ds.toString().trim();
            cc = cc.substring(1, cc.length() - 1);
            String[] ccs = cc.split(",");
            double newlat = Double.parseDouble(ccs[0].trim());
            double newlon = Double.parseDouble(ccs[1].trim());
            mCenterLat.set(newlat);
            mCenterLon.set(newlon);
            int zoom = (Integer) jdoc.getMember("currentZoom");
            mZoom.set(zoom);
        } catch (ClassCastException cce) {
            String ds = (String) jdoc.getMember("currentCenter");
            String[] ccs = ds.trim().split(",");
            double newlon = Double.parseDouble(ccs[0].substring(4).trim());
            double newlat = Double.parseDouble(ccs[1].substring(4).trim());
            mCenterLat.set(newlat);
            mCenterLon.set(newlon);
            int zoom = (Integer) jdoc.getMember("currentZoom");
            mZoom.set(zoom);
        }
    }
} 
```

我为可能的解决方案写了一篇博客文章；

[http://oldguardprogrammer.blogspot.nl/2013/01/javafx-and-google-maps.html](http://oldguardprogrammer.blogspot.nl/2013/01/javafx-and-google-maps.html)

# wpf - 将线条、文本等数据绑定到 ItemsControl，以便在画布上进行类似 cad 的矢量绘图

> ID：12774767
> 
> 赞同：2
> 
> 时间：2012-10-08T02:56:55.610
> 
> 标签：wpf, data-binding, mvvm, canvas, itemscontrol

使用 MVVM 模式，我想将线条和文本写入画布，就像矢量 CAD 应用程序一样。在研究这一点时，我得出的结论是，我需要使用 ItemsControl 和 ItemsPanelTemplate 声明为 Canvas，如

```
<ItemsControl>
   <ItemsControl.ItemsPanel>
      <ItemsPanelTemplate>
         <Canvas/>
      </ItemsPanelTemplate>
   </ItemsControl.ItemsPanel>
</ItemsControl> 
```

我还发现我需要在 ItemTemplate 中放*一些东西*（不确定是什么），就像这样。. .

```
 <ItemsControl.ItemTemplate>
     <DataTemplate>
         <!--  Don't know what goes here -->
     </DataTemplate>
  </ItemsControl.ItemTemplate> 
```

## 我的问题

有人可以建议我在 DataTemplate 中放入什么，以便我可以绑定到我的 ViewModel 并让 ViewModel 绘制文本（任何旋转、任何字体等）、线条、弧线、贝塞尔曲线、形状 - - - 根据绑定集合中的各种元素，我需要什么？

我的猜测是它应该是一个 System.Windows.FrameworkTemplate，但我仍在试图弄清楚如何使用它，而且进展缓慢。或者可能是 ContentControl 和 Presenter？

## 参考

[使用 ItemsControl 时如何将 X/Y 位置转换为 Canvas Left/Top 属性](https://stackoverflow.com/questions/4708151/how-to-convert-x-y-position-to-canvas-left-top-properties-when-using-itemscontro "使用 ItemsControl 时如何将 X/Y 位置转换为 Canvas Left/Top 属性")

[如何在 ItemsControl 中定位 ViewModel](https://stackoverflow.com/questions/5261640/how-can-i-position-viewmodels-in-an-itemscontrol)

[是否可以在 XAML 中绑定 Canvas 的 Children 属性？](https://stackoverflow.com/questions/889825/is-it-possible-to-bind-a-canvass-children-property-in-xaml) 注意：请参阅此问题的第二个答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T06:00:16.567

有不同的方法。

您可以根据选择器切换 DataTemplates。

```
public class ImgStringTemplateSelector : DataTemplateSelector
{
  public DataTemplate ImageTemplate { get; set; }
  public DataTemplate StringTemplate { get; set; }

  public override DataTemplate SelectTemplate(object item,
    DependencyObject container)
  {
    String path = (string)item;
    String ext = System.IO.Path.GetExtension(path);
    if (System.IO.File.Exists(path) && ext == ".jpg")
      return ImageTemplate;
    return StringTemplate;
  } 
```

您可以通过 ItemsPanel ItemTemplateSelector 来引用它。Sch as ItemTemplateSelector="{StaticResource ImgTemplateSelector}"。在那里，您选择要返回的模板。

你可以返回 Line 模板、Arc 模板等。这很简单。

另一个技巧是您可以拥有基类 DrawingObject 并从中派生。如 ArcObj : DrawingObject,

稍后您只需添加

```
<DataTemplate Datatype="{x:Type ArcObj"}>
<Arc Canvas.Left="{BInding X}", Canvas.Top="{Binding Y}" />
</DataTemplate> 
```

等等。

# javascript - 单击锚点时如何设置/存储cookie

> ID：12774773
> 
> 赞同：4
> 
> 时间：2012-10-08T02:57:58.590
> 
> 标签：javascript, jquery

我正在尝试使用 Cookie，以便参考单击的锚标记应用默认样式或特定样式，即使浏览器关闭/重新打开也是如此。因此，如果用户单击第二个链接，关闭或刷新浏览器并重新打开，则样式应该仍然处于活动状态，如果这是他们第一次应用默认值。这有点超出我的地盘。

**这是HTML：**

```
<a id="default" href="#/">Default Style</a>
<a id="style2"  href="#/">Style 2</a>
<a id="style3"  href="#/">Style 3</a>

<ol>
<li><span>Hello World</span></li>
</ol> 
```

**JQuery：（StackOverflow 的赞美）**

```
<script type="text/javascript">
$('#default').on('click',function(){
    $('ol li span').removeClass(function() {
          return $(this).attr('class');
        }).addClass('default');
});
$('#style2').click(function(){
    $('ol li span').removeClass(function() {
          return $(this).attr('class');
        }).addClass('style2');
});
$('#style3').click(function(){
    $('ol li span').removeClass(function() {
          return $(this).attr('class');
        }).addClass('style3');
});
</script> 
```

**CSS：**

```
<style type="text/css">
.default{
color: #333;
}

.style2{
color: #999;
}

.style3{
color: #800;
}
</style> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:19:17.897

通过操作文档对象 (document.cookie) 的 cookie 属性来获取和设置 cookie。Mozilla 开发者网络有一篇很棒的文章讨论了这一点，并提供了获取和设置 cookie 的便捷方法。 [https://developer.mozilla.org/en-US/docs/DOM/document.cookie](https://developer.mozilla.org/en-US/docs/DOM/document.cookie)

注意：jQuery 不附带任何与 cookie 相关的方法，但可以使用插件将语法糖 ($.cookie) 放在这些方法周围。

否则，您可以检查您的 cookie 并在就绪回调中以通常的方式处理该逻辑。

```
 $(body).ready(function(){
       if (document.cookie.match("cookie_name")) {
          // Handle logic here
       }
    }); 
```

至于基于单击锚点设置该cookie，您可以使用onclick 属性，或将href 属性设置为“javascript:yourFunction();”，或使用jQuery 的click 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:20:42.387

有一个用于 jQuery 的 cookie 插件，您可以使用它来设置和获取 cookie，但是如果 IE8 之前的浏览器不是问题，我会转而使用本地存储，并且只为 1% 使用旧版本的访问者使用默认样式浏览器。

如果您向链接添加一个类，您可以在一个函数中定位所有这些类，只需根据单击的 ID 设置类，这是使用本地存储的示例：

```
$(function() {
    if (localStorage.getItem('style')) {
        $('ol li span').addClass(localStorage.getItem('style'));
    }else{
        $('ol li span').addClass('default');
    }

    $('.styles').on('click', function(e) {
        e.preventDefault();
        var styles    = ['default', 'style2', 'style3'],
            currStyle = this.id;

        $('ol li span').removeClass(styles.join(' ')).addClass(currStyle);

        localStorage.setItem('style', currStyle);
    });
});
​ 
```

[**小提琴**](http://jsfiddle.net/ETWjN/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:06:03.047

像这个例子

```
$(document).ready(function()
{
   $('a').click(function(event)
   {

        $.cookie(//set ur cookie name & value);

   });
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T03:35:42.373

试试这个：

```
// You can set all your default, style2, style3 css code inside this active.css

function appendStyleSheet() {
  $('head').append('<link rel="stylesheet" href="css/active.css" type="text/css"     id="active_stylesheet"/>'); 
}

// append the style sheet on load if the cookie is set to true
if ($.cookie('active') == 'true') {
    appendStyleSheet();      
} else {
    $('ol li span').addClass("default");
}

$("a").click(function () {

        var styles    = ['default', 'style2', 'style3'],
        currStyle     = this.id;

        $('ol li span').removeClass(styles.join(' ')).addClass(currStyle);

        appendStyleSheet();      
        $.cookie('active', 'true'); // set the cookie to true

}); 
```

# java - 有一个程序，我想将合并排序融合到其中，但在这样做时遇到了麻烦

> ID：12774780
> 
> 赞同：0
> 
> 时间：2012-10-08T02:59:36.180
> 
> 标签：java, arrays, reference, comparator, mergesort

我有一个程序的三类，它们获取一堆数据并使用比较器对其进行排序。我所做的是在名为 EarthquakeDataSet 的类的末尾添加了一个合并排序。合并添加了一个与整数数组一起使用的合并。我想做的是使用来自 EarthquakeRecord 的一系列参考资料。然后我也需要比较才能使用它。合并开始于类 EarthquakeDataSet 的私有 int[] 数据的末尾。任何建议，将不胜感激

* * *

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;

import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

public class EarthquakeTest {
public static void main(String[] args) {
    EarthquakeDataSet eqds = new EarthquakeDataSet(); 
    String sFileName = null;
    try {
        File file;
        JFileChooser fc = new JFileChooser(".");
        fc.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);
        int returnVal = fc.showOpenDialog(null);
        if (returnVal == JFileChooser.APPROVE_OPTION) {
            file = fc.getSelectedFile();

            long lElapseTime = eqds.loadDataFromFile(file);// open file and parse all data into <i>EarthquakeRecord</i> objects
            System.out.println("File Loading / Parsing: Elapsed time: " + ((float) lElapseTime) / 1000.0);

            lElapseTime = eqds.copyOriginalArray();
            System.out.println("Create 3 copies of arrays: Elapse Time: " + ((float) lElapseTime) / 1000.0);

            eqds.sortNativeJava(); // a batch process akin to the Google batch process of building a planetary index of the internet

            System.out.println("Data After Sorting with Native Java Sort");
            while (JOptionPane.showConfirmDialog(null, "Display Sorted View?") == 0)
                eqds.display(); // allow user to view the data multiple times and view the outcome of the sort: akin to Google users performing lookups
        }
    } catch (FileNotFoundException fnfe) {
        JOptionPane.showMessageDialog(null, "File not found: " + sFileName);
    } catch (IOException ioe) {
        JOptionPane.showMessageDialog(null, "IO Exception: " + sFileName);
    } catch (Exception e) {
        JOptionPane.showMessageDialog(null, "ERROR: General Exception");
        e.printStackTrace();
    }
}
} 
```

* * *

```
import java.util.Comparator;

public class EarthquakeRecord {
private int nYear;
private int nMonth;
private int nDay;
private int nHour;
private int nMinute;
private double dSecond;
private int nUTC;
private double dLatitude;
private double dLongitude;
private double dMagnitude;
private int nDepth;
private int nEpicentre;
private double dCityLatitude;
private double dCityLongitude;
private String sCityName;

public EarthquakeRecord(String sRawRecord) { parseStringInput(sRawRecord); }

private void parseStringInput(String sRawRecord) {
    try {
        nYear = Integer.parseInt(sRawRecord.substring(0, 4));
    } catch (java.lang.NumberFormatException e) {
        nYear = 0;
    }
    try {
        nMonth = Integer.parseInt((sRawRecord.substring(5, 7)).trim());
    } catch (java.lang.NumberFormatException e) {
        nMonth = 0;
    }
    try {
        nDay = Integer.parseInt((sRawRecord.substring(8, 10)).trim());
    } catch (java.lang.NumberFormatException e) {
        nDay = 0;
    }
    try {
        nHour = Integer.parseInt((sRawRecord.substring(11, 13)).trim());
    } catch (java.lang.NumberFormatException e) {
        nHour = 0;
    }
    try {
        nMinute = Integer.parseInt((sRawRecord.substring(14, 16)).trim());
    } catch (java.lang.NumberFormatException e) {
        nMinute = 0;
    }
    try {
        dSecond = Double.parseDouble((sRawRecord.substring(17, 21)).trim());
    } catch (java.lang.NumberFormatException e) {
        dSecond = 0.0;
    }
    try {
        nUTC = Integer.parseInt((sRawRecord.substring(23, 25)).trim());
    } catch (java.lang.NumberFormatException e) {
        nUTC = 0;
    }
    try {
        dLatitude = Double.parseDouble((sRawRecord.substring(30, 37)).trim());
    } catch (java.lang.NumberFormatException e) {
        dLatitude = 0.0;
    }
    try {
        dLongitude = Double.parseDouble((sRawRecord.substring(38, 46)).trim());
    } catch (java.lang.NumberFormatException e) {
        dLongitude = 0.0;
    }
    try {
        dMagnitude = Double.parseDouble((sRawRecord.substring(46, 49)).trim());
    } catch (java.lang.NumberFormatException e) {
        dMagnitude = 0.0;
    }
    try {
        nDepth = Integer.parseInt((sRawRecord.substring(50, 54)).trim());
    } catch (java.lang.NumberFormatException e) {
        nDepth = 0;
    }
    try {
        nEpicentre = Integer.parseInt((sRawRecord.substring(56, 61)).trim());
    } catch (java.lang.NumberFormatException e) {
        nEpicentre = 0;
    }
    try {
        dCityLatitude = Double.parseDouble((sRawRecord.substring(62, 71)).trim());
    } catch (java.lang.NumberFormatException e) {
        dCityLatitude = 0.0;
    }
    try {
        dCityLongitude = Double.parseDouble((sRawRecord.substring(72, 81)).trim());
    } catch (java.lang.NumberFormatException e) {
        dCityLongitude = 0.0;
    }
    sCityName = sRawRecord.substring(93, 124).trim();
}
public int getYear() { return nYear; }
public int getMonth() { return nMonth; }
public int getDay() { return nDay; }
public int getHour() { return nHour; }
public int getMinute() { return nMinute; }
public double getSecond() { return dSecond; }
public int getUTC() { return nUTC; }
public double getLatitude() { return dLatitude; }
public double getLongitude() { return dLongitude; }
public double getMagnitude() { return dMagnitude; }
public int getDepth() { return nDepth; }
public int getEpicentre() { return nEpicentre; }
public double getCityLatitude() { return dCityLatitude; }
public double getCityLongitude() { return dCityLongitude; }
public String getCityName() { return sCityName; }

public String toString() {
    return String.format("%4d/%2d/%2d %2d:%2d:%2.1f %d Lat/Long:%6.2f,%6.2f Mag:%3.1f     Depth:%4d %5d %6.2f:%6.2f %s", nYear, nMonth, nDay, nHour, nMinute, dSecond, nUTC,     dLatitude, dLongitude,
        dMagnitude, nDepth, nEpicentre, dCityLatitude, dCityLongitude, sCityName);
}
public static class CompareMagnitude implements Comparator<EarthquakeRecord> {
    public final static CompareMagnitude instance = new CompareMagnitude();
    public int compare(EarthquakeRecord arg0, EarthquakeRecord arg1) {
        if(arg0.dMagnitude < arg1.dMagnitude){
        return(-1);
        }
        else if(arg0.dMagnitude > arg1.dMagnitude){
        return(1);
        }
        else{
        return(0);
        }
    }
}

/** Singleton public static inner class that creates a <i>Comparator</i> object if needed; used to compare <i>EarthquakeRecord</i> objects based on <i>String</i> containing City Name */
// TODO implement the following class
public static class CompareCity implements Comparator<EarthquakeRecord> {
    public final static CompareCity instance = new CompareCity();
    public int compare(EarthquakeRecord arg0, EarthquakeRecord arg1) {return arg0.sCityName.compareTo(arg1.sCityName);}
}
/** Singleton public static inner class that creates a <i>Comparator</i> object if needed; used to compare <i>EarthquakeRecord</i> objects based on <i>nDepth</i> */
// TODO implement the following class
public static class CompareDepth implements Comparator<EarthquakeRecord> {
    public final static CompareDepth instance = new CompareDepth();
    public int compare(EarthquakeRecord arg0, EarthquakeRecord arg1) {
        if(arg0.nDepth < arg1.nDepth){
        return(-1);
        }
        else if(arg0.nDepth > arg1.nDepth){
        return(1);
        }
        else{
        return(0);
        }
    }

}} 
```

* * *

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Scanner;
import javax.swing.JOptionPane;

public class EarthquakeDataSet<aeqrDepthSort> {

private int nNumRecordsLoaded;

private EarthquakeRecord[] aeqrOriginalOrder; 

private EarthquakeRecord[] aeqrCitySort; 

private EarthquakeRecord[] aeqrDepthSort; 

private EarthquakeRecord[] aeqrMagnitudeSort;

public EarthquakeDataSet() { }

public long loadDataFromFile(File file) throws FileNotFoundException, Exception {
    Scanner scanInput = new Scanner(file); 
    int nMaxNumRecords;
    do { 
        nMaxNumRecords = Integer.parseInt(JOptionPane.showInputDialog("Maximum     Number of Records: "));
    } while (nMaxNumRecords <= 0);

    nNumRecordsLoaded = 0; 
    long lStartTime = System.currentTimeMillis(); 
    aeqrOriginalOrder = new EarthquakeRecord[nMaxNumRecords]; 
    try { 
        while (nNumRecordsLoaded < nMaxNumRecords && scanInput.hasNext()) {
            String sRawRecord = scanInput.nextLine(); 
aeqrOriginalOrder[nNumRecordsLoaded++] = new EarthquakeRecord(sRawRecord); 
        }
    } catch (Exception e) {
        throw new Exception("Input failure at record: " + nNumRecordsLoaded);
    } finally {
        scanInput.close(); 
    }
    System.out.printf("Number Records Loaded: %d", nNumRecordsLoaded);
    return System.currentTimeMillis() - lStartTime; 
}
public long copyOriginalArray() {

    long lStartTime = System.currentTimeMillis();

    aeqrCitySort = Arrays.copyOf(aeqrOriginalOrder, aeqrOriginalOrder.length);

    aeqrMagnitudeSort = Arrays.copyOf(aeqrOriginalOrder, aeqrOriginalOrder.length);

    aeqrDepthSort = Arrays.copyOf(aeqrOriginalOrder, aeqrOriginalOrder.length);
    return System.currentTimeMillis() - lStartTime; 
}

public void sortNativeJava() {

    System.out.println("\nSorting with native Java Sort");
    long lStartTime = System.currentTimeMillis();

    Arrays.sort(aeqrCitySort, EarthquakeRecord.CompareCity.instance);

    long lElapseTime = System.currentTimeMillis() - lStartTime;
    System.out.println("Native Java Sort: City Name: Elapsed time: " + ((float)     lElapseTime) / 1000.0);

    lStartTime = System.currentTimeMillis();

    Arrays.sort(aeqrDepthSort, EarthquakeRecord.CompareDepth.instance);

    lElapseTime = System.currentTimeMillis() - lStartTime;
    System.out.println("Native Java Sort: Depth: Elapsed time: " + ((float)     lElapseTime) / 1000.0);

    lStartTime = System.currentTimeMillis();

    Arrays.sort(aeqrMagnitudeSort, EarthquakeRecord.CompareMagnitude.instance);

    lElapseTime = System.currentTimeMillis() - lStartTime;
    System.out.println("Native Java Sort: Magnitude: Elapsed time: " + ((float)     lElapseTime) / 1000.0);
}

public void display() {
    String[] asSortKeys = { "Original", "City Name", "Magnitude", "Depth" };
    String sReturnValue = (String) JOptionPane.showInputDialog(null, "Select array to sequence display:", "Key Sequence", JOptionPane.INFORMATION_MESSAGE, null, asSortKeys, asSortKeys[0]);
    if (sReturnValue == asSortKeys[0])
        display("Original Sequence", aeqrOriginalOrder);
    else if (sReturnValue == asSortKeys[1])
        display("City Name Sequence", aeqrCitySort);
    else if (sReturnValue == asSortKeys[2])
        display("Magnitude Sequence", aeqrMagnitudeSort);
    else
        display("Depth Sequence", aeqrDepthSort);
}

private void display(String rsLabel, EarthquakeRecord[] raeqrDataSet) {
    if (raeqrDataSet == null) {
        JOptionPane.showMessageDialog(null, "Error: Selected array not yet populated.");
        return;
    }

    System.out.println(rsLabel);
    if (nNumRecordsLoaded < 30)
        for (int i = 0; i < nNumRecordsLoaded; ++i)
            System.out.println(raeqrDataSet[i]);
    else {
        System.out.println("First 10 records:");
        for (int i = 0; i < 10; ++i)
            System.out.println(raeqrDataSet[i]);

        System.out.println("Middle 10 records:");
        int nStart = nNumRecordsLoaded / 2 - 5;
        int nEnd = nStart + 10;
        for (int i = nStart; i < nEnd; ++i)
            System.out.println(raeqrDataSet[i]);

        System.out.println("Last 10 records:");
        for (int i = nNumRecordsLoaded - 10; i < nNumRecordsLoaded; ++i)
            System.out.println(raeqrDataSet[i]);
    }
}

public String toString1() { return "Number of Records: " + nNumRecordsLoaded; }
 private int[] data; 
   private static final Random generator = new Random();

   public MergeSort( int size )
   {
      data = new int[ size ]; 

      for ( int i = 0; i < size; i++ )
         data[ i ] = 10 + generator.nextInt( 90 );
   } 

   public void sort()
   {
      sortArray( 0, data.length - 1 ); 
   } 
   private void sortArray( int low, int high ) 
   {

      if ( ( high - low ) >= 1 ) 
      {
         int middle1 = ( low + high ) / 2; 
         int middle2 = middle1 + 1; 

         System.out.println( "split:   " + subarray( low, high ) );
         System.out.println( "         " + subarray( low, middle1 ) );
         System.out.println( "         " + subarray( middle2, high ) );
         System.out.println();

         sortArray( low, middle1 ); 
         sortArray( middle2, high );

         merge ( low, middle1, middle2, high );
      } 
   } 

   private void merge( int left, int middle1, int middle2, int right ) 
   {
      int leftIndex = left;
      int rightIndex = middle2; 
      int combinedIndex = left; 
      int[] combined = new int[ data.length ]; 

      System.out.println( "merge:   " + subarray( left, middle1 ) );
      System.out.println( "         " + subarray( middle2, right ) );

      while ( leftIndex <= middle1 && rightIndex <= right )
      {
         if ( data[ leftIndex ] <= data[ rightIndex ] )
            combined[ combinedIndex++ ] = data[ leftIndex++ ]; 
         else 
            combined[ combinedIndex++ ] = data[ rightIndex++ ];
      }
      if ( leftIndex == middle2 )
         while ( rightIndex <= right )
            combined[ combinedIndex++ ] = data[ rightIndex++ ];
      else 
         while ( leftIndex <= middle1 ) 
            combined[ combinedIndex++ ] = data[ leftIndex++ ];      

      for ( int i = left; i <= right; i++ )
         data[ i ] = combined[ i ];

      System.out.println( "         " + subarray( left, right ) );
      System.out.println();
   } 

   public String subarray( int low, int high )
   {
      StringBuilder temporary = new StringBuilder();

      for ( int i = 0; i < low; i++ )
         temporary.append( "   " );

      for ( int i = low; i <= high; i++ )
         temporary.append( " " + data[ i ] );

      return temporary.toString();
   } 

   public String toString()
   {
      return subarray( 0, data.length - 1 );
   }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T05:42:34.463

当您使用自定义比较器将排序从整数转换为对象时，您必须替换比较

```
if ( data[ leftIndex ] <= data[ rightIndex ] ) 
```

有类似的东西

```
if ( cmp.compare(data[ leftIndex ], date[ rightIndex ]) <= 0 ) 
```

您可能想为此使用泛型，这意味着您的类将是`MergeSort<T>`，要排序的数组将是 a `T[]`（或 a `List<? extends T>`）和您的比较器 a `Comparator<? super T>`。您还可以提供一种静态方法，就像[`Arrays.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28T%5B%5D,%20java.util.Comparator%29)您在`sortNativeJava`代码中使用的方法一样。

# php - Yii Ajax 提交按钮

> ID：12774784
> 
> 赞同：-1
> 
> 时间：2012-10-08T03:00:22.137
> 
> 标签：php, yii

我的 _table 视图中有这个 ajax 按钮。

这个 _table 视图是通过我的主视图中的 AJAX 表单提交部分呈现的。

问题是当我单击提交（_table 视图中的按钮）时，提交的数据是在我的主视图中被序列化的数据，或者换句话说，我的主视图中的 ajax 按钮执行操作而不是另一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T05:50:15.730

也许你没有使用 renderPartial 的“processOutput”参数，所以你的内部 JS 不工作。并且主视图有这样的ajax按钮，所以“_table”ajax按钮已经用主视图JS处理了......
所以试试：

```
$this->renderPartial("_table", array(), false, true); 
```

# javascript - 如何使用 javascript 放置标记并打开标准谷歌信息窗口？

> ID：12774785
> 
> 赞同：1
> 
> 时间：2012-10-08T03:00:35.840
> 
> 标签：javascript, google-maps-api-3

我正在四处寻找解决方案，但我无法简单地找到它。问题是我想使用 JavaScript Google Maps API v3 使用地理编码服务在地图上放置标记。我拥有的唯一信息是地址，所以我需要获取地点的位置，所以我有一个这样的字符串：

103 Olympic Boulavard, 帕拉马塔, 悉尼, NSW 2059

我有一个充满地址的数据库，这些地址需要以完全相同的方式显示在地图上。

到目前为止我所能达到的效果如下所示：

![在此处输入图像描述](../Images/a35e736552b1bc7847146dff89349742.png)

但我想实现这样的目标：

![在此处输入图像描述](../Images/c7775678134f8bbc0fcbeb52bcd2c7bf.png)

这是带有地址信息的标准谷歌地图气泡。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T05:33:03.617

对的，这是可能的。您必须对其进行编码才能以这种方式显示。

Google Maps API v3 提供方向，地点库可让您搜索附近。不知道你想为其余的做什么。

# shell - 如何在 Makefile 中定义全局 shell 函数？

> ID：12774787
> 
> 赞同：24
> 
> 时间：2012-10-08T03:00:54.343
> 
> 标签：shell, makefile, gnu-make, sh

我想定义一个shell函数

```
#!/bin/sh

test ()
{
  do_some_complicated_tests $1 $2;
  if something; then
    build_thisway $1 $2;
  else
    build_otherway $1 $2;
  fi
} 
```

这样我就可以在我的 Makefile 的每个规则中使用它，例如：

```
foo: bar
  test foo baz 
```

需要明确的是，我希望 shell 函数成为 Makefile 的一部分。最优雅的方法是什么？如果您可以在不递归调用 make 的情况下做到这一点，则可以加分。

* * *

*背景：我的实际问题是`make -n`产生非常长且不可读的输出。每个规则都使用几乎相同的不可读的 shell 命令序列，并且规则很多。上述解决方案将使输出`make -n`更有用。*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-29T18:58:22.413

此解决方案不依赖于外部临时文件，也不会强迫您修改`SHELL`变量。

```
TESTTOOL=sh -c '\
  do_some_complicated_tests $$1 $$2; \
  if something; then
    build_thisway $$1 $$2;
  else
    build_otherway $$1 $$2;
  fi' TESTTOOL

ifneq (,$(findstring n,$(MAKEFLAGS)))
TESTTOOL=: TESTTOOL
endif

foo: bar
    ${TESTTOOL} foo baz 
```

该`ifneq…endif`块检查`-n`命令行上的标志并将其扩展设置为`TESTTOOL`易于`: TESTTOOL`阅读和安全执行。

如果您愿意，最好的解决方案可能是将 shell 函数转换为实际程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-08T12:12:03.660

由于问题被标记为`gnu-make`，您可能对 Beta 的解决方案感到满意，但我认为最好的解决方案是 1) 将函数重命名为`test`（避免使用`ls`and之类`cd`的名称）；出于讨论的目的，假设您已将其重命名`foo`，2) 只需编写一个名为的脚本`foo`并从 Makefile 调用它。如果你真的想在 Makefile 中定义一个 shell 函数，只需为每个规则定义它：

```
F = foo() { \
  do_some_complicated_tests $$1 $$2; \
  if something; then \
    build_thisway $$1 $$2; \
  else \
    build_otherway $$1 $$2; \
  fi \
}

all: bar
  @$(F); foo baz bar 
```

并不是说您必须在 的定义的每一行上都有行继续`foo`，并且`$`都被转义以便将它们传递给 shell。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-08T17:00:19.470

我认为这不符合“优雅”的条件，但它似乎可以满足您的要求：

```
##
## --- Start of ugly hack
##

THIS_FILE := $(lastword $(MAKEFILE_LIST))

define shell-functions
: BEGIN
  # Shell syntax here
  f()
  {
    echo "Here you define your shell function. This is f(): $@"
  }

  g()
  {
    echo "Another shell function. This is g(): $@"
  }
: END
endef

# Generate the file with function declarations for the shell
$(shell sed -n '/^: BEGIN/,/^: END/p' $(THIS_FILE) > .functions.sh)

# The -i is necessary to use --init-file
SHELL := /bin/bash --init-file .functions.sh -i

##
## -- End of ugly hack
##

all:
    @f 1 2 3 4
    @g a b c d 
```

运行它会产生：

```
$ make -f hack.mk
Here you define your shell function. This if f(): 1 2 3 4
Another shell function. This is g(): a b c d 
```

运行它`-n`产生：

```
$ make -f hack.mk -n
f 1 2 3 4
g a b c d 
```

这依赖于这样一个事实，即定义在`define`和之间的宏在实际使用之前`endef`根本不会被解释`make`，因此您可以直接使用 shell 语法，并且不需要以反斜杠结束每一行。当然，如果你调用`shell-functions`宏，它会爆炸。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-11-01T03:38:28.933

为什么不在 Makefile 中使用[.ONESHELL](https://www.gnu.org/software/make/manual/html_node/One-Shell.html)并定义一个 Makefile 函数，如 bash 函数：

```
jeromesun@km:~/workshop/hello.test$ tree
.
├── Makefile
└── mkfiles
    └── func_test.mk

1 directory, 2 files
jeromesun@km:~/workshop/hello.test$ cat Makefile 
.ONESHELL:

-include mkfiles/*.mk

test:
        @$(call func_test, one, two)
jeromesun@km:~/workshop/hello.test$ cat mkfiles/func_test.mk 
.ONESHELL:

define func_test
    echo "func_test parameters: 0:$0, 1:$1, 2:$2"
    if [ ! -d abc ]; then
        mkdir abc
        echo "abc not found"
    else
       echo "abc found"
    fi
endef
jeromesun@km:~/workshop/hello.test$ 
```

结果：

```
jeromesun@km:~/workshop/hello.test$ make test 
func_test parameters: 0:func_test, 1: one, 2: two
abc not found
jeromesun@km:~/workshop/hello.test$ make test 
func_test parameters: 0:func_test, 1: one, 2: two
abc found 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-01T01:06:17.003

这真的是贫民区，但无论如何。我使用 zsh，但我确信有 bash 和 sh 等价物。

**生成文件：**

```
export ZDOTDIR := ./

SHELL := /usr/bin/env zsh

default:
    f 
```

**.zshenv，与 Makefile 相同的目录：**

```
f () { echo 'CHECK OUT THIS AWESOME FUNCTION!' } 
```

ZDOTDIR 变量使 zsh 在当前目录中查找点文件。然后你只要坚持你想要的`.zshenv`。

```
$ make
f
CHECK OUT THIS AWESOME FUNCTION! 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-06-06T12:26:10.983

**TL;博士：**

在您的生成文件中：

```
SHELL=bash
BASH_FUNC_command%%=() { ... }
export BASH_FUNC_command%% 
```

**长答案**

我在非 make 上下文中使用 bash 做了类似的事情，在这里可以工作。

我在 bash 中声明了我的 shell 函数，然后将它们导出为：

```
export -f function-name 
```

如果从 make 调用相同的 shell 作为子进程（在您的情况下），它们自然是可用的。

例子：

```
$ # define the function
$ something() { echo do something here ; }
$ export -f something

$ # the Makefile
$ cat > Makefile <<END
SHELL=bash
all: ; something
END
$ 
```

试试看

```
$ make
something
do something here
$ 
```

这在环境中看起来如何？

```
$ env | grep something
BASH_FUNC_something%%=() { echo do something here 
```

所以你的问题是如何从 Makefile 中设置环境变量。该模式似乎是 BASH_FUNC_ **function-name** %%=() { **function-body** }

**直接在make内**

那么这对你有什么作用呢？试试这个makefile

```
SHELL=bash
define BASH_FUNC_something-else%%
() {
  echo something else
}
endef
export BASH_FUNC_something-else%%

all: ; something-else 
```

并尝试一下：

```
$ make
something-else
something else 
```

它在 Makefile 中有点难看，但对于**make -n来说并不难看**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-10-08T03:53:13.807

有些东西告诉我你最好过滤 的输出`make -n`，但你问的是可能的：

```
define test
  @echo do some tests with $(1) and $(2); \
  SOMETHING=$(1)_3 ; \
  if [ $$SOMETHING == foo_3 ]; then \
    echo build this way $(1) $(2); \
  else \
    echo build another way $(1) $(2) ; \
  fi
endef

someTarget:
    $(call test,foo,bar)

someOtherTarget:
    $(call test,baz,quartz) 
```

# c++ - 如何在另一种语言的随机函数中复制 C++ rand？

> ID：12774793
> 
> 赞同：1
> 
> 时间：2012-10-08T03:02:13.733
> 
> 标签：c++, math, random, modulus

我在我的公司使用内部语言，他们只有`Random()`返回 0 到 1 之间的浮点数。

我需要移植一段使用的 C++ 代码`rand()`：

```
int b = rand() % (i+1); 
```

我查看了文档，但不确定如何使用 my`Random()`生成一个介于 0 之间的数字，`i+1`这就是上面代码的作用，对吧？

我尝试乘以但没有`i+1`得到`Random()`相同的结果，这就是为什么我不确定我所做的是否正确。

我预计由于不同的随机函数导致结果之间存在差异，但我仍然想确保我正确翻译它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T03:07:38.553

你需要乘以`Random()`和`i`不`i+1`。

C ++返回一个介于and`rand()`之间的整数，但您返回一个介于and之间的浮点数，因此将with的输出相乘并取结果的整数部分将为您提供一个整数，其中给出的是什么。`0``RAND_MAX``Random()``0``1``Random()``i``[0,i]``rand() %(i+1)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T03:14:26.710

Rand() 给你一个介于 0 和 RAND_MAX 之间的数字，在应用 mod 运算符之后，你最终会得到一个介于 0 和 i（包括 i）之间的数字。

要对 Random() 执行相同操作，您需要乘以 ( i+1 )，然后取其底数（向下舍入）：

```
b = floor( Random() * (i+1) ) 
```

这将根据需要为您提供一个从 0 到 i 的数字（包括栅栏柱）。

# php - 如何隐藏通过 $_GET 发布的参数？

> ID：12774794
> 
> 赞同：0
> 
> 时间：2012-10-08T03:02:15.700
> 
> 标签：php, http, url, post, get

如何隐藏变量以便我有一个更清晰的 URL？而不是下面的那个？

```
test.php?id=1&mainid=1 
```

我为 .htaccess 查找了一些东西，但我仍在学习，所以我被卡住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:03:36.543

如果你想这样做，你需要使用`POST`而不是。，就其性质而言，将参数放在 URL 中。`GET``GET`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:07:40.783

Amber 是对的，将您的表单方法更改为 POST。你可以尝试使用

```
<input type="hidden" name="parameter_name" value="value_to_post" /> 
```

如果您不希望它们出现在 URL 中但需要将它们传递以进行处理，则传递变量。但是请记住，查看表单来源的人会看到标签，并且可能会识别您传递的信息，即使是隐藏字段。

如果您发布的数据将用于一般处理而不是用于数据库操作，则 GET 就足够了；无论使用哪种方法，如果变量中的数据将被用于或放入数据库，请确保将其转义以防止 SQL 注入攻击（最常见的是通过使用 GET 方法的表单来利用）。

希望这一切都有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T03:59:06.850

假设您的站点托管在 Apache 服务器上，您可以使用 mod_rewrite 来获得更好看的 URL。

例如：

**RewriteRule /products/([0-9]+) /siteengine/products.php?id=$1**

使用 .httaccess 中的该行，您可以访问任何产品：

example.com/products/N

看看这个[教程](http://www.sitepoint.com/guide-url-rewriting/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T03:49:02.920

使用方法 post 代替 get...

# python - Sympy - 合理化表达式中的所有数值？（就像 Mathematica 的 Rationalize[]）

> ID：12774799
> 
> 赞同：6
> 
> 时间：2012-10-08T03:03:11.330
> 
> 标签：python, fractions, sympy

是否有一种简单的方法来（尝试）合理化给定增量内的表达式中的所有数值，就像`Rationalize[]`在 Mathematica 中一样？

Mathematica 中的一个例子：

```
In[25]:= Rationalize[0.5 x^2 - 3.333333 x, 10^-4]
Out[25]= x^2/2-(10 x)/3 
```

我看到了这个`nsimplify()`功能，但这似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-09T04:04:38.930

我不明白`nsimplify`杀戮是如何结束的。 `nsimplify`完全符合您的要求，因为您可以将 SymPy 表达式传递给它，它将使表达式中的术语合理化

```
>>> print nsimplify(0.5*x**2 - 3.333333*x, tolerance=0.001, rational=True)
x**2/2 - 3333333*x/1000000 
```

（宽容关键字似乎不起作用，我猜这是一个错误）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T07:05:31.100

您可以使用`Fraction.from_float`：

```
>>> from fractions import Fraction
>>> Fraction.from_float(0.5)
Fraction(1, 2) 
```

尽管它看起来不如 Mathematica 聪明：

```
>>> Fraction.from_float(3.33333333)
Fraction(7505999371444827, 2251799813685248) 
```

它实际上只是简单地将浮点数转换为其精确的有理表示（因此不能完全写成浮点数的数字不会被“正确”转换）。

您可以获得更多“人类可读”的限制分母：

```
>>> Fraction.from_float(3.333333333).limit_denominator(10)
Fraction(10, 3) 
```

尽管理解应该设置哪个限制以获得“正确”分数比较棘手，并且由于浮点表示，可能仍然无法获得它。

如果您必须坚持使用`sympy`，我认为您无法避免使用`nsimplify`，这似乎正是为此目的而编写的。

编辑：从 python2.7+ 你可以简单地调用`Fraction(0.5)`而不是使用该`from_float`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-25T16:26:05.163

由于您使用的是 Sympy，您还可以`pslq`从 mpmath 模块访问该函数；这将使您能够找到有理数和 1 之间最相关的线性关系：

```
>>> from mpmath import pslq, mpf
>>> from sympy import sympify
>>> l = pslq([ mpf('.3333333333333333333333', 1])
>>> -l[1]/sympify(l[0])
1/3 
```

# objective-c - 由于 basicAuthentication，didReceiveData 出现了奇怪的问题

> ID：12774803
> 
> 赞同：2
> 
> 时间：2012-10-08T03:04:14.780
> 
> 标签：objective-c, ios, ios5, nsurlconnection, basic-authentication

我在基本身份验证中遇到问题，对此我无法理解出现此问题的原因。在基本身份验证中，我得到响应代码 200，即身份验证成功，但有时我无法在 iOS 应用程序中正确获取响应数据。如果我在浏览器中粘贴请求 url（即使在 iPhone safari 浏览器中也是如此），我总是得到响应。但是为什么我并不总是在 iOS 应用程序中得到响应。

我在 google 和堆栈溢出中遇到了许多其他问题，例如[link1](https://stackoverflow.com/questions/3539745/strange-problem-with-appenddata-in-didreceivedata-method-of-nsurlconnection)，但没有运气。

我的代码如下：

```
//in implemetation file
-(void)basicAuthentication{
    .
    .
    NSURL *url = [NSURL URLWithString:authenticationUrl]; 

        NSMutableString *loginString = (NSMutableString*)[@"" stringByAppendingFormat:@"%@:%@", @"username",@"password"];  

        NSString *authHeader = [@"Basic " stringByAppendingFormat:@"%@", loginString];

        NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
        [request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
        [request setURL:url];
        [request setHTTPMethod:@"GET"]; 
        [request addValue:authHeader forHTTPHeaderField:@"Authorization"];

        NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    myData = [[NSMutableData data] retain];

    }

    //Delegate method called when the connection receives data
    /*
     * Callback, called when ever there is more response data read
     */
    -(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
    {
        [myData appendData:data];
    }

    //in .h file
    @interface TestConnectionManager : NSObject <UIAlertViewDelegate,NSURLConnectionDelegate>{
        id <TestConnectionManagerDelegate>delegate;
        NSMutableData *myData;
    .
    .
    .
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:15:29.120

我曾经面临过类似的问题，并且我得到了一个我要建议的临时解决方案。但我不确定这对您的案件有多大帮助。

我已将接收到的数据的日志消息放入`didReceiveData`方法中。如果你不能把接收到的数据，你可以采取数据长度的日志。

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    NSLog(@"data:%d",[data length]);
    [myData appendData:data];
    NSLog(@"myData:%d",[myData length]);
} 
```

# web-scraping - 在没有 api 的情况下有效地抓取网站？

> ID：12774805
> 
> 赞同：-1
> 
> 时间：2012-10-08T03:04:28.167
> 
> 标签：web-scraping

考虑到大多数语言都具有内置或由其他语言制作的网页抓取功能，这更像是一个一般的网页抓取问题。

我有一个网站，我想从大约 6 个不同的页面中提取信息。这通常不会那么糟糕。不幸的是，这些页面上的信息大约每十秒更改一次，这可能意味着每小时有超过 2000 个查询（这根本不行）。我想到的网站也没有 api。是否有任何可能的有效方法来获取我需要的信息量而不会用请求淹没它们，还是我不走运？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:17:08.657

充其量，当您发出请求时，该站点可能会`HTTP 304 Not Modified`在其标头中向您返回一个 - 表明您不需要下载该页面，因为没有任何变化。如果站点设置为这样做，这可能有助于减少带宽，但仍需要相同数量的请求。

如果有一致的更新时间表，那么至少您知道何时提出请求 - 但您仍然需要*询问*（即：提出请求）以了解哪些信息已更改。

# html - CSS div 和图像不透明度效果

> ID：12774806
> 
> 赞同：0
> 
> 时间：2012-10-08T03:04:33.547
> 
> 标签：html, css, hover

以下代码显示了 div 标签中的图像。

```
<div class='item'>
        <img class='img' src="image1.png" alt="" />
</div> 
```

我正在使用以下 css 为 html 图像代码添加效果：

```
img{
width:50px;
height:50px;
opacity:0.4;
filter:alpha(opacity=40);

}

img:hover{
opacity:1.0;
filter:alpha(opacity=100);
} 
```

我正在使用它在 css 中产生不透明效果。使用此代码，当我将鼠标悬停在图像本身上时，不透明效果效果很好。但是，当我将鼠标悬停在 div 标签上时，我该如何做到这一点，以便对图像产生不透明效果。我希望能够将鼠标悬停在封装图像的项目 div 的任何部分上，以获得对图像的更改不透明度效果。注意仅对图像而不是整个 div 的影响。这可以在css中完成吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T03:06:34.450

改变这个：

```
img:hover{
opacity:1.0;
filter:alpha(opacity=100);
} 
```

至

```
.item:hover img{
opacity:1.0;
filter:alpha(opacity=100);
} 
```

这将改变`img`div 处于`hover`状态时的不透明度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:18:09.233

如果您为此使用jquery，那么我认为这很容易

```
 $('.item').hover(function(){ $('.img').css('opacity','1.0');}, function(){ $('.img').css('opacity','0.4');}); 
```

我假设你知道 jquery。根据 Sitepoint，您不能在没有 href 属性的元素上使用 CSS 的 :hover 伪类。

# c++ - 绘制同一张卡的问题 C++

> ID：12774807
> 
> 赞同：0
> 
> 时间：2012-10-08T03:04:38.163
> 
> 标签：c++, random, playing-cards

我正在为我的 C++ 类创建一个黑桃游戏。我已经解决了大部分问题。但是，当我从牌库中抽一张牌时，它在整个程序运行过程中都是同一张牌。我不知道如何将第二张卡等改回随机卡。任何帮助将不胜感激。另外，我知道大部分代码可能没有正确编写，并且有一些更简单的方法可以编写某些区域，但我必须遵循某些标准。

```
#include <iostream>
#include <string>
#include <ctime>
#include <cstdlib>
#include <algorithm>

using namespace std;

enum eSuit {H, C, D, S};

struct SSingleCard
{
    int iRank;
    eSuit Suits;
};

struct SDeck
{
    SSingleCard aiDeck[52];
    int iCardIndex;
};

struct SPlayerHand
{
    SSingleCard aiHand[13];
    int iTotalHand;
};

struct SCardDisplay
{
    char cSuit;
    char cRank;
};

void showCard(SSingleCard);

int main(int argc, char* argv[])
{

cout << "Welcome! This is a 2-Player Version of Spades! You vs. The Computer!";

cout << endl;

cout << "You draw first!";

cout << endl;
char cKeepCard;

SDeck Deck; 

Deck.iCardIndex = 0;

for(int i = 0; i < 4; i++)
{
    for(int j = 0; j < 13; j++)
    {
        Deck.aiDeck[Deck.iCardIndex].iRank = j + 2;
        Deck.aiDeck[Deck.iCardIndex].Suits = eSuit(i);
        Deck.iCardIndex++;

    }
}

srand( time( NULL ) );

for( int i = 0; i < 52; i++ )
{
    int iRandomNumber = ( rand() % 51) + 1; 
    SSingleCard card = Deck.aiDeck[i];
    Deck.aiDeck[i] = Deck.aiDeck[iRandomNumber];
    Deck.aiDeck[iRandomNumber] = card;

}   

do
{
    SPlayerHand sPlayersHand;
    SPlayerHand sComputersHand;

    Deck.iCardIndex = 0;

    cout << "You drew ";

    showCard(Deck.aiDeck[Deck.iCardIndex]);

    cout << "Keep this card? (Y/N)";
    string sDecision;
    cin >> sDecision;

    if(sDecision == "N" || sDecision == "n")
    {
        sPlayersHand.aiHand[0,1,2,3,4,5,6,7,8,9,10,11,12] = Deck.aiDeck[Deck.iCardIndex];;
        cout << "You discarded ";
        showCard(Deck.aiDeck[Deck.iCardIndex]);
        Deck.iCardIndex++;
    } else if (sDecision == "Y" || sDecision == "y") 
    {
        sPlayersHand.aiHand[0,1,2,3,4,5,6,7,8,9,10,11,12] = Deck.aiDeck[Deck.iCardIndex];
        showCard(Deck.aiDeck[Deck.iCardIndex]);
        Deck.iCardIndex++;
        showCard(Deck.aiDeck[14]);
        Deck.iCardIndex++;
        sComputersHand.aiHand[0] = Deck.aiDeck[Deck.iCardIndex];
        Deck.iCardIndex++;

    } else {
        cout << "That input is invalid. Try again." << endl;
    }
}while (Deck.iCardIndex < 52);

std::cin.sync();
std::cin.get();
return 0;
}

void showCard(SSingleCard card)
{

    if( card.iRank >= 2 && card.iRank <=9 )
        cout << card.iRank;
            switch( card.iRank )
            {
                case 10:
                    cout << "T";
                    break;          
                case 11:
                    cout << "J";                
                    break;
                case 12:
                    cout << "Q";                
                    break;
                case 13:
                    cout << "K";                
                    break;
                case 14:
                    cout << "A";                
                    break;
            }

    if( card.Suits >= 0 && card.Suits <= 4 )
            switch( card.Suits )
            {
                case 0:
                    cout << 'C' << endl;                    
                    break;
                case 1:
                    cout << 'D' << endl;                    
                    break;
                case 2:
                    cout << 'S' << endl;                    
                    break;
                case 3:
                    cout << 'H' << endl;                    
                    break;
            }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:25:38.863

第 85 行：

```
Deck.iCardIndex = 0; 
```

这是*在循环内*。每次你想抽一张牌时，你都会重置索引并从牌组的顶部重新开始。

更一般地说，你应该从简单到复杂，在每一步都进行测试。准备好后，您`Deck`应该先尝试发几张牌，然后再放入交互式选择和其他内容。那么这个错误会更容易被发现。

# ios - iOS 中的多个委托

> ID：12774808
> 
> 赞同：22
> 
> 时间：2012-10-08T03:04:53.217
> 
> 标签：ios, delegates, callback, singleton

我正在制作一个可以为我所有的视图控制器下载东西的对象。该对象是单例实例，并且在下载完成后具有接收数据的回调方法。它还有一个委托属性，以便在下载完成后知道要回调哪个对象。

有多个控制器使用这个共享实例，我的问题是如何回调请求下载的正确视图控制器。

我的方法是使用委托，但问题是由于其他视图控制器也是它的委托，下载对象可能会回调每个对象，这将很难跟踪。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-08T03:15:26.363

我曾参与过人们试图使用多个代表的项目，但这基本上是个坏主意。委托模式是关于一个类和它的委托之间的一对一关系。虽然可以通过切换代表的进出来实现某种程度的多重委托，但它更有可能导致不可预知的行为和错误。

我的建议是改变你对此的看法。在我看来，您有两个选择：

1.  切换到观察者模式，您可以在其中注册多个观察者，您的主类可以与之交互。这在您的观察者都实现相同的协议以及您的主类想要了解观察者并与他们交互的情况下很有用。

2.  广播 NSNotifications 以指示状态更改和事件。这是一种更加解耦的方法，因为主类不需要知道谁在听，也不直接与他们交互。其他人可以在闲暇时开始和停止收到通知。它还有一个优点是您不需要创建或实现单独的协议。相反，您使用 NSNotificationCenter 注册需要了解更改的类，该 NSNotificationCenter 依次为您处理所有通知路由。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-08T03:17:39.533

实际上听起来委托模式可能不是这里最好的方法。

我会调查一下`NSNotificationCenter`。

基本思想是你的单例进行网络连接会发布一个通知（带有类似的东西`postNotificationName:object:userInfo:`），说有新数据可用。在此通知中，您可以传递一个字典对象 ( `userInfo`)，其中包含您已获取的数据，或有关模型的哪些部分包含更新数据的信息。

然后，您的其他视图控制器可以通过调用来注册自己以“观察”这些通知`addObserver:selector:name:object:`。一般来说，当一个 vc 变得可见时，我调用`addObserver`，并且`removeObserver`当它被隐藏或转换出来时。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:46:01.000

委派似乎不是解决这个问题的正确方法。要求请求视图控制器提供一个对象（它自己）和一个选择器供您调用作为完成通知怎么样？当然，您需要一个地方来存储该对象和选择器，直到下载完成。希望您有（或可以创建）一个对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-25T19:39:56.000

虽然我同意这里的大多数答案，但如果您确实想要实现多个委托，您可以声明一个委托数组并向该数组中的所有委托发送消息。如果您的协议具有可选的委托方法，您可以`responds(to aSelector: Selector!) -> Bool`在调用之前安全地检查使用（注意内存管理，因为这些委托将在数组中被强烈引用）。我再次同意多个代表可能是一个糟糕的架构理念，使用块或通知中心会更好地满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-06T05:55:41.017

我建议使用其中一种方式

**观察者：**

当使用要通知其他对象的数据接近原始数据时。例如，当您使用“NSMutableArray”时，您无法通过标准实现模式通知对象之一的更改，至少您需要为自己实现一个那是不可重复使用的

**通知**

当您与目标对象（需要通知的对象）的交互是单向的时。这意味着您不需要从它们那里返回任何确认或其他数据。

**代表**

当每个时间步有一个对象需要通知时。

注意：块用于成功和失败不是广播数据的模式

编辑： [如何创建通知](https://stackoverflow.com/questions/2191594/send-and-receive-messages-through-nsnotificationcenter-in-objective-c)| [多代表问题和实施](https://stackoverflow.com/questions/8999818/multiple-delegates-per-one-object)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-12T06:35:29.233

如果您只有一个其他对象要向其转发消息，那么一种方法对我有用，那就是创建一个`forwardingDelegate`这不会导致难以调试委托排序的问题，也不会不必要地创建对另一个对象的依赖关系。请记住，如果您有很多对象，那么这可能不是最好的方法，它主要用于一个额外的对象，但只要有一个对象接收 SDK 并将其转发到其他对象 [1]。请注意，转发对象所需的每个方法都需要传递它，即使转发对象没有使用它。

例如，如果我需要转发来自 mapView 委托的消息：

```
 - (void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated 
{
    // handle this object here. 

    if ([self.forwardingDelegate respondsToSelector:@selector(mapView:regionDidChangeAnimated:)])
    {
         [self.forwardingDelegate mapView:mapView regionDidChangeAnimated:animated];
    }

    // or handle this object here. 
}

[self.forwardingDelegate mapView:mapView regionDidChangeAnimated:animated]; 
```

转发属性将像这样声明。

```
@property (nonatomic) id<MKMapViewDelegate> forwardingDelegate; 
```

另一个对象将采用该协议，就好像它正在接收原始消息一样。

[1] 多个代表的数组方法可能会变得棘手，因为您无法像其他帖子中提到的那样控制调用代表的顺序。

# php - 如何在 Zend Framework 2 中引导会话

> ID：12774809
> 
> 赞同：10
> 
> 时间：2012-10-08T03:04:53.657
> 
> 标签：php, session, zend-framework2

在 Zend Framework 2 中启动和运行会话的最佳方法是什么？我已经尝试`session_start()`在我的 index.php 文件中进行设置，但是在任何自动加载器被引导之前运行它，导致我的会话中存在不完整的对象。

在 ZF1 中，您可以通过在配置中添加一些选项来初始化会话，但我不知道如何在 ZF2 中执行此操作。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-08T06:19:04.627

如果我对你的理解正确，你想做的就是让你的会话在你的模块中正常工作？假设这是正确的，有两个单独的步骤。

1）创建配置：**module.config.php**

```
return array(
    'session' => array(
        'remember_me_seconds' => 2419200,
        'use_cookies' => true,
        'cookie_httponly' => true,
    ),
); 
```

2) 开始你的会话：**Module.php**

```
use Zend\Session\Config\SessionConfig;
use Zend\Session\SessionManager;
use Zend\Session\Container;
use Zend\EventManager\EventInterface;

public function onBootstrap(EventInterface $evm)
{
    $config = $evm->getApplication()
                  ->getServiceManager()
                  ->get('Configuration');

    $sessionConfig = new SessionConfig();
    $sessionConfig->setOptions($config['session']);
    $sessionManager = new SessionManager($sessionConfig);
    $sessionManager->start();

    /**
     * Optional: If you later want to use namespaces, you can already store the 
     * Manager in the shared (static) Container (=namespace) field
     */
    Container::setDefaultManager($sessionManager);
} 
```

[在\Zend\Session\Config\SessionConfig](https://github.com/zendframework/zf2/blob/master/library/Zend/Session/Config/SessionConfig.php)的文档中找到更多选项

如果您也想存储 cookie，请参阅[此问题](https://stackoverflow.com/questions/12707532/ho-to-use-cookie-in-zend-framework-2)。感谢 Andreas Linden 他最初的回答——我只是复制粘贴他的。

# iphone - CSS 导航菜单 iPad 和 iPhone

> ID：12774810
> 
> 赞同：2
> 
> 时间：2012-10-08T03:04:55.213
> 
> 标签：iphone, css, ipad, navigation, navigationbar

我有一个在大多数桌面浏览器中运行良好的 css 菜单，但是我在让我的下拉菜单在 iPad 和 Iphone 上运行时遇到了问题。这是有问题的网站：http: [//bakersfield.kernhigh.org/](http://bakersfield.kernhigh.org/)

我对 css 和 javascript 很陌生，所以任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:46:43.280

目前，iOS 不支持`:hover`，因此您的导航不会像在桌面上那样在 iOS 中展开。

你考虑过 jQuery Mobile 吗？不过，我只建议您开发单独的移动版本。

否则，你可以使用这个 jquery（你还必须包括 jQuery）：

```
$('nav li').bind('touchstart', function(){
    $(this).addClass('hover');
}).bind('touchend', function(){
    $(this).removeClass('hover');
}); 
```

这将在触摸时添加一个类（悬停），并在移除手指时将其移除。您当然必须根据需要对其进行编辑。我之所以这么说，是因为您说您是 javascript 新手，我不想让您感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T05:50:45.793

下拉菜单可能很糟糕，尤其是让它们与触摸屏设备一起工作，因为你不能在触摸屏上“悬停”。这就是我做下拉菜单的方式，它是纯 CSS，我已经在 chrome、ff、ie7+、safari、iPhone 和多个 Android 上测试过它（当然，你会想要调整颜色和大小）：

HTML

```
<div id="navigation">
    <ul id="nav">
        <li><a href="index.html>Home</a></li>
        <li><a href="#">Drop Down</a> <!--Notice didn't close the li yet->
            <ul>
            <li><a href="link">Drop Down Item</a></li>
            <li...../li>
            etc...
            </ul>
        </li>
        <li><a href="#">Another Drop Down</a></li>
            <ul>
            ...
            </ul
        </li>
    </ul>
</div> 
```

CSS：

```
#nav {
    display: block;
    text-align: center;
    font-size: 1em;
    position: relative;
    height: 3em;
    width: 950px;
    margin-right: auto;
    margin-left: auto;
    list-style-type: none;
}

#nav li {
    float: left;
    display: block;
    width: 75px;
    height: 3em;
    position: relative;
}
#nav li a {
    text-decoration: none;
    display: block;
    height: 1em;
    padding-top: 1em;
    padding-bottom: 1em;
}
#nav li a:hover {
    color: #990000;
    background-color: #999999;
}
#nav li ul  {
    width: 100%;
    display: none;
    z-index: 9999;
    position: absolute;
}

#nav li ul li {
    display: block;
    clear: both;
    width: 100%;
    height: 100%;
    background-color: #B5BDC8;
}
#nav li:hover ul  {
    display: block;
} 
```

所有这一切背后的想法是创建一个列表，然后在其他列表中创建下拉元素....

然后，从那里开始，仅显示主要列表项，然后在悬停时显示下拉菜单（或者在移动设备单击的情况下，通过使主列表项成为“#”的链接，从而创建并激活/悬停状态）...

唯一的问题是使用 display:none 对屏幕阅读器不友好，但是我总是在底部包含对屏幕阅读器友好的站点导航，并且也对 SEO 友好。

[你可以在](http://patrickjc.com/neon)我正在处理的这个网站上看到一个例子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:13:14.413

一般来说，像这样的下拉菜单通常不是移动网站的好习惯。这是因为您不能真正用手指将鼠标悬停在导航项上，而且如果不放大菜单，按下某个项目可能会很困难。

一个解决方案是在移动设备上查看时为您的导航设置不同的 CSS 样式。这是一个很好的资源，可帮助您将导航转换为更适合移动设备：

[http://css-tricks.com/convert-menu-to-dropdown/](http://css-tricks.com/convert-menu-to-dropdown/)

# asp.net-mvc-3 - Code First 实体框架连接字符串

> ID：12774812
> 
> 赞同：17
> 
> 时间：2012-10-08T03:05:50.723
> 
> 标签：asp.net-mvc-3, frameworks, entity, code-first

我的解决方案中有 3 个课程项目。1\. MVC4 项目 2\. 领域 3\. 测试

在 MVC4 项目中，我添加了一个 web.config 文件，其连接字符串为

```
<add name="EfDbContext"  connectionString="Data Source=.;Initial Catalog=SportsStore;Integrated Security=true;" providerName="System.Data.SqlClient"/> 
```

我在继承 DbContext 的域项目中有一个名为 EfDbContext 的类。

当我在浏览器中查看网站时，我收到未找到服务器的错误。

我调试了 EfDbContext 类，发现 Database.Connection.ConnectionString 设置为 \SqlExpress，数据库为 EfDbContext。

这是为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-08T03:25:05.447

当您的上下文类在不同的项目中时，您必须将连接字符串作为上下文的完整命名空间

例如：

```
<add name="YourClassProject.EfDbContext" connectionString="Data Source=.;Initial Catalog=SportsStore;Integrated Security=true;" providerName="System.Data.SqlClient"/>

```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-08T03:35:35.853

您应该使用传递给构造函数的连接字符串名称来创建 DbContext

```
public class UnicornsContext : DbContext
{
    public UnicornsContext()
        : base("EfDbContext")
    {
    }
} 
```

[http://blogs.msdn.com/b/adonet/archive/2011/01/27/using-dbcontext-in-ef-feature-ctp5-part-2-connections-and-models.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/27/using-dbcontext-in-ef-feature-ctp5-part-2-connections-and-models.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T18:38:46.873

最后，我意识到我在Views文件夹中VS创建的web.config文件中添加了连接条目。

我的错。

# javascript - 直通/删除线样式

> ID：12774815
> 
> 赞同：3
> 
> 时间：2012-10-08T03:06:03.563
> 
> 标签：javascript, html, css

我正在一个网站上工作，该网站有一个服务页面，其中包含一些相应定价的项目。

![价格](../Images/190624b3e21624a2d8246c6b0d90439e.png)

由于该网站是一个响应式布局，并且文本会根据正在查看的设备而变化......我正在寻找一种方法来在 HTML、CSS、JavaScript 或类似的东西中创建上述示例，而无需使用图像比如jpg、png等。

我发现很难创建这个，因为在角度上有一条直线，它是一种不同的颜色并控制它的厚度/重量。我能得到的最好的是一条带有其父颜色的细线，任何建议?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T03:22:00.263

可以使用 css3 转换，当然不支持 IE，但您可以使用 png 作为旧浏览器的后备：

**演示：http:** [//jsbin.com/ejoguw/1/edit](http://jsbin.com/ejoguw/1/edit)

```
span { position: relative; }
span:after {
    content: "";
    position: absolute;
    left: 0;
    top: 50%;
    margin-top: -3px; /* height/2 */
    width: 100%;
    height: 7px; /* Adjust */
    background: red;
    -webkit-transform: rotateZ(-10deg);
    -moz-transform: rotateZ(-10deg);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T03:13:39.193

将您的删除线价格包含在 中`<s>`，然后使用 JS 在您的所有标签顶部提升一个绝对定位的 PNG `<s>`（并且，显然，关闭本机删除线样式）。如果 PNG 有类似的东西，`top: 0; right: 0; bottom: 0; left: 0;`那么它会相应地缩放，并且看起来应该不会太糟糕。没有 JS 的用户在语义上会看到同样的东西。

# java - 确定数组是否包含两个等于某个总和的元素？

> ID：12774823
> 
> 赞同：4
> 
> 时间：2012-10-08T03:07:23.903
> 
> 标签：java, performance, algorithm

```
// Checks whether the array contains two elements whose sum is s.
// Input: A list of numbers and an integer s
// Output: return True if the answer is yes, else return False

public static boolean calvalue (int[] numbers, int s){
for (int i=0; i< numbers.length; i++){
    for (int j=i+1; j<numbers.length;j++){
        if (numbers[i] < s){
            if (numbers[i]+numbers[j] == s){
                return true;
                }
            }
        }
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-08T03:32:09.120

这可以在 O(n) 中实现。

1.  从您的列表中创建一个以哈希为基础的集合，使其包含列表的所有元素。这需要 O(n)。
2.  遍历`n`列表中的每个元素，计算`s-n = d`并检查`d`集合中是否存在 。如果`d`存在，则`n+d = s`，所以返回`true`。如果您通过列表但没有找到合适的`d`，请返回`false`。这是通过您的列表单次完成的，每次查找需要 O(1)，所以这一步也需要 O(n)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-08T05:31:01.960

本文其他答案中提到的解决方案以及其他一些答案（例如，使用位图而不是哈希表）都出现在问题的以下重复项和细微变化中：
•[在数组中查找两个元素与 k 的和](https://stackoverflow.com/questions/5630363)，
•[从数组中找到一对元素，其和等于给定数字](https://stackoverflow.com/questions/4720271)，
• [确定集合 s 中是否存在两个元素的和恰好等于](https://stackoverflow.com/questions/2171969)，
• [检查 2 个数组的数字加起来是否为 i](https://stackoverflow.com/questions/4895405)，
•[在数组中找到与给定总和相加的数字对](https://stackoverflow.com/questions/8334981)，
• [设计一种算法来查找数组中所有整数对，其总和为 a](https://stackoverflow.com/questions/1494130)，
• [给定一个未排序数组，找出数组中任意两个总和等于 t 的元素](https://stackoverflow.com/questions/4259515)，
•[一种递归算法，用于在数组中找到两个整数，总和为给定整数](https://stackoverflow.com/questions/9050296)，
•[在未排序数组中找到等于给定总和的 2 个数字](https://stackoverflow.com/questions/9656789)，
•[找到两个元素，使总和等于给定值](https://stackoverflow.com/questions/10055809)，
• 并且，根据谷歌，[还有更多](https://www.google.com/search?num=50&hl=en&q=site:english.stackexchange.com/questions+array+contains+two+elements+which+equal+a+certain+sum?+-newest+-recently#q=site:stackoverflow.com/questions+array+contains+two+elements+value+sum+-newest+-recently&hl=en&prmd=imvns&ei=FmFyUPC2CM_kiwK6joGoCQ&start=10&sa=N&bav=on.2,or.r_gc.r_pw.r_qf.&fp=1491d37767182070&biw=923&bih=579)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-08T03:26:24.253

您可以通过对数组进行排序来解决此问题，然后保留 2 个指向数组开头和结尾的指针，并通过移动两个指针来找到 2 个数字。排序步骤需要 O(nlog n)，第二步需要 O(n)。

正如@Adam 所指出的，从数组中删除重复元素也很好，这样如果数组包含许多重复数字，您可以减少第二步的时间。

至于第二步怎么做：

*   如果当前 2 个数字的总和大于 n，则将末尾的指针向后移动。
*   如果当前 2 个数字之和小于 n，则将开始处的指针向前移动。
*   当两个指针指向同一个元素时停止并拒绝。如果 sum 等于 n，则接受。

为什么这是正确的（我用右端表示大端，左端表示小端）：

*   如果 sum 大于 n，则使用右端没有意义，因为所有大于当前左端的数字都会使其变得更糟。
*   如果 sum 小于 n，则使用左端没有意义，因为所有小于当前右端的数字都会使其变得更糟。
*   在每个步骤中，我们将遍历已删除数字和剩余数字之间的所有可能组合（逻辑上）。最后，我们将穷尽所有数字对之间所有可能的组合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-29T14:20:34.743

这是一个考虑到重复条目的解决方案。它是用 javascript 编写的，并假定数组已排序。

```
var count_pairs = function(_arr,x) {
  if(!x) x = 0;
  var pairs = 0;
  var i = 0;
  var k = _arr.length-1;
  if((k+1)<2) return pairs;
  var halfX = x/2; 
  while(i<k) {
    var curK = _arr[k];
    var curI = _arr[i];
    var pairsThisLoop = 0;
    if(curK+curI==x) {
      // if midpoint and equal find combinations
      if(curK==curI) {
        var comb = 1;
        while(--k>=i) pairs+=(comb++);
        break;
      }
      // count pair and k duplicates
      pairsThisLoop++;
      while(_arr[--k]==curK) pairsThisLoop++;
      // add k side pairs to running total for every i side pair found
      pairs+=pairsThisLoop;
      while(_arr[++i]==curI) pairs+=pairsThisLoop;
    } else {
      // if we are at a mid point
      if(curK==curI) break;
      var distK = Math.abs(halfX-curK);
      var distI = Math.abs(halfX-curI);
      if(distI > distK) while(_arr[++i]==curI);
      else while(_arr[--k]==curK);
    }
  }
  return pairs;
} 
```

享受！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-05T21:03:52.903

在 Java 中

```
 private static boolean find(int[] nums, long k, int[] ids) {
    // walk from both sides towards center.
    // index[0] keep left side index, index[1] keep right side index,
    // runtime O(N)
    int l = ids[0];
    int r = ids[1];
    if (l == r) {
        ids[0] = -1;
        ids[1] = -1;
        return false;
    }
    if (nums[l] + nums[r] == k) {
        ids[0]++;
        ids[1]++;
        return true;
    }
    if (nums[l] + nums[r] < k) {
        ids[0]++;
    } else {
        ids[1]--;
    }
    return find(nums, k, ids);
}

public static boolean twoSum(final int[] nums, int target) {
    // Arrays.sort(nums); //if the nums is not sorted, then sorted it firstly, thus the running time will be O(NlogN)
    int[] ids = new int[2];
    ids[0] = 0;
    ids[1] = nums.length - 1;
    return find(nums, target, ids);
} 
```

测试

```
@Test(timeout = 10L, expected = Test.None.class)
public void test() {
    Assert.assertEquals( twoSum(new int[]{3, 2, 4}, 6), true);
    Assert.assertEquals( twoSum(new int[]{3, 2, 4}, 8), false);
} 
```

IF只回答是不够的，想知道A[i]+A[j]=target的i和j是哪一个

@cheeken 的思路如下，如果有重复号码，取第一个出现的。

```
 public static int[] twoSum2(final int[] nums, int target) {
    int[] r = new int[2];
    r[0] = -1;
    r[1] = -1;
    Set<Integer> set = new HashSet<>(nums.length);
    Map<Integer, List<Integer>> map = new HashMap<>(nums.length);
    for (int i = 0; i < nums.length; i++) {
        int v = nums[i];
        if (set.contains(target - v)) {
            r[0] = map.get(target - v).get(0);
            r[1] = i;
            return r;
        }
        set.add(v);
        List ids = map.get(v);
        if (ids == null) {
            ids = new LinkedList<>();
            ids.add(i);
            map.put(v, ids);

        } else {
            ids.add(i);
            map.put(v, ids);
        }
    }
    return r;
} 
```

测试

```
 int[] r = twoSum2(new int[]{3, 2, 4}, 6);
    Assert.assertEquals(r[0], 1);
    Assert.assertEquals(r[1], 2);
    r =  twoSum2(new int[]{3, 2, 4}, 8);
    Assert.assertEquals(r[0], r[1]);
    Assert.assertEquals(r[1], -1); 
```

# jquery - 检查器中的文本颜色发生变化，但 jQuery UI 中的屏幕上没有

> ID：12774824
> 
> 赞同：0
> 
> 时间：2012-10-08T03:07:37.087
> 
> 标签：jquery, css, jquery-ui, selector

我正在尝试制作一小段脚本，当鼠标悬停在上面时会改变一串文本的颜色。

HTML：

```
<span class="headinglink" id="firstheading"><h1><a href="http://localhost/page.php">Link1</a></h1></span> 
```

JavaScript：

```
$('#firstheading').hover(function () {
        $(this).find('h1').stop().animate({ color: "#53799E" }, 1000);
    }, function() {
    $(this).find('h1').stop().animate({ color: "#F58426" }, 1000);
}); 
```

奇怪的是，当我打开 Chromes 元素检查器时，我实际上可以看到上面元素的 RGB 值发生了变化，例如：

```
<h1 style="color: rgb(245, 132, 38); "> 
```

但元素实际颜色不会改变。就像外部 CSS 仍然在编写上面的内联 CSS 一样。

有人知道如何解决这个问题吗？我应该完全放弃这个元素的外部 CSS 吗？

（PS 我的 jQuery 和 UI 库都链接得很好）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:18:14.430

这里的问题是你试图改变锚的颜色，但你实际上改变了标题的颜色。只需替换`h1`为`a`它应该可以工作。

[这是一个演示这一点的 jsFiddle](http://jsfiddle.net/47beB/)。

**更新**：如果您想知道，这是因为默认情况下锚不继承颜色。（参考：[“a”标签何时不会继承父标签的颜色属性？](https://stackoverflow.com/questions/1144931/when-will-a-tag-not-inherit-color-attribute-of-parent-tag)）

# c# - 无法连接到 SQL Server Express 2012 / 2016 上的本地主机

> ID：12774827
> 
> 赞同：109
> 
> 时间：2012-10-08T03:07:43.760
> 
> 标签：c#, sql-server-2012-express, sql-server-2016-express

我刚刚下载了最新版本的 SQL Express 2012，但无法连接到 localhost。我尝试了 localhost\SQLExpress 和 Windows 身份验证，但它给了我一条错误消息，说无法连接。我在这里错过了什么吗？我以前使用过 SQL Server 2008，连接到 localhost 时从来没有遇到过问题。似乎它甚至找不到它。同样在服务中，我只看到一个 SQL Server VSS 编写器。这是应该的方式吗？还是我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2012-10-08T03:13:49.293

[根据 Aaron Bertand 的说法](https://stackoverflow.com/questions/10624287/cant-connect-to-sql-server-2005-localhost/10625298#10625298)：

1.  您需要验证 SQL Server 服务是否正在运行。您可以通过转到`Start > Control Panel > Administrative Tools > Services`并检查服务 SQL Server ( `SQLEXPRESS`) 是否正在运行来执行此操作。如果没有，请启动它。

2.  当您在服务小程序中时，还要确保服务[SQL 浏览器](https://technet.microsoft.com/en-us/library/ms181087(v=sql.105).aspx)已启动。如果没有，[请启动它](https://www.tenforums.com/tutorials/4499-start-stop-disable-services-windows-10-a.html)。

3.  您需要确保允许 SQL Server 使用 TCP/IP 或命名管道。`Start > Programs > Microsoft SQL Server 2012 > Configuration Tools`您可以通过在（或`SQL Server Configuration Manager`）中打开 SQL Server 配置管理器来打开这些，并[确保启用 TCP/IP 和命名管道](https://www.blackbaud.com/files/support/infinityinstaller/content/installermaster/tkenablenamedpipesandtcpipconnections.htm)。如果在开始菜单中没有找到 SQL Server 配置管理器，您可以手动启动 MMC 管理单元。根据您的版本检查管理单元的路径[SQL Server 配置管理器。](https://docs.microsoft.com/en-us/sql/relational-databases/sql-server-configuration-manager)

    [![SQL Server 配置管理器](../Images/23d3437d4871e4dd960939c6c9e6f503.png)](https://i.stack.imgur.com/dPM5j.png)

4.  验证您的 SQL Server 连接身份验证模式是否与您的连接字符串匹配：

    *   如果您使用用户名和密码进行连接，则需要将 SQL Server 配置为接受“SQL Server 身份验证模式”：

        ```
        -- YOU MUST RESTART YOUR SQL SERVER AFTER RUNNING THIS!
        USE [master]
        GO
        DECLARE @SqlServerAndWindowsAuthenticationMode INT = 2;
        EXEC xp_instance_regwrite
          N'HKEY_LOCAL_MACHINE',
          N'Software\Microsoft\MSSQLServer\MSSQLServer',
          N'LoginMode',
          REG_DWORD,
          @SqlServerAndWindowsAuthenticationMode;
        GO 
        ```

    *   如果您使用“Integrated Security=true”（Windows 模式）进行连接，并且仅在调试 Web 应用程序时出现此错误，则需要[将 ApplicationPoolIdentity 添加为 SQL Server 登录名](https://blogs.msdn.microsoft.com/ericparvin/2015/04/14/how-to-add-the-applicationpoolidentity-to-a-sql-server-login/)：
5.  否则，运行`Start -> Run -> Services.msc`如果是，它是否正在运行？

如果它没有运行，那么

听起来你没有安装所有东西。启动安装文件并选择“新安装或向现有安装添加功能”选项。从那里您应该能够确保已安装数据库引擎服务。

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2015-12-28T13:07:05.007

转到开始 -> 程序 -> Microsoft SQL ServerYYYY -> 配置工具 -> SQL Server YYYY 配置管理器或运行“SQLServerManager12.msc”。

确保在客户端协议下启用了 TCP/IP。

然后进入“SQL Server 网络配置”并双击 TCP/IP。单击“IP 地址”选项卡并滚动到底部。在“IP All”下删除 TCP 动态端口（如果存在）并将 TCP 端口设置为 1433。单击“确定”，然后返回“SQL Server 服务”并重新启动 SQL Server 实例。现在您可以通过 localhost 进行连接，至少我可以。

[![在此处输入图像描述](../Images/fc5e989a30f4f16b0f1f283e070601ce.png)](https://i.stack.imgur.com/ogkmm.png)

请注意，从其他应用程序连接时当然也会发生此错误。普通 C# Web 应用程序`Web.config`连接字符串的示例：

```
<connectionStrings>
    <add name="DefaultConnection" connectionString="server=localhost;database=myDb;uid=myUser;password=myPass;" />
</connectionStrings> 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-04-05T11:27:03.873

在 SQL SERVER EXPRESS 2012 中，您应该使用“(localdb)\MSSQLLocalDB”作为数据源名称，例如，您可以使用这样的连接字符串

```
Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=master;Integrated Security=True; 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2018-01-25T11:07:20.947

[首先尝试Ravindra Bagale](https://stackoverflow.com/a/12774856/1429387)提供的最流行的解决方案。

如果您从 localhost 到数据库的连接仍然失败并出现类似于以下的错误：

> 无法连接到 SQL Server 数据库。错误：与主机 [IP 地址] 端口 1433 的 TCP/IP 连接失败。错误：“连接被拒绝：连接。验证连接属性。确保 SQL Server 实例正在主机上运行并在端口上接受 TCP/IP 连接。确保与端口的 TCP 连接未被防火墙阻止。”

1.  打开 SQL Server 配置管理器。
2.  展开相关服务器实例的 SQL Server 网络配置。
3.  双击“TCP/IP”。
4.  在“协议”部分下，将“启用”设置为“是”。
5.  在“IP 地址”部分下，在“IP All”下设置 TCP 端口（默认为 1433）。
6.  在“IP 地址”部分下，找到 IP 地址为 127.0.0.1（对于 IPv4）和 ::1（对于 IPv6）的子部分，并将“启用”和“活动”设置为“是”，并将 TCP 端口设置为 1433。

    [![TCP/IP 属性](../Images/9cbe6b8014fcbe32991a24f39b8e267d.png)](https://i.stack.imgur.com/NU0r8.png)

7.  转到`Start > Control Panel > Administrative Tools > Services`，然后重新启动 SQL Server 服务 ( `SQLEXPRESS`)。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-03T21:35:54.263

我有一个类似的问题 - 也许我的解决方案会有所帮助。我刚刚安装了 MSSQL EX 2012（默认安装）并尝试连接 VS2012 EX。没有喜悦。然后我查看了服务，确认 SQL Server (SQLEXPRESS) 确实在运行。

但是，我看到另一个名为 SQL Server Browser 的有趣服务被禁用。我启用它，触发它，然后能够在 VS2012 EX 的新连接中检索服务器名称并连接。

奇怪的是，他们会禁用 VS 连接所需的服务。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-10-28T06:13:33.620

首先检查 SQL Server 服务是运行还是停止，如果停止就启动它，这样做..只需按照以下步骤操作。

1.开始->运行->Services.msc

[![在此处输入图像描述](../Images/40214081274ff8e5fa9bf61b162df836.png)](https://i.stack.imgur.com/AM9yT.png)

2.  转到服务面板中的标准选项卡，然后搜索 SQl Server(SQL2014)

> “SQL2014”是我给的，在你的情况下它可能是另一个名字

[![在此处输入图像描述](../Images/c0b1d399e43669f01043049c51565fa1.png)](https://i.stack.imgur.com/OkPeJ.png)

就是这样，一旦你启动 SQL 服务，你就可以连接本地数据库了。

希望它会帮助某人。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-10-24T15:19:59.347

我的所有服务都按预期运行，但我仍然无法连接。

我必须为我的 SQL Server Express 协议更新*SQL Server 配置管理器*中的 TCP/IP 属性部分，并将*IPALL*端口设置为 1433，以便按预期连接到服务器。

[![在此处输入图像描述](../Images/21ee49a8f1ec7a463090a17a6896cc31.png)](https://i.stack.imgur.com/gsTOo.png)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-01-16T12:32:02.937

尝试从 Windows 身份验证更改为混合模式

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-06-03T04:02:28.737

**完成@Ravindra Bagale**提到的步骤后，请尝试此步骤。 `Server name: localhost\{Instance name you were gave}`

[![在此处输入图像描述](../Images/dc021c6d3601e729d2da11186511a95c.png)](https://i.stack.imgur.com/9fhn2.png)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-11-13T16:54:35.463

我的问题是我没有指定`.\`. 我只是指定实例的名称：

*   不工作：`SQL2016`
*   工作：`.\SQL2016`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-30T19:52:28.060

这很奇怪，我有类似的问题。我下载了带有工具的 SQL 2012 Express 包，但没有安装数据库引擎。

我从 MS 站点下载了另一个，这个安装了数据库引擎。重新启动后，服务已列出并准备就绪。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-09-19T15:23:59.750

我遇到了同样的问题，我发现这是在我为我的 SQL 2012 安装更新后发生的。为我解决的问题是进入程序和功能并对其进行修复。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-04-24T13:00:56.287

我的情况

*   SQL Server Management Studio中的空实例名称>选择您的数据库引擎>鼠标右键>属性（服务器属性）>链接视图连接属性>产品>实例名称为空

*   数据源=.\SQLEXPRESS 不起作用 => 在 web.config 中使用 localhost（见下文）

**解决方案**：在 web.config

xxxxxx = 不带 .mdf 的数据库名称 yyyyyy = VS2012 数据库资源管理器中的数据库名称

您可以强制使用 TCP 而不是共享内存，方法是在连接字符串中为服务器名称添加前缀 tcp: 或使用 localhost。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.110%29.aspx)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-12-10T21:44:34.873

尝试将拥有该服务的用户更改为本地系统或使用您的管理员帐户。

在服务下，我将服务 SQL Server (MSSQLSERVER) 登录从 NT Service\Sql... 更改为本地系统。右键单击该服务并转到登录选项卡并选择单选按钮本地系统帐户。如果更合适，您也可以强制其他用户也运行它。

# android - 监控 Android 中的数据活动

> ID：12774834
> 
> 赞同：2
> 
> 时间：2012-10-08T03:10:07.617
> 
> 标签：android, monitor, flow

我正在尝试在我正在帮助构建的 ROM 中制作一个内置的 Juice Defender 选项。我有一堆我正在寻找的东西，但我找不到一个电话来查看数据是否正在使用中。

这个想法是如果数据正在流动（下载或其他），那么我不想中断活动。我想做类似的事情

*   等待屏幕关闭
*   查看数据是否在流动
*   如果是，请等待 30 秒并再次检查
*   如果否，请等待 10 秒并关闭数据

# android - Android Simple Mute Media Volume，但按钮然后应用程序崩溃......？

> ID：12774835
> 
> 赞同：1
> 
> 时间：2012-10-08T03:10:08.647
> 
> 标签：android

我正在尝试使媒体音量静音，这似乎可以工作，但是当按下控制静音开/关的按钮时它会崩溃。

这是我的代码：

```
SharedPreferences getPrefs = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
                boolean cmute = getPrefs.getBoolean("mute", false);

                if (cmute == false){
                    // mMediaPlayer.setVolume(0,0); <-- this causes crash of button/app, but works until then muting media volume =/                
                    Editor editor = getPrefs.edit();
                    editor.putBoolean("mute", true);
                    editor.commit();
                    Editor editor2 = getPrefs.edit();
                    editor.putBoolean("notice", true);
                    editor.commit();
                    SharedPreferences getPrefs2 = PreferenceManager.getDefaultSharedPreferences(getBaseContext());
                    View btn = findViewById(R.id.mute);
                    btn.setBackgroundResource(R.drawable.sound);

                } 
```

所以，我需要一个简单的行，我可以在这个布尔值的 IF 语句中使用它来静音媒体音量并且不会崩溃按钮。

非常感谢。

# c++ - 使用 std::packaged_task (VS11) 时，std::future 仍会延迟

> ID：12774838
> 
> 赞同：9
> 
> 时间：2012-10-08T03:10:41.440
> 
> 标签：c++, c++11, visual-studio-2012, future, packaged-task

似乎除非你调用`std::async`a ，否则`std::future`永远不会设置为任何其他状态，`future_status::deferred`除非你调用`get`or `wait`。`wait_for`&`wait_until`将继续不阻塞并返回，`future_status::deferred`即使任务已经运行并存储了结果。

这是一个例子：

```
#include <future>

void main()
{
    auto func = []() { return 5; };
    auto asyncFuture = std::async(std::launch::async, func);
    auto status = asyncFuture.wait_for(std::chrono::seconds(0));   // timeout (1)

    auto deferredFuture = std::async(std::launch::deferred, func);
    status = deferredFuture.wait_for(std::chrono::seconds(0));     // deferred (2)

    std::packaged_task<int()> task(func);
    auto packagedTaskFuture = task.get_future();
    status = packagedTaskFuture.wait_for(std::chrono::seconds(0)); // deferred (2)

    task();

    status = packagedTaskFuture.wait_for(std::chrono::seconds(0)); // deferred (2)
    packagedTaskFuture.wait();
    status = packagedTaskFuture.wait_for(std::chrono::seconds(0)); // ready (0)
} 
```

我没有当前的 C++11 标准，但 30.6.9 中的标准草案说，当 a`packaged_task`运行时，它应该将结果存储在未来的共享状态中。目前还不清楚这是否包括设置预期`wait_until`/`wait_for`行为。

`async`VS11 在此区域的调用行为之前存在问题：http: [//social.msdn.microsoft.com/Forums/hu/parallelcppnative/thread/4394f2c1-0404-40df-869b-f4fc36fc035c](http://social.msdn.microsoft.com/Forums/hu/parallelcppnative/thread/4394f2c1-0404-40df-869b-f4fc36fc035c)

此外，其他编译器似乎在这方面存在问题：[C++ 11 future_status::deferred not working](https://stackoverflow.com/questions/12137283/c-11-future-statusdeferred-not-working)

任何可能更了解该标准的人：这是预期的行为还是在 VS11 中的实施存在问题？

更新：我不知何故错过了这个报告：[http ://connect.microsoft.com/VisualStudio/feedback/details/761829/c-11-unexpected-behavior-for-std-future-wait-for-and-std-打包任务](http://connect.microsoft.com/VisualStudio/feedback/details/761829/c-11-unexpected-behavior-for-std-future-wait-for-and-std-packaged-task)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-08T06:50:42.177

这是 VS2012 的问题。这也不是唯一的问题 --- 他们对 C++11 线程库的实现有几个错误。[我在我的博客上](http://www.justsoftwaresolutions.co.uk/news/just-thread-v1.8.0-released.html)写了一些。

# scala - Scala：传递没有参数的函数参数

> ID：12774840
> 
> 赞同：1
> 
> 时间：2012-10-08T03:11:08.880
> 
> 标签：scala, lazy-evaluation

[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)或[回调](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)是 Java 中广泛使用的设计模式。然而，用匿名类实现回调接口是一件很痛苦的事情，因此在 Scala 中为这些回调类的实现引入隐式转换是很常见的。例如，Runnable 接口的隐式转换为：

```
implicit def func2Runnable[F](f: => F): Runnable =
  new Runnable {
    def run() {
      f
    }
  } 
```

并假设有一些监听器注册表：

```
def addMyListener(m: Runnable) {
  // mock function for test
  for (i <- 1 to 2) {
    m.run()
  }
} 
```

然后隐式转换神奇地压缩了我的代码：

```
addMyListener(println("Printed twice")) 
```

**问题：**

当我将多行代码块传递给 addMyListener() 时，只有最后一行代码被传递给它：

```
addMyListener {
  println("This line is printed once")
  println("Only this is printed twice")
} 
```

**已知的解决方法：**

我在转换函数上加了一个括号：

```
implicit def func2Runnable[F](f:() => F): Runnable =
  new Runnable {
    def run() {
      f()
    }
  } 
```

但是当我们使用它时它很冗长：

```
addMyListener(() => println("Printed twice"))
addMyListener {() =>
    println("This line is printed twice")
    println("This is also printed twice")
} 
```

有没有更清洁的解决方案来暴露这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:47:57.740

好的，这里有一些值得深思的地方。我添加了第二个隐式转换，但这次必须显式触发。顺便说一句，它仅与解决方法之前的部分有关。

```
implicit def func2Runnable2(f: => Unit) = new {
  def runnable = new Runnable {
    def run() {
      f
    }
  }
} 
```

在 REPL 中：

```
scala> addMyListener ({
     |   println("This line is printed once")
     |   println("Only this is printed twice")
     | }.runnable)
This line is printed once
Only this is printed twice
This line is printed once
Only this is printed twice 
```

所以，我的理论是第一个隐式的转换只发生在最后一行。所以它会脱糖

```
addMyListener ({
  println("This line is printed once")
  func2Runnable(println("Only this is printed twice"))
}) 
```

而不是预期的：

```
addMyListener(func2Runnable{
  println("This line is printed once")
  println("Only this is printed twice")
}) 
```

让我们检验这两个假设：

```
scala> addMyListener ({
     |   println("This line is printed once")
     |   func2Runnable(println("Only this is printed twice"))
     | })
This line is printed once
Only this is printed twice
Only this is printed twice

scala> addMyListener(func2Runnable{
     |   println("This line is printed once")
     |   println("Only this is printed twice")
     | })
This line is printed once
Only this is printed twice
This line is printed once
Only this is printed twice 
```

耶！正如我想展示的那样：）

对于这个问题的更多思考，现在请注意，参数 Runnable 本身就是按名称命名的：

```
def addMyListener2(m: => Runnable) {
  // mock function for test
  for (i <- 1 to 2) {
    m.run()
  }
}

scala> addMyListener2 ({
     |   println("This line is printed once")
     |   println("Only this is printed twice")
     | })
This line is printed once
Only this is printed twice
This line is printed once
Only this is printed twice 
```

推测正在发生的事情： print(...) 是 Unit，两者都是。{ prints-inside } 也是 Unit。所以它只是将 func2Runnable 的隐式转换应用于块的最后一个参数，而不是块本身。

现在看到这个的正确方法是使用`scala -Xprint:namer`（可能是 typer 而不是 namer）启动一个 REPL 会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T00:57:39.907

**自我回答：**

我发现两种类型的隐式转换可以同时应用：

```
implicit def lazy2Runnable[F](f: => F): Runnable =
  new Runnable {
    def run() {
      f
    }
  }

implicit def func2Runnable[F](f: () => F): Runnable =
  new Runnable {
    def run() {
      f()
    }
  } 
```

虽然在我们编写多行代码块时需要注意一点，但生成的代码还是有一点改进：

```
addMyListener(println("Printed twice"))
addMyListener(() => {
  println("This line is printed twice")
  println("This is also printed twice")
}) 
```

# java - Java中的函数过程

> ID：12774842
> 
> 赞同：0
> 
> 时间：2012-10-08T03:11:20.597
> 
> 标签：java

创建一个程序，要求用户使用 for 循环输入 3 个数字，然后测试这些数字并按升序显示。

样本输入：5 2 7

样本输出：2 5 7

我坚持测试程序。我不知道如何测试这些数字，因为保存这些数字的变量只是一个变量并且在 for 循环内

这是我的示例代码：

```
import javax.swing.JOptionPane;
public class ascending
{
  public static void main(String args[])
   {

 for(int x= 0; x<3;x++)
 {
  String Snum = JOptionPane.showInputDialog("Enter a number");
  int num = Integer.parseInt(Snum);
 }

 <Here comes the program wherein I will test the 3 numbers inputted by the user and
   display in ascending order. I don't know where to start. :'( > 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:15:17.063

您需要将号码存储在某处。整数数组是一个好的开始，尽管您可以使用 ArrayList 之类的集合。

```
int allNums[] = new int[3]; 
```

然后您的循环将数字存储到数组中：

```
for(int x= 0; x<3;x++)
{
   String Snum = JOptionPane.showInputDialog("Enter a number");
   allNums[x] = Integer.parseInt(Snum);
} 
```

然后你对数组进行排序并打印它。

一些明显的改进：

*   摆脱神奇的数字 3：`static final const int NUM_ITEMS = 3;`
*   赶上`NumberFormatException`parseInt

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:34:06.357

这是一种愚蠢的方法：

```
 static {
        int v1,v2,v3;
        for (int i=0;i<3;i++) {
            if (i==0) {v1=Integer.parseInt(s);}
            if (i==1) {v2=Integer.parseInt(s);}
            if (i==2) {v3=Integer.parseInt(s);}
        }
        if ( v1 < v2 && v2 < v3 ) { System.out.format("%d %d %d", v1,v2,v3); }
        if ( v1 < v3 && v3 < v2 ) { System.out.format("%d %d %d", v1,v3,v2); }
        // 1 2 3
        // 1 3 2
        // 2 1 3
        // 2 3 1
        // 3 1 2
        // 3 2 1
    } 
```

# r - R ksvm kernlab 未使用的参数

> ID：12774845
> 
> 赞同：0
> 
> 时间：2012-10-08T03:11:47.133
> 
> 标签：r, kernlab

我正在学习如何使用 kernlab 的 ksvm 进行分类。我玩过一些例子（即虹膜等）。但是，当我尝试使用我的数据时，我不断收到错误消息：

rbfdot 中的错误（长度 = 4，lambda = 0.5）：未使用的参数（长度 = 4，lambda = 0.5）

如果有人能指出出了什么问题，或者向我指出适当的文件，我真的很感激。

附件是我的数据文件。

[数据文件： http](http://www.mediafire.com/view/?todfg2su1qmw18n) ://www.mediafire.com/view/? todfg2su1qmw18n

我的 R 代码：

```
id = "100397.txt"
dat <- read.table(id, header=FALSE,sep = ",")
n = nrow(dat) # number of data points
numCol = ncol(dat)
dat <- dat[,-c(numCol)] ### get rid of the last column because it is not useful.
numCol = ncol(dat) ### update the number of columns

ntrain <- round(n*0.8) # get 80% of data points for cross-validation training

tindex <- sample(n,ntrain) # get all indices for cross-valication trainining

xtrain <- dat[tindex,-c(numCol)] # training data, not include the class label

xtest  <- dat[-tindex,-c(numCol)] # test data, not include the class label

ytrain <- dat[tindex,c(numCol)] # class label for training data

ytest  <- dat[-tindex,c(numCol)] # class label for testing data

nrow(xtrain)

length(ytrain)

nrow(xtest)

length(ytest)

### SVM function ###
svp <- ksvm(xtrain, ytrain, type="C-bsvc", kernel='rbf', C = 10, prob.model=TRUE) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T05:21:44.550

查看 的文档`rbfdot`，该函数没有输入参数，`length`也没有`lambda`，这正是错误消息所说的。核函数`stringdot`确实有这些参数，但没有`sigma`参数。要生成内核，请更仔细地查看[文档](http://rss.acs.unt.edu/Rdoc/library/kernlab/html/dots.html)。

# google-maps - 自定义 Googlemap Store Locator 插件中的面板

> ID：12774846
> 
> 赞同：0
> 
> 时间：2012-10-08T03:12:00.330
> 
> 标签：google-maps, google-maps-api-3, google-maps-styled

在另一个线程上，我正在从 Google 开发人员的商店定位器插件中为面板寻找一些自定义帮助

[如何从谷歌开发者自定义 Store Locator 插件的侧面板](https://stackoverflow.com/questions/12719036/how-to-customize-the-sidepanel-of-store-locator-plugin-from-google-developer/12730592#12730592)

我需要进一步定制，例如： 1\. 我想为要订购的商店列表制作无序列表。2.想把更多的信息和细节放在清单上。3.想要得到每个商店与搜索位置的距离。

你能建议我如何推进吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T04:12:34.513

我想我明白了：在我使用的 DS 上：

```
store.getInfoPanelItem = function()
    {

      if (!store) {
        return ;
      }
      var details = store.getDetails();

      var html = ['<li class="store"><div class="store"><div class="title">', details.title,
      '</div><div class="address">', details.address, '</div>',
      '<div class="email">', details.email, '</div></div></li>'].join('');

      return $(html)[0];
    } 
```

但是现在当我点击地图点时，列表项没有被选中！

# java - 从基类设置派生类成员

> ID：12774853
> 
> 赞同：1
> 
> 时间：2012-10-08T03:13:36.587
> 
> 标签：java, design-patterns

这是一个人为的例子：（实际代码中使用的命名方案太混乱了）

我有一个类父亲，它扩展了祖父，它是无法更改的 3rdparty 库的一部分。我还有一些扩展父亲的类；以儿子为例。祖父有一个如下所示的构造函数：

```
public Grandfather(String name) {...} 
```

这个构造函数中实际发生的事情并不重要。重要的是，无论它在做什么也必须由所有派生类完成，因此调用`super(String)`是每个派生类的构造函数的强制性第一行。这里的含义是，Grandfather 的所有后代的构造函数，无论距离多远，都必须始终调用 super（或调用 super 的链式构造函数）作为其第一行。

在我的父亲实现中，我有一个`configure(String xml)`解析 xml 文件并使用反射在实例内设置各种参数的方法。其中一些参数在 Grandfather 中，有些在 Father 中，有些甚至可能在 Son 中。每次实例化从父亲派生的类时，都需要运行配置。我最初的想法是`configure(String)`像这样简单地添加对我的父亲构造函数的调用：

```
public Father(String name, String xml) extends Grandfather {
  super(name);
  configure(xml);
} 
```

这适用于 Granfather 和 Father 实例化，但在 Son 实例化时会崩溃，原因与从构造函数中调用可覆盖方法通常会崩溃的原因基本相同。考虑以下 Son 实现：

```
public class Son extends Father {
  private String occupation = "unknown";

  public Son(String name, String xml) {
    super(name, xml);
  }
} 
```

这是发生的事情：

1.  一个新的 Son 使用`new Son(String, String)`.
2.  在`Son(String, String)`调用内`super(String, String)`进行，即。`Father(String, String)`.
3.  内`Father(String, String)` `configure(String)`被称为。
4.  `configure(String)`找到一个`<occupation>`元素并使用反射调用`setOccupation("Coal Miner")`.
5.  `Father(String, String)`退出并执行返回到`Son(String, String)`.
6.  在 Son 退出之前，所有提供默认值的成员都已设置（这在 Java 构造函数的末尾内联）
7.  占用被内联覆盖并设置为“未知”。

我想避免重复调用，因为它可能是一个昂贵的操作，所以在每个构造函数的末尾`configure(String)`添加一个调用是不可行的。`configure(String)`（这将导致`configure(String)`Son 实例被调用两次，n 代后代被调用 n 次。

我还想避免`configure(String)`在实例化父亲或其任何后代之后手动调用：

```
Son s = new Son(...);
s.configure(...); 
```

工厂方法在这里可以很好地工作，但由于使用 Grandfather 实例的方式，这是不可能的。长话短说，我几乎从来都不是实例化这些类并且零访问代码的人。

或者换句话说，执行以下操作：

```
Father f = new Father(...); 
```

将导致`configure(...)`被父亲构造函数调用一次，同时：

```
Son s = new Son(...); 
```

将导致`configure(...)`Son 构造函数只调用一次。

鉴于这些限制，任何人都可以想出一种方法来实现我的目标还是我搞砸了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:57:08.877

从您的陈述看来，您似乎并不真正反对在 ctor 末尾显式调用 configure。

那么，这种扭曲可以接受吗？

```
class GrandFather {
  GrandFather(String name, boolean configure) {
    // some init
    if (configure) {
      configure(name);
    }
  }

  GrandFather(String name) {
    this(name, true);
  }
}

class Father {
  Father(String name, boolean configure) {
    super(name, false);

    // some init
    if (configure) {
      configure(name);
    }
  }

  Father(String name) {
    this(name, true);
  }
}

class Son {
  Son(String name, boolean configure) {
    super(name, false);

    // some init
    if (configure) {
      configure(name);
    }
  }

  Son(String name) {
    this(name, true);
  }
} 
```

这个想法是，每个继承的类在其构造函数中显式调用配置，但它要求父类不要配置自己。

# python - 使用python从twitter的用户名中获取用户id

> ID：12774855
> 
> 赞同：4
> 
> 时间：2012-10-08T03:13:41.423
> 
> 标签：python, twitter

我正在尝试使用 python 获取 twitter 用户的用户 ID

```
import twitter
twitter_api = twitter.Twitter(domain='api.twitter.com', api_version='1',auth = twitter.oauth.OAuth(ACCESS_KEY, ACCESS_SECRET,
CONSUMER_KEY, CONSUMER_SECRET))
usr = twitter_api.api.GetUser(SCREEN_NAME)
print usr.name 
```

不行，调试信息也没有多大帮助，网上也没找到更多的资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T03:37:34.873

您已实例化的`twitter_api`对象将对其执行的所有函数调用隐式转换为 API URL 的路径，并将所有关键字参数转换为 API 参数。例如：

```
twitter_api.statuses.user_timeline()
# ^- this converts to "api.twitter.com/1/statuses/user_timeline.json"

twitter_api.statuses.user_timeline(user_id="a")
# ^- this converts to "api.twitter.com/1/statuses/user_timeline.json?user_id=a"

twitter_api.statuses.user_timeline(foo)
# ^- this breaks - "foo" is not a key/value pair, and cannot be sent 
```

因此，您尝试调用 URL `1/api/GetUser.json`- 并且还向它传递了一个参数，它不知道如何处理。试试这个：

```
import twitter
t = twitter.Twitter(auth=twitter.OAuth(ACCESS_KEY, ACCESS_SECRET, CONSUMER_KEY, CONSUMER_SECRET))
t.users.lookup(screen_name=SCREEN_NAME)
# returns the user object 
```

# ios - Xcode 失去了它的代码意义？

> ID：12774857
> 
> 赞同：1
> 
> 时间：2012-10-08T03:13:52.670
> 
> 标签：ios, xcode, codesense

由于某种原因，我的 Xcode 项目无法识别（自动更正）我的代码。除了 NSStrings（红色）之外，它不会对文本进行颜色编码。它不会像以前那样自动填充内容（例如，如果我输入“CGR”，它会输入“CGRectMake:(x,y,width,height)”，但现在不会了。我不记得这是从什么时候开始的正在发生，但它在我的其他项目中确实有效。有什么想法吗？

顺便说一句，删除派生数据并不能解决它。创建新项目和导入文件也不会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:56:33.417

这个问题发生在我身上，我给你3个解决方案，你可以试试。

解决方案1：

1.  打开xcode；
2.  打开管理器（Xcode-> 窗口-> 管理器-> 项目）
3.  选择您的项目并右键单击，然后从组织中删除...
4.  关闭 xcode 并重新打开您的项目。

解决方案2：

1.  打开你的项目。
2.  Targets -> Building Settings，设置 Precompile Prefix Header = NO；</li>
3.  重复解决方案 1（有时 Precompile Prefix Header 会出现问题）。

解决方案3：

1.  使用命令行。
2.  cd YourProject.xcode
3.  删除 project.pbxproj 以外的项目

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T00:25:26.993

哈，想通了！出于某种原因，我的项目被拆分在不同的文件夹中。IE 它是一个包含所有图像的文件夹，另一个是 ViewController.h，另一个是 ViewController.m。将所有文件移动到层次结构中的最高文件夹，一切正常:) 感谢您的所有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:49:28.583

我想您的文本编辑偏好太容易出错了？命令逗号 -> 文本编辑。

# profiling - Go profiler 的输出令人困惑（而且不正确？）

> ID：12774861
> 
> 赞同：3
> 
> 时间：2012-10-08T03:15:19.127
> 
> 标签：profiling, go

我有一个我正在尝试分析的 Go 二进制文件，我得到了令人惊讶的结果。该代码在 中具有以下（截断）`main.go`，其余代码在包中`monte`：

```
package main

import (
  "monte"
  "runtime/pprof"
)

var cpuprofile = flag.String("cpuprofile", "", "write cpu profile to file")

func main() {
  flag.Parse()
  if *cpuprofile != "" {
    f, err := os.Create(*cpuprofile)
    if err != nil {
      log.Fatal(err)
    }
    pprof.StartCPUProfile(f)
  }

  monte.ExpensiveOperation()

  pprof.StopCPUProfile()
} 
```

我用 构建我的可执行文件`go build src/main.go`，然后用`./main -cpuprofile=monte.prof`. 当我检查输出时`go tool pprof main monte.prof`，我得到以下输出：

```
(pprof) top10 --cum
Total: 346 samples
     280  80.9%  80.9%      343  99.1% time.Time.Format
       0   0.0%  80.9%      341  98.6% runtime.interhash
       0   0.0%  80.9%      341  98.6% runtime.main
       0   0.0%  80.9%      251  72.5% strconv.Unquote
      13   3.8%  84.7%       31   9.0% strconv.roundShortest
      11   3.2%  87.9%       18   5.2% strconv.fmtE
       9   2.6%  90.5%        9   2.6% runtime.markallocated
       1   0.3%  90.8%        8   2.3% math/rand.Float64
       2   0.6%  91.3%        8   2.3% runtime.FixAlloc_Free
       7   2.0%  93.4%        8   2.3% time.nextStdChunk 
```

累积时间最长的函数是`time.Time.Format`，这对我来说似乎是错误的（不应该是`main`吗？）并且根本没有提及`monte`，尽管“昂贵的操作”需要大约 10 秒才能完成，时间充裕让采样器看到它。如果我将`--focus=monte`标志传递给`go tool pprof`，则根本不会显示任何样本。我假设我在某处遗漏了一些标志；有人有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T17:21:47.503

你的`main`包没有编译，你也没有为你的`monte`包提供源代码。因此，我们无法重现您的结果。这是调试的第一步。

这是一些有效的源代码和结果。

```
package monte

func ExpensiveOperation() {
    var t float64
    for i := int64(0); i < 1e10; i++ {
        t += 1
    }
} 
```

.

```
package main

import (
    "flag"
    "log"
    "monte"
    "os"
    "runtime/pprof"
)

var cpuprofile = flag.String("cpuprofile", "", "write cpu profile to file")

func main() {
    flag.Parse()
    if *cpuprofile != "" {
        f, err := os.Create(*cpuprofile)
        if err != nil {
            log.Fatal(err)
        }
        pprof.StartCPUProfile(f)
    }

    monte.ExpensiveOperation()

    pprof.StopCPUProfile()
} 
```

.

```
(pprof) top10 --cum
Total: 1166 samples
       0   0.0%   0.0%     1166 100.0% main.main
    1166 100.0% 100.0%     1166 100.0% monte.ExpensiveOperation
       0   0.0% 100.0%     1166 100.0% runtime.main
       0   0.0% 100.0%     1166 100.0% schedunlock 
```

更新：

处的代码`github.com/haldean/monte`没有提供有意义的结果。它只需要时间真正的 0m0.506s 并且只需要 48 个样本。

```
(pprof) top10 --cum
Total: 48 samples
       0   0.0%   0.0%       45  93.8% main.main
       0   0.0%   0.0%       45  93.8% monte.(*Scene).Evaluate
       0   0.0%   0.0%       45  93.8% monte.(*Scene).Render
       0   0.0%   0.0%       45  93.8% monte.(*Scene).SetColor
       0   0.0%   0.0%       45  93.8% runtime.main
       0   0.0%   0.0%       45  93.8% schedunlock
       0   0.0%   0.0%       44  91.7% monte.(*Scene).RayCast
       4   8.3%   8.3%       31  64.6% runtime.new
      13  27.1%  35.4%       27  56.2% runtime.mallocgc
       3   6.2%  41.7%       26  54.2% monte.(*Scene).DirectionAt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T20:56:03.520

它看起来像一个仅限 CPU 的分析器，因此如果您`ExpensiveOperation`通过执行 I/O 或睡眠或类似的事情花费时间，它将是不可见的。（这就是“cpu”分析器的问题。）

就数字的含义而言，看起来总共有 346 个样本。根据分析器的工作方式，数字有点模糊并不奇怪，但如果它是一个真正的堆栈采样器，数字将意味着：

341/346 个样本已经`main`和`interhash`在堆栈上。您可能希望*所有*样本都在堆栈中具有 main ，但这是软弱无力的部分。

堆栈上有 343/346 个样本`Format`。（为什么比`main`，谁知道呢？）

堆栈上有 251/346 个样本`Unquote`。所以在这 251 个样本中，他们可能也有`main`, `interhash`, 和`Format`在堆栈上。

通过这种侦探工作，您可以慢慢开始拼凑样本告诉您的内容。

*当然，如果你真的可以看到堆栈样本，那么在你确切地*知道发生了什么之前，你不必看到太多的样本。

[*更多关于这一切*。](https://stackoverflow.com/a/1779343/23771)

# javascript - Javascript文档写查询

> ID：12774868
> 
> 赞同：0
> 
> 时间：2012-10-08T03:16:07.897
> 
> 标签：javascript, dom-events, document.write

我已经多次尝试使用 JavaScript 事件编写代码，所以我认为 JavaScript`document.write`会在某种程度上类似于 PHP 的 echo。有没有办法强制`document.write`执行类似于 PHP 的回声的内联写入？

样本：情况

我的网站

```
<input type="text" id="inputText" onchange="writeText()"> 
```

脚本

```
<script>
function writeText(){document.write(document.getElementById("inputText").value);}
</script> 
```

我希望它的行为就像每次更改文本框的值时一样，它会在文本框的下方显示文本框的值，或者更好地使用 PHP 的 echo 执行它，如下所示：

```
<script>
var inputs = document.getElementById("inputText").value;
function writeText(){document.write("<"."?php "."echo '".inputs."';"."?".">");}
</script> 
```

注意：请不要使用元素来捕获值，我知道但我想在这里的目标是在`document.write` 不删除页面其他内容的情况下内联写入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:43:32.623

`document.write()`不是为事件处理程序设计的，因为如果当前文档已经完成加载（当事件触发时它已经完成），则`document.write()`首先清除当前文档，然后将新内容添加到空文档中。

要在已加载的文档中添加内容，您需要修改现有元素的 innerHTML 或创建新元素并以编程方式将它们添加到页面中。

在您的问题中，尚不清楚您希望 writeText() 函数将其生成的内容放在哪里，但这是一个将一些新内容附加到文档中特定位置的文档的示例。

```
function writeText(parentElem, newHTML) {
    var elem = document.createElement("span");
    elem.innerHTML = newHTML;
    parentElem.appendChild(elem);
} 
```

# android - 隐藏默认来电屏幕并非一直有效

> ID：12774869
> 
> 赞同：1
> 
> 时间：2012-10-08T03:16:08.747
> 
> 标签：android, broadcastreceiver

我正在开发接收来电并自动接听来电的应用程序。我有一个在工作线程自动应答呼叫时运行的活动。我想要完成的是抑制默认的来电屏幕并在运行时将我的活动保持在前台。

经过这里的一些研究，我认为这可以通过使用**BroadcastReceiver**并调用**BroadcastReceiver.abortBroadcast()**来完成，同时将**android.intent.action.PHONE_STATE**广播设置为清单中的最高优先级。

不幸的是，这只适用于 %50 的时间。有一半的时间我能够接听电话，而我的活动仍然在前台，而有一半的时间，情况并非如此。我怎样才能让它每次都能正常工作？

这是我的清单：

```
 <receiver android:enabled="true" android:name=".IncomingCallBroadcastReceiver">
        <intent-filter android:priority="9999">
            <action android:name="android.intent.action.PHONE_STATE"/>
        </intent-filter>
    </receiver> 
```

这是我的广播接收器：

```
public class IncomingCallBroadcastReceiver extends BroadcastReceiver {

@Override
public void onReceive(final Context arg0, Intent arg1) {
    Bundle extras = arg1.getExtras();

    if (extras != null) {
        String state = extras.getString(TelephonyManager.EXTRA_STATE);
        if (state.equals(TelephonyManager.EXTRA_STATE_RINGING)) {
            // set a flag for worker thread to answer call
        }
    }

    try {
        Thread.sleep(1000);
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    abortBroadcast();
 }
} 
```

# c++ - RSA加密改变数据大小

> ID：12774870
> 
> 赞同：0
> 
> 时间：2012-10-08T03:16:13.073
> 
> 标签：c++, openssl, rsa

我使用 openssl demos 中的示例进行 rsa 加密和解密，它可以工作，但加密后的数据与加密前的文本不同。，我需要它是相同的 .. 所以我在哪里可以修改代码所以它可以返回相同的数据大小而不会损坏加密过程。，？？提前致谢 ..

下面是代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <strings.h>

#include <openssl/rsa.h>
#include <openssl/evp.h>
#include <openssl/objects.h>
#include <openssl/x509.h>
#include <openssl/err.h>
#include <openssl/pem.h>
#include <openssl/ssl.h>

#include "loadkeys.h"

#define PUBFILE   "cert.pem"
#define PRIVFILE  "privkey.pem"
#define STDIN     0
#define STDOUT    1 

int main()
{
    char *ct = "This the clear text";
char *buf;   
char *buf2;
EVP_PKEY *pubKey;
EVP_PKEY *privKey;
int len;

    ERR_load_crypto_strings();

    privKey = ReadPrivateKey(PRIVFILE);
    if (!privKey) 
{  
    ERR_print_errors_fp (stderr);    
    exit (1);  
}

    pubKey = ReadPublicKey(PUBFILE);  
if(!pubKey)
{
   EVP_PKEY_free(privKey);   
       fprintf(stderr,"Error: can't load public key");
   exit(1);
}

/* No error checking */
    buf = malloc(EVP_PKEY_size(pubKey));
    buf2 = malloc(EVP_PKEY_size(pubKey));

len = RSA_public_encrypt(strlen(ct)+1, ct, buf, pubKey->pkey.rsa,RSA_PKCS1_PADDING);

if (len != EVP_PKEY_size(pubKey))
{
    fprintf(stderr,"Error: ciphertext should match length of key\n");
    exit(1);
}

printf("%d\n", strlen(buf));
printf("%d\n", strlen(ct));
RSA_private_decrypt(len, buf, buf2, privKey->pkey.rsa,RSA_PKCS1_PADDING);

printf("%s\n", buf2);

EVP_PKEY_free(privKey);
EVP_PKEY_free(pubKey);
free(buf);
free(buf2);
    return 0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:07:25.297

我不确定您是否了解[RSA 加密](http://en.wikipedia.org/wiki/RSA_%28algorithm%29)的工作原理。

RSA 加密产生的密文块与 RSA 密钥对的模数一样宽。这不是 RSA 加密/解密过程的可协商属性。如果您使用的是 1024 位 RSA 密钥，您将获得每个密文输入“块”的 128 字节密文，并且每个块的范围可以从 1 个字节到模数的大小（少一点，实际上，在这里阅读更多关于[PKCS#1 标准的信息](http://www.rsa.com/rsalabs/node.asp?id=2124)）。同样，一个 2048 位的密钥将生成一个 256 字节的密文。

RSA*很贵*；事实上，大多数非对称算法都是。*出于这个原因，使用 RSA 加密对称*算法密钥（如 AES128 密钥）更为常见，也称为“会话”密钥，在使用所述密钥加密您的实际数据之后，然后发送加密的会话密钥和将加密数据发送给收件人。如果接收者拥有正确的私有 RSA 密钥，他们可以解密会话密钥，然后使用*它*对称地解密实际数据。

如果您想要小块加密数据，请使用对称加密。你有更多的选择灵活性。

有关 RSA 加密的更多信息，请参见[此处](http://en.wikipedia.org/wiki/RSA_%28algorithm%29)。有关对称加密标准 AES 加密的信息，请参见[此处](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)。

# ios - URLRequest+JSON解析的组合

> ID：12774871
> 
> 赞同：1
> 
> 时间：2012-10-08T03:16:24.867
> 
> 标签：ios, json, asihttprequest

什么是最好的选择：

*   网址请求

    1.  NSURL连接
    2.  ASIHTTP请求
    3.  AF网络
*   JSON解析

    1.  NSJSON序列化
    2.  SBJSON

我选择了 ASIHTTPRequest+NSJSONSerialization，但我不太确定！任何想法或建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:49:05.053

功能方面，AFNetworking > ASIHTTPRequest > NSURLConnection。不再支持 ASIHTTPRequest。这是一个封闭的项目。NSURLConnection 是苹果提供的，所以它是准系统。AFNetworking 仍然是一个活跃的项目，从我在 SO 的同事的谈话来看，它正在变得更好。

NSJSONSerialization 是 Apple 提供的，而 SBJSON 又是第三方。SBJSON 为您提供了一个更好/更简单的接口来转换任何格式的数据对象（Foundation <--> JSON）。

但是 - 事情主要取决于您想从项目中得到什么以及要求是什么。这些项目中的每一个都有其优点和缺点。您只需要研究每个框架并选择最适合您的项目的框架。此外，这里有大量关于 SO 的资源可以帮助您决定选择什么。

# java - 重复加法

> ID：12774872
> 
> 赞同：2
> 
> 时间：2012-10-08T03:16:54.677
> 
> 标签：java, addition

我刚接到一个任务，要求我从 1 到 21 重复加法，如下：

1,4,6,9,11,14,16,19,21 并得到总数。

我尝试了这段代码，但它返回为 +2 加法，它甚至绕过了 bil<=21 的先决条件

```
public class test
{
    public static void main(String[]args)
    {

        int bil=1;
        long total=0;
        boolean mult = true;

        for(bil=1; bil<=21;bil++)
        {
            if(mult=true)
            {
                bil+=1;
                mult=false;
            }
            else if(mult=false)
            {
                bil+=2;
                mult=true;
            }
    System.out.println(bil);
    total=total+bil;
        }
    System.out.println("----+");
    System.out.println(total);
    }
} 
```

（如果是 TL；DR）

基本上请求是1+4+6+9+11+14+16+19+21=?

我似乎无法让这些代码工作，请帮助我？

编辑：谢谢大家，我现在明白了：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:22:58.907

首先，您没有将布尔值与`==`. 因此，每次`for()`循环执行时，第一个块将是进入的块，因为`mult = true`它将始终存储`true`在`mult`... 中，然后使该`if()`块有资格运行。

如果此分配不是故意的，那么您需要将其更改为`==`并在循环中放置一些逻辑以`mult`适当地切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:21:22.703

您需要`boolean mult = false;`使循环第一次运行时`bil`增加 3 而不是 2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-01T05:29:38.550

基本上，当它运行第一个循环时，由于布尔值的状态，它只会添加一个，但也应该有一个 == 运算符来检查，而不仅仅是一个 =

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T03:23:44.980

尝试这个：

```
for (bil = 1; bil < 21; bil++) {

   if (bil % 2 == 0) { // If bil is divisible by 2, then add 2
      bil += 2;
      continue;     
   }

   bil += 3;

} 
```

# mysql - 如果行存在于 MySQL 中的另一个表中，则从一个表中删除行

> ID：12774877
> 
> 赞同：5
> 
> 时间：2012-10-08T03:17:52.983
> 
> 标签：mysql, sql-delete

我正在从旧的培训跟踪系统迁移数据，并且正在使用 MySQL 为新的培训跟踪系统格式化数据。

我有一个包含 550 万行的表，它是旧系统的主数据集。我还有一个表，其中包含大约 49,000 行之前已迁移。

我要做的是比较这两个表并从主数据文件中删除以前迁移的记录（我不想在新系统中创建重复的记录。）

为了进行比较，我需要比较 3 个字段（employee_id、course_code 和 completion_date）。我正在使用以下 SQL 语句，但它只是静止不动。我不知道它是否有效并且需要很长时间，或者它是否真的无效。

```
DELETE master_data.*
FROM master_data
INNER JOIN alreadyMigrated
ON master_data.employee_id = alreadyMigrated.employee_id 
AND master_data.course_code = alreadyMigrated.course_code
AND master_data.completion_date = alreadyMigrated.completion_date; 
```

我也不知道索引是否有帮助。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:22:07.493

您只需要指定表名，而不是列。

```
DELETE master_data
       FROM master_data
       INNER JOIN alreadyMigrated
          ON master_data.employee_id = alreadyMigrated.employee_id AND 
             master_data.course_code = alreadyMigrated.course_code AND 
             master_data.completion_date = alreadyMigrated.completion_date; 
```

# function - 宏参数是函数吗？

> ID：12774881
> 
> 赞同：3
> 
> 时间：2012-10-08T03:18:14.447
> 
> 标签：function, clojure, macros

我正在尝试确定宏中的给定参数是否是函数，例如

```
(defmacro call-special? [a b]
  (if (ifn? a) 
    `(~a ~b)
    `(-> ~b ~a))) 
```

这样以下两个调用都会生成“Hello World”

```
(call-special #(println % " World") "Hello")
(call-special (println " World") "Hello") 
```

但是，我不知道如何将“a”转换为 ifn? 能理解。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T04:43:33.750

您可能想问自己*为什么*要以`call-special?`这种方式定义。它似乎不是特别有用，甚至不会为您节省任何输入 - 您真的需要一个宏来执行此操作吗？

话虽如此，如果您决心让它工作，那么一种选择是查看内部`a`，看看它是否是一个函数定义：

```
(defmacro call-special? [a b]
  (if (#{'fn 'fn*} (first a)) 
    `(~a ~b)
    `(-> ~b ~a))) 
```

这是有效的，因为`#()`函数文字被扩展为如下形式：

```
(macroexpand `#(println % " World"))
=> (fn* [p1__2609__2610__auto__] 
     (clojure.core/println p1__2609__2610__auto__ " World")) 
```

我仍然认为一旦你开始做更复杂的事情（例如使用嵌套宏来生成你的函数），这个解决方案相当丑陋并且容易失败

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T05:04:05.313

首先，有几点：

1.  宏只是接收输入[文字、符号或文字和符号的集合]和输出[文字、符号或文字和符号的集合]的函数。参数永远不是函数，因此您永远无法直接检查符号映射到的函数。
2.  `(call-special #(println % " World") "Hello")`包含阅读器宏代码。由于阅读器宏在常规宏之前执行，因此您应该在进行更多分析之前对其进行扩展。通过应用`(read-string "(call-special #(println % \" World\") \"Hello\")")`which become来做到这一点`(call-special (fn* [p1__417#] (println p1__417# "world")) "Hello")`。

虽然一般来说，当您可能应该使用替代方法时，您何时想要使用某些东西并不明显，这就是我将如何处理它。

你需要打电话`macroexpand-all`。`a`如果代码最终变成了一个`(fn*)`表单，那么它就保证是一个函数。然后你可以安全地发出 (~a ~b)。如果它宏扩展为最终成为一个符号，您也可以发出`(~a ~b)`. 如果符号不是函数，则在运行时会抛出错误。最后，如果它宏扩展为一个列表（函数调用或特殊形式调用），例如`(println ...)`，那么您可以发出使用线程宏的代码`->`。

您还可以涵盖诸如表单宏扩展为数据结构但您没有指定所需行为的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T04:44:48.210

`a`在您的宏中只是一个 clojure 列表数据结构（它还不是一个函数）。所以基本上你需要检查数据结构`a`在评估时是否会产生一个函数，这可以如下所示完成：

```
(defmacro call-special? [a b]
  (if (or (= (first a) 'fn) (= (first a) 'fn*)) 
     `(~a ~b)
     `(-> ~b ~a))) 
```

通过检查第一个元素`a`是符号`fn*`还是`fn` 用于创建函数。

此宏仅适用于 2 种情况：您将其传递给匿名函数或表达式。

# opengl - openGL - 如何在不旋转灯光的情况下旋转对象

> ID：12774884
> 
> 赞同：0
> 
> 时间：2012-10-08T03:18:39.483
> 
> 标签：opengl

我想在屏幕中间画一个旋转的立方体，我希望它被上面的灯照亮（我希望它看起来好像立方体是从固定的屏幕位置被照亮的）。我的问题是我不知道如何防止光随着立方体旋转。

这是代码：

（总结：initGL、paintGL 和 resizeGl 是您始终必须实现的函数。在 paintGL 中我使用 makeCube()。在 makeCube() 中我使用 glBegin(GL_QUADS) 来制作立方体，我使用 calcNormals() 来计算立方体的法线）

--------------initGL--------------

```
angle=0.0;
glEnable (GL_DEPTH_TEST);
glEnable (GL_LIGHTING);
GLfloat LightDiffuse[]=     { 1.0f, 1.0f, 1.0f, 1.0f };
GLfloat LightPosition[]=    { 0.0f, 1.5f,1.5f, 1.0f };
glLightfv(GL_LIGHT0, GL_DIFFUSE, LightDiffuse);
glLightfv(GL_LIGHT0, GL_POSITION,LightPosition);
glEnable (GL_LIGHT0); 
```

--------------paintGL------

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glMatrixMode(GL_MODELVIEW);

glLoadIdentity();
glTranslatef(0.0, 0.0, -13.0);
glRotatef(angle,0.0f,1.0f,0.0f);

makeCube();

angle+=0.3; 
```

--------------void makeCube()------

```
float P[8][3]={ {-1,-1, 1},{1,-1, 1},{1,1, 1},{-1,1, 1},
                {-1,-1,-1},{1,-1,-1},{1,1,-1},{-1,1,-1}};

float * planes[6][4] ={ {P[0],P[1],P[2],P[3]},
                        {P[1],P[5],P[6],P[2]},
                        {P[4],P[7],P[6],P[5]},
                        {P[0],P[3],P[7],P[4]},
                        {P[3],P[2],P[6],P[7]},
                        {P[0],P[4],P[5],P[1]}};
int i;
for(i=0;i<6;i++){
    float *normal; 
    normal = calcNormal(planes[i][0],planes[i][1],planes[i][2]);
    glBegin(GL_QUADS);
        glNormal3f(normal[0], normal[1], normal[2]);
        glVertex3f(planes[i][0][0],planes[i][0][1],planes[i][0][2]);
        glVertex3f(planes[i][1][0],planes[i][1][1],planes[i][1][2]);
        glVertex3f(planes[i][2][0],planes[i][2][1],planes[i][2][2]);
        glVertex3f(planes[i][3][0],planes[i][3][1],planes[i][3][2]);
    glEnd();
} 
```

----------------float* calcNormal()------------------

```
float   vec1[3] = {P2[0]-P1[0],P2[1]-P1[1],P2[2]-P1[2]};
float   vec2[3] = {P3[0]-P2[0],P3[1]-P2[1],P3[2]-P2[2]};
float  cross[3] = {vec1[1]*vec2[2]-vec2[1]*vec1[2],
                   vec1[2]*vec2[0]-vec2[2]*vec1[0],
                   vec1[0]*vec2[1]-vec2[0]*vec1[1]};
float modCross = sqrt(cross[0]*cross[0]+cross[1]*cross[1]+cross[2]*cross[2]);
cross[0]/=modCross;
cross[1]/=modCross;
cross[2]/=modCross;

return cross; 
```

----------resizeGL--------------

```
glViewport(0, 0, width, height);
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
GLfloat x = GLfloat(width) / height;
glFrustum(-x, +x, -1.0, +1.0, 4.0, 15.0);
glMatrixMode(GL_MODELVIEW); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T04:01:20.250

您似乎正在改变您的paintGL 部分中的灯光位置。

查看旧代码，我在我的代码目录中发现了一个应用程序，它可以加载和旋转 .OBJ 网格，同时允许移动灯光。

我认为解决方案是在每一帧设置灯光的位置。（不记得我接触这个项目已经超过 18 个月了）

```
void idleFunc()
{
    light();      /// *** I think you need to replicate this functionality ****
    glPushMatrix();
    myGluLookAt(0.0, -.50, -6.0,  /* eye is at (0,0,5) */
                0.0, 0.0, 0.0,      /* center is at (0,0,0) */
                0.0, 1.0, 0.);      /* up is in positive Y direction */
    transformFunc();
    displayFunc();
    glPopMatrix();
}

void displayFunc()
{
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    if (useDrawList)
        glCallList(DLid);
    else
        drawObj(loadedObj);
    drawLight0();              // *** just displays an unlit sphere at the position of the light **
    glutSwapBuffers();
    frameCount++;
}

/* set the poition of each of the lights */
void light()
{
    glLightfv(GL_LIGHT0, GL_POSITION, lightPos1);
    glLightfv(GL_LIGHT1, GL_POSITION, lightPos2);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T04:08:36.480

我解决了这个问题，用顶点阵列而不是直接模式绘制立方体，似乎旋转或灯光以不同的方式影响对象，这很奇怪

# ios6 - 在 iOS 6 中呈现模态视图

> ID：12774887
> 
> 赞同：2
> 
> 时间：2012-10-08T03:19:02.020
> 
> 标签：ios6, modalviewcontroller, instagram, uicollectionview

我想显示一个模态视图，但我有两个问题：

1.  iOS 6 中没有 presentModalViewController，我必须使用 presentViewController，它只是像模态序列一样显示我的第二个 ViewController，而不是没有全屏选项的模态窗口，

2.  我的第二个问题是如何从 UICollectionViewController 显示模态窗口。我尝试使用 presentViewController 但它只适用于 ViewController 而不是 CollectionViewController。

我想做的最好的例子就是这个（Instagram）。他们是如何制作这个模态窗口的？是因为它仍在使用旧的 iOS 版本而且还不是 iOS 6 吗？或者还有另一种方法可以从 UICollectionViewController 显示这样的模式窗口？

谢谢

![在此处输入图像描述](../Images/c545ac5c99525106e8308959c927b19b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-23T12:40:08.870

如果我正确地理解了您，您要实现的目标是向`ViewControllers`父母展示您的其中一个，并且仍然在后台看到父母`ViewController`。

**第一个解决方案：**

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"SecondViewController"];
    vc.view.backgroundColor = [UIColor clearColor];
    self.navigationController.modalPresentationStyle = UIModalPresentationCurrentContext; //self.modalPresentationStyle might do a better job here
    [self presentViewController:vc animated:NO completion:nil]; 
```

确保你的`SecondViewController`内容小于你当前的 ``ViewController` 并且你可以在 StoryBoard\xib 中看到它的背景颜色。背景颜色将清晰并创建透明效果。

**第二种解决方案：**

创建一个容器（如果您计划使用 Storyboard IB，iOS 6 及更高版本，低于此值将允许您创建容器，但只能逐步创建）。

![容器](../Images/ff21ae24ed0ae56efa06dbaa419327c0.png)

将容器大小设置为父大小的 3/4，并将第二个视图控制器连接到它。而不是 segueing \ 推送到您的第二个视图控制器，您可以

```
myContainer.alpha = 1; 
```

在屏幕上显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:23:26.067

我会看一下 UIContainerView 的文档，它用于以与非全屏模式演示类似的方式将视图控制器显示为另一个视图控制器的子级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-20T05:56:59.197

正如你所说，`presentViewController`这只适用于`UIViewController`不`UICollectionViewController.`

然后只需在头文件中导入`UIViewController`类，`CollectionViewController`如下所示：

```
#import <UIKit/UIKit.h>

@class UIViewController;

@interface MyCVController : UICollectionViewController

@end 
```

# javascript - 中止 $.post() / 响应式搜索结果

> ID：12774888
> 
> 赞同：0
> 
> 时间：2012-10-08T03:19:10.740
> 
> 标签：javascript, jquery, ajax, search, xmlhttprequest

我有以下杂乱无章的代码；

**HTML**

```
<input type="search" id="search_box" />
<div id="search_results"></div> 
```

**JS**

```
var search_timeout,
    search_xhr;
$("#search_box").bind("textchange", function(){
    clearTimeout(search_timeout); search_xhr.abort();
    search_term = $(this).val();
    search_results = $("#search_results");

    if(search_term == "") {
        if(search_results.is(":visible"))
            search_results.stop().hide("blind", 200);
    } else {
        if(search_results.is(":hidden"))
            search_results.stop().show("blind", 200);
    }

    search_timeout = setTimeout(function () {
        search_xhr = $.post("search.php", {
            q: search_term
        }, function(data){
            search_results.html(data);
        });
    }, 100);
}); 
```

（使用[Zurb 的 textchange 插件](http://www.zurb.com/playground/jquery-text-change-custom-event)）

我最初使用更简单的代码时遇到的问题是它非常没有响应。结果将在几秒钟后出现，尤其是在键入速度较慢或使用 Backspace 等时。

我做了这一切，情况也好不了多少。请求堆积如山。

我的初衷是在`.abort()`再次触发 textchange 事件时取消之前仍在运行的任何请求（根据[446594](https://stackoverflow.com/a/446626/951402)）。这不起作用，因为我在控制台中重复出现这样的错误；

```
Uncaught TypeError: Cannot call method 'abort' of undefined 
```

我怎样才能`.abort()`在我的情况下工作？

此外，这种方法是获取“实时”搜索结果的最佳方式吗？很像 Facebook 的搜索栏，它会在用户输入时给出结果，而且看起来很快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:34:20.643

您最好在发送请求之前稍作延迟。如果用户在最后一次的 100 毫秒（或您选择的其他时间）内按下另一个键，则无需首先发送请求。

在实际发送请求时，您应该检查一个是否已经处于活动状态。如果是，请取消它。

例如

```
if (search_xhr) {
   search_xhr.abort();
} 
```

不要忘记在成功检索时重置该 var。例如删除search_xhr；

# c# - 未设置 JOliver EventStore 调度标志，每次重启时重播事件

> ID：12774894
> 
> 赞同：1
> 
> 时间：2012-10-08T03:20:23.763
> 
> 标签：c#, neventstore

我正在使用 EventStore，一切似乎都在工作，事件由我的内存代理存储和调度，事件由我的读取模型处理。但是由于某种原因，EventStore Commits 表中的“已调度”标志没有设置，所以每次我重新启动我的应用程序时，它都会重播所有事件。我使用 SQL Server 2012 作为存储。没有发生错误。知道为什么这个标志不会被设置吗？

我的代码：

```
 private static IStoreEvents BuildEventStore(IBroker broker)
    {
        return Wireup.Init()
            .UsingSqlPersistence(Constants.EventStoreConnectionStringName)
            .InitializeStorageEngine()
            .UsingJsonSerialization()
            .Compress()
            .UsingAsynchronousDispatchScheduler()
            .DispatchTo(new DelegateMessageDispatcher(c => DispatchCommit(broker, c)))

            .Build();
    }

    private static void DispatchCommit(IBroker broker, Commit commit)
    {
        foreach (var @event in commit.Events)
        { 
            if(!(@event.Body is IDomainEvent))
            {
                throw new InvalidOperationException("An event was published that is not an IDomainEvent: " + @event.Body.GetType());
            }

            broker.Publish((IDomainEvent)@event.Body);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T12:56:01.857

`UsingAsynchronousDispatchScheduler`调度程序中的电线，该调度程序在处理的主线之外做自己的事情。例如，如果它有写入问题，命令处理线程将不会听到它。

使生活变得~~更简单~~的一种方法是将其更改为同步，以便您的命令处理链可以听到异常（请记住，调度异常不会回滚命令已处理并且事件现在已经发生的事实） .

但实际上，您需要通过 USL 查看连接的处理器`UsingAsynchronousDispatchScheduler`确实报告了问题，以便您的监控可以发现问题。

# vim - 当存在现有水平拆分时，如何将垂直拆分窗口移动到水平拆分？

> ID：12774898
> 
> 赞同：4
> 
> 时间：2012-10-08T03:20:48.610
> 
> 标签：vim, window-management

在 Vim 中，我倾向于在新的垂直分割中打开缓冲区（偶尔水平分割）。我将我的代码保持在 80 个字符宽，所以这在大型显示器上运行良好。

我经常以这种窗口布置结束：

```
---------------------
| | | | |
| | | | |
------ | 一个 | 乙|
| | | | |
| | | | |
---------------------

```

在四到五列宽时，它可能会开始变得有点太窄，所以我想四处移动窗户，使它看起来像这样：

```
----------------
| | | 一个 |
| | | |
------ ------
| | | 乙|
| | | |
----------------

```

据我所知，这是不可能通过在 Vim 中移动窗口来实现的。

获得我发现的窗口排列的唯一方法是关闭窗口 A，然后重新打开 A 作为窗口 B 的新水平拆分。

这是正确的，还是有办法像在 Vim 中那样移动/重新排列窗口？也许是插件？

我还没有找到任何东西，所以我想我会问，因为我发现窗户的打开/关闭很烦人并且打断了我的流程。

FWIW，我发现`Ctrl-W + J`/`Ctrl-W + K`快捷方式没用，因为它们使新的水平分割与整个屏幕一样宽，而不是与相邻窗口分割。即`Ctrl-W + J`会给我这个：

```
----------------
| | | |
| | | |
------ | 一个 |
| | | |
| | | |
----------------
| |
| 乙|
----------------

```

这通常不是我想要的。

如果有人有一些想法，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:38:09.817

有一个插件可以完全满足您的需求。这是链接：[https](https://github.com/fabi1cazenave/suckless.vim) ://github.com/fabi1cazenave/suckless.vim 。

# python - 在运行 pylab 时，在 Matplotlib 中的事件处理期间无法使用 raw_input() -- RuntimeError: can't re-enter readline

> ID：12774900
> 
> 赞同：2
> 
> 时间：2012-10-08T03:21:22.387
> 
> 标签：python, matplotlib, ipython

我正在尝试编写一个脚本，允许用户通过 matplotlib 中的事件处理来操作图形，但我需要让他们通过终端输入一些附加信息

调用`raw_input()`似乎会破坏脚本，并引发`RuntimeError: can't re-enter readline`错误

这是一段简单的代码来演示这一点：

```
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(np.random.rand(10))

def keypress(event):
    print 'You press the "%s" key' %event.key
    print 'is this true? Type yes or no'
    y_or_n = raw_input()

cid = fig.canvas.mpl_connect('key_press_event', keypress)
plt.show() 
```

如果我使用 python 运行它，这可以正常工作，但使用 ipython --pylab 会中断。不幸的是，我需要交互模式

我看到其他人遇到过这个问题，但我还没有看到解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T13:12:36.327

您遇到了麻烦，因为 matplotlib 仍在监听按键。不幸的是，简单地断开它的事件监听对我来说并没有交互作用。然而，这个解决方案确实奏效了。尽管它限制了您不能使用“y”、“e”、“s”、“n”或“o”键。如果这是必要的，有解决方法。

```
import matplotlib.pyplot as plt
import numpy as np

#disable matplotlib keymaps
keyMaps = [key for key in plt.rcParams.keys() if 'keymap.' in key]
for keyMap in keyMaps:
    plt.rcParams[keyMap] = ''

str = ''

fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(np.random.rand(10))

def keypress(event):
    global str

    if event.key in ['y','e','s','n','o']:
        str += event.key
    else:   
        print 'You press the "%s" key' %event.key
        print 'is this true? Type yes or no'

    if str == 'yes':
        print str
        str = ''
    elif str == 'no':
        print str
        str = ''

cid = fig.canvas.mpl_connect('key_press_event', keypress)
plt.show() 
```

# linux - 哇 | 为什么长度不对？

> ID：12774903
> 
> 赞同：1
> 
> 时间：2012-10-08T03:21:43.873
> 
> 标签：linux, awk, gawk

我不明白..这很有趣，但我不明白））

请看下文

```
echo -n '\\prj\prj.prjjmbr.Interp\PRIL_35.jpg' | awk -F ';' '{a=length($1);print lenght a}' 
```

输出是35。没错

```
echo -n '\\prj\prj.prjjmbr.Interp\PRIL_35.jpg' | wc -c 
```

输出是35。也对

```
echo -n '\\prj\prj.prjjmbr.Interp\Very long path with cyrillic symbols\полученные данные_по проект\отчеты\Отчет \Dinam_interp_2D_yujo-vost_ch_Urabor-Yahinskij_LU_2008 ( GNPTs_PurGeo ) \Otchet\GrafPril\PRIL_35.jpg' | awk -F ';' '{print length ($1)}' 
```

输出为 202。

```
echo -n '\\prj\prj.prjjmbr.Interp\Very long path with cyrillic symbols\полученные данные_по проект\отчеты\Отчет \Dinam_interp_2D_yujo-vost_ch_Urabor-Yahinskij_LU_2008 ( GNPTs_PurGeo ) \Otchet\GrafPril\PRIL_35.jpg' | wc -c 
```

输出为 237。

为什么使用非拉丁符号我得到不同的结果？我该如何解决？

ps 修复后，我需要使用 substr 函数，即 substr (path, 10, 8);

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-08T03:37:41.410

使用非拉丁符号会得到不同的结果，因为字符串中的字符数和字符串中的字节数之间存在差异。`wc -c`正在返回字节数，`awk`正在返回字符数。

确保使用正确的号码。如果需要存储字符串，则需要知道字节数。如果您需要显示一个字符串，您可能对字符数更感兴趣。

来自`man wc`：

> -c, --bytes 打印字节数

来自`man awk`：

> 从 3.1.5 版开始，gawk 支持多字节。这意味着 index()、length()、substr() 和 match() 都根据字符而不是字节工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:32:30.950

我可以重现您的发现，并假设它与语言环境有关。不是修复，而是“解决方法”......

```
echo -n '\\prj\prj.prjjmbr.Interp\Very long path with cyrillic symbols\полученные данные_по проект\отчеты\Отчет \Dinam_interp_2D_yujo-vost_ch_Urabor-Yahinskij_LU_2008 ( GNPTs_PurGeo ) \Otchet\GrafPril\PRIL_35.jpg' | LANG=C awk -F ';' '{print length ($1)}' 
```

# android - 自定义窗口标题栏并隐藏默认标题栏

> ID：12774904
> 
> 赞同：2
> 
> 时间：2012-10-08T03:21:51.370
> 
> 标签：android, android-layout

嗨，我已经为我的 android 应用程序创建了自己的自定义窗口标题栏，但是现在每次打开应用程序时，我都会看到默认标题栏，但我尝试放置透明背景，但我的代码不起作用：

```
custom_title.xml: 
<resources>
<style name="CustomWindowTitleBackground">
    <item name="android:background">@android:color/transparent</item>
</style>

<style name="CustomTheme" parent="android:Theme">
    <item name="android:windowTitleSize">35dip</item>
    <item name="android:windowTitleBackgroundStyle">@style/CustomWindowTitleBackground</item>

 </style> 
```

任何帮助不胜感激，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:50:00.167

你尝试`full screen`Activity 吗？或者`noTitleBar`你的 Activity 的主题？然后为 Activity 创建一个布局，它的子布局看起来像你的自定义标题栏，它是第一个在其中。例如，你的布局可能如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:orientation="vertical" 
    android:layout_width="fill_parent" android:layout_height="fill_parent">
    <your custom title bar/>
    <your main layout/>

</LinearLayout> 
```

因此，当您的 Activity 为用户建议时，默认标题栏不可见，并且您的自定义布局（包含在布局中）看起来像标题栏。

# php - 创建图片上传 API

> ID：12774905
> 
> 赞同：-3
> 
> 时间：2012-10-08T03:21:54.327
> 
> 标签：php, image, api, upload

我想做一个图片上传API 例子：http://mysite.com/api.php?url=http://test.com/1.jpg 如何写脚本可以从URL中获取图片URL？还要检查图像的扩展名然后上传到我的网站并重定向到图像。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:24:07.133

让 api.php 在您的服务器上运行 cURL 命令以获取提交给您的 API 的文件的 URL，然后将文件下载到您想要的位置。然后让它将图像的位置返回到您的脚本以进行最终处理，以包括重命名和您想要完成的任何数据库存储。

# hibernate - 使用来自同一个表的两个外键休眠 POJO

> ID：12774906
> 
> 赞同：0
> 
> 时间：2012-10-08T03:21:58.427
> 
> 标签：hibernate, pojo

如何创建带有注释的 POJO，以便休眠将在映射时创建下表？一栏是跟随`EE`，一栏是跟随`ER`。

```
CREATE TABLE friends(
  id INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  followee_id INT(11) UNSIGNED NOT NULL,
  follower_id INT(11) UNSIGNED NOT NULL,
  start_time TIMESTAMP NOT NULL,
  end_time TIMESTAMP NOT NULL,
  PRIMARY KEY(id),
  KEY idx_fk_friends_followee_id (followee_id),
  KEY idx_fk_friends_follower_id (follower_id),
  CONSTRAINT `fk_friends_followee_id` FOREIGN KEY (followee_id) REFERENCES user (id) ON DELETE RESTRICT ON UPDATE CASCADE,
  CONSTRAINT `fk_friends_follower_id` FOREIGN KEY (follower_id) REFERENCES user (id) ON DELETE RESTRICT ON UPDATE CASCADE
)ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T03:28:48.007

我不确定您的问题是什么，因为我认为这很简单：

```
@Entity
public class Friend {
  @Id
  private Long id;

  @ManyToOne
  private User follower;

  @ManyToOne
  private User followee;
} 
```

# java - amazon s3 上传文件超时

> ID：12774909
> 
> 赞同：12
> 
> 时间：2012-10-08T03:22:14.170
> 
> 标签：java, amazon-s3

我有一个 800KB 的 JPG 文件。我尝试上传到 S3 并不断收到超时错误。你能弄清楚什么是错的吗？800KB 对于上传来说是相当小的。

> 错误消息：您与服务器的套接字连接未在超时期限内读取或写入。空闲连接将被关闭。
> 
> HTTP 状态码：400
> 
> AWS 错误代码：RequestTimeout

```
Long contentLength = null;
System.out.println("Uploading a new object to S3 from a file\n");
try {
    byte[] contentBytes = IOUtils.toByteArray(is);
    contentLength = Long.valueOf(contentBytes.length);
} catch (IOException e) {
    System.err.printf("Failed while reading bytes from %s", e.getMessage());
}

ObjectMetadata metadata = new ObjectMetadata();
metadata.setContentLength(contentLength);        

s3.putObject(new PutObjectRequest(bucketName, key, is, metadata)); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-10T22:58:58.730

是否有可能 IOUtils.toByteArray 正在耗尽您的输入流，以便在进行服务调用时没有更多数据可以从中读取？在这种情况下， stream.reset() 将解决问题。

但是，如果您只是上传一个文件（而不是任意 InputStream），您可以使用更简单的 AmazonS3.putObject() 形式，它接受一个文件，然后您根本不需要计算内容长度。

[http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3.html#putObject(java.lang.String](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3.html#putObject(java.lang.String) , java.lang.String, java.io.File)

这将多次自动重试任何此类网络错误。您可以通过使用 ClientConfiguration 对象实例化客户端来调整客户端使用的重试次数。

[http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html#setMaxErrorRetry(int)](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html#setMaxErrorRetry(int))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-06T00:58:50.270

如果您的终端节点位于 VPC 后面，它也会默默地出错。您可以在此处为 s3 添加新的 VPC 终端节点

[https://aws.amazon.com/blogs/aws/new-vpc-endpoint-for-amazon-s3/](https://aws.amazon.com/blogs/aws/new-vpc-endpoint-for-amazon-s3/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-08-25T07:27:58.067

我要感谢加布里埃尔的回答。我使用 rclone 实现了 S3 的端点，看到我的错误从 100 到*零*。这使得 ECS 到 S3 的传输通过其内部网络进行 - 这明显更快且更可靠。我要补充的唯一一点是，永远不要尝试将网络驱动器备份到 S3 - 那里有伤害的世界。

这个命令（和选项）对我来说一整天都很完美：rclone --progress copy /home/sound/effects/$formatName/$fileType/ $S3CONFIG:$S3BUCKET/$formatName-$fileType/$fileType/ -- contimeout 10m0s --max-backlog 100 --transfers 8

# javascript - Twitter Bootstrap 以编程方式打开远程 URL

> ID：12774910
> 
> 赞同：1
> 
> 时间：2012-10-08T03:22:23.187
> 
> 标签：javascript, jquery, html, twitter-bootstrap

```
<div class="modal hide fade" id="modal_window">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3>Modal header</h3>
    </div>
    <div class="modal-body">
        <p>One fine body</p>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn">Close</a>
        <a href="#" class="btn btn-primary">Save changes</a>
    </div>
</div> 
```

这是我的html代码，

我想将远程内容加载到其中，比如说 yahoo.com

我试过了

```
$('#modal_window').attr('data-remote', 'http://www.yahoo.com').modal({show:true, remote:true}); 
```

它显示了正常的模态内容，而不是加载到模态中的雅虎。如何将 yahoo.com 加载到模式窗口中？

[http://jsfiddle.net/UXU2K/1/](http://jsfiddle.net/UXU2K/1/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:35:18.410

通过 Javascript 加载远程数据的两种方法是从 AJAX 或通过设置 iFrame 的 url。iFrame 适用于您想要加载整个网站的情况。我会假设你不想要那个。您正在使用 jQuery，因此这里是他们的 ajax 方法[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)的文档。

下面是使用 jQuery 的 ajax 方法加载远程数据的代码：

```
 $.ajax({

       url: 'http://www.yahoo.com',
       type: 'GET',
       success: function(data) {

          $('#modal_body').append(html);

       }

    }); 
```

顺便说一句，如果您正在加载 HTML（与纯文本相反）并希望将其注入 modal_win 元素，请在成功方法中使用以下代码，而不是我上面的代码：

`$(html).appendTo('#modal_body');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:47:01.503

传入`remote: true`是无效的语法，因为您正在设置 data 属性。如果删除它，您将看到此错误：

> XMLHttpRequest 无法加载[http://www.yahoo.com/](http://www.yahoo.com/)。Access-Control-Allow-Origin 不允许来源[http://fiddle.jshell.net 。](http://fiddle.jshell.net)

如果该页面与您的站点位于同一域中，它将起作用。否则，您将需要使用 iFrame，但这取决于您的应用程序。

# c# - ASP.net Web 服务安全性阻止 WndProc 并使用参数运行

> ID：12774914
> 
> 赞同：0
> 
> 时间：2012-10-08T03:23:06.287
> 
> 标签：c#, asp.net, web-services, iis

我有一个带有几种方法的网络服务，这些方法试图在系统上运行或发送消息另一个 .EXE 以执行特定任务。

我们可以使用某些参数启动 .EXE 进程，或者向其发送 WndProc 消息以使其执行所需的操作。这在我的系统上本地运行良好，使用 cmd 中的参数调用 exe 或在 Visual Studio 中调试时从 web 服务发送 WndProc 消息。

然而，这些都不适用于真实环境。我让带有参数方法（DoSomething）的运行.Exe将异常写入文件：

```
System.ComponentModel.Win32Exception (0x80004005): No Access
at System.Diagnostics.Process.StartWithShellExecuteEx(ProcessStartInfo startInfo)
at System.Diagnostics.Process.Start()
at Someprogram.ProgramService.DoSomething(String text) 
```

wndproc sendmessage 的另一种方法我也包含在 try/catch 中，但没有抛出异常。它实际上定位了该过程，尽管我让它打印了一个文件：

```
public static void SendMessageToSomeProgram(string message) {
      Process[] processes = Process.GetProcessesByName("SomeProgram");
      if (processes.Length >= 1) {
        //iterate through all running target applications
        foreach (Process p in processes) {
          //test write if process found
          TextWriter tw = new StreamWriter(@"c:\wndprocfile.txt"); //this file is printed
          tw.WriteLine(DateTime.Now.ToString());
          tw.Close();
          //do stuff
          try {
            byte[] sarr = System.Text.Encoding.Default.GetBytes(message);
            int len = sarr.Length;
            COPYDATASTRUCT cds;
            cds.dwData = (IntPtr)100;
            cds.lpData = message;
            cds.cbData = len + 1;
            SendMessage(p.MainWindowHandle, WM_COPYDATA, 0, ref cds);
          } catch (Exception ex) {
            TextWriter tw2 = new StreamWriter(@"c:\wndProc_errorfile.txt"); //not printed
            tw2.WriteLine(DateTime.Now.ToString() + "Exception: " + ex.ToString());
            tw2.Close();
          }
       }
} 
```

现在我明白了为什么拥有这样的安全性很好，但是有没有简单的方法解决这个问题？也许只是 IIS 中的一些设置？

更新信息：服务器正在运行 IIS 5.1，因此没有应用程序池功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T09:28:46.510

IIS 中的服务以连接到它所运行的应用程序池的用户身份运行。因此尝试将应用程序池的用户更改为有权启动您要启动的应用程序的用户。

为此，请检查应用程序应用程序池，然后转到应用程序池并更改用户。要更改用户，您必须关闭直通身份验证。

# linux - 是否可以同时在 iptables 中接受和排队数据包

> ID：12774921
> 
> 赞同：6
> 
> 时间：2012-09-27T05:48:11.540
> 
> 标签：linux, networking, iptables

我也想接受数据包并分析它们。数据包应该去其预期的应用程序，并且副本也应该在队列中可用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T06:33:14.010

当您对数据包进行排队时，ac 程序可以使用 libnetfilter_queue 库检索数据包。在回调函数中分析数据包后，您可以在此处发出判决 NF_ACCEPT。

# c - 有没有办法将 sscanf 与标准输入一起使用？

> ID：12774923
> 
> 赞同：1
> 
> 时间：2012-10-08T03:24:23.903
> 
> 标签：c, stdin, scanf

我有一个程序可以从文件或标准输入中获取数据。我编写了使用 sscanf 扫描文件的代码。我想知道我是否可以重用该代码，但使用标准输入而不是使用 scanf？

前任：

我该如何修改它以使其适用于标准输入？

```
while(fgets(buffer, MAX_LEN, input) != NULL) { 
    if (sscanf(buffer, "%s %s %s", one, two, three) == 3) { } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:46:28.893

您无需更改`sscanf()`调用 - 这`fgets()`是从输入文件中读取的调用。

您可以通过在调用中`stdin`逐字替换`input`with来更改您的代码片段以使用（是指标准输入的全局声明）。`stdin``fgets()``stdin``FILE *``stdio.h`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-15T18:21:57.680

`fgets(buffer,MAX_LEN,input)`ie中的第三个参数`input`是要从中获取输入的源。在您的情况下，它应该被替换为，`stdin`以便它从标准控制台而不是文件获取输入。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-08T03:33:52.190

fscanf：[http ://www.cplusplus.com/reference/clibrary/cstdio/fscanf/](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/)

# iphone - 无论如何要检查 UINavigationBar 按钮单击了吗？

> ID：12774924
> 
> 赞同：0
> 
> 时间：2012-10-08T03:24:56.400
> 
> 标签：iphone

我用`UINavigationbar`，效果很好。

但是现在我有一个全局参数来计算在索引处使用的参数（我想回来的屏幕索引）`pushUIViewController`。`popToUIViewController`它有效，但是当我单击`UINavigation`左按钮返回上一个屏幕时出现错误，这使得参数继续计数（++）。

然后当我回到屏幕上时，我希望参数有不同的值。

如何检查按钮是否`UINavigationbar`被点击？？？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:27:21.120

```
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(method:)];
cancelEdit:, the selector, is in the current class (self) and is defined as:

- (void) method: (id) sender
{
//use nslog to print string (or)perform any action to change view background colors;
nslog("click"):
(or)
self.view.backgroundcolor=[UIColor redcolor];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:39:25.620

在导航栏上手动添加按钮：

```
 UIButton *titleButton = [UIButton buttonWithType:UIButtonTypeCustom];
[titleButton setTitle:@"myTitle" forState:UIControlStateNormal];
titleButton.frame = CGRectMake(0, 0, 70, 44);
titleButton.font = [UIFont boldSystemFontOfSize:16];
[titleButton addTarget:self action:@selector(titleTap:) forControlEvents:UIControlEventTouchUpInside];
self.navigationItem.titleView = titleButton; 
```

添加 titleTap 方法来捕捉点击事件：

```
 - (IBAction) titleTap:(id) sender
{
    NSLog(@"Title tap");
} 
```

# c# - 等待后的 SynchronizationLockException

> ID：12774925
> 
> 赞同：2
> 
> 时间：2012-10-08T03:25:04.230
> 
> 标签：c#, multithreading, windows-8, async-await

我有一个名为 的方法`HandleMessage`，启动了一个新线程来处理消息。如果锁对象被成功获取，则处理它。否则将消息放入队列。A`SynchronizationLockException`总是被抛出，`Monitor.Exit(o)`因为在`await`上下文不再在原始线程中之后。正确的实施方式是什么？

```
 public void HandleMessage(string message)
    {
        Task.Factory.StartNew(async delegate
        {
            if (Monitor.TryEnter(o))
            {
                try
                {
                    do
                    {
                        await HandleMessageAsync(message);
                    }
                    while (queue.TryDequeue(out message));
                }
                finally
                {
                    Monitor.Exit(o);
                }
            }
            else
            {
                queue.Enqueue(message);
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T04:18:48.470

正如您所注意到的，Monitor.Enter/Exit 是线程仿射的。

在他关于创建异步友好协调原语的系列中，Stephen 包含了一个[AsyncLock](http://blogs.msdn.com/b/pfxteam/archive/2012/02/12/10266988.aspx)，它应该是您正在寻找的 AFAICT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:40:19.470

现在发现`object o`这里的同步锁是没用的，因为my`queue`是并发的。最后解决办法是：

```
public void HandleMessage(string message)
{
    Task.Factory.StartNew(async delegate
    {
        while (queue.TryDequeue(out message));
        {
           await HandleMessageAsync(message);
        }
    });
} 
```

这解决了问题。但它本身并没有回答这个问题。

# python - TypeError：创建实例时对象不可调用

> ID：12774929
> 
> 赞同：2
> 
> 时间：2012-10-08T03:25:45.923
> 
> 标签：python

我搜索了其他有类似问题的线程，但我没有找到答案。基本上，我有一堂课：

```
import Android_Class

class Android_Revision(object):

    def __init__(self):
        # dict for storing the classes in this revision
        # (format {name : classObject}):
        self.Classes = {}
        self.WorkingClass = Android_Class()
        self.RevisionNumber = ''

    def __call__(self):  
        print "Called"

    def make_Class(self, name):
        newClass = Android_Class(name)
        self.Classes.update({name : newClass})
        self.WorkingClass = newClass

    def set_Class(self, name):
        if not(self.Classes.has_key(name)):
            newClass = Android_Class(name)
            self.Classes.update({name : newClass})
        self.WorkingClass = self.Classes.get(name) 
```

我正在尝试创建此类的实例：

```
Revision = Android_Revision() 
```

那就是我收到错误的时候。我很困惑，因为我有另一种情况，我正在做几乎完全相同的事情，而且工作正常。我无法弄清楚两者之间的差异会导致此错误。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:34:08.020

我支持评论，这个问题缺乏重要信息，如果这个错误不是非常常见并且有相当明显的症状，我将无法提供任何类似答案的东西。

Python 对 {files,modules} 和类的看法与 Java 完全不同。模块是比类更高级别的组织单元。具体来说，一个模块可以包含任意数量的类（以及许多其他的东西）。`import`处理模块，而不是类。`import foo`为您提供该名称的模块，而不管该名称的任何类。如果您必须在同名模块中有一个类（通常，这是过度使用类或忽略模块作为组织单位的标志），您可以访问它，也可以`Foo.Foo`使用`from Foo import Foo`.

顺便说一句，模块名应该是`lower_case`，而类名应该是`PascalCase`. 不要将两者混为一谈。另请阅读[PEP 8](http://www.python.org/dev/peps/pep-0008/)了解其他约定。

# node.js - 如何编辑全局文件安装

> ID：12774930
> 
> 赞同：0
> 
> 时间：2012-10-08T03:26:04.947
> 
> 标签：node.js, terminal, directory, command, command-line-interface

我刚刚运行了这行代码

```
npm install -g csslint 
```

CSSlint 看起来很棒，但我想通过放入自定义代码来添加美化我的 CSS 的能力。目标是有一个命令行界面，我可以在将代码推送到服务器之前格式化我的 css。

“-g”代表全局安装正确吗？

这个库安装在哪里以及如何访问它？我以为它会在我的用户/本地/bin 中，但我找不到它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:33:27.633

用于`npm root -g`查看模块的安装位置。如果您想在代码中使用它，请`require()`在本地安装它，即不使用`-g`选项。更多细节在这里[https://npmjs.org/doc/faq.html](https://npmjs.org/doc/faq.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:29:33.540

我相信这将取决于您的 npm 设置，但我的全局 npm 二进制文件在`/usr/local/share/npm/bin`

# android - 如果是 android 或 iphone，则更改元视口标签

> ID：12774931
> 
> 赞同：0
> 
> 时间：2012-10-08T03:26:20.267
> 
> 标签：android, iphone, user-agent, viewport

我想根据对 android 或 iphone 的检测来更改元视口标签。我有这个代码，但它不工作：

```
<script type="text/javascript">
var metas = document.getElementsByTagName('meta');
var i;
var ua = navigator.userAgent;

var isAndroid = navigator.userAgent.match(/Android/i) !=null;
var isAndroid = /Android/i.test(ua);

var isiPhone = navigator.userAgent.match(/iPhone/i) !=null;
var isiPhone = /iPhone/i.test(ua);

if(isiPhone) {
for (i=0; i<metas.length; i++) {
  if (metas[i].name == "viewport") {
    metas[i].content = "";
  }
}
} else if(isAndroid) {
for (i=0; i<metas.length; i++) {
  if (metas[i].name == "viewport") {
    metas[i].content = "";
  }
}
} else {
for (i=0; i<metas.length; i++) {
  if (metas[i].name == "viewport") {
    metas[i].content = "width=device-width, initial-scale=.5";
  }
}
}
</script> 
```

我尝试了这段代码作为测试，它工作得很好：

```
<script type="text/javascript">
var isiPad = navigator.userAgent.match(/iPad/i) != null;
var ua = navigator.userAgent;
var isiPad = /iPad/i.test(ua) || /iPhone OS 4_3_3/i.test(ua) || /iPhone OS 4_3_3/i.test(ua);

var isAndroid = navigator.userAgent.match(/Android/i) !=null;
var isAndroid = /Android/i.test(ua);

var isiPhone = navigator.userAgent.match(/iPhone/i) !=null;
var isiPhone = /iPhone/i.test(ua);

if(isiPad) {
alert("hello ipad!");
} else if(isAndroid) {
alert("hello android!");
} else if(isiPhone) {
alert("hello iphone!");
}
</script> 
```

知道我在元标记代码上做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:11:38.807

定位元视口并测试用户代理：

```
 viewport = document.querySelector("meta[name=viewport]");

 var iOS_iphone = ( navigator.userAgent.match(/(iPhone)/i) ? true : false );

    if (iOS_iphone==true){
        viewport.setAttribute('content', 'width=device-width, initial-scale=0.2, maximum-scale=0.2, user-scalable=no');
        }

    if( navigator.userAgent.match(/Android/i)){ 
        viewport.setAttribute('content', 'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0');
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T01:27:53.607

我使用了开源的[Mobile Detect](http://mobiledetect.net/) php 脚本。这是我下载轻量级脚本后所需的全部内容：

```
include 'Mobile_Detect.php';
$detect = new Mobile_Detect();
if ($detect->isMobile() && !$detect->isTablet())
    echo '<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T20:14:22.420

我使用以下代码仅允许用户在 iPad 上进行缩放。它不依赖于 jQuery，因此可以出于性能原因放置在头部、视口元数据之后和任何其他外部脚本之前。

```
<!-- Allow zooming for iPad only -->
<script>
    if (navigator.userAgent.match(/iPad/i)) {
        var viewport = document.querySelector("meta[name=viewport]");
        viewport.setAttribute('content', 'width=device-width; initial-scale=1; user-scalable=1;');
    }
</script> 
```

# c++ - 尝试使用类文件，出现“未定义的对 `WinMain@16' 的引用”错误

> ID：12774944
> 
> 赞同：2
> 
> 时间：2012-10-08T03:30:15.853
> 
> 标签：c++, class

> **可能重复：**
> [未定义对“WinMain@16”的引用](https://stackoverflow.com/questions/5259714/undefined-reference-to-winmain16)

我正在构建一个应用程序，该应用程序根据用户确定的估计旅行速度计算从预定城市到达用户选择的目的地所需的旅行时间。对于这个程序，我将使用类/类源文件。在编译我的源文件时，我不断收到错误“未定义对 `WinMain@16' 的引用”，由于我不熟悉源文件的用法，我不确定如何解决这个问题。对于正确使用源文件的正确方向，任何帮助将不胜感激。在此先感谢您的帮助。

头文件：

```
 #include <iostream>

    using namespace std;

    class Trip
    {
        private:
            string destination;
            double distance;

        public:
            void TripValue(string b, double c);
            void TripTime(Trip *a);
    }; 
```

源文件：

```
#include "Trip.h"
#include <iostream>

using namespace std;

void Trip::TripValue(string b, double c)
{
    destination = b;
    distance = c;
}

void Trip::TripTime(Trip *a)
{
    double user_speed;
    double time;

    cout << "Please enter your estimated travel speed in miles per hour: ";
    cin >> user_speed;
    cout << endl;

    time = (a->distance / user_speed);

    cout << endl;
    cout << "Your estimated travel time to " << a->destination << " is "
        << time << " hours.\n";
    cout << endl;
} 
```

申请代码：

```
#include <iostream>
#include "Trip.h"

using namespace std;

int main()
{
    Trip StL, Indy, Det, Nash, Dal, Den, NY, LA, Mia, Sea;

    int choice;

    StL.TripValue("St. Louis", 297.34);
    Indy.TripValue("Indianapolis", 184.78);
    Det.TripValue("Detroit", 282.73);
    Nash.TripValue("Nashville", 441.02);
    Dal.TripValue("Dallas", 925.91);
    Den.TripValue("Denver", 1004.93);
    NY.TripValue("New York", 791.50);
    LA.TripValue("Los Angeles", 2017.74);
    Mia.TripValue("Miami", 1363.55);
    Sea.TripValue("Seattle", 2032.31);

    do
    {
        cout << "=================================Trip Calulator=================================\n";
        cout << "Select your destination from Chicago:\n";
        cout << endl;
        cout << " 1\. St. Louis\n";
        cout << " 2\. Indianapolis\n";
        cout << " 3\. Detroit\n";
        cout << " 4\. Nashville\n";
        cout << " 5\. Dallas\n";
        cout << " 6\. Denver\n";
        cout << " 7\. New York\n";
        cout << " 8\. Los Angeles\n";
        cout << " 9\. Miami\n";
        cout << "10\. Seattle\n";
        cout << endl;
        cout << " 0\. Exit\n";
        cout << "================================================================================\n";

        cin >> choice;

        cout << endl;

        switch (choice)
        {
            case 1:
                StL.TripTime(&StL);
                break;
            case 2:
                Indy.TripTime(&Indy);
                break;
            case 3:
                Det.TripTime(&Det);
                break;
            case 4:
                Nash.TripTime(&Nash);
                break;
            case 5:
                Dal.TripTime(&Dal);
                break;
            case 6:
                Den.TripTime(&Den);
                break;
            case 7:
                NY.TripTime(&NY);
                break;
            case 8:
                LA.TripTime(&LA);
                break;
            case 9:
                Mia.TripTime(&Mia);
                break;
            case 10:
                Sea.TripTime(&Sea);
                break;
        }
    } while (choice != 0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:26:06.173

Thats a linker problem.

Try to change Properties -> Linker -> System -> SubSystem

from Windows (/SUBSYSTEM:WINDOWS) to Console (/SUBSYSTEM:CONSOLE)

# java - Java：在方法 main 中调用方法

> ID：12774945
> 
> 赞同：1
> 
> 时间：2012-10-08T03:30:27.653
> 
> 标签：java, methods, static, main

仅供参考：我是初学者。另外，我知道调用方法是一个新手概念，并且已经有一些这样的线程。我的情况有点不同，因为我非常受伪代码的限制，我的程序必须相同地镜像。我无法从其他方法调用方法，包括从 main 内部调用方法。这是伪代码，后面是我编写的代码：

伪代码：

```
// The user enters an integer and the program calculates that many primes
// It uses 3 methods, including the main. All the methods are in the same class
// and should be declared as ‘public static.’

Project Print the First n Primes
    Package printTheFirstNPrimesPackage
        Class PrintTheFirstNPrimes
            Method Main
                Declare numberOfPrimes as integer
Print “How many prime numbers do you want?"
                Read numberOfPrimes from the keyboard
                Call the method: PrintNPrimes(numberOfPrimes)
            end Method (Main)

//          ***********************************************************
//           This method accepts an integer and prints that many prime
//            numbers, starting at 2\. 2 is the lowest primt number. 
//          ***********************************************************
            Method void PrintNPrimes(int n)
                declare i as integer
                declare myNum as integer
                myNum = 2   // The first prime number
                i = 0
                loop while i < n    // This could be a ‘for’ loop
                if IsPrime(myNum)   // Call the Isprime method, (see below)
                    i = i + 1
                    print myNum
                End If
                myNum = myNum + 1
                end loop
            end Method PrintNPrimes
//          **********************************************************
//          This method accepts an integer and tests to see if it is 
//            a prime number. If it is prime, the method returns true,
//             otherwise it returns false.
//          **********************************************************
            Method boolean IsPrime(int number)
                Declare result as boolean
                result = true
                declare i as integer
                i = 2
                loop while i < number
                    if ((number % i) == 0)
                        result = false
                        exit loop
                    end if

                end loop
                return result
            end Method

        end Class
    End Package
End Project 
```

JAVA代码：

```
package printTheFirstNPrimesPackage;
import java.util.*;

public class PrintTheFirstNPrimes {
    public static void main(String [] args) {
        int numberOfPrimes;
        Scanner primes = new Scanner(System.in);
        System.out.println("How many prime numbers do you want?");
        numberOfPrimes = primes.nextInt();
        // Call the method PrintNPrimes(numberOfPrimes)
    }
    public static void PrintNPrimes(int n) {
        int i;
        int myNum;
        myNum = 2; // The first prime number
        i = 0; {
        while (i < n) 
//      if IsPrime(myNum) // Call the IsPrime method (see below) {
                i = i + 1;
                System.out.println(myNum);
        myNum = myNum + 1;
        }
    }
    public static boolean IsPrime(int number) {
        boolean result;
        result = true;
        int i = 2;
        while (i < number) {
            if ((number % 1) == 0)
                result = false;
            }
        return result;
        }
    } 
```

我的主要问题是在 if 语句中调用 IsPrime 方法。我收到一条错误消息，说 IsPrime 无法从我知道的 int 转换为 boolean，但伪代码限制了我做很多其他事情。我还想就如何在方法 main 中调用 PrintNPrimes 方法提出建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:32:05.470

因为您`PrintNPrimes`是静态方法，所以您可以通过传递`numberofPrimes`.

例子：

```
 public static void main(String [] args) {
        int numberOfPrimes;
        Scanner primes = new Scanner(System.in);
        System.out.println("How many prime numbers do you want?");
        numberOfPrimes = primes.nextInt();
       PrintNPrimes(numberOfPrimes);
    }
  .......... 
```

注意：Java 命名约定建议在定义方法时使用首字母作为小写字母。

您可以按照相同的方法调用其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:39:19.870

if IsPrime(myNum)

需要是

if (IsPrime(myNum))

还要确保恢复你的花括号。我看不出这会导致错误的任何原因。如果您仍有问题，请发布确切的错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T03:41:10.363

更新下面的代码，解决您的编译错误**（包括 if 语句） ：**

`printNPrimes(numberOfPrimes);`

`if (isPrime(myNum)) // Call the IsPrime method (see below) {`

完整更新的代码：

```
public static void main(String [] args) {
    int numberOfPrimes;
    Scanner primes = new Scanner(System.in);
    System.out.println("How many prime numbers do you want?");
    numberOfPrimes = primes.nextInt();
    printNPrimes(numberOfPrimes);
}
public static void printNPrimes(int n) {
    int i;
    int myNum;
    myNum = 2; // The first prime number
    i = 0; {
    while (i < n) 
     if (isPrime(myNum)) // Call the IsPrime method (see below) {
            i = i + 1;
            System.out.println(myNum);
    myNum = myNum + 1;
    }
}
public static boolean isPrime(int number) {
    boolean result;
    result = true;
    int i = 2;
    while (i < number) {
        if ((number % 1) == 0)
            result = false;
        }
    return result;
} 
```

我没有检查逻辑。

# iphone - 删除持久存储时 iPhone 应用程序崩溃

> ID：12774947
> 
> 赞同：0
> 
> 时间：2012-10-08T03:31:16.663
> 
> 标签：iphone, ios, core-data, restkit

我在我的 iphone 应用程序中删除/重置核心数据数据库时遇到问题，通常是在我调用以下命令时：

```
[self.persistentStoreCoordinator removePersistentStore:persistentStore error:&localError]; 
```

或者

```
[self.managedObjectStore resetPersistentStores:] // Restkit 
```

我可以在应用程序第一次启动时调用它，但似乎每当我将数据加载到 tableview 中时，应用程序在尝试删除持久存储时都会挂起。这是重置核心数据数据库的正确方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T04:54:33.180

对于初学者，您需要`reset`所有的`NSManagedObjectContext`s，否则上下文可能具有会导致错误的孤立对象。

然后，我总是直接从文件系统中删除 sqlite 文件并将 and 设置`managedObjectContext`为`persistentStoreCoordinator`nil （这样它将在下次访问时重建上下文并从头开始存储），而不是调用`removePersistentStore...`. 但是对于这一部分，我不确定哪种方式更合适。

# c - 警报（无符号整数秒）函数线程安全吗？

> ID：12774949
> 
> 赞同：2
> 
> 时间：2012-10-08T03:31:36.413
> 
> 标签：c, linux

有了`alarm`函数，我想实现UDP重传。这个函数线程安全吗？它会在多线程环境下工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:51:21.513

在线程中调用`alarm()`不会重置挂起的信号，因此您可能不想*在*线程中调用它。如果底层功能是 pthreads，那么无论您使用什么语言，您都只想在父级中调用它。

您可能最好在与线程共享的结构中进行规定，以便根据需要重新发送数据，或者戳所有（或部分）正在运行的线程以在为父级中的信号提供服务时重新发送。

我想不出在线程中调用它是一个好主意的实现，所以不 - 我不会那样使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T07:20:44.210

alarm() 函数不是线程安全的。

因为它是过程级别。一旦计时器触发，您就无法控制哪个线程应该接收信号。所以在信号到达的时候，另一个线程可能正在运行。有时它可能会使您使用 SIG_SEGV 使您的程序崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:41:20.137

根据[文档](http://pubs.opengroup.org/onlinepubs/009695399/functions/alarm.html) `alarm`是“进程级”并且只有最后一个调用处于活动状态......它使用信号模型并向进程发送异步SIGALARAM......被调用的信号处理程序是否是线程安全的取决于您的实现......

# scala - Scala 与 Mongodb 的集成

> ID：12774950
> 
> 赞同：1
> 
> 时间：2012-10-08T03:32:04.427
> 
> 标签：scala, mongodb

我们正在使用 mongodb，并用 scala 重写部分堆栈。我想知道我是否应该坚持使用 mophia，或者使用诸如子集的 scala mongodb 库。

问题是我能从子集中得到什么？例如，对于 mophia，我不必像在子集中必须手动定义 mongodb 字段名称...

子集真的值得使用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T07:03:11.613

我们使用[casbah](https://github.com/mongodb/casbah) + [salat](https://github.com/novus/salat)，几乎在所有情况下都可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T06:42:38.793

除了 ORM-Mapper/Client-Libraries，我建议你试试[Rouge 。](https://github.com/foursquare/rogue "流氓")它将为您提供一个很好的 Mongo Query DSL。Rogue 1.X 将仅支持[Lift-MongoDB](https://www.assembla.com/spaces/liftweb/wiki/MongoDB "Lift-MongoDB")，但 2.x 版（将在不久的将来发布）将适用于更多的 MongoDB 库。

一个示例查询将是（带有编译时类型检查的纯 Scala 代码）：

```
Venue where (_.mayor eqs 1234) and (_.categories contains "Thai") fetch(10) 
```

它查询 Venue 集合中的 10 个条目，其中 1234 是市长，Thai 是其类别之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T09:35:36.187

我是**Subset**的作者。我会说“子集”并不是一种真正的 ORM 库。它没有处理数据库和集合的方法，将其留给 Java/Scala 驱动程序。但它更侧重于 MongoDB 文档的转换。这个转换核心相当通用，不仅适用于读取/写入字段，而且适用于需要执行文档迁移等应用程序。Subset 提供的查询/更新构建器构建在这个“核心”之上。

也就是说，如果您需要 ORM，确实有更简单的选择。我从来没有打算让 Subset 与真正的 ORM 库竞争，我已经填补了我在项目中遇到的空白。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T06:34:26.557

对于 Scala，您应该考虑使用[Casbah](http://api.mongodb.org/scala/casbah/2.0/)，这是一个官方支持的 MongoDB 接口，它构建在 Java 驱动程序上。

> Casbah 的方法旨在在 MongoDB 之上添加流畅的、Scala 友好的语法，并处理常见类型的转换。如果您尝试将 Scala List 或 Seq 保存到 MongoDB，我们会自动将其转换为 Java 驱动程序可以序列化的类型。如果您阅读 Java 类型，我们会在它到达您的代码之前将其转换为可比较的 Scala 类型。所有这些都是为了让您专注于使用 Scala 惯用语编写最好的 Scala 代码。付出了巨大的努力，为您提供您期望从 Scala 获得的功能性和隐式转换工具，以及 MongoDB 的强大功能和灵活性。
> 
> Casbah 为 GridFS、Map/Reduce 和核心 Mongo API 提供了改进的接口。它还提供了一种模拟内部 DSL 的流畅查询语法，并允许您编写看起来像在 JS Shell 中编写的代码。还支持为常见数据类型轻松添加新的序列化/反序列化机制。

# python - 简单的 Python-MySQL 桥？

> ID：12774953
> 
> 赞同：2
> 
> 时间：2012-10-08T03:32:10.860
> 
> 标签：python, mysql, sql, database

Python 和 MySQL 之间是否有一个漂亮而简单的接口？我查看了 MySQLdb 模块、SQLAlchemy 和 MySQL 提供的模块。它们可以工作，但笨重且难以快速使用。我是 Python 的新手，但我已经在 MATLAB 中完成了这项工作，而且它们的界面非常简单。IE

每次您想在 Python 中执行查询时，您似乎都必须执行以下操作：

```
import datetime
import mysql.connector
cnx = mysql.connector.connect(user='scott', database='employees')
cursor = cnx.cursor()
query = ("SELECT first_name, last_name, hire_date FROM employees "
     "WHERE hire_date BETWEEN %s AND %s")
hire_start = datetime.date(1999, 1, 1)
hire_end = datetime.date(1999, 12, 31)
cursor.execute(query, (hire_start, hire_end))
for (first_name, last_name, hire_date) in cursor:
print("{}, {} was hired on {:%d %b %Y}".format(
last_name, first_name, hire_date))
cursor.close()
cnx.close() 
```

而在 MATLAB 中，我启动了一次连接（比如在启动程序时，然后检索一些东西就像（[从这里](http://www.mathworks.com/matlabcentral/fileexchange/8663-mysql-database-connector)）一样简单：

```
[Fn,Ln,Hd] = mysql(['SELECT first_name, last_name, hire_date FROM employees WHERE hire_date = ',num2str(some_date)]) 
```

每次查询时都无需创建游标和连接，只需一个简单的 I/O 查询执行器和数据返回器。我喜欢玩数据库，有很多跨平台项目。能够立即连接并查看 MATLAB 中的数据是一项很棒的功能。是否有 Python 桥可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T02:57:35.917

使用熊猫。它有一个很棒的界面。看这里：

[python-pandas 和 mysql 等数据库](https://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql)

我用它从 python 访问我的所有数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T03:57:55.187

[有一个名为SqlSoup](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/sqlsoup.html)的 SQLAlchemy 扩展，它消除了大部分设置的需要：

```
from sqlalchemy.ext.sqlsoup import SqlSoup
db = SqlSoup('mysql://scott:mypassword@localhost/employees') 
```

然后要运行 SQL 查询，请参阅SqlSoup 文档的[原始 SQL 部分：](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/sqlsoup.html#raw-sql)

```
rp = db.execute('select name, email from users where name like :name order by name', name='%Bhargan%')
for name, email in rp.fetchall():
    print name, email 
```

或者，如果您只想要一个结果，请使用相同的`db.execute`调用，然后：

```
name, email = rp.fetchone() 
```

您还可以使用 SQLAlchemy 的功能，例如它的[查询语法](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/sqlsoup.html#loading-objects)而不是编写 SQL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-08T03:53:36.797

当然，你可以写一个像这样的生成器

```
import datetime
import mysql.connector

def do_mysql(query, *args):
    cnx = mysql.connector.connect(user='scott', database='employees')
    cursor = cnx.cursor()
    cursor.execute(query, args)
    for result in cursor:
        yield result
    cursor.close()
    cnx.close() 
```

但是现在`username`and`database`被硬编码到函数中。不过，MATLAB 也必须将这些参数存储在某个地方。

您可以将`username`and`database`拉出作为额外参数，但随后您又回到了相同级别的复杂性 - 没有能够控制连接池等的优势。

```
def do_mysql(user, database, query, *args):
    cnx = mysql.connector.connect(user=user, database=database)
    cursor = cnx.cursor()
    cursor.execute(query, args)
    for result in cursor:
        yield result
    cursor.close()
    cnx.close() 
```

因此，为了从处理大量数据库查询的程序中获得我们需要的性能，我们至少需要将连接传入

```
def do_mysql(cnx, query, *args):
    cursor = cnx.cursor()
    cursor.execute(query, args)
    for result in cursor:
        yield result
    cursor.close() 
```

啊，现在这个函数没有任何胆量，代码的所有参数部分都被推回给调用者

# mysql - 将 CSV 导出到 MySQL

> ID：12774957
> 
> 赞同：0
> 
> 时间：2012-10-08T03:32:45.680
> 
> 标签：mysql, excel, csv

我想做一些非常简单的事情。我只想将 excel 数据导出到 CSV 以便将其放入 Mysql DB。

这是一个巨大的excel，所以我不能轻易管理异常。

我的问题是，当我将 xslx 保存到 csv 中时，`"`只有当列中有逗号或已经存在时，它才会将我分隔列，`"`所以我的 CSV 中有类似的内容：

```
col1 | col2 | col3 => col1,col2,col3
col1 | co,l2| col3 => col1,"co,l2",col3 
col1 |"col"2| col3 => col1,"""col""2",col3 
col1 |      | col3 => col1,,col3 
```

所以我尝试了很多方法来将它转换为 SQL，但我没有找到一个好方法。

我在 Excel 2007 中工作，并且 SQL 希望 CSV 具有此配置：

```
Columns separated with: ,
Columns enclosed with: "
Columns escaped with: \
Lines terminated with: auto 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T06:09:47.127

所以你想[加载你的数据](http://dev.mysql.com/doc/refman/5.6/en/load-data.html)使用

```
LOAD DATA FROM INFILE 'filename.csv'
INTO TABLE tablename
COLUMNS TERMINATED BY ','
        OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\r\n' 
```

加载文件时实际上会忽略 ，或者用更好的`OPTIONALLY`方式来表述它，即使您没有指定`OPTIONALLY`，封闭仍然被视为可选。这意味着列值*可以*用引号括起来，但*不是*必须的。请注意，afaik。Excel 不使用`\`转义值。

如果您需要其他格式来导入 MySQL 以外的其他目的，那么您可以在之后使用您喜欢的设置从 MySQL 重新导出数据。[写入文件](http://dev.mysql.com/doc/refman/5.6/en/select-into.html)时，省略`OPTIONALLY`将为每个值打开引号。

# android - 在eclipse中导入现有项目时出错

> ID：12774960
> 
> 赞同：1
> 
> 时间：2012-10-08T03:33:10.633
> 
> 标签：android, import

我正在使用此代码在 Eclipse 中运行。[搜索下载示例](http://developer.android.com/training/custom-views/optimizing-view.html#less)

在eclipse中导入下载的项目后。我收到错误

```
import android.animation.Animator;
import android.animation.ObjectAnimator;
import android.animation.ValueAnimator; 
```

日食找不到课程*`Animation,ObjectAnimator and ValueAnimator`*

任何建议将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T03:38:43.557

在 eclipse BuildPath 中包含您的动画 jar。右键单击项目转到`Buildpath->Configure Build Path ->Libraries`并添加你的jar。还有一种可能是您的 Animator 和其他类被错误的包名提及。检查出。它应该可以解决问题。

# algorithm - P 与 NP 澄清

> ID：12774968
> 
> 赞同：7
> 
> 时间：2012-10-08T03:34:11.477
> 
> 标签：algorithm, time-complexity, discrete-mathematics

引用自维基百科的 P vs NP 问题，关于算法的时间复杂度“......询问是否每个问题的解决方案都可以通过计算机快速验证，也可以通过计算机快速解决。”

我希望有人可以在这里澄清“验证问题”和“解决问题”之间的区别。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-08T03:38:40.330

> 我希望有人可以在这里澄清“验证问题”和“解决问题”之间的区别。

不是*“验证**问题**”*，而是*“验证**解决方案**”*。例如，您可以在多项式时间内检查给定集合是否对[SAT](http://en.wikipedia.org/w/index.php?title=Boolean_satisfiability_problem&oldid=558043033)有效。这种集合的实际生成是 NP 困难的。[Wikipedia 文章 NP (complexity) 中](http://en.wikipedia.org/w/index.php?title=NP_%28complexity%29&oldid=562909910#Verifier-based_definition)[*基于验证器的定义*](http://en.wikipedia.org/w/index.php?title=NP_%28complexity%29&oldid=562909910#Verifier-based_definition)部分可以为您提供一些帮助：

> ### 基于验证者的定义
> 
> 为了解释**NP**的基于验证者的定义，让我们考虑子集和问题：假设给定一些整数，例如 {−7, −3, −2, 5, 8}，我们希望知道这些整数中的一些是否总和为零。在这个例子中，答案是“是”，因为整数子集 {−3, −2, 5} 对应于和 (−3) + (−2) + 5 = 0。存在总和为零的子集称为子集和问题。
> 
> 随着我们输入算法的整数数量变大，子集的数量呈指数增长，实际上子集和问题是**NP 完全**的。但是，请注意，如果给定一个特定的子集（通常称为证书），我们可以轻松地检查或验证子集总和是否为零，只需将子集的整数相加即可。因此，如果总和确实为零，则该特定子集就是答案为“是”这一事实的证据或见证。验证给定子集的和是否为零的算法称为验证器。据说问题出在**NP中**当且仅当存在一个在多项式时间内执行的问题的验证器。在子集和问题的情况下，验证者只需要多项式时间，因此子集和问题在**NP**中。

如果您更喜欢图论，那么[汉密尔顿循环](http://en.wikipedia.org/w/index.php?title=Hamiltonian_path&oldid=564480425)是一个 NP 完全问题。检查给定的解决方案是否是汉密尔顿循环（线性复杂度，遍历解决方案路径）是微不足道的，但如果 P != NP 则不存在解决问题的多项式运行时算法。

在这种情况下，“快速”一词可能具有误导性。当且仅当算法在最坏情况下的运行时间受多项式函数（例如`O(n)`或）限制时，算法在这方面的速度很快`O(n log n)`。使用长度为给定范围创建所有排列`n`是没有限制的，因为您有`n!`不同的排列。这意味着问题可以在*n ^(100) log n*中解决，这将需要很长时间，但这仍然被认为是很快的。另一方面，TSP 的第一个算法是 O(n!)，另一个是 O(n ² 2 ^n )。与多项式函数相比，这些东西增长得非常非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-31T18:58:00.190

RSA 加密使用如下素数：将两个大素数 P 和 Q（每个 200-400 位）相乘以形成公钥 N。`N=P*Q` 要破解加密，需要在给定 N 的情况下计算出 P 和 Q。 P 和 Q 非常困难，可能需要数年时间，验证解决方案只是将 P 乘以 Q 并与 N 进行比较。因此解决问题非常困难，而验证解决方案不需要任何时间。

PS 该示例只是针对此问题简化的 RSA 的一部分。真正的 RSA 要复杂得多。

# .net - 哪些异常不能处理？

> ID：12774975
> 
> 赞同：1
> 
> 时间：2012-10-08T03:35:43.480
> 
> 标签：.net, exception, out-of-memory, stack-overflow

> **可能重复：**
> [在 .NET 中无法捕获的异常列表](https://stackoverflow.com/questions/7392783/list-of-exceptions-that-cant-be-caught-in-net)

如文档所述，try/catch 块无法处理 StackOverflowException 和 OutOfMemoryException。

是否还有其他例外情况也受到此限制的影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:47:06.193

Jeffrey Richter 在他的《通过 C# 实现的 CLR》一书中就这个主题提出了几个很好的观点，部分“以可靠性换取生产力”。

顺便说一句，您可以捕获并处理 OutOfMemory：

> 出于某种我无法完全解释的原因，在为 .NET Framework 编写代码时，并没有对细节进行这种关注。总是可能出现内存不足的情况，但我几乎从未见过任何包含从 OutOfMemoryException 中恢复的 catch 块的代码。事实上，我什至有一些开发人员告诉我，CLR 不允许程序捕获 OutOfMemoryException。郑重声明，这绝对不是真的；你可以捕捉到这个异常。事实上，在执行托管代码时可能会出现许多错误，而且我几乎从未见过开发人员编写代码来尝试从这些潜在故障中恢复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T03:39:14.337

唯一不能直接捕获的异常是（框架抛出的）StackOverflowException。从逻辑上讲，这是有道理的，因为此时堆栈中没有空间来处理异常。从文档：

> 从 .NET Framework 2.0 版开始，StackOverflowException 对象无法被 try-catch 块捕获，并且默认情况下会终止相应的进程。

ThreadAbortException 可以被捕获，但总是会被重新引发，因此具有独特的行为。从文档：

> ThreadAbortException 是一个可以被捕获的特殊异常，但它会在 catch 块结束时自动再次引发。

参考：[不能在 .NET 中捕获的异常列表](https://stackoverflow.com/questions/7392783/list-of-exceptions-that-cant-be-caught-in-net)

# windows - 如何递归更改 WAMP 服务器上的文件夹权限

> ID：12774977
> 
> 赞同：3
> 
> 时间：2012-10-08T03:36:03.997
> 
> 标签：windows, recursion, permissions, directory, wamp

如何在 Windows 7 中递归更改文件夹权限？具体来说，对于我的 WAMP 服务器，我想更改我的“www”文件夹的权限，以便可以通过 Internet 查看其内容，并且我希望它的所有子文件夹都具有相同的权限。目前，对于每个文件夹，我的浏览器中都会收到以下消息：“您无权访问此服务器上的 /。” 我相信我可以在终端中输入一个简单的命令，以递归地更改文件夹权限以进行全局访问；我只是不知道它是什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-08T04:03:08.380

在属性 > 安全选项卡 > 高级 > 更改权限下更改权限时，必须选中将所有子对象权限替换为此对象的可继承权限复选框 在 GUI 中对父文件夹执行此操作。

# c# - 一种通用 Find 方法，用于按 Guid 类型搜索实现 IDbSet 接口的类

> ID：12774979
> 
> 赞同：2
> 
> 时间：2012-10-08T03:36:11.577
> 
> 标签：c#, entity-framework, entity-framework-4, dbcontext

我正在通过实现 IDbSet 接口来实现 FakeDataSet 类。作为实现这个接口的一部分，我必须实现 Find 方法。我所有的实体类都有一个 Guid 类型 Id 列。我正在尝试为此 FakeDbSet 类实现 Find 方法，但很难以通用方式编写它。以下是我编写此方法的尝试。

```
public class FakeDataSet<T> : IDbSet<T> where T: class, new()  
{  
  //  Other methods for implementing  IDbSet interface
  public T Find(params object[] keyValues)  
  {  
       var keyValue = (Guid)keyValues.FirstOrDefault();
       return this.SingleOrDefault(m => m.Id == keyValue);  // How can I write this
  }
} 
```

由于它不知道 Id 属于 Guid 类型，因此我在 m.Id 调用时遇到编译错误。

> “T”不包含“Id”的定义，并且找不到接受“T”类型的第一个参数的扩展方法“Id”（您是否缺少 using 指令或程序集引用？）

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:49:48.660

像这样给你一个想法：

```
public virtual T Find(params object[] keyValues)
{
    if (keyValues.Length != _keyProperties.Count)
        throw new ArgumentException("Incorrect number of keys passed to find method");

    IQueryable<T> keyQuery = this.AsQueryable<T>();

    for (int i = 0; i < keyValues.Length; i++)
    {
        var x = i; // nested linq

        keyQuery = keyQuery.
        Where(entity => _keyProperties[x].GetValue(entity, null).Equals(keyValues[x]));
    }

    return keyQuery.SingleOrDefault();
} 
```

Source: [Generic Repository: Fake IDbSet implementation update (Find Method & Identity key)](http://refactorthis.wordpress.com/2011/11/30/generic-repository-fake-idbset-implementation-update-find-method-identity-key/)

# android - 系统警报视图上的 Android onFocusChangeListener

> ID：12774982
> 
> 赞同：2
> 
> 时间：2012-10-08T03:36:23.377
> 
> 标签：android, focus, android-view

我`onFocusChangedListener`在视图上设置了 a 并使用`windowmanager`并添加了 TYPE_ `SYSTEM`_ALERT 视图`addView()`

但是，`onFocusChanged`即使*我拉下覆盖视图的通知面板*，也不会调用。我很确定视图没有聚焦，因为当面板关闭时，主页键不再被禁用。

有任何想法吗？

# ruby-on-rails - 尝试使用acts_as_tree 显示父名称时出错

> ID：12774983
> 
> 赞同：0
> 
> 时间：2012-10-08T03:36:47.543
> 
> 标签：ruby-on-rails, ruby-on-rails-3, acts-as-tree

我正在使用充当树宝石来创建`Category`模型：

```
 1 class Category < ActiveRecord::Base
  2   include ActsAsTree
  3   attr_accessible :name
  4 
  5   acts_as_tree order: "name"
  6 end 
```

在我的一种观点中，我试图显示该类别的父级名称：

```
 12 <% @categories.each do |category| %>
 13   <tr>
 14     <td><%= category.name %></td>
 15     <td><%= category.parent.name %></td>
 16     <td><%= link_to 'Show', category %></td>
 17     <td><%= link_to 'Edit', edit_category_path(category) %></td>
 18     <td><%= link_to 'Destroy', category, method: :delete, data: { confirm: '
 19   </tr>
 20 <% end %> 
```

但是，访问视图时出现错误：

```
undefined method `name' for nil:NilClass 
```

但是，我可以`category.parent_id`成功显示。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T04:08:52.663

您的数据库中有脏数据。`nil`当您调用`category.parent`时，当您调用`name`方法时，`category.parent`您实际上是在调用`name`方法`nil`，因此它`undefined method`为 nil:NilClass提供了一个错误名称

当您有如下数据时会发生这种情况

```
id  name      parent_id
2   child1     1     
3   child2     1 
```

现在我的表中有以上两个数据，在这里您可以看到`parent`两个记录都是`1`，因此必须有一个带有 id 的记录`1`。

```
<%
   child = Model.find 2
   child.parent_id #This gives you `1`
   child.parent #This gives you `nil`
   child.parent.name #This gives you error undefined method `name' for nil:NilClass
 %> 
```

# android - 尝试使用 Eclipse 执行/调试现有的 APK 文件

> ID：12774985
> 
> 赞同：0
> 
> 时间：2012-10-08T03:37:40.047
> 
> 标签：android, eclipse, debugging, apk

我有一个没有任何来源的现有 .APK 文件。我想在 Bluestacks（或其他）模拟器上使用 Eclipse 对其进行调试。最后，我想设置一个断点，但现在，我只想让它在模拟器上运行。我不是在谈论仅使用 adb 将其安装在模拟器上然后在那里运行。我没有成功让 Eclipse 构建的生成的 .apk 在模拟器上运行。

以下是我已完成的步骤：

1.  我将 .apk 重命名为 .zip 并解压缩到一个文件夹中。
2.  在 Eclipse 中，我从现有代码创建了一个新的“Android 项目”。在下一个屏幕“导入项目”中，我浏览到解压缩 apk 的文件夹。

但是这个项目在 Eclipse 中有错误！所以我尝试了接下来的步骤：

1.  我在 .apk 上执行了 apktool，它创建了一个文件夹，用于在步骤 2 中提到的相同导入。现在项目不再有错误。
2.  在 Eclipse 中，我将此项目作为 Android 应用程序“运行”或“调试”，它在模拟器上启动。

不好！logcat 显示诸如“dalvikv - 线程退出但未捕获异常”之类的错误。还有其他关于无法实例化应用程序和 java.lang.ClassNotFoundException 的 logcat 消息。

问题 1：有人能告诉我还需要哪些其他步骤才能将其变成“好”项目吗？关于课程，我有什么明显的遗漏吗？

一旦我可以让它成功地“运行为”或“调试为”，然后我会想通过设置一个断点来调试它。但我似乎无法正确获取源文件夹。由于步骤 3 中提到的 apktool 步骤，我有 .smali 文件。此外，我尝试了各种工具，例如 dex2jar 和 jd-gui，因此我有 .java 文件。但是，每当我告诉 Eclipse 这些源所在的文件夹（并且我检查了“搜索子文件夹”）时，Eclipse 都会说“找不到源”。和“编辑源查找路径”。我还尝试将源代码放在工作区的 /src 文件夹中。

问题 2：我可以将源代码放在哪里以便 Eclipse 找到它们？这些源文件可以是 .smali 还是 .java？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T04:16:30.610

所以基本上你要做的是从打包的 APK 文件中提取源代码。你所取得的成就是我也能做到的最大值。由于在打包 APK 文件时进行了混淆，因此无法获得准确和真实的源代码。所以你达到的就是你能达到的最大值。我使用了这些工具，但从未像作者所写的那样提取真正的 .java 文件。它将包含一些 Eclipse 无法理解的编译器添加和优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T02:08:00.463

问题 1：您将有很多步骤从 .apk 文件中获取 android 项目。这项工作被命名为倒车、解码...

*   您可以使用 apktool 将 apk 反编译为 .smali 文件
*   然后使用 javaDecompiler 将 .smali 文件反转为 .java 文件
*   创建项目并将 .java 文件导入其中

问题2：试试问题1，你可以做到。

注意：如果编写该 apk 的开发人员使用 proguard，您只会看到代码的后续。

# hadoop - 如何在命令行中打印 hadoop 属性？

> ID：12774988
> 
> 赞同：24
> 
> 时间：2012-10-08T03:37:46.350
> 
> 标签：hadoop

我只找到设置属性的方法`hadoop dfsadmin -D xx=yy`，

但是如何`xx`在命令行中找到特定属性的值？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2014-11-18T13:21:10.960

您可以通过运行转储 Hadoop 配置：

```
$ hadoop org.apache.hadoop.conf.Configuration 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-11-19T12:57:04.843

从配置中获取特定密钥

```
hdfs getconf -confKey [key]

hdfs getconf -confKey dfs.replication 
```

[https://hadoop.apache.org/docs/r2.7.1/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#getconf](https://hadoop.apache.org/docs/r2.7.1/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#getconf)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-08T09:59:25.960

您可以使用 GenericOptionsParser 将 Hadoop 的设置加载到配置类型的对象并迭代其属性。这是一个通过实用程序类（已配置）演示此方法的示例。

```
public class ConfigPrinter extends Configured implements Tool {
    static {
        // by default core-site.xml is already added
        // loading "hdfs-site.xml" from classpath
        Configuration.addDefaultResource("hdfs-site.xml");
        Configuration.addDefaultResource("mapred-site.xml");
    }

    @Override
    public int run(String[] strings) throws Exception {
        Configuration config =  this.getConf();
        for (Map.Entry<String, String> entry : config) {
            System.out.println(entry.getKey() + " = " + entry.getValue());
        }
        return 0;
    }

    public static void main(String[] args) throws Exception {
        ToolRunner.run(new ConfigPrinter(), args);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-28T19:33:22.777

在另一个答案中使用出色的 ConfigPrinter 程序，我继续创建了一个可执行和可编译的版本。有关代码，请参见[https://github.com/tdunning/config-print](https://github.com/tdunning/config-print)。

要使用它，请将 pom.xml 文件中的 hadoop 版本更改为您使用的任何版本。然后执行此操作（您将需要安装 git、maven 和 java）：

```
$ git clone https://github.com/tdunning/config-print.git
Cloning into 'config-print'...
remote: Enumerating objects: 13, done.
remote: Counting objects: 100% (13/13), done.
remote: Compressing objects: 100% (8/8), done.
remote: Total 13 (delta 1), reused 12 (delta 0), pack-reused 0
Unpacking objects: 100% (13/13), done.
$ cd config-print/
$ mvn -q package
$ ./target/config-printer | sort
log4j:WARN No appenders could be found for logger (org.apache.hadoop.util.Shell).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
dfs.ha.fencing.ssh.connect-timeout = 30000
file.blocksize = 67108864
file.bytes-per-checksum = 512
file.client-write-packet-size = 65536
file.replication = 1
file.stream-buffer-size = 4096
fs.AbstractFileSystem.file.impl = org.apache.hadoop.fs.local.LocalFs
fs.AbstractFileSystem.ftp.impl = org.apache.hadoop.fs.ftp.FtpFs
fs.AbstractFileSystem.har.impl = org.apache.hadoop.fs.HarFs
fs.AbstractFileSystem.hdfs.impl = org.apache.hadoop.fs.Hdfs
fs.AbstractFileSystem.viewfs.impl = org.apache.hadoop.fs.viewfs.ViewFs
... lots of stuff deleted ...
s3native.stream-buffer-size = 4096
s3.replication = 3
s3.stream-buffer-size = 4096
tfile.fs.input.buffer.size = 262144
tfile.fs.output.buffer.size = 262144
tfile.io.chunk.size = 1048576
tdunning@nodea:~/config-print$ 
$ 
```

# php - 使用我的代码不起作用的表单更新 MySQL

> ID：12774989
> 
> 赞同：0
> 
> 时间：2012-10-08T03:37:55.640
> 
> 标签：php, mysql

我正在尝试在这里做一些非常简单的事情。我要做的就是更新 MySQL 中的信息这是表单下面的代码。

```
 <?php
 $host=""; // Host name 
 $username=""; // Mysql username 
 $password=""; // Mysql password 
 $db_name=""; // Database name 
 $tbl_name=""; // Table name 

 // Connect to server and select database.
 mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
 mysql_select_db("$db_name")or die("cannot select DB");

 // get value of id that sent from address bar
 $dj=$_GET['dj'];

 // Retrieve data from database 
 $sql="SELECT * FROM $tbl_name WHERE dj='$dj'";
 $result=mysql_query($sql);
 $rows=mysql_fetch_array($result);
 ?>

<table width="400" border="0" cellspacing="1" cellpadding="0">
<tr>
<form name="form1" method="post" action="update_ac.php">
<td>
<table width="100%" border="0" cellspacing="1" cellpadding="0">
<tr>
<td>&nbsp;</td>
<td colspan="3"><strong>Update The information for the Now PlayingProgram.</strong>
</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center"><strong>Name</strong></td>
<td align="center"><strong>Email</strong></td>
<td align="center"><strong>Email2</strong></td>
</tr>
<tr>
<td>&nbsp;</td>
<td align="center">
<input name="name" type="text" id="name" value="<?php echo $rows['name']; ?>">
</td>
<td align="center">
<input name="email" type="text" id="email" value="<?php echo $rows['email']; ?>" size="15">
</td>
<td>
<input name="email2" type="text" id="email2" value="<?php echo $rows['email2']; ?>" size="15">
</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center"><strong>Twitter</strong></td>
<td align="center"><strong>Twitter2</strong></td>
<td align="center"><strong>Avatar</strong></td>
</tr>
<tr>
<td>&nbsp;</td>
<td align="center">
<input name="twitter" type="text" id="twitter" value="<?php echo $rows['twitter']; ?>">
</td>
<td align="center">
<input name="twitter2" type="text" id="twitter2" value="<?php echo $rows['twitter2']; ?>" size="15">
</td>
<td>
<input name="avatar" type="text" id="avatar" value="<?php echo $rows['avatar']; ?>" size="15">
</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center"><strong>Facebook</strong></td>
<td align="center"><strong>Facebook2</strong></td>
<td align="center"><strong>Type</strong></td>
</tr>
<tr>
<td>&nbsp;</td>
<td align="center">
<input name="facebook" type="text" id="facebook" value="<?php echo $rows['facebook']; ?>">
</td>
<td align="center">
<input name="facebook2" type="text" id="facebook2" value="<?php echo $rows['facebook2']; ?>" size="15">
</td>
<td>
<input name="type" type="text" id="type" value="<?php echo $rows['type']; ?>" size="15">
</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center"><strong>Alias1</strong></td>
<td align="center"><strong>Alias2</strong></td>
<td align="center"><strong>Alias3</strong></td>
</tr>
<tr>
<td>&nbsp;</td>
<td align="center">
<input name="alias1" type="text" id="alias1" value="<?php echo $rows['alias1']; ?>">
</td>
<td align="center">
<input name="alias2" type="text" id="alias2" value="<?php echo $rows['alias2']; ?>" size="15">
</td>
<td>
<input name="alias3" type="text" id="alias3" value="<?php echo $rows['alias3']; ?>" size="15">
</td>
</tr>

<tr>
<td align="center">&nbsp;</td>
 <td colspan="3" align="center"><strong>Request Line</strong></td>
</tr>
<tr>
<td>&nbsp;</td>
<td colspan="3" align="center">
 <input name="address" type="text" id="address" value="<?php echo $rows['address']; ?>" size="65">
 </td>
 </tr>
 <tr>
 <td>&nbsp;</td>
 <td>
 <input name="dj" type="hidden" id="dj" value="<?php echo $rows['dj']; ?>">
 </td>
 <td align="center">
 <input type="submit" name="Submit" value="Submit">
 </td>
 <td>&nbsp;</td>
 </tr>
 </table>
 </td>
 </form>
 </tr>
 </table>
  <?php
 // close connection 
 mysql_close();
 ?> 
```

现在我想要做的是编辑当前显示在表单中的数据库中的信息。（表单显示来自 mysql 的正确信息）如果我想更改让我们说 email2 我会在字段中这样做，然后单击提交。那么我的问题是，当我这样做时，我得到的只是错误。

所以让我们看看我的 update_ac.php 代码如下：

```
<?php
$host="localhost"; // Host name 
$username=""; // Mysql username 
$password=""; // Mysql password 
$db_name=""; // Database name 
$tbl_name=""; // Table name 

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// update data in mysql database 
$sql="UPDATE currentdj SET  name='$name',
                        email='$email',
                        email2='$email2',                           
                        twitter='$twitter',
                        twitter2='$twitter2',
                        avatar='$avatar',                           
                        facebook='$facebook',
                        facebook2='$facebook2',
                        type='$type',
                        alias1='$alias1',
                        alias2='$alias2',
                        alias3='$alias3',
                        address='$address'                          
                        WHERE dj='$dj'";
$result=mysql_query($sql);

// if successfully updated. 
if($result){
echo "Successful";
echo "<BR>";
echo "<a href='list_records.php'>View result</a>";
}

else {
echo "ERROR";
}

?> 
```

我想知道我是否只是有语法甚至拼写问题！任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T03:41:38.440

在`UPDATE`查询单引号未关闭`email`字段`email='$email,`

```
"UPDATE currentdj SET  name='$name',
                        email='$email',    //Add THE MISSING SINGLE QUOTE HERE
                        email2='$email2', 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T03:46:47.443

试试这段代码，在 where `,`( `address='$address', WHERE dj='$dj'";`) 不应该出现 之前

```
$sql="UPDATE currentdj SET  name='$name',
                        email='$email',
                        email2='$email2',                           
                        twitter='$twitter',
                        twitter2='$twitter2',
                        avatar='$avatar',                           
                        facebook='$facebook',
                        facebook2='$facebook2',
                        type='$type',
                        alias1='$alias1',
                        alias2='$alias2',
                        alias3='$alias3',
                        address='$address'                        
                        WHERE dj='$dj'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T03:51:12.730

在您的 update_ac.php 文件中，您没有使用`$_POST[]`变量从表单中检索值。结果，没有值被插入到数据库中，因此出现错误。

将此代码放在具有 $sql="UPDATE..... 的更新查询语句之前

```
 $email=$_POST['email'];
 $email2=$_POST['email2'];                          
 $twitter=$_POST['twitter']; 
```

等等...

# c++ - 如果为假，如何从`main中取消`ConfirmChoice`功能？

> ID：12774995
> 
> 赞同：1
> 
> 时间：2012-10-08T03:39:04.393
> 
> 标签：c++

`ConfirmChoice`在启动其余代码之前，我需要从主函数中取消。我已经尝试了很多，但无法弄清楚。

```
#include <iostream>
#include <iomanip>
using namespace std;

const char CASH = 'C';
const char CREDIT = 'D';
const char NOSEBLEED = 'N';
const char BOX_SEAT = 'B';
const char FIFTY_YARD_LINE = 'F';
const char STUDENT_SECTION = 'S';
const float NOSEBLEED_PRICE = 43.42;
const float BOX_SEAT_PRICE = 353.85;
const float FIFTY_YARD_LINE_PRICE = 94.05;
const float STUDENT_SECTION_PRICE = 19.99;

//---------------------------------------------------------------
// Function: ConfirmChoice
// Purpose:  Confirms the users ticket purchase before processing payment
// Parameters:  TicketType - The type of ticket selected
// Returns:  true if the user confirms the selection, false otherwise
//--------------------------------------------------------------
bool ConfirmChoice(const char TicketType)
{
   char Choice;
   bool Confirmed;

   // Print out their selection
   cout << "\nYou have chosen to purchase ";
   cout << fixed << setprecision(2);
   switch (TicketType)
   {
   case NOSEBLEED:
      cout << "Nosebleed ticket(s) at a price of $";
      cout << NOSEBLEED_PRICE << ".\n";
      break;
   case BOX_SEAT:
      cout << "Box Seat ticket(s) at a price of $";
      cout << BOX_SEAT_PRICE << ".\n";
      break;
   case FIFTY_YARD_LINE:
      cout << "Ticket(s) on the 50 yard line at a price of $";
      cout << FIFTY_YARD_LINE_PRICE << ".\n";
      break;
   case STUDENT_SECTION:
      cout << "Ticket(s) in the Student Section at a price of $";
      cout << STUDENT_SECTION_PRICE << ".\n";
      break;
   }

   // Confirm the selection
   cout << "Do you wish to confirm your purchase? Enter Y or N: ";
   cin >> Choice;
   Choice = toupper(Choice);
   while (Choice != 'Y' && Choice != 'N')
   {
      cout << "Invalid selection.  Please enter either Y or N: ";
      cin >> Choice;
      Choice = toupper(Choice);
   }
   Confirmed = (Choice == 'Y');

   // Check confirmation        
   if (Confirmed)
      cout << "You have confirmed your choice.\n" << endl;
   else
      cout << "You not confirmed your choice.\n" << endl;
   return (Confirmed);
}

//-------------------------------------------
// Function: CalculateChange
// Purpose:  To output the change due
// Parameters:  ChangeDue - The amount of change needed 
// Returns:  Nothing
//-------------------------------------------
void CalculateChange(const float ChangeDue)
{
   int Change = 0;
   int Dollars = 0;
   int Quarters = 0;
   int Dimes = 0;
   int Nickels = 0;
   int Pennies = 0;

   // Compute change  
   Change = ChangeDue * 100;
   Dollars = Change / 100;
   Change = Change % 100;
   Quarters = Change / 25;
   Change = Change % 25;
   Dimes = Change / 10;
   Change = Change % 10;
   Nickels = Change / 5;
   Pennies = Change % 5;

   // Print out change
   cout << "Your change is \n\t";
   cout << Dollars << " Dollars\n\t";
   cout << Quarters << " Quarters\n\t";
   cout << Dimes << " Dimes\n\t";
   cout << Nickels << " Nickels\n\t";
   cout << Pennies << " Pennies\n";
}

 int main()
{   
   // Prints my name and UAID
        cout <<"\n\nName: Ivory Newbern\n";
        cout << "UAID: 010563918\n";

   // Declarations 

   char TChoice ;       // Ticket type: Nosebleed, box seats etc.. 
   char PChoice = GetPaymentType();     // Payment choice: cash or credit card
   bool Confirmed ;     // Did the user confirm the selection
   float Cost ;         // The cost of the ticket puchased
   float ChangeDue;     // The amount of change owed (for cash purchases)

   // Get the choice of payment type
    PChoice;

   // Get the choice of ticket type
    GetTicketType( TChoice);
   // Confirm the selection
    ConfirmChoice( TChoice);

    // If they confirm the purchase

      // Calls functions to figure out the price of ticket purchase(s) 

           if (TChoice == BOX_SEAT)
               Cost = CalculateCost(BOX_SEAT_PRICE);
           if (TChoice == NOSEBLEED)
               Cost = CalculateCost(NOSEBLEED_PRICE);
           if (TChoice == STUDENT_SECTION)
               Cost = CalculateCost(STUDENT_SECTION_PRICE);
           if (TChoice == FIFTY_YARD_LINE)
               Cost = CalculateCost(FIFTY_YARD_LINE_PRICE);

      // Handles the payment 

           if( PChoice == 'C');
                PayWithCash(Cost,ChangeDue) , CalculateChange(ChangeDue);
           if( PChoice == 'D')
                PayWithCredit(Cost);

       // Say goodbye to the customer
           if (TChoice == BOX_SEAT)
           cout << "Thank you for the purchase of your 'BOX_SEAT' tickets ,have a nice day!" << endl;
           if (TChoice == NOSEBLEED)
              cout << "Thank you for the purchase of your 'NOSEBLEED' tickets ,have a nice day!" << endl; 
           if (TChoice == STUDENT_SECTION)
              cout << "Thank you for the purchase of your 'STUDENT_SECTION' tickets ,have a nice day!" << endl;
           if (TChoice == FIFTY_YARD_LINE)
                cout << "Thank you for the purchase of your 'FIFTY_YARD_LINE' tickets ,have a nice day!" << endl;

   // Else

      // Cancel the purchase 
    system ("PAUSE");
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T03:44:23.153

像这样：

```
if( ConfirmChoice( TChoice));

       {

               if (TChoice == BOX_SEAT)
                   Cost = CalculateCost(BOX_SEAT_PRICE);
               if (TChoice == NOSEBLEED)
                   Cost = CalculateCost(NOSEBLEED_PRICE);
               if (TChoice == STUDENT_SECTION)
                   Cost = CalculateCost(STUDENT_SECTION_PRICE);
               if (TChoice == FIFTY_YARD_LINE)
                   Cost = CalculateCost(FIFTY_YARD_LINE_PRICE);

          // Handles the payment 

               if( PChoice == 'C');
                    PayWithCash(Cost,ChangeDue) , CalculateChange(ChangeDue);
               if( PChoice == 'D')
                    PayWithCredit(Cost);

           // Say goodbye to the customer
               if (TChoice == BOX_SEAT)
               cout << "Thank you for the purchase of your 'BOX_SEAT' tickets ,have a nice day!" << endl;
               if (TChoice == NOSEBLEED)
                  cout << "Thank you for the purchase of your 'NOSEBLEED' tickets ,have a nice day!" << endl; 
               if (TChoice == STUDENT_SECTION)
                  cout << "Thank you for the purchase of your 'STUDENT_SECTION' tickets ,have a nice day!" << endl;
               if (TChoice == FIFTY_YARD_LINE)
                    cout << "Thank you for the purchase of your 'FIFTY_YARD_LINE' tickets ,have a nice day!" << endl;

    }
      else
    {
        system ("PAUSE");
       return 0;
    }<br/> 
```

出于优化目的：
此处`else`不需要部分，您可以简单地删除该`else`部分，如下所示：

```
if( ConfirmChoice( TChoice));

           {

                   if (TChoice == BOX_SEAT)
                       Cost = CalculateCost(BOX_SEAT_PRICE);
                   if (TChoice == NOSEBLEED)
                       Cost = CalculateCost(NOSEBLEED_PRICE);
                   if (TChoice == STUDENT_SECTION)
                       Cost = CalculateCost(STUDENT_SECTION_PRICE);
                   if (TChoice == FIFTY_YARD_LINE)
                       Cost = CalculateCost(FIFTY_YARD_LINE_PRICE);

              // Handles the payment 

                   if( PChoice == 'C');
                        PayWithCash(Cost,ChangeDue) , CalculateChange(ChangeDue);
                   if( PChoice == 'D')
                        PayWithCredit(Cost);

               // Say goodbye to the customer
                   if (TChoice == BOX_SEAT)
                   cout << "Thank you for the purchase of your 'BOX_SEAT' tickets ,have a nice day!" << endl;
                   if (TChoice == NOSEBLEED)
                      cout << "Thank you for the purchase of your 'NOSEBLEED' tickets ,have a nice day!" << endl; 
                   if (TChoice == STUDENT_SECTION)
                      cout << "Thank you for the purchase of your 'STUDENT_SECTION' tickets ,have a nice day!" << endl;
                   if (TChoice == FIFTY_YARD_LINE)
                        cout << "Thank you for the purchase of your 'FIFTY_YARD_LINE' tickets ,have a nice day!" << endl;

        } 
```