# StackOverflow 问答 12591000-12591999

# ruby-on-rails - Rails 编辑评论不显示数据

> ID：12591001
> 
> 赞同：0
> 
> 时间：2012-09-25T21:01:49.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个包含带有评论的帖子的应用程序。

```
class Comment < ActiveRecord::Base
  belongs_to :post
end 
```

当我尝试编辑现有评论时，表单为空白。

comments_form.html.erb：

```
 <%= form_for([@post, @post.comments.build]) do |post_comment_form| %>
    <div class="field">
      <%= post_comment_form.label :commenter %><br />
      <%= post_comment_form.text_field :commenter %>
    </div>
    <div class="field">
      <%= post_comment_form.label :body %><br />
      <%= post_comment_form.text_area :body %>
    </div>
    <div class="actions">
      <%= post_comment_form.submit %>
    </div>
<% end %> 
```

评论控制器.rb：

```
def edit
    @post = Post.find(params[:post_id])
    @comment = @post.comments.find(params[:id])
  end

  def create
    @post = Post.find(params[:post_id])
    @comment = @post.comments.create(params[:comment])
    redirect_to post_path(@post)
  end

  def update
    #@post = Post.find(params[:post_id])
    #@comment = @post.comments.find(params[:id])

    respond_to do |format|
      #if @post.comments.update_attributes(params[:comment])
          if @comment.update_attributes(params[:comment])
        format.html { redirect_to @comment, notice: 'Comment was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @comment.errors, status: :unprocessable_entity }
      end
    end
  end 
```

**编辑评论时如何确保数据以表格形式显示？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:15:39.297

将您的新操作更改为

```
def new
  @post = Post.new
  @comment = @post.comments.build
end 
```

并且您的编辑操作与往常一样

```
def edit
  @post = Post.find(params[:post_id])
  @comment = @post.comments.find(params[:id])
end 
```

表单构建器应该像

```
 <%= form_for([@post, @comment]) do |post_comment_form| %> 
```

# c++ - 多线程链表遍历

> ID：12591005
> 
> 赞同：5
> 
> 时间：2012-09-25T21:02:14.767
> 
> 标签：c++, list, linked-list

给定一个（双重）对象链接列表（C++），我有一个我想要多线程的操作来对每个对象执行。每个对象的操作成本并不统一。出于各种原因，链表是这组对象的首选存储。每个对象中的第一个元素是指向下一个对象的指针；第二个元素是列表中的前一个对象。

我通过构建节点数组并应用 OpenMP 解决了这个问题。这给出了不错的表现。然后我切换到我自己的线程例程（基于 Windows 原语）并通过使用 InterlockedIncrement()（作用于数组的索引），我可以获得更高的整体 CPU 利用率和更快的吞吐量。本质上，线程通过沿元素“跨越式”工作。

我的下一个优化方法是尝试消除在我的链表中创建/重用元素数组。但是，我想继续使用这种“跳跃式”方法，并以某种方式使用一些不存在的例程，可以称为“InterlockedCompareDereference” - 以原子方式与 NULL（列表末尾）进行比较并有条件地取消引用并存储，返回取消引用的值.

我不认为 InterlockedCompareExchangePointer() 会起作用，因为我不能原子地取消引用指针并调用这个 Interlocked() 方法。我已经阅读了一些内容，而其他人则建议使用关键部分或自旋锁。关键部分在这里似乎很重要。我很想尝试自旋锁，但我想我首先在这里提出问题并询问其他人在做什么。我不相信 InterlockedCompareExchangePointer() 方法本身可以像自旋锁一样使用。然后还必须考虑获取/释放/栅栏语义......

想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:36:37.367

我认为 Casta 有一些优点，我会自己弄一个。这个问题的解决方案将非常重视在每个节点上完成的理念转换，它们是否相互依赖，以及完成的任务是否可以在列表的单一扫描中完成。

如果操作不是相互依赖的，并且扫描方法是有意义的，我建议使用代理获取系统。它实际上与工作组方法相同。每个线程都有一个对管理列表的代理的引用，因为每个线程都需要处理内容，所以它从代理请求它，代理锁定，获取下一个节点，推进内部扫描迭代器，并释放锁定，返回请求线程的节点。这一直持续到列表枚举完成。对于每个节点可能被不同线程多次访问的累加器问题，您可以使用循环列表或其他一些此类容器。有才华的经纪人可以管理列表，包括新的插入、删除等，其方式与分派相同：锁定、操作、解锁。显然有许多活动可以根据您在经纪人方面的特定需求进行定制。这些需求可以构建一个精细的池管理系统，同时在锁定争用方面仍然非常有效（即几乎没有）。

然而，底线是显而易见的。了解您的问题集以及您希望每个线程使用其当前节点完成的具体内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:19:39.927

关键部分并不是真正的重量级。假设他们可以快速获得锁，他们的行为就像一个自旋锁。

您的问题的解决方案将取决于您是否正在修改列表。如果您不修改列表，您需要做的就是对初始化为 0 的对象中的值进行 InterlockedCompareExchange 之类的操作。交换值为 1，如果您返回 0，则执行您的操作，如果返回 1，你跳过。下次您在列表上执行操作时，您交换 2 并检查 1/2 而不是 0/1。

如果您要更改列表，那么这一切都取决于。如果您只想向前移动，并且只删除当前节点，那么您最好的选择是在执行比较交换位、跳跃（获取它的下一个节点）和删除时锁定您锁定的项目中的下一个锁定节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T16:37:06.713

由于对齐，列表指针的低位包含零。您可以通过使用比较和交换指令将对象标记为正在处理，以原子方式在其中一个指针中设置这些位之一来利用这一点。

每个线程都会做：

1.  从头开始遍历列表。
2.  对于每个列表节点，检查其下一个指针是否设置了低位。
3.  如果该位设置转到 7。
4.  比较并交换列表节点的下一个指针`(next | 1)`。
5.  如果比较和交换失败转到 7。
6.  处理对象。
7.  移动到下一个节点并转到 2。

另一种选择是将此位标记放入对象本身具有未使用位的整数中，除非列表节点是基类或对象的成员。

这样，线程将从列表中获取对象，而不会阻塞或忙于以无[等待方式](http://en.wikipedia.org/wiki/Non-blocking_algorithm#Wait-freedom)旋转。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T15:50:42.637

基本上，要尽可能快地浏览列表，您需要避免一些事情；

*   锁定冲突。即使使用自旋锁，每次循环迭代都是错失完成工作的机会。
*   记忆障碍。每次执行原子操作时，内存屏障都会停止执行。
*   不必要的工作，例如扫描列表以查找要做的工作。

我必须同意你的阅读并支持自旋锁。

您将指向列表头部的指针放在易失性指针中。

然后每个线程依次进行；

*   获取自旋锁
*   将指针的值保存在临时文件中
*   更新指向下一个列表条目的指针
*   释放自旋锁。

然后它可以开始在临时指向的条目上工作。

这对于使用 per-entry lock 来搜索列表有一些好处；

*   如果每个项目的工作需要很长时间才能完成，那么在更新指针的短时间内您将很少有冲突。
*   除非发生冲突，否则每个列表项只有 2 个内存屏障，一个用于锁定，一个用于解锁。
*   无需扫描列表即可获取新的工作项，只需从“队列”中获取工作即可。

# hibernate - 如何在jpa中加载具有子实体计数的一对多关系实体

> ID：12591006
> 
> 赞同：0
> 
> 时间：2012-09-25T21:02:18.760
> 
> 标签：hibernate, jpa, orm, toplink

我在处理 Spring/Hibernate/JPA 时遇到了这个问题。

这是我的问题的大纲。

我在学生表和出勤表之间有 OneToMany 关系。

这是我的实体的构建方式：

```
@Entity
class Student{
@Id
private Long id;
    @OneToMany(mappedBy = "student",
               cascade = { CascadeType.PERSIST, CascadeType.MERGE,
                           CascadeType.REFRESH })
  private List<Attendance> attendances;
}

@Entity
class Attendance{

  @ManyToOne
  @JoinColumn(name = "id")
 private Student student;
} 
```

现在我想查询所有学生和出席人数（出席人数）。

这是我尝试过的，但没有成功：

```
select P.id, N from Student s left join s.attendances, IN(s.attendances) as N; 
```

上面的脚本是一个复杂的名为 Query 的一部分，还涉及其他实体，但我有点迷失了让出席人数计入的概念`N`。

任何形式的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T19:44:18.103

您已将其标记为 Hibernate，因此使用 HQL 您应该能够编写：

```
select student.id, count(student.attendances) from Student as student 
```

# c++ - C ++中的命名空间冲突

> ID：12591007
> 
> 赞同：1
> 
> 时间：2012-09-25T21:02:27.320
> 
> 标签：c++, namespaces

我有以下 C++ 类。

xyz.h

```
class xyz {
public:
    static int abc();
}; 
```

qwe.h

```
#include xyz.h

namespace xyz {

class qwe{
public:
    void bnm() {
        int value = xyz::abc();

    }
};

} 
```

我如何访问`xyz::abc()`这里。我在这里收到一个编译错误，说`abc`不是`xyz`. 我理解它试图`abc`在这个`xyz`命名空间内搜索方法的原因，而理想情况下它应该得到的是`xyz`类中的静态方法。

有没有办法在不更改命名空间名称的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:03:55.193

不要创建与命名空间（或它自己的命名空间）同名的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:14:39.943

在您的特定情况下，没有直接的解决方案。Altough C++ 有一个 的概念`elaborated type specifier`，特别是：

```
xyz       ab;   // The defn is ambiguous.
class xyz ab;   // The ambiguity is resolved. 
```

你也可以试试这个：

```
class xyz dummy;
int value = dummy.abc(); 
```

C++ 允许使用实例方法的语法调用静态方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T21:20:31.273

在文件`xyz.h`非常简单并且几乎不依赖其他文件的特殊情况下，您可以这样做：

```
namespace othername {
   #include "xyz.h"
} 
```

然后使用

```
othername::xyz::abc(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-20T15:55:55.553

```
namespace hack = xyz;
hack::abc(); 
```

# android - Firebase 与移动应用

> ID：12591011
> 
> 赞同：6
> 
> 时间：2012-09-25T21:02:40.053
> 
> 标签：android, mobile, firebase

FireBase 是否仅适用于桌面浏览器，还是也可用于移动应用程序？我有一种感觉，它不能与移动设备（还）一起使用。

例如，虽然 Android 使用 WebKit 引擎（它的 WebView 组件无需完整的浏览器即可显示 HTML 页面，并且 HTML 页面可以直接通过 URL 或作为字符串注入到 WebView 中），但 Android WebKit 并没有然而（据我所知）支持 WebSockets，所以如果 FireBase 使用 WebSockets（我想我在某处读到它确实如此），那么这会排除移动应用程序（至少是 Android - 不了解 iOS）。

还有其他方法可以使用 FireBase 在移动设备上实现实时应用吗？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-25T21:33:47.653

Firebase 支持所有主要的移动网络浏览器，甚至可以在离线模式下工作。甚至还有一个[node.js 客户端](http://www.firebase.com/docs/nodejs.html)和[REST API](http://www.firebase.com/docs/rest-api.html)。

当 WebSockets 不可用时，它使用标准的后备选项。从常见问题解答中查看这些[问题](http://www.firebase.com/faq.html)：

**Firebase 支持哪些浏览器和网络连接？** Firebase JavaScript 客户端支持所有主流浏览器（IE 7+、Firefox、Chrome、Safari、Opera 和主要的移动网络浏览器），它适用于任何网络连接。我们的团队花费了数年时间来构建这种类型的软件，并且我们投入了大量的研究和努力来确保我们可以在各种环境中进行通信。我们甚至通过代理和与其他实时技术可能失败的各种移动提供商合作。

**如果我失去网络连接，我的应用会怎样？** 一旦您重新连接，Firebase 就会透明地重新连接到 Firebase 服务器。同时，无论网络状态如何，您的应用在本地完成的所有 Firebase 操作都将立即触发事件，因此您的应用将继续正常运行。重新建立连接后，您将收到一组适当的事件，以便您的客户端“赶上”当前服务器状态，而无需编写任何自定义代码。

**等等，这是否意味着我的应用程序将自动在“离线模式”下运行并在它重新上线时恢复？** 是的，是的，确实如此。:-)

**更新** 啊，我们开始吧。我四处寻找FB团队直接回答的SO问题，[我的搜索并没有白费](https://stackoverflow.com/questions/10710635/how-does-firebase-handle-cross-origin-issues)：

> Firebase Javascript 客户端维护与服务器的实时双向连接。在幕后，这将尽可能使用 WebSockets（它对跨域连接没有限制）并回退到旧浏览器上基于隐藏 iframe 的 jsonp 长轮询（通过仅执行请求来回避跨域问题） .

# zend-framework - 将多个值传递给 Zend Validate？

> ID：12591026
> 
> 赞同：0
> 
> 时间：2012-09-25T21:04:01.863
> 
> 标签：zend-framework, zend-validate

使用自定义 Zend 验证器时验证多个值的最佳实践是什么？目前我正在将一个数组作为 $value 传递，但这对我来说似乎很尴尬并且不太可扩展。会有更好的方法吗？这是我的验证器的片段。：

```
public function isValid($value=array())
{
    $userID=$value["userID"];
    $applicationID=$value["applicationID"];

    /***** Validate next and return, etc. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:10:49.043

如果您以相同的方式（相同的规则）验证 userID 和 applicationID，那么只需调用两次 isValid 方法。没有什么问题。

如果它们有不同的规则，则创建两个不同的验证器类。它将遵循基本的逻辑分离。

# php - Apache 服务器上的 HTTP 300 多项选择

> ID：12591029
> 
> 赞同：2
> 
> 时间：2012-09-25T21:04:18.790
> 
> 标签：php, .htaccess

如何让我的 Apache 服务器返回 300 个多项选择响应？必须使用 .htaccess 并使用 PHP 页面作为错误页面来完成。

到目前为止，我得到了这个：

```
ErrorDocument 300 "/300.php" 
```

有效 URL 为[http://www.example.com/index.html](http://www.example.com/index.html)，测试 URL 为[http://www.example.com/index.php](http://www.example.com/index.php)。当我使用测试 URL 时，我只收到 404 错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:24:25.853

看起来你想启用[MultiViews](http://httpd.apache.org/docs/2.2/mod/mod_negotiation.html#multiviews)

```
Options +MultiViews 
```

# ruby-on-rails - 管理rails中的partials和components

> ID：12591038
> 
> 赞同：1
> 
> 时间：2012-09-25T21:04:58.640
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在开发一个使用带有许多不同小部件的仪表板的项目。这些小部件主要是图表。小部件将与许多不同的模型交互，并且可以在许多不同的页面和仪表板中调用。我应该创建一个通用的 Widget 控制器和模型来处理所有这些小部件，还是这些小部件应该特定于每个模型？我在想一个小部件方法会更好地将所有小部件放在一起。如果我要走这条路，有没有办法让调用部分（小部件）的视图运行特定的控制器方法？

例如，我有一个调用 /widget/_orders.html.erb 的 show.html.erb 文件。每当调用这个 _orders.html.erb 部分时，我希望它使用 widget_controller.rb 中的“order”方法提供的数据。有没有办法做到这一点，或者可能更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:27:20.087

您可能对[细胞](https://github.com/apotonick/cells)项目感兴趣。

# python - 如何更改 Django Social auth 登录 Twitter 用户的密码

> ID：12591040
> 
> 赞同：1
> 
> 时间：2012-09-25T21:05:05.913
> 
> 标签：python, django, django-socialauth

我正在使用 social-auth 以及 userena 和朋友应用程序。我想为 twitter 登录用户提供一个功能，以使用 django 更改密码表单更改他们的密码，但对于 twitter 用户，当前密码无法更改，所以请任何人都可以帮助我提前谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T09:22:03.127

我们可以使用上面评论中的`user.has_usable_password()`omab[来](https://stackoverflow.com/users/385822/omab)检查是否设置了用户密码。

# php - postgis_geojson.php 脚本中的“参数”选项

> ID：12591042
> 
> 赞同：1
> 
> 时间：2012-09-25T21:05:13.663
> 
> 标签：php, postgis

我正在使用这个脚本（更新[https://gist.github.com/3763701](https://gist.github.com/3763701)）并且效果很好（恭喜作者），但是“参数”选项不适用于我的表，例如这个调用：

```
http://localhost/postgis_geojson.php?geotable=seafloor_thermometry_point_wgs84&geomfield=geom&parameters=source='GEOMAR' 
```

给出：

```
There was an error parsing the JSON document. The document may not be well-formed.
Document contents:
<br /> <b>Warning</b>: pg_query() [<a href='function.pg-query'>function.pg-query</a>]: Query failed: ERROR: syntax error at or near &quot;GEOMAR&quot; at character 110 in <b>/var/www/html/postgis_geojson.php</b> on line <b>85</b><br /> An SQL error occured. 
```

然而，在 postgis 这个调用中：

```
select id,fid,source from seafloor_thermometry_point_wgs84 where source='GEOMAR'; 
```

给出：

```
 id | fid | source
----+-----+--------
  1 |   1 | GEOMAR
  2 |   2 | GEOMAR
  3 |   3 | GEOMAR
  4 |   4 | GEOMAR
...etc 
```

问题可能出在哪里？

感谢您对此的任何提示，

格里

编辑：

我的 postgis 表在 id 中有 PK，我正在使用 postgis 1.5、postgresql 8.4.8、php-5.1.6-27.el5、php-pgsql-5.1.6-27.el5、apache 2 (httpd-2.2.3 -43.el5) 和 rhel5 32 位中的 Firefox 6.0.2，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T09:39:23.600

解决方案：

在第 70 行，尝试将 pg_escape_string($parameters) 更改为 $parameters

# objective-c - 使用不兼容类型“id”的表达式初始化“double”

> ID：12591050
> 
> 赞同：8
> 
> 时间：2012-09-25T21:05:55.930
> 
> 标签：objective-c, ios, initialization

我尝试使用以下代码为双精度赋值：

```
double distanceFormat = [self.runsArray[indexPath.row] valueForKey:@"runDistance"]; 
```

但我不断收到以下错误：

```
Initialising 'double' with an expression of incompatible type 'id' 
```

但是，我知道价值是双倍的！有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-25T21:09:20.890

你可以试试：

```
double distanceFormat = [[self.runsArray[indexPath.row] valueForKey:@"runDistance"] doubleValue]; 
```

如果你确定它是双倍的，我认为它会起作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-25T21:12:05.907

使用 NSNumber

```
NSNumber *mynumber = [somedictionary valueForKey:@"runDistance"]; 
```

一旦你有了 nsnumber，你就可以把它转换成你想要的任何东西， f.ex ：

```
int i = [mynumber intValue]; 
```

# java - 如何使用 maven 运行多个码头实例

> ID：12591055
> 
> 赞同：9
> 
> 时间：2012-09-25T21:06:10.780
> 
> 标签：java, maven, jetty, instances

所以，我想要做的是配置 maven 插件码头以在不同的端口和不同的应用程序上运行多个 - 在我的情况下是两个 - 码头服务器实例。

所以，我想要类似的东西：

```
localhost:8080/webapp1
localhost:8081/webapp2 
```

我想用一个命令来做到这一点： mvn jetty:run 这当然意味着我必须在 pom.xml 中配置它

我已经有两个不同的码头配置文件：jettyA.xml 和 jettyB.xml，其中定义了不同的连接器。问题是我不知道如何用一个 pom.xml 做到这一点

我尝试了两个配置文件，但不知何故不起作用。刚刚提到的最后一个配置文件中的码头已经启动。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-25T21:50:26.533

将 pom.xml 中的端口号替换为如下属性变量：

```
<port>${jetty.port}</port> 
```

然后使用以下命令运行 maven：

```
mvn jetty:run -Djetty.port=8081 
```

要定义默认端口号，请将此默认属性添加到您的 pom 文件中：

```
<properties>
    <jetty.port>8080</jetty.port>
</properties> 
```

如果您需要任何更高级的方法来确定端口号，则需要在主类中嵌入码头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-02T15:30:25.423

这是我对上述问题进行排序的方式

1.) 转到你的**运行**->在 Eclipse 或 STS 中**运行配置**或**调试配置**（我使用的是 STS）

2.)然后对话框将出现&在左侧菜单中双击**Maven Build**

3.）在**名称**文本阶段的右侧顶部输入您想要的任何名称例如：- Jetty_Server

4.）在下面选择**浏览工作区**，然后选择您要清理的项目并使用码头服务器运行（我认为您已经在 pom 文件中添加了码头插件）

5.) 在下面的**目标**文本框中输入下面的行（您可以使用 8020 或 8065 或任何端口）

```
clean install -Djetty.port=8020 jetty:run 
```

6.）然后**配置**maven运行时（选择安装maven文件夹的位置）

7.) 然后**应用**->**运行/调试**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T08:43:25.997

好的，我这样解决了......

我有一个带有两个不同配置文件的 POM.XML 文件。然后我写了一个 SH 脚本.. 我在其中运行两个配置文件，如下所示：

```
mvn jetty:run-war -Pprofile1 &
mvn jetty:run-war -Pprofile2 
```

在每个配置文件中，我都有自己的配置文件（jettyA.xml、jettyB.xml），其中在不同的端口上定义了两台服务器 - 使用不同的应用程序。

现在我所要做的就是运行一个 SH 脚本，就是这样。

# stata - 在Stata中大写价值标签

> ID：12591056
> 
> 赞同：5
> 
> 时间：2011-03-13T14:46:36.113
> 
> 标签：stata

一些数据集带有全小写的值标签，我最终得到显示“埃及”、“约旦”和“沙特阿拉伯”结果的图表和表格，而不是大写的国家名称。

我想`proper()`字符串函数可以为我做点什么，但我没有找到为 Stata 11 编写代码的正确方法，它将大写给定变量的所有值标签。

我基本上需要`proper()`在变量上的所有值标签上运行该函数，然后将它们分配给变量。`foreach`在Stata中使用循环和宏有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-13T18:55:16.907

是的。首先让我们创建一些带有标签的示例数据以进行测试：

```
clear
drawnorm x, n(10)
gen byte v = int(4+x)
drop x
label define types 0 "zero" 1 "one" 2 "two" 3 "three" 4 "four" 5 "five" 6 "six"
label list types
label values v types 
```

这是一个将与变量“v”关联的值大写的宏：

```
local varname v
local sLabelName: value label `varname'
di "`sLabelName'"

levelsof `varname', local(xValues)
foreach x of local xValues {
    local sLabel: label (`varname') `x', strict
    local sLabelNew =proper("`sLabel'")
    noi di "`x': `sLabel' ==> `sLabelNew'"
    label define `sLabelName' `x' "`sLabelNew'", modify
} 
```

运行后，查看结果：

```
label list types 
```

# f# - 如何通过引用在 F# 中使用参数调用外部函数？

> ID：12591058
> 
> 赞同：4
> 
> 时间：2012-09-25T21:06:13.397
> 
> 标签：f#, pinvoke, external, pass-by-reference

我正在尝试将 C# dll-Call 移植到 F#。

C# 调用是：

```
[DllImport("swedll32.dll", CharSet = CharSet.Ansi, EntryPoint = "swe_revjul")]
private extern static double ext_swe_revjul(double tjd, int gregflag, ref int year, ref int month, ref int day, ref double hour); 
```

我已经尝试以六种方式（至少！）在 F# 中编写此代码，但都无济于事。其中：

```
[<DllImport("swedll32.dll", CharSet = CharSet.Ansi, EntryPoint = "swe_revjul")>]
extern double ext_swe_revjul (double tjd ) (gregflag:int) (year: int byref) (month: int byref) (day: int byref) (hour: double byref); 
```

或者：

```
let ext_swe_revjul double (tjd:double) (gregflag:int) (year: int byref) (month: int byref) (day: int byref) (hour: double byref ) 
```

我尝试用限定符或“a：byref”编写byref - 有人可以帮助我吗？非常感谢您！

暂时沮丧的科学家，只想得到他的公式:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T21:09:05.553

尝试

```
extern static double ext_swe_revjul(double tjd, int gregflag, int* year, int* month, int* day, double* hour) 
```

声明应该或多或少地匹配 C 签名。

编辑：

正如 ildjarn 指出的那样，

```
extern static double ext_swe_revjul(double tjd, int gregflag, int& year, int& month, int& day, double& hour) 
```

可能会更好。

# php - php发送邮件的问题

> ID：12591059
> 
> 赞同：0
> 
> 时间：2012-09-25T21:06:14.043
> 
> 标签：php, email

所以我一直在做一个项目，我有一个功能可以向被选中雇主的员工发送电子邮件。现在，除了邮件功能（我正在使用 winhost，我们需要包含 Mail.php 才能使邮件功能正常工作）之外，它正在工作。它有时会发送 3 封电子邮件而不是 2 封，有时会发送 1 封电子邮件而不是 2 封。

编码 ：

```
if (isset($_POST['openemailmem'])){
    $memberuser = $_POST['openemailmemusername'];
    $sql = "SELECT email, username, password, status FROM csvdata WHERE memberview =:user ";
    $getinfo=$DBH->prepare($sql);
    $getinfo->execute(array(':user' => $memberuser));

    while ($row = $getinfo->fetch(PDO::FETCH_ASSOC)) {
        $check = $row;
        $newEmployeeEmail = $check['email'];
        $csvusername = $check['username'];
        $password = $check['password'];
        $status = $check['status'];

        if ($status == "Open"){
            echo "tesing";
            $from = "the email of where it is coming from is here but i removed";  
            $to = $newEmployeeEmail; 
            if (!empty($_POST['cc'])){
                $cc = $_POST['cc']; 
            }
            if (!empty($_POST['ccsend'])){
                $cc = $_POST['ccsend'];
                $to .= ", $cc";
            }
            $subject = "removed msg"; 
            $body = "removed msg"; 
            $host = "i removed"; 
            $username = "i removed"; 
            $password = "i removed"; 
            $headers = array ('From' => $from, 'To' => $to,'Cc' => $cc, 'Subject' => $subject); 
            $smtp = Mail::factory('smtp', array ('host' => $host, 'auth' => true, 'username' => $username, 'password' => $password)); 
            $mail = $smtp->send($to, $headers, $body);
        }       
    }

    header("Location: I removed this.php?getmsg=12");
    exit;

} 
```

谢谢你所有的时间！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:52:29.603

您的解决方案很可能在您的日志中。如果抛出异常，您可以在其中找到它们。

另外一个建议：

在循环之前和之后添加日志记录。所以你的例子变成：

```
if (isset($_POST['openemailmem']))
{
    $memberuser = $_POST['openemailmemusername'];
    $sql        = "SELECT email, username, password, status "
                . "FROM csvdata WHERE memberview =:user ";
    $getinfo    = $DBH->prepare($sql);
    $getinfo->execute(array(':user' => $memberuser));

    $log_file = "/home/my/transaction.log";
    $now      = "[" . date("Ymd-His") . "] ";

    $message = $now . "Starting loop...";
    error_log($message, 3, $log_file);

    while ($row = $getinfo->fetch(PDO::FETCH_ASSOC)) 
    {

        $check            = $row;
        $newEmployeeEmail = $check['email'];
        $csvusername      = $check['username'];
        $password         = $check['password'];
        $status           = $check['status'];

        if ($status == "Open")
        {
            echo "tesing";
            $from = "the email of where it is coming from is here but i removed";  
            $to   = $newEmployeeEmail; 
            if (!empty($_POST['cc']))
            {
                $cc = $_POST['cc']; 
            }
            if (!empty($_POST['ccsend']))
            {
                $cc = $_POST['ccsend'];
                $to .= ", $cc";
            }
            $subject  = "removed msg"; 
            $body     = "removed msg"; 
            $host     = "i removed"; 
            $username = "i removed"; 
            $password = "i removed"; 
            $headers = array(
                           'From'    => $from, 
                           'To'      => $to,
                           'Cc'      => $cc, 
                           'Subject' => $subject,
                       );

            $now     = "[" . date("Ymd-His") . "] ";
            $message = $now . "Before connecting to server - " . $to;
            error_log($message, 3, $log_file);

            $smtp = Mail::factory(
                'smtp', 
                 array(
                     'host'     => $host, 
                     'auth'     => true, 
                     'username' => $username, 
                     'password' => $password,
                 )
            ); 

            $now     = "[" . date("Ymd-His") . "] ";
            $message = $now . "After connecting to server - " . $to;
            error_log($message, 3, $log_file);

            $now     = "[" . date("Ymd-His") . "] ";
            $message = $now . "Before sending email - " . $to;
            error_log($message, 3, $log_file);

            $mail = $smtp->send($to, $headers, $body);

            $now     = "[" . date("Ymd-His") . "] ";
            $message = $now . "After sending email - " . $to;
            error_log($message, 3, $log_file);
        }       
    }

    $now     = "[" . date("Ymd-His") . "] ";
    $message = $now . "End of loop";
    error_log($message, 3, $log_file);

    header("Location: I removed this.php?getmsg=12");
   exit;

} 
```

您可能会发现您的函数超时，具体取决于邮件程序将电子邮件发送到相关主机所需的时间。

从我看到的每个用户都有一个（可能）唯一的到邮件服务器的连接，然后发送电子邮件。如果由于某种原因在建立该连接时出现延迟，那么您的脚本很可能会超时。

您可以调整上面使用的错误日志记录方法，`microtime`以便您可以查看代码每次迭代之间的实时时间 - 当然，您需要在代码块之间添加更多日志记录。

如果您发现邮件服务器连接确实存在延迟等，您可以（如果您的要求允许）连接到一台服务器并从那里发送您的电子邮件。

高温高压

# data-visualization - 如何在Stata的同一张图上叠加多个图？

> ID：12591067
> 
> 赞同：2
> 
> 时间：2011-12-19T21:28:46.503
> 
> 标签：data-visualization, stata

我正在使用[以下代码](https://stats.stackexchange.com/a/19759)在 Stata 中的图表上绘制图表。我想在同一张图上绘制多个图。那可能吗？谁能告诉我该怎么做？

我想要做的是在同一个图中有多个以下类型的图。

**进一步说明：** X 的每个值将有多个均值和 CI，即每个模拟模型都有一个均值和 CI。一个仿真模型的所有方法和 CI 将连接在一起。

```
 clear 
    input str2 varname mean upper lower
    x1 30 25  35
    x2 50 20  80
    x3 60 50  70
    x4 60 55  65
    x5 65 55  75
    end

    encode varname, gen(varname1)   
    scatter mean varname1, xlabel(, valuelabel) || rcap upper lower varname1 || line upper mean lower varname1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-12-19T22:19:05.283

正如@whuber 所提到的，我们需要用它`||`来绘制更多的东西。我使用以下代码在同一张图上绘制了多个我需要的类型的图。谢谢。

```
 clear 
    input str2 varname mean upper lower
    x1 30 25  35
    x2 50 20  80
    x3 60 50  70
    x4 60 55  65
    x5 65 55  75
    end

    encode varname, gen(varname1)

    input str4 varname4 mean4 upper4 lower4
    x1 40 35  45
    x2 60 30  90
    x3 70 60  80
    x4 70 65  75
    x5 75 65  85

    scatter mean varname1, xlabel(, valuelabel) || rcap upper lower varname1 || line upper mean lower varname1 ||scatter mean4 varname1, xlabel(, valuelabel)  || rcap upper4 lower4 varname1  ||  line upper4 mean4 lower4 varname1 
```

# jquery - 如何使用 jQuery 预加载非硬编码的背景图像？

> ID：12591070
> 
> 赞同：2
> 
> 时间：2012-09-25T21:07:12.180
> 
> 标签：jquery, css, preload

如何预加载 css 背景图像是一个古老的问题，但有点扭曲：背景图像是通过 jQuery 设置的，因为它们来自 Vimeo。每个背景图像都是来自 vimeo 的视频图像，因此我在网站加载时使用 vimeo 缩略图 url 设置背景。我可以以某种方式预加载这些图像吗？我有一个覆盖层，我想在加载内容时消失，但尽管我努力，当覆盖层消失时背景图像仍然可见加载！

这是我尝试过的一些（不是那么雄辩的）代码：

```
var count = $('.video_stub').length;    
$('.video_stub').each(function(index) {
    var bgUrl = $(this).data('thumb');
    $('<img/>')[0].src = bgUrl;
    if(index == (count - 1)) {
        $('.video_stub').each(function(i) {
        var bgUrl = $(this).data('thumb');
        // Set the video thumb's background using the vimeo thumb image
        $(this).css('background-image', 'url(' + bgUrl + ')');
            if(index == (count - 1)) {
                $('#temp_overlay').fadeOut('slow');
            }
        });
    }
}); 
```

有任何想法吗？提前非常感谢。

**编辑：**

我尝试了这段代码，但没有成功。我想知道这是不是范围问题？也许我无法从加载回调中访问索引变量：

```
// Set video thumb click handler
var count = $('.video_stub').length;

// Set video thumb click handler
// Iterate through each video stub
$('.video_stub').each(function(index) {
    var bgUrl = $(this).data('thumb');
    $('<img/>').attr('src', bgUrl).load(function() {
        $('.video_stub:eq(' + index + ')').css('background-image', 'url(' + bgUrl + ')');
    });
    if(index == (count - 1)) {
        $('#temp_overlay').fadeOut('slow');
    }
}); 
```

我试过：

```
$('<img/>').attr('src', bgUrl).load(function() {
    $(this).css('background-image', 'url(' + bgUrl + ')');
}); 
```

无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:00:38.920

以下应该有效：

```
var video_stubs = $('.video_stub');
var loaded = [];
video_stubs
  .each(function(){
    /// store stub as a var so we can correctly access it in the callback
    var stub = $(this);
    /// get the URL as usual
    var bgURL = stub.data('thumb');
    /// create a temporary image that tells the browser to load a specific
    /// image in the background
    $('<img />')
      /// define our load event before we set the src value otherwise the
      /// load could happen from cache before we've even defined a listener
      .load(function(){
        /// set the background image $(this) no longer points to stub,
        /// it actually points to the temporary image.. so instead
        /// use the stub var we've created outside of this scope
        stub.css('background-image', 'url(' + bgURL + ')');
        /// store a list of what we've loaded - mainly for the loaded.length 
        /// count - but storing this information could be useful elsewhere
        loaded.push( bgURL );
        /// test that we've all loaded (remember this can occur in any order)
        /// so keeping an incrementing count is better than assuming the last
        /// image we try and load will be the last image to load completely.
        if ( loaded.length == video_stubs.length ) {
          /// finalise only after all is loaded
          $('#temp_overlay').fadeOut('slow');
        }
      })
      /// set the src value, once loaded the callback above will run
      .attr('src', bgURL)
    ;
  })
; 
```

您已经尝试过的主要问题是您试图`$(this)`在回调函数中引用。你必须确保你知道`this`引用在哪里。使用 jQuery，这将始终是集合中触发回调的目标元素。因此，在我上面看到的示例中，您实际上是在尝试访问临时映像，而不是存根。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:19:18.863

如果您确实需要在覆盖消失后图像 100% 可见，请尝试在`$(window)`加载时将其删除。

```
if(index == (count - 1)) {
    $(window).on('load',function(){
        $('#temp_overlay').fadeOut('slow');
    }
} 
```

但要小心，因为用户必须等待所有内容（内部和外部）都被加载，然后覆盖消失。也许您可以添加“跳过加载”链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:21:09.313

您可以使用此 jQuery 函数检查图像是否已加载：

```
$('img').load(function() {
        $('#temp_overlay').fadeOut('slow');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T20:44:21.130

我使用 queryLoader2 作为我的预加载器，它解析网站上的图像和背景图像。但是，我通过 javascript 添加了一些背景图像（而不是将它们写入 css 或每个元素的样式标签），因此预加载器实际上无法加载这些图像。

在我以在每个元素的“样式”标签中包含背景图像属性的方式更改代码后，我能够成功加载图像！

# javascript - 将 dom 元素内的所有文本拆分为

> ID：12591073
> 
> 赞同：1
> 
> 时间：2012-09-25T21:07:22.757
> 
> 标签：javascript, jquery, html

我想将 html DOM 节点内的所有元素拆分为带有 id 的 span，例如：

假设我有元素：

```
<div>
<h1>Header</h1>
<h2>header2</h2>
<p class="test">this is test p</p>
</div> 
```

结果应该是：

```
<div>
<h1><span id="1">Header</span></h1>
<h2><span id="2">header2</span></h2>
<p class="test"><span id="3">this</span><span id="4">is</span><span id="5">test</span> <span id="6">p</span></p>
</div> 
```

谢谢你的帮助

如果有嵌套图像，它也应该工作，例如：

```
<div>
<h1>Header</h1>
<h2>header2</h2>
<p class="test"><img alt="test alt" />this is test p</p>
</div> 
```

结果：

```
<div>
<h1><span id="1">Header</span></h1>
<h2><span id="2">header2</span></h2>
<p class="test"><img alt="test alt" /><span id="3">this</span><span id="4">is</span><span id="5">test</span> <span id="6">p</span></p>
</div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T21:09:02.650

## *[jsBin 演示](http://jsbin.com/irehot/1/edit)*

像这样包装每个单词应该会有所帮助：

```
var c = 0;                                // create a counter
$('div > *').each(function(){
    var text = $(this).html().split(' '), // split your text strings
        len = text.length,                // get lenght of splitted parts
        result = [];                      // create array
    for( i=0; i<len; i++ ) {              // looping 'len' times....
        result[i] = '<span id="'+( ++c )+'">' + text[i] + '</span>';  // populate array
    }
    $(this).html(result.join(' '));       // apply edits
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:11:59.047

```
var str = $('.test').text();
var result = "";
str = str.split(" ");
$.each(str,function() {
   result += '<span>' + this + '</span>';
});
$('.test').html($(result)); 
```

# c - 有没有一种简洁的方法来执行 strdup() 后跟 strcat()？

> ID：12591074
> 
> 赞同：5
> 
> 时间：2012-09-25T21:07:27.453
> 
> 标签：c, c-strings

假设我想复制一个字符串，然后将一个值连接到它。

使用 stl std::string，它是：

```
string s = "hello" ;
string s2 = s + " there" ; // effectively dup/cat 
```

在 C 中：

```
char* s = "hello" ;
char* s2 = strdup( s ) ; 
strcat( s2, " there" ) ; // s2 is too short for this operation 
```

我知道在 C 中执行此操作的唯一方法是：

```
char* s = "hello" ;
char* s2=(char*)malloc( strlen(s) + strlen( " there" ) + 1 ) ; // allocate enough space
strcpy( s2, s ) ;
strcat( s2, " there" ) ; 
```

在 C 中是否有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:18:10.230

你可以做一个：

```
char* strcat_copy(const char *str1, const char *str2) {
    int str1_len, str2_len;
    char *new_str;

    /* null check */

    str1_len = strlen(str1);
    str2_len = strlen(str2);

    new_str = malloc(str1_len + str2_len + 1);

    /* null check */

    memcpy(new_str, str1, str1_len);
    memcpy(new_str + str1_len, str2, str2_len + 1);

    return new_str;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T21:12:38.547

并不真地。C 根本没有像 C++ 那样好的字符串管理框架。使用`malloc()`,就像您所展示的那样`strcpy()`，`strcat()`您可以尽可能接近您的要求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-25T21:26:07.917

GNU 扩展是[`asprintf()`](http://linux.die.net/man/3/asprintf)分配所需的缓冲区：

```
char* s2;
if (-1 != asprintf(&s2, "%s%s", "hello", "there")
{
    free(s2);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-25T21:15:36.347

您可以使用像 GLib 这样的库，然后[使用它的字符串类型](http://developer.gnome.org/glib/2.31/glib-Strings.html#g-string-append)：

> `GString * g_string_append (GString *string, const gchar *val);`
> 
> 将一个字符串添加到 GString 的末尾，必要时扩展它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-25T21:44:19.103

受到nightcracker的启发，我也想到了

```
// writes s1 and s2 into a new string and returns it
char* catcpy( char* s1, char* s2 )
{
    char* res = (char*)malloc( strlen(s1)+strlen(s2)+1 ) ;

    // A:
    sprintf( res, "%s%s", s1, s2 ) ;
    return res ;

    // OR B:
    *res=0 ; // write the null terminator first
    strcat( res, s1 ) ;
    strcat( res, s2 ) ;
    return res ;
} 
```

# stata - 在Stata中将值从一个变量传输到另一个变量

> ID：12591077
> 
> 赞同：3
> 
> 时间：2011-07-19T21:36:37.150
> 
> 标签：stata

我在工作中有一个问题：我已经合并了两个数据集，并且有许多具有相同内容的变量，但是在数据集 1 的变量中具有值的观察值在数据集 2 中具有缺失值。所以我需要将值从一个变量转移到另一个变量。

这是我迄今为止最好的镜头：

```
replace V23=1 if V232==1
replace V23=2 if V232==2
replace V23=3 if V232==3
replace V23=4 if V232==4
replace V23=8 if V232==8
replace V23=.u if V232==10 | V232==9 
```

但是，为 40 多个变量执行此操作是一项繁琐的任务——而且由于其中一些是数值变量，因此它变成了一项孤注一掷的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-19T21:44:24.097

这是一个开始：

```
foreach v of varlist v23 {
    local w `v'2
    replace `v' = `w' if missing(`v')
    replace `v' = .u if `w' == 10 | `w' == 9
} 
```

请注意该解决方案如何依赖于变量名称之间的词法关系：它假定旧变量“v23”与新变量“v232”相关联。您可以列出此类关联并使用它，但这很不方便。如有必要，重命名变量以符合这样的约定可能更容易，然后运行替换脚本，然后恢复所需的名称。

如果您不熟悉这种自动化，请阅读 和 的帮助`macro`页面`foreach`。

# spring-mvc - 在spring mvc中传递初始数据

> ID：12591079
> 
> 赞同：0
> 
> 时间：2012-09-25T21:07:33.663
> 
> 标签：spring-mvc, google-chrome-extension

我有一个将 iframe 注入页面并调用我的站点的扩展程序，该站点由 spring mvc 管理。我构建了包含从某些内容脚本获得的数据的初始 url，因此只有当我打开我的扩展程序时，我才能使用这些数据。我的情况是这样的：

1.  用户打开扩展程序，该扩展程序将带有 url 的 iframe 插入到我的网站。(http://www.mysite.com/extension)
2.  如果用户已登录，我的系统会使用控制器“A”处理请求并返回主视图。
3.  如果用户没有登录我的系统，那么我将他推荐给登录视图。登录视图中表单的操作是添加 /login (http://www.mysite.com/extension/login)，因此同一个控制器“A”可以处理请求，但请求映射不同（不同的功能）。如果用户成功登录，那么他将被引用到主视图。

问题是，如果用户没有登录，那么我将“丢失”我最初从第一个请求中获得的数据。有没有一种优雅的方法来保存会话中第一个请求的数据，以便我可以访问它？或任何其他方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T16:16:59.533

我所做的是我制作了一个拦截器，将值推送到会话对象。我不认为这是一个优雅的解决方案，但它完成了工作。如果有人有更好的解决方案，我想听听。谢谢

# android - 在同一个活动中使用 Actionbarsherlock 和 viewpageindicator。

> ID：12591086
> 
> 赞同：1
> 
> 时间：2012-09-25T21:07:46.130
> 
> 标签：android

我试图在同一个活动中同时使用 Actionbarsherlock 和 viewpageindicator ，但这两者都需要你用不同的东西扩展活动。我该如何解决这个问题，因为我能理解你不能用两件事来扩展。谢谢！

# php - Sencha Touch：从 Sencha Touch 示例调用 php 函数会导致 JSON 字符串无效错误。

> ID：12591087
> 
> 赞同：0
> 
> 时间：2012-09-25T21:07:46.070
> 
> 标签：php, javascript, json, extjs

我是 Sencha Touch 的新手。我关注了 Sencha Touch 的“入门”示例视频 (http://docs.sencha.com/touch/2-0/#!/guide/getting_started)。在示例中，有一个联系表单（代码如下）调用视频中未定义的 php 函数，导致找不到文件控制台错误。当我添加一个 php 函数时，我收到以下控制台错误：

**“未捕获的错误：您正在尝试解码无效的 JSON 字符串：”**

即使文件为空，我也会收到此错误。有谁知道我做错了什么？或者任何指向解释如何从 Sencha 调用 php 函数的教程的指针？

## 联系表单代码，查看 php 函数是如何调用的：

```
Ext.define('GS.view.Contact', {
    extend:  'Ext.form.Panel',
    xtype:  'contactform',

    requires:  [
        'Ext.form.FieldSet',
        'Ext.field.Email'
        ],

    config:  {
        title:  'Contact',
        iconCls:  'user',
        **url:  'php/Contact.php',**

        items:  [
            {
                xtype:  'fieldset',
                title:  'Contact Us',
                instructions:  '(email is not required)',
                items:  [
                    {
                        xtype:  'textfield',
                        name:  'name',
                        label:  'Name'
                    },
                    {
                        xtype:  'emailfield',
                        name:  'email',
                        label:  'Email'
                    },
                    {
                        xtype:  'textareafield',
                        name:  'message',
                        label:  'Message'
                    }
                ]

            },

            {
                xtype:  'button',
                text:  'Send',
                ui:  'confirm',
                **handler:  function(){
                    this.up('contactform').submit();**
                    }
            }
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T12:07:56.653

该错误表示收到的 JSON 无效。确保 PHP 页面创建有效的 JSON。您可以从简单地输出一个您知道是有效 JSON 的硬编码字符串开始。

此外，请确保页面使用以下标头向浏览器发送正确的内容类型：

```
header('Cache-Control: no-cache, must-revalidate');
header("content-type:application/json"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T03:25:24.060

该错误是不言自明的。您正在调用的 PHP 脚本的输出不是格式正确的 JSON。例如，您需要在 HTTP 响应中放置正确的 JSON 标头，还需要确保实际数据是 JSON。

你可以尝试用这样的东西替换你的PHP文件，看看你是否能克服错误？

```
<?php
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
header('Content-type: application/json');
echo "{\"success\":true, \"message\":\"Hello World\"}";
?> 
```

# c# - 更改 Windows 系统颜色时背景颜色不会更改

> ID：12591089
> 
> 赞同：1
> 
> 时间：2012-09-25T21:07:54.177
> 
> 标签：c#, wpf, contextmenu, background-color, system-tray

使用以下代码，我得到一个带有上下文菜单的系统托盘图标。但是当我在应用程序运行时更改 Windows 主题时，背景颜色保持不变。

```
private System.Windows.Forms.NotifyIcon notifyIcon1;
    private System.Windows.Controls.ContextMenu contextMenu1;
    private System.Windows.Forms.MenuItem menuItem1;
    private System.ComponentModel.IContainer components;

    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);
        Action action = new Action(ExecuteStartupSequence);
        action.ExecuteProfiled();

        this.components = new System.ComponentModel.Container();
        /*
        this.contextMenu1 = new System.Windows.Forms.ContextMenu();
        this.menuItem1 = new System.Windows.Forms.MenuItem();
         */

        // Initialize contextMenu1
        /*
        this.contextMenu1.MenuItems.AddRange(
                    new System.Windows.Forms.MenuItem[] { this.menuItem1 });
        */

        // Initialize menuItem1
        /*
        this.menuItem1.Index = 0;
        this.menuItem1.Text = "E&xit";
        this.menuItem1.Click += new System.EventHandler(this.menuItem1_Click);
        */
        this.contextMenu1 = this.FindResource("TrayContextMenu") as System.Windows.Controls.ContextMenu;

        // Create the NotifyIcon.
        //this.notifyIcon1 = new System.Windows.Forms.NotifyIcon(this.components);
        this.notifyIcon1 = new System.Windows.Forms.NotifyIcon(components);

        // The Icon property sets the icon that will appear
        // in the systray for this application.
        notifyIcon1.Icon = new System.Drawing.Icon("Icon1.ico");

        // The ContextMenu property sets the menu that will
        // appear when the systray icon is right clicked.
        // notifyIcon1.ContextMenu = this.contextMenu1;

        // The Text property sets the text that will be displayed,
        // in a tooltip, when the mouse hovers over the systray icon.
        notifyIcon1.Text = "Form1 (NotifyIcon example)";
        notifyIcon1.Visible = true;

        // Handle the DoubleClick event to activate the form.
        notifyIcon1.DoubleClick += new System.EventHandler(this.notifyIcon1_DoubleClick);
        notifyIcon1.Click += new System.EventHandler(this.notifyIcon1_DoubleClick);

        //tb = (TaskbarIcon)FindResource("notifyIcon"); ;
    }

    private void notifyIcon1_DoubleClick(object Sender, EventArgs e)
    {
        this.contextMenu1 = this.FindResource("TrayContextMenu") as System.Windows.Controls.ContextMenu;
        contextMenu1.IsOpen = true;
    }

    private void menuItem1_Click(object Sender, EventArgs e)
    {
        MessageBox.Show("Open");

    } 
```

这里是 XAML-Stuff。

```
<ContextMenu x:Key="TrayContextMenu" Placement="MousePoint" Style="{x:Null}">
        <MenuItem Header="First Menu Item" Style="{x:Null}" />
        <MenuItem Header="Second Menu Item" Style="{x:Null}" />
        </ContextMenu>
        <Popup x:Key="TrayPopup" Placement="MousePoint">
            <Border Width="100" Height="100" Background="White" BorderBrush="Orange" BorderThickness="4">
            <Button Content="Close" Click="menuItem1_Click"></Button>
            </Border>
        </Popup> 
```

我无法理解这一点，我已经使用 Style="{x:Null}" 来摆脱所有未配置的东西，但它根本不起作用。我可以避免使用 System.Windows.Controls.Contextmenu，但我应该改用什么？

我很感谢所有的提示。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:41:05.637

如果您想在更改窗口颜色时更改颜色，那么您的控件需要使用[系统颜色之一 wpf中的系统颜色](http://blogs.msdn.com/b/wpf/archive/2010/11/30/systemcolors-reference.aspx)

然后使用 dynamicresource 以便在更改资源时重新应用资源

```
 <Border Width="100" Height="100" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T05:16:49.677

我将受影响的 XAML 代码更改为：

```
<ContextMenu 
        x:Key="TrayContextMenu" 
        Placement="MousePoint" 
        Style="{x:Null}" 
        Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
        <MenuItem 
            Header="First Menu Item" 
            Style="{x:Null}"
            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>

        <MenuItem 
            Header="Second Menu Item" 
            Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />

        </ContextMenu>
        <Popup x:Key="TrayPopup" Placement="MousePoint">
            <Border Width="100" Height="100" Background="White" BorderBrush="Orange" BorderThickness="4">
            <Button Content="Close" Click="menuItem1_Click"></Button>
            </Border>
        </Popup> 
```

但结果还是一样。

通常这会解决问题，但如果是托盘图标上下文菜单，它会失败。

# apache - mod_rewrite：QSA 标志破坏配置

> ID：12591095
> 
> 赞同：4
> 
> 时间：2012-09-25T21:08:09.183
> 
> 标签：apache, mod-rewrite

我有一个网络服务的重写规则：

```
RewriteEngine on
RewriteBase /
RewriteRule ^service/(.*)$ blabla/service.php?request=$1 [L] 
```

它工作正常，但现在我需要附加查询字符串并找到 QSA 标志。我将它添加到 L 旁边，但它似乎破坏了 mod_rewrite，因为我从 Apache 获得了 500 并且我的 php 脚本没有到达。

```
RewriteRule ^service/(.*)$ blabla/service.php?request=$1 [QSA, L] 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T21:08:09.183

...似乎 mod_rewrite 不喜欢标志之间的空格。

```
RewriteRule ^service/(.*)$ blabla/service.php?request=$1 [QSA,L]
                                                             ^ 
```

这解决了问题（叹气）。

# iphone - Cocoa 错误 260，文件路径结构

> ID：12591097
> 
> 赞同：0
> 
> 时间：2012-09-25T21:08:13.400
> 
> 标签：iphone, xcode, cocoa, file, ftp

我正在使用这种方法

```
-(BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url 
```

当我在我的应用程序中打开文件时，它会给出一个特定的文件 url。那个网址看起来像

```
file://localhost/Users/User/Library/Application%20Support/iPhone%20Simulator/6.0/Applications/229C1D14-28D4-4B82-8CBB-8B9BC472E7A3/Documents/Inbox/Trinity_2016-4.pdf 
```

我正在尝试将其从文件 url 转换为路径，以便可以将其与开源库[SCRFTPRequest 一起](https://github.com/Hackmodford/SCRFTPRequest)使用。

问题是当我尝试指向文件时遇到可可错误 260，我只是想确保我正确设置了它。

```
NSFileReadNoSuchFileError = 260,                        // Read error (no such file) 
```

这是示例代码

```
SCRFTPRequest *ftpRequest = [[SCRFTPRequest alloc] initWithURL:[NSURL URLWithString:@"ftp://192.168.1.101/"] 
toUploadFile:[[NSBundle mainBundle] pathForResource:@"Info" ofType:@"plist"]]; 
```

这就是我改变它的方式

```
NSString *fileurl = @"file://Users/User....pdf";
NSString *path = [fileurl substringFromIndex:16];
SCRFTPRequest *ftpRequest = [[SCRFTPRequest alloc] initWithURL:[NSURL URLWithString:@"ftp://192.168.1.101/"] 
toUploadFile:path]; 
```

此代码的格式是否正确？正如所写，它使用 substringFromIndex 将文件 url 从 file://localhost/Users/User... 更改为 /Users/User...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T04:46:46.250

```
NSString *fileurl = @"file://Users/User....pdf";
NSString *path = [fileurl substringFromIndex:16]; 
```

您缺少正确的索引。这段代码不是`path`be `/Users/User....pdf`，而是`....pdf`。如果没有方法从 URL 中提取路径写入

```
NSString *path = [fileurl substringFromIndex:6]; 
```

就足够了。但是，既然我们有很棒的 NSURL 类，**没有理由**不写

```
NSURL *realURL = [NSURL URLWithString:fileurl];
NSString *path = [realURL path]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T04:49:30.037

您可能会收到“没有这样的文件”错误，因为您传递的文件路径与实际文件不对应。

尝试`NSLog`查看您正在传递的堆路径并验证该文件是否确实存在于文件系统中。

# html - 如何使用数据类别属性进行排序

> ID：12591098
> 
> 赞同：1
> 
> 时间：2012-09-25T21:08:15.867
> 
> 标签：html, sorting, filter, filtering, portfolio

我遇到了一个很棒的排序组合，我正在尝试修改它以满足我的需求，但我不知道如何通过 URL 对列表进行排序。就目前而言，默认设置是自动加载“所有”项目，然后使用基于所选类别的数据类别属性对列表进行排序。这对主页很有用，但我的问题是我想在内部项目页面上包含这个相同的菜单，当点击特定类别时，让它链接回主页，排序为适当的类别。

这是我的带有非工作菜单的项目页面的具体示例：http: [//staging.jtgurzi.com/single-project.php](http://staging.jtgurzi.com/single-project.php)

这是所有项目的主页： http: [//staging.jtgurzi.com/](http://staging.jtgurzi.com/)

从上面例子中的任何项目页面，我希望能够单击一个类别（例如故事片）并将其链接回列出所有项目的位置，过滤到上述“故事片”类别（几乎就像一个某种意义上的锚标签）。由于排序会自动生成链接，因此我无法通过 href 调用它（或弄清楚如何调用它）。我试过 /index.php&data-categories=feature，但没有骰子。

长话短说，单击项目页面中的类别链接 --> 链接回索引页面 --> 缩略图会自动过滤到正确的类别。

任何想法将不胜感激。

在此先感谢，-埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T01:35:11.913

带有 bbq 插件的同位素哈希历史正是我想要的：

[http://isotope.metafizzy.co/demos/hash-history.html](http://isotope.metafizzy.co/demos/hash-history.html)

# objective-c - 带有主从控制器的模态视图控制器大小

> ID：12591103
> 
> 赞同：3
> 
> 时间：2012-09-25T21:08:52.107
> 
> 标签：objective-c, ios, cocoa-touch, ipad, uikit

我的应用程序有一个拆分的主从界面：当用户点击屏幕细节侧的特定按钮时，我使用 a`UIModalTransitionStyleFlipHorizontal` `modalTransitionStyle`这样我就可以模态地呈现一个新控制器并让它看起来好像细节面板已经“翻转” "到新界面。

虽然这在 iPhone 上运行良好，但当我在 iPad 上尝试时，新的模态控制器从屏幕的细节侧翻转，但在动画结束时，它覆盖了整个屏幕。

如何使控制器仅在屏幕的详细信息侧翻转？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T12:51:21.200

如果您还没有弄清楚这一点，那么您已经完成了大部分工作。您需要为“当前上下文”定义模态视图的表示上下文，以便它只在详细视图中运行，而不是在整个超级视图中运行。

最简单的方法是在情节提要中使用 segue 设置视图。在 IB 中，创建新的视图控制器，添加一个 segue 并通过为其命名“flipper”来编辑 segue 行，将其设置为模态，将其设置为翻转并将其呈现设置为“当前上下文”。

一旦设置了这些属性，您就可以转到视图控制器 - 但从详细视图控制器启动它，如下所示：

```
[self performSegueWithIdentifier:@"flipper" sender:self]; 
```

如果您需要在代码中进行转换，它看起来像这样：

```
UIViewController *abc = [self.storyboard instantiateViewControllerWithIdentifier:@"flipper"];
[abc setModalPresentationStyle:UIModalPresentationCurrentContext];
[abc setModalTransitionStyle:UIModalTransitionStyleFlipHorizontal];
[self presentViewController:abc animated:YES completion:nil]; 
```

好起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T03:20:38.930

对我来说有 2 个选项，一个正确的方式（查看动画过渡）和一个 hacky 方式（通过模态呈现控制器来弄脏）。

首先是 hacky 方式，您可以展示您的模态视图控制器，如您所知，模态视图控制器接管屏幕并且是唯一可访问的控制器，但您可以调整它的大小，使其最终呈现在详细信息部分的上方仅屏幕，这里的问题是它不打算调整大小和放错位置，而且在发生旋转时很容易遇到问题。`UISplitViewController`此外，当此控制器存在时，您将无法与您的主控部分进行交互。

例如，可以这样做：

```
UIViewController *detail = [[UIViewController alloc] init];

detail.modalPresentationStyle = UIModalPresentationFormSheet;
detail.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;

if([self respondsToSelector:@selector(presentViewController:animated:completion:)]){
    [self presentViewController:detail animated:YES completion:nil];
}else{
    [self presentModalViewController:detail animated:YES];
}

detail.view.superview.frame = CGRectMake(320.0, 0.0, self.view.frame.size.width - 320.0, self.view.frame.size.height);

[detail release]; 
```

您可能需要调整细节视图控制器视图的超级视图的中心...我不建议这样做。

您的另一个解决方案是`UIView`在您的详细视图控制器中使用动画来交换您的视图和动画以翻转。

要查看它的外观，请查看适用于 iOS 的 Facebook 应用程序，在聊天中，当您进行对话时，您可以点击右上角的 [...] 按钮，视图的内容会翻转，您可以调整通知该人/聊天的设置。

例如，当您点击详细视图控制器中的按钮时，您可以执行以下操作：

```
UIViewController *someOtherController = [...];

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.8];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft
                       forView:self.view
                         cache:YES]; 

[self.view addSubview:someOtherController.view];

[UIView commitAnimations]; 
```

你会做相反的事情来删除它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T12:29:43.987

我的问题是我从一个常规的控制器中呈现控制器`UIViewController`，但我应该从拆分视图控制器中呈现它。

# php - 正则表达式匹配表示西班牙语日期的字符串

> ID：12591105
> 
> 赞同：0
> 
> 时间：2012-09-25T21:08:55.457
> 
> 标签：php, regex

我需要使用正则表达式来验证代表完整日期字符串的字符串（用西班牙语编写）......我不需要验证实际字符串是否是有效日期（闰年等......）

字符串如下所示：

```
23 de septiembre del 2003

23 de septiembre de 1965 
```

如果年份大于 2000，则在年份之前使用“del”一词，如果不是，则使用“de”一词...

我做了我的研究，发现如何获得前 2 位数字：

```
$pattern = ([0-9]+); 
```

..然后我迷失了如何把它们放在一起......

帮助 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:13:04.180

```
/\b\d{1,2} de [a-z]+ (de 1\d{3}|del 2\d{3})/i 
```

解释：

```
\b              ... requires a word boundary, since the following character is a digit
                    (and thus a word character) this will only match if the date is
                    preceded by a character that is not a letter, not a digit and
                    not an underscore
\d{1,2}         ... one or two digits
de              ... literally "de"
[a-z]+          ... any letter from a-z, at least once but an arbitrary number of times
(de 1\d{3}      ... literally "de" followed by "1" and 3 more digits
|               ... or
del 2\d{3})     ... literally "del" followed by "2" and 3 more digits

i               ... make the whole thing case-insensitive (you can omit this if needed) 
```

另请注意，正则表达式中的所有空格都被视为与任何其他字符一样。

或者，`[a-z]+`您可以指定一个有效月份列表，例如

```
/\b\d{1,2} de (...|septiembre|...) (de 1\d{3}|del 2\d{3})/i 
```

（用更多的月份名称替换 ...`|`以将它们分开）

# css - 在 Windows 8 Metro 风格应用程序中移除 div 周围的灰色边框（悬停时）

> ID：12591109
> 
> 赞同：2
> 
> 时间：2012-09-25T21:08:58.240
> 
> 标签：css, windows-8, windows-runtime

我正在构建一个 Windows 8 Metro 风格的应用程序，我想将磁贴的样式与开箱即用的磁贴样式稍有不同。当用户将鼠标悬停在磁贴 (div) 上时，它周围会出现一个灰色框。这是一个屏幕截图。

![Windows 8 应用程序的屏幕截图，磁贴周围有灰色边框](../Images/58289df29b4e3f9c43ec0ace6a127b63.png)

但是代码中没有与这些灰色边框相关联的 CSS 样式。

无论如何，我尝试使用以下代码覆盖它。但它没有用。

```
div:hover {
  border: none;
} 
```

**[添加以回应评论]**这是 HTML：

```
<body>
    <h1>App title</h1>
    <div id="categoriesTemplate" data-win-control="WinJS.Binding.Template">
        <div class="category">
            <a href="#" data-win-bind="innerText:title"></a>
        </div>
    </div>   

    <div id="headerTemplate" 
            data-win-control="WinJS.Binding.Template" 
           style="display: none">
        <div class="simpleHeaderItem">
            <h1 data-win-bind="innerText: title1"></h1>
        </div>
     </div>

  <div id="semanticZoomTemplate" data-win-control="WinJS.Binding.Template" 
       style="display: none">
        <div class="semanticZoomItem">
            <h1 class="semanticZoomItem-Text" 
                data-win-bind="innerText: title1">
             </h1>
        </div>
    </div>

   <div id="semanticZoomDiv" data-win-control="WinJS.UI.SemanticZoom"> 
          <div id="categoriesListView"
            data-win-control="WinJS.UI.ListView"
            data-win-options="{itemTemplate:categoriesTemplate,
           groupHeaderTemplate: headerTemplate
           ,layout: {type: WinJS.UI.GridLayout} }">
        </div>  
      <div id="zoomedOutListView"
        data-win-control="WinJS.UI.ListView"
        data-win-options="{itemTemplate: semanticZoomTemplate, 
                           selectionMode: 'none', 
                           tapBehavior: 'invoke', 
                           swipeBehavior: 'none' }">

        </div>
   </div>
</body> 
```

这是CSS。

```
div.category:hover {
    width: 180px; 
    height: 50px;
    background-color:#f6f4d3;
    text-align:center;
    padding-top:25px;
    color: #f6f4d3;
    outline:none;
    border:none;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T01:04:33.107

Jeff 对样式选择器的看法是正确的。不过，您不需要 background-color 属性。大纲：透明的作品本身。我刚试过。

```
#myList .win-container:hover {
    outline: none;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T21:29:50.503

我假设您正在列表视图中渲染内容。

将以下样式添加到您的 CSS...

```
#idOfYourListView .win-container:hover {
    background-color: red; 
    outline: orange solid 5px;
} 
```

如果您不使用 ListView，请发布您用于创建屏幕截图的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:30:50.503

悬停样式可能与链接相关联，也可能与该元素的类而不是 div 相关联。

正如 KRyan 建议的那样，使用调试器找出您要定位的元素，否则尝试更改 CSS 文件中的一些**a**或其他**悬停**元素，反复试验，直到找到正确的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T23:50:26.913

要调试使用 HTML/CSS/JS 的 WinRT 应用程序，您只需 F5 您的应用程序，当它运行时，您转到 Visual Studio 中的 DOM 资源管理器。如果您没有将其视为选项卡，请转到调试 | 窗户 | DOM Explorer（如果您还没有看过 JavaScript 控制台，那么您也应该看看它！）。现在您可以点击 Select Element 按钮（靠近 DOM Explorer 的顶部），然后在应用程序中选择一个元素。

# javascript - 拖动原始元素 HTML5 拖放

> ID：12591114
> 
> 赞同：4
> 
> 时间：2012-09-25T21:09:31.460
> 
> 标签：javascript, html, draggable, drag-and-drop

我正在使用本机拖放 html5 api 开发拖放界面。我们已经为其他部分使用了 jQuery draggable，但它在这个特定部分中表现不佳，所以我们使用原始 JavaScript。

基本上标记看起来像这样......

```
<li draggable="true">
  <div class="esia_img esia_amex"></div>
  <span class="esia_imgTitle flo">AmEx</span>
</li>
<li draggable="true">
  <div class="esia_img esia_visamc"></div>
  <span class="esia_imgTitle flo">VisaMC</span>
</li> 
```

我为“dragstart”创建了一个 addEventListener 并运行以下函数

```
function dragStart (e) {
            var t = this;
            n(t).addClass('rot_15');
            e.dataTransfer.effectAllowed = 'move';
        } 
```

它将我的类完美地应用于原始元素，但我似乎无法移动原始元素。浏览器会创建一个“克隆/幽灵”图像...我看到您可以在哪里创建自己的图像以在使用“setDragImage”拖动时显示，但是如何拖动用户正在拖动的实际元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:32:00.553

（不是真正的答案，但评论太长了）

> .图像被克隆，你拖动克隆。

不太清楚你的意思。我只是在我链接的页面上复制/粘贴了示例 - 没有任何事情发生。没有任何元素的复制或克隆。也许您不确定 appendChild 的操作？示例代码只是创建一个 div，后跟一个图像。您可以将图像拖放到 div 上。这会导致 img 标签现在包含在 div 中，而不是像加载它时那样替换它。我还要注意，由于他们的目标 div (div id='div1') 没有内容，它没有高度。您应该向 div 添加一些文本以使其可见。然后，在拖放时观察 javascript 调试器中的 html 元素。页面上只有一张图片，它只是在 DOM 树中重新定位。:)

在这里，复制/粘贴并在调试器中观看。

```
<!DOCTYPE HTML>
<html>
<head>
<script type="text/javascript">
function allowDrop(ev)
{
ev.preventDefault();
}

function drag(ev)
{
ev.dataTransfer.setData("Text",ev.target.id);
}

function drop(ev)
{
ev.preventDefault();
var data=ev.dataTransfer.getData("Text");
ev.target.appendChild(document.getElementById(data));
}
</script>
</head>
<body>

<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)">
    id='Div1' - Drop Target
</div>
<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)">
    id='Div2' - Drop Target
</div>

<!--
<img id="drag1" src="img/logo.gif" draggable="true"
ondragstart="drag(event)" width="336" height="69">
-->
<h1 id='drag1' draggable='true' ondragstart='drag(event)'>Drag me</h1>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:19:07.200

在回答 1 的评论中提供的额外信息之后，解决此问题的方法（我知道）是放弃 html 本机拖放支持，而不是自己实现它。

我忘记了导致旧浏览器（尤其是 IE）出现问题的原因是什么，尽管我感觉要么是 onTgtMouseDown 的事件变量，要么是 clientX/scrollLeft。

无论如何，下面的代码是用当前的 Chrome 和 IE9 测试的。

希望它适合您的目的（它在视觉上定位对象，但不会改变节点在 DOM 树中的位置）

```
<!DOCTYPE html>
<html>
<head>

<style>
#tgt
{
    position: absolute;
    border: solid 1px red;
    text-align: center;
    display: inline-block;
}
</style>

<script>
function byId(e){return document.getElementById(e);}
function myInit()
{
    var dragMe = byId('tgt');
    dragMe.ondragstart = function() { return false; }
    dragMe.onmousedown = onTgtMouseDown;
}

function onTgtMouseDown(e)
{
    var mDlg, self=this;
    var initMx, intMy, initDlgX, initDlgY, dx, dy;
    var mTgt;

    mTgt = this;

//  mDlg = this.parentNode;
//  mDlg.zIndex = 1000;
//  mDlg.style.position = 'absolute';
    mTgt.zIndex = 1000;
    mTgt.style.position = 'absolute';

    e = e || event;
    initMx = e.pageX;
    initMy = e.pageY;
    initDlgX = mTgt.offsetLeft;
    initDlgY = mTgt.offsetTop;
    // offset from top left of element to mouse when button pressed
    dx = initMx  - initDlgX;
    dy = initMy - initDlgY;

    document.onmousemove = function(e)
    {
        e = e || event;
        fixPageXY(e);
        mTgt.style.left = e.pageX-dx+'px';
        mTgt.style.top = e.pageY-dy+'px';
    }
    this.onmouseup = function()
    {
        document.onmousemove = null;
    }
}

// e = event
function fixPageXY(e) 
{
  if (e.pageX == null && e.clientX != null ) 
  {
    var html = document.documentElement
    var body = document.body
    e.pageX = e.clientX + (html.scrollLeft || body && body.scrollLeft || 0)
    e.pageX -= html.clientLeft || 0
    e.pageY = e.clientY + (html.scrollTop || body && body.scrollTop || 0)
    e.pageY -= html.clientTop || 0
  }
}

</script>

</head>
  <body onload='myInit();'>
    <div id='tgt'>Drag Me</div>
  </body>
</html> 
```

# android - 是否可以在Android框架（库）中封装权限

> ID：12591115
> 
> 赞同：1
> 
> 时间：2012-09-25T21:09:49.623
> 
> 标签：android, frameworks, permissions

我有一些项目#1，它是图书馆。

例如，它适用于 GCM (C2DM) 消息，并且`my_package.permission.C2D_MESSAGE`在其清单文件中具有权限（和其他权限）。

我将项目#1（lib）连接到项目#2（一些应用程序）。

问题：是否可以从项目 #1 为项目 #2 自动激活权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:38:01.293

目前没有。如果“library”的意思是“Android library project”，这在未来可能是可能的。

但是，在您的特定情况下，这可能永远不会奏效。一些 GCM 框架类将使用应用程序的包，无论使用 GCM 的代码是否在 Android 库项目中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-16T18:04:41.147

我已经让它与 AndroidStudio 和 mainfestmerging 一起使用。我拥有库项目中的所有 GCM 权限、广播接收器和意图接收器。我的图书馆中的意图服务在我的应用程序中调用了意图服务。在我的例子中，应用程序向库注册此服务名称并将其存储在数据库中，因此库意图服务知道要为应用程序使用哪个意图。我的应用程序中的任何地方都没有 GCM 代码或权限。这是我的图书馆清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="org.plasync.client.android"
          android:versionCode="1"
          android:versionName="1.0">
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.INTERNET" />
    <!-- Needed for devices with 4.02 or earlier android -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <permission android:name="org.plasync.client.android.permission.C2D_MESSAGE"
        android:protectionLevel="signature" />
    <uses-permission android:name="org.plasync.client.android.permission.C2D_MESSAGE" />
   <!-- <uses-permission android:name="com.playsnc.client.android.data.permission.READ_WRITE"/>-->

    <application android:label="" android:icon="@drawable/ic_launcher">
        <!-- This is the signin activity for plAsync -->
        <activity android:name="org.plasync.client.android.AsyncMultiplayerSetupActivity"
                  android:label="@string/SETUP_ACTIVITY_NAME"
                  android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen">

            <!-- This is the intent for getting the local user.  Apps that use plAsync must use this
                 intent to retrieve the local user, or allow the user to signin.  Apps should
                 use startActivityForResult as the sigin activity may require user interaction -->
            <intent-filter>
                <action android:name="@string/SETUP_ASYNC_MULTIPLAYER_SESSION_ACTION"/>
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <receiver android:name="org.plasync.client.android.gcm.GcmBroadcastReceiver"
                  android:permission="com.google.android.c2dm.permission.SEND" >
            <intent-filter>
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
            </intent-filter>
        </receiver>

        <service android:name="org.plasync.client.android.gcm.GcmReceiveIntentLauncher"/>
    </application>
</manifest> 
```

这是我的应用程序清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="org.plasync.client.android.testapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme">
        <activity
            android:name="org.plasync.client.android.testapp.AsyncMultiplayerTestAppActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name=".search.FriendSearchActivity"
                  android:launchMode="singleTop">
            <intent-filter>
                <action android:name="android.intent.action.SEARCH" />
            </intent-filter>
            <meta-data android:name="android.app.searchable"
                android:resource="@xml/searchable"/>
        </activity>

        <service android:name=".AsyncMultiplayerTestAppMessageReceiver"/>
    </application>

</manifest> 
```

正如 CommonsWare 所指出的，你必须小心你的包。如我的 BroadcastReceiver 的代码所示，意图服务（库或应用程序）的 ComponentName 包始终是应用程序包。

```
public class GcmBroadcastReceiver extends WakefulBroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        // Explicitly specify that GcmIntentService will handle the intent.
        ComponentName receiveIntentLauncherComponent =
                new ComponentName(context.getPackageName(),
                                  GcmReceiveIntentLauncher.class.getName());
        // Start the service, keeping the device awake while it is launching.
        startWakefulService(context, (intent.setComponent(receiveIntentLauncherComponent)));
        setResultCode(Activity.RESULT_OK);
    }
} 
```

另外，请注意您不能使用 Google BroadcastReceiver；您需要如上所述定义自己的。原则上我可以从广播接收器启动应用程序意图，但由于我从数据库中获取应用程序意图名称，因此不建议在广播接收器中执行此类操作。

希望有帮助。

# c - 需要关于带有 ATmega32-A 微控制器的 AD9833 波形发生器的帮助

> ID：12591117
> 
> 赞同：0
> 
> 时间：2012-09-25T21:10:11.370
> 
> 标签：c, embedded, spi, texas-instruments

我正在尝试使用带有 ATmega32-A 微控制器的可编程波形发生器 AD9833 生成正弦波。（MCLK = 8MHz 时钟频率）。我正在使用 USART 通信，因此如果我在超级终端中更改频率，则必须更改波形频率。我为此编写了小代码，如下所示。

但是从上面的代码中，我正在生成正弦波，但是如果我想将信号频率更改为 125KHz，那么我必须在超终端输入 499.9KHz。如果我输入 125KHz，那么它显示的是 31.2KHz。我不知道它为什么会这样产生以及我犯了什么错误？而且它正在改变波形直到 500KHz 频率假设如果我输入大约 1000KHz 的波形频率，但信号的频率没有变化，它只显示 125KHz。

最后我想生成不同频率的波形。如果我在超级终端或腻子上改变频率，那么我输入的任何频率都必须生成具有该频率的波形。

这是我的第一篇文章，如果有任何语法错误，请见谅。

提前致谢。

```
 void unicom(void){

         switch(Command){

                case(WGF):
            if(Param < 500)
                SetWGFreq(Param);   
                Command = 0;
            break; 

               case....
               case....
               default:
             }

  void main(void){
  SetWGFreq(125);
  -----------
   --------
   } 
```

嗨再一次，

这次我尝试通过 SPI 使用 SM470R1B1M-HT 微控制器对 AD9833 进行编程。我遵循与下面的“ross”解释的相同原则。看来我无法改变正弦波频率。下面是我正在尝试的代码，我设置了与以前相同的时钟配置。

```
void SetupSPI(void);
unsigned char spi(unsigned char data);
void SetWGFreq(unsigned int);
void setFrequencyA(unsigned long fdata);
void WG_CS_Status(int status);

int main(void)
{
GCR &= ~ZPLL_MULT4; 
GCR &= ~ZPLL_CLK_DIV_PRE1; 
GCR &= ~ZPLL_CLK_DIV_PRE2;
GCR &= ~ZPLL_CLK_DIV_PRE3;   

PCR = CLKDIV_1;                         // ICLK = SYSCLK 
PCR |= PENABLE;                         // Enable peripherals

GIODIRA |= X7;

CLKCNTL |= CLKDIR | CLKSR_ICLK;

SetupSPI();

for(;;)
{
  //SetWGFreq(25);
  setFrequencyA(1045200);
}                             // Wait in endless loop
}

void SetupSPI(void)
{
int data = 0;

 SPI2CTRL1 = CHARLEN_8 + PRESCALE_4;                // 8 bits per xfer
 SPI2CTRL2 |= CLKMOD + MASTER + POLARITY;             // We are the master
 SPI2PC6 |= SOMI_FUN | SIMO_FUN | CLK_FUN;
 // SPI2PC6 |=   0x0E;
 // enable
 SPI2CTRL2 |= SPIEN;

 data = SPI2BUF;
}

unsigned char spi(unsigned char data)
 {
    SPI2DAT1 = data;             
    while(!(SPI2CTRL3 & 0x01)){}        // Wait for RxFlag to get set    
    return (SPI2BUF & 0x000000FF);      // Read SPIBUF 
 } 

void setFrequencyA(unsigned long fdata)
 {
 WG_CS_Status(0);
 while(GIODOUTA&X7);   // Delay
 spi(0x20);      // Initiate loading of frequence register 0 by 28 bits.
 spi(0x00);
 spi(( 0x40 | (0x3F & (fdata >> 8))));   // load bit 8-13 + 0x40.
 spi(fdata);                             // load bit 0-7
 spi(( 0x40 | (0x3F & (fdata >> 22))));  // load bit 22-27 + 0x40.
 spi(fdata >> 14);                       // load bit 14-21
 spi(0);   // dummy write
 WG_CS_Status(1);
}
void WG_CS_Status(int status)
 {    
 if(status == 0)
  {
     // Make Chip Select low
     GIODOUTA &= ~X7;
  }
 else
  {
     // Make Chip select high
     GIODOUTA |= X7; 
   }
 } 
```

我附上了我为这个控制器和 AD9833 编程而休憩的 SPI 指南。[SPI指南](http://www.ti.com/lit/ug/spnu195e/spnu195e.pdf) [AD9833](http://www.analog.com/media/en/technical-documentation/application-notes/AN-1070.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:31:48.370

当您将频率转换为 AD9833 需要的两个 14 位数字块时，您在频率寄存器的 D14 和 D15 中进行或运算。那里有两个问题。

第一个问题是您丢失了 freg 值的 4 位（一次 2 位）。

```
76543210 76543210 76543210 76543210
LL000000 00000000 LL000000 00000000 //The L's are lost because they're overwritten by the addressing. 
```

第二个问题是您需要位 15 和 14 正好是 0x40。现在，在数据中进行 OR'ing 时，如果根据您的频率已经存在数据，则结果可能为 0xC0。

作为一个小提示，我认为在分配 to 时没有理由使用掩码`fByte0-3`，因为您正在使用作为分配。

因此，结合这两个修复并简化掩码可以得到：

```
fByte0 = (char)freg;
fByte1 = (char)(freg>>8);
fByte1 = (fByte1 & 0x3F) | 0x40; //clears bits 15 and 14, then sets for FREQ0
fByte2 = (char)(freg>>14);  //byte1 only has 6 bits, so move over by 8+6
fByte3 = (char)(freg>>22);  //byte1 only has 6 bits, so move over by 8+8+6
fByte3 = (fByte3 & 0x3F) | 0x40; //clears bits 15 and 14, then sets for FREQ0 
```

我认为这会让你到达你想去的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T00:27:00.217

我在您的代码中看到的基本问题是它没有*分层*。您正试图在一个例程中进行过多的数据操作。您在另一篇文章中读取 ADC 值的代码是分层的，这就是您应该为该设备执行的操作。

AD9833 波形发生器本质上是一个 16 位器件。它需要编程的三种寄存器都是16位的。只有 8 位的数据传输（使用 SPI）。因此，只有实际的输出语句（使用*spi()*）需要处理字节（就像您的 ADC 输入例程立即将读取的字节转换为短整数一样）。为生成器计算的值应该是 16 位值。然后你应该可以看到代码是如何实现生成器数据表中的数据要求的。

```
void WG_out(unsigned short rval)
{
    /* assume little-endian CPU but AD9833 wants high byte first */
    spi(*((unsigned char *)&rval + 1));
    spi(*(unsigned char *)&rval);
}

void SetWGFreq(int fsel, unsigned int freq)
{
    unsigned short freg_addr;
    unsigned short freq_reghi;
    unsigned short freq_reglo;
    unsigned short cntl_reg;

    SPCR = 0x5A;         /* set SPI to mode 2 and Fosc/64 */
    WG_CS = 0;

    freg_addr = (fsel > 0) ? 0x8000 : 0x4000;
    /* split the f value into two 14-bit values */
    freq *= 33554.432;   /* number based on a MCLK of 8 MHz */
    freq_reghi = freg_addr | ((freq >> 14) & 0x00003fff);
    freq_reglo = freg_addr | (freq & 0x00003fff);

    cntl_reg = (1 << 13) | (fsel > 0) ? (1 << 11) : 0;
    while (WG_CS_PIN)   /* wait for chip select to go low */
        /* DELAY */ ;   
    WG_out(cntl_reg);   /* set B28 in Control */
    WG_out(freq_reglo); /* 14 LSB goes first */
    WG_out(freq_reghi); /* 14 MSB goes next */
    WG_CS = 1;
}

void SetWGPhase(int fsel, int psel, unsigned int phase)
{
    unsigned short cntl_reg;
    unsigned short phase_reg;

    SPCR = 0x5A;
    WG_CS = 0;
    cntl_reg = (1 << 13) | (fsel > 0) ? (1 << 11) : 0 | (psel > 0) ? (1 << 10) : 0;
    phase *= 1303;      /* 4096 / 2pi radians */ 
    phase_reg = 0xc000 | (psel > 0) ? (1 << 13) : 0 | (phase & 0x0fff);
    while (WG_CS_PIN)   /* wait for chip select to go low */
        /* DELAY */ ;   
    WG_out(cntl_reg);   /* set B28 in Control */
    WG_out(phase_reg);
    WG_CS = 1;
} 
```

该代码允许指定*FREQ0*或*FREQ1*以及*PHASE0*或*PHASE1*寄存器。*WG_out()* 的源代码看起来很复杂，但实际上可以编译成非常简单的机器代码。

**仍然需要代码改进**

*   幻数需要替换为`#define`s。

*   不需要重写完整的控制寄存器，而是需要维护一个状态变量，以便根据需要只修改控制位。然后可以消除*SetWGPhase()中的**fsel*参数。

# r - 如何在 R 中按年和月排序（使用 Zoo 包中的 as.yearmon）

> ID：12591119
> 
> 赞同：0
> 
> 时间：2012-09-25T21:10:13.040
> 
> 标签：r, sorting, zoo

我正在尝试使用年份和月份信息对向量进行排序。我从 Date 类型变量中获取年份和月份。这是我要完成的示例：

```
example <- as.Date(c("2010-04-22", "2010-04-26", "2010-04-26",
  "2010-06-04", "2010-06-07", "2010-06-18", "2010-06-21",
  "2010-07-14", "2010-07-16", "2010-07-30", "2010-08-20"))

mes_ano <- as.character(as.yearmon(as.Date(example)))

mes_ano <- factor(mes_ano, levels = c(unique(mes_ano),
 "mai 2010", "set 2010", "out 2010", "nov 2010")) 
```

现在我想按年和月对 mes_ano 进行排序，但我不知道如何。

实际上，我真正的目标是对关卡进行排序，因为我将使用 ggplot2 制作一个绘图并且我需要对关卡进行排序。但我认为，如果我只是问关于对向量进行排序，那会让我们的生活更轻松。然后我可以弄清楚如何对级别进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T08:25:20.290

我想您想使用 Potuguese 月份名称。我们走吧：

您的数据：

```
example <- as.Date(c("2010-04-22", "2010-04-26", "2010-04-26",
                     "2010-06-04", "2010-06-07", "2010-06-18", "2010-06-21",
                     "2010-07-14", "2010-07-16", "2010-07-30", "2010-08-20")) 
```

我们需要一个具有这些名称的向量：

```
port_mon <- c("jan", "fev", "mar", "abr", "mai", "jun",
              "jul", "ago", "set", "out", "nov", "dez") 
```

现在，对数据进行排序：

```
ex_sorted <- sort(example) 
```

选择正确的葡萄牙语月份名称：

```
month_names <- port_mon[as.numeric(format(ex_sorted, "%m"))] 
```

结合月份和年份：

```
mes_ano <- paste(month_names, format(ex_sorted, "%Y")) 
```

创建因子：

```
mes_ano_fac <- factor(as.yearmon(ex_sorted), labels = unique(mes_ano)) 
```

绘图（出于说明目的在 y 轴上使用无意义的数据）：

```
library(ggplot)

qplot(x = mes_ano_fac, y = seq(length(example))) 
```

![在此处输入图像描述](../Images/ba3c420bfc687a918dcc7be3b7146f9b.png)

# javascript - 动画页面标题是否会阻碍 SEO？

> ID：12591125
> 
> 赞同：2
> 
> 时间：2012-09-25T21:10:47.673
> 
> 标签：javascript, html, seo

我有一个客户请求为 Web 文档的标题设置动画。有点像你可以[在这里](http://www.dynamicdrive.com/dynamicindex11/animatedtitle.htm)看到的。

我可以做到这一点没问题，但我的问题是：

*   动画标题会导致页面的 SEO 出现任何问题吗？

*   在我清除并动画替换之前，我是否应该已经有了最终标题？（我的想法是引擎会在动画更改它之前先读取并索引它）

*   关于 SEO，我应该担心的任何其他问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T21:12:29.637

初始标题（在 HTML 中定义）将是搜索引擎捕获的内容。因此，只要这是您希望搜索引擎看到的标题，就不会成为问题。搜索引擎不会在您的页面上执行 JavaScript（包括负责为您的标题设置动画的 JavaScript），因此它们不会捕获动画标题。

# iphone - tableView cellForRowAtIndexPath - 发送到已释放实例的消息

> ID：12591126
> 
> 赞同：1
> 
> 时间：2012-09-25T21:11:06.233
> 
> 标签：iphone, objective-c, xcode, tableview

每次我尝试从我的应用程序访问视图时，应用程序都会立即关闭。我捕获了激活 NSZombieEnabled 的日志。这就是我得到的原因：

```
 *** -[RecargaOtroController tableView:cellForRowAtIndexPath:]: message sent to deallocated instance 0x604fd20
(gdb) info malloc-history 0x604fd20
Alloc: Block address: 0x0604fd20 length: 192
Stack - pthread: 0xa07c6540 number of frames: 38
    0: 0x955250a3 in malloc_zone_calloc
    1: 0x95524ffa in calloc
    2: 0x10a62d4 in class_createInstance
    3: 0xe725d8 in +[NSObject(NSObject) allocWithZone:]
    4: 0xe723da in +[NSObject(NSObject) alloc]
    5: 0x519c3b in -[UIClassSwapper initWithCoder:]
    6: 0x6039fd in UINibDecoderDecodeObjectForValue
    7: 0x6046ac in -[UINibDecoder decodeObjectForKey:]
    8: 0x51993e in -[UIRuntimeConnection initWithCoder:]
    9: 0x6039fd in UINibDecoderDecodeObjectForValue
   10: 0x6032f5 in UINibDecoderDecodeObjectForValue
   11: 0x6046ac in -[UINibDecoder decodeObjectForKey:]
   12: 0x518c36 in -[UINib instantiateWithOwner:options:]
   13: 0x51aab7 in -[NSBundle(UINSBundleAdditions) loadNibNamed:owner:options:]
   14: 0x3d0628 in -[UIViewController _loadViewFromNibNamed:bundle:]
   15: 0x3ce134 in -[UIViewController loadView]
   16: 0x3ce00e in -[UIViewController view]
   17: 0x3cc482 in -[UIViewController contentScrollView]
   18: 0x3dcf25 in -[UINavigationController _computeAndApplyScrollContentInsetDeltaForViewController:]
   19: 0x3db555 in -[UINavigationController _layoutViewController:]
   20: 0x3dc7aa in -[UINavigationController _startTransition:fromViewController:toViewController:]
   21: 0x3d732a in -[UINavigationController _startDeferredTransitionIfNeeded]
   22: 0x3de562 in -[UINavigationController pushViewController:transition:forceImmediate:]
   23: 0x3d71c4 in -[UINavigationController pushViewController:animated:]
   24: 0x560e in -[RootViewController tableView:didSelectRowAtIndexPath:] at /Users/ipoletti/Documents/Recargame2/Recargame2/Classes/RootViewController.m:378
   25: 0x395b68 in -[UITableView _selectRowAtIndexPath:animated:scrollPosition:notifyDelegate:]
   26: 0x38bb05 in -[UITableView _userSelectRowAtPendingSelectionIndexPath:]
   27: 0x9d79e in __NSFireDelayedPerform
   28: 0xf2f8c3 in __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__
   29: 0xf30e74 in __CFRunLoopDoTimer
   30: 0xe8d2c9 in __CFRunLoopRun
   31: 0xe8c840 in CFRunLoopRunSpecific
   32: 0xe8c761 in CFRunLoopRunInMode
   33: 0x17851c4 in GSEventRunModal
   34: 0x1785289 in GSEventRun
   35: 0x32cc93 in UIApplicationMain
   36: 0x2a3c in main at /Users/.../Documents/Recargame2/Recargame2/main.m:14
   37: 0x29cd in start 
```

显然 tableView 是问题，但我无法弄清楚它有什么问题。它应该如何在 Interface Builder 中链接？我的 .h 中有这个：

```
 @interface RecargaOtroController : UIViewController <UINavigationControllerDelegate, UITableViewDataSource, UITableViewDelegate>{
        BOOL agrandaRecarga;
    }

    IBOutlet UITableView *tableView;
    @property (nonatomic, retain)IBOutlet UITableView *tableView;

UITextField *myLoc;
@property (nonatomic, retain)UITextField *myLoc; 
```

这是我关于 tableView 的 .m 的一部分（我已经合成了它）：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath{
    NSLog(@"TABLE VIEW: %@",tableView);
    NSLog(@"CELL");
    static NSString *CellIdentifier = @"Cell";
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if(cell==nil){
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier]autorelease];
    }

    int r, g, b;
    b = 0x005C84 & 0x0000FF;
    g = ((0x005C84 & 0x00FF00) >> 8);
    r = ((0x005C84 & 0xFF0000) >> 16);
    UIColor *movistarColor = [UIColor colorWithRed:r/255.0f green:g/255.0f blue:b/255.0f alpha:100.0f];
    cell.detailTextLabel.font = [UIFont fontWithName:@"Verdana" size:15.0];
    cell.detailTextLabel.textColor = movistarColor;
    cell.textLabel.font = [UIFont fontWithName:@"Verdana-Bold" size:14.0];
    cell.textLabel.textColor = movistarColor;

    if([ListaNumerosController hayDefault]==nil){
        NSLog(@"NO HAY NUMEROS CARGADOS");
        if(indexPath.row == 0){
            cell.detailTextLabel.text = [NSString stringWithFormat:@"%@ (%@)", tarjetaSeleccionada.alias, tarjetaSeleccionada.numero];
        }else if(indexPath.row == 1){
            cell.detailTextLabel.text = @"Otro";
        }else if(indexPath.row == 2){
            myLoc = [[UITextField alloc] initWithFrame:CGRectMake(10, 10, 250, 40)];
            myLoc.adjustsFontSizeToFitWidth = YES;
            myLoc.textColor = movistarColor;
            myLoc.textAlignment = UITextAlignmentLeft;
            myLoc.highlighted = NO;
            myLoc.clearsContextBeforeDrawing=YES;
            myLoc.placeholder = @"Ingrese su número";

            myLoc.delegate = self;
            myLoc.font = [UIFont fontWithName:@"Verdana" size:14.0];
            myLoc.clearButtonMode = UITextFieldViewModeNever; // no clear 'x' button to the right
            if(myLoc.text.length!=10){
                [myLoc becomeFirstResponder];
            }
            [myLoc setKeyboardType: UIKeyboardTypeNumberPad];
            [myLoc setEnabled:YES];
            [cell addSubview:myLoc];
        }else /*if(indexPath.row == 3)*/{
            cell.detailTextLabel.text = recarga.monto;
        }
    }else{
        NSLog(@"HAY NUMEROS CARGADOS");
        if(![telefonoSeleccionado.alias isEqualToString:@"Otro"]){
            NSLog(@"NO SE SELECCIONO OTRO NUMERO");
            if(indexPath.row == 0){
                cell.detailTextLabel.text = [NSString stringWithFormat:@"%@ (%@)", tarjetaSeleccionada.alias, tarjetaSeleccionada.numero];
            }else if(indexPath.row == 1){
                cell.detailTextLabel.text = [NSString stringWithFormat:@"%@ (%@)",telefonoSeleccionado.alias,[telefonoSeleccionado.telefono substringFromIndex:6]];
            }else if(indexPath.row == 2){
                cell.detailTextLabel.text = recarga.monto;
                myLoc.text = @"";
            }else if(indexPath.row == 3){
                cell.detailTextLabel.text = @"";
            }
        }else{
            NSLog(@"SE SELECCIONO OTRO NUMERO");
            if(indexPath.row == 0){
                cell.detailTextLabel.text = [NSString stringWithFormat:@"%@ (%@)", tarjetaSeleccionada.alias, tarjetaSeleccionada.numero];
            }else if(indexPath.row == 1){
                cell.detailTextLabel.text = @"Otro";
            }else if(indexPath.row == 2){
                cell.detailTextLabel.text = @"";
            }else if(indexPath.row == 3){
                cell.detailTextLabel.text = recarga.monto;
            }
        }
    }

    return cell;

}

- (void)dealloc {
    [super dealloc];    
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    // Start listening for updates when visable
   [tableView setDelegate:self];
    [tableView reloadData];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    // Stop listening for updates when not visable
    [tableView setDelegate:nil];
} 
```

我在想问题可能出在 Interface Builder 文件中，有什么建议可以找出问题所在吗？

谢谢！

更新：我的应用程序包含一个带有表格的主窗口。当您单击每一行时，您将转到另一个视图。新视图 (RecargaOtroController) 有另一个表。我使用另一个控制器以相同的方式实例化每个视图：

第三视图控制器.h

```
#import <UIKit/UIKit.h>

@interface ThirdViewController : UIViewController {

}

@end 
```

第三视图控制器.m

```
#import "ThirdViewController.h"

@implementation ThirdViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization.
    }
    return self;
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

- (void)viewDidUnload {
    [super viewDidUnload];
}

- (void)dealloc {
    [super dealloc];
} 
```

然后，我的 RootViewController 是主屏幕：

RootViewController.h（摘录）

```
#import <UIKit/UIKit.h>

@interface RootViewController : UITableViewController <UIAlertViewDelegate, UINavigationControllerDelegate, UITableViewDataSource, UITableViewDelegate> {
    NSMutableArray *opcionesMenu;
    BOOL agrandaRecarga;
}

IBOutlet UITableView *tableView;
@property (nonatomic, retain)IBOutlet UITableView *tableView; 
```

RootViewController.m（摘录）

```
ThirdViewController *detailViewController = nil;

if (indexPath.row == 1) {
            [self showConfirmaRecargaMessage];
            return;
        }else if (indexPath.row == 2) {
            detailViewController = [[RecargaOtroController alloc] initWithNibName:@"RecargaOtro" bundle:nil];
            detailViewController.title = @"Recargar otro número o monto";
        }else if (indexPath.row == 3) {

...

- (void)dealloc {
    [super dealloc];
} 
```

我从不解除 RecargaOtroController （无论如何，我正在实例化的任何屏幕类别，那些总是有效的）。

# python - 如何从海德的单个帖子视图中隐藏摘录？

> ID：12591127
> 
> 赞同：0
> 
> 时间：2012-09-25T21:11:08.373
> 
> 标签：python, hyde

我在[这个 Hyde 项目](https://github.com/leonstafford/leonhyde)中遇到了一些问题，我的主页和博客索引页面显示正确地从单个博客文章的摘录和图像标记部分中提取，但是在查看单个博客文章时，摘录也被显示，我没有想。

尝试自定义单个帖子模板是我尝试过的一个选项，但随后无法在主页和博客索引上显示这些图像和摘录部分。

任何允许我在帖子内容文件中默认编写摘录但将其隐藏在单个帖子视图中的解决方案都是理想的，但可以接受任何建议。

干杯，

莱昂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:01:19.333

由于您不希望它显示在内容中，因此您可能应该将其添加到帖子元数据中。您可以在那里拥有完整的降价内容，并像现在一样使用 markdown|typogrify 过滤器。

```
---
title: Django, Debian and Postgre Web Development (part 1)
excerpt: >
     A complete walkthrough to developing a web app using double D's and some P 
...
---
... 
```

并在您的主页中：

```
{{ res.meta.excerpt|markdown|typogrify }} 
```

* * *

如果出于某种原因您不希望这样做，您可以随时使用它来确定您是为`refer`通话还是常规通话进行渲染：

```
{% mark excerpt -%}
{% if _markings_ is defined -%}

 A complete walkthrough to developing a web app using double D's and some P

{%- endif %}
{%- endmark %} 
```

# multithreading - 全局变量和线程

> ID：12591132
> 
> 赞同：0
> 
> 时间：2012-09-25T21:11:35.130
> 
> 标签：multithreading, synchronization

如果我有一个全局计数器，并且我有两个线程，每个线程在循环中将其递增 100 次，为什么我可以有一个不是 200 的值？我不明白如何访问变量是非原子的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:12:33.960

这是因为对于大多数环境，增加内存位置并不是原子操作。

事件的顺序将类似于

*   编译器将值 0 放在内存地址 0xABCD
*   线程 1 将 0xABCD 读入寄存器并递增寄存器值
*   线程 1 被线程 2 中断
*   线程 2 从内存地址 0xABCD 读取值 0 到寄存器中
*   线程 2 递增寄存器中的值
*   线程 2 将寄存器中的值写入 0xABCD
*   线程 2 从 0xABCD 读取值 1，递增寄存器，然后再次写回
*   线程 1 恢复
*   线程 1 将其寄存器 1 中的值写入 0xABCD，覆盖线程 2 之前写入的值 2。

为确保结果一致，您必须使增量操作具有原子性。这通常通过在增量操作周围放置一个线程锁来完成。例如，在 C# 中可能看起来像

```
object mylock = new object();
...
lock (mylock) 
{ 
    myInt++;
} 
```

或者，在 .NET 环境中，可以使用 Interlocked.Increment

[http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)

其他环境也有类似的结构。

我遇到过的关于 .NET 环境中的线程的最佳参考（但无论您的环境如何，它都是有用的读物​​）如下

[http://www.albahari.com/threading/](http://www.albahari.com/threading/)

# events - Google Maps API v3 'dragend' 事件在地图完成滑动之前触发

> ID：12591134
> 
> 赞同：1
> 
> 时间：2012-09-25T21:11:47.753
> 
> 标签：events, google-maps, google-maps-api-3, mouseevent

我注意到当你拖动地图时，如果你以加速的方式拖动，在你释放鼠标后，地图有某种动量，它会持续滑动一小段时间，但是会触发 'dragend' 事件当您释放鼠标时（对我来说这似乎是正确的）。

但是你怎么能得到地图完成滑动的确切时刻呢？我对“center_changed”/“bounds_changed”解决方案不感兴趣，因为我需要对事件发出 XHR 请求，并处理一些数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T23:29:10.927

事件怎么样`idle`，最后只触发一次（与`center_changed`and不同`bounds_changed`）。从[文档](https://developers.google.com/maps/documentation/javascript/reference#Map)：

> 当地图在平移或缩放后空闲时触发此事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-23T11:38:24.600

尝试使用`idle`事件。链接到[文档](https://developers.google.com/maps/documentation/javascript/reference#Map "谷歌地图API")。

> 当地图在平移或缩放后空闲时触发此事件。

如果您希望**空闲事件仅在 dragend 之后触发，请**尝试下面的代码段。

此代码在事件触发后将坐标打印`dragend`到控制台。`idle`

```
mapObj.addListener('dragend', function () {
    var idleListener = mapObj.addListener('idle', function () {
        google.maps.event.removeListener(idleListener);
        console.log(mapObj.getCenter().lat()); 
        console.log(mapObj.getCenter().lng());
    });
}); 
```

# android - 使用 actionbarsherlock 时根本不调用 OnTabSelected

> ID：12591135
> 
> 赞同：0
> 
> 时间：2012-09-25T21:11:52.987
> 
> 标签：android, tabs, android-fragments, actionbarsherlock

我以前做过这样的事情，这是一个超级简单的例子，但我似乎无法使用 actionbarsherlock v4.1 让它工作。

这是主要活动

```
public class VanityActivity extends SherlockFragmentActivity {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if (savedInstanceState != null) {
        //restore
    }

    com.actionbarsherlock.app.ActionBar actionBar = getSupportActionBar();
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    actionBar.setHomeButtonEnabled(false);
    actionBar.setDisplayShowHomeEnabled(false);
    com.actionbarsherlock.app.ActionBar.Tab tab1 = actionBar.newTab();
    tab1.setText("Website");
    tab1.setTabListener(new HeaderTabListener(getApplicationContext()));
    tab1.setTag(1);
    actionBar.addTab(tab1);

    com.actionbarsherlock.app.ActionBar.Tab tab2 = actionBar.newTab();
    tab2.setText("Portfolio");
    tab2.setTabListener(new HeaderTabListener(getApplicationContext()));
    tab2.setTag(2);
    actionBar.addTab(tab2);

    com.actionbarsherlock.app.ActionBar.Tab tab3 = actionBar.newTab();
    tab3.setText("Team");
    tab3.setTabListener(new HeaderTabListener(getApplicationContext()));
    tab3.setTag(3);
    actionBar.addTab(tab3);

}

} 
```

还有我的 HeaderTabListener 类：

```
public class HeaderTabListener implements   

com.actionbarsherlock.app.ActionBar.TabListener {

private Context context;

public HeaderTabListener(Context context){
    this.context = context; 
}

@Override
public void onTabSelected(com.actionbarsherlock.app.ActionBar.Tab tab, android.support.v4.app.FragmentTransaction ft) {
    int i=((Integer)tab.getTag()).intValue();
    if(tab.getPosition()==0){
        ft.replace(android.R.id.content, CompanyFragment.newInstance(i));
    }else if(tab.getPosition()==1){

        ft.replace(android.R.id.content, PortfolioFragment.newInstance(i));
    }
}

@Override
public void onTabUnselected(com.actionbarsherlock.app.ActionBar.Tab tab, android.support.v4.app.FragmentTransaction ft) {
    Log.v("Tab selected", tab.getText().toString());

}

@Override
public void onTabReselected(com.actionbarsherlock.app.ActionBar.Tab tab, android.support.v4.app.FragmentTransaction ft) {
    Log.v("Tab selected2", tab.getText().toString());
}

} 
```

最后是其中一个片段（两个片段相同，但每个布局中的文本不同）

```
public class PortfolioFragment extends SherlockFragment {
  private static final String KEY_POSITION="position";
  private static final String KEY_TEXT="text";

  static PortfolioFragment newInstance(int position) {
    PortfolioFragment frag=new PortfolioFragment();
    Bundle args=new Bundle();

    args.putInt(KEY_POSITION, position);

    frag.setArguments(args);

    return(frag);
  }

  @Override
  public View onCreateView(LayoutInflater inflater,
                           ViewGroup container,
                           Bundle savedInstanceState) {
    View result=inflater.inflate(R.layout.fragment_portfolio, container, false);

    int position=getArguments().getInt(KEY_POSITION, -1);
    return(result);
  }
} 
```

因此，当它第一次加载选项卡时，所有选项卡都正确显示，第一个选项卡突出显示并显示 CompanyFragment 布局中的文本。但是后来我无法单击任何其他选项卡来更改内容，并且我在 onTabSelected 中的日志永远不会被调用。有什么想法吗？谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T12:56:04.203

首先，让我告诉你，我没有使用 ActionBarSherlock 的经验。我查看了您的代码以获取有关我的应用程序的一些想法。自从您几个月前发布以来，由于没有人回答，我想分享我的第一印象。

据我所知，ActionBarSherlock 公开了与最新的 Android API 相同的功能。因此，我确实认为您缺少一个简单的方法调用。替换片段后，您需要调用`commit()`（[Android 开发人员指南参考）。](http://developer.android.com/reference/android/app/FragmentTransaction.html#commit%28%29)因此，更改行，以及所有类似的行；

`ft.replace(android.R.id.content, PortfolioFragment.newInstance(i));` 到 `ft.replace(android.R.id.content, PortfolioFragment.newInstance(i)).commit();`.

我希望这能解决您的问题，尽管我确实意识到您声明永远不会调用 ònTabSelected() 方法。然而，如果不调试，问题之间的差异似乎是透明的。

# windows - 如何以编程方式设置拨号连接

> ID：12591146
> 
> 赞同：0
> 
> 时间：2012-09-25T21:12:47.003
> 
> 标签：windows, networking, regedit

我有一个问题 - 有没有办法为某个拨号连接设置登录名和密码？我能够创建拨号连接，但是我无法“保存”密码并登录到 Windows（因此它会记住它们）。

请注意，我想在没有 Windows GUI 的情况下执行此操作，理想情况下只使用 regedit/cmd 或 windows 默认工具（可以从 cmd 执行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T12:02:57.910

我需要为 Windows CE 执行此操作，因此我使用远程注册表编辑器在添加拨号连接之前和之后进行比较。我在 [HKEY_CURRENT_USER\Comm\RasBook\ConnectionAddedByMe] 中找到了设置，希望您可以在本地执行相同的操作。

# vbscript - 如何在if语句中添加多个命令

> ID：12591147
> 
> 赞同：0
> 
> 时间：2012-09-25T21:12:57.780
> 
> 标签：vbscript, secure-crt

我的目标是检查开关是否提示“>”或“#”，如果提示“>”发送启用密码，然后发送命令。如果切换提示符为“#”，则只发送命令。但是由于某种原因直接进入命令而不检查条件。

```
 `  result = crt.Screen.WaitForString ([">","#"])
                If (result=1) Then  
                crt.Screen.Send chr(13)
                crt.Screen.Send "XXXXX" & chr(13)
                crt.Screen.WaitForString "Password: "
                crt.Screen.Send "a" & chr(13)
                crt.Screen.WaitForString "#"
                End If
               '++++++++++Now Send the command ++++++++++
         crt.Screen.Send "sh ver" & chr(13)
         crt.Screen.WaitForString vbcr
             strReadScreen = crt.Screen.ReadString("#")` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:25:12.333

即使检查了条件，它也可能会失败，但始终会执行该命令。首先尝试检查'>"，然后制作你的特殊东西......然后检查两者并调用命令

```
if(==">"){
 // do stuff here
}
if(=="#" || ==">"){
 // send command
} 
```

">" 和 "#" 在您的代码中意味着 result==1 或 result==2。

# java - 在 joda time 中创建自定义日历

> ID：12591151
> 
> 赞同：1
> 
> 时间：2012-09-25T21:13:22.323
> 
> 标签：java, date, datetime, jodatime

我需要能够创建可以省略我从日期集中指定的某些假期的自定义日历。例如，我可能需要创建一个以日期为键的地图，但只想遍历省略某些假期的日期。一个例子是，我想查看德国政府建筑物在某一天使用了多少千瓦时的电量，但忽略了节假日。我考虑过使用`joda-time`这个，考虑到我可能有一个像 键控的地图`<DateTime, Double>`，但我不确定这是否可行。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:24:17.240

您在“商业日历”的意义上使用日历这个词，而不是在`java.util.Calendar`Joda 或 Joda`Chronology`能理解的意义上。`Intervals`基本上，您的“日历”是从 Joda中选择一组 Joda 的规则的应用`Chronology`。

我相信您会发现，与其尝试在 Joda 之上构建另一个业务日历系统，不如使用[ObjectLabKit](http://objectlabkit.sourceforge.net/)更好，它是一个支持业务日历的业务库，包括假期规则等。

希望规则将支持您所在地区的所有*场景*。有时，不同的位置在实际使用半通用库时并没有共享足够多的相同时间假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:35:11.960

手动检查是假日

```
private static final List<LocalDate> HOLIDAYS = Arrays.asList(new LocalDate[]{
   new LocalDate(2000, DateTimeConstants.JANUARY, 1),
   new LocalDate(2000, DateTimeConstants.JANUARY, 7),
   new LocalDate(2000, DateTimeConstants.JANUARY, 14),
   new LocalDate(2000, DateTimeConstants.JANUARY, 28),
   /* ... */
   new LocalDate(2000, DateTimeConstants.DECEMBER, 25),
});

public static boolean isHoliday(LocalDate checkedDate)
{
    for (final LocalDate date : HOLIDAYS)
    {
        if(date.getMonthOfYear() == checkedDate.getMonthOfYear()
                && date.getDayOfMonth() == checkedDate.getDayOfMonth())
        {
            return true;
        }
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T01:31:33.950

正如@EdwinBuck 所说，您的术语令人困惑，使人们难以理解您的问题。

我不知道你为什么想要一个 Map ？有什么价值？

如果您正在寻找一些查询来了解某天是否是假期，那么使用 Set 可能更有意义。（我之前没有用过Joda date time，只是在这里写一些明智的东西）

例如

```
Set<DateTime> holidays = new HashSet<DateTime>();
holidays.add(....);
// add all holidays to the set

// if you need to check if certain day is holiday so you can skip it:
if (!holidays.contains(someDay)) {
  // it is not a holiday
  // do anything you need
} 
```

# php - 试图在 Symfony2 中将我的控制器定义为服务——参数永远不会传递给构造函数

> ID：12591153
> 
> 赞同：6
> 
> 时间：2012-09-25T21:13:21.977
> 
> 标签：php, symfony

所以，这是我刚刚构建的控制器：

```
namespace MDP\API\ImageBundle\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\JsonResponse;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;

class RetrieverController {

    private $jsonResponse;

    private $request;

    public function __construct(JsonResponse $jsonResponse, Request $request) {
        $this->jsonResponse = $jsonResponse;
        $this->request = $request;
    }

    /**
     * @Route("/image/{amount}")
     * @Template("MDPAPIImageBundle:Retriever:index.json.twig")
     */
    public function retrieve($amount)
    {
    }
} 
```

我想让这个控制器作为服务工作，使用 DependencyInjection。所以，这是我的`services.xml`文件：

```
<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <service id="mdpapi_image.json_response" class="Symfony\Component\HttpFoundation\JsonResponse" />
        <service id="mdpapi_image.request" class="Symfony\Component\HttpFoundation\Request" />
        <service id="mdpapi_image.controller.retriever" class="MDP\API\ImageBundle\Controller\RetrieverController">
            <argument type="service" id="mdpapi_image.json_response" />
            <argument type="service" id="mdpapi_image.request" />
        </service>
    </services>
</container> 
```

但是，当我尝试执行我的控制器时，我总是得到这个异常：

**可捕获的致命错误：传递给 MDP\API\ImageBundle\Controller\RetrieverController::__construct() 的参数 1 必须是 Symfony\Component\HttpFoundation\JsonResponse 的实例，没有给出，在 /home/steve/projects/APIs/app 中调用/cache/dev/jms_diextra/controller_injectors/MDPAPIImageBundleControllerRetrieverController.php 在第 13 行并在 /home/steve/projects/ImageAPI/ImageBundle/Controller/RetrieverController.php 第 13 行定义**

当我处于开发模式时，我看到 Symfony 在缓存文件中生成了这个文件......

```
class RetrieverController__JMSInjector
{
    public static function inject($container) {
        $instance = new \MDP\API\ImageBundle\Controller\RetrieverController();
        return $instance;
    }
} 
```

我怎样才能使参数正确地添加到控制器中，就像在我的`services.xml`文件中指定的那样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T07:06:57.843

刚刚找到您问题的答案，希望这对您（或其他发现此问题的人）有所帮助

```
<?php
namespace MDP\API\ImageBundle\Controller;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\JsonResponse;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;

/**
* @Route("/image", service="mdpapi_image.controller.retriever")
*/
class RetrieverController {

    private $jsonResponse;

    private $request;

    public function __construct(JsonResponse $jsonResponse, Request $request) {
        $this->jsonResponse = $jsonResponse;
        $this->request = $request;
    }

    /**
     * @Route("/{amount}")
     * @Template("MDPAPIImageBundle:Retriever:index.json.twig")
     */
    public function retrieve($amount)
    {
    }
} 
```

资料来源：

[http://richardmiller.co.uk/2011/10/25/symfony2-routing-to-controller-as-service-with-annotations/](http://richardmiller.co.uk/2011/10/25/symfony2-routing-to-controller-as-service-with-annotations/)

[http://symfony.com/doc/current/cookbook/controller/service.html](http://symfony.com/doc/current/cookbook/controller/service.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T16:43:50.070

所以，我解决了我的问题。我不得不停止在我的控制器中使用注释并更改了我的 routing.yml 所以直接编写路由。

```
image_retrieve:
    pattern:   /image/{amount}
    defaults:  { _controller: mdp_api_image_retriever_retrieve:retrieve }
    requirements:
      _method:  GET 
```

这解决了整个问题。注释的问题在于，在第 90 行的此类 (JMS\DiExtraBundle\HttpKernel\ControllerResolver) 上，在 Symfony 核心中，您会看到以下核心：

```
// If the cache warmer tries to warm up a service controller that uses
// annotations, we need to bail out as this is handled by the service
// container directly.
if (null !== $metadata->getOutsideClassMetadata()->id
                && 0 !== strpos($metadata->getOutsideClassMetadata()->id, '_jms_di_extra.unnamed.service')) {
            return;
} 
```

然后在第 69 行，它尝试从返回的数据中调用方法 call_user_func，该数据为空。

换句话说，使用注解和创建你的控制器即服务不能一起工作。我在调试这个问题上浪费了 4 个小时，所以我希望这对将来的人有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T06:04:17.823

好像您忘记编写加载文件[的](http://symfony.com/doc/current/cookbook/bundles/extension.html#using-the-load-method)扩展[类：](http://symfony.com/doc/current/cookbook/bundles/extension.html#creating-an-extension-class)`services.xml`

```
namespace MDP\API\ImageBundle\DependencyInjection;

use Symfony\Component\HttpKernel\DependencyInjection\Extension;
use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\DependencyInjection\Loader\XmlFileLoader;
use Symfony\Component\Config\FileLocator;

class ImageExtension extends Extension
{
    /**
     * @param array $configs
     * @param \Symfony\Component\DependencyInjection\ContainerBuilder $container
     */
    public function load(array $configs, ContainerBuilder $container)
    {
        $loader = new XmlFileLoader(
            $container, 
            new FileLocator(__DIR__.'/../Resources/config')
        );

        $loader->load('services.xml');
    }
} 
```

# jquery - 在 jQuery 验证的 submitHandler 中检测提交按钮

> ID：12591156
> 
> 赞同：1
> 
> 时间：2012-09-25T21:14:08.447
> 
> 标签：jquery, jquery-validate

我有一个需要一些验证后警告的表单。这个概念很简单，这些值是允许的，但超出了正常范围。处理这种情况的方式是在验证 submitHandler 中：

```
$('form').validate({
    highlight: function (element, errorClass) {$(element).addClass("invalidElem");},
    unhighlight: function (element, errorClass) {$(element).removeClass("invalidElem");},
    errorPlacement: function (error, element) {element.parent().parent().next().children().last().append(error);},
    errorClass: "errorMsg",

    submitHandler: function (form) {

        if (!WeightsRangeValidator("Height", txtHeight, heightWarning)) {
            return false;
        }

        if (!WeightsRangeValidator("Weight", txtWeight, weightWarning)) {
            return false;
        }

        form.submit();
    }        
}); 
```

问题是表单上有提交和取消按钮。取消按钮确实具有“取消”类，因此不会执行验证。不过，submitHandler 函数仍在被调用。我假设必须有一种方法来检测正在单击哪个提交按钮以绕过 submitHandler 处理程序的内容。

* * *

这是一个工作的 jsFiddler：http: [//jsfiddle.net/scarleton/ZSVFP/](http://jsfiddle.net/scarleton/ZSVFP/)

表单有三种有效状态：复选框（但不是两者）或文本框和下拉列表。单击“确定”时验证有效。问题出现在取消上。如果您在文本框中输入任何内容并按取消，验证仍会尝试验证。我尝试添加以下处理程序，如果表单有效，它允许取消，但如果在文本框中输入字母则不允许。

```
btnCancel.click(function () {
    txtHeight.rules("remove");
    txtWeight.rules("remove");
    ddlDevice.rules("remove");
    $("#form").submit();
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:20:13.627

```
$('.submitBtn').on('click', function(){
    var $frm =  $ ("#form");
    $frm.validate()
    if($frm).valid()){
       submitHandler();
     $frm.submit()
    }
})

$('.cancel').on('click', function(){
   var $frm =  $ ("#form");
   if($frm.valid()){
    // Do Some action ...;
   }
}) 
```

***或者*** 您可以在buttonsm上添加点击事件，并且每次根据clikcef的按钮更改参数，有关更多详细信息，请参见示例[DEMO] [1]

请参阅 jquery 文档[http://docs.jquery.com/Plugins/Validation[1]：http://jsfiddle.net/abaksheyev/jKuVa/1/](http://jsfiddle.net/abaksheyev/jKuVa/1/)

***还有更聪明的方法***

```
submitHandler: function (form) {
      var val = $("input[type=submit][clicked=true]").val() // add this line to handler
  .......

//Add this into document.ready 
$("form input[type=submit]").click(function() {
    $("input[type=submit]", $(this).parents("form")).removeAttr("clicked");
    $(this).attr("clicked", "true");
}); 
```

# c# - 如何在 Windows 8 的后台更新我的磁贴？

> ID：12591158
> 
> 赞同：1
> 
> 时间：2012-09-25T21:14:18.743
> 
> 标签：c#, xaml, microsoft-metro

当我的应用程序不在前台运行时，如何在后台更新我的磁贴？我尝试查看推送通知，但我认为这不会让我到任何地方。

从哪里开始？我已经知道如何创建瓷砖了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T01:47:33.823

应用程序必须至少运行一次才能更新其磁贴。由于应用程序不会在安装时立即运行，因此磁贴在启动之前不可能“活动”。安装应用程序后，用户需要启动应用程序以设置并开始接收任何形式的更新（无论是推送通知、定期更新、计划通知，还是在有或没有后台任务的情况下发出的本地通知）。默认磁贴将从用户安装应用程序的那一刻开始显示，直到应用程序设置磁贴更新为止。

MSDN 有一篇关于选择正确的通知传递机制的好文章，其中还链接了相关的代码示例：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh779721.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh779721.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:36:58.500

您必须使用命名空间中`TileNotification`的a `Windows.UI.Notifications`。命名空间的文档在[这里](http://msdn.microsoft.com/en-us/library/windows/apps/br208661.aspx)。

[这里](http://msdn.microsoft.com/en-US/library/windows/apps/hh868190)还有一个使用通知的示例股票应用程序（搜索“磁贴和通知”）

此外，还有一个“[应用程序磁贴和徽章](http://code.msdn.microsoft.com/windowsapps/App-tiles-and-badges-sample-5fc49148)”示例，它显示了对动态磁贴的文本和图像更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T21:40:18.607

据我所知，您必须使用后台任务。如果用户没有运行过一次应用程序，您将无法显示任何交互式磁贴数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:33:45.920

使用 c# 代码将动态磁贴添加到桌面：

```
List<Uri> StoryUrls = new List<Uri>();
        StoryUrls .Add(new Uri("tiles.xml"));

        TileUpdateManager.CreateTileUpdaterForApplication().EnableNotificationQueue(true);
        TileUpdateManager.CreateTileUpdaterForApplication().Clear();
        TileUpdateManager.CreateTileUpdaterForApplication().StartPeriodicUpdateBatch(StoryUrls, PeriodicUpdateRecurrence.HalfHour); 
```

xml 应采用以下格式：

*   tiles.xml 应该遵循步骤 5 中显示的 microsoft 格式[这里](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh868253%28v=win.10%29.aspx#supply_an_image_for_your_notification)

希望这可以帮助

# security - 开源项目中的 Google 域验证

> ID：12591160
> 
> 赞同：0
> 
> 时间：2012-09-25T21:14:23.553
> 
> 标签：security, google-apps

将 google 域验证 html 文件签入开源项目是否存在任何安全问题？该站点托管在 heroku 上，所有源代码都可以在 github 上免费获得，以造福社区。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:41:05.043

就 Google 验证 HTML 文件的安全性而言，没有什么可担心的。这只是他们生成的一个散列，对他们来说只有一个意义。它不能用于查找有关您的网站或 Google 帐户的任何其他信息。

# javascript - 第二次点击时，knockout.js 和 observableArray 不更新 DOM

> ID：12591164
> 
> 赞同：2
> 
> 时间：2012-09-25T21:14:42.753
> 
> 标签：javascript, knockout.js, ko.observablearray

我已经查看了很多以前的答案，并尝试了几件事，但我没有做任何事情让我在第二次尝试 applyBindings 时更新我的​​ DOM。

看看下面的小提琴，它演示了这个问题。

[http://jsfiddle.net/rARfx/4/](http://jsfiddle.net/rARfx/4/)

当我通过 $.getJSON() IRL 提取数据时，小提琴仍然重现了我摆弄的内联 JSON 和那里的代码的问题。

我尝试过的东西都被注释掉了（will/hasMutated、replace、removeAll）。

我希望完成的是，我的图 X（Usher）的五个新闻项目的元素将被更新/替换为图 Y（罗韩）的五个新闻项目，但如果我什至可以的话，这将是一个进步的迹象获取附加到 0-4 的元素 5-9 并查看 10 li 标签。

要重现该问题，请运行 fiddle，然后单击“Do It Again”链接以模拟 JSON 加载，并注意它不会显示新的数据元素，而是生成一个没有子元素的空白 ul 标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:29:26.760

您不应该将同一个对象绑定到多个模型。相反，只需使用新信息更新模型，更改就会反映在视图中。

我已经改变了代码来做到这一点：http: [//jsfiddle.net/rARfx/5/](http://jsfiddle.net/rARfx/5/)

# grails - 如何使 _Events.groovy 中的“战争”构建失败？

> ID：12591166
> 
> 赞同：2
> 
> 时间：2012-09-25T21:14:52.627
> 
> 标签：grails, war

`_Events.groovy`在某些情况下，我想在我的 eventListener 闭包中使构建失败。

我尝试了两种方法：

1.  扔一个`RuntimeException()`
2.  称呼`ant.fail('failing the build')`

我在控制台中得到以下输出：

```
 | Building WAR file.....
    running event listener code...
    [ERROR] Invalid environment argument of: 'tingaeuaeou', must be either 'testing', 'package', 'production' or 'native'
    | Error Exception occurred trigger event [CreateWarStart]: Sencha SDK optimization failed. (Use --stacktrace to see the full trace)
    | Done creating WAR target/product-selector-0.1.war
    grails> 
```

这是我为尝试使构建失败而编写的代码：

```
 ...
    ant.exec(outputproperty: "cmdOut", executable: 'sencha',
            dir: "$stagingDir", failOnError: true) {
        arg(value: 'app')
        arg(value: 'build')
        arg(value: "-e $senchaEnvironment")
    }

    def commandOutput = ant.project.properties.cmdOut

    println "${commandOutput}"

    if(commandOutput.contains('ERROR')){
        ant.fail(message:"Sencha SDK optimization failed.",status:1)
    }
            ... 
```

问题是war脚本一直在运行，生成一个会损坏的war文件，而且我认为我的构建过程不会报告发生异常；我的持续集成构建将报告错误的成功！

有任何想法吗？

# android - Android 找不到应用程序图标

> ID：12591167
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:14:59.373
> 
> 标签：android, android-emulator

我在 eclipse 上创建了一个 Android 应用程序，当我想在模拟器上运行它时，我收到消息说

> MyApplicationName.apk 安装在设备上

所以通常一切都很好。

但是当我想启动我的应用程序时，我没有找到它的图标。当我去那里`parametres` 时，我会`manage applications`在那里找到它。

谁能告诉我为什么我无法在模拟器上找到应用程序的图标？

这是清单

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.enis.testandroid"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="MainActivity" />
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T04:28:41.920

您错过了在清单文件中添加启动器，

```
<application
    android:icon="@drawable/download" <!-- Check this one -->
    android:label="@string/app_name" >
    <activity
        android:name=".abc"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" /> <!-- Check this one -->
        </intent-filter>
    </activity>
    <activity android:name="abc" >
    </activity>
    <activity android:name="def" >
    </activity>
</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:37:59.267

```
<application
        android:name="com.x.y.z"
        android:icon="@drawable/ic_launcher"
        android:label="@android:string/abc" > 
```

在清单中，根据您的可绘制文件夹图标进行更改。还要确保使用小案例进行绘制。

# php - 使用 wordpress wp_get_sidebars_widgets() 时出现 foreach() 错误

> ID：12591173
> 
> 赞同：1
> 
> 时间：2012-09-25T21:15:27.247
> 
> 标签：php, wordpress, foreach

```
function getWidgets($position = null) {
    if (empty($this->widgets)) {
        foreach (wp_get_sidebars_widgets() as $pos => $ids) {
            $this->widgets[$pos] = array();
            foreach ($ids as $id) {                  // error is here
                $this->widgets[$pos][$id] = $this->getWidget($id);
            }
        }
    }
} 
```

这些是第 305-314 行。

我收到此错误：

```
" Warning: Invalid argument supplied for foreach() in /home/content/73/9889573/html/wp-content/themes/yoo_spark_wp/warp/systems/wordpress.3.0/helpers/system.php on line 310 " 
```

有人可以告诉我如何解决它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:20:13.363

`wp_get_sidebars_widgets()`返回一维数组。

**参考**：[http ://codex.wordpress.org/Function_Reference/wp_get_sidebars_widgets](http://codex.wordpress.org/Function_Reference/wp_get_sidebars_widgets)

`$ids`不是数组。你不能`foreach`循环遍历它。

尝试这个：

```
$widgets = array();
foreach (wp_get_sidebars_widgets() as $pos => $id) {
    $widgets[$pos] = $this->getWidget($id);
} 
```

# maven - 杀死特定标签的 Javadoc 警告

> ID：12591175
> 
> 赞同：14
> 
> 时间：2012-09-25T21:15:36.190
> 
> 标签：maven, javadoc

在使用 Maven 构建时，是否有一种简单的方法/选项可以防止 javadoc 警告？我们为 Eclipse 使用了 soyatec uml 插件，它插入了特殊的标签，这使得我们的构建会抛出很多烦人的警告；我环顾四周，包括在 soyatec 网站上，结果都是空的。

```
@uml.property 是未知标签

```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-26T07:07:55.897

我能找到的唯一答案是[配置自定义 Javadoc 标签](http://maven.apache.org/plugins/maven-javadoc-plugin/examples/tag-configuration.html)。

一个例子可能是这样的：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-javadoc-plugin</artifactId>
            <version>2.8.1</version>
            <configuration>
                <tags>
                    <tag>
                        <name>uml.property</name>
                        <!-- The value X makes javadoc ignoring the tag -->
                        <placement>X</placement>
                    </tag>
                    <tag>
                        <name>some.other.property</name>
                        <placement>X</placement>
                    </tag>
                    <tag>
                        <name>some.third.property</name>
                        <placement>X</placement>
                    </tag>
                </tags>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

运行时，您将在输出中看到：

```
mvn javadoc:javadoc

<lots of output>
Note: Custom tags that were not seen:  @uml.property
<maybe more output> 
```

您可以使用以下命令禁用非错误和非警告消息：

```
mvn javadoc:javadoc -Dquiet 
```

* * *

定义所有这些标签可能是一项艰巨的工作，但一旦完成，您将不再看到警告。

您可能应该在父 pom 中定义这些自定义标签，每个人都可以使用它来使所有工作受益。

# firefox - 无法在 Firefox 的表格中绝对定位元素

> ID：12591177
> 
> 赞同：1
> 
> 时间：2012-09-25T21:15:45.520
> 
> 标签：firefox, html-table, css-position

我有一张表，里面有绝对positioneg 段落`<p>`。它在 Chrome 和 Opera 中呈现我想要的效果，但在 Firefox 中，所有数字都在表格之外并挤在一起。我尝试添加`position: relative;`到所有父元素，但没有太大帮助。问题出在哪里？我想这很简单。

就是这样：http: [//i50.tinypic.com/34diewz.png](http://i50.tinypic.com/34diewz.png)（我是新用户，还不能上传图片）

这些`<p>`'s 也必须是绝对的，因为在整个项目的表格单元格中还有其他元素 - 此代码只是一小部分。这里是：

```
<!DOCTYPE html>
<html>
   <head>
      <style>
         * { margin: 0; padding: 0; } /* Just a quick reset, I use proper one in full project */

         table {
            background-color: #296B73;
         }

         td {
            position: relative;
            height: 40px; width: 40px;
            border: 1px solid #0F2D40;
         }

         p {
            position: absolute;
            top: 28%; left: 50%;
            margin-left: -5px;
         }

         td:nth-child(1) { width: 50px; }
         td:nth-child(2) { width: 75px; }
         td:nth-child(3) { width: 100px; }
      </style>
   </head>
   <body>
      <table>
         <tr>
            <td><p>1</p></td>
            <td><p>2</p></td>
            <td><p>3</p></td>
         </tr>
         <tr>
            <td><p>1</p></td>
            <td><p>2</p></td>
            <td><p>3</p></td>
         </tr>
         <tr>
            <td><p>1</p></td>
            <td><p>2</p></td>
            <td><p>3</p></td>
         </tr>
      </table>
   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:03:15.343

您不能相对定位 TD，因此您需要为 P 放置一个周围的容器：

```
<td><div><p>1</p></div></td>
<td><div><p>2</p></div></td>
<td><div><p>3</p></div></td> 
```

然后在 CSS 中：

```
td div { position: relative } 
```

# objective-c - 基于 Xcode 页面的应用程序界面轮换问题

> ID：12591180
> 
> 赞同：1
> 
> 时间：2012-09-25T21:16:40.790
> 
> 标签：objective-c, ios, xcode, uipageviewcontroller

1.  在 Xcode 中启动一个新的基于页面的应用程序项目
2.  运行项目并翻几页
3.  旋转模拟器或设备
4.  => 页面视图控制器切换回第一页（一月）

如何防止第 4 步。

编辑：这仅在您在模拟器/设备中启动应用程序后第一次旋转时发生。我在我的测试设备上使用带有 iOS 6.0 模拟器和 iOS 6 的最新 Xcode 4.5。当我从博客/等下载一些其他示例代码时，也会发生同样的事情。也许是 iOS 6 错误？

EDIT2：我发现传递给 UIPageViewController 的第一个页面视图在第一次旋转之前不会被释放。这对我来说真的像一个错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T17:39:08.100

（2014 年更新：如果您从新的 Page View 应用程序模板重新开始，这似乎已在 iOS7 中修复。）

我也遇到过这个错误。它似乎在主视图重新出现后随时启动。我的应用程序中有几个全屏模式，在这些模式消失后会发生相同的行为。

这发生在 XCode 4.5.1 和 iOS6 中——我通过重新下载 XCode 4.4 并将我的应用程序恢复到 iOS5.1 来“修复”这个问题。显然不是一个很好的长期解决方案。我在 Radar 中提交了这个文件，并收到了一个通知，它已经被记录了。

FWIW 我注意到 iBooks 在 iOS6 发布后也有同样的错误，但他们似乎在最近的更新中修复了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T17:56:27.303

这是我设法在我的应用程序中解决此问题的方法。恐怕这是一种 hacky 解决方案，但它是一个古怪的错误。

上下文：我的应用程序是一本日记（称为 Remembary），每一页都是不同日期的日记条目。我有一个名为“AppContext”的单例类，它跟踪各种应用级别的值，例如当前显示的日记条目对象、当前日期等。每天的 dataViewController 也会跟踪它自己的日记条目。

最棘手的部分是找到一个上下文，我可以在其中发现应用程序显示了错误的页面。原来这是在 [RootViewController viewDidLayoutSubviews] 中，所以我在该方法中添加了以下内容：

```
// get the currently displaying page
DataViewController *currentPage = self.pageViewController.viewControllers[0];
// check if we're showing the wrong page
if ([currentPage myEntry] != [AppContext getCurrentEntry]) {        
    // jump to the proper page (the delay is needed to ensure that the rotation has fully completed)
    [self performSelector:@selector(forceJumpToDate:) 
               withObject:[AppContext getCurrentEntryDate] 
               afterDelay:0.5];
} 
```

下面是 forceJumpToDate 函数，它基本上根据当前日期获取一个新页面，并告诉 pageViewController 在没有动画的情况下跳转到它：

```
- (void) forceJumpToDate:(NSDate *)targetDate {
    DataViewController *targetPage = [self.modelController viewControllerForDate:targetDate 
                                                                      storyboard:self.storyboard];
    NSArray *viewControllers = [NSArray arrayWithObject:targetPage];
    [self.pageViewController setViewControllers:viewControllers 
                                      direction:UIPageViewControllerNavigationDirectionForward 
                                       animated:NO 
                                     completion:NULL];
} 
```

当新页面被强制就位时，用户可能会注意到屏幕上出现短暂的打嗝，但这只有在他们会得到错误页面的情况下才会发生，所以它仍然是一个改进。

这严重干扰了我将应用程序升级到 iOS6 的能力，所以我很高兴我终于弄明白了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T18:49:02.087

这是我的解决方案：

* * *

```
//  RootViewController.m

#import "RootViewController.h"

#import "ModelController.h"

#import "DataViewController.h"

@interface RootViewController ()
@property (readonly, strong, nonatomic) ModelController *modelController;

//added
@property (strong, nonatomic) DataViewController *currentViewController;
@end

@implementation RootViewController

@synthesize modelController = _modelController;

//added
@synthesize currentViewController = _currentViewController;

- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
    // Configure the page view controller and add it as a child view controller.
    self.pageViewController = [[UIPageViewController alloc] initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl navigationOrientation:UIPageViewControllerNavigationOrientationHorizontal options:nil];
    self.pageViewController.delegate = self;

    DataViewController *startingViewController = [self.modelController viewControllerAtIndex:0 storyboard:self.storyboard];
    NSArray *viewControllers = @[startingViewController];
    [self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:NO completion:NULL];

    self.pageViewController.dataSource = self.modelController;

    [self addChildViewController:self.pageViewController];
    [self.view addSubview:self.pageViewController.view];

    // Set the page view controller's bounds using an inset rect so that self's view is visible around the edges of the pages.
    CGRect pageViewRect = self.view.bounds;
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
        pageViewRect = CGRectInset(pageViewRect, 40.0, 40.0);
    }
    self.pageViewController.view.frame = pageViewRect;

    [self.pageViewController didMoveToParentViewController:self];

    // Add the page view controller's gesture recognizers to the book view controller's view so that the gestures are started more easily.
    self.view.gestureRecognizers = self.pageViewController.gestureRecognizers;

    //added
    self.currentViewController = self.pageViewController.viewControllers[0];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (ModelController *)modelController
{
     // Return the model controller object, creating it if necessary.
     // In more complex implementations, the model controller may be passed to the view controller.
    if (!_modelController) {
        _modelController = [[ModelController alloc] init];
    }
    return _modelController;
}

#pragma mark - UIPageViewController delegate methods

/*
- (void)pageViewController:(UIPageViewController *)pageViewController didFinishAnimating:(BOOL)finished previousViewControllers:(NSArray *)previousViewControllers transitionCompleted:(BOOL)completed
{

}
 */

//added
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration

{
    self.currentViewController = self.pageViewController.viewControllers[0];

}

- (DataViewController *)currentViewController
{
    if (!_currentViewController) _currentViewController = [[DataViewController alloc] init];
    return _currentViewController;
}

- (UIPageViewControllerSpineLocation)pageViewController:(UIPageViewController *)pageViewController spineLocationForInterfaceOrientation:(UIInterfaceOrientation)orientation
{
    if (UIInterfaceOrientationIsPortrait(orientation) || ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)) {
        // In portrait orientation or on iPhone: Set the spine position to "min" and the page view controller's view controllers array to contain just one view controller. Setting the spine position to 'UIPageViewControllerSpineLocationMid' in landscape orientation sets the doubleSided property to YES, so set it to NO here.

        //deleted: UIViewController *currentViewController = self.pageViewController.viewControllers[0];
        //changed to self.currentViewController
        NSArray *viewControllers = @[self.currentViewController];
        [self.pageViewController setViewControllers:viewControllers
                                          direction:UIPageViewControllerNavigationDirectionForward
                                          animated:YES
                                          completion:NULL];

        self.pageViewController.doubleSided = NO;
        return UIPageViewControllerSpineLocationMin;
    }

    // In landscape orientation: Set set the spine location to "mid" and the page view controller's view controllers array to contain two view controllers. If the current page is even, set it to contain the current and next view controllers; if it is odd, set the array to contain the previous and current view controllers.
   // deleted:  DataViewController *currentViewController = self.pageViewController.viewControllers[0];
   //deleted: NSArray *viewControllers = nil;
    //added
     NSArray *viewControllers = @[self.currentViewController];

   //changed currentViewController to self.currentViewController
    NSUInteger indexOfCurrentViewController = [self.modelController indexOfViewController:self.currentViewController];

    if (indexOfCurrentViewController == 0 || indexOfCurrentViewController % 2 == 0) {
        UIViewController *nextViewController = [self.modelController pageViewController:self.pageViewController viewControllerAfterViewController:self.currentViewController];
        viewControllers = @[self.currentViewController, nextViewController];
    } else {
        UIViewController *previousViewController = [self.modelController pageViewController:self.pageViewController viewControllerBeforeViewController:self.currentViewController];
        viewControllers = @[previousViewController, self.currentViewController];
    }
    [self.pageViewController setViewControllers:viewControllers direction:UIPageViewControllerNavigationDirectionForward animated:YES completion:NULL];

    return UIPageViewControllerSpineLocationMid;
}

@end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T16:45:38.477

今天我发现在我的应用程序中我可以使用以下内容来删除错误（但我不知道为什么）。

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
        ...
         self.pageViewController.view.hidden = YES;
    }

-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
        self.pageViewController.view.hidden = NO;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-25T22:28:52.297

What is it you want to prevent? Do you want to prevent rotation? If that is what you want, modify the shouldAutorotateToInterfaceOrientation return value in the RootViewController.m implementation file.

When I did this, the App was able to keep the same page (month) even after rotating the device. I used the simulator and tried on both iPhone and iPad. On the iPad, in landscape mode, it showed two months at a time, but then when rotated back to portrait, still kept the first of the two months that was displayed. This was when I incremented to June. I used the default project without changing a line of code.

# php - 我的正则表达式函数有什么问题？

> ID：12591182
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:16:59.787
> 
> 标签：php, regex

这似乎是一件很简单的事情。无论如何，在我的代码底部是一个使用函数结果的数组。现在它似乎不起作用，我认为这可能是我扫描元关键字的正则表达式。所以基本上，我想知道我的函数做错了什么或者如何创建一个完整的正则表达式代码

```
function getKeywords($link) {
$str2 = file_get_contents($link);    
if (strlen($str2)>0) {
    preg_match_all( '(?i)<meta\\s+name=\"keywords\"\\s+content=\"(.*?)\">', $str2, $keywords);
  return $keywords[1];
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:19:14.590

试试这个：

```
function getKeywords($link) {
    $str2 = file_get_contents($link);    
    if (strlen($str2)>0) {
        if(preg_match( '/<meta\s+name="keywords"\s+content="(.*?)">/i', $str2, $keywords))
            return $keywords[1];
        else
            return "";

    }
} 
```

您的表达有多个问题：

1）。对于 \s 和 \" 的许多转义字符

2）。你没有以 / 开头并以 / 结尾

3）。您使用的是 preg_match_all 而不是 preg_match

4）。您没有处理找不到关键字元标记的情况。

# python - 动态命名指向类的变量

> ID：12591184
> 
> 赞同：1
> 
> 时间：2012-09-25T21:17:09.480
> 
> 标签：python

所以我有一个“触发器”的 .txt 列表。我想要做的是访问这个触发器列表，确定触发器名称，然后使用该名称指向我拥有的类的新实例，调用它`WordTrigger`。我不知道我会怎么做。如果我知道变量，我可以简单地将类分配给一个变量`var = WordTrigger(parameters)`。但问题的整个前提是我不知道变量，必须通过扫描列表找出它们的名称。我意识到我可以`name`为我的类创建一个属性`WordTrigger`，但这仍然留下了我将为类实例分配哪些变量的问题，因为理论上，我什至不知道触发器列表有多长，所以我不能只创建静态数量的变量。

有没有什么办法，给定一个 x 长的单词表，创建 x 个变量并将它们指向一个类的新实例，该类的名称是从单词表中提取的？我希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:19:58.573

使用字典：

```
dic={word:WordTrigger(parameters) for word in wordlist} 
```

例子：

```
>>> wordlist=['a','b','c','d','e']
>>> class A:
    def __init__(self,i):
        self.ind=i

>>> dic={word:A(i) for i,word in enumerate(wordlist)}
>>> dic['a'].ind
0
>>> dic['c'].ind
2 
```

# jquery - 用户离开页面时淡出 - jquery

> ID：12591187
> 
> 赞同：1
> 
> 时间：2012-09-25T21:17:22.737
> 
> 标签：jquery, fade, fadeout, fadein

一旦用户登陆，我有一些简单的页面过渡会淡入。但是，当用户离开时，我也试图使同一页面淡出。

我找到了一些解决方案，但它们似乎使用了延迟（）。有没有没有的？

感谢您的帮助，（我是新手，请注意！）

汤姆：）

我目前正在使用此代码：

```
 $(document).ready(
    function(){

    $( 'body' ).fadeIn(2000);   

        $('#stop').click(function (e) { 
    e.preventDefault(); });

     $('#clients').click(function() { 
        $("#projectinfo").slideUp('slow');
$("#us").fadeOut('slow');
   $("ul").fadeToggle('slow'); });

   $('#information').click(function() { 
        $("#projectinfo").slideUp('slow');
$("ul").fadeOut('slow');
   $("#us").fadeToggle('slow'); });

     $('#question').click(function() { 
   $("#projectinfo").slideToggle('slow'); });

        $('#question').hover(function() { 
   $("#projectinfo").slideToggle('slow'); });

   $("a").click(function(event){
        event.preventDefault();
        linkLocation = this.href;
        $("body").fadeOut(1000, redirectPage);      
    });

    function redirectPage() {

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:43:38.993

编辑答案：

您将需要完成您的`redirectPage()`功能，如下所示：

```
 $("a").click(function(event){
        event.preventDefault();
        linkLocation = this.href;
        $("body").fadeOut(1000, redirectPage(linkLocation));      
    });

    function redirectPage(link) {
        document.location.href= link;
    } 
```

@sharethis，感谢您指出我的错误。

# c# - 类库主机错误中的webservice

> ID：12591189
> 
> 赞同：0
> 
> 时间：2012-09-25T21:17:30.790
> 
> 标签：c#, web-services

这是我开发 Web 服务的第一个项目。它现有的应用程序。我的项目是classlibrary ..为此我们添加了webservice.svc ..

要查看 webservice wsdl ..有哪些步骤..？如何在 IIS 中发布服务。请任何人都可以建议我..

当我发布网站时，我应该发布为网络部署？

我试图发布为 webdeploy.. 在此之前我在 IIS 中创建网站并尝试发布到 IIS 中的托管站点..发布成功..当我浏览服务时出现错误，这是什么意思..请帮助我..

**在 ServiceHost 指令中作为 Service 属性值提供，或在配置元素 system.serviceModel/serviceHostingEnvironment/serviceActivations 中提供。**

复制了我的网络配置文件..

```
<system.web>
<compilation debug="true" targetFramework="4.0" />
</system.web>
<system.serviceModel>
<behaviors>
  <serviceBehaviors>
    <behavior>
      <serviceMetadata httpGetEnabled="true"/>
              <serviceDebug includeExceptionDetailInFaults="false"/>
    </behavior>
  </serviceBehaviors>
</behaviors>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T13:37:48.727

我解决了我的问题。服务主机服务名称不匹配..我尝试添加测试 WCh 服务并比较 .svc 文件..

已修复并在 IIS 中运行以..

# c# - 有没有办法构造一个 QueryExpression 以便您可以动态处理未知数量的条件

> ID：12591190
> 
> 赞同：1
> 
> 时间：2012-09-25T21:17:38.390
> 
> 标签：c#, linq, dynamics-crm

Microsoft 提供的示例类似于我在下面复制的示例，用于为 QueryExpression 创建多个条件。有没有办法构建 QueryExpression 以便您可以动态处理未知数量的条件？在下面的 Microsoft 示例中，他们使用条件 1、条件 2 等等......我再次想知道是否有一种方法可以创建一个可以处理可变数量条件的更可重用的 QueryExpression。我知道整个事情都可以在 LINQ 中完成，但我特别想确定它是否可以用 QueryExpression 完成。

```
// Create the query expression and set the entity to contact.
QueryExpression query = new QueryExpression();
query.EntityName = "contact";

// Create a condition where the first name equals Joe.
ConditionExpression condition1 = new ConditionExpression();
condition1.AttributeName = "firstname";
condition1.Operator = ConditionOperator.Equal;
condition1.Values = new string[] { "Joe" }; 

// Create another condition where the first name equals John.
ConditionExpression condition2 = new ConditionExpression();
condition2 .AttributeName = "firstname";
condition2 .Operator = ConditionOperator.Equal;
condition2 .Values = new string[] { "John" }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T20:14:25.653

因此，您可以以编程方式构建 QueryExpressions，这可能有助于简化对象创建。我要提出的唯一问题是，您可能会发现您的查询是如此不同，以至于很难创建通用函数来支持它们。

无论如何，这是一个简单的示例，希望可以帮助您入门。

```
 public static QueryExpression BuildQueryExpression(String entityName, ColumnSet columnSet, LogicalOperator logicalOperator, List<ConditionExpression> conditions)
    {
        QueryExpression query = new QueryExpression(entityName);
        query.ColumnSet = columnSet;
        query.Criteria = new FilterExpression(logicalOperator);
        conditions.ForEach(c => query.Criteria.AddCondition(c));
        return query;
    } 
```

**用法：**

```
 QueryExpression query = BuildQueryExpression("contact", new ColumnSet(true), LogicalOperator.And, new List<ConditionExpression>()
        {
            new ConditionExpression("firstname", ConditionOperator.Equal, "James" ),
            new ConditionExpression("lastname", ConditionOperator.Equal, "Wood" ),
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-18T14:43:42.610

我知道这是一个老问题，但我终于找到了编写 QueryExpression 的优雅方式，并且认为与社区分享会很好。

相同的查询可以这样写：

```
 FilterExpression _filter = new FilterExpression(LogicalOperator.And);
    _filter.AddCondition("firstname", ConditionOperator.Equal, "Joe");
    _filter.AddCondition("firstname", ConditionOperator.Equal, "John");

    dynamic _queryExpression = new QueryExpression {
EntityName = Contact.EntityLogicalName,
ColumnSet = new ColumnSet(true),
Criteria = _filter
    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-18T16:42:38.700

LinqKit 的 PredicateBuilder 提供了一组干净的扩展来管理此类问题。

# iphone - 在 UITextView 中垂直居中文本

> ID：12591192
> 
> 赞同：73
> 
> 时间：2012-09-25T21:17:57.343
> 
> 标签：iphone, objective-c, ios, xcode, uitextview

我想将文本*垂直*居中在一个填满整个屏幕的大屏幕内`UITextView`- 这样当文本很少时，说几句话，它就会以高度为中心。这不是关于文本居中的问题（可以在 IB 中找到的属性），而是关于将文本*垂直*放在中间的问题，`UITextView` *如果*文本很短，因此`UITextView`. 这可以做到吗？提前致谢！

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-09-25T21:26:03.827

首先为视图加载时的`contentSize`键值添加一个观察者：`UITextView`

```
- (void) viewDidLoad {
     [textField addObserver:self forKeyPath:@"contentSize" options:(NSKeyValueObservingOptionNew) context:NULL];
     [super viewDidLoad];
} 
```

然后添加此方法以调整`contentOffset`每次`contentSize`值更改时：

```
-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
     UITextView *tv = object;
     CGFloat topCorrect = ([tv bounds].size.height - [tv contentSize].height * [tv zoomScale])/2.0;
     topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
     tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};
} 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2015-10-29T22:13:47.380

因为[UIKit 不兼容 KVO](https://stackoverflow.com/a/6051404/357641)，所以我决定将其实现为一个子类，`UITextView`每当`contentSize`更改时它就会更新。

[这是卡洛斯答案](https://stackoverflow.com/a/12591299/35690)的一个稍微修改过的版本，它设置了`contentInset`而不是`contentOffset`. 除了[与 iOS 9 兼容](https://stackoverflow.com/a/33335640/35690)之外，它在 iOS 8.4 上的 bug 似乎也更少。

```
class VerticallyCenteredTextView: UITextView {
    override var contentSize: CGSize {
        didSet {
            var topCorrection = (bounds.size.height - contentSize.height * zoomScale) / 2.0
            topCorrection = max(0, topCorrection)
            contentInset = UIEdgeInsets(top: topCorrection, left: 0, bottom: 0, right: 0)
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-05-06T20:39:20.707

如果您不想使用 KVO，您也可以通过将此代码导出到如下函数来手动调整偏移量：

```
-(void)adjustContentSize:(UITextView*)tv{
    CGFloat deadSpace = ([tv bounds].size.height - [tv contentSize].height);
    CGFloat inset = MAX(0, deadSpace/2.0);
    tv.contentInset = UIEdgeInsetsMake(inset, tv.contentInset.left, inset, tv.contentInset.right);
} 
```

并调用它

```
-(void)textViewDidChange:(UITextView *)textView{
    [self adjustContentSize:textView];
} 
```

每次编辑代码中的文本时。不要忘记将控制器设置为委托

**斯威夫特 3 版本：**

```
func adjustContentSize(tv: UITextView){
    let deadSpace = tv.bounds.size.height - tv.contentSize.height
    let inset = max(0, deadSpace/2.0)
    tv.contentInset = UIEdgeInsetsMake(inset, tv.contentInset.left, inset, tv.contentInset.right)
}

func textViewDidChange(_ textView: UITextView) {
    self.adjustContentSize(tv: textView)
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-10-25T22:04:57.483

对于 iOS 9.0.2。我们需要设置 contentInset 。如果我们对 contentOffset 进行 KVO，iOS 9.0.2 会在最后一刻将其设置为 0，从而覆盖对 contentOffset 的更改。

```
-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    UITextView *tv = object;
    CGFloat topCorrect = ([tv bounds].size.height - [tv     contentSize].height * [tv zoomScale])/2.0;
    topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
    [tv setContentInset:UIEdgeInsetsMake(topCorrect,0,0,0)];
}

- (void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:NO];
    [questionTextView addObserver:self forKeyPath:@"contentSize" options:(NSKeyValueObservingOptionNew) context:NULL];
} 
```

我分别将 0,0 和 0 用于左、下和右边缘插图。确保也为您的用例计算这些。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-08-10T13:06:25.547

您可以仅使用约束直接设置它：

我添加了 3 个约束来在约束中垂直和水平对齐文本，如下所示：

[![在此处输入图像描述](../Images/3531966ec52b3dadacfa2851c3061c4b.png)](https://i.stack.imgur.com/d1ZDA.png)

1.  将高度设为 0 并添加大于
2.  添加垂直对齐到父约束
3.  添加水平对齐到父约束

[![在此处输入图像描述](../Images/23f5560ca45d4bd9b351ff8bef872596.png)](https://i.stack.imgur.com/LWizy.png)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-08-09T15:42:49.003

这是一个`UITextView`垂直居中内容的扩展：

```
extension UITextView {

    func centerVertically() {
        let fittingSize = CGSize(width: bounds.width, height: CGFloat.max)
        let size = sizeThatFits(fittingSize)
        let topOffset = (bounds.size.height - size.height * zoomScale) / 2
        let positiveTopOffset = max(0, topOffset)
        contentOffset.y = -positiveTopOffset
    }

} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-03-14T04:37:14.647

我刚刚在 Swift 3 中创建了一个自定义的垂直居中文本视图：

```
class VerticallyCenteredTextView: UITextView {
    override var contentSize: CGSize {
        didSet {
            var topCorrection = (bounds.size.height - contentSize.height * zoomScale) / 2.0
            topCorrection = max(0, topCorrection)
            contentInset = UIEdgeInsets(top: topCorrection, left: 0, bottom: 0, right: 0)
        }
    }
} 
```

参考：[https ://geek-is-stupid.github.io/2017-05-15-how-to-center-text-vertically-in-a-uitextview/](https://geek-is-stupid.github.io/2017-05-15-how-to-center-text-vertically-in-a-uitextview/)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-08-14T19:42:49.013

```
func alignTextVerticalInTextView(textView :UITextView) {

    let size = textView.sizeThatFits(CGSizeMake(CGRectGetWidth(textView.bounds), CGFloat(MAXFLOAT)))

    var topoffset = (textView.bounds.size.height - size.height * textView.zoomScale) / 2.0
    topoffset = topoffset < 0.0 ? 0.0 : topoffset

    textView.contentOffset = CGPointMake(0, -topoffset)
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-02-05T17:06:12.070

我有一个文本视图，我正在使用自动布局并将 and 设置`lineFragmentPadding`为零`textContainerInset`。上述解决方案均不适用于我的情况。但是，这对我有用。使用 iOS 9 测试

```
@interface VerticallyCenteredTextView : UITextView
@end

@implementation VerticallyCenteredTextView

-(void)layoutSubviews{
    [self recenter];
}

-(void)recenter{
    // using self.contentSize doesn't work correctly, have to calculate content size
    CGSize contentSize = [self sizeThatFits:CGSizeMake(self.bounds.size.width, CGFLOAT_MAX)];
    CGFloat topCorrection = (self.bounds.size.height - contentSize.height * self.zoomScale) / 2.0;
    self.contentOffset = CGPointMake(0, -topCorrection);
}

@end 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-12-11T11:05:28.273

`NSLayoutManager`这是用于获取实际文本大小的简单任务`NSTextContainer`

```
class VerticallyCenteredTextView: UITextView {

    override func layoutSubviews() {
        super.layoutSubviews()

        let rect = layoutManager.usedRect(for: textContainer)
        let topInset = (bounds.size.height - rect.height) / 2.0
        textContainerInset.top = max(0, topInset)
    }
} 
```

不要在最终计算中使用`contentSize`和。`contentInset`

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-09-24T07:59:51.597

我也有这个问题，我用`UITableViewCell`with解决了`UITextView`。我在自定义`UITableViewCell`子类中创建了方法，属性`statusTextView`：

```
- (void)centerTextInTextView
{
    CGFloat topCorrect = ([self.statusTextView bounds].size.height - [self.statusTextView contentSize].height * [self.statusTextView zoomScale])/2.0;
    topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
    self.statusTextView.contentOffset = (CGPoint){ .x = 0, .y = -topCorrect }; 
```

并在方法中调用此方法：

```
- (void)textViewDidBeginEditing:(UITextView *)textView
- (void)textViewDidEndEditing:(UITextView *)textView
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

这个解决方案对我来说没有问题，你可以试试。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-03-21T23:18:50.887

**斯威夫特 3：**

```
override func viewDidLayoutSubviews() {
        super.viewDidLayoutSubviews()

        textField.frame = self.view.bounds

        var topCorrect : CGFloat = (self.view.frame.height / 2) - (textField.contentSize.height / 2)
        topCorrect = topCorrect < 0.0 ? 0.0 : topCorrect
        textField.contentInset = UIEdgeInsetsMake(topCorrect,0,0,0)

    } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-06-26T06:10:05.847

添加到 Carlos 答案，以防万一电视中的文本大于电视大小，您不需要重新定位文本，因此更改此代码：

```
tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect}; 
```

对此：

```
if ([tv contentSize].height < [tv bounds].size.height) {
     tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-03-08T10:33:10.277

自动布局解决方案：

1.  创建一个 UIView 作为 UITextView 的容器。
2.  添加以下约束：
    *   TextView：将前导空格对齐到：容器
    *   TextView：将尾随空格对齐：容器
    *   TextView：将中心 Y 对齐到：容器
    *   TextView：等高到：容器，关系：≤</li>

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-07-27T12:23:00.423

你可以试试下面的代码，不需要观察者。当视图解除分配时，观察者有时会抛出错误。您可以将此代码保存在 viewDidLoad、viewWillAppear 或任何地方的 viewDidAppear 中。

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    dispatch_async(dispatch_get_main_queue(), ^(void) {
        UITextView *tv = txtviewDesc;
        CGFloat topCorrect = ([tv bounds].size.height - [tv contentSize].height * [tv zoomScale])/2.0;
        topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
        tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};
    });
}); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-09-28T06:18:13.533

我是这样做的：首先，我将 UITextView 嵌入到 UIView 中（这也适用于 mac OS）。然后我将外部 UIView 的所有四个侧面都固定到其容器的侧面，使其形状和大小类似于或等于 UITextView 的形状和大小。因此，我有一个合适的 UITextView 容器。然后我将 UITextView 的左右边框固定到 UIView 的两侧，并给 UITextView 一个高度。最后，我将 UITextView 在 UIView 中垂直居中。Bingo :) 现在 UITextView 在 UIView 中垂直居中，因此 UITextView 内的文本也垂直居中。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2015-05-18T21:02:47.867

UITextView+VerticalAlignment.h

```
//  UITextView+VerticalAlignment.h
//  (c) The Internet 2015
#import <UIKit/UIKit.h>

@interface UITextView (VerticalAlignment)

- (void)alignToVerticalCenter;
- (void)disableAlignment;

@end 
```

UITextView+VerticalAlignment.m

```
#import "UITextView+VerticalAlignment.h"

@implementation UITextView (VerticalAlignment)

- (void)alignToVerticalCenter {
    [self addObserver:self forKeyPath:@"contentSize" options:NSKeyValueObservingOptionNew context:NULL];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    UITextView *tv = object;
    CGFloat topCorrect = ([tv bounds].size.height - [tv contentSize].height * [tv zoomScale])/2.0;
    topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );
    tv.contentOffset = (CGPoint){.x = 0, .y = -topCorrect};
}

- (void)disableAlignment {
    [self removeObserver:self forKeyPath:@"contentSize"];
}
@end 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2019-07-14T23:50:45.693

我通过垂直创建中心高度的扩展来解决这个问题。

**斯威夫特 5：**

```
extension UITextView {
    func centerContentVertically() {
        let fitSize = CGSize(width: bounds.width, height: CGFloat.greatestFiniteMagnitude)
        let size = sizeThatFits(fitSize)
        let heightOffset = (bounds.size.height - size.height * zoomScale) / 2
        let positiveTopOffset = max(0, heightOffset)
        contentOffset.y = -positiveTopOffset
    }
} 
```

* * *

## 回答 #19

> 赞同：-4
> 
> 时间：2016-09-20T19:35:43.830

RubyMotion中iOS10的解决方案：

```
class VerticallyCenteredTextView < UITextView

    def init
        super
    end

    def layoutSubviews
        self.recenter
    end

    def recenter
        contentSize = self.sizeThatFits(CGSizeMake(self.bounds.size.width, Float::MAX))
        topCorrection = (self.bounds.size.height - contentSize.height * self.zoomScale) / 2.0;
        topCorrection = 0 if topCorrection < 0
        self.contentInset = UIEdgeInsetsMake(topCorrection,  0, 0, 0)
    end

end 
```

# jquery - 为文件 API readAsText 创建 jQuery Promise

> ID：12591196
> 
> 赞同：1
> 
> 时间：2012-09-25T21:18:14.833
> 
> 标签：jquery, html, fileapi, deferred, promise

我正在使用文件输入元素，用户将使用该元素选择单个文本文件：

```
<input type="file" id="myfile"> 
```

我想创建一个与加载所选文件内容的 FileReader 对象的异步事件相关联的 jQuery Promise。我在各种上下文中尝试了这样的代码，但似乎存在某种时间问题，因为我没有将内容变量传递给 then() 回调：

```
var promise = $.Deferred(function(dfd) {
  var file = $("#myfile")[0].files[0];
  var reader = new FileReader();
  reader.onload =  function(event){
    var contents = event.target.result;
    dfd.resolve(contents);
  };
  reader.readAsText(file);
}).promise();

// other code and promises here

$.when(promise).then(function(contents){
  console.log(contents);
}); 
```

实际上涉及两个事件。第一个事件发生在用户单击浏览按钮并选择特定文件时。第二个事件是当 FileReader 加载了选定的文件内容时。如果有人知道如何正确打包此文件，那么我将保证在解决时保留所选文件的内容，我将不胜感激您的见解。提前致谢。

# windows - ASP.NET 应用程序中的 Windows 身份验证

> ID：12591198
> 
> 赞同：0
> 
> 时间：2012-09-13T13:20:46.983
> 
> 标签：windows, active-directory, asp.net

我们正在尝试将旧的 Intranet ASP .NET Web 应用程序从基于“表单”的身份验证迁移到基于“Windows”的身份验证中，这样用户在登录 PC 后就不必再次输入凭据，我们只想阅读当前登录的身份并将其用于在应用程序中对用户进行身份验证和授权。

在 ASP .NET 中进行 Windows 身份验证非常简单，但我想检查的是如何在 AD 或 ADAM 中管理用户及其组。

同一个用户可以在同一个应用程序的多个环境（如 Dev、UAT、LT、Prod 等）上拥有权限，因此同一个域帐户需要在多个环境（不同的 URL）中进行身份验证。此外，一旦通过环境身份验证，用户可能属于多个角色，这些角色决定用户可以执行哪些操作。

我在这里寻找一些关于我们如何在 AD 中设置此结构的建议，我们正在考虑在 AD 中为不同的环境（如 App_Dev、App_UAT、App_Prod 等）创建组，并在每个环境中为不同的环境创建嵌套组应用程序中的角色，例如每个环境的 App_Dev\Role1、App_Dev\Role2、App_UAT\Role1 等，并在其中添加用户。

你们有什么感想？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:31:55.417

您必须记住，身份验证和授权是两件不同的事情。您已将它们组合在您的逻辑中。

例如，您的身份验证机制是 AD。所以是的，使用 AD 对凭据和组成员身份进行身份验证，以确保他们可以使用特定实例进行身份验证。

但是，您仍然可以使用经典的 RolesProvider 并使用 SQL 后端来存储数据库中每个实例的角色和用户到角色的分配。这很简单，并且使用了 ASP.NET 的内置功能，而无需在 AD 中创建组。您可以在网络上进行各种搜索`ASP.NET AD Authentication and SQL Roles Provider`。我认为 ScottGu 甚至有一篇关于如何做到这一点的旧文章。

最后，您在此处描述的不是 SSO，或者`Single Sign-On`，我将更新您的问题以反映这一点。SSO 是指创建一个在许多应用程序之间受信任和共享的令牌。您似乎不需要提供的示例，但如果您这样做，您将调查 ADFS 和`Windows Identity Foundation`(WIF)。仅仅因为您使用 AD 并不意味着您有 SSO，它只是意味着您有一个身份验证提供程序，但您仍然没有基于令牌的系统，该系统实际上只需要对中央身份验证服务的初始身份验证和授权请求，通常ADFS。

# php - 从 GET 参数创建链接

> ID：12591203
> 
> 赞同：0
> 
> 时间：2012-09-25T21:18:44.753
> 
> 标签：php

我试图根据当前设置的 GET 参数创建一些链接。

我的网址如下所示：

```
http://mysite.com/index.php?bar=test&page=page 
```

在我的代码中，我执行以下操作：

```
$bar = $_REQUEST['bar'];
<a href="index.php?bar=<?php echo $bar?>&page=anotherpage" 
```

但是每次我单击链接时，它都会再次将整个字符串添加到 URL 中。

就像第一次点击会给我这个网址：

```
http://mysite.com/index.php?bar=test&page=anotherpagepage=anotherpage 
```

下一步点击创建：

```
http://mysite.com/index.php?bar=test&page=anotherpagepage=anotherpagepage=anotherpage 
```

等等。

有没有办法只获取一次请求，以便 URL 始终如下所示：

```
http://mysite.com/index.php?bar=test&page=anotherpage 
```

无论我点击链接多少次？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:22:55.473

您在第一个示例中错过了一个＆符号。(&)。试试这个：

```
$bar = $_REQUEST['bar'];
<a href="index.php?bar=<?php echo $bar?>&amp;page=anotherpage" 
```

或者更好的是，在使用前转义变量以防止 XSS、跨站点脚本安全漏洞。用于`urlencode()`URL。
[http://nl.php.net/manual/en/function.urlencode.php](http://nl.php.net/manual/en/function.urlencode.php)：

```
$bar = $_REQUEST['bar'];
<a href="index.php?bar=<?=urlencode($bar)?>&amp;page=anotherpage" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:25:12.823

你应该看看 php 函数[http_build_query](http://php.net/manual/en/function.http-build-query.php)

这使您可以先构建数组，如下所示：

```
$query = array("bar"=>$_REQUEST['bar'], "page"=>"anotherpage")
echo '<a href="/index.php?'.http_build_query($query).'">Link</a>'; 
```

# mysql - 在mysql中将字符集从UTF-8更改为ISO-8859-1

> ID：12591204
> 
> 赞同：0
> 
> 时间：2012-09-25T21:18:46.027
> 
> 标签：mysql, linux, iconv

我开始研究一个遗留的 mysql 数据库，其排序规则：latin1-default 但表是 utf-8-default。即使使用 utf-8（通用标准编码）提到了表格，它也不会呈现瑞典语字符。似乎与此数据库编码相关的应用程序是 ISO-8859-1。因此，我想将此数据库和其中的数据转换为 ISO-8859-1 编码。我试过这个命令

```
 iconv -f  UTF-8 -t ISO-8859-1   webtest_backu_01.sql > converted-file.sql 
```

它给出错误：位置处的非法输入序列

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:22:07.833

请看一下这个链接：[http ://dev.mysql.com/doc/refman/5.0/en/charset-conversion.html](http://dev.mysql.com/doc/refman/5.0/en/charset-conversion.html)

如果可能，您可以使用 alter table 命令对每个表进行此转换。我之前成功使用过这个。

链接中的示例：

`ALTER TABLE t MODIFY col1 CHAR(50) CHARACTER SET utf8;`

还有一个重要的细节...如果列包含两个字符集中都不包含的字符，则转换可能有损...但我不认为 ISO-8859-1 到 UTF-8。

试一试其中一张桌子，看看它是否有效。

# postgresql - 如何将整数转换为串行

> ID：12591207
> 
> 赞同：22
> 
> 时间：2012-09-25T05:25:00.167
> 
> 标签：postgresql

我有一个表，它有一个主键列“gid”，它的类型是“Integer NOT NULL”。我想把它转换成“Serial NOT NULL”，这样我就可以在这个表中插入一些值。我使用以下命令将其转换为串行：

```
CREATE SEQUENCE test_table_gid_seq
        INCREMENT 1
        MINVALUE 1
        MAXVALUE 2147483648 START 1
        CACHE 1;

ALTER TABLE test_table ALTER COLUMN gid
        SET DEFAULT nextval('test_table_gid_seq'::regclass); 
```

该命令将整数转换为串行。但是，当我在表格中输入一些数据时，发生了以下错误：

错误：重复键值违反唯一约束“pk_test”。

请帮我解决这个问题。有没有其他方法可以将整数转换为串行？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-25T05:53:22.307

选择 gid 列的最大值 (max_gid)：

```
SELECT max(gid) FROM test_table; 
```

并将其用作序列的起点（可能是 max_gid+1）：

```
ALTER SEQUENCE test_table_gid_seq RESTART WITH max_gid; 
```

# c++ - 如何在 C++ 中检查双精度数的长度

> ID：12591212
> 
> 赞同：0
> 
> 时间：2012-09-25T21:19:16.857
> 
> 标签：c++

我正在使用此代码来检查输入的学号是否是正确的位数。是否有像 .length() 这样的函数适用于变量类型 double？谢谢！

```
do {
    cout << "Student's number: (Numeric only)";
    cin >> studentNumber;
    cin.ignore();
}
while (studentNumber.length() != 6); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T21:22:48.697

将其作为字符串读取，在它仍然处于该表示形式时检查它的长度（还要检查它是否仅由 组成`[0-9]`），然后转换为双精度。实际上，如果你打算用它做数学，只转换成双精度数。否则将其保留为字符串。

一般来说，以非字符串类型获取用户输入是充满危险的。将其作为字符串读取，验证并转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-25T21:25:25.820

将其读取为文本，对其进行验证，然后对其进行解析：

```
std::string input;
bool valid = false;
while (!valid) {
    cout << "Student's number: (Numeric only)";
    cin >> input;
    if (input.size() == 6)
        valid = true;
}
double studentNumber = strtod(input.c_str()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-25T21:22:36.243

```
do {
  cout << "Student's number: (Numeric only) " << flush;
} while( !( cin >> studentNumber ) || 
         ( studentNumber < 100000 ) || 
         ( studentNumber > 999999 ) ); 
```

放置`cin >> studentNumber`在其中`while`还可以确保用户输入的文本成功转换为任何类型`studentNumber`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-25T21:23:12.383

你不能只使用`<`and`>`吗？

```
// Require that studentNumber be 3 digits
if(studentNumber < 100 || studentNumber >= 1000) {
    cout << "bad" << endl;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-25T21:25:34.250

如果切换到整数类型，简单的除法可以做到这一点：

```
long studentNumber;
do {
    // get number
} while (!(studentNumber / 100000L) || studentNumber / 1000000L); 
```

如果您实际上想要整数类型的位数：

```
int long_digits(long l)
{
    // this code will work for negative numbers, but we don't want them
    if (l < 0L)
        throw std::out_of_range("no negative numbers please");

    int count;
    for (count = 0; l; l /= 10L, ++count);
    return count;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-25T21:21:13.333

你为什么不使用[log10](http://www.cplusplus.com/reference/clibrary/cmath/log10/)？那么你需要对结果进行四舍五入，也许使用[floor(double)](http://www.cplusplus.com/reference/clibrary/cmath/floor/)来查找整数

```
//remember math.h
#include <math.h>

do {
    cout << "Student's number: (Numeric only)";
    cin >> studentNumber;
    cin.ignore();
}
while (floor(log10(studentNumber)) != 6); 
```

编辑：一点解释：log10 允许您在此等式中找到 x

```
10^x=y 
```

其中 y 是给定的并且是您的指数。

长话短说，`studentNumber`必须是 6 个“字符”，我们可以这样写

```
10^5 <= studentNumber < 10^6 
```

或者

```
5 <= log10(studentNumber) < 6 
```

进而

```
floor(log10(studentNumber)) ==5 
```

仅当它是整数部分中的 6 位数字时。

# c# - 大规模更新数据库的最快方法？

> ID：12591219
> 
> 赞同：2
> 
> 时间：2012-09-25T21:19:45.847
> 
> 标签：c#, asp.net, entity-framework

所以我在程序的某个部分一次更改了很多条目。现在每个代码看起来像这样：

```
foreach(newentry)
{
    oldentry = context.Users.Find(entry.userid);
    newentry.oldvalue = newvalue;
    context.Entry(oldentry).CurrentValues.SetValues(newentry);
}
context.SaveChanges(); 
```

但是，这最终会查询数据库 300 多次，并且正在扼杀我的性能。我想到的唯一方法是预加载数据库，但我认为这也不是最好的方法。

```
var userlist = context.Users.ToList();
foreach(newentry in userlist)
{
    var original = entry;
    entry.originalvalue = newvalue;
    context.Entry(original).CurrentValues.SetValues(newentry);
}
context.SaveChanges(); 
```

我仍在访问数据库 300 多次，不是吗？你会推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:23:31.300

我会使用直接 ADO 来做到这一点。我将获取用户 ID 列表，然后使用表值参数进行批量更新。

[这是此](http://msdn.microsoft.com/en-us/library/bb675163.aspx)MSDN 文章中的示例：

```
UPDATE dbo.Categories
SET Categories.CategoryName = ec.CategoryName
FROM dbo.Categories INNER JOIN @tvpEditedCategories AS ec
ON dbo.Categories.CategoryID = ec.CategoryID; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:23:33.860

第二种方式将加载所有用户，然后在您调用 SaveChanges 时“批量更新”所有用户。它比第一个版本更有效，因为它不发送 300 个选择（只是一个更大的选择）。

这是您可以在没有手动 SQL 的情况下使用原始 EF 做的最好的事情。这对你来说可能没问题。您可能应该测量需要多长时间并确定它是否足够。

如果您认为它不够快，则需要求助于原始 SQL 解决方案（肯定已经在网络上的其他地方进行了描述）。

# cuda - 在 ptx 文件中找不到函数

> ID：12591227
> 
> 赞同：3
> 
> 时间：2012-09-25T21:20:13.637
> 
> 标签：cuda, gpu

我已经为其他应用程序这样做了，但由于某种原因，它在我当前的应用程序中不起作用。

这是一个代码片段，在 VS2010 中工作，使用 Cuda 4.2。我已经在 VS 内部和 VS 外部编译了 ptx 文件，但没有解决问题：

```
CUmodule    Module = NULL;
int rc7 = cuModuleLoad(&Module, CubinName);  // needs bin
if (rc7 == 0)  {
    rc = cuModuleGetFunction( &cuF_makeProcFrame, Module, "makeProcFrame" );
} 
```

**我得到 rc=500 -- 找不到函数。**

当我在文本编辑器中打开 ptx 文件时，我看到：

```
.entry _Z13makeProcFrame14cudaPitchedPtriiii(
    .param .align 4 .b8 _Z13makeProcFrame14cudaPitchedPtriiii_param_0[16],
    .param .u32 _Z13makeProcFrame14cudaPitchedPtriiii_param_1,
    .param .u32 _Z13makeProcFrame14cudaPitchedPtriiii_param_2,
    .param .u32 _Z13makeProcFrame14cudaPitchedPtriiii_param_3,
    .param .u32 _Z13makeProcFrame14cudaPitchedPtriiii_param_4
 ) 
```

最后在 CUDA 代码本身中是被调用的行：

```
__global__ void makeProcFrame(
                    cudaPitchedPtr YProcBasePtr, 
                    int numFrames, 
                    int width,
                    int height,
                    int lineBytes
            ) 
```

谁能告诉我为什么我得到错误返回而不是找到函数？

* * *

编辑：这是编译的批处理文件：

> "C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v4.2\bin\nvcc.exe" -gencode=arch=compute_20,code=sm_20 -ccbin "C:\Program Files (x86)\Microsoft Visual Studio 10.0 \VC\bin" -I"C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v4.2\include" -O -G --machine 32 --maxrregcount=0 -ptx -o="filterKernelHand.ptx"过滤内核.cu

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T21:25:18.247

声明 CUDA 内核时使用 "extern "C"" - 这样编译器就不会破坏函数名。

# html - 如何在 xCode 项目中加载 html 文件？

> ID：12591233
> 
> 赞同：0
> 
> 时间：2012-09-25T21:20:43.990
> 
> 标签：html, iframe, localhost

我在问是否有可能做这样的事情。

用 html5 或其他东西设计一个 web 应用程序，然后从 localhost 将它加载到 xcode 中。

如果可以，我该怎么做？

考虑到从 0/10 xcode 知识，我有 0.5。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T14:27:31.327

最简单的方法是让最终用户为您的 localhost webapp URL 创建一个网络链接/快捷方式。这假设全部功能都位于服务器端，而客户端仅使用/查看 HTML。

更动态的答案是在 XCode 中创建一个应用程序并包含一个 UIWebView。从那里实例化一个 NSURL 并将其指向“http://localhost/”。

# android - robotium - 单击操作栏选项卡

> ID：12591234
> 
> 赞同：6
> 
> 时间：2012-09-25T21:20:57.707
> 
> 标签：android, actionbarsherlock, robotium

我正在完成移动到操作栏（使用 actionbarsherlock），最后一件事是转换所有的机器人集成测试。单击操作栏操作项似乎已解决，但是我无法弄清楚如何使用 Robotium 单击操作栏选项卡。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-30T02:12:35.140

![操作栏屏幕](../Images/c7462930760d1218f7df177b2384cb2d.png)

您可以使用

```
[1] solo.clickOnText("TAB A"); 
    // click on action bar tab 1
    // where action bar tab 1 diaplay text = "TAB A"

[2] solo.clickOnText("TAB A"); 
    // click on action bar tab 1
    // where action bar tab 1 diaplay text = "TAB A" 
```

如果您在操作栏选项卡中有图像，

![在此处输入图像描述](../Images/45cc374d814a4ae7e39cee1053e81ad5.png)

```
[1] solo.clickOnImage(0); OR solo.clickOnImageButton(0);
        // click on action bar tab 1

[2] solo.clickOnImage(1); OR solo.clickOnImageButton(1); 
        // click on action bar tab 2 
```

我希望这能帮到您。谢谢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-05T14:28:43.220

点击操作栏：-如果您有被测应用程序的源代码，最好的方法是通过 ID 识别操作栏项，可以在被测应用程序的 R.Java 中找到。

solo.clickOnActionBarItem(R.id.ItemToBEClicked);

# php - shopify 无法处理的实体

> ID：12591238
> 
> 赞同：3
> 
> 时间：2012-09-25T21:21:14.947
> 
> 标签：php, shopify

在使用应用程序安装运行此代码时，我收到无法处理的实体状态代码 422 错误。 **这是代码**

```
$sc = new ShopifyClient($_SESSION['shop'], $_SESSION['token'], $api_key, $secret);
$charge = array
(
    "webhooks"=> array
    (
        "topic"=>"orders/create",
        "address"=>"http://www.abc123no.com/nomi/s.php?key=123456789",
        "format"=>"json"
    )
);

try 
{
            $webhooks = $sc->call('POST','/admin/webhooks.json',$charge);
}
catch (ShopifyApiException $e)
{
    var_dump($e->getResponseHeaders());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:04:05.763

错误代码 422 用于验证错误。响应正文将描述错误以帮助您调试应用程序。

例如，响应可能是：`{"errors":{"address":["for this topic has already been taken"]}}`

您的错误似乎是由于使用了错误的请求格式。创建端点不采用 webhook 数组，您应该使用单数“webhook”作为顶级键。

Webhook [API](http://api.shopify.com/webhook.html#create)文档具有正确的请求正文格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-11T12:31:35.200

将 webhook 更改为 webhook ，它可能会产生错误的请求错误

```
"**webhooks**"=> array
    (
        "topic"=>"orders/create",
        "address"=>"http://www.abc123no.com/nomi/s.php?key=123456789",
        "format"=>"json"
    ) 
```

# javascript - 生成给定大小的随机 5d 矢量

> ID：12591241
> 
> 赞同：2
> 
> 时间：2012-09-25T21:21:25.443
> 
> 标签：javascript, math, vector, vector-graphics

给定一个五维空间，我想生成 100 个向量，所有向量都具有固定的大小 = M，其中分量值是随机分布的。

我最初想从一个单位向量开始，然后应用一个旋转矩阵，带有 10 个自由度的随机参数......这行得通吗？如何？

在 Javascript 中执行此操作的任何好方法...？

为任何指点欢呼！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T21:30:07.000

这是我将使用的蒙特卡洛算法（我对 Javascript 的了解不够好，无法在脑海中编写代码）：

1.  为五个维度中的每一个维度生成 -1 到 1 范围内的随机值。

2.  计算幅度 M，如果 M=0 或 M>1，则拒绝这些值并返回步骤 #1。

3.  将向量归一化，使其大小为 1（每个维度除以 M）。

这应该为您提供均匀分布在 5 维超球面上的随机单位向量。

* * *

**有人问过这个问题：“如果 M>1，为什么要拒​​绝该向量？”**

***答案：这样最终的向量将均匀分布在单位 5 球体的表面上。***

**推理：** 我们在第一步中生成的是一组随机向量，这些向量均匀分布在单位 5 立方的体积内。其中一些向量也在单位 5 球体的体积内，其中一些在该体积之外。如果归一化，则 5 球内的向量均匀分布在其表面上，*然而*，其外部的向量则根本不均匀分布。

可以这样想：就像普通的 3 维单位立方体和单位球体，甚至单位正方形和单位圆一样，单位 5 球体完全包含在单位 5 立方体中，它只触及五个正单位尺寸轴点：

```
(1,0,0,0,0)
(0,1,0,0,0)
(0,0,1,0,0)
(0,0,0,1,0)
(0,0,0,0,1) 
```

及其对应的负单位轴点。这是因为这些是立方体表面上唯一大小（与原点的距离）为 1 的点，在所有其他点上，5 立方体的表面与原点的距离*大于*1。

这意味着（0,0,0,0,0）和（1,1,1,1,1）之间的点比（0,0,0,0,0）和（ 1,0,0,0,0)。事实上关于 SQRT(5) 或 aprx。2.25倍以上。

这意味着，如果您将*所有*向量包含在单位 5 立方中，则“随机”映射到 (0.44,0.44,0.44,0.44,0.44) 的结果将是 (1) 的两倍多,0,0,0,0)。

* * *

对于那些挑战（没有基础，恕我直言）这会导致 5-D 球体表面均匀分布的人，请参阅此 Wikipedia 文章部分中的替代方法：[https ://en.wikipedia.org/wiki /N-sphere#Uniformly_at_random_on_the_(n_%E2%88%92_1)-sphere](https://en.wikipedia.org/wiki/N-sphere#Uniformly_at_random_on_the_(n_%E2%88%92_1)-sphere)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T23:35:32.763

从 5 维的单位超立方体采样然后重新缩放的问题是某些方向上的点（朝向超立方体的角）将被过度采样。

但是如果你使用拒绝方案，那么你会丢失太多的样本。即一个单位超立方体在5-d的体积是pi^2*(8/15) = 5.26378901391432。将其与仅包含球体的 5 维单位超立方体的体积进行比较。那个超立方体的体积是 32。所以如果你拒绝落在球体之外的点，你就会拒绝

```
1 - 5.26378901391432/32 = 0.835506593315178 
```

或大约 83.5% 的分数被拒绝。这意味着您需要平均采样大约 6 个点，然后才能找到 5 球内的样本。

一个更好的想法是使用单位正态样本进行采样，然后重新缩放该点向量以具有单位范数。由于多元正态分布是球对称的，所以根本不需要拒绝。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T21:41:47.403

这里有一些方法，它适用于单位向量，但你可以乘以 M：

[http://burtleburtle.net/bob/rand/unitvec.html](http://burtleburtle.net/bob/rand/unitvec.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T21:26:11.140

我建议为每个元素分配 -1 和 +1 之间的随机数。一旦分配了向量的所有元素，就应该对向量进行归一化。要标准化，只需将每个元素除以整个向量的大小即可。完成此操作后，您将得到一个大小为 1 的随机向量。如果要将向量缩放到大小 M，只需将每个元素乘以 M。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T16:25:33.047

**无拒绝拣货（快 6 倍）**

来自[Mathworld](http://mathworld.wolfram.com/SpherePointPicking.html)和[Bitwise 发布的链接](http://burtleburtle.net/bob/rand/unitvec.html)：

> 如果您选择 n 个具有正态分布的数字，将它们视为坐标，并将结果向量归一化为单位向量，这将选择 n 维中均匀分布的单位向量。

- Burtleburtle (ht 按位)

正如 Bitwise 指出的那样，这应该乘以所需的幅度。

注意这里没有拒绝步骤；分布本身已经处理了向零的必要偏差。由于正态分布和半圆不是同一个形状，我想知道 RBarryYoung 的答案是否真的给出了球体表面的均匀分布。

**关于具有超球面排斥的均匀超立方体拾取（RBarryYoung 的回答）**

[Mathworld 文章](http://mathworld.wolfram.com/SpherePointPicking.html)描述了使用从均匀分布中挑选的 4 个随机数来计算 3d 球体表面上的随机向量。它对单位超球面之外的任何随机数的 4d 向量执行拒绝，就像 RBarryYoung 所做的那样，但不同之处在于它 (a) 使用额外的随机数和 (b) 对要提取的数字执行非线性变换3d 单位向量。

对我来说，这意味着具有超球面排斥的每个轴上的均匀分布不会在球体表面上实现均匀分布。

# java - 在 Sql DB 中插入空 java.sql.Date 的更优雅方式

> ID：12591242
> 
> 赞同：2
> 
> 时间：2012-09-25T21:21:28.670
> 
> 标签：java, mysql, sql, date

您好我正在尝试通过 Servlet 在 SQL 数据库中插入日期。如果帖子提交的字段生日是空的，那么它应该插入 0000-00-00

但这有点复杂。

我这样做是有效的：

```
if (birthdate == null) {
            ps_employee.setInt(4, 0); //ps_employee is my PreparedStatement
        } else {
            ps_employee.setDate(4, birthdate);
        } 
```

如果 post 字段没有值，则生日为 null。否则生日包含一个有效的 java.sql.date 对象。

上面的代码有效，但它在 sql 中显示警告：“生日数据被截断”....

有没有更好的方法来插入 0000-00-00 日期？？？

感谢您的帮助..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:25:15.073

```
 String query="INSERT INTO tablename values(?) "
  Connection connection = get the dbconn;
  PreparedStatement preparedStatement= connection.prepareStatement(query);      
  preparedStatement.setNull(0, java.sql.Types.DATE) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:50:09.633

该解决方案取决于系统的数据完整性要求。

有两种（也只有两种）选择：

1.  系统的设计（有*设计*，对吗？）要求每条记录都有一个有效的出生日期。在这种情况下，UI 有责任强制执行此操作。您的代码将永远不会收到空日期，如果收到，则有理由抛出异常。这消除了你的问题。
2.  在某些情况下，缺少出生日期是可以接受的。在这种情况下，必须更改表定义以允许空值。

您要做的最后一件事是编造一些特殊的日期值作为 NULL 的替身。该列不是 NULL 的事实表明上述情况 (1) 适用，并且您的特殊日期实际上违反了系统的数据完整性不变量。每个未来负责维护代码的程序员都会诅咒你的名字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T21:25:38.817

如果提交的字段为空，您应该存储`null`，而不是在接下来的 20 年中每个使用该数据的应用程序都必须检查的魔法值。

在输出时转换`null`为 '0000-00-00' - 或其他任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-03T02:33:31.563

# 没有好的解决方案

如何处理数据库中的空日期时间值的问题没有好的解决方案。

## 避免 NULL

正如[Chris Date 博士](https://en.wikipedia.org/wiki/Christopher_J._Date)[在 SQL 标准指南](https://www.goodreads.com/book/show/1682377.A_Guide_to_the_SQL_Standard)和其他地方所解释的那样， [NULL](https://en.wikipedia.org/wiki/Null_(SQL))是一场血腥的噩梦。一般来说，如果可能的话，应该避免它们。在 SQL 数据库中，这意味着将每一列声明为`NOT NULL`（我*希望*有一种方法可以将其设为默认值）。在合理的情况下，我们设置了某种默认值。

## 日期时间没有好的默认值

但是为日期时间值设置默认值可能会非常混乱。SQL 标准和 JDBC/java.sql.* 都没有将任何特定值定义为“空”标志。

Java 8 及更高版本中内置的[java.time](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)框架确实将最小值和最大值定义为[`Instant`](http://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)、[`LocalDateTime`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDateTime.html)、[`LocalDate`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)和[`LocalTime`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalTime.html)类中的常量。除了解决的关键问题外，这些值*可能*用作标志值。这些 java.time 类解析为[纳秒](https://en.wikipedia.org/wiki/Nanosecond)，而许多数据库具有更大的粒度，例如[Postgres](http://www.postgresql.org/)中的[微秒](https://en.wikipedia.org/wiki/Microsecond)。最小值和最大值非常极端，以至于当截断到更小的粒度时它们的含义会发生变化。

### 零值

您可能会直观地考虑考虑零值日期时间，`0000-00-00 00:00:00.0`// `0000-00-00`。`00:00:00.0`没那么简单。

没有零月/日

首先，没有 的月份`00`，也没有 的日期`00`。所以，好吧，我们可以把它改成`0000-01-01`，一月一日。

没有零年

下一期：没有`0000`. 我不知道所有数据库，但至少在 Postgres 中没有这样的零年。尝试插入这样的值会产生错误。

```
INSERT INTO moment_  -- TIMESTAMP WITH TIME ZONE.
VALUES (  '0000-01-01 00:00:00.0Z' ) ; 
```

…抛出错误：

```
ERROR:  date/time field value out of range: "0000-01-01 00:00:00.0Z"
LINE 2: VALUES (  '0000-01-01 00:00:00.0Z' ) ;
                  ^
********** Error ********** 
```

更改`0000`为第一年的`0001`作品。

```
INSERT INTO moment_  -- TIMESTAMP WITH TIME ZONE.
VALUES (  '0001-01-01 00:00:00.0Z' ) ;

SET TIME ZONE 'UTC' ;

TABLE moment_ ; 
```

> 0001-01-01 00:00:00+00

`BC`这个数字是对比`AD`时代的支点。让我们减去一个小时来看看从 AD 移动到 BC 的行为。顺便说一下，诸如`BC`依赖于语言环境的字符串可能会因您而异。另外，请注意，我们必须将时区设置为[UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)才能正确完成此日期时间操作。

```
SET TIME ZONE 'UTC' ;

INSERT INTO moment_  -- TIMESTAMP WITH TIME ZONE.
VALUES ( TIMESTAMP '0001-01-01 00:00:00.0Z' - INTERVAL '1 hour' ) ;

SET TIME ZONE 'UTC' ;

TABLE moment_ ; 
```

结果是年份，所以我们从to`0001 BC`跳转；没有零年。`0001``0001 BC``0000`

> “0001-12-31 23:00:00+00 BC”

因此，如果您决定使用某个标志值，则不能使用真正的零值，但可以使用接近零的值，即公元第一年一月的第一天：`'0001-01-01 00:00:00.0Z'`

时区

使用此特殊标志值时，您必须注意时区。

传递字符串时，会隐式应用 SQL 会话的当前默认时区（至少在 Postgres 中）。

## 对 NULL 进行排序

在我自己的工作中，我确实将几乎所有列都设为 NOT NULL 并设置了默认值。但是日期时间列是一个例外，因为没有可用的标志值。我已经为此受苦了。具体来说，我学习了如何使用`NULLS FIRST`/`NULLS LAST`修饰符的艰难方法，因为[SQL 标准没有明确定义 NULL 的默认排序顺序](https://en.wikipedia.org/wiki/Null_(SQL)#When_two_nulls_are_equal:_grouping.2C_sorting.2C_and_some_set_operations)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-09T23:42:06.510

我会这样做的方式是通过列的默认值。根据类型将默认设置为“0000-00-00”或“0000-00-00 00:00:00”。

一旦您在数据库中设置了默认值，那么您就不会在插入语句中提供该字段。您可以对不允许为空的列执行此操作，它仍将插入 MySQL 伪空日期。

如果这样做，那么您还应该将此参数添加到您的 SQL 连接字符串中，因为您无法读取 zeroDate...

zeroDateTimeBehavior=convertToNull

最终结果是您将这些日期处理为 Java 中的 null 和 MySQL 数据库中的 0000-00-00。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-25T21:27:13.980

您收到错误的原因是您尝试插入无效日期。没有 0 月和 0 日之类的东西。MySQL 不会接受它作为日期。

要么使用其他用户描述的 NULL，要么使用您定义的一些最小基线日期，例如“1100-01-01”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-01T18:38:46.853

如果您的数据允许 NULL，但您的 SQL 表不允许（例如复合键的日期部分），您可以使用普遍接受的“空”值（GUI 工具使用此值）来表示默认/空白日期。这是和示例：

```
private static final String EMPTY_MYSQL_DATE = "0000-00-00 00:00:00";    
...
if(someDateObj == null) {
    preparedStatement.setString(++psIndex, EMPTY_MYSQL_DATE);
} else {
    preparedStatement.setTimestamp(++psIndex, new Timestamp(someDateObj.getTime()));
} 
```

# c# - EF 迁移，将属性 id 设置为数据库生成的身份时发生冲突

> ID：12591244
> 
> 赞同：1
> 
> 时间：2012-09-25T21:21:51.867
> 
> 标签：c#, entity-framework, ef-code-first

我为我的身份类别设置了以下设置：

```
 public class Identity 
   {
        public Identity()
        {
            this.Roles = new List<Role>();
        }

        public int Id { get; set; }
        public System.DateTime DateAdded { get; set; }
        public string identityprovider { get; set; }
        public string nameidentifier { get; set; }
        public System.DateTime LastLoggedIn { get; set; }

        public virtual ICollection<Role> Roles { get; set; }
    }

public class IdentityMap : EntityTypeConfiguration<Identity>
{
    public IdentityMap()
    {
        // Primary Key
        this.HasKey(t => t.Id);

        // Properties
        this.Property(t => t.identityprovider)
            .IsRequired()
            .HasMaxLength(255);

        this.Property(t => t.nameidentifier)
            .IsRequired();

        // Table & Column Mappings
        this.ToTable("Identities");
        this.Property(t => t.Id).HasColumnName("Id")
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
//ERROR WHEN ADDING ABOVE LINE DatabaseGeneratedOption.Identity

        this.Property(t => t.DateAdded).HasColumnName("DateAdded").
            HasDatabaseGeneratedOption(DatabaseGeneratedOption.Computed);
        this.Property(t => t.identityprovider).HasColumnName("identityprovider");
        this.Property(t => t.nameidentifier).HasColumnName("nameidentifier");
        this.Property(t => t.LastLoggedIn).HasColumnName("LastLoggedIn")
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Computed);

        // Relationships
        this.HasMany(t => t.Roles)
            .WithMany(t => t.Identities)
            .Map(m =>
                {
                    m.ToTable("IdentityRoles");
                    m.MapLeftKey("Identities_Id");
                    m.MapRightKey("Roles_Id");
                });

    }
} 
```

尝试添加迁移时出现以下错误：

> 为类型“S_Innovations.TrafficTheory.EFModel.Models.Identity”的属性“Id”指定了冲突的配置设置：DatabaseGeneratedOption = 与 DatabaseGeneratedOption 的身份冲突 = 无

# regex - 使用 htaccess 将深层链接 URL 重定向到新域

> ID：12591245
> 
> 赞同：0
> 
> 时间：2012-09-25T21:21:54.597
> 
> 标签：regex, .htaccess, url, redirect

例如，假设您当前托管了一个站点 www.domain.com，并且您要将其移至 www.new-domain.com。现在，目前您的博客结构是 www.domain.com/2012/09/post-name，而您的新博客结构将是 www.new-domain.com/blog/post-name。我知道我可以在 domain.com 上执行 301 永久重定向以指向 new-domain.com，但是有没有办法捕获长尾 URL 并使用 htaccess 重写正则表达式。通常我会这样做：

```
RedirectMatch 301 ^/([0-9]{4})/([0-9]{2})/(.*)$ http://domain.com/blog/$3 
```

如果我需要在同一个域中更改 URL 结构。这也会从旧域重定向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:50:15.063

我假设您有两个域都指向同一个目录，否则询问来自旧域的重定向没有任何意义。

如果您在新域文档根目录上进行了重定向，您将永远不会看到来自旧域的请求，反之亦然。

如果两个域共享同一个文档根目录，则需要对主机进行检查：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} domain.com$ [NC]
RewriteRule ^/?[0-9]{4}/[0-9]{2}/(.*)$ http://new-domain.com/blog/$1 [L,R=301] 
```

# ios - 让播客组合在一起

> ID：12591246
> 
> 赞同：2
> 
> 时间：2012-09-25T21:21:59.863
> 
> 标签：ios, podcast

我正在开发一个创建播客的应用程序。它们只是 .m4a 文件。但是，即使我在文件中设置专辑名称，当我将它们加载到设备上时，我似乎也无法将它们组合成一个播客。我还设置了艺术家、作曲家、流派、标题和其他几个字段。它们在 iTunes 中正确分组，但在 iPad 上似乎都集中在一个大的通用组中；这张专辑被忽略了。

是否需要设置特定标签，以便 iOS 将它们分组到 Podcast 应用程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T02:17:29.433

好吧，如果您正在谈论为 iOS 6 创建相当于播放列表的内容，那么新的 Podcast 应用程序目前不支持该功能。快速搜索显示*很多*人对此表示抱怨，所以我想说希望这个功能在未来的更新中再次可用。我希望我有更好的消息告诉你。

一些参考：

[https://discussions.apple.com/thread/4312284?start=0&tstart=0](https://discussions.apple.com/thread/4312284?start=0&tstart=0)

[https://discussions.apple.com/thread/4262881?start=30&tstart=0](https://discussions.apple.com/thread/4262881?start=30&tstart=0)

# git - 删除/删除行时如何查找提交？

> ID：12591247
> 
> 赞同：111
> 
> 时间：2012-09-25T21:22:00.963
> 
> 标签：git, git-log

我的 Git 存储库中的文件中有一个已删除的行。我知道一些丢失的文本，以及它所在的文件，所以我使用了`git log -S'missingtext' /path/to/file`.

但是，唯一回来的是我在其中添加了包含缺失文本的行的提交。该文本不存在于 HEAD 中，并且添加它的提交存在于我的分支中，因此我知道我的分支历史记录中的一个提交必须已将其删除，但它没有出现。

经过一些手动搜索，结果发现该行在解决合并冲突时被意外删除。所以我想知道：

1.  这就是镐找不到删除该行的提交的原因吗？
2.  如果不手动挖掘历史记录，我怎么能找到删除“missingtext”的位置？

对#1 的任何见解都会很棒（我认为这`git log -S`会给我答案），但我真正的问题是#2，因为我希望将来能够避免这种情况。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-09-25T21:47:56.123

`git log -c -S'missingtext' /path/to/file`

`git log`默认情况下不显示合并提交的差异。试试`-c`or`--cc`标志。

更多讨论/解释：
[https:](https://git-scm.com/docs/git-log)
[//git-scm.com/docs/git-log nabble.com](http://git.661346.n2.nabble.com/log-p-hides-changes-in-merge-commit-td5896280.html)

来自 git-log 文档：

> **-c**使用此选项，合并提交的差异输出同时显示每个父级与合并结果的差异，而不是一次显示父级与结果之间的成对差异。此外，它仅列出从所有父项修改的文件。
> 
> **--cc**该标志暗示了 -c 选项，并通过省略无趣的大块来进一步压缩补丁输出，这些小块的父项中的内容只有两个变体，并且合并结果选择其中一个而无需修改。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2017-04-18T04:37:34.127

超级用户对此有一个很好的答案： *[Git：我如何找到哪个提交删除了一行？](https://superuser.com/questions/541681)*

```
git blame --reverse START.. file.ext 
```

对于每一行，这将显示该行所在的最后一次提交——比如哈希 0123456789。接下来的下一个提交将是删除它的那个。使用`git log`并搜索哈希 0123456789，然后是它的后续提交。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-07T01:55:02.237

快速而肮脏的方式＃2 - 使用 for 循环。

```
for commit in $(git log --pretty='%H'); do
    git diff -U0 --ignore-space-change "$commit^" "$commit" | grep '^-.*missingtext' > /dev/null && echo "$commit"
done 
```

这将包括所有合并更改，因为它明确指定了差异的基本提交。我想出这个是因为`git log -c -S...`给了我一堆误报。此外，当我在初始命令中指定文件路径时`git log`，它跳过了我正在寻找的提交。

由于这可能会运行一段时间，因此如果您只需要 1 个结果，您可以`-n`在命令上指定或在循环末尾`git log`放置一个。`&& break`

# javascript - requestAnimationFrame 附加到 App 对象而不是 Window

> ID：12591250
> 
> 赞同：1
> 
> 时间：2012-09-25T21:22:21.317
> 
> 标签：javascript, html, canvas, requestanimationframe

我已经设置了以下 jsFiddle [http://jsfiddle.net/ZbhQY/4/](http://jsfiddle.net/ZbhQY/4/)

我使用了一个小的 requestAnimationFrame polyfill 并将结果返回给 window.reqeuestAnimFrame 这一切工作正常，并且对该函数的所有调用都按预期工作。

如果我将其更改为返回 game.reqeuestAnimFrame 并将所有对 window.reqeuestAnimFrame 的调用替换为新的 game.reqeuestAnimFrame 它不再起作用。

有人可以解释为什么会这样以及我能做些什么来完成这项工作吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:46:02.403

`requestAnimationFrame`必须有一个上下文`window`才能正常运行。

您可以将调用重写为：

```
game.requestAnimFrame.call(win, game.run); 
```

它将按预期运行。

您遇到的错误是因为`requestAnimationFrame`期望它的 context( `this`) 是`window`，但它的 context 是`game`。

[http://jsfiddle.net/ZbhQY/5/](http://jsfiddle.net/ZbhQY/5/)

或者，您可以像这样重写您的`requestAnimFrame`吸气剂：

```
game.requestAnimFrame = (function() {
        var rAF = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
        function(callback) {
            window.setTimeout(callback, 1000 / 60);
        };

        return function(callback){
            rAF.call(window, callback);
        };            
    })(); 
```

这将允许您按`game.requestAnimFrame(game.run)`预期调用。

# tomcat - 用于设置全局命名资源环境变量值的选项

> ID：12591257
> 
> 赞同：1
> 
> 时间：2012-09-25T21:22:43.703
> 
> 标签：tomcat, environment-variables, server.xml

我在 web.xml 中使用环境变量，它的值使用 cdata 部分，如下所示：

```
<env-entry> 
    <env-entry-name>myEntry</env-entry-name> 
    <env-entry-type>java.lang.String</env-entry-type> 
    <env-entry-value>
<![CDATA[
<a>
    <b/>
</a>
]]>
    </env-entry-value> 
</env-entry> 
```

我可以在我的 servlet 中读取此值并将字符串视为 XML。

现在我想在 Tomcat server.xml 中设置一个覆盖，但我只能使用属性设置值，即

```
<Environment name="myEntry" value="baz" type="java.lang.String" override="false"/> 
```

是否有一种解决方法可以让我使用 cdata 部分设置值？

我真正需要做的是为我的 Web 应用程序提供一些 XML 格式的配置。我希望能够在部署时更改此配置，并且我需要支持多个服务器（Tomcat、WebSphere，...）。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T02:31:51.810

Tomcat 支持来自系统属性的[Apache Ant](http://ant.apache.org/)样式变量替换：JVM 系统属性（内置/预定义和使用 -D 开关定义的），以及在`catalina.properties`. 从[Tomcat 7.0 配置概述](http://tomcat.apache.org/tomcat-7.0-doc/config/index.html)：

> 支持 Apache Ant 风格的变量替换；名称为 propname 的系统属性可以使用语法 ${propname} 在配置文件中使用。所有系统属性都可用，包括使用 -D 语法设置的属性、JVM 自动提供的属性以及在 $CATALINA_BASE/conf/catalina.properties 文件中配置的属性。

所以你可以添加

```
myValue=bar<with markup>baz 
```

然后：

```
<Environment name="myEntry" value="${myValue}" type="java.lang.String" override="false"/> 
```

# emacs - 如何让 SLIME 从加载的其他包中自动完成符号？

> ID：12591258
> 
> 赞同：2
> 
> 时间：2012-09-25T21:22:47.067
> 
> 标签：emacs, lisp, common-lisp, slime

我认为这曾经在 Emacs 23 中开箱即用，但在 24 中却没有。

所以，假设我有用 Quicklisp 加载的 Alexandria 包。例如，如果我`(apropos "curry")`在 REPL 中运行，它会找到函数定义，类似地，如果我运行`(describe 'curry)`等。但 SLIME 拒绝自动完成`(cur|`（点由管道显示）任何东西。

如何告诉 SLIME 在哪里寻找资源/它缺少什么？

**编辑：**

另外，如果我做`,``in-package``RET`ALEXANDRIA `RET`，它会自动完成，但我希望它会自动完成任何加载的包，而我不必指定要查看的包。或者没有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-30T16:31:54.737

据我所知，在 SLIME 中无法做到这一点。我不确定它是否实用，但通过查看完成和适当的实现方式并将它们混合在一个新功能中来实现它应该是可行的。用于切换完成样式的自定义变量的奖励积分。

[https://github.com/slime/slime](https://github.com/slime/slime)

# cocoa - 隐藏 NSView 溢出

> ID：12591261
> 
> 赞同：1
> 
> 时间：2012-09-25T21:22:54.150
> 
> 标签：cocoa, nsview, nswindow

我是一名网络开发人员。`overflow:hidden`CSS 属性告诉渲染引擎不要跨越父级的边界绘制当前视图的内容。

在我当前的项目中，我有一个自定义的 NSWindow，它通过使用、覆盖等来自定义`NSView`圆角。NSView 内部的A横跨整个框架。`NSMakeRect``drawRect:``WebView``NSView`

现在是`WebView 'overflows' the rounded corners of the`NSView`。我喜欢的是 WebView 与 NSView 具有相同的掩码。

你会怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:30:54.200

还要确保您的视图将剪辑子视图设置为 true。据我了解，这就是您要寻找的东西，并且可以防止 f.ex。图像以超出父视图。

```
[self.view setClipsToBounds:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:26:08.760

您可以为视图的图层设置角半径。

```
myView.layer.cornerRadius = 5.0f; 
```

您必须添加`QuartzCore.framework`.

# java - 无法让递归函数在 Java 中工作

> ID：12591264
> 
> 赞同：0
> 
> 时间：2012-09-25T21:23:13.990
> 
> 标签：java

我阅读了有关 java recorsion 的文档，我以为我已经理解了，但是当我尝试在以下示例中使用它时，它无法按预期工作。

我是一个类`account`，它有`amount`并且可以有其他子帐户。我会实现一种方法`getSum`，它必须返回账户金额和所有子账户金额的总和。在下面的代码中，该方法的调用`getSumm()`应该返回 550，但它的行为很奇怪。有人可以帮忙吗？

```
public class Balance{
    ArrayList<Balance> subAccounts = new ArrayList<Balance>();
    String accountID = null;
    Double amount = null;
    double result=0;
    public double getSum(ArrayList<Balance> subAccounts){

        if(subAccounts !=null && subAccounts.size()>0){
            for (int i = 0; i < subAccounts.size(); i++) {

            result = result + getSum(subAccounts.get(i).subAccounts);

            }
        }
            else {
                return amount;
            }

        return result;
    }

    public static void main(String[] args) {
        Balance bs1 = new Balance();
        Balance bs2 = new Balance();
        Balance bs3 = new Balance();

        bs1.amount=100.0;
        bs2.amount=150.0;
        bs3.amount=300.0;
        ArrayList<Balance> subAccounts1 = new ArrayList<Balance>();

        bs2.subAccounts=null;
        bs3.subAccounts=null;
        subAccounts1.add(bs2);
        subAccounts1.add(bs3);
        bs1.subAccounts=subAccounts1;
        double sum= bs1.getSum(subAccounts1);
        System.out.println(sum);

}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T21:33:33.560

您因未正确封装而使事情复杂化。这意味着您*必须*将*正确*的参数传递给`getSum(...)`，并且由于您可能会传递*错误*的参数，因此缺少封装与错误的参数相结合会确保错误的答案。

关键是停止*要求*调用*者*需要知道有关如何`getSum(...)`工作的任何信息。一个帐户应该能够在没有帮助的情况下计算自己的总和。毕竟，一个帐户应该已经拥有类中的数据，那么为什么需要其他人告诉它这些数据呢？

```
public class Account {

   // A list of subAccounts, each which
   // is responsible for its own value.
   private List<Account> subAccounts;

   // value in this account, not assigned
   // to subAccounts
   private double value;

   public double getSum() {
     double sum = this.value;
     for (Account account : subAccounts) {
       sum += account.getSum();
     }
     return sum;
   }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:31:22.760

您对 getSum 的终止条件之一是

```
return amount; 
```

其中*amount*是一个类作用域变量。这可能不是你想要的。您可能应该返回*result*。

此外，*结果*被定义为类作用域变量。getSum 应该是本地的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T21:33:05.257

你的逻辑有点不靠谱。

getSum 不应带参数，因为 subAccounts 成员变量已经是对象的一部分。

此外，您还在成员变量中收集内部总和。使用局部变量来避免问题。

正如每个人都已经说过的那样...确保您实际上没有为此使用递归。这只是演示如何使用recusion，这样就可以了。

这是更正后的程序：

```
import java.util.ArrayList;

public class Balance {
    ArrayList<Balance> subAccounts = new ArrayList<Balance>();
    String accountID = null;
    Double amount = null;

    public double getSum() {
        if (subAccounts != null) {
            Double sum = 0.0;
            for (int i = 0; i < subAccounts.size(); i++) {
                sum += subAccounts.get(i).getSum();
            }
            return amount + sum;
        } else {
            return amount;
        }       
    }

    public static void main(String[] args) {
        Balance bs1 = new Balance();
        Balance bs2 = new Balance();
        Balance bs3 = new Balance();
        bs1.amount = 100.0;
        bs2.amount = 150.0;
        bs3.amount = 300.0;
        ArrayList<Balance> subAccounts1 = new ArrayList<Balance>();
        bs2.subAccounts = null;
        bs3.subAccounts = null;
        subAccounts1.add(bs2);
        subAccounts1.add(bs3);
        bs1.subAccounts = subAccounts1;
        double sum = bs1.getSum();
        System.out.println(sum);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-25T21:35:23.847

这是一个工作的、更简单、更安全的版本：

```
public double getSum(){
    double result = this.amount;
    if(this.subAccounts !=null){
        for (Balance subAccount : this.subAccounts) {
            result = result + subAccount.getSum();
        }
    }
    return result;
} 
```

你用简单的方式调用它：`bs1.getSum()`。这个想法很简单直观：sum是金额+所有子账户金额的总和。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-25T21:31:46.073

请参阅 Nicholas 的答案以获得更完整的答案

尝试

```
double sum= bs1.getSum(bs1); 
```

这不直观..但会给你你想要的答案。您应该稍微重构一下 getSum() 以获得直观的功能。

此外，您需要将最后一次返回更改为：

```
 return result + amount; 
```

# c# - WebBroswer_DocumentCompleted 事件不起作用

> ID：12591265
> 
> 赞同：1
> 
> 时间：2012-09-25T21:23:15.810
> 
> 标签：c#, html, visual-studio-2010, bots

我有一个带有浏览器控件的表单。（此控件使用 IE9，因为我在注册表编辑器上设置了值）

此 Web 浏览器导航到特定 URL 并填写 HTML 页面上的所有字段并提交，然后显示结果页面。我的问题是我只想知道这个 reslut 页面何时完全加载或完成，以便我可以获取一些信息。我使用 WebBroswer_DocumentCompleted 事件，该事件适用于第一页，但不适用于结果页面，因为它在加载结果页面之前触发。

我尝试了其他解决方案，即检查结果页面内的 div 标签（此标签仅在结果页面完全加载时出现），它可以工作但并非总是如此。

我的代码：

```
private void WebBroswer_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    { 

        HtmlElementCollection elc3 = this.BotBrowser.Document.GetElementsByTagName("div");
        foreach (HtmlElement el in elc3)
        {
            if (el.GetAttribute("id").Equals("Summary_Views")) //this determine i am at the result page
            {
               // fetch the result
            }
        }} 
```

该 div id 是“Summary_Views”。我可以按需为您提供该网站的链接，该链接仅供 BLAST 工具和数据库网站用于研究目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:33:29.487

不知道有没有框架？如果是这样，请说出来，以便人们可以提供帮助。如果没有，那就这么说吧，这样人们就可以提供替代方案。

我的猜测是内容是由 JavaScript 生成的。如果是，那么文档在 JavaScript 执行之前就完成了，您需要以某种方式等到 JavaScript 完成。解决方案取决于网页。因此，您可能需要处理多个文档完成以进行诊断，并尝试确定是否有办法知道您需要哪个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:27:55.827

Frames 和 IFrames 将导致此事件多次触发。看看这个答案：
[HTML - 我如何知道所有帧何时加载？](https://stackoverflow.com/questions/672731/html-how-do-i-know-when-all-frames-are-loaded)

或者这个答案：
[How to use WebBrowser control DocumentCompleted event in C#?](https://stackoverflow.com/questions/840813/how-to-use-webbrowser-control-documentcompleted-event-in-c)

或者ms的kb文章：http: [//support.microsoft.com/kb/180366](http://support.microsoft.com/kb/180366)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T21:44:31.710

最后我解决了我的问题。我从工具箱中放置了一个计时器控件，并将其时间间隔设置为 200 毫秒，并将其 Autoreset 属性设置为 false。我设置了一个滴答事件，它的代码每 200 毫秒检查一次是否已加载此 Div，之后，自动重置属性设置为 true。此解决方案运行良好:)

# php - 语法错误意外 t_double_arrow yii 框架

> ID：12591266
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:23:19.333
> 
> 标签：php

我正在用 yii 框架做一个教程应用程序。当我尝试运行单元测试时，我在命令行中收到此错误

```
Parse error: syntax error, unexpected T_DOUBLE_ARROW in /Applications/MAMP/htdocs/trackstar/protected/tests/unit/ProjectTest.php on line 11 
```

这是我的代码。我没有在我的代码中发现问题。任何人都可以帮忙吗？

```
class ProjectTest extends CDbTestCase
{
    public function testCRUD()
    {
        //Create a new project
        $newProject=new Project;
        $newProjectName = 'Test Project 1';
        $newProject->setAttributes(
                ￼￼￼￼array(
                'name' => $newProjectName,
                'description' => 'Test project number one',
                'create_time' => '2010-01-01 00:00:00',
                'create_user_id' => 1,
                'update_time' => '2010-01-01 00:00:00',
                'update_user_id' => 1,
                )
                );
                $this->assertTrue($newProject->save(false));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:32:45.720

在您的“数组”关键字之前有某种不可打印的字符，只需删除那个就可以了

```
class ProjectTest extends CDbTestCase
{
    public function testCRUD()
    {
        //Create a new project
        $newProject=new Project;
        $newProjectName = 'Test Project 1';
        $newProject->setAttributes(
                ￼￼￼array(
                'name' => $newProjectName,
                'description' => 'Test project number one',
                'create_time' => '2010-01-01 00:00:00',
                'create_user_id' => 1,
                'update_time' => '2010-01-01 00:00:00',
                'update_user_id' => 1,
                )
                );
                $this->assertTrue($newProject->save(false));
    }
} 
```

你不会看到区别，但它就在那里

# mysql - 搜索字符串以查找行值 MYSQL

> ID：12591271
> 
> 赞同：0
> 
> 时间：2012-09-25T21:23:39.120
> 
> 标签：mysql

这是一个简单的问题，我确定我的措辞是否正确，以前在这里有人问过，但是我找不到...

所以......这是我的问题。

我有一个名字表：

```
+-----------+------------+
|   ID      |    NAME    |
+-----------+------------+
|   1       |    BOB     |
+-----------+------------+
|   2       |   NANCY    |
+-----------+------------+
|   3       |   FRED     |
+-----------+------------+ 
```

我想返回字符串中存在的行：

“Bob 和 Jane 去商店见 Fred” 将返回第 1 行和第 3 行。

在我的大脑中，`SELECT ID FROM names WHERE name IN('bob and jane went to the store to meet fred');`显然不是。什么是正确的查询类型？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:24:00.487

在 MySQL 中使用它

```
SELECT ID
FROM names
WHERE ' bob and jane went to the store to meet fred ' like concat('% ',name,' %') 
```

+ 运算符会将两边的操作数转换为数字，这实际上不是您想要的。另外，您是否希望 Boby 为 Bob 而返回 Frederick 为 Fred？如果没有，您需要在`concat`传入的字符串周围加上空格以进行搜索。

# ubuntu - 在 ubuntu 中启用 ipfw。找不到 loader.conf

> ID：12591280
> 
> 赞同：7
> 
> 时间：2012-09-25T21:24:27.193
> 
> 标签：ubuntu, ipfw

我正在尝试在我的 ubuntu 12.04 中启用 ipfw 实用程序。我正在按照手册页中给出的程序进行操作。

[http://manpages.ubuntu.com/manpages/hardy/man4/ipfw.4.html](http://manpages.ubuntu.com/manpages/hardy/man4/ipfw.4.html)

但是我找不到前面提到的 loader.conf 文件。我尝试使用系统范围的搜索

sudo find / -name loader.conf

没结果 。关于文件路径的任何想法。

最佳雅什

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-09-02T16:33:08.780

IPFW 主要是为 BSD 系统开发的，如果有 iptables 之类的选项，我不建议将它用于 Linux 系统。在现代 Ubuntu 发行版中，不再包含或支持该软件包。

话虽如此，免责声明：

`loader.conf`特指`/boot/loader.conf`，在 BSD 系统中，它是声明内核模块在启动时加载的地方。你的 Linux 系统不会有这个。在 Ubuntu 中，这些要声明的位置位于`/etc/modules`. 在此文件中只需添加一个包含“ipfw”的新行并重新启动。只要您已经安装了 ipfw（及其内核模块），就可以开始使用了。

# facebook - 如何获取其他人的页面帖子

> ID：12591284
> 
> 赞同：2
> 
> 时间：2012-09-25T21:24:49.570
> 
> 标签：facebook, facebook-graph-api, posts, fan-page

我需要从我的 Facebook 页面中提取“其他人的帖子”并将其显示在我的网站上。整个下午都在摆弄 API，并且能够看到该页面发布的帖子，但看不到其他帖子。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:36:26.867

史蒂夫，我刚刚找到了另一个解决方案，您可以使用 FQL 使用 Graph API。

只需拨打以下电话：

```
https://graph.facebook.com/fql?q=SELECT post_id, created_time , app_data, type, actor_id, target_id, message FROM stream WHERE  source_id = YOUR_PAGE_ID AND actor_id != YOUR_PAGE_ID&access_token=YOUR_ACCESS_TOKEN 
```

如果您需要更多变量，只需将它们放在 SELECT 之后，您可以在此处查看它们：[https ://developers.facebook.com/docs/reference/fql/stream](https://developers.facebook.com/docs/reference/fql/stream)

在 iOS 上，您**不需要将访问令牌放入查询中。**要检查如何使用最新的 iOS SDK 执行此操作，请在此处查看我的答案：[https ://stackoverflow.com/a/14357179/675486](https://stackoverflow.com/a/14357179/675486)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:46:32.773

明白了，它们与页面的帖子一起位于“提要”字段中。我希望能得到其他人的帖子，但我可以过滤掉页面发布的帖子。

# ruby-on-rails - 如何为特定环境的配置设置设置 YAML 文件

> ID：12591287
> 
> 赞同：2
> 
> 时间：2012-09-25T21:25:09.753
> 
> 标签：ruby-on-rails, configuration, yaml

目前，我有一个会话登录方法，它具有特定于环境的配置。

```
def log_in(user)
  cookies.permanent[:remember_token] = { :value => user.remember_token, :domain => :all }
end 
```

生产和开发之间的`:domain =>`区别。`:all``'lvh.me'`

如何设置一个 YAML 文件来加载特定于环境的配置，如[RailsCast #85](http://railscasts.com/episodes/85-yaml-configuration-file)所示？

我尝试了下面的代码，但回来了`unitialized constant RAILS_ENV`

**app_config.yml**

```
development:
  domain: lvh.me
test:
  domain: :all
production:
  domain:  :all 
```

load_app_config.rb

```
APP_CONFIG = YAML.load_file(::Rails.root.join('config','app_config.yml'))[RAILS_ENV] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T05:38:00.610

最后，我选择了：

```
APP_CONFIG = YAML.load_file("#{Rails.root}/config/app_config.yml")[Rails.env].symbolize_keys! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T05:42:16.223

查看[confu](https://github.com/underlog/confu) gem。这与您尝试执行的操作非常相似。

# java - 如何删除传递给 Java 方法的对象？

> ID：12591294
> 
> 赞同：0
> 
> 时间：2012-09-25T21:25:31.547
> 
> 标签：java, pointers, methods, reference

我知道Java通过引用传递对象，所以当一个对象作为参数传递给一个方法时，在方法内部对参数本地执行的任何操作都会对实际对象执行。

```
void main(){
 String[] array1 = {"a","b","c"};
 someMethod(array1);
 print(array1.length);
}

void someMethod(String[] array){
 /..code here../
 array = null;
} 
```

我希望在尝试打印 array1.length 时得到一个空指针异常，因为我的方法将它设置为空。然而，这并没有发生。是否有一个原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:26:52.997

对象通过**引用值**传递（按值传递）而不仅仅是引用。

当您设置`null`为 array in 时`someMethod()`，它从技术上将范围设置`someMethod`为`null`不是 in的数组`main`。

如果您也想`null`外部引用，那么就`return null`不要分配`null`.

我建议阅读此[线程](https://stackoverflow.com/questions/40480/is-java-pass-by-reference/73021#73021)以正确理解此概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:29:18.153

`array`在 someMethod 中只是另一个指向该对象的指针。因此，当您设置时`array = null;`，您只是将指针设置为空。该对象仍然存在于堆中，并且仍然由 array1 in 指向`main()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T21:30:14.307

数组*引用*按值传递。因此，您的方法会获取对数组的引用的副本。使用此引用，您可以更改数组的内容，但如果您更改引用本身 - 即您尝试将参数设置为`null`或新数组 - 更改*将不会*反映在方法之外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-25T21:30:19.677

当您`someMethod`使用参数调用时`array1`，该方法会传递一个对指向的数组的引用`array1`。本质上，现在有两个对同一个对象的引用——一个在`main`范围内，一个在`someMethod`范围内。如果您更改`array`为`someMethod`指向 null，这对原始引用没有影响。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-25T21:31:43.140

你一定来自 C++ :)

我们所说的“参考”实际上是指参考的*价值*。当一个对象被传递给一个方法时，它的引用被复制到堆栈中，所以当你设置时`array = null`，你实际上将堆栈本地设置`array`为`null`，而不是来自调用方法的实际引用。

做你想做的事情：

```
void main(){
    String[] array1 = new String[] {"a","b","c"};
    array1 = someMethod(array1);
    print(array1.length); // NullPointerException thrown here
}

String[] someMethod(String[] array){
    /..code here../
    return null;
} 
```

当您的数组开始用完空间并运行其垃圾收集器时，Java 将自动回收您的数组使用的空间。

将其视为类似于传递指针的副本而不是指针本身。正如您在示例中所观察到的，操作复制的指针不会更改原始指针。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-25T21:55:56.403

Java 传递引用的值，所以这个值指向引用。一旦我们改变了对象，那个对象就会改变。但是如果你在方法内部重新初始化它，那么真实的对象就不会改变；这是示例：

```
void main(){
    String[] array1 = new String[] {"a","b","c"};
    someMethod(array1);
    print(array1[0]); //you will see q
}

void someMethod(String[] array){
    array[0] = "q"; //i am NOT overriding it, I am changing the existing object

} 
```

这是我将重新初始化它

```
void main(){
    String[] array1 = new String[] {"a","b","c"};
    someMethod(array1);
    print(array1.length); //you will see 3
}

void someMethod(String[] array){
    array = null; //I am totally overriding the object, so it will not affect to the object inside main method.

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-25T21:29:25.830

您是对的-您在对象中更改的任何内容都将保留，但您不会更改被引用对象中的任何内容，而是引用本身就是一个值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-25T21:30:06.007

尝试：

```
void main(){
 String[] array1 = {"a","b","c"};
 someMethod(array1);
 print(array1[0].length());
}

void someMethod(String[] array){
 /..code here../
 array[0] = null;
} 
```

# visual-studio-2010 - 安装 SP1 和 TFS 预览后 Visual Studio 2010 崩溃

> ID：12591298
> 
> 赞同：0
> 
> 时间：2012-09-25T21:25:56.430
> 
> 标签：visual-studio-2010

我刚刚安装了 VS2010 SP1 和 TFS Preview-KB2581206，现在当我打开 Visual Studio 时，我收到一个错误，然后 Visual Studio 突然关闭。

我检查了事件查看器，并在那里发现了以下错误。

```
Fault bucket , type 0
Event Name: CLR20r3
Response: Not available
Cab Id: 0

Problem signature:
P1: devenv.exe
P2: 10.0.40219.1
P3: 4d5f2a73
P4: Microsoft.TeamFoundation.Common
P5: 10.0.0.0
P6: 4f4e3d34
P7: 4b6
P8: 45
P9: System.MissingMethodException
P10: 

Attached files:

These files may be available here:
C:\Users\Zain\AppData\Local\Microsoft\Windows\WER\ReportArchive\Critical_devenv.exe_efc7a99ad144611cef5e929f3abb3eb1973a0_103ff49b

Analysis symbol: 
Rechecking for solution: 0
Report Id: a8596dda-0755-11e2-ae04-0022196f9b63
Report Status: 0 
```

关于如何解决它的任何想法/解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-30T13:48:23.580

我仍然有一些问题，但这篇文章至少帮助我启动了视觉工作室：

[Visual Studio 2010 在启动时崩溃](https://stackoverflow.com/questions/13883371/visual-studio-2010-crashes-on-startup)

# php - php中的标头位置问题

> ID：12591306
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:26:10.743
> 
> 标签：php, oop, http-headers

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

```
 if ($_SERVER['REQUEST_METHOD'] == 'POST') 
    {   
include 'verify.php';
$verify = new Verify();
$vali = $verify->VerifyUserLogin($_POST['UserEmail'], $_POST['Password']);
if($_SESSION['umUser'] == true)
{
    header("Location: ../index.php");

}
else
{
    $errorLogin = $_SESSION['loginForm'];
}
    }

                    function VerifyUserLogin($userEmail, $password)
                {
            $this->connect();
            $pass = md5($password);
            $result = mysql_query("SELECT * FROM umuser where umUserIsAdmin = 1 and umUserEmail = '".mysql_real_escape_string($userEmail)."' and umUserPassword = '".mysql_real_escape_string($pass)."'");
            if (mysql_num_rows($result) > 0)
            {
        while($row = mysql_fetch_array($result))
        {
            $_SESSION['umAnanymousGid'] = $row['umUserGID'];
            $_SESSION['umUserName'] = $row['umUserName'];
            $_SESSION['umUserEmail'] = $row['umUserEmail'];
            $_SESSION['umUserId'] = $row['umUserID'];
            $_SESSION['umUser'] = true;
        }

        //echo $_SESSION['umUser'];
        //header('Location:../');

    } 
```

问题是它没有重定向到位置并生成警告警告：无法修改标头信息 - 标头已发送（输出开始于 ....）

请帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:41:49.650

你可以做：

```
<?php
ob_start();
/**
content of your page
*/
ob_end_flush();
?> 
```

或者您可以测试 $_SESSION 的长度（计数），如果它为空，那么任何会话都是打开的

# c# - 如何在 C# 中以火灾和忘记的方式在 sql 代理中触发作业

> ID：12591308
> 
> 赞同：0
> 
> 时间：2012-09-25T21:26:17.880
> 
> 标签：c#, sql-server, vb.net, ssis, service-broker

我们有一个 ssis pkg 需要 20 分钟才能完成。（生成 xl 报告）。用户要求能够通过参数控制此 pkg，因此我们有运行 pkg 的 winforms/c# gui。（直接来自 sql server。我们基本上调用一个存储过程来启动一个运行 ssis pkg 的 sql 作业）。到现在为止还挺好。现在用户希望在提交报告请求后注销，因为等待 20 分钟是没有意义的。（我们使用 citrix vdi。用户根据他们想要使用的应用程序登录到特定的 vdi，执行任务和注销）。我们有 90% 在那里，只是对于这个功能服务代理似乎是一个矫枉过正。我咨询了我们的 dba，到目前为止我们从未使用过服务代理。即使用户关闭了 winforms 应用程序并注销，是否有某种方法可以让 ssis pkg 运行。（基本上 sql 连接丢失，但 sql server 上触发的 ssis pkg 必须继续运行完成）。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:22:19.237

我们可以像这样在作业调用过程中添加包并让它运行

```
CREATE proc startjob
AS
begin
EXEC dbo.sp_start_job N'Weekly Sales Data Backup'
END 
```

# spring-mvc - 如何在 Spring MVC 中配置 EclipseLink MOXy？

> ID：12591309
> 
> 赞同：0
> 
> 时间：2012-09-25T21:26:18.727
> 
> 标签：spring-mvc, eclipselink, moxy

如何在 Spring MVC 中配置[**EclipseLink MOXy ？**](http://www.eclipse.org/eclipselink/moxy.php)我有三个配置文件——applicationContext.xml、rest-servlet.xml 和 rest-context.xml。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:32:11.207

这是我知道的一种方式 - 这是将 Moxy 注册为 JAXB 提供者，只需将一个`jaxb.properties`文件放在你有 JAXB 注释域类的包中，内容如下：

```
javax.xml.bind.context.factory = org.eclipse.persistence.jaxb.JAXBContextFactory 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T12:36:37.967

Spring 3.1.3 中增强了对 EclipseLink MOXy 的支持：[https ://jira.springsource.org/browse/SPR-9757?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab](https://jira.springsource.org/browse/SPR-9757?page=com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab)

# image - Unix：将 PDF 文件和图像组合成 PDF 文件？

> ID：12591314
> 
> 赞同：2
> 
> 时间：2012-09-25T21:27:08.193
> 
> 标签：image, macos, unix, pdf

我的朋友在问这个问题，他正在使用 Mac 并且无法使 PdfLatex 工作（没有开发 CD，[在此处](https://apple.stackexchange.com/questions/64501/compiling-latex-in-apple-products-is-something-like-pdflatex-around)相关）。无论如何，我的第一个想法：

> *   $ pdftk 1.pdf 2.pdf 3.pdf 猫输出 123.pdf **[仅 pdfs]**
> *   $ convert 1.png 2.png myfile.pdf **[仅图像]**

现在我不知道没有 LaTex 或 iPad 的 Notes Plus 如何组合图像和 PDF 文件。那么如何在 Unix 中组合 pdf 文件和图像呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:50:10.197

我在这里收集一些信息。

**Unix 命令行**

> 1.  更多关于 Pdftk[的信息在这里](http://www.pdflabs.com/docs/pdftk-cli-examples/)。
>     
>     
> 2.  [将png图像合并为一个pdf文件](https://stackoverflow.com/questions/4778635/merging-png-images-into-one-pdf-file-in-unix)
>     
>     
> 3.  [将文件夹中的所有文件合并为pdf](https://stackoverflow.com/questions/8156126/combine-all-files-in-a-folder-as-pdf)

**苹果电脑**

> 因为 Apple SE 中的版主删除了有用的线程*“在 Mac 中将 PDF 文件和图像合并到单个 PDF 文件？”* [在这里](https://apple.stackexchange.com/questions/65327/merge-pdf-files-and-images-to-single-pdf-file-in-mac) ——我在这里收集 Mac 的提示——对不起，版主对收集新手的东西非常不宽容。
> 
> > 1.  [https://apple.stackexchange.com/questions/16226/what-software-is-available-preferably-free-to-create-and-edit-pdf-files-on-mac](https://apple.stackexchange.com/questions/16226/what-software-is-available-preferably-free-to-create-and-edit-pdf-files-on-mac)
> >     
> >     
> > 2.  [https://apple.stackexchange.com/questions/812/how-can-i-combine-two-pdfs-in-preview](https://apple.stackexchange.com/questions/812/how-can-i-combine-two-pdfs-in-preview)
> >     
> >     
> > 3.  [https://apple.stackexchange.com/questions/11163/how-do-i-combine-two-or-more-images-to-get-a-single-pdf-file](https://apple.stackexchange.com/questions/11163/how-do-i-combine-two-or-more-images-to-get-a-single-pdf-file)
> >     
> >     
> > 4.  [https://apple.stackexchange.com/questions/69659/ipad-pdf-software-to-edit-merge-annotate-etc-well-pdf-documents-like-in-deskto](https://apple.stackexchange.com/questions/69659/ipad-pdf-software-to-edit-merge-annotate-etc-well-pdf-documents-like-in-deskto)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:50:53.753

您可以运行一个循环，识别 PDF 和图像，并使用 ImageMagick 将图像转换为 PDF。完成后，您可以使用 pdftk 组装所有内容。

这是一个仅限 Bash 的脚本。

```
#!/bin/bash

# Convert arguments into list
N=0
for file in $*; do
        files[$N]=$file
        N=$[ $N + 1 ]
done
# Last element of list is our destination filename
N=$[ $N - 1 ]
LAST=$files[$N]
unset files[$N]
N=$[ $N - 1 ]
# Check all files in the input array, converting image types
T=0
for i in $( seq 0 $N ); do
        file=${files[$i]}
        case ${file##*.} in
                jpg|png|gif|tif)
                        temp="tmpfile.$T.pdf"
                        convert $file $temp
                        tmp[$T]=$temp
                        uses[$i]=$temp
                        T=$[ $T + 1 ]
                        # Or also: tmp=("${tmp[@]}" "$temp")
                ;;
                pdf)
                        uses[$i]=$file
                ;;
        esac
done
# Now assemble PDF files
pdftk ${uses[@]} cat output $LAST
# Destroy all temporary file names. Disabled because you never know :-)
echo "I would remove ${tmp[@]}"
# rm ${tmp[@]} 
```

# opengl-4 - 模板缓冲区 - 理解 glStencilFuncSeparate

> ID：12591316
> 
> 赞同：1
> 
> 时间：2012-09-25T21:27:14.387
> 
> 标签：opengl-4

示例代码如下所示：

```
glEnable(GL_STENCIL_TEST);
glClearStencil(2);
glClear(GL_STENCIL_BUFFER_BIT);
glStencilFuncSeparate(GL_FRONT, GL_NOTEQUAL, 0, 1);
object.draw();
glDisable(GL_STENCIL_TEST); 
```

每个像素的模板缓冲区都有这个二进制值：00000010（8 位精度）接下来，glStencilFuncSeparate 进行以下逻辑操作：(00000000 & 00000001 = 00000000), (00000010 & 00000001 = 00000000) -> 00000000 != 00000000 测试失败并且不会绘制对象的正面。我们可以将掩码设置为例如 2 或 255，然后测试将通过。

如果 glStencilFuncSeparate 中的 Ref 参数是 257，那么将被钳制为 1。 1\. 掩码参数和钳制呢？2.提供的信息是正确的，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T02:23:48.440

你说：

> 每个像素的模板缓冲区都有这个二进制值：00000010（8 位精度）接下来，glStencilFuncSeparate 进行以下逻辑操作：(00000000 & 00000001 = 00000000), (00000010 & 00000001 = 00000000) -> 00000000 != 00000000 测试失败并且不会绘制对象的正面。

这是正确的。

> 我们可以将掩码设置为例如 2 或 255，然后测试将通过。

是的; *掩码*参数（第四个参数 to `glStencilFunc*`）与像素模板值的组合产生非零答案的任何值（前提是您不更改*ref*参数（第三个参数 to `glStencilFunc*`）将通过模板比较测试。

> 如果 glStencilFuncSeparate 中的 Ref 参数是 257，那么将被限制为 1。

实际上，没有。根据 OpenGL 规范和[`glStencilFunc*`参考页面](http://www.opengl.org/sdk/docs/man/xhtml/glStencilFunc.xml)，*ref*值被限制在 [0, 2 ^(*s*) - 1] 范围内，其中*s*是模板位数，因此在您的示例中，*ref*值将被限制为 255。

> 1\. 掩码参数和钳位呢？

仅使用*掩码的**s*最低有效位。模板比较功能真的是：

 *```
result = (pixel & (mask & (1<<s - 1))) <stencil func> (ref & (mask & (1<<s - 1))) 
```

> 2\. 提供的信息是正确的，对吧？

几乎。一点也不差:-)*

# html - JQueryMobile 1.1.1 列出未锚定到左侧的项目

> ID：12591320
> 
> 赞同：0
> 
> 时间：2012-09-25T21:27:23.137
> 
> 标签：html, css, jquery-mobile

我正在尝试创建一个简单的缩略图列表，代码几乎是从 jqm 文档页面复制而来的。但是，当我使用下面的代码时，列表的按钮元素并未锚定在列表项的左侧，而是居中显示...有人可以帮我吗？这让我疯狂！

除了 jquerymobile 默认页面模板中的样式之外，我没有任何样式

```
<div id="listDiv" class="ui-content" data-role="main">
    <div id="listInformation" data-role="content-primary">
        <ul id="swipeMeChildrenList" data-role="listview" class="ui-listview">
            <li data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="div" data-icon="arrow-r" data-iconpos="right" data-theme="c" class="ui-btn ui-btn-icon-right ui-li-has-arrow ui-li ui-btn-up-c">
                <div class="ui-btn-inner ui-li">
                    <div class="ui-btn-text">
                        <a href="index.html" class="ui-link-inherit">
                        <img src="images/album-p.jpg" class="ui-li-thumb">
                        <p>Ha</p>
                        </a>
                    </div>
                    <span class="ui-icon ui-icon-arrow-r ui-icon-shadow">&nbsp;</span>
                </div>
            </li>
        </ul>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:35:54.537

你用什么代码来生成你的列表？将指定一个简单的列表，如下所示：

```
 <ul data-role="listview">
        <li>
            <a href="index.html">
                <img src="images/album-p.jpg" />Ha
            </a>
        </li>
    </ul> 
```

jQuery Mobile 将负责根据平台添加所有必要的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:38:59.213

我建议打开一个新文档并使用该页面的默认值，即

```
<ul data-role="listview">
 <li><a href="index.html">
   <img src="images/album-bb.jpg" />
   <h3>Broken Bells</h3>
   <p>Broken Bells</p>
   </a></li>
</ul> 
```

然后，如果可行，请用您的代码逐段替换代码，直到它中断，这应该可以隔离问题。

# ruby-on-rails-3 - heroku db:push 上的 404 错误

> ID：12591322
> 
> 赞同：1
> 
> 时间：2012-09-25T21:27:54.313
> 
> 标签：ruby-on-rails-3, git, heroku, migration, taps

尝试通过 Taps 将数据库推送到 Heroku 时出现 404 错误

```
(1.9.2@[app_name]_db) heroku db:push --app [app_name]
Loaded Taps v0.3.24
Auto-detected local database: sqlite://db/development.sqlite3
Warning: Data in the app '[app-name]' will be overwritten and will not be recoverable.

 !    WARNING: Destructive Action
 !    This command will affect the app: [app-name]
 !    To proceed, type "[app-name]" or re-run this command with --confirm [app-name]

> [app-name]
Sending schema
Schema:          0% |                                          | ETA:  --:--:--
Saving session to push_201209251425.dat..
!!! Caught Server Exception
HTTP CODE: 404 
```

db:push 命令过去可以正常工作，然后我通过回滚迁移、编辑它们然后重新迁移来对我的数据库进行了一些更改。现在我可以很好地部署应用程序，但数据库不会推送——我不知道这是否与编辑迁移有关。

该应用程序在我的机器上运行良好，我想消除 Heroku 的副本与我自己的副本之间的任何差异，因此我创建了一个新应用程序并推送到该应用程序。同样的事情：Heroku 应用程序可以工作，但不会收到 db:push；它与上面相同的 404 错误。

这是 Heroku 服务暂时关闭，还是更改我的应用程序导致了 404？

编辑：heroku 日志不显示任何错误消息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T00:59:54.747

Heroku 支持响应时间过长，因此我找到了一种解决方法，可以使用 Taps gem 直接与我的 EC2 实例通信。

1.  转到您的数据库的 Heroku 仪表板。对我来说，这是在

    https://postgres.heroku.com/databases/[my-database-name]

    虽然我通过插件导航。

2.  单击“连接设置”中的“URL”，应该会给你类似的东西

    postgres://[username]:[password]@ec2-[ip_address_numbers].compute-1.amazonaws.com:[port]/[database_name]

    将此值复制下来，我将在此处将其引用为 [EC2_URL]

3.  如果您还没有安装 Taps，请在 1.9.2 gemset 上安装它（不确定 1.9.3 是否可以工作，没有测试）

4.  通过在终端中运行来设置 localhost taps 服务器以促进事务：

    点击服务器 postgres://[local_machine_username]@localhost/[name_from_database.yml] [some_username] [some_password]

    （注意用户名和密码前的空格）

5.  然后您可以通过另一个终端窗口自己处理交易：

    点击拉 [EC2_URL] http://[some_username]:[some_password]@localhost:5000

它应该运行并将所有数据从本地开发数据库拉到亚马逊实例。您也可以反之亦然，或者选择不同的数据库等。或者不是，我不是警察。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T15:11:57.970

heroku db 命令和 ruby​​ 1.9.2 存在一些问题（我有这个版本）。
db:pull 以“Unable to fetch tables information from”
结尾 db:push 以“!!! Caught Server Exception HTTP CODE: 404”结尾

有一个解决此问题的方法。暂时切换到 ruby​​ 1.8.7（我为此使用 rvm）只是为了在 heroku 上执行 db 操作，然后在完成切换 ruby​​ 后返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:49:56.550

我做了同样的过程（让 Heroku 将我的 sqlite 数据库转换为 Postgres），昨天我也遇到了这个问题。它现在似乎正在工作，所以我相信这是 Heroku 的问题。

# sql-server - 如何通过分页按计数排序？

> ID：12591324
> 
> 赞同：1
> 
> 时间：2012-09-25T21:27:56.043
> 
> 标签：sql-server

我必须将一些 SQL 从 PostgreSQL 迁移到 SQL Server (2005+)。在 PostgreSQL 上我有：

```
select count(id) as count, date
from table 
group by date 
order by count 
limit 10 offset 25 
```

现在我需要相同的 SQL，但用于 SQL Server。我像下面那样做了，但得到错误：`Invalid column name 'count'.`如何解决？

```
select * from (
   select row_number() over (order by count) as row, count(id) as count, date 
   from table 
   group by date
) a where a.row >= 25 and a.row < 35 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T21:32:39.480

您不能在同一范围内按名称引用别名，但*结尾* `ORDER BY`除外（它是同一范围内的窗口函数内部的无效引用）。

要获得完全相同的结果，可能需要将其扩展到（为了清晰起见，嵌套范围）：

```
SELECT c, d FROM 
(
  SELECT c, d, ROW_NUMBER() OVER (ORDER BY c) AS row FROM 
  (
    SELECT d = [date], c = COUNT(id) FROM dbo.table GROUP BY [date]
  ) AS x
) AS y WHERE row >= 25 AND row < 35; 
```

根据莫汉的回答，这可以缩短一点。

```
SELECT c, d FROM 
(
  SELECT COUNT(id), [date], ROW_NUMBER() OVER (ORDER BY COUNT(id))
   FROM dbo.table GROUP BY [date]
) AS y(c, d, row)
WHERE row >= 25 AND row < 35; 
```

在 SQL Server 2012 中，使用[OFFSET / FETCH](http://msdn.microsoft.com/en-us/library/ms188385.aspx)更容易- 更接近您习惯的语法，但实际上使用的是与 ANSI 兼容的语法，而不是专有的 voodoo。

```
SELECT c = COUNT(id), d = [date]
FROM dbo.table GROUP BY [date]
ORDER BY COUNT(id)
OFFSET 25 ROWS FETCH NEXT 10 ROWS ONLY; 
```

我[在 2010 年写了一篇关于这个功能的博客](https://sqlblog.org/2010/11/10/sql-server-v-next-denali-using-the-offset-clause-paging)（那里也有很多好的评论），可能应该花一些时间做一些严肃的性能测试。

我同意@ajon - 我希望你的真实表、列和查询不会像这样滥用保留字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T22:07:37.987

有用

```
DECLARE @startrow int=0,@endrow int=0

;with CTE AS (

select row_number() over ( order by count(id)) as row,count(id) AS count, date
from table
group by date 
)
SELECT * FROM CTE 
WHERE  row between @startrow and @endrow 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-25T21:32:44.510

我认为这会做到

```
select * from (
   select row_number() over (order by id) as row, count(id) as count, date 
   from table 
   group by date
) a where a.row >= 25 and a.row < 35 
```

另外，我不知道您使用的是什么版本的 SQL Server，但 SQL Server 2012 有一个新的[分页](http://www.sqlservergeeks.com/blogs/AhmadOsama/personal/457/sql-server-2012-%E2%80%9Cdenali%E2%80%9D-paging-feature)功能

# drupal - Tika 和 Solr Drupal 7 在 Cron 上建立索引

> ID：12591326
> 
> 赞同：2
> 
> 时间：2012-09-25T21:28:08.603
> 
> 标签：drupal, search, solr, attachment, apache-tika

使用 Drupal/Search API 模块/Solr/Tika，我们正在尝试索引大量文件。

我已经设置了索引并且一切正常，直到我包含搜索 API 附件模块。

当我们运行 cron 时，`tika`不会被调用。我们知道这一点是因为我们在 tika 模块的末尾放入了一段 PHP 代码来写入系统日志，并且该消息永远不会出现。手动运行索引时会显示。

此外，项目数索引在 cron 运行后不会增加。

我们还注意到，如果我们从命令行运行 tika，我们会在输出顶部收到以下错误：INFO - unsupported/disabled operation: EI

该索引按预期工作，无需选中该框以在 cron 和手动索引上索引附件。

知道问题可能是什么吗？

谢谢！

网站建立在：

*   德鲁巴 7

有问题的模块：

*   搜索 API
*   搜索 API 附件

索引：

*   阿帕奇索尔

索引附件使用：

*   蒂卡图书馆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:50:54.903

我也有同样的问题。但这似乎根本不是问题，因为文档似乎无论如何都被索引了。

我想这是一个 Tika 问题，因为有些文档（pdf）运行良好，有些则不行。也许这取决于pdf版本。尝试一些更简单的东西。IE 我写了一个示例文本，并在我的 mac 上使用 print to pdf 功能来获取一个简单的 pdf 文档。或者使用 Word 文档。我们还必须应用[真实路径补丁](http://drupal.org/node/1148162)来让 Tika 使用这些文件......并且[音译](http://drupal.org/project/transliteration)模块具有干净的文件名。对于调试 search_api，我使用来自 devel 的 dd()-function。在 search_api_solr/includes/solr_httptransport.inc performHttpRequest() 我 `dd($url); dd($options);`之前打电话`$response = drupal_http_request($url, $options);`（行：92）......希望这会有所帮助。

# php - Voxeo Prophecy- 我可以从服务器外部查询呼叫/线路状态吗？

> ID：12591327
> 
> 赞同：1
> 
> 时间：2012-09-25T21:28:09.787
> 
> 标签：php, ivr

我刚刚拿起别人的 IVR 项目，它在一个服务器（我可以访问）上使用 Voxeo Prophecy 的组合进行电话呼叫，它偶尔通过指向 Web 上 PHP 脚本的 URL 与另一台服务器上的现有数据库进行交互服务器。

当前的设置允许我通过传递 URL 来告诉 Prophecy 进行调用。我的问题是，我的网络服务器有什么方法可以确定这些调用的状态，例如，它可以告诉 Prophecy 在网络服务器的列表中进行下一个调用？

到目前为止，我发现的最接近状态报告的是：

```
http://127.0.0.1:9995/com.voxeo.prism.ext/getAllMIB 
```

但我什至不知道这是否给了我正确产品的状态报告；我用来拨打电话的 URL 如下所示：

```
http://127.0.0.1:9998/SessionControl/VoiceXML.start?params 
```

如果 prism mib 为我提供了正确的信息，那么解析它以获取调用数据对我来说不是问题，但我不知道调用数据的相关部分是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T12:24:42.183

虽然`myServer.com:9999/sessions_10`可以，但它不是用于轮询目的的推荐 API，而是您需要使用 stats_10 servlet。

例如，这将返回正在使用的端口数： [http ://docs.voxeo.com/prophecy/11.0/monitoringstats.htm?search=stats_10#anchor](http://docs.voxeo.com/prophecy/11.0/monitoringstats.htm?search=stats_10#anchor) `[http://myserver.com:9999/stats_10?&type=counters&format=value&value=CT/Allocated/Ports](http://myserver.com:9999/stats_10?&type=counters&format=value&value=CT/Allocated/Ports)`

此外，最常见的是，开发人员将通过来自应用程序的异步 http 调用通过其后端系统跟踪出站呼叫的状态，例如，出站呼叫正在进行、连接、失败或断开连接。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T23:29:32.633

看起来我需要的信息是来自 127.0.0.1:9999/sessions_10 的 Active CCXML10 会话

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:46:31.460

我建议您编写自己的 CCXML 来处理呼叫过程。[Voxeos 文档](http://docs.voxeo.com/ccxml/1.0-final/)中有很多关于 CCXML 的示例。请参阅 F 部分的“外拨”。您可以通过这种方式捕获很多事件。它还包括呼叫进度分析，以帮助确定您是否有电话答录机或人工。通过这种方式，您可以播放不同的消息，具体取决于您是否有活人，或者以不同的方式处理处理（没有意义提示机器做出响应）。您将获得的另一个事件是呼叫完成，因此您可以告诉 Web 服务器发送下一个呼叫。您可以使用“发送”标签基本上给您的应用程序一个回调，表明它已准备好进行下一次调用。

# jsf - 使用commandButton Primefaces 3.4从dataTable内部提交表单时selectOneMenu null

> ID：12591328
> 
> 赞同：0
> 
> 时间：2012-09-25T21:28:16.943
> 
> 标签：jsf, primefaces, selectonemenu

我在 dataTable 的页脚中有 selectOneMenu，我正在尝试将一堆页脚项目提交给支持 bean 以保存它们。请查看图片以了解。问题是当我使用也位于页脚 p:selectOneMenu 和 p:selectBooleanCheckbox 中的 commandButton 提交时，它们没有在支持中设置值并且它们为空。

[http://code.google.com/p/primefaces/issues/detail?id=4681](http://code.google.com/p/primefaces/issues/detail?id=4681)

请同时查看附件图像。

提前致谢

这是我的facelet中的代码：

```
 <p:dataTable id="dataTable" value="#{dataRoleBackingBean.dataRoleList}" var="dataRoleOb">
                        <p:column headerText="Security Group">
                                #{dataRoleOb.secGroupName}
                                <f:facet name="footer">
                                    <p:selectOneMenu id="tableSecGroupID" value="#{dataRoleBackingBean.tableSecGroupID}" style="width:90px">
                                            <f:selectItems value="#{dataRoleBackingBean.securityGroupList}" var="secGroup" itemLabel="#{secGroup.shortName}"
                                                itemValue="#{secGroup.secGroupId}" />
                                    </p:selectOneMenu>
                                </f:facet>
                        </p:column>

                        <p:column headerText="Remove">

                                <f:facet name="footer">
                                    <p:commandButton value="Add" update="@form" action="#{dataRoleBackingBean.addRow}"/>
                                </f:facet>

                        </p:column>

                    </p:dataTable> 
```

只是让您知道相同的代码适用于 primefaces 3.3.1 和 3.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T14:52:28.803

从 3.3.1 迁移到 3.4 时，我遇到了同样的问题。我试过使用 3.4.1，这也发生了。只需添加一件事，仅当 DataTable 已经有一行时才会发生这种情况。如果 DataTable 为空，则不会发生。调试时，属性的设置器被调用两次，第一次是正确的值，第二次是空值。

# visual-studio - 调试针对框架 4.0 的项目时会加载框架 4.5 程序集

> ID：12591336
> 
> 赞同：3
> 
> 时间：2012-09-25T21:29:04.673
> 
> 标签：visual-studio, visual-studio-2012, multitargeting

我需要能够使用 Visual Studio 2012 以 .NET Framework 4.0 为目标，并验证我的代码在部署到我们的 4.0 环境 (Windows Server 2003) 时是否能够正常工作。

Visual Studio 2012 中的多目标功能似乎可以正常工作，但仅适用于`mscorlib.dll`. 当引用任何其他框架 DLL 时，编译时会出现正确的错误，例如引用 4.0 中不存在的类型，但 DLL 的 4.5 版本在执行和调试期间加载。

考虑到 4.5 版本框架所做的就地升级中的重大更改，这使得无法验证我的代码是否可以在生产环境中正常工作。

[我做了一些单元测试，通过执行MSDN](http://msdn.microsoft.com/en-us/library/hh367887%28v=VS.110%29.aspx)上的 4.0 和 4.5 之间的一些差异来测试多目标功能。这些测试包含在他们自己的项目中，这些项目针对他们正在测试的框架版本。所有测试*都应该*通过。

## 针对 MSCORLIB 的测试

这些测试成功通过，`List<string>`位于`mscorlib.dll`：

**框架 4.0：** -通过-

```
[TestMethod]
public void List_Foreach_should_not_throw_if_list_is_modified() {
    var list = new List<string> { "This", "here", "be", "a", "list", "of", "strings" };

    list.ForEach((s) => {
        if (s.Equals("be", StringComparison.OrdinalIgnoreCase)) {
            list.Add(".");
        }
    });
} 
```

**框架 4.5：** -通过-

```
[TestMethod]
[ExpectedException(typeof(InvalidOperationException))]
public void List_Foreach_should_throw_if_list_is_modified() {
    var list = new List<string> { "This", "here", "be", "a", "list", "of", "strings" };

    list.ForEach((s) => {
        if (s.Equals("be", StringComparison.OrdinalIgnoreCase)) {
            list.Add(".");
        }
    });
} 
```

## 针对其他框架 DLL 的测试

然而，这些测试*不能*正常工作（4.5 一个通过，4.0 一个不通过），因为这些类型被发现`System.ComponentModel.Composition.dll`并且总是加载 4.5 版本：

**框架 4.0** - 失败，抛出 4.5- 预期的异常

```
[TestMethod]
public void Should_be_able_to_create_a_serializer_for_MEF_catalogs()
{
    var catalog = new AggregateCatalog();
    var serializer = new XmlSerializer(typeof(AggregateCatalog));
} 
```

**框架 4.5** -通过-

```
[TestMethod]
[ExpectedException(typeof(InvalidOperationException))]
public void Should_not_be_able_to_create_a_serializer_for_MEF_catalogs()
{
    var catalog = new AggregateCatalog();
    var serializer = new XmlSerializer(typeof(AggregateCatalog));
} 
```

这是设计好的吗？考虑到 mscorlib 的 4.0 版本已加载但每个其他程序集的 4.5 版本似乎是不相交的。

有没有办法获得我想要的功能？

**更新**

这是我正在使用的[解决方案/项目。](http://dl.dropbox.com/u/25634058/Test45Multitarget.zip)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:17:06.167

据我了解，这正是它应该如何工作的。您的计算机和 GAC 中没有 .NET 4.0。在运行时，您始终拥有 .NET 4.5，因为它是就地升级（安装 .NET 4.5 会覆盖 .NET 4.0）。引用的程序集和多目标仅适用于 IntelliSense、对象浏览器和 MSBuild（通常是设计时工具）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T02:10:15.463

感谢您的精彩再现！

在查看您的项目时，有两件事会影响您的结果，从而导致您看到的行为：

**1)**当我们检测到在 4.5 下运行的 4.0 应用程序时，我们“填充”更改 API 以返回旧的 4.0 行为，当我们认为它可以从合理（即非人为的）应用程序使用中观察到时。例如，依赖于在 List.ForEach 中修改列表的能力的 4.0 应用程序将继续看到 4.0 行为，无论是在 4.0 还是 4.5 下运行。4.5 应用程序将看到新的行为。

为了确定我们认为合理的使用方式，并指导我们填充的 API，我们有一个兼容性团队负责检查整个框架中的每一个“重大”更改，并将其与我们的一组规则和指南进行比较。在过去的 10 年里建立起来。

在您附加的项目中，您正在测试 5 件事：

*   4.5下的List.ForEach修改列表时抛出InvalidOperationException
*   Uri 低于 4.5 现在在路径分段中保留尾点
*   4.5以下的Uri不再逃逸？在基于 file:// 的 URI 中
*   4.5 下的 Enumerable.Empty 现在保证它返回相同的实例（这个在文档中有点误导[我已经提交了一个错误]，我相信行为是在 4.0 上，它可以在第一次返回两个不同的实例被多进程机器上的两个不同线程同时*访问*）
*   MEF 的目录不再是 XML 可序列化的

在这些行为中，前三个被填充以在 4.0 应用程序运行时返回 4.5 上的先前行为。然而，最后两个没有填充。这是因为最后两个更改会破坏非常人为的应用程序用法，在这种情况下，我们只是将它们记录在上面作为仅供参考。例如，更改 MEF 目录，虽然理论上您可以使用 XML 序列化程序序列化这些类型（这是无意的，恕我直言，这是 XML 序列化程序的可怕行为），但您无法对结果做任何事情，因为它没有对任何有用的东西进行反序列化。

如果我们可以修改该页面以包含为 4.0 应用程序填充的重大更改列表，我正在追赶。

**2)**我遇到的第二个问题是 4.0 测试项目与另一个基于 4.5 的测试项目在同一运行时被错误地检测为 4.5。您可以通过自己运行 4.0 测试来观察这一点，三个带垫片的测试将通过。将它们与 4.5 测试一起运行，它们会失败。我不确定这个问题在哪里发挥作用，但我已经在内部提交了一个错误，并与负责的团队启动了一个线程以深入了解它。如果您想在外部跟踪问题，请随时在[http://connect.microsoft.com/VisualStudio](http://connect.microsoft.com/VisualStudio)上提交错误，我们会将其发送给正确的所有者。

大卫·基恩

CLR 团队

# php - Jquery 将不同的 id 值传递给包含变量的通用函数

> ID：12591344
> 
> 赞同：2
> 
> 时间：2012-09-25T21:29:45.590
> 
> 标签：php, jquery

第一次来这里，先试试php/jquery

此代码正在运行：

```
$('#update1').click(function(){
    var name= $('#bandname-1').val();
    var bandid = $('#bid-1').val();
    var mbid = $('#mbid-1').val();
    $('#msg').text('updating...');
    $.post('func/update_bandname.php',{
        name: name,
        bandid: bandid,
        mbid: mbid
    }, function(data){
        $('#msg1').text(data);
    });
}); 
```

这是我的 php：-snip

```
echo "<td>";
echo "<input type=\"text\" name=\"bandname-".$i."\" id=\"bandname-".$i."\" value=\"".$name ."\"/>&nbsp;";
echo "<input id=\"update".$i."\" type=\"button\" name=\"update".$i."\" value=\"update\" class=\"dp\"/>";
echo "<span id=\"msg".$i."\"></span><input type=hidden id=\"bid-".$i."\" value=\"".$_REQUEST[bid] ."\" name=bid-".$i."\" />";
echo "<input type=hidden id=\"mbid-".$i."\" value=\"".$bandid."\" name=mbid-".$i."\" />";
echo "</td>";
echo "</tr>";
$i++; 
```

数据库将大量记录返回到该表中，我创建了 5 个函数 update1、update2 等

有没有办法修改我的 jquery 以将不同的 id 值传递给一个函数？而不是一遍又一遍地复制函数？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:34:19.077

您可以使用[以 selector 开头的属性](http://api.jquery.com/attribute-starts-with-selector/)：

```
$('input[id^=update]').click(function() {
   var id = this.id.match(/\d+/g).join('');
   var name= $('#bandname-'+id).val();
   var bandid = $('#bid-'+id).val();
   var mbid = $('#mbid-'+id).val();
   $('#msg').text('updating...');
   $.post('func/update_bandname.php', {
            name: name,
            bandid: bandid  ,
            mbid:mbid
   }, function(data) {
            $('#msg'+id).text(data);
   });
}); 
```

但最好使用类而不是 ID。

```
$('.update').click(function() {
   var $this = $(this);
   var name = $this.siblings('.bandname').val();
   var bandid = $this.siblings('.bid').val();
   var mbid = $this.siblings('.mbid').val();
   $('#msg').text('updating...');
   $.post('func/update_bandname.php', {
            name: name,
            bandid: bandid  ,
            mbid:mbid
   }, function(data) {
            $this.siblings('.msg').text(data);
   });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:41:07.790

`data-`为每个元素分配一个公共类和属性：

PHP：

```
echo '<input class="updatebutton dp" data-idnum="'.$i.'" id="update'.$i.'" type="button" name="update'.$i.'" value="update">'; 
```

JS：

```
$('.updatebutton').click(function() {
   var id = $(this).data('idnum'),
       name= $('#bandname-'+id).val(),
       bandid = $('#bid-'+id).val(),
       mbid = $('#mbid-'+id).val();
   $('#msg').text('updating...');
   $.post('func/update_bandname.php', {
            name: name,
            bandid: bandid  ,
            mbid:mbid
   }, function(data) {
            $('#msg'+id).text(data);
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:42:26.843

JS：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
$(function() {
  $('form').submit(function(data) {
    $.post('func/update_bandname.php', $(this).serialize(), function(data) {
       $('#msg1').text(data);
    });
  });
});
</script> 
```

PHP：

```
echo "<tr>";
echo "<td>";
echo "<form>";
echo "<input type=\"text\" name=\"bandname-".$i."\" id=\"bandname-".$i."\" value=\"".$name ."\"/>&nbsp;";
echo "<input id=\"update".$i."\" type=\"button\" name=\"update".$i."\" value=\"update\" class=\"dp\"/>";
echo "<span id=\"msg".$i."\"></span><input type=hidden id=\"bid-".$i."\" value=\"".$_REQUEST[bid] ."\" name=bid-".$i."\" />";
echo "<input type=hidden id=\"mbid-".$i."\" value=\"".$bandid."\" name=mbid-".$i."\" />";
echo "</form>";
echo "</td>";
echo "</tr>";
$i++; 
```

# python - 数据抓取，aspx

> ID：12591348
> 
> 赞同：0
> 
> 时间：2012-09-25T21:29:54.403
> 
> 标签：python, web-crawler

在使用 Python 之前，我已经编写了网络爬虫，但我正在抓取的页面到目前为止一直对我的努力有抵抗力。我正在使用 Python 和 BeautifulSoup 从网站上抓取数据。我这样做的方式有两个步骤：生成要索引的页面列表，然后解析这些页面。解析部分很简单，但我还没有弄清楚如何将 .aspx 页面导航到以便可以使用 Python 生成链接。我目前可以手动保存搜索页面以抓取它们，但如果可能的话，我想自动化整个过程。

有问题的页面： http: [//cookcountyassessor.com/Property_Search/Property_Search.aspx](http://cookcountyassessor.com/Property_Search/Property_Search.aspx)

我需要使用表单来选择一个 Township，然后是 Neighborhood 和 Property Class，通过几个 .aspx 文件来获得搜索结果。我使用 BeautifulSoup 获取所有标签的列表作为表单数据提交，修改了我需要提交的字段，并发送了请求，但是当我打开下一页时它没有给我预期的结果（http:// www.cookcountyassessor.com/Property_Search/nbhd_search.aspx?town=19）。

我正在构建的类的相关代码：

```
self.jar = http.cookiejar.CookieJar()
self.opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(self.jar))

self.page = ['http://cookcountyassessor.com/Property_Search/Property_Search.aspx']
self.page = self.page + ['http://cookcountyassessor.com/Property_Search/nbhd_search.aspx?town=19'] #Lemont
soup = BeautifulSoup(self.opener.open(self.page[0]))
inputs = soup.findAll("input") + soup.findAll("select")
params = {"__EVENTTARGET": "", "__EVENTARGUMENT": "", "__LASTFOCUS": ""}
for i in inputs:
    try:
        params[i['name']] = i['value']
    except:
        params[i['name']] = ''
params['ctl00$BodyContent$town1'] = self.code
self.params = params
params = urllib.parse.urlencode(params)
params = params.encode()
self.opener.open(self.page[0], params)
self.page1 = BeautifulSoup(self.opener.open(self.page[1])) 
```

当我手动提交表单时，.aspx 页面似乎设置了一些 cookie，然后使用标题重定向到不同的页面。使用 Python 提交，我的 jar 中没有 cookie，并且页面似乎不接受我的帖子数据。我是否在这里遗漏了什么，或者这将是一种难以驾驭的皇家痛苦？我想我会开始插入标题，看看它是否能让我到任何地方......

# spring - Spring with Aspectj Load-time weaving，方面未在集成测试中执行

> ID：12591353
> 
> 赞同：2
> 
> 时间：2012-09-25T21:30:21.737
> 
> 标签：spring, aspectj, junit4

所以我正在尝试对现有代码进行一些集成测试，并且需要模拟一个私有方法返回。所以我想我会给 AspectJ LTW 一个尝试，并将 Around 建议编织到私有方法中，并让建议执行切入点忽略响应，然后发送我自己的响应。

我通过 jUnit 测试执行此操作。我正在分叉执行，所以我可以传入 javaagent。

```
 <target name="test-integration" depends="compile-test">
    <echo message="========================================" />
    <echo message=" Executing target test-integration" />
    <echo message="========================================" />
    <delete dir="${test.report.dir}" failonerror="false" />
    <mkdir dir="${test.report.dir}" />
    <junit printsummary="yes" fork="yes" haltonfailure="yes" haltonerror="yes" showoutput="yes" >
        <jvmarg value="-javaagent:${spring.instrument.jar}" />
        <classpath>
            <pathelement location="${classes.test.dir}" />
            <pathelement location="${classes.dir}" />
            <path refid="test.run.classpath" />
            <path refid="compile.classpath" />
            <pathelement location="${test.resources}" />
        </classpath>
        <formatter type="plain" />
        <batchtest fork="yes" todir="${test.report.dir}">
            <fileset dir="${classes.test.dir}">
                <include name="com/test/integrationtest/*IntegrationTest*" />
                <exclude name="**/*$*" />
            </fileset>
        </batchtest>
    </junit>
</target> 
```

并设置了 aop.xml 文件

```
<aspectj>
<weaver options="-verbose">
    <include within="com.services.*" />
    <dump within="com.services.*"/>
</weaver>
<aspects>
    <aspect
        name="com.test.integrationtest.MockMethodReturnIntercepter" />
</aspects> 
```

生成的日志看起来一切正常。

> [junit] INFO [main] (DefaultContextLoadTimeWeaver.java:73) - 找到 Spring 的用于检测的 JVM 代理 [junit] [AppClassLoader@12360be0] 信息 AspectJ Weaver 版本 1.6.11 构建于 2011 年 3 月 15 日星期二格林威治标准时间 15:31:04 [junit] [AppClassLoader@12360be0] info register classloader sun.misc.Launcher$AppClassLoader@12360be0 [junit] [AppClassLoader@12360be0] info using configuration file:/C:/dev/EntSvc/workspaces/Default/Master/jars/org .springframework.aspects-3.0.5.RELEASE.jar!/META-INF/aop.xml [junit] [AppClassLoader@12360be0] info using configuration /C:/dev/EntSvc/workspaces/Default/Monitors/test/resources/ META-INF/aop.xml [junit] [AppClassLoader@12360be0] info register aspect org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect [junit] [AppClassLoader@12360be0] info register aspect org.springframework.scheduling.aspectj.AnnotationAsyncExecutionAspect [junit] [AppClassLoader@12360be0] 信息注册方面 org.springframework.transaction.aspectj.AnnotationTransactionAspect [junit] [AppClassLoader@12360be0] 信息注册方面 com.test.integrationtest.MockMethodReturnIntercepter [junit] [AppClassLoader @12360be0] 警告 javax.* 类型没有被编织，因为未指定编织器选项“-Xset:weaveJavaxPackages=true”* 未编织类型，因为未指定编织器选项“-Xset:weaveJavaxPackages=true”* 未编织类型，因为未指定编织器选项“-Xset:weaveJavaxPackages=true”

但是在执行过程中似乎没有任何结果，因为我看不到任何日志记录或我的 Aspect 的结果

```
@Aspect
public class MockMethodReturnIntercepter
{
    private final Log log = LogFactory.getLog(getClass());
private Object    returnVal;

@Around("methodsToMockReturn()")
public Object mockMethodReturn(ProceedingJoinPoint pjp) throws Throwable
{
    log.info("mockMethodReturn(ProceedingJoinPoint pjp)");
    // Go ahead and let it do whatever it was trying to do but just modify the return value
    pjp.proceed();
    log.info("mockMethodReturn(ProceedingJoinPoint pjp) RETURNING:" + returnVal);
    return "QM_H3385R1";
}

public Object getReturnVal()
{
    return returnVal;
}

public void setReturnVal(Object returnVal)
{
    this.returnVal = returnVal;
}

@Pointcut("execution(private * com.services.common.integration.MessageSenderDaoImpl.*(..))")
public void methodsToMockReturn()
{
} 
```

}

正如你所看到的，我正在选择一个特定的类来编织建议，并选择它的私有方法来模拟响应。

最后但并非最不重要的是我添加了

```
<context:load-time-weaver/> 
```

到加载到 ClassPathXmlApplicationContext 的第一个上下文文件

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T15:04:17.853

好吧，感谢添加

```
 <!--jvmarg value="-Dorg.aspectj.weaver.showWeaveInfo=true" />
        <jvmarg value="-Daj.weaving.verbose=true" />
        <jvmarg value="-Dorg.aspectj.tracing.enabled=true" />
        <jvmarg value="-Dorg.aspectj.tracing.factory=default" /--> 
```

对于 ant junit 配置和更多的注销，aspectJ 配置正在工作，但看起来 Spring 实际上也需要编织 Aspect 以便它可以访问它。在我将 MockMethodReturnIntercepter 的包添加到编织器之前，我得到了方法 aspectOf() 的 MethodNotFound 异常。

```
<include within="com.test.integrationtest.*" /> 
```

这样做之后，一切都很好。显然这是 Spring 3.x [http://forum.springsource.org/showthread.php?101447-Aspect-is-not-being-called-while-testing-with-JUnit的新特性](http://forum.springsource.org/showthread.php?101447-Aspect-is-not-being-called-while-testing-with-JUnit)

# c++ - 什么是 XcvPort（用于 OpenPrinter 功能）

> ID：12591358
> 
> 赞同：2
> 
> 时间：2012-09-25T21:31:11.303
> 
> 标签：c++, winapi

我正在使用 OpenPrinter 函数，该函数的第一个参数被称为“pPrinterName”，这就是它的 MSDN 描述：

> [在] 指向以 null 结尾的字符串的指针，该字符串指定打印机或打印服务器的名称、打印机对象、XcvMonitor 或 XcvPort。对于打印机对象，请使用：PrinterName,Job xxxx。对于 XcvMonitor，使用：ServerName,XcvMonitor MonitorName。**对于 XcvPort，使用： ServerName,XcvPort PortName**。

显然我对粗体部分感兴趣。XcvPort 到底是什么？我知道这似乎是一个懒人的问题，但我真的找不到关于这个概念的信息。如果我想在端口 ABC 上打开打印机，我应该写：“ **\\MySrever,XcvPort ABC** ”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:12:40.510

非常接近，只需添加一个反斜杠：

```
[DllImport("winspool.drv", EntryPoint = "OpenPrinter", SetLastError = true)]
    internal static extern bool OpenPrinter(string pPrinterName, ref IntPtr phPrinter, PRINTER_DEFAULTS pDefault);

[DllImport("winspool.drv", EntryPoint = "ClosePrinter", SetLastError = true)]
    internal static extern int ClosePrinter(IntPtr hPrinter);

public struct OpenPrinterAccessCodes
{
    public const int DELETE = 0x10000; // DELETE - Allowed to delete printers
    public const int READ_CONTROL = 0x20000; // READ_CONTROL - Allowed to read printer information
    public const int WRITE_DAC = 0x40000; // WRITE_DAC - Allowed to write device access control info
    public const int WRITE_OWNER = 0x80000; // WRITE_OWNER - Allowed to change the object owner
    public const int SERVER_ACCESS_ADMINISTER = 0x1;
    public const int SERVER_ACCESS_ENUMERATE = 0x2;
    public const int PRINTER_ACCESS_ADMINISTER = 0x4;
    public const int PRINTER_ACCESS_USE = 0x8;
    public const int STANDARD_RIGHTS_REQUIRED = 0xF0000;
    public const int PRINTER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | PRINTER_ACCESS_ADMINISTER | PRINTER_ACCESS_USE);
    public const int SERVER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | SERVER_ACCESS_ADMINISTER | SERVER_ACCESS_ENUMERATE);

    public const int MAX_PORTNAME_LEN = 64;
    public const int MAX_NETWORKNAME_LEN = 49;
    public const int MAX_SNMP_COMMUNITY_STR_LEN = 33;
    public const int MAX_QUEUENAME_LEN = 33;
    public const int MAX_IPADDR_STR_LEN = 16;

    public const int ERROR_INSUFFICIENT_BUFFER = 122;
    public const int ERROR_INVALID_FLAGS = 1004;
}
var def = new PRINTER_DEFAULTS { pDatatype = null, pDevMode = IntPtr.Zero, DesiredAccess = OpenPrinterAccessCodes.SERVER_ACCESS_ADMINISTER };
var hPrinter = IntPtr.Zero;
OpenPrinter(@"\\MyServer\,XcvPort ABC", ref hPrinter, def)
ClosePrinter(hPrinter); 
```

# java - 获取组件的背景图片（从父级较大的背景图片“继承”）并使其透明

> ID：12591360
> 
> 赞同：1
> 
> 时间：2012-09-25T21:31:17.633
> 
> 标签：java, swing, graphics, transparent, bufferedimage

假设我有一个 JPanel，上面通过 绘制了一个图像作为背景`paintComponent()`，这个面板包含一些带有图标的按钮。这些按钮没有自己的背景，并且“继承”了面板的背景。我知道如何使用 使按钮的图标半透明`AlphaComposite`，但我怎样才能获得按钮的背景图像（这是JPanel 背景图像的***一部分***，因为按钮是不透明的并且被绘制在面板的背景上）并使其透明，而不是图标？我什至不知道这是否可能......

以下代码只是使按钮的图标透明。

```
import java.awt.AlphaComposite;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;

import java.awt.Graphics2D;

import java.awt.image.BufferedImage;

import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;

import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class TestPanel extends JPanel {

    private final ImageIcon icon = new ImageIcon(getClass().getResource("path\\to\\image\\file"));
    private BufferedImage img;

    public TestPanel() {

        try {
            img = ImageIO.read(new File("path\\to\\background\\image"));
        } catch (IOException ex) {}

        ImageIcon fadedIcon = getTranslucentImageIcon(icon, 0.5f);
        JButton button = new JButton(fadedIcon);
        button.setRolloverIcon(icon);
        button.setBorder(BorderFactory.createLineBorder(Color.BLACK));
        button.setOpaque(false);
        button.setContentAreaFilled(false);
        button.setFocusPainted(false);
        this.add(button);
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(img, 0, 0, null);
    }

    @Override
    public Dimension getPreferredSize() {
        if (img != null) {
          return new Dimension(img.getWidth(), img.getHeight());
        }
        return super.getPreferredSize();
    }

    private BufferedImage getTranslucentImage(BufferedImage oldImg, float alpha) {
        int w = oldImg.getWidth();
        int h = oldImg.getHeight();
        BufferedImage newImg = new BufferedImage(w, h, BufferedImage.TRANSLUCENT);
        Graphics2D g2d = newImg.createGraphics();
        g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, alpha));
        g2d.drawImage(oldImg, null, 0, 0);
        g2d.dispose();
        return newImg;
    }

    private ImageIcon getTranslucentImageIcon(Icon oldIcon, float alpha) {
        int w = oldIcon.getIconWidth();
        int h = oldIcon.getIconHeight();
        BufferedImage oldImg = new BufferedImage(w, h, BufferedImage.TRANSLUCENT);
        Graphics2D g2d = (Graphics2D) oldImg.getGraphics();
        oldIcon.paintIcon(null, g2d, 0, 0);
        BufferedImage newImg = getTranslucentImage(oldImg, alpha);
        g2d.dispose();
        return new ImageIcon(newImg);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame frame = new JFrame();
                frame.add(new TestPanel());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
            }
        });
    }

} 
```

您只需要 2 张图像来重现它（背景图像应该更大以使我的观点更清楚）。

PS我还想知道我是否正确地做整个事情（更具体的方法`getTranslucentImage`和`getTranslucentImageIcon`），或者是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:56:23.100

我会把它放在这里，因为注释不适合格式化。

至于你的“半透明”方法，它们对我来说似乎很好。我可能做的唯一改变是创建一个兼容的缓冲图像。这将（除其他外）确保颜色模型相同并使其渲染速度更快......

```
protected BufferedImage createCompatibleImage(int width, int height, int transparency) {
    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    GraphicsDevice gs = ge.getDefaultScreenDevice();
    GraphicsConfiguration gc = gs.getDefaultConfiguration();
    return gc.createCompatibleImage(width, height, transparency);
}

private BufferedImage getTranslucentImage(BufferedImage oldImg, float alpha) {
    int w = oldImg.getWidth();
    int h = oldImg.getHeight();
    BufferedImage newImg = createCompatibleImage(w, h, Transparency.TRANSLUCENT);
    Graphics2D g2d = newImg.createGraphics();
    g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, alpha));
    g2d.drawImage(oldImg, null, 0, 0);
    g2d.dispose();
    return newImg;
} 
```

**更新了扩展答案**

我为了实现你想要的，你需要一个干净的父组件版本。那是没有任何孩子的副本。然后，您需要调整大小并将此副本绘制到屏幕外缓冲区（如缓冲图像），然后提取您想要的图像部分（或根据您的要求绘制子图像）。

坦率地说。你正在做的只是更容易......

# iphone - 声音在 iOS 模拟器上播放，但不在已发布的应用程序上播放

> ID：12591365
> 
> 赞同：0
> 
> 时间：2012-09-25T21:31:37.533
> 
> 标签：iphone, audio

我制作了一个使用声音的应用程序，它在模拟器上播放得很好，当我在我的 iPhone 上测试它时，但是当人们从 App Store 下载它时，声音就无法播放。关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T07:00:39.533

检查 ipa 文件 - 有音频文件吗？之后，您还可以检查音频文件是否已添加到当前活动的目标中。

# javascript - 确定属性是否是 Chrome/Firefox 中的本机 DOM 属性

> ID：12591371
> 
> 赞同：0
> 
> 时间：2012-09-25T21:32:11.023
> 
> 标签：javascript, firefox, google-chrome

我需要区分对象上的“纯”JavaScript 属性和像`innerHTML`or之类的本机属性`style`。

在 Safari 中，我可以使用`Object.getOwnPropertyDescriptor()`并检查该`configurable`属性（对于特殊属性为 false），但是不幸的是，这在 Chrome 或 Firefox 上没有相同的结果（返回属性是可配置的）。

在不同的浏览器上尝试[这个小提琴](http://jsfiddle.net/ynCQy/1/)以查看问题。

是否有可靠的方法来确定该财产是否为特殊的内部财产？

**更新**

我注意到，`undefined`如果您尝试获取本机属性的属性描述符，Firefox 实际上会返回，因此这可能会正常工作。剩下的就是 Chrome，不幸的是它返回了一个看起来与普通属性完全一样的属性描述符。

例如，这是`innerHTML`Chrome 中的描述符：

```
{"value":"","writable":true,"enumerable":true,"configurable":true} 
```

...这里是一个名为“test”的空字符串属性：

```
{"value":"","writable":true,"enumerable":true,"configurable":true} 
```

完全相同的。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:18:47.103

您必须检查该属性是否在相关 DOM 元素的新创建实例上定义：

```
'innerHTML' in (document.createElement('div')); //yes 
```

测试它的函数可能如下所示：

```
var test = function (elem, prop) {
    return prop in (typeof elem === 'string' ? document.createElement(elem) : elem)
}

console.log( test( 'div', 'innerHTML') );
console.log( test( document.getElementsByTagName('body')[0], 'innerHTML') );
console.log( test( document.getElementsByTagName('body')[0], 'monkey') );​ 
```

# javascript - 通过 ajax 发布请求似乎无法正常工作

> ID：12591373
> 
> 赞同：0
> 
> 时间：2012-09-25T21:32:25.677
> 
> 标签：javascript, ajax, forms, post

我有通过 ajax 管理的帖子发出请求的表单。但是，它似乎根本不起作用。我知道 php 文件可以正常工作，因为我没有在中间使用 ajax。

这是我的ajax请求：

```
function checkOut(params) {
    var urlString = params;
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4 && xmlhttp.status==200) {
            document.getElementById("test").innerHTML=xmlhttp.responseText;
        }
       //Setup for post submission  
       xmlhttp.open("POST","mockcheckout.php",true);
       xmlhttp.setRequestHeader("Content-length", params.length);
       xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

       xmlhttp.send(urlString); 

    }

} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:39:34.060

看起来你的代码块有问题。`.open`,`.send`应该在`onreadystatechange`处理程序范围之外。

```
function checkOut(params) {
    var urlString = params;
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4 && xmlhttp.status==200) {
            document.getElementById("test").innerHTML=xmlhttp.responseText;
        }
    }
    //Setup for post submission  
    xmlhttp.open("POST","mockcheckout.php",true);  
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");  
    xmlhttp.send(urlString);     
} 
```

# uikit - UIBarButtonItem -appereanceWhenContainedIn: 和自定义 UINavigationBar 子类

> ID：12591374
> 
> 赞同：2
> 
> 时间：2012-09-25T21:32:38.507
> 
> 标签：uikit, ios6, ios

我正在使用新的 API`UINavigationController`来使用自定义`UINavigationBar`：

```
- (id)initWithNavigationBarClass:(Class)navigationBarClass toolbarClass:(Class)toolbarClass. 
```

路过`[MyNavigationBar class]`。

然后我在做：

```
[UIBarButtonItem appearanceWhenContainedIn:[MyNavigationBar class], nil]; 
```

要自定义`UIBarButtonItems`a 中的内容`MyNavigationBar`，这是在导航控制器中使用标准设置所有条形按钮项目的样式`UINavigationBar`。

有没有人设法让这个工作以某种方式？我做错什么了吗？

# objective-c - Kochan 的“Objective-C 编程”中程序 7.6 中的“for”循环

> ID：12591376
> 
> 赞同：0
> 
> 时间：2012-09-25T21:32:40.957
> 
> 标签：objective-c

“sigma 表示法是求和的简写。它在这里的使用意味着将 1/2^i 的值相加，其中 i 从 1 变化到 n。也就是说，添加 1/2 + 1/4 + 1/8 .. .. 如果你使 n 的值足够大，这个系列的总和应该接近 1。让我们尝试不同的 n 值，看看我们有多接近。

```
#import <Foundation/Foundation.h>
// Define the Fraction class
@interface Fraction : NSObject
{
int numerator;
int denominator;
}
@property int numerator, denominator;
-(void) print;
-(void) setTo: (int) n over: (int) d;
-(Fraction*) add: (Fraction *) f;
-(void) reduce;
@end    

#import "Fraction.h"
@implementation Fraction
@synthesize numerator, denominator;
-(void) print
{
NSLog (@"%i/%i", numerator, denominator);
}
-(void) setTo: (int) n over: (int) d
{
numerator = n;
denominator = d;
}
-(Fraction *) add: (Fraction *) f
{
// To add two fractions:
// a/b + c/d = ((a*d) + (b*c)) / (b * d)
// result will store the result of the addition
Fraction *result = [[Fraction alloc] init];
result.numerator = numerator * f.denominator +
denominator * f.numerator;
result.denominator = denominator * f.denominator;
[result reduce];
return result; 
}

#import "Fraction.h"
int main (int argc, char *argv[])
{
NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
Fraction *aFraction = [[Fraction alloc] init];
Fraction *sum = [[Fraction alloc] init], *sum2;
int i, n, pow2;
[sum setTo: 0 over: 1]; // set 1st fraction to 0
NSLog (@"Enter your value for n:");
scanf ("%i", &n);
pow2 = 2;

for (i = 1; i <= n; ++i) {
[aFraction setTo: 1 over: pow2];
sum2 = [sum add: aFraction];
[sum release]; // release previous sum
sum = sum2;
pow2 *= 2;
}

NSLog (@"After %i iterations, the sum is %g", n, [sum convertToNum]);
[aFraction release];
[sum release];
[pool drain];
return 0;
} 
```

问题：为什么我们必须创建在“for”循环中使用的附加变量 sum2？为什么我们需要在这里“释放先前的总和”，然后再给它一个我们刚刚释放的值？：

```
sum2 = [sum add: aFraction];
[sum release]; // release previous sum
sum = sum2; 
```

难道只是为了避免内存泄漏？（方法“add”初始化一个存储在 sum2 中的变量）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:44:11.663

没有看到如何`Fraction`定义，我不能确定，但​​我猜一个`Fraction`对象是*不可变*的，所以`sum`不能简单地改变。如果我们这样做了`sum = [sum add:aFraction]`，它会泄漏`sum`曾经指向的对象（它有一个正的保留计数，仍然如此，而且我们不再有指向它的指针）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:44:27.747

在不知道`Fraction`最有可能成为本书一部分的类的情况下，它可能只是不可变对象使用的一个示例。

通常提倡不可变对象，因为：

*   使它们线程安全很容易；和
*   因为他们保证不会改变每个人都可以可靠地坚持同一个而不是复制令人作呕的价值。

因此，您可以随心所欲地进行多处理，并且在任何相当复杂的系统中，您通常会在保持面向对象的同时节省内存（即，每个对象都是独立的，没有其他人直接操作对象的内部数据）。

作为不可变的，当你想“修改”一个现有的时，你必须创建一个新的，我认为这就是这里发生的事情。

编辑：使用完整的源代码，`Fraction`它看起来对象实际上是可变的（例如，它有`setTo:over:`）。所以答案仍然是旧对象被丢弃而新对象被保留，因为`add:`它不会改变它被调用的对象，而是返回一个带有最终结果的新对象。尽管从风格上看，它似乎更像是对[三地址形式](http://en.wikipedia.org/wiki/Three_address_code)的追求，而不是不可变对象模式。

# java - 忽略文件中的数字

> ID：12591383
> 
> 赞同：1
> 
> 时间：2012-09-25T21:33:10.867
> 
> 标签：java, arrays, file, io, 2d

我正在制作一个程序，它从文件中获取数据并从中制作迷宫游戏。一个示例 maze.txt 文件如下所示：

```
5  5
P.XX.
...X.
.XT..
..X..
X.... 
```

顶部的两个数字定义数组的行和列。这是我正在使用的代码

```
import java.util.*;
import java.io.*;

public class MazeGame {

    public static void main(String[] args) throws Exception {

        // Display the maze

        Scanner sc = new Scanner(new File("maze.txt"));
        int rows1 = sc.nextInt();
        int columns1 = sc.nextInt();
        rows1 += 1;
        columns1 += 1;

        BufferedReader in = new BufferedReader(new FileReader("maze.txt"));

        char[][] treasureMaze = new char[rows1][columns1];
        for (int i = 0; i < rows1 || i < columns1; ++i) {
            String line = in.readLine();
            if (line == null) {
                System.out.println("Error in array");
                return;
            }
            sc.nextLine();

            treasureMaze[i] = line.toCharArray();
        }

        display(treasureMaze);
        int vertical = 0;
        int horizontal = 0;

        // Give Move Options
        options();

        // Setup a while loop that continues until
        // the user has gotten to the treasure, or 'P'
        while (treasureMaze[vertical][horizontal] != 'T') {
            // Get Users Decision
            Scanner moveChoice = new Scanner(System.in);
            int choice = moveChoice.nextInt();

            if (choice == 1) {
                System.out.println("You chose to Move up");
            } else if (choice == 2) {
                System.out.println("You chose to Move down");
            } else if (choice == 3) {
                System.out.println("You chose to Move left");
            } else if (choice == 4) {
                System.out.println("you chose to Move right");
            } else {
                return;
            }

            // Move the Player: Each choice will move the player
            // according to their choice and then re-display the
            // map and options so that they can move through the maze

            // Move Up
            if (choice == 1) {
                if (vertical - 1 < 0) {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical - 1][horizontal] == '.') {
                    treasureMaze[vertical - 1][horizontal] = 'P';
                    treasureMaze[vertical][horizontal] = '.';
                    vertical -= 1;
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical - 1][horizontal] == 'T') {
                    System.out.println("\nCongratulations you won!");
                    treasureMaze[vertical][horizontal] = 'T';
                } else {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                }
            }

            // Move Down
            else if (choice == 2) {
                if (vertical + 1 < 0) {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical + 1][horizontal] == '.') {
                    treasureMaze[vertical + 1][horizontal] = 'P';
                    treasureMaze[vertical][horizontal] = '.';
                    vertical += 1;
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical + 1][horizontal] == 'T') {
                    System.out.println("\nCongratulations you won!");
                    treasureMaze[vertical][horizontal] = 'T';
                } else {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                }
            }

            // Move Left
            else if (choice == 3) {
                if (horizontal - 1 < 0) {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical][horizontal - 1] == '.') {
                    treasureMaze[vertical][horizontal - 1] = 'P';
                    treasureMaze[vertical][horizontal] = '.';
                    horizontal -= 1;
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical][horizontal - 1] == 'T') {
                    System.out.println("\nCongratulations you won!");
                    treasureMaze[vertical][horizontal] = 'T';
                } else {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                }
            }

            // Move Right
            else if (choice == 4) {
                if (horizontal + 1 < 0) {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical][horizontal + 1] == '.') {
                    treasureMaze[vertical][horizontal + 1] = 'P';
                    treasureMaze[vertical][horizontal] = '.';
                    horizontal += 1;
                    display(treasureMaze);
                    options();
                } else if (treasureMaze[vertical][horizontal + 1] == 'T') {
                    System.out.println("\nCongratulations you won!");
                    treasureMaze[vertical][horizontal] = 'T';
                } else {
                    System.out
                            .println("\nCannot move there! Try something else\n");
                    display(treasureMaze);
                    options();
                }
            } else {
                System.out.println("Bye!");
                return;
            }

        }
    }

    // Display Object: prints out the maze for the user
    public static void display(char x[][]) {
        for (int row = 0; row < x.length; row++) {
            for (int column = 0; column < x[row].length; column++) {
                System.out.print(x[row][column] + "\t");
            }
            System.out.println();
        }
    }

    // Options Object: gives the options menu to the user
    static void options() {
        System.out.println("You may:");
        System.out.println("\t1) Move up");
        System.out.println("\t2) Move down");
        System.out.println("\t3) Move left");
        System.out.println("\t4) Move right");
        System.out.println("\t0) Quit");

    }
} 
```

当我尝试运行程序时，我需要`5 5`在第一次运行时查看它，然后将其删除，这样我就可以使用程序的其余部分而不会遇到顶部的数字。有没有办法忽略这些数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:39:10.880

为什么要打开文件读取两次？

> 扫描仪 sc = new Scanner(new File("maze.txt"));
> BufferedReader in = new BufferedReader(new FileReader("maze.txt"));

使用 a`Scanner`或 a `BufferedReader`，不能同时使用。

另一种选择是在开始时简单地调用`BufferedReader.readLine`一个额外的时间来忽略第一行。

通过最少的代码更改，您实际上可以传递一个 String 来构造一个 Scanner：

```
 //move BufferedReader creation up
    BufferedReader in = new BufferedReader(new FileReader("maze.txt"));
    Scanner sc = new Scanner(in.readLine()); //Scan first line from the Reader

    // The res tof your code as it exists now
    int rows1 = sc.nextInt();
    int columns1 = sc.nextInt();
    rows1 += 1;
    columns1 += 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:40:14.547

您可以只使用[Scanner.nextLine](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#nextLine%28%29)而不是使用 BufferedReader 再次打开文件。

编辑：

为了澄清，我的意思是：

```
 Scanner sc = new Scanner(new File("maze.txt"));
    int rows1 = sc.nextInt();
    int columns1 = sc.nextInt();

    char[][] treasureMaze = new char[rows1][columns1];

    for (int i = 0; i < rows1; ++i) {
        String line = sc.nextLine(); 
```

编辑2：

我删除了

```
 rows1 += 1;
    columns1 += 1; 
```

并更改了 for 循环：

我不确定将 1 添加到 rows 和 columns 的目的是什么，并且循环实际上应该只循环 rows 的数量`rows1`。至少对于文件部分的读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:54:43.107

我试图创建一个类似的场景，但我的代码与你的完全不同。如果您只想忽略第 1 行上的数字，您可以在继续下一行之前简单地进行检查。检查此代码：

```
Scanner scan = new Scanner(System.in);
    System.out.println("Enter rows and columns");
    PrintWriter write = new PrintWriter("maze.txt");
    write.println(scan.next());
    write.print("a bc db gj");
    write.flush();
    write.close();

    BufferedReader reader = new BufferedReader(new FileReader("maze.txt"));
    String rt="";
    while((rt=reader.readLine())!=null) {
        if(rt.startsWith("5")) {
         continue;  
        }
        else {
        System.out.println(rt);
        }
    }

} 
```

输入：

5 5

输出：a bc db gj

希望这可以帮助 ：）

# html - @font-face 不适用于 IE 和 Firefox 中的子域

> ID：12591385
> 
> 赞同：1
> 
> 时间：2012-09-25T21:33:24.810
> 
> 标签：html, fonts, subdomain

我在主域下有我的 CSS 文件和我的字体文件，假设在

[http://www.mydomain.com/css](http://www.mydomain.com/css)和[http://www.mydomain.com/fonts](http://www.mydomain.com/fonts)

我也有一些子域上的文件，这些文件需要共享主域文件的 css 和字体样式。因此，我只是在我的文件顶部：

```
<link rel="stylesheet" type="text/css" href="http://www.mydomain.com/css/algemeen.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.mydomain.com/css/gemeenten.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.mydomain.com/css/sidebars.css" media="all" /> 
```

一切都很好，CSS 显示得很好。但是，在这些 CSS 文件中，我使用了@font-face。此代码本身在所有浏览器中都可以正常工作，至少对于主域上的文件是这样。所以[http://www.mydomain.com/index.php](http://www.mydomain.com/index.php)在所有浏览器中完美地显示了我选择的字体。但是，我的子域上使用相同 CSS 的 index.php 没有在 IE 或 Firefox 中显示我选择的字体！它只使用标准的 Arial。Safari、Opera 和 Chrome 运行良好。这怎么可能？我的@font-face 代码：

```
@font-face {
   font-family: "Nova"; font-weight: normal;
    font-style: normal;
   src: url("../fonts/proximanova-regular.eot");
}
@font-face {
   font-family: "Nova";
   src: url("../fonts/proximanova-semibold.eot");
   font-weight: 900;
}
@font-face {
   font-family: "Nova"; font-weight: normal;
    font-style: normal;
   src: url("../fonts/proximanova-regular.ttf") format("truetype");
}
@font-face {
   font-family: "Nova";
   src: url("../fonts/proximanova-semibold.ttf") format("truetype");
   font-weight: 900;
} 
```

多谢你们！

已经在字体文件夹中添加了带有此代码的 .htaccess：

```
<FilesMatch "\.(ttf|otf|eot|woff)$">
  <IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
  </IfModule>
</FilesMatch> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T06:16:22.303

这是一个 CORS 问题。

[http://en.wikipedia.org/wiki/Cross-origin_resource_sharing](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

[http://www.w3.org/TR/cors/](http://www.w3.org/TR/cors/)

[http://enable-cors.org/](http://enable-cors.org/)

更简单的解决方案只是复制您的字体文件，以便它们存在于子域中。大多数 CSS 代码都很好，只是`@font-face`您需要放入一个新文件中的代码，该文件将相对链接到本地​​字体文件夹。在两个域中保持结构相同意味着您只需 c+p CSS/字体，而无需创建特定代码。

*   /万维网/
    *   /css/
        *   main.css -> 除了`@font-face`
        *   字体-face.css ->`src: url("fonts/font.eot")`
        *   /字体/
            *   字体.eot
*   /子域/
    *   index.htm -> 参考`http://domain.com/css/main.css`和`css/font-face.css`
    *   /css/
        *   字体-face.css ->`src: url("fonts/font.eot")`
        *   /字体/
            *   字体.eot

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:03:23.893

您是否检查过字体文件的文件路径？那将是我要看的第一个地方。如果您的子域设置为 Web 根目录的子文件夹，则需要更改这些文件路径。

考虑使用绝对路径而不是相对路径： http: [//www.domain.com/fonts/proximanova-semibolt.tff](http://www.domain.com/fonts/proximanova-semibolt.tff)而不是 ../fonts/proximanova-semibold.tff

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:14:57.310

听起来像一个CORS问题。该解决方案最有可能在主服务器上更新您的 .htaccess 文件。

如果您查看此问题的答案，我认为它会对您有所帮助：

[@font-face 导入无法在离线网站/不同主机中使用仅通过 IE 中的 CSS 使用在线字体](https://stackoverflow.com/questions/12371533/font-face-import-not-working-in-offline-website-different-host-using-online-fon)

他的问题最终是 EOT 文件本身的一些问题，但 CORS 问题已在已接受答案的**原始答案**部分中得到解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T06:26:48.717

确保你有所有格式，然后你可能需要检查重量，mozilla 有时会用粗体和默认值，这段代码对我有用，希望对你有很大帮助。

IE 是一个特例，为此您可以使用一个名为[Prefix Free](http://leaverou.github.com/prefixfree/)的库。并在这里查看[浏览器中的@font-face 支持](http://caniuse.com/#feat=fontface)

```
@font-face
{
    font-family: "MyFavoriteFont";
    src: url("KomikaTitle-webfont.eot");
        xsrc: url("KomikaTitle-webfont.eot?#iefix") format("embedded-opentype"),
     url("KomikaTitle-webfont.woff") format("woff"),
     url("KomikaTitle-webfont.ttf") format("truetype"),
     url("KomikaTitle-webfont.svg#KomikaTitleRegular") format("svg");
} 
```

# php - 用户标记的选项取决于他加入 phpbb 的域

> ID：12591387
> 
> 赞同：1
> 
> 时间：2012-09-25T21:33:33.093
> 
> 标签：php, mysql, registration, forum, phpbb

我创建了三个共享部分主题和用户的论坛，效果很好。甚至化身之类的东西。

问题是我如何标记在 www.domain_1.com 上注册的用户，并且他的帖子也可以在最后一个论坛上看到，例如：www.domain_2.com 和 domain_3.com。

完美的情况是，当此信息显示在他的昵称或头像之前或之后的每个帖子的用户个人资料中时。

各位有经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T07:47:52.447

## 在名为 user_domain 的 phpbb_users 表中创建一个 sql 列。

**在包含/ucp/ucp_register.php**

* * *

**寻找**

* * *

```
 $user_row = array( 
```

**插入**

```
 'user_domain'               => urlencode(generate_board_url()), 
```

**在 viewtopic.php 中**

* * *

**寻找**

```
 $user_cache[$poster_id] = array( 
```

**插入**

```
 'user_domain'           => $row['user_domain'], 
```

**寻找**

```
 $postrow = array( 
```

**插入**

```
 'POSTER_DOMAIN'     => $user_cache[$poster_id]['user_domain'], 
```

* * *

**在 viewtopic_body.html 的模板文件夹中**

* * *

**寻找**

```
 <!-- IF postrow.POSTER_AVATAR -->
                <!-- IF postrow.U_POST_AUTHOR --><a href="{postrow.U_POST_AUTHOR}">{postrow.POSTER_AVATAR}</a><!-- ELSE -->{postrow.POSTER_AVATAR}<!-- ENDIF --><br />
            <!-- ENDIF --> 
```

**在之前和之后添加**

```
 {postrow.POSTER_DOMAIN}<br /> 
```

[phpbb](/questions/tagged/phpbb "显示标记为“phpbb”的问题") [phpbb3](/questions/tagged/phpbb3 "显示标记为“phpbb3”的问题") [php](/questions/tagged/php "显示标记为“php”的问题")[论坛](/questions/tagged/forum "显示标记为“论坛”的问题")

# ssl - Heroku SSL 端点，“过期不能为空 Pem 无效”

> ID：12591388
> 
> 赞同：1
> 
> 时间：2012-09-25T21:33:41.933
> 
> 标签：ssl, heroku

我正在尝试上传 Dreamhost SSL 证书 top heroku。我现在正在关注本指南[http://blog.yodersolutions.com/using-dreamhost-for-herokus-ssl-cert/](http://blog.yodersolutions.com/using-dreamhost-for-herokus-ssl-cert/)。

这给了我一个无效的证书错误。

我删除了证书正文末尾的换行符。这给了我这个错误：

```
Adding SSL Endpoint to domain... failed
 !    Expires at can't be blank
 !    Pem is invalid 
```

我尝试使用[https://github.com/heroku/heroku-ssl-doctor](https://github.com/heroku/heroku-ssl-doctor)但这给了我内部服务器错误。有什么我可以做的吗？

我遇到了[与 Heroku SSL Endpoint](https://stackoverflow.com/questions/11125587/trouble-with-heroku-ssl-endpoint)问题的问题非常相似的问题，但建议的解决方案不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T16:03:39.757

问题出在 server.crt 上。检查

```
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE----- 
```

被适当地分开，当连接时它们往往像这样重叠。

```
 -----END CERTIFICATE----------BEGIN CERTIFICATE----- 
```

这导致了一个问题。

# youtube-api - YouTube api 的不同网址

> ID：12591389
> 
> 赞同：0
> 
> 时间：2012-09-25T21:33:45.073
> 
> 标签：youtube-api

我有来自 youtube 的链接，例如： [http ://www.youtube.com/sothebysrealty?x=us_showcase__](http://www.youtube.com/sothebysrealty?x=us_showcase__)

和

[http://bit.ly/KQVFK0](http://bit.ly/KQVFK0)

并使用从 youtube 网站生成的嵌入 iframe 代码，它不起作用。我怎样才能使用这些网址而不是普通的 YouTube ID？还是有另一种从 YouTube 获取 id 的方法...我查看了两个“共享”链接，它们都有完整的 url，如上面不包含典型的 youtube id。

使用常规 id 的代码段：

```
<iframe id="ytplayer" type="text/html" width="640" height="360"
src="https://www.youtube.com/embed/sjhO9gLO1Sk"
frameborder="0" allowfullscreen /> 
```

但使用上面的链接没有。

谢谢-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T15:40:16.793

您是在询问使用任意 URL 作为标签的 src= 来触发嵌入式播放器？那是不可能的。

如果您有特定视频的 YouTube 观看页面 URL（不是 bit.ly URL 或频道页面的 URL，而是观看页面 URL），那么您可能会发现 oEmbed 服务可用于生成适当的嵌入标签：[http： //apiblog.youtube.com/2009/10/oembed-support.html](http://apiblog.youtube.com/2009/10/oembed-support.html)

# java - Java cipher 和 php mcrypt_encrypt（带有 ECB 填充的 BLOWFISH 算法）

> ID：12591391
> 
> 赞同：2
> 
> 时间：2012-09-25T21:33:47.567
> 
> 标签：java, php, encryption, encoding, cryptography

这是我的问题，我有从 java(jsp) 接口创建的用户帐户，该接口使用 Blowfish/ECB/PKCS5Padding 加密密码以存储在数据库中。现在，我正在尝试使用从 java(jsp) 前端创建的用户帐户从 PHP 开发的不同应用程序进行身份验证，但是当我尝试比较加密后从 java 端和 php 返回的值时，它们出来不一样。

JAVA代码：

```
 import java.io.*;
     import java.util.*;
     import javax.crypto.*;
     import javax.crypto.spec.*;

     import java.security.Provider;
     import java.security.Security;
     public class Test
     {
       public static byte[] raw =null;
       public static SecretKeySpec skeySpec;
       public static Cipher cipher;
       public static void main(String ags[]) throws Exception
       {
           byte[] key={1,2,3,4,5,6,7};
           skeySpec = new SecretKeySpec(key, "Blowfish");
           System.out.println("KEY : "+bytesToString(skeySpec.getEncoded()));
                   String cipherInstName = "Blowfish/ECB/PKCS5Padding";
           cipher = Cipher.getInstance(cipherInstName);
           cipher.init(Cipher.ENCRYPT_MODE,skeySpec);
           byte[] encrypted = cipher.doFinal(("asdfgh").getBytes());        
           System.out.println("PLAIN TEXT : "+("asdfgh").getBytes());
           System.out.println("ENCRYPTED TEXT : "+bytesToString(encrypted));             
       }

           private static String bytesToString(byte [] value)
           {
                   StringBuffer retVal = new StringBuffer();
                   for(int i=0; i<value.length; i++)
                   {
                       retVal.append(value[i]+":");
                   }
                   int inx = retVal.toString().lastIndexOf(":");
                   retVal= new StringBuffer(retVal.toString().substring(0,inx));
                   return retVal.toString();
           }
     } 
```

爪哇输出：

```
 KEY : 1:2:3:4:5:6:7
    PLAIN TEXT : [B@1ea5671
    ENCRYPTED TEXT : 81:102:-114:102:82:80:83:-123 
```

PHP代码：

```
 function pkcs5_pad($text,$blocksize)
{
    $pad = $blocksize - (strlen($text) % $blocksize);
    return $text.str_repeat(chr($pad),$pad);
}
function pkcs5_unpad($text)
{
    $pad = ord($text{strlen($text)-1});
    if ($pad > strlen($text)) return false;
    if (strspn($text, chr($pad), strlen($text) - $pad) != $pad) return false;
    return substr($text, 0, -1 * $pad);
}
$blockSize = mcrypt_get_block_size(MCRYPT_BLOWFISH,MCRYPT_MODE_ECB);
$padded = pkcs5_pad("asdfgh",$blockSize);
$key="1:2:3:4:5:6:7";
echo "<br/>";
//$cipher = mcrypt_ecb(MCRYPT_BLOWFISH,$key, $padded, MCRYPT_ENCRYPT);
$cipher = mcrypt_encrypt("blowfish",$key,$padded,"ecb");
echo "ENCRYPTED TEXT : ".base64_encode($cipher); 
```

PHP 输出：

```
 ENCRYPTED TEXT : draOlOiLFMs/Y+x+7mOhZw== 
```

请帮助我解决这个问题。

谢谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T01:23:44.927

首先，您可能希望在两个系统上都将字节编码为十六进制，这样比较容易。

其次，您无法控制如何将字符串转换为字节数组编码（反之亦然）。这称为字符编码。在 Java 中，您不应该在`String.getBytes()`未指定字符编码的情况下使用该方法。

该`[B@1ea5671`结果只是字节数组的对象实例的标识。您不能在 Java 中直接打印出字节数组。

# mysql - 如果另一个表中不存在值，则mysql插入

> ID：12591392
> 
> 赞同：3
> 
> 时间：2012-09-25T21:33:52.943
> 
> 标签：mysql, insert, exists

我有两个将值存储为`VARCHAR`.
我正在填充表，如果其他表中不存在值，我只想在其中一个表中插入值。
就像是：

```
INSERT IF IS EMPTY(SELECT * FROM t1 where v='test') INTO t2 (v) VALUES ('test') 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T21:36:11.447

您需要使用某种类型的[`INSERT...SELECT`](http://dev.mysql.com/doc/refman/5.5/en/insert-select.html)查询。

**更新（澄清后）：**例如，`t2`如果相应的行不存在，这里是如何插入一行`t1`：

```
INSERT INTO t2 (v)
  SELECT temp.candidate
  FROM (SELECT 'test' AS candidate) temp
  LEFT JOIN t1 ON t1.v = temp.candidate
  WHERE t1.v IS NULL 
```

用同一个查询插入多行，恐怕没有比这更好的了

```
INSERT INTO t2 (v)
  SELECT temp.candidate
  FROM (
      SELECT 'test1' AS candidate
      UNION SELECT 'test2'
      UNION SELECT 'test3' -- etc
  ) temp
  LEFT JOIN t1 ON t1.v = temp.candidate
  WHERE t1.v IS NULL 
```

**原始答案**

例如，这将从满足子句`other_column`的所有行中获取，并将行插入到其中使用的值作为. 它将忽略重复的键错误。`table1``WHERE``table2``column_name`

```
INSERT IGNORE INTO table2 (column_name)
  SELECT table1.other_column
  FROM table1 WHERE table1.something == 'filter'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-09-12T09:52:17.517

对于插入多列，你可以试试这个。

```
INSERT INTO table_1 (column_id,column_2,column_3,column_4,column_5)
 SELECT
    table_2.*
FROM
    table_2
LEFT JOIN table_1 ON table_1.column_id = table_2.column_id
WHERE
    table_1.column_id IS NULL; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-16T19:31:37.477

```
INSERT IGNORE INTO table_1(col1,col2,col3,col4)
  SELECT table_2.*
  FROM table_2; 
```

上面的语句在你的场景中做得很好。

1.  第 1 行：说明您希望在其中复制数据的表，同时忽略任何键约束。
2.  第 2 行：选择数据应来自的表和列
3.  第 3 行：说明要从中复制数据的表

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-25T21:57:58.847

```
$result = mysql_query("SELECT * FROM t1 WHERE v='test'");
if(mysql_num_rows($result) == 0){
    mysql_query("INSERT INTO t2 (v) VALUES ('test')");
} 
```

有一段时间没有使用 mysql，所以这些功能已被弃用，但我应该这样做。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-25T22:06:02.627

有点贫民窟..但有效。假设您将静态值插入到 'col'

```
INSERT INTO t1 (col)
SELECT 'test' 
  FROM t2
 WHERE (SELECT count(*) FROM t2 WHERE v='test') = 0; 
```

# php - 如果两个孩子为真，则更新 XML？

> ID：12591396
> 
> 赞同：0
> 
> 时间：2012-09-25T21:34:13.193
> 
> 标签：php, xml

我在 StackOverflow 上询问了一些关于 PHP 和 XML 的问题，感谢你们所有的编码人员，我已经掌握了它，但有时我会卡住。

如果两个孩子设置正确，我希望能够删除一个节点？我一直在尝试这个：

```
$xml = new DOMDocument();
$xml->formatOutput = true;
$xml->preserveWhiteSpace = false;
$xml->loadXML('<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
  <game id="86102">
    <opponent>shoooorty</opponent>
    <oppid>2512</oppid>
    <lastdraw>2</lastdraw>
    <turn>1</turn>
    <image>noimage.png</image>
    <nextdraw>6198</nextdraw>
    <infopop>0</infopop>
    <playertilesum>73</playertilesum>
    <oppnation>0</oppnation>
  </game>
  <game id="88341">
    <opponent>Jmemek</opponent>
    <oppid>1917</oppid>
    <lastdraw>3</lastdraw>
    <turn>2</turn>
    <image>1917a.png</image>
    <nextdraw>3107</nextdraw>
    <infopop>1</infopop>
    <playertilesum>27</playertilesum>
    <oppnation>0</oppnation>
  </game>
  <game id="88382">
    <opponent>Gitteloven</opponent>
    <oppid>3153</oppid>
    <lastdraw>1</lastdraw>
    <turn>1</turn>
    <image>noimage.png</image>
    <nextdraw>2953</nextdraw>
    <infopop>1</infopop>
    <playertilesum>19</playertilesum>
    <oppnation>0</oppnation>
  </game>
</data>
');

// original
echo "<xmp>OLD:\n". $xml->saveXML() ."</xmp>";

$opNodes = $xml->getElementsByTagName('turn');
$opNodes2 = $xml->getElementsByTagName('infopop');
foreach($opNodes as $node){
    $xmlTurn = trim($node->nodeValue);
    foreach($opNodes2 as $node2){
        $xmlPopup = trim($node2->nodeValue);
        if($xmlTurn < 2 && $xmlPopup == 1){
            $gameNode = $node->parentNode;
            $gameNode->parentNode->removeChild($gameNode);
        }
    }
}

echo "<xmp>NEW:\n". $xml->saveXML() ."</xmp>"; 
```

我想删除 turn 低于 2 且 infopop = 1 的所有游戏。在这种情况下，它应该删除最后一个游戏......但它不起作用？？？我究竟做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:58:15.617

就个人而言，我发现在 PHP 中处理 XML 时，使用 SimpleXML 比使用 DOMDocument 容易得多。但是，现在您将使您的代码工作。:)

```
<?php
$xml = new DOMDocument();
$xml->formatOutput = true;
$xml->preserveWhiteSpace = false;
$xml->loadXML('<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
  <game id="86102">
    <opponent>shoooorty</opponent>
    <oppid>2512</oppid>
    <lastdraw>2</lastdraw>
    <turn>1</turn>
    <image>noimage.png</image>
    <nextdraw>6198</nextdraw>
    <infopop>0</infopop>
    <playertilesum>73</playertilesum>
    <oppnation>0</oppnation>
  </game>
  <game id="88341">
    <opponent>Jmemek</opponent>
    <oppid>1917</oppid>
    <lastdraw>3</lastdraw>
    <turn>2</turn>
    <image>1917a.png</image>
    <nextdraw>3107</nextdraw>
    <infopop>1</infopop>
    <playertilesum>27</playertilesum>
    <oppnation>0</oppnation>
  </game>
  <game id="88382">
    <opponent>Gitteloven</opponent>
    <oppid>3153</oppid>
    <lastdraw>1</lastdraw>
    <turn>1</turn>
    <image>noimage.png</image>
    <nextdraw>2953</nextdraw>
    <infopop>1</infopop>
    <playertilesum>19</playertilesum>
    <oppnation>0</oppnation>
  </game>
</data>
');

// original
echo "<xmp>OLD:\n". $xml->saveXML()."</xmp>";

print "number of games: ".$xml->getElementsByTagName("game")->length."<br />\n";

// get the list of games and store the length param
$games = $xml->getElementsByTagName("game");
$len   = $games->length;

// loop the games
for( $i=0; $i<$len; $i++ )
{
    // reset tracking for whether or not to delete this game
    $turn_lt_2 = false;
    $infopop_eq_1 = false;

    // get the game node
    $game = $games->item($i);
    // loop the game's child nodes and look for the turn and infopop
    foreach( $game->childNodes as $node )
    {
        switch( $node->nodeName )
        {
            case "turn":
                if( (int)$node->nodeValue < 2 ) { $turn_lt_2 = true; }
            break;

            case "infopop":
                if( (int)$node->nodeValue === 1 ) { $infopop_eq_1 = true; }
            break;
        }
    }

    // check to see if both conditions were met
    if( ($turn_lt_2 === true) && ($infopop_eq_1 === true) )
    {
        print "deleting game <b>[".$i."]</b><br />\n";
        $game->parentNode->removeChild($game);
    }
}

echo "<xmp>NEW:\n". $xml->saveXML() ."</xmp>";
print "new number of games: ".$games->length."<br />\n";
?> 
```

# sql - XML 到 SQL 临时表

> ID：12591401
> 
> 赞同：1
> 
> 时间：2012-09-25T21:34:47.210
> 
> 标签：sql, sql-server, xml, sql-server-2005, xml-parsing

我有一个看起来像的 XML 字符串

```
 <PLATFORM>
  <PLATFORMNAME>UNIX</PLATFORMNAME> 
  <OS>Ipad</OS> 
  <VERSION>5.1</VERSION> 
  <PLATFORMNAME>Windows</PLATFORMNAME> 
  <OS>Windows</OS> 
  <VERSION>2008 (64bit)</VERSION> 
  </PLATFORM> 
```

我需要将其插入到诱惑表中

```
 Create Table #TempXMLTable
     (
      PlatformName NVARCHAR(50),
      OS NVARCHAR(50),
      PlatformVersion NVARCHAR(50)
     )
     INSERT INTO #TempXMLTable VALUES(
           @XML.value('(/PLATFORM/PLATFORMNAME)[1]', 'nvarchar(MAX)'), 
      @XML.value('(/PLATFORM/OS)[1]', 'nvarchar(MAX)') ,
      @XML.value('(/PLATFORM/VERSION)[1]', 'nvarchar(MAX)')) 
```

当我执行上述插入时，仅插入第一列，但我想要两个插入

应该看起来像 -

```
 PlatformName OS     Version
                      Unix         Ipad    5.1
                      Windows      Windows 2008 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T10:13:38.900

```
DECLARE @idoc int

DECLARE @doc varchar(1000)

SET @doc ='
<OutLookContact>
<Contact FirstName="Asif" LastName="Ghafoor" EmailAddress1="asifghafoor@my.web.pk" />
<Contact FirstName="Rameez" LastName="Ali" EmailAddress1="rameezali@my.web.pk" />
<Contact FirstName="Aneel" LastName="Maqsood" EmailAddress1="aneelmaqsood@my.web.pk" />
</OutLookContact>'

--Create an internal representation of the XML document.

EXEC sp_xml_preparedocument @idoc OUTPUT, @doc

-- Execute a SELECT statement that uses the OPENXML rowset provider.

DECLARE @Temp TABLE(FirstName VARCHAR(250),LastName VARCHAR(250),Email1 VARCHAR(250))  

INSERT INTO @Temp(FirstName,LastName,Email1)

SELECT *

FROM OPENXML (@idoc, '/OutLookContact/Contact',1)

WITH (FirstName varchar(50),LastName varchar(50),EmailAddress1 varchar(50))

select FirstName,LastName,Email1 from @Temp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:02:17.847

此查询适用于单个 XML 变量中多达 1023 个平台。这个约束存在只是因为我用作`spt_values`序列号的来源。如果您需要更大的数字，您可以使用自己的`numbers`或表格。`tally`

```
INSERT INTO #TempXMLTable 
SELECT  --v.number,
        x.n.value('.','nvarchar(max)'),
        y.n.value('.','nvarchar(max)'),
        z.n.value('.','nvarchar(max)')
from @xml.nodes('/PLATFORM') a(b)
cross apply (select count(*) from @xml.nodes('//PLATFORMNAME') p(q)) c(countall)
join master.dbo.spt_values v on v.type='p' and v.number between 1 and countall
cross apply (select a.b.query('PLATFORMNAME[sql:column("number")]')) x(n)
cross apply (select a.b.query('OS[sql:column("number")]')) y(n)
cross apply (select a.b.query('VERSION[sql:column("number")]')) z(n) 
```

但是，您实际拥有的是一个实际上并不是最佳实践的 XML。您会注意到您有 2 组 PLATFORMNAME,OS,VERSION 仅由同一级别内的 ORDER 标识。最佳实践是这样制定 XML：

```
<PLATFORMS>
  <PLATFORM>
    <PLATFORMNAME>UNIX</PLATFORMNAME>
    <OS>Ipad</OS>
    <VERSION>5.1</VERSION>
  </PLATFORM>
  <PLATFORM>
    <PLATFORMNAME>Windows</PLATFORMNAME>
    <OS>Windows</OS>
    <VERSION>2008 (64bit)</VERSION>
  </PLATFORM>
</PLATFORMS> 
```

# php - 当相同的脚本在 Linux 主机上正常运行时，WAMP 服务器显示错误

> ID：12591402
> 
> 赞同：0
> 
> 时间：2012-09-25T21:35:02.913
> 
> 标签：php, syntax-error, wampserver

这不是我第一次觉得 WAMP Server 对错误过于敏感。似乎应该有一些配置来降低它对 PHP 错误的敏感性。我有一个在 Linux 生产服务器（CENTOS 5.8 + Apache + MySQL）上正常运行的脚本，但是当由 Windows 7 Ultimate（64 位）上的 WAMP 服务器执行时，显示以下错误：

```
syntax error, unexpected end of file in ... 
```

在这里，我对这个错误发生的条件并不好奇（我用谷歌搜索并找出它发生的原因），我的问题是为什么我遇到了许多在生产服务器上正常运行的脚本，而 WAMP 服务器却有问题。如何降低错误级别的敏感性呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T23:26:01.550

WAMP 服务器的默认值为`short_open_tag`0（关闭）。编辑 php.ini 解决了这个问题：

```
short_open_tag = On 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T07:18:13.207

您需要确保您的 CentOS 系统上的 PHP 错误日志记录与您的 Windows 系统相匹配。Wampserver 只是 Apache、MySQL 和 PHP 的一个补丁集合，尽管设置会有所不同，但它们可以更改，就像您的实时服务器一样。

通常，您会希望匹配实时服务器设置，以确保您在上线时不会遇到任何意外（当然，您可能还希望在开发过程中打开更详细的警告/错误警报）。为此，请从 wampserver 菜单中打开 php.ini，然后匹配您的 CentOS。

当然，Apache 和 MySQL 及其配置也是如此。还要记住，版本可能会有所不同，因此最好保持这些版本相同，或者至少尽可能接近主要版本。

最后，我认为 Wampserver 并没有过于敏感，但它显示了您尚未注意到的错误，并且确实应该修复，无论它们是否隐藏在错误或警告日志文件中。

# android - Android 可访问性焦点 - 单击视图会将焦点更改为上一个视图

> ID：12591407
> 
> 赞同：0
> 
> 时间：2012-09-25T21:35:33.340
> 
> 标签：android, onclick, focus, accessibility

我正在使用 android TalkBack 来测试我的应用程序的可访问性使用。当我滑动选择一个视图并双击时，焦点会返回它上面的视图。通常在滑动到视图并双击它时，会调用 onClick。我究竟做错了什么？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/all_white"
>
<ImageView   
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/header"
    android:scaleType="center"
/>
<ImageView   
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/green_bar"
    android:scaleType="center"
/>  
<ImageView   
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/blue_bar"
    android:scaleType="center"
/>
<EditText
    android:id="@+id/username"
    android:layout_width="325dp"
    android:layout_height="wrap_content"
    android:hint="@string/username"
    android:focusable="true"
    android:nextFocusDown="@id/password"
 />
<EditText
    android:id="@+id/password"
    android:inputType="textPassword"
    android:layout_width="325dp"
    android:layout_height="wrap_content"
    android:hint="@string/password"
    android:focusable="true"
    android:nextFocusUp="@id/username"
    android:nextFocusDown="@id/login"
/>
<Button
    android:id="@+id/login"
    android:onClick="doLogin"
    android:focusable="true"
    android:layout_width="325dp"
    android:layout_height="wrap_content"
    android:text="@string/login"
    android:nextFocusUp="@id/password"
    android:nextFocusDown="@id/create_trial_account"
/>
<Button
    android:id="@+id/create_trial_account"
    android:layout_width="100dip"
    android:layout_height="wrap_content"
    android:text="@string/new_user"
    android:onClick="createAccount"
    android:focusable="true"
    android:nextFocusUp="@id/login"
 />
<TextView
    android:id="@+id/copyright"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/copyright"
  />        
 <TextView
    android:id="@+id/buildNumber"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
 />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T17:27:47.083

此行为是由于在 Manifest supports-screens 标记中将 android:anyDensity 设置为 false 引起的。一旦我删除了该属性，它就会按预期工作。

# c - 将寄存器内容移动到 x86_64 中另一个寄存器中的内存地址

> ID：12591409
> 
> 赞同：3
> 
> 时间：2012-09-25T21:35:42.790
> 
> 标签：c, assembly, clang

在 clang 中进行一些内联​​汇编（基本上是通过使用各种引用来猜测我的方式），并且我试图将 的内容移动`%rdi`到`%rdx`. 但是我的语法都不起作用，这是：

```
mov %rdi, ptr %rdx 
```

给出：

```
error: expected relocatable expression 
```

怎么了？clang 中的内联汇编的语法是什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:45:33.723

我不知道 clang 的汇编语法到底是什么，但 gcc/gas 使用的 AT&T 语法是：

```
movq %rdi, (%rdx) 
```

英特尔/微软汇编语法将是：

```
mov qword ptr [rdx], rdi 
```

# c# - jQuery.ajax() 仅适用于整数

> ID：12591413
> 
> 赞同：1
> 
> 时间：2012-09-25T21:36:14.560
> 
> 标签：c#, jquery, asp.net

整数/浮点数一切正常，但当我在文本框中输入字符串时，C# 方法永远不会收到数据`GetData`。

ASP 代码

```
<asp:TextBox id="txtBoxVersion" runat="server"></asp:TextBox>
    <asp:ImageButton id="iconVersionSave" class="iconSave" runat="server" imageUrl="Resources/iconSave.png" OnClientClick="asyncServerCall(document.getElementById('txtBoxVersion').value); return false;"></asp:ImageButton> 
```

查询

```
function asyncServerCall(userData) 
{
    jQuery.ajax(
    {
        url: 'SurveyUpload.aspx/GetData',
        type: "POST",
        data: "{\"userData\":" + userData + "}",           //Data to be sent to the server !!WARNING!! Field Name must match C# parameter name
        contentType: "application/json; charset=utf-8",  //when sending data to the server
        dataType: "json",                                //The type of data that you're expecting back from the server.
        success:
            function (data) 
            {
                alert('Success');}
            }
    });
} 
```

C＃

```
[WebMethod()]
        public static Boolean GetData(String userData)
        {
            System.Diagnostics.Debug.WriteLine(userData); //DEBUGGING

            return true;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:40:18.417

```
data: "{\"userData\":" + userData + "}" 
```

应该：

```
data: "{\"userData\":'" + userData + "'}" 
```

# wpf - 关于 XAML RESX 标记扩展的建议

> ID：12591421
> 
> 赞同：0
> 
> 时间：2012-09-25T21:36:59.613
> 
> 标签：wpf, xaml, localization

有许多 RESX 标记扩展示例（以及 Globalizer 等产品）提供 XAML 标记扩展以允许您动态引用 RESX 文件中的资源以启用本地化。有没有人看过所有这些以从谷壳中挑选出小麦？也就是说，有人对 XAML 的良好 RESX 标记扩展有建议吗？

以下是一些可用选项：

*   [http://wpflocalizeextension.codeplex.com/](http://wpflocalizeextension.codeplex.com/)
*   [http://wpflocalization.codeplex.com/](http://wpflocalization.codeplex.com/)
*   [http://www.codeproject.com/Articles/35159/WPF-Localization-Using-RESX-Files](http://www.codeproject.com/Articles/35159/WPF-Localization-Using-RESX-Files)
*   [http://www.wpftutorial.net/LocalizeMarkupExtension.html](http://www.wpftutorial.net/LocalizeMarkupExtension.html)
*   [http://www.infralution.com/globalizer.html](http://www.infralution.com/globalizer.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:14:08.343

您不需要任何标记扩展来完成此操作。您可以使用简单的 ValueConverter 来完成。

1.  将 .resx 文件添加到您的项目中（在本例中，我们将其命名为 Resource1.resx，字符串值名为“String1”，值为“Hello world！”）

2.  创建一个将字符串转换为本地化字符串的转换器。

    ```
    namespace WpfApplication1.Converters
    {
        public class ResxLocalizationConverter : IValueConverter
        {
            public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
            {
                string result = Resource1.ResourceManager.GetString(value.ToString());
                if (result == null)
                {
                    result = value.ToString();
                }
                return result;
            }

            public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
            {
                throw new NotImplementedException();
            }
        }
    } 
    ```

3.  将转换器实例添加到 App.xaml

    ```
    <Application x:Class="WpfApplication1.App"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 StartupUri="Window1.xaml" 
                 xmlns:converters="clr-namespace:WpfApplication1.Converters">
        <Application.Resources>
            <converters:ResxLocalizationConverter x:Key="ResxLocalizationConverter" />
      </Application.Resources>
    </Application> 
    ```

4.  将非本地化字符串值（或键）放入 XAML。

    ```
    <Window x:Class="WpfApplication1.Window1"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            Title="Window1" Height="300" Width="300">
        <Grid>        
            <TextBlock Text="{Binding Source='String1', Converter={StaticResource ResxLocalizationConverter}}"/>
        </Grid>
    </Window> 
    ```

这将显示“Hello world！” 在文本块中。

例如，要本地化法语，您只需将 Resource1.fr-FR.resx 添加到 Visual Studio 项目（使用名为“String1”的字符串值“Salut tout le monde!”）。这将在法语本地化 PC 上显示法语版本，或者您可以使用 ResourceManager.GetString(...) 重载，让您明确选择语言。

# svn - “分支”下的子目录

> ID：12591425
> 
> 赞同：1
> 
> 时间：2012-09-25T21:37:28.043
> 
> 标签：svn, repository

是否可以在“分支”下创建一个子目录，然后在其下放置副本？

例如：

```
branches/user69/project-1, branches/user69/project-2, branches/user42/xyz-bugs 
```

我试过`svn mkdir`了，但没有用。它回来了：

```
A    https://example.com/svn/blah/branches/user69 
```

但它实际上并没有在 repo（也不是本地磁盘）上创建子目录。

我确信我已经看到了这种 SVN 层次结构，但它一定有一个技巧。

我也刚试过：

```
svn copy http://example.com/blah/trunk http://example.com/blah/branches/user69/project-1 
```

但这也不起作用：

```
Path not found. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:43:44.300

我没有注意到任何技巧。我只是在命令行上完成的，没有任何问题。您唯一没有提到的是在 svn mkdir 命令之后提交您的更改。如果您仍然遇到问题，您可以发布您输入的确切命令（显然在粘贴时将您的实际 svn repo 更改为[https://example.com ）？](https://example.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T02:46:39.233

是的，您可以在存储库中拥有任何树结构 - 这只是团队的约定问题

> “一个[https://example.com/svn/blah/branches/user69](https://example.com/svn/blah/branches/user69) ”

意味着，您在 /branches 下**创建了真正的** *user69*版本控制的子目录，可以使用此 URL 重新定位 WC 并提交

如果您想**在一个命令**中创建分支/USERNAME/BRANCHNAME ，而 /USERNAME 仍然不存在，则必须使用选项 --parents in `svn mkdir`，请参阅`svn help mkdir`

> ...所有中间目录必须已经存在，除非给出 --parents 选项。

# c++ - 删除双变量中的尾随零

> ID：12591426
> 
> 赞同：0
> 
> 时间：2012-09-25T21:37:29.497
> 
> 标签：c++, formatting, double, floating-point-precision

我有一个 DLL，它定义了许多所有返回的方法，`double`我不想更改其中的任何内容。问题是当我将小数字传递给这些方法时，返回值带有太多尾随零`double`，例如返回值是`9*9=810000000000`（它不是小数点，它是 Double 变量的实际容量）。我想要正常的行为，即 9*9=81

如何在不更改 DLL 的情况下摆脱那些尾随零？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:42:34.857

（大概您的示例应该在 81 和所有这些零之间包含一个小数点？）

当然，如果结果是双精度，那么尾随零仅在您将其包含的数字呈现为文本时才相关？

在这种情况下，您需要做的就是在您需要的地方格式化该文本。

不知道您正在使用哪种语言，我无法为您提供该格式化命令的精确语法，但在这里快速搜索应该可以帮助您。

# postgresql - Postgresql 9.2 日期范围与条件重叠

> ID：12591427
> 
> 赞同：1
> 
> 时间：2012-09-25T21:37:43.273
> 
> 标签：postgresql, range, date-range, postgresql-9.2

正如我在文档中看到的那样，有可能创建将拒绝重叠范围的 gist 索引

```
CREATE TABLE room_reservation (
    room text,
    during daterange,
    EXCLUDE USING gist (room WITH =, during WITH &&)
); 
```

它工作得很好，但是如何调整它以不计算无限范围 - '（，）'（例如从 -inf 到 inf 的范围）重叠到除了 self 之外的任何东西。例如，我想只允许添加一个无限边界的行，而休息日期范围应该只使用 && 运算符来检查。

有效数据：

```
| 房间 | 期间|
| r1 | (,) |
| r2 | (10.09.2012, 10.09.2013) |
| r2 | (11.09.2013, 11.11.2013 |

```

并插入带有 during = (01.01.2013, 01.01.2015) 的行会抛出错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T10:07:20.110

展开 jug 的评论

```
 EXCLUDE USING gist (room WITH =, during WITH &&) WHERE( !isempty(during)) 
```

# wcf - 具有 WCF POCO 的实体框架参照完整性问题

> ID：12591430
> 
> 赞同：2
> 
> 时间：2012-09-25T21:37:58.467
> 
> 标签：wcf, entity-framework, poco

我有一个相当简单的场景，我似乎无法获得正确的逻辑。我正在使用带有 POCO 的 WCF 服务来读取数据并将数据写入数据库。我有一个关键字表，其中有一个外键 UserID 链接到 UserProfile 表。我正在添加和修改关键字集合，但是当我尝试在 GetKeywords 方法中包含 UserProfile 然后进行一些更改并调用 StoreKeywords 方法时，我遇到了参照完整性问题。如果我不包含 UserProfiles，我可以添加和更新没有问题。我使用支持 WCF 的 POCO 生成器并修改了 T4 以删除虚拟并使用 FixupCollections。

任何帮助将非常感激。提前致谢。

获取关键字服务：

```
 public class Service : IService
    {
    public List<Keyword> GetKeywords()
    {
        var context = new myDBEntities();

        var query = from c in context.Keywords
                        .Include("UserProfile")
                    select c;

        //var query = from c in context.Keywords.Take(100)
        //            select c;

        return query.ToList();

    } 
```

调用 GetKeywords 的客户端代码进行一些更改，然后调用 StoreKeywords：

```
 public partial class MainWindow : Window
{
    ObservableCollection<Keyword> keylist;
    public MainWindow()
    {
        InitializeComponent();
        PopulateGrid();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        myServiceClient client = new myServiceClient();

        List<Keyword> updates = new List<Keyword>();

        foreach (Keyword keyword in keylist)
        {
            if (keyword.State == State.Added)
            {
                keyword.CreationDate = DateTime.Now;
                updates.Add(keyword);
            }

            if (keyword.State == State.Modified)
            {
                keyword.EditDate = DateTime.Now;
                if (keyword.IsVoid == false) keyword.VoidDate = null;
                if (keyword.IsVoid == true) keyword.VoidDate = DateTime.Now;
                updates.Add(keyword);
            }
        }

        client.StoreKeywords(updates.ToArray());

        foreach (var kw in keylist)
        {
            kw.State = State.Unchanged;
        }

        PopulateGrid();
        gridControl1.RefreshData();
    }

    private void PopulateGrid()
    {
        myServiceClient client = new myServiceClient();

        keylist = new ObservableCollection<Keyword>(client.GetKeywords());

        gridControl1.ItemsSource = keylist;

    } 
```

StoreKeywords 服务：

```
public string StoreKeywords(List<Keyword> keywords)
    {
        try
        {
            using (var context = new myDBEntities())
            {
                context.ContextOptions.LazyLoadingEnabled = false;

                foreach (Keyword kw in keywords)
                {

                        context.Keywords.Attach(kw);
                        context.ObjectStateManager.ChangeObjectState(kw, StateHelpers.GetEquivalentEntityState(kw.State));

                }
                context.SaveChanges();
                return "";
            }
        }
        catch (Exception ex)
        {

            return ex.Message;
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T16:34:35.853

[在搜索互联网后，我在这里](https://stackoverflow.com/questions/8315654/persisting-disconnected-poco-entities)找到了我的问题的答案，这对我来说根本不明显。问题出在 GetKeyword() 方法中，因为它试图跟踪合并。新的 GetKeywords() 方法：

```
public List<Keyword> GetKeywords()
    {
        var context = new InstanexDBEntities();
        context.Keywords.MergeOption = MergeOption.NoTracking; 

        var query = from c in context.Keywords
                        .Include("UserProfile").Take(100)
                    select c;

        return query.ToList();

    } 
```

# lisp - Dribble 正在生成空的输出文件

> ID：12591432
> 
> 赞同：4
> 
> 时间：2012-09-25T21:37:59.080
> 
> 标签：lisp, common-lisp, clisp

我需要为 lisp 中的程序创建一个输出文件，但我无法通过 Dribble 正确记录我的输出。我正在使用 lispbox，当我尝试使用 dribble 时，我的缓冲区看起来像这样：

```
(dribble "output.txt")
"output.txt"
... Calls to functions I defined
... I've tried entering expressions, values, strings
(dribble)
NIL 
```

但是当我转到 output.txt 时，我有一个 0 字节的空文件。我正在拔头发，因为我找不到答案，而且似乎我的电脑是问题所在。任何关于从哪里开始解决此问题（或解决方案）的想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:49:22.850

我敢打赌`dribble`，正在重新绑定一些与 SLIME 使用的流不同的流，以获取与 REPL 之间的输出。（问题[DRIBBLE-TECHNIQUE](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Issues/iss140-writeup.html)可能值得一读。）

您的解决方案取决于您在做什么。如果您只想记录您与 Lisp 的交互，请记住 emacs 是一个文本编辑器，您可以将 REPL 缓冲区的内容保存到文件或复制摘录。

如果您想编写一个将输出保存到文件的程序，这`dribble`不是一个好的机制。看看 [`open`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_open.html), [`close`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_close.html#close), [`print`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_writecm_p_rintcm_princ.html), [`format`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/mac_with-open-file.html#with-open-file)和 [`with-open-file`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/mac_with-open-file.html#with-open-file)。

# mysql - MySQL中的分组结果

> ID：12591437
> 
> 赞同：1
> 
> 时间：2012-09-25T21:38:20.100
> 
> 标签：mysql, group-by

我的大脑正在变成木薯粉，试图弄清楚这一点。我有一张下属和上司的表格。每个员工都有一些课程。这是一个例子。

我有三个字段：employee_id、name、supervisor_id

Fred Wilkie 是一名主管，他的记录是……

```
employee_id: 1
name: Fred Wilkie
supervisor_id: NULL 
```

Ted Wilkie 是一个卑微的工人，而 Fred 是他的老板。他的条目看起来像这样......

```
employee_id: 2
name: Ted Wilkie
supervisor_id: 1 
```

我希望我的查询看起来像employee_id、name 和supervisor_id，但如果supervisor_id 为NULL，则supervisor_id 应该等于employee_id。

这有点工作......（我想我只需要以某种方式改进它）

```
select employee_id, name, supervisor_id case when supervisor_id is NULL then employee_id else supervisor_id end from employees order by supervisor_id; 
```

问题在于它首先对所有记录进行排序，其中employee_id 等于supervisor_id，然后它只是吐出剩下的下属......

```
employee_id, name, supervisor_id
1, Fred Wilkie, 1
4, Gail Winston, 4
2, Ted Wilkie, 1
3, Lisa Wilkie, 1
5, Russ Cablas, 4
6, Ben Reynolds, 4
etc, etc, etc... 
```

我想要的是这个……

```
employee_id, name, supervisor_id
1, Fred Wilkie, 1
2, Ted Wilkie, 1
3, Lisa Wilkie, 1
4, Gail Winston, 4
5, Russ Cablas, 4
6, Ben Reynolds, 4
etc, etc, etc... 
```

在上面的示例中，我列出了第一个主管 (Fred) (employee_id = supervisor_id)，然后是他的所有下属。然后是盖尔，还有她的所有部下等等。我觉得我的组夫很弱。

我们经营着一家大公司（250 名员工），所以我们想要一种方法将其保留在 MySQL 逻辑中。有人有想法吗？

非常感谢！珍妮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T06:24:23.947

最简单的解决方案是使用`COALESCE`

```
SELECT  employee_ID,
        name,
        COALESCE(supervisor_id, employee_id) AS supervisor_id
FROM    employees
ORDER BY supervisor_id, employee_ID 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/46ef4/1)

附加查询（*如果您想获取他们的主管姓名而不是 id*）

```
SELECT  a.employee_ID,
        a.name,
        COALESCE(b.name, a.name) AS Supervisor_Name
FROM    employees a
        LEFT JOIN employees b
          ON a.supervisor_ID = b.employee_ID
ORDER BY COALESCE(b.supervisor_id, a.employee_id), employee_ID 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/46ef4/7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T05:25:22.430

我认为你错过了获取你正在使用的记录的序列，`order by`但没有强调序列`ASC`或`DESC`

```
select employee_id, name, 
supervisor_id case when supervisor_id is NULL 
then employee_id else supervisor_id end 
from employees 
order by supervisor_id
ASC; 
```

希望这有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:45:31.023

```
select employee_id, name, supervisor_id case when supervisor_id is NULL then employee_id else supervisor_id end from employees order by supervisor_id ASC; 
```

应该做的伎俩...

# truetype - 如何在 ttf 中呈现零宽度字形？

> ID：12591439
> 
> 赞同：1
> 
> 时间：2012-09-25T21:38:43.827
> 
> 标签：truetype, typography

我正在使用 Javascript 开发 TrueType 字体解析/渲染引擎。来源可以在[这里](https://github.com/samlecuyer/fontificate)找到。

我的问题是`space`字形在表格中几乎总是`loca`作为零宽度索引，这意味着当我在`loca`偏移量中查找字形时，我会得到字形的偏移量`exclam`。位置表的[规范](https://developer.apple.com/fonts/TTRefMan/RM06/Chap6loca.html)说：

> 如果字体不包含缺失字符的轮廓，则第一个和第二个偏移量应该具有相同的值。这也适用于没有轮廓的任何其他字符，例如空格字符。如果字形没有轮廓，则其长度应为零。

所以，看起来空格字符没有轮廓，但我不想绘制`.notdef`字形。如果没有设置字形轮廓，我如何决定绘制什么（或至少水平偏移）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:35:05.777

字符的这个宽度在`hmtx`表格中设置，字形必须以该宽度呈现，无论是否为它定义了轮廓。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-07T19:07:31.453

字形不是零宽度 - 它由零字节定义。你没有为它画任何东西。提前宽度在其他表中定义，通常是 hmtx。与其他字形一样，高级排版控件可能会修改此高级宽度。

# linq - Linq 查询“对象引用未设置为对象的实例”

> ID：12591440
> 
> 赞同：0
> 
> 时间：2012-09-25T21:38:43.940
> 
> 标签：linq

我有 2 个简单的 web 服务方法来查询我通过 javascript 查询的 XML 文档（存储在 HTTP 缓存中）。`GetCitiesForAffiliate()`当我为 aff 参数传入一个完全有效的数据项时，该方法会在“选择新”行上抛出 NullReferenceException。它适用于 aff 参数中的其他数据。另一种方法也可以正常工作，即使使用相同的 aff 参数会导致另一种方法炸毁。

我刚刚验证了我正在查询的 XML。当我传入一个不存在的 aff 时，这两种方法都只返回一个空的 json 字符串，这没关系。我应该看什么可能是错的？

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string GetCitiesForAffiliate(string aff)
    {
        LocationService loc = new LocationService();
        var query = (from center in loc.centersXml.Descendants("Center")
                     where center.Element("ServiceArea").Value.Equals(aff)
                     select new {
                         City = center.Element("City").Value
                     }).Distinct().OrderBy(x => x.City);

        JavaScriptSerializer serializer = new JavaScriptSerializer();
        string json = serializer.Serialize(query);

        return json;
    }

    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string GetCentersForAffiliateCity(string aff, string city)
    {
        LocationService loc = new LocationService();
        var query = (from center in loc.centersXml.Descendants("Center")
                     where center.Element("ServiceArea").Value.Equals(aff) && center.Element("City").Value.Equals(city)
                     select new { 
                         ID = center.Element("ID").Value,
                         Name = center.Element("Name").Value 
                     }).Distinct().OrderBy(x => x.Name);

        JavaScriptSerializer serializer = new JavaScriptSerializer();
        string json = serializer.Serialize(query);

        return json;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T13:24:34.260

如果您的某些节点缺少 City 元素，您有一些选择，具体取决于您想要的输出：

1）添加检查以查看`City`元素是否为`null`：

```
City = (center.Element("City") == null ? null : center.Element("City").Value) 
```

2）添加where子句以忽略城市为空的元素：

```
where center.Element("ServiceArea").Value.Equals(aff) 
    and center.Element("City") != null 
```

# javascript - jquery中的“最佳”对象表示法/上下文绑定

> ID：12591442
> 
> 赞同：1
> 
> 时间：2012-09-25T21:38:47.937
> 
> 标签：javascript, jquery, oop

我正在从原型切换到 jquery，并且我正在努力使用“最佳”对象/类表示法。最困扰我的是“this”上下文，当在回调函数（例如事件处理程序，甚至 jquery 的 .each() 方法）中使用时，它不允许我访问对象本身。在原型中我使用 .bind() 或 .bindAsEventListener()，但在 jquery 中我发现只有以下方法：1) 缓存对象指针（在文字表示法中对我来说效果不佳） 2) 使用 $.proxy()方法我发现这两种方法都非常不优雅/丑陋。我有 2 个相同功能的变体（简单的弹出窗口），请告诉我您更喜欢哪一个，以及为什么。或者，您可以提出一些改进建议。非常感谢您的帮助。

变体1：

```
Dialog = function(container, callback) {
  this.init(container, callback);
}

$.extend(Dialog.prototype, {
   init: function(container, callback) {
     this.dialog = $(container);
     this.callback = callback;
     this.buttons = {
       ok: this.dialog.find('[data-type="ok"]'),
       cancel: this.dialog.find('[data-type="cancel"]')
     }
     $.each(this.buttons, $.proxy(function(key, button) {
       button.click($.proxy(function() { this.hide(key); }, this));
     }, this));
   },

   show: function() {
     this.dialog.show();
   },

   hide: function(key) {
     this.dialog.hide();
     this.callback(key);
   }   
}); 
```

变体 2：

```
function Dialog2(container, callback) {
  var self = this;
  self.dialog = $(container);
  self.callback = callback;
  self.buttons = {
    ok: self.dialog.find('[data-type="ok"]'),
    cancel: self.dialog.find('[data-type="cancel"]')
  }
  $.each(self.buttons, function(key, button) {
    button.click(function() { self.hide(key); });
  });

  self.show = function() {
    self.dialog.show();
  }

  self.hide = function(key) {
    self.dialog.hide();
    self.callback(key);
  }
} 
```

使用例如创建实例：

```
var dialog = new Dialog($('#dialog'), function(result){ alert(result); });
dialog.show(); 
```

（另外，我不太确定，为什么在变体 1 中，“this.dialog”是在块“this.buttons = { ... }”中定义的。我建议嵌套对象中的“this”指向匿名嵌套对象本身...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T00:35:29.263

必须有几乎无数种方法来解决这个问题。

绝对避免使用嵌套`$.proxy()`，这会让经验不足的程序员在未来可能需要维护您的代码，而更有经验的程序员会问“为什么？”。

坚持 POJS 构造函数的想法，您`this`几乎可以完全避免通过编写带有私有成员的整个构造函数，`this...`并在末尾加上几个以将某些函数公开为公共方法。

（未经测试）：

```
var Dialog = function(container, callback) {
    //define private members
    var dialog, buttons;
    var init = function() {
        dialog = $(container);
        buttons = {
            ok: dialog.find('[data-type="ok"]'),
            cancel: dialog.find('[data-type="cancel"]')
        };
        $.each(buttons, function(key, button) {
            button.on('click', function() {
                hide(key);
            });
        });
    };
    var show = function() {
        dialog.show();
    };
    var hide = function(key) {
        dialog.hide();
        callback(key);
    };

    //initialize
    init();

    //expose public methods
    this.show = show;
    this.hide = hide;
} 
```

请注意私有函数如何直接访问其他私有成员，包括其他私有函数和实例化时传递的形式变量。公共方法只是对私有函数的引用。

远离简单的构造函数，您可能需要考虑：

*   John Resig 对[简单“类”实例化的思考](http://ejohn.org/blog/simple-class-instantiation)
*   编写一个[jQuery 插件](http://docs.jquery.com/Plugins/Authoring)，允许使用`$('#myDialog').dialog({callback:function(){...}}),`.

插件可能看起来像这样（未经测试）：

```
(function($){
    // **********************************
    // ***** Start: Private Members *****
    var pluginName = 'dialog';
    // ***** Fin: Private Members *****
    // ********************************

    // *********************************
    // ***** Start: Public Methods *****
    var methods = {
        init : function(options) {
            //"this" is a jquery object on which this plugin has been invoked.
            return this.each(function(index){
                var $this = $(this);
                var data = $this.data(pluginName);
                // If the plugin hasn't been initialized yet
                if (!data){
                    var settings = {
                        callback: function(){}
                    };
                    if(options) { $.extend(true, settings, options); }

                    var buttons = {
                        ok: $this.find('[data-type="ok"]'),
                        cancel: $this.find('[data-type="cancel"]')
                    };
                    $.each(buttons, function(key, button) {
                        $this.on('click', button, function() {
                            methods.hide.call($this, key);
                        });
                    });

                    $this.data(pluginName, {
                        target : $this,
                        settings: settings
                    });
                }
            });
        },
        show: function() {
            return this.each(function(index){
                $(this).show();
            });
        },
        hide: function(key) {
            return this.each(function(index){
                $(this).hide().data(pluginName).settings.callback(key);
            });
        }
    };
    // ***** Fin: Public Methods *****
    // *******************************

    // *****************************
    // ***** Start: Supervisor *****
    $.fn[pluginName] = function( method ) {
        if ( methods[method] ) {
            return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || !method ) {
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' + method + ' does not exist in jQuery.' + pluginName );
        }
    };
    // ***** Fin: Supervisor *****
    // ***************************
})( jQuery ); 
```

# php - 短标签打开，但代码未执行

> ID：12591452
> 
> 赞同：2
> 
> 时间：2012-09-25T21:39:28.213
> 
> 标签：php, apache

让我在前面说，我不希望这成为关于您是否应该使用短标签的讨论。我正在尝试运行一个遗留系统，它有数千个 php 代码文件，并且在没有任何错误的情况下全部更改它们不是我们想要使用的解决方案。

话虽如此，我在 php.ini 中启用了短标签。`phpinfo();`我已经通过在有问题的文件中运行并检查那里的设置来验证设置正在生效。但是，`<?`或`<?=`短打开标签内的代码没有被执行，它只是像 HTML 一样打印出来。有人知道为什么会发生这种情况吗？`<?PHP`正常打开标签内的 PHP 代码正在正常执行。原来服务器运行的是 PHP 5.3，由于 5.4 中短标签的变化，我们尝试升级到 5.4.7，但仍然没有成功。

重复评论中的内容：我`phpinfo()`通过将其添加到使用短标签和普通打开标签的文件中并在浏览器中打开它来运行。完整的标签被执行，short 没有。我没有从命令行运行它。Apache 已重新启动。编辑的 php.ini 文件是主 /etc/php.ini 文件。没有 .htaccess 文件更改 webroot 中的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:43:00.047

更改 php.ini 文件后是否重新启动了 Web 服务器？您必须这样做才能使设置生效..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:53:34.347

唯一似乎未经检查的是ini文件中的值正在某处被覆盖。

也许一个过分热心的开发人员在 .htaccess 文件中禁用了它，`ini_set()`或者在[其他地方](http://php.net/manual/en/configuration.changes.modes.php)？

# css - h1、h2、h3 标题中的粗体字 - 92590

> ID：12591453
> 
> 赞同：8
> 
> 时间：2012-09-25T21:39:32.253
> 
> 标签：css, wordpress, wordpress-theming

我需要帮助来了解如何在 WordPress 的优雅主题中获得粗体字体，但仅限于标题区域（h1、h2、h3 等），因为在文本正文中获取它没有问题。

我已经尝试过，即使在编辑器中我得到了粗体标题，但一旦我发布页面，无论我做了什么更改，情况都不是这样。

我包括了代码（不是完整的，而是重要的部分）——“h1”区域中的任何更改都不会在发布后得到反映，甚至字体类型也不会反映，除了大小。我不是编码员，所以也许我缺少一些东西。请帮忙：

```
/*------------------------------------------------*/

/* http://meyerweb.com/eric/tools/css/reset/ */
/* v1.0 | 20080212 */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, font, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend { margin: 0; padding: 0; border: 0; outline: 0; font-size: 100%; vertical-align: baseline; background: transparent; }

body { line-height: 1; }
ol, ul { list-style: none; }
blockquote, q { quotes: none; }

blockquote:before, blockquote:after,q:before, q:after { content: ''; content: none; }

/* remember to define focus styles! */
:focus { outline: 0; }

/* remember to highlight inserts somehow! */
ins { text-decoration: none; }
del { text-decoration: line-through; }

/* tables still need 'cellspacing="0"' in the markup */
table { border-collapse: collapse; border-spacing: 0; }

/*------------------------------------------------*/
/*-----------------[BASIC STYLES]-----------------*/
/*------------------------------------------------*/

body { line-height: 18px; font-family: 'Droid Sans', Arial, sans-serif; font-size: 15px; color: black; text-shadow: 1px 1px 1px #ffffff; background-color: #15191f; }

a { text-decoration: none; color: #00b7f3; }
a:hover { text-decoration: underline; }
.clear { clear: both; }
.ui-tabs-hide { display: none; }
br.clear { margin: 0px; padding: 0px; }

h1, h2, h3, h4, h5, h6 { padding-bottom: 5px; color: #111; letter-spacing: -1px; line-height: 1em; font-weight: bold; }
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a { color: #111; }
h1 { font-size: 30px; font-weight: bold; font-family:"Times New Roman", Times, serif;}
h2 { font-size: 24px; }
h3 { font-size: 22px; }
h4 { font-size: 18px; }
h5 { font-size: 16px; }
h6 { font-size: 14px; }
p { padding-bottom: 10px; line-height: 18px; }
strong { font-weight: bold; color: #1c1c1c; }
cite, em, i { font-style: italic; }
pre, code { font-family: Courier New, monospace; margin-bottom: 10px; }
ins { text-decoration: none; }
sup, sub { height: 0; line-height: 1; position: relative; vertical-align: baseline; }
sup { bottom: 0.8em; }
sub { top: 0.3em; }
dl { margin: 0 0 1.5em 0; }
dl dt { font-weight: bold; }
dd  { margin-left: 1.5em;}
blockquote  { margin: 1.5em; padding: 1em; color: #666666; background: #e6e6e6; font-style: italic; border: 1px solid #dcdcdc; }
    blockquote p { padding-bottom: 0px; }

input[type=text],input.text, input.title, textarea, select { background-color:#fff; border:1px solid #bbb; padding: 2px; color: #4e4e4e; }
input[type=text]:focus, input.text:focus, input.title:focus, textarea:focus, select:focus { border-color:#2D3940; color: #3e3e3e; }
input[type=text], input.text, input.title, textarea, select { margin:0.5em 0; }
textarea { padding: 4px; }

img#about-image { float: left; margin: 3px 8px 8px 0px; }

.clearfix:after { visibility: hidden; display: block; font-size: 0; content: " "; clear: both; height: 0; }
* html .clearfix             { zoom: 1; } /* IE6 */
*:first-child+html .clearfix { zoom: 1; } /* IE7 */

/*------------------------------------------------*/
/*---------------[MAIN LAYOUT INFO]---------------*/
/*------------------------------------------------*/

#top { background: url(images/top-bg.png) repeat-x; }
    #top-wrapper { background: url(images/top-wrapper-bg.jpg) no-repeat top center; }
        #top-content { background: url(images/top-content-bg.png) repeat-x bottom left; }
            #bottom-light { background: url(images/bottom-light-bg.png) no-repeat bottom center; }
                .container { text-align: left; margin: 0 auto; width: 960px; position: relative; }
                    #top .container { padding-bottom: 60px; } 
                        #logo { margin: 65px 13px 35px; }
                        #menu { background: url(images/left-menu-bg.png) no-repeat top left; padding-left: 11px; height: 49px; }
                            #menu-right { background: url(images/right-menu-bg.png) no-repeat top right; padding-right: 11px; height: 49px; }
                                #menu-content { background: url(images/content-menu-bg.png) repeat-x; height: 49px; }
                        #social-icons { float: right; margin-right:23px; margin-top: 17px; }
                            #social-icons a { padding-left:4px; }       

#content { background: url(images/content-bg.png); border-top: 1px solid #ffffff; } 
    #content-shadow { background: url(images/content-shadow-bg.png) repeat-x top left; padding-top: 70px; padding-bottom: 37px; }   
        #services { margin-bottom: 40px; }
            .service { margin-right: 45px; width: 238px; float:left; position:relative; padding-left: 52px; }
                .last { margin-right: 0px; }
                    img.icon { position:absolute; top: 0px; left: 0px; }
                    .service h3.title  { font-size: 24px; margin-bottom: 8px; color: #1f262d; }
                    .service p { line-height: 21px; }
                    .service a.readmore { background:url(images/readmore.png) no-repeat right bottom; color:#1c2329; display:block; font-size:11px; height:24px; line-height:24px; padding-right:10px; text-shadow:1px 1px 1px #ffffff; display:block; float:right; }
                        .service a.readmore span { background:url(images/readmore.png) no-repeat;
display:block; height:24px; padding-left: 12px; padding-right: 2px; }
                        .service a.readmore:hover { color: #000; } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T13:53:28.270

尝试 CSS font-weight 属性值：

```
h1, h2, h3, h4, h5, h6 {

  font-weight:100;

} 
```

您可以`100, 200, 300, 400, 500, 600, 700, 800 to 900.`将属性值调整为`900`最厚和`100`最轻的值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-09-19T09:49:16.287

尝试添加

```
h1{
font-weight: bold;
} 
```

到您的外部 css 文件，或替换您的

```
<h1> your text here </h1> 
```

和

```
<h1 style="font-weight: bold"> your text here </h1> 
```

# python - KDEUI KAactionSelector 小部件附加信号 (PyQt)

> ID：12591456
> 
> 赞同：1
> 
> 时间：2012-09-25T21:40:00.367
> 
> 标签：python, pyqt, kde

我正在尝试创建一个使用两个 GUI 元素的对话框：KDEUI KActionSelector 和 QTExtEdit。我希望能够在鼠标单击时在 ActionSelector 的两个窗口中的任何一个中填充有关对象的一些附加信息。在引擎盖下：我有一本 python 字典。字典的键是 ActionSelector 中显示的条目。当单击任一侧的任何条目时，我希望能够捕获该信号，了解单击了哪个键并在 QTextEdit 中显示相应的值。这应该有助于用户决定移动或不移动所选项目。

如果这并不容易，那么替代解决方案可能是使用两个列表小部件而不是 kActionSelector 并重新实现整个管理 shebang，但我当然想避免这种情况；）

我也担心 KDE 元素的使用是否可以安全地用于可能运行不同版本的 Linux 的不同机器上......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:00:01.410

不幸的是，KActionSelector 的 API 使用起来有点麻烦，所以我通过使用两个 QListWidgets 和两个 QPushButtons 来实现我需要的功能，分别标记为“>>”和“<<”。

单击按钮后，我将从当前列表中删除选定元素并将其添加到另一侧的列表中。

单击任一列表中的任何元素都会根据字典检查所选项目，其中元素应该是字典键。如果字典中不存在该元素，则抛出的 KeyError 将在 try:except 块中捕获。

# json - Scala 2.10 + Json 序列化和反序列化

> ID：12591457
> 
> 赞同：37
> 
> 时间：2012-09-25T21:40:00.910
> 
> 标签：json, scala, scala-2.10, lift-json

Scala 2.10 似乎打破了一些旧的库（至少目前是这样），比如 Jerkson 和 lift-json。

目标可用性如下：

```
case class Person(name: String, height: String, attributes: Map[String, String], friends: List[String])

//to serialize
val person = Person("Name", ....)
val json = serialize(person)

//to deserialize
val sameperson = deserialize[Person](json) 
```

但是我很难找到与 Scala 2.10 一起使用的生成和反序列化 Json 的现有方法。

在 Scala 2.10 中是否有这样做的最佳实践方法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-01-05T00:04:06.400

[Jackson](http://jackson.codehaus.org/)是一个快速处理 JSON 的 Java 库。Jerkson 项目包含了杰克逊，但似乎被放弃了。我已切换到 Jackson 的[Scala 模块](https://github.com/FasterXML/jackson-module-scala)，用于对原生 Scala 数据结构进行序列化和反序列化。

要获得它，请在您的 中包含以下内容`build.sbt`：

```
libraryDependencies ++= Seq(
  "com.fasterxml.jackson.module" %% "jackson-module-scala" % "2.1.3",
   ...
) 
```

然后，您的示例将使用以下 Jackson 包装器逐字运行（我从 jackson-module-scala 测试文件中提取它）：

```
import java.lang.reflect.{Type, ParameterizedType}
import com.fasterxml.jackson.databind.ObjectMapper
import com.fasterxml.jackson.module.scala.DefaultScalaModule
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.core.`type`.TypeReference;

object JacksonWrapper {
  val mapper = new ObjectMapper()
  mapper.registerModule(DefaultScalaModule)

  def serialize(value: Any): String = {
    import java.io.StringWriter
    val writer = new StringWriter()
    mapper.writeValue(writer, value)
    writer.toString
  }

  def deserialize[T: Manifest](value: String) : T =
    mapper.readValue(value, typeReference[T])

  private [this] def typeReference[T: Manifest] = new TypeReference[T] {
    override def getType = typeFromManifest(manifest[T])
  }

  private [this] def typeFromManifest(m: Manifest[_]): Type = {
    if (m.typeArguments.isEmpty) { m.runtimeClass }
    else new ParameterizedType {
      def getRawType = m.runtimeClass
      def getActualTypeArguments = m.typeArguments.map(typeFromManifest).toArray
      def getOwnerType = null
    }
  }
} 
```

其他 Scala 2.10 JSON 选项包括 Twitter 的[scala-json](https://github.com/stevej/scala-json)，它基于 Programming Scala 书——它很简单，但以性能为代价。还有[spray-json](https://github.com/spray/spray-json)，它使用[parboiled](https://github.com/sirthias/parboiled/wiki)进行解析。最后，[Play 的 JSON 处理](http://mandubian.com/2012/11/11/JSON-inception/)看起来不错，但它并不容易与 Play 项目解耦。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-05T02:12:40.907

**提到**包装 jackson、lift-json 或它自己的本机实现作为长期解决方案的json4s ：

*   [代码](https://github.com/json4s/json4s)
*   [网站](http://json4s.org/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-07T20:39:27.053

我可以衷心推荐[argonaut](http://argonaut.io/)在 scala 中支持 json。您只需将其配置为序列化您的 Customer 对象，只需一行：

```
implicit lazy val CodecCustomer: CodecJson[Customer] =
casecodec6(Customer.apply, Customer.unapply)("id","name","address","city","state","user_id") 
```

这将拉皮条你的类给它一个`.asJson`方法，把它变成一个字符串。它还将拉皮条字符串类给它一个`.decodeOption[List[Customer]]`解析字符串的方法。它可以很好地处理您班级中的选项。这是一个通过测试的工作类和一个正在运行的 main 方法，您可以将其放入 argonaut 的 git clone 中以查看它是否正常工作：

```
package argonaut.example

import org.specs2.{ScalaCheck, Specification}
import argonaut.CodecJson
import argonaut.Argonaut._

case class Customer(id: Int, name: String, address: Option[String],
                    city: Option[String], state: Option[String], user_id: Int)

class CustomerExample extends Specification with ScalaCheck {

  import CustomerExample.CodecCustomer
  import CustomerExample.customers

  def is = "Stackoverflow question 12591457 example" ^
    "round trip customers to and from json strings " ! {
      customers.asJson.as[List[Customer]].toOption must beSome(customers)
    }
}

object CustomerExample {

  implicit lazy val CodecCustomer: CodecJson[Customer] =
    casecodec6(Customer.apply, Customer.unapply)("id","name","address","city","state","user_id")

  val customers = List(
    Customer(1,"one",Some("one street"),Some("one city"),Some("one state"),1)
    , Customer(2,"two",None,Some("two city"),Some("two state"),2)
    , Customer(3,"three",Some("three address"),None,Some("three state"),3)
    , Customer(4,"four",Some("four address"),Some("four city"),None,4)
  )

  def main(args: Array[String]): Unit = {

    println(s"Customers converted into json string:\n ${customers.asJson}")

    val jsonString =
      """[
        |   {"city":"one city","name":"one","state":"one state","user_id":1,"id":1,"address":"one street"}
        |   ,{"city":"two city","name":"two","state":"two state","user_id":2,"id":2}
        |   ,{"name":"three","state":"three state","user_id":3,"id":3,"address":"three address"}
        |   ,{"city":"four city","name":"four","user_id":4,"id":4,"address":"four address"}
        |]""".stripMargin

    var parsed: Option[List[Customer]] = jsonString.decodeOption[List[Customer]]

    println(s"Json string turned back into customers:\n ${parsed.get}")

  }
} 
```

开发人员也乐于助人，并且对人们入门时做出反应。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-17T08:46:55.447

现在有一个支持 Scala 2.10 的 Jerkson 分支，位于[https://github.com/randhindi/jerkson](https://github.com/randhindi/jerkson)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-01T03:23:09.530

因此，基于没有错误消息和不正确的示例代码，我怀疑这更像是一个不了解lift-json 提取如何工作的问题。如果我误解了，请发表评论并让我知道。所以，如果我是对的，那么这就是你需要的。

序列化：

```
import net.liftweb.json._
  import Extraction._

implicit val formats = DefaultFormats

case class Person(...)
val person = Person(...)
val personJson = decompose(person) // Results in a JValue 
```

然后要扭转这个过程，你会做类似的事情：

```
// Person Json is a JValue here.
personJson.extract[Person] 
```

如果那不是您遇到问题的部分，请告诉我，我可以尝试修改我的答案以提供更多帮助。

# autocomplete - 获取短语的 solr 自动建议结果

> ID：12591464
> 
> 赞同：6
> 
> 时间：2012-09-25T21:40:27.480
> 
> 标签：autocomplete, solr, autosuggest

我想使用 solr 为搜索字段创建自动建议下拉列表，但在尝试获取短语建议时遇到了困难。当我搜索“dog t”时，我想得到一个包含诸如“dog Treat”、“dog trick”、“dog tags”等短语的结果集，但是我得到了2个结果集，一个是“dog "（例如“dogs”“dog bone”“doggy”...）和另一个用于“t”（例如“tree”“time”...）

我的查询网址是：

```
http://localhost:8985/solr/mycollection/suggest?q=%22dog%20t%22&wt=json 
```

我的请求处理程序在 solrconfig 中定义为...

```
<searchComponent class="solr.SpellCheckComponent" name="suggest">
    <lst name="spellchecker">
      <str name="name">suggest</str>
      <str name="classname">org.apache.solr.spelling.suggest.Suggester</str>
      <str name="lookupImpl">org.apache.solr.spelling.suggest.tst.TSTLookup</str>
      <str name="field">suggest</str>  <!-- the indexed field to derive suggestions from -->
      <float name="threshold">0.0001</float>
      <str name="buildOnCommit">true</str>
    </lst>
<str name="queryAnalyzerFieldType">textSuggest</str>
  </searchComponent>

  <requestHandler class="org.apache.solr.handler.component.SearchHandler" name="/suggest">
    <lst name="defaults">
      <str name="spellcheck">true</str>
      <str name="spellcheck.dictionary">suggest</str>
      <str name="spellcheck.onlyMorePopular">true</str>
      <str name="spellcheck.count">10</str>
    </lst>
    <arr name="components">
      <str>suggest</str>
    </arr>
  </requestHandler> 
```

“建议”的字段类型在模式中定义为

```
 <fieldType name="textSuggest" class="solr.TextField" positionIncrementGap="100" >
      <analyzer type="index">
 <tokenizer class="solr.KeywordTokenizerFactory"/>
   <filter class="solr.LowerCaseFilterFactory"/>
 <filter class="solr.ShingleFilterFactory" maxShingleSize="3" outputUnigrams="true" />
<filter class="solr.WordDelimiterFilterFactory"
                generateWordParts="1"
                generateNumberParts="1"
                catenateWords="0"
                catenateNumbers="0"
                catenateAll="0"
                preserveOriginal="1" splitOnCaseChange="1"
                />
 </analyzer>
<analyzer type="query">
   <tokenizer class="solr.KeywordTokenizerFactory"/>
   <filter class="solr.LowerCaseFilterFactory"/>
 </analyzer>
    </fieldType> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T19:39:54.833

我找到了2个解决我的问题的方法...

一种是创建一个不将 q 参数拆分为多个单词的自定义 queryHandler。

*   [http://wiki.apache.org/solr/Suggester?highlight=%28suggest%29#Tips_and_tricks](http://wiki.apache.org/solr/Suggester?highlight=%28suggest%29#Tips_and_tricks)
*   [https://issues.apache.org/jira/browse/SOLR-3143](https://issues.apache.org/jira/browse/SOLR-3143)
*   [http://lucene.472066.n3.nabble.com/suggester-issues-td3262718.html](http://lucene.472066.n3.nabble.com/suggester-issues-td3262718.html)

我选择的另一个选项是使用参数 spellcheck.q 而不是 q。我正在使用 solr 3.4.0 并使用 spellcheck.q 给了我 500 错误。我将 solr 更新到 3.6.1，现在它似乎可以正常工作了。

*   [http://lucene.472066.n3.nabble.com/Spell-Checking-a-multi-word-phrase-td2274531.html](http://lucene.472066.n3.nabble.com/Spell-Checking-a-multi-word-phrase-td2274531.html)
*   [SolR：使用 spellcheck.q 时出现 NullPointerException](https://stackoverflow.com/questions/7149754/solr-nullpointerexception-when-using-spellcheck-q)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-05T18:36:07.277

SOLR 提供诸如**FST**（从领域开始的建议）、**AnalyzingInfix**等建议器，我们可以利用它们来生成智能的短语/单词自动建议。阅读本文以了解有关实施的更多信息 [http://lucidworks.com/blog/solr-suggester/](http://lucidworks.com/blog/solr-suggester/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T12:15:35.110

非常简单易懂。[http://www.andornot.com/blog/post/Advanced-autocomplete-with-Solr-Ngrams-and-Tw​​itters-typeaheadjs.aspx](http://www.andornot.com/blog/post/Advanced-autocomplete-with-Solr-Ngrams-and-Twitters-typeaheadjs.aspx)

# ruby-on-rails-3 - Rails 在页面上为每个模型记录重复表单

> ID：12591465
> 
> 赞同：0
> 
> 时间：2012-09-25T21:40:31.270
> 
> 标签：ruby-on-rails-3, simple-form, form-for

假设我有一个模型宠物。在我的控制器中，我有

@pets = current_user.pets.all

在我看来，我会有类似的东西：

```
 <%= simple_form_for @pets  do |f| %>

    <%= f.input :name %> 
    <%= f.input :type %>
    <%= f.input :age %>

 <% end %> 
```

我想要它，以便为@pets 中的每个项目创建一个表单，但我尝试过的任何方法都没有奏效，谷歌搜索也没有帮助。似乎它应该是一件容易的事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T06:17:48.487

在你的控制器中尝试这个

```
@pets = current_user.pets 
```

# javascript - 如何滚动到具有特定 div 类的第一个可见元素？

> ID：12591466
> 
> 赞同：12
> 
> 时间：2012-09-25T21:40:36.657
> 
> 标签：javascript, jquery, scroll

无论如何使用javascript自动滚动到具有某个div类的第一个可见元素？

谢谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-25T21:42:41.693

你应该能够使用这样的东西：

```
$('html, body').animate({
    scrollTop: $('.class:visible:first').offset().top
}, 1000); 
```

**演示：http: [//jsfiddle.net/Blender/xUw54/2/](http://jsfiddle.net/Blender/xUw54/2/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-10T15:51:19.700

可以用普通的 JS 轻松完成：

```
const items = container.getElementsByClassName('active');
const visible = [...items].filter((el) => {
  // jQuery-like :visible selector
  return !!( el.offsetWidth || el.offsetHeight || el.getClientRects().length );
});

if (visible.length > 0) {
  container.scrollTo({
    top: items[0].offsetTop,
    behavior: 'smooth'
  });
} 
```

这假设：

*   `container`是您的可滚动容器，如果您要滚动整个页面，可以用`document`&替换。`window`
*   您正在寻找具有`active`类名的第一个项目。
*   您想要平滑的滚动，`behavior: 'smooth'`如果您希望滚动立即在一次跳转中发生，请删除配置。

[https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTo](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTo)

# makefile - gnu make recipe / target 用 % not working

> ID：12591468
> 
> 赞同：0
> 
> 时间：2012-09-25T21:40:39.947
> 
> 标签：makefile, gnu, gnu-make

使用 GNU Make 3.81

我得到的错误是：

> 制作：没有规则来制作“unittest/build/xlineunittestrunner”所需的目标“unittest/build/inMessages.o”。停止。

我将目标写在makefile中，如下所示：

```
$(BUILDDIR)/%.o: %.c
  $(CC) $(INCLUDES) $(DEFINES) -c $< -o $@ 
```

如果我将`%`(in `$(BUILDDIR)/%.o: %.c`)替换为`inMessages`，它可以工作。我不确定为什么`%`不匹配`inMessages`。

编辑：

我认为问题不在于有其他规则匹配 .o 文件。以下是 makefile 中的完整规则列表：

```
all: printinfo checkdirs $(BUILDDIR)/xlineunittestrunner

printinfo:
  @echo "SRCS = $(SRCS)" 
  @echo "OBJ  = $(OBJ)"
  @echo "SOURCEDIRS = $(SOURCEDIRS)" 
  @echo "OBJECTS    = $(OBJECTS)"
  @echo "OBJECTSTOBUILD = $(OBJECTSTOBUILD)"
  @echo "BUILDDIR = $(BUILDDIR)"  

$(BUILDDIR)/xlineunittestrunner: $(OBJECTSTOBUILD)
  $(CC) -o $@ -c $^

$(BUILDDIR)/%.o: %.c
  $(CC) $(INCLUDES) $(DEFINES) -c $< -o $@

checkdirs: $(BUILDDIR)

$(BUILDDIR):
  @mkdir -p $@ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T09:21:41.057

当您`%`用`inMessages`它替换时，会将隐式模式规则变成显式规则。显式规则优先于隐式模式规则。一定是有另一个模式规则产生`%.o`.

我会尝试运行 make with`-d -p`并查看匹配的规则。`-r`如果您不使用内置的隐式模式规则，switch 也可能对禁用它们很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T05:48:05.470

做下面的改变它会起作用

> %.o: %.c:
> 
> ```
>  $(CC) $(INCLUDES) $(DEFINES) -c $< -o $(BUILDDIR)/$@ 
> ```

逻辑是 $(BUILDDIR)/%.o 和 $(BUILDDIR)/$@ 是一样的。

如果你不能有针对性地改变食谱:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T15:35:19.517

啊。问题是在将 sourcedirs 添加到 VPATH 时出现（额外字符）错字。模式匹配工作正常，只是找不到任何源代码文件。

# c++ - 在一行中检测系统字节序？

> ID：12591469
> 
> 赞同：2
> 
> 时间：2012-09-25T21:40:41.930
> 
> 标签：c++, endianness

> **可能重复：**
> [在 C++ 程序](https://stackoverflow.com/questions/1001307/detecting-endianness-programmatically-in-a-c-program)
> [C 宏定义中以编程方式检测字节序以确定大端或小端机器？](https://stackoverflow.com/questions/2100331/c-macro-definition-to-determine-big-endian-or-little-endian-machine)

目前，我有以下功能来检测系统字节序：

```
inline bool detectSystemEndianness()
{
    int i = 1;
    char *c = reinterpret_cast<char*>(&i);
    return (c[0] != i);
} 
```

`false`如果是小端，如果是大端，则返回`true`。第一个问题：这个功能可以吗？

第二个问题：我想初始化一个静态变量，而不是这个函数：

```
static bool _systemEndianness = /* SOMETHING */ 
```

怎么做 ？（它必须在执行时而不是在编译时完成......至少我认为是这样）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:46:22.910

2种方式

1) 有一个为各种平台定义的预处理器，这样你就可以在编译时而不是运行时处理各种字节顺序（在不了解所有平台的情况下显着更快但更难实现

2）类似于你的功能：

```
inline bool isLittleEndian()
{
    static const int i = 1;
    static const char* const c = reinterpret_cast<const char* const>(&i);
    return (*c == 1);
}
...
static const bool _systemEndianness = isLittleEndian (); 
```

# css - 如何使用 CSS 在点击时显示/隐藏内容

> ID：12591470
> 
> 赞同：2
> 
> 时间：2012-09-25T21:40:44.890
> 
> 标签：css, wordpress, onclick, show-hide

我已经把这个简单的代码放在一起，仅使用 CSS 来显示/隐藏一些点击内容。它可以在 FF 中按我想要的方式工作，但不能在 Chrome 或 Safari 中工作（在 IE 中尚未测试）

[http://jsfiddle.net/fW3yW/](http://jsfiddle.net/fW3yW/)

有人可以告诉我为什么它在这些浏览器中不起作用并提出替代方案（仅在可能的情况下使用 CSS）？

这是使用代码的网站 - [http://www.themontessoripeople.co.uk/montesori/?page_id=20#policies-list](http://www.themontessoripeople.co.uk/montesori/?page_id=20#policies-list)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:51:24.427

添加了 tabindex，适用于 Chrome：http: [//jsfiddle.net/fW3yW/1/](http://jsfiddle.net/fW3yW/1/)

从这里开始：[css focus not working in safari and chrome](https://stackoverflow.com/questions/5832436/css-focus-not-working-in-safari-and-chrome)

jQuery方法：http: [//jsfiddle.net/fW3yW/12/](http://jsfiddle.net/fW3yW/12/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:53:07.810

你在滥用 CSS。`:focus`伪类用于样式化具有焦点的表单元素，而不是用于链接`<a>`，浏览器可能实现`:focus`不同的地方，然后还有类似的`:active`伪类。

我建议您默认情况下不要使用 CSS 隐藏任何内容，而是使用 jQuery 在加载时隐藏元素，然后在单击链接时使用 jQuery 创建显示/隐藏动画（只需一行代码即可轻松完成）。它更加优雅，适用于更多浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:58:01.513

改用 jQuery……更可靠、更优雅。

[http://www.w3schools.com/jquery/jquery_hide_show.asp](http://www.w3schools.com/jquery/jquery_hide_show.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T21:52:11.223

您正在使用带有 XHTML 文档类型的 CSS3 选择器。我不知道所有浏览器都会处理带有 XHTML doctype 标签的 CSS3——尽管这两个规范不一定捆绑在一起。

您是否尝试过更改文档类型以指示 HTML5？（然后，当然，这会带来各种 HTML5shim 问题......）

# php - 将多维数组插入 MYSQL 数据库

> ID：12591471
> 
> 赞同：0
> 
> 时间：2012-09-25T21:40:56.480
> 
> 标签：php

我有一个多维数组。该数组类似于以下数组：

```
 Array => [link] => http://www.theqlick.com
  => [title] => The Qlick
  => [description] A great way to connect to the Internet
  => [keywords] Search Engine, The Qlick, Noah Smith 
```

和

```
 Array => [link] => http://www.google.com

  => [title] => Google
  => [description] A great search engine
  => [keywords] Google, the web, search engine 
```

对于与上述两个类似的每个数组，我希望它是 1 行。我有一个标题、关键字、描述和 URL 字段供他们输入。但它们似乎没有输入到数据库中。有任何想法吗？？

```
$data = array();
foreach ($links as $link) {
    $output = array(
        "title"       => Titles($link), 
        "link"        => $link,
        "description" => getMetas($link),
        "keywords" => getKeywords($link) 
    );

    if (empty($output["description"])){ 
        $output["description"] = getWord($link);
    }
    $data[] = $output;
}

print_r($data);  

mysql_query("INSERT INTO scan (title, url, description, keywords) VALUES ('".implode("'),('",$data)."')");

if (!mysql_query()) {
    echo "woops";
}

mysql_close($connect); 
```

# android - 将自定义对象存储到 Android 内部存储的最佳方式？

> ID：12591472
> 
> 赞同：4
> 
> 时间：2012-09-25T21:40:56.450
> 
> 标签：android

我有一个自定义对象“TimeSheet”，它本身包含 Calendar、DateFormat 和 int 字段。该应用程序旨在使用其中几个对象，因此我计划在创建它们时将它们存储在列表中，并且我希望应用程序能够在应用程序关闭并重新加载时将这些对象保存到内部存储中他们打开时。

在 Android 开发方面我还是个新手（到目前为止我只发布了一个应用程序），所以我不完全确定最好的方法。我猜 ObjectInputStream 及其对应的输出可能是最好的选择，但我不完全确定。我完全愿意改变我的设计策略，以最简单的方式存储这些 TimeSheet 对象的集合。

任何人都可以从这里推荐一个好的方向，如果可能的话，提供简短、简单的例子？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T23:28:34.997

像这样的事情没有一个正确的答案。很大程度上取决于您存储的数据量。如果您没有太多数据，请使用`SharedPreferences`，如果您有很多数据并且很复杂，请使用`database`. 如果您没有太多数据，我不会使用数据库。您希望使事情尽可能简单，而添加数据库会使事情复杂化。这是一个讨论不同选项的链接。一探究竟。希望能帮助到你：

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-07T23:58:55.407

有两种方法可以做到这一点

1.  将其保存在 SQLite 数据库中。
2.  将对象以 json 格式保存在文件中

[看到这个讨论](https://stackoverflow.com/questions/12554880/android-save-array-of-custom-objects)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:44:43.127

老实说，我建议使用 a`SQLiteDatabase`来存储它们：编写函数将您的 3 个字段映射到数据库（`Calendar`将成为 NUMERIC，`DateFormat`将成为字符串，并且 int 字段将全部是 NUMERIC）并从一行重建您的对象字段在数据库中。它有点重，但会使不可避免的功能扩展更容易。

# javascript - jQuery Opera 选择器问题

> ID：12591478
> 
> 赞同：0
> 
> 时间：2012-09-25T21:41:07.290
> 
> 标签：javascript, jquery, selector, opera

我有这段代码可以在所有浏览器中运行，但由于某种原因，Opera 非常痛苦并引发错误：

```
Uncaught exception: TypeError: 'OBJ.data' is not a function 
```

我有一个名为 Box 的主插件 OBJECT，在其中我有一个名为 content 的变量。

```
Box={
   content:''
} 
```

单击图像后，它将图像的父级“a”分配给 Box.content 变量。

```
Box.content=$(this).parents('a:first'); 
```

然后我在插件的其他地方引用这个：

```
Box.content.dosomething().... 
```

这适用于所有浏览器，除了抛出上述错误的 Opera 和 IE。有任何想法吗？谢谢！

```
;(function($){jQuery.fn.PluginName=function(options){var defaults={
      ....},
     Box={content:''},
     o=$.extend({},defaults,options||{});

function myFunction(){
   // SHOULD BE ABLE TO REFENCE IT HERE....
   Box.content.dosomething();
};

$('.image').bind('click',function(){
   Box.content=$(this).parents('a:first');
   // DO SOME OTHER STUFF
   myFunction();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:17:58.690

发现问题与 IE 有关，并且（尚未检查但我假设）Opera 也在触发 Window resize 事件 onload，该事件（当时 Box.content 变量为空且未分配）。这是一个相关链接： [在此处输入链接描述](https://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer)

# android - 需要一个示例来说明如何在 Holo 主题中设置 EditText 控件的样式，使其更像预 Holo

> ID：12591482
> 
> 赞同：0
> 
> 时间：2012-09-25T21:41:45.780
> 
> 标签：android, android-layout

我正在尝试或多或少地复制其中包含较旧控件的 PSD，同时使用 ICS 中的 ActionBar，他们喜欢具有实际框而不是下划线的旧样式。我如何能够保持全息主题并将控件恢复为旧样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T23:09:54.103

只是想向你展示我是如何做到这一点的快速修复..

[http://www.androidworks.com/changeing-the-android-edittext-ui-widget](http://www.androidworks.com/changing-the-android-edittext-ui-widget)

这涵盖了如何深入设计样式的基础.. 基本上我构建了自己的 9.png 文件..

# php - 多域 PHP 发布和重定向

> ID：12591494
> 
> 赞同：1
> 
> 时间：2012-09-25T21:42:16.707
> 
> 标签：php

类似的问题还有很多。我试图看得很远，甚至尝试使用为类似问题提供的评论和建议，但我被卡住了。我无法实现我想要的。

这两个域都归我所有（Abc.com 和 xyz.com），我对它们拥有完全的权利/访问权

*   用户在 Abc.com 上的表格中输入姓名、学院、金额
*   我需要将结果发布到 xyz.Com/abc.php
*   通知用户“被重定向到 xyz.com 以进行进一步处理”
*   将用户重定向到 xyz.Com/abc.php
*   在 xyz.Com/abc.php 上，向用户显示发布的值（从 Abc.com 接收的值）

这些是我尝试并知道的事情：

*   我知道 curl 仅用于发布，它不能重定向
*   Header() 重定向但发布？我想不是。
*   使用会话变量在同一个域上工作，而不是在域到域上工作

实现这一目标的过程应该是什么。应该有一些方法来实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T11:17:00.797

在 abc.com 上尝试这样的事情：

```
<script type="text/javascript">
  function redirectWarn() {
    alert("Now redirecting you to xyz.com for final processing!");}
</script>

<form method="POST" action="xyz.com/abc.php">
  <input type="text" id="name" name="name">
  <input type="text" id="college" name="college">
  <input type="text" id="amount" name="amount">
  <input type="submit" id="submit" name="submit" onclick="redirectWarn();">
</form> 
```

然后，当用户单击提交时，警报会告诉他们他们被重定向到 xyz.com/abc.php。在该服务器上的那个文件 (xyz.com/abc.php) 中，您需要通过在文件 abc.php 的顶部插入这个 PHP 来获取用户数据：

```
<?php
  $name = $_POST['name'];
  $college = $_POST['college'];
  $amount = $_POST['amount'];
?> 
```

请确保您在 abc.com 上使用某种 javascript 或在 xyz.com 上使用 PHP，以确保用户在重定向之前已将数据输入您的表单字段。此外，如果您要将这些值放入数据库查询或以其他方式在其他地方使用它们，请向互联网承诺您将清理这些值，这样您的网站就不会被黑客入侵并变成恶意软件分发中心。:)

# symfony - 在 Symfony2.1 中以现有形式重新加载或清除数据

> ID：12591495
> 
> 赞同：7
> 
> 时间：2012-09-25T21:42:21.787
> 
> 标签：symfony, symfony-2.1

我们从 Symfony 2.0 升级到 2.1。在 2.0 中，我曾经像这样修改实体并重新加载表单：

```
$form->setData($entity); 
```

[但是 Symfony 2.1 ( https://github.com/symfony/symfony/pull/3322](https://github.com/symfony/symfony/pull/3322) )不再允许这样做。我收到以下错误：

```
You cannot change the data of a bound form 
```

有没有办法将表单重新绑定到实体/重新加载数据？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T16:04:17.030

我做了一些可以解决问题的方法……不知道这是否是最好的方法，但是……

```
public function contactAction(Request $request){
    $task = new myBundle();

    $form = $this->createFormBuilder($task)
        ->add('email', 'text', array('label'=>'E-mail'))
        ->add('message', 'textarea')
        ->add('newsletter', 'checkbox', array('label'=>'blabla','required'=>false))
        ->getForm();

   $cloned = clone $form;

    if ($request->getMethod() == 'POST') {
        $form->bindRequest($request);
        if ($form->isValid()) {
            [... code ...]
            $form = $cloned;
        }
    }
    return $this->render(
         'myBundle:Default:contact.html.twig',
          array('form' => $form->createView())
     );
} 
```

通过克隆刚刚实例化的表单对象，我可以将“完整”对象切换为空对象，并保留所有参数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-28T07:39:55.743

以及在成功发布后重置表单的最明显方法。设置一个“flash”，重定向到表单页面并显示flash：

```
public function contactAction(Request $request)
{
    $contact = new Contact();
    $form = $this->createForm(new ContactType(), $contact);

    $form->handleRequest($request);

    if ($form->isValid()) {
        //...

        $session = $this->container->get('session');
        $session->getFlashBag()->set('success', 'Your message has been sent.');

        return $this->redirect($this->get('router')->generate('contact'));
    }

    return array(
        'form'  => $form->createView(),
    );
} 
```

在你的树枝上：

```
{% if app.session.flashBag.has('success') %}
    {{ app.session.flashBag.get('success')[0] }}
{% endif %} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-26T01:06:08.270

好吧，您可以创建表单的新实例并重新绑定。看起来有点矫枉过正，但它会在紧要关头起作用。

# mysql - MySQL - 在 SELECT 中使用“AS var_name”

> ID：12591498
> 
> 赞同：0
> 
> 时间：2012-09-25T21:42:32.207
> 
> 标签：mysql, sql

以后如何在同一选择中的选择中使用诸如“AS uniqueName”之类的变量？

我试图在 select 中放置一些简单的逻辑，这样我就不必为了做一些简单的事情而遍历结果集：

```
SELECT
CASE emp_crns.ansi_class
    when -1 then 'N'
    when 150 then 0
    when 300 then 1
    when 600 then 2
    when 900 then 3
    when 1500 then 4
    when 2500 then 6
    when 3500 then 8
    else 'X'
end AS crnAnsiClassCode,
CONCAT('REV. ', crnAnsiClassCode, ' ', emp_models.name) AS modelName
FROM
emp_models
JOIN
emp_revisions ON emp_revisions.id=emp_models.revision_id
JOIN
emp_crns ON emp_crns.id=emp_revisions.crn_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:47:31.857

您可以使用子查询来访问您提供的别名：

```
SELECT empcrns.crnAnsiClassCode,
    CONCAT('REV. ', empcrns.crnAnsiClassCode, ' ', emp_models.name) AS modelName
FROM emp_models
JOIN emp_revisions 
    ON emp_revisions.id=emp_models.revision_id
JOIN
(
    SELECT id, 
        CASE ansi_class
            when -1 then 'N'
            when 150 then 0
            when 300 then 1
            when 600 then 2
            when 900 then 3
            when 1500 then 4
            when 2500 then 6
            when 3500 then 8
            else 'X'
        end AS crnAnsiClassCode
    FROM emp_crns
) empcrns
    ON empcrns.id=emp_revisions.crn_id 
```

# regex - 正则表达式查找两个值之间的字符串

> ID：12591504
> 
> 赞同：3
> 
> 时间：2012-09-25T21:43:03.047
> 
> 标签：regex, string, substring

我有一个从监控系统接收到的字符串，该字符串包含 3 个我感兴趣的变量，这些变量是*预先/后固定*的，`c=VAR1; e=VAR2; s=VAR3;`所以我想抓取中间的文本，例如*c=* ; 但我的成功有限，这些是我测试过的一些正则表达式：

```
c=([^;]+);
.+c=(.+);.+
(?<=c=\()(.*?)(?=\;*\))
c=(.*); 
```

完整的警报字符串类似于：

```
alert c=Vari Able1; e=Vari Able2; s=Vari Able3; 
```

但似乎没有人以我期望的方式返回。

任何帮助深表感谢。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:46:26.047

你可以使用类似的东西：

```
(\w+)=([^;]+) 
```

这将获取所有值（键和值），但如果你只追求 c 值：

```
c=([^;]+) 
```

应该捕获`=`和之间的所有内容`;`（`([^;]+)`捕获不是分号的每个字符，重复1次或更多次。）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T18:50:41.223

所以这个问题的最终解决方案是我需要更多地了解我正在使用的工具，特别是 REGEX 引擎......因为它使用 PCRE 所以最终的 REGEX 是：

```
'(?<=c=)[^;]*'
'(?<=e=)[^;]*'
'(?<=s=)[^;]*' 
```

在我正在重新配置的软件中存在的工具中，这给了我正确解释监视器系统警报所需的三个变量。

谢谢大家！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T03:52:24.460

试试这样的，

```
(?<=((alert)?.*=)).*?(?=;) 
```

请参阅**[Lookahead 和 Lookbehind 零宽度断言](http://www.regular-expressions.info/lookaround.html)**。

正则表达式好友截图

![在此处输入图像描述](../Images/1e60271b5d176d9a5237c9b77edae9ff.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T21:53:00.650

您的第一个正则表达式很好，但仅适用于`c`变量，这是适用于所有三个变量的变体：

```
[ces]=([^;]+); 
```

这将查找您的 c 、 e 和 s 变量。

在**PHP**中，您可以像这样执行它：

```
$string = 'c=VAR1; e=VAR2; s=VAR3;';
preg_match_all("/([ces])=([^;]+);/", $string, $out, PREG_PATTERN_ORDER);
$tot = count($out[1]);
for ($i=0;$i<$tot;$i++) {
    echo $out[1][$i]; //will echo 'c' , 'e' , 's' respectively
    echo $out[2][$i]; //will echo 'VAR1' , 'VAR2' , 'VAR3' respectively
} 
```

**更新**：在评论中回答 OP 的问题

上面的循环用于动态分配找到的值，因此如果正则表达式找到 4 、 5 或 10 个变量，则 for 将循环所有这些值。但是，如果您确定您的字符串中只有 3 个变量，您可以一次性直接分配它们，如下所示：

```
$string = 'c=VAR1; e=VAR2; s=VAR3;';
preg_match_all("/([ces])=([^;]+);/", $string, $out, PREG_PATTERN_ORDER);
$$out[1][0] = $out[2][0]; // var $c is created with VAR1 value
$$out[1][1] = $out[2][1]; // var $e is created with VAR1 value
$$out[1][2] = $out[2][2]; // var $s is created with VAR1 value

echo $c; //will output VAR1
echo $e; //will output VAR2
echo $s; //will output VAR3 
```

我在上面的代码中使用 PHP[变量变量。](http://php.net/manual/en/language.variables.variable.php)

# ruby-on-rails - 如何在命名空间中生成soap4r wsdl2ruby 类以避免名称冲突？

> ID：12591505
> 
> 赞同：0
> 
> 时间：2012-09-25T21:43:04.553
> 
> 标签：ruby-on-rails, ruby, soap4r

我在用于 db 的 Address 类和使用 wsdl2ruby （以及其他几个类）生成的 Address 类之间存在命名冲突。我正在使用soap4r。

无论如何要在自己的命名空间中生成soap4r类，以便所有soap4r类都可以看到彼此但不会与我的应用程序冲突？

我宁愿不使用动态生成器（handsoap、savon），因为这会大大增加用户代码的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:47:39.087

Ruby 没有命名空间，它有模块。从源头上看，它看起来像是您正在寻找的`--module_path [desiredModuleName]`选项。`wsdl2ruby`

# ant - 在 Jenkins 中发布 checkstyle 报告

> ID：12591506
> 
> 赞同：0
> 
> 时间：2012-09-25T21:43:07.893
> 
> 标签：ant, jenkins, warnings, static-analysis, checkstyle

我有以下问题 - 我在使用 Jenkins 构建时正在运行 checkstyle ant 任务，并且确实生成了相应的报告，但问题是，当构建完成时，我收到一条消息，指出解析期间出现错误，因为没有找到错误报告。我确认我已将要发布的报告的路径设置为正确的内容（当我将其更改为稍有不同的内容时，我收到一条消息，即 xxx 不存在，但之前版本的路径确实存在）。知道可能出了什么问题吗？为了发布 checkstyle 报告，Jenkins 期望什么格式？我正在使用以下 build.xml

```
 <taskdef
    classpath="libs/checkstyle-5.6-all.jar"
    resource="checkstyletask.properties" />

 <target name="checkstyle" >

        <checkstyle
            config="checkstyle.xml"
            failOnViolation="false" >

            <fileset
                dir="src"
                includes="**/*.java" />

            <formatter type="plain" />

            <formatter type="xml" />

            <formatter
                toFile="checkstyle-result.xml"
                type="xml" />
        </checkstyle>

        <style
            style="checkstyle-noframes.xsl"
            in="checkstyle-result.xml"
            out="checkstyle-result.html" />
    </target> 
```

配置就是`sun-checkstyle`配置。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:48:17.377

尝试在 Jenkins 作业配置中指定 **/checkstyle-result.xml 作为结果文件位置；这将在整个构建工作区中查找结果文件。一切正常后，您可以收紧文件 glob。

如果上述方法不起作用，请发布您从 Jenkins 获得的错误消息以及 checkstyle-results.xml 相对于您工作的工作区目录的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:49:19.460

从[checkstyle 插件网站](https://wiki.jenkins-ci.org/display/JENKINS/Checkstyle+Plugin)：

> Checkstyle 插件在构建工作区中扫描 checkstyle-result.xml 文件并报告发现的警告数。

插件应该寻找 checkstyle-result.xml XML 格式的文件。你没有在你的问题中提到你是如何配置插件的，但是如果你正在寻找 checkstyle-result.html 这可能是问题所在。

# jquery - 插件性能，内存泄漏

> ID：12591520
> 
> 赞同：0
> 
> 时间：2012-09-25T21:44:35.763
> 
> 标签：jquery, jquery-plugins

我正在写一个日期选择器插件。我知道那里有很多这样的插件，但是因为在不久的将来会有一些特殊需求，我认为最好编写自己的解决方案。

代码非常简单直接，但我认为我做错了，因为在我将日历向左移动几次后，它开始变得非常慢。

```
(function ($) {

    var defaults = {
        single: false,
        start: new Date()
    };

    var methods = {

        init: function (options) {

            var configs = $.extend(defaults, options);

            var calendar = $(this[0]);
            calendar.html(build_calendar(configs.single, configs.start));

            var date = new Date(configs.start);
            date.setDate(1);
            date.setMonth(date.getMonth() - 1);

            $("#acalendar_left").live("click", function (e) {
                e.preventDefault();
                calendar.calendar({ single: configs.single, start: date });
            });

        }

    };

    $.fn.calendar = function (method) {

        if (methods[method]) {
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        } else if (typeof method === "object" || !method) {
            return methods.init.apply(this, arguments);
        } else {
            $.error("Method " + method + " does not exist on jQuery.calendar");
        }

    };

    var build_calendar = function (single, start) {

        var html = "";

        html += "<table>";
        html += "<tr>";
        html += "<td>";
        html += "<a href=\"#\" id=\"acalendar_left\">L</a>";
        html += "</td>";

        if (single) {

            html += "<td>" + build_month(start.getFullYear(), start.getMonth()) + "</td>";

        } else {

            for (var i = -1; i < 2; i++) {

                var date = new Date(start);
                date.setDate(1);
                date.setMonth(date.getMonth() + i);

                html += "<td>" + build_month(date.getFullYear(), date.getMonth()) + "</td>";

            }

        }

        html += "<td>";
        html += "<a href=\"#\" id=\"acalendar_right\">R</a>";
        html += "</td>";
        html += "</tr>";
        html += "</table>";

        return html;

    };

    var build_month = function (year, month) {

        var months = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

        var size = (new Date(year, month + 1, 0)).getDate();

        var row = "<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td></tr>";

        var temporary = row;

        var html = "";

        html += "<table>";
        html += "<tr><td colspan=\"7\">" + months[month] + " " + year + "</td></tr>";
        html += "<tr><td>D</td><td>S</td><td>T</td><td>Q</td><td>Q</td><td>S</td><td>S</td></tr>";

        for (var i = 0; i < size; i++) {

            var date = new Date(year, month, i + 1);

            if (date.getDay() == 0 && i > 0) {
                html += temporary;
                temporary = row;
            }

            temporary = temporary.replace("{" + date.getDay() + "}", date.getDate());

            if (i + 1 == size) {
                html += temporary;
            }

        }

        html += "</table>";

        html = html.replace(new RegExp("{[0-9]}", "g"), "");

        return html;

    };

})(jQuery);

$(document).ready(function () {

    $("#dcalendar").calendar();

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:50:33.757

首先 ..`live()`已弃用，您应该使用`on()`.

似乎每次单击时`#acalendar_left`，都会再次创建整个日历，但我看不到您在哪里取消注册该活动；因此该`live()`事件将在下一次运行时触发 2 次，等等，这应该可以解释为什么它越来越慢。

# xcode - Xcode用户输入：输入时只显示第一个字符

> ID：12591528
> 
> 赞同：0
> 
> 时间：2012-09-25T21:45:15.640
> 
> 标签：xcode, input, io

当我在 Xcode（C 语言）中编程时，我正在使用调试控制台（由 Cmd-R 提供）查看程序及其输出，并给它输入，当我输入时，我只输入我输入的第一个字符想要输入显示在控制台上。其余所有对我来说都是不可见且不可选择的。假设我想输入“20”：所有显示的是“2”。它仍然表现得好像我已经输入了所有这些字符（在前面的例子中，20），所以从技术上讲，这个错误（？）不会干扰实际的软件，但是看不到我所有的击键仍然很烦人之前输入的。我在一两天前刚刚更新了 Xcode 并安装了命令行工具（尽管我怀疑后者是否相关）。我相信版本号是4.3左右。有没有人有同样的问题，有没有人找到解决办法？是的，我试过重新启动它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T05:13:47.967

我也有同样的问题。看起来这是一个 XCode 4.5 错误： [https ://discussions.apple.com/message/19701332?tstart=0#19701332?tstart=0](https://discussions.apple.com/message/19701332?tstart=0#19701332?tstart=0)

因此，您可以等待或安装以前的版本。

# regex - 带有否定的 POSIX 字符类

> ID：12591529
> 
> 赞同：0
> 
> 时间：2012-09-25T21:45:22.970
> 
> 标签：regex, lex

我很好奇是否有一个正则表达式来查找可打印的输入（由`POSIX`character class定义`[:print:]`，但也不包含特定字母，例如 letter `a`。

这样的表达式将使我能够查找所有可打印的字符，然后执行其他排除。我最初的想法是使用嵌套字符类来实现这一点，但我认为这不会奏效。

这是针对我正在研究的小型解析器的`lex`——感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:09:16.130

flex （如果你可以使用它）提供了`{-}`提供你正在寻找的东西的运营商：

```
 [[:print:]]{-}[a] 
```

它也有一个`{+}`操作符。不过，它们只适用于字符类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:53:00.693

在 PCRE 和其他具有环视功能的引擎中，您可以使用它（例如`[[:print:]](?<!a)`），但除非它最近发生了变化，否则`lex`不支持环视。

虽然可能有一些方法可以在词法分析器中进行这种区分，但在解析逻辑中这样做可能更清晰。

# perl - perl fork() 和 exec()

> ID：12591537
> 
> 赞同：4
> 
> 时间：2012-09-25T21:45:50.547
> 
> 标签：perl, parallel-processing, exec, fork

为了我自己的学习目的，我正在尝试掌握 fork() 和 exec() 的概念。我正在尝试使用 perl fork 作为第二个相同的进程，然后使用它来执行 .sh 脚本。

如果我使用 fork() 和 exec() 可以让 .sh 脚本与我的 perl 脚本并行运行吗？Perl 脚本不会等待子进程并继续执行。所以我的 perl 脚本不关心子进程的输出，而只关心命令是否有效并且正在运行。有点像调用脚本在后台运行。

我可以实施某种安全措施来知道子进程也正确退出了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T22:00:01.997

> 如果我使用 fork() 和 exec() 可以让 .sh 脚本与我的 perl 脚本并行运行吗？[...] 有点像调用脚本在后台运行。

是的。Fork & exec 实际上是 shell 在后台运行命令的方式。

> 我可以实施某种安全措施来知道子进程也正确退出了吗？

是的，使用[waitpid()](http://perldoc.perl.org/functions/waitpid.html)并查看存储在`$?`

就像@rohanpm 提到的那样，[perlipc](http://perldoc.perl.org/perlipc.html)手册页有很多有用的例子来展示如何做到这一点。这是最相关的之一，其中设置了信号处理程序`SIGCHLD`（当孩子终止时将发送给父母）

```
use POSIX ":sys_wait_h";
$SIG{CHLD} = sub {
    while ((my $child = waitpid(-1, WNOHANG)) > 0) {
        $Kid_Status{$child} = $?;
    }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:12:59.340

要让 waitpid 不等待孩子：

```
use POSIX qw/ WNOHANG /;
my $st = waitpid $pid, WNOHANG; 
```

如果进程仍在运行，则 $st 为 0，如果已收获，则为 pid。

# c++ - waitpid() 和 fork() 限制子进程的数量

> ID：12591540
> 
> 赞同：1
> 
> 时间：2012-09-25T21:46:02.587
> 
> 标签：c++, c, concurrency

我的程序应该将子进程的数量限制为 3。

使用下面的代码，`waitpid`我的父进程停止，因此我无法在第一个子进程之后创建更多子进程。如果我不使用`waitpid`，那么我不知道子进程何时退出以减少活动进程的数量。

```
int numProcs = 0;
while(1==1) {
    /* 
     * inserts code that waits for incoming input 
     */
    numProcs++;
    pid = fork();
    if (pid == 0) {
        doStuff(); // may exit anytime, based on user input
    } else {
        if (numProcs > 3) {
            wait(&status);
            numProcs--;
        } else {
            waitpid(pid, &status, 0); // PROBLEM!
            numProcs--;
        }
    }
} 
```

我整天都在寻找这个问题。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:11:10.297

冒着明显的风险，您基本上只想删除 else 子句。您正在寻找的逻辑是这样的：

```
int max_active = 3; // or whatever
int number_active = 0;
bool done = false;

for (; !done; ++number_active) {
  // wait for something to do;
  GetSomeWork();
  // wait for something to finish, if necessary.
  for (; number_active >= max_active; --number_active)
    wait(&status);
  pid = fork();
  if (pid < 0)
    ReportErrorAndDie();
  if (pid == 0)
    DoTheWorkAndExit();
} 
```

这实际上让您可以在不重新启动的情况下更改 max_active 的值，这是围绕 wait() 调用的 for 循环的唯一理由。

明显的抱怨是我的版本中的 number_active 实际上并没有告诉你有多少进程处于活动状态，这是真的。它告诉你有多少进程没有等待（），这意味着你可能会保留一些僵尸（但数量有限）。如果您始终以或接近最大任务数运行，这无关紧要，除非您的最大值很大，否则无论如何都没关系，因为唯一的设计要求是您使用的任务数不超过任务的最大数量，因此您只需要知道活动的数量不超过最大值。

如果这真的困扰您并且您想清理任务，您可以放置​​：

```
for (; waitpid(-1, &status, WNOHANG) > 0; --number_active) {} 
```

在另一个 for 循环之前，它将在检查是否需要阻止之前收割僵尸。（如果根本没有进程，我不记得 waitpid(-1, &status WNOHANG) 是否返回错误，但无论如何，在出现错误时继续循环是没有意义的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:11:30.407

您的代码有两个问题，但第二个问题被第一个掩盖了。

您的直接问题是 waitpid(pid, &status, 0); 将阻塞，直到具有指定 pid 的进程终止。您想将 WNOHANG 选项作为第三个参数添加到 waitpid() 调用中。这将确保调用不会阻塞。

这将增加一个新问题：您必须自己检查是否有任何子进程已终止。您可以使用 WIFEXITED 宏来做到这一点：

```
} else {
  waitpid (-1, &status, WNOHANG);
  if (WIFEXITED(status)) {
    numProcs--;
  }
} 
```

第二个问题是您的原始代码只等待创建最新的 pid。您应该等待 -1，这是所有子进程。

# locking - 当一个线程使内核禁用中断然后该线程进入睡眠状态时会发生什么

> ID：12591541
> 
> 赞同：2
> 
> 时间：2012-09-25T21:46:03.220
> 
> 标签：locking, kernel, interrupt, thread-sleep

我有这个内核代码，我在其中禁用中断以使该锁获取操作原子化，但是如果您看到最后一个 else 条件，即当锁不可用时，线程进入睡眠状态，并且只有在线程从睡眠状态恢复后才启用中断。我的问题是，整个操作系统都禁用中断，直到该线程退出睡眠？

```
无效锁::Acquire()
{
    IntStatus oldLevel = 中断->SetLevel(IntOff); // 禁用中断以使以下语句具有原子性
    if(lockOwnerThread == currentThread) //检查请求线程是否已经拥有锁
    {
        //printf("SM:error:%s 已经拥有锁\n",currentThread->getName());
        DEBUG('z', "SM:error:%s 已经拥有锁\n",currentThread->getName());
        (void) 中断->SetLevel(oldLevel);
        返回;
    }
    如果（lockOwnerThread==NULL）
    {
       lockOwnerThread = 当前线程；// 锁拥有权赋予当前线程
       DEBUG('z', "SM:锁%s的所有权给%s \n",name,currentThread->getName());
    }
    别的
    {
        DEBUG('z', "SM: 将线程 %s 添加到请求队列并使其进入睡眠状态\n",currentThread->getName());
        queueForLock->Append((void *)currentThread); // 锁很忙，所以将线程添加到队列中；
        当前线程->睡眠（）；// 然后去睡觉
    }
       (void) 中断->SetLevel(oldLevel); // 启用中断
 }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T17:40:20.373

我不知道 NACHOS，我不会自己做任何假设。所以你必须测试它。

这个想法很简单。如果此中断启用/禁用功能在当前进程上下文中是本地的，那么当您调用时应该会发生以下情况`Sleep()`：进程被标记为未运行，即它被排除在`scheduler`将考虑给予 CPU 时间的进程列表之外。然后 Sleep() 函数强制调度程序执行它的常规工作 - 查找要运行的进程。如果正在运行的进程列表不为空，则调度程序选择下一个可用进程并进行上下文切换到该进程。在此之后，中断管理的状态从这个新的上下文中恢复。

如果没有要运行的进程，则调度程序进入`Idle loop`状态并*通常*启用中断。当调度程序在其中时，`Idle loop`它会继续轮询正在运行的进程的队列，直到它得到一些要调度的东西。

当您的进程再次被标记为运行时，您的进程将获得控制权。如果其他一些进程调用`WakeUp()`（或类似的，正如我提到的 API 对我来说是未知的），则可能会发生这种情况

当调度程序将选择您的进程切换到它时，它会执行通常的（对于您的系统）上下文切换，该切换将标志设置为 false，因此在禁用中断`interrupts enabled`的调用后继续执行语句。`Sleep()`

如果上面的假设不正确并且`interrupts enabled`标志是全局的，那么有两种可能性：系统挂起，因为它不能提供中断服务，或者它有一些`workaround`用于这种情况。

所以，你需要尝试。最好的方法当然是阅读内核源代码，如果你有访问权限的话。））

# php - 限制 PHP 的文件系统对文件夹的访问

> ID：12591547
> 
> 赞同：5
> 
> 时间：2012-09-25T21:46:27.167
> 
> 标签：php, apache, security, shared-hosting

我的场景：我有一个运行 Apache 的共享主机帐户，用于个人项目。现在我的一个朋友需要一点空间来为他的曲棍球俱乐部建立一个网站。我决定让他在我的帐户上运行它，并给他一个限制他访问 public_html/hockey 的 FTP 帐户。

我的问题：有没有办法限制他的 PHP 脚本（在他的 hockey 文件夹中），使他们无法访问 hockey 文件夹之外的任何文件？我正在寻找一种解决方案，涉及到 php.ini 或 .htaccess 中的配置。请不要回复告诉我他应该尽量不要访问该文件夹之外的任何内容。我正在尝试提高安全性以防止其代码中的故意访问和意外安全漏洞。

如果您知道如何在沙盒环境中运行他的内容，我们将非常感谢您提供任何建设性的意见。

谢谢，西蒙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T21:52:40.760

您可以使用[`open_basedir`](http://php.net/manual/en/ini.core.php#ini.open-basedir)配置设置来限制 PHP 的范围。例如，要设置`open_basedir`每个目录，`httpd.conf`你会写

```
<Directory /var/www/public_html/hockey>
  php_admin_value open_basedir "/var/www/public_html/hockey"
</Directory> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-28T04:38:47.610

这是完美的..我知道它会在 5.6 中消失，但 5.3.x 仍然会流行很长时间 老实说.. 太多的托管服务提供商担心通过破坏客户的网站而失去业务......我合作过的几个客户的客户仍然在 PHP 4.x 上运行 .. 这是极端的忽视 ..

他们确实推动了他们中的一些人到 5.2 .. 这在他们推动之前很久就已经过时了.. 但事实仍然是你不能把你的整个客户群推到一个新版本.. 他们中的大多数不是开发商，这会让他们花钱，如果他们因为你强迫而取消，就会造成金钱损失。

我已经尝试在我们的系统上隔离共享帐户.. 这就是为什么这很有用.. 我想尽我所能锁定 5.3-5.5 用户.. 所以我使用 php-fcgi .. suexec..等等..所以在他们的虚拟主机中执行这个指令似乎是下一个最好的隔离级别！

我已经在我的虚拟实验室中对此进行了测试，它似乎完全符合我的要求。它使人们无法从 /etc 获取 glob() 文件并找到我们的 passwd 文件以及他们可能想要的其他虚拟主机蛮力...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-27T17:38:36.103

# 不！

您无法 (99%) 使用相同的 CPANEL/帐户实现这一目标。 `open_basedir`, `allowOverride`,`safe_mode`甚至还不够！cgi/perl/cron-jobs 仍然不受保护！

您最好使用 Reseller(WHM) Cpanel 帐户，或 DirectAdmin(cpanel 替代) 多用户帐户。

# jquery - 从下拉选择中将电子邮件直接发送到特定地址

> ID：12591553
> 
> 赞同：0
> 
> 时间：2012-09-25T21:46:41.827
> 
> 标签：jquery, html

我正在处理需要根据下拉选择发送到单独的电子邮件地址的表单。我已经研究过，只发现了几种通过 PHP 实现这一目标的方法。我在只有 HTML 和 CSS 的 CMS 中工作。我需要在 HTML、Jquery 等中完成此操作。

```
<form action="/Task/Form/ProcessForm.cfm" id="contact_form_HL" method="post" name="Contact_Light" onsubmit="return validate()">

    <label>
        <span>Select The Location<span style="color:#FF0000">*</span></span>
        <select class="select-input-patient" name="location">
            <option value="Alabama - Scottsboro">Alabama - Scottsboro</option>
            <option value="Georgia - Cumming">Georgia - Cumming</option>
            <option value="Georgia - Dalton">Georgia - Dalton</option>
        </select>
    </label>
</form> 
```

这些是我的下拉菜单值的示例。他们总共有 22 个，但会随着时间的推移而增长。在上述输入下方，我还有几个选项；姓名，公司等。提前谢谢你。

是的，它不是通过 mailto: 发送的。这是另一个表单提交按钮的示例。

```
 <input class="submit" name="SUBMIT" type="submit" value="SUBMIT" />
 <input name="email_subject" type="hidden" value="Contact Form" />
 <input name="email_form" type="hidden" value="Contact@contact.com" />
 <input name="email_to" type="hidden" value="Contact@contact.com" />
 <input name="email_bcc" type="hidden" value="foo@foo.com" />
 <input name="returnURL" type="hidden" value="/thankyou/" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T07:23:38.663

鉴于它是`email_to`控制邮件发送位置的字段，您只需删除示例中的隐藏输入，并将下拉菜单重命名为`email_to`. 然后，每个的`value`属性`option`应该是每个相应位置的邮件地址。像这样：

```
<form action="/Task/Form/ProcessForm.cfm" id="contact_form_HL" method="post" name="Contact_Light" onsubmit="return validate()">

    <label>
        <span>Select The Location<span style="color:#FF0000">*</span></span>
        <select class="select-input-patient" name="email_to">
            <option value="foo@scottsboro.com">Alabama - Scottsboro</option>
            <option value="foo@cumming.com">Georgia - Cumming</option>
            <option value="foo@dalton.com">Georgia - Dalton</option>
        </select>
    </label>

    <input class="submit" name="SUBMIT" type="submit" value="SUBMIT" />
    <input name="email_subject" type="hidden" value="Contact Form" />
    <input name="email_form" type="hidden" value="Contact@contact.com" />
    <input name="email_bcc" type="hidden" value="foo@foo.com" />
    <input name="returnURL" type="hidden" value="/thankyou/" />
</form> 
```

如果更可取，您当然可以将 email_to 替换为 email_bcc。

# javascript - 如何在 Ember.js 路由器应用程序中获取视图

> ID：12591554
> 
> 赞同：3
> 
> 时间：2012-09-25T21:46:46.443
> 
> 标签：javascript, ember.js, ember-old-router

如果我需要参考特定控制器的视图，我将如何在基于路由器的应用程序中获取它。

我可以得到这样的控制器

```
App.router.get('myController') 
```

但是控制器**不应该而且通常不**知道视图所以

```
App.router.get('myController.view') 
```

^-- 不会工作

这也行不通：

```
App.router.get('myView') 
```

有没有正确的抓法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T03:31:28.320

`App.router.get('myController.view')`应该可以正常工作，`connectOutlet`通过插座的名称将视图设置到控制器上。

然而，它是在控制器上定义的插座，而不是视图，因此要获得基本视图，您需要从 ApplicationController 访问它。

`App.router.get('applicationController.view')`

# java - 实用地自定义android的listView元素

> ID：12591559
> 
> 赞同：0
> 
> 时间：2012-09-25T21:46:56.733
> 
> 标签：java, android, listview

我想为一些 `ListView` 的项目添加一些自定义效果。仅注意到一些字幕，选择时的自定义颜色甚至更改项目的文本值非常花哨。

目前我正在`ListView`像这样生成：

```
ListView listView = new ListView(getActivity());
String[] values = new String[] { "iPhone", "WindowsMobile",
        "Blackberry", "WebOS", "Ubuntu", "Windows7", "Max OS X",
        "Linux", "OS/2" };
ArrayAdapter<String> files = new ArrayAdapter<String>(getActivity(),
        android.R.layout.simple_list_item_1, values);
listView.setAdapter(files); 
```

我应该怎么做才能为列表项添加字幕？或者为特定项目添加一些操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T21:54:10.587

查看本教程[http://www.vogella.de/articles/AndroidListView/article.html](http://www.vogella.de/articles/AndroidListView/article.html)我发现它对我自己很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:16:39.797

我不喜欢创建这样的适配器，它不会为正在发生的事情提供任何透明度或对视图进行太多控制，我更喜欢扩展 BaseAdapter 以与 ListView 一起使用

```
public class MyAdapter extends BaseAdapter {

    private Activity activity;
    private ArrayList<Object> data;
    LayoutInflater inflater;

    public LazyAdapter(Activity a, ArrayList<Object> d) {
    activity = a;
    data=d;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    }

    public int getCount() {
        return data.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View view = convertView;
        if(convertView==null)
            view = inflater.inflate(R.layout.list_row, null);

        //set view values, etc
        return view;
    }
} 
```

使用它，您可以更好地控制 ListView 及其单元格，那里有很多教程，搜索“自定义列表视图”，您应该会找到一些有用的东西

# vba - 搜索多个短语；跨多个工作表复制到单个工作表

> ID：12591563
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:47:33.133
> 
> 标签：vba, excel, search

我正在使用 Microsoft Excel 来跟踪任务。我为每项工作使用不同的“工作表”。该结构与列和数据有关。我一直在尝试创建一个 VBA 脚本来完成以下任务：

1.  在工作表 1 - X 中连续搜索“未结”或“逾期”值
2.  将具有这些值的所有行复制到从第 3 行开始的单个工作表（例如分类帐）中（这样我就可以添加模板的标题）
3.  添加带有工作表名称的 A 列，以便我知道它来自什么工作。
4.  把这个跑到我心里强迫性行为快乐更新新项目

我一直在使用以下帖子来帮助指导我：

*   [搜索特定单词并将行复制到另一个工作表](https://stackoverflow.com/questions/10586984/search-a-specific-word-and-copy-line-to-another-sheet)<- 这很有帮助但不太正确......

*   [根据在标签网格上的搜索将行复制到另一个工作表](https://stackoverflow.com/questions/6924100/copying-rows-to-another-worksheet-based-on-a-search-on-a-grid-of-tags)<-- 也很有帮助，但仅限于活动表，并且我的修改无法正确循环...

过去的两个晚上很有趣，但我觉得我可能会让这变得比必要的更难。

我能够创建一个 VBA 脚本（从此处的另一篇文章编辑）来扫描所有工作表，但它旨在复制一组列中的所有数据。我测试了它并且它有效。然后，我将用于识别 C 列（仅适用于活动表）中的“打开”或“过期”的代码库合并到代码中。我标记了我的编辑以在这里分享。在这一点上，它不起作用，我走路时头晕目眩。任何关于我在哪里对代码进行 fubar-ed 的提示都将不胜感激。我工作的代码库是：

```
Sub SweepSheetsCopyAll()

    Application.ScreenUpdating = False
   'following variables for worksheet loop
    Dim W As Worksheet, r As Single, i As Single
   'added code below for finding the fixed values on the sheet
    Dim lastLine As Long
    Dim findWhat As String
    Dim findWhat1 As String
    Dim findWhat2 As String
    Dim toCopy As Boolean
    Dim cell As Range
    Dim h As Long 'h replaced i variable from other code
    Dim j As Long

    'replace original findWhat value with new fixed value

    findWhat = "Open"
    'findWhat2 = "Past Due"

    i = 4
    For Each W In ThisWorkbook.Worksheets
        If W.Name <> "Summary" Then
           lastLine = ActiveSheet.UsedRange.Rows.Count 'Need to figure out way to loop all rows in a sheet to find last line
            For r = 4 To lastLine 'formerly was "To W.Cells(Rows.Count, 1).End(xlUp).Row"
                'insert below row match search copy function
                For Each cell In Range("B1:L1").Offset(r - 1, 0)
                   If InStr(cell.Text, findWhat) <> 0 Then
                      toCopy = True
                   End If
               Next
            If toCopy = True Then
    ' original code               Rows(r).Copy Destination:=Sheets(2).Rows(j)
     Range(W.Cells(r, 1), W.Cells(r, 12)).Copy _
                        ThisWorkbook.Worksheets("Summary").Cells(i, 1)
                j = j + 1
            End If
            toCopy = False
        'Next

                'end above row match search function
                'below original code that copied everything from whole worksheet
         '       If W.Cells(r, 1) > 0 Then
   '                 Range(W.Cells(r, 1), W.Cells(r, 12)).Copy _
    '                    ThisWorkbook.Worksheets("Summary").Cells(i, 1)
          '          i = i + 1
           '     End If
            Next r
        End If
    Next W
End Sub 
```

扫描所有工作表的工作代码库是：

```
Sub GetParts()
    Application.ScreenUpdating = False
    Dim W As Worksheet, r As Single, i As Single
    i = 4
    For Each W In ThisWorkbook.Worksheets
        If W.Name <> "Summary" Then
            For r = 4 To W.Cells(Rows.Count, 1).End(xlUp).Row
                If W.Cells(r, 1) > 0 Then
                    Range(W.Cells(r, 1), W.Cells(r, 3)).Copy _
                        ThisWorkbook.Worksheets("Summary").Cells(i, 1)
                    i = i + 1
                End If
            Next r
        End If
    Next W
End Sub 
```

并且从 Activesheet 中复制匹配的数据如下：

```
Sub customcopy()

Application.ScreenUpdating = False
Dim lastLine As Long
Dim findWhat As String
Dim findWhat1 As String
Dim findWhat2 As String
Dim toCopy As Boolean
Dim cell As Range
Dim i As Long
Dim j As Long

'replace original findWhat value with new fixed value

findWhat = "Open"
'findWhat2 = "Past Due"

lastLine = ActiveSheet.UsedRange.Rows.Count 'Need to figure out way to loop through all sheets here

'below code does nice job finding all findWhat and copying over to spreadsheet2
j = 1
For i = 1 To lastLine
    For Each cell In Range("B1:L1").Offset(i - 1, 0)
        If InStr(cell.Text, findWhat) <> 0 Then
            toCopy = True
        End If
    Next
    If toCopy = True Then
        Rows(i).Copy Destination:=Sheets(2).Rows(j)
        j = j + 1
    End If
    toCopy = False
Next

i = MsgBox(((j - 1) & " row(s) were copied!"), vbOKOnly, "Result")

Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:08:51.853

[如果表中的值满足条件，](https://stackoverflow.com/questions/12177125/vba-macro-to-copy-row-from-table-if-value-in-table-meets-condition/12177538#12177538)您应该查看此Vba 宏以从表中复制行

在您的情况下，您需要创建一个循环，使用此高级过滤器将数据复制到您的目标范围或数组。

如果您需要进一步的建议，请发布您的代码，以及您遇到的问题。

# javascript - 分组不同的选择选项下拉列表

> ID：12591565
> 
> 赞同：0
> 
> 时间：2012-09-25T21:47:43.127
> 
> 标签：javascript, jquery, html

我不确定这是 html 还是 javascript 技术。我想这样实现，只显示两个选择框，一旦我点击印度，另一个选择框将只显示 Indiacities 选项 `name="listtwo" id="listtwo"`，如果点击 US，则显示我们的城市选项。有人可以举个例子吗。非常感谢

印度 美国 德国

```
 <select name="listtwo" id="listtwo">
        <option value="Indiacity1">Indiacity1</option>
        <option value="Indiacity2">Indiacity1</option>
        <option value="Indiacity3">Indiacity1</option>
    </select>

  <select name="list3" id="list3">
        <option value="Germany1">Germany1</option>
        <option value="Germany2">Germany1</option>
        <option value="Germany3">Germany1</option>
    </select>

<select name="list4" id="list4">
        <option value="US1">US1</option>
        <option value="US2">US1</option>
        <option value="US3">US1</option>
    </select>​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:55:00.610

HTML：

```
<select id="country-select">
    <option>--- Select One ---</option>
    <option value="us">US</option>
    <option value="germany">Germany</option>
</select>

<select id="us-select" class="sub-menu hide">
    <option value="austin">Austin</option>
</select>

<select id="germany-select" class="sub-menu hide">
    <option value="berlin">Berlin</option>
</select>​ 
```

CSS：

```
.hide {
    display: none;            
}​ 
```

jQuery：

```
$('#country-select').change(function (e) {
    $('.sub-menu').hide();
    var selectedCountry = $(this).val();
    if (selectedCountry) {
        $('#' + selectedCountry + '-select').show();
    }       
});​ 
```

任何人都可以查看的小提琴：http: [//jsfiddle.net/RPWPZ/3/](http://jsfiddle.net/RPWPZ/3/)

当然，您必须为印度以及您将关心的任何其他国家/地区添加所有项目。

编辑：如果您想在页面加载时选择一个国家，请查看此 Fiddle 中的更改：http: [//jsfiddle.net/RPWPZ/5/](http://jsfiddle.net/RPWPZ/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T22:09:24.210

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script>
$(function() {

  $('select').hide();
  $('#list2').show();

  $('.country').click(function(e) {
    $('select').hide();
    $('#'+$(e.target).attr('sel')).show();

  });
});
</script>

<a class="country" href="javascript:;" sel="list2">India</a>&nbsp;
<a class="country" href="javascript:;" sel="list3">Germany</a>&nbsp;
<a class="country" href="javascript:;" sel="list4">US</a>&nbsp;

<br><br>

<select name="list2" id="list2">
        <option value="Indiacity1">Indiacity1</option>
        <option value="Indiacity2">Indiacity1</option>
        <option value="Indiacity3">Indiacity1</option>
</select>

<select name="list3" id="list3">
        <option value="Germany1">Germany1</option>
        <option value="Germany2">Germany1</option>
        <option value="Germany3">Germany1</option>
</select>

<select name="list4" id="list4">
        <option value="US1">US1</option>
        <option value="US2">US1</option>
        <option value="US3">US1</option>
</select> 
```

# ruby-on-rails - Rails 3 使用视图渲染纯文本页面

> ID：12591566
> 
> 赞同：1
> 
> 时间：2012-09-25T21:47:44.167
> 
> 标签：ruby-on-rails, plaintext

我在 Rails 的数据库中存储了一个 Linux 配置文件，我希望能够通过 Web 请求下载配置

我在 Linux 方面的目标是 curl/wget 网页，将其与当前配置进行比较，然后连接服务器。在脚本中很容易做到。

在 Rails 上的正常情况下，你可以这样做

```
render :text => @config_file 
```

但是，我需要先对数据进行一些格式化以应用静态标题等。这不是单行的，所以我需要能够呈现视图。

我的控制器中有以下设置，但我仍然在文档中获得最少的 HTML 标记集

```
render(:content_type => 'text/plain', :layout => false); 
```

我之前在 .Net 中做过类似的事情，所以它打印出一个带有`\n`解释的文本文件。我如何在 Rails 中获得它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T08:28:52.770

通常，这是通过

```
# config/initializers/mime_types.rb
# ...
# Mime::Type.register "text/plain", :plaintext
# No changes needed as rails comes preconfigured with the text/plain mime type

# app/controllers/my_controller.rb

class MyController < ApplicationController
  def my_action
    respond_to do |format|
      format.text
    end
  end
end 
```

和一个视图文件

```
# app/views/my_controller/my_action.text.erb
... 
```

关于您在 DOM 中找到的最小 HTML：您是否从某种浏览器内检查器中看到了这一点，例如 google chrome 或 safari 中包含的那些？如果是这样，请不要担心，这是由浏览器添加的，以便内联显示您的文本/纯文档。如果您查看交付文档的来源 (ctrl-u)，则不应显示任何 HTML。

# android - 将内置条码扫描器与 android app phonegap 集成

> ID：12591567
> 
> 赞同：1
> 
> 时间：2012-09-25T21:47:49.543
> 
> 标签：android, cordova, barcode-scanner

我想编写一个使用带有内置条形码扫描仪的设备的应用程序，例如这里的设备[http://liliputing.com/2012/05/rampage-6-is-a-rugged-waterproof-android-2- 3-tablet.html](http://liliputing.com/2012/05/rampage-6-is-a-rugged-waterproof-android-2-3-tablet.html)。我正在使用 phonegap 来构建这个应用程序，有没有办法从这样的内置扫描仪中获取输入？目前我不知道很多细节，因为我正在确定是否有可能。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T07:56:06.140

您可能想在 phonegap 项目中使用条形码扫描仪插件。对于内置条码扫描器的平板电脑，它应该有一个按钮来触发条码扫描器并将读取结果返回给您的应用程序。

# vb.net - 如何在 VBA 中获取当前时间的快照？

> ID：12591570
> 
> 赞同：0
> 
> 时间：2012-09-25T21:48:06.877
> 
> 标签：vb.net, excel, vba

在我的 VBA 代码中，我使用`Cell.Value = Now`或更新单元格`Cell.Value = Format(Now, "hh:mm:ss")`。

我正在为四个不同的单元格执行此操作。但是，我注意到当其中一个单元格发生更改时，其余时间戳会更改以反映当前时间。在我看来，这些单元格似乎只是对最新时间的引用，而不是单元格更新时间的快照。

无论如何要拍摄时间快照，以便它不会在工作表刷新时改变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T21:52:24.840

这些单元格只是对最新时间的“参考”，更好的是它们可能是不同的时间。

将时间保存到代码中某个合适位置的变量中，然后在单元格中使用该值。然后你可以控制你现在真正的意思。

# windows - python TypeError：必须是没有NULL字节的编码字符串，而不是str

> ID：12591575
> 
> 赞同：8
> 
> 时间：2012-09-25T21:48:25.473
> 
> 标签：windows, scripting, python-2.7

试图熟悉 python 的标准库并在我的 Windows 机器上做一些处理。使用python 2.7，我有以下小脚本，旨在查看目录并在从文件名中删除数字后重命名其中的所有文件。我收到一个类型错误，上面写着“必须是没有 NULL 字节的编码字符串，而不是 str”

它调用了第 5 行和第 18 行，**如下所述**，我在其中使用 os.path.exists。

任何帮助将不胜感激！

```
 import os, re, string, glob

    path = os.path.normpath('C:\Users\me\Photo Projects\Project Name\Project Photos\Modified\0-PyTest')

ln5:if os.path.exists(path):
        print "path exists at " + path
        for file in glob.glob(os.path.join(path, '*.jpg')):
            new_path = os.path.join(os.path.dirname(file), re.sub('\d', '', os.path.basename(file)))
line18:     if not os.path.exists(new_path):
                os.rename(file, new_path) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-12-20T20:34:21.300

“...照片\修改\0-PyTest”

它将 \0 作为空字符。您必须使用 转义`\`，`\\`或者只是`r`在字符串之前放一个以使其原始：

```
r'C:\Users\me\Photo Projects\Project Name\Project Photos\Modified\0-PyTest' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T15:11:37.250

原来是单反斜杠问题。我认为 os.path.normpath 会按照操作系统的要求格式化路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-21T10:54:46.817

如果您要提供路径 url，只需在其前面添加 r ：

(r'E:\Images\1.png')

# java - 读取 utf-8 url 到字符串 java

> ID：12591580
> 
> 赞同：1
> 
> 时间：2012-09-25T21:48:47.033
> 
> 标签：java, string, url, utf-8

再会。刚刚从objective-c切换到java并尝试将url内容正常读取为字符串。阅读大量帖子，但仍然会产生垃圾。

```
public class TableMain {

    /**
     * @param args
     */
    @SuppressWarnings("deprecation")
    public static void main(String[] args) throws Exception {
        URL url = null;
        URLConnection urlConn = null;

        try {
            url = new URL("http://svo.aero/timetable/today/");
        } catch (MalformedURLException err) {
            err.printStackTrace();
        }
        try {
            urlConn = url.openConnection();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            BufferedReader input = new BufferedReader(new InputStreamReader(
                    urlConn.getInputStream(), "UTF-8"));
            StringBuilder strB = new StringBuilder();
            String str;
            while (null != (str = input.readLine())) {
                strB.append(str).append("\r\n");
                System.out.println(str);
            }
            input.close();
        } catch (IOException err) {
            err.printStackTrace();
        }
    }
} 
```

怎么了？我得到这样的东西

> ??y??'??)j1???-?q?E?|V??,??< 9??d?Bw(?э?n?v?)i?x????? Z????q?MM3~??????G??љ??l?U3"Y?]???? *zxxDx????t^???5???j? ?k??u?q?j6?^t???????W??????????~?????????o6/* ?|?8??{? ??O????0?M>Z{srs??K???XV??4Z‌​??'??n/??^??4????w+?????e? ??????[?{/??,??WO???????????.?.?x???????^?rax??]?xb??‌ ​& ??8;?????}???h????H5????v?e?0?????-?????g?vN

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-25T21:52:04.690

下面是一个使用 HttpClient 的方法：

```
 public HttpResponse getResponse(String url) throws IOException {
    httpClient.getParams().setParameter("http.protocol.content-charset", "UTF-8");
    return httpClient.execute(new HttpGet(url));
}

public String getSource(String url) throws IOException {
            StringBuilder sb = new StringBuilder();
            HttpResponse response = getResponse(url);
            if (response.getEntity() == null) {
                throw new IOException("Response entity not set");
            }
            BufferedReader contentReader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));

            String line = contentReader.readLine();

            while ( line != null ){
                sb.append(line)
                  .append(NEW_LINE);
                line = contentReader.readLine();
            }
            return sb.toString();
    } 
```

编辑：我编辑了响应以确保它使用 utf-8。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-25T22:13:17.170

这是以下原因的结果：

1.  您正在获取 UTF-8 编码的数据
2.  您没有指定，但我猜您正在将其打印到 Windows 系统上的控制台

数据被正确接收和存储，但是当您打印它时，目的地无法呈现俄语文本。除非最终的显示处理程序能够呈现所涉及的字符，否则您将无法仅将文本“打印”到标准输出。

# objective-c - 拆分一个大的 UIImage 以供纹理使用

> ID：12591581
> 
> 赞同：2
> 
> 时间：2012-09-25T21:48:47.747
> 
> 标签：objective-c, ios, cocoa-touch

我需要将一个大图像（大约 10000px 高度）拆分为多个较小的图像，以将它们用作 OpenGL 的纹理，下面是我现在正在做的方式，任何人都有任何想法可以更快地做到这一点，因为它需要很长时间。

```
NSArray *images = [NSArray alloc] initWith 
for (int i = 0; i<numberOfImages; i++){

    int t = i*origHeight;
    CGRect fromRect = CGRectMake(0, t, origWidth, origHeight); // or whatever rectangle

    CGImageRef drawImage = CGImageCreateWithImageInRect(sourceImage.CGImage, fromRect);

    UIImage *newImage = [UIImage imageWithData:UIImageJPEGRepresentation([UIImage imageWithCGImage:drawImage],1.0)];

    [images addObject:newImage];

    CGImageRelease(drawImage);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:43:58.107

[您可以在使用带有ImageMagick](http://www.imagemagick.org/script/index.php)`convert`的命令之前预先拆分它们，您可以通过[brew获得](http://mxcl.github.com/homebrew/)

[http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=15771](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=15771)

# ruby-on-rails - Rails 控制台未加载

> ID：12591585
> 
> 赞同：18
> 
> 时间：2012-09-25T21:49:13.520
> 
> 标签：ruby-on-rails, ruby

尝试启动时，`rails console`我不断收到以下错误

```
Users/rigelstpierre/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/irb/completion.rb:9:in `require': dlopen(/Users/rigelstpierre/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/x86_64-darwin11.4.0/readline.bundle, 9): Library not loaded: /Users/rigelstpierre/.rvm/usr/lib/libreadline.6.2.dylib (LoadError)
  Referenced from: /Users/rigelstpierre/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/x86_64-darwin11.4.0/readline.bundle
  Reason: image not found - /Users/rigelstpierre/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/x86_64-darwin11.4.0/readline.bundle
    from /Users/rigelstpierre/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/irb/completion.rb:9:in `<top (required)>'
    from /Users/rigelstpierre/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.2/lib/rails/commands/console.rb:3:in `require'
    from /Users/rigelstpierre/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.2/lib/rails/commands/console.rb:3:in `<top (required)>'
    from /Users/rigelstpierre/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.2/lib/rails/commands.rb:38:in `require'
    from /Users/rigelstpierre/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.2/lib/rails/commands.rb:38:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

有什么想法吗？Rails 3.2.2 应用

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-25T22:59:12.070

可能是安装了多个版本的 readline。

尝试以下操作：

```
brew link readline --force 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-10-08T23:20:59.837

我前几天有这个。您可以尝试重新安装/重新编译您的 ruby​​。在我的情况下，**从 El Capitan 更新到 Sierra时出现了问题**

所以取决于你的经理：

**虚拟机**

```
rvm reinstall 2.3.0 
```

**Rbenv**

```
rbenv uninstall 2.3.0
rbenv install 2.3.0 
```

**自卫队**

```
asdf uninstall ruby 2.3.0
asdf install ruby 2.3.0 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-02-06T19:21:49.727

看看别处，没有一个重新链接选项起作用。有人建议重做 rvm 安装（这似乎很繁重）。但是，只需将 readline 添加到 Gemfile 中即可：

```
gem 'rb-readline' 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-09-29T15:32:34.340

这是因为安装了多个版本的 readline（可能是因为您`brew update`最近运行过）。罗恩说的没错。`brew link readline`您可以通过运行或来修复它`brew link readline --force`。

如果它仍然不起作用，请找到哪个 readline 并移动到 readline 文件夹，然后删除您不需要的版本（或通过运行 brew update 安装的版本）。然后`brew link readline`再次运行。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-01-20T08:55:11.817

对我来说，在 macOS 山脉上，`brew link readline`或者`brew link readline --force`不起作用，我`brew update`最近跑了。但是`rails console`在我执行以下操作后确实有效：

`rvm reinstall 2.3.1`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-24T10:02:38.343

重装后`readline`还是无法加载`rails console`。

但是，重新安装`ruby`为我做了。

```
rvm reinstall 1.9.3 
```

PS：我在 OSX El Capitan

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-07T16:03:19.177

在 macOS Sierra 上，我在 homebrew 和 libreadline 上遇到了同样的问题，我尝试这样做`brew link readline`，但一切都是徒劳的，`brew link readline --force`然后`brew update` 我找到了另一个解决我的问题的解决方案。

自制程序所需的 libreadline 存在链接问题未链接且无法链接`brew commands`

创建符号链接解决了我的问题。

`ln -s /usr/local/opt/readline/lib/libreadline.7.0.dylib /usr/local/opt/readline/lib/libreadline.6.dylib`

尝试创建符号链接。希望这能解决您的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-22T18:51:57.230

就我而言， readline 的版本号不同，我丢失了`libreadline.7.dylib`. 使用 Homebrew 链接和取消链接没有帮助。以下内容虽然：

```
~$ cd /usr/local/opt/readline/lib
/usr/local/opt/readline/lib$ ls -l
total 1448
-r--r--r--  1 ceasar  staff   40396 Mar 22 11:35 libhistory.8.0.dylib
lrwxr-xr-x  1 ceasar  staff      20 Dec 19 13:07 libhistory.8.dylib -> libhistory.8.0.dylib
-r--r--r--  1 ceasar  staff   45848 Dec 19 13:07 libhistory.a
lrwxr-xr-x  1 ceasar  staff      20 Dec 19 13:07 libhistory.dylib -> libhistory.8.0.dylib
-rw-r--r--  1 ceasar  staff  239260 Mar 22 11:35 libreadline.8.0.dylib
lrwxr-xr-x  1 ceasar  staff      21 Dec 19 13:07 libreadline.8.dylib -> libreadline.8.0.dylib
-r--r--r--  1 ceasar  staff  406384 Dec 19 13:07 libreadline.a
lrwxr-xr-x  1 ceasar  staff      21 Dec 19 13:07 libreadline.dylib -> libreadline.8.0.dylib
drwxr-xr-x  3 ceasar  staff      96 Mar 22 11:35 pkgconfig
/usr/local/opt/readline/lib$ ln -s libreadline.dylib libreadline.7.dylib 
```

# javascript - 在 iframe 中访问 javascript ckeditor 对象

> ID：12591587
> 
> 赞同：0
> 
> 时间：2012-09-25T21:49:22.927
> 
> 标签：javascript, jquery, iframe, ckeditor

假设我有一个带有 iframe 的页面，并且在 iframe 中我有一个 ckeditor 实例，我想从包含页面中销毁它。

我通常会尝试这样的事情：

```
var iframe_document = document.getElementById("iframe_id").contentWindow.document;
for(var i in iframe_document.CKEDITOR.instances)
  iframe_document.CKEDITOR.instances[i].destroy(); 
```

但是，似乎无法以这种方式访问​​ ckeditor 实例。是否可以从类似于此的文档外部销毁实例？

澄清确切的错误是“无法读取未定义的属性'实例'”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T07:14:13.950

全局变量属于窗口，而不是文档，所以试试这个：

```
var iframe_CKEDITOR = document.getElemenyById("iframe_id").contentWindow.CKEDITOR;
for(var i in iframe_CKEDITOR.instances)
  iframe_CKEDITOR.instances[i].destroy(); 
```

# android - 如何获取动态添加到LinearLayout的点击子视图的ID？

> ID：12591590
> 
> 赞同：11
> 
> 时间：2012-09-25T21:50:03.337
> 
> 标签：android, android-layout

我正在向线性布局添加子视图。子视图本身在相对布局中有一些文本视图和图像视图。单击按钮时，子视图会动态添加到 LinearLayout 中。现在我可以添加子视图，如图所示。 [http://dl.dropbox.com/u/50249620/SC20120926-031356.png](http://dl.dropbox.com/u/50249620/SC20120926-031356.png) 我所要做的就是唯一确定点击了哪个子视图以显示适当的操作。我在其中添加子视图的代码。

```
addButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);

                customView1 = inflater.inflate(R.layout.people, null);

                peopleName = (TextView) customView1.findViewById(R.id.peopleName);

                peopleName.setText(autoComplete.getText());
                customView1.setId(peopleInvitedRelativeLayout.getChildCount() + 1);

                params4 = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);

                customView1.setLayoutParams(params4);
                peopleInvitedRelativeLayout.addView(customView1, params4);              

            }
        }); 
```

任何帮助或建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-25T21:59:22.430

您只需在创建视图时执行以下操作即可将自定义标签添加到任何视图

```
view.setTag(Object o); 
```

然后稍后在 onClickListener 中找到标签

```
view.getTag() 
```

`setTag(Object o)`将接受任何类型的对象，无论是字符串、int 还是自定义类

**编辑**

```
addButton.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            customView1 = inflater.inflate(R.layout.people, null);

            peopleName = (TextView) customView1.findViewById(R.id.peopleName);

            peopleName.setText(autoComplete.getText());
            customView1.setId(peopleInvitedRelativeLayout.getChildCount() + 1);

            params4 = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);

            customView1.setLayoutParams(params4);
            peopleInvitedRelativeLayout.addView(customView1, params4);

            //add a tag to a view and add a clicklistener to the view
            customView1.setTag(someTag);
            customView1.setOnClickListener(myClickListner);

        }
    }); 
```

clicklistener - 为它创建一个类变量

```
OnClickListener myClickListener = new onClickListener(){
    @Override
    public void onClick(View v) {

        if(v.getTag() == someTag){
             //do stuff
        }else if(v.getTag() == otherTag){
             //do something else
        }
    } 
```

# c++ - C ++中的fstream错误

> ID：12591594
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:50:11.027
> 
> 标签：c++

我正在编写一个简单的程序来输入学生记录并将它们存储在一个逗号分隔的文件中。一切看起来都不错，但是当我运行程序时出现错误：

**错误 1 ​​错误 C2248：“std::basic_ios<_Elem,_Traits>::basic_ios”：无法访问在类“std::basic_ios<_Elem,_Traits>”c:\program files\microsoft visual studio 10.0\vc 中声明的私有成员\include\fstream 1116 1 项目1**

这是代码：

```
#include <cstring>
#include <iostream>
#include <fstream>
#include <string>
#include <cstdlib>

using namespace std;

void closeOrNewRecordMenu(string enterAnotherRecord)

    {
        if (enterAnotherRecord == "Q" && enterAnotherRecord == "q")
        {
        exit(0);
        }
    }

void newStudentRecord(double studentNumber, string firstName, string lastName, string campus, string course1, string course2, string course3, string seniorPracticum, ofstream writeToRecordsFile)

    {
        int campusChoice;
        do {
        cout << "Student's six digit number: (Numeric only)";
        cin >> studentNumber;
        cin.ignore();
        }
        while (studentNumber < 100000 && studentNumber > 999999);

        cout << "Student's first name: " << "\n";
        cin >> firstName;
        cin.ignore();

        cout << "Student's last name: " << "\n";
        cin >> lastName;
        cin.ignore();

        while (campusChoice < 1 || campusChoice > 3)

        cout << "Which campus will " << firstName << " " << lastName << " be attending class at: " << "\n";

        cout << "For the North campus enter 1" << "\n";

        cout << "For the South campus enter 2" << "\n";

        cout << "For the Seaside campus enter 3" << "\n";

        cin >> campusChoice;
        cin.ignore();

        if (campusChoice == 1)
            {
                campus = "North Campus";
        }

        else if (campusChoice == 2)
        {
            campus = "South Campus";
        }

        else if (campusChoice == 3)
        {
            campus = "Seaside Campus";
        }
        else {
            cout << "Please enter a valid choice." << "\n" << "\n";
        }

        cout << "Student's first course: " << "\n";
        getline (cin, course1);
        cin.ignore();

        cout << "Student's second course: " << "\n";
        getline (cin, course2);
        cin.ignore();

        cout << "Student's third course: " << "\n";
        getline (cin, course3);
        cin.ignore();

        do {
        cout << "Is " << firstName << " " << lastName << " a senior this year? Please enter \"Y\" for yes and \"N\" for no." << "\n";
        cin >> seniorPracticum;
        cin.ignore();
        } while (seniorPracticum != "y" && seniorPracticum != "Y" && seniorPracticum != "n" && seniorPracticum != "N");

        writeToRecordsFile << studentNumber << "," << firstName << "," << lastName << "," << campus << "," << course1 << "," << course2 << "," << course3 << "," << seniorPracticum << "\n";

        cout << "The student record for " << firstName << " " << lastName << " has been saved." << "\n" << "\n";
}

int main()

    {
         cout << "Hello there! Welcome to the student record manager. From here you can enter new student information and save it to a file!!!! (More exciting to the developer than the user)." << "\n" << "\n";

    string enterAnotherRecord;

    ofstream writeToRecordsFile;

    writeToRecordsFile.open("cop2224_proj1.txt");

        while (enterAnotherRecord != "Q" && enterAnotherRecord != "q") {
            cout << "Press \"N\" to create a new student record or press \"Q\" to quit." << "\n" << "\n";

            cin >> enterAnotherRecord;

            closeOrNewRecordMenu(enterAnotherRecord);

            string firstName, lastName, seniorPracticum, campus, course1, course2, course3;
            double studentNumber;

            newStudentRecord(studentNumber, firstName, lastName, campus, course1, course2, course3, seniorPracticum, writeToRecordsFile);   
        } 

    writeToRecordsFile.close();

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:54:42.147

流是不可复制的，即使它们是可复制的，你也不想在这里这样做——而是通过引用传递。`newStudentRecord`将您的签名更改为：

```
void newStudentRecord(double studentNumber, string firstName, string lastName, string campus, string course1, string course2, string course3, string seniorPracticum, ofstream& writeToRecordsFile); 
```

话虽如此，当您不关心它们的初始值并且不将它们用作输出参数时，为什么还要传递所有这些参数？将您的签名简化为以下内容：

```
void newStudentRecord(ofstream& writeToRecordsFile); 
```

并将其他参数声明为`newStudentRecord`.

* * *

顺便说一句，您`campusChoice`在初始化它之前正在阅读，这将产生[undefined behavior](http://en.wikipedia.org/wiki/Undefined_behavior)。

# drag-and-drop - Twitter Bootstrap 模态表单：如何拖放？

> ID：12591597
> 
> 赞同：43
> 
> 时间：2012-09-25T21:50:19.013
> 
> 标签：drag-and-drop, twitter-bootstrap

我希望能够移动（在灰色背景上，通过拖放）由 Bootstrap 2 提供的模态表单。谁能告诉我实现这一目标的最佳实践是什么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-09-25T22:41:14.447

默认情况下，引导程序没有任何拖放功能，但您可以添加一点 jQuery UI 香料来获得您想要的效果。例如，使用[`draggable`](http://jqueryui.com/demos/draggable/)框架中的交互，您可以定位您的模态 ID，以允许在模态背景中拖动它。

尝试这个：

**JS**

```
$("#myModal").draggable({
    handle: ".modal-header"
}); 
```

[演示](http://jsfiddle.net/BV2XA/198/show/)，[在这里](http://jsfiddle.net/BV2XA/198/)编辑。

更新：[bootstrap3 演示](http://output.jsbin.com/vafulubaju)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-03T11:26:25.913

无论您选择什么可拖动选项，您可能希望关闭引导程序的 CSS 文件中的`*-transition`属性`.modal.fade`，或者至少编写一些在拖动过程中暂时禁用它们的 JS。否则，模态不会完全按照您的预期拖动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-25T09:46:56.547

您可以使用这样的小脚本。

[从没有 jQuery UI 的 Draggable](https://css-tricks.com/snippets/jquery/draggable-without-jquery-ui/)简化

```
 (function ($) {
        $.fn.drags = function (opt) {

            opt = $.extend({
                handle: "",
                cursor: "move"
            }, opt);

            var $selected = this;
            var $elements = (opt.handle === "") ? this : this.find(opt.handle);

            $elements.css('cursor', opt.cursor).on("mousedown", function (e) {
                var pos_y = $selected.offset().top - e.pageY,
                  pos_x = $selected.offset().left - e.pageX;
                $(document).on("mousemove", function (e) {
                    $selected.offset({
                        top: e.pageY + pos_y,
                        left: e.pageX + pos_x
                    });
                }).on("mouseup", function () {
                    $(this).off("mousemove"); // Unbind events from document                
                });
                e.preventDefault(); // disable selection
            });

            return this;

        };
    })(jQuery); 
```

示例：$("#someDlg").modal().drags({handle:".modal-header"});

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-11T21:08:37.923

建立在使用 jQuery UI 的先前答案的基础上，这包含一次，将应用于您的所有模态并将模态保持在屏幕上，因此用户不会意外地将标题移出屏幕，因此他们无法再访问句柄。还将光标设置为“移动”以获得更好的可发现性。

```
$(document).on('shown.bs.modal', function(evt) {
    let $modal = $(evt.target);
    $modal.find('.modal-content').draggable({
        handle: ".modal-header",
        containment: $modal
    });
    $modal.find('.modal-header').css('cursor', 'move')
}); 
```

`evt.target`是`.modal`实际背后的半透明覆盖层`.modal-content`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-03T19:58:10.570

jquery UI 很大，可能与引导程序发生冲突。

另一种选择是 DragDrop.js： http: [//kbjr.github.io/DragDrop/index.html](http://kbjr.github.io/DragDrop/index.html)

```
DragDrop.bind($('#myModal')[0], {
  anchor: $('#myModal .modal-header')
}); 
```

正如@user535673 建议的那样，您仍然必须处理转换。我只是从我的对话框中删除了淡入淡出类。

# php - 谷歌 API OAuth 2.0

> ID：12591604
> 
> 赞同：1
> 
> 时间：2012-09-25T21:50:44.210
> 
> 标签：php, api, oauth-2.0, google-reader

我目前正在使用 OAuth 2.0 来访问 Google 的阅读器 API。我已成功获得 URL 中返回的“代码”和“状态”。现在我正在使用 post 方法传入所需的参数以接收访问令牌。我已经摆弄了很长一段时间，我所拥有的是：

```
{ "error": "invalid_request" } 
```

我的代码如下：

```
<?php 

session_start();

$code = $_GET['code'];
$state = $_GET['state'];

if ((!is_numeric($state)) || ($state != $_SESSION['state'])) {
    throw new Exception('Error validating state.');
}

$accessTokenExchangeUrl = 'https://accounts.google.com/o/oauth2/token';
$redirectUriPath = '/authentication.php';

$accessTokenExchangeParams = array(
    'code' => $code,
    'client_id' => 'xxxxx',
    'client_secret' => 'xxxxx',
    'redirect_uri' => (isset($_SERVER['HTTPS'])?'https://':'http://') . $_SERVER['HTTP_HOST'] . $redirectUriPath,
    'grant_type' => 'authorization_code'
    );

$goToUrl = $accessTokenExchangeUrl . '?' . http_build_query($accessTokenExchangeParams);

?> 

<!DOCTYPE HTML>
<html>
<head>
    <title></title>
</head>

<body>

    <form action=<?php echo $goToUrl; ?> method="post">
        <input type="submit" value="Click Me!">
    </form>

</body>

</html> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T03:40:57.150

您是否尝试过将代码、client_id 等变量作为输入参数（在 POST 请求正文中）而不是在查询字符串中？谷歌的例子[就是这样证明的](https://developers.google.com/accounts/docs/OAuth2WebServer#handlingtheresponse)。

[如果您遵循 OAuth 2 规范](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-31#section-3.2)，则出于安全原因，它们不应出现在查询字符串中。

# joomla - Joomla 2.5 模块权限

> ID：12591605
> 
> 赞同：1
> 
> 时间：2012-09-25T21:50:47.437
> 
> 标签：joomla, joomla2.5

我只想根据用户是否属于一组自定义组来使模块可见-包括如果他属于特定组则不可见。例如，广告显示为公开和注册但不显示自定义“高级”组。注册和高级版应该出现一个喊话框，但不是“未登录”。因此，据我所知，“客人”和“特殊”组毫无用处。我错过了一些非常简单的东西吗？

如果我*必须*使用第 3 方组件/模块来实现这一点，那么免费或便宜的将是最有益的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:34:12.497

实现此目的的一种方法是编辑和创建新的访问级别。为了掩盖您在问题中提供的示例，以下方法可能有效：

您需要将客人从名为*Public*的根父组中取出。您可以通过以下三个步骤来做到这一点：

1.  使用*User Manager*，创建一个名为*“Guest”*的新组，并将*Public*作为父组。
2.  打开*用户管理器选项*。
3.  *将Guest User Group*更改为您的新组*Guest*。

从现在开始，您网站上的访客将被放入*访客*组。现在您可以为广告创建访问级别。因此，创建一个新的访问级别，将其命名为*“非高级用户”*并添加*Guest*和*Registered*。现在将此访问级别应用于模块，它应该可以工作。请注意，高级组不能*注册*为父母。

接下来是喊话框的访问级别。我看到此访问级别有两个选项。其中之一是创建一个新的访问级别并为其添加*注册*和*高级*。不过，一种更简单的方法是将*Premium*组添加到已存在的名为*Registered*的访问级别。

有用的 ACL 链接：

*   [仅允许访客访问菜单项和模块](http://docs.joomla.org/Access_Control_List/1.6-2.5/Tutorial#Allowing_Guest-Only_Access_to_Menu_Items_and_Modules)
*   [Joomla ACL：访问级别](http://magazine.joomla.org/issues/issue-feb-2012/item/639-Joomla-ACL-Access-Levels)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T05:24:02.660

没有一个 ACL 级别对我来说 100% 有效，我不得不破解我正在使用的模板并添加一些代码......

```
<?php  

// make sure user is an accepted user group 
jimport( 'joomla.user.helper' );
$user =& JFactory::getUser();
$userId = $user->get( 'id' );
$groups = JUserHelper::getUserGroups($userId);

// print_r($groups); 
/* 
3 Author
4 Editor
5 Publisher
6 Manager
7 Administrator
8 Super Users
*/ 

$menu = '' ;
if (in_array("3", $groups)) {
       // echo "<!-- Author Group Found! -->";
        // echo '<!-- USER ID: ' . $userId . ' -->';
        $menu .= "
        <a href='http://yourdomain.com/authors-area'>Authors Area</a> 
        " ;
} elseif(in_array("4", $groups)) { 
$menu .= "
        <a href='http://yourdomain.com/editors-area'>Editors Area</a> 
        " ;
} elseif(in_array("5", $groups)) { 
$menu .= "
        <a href='http://yourdomain.com/publishers-area'>Publishers Area</a> 
        " ;
} elseif(in_array("6", $groups)) { 
$menu .= "
        <a href='http://yourdomain.com/managers-area'>Managers Area</a> 
        " ;
} elseif(in_array("7", $groups)) { 
$menu .= "
        <a href='http://yourdomain.com/administrators-area'>Administrators Area</a> 
        " ;
} elseif(in_array("8", $groups)) { 
$menu .= "
        <a href='http://yourdomain.com/superusers-area'>Super Users Area</a> 
        " ;
} else {
    $null = '' ; ;
    }
?> 
```

# python - 通过 popen 使用 cdrecord 不会弹出

> ID：12591606
> 
> 赞同：1
> 
> 时间：2012-09-25T21:50:47.357
> 
> 标签：python, popen

所以，我正在制作一个 cd 刻录应用程序，我需要弹出驱动器以让用户放入磁盘。这有点复杂，但我遇到的最简单的情况是这样的；我可以通过命令行使用 cdrecord 使用以下命令弹出 cd 托盘：

```
cdrecord --eject dev='/dev/sg1' 
```

这应该意味着我可以用 做同样的事情`subprocess.call`，如下所示：

```
subprocess.call(["cdrecord", "--eject", "dev='/dev/sg1'"]) 
```

但是，当我这样做时，我收到此错误：

```
wodim: No such file or directory. 
Cannot open SCSI driver!
For possible targets try 'wodim --devices' or 'wodim -scanbus'.
For possible transport specifiers try 'wodim dev=help'.
For IDE/ATAPI devices configuration, see the file README.ATAPI.setup from
the wodim documentation. 
```

并且托盘打不开。

这与我之前尝试从命令行运行它时遇到的错误非常相似，但我通过加载 sg 内核模块修复了该错误。

如果我只是运行：

```
subprocess.call(["cdrecord", "--eject"]) 
```

它打开托盘就好了。但是，这需要与可能的多个 cd 托盘一起使用，所以这不起作用。

我怎样才能让它正确弹出 cd？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:56:12.950

尝试这个：

```
subprocess.call(["cdrecord", "--eject", "dev=/dev/sg1"]) 
```

shell 将负责解释引号，但`cdrecord`不会。

首先需要引号的唯一原因是`dev`路径中可能包含空格，导致 shell 将内容拆分为单独的参数。例如，如果您键入以下内容：

```
cdrecord --eject dev=/dev/my silly cd name 
```

的参数`cdrecord`将是`--eject`, `dev=/dev/my`, `silly`, `cd`, `name`. 但如果你这样做：

```
cdrecord --eject dev='/dev/my silly cd name' 
```

的参数`cdrecord`将是`--eject`, `dev=/dev/my silly cd name`。

当您使用`subprocess.call`时，没有外壳可以将参数分开；你明确地传递它们。所以，如果你这样做：

```
subprocess.call(["cdrecord", "--eject", "dev=/dev/my silly cd name"]) 
```

的参数`cdrecord`将是`--eject`, `dev=/dev/my silly cd name`。

在某些情况下——例如，因为你一开始就陷入了无可救药的混乱状态（例如，你正在读取一个打算由你的程序使用或由 shell 执行的配置文件）——你真的没有追索权，但是通过外壳运行。如果发生这种情况，请执行以下操作：

```
subprocess.call("cdrecord --eject dev='/dev/sg1'", shell=True) 
```

但这通常不是您想要的，在这种情况下也不是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-09T17:03:48.603

您使用的不是 cdrecord，而是一个名为“wodim”的有问题的叉子，这可能是您出现问题的原因。

我建议您使用来自以下网站的最新原创软件：

[ftp://ftp.berlios.de/pub/cdrecord/alpha/](ftp://ftp.berlios.de/pub/cdrecord/alpha/)

# c# - 使用 Trello 和 Trello.NET 更改看板权限

> ID：12591607
> 
> 赞同：1
> 
> 时间：2012-09-25T21:50:52.693
> 
> 标签：c#, api, trello, trello.net

我正在使用[Trello.net](https://github.com/detroitpro/Trello.net)通过他们的 API 管理 Trello 板。

我需要做的一件事是更改我创建的新董事会以公开。

此代码似乎不起作用

```
myBoard.Prefs.PermissionLevel = PermissionLevel.Public;
trello.Boards.Update(myBoard); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T07:46:58.683

从 0.5.5-beta 版开始，Trello.NET 支持这一点。使用 `Trello.Boards.ChangePermissionLevel`. 更多信息[在这里](https://github.com/dillenmeister/Trello.NET/issues/7)。

# c++ - C++ 字符串构造性能

> ID：12591609
> 
> 赞同：0
> 
> 时间：2012-09-25T21:50:55.377
> 
> 标签：c++, string, performance

我想知道在将字符串传递给函数时（例如插入向量），下面的代码在#1、#2 和#3 之间是否有任何区别。尤其是在处理代码中的数百万个字符串时。

```
std::vector<std::string> v;
std::string s("foo");
int i = 1;
v.push_back( s + "bar" + boost::lexical_cast<std::string>(i) );  // #1
v.push_back( std::string(s + "bar" + boost::lexical_cast<std::string>(i)) );  // #2
std::string s2 = s + "bar" + boost::lexical_cast<std::string>(i);
v.push_back(s2);  // #3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:53:17.170

使用一个体面的优化器，#1 和#2 之间*应该*没有区别，但是#1 为您提供了编译器实际上进行临时消除的最大机会。

但是，#3 包含一个命名的临时文件，因此它可能需要一个出色的优化器来检测它只是一个临时文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:54:17.840

可能不是。它们应该是等价的。

但是，您可以获得性能提升的一种方法是预先分配您的字符串：

```
std::string s;
s.reserve(10); // or so...
s.append("foobar").append(lexical_cast<std::string>(i)); 
```

不过，您可能不会在这里获得足够的性能以使其值得麻烦。

# html - 当 div 上有浮动时，如何让 div 填充其包装器的高度？

> ID：12591610
> 
> 赞同：0
> 
> 时间：2012-09-25T21:50:58.777
> 
> 标签：html, css

我正在尝试从头开始构建响应式设计并使用 jsfiddle 进行一些测试。我有两个固定宽度的外列和一个占据中间剩余宽度的中心列。我一辈子都无法让外列扩展以填充它们所在的包装器的高度。我认为这可能与我如何让中间 div 占据中心空间有关（把它放在右边div 按顺序添加，然后添加溢出：隐藏）。

我尝试使用带有 clear:both 的 div 清除浮动，还尝试将 overflow:hidden 添加到包装器中。

jsfiddle 链接是：http: [//jsfiddle.net/jleslie/ErAWn/1/](http://jsfiddle.net/jleslie/ErAWn/1/)

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:59:10.017

不要使用浮点数。您可以通过左右绝对位置保持响应：

[http://jsfiddle.net/ErAWn/4/](http://jsfiddle.net/ErAWn/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:59:14.863

将此样式应用于侧列在 Safari、Chrome 和 FF 中有效，即使在 jsfiddle 中似乎不起作用，如果您需要它，还会保留浮动：

```
.side_col {
width: 200px;
background-color: red;
height: 100%; 
```

}

# ios6 - 底部的 UIToolbar 在 Retina 4 模拟器中不起作用

> ID：12591611
> 
> 赞同：4
> 
> 时间：2012-09-25T21:51:14.553
> 
> 标签：ios6, retina-display, iphone-5

我知道这听起来有点奇怪，但也许有人也经历过同样的事情。

如果我在 Retina 4 大小的 xib（548 大小）的底部放置了一个 UIToolbar，它在模拟器中不起作用（按钮显示没有反应）。但是，如果我把它放高一点（不确定阈值在哪里），它们会再次起作用。？？？

我有问题的 xib 看起来像这样：

![在此处输入图像描述](../Images/85586b3549d37a81c97311bd6712e75e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T08:19:58.693

如其他地方所述（例如[iPhone 5 (4") 底部工具栏没有响应](https://stackoverflow.com/questions/12414817/iphone-5-4-bottom-toolbar-not-responding?rq=1)），问题是即使您的视图是全高，底层 UIWindow 不是，并且底层 UIWindow 参与您的视图获取触摸事件。

如果您的项目中有类似“MainWindow.xib”的文件名：

*   在界面生成器中打开它。
*   从左侧的对象列表中选择“窗口”。
*   在“属性检查器”窗格中，单击“启动时全屏”复选框。

屏幕底部的 UI 元素现在应该可以工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T11:33:34.170

我发现问题出在 UIWindow 上。（也许这只是旧项目的问题）只要它设置为 480 大小的窗口对象超出其大小（可能在 Retina 4 上发生）就无法识别。

# sitecore - Sitecore 以编程方式隐藏项目

> ID：12591614
> 
> 赞同：4
> 
> 时间：2012-09-25T21:51:28.683
> 
> 标签：sitecore, sitecore6

如何以编程方式隐藏 sitecore 中的项目：

这是我到目前为止所尝试的：

```
Item recordDetails = root.Add(object.Name + " Details", folderTemplate);
recordDetails.Fields.ReadAll(); 
recordDetails.Editing.BeginEdit();
CheckboxField recordHidden = recordDetails.Fields["Hidden"];//Also tried "isHidden"
if (recordHidden != null)
{
   recordHidden.Checked = true;
}
recordDetails.Editing.EndEdit(); 
```

但是没有运气，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T13:08:15.990

你也可以使用`myItem.Appearance.Hidden = true;`:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:20:54.723

我使用的字段名称不正确 - 它是“__Hidden”。改变它解决了这个问题。

# excel-2007 - 读取后关闭 Excel 文件

> ID：12591622
> 
> 赞同：1
> 
> 时间：2012-09-25T21:52:15.563
> 
> 标签：excel-2007

这是我打开 Excel 文件和读取数据的代码，一切正常，但我想在读取 Excel 文件后关闭，我该怎么做？我尝试`Dispose`了这个对象，但没有帮助。

```
public static DataTable ExcelWorkbook(string workbookName)
        {
            string connectionString = String.Format(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=""Excel 8.0;HDR=YES;IMEX=1;""", FILENAME);
            string query = String.Format("select * from [{0}$]", workbookName);

            OleDbDataAdapter dataAdapter = new OleDbDataAdapter(query, connectionString);
            DataSet dataSet = new DataSet();
            dataAdapter.Fill(dataSet);

            dataAdapter.Dispose();

            DataTable myTable = dataSet.Tables[0];
            if (myTable != null)
                return myTable;

            return null;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:25:53.130

你的代码应该是这样的：

```
OleDbConnection connection;
OleDbDataAdapter clientsAdapter new OleDbDataAdapter();
DataSet myDataSet = new DataSet();

connectionString = (@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0}.xlsx;Extended Properties=""Excel 12.0 Xml;HDR=YES""",FILENAME);
connection = new OleDbConnection(connectionString);
connection.Open();

clientsAdapter.SelectCommand = new OleDbCommand("SELECT * FROM [{0}$]", connection);

DataTable data = new DataTable("MyTable");
clientsAdapter.Fill(data);
myDataSet.Tables.Add(data);

connection.Close(); 
```

连接关闭后，excel文件将被解锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:55:18.730

您正在处理读取数据的数据适配器，而不是对 Excel 文件本身的引用。

在您的代码中的某处，您将打开工作簿。你需要打电话

```
workbook.Close(); 
```

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.workbookclass.close(v=office.14).aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.workbookclass.close(v=office.14).aspx)

# gcc - gcc 在 i686 上找不到 bits/predefs.h

> ID：12591629
> 
> 赞同：69
> 
> 时间：2012-09-25T21:52:41.723
> 
> 标签：gcc, ubuntu-12.04

好的，所以，我从 ubuntu 12.04 64 位切换到 32 位并安装`build-essential.`

然后我编译并安装了 GMP-5.0.5、MPFR-3.1.1、MPC-1.0、ISL-0.10 和 CLOOG-0.17.0。我检查了主 gcc 主干的副本，并尝试使用以下配置行（来自单独的目录）构建它：

```
../svnsrc/configure --prefix=/usr/GCC/svn --enable-__cxa_atexit --with-plugin-ld=/usr/bin/ld.gold --enable-threads=posix --enable-werror --enable-build-with-cxx --with-gmp=/usr/GCC/prereq/svn --with-mpfr=/usr/GCC/prereq/svn --with-mpc=/usr/GCC/prereq/svn --with-isl=/usr/GCC/prereq/svn --with-cloog=/usr/GCC/prereq/svn --enable-languages=c,c++ 
```

配置运行良好，所以我运行`make && make check`. 这运行了一段时间，但随后失败并出现以下错误：

```
/home/matt/GCC/svnbuild/./gcc/xgcc -B/home/matt/GCC/svnbuild/./gcc/ -B/usr/GCC/svn/i686-pc-linux-gnu/bin/ -B/usr/GCC/svn/i686-pc-linux-gnu/lib/ -isystem /usr/GCC/svn/i686-pc-linux-gnu/include -isystem /usr/GCC/svn/i686-pc-linux-gnu/sys-include    -g -O2 -O2  -g -O2 -DIN_GCC   -W -Wall -Wwrite-strings -Wcast-qual -Wstrict-prototypes -Wmissing-prototypes -Wold-style-definition  -isystem ./include   -fpic -mlong-double-80 -g -DIN_LIBGCC2 -fbuilding-libgcc -fno-stack-protector   -fpic -mlong-double-80 -I. -I. -I../.././gcc -I../../../svnsrc/libgcc -I../../../svnsrc/libgcc/. -I../../../svnsrc/libgcc/../gcc -I../../../svnsrc/libgcc/../include -I../../../svnsrc/libgcc/config/libbid -DENABLE_DECIMAL_BID_FORMAT -DHAVE_CC_TLS  -DUSE_TLS -o _muldi3.o -MT _muldi3.o -MD -MP -MF _muldi3.dep -DL_muldi3 -c ../../../svnsrc/libgcc/libgcc2.c -fvisibility=hidden -DHIDE_EXPORTS
In file included from /usr/include/stdio.h:28:0,
                 from ../../../svnsrc/libgcc/../gcc/tsystem.h:88,
                 from ../../../svnsrc/libgcc/libgcc2.c:29:
/usr/include/features.h:324:26: fatal error: bits/predefs.h: No such file or directory
 #include <bits/predefs.h>
                          ^
compilation terminated.
make[3]: *** [_muldi3.o] Error 1
make[3]: Leaving directory `/home/matt/GCC/svnbuild/i686-pc-linux-gnu/libgcc 
```

我环顾四周，但我似乎发现这个错误是在 x86_64 上引起的，因为没有安装`gcc-multilib`，因为 Ubuntu 和 Debian 使用 mutiarch 系统，将库分开。好吧，好吧……但我使用的是 i686，那我为什么需要 64 位库呢？任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-09-27T06:05:18.517

尝试做一个

```
sudo apt-get install gcc-multilib 
```

我不认为安装 32 位系统会改变您计算机的体系结构，因为您的计算机将始终是 64 位计算机。安装 64 位版本的 Ubuntu 只会提供更好的多核性能。由于您的计算机仍然是 64 位计算机，因此您可能需要一个能够在 64 位计算机上编译的 C 编译器。因此 gcc-multilib。我认为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-12T15:07:22.220

gcc-multilib 技巧对我不起作用。相反，在构建环境中设置它就可以了：

```
C_INCLUDE_PATH=/usr/include/$(gcc -print-multiarch) 
```

# javascript - 使用 JSON 生成图像 url 时 escape_javascript 破坏应用程序

> ID：12591630
> 
> 赞同：0
> 
> 时间：2012-09-25T21:52:48.527
> 
> 标签：javascript, jquery, ruby-on-rails, ajax, ruby-on-rails-3

我正在使用来自 AJAX 调用的 JSON 数据来构建 url 并在模式上显示 Google Map API 图像。这意味着我正在使用 jQuery 编辑 innerHTML。去做这个，

为了显示图像，我必须使用 javascript 来引用经度和纬度值并构建链接。

`var google_map_url = 'http://maps.googleapis.com/maps/api/staticmap?center=' + data.location.latitude + ',' + data.location.longitude + '&zoom=14&size=400x300&sensor=false';`

`"<%= escape_javascript(image_tag "`+google_map_url+`")%>"`

问题是我也在使用 escape_javascript 和我的 image_tag（如上所示），这不会生成图片。我的观点只是显示`+google_map_url+`。

另一个 escape_javascript image_tag 有效，因为我不必将字符串分解为组件：`"<%= escape_javascript(image_tag photo[:url]) %>"`

**我该如何解决这个问题，以便在使用 javascript 变量时仍然可以生成图像？**

index.html.erb

```
<div class="body_container">

    <div id="photos_container">
    <% @photos_array.each do |photo| %>

      <%= link_to '#' do %>
        <div class='each_photo_container', id='<%="#{photo[:id]}"%>' >
          <%= image_tag photo[:s_url] %>
        </div>
      <% end %>

    <!-- Load Modal onClick -->
    <script type="text/javascript">
    jQuery(function() {
      $('#<%=photo[:id]%>').click(function (e) {

        //ajax call to fetch photo info

        var fetch_id = '<%=photo[:id]%>';
        var fetch_secret = '<%=photo[:secret]%>';  

        $.ajax({
          type: 'GET',
          url: '/photos/fetch_info',
          dataType: 'json',
          data: { 'id' : fetch_id, 'secret' : fetch_secret },
          success: function(data){

               var google_map_url = 'http://maps.googleapis.com/maps/api/staticmap?center=' + data.location.latitude + ',' + data.location.longitude + '&zoom=14&size=400x300&sensor=false';          

            //edit innerHTML of basic_modal
            $('.basic_modal').html(

              "<div id='googlemap_image'>"+
                "<%= escape_javascript(image_tag " +google_map_url+ ")%>"+
              "</div>" +

              "<div id='modal_image'>"+
                "<%= escape_javascript(image_tag photo[:url]) %>"+
              "</div>"+

              "<div id='modal_photo_info_container'>"+
                 "<div class='modal_photo_attr'>"
                    +data.title+ 
                 "</div>"+ 
                 "<div class='modal_photo_attr'>"+
                    "By: " +data.owner.username+ 
                 "</div>"+ 
                 "<div class='modal_photo_attr'>"
                    +data.location.region._content+ ", " +data.location.country._content+ 
                 "</div>"+
              "</div>"

             );

            //load modal
        $('.basic_modal').modal({
              overlayClose:true
            });

          } //end success: function(result)
        });

        return false;
      });
    });

    </script>

    <% end %>

    <div class="basic_modal">
    </div>

  </div>
</div> 
```

照片控制器.rb

```
def fetch_info
  @info = flickr.photos.getInfo(:photo_id => params[:id], :secret=> params[:secret])

  respond_to do |format|
    format.json { render :json => @info }
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T05:18:52.717

```
"<%= escape_javascript(image_tag " +google_map_url+ ")%>" 
```

如果你像上面这样写，它将被视为如下

```
1\. "<%= escape_javascript(image_tag " 
```

2.+google_map_url+

```
 3\.  ")%>" 
```

要获得所需的值，请将 [ " ] 内部替换为 [ ' ]，更正的语法应如下所示

```
"<%= escape_javascript(image_tag ' +google_map_url+ ')%>" 
```

# php - PHP Regex 从电子邮件标题中获取多行值

> ID：12591631
> 
> 赞同：1
> 
> 时间：2012-09-25T21:52:54.380
> 
> 标签：php, regex, email

我有一个快速的问题。如何从多行的电子邮件标题中获取值？

这是电子邮件标题中的示例主题值：

```
Subject: =?UTF-8?B?RGVhbHMgZm9yIHRoZSBEYXkgfCBQbHVzLCBzYXZlIDI1JSBvbiA=?=
   =?UTF-8?B?bmVhcmx5IEVWRVJZVEhJTkch?=
MIME-Version: 1.0 
```

我正在使用以下正则表达式，但它只返回一行：

```
'/Subject: (.*)/i' 
```

现在我尝试使用以下内容并返回两行，但是当主题只有一行时，它会返回其他不需要的标题信息（MIME-Version ...）。

```
'/Subject: (.*)(\n\s*(.*))/i' 
```

如果正则表达式以空格 (\s*) 开头并且可以跨越多行，即如果“主题”的长度不同，我如何修改正则表达式以仅拉出第二行。

谢谢你的帮助！

**更新解决方案**

感谢@G-Nugget，下面是一个正则表达式，它可以做我想做的事情并对结果进行分组：

```
 /Subject: ((.*)(\n\s+(.*))*)/i 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:55:37.930

你的第二个正则表达式很接近。这个修改后的版本应该可以解决问题：

```
/Subject: (.*)(\n\s+(.*))*/i 
```

通过`*`将中间的 切换为 a `+`，行首必须有一个空格才能抓住它。最后`*`的 允许正则表达式匹配任意数量的行，只要除第一个以外的所有行都以空格开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-09T17:46:45.993

我强烈建议使用带有“ [m](http://php.net/manual/en/reference.pcre.pattern.modifiers.php) ”修饰符和“^”的正则表达式仅在行首进行搜索：

```
/^Subject: (.*)(\n\s+(.*))*/im 
```

避免匹配与预期完全不同的标题 - 例如：

“X-主题”而不是“主题”

“X-Google-DKIM-Signature”而不是“DKIM-Signature”

# c - 为什么此代码会导致浮点异常 - SIGFPE

> ID：12591634
> 
> 赞同：4
> 
> 时间：2012-09-25T21:53:03.847
> 
> 标签：c, exception, compiler-optimization, gcc4

使用 gcc 4.7：

```
$ gcc --version
gcc (GCC) 4.7.0 20120505 (prerelease) 
```

代码清单（test.c）：

```
#include <stdint.h>

struct test {
    int before;

    char start[0];
    unsigned int v1;
    unsigned int v2;
    unsigned int v3;
    char end[0];

    int after;
};

int main(int argc, char **argv)
{
  int x, y;

  x = ((uintptr_t)(&((struct test*)0)->end)) - ((uintptr_t)(&((struct test*)0)->start));
  y = ((&((struct test*)0)->end)) - ((&((struct test*)0)->start));

  return x + y;
} 
```

编译并执行

```
$ gcc -Wall -o test test.c && ./test
Floating point exception 
```

SIGFPE 是由第二个分配 (y = ...) 引起的。在装配清单中，这条线上有划分吗？请注意，x= 和 y= 之间的唯一区别是转换为 (uintptr_t)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-25T22:06:21.720

忽略由于违反标准中的约束而导致的未定义行为，gcc 在这里所做的是计算两个指向`char[0]`-`&(((struct test*)0)->start)`和的指针之间的差异`&(((struct test*)0)->end)`，并将该差异除以 a 的大小，`char[0]`当然是 0，所以你得到一个除法0。

# c# - 在运行时移动 WPF 控件

> ID：12591637
> 
> 赞同：0
> 
> 时间：2012-09-25T21:53:11.257
> 
> 标签：c#, wpf

我有一个完全透明的 WPF 窗口，没有包含几个按钮的标题栏。我怎样才能只拖动控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:06:01.660

[从这里](http://www.koders.com/csharp/fid5A7DD8E08F73F34D499A661BBB35612D677874A1.aspx?s=%22Josh%20Smith%22#L1)下载 DragCanvas.cs， 它继承自`Canvas`控件，给它一个透明的背景，它会为你完成这项工作。

您还可以将 DragCanvas 作为子项添加到另一个 DragCanvas 并同时移动多个控件

```
<Window x:Class="WpfApplication2.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication2"
    Title="MainWindow" Height="350" Width="525">
<Grid>

    <local:DragCanvas Background="Green">
        <Grid Canvas.Left="48" Canvas.Top="57">
            <Image Source="cursor_drag_arrow.png" Margin="233,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Top" Height="33" Width="29"></Image>
        <Button Content="Button" x:Name="btn" HorizontalAlignment="Left" Height="52" Margin="110,77,0,0" VerticalAlignment="Top" Width="124"/>
            <Button Content="Button" x:Name="btn_Copy" HorizontalAlignment="Left" Height="52" Margin="10,10,0,0" VerticalAlignment="Top" Width="124"/>
        </Grid>
    </local:DragCanvas>
</Grid>
</Window> 
```

这后面没有代码只需单击图像并拖动

![在此处输入图像描述](../Images/4756fc4dde61a4e7057c7a6620928c2a.png)

和

![在此处输入图像描述](../Images/3a7c4538e4a095e46cd73913b052cb15.png)

# php - 不存在的在线错误

> ID：12591638
> 
> 赞同：0
> 
> 时间：2012-09-25T21:53:11.273
> 
> 标签：php

我试图定义一个基于 $_GET 变量的链接，但它说在不存在的行上有一个错误......

```
 <?php

if(isset($_GET['ref'])){
    if(!empty($_GET['ref']))
    {
        $ref = $_GET['ref'];
    }
?>

<?php

      if ($ref != "") {
  $link = "http://site.com/page.php?ref=$ref";
} else {

 $link = "http://site.com/page.php";
    }

?> 
```

有没有人看看怎么回事？我很确定这很好。

我已经尝试了多种不同的方式，使用 isset 等......结果相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:54:23.623

你错过了一个结束`}`：

```
if(isset($_GET['ref'])){
    if(!empty($_GET['ref']))
    {
        $ref = $_GET['ref'];
    }
} 
```

顺便说一句，这段代码是相当多余的。`empty()`还将检查变量是否已设置，因此您不需要`isset()`.

您还可以使用[三元运算符](http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary)，适用于以下情况：

```
$ref = empty($_GET['ref']) ? null : $_GET['ref']; 
```

稍后检查：

```
if (!is_null($ref)) {
    //whatever
} 
```

否则，在您的代码中，当执行到达 时`if ($ref != "") {`，该变量`$ref`甚至可能不存在 - 这将抛出一个`E_NOTICE`，您甚至可能看不到，具体取决于您的设置。

# python - 大写时找不到漂亮的汤 HREF

> ID：12591641
> 
> 赞同：0
> 
> 时间：2012-09-25T21:53:25.500
> 
> 标签：python, beautifulsoup, href

嗨，我有一些类似的东西：

```
from BeautifulSoup import BeautifulSoup as bs  
import urllib2

url = 'http://www.blah.com'  
soup = bs(urllib2.urlopen(url))

for link in soup.findAll('a', href=True):
   print link 
```

所以问题是网站同时使用href和HREF（大写）作为链接。此脚本仅提取 href。我将如何修改代码并获得 HREF 的链接？

谢谢

# asp.net - 事件处理后会发生什么页面功能？

> ID：12591645
> 
> 赞同：0
> 
> 时间：2012-09-25T21:53:43.940
> 
> 标签：asp.net

这可能是一个愚蠢的问题。假设我有 20 个将在回发后关闭的事件处理程序。我想在事件开始之前打开与数据库的连接，然后在事件结束后立即关闭它。我应该将我的打开和关闭语句放在我的网络表单中的什么位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T21:57:28.790

`Page_Load`事件在页面生命周期中的事件之后引发。所以你可以在那里打开它并关闭它`Page_PreRender`。

但实际上我建议完全避免打开连接。无法重用打开的连接。因此，您应该始终在使用过的地方尽快关闭连接，最好使用[`using-statement`](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.100%29.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T21:56:43.067

您需要了解[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx)

回发事件发生在`Load`和`LoacComplete`页面的事件之间，因此如果你想保证连接是打开的，你可以在`Load`（或之前）事件中打开它，并在`LoadComplete`事件中（或之后）关闭它

但是，如果发生错误，则可能`LoadComplete`不会调用该事件。

使用`using`语句处理数据库连接是一种更好的方法：

```
using(var cn = new SqlConnection(".."))
{
   cn.open();
   // here your database code
} 
```

快速浏览：

![在此处输入图像描述](../Images/5edb657c607708b3832802eccf6c7b01.png)

# php - 有没有办法让 php 在插入新行之前检查 csv 文件中的重复值？

> ID：12591646
> 
> 赞同：2
> 
> 时间：2012-09-25T21:53:49.993
> 
> 标签：php, csv

我一直在寻找一个简单的解决方案，恐怕在我所有的研究之后可能没有一个简单的解决方案......

这就是我所拥有的……所有授权 twitter 应用程序的用户都选择加入到列表（csv 文件）中，以供其他用户关注。这是一个供有相同兴趣的用户互相关注的地方。这是我想要实现的目标。我有用户授权他们的 twitter 帐户，该帐户使用 php 将他们的用户名插入到 csv 文件中。

用户只有在插入他们的推特后才能访问该页面，而我正在使用 oauth 授权是一个实际的推特帐户。

但是，如果用户再次访问该页面，它们将再次插入到 csv 文件中。如果他们刷新页面等等（当 $username 值为空白时），我有非常简单的逻辑来防止插入。

```
<?php
if ($username == '') //check if $username is blank so empty row isnt inserted
{}
else{
$cvsData = $username."\n";
$fp = fopen("Twitter.csv","a"); // $fp is now the file pointer to file $filename
if($fp){
fwrite($fp,$cvsData); // Write information to the file
fclose($fp); // Close the file
  }
}
?> 
```

文件中没有标题行。它只是一列推特句柄。我知道逻辑听起来很简单：

```
open csv file
loop through each row searching for value of $username
if $username exists - close file
else append $username
close file 
```

不幸的是，我仍在学习并且无法找到解决方案。也许它是我需要帮助的循环部分？或者一个起点。我根本不是在寻找代码来实现这一点，尽管这样可以节省我的时间。我不害怕学习它——只是很难自己找到解决方案。很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:02:56.183

> array_unique — 从数组中删除重复值

将 csv 中的值放入一个数组并在其上运行[array_unique()](http://php.net/manual/en/function.array-unique.php)。

# javascript - 无法使用 XmlHttpRequest 解析 ASPX 页面

> ID：12591647
> 
> 赞同：0
> 
> 时间：2012-09-25T21:53:53.423
> 
> 标签：javascript, asp.net, ajax, xmlhttprequest

我在 IE 中有一个标准的简单 AJAX 查询（使用 Msxml2.XMLHTTP ActiveX 对象），它请求同一域中的 ASPX 页面。虽然 responseText 字段包含完整的 HTML，但在 IE 中 responseXML 字段是空白的（这在 Chrome 中工作得很好）。

作为调试过程的一部分，我将 ASPX 页面剥离为一点点 XML，我什至通过一个 XML 验证器运行它，以确保我没有输入任何错误。我将 ASPX 页面的内容类型更改为“text/xml”（IE 将页面标识为页面属性中的 XML 文档）并将编码更改为“utf-8”（在页面级别和通过全球化标签）在 web.config 中）。

当我的 Web 服务返回完全相同的内容时，AJAX 代码就没有问题了。此外，AJAX 可以轻松读取同一项目中的 XML 文件（包含内容的完全副本）。它只是似乎无法解析的 ASPX 页面。

我在使用 UpdatePanels (ASP.NET 3.5) 时遇到了麻烦，所以我将使用纯 JavaScript 方法。

有什么建议么？我错过了什么吗？

**AJAX 代码**

```
 function NavigateResults(query) {

        var xmlHttp;

        try {
            xmlHttp = new XMLHttpRequest();
        } catch (e) {

            // These are utilized for Microsoft IE browsers
            try {
                //alert('Boy... you should consider upgrading your browser.');
                xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
            } catch (e) {
                try {
                    //alert('Whoa... no, seriously, you really need to upgrade!!!');
                    xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
                } catch (e) {
                    //alert("Yikes! Your browser does not support AJAX! Your inter-webs are broken! Call a 15-year old ASAP!");
                    window.location = url;
                    return false;
                }
            }

        }

        if (xmlHttp !== null) {
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                    response = xmlHttp.responseXML;
                    var l_stringNode;
                    try {
                        l_stringNode = response.selectNodes("div")[0];
                    } catch (e) {
                        try {
                            l_stringNode = response.evaluate("div")[0];
                        } catch (e) {
                            l_stringNode = null;
                        }
                    }

                    alert("Response Text:\n\n" + xmlHttp.responseText);
                    alert("Response XML:\n\n" + xmlHttp.responseXML.xml);

                    //document.getElementById("SearchResultsDiv").innerHTML = xmlHttp.responseText;

                    if (l_stringNode !== null && l_stringNode.firstChild !== null) {
                        try {
                            var serializer = new XMLSerializer();
                            document.getElementById("SearchResultsDiv").innerHTML = serializer.serializeToString(l_stringNode);
                        } catch (e) {
                            // IE does not support serializeToString
                            document.getElementById("SearchResultsDiv").innerHTML = l_stringNode.xml;
                        }
                    }
                }
            }

            var url = prompt("URL", "http://localhost:6168/Test.xml"); // + query + "&contType=xml");
            xmlHttp.open("GET", url, true);
            //prompt("URL", "http://localhost:4511/Service1.asmx/Autocomplete?prefix=test");
            //xmlHttp.open("GET", "http://localhost:4511/Service1.asmx/Autocomplete?prefix=test", true);
            xmlHttp.send(null);
        }

    } 
```

**测试 XML** （通过查看源从 Test.aspx 复制，与 XML 文件和来自 Web 服务的响应完全匹配）

```
<?xml version="1.0"?>
<ul>
  <li>Testacea</li>
  <li>Testament</li>
  <li>Testudinata</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T13:23:37.293

好的，我终于想通了。一个典型的 ASPX 页面在顶部有页面信息，然后是内容，如下所示：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Test.aspx.cs" Inherits="Test" %>
<?xml version="1.0"?>
<ul>
  <li>Testacea</li>
  <li>Testament</li>
  <li>Testudinata</li>
</ul> 
```

该页面信息实际上在输出顶部创建了一个空行，这会导致 XML 无效（如果存在，则 xml 声明必须位于第一行）。所以，有两种解决方案。一，将 xml 声明移到同一行，如下所示：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Test.aspx.cs" Inherits="Test" %><?xml version="1.0"?> 
```

二、彻底去掉xml声明。

您仍然必须将内容类型设置为 text/xml。

```
protected void Page_Load( object sender, EventArgs e ) {
    this.Response.ContentType = "text/xml";
    this.Response.ContentEncoding = System.Text.Encoding.UTF8;
} 
```

# c++ - 使用互斥锁的正确方法

> ID：12591648
> 
> 赞同：1
> 
> 时间：2012-09-25T21:53:54.317
> 
> 标签：c++, multithreading, boost, boost-thread

关于下面的代码，我想知道的是：在方法调用周围使用 try catch 块是一种好的做法。下面的代码中有哪些愚蠢之处？

```
#ifndef TIMER_H
#define TIMER_H

#include <boost/bind/bind.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>
#include <boost/function.hpp>
#include <boost/thread/thread.hpp>
#include <boost/thread/recursive_mutex.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/make_shared.hpp>

#include <stdint.h>
#include <iostream>
#include <vector>

template <uint32_t tMilliSeconds>
class Timer {
private:
    static Timer *_instance;
    uint32_t mMilliSeconds;
    boost::mutex mListMutex;
    boost::thread mTimerThread;
    std::vector<boost::function<void()> > mHandlerList;

    Timer();
    Timer(const Timer &other);
    Timer &operator=(const Timer &other);
    void Run();

public:
    ~Timer();
    static boost::shared_ptr<Timer<tMilliSeconds> > Instance();
    void AddHandler(boost::function<void()> tmpBoostFunction);
};

template <uint32_t tMilliSeconds>
Timer<tMilliSeconds>::Timer() :
    mListMutex() {
    mMilliSeconds = tMilliSeconds;

    mTimerThread = boost::thread(
        boost::bind(&Timer<tMilliSeconds>::Run, this));
}

template <uint32_t tMilliSeconds>
Timer<tMilliSeconds>::~Timer()  {
    mListMutex.lock();
    try {
        mTimerThread.detach();
    } catch (...) {
        mListMutex.unlock();
    }
    mListMutex.unlock();
}

template <uint32_t tMilliSeconds>
boost::shared_ptr<Timer<tMilliSeconds> >
Timer<tMilliSeconds>::Instance() {
    if (!_instance) {
        _instance = new Timer<tMilliSeconds>();
    }
    return boost::shared_ptr<Timer<tMilliSeconds> >(_instance);
}

template <uint32_t tMilliSeconds>
void Timer<tMilliSeconds>::Run() {
    while(true) {
        boost::this_thread::sleep(
            boost::posix_time::milliseconds(mMilliSeconds));
        mListMutex.lock();
        for (std::vector<boost::function<void()> >::iterator vect_it =
            mHandlerList.begin(); vect_it != mHandlerList.end();
            ++vect_it) {
            try {
                (*vect_it)();
            } catch (...) {
                mListMutex.unlock();
            }
        }
        mListMutex.unlock();
    }
}

template <uint32_t tMilliSeconds>
void Timer<tMilliSeconds>::AddHandler(
    boost::function<void()> tmpBoostFunction) {

    mListMutex.lock();
    try {
        mHandlerList.push_back(tmpBoostFunction);
    } catch (...) {
        mListMutex.unlock();
    }
    mListMutex.unlock();
}
#endif // TIMER_H 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:56:26.497

由于您使用的是 boost，我会考虑将互斥锁与 a 结合使用`boost::scoped_lock`，这样当`scoped_lock`对象超出范围时，互斥锁会通过其析构函数调用“自动”解锁。然后，您无需担心与您的`try`和`catch`块交错解锁互斥锁，因为通过异常展开堆栈将通过`scoped_lock`对象释放互斥锁上的锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:56:48.280

不，您使用 catch 块是错误的。如果确实发生了异常，那么您应该会导致更多的解锁。如果`lock()`成功则调用`unlock()`一次且仅调用一次。您应该使用为您管理解锁的锁包装器，例如：

```
class mutex_lock
{
private:
    boost::mutex &mListMutex; 
public:
    mutex_lock(boost::mutex &aListMutex) : mListMutex(aListMutex) { mListMutex.lock(); }
    ~mutex_lock() { mListMutex.unlock(); }
}; 
```

然后你可以这样做：

```
template <uint32_t tMilliSeconds> 
Timer<tMilliSeconds>::~Timer()
{ 
    mutex_lock lock(mListMutex); 
    mTimerThread.detach(); 
} 

template <uint32_t tMilliSeconds> 
void Timer<tMilliSeconds>::Run()
{ 
    while(true) { 
        boost::this_thread::sleep(
            boost::posix_time::milliseconds(mMilliSeconds)); 
        mutex_lock lock(mListMutex); 
        for (std::vector<boost::function<void()> >::iterator vect_it = mHandlerList.begin(); vect_it != mHandlerList.end(); ++vect_it) { 
            (*vect_it)(); 
        } 
    } 
} 

template <uint32_t tMilliSeconds> 
void Timer<tMilliSeconds>::AddHandler( 
    boost::function<void()> tmpBoostFunction)
{ 
    mutex_lock lock(mListMutex); 
    mHandlerList.push_back(tmpBoostFunction); 
} 
```

**更新：** boost 有自己的`scoped_lock`类用于完全相同的目的：

```
#include <boost/interprocess/sync/scoped_lock.hpp>

template <uint32_t tMilliSeconds> 
Timer<tMilliSeconds>::~Timer()
{ 
    boost::interprocess::scoped_lock<boost::mutex> lock(mListMutex); 
    mTimerThread.detach(); 
} 

template <uint32_t tMilliSeconds> 
void Timer<tMilliSeconds>::Run()
{ 
    while(true) { 
        boost::this_thread::sleep(
            boost::posix_time::milliseconds(mMilliSeconds)); 
        boost::interprocess::scoped_lock<boost::mutex> lock(mListMutex); 
        for (std::vector<boost::function<void()> >::iterator vect_it = mHandlerList.begin(); vect_it != mHandlerList.end(); ++vect_it) { 
            (*vect_it)(); 
        } 
    } 
} 

template <uint32_t tMilliSeconds> 
void Timer<tMilliSeconds>::AddHandler( 
    boost::function<void()> tmpBoostFunction)
{ 
    boost::interprocess::scoped_lock<boost::mutex> lock(mListMutex); 
    mHandlerList.push_back(tmpBoostFunction); 
} 
```

# .net - 使用 UI 自动化，Winforms 按钮多次调用

> ID：12591649
> 
> 赞同：4
> 
> 时间：2012-09-25T21:54:01.453
> 
> 标签：.net, winforms, ui-automation, msaa

我正在尝试在我的应用程序中使用[MS UI 自动化框架](http://msdn.microsoft.com/en-us/library/ms747327.aspx)进行一些自动化测试。我现在的目标是监听 GUI 事件并记录它们，类似于 Windows SDK 中提供的示例 (TestScriptGeneratorSample)。

只需使用该演示应用程序，我就可以使用一个按钮启动一个简单的 Windows 窗体应用程序，并看到它将单击事件记录为“调用”UIA 事件。但是，对于按钮的每次单击，演示应用程序都会记录**4 个**“调用”事件。这是为什么？使用 WPF 按钮时，我没有看到这个问题。

我的猜测是，由于`System.Windows.Forms.Button`该类支持[MSAA](http://msdn.microsoft.com/en-us/library/windows/desktop/dd373592%28v=vs.85%29.aspx)而不是 UIA，因此桥接 MSAA 接口的 UIA 部分行为不端，或者至少以我不理解且找不到任何文档的方式表现。也许它正在报告鼠标按下，向上，单击，然后实际按下按钮的调用事件？

谁能解释这种行为，和/或提供一种解决方法，以便按下一个按钮会导致一个调用事件？

**编辑：**这是在 WinXP SP3 下。我刚刚安装了[Windows 自动化 API 3.0](http://support.microsoft.com/kb/976779) [更新](http://support.microsoft.com/kb/971513)，仍然看到相同的行为。

**编辑2：**我发现[了这个例子](http://www.universalthread.com/ViewPageArticle.aspx?ID=199)，作者不经意地提到了这种行为作为Win32控件中的一个错误，但没有引用任何证据......

这是我的示例应用程序（上面有一个按钮的表单），以及其中包含的事件监听。添加对`UIAutomationClient`和的引用`UIAutomationTypes`。单击按钮并看到调用发生了四次而不是一次。

```
using System;
using System.Drawing;
using System.Windows.Automation;
using System.Windows.Forms;

namespace WindowsFormsApplication6
{
    public partial class Form1 : Form
    {
        private TextBox m_Output;

        public Form1()
        {
            InitializeComponent();

            // set up the GUI with a single button...
            Button b = new Button {Location = new Point(5, 5), Name = "Test", Text = "Click Me"};
            // ... and a textbox to write events to.
            m_Output = new TextBox { Location = new Point(5, 30), Name = "Output", Multiline = true, Size = new Size(250, 200) };

            this.Controls.Add(b);
            this.Controls.Add(m_Output);

            // get the button as an UIA element
            AutomationElement button = AutomationElement.FromHandle(b.Handle);
            // attach a handler to the button, listening for the Invoke event
            Automation.AddAutomationEventHandler(
                                                 InvokePattern.InvokedEvent,
                                                 button,
                                                 TreeScope.Element,
                                                 OnInvoked);
        }

        // Handler for button invoke events
        private void OnInvoked(object Sender, AutomationEventArgs E)
        {
            AppendText("Invoked: " + ((AutomationElement)Sender).Current.AutomationId);
        }

        // Just dumps text to the textbox
        private void AppendText(string Text)
        {
            if (m_Output.InvokeRequired)
            {
                m_Output.BeginInvoke((Action<string>)AppendText, Text);
            }
            else
            {
                m_Output.AppendText(DateTime.Now.ToString("hh:mm:ss.fff") + ": " + Text + Environment.NewLine);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:55:50.277

对于它的价值，我通过将发出的多个事件过滤为一个来解决它。在测试过程中，我发现了以下内容：

*   .NET 按钮（即 Winforms）在单击时按顺序生成以下事件：
    1.  调用
    2.  调用
    3.  调用
    4.  属性更改（`Name`属性）
    5.  调用
*   Win32 按钮在某些情况下会生成以下事件（中的按钮`calc.exe`）：
    1.  属性更改（`HasKeyboardFocus`属性）
    2.  调用
*   Win32 按钮在其他情况下会生成以下事件（保存文件对话框中的“取消”）：
    1.  调用
    2.  属性更改（`HasKeyboardFocus`属性）
    3.  调用

使用与事件相关联的`FrameworkId`属性`AutomationElement`，我可以区分前两种情况（`"Winform"`用于 .NET 按钮和`"Win32"`Win32 按钮）。然后对于两个 Win32 场景，我只需确保`HasKeyboardFocus`在记录调用的事件之前获得属性更改事件。

我还没有看到这不起作用，因为我似乎总是得到`HasKeyboardFocus`属性更改事件，即使按钮已经被聚焦（即我按下它两次）。

如果有人有的话，我仍然希望看到更多的见解...

# ios6 - Facebook 测试用户和 iOS6 操作系统集成

> ID：12591652
> 
> 赞同：3
> 
> 时间：2012-09-25T21:54:19.927
> 
> 标签：ios6, facebook-test-users

我想在我的 iPhone 模拟器和 iPhone 本身中使用我的 FaceBook 测试用户（可以在浏览器中使用并且用户名/密码正常工作）来尝试从应用程序发布。如果我尝试在 iOS6 设置中注册 FaceBook 测试帐户，我得到一个错误

> 无法与服务器通信

此错误与用户名/密码错误不同，并且在弹出错误之前似乎工作了近 30 秒。（通过 Mobile Safari 登录完美无缺）

有什么想法我应该尝试让 iOS6 与我的 FaceBook 测试用户一起工作吗？

最好的问候 A.Steinel

# php - 删除数组的某些元素不起作用

> ID：12591654
> 
> 赞同：0
> 
> 时间：2012-09-25T21:54:31.490
> 
> 标签：php

我有这个数组，我想做的就是循环遍历并删除出现在 if 中的某些元素，但是每当我输出数组时，它总是只显示

```
array(0) { } 
```

代替

```
["addon_h_id"]=> string(1) "1" 
```

这是循环通过它的代码，如果我删除此代码，则数组将正常显示

```
 foreach ($new_shopping_array as $columnName => $columnData) {
                          if($columnName == "s_list_id" || "user_id"){
                              unset($new_shopping_array[$columnName]);  
                          }        
                      } 
```

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T21:56:21.770

[运算符优先级](http://www.php.net/manual/en/language.operators.precedence.php)：您正在执行 $columnName = "s_list_id"，然后将结果与 "user_id" 进行 ORing

```
if($columnName == "s_list_id" || $columnName == "user_id"){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T21:56:41.240

问题是你的`if`陈述：

```
if($columnName == "s_list_id" || "user_id") 
```

该字符串`"user_id"`将评估为 true，因此将删除所有值。

你可能想要这样的东西：

```
if (in_array($columnName, array('s_list_id', 'user_id'))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:00:12.020

怎么样：

```
$new_array = array();

foreach ($new_shopping_array as $columnName => $columnData) 
{
    if ($columnName != "s_list_id" && $columnName != "user_id")
    {
        $new_array[$columnName] = $columnData;
    }        
 } 
```

$new_array 包含您需要的数据。

如果您更喜欢您的解决方案，则需要像这样更改条件：

```
foreach ($new_shopping_array as $columnName => $columnData) 
{
    if ($columnName == "s_list_id" || $columnName == "user_id")
    {
        unset($new_shopping_array[$columnName]);
    }        
 } 
```

它的编写方式告诉 php if`$columnName`等于`s_list_id`OR "user_id"。条件不在其中，`columnName`并且“user_id”验证为 TRUE（因为其中包含某些内容）。因此，您的条件始终为 TRUE，从而从原始数组中删除所有内容。

高温高压

# asp.net - 具有多个表更新的 ASP.NET UpdateCommand

> ID：12591658
> 
> 赞同：1
> 
> 时间：2012-09-25T21:54:53.380
> 
> 标签：asp.net

我正在使用 ASP.NET 并使用带有 UpdateCommand 的网格来更新 2 个表我有以下但似乎不起作用，因为我没有收到任何错误，但它根本没有更新。从你所看到的，我在正确的轨道上吗？

```
 UpdateCommand="UPDATE [tbl_ProgDt] SET [Type] = @type, [Identifiction] = @samplePoint WHERE [Seq] = @valID UPDATE [tbl_Prog] SET StoreNum = @storeNum WHERE ID = (SELECT ID FROM [tbl_ProgDt] WHERE [Seq] = @valID " >

    <UpdateParameters>
      <asp:Parameter Name="type" Type="String" />
      <asp:Parameter Name="samplePoint" Type="String" />
      <asp:Parameter Name="valID" Type="Int32" />
      <asp:Parameter Name="storeNum" Type="Int32" />
       <asp:Parameter Name="valID" Type="Int32" />
   </UpdateParameters> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:06:13.813

如果您需要做类似的事情，最好创建一个存储过程并使用数据库事务包装两个更新语句

您需要指定：

```
UpdateCommandType="StoredProcedure" UpdateCommand="Stored Procedure Name" 
```

在您的存储过程中，如下所示：

```
BEGIN TRANSACTION;

-- your update sentences

COMMIT TRANSACTION; 
```

# nosql - Cassandra 架构设计

> ID：12591660
> 
> 赞同：1
> 
> 时间：2012-09-25T21:55:08.823
> 
> 标签：nosql, cassandra, hector

我正在继续探索 Cassandra，我想创建类似于 RDBMS 上的多对多的 Student <=> 课程关系。

在查询方面，我将使用以下查询；

1.  检索学生注册的所有课程。
2.  检索所有注册特定课程的学生。

假设我为列族创建。一个用于课程，另一个用于学生。

```
CREATE COLUMN FAMILY student with comparator = UTF8Type AND key_validation_class=UTF8Type and column_metadata=[ 
{column_name:firstname,validation_class:UTF8Type} 
{column_name:lastname,validation_class:UTF8Type}
{column_name:gender,validation_class:UTF8Type}];

CREATE COLUMN FAMILY course with comparator = UTF8Type AND key_validation_class=UTF8Type and column_metadata=[ 
{column_name:name,validation_class:UTF8Type} 
{column_name:description,validation_class:UTF8Type}
{column_name:lecturer,validation_class:UTF8Type}
{column_name:assistant,validation_class:UTF8Type}]; 
```

现在我应该如何继续？

`courseID:studentId`我应该使用CompisiteKey创建第三个列族吗？如果是，我可以使用 Hector 仅通过一个（左或右）复合键组件进行查询吗？

请帮忙。

**更新：**

按照建议，我创建了以下架构：

对于学生：

```
CREATE COLUMN FAMILY student with comparator = UTF8Type and key_validation_class=UTF8Type and default_validation_class=UTF8Type; 
```

然后我们将添加一些数据：

```
set student['student.1']['firstName']='Danny'
set student['student.1']['lastName']='Lesnik'
set student['student.1']['course.1']=''
set student['student.1']['course.2']=''; 
```

为课程创建列族：

```
CREATE COLUMN FAMILY course with comparator = UTF8Type and key_validation_class=UTF8Type and default_validation_class=UTF8Type; 
```

添加一些数据：

```
set course['course.1']['name'] ='History'
set course['course.1']['description'] ='History Course'
set course['course.1']['name'] ='Algebra'
set course['course.1']['description'] ='Algebra Course' 
```

最后是课程中的学生：

```
CREATE COLUMN FAMILY StudentInCourse with comparator = UTF8Type and key_validation_class=UTF8Type and default_validation_class=UTF8Type; 
```

添加数据：

```
set StudentInCourse['studentIncourse.1']['student.1'] =''; 
set StudentInCourse['studentIncourse.2']['student.1'] =''; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T14:23:02.397

我在下面定义了一个数据模型，但首先描述对象模型然后深入到行模型更容易，所以从 PlayOrm 的角度来看，你会有

```
public class Student {
  @NoSqlId
  private String id;
  private String firstName;
  private String lastName;
  @ManyToMany
  private List<Course> courses = new ArrayList(); //constructing avoids nullpointers
}

public class Course {
  @NoSqlId
  private String id;
  private String name;
  private String description
  @ManyToOne
  private Lecturer lecturer;
  @ManyToMany
  private CursorToMany students = new CursorToManyImpl();
} 
```

我本可以在课程中使用 List，但我担心如果有太多学生多年来学习一门课程，我可能会出现 OutOfMemory。现在，让我们跳到 PlayOrm 所做的事情，如果你愿意，你可以做类似的事情

一个学生行看起来像这样

```
rowKey(the id in above entity) = firstName='dean',
lastName='hiller' courses.rowkey56=null, courses.78=null, courses.98=null, courses.101=null 
```

这是宽行，我们有许多名为“fieldname”和“rowkey to actual course”的列

课程行更有趣....因为用户认为为单个课程加载所有学生可能会导致内存不足，所以他使用的游标在您循环时一次只加载 500 个。

在这种情况下，PlayOrm 将有两行支持 Course。Sooo，让我们把我们的用户行放在上面，他在课程 rowkey56 所以让我们描述一下那门课程

```
rowkey56 = name='coursename', description='somedesc', lecturer='rowkey89ToLecturer' 
```

然后，在一些学生的索引表中还有另一行（这是一个非常宽的行，因此最多支持数百万学生）

```
indexrowForrowkey56InCourse = student34.56, student39.56, student.23.56.... 
into the millions of students 
```

如果您希望一门课程拥有超过数百万的学生，那么您需要考虑是否使用 playOrm 进行分区。如果您需要，PlayOrm 会为您进行分区。

注意：如果你不知道 hibernate 或 JPA，当你加载上面的 Student 时，它会加载一个代理列表，所以如果你开始循环访问课程，它会返回到 noSQL 存储并加载课程，这样你就不会必须 ;）。

在 Course 的情况下，它会加载一个代理 Lecturer，直到您访问像 leller.getName() 这样的属性字段时才会填写该代理讲师。如果您调用讲师.getId()，它不需要加载讲师，因为它已经从课程行中获得了讲师。

编辑（更详细）：PlayOrm 有 3 个索引表 Decimal（存储 double、float 等和 BigDecimal）、Integer（long、short 等以及 BigInteger 和 boolean）和 String 索引表。当您使用 CursorToMany 时，它会根据键的 FK 类型使用这些表之一。它还将这些表用于它的 Scalable-SQL 语言。它在 CursorToMany 上使用单独行的原因是客户端在读取一行时不会出现 OutOfMemory，因为在某些情况下，toMany 中可能有一百万个 FK。CursorToMany 然后从该索引行中批量读取。

后来，迪恩

# ios - 如何更改 UITableViewCell 中 textLabel 的宽度

> ID：12591662
> 
> 赞同：0
> 
> 时间：2012-09-25T21:55:09.120
> 
> 标签：ios, rubymotion

我有几个`UITableViewCell`有自定义按钮的。这些按钮覆盖了一些单元格中的文本。如何设置`textLabel`单元格内属性的宽度，以免发生这种情况？这似乎不起作用。

```
cell.textLabel.font = UIFont.boldSystemFontOfSize(16)
cell.textLabel.adjustsFontSizeToFitWidth = true
cell.textLabel.numberOfLines = 0
cell.textLabel.lineBreakMode = UILineBreakModeWordWrap
cell.textLabel.preferredMaxLayoutWidth = 200 
```

我在`tableView(table_view, willDisplayCell:cell, forRowAtIndexPath:index_path)`方法中运行它。

此时设置框架也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:05:23.357

如果您需要`UITableViewCell`s 看起来比默认行为更好，您可能应该在您自己的视图子类中绘制完整的内容、自定义按钮和文本以及可能的其他信息，并将其作为单元格的视图返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T04:46:45.807

可能创建/分配一个 UILabel 并将其添加到单元格中。这样你就可以设置它的框架。

# php - 文件未保存到特定文件夹（目录创建）

> ID：12591663
> 
> 赞同：-2
> 
> 时间：2012-09-25T21:55:13.153
> 
> 标签：php

我尝试将我的文件 status.txt 保存到名为 social 的特定目录中。我创建了目录social，但由于某种原因，我的status.txt名称是socialstatus.txt，而status.txt文件不在social目录中，而是在social目录所在的同一文件夹中（我希望我不要迷惑你。）

我尝试这样做，但它似乎与代码的位置有关......那些将文件保存到目录的编码是开始 if(!file_exists($newdir)){

非常感谢您的大力帮助

```
<?php

$newdir = "../../data/social";
umask(0007);

$errors = array();
$permissionsArray = (isset($_POST['permission']) ? $_POST['permission'] : null);

if (isset($_POST["statuscode"])) 
{
    $statusCode = $_POST["statuscode"];
    $patternCode = "/^S[0-9]{4}$/";
    if (preg_match($patternCode, $statusCode)) 
    {
        $ans = "";
        $length = strlen($statusCode);
        echo $statusCode . "<br />";
    }
}
else
{
    array_push($errors, "Please fill in Status Code as they are mandatory field");
}

if (isset ($_POST["status"])) 
{
    $status = $_POST["status"];
    $pattern = "/^[a-zA-Z0-9\s\.,!?]*$/";
    if (preg_match($pattern, $status)) 
    {
        echo $status . "<br />";
    }
}
else
{
    array_push($errors, "<b>Error:</b> Please fill in Status as they are mandatory field!");
}

if (isset ($_POST["share"])) 
{
    $shareButton = $_POST["share"];
    echo $shareButton . "<br />";
}
else
{
    //Not possible unless in exceptional circumstances
    array_push($errors, "Please choose a share");
}

if (isset($_POST["date"])) 
{
    $date = date("d/m/y");
    echo $date . "<br />";
} else {
    $date = $_POST["date"];
} 

if (isset($permissionsArray)) 
{
    foreach($permissionsArray as $permission){
        echo $permission . "<br />";
    }
}

if(!file_exists($newdir)){
    mkdir($newdir, 02770);

$statusTxt = fopen($newdir. "status.txt", "a");

if  (is_writeable($newdir. "status.txt")) {
    if (fwrite($statusTxt, $statusCode . " " . $status . " " . $shareButton . " " . $date . " " . $permission . "\n"))
{
}
    echo "<p>Your form has succesfully been submit!</p>";
}
fclose($statusTxt);
}

if(isset($statusCode, $status))
{
    //if(empty($statusCode) || empty($status))
    //{
    //array_push($errors, "Please fill in the required part!");
    //}
    if (0 === strlen($statusCode > 5 || $statusCode < 5)) 
    {
        array_push($errors, "<b>Error:</b> You characters length is either less or more than 5 characters<br/>");
    }
    if (0 === preg_match("/\S+/", $statusCode)) 
    {
        array_push($errors, "<b>Error:</b> You forgot to fill in Status Code!<br/>");
    }
    if (0 === preg_match("/\S+/", $status)) 
    {
        array_push($errors, "<b>Error:</b> You forgot to fill in the Status! <br/>");
    }
    if (0 === preg_match($patternCode, $statusCode)) 
    {
        array_push($errors, "<b>Error:</b> please make sure that the first letter in Status Code is uppercase 'S' following by 4 numbers. <br/>");
    }
    if (0 === preg_match($pattern, $status)) 
    {
        array_push($errors, "<b>Error:</b> Please make sure to avoid symbols other than \",.?!\" <br/>");
    }
}

if (isset($errors)) 
{
    foreach ($errors as $error) 
    {
        echo '<strong>', $error, '</strong>';
    }
}

echo '<a href="phpstatusform.php">Back to Form page.</a> <br />';

echo '<a href="index.php">Back to Home page.</a>'; 

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:03:37.743

$newdir = " **../../data/social** ";
$statusTxt = fopen( **$newdir. "status.txt"** , "a");

替换变量...

$statusTxt = fopen( **"../../data/social". "status.txt"** , "a");
你缺少一个 /

# c - 计算标准输入中的字数和行数的 C 程序

> ID：12591664
> 
> 赞同：0
> 
> 时间：2012-09-25T21:55:15.627
> 
> 标签：c

我是 C 编程的新手，目前正在尝试自学如何创建一个 C 程序，该程序可以计算输入流中的单词和行数并将两个总数打印到标准输出。

我实际上想做的是让程序计算行数，并根据我觉得我不在的单词的定义来计算单词的数量。

我希望单词排除空格、制表符、换行符、连字符或冒号。让程序以小数形式输出结果（单词和行）。

```
#include<stdio.h>

int main()
{
    int iochar;
    int words;
    int lines;

    printf("Enter something here:\n\n");

    while ((iochar = getchar ()) !=EOF)
    {
        if((iochar == ' ') || (iochar == '\t') || (iochar == '\n'))

        putchar(iochar);
    }

    return 0;
} 
```

我完全不参加这个计划了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:29:04.127

If your question is how to fix the compile error, that's simple. Add one more closing brace at the end.

But your program will still do only one pass through the loop and will print only one character if and only if the user types a space, tab or newline. No matter what the user types, the program will then terminate. I doubt that's what you wanted.

I suspect this is what you intended:

```
while ((iochar = getchar ()) !=EOF)
{
    if((iochar == ' ') || (iochar == '\t') || (iochar == '\n'))
    {
        putchar(iochar);
    }
}
return 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:09:15.240

在你的“我试图让你的数字在 8 列字段中正确对齐......”之后，我无法理解你想说什么:(

```
int words = 0;
int lines = 0;
char buffer[1024];
while(fgets(buffer, sizeof buffer, stdin))
{
    lines++;
    if(buffer[0] == '\n')
        continue;
    char *tmp = buffer-1;
    while(tmp = strchr(tmp+1, ' '))
        words++;
    words++; /* count last word before \0*/
}

printf("lines: %d, words: %d\n", lines, words); 
```

那是你需要/想要的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:17:02.347

错误信息是：

> Test.c:20:1：错误：输入末尾的预期声明或语句

它无法编译，因为您缺少`}`.

如果你正确缩进你的代码，像这样，你会发现你的错误：

```
#include<stdio.h>

int main() {

   int iochar;
   int words;
   int lines;

    printf("Enter something here:\n\n");

    while ((iochar = getchar ()) !=EOF)
    {
       if((iochar==' ')||(iochar=='\t')||(iochar=='\n'))
       {
       putchar(iochar);
       iochar = getchar();
       }
       return 0;

    } 
```

可读性重要性的另一个例子:)

# spring - 为什么我的 Spring 模型没有填充正确的属性？

> ID：12591667
> 
> 赞同：0
> 
> 时间：2012-09-25T21:55:25.853
> 
> 标签：spring, model, attributes, controller

我正在使用 Spring 3.1.0.RELEASE。出于某种原因，在我的控制器中，当我发布表单并在发生错误时返回原始屏幕时，模型属性不会像我通过 GET 方法调用页面时那样填充。在我的控制器中，我有

```
@Controller
public class StandardsUploadController {

    …
    @RequestMapping(value = "/upload")
    public String getUploadForm(Model model) {
        model.addAttribute(new StandardsUploadItem());
        model.addAttribute("gradeList", gradeList);
        model.addAttribute("subjectList", subjectList);
        return "upload/index";
    }

    @RequestMapping(value = "/upload", method = RequestMethod.POST)
    public ModelAndView processFile(final StandardsUploadItem uploadItem,
        final BindingResult result, 
        final HttpServletRequest request,
        final HttpServletResponse response) throws InvalidFormatException, CreateException, NamingException {

        stdsUploadValidator.validate(uploadItem, result);
        if (!result.hasErrors()) {
            try {
                …       
            } catch (IOException e) {
                LOG.error(e.getMessage(), e);
                e.printStackTrace();
            }
        }   // if

        return new ModelAndView("upload/index");
    } 
```

我做错了什么，我该如何纠正？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:08:04.617

当您从 POST 返回到上传/索引视图时，它不会重新填充模型，因为填充模型的代码是在 GET 上完成的。

一种可能的选择是在 Controller 类中使用[@ModelAttribute注释](https://stackoverflow.com/questions/3423262/what-is-modelattribute-in-spring-mvc)

例如，对于 StandardsUploadItem，您将有一个看起来像这样的方法：

```
@ModelAttribute("uploadItem")
public StandardsUploadItem getStandardsUploadItem(){
    return new StandardsUploadItem();
} 
```

然后，您可以从 GET 方法中删除以下行：

```
model.addAttribute(new StandardsUploadItem()); 
```

由于使用@ModelAttribute 注解并返回对象的方法将自动放入ModelMap，无论激活哪个Controller RequestMapping 方法。

您的 POST 方法的方法签名将包含如下内容：

```
..., @ModelAttribute("uploadItem") StandardsUploadItem uploadItem, ... 
```

您需要对模型中的其他属性（gradeList 和 subjectList）执行类似的操作，但由于您在 POST 上似乎不需要它们，您可以执行类似将模型参数添加到您的 POST 方法签名的操作，并且在错误情况下返回 ModelAndView 之前重新填充该模型。

# c# - 使用 INavigationAware 和 Prism 正确处理视图和视图模型

> ID：12591672
> 
> 赞同：1
> 
> 时间：2012-09-25T21:56:08.167
> 
> 标签：c#, wpf, prism

我使用 Prism IRegionManager 在屏幕之间导航：

```
_regionManager.RequestNavigate( RegionNames.MainContentRegion, uri ); 
```

我有一个以上述方式导航到的人员编辑视图，并且我总是希望在选择要编辑的新人员时重新加载此屏幕。为此，我在 INavigationAware 的 IsNavigationTarget 方法中返回 false。我也在使用 mvvm，并且这个 Person Edit View 有一个 PersonEditViewModel。

我担心的是应用程序永远不会处理以前的 PersonEditViewModel。我知道它不会自动处理，因为 IsNavigationTarget 是为所有先前创建的 PersonEditViewModels 调用的。我放了一个断点来告诉。

处理视图和视图模型的好方法是什么？因为我知道我总是会在 IsNavigationTarget 中返回 false 我宁愿处置它们并释放一些空间。我在想也许我可以在 OnNavigatedFrom 方法中做点什么？...

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:21:50.693

您需要[查看](http://msdn.microsoft.com/en-us/library/microsoft.practices.prism.regions.behaviors.regionmemberlifetimebehavior%28v=pandp.38%29.aspx)`IRegionMemberLifetime`RegionMemberLifetimeBehaviour 。

# assembly - 使用 int 0x20 和 int 0x21 / ah=0x4C 退出 16 位汇编程序有什么区别？

> ID：12591673
> 
> 赞同：7
> 
> 时间：2012-09-25T21:56:11.973
> 
> 标签：assembly, x86, dos

在不同的时候，我都用过

```
int 0x20 
```

和

```
mov ah, 0x4c
int 0x21 
```

作为结束 16 位汇编程序的方法。

但是这两者有什么区别呢？

* * *

**编辑**：感谢大家的评论。跟进 Alexey 对 PSP（程序段前缀）的引用，[从 Microsoft MASM 支持中得到了这个块](https://jeffpar.github.io/kbarchive/kb/072/Q72848/)。

这篇文章似乎表明除了返回码之外还有更多的区别。

很高兴将公认的答案授予任何可以更明确地将两者联系在一起的人。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-26T01:22:58.287

首先，一些背景。DOS 使用中断 21h 进行系统调用。AH 用于解复用 INT 21h 提供的各种功能。执行程序时，DOS 会在其前面放置 256 个字节，称为 PSP（程序段前缀），其中包含有关进程的信息。

DOS 中的原始退出函数是`INT 21/AH=00`. 现在，显然 DOS 开发人员决定从程序返回应该是退出程序的一种方式（这是来自 CP/M 吗？）。`RET`(near) 从堆栈中弹出一个单词并跳转到它。所以，当一个程序被创建时，它的堆栈以一个单词开头`0000`。这是 PSP 的开始。所以，在 PSP 的开始有终止程序的代码。为了使该代码保持较小，请`INT 20h`充当`MOV AH,00h ; INT 21h`.

[编辑：这可以在下面的屏幕截图中看到。]

DOS 2.0 继承了 Unix 的许多东西，包括返回码。因此，出现了一个新的 INT 21h 函数`INT 21h/AH=4ch`，它需要一个返回码将其返回给操作系统。此功能还设计用于处理 EXE 文件（AFAIR 也是 DOS 2.0 中的新功能），它可以有多个段。前面的退出函数（INT 20h 和 INT 21h/00）假设 CS 与 COM 程序的程序启动时相同，即它指向程序之前的 PSP 256 字节。

[编辑：![DOS程序结构图解，使用<code>debug</code>](../Images/1b656964c276c939a199908c76dfc2b0.png)

历史注释：在 CP/M 上，退出程序有 3 种方式：

*   调用 BDOS 函数 0（相当于 INT 21 AH=00h，DOS 函数 0）
*   跳转到 0000h 处的 WBOOTF 位置（相当于 PSP 偏移 000h）
*   返回

WBOOTF 位置由 3 个字节组成：1 个字节用于跳转，2 个字节用于跳转目标（BDOS 中的 WBOOT 函数）。

在 CP/M 的早期版本中，调用 BDOS 函数 0 或跳转到 WBOOT 会导致部分 CP/M 从磁盘重新加载（热启动），并且随后运行一些 OS 初始化；而 RETurning 则直接返回到 CCP（Console Command Processor，相当于 COMMAND.COM），然后提示输入下一个命令行。AFAIU, CP/M 3 通常加载到 ROM 中，然后返回到 WBOOT 位置，导致从 ROM 重新加载部分操作系统。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-25T22:00:35.637

后面的 int 0x21 允许您指定返回码。

返回码放在寄存器 AL 中。

[http://spike.scu.edu.au/~barry/interrupts.html#ah4c](http://spike.scu.edu.au/~barry/interrupts.html#ah4c)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-22T22:55:19.167

这是我所知道的。

```
MOV AH, 0x4C
INT 0x21 
```

结束正在运行的EXE文件，EXE文件必须这样结束，因为codesegment寄存器CS。如果我错了，请纠正我，但如果你以这种方式结束 COM 文件，你会得到意想不到的结果（崩溃、挂起、重新启动等）。所以

```
INT 0x20 
```

结束一个 COM 文件。

CS 与 COM 程序在程序启动时相同，即指向程序之前的 PSP 256 字节。（CodeSegment InstructionPointer CS:IP, CS 包含代码段）。是的，我们正在谈论寄存器，变量它们就像一个橱柜，我的工作就像你可以把东西正确地放在抽屉里一样。AX=0000 BX=0000 CX=0000（CX由CL和CH组成）等。

我认为 COM 文件通常总是限制为 64K。我认为的第二个原因是 COM 文件没有数据段，它们确实有数据，但它与代码位于同一段中。我以为他们除了 CODE 没有任何段，COM 文件中的所有数据都存储在 64K 内。EXE 文件确实有一个段，某些 EXE 文件在使用正确的内存模型时可以有更多的段 (CS:IP)（请参阅英特尔内存模型）。

*   微小的* `CS=DS=SS`
*   小的 `DS=SS`
*   中 `DS=SS`,多个代码段
*   紧凑的单个代码段，多个数据段
*   大型多个代码和数据段
*   巨大的多个代码和数据段；单个数组可能 >64 KB

使用内存模型 SMALL 的 EXE 文件有 64K 的限制。当使用更大的内存模型和远 32 位指针时，您可以寻址超过 64K（仍然有限）。我认为这就是“诀​​窍”。

现在每个人都在抱怨我为什么要使用 EXE 文件。以上是原因。内存模型来自维基百科。对于那些不在乎的人，我从专业人士那里学到了这一点。彼得诺顿和约翰索查。来自 Norton Utilities（The Norton Commander for DOS 背后的人）。他有一本关于组装的书，例如“IBM-PC 的组装”。你应该读它，他解释得最好。他对我来说就像一个好老师。Microsoft CodeView 澄清了我很多。在 DOS C 中编程？Turbo C 2.0 是你能得到的最好的。哦，我不再编程了。

# c# - 在 C# 中，哪个更好/更快？列表列表或数组数组（锯齿状数组）？

> ID：12591681
> 
> 赞同：0
> 
> 时间：2012-09-25T21:56:51.070
> 
> 标签：c#, arrays, list

我纯粹出于好奇而问这个问题。我没有任何实际的代码可以思考。

是否存在使用锯齿状数组而不是列表列表的最佳情况，反之亦然？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:00:05.963

a`List<T>` **是**一个数组，只是 a 包装在一个类中，因此它可以随意重新分配和调整大小。因此，否则两者之间的性能可以认为是相同的 - 仅`List<List<T>>`在需要调整任一维度的大小时使用 - 不要忘记，无论何时调整第 0 维度的大小，都需要在第 1 维度中构建新实例，这可能会很昂贵。

您忘记了 n 维数组（即`T[,]`）。然而，由于 .NET 边界检查的一个怪癖，这些实际上比锯齿状数组或一维用户管理的数组要慢，这完全是个谜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:03:57.773

锯齿状数组和列表列表与普通列表和数组具有相同的相对优点：

a 的主要优点`List<T>`是你可以扩大和缩小它。然而，它可能会在内存中占用大量额外空间，因为它通常会在其后备存储中保留一堆额外空间，这样它就不必在每次增长时重新分配一个新数组。

数组的主要优点是它很紧凑——它有足够的空间来存储其中的元素数量，仅此而已。但它的大小是静态的；如果您需要向其中添加新项目，则必须替换现有项目或手动创建更大的数组并将数据复制到其中。

就速度而言，在任何实际范围内，它们的行为都应该相同。 `List<T>`使用数组作为其后备存储，因此由于额外的间接层，它*可能*比等效数组稍慢。但我不会假设如果没有仔细测量 - 它是否以及在多大程度上会随着框架或 CLR 的不同版本而改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T22:09:37.627

我会说 a`List<T>`更灵活，而 as`T[]`更具互操作性。例如，如果我想构建一个未知大小的列表，我会使用`List<T>`. 如果我从 Web 服务返回列表，我会使用`T[]`.

我知道我在这里指的是单维列表，但同样的做法也适用于多维。

# python - Python Shell - 浮点减法中的“附加”

> ID：12591683
> 
> 赞同：2
> 
> 时间：2012-09-25T21:57:04.297
> 
> 标签：python, shell, floating-point, subtraction

> **可能重复：**
> [浮点限制](https://stackoverflow.com/questions/406361/floating-point-limitations)

在这里使用 Python 2.7。

有人可以解释为什么会在 shell 中发生这种情况吗？

```
>>> 5.2-5.0
0.20000000000000018 
```

搜索产生了关于不同比例的数字没有产生正确结果的东西（一个非常小的数字和一个非常大的数字），但这似乎很笼统，考虑到我使用的数字是相同的比例，我不认为这就是为什么会发生这种情况。

编辑：我想我没有定义“发生的事情”我的意思是它返回 0.2 ... 018 而不是简单地导致 0.2。我得到了打印轮次，并删除了代码片段中的打印部分，因为这具有误导性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T22:06:05.647

您需要了解 5.2-5.0 确实是 0.20000000000000018，而不是 0.2。对此的标准解释可在[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)中找到。

如果您不想阅读所有这些内容，只需接受 5.2、5.0 和 0.20000000000000018 都只是近似值，只要计算机可以接近您真正采用的数字即可。

Python 有一些技巧可以让你不知道每个计算机科学家都应该知道什么，但仍然可以侥幸逃脱。主要技巧是`str(f)`——也就是说，浮点数的人类可读格式——被截断为 12 位有效数字，因此`str(5.2-5.0)`is `"0.2"`， not `"0.20000000000000018"`。但有时你需要你能得到的所有精度，所以`repr(f)`——即机器可读的再现——不会被截断`repr(5.2-5.0)`，`"0.20000000000000018"`.

现在唯一需要了解的是解释器 shell 的作用。正如 Ashwini Chaudhary 解释的那样，仅评估 shell 中的某些内容会打印出它的`repr`，而`print`语句会打印出它的`str`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T21:59:57.680

外壳使用`repr()`：

```
In [1]: print repr(5.2-5.0)
0.20000000000000018

In [2]: print str(5.2-5.0)
0.2

In [3]: print 5.2-5.0
0.2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T21:58:51.837

的默认实现`float.__str__`仅将输出限制为 12 位。

因此，最低有效数字被删除，剩下的是值 0.2。

要打印更多数字（如果可用），请使用[字符串格式](http://docs.python.org/library/stdtypes.html#string-formatting)：

```
print '%f' % result  # prints 0.200000 
```

默认为 6 位，但您可以指定更高的精度：

```
print '%.16f' % result  # prints 0.2000000000000002 
```

或者，python 也提供了一种更新的[字符串格式化方法](http://docs.python.org/library/string.html#formatstrings)：

```
print '{0:.16f}'.format(result)  # prints 0.2000000000000002 
```

为什么python首先产生“不精确”的结果与[浮点运算](http://floating-point-gui.de/basic/)的不精确性质有关。如果您需要更可预测的精度，请改用该[`decimal`模块：](http://docs.python.org/library/decimal.html)

```
>>> from decimal import *
>>> getcontext().prec = 1
>>> Decimal(5.2) - Decimal(5.0)
Decimal('0.2') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T22:04:13.940

Python 有两种将对象转换为字符串的方法，即`__str__`和`__repr__`方法。`__str__`是一个正常的字符串输出，由`print`;使用 `__repr__`旨在提供更准确的表示，并且是在您不使用时显示`print`的内容，或者当您打印列表或字典的内容时。 `__str__`舍入浮点值。

至于为什么减法的实际结果是0.20000000000000018而不是0.2，这与浮点的内部表示有关。不可能准确地表示 5.2，因为它是一个无限重复的二进制数。您可以到达的最接近的大约是 5.20000000000000018。

# jquery - Ajax 在 opencart 中不起作用

> ID：12591685
> 
> 赞同：0
> 
> 时间：2012-09-25T21:57:11.443
> 
> 标签：jquery, opencart

我想使用 ajax 来检索数据。我已经在下面发布了我正在使用的代码。但它不工作。我收到了第一个警报，但我没有收到 $.ajax 部分中的警报。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script>
    $(document).ready(function() {
     $("#submit").click(function(){ 
     var dd=document.getElementById("url").value;
        alert("hi");

$.ajax({
    type:'POST',
    url:'test.php?webinarid='+dd,
    success:function(data){
    alert("hi");
}

}); 

     })
      });  
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:03:16.280

尝试添加错误事件处理程序以验证它没有成功返回并查看返回的内容：

```
$.ajax({
    type:'POST',
    url:'test.php?webinarid='+dd,
    success:function(data){
    alert("hi");
    },
    error:function(data){
    alert("error: " + data);
   }
}); 
```

您也可以使用诸如 firebug 之类的东西来查看发送的内容和返回的内容

您还应该通过在浏览器中打开来直接测试 ajax 目标

domain.com/test.php?webinarid=01 或任何您关心的 ID

# php - 如何按特定顺序按值对数组进行排序？

> ID：12591687
> 
> 赞同：-1
> 
> 时间：2012-09-25T21:57:31.847
> 
> 标签：php, arrays

给定一个任意大小的数组（从 1 到 4 轮），其等级编号从 1 到 8（或更多），我如何获取该数组并对其进行括号样式排序，所以等级 1 是第一，等级 2 是最后，然后是等级8是下一个，然后排名7是倒数第二个......就像

然后下一轮..

1、4、3、2

我正在尝试对锦标赛括号进行排序，但在排序排名时运气不佳，而且以一种可以很好地扩展的方式，因此显示不会中断。

**编辑**：

一些澄清，每个括号大小需要分解如下：

如果括号有 8 场比赛，则比赛编号为 1 到 8，因此该轮需要自行安排如下：

*   游戏 1
*   第 8 场比赛
*   游戏 5
*   游戏 4
*   游戏 6
*   游戏 3
*   游戏 7
*   游戏 2

那么，在下一轮，它有 4 场比赛，结果如下：

*   游戏 1
*   游戏 4
*   游戏 3
*   游戏 2

等等：

*   游戏 1
*   游戏 2

最后，

*   游戏 1

如果起始组有 16 场比赛而不是 8 场、32 场或更多，它也需要工作。这个想法是第一场比赛和第八场比赛的获胜者在下一轮的第一场比赛中互相比赛。第一局和第二局始终是每个支架上的第一局和最后一场。然后它向内工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:17:44.360

这不是对列表进行排序。除非您真的需要对列表进行排序，否则索引可能会更快、更有效。

比赛将设置为`(current_rank), (total ranks) - (current_rank) + 1`

由于有8个等级，

```
1, 8 -1 +1 = 8
2, 8 -2 +1 = 7
3, 8 -3 +1 = 6
4, 8 -4 +1 = 5 
```

所以代码看起来*像*

```
<?php
    $rankscount = count($ranks);
    for ($i = 1; $i <= $rankscount / 2; $i++) {
        echo "matchup will be: rank " . $i . " , rank " . $rankscount - $i + 1;
    }
?> 
```

在每一轮之后，用新的排序列表重新设置函数，你会得到 1vs4。2对3。

我不是 PHP 的专业人士，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:18:30.143

以下函数将 的数组排序`['r1', 'r2', 'r3', 'r4', 'r5', 'r6', 'r7', 'r8']`为 的顺序`['r1', 'r8', 'r2', 'r7', 'r3', 'r6', 'r4', 'r5']`。一个数组`['r1', 'r2', 'r3', 'r4']`将被重新排列成`['r1', 'r4', 'r2', 'r3']`

```
function rearranged($array) {
    sort($array);
    $result = array();
    $length = count($array);
    $offset = 0;
    // Handling two elements at once, therefore just do $lenght/2 iterations
    for ($i = 0; $i < $length/2; $i++) {
        // $i + $offset: The current element in the original array 
        // + the offset of fields already filled in the results array
        $result[$i + $offset] = $array[$i];
        // $i + 1 + $offset: The next element in the results array
        $result[$i + 1 + $offset] = $array[$length - $i -1];
            // Increment offset
        $offset++;
    }
    return $result;
} 
```

我没有使用任何内置`sort`函数，因为它们将所有键相互比较，假设您的数组已经是为了迭代和交换位置应该更快。如果键没有排序，您可以调用内置`sort`函数，例如`sort`（按值排序）或`ksort`（按键排序）。

还要注意的是，此功能仅适用于`arrays`偶数数量的元素。如果元素的数量不均匀，则将从结果数组中删除最后一个元素。

# html - 宽度 100% 不与 Margin-Right 混合

> ID：12591688
> 
> 赞同：1
> 
> 时间：2012-09-25T21:57:40.433
> 
> 标签：html, css, overflow, margins, multiple-columns

我已经搜索了几个小时并尝试了我找到的所有内容，但没有任何帮助，所以就这样吧。我正在尝试建立一个网站，其左列和右列的宽度均为 200 像素，而中间列占用剩余空间。我注意到 margin-right 被完全忽略了。我测试了溢出，但这似乎也不起作用。当然，我可能做错了溢出位。无论如何，这是我的测试站点、相关的 CSS 和 HTML。

中间列的当前背景在缩放方面做得不好，所以我可能会将它换成其他东西。

网站： http: [//mnslayer27.webs.com/bgtest.html](http://mnslayer27.webs.com/bgtest.html)

```
HTML:
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Mnslayer27</title>
    <link rel="stylesheet" type="text/css" href="Mnslayer27.css" />
        <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
</head>
<body>

  <iframe src="Main_Links.html" id="ml" frameborder="0" width="100%" height="1808"></iframe>

<div id="left">
  <div id="right">
    <div id="column2">
      <div class="transbox"></div>
      <div class="transtext">
        <h1>Text~</h1><br />
      </div>
       sdtfghujikjuhygtfrdsfghjklhkgjhfdsdfghkn
    </div>
  </div>
</div>

<div id="column3">
  <h3>Pictures</h3>
  <div id="pics">
    <img src="http://i195.photobucket.com/albums/z255/yukina17/letter%20r/rave%20master/Elie.jpg" border="0" width="100%" alt="Elie" title="Elie"></img><br /><br /><br />
    <img src="http://mnslayer27.webs.com/Sasuke%20Eternal%20Mangekyou.gif" border="0" width="100%" alt="Sasuke's Eternal Mangekyou Sharingan" title="Sasuke's Eternal Mangekyou Sharingan"></img>
    <center><img src="http://mnslayer27.webs.com/Torch.gif" border="0" width="50%" alt="Torch" title="Torch"></img></center><br /><br />
  </div>
</div>

CSS:
#left {
  //overflow:hidden;
  margin-left: 200px;
}

#right {
  margin-right:200px;
}

div.transbox  {
   width:100%;
  //width:auto;
  height:180px;
  margin:0px 0px;
  background-color:#ffffff;
  border:none;
  opacity:0.6;
  filter:alpha(opacity=60); /* For IE8 and earlier */
}

#column2 {
        position: absolute;
        top: 120px;
        //left: 200px;
        overflow:hidden;
    color: #000000;
    float:left;
    width: 100%;
        height: 1688px;
        //margin-left: 200px;
        //margin-right: 200px;
        border: none;
        background-image: url("http://i246.photobucket.com/albums/gg106/mnslayer27/Ren-Winamp2.jpg");
    background-repeat: repeat-y;
    background-attachment: scroll;
    background-position: 0% 0%;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:28:52.633

You can try using absolute position and specify the left and right for the divs instead of using width.

```
#left {
    position: absolute;
    left: 0px;
    width: 100px;  
    height: 100%;
    background-color: #d0c0c0;
}

#right
{
    position: absolute;
    right: 0px;            
    width: 100px;
    height: 100%;
    background-color: #d0c0c0;
}

#centre
{
    position: absolute;
    left: 100px;
    right: 100px;
    height: 100%;
    overflow:hidden;
    background-color: #a0a0d0;

    border: solid 2px black;
    margin: 4px;
    padding: 4px;
} 
```

This also has the advantage that any added margin,border or padding do not extend the divs making the whole become wider than the 100% of the page.

Heres a simple [JSFiddle](http://jsfiddle.net/wUeUn/)

hope that helps

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T15:24:21.763

如果您将您的设置`div`为`display: inline-block;`而不是`display: block;`，它可能会解决您遇到的问题。请注意，这可能会在您的代码中产生其他后果。不过，我会使用涉及的解决方案`position: absolute;`，因为当您有其他元素与之/彼此交互时，这可能会变得混乱。

我确定有一种方法涉及，`box-sizing: border-box;`但我现在似乎无法解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:17:41.363

看看我[在这里](https://stackoverflow.com/questions/12433230/fixed-left-and-right-columns-liquid-middle-unable-to-span-entire-page/12433311#12433311)的回答，它帮助了有同样问题的人。包括一个 JSFiddle

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-25T22:24:14.557

根据您的问题，您希望最终产品看起来像什么并不积极，但根据您的三栏方法并试图让您的边距正常工作，尝试浮动所有三栏，就像这样

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Mnslayer27</title>
    <link rel="stylesheet" type="text/css" href="Mnslayer27.css" />
        <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
        <style>

div.transbox  {
   width:100%;
  //width:auto;
  height:180px;
  margin:0px 0px;
  background-color:#ffffff;
  border:none;
  opacity:0.6;
  filter:alpha(opacity=60); /* For IE8 and earlier */
}

.column1
{
    float: left;
    width: 200px;
    margin: 0 100px 0 100px;
}

#column2 {

    color: #000000;
    float:left;

        border: none;
        background-image: url("http://i246.photobucket.com/albums/gg106/mnslayer27/Ren-Winamp2.jpg");
    background-repeat: repeat-y;
    background-attachment: scroll;

}
#column3
{
    float: right;
    width: 200px;
}

        </style>
</head>
<body>

<div class="column1">   
  <iframe src="Main_Links.html" id="ml" frameborder="0" width="100%" height="1808"></iframe>
</div>

    <div id="column2">
      <div class="transbox"></div>
      <div class="transtext">
        <h1>Text~</h1><br />
      </div>
       sdtfghujikjuhygtfrdsfghjklhkgjhfdsdfghkn
    </div>

<div id="column3">
  <h3>Pictures</h3>
  <div id="pics">
    <img src="http://i195.photobucket.com/albums/z255/yukina17/letter%20r/rave%20master/Elie.jpg" border="0" width="100%" alt="Elie" title="Elie"></img><br /><br /><br />
    <img src="http://mnslayer27.webs.com/Sasuke%20Eternal%20Mangekyou.gif" border="0"  alt="Sasuke's Eternal Mangekyou Sharingan" title="Sasuke's Eternal Mangekyou Sharingan"></img>
    <center><img src="http://mnslayer27.webs.com/Torch.gif" border="0"alt="Torch" title="Torch"></img></center><br /><br />
  </div>
</div> 
```

# sql - SQL SP 迭代算法

> ID：12591695
> 
> 赞同：0
> 
> 时间：2012-09-25T21:58:24.970
> 
> 标签：sql

我的存储过程需要一点帮助。

我想遍历结果中的一组列并获取每个值并查找相应的值，然后将所有这些加在一起。

我能看到的唯一方法是为每周位置和每周分数使用单独的变量加上单独的选择语句。谁能帮我？这显然不利于可扩展性。

存储过程

> ```
>  @pName varchar(50) = ''
> AS
> BEGIN
> 
>   Declare @p1 int = 0
>   Declare @p2 int = 0
>   Declare @s1 int = 0
>   Declare @s2 int = 0
>   Declare @pUserID int = 0
>   Declare @pTotal int = 0
> 
>   set @pUserID = (Select UserID from PKR_USERS where UserName = @pName)
> 
>   set @p1 = (Select WEEK1POS From PKR_TOURNAMENT12)
>   set @p2 = (Select WEEK2POS From PKR_TOURNAMENT12)
> 
>   set @s1  = (Select Points from PKR_SCORING where Position = @p1)
>   set @s2  = (Select Points from PKR_SCORING where Position = @p2)
> 
>   set @pTotal = @s1 + @s2
> 
>   Update PKR_RESULTS set points = @pTotal Where UserID =  @pUserID
> END 
> ```

```
> PKR_Tournament12 Table 
> 
> [USERID][WEEK1POS][WEEK2POS] 1    1   1 
```

> PKR_评分表
> 
> [位置][积分] 1 10 2 9

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T00:56:02.917

嗨试试这个我用过 UNPIVOT 请测试一下

```
Declare @pTotal int = ISNULL(
  SELECT SUM(ISNULL(Points)) FROM PKR_SCORING where Position  IN (
   SELECT FieldValue
FROM
(
  SELECT 
     WEEK1POS ,
     WEEK2POS 
  FROM dbo.PKR_TOURNAMENT12 WHERE USERID=(Select UserID from PKR_USERS where UserName = @pName)
) MyTable
 UNPIVOT
(FieldValue FOR FieldCode IN (WEEK1POS, WEEK2POS))AS MyUnPivot),0)
Update PKR_RESULTS set points = @pTotal Where UserID =  @pUserID 
```

# reporting-services - 编写一个表达式来检查组中的任何值是否为假

> ID：12591696
> 
> 赞同：2
> 
> 时间：2012-09-25T21:58:25.500
> 
> 标签：reporting-services, ssrs-2008, ssrs-grouping

想要在 SSRS 2008 文本框中编写表达式以检查组中字段中的任何值是否为假。如果 false 停止并更改文本框的背景颜色。

我正在尝试做

```
 =iif(field!coloumnname.value="False","Red","silver") 
```

上面的表达式取组中最高的值并给出输出。

我的意思是，如果值为 True ，它会给出银色背景。谁能帮我吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-22T11:46:54.533

只需在组级背景属性中使用 min 函数：

```
=iif(min(Fields!Value.Value, "GroupName") = "False", "Red", "Silver") 
```

这应该为您提供所需的功能。

# vb.net - dockstyle 填充面板在顶部/底部停靠面板后面滑动

> ID：12591700
> 
> 赞同：3
> 
> 时间：2012-09-25T21:58:39.640
> 
> 标签：vb.net, visual-studio-2010

我有一个表格。它有一个停靠在顶部的面板和一个停靠在底部的面板。表格的其余部分是中间的一个面板。我希望它扩展以填充表单的其余部分，因此我将这个中心面板的停靠样式设置为 FILL。当我在视觉上这样做时，没有任何东西跳动，但我的调整大小的装饰器在我的顶部和底部停靠面板后面向上/向下移动。现在我调整大小的装饰器与基本形式的大小相同。

我究竟做错了什么？我的中间面板表现得好像它不理解表单上的顶部和底部停靠面板建立的边界。它只是延伸到我认为应该停止的地方。

![这个问题的图片](../Images/ed45d465c676e48f5520c8d7d423962a.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T22:23:03.687

尝试单击与其他面板重叠的中间面板以选择它，然后右键单击它并`Bring To Front`从上下文菜单中选择以解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T02:21:02.807

我建议您使用 a `TableLayoutPanel`，一列三行。将所有面板的 Anchor 属性设置为 LEFT+RIGHT+TOP+BOTTOM，然后根据需要设置行高。顶部和底部固定，中间为“100%”。

# c# - 应用程序如何在不需要端口转发的情况下连接到服务器？

> ID：12591701
> 
> 赞同：5
> 
> 时间：2012-09-25T21:58:48.913
> 
> 标签：c#, sockets, networking, udp

我刚刚创建了一个简单的聊天客户端，它仅在所有客户端/服务器都在同一端口上进行端口转发时才有效。

我如何使我的应用程序（它在 c# 中并使用 .net 套接字 btw）在不需要客户端端口转发的情况下工作（我不关心服务器是否需要端口转发）。

顺便说一句，它使用udp。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T22:07:37.277

我相信你把你的问题命名错了。您是在谈论连接到客户端的服务器，对吗？

如果您直接使用套接字，简短的回答是 - 您不能。长答案是客户端必须以客户端端口保持打开的方式向服务器注册，以便服务器可以访问它。

与其自己编写这个，不如考虑一个专注于此的库，例如[SignalR](http://signalr.net/)。

此外 - 无论如何，UDP 对于聊天客户端来说都是一个糟糕的选择。有很多关于 UDP 数据包的笑话，但请相信我——你不会全都明白的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:03:12.327

如果两个端点之间有 NAT 和/或防火墙，则该硬件决定两个端点是否可以通信，而不是您的程序。

但是，NAT 和防火墙规则经常允许端口 80 和其他小于 1024 的端口入站。通常，可以到达任何出站端口。您可以利用它来最大程度地减少网络拓扑阻塞通信的可能性。事实上，如果您查看 Skype 的“高级/连接”选项卡，您可以看到有一个复选框指示 Skype 是否可以使用端口 80 和 443 进行传入连接（此设置有时会干扰开发人员计算机上的 Web 服务器。. .)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:11:11.947

您需要所有客户端都连接到的中间某处的服务器。您不能让 nat 框后面的 1 个客户端连接到 nat 框后面的另一个客户端。他们都需要连接到服务器并保持该连接打开。然后，客户端 A 向服务器发送一条消息，服务器将消息转发到客户端 B。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T10:32:35.090

如果您想通过 NAT 路由器进行通信，您可以在应用程序中使用 UPnP 设置端口转发。这就是例如 torrent 程序无需您设置端口转发即可进行通信的方式。

在 .net 中，您可以使用[NATUPnP 1.0 类型库](http://msdn.microsoft.com/en-us/library/aa366276%28VS.85%29.aspx)(NATUPNP.DLL) COM 组件，它是 Windows 的一部分（自 Windows XP 起）。

**添加对 com 组件的引用**

![添加com组件](../Images/919d0fe666c9acc4a0115c1725631670.png)

**获取所有现有端口映射的列表**

```
NATUPNPLib.UPnPNATClass upnpnat = new NATUPNPLib.UPnPNATClass();
NATUPNPLib.IStaticPortMappingCollection mappings = upnpnat.StaticPortMappingCollection; 
```

**遍历所有映射**

```
foreach(NATUPNPLib.IStaticPortMapping portMapping in mappings)
{
    // do something with the port mapping, such as displaying it in a listbox
} 
```

**添加新的端口映射**

```
// Here's an example of opening up TCP Port 80 to forward to a specific Computer on the Private Network
mappings.Add(80, "TCP", 80, "192.168.1.100", true, "Local Web Server");

// Here's an example of forwarding the UDP traffic of Internet Port 80 to Port 8080 on a Computer on the Private Network
mappings.Add(80, "UDP", 8080, "192.168.1.100", true, "Local Web Server"); 
```

**移除端口映射**

```
// Remove TCP forwarding for Port 80
mappings.Remove(80, "TCP");

// Remove UDP forwarding for Port 8080
mappings.Remove(8080, "UDP"); 
```

* * *

资料来源：[http://pietschsoft.com/...](http://pietschsoft.com/post/2009/02/05/NET-Framework-Communicate-through-NAT-Router-via-UPnP.aspx)

# ruby-on-rails - RoR Heroku 的厨师食谱

> ID：12591704
> 
> 赞同：2
> 
> 时间：2012-09-25T21:59:02.577
> 
> 标签：ruby-on-rails, heroku, chef-infra, vagrant

是否有厨师食谱或食谱可以在 vagrant lucid32（或 64）上创建类似于 Ruby on Rails heroku 的堆栈。

我已经尝试过[vagrant-heroku](https://github.com/ejholmes/vagrant-heroku)盒子，但它似乎并没有完全准备好，而且感觉有点错误*。我想知道它是否会以其他方式更有效地完成。

关于如何构建这样的堆栈的有据可查的指南也可以。[这个人](http://blog.bloc.io/a-better-way-to-set-up-rails-on-windows)非常接近，但错过了所有 PostgreSQL 部分和版本细节。

*免责声明：我是一个新手，“有点错误”我的意思是它不像我预期的那么简单*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-16T04:31:09.727

我会看看Dokku。据我所知，这是最接近推出自己的 Heroku 的方法。

[https://github.com/progrium/dokku](https://github.com/progrium/dokku)

# r - 从非对称矩阵（或数据帧）到 R 的对称方阵

> ID：12591708
> 
> 赞同：2
> 
> 时间：2012-09-25T21:59:20.983
> 
> 标签：r, dataframe, symmetric

给定这个data.frame：'sample'，它代表物种之间的成对得失：

```
 sp1<-c(0,1,0)
     sp3<-c(1,2,2)
     sp5<-c(3,1,0)
     sample<-as.data.frame(cbind(sp1,sp3,sp5))
     rownames(sample)<-c("sp1","sp6","sp8") 
```

应该是这样的：

```
 sp1 sp3 sp5
sp1   0   1   3
sp6   1   2   1
sp8   0   2   0 
```

如何修改“样本”，使其具有与行名相同的列名，反之亦然，并用零填充添加的列或行，以使数据框对称，如下所示？（我更喜欢数据框，因为我怕我不擅长矩阵）：

```
 sp1 sp3 sp5 sp6 sp8
sp1   0   1   3   0   0
sp3   0   0   0   0   0
sp5   0   0   0   0   0
sp6   1   2   1   0   0
sp8   0   1   0   0   0 
```

真实数据大约有 150 行和列，所以我真的不想用 excel 手动完成。这种格式需要应用一些有关竞争物种相互作用结果的其他功能（列：获胜，行：损失）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T16:39:32.790

您显示的输出似乎不是*对称*矩阵，但如果所需的输出是您正在寻找的，这是您可以通过使用`stack`and获得它的一种方法`xtabs`。制作“方形”矩阵的关键是确保行名和列名被“分解”。

```
## Extract and sort the unique combination of row and column names.
## This will be used when creating our factors.
NAMES <- sort(unique(c(rownames(sample), colnames(sample))))
## "stack" your data.frame, reintroducing the rownames
##   which get dropped in the stacking process
temp <- data.frame(rows = rownames(sample), stack(sample))
## Your stacked data looks like this:
temp
#   rows values ind
# 1  sp1      0 sp1
# 2  sp6      1 sp1
# 3  sp8      0 sp1
# 4  sp1      1 sp3
# 5  sp6      2 sp3
# 6  sp8      2 sp3
# 7  sp1      3 sp5
# 8  sp6      1 sp5
# 9  sp8      0 sp5

## Factor the row and column names
temp$rows <- factor(temp$rows, NAMES)
temp$ind <- factor(temp$ind, NAMES)

## Use xtabs to get your desired output. Wrap it in
##    as.data.frame.matrix to get a data.frame as output
as.data.frame.matrix(xtabs(values ~ rows + ind, temp))
#     sp1 sp3 sp5 sp6 sp8
# sp1   0   1   3   0   0
# sp3   0   0   0   0   0
# sp5   0   0   0   0   0
# sp6   1   2   1   0   0
# sp8   0   2   0   0   0 
```

# postgresql - 为什么当我尝试删除约束时 PostgreSQL 说约束不存在？

> ID：12591710
> 
> 赞同：13
> 
> 时间：2012-09-25T21:59:32.080
> 
> 标签：postgresql

我正在使用 PostgreSQL 9.1。

在 psql 中，我使用此查询来发现我在某个数据库中的约束...

```
SELECT
  *
FROM
  information_schema.constraint_table_usage
WHERE
  constraint_table_usage.table_catalog = 'journal_app_development'
AND
  constraint_table_usage.constraint_name NOT LIKE '%_pkey'; 
```

输出...

```
 table_catalog      | table_schema | table_name |   constraint_catalog    | constraint_schema | constraint_name 
  -------------------------+--------------+------------+-------------------------+-------------------+-----------------
   journal_app_development | public       | users      | journal_app_development | public            | fk_entry_user
   journal_app_development | public       | users      | journal_app_development | public            | fk_user_task
  (2 rows) 
```

但是当我尝试放弃约束时，我得到一个错误......

```
# ALTER TABLE users DROP CONSTRAINT "fk_entry_user";
ERROR:  constraint "fk_entry_user" of relation "users" does not exist 
```

知道我做错了什么吗？

* * *

## 背景信息/动机

我这样做的原因是我想编写一个脚本（特别是一个 Rake 任务），它将删除数据库中不是主键的约束。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-25T22:49:21.077

尝试查看表格：

```
information_schema.table_constraints 
```

其中`constraint_type`列 <> '主键'。我相信这应该给你关系的另一面。

我相信您正试图从引用的表中删除约束，而不是拥有它的表。

# ios - Mach O Link Error-链接器命令失败，退出代码为 1（使用 -v 查看调用）

> ID：12591711
> 
> 赞同：6
> 
> 时间：2012-09-25T21:59:40.490
> 
> 标签：ios, twitter, archive

当我尝试在 Xcode（4.5 版）中为我的应用程序构建归档时，我收到一条错误消息：

```
ld: file is universal (3 slices) but does not contain a(n) armv7s slice: /Users/[myrealname]/Downloads/[myappname]/BT_Objects/TwitterOAuth/SAOAuthTwitterEngine/libOAuth.a for architecture armv7s 
```

clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）然后在它下面说：

```
(null): File is universal (3 slices) but does not contain a(n) armv7s slice: /Users/shakerite/Downloads/shakeritetestnotrealone_v15_iOS/BT_Objects/TwitterOAuth/SAOAuthTwitterEngine/libOAuth.a for architecture armv7s 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-25T22:47:12.693

就在前几天，我在模拟器上多次成功尝试后尝试在 iPad 上运行我的应用程序时，收到了一条非常相似的消息。我发现在构建设置下，我必须将“仅构建活动架构”设置为是。然后我的应用程序将在我的设备上编译。希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T22:29:45.730

是的，我有同样的问题。在 xcode 中单击您的项目。然后，点击目标。转到构建设置并寻找有效的架构。从有效架构列表中删除 armv7s，然后离开 armv7。

如果您有任何问题，请告诉我！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T10:59:45.877

在这里，我为您提供一个可以解决此错误的临时解决方案，希望对您有所帮助，

> 转到项目->构建设置->仅构建活动架构->是

就是这样。

# ios - 为什么我的子类 NSManagedObject 没有响应 MOC 的保存方法中使用的某些命令？

> ID：12591718
> 
> 赞同：1
> 
> 时间：2012-09-25T22:00:09.037
> 
> 标签：ios, xcode, core-data

我最初认为这是一个面向多线程的崩溃，所以我使用 MOC 的 performBlock 和 performBlockAndWait 方法将所有实际的核心数据工作转移到了主线程。

所做的只是将崩溃从我合并的地方移到我称之为“保存”的地方。

在这一点上，我什至不知道从哪里开始检查错误。

这不是多线程——所有核心数据工作都被导出到主线程。

我重新创建了所有子类，因此（理论上）它不应该是子类与其所代表的实体之间的不匹配。

更烦人的是，除了现在在主块上执行之外，我用来更新核心数据模型的代码在几个版本中都没有改变，这表明我的代码深处存在某种严重的缺陷，而且没有任何线索它在哪里或如何找到它。

任何可以帮助我追踪此崩溃的信息或建议将不胜感激。

```
CoreData: error: Serious application error.  Exception was caught during Core Data change processing.  This is usually a bug within an observer of NSManagedObjectContextObjectsDidChangeNotification.  NSManagedObjects of entity 'AdBlock' do not support -mutableSetValueForKey: for the property 'currentlyValidAds' with userInfo (null)

2012-09-25 14:50:13.250 CoreApp[1173:fb03] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'NSManagedObjects of entity 'AdBlock' do not support -mutableSetValueForKey: for the property 'currentlyValidAds'' 
```

AdBlock 与 Advertisement 类具有多对多、可选、有序、瞬态关系“currentValidAds”。作为对评论的回应，我检查了反向关系，这是一对一的、可选的瞬态关系。（我现在已将其更新为多对多、选项、有序、瞬态关系，但错误仍然存​​在）。

根据要求，生成的代码：

AdBlock.h：

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class Advertisement;

@interface AdBlock : NSManagedObject

@property (nonatomic, retain) NSNumber * adIndex;
@property (nonatomic, retain) NSNumber * block_id;
@property (nonatomic, retain) NSNumber * seedBlock;
@property (nonatomic, retain) NSSet *ads;
@property (nonatomic, retain) NSOrderedSet *currentlyValidAds;
@end

@interface AdBlock (CoreDataGeneratedAccessors)

- (void)addAdsObject:(Advertisement *)value;
- (void)removeAdsObject:(Advertisement *)value;
- (void)addAds:(NSSet *)values;
- (void)removeAds:(NSSet *)values;

- (void)insertObject:(Advertisement *)value inCurrentlyValidAdsAtIndex:(NSUInteger)idx;
- (void)removeObjectFromCurrentlyValidAdsAtIndex:(NSUInteger)idx;
- (void)insertCurrentlyValidAds:(NSArray *)value atIndexes:(NSIndexSet *)indexes;
- (void)removeCurrentlyValidAdsAtIndexes:(NSIndexSet *)indexes;
- (void)replaceObjectInCurrentlyValidAdsAtIndex:(NSUInteger)idx withObject:(Advertisement *)value;
- (void)replaceCurrentlyValidAdsAtIndexes:(NSIndexSet *)indexes withCurrentlyValidAds:(NSArray *)values;
- (void)addCurrentlyValidAdsObject:(Advertisement *)value;
- (void)removeCurrentlyValidAdsObject:(Advertisement *)value;
- (void)addCurrentlyValidAds:(NSOrderedSet *)values;
- (void)removeCurrentlyValidAds:(NSOrderedSet *)values;
@end

#import "AdBlock.h"
#import "Advertisement.h" 
```

AdBlock.m

```
@implementation AdBlock

@dynamic adIndex;
@dynamic block_id;
@dynamic seedBlock;
@dynamic ads;
@dynamic currentlyValidAds;

@end 
```

还有一个类别提供了一些逻辑——主要是更新当前有效的广告——但它没有在导致崩溃的代码块中使用，所以我不包括它。

编辑：

我还没有回答潜在的问题，但我*已经*通过手动将我删除的任何对象的瞬态值设置为 nil 来解决崩溃错误。不知道为什么这有帮助......只是由于睡眠不足而产生的一个随机想法。

# android - phonegap 是否可以访问 Android DownloadManager 类？

> ID：12591720
> 
> 赞同：1
> 
> 时间：2012-09-25T22:00:22.723
> 
> 标签：android, cordova, download-manager

我已经使用 phonegap 下载方法成功下载了一个文件。我正在将文件下载到我的安卓手机上下载文件夹中的本地存储。我想从下载管理器中收到文件已下载的某种通知，然后单击下载以查看。这就是 phonegap 下载方法所缺乏的。

phonegap 是否可以访问 Android DownloadManager 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-12T00:07:24.703

使用此插件访问 android DownloadManager

[https://github.com/sgrebnov/cordova-plugin-background-download](https://github.com/sgrebnov/cordova-plugin-background-download)

我在我的科尔多瓦应用程序中使用它，它工作正常。

可能需要在 java 代码中进行一些自定义才能完美运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T01:36:57.390

你肯定需要一个插件来从 phonegap 访问 android 的本机代码。

看看这个网站：[https ://github.com/phonegap/phonegap-plugins/tree/master/Android](https://github.com/phonegap/phonegap-plugins/tree/master/Android)

它充满了插件。其中之一称为“下载器”。也许这就是你正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T17:50:19.330

android 下载器插件效果很好。但是，如果您在 cordova 2.0 上运行，则需要修改代码以添加构造函数。当前代码是：

...

```
PhoneGap.addConstructor(function() {
    PhoneGap.addPlugin("downloader", new Downloader());
    PluginManager.addService("Downloader", "com.phonegap.plugins.downloader.Downloader");
}); 
```

由于 addPlugin 不再适用于 cordova 2.0，您需要删除 addConstructor 方法并将其替换为：

```
window.downloader = new Downloader(); 
```

而在 exec 方法上应该是这样的：

```
cordova.exec(win, fail, "Downloader", "downloadFile", [fileUrl, params]); 
```

而不是使用 Phonegap 对象。在我完成所有这些之后，插件就可以工作了。整个js应该是这样的：

```
function Downloader() {}

Downloader.prototype.downloadFile = function(fileUrl, params, win, fail) {

    //Make params hash optional.
    if (!fail) win = params;
cordova.exec(win, fail, "Downloader", "downloadFile", [fileUrl, params]);
};

window.downloader = new Downloader(); 
```

# sqlite - 在 NSDocument 包中包装大型 SQLite 数据库

> ID：12591727
> 
> 赞同：4
> 
> 时间：2012-09-25T22:01:44.480
> 
> 标签：sqlite, nsdocument

我正在编写一个基于 NSDocument 的应用程序，它有一个我希望在文档包中标记的 SQLite 数据库。它由一些表组成，每个表的架构是一个时间戳和一个值。这个数据库开始时很小，但随着时间的推移可能会增长到相当大的数量。该应用程序正在“在 NSDocument 背后”更新数据库。

到目前为止，我尝试做的是覆盖该`writeToURL:ofType:error:`方法，该方法可以传递一些复杂的 URL，例如：

> file://localhost/private/var/folders/mr/l1z6gdls0fb3t28m3z1bz6lw0000gn/T/TemporaryItems/(A%20Document%20Being%20Saved%20By%MyApp%2031)/Untitled.wsdoc

在这一点上，如果你愿意的话，我被迫使用内存数据库，然后将该数据库的全部内容吸收到 NSFileWrapper 中。它可以工作，但不能很好地扩展。如果数据库很大，比如 200-300MB 或更多（这不是这个应用程序的可能性范围），那么每次有人按下时都执行他的操作`Command`（`S`或者更糟糕的是，我打开了自动保存）可能是一项非常昂贵的操作。

所以我想知道：是否可以在 NSDocument 范围之外管理 SQLite 文件，同时仍将其驻留在文档包中，以便数据库在移动/复制时可以存在于包中？

# php - Symfony2 - 如何检查我们是否被移动设备调用

> ID：12591732
> 
> 赞同：10
> 
> 时间：2012-09-25T22:02:32.167
> 
> 标签：php, android, ios, symfony

使用 Symfony2，我需要检查控制器是从移动设备还是从桌面网络浏览器调用。

根据请求的来源，根据屏幕大小和条件渲染不同的树枝模板。

什么是这样做的好方法？我们在控制器中有什么来检查这个？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-06-24T13:24:58.693

我在 Symfony2 文档中找到了它，这是 symfony 的方式：

```
$request->headers->get('User-Agent') 
```

[访问请求数据](http://symfony.com/doc/current/components/http_foundation/introduction.html#accessing-request-data)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-27T15:06:04.747

改编自[http://detectmobilebrowsers.com/的脚本](http://detectmobilebrowsers.com/)

```
function isMobile(Request $request)
{
    $useragent = $request->headers->get('User-Agent');
    if (!$useragent) {
        return false;
    }

    return (
        preg_match('/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i', $useragent) ||
        preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i', substr($useragent,0,4))
    );
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-25T22:07:35.947

我确信 Symfony 也有一些包装命令来执行此操作，但是：

```
$_SERVER['HTTP_USER_AGENT'] 
```

将为您`user-agent`提供包含字符串“Android verNum”的字符串。

# php - PHP ImageMagick 图像的多种尺寸 - 无法正常工作

> ID：12591734
> 
> 赞同：0
> 
> 时间：2012-09-25T22:02:46.527
> 
> 标签：php, codeigniter, imagemagick, image-resizing

大家好 :) 提前感谢您对此问题的任何帮助。

我正在使用 CodeIgniter 并成功上传、旋转和调整图像大小。当我尝试为图像创建多种尺寸时，我有点迷失了。

这是我的代码：

```
// First I make two copies of the origional image - there is no problem here - these always work. I always have the successfully copied images.

                $Copy_Mid_Size_File = "Some_Path_For_The_Newly_Copied_Mid_Size_Image"

                if(!copy($source_image, $Copy_Mid_Size_File)){
                    echo "failed to copy $Copy_Mid_Size_File - Please contact the system administrator. \n";
                    die();
                }

                $Copy_Thumbnail_Size_File = "Some_Path_For_The_Newly_Copied_Thumbnail_Size_Image"

                if(!copy($source_image, $Copy_Thumbnail_Size_File)){
                    echo "failed to copy $Copy_Thumbnail_Size_File - Please contact the system administrator. \n";
                    die();
                }

                // Now I resize for the mid size image
                $config['image_library'] = 'imagemagick';           
                $config['library_path'] = '/usr/bin';

                $config['source_image'] = $Copy_Mid_Size_File;
                $config['maintain_ratio'] = TRUE;
                $config['quality'] = '100%';
                $config['master_dim'] = 'auto';
                $config['width'] = 200;
                $config['height'] = 200;

                $this->load->library('image_lib', $config);

                if(!$this->image_lib->resize()){
                    echo $this->image_lib->display_errors();// This has never reported an error yet
                    echo "Image Re-size for Mid Size Image FAILED!";// This has never reported an error yet
                    die();
                }else{
                    echo" Mid-Size Re-size Worked!";
                }

                // Now I try to resize for the Thumbnail
                $config['image_library'] = 'imagemagick';           
                $config['library_path'] = '/usr/bin';

                $config['source_image'] = $Copy_Thumbnail_Size_File;

                $config['maintain_ratio'] = TRUE;
                $config['quality'] = '100%';
                $config['master_dim'] = 'auto';
                $config['width'] = 50;
                $config['height'] = 50;

                $this->load->library('image_lib', $config);

                if(!$this->image_lib->resize()){
                    echo $this->image_lib->display_errors();// This has never reported an error yet
                    echo "Image Re-size for Thumbnail Size Image FAILED!";// This has never reported an error yet
                    die();
                }else{
                    echo" Thumbnail Re-size Worked!";
                } 
```

我总是以正确命名的正确数量的图像结束 - 缩略图图像不会重新调整大小 - 没有报告错误。它总是说成功了。

如果我首先放置缩略图重新调整大小的代码 - 缩略图重新调整大小正确 - 但中等大小的图像没有。

我意识到还有其他方法可以加载库 - 但我不明白为什么第一次调整大小有效但第二次没有。

有任何想法吗？

谢谢。问候，肯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T17:03:54.383

您只需要加载一次库，但每次都需要使用新配置对其进行*初始化。*因此，您的代码将如下所示：

```
// load the library
$this->load->library('image_lib');

// first image:
// set some config
$config['image_library'] = 'imagemagick';
...

// initialize the library with this config
$this->image_lib->initialize($config);
// Do the resize:
$this->image_lib->resize();

// clear the config:
$this->image_lib->clear();

// second image:
// set some config
$config['image_library'] = 'imagemagick';
...

// re-initialize the library with the new config
$this->image_lib->initialize($config);
// Do the resize:
$this->image_lib->resize(); 
```

我怀疑您甚至可以只更新`$config['width']`而`$config['height']`无需清除，但我还没有测试过！

附带说明一下，您实际上不必先将图像复制到正确的目录中；如果您像这样设置配置，CodeIgniter 图像库可以为您创建一个新图像库：

```
$config['new_image'] = '/path/to/new_image.jpg'; 
```

这会将图像保存到新路径中，而无需在整个地方创建副本。

参考：[http ://codeigniter.com/user_guide/libraries/image_lib.html](http://codeigniter.com/user_guide/libraries/image_lib.html)

# c++ - 简单的 2D 应用程序，遇到 glutBitmapCharacter 问题

> ID：12591737
> 
> 赞同：0
> 
> 时间：2012-09-25T22:03:02.657
> 
> 标签：c++, opengl, glut

我试图简单地在屏幕上写任何东西。绘制矩形很容易。我正在尝试将文本字符串横向叠加在“书”上。这似乎很简单，但...

正如一个注释，我试图从这些论坛中获取建议，因此`glDisable(GL_DEPTH_TEST);`可能`glDisable(GL_LIGHTING);`没有必要。另外，有没有办法自己启用调试？我通常喜欢添加`cout << "i reached this far yay" << endl;`，但当我将它放入时它似乎不喜欢我`void Bookshelf()`......它给了我一个 C2381 错误（`'function' : redefinition; __declspec(noreturn) differs`）

主文件

```
#include "bookshelf.h"

void Initialize()
{
    glClearColor (1.0, 1.0, 1.0, 0.0 );
    glMatrixMode( GL_PROJECTION );
    glOrtho(0,899,899,0,1,0);
}
void main( int argc, char *argv[] )
{
    glutInit( &argc, argv );
    glutInitDisplayMode( GLUT_SINGLE | GLUT_RGB );
    glutInitWindowSize( 900, 900 );
    glutInitWindowPosition( 510, 100 );
    glutCreateWindow("Bookshelf - Ankit Ahuja");
    Initialize();
    glutDisplayFunc(Bookshelf);
    glutMainLoop();
} 
```

书架.h

```
#include <GL/glut.h>  

void Bookshelf()
{
    glClear( GL_COLOR_BUFFER_BIT );
    glColor3f( 0.0, 0.0, 0.0 );
    glBegin( GL_QUADS );

    //Code that draws a bookshelf
    //Book1
    glColor3f( 1.0, 0.25, 0.25 );
    glVertex3i(240,70,0.5);
    glVertex3i(260,70,0.5);
    glVertex3i(260,180,0.5);
    glVertex3i(240,180,0.5);

    //BookTitle1
    glPushMatrix();
    glLoadIdentity();
    glDisable(GL_DEPTH_TEST);
    glRotatef(90f,0.0f,0.0f,0.0f);
    glColor3f( 0.0, 1.0, 0.0 );
    glDisable(GL_LIGHTING);
    glRasterPos3i(100,100,1);

    char text[50]="Alphabet Soup is the best guys";
    for(int i=0; i<50; i++) 
    {
        glutBitmapCharacter(GLUT_BITMAP_9_BY_15,(int)text[i]);
    }
    glPopMatrix();

    //Book2
    glColor3f( 0.8, 0.8, 0.0 );
    glVertex2i(270,70);
    glVertex2i(290,70);
    glVertex2i(290,180);
    glVertex2i(270,180);

    //More books and shelves
    glEnd();
    glFlush();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:54:59.010

`glOrtho`您应该在显示文本之前使用 设置正交投影。

确保在编写文本之前正确推送/弹出投影和模型视图矩阵，以便您查看如下内容：

```
glMatrixMode(GL_PROJECTION);    //Select projection matrix
glPushMatrix();                 //save it
glLoadIdentity();                               

glMatrixMode(GL_MODELVIEW);    //Select modelview matrix
glPushMatrix();                //save it
glLoadIdentity();          

// set up ur glOrtho
glOrtho(...);

glutBitmapCharacter(...)                  

glMatrixMode(GL_PROJECTION);
glPopMatrix();                //Restore your old projection matrix

glMatrixMode(GL_MODELVIEW);
glPopMatrix();               //Restore old modelview matrix 
```

# visual-studio - 使用 Visual Studio 命令提示符编译 Qt

> ID：12591738
> 
> 赞同：0
> 
> 时间：2012-09-25T22:03:04.703
> 
> 标签：visual-studio, qt, mingw

如果我按照[此链接](http://www.holoborodko.com/pavel/2011/02/01/how-to-compile-qt-4-7-with-visual-studio-2010/) 并使用 Visual Studio 命令提示符构建 qt 库，输出二进制文件是否使用 mingw 或 microsoft c++ 编译器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:10:01.373

生成的二进制文件应与 Visual Studio 编译器一起使用。

这个过程似乎没有必要，因为 Qt 已经发布了为 VS 2010 构建的最新 Qt 版本的构建二进制文件：

[http://qt-project.org/downloads](http://qt-project.org/downloads)

[适用于 Windows 的 Qt 库 4.8.3 (VS 2010, 235 MB)](http://releases.qt-project.org/qt4/source/qt-win-opensource-4.8.3-vs2010.exe)

# mysql - 如何从mysql数据库中删除旧记录

> ID：12591747
> 
> 赞同：0
> 
> 时间：2012-09-25T22:03:36.590
> 
> 标签：mysql

我正在尝试运行一个查询，该查询将删除数据库中除 9 个最新条目之外的所有条目。uid 为 id_lv，表名为 last_viewed

```
mysql_query('DELETE FROM last_viewed WHERE id_lv NOT IN (SELECT id_lv FROM last_viewed ORDER BY id_lv, desc LIMIT 0, 9'); 
```

我完全没有错误，但没有任何反应。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:36:15.127

```
mysql_query('DELETE FROM last_viewed 
               WHERE id_lv NOT IN 
              (SELECT id_lv FROM last_viewed 
               ORDER BY id_lv desc LIMIT 0, 9)'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:41:48.917

包围错误。您在子查询中缺少一个结束`)`符，并且 DESC 关键字之前不应该有逗号。

```
mysql_query('DELETE FROM last_viewed
             WHERE id_lv NOT IN (
                 SELECT id_lv
                 FROM last_viewed
                 ORDER BY id_lv desc
                 LIMIT 0, 9)'); 
```

# c - C版的strpos和substr？

> ID：12591748
> 
> 赞同：0
> 
> 时间：2012-09-25T22:03:47.413
> 
> 标签：c, string, substring, strpos

我真的很惊讶我无法找到一种有效地做到这一点的方法。我已经尝试过*strstr*，这是与*sscanf*的组合，但根据我在其他语言中的经验，似乎没有什么能像我期望的那样工作。

我有一个“ **ABCDEFG HIJ K BEGINTheMiddleEND LMNO PQRS** ”字符。我不知道“ **BEGINTheMiddleEND** ”在字符串中的哪个位置，我想通过查找“ **BEGIN** ”和“ **END** ”的出现并抓住两者之间的内容，以等于“ **TheMiddle ”的字符结尾。**

 ****完成此任务的最有效方法是什么（查找和子字符串）？

谢谢！

-- 根据答案编辑 --

我试过这个：

```
char *searchString = "ABCDEFG HIJ K BEGINTheMiddleEND LMNO PQRS"
char *t1, *t2;
t1 = strstr(searchString, "BEGIN");
t2 = strstr(t1, "END"); 
```

但是从指针的角度来看一定有问题，因为它对我不起作用。Strstr 只接受两个参数，所以我不确定从前一个指针开始是什么意思。我也不确定如何使用这些指针对其进行子串化，因为它们不是像 strpos 返回的整数值，而是字符指针。

再次感谢。

-- 使用最终代码编辑 --

对于其他任何人来说，最终的工作代码：

```
char *searchString = "ABCDEFG HIJ K BEGINTheMiddleEND LMNO PQRS"
char *b = strstr(searchString , "BEGIN");
char *e = strstr(b, "END");
int offset = e - b;
b[offset] = 0; 
```

其中“b”现在等于“BEGINTheMiddle”。（事实证明这是我在这种情况下所需要的）。

再次感谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T23:35:56.307

您需要了解什么是字符串。一个 0 分隔的字符序列。

strstr 执行它所说的：它找到给定子字符串的开头。

因此，使用指针“BEGIN”调用 strstr 会将您带到该子字符串的位置。指向“BEGIN”的指针，前进了 5 个字符，指向“TheMiddle” ，然后指向*下一个 0 char*。通过搜索“END”可以找到结束指针，然后需要将子字符串**复制**到一个新的字符串数组中（或者将其剪切，将“E”替换为0；或者实现自己的字符串函数使用 0 终止的字符串，因此它们可以任意重叠）。

这可能是您仍然缺少的步骤：实际复制字符串。例如使用

```
 t3 = strndup(t1, t2 - t1); 
```

以字符串 ABCDEF0 为例，其中 0 是实际的 0 字符。指向开头的指针指向整个字符串，指向 E 的指针仅指向“EF”。如果要获取字符串“AB”，则需要将其复制到“AB0”，或者将 C 替换为 0。

strstr 不会为您进行复制。它只是找到了位置。如果你想要一个索引，你可以这样做`int offset = newPosition - oldPosition;`，但如果你需要继续搜索，使用`newPosition`指针会更容易。

所有这些都不如 Java 中的字符串操作那么直观。除了截断字符串，据我所知，它实际上效率更高，如果你实现了 0 终止的内存布局，那就很有意义了。只有当您将字符串视为数组时，在中间某处有一个指针可能看起来很奇怪，并像常规数组一样继续使用它。这使得“sub = string + offset”成为编写“sub = string.substring(offset)”的 C 方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T22:05:59.083

使用`strstr()`两次，但第二次从第一次调用`strstr()`+ strlen(BEGIN) 返回的位置开始。

这将是有效的，因为从返回的第一个指针将`strstr()`是 BEGIN 的开头，因此您不会再次查看整个字符串，而是从 BEGIN 开始并从那里寻找 END；这意味着您最多只能遍历整个字符串**一次**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-07T14:53:03.217

我希望这个能帮上忙

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int strpos(char *haystack, char *needle, int offset);
int main()
{
    char *p = "Hello there all y'al, hope that you are all well";
    int pos = strpos(p, "all", 0);
    printf("First all at : %d\n", pos);
    pos = strpos(p, "all", 10);
    printf("Second all at : %d\n", pos);
}

int strpos(char *hay, char *needle, int offset)
{
   char haystack[strlen(hay)];
   strncpy(haystack, hay+offset, strlen(hay)-offset);
   char *p = strstr(haystack, needle);
   if (p)
      return p - haystack+offset;
   return -1;
} 
```****

# objective-c - 可重复使用的按钮栏？

> ID：12591750
> 
> 赞同：0
> 
> 时间：2012-09-25T22:03:56.020
> 
> 标签：objective-c, cocoa-touch, ios6

我正在使用情节提要实现 IOS6 应用程序。我希望每个屏幕——对不起，场景——让应用程序在顶部有一个视图，其中包含不同大小的不同图像按钮。点击按钮将用户带到应用程序的不同场景。

据我所知，这对于 UITabController 来说太复杂了。我尝试为该视图制作一个单独的视图控制器，并在每个场景中包含该视图，但视图中的任何功能（例如按钮）都会导致应用程序崩溃。

看起来我可能必须在一个场景中的情节提要中实现这个视图，然后将其复制并粘贴到每个其他场景中，将每个场景的转场连接到每个其他场景。多么可怕的维护噩梦！有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:26:24.820

由于您正在尝试创建自定义 UITabBarController，因此您应该使用容器视图控制器。要做到这一点：

1.  打开你的故事板并添加一个自定义 UIVIewController（我们称之为 ContainerViewController）。
2.  将代表您的选项卡的 UIVIews 插入该控制器，然后插入另一个 UIVIew（下面代码中的 *currentView），它将占据屏幕的其余部分。这就是子控制器将用来显示他们的场景的内容。
3.  像往常一样为您需要的每个场景（子控制器）创建一个 UIVIewController，并为每个场景提供一个唯一标识符（Identity Inspector -> Storyboard ID）

现在您必须在 ContainerViewController 中添加以下代码：

```
@interface ContainerViewController ()
    @property (strong, nonatomic) IBOutlet UIView *currentView; // Connect the UIView to this outlet
    @property (strong, nonatomic) UIViewController *currentViewController;
    @property (nonatomic) NSInteger index;
@end

@implementation ContainerViewController

// This is the method that will change the active view controller and the view that is shown
 - (void)changeToControllerWithIndex:(NSInteger)index
{
    if (self.index != index){
        self.index = index;
        [self setupTabForIndex:index];

        // The code below will properly remove the the child view controller that is
        // currently being shown to the user and insert the new child view controller.
        UIViewController *vc = [self setupViewControllerForIndex:index];
        [self addChildViewController:vc];
        [vc didMoveToParentViewController:self];

        if (self.currentViewController){
            [self.currentViewController willMoveToParentViewController:nil];

            [self transitionFromViewController:self.currentViewController toViewController:vc duration:0 options:UIViewAnimationOptionTransitionNone animations:^{
                [self.currentViewController.view removeFromSuperview];
                [self.currentView addSubview:vc.view];
            } completion:^(BOOL finished) {
                [self.currentViewController removeFromParentViewController];
                self.currentViewController = vc;
            }];
        } else {
            [self.currentView addSubview:vc.view];
            self.currentViewController = vc;
        }
    }
}

// This is where you instantiate each child controller and setup anything you need  on them, like delegates and public properties.
- (UIViewController *)setupViewControllerForIndex:(NSInteger)index {

    // Replace UIVIewController with your custom classes
    if (index == 0){
        UIViewController *child = [self.storyboard instantiateViewControllerWithIdentifier:@"STORYBOARD_ID_1"];
        return child;
    } else {
        UIViewController *child = [self.storyboard instantiateViewControllerWithIdentifier:@"STORYBOARD_ID_2"];
        return child;
    }
}

// Use this method to change anything you need on the tabs, like making the active tab a different colour
- (void)setupTabForIndex:(NSInteger)index{

}

// This will recognize taps on the tabs so the change can be done
- (IBAction)tapDetected:(UITapGestureRecognizer *)gestureRecognizer {
    [self changeToControllerWithIndex:gestureRecognizer.view.tag];
} 
```

最后，您创建的每个代表选项卡的视图都应该有它自己的 TapGestureRecognizer 和它的标签的数字。

通过执行所有这些操作，您将拥有一个带有所需按钮的控制器（它们不必是可重复使用的），您可以在其中添加尽可能多的功能（这将使用 setupTabBarForIndex: 方法）并且您赢了不要违反 DRY。

# sockets - 如何从给定的套接字读取协议信息？

> ID：12591757
> 
> 赞同：1
> 
> 时间：2012-09-25T22:04:14.243
> 
> 标签：sockets, tcp, network-programming

给定一个套接字，如何找到它的协议（即 UDP 或 TCP）？

我想到的是使用“getsockname()”==> sockaddr_in。

但是“sockaddr_in”似乎没有协议信息，只有家庭。

创建套接字时，会提供协议。我只是知道如何检索。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:34:26.573

使用 .检查`SO_PROTOCOL`和/或`SO_TYPE`套接字选项[`getsockopt(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/getsockopt.2.html)。

# tsql - 总结自定义时间设置之间的项目

> ID：12591758
> 
> 赞同：0
> 
> 时间：2012-09-25T22:04:32.457
> 
> 标签：tsql

我们需要按天计算在小时前 10 分钟和小时后 10 分钟发生的项目数。我们有一个单独跟踪项目的表格。理想情况下，我希望输出如下所示，但对其他建议完全开放。

```
Table - Attendance
Att_item    timestamp
1       2012-09-12 18:08:00
2       2012-09-01 23:26:00
3       2012-09-23 09:33:00
4       2012-09-11 09:43:00
5       2012-09-06 05:57:00
6       2012-09-17 19:26:00
7       2012-09-06 10:51:00
8       2012-09-19 09:42:00
9       2012-09-06 13:55:00
10      2012-09-05 07:26:00
11      2012-09-02 03:08:00
12      2012-09-19 12:17:00
13      2012-09-12 18:14:00
14      2012-09-12 18:14:00

Output
Date        Timeslot_5pm  Timeslot_6pm    Timeslot_7pm
9/11/2012        11           22              22
9/12/2012        30           21              55
9/13/2012        44           33              44 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:34:50.157

这只做一列（好吧4，但你明白我的意思）。

```
 select DATEPART(YYYY, FTSdate) as [year], DATEPART(mm, FTSdate) as [month]
  , DATEPART(dd, FTSdate) as [day], DATEPART(hh, FTSdate) as [hour],  COUNT(*)
  from [Gabe2a].[dbo].[docSVsys] 
  where DATEPART(mi, FTSdate) >= 50 or DATEPART(mi, FTSdate) <= 10 
  group by DATEPART(YYYY, FTSdate), DATEPART(mm, FTSdate), DATEPART(dd, FTSdate), DATEPART(hh, FTSdate) 
  order by DATEPART(YYYY, FTSdate), DATEPART(mm, FTSdate), DATEPART(dd, FTSdate), DATEPART(hh, FTSdate) 
```

分隔列。

```
 select DATEPART(YYYY, FTSdate) as [year], DATEPART(mm, FTSdate) as [month]
  , DATEPART(dd, FTSdate) as [day]
  , sum(case when DATEPART(hh, FTSdate) = '0' then 1 else 0 end) as  [0:00]  -- midnight
  , sum(case when DATEPART(hh, FTSdate) = '1' then 1 else 0 end) as  [1:00] 
  , sum(case when DATEPART(hh, FTSdate) = '2' then 1 else 0 end) as  [2:00] 
  , sum(case when DATEPART(hh, FTSdate) = '3' then 1 else 0 end) as  [3:00] 
  , sum(case when DATEPART(hh, FTSdate) = '4' then 1 else 0 end) as  [4:00] 
  from [Gabe2a].[dbo].[docSVsys] 
  where DATEPART(mi, FTSdate) >= 50 or DATEPART(mi, FTSdate) <= 10 
  group by DATEPART(YYYY, FTSdate), DATEPART(mm, FTSdate), DATEPART(dd, FTSdate)
  order by DATEPART(YYYY, FTSdate), DATEPART(mm, FTSdate), DATEPART(dd, FTSdate) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:27:28.137

您的要求并不完全清楚，但如果您只想统计 20 分钟窗口内的记录数：

```
select cast(tstmp as date) date,
  sum(case when datepart(hour, tstmp) = 1 then 1 else 0 end) Timeslot_1am,
  sum(case when datepart(hour, tstmp) = 2 then 1 else 0 end) Timeslot_2am,
  sum(case when datepart(hour, tstmp) = 3 then 1 else 0 end) Timeslot_3am,
  sum(case when datepart(hour, tstmp) = 4 then 1 else 0 end) Timeslot_4am,
  sum(case when datepart(hour, tstmp) = 5 then 1 else 0 end) Timeslot_5am,
  sum(case when datepart(hour, tstmp) = 6 then 1 else 0 end) Timeslot_6am,
  sum(case when datepart(hour, tstmp) = 7 then 1 else 0 end) Timeslot_7am,
  sum(case when datepart(hour, tstmp) = 8 then 1 else 0 end) Timeslot_8am,
  sum(case when datepart(hour, tstmp) = 9 then 1 else 0 end) Timeslot_9am,
  sum(case when datepart(hour, tstmp) = 10 then 1 else 0 end) Timeslot_10am,
  sum(case when datepart(hour, tstmp) = 11 then 1 else 0 end) Timeslot_11am,
  sum(case when datepart(hour, tstmp) = 12 then 1 else 0 end) Timeslot_12pm,
  sum(case when datepart(hour, tstmp) = 13 then 1 else 0 end) Timeslot_1pm,
  sum(case when datepart(hour, tstmp) = 14 then 1 else 0 end) Timeslot_2pm,
  sum(case when datepart(hour, tstmp) = 15 then 1 else 0 end) Timeslot_3pm,
  sum(case when datepart(hour, tstmp) = 16 then 1 else 0 end) Timeslot_4pm,
  sum(case when datepart(hour, tstmp) = 17 then 1 else 0 end) Timeslot_5pm,
  sum(case when datepart(hour, tstmp) = 18 then 1 else 0 end) Timeslot_6pm,
  sum(case when datepart(hour, tstmp) = 19 then 1 else 0 end) Timeslot_7pm,
  sum(case when datepart(hour, tstmp) = 20 then 1 else 0 end) Timeslot_8pm,
  sum(case when datepart(hour, tstmp) = 21 then 1 else 0 end) Timeslot_9pm,
  sum(case when datepart(hour, tstmp) = 22 then 1 else 0 end) Timeslot_10pm,
  sum(case when datepart(hour, tstmp) = 23 then 1 else 0 end) Timeslot_11pm
from yourtable 
where datepart(minute, tstmp) >= 50 
  or datepart(minute, tstmp) <= 10
group by cast(tstmp as date) 
```

如果要计算每小时内的记录数加上 >=50 和 <=10 时间范围内的记录数，则必须对此进行调整。

# macos - 调整大小时更改 NSView 中文本大小的最佳方法是什么？

> ID：12591759
> 
> 赞同：2
> 
> 时间：2012-09-25T22:04:33.977
> 
> 标签：macos, cocoa

我正在开发一个自定义视图，其中包含一些文本。当我调整 NSView 的大小时，根据 nsview 的变化来改变文本大小的最佳方法是什么？我想有一个 NSImage 用于回存储和写入该图像中的所有内容，然后将该图像复制到视图中。但是我认为当我将视图调整为非常小或大时，文本会看起来很难看，对吧？

# python - 带有请求的烧瓶损坏的管道

> ID：12591760
> 
> 赞同：55
> 
> 时间：2012-09-25T22:04:36.090
> 
> 标签：python, ubuntu, python-2.7, flask

我想在烧瓶应用程序中发送本地 REST 请求，如下所示：

```
from flask import Flask, url_for, request
import requests

app = Flask(__name__)

@app.route("/<name>/hi", methods=["POST"])
def hi_person(name):
    form = {"name": name}
    return requests.post(url_for("hi", _external=True), data=form)

@app.route("/hi", methods=["POST"])
def hi():
    return 'Hi, %s!' % request.form["name"] 
```

发送`curl -X POST http://localhost:5000/john/hi`会导致整个烧瓶应用程序冻结。当我发送终止信号时，我收到了一个损坏的管道错误。有没有办法防止烧瓶在这里结冰？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-09-25T22:19:58.240

[在能够处理并发请求（可能是gunicorn](http://gunicorn.org/)或[uWSGI](http://projects.unbit.it/uwsgi/) ）的适当 WSGI 服务器下运行您的烧瓶应用程序，它会工作。在开发过程中，在 Flask 提供的服务器中启用线程：

```
app.run(threaded=True) 
```

但请注意，不建议将 Flask 服务器用于生产用途。从 Flask 1.0 开始，`threaded`默认情况下是启用的，并且您`flask`确实希望在命令行上使用该命令来运行您的应用程序。

发生的情况是，使用请求您正在向您的烧瓶应用程序发出*第二个*请求，但由于它仍在忙于处理第一个请求，因此在完成第一个请求之前它不会响应第二个请求。

顺便说一句，在 Python 3 下，socketserver 实现更优雅地处理断开连接并继续服务而不是崩溃。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-25T22:25:17.700

这里有几件事在起作用，我将尝试一次解决它们。

首先，您可能正在使用玩具开发服务器。该服务器有很多限制；这些限制中最主要的是它一次只能处理一个请求。当您在第一个请求期间创建第二个请求时，您将锁定您的应用程序：该`requests.post()`函数正在等待 Flask 响应，但 Flask 本身正在等待`post()`返回！这个特定问题的解决方案是在多线程或多进程环境中运行您的 WSGI 应用程序。为此，我更喜欢[http://twistedmatrix.com/trac/wiki/TwistedWeb](http://twistedmatrix.com/trac/wiki/TwistedWeb)，但还有其他几个选项。

顺便说一句……这是一种反模式。您几乎肯定不想为了在两个视图之间共享某些功能而调用 HTTP 请求的所有开销。正确的做法是重构以拥有一个单独的函数来完成该共享工作。我无法真正重构您的特定示例，因为您所拥有的非常简单，甚至不值得两个视图。你到底想建造什么？

编辑：一条评论询问玩具标准库服务器中的多线程模式是否足以防止死锁发生。我会说“也许”。是的，如果没有任何依赖关系阻止两个线程取得进展，并且两个线程都取得了足够的进展来完成它们的网络任务，那么请求将正确完成。但是，确定两个线程是否会相互死锁是无法确定的（证明被忽略为钝），我不想肯定地说 stdlib 服务器可以正确地做到这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-20T16:25:10.393

导致崩溃的错误已[**在 2016 年 12 月 21 日发布的 0.12 版本中修复**](http://flask.pocoo.org/docs/0.12/changelog/#version-0-12)。是的！这是许多人一直在等待的重要修复。

从 Flask 更新日志：

> *   恢复导致开发服务器崩溃的行为更改，而不是返回内部服务器错误（拉取请求 #2006）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-08-28T12:04:43.547

我对 post 方法也有同样的问题，一般来说我的 post 方法什么也没做，这就是为什么会出现这个问题

```
return _socket.socket.send(self._sock, data, flags) urllib3.exceptions.ProtocolError:
('Connection aborted.', BrokenPipeError(32, 'Broken pipe'))

if request.method == 'POST':
    print(len(request.data))
return 'dummy' 
```

这`print`成功了

# ruby-on-rails - 如何在我的 RSpec 中设置 request.referrer？

> ID：12591763
> 
> 赞同：30
> 
> 时间：2012-09-25T22:04:40.867
> 
> 标签：ruby-on-rails, ruby, rspec

我试图避免使用我的`session[:referred_by]`，并想使用`request.referrer`. 但是，我的 RSpec 测试失败，因为`TestRequest`不存储`request.referrer`

因此，我必须执行以下操作才能使 Rspec 测试正常工作。有没有办法让它变得更好：

```
referrer = request.referrer ? request.referrer : '/'
redirect_to referrer, :alert => error_message 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-25T22:47:58.970

`ActionDispatch::TestRequest`延伸`ActionDispatch::Request`那个延伸`Rack::Request`。

方法定义如下

```
def referer
  @env['HTTP_REFERER']
end
alias referrer referer 
```

据我记得，您可以使用`request.env`. 这意味着，应该可以设置类似

```
request.env['HTTP_REFERER'] = 'http://example.com' 
```

当然，这取决于您使用的 RSpec 示例组的类型。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-25T22:11:21.360

模拟它：

```
specify 'foo' do
  controller.request.should_receive(:referer).and_return('http://example.com')
  # get whatever
end 
```

或者，如果您不在乎它是否没有被调用，请将其存根：

```
controller.request.stub referer: 'http://example.com' 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-07-03T09:04:57.950

在 Rails 5 上，公认的解决方案似乎不再适用，但正如[Simone Carletti](https://stackoverflow.com/users/123527/simone-carletti)`request.env['HTTP_REFERER']`建议的那样，直接设置是有效的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-07-06T05:47:35.720

## Rails 5.2+ & RSpec 3.8+ 的解决方案

```
get :endpoint, params: {}, headers: { 'HTTP_REFERER' => 'stackoverflow.com' } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-28T01:18:48.883

对于 Rails4/Rspec3，在请求规范中，在`request`您进行 http 调用之前不可用。但是您可以通过执行以下操作来分配 request.referer：

```
get '/posts', {}, { referer: 'http://example.com' } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-18T19:20:04.837

这也适用于控制器规格：

```
controller.request.headers.merge({ 'HTTP_REFERER': 'https://stackoverflow.com/' })
get(:endpoint) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-11T21:19:19.007

对于其他在谷歌上搜索的人，您还可以像这样在帮助规范中存根请求：

```
allow(view).to receive_message_chain(:request, :referrer).and_return("http://example.com") 
```

# php - 扩展类 php 的同名

> ID：12591764
> 
> 赞同：0
> 
> 时间：2012-09-25T22:04:50.017
> 
> 标签：php, class, extends

我正在尝试创建一个 php 类，它将从多个子类中获取数据并在最后显示值

```
class ManifestBuilder
{

  static $manifest;

  function __construct( )
  {
    $this->get_manifest( );
  }

  function get_manifest( )
  { 
    include 'manifest.php';
    include 'sub1/manifest.php';
    include 'sub2/manifest.php';
    var_dump ( ManifestBuilder::$manifest ); 
  }

  function add_manifest( $var )
  {
    ManifestBuilder::$manifest .= $var;
  }

}

new ManifestBuilder( ); 
```

每个孩子都是这样的

```
class Manifest extends ManifestBuilder 
{

  function __construct( )
  {
    $this->manifest( );
  }

  function manifest( )
  {

    parent::add_manifest( 'manifest1' );

  }

}

new Manifest( ); 
```

问题是我想为每个孩子命名相同的类，以便我可以轻松地移动它们，但我收到一个错误，即类名不能相同（预期）。

我该如何解决这个问题？我想让多个子类能够添加到父类中的变量。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:16:16.777

你不能。就这么简单。

这也很有意义。如果您需要同一类的更多功能，只需重构它。如果您需要一个子类，请扩展它。

# c - 如何自动生成C代码

> ID：12591767
> 
> 赞同：4
> 
> 时间：2012-09-25T22:04:57.800
> 
> 标签：c, code-generation

我正在做一个 C 项目。我观察到很多代码可以根据某些规则自动生成。IE。如果我只指定 C 结构，基于此，可以自动生成代码。我知道它可以做到，但我以前没有做过。如果有经验的 C 程序员可以给出某些指示或分享他们如何以最少的工程工作量做这些事情的经验，那就太好了。

编辑：要非常具体，我是否需要在 C 中编写一个自定义解析器来完成所有这些工作，还是有一些更简单的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:31:21.423

简单的部分与 1:1 语法替换有关。

困难的部分是做任何超出 1:1 语法替换的非常有意义的事情。

如果你过分依赖宏，你会遇到认知漂移的（编造名称）问题，你现在正在设计自己的语言（宏语言），但编译器和运行程序正在使用另一种语言。简单的映射不会使新语言变得更麻烦，但由于宏在*纯文本*替换级别上运行，即使是简单的映射也会很快变得复杂。

如果您使用的是 C++，那么*更好*的解决方案是使用**templates**。模板提供了许多与宏相同的功能，只是它们不会受到太多认知漂移的影响，因为模板可以替代对类型系统的认识。

随着类 C 语言结构的语法和含义的发展，您会发现较新的语言经常尝试“修复”纯 C 解决方案*所需的重复代码量问题。*尝试学习一些“接近”C 的新语言，您将了解可以减少这种代码重复的方法，从而在 C 的“生成”工作中做出更好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:30:38.743

在 C 中进行元编程的一种相对传统的方法是使用[X 宏](http://www.drdobbs.com/the-new-c-x-macros/184401387)之类的技术。

本质上，不是使用普通的 C 结构声明，而是完全使用宏定义结构，就像这样

```
BEGIN_STRUCT(pointf)
FIELD(float, x)
FIELD(float, y)
END_STRUCT(pointf) 
```

并将这些定义放在一个头文件中，不防止多重包含。

然后，对于您需要生成的每一段代码（包括基本结构）、`#define`每个元语言宏、`#include`定义头和`#undef`元语言宏：

```
#define BEGIN_STRUCT(N) struct N {
#define FIELD(T,N) T N;
#define END_STRUCT(N) }
#include "definitions.h"
#undef BEGIN_STRUCT
#undef FIELD
#undef END_STRUCT 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T22:22:00.800

我见过的一种有效方法是使用宏（一种经常被讨厌的工具）。宏有两个特性可以让生活变得更轻松，单哈希“#”可以将参数转换为字符串，`#_name`即将被翻译成字符串，`"fieldName1"`双哈希“##”将参数与其他东西连接起来，这反过来可以扩展新事物，`STRUCT_##_type##_str`即将被翻译成`STRUCT_int_str`哪个将被翻译成`"%d"`

首先将宏中的结构或“描述”包装到自己的文件中（the-struct.def）

```
STRUCT_BEGIN(s_my_struct)
  STRUCT_FIELD(int, fieldName1)
  STRUCT_FIELD(int, fieldName2)
  STRUCT_FIELD(int, fieldName3)
STRUCT_END(s_my_struct)

// Note that you can add more structs here and all will automatically get defined and get the print function implemented 
```

然后可以在想要声明或实现应该处理结构的东西的地方以不同的方式定义宏。IE

```
#define STRUCT_BEGIN(_name) struct _name {
#define STRUCT_END(_name) };
#define STRUCT_FIELD(_type, _name) _type _name;

#include "the-struct.def"

// then undef them
#undef STRUCT_BEGIN
#undef STRUCT_END
#undef STRUCT_FIELD 
```

并制作一个打印结构的函数

```
#define STRUCT_BEGIN(_name) void print_ ## _name(struct _name *s) {
#define STRUCT_END(_name) }
#define STRUCT_FIELD(_type, _name) printf("%s = " STRUCT_##_type##_str "\n", #_name, s->_name); 
#define STRUCT_int_str "%d" /* this is to output an int */
// add more types...

#include "the-struct.def"

// then undef them
#undef STRUCT_BEGIN
#undef STRUCT_END
#undef STRUCT_FIELD
#undef STRUCT_int_str 
```

其他用途可以是自动生成函数以交换字节等。

在这里做了一个小例子作为要点[https://gist.github.com/3786323](https://gist.github.com/3786323)

# screenshot - 如何使用 html2canvas？

> ID：12591770
> 
> 赞同：2
> 
> 时间：2012-09-25T22:05:37.637
> 
> 标签：screenshot, html2canvas

我想使用 html2canvas 但在文档中如何使用它还不够清楚。我应该包括哪些库？那么这种和平的代码正是我所需要的吗？代理呢？以及如何在拍摄后保存屏幕截图？

```
$('body').html2canvas();
var queue = html2canvas.Parse();
var canvas = html2canvas.Renderer(queue,{elements:{length:1}});
var img = canvas.toDataURL()
window.open(img); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T09:04:57.947

对我来说，它是这样工作的：

```
$('#map').html2canvas({
onrendered: function( canvas ) {
  var img = canvas.toDataURL()
  window.open(img);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-30T09:28:36.657

当前的最新版本以这种方式工作：

```
html2canvas($('#map'),
 {
  onrendered: function(canvas) {
    cvs = canvas.toDataURL('image/png');
    window.open(cvs)
 }
}); 
```

# scala - 错误：未找到：值 StartScriptPlugin StartScriptPlugin.stage in Compile := Unit

> ID：12591771
> 
> 赞同：0
> 
> 时间：2012-09-25T22:05:38.723
> 
> 标签：scala, heroku, sbt

首先我需要说，我是 Scala 和 SBT 初学者，所以这是我的第一个项目。我尝试在 Heroku 上部署 scala 应用程序。我收到此错误：

```
error: not found: value StartScriptPlugin StartScriptPlugin.stage in Compile := Unit 
```

这是我的 build.sbt。**它有什么问题？**我知道 Compile := Unit 中的 StartScriptPlugin.stage 是这样的，但我找到了一些示例，他们总是以这种方式使用它。谢谢

```
name := "Survey server" 

version := "1.0"

scalaVersion := "2.9.2"

resolvers ++= Seq("repo.codahale.com" at "http://repo.codahale.com", Classpaths.typesafeResolver)

addSbtPlugin("com.typesafe.startscript" % "xsbt-start-script-plugin" % "0.5.3")

StartScriptPlugin.stage in Compile := Unit

EclipseKeys.withSource := true

libraryDependencies ++= Seq( 
"net.databinder" %% "unfiltered-filter" % "0.6.3", 
"net.databinder" %% "unfiltered-jetty" % "0.6.3", 
"net.databinder.dispatch" %% "core" % "0.9.0", 
"com.codahale" % "jerkson_2.9.1" % "0.5.0", 
"org.scalaquery" % "scalaquery_2.9.1" % "0.10.0-M1", 
"postgresql" % "postgresql" % "9.1-901.jdbc4" ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T09:32:22.793

你需要告诉 SBT 你的项目使用了 StartScriptPlugin。这是通过使用 in 中的`addSbtPlugin`命令完成的`project/plugins.sbt`。这在 SBT 文档中都有解释： [https ://github.com/harrah/xsbt/wiki/Getting-Started-Using-Plugins](https://github.com/harrah/xsbt/wiki/Getting-Started-Using-Plugins)

您尝试使用的插件的文档甚至可以准确地告诉您需要添加到`project/plugins.sbt`. 对于 SBT 0.11，这将是：

```
resolvers += Classpaths.typesafeResolver

addSbtPlugin( "com.typesafe.startscript" % "xsbt-start-script-plugin" % "0.5.2" ) 
```

见[https://github.com/typesafehub/xsbt-start-script-plugin](https://github.com/typesafehub/xsbt-start-script-plugin)

# java - Java：二维矩阵旋转不起作用

> ID：12591772
> 
> 赞同：0
> 
> 时间：2012-09-25T22:05:40.113
> 
> 标签：java, matrix, rotation, transformation

我有这个 3x3 矩阵，我用它来执行基本的转换，如平移、缩放和旋转，但旋转部分不能正常工作。对于任何大于 30 度左右的角度，它看起来……很奇怪。

该方法如下所示：

```
public void rotate(float angle) {
    double rads = angle * (Math.PI/180);
    float sin = (float) Math.sin(rads);
    float cos = (float) Math.cos(rads);

    matrix[0][0] = cos;
    matrix[0][1] = -sin;
    matrix[1][0] = sin;
    matrix[1][1] = cos; 
} 
```

以及应用转换的方法：

对于 X：

```
public float[] applyTransformX(float[] x, float[] y) {
    float[] transformed = new float[x.length];
    for(int i=0; i<x.length; i++) {
        transformed[i] = (x[i] * matrix[0][0]) + (y[i] * matrix[0][1] + matrix[0][2]);
        System.out.println((x[i] * matrix[0][0]) + (y[i] * matrix[0][1] + matrix[0][2]));

    }
    return transformed;
} 
```

对于 Y：

```
public float[] applyTransformY(float[] x, float[] y) {
    float[] transformed = new float[x.length];
    for(int i=0; i<x.length; i++) {
        transformed[i] = (x[i] * matrix[1][0]) + (y[i] * matrix[1][1] + matrix[1][2]);
    }
    return transformed;
} 
```

我在这里缺少任何基本的东西吗？我知道我没有围绕一个固定点进行转换。这可能是我遇到这个问题的原因吗？

正如我所说，平移和缩放正在正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:34:57.447

我能想到的只是，您添加的三个术语的大小差异可能会导致舍入误差 get each`x[i]`和 to get each `y[i]`。我的直觉是最后添加翻译术语，以便相当大的翻译不会导致旋转导致的术语失去意义。这只需要您删除一些括号，以便标准的从左到右的操作顺序开始。换句话说，在计算 X 值的方法中，写：

```
transformed[i] = x[i] * matrix[0][0] + y[i] * matrix[0][1] + matrix[0][2]; 
```

没有任何括号。同样，在计算 Y 值时，写

```
transformed[i] = x[i] * matrix[1][0] + y[i] * matrix[1][1] + matrix[1][2]; 
```

如果这没有帮助，那么请发布一些实际数字，以便我们可以看到哪些计算可能会导致重要性丧失。这对小角度有效的事实表明您看到的是舍入误差，而不是实际不正确的计算方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:19:24.887

问题在于 `transformed[i]`两种情况的计算：对于 X 它应该是：

```
transformed[i] = (x[i] * matrix[0][0]) + (y[i] * matrix[0][1]); 
```

对于 Y 它应该是：

```
transformed[i] = (x[i] * matrix[1][0]) + (y[i] * matrix[1][1]); 
```

如果您包含`matrix[0][2]`并且`matrix[1][2]`这将用于 Z 组件，但是对于围绕 Z 轴的旋转，这些应该评估为 0（`matrix[2][2]`尽管是完整的，但应该是 1）。你可能只是忘了重新初始化它们……</p>

# go - 错误：从 C 构建示例时无法确定 C.stdout 的名称类型？去？加油！文章

> ID：12591773
> 
> 赞同：4
> 
> 时间：2012-09-25T22:05:39.733
> 
> 标签：go, cgo

我正在尝试从[C 构建以下示例？去？加油！](http://golang.org/doc/articles/c_go_cgo.html)：

```
package print

/*
#include <stdio.h>
#include <stdlib.h>
*/
import "C"
import "unsafe"

func Print(s string) {
    cs := C.CString(s)
    C.fputs(cs, (*C.FILE)(C.stdout))
    C.free(unsafe.Pointer(cs))
} 
```

我在 Win7 64 上运行 Go，并使用来自[http://tdm-gcc.tdragon.net/](http://tdm-gcc.tdragon.net/)的 GCC 的 64 位版本， 在 Linux 上运行它不是一种选择。

我得到的错误是：

```
could not determine kind of name for C.stdout 
```

我无法找到有关此消息的任何文档，而且 Google 上显示的点击率也很少。

有人对造成这种情况的原因有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T05:47:00.150

这是在 Windows 上访问 C.stdout 的一种方法：

```
// Copyright 2009 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

package stdio

/*
#include <stdio.h>
// on mingw, stderr and stdout are defined as &_iob[FILENO]
// on netbsd, they are defined as &__sF[FILENO]
// and cgo doesn't recognize them, so write a function to get them,
// instead of depending on internals of libc implementation.
FILE *getStdout(void) { return stdout; }
FILE *getStderr(void) { return stderr; }
*/
import "C"

var Stdout = (*File)(C.getStdout())
var Stderr = (*File)(C.getStderr()) 
```

[https://github.com/golang/go/blob/master/misc/cgo/stdio/stdio.go](https://github.com/golang/go/blob/master/misc/cgo/stdio/stdio.go)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T01:37:14.030

在 cgo 实现中，有一种[方法](http://golang.org/src/cmd/cgo/gcc.go#L315)可以根据 gcc 的输出猜测类型。您可能在终端中设置了不同的语言环境并且猜测失败。

试试这个：

```
LC_ALL=C go build 
```

# mysql - 如何删除电子邮件域值并在列中添加新值 - mysql

> ID：12591783
> 
> 赞同：1
> 
> 时间：2012-09-25T22:06:11.753
> 
> 标签：mysql, sql, string, split, concat

所以我在一个列中有一群用户，它们被刷新为：

```
Bill@test.comXYZ
Tom@test.comXYZ
John@test.comXYZ 
```

我们每周都会刷新数据库，我需要将这些适当的电子邮件更新为：

```
Bill@domain.com
Tom@domain.com
John@domain.com 
```

我想我可以使用 concat 来做后者，但我被困在前一个问题上。有没有办法拆分值（例如将 Bill@test.comXYZ 拆分为 Bill - @test.comXYZ 然后删除 @TEXT 值？）。

无论如何，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:08:52.477

您可以使用 mySQL 替换功能，即

```
 UPDATE mytable
    set myfield = replace (myfield, '@test.comXYZ', 'domain.com') 
```

[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)

# macos - 如何在makefile中指定静态链接？

> ID：12591785
> 
> 赞同：1
> 
> 时间：2012-09-25T22:06:14.790
> 
> 标签：macos, gcc, makefile, static-linking

在运行配置脚本以静态链接生成的可执行文件时，我通常使用“--enable-static”选项。

但是，现在我正在尝试编译[g3data](http://www.frantz.fi/software/g3data.php)，它只带有一个 makefile（没有配置文件）。我尝试在 makefile 中添加“-bstatic”选项（“-static”选项在我的系统上不起作用：Mac OS X 10.6.8，请参阅[此处](https://discussions.apple.com/thread/2252567)以获得解释），但是编译成功并且我可以运行该程序，它不是静态链接的...

我应该怎么做才能在这样的makefile中实现静态链接？这是我现在所拥有的：

```
CC=gcc
CFLAGS=-Wall `pkg-config --cflags gtk+-2.0` -arch i386 -arch x86_64 -arch ppc -bstatic
LIBS=`pkg-config --libs gtk+-2.0`
LDFLAGS=-arch i386 -arch x86_64 -arch ppc -bstatic
#bindir ?= /usr/bin
#mandir ?= /usr/share/man

.c.o:
    $(CC) -c $(CFLAGS) $(CPPFLAGS) $<

all: g3data

g3data: main.o sort.o points.o drawing.o #g3data.1.gz
    $(CC) $(CFLAGS) -o g3data main.o sort.o points.o drawing.o $(LIBS) -bstatic
    strip g3data

main.o: main.c main.h strings.h vardefs.h

sort.o: sort.c main.h

points.o: points.c main.h

drawing.o: drawing.c main.h

#g3data.1.gz: g3data.sgml
#   rm -f *.1
#   onsgmls g3data.sgml | sgmlspl /usr/share/sgml/docbook/utils-0.6.14/helpers/docbook2man-spec.pl
#   gzip g3data.1

clean:
    rm -f *.o g3data g3data.1.gz *~ manpage.*

install:
    install g3data $(bindir)
    install g3data.1.gz $(mandir)/man1

uninstall:
    rm $(bindir)/g3data 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T22:50:29.963

假设`-bstatic`是您的链接器的正确选项，并且假设您确实有必要库的静态版本，我希望您需要将该选项放在列表*之前*`$(LIBS)`，就好像它就像`-Bstatic`GNU 链接器的选项一样，那么它只会影响库选项*后*列出。

# android - 连接到安全的 Web 服务

> ID：12591789
> 
> 赞同：0
> 
> 时间：2012-09-25T22:06:37.940
> 
> 标签：android, web-services

我有网络服务，我应该在检索或发布数据之前进行身份验证，例如，我可以连接到普通的 JSON 网络服务

```
public void clickbutton(View v) {
    try {
        // http://androidarabia.net/quran4android/phpserver/connecttoserver.php

        // Log.i(getClass().getSimpleName(), "send  task - start");
        HttpParams httpParams = new BasicHttpParams();
        HttpConnectionParams.setConnectionTimeout(httpParams,
                TIMEOUT_MILLISEC);
        HttpConnectionParams.setSoTimeout(httpParams, TIMEOUT_MILLISEC);
        //
        HttpParams p = new BasicHttpParams();
        // p.setParameter("name", pvo.getName());
        p.setParameter("user", "1");

        // Instantiate an HttpClient
        HttpClient httpclient = new DefaultHttpClient(p);
        String url = "http://10.0.2.2:8080/sample1/" + 
                     "webservice1.php?user=1&format=json";
        HttpPost httppost = new HttpPost(url);

        // Instantiate a GET HTTP method
        try {
            Log.i(getClass().getSimpleName(), "send  task - start");
            //
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(
                    2);
            nameValuePairs.add(new BasicNameValuePair("user", "1"));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            ResponseHandler<String> responseHandler = new BasicResponseHandler();
            String responseBody = httpclient.execute(httppost,
                    responseHandler);
            // Parse
            JSONObject json = new JSONObject(responseBody);
            JSONArray jArray = json.getJSONArray("posts");
            ArrayList<HashMap<String, String>> mylist = 
                   new ArrayList<HashMap<String, String>>();

            for (int i = 0; i < jArray.length(); i++) {
                HashMap<String, String> map = new HashMap<String, String>();
                JSONObject e = jArray.getJSONObject(i);
                String s = e.getString("post");
                JSONObject jObject = new JSONObject(s);

                map.put("idusers", jObject.getString("idusers"));
                map.put("UserName", jObject.getString("UserName"));
                map.put("FullName", jObject.getString("FullName"));

                mylist.add(map);
            }
            Toast.makeText(this, responseBody, Toast.LENGTH_LONG).show();

        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        // Log.i(getClass().getSimpleName(), "send  task - end");

    } catch (Throwable t) {
        Toast.makeText(this, "Request failed: " + t.toString(),
                Toast.LENGTH_LONG).show();
    }
} 
```

但问题是我应该使用密码和用户名登录网络服务

任何想法如何做到这一点

# c# - 如何从 MVC4 中的另一个控制器向 API 控制器发出请求？

> ID：12591790
> 
> 赞同：2
> 
> 时间：2012-09-25T22:06:40.860
> 
> 标签：c#, asp.net-mvc-4

我正在开发一个具有站点控制器和 API 控制器的 MVC4 项目。如何从站点控制器之一向 API 控制器发送请求？

例如，我可能有一个如下所示的 APiController：

```
public class FooController : ApiController {
    [HttpGet]
    public int Add(int a, int b) {
        return a + b;
    }
} 
```

我将如何`/FooController/Add?a=1;b=2`从这个控制器发送请求？

```
public class BarController : Controller {
    [HttpGet]
    public int AddOneAndTwo() {
        //What goes here?
    }
} 
```

编辑：我真正想做的是从我的站点控制器调用我的 ApiController 类的方法，我认为我必须变出一些 MVC4 魔法才能使其工作。根据 Felix 和我之间的评论，我可以在我的站点控制器中创建我的 ApiController 的实例，然后从那里开始。但是，如果您仍然需要通过 HTTP 访问 ApiController 方法，那么男孩你好，这是 Felix 对我最初为您提出的问题的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:12:56.340

带有 restsharp 的代码将是这样的：

```
 protected IRestResponse GetResponse(int a, int b)
    {
        var client = new RestClient
        {
            BaseUrl = "http://localhost:8888/api/FooController"
        };
        var request = new RestRequest
        {
            DateFormat = DataFormat.Xml.ToString(),
            Resource = "Add",
            Method = Method.GET
        };
        request.AddParameter("application/json",
            JsonSerializer.JsonSerialize(new {a, b}),
            ParameterType.RequestBody);
        return client.Execute(request);
    } 
```

# node.js - 如何在保存对象数组后创建回调？

> ID：12591791
> 
> 赞同：2
> 
> 时间：2012-09-25T22:06:44.483
> 
> 标签：node.js, mongodb, mongoose

假设我在函数中有以下内容：

```
exports.addnames = function(req, res) {
    var names = ["Kelley", "Amy", "Mark"];

    for(var i = 0; i < names.length; i++) {
        (function (name_now) {
            Person.findOne({ name: name_now},
                function(err, doc) {
                    if(!err && !doc) {
                        var personDoc = new PersonDoc();
                        personDoc.name = name_now;
                        console.log(personDoc.name);
                        personDoc.save(function(err) {});
                    } else if(!err) {
                        console.log("Person is in the system");
                    } else {
                        console.log("ERROR: " + err);
                    }
                }
            );   
        )(names[i]);
    } 
```

我的问题是保存名称后，我想返回结果：

```
Person.find({}, function(err, doc) {    
    res.json(200, doc);
}) 
```

虽然我有一个名称回调，但似乎在保存所有名称的调用完成之前执行了最后一段代码（Persons.find（{}））......因此，当用户转到浏览器，“doc”是空的......有什么方法可以确保在 for 循环完成后调用 Persons.find({}) ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:17:18.963

做这样的事情最简单的方法是使用一个像恰当命名的异步库`async`，可以在[https://github.com/caolan/async](https://github.com/caolan/async)找到。

如果您有一个要保存并在完成后返回的名称列表，它将如下所示：

```
// save each of the names asynchronously
async.forEach(names, function(name, done) {
    Person.findOne({name: name},
        function(err, doc) {
            // return immediately if there was an error
            if(err) return done(err);

            // save the person if it doesn't already exist
            if(!doc) {
                var personDoc = new PersonDoc();
                personDoc.name = name;
                console.log(personDoc.name);

                // the async call is complete after the save completes
                return personDoc.save(done);
            } 

            // or if the name is already there, just return successfully
            console.log("Person is in the system");
            done();
        }
    );           
},
// this function is called after all of the names have been saved
// or as soon as an error occurs
function(err) {
    if(err) return console.log('ERROR: ' + err);

    Person.find({}, function(err, doc) {    
        res.json(200, doc);
    })

}); 
```

# c - 单向命名管道

> ID：12591792
> 
> 赞同：0
> 
> 时间：2012-09-25T22:06:47.337
> 
> 标签：c, multithreading, networking, pipe, named-pipes

一个简单的问题。如果我有 2 个程序需要访问 1 个命名管道。如果一个人使用 open() 函数在一端读取带有`O_RDONLY`标志，那么另一端是否能够打开文件`O_WRONLY`并能够写入它？另一个程序会得到写入的数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T00:39:28.673

你可以这样做。

如果您使用`O_RDWR`打开管道，它不会阻塞。

如果您使用`O_RDONLY`打开管道，它将阻塞直到编写器打开管道，除非您使用`O_NONBLOCK`确保成功打开管道。

如果你使用`O_WRONLY`打开管道，它会阻塞直到读者打开管道，但如果你也使用`O_NONBLOCK`，`open()`将会失败。

# wpf - 使用keydown wpf获取小写

> ID：12591793
> 
> 赞同：7
> 
> 时间：2012-09-25T22:07:01.253
> 
> 标签：wpf

我想在有或没有大写锁定的情况下按下键盘上的键：

```
private void Window_KeyDown(object sender, System.Windows.Input.KeyEventArgs e)
{
   e.Key.ToString();
} 
```

当我在键盘上键入“a”或“A”时，e.Key 的结果总是“A”。输入“a”如何获得“a”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T07:46:40.200

您可以使用[Control.IsKeyLocked](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.iskeylocked%28VS.80%29.aspx "Control.IsKeyLocked")方法检查您的`KeyDown`事件`CAPS lock`是打开还是关闭。此外，您可能需要检查用户是否使用可以像这样使用枚举识别的键输入大写 -`Shift``Modifiers`

```
private void Window_KeyDown(object sender, KeyEventArgs e)
{
   string key = e.Key.ToString();
   bool isCapsLockOn = System.Windows.Forms.Control
                        .IsKeyLocked(System.Windows.Forms.Keys.CapsLock);
   bool isShiftKeyPressed = (Keyboard.Modifiers & ModifierKeys.Shift)
                                == ModifierKeys.Shift;
   if (!isCapsLockOn && !isShiftKeyPressed)
   {
      key = key.ToLower();
   }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-25T22:22:40.813

您不能使用该`KeyDown`事件。您将需要使用该`TextInput`事件。这将打印带有标题（大写/小写）的原始字母。

```
 private void Window_TextInput(object sender, TextCompositionEventArgs e)
    {
        Console.WriteLine(e.Text);
    } 
```

现在，如果按下它，它也会打印 Shift 等。如果您不想要这些修饰符，只需获取字符串的最后一项 - 将其视为 char 数组;)-

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-07T23:53:42.017

覆盖 TextInput/PreviewTextInput（或监听事件）应该可以工作。

```
protected override void OnPreviewTextInput(TextCompositionEventArgs e)
{
    base.OnPreviewTextInput(e);
    Console.WriteLine(e.Text);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-09T04:26:42.157

[KeyEventArgs 类](http://msdn.microsoft.com/zh-cn/library/system.windows.forms.keyeventargs.aspx)具有“Shift”字段，指示是否按下了 SHIFT 键。

否则，因为按下 CAPS_LOCK 时会调用 Window_KeyDown 方法，所以您可以保存一个布尔值来指示是否按下了 CAPS_LOCK 键。

```
 bool isCapsLockPressed;
    private void Window_KeyDown(object sender, System.Windows.Input.KeyEventArgs e) {
           if(e.KeyCode == Keys.CapsLock) {
               isCapsLockPressed = !isCapsLockPressed;
           }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-13T21:32:44.477

处理此问题的最佳方法是使用 Window_TextInput 事件而不是 KeyDown。

但是正如您所说，此事件不会在您的应用程序上触发，您可以使用这样的 hack：

```
bool iscapsLock = false;
bool isShift = false;
private void Window_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.CapsLock)
        iscapsLock = !iscapsLock;

    if (e.Key >= Key.A && e.Key <= Key.Z)
    {
        bool shift = isShift;
        if (iscapsLock)
            shift = !shift;
        int s = e.Key.ToString()[0];
        if (!shift)
        {
            s += 32;
        }
        Debug.Write((char)s);
    }

} 
```

这将根据是否打开大写锁定正确打印字符。可以使用此链接检索 Capslock 的初始值：

[http://cboard.cprogramming.com/csharp-programming/105103-how-detect-capslock-csharp.html](http://cboard.cprogramming.com/csharp-programming/105103-how-detect-capslock-csharp.html)

我希望这对你有用。

# javascript - jQuery 解构 | $.ajax() 的调用机制

> ID：12591796
> 
> 赞同：2
> 
> 时间：2012-09-25T22:07:19.587
> 
> 标签：javascript, jquery

ajax 在源代码中定义的位置以及它如何绑定到 jQuery 对象？

我对其进行了搜索，并在名为 5993 的这个东西中找到了它：

```
jQuery.extend({ 
```

其中 fn 是原型的别名。

当您调用它时，Jquery 如何知道要找到 ajax()。更一般地说，扩展如何工作？

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

[http://code.jquery.com/jquery-latest.js](http://code.jquery.com/jquery-latest.js)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:09:05.253

该`extend`方法将属性从一个对象复制到另一个对象。只需一个参数，它将属性复制到`this`，因此在这种情况下，它将属性复制到`fn`对象本身。

*在我的 1.7.1 代码副本中进行编辑*，“ajax”方法实际上是由 复制的`jQuery.extend()`，而不是`jQuery.fn.extend()`. 这是相同的功能；`extend`绑定到 jQuery 对象和“fn”对象（内部构造函数）。因此，当它被调用时`jQuery.extend({ ... })`，属性被复制到 jQuery 对象（函数）本身。

# algorithm - 选择排序和求和符号分析

> ID：12591798
> 
> 赞同：0
> 
> 时间：2012-09-25T22:07:31.097
> 
> 标签：algorithm, selection, analysis

我正在阅读有关选择排序算法分析的本教程[(personal.denison.edu/~kretchmar/272/SelectionSortAnalysis.pdf)](http://personal.denison.edu/~kretchmar/272/SelectionSortAnalysis.pdf)。我花了相当长的时间来理解算法分析，但并没有完全成功。

如果您查看 PDF，则有一些与 c3、c4 和 c5 相关的“时间”。我不知道作者为什么添加求和符号，为什么选择顶部和底部索引以及为什么在第一次求和后选择“（i + 1）”。我知道求和符号是表达一组数字之和的一种紧凑方式......但我似乎无法完成这个难题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:42:50.257

1）他正在对外部循环（第 1 行）的值求和。这就是他使用 i （外部循环中的索引变量）的原因。

2) 传统的 Σ 表达式的起始值小于结束值。但是，在这种情况下，对于某些 i，内部循环将执行的次数是 n - i。当 i 为 1（循环开始）时，内循环将执行 n - 1 次，当 i 在外循环结束时达到 n - 1 时，内循环将执行 1 次（n - ( n - 1))。所以你可能想把它写成 sum(i = n-1 -> 1)，但正如我所说的，传统是从小到大写。

3）循环执行了i次，但是循环测试执行了i+1次：i次成功，一次不成功，终止循环。因此，在循环体中求和的值为 i，但循环终止测试本身（即 for 语句）的求和值为 i + 1。

# c++ - 如何在 C++ 中的线程之间传递对静态成员变量的更改

> ID：12591803
> 
> 赞同：2
> 
> 时间：2012-09-25T22:08:00.200
> 
> 标签：c++, multithreading, static-members

我有一个使用静态成员变量作为标志的类。该程序是多线程的，并且对静态变量值的更改不会在线程之间一致地进行通信。

代码如下所示：

MyClass.h 文件：

```
class MyClass 
{
private:
    void runLoop();
    static bool shutdownRequested;
}; 
```

MyClass.cpp 文件：

```
bool MyClass::shutdownRequested = false;  // static variable definition

void MyClass::runLoop()
{
    // much code omitted 

    if (isShutdownNecessary() && !shutdownRequested)
    {
        shutdownRequested = true;  // Race condition, but that's OK
        MyLog::Error("Service shutdown requested");
        // more code omitted
    }
} 
```

我预计上面显示的日志行可能只出现一次，但由于竞争条件，理论上每个线程可能出现一次。（在我的情况下，竞争条件是可以接受的。）但是，我看到日志行每个线程出现了几十次。我可以说出来，因为 MyLog 类还记录每个日志行的线程 ID、进程 ID 等。

到目前为止，我只在 Windows 发布版本中观察到了这个问题。我还没有在 Windows 调试版本或 Linux 版本中观察到它。

由于在多核处理器的不同内核上运行不同的线程，我可以理解每个线程查看一次日志行。我很惊讶地看到相同的线程一遍又一遍地执行日志行。

任何人都可以阐明可能导致这种情况发生的特定机制，以及我可以做什么（例如同步）来强制更新静态变量的值以被识别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T00:30:50.460

一般来说， “比赛没问题”**从来都不**是真的。定义为同时写入和读取普通变量的数据竞争在我知道的每个线程模型（包括 Visual C++、POSIX 线程和 C++11）下都是**未定义的行为。**

也就是说，由于您提到您使用的是 Visual C++，因此您可以避免将共享变量声明为“volatile”。 [微软的文档说](http://msdn.microsoft.com/en-us/library/12a04hfd.aspx)：

> 当使用 /volatile:ms 编译器选项时（默认情况下，当针对 ARM 以外的体系结构时）编译器生成额外的代码来维护对 volatile 对象的引用之间的顺序，以及维护对其他全局对象的引用的顺序。尤其：
> 
> 对 volatile 对象的写入（也称为 volatile 写入）具有 Release 语义；也就是说，在指令序列中写入易失性对象之前发生的对全局或静态对象的引用将发生在已编译二进制文件中的易失性写入之前。
> 
> 对 volatile 对象的读取（也称为 volatile 读取）具有 Acquire 语义；也就是说，在指令序列中读取易失性存储器之后发生的对全局或静态对象的引用将发生在编译二进制文件中的易失性读取之后。
> 
> 这使得 volatile 对象可以用于多线程应用程序中的内存锁定和释放。

这至少使行为定义明确。从多个线程都可以记录消息的意义上讲，您仍然存在竞争条件，但这不是“未定义行为”意义上的“数据竞争”。

至于为什么线程可能不会“看到自己的更新”，如果没有同步，线程可能会“推测性地存储”到地址以获得性能。也就是说，编译器可能会发出如下代码：

```
bool tmp = shutdownRequested;
shutdownRequested = true;
if (isShutdownNecessary() && !tmp)
{
    MyLog::Error("Service shutdown requested");
    // more code omitted
}
else
    shutdownRequested = false; 
```

这对于单线程程序来说是合法的转换，只要编译器能证明`isShutdownNecessary()`不访问`shutDownRequested`. 编译器（或 CPU）可能认为这个推测版本更快。但是在多线程的情况下，它可能会导致您看到的行为。拆机肯定会让你知道...

这种推测性的执行往往会在每一代编译器和 CPU 中变得更加激进，这是“数据竞争”非常具体地调用未定义行为的原因之一。如果您的代码有任何机会存活到下周之后，您只是不想去那里。

该`volatile`声明将阻止 Visual Studio 进行这种转换。但是跨平台解决此问题的唯一方法是使用互斥锁进行适当的锁定（如果这是一个繁忙的循环，可能还有一个条件变量）。这些细节在 C++11 之前的平台之间有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T23:55:23.307

最简单的解决方案可能是将变量声明为静态 volatile bool。volatile 声明将阻止编译器进行任何类型的导致变量被缓存的优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:09:56.397

你可能想要一个互斥+共享变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T07:10:03.170

如果您不能使用 boost 或 C++11 中的任何原子特性，那么您可以使用读/写锁来避免竞争条件。这应该有助于减少互斥锁可能发生的锁定争用。当您有很多读取和偶尔（很少）写入时，读/写锁对您的情况特别有用，因为可能有多个同时读取。至于写，一次只能有一个，这和读也是互斥的。

在 Linux 中，可以使用 pthread_rwlock_t 获得读/写锁，在 Windows 中，这里有两个参考：

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa904937(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa904937(v=vs.85).aspx)

[http://www.codeproject.com/Articles/16411/Ultra-simple-C-Read-Write-Lock-Class-for-Windows](http://www.codeproject.com/Articles/16411/Ultra-simple-C-Read-Write-Lock-Class-for-Windows)

# java - 为什么我会得到 NullPointerException？

> ID：12591804
> 
> 赞同：0
> 
> 时间：2012-09-25T22:08:02.547
> 
> 标签：java, arrays, nullpointerexception

我正在制作的程序中有问题，我无法弄清楚问题是什么。我做了几个较小的测试类来尝试找出问题所在，但我不明白。我确信这是关于数组如何工作的一些基本知识，但我似乎不记得是什么。所以我在这里发布课程，希望你们知道什么是错的。谢谢！

```
public class Main {

    public static void main(String[] args) {
        TestArray t = new TestArray(8);
        t.set(1, 15);
        t.print();
    }

}

public class TestArray {
    private Word[] a;

    public TestArray(int i){
        a = new Word[i];
    }

    public void set(int pos, long value){
        a[pos].set(value);
    }

    public void print(){
        for(Word w : a){
            System.out.println(w);
        }
    }
}

public class Word {
    private long value;

    public Word(long value){
        this.value = value;
    }

    public void set(long value){
        this.value = value;
    }

    public String toString(){
        return String.valueOf(value);
    }
} 
```

当我尝试执行 t.set(1,15) 错误时，Eclipse 说该行有问题： a[pos].set(value);

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:10:08.660

您没有初始化变量的实际*元素。*`Word[] a`如果它们在您的`TestArray.set`方法中为空，请初始化它们。

```
if (a[pos] == null)
    a[pos] = new Word(value);
else 
    a[pos].set(value); 
```

Java 中的对象数组的值被初始化为`null`，这与原始数组的初始化方式相反（全零或等价物）。因此，当您通过 创建数组时`new Word[i]`，实际上是在创建一个`null`元素数组，您必须相应地设置它们。

在 set 方法中执行此操作可确保您不会创建任何未使用的`Word`对象。这称为[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)。另一种方法是将它们全部初始化为构造函数中的某个默认值：

```
public TestArray(int i){
    a = new Word[i];
    for (int index = 0; index < i; index++) {
        a[index] = new Word(0); // Or some other default besides 0, like -1
    }
} 
```

**根据您的评论：**

> 这似乎是最好的方法，但我实际上尝试这样做：（for-each 代码）。在问这里之前，那是行不通的。为什么？

你的代码：

```
public TestArray(int i) {
    a = new Word[i];
    for(Word w:a) {
        w = new Word(0);
    }
} 
```

不起作用，因为`w`它不是*实际*的参考`a[index]`。在数组上的 for-each 循环中，您的代码在编译时实际上是这样做的：

```
for (int $i = 0; $i < a.length; $i++) { 
    Word w = a[$i];
    w = new Word(0);
} 
```

如您所见，您正在为局部变量 分配一个值`w`，而不是为 中的实际元素分配一个值`a`，因此不会更改数组。一句话：不要被`$`变量抛弃，因为 1)`$`在 Java 变量名中是合法的（尽管你永远不应该明确地使用它们）和 2) Java 在编译你的代码时会生成这些变量（可以在适当的调试器）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-25T22:09:27.220

您分配了一个数组，但在访问元素之前您没有在数组元素中放置任何内容。

```
a[pos].set(value); 
```

尝试访问 a[pos] 中的任何内容，它为空。

您需要遍历数组，为每个数组元素分配一个新的 TestArray 实例。

# c - 在稀疏图（矩阵）的表示中查找元素（邻居）

> ID：12591805
> 
> 赞同：1
> 
> 时间：2012-09-25T22:08:06.580
> 
> 标签：c, sparse-matrix

我有一个大型稀疏图，我将其表示为邻接矩阵（100k x 100k 或更大），存储为边数组。具有（非稀疏）4 x 4 矩阵的示例：

```
0 7
4 0

example_array = [ [7,1,2], [4,2,1] ] 
```

例如 [4,1,2] 表示从节点 1 到节点 2 有一条有向边，其值/权重为 4。在矩阵术语中，这本质上是 [值、行、列]。

此外，这个“边数组”将按第一个元素排序。在上面的例子中，经过排序，数组变成了，

```
example_array = [ [4,2,1], [7,1,2] ] 
```

**问题**

对于某个值`i`，需要在这个排序的“边数组”中找到第二个值等于 的所有元素`i`。即找到`j`这样的`example_array[j][1] = i`。

我对此的初步实现是简单地迭代数组中的所有元素，将每个元素的第二个值与`i`. 这在计算上是昂贵的，因为可能仍然有很多（例如 500k）元素需要循环。

**问题**

有没有更有效的方法来做到这一点？我不介意使用矩阵/图形的不同表示。我正在用 C 写这个。

**附加信息**

这本质上是找到一个节点的所有邻居`i`，以及它们的边权重。即从边列表中查找`i`到另一个节点的所有有向边。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T08:01:46.107

为此，您可能应该使用稀疏压缩行存储。简而言之，您逐行存储矩阵，因此您不需要保留两个（行，列）索引。相反，您保留一个行指针，即一个数组，它告诉您给定行在内存中的起始位置。然后你保留列向量 (col_ind)，它告诉你非零列在该行中的位置，并存储相应的值 (val)。这减少了存储需求，但也加快了矩阵搜索，因为每一行的 col_ind 都是排序的。因此，您可以直接访问每个矩阵行，并且可以使用二分法或您选择的任何其他排序列表搜索快速定位每行中的条目。

CRS 矩阵可以通过插入排序列表来快速创建，例如，如果您已明确构造每个矩阵条目的 (i,j) 坐标，则可以使用桶排序。在 MATLAB 中，您可以使用“稀疏”函数来执行此操作。如果您不想自己编写代码并需要一个库，请查看[Tim Davis 的 SuiteSparse](http://www.cise.ufl.edu/research/sparse/SuiteSparse/)。

有关 CRS 格式的简要说明，请查看[此处](http://web.eecs.utk.edu/~dongarra/etemplates/node373.html)，但还有数以千计的其他来源。

**编辑**您可以使用修改后的 CRS 存储轻松完成您需要的操作。首先，您需要通过按值而不是按列索引对每行中的列进行排序来创建矩阵，这通常是这样做的。这意味着每行的最小值存储为每行中的第一个条目。然后，为了找到全局最小值，您搜索所有行的第一个条目（O(n) 复杂度）。知道通过读取包含最小值的行中的第一列索引，您可以在恒定时间内获得相应的列索引。您可以做到所有这些，因为您可以通过行指针知道行在内存中的起始位置。

你可以看看[这段代码](http://sourceforge.net/projects/milamin/files/)。它是一组用 C 实现的 matlab 的 mex 文件。您感兴趣的是 sparse_create_mex.c。它通过将 (i, j, value) 迭代添加到排序列表中来创建稀疏矩阵结构。您需要稍微修改排序列表 - 现在它们是为整数列索引和双精度值实现的。由于排序列表是作为宏模板实现的，因此您只需要声明一个新的排序列表类型（参见 sorted_list.h 和 sorted_list_templates.h）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:14:35.140

如果您不介意更改表示，那么如果您按第二个元素排序，那么计算密集度会降低，因为这样您就可以逐步完成，一旦您发现一个大于 i 的元素，您就可以完成。在最坏的情况下，最好的算法是 O(n)，但如果你按第二个元素排序，那么预计这将在 n/2 时间内运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:39:24.573

使用指针有什么问题？

```
// A list of edges emanating from one node.
typedef struct {
    int weight;    
    int nodeId;    // The target node
    Edge *next;    // Next edge in the list
} Edge;

typedef struct {
    int nodeId;
    Edge *edges;   // This node's edge list
} Node;

// Now just store all your nodes in an array
Node *example_array[MAX_NODES]; 
```

`edges`当你在一个节点上插入一条边时，你会按重量在它的列表上进行有序插入。现在，要回答有关查找从某个节点开始的所有边的问题，您只需在数组中查找该节点并遍历其边列表。好处是您可以按排序顺序访问其边缘，而无需搜索图表的任何其他部分。

# java - 是否可以更改 Java 的 NullPointerException 以报告哪个变量为空？

> ID：12591806
> 
> 赞同：3
> 
> 时间：2012-09-25T22:08:24.570
> 
> 标签：java, nullpointerexception

在`NullPointerException`Java 中似乎只报告它发生在特定的代码行上。如果一行代码中使用了多个变量，是否可以更改该异常以声明哪个变量为空？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:23:27.847

No, the debug information in the class file does not contain enough information to allow this.

You can, however, improve on the situation. There are two things that can cause a NPE to be thrown:

*   A `.` dereferencing a variable, like `foo.bar()`.
*   A `[` indexing an array, like `args[0]`.

If you write your code so there is only *one* of these on a given code line, there is simply no doubt about which one caused the NPE. It will introduce a *lot* of temporary variables but then you have more information readily available when debugging.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T22:16:57.740

不。 NullPointerException 并不总是由变量/标识符引起`null`。例如`throw new NullPointerException()`和`throw null`。虽然经常出现这种情况，但并不是严格要求的。

在大多数情况下，导致 NPE 的原因是相当明显的。如果没有，那么您可能在一行代码中发生了太多事情。

考虑这个用例：

```
foo.doWork(bar1, bar2, bar3); 
```

这里很明显`foo`是`null。

另一个案例：

```
foo.doWork(bar.get(), bar2.get()) 
```

这里可能是`foo`, `bar`, 或`bar2`.

The point is, that armed with this information and a breakpoint, it should be obvious what was `null`. If worse comes to worse, a static code analyzer like `FindBugs` could also give you some hints.

# wpf - 与 ItemSource 和 ItemTemplate 的 ComboBox 绑定场景

> ID：12591807
> 
> 赞同：0
> 
> 时间：2012-09-25T22:08:28.150
> 
> 标签：wpf, data-binding, combobox

我在我的应用程序中定义了 MVVM 架构。所有数据上下文都已正确初始化。考虑 ComboBox 的绑定情况：

```
<Grid>
 <Grid.Resources>
  <DataTemplate x:Key="MyDataTemplate">
   <StackPanel Orientation="Horizontal">
    <Border Padding="5">
     <TextBlock Text="{}"/>      <===============================
    </Border>
   </StackPanel>
  </DataTemplate>
 </Grid.Resources>
 <ComboBox Itemsource=EmployeeNames ItemTemplate=MyDataTemplate/>
</Grid> 
```

ComboBox 绑定到字符串名称“EmployeeNames”的 ObservableCollection。

数据模板中定义的文本框中的数据绑定表达式应该是什么，以便显示字符串（代表员工）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:12:58.680

{Binding} 将绑定到当前数据上下文。:) 所以，答案是

```
<TextBlock Text="{Binding}"/> 
```

# mysql - MySQL 到 MS Access

> ID：12591809
> 
> 赞同：0
> 
> 时间：2012-09-25T22:08:42.820
> 
> 标签：mysql, vb.net, ms-access

一段时间以来，我们一直在从远程 MS Access 数据库中检索数据，并使用简单的 SELECT * INTO 查询将其内容复制到本地 Access DB。但是，我们目前处于迁移过程中，需要从 MySQL 数据库中检索数据并将其复制到本地 Access DB，因此上述查询由于显而易见的原因在这里不起作用。

现在看到我不能使用任何外部程序并且只允许在 VB.NET 中编写，我传输数据的方法是使用数据表。它完成了它的工作，但性能很糟糕。

因此，我的问题是，是否有一种仅使用 VB.NET 将数据从远程 MySQL 数据库传输/复制到本地 MS Access 的快速方法。

我当前的代码：pastebin.com/ELmkVFSc

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T00:27:56.677

非常粗略：

```
Imports Microsoft.Office.Interop.Access.Dao

Module Module1

    Sub Main()
        Dim dbEng As New DBEngine()
        Dim ws As Workspace
        Dim db As Database
        ws = dbEng.CreateWorkspace("", "admin", "", WorkspaceTypeEnum.dbUseJet)
        db = ws.OpenDatabase("z:\\docs\\test.accdb", False, False, "")
        db.Execute("SELECT * INTO Newtable From [ODBC;DSN=MySQL;].test")

    End Sub

End Module 
```

您还可以对这些行进行查询：

```
SELECT * INTO Newtable FROM
[ODBC;Driver={MySQL ODBC 5.1 Driver};Server=127.0.0.1;Database=test;User=usr;Password=pwd;CLIENT_MULTI_RESULTS;Option=3;].test; 
```

# xamarin.ios - 如何在旧版模拟器中运行应用程序

> ID：12591816
> 
> 赞同：6
> 
> 时间：2012-09-25T22:09:15.070
> 
> 标签：xamarin.ios, monodevelop, ios6, ios5

我想知道如何在以前版本的 iPhone 模拟器中运行 iPhone 应用程序。

我有 Mountain Lion，最新的 xcode 4.5 和最新的 monotouch 和 monodevelop。

我曾尝试下载较旧的 xcode 和 iOS 5.1 sdk，但不确定如何让 monodevelop 在较旧的模拟器中运行应用程序。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-26T00:09:25.087

MonoDevelop 将使用您在**SDK 位置**首选项（MD）中提供的 Xcode 版本。默认情况下，它将使用`/Application/Xcode`

从这个版本的 Xcode，例如 4.5，你可以下载额外的 iOS 模拟器。为此，您进入**Xcode**菜单**Preferences**，选择**Downloads**选项卡，选择**Components**并单击**Install**按钮（例如对于 iOS 5.1 Simulator）。

重新启动 MonoDevelop，它应该会选择额外的模拟器目标。

要查看/更改它们，请转到 (MD) **Project**菜单并选择**iPhone Simulator Target**。您应该会看到所有可用 iOS 版本的列表（从**Default**开始）（其中一项用于**iPhone**，一项用于**iPad**）。

选择您想要的并运行（或调试）您的应用程序...

# mysql - MySQL：在 ORDER 之后返回 X ID 以下的行？

> ID：12591821
> 
> 赞同：1
> 
> 时间：2012-09-25T22:09:29.347
> 
> 标签：mysql

我目前正在使用以下代码：

```
SELECT at.article_id, art.datetime, Count(at.article_id) AS common_tagged_art
FROM article_tags AS at INNER JOIN articles AS art ON at.article_id = art.article_id
WHERE at.tag_id = 4 OR at.tag_id = 3 OR at.tag_id = 1
GROUP BY at.article_id
ORDER BY common_tagged_art DESC, art.datetime DESC 
```

这几乎返回了我需要的确切结果集，如下所示：

```
+-----------+---------------------+-------------+
| article_id| datetime            | common_tags |
+-----------+---------------------+-------------+
|     23    | 2012-09-25 15:37:25 |      3      |
+-----------+---------------------+-------------+
|     24    | 2012-09-25 15:37:24 |      3      |
+-----------+---------------------+-------------+
|     27    | 2012-09-25 15:37:23 |      3      |
+-----------+---------------------+-------------+
|     30    | 2012-09-25 15:37:22 |      3      |
+-----------+---------------------+-------------+
|     21    | 2012-09-25 15:37:21 |      3      |
+-----------+---------------------+-------------+ 
```

我需要调整我的查询，以便能够确定 article_id 24 位于我返回的结果的第二行，然后我需要它返回第二行以下的所有内容。

如果子查询中有 100 行，并且我确定 article_id 24 在第 49 行，我需要查询返回第 50-100 行。我不确定这在 MySQL 中是否可行，或者根据我的原始查询，它是否更适合在 PHP 中执行。

到目前为止，我所拥有的内容类似于以下内容，只是，在子查询之后我不知所措。

```
SELECT article_id, datetime, common_tags
FROM (
  SELECT at.article_id, art.datetime, Count(at.article_id) AS common_tags
  FROM article_tags AS at INNER JOIN articles AS art ON at.article_id = art.article_id
  WHERE at.tag_id IN (4,3,1)
  GROUP BY at.article_id
  ORDER BY common_tags DESC, art.datetime DESC
) at1
//IDENTIFY which row article_id X is on in at1
//GET any row below row X in at1 
```

如果不是因为所有列都没有静态顺序，这将不是问题。

任何意见，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T15:43:42.147

我将在此处发布此内容，以供其他寻找类似问题答案的人使用。我最终不得不使用临时表，结果证明它的速度快了大约一半。

我创建了一个临时表，其中包含具有新的、临时的、自动递增的 id 的所有结果，以便我可以使用 ">" 运算符。

```
CREATE TEMPORARY TABLE at_results (
id INTEGER(10) NOT NULL AUTO_INCREMENT PRIMARY KEY,
article_id INTEGER(10) NOT NULL,
datetime DATETIME NOT NULL,
common_tags INTEGER NOT NULL)
SELECT at.article_id, art.datetime, Count(at.article_id) AS common_tags
FROM article_tags AS at 
INNER JOIN articles AS art ON at.article_id = art.article_id
WHERE at.tag_id IN (4,3,1)
GROUP BY at.article_id
ORDER BY common_tags DESC, art.datetime DESC; 
```

然后我在临时表中创建了另一个临时表，其中只有我需要的文章的 id。这是在另一个表中，因为我发现 MySQL 不允许您多次引用临时表。这是一个已知的错误。

```
CREATE TEMPORARY TABLE results_article
SELECT id
FROM at_results
WHERE article_id = 23; 
```

然后我就拉出所有 AI id 高于目标文章的文章。

```
SELECT at_results.id,article_id, datetime, common_tags
FROM at_results, at_article
WHERE at_results.id > results_article.id 
```

这将返回我所追求的确切结果。我希望这对其他人有帮助。由于对 MySQL 不是那么精通，所以我花了一些时间才偶然发现它。

只是作为一个说明，我不完全确定这是否是最有效的方法。据我所知，它非常活泼。具有更多 SQL 经验的人将能够告诉您这是否适用于所有情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:18:25.600

我不认为这会非常有效：

```
SELECT at.article_id
     , art.datetime
     , COUNT(at.article_id) AS common_tagged_art
FROM article_tags AS at 
  INNER JOIN articles AS art 
    ON at.article_id = art.article_id
WHERE at.tag_id IN (4, 3, 1)
  AND at.article_id <> 23                         --- parameter: 23
GROUP BY at.article_id
HAVING (COUNT(at.article_id), art.datetime) <=
       ( SELECT COUNT(at2.article_id), art2.datetime
         FROM article_tags AS at2
           INNER JOIN articles AS art2 
             ON at2.article_id = art2.article_id
         WHERE at2.tag_id IN (4, 3, 1)
           AND at2.article_id = 23                 --- parameter: 23
       )
ORDER BY common_tagged_art DESC
       , art.datetime DESC ; 
```

# apache - 带有偶然性博客的 Apache rewriterule 不起作用

> ID：12591826
> 
> 赞同：0
> 
> 时间：2012-09-25T22:09:51.510
> 
> 标签：apache, .htaccess, mod-rewrite

我正在使用 serendipity weblog 并希望在 apache htaccess 文件中创建一个重写器，当 /info 在浏览器中打开时，它会打开 /index.php?/categories/1-Info 。

我尝试了以下重写：

```
RewriteRule ^info index.php?/categories/2-Info [L] 
```

它不起作用。当我将替换更改为其他内容（例如[http://www.google.com](http://www.google.com)）时，它确实会出现在那里，因此该模式应该可以工作，但它并没有向我显示我想看到的偶然性类别。但是，当我手动输入地址时，地址确实有效。

我阅读了十几个带有指南的网页，并使用“http://martinmelin.se/rewrite-rule-tester/”来验证我的重写规则，但我仍然无法让它工作。不幸的是，我也看不到或设置任何日志记录。

我该如何更改重写？

编辑：

我的 .htaccess 文件如下所示：

```
# BEGIN s9y
ErrorDocument 404 /data/script/index.php
DirectoryIndex /data/script/index.php
Options -MultiViews

RewriteEngine On
RewriteBase /data/script/
RewriteRule ^info index.php?/categories/2-Info [L]

<Files *.tpl.php>
    deny from all
</Files>

<Files *.tpl>
    deny from all
</Files>

<Files *.sql>
    deny from all
</Files>

<Files *.inc.php>
    deny from all
</Files>

<Files *.db>
    deny from all
</Files>

# END s9y 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T09:48:23.917

`R`尝试通过添加标志来强制外部重定向：

```
RewriteRule ^info index.php?/categories/2-Info [L,R] 
```

# android - 在列表视图中的 ViewHolder 上时程序崩溃

> ID：12591830
> 
> 赞同：0
> 
> 时间：2012-09-25T22:10:14.420
> 
> 标签：android, android-layout, android-listview

我在下面粘贴了我的代码，这个概念是我有 3 种不同类型的列表视图项，可以被查看器类看到。现在，当我滚动列表视图时，它崩溃了，`freeTextHolder = (ViewHolderFreeText) rowView.getTag();`因为它`_position`与所需的位置对象不匹配，`itemList`这表明它的 a`"free text"`是`if (itemList.get(_position).getType().compareTo(Question.TYPE_CATEGORY) == 0)`真的，但`rowView.getTag()`显示了它的复选框，所以`_position`1 增加了所需的位置，然后它崩溃了。

```
 @Override
public View getView(final int _position, View _convertView,
        ViewGroup _parent) {

    View rowView = _convertView;
    if (itemList.get(_position).getType().compareTo(Question.TYPE_CATEGORY) == 0) {
        ViewHolderBranch branchHolder = new ViewHolderBranch();

        // Compartment for Branch
        if (rowView == null) {
            LayoutInflater inflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            rowView = inflater.inflate(R.layout.listview_branch, _parent,
                    false);

            branchHolder.hTextTitle = (TextView) rowView
                    .findViewById(R.id.textTitleB);
            branchHolder.hTextDetail = (TextView) rowView
                    .findViewById(R.id.textDetailB);
            branchHolder.hIcon = (ImageView) rowView
                    .findViewById(R.id.imageArrow);

            rowView.setTag(branchHolder);
        } else {

            branchHolder = (ViewHolderBranch) rowView.getTag();
        }

        branchHolder.hTextTitle.setText(itemList.get(_position).getText());
        if (itemList.get(_position).isIsReadCode())
            branchHolder.hTextDetail.setText(itemList.get(_position)
                    .getReadCode());
        else
            branchHolder.hTextDetail.setText(" ");
        branchHolder.hIcon
                .setImageResource(android.R.drawable.ic_media_play);

        // return rowView;
    }

    else if (itemList.get(_position).getType()
            .compareTo(Question.TYPE_CHECKBOX) == 0) {
        // Compartment for Checkboxes

        ViewHolderCheckbox checkboxHolder = new ViewHolderCheckbox();

        // Compartment for Branch
        if (rowView == null) {
            LayoutInflater inflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            rowView = inflater.inflate(R.layout.listview_checkbox, _parent,
                    false);

            checkboxHolder.hTextTitle = (TextView) rowView
                    .findViewById(R.id.textTitleCB);
            checkboxHolder.hTextDetail = (TextView) rowView
                    .findViewById(R.id.textDetailCB);
            checkboxHolder.hCheckBox = (CheckBox) rowView
                    .findViewById(R.id.checkBox);
            rowView.setTag(checkboxHolder);
        } else {

            checkboxHolder = (ViewHolderCheckbox) rowView.getTag();
        }

        checkboxHolder.hTextTitle
                .setText(itemList.get(_position).getText());
        if (itemList.get(_position).isIsReadCode())
            checkboxHolder.hTextDetail.setText(itemList.get(_position)
                    .getReadCode());
        else
            checkboxHolder.hTextDetail.setText(" ");
        checkboxHolder.hCheckBox.setChecked(itemList.get(_position)
                .isChecked());

        // return rowView;

    }

    if (itemList.get(_position).getType().compareTo(Question.TYPE_FREETEXT) == 0) {
        ViewHolderFreeText freeTextHolder = new ViewHolderFreeText();

        // Compartment for Branch
        if (rowView == null) {
            LayoutInflater inflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            rowView = inflater.inflate(R.layout.listview_button, _parent,
                    false);

            freeTextHolder.hTextTitle = (TextView) rowView
                    .findViewById(R.id.textTitleBtn);
            freeTextHolder.hTextDetail = (TextView) rowView
                    .findViewById(R.id.textDetailBtn);
            freeTextHolder.hIcon = (ImageView) rowView
                    .findViewById(R.id.imagePlusBtn);

            rowView.setTag(freeTextHolder);
        } else {

            freeTextHolder = (ViewHolderFreeText) rowView.getTag();
        }

        freeTextHolder.hTextTitle.setText(itemList.get(_position).getText());
        if (itemList.get(_position).isIsReadCode())
            freeTextHolder.hTextDetail.setText(itemList.get(_position)
                    .getReadCode());
        else
            freeTextHolder.hTextDetail.setText(" ");
        freeTextHolder.hIcon
                .setImageResource(android.R.drawable.ic_input_add);

        // return rowView;
    }

    return rowView;
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return itemList.size();
}

@Override
public Object getItem(int _position) {
    // TODO Auto-generated method stub
    return _position;
}

@Override
public long getItemId(int _position) {
    // TODO Auto-generated method stub
    return _position;
} 
```

并且视图持有者类是

静态类 ViewHolderBranch { TextView hTextTitle; 文本视图 hTextDetail; ImageView hIcon; }

```
static class ViewHolderFreeText
{
    TextView hTextTitle;
    TextView hTextDetail;
    ImageView hIcon;
}

// View Holder for Checkbox Items
/**
 * Class for holding different view items
 * 
 */
static class ViewHolderCheckbox {
    TextView hTextTitle;
    TextView hTextDetail;
    CheckBox hCheckBox;
} 
```

痕迹

```
 09-23 15:36:29.105: D/AndroidRuntime(8908): Shutting down VM 09-23 15:36:29.105: W/dalvikvm(8908): threadid=1: thread exiting with
 uncaught exception (group=0x40014760) 09-23 15:36:29.326:
 E/AndroidRuntime(8908): FATAL EXCEPTION: main 09-23 15:36:29.326:
 E/AndroidRuntime(8908): java.lang.ClassCastException:
 com.techmelo.ws.CustomizeLViewAdapter$ViewHolderBranch cannot be cast
 to com.techmelo.ws.CustomizeLViewAdapter$ViewHolderFreeText 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 com.techmelo.ws.CustomizeLViewAdapter.getView(CustomizeLViewAdapter.java:157)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.widget.AbsListView.obtainView(AbsListView.java:1943) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.widget.ListView.makeAndAddView(ListView.java:1756) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.widget.ListView.fillDown(ListView.java:656) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.widget.ListView.fillGap(ListView.java:620) 09-23 15:36:29.326:
 E/AndroidRuntime(8908):    at
 android.widget.AbsListView.trackMotionScroll(AbsListView.java:4350)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.widget.AbsListView.onTouchEvent(AbsListView.java:2892) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.widget.ListView.onTouchEvent(ListView.java:3566) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.View.dispatchTouchEvent(View.java:4600) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1488)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1256) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1494)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1269) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1700)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1270)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.app.Activity.dispatchTouchEvent(Activity.java:2277) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1680)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2272) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.view.ViewRoot.handleMessage(ViewRoot.java:1958) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.os.Handler.dispatchMessage(Handler.java:99) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 android.os.Looper.loop(Looper.java:126) 09-23 15:36:29.326:
 E/AndroidRuntime(8908):    at
 android.app.ActivityThread.main(ActivityThread.java:3997) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 java.lang.reflect.Method.invokeNative(Native Method) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 java.lang.reflect.Method.invoke(Method.java:491) 09-23 15:36:29.326:
 E/AndroidRuntime(8908):    at
 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
 09-23 15:36:29.326: E/AndroidRuntime(8908):    at
 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599) 09-23
 15:36:29.326: E/AndroidRuntime(8908):  at
 dalvik.system.NativeStart.main(Native Method) 09-23 15:36:39.334:
 W/ActivityThread(9001): Application com.techmelo.ws is waiting for the
 debugger on port 8100... 09-23 15:36:39.345: I/System.out(9001):
 Sending WAIT chunk 09-23 15:36:39.364: I/dalvikvm(9001): Debugger is
 active 09-23 15:36:39.554: I/System.out(9001): Debugger has connected
 09-23 15:36:39.554: I/System.out(9001): waiting for debugger to
 settle... 09-23 15:36:39.808: I/System.out(9001): waiting for debugger
 to settle... 09-23 15:36:40.014: I/System.out(9001): waiting for
 debugger to settle... 09-23 15:36:40.216: I/System.out(9001): waiting
 for debugger to settle... 09-23 15:36:40.416: I/System.out(9001):
 waiting for debugger to settle... 09-23 15:36:40.647:
 I/System.out(9001): waiting for debugger to settle... 09-23
 15:36:40.884: I/System.out(9001): waiting for debugger to settle...
 09-23 15:36:41.085: I/System.out(9001): waiting for debugger to
 settle... 09-23 15:36:41.299: I/System.out(9001): waiting for debugger
 to settle... 09-23 15:36:41.524: I/System.out(9001): waiting for
 debugger to settle... 09-23 15:36:41.755: I/System.out(9001): debugger
 has settled (1390) 09-23 15:36:42.994: D/dalvikvm(9001): GC_FOR_ALLOC
 freed 63K, 4% free 6386K/6599K, paused 45ms 09-23 15:36:43.004:
 I/dalvikvm-heap(9001): Grow heap (frag case) to 6.820MB for
 513744-byte allocation 09-23 15:36:43.284: D/dalvikvm(9001):
 GC_CONCURRENT freed <1K, 4% free 6888K/7111K, paused 29ms+2ms 09-23
 15:36:46.084: V/TLINE(9001): new: android.text.TextLine@40719db0 09-23
 15:36:47.904: V/TLINE(9001): new: android.text.TextLine@4072b720 09-23
 15:37:11.404: D/dalvikvm(9001): threadid=1: still suspended after undo
 (sc=1 dc=1) 09-23 15:37:11.414: D/dalvikvm(9001): GC_CONCURRENT freed
 117K, 4% free 7263K/7495K, paused 13ms+8ms 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T02:57:14.627

发生异常是因为您的不同代码分支（针对不同类型的行）可能都在处理一个重复使用的行视图，该行视图具有与之关联的任何类型的标记对象。

最好的解决方案是覆盖`Adapter`'s`getItemViewType(int)`和`getViewTypeCount()`方法以指定您拥有多少种不同类型的项目视图并将它们映射到列表位置。这将简化您的逻辑，`getView(...)`并让`ListView`不同视图类型以不同方式处理行回收池。

您可以将测试更改`getView(...)`为：

```
if (getItemViewType(_position) == TYPE_CATEGORY) {
   // code for categories
} 
```

您的 Adapter 子类知道`TYPE_CATEGORY`的 an在哪里。`int`

# python - python unittest发现

> ID：12591832
> 
> 赞同：3
> 
> 时间：2012-09-25T22:10:28.300
> 
> 标签：python, unit-testing

我不明白一些东西，用 python unittest 发现。我做了这个项目：

```
project/
    __init__.py
    src/
        __init__.py
        criteria.py
    tests/
        __init__.py
        criteria_test.py 
```

为了能够知道我是否正确加载了测试，我确保自己使用下面的代码使其失败

```
# coding: utf-8
import unittest

class TestCriteria(unittest.TestCase):
    def setUp(self):
        pass
    def test_criteriaFailure(self):
        self.assertTrue(False) 
```

当我在命令行中执行命令时，我在文件项目（我的包的根目录）中，我想所有东西都可以导入。

我试过：

```
python -m unittest discover
python -m unittest discover -s tests -p '*_test.py' 
```

但它总是返回我这个输出：

```
Ran 0 tests in 0.000s

Ok 
```

我想了解如何使用此功能（我使用的是 python3.2.3），而无需下载和安装 Nose。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:16:20.117

你的`tests/__init__.py`档案里有什么吗？

我正在研究 unittest 的源代码（Python 的所有开源代码，并且非常易读——你也可以这样做:)），因为我更熟悉 Django 测试运行器，但你的`__init__.py`文件很可能应该在至少有一条看起来像这样的线：

```
from criteria_test import * 
```

# android - Android 全局菜单架构建议

> ID：12591836
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:03.620
> 
> 标签：android, android-layout

我们已经为我们的应用程序实现了一个类似 facebook 的样式菜单，它基本上允许您单击一个按钮并将视图滑动到侧面以访问隐藏在顶层视图后面的菜单。

目前，与任何典型的 Android 应用程序一样，我们将所有视图（此应用程序有很多屏幕）保存在单独的 XML 文件中。我应该注意到我们大量使用了片段。

目标是以这样一种方式抽象代码，而不是将我们的活动和片段膨胀到顶级视图，而是现在我们将它膨胀到这个顶级父级的这个子级，这将是所有的一部分我们的活动（我们所有的活动都是自定义活动的子类）。

menu.xml 的工作方式是拥有一个外部 FrameLayout，它承载一个空的嵌套子 FrameLayout。

*我们试图避免做的是将这个外部菜单代码包装在我们的每一个视图 XML 中，尽管这肯定会起作用。*

我正在尝试找到一种编程方式，将菜单代码与空的嵌套 FrameLayout 放在一个文件中。然后当我们去膨胀片段或活动的 XML 时，像这样：

```
listView = (PullToRefreshListView) inflater.inflate(R.layout.pull_to_refresh_list_view, container, false); 
```

我们不这样做，而是将其膨胀到嵌套的子 FrameLayout 中。我正在尝试这样的事情：

```
listView = (PullToRefreshListView) inflater.inflate(R.layout.pull_to_refresh_list_view, container, false);
    ((FrameLayout) getActivity().findViewById(R.id.child)).addView(listView); 
```

目前这导致：“无法恢复活动。没有为片段 MyFragment [id = 0x7f090019] 找到 id 0x7f090019 的视图”

任何输入表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:21:34.553

我为类似样式的菜单所做的是添加一个框架布局并将一个片段膨胀到其中。然后我使用 translateAnimation 和 layoutApp 将屏幕翻译到正确的位置。我将所有这些代码保存在一个slidingDrawerActivity 中，它很好地分割了代码，这样我就可以调用SlideOutMenu 来使用它

希望这会有所帮助 - 如果你想要更多的东西，请告诉我

编辑：

使用支持库用片段替换框架布局的代码

```
FragmentTransaction FT=getFragmentManager().beginTransaction();
FT.replace(R.id.yourFrameLayout, new YourFragment(), yourFragmentTag);
FT.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
FT.commit(); 
```

# jquery - Jquery 模态输入在加载数据之前出现

> ID：12591841
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:19.200
> 
> 标签：jquery, ajax, modal-dialog, loading

我正在使用 jquery Modal 打开表单和编辑数据。这些表单正在使用 Ajax（加载方法）加载。

发生的情况是带有字段的窗口显示为一个空表单，并且仅在一段时间后才加载数据。

我认为这与缓存有关。那是对的吗？我该如何解决这个问题？

这是代码：

```
var janelaModal;

$(文档).ready(函数 () {

    $('.lnkModalAddOption').each(function () {
        PrepareModal($(this), false);
    });

    $('.lnkModalAddOption').live("mouseenter", function () {
        PrepareModal($(this), false);
    });

    $(".linkAcaoModal").live("点击", function () {
        PrepareModal($(this), true);
    });

});

功能PrepareModal（objetoClick，显示）{

    idModal = "modalAddLineTable";

    var titleToShow = objetoClick.attr("Funcionalidade");
    var urlToLoad = objetoClick.attr("href");

    if ($("#" + idModal).length == 0) {
        $("#Modais").append("");
    }
    别的 {
        $("#" + idModal).html("Carregando...");
    }

    $("#" + idModal)
        .load(urlToLoad)
        。对话（{
            自动打开：假，
            高度：'自动'，
            宽度：'自动'，
            模态：真，
            标题：titleToShow
        });

    如果（显示==真）{
        ShowModal($("#" + idModal));
    }
    别的 {
        objectClick.live("点击", function () {
            ShowModal($("#" + idModal));
        });
    }
}

功能 ShowModal(objetoModal) {
    janelaModal = 对象模态；

    if (janelaModal != "") {
        janelaModal.dialog("打开");
    }
}

```

# java - Struts 2 - 未找到 /struts-tags - ClassNotFoundException

> ID：12591842
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:19.777
> 
> 标签：java, xml, jsp, tomcat, struts2

我正在尝试使 struts 2 示例正常工作，但是当我尝试在 Tomcat 中运行代码时出现以下错误。

`HTTP Status 500 - /porject/index.jsp (line: 4, column: 41) File "/struts-tags" not found`

```
type Exception report

message /porject/index.jsp (line: 4, column: 41) File "/struts-tags" not found

description The server encountered an internal error (/porject/index.jsp (line: 4, column: 41) File "/struts-tags" not found) that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: /porject/index.jsp (line: 4, column: 41) File "/struts-tags" not found
    org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:42)
    org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:408)
    org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:133)
    org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:166)
    org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:410)
    org.apache.jasper.compiler.Parser.parseDirective(Parser.java:475)
    org.apache.jasper.compiler.Parser.parseElements(Parser.java:1427)
    org.apache.jasper.compiler.Parser.parse(Parser.java:138)
    org.apache.jasper.compiler.ParserController.doParse(ParserController.java:242)
    org.apache.jasper.compiler.ParserController.parse(ParserController.java:102)
    org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:198)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:373)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:353)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:340)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:646)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:357)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

我已将以下 jar 文件包含到我的`lib`文件夹中：

```
commons-fileupload-1.2.2.jar
commons-logging-1.1.1.jar
freemarker-2.3.19.jar
ognl-3.0.5.jar
struts2-core-2.3.4.1.jar
xwork-core-2.3.4.1.jar 
```

这是我`index.jsp`声明错误的地方。

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<%@ taglib prefix="s" uri="/struts-tags" %>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Struts 2 Example</title>
</head>
<body>
<s:action name="HelloWorldAction" executeResult="true"></s:action>
</body>
</html> 
```

如果您需要发布任何其他代码，请发表评论，我会更新我的帖子。

编辑 - 现在得到一个新的错误

```
HTTP Status 500 - java.lang.ClassNotFoundException: org.apache.jsp.porject.index_jsp

type Exception report

message java.lang.ClassNotFoundException: org.apache.jsp.porject.index_jsp

description The server encountered an internal error (java.lang.ClassNotFoundException: org.apache.jsp.porject.index_jsp) that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: java.lang.ClassNotFoundException: org.apache.jsp.porject.index_jsp
    org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:177)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
root cause

java.lang.ClassNotFoundException: org.apache.jsp.porject.index_jsp
    java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    java.security.AccessController.doPrivileged(Native Method)
    java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:132)
    org.apache.jasper.servlet.JasperLoader.loadClass(JasperLoader.java:63)
    org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:172)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

# jquery - 如果类名包含在数组中，则过滤以按类隐藏 div

> ID：12591846
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:28.997
> 
> 标签：jquery, filter, multi-select

早期问题的简化版本。我正在使用 UI 多选器小部件按类别过滤产品。仅当产品的类包含与选中的复选框值匹配的值时，产品才会可见。如果只选中一个复选框，则很容易完成。

文档说我可以使用以下方法映射所有复选框的值：

```
var checkedValues = $("select").multiselect("getChecked").map(function(){
   return this.value;   
}).get(); 
```

我如何隐藏所有产品，除了谁的类与该数组中的至少一个值匹配？是否可以？这不起作用：

```
$('.main article, .error').hide();
$('.main article[class*=' + checkedValues + ']).show(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:14:54.390

一种方便的方法是获取类列表并以以下形式构造一个 CSS 选择器

```
.class1, .class2, .class3, .etc 
```

您可以使用示例中的代码非常轻松地做到这一点，并且[`Array.join`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)：

```
var selector = $("select").multiselect("getChecked")
                .map(function(){return "." + this.value; })
                .get()
                .join(); 
```

然后，您可以让 jQuery 完成繁重的工作：

```
$('.main article').filter(selector).show(); 
```

# image - 数据网格没有正确滚动图像

> ID：12591847
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:29.813
> 
> 标签：image, actionscript, datagrid

我有一个具有 itemRenderer 的数据网格。这将根据数据值在一个单元格中显示一个或两个图像。

除非我滚动网格，否则一切正常。发生的事情是图像出现在单元格中，但它们不应该出现。我已经检查以确保传递给 itemRenderer 的数据是正确的。我正在使用闪存生成器 4.6。

项目渲染器：

```
<mx:DataGridColumn headerText="" dataField="isComment" visible="true">
                        <mx:itemRenderer>
                            <fx:Component>
                                <mx:HBox height="32" horizontalAlign="center" verticalAlign="middle" horizontalScrollPolicy="off" verticalScrollPolicy="off">

                                    <fx:Script>
                                        <![CDATA[
                                            override public function set data(value:Object):void
                                            {
                                                super.data = value;

                                                if(data.isComment){
                                                    CommentImage.load("images/comment.png");
                                                }else{
                                                    CommentImage.load("");
                                                }

                                                if(data.isException){
                                                    ExceptionImage.load("images/exception.png");
                                                }else{
                                                    ExceptionImage.load("");
                                                }

                                            }
                                        ]]>
                                    </fx:Script>

                                        <mx:Image id="CommentImage" />
                                        <mx:Image id="ExceptionImage"/>

                                </mx:HBox>
                            </fx:Component>
                        </mx:itemRenderer>
                    </mx:DataGridColumn> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T12:04:32.540

我发现另一个单元格不能为空。所以我创建了一个空白（白色背景）的图像，这似乎现在可以工作，不确定它是否正确。

# xpath - Xpath 错误 - 蜘蛛错误处理

> ID：12591849
> 
> 赞同：2
> 
> 时间：2012-09-25T22:11:33.247
> 
> 标签：xpath, scrapy

所以我正在构建这个蜘蛛，它爬得很好，因为我可以登录到 shell 并浏览 HTML 页面并测试我的 Xpath 查询。

不知道我做错了什么。任何帮助，将不胜感激。我已经重新安装了 Twisted，但没有。

我的蜘蛛长这样——

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from spider_scrap.items import spiderItem

class spider(BaseSpider):
name="spider1"
#allowed_domains = ["example.com"]
start_urls = [                  
              "http://www.example.com"
            ]

def parse(self, response):
 items = [] 
    hxs = HtmlXPathSelector(response)
    sites = hxs.select('//*[@id="search_results"]/div[1]/div')

    for site in sites:
        item = spiderItem()
        item['title'] = site.select('div[2]/h2/a/text()').extract                            item['author'] = site.select('div[2]/span/a/text()').extract    
        item['price'] = site.select('div[3]/div[1]/div[1]/div/b/text()').extract()     
    items.append(item)
    return items 
```

当我运行蜘蛛时 - scrapy crawl Spider1 我收到以下错误 -

```
 2012-09-25 17:56:12-0400 [scrapy] DEBUG: Enabled item pipelines:
    2012-09-25 17:56:12-0400 [Spider1] INFO: Spider opened
    2012-09-25 17:56:12-0400 [Spider1] INFO: Crawled 0 pages (at 0 pages/min), scraped  0 items (at 0 items/min)
    2012-09-25 17:56:12-0400 [scrapy] DEBUG: Telnet console listening on 0.0.0.0:6023
    2012-09-25 17:56:12-0400 [scrapy] DEBUG: Web service listening on 0.0.0.0:6080
   2012-09-25 17:56:15-0400 [Spider1] DEBUG: Crawled (200) <GET http://www.example.com>  (refere
   r: None)
   2012-09-25 17:56:15-0400 [Spider1] ERROR: Spider error processing <GET    http://www.example.com
    s>
    Traceback (most recent call last):
      File "C:\Python27\lib\site-packages\twisted\internet\base.py", line 1178, in mainLoop
        self.runUntilCurrent()
      File "C:\Python27\lib\site-packages\twisted\internet\base.py", line 800, in runUntilCurrent
        call.func(*call.args, **call.kw)
      File "C:\Python27\lib\site-packages\twisted\internet\defer.py", line 368, in callback
        self._startRunCallbacks(result)
      File "C:\Python27\lib\site-packages\twisted\internet\defer.py", line 464, in _startRunCallbacks
        self._runCallbacks()
    --- <exception caught here> ---
      File "C:\Python27\lib\site-packages\twisted\internet\defer.py", line 551, in _runCallbacks
        current.result = callback(current.result, *args, **kw)
      File "C:\Python27\lib\site-packages\scrapy\spider.py", line 62, in parse
        raise NotImplementedError
    exceptions.NotImplementedError:

     2012-09-25 17:56:15-0400 [Spider1] INFO: Closing spider (finished)
     2012-09-25 17:56:15-0400 [Spider1] INFO: Dumping spider stats:
    {'downloader/request_bytes': 231,
     'downloader/request_count': 1,
     'downloader/request_method_count/GET': 1,
     'downloader/response_bytes': 186965,
     'downloader/response_count': 1,
     'downloader/response_status_count/200': 1,
     'finish_reason': 'finished',
     'finish_time': datetime.datetime(2012, 9, 25, 21, 56, 15, 326000),
     'scheduler/memory_enqueued': 1,
     'spider_exceptions/NotImplementedError': 1,
     'start_time': datetime.datetime(2012, 9, 25, 21, 56, 12, 157000)}
      2012-09-25 17:56:15-0400 [Spider1] INFO: Spider closed (finished)
      2012-09-25 17:56:15-0400 [scrapy] INFO: Dumping global stats:
    {} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-08-22T11:13:56.780

For everyone who faces this problem, please, make sure you didn't rename parse() method like I did:

```
class CakeSpider(CrawlSpider):
    name            = "cakes"
    allowed_domains = ["cakes.com"]
    start_urls      = ["http://www.cakes.com/catalog"]

    def parse(self, response): #this should be 'parse' and nothing else

        #yourcode# 
```

Otherwise it throws the same error:

```
...
File "C:\Python27\lib\site-packages\scrapy\spider.py", line 62, in parse
    raise NotImplementedError
    exceptions.NotImplementedError: 
```

I've spent like three hours trying to figure out -.-

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T15:14:45.870

Leo 是对的，缩进是不正确的。您可能在脚本中混合了一些制表符和空格，因为您粘贴了一些代码并自己输入了其他代码，并且您的编辑器允许在同一文件中同时使用制表符和空格。将所有制表符转换为空格，这样更像：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from spider_scrap.items import spiderItem

class spider(BaseSpider):
    name = "spider1"
    start_urls = ["http://www.example.com"]

    def parse(self, response):
        items = []
        hxs = HtmlXPathSelector(response)
        sites = hxs.select('//*[@id="search_results"]/div[1]/div')

        for site in sites:
            item = spiderItem()
            item['title'] = site.select('div[2]/h2/a/text()').extract
            item['author'] = site.select('div[2]/span/a/text()').extract
            item['price'] = site.select('div[3]/div[1]/div[1]/div/b/text()').extract()
            items.append(item)

        return items 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T18:44:22.757

您的 parse 方法不在类代码中，请使用下面提到的代码

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from spider_scrap.items import spiderItem

class spider(BaseSpider):
    name="spider1"
    allowed_domains = ["example.com"]
    start_urls = [
      "http://www.example.com"
     ]

    def parse(self, response):
        items = []
        hxs = HtmlXPathSelector(response)
        sites = hxs.select('//*[@id="search_results"]/div[1]/div')

        for site in sites:
            item = spiderItem()
            item['title'] = site.select('div[2]/h2/a/text()').extract                            item['author'] = site.select('div[2]/span/a/text()').extract
            item['price'] = site.select('div[3]/div[1]/div[1]/div/b/text()').extract()
        items.append(item)
        return items 
```

# python - 从行列表中删除一行

> ID：12591850
> 
> 赞同：0
> 
> 时间：2012-09-25T22:11:46.927
> 
> 标签：python

我正在将 csv 读入列表中，我需要在特定条件下从列表中删除整行：

```
import csv

thefile = []

def dowork():
    sourceFile='e.csv'
    CleanFile(sourceFile)

def CleanFile(sourceFile):
    global thefile
    thefile=list(csv.reader(open(sourceFile, 'rb'), delimiter=',', quotechar='"'))
    for line in thefile:
        if line[3]=='':
            #here's where i need to delete line from thefile 
```

我将如何`line`从中删除`thefile`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:14:04.567

`line`您需要within的索引`thefile`。一旦你有了它，这很容易。你得到的方法是[enumerate](http://docs.python.org/library/functions.html#enumerate)。

```
def CleanFile(sourceFile):
    global thefile
    thefile=list(csv.reader(open(sourceFile, 'rb'), delimiter=',', quotechar='"'))
    for i, line in enumerate(thefile):
        if line[3]=='':
            del thefile[i] 
```

但是，值得询问您是否真的需要删除它。例如，您可以像这样过滤掉它吗？

```
def CleanFile(sourceFile):
    global thefile
    thefile=[line for line in 
             csv.reader(open(sourceFile, 'rb'), delimiter=',', quotechar='"')) 
             if line[3] != ''] 
```

`line[3] == ''`或者，根据您对数据的处理方式，在输出或计算时跳过行可能更有意义。或者，更好的是，一开始就不要列出清单；只需将 csv.reader 保留为迭代器——然后您可以通过`itertools.ifilter`或生成器表达式在其前面添加一个过滤器。实际上，这就像更改两个字符一样简单：

```
def CleanFile(sourceFile):
    global thefile
    thefile=(line for line in 
             csv.reader(open(sourceFile, 'rb'), delimiter=',', quotechar='"')) 
             if line[3] != '') 
```

当然，如果您需要，例如随机访问`thefile`. 但是，如果您要逐行迭代它，这可能是最好的解决方案。（除了它`thefile`不应该是全局的；它应该根据需要从一个函数传递到另一个函数。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T22:18:27.557

尝试使用过滤器：

```
def CleanFile(sourceFile):
   global thefile
   thefile=list(csv.reader(open(sourceFile, 'rb'), delimiter=',', quotechar='"'))

   def f(x): return x[3] != ''
   thefile = filter(f, thefile)

   return thefile 
```

# php - 如何修改 shopping-cart.tpl 文件以禁用 ajax 风格的购物车站点并添加简单的更新按钮？

> ID：12591851
> 
> 赞同：1
> 
> 时间：2012-09-25T22:11:53.330
> 
> 标签：php, javascript, ajax, prestashop, shop

我正在尝试修改 shopping-cart.tpl 文件并禁用 ajax 样式的数量按钮。我想有一个选项来修改购物车中的产品数量，但采用老式风格（带有数量输入字段和“更新购物车”按钮）。现在它会获取每次数量变化的 JSON 数据。

我正在使用带有新 Prestashop 主题的 Prestashop 1.4.9。

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T18:46:59.257

1.  转到模块 > 模块
2.  搜索“购物车块”
3.  点击“配置”
4.  禁用“AJAX 购物车”

# c# - Linux 上的 .Net 网络服务

> ID：12591852
> 
> 赞同：4
> 
> 时间：2012-09-25T22:12:01.997
> 
> 标签：c#, .net, web-services, monodevelop

我已经在 .net 中实现了一些 Web 服务并将其托管在 Windows 服务器上，我如何将其移植到 linux 上？要在 linux 机器上拥有相同的 Web 服务，我是否必须用 Java 重写它？有任何想法吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T19:55:23.377

问题范围很广，所以这里是一个一般性的答案

如果您已经在 WCF 中实现了该服务，那么 mono（Linux 上的 .net）对它的支持有限。对于所有已知问题，请查看

[http://www.mono-project.com/WCF_Development](http://www.mono-project.com/WCF_Development)

我以前为简单的服务做过这个，没有太大问题。

如果您需要同时支持 Windows 和 Linux 上的 Web 服务，那么我可以推荐 WCF 的替代方案

[https://github.com/ServiceStack/ServiceStack](https://github.com/ServiceStack/ServiceStack)

使用它来避免移植工作。这样您就不必在 java 中重写并重用您的一些 .net 代码。

# c++ - 在 C++ 中计算家庭作业的闰年？

> ID：12591853
> 
> 赞同：5
> 
> 时间：2012-09-25T22:12:15.723
> 
> 标签：c++, leap-year

```
#include <iostream>
using namespace std;

int main() {
    int what_year;

    cout << "Enter calendar year ";
    cin >> what_year;

    if (what_year - (n * 4) = 0 ) {

        cout << "leap year";
    }

    else
    {
        cout << "wont work";
    }

    system("Pause");
    return 0;
} 
```

试图为课程制作一个程序，找到闰年..不知道如何询问 C++ 整数是否可以被数字整除？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-25T22:15:44.233

闰年规则是

```
 if year modulo 400 is 0 then
   is_leap_year
else if year modulo 100 is 0 then
   not_leap_year
else if year modulo 4 is 0 then
   is_leap_year
else
   not_leap_year 
```

[http://en.wikipedia.org/wiki/Leap_year#Algorithm](http://en.wikipedia.org/wiki/Leap_year#Algorithm)

您可以使用[模运算符](http://en.wikipedia.org/wiki/Modulo_operation)来查看一个数是否可​​以被另一个数整除，即除法是否没有余数。

> 2000 % 400 = 0 // 能被 400 整除
> 
> 2001 % 400 = 1 // 不能被 400 整除

有趣的是，一些著名的软件实现没有应用“400”部分，这导致这些系统不存在 2000 年 2 月 29 日。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-25T22:13:01.410

使用模函数。

```
if ((year % 4) == 0)
{
//leap year
} 
```

请注意，这不考虑 100 年和 400 年的跳跃。

正确的代码类似于

```
if(((year%4) == 0) && (((year%100)!=0) || ((year%400) == 0))
{
//leap year
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-25T22:14:32.980

改用这个

```
bool bLeapYear = false;
if ((what_year % 4) ==0)  {
     if ((what_year % 100) == 0) {
          bLeapYear = ((what_year % 400) == 0);
     } else {
          bLeapYear = true;
     }
     // leap year
} 
```

这需要除以 4 后一年的剩余时间，并测试它是否为零。你也有使用`=`代替的问题`==`- 后者测试相等，前者分配一个值。

编辑：根据下面史蒂夫的评论编辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-23T13:21:14.483

根据决定一年是否为闰的一些规则，一年应该能被 4 整除，对于那些能被 100 整除的年份，它也应该能被 400 整除。

```
int year;
cout << "Enter a year: ";
cin >> year;

if (year%4 == 0) {
    if (year%100 == 0) {
        if (year%400 == 0) {
            cout << year << " is a leap year.";
        }
        else {
            cout << year << " is not a leap year.";
        }
    }
    else {
        cout << year << " is a leap year.";
    }
}
else {
    cout << year << " is not a leap year.";
}

return 0;} 
```

# php - 在 PHP 中处理数组

> ID：12591855
> 
> 赞同：0
> 
> 时间：2012-09-25T22:12:15.680
> 
> 标签：php

我有一个看起来像这样的数组：

```
 array(10) {
  [0]=>
  array(2) {
    [0]=>
    string(5) "1.pdf"
    [1]=>
    string(5) "2.pdf"
  }
  [1]=>
  array(2) {
    [0]=>
    string(5) "3.pdf"
    [1]=>
    string(5) "4.pdf"
  }
  [2]=>
  array(2) {
    [0]=>
    string(5) "5.pdf"
    [1]=>
    string(5) "6.pdf"
  }
  [3]=>
  array(2) {
    [0]=>
    string(5) "7.pdf"
    [1]=>
    string(5) "8.pdf"
  }
  [4]=>
  array(2) {
    [0]=>
    string(5) "9.pdf"
    [1]=>
    string(6) "10.pdf"
  }
  [5]=>
  array(2) {
    [0]=>
    string(6) "11.pdf"
    [1]=>
    string(6) "12.pdf"
  }
  [6]=>
  array(2) {
    [0]=>
    string(6) "13.pdf"
    [1]=>
    string(6) "14.pdf"
  }
  [7]=>
  array(2) {
    [0]=>
    string(6) "15.pdf"
    [1]=>
    string(6) "16.pdf"
  }
  [8]=>
  array(2) {
    [0]=>
    string(6) "17.pdf"
    [1]=>
    string(6) "18.pdf"
  }
  [9]=>
  array(2) {
    [0]=>
    string(6) "19.pdf"
    [1]=>
    string(6) "20.pdf"
  }
} 
```

如您所见，我的 10 数组由 2 个元素组成。我需要做的是创建一个循环，如果你愿意的话，我有 3 个文件夹，我需要将 [0]array(2) 放入文件夹 A，然后放入文件夹 B 的东西 [2]array(2)然后在文件夹 C 中的东西 [4]array(2) AND HERE IS THE KICKER，然后回到文件夹 A 并将 [1] 放入文件夹 A，然后在文件夹 B 中的东西 [3]array(2) 然后在文件夹中C 填充 [5]array(2)，然后进行另一个循环。我很难理解这一点，并想知道是否有人可以为此提供一些帮助。

任何帮助/方向将不胜感激。谢谢。=。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:56:34.090

这是一种方法：

```
$arr = [ ... ]; // pretend this is your big array

for ($i = 0, $total = count($arr); $i < $total; ++$i) {
    $folder = chr(floor($i / 2) + ord('A'));

    // Here you would put elements from the sub-array $arr[$i]
    // into folder $folder
} 
```

# php - 使用 PHP 函数显示具有绝对定位的图像？

> ID：12591857
> 
> 赞同：1
> 
> 时间：2012-09-25T22:12:21.853
> 
> 标签：php, image, function, css-position

我从未使用过 PHP 的一件事是按需放置图像 - 但现在我遇到了这个问题......

我需要一个函数，给定一些 X 和 Y 坐标，使用某种形式的绝对定位在屏幕上的某处放置一个 .png 或 .gif。

恐怕我完全不知道从哪里开始寻找这些信息。对我来说，PHP 是关于显示来自数据库的数据。这对我来说是一个完全陌生的概念！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:44:06.980

也许这个例子可以帮助你开始。我使用 HTML、CSS 和 PHP

```
<?php 
/*
 * here you can define your coordinates in pixel
 */
$myXCoordinate = '100px';
$myYCoordinate = '200px';
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">    
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Your Page title</title>
  <style type="text/css">
  .absolute-pos {
    position: absolute;
    width: 160px;  /* here you could set a fixed pixel size, e.g. 200px */
    height: 160px; /* here you could set a fixed pixel size, e.g. 200px */
    left: <?php echo $myXCoordinate; ?>;
    top: <?php echo $myYCoordinate; ?>;
  }
  </style>

</head>
<body>
  <p>showing the logo of wikipedia [source: upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png]</p>
  <img class="absolute-pos" src="http://upload.wikimedia.org/wikipedia/en/b/bc/Wiki.png" alt="Some description." />
</body>
</html> 
```

复制此代码并将其保存到 php 文件中，例如“index.php”。然后更改 $myXCoordinate 和 $myYCoordinate 的值。这将改变图像的绝对位置。

# jsp - 无法加载自定义 JSP 标记处理程序类

> ID：12591858
> 
> 赞同：1
> 
> 时间：2012-09-25T22:12:27.627
> 
> 标签：jsp, jsp-tags

我正在使用 Eclipse JUNO IDE 为我的 WEB 应用程序构建自定义 JSP 标记。

但是 Eclipse 并没有在 /WEB-INF/classes 目录中为该 TagHandler 生成 .class 文件，而是为其他 java 文件生成。

这是下面的代码，如果您可以查看它。

PathTagHandler.java

```
package fna.handlers;

import java.io.IOException;

import javax.servlet.jsp.JspException;
import javax.servlet.jsp.JspTagException;
import javax.servlet.jsp.JspWriter;
import javax.servlet.jsp.tagext.TagSupport;

public class PathTagHandler extends TagSupport {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;

private String compName = null;

    private String filingYear=null;

    public String getCompName() {
        return compName;
    }
    public void setName(String aName) {
        this.compName = aName;
    }

    public String getFilingYear() {
        return filingYear;
    }
    public void setFilingYear(String aYear) {
        this.filingYear = aYear;
    }

    public int doStartTag() throws JspTagException {
        try{
            JspWriter out = pageContext.getOut();
            if(compName != null && filingYear!=null){
                out.print(get10KPath(compName, filingYear));
            }else{
                out.print("Please provide required params in the tag!!!");
            }
        }catch(IOException ioe){
            ioe.printStackTrace();
        }
        return SKIP_BODY;
    }

    private static String get10KPath(String comp, String year){

        String path="htmlDocs/";

        String compName=comp.trim().toLowerCase();

        path.concat(compName).concat("/").concat(year).concat("/").concat("10k.html");

        return path;

    }

   @Override  
   public int doEndTag() throws JspException {  
       // TODO Auto-generated method stub  
       //return super.doEndTag();  
       return EVAL_PAGE;  
   }  

} 
```

文件路径-taglib.tld

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE taglib PUBLIC "-//Sun Microsystems, Inc.//DTD JSP Tag Library 1.2//EN" 
"http://java.sun.com/dtd/web-jsptaglibrary_1_2.dtd">
<taglib>
    <tlib-version>1.0</tlib-version>
    <jsp-version>2.1</jsp-version>
    <short-name>MyLibrary</short-name>
    <uri>PathGenerator</uri> 
    <tag>
    <name>10kPath</name>
    <tag-class>fna.handlers.PathTagHandler</tag-class>
    <attribute>
      <name>compName</name>
      <required>true</required>
  </attribute>
    <attribute>
      <name>filingYear</name>
      <required>true</required>
  </attribute>
</tag>
</taglib> 
```

web.xml

```
<jsp-config> 
 <taglib>
    <taglib-uri>PathGenerator</taglib-uri>
    <taglib-location>/WEB-INF/filePath-taglib.tld</taglib-location>
 </taglib>
 </jsp-config> 
```

我得到的错误如下所述：

```
org.apache.jasper.JasperException: /Test.jsp(47,1) Unable to load tag handler class "fna.handlers.PathTagHandler" for tag "path:10kPath"
    org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)
    org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)
    org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:198)
    org.apache.jasper.compiler.Parser.parseCustomTag(Parser.java:1194)
    org.apache.jasper.compiler.Parser.parseElements(Parser.java:1418)
    org.apache.jasper.compiler.Parser.parse(Parser.java:130)
    org.apache.jasper.compiler.ParserController.doParse(ParserController.java:255)
    org.apache.jasper.compiler.ParserController.parse(ParserController.java:103)
    org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:185)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:347)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:327)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:314)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

请帮助我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-02T07:20:46.193

例如，在 tld 文件中，标记应引用 tld 文件路径，而不是 PathGenerator，它应为 /WEB-INF/Path-taglib.tld

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T07:18:48.813

检查您是否已在 jsp 中包含声明为

```
 <%@ taglib uri="PathGenerator" prefix="path" %> 
```

# hook - 控制新的 gitolite 存储库名称

> ID：12591860
> 
> 赞同：1
> 
> 时间：2012-09-25T22:12:46.027
> 
> 标签：hook, gitolite

我想在我的 gitolite 安装中添加一个钩子，以便如果`conf/gitolite.conf`文件被推送并包含一个名称不符合我的命名约定的新存储库，则推送将失败。

这可以在不破解 gitolite 内部结构的情况下完成吗？

我正在使用 gitolite 1.5.4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T17:38:33.613

另一方面，如果您谈论的是不信任*管理员*以正确的命名约定创建 repo 名称，那么您有多种解决方案和替代方案。

(1) 是否足以警告他以便他可以登录服务器、删除有问题的 repo 并再次修复配置？

如果是这样，请使用 PRE_CREATE 或 POST_CREATE 触发器（请参阅 gitolite 文档中的 triggers.html）。检查参数 2，对其进行测试，并在需要时打印一条嘈杂的消息。

(2) 如果警告不够，并且您需要彻底终止它，请使用 PRE_CREATE 触发器，除非它必须在 perl 中。使用 src/lib/Gitolite/Triggers/AutoCreate.pm 作为模型，除非你必须检查 $_[1] （第二个参数）。

(3) 您也是管理员，也许是“主要”管理员？如果是这样，请参阅委托（请参阅 gitolite 文档中的 deleg.html）。不过，这将有更多限制（例如，如果允许他添加密钥，他将简单地添加一个带有*您的*姓名的新密钥，从而绕过限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T05:49:34.690

一、升级到最新的Gitolite（1.5.4是两年多了）

其次，Gitolite 的“内部”功能允许限制基于命名的 repo 的创建称为“wild repos”（“通配符 repos”），或“用户创建的 repos”

如果可用于[Gitolite V2 或 G2](http://sitaramc.github.com/gitolite/g2/progit.html#progit_article_Wildcard_repositories__)（不确定 V1）和[Gitolite V3 或 g3](http://sitaramc.github.com/gitolite/wild.html)。

> wildrepos 功能允许您使用正则表达式模式指定访问控制规则，因此您可以通过配置文件中的一组规则来提供许多实际的 repos。
> 正则表达式模式还可以在其中包含单词 CREATOR，允许您参数化创建 repo 的用户的名称。

# json - node.js 中的 JSON Zip 响应

> ID：12591861
> 
> 赞同：7
> 
> 时间：2012-09-25T22:12:46.843
> 
> 标签：json, node.js, zip, express

我对 node.js 很陌生，我正在尝试发回一个包含 JSON 结果的 zip 文件。我一直在试图弄清楚如何做到这一点，但没有得到预期的结果。

我正在使用 NodeJS、ExpressJS、LocomotiveJS、Mongoose 和 MongoDB。

由于我们正在构建一个面向移动的应用程序，因此我正在尝试尽可能多地节省带宽。

移动应用程序的每日初始加载可能是一个很大的 JSON 文档，因此我想在将其发送到设备之前对其进行压缩。如果可能的话，我想在内存中做所有事情以避免磁盘 I/O。

到目前为止，我尝试了 3 个库：

*   管理员压缩包
*   节点压缩
*   压缩流

我取得的最好结果是使用 node-zip。这是我的代码：

```
 return Queue.find({'owners': this.param('id')}).select('name extra_info cycle qtype purge purge_time tasks').exec(function (err, docs) {
    if (!err) {
      zip.file('queue.json', docs);
      var data = zip.generate({base64:false,compression:'DEFLATE'});

      res.set('Content-Type', 'application/zip');
      return res.send(data);
    }
    else {
      console.log(err);
      return res.send(err);
    }
  }); 
```

结果是下载的 zip 文件，但内容不可读。

我很确定我把事情搞混了，但到目前为止我不知道如何继续。

有什么建议吗？

提前感谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-25T23:15:59.157

您可以使用以下命令压缩 express 3 中的输出：

```
app.configure(function(){
  //....
  app.use(express.compress());
});

app.get('/foo', function(req, res, next){
  res.send(json_data);
}); 
```

如果用户代理支持 gzip，它会自动为您 gzip。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-04-26T14:42:05.880

对于 Express 4+，compress 不与 Express 捆绑在一起，需要单独安装。

```
$ npm install compression 
```

然后使用该库：

```
var compression = require('compression');
app.use(compression()); 
```

您可以调整很多选项，[请参见此处的列表](https://www.npmjs.com/package/compression)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T22:30:27.463

我认为您的意思是如何使用节点发送 Gzip 内容？

Node 0.6 及以上版本有一个内置的[zlip](http://nodejs.org/api/zlib.html)模块，所以不需要外部模块。

您可以像这样发送 Gzip 内容。

```
 response.writeHead(200, { 'content-encoding': 'gzip' });
    json.pipe(zlib.createGzip()).pipe(response); 
```

显然，您需要首先检查客户端是否接受 Gzip 编码，并且还要记住 gzip 是一项昂贵的操作，因此您应该缓存结果。

这是从文档中获取的完整示例

```
// server example
// Running a gzip operation on every request is quite expensive.
// It would be much more efficient to cache the compressed buffer.
var zlib = require('zlib');
var http = require('http');
var fs = require('fs');
http.createServer(function(request, response) {
  var raw = fs.createReadStream('index.html');
  var acceptEncoding = request.headers['accept-encoding'];
  if (!acceptEncoding) {
    acceptEncoding = '';
  }

  // Note: this is not a conformant accept-encoding parser.
  // See http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3
  if (acceptEncoding.match(/\bdeflate\b/)) {
    response.writeHead(200, { 'content-encoding': 'deflate' });
    raw.pipe(zlib.createDeflate()).pipe(response);
  } else if (acceptEncoding.match(/\bgzip\b/)) {
    response.writeHead(200, { 'content-encoding': 'gzip' });
    raw.pipe(zlib.createGzip()).pipe(response);
  } else {
    response.writeHead(200, {});
    raw.pipe(response);
  }
}).listen(1337); 
```

# c# - 附加到 QueryString

> ID：12591870
> 
> 赞同：0
> 
> 时间：2012-09-25T22:13:29.797
> 
> 标签：c#, asp.net, redirect, query-string, request.querystring

想象一下，您有一个包含类别的菜单。每个都包含一个指向父页面的链接，但带有一个查询字符串。例如：

```
<a href="?category=5">Category 5</a> 
```

这在网格视图中显示了类别 5 的一些项目。现在我希望能够使用查询字符串对所述网格视图进行排序。所以我最终应该得到的查询字符串是：

```
?category=5&sortby=namedesc 
```

但我不知道已经选择了什么类别。所以我必须使用现有的查询字符串并添加 &sortby=namedesc。现在，如果我要从菜单中选择另一个类别，查询字符串当然不应该添加新的“&category=”，而是相应地更改现有的。

我想出如何做到这一点的唯一方法是将它们变成链接按钮，并在“onclick”中分析现有的查询字符串，并根据需要附加/更改值。然后做

```
Request.Redirect("page.aspx" + newQueryString); 
```

这应该可行，但这样做似乎是一种非常低效的方法，因为每次点击都需要 2 次回发。

我的问题是：有没有更聪明/更好的方法来处理这个问题？

# iphone - 在 + UIDocumentInteractionController 中打开：如何在 SDK iOS 6 中过滤选项（不推荐使用 canPerformActions）

> ID：12591871
> 
> 赞同：16
> 
> 时间：2012-09-25T22:13:35.313
> 
> 标签：iphone, ios, ipad, ios6, uidocumentinteraction

由于新的 SDK 已发布（iOS 6），因此不推荐使用委托`documentInteractionController:canPerformAction:`方法`UIDocumentInteractionControllerDelegate`。

使用该方法，您可以阻止默认操作，例如`print:`和`copy:`出现。

该方法在当前版本的 iOS 6 中被调用，但在未来版本中不会调用该方法，并且我的应用程序将显示我不想支持的操作。

我阅读了 UIDocumentInteractionController 及其委托的可用文档，但我无法找到另一种方法来完成我在 canPerformAction 方法中所做的事情。

有任何想法吗？

另外，能够过滤邮件或推特（默认显示）等应用程序会很棒，但我想这是不可能的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T03:04:24.307

同意在委托中弃用“canPerformAction”很麻烦的事实，我们失去了过去的细粒度控制。

但是，如果您只想允许在另一个应用程序中打开文档，并且想要删除 Copy、Print 甚至 Mail，我想您最好使用`OpenIn`方法版本来呈现`UIDocumentInteractionController`？

即供您`UIDocumentInteractionController`使用`presentOpenInMenuFromBarButtonItem:animated:`或`presentOpenInMenuFromRect:inView:animated:`

（而不是`presentOptionsMenuFromBarButtonItem:animated:`或`presentOptionsMenuFromRect:inView:animated:`）

这样，默认情况下，它只会显示可以打开文档的应用程序，并隐藏邮件、复制和打印。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T15:17:23.847

我认为这是因为 Apple 希望您使用新的*UIActivity*控件。

这是文档：

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivity_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivity_Class/Reference/Reference.html)

这是一个为支持许多第三方应用程序而开发的自定义控件：

[http://www.cocoacontrols.com/platforms/ios/controls/uiactivitycollection](http://www.cocoacontrols.com/platforms/ios/controls/uiactivitycollection)

这个问题解决了你如何制作自己的*UIActivity*：

[https://stackoverflow.com/a/12766330/736384](https://stackoverflow.com/a/12766330/736384)

因此，如果您不希望用户可以使用*copy:*和*print:*方法，只需将此活动传递给*UIActivityViewController*，如下所示：

```
[activityView setExcludedActivityTypes:[NSArray arrayWithObjects:UIActivityTypeCopyToPasteboard, UIActivityTypePrint, nil]]; 
```

所有默认活动都列在 Apple 文档链接的底部。

# sql - 多表查询不适用于某些数据库

> ID：12591872
> 
> 赞同：0
> 
> 时间：2012-09-25T22:13:37.780
> 
> 标签：sql, sql-server-2008, sql-server-2005, parameters

我有 12 个位置，每个位置都运行自己的数据库。每个数据库的设置完全相同，都有自己的信息。数据库都是SQL2005或2008服务器。我编写了一个多表查询来获取支付销售佣金的信息。此查询适用于 12 个数据库中的 10 个，其他 2 个数据库不返回任何结果。如果我使用 2 个连接表运行查询（在 2 个数据库上它不起作用）它可以工作，但是其他有问题的表与“where”语句无关。如果它适用于所有其他数据库，任何人都可以解释为什么它不能在 2005 服务器数据库中运行吗？我的代码是：

```
SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], 
                         Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, 
                         @enddate AS End_Date
FROM            CustomerUnlimitedTransactions INNER JOIN
                         Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID INNER JOIN
                         VIPAccountTypes ON CustomerUnlimitedTransactions.lMonthlyAccountTypeId = VIPAccountTypes.lAccountType INNER JOIN
                         Surcharges ON VIPAccountTypes.lSurchargeId = Surcharges.Surcharge_ID INNER JOIN
                         Users ON Customers.lGreeterID = Users.ID_User
WHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102)) AND 
                         (CustomerUnlimitedTransactions.sTransactionType = N'sale') AND (CustomerUnlimitedTransactions.lMonthlyAccountTypeId = '11') OR
                         (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102)) AND 
                         (CustomerUnlimitedTransactions.sTransactionType = N'sale') AND (CustomerUnlimitedTransactions.lMonthlyAccountTypeId = '12')
ORDER BY Created 
```

如果我像这样运行查询，我仍然不会返回任何结果：

```
SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], 
                             Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, 
                             @enddate AS End_Date
    FROM            CustomerUnlimitedTransactions INNER JOIN
                             Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID INNER JOIN
                             VIPAccountTypes ON CustomerUnlimitedTransactions.lMonthlyAccountTypeId = VIPAccountTypes.lAccountType INNER JOIN
                             Surcharges ON VIPAccountTypes.lSurchargeId = Surcharges.Surcharge_ID INNER JOIN
                             Users ON Customers.lGreeterID = Users.ID_User
    WHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102))
    ORDER BY Created 
```

如果我像这样运行查询，我会得到结果：

```
SELECT        Customers.sBarcode AS Barcode, Customers.dtCreated AS Created, CustomerUnlimitedTransactions.sCreatedBy AS [Commission pays], 
                                 Surcharges.sDescription AS [Unlimited Package], Surcharges.dblCommission AS [Commission Amount], Users.sUserName AS Greeter, @startdate AS Start_Date, 
                                 @enddate AS End_Date
        FROM            CustomerUnlimitedTransactions INNER JOIN
                                 Customers ON CustomerUnlimitedTransactions.lCustomerId = Customers.lCustomerID 
        WHERE        (Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(DATETIME, @enddate, 102))
        ORDER BY Created 
```

没有任何 Null 与上述任何查询相关联。这同样适用于 12 个中的 10 个......是的，数据库完全相同。（如果我在一年的日期范围内运行此查询，我会得到结果）但是我应该仅显示上周的 25 个结果，而我在 2 个中都没有显示任何结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T22:29:46.437

如果数据库实际上是相同的（请参阅 Tony Hopkinson 的评论），则查看您正在执行的字段`JOIN`以查看是否有任何空值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T23:09:28.707

提示：IN 关键字可以为您的 WHERE 子句创造奇迹

```
WHERE Customers.dtCreated BETWEEN CONVERT(DATETIME, @startdate, 102)
                              AND CONVERT(DATETIME, @enddate, 102)
  AND CustomerUnlimitedTransactions.sTransactionType = N'sale'
  AND CustomerUnlimitedTransactions.lMonthlyAccountTypeId in ('11',12) 
```

至于 WHERE 子句不会影响 JOIN 中的其他表，我高度怀疑您需要将它们从 INNER JOIN 转换为 LEFT JOIN。

*如所写（提示＃2：请自由*使用合理的别名）

```
 FROM CustomerUnlimitedTransactions T
INNER JOIN Customers C ON T.lCustomerId = C.lCustomerID
INNER JOIN VIPAccountTypes V ON T.lMonthlyAccountTypeId = V.lAccountType
INNER JOIN Surcharges S ON V.lSurchargeId = S.Surcharge_ID
INNER JOIN Users U ON C.lGreeterID = U.ID_User 
```

对于在最终结果中出现的一行，客户必须至少有一个涉及此类费用的 VIP 帐户类型的交易，并且他必须受到欢迎（松散阅读加入）。JOIN 上的任何空值和行都会消失。

# netbeans - 无法从资源 net/sf/antcontrib/antlib.xml、netbeans 加载定义

> ID：12591879
> 
> 赞同：8
> 
> 时间：2012-09-25T22:14:19.750
> 
> 标签：netbeans, ant, osx-mountain-lion, build.xml

我是 Netbeans 的新手，对 Ruby 编程也很陌生（不到一年）。我对 Eclipse 和 Ruby 越来越感到沮丧——它一点也不像 Mac！- 并根据“使用 JRuby”中的建议决定尝试 Netbeans。

在一堆博客文章之后，特别是 Geertjan 的[文章](https://blogs.oracle.com/geertjan/entry/ruby_in_netbeans_ide_7)，我已经配置了所有东西（我认为），但我一直收到这个错误：

```
Could not load definitions from resource net/sf/antcontrib/antlib.xml. It could not be found. 
```

build.xml 的相关部分（我认为）是：

```
<taskdef resource="net/sf/antcontrib/antlib.xml">
    <classpath>
        <pathelement location="${binaries.cache}/943CD5C8802B2A3A64A010EFB86EC19BAC142E40-ant-contrib-1.0b3.jar"/>
    </classpath>
</taskdef> 
```

binaries.cache 指向 /Users/carolyn/.hgexternalcache；jar 文件，我只是找不到任何地方。我在 Geertjan 的博客上问过，我想我也会在这里问。我尝试了各种不同的方法——我花了一段时间才发现 Netbeans 使用它自己的 Java 和 Ant！- 并且 $ANT_HOME 未定义，但我尝试的任何方法似乎都不起作用。我知道我错过了一些简单的东西，但无法弄清楚它可能是什么！

我正在使用 Netbeans 7.2（内部版本 201207171143）运行 OS X Mountain Lion。我将 NB Ruby 下载到“~/Downloads/mercurial/NB Ruby”。

提前感谢您的帮助！:-)

谢谢@TarjusArjun！

一旦你找到了 ant-contrib-1.0b3.jar（[我在这里找到了](http://www.findjar.com/jar/ant-contrib/ant-contrib/1.0b3/ant-contrib-1.0b3.jar.html?all=true)），它需要被复制到：

```
/Applications/NetBeans/NetBeans 7.2.app/Contents/Resources/NetBeans/java/ant/lib 
```

如果你的安装和我的一样，那么你会得到一堆新的错误和失败的构建——但这是一个不同的问题。

（感谢 Jav_Rock 的链接编辑。:-) 我完全忘记了这样做！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T09:37:33.383

也许您的根本问题在于 NetBeans IDE 没有选择 ANT_HOME。ANT 在此位置捆绑在 NETBEANS IDE 中：`<<NETBEANSHOME>>/java/ant`. 您可以尝试将其放置`ant-contrib-1.0b3.jar`在此位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T23:21:03.243

它在 ubuntu 上为我工作。将文件 ant-contrib-1.0b3.jar 复制并重命名为指定的路径

```
<target name="downloadbinaries" description="Download external binaries not stored in Mercurial sources." depends="-taskdefs">
    <property file="${user.home}/.nbbuild.properties"/> <!-- permit binaries.cache to be overridden -->
    <property name="binaries.cache" location="${user.home}/.hgexternalcache"/>
    <property name="binaries.server" value="http://hg.netbeans.org/binaries/"/>
    <downloadbinaries cache="${binaries.cache}" server="${binaries.server}">
        <manifest dir=".">
            <include name="*/external/binaries-list"/>
        </manifest>
    </downloadbinaries>

    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath>
            <pathelement location="${binaries.cache}/**943CD5C8802B2A3A64A010EFB86EC19BAC142E40-ant-contrib-1.0b3.jar**"/>
        </classpath>
    </taskdef>
</target> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T03:15:43.563

Netbeans 文档建议将 antlib 放在相对于项目的路径中：

```
<project name="test" default="all" basedir=".">
    <target name="init">
        <javac srcdir="tasksource" destdir="build/taskclasses"/>
        <jar jarfile="mytasks.jar">
            <fileset dir="build/taskclasses"/>
        </jar>
        <taskdef name="customtask" classname="com.mycom.MyCustomTask">
            <classpath>
                 <pathelement location="mytasks.jar"/>
            </classpath>
        </taskdef>
    </target> 
</project> 
```

在上面的示例中，antlib 被放置在`mytask.jar`taskdef 的类路径中并被引用。这种方法独立于`ANT_HOME`用户特定的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-13T21:09:12.793

我想分享我的答案，在尝试了这么久之后肯定有效：就是这样：复制您在其他地方尝试和工作的文件（build-iml）并替换上面声明的文件。注意：如果您检查大小，您会发现有很大不同，例如损坏的文件（在我的项目中是 72 ），而新的文件是 90k ......请尽快尝试，您绝对会感谢我的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-13T04:21:08.787

您不能在 [taskdef] 中使用属性

```
sudo cp ant-contrib-1.0b3.jar /usr/local/lib/. 
```

然后修改 build.xml

```
<pathelement location="/usr/local/lib/ant-contrib-1.0b3.jar"/> 
```

# file-io - NetLogo - 检查文件是否已更改

> ID：12591880
> 
> 赞同：0
> 
> 时间：2012-09-25T22:14:30.750
> 
> 标签：file-io, netlogo

检查文件是否已更改并仅打印新数据的有效方法是什么？

最初，我倾向于比较行数的 readline 方法，但这似乎非常低效。

我最初的查询是是否有办法从 Netlogo 检查文件大小或时间戳。答案是“不”。然而，Charles Staelin 很友好地将 get-date-ms 方法添加到 pathdir 扩展中。因此，现在可以检查文件更改（根据时间戳）`set currenttimestamp pathdir:get-date-ms "somefile.nlist" if currenttimestamp != filetimestamp`

使用添加的方法：

```
to checkfile
  ifelse checktick mod 19 = 0
    [set currenttimestamp pathdir:get-date-ms "somefile.nlist" 
     if currenttimestamp != filetimestamp
     [file-open "somefile.nlist"
      let thiscount 0
      while [not file-at-end?][
        set in1 file-read-line
        set global-in1 in1
        set thiscount thiscount + 1
        if thiscount > global-filelength AND (not file-at-end?)[ ;it seems that this not-at-file-end is redundant - why not?
          print in1
          set global-filelength thiscount
          set hasfilechanged true

       ]

        ]
     file-close
      set filetimestamp currenttimestamp
      set checktick checktick + 1
      ]

     ]

    [ set checktick checktick + 1]

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T17:56:00.287

Charles Staelin 最近将此添加到他的`pathdir`扩展中，它为 NetLogo 添加了各种面向文件和路径的原语。请参阅[http://groups.yahoo.com/group/netlogo-users/message/15301](http://groups.yahoo.com/group/netlogo-users/message/15301)。扩展列在[https://github.com/NetLogo/NetLogo/wiki/Extensions](https://github.com/NetLogo/NetLogo/wiki/Extensions)

# jquery - 与不是 not() 的 jQuery find() 相反？

> ID：12591889
> 
> 赞同：4
> 
> 时间：2012-09-25T22:15:07.557
> 
> 标签：jquery

给定以下 HTML，什么 jQuery 选择器会选择最后一个 'blah blah'`span`而不是第一个？

```
<div class='d1'>
  <span>
    <a>blee
      <span> <!-- don't select this span -->
        <span>blah</span> blah
      </span>
    </a>
  </span>
</div>

<br/>

<div class='d1'>
  <span>
    <a>blee
      <span> <!-- select this span -->
        blah blah
      </span>
    </a>
  </span>
</div> 
```

我已经尝试使用 not() 进行变体，但无法弄清楚。似乎我需要的是一个找到第一个跨度的选择器，但如果它包含另一个跨度，则将其排除。就像是：

```
$('.d1 span a span').not(':has("span")') 
```

但这并没有。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T22:18:57.020

如果我正确理解了您的问题，那么您所缺少的只是一个子组合器：

```
$('.d1 span a > span').not(':has("span")') 
```

这是一个[工作示例](http://jsfiddle.net/2CLps/)。

你需要这个的原因是`.d1 span a span`它将匹配第一个元素中元素的*两个* `span`后代。该调用将排除外部的，但内部的仍将是匹配集的一部分。通过添加子组合器，仅选择了外部组合器，然后通过调用将其删除。`a``.d1``.not()``span``.not()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:19:00.227

如果我正确理解您的问题，您需要这个选择器：

`$('div.d1 span:last')`

小提琴在行动中展示它：http: [//jsfiddle.net/aWCsT/](http://jsfiddle.net/aWCsT/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T22:20:04.263

`span`仅选择that的孩子`a`：

```
$('.d1 span a > span:not(:has(span))') 
```

**演示：http: [//jsfiddle.net/Blender/eSDrK/1/](http://jsfiddle.net/Blender/eSDrK/1/)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-25T22:21:44.697

尝试这个：

```
$('.dl:last span:not(:has(*))') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-25T22:26:39.963

**[演示 jsbin](http://jsbin.com/awoset/1/edit)**

```
$('a>span:not(:first)') 
```

# java - Mac JFrame 中的 Java 白边（缓冲区）

> ID：12591892
> 
> 赞同：0
> 
> 时间：2012-09-25T22:15:29.057
> 
> 标签：java, swing

感谢您的建议。这是一个修改后的问题：

我正在创建一个程序，并且有人为该程序制作了背景。问题是我只是将图像作为标签放在框架中，希望它会占据整个空间。这可以正常工作，但框架周围有一个白色边框边缘，使其看起来不像背景 附加的是图像。

![成绩册](../Images/6622e60fcc5bebccb52027e8d27d6d60.png)

# c++ - Xercesc 的 C++“'DOMDocument'：重新定义”错误

> ID：12591894
> 
> 赞同：3
> 
> 时间：2012-09-25T22:15:31.850
> 
> 标签：c++, namespaces, header-files, msxml, xerces

我的问题是 Xerces 和 Windows 都有一个`'DOMDocument'`对象。[Xerces 以及我在这里](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/e189173e-870d-440b-a416-340678481ed7)、[这里](http://xerces.apache.org/xerces-c/faq-build-3.html)和[这里](http://mail-archives.apache.org/mod_mbox/xerces-c-users/200506.mbox/%3C6.2.1.2.2.20050615175705.05185ae0@webmail.bedford.progress.com%3E)读到的几乎所有内容都建议定义名称空间或取消定义`DOMDocument`，它应该看起来像这样。

```
Void foo(XERCES_CPP_NAMESPACE::DOMDocument* pDocument); 
```

或者

```
#undef DOMDocument
#include <xerces/Stuff> 
```

我想走理智的路线，只应用命名空间，但它似乎不起作用。我真的很犹豫要不要使用`#undef`那种感觉像是在解决问题的方法。

windows文件`msxml.h`是抱怨重新定义的文件。

这可能与它们的加载顺序有关吗？我有这样的东西，

```
#include <stdio.h>
#include <iostream>
#include <fstream>
#include <sstream>
#include <vector>
#include <list>
#include <map>
#include <ctime>
#include "XMLClass.h" 
```

其中`XMLClass.h`包括 xerces 标头。真的很难说是什么导致了这个问题，因为错误出现在微软的标题中。

我还在`'DOMDocument'`整个项目中搜索过，我使用的任何地方`'DOMDocument'`都有一个`XERCES_CPP_NAMESPACE`.

**注意：**我使用的是 xerces 3.1 和 VS 2010。

想法？

**更新：** 我`#undef`在添加 xerces 标头之前尝试过，但我仍然收到错误。所以我真的很困惑为什么这两种解决方案都不适合我。

**更新 2：** 我也尝试将命名空间从更改为`XERCES_CPP_NAMESPACE::DOMDocument`，`xercesc::DOMDocument`但这并没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T23:15:58.607

这是一个标题加载顺序问题。

我知道有 2 个库包含`msxml.h`在他们的代码中，

```
#include<Windows.h> 
```

和

```
#include<ole2.h> 
```

就我而言`#include <Windows.h>`，恰好在我的`#include "XMLClass.h"`. 所以解决方案是像这样定义`msxml.h`之前，`xerces`

```
#include<msxml.h>             //defines DOMDocument first     
//defines DOMDocument with a different namespace
#include <xercesc/dom/DOMDocument.hpp> 
```

因为`xerces`注意到了命名空间而微软没有，如果像这样以相反的顺序定义标题，

```
#include <xercesc/dom/DOMDocument.hpp>
#include<msxml.h> 
```

无论你做什么，你的代码都不会编译。编译器会告诉您您正在重新定义`'DOMDocument'`，这实际上是正在发生的事情。这是因为微软编写`msxml.h`.

希望这可以帮助任何遇到这个问题的人。

**笔记：**

在定义这样的“DOMDocument”对象、参数和返回类型时，您必须始终包含命名空间，

```
XERCES_CPP_NAMESPACE::DOMDocument xmlDoc;

void setDoc(XERCES_CPP_NAMESPACE::DOMDocument xmlDoc);

XERCES_CPP_NAMESPACE::DOMDocument getDoc(); 
```

否则您将继续收到歧义错误，或者**最糟糕**的是它会在运行时假定错误的数据类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-07T05:42:20.177

我也遇到了类似的问题，一个定义来自 mshtml.h 文件，另一个来自 xercesc。我使用了三个类“DOMDocumentType”“DOMException”“DOMProcessingInstruction”

在改变了它的工作顺序之后

谢谢

# c# - 禁用 WPF 窗口焦点

> ID：12591896
> 
> 赞同：23
> 
> 时间：2012-09-25T22:15:50.780
> 
> 标签：c#, wpf, focus

我有一个 WPF 窗口，仅当您通过 Visibility.Hidden 和 Visibility.Visible 按住 tab 键时才会显示。但是，按住该键会将焦点从活动应用程序转移到 WPF 窗口。我可以禁用此行为吗？更进一步：即使单击控件，是否可以完全防止窗口获得焦点，但仍注册控件的单击操作？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-27T19:00:31.863

在别处找到答案：

```
protected override void OnSourceInitialized(EventArgs e)
{
    base.OnSourceInitialized(e);

    //Set the window style to noactivate.
    var helper = new WindowInteropHelper(this);
    SetWindowLong(helper.Handle, GWL_EXSTYLE,
        GetWindowLong(helper.Handle, GWL_EXSTYLE) | WS_EX_NOACTIVATE);
}   

private const int GWL_EXSTYLE = -20;
private const int WS_EX_NOACTIVATE = 0x08000000;

[DllImport("user32.dll")]
public static extern IntPtr SetWindowLong(IntPtr hWnd, int nIndex, int dwNewLong);

[DllImport("user32.dll")]
public static extern int GetWindowLong(IntPtr hWnd, int nIndex); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-25T23:15:35.947

> 由于 .NET 3.5 SP1 WPF 表单具有 ShowActivated 属性。将此设置为`false`，这样标记的表单将不再窃取任何焦点。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-12-11T13:07:00.510

您可以通过添加自定义 WndProc 并处理 WM_MOUSEACTIVATE 来防止 WPF 窗口在鼠标单击时激活：

```
protected override void OnSourceInitialized(EventArgs e)
{
    base.OnSourceInitialized(e);
    var source = PresentationSource.FromVisual(this) as HwndSource;
    source.AddHook(WndProc);
}
private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
{
    if (msg == WM_MOUSEACTIVATE)
    {
        handled = true;
        return new IntPtr(MA_NOACTIVATE);
    }
    else return IntPtr.Zero;
}
private const int WM_MOUSEACTIVATE = 0x0021;
private const int MA_NOACTIVATE = 0x0003; 
```

参考：

*   MSDN WM_MOUSEACTIVATE：[https ://msdn.microsoft.com/en-us/library/windows/desktop/ms645612(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms645612(v=vs.85).aspx)
*   如何在 WPF 中处理 WndProc 消息：[如何在 WPF 中处理 WndProc 消息？](https://stackoverflow.com/questions/624367/how-to-handle-wndproc-messages-in-wpf)
*   通知窗口 - 防止窗口获得焦点：[通知窗口 - 防止窗口获得焦点](https://stackoverflow.com/questions/7750517/notification-window-preventing-the-window-from-ever-getting-focus)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-18T04:25:01.917

**防止某些顶级窗口在 WPF 中被激活**：

我尝试了这里给出的 Win32 解决方案，但它对我不起作用。虽然它似乎确实阻止了窗口“激活”，但`Focus`之后它仍处于不确定状态，不会恢复到您应用程序中另一个符合条件的窗口。相反，以下内容对我有用：

首先，确保所有非主窗口的`Owner`属性都设置为 main `Window`。我在子窗口的构造函数中执行此操作，在这种情况下，必须采取一些步骤（此处未讨论）以确保`Window`首先加载主窗口。

```
public MySubWindow()
{
    if ((base.Owner = Application.Current.MainWindow) == null)
        throw new Exception();

    InitializeComponent();
} 
```

设置该`Owner`属性还应确保子窗口保持在主窗口的顶部。对于子窗口，按照指示设置以下属性（XAML 或代码）：

```
ShowActivated="False"
Focusable="False"
ShowInTaskbar="False"
IsEnabled="False"
FocusManager.IsFocusScope="False" 
```

最后，为`OnActivated`被阻止的窗口添加一个处理程序。我不调用基本方法，因为它会触发`Activated`事件。（请注意，您不应将激活从 Visual Studio 设计器中切换，因为它会使窗口不可见）。

```
protected override void OnActivated(EventArgs e)
{
    if (DesignerProperties.GetIsInDesignMode(this))
        return;

    base.Owner.Activate();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T00:13:18.393

也许你想要一个 PopupWindow 而不是 Window ？它具有 Focusable 的属性，您可以将其设置为 false（我认为默认情况下它可能为 false）。

# ruby-on-rails - 安装 Aptana Studio 时缺少 Ruby/Rails 选项

> ID：12591899
> 
> 赞同：0
> 
> 时间：2012-09-25T22:15:55.687
> 
> 标签：ruby-on-rails, ruby, eclipse, aptana

[我已经尝试从http://www.aptana.com/products/studio3/download](http://www.aptana.com/products/studio3/download)安装 Aptana 插件（我正在运行 Juno）和 Aptana Studio 本身。

就像我之前使用 PyDev 的经验一样，我了解到我必须将 Eclipse 指向我的 Ruby 解释器，但是当我打开我的**窗口 > 首选项**对话框时，没有像我从教程中看到的那样的 Ruby 选项等等：

![Eclipse 对话框缺少 ruby​​ 选项](../Images/165f9b06b3f3c3877eb381456931f097.png)

尽管 Eclipse 允许我创建一个新项目，但我看不到任何创建 Ruby 源文件的选项：

![在此处输入图像描述](../Images/8441a0fe6519c7b035277eb0043b262a.png) ![在此处输入图像描述](../Images/e219544d4f30cdd75c03b9da97af2a33.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T18:14:18.357

您可以创建一个简单的文件并将 .rb 扩展名放入其中，一切都应该可以工作。关于 ruby​​ 配置，我相信它希望在您的 PATH 中找到 ruby​​。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T19:49:39.310

由于某种原因，Aptana 工作室现在可以很好地用于 Rails 项目。我能想到的唯一解释是我使用的 Aptana Studio 的特定版本给我带来了问题。

# wpf - 调试 WPF XAML

> ID：12591901
> 
> 赞同：0
> 
> 时间：2012-09-25T22:16:02.277
> 
> 标签：wpf, debugging

我有一个需要移动到托盘的 WPF 应用程序。它目前直接在 UI 中启动，并且有两个选项卡。在第二个选项卡上，有几个可折叠的容器，用于保存关联设备的设置。可以动态添加或删除设备。

我添加了托盘应用程序，并添加了代码以从应用程序调用设置。一切正常，除了可折叠的容器是空的。我已经跟踪了代码以确认它们应该有对象。

如果我将默认应用程序设置为 UI，我发现它们可以正常工作，但从托盘启动 UI 时它们不起作用。我在下面包含了 xaml 的一部分：

```
<c:CollapsibleSection Header="Senders">
        <c:CollapsibleSection.CollapsedContent>
             <c:RepeatControl Margin="30,0,0,0" ItemsSource="{Binding SendersList}"  
                              ItemType="{x:Type m:Sender}"  List="{Binding SendersList}"  
                              ItemTemplate="{StaticResource SenderSummary}"/>
        </c:CollapsibleSection.CollapsedContent>
        <Border BorderThickness="1" BorderBrush="Chocolate" Margin="30,0,0,0">
            <c:RepeatControl  ItemsSource="{Binding SendersList}"  ItemType="{x:Type m:Sender}" List="{Binding SendersList}"  ItemTemplate="{StaticResource SenderTemplate}"/> 
        </Border>
    </c:CollapsibleSection> 
```

我对 WPF 不是很熟悉，想知道是否有在 VS 2008 中调试 xaml 的好方法。我在 2010 年和 2012 年找到了工具，以及 2005 年的一些旧帖子，它们提供了基本的解决方法，但是我2007 年没有发现太多。

我也希望有人可能知道当 UI 作为启动项目启动时可能导致它正常工作的原因，但在从另一个项目调用时却不知道。该项目最初是作为启动项目的 UI 开发的，如果有帮助的话，托盘是一个单独的项目。UI 还由驻留在主项目文件夹和 UI 文件夹中的几个类组成。但是，似乎正在访问所有 xaml（创建了具有 CollapsibleSection 的类的其他部分）。

没有抛出异常。

附加信息

我还尝试添加一个 test-textblock 以查看未绑定的文本是否会出现在发件人中，但仍然没有显示任何内容。添加的代码如下：

```
 <TextBlock Name="testTextBlock">
    <ContentControl Content="This is just a test...  " Foreground="Red">/ContentControl>
</TextBlock> 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T15:22:30.553

我终于想通了这一点。必须调用整个 WPF 应用程序才能运行，而不是实例化 UI。这将导致 App.xaml 加载字典，然后其他 WPF 表单可以访问它。这是通过以下代码完成的：

```
 private void settingsEvent_Click(object sender, EventArgs e)
    {
        app.InitializeComponent();
        gui = new Sender_Receiver.mainWindow();
    }
    private static App app = new App(); 
```

这是通过实验发现的，所以我确信这不是最佳实践，但它确实有效，而且现在，这正是我所需要的。

谢谢你，Blam，你的贡献！我确实发现它们很有帮助。

# php - 使用电子邮件标题 - PHP

> ID：12591908
> 
> 赞同：2
> 
> 时间：2012-09-25T22:16:42.893
> 
> 标签：php, email-headers

我正在将收到的电子邮件传送到 handler.php。我可以成功地通过管道传输它并且它正在工作，但是当它从邮件标题中取出变量时，例如“主题”或“收件人”或“邮件正文”，我遇到了一些问题。这是我从[这里得到的代码](http://www.phpshare.org/articles/Piping-Incoming-Mail-with-PHP)

这是代码：

```
 <?php
//Assumes $email contains the contents of the e-mail
//When the script is done, $subject, $to, $message, and $from all contain appropriate values

//Parse "subject"
$subject1 = explode ("\nSubject: ", $email);
$subject2 = explode ("\n", $subject1[1]);
$subject = $subject2[0];

//Parse "to"
$to1 = explode ("\nTo: ", $email);
$to2 = explode ("\n", $to1[1]);
$to = str_replace ('>', '', str_replace('<', '', $to2[0]));

$message1 = explode ("\n\n", $email);

$start = count ($message1) - 3;

if ($start < 1)
{
    $start = 1;
}

//Parse "message"
$message2 = explode ("\n\n", $message1[$start]);
$message = $message2[0];

//Parse "from"
$from1 = explode ("\nFrom: ", $email);
$from2 = explode ("\n", $from1[1]);

if(strpos ($from2[0], '<') !== false)
{
    $from3 = explode ('<', $from2[0]);
    $from4 = explode ('>', $from3[1]);
    $from = $from4[0];
}
else
{
    $from = $from2[0];
}
?> 
```

对于 Gmail 电子邮件，它可以很好地获取主题、发件人、收件人和邮件正文，但它不适用于来自 Yahoo 的传入电子邮件。

是否有任何与所有著名电子邮件服务提供商兼容的通用 php 类？如果有人从 RoundCube 或其他电子邮件发件人发送电子邮件怎么办？我怎样才能成功检测到变量？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:09:49.143

您在评论中描述的消息格式是[多部分 Mime](http://en.wikipedia.org/wiki/MIME#Multipart_messages)编码。

有很多事情需要考虑——如果电子邮件是 HTML*和*纯文本格式，有嵌入的图像、附件等，该怎么办？

如果您使用的 PHP 版本是使用[MailParse](http://php.net/manual/en/ref.mailparse.php)扩展构建的，那么它们应该为您提供一组相当简单的工具供您使用。

Google 代码上还有[Mime 电子邮件解析器](http://code.google.com/p/php-mime-mail-parser/)，我以前没有使用过，但看起来相当简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T23:24:04.083

如果您需要一些非常简单的东西，这是一个起点：

```
list($headers, $message) = explode("\n\n", $email);

$header = imap_rfc822_parse_headers($headers);

// You can now access
$header->from;
$header->to;
$header->subject; 
```

电子邮件部分（即使单独使用）也可以使用`imap_rfc822_parse_adrlist()`.

# rubygems - 为什么我在尝试安装 rmagick 时收到错误“无法安装 RMagick 2.13.1。找不到 MagickWand.h”？

> ID：12591920
> 
> 赞同：1
> 
> 时间：2012-09-25T22:17:26.263
> 
> 标签：rubygems, imagemagick, solaris, rmagick

我最近开始将我的网站从 Accelerator 迁移到 SmartMachine。

一切都很好，但现在我无法安装 rmagick gem。当我运行`sudo gem install rmagick`时，控制台显示消息：

> 无法安装 RMagick 2.13.1。找不到 MagickWand.h。

MagickWand.h 位于`/opt/local/includes/ImageMagick/wand`.

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T00:54:05.977

尝试： apt-get install libmagickwand-dev

或者：C_INCLUDE_PATH=/usr/local/include/ImageMagick/ gem install rmagick

或者： $ MAGICK_HOME=/usr/local 包

# regex - Coldfusion正则表达式不选择具有特定ID的href

> ID：12591925
> 
> 赞同：0
> 
> 时间：2012-09-25T22:18:03.813
> 
> 标签：regex, coldfusion, html-parsing, coldfusion-9

我有一个 HTML 解析器在做艰苦的工作，但我需要一个正则表达式来选择没有属性 id="optout" 的锚。这是我当前的正则表达式，它选择所有具有href和http的锚点......这很好，只需要忽略那些id =“optout”的锚点——有什么想法吗？谢谢！

```
<cfset matches = ReMatch('<a[^>]*href="http[^"]*"[^>]*>(.+?)</a>', arguments.htmlCode) /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T23:29:17.307

正则表达式是执行此任务的错误工具，并且鉴于您已经使用了 HTML 解析器，没有理由不继续使用它！

这是使用 HTML 解析器 ( [jsoup](http://jsoup.org) ) 执行此操作的简单方法：

```
jsoup.parse( Arguments.HtmlCode ).select('a:not([id=optout])') 
```

这是可维护性差得多的正则表达式方法：

```
rematch( '(?i)<a\s*(?:(?!id\s*=\s*[''"]optout[''"])[^>])+>(?:[^<]+|<(?!/a>))+</a>' , Arguments.HtmlCode ) 
```

# asp.net-mvc-3 - Global.asax.cs 在服务器上不可见

> ID：12591930
> 
> 赞同：4
> 
> 时间：2012-09-25T22:18:35.133
> 
> 标签：asp.net-mvc-3, iis-7, global-asax

Server08下运行| IIS7。我有一个网站项目，过去有很多次在部署站点手动编辑 Global.asax.cs 的习惯。最近我发现只有 Global.asax 存在并且只有：

```
<%@ Application Codebehind="Global.asax.cs" Inherits="myDomain.MvcApplication" Language="C#" %> 
```

对于我的任何活跃的、正常运行的网站，根本没有 Global.asax.cs 文件存在/可见。

我在这里检查过[Global.asax 找不到代码隐藏类](https://stackoverflow.com/questions/9535244/global-asax-cant-find-code-behind-class)，这里[是 mvc3 中 Global.asax 中的代码在哪里？](https://stackoverflow.com/questions/8189215/where-is-the-codes-in-global-asax-in-mvc3)无处可去。第二个链接包含评论：*'那是因为它是一个已编译的 Web 应用程序。您必须在 Visual Studio 中将其视为一个项目。*

但由于我的项目一直是一个网站——而且我没有（故意）转换它，我对改变的行为感到困惑。

但是当我进入 VS12 并查看解决方案的 WebProject 的上下文菜单时，它会显示“转换为 Web 应用程序”。站点的文件夹结构**不**包含 App_Data 或 App_Start。在我看来，VS建立的这两个事实是将项目视为一个网站，那么为什么将Global.cs编译到/ bin？

我将通过重复来结束 - 我过去曾手工编辑过这些东西 - 我并不肯定，但可以准确地说这是我在安装 VS12 后第一次尝试这样做。而且，更加努力地思考它 - 直到最近我才实施了“一键发布”服务，以便它可以发挥作用。

核实？~~我想要~~我需要编辑一个简单的更新而无需完全重新部署。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T20:49:55.347

我认为“一键发布”很可能是这里的罪魁祸首。我创建了一个示例网站项目进行实验，当我在 Visual Studio 中使用发布功能时，生成的文件确实缺少 Global.asax.cs 文件。相反，使用名为“App_global.asax.dll”的编译创建 bin 文件夹，即使它是网站而不是 Web 应用程序。我猜这可能与您正在发生的事情相似。

如果没有，我找到了一个可能对您有用的链接，以便再次能够在服务器上编辑课程。特别是，看看第二个答案（不被接受为最佳答案的那个）为全局代码重新创建一个类文件：[Global.asax.cs 文件在哪里？](https://stackoverflow.com/questions/6288209/where-is-the-global-asax-cs-file)

我尝试了这个解决方案，并验证了类文件在服务器上是可编辑的，并且它是在运行时动态编译的（我对文件所做的修改立即生效）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:25:04.840

编辑 global.asax 后，您需要重建 DLL 并将其上传到 bin 文件夹。否则，您的更改将不会生效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T09:48:26.703

您也许可以上传包含该文件中代码的 global.asax 的 Web 版本，这显然不需要 .cs 代码。我曾经在应用程序中使用 aspx 文件，但我从未在 GLobal.asax 文件中尝试过。

# html - 为什么在小型显示器和移动设备上垂直居中网页会中断？

> ID：12591931
> 
> 赞同：0
> 
> 时间：2012-09-25T22:18:38.753
> 
> 标签：html, css, position, margin, css-position

现在我有一个总高度设置为 750 像素的网站。我使用绝对位置和负边距方法将其垂直居中。除了一个问题，它的效果很好。

如果我尝试在分辨率较低的显示器或移动设备上使用它，它会切断页面顶部。

这是我的代码

**HTML**

```
<body>
<div class="content">
CONTENT IS HERE
</div>
</body> 
```

**CSS**

```
.content {
position:absolute;
top:50%;
height:750px;
margin-top:-375px; /* Half of 750px */
} 
```

我尝试使用溢出：滚动；在身体标签上，但我知道它不起作用，我没想到它会起作用。我完全被难住了！有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:40:16.623

您可以在小屏幕上使用[mediaquery](http://www.javascriptkit.com/dhtmltutors/cssmediaqueries.shtml)覆盖它：

```
.content {
    position:absolute;
    top:50%;
    height:750px;
    margin-top:-375px;
}
@media only screen and (max-height: 750px){
    .content {
        top:0;
        margin-top:0;
    }
} 
```

实际上，这是一种优雅的降级方法，但如果您正在为移动设备进行设计，您可能希望以[渐进增强](http://www.alistapart.com/articles/understandingprogressiveenhancement/)的方式进行处理。在这种情况下，它变成：

```
.content {
    height:750px;
}
@media only screen and (min-height: 751px){
    .content {
        position:absolute;
        top:50%;
        margin-top:-375px;
    }
} 
```

* * *

谈到兼容性，`only`关键字 after`@media`阻止旧浏览器呈现包含的规则。

要达到（几乎）完全兼容，您可以使用这个非常有用的插件：[respond.js](https://github.com/scottjehl/Respond)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T22:26:13.307

就滚动而言，

```
overflow:auto; 
```

可能是您想要的，因为这会导致滚动条出现。

您遇到的这个总体问题是为什么几乎总是相对地进行尺寸调整。相对于百分比，或相对于 javascript 来确定客户端的可视区域。

另请注意，

```
.class { 
```

与您的定义不符`class="content"`。这是一个逻辑错误，应替换为

```
.content { 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-25T22:25:16.800

尝试类似的东西

```
margin-top:-25%; 
```

这样它在任何浏览器窗口高度都是一样的

高度也一样，使用百分比组合，而不是像素。

# google-maps-api-3 - Google maps API v3 - 灰色或删除状态？

> ID：12591937
> 
> 赞同：0
> 
> 时间：2012-09-25T22:19:05.090
> 
> 标签：google-maps-api-3

是否可以将我不想从地图上看到的状态变灰，甚至更好地一起删除？搜索时无法找到任何明确的答案。我正在尝试仅显示德克萨斯州的地图并在其上放置标记。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:43:08.907

您是否正在寻找类似[Marcelo](https://stackoverflow.com/users/408519/marcelo)的[(v2) 示例](http://maps.forum.nu/gm_texas.html)？

这是一个[使用 FusionTables 的 v3 示例](http://www.geocodezip.com/geoxml3_test/v3_FusionTables_State_invert4.html?state=Texas)

[你也可以用KmlLayers](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmltest_nosidebar.html?lat=37.155939&lng=-79.497071&zoom=6&type=m&filename=http://www.geocodezip.com/geoxml3_test/virginia_inverted_kml.xml)做同样的事情

# c++ - 尝试创建链接列表堆栈时出现链接器错误

> ID：12591942
> 
> 赞同：0
> 
> 时间：2012-09-25T22:19:48.803
> 
> 标签：c++, templates, linked-list, stack

> **可能重复：**
> [为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)
> [模板运算符重载函数上的未定义符号](https://stackoverflow.com/questions/13150412/undefined-symbol-on-a-template-operator-overloading-function)

对于我的学校作业，我需要制作一个使用链表制作堆栈的程序。我不断收到链接器错误（特别是：error LNK2019: unresolved external symbol "public: __thiscall Stack::Stack(void)" (??0?$Stack@H@@QAE@XZ) referenced in function _main 1>C: \Users\devon.taylor\Desktop\New folder\Debug\PA3.exe : 致命错误 LNK1120: 1 unresolved externals)

这是我的代码：

标题：

```
template <class T>
class  Stack
{
public:
    Stack();
    Stack(T data);
    ~Stack();
    void push(T data);
    T pop();
    void display();
    bool isEmpty();
    bool isExist(T searchKey);

private:
    Stack<T> *top;
    Stack<T> *next;
    T mData;
}; 
```

职能：

```
#include "stack.h"
#include <iostream>

using namespace std;

template <class T>
Stack<T>::Stack()
{
    top=NULL;
}

template <class T>
Stack<T>::Stack(T data)
{
    mData = data;
    pNext = NULL;
}

template <class T>
Stack<T>::~Stack()
{

}

template <class T>
void Stack<T>::push(T data)
{
   Stack *ptr;
   ptr=new Stack<T>;
   ptr->mData=data;
   ptr->next=NULL;

   if(top!=NULL)
   {
      ptr->next=top;
   }
   top=ptr;
   cout<<"\nNew item inserted to the stack";
}        

template <class T>
T Stack<T>::pop()
{

}
template <class T>
void Stack<T>::display()
{

} 
```

主功能：

```
#include <iostream>
#include "stack.h"

using namespace std;

void main ()
{
    Stack<int>* stack;
    stack = new Stack<int>;
    //stack->push(19);

    system("pause");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T22:21:27.743

您必须在头文件中实现模板函数，以便链接器获取它。有关更多详细信息，请参阅此[问题](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file) 。

此外，请查看[C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/templates-defn-vs-decl.html)以了解更多详细信息。

# c# - 从 xml 文档中读取值

> ID：12591945
> 
> 赞同：0
> 
> 时间：2012-09-25T22:19:58.553
> 
> 标签：c#, xml, cxml

我有一个 cXML，我试图从中读取一些值。我可以使用以下代码读取节点值。但是我很难从同一个文档中读取“payloadID”。任何建议如何去做？

```
XmlDocument xmlRequest = new XmlDocument();
XmlNodeList name = xmlRequest.GetElementsByTagName("NetworkID");
string sSecret = name[0].InnerText;

<!DOCTYPE cXML SYSTEM "http://xml.cxml.org/schemas/cXML/1.2.023/cXML.dtd">
    <cXML payloadID="1348609345562-715426217594539696@216.109.111.69"
        timestamp="2012-09-11T11:55:53-07:00" version="1.2.023"
        xml:lang="en-US">      
        <From>
            <Credential domain="NetworkID">
                <Identity>tnt</Identity>
            </Credential>
        </From>
        <To>
            <Credential domain="NetworkID1">
                <Identity>abc</Identity>
            </Credential>
        </To>            
    </cXML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T22:23:26.663

您应该能够获取根元素，然后使用其 Attributes 属性来读取该根元素的属性，例如：

```
XmlNode root = doc.SelectSingleNode("/cXML");
string attrVal = root.Attributes["payloadID"].Value; 
```

# php - set_rules() 不合作

> ID：12591947
> 
> 赞同：0
> 
> 时间：2012-09-25T22:20:06.950
> 
> 标签：php, codeigniter, validation

这很奇怪，当 set_rules 被告知要查找`current_password`它时它还不起作用，而当它被告知要查找`current-password`它时。

```
<input type="password" name="current_password" id="current_password" value=""/> 
```

请注意，name 和 id 都有一个下划线。

```
$this->form_validation->set_rules('current_password', 'Password', 'required|callback_check_password['.$user_id.']');
//This gives me
Unable to access an error message corresponding to your field name. 
```

上述规则不起作用，但如果我也更改它，`set_rules('current-password'`它开始显示错误消息。

打印错误消息`<?php echo validation_errors(); ?>`

做一个帖子展示的转储`array(1) { ["current_password"]=> string(4) "test" }`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T01:04:38.807

我没有在回调函数中设置错误消息

```
function check_password($password, $user_id){
    $check = $this->Usermodel->check_password($password, $user_id);
    if($check){
        return TRUE;
    } else {
        $this->form_validation->set_message('check_password', 'Incorrect password');
        return FALSE;
    }
} 
```

# caching - 如何返回（通过）不在 acl 中的所有主机 - Varnish

> ID：12591952
> 
> 赞同：2
> 
> 时间：2012-09-25T22:20:19.303
> 
> 标签：caching, varnish, varnish-vcl

所以这就是我想要完成的事情。我试图让清漆在共享环境中工作，我想将其设置为只有 vcl 中的域包含被缓存，其余的只是通过。这是我正在查看的内容：

```
include "/etc/varnish/whitelist.vcl";
if (req.http.host !~ vhosts) {
   return(pass);
}

acl vhosts {
"domain.net";
"www.domain.net";
"...";
} 
```

...

现在清漆告诉我这是不可能的：

```
Message from VCC-compiler:
Expected CSTR got 'vhosts'
(program line 940), at
('input' Line 11 Pos 30)
if (req.http.host !~ vhosts) {
-----------------------------######---

Running VCC-compiler failed, exit 1

VCL compilation failed 
```

现在我知道我可以做到以下几点：

```
sub vcl_recv {
    if (req.http.host == "domain1.com" || 
        req.http.host == "domain2.com") {
        return(pass);
    }
} 
```

但我真的很喜欢第一个干净的外观。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:58:40.873

不幸的是，我们不能将 ACL 用于 HTTP 主机标头。仅用于匹配客户端地址

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-10T08:59:16.143

ghloogh 是对的，除了您可以使用 std.ip() 函数将 IP 地址转换为正确的格式以匹配 acls。但是仍然不适用于主机名。

但我建议您使用正则表达式而不是单个字符串匹配，如下所示：

```
sub vcl_recv {
    if (req.http.host ~ "^(domain1.com|domain2.com)$") {
        return(pass);
    }
} 
```

# javascript - 重定向到警报框上的其他页面确认

> ID：12591953
> 
> 赞同：26
> 
> 时间：2012-09-25T22:20:28.437
> 
> 标签：javascript

这是我的功能的一部分，其中**包含问题**：

```
function deletePost() {
    var ask = window.confirm("Are you sure you want to delete this post?");
    if (ask) {
        window.alert("This post was successfully deleted.");

        /* How to redirect to another page on confirm? */

    }
} 
```

需要纯 Javascript。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-25T22:22:15.887

试试这个：

```
function deletePost() {
    var ask = window.confirm("Are you sure you want to delete this post?");
    if (ask) {
        window.alert("This post was successfully deleted.");

        window.location.href = "window-location.html";

    }
} 
```

# workflow-foundation-4 - 访问变量 在 WF4 中的自定义活动中

> ID：12591954
> 
> 赞同：0
> 
> 时间：2012-09-25T22:20:33.860
> 
> 标签：workflow-foundation-4, workflow-foundation

我需要计算我在流程图流中迭代的次数，但我需要能够读取并最好写入自定义活动中的变量。

我目前的尝试是在设计视图中声明 var，其范围为整个流程图，默认值为 0，并使用分配活动递增。但我无法弄清楚如何在不重置的情况下访问自定义活动中的变量。

我访问 var 的尝试类似于此处答案中所描述的内容：[Declare Variable<T> variable in a CodeActivity in a CodeActivity in windows workflow 4.0](https://stackoverflow.com/questions/7767434/declare-variablet-variable-in-a-codeactivity-in-windows-workflow-4-0)

只有我在声明时不使用 var 的默认值。看来 var 似乎与我在设计视图中定义的 var 没有任何关系。我也尝试过仅在代码中定义它，但是我无法在例如常规的分配活动中访问它。

那么我该怎么做才能将 var 用作“全局”变量？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T23:44:36.250

最直观也可能是正确的方法是将您在流程图级别声明的变量传递到您的自定义活动中。然后你可以用它的价值做任何你想做的事情并返回它。

自定义增量活动的示例（这也是分配活动的工作方式）：

```
public class IncrementActivity : CodeActivity<int>
{
    [RequiredArgument]
    public InArgument<int> CountVariable { get; set; }

    protected override int Execute(CodeActivityContext context)
    {
        // Do whatever logic you want here

        return CountVariable.Get(context) + 1;
    }
} 
```

这是使用序列的示例（使用流程图时相同）：

```
var countVar = new Variable<int>("count");

var activity = new Sequence
{
    Variables = 
    { 
        // declare counter variable at global scope
        countVar
    },
    Activities =
    {
        new WriteLine { Text = new VisualBasicValue<string>(@"""Count: "" & count") },
        new IncrementActivity { CountVariable = countVar, Result = countVar },
        new WriteLine { Text = new VisualBasicValue<string>(@"""Count: "" & count") },
        new IncrementActivity { CountVariable = countVar, Result = countVar },
        new WriteLine { Text = new VisualBasicValue<string>(@"""Count: "" & count") },
        new IncrementActivity { CountVariable = countVar, Result = countVar }
    }
}; 
```

输出：

```
Count: 0
Count: 1
Count: 2 
```

[请注意，通过可视化设计器更简单，因为您不必直接使用*[VisualBasicValue<string>](http://msdn.microsoft.com/en-us/library/dd782058.aspx)*来构建打印字符串。除此之外，一模一样！]

# .net - 如果使用日志门面，在使用 IoC/DI 时是否应该注入日志基础设施？

> ID：12591955
> 
> 赞同：39
> 
> 时间：2012-09-25T22:20:42.283
> 
> 标签：.net, logging, dependency-injection, inversion-of-control

我正在使用 Autofac 作为我的 IoC，并且从我读过的关于 DI 主题的所有内容中都可以看出如何使用“构造函数注入”来显式公开类依赖项......但是，我也在使用 Log4Net 的日志外观（Common.Logging）并创建了Autofac 模块来注入它。现在，在我想做一些日志记录的每个类中，我都有额外的构造函数参数（参见示例 #1）....

我想知道在使用日志记录外观时是否需要记录 DI？我知道通过构造函数签名显式暴露依赖项是一个很好的架构。 *但*在记录外观的情况下，我相信以下是正确的：

*   我仍然可以随时“换掉”日志框架
*   恕我直言，该类并不真正依赖于 Logger。如果未配置日志记录，则使用 NullLogger。这几乎是“如果你需要它就可以”与“除非你提供它否则它将无法工作”的交易......（参见示例＃2）

那么，其他人怎么看？注入日志外观是不是矫枉过正？关于这个主题有一些[类似的问题](https://stackoverflow.com/q/1313591/481904)，但更笼统地说（[基础设施](https://stackoverflow.com/q/10853740/481904)） - 我主要对日志记录感兴趣......

```
// IoC "way"
public class MyController : BaseController
{
    private readonly ILog _logger;

    public MyController(ILog logger)
    {
        _logger = logger;
    }

    public IList<Customers> Get()
    {
        _logger.Debug("I am injected via constructor using some IoC!");
    }
}

// just use the logger "way"
public class MyController : BaseController
{
    private static readonly ILog Logger = LogManager.GetCurrentClassLogger();

    public IList<Customers> Get()
    {
        Logger.Debug("Done! I can use it!");
    }
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-26T18:49:31.840

日志记录只是基础设施。注入它是矫枉过正的。我个人什至不使用抽象层。我使用库直接提供的静态类。我的动机是我不太可能在当前项目中切换日志库（但可能会切换到下一个项目）。

但是，您在示例中使用了控制器。为什么需要登录它们？控制器只是视图和模型（业务逻辑）之间的适配器。应该不需要登录。

您通常只登录包含业务逻辑的类，并且在顶层能够记录未处理的异常。这些是很难调试的情况，因此是需要记录的地方。

必须在其他地方登录表明您需要重构以正确封装您的业务逻辑。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-10-28T23:07:07.500

这可能是一个较旧的帖子，但我想插话。

认为日志系统的 IoC 过于矫枉过正的想法是短视的。

日志是一种机制，应用程序开发人员可以通过它与其他系统（事件日志、平面文件、数据库等）进行通信，而这些东西现在都是应用程序所依赖的外部资源。

如果我的单元测试代码现在锁定到特定的记录器，我应该如何对组件的日志记录进行单元测试？分布式系统通常使用记录器来集中源，而不是文件系统上的平面文件。

对我来说，注入记录器与注入数据库连接 API 或外部 Web 服务没有什么不同。它是应用程序需要的资源，因此应该注入，因此您可以测试组件对所述资源的使用情况模拟所述依赖关系的能力，以独立于日志记录接收者测试我的组件的输出，对于强大至关重要单元测试。

并且鉴于 IoC 容器使这种注入成为孩子的游戏，在我看来，*不*使用 IoC 来注入记录器并不比这样做更有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-26T15:02:04.533

> 现在，在我想做一些日志记录的每个类中，我都有额外的构造函数参数

如果您需要在系统中记录许多类，则说明您的设计有问题。要么你记录太多，要么你违反了单一职责原则，因为日志是一个横切关注点，你不应该用横切关注点（比如日志记录）来弄乱你的类。

半年前我回答了一个（完全不同的）问题，我的回答适用于你的问题。请阅读[此](https://stackoverflow.com/questions/9892137/windsor-pulling-transient-objects-from-the-container/9915056#9915056)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-26T16:56:57.060

我个人认为这是矫枉过正。

理想情况下，日志记录应该具有非常低的开销，因此每个类单个静态记录器实例似乎是一个更好的解决方案。保持低开销促进了调试级别日志记录的使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-22T00:53:06.937

在许多应用程序中，由于整个应用程序的体系结构都需要日志记录，因此到处注入日志会使您的代码变得混乱和复杂。对对象的静态引用`Logger`很好，只要您`Logger`有某种`Attach(ILoggerService)`机制可以为运行环境附加日志服务。然后，您的静态`Logger`将这些存储在一个集合中，以在执行日志记录命令时使用。

在运行时引导应用程序时，附加应用程序所需的日志记录目标（文件、数据库、Web 服务等）。

在执行自动化测试时，您可以通过不附加任何内容（默认情况下）来选择不使用日志记录。如果您想分析被测系统的日志记录，请在`ILoggerService`设置测试时附加您自己的实例/替代/模拟。

像这样的静态`Logger`应该具有最小的性能问题并且没有意外后果，同时通过绕过依赖注入的需要来避免代码混乱。

必须说明的是，您不应该对架构中的每个对象都采用这种静态对象方法；日志记录是一种特殊情况。通常在代码库中使用静态对象会使维护和测试变得困难，应该避免。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-06T14:13:18.303

不是在任何情况下都可以应用的通用答案，但 C# 中有第三个选项：如果日志记录是可选的，您可以将它们转换为事件。

```
public class MyController : BaseController
{
    public event Action<string> DebugMessage;

    public IList<Customers> Get()
    {
        DebugMessage?.Invoke("Done! I can use it!");
    }
} 
```

这将实际日志记录的负担转移到了作曲家（并且 Setter 注入会导致时间耦合），但是，如果您正在开发小型库并希望避免依赖于`System.Diagnostics.Debug`，这可能值得考虑。

您可能想引入一些界面以使其更易于注册：

```
// Collect this interface with your favorite auto-registering DI container
public interface IDebugMessageEmitter
{
    event Action<string> DebugMessage;
}

public class MyController : BaseController, IInformationEmitter
{
    // ...
} 
```

# php - curl_exec() 将目标内容输出到页面？

> ID：12591958
> 
> 赞同：3
> 
> 时间：2012-09-25T22:21:17.640
> 
> 标签：php, curl

我正在使用以下代码：

```
$ch = curl_init('www.google.com');
$output = curl_exec($ch);
curl_close($ch); 
```

这不是我第一次使用 cURL，除非我弄错了，否则上面的代码应该检索 google.com 的内容并将其存储在 $output 中。正确的？

那么，为什么上面的代码会将内容（在本例中为 Google 主页）输出到页面？我没有回显任何内容，但由于某种原因，该`curl_exec()`函数正在输出它返回到页面的内容。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T22:22:28.400

你需要使用

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
```

这将告诉 curl_exec 不要输出结果

所以将其全部更改为

```
$ch = curl_init('www.google.com');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
curl_close($ch); 
```

# python - 如何编写用于下载的python脚本？

> ID：12591959
> 
> 赞同：6
> 
> 时间：2012-09-25T22:21:19.273
> 
> 标签：python, download, python-2.7

我想从这个网站下载一些文件：[http ://www.emuparadise.me/soundtracks/highquality/index.php](http://www.emuparadise.me/soundtracks/highquality/index.php)

但我只想得到某些。

有没有办法编写一个python脚本来做到这一点？我对python有中级知识

我只是在寻找一些指导，请指点我一个 wiki 或图书馆来完成这个

谢谢，灌木

[这是我的代码的链接](http://pastebin.com/3ihc6A1d)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:34:34.900

我看了看页面。链接似乎重定向到托管文件的另一个页面，单击哪个页面下载文件。

我会使用[mechanize](http://wwwsearch.sourceforge.net/mechanize/)跟随所需的链接到正确的页面，然后使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)或[lxml](http://lxml.de/)来解析结果页面以获取文件名。

[然后使用urlopen](http://docs.python.org/library/urllib.html)打开文件并将其内容写入本地文件是一件简单的事情，如下所示：

```
f = open(localFilePath, 'w')
f.write(urlopen(remoteFilePath).read())
f.close() 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-31T16:27:10.717

为页面发出 url 请求。获得来源后，过滤并获取网址。

您要下载的文件是包含特定扩展名的 url。有了这个，您可以对所有符合您的条件的 url 进行正则表达式搜索。过滤后，对每个匹配到的url数据做一个url请求，写入内存。

示例代码：

```
#!/usr/bin/python
import re
import sys
import urllib

#Your sample url
sampleUrl = "http://stackoverflow.com"
urlAddInfo = urllib.urlopen(sampleUrl)
data = urlAddInfo.read()

#Sample extensions we'll be looking for: pngs and pdfs
TARGET_EXTENSIONS = "(png|pdf)"
targetCompile = re.compile(TARGET_EXTENSIONS, re.UNICODE|re.MULTILINE)

#Let's get all the urls: match criteria{no spaces or " in a url}
urls = re.findall('(https?://[^\s"]+)', data, re.UNICODE|re.MULTILINE)

#We want these folks
extensionMatches = filter(lambda url: url and targetCompile.search(url), urls)

#The rest of the unmatched urls for which the scrapping can also be repeated.
nonExtMatches = filter(lambda url: url and not targetCompile.search(url), urls)

def fileDl(targetUrl):
  #Function to handle downloading of files.
  #Arg: url => a String
  #Output: Boolean to signify if file has been written to memory

  #Validation of the url assumed, for the sake of keeping the illustration short
  urlAddInfo = urllib.urlopen(targetUrl)
  data = urlAddInfo.read()
  fileNameSearch = re.search("([^\/\s]+)$", targetUrl) #Text right before the last slash '/'
  if not fileNameSearch:
     sys.stderr.write("Could not extract a filename from url '%s'\n"%(targetUrl))
     return False
  fileName = fileNameSearch.groups(1)[0]
  with open(fileName, "wb") as f:
    f.write(data)
    sys.stderr.write("Wrote %s to memory\n"%(fileName))
  return True

#Let's now download the matched files
dlResults = map(lambda fUrl: fileDl(fUrl), extensionMatches)
successfulDls = filter(lambda s: s, dlResults)
sys.stderr.write("Downloaded %d files from %s\n"%(len(successfulDls), sampleUrl))

#You can organize the above code into a function to repeat the process for each of the
#other urls and in that way you can make a crawler. 
```

上面的代码主要是为 Python2.X 编写的。但是，[我写了一个爬虫，它适用于从 2.X 开始的任何版本](https://github.com/odeke-em/crawlers/blob/master/fileDownloader.py)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-28T20:27:28.593

为什么是！5 年后，这不仅是可能的，而且你现在有*很多*方法可以做到这一点。
我将避免在这里使用代码示例，因为主要是想帮助您将问题分解为多个部分并为您提供一些探索选项：

## 第 1 部分：获取！

如果您**必须**坚持使用`stdlib`，对于 python2 或 python3，`urllib[n]`*****是您想要用来从 Internet 上下拉内容的东西。
同样，如果您不想依赖其他包：

*   `urllib`或者`urllib2`也许另一个`urllib[n]`我忘记了。

### 如果您不必限制对标准库的导入：

你很幸运！！！！你有：

*   `requests`[这里](https://requests.readthedocs.io/en/master/)有文档。***`requests`是使用 python 从网上获取东西的黄金标准。我建议你使用它。***

*   `uplink`[这里](https://uplink.readthedocs.io/en/stable/introduction.html)有文档。它相对较新，适用于更多程序化的客户端界面。
*   `aiohttp`通过[此处](https://docs.python.org/3/library/asyncio.html)`asyncio`的文档。仅包含在 python >= 3.5 中，而且它也更加令人困惑。也就是说，如果您愿意投入时间，那么对于这个用例来说，它可能会非常有效。`asyncio`

...我也很失职，更不用说我最喜欢的爬行工具之一：

*   `fake_useragent`回购[这里](https://github.com/hellysmile/fake-useragent)。文档喜欢严重没有必要。

## 第 2 部分：解析！

再说一次，如果你*必须*坚持使用 stdlib 并且不安装任何东西`pip`，你可以使用额外的额外乐趣和安全 (<==extreme-sarcasm)`xml`内置模块。具体来说，您可以使用：

*   `xml.etree.ElementTree()`[这里](https://docs.python.org/2.7/library/xml.etree.elementtree.html#module-xml.etree.ElementTree)有文档。

值得注意的是，该`ElementTree`对象是 pip-downloadable`lxml`软件包的基础，并且更易于使用。如果您想重新创建轮子并编写一堆您自己的复杂逻辑，则使用默认`xml`模块是您的选择。

### 如果您不必限制对标准库的导入：

*   `lxml`[这里](https://lxml.de/index.html#documentation)有文档。正如我之前所说，`lxml`它是一个包装器`xml.etree`，使其可供人类使用并实现您需要自己制作的所有解析工具。但是，正如您通过访问文档所看到的那样，它本身并不容易使用。这使我们...
*   `BeautifulSoup`也就是[这里](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigating-using-tag-names)`bs4`的文档。***BeautifulSoup 让一切变得更简单。******这是我的建议。***

 **## 第 3 部分：获取获取获取！

本节与“第 1 节”几乎完全相同，只是您有一堆链接而不是一个。本节和“Segment 1”之间唯一不同的是我对使用什么的建议：在处理多个 URL 时，`aiohttp`这里的下载速度**会更快，因为它允许您并行下载它们。********

* * *

* - （`n`从 python-version 到 ptyhon-version 以某种令人沮丧的任意方式决定的位置。查找作为顶级功能的哪个。您可以在此处阅读有关此命名约定 clusterf**k 的`urllib[n]`更多[信息](https://docs.python.org/2/library/urllib2.html#urllib2.urlopen)，[此处](https://docs.python.org/2/library/urllib.html), 和[这里](https://docs.python.org/3.6/library/urllib.html).) ****** - （这并不完全正确。在人类时间尺度上，它在功能上更像是正确的。）`.urlopen()`

 *** * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-25T22:40:09.383

我会使用 wget 的组合进行下载 - [http://www.thegeekstuff.com/2009/09/the-ultimate-wget-download-guide-with-15-awesome-examples/#more-1885](http://www.thegeekstuff.com/2009/09/the-ultimate-wget-download-guide-with-15-awesome-examples/#more-1885) 和 BeautifulSoup [http： //www.crummy.com/software/BeautifulSoup/bs4/doc/](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)用于解析下载的文件****

# html - HTML 禁用按钮获取：active CSS 伪类

> ID：12591966
> 
> 赞同：16
> 
> 时间：2012-09-25T22:22:10.610
> 
> 标签：html, css, css-selectors, pseudo-class

CSS：

```
button:active {
/* active css */
}

button:disabled {
  opacity: 0.5;
} 
```

HTML：

```
<button disabled="disabled">Ok</button> 
```

当我单击按钮时，浏览器会添加按钮：活动状态，使其看起来像是被单击（即使它被禁用）。我发誓我认为 :active 仅在启用按钮时才添加。我错过了什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-25T22:28:13.437

From what I can tell, `:active` doesn't exclude `:disabled` elements. You can read the [spec](http://www.w3.org/TR/css3-selectors/#the-user-action-pseudo-classes-hover-act) if you'd like.

To solve your problem, you could exclude `:disabled` elements by targeting only `:enabled` elements with your `:active` selector:

```
button:enabled:active {
/* active css */
}

button:disabled {
  opacity: 0.5;
} 
```

**Demo: [http://jsfiddle.net/Blender/LRvra/1/](http://jsfiddle.net/Blender/LRvra/1/)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-25T22:29:01.353

[According to the CSS3 specification](http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#enableddisabled) (`:disabled` is not in CSS2.1) there is no mention that `:active` and `:disabled` are mutually exclusive. It's possible that this part of the specification needs clarification so UAs are free to apply the pseudo-classes in combination.

I suggest you modify your selectors to be more explicit:

```
button:enabled:active {
    /* active css */
}
button:disabled {
    opacity: 0.5;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-17T11:52:00.713

您还可以使用 css 的 :not()-descriptor：

```
button:active:not(:disabled) {
/* active css */
}

button:disabled {
  opacity: 0.5;
} 
```

祝你一切顺利，帕特里克

# microsoft-metro - Metro 应用程序 - 使用 javascript/html 时如何更新动态磁贴？

> ID：12591969
> 
> 赞同：0
> 
> 时间：2012-09-25T22:22:18.633
> 
> 标签：microsoft-metro

我刚刚开始使用 HTML、JS 和 CSS 进行 Metro 应用程序开发。是否可以使用通过 WCF 服务检索到的一些数据来更新动态磁贴？当我在 Visual Studio 2012 中右键单击引用时，我没有看到“添加服务引用”选项。这整个 Metro 应用程序非常混乱。我可以在 Metro 应用程序中使用 HTML/JS/CSS*和C#（如 ASP.NET）的组合吗？*

这就是我想要做的 - 当应用程序启动时，它应该在应用程序的 iframe 中打开一个网页。我还想读取登录用户的帐户名（Windows 身份验证），启动对 WCF 服务的调用，获取一些数据并将其显示在磁贴上，并定期刷新。听起来我需要 HTML/JS 和 C# 的组合。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T02:30:49.887

[定期通知](http://msdn.microsoft.com/en-us/library/windows/apps/jj150587.aspx)似乎非常适合您的场景。通过定期磁贴更新，Windows 将使用托管在 Web 地址上的 XML 磁贴通知内容自动更新应用程序磁贴。Web 内容可以由 WCF 服务或任何其他 Web 服务器提供。

[显示应用如何使用startPeriodicUpdate](http://msdn.microsoft.com/en-us/library/windows/apps/hh701694.aspx)设置定期更新的代码：

```
var tileUpdater = Windows.UI.Notifications.TileUpdateManager.createTileUpdaterForApplication();
var interval = Windows.UI.Notifications.PeriodicUpdateRecurrence.halfHour;

// Every 30 minutes, Windows will update the tile with the content at 'uri'.
tileUpdater.startPeriodicUpdate(uri, interval); 
```

如果应下载多个更新以使用磁[贴通知循环](http://msdn.microsoft.com/en-us/library/windows/apps/hh779724.aspx#cycling_tile_notifications)，请使用[startPeriodicUpdateBatch](http://msdn.microsoft.com/en-us/library/windows/apps/hh967946.aspx)。

注意：可以使用 HTML、JS 和 CSS 编写的应用程序使用 C# 库，但我认为在这种情况下不需要它。

# ios - 在 Flex 中获取 ipad 可写目录

> ID：12591973
> 
> 赞同：0
> 
> 时间：2012-09-25T22:22:50.703
> 
> 标签：ios, apache-flex

我正在使用 Flex（Adobe Air、Flash Builder）开发一个 ipad 应用程序。我知道在 Objective-C 中，您可以使用 NSDocumentDirectory 获取可写目录，但是您如何在 Flex 中做同样的事情？

在 Flex 中，我使用 File.applicationStorageDirectory，它仅在我在模拟器中运行时才有效。如果我在 ipad 上安装该应用程序，它不会给出任何错误，但我认为它不起作用。请帮忙！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:47:14.587

我会猜到 File.applicationStorageDirectory。事实上，我已经成功地使用它在 iOS 上创建了一个 SQLLite 数据库。我不确定为什么它不起作用。

你可以试试[File.userDirectory](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/filesystem/File.html#userDirectory)。

# php - 输入 php 后打印出预设计证书

> ID：12591980
> 
> 赞同：0
> 
> 时间：2012-09-25T22:23:16.063
> 
> 标签：php, html

我有一个问题，也许在 php 旁边有更好的方法，但我把这个想法扔在那里......让我知道你的专家建议。

1.  我将有一个预先设计的证书，我将用 PHP 创建并用 HTML 设计。
2.  用户将被引导到一个页面以输入要在证书上打印的名称。
3.  最终结果将被调整为 8 1/2" x 11" 准备打印。

显示我要求[的图像：设计示例](http://imageshack.us/photo/my-images/854/predesign.png/)

解决这个问题的最佳方法是什么？或者有什么东西是预制的，可以根据我的要求定制吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:41:05.243

这是 Javascript 中的一个示例。

**HTML**：

```
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">
Enter Name:
<input id="who" type="text" />
<input id="submit" type="button" class="btn" value="Submit" />
<div id="certificate" style="text-align:center;display:none;">
    <h1>Certificate of Merit</h1>
    <h3>Presented To:</h3>
    <h4 id="name"></h4>
    <hr />
    <h2>Congratz</h2>
</div>​ 
```

**Javascript**：

```
$('#submit').click(function() {
    $('#name').html($('#who').val());
    $('#certificate').fadeIn();
});​ 
```

**JSFiddle**：http: [//jsfiddle.net/6SWVV/1/](http://jsfiddle.net/6SWVV/1/)

# javascript - 如何将日期字符串中的外国月份转换为英文

> ID：12591985
> 
> 赞同：1
> 
> 时间：2012-09-25T22:23:31.467
> 
> 标签：javascript, globalization, datetime-format

下面对另一个线程的回答似乎是我认为我需要的一个开始，但我在实现它时遇到了困难。

> 用于此目的的最佳库可能是 Globalize。它允许您指定语言环境（称为文化，但实际上是相同的）、格式（内置或您自己的）并实际将字符串解析为给定日期：
> 
> var dateString = "lunes, 29 de agosto de 2011"; // 看起来像是西班牙语中的长日期格式 var date = Globalize.parseDate( dateString, "D", "es" );
> 
> 您需要附加适当的文化文件以及对 Globalize 的引用才能使其正常工作。请注意，库中已经定义了文化，所以不要害怕网页上的信息，您实际上不需要 .Net。

如果有人可以把它变成一个可行的例子，那么我就可以接受它并根据我的需要进行调整。

但是......有人知道另一种方法吗？

例如，我的字符串是：

“ **Set** 24, 2012 20:40:20”，罗马尼亚语有月份。

我需要它

" **Sep** 24, 2012 20:40:20" 有英文月份。

我需要一个可以采用语言代码（即 en、es、pl、ru、ro 等）并转换字符串中的月份的解决方案（需要能够处理所有 12 个月，而不仅仅是上述字符串中的那个）从外语到英语。

任何快速的帮助将不胜感激，以便我可以让我的网站重新启动并再次全速运行。

如果您需要我提供任何进一步的信息，请询问:)

问候罗斯

@Jukka K. Korpela

我有这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Testing Globalize</title>
<meta name="keywords" content="Globalize, Testing">
<meta name="description" content="Trying to get globalize to work.">
<script src="https://github.com/jquery/globalize/blob/master/lib/globalize.js"></script>
<script src="https://github.com/jquery/globalize/blob/master/lib/cultures/globalize.cultures.js"></script>
<script>
var monthString = 'sep'; // replace by code that extracts the string
var lang = 'ro';          // replace by code that picks up the right language
var month = Globalize.parseDate(monthString, 'MMM', lang);
if(month) {
  document.write(Globalize.format(month, 'MMM', 'en'));
} else {
  alert('Unrecognized month: ' + monthString);
}
</script>
</head> 
```

但是当我在“http://htmledit.squarefree.com/”中测试时它不起作用请帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T23:06:00.677

我认为你可以使用 datejs 来达到你的目的。它能够通过文化文件以任何可用的语言（150+ 作为州）解析您的日期数据，然后将其保存为英语或您想要的任何其他语言。

看看：[http ://code.google.com/p/datejs/](http://code.google.com/p/datejs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T07:05:20.257

在 Globalize.js 中执行此类操作的方法是使用一种语言环境读取字符串，使用另一种语言环境写入。您需要通过一些检查值的测试来检查读取是否成功`null`（因为该值表示错误）。像这样：

```
<script src="globalize.js"></script>
<script src="globalize.cultures.js"></script>
<script>
var monthString = 'sep.'; // replace by code that extracts the string
var lang = 'ro';          // replace by code that picks up the right language
var month = Globalize.parseDate(monthString, 'MMM', lang);
if(month) {
  document.write(Globalize.format(month, 'MMM', 'en'));
} else {
  alert('Unrecognized month: ' + monthString);
} 
```

这仅解析月份的缩写，或月份的“短名称”。

问题在于文化内部的差异。例如，对于罗马尼亚语，九月的简称是“sep”。在[Globalize.js 数据](https://github.com/jquery/globalize/blob/master/lib/cultures/globalize.culture.ro.js)中（主要基于 .NET 数据；Datejs 在这里可能基于相同的数据）但“sept.” 在[CLDR](http://cldr.unicode.org)数据中，您的示例提到了“设置”！

Globalize.js 读取名称时不区分大小写，但否则它会在其语言环境定义中使用确切的字符串（例如，如果定义为“sep.”，则“sep”不会执行）。有多种解决方法。最简单的是，编辑 Globalize.js 中的语言环境定义以匹配您的数据中使用的那些。或者，您可以创建具有不同月份名称的备用语言环境（变体），如果它不根据基本语言环境进行解析，则使用它来解析名称。因此，这是一种允许在输入时为一种语言设置不同月份名称的方法。

当然，如果*只是*将不同语言的短月份名称映射成英文的问题，您可以直接为其编写代码。但是您仍然需要将名称从某处获取到您的对象中——来自 .NET、来自 CLDR 或来自您的实际数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-19T11:21:42.203

早在 2013 年，我就偶然发现了这个困难，并且确实开发了一个小型实用程序来解决这个问题。

我昨天发布了我的 v3：[https ://framagit.org/Siltaar/month_nb](https://framagit.org/Siltaar/month_nb)

它支持 69 种语言，您无需知道月份名称的语言即可获得它的编号。它基于数据的可重用独立 JSON 树结构和查找结果的小型树遍历循环。

要使用它，只需在网页中包含数据和 tree-walker 文件：

```
<script src="month_nb_json.js" type="text/javascript"></script>
<script src="month_nb.js" type="text/javascript"></script> 
```

然后你就可以使用它了：

```
>> month_nb('août');
8 
```

这是我的 Meta-Press.es 项目的一部分，该项目获得了一些资金，并且我将至少在接下来的 6 年内继续工作（从 2013 年开始……）。

否则，它存在[https://github.com/datejs/Datejs](https://github.com/datejs/Datejs)，这是一种人工翻译方法。

# c# - 通过字符串将方法名称分配给 Func

> ID：12591988
> 
> 赞同：1
> 
> 时间：2012-09-25T22:23:52.200
> 
> 标签：c#, asp.net, c#-4.0

基本上我想这样做：

```
Func<string> f =  ()=> MyMethodName(); 
```

仅具有方法的字符串名称，即：

```
 Func<string> f =  "MyMethodName"; 
```

这可以做到吗？有什么问题，注意事项？反射可以帮助吗？我可以先检查一个方法是否存在吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-25T22:49:46.890

这里根本不需要 lambda 表达式。您可以使用[`Delegate.CreateDelegate`](http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx)：

```
MethodInfo method = GetType().GetMethod(methodName);
Func<string> func = (Func<string>) Delegate.CreateDelegate(typeof(Func<string>),
                                                           obj, method); 
```

这样，您就可以避免一定程度的间接性，并且您还可以进行*一次*反射部分，而不是每次调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:29:22.173

这是一个反射的例子：

```
Func<string> func = ( ) => {
    return ( string )( this.GetType( ).GetMethod( "MyMethodName" ).Invoke( this, new object[ 0 ] ) );
} 
```

如果你想要一些东西来缓解这件事，这里有一些东西：

```
public static Func<string> ReflectByName( object obj, string methodname ) {
    return ( ) => {
        return ( string )( obj.GetType( ).GetMethod( methodname ).Invoke( obj, new object[ 0 ] ) );
    }
} 
```

如何使用：

```
Func<string> f = FastReflect.ReflectByName( this, "MyMethodName" ); 
```

`FastReflect`方法在哪里`ReflectByName`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:51:12.723

这是另一种方法。这具有比反射快得多的优点，因此如果您需要在循环中调用它，那就太好了。此代码创建一个 Func 将调用您的方法

```
 public static Func<T, string> CreateCallFunc<T>(string methodName)
    {
        var parm = Expression.Parameter(typeof(T));
        var call = Expression.Call(parm, typeof(T).GetMethod(methodName));
        var lambda = Expression.Lambda<Func<T, string>>(call, parm);
        return (Func<T, string>)lambda.Compile();
    } 
```

你像这样使用它：

```
 class SomeClass
    {
        void DoIt()
        {
            var func = CreateCallFunc<SomeClass>("SomeMethod");
            Console.WriteLine(func(this));
        }

        public string SomeMethod()
        {
            return "it works!";
        }
    } 
```

最大的优势是一旦你创建了你的 Func，你可以非常简单地使用 func(myInstance) 来调用它，它会非常快。

我使用此方法获取 DataReader 并将读取的所有数据复制到类的集合中，其中类上的属性名称与读取器中的字段匹配。

请注意，约翰的回答是一种更简单的方法，直到现在我才知道，但我想这有更大的灵活性

# winapi - 带有 LOCALE_SSHORTDATE 的 GetDateFormat 返回非本地化数字

> ID：12591993
> 
> 赞同：1
> 
> 时间：2012-09-25T22:24:45.117
> 
> 标签：winapi, localization

我正在运行 Windows 7 + 外语包。（我已将默认语言环境设置为外语）我有一个有效的 SYSTEMTIME 结构，我正在尝试从中构建一个本地化的日期/时间。

这就是我获取格式字符串然后尝试获取本地化日期的方式

```
WCHAR pFmt[MAX_SIZE] = {0};
int localeinfo=GetLocaleInfo(localeID, LOCALE_SSHORTDATE, pFmt, sizeof(pFmt)/sizeof(TCHAR)); 
```

我已经尝试了以下所有方法

```
GetDateFormat(LOCALE_USER_DEFAULT, 0, &st, pFmt, formattedString, MAX_PATH);
GetDateFormat(LOCALE_SYSTEM_DEFAULT, 0, &st, pFmt, formattedString, MAX_PATH);
GetDateFormat(localeinfo, 0, &st, pFmt, formattedString, MAX_PATH); 
```

带有数字的字符串没有被本地化 - 在所有情况下，我总是得到 formattedstring

```
pFmt            "dd/MM/yyyy"
formattedString "25/09/2012"      (I want this to be in the foreign language) 
```

如何使格式化字符串具有数字的本地化值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T12:49:53.143

如果您想`GetDateFormat`使用与任何语言环境相对应的格式，那么您应该在*没有*格式字符串的情况下调用它（第 4 个参数设置为 NULL）。

例如，在调用此函数后尝试比较 formattedString：

```
LCID lcidEnUs = MAKELCID(MAKELANGID(LANG_ENGLISH, SUBLANG_ENGLISH_US), SORT_DEFAULT);
GetDateFormat(lcidEnUs, 0, &st, NULL, formattedString, MAX_PATH); 
```

和这个：

```
LCID lcidFrFr = MAKELCID(MAKELANGID(LANG_FRENCH, SUBLANG_FRENCH), SORT_DEFAULT);
GetDateFormat(lcidFrFr, 0, &st, NULL, formattedString, MAX_PATH); 
```

# javascript - javascript隐藏评估

> ID：12591995
> 
> 赞同：0
> 
> 时间：2012-09-25T22:24:48.797
> 
> 标签：javascript, php, eval

我现在正在测试一种隐藏 javascript 的方法，以便用户无法在源文件中四处搜索它。

方法是这样的：

1.  您包含了一堆 javascript 文件来使您的应用程序正常工作。jQuery、dojo 等库和您自己的代码。这是相当标准的。

2.  有一段关键的 javascript 代码，没有它，应用程序将无法运行，任何好奇的用户也无法在没有它的情况下做出应用程序的正面或反面。这个关键部分不会被脚本标签加载。相反，一个不显眼的小脚本调用数据库并以一个大长字符串返回 javascript。

3.  这个字符串得到 eval()-ed 以使其成为实时代码。但是代码是动态生成的，所以如果用户正在查看源代码或保存网站，它不会显示出来。此外，您可以添加某种盐或时间戳，以防止用户试图欺骗数据库泄露您的 javascript 内核。

我正在尝试从社区获得对此的反馈，而我为使用服务器端代码隐藏 javascript 而出现的大多数示例只是人们希望在标签中包含 .php 文件而不是 .js . 这是完全不同的。

所以你有它。这是一个好主意吗？弱点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-25T22:29:43.253

`eval()`通常不受欢迎，但无论如何，最大的弱点是我可以简单地嗅探 HTTP 请求并获取您的脚本。混淆可以使这更加不方便，但是使用好的调试器并不难跟踪堆栈跟踪并很好地了解正在发生的事情。

即使资源是通过 SSL 传输的，一旦被浏览器加载，它也可以被仔细阅读/操作。[为了测试这一点，我访问了一个安全网站，并使用SmartSniff](http://www.nirsoft.net/utils/smsniff.html)检查了原始 TCP 响应（使用 XML HTTP 的同步和异步）。正如预期的那样，它是加密的且不可读的。但是，相同的请求在 Chrome 的网络活动检查器中都以纯文本形式显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:30:03.893

使人类无法阅读 Javascript 代码（甚至对逆向工程具有很强的抵抗力）是微不足道的——而且您不需要将其隐藏在其他代码中。但为什么？通常，这种代码的名称是恶意软件。

# jenkins - cloudbees jbehave插件

> ID：12591996
> 
> 赞同：1
> 
> 时间：2012-09-25T22:24:52.930
> 
> 标签：jenkins, hudson, cloudbees, jbehave, jbehave-plugin

我刚刚将我的 CI 服务器从 In company 服务器迁移到 CloudBees 服务器。

我的应用程序使用 JBehave 进行功能测试，在 In Company 服务器上，我配置了 JBehave hudson 插件 (http://jbehave.org/reference/stable/hudson-plugin.html)。在这个设置中，我的测试总是无声无息地失败，所以在构建过程之后，插件将解析 jbehave 结果文件并标记哪些测试失败，并提供详细信息。

现在，在 cloudbees 上，我似乎无法安装此插件。所以我该怎么做？别再默默地失败了？如果我这样做，来自测试的反馈是非常粗略的，它们将无助于开发人员准确地发现哪个步骤失败了。

有没有办法在 cloudbees 环境中使用 JBehave Hudson 插件？

在此先感谢，并为我糟糕的英语感到抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T09:15:36.773

只要你有付费订阅，你就可以在 DEV@Cloud 上安装这个 jenkins/hudson 插件。在这种情况下，请登录 GrandCentral 并使用支持链接请求在您的实例上安装插件。

免费帐户仅限于“[基本清单](http://wiki.cloudbees.com/bin/view/DEV/EssentialsPlugins)”

**更新 ：**

CloudBees 宣布所有订阅现在都将提供所有（兼容的）社区插件。

# iphone - NSString比较不起作用

> ID：12591999
> 
> 赞同：0
> 
> 时间：2012-09-25T22:25:17.050
> 
> 标签：iphone, objective-c, ios, rss, nsstring

> **可能重复：**
> [IF 子句不验证 NSString 函数返回？](https://stackoverflow.com/questions/7787020/if-clause-is-not-validating-nsstring-function-return)

我想做的是从 RSS 提要中获取项目，并根据它们的类型将它们存储在数组中。但问题是，当我比较字符串以分隔项目时，我检查并没有发生任何事情，并且字符串完全相同，但它说它们不相等。

```
- (void)parserDidEndDocument:(NSXMLParser *)parser {

    if (eventsList != nil) {
        for (int i = 0; i<[eventsList count]; i++) {
            NSMutableString* str = [[eventsList objectAtIndex:i] objectForKey:@"category"];
            if ([str isEqualToString:@"normal"]) {
                normalEvents = [[NSMutableArray alloc] init];
                [normalEvents addObject:eventsList];
            } else if ([str isEqualToString:@"sub"]) {

                subEvents = [[NSMutableArray alloc] init];
                [subEvents addObject:eventsList];
            } else if ([str isEqualToString:@"main"]) {
                NSLog(@"salve mundi");

                mainEvents = [[NSMutableArray alloc] init];
                [mainEvents addObject:eventsList];
            } else {
                NSLog(@"%@",str);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-25T22:26:24.973

使用`==`您比较对象的地址。要比较两个 NSString 的内容，您必须改用实例方法`[str isEqualToString:@"sub"]`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:46:18.593

我会做一些测试以确保字符串相等。例如，如果它在结尾或开头有空格，如果它是大写的，等等。

```
[[yourString lowercaseString] stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T22:26:20.410

```
if([str isEqualToString:@"normal"]) 
```