# StackOverflow 问答 13588000-13588999

# mysql - 获取 information_schema mysql 的权限

> ID：13588002
> 
> 赞同：2
> 
> 时间：2012-11-27T15:54:19.540
> 
> 标签：mysql, information-schema

如果我打开 MySQL Administrator 并尝试从数据库 information_schema 的表事件中删除一个事件，我会收到此错误：

```
Access denied for user 'root'@'localhost' to database 'information_schema' 
```

我需要什么特权？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T18:30:47.523

information_schema 表都是只读的，无法删除那里的任何行。

要删除事件，请使用`DROP EVENT`语句。

# java - java中的并发读/写缓冲区

> ID：13588003
> 
> 赞同：9
> 
> 时间：2012-11-27T15:54:20.180
> 
> 标签：java, multithreading, concurrency, thread-safety, locking

我正在尝试实现一个读/写缓冲区类，它可以支持多个写入器和读取器，并且读取器可以在写入器写入缓冲区时同时读取缓冲区。这是我的代码，到目前为止我还没有看到任何问题，但我不能 100% 确定这是否是线程安全的，或者是否有更好的方法。

```
public class Buffer{
       private StringBuilder sb = new StringBuilder();
       private final ReentrantReadWriteLock lock = new ReentrantReadWriteLock();
       private Random random = new Random();

       public void read(){
            try{
                lock.readLock().lock();
                System.out.println(sb.toString());
            } finally{
                lock.readLock().unlock();
            }
       }
       public void write(){
            try{
                lock.writeLock().lock();
                sb.append((char)(random.nextInt(26)+'a'));
            } finally{
                lock.writeLock().unlock();
            }
       }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T16:06:14.267

多线程安全没有任何问题！读写锁保护对 StringBuilder 的访问，代码简洁易读。

通过使用 ReentrantReadWriteLock，您实际上是最大限度地提高了实现更高程度的并发性的机会，因为多个读取器可以一起进行，所以这是一个比使用普通旧同步方法更好的解决方案。但是，与问题中所述相反，代码*不允许*作家在读者阅读时进行写作。不过，这本身并不一定是个问题。

读取器在继续之前获取读取锁。编写者在继续之前获取写锁。读锁的规则允许在没有写锁的情况下获取一个（但如果有一些读锁，即如果有更多的活动读者，也可以）。当且仅当没有其他锁（没有读取器，没有写入器）时，写入锁的规则才允许获取一个。因此允许多个读者，但只允许一个作家。

可能需要的唯一更改是将锁定初始化代码更改为：

```
private final ReentrantReadWriteLock lock = new ReentrantReadWriteLock(true); 
```

正如问题中给出的原始代码一样，不需要锁是公平的。通过上述更改，可以保证“线程使用近似到达顺序策略竞争进入。当写锁被释放时，等待时间最长的单个写入器将被分配写入锁，或者如果有一个读取器等待的时间超过任何写者，读者集都将被分配读锁。当构造为非公平时，进入锁的顺序不必是到达顺序。（取自[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)）

另请参阅以下内容（来自同一来源）：

ReentrantReadWriteLocks 可用于在某些集合的某些用途中提高并发性。这通常只有在预计集合很大、由比写入线程更多的读取线程访问并且需要开销超过同步开销的操作时才值得。例如，这是一个使用 TreeMap 的类，该类预计会很大并且可以同时访问。

```
class RWDictionary {
    private final Map<String, Data>  m = new TreeMap<String, Data>();
    private final ReentrantReadWriteLock rwl = new ReentrantReadWriteLock();
    private final Lock r = rwl.readLock();
    private final Lock w = rwl.writeLock();

    public Data get(String key) {
        r.lock(); try { return m.get(key); } finally { r.unlock(); }
    }
    public String[] allKeys() {
       r.lock(); try { return m.keySet().toArray(); } finally { r.unlock(); }
    }
    public Data put(String key, Data value) {
        w.lock(); try { return m.put(key, value); } finally { w.unlock(); }
    }
    public void clear() {
        w.lock(); try { m.clear(); } finally { w.unlock(); }
   }
 } 
```

API 文档的摘录特别注重性能。在您的具体情况下，我无法评论您是否符合“大型集合”标准，但我可以说输出到控制台比线程安全机制开销更耗时。无论如何，从逻辑的角度来看，您使用 ReentrantReadWriteLocks 是完全合理的，并且是完全线程安全的。这是很好的阅读代码:-)

注 1（回答有关原始问题评论中发现的异常的问题）：取自[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) lock() 获取锁。如果锁不可用，则当前线程将被禁用以用于线程调度目的并处于休眠状态，直到获得锁为止。

Lock 实现可能能够检测到锁的错误使用，例如会导致死锁的调用，并且在这种情况下可能会抛出（未经检查的）异常。该锁实现必须记录情况和异常类型。

[ReentrantReadWriteLock.ReadLock ( http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.ReadLock.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.ReadLock.html) )的相关文档中没有给出此类异常的指示或 ReentrantReadWriteLock.WriteLock ( [http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.WriteLock.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.WriteLock.html) )

注意 2：虽然对 StringBuilder 的访问受到锁的保护，但 System.out 不受。特别是，多个读取器可能会同时读取该值并尝试同时输出它。这也没关系，因为对 System.out.println() 的访问是同步的。

注意 3：如果你想禁止多个活跃的写入者，但允许一个写入者和一个或多个读取者同时活跃，你可以简单地跳过使用读锁，即删除 lock.readLock().lock(); 和 lock.readLock().unlock(); 在你的代码中。但是，在这种特殊情况下，这是错误的。您需要停止对 StringBuilder 的并发读写。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T16:06:10.333

描述和代码似乎是两个不同的东西。你在描述中说你想让读者阅读，而作者（我假设一次一个）写作。但是，您的读取方法也有锁定。因此，现在您一次只有一个读取器或写入器访问您的缓冲区。

如果您想在有写入器的情况下让读取器访问，请从读取方法中删除锁定。

# node.js - 尝试使用 KOGrid 在节点 js 网格中创建 onclick 事件

> ID：13588004
> 
> 赞同：1
> 
> 时间：2012-11-27T15:54:21.620
> 
> 标签：node.js, knockout.js, grid, kogrid

我想在 HTML 页面中有一个很好的交互式网格视图。我正在为我的技术堆栈使用 nodejs、express、twitterbootstrap、knockoutjs。我正在尝试使用 KOGrid 来显示各种数据点，这些数据点具有一些不错的内置列排序和其他网格功能。

我的问题是尝试在连续单击按钮时触发事件。并将该特定行中的一些各种数据字段传递给该事件。所以在 KOGrid 的细节中，我使用的是 cellTemplates，我需要在 onclick 事件中调用一些函数，但是向该函数传递一些 KOGRID 数据有界值。所以，在我的输入元素中我会有 data-bind="onclick: [Name of my function]([name of some data bounded variable], [name of some other data bounded variable])

有人可以告诉我如何做到这一点吗？

这是我的代码示例... CBTemplate 中的输入/单击是我遇到问题的地方。

CB模板：

```
<script type="text/html" id="actionTemplate">
<div data-bind="kgCell: $cell">
<input type="checkbox" value="1" class="checkbox" checked="checked" data-bind="onclick: 'MyOnClickFunction( siteId(), status() )'"/>
</div>
</script> 
```

分区标签：

```
<div data-bind="koGrid: { data: offer.siteCounts,
                    columnDefs: [ { field: 'templateField0', displayName: 'Site', cellTemplate: 'siteTemplate', width: 150},
                                 { field: 'status', displayName: 'Current Status', cellClass: 'site', cellTemplate: 'statusTemplate', width: 115},
                                 { field: 'details', displayName: 'Details', width: 175},
                                 { field: 'actionField0', displayName: 'Action', cellTemplate: 'cbTemplate', width: 200}],
                    autogenerateColumns: false,
                    displaySelectionCheckbox: false,
                    isMultiSelect: false }">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T19:13:00.117

使用 KO的[click 事件绑定](http://knockoutjs.com/documentation/click-binding.html)应如下所示：

```
data-bind="click: function(data,event) { MyOnClickFunction(siteId(), status()) }" 
```

这是一个[有效的 JSFiddle](http://jsfiddle.net/nemesv/ttBCQ/1/)，您可以在其中使用它。

一些旁注：

*   在我的示例中，我使用了`$root` [绑定上下文属性](http://knockoutjs.com/documentation/binding-context.html)来访问示例函数： `$root.offer.MyOnClickFunction`. 您需要根据您在视图模型上定义的级别来调整它`MyOnClickFunction`。

*   `return true`如果您确实想让默认单击操作继续进行（例如选中复选框等），则需要从单击绑定处理程序中

# clojure - 如何在 Clojure 中做钩子

> ID：13588005
> 
> 赞同：5
> 
> 时间：2012-11-27T15:54:22.180
> 
> 标签：clojure, hook

我有一种情况，我在一个 clojure 命名空间中创建和销毁对象，并希望另一个命名空间进行协调。但是，我不希望第一个命名空间必须在对象销毁时显式调用第二个命名空间。

在 Java 中，我可以使用监听器。不幸的是，底层的 java 库不会在对象销毁时发出事件信号。如果我在 Emacs-Lisp 中，那么我会使用钩子来解决问题。

现在，在clojure中我不太确定。我找到了 Robert Hooke 库[https://github.com/technomancy/robert-hook](https://github.com/technomancy/robert-hooke)。但这更像是 elisp 术语中的 defadvice——我正在编写函数。更多的文档说：

“钩子旨在扩展您无法控制的功能；如果您拥有目标功能，显然有更好的方法来改变它的行为。”

可悲的是，我发现它并不那么明显。

另一种可能性是使用 add-watch，但这被标记为 alpha。

我错过了另一个明显的解决方案吗？

示例添加：

所以第一个命名空间....

```
(ns scratch-clj.first
   (:require [scratch-clj.another]))

(def listf (ref ()))

(defn add-object []
  (dosync
    (ref-set listf (conj
               @listf (Object.))))
  (println listf))

(defn remove-object []
  (scratch-clj.another/do-something-useful (first @listf))
  (dosync
     (ref-set listf (rest @listf)))
  (println listf))

(add-object)
(remove-object) 
```

第二个命名空间

```
(ns scratch-clj.another)

(defn do-something-useful [object]
   (println "object removed is:" object)) 
```

这里的问题是，scratch-clj.first 必须要求另一个并明确地推送删除事件。这有点笨拙，但如果我有“又一个”命名空间，它也想听，也不起作用。

因此，我想到了挂钩第一个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:41:11.730

该解决方案是否适合您的要求？

从头开始clj.first：

```
(ns scratch-clj.first)

(def listf (atom []))
(def destroy-listeners (atom []))
(def add-listeners (atom []))

(defn add-destroy-listener [f]
  (swap! destroy-listeners conj f))

(defn add-add-listener [f]
  (swap! add-listeners conj f))

(defn add-object []
  (let [o (Object.)]
   (doseq [f @add-listeners] (f o))
   (swap! listf conj o)
   (println @listf)))

(defn remove-object []
  (doseq [f @destroy-listeners] (f (first @listf)))
  (swap! listf rest)
  (println @listf)) 
```

一些听众：

```
(ns scratch-clj.another
  (:require [scratch-clj.first :as fst]))

(defn do-something-useful-on-remove [object]
  (println "object removed is:" object))

(defn do-something-useful-on-add [object]
  (println "object added is:" object)) 
```

初始化绑定：

```
(ns scratch-clj.testit
  (require [scratch-clj.another :as another]
           [scratch-clj.first :as fst]))

(defn add-listeners []
  (fst/add-destroy-listener another/do-something-useful-on-remove)
  (fst/add-add-listener another/do-something-useful-on-add))

(defn test-it []
  (add-listeners)
  (fst/add-object)
  (fst/remove-object)) 
```

测试：

```
(test-it)
=> object added is: #<Object java.lang.Object@c7aaef>
   [#<Object java.lang.Object@c7aaef>]
   object removed is: #<Object java.lang.Object@c7aaef>
   () 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:15:31.603

听起来很像您所描述的回调。

就像是：

```
(defn make-object 
  [destructor-fn] 
  {:destructor destructor-fn :other-data "data"})

(defn destroy-object
  [obj]
  ((:destructor obj) obj))

; somewhere at the calling code...

user> (defn my-callback [o] (pr [:destroying o]))
#'user/my-callback
user> (destroy-object (make-object my-callback))
[:destroying {:destructor #<user$my_callback user$my_callback@73b8cdd5>, :other-data "data"}]
nil
user> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:09:50.673

所以，这是我遵循 mobytes 建议的最终解决方案。更多的工作，但我怀疑我将来会想要这个。

感谢所有的帮助

```
;; hook system
(defn make-hook []
  (atom []))

(defn add-hook [hook func]
  (do
    (when-not
        (some #{func} @hook)
      (swap! hook conj func))
    @hook))

(defn remove-hook [hook func]
  (swap! hook
         (partial
          remove #{func})))

(defn clear-hook [hook]
  (reset! hook []))

(defn run-hook
  ([hook]
      (doseq [func @hook] (func)))
  ([hook & rest]
      (doseq [func @hook] (apply func rest))))

(defn phils-hook []
  (println "Phils hook"))

(defn phils-hook2 []
  (println "Phils hook2"))

(def test-hook (make-hook))
(add-hook test-hook phils-hook)
(add-hook test-hook phils-hook2)
(run-hook test-hook)
(remove-hook test-hook phils-hook)
(run-hook test-hook) 
```

# google-chrome - ipython笔记本内核运行，但没有连接

> ID：13588012
> 
> 赞同：3
> 
> 时间：2012-11-27T15:54:41.753
> 
> 标签：google-chrome, tornado, ipython

我的公司让我每年轮换我的笔记本电脑。

我正在尝试使用笔记本重新安装 ipython（以前它工作得很好）。

根据命令提示符，一切都是 hunky dory。

[NotebookApp] IPython Notebook 正在运行：//127.0.0.1:8888 [NotebookApp] 使用 Control-C 停止此服务器并关闭所有内核。

但是，Chrome 无法连接到 //127.0.0.1:8888/

我怀疑这是龙卷风的版本控制问题，但想知道是否有其他人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T11:40:10.370

问题不在于 ipython，而在于公司政策设置的用于阻止 localhost 服务器的防病毒软件。这通过致电 IT 部门要求他们从我的计算机中删除违规业务规则来解决。

有两点值得注意：

(1.) ipython notebook --debug

这提供了关于幕后发生的事情的更多细节，并提供了一个开始解决问题的地方（尽管不会被配置错误抛出，这是一个红鲱鱼）

(2.) 在命令行中，这是成功连接的样子：

```
[NotebookApp] Kernel started: 77bb1680-ef54-4bf2-b9be-dc49dab639d7
[NotebookApp] Connecting to: tcp://127.0.0.1:52601
[NotebookApp] Connecting to: tcp://127.0.0.1:52603
[NotebookApp] Connecting to: tcp://127.0.0.1:52600
[IPKernelApp] To connect another client to this kernel, use:
[IPKernelApp] --existing kernel-77bb1680-ef54-4bf2-b9be-dc49dab639d7.json 
```

在我的例子中，我得到的是：

```
[NotebookApp] Kernel started: 77bb1680-ef54-4bf2-b9be-dc49dab639d7 
```

这将告诉您连接到客户端时出现问题。

# streaming - 如何让 libVLC 从流中播放分段数据包？

> ID：13588018
> 
> 赞同：2
> 
> 时间：2012-11-27T15:55:01.407
> 
> 标签：streaming, libvlc

我很好奇如何使用 libVLC 播放通过网络下载的剪辑片段。我们正在开发一种 P2P 程序，其中数据包可以通过多条路径到达目的地。一旦它到达那里，我需要知道如何玩它。我的想法是将它放在缓冲区中，播放器将以 FIFO 方式播放数据包。

我拥有的代码是[本教程](http://wiki.videolan.org/LibVLC_Tutorial)的修改版本。我知道它可以直接接收流并且几乎可以播放我们给它的任何文件。但是，我不知道该怎么做，以便我可以将一段文件（从数据包中获得）放入缓冲区并让它播放。

我的很多搜索结果都看到了 libvlc_video_set_callbacks() 但我看不到这有什么帮助。如果重要的话，我们现在只考虑 MP4 文件，稍后会扩展。

# c# - 通过自定义属性（json.net）从序列化中排除属性

> ID：13588022
> 
> 赞同：63
> 
> 时间：2012-11-27T15:55:21.587
> 
> 标签：c#, serialization, json.net, custom-attributes

我需要能够控制类上的某些属性如何/是否被序列化。最简单的情况是`[ScriptIgnore]`。但是，我只希望在我正在处理的这一特定序列化情况下尊重这些属性 - 如果应用程序下游的其他模块也想要序列化这些对象，则这些属性都不应该妨碍。

所以我的想法是在属性`MyAttribute`上使用自定义属性，并使用知道查找该属性的钩子初始化 JsonSerializer 的特定实例。

乍一看，我没有看到 JSON.NET 中的任何可用挂钩点将为`PropertyInfo`当前属性提供进行此类检查的方法 - 只有属性的值。我错过了什么吗？或者更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-01-24T20:28:17.197

这是一个基于[公认答案](https://stackoverflow.com/questions/13588022/exclude-property-from-serialization-via-custom-attribute-json-net/13588192#13588192)的通用可重用“忽略属性”解析器：

```
/// <summary>
/// Special JsonConvert resolver that allows you to ignore properties.  See https://stackoverflow.com/a/13588192/1037948
/// </summary>
public class IgnorableSerializerContractResolver : DefaultContractResolver {
    protected readonly Dictionary<Type, HashSet<string>> Ignores;

    public IgnorableSerializerContractResolver() {
        this.Ignores = new Dictionary<Type, HashSet<string>>();
    }

    /// <summary>
    /// Explicitly ignore the given property(s) for the given type
    /// </summary>
    /// <param name="type"></param>
    /// <param name="propertyName">one or more properties to ignore.  Leave empty to ignore the type entirely.</param>
    public void Ignore(Type type, params string[] propertyName) {
        // start bucket if DNE
        if (!this.Ignores.ContainsKey(type)) this.Ignores[type] = new HashSet<string>();

        foreach (var prop in propertyName) {
            this.Ignores[type].Add(prop);
        }
    }

    /// <summary>
    /// Is the given property for the given type ignored?
    /// </summary>
    /// <param name="type"></param>
    /// <param name="propertyName"></param>
    /// <returns></returns>
    public bool IsIgnored(Type type, string propertyName) {
        if (!this.Ignores.ContainsKey(type)) return false;

        // if no properties provided, ignore the type entirely
        if (this.Ignores[type].Count == 0) return true;

        return this.Ignores[type].Contains(propertyName);
    }

    /// <summary>
    /// The decision logic goes here
    /// </summary>
    /// <param name="member"></param>
    /// <param name="memberSerialization"></param>
    /// <returns></returns>
    protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization) {
        JsonProperty property = base.CreateProperty(member, memberSerialization);

        if (this.IsIgnored(property.DeclaringType, property.PropertyName)
        // need to check basetype as well for EF -- @per comment by user576838
        || this.IsIgnored(property.DeclaringType.BaseType, property.PropertyName)) {
            property.ShouldSerialize = instance => { return false; };
        }

        return property;
    }
} 
```

* * *

和用法：

```
var jsonResolver = new IgnorableSerializerContractResolver();
// ignore single property
jsonResolver.Ignore(typeof(Company), "WebSites");
// ignore single datatype
jsonResolver.Ignore(typeof(System.Data.Objects.DataClasses.EntityObject));
var jsonSettings = new JsonSerializerSettings() { ReferenceLoopHandling = ReferenceLoopHandling.Ignore, ContractResolver = jsonResolver }; 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2014-10-10T22:46:07.373

使用`JsonIgnore`属性。

例如，要排除`Id`：

```
public class Person {
    [JsonIgnore]
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-11-27T16:04:26.710

你有几个选择。我建议您在阅读以下内容之前阅读有关该主题的 Json.Net 文档[文章。](http://james.newtonking.com/projects/json/help/index.html?topic=html/ConditionalProperties.htm)

文章介绍了两种方法：

1.  创建一个`bool`根据 Json.Net 将遵循的命名约定返回值的方法，以确定是否序列化该属性。
2.  创建一个忽略该属性的自定义合同解析器。

两者之中，我赞成后者。完全跳过属性——仅使用它们来忽略所有形式的序列化中的属性。相反，创建一个忽略相关属性的自定义合约解析器，并且仅在您想要忽略该属性时使用合约解析器，让该类的其他用户可以自由地序列化该属性，也可以不随心所欲。

**编辑**为了避免链接腐烂，我从文章中发布了有问题的代码

```
public class ShouldSerializeContractResolver : DefaultContractResolver
{
   public new static readonly ShouldSerializeContractResolver Instance =
                                 new ShouldSerializeContractResolver();

   protected override JsonProperty CreateProperty( MemberInfo member,
                                    MemberSerialization memberSerialization )
   {
      JsonProperty property = base.CreateProperty( member, memberSerialization );

      if( property.DeclaringType == typeof(Employee) &&
            property.PropertyName == "Manager" )
      {
         property.ShouldSerialize = instance =>
         {
            // replace this logic with your own, probably just  
            // return false;
            Employee e = (Employee)instance;
            return e.Manager != e;
         };
      }

      return property;
   }
} 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-05-20T10:18:49.363

这是一种基于 drzaus 的优秀序列化器合约的方法，它使用 lambda 表达式。只需将其添加到同一类。毕竟，谁不喜欢编译器来检查它们呢？

```
public IgnorableSerializerContractResolver Ignore<TModel>(Expression<Func<TModel, object>> selector)
{
    MemberExpression body = selector.Body as MemberExpression;

    if (body == null)
    {
        UnaryExpression ubody = (UnaryExpression)selector.Body;
        body = ubody.Operand as MemberExpression;

        if (body == null)
        {
            throw new ArgumentException("Could not get property name", "selector");
        }
    }

    string propertyName = body.Member.Name;
    this.Ignore(typeof (TModel), propertyName);
    return this;
} 
```

您现在可以轻松流畅地忽略属性：

```
contract.Ignore<Node>(node => node.NextNode)
    .Ignore<Node>(node => node.AvailableNodes); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-07T14:27:56.507

我不在乎将属性名称设置为字符串，以防他们改变它会破坏我的其他代码。

我在需要序列化的对象上有几个“视图模式”，所以我最终在合同解析器中做了这样的事情（构造函数参数提供的视图模式）：

```
protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)
{
    JsonProperty property = base.CreateProperty(member, memberSerialization);
    if (viewMode == ViewModeEnum.UnregisteredCustomer && member.GetCustomAttributes(typeof(UnregisteredCustomerAttribute), true).Length == 0)
    {
        property.ShouldSerialize = instance => { return false; };
    }

    return property;
} 
```

我的对象看起来像这样：

```
public interface IStatement
{
    [UnregisteredCustomer]
    string PolicyNumber { get; set; }

    string PlanCode { get; set; }

    PlanStatus PlanStatus { get; set; }

    [UnregisteredCustomer]
    decimal TotalAmount { get; }

    [UnregisteredCustomer]
    ICollection<IBalance> Balances { get; }

    void SetBalances(IBalance[] balances);
} 
```

这样做的缺点是解析器中的一些反射，但我认为拥有更多可维护的代码是值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-29T18:01:08.670

结合 drzaus 和 Steve Rukuts 的答案，我得到了很好的结果。但是，当我为属性设置不同的名称或大写字母时，我遇到了一个问题。例如：

```
[JsonProperty("username")]
public string Username { get; set; } 
```

将 UnderlyingName 纳入考虑可解决问题：

```
protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)
{
    JsonProperty property = base.CreateProperty(member, memberSerialization);

    if (this.IsIgnored(property.DeclaringType, property.PropertyName)
        || this.IsIgnored(property.DeclaringType, property.UnderlyingName)
        || this.IsIgnored(property.DeclaringType.BaseType, property.PropertyName)
        || this.IsIgnored(property.DeclaringType.BaseType, property.UnderlyingName))
    {
        property.ShouldSerialize = instance => { return false; };
    }

    return property;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-04T17:25:22.653

如果您愿意使用 F#（或者只是使用未针对 C# 优化的 API），[FSharp.JsonSkippable](https://github.com/cmeeren/FSharp.JsonSkippable)库允许您以简单且强类型的方式控制在序列化时是否包含给定属性（并确定属性是否反序列化时包括在内），此外，用于控制/确定排除可空性。（完全披露：我是图书馆的作者。）

# python - python os.sytem 从 cgi 杀死进程

> ID：13588024
> 
> 赞同：0
> 
> 时间：2012-11-27T15:55:30.483
> 
> 标签：python, linux, process

我正在尝试从网页中杀死一个进程。

```
import os

os.system(“killall Laser”)

print("Content-Type: text/HTML;charset=utf-8")
print("")
print("Laser has been restarted.") 
```

文件权限设置为777，我设置了setuid和setgid。该脚本在我从命令行运行但不在浏览器中运行时有效。

这是在 ubuntu 上运行的，网络服务器是 lighthttp。

该进程归根用户所有。

我也尝试过使用：

```
import subprocess as sub, cgitb

cgitb.enable(display=0, logdir="/tmp")

p = sub.Popen(['killall;', 'Laser'],shell=True,stdout=sub.PIPE,stderr=sub.PIPE)
output, errors = p.communicate()
print("Content-Type: text/HTML;charset=utf-8")
print("")
print(output) 
```

和：

```
import subprocess as sub, cgitb

cgitb.enable(display=0, logdir="/tmp")

cmd1 = "su root"
cmd2 = "killall Laser"
p = sub.Popen("{}; {}".format(cmd1, cmd2),shell=True,stdout=sub.PIPE,stderr=sub.PIPE, close_fds=True)
output, errors = p.communicate()
print("Content-Type: text/HTML;charset=utf-8")
print("")
print(output) 
```

有任何想法吗？

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:23:37.227

您应该通过 ligghtpd 在其配置中分配 .py 文件作为 CGI/fastcgi-scripts 运行：

```
$HTTP["url"] =~ "^/cgi-bin/" {
        cgi.assign = ( ".py" => "/usr/bin/python" )
} 
```

并且不要忘记 python 脚本第一行上的 shebang (#!/usr/bin/env python)。阅读此处了解更多详情：[http ://ubuntuforums.org/showthread.php?t=1166401](http://ubuntuforums.org/showthread.php?t=1166401)

# python - 字符串中字母的索引 - python 2.7

> ID：13588028
> 
> 赞同：0
> 
> 时间：2012-11-27T15:55:51.953
> 
> 标签：python, string, list, function, indexing

********我正在编辑这个问题，因为我有一些错误，请再读一遍****** *****

 **我正在构建一个用单词构建字典的函数，例如：

```
{'b': ['b', 'bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'], 'bi': ['bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'], 'birt': ['birt', 'birth', 'birthd', 'birthda', 'birthday'], 'birthda': ['birthda', 'birthday'], 'birthday': ['birthday'], 'birth': ['birth', 'birthd', 'birthda', 'birthday'], 'birthd': ['birthd', 'birthda', 'birthday'], 'bir': ['bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday']} 
```

这是它的样子：

```
def add_prefixs(word, prefix_dict):
lst=[]
for letter in word:
    n=word.index(letter)
    if n==0:
        lst.append(word[0])
    else:
        lst.append(word[0:n])
lst.append(word)
lst.remove(lst[0])
for elem in lst:
    b=lst.index(elem)
    prefix_dict[elem]=lst[b:]
return prefix_dict 
```

它适用于“生日”之类的单词，但是当我有一个重复的字母时，我遇到了问题......例如，“你好”。

```
{'h': ['h', 'he', 'he', 'hell', 'hello'], 'hell': ['hell', 'hello'], 'hello': ['hello'], 'he': ['he', 'he', 'hell', 'hello']} 
```

我知道这是因为索引（python选择第一次出现字母的索引）但我不知道如何解决它。是的，这是我的作业，我真的很想向你们学习 :)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:57:55.023

使用[`enumerate`](http://docs.python.org/2/library/functions.html#enumerate)：

```
for n, letter in enumerate(word):
    if n==0 or n==1:
        continue
    else:
        lst.append(word[0:n]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:03:41.250

```
a = 'birthday'
[a[:i] for i in range(2,len(a)+1)] 
```

给

```
['bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'] 
```

所以你可以用简单的替换你的函数：

```
prefix_dict[word] = [word[:i] for i in range(2,len(word)+1)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:01:44.460

假设变量 a 是一个简单的字符串（例如，“birthday”、“hello”），您可以使用：

```
for i in range(1,len(a)):
    print a[0:i+1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:07:47.733

```
def add_prefixs(word, prefix_dict):
    prefix_dict[word] = [ word[:n+1] for n in range(1, len(word)) ] 
```

更好的是：

```
def get_words(word):
    return [ word[:n+1] for n in range(1, len(word)) ]
prefix_dict[word] = get_words(word) 
```

So you keep your function "pure".**

# jquery - JQuery Chosen 插件 - 附加使用 Ajax 加载的选项

> ID：13588030
> 
> 赞同：0
> 
> 时间：2012-11-27T15:56:03.883
> 
> 标签：jquery, ajax, select, jquery-plugins, jquery-chosen

使用带有选择插件的标准选择。除了客户端匹配之外，我还需要显示一个包含搜索词的附加项目列表，并使用 ajax 返回。

我发现的 ajax-chosen 插件*替换*了所有结果，并且似乎不允许*附加*到已经匹配的选项。这是我正在寻找的结果：

```
    选项组 A
       选项1
       选项 2
     选项组 B
       选项 3
       选项 4
     从服务器加载的选项
       加载了 ajax 1 的选项
       加载了 ajax 2 的选项

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:07:49.493

要从 ajax 动态更新，我已附加到原始选择：

```
$.each(data, function (index, element) {
    $('#inj-form-what-injury-type-detail')
    .append($("<option></option>")
    .attr("value", element.Type_No)
    .attr("selected", (element.isSelected) ? true : false)
    .text(element.Value));
}); 
```

然后，使用 liszt:updated 告诉 selected 你已经更新了选择选项

```
$('#inj-form-what-injury-type-detail').trigger("liszt:updated"); 
```

不确定这在使用搜索框时是否有效，但它可能为您的方法提供基础。

[来自选择的文档](http://harvesthq.github.com/chosen/)

# jquery - 查找被点击的元素改变兄弟姐妹

> ID：13588031
> 
> 赞同：0
> 
> 时间：2012-11-27T15:56:04.893
> 
> 标签：jquery

我想更改列表中的所有元素，但单击的元素除外。我想我需要确定实际点击了什么，然后改变它的兄弟姐妹？如何找到点击了哪个元素？

```
<ul>
    <li><h4 class="span1"><a href="#" class="sort" data-sort="ID">ID<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
    <li><h4 class="span2"><a href="#" class="sort" data-sort="Type">Type<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
    <li><h4 class="span3"><a href="#" class="sort" data-sort="Task">Task<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
    <li><h4 class="span8"><a href="#" class="sort" data-sort="Project">Project<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
    <li><h4 class="span3a"><a href="#" class="sort" data-sort="DueDate">Urgency<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
    <li><h4 class="span3 last"><a href="#" class="sort" data-sort="Created">Date Created<i class="icon-arrow-down" aria-hidden="true"></i></a></h4></li>
</ul> 
```

```
$('.sort').click(function () {
    $(this).data('clicked', true);

    if($(this).data('clicked')) {
        $('i', this).toggleClass('icon-arrow-down').toggleClass('icon-arrow-up');
    } 
    else {
        $('.sort i').siblings().removeClass('icon-arrow-up').addClass('icon-arrow-down');
    }
}); 
```

* * *

回答：

```
$('.sort').click(function() {
    $(this).closest('li').siblings().find('i').removeClass('icon-arrow-up').addClass('icon-arrow-down');
    $(this).find('i').toggleClass('icon-arrow-down icon-arrow-up');
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:00:04.490

你想做这样的事情：

```
$('.sort').click(function (e) {
    $('.sort').not(e.currentTarget).css({
        color: 'red'
    });
    return false
});​ 
```

这是一个小提琴：http: [//jsfiddle.net/th3KV/](http://jsfiddle.net/th3KV/)

你的代码：

```
$('.sort').click(function (e) {

    $(this).find('i').toggleClass('icon-arrow-down icon-arrow-up');

    $('.sort').not(e.currentTarget).each(function(){
        $(this).find('i').removeClass('icon-arrow-up').addClass('icon-arrow-down');
    });
    return false
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:03:08.107

试试这个：

```
$('.sort').click(function() {
    $(".sort i").removeClass('icon-arrow-up').addClass('icon-arrow-down');
    $("i", this).toggleClass('icon-arrow-down icon-arrow-up')
}); 
```

[**示例小提琴**](http://jsfiddle.net/BHtw5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:04:12.000

假设每个 a 标记对于 data-sort 属性都是唯一的，如上例所示：

```
$('.sort').click(function () {

$("ul li").each($.proxy(function(index, item) {
if ($("a", item).data("sort") !== $(this).data("sort") {
  //different element than the one clicked
}
}, this)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:06:55.840

由于`$(this)`表示单击的锚元素，`siblings()`因此无法访问其他`li`元素。相反，寻找上面两层元素的兄弟姐妹，如下所示：

```
$(this).parent().parent().siblings().removeClass("foo"); 
```

或者更改标记，以便您定位到`li`而不是其中包含的锚点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T16:28:25.453

我认为这是相对容易阅读和理解的：

```
$('a.sort').click(function () {
    $("i", this)
        .toggleClass('icon-arrow-down')
        .toggleClass('icon-arrow-up')
        .closest("li")
        .siblings()
        .find("i")
        .removeClass('icon-arrow-up')
        .addClass('icon-arrow-down');
});​ 
```

# java - 从 Powermock 测试执行时，ListenableFuture 行为似乎被“破坏”

> ID：13588038
> 
> 赞同：0
> 
> 时间：2012-11-27T15:56:33.030
> 
> 标签：java, guava, easymock, jdeveloper, powermock

基于[guava-libraries 示例](https://code.google.com/p/guava-libraries/wiki/ListenableFutureExplained)，我正在使用 ListenableFuture。

*我正在使用：*
java 1.6
JDeveloper
11.1.1.6.0 guava-13.0.1.jar
junit-4.5.jar
easymock-3.1.jar
powermock-easymock-1.4.12-full.jar

我试图确保在异步模式下调用被测方法。

我的 Manager.java 代码是：

```
 ...

    public synchronized void   refreshAsync(final String id) {
    m_Log.entry(id);

    ListeningExecutorService service =
        MoreExecutors.listeningDecorator(Executors.newCachedThreadPool());

    ListenableFuture<Details> getDetailsTask =
        service.submit(new Callable<Details>() {
            @Override
            public Details call() {
                System.out.println(Thread.currentThread().toString());
                return MyCacheManager.getDetails(id);
            }
        });

    Futures.addCallback(getDetailsTask ,
                        new FutureCallback<Details>() {
            // we want this handler to run immediately after we push the big red button!

            public void onSuccess(Details details) {
                System.out.println("Success");
                //TODO: publish event
            }

            public void onFailure(Throwable thrown) {
                System.out.println("Failed");
                //TODO: log
            }
        });

    service.shutdown();

    m_Log.exit("done async");
}

... 
```

我的测试是：

```
 @RunWith(PowerMockRunner.class)
    @PrepareForTest( { Manager.class,  MyCacheManager.class, TWResourceManager.class, Logger.class })
    public class DetailsTests {
    {

        ...

        @Test (timeout = 4000) 
        public void refreshAsync_RequestedInAsyncMode_NoWaitForComplete() throws Exception {

            // Creating nice mock - because we are not caring about methods call order
            mockStatic(MyCacheManager.class);

            // Setup
            final int operationTimeMilis = 5000;
            expect(MyCacheManager.getDetails(anyObject(String.class))).andStubAnswer(new IAnswer<Details>() {
                    public Details answer() {
                        try {
                            System.out.println("start waiting 5 sec");
                            System.out.println(Thread.currentThread().toString());
                            Thread.sleep(operationTimeMilis);
                            System.out.println("finished waiting 5 sec");
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                        return Details.getEmpty();
                    }
                });

            replay(MyCacheManager.class);

            replayAll();

            ISchemaActionsContract controller = new TWManager();
            controller.refreshSchemaDetailsAsync("schema_id");

            // We need not to verify mocks, since all we are testing is timeout
            // verifyAll();
        }
    } 
```

当我运行/调试测试时 - 它总是在超时时失败。似乎在“同步”模式下调用了模拟方法“MyCacheManager.getDetails”。

但是当我从常规代码/调试中调用相同的函数时 - 它在异步模式下运行（我将 Thread.sleep(10000) 放入 MyCacheManager.getDetails 方法，并且 Manager.refreshAsync 方法在没有等待/被阻止的情况下退出。

此外，如果我将方法更改为使用常规 FutureTask，测试将按预期通过。

```
 ...

        Object res = null;
        FutureTask task = new FutureTask(new Runnable() {
                @Override
                public void run() {
                    MyCacheManager.getDetails(id);
                }
            }, res);            

        m_Log.debug("async mode - send request and do not wait for answer.");

        Executors.newCachedThreadPool().submit(task); 
```

任何想法都会更受欢迎！:)
谢谢！

# asp.net - 如何使用 RSA 加密/解密 ASP.Net 表单身份验证票证

> ID：13588039
> 
> 赞同：2
> 
> 时间：2012-11-27T15:56:35.003
> 
> 标签：asp.net, forms-authentication, rsa, encryption-asymmetric

除了使用 FormsAuthentication.Encrypt / FormsAuthentication.Decrypt，是否可以使用机器密钥存储中现有的 RSA 容器来对票证进行加密/解密。

原因是我正在开发的 ASP.Net 应用程序旨在用于多个负载平衡服务器。因此，我需要将机器密钥复制到所有机器中的所有 web.config 文件中。由于我们已经将非对称加密 (RSA) 用于其他目的，因此我们通过 bat 文件和密钥容器 xml 在所有服务器中自动安装了一个通用 RSA 密钥容器。由于这种机制已经到位，我也想使用相同的 RSA 密钥容器来加密/解密表单身份验证票。

1.  这可能吗？如果是这样，我如何覆盖现有行为来实现这一点。
2.  如果可能的话，您是否看到使用 RSA 而不是标准加密的任何缺点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:59:27.053

是的，但这需要一些工作。

您将需要覆盖/替换 .NET 附带的标准身份验证模块，并复制所有现有功能，但要使用的 RSA 加密/解密方法的调用除外。

请参阅[http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.encrypt.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.encrypt.aspx)

如果您使用这些，您还需要编辑所有标准的内置登录页面。

作为模板，检查 FormsAuthenticationTicket 的来源，您将看到如何构造包含 UserID、Expiry Date 等参数的字符串，然后将该字符串传递给 Encrypt 方法，然后将其用作 cookie 值.

然后，您的新身份验证模块将必须像以前一样反转该加密并验证用户。

这是相当多的工作，收益相对较小，这取决于您希望使用 RSA 而不是使用的标准加密方法（他们已经提供了一些强大的加密方法，见[http://www.sourcetree.net/sourcetree /Development/Aspnet%20Examples/GenerateMachineKeyForWebConfig.aspx](http://www.sourcetree.net/sourcetree/Development/Aspnet%20Examples/GenerateMachineKeyForWebConfig.aspx) )

# javascript - 一次测试大量变量，只有真正的变量会受到影响

> ID：13588041
> 
> 赞同：0
> 
> 时间：2012-11-27T15:56:39.290
> 
> 标签：javascript

所以，我一直在尝试一段时间，但我做不到。

如果自定义属性是“nao”，我一次测试了 8 个变量：

```
if (CNome=="nao"||CMail=="nao"||CCor=="nao"||CBan=="nao"||CMen=="nao"||Ctem=="nao"||CCont=="nao"||Cnota=="nao"){
               alert("Alguns campos estão incorretos, por favor complete-os.")
            return false   
         } 
```

我需要用“nao”表示每个变量，这样我就可以改变某个标签类，关于如何用“nao”选择每个变量的任何想法？我可以做 8 个如果，但会占用太多空间 D：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:59:08.547

```
var fields = [CNome, CMail, CCor, CBan, CMen, Ctem, CCont, Cnota];
var naos = [];

for(var i = 0; i<fields.length; i++) {
  if(fields[i] === "nao") {
    // either add them to an array for later processing:
    naos.push(fields[i]);

    // or do something with them:
    doSomething(fields[i]);
  }
} 
```

# grails - Grails 中的媒体服务器插件

> ID：13588044
> 
> 赞同：1
> 
> 时间：2012-11-27T15:56:46.477
> 
> 标签：grails, video-streaming, grails-plugin

我想使用 Grails 实现一个简单的媒体服务器，它将视频专辑流式传输给用户。有谁知道这是怎么做到的吗？

谢谢，礼萨

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:36:21.343

GVPS 插件看起来是您最好的选择：http: [//grails.org/plugin/gvps](http://grails.org/plugin/gvps)

# jquery - 如何在jQuery的for循环中将变量添加到href？

> ID：13588047
> 
> 赞同：4
> 
> 时间：2012-11-27T15:56:48.847
> 
> 标签：jquery

我在 for 循环中创建了八个 div，并且我想将每个 div 的链接添加到不同的 html 页面。我还将html页面命名为0~7。那么如何将变量“i”放入href？谢谢！

```
for(i = 0; i < 8; i++) {
    counter[i] = increase * (i * 2);
    var div = $('<div class="node"><a id="link" href=i + ".html"><img src=archive/' + i + '.jpg width="200" height="200"/></a></div>');
    div.css({'top':yoffset,'left':innerWidth/8 * i});
    $('body').append(div);
    objects[i] = div;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T15:58:48.760

改变

```
var div = $('<div class="node"><a id="link" href=i+".html"><img src=archive/'+i+'.jpg width="200" height="200"/></a></div>'); 
```

至

```
var div = $('<div class="node"><a id="link" href="'+i+'.html"><img src=archive/'+i+'.jpg width="200" height="200"/></a></div>'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T15:59:01.460

```
var div = $('<div class="node"><a id="link" href="' + i + '.html"><img src=archive/' + i + '.jpg width="200" height="200"/></a></div>'); 
```

这应该使每个链接指向 <i>.html。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:07:19.293

我建议创建元素并设置属性，而不是为元素创建 HTML 代码：

```
for(i = 0; i < 8; i++) {
  counter[i] = increase * (i * 2);
  var img = $('<img>', { src = 'archive/' + i + '.jpg', width: '200', height: '200' });
  var a = $('<a>', { id: 'link', href: i + '.html' }).append(img);
  var div = $('<div>', { 'class': 'node' }).append(a).css({'top':yoffset,'left':innerWidth/8 * i});
  $('body').append(div);
  objects[i] = div;
} 
```

# servicestack - 安装 ServiceStack.Logging.Log4Net 后 ServiceStack webservice 中断

> ID：13588048
> 
> 赞同：1
> 
> 时间：2012-11-27T15:56:56.570
> 
> 标签：servicestack

使用包管理器（在 VS Express 2012 Web 中）安装 ServiceStack.Logging.Log4Net 后，工作的 Web 服务被破坏

初始化时引发的异常是：来自程序集“ServiceStack，版本=3.9.4.0，文化=中性，PublicKeyToken=null”的“ServiceStack.ServiceHost.ServiceRoutes”类型中的方法“添加”没有实现。

这发生在两个不同的应用程序中安装日志之后。（我故意尝试通过安装日志记录来破坏第二个，只是为了确定，它确实破坏了......）清理和重建整个事情并不能解决这个问题。

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T07:02:36.773

我们刚刚为 ServiceStack.Logging 重新部署了所有最新 (v1.04) 日志库，现在应该与最新版本的 ServiceStack.Common 库同步。

# haskell - 文件夹应用程序

> ID：13588055
> 
> 赞同：0
> 
> 时间：2012-11-27T15:57:15.227
> 
> 标签：haskell

最近我正在尝试使用 Foldr 解决一个问题。任务如下：

```
In:[5,1,3,8,2,4,7,1]
Out:[16,8] 
```

这意味着，我会将输入列表中位于奇数索引位置和偶数位的元素加倍。我在没有使用 foldr 的情况下编写了程序，如下所示：（它显示模式匹配失败：head[]）

```
findPos list elt =
  map fst $ filter ((elt==).snd) $ zip [0..] list

doublePos [] = []
doublePos (x:xs)
  | ((head(findPos xs x)`mod` 2) /= 0) && (x `mod` 2 == 0) =
      [2*x] ++ doublePos xs
  | otherwise = doublePos xs 
```

如何使用 foldr 编写此程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:12:16.590

`foldr`对于这个函数来说，这并不是一个好的选择，因为您需要从列表的前面传递每个元素的索引的奇偶校验。

列表推导可能是最干净的：

```
doublePos xs = [2*x | (i,x) <- zip [0..] xs, even x, odd i] 
```

或者您可以使用普通的旧递归：

```
doublePos' (_:x:xs)
  | even x    = (2*x) : doublePos' xs
  | otherwise =         doublePos' xs
doublePos' _ = [] 
```

但是，如果您必须使用`foldr`，您可以通过将累加器作为一个函数来实现，该函数将当前索引的奇偶校验作为参数：

```
doublePos'' xs = foldr step (const []) xs False where
  step x next p
    | p && even x = 2*x : next (not p)
    | otherwise   = next (not p) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:12:36.060

为什么您现有的代码会给您模式匹配失败：`doublePos [5,1,3,8,2,4,7,1]`将第二个等式与`x = 5`and匹配`xs = [1,3,8,2,4,7,1]`。这会导致`head (findPos [1,3,8,2,4,7,1] 5)`被评估，但这会减少到`head []`你得到你的错误。

对此进行扩展：您似乎希望摆脱的`findPos`是当前元素的索引，相对于原始列表的开头。但是你实际上从中得到的是当前元素下一次出现的索引，相对于下一个元素......如果它不再出现，你会得到一个错误。

（此处使用字符作为列表元素以避免列表索引和列表元素之间的混淆。）

```
 0   1   2   3   4   5   6   7   8   9  10     <-- indices relative to start
'H':'e':'l':'l':'o':' ':'t':'h':'e':'r':'e':[] <-- original list
     |           |
x = 'e'          |               V                 say we're here
   xs = 'l':'l':'o':' ':'t':'h':'e':'r':'e':[]     head (findPos xs x) = 6 but we wanted 1
                 |               ^
            x = 'o'                                say we're here instead
               xs = ' ':'t':'h':'e':'r':'e':[]     head (findPos xs x) = error "head []" but we wanted 4 
```

唯一可行的方法是将原始列表传递给`findPos`. 但是您唯一可用的列表是您尚未递归到的原始列表的那部分。无论如何，正如哈马尔的回答所见，有更好的方法来做到这一点。

# windows - EXE 文件中的 IMAGE_FILE_NET_RUN_FROM_SWAP 如何影响运行时库

> ID：13588057
> 
> 赞同：9
> 
> 时间：2012-11-27T15:57:22.293
> 
> 标签：windows, winapi

我的应用程序有时是从网络共享启动的，一些客户在运行应用程序时报告了外部异常 C0000006。根据我的谷歌研究，这“可能”与图像被分页和无法从网络重新加载有关。一种解决方法是告诉 Windows 将完整的图像文件加载到交换中并通过设置 IMAGE_FILE_NET_RUN_FROM_SWAP 标志从那里运行它

我的应用程序还依赖于在运行时加载的各种 .bpl 和 .dll 库。只有其中一些可以由我更改，一些由其他供应商提供。如果 exe 设置了这个标志，这个库会发生什么？是否也加载到交换文件中，或者它们是否仍被分页并在需要时重新加载？我是否也需要在库中包含这个标志？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:00:12.273

该标志仅适用于设置它的 PE 模块。因此，在 EXE 中设置标志并不意味着该 EXE 加载的模块会受到该标志的影响。由您的 EXE 加载的每个模块（DLL、包等）都将由加载器根据该模块中指定的 PE 选项进行处理。

因此，您需要在网络共享上的每个模块上设置 PE 标志。

对于它的价值，我建议`IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP`也添加。

# colors - Photoshop 是否总是将透明图像与白色混合？

> ID：13588058
> 
> 赞同：-2
> 
> 时间：2012-11-27T15:57:27.977
> 
> 标签：colors, photoshop, transparent, psd, color-blending

看起来 PSD 文件中的合并图像数据包含与白色混合的 RGB 数据（基于透明度）。这对所有版本的 Photoshop/PSD 都正确吗？我可以禁用它或控制该颜色吗？

上下文：我正在使用 C++ 代码阅读 PSD 文件（尽管回答我相信的问题不需要编码知识）。PSD 文件包含“图像数据部分”中所有图层的合并数据（RGB、透明度（如果有），然后是 alpha 蒙版）。根据我的经验，RGB 数据似乎是基于透明度与白色预乘的。当您想将该 RGB 与基于透明度的东西混合时，这会导致问题（想想：我将该数据用作游戏引擎中的纹理）。我附上了说明问题的图片。顶部图像是 PhotoShop 中的来源。左下角显示合并数据中的 RGB - 请参阅透明图像部分与白色混合。我的目标是从没有白色混合的所有图层中获取 RGB 数据，即右下角的图像（只有完全透明的部分填充有白色）。

![在此处输入图像描述](../Images/1d0e1a96a19e50842a07779b0ba0dcf4.png)

只需在任何忽略图层的工具（例如 IrfanView）中打开透明 PSD 文件，您就会看到图像预乘以白色。

像 PNG 这样的格式支持透明图像部分的颜色 - 不会与白色（或其他颜色）混合。

所以我的问题是：我可以控制那种混合白色吗？所有的 Photoshop 版本都这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T05:51:21.503

如果我正确理解您的问题，听起来您可能已将图层与白色默认背景合并。默认情况下，Photoshop 会将图像与其周围的颜色混合，因此如果您正在混合的图像周围有白色，那么是的，它将混合白色，这适用于所有版本的 Photoshop。

你应该在它自己的图层上有你想要模糊的东西，然后再试一次。

编辑：好的。好吧，它推出的是它应该推出的东西。我假设你正在使用高斯模糊，如果你是，它正在做它应该做的事情。为了达到您的期望，您不能单独使用模糊工具。有些形状比其他形状更清晰，有些形状比其他形状更模糊。由于高斯模糊对所有内容都设置了统一模糊，因此不可能期望 Photoshop 在一个简单的操作中完成您想要的操作（但如果您想多次执行此操作，您可以自己进行操作）。

为了从 A 点到 B 点，我建议将每条线放在它自己的层上开始，然后使用`smudge tool`and`blur tool`来获取你想要的线。这是涂抹工具的示例：

![在此处输入图像描述](../Images/587372b5b2cb111cf1c375440c2c4bb4.png)

您可能希望将画笔的硬度设置为 100% 而不是 0%，以获得更清晰的线条。Photoshop 很难像您要求的那样完全锐化一条完全模糊的线条。但是你仍然可以使用模糊的线条。对于你想要做的更凹凸不平的线条，你可以使用`Magic Wand`工具选择你的软笔触，然后用`Paint Bucket`工具填充它们以获得你正在寻找的效果（之前和之后）：

![在此处输入图像描述](../Images/2f2baf9c24a92b323f941843d3667278.png)

同样，Photoshop 没有内置的动作来做你想做的事。所有的内置函数都对整个图像产生通用效果，这适用于所有版本的 Photoshop，但很容易获得您想要的效果。确保一切都在它自己的图层上，并尝试使用 Photoshop 提供的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-14T08:42:52.843

你无法控制这一点。Photoshop 总是将图层与白色合并。

我们最终做的是在将 PSD 文件导入我们的引擎期间根据 alpha 值减去颜色。

# xml - WCF +“基础连接已关闭：连接意外关闭。”

> ID：13588060
> 
> 赞同：-1
> 
> 时间：2012-11-27T15:57:30.127
> 
> 标签：xml, wcf, escaping, wcf-client, connection-close

学习并获得一个有效的 WCF 来传输“网络爬行”数据是一场噩梦。

首先是 GoDaddy 的服务器创建了一个不可追踪的错误，在第一次连接/调用后每隔 15 秒关闭我的 WCF 连接，无论我是否在每次调用后关闭连接。几周后，当我最终联系 GoDaddy 寻求解决方案时，我用尽了所有可能的解决方案。在服务器迁移之后，这个问题就消失了。

在 15 秒的连接下降后拔掉头发几周后，我遇到了另一个不可追踪的错误…… **“底层连接已关闭：连接意外关闭。”** . 至此，我几乎放弃了 WCF 并回到了 ASMX 服务。

错误：**“基础连接已关闭：连接意外关闭。”** 非常通用，解决方案各不相同，因此难以诊断/修复。跟踪日志不显示 jack 并且由于某种原因，我的本地计算机上不会发生相同的错误，只会在服务器上发生。当我收到此错误时，服务器跟踪日志甚至不会显示客户端调用。就像调用从未从客户端发送到 WCF 服务......除此之外，客户端的跟踪日志没有显示任何内容，除了**“System.Threading._ThreadPoolWaitCallback.PerformWaitCallback(Object)”**错误，它没有没有帮助。

我已经在网上尝试了所有可能的解决方案或可能的方法来提供更有意义的跟踪，但没有运气。如果没有帮助的跟踪日志，其他人会遇到这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T15:57:30.127

**tl;dr：** 如果您在 WCF 中遇到此错误，我想了解的主要内容是在出错时尝试 Intelli-Sense 类型调试窗口中的放大镜图标/查看为 XML。错误可能会像我一样暴露出来。

* * *

起初我以为是类数组的序列化在它上线之前就搞砸了。该数组返回了大量的对象，有些是嵌套的，所以这是很有可能的。我使用 Xml.Serializer[将返回的 Class Array 序列化和反序列化为 XML 文档](http://support.microsoft.com/kb/316730)来测试这个理论。这工作正常，客户端没有抛出错误。规则序列化出来。

然后我想，也许我的 web.Config 文件中的设置之一没有正确设置。不，一切都通过正确的绑定、行为、限制、超时......一切看起来都很好。所以我想，也许因为我要进行多次调用，所以这是一个并发或线程问题。为了测试这一点，我每个请求只返回一组结果，而不是序列化类对象的数组。我又遇到了错误！所以这不是并发或线程问题。

但是，返回单个类对象导致了解决方案。我注意到一个对象每次都失败......但是这个类对象是几个字符串、整数和列表（另一个类）的容器。返回的主类中的子对象通常不超过 1000 个。然而，很明显，在这个对象中返回的东西存在问题。在不知道要寻找什么的情况下经历所有可能性*（通常在 500-1000 之间）*是一种大海捞针的问题。

幸运的是，当错误弹出给我**“底层连接已关闭：连接意外关闭”时。**当错误仍然显示时，我将鼠标悬停在发送到 WCF 服务的 List(Of Class) 上。这带来了一个智能感知类型的调试窗口，让您可以筛选列表（类）中的每个类，同时深入到类中的每个子对象。由于我只在我的 List(of class) 中返回了 1 个类，以帮助缩小范围，并假设不是 Integer 字段导致了问题 - 我直接返回了 String 变量。将它们复制并粘贴到记事本中，并没有真正看到我立即注意到的任何错误，尽管一些子对象引起了怀疑。然后出于好奇，我注意到这个智能感应类型调试窗口内的每个返回字符串旁边都有一个带有下拉箭头的小放大镜。我为我的每一个怀疑点了放大镜，并注意到一个选项以查看 XML 格式的字符串。我点击了这个，然后很长一段时间，我在其中一个有意义的字符串上出错了！该错误指出了与某些文本混合的未转义符号。我没有意识到这是一个禁忌，所以我转义了以下 5 个字符 &、<、>、"、'。我再次尝试并得到了一个新错误，**“XML 文档中只允许一个顶级元素。错误处理资源”**！@！

在做了一些研究之后，这个物体似乎还有一些时髦的东西。所以我尝试将可能的问题字符串包装在**"`<![CDATA["`** & **`"]]>`"**中。得到相同**的“XML 文档中只允许一个顶级元素。错误处理资源”**错误！原来有一些 CSS 以 {color:#000000;} 的格式从裂缝中溜走。由于某种原因，括号引起了问题。我假设原因是因为 CSS 的格式看起来很像 JSON，而客户端是这样看的。删除括号/CSS 后，**“XML 文档中只允许一个顶级元素。错误处理资源”**消失，对象成功传输。

对于冗长的描述性答案感到抱歉，但我没有看到其他人遇到这些问题，这并没有抛出有用的跟踪信息。希望这对其他人有帮助！*（我在这里发布，回答我自己的问题，因为虽然这是一个简单的解决方案，但解决起来非常令人沮丧。）*

# ruby-on-rails - Rails：如何为错误的日期添加验证，例如 11 月 31 日和 6 月 31 日。我使用 :date 作为我的列类型

> ID：13588063
> 
> 赞同：0
> 
> 时间：2012-11-27T15:57:46.193
> 
> 标签：ruby-on-rails, ruby

我有一个看起来像这样的表单 views/profiles/_form

```
<div class="field2">
<%= f.label :purchase_date, "Date this horse was purchased" %><br />
<%= f.date_select :purchase_date %>
</div>

<div class="field2">
<%= f.label :owner_name, "Owner Name" %><br />
<%= f.text_field :owner_name %>
 </div> 
```

我在我的模型/profile.rb 中添加了什么验证

验证：purchase_date ??????????

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:10:41.647

您想要[排除验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#exclusion)。它看起来像这样：

```
# Made it a constant, but could also be in a method.
EXCLUSION_DATE = [Date.new(2012,1,1), Date.new(2012,2,1)]
validates :purchase_date, :exclusion => { :in => EXCLUSION_DATES } 
```

您还可以随时添加自己的自定义验证：

```
validate :check_purchase_date # Name it whatever you want

private
  def check_purchase_date
    exclusion_dates = [Date.new(2012,1,1), Date.new(2012,2,1)]
    if exclusion_dates.include?(self.purchase_date)
      self.errors.add(:purchase_date, "cannot be on a reserved date.")
    end
  end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:09:08.210

例如，为什么不让用户从 jquery datepicker 中进行选择，这样您就可以立即消除 tje 问题？

# security - 保护 Raven 数据库

> ID：13588064
> 
> 赞同：0
> 
> 时间：2012-11-27T15:57:49.953
> 
> 标签：security, authorization, ravendb, ravendb-studio

我正在尝试将访问我们的 RavenDB 的权限仅限于一个用户。更改设置以保护数据库后，我仍然可以访问 RavenDB 管理工作室，但我不知道为什么。我将 RavenDB 作为 Windows 服务运行，并且使用的是 build 573。

**这是我的 Raven.Server.exe.config：**

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="Raven/Port" value="*"/>
    <add key="Raven/DataDir" value="~\Data"/>
    <add key="Raven/AnonymousAccess" value="None"/>  <!-- Settings are Get, All, None -->
    <add key="Raven/Authorization/Windows/RequiredUsers" value="FS-6103\PrestoDatabaseUser"/>
    <add key="Raven/MaxPageSize" value="2147483647"/>
  </appSettings>

    <runtime>
        <loadFromRemoteSources enabled="true"/>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <probing privatePath="Analyzers"/>
        </assemblyBinding>
    </runtime>
</configuration> 
```

如果我只允许`FS-6103\PrestoDatabaseUser`，为什么我仍然可以远程连接到管理工作室？我以我的 Windows AD 帐户登录。我什至可以修改文档，这正是我想要阻止的。我错过了一个设置吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:49:43.850

你说你在build 573？那是很老了。根据[发布历史](http://builds.hibernatingrhinos.com/builds/RavenDB)，它于 2011 年 12 月 15 日发布。有[一个日期为 2/22/2012 的提交](https://github.com/ravendb/ravendb/commit/539b2330a169d43bb71b0a64fb2601c7a0dbc86c)，上面写着*“如果用户不在组或用户列表中，则更改授权以返回 403”*。这可能是您需要的修复程序。

我会至少更新到最后一个稳定版本 - 1.0.960，看看你的问题是否仍然存在。

如果您不在生产环境中，那么现在是迁移到 2.0 不稳定版的好时机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T17:16:55.790

RavenDB 不保护 Studio 端点，因为您不需要这样做。如果 Studio 无法访问 RavenDB，它本身不会让您做任何事情。

如果您还想限制对工作室的访问，您可以使用 IIS 安全性来做到这一点，就像普通网站一样。但请记住，没有特别的理由这样做。

# php - 处理长 URL

> ID：13588069
> 
> 赞同：0
> 
> 时间：2012-11-27T15:58:09.850
> 
> 标签：php, html, http

我有一个`php`生成链接的脚本，其中的链接`URL`很长（对于 IE 来说太长而无法[处理](http://support.microsoft.com/kb/208427)`www.somesite.co.uk/here/query?foo=bar&bar=foo&.....`事实） ，例如`somesite.co.uk` `gets`值*（我无法更改为`post`）。*

所以在我的`index.php`：

```
echo "<a href='$url'>".$link."</a>"; 
```

对于低于限制的值，所有工作正常，`$url`页面被视为预期，但是如果超过限制，页面上的数据将被截断。

我创建了这个`long_url_test.php`脚本，它按预期加载了长值的页面`$url`

```
<?php
header('Location: $url');
?> 
```

我需要帮助把这一切放在一起，比如：

索引.php：

```
echo "<a href='long_url_test.php'>".$link."</a>"; # and POST $url to script 
```

long_url_test.php：

```
<?php
$url=$_POST['url']
header('Location: $url');
?> 
```

`index.php` `posts`url 上显示的链接在哪里`long_url_test.php`获取实际所需的页面，或者确实有*更好/更简单*的方法我应该这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:10:53.563

你为什么要生成这么长的 URL？在这一点上，您显然错过了更好的解决方案，例如会话。

如果我们只想在解决方案上贴上创可贴：

1.  将表单写入带有 squillion 隐藏字段的页面，其中包含您的数据，然后使链接发布表单。
2.  与 #1 相同，但使用 javascript。

稍微好一点：获取您想要传递的任何数据并运行它`base64_encode(serialize($your_data))`，看看您是否可以将其嵌入到 URL 中而不会遇到长度限制。如果您安装/启用了 Zlib，您也可以在其中添加一个`gzcompress()`。

尽管如此，我还是*很难*想象没有一个更简单/更好的解决方案可以让您的数据保持在服务器端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:26:48.010

不清楚如何`Header('Location:')`使用长网址（可能 - IE 错过了测试使用位置标头接收的网址的长度？），但是一旦你真的需要这些带有所有参数的网址（所以它们可以被人们共享）恐怕你会需要使用某种 URL 缩短。例如，为每组参数创建唯一 ID，并将真实参数保存到数据库中。收到获取请求后 - 获取唯一 ID 并从数据库中请求参数。否则，有人可能会复制 URL（由于 Location 标头而可以正常工作）并与其他人共享。`long_url_test.php`不会被执行并且 IE 将无法打开这样的 URL。

一旦您真的不需要该 url 可用于共享 - 而只是简单地用表单替换它：

```
echo "<form action=\"url without params\" method=\"POST\"><a href='#' onclick=\"this.parentNode.submit(); return false;\">".$link."</a>
<input type=\"hidden\" name=\"param1\" value=\"".$val1."\" />
</form>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:16:16.073

您可以将链接设为 POST 而不是提交。

```
<a href="#" onclick="document.myform.submit()">Click me</a>
<form name="myform" action="/here/query">
  <input type="hidden" name="foo" value="bar">
  <input type="hidden" name="bar" value="foo">
</form> 
```

或者，如果您需要它成为 GET。不过，不确定这是否适用于长 URL。

```
<a href="#" onclick="location.href='/here/query&foo=bar&bar=foo'">Click me</a> 
```

或者你可以试试 jQuery 和[Ajax](http://api.jquery.com/jQuery.ajax/)。我不确定这是否也有效。

```
<a href="#" id="mylink">Click me</a>

<script>
  $(document).ready(function() {
    $("#mylink").click(function() {
      $.ajax('/here/query&foo=bar&bar=foo').done(function(result) {
          //do something
        });
    });
  });
</script> 
```

顺便说一句，一些浏览器，包括 IE 版本，有 2000 个 URL 长度限制。

# python - Python minidom/xml：如何使用 minidom api 设置节点文本

> ID：13588072
> 
> 赞同：6
> 
> 时间：2012-11-27T15:58:10.047
> 
> 标签：python, xml

我目前正在尝试加载一个 xml 文件并修改一对 xml 标记中的文本，如下所示：

```
 <anode>sometext</anode> 
```

我目前有一个帮助函数`getText`，我用它来获取`sometext`上面的文本。现在我需要修改`childnodes`我猜的，在节点内修改具有上面显示的 XML 片段的节点，更改`sometext`为`othertext`. 常见的 API 补丁`getText`功能如下面的脚注所示。

所以我的问题是，这就是我们获取文本的方式，我该如何编写一个名为`setText(node,'newtext')`. 如果它在节点级别上运行，我更喜欢它自己找到所有子节点的方式，并且运行良好。

上一个问题有一个接受的答案，上面写着“[我不确定您是否可以就地修改 DOM](https://stackoverflow.com/questions/8076928/python-minidom-change-value-of-node) ”。这是真的吗？Minidom 是否如此损坏以至于它实际上是只读的？

* * *

作为脚注，要阅读 和 之间的文本`<anode>`，`</anode>`我很惊讶不存在直接简单的单个 minidom 函数，并且 Python xml 教程中建议使用这个小辅助函数：

```
import xml.dom.minidom

def getText(nodelist):
    rc = []
    for node in nodelist:
        if node.nodeType == node.TEXT_NODE:
            rc.append(node.data)
    return ''.join(rc)

# I've added this bit to make usage of the above clearer
def getTextFromNode(node):
   return getText(node.childNodes) 
```

[在 StackOverflow 的其他地方](https://stackoverflow.com/questions/317413/get-element-value-with-minidom-python)，我看到了 2008 年接受的答案：

```
 node[0].firstChild.nodeValue 
```

如果这就是使用 minidom 阅读的难度，那么看到人们说“不要这样做！”我并不感到惊讶。当您询问如何编写可能会修改 XML 文档的节点结构的内容时。

**更新**下面的答案表明它并不像我想象的那么难。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T19:37:51.387

实际上 minidom 并不比其他 dom 解析器更难使用，如果你不喜欢它，你可以考虑向 w3c 投诉

```
from xml.dom.minidom import parseString

XML = """
<nodeA>
    <nodeB>Text hello</nodeB>
    <nodeC><noText></noText></nodeC>
</nodeA>
"""

def replaceText(node, newText):
    if node.firstChild.nodeType != node.TEXT_NODE:
        raise Exception("node does not contain text")

    node.firstChild.replaceWholeText(newText)

def main():
    doc = parseString(XML)

    node = doc.getElementsByTagName('nodeB')[0]
    replaceText(node, "Hello World")

    print doc.toxml()

    try:
        node = doc.getElementsByTagName('nodeC')[0]
        replaceText(node, "Hello World")
    except:
        print "error"

if __name__ == '__main__':
    main() 
```

# yii - 在 YII 上找到瓶颈的最佳方法是什么？

> ID：13588077
> 
> 赞同：0
> 
> 时间：2012-11-27T15:58:16.060
> 
> 标签：yii

我已经尝试过调试工具栏，但它并没有完全涵盖我的场景。我只是想知道哪些代码执行时间最长。有没有办法获得细分（可能是瀑布图？），可以告诉我哪些方法执行时间最长？

更新：我能够在应用程序中添加各种日志记录，但不幸的是，我认为导致缓慢的部分实际上并没有导致缓慢。那么，我可以“全面”添加日志记录以查明任何可能导致缓慢的代码的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:35:37.510

查看[Xdebug](http://xdebug.org) - PHP 的调试器和分析器工具。

您可以使用 3rd 方工具生成分析输出并将其可视化，[单击此处](http://xdebug.org/docs/profiler)了解详细信息。

# php - PHP，mysql SELECT语句不起作用

> ID：13588079
> 
> 赞同：1
> 
> 时间：2012-11-27T15:58:17.973
> 
> 标签：php, mysql, database, mysqli, web-site-project

我是 PHP 新手，不确定 php 中 mysql 的语法。我正在尝试借助以下 SELECT 语句从 data_table 中检查用户名，但似乎遇到了语法错误。我真的很感激在这件事上的任何帮助。

```
$myquery = sprintf("SELECT `Username` FROM `dataTable` WHERE `Username` = \\%s", mysqli->real_escape_string($loginID));

 $userNameCheck = mysqli->query($myquery); 

 if($userNameCheck)
 {
    echo "query succeeded";
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:00:26.657

跳过 sprintf。

```
 $myquery = "SELECT `Username` FROM `dataTable` WHERE `Username` = '".mysqli->real_escape_string($loginID)."'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:03:38.160

看到您在 mysqli 上缺少 $ 符号，不知道这是这里还是您的代码中的错字。

```
$myquery = "SELECT `Username` FROM `dataTable` WHERE `Username` = '".$mysqli->real_escape_string($loginID)."'";
$userNameCheck = $mysqli->query($myquery); 
```

然后测试@Ray 写的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:01:24.943

您仍然需要引号，即使您使用...不寻常的查询构建方法。另外，我不确定双反斜杠有什么帮助。

```
$myquery = sprintf("..... `Username` = '%s'",mysqli...); 
```

# html - 谷歌地图作为固定背景，如foursquare

> ID：13588082
> 
> 赞同：3
> 
> 时间：2012-11-27T15:58:34.350
> 
> 标签：html, css, google-maps, foursquare

我正在尝试做这样的[事情](https://foursquare.com/explore?cat=topPicks&near=Saint%20Petersburg,%20RU)。我想将谷歌地图作为固定背景并将我的内容（一些文本）放在它上面，因为它是在foursquare上制作的。我也希望能够滚动我的内容。这是我的[努力](http://jsfiddle.net/X5r8r/918/)：

```
#map
{
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    z-index: 0;
}
#content
{
    width: 200px;
    margin: auto;
    position: relative;
    z-index: 1;
    border: 4px solid black;
}
​ 
```

但是地图消失了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:37:14.043

这是一种方法：http: [//jsfiddle.net/X5r8r/927/](http://jsfiddle.net/X5r8r/927/)

```
html, body {
    height:100%;
}

#map-container {
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 0;
}

#map
{
    width: 100%;
    height: 100%;
}
#content
{
    width: 200px;
    position: absolute;
    z-index: 1;
    top:0;
    left:0;
    border: 4px solid black;
    background:#fff;
    padding:20px;
} 
```

# oracle - ORACLE DB user_constraints 没有表

> ID：13588083
> 
> 赞同：1
> 
> 时间：2012-11-27T15:58:35.177
> 
> 标签：oracle

我有一个没有表的 Oracle 模式（我删除了它们）。然而，当我看`user_constraints`表时

```
 SELECT * FROM user_constraints; 
```

我看到很多行。怎么可能删除这些约束？

```
 DELETE FROM user_constraints WHERE owner='owner'; 
```

没有用，它给了我一个“权限不足”的错误。

```
 SELECT owner, constraint_name, constraint_type, table_name, r_owner, r_constraint_name  FROM user_constraints;

    OWNER                          CONSTRAINT_NAME                CONSTRAINT_TYPE TABLE_NAME                     R_OWNER                        R_CONSTRAINT_NAME            
    ORA_AI_1_9                     BIN$z2XwnFUHEHrgQ4sGOR4Qeg==$0 P               BIN$z2XwnFUJEHrgQ4sGOR4Qeg==$0                                                               

    ORA_AI_1_9                     BIN$z1NhC6g4oErgQ4sGOR6gSg==$0 P               BIN$z1NhC6g6oErgQ4sGOR6gSg==$0                                                               

    ORA_AI_1_9                     BIN$z1anK5OEEHrgQ4sGOR4Qeg==$0 P               BIN$z1anK5OGEHrgQ4sGOR4Qeg==$0                                                               

    ORA_AI_1_9                     BIN$z1NhC6hhoErgQ4sGOR6gSg==$0 P               BIN$z1NhC6hjoErgQ4sGOR6gSg==$0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:44:12.377

那么你在 10/11g 上并且可能有回收站吗？

```
SQL> select count(*) from user_tables;

  COUNT(*)
----------
         0

SQL> select count(*) from user_constraints;

  COUNT(*)
----------
         0

SQL> create table foo(id number primary key);

Table created.

SQL> ALTER SESSION SET recyclebin = ON;

Session altered.

SQL> select count(*) from user_tables;

  COUNT(*)
----------
         1

SQL> select count(*) from user_constraints;

  COUNT(*)
----------
         1

SQL> drop table foo;

Table dropped.

SQL> select count(*) from user_constraints;

  COUNT(*)
----------
         1

SQL> select count(*) from user_tables;

  COUNT(*)
----------
         0

SQL> 
```

你可以清除 reclebin 来解决这个问题。

```
SQL> purge recyclebin;

Recyclebin purged.

SQL> select count(*) from user_constraints;

  COUNT(*)
----------
         0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:31:38.810

你可以发表如下声明`DROP TABLE [schema.]table_name [CASCADE CONSTRAINTS]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:33:56.460

首先，您永远不应该直接针对数据字典表（如`user_constraints`.

其次，您是否拥有在其他用户拥有的表上创建的约束？做什么

```
SELECT owner, constraint_name, constraint_type, table_name, r_owner, r_constraint_name
  FROM user_constraints 
```

返回？

# android - 无法实例化应用内计费的类型错误

> ID：13588084
> 
> 赞同：0
> 
> 时间：2012-11-27T15:58:35.113
> 
> 标签：android, in-app-purchase

我正在尝试实现 inapp 计费功能，我的主要活动中有以下内容：

```
public class screen_Home extends base_Activity{
...
private AppPurchaseObserver appPurchaseObserver;
private Handler handler;
...
private abstract class AppPurchaseObserver extends PurchaseObserver {
    public AppPurchaseObserver(Handler handler) {
         super(BT_screen_home.this, handler);
    }
}
... 
```

在 onCreate 中：

```
...
handler = new Handler();         
appPurchaseObserver = new AppPurchaseObserver(handler); 
.... 
```

在最后一行，AppPurchaseObserver 在 Eclipse 中用红色下划线给出错误：无法实例化类型 screen_Home.AppPurchaseObserver

我做错了什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T21:34:34.843

抽象类不能被实例化。**[您可以在此处](http://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)**阅读有关 Java 抽象类的更多信息。取出`abstract`标识符，就可以实例化了`AppPurchaseObserver`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-29T18:28:53.533

尝试`import android.os.Handler;`

代替`import java.util.logging.Handler;`

# c# - 使用 GetDirectories() 检索目录时检查文件夹/文件权限

> ID：13588088
> 
> 赞同：1
> 
> 时间：2012-11-27T15:58:40.827
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4, file-permissions

```
DirectoryInfo[] directories = 
        di.GetDirectories("*.*", SearchOption.AllDirectories); 
```

问题是我无法访问某些文件夹，因此出现异常。

例如我无法访问的程序文件。

有什么解决方法吗？

**编辑：** 这是代码。如您所见，我已经配置了代码，因此如果发生异常它会继续。当它发生时，我只收到拒绝访问路径“C:\Arquivos de Programas”的消息。并且没有文件或文件夹

如何避免这种行为并在屏幕上打印我有权限的行为？

谢谢

```
 try
{
    //Resgata todos os drivers Lógicos do Sistema
    DriveInfo[] allDrives = DriveInfo.GetDrives();

    //Cria uma lista não ordenada para os DRIVERS
    Response.Write("<ul class=\"jqueryFileTree\" style=\"display: none;\">\n");

    //Itera sobre cada driver no array
    foreach (DriveInfo drive in allDrives)
    {
        if (drive.IsReady == true)
        {
            try //GetDirectories
            {
                //Para cada driver cria um LI A 
                Response.Write("\t<li class=\"drive collapsed\"><a href=\"#\" rel=\"" + drive.ToString() + "\">" + drive.ToString() + "</a>\n");

                System.IO.DirectoryInfo di = new System.IO.DirectoryInfo(drive.ToString());
                DirectoryInfo[] directories = di.GetDirectories("*.*", SearchOption.AllDirectories);

                Response.Write("<ul>");
                //Itera sobre os subdiretórios de cada driver
                foreach (System.IO.DirectoryInfo di_child in directories)
                {

                    Response.Write("\t<li class=\"directory collapsed\"><a href=\"#\" rel=\"" + drive + di_child.Name + "/\">" + di_child.Name + "</a>\n");
                    Response.Write("<ul>");
                    //Itera sobre todos os arquivos do diretório

                    foreach (System.IO.FileInfo fi in di.GetFiles())
                    {
                        string ext = "";
                        if (fi.Extension.Length > 1)
                        {
                            ext = fi.Extension.Substring(1).ToLower();
                        }

                        Response.Write("\t<li class=\"file ext_" + ext + "\"><a href=\"#\" rel=\"" + drive + fi.Name + "\">" + fi.Name + "</a></li>\n");
                    }// Arquivos 
                    Response.Write("</ul></li>");
                }// subdiretorio 
                Response.Write("</ul></li>");
            }
            catch (UnauthorizedAccessException e)
            {
                Response.Write(e.Message);
                continue;
            }
            catch (System.IO.DirectoryNotFoundException e)
            {
                Response.Write(e.Message);
                continue;
            }
            catch (Exception e)
            {

                Response.Write(e.Message);
                continue;
            }

        }//isReady

    }///drive
    Response.Write("</ul>");

}
catch (Exception)
{

    throw;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:05:36.337

一般来说，没有任何解决方法。

您不允许更改（在大多数情况下您根本不能）主机 PC 上的权限映射。所以你唯一能做的就是捕捉一个异常并向用户报告这个事实，可能是一些建议，如何解决这个问题。

*可能会有*一些技巧、技巧或其他什么，但在我看来，这不是好的设计。不要破解系统，除非你没有编写病毒。

**编辑**

如果您担心如果单个文件在加载时失败，您的目录解析会失败，您可以执行以下操作：

```
foreach (System.IO.FileInfo fi in di.GetFiles())
{
     try{
           string ext = "";
           if (fi.Extension.Length > 1)
           {
                 ext = fi.Extension.Substring(1).ToLower();
           }

            Response.Write("\t<li class=\"file ext_" + ext + "\"><a href=\"#\" rel=\"" + drive + fi.Name + "\">" + fi.Name + "</a></li>\n");
        }
        catch(..) {
          //handle here exception raised during SINGLE file parsing
        }
}// Arquiv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:05:00.697

是的，不幸的是，这是`GetDirectories`.

签出：[作为系统运行的 Windows 服务无法访问 C:\users\](https://stackoverflow.com/questions/9089876/windows-service-running-as-system-cannot-access-c-users)

在上面的示例中，无论权限级别如何，都会发生异常，但同样的原则也适用。当你遇到异常时，整个函数都会失败。

按照该帖子中链接文章中的建议使用 PInvoke，您至少可以继续，忽略异常而不是彻底失败。

# java - 在 java 中从 BufferedReader 读取两次

> ID：13588091
> 
> 赞同：-3
> 
> 时间：2012-11-27T15:58:46.967
> 
> 标签：java, sockets, bufferedreader

我在 java 中构建了一个 Web 服务器，我得到请求（作为套接字）并处理它。我需要先打印整个请求，然后再进行处理。这是我的代码片段：

```
public HttpRequest(Socket socket) throws Exception
{
    this.socket = socket;
    BufferedReader input = new BufferedReader(new InputStreamReader(socket.getInputStream()));
    printRequest(input);
    // Do More...
} 
```

问题是，从这一点开始，BufferedReader 已经结束，我似乎无法找到一种方法让它回到开头。该方法使用循环和操作`printRequest()`打印来自 BufferedReader 的整个请求）。`while``readline()`

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:01:51.357

以字符串形式读入请求；

```
String request = readUntilEOF(input); 
```

然后用它做任何你想做的事情；

```
System.out.println(request);
process(request);
doFunThingsWith(request); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:02:12.213

从概念上讲，当您从它们中读取时，就会消耗流。特别是在您从套接字读取的情况下，数据一经读取就消失了。因此，如果您想重新读取“流”，`// Do More`您需要创建一个新流并将您收到并存储在某处的数据提供给它。或者，如果您想记录读取的所有内容，您可以包装 InputStream 并在最终消费者消费流后立即进行打印，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:02:22.740

您不能使用 BufferedReader 两次读取内容。第一次读取后，将读取的内容保存在变量中以供以后使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:08:31.180

您可以读取`byte`数组中的内容，然后`ByteArrayInputStream`在需要时随时使用：

```
InputStream is = socket.getInputStream();
byte[] content = new byte[is.available()];
is.read(content);
printRequest(new BufferedReader(new InputStreamReader(new ByteArrayInputStream(content))));
processRequest(new BufferedReader(new InputStreamReader(new ByteArrayInputStream(content)))); 
```

# database - 在不同计算机上使用相同的 VB.NET 2010 独立程序编辑 MS Access 数据库的方法

> ID：13588094
> 
> 赞同：0
> 
> 时间：2012-11-27T15:58:52.633
> 
> 标签：database, concurrency, ms-access-2007, vb.net-2010

我在 VB.NET 2010 中有一个应用程序，还有一个 MS Access 数据库 2007，我可以在其中使用使用 Odbc 连接到它的独立程序编辑（添加、删除、更新）注册表。该程序需要在 2 台计算机上运行，​​因此 2 个人将编辑数据库（可能同时）...

是否有可能以某种方式在两台计算机上使用相同的程序，他们只能编辑一个 MS Access 数据库？

我正在考虑通过 Intranet 或其他方式共享 MS Access 数据库文件，但有更好的方法吗？有什么例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:27:14.027

要从多台计算机上使用 Access 数据库，请将其放在网络共享上。Access 通过 .ldb 文件处理并发使用。仅在非常可靠的网络上尝试此操作，否则您将遇到数据库损坏。

# jquery - Phonegap Storage（SQL Lite）在应用程序处于后台时插入

> ID：13588097
> 
> 赞同：1
> 
> 时间：2012-11-27T15:59:06.753
> 
> 标签：jquery, sqlite, cordova

我的 iOS 应用程序（使用 phonegap 构建）定位该位置并将所有数据插入 SQL Lite 数据库。

即使在后台跟踪也可以正常工作（我可以在日志中看到），但是当应用程序不活动时数据库功能不起作用。

也没有通过 jQuery-ajax 函数进行服务器通信。

有没有办法激活存储和ajax的后台服务？

# xml - 使用 Xpath 选择不同的节点

> ID：13588099
> 
> 赞同：1
> 
> 时间：2012-11-27T15:59:15.657
> 
> 标签：xml, xpath

我有一个以下格式的 XML 文件。我想选择`home`具有`record` `type 1`和的节点`gender 1`。

我正在尝试这样做

```
/root/home/record[type=01] 
```

但不知道如何包括其余部分。是否可以简单地使用 XPath 来选择我想要的东西？

```
<home>
  <record>
    <type>01</type>
  </record>
  <record>
    <gender>01</gender>
  </record>
</home>

<home>
  <record>
    <type>01</type>
  </record>
  <record>
    <gender>02</gender>
  </record>
</home> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:26:56.643

是的，选择部分应该是您的 XPATH，并且只有条件应该放在括号中：

`/root/home[record/gender='01' and record/type='01']`

# objective-c - 可可网络视图：搜索：方向：大小写敏感：

> ID：13588105
> 
> 赞同：1
> 
> 时间：2012-11-27T15:59:43.910
> 
> 标签：objective-c, macos, cocoa, webview

**一点代码：**

在我的窗口。当用户在 NSTextField 中按下回车键时调用。

```
- (IBAction)searchInArticle:(id)sender
{
    ResultTabView *tab = (ResultTabView*) [self.tabBar selectedTabViewItem];
    [tab searchForString:self.searchInArticleField.stringValue];
} 
```

在我的 webview 课程中：

```
- (void) searchForString:(NSString*)string
{
    [self.webView searchFor:string direction:YES caseSensitive:NO wrap:YES];
} 
```

**问题：**

我正在使用 searchFor:direction:caseSensitive:wrap: 在我的 webview 中搜索。我创建了一个文本字段，用户可以在其中输入他的搜索词 - 它适用于第一次搜索，但在执行搜索时 webview 成为第一响应者，然后我的文本字段被取消选择。

这实际上没问题，但是当我再次搜索时，搜索没有找到下一个单词。它一直在寻找第一个找到的单词。我想这是因为当我单击文本字段时 webview 丢失了 firstResponder ，这使得 webview 中的选择消失了。

我能做些什么 ？还有其他搜索可可网络视图的方法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-07T03:37:44.277

可能，文本字段应该在搜索后成为第一响应者。

# asp.net-mvc - 对数据和成员使用相同的数据库

> ID：13588109
> 
> 赞同：0
> 
> 时间：2012-11-27T15:59:56.657
> 
> 标签：asp.net-mvc, asp.net-mvc-4, visual-studio-2012, asp.net-membership

我有一个`MVC 4`使用`Entity-Framework`and的应用程序`SQL Express 2008`，并且我想将相同的数据库也用于成员资格和角色。我的连接字符串是：

```
 <add name="AuthTestDbEntities" connectionString="metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\sqlexpress;initial catalog=AuthTestDb;user id=sa;password=1234;pooling=False;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /> 
```

所以我为会员添加了另一个连接字符串：

```
<add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=AuthTestDb;user id=sa;password=1234;Integrated Security=True"  providerName="System.Data.SqlClient"/> 
```

我运行了该`aspnet_regsql.exe`命令，因此它将必要的表添加到我的数据库中。

但是，如果我使用该工具添加新用户，`ASP.NET configuration`我将无法使用该用户登录，也无法在我的数据库中找到他。如果我使用注册操作创建一个新用户，我可以使用它登录，但它会在我的`App_Data`文件夹中创建一个名为`ASPNETDB.MDF`.

我需要做什么才能为我的网站使用相同的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:02:32.807

一个选项：考虑查看自定义成员资格提供程序并仅创建支持您自己的应用程序所需的表/列。

如果您搜索自定义成员资格提供程序，我相信有很多示例，这里有一个：[如何为 ASP.NET MVC 2 创建自定义成员资格提供程序？](https://stackoverflow.com/questions/2771094/how-do-i-create-a-custom-membership-provider-for-asp-net-mvc-2)

# regex - 如何将字符串的所有数字子字符串括在大括号中？

> ID：13588110
> 
> 赞同：3
> 
> 时间：2012-11-27T15:59:57.783
> 
> 标签：regex, perl

我想转换一个字符串，以便所有数字子序列都包含在`{`...`}`对中。

例如：

```
input_string = "APPL[E]5XXXX"

output_string = "APPL[E]{5}XXXX" 
```

例如，每个字符串可能包含一个或多个数字，`BASIC76XXXXX98ZZZZ`并且输出应该是`BASIC{76}XXXXX{98}zzzz`

不确定这是否可能实现。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:02:25.240

我想你正在寻找这样的东西：

```
$string =~ s/(\d+)/{$1}/g; 
```

这将匹配任何连续的数字并将它们替换为`$1`被大括号包围的第一个捕获的子字符串（ - 与整个匹配一致）。这`g`是为了确保所有事件都被替换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T16:09:14.597

这肯定是可能的。

您需要一个匹配数字的正则表达式，捕获数字，然后用一组包装的花括号替换匹配项。

```
my $input = 'APPL[E]5XXXX';
$input =~ s/(\d+)/{$1}/g; 
```

*   `\d+`匹配数字。
*   `()`捕获并存储在`$1`.
*   这`s///`是一个替换正则表达式。
*   最后，`/g`最后的意思是“全球”，也就是对所有比赛都这样做。

# sql-server - 无法像我希望的那样将重复的项目分组

> ID：13588116
> 
> 赞同：0
> 
> 时间：2012-11-27T16:00:17.280
> 
> 标签：sql-server, tsql, sql-server-2005

因此，我查询了一份报告，该报告几乎完全符合我的需要。

代码为我提供了“套件”中的所有物品，告诉我套件中应该有多少物品，并告诉我套件中的物品与应该存在的数量之间的差异。

当套件中的相同产品代码有不同的批号时，即使我按产品代码进行分组，它也会将产品代码拆分为两个行项目。这看起来好像套件中缺少该产品代码的物品，但实际上它们并没有丢失，因为当您将单独的批次放在一起时，您会得到全部数量。

```
SELECT plItem.ProductCode,
       plItem.[Description],
       sum(ISNULL(ProductContent.Qty, 0))                              AS KitQty,
       ISNULL(KitBomItems.Qty, 0)                                      AS BOMQty,
       sum(ISNULL(ProductContent.Qty, 0)) - ISNULL(KitBomItems.Qty, 0) AS Diff
FROM   KitBomItems
       JOIN ProductList AS plItem
         ON KitBomItems.ProductListID = plItem.ID
            AND KitBomItems.KitBomListID = @AssemblyID
       LEFT JOIN ProductContent
         ON ProductContent.ProductCode = plItem.ProductCode
            AND ProductContent.StatusID = @KitID
GROUP  BY plItem.ProductCode,
          plItem.[Description],
          ProductContent.Qty,
          KitBomItems.Qty 
```

结果见附件！谢谢你的帮助 ：）![结果](../Images/68b5651090d74d0ffa65dc4d86c691d7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:07:19.223

我认为您按太多列分组-您不应该按`ProductContent.Qty`. 尝试这个

```
SELECT      
    plItem.ProductCode,             
    plItem.[Description],           
    sum(ISNULL(ProductContent.Qty,0)) AS KitQty,            
    ISNULL(KitBomItems.Qty,0) as BOMQty,            
    sum(ISNULL(ProductContent.Qty,0)) - ISNULL(KitBomItems.Qty,0) AS Diff       
    FROM KitBomItems 
        JOIN ProductList AS plItem ON KitBomItems.ProductListID = plItem.ID 
        AND KitBomItems.KitBomListID = @AssemblyID          
        LEFT JOIN ProductContent ON ProductContent.ProductCode = plItem.ProductCode 
        AND ProductContent.StatusID = @KitID 
    group by 
        plItem.ProductCode,          
        plItem.[Description],
        KitBomItems.Qty 
```

# c - 为什么这个 strncpy() 实现在第二次运行时崩溃？

> ID：13588118
> 
> 赞同：0
> 
> 时间：2012-11-27T16:00:19.203
> 
> 标签：c, strncpy

为什么这个 strncpy() 实现在第二次运行时崩溃，而第一次运行正常？

> ## 字符串
> 
> Copy characters from string 将`n`源的第一个字符复制到目标。如果在复制字符之前找到源 C 字符串的结尾（由空字符表示）`n`，则用零填充目标，直到总共`n`写入了字符。
> 
> 如果源长度大于`n`（因此，在这种情况下，目标可能不是以空结尾的 C 字符串），则不会在目标末尾隐式附加空字符。

```
char *strncpy(char *src, char *destStr, int n)
{
    char *save = destStr; //backing up the pointer to the first destStr char
    char *strToCopy = src; //keeps [src] unmodified

    while (n > 0)
    {
        //if [n] > [strToCopy] length (reaches [strToCopy] end),
        //adds n null-teminations to [destStr]
        if (strToCopy = '\0') 
            for (; n > 0 ; ++destStr)
                *destStr = '\0';

        *destStr = *strToCopy;
        strToCopy++;
        destStr++;
        n--;

        //stops copying when reaches [dest] end (overflow protection)
        if (*destStr == '\0')
            n = 0; //exits loop
    }

    return save;
}

/////////////////////////////////////////////

int main()
{
    char st1[] = "ABC";
    char *st2;
    char *st3 = "ZZZZZ";
    st2 = (char *)malloc(5 * sizeof(char));

    printf("Should be: ZZZZZ\n");
    st3 = strncpy(st1, st3, 0);
    printf("%s\n", st3);

    printf("Should be: ABZZZZZ\n");
    st3 = strncpy(st1, st3, 2);
    printf("%s\n", st3);

    printf("Should be: ABCZZZZZ\n");
    st3 = strncpy(st1, st3, 3);
    printf("%s\n", st3);

    printf("Should be: ABC\n");
    st3 = strncpy(st1, st3, 4);
    printf("%s\n", st3);

    printf("Should be: AB\n");
    st2 = strncpy(st1, st2, 2);
    printf("%s\n", st2);

    printf("Should be: AB\n");
    st2 = strncpy(st1, st2, 4);
    printf("%s\n", st2);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:04:25.497

你得到一个分段错误，因为

```
char *st3 = "ZZZZZ"; 
```

目的地是一个字符串文字。不得修改字符串文字，并且它们通常存储在写保护的内存中。所以当你打电话

```
strncpy(st1, st3, n); 
```

使用`n > 0`，您正在尝试修改字符串文字并导致崩溃（不一定，但通常）。

在复制循环中，您忘记取消引用`strToCopy`

```
if (strToCopy = '\0') 
```

并写`=`而不是`==`，所以`strToCopy`设置为`NULL`，导致进一步取消引用 of`strToCopy`以调用未定义的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:04:06.447

我不认为你想要这个：

```
if (strToCopy = '\0') 
```

相反，您可能打算这样做：

```
if (*strToCopy == '\0') 
```

一般来说，使用[yoda 条件](http://www.dodgycoder.net/2011/11/yoda-conditions-pokemon-exception.html)可以让你从比较与赋值的混淆问题中解脱出来：

```
if ('\0' == *strToCopy) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:09:07.647

```
while (n > 0)
    {
        //if [n] > [strToCopy] length (and reaches [strToCopy] end),
        //adds n null-teminations to [destStr]

        *destStr = *strToCopy;
        //stops copying when reaches [dest] end (overflow protection)
        if (*destStr == '\0')
            break; //exits loop
        strToCopy++;
        destStr++;
        n--;

    }
if (*destStr != '\0') *destStr = '\0'; 
```

主要是：

```
printf("Should be: ZZZZZ\n");
    st3 = strncpy(st1, st3, 0);
    printf("%s\n", st3); 
```

这是错误的，因为您要复制的长度是`0`这样的，您将无法获得`ZZZZZ`

# git - Git：通过符号链接克隆需要密码？

> ID：13588122
> 
> 赞同：5
> 
> 时间：2012-11-27T16:00:37.890
> 
> 标签：git, vim, github, add-on, git-clone

使用 vim 的 vundle 包管理器，我试图将[ps1 插件](https://github.com/PProvost/vim-ps1)克隆到我的机器上。我在 Windows 7 机器上，我的 vimfile 目录是符号链接的，所以即使我的 git 存储库位于*D:*上，我的 git 命令正在使用我在*C:上的**主*文件夹。

 *我的问题是，当我在我的符号链接文件夹上发出克隆命令时，系统会提示我输入 github 用户名和密码。在我的实际文件夹上发出相同的命令按预期工作，没有提示。

从 windows 命令提示符我发出 git 命令

```
git clone --recursive https://github.com/pprovost/vim-ps1.git "D:\dev\git\.vim\bundle\vim-ps1" 
```

它按预期工作，但是如果我尝试“通过”符号链接执行命令

```
git clone --recursive https://github.com/pprovost/vim-ps1.git "C:\Users\ebeach\vimfiles\bundle\vim-ps1" 
```

系统提示我输入 github 用户名和密码。

我对这个答案的搜索与试图通过 github 操作符号链接的人混为一谈——我只想知道为什么在这种特殊情况下会提示我输入用户名和密码。

谢谢！

- 更新 -

这可能特定于 ps1 包，因为其他包似乎可以正常工作。例如，在没有提示的情况下克隆 CtrlP github 包：

```
git clone --recursive https://github.com/kien/ctrlp.vim.git "C:\Users\ebeach\vimfiles\bundle\ctrlp.vim" 
```

但是我仍然不知道为什么我会提示我 ps1 包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:46:16.690

我不明白，但看起来我在[另一篇文章](https://stackoverflow.com/questions/6650488/why-are-github-project-document-page-urls-case-sensitive-what-are-the-negative/6650592#6650592)中找到了答案。看来我的问题是 url 的***情况***，所以在我有的地方`https://github.com/pprovost/vim-ps1.git`，我应该尊重`https://github.com/PProvost/vim-ps1.git`.

这解决了我的问题，但我无法解释为什么一种情况有效而另一种情况无效。*

# python - stringio.write 和 += 在字节流上的不同

> ID：13588125
> 
> 赞同：0
> 
> 时间：2012-11-27T16:00:42.680
> 
> 标签：python, python-2.7, bytearray, stringio

我最近遇到了一个奇怪的问题，希望这里有人能帮助我。我在 Ubuntu12.04 中使用 Python2.7，python 和 OS 都是 64 位的。

在我的代码中，我需要不断地将传入的数据流附加到一个字节数组中，我使用 self.data += incomingdata 来实现这一点，其中传入数据是我从硬件设备接收到的数据。然后我会稍后解压字节数组来解析接收到的数据。追加和解析操作都受锁保护。

这里的问题是，当我使用“+=”附加字节流时，数据似乎在某些点被损坏（不会始终如一地发生）。没有内存使用错误，没有溢出等。我监控了程序的内存使用情况，看起来不错。

然后，当我将“+=”更改为 cStringIO.write 以实现附加操作时，完全没有问题，尽管它似乎比“+=”操作慢。

谁能告诉我当 cStringIo.write 和 "+=" 用于对字节流进行操作时，它们之间的确切区别是什么？“+=”操作会导致任何潜在问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:22:39.113

而不是使用`+=` 你可能会更好地创建一个列表并将数据附加到它的末尾。获取所有数据后，您可以执行 a`''.join(list)`创建单个字符串。由于字符串连接效率低下，这将执行得更好。

当您连接两个字符串时，python 必须分配新内存来存储新字符串。如果你正在做大量的连接，这可能真的很慢。随着字符串大小的增加，执行连接所需的时间也会增加，如果您以这种方式获取大量数据，它可能会使处理器不堪重负并导致其他操作延迟。

当我构建一个重新组装 TCP 流的 python 进程时，我遇到了类似的问题。我捕获的每个数据包都使用连接添加到字符串中。一旦字符串增长到几 MB，我使用的数据包捕获库就开始丢帧，因为 CPU 花费大量时间进行字符串连接。一旦我切换到使用列表并在最后加入结果，问题就消失了。

您没有这个问题的原因`cStringIO.write`是它通过在内存中创建一个虚拟文件并将数据附加到该文件来操作，而不必每次都为新字符串重新分配空间。

# perl - 从哈希 perl 写入 CSV 文件

> ID：13588129
> 
> 赞同：9
> 
> 时间：2012-11-27T16:01:02.617
> 
> 标签：perl, csv, hash

我有一个程序，目前从**文件 1**中读取，看起来像下面的文件并匹配某些字符。例如

```
类型、水果、描述、数量
热带，香蕉，美味可口，5
热带，葡萄柚，苦而不好吃，2
... 等等

```

首先，我想为每个“类型”、“水果”、“描述”、“数量”创建哈希哈希，并将不同的值存储在参考哈希中。这适用于下面的代码。

```
use strict;
use warnings;
use Data::Dumper;
use Text::CSV;

my %MacroA = ('Type' => {}, 'Fruit' => {}, 'Description' => {}, 'Quantity' =>  {});         

open (my $file, '<', 'FRUITIES.txt') or die $!;     

while (my $line = <$file>)                                                             {                                        

if ($line =~ /\b(tropical)\b,/) {                                   
$MacroA{Type}->{$1}++;
}

if ($line =~ /,\b(banana|grapefruit)\b,/) {                             
$MacroA{Fruit}->{$1}++;
}

if ($line =~ /,([\w\s]+?),/) {                                  
$MacroA{Description}->{$1}++;
}

if ($line =~ /,([\d]+?)/) {                             
$MacroA{Quantity}->{$1}++;
}
        }

close $file; 
```

所以我的问题是**如何将这些数据（数据不固定）放入 csv 文件或任何相关文件（可能是 xls）中，这将是一个包含每个哈希哈希列的表（'Type'、'Fruit'、'描述'，'数量'）。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T14:40:47.757

我同意散列的散列是一件好事，但我认为你没有以一种可以轻松检索它的方式存储它。

你可以这样做的一种方法是这样的。

```
{ id_1 => {
             data_1 => "blah",
             data_2 => "foo",
             ...
           },
  id_2 => {
             ...
           },
  ...
 } 
```

首先，您需要选择哪一列是“ID”。这将确定每个 ROW 的唯一性。假设您的示例让我们挑选水果，因为我们假设不会有两个水果会出现在同一个文件中。所以我们会有这样的事情：

```
{ banana => {
             type => "tropical",
             description => "tasty and yummy",
             ...
           },
  grapefruit => {
             ...
           },
  ...
 } 
```

为了将其改回 CSV，我们循环遍历哈希。

```
my %fruit_data; #let's assume that this already has the data in it

foreach my $fruit ( keys %fruit_data ) { 

    #given the $fruit you can now access all the data you need
    my $type = %fruit_data{$fruit}{'type'};
    my $desc = %fruit_data{$fruit}{'description'};
    # etc...

    # then you may want to store them in a scalar in any order you want
    my $row = "$field,$type,$desc etc.\n";

    # then work your way from there

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T17:00:59.700

对于编写 Excel 文件 - 您可以使用[Spreadsheet::WriteExcel](https://metacpan.org/pod/Spreadsheet%3a%3aWriteExcel)。

关于 CSV 文件 - 最初您拥有带有“，”分隔符和“\n”字符串分隔符的 CSV 文件。如果您想将一些 hashrefs 数组写入 CSV - 自己写下简单子的更好方法，就像这样：

```
use strict;
use warnings;

sub write_csv {

  my ($array_ref, $fh) = @_;

  for my $row (@$array_ref) {
    print $fh join(',', map { $_, $row->{$_} } sort keys %$row), "\n";
  }
}

my $test = [
  {a => 1, ab => 2, type => '234k', count => '123'}, 
  {a => 3, ab => 2, type => 'some_type', count => 34},
];

open my $fh, '>', 'test.csv' or die $!;

write_csv($test, $fh); 
```

# visual-studio-2010 - NLog nlogger 片段不工作 Visual Studio 2012

> ID：13588131
> 
> 赞同：5
> 
> 时间：2012-11-27T16:01:20.480
> 
> 标签：visual-studio-2010, visual-studio-2012, code-snippets, nlog

有谁知道如何让 Nlog 的 nlogger 片段像 2010 年一样在 Visual Studio 2012 中工作？谷歌搜索时，我在他们的论坛或互联网上看不到任何内容。似乎是使用 Nlog 的人想要回来的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-21T01:24:00.147

还没有弄清楚如何安装真正的代码片段，所以我手动创建了一个代码片段来执行与原始代码相同的功能。

在以下文件夹中创建文件 nlogger.snippet：

```
My Documents\Visual Studio 2012\Code Snippets\Visual C#\My Code Snippets 
```

该文件的内容应如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
    <CodeSnippet Format="1.0.0">
        <Header>
            <Title>
                NLog Logger Snippet
            </Title>
            <Shortcut>nlogger</Shortcut>
        </Header>
        <Snippet>
            <Code Language="CSharp">
                <![CDATA[private static NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();]]>
            </Code>
        </Snippet>
    </CodeSnippet>
</CodeSnippets> 
```

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-24T20:35:39.900

正如上面@agunn 所提到的，我在 VS2013 中发布了为我正确导入的片段：

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <CodeSnippet Format="1.0.0">
    <Header>
      <Title>NLog Logger Snippet</Title>
      <Description>Adds the logger object</Description>
      <Shortcut>nlogger</Shortcut>
    </Header>
    <Snippet>
      <Code Language="CSharp"
            Kind="any">
        <![CDATA[private static readonly Logger Logger = LogManager.GetCurrentClassLogger();]]>
      </Code>
    </Snippet>
  </CodeSnippet>
</CodeSnippets> 
```

# html - 508 投诉表标题中的“全选”复选框

> ID：13588135
> 
> 赞同：4
> 
> 时间：2012-11-27T16:01:23.460
> 
> 标签：html, section508

我有一个如下所示的数据表：

```
<table><thead>
<tr>
<th><input type="checkbox" /></th>
<th scope="col">Foo</th>
<th scope="col">Bar</th><tr>
</thead>
<tbody>
<tr><td><input type="checkbox" /></td><td scope="row">a</td><td>b</td></tr>
<tr><td><input type="checkbox" /></td><td scope="row">c</td><td>d</td></tr>
</tbody></table> 
```

我希望标题中的复选框选择正文中的所有复选框。我已经编写了 Javascript 来进行选择，它工作正常。但是，在 IE7 和 IE8 中（可能是其他浏览器，但我们不需要支持其他任何东西），标题中的复选框永远不会获得选项卡焦点，所以我们失败了 508。

有没有办法在不为所有内容设置 tabindexes 的情况下处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T13:55:21.577

正如 Jukka 在评论中所说，所有这些都需要`labels`. 如果没有`<label>`表单元素，任何 508 检查都会自动失败。这可能是它抛出的真正错误，但我们需要知道正在使用哪些工具。

要回答您的新问题：

> 无论如何，这里真正的问题不是它没有获得焦点，而是焦点不可见。我尝试添加标签，但没有帮助，我尝试仅向 TD 添加文本，但也没有帮助

大多数浏览器在获得焦点时会在所有元素周围放置一个 1 像素的虚线边框。浏览您的样式表，然后查找类似`outline: none;`. 您应该删除该行或添加重新添加焦点的新规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:50:55.593

看起来问题实际上是沟通不畅，无论是在我们的开发团队还是在 508 合规检查器中。我唯一的借口是这件事发生在我没有带笔记本电脑过感恩节时通过电话。

无论如何，这里真正的问题不是它没有获得焦点，而是焦点不可见。我尝试添加标签，但没有帮助，我尝试仅向 TD 添加文本，但也没有帮助。一旦我确定我要问的是什么，我将把我的鸭子排成一排，然后提出一个新问题。

谢谢大家的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:42:46.880

您正在寻找使复选框既实用又可见，是吗？

您不能使用更改复选框样式的 JS 创建“焦点”事件，因为复选框实际上没有任何“样式”，保存 Ryan B 提到的内容......但是您可以创建将样式更改为的“焦点”事件一个`<div>`包含所述复选框：

[http://jsfiddle.net/ZuvbV/3/](http://jsfiddle.net/ZuvbV/3/)

请注意，通过选项卡将背景颜色更改为红色。

# mysql - mysql 选择查询。每年收集某些类型的价格

> ID：13588143
> 
> 赞同：0
> 
> 时间：2012-11-27T16:01:54.040
> 
> 标签：mysql, sql, pivot

我有这张价格表

```
type | year | price
===================
A    | 2002 | 200
B    | 2002 | 120
C    | 2002 | 126
B    | 1999 | 100
A    | 2004 | 202
A    | 2005 | 206 
```

我需要一个`SELECT`查询来生成二维类型的价格数组，`A`并且`B`在它们出现的每一年中，`NULL`如果没有给定类型的数据。

```
year | price A | price B
========================
1999 | NULL    | 100
2002 | 200     | 120
2004 | 202     | NULL
2005 | 206     | NULL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:03:20.250

这基本上是一个`PIVOT`但 MySQL 没有函数，因此您可以使用带有聚合函数的语句`PIVOT`来复制它。`CASE`如果您有已知数量的`type`值，则可以对这些值进行硬编码：

```
select year,
  avg(case when type='A' then price end) PriceA,
  avg(case when type='B' then price end) PriceB
from yourtable
group by year 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/631e6/5)

结果：

```
| YEAR | PRICEA | PRICEB |
--------------------------
| 1999 | (null) |    100 |
| 2002 |    200 |    120 |
| 2004 |    202 | (null) |
| 2005 |    206 | (null) | 
```

如果您的数量未知，`types`则可以使用准备好的语句：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'avg(case when type = ''',
      type,
      ''' then price end) AS Price',
      type
    )
  ) INTO @sql
FROM yourtable;

SET @sql = CONCAT('SELECT year, ', @sql, ' 
                  FROM yourtable 
                   GROUP BY year');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/631e6/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:10:10.023

* * *

## 回答评论

* * *

**以下答案仅回答 PIVOT - OP 问题** 的一部分由于它没有使用任何聚合函数，因此该查询没有提供对计数 OP 预期输出的完整答案。

检查参考:)

[SQLFIDDLE](http://sqlfiddle.com/#!2/75163/3)

询问：

```
SELECT t.year,
         (CASE WHEN t.type = 'A' 
               THEN PRICE ELSE NULL END) AS price_a,
         (CASE WHEN t.type = 'B' 
               THEN PRICE ELSE NULL END) AS prioce_b         
FROM tbl t
GROUP BY t.year
; 
```

结果：

```
YEAR    PRICE_A     PRIOCE_B
1999    (null)     100
2002    200       (null)
2004    202       (null)
2005    206       (null) 
```

# .net - 如何确保存储过程和调用客户端代码之间的接口完好无损？

> ID：13588148
> 
> 赞同：2
> 
> 时间：2012-11-27T16:02:19.327
> 
> 标签：.net, sql-server-2008, stored-procedures, interface, ado.net

我们在 MS SQL Server 2008 中有许多存储过程。这些由 .NET 代码调用。有时程序在多个地方被调用。

当更改存储过程时，例如添加“强制”参数，我们显然需要确保所有来自 .NET 程序的调用都已更新。

除了勤奋的分析之外，还有什么方法可以自动检查调用.NET代码和存储过程接口之间的“接口”是否完好无损？

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T21:16:43.770

我建议为此类任务使用代码生成。您可以使用[SQL Server 管理对象](http://msdn.microsoft.com/en-us/library/ms162169%28v=sql.100%29.aspx)在存储过程和代码之间生成“接口”。您可以使用部分类将生成的代码与手写代码分开，因此这里应该没有问题。

如果您对“我们在 MS SQL Server 2008 中有许多存储过程”的看法是正确的，那么对代码生成的投资将很快得到回报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T21:23:04.693

我们在使用 Oracle DB 的项目中遇到了同样的问题。为了确保一切都是最新的，我们有一组集成测试来调用每个存储过程并验证结果。

持续集成服务器（在我们的例子中是 TeamCity）每晚创建测试数据库并在其上运行测试。

# html - 如何使用 Servlet 流式传输 MP3、MP4、AVI 等音频/视频文件

> ID：13588149
> 
> 赞同：13
> 
> 时间：2012-11-27T16:02:21.247
> 
> 标签：html, servlets, audio, video, media-player

我想使用 servlet 将我的音频/视频文件流式传输到网络。

我尝试使用以下 servlet：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    File file = new File("/Users/myfolder/Documents/workspace/love.mp3");
    response.setContentType(getServletContext().getMimeType(file.getName()));
    response.setContentLength((int) file.length());
    Files.copy(file.toPath(), response.getOutputStream());
} 
```

以及以下 HTML：

```
<a href="/media" data-format="mp3 ogg">Click Here!</a> 
```

然而，播放器只是在加载……加载……加载……

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-27T16:16:50.893

许多媒体播放器要求服务器支持所谓的 HTTP 范围请求。即它必须能够根据请求返回带有[`Range`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)标题的媒体文件的特定部分。例如，在 10MB 长的文件中，只有索引 1000 处的字节直到 2000 为止。这对于许多媒体播放器来说是强制性的，以便能够足够快地跳过特定范围的媒体流和/或通过创建多个连接来提高缓冲速度，每个连接都请求文件的不同部分。

然而，这在您的 servlet 中有很多额外的代码，需要对 HTTP[`Range`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)规范有很好的理解。通常 servlet 容器（Tomcat、JBoss AS、Glassfish 等）自己的默认 servlet 已经支持这个。因此，如果有一种方法可以通过标准方式将媒体文件夹发布到网络中，这样您就不需要为此自行开发一个 servlet，那么我会走这条路。

目前尚不清楚您使用的是哪个 servletcontainer，因此我将在此示例中假设 Tomcat：

1.  只需将`love.mp3`文件放到 web 项目的公共 web 内容中，这样它就可以直接使用，`<a href="love.mp3">`而不需要整个 servlet。

2.  或者，将`love.mp3`文件放在文件夹的新子`Tomcat/webapps`文件夹中，例如`Tomcat/webapps/media/love.mp3`. 这样它就可以通过`<a href="/media/love.mp3">`.

3.  或者，将`love.mp3`文件放在磁盘上的其他位置，例如`/path/to/media/love.mp3`，`/media`通过将以下行添加到 Tomcat 中，将文件夹添加为新上下文`/conf/server.xml`：

    ```
     <Context docBase="/path/to/media" path="/media" /> 
    ```

    这样它也可以使用`<a href="/media/love.mp3">`。

无论哪种方式，Tomcat 自己的[`DefaultServlet`](http://tomcat.apache.org/tomcat-7.0-doc/default-servlet.html)对请求都有适当支持的[`Range`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)将用于流式传输内容。

但是，如果绝对没有办法使用 servletcontainer 自己的默认 servlet，那么您需要重写您的 servlet 代码以使其正确支持[`Range`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)请求。[您可以从Tomcat`DefaultServlet`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.tomcat/tomcat-catalina/7.0.0/org/apache/catalina/servlets/DefaultServlet.java)和[OmniFaces`FileServlet`](https://github.com/omnifaces/omnifaces/blob/master/src/main/java/org/omnifaces/servlet/FileServlet.java)等开源示例中获得灵感。

### 也可以看看：

*   [使用 HTML 5 和 servlet 的视频](https://stackoverflow.com/questions/8591666/video-using-html-5-and-servlet/)

# iphone - Presenting UIImagePickerController removes the NavigationBar on the current controller

> ID：13588157
> 
> 赞同：0
> 
> 时间：2012-11-27T16:02:48.143
> 
> 标签：iphone, ios, uinavigationcontroller, uiimagepickercontroller

I have a tab bar application with several controllers. Some are `UINavigationControllers`, some just simple `UIViewControllers`. The central button presents the `UIImagePickerController` to allow the user to take a picture. When I present the Image Picker from a simple `UIViewControllers`, it works fine. But when I present it while a `UINavigationController` is currently the `selectedViewController`, the dismall of the picker removes the `UINavigationBar` of the controller.

I read that with `UINavigationControllers`, the modal view must be presented from the `navigationController`, but it does not work either. Here are bunches of code :

```
 UIImagePickerController* picker = [[UIImagePickerController alloc] init];
    picker.delegate = self;
    if (TARGET_IPHONE_SIMULATOR)
    {
        picker.sourceType = UIImagePickerControllerSourceTypeSavedPhotosAlbum;
    }
    else
    {
        if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])
        {
            picker.sourceType = UIImagePickerControllerSourceTypeCamera;
        }
        else
        {
            UIAlertView* alert = [[UIAlertView alloc]
                                  initWithTitle:@"Erreur"
                                  message:@"Pour pouvoir poster des photos, votre device doit posséder un appareil photo"
                                  delegate:self
                                  cancelButtonTitle:@"OK"
                                  otherButtonTitles:nil];
            [alert show];
            return;
        }
    }
    if ([self.selectedViewController respondsToSelector:@selector(presentViewController:animated:completion:)])
    {
        [self.selectedViewController presentViewController:picker animated:YES completion:nil];
    }
    else
    {
        [self.selectedViewController presentModalViewController:picker animated:YES];
    } 
```

the dismall :

```
[self.selectedViewController dismissModalViewControllerAnimated:YES]; 
```

Has anyone got this strange behavior (guess it has something to do with the fact that `UIImagePickerController` delegate must implement `UINavigationControllerDelegate`) and know how to resolve that? Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:24:43.947

You can redirect to pickerController using this

```
[self presentViewController:picker animated:YES completion:^{}]; 
```

And its **delegate** method

```
-(void)imagePickerController:(UIImagePickerController*)picker didFinishPickingMediaWithInfo:(NSDictionary*)info
{
    NSData *dataImage = UIImageJPEGRepresentation([info objectForKey:@"UIImagePickerControllerOriginalImage"],1);
    [picker dismissViewControllerAnimated:YES completion:^{}];
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
{
    [picker dismissViewControllerAnimated:YES completion:nil];
} 
```

**Or**

Make sure that you are not setting any `setHidden` in your Code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:54:16.423

It was actually really more simple : in the `viewWillAppear`, I set the hidden property to `NO` and in the `viewWillDisappear` I set it to `YES`. The thing is : when the modal controller is presented, the `viewWillDisappear` was called. But when it was dismissed, the `viewWillAppear` was not called... Not really the expected behavior, but still. Thanks guys.

# javascript - d3.js 不能在 chrome 中工作

> ID：13588160
> 
> 赞同：4
> 
> 时间：2012-11-27T16:02:58.457
> 
> 标签：javascript, d3.js

我正在使用 JavaScript 库 d3.js ( [http://d3js.org/](http://d3js.org/) )，但我不知道为什么它在 Safari 和 Firefox 中有效，但在 Chrome 中无效。

我猜标题是正确的：

```
<head>
  <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js">
  </script>
</head> 
```

我还尝试将脚本标签放在文件末尾。有没有人使用 d3.js 的经验？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-17T19:45:52.387

尝试从推荐的地址加载库

```
<script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script> 
```

也将它放在`</body>`标签的末尾之前，以便在末尾加载。

# sitefinity - Sitefinity 4.4 升级到 5.1 - 论坛未加载

> ID：13588167
> 
> 赞同：0
> 
> 时间：2012-11-27T16:03:27.963
> 
> 标签：sitefinity

所以我已经从 Sitefinity 4.4 升级到 5.1 并且新的内置论坛没有加载。这是我所看到的：

![在此处输入图像描述](../Images/ffe2f2b3f7ddd86a3fdfc7044e664e2d.png)

我比较了我的配置文件，一切似乎都井井有条。我在 App_Code\Sitefinity\Configuration\ForumsConfig.config 文件中看到的唯一与论坛有关的项目如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<forumsConfig xmlns:config="urn:telerik:sitefinity:configuration" xmlns:type="urn:telerik:sitefinity:configuration:type" config:version="5.1.3450.0">
    <notifications newPostNotificationTemplateId="2749c96b-6fe0-4796-828c-086d4fc928dd" newThreadNotificationTemplateId="f05b4fe5-752e-4fe4-b41c-69c81b73e424" />
</forumsConfig> 
```

如果有人知道还有哪里可以看，请告诉我。我敢打赌它在数据库中的某个地方，但我不知道从哪里开始......

* * *

编辑：所以，我现在已经将我的新文件与升级前的旧配置文件一起复制到了 DEV 服务器。发生这种情况时，我现在在页面加载时立即收到以下错误：

> 无法加载文件或程序集“Telerik.Sitefinity，版本=4.4.2117.0，Culture=neutral，PublicKeyToken=b28c218413bdf563”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

因此，我进入并将配置文件中对 4.4.2117.0 的任何引用更新为 5.1.3450.0（SystemConfig.config 文件中的除外）。大多数这些更改都修改了 XML 的根节点的 config:version 属性。

再次运行该站点，仍然遇到相同的错误。因此，我找到了一些关于将以下内容放入 web.config 文件中的信息，用于它抱怨的每个文件（是的，这发生了 4 次）：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Telerik.Sitefinity" publicKeyToken="b28c218413bdf563" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-65535.65535.65535.65535" newVersion="5.1.3450.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Telerik.Sitefinity.Model" publicKeyToken="b28c218413bdf563" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-65535.65535.65535.65535" newVersion="5.1.3450.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Telerik.OpenAccess" publicKeyToken="7CE17EEAF1D59342" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-65535.65535.65535.65535" newVersion="2012.2.628.2" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Telerik.Sitefinity.Utilities" publicKeyToken="b28c218413bdf563" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-65535.65535.65535.65535" newVersion="5.1.3450.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

现在，我收到以下错误：

> 无法从程序集“Telerik.Sitefinity，版本=5.1.3450.0，文化=中性，PublicKeyToken=b28c218413bdf563”加载类型“Telerik.Sitefinity.Publishing.PipeFactory”。

我已经将系统更改为指向 Telerik.Sitefinity 以使用最新版本，但现在该站点根本无法加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T07:55:03.940

当您将站点升级到 5.1 时，除了此处的常规升级步骤：[http ://www.sitefinity.com/documentation/documentationarticles/installation-and-administration-guide/upgrade](http://www.sitefinity.com/documentation/documentationarticles/installation-and-administration-guide/upgrade)

你是否也完成了这里的步骤：[http ://www.sitefinity.com/documentation/documentationarticles/upgrading-sitefinity-4.3-and-4.4-projects](http://www.sitefinity.com/documentation/documentationarticles/upgrading-sitefinity-4.3-and-4.4-projects)

在这里：[http ://www.sitefinity.com/documentation/documentationarticles/upgrading-the-web.config-and-the-sitefinitywebapp.csproj-files](http://www.sitefinity.com/documentation/documentationarticles/upgrading-the-web.config-and-the-sitefinitywebapp.csproj-files)

在后面的步骤中，您必须向 forums.dll 添加一个引用，以及其他一些可能影响项目加载似乎丢失的资源的能力的 web.config 内容......

如果您确实完成了所有步骤，请告诉我，我会看看我还能想出什么:)

我希望这是有帮助的！

# php - 基于 C++ 代码在 PHP 中创建字节数据并将其传递到套接字

> ID：13588168
> 
> 赞同：2
> 
> 时间：2012-11-27T16:03:29.650
> 
> 标签：php, c++, sockets, unicode, pack

如果这个标题没有让你感到困惑，我会看看我能在这里做什么。我有一个将 TCP 流量传递到服务器的 C++ DLL 的源代码。我相信所有相关的 C++ 代码如下：

```
#define HRD_MSG_SANITY1     0x1234ABCD
#define HRD_MSG_SANITY2     0xABCD1234

typedef struct{
   unsigned int    nSize;
   unsigned int    nSanity1;
   unsigned int    nSanity2;
   unsigned int    nChecksum;
   WCHAR   szText[1];
} HRD_MSG_BLOCK;

CString strMessage = "this is a test\n";
 // I added this - the rest of the code
 // to determine this is unnecessary for
 // the context of this question.

//
//  Allocate.
//
int nMsgBytes  = sizeof(HRD_MSG_BLOCK) + sizeof(TCHAR) * (strMessage.GetLength() + 1);
HRD_MSG_BLOCK*  pMsgBlock  = (HRD_MSG_BLOCK*) new BYTE[nMsgBytes];
BYTE*           pMsgBuffer = (BYTE*)pMsgBlock;

ZeroMemory(pMsgBlock, nMsgBytes);

pMsgBlock->nSize     = nMsgBytes;
pMsgBlock->nSanity1  = HRD_MSG_SANITY1;
pMsgBlock->nSanity2  = HRD_MSG_SANITY2;
pMsgBlock->nChecksum = 0;

_tcscpy(pMsgBlock->szText, strMessage);

for (int nSendLoop = 0; (nSendLoop < MAX_SENDS) && (nToSend > 0); nSendLoop++) {
    //
    //  Send data to this port, max of 32k (0x8000).
    //
    int nSendSize  = min(nToSend, 0x8000);
    int nSentCount = (int)::send(g_socket, (char*)&pMsgBuffer[nSent], nSendSize, 0);

    //
    //  Error.
    //
    if (nSentCount == SOCKET_ERROR) {
        CSocketError error(::WSAGetLastError());

        //
        //  Report the error.
        //
        g_strLastError.Format(_T("Error sending %u bytes to socket %u - %s"),
                                      nSendSize,
                                      g_socket,
                                      error.Text());
    } else {
        nSent   += nSentCount;
        nToSend -= nSentCount;
    }
} 
```

我想做的是通过 PHP 完成同样的事情。这是PHP代码：

```
class HRD_MSG_BLOCK {
    public $nsize;
    public $nSanity1;
    public $nSanity2;
    public $nChecksum;
    public $szText;
}

$string = "this is a test\n";
$pMsgBlock = new HRD_MSG_BLOCK();
$nMsgBytes = 20 + (2*(strlen($string)+1));
 // I determined this by comparing to
 // actual size of TCHAR = 2 and actual
 // size of pMsgBlock = 20 in Visual Studio

$pMsgBlock->nSize = $nMsgBytes;
$pMsgBlock->nSanity1 = 0x1234ABCD;
$pMsgBlock->nSanity2 = 0xABCD1234;
$pMsgBlock->nChecksum = 0;
$pMsgBlock->szText = utf8_encode($string);
$binarydata = pack("C*", $pMsgBlock); 
```

然后我创建套接字，并使用`socket_write`发送`$binarydata`。

显然，我不能使用`pack()`，因为我不能将类对象 ($pMsgBlock) 转换为 int（这是 pack() 的第二个参数所必需的）。我使用 utf8_encode() 因为 DLL 文档说：

> szText 是作为 UNICODE（宽）字符串发送的文本。

我无法准确确定 C++ DLL 发送到套接字的内容，所以我基本上是在猜测我需要在 PHP 中发送什么。

我可以使用帮助来确定 C++ 代码到底发送了什么，以及如何在 PHP 中做同样的事情。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T18:24:45.843

您不能 pack() 整个对象，但可以 pack() 并连接成员。所以，像

```
$packed = pack('I', $pMsgBlock->nSize)
.pack('I', $pMsgBlock->nSanity1)
.pack('I', $pMsgBlock->nSanity2)
.pack('I', $pMsgBlock->nChecksum)
.mb_convert_encoding($pMsgBlock->szText, 'UTF-16'); 
```

# php - Join + While 循环只输出一个结果

> ID：13588170
> 
> 赞同：0
> 
> 时间：2012-11-27T16:03:35.923
> 
> 标签：php, mysql, join, while-loop

我正在尝试进行测验并使用以下内容来比较结果，它似乎可以工作并输出一次，但仅此而已，即使测验中有两个问题，我也不会再处理任何记录，所以它应该输出正确，正确或正确，不正确等。

```
 <?php
    // Make a MySQL Connection
    // Construct our join query
    $query = "SELECT * FROM itsnb_chronoforms_data_answerquiz a, itsnb_chronoforms_data_createquestions
    q WHERE a.quizID='$quizID' AND a.userID='$userID' and q.quizID=a.quizID and
    a.quizselectanswer = q.correctanswer" or die("MySQL ERROR: ".mysql_error());

    $result = mysql_query($query) or die(mysql_error());

    // Print out the contents of each row into a table 
    while($row = mysql_fetch_array($result)){
        if ($row['correctanswer'] == $row['quizselectanswer']){
            echo 'CORRECT';}
            else { echo 'INCORRECT';
            }

        echo "<br />";
    }
    ?> 
```

编辑>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> >>>>>>>>>

表结构如下>>

itsnb_chronoforms_data_answerquiz cf_id , cf_uid , cf_created , cf_modified , cf_ipaddress, cf_user_id, questionID, quizselectanswer ,quizID ,userID

itsnb_chronoforms_data_createquestions cf_id ,cf_uid,cf_created ,cf_modified, cf_ipaddress, cf_user_id, quizID, questionID, quizquestion, quizanswer1, quizanswer2, quizanswer3, quizanswer4, questionformat ,正确答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:31:42.133

删除 selectanswer=correctanswer 条件时，您会得到四个答案（这确实不是您想要的，因为您想同时获取正确和不正确的答案），因为您没有关联答案 ID。

```
$query = "SELECT * FROM itsnb_chronoforms_data_answerquiz a, itsnb_chronoforms_data_createquestions
q WHERE a.quizID='$quizID' AND a.userID='$userID' and q.quizID=a.quizID and
a.quizselectanswer = q.correctanswer" or die("MySQL ERROR: ".mysql_error()); 
```

应该：

```
$query = "SELECT * FROM itsnb_chronoforms_data_answerquiz a, itsnb_chronoforms_data_createquestions
q WHERE a.quizID='$quizID' AND a.userID='$userID' and q.quizID=a.quizID and
a.questionID = q.questionID" or die("MySQL ERROR: ".mysql_error()); 
```

在没有该条件的情况下，您将获得 questionID 的叉积。您看到的四个记录（如果 questionID 是 1 和 2）：

1.  a.questionID=1 和 q.questionID=1
2.  a.questionID=1 和 q.questionID=2 （不想要这个）
3.  a.questionID=2 和 q.questionID=1 （或这个）
4.  a.questionID=2 和 q.questionID=2

# php - Wordpress 列出给定类别按标签分组的所有帖子

> ID：13588174
> 
> 赞同：0
> 
> 时间：2012-11-27T16:03:50.523
> 
> 标签：php, wordpress-theming, wordpress

我有一个循环，用于获取按给定标签的类别分组的所有帖子（请参见下面的代码）。我需要扭转它并做完全相同的事情，但通过给定类别的标签。

在代码示例中，我将所有帖子标记为“torrington”，然后执行循环以显示它们按类别分组，并带有类别的 H2（例如“餐厅”）。

所以反过来，我需要获取所有项目类别“餐厅”，然后按标签对它们进行分组（例如“torrington”、“danbury”等）。

```
<?php           
        // get all the categories from the database
        $cats = get_categories(); 
            // loop through the categries
            foreach ($cats as $cat) {
                // setup the cateogory ID
                $cat_id= $cat->term_id;

                // create a custom wordpress query
                query_posts("cat=$cat_id&tag=torrington&post_per_page=100");

                // start the wordpress loop!
                if (have_posts()) :     

                // Make a header for the category
                echo '<h2 class="cat-title">'.$cat->name.'</h2>';

                while (have_posts()) : 
                the_post(); ?>

                    <?php // create our link now that the post is setup ?>
                    <div class="listing">
                    <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                    <?php the_content(); ?>
                    </div>
                    <?php //echo '<hr/>'; ?>

                <?php endwhile; endif; // done our wordpress loop. Will start again for each category ?>
            <?php } // done the foreach statement ?> 
```

编辑：我已经做到了这一点，但 query_posts 语句似乎什么也没返回：

```
 <?php           
        // get all the categories from the database
        $tags = get_tags(); 
            // loop through the categries
            foreach ($tags as $tag) {
                echo($tag->name);
                // setup the cateogory ID
                $tag_id = $tag->term_id;

                echo($tag_id);

                // create a custom wordpress query
                query_posts("tag_id=$tag_id&cat=eats&post_per_page=100");

                // start the wordpress loop!
                if (have_posts()) :     

                echo('posts');
                // Make a header for the category
                echo '<h2 class="cat-title">'.$tag->name.'</h2>';

                while (have_posts()) : 
                the_post(); ?>

                    <?php // create our link now that the post is setup ?>
                    <div class="listing">
                    <a href="<?php the_permalink();?>"><?php the_title(); ?></a>
                    <?php the_content(); ?>
                    </div>
                    <?php //echo '<hr/>'; ?>

                <?php endwhile; endif; // done our wordpress loop. Will start again for each category ?>
            <?php } // done the foreach statement ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:21:04.190

知道了。这是简单的改变`tag_id=$tag_id`not `tag=$tag_id`。

上面的代码更新了。相关线路是`query_posts("tag_id=$tag_id&cat=eats&post_per_page=100");`

# java - 如何使用 App Engine url fetch 服务像网络浏览器一样处理 cookie？

> ID：13588177
> 
> 赞同：1
> 
> 时间：2012-11-27T16:03:55.820
> 
> 标签：java, google-app-engine, cookies

我已经看到很多关于在 App Engine 上使用带有 url fetch 的 cookie 的问题，但是很多人做错了，并且在 Java App Engine 上没有确认为有效的解决方案。

我想做的就是：

1.  提出一项要求
2.  从该请求中获取 cookie。
3.  使用这些 cookie 发出第二个请求。

它能有多难？？

这在开发服务器上很容易做到，因为开发服务器会自动跨请求复制 cookie——而且实际上不可能阻止它这样做。但真正的 App Engine urlfetch 服务不*会这样做*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:25:06.550

利用

```
new HTTPRequest(url, HTTPMethod.GET, fetchOptions.doNotFollowRedirects()) 
```

创建请求对象。

出于某种原因，这`doNotFollowRedirects()`是**必不可少的。**我不明白为什么。

然后从响应中获取 set-cookie 标头（名称为 的标头`equalsIgnoreCase("Set-Cookie")`）并创建相应的`Cookie`标头 - 修剪每个 Set-Cookie 标头中分号后的所有内容（如果有），然后将所有 cookie 连接在一起`;`作为分隔符.

这不能正确处理到期等问题，但这对于大多数用途来说应该足够了。

# c - 我们应该使用 __device__ 和 __host__ 的示例

> ID：13588182
> 
> 赞同：3
> 
> 时间：2012-11-27T16:04:09.283
> 
> 标签：c, cuda, gpu

`CUDA`结合`__device__`并`__host__`允许从和`device`调用函数`host`。

我的问题是：是否有任何示例使用两者都比仅定义`__device__` or更可取`__host__`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:42:34.830

典型示例是在 CUDA 中使用 C++ 类。在 CUDA C++ 模型中，如果要在设备和主机内存空间中实例化该类，则*必须*在主机和设备代码中定义该类的每个成员函数。

最简单的可能情况是一个平凡的类：

```
class example
{
    public:
    float a, b;

    example(float _a, float _b) : a(_a), b(_b) {};
} 
```

不能在 CUDA 的类中使用它，您必须在设备和主机代码中定义构造函数，因此：

```
class example
{
    public:
    float a, b;

    __device__ __host__
    example(float _a, float _b) : a(_a), b(_b) {};
} 
```

# c# - 使用 JSON.NET 反序列化 JSON 字符串

> ID：13588185
> 
> 赞同：6
> 
> 时间：2012-11-27T16:04:13.533
> 
> 标签：c#, json, json.net

我正在尝试反序列化以下 JSon 字符串，以便我可以捕获 abcd 中的值...

```
{
   "2012-11-26 20:34:12": {
    "a": 65,
    "b": -1,
    "c": "2012-11-26 20:34:12",
    "d": -1,
    "e": 0,
    "f": -112.3211156215747,
    "g": 33.57955864376957
  }
} 
```

JSonlint 说这是有效的 JSon 数据，但是我会在 C# 中创建什么样的类来使用 JSON.NET JsonConverter 来反序列化它？

我将获得更多这样的数据，并且密钥会有所不同（当前显示为“2012-11-26 20:34:12”），这是让我感到困惑的部分。

任何让我开始的示例代码将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:14:19.987

你不需要任何课程

```
var obj = (JObject)JsonConvert.DeserializeObject(json);

var dict = obj.First.First.Children().Cast<JProperty>()
            .ToDictionary(p => p.Name, p =>p.Value);

var dt =  (string)dict["c"];
var d = (double)dict["g"]; 
```

# linux - bash 脚本中带引号和空格的 awk

> ID：13588188
> 
> 赞同：4
> 
> 时间：2012-11-27T16:04:20.393
> 
> 标签：linux, bash, unix, scripting, awk

我在接收到的 snmp 陷阱的 bash 变量集中有以下输出：

回声 $var

```
Nov 27 16:20:34 witness logger: trap: vars: DISMAN-EVENT-MIB::sysUpTimeInstance = 0:6:10:29.06,  SNMPv2-MIB::snmpTrapOID.0 = SNMPv2-SMI::enterprises.11.2.29.2.90.0.10000002, SNMPv2 SMI::enterprises.11.2.29.2.90.1 = "Finished Number", SNMPv2-SMI::enterprises.11.2.29.2.90.2 = "Filter Cirteria: [called='3333']", SNMPv2-SMI::enterprises.11.2.29.2.90.3 = "Cleared", SNMPv2     SMI::enterprises.11.2.29.2.90.4 = "major Over-Flow alert on Finished Number for ['3333']", SNMPv2 SMI::enterprises.11.2.29.2.90.5 = "The Corresponding Metric Value is: 0.5", SNMPv2- SMI::enterprises.11.2.29.2.90.6 = "Over-Flow", SNMPv2-SMI::enterprises.11.2.29.2.90.7 = "Tue Nov 27 16:20:05 CET 2012" 
```

我试图在变量中获得以下输出：

```
var1 = "Tue Nov 27 16:20:05 CET 2012"
var2 = "Finished Number"
var3 = "The Corresponding Metric Value is: 0.5"
var4 = "Cleared"
var5 = "major Over-Flow alert on Finished Number for ['3333']" 
```

我正在考虑通过 awk 做到这一点

基于snmp OID：enterprise.11.2.29.2.90.4, enterprise.11.2.29.2.90.5, 11.2.29.2.90.6 等...

但似乎无法仅提取引用内容的内容“”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:31:30.493

似乎您想匹配双引号内的所有字符串，这是最容易完成的`grep`：

```
$ echo $var | grep -o '"[^"]*"'

"Finished Number"
"Filter Cirteria: [called=3333]"
"Cleared"
"major Over-Flow alert on Finished Number for [3333]"
"The Corresponding Metric Value is: 0.5"
"Over-Flow"
"Tue Nov 27 16:20:05 CET 2012" 
```

解释：

`-o`只打印匹配的那部分行。

```
"     # Match opening double quote
[^"]* # Match anything not a double quote
"     # Match closing double quote 
```

希望这可以帮助您入门。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:17:51.987

Perl 解决方案：

```
echo "$var" | perl -nE 'say "var", ++$x, "=$1" while /(".*?")/g' 
```

输出：

```
var1="Finished Number"
var2="Filter Cirteria: [called='3333']"
var3="Cleared"
var4="major Over-Flow alert on Finished Number for ['3333']"
var5="The Corresponding Metric Value is: 0.5"
var6="Over-Flow"
var7="Tue Nov 27 16:20:05 CET 2012" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:26:35.070

让我们从一些简单的事情开始，这样您就可以看到在使用时字段是如何分解的`awk`：

```
echo "${var}" | awk 'BEGIN{FS="\""} {for (i=1; i<=NF; i++) {print "["i"]", $i}}' 
```

或者，如果你的 shell 支持 herestrings：

```
awk 'BEGIN{FS="\""} {for (i=1; i<=NF; i++) {print "["i"]", $i}}' <<< "${var}" 
```

**输出：**

```
[1] Nov 27 16:20:34 witness logger: trap: vars: DISMAN-EVENT-MIB::sysUpTimeInstance = 0:6:10:29.06,  SNMPv2-MIB::snmpTrapOID.0 = SNMPv2-SMI::enterprises.11.2.29.2.90.0.10000002, SNMPv2 SMI::enterprises.11.2.29.2.90.1 = 
[2] Finished Number
[3] , SNMPv2-SMI::enterprises.11.2.29.2.90.2 = 
[4] Filter Cirteria: [called='3333']
[5] , SNMPv2-SMI::enterprises.11.2.29.2.90.3 = 
[6] Cleared
[7] , SNMPv2     SMI::enterprises.11.2.29.2.90.4 = 
[8] major Over-Flow alert on Finished Number for ['3333']
[9] , SNMPv2 SMI::enterprises.11.2.29.2.90.5 = 
[10] The Corresponding Metric Value is: 0.5
[11] , SNMPv2- SMI::enterprises.11.2.29.2.90.6 = 
[12] Over-Flow
[13] , SNMPv2-SMI::enterprises.11.2.29.2.90.7 = 
[14] Tue Nov 27 16:20:05 CET 2012
[15] 
```

现在根据需要选择字段：

```
var1=$(awk 'BEGIN{FS="\""} {print $14}' <<< "${var}")
var2=$(awk 'BEGIN{FS="\""} {print $2}' <<< "${var}")
var3=$(awk 'BEGIN{FS="\""} {print $10}' <<< "${var}")
var4=$(awk 'BEGIN{FS="\""} {print $6}' <<< "${var}")
var5=$(awk 'BEGIN{FS="\""} {print $8}' <<< "${var}") 
```

**解释：**

*   `awk 'BEGIN{FS="\""}`: 这里我们`awk`用来分隔输入`"`
*   `{print $14}'`：打印用引号括起来的特定字段
*   `<<< "${var}"`: 如果可用，使用 herestring 代替 echo（见上文）
*   这是假设您的格式在`$var`字段排序方面保持相对一致

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T20:58:25.840

```
$ echo "$var" | awk -F\" 'BEGIN{n=split("14 2 10 6 8",v," ")} {for (i=1;i<=n;i++) printf "var%d = \"%s\"\n",i,$(v[i])}'
var1 = "Tue Nov 27 16:20:05 CET 2012"
var2 = "Finished Number"
var3 = "The Corresponding Metric Value is: 0.5"
var4 = "Cleared"
var5 = "major Over-Flow alert on Finished Number for ['3333']" 
```

此外，也许更多你想要的，这里是如何用 awk 执行的结果填充一个 shell 数组：

```
$ IFS=$'\n' varArr=( $(echo "$var" | awk -F\" 'BEGIN{n=split("14 2 10 6 8",v," ")}
 {for (i=0;i<=n;i++) printf "\"%s\"\n",$(v[i])}') )

$ echo "${varArr[1]}"                                                         
"Tue Nov 27 16:20:05 CET 2012"

$ echo "${varArr[2]}"
"Finished Number"

$ echo "${varArr[3]}"
"The Corresponding Metric Value is: 0.5"

$ echo "${varArr[4]}"
"Cleared"

$ echo "${varArr[5]}"
"major Over-Flow alert on Finished Number for ['3333']" 
```

如果您不想在文本周围加上引号，请不要在 awk 脚本中添加它们：

```
IFS=$'\n' varArr=( $(echo "$var" | awk -F\" 'BEGIN{n=split("14 2 10 6 8",v," ")}
{for (i=0;i<=n;i++) print $(v[i])}') ) 
```

以上两种方法都会将整个输入字符串放在 ${varArr[0]} 中。如果这是不可取的，这是一个微不足道的调整。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T08:18:55.990

我最终使用了 awk 解决方案，但其他解决方案也很适合。谢谢大家。

```
val=$(echo $val |  awk '{for(i=1;i<=NF;i++)if($i~/is:/)print $(i+1)}' | cut -d\" -f 1) 
```

有关信息，当接收到陷阱时，该脚本将在 snmptrapd 中使用，它会将日志放入消息中并对特定警报执行其他操作。

主循环如下：

```
vars=
while read oid val
do
if [ "$vars" = "" ]
  then
    vars="$oid = $val"
  else
    vars="$vars, $oid = $val" 
        if [ "$oid" == "SNMPv2-SMI::enterprises.11.2.29.2.90.5" ]
        then
          val=$(echo $val |  awk '{for(i=1;i<=NF;i++)if($i~/is:/)print $(i+1)}' | cut -d\" -f 1)
          /bin/logger "found: value 5:    $val "
          val5=$val
        fi
 fi
done 
```

# c# - 如何在 C# 中将 DataTable 行复制到对象？

> ID：13588190
> 
> 赞同：3
> 
> 时间：2012-11-27T16:04:21.563
> 
> 标签：c#, .net

例如，我有一个类对象：

```
class MyClass
{
public int a { get; set; }
public string b { get; set; }
public DateTime c { get; set; }
} 
```

我有一个 DataTable 对象，其中的列与 MyClass 中的名称相同。是否有一种快速/简单的方法将 DataTable 对象的每一行复制到 MyClass 对象。

像这样（但在我的情况下，我有太多的列）：

```
for (int x = 0; x < dataTableObj.Rows.Count; x++)
{
myClassObj[x].a = dataTableObj.Rows[x]["a"];
myClassObj[x].b = dataTableObj.Rows[x]["b"];
myClassObj[x].c = dataTableObj.Rows[x]["c"];
} 
```

感谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:43:19.650

为此，我在下面使用此方法，数据表列和类型属性应该具有相同的名称。

```
public static List<T> TableToList<T>(DataTable table)
{
  List<T> rez = new List<T>();
  foreach (DataRow rw in table.Rows)
  {
    T item = Activator.CreateInstance<T>();
    foreach (DataColumn cl in table.Columns)
    {
      PropertyInfo pi = typeof(T).GetProperty(cl.ColumnName);

      if (pi != null && rw[cl] != DBNull.Value)
      {
        var propType = Nullable.GetUnderlyingType(pi.PropertyType) ?? pi.PropertyType;
        pi.SetValue(item, Convert.ChangeType(rw[cl], propType), new object[0]);
      }

    }
    rez.Add(item);
  }
  return rez;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:13:20.130

您应该能够修改以下代码以满足您的需求。

```
var myBindings = System.Reflection.BindingFlags.Instance
        | System.Reflection.BindingFlags.Public 
        | System.Reflection.BindingFlags.SetProperty;

foreach (var row in table.AsEnumerable())
{
    MyClass newObject = new MyClass();
    foreach (var property in typeof(MyClass).GetProperties(myBindings))
    {
        if (table.Columns.Contains(property.Name))
        {
            //optionally verify that the type of the property matches what's in the datatable
            property.SetValue(newObject, row[property.Name]);
        }
    }
    //add newObject to result collection
} 
```

# javascript - VBA Acrobat JSO 保存在 For 循环中覆盖 96 个文件后

> ID：13588198
> 
> 赞同：1
> 
> 时间：2012-11-27T16:04:43.967
> 
> 标签：javascript, vba, acrobat

我正在研究一个 VBA 宏，该宏循环遍历一个大型电子表格，将每一行导出为 XML，将 XML 文件导入 PDF 表单（XFA 架构），然后将每个填充的表单保存到预定义的文件夹中。问题是，经过 96 次迭代（反复测试），每个新完成的 PDF 都会导致最旧的 PDF 从文件夹中消失。被循环的代码如下：

```
Sub AcroExport()

Dim OutputPath As String
Dim theForma As New AcroAVDoc
Dim theform As AcroPDDoc
Dim jso As Object
OutputPath = GetMyDocuments()

ActiveWorkbook.XmlMaps("1042-S_Map").Export OutputPath & "f1042sExportTemp.xml", True

If theForma.Open("C:\Users\E050704\Desktop\f1042s.pdf", "") Then

    Set theform = theForma.GetPDDoc
    Set jso = theform.GetJSObject
    jso.importXFAData OutputPath & "f1042sExportTemp.xml"
    theform.Save 1, OutputPath & "1042-S_K-1_Output\" & "Form 1042-S - " & Range("ReciptNameCell").Value & ".pdf"
    theForma.Close True

End If

End Sub 
```

我还尝试了 JavaScript 对象中的 SaveAs 方法，结果略有不同（仍然是 96 个文件，但不是删除最旧的文件，而是根本不创建新文件）。

完全不知道如何让它保留超过 96 个文件。任何帮助深表感谢。

作为参考，我使用的是 Windows 7 Enterprise、Excel 2007 和 Acrobat 9 Standard（版本 9.4.6）。

# c - 制作一个测量缓存块大小的C程序

> ID：13588199
> 
> 赞同：2
> 
> 时间：2012-11-27T16:04:45.097
> 
> 标签：c, caching

程序使用`sbrk(`) 函数声明大数组。Sbrk 按指定的增量更改数据段大小。我正在使用的标准库函数，例如：

```
#include  <stdio.h>  
#include <sys/time.h>  
#include <unistd.h> 
```

我的 main() 函数首先声明一个变量： register *a; 我的目标是尝试将在内存访问期间将使用的所有变量放入寄存器中，因为我想要的唯一内存访问是数组。如果局部变量驻留在内存中，访问它们可能会对测量产生影响。接下来是分配数组，一个大约有 400 万个整数的数组，在 32 位机器上是 16 MB。

```
a=sbrk(4*1024*4096+8192);
a=(int  *)((((int)a>>13)<<13)+8192); 
```

启动程序时，会为其分配一些内存。该函数`sbrk()`将这个内存增加给定的数量。在函数调用之后，“a”将指向这个巨大数组的开头。

现在我有了这些，我不知道该怎么做才能获得缓存块的大小，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T19:09:08.437

我知道没有办法使用直接 C 来获取缓存行大小。如果您使用的是 x86 处理器，则可以使用 cpuid 查询 CPU 的缓存行大小。

[此页面](http://softpixel.com/~cwright/programming/simd/cpuid.php)包含有关如何执行此操作的说明。向下滚动到`CPUID — Detecting Cache Line Sizes`。

> 如果您想使用 prefetch 和 clflush 等指令积极地将数据刷新和预取到缓存中，则查找处理器的 Cache Line Size 会很有帮助。检测到这一点会因制造 CPU 的厂商而异。
> 
> 对于 Intel 微处理器，可以通过调用 cpuid 函数 0x1 后将 bh 乘以 8 来计算高速缓存行大小。
> 
> 对于 AMD 微处理器，调用 cpuid 函数 0x80000005 后，数据缓存线大小在 cl 中，指令缓存线大小在 dl 中。
> 
> 了解缓存行大小可以让您调度有效的预取和刷新，还可以帮助您将数据与缓存行边界对齐，以避免从拆分缓存行加载，这会影响性能。

# javascript - 等待 ajax 响应填充对象

> ID：13588201
> 
> 赞同：4
> 
> 时间：2012-11-27T16:04:52.207
> 
> 标签：javascript, jquery, ajax

我正在使用 AJAX 从服务器获取一些值，并且我正在异步执行它。我怎样才能停止以等待 AJAX 请求结束？这是我的代码：

```
var response = {}
for (var i = 0; i < length; i++){
        $.ajax({
            url : url[i],
            dataType : 'json'
        }).success(function(result) {
            processResult(result);
        })
} 
```

我想我应该创建一个等待的函数，但它不能正常工作：

```
function wait() {
    for (var name in response) {
        if (response[name] === undefined) {
            setTimeout(function() {
                wait()
            },50)
        }
    }
    processResult(); //this is function where I will process my AJAX result
} 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T09:31:06.203

好的，我想通了。因为正如我之前所说，在**每个**`ajaxComplete`AJAX 请求之后启动，所以我必须创建等待所有请求完成的函数。所以我这样做了：

 **我改变了我的功能：

```
var response = {}
for (var i = 0; i < length; i++){
        $.ajax({
            url : url[i],
            dataType : 'json'
        }).success(function(result) {
            processResult(result);
        })
} 
```

至：

```
 response = {}
    for (var i = 0; i < length; i++){
      callAJAX(url[i]);
    }
_wait4ajax(); 
```

函数 callAJAX 是这样的：

```
function callAJAX(url){
            $.ajax({
                url : url[i],
                dataType : 'json'
            }).success(function(result) {
                processResult(result);
            })
} 
```

并且`_wait4ajax`是我检查对象的所有属性是否不是`undefined`这样的函数：（我有应该填写在对象中的属性列表 - 此属性在`visibleLayers`数组中

```
function _wait4ajax(){
        var controlArray = [], self = this;

        var length = this.visibleLayers.length;
        for (var i = 0; i < length; i++) {
            if (this.cachedFeatures[this.visibleLayers[i]] === undefined) {
                controlArray.push('false');
            } else {
                controlArray.push('true');
            }
        }
        if (controlArray.indexOf('false') != -1) {
            setTimeout(function() {
                self._wait4ajaxComplete();
            }, 50);
        } else {
            //AJAX has ended - Object is ready
        }
} 
```

我把我的伪代码（为这个站点的目的而创建）和我项目中的实际代码搞砸了，所以它可能不会以这种形式工作，但我想指定这个主题的具体想法。填写免费编辑此帖子。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:12:07.103

因为这可能是答案，所以我会在这里发布。我想你正在寻找：

[http://api.jquery.com/ajaxComplete/](http://api.jquery.com/ajaxComplete/)

您可以使用它来找出所有 ajax 何时完成，然后对响应进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:11:20.053

这个问题的答案将做你想要的：

[如何让 jQuery 执行同步而不是异步的 Ajax 请求？](https://stackoverflow.com/questions/133310/how-can-i-get-jquery-to-perform-a-synchronous-rather-than-asynchronous-ajax-re)

你的代码：

```
var response = {}
for (var i = 0; i < length; i++){
        $.ajax({
            url : url[i],
            dataType : 'json',
            async:   false,
            success: function(result) {                
                processResult(result);
            }
} 
```**

# android - 为什么 .tiff 格式的图像没有显示在 Android WebView 中？

> ID：13588206
> 
> 赞同：1
> 
> 时间：2012-11-27T16:05:11.580
> 
> 标签：android, image, android-webview, tiff

我无法在 Android 中显示 .tiff 文件`WebView`。Android 是否`WebView`支持 .tiff 文件格式？

如果是，如何在 Android 中显示 .tiff 文件`WebView`？给我任何解决方案。

# java - 在Java中将odt转换为pdf而不启动soffice

> ID：13588209
> 
> 赞同：2
> 
> 时间：2012-11-27T16:05:23.247
> 
> 标签：java, pdf, openoffice.org

我的问题似乎很基本，但我无法找到一个简洁的解决方案。

我需要将`odt`文件转换为`pdf`文件。[JODConverter](http://www.artofsolving.com/opensource/jodconverter)运行良好，但`soffice`需要安装在机器上并单独启动。对于生产限制，我不能假设`soffice`将安装在执行我的应用程序的机器上。

那么有没有办法通过设置正确的依赖关系并调用正确的代码来完成这种转换呢？这可以简单地使用[UNO API](http://www.openoffice.org/api/docs/common/ref/com/sun/star/module-ix.html)或任何其他方式完成吗？如果是的话，你能给我更多的见解吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T14:14:55.943

您可能想尝试[ODFDOM](http://code.google.com/p/xdocreport/wiki/ODFDOMConverterPDFViaIText)。

免责声明：我自己没有使用过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:30:20.197

如果 CUPS 可用，您可以考虑使用 CUPS-PDF。它独立于办公室。它只会将 .odt 文件“打印”为 PDF 格式。[这是 CUPS-PDF 主页](http://www.cups-pdf.de/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T08:04:42.383

JOD Converter 运行良好，如果可以使用无头选项安装专用服务器开放式办公室 [https://askubuntu.com/questions/194352/install-openoffice-for-headless-use](https://askubuntu.com/questions/194352/install-openoffice-for-headless-use)

使用 Tomcat，您可以运行 Web 应用程序将 Open Office 支持的任何文件转换为 PDF [http://www.artofsolving.com/opensource/jodconverter](http://www.artofsolving.com/opensource/jodconverter)

# php - 使用 phpseclib 时是否需要使用 stream_set_blocking？

> ID：13588212
> 
> 赞同：0
> 
> 时间：2012-11-27T16:05:39.463
> 
> 标签：php, phpseclib

我一直在阅读[PECL](http://pecl.php.net/package/ssh2)和[phpseclib](http://phpseclib.sourceforge.net/)的 SSH2 库之间的差异。似乎 phpseclib 使用起来更简单一些，而且我发现的示例代码很少。通过 SSH2 库，我看到了对[`stream_set_blocking`](http://php.net/stream_set_blocking). 我是否需要将此功能与 phpseclib 一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:56:39.603

我已经将 phpseclib 用于 SSH 和 SFTP，并且不需要使用这样的功能。

# qt - QML 未收到有关属性更改的通知

> ID：13588213
> 
> 赞同：1
> 
> 时间：2012-11-27T16:05:41.877
> 
> 标签：qt, properties, ocaml, qml

在我的测试应用程序中，我使用了由 C++ 层连接的 QML 和 OCaml。您可以通过 Github 调查[来源根目录。](https://github.com/Kakadu/QOcamlBrowser/tree/41430cfe8138d2738523b85faa922d0d307e992d)

首先，我想稍微解释一下我的 QML [GUI](https://github.com/Kakadu/QOcamlBrowser/blob/41430cfe8138d2738523b85faa922d0d307e992d/qml/QOcamlBrowser/main.qml#L9)是什么。我的数据是字符串列表的列表（长度为 N）。使用这些数据，我应该显示 N 个 ListViews，其中将包含适当列表的元素。这种行为对于基于 Tcl/Tk gui 的传统 ocamlbrowser 来说很简单。

*我知道我的 GUI 的一个缺点：如果数据被更改但上层*列表的总数不会 --- 那么关于更改列表长度的信号将不会被发送。这就是为什么我将新数据设置为等于空列表并发送新的真实数据。所以信号应该被发射两次。

[在这里和下面，](https://github.com/Kakadu/QOcamlBrowser/blob/41430cfe8138d2738523b85faa922d0d307e992d/Asdf.h#L18)您可以找到描述我的 int 类型属性的代码，该属性存储列表计数。

现在我们正站在我的问题面前。当我在发出信号之前更改 OCaml 端 qDebug() 消息中的数据内容时，但 QML 内容没有改变：一切似乎都发出了信号但没有收到。这是来自我的程序的日志（最后三行来自 C++ qDebug() 端，其他来自 OCaml 端）：

```
setSelectedIndexAt 0 to 2
selectedIndexes.length = 1
new path: /2
new_data.length = 1
[ [ Lazy; Parsing; Weak; Pervasives; Buffer; Printf; Toploop; Queue; Graphics; Arg; Num;     CamlinternalLazy; GraphicsX11; MoreLabels; Stream; Dynlink; Oo; Obj; Callback; Format; Complex; Genlex; UnixLabels; Stack; Lexing; Marshal];
[t; create; length; set; get; get_copy; check; fill; blit; S; Make ] ]
selected: [2; -1]
"emitted tablesChanged 0" 
"emitted tablesChanged 2" 
showDescription changed 
```

那么，您对我的实施中存在问题有任何想法吗？

PS 如果您需要，我很乐意添加一些额外的解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:02:00.100

问题很简单：我没有从 OCaml 端调用 setter。我还没有意识到使用打印，因为我曾经在设置器和通知器中打印相同的消息。

PS非常感谢capisce！

# python - 使用 httplib 的 HTTP 代码 204

> ID：13588214
> 
> 赞同：0
> 
> 时间：2012-11-27T16:05:58.537
> 
> 标签：python, https, httplib

我正在编写一个 python 程序来使用 httplib 模块访问 HTTPS 网页，并且无法从 URL 中检索消息正文。这是我的示例代码：

```
username = "user"
password = "pass"
auth = base64.encodestring("%s:%s" % (username, password))
headers = {"Authorization" : "Basic %s" % auth, "User-agent" : "Mozilla/5.0 (Windows NT 6.1; rv:15.0) Gecko/20120716 Firefox/15.0a2"}
conn = httplib.HTTPSConnection("beta.space-track.org")
conn.request("GET", "/basicspacedata/query/class/tle_latest/NORAD_CAT_ID/37793/ORDINAL/1/orderby/FILE%20desc/limit/1/format/tle", headers=headers)
response = conn.getresponse()
data = response.read()
print response.status, response.reason
conn.close() 
```

这将返回 204 No Content 的 HTTP 状态。据我所知，204 错误意味着请求被很好地理解，但没有发送任何内容。可能是什么问题呢？我认证错了吗？

# web-services - 在 Silverlight 中处理 WebService 的 GetSomethingById 类方法的最佳实践

> ID：13588217
> 
> 赞同：1
> 
> 时间：2012-11-27T16:06:03.907
> 
> 标签：web-services, silverlight, .net-4.0

处理源自多次调用的 WebService 方法的 -Completed 事件的最佳实践是什么，并且 -Completed 事件被订阅了很多次。

[这个答案](https://stackoverflow.com/a/5311488/1151654)建议从事件参数中识别结果（在本例中使用 e.Type 但也可以使用 e.Result.Id 或任何有助于识别所需内容的东西来完成）。

另一方面，[这个答案显示了每次调用的客户端初始化。](https://stackoverflow.com/a/5322577/1151654)

最好做什么？

*   从其内容/附加信息中识别结果；
*   使用多个客户端，每个事件等待者一个；
*   还有什么？

问题是针对 .NET 4.0 和更新版本的，但如果您有一个适用于早期版本的“最佳实践”并且仍然可行，请随意告诉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T03:47:16.390

我以前使用的一种方法是链接 Web 服务调用。因此，当第一次调用完成时，我从已完成的事件中注销，然后使用不同的回调方法注册到另一个或相同的事件，依此类推......我知道这不是完美的方法，但延迟很小，不要说缺席，它比必须管理许多代理实例更简单。如果您需要并行执行调用，我们确实考虑过拥有多个客户端，这可能是要走的路！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T03:51:41.657

根据您尝试执行的操作，您可能希望创建一个类来表示涉及 Web 服务的每个逻辑任务。为逻辑任务的每个实例创建该类的实例，并为该类提供事件。

每个事件的`sender`参数将是包装类的实例。然后，您可以让一段代码处理每个此类逻辑线程的事件，“逻辑线程”将包含所有必要的状态。

# deployment - 无法在 JBoss 7.1.1 上部署 .ear 文件

> ID：13588219
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:06:06.823
> 
> 标签：deployment, jboss, war, ear

我尝试在 JBoss 7.1.1 上部署一个包含 war 文件的 ear 文件。

ear 的 META-INF/ 目录中的 application.xml 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<application version="6">

     <module>
            <web>
                    <web-uri>bof-war.war</web-uri>
                    <context-root>/bof-war</context-root>
            </web>
    </module>

</application> 
```

部署失败，但出现以下异常：

```
14:06:21,265 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015876: Starting deployment of "bof-ear.ear"
14:06:21,313 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015876: Starting deployment of "bof-war.war"
14:06:22,835 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Tomcat6InjectionProvider:org.apache.catalina.util.DefaultAnnotationProcessor' for service type 'com.sun.faces.spi.injectionprovider'
14:06:22,835 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Jetty6InjectionProvider:org.mortbay.jetty.plus.annotation.InjectionCollection' for service type 'com.sun.faces.spi.injectionprovider'
14:06:22,836 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015893: Encountered invalid class name 'org.xmlpull.mxp1.MXParser,org.xmlpull.mxp1_serializer.MXSerializer' for service type 'org.xmlpull.v1.XmlPullParserFactory'
14:06:23,027 INFO  [org.jboss.as.connector.deployers.jdbc] (MSC service thread 1-3) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.2)
14:06:23,037 INFO  [org.apache.catalina.core.StandardContext] (MSC service thread 1-1) The listener "com.sun.faces.config.ConfigureListener" is already configured for this context. The duplicate definition has been ignored.
14:06:23,039 INFO  [org.apache.catalina.core.StandardContext] (MSC service thread 1-1) The listener "com.sun.faces.config.ConfigureListener" is already configured for this context. The duplicate definition has been ignored.
14:06:23,041 INFO  [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/bof-war]] (MSC service thread 1-1) No Spring WebApplicationInitializer types detected on classpath
14:06:23,057 INFO  [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/bof-war]] (MSC service thread 1-1) Initializing Spring root WebApplicationContext
14:06:23,057 INFO  [org.springframework.web.context.ContextLoader] (MSC service thread 1-1) Root WebApplicationContext: initialization started
14:06:23,104 INFO  [ch.homegate.base.jsf2.spring.PrimaryResolverXmlWebApplicationContext] (MSC service thread 1-1) Refreshing Root WebApplicationContext: startup date [Tue Nov 27 14:06:23 CET 2012]; root of context hierarchy
14:06:23,123 INFO  [org.springframework.beans.factory.xml.XmlBeanDefinitionReader] (MSC service thread 1-1) Loading XML bean definitions from ServletContext resource [/WEB-INF/spring.context.cfg.xml]
14:06:23,124 ERROR [org.springframework.web.context.ContextLoader] (MSC service thread 1-1) Context initialization failed: org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from ServletContext resource [/WEB-INF/spring.context.cfg.xml]; nested exception is java.io.FileNotFoundException: Could not open ServletContext resource [/WEB-INF/spring.context.cfg.xml]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:341) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:131) [spring-context-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:530) [spring-context-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:444) [spring-context-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:3392) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:3850) [jbossweb-7.0.13.Final.jar:]
        at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_09]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_09]
        at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_09]
Caused by: java.io.FileNotFoundException: Could not open ServletContext resource [/WEB-INF/spring.context.cfg.xml]
        at org.springframework.web.context.support.ServletContextResource.getInputStream(ServletContextResource.java:140) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:328) [spring-beans-3.1.3.RELEASE.jar:3.1.3.RELEASE]
        ... 20 more 
```

在部署过程中，JBoss 会创建一个分解版本的 ear 和 war 文件：

```
$JBOSS_HOME/standalone/tmp/vfs/tempe4d6b1edc6852af5/bof-ear.ear-870d0776055a3379/contents/bof-war.war/ 
```

这个战争目录是空的。这就是为什么找不到文件 /WEB-INF/spring.context.cfg.xml 的原因。

任何建议我的耳朵文件中可能有什么问题或遗漏？提前非常感谢！

问候，菲利克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T07:32:22.400

我想我刚刚发现了问题：出于某种原因，ear 档案内的战争不是档案，而是一个爆炸的文件夹。在手动刺激耳朵内部的战争之后，JBoss 很高兴。我现在只需要找出，为什么 maven 不在 ear 档案中创建战争档案。

# gnuplot - 下图如何设置标签

> ID：13588226
> 
> 赞同：-2
> 
> 时间：2012-11-27T16:06:24.967
> 
> 标签：gnuplot

请给我这个数字：![在此处输入图像描述](../Images/b0a395cf629f1f45c6b1229843c2d23d.png)

我问如何设置标签 tamisag.data:using 1:2 下图？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:08:33.800

```
set key outside
set key bottom right 
```

有关 gnuplot 中命令的帮助，请使用

```
help <cmd> 
```

例如

```
help set key 
```

完整信息：

```
set key {on|off} {default}
                {left | right | top | bottom | outside | below | <position>}
                {Left | Right} {{no}reverse}
                {samplen <sample_length>} {spacing <vertical_spacing>}
                {width <width_increment>}
                {height <height_increment>}
                {{no}autotitles}
                {title "<text>"} {{no}enhanced}
                {{no}box { {linestyle | ls <line_style>}
                           | {linetype | lt <line_type>}
                             {linewidth | lw <line_width>}}}
        unset key
        show key 
```

文档： http://lavica.fesb.hr/cgi-bin/info2html? [%28gnuplot%29key](http://lavica.fesb.hr/cgi-bin/info2html?%28gnuplot%29key)

演示： http: [//gnuplot.sourceforge.net/demo/key.html](http://gnuplot.sourceforge.net/demo/key.html)

# c++ - 错误 C2440：“正在初始化”：无法从“const int”转换为“int *”

> ID：13588227
> 
> 赞同：1
> 
> 时间：2012-11-27T16:06:25.160
> 
> 标签：c++, templates, pointers, vector

当我尝试运行此代码时

```
template <typename Item, typename Key>
Item* BST<Item,Key>::search(const Key& key) const {
    for (std::size_t i = 0; i < tree.size(); ++i) {
                Item* ptr = NULL;
        if(tree[i].data == key && tree[i].occupied == true) {
            ptr = tree[i].data;
            return ptr;
        }
    }
    return ptr;
} 
```

我最终得到了标题中描述的错误。我已经尝试过多次修复它，但无法弄清楚我做错了什么。对于一些背景信息，树是节点的向量。每个节点都有一个布尔变量说明它是否被占用，还有一个 Item 变量称为数据。该函数应该使用给定的键搜索节点的向量并返回指向其数据的指针，但我一生都无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:08:47.947

看起来`tree[i].data`is`const int`和 not的类型`int*`。代码应该将其地址存储到`ptr`并可能返回`const Item*`。更好的是，如果未找到该节点，则返回一个指向该节点的迭代器或序列结束迭代器。

# android - 我想在单击时更改按钮的颜色？

> ID：13588232
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:06:31.957
> 
> 标签：android, button, widget

> **可能重复：**
> [单击时如何更改 Android 中按钮的颜色？](https://stackoverflow.com/questions/3882064/how-to-change-color-of-button-in-android-when-clicked)

我想在单击时更改按钮的颜色...我该怎么做？我不想通过使用可绘制文件夹来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:13:19.243

使用 a `selector`，在您的文件夹中创建一个文件 xml`drawable/`并将其命名`bg_button.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:drawable="@drawable/back_button_clicked" android:state_pressed="true"></item>
    <item android:drawable="@drawable/back_button_clicked" android:state_focused="true"></item>
    <item android:drawable="@drawable/back_button_normal"></item>

</selector> 
```

然后在您的 xml 布局中，像这样定义您的按钮：

```
<Button android:id="@+id/button"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/bg_button" /> 
```

**注意**：`back_button_clicked`并且`back_button_normal`是`drawables`为你的背景`button`。**当它被点击**时，drawable`back_button_clicked`将成为按钮的背景，在**正常情况下**将成为按钮的背景。**`back_button_normal`**

 ******编辑：**这里是更多解释的[教程](http://www.mkyong.com/android/android-imagebutton-selector-example/)。这是[另一个](http://android-journey.blogspot.com/2009/12/android-selectors.html)****

# spring - Java EE 与独立

> ID：13588236
> 
> 赞同：8
> 
> 时间：2012-11-27T16:06:51.767
> 
> 标签：spring, hibernate, jakarta-ee, jpa, cdi

我正在做一个项目，我们需要构建几个连接到一个数据库的“独立”模块。这些模块主要是后台业务流程，所以前端不多。除了一个显示数据并允许基本 CRUD 功能的 Web 模块。为此，我们计划使用以下技术：

*   JPA2（使用 hibernate-jpa 实现）
*   CDI（使用弹簧实现）
*   JSF2 + primefaces（用于我们的网络模块）

最初的计划是为每个模块创建一个 jar 文件（使用 main 方法）并通过服务包装器将其安装为（Windows）服务。对于我们的 Web 模块，我们将使用 Glassfish 或 JBoss 来运行它。然而，最近我们想到了 Java EE。我们可以在 Glassfish 或 JBoss 等 Java EE 容器中运行我们的所有模块，而不仅仅是我们的 Web 模块。关于我们使用 Java EE 的案例的一些问题：

1.  我们还可以/应该将 CDI 与 spring 一起使用吗？还是我们应该切换到 EJB3？
2.  当我们在容器而不是独立模块中使用 JPA 时，它的后果是什么？有什么区别吗？
3.  由于我们的大多数模块都与 Web 无关，在 Java EE 容器中运行它们是否仍然有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:16:24.163

如果所有模块（批处理 + 实时）都与一个产品相关，那么将它们捆绑在一起是一种好方法。所以这是我的建议

1.  将所有模块捆绑到一个耳朵中。
2.  使用 Java EE 6 并摆脱 spring。CDI 旨在用于 Java EE。对于批处理类型的操作，请尝试利用[异步 EJB](http://javahowto.blogspot.com/2010/03/simple-asynchronous-methods-in-ejb-31.html)或 MDB。

回答您的具体问题

*   我们还可以/应该将 CDI 与 spring 一起使用吗？还是我们应该切换到 EJB3？

CDI 也可以在没有 EJB 的情况下使用。无论如何摆脱春天，因为我没有看到为您的简单项目增加价值。

*   当我们在容器而不是独立模块中使用 JPA 时，它的后果是什么？有什么区别吗？

除了您可以从 JNDI 获取 DataSource 之外，没有任何区别。

*   由于我们的大多数模块都与 Web 无关，在 Java EE 容器中运行它们是否仍然有意义？

是的，只要您没有看到任何性能问题，将单个产品的批处理和实时方面捆绑在一起确实是有意义的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T19:57:43.863

其他人指出了一些优点，因此如果您将后台进程部署到与您的 Web 应用程序相同的 jvm 中，这里有一些缺点。

*   启动和停止运行 web 模块的服务器意味着您启动和停止后台进程，这对您来说可能是也可能不是问题。
*   如果后台进程消耗大量内存或 cpu，那么您将与所有三个应用程序共享堆，这可能会影响您的 Web 应用程序，或者如果 Web 应用程序消耗大量资源，则可能会影响后台进程。
*   Web 应用程序可能需要以可通过 Internet 访问的方式部署，但后台进程可能很乐意在没有任何网络访问权限的情况下运行。那么，如果不需要，为什么要将后台进程公开给互联网。
*   当您升级应用程序服务器、框架或配置时，这意味着要测试三件事，如果后台进程自己运行，您可以在 Web 应用程序的单独发布周期中升级它们。
*   在容器外开发和测试代码更简单。在容器内运行后台进程意味着后台进程的开发环境更加复杂，您必须等待服务器启动，您的启动取决于容器中的资源，然后您必须模拟表单单元测试......等等。

JPA 在容器内部和外部是相同的。唯一的区别是您如何获得 EntityManager，这可以使用 Spring 配置为在容器内外都相同。CDI 应该可以在容器外运行。

主要区别在于您如何与数据库进行事务处理，例如使用 Spring 事务与 ejb 事务。

**更新：** 要从评论中回答您的问题：在 JPA 中，EntityManager 不是线程安全的，因此在 Java EE 服务器中，每个线程的每个持久性单元将有一个实体管理器。实体管理器的创建和关闭由应用服务器为您管理。每个实体管理器中都有一个缓存。可以配置跨越多个实体管理器的二级缓存。在容器外运行时，您必须自己管理 JPA 实体管理器的数量，这取决于后台进程中的线程数和您想要拥有的事务边界。如果您查看一本名为“Pro JPA2”的书，其中有一节讨论了在容器内部或外部运行的细节。

在我的应用程序中，我没有后台进程，但是每个需要实体管理器的类都只需使用它注入它`@PersistenceContext EntityManager em;`，spring 会负责使其在容器内外都能正常工作。Spring 3.1 有一个称为配置文件的特性，它使得在容器外部运行相同的代码而不改变一行代码变得微不足道。我不是 CDI 用户，所以我不知道 CDI 是否具有与 spring 3.1 配置文件功能等效的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:15:31.407

出于以下常见原因，在应用程序服务器而不是独立的 Java 程序中运行是有意义的，例如

1）您可以将 CDI 与 spring 一起使用，因为 EJB3 也基于类似的概念。2) 就 JPA 而言，没有区别，只是如果您以后需要向应用程序添加更多容量，可以通过添加更多运行相同应用程序的机器来添加负载 - 但是，请注意，这是一个非工作量很小，因此做出选择取决于业务需求 3) 应用服务器胜过独立应用程序，因为其内置安全性、可靠性、管理和可扩展性优于独立 Java 应用程序。

# php - 有没有我们没有主键的情况？

> ID：13588238
> 
> 赞同：2
> 
> 时间：2012-11-27T16:06:56.120
> 
> 标签：php, mysql, login

我最近阅读了一篇关于创建安全 php 登录系统的文章，它将逐步指导，现在我想到了为什么在这篇文章中 login_attempts 表中没有主键。我谈到的文章： [这篇文章](http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL#Steps)

```
Create the "login_attempts" table:
CREATE TABLE `secure_login`.`login_attempts` (
  `user_id` int(11) NOT NULL,
  `time` VARCHAR(30) NOT NULL 
) ENGINE=InnoDB 
```

请转到第 4 步

> 创建一个表来存储登录尝试。

那么问题就像标题一样非常清楚。有没有我们没有任何主键的情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:08:35.190

是的，但是您至少需要在列上添加一个*非唯一* `INDEX`的列`User_ID`以提高查询表时的性能。

```
ALTER TABLE login_attempts ADD INDEX idx_userID (User_ID) 
```

*   [何时在 MySQL 中使用索引](http://www.howtoforge.com/when-to-use-indexes-in-mysql-databases)
*   [MySQL 查询优化](http://www.informit.com/articles/article.aspx?p=377652)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:10:36.967

那么主键的重点是提供一些值，您可以在其中索引数据的唯一值以提高性能。在像你这样的情况下，可能没有一列是唯一的。假设您的登录是多线程的，那么虽然很小，但许多用户都有相同`time`的登录机会，将主键放在上面显然会拒绝某人或导致错误。如果您将主键放在上面，`user_id`那么您将拒绝同一用户多次尝试。

在其他情况下，例如在其他两个表之间为外键创建多对多关系，您将执行类似的操作。

*免责声明*我相信有人可以提供更强有力的解释，但这是我的理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:10:53.910

默认情况下不需要主键——这取决于表的每一行是否必须是可识别的，例如，当它在其他表中用作外键时。

在那种特定情况下，我会说`user_id`就足够了 - 但它应该被索引，因为您很可能希望使用该列进行选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:14:56.827

很少有不需要主键的情况。想象一下，如果您想删除特定行，如何删除正确的行？同时两次登录尝试将插入两个相同的行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T16:21:23.407

主键是一种数据库管理工具，它已成为在数据库注册表中保持信息一致性的支柱。但是，只要有一种清晰且安全的机制来保持数据库表中所需信息的一致性，就可以放弃它们。在数据库级别，您可以处理主键。但是在逻辑层面上，你必须有一种机制来帮助你区分不同的注册表，这本身就是主键的实用概念......所以基本上：如果你需要一致的信息，你永远不能处理PKs，在逻辑层面上..

在我目前的工作中，我成为了 GPS 跟踪系统的 dba，我发现所有信息都在 MySQL 中分类。我得到了这个项目“原样”，几乎没有文档，也没有起点，但有很多任务要完成。我的第一个想法是扫描数据库模式。而且我发现所有的表都缺少 PK... 甚至没有接近遵循[Database Normalization Basics](http://databases.about.com/od/specificproducts/a/normalization.htm)。它是一个没有 PK 或 FK 的关系数据库，但它是可操作的，为数千个 GPS 设备提供服务。

当然，该数据库模式极易出现故障，但公司以一种非常原始的方式保持信息适度一致。

所以...我选择重做数据库架构并将所有信息迁移到基于自动增量 PK、约束和完整性触发器的新规范化架构，开发用于处理所有数据库数据的 MVC 应用程序，我非常喜欢挑战：我的第一个专业项目。

作为我个人经验的结论。主键是保持信息一致、真实和有条理的标准指南。您可以随时丢弃它们，但使用它们将为您节省大量完全不必要的设计和实现工作。

# c++ - 使 Google 测试框架输出用户定义的类型

> ID：13588239
> 
> 赞同：1
> 
> 时间：2012-11-27T16:07:00.883
> 
> 标签：c++, unit-testing, namespaces, operator-overloading

我想在提到的测试框架中输出我的类型。 [谷歌明确表示](http://code.google.com/p/googletest/wiki/V1_6_AdvancedGuide#Teaching_Google_Test_How_to_Print_Your_Values)这是可能的。

`As mentioned earlier, the printer is extensible. That means you can teach it to do a better job at printing your particular type than to dump the bytes. To do that, define << for your type:`

```
namespace foo {

class Bar { ... };

// It's important that PrintTo() is defined in the SAME
// namespace that defines Bar.  C++'s look-up rules rely on that.
void PrintTo(const Bar& bar, ::std::ostream* os) {
     *os << bar.DebugString();  // whatever needed to print bar to os
}

}  // namespace foo 
```

我似乎已经这样做了。但是在尝试编译时，我得到以下信息：

```
error: no match for ‘operator<<’ in ‘* os << val’ /usr/include/c++/4.4/ostream:108: note: candidates are: 
```

紧随其后的是一长串提案，`operator<<`最后我的超载：

```
std::ostream& Navmii::ProgrammingTest::operator<<(std::ostream&, Navmii::ProgrammingTest::AsciiString&) 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:36:57.430

您似乎已经`operator<<`为非常量`AsciiString`对象定义了。无论 Google 试图打印什么，都可能是 const。将第二个参数作为 const 引用传递，因为您不应该修改打印的值：

```
std::ostream& Navmii::ProgrammingTest::operator<<(
  std::ostream&,
  Navmii::ProgrammingTest::AsciiString const&); 
```

这与链接文档中的代码更匹配。但是，问题中的引文中省略了该部分。

问题引用了这个`PrintTo`例子。该代码很好，但我认为这并不是您在自己的代码中真正所做的。正如文档所说，`PrintTo`如果您不想提供`operator<<`，或者如果`operator<<`您的类不适合在单元测试期间进行调试输出，则可以使用。

# ruby - 在 Rails 模型中包含 URL 助手是不好的做法吗？

> ID：13588241
> 
> 赞同：1
> 
> 时间：2012-11-27T16:07:04.767
> 
> 标签：ruby, ruby-on-rails-3

项目模型示例

```
 class Project < ActiveRecord::Base
    include ActionView::Helpers
    include Rails.application.routes.url_helpers 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:18:40.200

IMO 是的，这很糟糕。模型不需要关心视图层。

我也从来不需要这个；我很难想出一个用例。

AFAIC 这类似于想要[从模型访问 cookie](https://stackoverflow.com/questions/7884630/how-can-i-access-cookies-from-a-model-in-rails-3/7884660#7884660)，我也认为这是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:11:41.880

这取决于。有时你别无选择，所以你可能不得不求助于它。不过，如果您有用例，我们只能给出正确的答案。

# xml - 更换服务器后 Flash 无法正常工作

> ID：13588243
> 
> 赞同：2
> 
> 时间：2012-11-27T16:07:07.960
> 
> 标签：xml, flash, security

服务器更改后，我收到消息“无法加载 xml”。这可能是 crossdomain.xml 问题吗？

以下错误消息更详细。

> 应用程序中的服务器错误
> 
> Internet Information Services 7.5 错误摘要 HTTP 错误 404.8 - 未找到 请求过滤模块被配置为拒绝 URL 中包含 hiddenSegment 部分的路径。详细错误信息 ModuleRequestFilteringModule NotificationBeginRequest HandlerStaticFile Error Code0x00000000 请求的URLhttp://www.travelpro.com:80/controlpanel/bin/assets/main_navigation.xml 物理路径D:\home\travelpro.com\wwwroot\controlpanel\bin\assets\main_navigation。 xml 登录方法尚未确定登录用户尚未确定最可能的原因：
> 
> ```
> Request filtering is configured for the Web server and it contains a hiddenSegments section that allows the server administrator to deny 
> ```
> 
> 访问特定目录。
> 
> 你可以尝试的事情：
> 
> ```
> Verify configuration/system.webServer/security/requestFiltering/hiddenSegments 
> ```
> 
> applicationhost.config 或 web.config 文件中的设置。
> 
> 链接和更多信息 这是一项安全功能。除非完全了解更改的范围，否则请勿更改此功能。如果应该从被此设置拒绝的特定目录提供内容，请从 configuration/system.webServer/security/requestFiltering/hiddenSegments 中删除被拒绝的目录。

这是我的 crossdomain.xml 文件：

```
 <?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
<site-control permitted-cross-domain-policies="all"/>
<allow-access-from domain="*" secure="false"/>
<allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy> 
```

# c++ - fwrite 处理大量小写的效率

> ID：13588245
> 
> 赞同：9
> 
> 时间：2012-11-27T16:07:12.677
> 
> 标签：c++, unix, fwrite, system-calls

我有一个程序可以保存许多大于 1GB 的大文件`fwrite`，它工作正常，但不幸的是，由于数据的性质，每次调用`fwrite`只写入 1-4 字节。结果写入可能需要一个多小时，其中大部分时间似乎是由于系统调用开销（或至少在 fwrite 的库函数中）。我有类似的问题`fread`。

有谁知道任何现有的/库函数将使用内联函数缓冲这些写入和读取，或者这是你自己的另一个？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-27T16:21:16.067

首先，`fwrite()`是一个库而不是系统调用。其次，它已经缓冲了数据。

您可能想尝试增加缓冲区的大小。这是通过使用[`setvbuf()`](http://pubs.opengroup.org/onlinepubs/009695399/functions/setvbuf.html). 在我的系统上，这只有一点点帮助，但 YMMV。

如果`setvbuf()`没有帮助，您可以自己进行缓冲，并且只有`fwrite()`在积累了足够的数据后才调用。这涉及更多工作，但几乎可以肯定会加快写入速度，因为您自己的缓冲可以变得更加轻量级`fwrite()`。

**编辑：**如果有人告诉你问题在于电话的数量`fwrite()`，请要求查看证据。更好的是，做你自己的性能测试。在我的计算机上，使用 500,000,000 次两字节写入`fwrite()`需要 11 秒。这相当于大约 90MB/s 的吞吐量。

最后但并非最不重要的一点是，我的测试中的 11 秒与您的问题中提到的 1 小时之间的巨大差异暗示您的代码中可能存在其他导致性能非常差的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T16:20:07.523

您的问题不是缓冲`fwrite()`，而是使用少量数据进行库调用的总开销。如果你只写 1MB 的数据，你会进行 250000 次函数调用。您最好尝试在内存中收集数据，然后通过一次调用`fwrite()`.

**更新**：如果您需要证据：

```
$ dd if=/dev/zero of=/dev/null count=50000000 bs=2
50000000+0 records in
50000000+0 records out
100000000 bytes (100 MB) copied, 55.3583 s, 1.8 MB/s
$ dd if=/dev/zero of=/dev/null count=50 bs=2000000
50+0 records in
50+0 records out
100000000 bytes (100 MB) copied, 0.0122651 s, 8.2 GB/s 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T10:04:55.910

好吧，那很有趣。我想我会写一些实际的代码来看看速度是多少。就在这里。使用 C++ DevStudio 2010 Express 编译。这里有相当多的代码。它有 5 种写入数据的方式：-

*   天真地调用 fwrite
*   使用缓冲区并使用更大的缓冲区执行更少的 fwrite 调用
*   天真地使用 Win32 API
*   使用缓冲区并使用更大的缓冲区减少对 Win32 的调用
*   使用 Win32 但双缓冲输出并使用异步写入

请检查我没有对上述任何事情做一些愚蠢的事情。

该程序使用 QueryPerformanceCounter 对代码进行计时，并在文件关闭后结束计时，以尝试包含任何未决的内部缓冲数据。

我的机器上的结果（一个旧的 WinXP SP3 盒子）：-

*   fwrite 本身通常是最快的，尽管如果您获得恰到好处的大小和迭代，缓冲版本有时可以击败它。
*   天真的 Win32 明显慢
*   Buffered Win32 速度翻倍，但还是很容易被 fwrite 打败
*   异步写入并不比缓冲版本好很多。也许有人可以检查我的代码并确保我没有做过愚蠢的事情，因为我以前从未真正使用过异步 IO。

根据您的设置，您可能会得到不同的结果。

随意编辑和改进代码。

```
 #define _CRT_SECURE_NO_WARNINGS

    #include <stdio.h>
    #include <memory.h>
    #include <Windows.h>

    const int
        // how many times fwrite/my_fwrite is called
        c_iterations = 10000000,
        // the size of the buffer used by my_fwrite
        c_buffer_size = 100000;

    char 
        buffer1 [c_buffer_size],
        buffer2 [c_buffer_size],
        *current_buffer = buffer1;

    int
        write_ptr = 0;

    __int64
        write_offset = 0;

    OVERLAPPED
        overlapped = {0};

    // write to a buffer, when buffer full, write the buffer to the file using fwrite
    void my_fwrite (void *ptr, int size, int count, FILE *fp)
    {
        const int
            c = size * count;

        if (write_ptr + c > c_buffer_size)
        {
            fwrite (buffer1, write_ptr, 1, fp);
            write_ptr = 0;
        }

        memcpy (&buffer1 [write_ptr], ptr, c);
        write_ptr += c;
    }

    // write to a buffer, when buffer full, write the buffer to the file using Win32 WriteFile
    void my_fwrite (void *ptr, int size, int count, HANDLE fp)
    {
        const int
            c = size * count;

        if (write_ptr + c > c_buffer_size)
        {
            DWORD
                written;

            WriteFile (fp, buffer1, write_ptr, &written, 0);
            write_ptr = 0;
        }

        memcpy (&buffer1 [write_ptr], ptr, c);
        write_ptr += c;
    }

    // write to a double buffer, when buffer full, write the buffer to the file using 
    // asynchronous WriteFile (waiting for previous write to complete)
    void my_fwrite (void *ptr, int size, int count, HANDLE fp, HANDLE wait)
    {
        const int
            c = size * count;

        if (write_ptr + c > c_buffer_size)
        {
            WaitForSingleObject (wait, INFINITE);

            overlapped.Offset = write_offset & 0xffffffff;
            overlapped.OffsetHigh = write_offset >> 32;
            overlapped.hEvent = wait;

            WriteFile (fp, current_buffer, write_ptr, 0, &overlapped);
            write_offset += write_ptr;
            write_ptr = 0;
            current_buffer = current_buffer == buffer1 ? buffer2 : buffer1;
        }

        memcpy (current_buffer + write_ptr, ptr, c);
        write_ptr += c;
    }

    int main ()
    {
        // do lots of little writes
        FILE
            *f1 = fopen ("f1.bin", "wb");

        LARGE_INTEGER
            f1_start,
            f1_end;

        QueryPerformanceCounter (&f1_start);

        for (int i = 0 ; i < c_iterations ; ++i)
        {
            fwrite (&i, sizeof i, 1, f1);
        }

        fclose (f1);

        QueryPerformanceCounter (&f1_end);

        // do a few big writes
        FILE
            *f2 = fopen ("f2.bin", "wb");

        LARGE_INTEGER
            f2_start,
            f2_end;

        QueryPerformanceCounter (&f2_start);

        for (int i = 0 ; i < c_iterations ; ++i)
        {
            my_fwrite (&i, sizeof i, 1, f2);
        }

        if (write_ptr)
        {
            fwrite (buffer1, write_ptr, 1, f2);
            write_ptr = 0;
        }

        fclose (f2);

        QueryPerformanceCounter (&f2_end);

        // use Win32 API, without buffer
        HANDLE
            f3 = CreateFile (TEXT ("f3.bin"), GENERIC_WRITE, 0, 0, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0);

        LARGE_INTEGER
            f3_start,
            f3_end;

        QueryPerformanceCounter (&f3_start);

        for (int i = 0 ; i < c_iterations ; ++i)
        {
            DWORD
                written;

            WriteFile (f3, &i, sizeof i, &written, 0);
        }

        CloseHandle (f3);

        QueryPerformanceCounter (&f3_end);

        // use Win32 API, with buffer
        HANDLE
            f4 = CreateFile (TEXT ("f4.bin"), GENERIC_WRITE, 0, 0, CREATE_ALWAYS, FILE_FLAG_WRITE_THROUGH, 0);

        LARGE_INTEGER
            f4_start,
            f4_end;

        QueryPerformanceCounter (&f4_start);

        for (int i = 0 ; i < c_iterations ; ++i)
        {
            my_fwrite (&i, sizeof i, 1, f4);
        }

        if (write_ptr)
        {
            DWORD
                written;

            WriteFile (f4, buffer1, write_ptr, &written, 0);
            write_ptr = 0;
        }

        CloseHandle (f4);

        QueryPerformanceCounter (&f4_end);

        // use Win32 API, with double buffering
        HANDLE
            f5 = CreateFile (TEXT ("f5.bin"), GENERIC_WRITE, 0, 0, CREATE_ALWAYS, FILE_FLAG_OVERLAPPED | FILE_FLAG_WRITE_THROUGH, 0),
            wait = CreateEvent (0, false, true, 0);

        LARGE_INTEGER
            f5_start,
            f5_end;

        QueryPerformanceCounter (&f5_start);

        for (int i = 0 ; i < c_iterations ; ++i)
        {
            my_fwrite (&i, sizeof i, 1, f5, wait);
        }

        if (write_ptr)
        {
            WaitForSingleObject (wait, INFINITE);

            overlapped.Offset = write_offset & 0xffffffff;
            overlapped.OffsetHigh = write_offset >> 32;
            overlapped.hEvent = wait;

            WriteFile (f5, current_buffer, write_ptr, 0, &overlapped);
            WaitForSingleObject (wait, INFINITE);
            write_ptr = 0;
        }

        CloseHandle (f5);

        QueryPerformanceCounter (&f5_end);

        CloseHandle (wait);

        LARGE_INTEGER
            freq;

        QueryPerformanceFrequency (&freq);

        printf ("  fwrites without buffering = %dms\n", (1000 * (f1_end.QuadPart - f1_start.QuadPart)) / freq.QuadPart);
        printf ("     fwrites with buffering = %dms\n", (1000 * (f2_end.QuadPart - f2_start.QuadPart)) / freq.QuadPart);
        printf ("    Win32 without buffering = %dms\n", (1000 * (f3_end.QuadPart - f3_start.QuadPart)) / freq.QuadPart);
        printf ("       Win32 with buffering = %dms\n", (1000 * (f4_end.QuadPart - f4_start.QuadPart)) / freq.QuadPart);
        printf ("Win32 with double buffering = %dms\n", (1000 * (f5_end.QuadPart - f5_start.QuadPart)) / freq.QuadPart);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T22:50:07.100

首先最重要的是：小的 fwrites()**比较**慢，因为每个 fwrite 都必须测试其参数的有效性，执行与flockfile() 等效的操作，可能是 fflush()，追加数据，返回成功：这个开销加起来——不是就像对 write(2) 的微小调用一样，但它仍然很明显。

证明：

```
#include <stdio.h>
#include <stdlib.h>

static void w(const void *buf, size_t nbytes)
{
    size_t n;
    if(!nbytes)
        return;
    n = fwrite(buf, 1, nbytes, stdout);
    if(n >= nbytes)
        return;
    if(!n) {
        perror("stdout");
        exit(111);
    }
    w(buf+n, nbytes-n);
}

/* Usage: time $0 <$bigfile >/dev/null */
int main(int argc, char *argv[])
{
    char buf[32*1024];
    size_t sz;

    sz = atoi(argv[1]);
    if(sz > sizeof(buf))
        return 111;
    if(sz == 0)
        sz = sizeof(buf);
    for(;;) {
        size_t r = fread(buf, 1, sz, stdin);
        if(r < 1)
            break;
        w(buf, r);
    }
    return 0;
} 
```

话虽如此，您可以执行许多评论者建议的操作，即在 fwrite 之前添加您自己的缓冲：这是非常简单的代码，但您应该测试它是否真的给您带来任何好处。

如果你不想自己动手，你可以使用例如[skalibs](http://www.skarnet.org/software/skalibs/)中的缓冲区接口，但你可能需要更长的时间来阅读文档而不是自己编写它（恕我直言）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T16:59:31.930

stdio 中 FILE * 层的意义在于它为您进行缓冲。这使您免于系统调用开销。正如其他人所指出的，可能仍然存在问题的一件事是库调用开销，它要小得多。另一件可能会让您感到困扰的事情是同时写入磁盘上的许多不同位置。（磁盘旋转，磁头需要 8 毫秒才能到达正确的位置进行随机写入。）

如果您确定库调用开销是问题所在，我建议您使用向量滚动您自己的微不足道的缓冲，并定期将向量刷新到文件中。

如果问题是您有大量写入分散在整个磁盘上，请尝试使用 setvbuf() 增加缓冲区大小。如果可以，请尝试每个文件 4MB 左右的数字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-23T00:53:39.117

这是一个测试，`nim`显示`fwrite`引入了函数调用开销，并且您端的批处理减少了时钟时间。

随着`batchPow`从 0 增加到 10，时钟时间从 36 秒减少到 4 秒 `nim r -d:case1 -d:danger --gc:arc main.nim | wc -l` 36 秒

`nim r -d:case2 -d:danger --gc:arc -d:batchPow:10 main.nim | wc -l` 4 秒

如您所见，即使 LTO 也无助于 fwrite 的函数调用开销`-d:case1 --passc:-flto --passl:-flto`

```
var buf: string
let n = 1000_000_000
for i in 0..<n:
  let c = cast[char](i)
  when defined case1: # 36 seconds
    stdout.write c
  when defined case2: # 4 seconds
    const batchPow {.intdefine.} = 10
    buf.add c
    if ((i and (2 shl batchPow - 1)) == 0) or (i == n-1):
      stdout.write buf
      buf.setLen 0 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-27T16:30:29.717

滚动自己的缓冲区应该很容易。但幸运的是，标准 C++ 有你所要求的。只需使用 std::ofstream ：

```
//open and init
char mybuffer [1024];
std::ofstream filestr("yourfile");
filestr.rdbuf()->pubsetbuf(mybuffer,1024);
// write your data
filestr.write(data,datasize); 
```

**已编辑：**错误，使用 ofstream 而不是 fstream，因为从标准女巫缓冲区中不清楚是它（输入还是输出？）

# actionscript-3 - 在 as3 中，你如何让一条鱼以正确的方式面对

> ID：13588246
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:07:15.857
> 
> 标签：actionscript-3

不使用旋转并添加不同的框架。有没有办法让鱼脸以正确的方式？这是因为我有一个动画，有时只是重新创建每个帧以面对正确的帧会很麻烦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:10:06.823

```
fish.scaleX=-1; 
```

瞧，你的鱼现在面向 X 方向的另一侧。如果它改为向下游，则`scaleY`切换到 -1。

# mysql - Symfony2：实体问题

> ID：13588255
> 
> 赞同：0
> 
> 时间：2012-11-27T16:07:56.027
> 
> 标签：mysql, symfony, doctrine-orm, entity

我有两个实体`template`，`div`它们的代码如下：（我通过控制台自动生成）

```
 <?php

namespace Tun\PublicBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Tun\PublicBundle\Entity\Template
 *
 * @ORM\Table(name="template")
 * @ORM\Entity
 */
class Template
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $name
     *
     * @ORM\Column(name="name", type="string", length=255, nullable=true)
     */
    private $name;

    /**
     * @var integer $nbreDiv
     *
     * @ORM\Column(name="nbre_div", type="integer", nullable=false)
     */
    private $nbreDiv;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     */
    public function setName($name)
    {
        $this->name = $name;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set nbreDiv
     *
     * @param integer $nbreDiv
     */
    public function setNbreDiv($nbreDiv)
    {
        $this->nbreDiv = $nbreDiv;
    }

    /**
     * Get nbreDiv
     *
     * @return integer 
     */
    public function getNbreDiv()
    {
        return $this->nbreDiv;
    }
} 
```

分区：

```
<?php

namespace Tun\PublicBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Tun\PublicBundle\Entity\Div
 *
 * @ORM\Table(name="div")
 * @ORM\Entity
 */
class Div
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var integer $hauteur
     *
     * @ORM\Column(name="hauteur", type="integer", nullable=false)
     */
    private $hauteur;

    /**
     * @var integer $largeur
     *
     * @ORM\Column(name="largeur", type="integer", nullable=false)
     */
    private $largeur;

    /**
     * @var integer $ind
     *
     * @ORM\Column(name="ind", type="integer", nullable=true)
     */
    private $ind;

    /**
     * @var string $emplacement
     *
     * @ORM\Column(name="emplacement", type="string", length=255, nullable=false)
     */
    private $emplacement;

    /**
     * @var Template
     *
     * @ORM\ManyToOne(targetEntity="Template")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="template", referencedColumnName="id")
     * })
     */
    private $template;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set hauteur
     *
     * @param integer $hauteur
     */
    public function setHauteur($hauteur)
    {
        $this->hauteur = $hauteur;
    }

    /**
     * Get hauteur
     *
     * @return integer 
     */
    public function getHauteur()
    {
        return $this->hauteur;
    }

    /**
     * Set largeur
     *
     * @param integer $largeur
     */
    public function setLargeur($largeur)
    {
        $this->largeur = $largeur;
    }

    /**
     * Get ind
     *
     * @return integer 
     */
    public function getInd()
    {
        return $this->ind;
    }

    /**
     * Set ind
     *
     * @param integer $ind
     */
    public function setInd($ind)
    {
        $this->ind = $ind;
    }

    /**
     * Get largeur
     *
     * @return integer 
     */
    public function getLargeur()
    {
        return $this->largeur;
    }

    /**
     * Set emplacement
     *
     * @param string $emplacement
     */
    public function setEmplacement($emplacement)
    {
        $this->emplacement = $emplacement;
    }

    /**
     * Get emplacement
     *
     * @return string 
     */
    public function getEmplacement()
    {
        return $this->emplacement;
    }

    /**
     * Set template
     *
     * @param Tun\PublicBundle\Entity\Template $template
     */
    public function setTemplate(\Tun\PublicBundle\Entity\Template $template)
    {
        $this->template = $template;
    }

    /**
     * Get template
     *
     * @return Tun\PublicBundle\Entity\Template 
     */
    public function getTemplate()
    {
        return $this->template;
    }
} 
```

现在这是问题所在，我希望创建一个模板然后是一个 div，所以我这样做了：

```
$template= new Template();
$template->setName($name);
$template->setNbreDiv($nbre_div);
$em = $this->getDoctrine()->getEntityManager();
$em->persist($template);
$em->flush();

$d=new Div();
$d->setHauteur(100);
$d->setLargeur(100);
$d->setEmplacement("Gauche");
$d->setInd(1);
$d->setTemplate($template);
$em = $this->getDoctrine()->getEntityManager();
$em->persist($d);
$em->flush(); 
```

我收到以下错误：

```
SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'div (hauteur, largeur, ind, emplacement, template) VALUES (100, 100, 1, 'Gauche'' at line 1 
```

希望我把所有东西都放了，提前感谢您的帮助。我花了一整天的时间尝试我想到的所有组合......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:17:59.130

`DIV`是 MySQL 中的保留关键字。它是一个运算符，用于整数除法。例子：

```
mysql> SELECT 35 DIV 7;
+----------+
| 35 DIV 7 |
+----------+
|        5 |
+----------+
1 row in set (0.02 sec) 
```

我的建议是重命名这个实体。

参考：[MySQL 算术运算符](http://dev.mysql.com/doc/refman/5.0/en/arithmetic-functions.html#operator_div)

# cakephp - Cake PHP 注册表单

> ID：13588261
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:08:14.473
> 
> 标签：cakephp, cakephp-model, php

> **可能重复：**
> [调用非对象上的成员函数](https://stackoverflow.com/questions/54566/call-to-a-member-function-on-a-non-object)

我刚刚开始学习 cake php，并试图创建一个由一个字段组成的非常简单的注册表单。但是，我无法与我的模型交互。下面的代码：

这是我的注册控制器：

```
class RegisterController extends AppController{

    public $helpers = array('Form', 'Html', 'Js');

    public function index(){

    }

} 
```

这是我的注册控制器 index.ctp 视图：

```
echo $this->Form->create('Users', array('controller' => 'Users', 'action' => 'createUser'));
echo $this->Form->input('username');
echo $this->Form->end('Register'); 
```

然后我创建了一个 UsersController.php 文件和一个 Users.php（模型）文件来处理表单数据的验证和保存。

用户控制器.php：

```
class UsersController extends AppController{

    public function createUser(){

        $this->Users->create();

        $this->Users->save($this->Request->data);

    }

} 
```

和 Users.php 模型文件：

```
class Users extends AppModel {

    public $validation = array(

        'username' => array(

            'rule1' => array(
                'rule' => 'isUnique',
                'message' => 'That username is already taken'
                ),
            'rule2' => array(

                'rule' => 'nonEmpty',
                'message' => 'This field cannot be empty',
                'required' => true

            )
        )
    );

} 
```

但是，每当我点击表单上的“注册”按钮时，都会出现以下错误：

```
Call to a member function create() on a non-object 
```

它指的是我的 UsersController.php 文件中的以下行：

```
$this->Users->create(); 
```

我在我的蛋糕数据库中创建了一个用户表，php 文件可以看到它。我不明白为什么我的 UsersController.php 文件无法写入其模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:25:04.547

您必须遵循 CakePHP 的编码标准。在这种情况下，“用户”类将不起作用。您必须使用“用户”类并重构代码以查找用户。

# asp.net-mvc - MVC4 和 IIS 基本身份验证

> ID：13588262
> 
> 赞同：3
> 
> 时间：2012-11-27T16:08:15.033
> 
> 标签：asp.net-mvc, iis, asp-classic, basic-authentication

我有一个使用基本身份验证的传统经典 asp 应用程序。我将缓慢地将应用程序的某些部分迁移到 MVC4，并希望在它们完成后将它们“放入”——这可能需要很长时间并且可能永远不会完全完成。这意味着我正在与经典的 asp 应用程序“共享”该文件夹。目前，经典的 asp 应用程序在 IIS6 中关闭了匿名访问。

如果我在 IIS6 中启用基本身份验证并禁用 MVC4 应用程序的匿名访问，我有什么办法可以将某些控制器操作公开给匿名、未经身份验证的请求？我无法在 IIS 中的应用程序级别打开匿名访问，因为这会将 classis ASP 页面暴露给未经身份验证的访问。

理想情况下，我希望能够使用 [AllowAnonymous()] 属性标记操作方法。

我在 IIS 中**关闭了匿名访问**并**启用了基本身份验证**，但是一旦我尝试访问资源（甚至是标记为 AllowAnonymous 的控制器操作），我就会看到凭据对话框。我假设是这种情况，因为 IIS 无法满足请求？任何帮助或想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T06:17:58.437

我建议您将这些旧应用程序和新应用程序分开，以便每个应用程序都有自己的身份验证设置并修复您的应用程序的内部链接。在这种情况下，遗留身份验证可能启用了基本身份验证，尽管 mvc 项目将允许匿名操作。

# clearcase-ucm - 从动态视图复制时出现 Robocopy 错误

> ID：13588263
> 
> 赞同：1
> 
> 时间：2012-11-27T16:08:14.753
> 
> 标签：clearcase-ucm, robocopy, snapshot-view

在过去的几个月里，我有一个问题一直困扰着我。我使用 UCM Clearcase 的动态视图将最新的源代码复制到本地磁盘。然后我编译源代码并生成 Installshield 包等。我使用 Robobopy 来复制文件。

Robocopy 无法复制并挂起。这种情况每周发生 2-3 次。因此，它已成为 Nightly Build 工作流程的噩梦。幸运的是，昨天，我看到 Robocopy 显示了一个错误。它是这样的：

> ERROR 64: 指定的网络名称不再存在

我谷歌了一下，发现这可能是由于：

> 1) 防病毒
> 
> 2）网络硬件配置不当

另一件重要的事情是，在与 Clearcase 或其他软件相关的任何其他操作期间，我没有看到任何网络问题。

在 VonC 的建议下，我一直在推动使用快照视图进行编译的想法，但管理层似乎不太情愿，因为：

> 1) 其他团队也有相同的设置，他们从动态视图复制
> 
> 2) 他们面临不到 5% 的复制失败
> 
> 3) 根据其他团队的说法，从动态视图复制似乎是最佳实践，我被要求遵循它。

我想知道是否有人遇到过这样的问题。

我想要一些可以帮助我说服管理层转向快照视图进行编译的要点。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:27:23.340

> 我使用 UCM Clearcase 的动态视图将最新的源代码复制到本地磁盘。

一种更简单的方法是使用*快照*UCM 视图（即使其他团队正在使用动态视图），您`cleartool update`每次在本地需要这些文件时都会使用该视图。

该快照视图的配置规范将与动态视图完全相同，您可以调整加载规则以仅加载您需要的内容。
这并不妨碍使用 Robocopy 并将这些文件复制到正确的位置。

这个想法是避免任何挂起问题，甚至避免那些 5% 的复制失败。
动态视图适用于小型咨询目的，或用于配置更新（rebase）或合并（交付），但不适用于大量读取操作。

# xml - 如何访问wordpress的RSS XML

> ID：13588264
> 
> 赞同：0
> 
> 时间：2012-11-27T16:08:17.013
> 
> 标签：xml, wordpress, rss

我必须从 Wordpress 的 RSS 提要中解析和获取数据。将XML提取到Android中没有问题，但是当我没有登录网站时，没有显示RSS的XML格式，我无法解析它。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T09:02:42.180

我通过清除浏览器的缓存及其工作来解决它:)

# c# - JQPlot - 未捕获的异常：未指定绘图目标

> ID：13588269
> 
> 赞同：1
> 
> 时间：2012-11-27T16:08:32.177
> 
> 标签：c#, jquery, asp.net-mvc, jqplot

我正在尝试将 jqplot 与 mvc4 一起使用。'我试图在控制器中获取绘图数据，如下所示：

控制器.cs

```
 public ActionResult DrawChart(FormCollection fc)
        {
            if (fc["start"] != null && (fc["end"] != null))
            {
                string start = fc.GetValue("start").AttemptedValue;
                string end = fc.GetValue("end").AttemptedValue;
                string connstring = "Data Source=DB.world;User ID=USER;Password=mypass;";
                using (OracleConnection conn = new OracleConnection(connstring))
                {
                    conn.Open();
                    string sql = "select to_char(dpr_ts, 'DD.MM.YYYY'), dpr_close from dpr@price where dpr_qot_id=2029543939 and dpr_ts>='" + start + "' and  dpr_ts<='" + end + "'";
                        //"select dpr_close, dpr_ts from dpr@price where dpr_qot_id=2029543939";// and dpr_ts>='01.08.2012' and  dpr_ts<='15.11.2012'";
                    using (OracleCommand comm = new OracleCommand(sql, conn))
                    {
                        using (OracleDataReader rdr = comm.ExecuteReader())
                        {

                            var arr1 = new object[1];
                            var arr2 = new object[rdr.RowSize];
                            var ctr = 0;

                            while (rdr.Read())
                            {

                                arr2[ctr++] = new object[] {  rdr.GetOracleString(0).Value, rdr.GetOracleDecimal(1).Value,};
                                arr1[0] = arr2;

                            }
                            var json = new JavaScriptSerializer().Serialize(arr1);
                            //Json(arr1);
                                ViewBag.ChartData = json;
                            Console.WriteLine(ViewBag.ChartData);
                        }
                    }

                    conn.Dispose();
                    conn.Close();
                }
            }
            return RedirectToAction("Index");
        } 
```

这里有一些 Index.cshtml 的代码

```
<script lang="javascript" type="text/javascript">
    $(document).ready(function () {

        var chartData = $.parseJSON("@ViewBag.ChartData");
        var chartData = eval("@ViewBag.ChartData");
        var line1 = eval("@ViewBag.ChartData");
        var plot1 = $.jqplot('chart1', line1, {
            title: 'Default Date Axis',
            axes: { xaxis: { renderer: $.jqplot.DateAxisRenderer } },
            series: [{ lineWidth: 4, markerOptions: { style: 'square' } }]
        });
    });
</script> 
```

当我调试控制器时，我得到这个示例输出`var json`：

`[[[\"03.09.2012\",3.1790],[\"04.09.2012\",3.16],[\"05.09.2012\",3.17],[\"06.09.2012\",3.25],[\"07.09.2012\",3.2610],[\"10.09.2012\",3.2010],[\"11.09.2012\",3.1620],[\"12.09.2012\",3.22],[\"13.09.2012\",3.2190],[\"14.09.2012\",3.26],[\"17.09.2012\",3.2790],[\"18.09.2012\",3.2490],[\"19.09.2012\",3.2620],[\"20.09.2012\",3.2610],[\"21.09.2012\",3.2610],[\"24.09.2012\",3.2410],[\"25.09.2012\",3.25],[\"26.09.2012\",3.22],[\"27.09.2012\",3.1840],[\"28.09.2012\",3.2290],[\"01.10.2012\",3.25],[\"02.10.2012\",3.27],[\"03.10.2012\",3.2310],[\"04.10.2012\",3.2580],[\"05.10.2012\",3.32],[\"08.10.2012\",3.30],[\"09.10.2012\",3.28],[\"10.10.2012\",3.25],[\"11.10.2012\",3.2790],[\"12.10.2012\",3.2490],[\"15.10.2012\",3.24],[\"16.10.2012\",3.2750],[\"17.10.2012\",3.36],[\"18.10.2012\",3.3610],[\"19.10.2012\",3.3990],[\"22.10.2012\",3.37],[\"23.10.2012\",3.32],[\"24.10.2012\",3.3290],[\"25.10.2012\",3.3310],[\"26.10.2012\",3.3720],[\"29.10.2012\",3.3810],[\"30.10.2012\",3.3690],[\"31.10.2012\",3.4290],[\"01.11.2012\",3.45],[\"20.11.2012\",3.21],[\"21.11.2012\",3.29],[\"22.11.2012\",3.31],[\"23.11.2012\",3.35],[\"26.11.2012\",3.36],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]`

VS Debugger 不会在 Index.cshtml 中停止`var line1 = eval("@ViewBag.ChartData");`。在使用 firebug 调试 Javascript 时，我得到`line1` 了`undefined`.

我究竟做错了什么？我希望，这`ViewBag.ChartData = json;`将导致，`line1`它将充满来自`json`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:12:52.193

问题是这一行：

```
return RedirectToAction("Index"); 
```

这样你就失去了 Viewbag 的内容..

如果你想使用 ViewBag，你应该创建一个视图`DrawChart`并放置：

```
return View(); 
```

# php - HTML ajax 响应未执行 javascript 函数

> ID：13588272
> 
> 赞同：1
> 
> 时间：2012-11-27T16:08:41.493
> 
> 标签：php, javascript, ajax, jquery

我在使用 jQuery 时遇到问题，因为当我从 ajax 调用接收到 html 响应并将其添加到 div 时，接收到的 html 中的 div 不会从我的外部 javascript 文件中调用另一个函数。

在我的 index.php 页面中，我引用了一个外部 javascript 文件：

```
<script src="functions/functions.js" type="text/javascript"></script> 
```

上面的脚本包含以下内容：

```
jQuery(document).ready(function()
{
    $(".active").on('click', function()
    {
        jQuery.get('../ajax/file.php', function(data) {
        jQuery('#container').prepend(data);
        });
    })

    jQuery("#mydiv").on('click', function(event)
    {
        alert('clicked');
    });
}); 
```

当单击具有“活动”类的 div 时，将调用 file.php - 它所做的只是输出 id 为“mydiv”的 div

```
<div id="mydiv"></div> 
```

现在，当我单击“mydiv”div 时，它不会从 functions.js 文件中调用该函数。我已经将上面的 div 直接移到了 ajax 调用之外的 index.php 文件中，该文件可以很好地执行该函数，但正如我所说，如果它是通过 ajax 调用生成并附加的，它就不会工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T16:11:44.060

使用 #mydiv 过滤器绑定文档上的单击事件，以便当包含 id 为 mydiv 的元素的 html 时动态附加事件。

```
jQuery(document).on('click', "#mydiv", function(event)
{
    alert('clicked');
}); 
```

或者，如果响应添加到“#container”，那么您可以将事件绑定到“#container”，

```
jQuery('#container').on('click', "#mydiv", function(event)
{
    alert('clicked');
}); 
```

# facebook - html5 facebook 和特殊字符

> ID：13588278
> 
> 赞同：0
> 
> 时间：2012-11-27T16:08:50.493
> 
> 标签：facebook, html, addthis

我正在使用 addthis 并包括 facebook 共享按钮。我目前使用 html5，当我 `xmlns:fb="http://ogp.me/ns/fb#"`在我的 html 标记中包含：时，这会导致特殊字符（例如 ' 左撇号）显示为三个问号。

我知道用实体替换它可以解决这个问题，但数据是由用户通过 cms 中的文本框输入的。删除 xmlns 项目可以解决此问题。该页面以 utf8 编码。

```
<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" xmlns:fb="http://ogp.me/ns/fb#" > <!--<![endif]--> 
<head>
 <meta charset="utf-8"> 
```

有没有人有什么建议？

谢谢，巴特

# python - python用内部类动态创建类

> ID：13588279
> 
> 赞同：10
> 
> 时间：2012-11-27T16:08:52.360
> 
> 标签：python, class, metaprogramming, tastypie, metaclass

我正在使用 django-tastypie，我需要从我的 django 模型中创建这样的类：

```
class MyModelResource(ModelResource):
    class Meta:
        queryset = MyModel.objects.all()
        allowed_methods = ['get'] 
```

由于我的 django 应用程序中有很多模型，我不想重复自己，而是使用 type() 函数来创建所有资源类。问题是我不知道如何处理这个内部的“元”类。

你能给我一个例子，说明如何使用 type() 动态创建一个带有内部类的类吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-27T16:12:11.037

```
class MyModel(object) : pass
modelClass = MyModel()

class ModelResource(object):
    def mymethod(self):
        print('got here')

Meta = type('Meta', (object, ), {'allowed_methods': ['get']})

def add_mymethod(cls):
    def mymethod(self):
        super(cls, self).mymethod()
    cls.mymethod = mymethod
    return cls

name = modelClass.__class__.__name__ + "Resource"
MyModelResource = add_mymethod(type(name, (ModelResource, ),
                                    {'Meta':Meta, }))

print(MyModelResource.Meta)
# <class '__main__.Meta'>

m = MyModelResource()
m.mymethod()
# got here 
```

就其而言，内部类`Meta`只是另一个属性`MyModelResource`。

* * *

就所关心的而言，方法也只是属性`MyModelResource`。实际上，您在 中定义了一个函数*，*`MyModelResource.__dict__`而 Python 属性查找机制会导致`inst.mymethod`返回一个绑定*方法*。

调用`MyModelResource`中提到没有问题`super`

```
super(MyModelResource, self).mymethod() 
```

before`MyModelResource`已定义，因为名称查找是在运行时执行的，而不是在`mymethod`定义时执行的。

* * *

你是绝对正确的

```
super(self.__class_, self).mymethod() 
```

是错的。这将破坏一切美好的事物`super`。如果`MyModelResource`要被子类化，并且要调用子类的一个实例`mymethod`，那么 Python 将陷入无限循环。

# ios - 如何居中对齐 UICollectionView 的单元格？

> ID：13588283
> 
> 赞同：106
> 
> 时间：2012-11-27T16:08:58.420
> 
> 标签：ios, uicollectionview

我目前正在使用`UICollectionView`用户界面网格，它工作正常。但是，我想启用水平滚动。网格支持每页 8 个项目，当项目总数为 4 时，这就是启用水平滚动方向的项目应如何排列：

```
0 0 x x
0 0 x x 
```

这里 0 -> 集合项和 x -> 空单元格

有没有办法让它们居中对齐，如：

```
x 0 0 x
x 0 0 x 
```

让内容看起来更干净？

此外，以下安排也可能是我期待的解决方案。

```
0 0 0 0
x x x x 
```

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2016-07-07T20:06:15.527

对于那些寻找中心对齐、**动态宽度的**collectionview单元格的解决方案的人来说，我最终修改了Angel对[左对齐版本](https://stackoverflow.com/a/36016798/2845237)的答案，以创建一个中心对齐的子类`UICollectionViewFlowLayout`。

# CenterAlignedCollectionViewFlowLayout

```
// NOTE: Doesn't work for horizontal layout!
class CenterAlignedCollectionViewFlowLayout: UICollectionViewFlowLayout {

    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
        guard let superAttributes = super.layoutAttributesForElements(in: rect) else { return nil }
        // Copy each item to prevent "UICollectionViewFlowLayout has cached frame mismatch" warning
        guard let attributes = NSArray(array: superAttributes, copyItems: true) as? [UICollectionViewLayoutAttributes] else { return nil }

        // Constants
        let leftPadding: CGFloat = 8
        let interItemSpacing = minimumInteritemSpacing

        // Tracking values
        var leftMargin: CGFloat = leftPadding // Modified to determine origin.x for each item
        var maxY: CGFloat = -1.0 // Modified to determine origin.y for each item
        var rowSizes: [[CGFloat]] = [] // Tracks the starting and ending x-values for the first and last item in the row
        var currentRow: Int = 0 // Tracks the current row
        attributes.forEach { layoutAttribute in

            // Each layoutAttribute represents its own item
            if layoutAttribute.frame.origin.y >= maxY {

                // This layoutAttribute represents the left-most item in the row
                leftMargin = leftPadding

                // Register its origin.x in rowSizes for use later
                if rowSizes.count == 0 {
                    // Add to first row
                    rowSizes = [[leftMargin, 0]]
                } else {
                    // Append a new row
                    rowSizes.append([leftMargin, 0])
                    currentRow += 1
                }
            }

            layoutAttribute.frame.origin.x = leftMargin

            leftMargin += layoutAttribute.frame.width + interItemSpacing
            maxY = max(layoutAttribute.frame.maxY, maxY)

            // Add right-most x value for last item in the row
            rowSizes[currentRow][1] = leftMargin - interItemSpacing
        }

        // At this point, all cells are left aligned
        // Reset tracking values and add extra left padding to center align entire row
        leftMargin = leftPadding
        maxY = -1.0
        currentRow = 0
        attributes.forEach { layoutAttribute in

            // Each layoutAttribute is its own item
            if layoutAttribute.frame.origin.y >= maxY {

                // This layoutAttribute represents the left-most item in the row
                leftMargin = leftPadding

                // Need to bump it up by an appended margin
                let rowWidth = rowSizes[currentRow][1] - rowSizes[currentRow][0] // last.x - first.x
                let appendedMargin = (collectionView!.frame.width - leftPadding  - rowWidth - leftPadding) / 2
                leftMargin += appendedMargin

                currentRow += 1
            }

            layoutAttribute.frame.origin.x = leftMargin

            leftMargin += layoutAttribute.frame.width + interItemSpacing
            maxY = max(layoutAttribute.frame.maxY, maxY)
        }

        return attributes
    }
} 
```

[![CenterAlignedCollectionViewFlowLayout](../Images/206c145fc83a3be2fdcb9c521455af7c.png)](https://i.stack.imgur.com/CyOS7.png)

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2012-11-27T16:21:50.630

我认为你可以通过实现这样的东西来实现单线外观：

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section {
    return UIEdgeInsetsMake(0, 100, 0, 0);
} 
```

您将不得不使用该数字来弄清楚如何将内容强制为一行。第一个 0 是 top edge 参数，如果你想在屏幕上垂直居中，你也可以调整那个。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2014-10-07T20:09:57.587

这里的顶级解决方案对我来说是开箱即用的，所以我想出了这个方法，它应该适用于任何具有流布局且只有一个部分的水平滚动集合视图：

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout *)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
    {
    // Add inset to the collection view if there are not enough cells to fill the width.
    CGFloat cellSpacing = ((UICollectionViewFlowLayout *) collectionViewLayout).minimumLineSpacing;
    CGFloat cellWidth = ((UICollectionViewFlowLayout *) collectionViewLayout).itemSize.width;
    NSInteger cellCount = [collectionView numberOfItemsInSection:section];
    CGFloat inset = (collectionView.bounds.size.width - (cellCount * cellWidth) - ((cellCount - 1)*cellSpacing)) * 0.5;
    inset = MAX(inset, 0.0);
    return UIEdgeInsetsMake(0.0, inset, 0.0, 0.0);
    } 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2014-02-09T13:33:10.967

动态计算插入很容易，此代码将始终使您的单元格居中：

```
NSInteger const SMEPGiPadViewControllerCellWidth = 332;

...

- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
{

    NSInteger numberOfCells = self.view.frame.size.width / SMEPGiPadViewControllerCellWidth;
    NSInteger edgeInsets = (self.view.frame.size.width - (numberOfCells * SMEPGiPadViewControllerCellWidth)) / (numberOfCells + 1);

    return UIEdgeInsetsMake(0, edgeInsets, 0, edgeInsets);
}

- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    [super willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration];
    [self.collectionView.collectionViewLayout invalidateLayout];
} 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2015-05-07T14:56:58.550

与其他答案类似，这是一个动态答案，应该适用于静态大小的单元格。我做的一个修改是我把填充放在两边。如果我不这样做，我就会遇到问题。

* * *

### Objective-C

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewFlowLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section {

    NSInteger numberOfItems = [collectionView numberOfItemsInSection:section];
    CGFloat combinedItemWidth = (numberOfItems * collectionViewLayout.itemSize.width) + ((numberOfItems - 1) * collectionViewLayout.minimumInteritemSpacing);
    CGFloat padding = (collectionView.frame.size.width - combinedItemWidth) / 2;

    return UIEdgeInsetsMake(0, padding, 0, padding);
} 
```

### 迅速

```
func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets {
    let flowLayout = collectionViewLayout as! UICollectionViewFlowLayout
    let numberOfItems = CGFloat(collectionView.numberOfItems(inSection: section))
    let combinedItemWidth = (numberOfItems * flowLayout.itemSize.width) + ((numberOfItems - 1)  * flowLayout.minimumInteritemSpacing)
    let padding = (collectionView.frame.width - combinedItemWidth) / 2
    return UIEdgeInsets(top: 0, left: padding, bottom: 0, right: padding)
} 
```

* * *

此外，如果您仍然遇到问题，请确保将`minimumInteritemSpacing`和设置`minimumLineSpacing`为相同的值，因为这些值似乎是相互关联的。

```
UICollectionViewFlowLayout *flowLayout = (UICollectionViewFlowLayout *)self.collectionView.collectionViewLayout;
flowLayout.minimumInteritemSpacing = 20.0;
flowLayout.minimumLineSpacing = 20.0; 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2014-12-26T11:15:35.513

将其放入您的集合视图委托中。它比其他答案考虑了更多的基本流程布局设置，因此更通用。

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
{
    NSInteger cellCount = [collectionView.dataSource collectionView:collectionView numberOfItemsInSection:section];
    if( cellCount >0 )
    {
        CGFloat cellWidth = ((UICollectionViewFlowLayout*)collectionViewLayout).itemSize.width+((UICollectionViewFlowLayout*)collectionViewLayout).minimumInteritemSpacing;
        CGFloat totalCellWidth = cellWidth*cellCount + spacing*(cellCount-1);
        CGFloat contentWidth = collectionView.frame.size.width-collectionView.contentInset.left-collectionView.contentInset.right;
        if( totalCellWidth<contentWidth )
        {
            CGFloat padding = (contentWidth - totalCellWidth) / 2.0;
            return UIEdgeInsetsMake(0, padding, 0, padding);
        }
    }
    return UIEdgeInsetsZero;
} 
```

快速版本（感谢 g0ld2k）：

```
extension CommunityConnectViewController: UICollectionViewDelegateFlowLayout {
    func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAtIndex section: Int) -> UIEdgeInsets {

    // Translated from Objective-C version at: http://stackoverflow.com/a/27656363/309736

        let cellCount = CGFloat(viewModel.getNumOfItemsInSection(0))

        if cellCount > 0 {
            let flowLayout = collectionViewLayout as! UICollectionViewFlowLayout
            let cellWidth = flowLayout.itemSize.width + flowLayout.minimumInteritemSpacing
            let totalCellWidth = cellWidth*cellCount + spacing*(cellCount-1)
            let contentWidth = collectionView.frame.size.width - collectionView.contentInset.left - collectionView.contentInset.right

            if (totalCellWidth < contentWidth) {
                let padding = (contentWidth - totalCellWidth) / 2.0
                return UIEdgeInsetsMake(0, padding, 0, padding)
            }
        }

        return UIEdgeInsetsZero
    }
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-07-25T15:53:27.717

我的静态大小的集合视图单元格的解决方案需要左右填充 -

```
func collectionView(collectionView: UICollectionView, 
layout collectionViewLayout: UICollectionViewLayout, 
insetForSectionAtIndex section: Int) -> UIEdgeInsets {

    let flowLayout = (collectionViewLayout as! UICollectionViewFlowLayout)
    let cellSpacing = flowLayout.minimumInteritemSpacing
    let cellWidth = flowLayout.itemSize.width
    let cellCount = CGFloat(collectionView.numberOfItemsInSection(section))

    let collectionViewWidth = collectionView.bounds.size.width

    let totalCellWidth = cellCount * cellWidth
    let totalCellSpacing = cellSpacing * (cellCount - 1)

    let totalCellsWidth = totalCellWidth + totalCellSpacing

    let edgeInsets = (collectionViewWidth - totalCellsWidth) / 2.0

    return edgeInsets > 0 ? UIEdgeInsetsMake(0, edgeInsets, 0, edgeInsets) : UIEdgeInsetsMake(0, cellSpacing, 0, cellSpacing)
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-05-09T09:57:35.567

我的应用程序中有一个标签栏，它使用`UICollectionView`& `UICollectionViewFlowLayout`，一行单元格居中对齐。

为了获得正确的缩进，你从你的宽度中减去所有单元格的总宽度（包括间距）`UICollectionView`，然后除以 2。

```
[........Collection View.........]
[..Cell..][..Cell..]
                   [____indent___] / 2

=

[_____][..Cell..][..Cell..][_____] 
```

问题是这个功能 -

`- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section;`

之前调用...

`- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath;`

...所以你不能遍历你的单元格来确定总宽度。

相反，您需要再次计算每个单元格的宽度，在我的情况下，我使用`[NSString sizeWithFont: ... ]`的单元格宽度由 UILabel 本身确定。

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
{
    CGFloat rightEdge = 0;
    CGFloat interItemSpacing = [(UICollectionViewFlowLayout*)collectionViewLayout minimumInteritemSpacing];

    for(NSString * tag in _tags)
        rightEdge += [tag sizeWithFont:[UIFont systemFontOfSize:14]].width+interItemSpacing;

    // To center the inter spacing too
    rightEdge -= interSpacing/2;

    // Calculate the inset
    CGFloat inset = collectionView.frame.size.width-rightEdge;

    // Only center align if the inset is greater than 0
    // That means that the total width of the cells is less than the width of the collection view and need to be aligned to the center.
    // Otherwise let them align left with no indent.

    if(inset > 0)
        return UIEdgeInsetsMake(0, inset/2, 0, 0);
    else
        return UIEdgeInsetsMake(0, 0, 0, 0);
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-05-26T12:01:04.623

在 Swift 中，以下将通过在每个单元格的侧面应用正确数量的填充来均匀分布单元格。当然，您首先需要知道/设置您的单元格宽度。

```
func collectionView(collectionView: UICollectionView,
    layout collectionViewLayout: UICollectionViewLayout,
    insetForSectionAtIndex section: Int) -> UIEdgeInsets {

        var cellWidth : CGFloat = 110;

        var numberOfCells = floor(self.view.frame.size.width / cellWidth);
        var edgeInsets = (self.view.frame.size.width - (numberOfCells * cellWidth)) / (numberOfCells + 1);

        return UIEdgeInsetsMake(0, edgeInsets, 60.0, edgeInsets);
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-07-21T03:47:33.607

Swift 2.0 对我来说很好用！

```
 func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAtIndex section: Int) -> UIEdgeInsets {
        let edgeInsets = (screenWight - (CGFloat(elements.count) * 50) - (CGFloat(elements.count) * 10)) / 2
        return UIEdgeInsetsMake(0, edgeInsets, 0, 0);
    } 
```

其中： **screenWight**：基本上它是我收藏的宽度（全屏宽度） - 我制作了常量： let screenWight:CGFloat = UIScreen.mainScreen().bounds.width 因为 self.view.bounds 每次显示 600 - 因为 SizeClasses **元素**-单元格数组 **50** - 我的手动单元格宽度 **10** - 我的单元格之间的距离

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-02-25T12:17:47.160

您可以像这样使用[https://github.com/keighl/KTCenterFlowLayout](https://github.com/keighl/KTCenterFlowLayout)：

```
KTCenterFlowLayout *layout = [[KTCenterFlowLayout alloc] init];

[self.collectionView setCollectionViewLayout:layout]; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-24T17:10:44.830

不确定这是否是 Xcode 5 中的新功能，但您现在可以通过 Interface Builder 打开 Size Inspector 并在那里设置一个插图。这将使您不必编写自定义代码来为您执行此操作，并且应该大大提高您找到正确偏移量的速度。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-23T12:08:49.973

另一种方法是设置`collectionView.center.x`，如下所示：

```
override func viewDidLayoutSubviews() {
    super.viewDidLayoutSubviews()

    if let
        collectionView = collectionView,
        layout = collectionView.collectionViewLayout as? UICollectionViewFlowLayout
    {
        collectionView.center.x = view.center.x + layout.sectionInset.right / 2.0
    }
} 
```

在这种情况下，只尊重对我有用的正确插图。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-03-11T12:20:24.743

根据 user3676011 的回答，我可以建议更详细的一个小修正。这个解决方案在**Swift 2.0**上效果很好。

```
enum CollectionViewContentPosition {
    case Left
    case Center
}

var collectionViewContentPosition: CollectionViewContentPosition = .Left

func collectionView(collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout,
    insetForSectionAtIndex section: Int) -> UIEdgeInsets {

    if collectionViewContentPosition == .Left {
        return UIEdgeInsetsZero
    }

    // Center collectionView content

    let itemsCount: CGFloat = CGFloat(collectionView.numberOfItemsInSection(section))
    let collectionViewWidth: CGFloat = collectionView.bounds.width

    let itemWidth: CGFloat = 40.0
    let itemsMargin: CGFloat = 10.0

    let edgeInsets = (collectionViewWidth - (itemsCount * itemWidth) - ((itemsCount-1) * itemsMargin)) / 2

    return UIEdgeInsetsMake(0, edgeInsets, 0, 0)
} 
```

有一个问题

> (CGFloat(elements.count) * 10))

应该在哪里额外`-1`提及。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-07-11T19:11:58.320

这就是我如何获得一个以固定的Interitem间距居中对齐的集合视图

```
#define maxInteritemSpacing 6
#define minLineSpacing 3

@interface MyFlowLayout()<UICollectionViewDelegateFlowLayout>

@end

@implementation MyFlowLayout

- (instancetype)init
{
    self = [super init];
    if (self) {
        self.minimumInteritemSpacing = 3;
        self.minimumLineSpacing = minLineSpacing;
        self.scrollDirection = UICollectionViewScrollDirectionVertical;
    }
    return self;
}

- (NSArray *) layoutAttributesForElementsInRect:(CGRect)rect {
    NSArray *answer = [super layoutAttributesForElementsInRect:rect];

    if (answer.count > 0) {
        NSMutableArray<NSMutableArray<UICollectionViewLayoutAttributes *> *> *rows = [NSMutableArray array];
        CGFloat maxY = -1.0f;
        NSInteger currentRow = 0;

        //add first item to row and set its maxY
        [rows addObject:[@[answer[0]] mutableCopy]];
        maxY = CGRectGetMaxY(((UICollectionViewLayoutAttributes *)answer[0]).frame);

        for(int i = 1; i < [answer count]; ++i) {
            //handle maximum spacing
            UICollectionViewLayoutAttributes *currentLayoutAttributes = answer[i];
            UICollectionViewLayoutAttributes *prevLayoutAttributes = answer[i - 1];
            NSInteger maximumSpacing = maxInteritemSpacing;
            NSInteger origin = CGRectGetMaxX(prevLayoutAttributes.frame);

            if(origin + maximumSpacing + currentLayoutAttributes.frame.size.width < self.collectionViewContentSize.width) {
                CGRect frame = currentLayoutAttributes.frame;
                frame.origin.x = origin + maximumSpacing;
                currentLayoutAttributes.frame = frame;
            }

            //handle center align
            CGFloat currentY = currentLayoutAttributes.frame.origin.y;
            if (currentY >= maxY) {
                [self shiftRowToCenterForCurrentRow:rows[currentRow]];

                //next row
                [rows addObject:[@[currentLayoutAttributes] mutableCopy]];
                currentRow++;
            }
            else {
                //same row
                [rows[currentRow] addObject:currentLayoutAttributes];
            }

            maxY = MAX(CGRectGetMaxY(currentLayoutAttributes.frame), maxY);
        }

        //mark sure to shift 1 row items
        if (currentRow == 0) {
            [self shiftRowToCenterForCurrentRow:rows[currentRow]];
        }
    }

    return answer;
}

- (void)shiftRowToCenterForCurrentRow:(NSMutableArray<UICollectionViewLayoutAttributes *> *)currentRow
{
    //shift row to center
    CGFloat endingX = CGRectGetMaxX(currentRow.lastObject.frame);
    CGFloat shiftX = (self.collectionViewContentSize.width - endingX) / 2.f;
    for (UICollectionViewLayoutAttributes *attr in currentRow) {
        CGRect shiftedFrame = attr.frame;
        shiftedFrame.origin.x += shiftX;
        attr.frame = shiftedFrame;
    }
}

@end 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-01-02T21:55:04.957

使用 Swift 3.0 的 kgaidis 的 Objective C 答案的工作版本：

```
let flow = UICollectionViewFlowLayout()

func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets {        
    let numberOfItems = collectionView.numberOfItems(inSection: 0)
    let combinedItemWidth:CGFloat = (CGFloat(numberOfItems) * flow.itemSize.width) + ((CGFloat(numberOfItems) - 1) * flow.minimumInteritemSpacing)
    let padding = (collectionView.frame.size.width - combinedItemWidth) / 2

    return UIEdgeInsetsMake(0, padding, 0, padding)
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-09-27T20:43:57.560

这是我的解决方案，有一些假设：

*   只有一节
*   左右插图相等
*   单元格高度相同

随意调整以满足您的需求。

具有可变单元格宽度的居中布局：

```
protocol HACenteredLayoutDelegate: UICollectionViewDataSource {
    func getCollectionView() -> UICollectionView
    func sizeOfCell(at index: IndexPath) -> CGSize
    func contentInsets() -> UIEdgeInsets
}

class HACenteredLayout: UICollectionViewFlowLayout {
    weak var delegate: HACenteredLayoutDelegate?
    private var cache = [UICollectionViewLayoutAttributes]()
    private var contentSize = CGSize.zero
    override var collectionViewContentSize: CGSize { return self.contentSize }

    required init(delegate: HACenteredLayoutDelegate) {
        self.delegate = delegate
        super.init()
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
    }

    override func invalidateLayout() {
        cache.removeAll()
        super.invalidateLayout()
    }

    override func prepare() {
        if cache.isEmpty && self.delegate != nil && self.delegate!.collectionView(self.delegate!.getCollectionView(), numberOfItemsInSection: 0) > 0 {
            let insets = self.delegate?.contentInsets() ?? UIEdgeInsets.zero
            var rows: [(width: CGFloat, count: Int)] = [(0, 0)]
            let viewWidth: CGFloat = UIScreen.main.bounds.width
            var y = insets.top
            var unmodifiedIndexes = [IndexPath]()
            for itemNumber in 0 ..< self.delegate!.collectionView(self.delegate!.getCollectionView(), numberOfItemsInSection: 0) {
                let indexPath = IndexPath(item: itemNumber, section: 0)
                let cellSize = self.delegate!.sizeOfCell(at: indexPath)
                let potentialRowWidth = rows.last!.width + (rows.last!.count > 0 ? self.minimumInteritemSpacing : 0) + cellSize.width + insets.right + insets.left
                if potentialRowWidth > viewWidth {
                    let leftOverSpace = max((viewWidth - rows[rows.count - 1].width)/2, insets.left)
                    for i in unmodifiedIndexes {
                        self.cache[i.item].frame.origin.x += leftOverSpace
                    }
                    unmodifiedIndexes = []
                    rows.append((0, 0))
                    y += cellSize.height + self.minimumLineSpacing
                }
                unmodifiedIndexes.append(indexPath)
                let attribute = UICollectionViewLayoutAttributes(forCellWith: indexPath)
                rows[rows.count - 1].count += 1
                rows[rows.count - 1].width += rows[rows.count - 1].count > 1 ? self.minimumInteritemSpacing : 0
                attribute.frame = CGRect(x: rows[rows.count - 1].width, y: y, width: cellSize.width, height: cellSize.height)
                rows[rows.count - 1].width += cellSize.width
                cache.append(attribute)
            }
            let leftOverSpace = max((viewWidth - rows[rows.count - 1].width)/2, insets.left)
            for i in unmodifiedIndexes {
                self.cache[i.item].frame.origin.x += leftOverSpace
            }
            self.contentSize = CGSize(width: viewWidth, height: y + self.delegate!.sizeOfCell(at: IndexPath(item: 0, section: 0)).height + insets.bottom)
        }
    }

    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
        var layoutAttributes = [UICollectionViewLayoutAttributes]()

        for attributes in cache {
            if attributes.frame.intersects(rect) {
                layoutAttributes.append(attributes)
            }
        }
        return layoutAttributes
    }

    override func layoutAttributesForItem(at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
        if indexPath.item < self.cache.count {
            return self.cache[indexPath.item]
        }
        return nil
    }
} 
```

结果：

[![在此处输入图像描述](../Images/0a76f1c0f787fa7913f9ce46556b2ff8.png)](https://i.stack.imgur.com/35IdF.png)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-03-16T06:19:32.303

这是你可以做到的，它工作正常

```
func refreshCollectionView(_ count: Int) {
    let collectionViewHeight = collectionView.bounds.height
    let collectionViewWidth = collectionView.bounds.width
    let numberOfItemsThatCanInCollectionView = Int(collectionViewWidth / collectionViewHeight)
    if numberOfItemsThatCanInCollectionView > count {
        let totalCellWidth = collectionViewHeight * CGFloat(count)
        let totalSpacingWidth: CGFloat = CGFloat(count) * (CGFloat(count) - 1)
        // leftInset, rightInset are the global variables which I am passing to the below function
        leftInset = (collectionViewWidth - CGFloat(totalCellWidth + totalSpacingWidth)) / 2;
        rightInset = -leftInset
    } else {
        leftInset = 0.0
        rightInset = -collectionViewHeight
    }
    collectionView.reloadData()
}

func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, insetForSectionAt section: Int) -> UIEdgeInsets {
    return UIEdgeInsetsMake(0, leftInset, 0, rightInset)
} 
```

# php - Yii 在数据库的下拉列表中显示树视图

> ID：13588290
> 
> 赞同：3
> 
> 时间：2012-11-27T16:09:17.890
> 
> 标签：php, database, yii, treeview, html-select

我在数据库中保存了类别和子类别。我想在 CHtml 下拉列表中显示它们，如下所示：

```
Patrent_cat
   sub_cat1
   sub_cat2
Parent_cat2
  ... 
```

我的类别表是这样的

```
id name parent_id 
```

如果元组本身是父级，则 parent_id 为 0

我已经在我的类别模型中尝试过这个：

```
public function relations()
{
    return array(
                'getparent' => array(self::BELONGS_TO, 'Category', 'parent_id'),
                'childs' => array(self::HAS_MANY, 'Category', 'parent_id', 'order' => 'id ASC'),
    );
}

public function getCategoryTree() 
    {
        $subitems = array();
        if($this->childs) foreach($this->childs as $child) 
        {
            $subitems[] = $child->getListed();
        }
        $returnarray = array($this->id => $this->title);
        if($subitems != array()) 
            $returnarray = array_merge($returnarray, array('items' => $subitems));
        return $returnarray;
    } 
```

在我看来：

```
<?php 
         echo CHtml::dropDownList('category', 'id', 
                        Category::model()->CategoryTree,
                        array('empty' => '(Select a category'));
?> 
```

但它给了我一个空的下拉菜单。如何在带有选项组的下拉列表中显示此树视图？（选项组是父类别，选项是 sub_categories。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T16:57:32.623

试试这个

```
echo $form->dropDownList($model,'id',CHtml::listData(SubCat::model()->findAll(),'id', 'name','relation_name.name'),array('prompt'=>'Choose')); 
```

这将在下拉列表中显示父母和子类别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T05:03:48.690

您创建空模型并尝试获取它的孩子`Category::model()->CategoryTree`，因此您得到空结果。

尝试获取模型中子类别列表的方法：

```
public function getChildList() {
    $return = array();
    if ($this->childs !== null) {
        foreach ($this->childs as $child) {
            $return[$child->id] = "--".$child->title;
        }
    }
    return $return;
} 
```

在您的控制器操作上：

```
...
$categotyList = array();
$parentCategories = Category::model()->findAllByAttributes(array('parent_id'=>'0'));
foreach ($parentCategories as $category) {
    array_merge($categoryList, 
               array('$category->id' => '$category->name'), 
               $category->getChildList()
    );
}
... 
```

并查看：

```
echo CHtml::dropDownList('category', 'id', 
                        $categoryList,
                        array('empty' => '(Select a category')); 
```

检查代码是否有错误，并根据需要进行修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-13T08:53:28.587

```
public function getDropdownCategories()
    {
        $array = self::find()->select(['id', 'parent_id', 'name'])->asArray()->all();
        $array = self::buildTree($array);
        $array = ArrayHelper::map($array, 'id', 'name');
        return $array;
    }

private function buildTree($array, $parentId = null, $preWord = '')
    {
        if(!empty($preWord))
            $preWord.='-';

        $tmpArray = [];
        foreach ($array as $element) {
            if ($element['parent_id'] == $parentId) {
                $tmpArray[] = ['id' => $element['id'], 'name' => $preWord.$element['name']];
                $tmp = self::buildTree($array, $element['id'], '-');
                if(!empty($tmp) && is_array($tmp)) {
                    foreach ($tmp as $item) {
                        $tmpArray[] = ['id' => $item['id'], 'name' => $item['name']];
                    }
                }
            }
        }
        return $tmpArray;
    } 
```

# union - 什么是 OUTER UNION 以及为什么它部分兼容

> ID：13588291
> 
> 赞同：5
> 
> 时间：2012-11-27T16:09:27.237
> 
> 标签：union, relational-algebra

我试图了解 a 是如何`OUTER UNION`工作的，以及为什么它只是部分兼容。

我知道如果关系类型不兼容（我理解），则创建此操作是为了从两个关系中获取元组的联合。

这个操作的例子会很棒！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-26T16:21:47.077

`OUTER JOIN`运算符存在于关系代数中，即使它可能不存在于大多数查询语言中。

选择1大学80分以上的医学生姓名和成绩

```
Name Biology
  A   82
  B   88
  C   90 
```

选择第二大学b级或以上技术专业学生的姓名和年级

```
Name Computer Science
  F    a
  G    a+
  H    b 
```

假设这部分是在内部完成的，现在我们需要查看可以申请我的生物信息学课程的学生的最终名单及其资格。外部联合会有所帮助。

```
Table 1 OUTER UNION Table 2

Name Marks Grade
  A   82
  B   88
  C   90
  F          a
  G          a+
  H          b 
```

`UNION`由于属性 Marks 和 Grade 具有不同的域（一个采用数值，另一个采用字符等级），因此普通无法做到这一点。然而，像这样的表示可能在许多场合都证明是有帮助的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T23:41:50.020

您从哪里听说过这样的运营商的存在？

它在标准 SQL 中不存在，谷歌搜索似乎只导致 SAS 中 PROC SQL 的语法。

无论如何，如果这个运算符的输出是一个可能包含 NULL 的表，那么这个运算符就不是关系代数的一部分。关系代数是对依次产生其他关系的关系的计算，包含 NULL 的东西不是关系。

# google-maps-api-3 - 街景进入信息窗口

> ID：13588293
> 
> 赞同：3
> 
> 时间：2012-11-27T16:09:36.190
> 
> 标签：google-maps-api-3, infowindow, google-street-view

我正在尝试将街景视图显示到信息窗口中，但我没有得到它，这是我的代码：有谁知道如何做到这一点？

非常感谢您的先进

```
function createMarker(myLatlng) {

var panoramaOptions = {
      position: myLatlng,
      pov: {
        heading: 34,
        pitch: 10,
        zoom: 1
      }
    };
var panorama = new  google.maps.StreetViewPanorama(document.getElementById('pano'),panoramaOptions);
    map.setStreetView(panorama);

var contentString = '<div id="pano" style="width:200px;height:200px;"></div>';
var image = '/artworks/icons/myMarker.png';
var marker = new google.maps.Marker({
  position: myLatlng,
  map: map,
  title: "myTitle",
  icon: image
});

    google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent(contentString); 
    infowindow.open(map,marker);

    map.setCenter(myLatlng); 
    }); 

return marker;  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T16:51:39.950

我用：

`var contentString = '<div id="content" style="width:250px;height:300px;"></div>';`

```
 var infoWindow = new google.maps.InfoWindow({
        content: contentString
    }); 
```

`google.maps.event.addListener(marker, "click", function () {`

```
 infoWindow.open(mapStyled, marker);

                var pano = null;
                google.maps.event.addListener(infoWindow, 'domready', function () {
                    if (pano != null) {
                        pano.unbind("position");
                        pano.setVisible(false);
                    }
                    pano = new google.maps.StreetViewPanorama(document.getElementById("content"), {
                        navigationControl: true,
                        navigationControlOptions: { style: google.maps.NavigationControlStyle.ANDROID },
                        enableCloseButton: false,
                        addressControl: false,
                        linksControl: false
                    });
                    pano.bindTo("position", marker);
                    pano.setVisible(true);
                });

                google.maps.event.addListener(infoWindow, 'closeclick', function () {
                    pano.unbind("position");
                    pano.setVisible(false);
                    pano = null;
                }); 
```

虽然我无法立即看出为什么您的代码无法正常工作。在我的情况下，这是在解析 KML 文件的 for 循环中（从而为每个点创建一个新的弹出窗口和标记）。

希望这可以帮助。

[编辑] 回想起来，问题似乎是您将“pano”绑定到 div 而不是它的内容。还要记住取消绑定和重新绑定到不同的标记。

# iphone - 图像比较

> ID：13588296
> 
> 赞同：0
> 
> 时间：2012-11-27T16:09:40.560
> 
> 标签：iphone, xcode

我想知道在图像之间进行比较的最简单方法是什么。我找到了算法来查看图像看起来有多少相似，但我只需要知道它们是否完全相同..

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:13:08.697

如果您想知道它们是否 100% 相同，您可以将 a 转换`UIImage`为`NSData`并使用`isEqualToData:`. 但是，即使是一个像素的细微差别，您也不会得到确认

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:59:17.507

您的意思是等于人类观察者还是像素与数据像素完全相等。第一个很难，第二个很容易。

# php - 带有睡眠循环的PHP直到循环结束才更新数据库

> ID：13588297
> 
> 赞同：0
> 
> 时间：2012-11-27T16:09:40.070
> 
> 标签：php, loops, while-loop, sleep, flush

我有一个带有睡眠功能的while循环，我不想运行->更新数据库->睡眠->再次运行10次。使用下面的脚本，脚本会循环 10 次，但只有在所有 10 次循环都完成后才会更新数据库。

我在最后添加了一个回声只是为了验证，并且回声不会出现在页面上，直到每个循环都同时回显。

我还尝试在 echo 之后放置**ob_flush()**和**flush()** ，但没有成功。

**脚本**

```
$loops = 10;
while ($loops > 0)
{
  while($row = mysql_fetch_array($result))
  {
    // Get current User status
    $username = $row['username'];
    $user_status = $row['user_status'];
    $user_updated = date('Y-m-d H:i:s');

    // Update database
    $update_sql = "UPDATE  `database`.`user` SET  `user_status` =  '$user_status',
                                                  `user_updated` =  '$agent_updated'
                                            WHERE  
                                                  `user`.`username` =  '$username'";
    $update=mysql_query($update_sql);
    echo "Loop #".$loops."<br>";
  }
flush();
$loops--;
Sleep(5);
} 
```

我也尝试过使用**FOR 循环**。
任何建议，将不胜感激。我已经通过搜索并没有找到有类似问题的用户，但我找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:33:08.547

您可以让这些回显一一显示，但在受控环境中（根据 php 文档，flush 可能仍会缓冲多个 Win32 系统上的输出），您可以在[php flush 手册页](http://php.net/manual/en/function.flush.php)中进一步阅读。

更具体地说，请确保禁用 APaches mod_gzip，此外，一些 php.ini 设置（如 output_buffering 和 zlib.output_compression）应设置为 false。

```
output_buffering = false
zlib.output_compression = false 
```

即使有了所有这些，您可能还需要发送“大量”数据（如 2048 个字符）以使某些浏览器实际显示新数据。

```
echo "One"
echo str_repeat(" ", 2048);
Sleep(3)
echo "Two"
echo str_repeat(" ", 2048);
// Ans so on 
```

在上述手册页的评论中，您可以看到更多示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:51:58.373

根据提供的代码，似乎所有更新都在第一个循环中完成，然后 mysql_fetch_array($result) 仅返回 false 并且内部循环不会在其他主循环中再次进行，除非您再次填充 $result （在而循环标题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T23:22:59.703

正如 PHP 仅在脚本运行后一次性返回结果所指出的那样`N.B.`，我以以下解决方案结束：

每 5 秒运行一次 PHP 页面的 bash.sh 脚本：

```
#!/bin/bash

set -e
count=1
while [ $count -le 12 ] :
do
  # run this scripts for one minute (12 times every 5 seconds = 60 seconds)
  /usr/bin/php -q thescript.php
  (($count++))
sleep 5
done 
```

然后是每分钟运行一次页面的 cronjob。以上工作并解决了我的问题。

# c# - 仅针对一家公司的多封电子邮件的正则表达式验证器

> ID：13588298
> 
> 赞同：1
> 
> 时间：2012-11-27T16:09:40.870
> 
> 标签：c#, asp.net, regex, telerik

我正在使用 RegularExpressionValidator 来验证特定公司的电子邮件 ID。这个：

```
ValidationExpression=\\w+([-+.']\\w+)*@ABCCompany.com 
```

仅适用于第一个电子邮件 ID，我需要验证多个电子邮件。我在网上找到了另一个：

```
ValidationExpression="((\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)*([;])*)*" 
```

它工作正常，但我必须验证`ABCCompany.com`. 我也尝试`CustomValidator`了服务器端验证，它的工作代码很明智，但它没有显示错误消息。

谁能帮我解决我的问题。

## 我的 HTML 代码：

```
<

telerik:RadGrid ID="RadGrid1" runat="server" AutoGenerateColumns="false" CellPadding="0"  CellSpacing="0" GridLines="None" HorizontalAlign="Left" ShowFooter="true" AllowPaging="true"  PageSize="10" AllowMultiRowSelection="true" OnItemCommand="RadGrid1_OnItemCommand" OnNeedDataSource="RadGrid1_OnNeedDataSource" OnInsertCommand="RadGrid1_OnInsertCommand" OnUpdateCommand="RadGrid1_OnUpdateCommand" OnDeleteCommand="RadGrid1_OnDeleteCommand"  AllowSorting="true"> 

 <PagerStyle Position="Bottom" AlwaysVisible="true" /> 

 <ValidationSettings EnableValidation="true" ValidationGroup="products" /> 

<MasterTableView CommandItemDisplay="Top" HorizontalAlign="NotSet" AutoGenerateColumns="False" DataKeyNames="id"> 

 <Columns> 
<telerik:GridTemplateColumn DataField="Product_ID" FilterControlAltText="Filter Product_ID column" HeaderText="Product_ID" UniqueName="Product_ID" SortExpression="Product_ID"> 

<HeaderStyle HorizontalAlign="Center" /> 

<ItemStyle HorizontalAlign="Center" /> 

<ItemTemplate> 

<asp:Label ID="lblProduct_ID" runat="server" Text='<%# Bind("Product_ID") %>'></asp:Label> 

</ItemTemplate> 

</telerik:GridTemplateColumn> 

<telerik:GridTemplateColumn DataField="Product_Email" FilterControlAltText="Filter Product_Email column" 

HeaderText="Product Email" UniqueName="Product_Email" SortExpression="Product_Email"> 

<HeaderStyle HorizontalAlign="Left" /> 

<ItemStyle HorizontalAlign="Left" /> 

<ItemTemplate> 

<asp:Label ID="lblProduct_Email" runat="server" Text='<%# Bind("Product_Email") %>'></asp:Label> 

</ItemTemplate> 

<EditItemTemplate> 

<asp:TextBox ID="tbProduct_Email" runat="server" Text='<%# Bind("Product_Email") %>' 

Width="500px"></asp:TextBox>&nbsp;(Note: Enter multiple emails with ; separator) 

<asp:RequiredFieldValidator ID="rfvtbProduct_Email" runat="server" ControlToValidate="tbProduct_Email" 

ErrorMessage="Please enter Product Email" ForeColor="Red" ValidationGroup="products"></asp:RequiredFieldValidator>  

<asp:CustomValidator ID="cvtbProduct_Email" runat="server" ControlToValidate="tbProduct_Email" 

ForeColor="Red" ErrorMessage="Enter only valid ABCCompany Emails" OnServerValidate="cvtbProduct_Email_OnServerValidate" 

ValidationGroup="products" EnableClientScript="false" Display="None"></asp:CustomValidator> 

</EditItemTemplate> 

</telerik:GridTemplateColumn> 

<telerik:GridEditCommandColumn ButtonType="ImageButton" UniqueName="EditCommandColumn"> 

<ItemStyle HorizontalAlign="Center"></ItemStyle> 

</telerik:GridEditCommandColumn> 

<telerik:GridButtonColumn ButtonType="ImageButton" CommandName="Delete" Text="Delete" 

UniqueName="DeleteColumn"> 

<ItemStyle HorizontalAlign="Center"></ItemStyle> 

</telerik:GridButtonColumn> 

</Columns> 

<EditFormSettings ColumnNumber="1" CaptionDataField="Product_id" CaptionFormatString="Edit properties of Product ID: {0}"  InsertCaption="Product ID:"> 

</EditFormSettings> 

</MasterTableView> 

<ClientSettings EnableRowHoverStyle="true"> 

</ClientSettings> 

</telerik:RadGrid> 
```

## 服务器端验证代码：

```
 protected void cvtbProduct_Email_OnServerValidate(object sender, ServerValidateEventArgs args)
    {
        bool valid;

        var email = new string[100];

        var emailList = (TextBox) RadGrid1.MasterTableView.GetInsertItem().FindControl("Product_Email");

        if (emailList.Text != "")
        {
            if (emailList.Text.Contains(";"))

                email = emailList.Text.Split(';');

            else

                email[0] = emailList.Text;

            for (var i = 0; i < email.Length; i++)
            {
                if (email[i] != null)
                {
                    valid = Regex.IsMatch(email[i], "\\w+([-+.']\\w+)*@ABCCompany.com");

                    if (!valid)
                    {
                        args.IsValid = false;
                    }

                    else

                        args.IsValid = true;
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:27:11.780

```
 protected void cvtbProduct_Email_OnServerValidate(object sender, ServerValidateEventArgs args)
    {
        var emailList = (TextBox) RadGrid1.MasterTableView.GetInsertItem().FindControl("Product_Email");

        if (string.IsNullOrEmpty(emailList.Text))
        {
            args.IsValid = false;
            return;
        }

        //you don't need to check if it has the seperator in it
        var emails = emailList.Text.Split(';');

        foreach (var email in emails)
        {
            //the @ before a string removes the need to double up on '\'
            //you were missing a '\' before the .
            var valid = Regex.IsMatch(email, @"\w+([-+.']\w+)*@ABCCompany\.com");

            if (!valid)
            {
                args.IsValid = false;
                return; //don't check anymore
            }
        }

        //all must have passed
        args.IsValid = true;
    } 
```

# c# - 在 Visual Studio 代码段中解析替换文字

> ID：13588299
> 
> 赞同：1
> 
> 时间：2012-11-27T16:09:41.837
> 
> 标签：c#, xml, visual-studio, code-snippets

> **可能重复：**
> [格式化 C# 代码片段的文字参数](https://stackoverflow.com/questions/164645/formatting-literal-parameters-of-a-c-sharp-code-snippet)

编辑：这可以关闭。找到一个完全相同的副本，似乎没有解决方案。=(

完全重复： [格式化 C# 代码片段的文字参数](https://stackoverflow.com/questions/164645/formatting-literal-parameters-of-a-c-sharp-code-snippet)

编写代码片段时有什么方法可以解析替换文字吗？我想做类似以下的事情：

```
<Literal>
    <ID>PropertyName</ID>
</Literal> 
```

用户将 PropertyName 替换为“MyProperty”，结果如下：

```
private object _myProperty;

public object MyProperty
{get;set;} 
```

注意大小写。我需要一种方法来解析替换文字并对其进行操作。下划线是微不足道的，只是硬编码的问题。

这里有机会吗？

编辑; 完整片段：

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <CodeSnippet Format="1.0.0">
    <Header>
      <Title>MVVM Public Property</Title>
      <Author>Michael Leide</Author>
      <Description>Adds a public property with private backing and property changed event support.</Description>
      <Shortcut>propvm</Shortcut>
    </Header>

    <Snippet>
      <Declarations>
        <Literal Editable="true">
          <ID>PropertyType</ID>
          <Default>object</Default>          
        </Literal>

        <Literal Editable="true">
          <ID>PropertyName</ID>
          <Default>PropertyName</Default>
        </Literal>
      </Declarations>

      <Code Language="csharp" Kind="" Delimiter="$">
        <![CDATA[
        $PropertyType$ _$PropertyName$;

        public $PropertyType$ $PropertyName$ {
            get {
                if (_$PropertyName$ == null)
                    _$PropertyName$ = new $PropertyType$();
                return _$PropertyName$;
            } set {
                _$PropertyName$ = value;
                this.OnPropertyChanged("$PropertyName$");
        }   }
        ]]>      
      </Code>

    </Snippet>
  </CodeSnippet>
</CodeSnippets> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:48:58.673

不幸的是，您不能直接将您的 PropertyName 转换为 propertyName。解决此问题的最佳方法是包含第三个文字来指定支持字段。这可以防止您当前文字中的歧义，并且只会增加额外的几次击键。

声明块如下所示：

```
 <Declarations>
    <Literal Editable="true">
      <ID>PropertyType</ID>
      <Default>object</Default>          
    </Literal>

    <Literal Editable="true">
      <ID>PropertyName</ID>
      <Default>PropertyName</Default>
    </Literal>

    <Literal Editable="true">
      <ID>BackingPropertyField</ID>
      <Default>backingPropertyField</Default>
    </Literal>
  </Declarations> 
```

代码块变为：

```
 public $PropertyType$ $PropertyName$ {
        get {
            if (_$BackingPropertyField$ == null)
                _$BackingPropertyField$ = new $PropertyType$();
            return _$BackingPropertyField$;
        } set {
            _$BackingPropertyField$ = value;
            this.OnPropertyChanged("$PropertyName$");
    }   }
    ]]>      
  </Code> 
```

然后，您可以直接浏览并指定所需的名称。

# tags - 标签和类别 - ExpressionEngine

> ID：13588300
> 
> 赞同：0
> 
> 时间：2012-11-27T16:09:46.203
> 
> 标签：tags, expressionengine, categories, channel

我是第一次在 EE 上开发，我不太了解这些类别。

我创建了带有名称的类别，并且所有内容都是链接的。

当我选择一个类别并更新我的帖子时，在博客帖子页面上，每个类别都会显示。

![在此处输入图像描述](../Images/41d2d9fd67f0cc908db7e46132602f26.png) ![在此处输入图像描述](../Images/ddaf95128efd7b513f1f38e05dc67590.png)

这是代码：

```
{exp:channel:categories channel="blogs"}
   <li><a href="{path='blog/categories'}">{category_name}</a></li>
{/exp:channel:categories} 
```

第二个问题：

有没有办法有标签和类别？带有下拉菜单或类似的东西？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:58:39.970

> 当我选择一个类别并更新我的帖子时，在博客帖子页面上，每个类别都会显示。

频道类别标签默认显示所有类别，无论是否有任何帖子以这种方式分类。要覆盖它，您只需将`show_empty`参数设置为`no`

尝试

```
{exp:channel:categories channel="blogs" show_empty="no"}
   <li><a href="{path='blog/categories'}">{category_name}</a></li>
{/exp:channel:categories} 
```

请参阅[文档](http://ellislab.com/expressionengine/user-guide/modules/channel/categories.html#show-empty)

* * *

**但是**...由于从您的评论中听起来您只想显示分配给给定条目的类别，因此可以使用不同的标签。

Channel Entries 标签内有一个变量对可用于[类别](http://ellislab.com/expressionengine/user-guide/modules/channel/channel_entries.html#categories)

在您的`exp:channel:entries`标签对中，您将需要添加类似

```
{categories}
    <a href="{path='your/template_path'}">{category_name}</a>
{/categories} 
```

[您也可以在此答案](https://stackoverflow.com/a/13104158/780434)中找到一些有用的信息。

* * *

> 有没有办法有标签和类别？带有下拉菜单或类似的东西？

要在您的网站上添加标签，您可以使用可用于 EE 的标签插件之一。我推荐[Tagger](http://www.devdemon.com/tagger/)或[Solspace Tag](http://www.solspace.com/software/detail/tag/)。

# php - XMLHttpRequest 将变量传递给 php 脚本

> ID：13588301
> 
> 赞同：4
> 
> 时间：2012-11-27T16:09:53.573
> 
> 标签：php, javascript, xmlhttprequest

我正在尝试使用 XMLHttpRequest 将变量传递给 php 脚本，然后让 php 回显它。我不明白为什么它不起作用，有人可以帮助我。这是Javascript。

```
<script language="javascript" type="text/javascript">
    // Browser Support 
function Heatctrl(heatMode){
    var heatControlRequest;

    try{
        //Good Browsers
        heatControlRequest = new XMLHttpRequest();
    } catch (e) {
        //Internet Explorer
        try{
            heatControlRequest = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e) {
            try{
                heatControlRequest = new ActiveXObject("Microsoft.XMLHTTP");
            }catch (e) {
                alert("Brower not supported");
                return false;
            }
        }
    }

    // Function to receive data from server and store in variable
    heatControlRequest.onreadystatechange = function(){
        if (heatControlRequest.readystate == 4){
            alert(heatControlRequest.responseText);
            //document.getElementById("controlMode").innerHTML=heatControlRequest.responseText;
            //var heatControlResponse = heatControlRequest.responseText;
        }
    }
    var url = "heatControl.php?heatmode="+heatMode;
    // Send the request
    heatControlRequest.open("GET", url, true);
    heatControlRequest.send();
}   
</script> 
```

的HTML

```
 <div id="boilerButtons">
    <button type="button" onclick="Heatctrl('On')">Heating On</button>
    <button type="button" onclick="Heatctrl('Off')">Heating Off</button>
    <button type="button" onclick="Heatctrl('Boost')">Boost</button>
</div> 
```

和PHP

```
<?php
$controlMode = $_GET['heatmode'];
echo $controlMode; 
?> 
```

非常感谢任何帮助，我从事电子工作而不是编程，我已经为此苦苦挣扎了两天。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:41:57.163

问题是这一行：

```
if (heatControlRequest.readystate == 4){
                            ^ this should be an uppercase S 
```

它应该是：

```
if (heatControlRequest.readyState == 4){ 
```

从[文档](http://www.w3.org/TR/XMLHttpRequest/#dom-xmlhttprequest-readystate)：

> XMLHttpRequest 对象可以处于多种状态。readyState 属性必须返回当前状态。

# c# - COMException：在 Presentations 集合中找不到项目默认值

> ID：13588302
> 
> 赞同：0
> 
> 时间：2012-11-27T16:09:54.093
> 
> 标签：c#, powerpoint, office-interop

手头的任务似乎并不太复杂，但实现是一个不同的故事。我有一个 Web 界面，用于上传 .pptx 文件，他们对其进行操作并最终移动到与托管应用程序的 Web 服务器不同的服务器。此外，我还需要将文件从 .pptx 更改为 .ppsx。

我尝试使用 File.Copy 方法重命名文件，我在目标端给出了不同的名称，但这似乎损坏了文件并且无法打开它。

尝试使用 Microsoft.Office.Interop 会引发上述错误。有谁知道如何纠正这个问题？

这是我的代码。

谢谢。

```
string[] txtList = Directory.GetFiles(tempSavePath, fileName);
Microsoft.Office.Interop.PowerPoint.Application app = new Microsoft.Office.Interop.PowerPoint.Application();
Microsoft.Office.Interop.PowerPoint.Presentation pptPresentation = null;
foreach (string f in txtList)
{
    try
    {
        File.Copy(Path.Combine(tempSavePath, fileName),Path.Combine(remoteShareSLEBBPortal, fileName));                        
        FileInfo _fileInfo = new FileInfo(@tempSavePath + fileName);
        Process.Start(@tempSavePath + fileName);
        var presCol = app.Presentations;
        Thread.Sleep(2000);
        pptPresentation = presCol[@tempSavePath + fileName];
        pptPresentation = app.Presentations.Open(@tempSavePath + fileName, MsoTriState.msoFalse, MsoTriState.msoFalse, MsoTriState.msoFalse);
    }
    catch (IOException copyError)
    {
        WriteException(copyError, "File Coppying");
    }
} 
```

# sql - 未知列，但它确实存在？

> ID：13588303
> 
> 赞同：0
> 
> 时间：2012-11-27T16:09:57.817
> 
> 标签：sql

这是我的更新查询：

```
UPDATE products
SET products_status = 0
WHERE (`products`.`products_id` = `products_to_categories`.`products_id` 
       and `products_to_categories`.`categories_id` = 114) 
```

我得到的错误是：

> 1054 - 'where 子句'中的未知列'products_to_categories.products_id'

但是当我转到表 products_to_categories 时，有一列 products_id。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:46:10.133

您需要的查询可能是这个：

```
UPDATE products
SET products_status = 0
WHERE products_id IN 
(SELECT products_id 
 FROM products_to_categories
 WHERE categories_id = 114) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:37:26.917

知道了：

```
UPDATE products
SET products_status = 0
WHERE (SELECT products_id FROM products_to_categories
WHERE(
`products`.`products_id` = `products_to_categories`.`products_id` and `products_to_categories`.`categories_id` = 114)) 
```

# c++ - C++ 在类构造函数中定义一个常量成员变量

> ID：13588306
> 
> 赞同：17
> 
> 时间：2012-11-27T16:09:59.740
> 
> 标签：c++, constructor, initialization, constants

通常当你的类中有一个常量私有成员变量时，它只有一个 getter 而没有 setter，它看起来像这样：

```
// Example.h
class Example {
    public:
        Example(const int value);
        const int getValue() const;
    private:
        const int m_value;
};

// Example.cpp
#include "Example.h"

Example::Example(const int value)
: m_value(value)
{
}

const int Example::getValue() const
{
    return m_value;
} 
```

现在我想做的是有一个像这样的常量 int 成员变量，而不是像这样在初始化部分定义它：`: m_value(value)`我需要使用另一个对象 - 我将在这个例子中使用一个向量 - 作为构造函数的参数，并根据参数对象设置m_value。在这种情况下，如果大小大于 0，我将尝试做向量的大小 + 1。所以这就是我所做的：

```
Example::Example(std::vector<Example*> myVec)
{
    if (myVec.size()) {
        m_value = myVec.size() + 1;
    }
    else {
        m_value = -1;
    }
} 
```

但是我得到一个错误`uninitialized member 'Example::m_value' with 'const' type 'const int'`，如果我在初始化部分初始化 m_value，我得到的错误`assignment of read-only data-member 'Example::m_value'`对我来说都是有意义的，我应该得到这些错误，但我怎么能绕过它们呢？

**编辑：**我可以编辑的唯一方法`m_value`是在对象本身内部（因为 m_value 是私有的）。只有 getter 会限制我将 m_value 设置为构造函数中设置的值以外的任何值。将常量 int 作为成员变量对我有什么好处吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-27T16:13:01.327

使用静态成员函数计算您需要的结果并在初始化列表中调用该函数。像这样：

```
// Example.h
class Example {
    public:
        Example(const int value);
        Example(std::vector<Example*> myVec);

        const int getValue() const;
    private:
        const int m_value;

        static int compute_m_value(::std::vector<Example*> &myVec);
};

// Example.cpp
#include "Example.h"

Example::Example(const int value)
: m_value(value)
{
}

Example::Example(std::vector<Example*> myVec)
: m_value(compute_m_value(myVec))
{
}

const int Example::getValue() const
{
    return m_value;
}

int Example::compute_m_value(::std::vector<Example*> &myVec)
{
    if (myVec.size()) {
        return myVec.size() + 1;
    }
    else {
        return -1;
    }
} 
```

在这种特殊情况下，该函数非常简单，您只需`: m_value(myVec.size() > 0 ? int(myVec.size() + 1) : int(-1)`在构造函数中使用三元运算符（aka ）即可在初始化时直接计算值。这看起来像一个例子，所以我给了你一个非常通用的解决问题的方法，即使计算你需要的答案的方法可能非常复杂。

**一般问题是必须**在初始化列表中初始化常量成员变量（以及 BTW 引用的成员变量） 。但是初始化器可以是表达式，这意味着它们可以调用函数。由于此初始化代码非常特定于该类，因此它应该是该类的私有（或可能受保护）函数。但是，由于在构造类之前调用​​它来创建一个值，因此它不能依赖于类实例的存在，因此没有`this`指针。这意味着它需要是一个静态成员函数。

现在， 的类型`myVec.size()`是`std::vector<Example*>::size_t`，并且该类型是无符号的。而且您使用的是 -1 的哨兵值，但事实并非如此。而且您将它存储在一个`int`可能不适合容纳它的尺寸中。如果您的向量很小，这可能不是问题。但是，如果您的向量根据外部输入获取大小，或者如果您不知道它将获得多大，或任何其他因素，这将成为一个问题。您应该考虑这一点并相应地调整您的代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T16:13:18.153

首先，变量是在类**定义**中定义的，而不是在构造函数中。它在构造函数中**初始化**。

其次，这样做的方法就像您的构造函数当前所做的那样：将初始值设定项列表中的值存储在其中：

```
Example::Example(std::vector<Example*> myVec)
    : m_value(myVec.size() ? myVec.size() + 1 : -1) {
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:16:28.467

你有两个基本的选择。一种是使用条件运算符，这对于像您这样的简单条件很好：

```
Example::Example(const std::vector<Example*> &myVec)
  : m_value( myVec.size() ? myVec.size() + 1 : -1)
{} 
```

对于更复杂的事情，您可以将计算委托给成员函数。注意不要在里面调用虚成员函数，因为它会在构造过程中被调用。这样做是最安全的`static`：

```
class Example
{
  Example(const std::vector<Example*> &myVec)
    : m_value(initialValue(myVec))
  {}

  static int initialValue(const std::vector<Example*> &myVec)
  {
    if (myVec.size()) {
      return myVec.size() + 1;
    } else {
      return -1;
    }
  }
}; 
```

当然，后者也适用于类外定义。我把它们放在课堂上以节省空间和打字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-10T22:29:03.980

*这个答案解决了所有其他答案的问题：*

这个建议不好：

```
m_value(myVec.size() ? myVec.size() + 1 : -1) 
```

无论最终选择如何，条件运算符都将其第二个和第三个操作数变为一个通用类型。

`size_t`在这种情况下，和的常见类型`int`是`size_t`。因此，如果向量为空，则将该值`(size_t)-1`分配给`int`m_value，这是一个超出范围的转换，调用实现定义的行为。

* * *

为了避免依赖实现定义的行为，代码可以是：

```
m_value(myVec.size() ? (int)myVec.size() + 1 : -1) 
```

现在，这保留了原始代码存在的另一个问题：超出范围的转换 when `myVec.size() >= INT_MAX`. 在健壮的代码中，这个问题也应该得到解决。

我个人更喜欢添加一个辅助函数的建议，该函数执行此范围测试并在值超出范围时抛出异常。尽管代码开始变得难以阅读，但单行是可能的：

```
m_value( (myVec.empty() || myVec.size() >= INT_MAX) ? -1 : (int)myVec.size() + 1 ) 
```

* * *

当然，还有一些其他方法可以更干净地处理这个问题，例如使用`size_t`for`m_value`和`(size_t)-1`作为标记值，​​或者最好完全避免需要标记值。

# javascript - 如果使用咖啡脚本，我如何使用 JS typeof 运算符？

> ID：13588307
> 
> 赞同：0
> 
> 时间：2012-11-27T16:10:02.623
> 
> 标签：javascript, coffeescript

我需要将一段 JavaScript 代码翻译成 CoffeeScript，这里是：

```
jQuery(function($) {
if (typeof ($.fn.jCarouselLite) != 'undefined') {
  $("#slider_1").jCarouselLite({
    btnNext: "#slider_1 .next",
    btnPrev: "#slider_1 .prev",
    visible: 1
  });
} 
```

if 条件导致了问题，这就是我当时正在做的事情：

```
jQuery ->
  $ = jQuery
    if typeof $.fn.jCarouselLite not 'undefined'
      $("#slider_1").jCarouselLite
        btnNext: "#slider_1 .next
        btnPrev: "#slider_1 .prev"
        visible: 1 
```

但是编译器抱怨说：**第2行解析错误：意外'POST_IF'**

有谁能够帮我？如何正确地将 If 条件转换为 Coffeescript？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:13:27.037

`not`是一元运算符，所以我认为您的意思是

```
if typeof $.fn.jCarouselLite isnt 'undefined' 
```

...但你可以只使用`?`：

```
if $.fn.jCarouselLite? 
```

...但是该错误似乎是由有趣的缩进引起的，例如第 2 行 ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:28:15.263

尝试`unless`并使用括号：

```
jQuery ($) ->
  unless typeof ($.fn.jCarouselLite) is "undefined"
    $("#slider_1").jCarouselLite
      btnNext: "#slider_1 .next"
      btnPrev: "#slider_1 .prev"
      visible: 1 
```

顺便说一句，您可以通过[http://js2coffee.org/快速查看](http://js2coffee.org/)

# sql-server - SQL SUM 来自内部查询的 COUNT

> ID：13588313
> 
> 赞同：0
> 
> 时间：2012-11-27T16:10:17.277
> 
> 标签：sql-server

如何从这样的内部查询中总结一列？显然这不起作用，但它本质上是我想要做的。有很多类似的帖子，但这是独一无二的，因为我有一个`HAVING`条款。

```
SELECT SUM(cnt)
FROM
    (
        SELECT COUNT(*) as cnt
        FROM users
        GROUP BY email
        HAVING COUNT(*)>1
    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:21:55.147

如果您有查询的别名，您所写的内容应该可以工作

```
SELECT SUM(cnt)
FROM
    (
        SELECT COUNT(*) as cnt
        FROM users
        GROUP BY email
        HAVING COUNT(*)>1
    ) as t 
```

[SQL小提琴](http://sqlfiddle.com/#!6/83862/2)

# c# - 在 TCP 读取请求中的意外时间调用了一个方法

> ID：13588317
> 
> 赞同：1
> 
> 时间：2012-11-27T16:10:36.497
> 
> 标签：c#, asynchronous, windows-phone-8

```
StreamSocket _connection = AsyncCreateConnection(); // In constructor

private async void receive(){
DataReader reader = new DataReader(_connection.InputStream);
DataWriter writer = new DataWriter(_connection.OutputStream);

try
        {
            reader.InputStreamOptions = InputStreamOptions.Partial;
            uint sizeFieldCount = await reader.LoadAsync(sizeof(uint)); // <<--  Explosion
            if (sizeFieldCount != sizeof(uint))
            {
                return;
            }

            // Read the string.
            uint stringLength = reader.ReadUInt32();
            uint actualStringLength = await reader.LoadAsync(stringLength);
            if (stringLength != actualStringLength)
            {
                return;
            }

            Debug.WriteLine(reader.ReadString(actualStringLength));
        }
        catch (Exception exc)
        {
            Debug.WriteLine(exc.Message);
        }
} 
```

整个下午都收到这个错误。创建连接的异步应该在调用接收方法时完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:53:29.363

例外是说您在`async`调用准备好之前正在使用它的输出。

我相信你的连接还没有准备好，也许你也应该`await`连接。

因为构造函数不能是`async`你需要从另一个函数调用它。

```
StreamSocket _connection = await AsyncCreateConnection(); 
```

# c - printf 的返回类型是什么

> ID：13588320
> 
> 赞同：-6
> 
> 时间：2012-11-27T16:10:38.750
> 
> 标签：c, function, return-value

这可能是个愚蠢的问题，但我很困惑。这就是为什么我要清除我的疑问。昨天，在我的采访中，我收到了一个问题，比如

```
char ch="Hello";
printf("%d",printf("%s",ch)); 
```

我认为`printf`是一个**void**类型的函数，因为我从未见过`printf`分配给任何变量的函数。所以，我告诉过，它会显示**编译错误**。因为，编译器不会找到返回类型`printf`函数。但是我错了。输出是**Hello5**。我真的很困惑，这是怎么来的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:13:31.893

函数 fun() 返回一个 int，你只是没有将它分配给任何东西。因此返回值被丢弃，因为它没有分配给任何东西。

顺便说一下，printf 不是一个 void 函数，而是返回打印的字符数，在“Hello”的情况下为 5。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:13:36.133

你可能读到的“你需要一个左值来接受函数调用的返回”

例如。在你的代码中。

你不能做

```
5 = fun(); 
```

因为 5 不是左值。

不过这两个都不错

```
int i;
i = fun(); // i is an l-value 
```

或者

```
fun(); // ignore the return value 
```

另外，你需要

```
char * str = "hello"; // you cannot allocate a string to a single char 
```

并且`void main()`是非标准的。

你需要

```
int main() 
```

# jquery - 优化内部渐变的 jQuery 代码

> ID：13588321
> 
> 赞同：1
> 
> 时间：2012-11-27T16:10:39.577
> 
> 标签：jquery, responsive-design

我正在使用 jQuery.innerfade 插件，它没有响应性 ::: 我在 jQuery 中编写了一些运行良好的代码 ::: 只是想知道这是否是最佳编码，因为我没有很多 jQuery 知识 :::

```
 // Set container height 
    var innerfade_H = $('#blog_link .container').height();
    $("#blog_link .container").css("height", innerfade_H );

    // Resize innerfade on resize
    function resize_innerfade() {
        $('#blog_link .container, .blog_link').css("height", "" ); //clear heights we will be adding new height
        $('.blog_link li').css("position", "" ); //clear position this is so we can calculate the actual height

        var innerfade_Resize = $('.blog_link').height(); //get new height

        $("#blog_link .container, .blog_link").css("height", innerfade_Resize ); //set the new height
        $('.blog_link li').css("position", "absolute" ); // reset position to absolute
    };

        // On resize lets put everything into motion little timer so screenwidth settles
        var resizeInn;
        jQuery(window).resize(function() {
            clearTimeout(resizeInn);
            resizeInn = setTimeout(resize_innerfade, 200);
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:33:40.497

没有太多代码，但您仍然可以通过缓存选择器而不是每次都调用它们来优化它。

```
var $container = $('#blog_link .container') ;
// Set container height 
var innerfade_H = $container.height();
$container.css("height", innerfade_H);

// Resize innerfade on resize

function resize_innerfade() {

    var $blog_link = $('.blog_link'); 
    var $blog_li = $('.blog_link li');

    $container.add($blog_link).css("height", ""); //clear heights we will be adding new height
    $blog_li.css("position", ""); //clear position this is so we can calculate the actual height
    var innerfade_Resize = $blog_link.height(); //get new height
    $container.add($blog_link).css("height", innerfade_Resize); //set the new height
    $blog_li.css("position", "absolute"); // reset position to absolute
};

// On resize lets put everything into motion little timer so screenwidth settles
var resizeInn;
jQuery(window).resize(function() {
    clearTimeout(resizeInn);
    resizeInn = setTimeout(resize_innerfade, 200);
});​ 
```

# iphone - iOS6 中未调用 shouldAutoRotate 方法

> ID：13588325
> 
> 赞同：3
> 
> 时间：2012-11-27T16:10:50.023
> 
> 标签：iphone, xcode, ios5, rotation, ios6

我有一个从 a中`UIViewController`推送的详细视图。在我添加了一些子视图（例如 a 、）。`UITableView``UINavigationController``UIViewController``UITextView``UIImageView`

如果`iOS5`我的图片视图被放大，我使用此代码停止自动旋转：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// Return YES for supported orientations
if (scrollView.isZoomed) {
    return NO;
}
else {
    return YES;
} 
```

}

我正在尝试在`iOS6`using 下实现相同的目标：

```
- (BOOL)shouldAutorotate {
return FALSE;
} 
```

但是，此方法永远不会被调用，并且应用程序会继续旋转。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:50:01.607

如果您有管理这些视图的导航控制器，则不会调用*shouldAutorotate方法。*您必须**继承 UINavigationController**并覆盖方法*shouldAutorotate*和*supportedIntervalOrientations*。

从文档：

> 现在，iOS 容器（例如 UINavigationController）不会咨询它们的子容器来确定它们是否应该自动旋转

编辑 - - -

正如 Lomax 下面提到的，Apple 不鼓励子类化 UINavigationController。您应该尝试使用一个类别（[这个 SO question 很好地解释了它](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6)）：

```
@implementation UINavigationController 
-(BOOL)shouldAutorotate
{
    // your code
}

-(NSUInteger)supportedInterfaceOrientations
{
    (...)
}

@end 
```

# c# - ResourceManager.GetString() FileNotFound 异常

> ID：13588329
> 
> 赞同：2
> 
> 时间：2012-11-27T16:10:57.573
> 
> 标签：c#, .net, resources, .net-4.5, resourcemanager

嗨，我有一个解决方案，我刚刚从 .Net 3.5/MVC1/VS2008 迁移到 .Net 4.5/MVC4/VS2012

大多数事情都很好，但我有一个字符串资源文件问题

我的解决方案有 3 个项目，其中一个是核心，另一个依赖于核心。

在每个项目中，我都有一个按以下模式命名的字符串文件：

**核心项目**- 文件名为 **Strings.resx**

**Dependency1 项目**- 文件名为 **Dependency1Strings.resx**

**Dependency2 项目**- 文件名为 **Dependency2Strings.resx**

这些文件中的每一个都有与特定项目有关的字符串。

当解决方案加载时，我使用以下代码为每个项目创建一个 ResourceManager（示例使用 Dependency2）：

```
ResourceManager manager = new ResourceManager("Dependency2.Dependency2Strings", typeof(Dependency2Strings).Assembly); 
```

后来当我尝试打电话时`manager.GetString(messageName,ClientCulture)`

我收到一个 FileNotFoundException 说明无法找到文件**Dependency2.resources.dll 。**

奇怪的是，它为 Dependency2.resources.dll 列出的 PublicToken 与**Dependency2.dll****的**PublicKey 相同。

 **我的问题是有谁知道为什么以及应该在哪里生成**Dependency2.resources.dll （也许这是一个新设置）。**在以前版本的 .Net 中，此代码没有问题。

这只发生在依赖项目上，而不是核心项目。看起来.Net 将这个项目结构与卫星组装结构混淆了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:44:41.957

因此，经过多次尝试和错误，我得出了一个折衷的解决方案。

我将所有资源字符串放入同一个 resx 文件中，然后让所有 3 个资源管理器引用同一个文件。

这行得通！**

# html - 我想让我的井扩大并在鼠标悬停时发光

> ID：13588331
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:11:12.733
> 
> 标签：html, css

我正在尝试复制在我的页面上找到的效果[Here](http://wbpreview.com/previews/WB000212L/pricing.htm)，但我不确定如何去做。我正在使用 twitter 引导程序 2.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:21:10.627

我认为你最好的选择是浏览这篇文章。它将让您很好地了解如何使用 CSS3 制作动画。

[http://www.css3.info/preview/css3-transitions/](http://www.css3.info/preview/css3-transitions/)

这是我整理的一个快速解决方案：http: [//jsfiddle.net/zStN5/](http://jsfiddle.net/zStN5/)

CSS：

```
.button {
margin:10px;
background: #700;
color: #fff;
padding: 5px 10px;
text-decoration: none;
height: 60px;

-webkit-box-shadow: 0px 0px 3px #212121;
-moz-box-shadow: 0px 0px 3px #212121;
box-shadow: 0px 0px 3px #212121;

/* Animate all properties across supporting browsers */
-webkit-transition: all 1s ease-in-out;
/* -o-transition: all 1s ease-in-out; */
-moz-transition: all 1s ease-in-out;
transition: all 1s ease-in-out;
}

.button:hover {
background: #b00;
height: 100px;

/* Box shadow animation bugged in Opera */
-webkit-box-shadow: 0px 0px 10px #000;
-moz-box-shadow: 0px 0px 10px #000;
box-shadow: 0px 0px 10px #000;
}​ 
```

HTML

```
<div class="button" href="#">Your Div</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:23:01.270

因为我未来的 CSS3 将是这样的动画的绝佳选择。像练习一样使用这个垃圾箱

[http://jsbin.com/egotig/2/edit](http://jsbin.com/egotig/2/edit)

# codeigniter - 多个 CodeIgniter 应用程序路由问题

> ID：13588332
> 
> 赞同：0
> 
> 时间：2012-11-27T16:11:15.957
> 
> 标签：codeigniter

我有一个 CodeIgniter 的路由问题。

我有两个应用程序共享具有以下文件夹结构的系统文件夹

```
./admin
./admin/index.php
./admin/{stylesheets, scripts, images, etc}

./site
./site/index.php
./site/{stylesheets, scripts, images, etc}

./applications/admin
./applications/admin/{controllers, models, config, etc.}
./applications/site
./applications/site/{controllers, models, config, etc.}

./system 
```

一切正常，除了我只能以 domain.com/site/controller_name/method_name 的身份访问我的网站。我怎样才能摆脱网站部分？

此外，是否有一种简单的方法可以在应用程序之间共享帮助程序和库？除了将它们放在系统/助手中。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T15:03:13.307

尝试将根文件夹的 .htaccess 更改为

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^example\.com$
RewriteRule (.*) http://www.example.com/$1 [R=301,L]
RewriteRule ^$ site [L] 
```

# html - 列 960.gs div 中的列

> ID：13588333
> 
> 赞同：0
> 
> 时间：2012-11-27T16:11:16.917
> 
> 标签：html, css, 960.gs

假设我有一个 div 是 960.gs 样式网格的成员。它有图标和文字。现在我希望文本从图标中缩进，但是我不能使用网格，因为我已经在一个网格中，而且我会有很多像这样的 div，每个图标和文本都应该贴在父级的顶部。

```
<div id="I_AM_GRID_MEMBER">
<span class="icon"><img src="lala.png"></span>
<span>Some text here </span><br/>
<span>Some text here </span><br/>
<span>Some text here </span><br/>
<span>Some text here </span><br/>
</div>

.icon{
display: inline-block;
float: left;
width: 73px;
height: 56px;
background-color: black;
margin-right: 20px;
} 
```

这是一个例子： http: [//jsfiddle.net/Q6ZbH/2/](http://jsfiddle.net/Q6ZbH/2/) 问题是：我怎样才能缩进我的文本，所以它不会真正漂浮在图标周围？

很抱歉解释复杂，很难用语言解释你想在视觉上实现什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:15:56.033

在包含的 DIV 上使用 CSS 图像背景并为其提供足够的填充以将文本推离图标。

```
#I_AM_GRID_MEMBER {
     background-image:url(/lala.png);
     padding-top: 56px;
     padding-left:73px`enter code here`
} 
```

# javascript - addEventListnener(click) 在页面加载时触发

> ID：13588336
> 
> 赞同：0
> 
> 时间：2012-11-27T16:11:28.813
> 
> 标签：javascript, html, javascript-events

我现在可能...，但是为什么当我的页面加载时这段代码会记录 hello x2，而单击 LI 元素时却什么也没有？它应该记录单击的元素名称。如果我将“hello”更改为 e.target，它会记录 HTMLDocument？！

谢谢你。

```
<!DOCTYPE html>
<html>
    <head>

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <script type="text/javascript">

            window.onload = function(){
                var list = document.getElementById("listan");

                list.addEventListener("touchstart", elementClicked(event), false);
                list.addEventListener("click", elementClicked(event), false);
            }

            function elementClicked(e) {

                console.log("hello");

                if(e.target && e.target.nodeName == "LI") {

                    console.log(e.target.nodeName);
                }

            }

        </script>

        <style>

            * {
                list-style: none;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            li {
                width: 90%;
                background: darkblue;
                color: #eee;
                margin: 10px auto;
                padding: 15px;
                border: 1px solid black;
                text-align: center;
                font-family: calibri;
                cursor: pointer;
            }
            ul {
                background: green;
                padding: 10% 0;
            }

        </style>

    </head>
    <body>
        <ul id="listan">
            <li>apa</li>
            <li>häst</li>
            <li>ko</li>
            <li>elefant</li>
            <li>lejon</li>
            <li>zebra</li>
            <li>myrslok</li>
            <li>grävling</li>
        </ul>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:14:23.533

对于这些：

```
list.addEventListener("touchstart", elementClicked(event), false);
list.addEventListener("click", elementClicked(event), false); 
```

你想传入实际的函数`elementClicked`，所以只需使用：

```
list.addEventListener("touchstart", elementClicked, false);
list.addEventListener("click", elementClicked, false); 
```

# node.js - mongo 可以 upsert 数组数据吗？

> ID：13588342
> 
> 赞同：53
> 
> 时间：2012-11-27T16:11:42.863
> 
> 标签：node.js, mongodb

我有一个像这样的 mongo 文件。

```
{
    "_id" : ObjectId("50b429ba0e27b508d854483e"),
    "array" : [
        {
            "id" : "1",
            "letter" : "a"
        },
        {
            "id" : "2",
            "letter" : "b"
        }
    ],
    "tester" : "tom"
} 
```

我希望能够`array`使用单个 mongo 命令插入和更新，而不是在`find()`then 运行中使用条件`insert()`，`update()`具体取决于对象的存在。

这`id`是我想成为选择器的项目。所以如果我用这个更新数组：

```
{
    "id" : "2",
    "letter" : "c"
} 
```

我必须使用`$set`声明

```
db.soup.update({
    "tester":"tom",
    'array.id': '2'
}, {
    $set: {
        'array.$.letter': 'c'
    }
}) 
```

如果我想在数组中插入一个新对象

```
{
    "id" : "3",
    "letter" : "d"
} 
```

我必须使用`$push`声明

```
db.soup.update({
    "tester":"tom"
}, {
    $push: {
        'array': {
            "id": "3",
            "letter": "d"
        }
    }
}) 
```

我需要一种数组项的 upsert。

我必须以编程方式执行此操作，还是可以通过单个 mongo 调用执行此操作？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-27T23:04:58.660

我不知道有一个选项会像 MongoDB 2.2 那样插入到嵌入式数组中，因此您可能必须在应用程序代码中处理这个问题。

鉴于您希望将嵌入式数组视为一种虚拟集合，您可能需要考虑将数组建模为单独的集合。

您不能基于嵌入数组中的字段值执行 upsert，但[`$addToSet`](http://docs.mongodb.org/manual/reference/operator/addToSet/)如果嵌入文档不存在，您可以使用它来插入：

```
db.soup.update({
    "tester":"tom"
}, {
    $addToSet: {
        'array': {
            "id": "3",
            "letter": "d"
        }
    }
}) 
```

这不适合您匹配`id`数组元素的确切用例，但如果您知道预期的当前值，可能会很有用。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-09-09T22:34:11.503

我自己也遇到了这个问题。我无法找到一次调用解决方案，但我找到了一个两次调用解决方案，*当您在数组元素中具有唯一值时该*解决方案有效。首先使用该`$pull`命令，从数组中删除元素，然后使用`$push`.

```
db.soup.update({
    "tester":"tom"
}, {
    $pull: {
        'array': {
            "id": "3"
        }
    }
})
db.soup.update({
    "tester":"tom"
}, {
    $push: {
        'array': {
            "id": "3",
            "letter": "d"
        }
    }
}) 
```

这应该在文档不存在、文档存在但数组中的条目不存在以及条目存在时起作用。

同样，这仅在您拥有某些东西（例如`id`本例中的字段）时才有效，该字段在数组的元素中应该是唯一的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-25T05:45:46.693

如果您可以重组文档以使用对象而不是数组，则可以在某些情况下实现嵌入式文档集的 upsert。我刚刚在[另一个问题](https://stackoverflow.com/questions/8871363/upsert-array-elements-matching-criteria-in-a-mongodb-document/21347039#21347039)上回答了这个问题，但为了方便起见，我会在此处对其进行调整。

* * *

一个示例文档是

```
{
    tester: 'tom',
    items: {
        '1': 'a',
        '2': 'b'
    }
} 
```

要使用`id`3 和值 'c' 插入一个项目，你会这样做

```
db.coll.update(
    { tester: 'tom' }, 
    { $set: { 'items.3': 'c' } }
) 
```

一个缺点是查询字段名称（使用`$exists`查询运算符）需要扫描。您可以通过添加一个存储属性名称的额外数组字段来解决此问题。该字段可以正常被索引和查询。Upserts 变成

```
db.coll.update(
    { tester: 'tom' }, 
    { 
        $set: { 'items.3': 'c' },
        $addToSet: { itemNames: 3 }
    }
) 
```

（请记住`$addToSet`O(n)。）删除属性时，您还必须将其从数组中拉出。

```
db.widgets.update(
    { tester: 'tom' }, 
    { 
        $unset: { 'items.3': true },
        $pull: { itemNames: 3 }
    }
) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-15T09:08:35.700

问题来自 2012 年。我查看了 mongo 文档：[https](https://docs.mongodb.com/manual/reference/method/Bulk.find.upsert) ://docs.mongodb.com/manual/reference/method/Bulk.find.upsert Rob Watts 在评论中提到的，但它非常稀疏。

I found an answer here: [https://stackoverflow.com/a/42952359/1374488](https://stackoverflow.com/a/42952359/1374488)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-28T05:08:04.237

嘿，您可以使用数组过滤器选项来完成。您可以参考这里 [https://docs.mongodb.com/manual/reference/method/db.collection.update/#update-arrayfilters](https://docs.mongodb.com/manual/reference/method/db.collection.update/#update-arrayfilters)。

```
 db.getCollection('soup').update({'tester':tom}, { $set: { "collection.$[element].letter" : 'c' } },
   {
     arrayFilters: [ { "element.id": 2 } ]
   }) 
```

# sharepoint - Sharepoint 和开发许可证

> ID：13588345
> 
> 赞同：1
> 
> 时间：2012-11-27T16:11:57.653
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007

在我的一个项目中，我们遇到了一个奇怪的许可政策，很可能我们可能对共享点许可的工作方式知之甚少，但如果有人能阐明这个话题，我们将不胜感激。

我们的组织拥有完整的共享点企业安装版本，我们正在使用共享点作为核心基础构建应用程序，我们的开发团队规模可能会从 20 到 30 人增长。团队告诉我，每个开发人员都需要在他们的本地机器上安装一个共享点服务器的个人副本用于开发目的，一旦他们完成了本地开发，应用程序就会被提升到我们的企业开发环境中。但是，为了获得共享点服务器的个人副本，我需要购买一个 MSDN 高级订阅，价格约为 6K。我们确实为团队购买了 Visual Studio 许可证。所以这意味着从技术上讲，我只为开发许可证支付了 6K * 30 = 180K，还请记住，我们为购买 Sharepoint 企业服务器付出了高昂的代价。

我很想知道其他人是如何管理这个的，我希望 Visual Studio 有一个共享点 Web 服务器外壳，类似于它与本地 Web 服务器捆绑在一起用于开发目的，然后再将其推广到 IIS。

我们也在考虑使用 180 天的 sharepoint 试用版，这将允许我们的每个开发人员安装试用版并进行本地开发，一旦他们完成测试，他们就可以使用我们的企业进行推广和测试共享点开发服务器。我们的大部分开发人员将在 5 个月内发布。

在此先感谢您的帮助。

# javascript - 如何检测对象是否在特定位置休眠？

> ID：13588349
> 
> 赞同：0
> 
> 时间：2012-11-27T16:12:02.843
> 
> 标签：javascript, game-physics, box2dweb

我目前正在用 box2dweb 编写一个小游戏，为此我需要一些指导：我正在投掷一个盒子或球，当被投掷的物体不再移动时，我必须击中一个特定的地方并触发一个事件，”睡着了”可以这么说。

什么是正确的方法/最佳实践？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T04:42:55.513

你可以检查它的速度，看看它是否还在移动。只需在身体上调用 GetVelocity()。我相信它会返回一个 b2vec。

# mysql - MySQL 备份和部分恢复的“快照”（时间定义），带有自动增量 id 字段

> ID：13588350
> 
> 赞同：0
> 
> 时间：2012-11-27T16:12:04.857
> 
> 标签：mysql, backup, innodb, restore, snapshot

希望有人可以在这里给我一个提示。

我有一个 mysql (Inno) 数据库，其中有多个通过外键关联的表。

我的数据库现在有几千兆字节的数据。

我需要完成的是：备份我的实际数据库（好的 mysqldump 会为我处理），我想“”“清理”“”数据库并仅添加上个月的数据（例如），维护我要恢复的所有行的完整性。也就是说，想象一下表 1、2、3、4、5（我大约有 50 个）：

表 1 和 2 每分钟都有新行，表 3 是一个“配置”表，它提供（通过外键输入）表 1 和 2，以及表 4 和 5（这些不是“”“配置/基础”“”表) 与表 1 和表 2 相关。

好的，我知道我必须恢复所有“配置/基础”表和包含的行，以确保相关“依赖”表的完整性并可以使用这些配置值。

但是，我如何只保留所有其他表行的最后一个月，以保持恢复行的完全完整性？

我认为在编写脚本时可能会使用 mysql 二进制日志。

我所有的“id”字段都是自动递增的，并且在任何时候我都应该能够恢复完整的数据库（在崩溃的情况下，或用于“大图”研究/挖掘）。

感谢一百万提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:57:03.860

添加一列来保存输入的日期或最后修改的日期（或两者）可能会有所帮助。您可以使用触发器来设置日期。

# javascript - KnockoutJS：订阅 observableArray 条目的内部可观察对象

> ID：13588355
> 
> 赞同：4
> 
> 时间：2012-11-27T16:12:18.650
> 
> 标签：javascript, knockout.js

对于我目前的项目，我决定尝试淘汰赛，我想知道以下是否可行。我正在为一些基本的列表操作编写一个 Intranet 应用程序。该应用程序通过 AJAX 从 MVC 控制器获取数据。在我的回调函数中，我将条目填充到可观察数组中，如下所示：

```
function showData(data) { // ajax callback
   $.each(data, function (key, dmsEntry) {
        vm.listToShow.push(new dmsList(dmsEntry));  // adds new dmsEntry into observableArray
   });
} 
```

该`dmsList`函数如下所示：

```
function dmsList(dmsEntry) {
       return {
          a: dmsEntry.a,
          b: dmsEntry.b,
          active: ko.observable(false)
       }
 } 
```

当用户标记列表条目时，可观察到的“活动”将变为 true。所以我的问题是：

所以我想知道是否可以订阅“活动”可观察对象？因此，每次用户标记条目时，都会调用自定义函数并将条目推送到“markedEntries”可观察数组中？

我已经通过以下方式实现了该功能：

```
<input type="checkbox" data-bind="checked: active, click: $root.addToActionQueue" /> 
```

但我认为另一种方式将是一个更清洁的解决方案，因为我还有其他方式来“标记”条目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:52:25.977

将您的`markedEntries`数组变成一个[计算](http://knockoutjs.com/documentation/computedObservables.html)数组，该数组返回由您的活动 observable 过滤的列表数组。每次项目的活动状态更改时，它都会更新。

```
var markedEntries = ko.computed(function() {
   return ko.utils.arrayFilter(this.items(), function(item) {
       return item.active();
   });
}); 
```

另外，假设`listToShow`是一个[可观察的数组](http://knockoutjs.com/documentation/observableArrays.html)，你应该像这样一次设置它的值：

```
function showData(data) { //ajax callback
    var list = [];
    $.each(data, function (key, dmsEntry) {
         list.push(new dmsList(dmsEntry); //adds new dmsEntry in observableArray         
    });
    vm.listToShow(list);
 } 
```

# java - jlist 元素未动态显示

> ID：13588356
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:12:24.580
> 
> 标签：java, swing, jlist

我正在编写客户端-服务器聊天应用程序。我在客户端 GUI 中创建了 jlist，以便可以显示在线客户端。但是当创建该客户端GUI的不同对象时，jlist不会显示所有客户端，即如果在一个对象中创建了一个客户端，则不会被其他对象显示。这是我的代码：

```
 DefaultListModel model = new DefaultListModel();
    static List<String> Client = new ArrayList<String>();
    public GUI() {
        initComponents();

    }
    public GUI(String hostname,int port, String user_name) throws  Exception{
        initComponents();
        my_name = user_name;
        s = new Socket("localhost", 80);
        Client.add(user_name);
        for(int i=0;i<Client.size();i++){
            model.addElement(Client.get(i));
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:35:52.057

*   您对[Swing 中的 Concurency](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)有疑问，

*   Swing 不是线程安全的

*   Swing GUI的所有更新都[必须在 EDT 上完成](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)，

    a）`Socket`从未通知的输出`EDT`的输出，

    b）`Item`向`DefaultListModel` 从未通知的添加新的`EDT`的添加一个新的，

    c) 简单的解决方法是换行代码行`model.addElement(Client.get(i))`；到`invokeLater()`

*   这个问题可能是[关于为什么使用 SwingWorker 的预订示例](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)

编辑`invokeLater of jlist?`，不请看

```
SwingUtilities.invokeLater(new Runnable(){
    public void run(){
        model.addElement(Client.get(i));
    }
}); 
```

# android - 应用注册

> ID：13588357
> 
> 赞同：0
> 
> 时间：2012-11-27T16:12:27.457
> 
> 标签：android, ios, mobile, mobile-application

我有一个只希望我公司的员工使用的应用程序。它将在 Apple 和 Android 应用商店中提供。我试图找出一种方法来保护它，以便只有员工才能登录它。

目前，它设置为在注册时接受公司电子邮件并发送包含激活链接的电子邮件。我觉得应该有一种更好的方法来做到这一点，而不涉及使用电子邮件。

有没有人有什么建议？

编辑：

另外，这个应用程序目前是公司的原型，所以我现在无法访问员工 ID 等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:16:39.647

不要把它们放在商店里。谷歌可能会允许，但苹果至少可能会拒绝一个仅限内部使用的应用程序。

[https://developer.apple.com/programs/ios/enterprise/](https://developer.apple.com/programs/ios/enterprise/)

对于 Android，您只需提供 .apk 即可下载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:34:39.647

对于IOS，有两种方式：

1.  获取一个 IOS 企业开发者帐户，这将允许您开发和分发应用程序，而无需将它们放置在应用商店中。我还没有这样做，但据我所知，您可以从网络服务器内部交付它们。

    见[https://developer.apple.com/programs/ios/enterprise/](https://developer.apple.com/programs/ios/enterprise/)

2.  手动方式是让每个人向您发送他们设备的 UID，并让您在开发人员门户中手动注册，您可以向他们发送应用程序，然后他们可以在 iTunes 中安装它。我发现这在 Mac 上工作得很好，但是当用户在 Windows 上时它是不可靠的（去图 ...）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:30:31.037

不要把事情复杂化。如果当前版本较旧，请从服务器下载一些简单的 xml 文件以及更新的 apk 文件。

然后提示用户安装新的

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setDataAndType(Uri.fromFile(new File(Environment.getExternalStorageDirectory() + "/download/" + "app.apk")), "application/vnd.android.package-archive");
startActivity(intent); 
```

# java - 如何在java中同时运行两个帧

> ID：13588360
> 
> 赞同：0
> 
> 时间：2012-11-27T16:12:31.580
> 
> 标签：java, swing, loading, multitasking, jdialog

我正在尝试为我的程序创建一个加载屏幕，以便在加载主屏幕或执行特定任务时显示加载屏幕。我尝试使用 JDialog 作为加载屏幕，但由于某种原因，一旦加载屏幕对话框打开，它就不会让主程序运行它自己的工作。如何让它们同时工作？

这是我的加载屏幕的代码：

```
public class FrmLoading extends JDialog {

  private static FrmLoading loading;

  public FrmLoading(java.awt.Frame parent, boolean modal) {
    super(parent, modal);
    initComponents();
    this.setLocationRelativeTo(null);
  }

  public static void startAnimation(){
    loading = new frmLoading(null, true);
    loading.setVisible(true);
  }

  public static void stopAnimation(){
    loading.dispose();
  }

  private void initComponents(){
    //build the Dialog
  }
} 
```

这就是我使用它的方式：

```
private void login(){
    FrmLoading.startAnimation();
    //open main program
}

...

private void mainStart(){
    //load contents
    FrmLoading.stopAnimation();
} 
```

我知道有一个默认为 java swing 的加载屏幕，但我不想使用它，我想要我制作的动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:18:12.103

使用[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)

```
SwingWorker<Void, Void> worker = new SwingWorker<Void, Void>() {
    @Override
    protected Void doInBackground() {
        //do your stuff in background
        return null;
    }

    @Override
    protected void done() {
        frmMain.setVisible(true);
        loading.dispose();
        disposeThis(); //a method that calls this.dispose();
    }
};
worker.execute();
loading.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T17:02:00.627

为什么要`JFrame`用于加载屏幕。考虑使用类似的东西`JWindow`：

```
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JPanel;
import javax.swing.JWindow;

public class LoadingScreenDemo extends JWindow{
    Panel panel = new Panel();

    public LoadingScreenDemo() {
        addMouseListener(new MouseAdapter(){
            public void mouseClicked(MouseEvent e){
                if(e.getClickCount() == 2){
                    dispose();
                }
            }
        });
        panel.setBackground(Color.YELLOW);
        add(panel);
    }

    public static void main(String[] args) {
        LoadingScreenDemo m = new LoadingScreenDemo();
        m.setSize(640,480);
        m.setLocationRelativeTo(null);
        m.setVisible(true);
    }

    class Panel extends JPanel{

        public void paintComponent(Graphics g){
            super.paintComponent(g);
            g.setFont(new Font("Verdana",Font.BOLD,24));
            g.drawString("Loading...", 270, 210);

            g.setFont(new Font("Verdana",Font.PLAIN,14));
            g.drawString("OS: "+System.getProperty("os.name"), 10,400);
            g.drawString("OS version"+System.getProperty("os.version"), 10,420);
            g.drawString("Java vendor: "+System.getProperty("java.vendor"), 10,440);
            g.drawString("Java version: "+System.getProperty("java.version"), 10,460);
        }
    }

} 
```

![在此处输入图像描述](../Images/422dcca19f7b89c646fb8e4581cbe7ed.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:21:19.197

而不是在 JDialog 构造函数中使用布尔模态参数，您可能希望将[JDialog 构造函数与modality](http://docs.oracle.com/javase/6/docs/api/javax/swing/JDialog.html#JDialog%28java.awt.Window,%20java.awt.Dialog.ModalityType%29)一起使用，并传入 MODELESS 枚举。

这可能会阻止主窗口阻塞。

# powershell - 使用 Powershell 和 Jenkins 进行远程访问

> ID：13588361
> 
> 赞同：6
> 
> 时间：2012-11-27T16:12:34.607
> 
> 标签：powershell, jenkins, winrm

我正在尝试在远程（Windows 2008 Server R2）机器上运行一个 powershell 脚本。以下代码在直接从 powershell 执行时效果很好。（即一切设置正确，WinRM 服务正在运行，主机相互信任，登录正确...）

但是，当我从 Jenkins 实例（在我测试的同一台机器上运行）执行完全相同的代码时，我得到一个**PSSessionStateBroken**连接失败，. （没有发布完整的错误，因为它在我的机器上是德语。）

我想这意味着 Jenkins 使用不同的 powershell 或具有不同的 powershell/winrm 设置或权限不足。有任何想法吗？

```
$computer = "<some ip>"
$user = "Administrator"
$password = "<secretpassword>"
$securepassword = ConvertTo-SecureString -String $password -AsPlainText -Force
$cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $user, $securepassword
Invoke-Command -ComputerName $computer -ScriptBlock { Get-ChildItem C:\ } -Credential $cred 
```

**编辑：**通过以管理员身份运行 jenkins 服务来修复它。对我有用，但感觉不对...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-16T13:52:15.163

自 2014 年 3 月起，Jenkins 安装 Jenkins 服务以作为 LocalSystem 用户（即 `NT AUTHORITY\SYSTEM`）运行。LocalSystem 帐户[使用计算机帐户访问网络](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684190%28v=vs.85%29.aspx)。

例如，一台名为的主机上的 Jenkins使用Active Directory 域中的计算机帐户`JENKINSSERVER`连接到远程机器。`MYDOMAIN\JENKINSSERVER$``MYDOMAIN`

这意味着您需要将`MYDOMAIN\JENKINSSERVER$`帐户添加为`BUILTIN\Administrators`本地组的成员`TARGETSERVER`：

`NET LOCALGROUP "Administrators" "MYDOMAIN\MYSERVER$" /add`

*警告 Emptor*`TARGETSERVER` ：这允许在 MYSERVER 主机上作为 LocalSystem 或 NetworkService 执行的任何代码以管理员身份运行远程命令。您最好只为该服务创建一个特定的域用户，以将管理员权限限制在单个 Jenkins 服务中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T02:42:24.663

您的 Jenkins 服务帐户凭据是否有权远程登录到目标计算机？

当管理员帐户和常规服务帐户访问时，我会使用 ProcMon 监视目标系统。你会看到不同，我敢打赌这会很明显！祝你好运！

# symfony - symfony2.0 项目中没有自动加载外部类

> ID：13588365
> 
> 赞同：0
> 
> 时间：2012-11-27T16:12:57.777
> 
> 标签：symfony, symfony-2.0

我想将**EasyCSV**添加到我的 symfony2 项目[https://github.com/jwage/EasyCSV](https://github.com/jwage/EasyCSV)

这是我尝试过的。我添加了

```
'EasyCSV'          => __DIR__.'/../vendor/easy-csv', 
```

到 autoload.php 和

```
use EasyCSV\Reader; 
```

在我想使用这个库的控制器中。但我明白了

> 致命错误：在 ...Controller.php 中找不到类“EasyCSV\Reader”

任何想法为什么？如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:23:46.973

进入`vendor/composer/autoload_classmap.php`（Symfony 2.1）

```
<?php

// autoload_classmap.php generated by Composer

$vendorDir = dirname(__DIR__);
$baseDir = dirname($vendorDir);

return array(
    'EasyCSV' => __DIR__.'/../vendor/easy-csv',
    [....]
); 
```

然后你可以简单地通过插入来使用它

```
use EasyCSV 
```

在您需要它的文件的“顶部”。

# **没有作曲家解决方案**

在你的文件中试试这个`autoload.php`（我想在底部）

```
use Symfony\Component\ClassLoader\MapClassLoader;
[...]
// Create map autoloader
$mapLoader = new MapClassLoader(array(
    'EasyCSV' => __DIR__.'/../vendor/easy-csv',
    [...]
));

// Register autoloader
$mapLoader->register(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T22:38:39.917

正如我们在评论中所讨论的，请确保您没有手动将第三方库添加到您的供应商文件中。内置的 symfony 包管理系统是有原因的。

对于有问题的捆绑包，您应该将以下内容添加到您的`deps`文件中。

```
[easy-csv]
    git=http://github.com/jwage/EasyCSV.git 
```

然后，您应该将以下内容添加到您的`app/autoload.php`

```
$loader->registerNamespaces(array(
    ...
    'EasyCSV'          => __DIR__.'/../vendor/easy-csv/lib',
)); 
```

现在您应该能够导入命名空间并使用它。

# vba - VBA以“从任何文件中恢复文本”模式打开.doc

> ID：13588380
> 
> 赞同：0
> 
> 时间：2012-11-27T16:13:34.997
> 
> 标签：vba, ms-word, .doc

我正在尝试将许多旧的 .DOC 文件转换为 PDF 格式或 RTF 格式。到目前为止，我已经找到了完成后者（转换为 RTF）的方法，但是旧 Word 应用程序的格式仍然存在于文档中。如果您打开 Microsoft Word（我使用的是 2010）并单击“文件”>“打开”，则会出现一个下拉菜单，可让您选择“从任何文件（*.*）中恢复文本”。是否可以在转换过程中使用它来过滤掉 .DOC 文档中的格式数据？以下是我目前尝试修改的几个脚本示例：

尽管它似乎只是将 .rtf 附加到文件的末尾而不是更改格式，但它已经奏效了：

```
Sub SaveAllAsDOCX()
Dim strFilename As String
Dim strDocName As String
Dim strPath As String
Dim oDoc As Document
Dim fDialog As FileDialog
Dim intPos As Integer
Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)
With fDialog
    .Title = "Select folder and click OK"
    .AllowMultiSelect = False
    ..InitialView = msoFileDialogViewList
    If .Show <> -1 Then
        MsgBox "Cancelled By User", , "List Folder Contents"
        Exit Sub
    End If
    strPath = fDialog.SelectedItems.Item(1)
    If Right(strPath, 1) <> "\" Then strPath = strPath + "\"
End With
If Documents.Count > 0 Then
    Documents.Close SaveChanges:=wdPromptToSaveChanges
End If
If Left(strPath, 1) = Chr(34) Then
    strPath = Mid(strPath, 2, Len(strPath) - 2)
End If
strFilename = Dir$(strPath & "*.doc")
While Len(strFilename) <> 0
    Set oDoc = Documents.Open(strPath & strFilename)
    strDocName = ActiveDocument.FullName
    intPos = InStrRev(strDocName, ".")
    strDocName = Left(strDocName, intPos - 1)
    strDocName = strDocName & ".docx"
    oDoc.SaveAs FileName:=strDocName, _
        FileFormat:=wdFormatDocumentDefault
    oDoc.Close SaveChanges:=wdDoNotSaveChanges
    strFilename = Dir$()
Wend
End Sub 
```

到目前为止，这个在任何转换中都没有成功：

```
Option Explicit
Sub ChangeDocsToTxtOrRTFOrHTML()
'with export to PDF in Word 2007
    Dim fs As Object
    Dim oFolder As Object
    Dim tFolder As Object
    Dim oFile As Object
    Dim strDocName As String
    Dim intPos As Integer
    Dim locFolder As String
    Dim fileType As String
    On Error Resume Next
    locFolder = InputBox("Enter the folder path to DOCs", "File Conversion", "C:\myDocs")
    Select Case Application.Version
        Case Is < 12
            Do
                fileType = UCase(InputBox("Change DOC to TXT, RTF, HTML", "File Conversion", "TXT"))
            Loop Until (fileType = "TXT" Or fileType = "RTF" Or fileType = "HTML")
        Case Is >= 12
            Do
                fileType = UCase(InputBox("Change DOC to TXT, RTF, HTML or PDF(2007+ only)", "File Conversion", "TXT"))
            Loop Until (fileType = "TXT" Or fileType = "RTF" Or fileType = "HTML" Or fileType = "PDF")
    End Select
    Application.ScreenUpdating = False
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set oFolder = fs.GetFolder(locFolder)
    Set tFolder = fs.CreateFolder(locFolder & "Converted")
    Set tFolder = fs.GetFolder(locFolder & "Converted")
    For Each oFile In oFolder.Files
        Dim d As Document
        Set d = Application.Documents.Open(oFile.Path)
        strDocName = ActiveDocument.Name
        intPos = InStrRev(strDocName, ".")
        strDocName = Left(strDocName, intPos - 1)
        ChangeFileOpenDirectory tFolder
        Select Case fileType
        Case Is = "TXT"
            strDocName = strDocName & ".txt"
            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatText
        Case Is = "RTF"
            strDocName = strDocName & ".rtf"
            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatRTF
        Case Is = "HTML"
            strDocName = strDocName & ".html"
            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatFilteredHTML
        Case Is = "PDF"
            strDocName = strDocName & ".pdf"

            ' *** Word 2007 users - remove the apostrophe at the start of the next line ***
            'ActiveDocument.ExportAsFixedFormat OutputFileName:=strDocName, ExportFormat:=wdExportFormatPDF

        End Select
        d.Close
        ChangeFileOpenDirectory oFolder
    Next oFile
    Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-29T19:39:51.830

我将介绍一种方法，即使用 VBA 脚本来做你想做的事，而不必使用 Word 内置的“从任何文件中恢复文本”模式功能。

它将一个目录中的每个 .doc/.docx 转换为 .txt，但可用于转换为父应用程序支持的任何其他格式（我使用 Word 2010 进行了测试）。如下：

```
'------------ VBA script start -------------
Sub one1()
Set fs = CreateObject("Scripting.FileSystemObject")
Set list1 = fs.GetFolder(ActiveDocument.Path)
For Each fl In list1.files
  If InStr(fl.Type, "Word") >= 1 And Not fl.Path = ActiveDocument.Path & "\" & ActiveDocument.Name Then
    Set wordapp = CreateObject("word.Application")
    Set Doc1 = wordapp.Documents.Open(fl.Path)
    'wordapp.Visible = True
    Doc1.SaveAs2 FileName:=fl.Name & ".txt", fileformat:=wdFormatText
    wordapp.Quit
  End If
Next
End Sub
'------------ VBA script start ------------- 
```

要另存为 PDF，请使用

```
Doc1.SaveAs2 FileName:=fl.Name & ".pdf", fileformat:=wdFormatPDF 
```

反而

要另存为 RTF，请使用

```
Doc1.SaveAs2 FileName:=fl.Name & ".rtf", fileformat:=wdFormatRTF 
```

反而

或者，比如说，HTML：

```
Doc1.SaveAs2 FileName:=fl.Name & ".html", fileformat:=wdFormatHTML 
```

等等。

我没有费心检查的一些缺点，因为它们是无害的：

*   在执行结束时会弹出一条错误消息，但没有任何后果。

*   它试图打开自己，因为它是文档本身内部的 VBA 脚本，而且它是一个文档打开器脚本。然后，当弹出消息时，您将不得不指示“他”以只读方式手动打开它。

*   它将所有文档保存到 C:\users\username\Documents ，而不是执行它的那个，在大多数情况下会更好。

*   缓慢的过程，预计大多数普通个人计算机的速度为 2-3 个文档/秒。

# ruby-on-rails - 创建与 .build 的关联并解决参数验证问题

> ID：13588382
> 
> 赞同：0
> 
> 时间：2012-11-27T16:13:44.697
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

使用 Rails 3.2.9
我正在尝试使用 .build 而不是 .create 建立关联，但出现密码验证错误，我似乎无法找到解决方法。
评论如下：

我理解的保存项目的方式是使用 .build 构建的关联，在这种情况下，您实际上必须对所有者进行保存。如果您对@item 进行保存，它只会创建项目而不是关联（这意味着它在 current_owner.save 之前不会保存到数据库中）。当我对所有者进行保存时，由于密码不符合验证要求而出现错误。有没有办法在我保存时绕过验证，因为我需要为密码实施不同的解决方案，或者只是停止抱怨并使用 .create 而不是 .build。

下面给出了密码不符合验证错误

```
@item = current_owner.items.build(params[:item])
   if current_owner.save
       Do some other work with item
   end 
```

我想我可以做以下事情（出于某种原因，这对我来说似乎很脏，也许不是。想法？）

```
 @item = current_owner.items.create(params[:item])
 if !@item.nil?
       Do some other work with item
 end 
```

表设置： 所有者：

*   ID
*   姓名
*   加密密码
*   盐

项目：

*   ID
*   姓名

物品所有者：

*   owner_id
*   item_id

楷模：

```
class Item < ActiveRecord::Base
   attr_accessible :description, :name, :owner_ids

   has_many :items_owner
   has_many :owners, :through => :items_owner

end

class Owner < ActiveRecord::Base
   attr_accessor :password
   attr_accessible :name, :password, password_confirmation

   has_many :items_owner
   has_many :items, :through => :items_owner
   before_save :encrypt_password

   validates :password, :presence => true,
        :confirmation => true,
        :length => { :within => 6..40 }
end

class ItemsOwner < ActiveRecord::Base
   attr_accessible :owner_id, :item_id

   belongs_to :item
   belongs_to :owner
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:20:13.577

我不太明白你的问题。希望这可以帮助：

```
@item = current_owner.items.build(params[:item])
if @item.valid?
  # item is valid and ready to save to DB
else
  # item is not valid.
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:25:34.510

您的模型中有密码验证，需要存在密码。你可以做的如下

```
@item = current_owner.items.build(params[:item])
if @item.valid?
   @item.save
  # do stuff what you want
else
  # item is not valid.
end 
```

希望它会有所帮助

# php - mysql/php insert into 什么都不做也没有错误

> ID：13588384
> 
> 赞同：0
> 
> 时间：2012-11-27T16:13:50.580
> 
> 标签：php, mysql, insert

我一直在做一个 MySQL 数据库，现在我开始为它做一些基本的功能；像单行删除、更新等...我的问题是，我的 PHP 文件没有将数据发送到数据库/表。我检查了变量，它们通过表格，但除了一条通知外没有显示错误消息。

我的代码是：

```
$tablanev = $_POST['tablaNev']; 
$oktazon = $_POST['OktAzon'];
$ehaazon = $_POST['EHA'];
$teljnev = $_POST['TeljesNev'];
$szemelyszam = $_POST['Szemelyazon'];
$anyanyelv = $_POST['Anyanyelv'];
$vegzettseg = $_POST['Vegzettseg'];
$anyanev = $_POST['AnyjaNeve'];
$szulhely = $_POST['SzulHe'];
$szulev = $_POST['SzulEv'];
$allampolg = $_POST['Allampolg'];
$neme = $_POST['Nem'];
$adoaz = $_POST['AdoSz'];
$taj = $_POST['TajSz'];
$bszamla = $_POST['BankSz'];

mysql_connect("localhost","root","alma");
mysql_select_db('etr');
mysql_query("INSERT INTO $tablanev(`OktAzonosito`,`EHAazonosito`,`TeljesNev`,`Szemelyazonosito`,`AnyaNyelv`,`VegzettsegSzint`,`AnyjaNeve`,`SzuletesiHely`,`SzuletesiEv`,`Allampolgarsag`,`Neme`,`Adoazonosito`,`TAJszam`,`BankszamlaSzam`) VALUES ('$oktazon','$ehaazon','$teljnev','$szemelyszam','$anyanyelv','$vegzettseg','$anyanev','$szulhely','$szulev','$allampolg','$neme','$taj','$bszamla')");

echo "Az adat sikeresen fel lett véve a táblába!!\n"; 
```

我已经检查了表格的名称，它们非常适合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:18:46.943

尝试设置这样的变量

```
$result = mysql_query("INSERT INTO $tablanev(`OktAzonosito`,`EHAazonosito`,`TeljesNev`,`Szemelyazonosito`,`AnyaNyelv`,`VegzettsegSzint`,`AnyjaNeve`,`SzuletesiHely`,`SzuletesiEv`,`Allampolgarsag`,`Neme`,`Adoazonosito`,`TAJszam`,`BankszamlaSzam`) VALUES ('$oktazon','$ehaazon','$teljnev','$szemelyszam','$anyanyelv','$vegzettseg','$anyanev','$szulhely','$szulev','$allampolg','$neme','$taj','$bszamla')");

if (!$result) {
    die('Invalid query: ' . mysql_error());
} 
```

顺便说一句，您应该使用 MySQLi 或 PDO_MySQL 扩展，不鼓励使用您正在使用的扩展。

参考： http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

编辑：您错过了查询中的一个参数，正确的是：

```
"INSERT INTO $tablanev(`OktAzonosito`,`EHAazonosito`,`TeljesNev`,`Szemelyazonosito`,`AnyaNyelv`,`VegzettsegSzint`,`AnyjaNeve`,`SzuletesiHely`,`SzuletesiEv`,`Allampolgarsag`,`Neme`,`Adoazonosito`,`TAJszam`,`BankszamlaSzam`) VALUES ('$oktazon','$ehaazon','$teljnev','$szemelyszam','$anyanyelv','$vegzettseg','$anyanev','$szulhely','$szulev','$allampolg','$neme',' $adoaz','$taj','$bszamla')" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:19:51.350

您应该捕获错误以查看发生了什么：

```
 mysql_query("INSERT INTO $tablanev(`OktAzonosito`,`EHAazonosito`,`TeljesNev`,`Szemelyazonosito`,`AnyaNyelv`,`VegzettsegSzint`,`AnyjaNeve`,`SzuletesiHely`,`SzuletesiEv`,`Allampolgarsag`,`Neme`,`Adoazonosito`,`TAJszam`,`BankszamlaSzam`) VALUES ('$oktazon','$ehaazon','$teljnev','$szemelyszam','$anyanyelv','$vegzettseg','$anyanev','$szulhely','$szulev','$allampolg','$neme','$taj','$bszamla')") or die("Error: ".mysql_error()); 
```

# php - Google Analytics API - 取回许多页面的页面浏览量

> ID：13588388
> 
> 赞同：0
> 
> 时间：2012-11-27T16:14:00.177
> 
> 标签：php, cakephp, google-analytics

我正在尝试在 (Cake)PHP 中为 Google Analytics 编写一个自定义 API 查询，该查询将为一组（可能很多）页面取回过去 12 个月的页面视图。

这是我到目前为止所得到的：

```
$metrics = "ga:pageviews";

$params = array(
    'dimensions'=>'ga:date',
    'filters'=>'ga:pagePath==/enquires/add/200,ga:pagePath==/enquires/add/201',
    'sort'=>'ga:date',
    'max-results'=>366
);

$startDate = date('Y-m-d', time()-60*60*24*365);
$endDate = date('Y-m-d', time());

$data = $this->service->data_ga->get('ga:' . $profileId, $startDate, $endDate, $metrics, $params); 
```

...适用于几个 pagePath 过滤器，但不幸的是，我用来过滤我想要的页面的过滤器参数限制为最多 128 个字符。

如果我有很多要在报告中使用的网址（比如 50 个，但可能更多），我如何让谷歌分析来过滤它们？

我试过想出一个正则表达式，但这仍然太长了。

我考虑过询问*每一*页（或正则表达式 /enquires/add/* ），然后过滤掉我正在寻找的那些，但这感觉像是错误的做事方式。

如何将一长串过滤器传递给 Google Analytics API？还是有其他方法？

（顺便说一句，这是针对房产网站的，这些报告是供业主查看房产被查看的频率，因此需要仅限于他们的房产页面网址）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:32:39.567

我不太喜欢 Google Analytics API，但如果该 API 不起作用，这将是我解决问题的方法：

*   如果财产所有者的数量“有限”，最简单的解决方案是将他们作为用户添加到他们应该有权访问的 Google Analytics 资产中——根本不需要编程。
*   也许您应该重新考虑您的 Google Analytics（分析）资产的布局方式。例如，您可以为每个业主创建一个唯一的跟踪代码，从而有效地摆脱过滤。

如果这些方法对您不起作用，我只需提取所有可用数据，以最适合生成输出的格式将它们存储在本地，然后过滤该本地数据集。根据您想要使其复杂程度，您可以查看 ETL 工具以简化导入和预处理/过滤。

# php - 运行 curl_multi_init() 并重用 cookie

> ID：13588390
> 
> 赞同：0
> 
> 时间：2012-11-27T16:14:05.547
> 
> 标签：php, cookies, curl

**您好** ，我不会使用 curl_multi_init()，首先登录到一个网站并获取该 cookie，然后在下一个站点使用它，仍然使用 curl_multi_init()。

我已经为此搜索了一段时间并尝试了许多不同的东西。我现在得到了这个代码，但它不是第二次使用 cookie。

```
curl_setopt($login, CURLOPT_HEADER, 0);
curl_setopt($login, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt($login, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.13 (KHTML, like Gecko) Chrome/24.0.1284.0 Safari/537.13"); 
curl_setopt($login, CURLOPT_TIMEOUT, 60); 
curl_setopt($login, CURLOPT_FOLLOWLOCATION, 1); 
curl_setopt($login, CURLOPT_RETURNTRANSFER, TRUE); 
curl_setopt($login, CURLOPT_COOKIEJAR, $cookieFile); 
curl_setopt($login, CURLOPT_COOKIEFILE, $cookieFile); 
curl_setopt($login, CURLOPT_REFERER, $loginURL); 
curl_setopt ($login, CURLOPT_POSTFIELDS, $postData); 
curl_setopt ($login, CURLOPT_POST, 1); 

curl_setopt($getByDate, CURLOPT_SSL_VERIFYPEER, 0); 
curl_setopt($getByDate, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.13 (KHTML, like Gecko) Chrome/24.0.1284.0 Safari/537.13"); 
curl_setopt($getByDate, CURLOPT_TIMEOUT, 60); 
curl_setopt($getByDate, CURLOPT_FOLLOWLOCATION, 0); 
curl_setopt($getByDate, CURLOPT_RETURNTRANSFER, true); 
curl_setopt($getByDate, CURLOPT_BINARYTRANSFER, true);
curl_setopt($getByDate, CURLOPT_COOKIEJAR, $cookieFile); 
curl_setopt($getByDate, CURLOPT_COOKIEFILE, $cookieFile); 
curl_setopt($getByDate, CURLOPT_REFERER, "https://www.elevplan.dk/Moduler/Elevforside/Elevforside.aspx"); 

//create the multiple cURL handle
$mh = curl_multi_init();

//add the two handles
curl_multi_add_handle($mh,$login);
curl_multi_add_handle($mh,$getByDate);

$running = null;
    do {
        curl_multi_exec($mh, $running);
    } while ($running); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:22:15.377

您必须使用同步请求，因为您希望以特定顺序执行请求。cURL multi 导致它同时下载两个页面（或第二个请求在第一个请求之前完成）。第二个请求必须在第一个请求完成后执行。

# solr - Solr 4 主机端口和上下文信息（ZooKeeper Base URL）设置

> ID：13588392
> 
> 赞同：1
> 
> 时间：2012-11-27T16:14:16.640
> 
> 标签：solr, solrj, apache-zookeeper, solrcloud

我正在尝试从 Solr 4-Beta 升级到 Solr 4。在使用 Solr 4-beta 时，我在 Solr.xml 文件中配置了主机和端口号，如下所示，一切正常。

```
<solr persistent="true">
  <cores host="xxx.xx.x.xxx" adminPath="/admin/cores" hostPort="8180" hostContext="solr4" sharedLib="lib">
  </cores>
</solr> 
```

但是当我升级到 Solr 4.0 时，ZooKeeper 基本 URL 被设置为“http://Computer-name:8983/Solr”，这在联系其他节点时会引发以下异常。由于某种原因，ZooKeeper 初始化没有从 Solr.xml 中选择主机和端口信息，而是获取默认的 Solr 端口和上下文信息。有人可以帮忙纠正这个 ZooKeeper 的 base_url 吗？

```
SEVERE: Error while trying to recover. core=collection1:org.apache.solr.client.solrj.SolrServerException: IOException occured when talking to server at: http://ComputerName:8983/solr
    at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:413)
    at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:181)
    at org.apache.solr.cloud.RecoveryStrategy.sendPrepRecoveryCmd(RecoveryStrategy.java:199)
    at org.apache.solr.cloud.RecoveryStrategy.doRecovery(RecoveryStrategy.java:388)
    at org.apache.solr.cloud.RecoveryStrategy.run(RecoveryStrategy.java:220)
Caused by: java.net.UnknownHostException: COMPUTER-NAME
    at java.net.Inet6AddressImpl.lookupAllHostAddr(Native Method)
    at java.net.InetAddress$1.lookupAllHostAddr(InetAddress.java:849)
    at java.net.InetAddress.getAddressFromNameService(InetAddress.java:1202)
    at java.net.InetAddress.getAllByName0(InetAddress.java:1153)
    at java.net.InetAddress.getAllByName(InetAddress.java:1083)
    at java.net.InetAddress.getAllByName(InetAddress.java:1019)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.resolveHostname(DefaultClientConnectionOperator.java:242)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:130)
    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:150)
    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:575)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:425)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:732)
    at org.apache.solr.client.solrj.impl.HttpSolrServer.request(HttpSolrServer.java:352)
    ... 4 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T08:43:58.520

您的 solr.xml 配置看起来不错。除了`sharedLib="lib"`sharedLib 属性属于 tag `<solr persistent="true" sharedLib="lib">`。

例外`Caused by: java.net.UnknownHostException: COMPUTER-NAME`

请确保以下几点：

1)`zkHost`参数中提供的 ZooKeeper 主机名映射到`hosts`文件中

```
-DzkHost=COMPUTER-NAME:2181,localhost:2182,localhost:2183 
```

主机文件定义

```
127.0.0.1    localhost
xxx.xxx.xxx.xxx     COMPUTER-NAME 
```

2）更新`solr.xml`存在于正确的路径`SOLR_HOME`

# php - PHP MySQL查询错误

> ID：13588396
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:14:29.023
> 
> 标签：php, mysql

我的 PHP/SQL 代码有问题。我已经尝试了很多并用谷歌搜索，但我找不到我在代码中犯了哪个错误。

我不能在这里粘贴我的代码，出了点问题，所以我把它粘贴在这里

[http://pastebin.com/P1Mur3Gv](http://pastebin.com/P1Mur3Gv)

```
$absentbijwerken = mysql_query("UPDATE hw_absentieregistratie SET '$currentweekandday' = '$aanwezigheid[$i]' WHERE userid = '$userid[$i]'")
or die(mysql_error());  
$absentredenbijwerken = mysql_query("UPDATE hw_absentiereden SET '$currentweekandday' = '$reden[$i]' WHERE userid = '$userid[$i]'")
or die(mysql_error()); 
```

两个查询都会出错。

> MySQL 错误 1064：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '-Dinsdag = 'pr' WHERE userid = '1'' 附近使用正确的语法“您的 SQL 语法有错误；请查看对应的手册您的 MySQL 服务器版本，以便在第 1 行的 '-Dinsdag = 'xd' WHERE userid = '1'' 附近使用正确的语法

编辑：

引号是问题所在，新代码如下所示：

```
for ( $i = 0; $i < count($userid); $i++){
$absentbijwerken = mysql_query("UPDATE hw_absentieregistratie SET `$currentweekandday` = '$aanwezigheid[$i]' WHERE userid = '$userid[$i]'") 
or die(mysql_error());  
$absentredenbijwerken = mysql_query("UPDATE hw_absentiereden SET `$currentweekandday` = '$reden[$i]' WHERE userid = '$userid[$i]'") 
or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:17:11.307

用反引号将查询中的列名括起来：

```
$absentbijwerken = mysql_query("UPDATE hw_absentieregistratie SET `$currentweekandday` = '$aanwezigheid[$i]' WHERE `userid` = '$userid[$i]'")
or die(mysql_error());  
$absentredenbijwerken = mysql_query("UPDATE hw_absentiereden SET `$currentweekandday` = '$reden[$i]' WHERE `userid` = '$userid[$i]'")
or die(mysql_error()); 
```

似乎传入的值`$currentweekandday`包含 a `-`，MySQL 将其解释为运算符，它不适合该位置。

^(`mysql_X`方法已弃用。切换到[PDO](http://php.net/PDO)或[mysqli](http://php.net/mysqli)！)

# java - 在Java中按升序对整数数组进行排序

> ID：13588398
> 
> 赞同：4
> 
> 时间：2012-11-27T16:14:32.233
> 
> 标签：java, sorting

如何在Java中按升序排列整数数组？我有类和 Pilha.java Ordenacao.Java，但程序不工作。

### Pilha.java

```
package lista03Pilhas;

public class Pilha {

    // indica qual o tamanho maximo da pilha (tamanho maximo do vetor)
    private int tamanhoMaximo;
    // indica o topo da pilha (quantidade de itens do vetor)
    private int topo;
    // cria o vetor que ira implementar a pilha
    private Object[] vetorPilha;
    // construtor que recebe como parametro o tamanho da pilha (tamanho do vetor)

    public Pilha(int length) {
        // indica o tamanho da pilha (vetor)
        tamanhoMaximo = length;
        // instancia o vetor com o tamanho informado
        vetorPilha = new Object[length];
        // faz com que o apontador do topo indique que não há elementos na pilha
        topo = -1;
    }

    // funcao que insere um objeto no topo da pilha
    public void push(Object obj) {
        // incrementa o topo (desloca para cima)
        topo++;
        // coloca o novo objeto na pilha
        vetorPilha[topo] = obj;
    }

    // funcao que remove um objeto do topo da pilha
    public Object pop() {

        // verifica se a pilha esta vazia
        if (topo < 0) {
            return null;
        } else {

            // obtem o objeto do topo da pilha
            Object auxiliar = vetorPilha[topo];

            // decrementa o topo (desce um item na pilha)
            topo--;

            // retorna o elemento do topo da pilha
            return auxiliar;
        }
    }

    // funcao que verifica quem esta no topo da pilha
    public Object top() {

        // verifica se a pilha esta vazia
        if (topo < 0) {
            return null;
        } else {
            return vetorPilha[topo];
        }
    }

    // verifica se a pilha esta vazia
    public boolean isEmpty() {

        // verifica se o topo aponta para algum indice valido do vetor
        if (topo == -1) {
            return true;
        } else {
            return false;
        }
    }

    // verifica se a pilha esta cheia
    public boolean isFull() {

        // verifica se o topo aponta para o ultimo elemento do vetor
        if (topo == tamanhoMaximo - 1) {
            return true;
        } else {
            return false;
        }
    }
} 
```

### Ordenacao.java

```
package lista03Pilhas;

public class Ordenacao {

    public static int[] ordenarDecrescente(int v[]) {
        Pilha minhaPilha = new Pilha(v.length);
        recebePilha(minhaPilha);
        int vetor[] = new int[v.length];
        for (int i = 0; i < v.length; i++) {
            vetor[i] = v[i];
            minhaPilha.push(vetor[i]);

        }
        int u = ((Integer) minhaPilha.pop()).intValue();
        return vetor;
    }

    public static void recebePilha(Pilha pilha){

    }
} 
```

### 主.java

```
package lista03Pilhas;

import java.util.Arrays;
import java.util.Scanner;

public class Lista03Pilhas {

    public static void main(String[] args) {
        int v[] = new int[]{100, 20, 15, 9, 8, 7, 1};
        System.out.println("Vetor:" + Arrays.toString(Ordenacao.ordenarDecrescente(v)));

        int p;
        int m;

        Scanner ent = new Scanner(System.in);
        int[] ordenarDecrescente = Ordenacao.ordenarDecrescente(v);
        Pilha minhaPilha = new Pilha(v.length);
        for (int i = 0; i < v.length; i++) {
            minhaPilha.push(v[i]);
            Object menor = minhaPilha.pop();
            System.out.print(minhaPilha.pop());
        }
        System.out.println("");
        for (int i = 0; i < v.length; i++) {
            System.out.print(v[i] + " ");
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T16:15:50.680

> 如何在Java中按升序排列整数数组？

通过使用[`Arrays.sort()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28int%5B%5D%29)：

```
int[] arr = ...;
Arrays.sort(arr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:15:50.743

好吧，您始终可以使用`Arrays.sort()`适当的`Comparator`. 默认比较器按升序工作，因此只需使用[此](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28int%5b%5d%29)方法即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-18T05:30:40.597

Java 使用快速排序对原始类型进行排序，使用归并排序对对象进行排序，我认为使用 Arrays.sort() 对数组进行排序很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:32:23.757

I thing you are looking for something like the Bubble algorithm...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-19T10:52:49.387

您可以简单地使用 java.lang 类的“Array.sort()”方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-15T08:16:22.257

您可以使用[Arrays.sort(int[] a)](https://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort(int[]))。

在 Java 6 中，用于此方法的排序算法是
**Tuned quicksort**，改编自 Jon L. Bentley 和 M. Douglas McIlroy 的“Engineering a Sort Function”，Software-Practice and Experience，Vol。23(11) P. 1249-1265（1993 年 11 月）。

在 Java 7 和 8 中，用于此方法的排序算法是Vladimir Yaroslavskiy、Jon Bentley 和 Joshua Bloch的
**Dual-Pivot Quicksort 。**

# jsf - JSF 的 ui:include 没有按预期工作

> ID：13588399
> 
> 赞同：0
> 
> 时间：2012-11-27T16:14:38.577
> 
> 标签：jsf, jsf-2, facelets

我有一个使用 PrimeFaces 创建的对话框，如下所示：

```
<h:body>
    <ui:composition>
    <h:form id="newResource">
        <p:dialog 
            id="modalDialog" 
            header="Create a new Resource" 
            widgetVar="dlg2" 
            modal="true" 
            visible="true">  
            ...
        </p:dialog>
    </h:form> 
    </ui:composition> 
```

在我希望显示此内容的页面中，我有以下代码。最后一行是我包含对话框的地方。

```
 <h:body>
    <p:growl id="growl" showDetail="true" sticky="true" />
    <ui:composition template="/template/masterLayout.xhtml">
        <ui:define name="windowTitle">
            Resources
        </ui:define>
        <ui:define name="stack">
            <p:stack 
                id="dvStackMenu" 
                expanded="true" 
                icon="/resources/images/stack/stack.png" 
                model="#{resourcePageController.stackMenuModel}"/>
        </ui:define>
        <ui:define name="content">
            <h:form>
                <p:dataTable 
                    var="resc" 
                    rowKey="#{resc.resourceId}"
                    selection="#{resourcePageController.selectedResources}"
                    value="#{resourcePageController.resources}"
                    selectionMode="multiple">  
                    <p:column headerText="Name">  
                        <h:outputText value="#{resc.name}" />  
                    </p:column>
                    <p:column headerText="Created On">  
                        <h:outputText value="#{resc.createdOn}" />  
                    </p:column>
                    <p:ajax event="rowSelect"/>
                    <p:ajax event="rowUnselect" />
                </p:dataTable> 
            </h:form>
        </ui:define>
    </ui:composition>
    <ui:include src="/template/dialog/create/resource.xhtml" />
</h:body> 
```

对话框的可见属性设置为 true，因此预期的行为是当页面加载时，应该显示对话框。然而事实并非如此。

如果我`/template/dialog/create/resource.xhtml`在浏览器中导航到，对话框将按预期显示。

任何人都可以帮助我解决正在发生的事情吗？我不确定这是我使用 ui:include 还是发生了其他事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:22:10.020

当 的 内容`<ui:composition>`用它的 修饰时`template`， 之外的所有内容都将`<ui:composition>`被忽略。

因此，您需要将您的包含放在`<ui:define>`s 之一中。

# ios - Paperclip 使用 base64 照片引发 NoHandlerError

> ID：13588403
> 
> 赞同：0
> 
> 时间：2012-11-27T16:14:56.120
> 
> 标签：ios, ruby-on-rails, api, paperclip

从回形针 2 升级到回形针 3 时，我的图像上传 API 刹车。此代码曾经工作：

```
def decode_cover_image_data(cover_image_data)
    data = StringIO.new(Base64.decode64(cover_image_data))
    data.class.class_eval { attr_accessor :original_filename, :content_type }
    data.original_filename = "cover.png"
    data.content_type = "image/png"

    self.photo = data
end 
```

它现在引发 NoHandleError 异常：

> “Paperclip::AdapterRegistry::NoHandlerError（未找到“/9j/4AAQD/4Q[...]wooooGf/9k=”的处理程序

有人遇到过这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T07:31:10.847

我发现问题出在哪里，这很愚蠢......

在我的控制器更新方法中，我有类似的东西：

```
 def update
    ...
    if p[:photo]
      @user_ipad.decode_cover_image_data(p[:photo])
    end

    unless @user_ipad.update_attributes(p)
      render :json => {:errors => @user_ipad.errors}
    end
  end 
```

问题是我将用户照片设置了 2 次：

*   一旦进入@user_ipad.decode_cover_image_data(p[:photo])
*   一旦进入@user_ipad.update_attributes(p)

使用 update_attributes 保存 base64 字符串（仍在参数中）时发生崩溃。实际上让我感到惊讶的是，这段代码适用于 Paperclip 2.4.5 ...

升级到 Paperclip 3.3.1 后，我通过用以下方式替换我的更新方法解决了我的问题：

```
 def update
    ...
    if p[:photo]
      p[:photo] = @user_ipad.decode_cover_image_data(p[:photo])
    end

    unless @user_ipad.update_attributes(p)
      render :json => {:errors => @user_ipad.errors}
    end
  end 
```

# c# - Azure 服务总线：代理主题订阅侦听器

> ID：13588404
> 
> 赞同：1
> 
> 时间：2012-11-27T16:14:57.857
> 
> 标签：c#, azure, proxy, .net-4.5, azureservicebus

# 背景

有一个 RESTful API 提供了一些操作。此 RESTful API 由第三方使用，这些第三方必须在平台中进行身份验证和授权才能访问 API 的操作。

**第三方需要可靠的数据消费**，API必须提供基于*发布者/消费者*模式的解决方案来消费部分数据。

由于*所谓的*API 不会重新发明轮子，它即将使用***Windows Azure Service Bus***。

# 问题

RESTful API 应该抽象出实际的*服务总线*服务。另一方面，**Service Bus 是在自己的平台中提供可靠消息传递的解决方案**。

实际上，Service Bus 不是一个独立的服务，而是一些工作流的一部分。**第三方不应拥有 Windows Azure 凭据**。

第三方应使用特定于 API 的凭据连接到 Windows Azure 服务总线，该凭据可以访问服务总线的主题（即*消息队列*）。

# 可能的解决方案

> > ## 一个。*授权直接访问 Windows Azure 服务总线*
> > 
> > > 这似乎是最简单的解决方案。让我们看看流程：
> > > 
> > > > 1.  *第三方向 RESTful API 发送请求，以获取 Windows Azure 服务总线连接字符串 - 凭据 -*。
> > > > 2.  *一旦有了连接字符串，第三方就会连接到 Windows 服务总线并开始从某个主题订阅接收消息。注意：连接字符串在服务器端加密，只能由接受的客户端解密。*
> > > 
> > > **优点**
> > > 
> > > > *   简单的。API 授权第三方使用 Windows Azure 服务总线，它没有其他责任。
> > > > *   自己的 API 不管理主题订阅者的高负载：这是由 Windows Azure 平台处理的。
> > > 
> > > **缺点**
> > > 
> > > > *   第三方与 Windows Azure 密切相关。
> > > > *   第三方可以轻松绕过 RESTful API 一段时间。
> > 
> > ## 湾。*代理访问 Windows Azure 服务总线*
> > 
> > 这有可能吗？整个流程将是：
> > 
> > > > 1.  *第三方请求一个类似于 RESTful 的 TCP API，以便订阅某些 Windows Azure 服务总线主题。*
> > > > 2.  *TCP API 建立连接并创建代理，以便将 TCP API 连接到服务总线 I/O 镜像到 TCP API 到第三方。*
> > > > 3.  *现在第三方连接到代理并发送和接收消息*。
> > > 
> > > **优点**
> > > 
> > > > *   第三方通过代理连接，这意味着他们不拥有任何 Windows Azure 凭据，也无法绕过 TCP 或 RESTful API。
> > > > *   消息传递不再完全依赖于 Windows Azure。
> > > 
> > > **缺点**
> > > 
> > > > *   如果 Windows Azure 服务总线关闭连接会发生什么？
> > > > *   如果平台代理出现故障会发生什么？
> > 
> > ## C。*Windows Azure 服务总线服务器包装器*
> > 
> > 这是定义和流程：
> > 
> > > > 1.  *RESTful API 服务器具有 Windows Azure 服务总线订阅连接池*。
> > > > 2.  *第三方订阅了 API 服务器的 TCP 套接字或 WebSocket*。
> > > > 3.  *每当 Windows Azure 服务总线有消息时，它都会被路由到第三方连接池，第三方会收到消息*。
> > > > 4.  *第三方使用 RESTful API 发送消息*。
> > > 
> > > *优点*
> > > 
> > > > *   第三方完全不知道服务总线技术。
> > > 
> > > *缺点*
> > > 
> > > > *   与*b 相同。*方法。

# 问题

*   是*b。*方法可能吗？

*   *你对c*有什么建议。*Windows Azure 服务总线服务器包装器*。您是否发现在正常运行时间和 Windows Azure 服务总线与 API 和 API 与第三方同步方面的可靠性越低，这是一场*可以避免的战争？*

*   我错了，这些方法还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T09:34:45.123

最后，我选择了**选项 a。**：**授权直接访问 Windows Azure 服务总线。**

这是使用*Windows Azure 访问控制服务*。

使用这种方法，第三方会收到一个 Azure 服务总线连接字符串，其中包含对某些主题具有特定权限的颁发者（身份）。例如：“消费者只能听”。

有关此的更多详细信息：

*   [http://www.windowsazure.com/en-us/develop/net/how-to-guides/access-control/](http://www.windowsazure.com/en-us/develop/net/how-to-guides/access-control/)

# sql - 1-N 映射表中的 SQL AND 和 OR

> ID：13588408
> 
> 赞同：0
> 
> 时间：2012-11-27T16:15:12.517
> 
> 标签：sql

> **可能重复：**
> [MySQL 选择连接位置和位置](https://stackoverflow.com/questions/5017680/mysql-select-join-where-and-where)

好吧，我有一张桌子-

```
 id  map_id     
 -----------
 100   1
 100   2
 101   1
 101   2
 101   3
 102   3 
```

现在，我需要对这些数据进行 AND 和 OR 操作。那是，

或 - 我必须获取 map_id 为 1 或 3 的所有行的 id。因此，如果我查找 1 或 3，则查询应返回

> ```
>  100
>    102 
> ```

我可以简单地做到这一点

> 从 map_id IN (1,3) 的表中选择 id

AND - 如果我查询 1 和 2，那么我想要 ids 100 和 101。而且，我无法找到查询。

我最初认为像这样的简单查询应该可以工作，但我错了。

> 从 map_id = 1 AND map_id = 2 的表中选择 id [不起作用]

我想得到这样的结果，但我的查询没有给我这个。我不想诉诸子查询或连接，好吧，除非我真的不需要。我尝试按 id 分组并使用不同的有子句，但我找到了一个解决方案。

> ```
>  100
>    101 
> ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:20:54.943

试试这个

```
select id 
from yourtable
where map_id IN (1,2)
group by id
having COUNT(distinct map_id)=2 -- where this 2 is the number of items you want to find 
```

这种技术称为关系划分。

# mysql - 按星期几分组销售

> ID：13588409
> 
> 赞同：3
> 
> 时间：2012-11-27T16:15:15.900
> 
> 标签：mysql, sql

我有一张看起来像这样的桌子

```
sell_price double        buy_price double      time int(11)
31.5                     20.5                  1353755931 (2012-11-27)
20                       10.5                  1353755235 (2012-11-27)
40                       30                    1353752531 (2012-11-26)
50                       25                    1353751237 (2012-11-26)
40                       10                    1353745609 (2012-11-25) 
```

我正在尝试对所有值进行分组以获得一周中每一天的销售额，所需的表格应如下所示：

```
sell_price double        buy_price double      time int(11)
51.5                     30.5                  1353755931 (2012-11-27)
90                       55                    1353755931 (2012-11-26)
40                       10                    1353755931 (2012-11-25) 
```

我尝试了以下查询，但我似乎遇到了分组问题

```
SELECT sell_price, buy_price, time 
FROM sales 
GROUP BY DAY(time) 
ORDER BY time DESC 
```

上面的查询只返回 1 行

```
31.5       20.5      1353755931 
```

实现这一目标的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:28:56.323

```
SELECT DATE(FROM_UNIXTIME(time)) time,
       SUM(sell_price),
       SUM(buy_price)
FROM tableName
GROUP BY DATE(FROM_UNIXTIME(time)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:39:10.537

正如你从[这个小提琴](http://sqlfiddle.com/#!2/273ef/1)中看到的，

```
SELECT
            sell_price,
            buy_price,
            time,
            day(time)
    FROM
        sales 
```

`day(time)`计算结果为`null`并且，因为您没有为价格指定任何聚合函数，所以您只获得了所有内容的第一行。

如果你检查[这个小提琴](http://sqlfiddle.com/#!2/273ef/8)。

```
SELECT
            sell_price,
            buy_price,
            date(from_unixtime(time))
    FROM
        sales; 
```

您会看到所有数据都在同一天，假设这些数字是有效的 unix 时间。

# c# - 避免使用 if/then/else 语句的面向对象设计模式

> ID：13588424
> 
> 赞同：6
> 
> 时间：2012-11-27T16:16:07.123
> 
> 标签：c#, oop, design-patterns

因为我对 OOP / C# 比较陌生，所以我不知道解决这个问题的正确模式：

我必须为不同的 IO 提供者构建一个插件架构。主机从配置中读取所需的提供者名称/类型，然后应该将提供者实例化并参数化。

所以我基本上有这个接口：

```
public interface IoProvider //(Base interface, all Providers implements this)
{
    void Initialize();
    void Execute();
}

public interface IFileProvider: IoProvider
{
    string PropertyA { get; set; }
}

public interface ISmtpProvider : IoProvider
{
    string PropertyB { get; set; }
    string PropertyC { get; set; }
} 
```

如您所见，派生的专用 IO 提供程序具有基本接口所没有的不同附加参数属性。为了**避免 if/then/else 或 switch 语句**，我的想法是使用工厂模式。

但是，如果我正确理解这一点，它并不能解决我的 if/then/else 问题，因为在客户端上我必须检查派生类型以提供正确的参数。

所以主机上的程序流程是这样的：主机读取配置，获取所需提供者的名称/类型主机调用工厂并获取提供者

但是如何避免这种情况——有没有一种模式可以在没有 if/then/else 的情况下解决这个问题？

```
If (provider == typeOf(IFileProvider))  
PropertyA = value  
else if (provider == typeOf(ISmtpProvider))  
PropertyB = value  
PropertyC = value  
Elseif … 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T16:24:29.607

您可以`switch`用多态性替换语句。只允许每个提供者从 config.xml 配置自己。这是一个最佳选择，因为每个提供者都知道要查找哪些值：

```
provider.Configure(); 
```

此方法应存在于基本接口中：

```
public interface IoProvider 
{
    void Initialize();
    void Execute();
    void Configure();
} 
```

每个提供者都实现它：

```
public interface ISmtpProvider : IoProvider
{
    string PropertyB { get; set; }
    string PropertyC { get; set; }

    public void Configure()
    {
        PropertyB = ConfigurationManager.AppSettins["B"];
        PropertyB = ConfigurationManager.AppSettins["C"];
    }
} 
```

这种方法的主要好处是您只有一个地方可以更改，当新的提供者添加到您的应用程序时 - 只需添加新的提供者类，它知道如何配置自己。您也不需要更改主机实现。并且您的主机将满足 OCP 原则 - 对扩展开放（您可以添加新提供者），但对修改关闭（添加新提供者时您无需修改​​现有代码）。

您还可以将一些配置对象传递`Configure(IConfiguration config)`给此方法（它将使您的代码可测试，而不依赖于 static `ConfigurationManager`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:25:03.463

如果您一心想摆脱 if/else 语句，那么您可以在基类中拥有一个加载器，将所有参数传递给该加载器，然后让每个类重载它，并且只使用它们的参数需要。

**只有**当你的所有派生类都保证使用相同的小参数集合时，我才会认为这是一个理想的模式，只是以不同的方式。否则，`if`/`else`语句可能是可取的

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-27T16:25:59.010

最后，您总是不得不使用条件语句。

当然，您可以使用一些库来抽象它。例如依赖注入库，并且基于某些构造函数，您可以在没有 if 的情况下执行此操作。

但...

它真的不值得，你会给你的代码增加很多复杂性，只是为了让它更优雅，而且通常不值得权衡。

这并不是说你不能做得更好。从臀部射击，我会在界面中添加这样的方法。

void Init(Dictionary parameters)，并在每个实现中从字典中读取并初始化所需的属性

# c - 从缓冲区分配不同的内存块

> ID：13588432
> 
> 赞同：0
> 
> 时间：2012-11-27T16:16:26.940
> 
> 标签：c, memory, struct, malloc, buffer

初学者在这里。是否可以获得缓冲区，例如：

```
char buffer[1024]; 
```

并使用 malloc 将其拆分为更小的内存块（随机大小取决于用户输入），直到缓冲区中没有更多空间？例如：第 1 块 = 16、第 2 块 = 256、第 3 块 = 32 等。直到达到 1024。我还想为创建的每个块创建一个结构。我正在使用普通的C。

尽管我不确定我是否能做到这一点，但我已经开始了一些事情：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
int main(void)
{
    int x = 0;

    printf("Enter size of block to be allocated: ");
    scanf("%d", &x);
    /*(need to implement): call the following function until there's no more
    space left in the buffer*/
    allocate(x);

    return 0;
}

void *allocate(size_t size)
{
    char buffer[1024];
    char *block;
    /*The following allocates a block with the size of the user input.
    How do I associate it with the buffer?*/
    block = (char *) malloc(size + 1);

    //Creates a structure. How do I create one for every block created?
    typedef struct blk_struct
    {
        int data;
        struct blk_struct *size_blk;
        struct blk_struct *next;
    }blk_struct;
    blk_struct *first;
} 
```

我做过的研究：Google 和 SO。两者都找不到任何东西。也许我没有在寻找正确的关键词？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:19:35.360

Malloc 使用自己的内部内存管理，因此它不会从您提供的内存中进行子分配。

有许多可用的 malloc 实现（谷歌“malloc 替代方案”）提供针对各种用例（嵌入式、多处理器、调试）优化的内存管理策略。您很可能会找到一个现有的解决方案来解决您试图通过这个问题解决的潜在问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:22:04.497

编写你自己的函数，它的作用与`malloc`malloc 已经有它自己的实现一样，所以它不会从你分配的缓冲区中占用内存。

它总是从堆中分配内存

您可以像这样编写自己的函数：

```
char buffer[1024];// fixed size buffer
int freeindex; // global variable or make it static to keep track of allocated memory
char* mem_alloc(size_t size)
{
 if(freeindex == 1023 || (freeindex + size ) > 1023)
  return NULL;
 char * ret_addr = &buffer[freeindex];
 freeindex+=size;
 return ret_addr;
} 
```

请记住，您必须编写`mem_free()`自己的`free()`函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:27:44.883

您可以为此[http://www2.research.att.com/~gsf/download/ref/vmalloc/vmalloc.html使用出色的 Vmalloc](http://www2.research.att.com/~gsf/download/ref/vmalloc/vmalloc.html)

下载链接[http://www2.research.att.com/~gsf/cgi-bin/download.cgi?action=list&name=vmalloc](http://www2.research.att.com/~gsf/cgi-bin/download.cgi?action=list&name=vmalloc)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T17:48:02.250

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define BUFFER_SIZE    1024

//Creates a structure. How do I create one for every block created?
typedef struct blk_struct
{
    char *dataptr;
    int start_blk, size_blk;
    struct blk_struct *prev;
    struct blk_struct *next;
}blk_struct;

char buffer[BUFFER_SIZE];

blk_struct *first = NULL;
blk_struct *last = NULL;

int main(void)
{
    int x = 0;
    int *a;
    char *b;

    printf("Enter size of block to be allocated: ");
    scanf("%d", &x);
    /*(need to implement): call the following function until there's no more
    space left in the buffer*/
    a = allocate(sizeof(int) * 10);
    b = allocate(sizeof(char) * 10);

    return 0;
}

void *allocate(size_t size)
{
    blk_struct *block;

    /* checking for required memory */
    if (((last->dataptr + last->size_blk + size) - buffer) > BUFFER_SIZE)
        return NULL; /* Memory Full */

    /*The following allocates a block with the size of the user input.
    How do I associate it with the buffer?*/
    block = malloc(sizeof(blk_struct));

    /* Changing the first and last block */
    if (first) {
        /* Filling Block Info */
        block->dataptr = buffer;
        block->start_blk = 0;
        block->size_blk = size;
        block->prev = NULL;
        block->next = NULL;

        first = block;
        last = block;
    }
    else {
        /* Filling Block Info */
        block->dataptr = last->dataptr + last->size_blk;
        block->start_blk = last->start_blk + last->size_blk;
        block->size_blk = size;
        block->prev = last;
        block->next = NULL;

        last->next = block;
        last = block;
    }

    return block->dataptr;
} 
```

我希望这有帮助....，

# aem - 用于在多个路径中搜索内容的查询字符串，使用 SQL2

> ID：13588435
> 
> 赞同：0
> 
> 时间：2012-11-27T16:16:28.060
> 
> 标签：aem, jcr-sql2

目前我被困在生成具有多个路径的查询的问题上。我可以完成从crx 存储库中的特定*单个*根路径搜索子节点的情况。我为此使用关键字`isdecendantnodenode()`：

```
select * from [nt:base] as p
where
   (isdescendantnode (p, [first path])) 
   and contains(p.*, '"bankproducts"')
   and p.[sling:resourceType] = 'components/content/download' 
```

正如我所说，这很好用。现在我必须面对挑战，搜索确实出现在*两个或多个*不同子节点中的元素 - 在同一层次结构级别中。

我实现这一目标的尝试如下：

```
select * from [nt:base] as p
where
   (isdescendantnode (p, [first path]) and isdescendantnode(p, [second path]))
   and contains(p.*, '"bankproducts"')
   and p.[sling:resourceType] = 'components/content/download' 
```

这仅给了我返回它们仅在第二条路径中的元素（在我看来）。

下一个示例导致存储库异常：

```
select * from [nt:base] as p
where
   (isdescendantnode (p, ([first path] and [second path]))
   and contains(p.*, ' "bankproducts"')
   and p.[sling:resourceType] = 'components/content/download' 
```

可能关键字的顺序是错误的。我的想法已经用完了，所以 SO 属于我所拥有的最后一个选项。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T03:53:52.283

在路径条件中使用 'OR' -- `(isdescendantnode (p, [first path]) or isdescendantnode(p, [second path]))`。

# c# - C# Visual Studio 2010 表单应用程序错误消息

> ID：13588436
> 
> 赞同：0
> 
> 时间：2012-11-27T16:16:33.617
> 
> 标签：c#, visual-studio-2010

在 Visual Studio C# 2010 中启动新表单项目时，我不断收到此错误。我想我可能已经从属性管理器中重命名了一个文件，但不确定！

> 无法为此文件显示设计器，因为无法设计其中的任何类。设计人员检查了文件中的以下类： Form1 --- 无法设计基类“System.Object”。

我怎么解决这个问题？

警告还包括：

> 警告 1 无法为此文件显示设计器，因为无法设计其中的任何类。设计者检查了文件中的以下类：
> 
> Form1 --- 无法设计基类“System.Object”。0 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:22:12.377

删除设计器文件。右键单击 aspx 文件并选择*Convert to Web Application*。这应该正确地重新创建您的设计器文件并允许您再次打开页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:51:10.343

我通过将属性从 .net 4.0 客户端配置文件更改为 .net 4.0 配置文件来解决这个问题。

# c++ - 非公共继承中的 C++ 基类方法访问

> ID：13588438
> 
> 赞同：0
> 
> 时间：2012-11-27T16:16:45.130
> 
> 标签：c++, class

我有一个关于课程的问题

```
// Using private inheritance 
class CardPile : private vector<Card*> { 
    public: 
        CardPile (); 
        virtual ~CardPile ();  
        void add (Card* card); 
        void add (CardPile & otherPile); 
        void remove (Card* card); 
        void shuffle (); 
```

“私有向量< Card* >”到底是什么意思？这是否意味着我继承了向量类的所有公共成员？我也可以访问矢量私人成员吗？如果它受到保护或公开而不是私有，这将如何变化？澄清将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:18:44.093

私有继承使您可以访问基类的公共和受保护方法，就像公共继承一样。不同之处在于这些方法*对您的类是私有的*。同样对于受保护的继承。您获得了基类的公共和受保护方法，并且它们都在您的类中受到保护。

私有继承允许您根据另一个类来实现一个类，并且与拥有该类的私有数据成员没有什么不同。从这个意义上说，从另一个类私有或“受保护”继承的类与其具有“has-a”关系，而不是公共继承的“is-a”关系。这意味着例如[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)不适用。

现在，在您的特定示例中，从标准库容器继承被[认为是不良形式](https://stackoverflow.com/questions/4353203/thou-shalt-not-inherit-from-stdvector)，但请注意，大多数参数都适用于公共继承。

```
class Foo
{
  void privateFoo() const {}
 public:
  void foo() const {}
};

class Bar : Foo // class inheritance is private by default
{
 public:
  void bar() const { 
    foo(); // OK, foo() is a private method of Bar.
    privateFoo(); // Error! privateFoo() is private to Foo.
  }
};

int main()
{
  Foo f;
  f.foo(); // OK
  Bar b;
  b.bar(); // OK, calls foo() internally
  b.foo(); // Error! foo() is private in Bar.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:22:55.250

继承中的可见性遵循与组合中完全相同的规则。

也就是说，`CardPile`继承自`vector<Card*>`的方式与继承的方式相同`public`。不同之处在于作用域或类型可以知道这个继承 except`CardPile`及其朋友。

# jquery - 是否可以使用 url 作为选择器

> ID：13588441
> 
> 赞同：0
> 
> 时间：2012-11-27T16:16:49.850
> 
> 标签：jquery

我有一个名为 site.com 的站点，我想检查类名是否存在于我的其他页面[http://site.com/subfolder](http://site.com/subfolder)上，如果是，则执行代码。

```
$(document).ready(function() { 
    if ($('http://site.com/subfolder classname').length > 0) {
        $('.headline').after('<div>text</div>');
    }
}); 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:19:30.387

您可以使用带有 URL 的选择器，例如：

```
$('a[href="url"].classname') 
```

但不是你使用它的方式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:24:05.217

`.load()`您可以使用该方法从另一个页面中选择一个元素。

例子：

```
$("#myElement").load("http://http://stackoverflow.com/questions/13588441/is-it-possible-to-use-url-as-selector #question"); 
```

`question`这将在具有 id的元素中从该页面加载具有 id 的 div `myElement`（如果没有跨域策略）。

有关更多信息，请参阅[文档](http://api.jquery.com/load/#loading-page-fragments)。

# jsf-2 - ui:repeat 值表达式在渲染响应期间评估，无论父组件的渲染属性如何

> ID：13588442
> 
> 赞同：2
> 
> 时间：2012-11-27T16:16:51.773
> 
> 标签：jsf-2, nullpointerexception, facelets, el, uirepeat

我们正在将旧的 Seam webapp（Seam 2.2、JSF 1.2、JBoss 5.1）迁移到 JBoss 7.1（Seam 2.3、JSF 2.0）并面临这个奇怪的问题：

所有 EL 表达式作为`<ui:repeat>`条件渲染`<s:fragement>`标签内的值`null`都会在渲染响应阶段进行评估，从而导致 NPE。奇怪的是，为什么 Facelets 或 JSF 尝试评估这些 EL 表达式，尽管它们的渲染条件（ 的`rendered`属性`<s:fragment>`）不适用？

# javascript - 从现有字符串创建字符串，其中每个字符由 * 表示，只有空格由空格表示

> ID：13588445
> 
> 赞同：1
> 
> 时间：2012-11-27T16:16:59.770
> 
> 标签：javascript, jquery

我想从现有字符串生成一个新字符串。`javascript`在新生成的字符串中，所有字符都将由“*”表示，除了“”（空格）。例如，如果现有字符串是

“把我藏起来”

那么新生成的字符串将是

`"**** **"`

我试过这样，但它不工作。

```
 function hiddenData()
{
var size = word.length;
for (var i = 0; i <= size; i++)
{
    if (word[i] == ' ') {
        hiddenStr[i] = ' ';
    }
    else
    {
        hiddenStr[i] = '_';
    }
}
hiddenStr[i] = '\0';
} 
```

对不起，我的解释不好，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T16:18:48.297

使用正则表达式

```
alert(word.replace(/[^ ]/g, '*')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:20:30.213

使用`replace()`和正则表达式。

```
var str=word.replace(/[^ ]/g, '*'); 
```

# c# - 如何将多个 ScriptBundle 捆绑到一个新的 ScriptBundle 中

> ID：13588447
> 
> 赞同：4
> 
> 时间：2012-11-27T16:17:06.017
> 
> 标签：c#, asp.net, .net, webforms, bundling-and-minification

这是我到目前为止所做的

```
bundles.Add(new ScriptBundle("~/bundles/WebformsJS").Include(
      "~/Scripts/WebForms/WebForms.js",
      "~/Scripts/WebForms/WebUIValidation.js",
      "~/Scripts/WebForms/MenuStandards.js",
      "~/Scripts/WebForms/Focus.js",
      "~/Scripts/WebForms/GridView.js",
      "~/Scripts/WebForms/DetailsView.js",
      "~/Scripts/WebForms/TreeView.js",
      "~/Scripts/WebForms/WebParts.js"));

bundles.Add(new ScriptBundle("~/bundles/MsAjaxJS").Include(
    "~/Scripts/WebForms/MsAjax/MicrosoftAjax.js",
    "~/Scripts/WebForms/MsAjax/MicrosoftAjaxApplicationServices.js",
    "~/Scripts/WebForms/MsAjax/MicrosoftAjaxTimer.js",
    "~/Scripts/WebForms/MsAjax/MicrosoftAjaxWebForms.js"));

bundles.Add(new ScriptBundle("~/bundles/MegaJS").
    .Include("~/bundles/WebformsJS")
    .Include("~/bundles/MsAjaxJS")); 
```

然后我在 Site.Master 文件中渲染 MegaBundle，如下所示：

```
 <%: Scripts.Render("~/bundles/MegaJS") %> 
```

应用程序运行没有错误，但是当我查看页面源时，我可以看到包含

```
<script src="/bundles/MegaJS?v="></script> 
```

如果您注意到版本是空白的，并且当我单击捆绑脚本时它是空的

> 我的问题是：1）是否支持从其他捆绑包创建捆绑包2）如果是！然后是他们的榜样，我可以效仿。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T21:04:19.000

不，目前您不能在捆绑包中包含捆绑包，您只能包含真实资产。不过，这是我们在资产管理的待办事项清单上的内容。[如果这是您在此处](http://aspnetoptimization.codeplex.com/workitem/26)想要的功能，您可以对此表示赞同。

# c# - 从现有类创建新类：继承还是部分类？

> ID：13588451
> 
> 赞同：2
> 
> 时间：2012-11-27T16:17:12.980
> 
> 标签：c#

我有一个定义这样的对象的类：

```
public class MyClass{

   public int TheInt { get; set; }

   public void SomeMethod() { ... }
} 
```

实际上，还有更多的属性和方法。现在我想创建一个新类`MyEnhancedClass`，它具有所有属性和方法，`MyClass`并且它自己也有 2 个方法和 4 个属性。

目前，我的代码有两个不同的类，它们看起来非常相似；我正在寻找重构这些类，我想知道部分类和继承。最好的方法是什么？继承还是部分类？我知道这是一个基本的 OOP 问题，但请多多包涵。

感谢您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:18:49.520

我假设你在谈论继承。要从另一个类继承一个类，请在 C# 中使用以下表示法：

```
public class MyExtendedClass : MyClass
{
    // custom code
} 
```

**更新：**即使继承可能不是每种情况下的最佳解决方案（参见下面 Oded 的评论），也应该避免使用部分类，因为它们会更糟。它们不是语言的一部分，而是鼓励引入各种代码气味的语法糖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:19:30.783

```
public class MyEnhancedClass : MyClass {

 public override void SomeMethod() { ... }    

 // other functions here

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:22:01.190

部分类允许类跨越多个文件。例如，一个文件中的部分定义，而另一个文件中的其余部分。

继承允许将附加功能添加到现有类。继承父类的类可以添加额外的功能、属性或覆盖父类方法（前提是父类允许这样做）以扩展功能。

从您描述的情况来看，后者可能是更好的选择。

```
public class ChildOfMyClass : MyClass {
    public string TheString{get{return "Number : " + TheInt;}}

    public void Foo() {
    }
} 
```

`ChildOfMyClass`将有权访问`MyClass`.

# python - 在 Windows 上的 CygWin 下调用 python 挂起

> ID：13588454
> 
> 赞同：40
> 
> 时间：2012-11-27T16:17:28.290
> 
> 标签：python, cygwin

安装新的 Windows 系统后，我在默认位置 (`c:\cygwin`和 ) 安装了 CygWin 和 64 位 Python (2.7.3) `c:\Python27\python`，并将 CygWin bin 和 Python 目录添加到我的路径中（在用户变量 PATH 中）。从正常的命令窗口，Python 完美启动，但是当我`bash`在 CygWin 环境中调用它时，它挂起，从不给我输入提示。

我以前在其他机器上做过这个，但总是使用旧版本的 Python（32 位）和 CygWin，并且 Python 位于一个绝对非标准的位置。有没有其他人遇到过这个问题，或者有人可以告诉我可能是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-09-07T17:17:29.377

试试这个

```
python -i 
```

是的，您会在这里和那里发现一些故障！

选项`-i`强制交互式提示，如此处的 Python 帮助`python -h`页面所示。

```
$ python -h
-i  : inspect interactively after running script; 
      forces a prompt even if stdin does not appear to be a terminal;
      also PYTHONINSPECT=x 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-11-27T16:45:06.453

问题是由于 Cygwin 终端 (MinTTY) 的行为方式，Python 的本机 Windows 构建没有意识到 stdout 是终端设备——它认为它是一个管道，因此它以非交互模式运行交互模式，它完全缓冲其输出而不是行缓冲。

这是新的原因可能是因为在您之前的 Cygwin 安装中，您没有 MinTTY，并且使用的终端只是标准的 Windows 终端。

为了解决这个问题，您要么需要从常规 Windows 终端 ( `Cmd.exe`) 运行 Python，要么安装 Cygwin 版本的 Python 而不是 Python 的原生 Windows 版本。Cygwin 版本（可通过 Cygwin's 作为软件包安装`setup.exe`）理解 Cygwin 终端，并在通过 MinTTY 运行时适当地运行。

如果你想要的特定版本的 Python 没有 Cygwin 包，那么你也可以下载 Python 的源代码并在 Cygwin 下自己构建它。如果您还没有 Cygwin 编译器工具链（GCC），您将需要一个 Cygwin 编译器工具链，但我相信它应该使用标准`./configure && make && make install`命令进行编译。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-04-19T00:18:09.347

我在 Mercurial (hg)+OpenSSH、Python 和 MinTTY 上遇到了类似的问题，但在 MSYS 而不是 CygWin 下。尽管如此，据我所知，这和我的问题都是由于 MinTTY 没有处理使用本机 Windows 控制台功能的应用程序（在 Adam 的回答中，他详细解释了 Python）。

对我来说，我遵循了[https://code.google.com/p/mintty/issues/detail?id=56#c64的评论 64 中的解决方案](https://code.google.com/p/mintty/issues/detail?id=56#c64)

通过编译 winpty ( [https://github.com/rprichard/winpty](https://github.com/rprichard/winpty) ) 项目并在我的路径中，我能够从 MinTTY shell 运行**本机**Python（以交互模式）和 Mercurial，而无需特殊构建或开关（例如`python -i`） . 我所需要的只是在or命令之前附加`console.exe`or 。为方便起见，我添加了别名，这样无论我在 Linux shell 还是 Windows MinTTY bash shell 中，我都可以使用相同的命令。`console``python``hg``alias hg="console.exe hg"`

此外，此解决方案似乎适用于 python 和 hg 之外的更多本机应用程序。例如，运行`mysql`（带或不带`-p`）会产生相同的问题（例如“挂起”而没有输入提示）。附加`console`到它允许它像往常一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-15T19:27:23.300

根据[https://stackoverflow.com/a/9549255/745913](https://stackoverflow.com/a/9549255/745913)你也可以试试

```
/cydrive/c/Python27/python.exe -i foo.py 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-11-14T17:10:23.703

另一个通用的解决方法是通过`winpty` [https://github.com/rprichard/winpty](https://github.com/rprichard/winpty)调用它，这并不是一个真正的 python 特定问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-01T21:19:50.690

在 CygWin 中管理不同版本 Python 的非 cygwin 位置：

```
$ /usr/sbin/alternatives.exe 
```

在此处使用 --install 和 --config 选项，它的工作方式与`update-alternatives`在 Linux 系统上相同。我将其与该`python -i`方法一起使用，并且运行良好。

我还必须首先删除符号链接文件`/usr/bin`，因为它们是使用 CygWin 的 python 安装的，最初不是通过alternatives.exe 管理的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-10T14:40:37.827

我的解决方案涉及编写一个 shell 脚本来运行 python 应用程序。

```
python file.py "$@" | tee /dev/null 
```

那个额外的 tee 命令（无处）似乎解决了这个问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-01-10T04:25:27.740

使用 cygwin 安装程序重新安装 mintty。之后不必使用 python -i 。

# bash - 在 Bash 或 Shell 脚本中转发函数声明？

> ID：13588457
> 
> 赞同：104
> 
> 时间：2012-11-27T16:17:37.273
> 
> 标签：bash, function, sh, forward-declaration

`bash`例如，在 C / C++ 中众所周知的前向声明中是否有这样的事情，或者至少有类似的（解决方法）？

或者有这样的事情，因为例如它总是一次执行（一行接一行）？

如果没有前向声明，我应该怎么做才能使我的脚本更易于阅读。它相当长，并且这些函数定义在开始时与全局变量混合在一起，使我的脚本看起来很丑陋且难以阅读/理解）？我要求为此类案例学习一些众所周知的/最佳实践。

* * *

例如：

```
# something like forward declaration
function func

# execution of the function
func

# definition of func
function func
{
    echo 123
} 
```

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2012-11-27T16:19:21.743

好问题。我的大多数脚本都使用这样的模式：

```
#!/bin/bash

main() {
    foo
    bar
    baz
}

foo() {
}

bar() {
}

baz() {
}

main "$@" 
```

您可以从上到下阅读代码，但实际上直到最后一行才开始执行。通过传递`"$@"`给 main()，您可以像往常一样访问命令行参数`$1`, `$2`, 等。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-11-27T16:39:29.257

当我的 bash 脚本增长太多时，我使用包含机制：

文件`allMyFunctions`：

```
foo() {
}

bar() {
}

baz() {
} 
```

文件`main`：

```
#!/bin/bash

. allMyfunctions

foo
bar
baz 
```

# delphi - 如何调整任何类型的图像的大小？

> ID：13588462
> 
> 赞同：4
> 
> 时间：2012-11-27T16:17:50.597
> 
> 标签：delphi, delphi-6, graphicex

我的项目的目标是在 Delphi 6 中调整任何类型的图像（jpeg/gif/png）的大小。

我尝试了很多方法，但我无法获得理想的解决方案。任何线索如何做到这一点？它可以是一个简单的命令行工具、一些代码或一个 Delphi 组件。

我试过 imagemagick：太重了：20 megas + dlls + 注册表。

我尝试了一些片段，但其中大部分仅适用于 JPEG。我需要 gif/jpeg/png

我尝试了graphicEX，但没有加载我的GIF

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T00:46:50.480

使用[`Windows Imaging Component (WIC)`](http://msdn.microsoft.com/en-us/library/windows/desktop/ee719902%28v=vs.85%29.aspx)它可能如下所示。此代码支持 BMP、GIF、PNG 和 JPEG 格式的编码器，但它可以轻松扩展到其他格式（对于其余的本机编码器 CLSID，请查看[`IWICBitmapEncoder`](http://msdn.microsoft.com/en-us/library/windows/desktop/ee690110%28v=vs.85%29.aspx)接口参考的备注部分）。

`ResizeImage`这是此代码示例中使用的过程的原型：

```
procedure ResizeImage(const Source, Target: WideString; Width, Height: Cardinal;
  EncoderType: TEncoderType; InterpolationMode: TInterpolationMode = imFant); 
```

以下是对其参数的简短描述：

*   Source - 输入图像文件名
*   目标 - 输出图像文件名
*   宽度 - 图像的新宽度
*   高度 - 图像的新高度
*   EncoderType - 输出编码器的类型；它可以是以下值之一：
    *   etBMP - 用于 BMP 编码器
    *   etGIF - 用于 GIF 图像编码器
    *   etPNG - 用于 PNG 图像编码器
    *   etJPEG - 用于 JPEG 图像编码器
*   InterpolationMode - 缩放图像时使用的采样或过滤模式；它可以是以下值之一：
    *   最近的邻居
    *   im线性
    *   立方
    *   婴儿

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  StdCtrls, Dialogs, ComObj, ActiveX;

const
  WICBitmapCacheOnLoad = $2;
  WICDecodeMetadataCacheOnDemand = 0;

  SID_IPropertyBag2 = '{22F55882-280B-11d0-A8A9-00A0C90C2004}';
  SID_IWICComponentInfo = '{23BC3F0A-698B-4357-886B-F24D50671334}';
  SID_IWICBitmapSource = '{00000120-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmap = '{00000121-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmapLock = '{00000123-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmapCodecInfo = '{E87A44C4-B76E-4c47-8B09-298EB12A2714}';
  SID_IWICBitmapEncoder = '{00000103-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmapDecoder = '{9EDDE9E7-8DEE-47ea-99DF-E6FAF2ED44BF}';
  SID_IWICBitmapEncoderInfo = '{94C9B4EE-A09F-4f92-8A1E-4A9BCE7E76FB}';
  SID_IWICBitmapDecoderInfo = '{D8CD007F-D08F-4191-9BFC-236EA7F0E4B5}';
  SID_IWICBitmapFrameEncode = '{00000105-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmapFrameDecode = '{3B16811B-6A43-4ec9-A813-3D930C13B940}';
  SID_IWICBitmapScaler = '{00000302-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICBitmapClipper = '{E4FBCF03-223D-4e81-9333-D635556DD1B5}';
  SID_IWICBitmapFlipRotator = '{5009834F-2D6A-41ce-9E1B-17C5AFF7A782}';
  SID_IWICPalette = '{00000040-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICColorContext = '{3C613A02-34B2-44ea-9A7C-45AEA9C6FD6D}';
  SID_IWICColorTransform = '{B66F034F-D0E2-40ab-B436-6DE39E321A94}';
  SID_IWICMetadataQueryReader = '{30989668-E1C9-4597-B395-458EEDB808DF}';
  SID_IWICMetadataQueryWriter = '{A721791A-0DEF-4d06-BD91-2118BF1DB10B}';
  SID_IWICFastMetadataEncoder = '{B84E2C09-78C9-4AC4-8BD3-524AE1663A2F}';
  SID_IWICStream = '{135FF860-22B7-4ddf-B0F6-218F4F299A43}';
  SID_IWICFormatConverter = '{00000301-a8f2-4877-ba0a-fd2b6645fb94}';
  SID_IWICImagingFactory = '{ec5ec8a9-c395-4314-9c77-54d7a935ff70}';
  // here's not TGUID type specified since the following formats are
  // used in the constant array of TGUID
  GUID_ContainerFormatBmp = '{0AF1D87E-FCFE-4188-BDEB-A7906471CBE3}';
  GUID_ContainerFormatGif = '{1F8A5601-7D4D-4CBD-9C82-1BC8D4EEB9A5}';
  GUID_ContainerFormatPng = '{1B7CFAF4-713F-473C-BBCD-6137425FAEAF}';
  GUID_ContainerFormatJpeg = '{19E4A5AA-5662-4FC5-A0C0-1758028E1057}';
  CLSID_WICImagingFactory: TGUID = '{CACAF262-9370-4615-A13B-9F5539DA4C0A}';

type
  PWICColor = ^TWicColor;
  TWICColor = Cardinal;
  PWICRect = ^TWICRect;
  TWICRect = record
    X: Integer;
    Y: Integer;
    Width: Integer;
    Height: Integer;
  end;
  PIWICColorContext = ^IWICColorContext;
  PWICBitmapPattern = ^TWICBitmapPattern;
  TWICBitmapPattern = record
    Position: ULARGE_INTEGER;
    Length: ULONG;
    Pattern: PByte;
    Mask: PByte;
    EndOfStream: BOOL;
  end;
  PPropBag2 = ^TPropBag2;
  TPropBag2 = record
    dwType: DWORD;
    vt: TVarType;
    cfType: TClipFormat;
    dwHint: DWORD;
    pstrName: POleStr;
    clsid: TCLSID;
  end;
  TWICBitmapInterpolationMode = (
    WICBitmapInterpolationModeNearestNeighbor = $00000000,
    WICBitmapInterpolationModeLinear = $00000001,
    WICBitmapInterpolationModeCubic = $00000002,
    WICBitmapInterpolationModeFant = $00000003
  );
  TWICBitmapEncoderCacheOption = (
    WICBitmapEncoderCacheInMemory = $00000000,
    WICBitmapEncoderCacheTempFile = $00000001,
    WICBitmapEncoderNoCache = $00000002
  );
  TWICInProcPointer = ^Byte;
  TWICPixelFormatGUID = TGUID;
  TREFWICPixelFormatGUID = PGUID;
  TWICComponentType = type Integer;
  TWICDecodeOptions = type Integer;
  TWICColorContextType = type Integer;
  TWICBitmapDitherType = type Integer;
  TWICBitmapPaletteType = type Integer;
  TWICBitmapTransformOptions = type Integer;
  TWICBitmapCreateCacheOption = type Integer;
  TWICBitmapAlphaChannelOption = type Integer;
  IPropertyBag2 = interface;
  IWICPalette = interface;
  IWICColorContext = interface;
  IWICColorTransform = interface;
  IWICBitmap = interface;
  IWICBitmapLock = interface;
  IWICBitmapSource = interface;
  IWICBitmapCodecInfo = interface;
  IWICBitmapEncoder = interface;
  IWICBitmapDecoder = interface;
  IWICBitmapEncoderInfo = interface;
  IWICBitmapDecoderInfo = interface;
  IWICBitmapFrameEncode = interface;
  IWICBitmapFrameDecode = interface;
  IWICBitmapScaler = interface;
  IWICBitmapClipper = interface;
  IWICBitmapFlipRotator = interface;
  IWICMetadataQueryReader = interface;
  IWICMetadataQueryWriter = interface;
  IWICFastMetadataEncoder = interface;
  IWICStream = interface;
  IWICComponentInfo = interface;
  IWICFormatConverter = interface;
  IWICImagingFactory = interface;

  IPropertyBag2 = interface(IUnknown)
    [SID_IPropertyBag2]
    function Read(pPropBag: PPropBag2; pErrLog: IErrorLog; pvarValue: PVariant; phrError: PHResult): HRESULT; stdcall;
    function Write(cProperties: ULONG; pPropBag: PPropBag2; pvarValue: PVariant): HRESULT; stdcall;
    function CountProperties(var pcProperties: ULONG): HRESULT; stdcall;
    function GetPropertyInfo(iProperty, cProperties: ULONG; pPropBag: PPropBag2; var pcProperties: ULONG): HRESULT; stdcall;
    function LoadObject(pstrName:POleStr; dwHint: DWORD; pUnkObject: IUnknown; pErrLog: IErrorLog): HRESULT; stdcall;
  end;
  IWICComponentInfo = interface(IUnknown)
    [SID_IWICComponentInfo]
    function GetComponentType(var pType: TWICComponentType): HRESULT; stdcall;
    function GetCLSID(var pclsid: TGUID): HRESULT; stdcall;
    function GetSigningStatus(var pStatus: DWORD): HRESULT; stdcall;
    function GetAuthor(cchAuthor: UINT; wzAuthor: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetVendorGUID(var pguidVendor: TGUID): HRESULT; stdcall;
    function GetVersion(cchVersion: UINT; wzVersion: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetSpecVersion(cchSpecVersion: UINT; wzSpecVersion: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetFriendlyName(cchFriendlyName: UINT; wzFriendlyName: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
  end;
  IWICBitmapSource = interface(IUnknown)
    [SID_IWICBitmapSource]
    function GetSize(var puiWidth: UINT; var puiHeight: UINT): HRESULT; stdcall;
    function GetPixelFormat(var pPixelFormat: TWICPixelFormatGUID): HRESULT; stdcall;
    function GetResolution(var pDpiX: Double; var pDpiY: Double): HRESULT; stdcall;
    function CopyPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function CopyPixels(prc: PWICRect; cbStride: UINT; cbBufferSize: UINT; pbBuffer: PByte): HRESULT; stdcall;
  end;
  IWICBitmap = interface(IWICBitmapSource)
    [SID_IWICBitmap]
    function Lock(const prcLock: TWICRect; flags: DWORD; out ppILock: IWICBitmapLock): HRESULT; stdcall;
    function SetPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function SetResolution(dpiX: Double; dpiY: Double): HRESULT; stdcall;
  end;
  IWICBitmapLock = interface(IUnknown)
    [SID_IWICBitmapLock]
    function GetSize(var puiWidth: UINT; var puiHeight: UINT): HRESULT; stdcall;
    function GetStride(var pcbStride: UINT): HRESULT; stdcall;
    function GetDataPointer(var pcbBufferSize: UINT; var ppbData: TWICInProcPointer): HRESULT; stdcall;
    function GetPixelFormat(var pPixelFormat: TWICPixelFormatGUID): HRESULT; stdcall;
  end;
  IWICBitmapCodecInfo = interface(IWICComponentInfo)
    [SID_IWICBitmapCodecInfo]
    function GetContainerFormat(var pguidContainerFormat: TGUID): HRESULT; stdcall;
    function GetPixelFormats(cFormats: UINT; var guidPixelFormats: PGUID; var pcActual: UINT): HRESULT; stdcall;
    function GetColorManagementVersion(cchColorManagementVersion: UINT; wzColorManagementVersion: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetDeviceManufacturer(cchDeviceManufacturer: UINT; wzDeviceManufacturer: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetDeviceModels(cchDeviceModels: UINT; wzDeviceModels: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetMimeTypes(cchMimeTypes: UINT; wzMimeTypes: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function GetFileExtensions(cchFileExtensions: UINT; wzFileExtensions: PWCHAR; var pcchActual: UINT): HRESULT; stdcall;
    function DoesSupportAnimation(var pfSupportAnimation: BOOL): HRESULT; stdcall;
    function DoesSupportChromakey(var pfSupportChromakey: BOOL): HRESULT; stdcall;
    function DoesSupportLossless(var pfSupportLossless: BOOL): HRESULT; stdcall;
    function DoesSupportMultiframe(var pfSupportMultiframe: BOOL): HRESULT; stdcall;
    function MatchesMimeType(wzMimeType: LPCWSTR; var pfMatches: BOOL): HRESULT; stdcall;
  end;
  IWICBitmapEncoder = interface(IUnknown)
    [SID_IWICBitmapEncoder]
    function Initialize(pIStream: IStream; cacheOption: TWICBitmapEncoderCacheOption): HRESULT; stdcall;
    function GetContainerFormat(var pguidContainerFormat: TGUID): HRESULT; stdcall;
    function GetEncoderInfo(out ppIEncoderInfo: IWICBitmapEncoderInfo): HRESULT; stdcall;
    function SetColorContexts(cCount: UINT; ppIColorContext: PIWICColorContext): HRESULT; stdcall;
    function SetPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function SetThumbnail(pIThumbnail: IWICBitmapSource): HRESULT; stdcall;
    function SetPreview(pIPreview: IWICBitmapSource): HRESULT; stdcall;
    function CreateNewFrame(out ppIFrameEncode: IWICBitmapFrameEncode; var ppIEncoderOptions: IPropertyBag2): HRESULT; stdcall;
    function Commit: HRESULT; stdcall;
    function GetMetadataQueryWriter(out ppIMetadataQueryWriter: IWICMetadataQueryWriter): HRESULT; stdcall;
  end;
  IWICBitmapDecoder = interface(IUnknown)
    [SID_IWICBitmapDecoder]
    function QueryCapability(pIStream: IStream; var pdwCapability: DWORD): HRESULT; stdcall;
    function Initialize(pIStream: IStream; cacheOptions: TWICDecodeOptions): HRESULT; stdcall;
    function GetContainerFormat(var pguidContainerFormat: TGUID): HRESULT; stdcall;
    function GetDecoderInfo(out ppIDecoderInfo: IWICBitmapDecoderInfo): HRESULT; stdcall;
    function CopyPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function GetMetadataQueryReader(out ppIMetadataQueryReader: IWICMetadataQueryReader): HRESULT; stdcall;
    function GetPreview(out ppIBitmapSource: IWICBitmapSource): HRESULT; stdcall;
    function GetColorContexts(cCount: UINT; ppIColorContexts: PIWICColorContext; var pcActualCount : UINT): HRESULT; stdcall;
    function GetThumbnail(out ppIThumbnail: IWICBitmapSource): HRESULT; stdcall;
    function GetFrameCount(var pCount: UINT): HRESULT; stdcall;
    function GetFrame(index: UINT; out ppIBitmapFrame: IWICBitmapFrameDecode): HRESULT; stdcall;
  end;
  IWICBitmapEncoderInfo = interface(IWICBitmapCodecInfo)
    [SID_IWICBitmapEncoderInfo]
    function CreateInstance(out ppIBitmapEncoder: IWICBitmapEncoder): HRESULT; stdcall;
  end;
  IWICBitmapDecoderInfo = interface(IWICBitmapCodecInfo)
    [SID_IWICBitmapDecoderInfo]
    function GetPatterns(cbSizePatterns: UINT; pPatterns: PWICBitmapPattern; var pcPatterns: UINT; var pcbPatternsActual: UINT): HRESULT; stdcall;
    function MatchesPattern(pIStream: IStream; var pfMatches: BOOL): HRESULT; stdcall;
    function CreateInstance(out ppIBitmapDecoder: IWICBitmapDecoder): HRESULT; stdcall;
  end;
  IWICBitmapFrameEncode = interface(IUnknown)
    [SID_IWICBitmapFrameEncode]
    function Initialize(pIEncoderOptions: IPropertyBag2): HRESULT; stdcall;
    function SetSize(uiWidth: UINT; uiHeight: UINT): HRESULT; stdcall;
    function SetResolution(dpiX: Double; dpiY: Double): HRESULT; stdcall;
    function SetPixelFormat(var pPixelFormat: TWICPixelFormatGUID): HRESULT; stdcall;
    function SetColorContexts(cCount: UINT; ppIColorContext: PIWICColorContext): HRESULT; stdcall;
    function SetPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function SetThumbnail(pIThumbnail: IWICBitmapSource): HRESULT; stdcall;
    function WritePixels(lineCount: UINT; cbStride: UINT; cbBufferSize: UINT; pbPixels: PByte): HRESULT; stdcall;
    function WriteSource(pIBitmapSource: IWICBitmapSource; prc: PWICRect): HRESULT; stdcall;
    function Commit: HRESULT; stdcall;
    function GetMetadataQueryWriter(out ppIMetadataQueryWriter: IWICMetadataQueryWriter): HRESULT; stdcall;
  end;
  IWICBitmapFrameDecode = interface(IWICBitmapSource)
    [SID_IWICBitmapFrameDecode]
    function GetMetadataQueryReader(out ppIMetadataQueryReader: IWICMetadataQueryReader): HRESULT; stdcall;
    function GetColorContexts(cCount: UINT; ppIColorContexts: PIWICColorContext; var pcActualCount : UINT): HRESULT; stdcall;
    function GetThumbnail(out ppIThumbnail: IWICBitmapSource): HRESULT; stdcall;
  end;
  IWICBitmapScaler = interface(IWICBitmapSource)
    [SID_IWICBitmapScaler]
    function Initialize(pISource: IWICBitmapSource; uiWidth: UINT; uiHeight: UINT; mode: TWICBitmapInterpolationMode): HRESULT; stdcall;
  end;
  IWICBitmapClipper = interface(IWICBitmapSource)
    [SID_IWICBitmapClipper]
    function Initialize(pISource: IWICBitmapSource; var prc: TWICRect): HRESULT; stdcall;
  end;
  IWICBitmapFlipRotator = interface(IWICBitmapSource)
    [SID_IWICBitmapFlipRotator]
    function Initialize(pISource: IWICBitmapSource; options: TWICBitmapTransformOptions): HRESULT; stdcall;
  end;
  IWICPalette = interface(IUnknown)
    [SID_IWICPalette]
    function InitializePredefined(ePaletteType: TWICBitmapPaletteType; fAddTransparentColor: BOOL): HRESULT; stdcall;
    function InitializeCustom(pColors: PWICColor; cCount: UINT): HRESULT; stdcall;
    function InitializeFromBitmap(pISurface: IWICBitmapSource; cCount: UINT; fAddTransparentColor: BOOL): HRESULT; stdcall;
    function InitializeFromPalette(pIPalette: IWICPalette): HRESULT; stdcall;
    function GetType(var pePaletteType: TWICBitmapPaletteType): HRESULT; stdcall;
    function GetColorCount(var pcCount: UINT): HRESULT; stdcall;
    function GetColors(cCount: UINT; pColors: PWICColor; var pcActualColors: UINT): HRESULT; stdcall;
    function IsBlackWhite(var pfIsBlackWhite: BOOL): HRESULT; stdcall;
    function IsGrayscale(var pfIsGrayscale: BOOL): HRESULT; stdcall;
    function HasAlpha(var pfHasAlpha: BOOL): HRESULT; stdcall;
  end;
  IWICColorContext = interface(IUnknown)
    [SID_IWICColorContext]
    function InitializeFromFilename(wzFilename: LPCWSTR): HRESULT; stdcall;
    function InitializeFromMemory(const pbBuffer: PByte; cbBufferSize: UINT): HRESULT; stdcall;
    function InitializeFromExifColorSpace(value: UINT): HRESULT; stdcall;
    function GetType(var pType: TWICColorContextType): HRESULT; stdcall;
    function GetProfileBytes(cbBuffer: UINT; pbBuffer: PByte; var pcbActual: UINT): HRESULT; stdcall;
    function GetExifColorSpace(var pValue: UINT): HRESULT; stdcall;
  end;
  IWICColorTransform = interface(IWICBitmapSource)
    [SID_IWICColorTransform]
    function Initialize(pIBitmapSource: IWICBitmapSource; pIContextSource: IWICColorContext; pIContextDest: IWICColorContext; pixelFmtDest: TREFWICPixelFormatGUID): HRESULT; stdcall;
  end;
  IWICMetadataQueryReader = interface(IUnknown)
    [SID_IWICMetadataQueryReader]
    function GetContainerFormat(var pguidContainerFormat: TGUID): HRESULT; stdcall;
    function GetLocation(cchMaxLength: UINT; wzNamespace: PWCHAR; var pcchActualLength: UINT): HRESULT; stdcall;
    function GetMetadataByName(wzName: LPCWSTR; var pvarValue: PROPVARIANT): HRESULT; stdcall;
    function GetEnumerator(out ppIEnumString: IEnumString): HRESULT; stdcall;
  end;
  IWICMetadataQueryWriter = interface(IWICMetadataQueryReader)
    [SID_IWICMetadataQueryWriter]
    function SetMetadataByName(wzName: LPCWSTR; const pvarValue: TPropVariant): HRESULT; stdcall;
    function RemoveMetadataByName(wzName: LPCWSTR): HRESULT; stdcall;
  end;
  IWICFastMetadataEncoder = interface(IUnknown)
    [SID_IWICFastMetadataEncoder]
    function Commit: HRESULT; stdcall;
    function GetMetadataQueryWriter(out ppIMetadataQueryWriter: IWICMetadataQueryWriter): HRESULT; stdcall;
  end;
  IWICStream = interface(IStream)
    [SID_IWICStream]
    function InitializeFromIStream(pIStream: IStream): HRESULT; stdcall;
    function InitializeFromFilename(wzFileName: LPCWSTR; dwDesiredAccess: DWORD): HRESULT; stdcall;
    function InitializeFromMemory(pbBuffer: TWICInProcPointer; cbBufferSize: DWORD): HRESULT; stdcall;
    function InitializeFromIStreamRegion(pIStream: IStream; ulOffset: ULARGE_INTEGER; ulMaxSize: ULARGE_INTEGER): HRESULT; stdcall;
  end;
  IWICFormatConverter = interface(IWICBitmapSource)
    [SID_IWICFormatConverter]
    function Initialize(pISource: IWICBitmapSource; const dstFormat: TWICPixelFormatGUID; dither: TWICBitmapDitherType; const pIPalette: IWICPalette; alphaThresholdPercent: Double; paletteTranslate: TWICBitmapPaletteType): HRESULT; stdcall;
    function CanConvert(srcPixelFormat: TREFWICPixelFormatGUID; dstPixelFormat: TREFWICPixelFormatGUID; var pfCanConvert: BOOL): HRESULT; stdcall;
  end;
  IWICImagingFactory = interface(IUnknown)
    [SID_IWICImagingFactory]
    function CreateDecoderFromFilename(wzFilename: LPCWSTR; const pguidVendor: TGUID; dwDesiredAccess: DWORD; metadataOptions: TWICDecodeOptions; out ppIDecoder: IWICBitmapDecoder): HRESULT; stdcall;
    function CreateDecoderFromStream(pIStream: IStream; const pguidVendor: TGUID; metadataOptions: TWICDecodeOptions; out ppIDecoder: IWICBitmapDecoder): HRESULT; stdcall;
    function CreateDecoderFromFileHandle(hFile: ULONG_PTR; const pguidVendor: TGUID; metadataOptions: TWICDecodeOptions; out ppIDecoder: IWICBitmapDecoder): HRESULT; stdcall;
    function CreateComponentInfo(const clsidComponent: TGUID; out ppIInfo: IWICComponentInfo): HRESULT; stdcall;
    function CreateDecoder(const guidContainerFormat: TGUID; const pguidVendor: TGUID; out ppIDecoder: IWICBitmapDecoder): HRESULT; stdcall;
    function CreateEncoder(const guidContainerFormat: TGUID; const pguidVendor: TGUID; out ppIEncoder: IWICBitmapEncoder): HRESULT; stdcall;
    function CreatePalette(out ppIPalette: IWICPalette): HRESULT; stdcall;
    function CreateFormatConverter(out ppIFormatConverter: IWICFormatConverter): HRESULT; stdcall;
    function CreateBitmapScaler(out ppIBitmapScaler: IWICBitmapScaler): HRESULT; stdcall;
    function CreateBitmapClipper(out ppIBitmapClipper: IWICBitmapClipper): HRESULT; stdcall;
    function CreateBitmapFlipRotator(out ppIBitmapFlipRotator: IWICBitmapFlipRotator): HRESULT; stdcall;
    function CreateStream(out ppIWICStream: IWICStream): HRESULT; stdcall;
    function CreateColorContext(out ppIWICColorContext: IWICColorContext): HRESULT; stdcall;
    function CreateColorTransformer(out ppIWICColorTransform: IWICColorTransform): HRESULT; stdcall;
    function CreateBitmap(uiWidth: UINT; uiHeight: UINT; pixelFormat: TREFWICPixelFormatGUID; option: TWICBitmapCreateCacheOption; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateBitmapFromSource(pIBitmapSource: IWICBitmapSource; option: TWICBitmapCreateCacheOption; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateBitmapFromSourceRect(pIBitmapSource: IWICBitmapSource; x: UINT; y: UINT; width: UINT; height: UINT; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateBitmapFromMemory(uiWidth: UINT; uiHeight: UINT; const pixelFormat: TWICPixelFormatGUID; cbStride: UINT; cbBufferSize: UINT; pbBuffer: PByte; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateBitmapFromHBITMAP(hBitmap: HBITMAP; hPalette: HPALETTE; options: TWICBitmapAlphaChannelOption; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateBitmapFromHICON(hIcon: HICON; out ppIBitmap: IWICBitmap): HRESULT; stdcall;
    function CreateComponentEnumerator(componentTypes: DWORD; options: DWORD; out ppIEnumUnknown: IEnumUnknown): HRESULT; stdcall;
    function CreateFastMetadataEncoderFromDecoder(pIDecoder: IWICBitmapDecoder; out ppIFastEncoder: IWICFastMetadataEncoder): HRESULT; stdcall;
    function CreateFastMetadataEncoderFromFrameDecode(pIFrameDecoder: IWICBitmapFrameDecode; out ppIFastEncoder: IWICFastMetadataEncoder): HRESULT; stdcall;
    function CreateQueryWriter(const guidMetadataFormat: TGUID; const pguidVendor: TGUID; out ppIQueryWriter: IWICMetadataQueryWriter): HRESULT; stdcall;
    function CreateQueryWriterFromReader(pIQueryReader: IWICMetadataQueryReader; const pguidVendor: TGUID; out ppIQueryWriter: IWICMetadataQueryWriter): HRESULT; stdcall;
  end;

type
  TForm1 = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

type
  TEncoderType = (
    etBMP,
    etGIF,
    etPNG,
    etJPEG
  );
  TInterpolationMode = (
    imNearestNeighbour,
    imLinear,
    imCubic,
    imFant
  );

procedure ResizeImage(const Source, Target: WideString; Width, Height: Cardinal;
  EncoderType: TEncoderType; InterpolationMode: TInterpolationMode = imFant);
var
  FileStream: IWICStream;
  PropertyBag: IPropertyBag2;
  BitmapScaler: IWICBitmapScaler;
  BitmapDecoder: IWICBitmapDecoder;
  BitmapEncoder: IWICBitmapEncoder;
  BitmapFrameEncode: IWICBitmapFrameEncode;
  BitmapFrameDecode: IWICBitmapFrameDecode;
  ImagingFactory: IWICImagingFactory;
const
  EncoderFormat: array[TEncoderType] of TGUID = (GUID_ContainerFormatBmp,
    GUID_ContainerFormatGif, GUID_ContainerFormatPng, GUID_ContainerFormatJpeg);
begin
  OleCheck(CoCreateInstance(CLSID_WICImagingFactory, nil,
    CLSCTX_INPROC_SERVER or CLSCTX_LOCAL_SERVER, IUnknown, ImagingFactory));
  OleCheck(ImagingFactory.CreateDecoderFromFilename(PWideChar(Source),
    GUID_NULL, GENERIC_READ, WICDecodeMetadataCacheOnDemand, BitmapDecoder));
  OleCheck(BitmapDecoder.GetFrame(0, BitmapFrameDecode));
  OleCheck(ImagingFactory.CreateBitmapScaler(BitmapScaler));
  OleCheck(BitmapScaler.Initialize(BitmapFrameDecode, Width, Height,
    TWICBitmapInterpolationMode(InterpolationMode)));

  OleCheck(ImagingFactory.CreateStream(FileStream));
  OleCheck(FileStream.InitializeFromFilename(PWideChar(Target),
    GENERIC_WRITE));
  OleCheck(ImagingFactory.CreateEncoder(EncoderFormat[EncoderType], GUID_NULL,
    BitmapEncoder));
  OleCheck(BitmapEncoder.Initialize(FileStream, WICBitmapEncoderNoCache));
  PropertyBag := nil;
  OleCheck(BitmapEncoder.CreateNewFrame(BitmapFrameEncode, PropertyBag));
  OleCheck(BitmapFrameEncode.Initialize(PropertyBag));
  OleCheck(BitmapFrameEncode.WriteSource(BitmapScaler, nil));
  OleCheck(BitmapFrameEncode.Commit);
  OleCheck(BitmapEncoder.Commit);
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  ResizeImage('c:\InputImage.jpg', 'c:\OutputImage.png', 320, 240, etPNG,
    imCubic);
end;

end. 
```

如果需要，您可以下载显示上述代码用法的扩展演示项目[`from here`](http://code.google.com/p/projects-stackoverflow-tlama/downloads/detail?name=13588462.ZIP&can=2&q=)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T18:41:11.230

使用 GDI+ 例如[http://www.progdigy.com/?page_id=7](http://www.progdigy.com/?page_id=7)应该可以让您为至少 BMP、GIF、JPEG、PNG、TIFF、ICON、WMF、EMF 快速编写转换器。您只需加载图形并使用缩放和平移变换将其绘制到所需的 HDC。

# visual-studio - 调试器在他应该中断的地方中断了 2 行

> ID：13588466
> 
> 赞同：1
> 
> 时间：2012-11-27T16:17:58.927
> 
> 标签：visual-studio, debugging, visual-studio-2012

我使用 ASP.NET MVC4 在 Visual Studio 2012 上工作。今天我在我的代码中放置了一个断点（见下文）。在运行时断点未命中。所以我决定将`debugger;`语句放在我的代码中以强制中断。`debugger;`在运行时，它在语句后中断 2 行（见下文）。对我来说很奇怪。如您所见，黄色框与`debugger;`语句的大小相同。

任何想法？

谢谢。

![在此处输入图像描述](../Images/2f77c1bb5c8ec75649d73e63a712acf9.png)

**编辑：下面是我悬停断点的屏幕截图**

![在此处输入图像描述](../Images/58c207ae1683900183546ff19bc1b99e.png)

# android - 用 Jackson 解析简单的 JSON

> ID：13588467
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:18:01.947
> 
> 标签：android, jackson

这是我的 JSON：

```
{
  "i": 53691,
  "s": "Something" } 
```

这是我的模型：

```
 public class Test() { 
private int i;
private String s;

    public setInt(int i){ this.i = i; }

    public setString(String s){ this.s = s; }

    // getters here

    } 
```

这是我的服务器响应类：

```
 public class ServerResponse(){
  private Test;
 public void setTest(Test test){ this.test = test;}
 public Test getTest(){ return Test; } } 
```

当我做：

```
ObjectMapper mapper = new ObjectMapper();
mapper.readValue(json, serverResponse); 
```

我遇到了一个例外，例如：

> JsonProcessingException：无法识别的字段“i”（MyClass 类），未标记为可忽略

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:21:05.247

您的 JSON 格式不正确。

它应该是：

```
{
  "i": 53691,
  "s": "Something" 
} 
```

您缺少`,`字段之间的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:23:11.597

您应该公开您的班级成员，或为他们提供 getter/setter。

在您的情况下，它应该是：

```
public void setI() { ... }
public void setS() { ... } 
```

不是`setInt()`和`setString()`

就我个人而言，我更喜欢将它们公开——写起来更短，更容易调试。

# c++ - Valgrind 的地块工具不会分析我的应用程序

> ID：13588474
> 
> 赞同：18
> 
> 时间：2012-11-27T16:18:24.340
> 
> 标签：c++, linux, centos, valgrind, massif

我正在使用 CentOS 存储库中的标准 gcc 4.4 软件包在 64 位 CentOS 5.8 上开发一个静态链接的 64 位 C++ 应用程序。它使用的内存似乎比我预期的要多，所以我尝试使用 massif 来分析内存使用情况。我已经用调试信息编译然后运行

> valgrind --tool=massif ./MyProg

从 MyProg 所在的目录。除了以下 massif.out.XXXX 示例之外，它永远不会产生任何结果。

```
desc: (none)
cmd: ./MyProg
time_unit: i
#-----------
snapshot=0
#-----------
time=0
mem_heap_B=0
mem_heap_extra_B=0
mem_stacks_B=0
heap_tree=empty 
```

请注意，这是文件的全部内容，我的程序可以运行几分钟。

我尝试了 valgrind 和 massif 的各种选项，但无济于事。我什至尝试使用 MyProg 的绝对路径，以防万一。我已经尝试下载 valgrind 的最新稳定版本（3.8.1）并编译和运行它（因为 CentOS 使用的是 3.5.0），结果相同。作为一个健全的检查，我跑了

> valgrind --tool=massif ls -l

并且它按预期生成了多个内存使用量非零的快照。

我尝试使用我能想到的所有关键字组合在线搜索，但没有发现任何类似的问题。

附带说明一下，我可以使用 valgrind 的默认 memcheck 工具成功地分析应用程序，以防万一这是有用的信息。

有谁知道为什么 massif 无法分析我的应用程序？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T19:38:06.223

如果应用程序是静态链接的，则无法使用 valgrind 对其进行分析。Valgrind 通过为您的程序提供它自己的分配函数版本来工作，它通过覆盖动态查找来完成。

如果您可以动态链接标准库（libc 和 libstdc++），那么它应该能够执行您正在寻找的内存分析。

来自[Valgrind 常见问题解答：](http://valgrind.org/docs/manual/faq.html#faq.hiddenbug)

> 其次，如果您的程序是静态链接的，大多数 Valgrind 工具将无法正常工作，因为它们无法用自己的版本替换某些函数，例如 malloc。

# xcode4 - 在 Xcode 中重新组织框架

> ID：13588482
> 
> 赞同：1
> 
> 时间：2012-11-27T16:19:03.717
> 
> 标签：xcode4

当我在 Xcode 4.5 中添加框架时，我通过 Link Binary with Libraries 添加它（在构建阶段中）。

但是，这会将框架添加到 Xcode 中我的 Project Navigator 列表的顶部。然后，当我将它们移动到 Frameworks 文件夹时，“Link Binary with Libraries”部分中的原始框架变为红色。例如

![在此处输入图像描述](../Images/905fce415a50009d96e0120d2eb34611.png)

有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:22:41.033

右键单击框架（在链接二进制部分）并选择在 Finder 中显示直接进入文件。

该问题已通过重新启动 Xcode 得到解决。

# api - Magento 和 Drupal 会话冲突——如何解决？

> ID：13588483
> 
> 赞同：1
> 
> 时间：2012-11-27T16:19:05.417
> 
> 标签：api, magento, session, drupal

我正在尝试编写一个将 Magento 购物车加载到 Drupal 块内的块。

以下代码（位于 /test.php 中）正确加载购物车及其内容（Magento 安装位于 /magento 中）：

```
<?php
      /*
       * Initialize magento.
       */
      require_once('magento/app/Mage.php');
      umask(0);
      Mage::app('default');
      Mage::getSingleton('core/session', array('name'=>'frontend'));
      Mage::getSingleton('customer/session');
      /*
       * Add specific layout handles to our layout and then load them.
       */
      $layout = Mage::app()->getLayout();
      $layout->getUpdate()
          ->addHandle('default')
          ->load();

      /*
       * Generate blocks, but XML from previously loaded layout handles must be
       * loaded first.
       */
      $layout->generateXml()
             ->generateBlocks();

      /* 
       * Now we can simply get any block in the usual way.
       */
      $cart = $layout->getBlock('cart_sidebar')->toHtml();
      echo $cart;
?> 
```

（我正在使用 FirePHP 来调试会话值——这就是 fb(); 调用的目的。）

如果我在 Drupal 中使用完全相同的代码（通过 hook_menu 回调），我会收到以下错误：

> 致命错误：Mage_Core_Model_Session_Abstract::getMessages()：脚本试图执行方法或访问不完整对象的属性。请确保您尝试操作的对象的类定义“Mage_Core_Model_Message_Collection”在调用 unserialize()*之前*已加载，或提供 __autoload() 函数以在 /home/aendrew/workspace/drupgento/magento/ 中加载类定义app/code/core/Mage/Core/Model/Session/Abstract.php 第 215 行

我的猜测是 Drupal 正在执行某种与 Magento 冲突的会话处理——如果我在脚本开头取消设置 $_SESSION ，它会显示一个空购物车（不管里面是否真的有物品）。我还尝试将现有会话放在一个临时变量中，然后在最后执行 array_merge() ，但这也不起作用。

知道我该怎么做吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T10:28:44.813

我致力于 Joomla 和 MAgento 之间的集成，我遇到了同样的问题。我提供的解决方案可能不是最好的解决方案，但它是我发现的唯一一个在单个 PHP 脚本进程之间共享会话的解决方案。

我不得不“停止” Joomla 会话，使用 Magento 完成我的工作，然后在同一个脚本过程中重新开始 Joomla 中的会话。这是我为 Joomla 插件所做的示例，您可以从中获得灵感，因为我不了解 Drupal 框架，但在这里您会找到我为 Joomla 插件所做的代码：http: [//pastie.org /5505841#4](http://pastie.org/5505841#4)

提供的代码中最有趣的部分是方法`destroyTemporaryJoomlaSession`、`loadAndStartMagentoBootstrap`、`restartJoomlaSession`和。`startMagentoSession``stopMagentoSession`

然后我以这种方式在一些 Joomla 模块中使用这个插件：

```
$plgMageLib = new plgSystemMagelib ( );
$plgMageLib->destroyTemporaryJoomlaSession ();
if ($plgMageLib->loadAndStartMagentoBootstrap ()) :
    $plgMageLib->startMagentoSession ();

    /* Content of Magento logic, blocks or else */

    $html = '';
    $blockId = $params->get ( 'block_id', '' );
    echo JFusion_Helper_Mageselectblock::callblock ( $blockId );

    /* EOF */

    $plgMageLib->stopMagentoSession ();

endif;
$plgMageLib->restartJoomlaSession (); 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T07:04:11.723

Mage_Core_Model_Session_Abstract_Varien::start();

# android - android标题不透明度

> ID：13588486
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:19:23.537
> 
> 标签：android, header, opacity

我正在尝试构建类似的带有透明标题的列表视图，例如[Attaching a fixed, transparent, header to a ListView?](https://stackoverflow.com/questions/4737096/attaching-a-fixed-transparent-header-to-a-listview) 但是我怎样才能改变标题不透明度？我尝试在颜色代码中使用 alpha，例如：“#00bebebe”，但这没有用。

我的标题背景“title_bar_background”

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

<!-- Top color -->
<item android:bottom="20dip">
    <shape android:shape="rectangle">
        <solid android:color="#bebebe"
             /> 
    </shape>
</item>

<!-- Bottom color -->
<item android:top="20dip">
    <shape android:shape="rectangle">
        <solid android:color="#696969" /> 
    </shape>
</item>
</layer-list> 
```

我的标题布局“custom_title”

```
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
.... 
android:background="@drawable/title_bar_background"
android:id="@+id/customLayout"
> 
```

还有我的 listView，我在其中包含 custom_title

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
..... >

<include  
     layout="@layout/custom_title"
     android:layout_height="40dip"
     android:layout_width="fill_parent"/> 
```

这项改变不透明度的工作

```
View backgroundImg = findViewById(R.id.mycustomLayout);
    Drawable background = backgroundImg.getBackground();
    background.setAlpha(40); 
```

但它只有在我不将该布局包含在其他布局中时才有效。但是，当我在另一个布局中包含该布局时，我怎么能设法设置不透明度？（就像我上面的 xml 布局）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-02T06:34:02.053

通过 id 查找布局并通过设置 Alpha 更改不透明度。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-27T16:29:24.970

只需通过它的 id 找到您的标题布局，然后这样做：

```
LinearLayout headerLayout = (LinearLayout)findViewById(R.id.layoutHeader); 
AlphaAnimation alpha = new AlphaAnimation(0.5F, 0.5F);
alpha.setDuration(0); // Make animation instant
alpha.setFillAfter(true); // Tell it to persist after the animation ends
// And then on your layout
headerLayout.startAnimation(alpha); 
```

还有`View.setAlpha()`; 但它是从 API 级别 11 开始的。

编辑 ：

我们假设您的布局在另一个布局内：

```
<RelativeLayout android:id="@+id/parentLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
<ImageView ...
bla bla bla />

<LinearLayout android:id="@+id/transparentLayout"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
... your views
</LinearLayout>
...some other views

</RelativeLayout> 
```

然后你就这样做：

```
LinearLayout mytransparentLayout = (LinearLayout) findViewById(R.id.transparentLayout);
mytransparentLayout.setAlpha(0.5f); 
```

# encryption - Coldfusion数据源预生成

> ID：13588504
> 
> 赞同：1
> 
> 时间：2012-11-27T16:20:06.773
> 
> 标签：encryption, coldfusion, datasource

我正在尝试尽可能地自动化服务器启动（大型组件，puppet），但其中一个障碍是在 ColdFusion 启动时准备好 neo-datasource.xml 文件。在我打开新服务器之前，我希望生成一个供 Puppet 来源的文件。我非常想避免启动服务器、转到管理员页面、创建数据源并将数据源复制到 Puppet。

有人知道我可以预先生成 neo-datasource.xml 文件的方法吗？我可能只需要密码加密方案，但我无法弄清楚它是什么。任何有效的方法都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:53:07.810

这是 xml 配置文件上的 Adob​​e 页面：

[http://helpx.adobe.com/coldfusion/kb/ purpose-location-xml-configuration-files.html](http://helpx.adobe.com/coldfusion/kb/purpose-location-xml-configuration-files.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:39:51.813

我自己没有尝试过，但是[这篇博客文章](http://www.talkingtree.com/blog/index.cfm/2010/3/1/Adding-Data-Sources-to-ColdFusion-When-You-Dont-Have-the-Password)讨论了从服务器到服务器复制 neo-datasource.xml 文件的片段。更重要的是，它提到您可以将整个文件从服务器复制到服务器。

按理说，您应该能够使用来自一台服务器的文件来提前设置新服务器。

# c# - ImageUpload 上传两次（使用 AsyncFileUpload 和 AjaxControlToolkit）

> ID：13588507
> 
> 赞同：1
> 
> 时间：2012-11-27T16:20:15.840
> 
> 标签：c#, asp.net, ajaxcontroltoolkit, image-uploading, asyncfileupload

我正在使用`AsyncFileUpload`(AjaxControlToolkit) 在控件中上传图像。问题是上传功能 ( `AsyncFileUpload1_UploadedComplete`) 在按钮单击和页面加载上都运行，因此它会两次上传相同的图像。

代码如下所示：

正面：

```
<%@ Register TagPrefix="asp" Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit" %>
  <script type="text/javascript">
    function uploadComplete(sender, args) {
      var pathForUploadedImage = $('#uploadedHiddenField').val();
      $get("uploadImageImg").src = $('#uploadedHiddenField').val();
      $(".uploadImage").fadeIn(100);
    }
  </script>
  <asp:Image id="uploadImageImg" class="uploadImage" alt="" runat="server" ClientIDMode="Static" />
    <div id="uploadedImageDiv"></div>
    <asp:Image ID="loader" runat="server" ImageUrl="~/library/images/loading.gif" Style="display: None" />
    <asp:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server" />
    <asp:AsyncFileUpload ID="AsyncFileUpload1" runat="server" ClientIDMode="Static" CssClass="asyncFileUpload" OnClientUploadComplete="uploadComplete" OnUploadedComplete="AsyncFileUpload1_UploadedComplete" CompleteBackColor="white" Width="65" />
    <asp:HiddenField ID="uploadedHiddenField" ClientIDMode="Static"  runat="server"/> 
```

然后回来：

```
protected void AsyncFileUpload1_UploadedComplete(object sender, AjaxControlToolkit.AsyncFileUploadEventArgs e) {
  try {
    Styling.SetupStyles();
    string virualFolder = "";
    if (string.IsNullOrEmpty(UploadDirectory)) {
      virualFolder = "/" + Styling.GetStyleValue("customNewsImagesFolder", "") + "/";
    } else {
      virualFolder = "/" + Styling.GetStyleValue(UploadDirectory, "") + "/";
    }
    string fileExtension = Path.GetExtension(e.FileName);
    int fileSize = Convert.ToInt32(e.FileSize);
    string physicalFolder = Server.MapPath(virualFolder);
    string randomFileName = System.IO.Path.GetRandomFileName().Replace(".", "");
    bool isUnique = true;
    DirectoryInfo dir = new DirectoryInfo(MapPath(virualFolder));
    FileInfo[] files = dir.GetFiles();
    foreach (FileInfo myFile in files) {
      if (myFile.Name == randomFileName) {
        isUnique = false;
      }
    }
    IsAllowedFileExtension(fileExtension);
    bool error = false;
    if (!isUnique) {
      error = true;
    ScriptManager.RegisterClientScriptBlock(this.Page, this.GetType(), "tmp", "<script type='text/javascript'>alert('En fil med detta namn finns redan, var vänlig och döp om din fil');</script>", false);
    } else if (!IsAllowedMaxFileSize(fileSize)) {
      error = true;
      ScriptManager.RegisterClientScriptBlock(this.Page, this.GetType(), "tmp", "<script type='text/javascript'>alert('Filen är för stor, vänligen försök igen med en fil som är mindre än 2 MB');</script>", false);
    } else if (!IsAllowedFileExtension(fileExtension)) {
      error = true;
      ScriptManager.RegisterClientScriptBlock(this.Page, this.GetType(), "tmp", "<script type='text/javascript'>alert('Felaktigt filformat, vänligen försök igen med en fil av följande typ: .jpg .jpeg .png .gif');</script>", false);
    }
    if (!error) {
      AsyncFileUpload1.SaveAs(physicalFolder + randomFileName + fileExtension);
      string thePath = (virualFolder + randomFileName + fileExtension).Replace("\\", "/");
      ScriptManager.RegisterClientScriptBlock(this, this.GetType(), Guid.NewGuid().ToString(), "top.$get(\"" + uploadedHiddenField.ClientID + "\").value = '" + thePath + "';", true);
    }
  }
  catch (Exception ex) {
    erLog.LogException(ex, System.Reflection.MethodBase.GetCurrentMethod().Name);
  }
}
private bool IsAllowedFileExtension(string fileExtension) {
  bool valid = false;
  if (fileExtension.ToLower() == ".jpg" || fileExtension.ToLower() == ".jpeg" || fileExtension.ToLower() == ".gif" || fileExtension.ToLower() == ".png")
    valid = true;
  return valid;
}
private bool IsAllowedMaxFileSize(int fileSize) {
  bool valid = false;
  if (fileSize < 2100000)
    valid = true;
  return valid;
} 
```

# audio - 什么是常见的声音频率 -> 人类感知的信息密度图？

> ID：13588508
> 
> 赞同：0
> 
> 时间：2012-11-27T16:20:16.680
> 
> 标签：audio, mp3, signal-processing, fft

不同的声音频率被人以不同的方式感知。例如，完全可以听到的频率是从20Hz到20kHz；见[听力范围](http://en.wikipedia.org/wiki/Hearing_range)。

[如等响度曲线](http://en.wikipedia.org/wiki/Equal-loudness_contour)所示，不同的频率也以不同的灵敏度被感知；另请参阅[响度](http://en.wikipedia.org/wiki/Loudness)。这在测量人类感知的响度时是相关的，例如参见[ReplayGain](http://en.wikipedia.org/wiki/ReplayGain)。

但是，我猜想对于人类感知的信息密度，该图不一定相同（如果您可以这样称呼的话）。例如，可能存在被感知为响亮但感知信息密度不是那么高的频率。我不确定是不是这样。是吗？还是基本一样？可能我对它的理解也太天真了。

从我天真的理解 MP3 的工作原理（以及其他有损音频编码）来看，它为更重要的频率存储了更多信息，而对于不太重要的频率则存储了更少的信息。“更重要”意味着人类感知的信息密度更高。

（Meta：也许 StackOverflow 不是问这个问题的最佳 SE 网站。什么会更好？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T01:52:50.533

心理声学感知的“信息密度”很难定义。然而，刚刚可微分的音高轮廓（例如，[梅尔标度](https://en.wikipedia.org/wiki/Mel_scale)）非常接近。它不是基于关于音调/频率的感知响度，而是人类听觉系统主观感知不同音调/注意到整个频谱中音调最小变化的能力。如果“信息”是听觉事件的音高/基频，那么梅尔标度描述了每个频率的“信息密度”。

在这种情况下，您是对的，因为梅尔音阶与响度无关，尽管与某些频谱相关。正如你所说，有些频率被认为是响亮的，但这种感知的“信息密度”并不那么高。

然而，感知响度本身就是信息，对于影响信息成功传输到人类听觉系统的其他心理声学因素，您可能需要研究[临界频带](https://en.wikipedia.org/wiki/Critical_bands)，尤其是[听觉掩蔽](https://en.wikipedia.org/wiki/Auditory_masking)。

# ruby-on-rails - Ruby on Rails 范围错误

> ID：13588514
> 
> 赞同：0
> 
> 时间：2012-11-27T16:20:41.593
> 
> 标签：ruby-on-rails

我在名为“clients”的表中有一个名为“archive”的布尔字段。在client.rb中，我有：

```
scope :archived, where(:archive => true)
scope :active, where(:archive => false) 
```

在我的 clients/index.html.erb 中，我有：

```
<% @clients.archived.each do |client| %> 
```

但是，我得到了错误

```
undefined method `archived' for #<Array:0x007fcb441f7d60> 
```

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:14:17.577

你必须做这样的事情

```
Client.archived.find_each do |client| 
```

# sql - 在 Rails 中进行 destroy_all 的更有效方法？

> ID：13588515
> 
> 赞同：7
> 
> 时间：2012-11-27T16:20:44.710
> 
> 标签：sql, ruby-on-rails, postgresql, activerecord, performance

有没有更快的方法来销毁所有轨道？

我问这个是因为 rails 对每条记录进行单独的删除 sql 查询。

例如，在搜索 4 条记录时调用 destroy all 将运行 4 个 delete sql 命令。

```
Blerg.where("created_at > yesterday").destroy_all (4 results) 
```

然后调用...</p>

```
DELETE FROM "blergs" WHERE "blergs"."id" = $1  [["id", 197782]] 
```

4次。

有没有办法把它变成一个 sql 命令？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T16:25:55.930

你总是可以打电话

```
Blerg.where("created_at > yesterday").delete_all 
```

这只给出一个查询：

```
DELETE FROM "blergs" WHERE (created_at > '2012-11-26 16:27:56.678872') 
```

请注意，这不会对要删除的对象调用任何回调。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T17:16:36.190

你也可以做

```
Blerg.delete_all("created_at > '2012-11-01 00:00:00'") 
```

哪个更简洁。它执行一条 SQL 语句。

# python - 使用查询选项为 CouchDB 编码 curl-ready URL

> ID：13588516
> 
> 赞同：2
> 
> 时间：2012-11-27T16:20:45.210
> 
> 标签：python, couchdb, couchdb-python

我正在使用[couchdb-python](http://code.google.com/p/couchdb-python/)来访问我的 CouchDB 后端。有时我想知道库正在访问的 URL，以便使用`curl`或任何其他工具访问**完全相同**的 URL。也就是说，我希望能够复制/粘贴编码的 URL 并执行 curl 访问，**而无需手动编辑任何内容**。

由于`couchdb-python`没有给我这些信息，我构建了一个小工具来获取 URL：

```
import urllib

def get_couchdb_url(server, database, design_doc, view_name, **options):
    prefix = 'http://%s:%d' % (server, 5984)
    url = '/'.join([prefix, database, "_design", design_doc, '_view', view_name])
    params = urllib.urlencode(options)
    if params != "" : url += "?" + params
    return url

number='+666666666'
print get_couchdb_url('localhost', 'phonenumbers', 'control', 'allgeonums', key = number) 
```

这给了我以下网址：

```
http://localhost:5984/phonenumbers/_design/control/_view/allgeonums?key=%2B666666666 
```

如果我使用 curl 访问，它会给出：

```
curl -X GET 'http://localhost:5984/phonenumbers/_design/control/_view/allgeonums?key=%2B666666666'
{"error":"bad_request","reason":"invalid_json"} 
```

如果我手动编辑 URL，在键值之前和之后添加 %22，CouchDB 会接受它并给我正确的答案：

```
curl -X GET 'http://localhost:5984/phonenumbers/_design/control/_view/allgeonums?key=%22%2B666666666%22' 
```

现在我有两个问题：

*   Can `couchdb-python` show me the URL it is accessing?
*   How can I tell urllib.urlencode to produce encoded data which can be accepted by CouchDB? According to the [manual](http://wiki.apache.org/couchdb/HTTP_view_API), the values must be url encoded. I am not sure how to do this, for the general case. I would like to avoid having to read the `couchdb-python` sources for just this simple problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:02:52.123

Sure it could and pretty simple, but using some internals:

```
import couchdb
from couchdb.http import urljoin
from couchdb.client import _encode_view_options
server = couchdb.Server()
db = server['blog']
res = db.view('posts/by_author', key='Mike', reduce=False, include_docs=True)
print urljoin(res.view.resource.url, **_encode_view_options(res.options)) 
```

Will give you output:

`http://localhost:5984/blog/_design/posts/_view/by_author?key=%22Mike%22&reduce=false&include_docs=true`

[`_encode_view_options`](http://code.google.com/p/couchdb-python/source/browse/couchdb/client.py#1024) the only need to enforce JSON value for `key`, `startkey` and `endkey` parameters and encode in same way any non string ones. You may just implement this function by yourself if import private functions is unavailable for some reasons.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:06:41.980

It seems the values in the query options must be first converted to json, and *then* they can be url-encoded. I have come up with the following code:

```
import simplejson as json
import urllib

def json_encode_options(**options):
    json_options = { }
    for k, v in options.iteritems():
        v_encoded = json.dumps(v)
        json_options[k] = v_encoded
    return urllib.urlencode(json_options)

def get_couchdb_url(server, database, design_doc, view_name, **options):
    prefix = 'http://%s:%d' % (server, 5984)
    url = '/'.join([prefix, database, "_design", design_doc, '_view', view_name])
    params = json_encode_options(**options)
    if params != "" : url += "?" + params
    return url

number='+666666666'
print get_couchdb_url('localhost', 'phonenumbers', 'control', 'allgeonums', key = number) 
```

# python - 致命错误：升级到 python 3.2 并从 virtualenv 安装某些模块后找不到“string.h”文件

> ID：13588518
> 
> 赞同：2
> 
> 时间：2012-11-27T16:20:44.950
> 
> 标签：python, pip, pycrypto, python-3.2

我在 Mac OSX 10.8 (Mountain Lion) 上并且刚刚安装了 Python 3.2.3。

使用该版本的 python 从虚拟环境安装 pycrypto 时：

```
$ virtualenv --no-site-packages -p /usr/local/bin/python3.2-32 venv
$ source venv/bin/activate
$ pip install pycrypto 
```

我得到错误：

```
gcc-4.2 not found, using clang instead

building 'Crypto.Hash._MD2' extension

warning: GMP or MPIR library not found; Not building Crypto.PublicKey._fastmath.

Compiling with an SDK that doesn't seem to exist: /Developer/SDKs/MacOSX10.6.sdk

Please check your Xcode installation

clang -fno-strict-aliasing -fno-common -dynamic -isysroot /Developer/SDKs/MacOSX10.6.sdk -arch i386 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.6.sdk -std=c99 -O3 -fomit-frame-pointer -Isrc/ -I/Library/Frameworks/Python.framework/Versions/3.2/include/python3.2m -c src/MD2.c -o build/temp.macosx-10.6-intel-3.2/src/MD2.o

src/MD2.c:30:10: fatal error: 'string.h' file not found

#include <string.h>

         ^

1 error generated.

error: command 'clang' failed with exit status 1 
```

尝试安装加密货币时也会发生类似的事情。

[从 2.4 版开始，Pycrypto 表示它支持 python 3。](https://github.com/dlitz/pycrypto/blob/master/ChangeLog#L89)

我在 xcode 开发者文件夹中添加了一个符号链接：

```
$ sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer /Developer 
```

但该文件夹中存在的所有内容都是 MacOSX10.7.sdk MacOSX10.8.sdk（不是上面需要的 MacOSX10.6.sdk）。

我的系统中是否缺少任何内容？我如何告诉它使用其他 SDK 之一？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T19:42:18.663

通过执行以下操作使其工作：

如上面的评论，确保安装了命令行工具，它也安装了系统头文件：

> 启动 Xcode，打开 Xcode -> Preferences... 并转到 Downloads 选项卡。在组件下确保安装了命令行工具；这还将在系统文件夹中安装系统头文件。

按照[此答案](https://stackoverflow.com/questions/10557857/install-numpy-for-python-3-2-3-on-os-x-10-7-4)中的说明，创建指向开发人员文件夹的符号链接：

```
sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer /Developer 
```

但是，仍然会出现错误消息：

```
Compiling with an SDK that doesn't seem to exist: /Developer/SDKs/MacOSX10.6.sdk 
```

这与[Python 3.2 假设您使用的是 Mac OSX 10.6 的问题有关](http://bugs.python.org/issue14498)

我通过创建从 OSX 10.6 环境到 OSX 10.8 环境的符号链接来伪造 OSX 10.6 环境，从而解决了这个问题：

```
sudo ln -s /Developer/SDKs/MacOSX10.8.sdk MacOSX10.6.sdk 
```

包现在成功安装。

# c# - 获取具有属性组合的类实例的集合

> ID：13588520
> 
> 赞同：0
> 
> 时间：2012-11-27T16:20:46.853
> 
> 标签：c#, linq, reflection, attributes, combinatorics

我遇到了以下问题。

考虑以下简单属性。

```
[AttributeUsage(AttributeTargets.Property)]
public class CombinationsAttribute : Attribute
{
    public object[] PossibleValues { get; private set; }
    public CombinationsAttribute(params object[] values)
    {
        this.PossibleValues = values;
    }
} 
```

以下是属性使用示例 - 只是一些具有一些虚拟属性的类，进入属性的值数组始终是属性类型。

```
public class MyClass
{

    [Combinations(1, 2, 3, 4, 5)]
    public int IntProperty1 { get; set; }

    [Combinations(10, 15, 20, 25, 30)]
    public int IntProperty2 { get; set; }

    [Combinations("X", "Y", "Z")]
    public string StringProperty { get; set; }
} 
```

我想获取所有组合的所有实例（本例中为 5 * 5 * 3）。我怎样才能编写尽可能少的代码（LINQ 受青睐）？

**编辑：我不知道类（MyClass） - 有许多具有公共属性的类具有 CombinationsAttribute，我需要为其计算所有可能的组合。.** 这些类总是有无参数的构造函数。

预期结果示例（用于可视化的伪 c#）：

```
List<MyClass> Combinations = GetCombinationMagicFunction(typeof(MyClass));

List[0] = MyClass { IntProperty1 = 1, IntProperty2 = 10, StringProperty = "X" }
List[1] = MyClass { IntProperty1 = 1, IntProperty2 = 10, StringProperty = "Y" }
List[2] = MyClass { IntProperty1 = 1, IntProperty2 = 10, StringProperty = "Z" }
List[2] = MyClass { IntProperty1 = 1, IntProperty2 = 15, StringProperty = "X" }
...
List[74] = MyClass { IntProperty1 = 5, IntProperty2 = 30, StringProperty = "Z" } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:01:45.027

借助 Eric Lippert 的[`CartesianProduct`方法](http://blogs.msdn.com/b/ericlippert/archive/2010/06/28/computing-a-cartesian-product-with-linq.aspx)：

```
private static IEnumerable<IEnumerable<T>> CartesianProduct<T>(IEnumerable<IEnumerable<T>> sequences) 
{ 
   IEnumerable<IEnumerable<T>> emptyProduct = new[] { Enumerable.Empty<T>() }; 
   return sequences.Aggregate(emptyProduct, (accumulator, sequence) => accumulator.SelectMany(accseq => sequence.Select(item => accseq.Concat(new[] { item }))));
}

public static IEnumerable<T> BuildCombinations<T>() where T : new()
{
   var query = from prop in typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance)
               let attributes = prop.GetCustomAttributes(typeof(CombinationsAttribute), false)
               where attributes != null && attributes.Length != 0
               let attribute = (CombinationsAttribute)attributes[0]
               select attribute.PossibleValues.Select(value => new { prop, value })
   ;

   var combinations = CartesianProduct(query);
   foreach (var combination in combinations)
   {
      var item = new T();
      foreach (var pair in combination)
      {
         pair.prop.SetValue(item, pair.value, null);
      }

      yield return item;
   }
} 
```

用法：

```
var list = BuildCombinations<MyClass>().ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:35:44.660

我的基本出发点是沿着这些思路。您需要使用一些反射来重新设置值，但您应该明白这一点。

```
var properties = type.GetProperties()
                      .Where(prop => prop.IsDefined(typeof(CombinationsAttribute), false));
foreach(var prop in properties)
{
    allCombinations.Add(instance);
    var attributes = (CombinationsAttribute[])prop.GetCustomAttributes(typeof(CombinationsAttribute), false);
    foreach(var value in attributes)
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:51:45.383

```
private class PropertyItem
{
    public PropertyInfo Property { get; set; }
    public List<object> PossibleValues { get; set; }
    public int CurrentIndex { get; set; }
    public int Count { get; set; }
}

public IEnumerable<T> GenerateCombinations<T>() where T : new()
{
    return GenerateCombinations(typeof(T)).Cast<T>();
}

public IEnumerable<object> GenerateCombinations(Type type)
{
    // Collect nessecery information
    var constructor = type.GetConstructor(Type.EmptyTypes);
    var properties =
        (
            from p in type.GetProperties()
            let values = p.GetCustomAttributes(typeof(CombinationsAttribute), true)
                .Cast<CombinationsAttribute>()
                .SelectMany(a => a.PossibleValues)
                .ToList()
            where values.Count > 0
            select new PropertyItem
            {
                Property = p,
                PossibleValues = values,
                CurrentIndex = 0,
                Count = values.Count,
            }
        )
        .ToList();

    bool isDone;
    do
    {
        // Construct and return the current item
        var item = constructor.Invoke(new object[0]);
        foreach (var prop in properties)
        {
            prop.Property.SetValue(item, prop.PossibleValues[prop.CurrentIndex]);
        }
        yield return item;

        // Move the indices to the next item
        isDone = true;
        for (int i = 0; i < properties.Count; i++)
        {
            var prop = properties[i];
            if (prop.CurrentIndex == prop.Count - 1)
            {
                prop.CurrentIndex = 0;
            }
            else
            {
                prop.CurrentIndex++;;
                isDone = false;
                break;
            }
        }
    }
    while (!isDone);
} 
```

**用法：**

```
var allObjects1 = GenerateCombinations<MyClass>().ToList();
var allObjects2 = GenerateCombinations(typeof(MyClass)).ToList(); 
```

# ember.js - 使用 ember.js 设置页面标题

> ID：13588523
> 
> 赞同：22
> 
> 时间：2012-11-27T16:21:00.320
> 
> 标签：ember.js

设置页面标题的最佳方法是什么，以便在 url 之间转换时，标题将反映新状态？有没有办法设置路由器来做到这一点？

我想要一种允许我为每个状态设置页面标题架构的方法。因此，如果路由有参数，它们将被传递到 pageTitle：

```
sessions : Ember.Route.extend({
       route:"/sessions",
       connectOutlets : function(router) {
           //...
       },
       pageTitle:function(){
            return "Sessions";
       },
   }) 
```

对于如何最好地在模型或其他地方实现这种类型的功能，我愿意接受任何建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T18:03:18.047

之前的答案适用于旧版本的 Ember。经过几次更改，框架已达到 1.0 RC2 版本，并且接近最终版本，因此我决定更新此答案。

例如，请查看此小提琴中定义的路由：http: [//jsfiddle.net/schawaska/dWcUp/](http://jsfiddle.net/schawaska/dWcUp/)

这个想法与之前的答案相同，只是方式不同，因为路由 API 发生了很大变化。

下面的 Route 使用`activate`钩子通过 jQuery 设置文档的标题：

```
App.ProductRoute = Em.Route.extend({
    activate: function() {
        $(document).attr('title', 'Auto Web Shop - Product');
    }
}); 
```

**编辑**：如评论部分所述：

> 仅供参考[activate](http://emberjs.com/api/classes/Ember.Route.html#method_activate)是 API 方法，而不是[输入](https://github.com/emberjs/ember.js/blob/v1.0.0-rc.2/packages/ember-routing/lib/system/route.js#L29)- [pauldechov](https://stackoverflow.com/users/363073/pauldechov)

* * *

**这个答案在之前的 Ember 版本中给出，现在不再适用。**

在你的内部`connectOutlets`，你可以做一些简单的事情，比如使用 jQuery 来修改文档的`title`属性：

```
[...]
home: Em.Route.extend({
    route: '/',
    connectOutlets: function (router, context) {                
        // router.set('navbarController.selected', 'home');                     
        router.get('applicationController')
              .connectOutlet('home');                     

        $(document).attr('title', 'YOUR TITLE GOES HERE');
    }
}),                
[...] 
```

但是你必须对每条路线都这样做。

如果您有设置选定导航菜单项的导航栏控制器之类的东西，您可以观察`selected`属性以将“活动”或“选定”css 类绑定到导航项并设置页面标题；或者您可以在通过上下文的navitem 模型上拥有一个仅用于标题的属性（但我相信您必须在视图中处理此问题并从那里过渡到路线）。

无论如何，这只是为了展示设置页面标题的一种可能方式。

**编辑**：我已经修改了一个现有的小提琴来做到这一点。看看`navigateTo`路由器中的方法：http: [//jsfiddle.net/schawaska/hEx84/](http://jsfiddle.net/schawaska/hEx84/)（要查看它运行到这里[http://jsfiddle.net/schawaska/hEx84/show/](http://jsfiddle.net/schawaska/hEx84/show/)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-26T09:17:50.077

由于我努力想出一个很好的模式来设置页面标题，使用最新的 Ember.js (1.0.0 RC7)，我决定创建一个子类`Ember.Route`：

```
AppRoute = Ember.Route.extend({
    renderTemplate: function(controller, model) {
        this.render();

        var pageTitle = this.title ? this.title(controller, model) : null;
        document.title = pageTitle ? pageTitle : "Default Title";
    }
});

// all routes extend this new 'AppRoute'

App.PageRoute = AppRoute.extend({
    model: function(params) {
        // return your model
        return App.Page.find(params.page_id);
    },
    title: function(controller, model) {
        // return whatever should be your page title
        return controller.get('title');
    },
}); 
```

如果合并此拉取请求，Ember.js 可能会原生支持这一点：[路由器现在观察路由处理程序上的 'title' 属性并设置 document.title](https://github.com/emberjs/ember.js/pull/2757)。**注意：**`controller`这个拉取请求似乎没有`model`作为参数传递。

如果您更喜欢 Coffee Script 等价物：[Ember.js：一种设置页面标题的简单明了的方法](http://blog.mazaheri.me/post/59375774802/ember-js-an-easy-and-clean-way-to-set-the-page-title)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-06T20:57:39.870

我采用了这种方法：

```
Ember.Route.reopen({
    enter: function(router) { 
        this._super(router)

        # Set page title
        name = this.parentState.get('name')
        if (!Em.none(name)) {
            capitalizedName = name.charAt(0).toUpperCase() + name.slice(1)
            $(document).attr('title', "Website - " + capitalizedName)
        }
   }
}) 
```

使用 navigateTo 时出现了一些问题，至少对于我的情况而言，这最终变得更加可靠和清洁。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-01T19:37:39.350

在[对这个拉取请求进行了长时间的讨论](https://github.com/emberjs/ember.js/pull/3689)之后，决定这不属于核心。有一个实现该功能的[组件和 ember-cli 插件。](https://github.com/paddle8/ember-document-title)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-04-10T18:20:29.143

我在 Ember 1.4.0 中使用了以下方法：

```
App.PageTitle = Ember.Object.create({
    defaultTitle: 'This route has no title defined'
});

RouteWithTitle = Ember.Route.extend({
    activate: function() {
            if ('title' in this){
                document.title = this.title;
                App.PageTitle.set('title',this.title);
            }else{
                document.title = App.PageTitle.defaultTitle;
                App.PageTitle.set('title',this.title);
            }
    }
});

App.ExampleRoute = RouteWithTitle.extend({
    title: 'This is an example route'
});
App.AnotherRoute = RouteWithTitle.extend({
    title: 'This is another route'
}); 
```

（类似于 Micha Mazaheri 的回答。）

您可以使用 title 属性为每个路由定义一个标题。页面标题会自动更新，您可以在任何车把模板中使用 {{App.PageTitle.title}} 调用标题

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-22T02:17:11.937

我有同样的问题。

注意：您可以通过编辑更改起始标题`app/index.html`

代替简单而有福的方式（我敢肯定，Ember 开发人员正忙于更重要的事情），我发现最优雅的答案来自**CodeJack** [在这里找到](https://stackoverflow.com/questions/18445064/ember-handlebars-templates-in-head-tag/18506533#18506533)：

> ```
> // file: app/helpers/head-title.js    
> 
> import Ember from 'ember';
> 
> export function headTitle(title) {
>   Ember.$('head').find('title').text(title);
> }
> 
> export default Ember.Helper.helper(headTitle); 
> ```
> 
> 现在在任何视图模板中，您只需添加助手
> 
> ```
> {{head-title 'View Header'}} 
> ```

已编辑：Ember 2.0 的更新代码

来源：[<head> 标签中的 Ember 车把模板](https://stackoverflow.com/questions/18445064/ember-handlebars-templates-in-head-tag/18506533#18506533)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-12T16:03:38.770

在您的路线中快速而肮脏的方法：

```
actions: {
  didTransition: function() {
    Ember.$('title').text('My awesome page title');      
  }
} 
```

# apex-code - VisualForce 只调用一次 getter 方法

> ID：13588527
> 
> 赞同：-2
> 
> 时间：2012-11-27T16:21:07.200
> 
> 标签：visualforce, visualforce, apex-code, visualforce

我希望 getter 方法在多次调用时返回不同的值。类似于下面的一个：

```
Iterator<String> itr = new List<String>{'one','two','three','four','five'}.iterator();

public String getValue(){
    if(itr.hasNext())
        return itr.next();
    else
        return 'No more values';
} 
```

在[visualforce](/questions/tagged/visualforce "显示标记为“visualforce”的问题")中，我这样使用它：

```
<!-- getNumber() called 5 times in a single visualforce page, NOT in a loop -->
{!value}
{!value}
{!value}
{!value}
{!value}
{!value} 
```

输出是：

```
one one one one one one 
```

有没有办法让它打印出来：

```
one two three four five No more values 
```

似乎[visualforce](/questions/tagged/visualforce "显示标记为“visualforce”的问题")解析器只调用一次 getValue() 并缓存页面其余部分的值。

使迭代器静态或

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:17:49.663

请不要使用有副作用的吸气剂......我并不惊讶他们实际上正在缓存这些值，并且没有多少`transient`可以拯救你。

您可以通过公开`List<String> values {get;private set;}`然后在 Visualforce 调用中`{!values[3]}`甚至`{!values[i]}`（其中`i`可以是来自控制器的 Integer 变量，或者即使`<apex:variable>`这非常核心......只需对控制器中的字符串/页面名称数组进行排序并以“固定顺序”显示它们" 使用 VF 端的索引？

（顺便说一下，数组语法非常强大，如果你有`String fieldName = 'AccountNumber';`，你可以`{!acc[fieldName]}`在 VF 中进行运行时绑定）

另一种选择是探索动态 Visualforce 组件？不过，您似乎不能使用它们`<apex:include>`。但是我知道如果这有帮助的话，我过去没有任何问题，包括重复的自定义组件......

# jsp - 在jsp中显示日期差异

> ID：13588530
> 
> 赞同：5
> 
> 时间：2012-11-27T16:21:13.867
> 
> 标签：jsp, jstl

我在数据库中有一个日期字段，它只存储没有时间的日期。现在我想知道在 jsp 页面中显示当前日期和我的日期字段的天数差异。

所以我应该喜欢

```
 databaseDate(2012-11-30) - currentDate(2012-11-27)  = 3 days 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T20:23:02.953

[在标准JSTL](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/)中没有这样的东西。自定义 EL 函数将是您最好的选择。

首先实现一些执行这项工作的静态方法：

```
public final class Functions {

    private Functions() {}

    public static int daysBetween(Date before, Date after) {
        // ...
    }

    public static int daysUntilToday(Date date) {
        // ...
    }

} 
```

如果您在以下位置注册它`/WEB-INF/functions.tld`：

```
<?xml version="1.0" encoding="UTF-8" ?>
<taglib 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd"
    version="2.1">

    <tlib-version>1.0</tlib-version>
    <short-name>Custom_Functions</short-name>
    <uri>http://example.com/functions</uri>

    <function>
        <name>daysBetween</name>
        <function-class>com.example.Functions</function-class>
        <function-signature>boolean daysBetween(java.util.Date, java.util.Date)</function-signature>
    </function>
    <function>
        <name>daysUntilToday</name>
        <function-class>com.example.Functions</function-class>
        <function-signature>boolean daysUntilToday(java.util.Date)</function-signature>
    </function>
</taglib> 
```

那么您将能够按如下方式使用它，前提是`#{bean.date}`返回一个完全值得的`java.util.Date`：

```
<%@taglib uri="http://example.com/functions" prefix="f" %>

${f:daysUntilToday(bean.date)} days 
```

* * *

您可以自由选择实施。我个人更喜欢[Joda Time](http://joda-time.sourceforge.net/)：

```
public static int daysBetween(Date before, Date after) {
    return Days.daysBetween(new DateTime(before.getTime()), new DateTime(after.getTime())).getDays();
}

public static int daysUntilToday(Date date) {
    return Days.daysBetween(new DateTime(date.getTime()), new DateTime()).getDays();
} 
```

或者，如果您受限于标准 Java API，则回退到众所周知的`Calendar`样板文件（不幸的是，JSR-310 没有进入 Java 7，我们必须[等待](http://sourceforge.net/apps/mediawiki/threeten/index.php?title=ThreeTen)Java 8）：

```
public static int daysBetween(Date before, Date after) {
    Calendar c1 = createCalendarWithoutTime(before);
    Calendar c2 = createCalendarWithoutTime(after);
    int days = 0;

    for (;c1.before(c2); days++) {
        c1.add(Calendar.DATE, 1);
    }

    return days;
}

public static int daysUntilToday(Date date) {
    return daysBetween(date, new Date());
}

private static Calendar createCalendarWithoutTime(Date date) {
    Calendar calendar = Calendar.getInstance();
    calendar.setTime(date);
    calendar.set(Calendar.HOUR_OF_DAY, 0);
    calendar.set(Calendar.MINUTE, 0);
    calendar.set(Calendar.SECOND, 0);
    calendar.set(Calendar.MILLISECOND, 0);
    return calendar;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:24:00.627

你可以尝试这样的事情： -

```
<html>
<head>
<script>
function dateDiff(dateform) {
date1 = new Date();
date2 = new Date();

date1temp = new Date(dateform.firstdate.value);
date1.setTime(date1temp.getTime());

date2temp = new Date(dateform.seconddate.value);
date2.setTime(date2temp.getTime());

timediff = Math.abs(date1.getTime() - date2.getTime());
days = Math.floor(timediff / (1000 * 60 * 60 * 24)); 
dateform.difference.value = days;
return false; 
}
</script>
</head> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T06:34:32.357

```
 Calendar calendar1 = Calendar.getInstance();
  Calendar calendar2 = Calendar.getInstance();
  calendar1.set(2007, 01, 10);
  calendar2.set(2007, 07, 01);

  long milliseconds1 = calendar1.getTimeInMillis();
  long milliseconds2 = calendar2.getTimeInMillis();
  long diff = milliseconds2 - milliseconds1;
  long diffSeconds = diff / 1000;
  long diffMinutes = diff / (60 * 1000);
  long diffHours = diff / (60 * 60 * 1000);
  long diffDays = diff / (24 * 60 * 60 * 1000);

  System.out.println("\nThe Date Different Example");
  System.out.println("Time in milliseconds: " + diff + " milliseconds.");
  System.out.println("Time in seconds: " + diffSeconds + " seconds.");
  System.out.println("Time in minutes: " + diffMinutes + " minutes.");
  System.out.println("Time in hours: " + diffHours + " hours.");
  System.out.println("Time in days: " + diffDays + " days."); 
```

# ruby-on-rails - Rails 3，Feedzirra - nil:NilClass 的未定义方法“条目”

> ID：13588532
> 
> 赞同：2
> 
> 时间：2012-11-27T16:21:16.123
> 
> 标签：ruby-on-rails, ruby, rss, feed, feedzirra

这是我尝试解析的提要的结构：

```
<rss xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:slash="http://purl.org/rss/1.0/modules/slash/" version="2.0">
<channel>
<title>
  title..
</title>
<atom:link href="http://url/news/feed/" rel="self" type="application/rss+xml"/>
<link>http://url</link>
<description>
  … description...
</description>
<lastBuildDate>Tue, 20 Nov 2012 14:37:30 +0000</lastBuildDate>
<language>sk-SK</language>
<sy:updatePeriod>hourly</sy:updatePeriod>
<sy:updateFrequency>1</sy:updateFrequency>
<generator>http://wordpress.org/?v=3.4.2</generator>
<item>
<title>title</title>
<link>
   link
</link>
<comments>
   link to comments
</comments>
<pubDate>Tue, 20 Nov 2012 13:29:05 +0000</pubDate>
<dc:creator>fcomp</dc:creator>
<category>
<![CDATA[ Novinky ]]>
</category>
<guid isPermaLink="false">http://url/?p=560</guid>
<description>
<![CDATA[
<p>text
]]>
<![CDATA[
  text
]]>
</description>
<content:encoded>
<![CDATA[
  text
]]>
</content:encoded>
<wfw:commentRss>
  url
</wfw:commentRss>
<slash:comments>0</slash:comments>
</item>
... 
```

以及我如何解析它：

```
 def rss_feed
    feed = Feedzirra::Feed.fetch_and_parse("http://url/news/feed/")
    feed.entries.each do |entry|
      puts entry.inspect
    end
  end 
```

这段代码让我工作了很长时间，但现在我检查了这段代码的输出，输出是：

```
undefined method `entries' for nil:NilClass 
```

我不知道，为什么突然代码不起作用，RSS仍然有相同的输出。这是一个错误`Feedzirra`还是哪里可能有问题？

最终，有没有什么好的替代`Feedzirra`宝石？我读过类似的问题有更多的开发人员，但我没有找到错误消息的原因......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-15T14:45:47.090

我有同样的问题。在我的意外中，它是错误的提要 url（我想解析），因此，变量`feed`为 nil，它被称为此错误。

尝试检查您的网址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-04T16:05:03.243

Feedzirra 提供了一个 sanitize 方法，应该在解析条目数据之前使用，如下所示：

```
feed.sanitize_entries! 
```

此外，提要可以并且确实提供可变的输入数据。在访问它们之前检查条目和字段是否有 nil 或其他意外数据是谨慎的做法。

# asp.net-mvc - 从助手调用函数javascript

> ID：13588536
> 
> 赞同：0
> 
> 时间：2012-11-27T16:21:23.370
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

出于安全原因，我用剃刀在 ASP.NEt MVC4 中开发了一个应用程序，它定义了一个库 (dll) 一个帮助程序，以便在这个 dll 中为我们的 GUI 组件 (javascript/jquery) 充电。

在视图代码 index.cshtml 调用跟随助手（Html.ToolBarControl（“Person”））：

```
@using CrdToolBar;
@model MvcCrdToolBar.Models.Persona
@{
  ViewBag.Title = "Index";
}
<h2>Registro de Persona</h2>
@using (Html.ToolBarControl("Persona")) { } 
```

查看页面代码时，我将其称为顶部的 javascript 函数，在需要此函数之前创建或添加之后有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:32:49.150

If I understand you correctly you need to initialise some JS function/object *before* you call the Html.ToolbarControl helper? Couple of ways this can be done:

If you just want to have the JS inline then you can pretty much introduce it before you call it e.g.

```
<script type="text/javascript">

    // JS here

</script>
@using (Html.ToolBarControl("Persona")) { } 
```

If you have a master layout, introduce a new section for the head which will allow you to inject JS directly from your index.cshtml page (by default MVC already does this for you)

**Layer.cshtml**

```
<head>
    @RenderSection("Head", false);
</head> 
```

**Index.cshtml**

```
@using CrdToolBar;
@model MvcCrdToolBar.Models.Persona
@section Head {
    <script type="text/javascript">
        // JS here
    </script>
}
@{
     ViewBag.Title = "Index";
}

<h2>Registro de Persona</h2>
@using (Html.ToolBarControl("Persona")) { } 
```

# javascript - 如何强制导航器显示全年时间表，即使其中的数据集体不跨越一整年

> ID：13588537
> 
> 赞同：1
> 
> 时间：2012-11-27T16:21:35.823
> 
> 标签：javascript, highcharts, highstock

我正在使用 highstock 1.2.4 库，我们希望实现以下目标

*   从导航按钮中，我单击“1y”一年。从今天开始应该显示，2011 年 11 月 27 日至 2012 年 11 月 27 日
*   有 3 个点要绘制，Y 轴（垂直）代表压力，x 轴（水平）代表从 2011 年 11 月 27 日到今天的时间。
*   问题是所有 3 组点都从今年 10 月的不同点开始，但所有数据都运行到现在
*   我得到的印象是 highstock 然后尝试缩放此数据并且导航器因此受到影响

那么 - 我如何强制导航器显示我选择的时间线（27/11/2011 - 27/11/20212），其中 3 个系列从图表的右侧开始？我们希望它以这种方式工作，以便用户可以看到直到最近才捕获到任何数据。

其他图表可能会显示在去年底的一段时间内捕获的数据，从而提供时间线的真实表示。

到目前为止，该组件似乎在尝试扩展数据，我们不希望它这样做。我已经搜索了文档，但时间不多了，我猜想那里有人以前会这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:28:32.653

假设您知道导航器应该显示的最小值/最大值是什么，或者如果您希望它始终上升到“现在”，您可以执行以下操作：

```
navigator : {
  xAxis: {
      max : new Date().getTime()
  }
} 
```

在您的图表选项中。

# java - 当第一个线程锁定类时，第二个线程会发生什么

> ID：13588542
> 
> 赞同：0
> 
> 时间：2012-11-27T16:21:56.213
> 
> 标签：java, multithreading, thread-safety, locking

好的，假设我有一个具有线程安全实现的 Java Math 类。线程 A 现在正在执行 SetValue(1)，它会导致 Math 类被锁定。如果线程 B 同时尝试使用 GetValue() 访问，会发生什么情况？会不会等到锁释放或者方法请求会直接终止，没有警告或异常？

```
public class Math {
      private static int value = 0;

      public synchronized static void setValue(int value) {
           Math.value = value;
      }

      public synchronized static int getValue() {
           return value;
      }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:23:51.517

是的，第二个线程将等到锁再次可用。如果锁永远不可用，您将遇到活性问题，并且您的第二个线程将挂起。

在[JLS 17.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.1)中有更详细的描述：

> 同步方法在调用时会自动执行锁定操作；在锁定操作成功完成之前，它的主体不会被执行。[...] 如果方法主体的执行正常或突然完成，则会在同一监视器上自动执行解锁操作。

另请注意：

> Java 编程语言既不防止也不要求检测死锁条件。线程持有（直接或间接）多个对象锁的程序应该使用传统技术来避免死锁，如有必要，创建不会死锁的更高级别的锁定原语。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:29:31.960

一个小插图：

```
public class Math {

 private static int value = 0;

 public synchronized static void SetValue(int _value) throws InterruptedException {

  Thread.sleep(1000L);
  value = _value;
 }

 public synchronized static int GetValue()  {

  return value;
 }

 public static void main(String[] args) {

  new Thread(new Runnable() {

   @Override
   public void run() {

    try {
     SetValue(-100);
    } catch (InterruptedException e) {
     // ignore
    }
   }
  }).start();

  new Thread(new Runnable() {

   @Override
   public void run() {

    System.out.println("GetValue() = " + GetValue());
   }
  }).start();
 }
} 
```

输出是：

```
GetValue() = -100 
```

这意味着第二个线程将等待第一个线程在休眠一秒钟并将其设置`value`为`100`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:23:41.323

如果需要，它将永远等待第一个线程释放锁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T16:24:11.230

被`Thread`添加到等待队列中，并且在`Thread A`执行该`SetValue`方法之前一直保持在那里，并且不会释放锁。

一旦`Thread A`释放锁，`Thread B`就会收到通知，之后可以继续。

另请注意，当`Thread A`进入该`SetValue`方法时，它会在该类的所有同步方法上获取锁。所以，在方法执行完成之前`Thread B`不能执行任何操作，并逐渐释放锁。`synchronized method``Thread A``SetValue`

还有一件事，不能保证一旦锁被释放`Thread B`就会立即开始执行该方法。`GetValue`这完全取决于 CPU，它何时将资源分配给线程 B。

* * *

**PS： -** 请在您的代码中遵循 Java 命名约定。您的方法名称应以`lowercase`字母开头。所以，你的方法应该是`getValue`and `setValue`。

# magento - 将magento“排序依据”放在“每页显示”旁边

> ID：13588547
> 
> 赞同：0
> 
> 时间：2012-11-27T16:22:04.637
> 
> 标签：magento, layout

我正在尝试将magento“排序依据”下拉选项移动到“每页显示X”下拉列表旁边。我已经有些成功了。

在toolbar.phtml文件（Template/catalog/product/list/toolbar.phtml）中，我使用了“sort-by”类的div并将其及其内容移动到“pager”div中（相同的文件（ toolbar.phtml))，我还修改了 css 以使其看起来正确。

现在，如果我访问我网站中的任何页面，顶部工具栏没有任何功能，但底部工具栏没问题？！？！？

即使在 list.phtml 中它们被同一行调用-->

```
<?php echo $this->getToolbarHtml() ?> 
```

任何人都知道是什么原因造成的？

我的工具栏代码如下

```
<div class="toolbar">
    <div class="pager">
        <p class="amount">
            <?php if($this->getLastPageNum()>1): ?>
                <?php echo $this->__('Items %s to %s of %s total', $this->getFirstNum(), $this->getLastNum(), $this->getTotalNum()) ?>
            <?php else: ?>
                <strong><?php echo $this->__('%s Item(s)', $this->getTotalNum()) ?></strong>
            <?php endif; ?>
        </p>

            /****** This div was moved from below ******/
        <div class="sort-by">
            <label><?php echo $this->__('Sort By') ?></label>
            <select onchange="setLocation(this.value)">
            <?php foreach($this->getAvailableOrders() as $_key=>$_order): ?>
                <option value="<?php echo $this->getOrderUrl($_key, 'asc') ?>"<?php if($this->isOrderCurrent($_key)): ?> selected="selected"<?php endif; ?>>
                    <?php echo $this->__($_order) ?>
                </option>
            <?php endforeach; ?>
            </select>
            <?php if($this->getCurrentDirection() == 'desc'): ?>
                <a href="<?php echo $this->getOrderUrl(null, 'asc') ?>" title="<?php echo $this->__('Set Ascending Direction') ?>"><img src="<?php echo $this->getSkinUrl('images/i_desc_arrow.gif') ?>" alt="<?php echo $this->__('Set Ascending Direction') ?>" class="v-middle" /></a>
            <?php else: ?>
                <a href="<?php echo $this->getOrderUrl(null, 'desc') ?>" title="<?php echo $this->__('Set Descending Direction') ?>"><img src="<?php echo $this->getSkinUrl('images/i_asc_arrow.gif') ?>" alt="<?php echo $this->__('Set Descending Direction') ?>" class="v-middle" /></a>
            <?php endif; ?>
        </div>
        <div class="limiter">
            <label><?php echo $this->__('Show') ?></label>
            <select onchange="setLocation(this.value)">
            <?php foreach ($this->getAvailableLimit() as  $_key=>$_limit): ?>
                <option value="<?php echo $this->getLimitUrl($_key) ?>"<?php if($this->isLimitCurrent($_key)): ?> selected="selected"<?php endif ?>>
                    <?php echo $_limit ?>
                </option>
            <?php endforeach; ?>
            </select> <?php echo $this->__('per page') ?>
        </div>

        <?php echo $this->getPagerHtml() ?>

    </div>

    <?php if( $this->isExpanded() ): ?>
    <div class="sorter">
        <?php if( $this->isEnabledViewSwitcher() ): ?>
        <p class="view-mode">
            <?php $_modes = $this->getModes(); ?>
            <?php if($_modes && count($_modes)>1): ?>
            <label><?php echo $this->__('View as') ?>:</label>
            <?php foreach ($this->getModes() as $_code=>$_label): ?>
                <?php if($this->isModeActive($_code)): ?>
                    <strong title="<?php echo $_label ?>" class="<?php echo strtolower($_code); ?>"><?php echo $_label ?></strong>&nbsp;
                <?php else: ?>
                    <a href="<?php echo $this->getModeUrl($_code) ?>" title="<?php echo $_label ?>" class="<?php echo strtolower($_code); ?>"><?php echo $_label ?></a>&nbsp;
                <?php endif; ?>
            <?php endforeach; ?>
            <?php endif; ?>
        </p>
        <?php endif; ?>
    /****** Div moved from here ******/

    </div>
    <?php endif; ?>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:29:21.843

是的，正如你所说，可能会有 div 覆盖。因此，您的顶部工具栏位于透明 div 下，它会阻止鼠标单击触发器。链接到该页面将有助于更快地找到问题。

# iphone - 避免在 NSMutable 数组中重复数据

> ID：13588551
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:22:09.967
> 
> 标签：iphone, ios, xcode, nsarray

我有应用程序，其中推送`viewcontroller`（多次）后的数据收集在`NSMutableArray`

```
nextController.pathArray = self.pathArray; 
```

如何防止重复`pathArray`数据`nextController.pathArray`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:34:20.157

创建一个`NSMutableSet`并在那里添加您的对象。在将项目添加到可变数组之前，请先检查它是否存在于集合中。无论您在何处添加数据，都应类似于以下示例：

```
if (![set containsObject:data])
{
   [set addObject:data];
   [self.pathArray addObject:data
} 
```

如果您不关心集合的安排，我建议在更改视图控制器时使用 a`NSMutableSet`而不是`NSMutableArray`并将其转换回可变数组，如下所示：

```
 nextController.pathArray = self.set.allObjects.mutableCopy; 
```

# python - 比较从不同格式的 XML 文档中提取的地址

> ID：13588552
> 
> 赞同：0
> 
> 时间：2012-11-27T16:22:09.770
> 
> 标签：python, string-comparison

我试图弄清楚如何比较我从两个 XML 源中提取的两个地址字段。一个以这种格式返回地址：

```
123 Main St 
```

和另外一个：

```
123 MAIN ST 
```

我试着做这样的事情：

```
x = address1  <---first address format i states
y = address2   <---and the second

if x.upper() == y.upper():
   print "correct"
else:
   print "incorrect" 
```

这似乎不起作用，我假设这是因为我试图将地址的整个字符串设置为大写，但这不适用于数字。我的问题是我将如何比较以不同格式返回的两个地址，如果 x = y 比较无法比较地址，则会出现海峡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:41:22.223

您可以使用 .lower() 将两个地址转换为小写，然后进行比较。

小写或大写无关紧要，可能问题是您使用运算符“=”而不是“==”导致分配。

例如：

```
x = '123 Main St'
y = '123 MAIN ST'

new_x = x.lower()
new_y = y.lower()

if new_x == new_y :
   print "correct"
else:
   print "incorrect" 
```

# android - Android 使 ImageView 大小适应屏幕大小

> ID：13588553
> 
> 赞同：3
> 
> 时间：2012-11-27T16:22:11.433
> 
> 标签：android, android-layout, android-widget

我有一个想要实现的特定布局，但我不知道如何让它在多个屏幕尺寸上稳健地工作。

关键思想是TextViews中的信息很重要，而ImageView是装饰性的。我希望 ImageView 根据用户的屏幕尺寸调整大小（最大尺寸）。另外，我希望所有元素保持组合在一起，这样它们在大屏幕上就不会显得稀疏。我更愿意在 xml 中找到一个解决方案，但我愿意接受任何可以完成这项工作的东西。

这是我所追求的（我还不能在这里发布图片）：

在小屏幕上，图像视图缩小：

[https://dl.dropbox.com/u/29549935/small_screen.png](https://dl.dropbox.com/u/29549935/small_screen.png)

在大屏幕上，imageview 达到最大值（应该通过自动缩放来处理），并且内容一起保存在屏幕的中心：

[https://dl.dropbox.com/u/29549935/large_screen.png](https://dl.dropbox.com/u/29549935/large_screen.png)

我尝试了很多我认为应该可行的选项，例如，下面的代码将文本视图相对于图像视图定位，所有这些都组合在一个相对布局中。这在大屏幕上效果很好，但是在小屏幕上，文本视图被图像视图推开：

```
<RelativeLayout
    android:id="@+id/container1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentTop="true"
    android:orientation="vertical" >

    <RelativeLayout
        android:id="@+id/container2"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_centerInParent="true"
        android:orientation="vertical">

        <TextView
            android:id="@+id/textview1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_above="@+id/imageview1"
            android:gravity="center_horizontal"
            android:text="@string/textview1" />

        <ImageView
            android:id="@+id/imageview1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_centerInParent="true"
            android:gravity="center_horizontal"
            android:adjustViewBounds="true"
            android:maxHeight="256dp"
            android:maxWidth="256dp"
            android:minHeight="100dp"
            android:minWidth="100dp"
            android:scaleType="centerInside"
            android:src="@drawable/mydrawable" />

        <TextView
            android:id="@+id/textview2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/imageview1"

            android:gravity="center_horizontal"
            android:text="@string/textview2" />

        <TextView
            android:id="@+id/textview3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/textview2"
            android:gravity="center_horizontal"
            android:text="@string/textview3"/>
    </RelativeLayout>
</RelativeLayout> 
```

如果规定imageview可以占据relativelayout的一部分，这种方式似乎可行。

非常欢迎任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:28:04.860

为此，您必须为单独的屏幕分辨率创建图像并将其放在 drawable-ldpi、drawable-mdpi、drawable-hdpi、drawable-xhdpi 文件夹中......`，例如

```
drawable-ldpi  - Low dpi  (Low size screen Resolution)

drawable-mdpi  - Medium dpi (Medium size screen Resolution)

drawable-hdpi  - High dpi,  (large size screen Resolution)

drawable-xhdpi - Extended High dpi (For tablest and wide screen) 
```

而且你应该注意图像的密度

[多屏支持](http://developer.android.com/guide/practices/screens_support.html)

[示例应用程序和关于密度等...](http://developer.android.com/training/multiscreen/index.html)

[多屏支持设计](http://developer.android.com/training/multiscreen/screensizes.html)

# c - 将按钮的寄存器标记为已读

> ID：13588554
> 
> 赞同：-4
> 
> 时间：2012-11-27T16:22:12.020
> 
> 标签：c, input, io, gameboy

我正在使用 C 编写 Game Boy 游戏。我正在实现一个光标，该光标可以根据按下的按钮上下移动。如果按下 UP 键，则寄存器中的相应位被设置。然后我让光标向上移动。游戏处于无限循环中。因此，在下一次迭代中，仍将寄存器视为已设置。我需要一些簿记来告诉自己将来光标已经向上移动，我应该忽略该位已设置的事实。我该怎么做呢？

编辑：这是我写的代码。基本上，当我按下向上按钮时，光标会上升很多步。我希望它只上升一步。

```
 if (KEY_DOWN_NOW(BUTTON_UP)){
        if (row - 1 >= 0){
            undrawCursor(row, column);
            row--;
            drawCursor(row, column);

         }
    }
    else if (KEY_DOWN_NOW(BUTTON_DOWN)){
        if (row + 1 <= 160){
            undrawCursor(row, column);
            row++;
            drawCursor(row, column);

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:54:35.853

您正在阅读的寄存器可能只是告诉您按钮的状态，并且在您阅读时不会清除。如果它像那样工作，你将无法实现像“自动触发”这样的功能，因为你不知道按钮是否仍然被按下，或者它是否已经被释放。

您需要为每个按钮保留一个变量来跟踪它的状态，并且只对状态的更改采取行动。例如，以下是您为单个按钮执行此操作的方式：

```
up_pressed = FALSE;

for (;;)
{
    if (up_pressed)
    {
        if (!KEY_DOWN_NOW(BUTTON_UP))     // up button has been released
        {
            up_pressed = FALSE;
        }
    }
    else
    {
        if (KEY_DOWN_NOW(BUTTON_UP))      // up button has been pressed
        {
            up_pressed = TRUE;
            if (row > 0)
            {
                undrawCursor(row, column);
                row--;
                drawCursor(row, column);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:16:03.393

在旧式控制台中，逻辑通常与垂直同步同步（一种方法是在游戏循环中插入对 waitForVsync() 的调用）。因此，例如：您将在每个 vsync (~60 Hz) 运行一次循环体，这意味着您将每帧移动 1 步，或每秒移动 60 步。适当调整运动。

# javascript - 在较新版本的 Ember.js 中绑定不触发观察者

> ID：13588560
> 
> 赞同：0
> 
> 时间：2012-11-27T16:22:22.220
> 
> 标签：javascript, ember.js

我最近从 Ember.js 0.9.8.1 更新到 Ember.js 1.0-pre2。现在我发现当我设置绑定时观察者不会被触发。

这是一个说明问题的小例子：

模板：

```
<script type="text/x-handlebars">
    {{view App.SimpleView textBinding="App.text"}}
</script>​ 
```

代码：

```
App = Ember.Application.create();
App.text = "new";

App.SimpleView = Ember.View.extend({
    text: 'old',
    fired: 'no',
    template: Ember.Handlebars.compile('Text: {{view.text}}. Observer fired: {{view.fired}}'),

    textObserver: function() {
        this.set('fired', 'yes');
    }.observes('text')
}); 
```

使用 Ember.js 0.9.8.1 它可以按预期工作，打印*Text: new。观察者被解雇：是*的，（[小提琴](http://jsfiddle.net/XBDnu/)）但是在 1.0-pre2 中，观察者没有被解雇（[小提琴](http://jsfiddle.net/mSyug/)）。

这对我来说就像一个小错误，但在报告它之前，我想问一下 API 中的某些内容是否发生了变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:50:07.093

好吧，在与 Kristofor Selden 讨论之后，0.9.8.1 中的行为是一个错误。在 1.0.pre-2 中，在您的小提琴中，当视图被实例化时， App.text 已经设置为“new”，这是观察者不会被触发的预期行为。

# android - 如何在android中实现这种布局？

> ID：13588561
> 
> 赞同：0
> 
> 时间：2012-11-27T16:22:23.050
> 
> 标签：android, android-layout

我正在在 Android 平板电脑上构建交互式演示文稿。我已经阅读了基本教程，以尝试了解可用的工具。我现在正处于想要创建一个虚拟应用程序的阶段，但我不确定最好的方法。我附上了下面的图片，让您了解我想要做什么：

![在此处输入图像描述](../Images/0d566d460d411118e91fa57391409020.png)

我要做的是在右侧有一个静态导航。当您在那里选择选项时，它们将通过旋转面板并将新内容放在另一侧来切换左侧的内容。中间窗格将是一组可以滑动的图像。

到目前为止，我一直在玩 ViewPager 类，这似乎是让我在图像之间快速滑动的理想选择。我想做的唯一增强是允许用户在这些图像上捏缩放，但*只有*图像被缩放，而不是整个屏幕。这可能吗？

其次，来自网络背景，我试图弄清楚 div 的等价物对于 android 是什么？理想情况下，我希望左侧有一个面板，其中包含多个文本视图/图像视图，具体取决于内容，但我不确定如何使用 android API 来实现这一点。是创建一个大片段并在其中包含多个嵌套视图的情况吗？

我也想知道如何在这个面板上实现旋转效果。我已经设法在一个虚拟应用程序中使用：

```
tv.animate().rotationYBy(180).setDuration(2000); 
```

但是我不知道该怎么做是在选择新项目时更改内容。我在想也许我会动态删除当前片段，添加新片段并在菜单项选择上快速旋转它。这是一个明智的做法吗？

如果这些是愚蠢的问题，我深表歉意，我只是很难理解如何在 android 中实现这些东西。有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:05:42.030

您绝对应该阅读[Fragments](http://developer.android.com/guide/components/fragments.html)。

至于缩放，您可以创建自定义 ImageView。（[像这样](https://stackoverflow.com/questions/10630373/android-image-view-pinch-zooming)）

android 中 div 的等价物是布局容器，例如[LinearLayout](http://developer.android.com/reference/android/widget/LinearLayout.html)、[RelativeLayout](http://developer.android.com/reference/android/widget/RelativeLayout.html)、[FrameLayout](http://developer.android.com/reference/android/widget/FrameLayout.html)等...阅读[此](http://developer.android.com/guide/topics/ui/declaring-layout.html)内容以获取有关布局的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T08:07:52.100

我在**ActionBarSherlock**库示例 ( **Styled** ) 中看到了 1 个示例，其中在按下 Tab 时 1 个片段旋转了 180 度。就像你想要的一样。请参阅下面的链接。

查看 Android Fragments 和以下两个库，您可以从这些库中获取所需的所有内容，请参阅示例代码。

1.  [动作条夏洛克](https://github.com/JakeWharton/ActionBarSherlock/tree/master/samples/styled)
2.  [Android-ViewPagerIndicator](https://github.com/JakeWharton/Android-ViewPagerIndicator)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:59:38.493

我可以让你的生活更轻松一点，并说没有一种默认布局可以简单地用于实现这样的事情。这种布局的实现将因开发人员而异，我认为您不会收到完整的答案，因为它很复杂并且也需要编写实际代码。从我这里，我可以尽力帮助你，我相信其他人也会。

# spring - Spring Data JPA - 为什么对返回的实体的更改会自动持久化？

> ID：13588565
> 
> 赞同：38
> 
> 时间：2012-11-27T16:22:42.733
> 
> 标签：spring, jpa, spring-data-jpa

我用一个例子来提出这个问题。

断言我们有一个存储库，如下所示：

```
public interface ExampleObjectRepository extends CrudRepository<ExampleObject, Long> {

} 
```

通过扩展`JpaRepository`接口，`ExampleObject`存储库继承了以下方法：

```
T findOne(ID id); 
```

现在，我观察到，如果在调用此方法后收到对 ExampleObject 的引用，我对该方法所做的任何操作都会自动保存到数据库中，例如：

```
ExampleObject pointInCase = exampleObjectRepository.findOne(1L);
pointInCase.setName("Something else"); 
```

阅读这个主题，我明白这意味着`ExampleObject`实例是`not detached`.

这与我的预期背道而驰。我本来希望我需要使用从继承的保存方法`CrudRepository`来保存更改：

```
T save(T entity); 
```

是否有人愿意确认从 Spring Data JPA 存储库返回的对象仍然作为标准附加，并解释如何使用 API 标记存储库中的方法，使其仅返回分离的引用？

我想更改实体的状态也可能会在与所述方法一起使用时更改其定义`save(T entity)`，因此我也希望了解如何处理更新的身份。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-27T17:08:01.480

这是 JPA 的基本原则。您使用附加（托管）实体，并且对这些托管实体所做的每次修改都会自动持久化。

如果您不希望您的更改是持久的，那么不要进行更改或回滚事务。

处理分离的实体将是一场噩梦，因为它会阻止延迟加载所有关联。你可以随时调用`EntityManager.detach()`你的实体，但我真的不会那样做。试着了解它是如何工作的并处理它。好处多于坏处。其中之一是您甚至不必考虑保存复杂业务逻辑可能执行的所有更改，因为这一切都是由 JPA 透明地为您完成的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-05-22T07:45:40.017

如果您的 Transaction 的范围限定为存储库，则可以使您的存储库返回分离的实体。即，您的事务从进入存储库开始，并在您的代码退出存储库时关闭。

如果你像这样工作，你必须注意一次性加载所有必要的数据，否则你会得到延迟初始化异常。但是在许多情况下，我认为这是可取的，因为它可以让您控制何时以及加载哪些数据，否则在使用 JPA 时很容易从您的手指中溜走。

对于修改，我使用不同的 Transaction 范围，它包含了加载、更改（和隐式持久化）的完整过程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-12T06:01:22.963

我也面临同样的问题。
但对我来说，问题出在自定义存储库实现上，然后我添加了@Transactional(readOnly = true)。

# c# - 实体框架可以在没有交集对象的情况下处理多对多关系吗？

> ID：13588574
> 
> 赞同：10
> 
> 时间：2012-11-27T16:23:12.403
> 
> 标签：c#, entity-framework, entity-framework-5, ef-database-first

使用数据库优先模型：假设我们有经典的表`Student`, `Course`and `StudentCourse`（后者显然对`Student`and有 FK `Course`）。

如果将此模型导入 EF，您将获得为每个模型生成的对象。`Student`和类将`Course`每个都有一个集合`StudentCourses`，您需要从中跳转另一个关系才能分别到达`Course`or `Student`。

我希望以这样一种方式生成代码，即底层交集表是不可见的，即`Student`有一个集合`Courses`，并且`Course`有一个集合`Students`。我已经在其他 ORM 软件（特别是[TopLink](http://www.oracle.com/technetwork/middleware/toplink/overview/index.html)）中看到了这一点。可以在EF中完成吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-28T12:20:29.323

根据[本教程](http://learnentityframework.com/tutorials/many-to-many-relationships-in-the-entity-data-model/)，如果您的`StudentCourse`表仅包含外键列，您将获得所需的行为。如果它包含任何其他列，EF 将生成一个中间实体来表示连接。

在这种情况下，从表中删除代理键`StudentCourse`并用复合主键替换它应该可以工作。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-27T16:30:47.343

您可以使用 ICollections 在 EF Code First 中执行此操作。例如：

```
public class Student 
{ 
    public int ID { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Course> Courses { get; set; }

    public Student()
    {
        Courses = New HashSet<Course>();
    }
} 
```

重复课程并将其全部交换。这将在您的数据库中创建三个具有 m-to-m 关系的表（Student、Course 和 StudentCourse）。最重要的是 StudentCourse 将是一个不可见的链接表，在您的模型中没有实体。

# sql-server - SCOPE IDENTITY 不允许在远程服务器上？

> ID：13588581
> 
> 赞同：0
> 
> 时间：2012-11-27T16:23:34.473
> 
> 标签：sql-server, cursor, scope-identity

我正在尝试从一台服务器上由外键链接的 2 个表中复制数据，然后将它们插入另一台服务器上的主数据库中。

第一个表将生成一个新`IDENTITY`列，然后我想将其存储在一个变量中并将其插入到第二个表中。

我已经尝试过使用内部插入的表，但也`SCOPE_IDENTITY()`收到了远程服务器上不允许的错误

```
 DECLARE 

    @VisitSourceId  int,
    @SiteDomainId   int,
    @trpUTMid   bigint,
    @FlightPlus bit,
    @StartDate  datetime,
    @CountryId  int,
    @ProvinceId int,
    @Locationid int,
    @PlaceId    int,
    @EstabId    int,
    @CheckInDate    smalldatetime,
    @CheckOutDate   smalldatetime,
    @Rooms  int,
    @Room1Adults    int,
    @Room1Children  int,
    @Room2Adults    int,
    @Room2Children  int,
    @Room3Adults    int,
    @Room3Children  int,
    @OutcomeDate    datetime,
    @OutcomeId  smallint,
    @HotelsFound    smallint,
    @Notes  nvarchar,
    @id bigint

    DECLARE c CURSOR STATIC FOR 

    SELECT t.VisitSourceId, t.SiteDomainId, t.trpUTMid, t.FlightPlus, t.StartDate, t.CountryId, t.ProvinceId, t.Locationid, 
    t.PlaceId, t.EstabId, t.CheckInDate, t.CheckOutDate, t.Rooms, t.Room1Adults, t.Room1Children, t.Room2Adults, t.Room2Children, t.Room3Adults, 
    t.Room3Children, tc.OutcomeDate, tc.OutcomeId, tc.HotelsFound, tc.Notes

    FROM [MLT_VisitTracking].[dbo].TrackingAcomSearches_tbl t
    INNER JOIN TrackingAcomSearchesOutcome_tbl tc
    ON t.trpUTMid = tc.trpUTMid

    open c
    FETCH FIRST FROM c INTO @VisitSourceId, @SiteDomainId, @trpUTMid, @FlightPlus, @StartDate, @CountryId, @ProvinceId, @Locationid, 
    @PlaceId, @EstabId, @CheckInDate, @CheckOutDate, @Rooms, @Room1Adults, @Room1Children, @Room2Adults, @Room2Children, @Room3Adults, 
    @Room3Children, @OutcomeDate, @OutcomeId, @HotelsFound, @Notes  

    while @@fetch_status=0
    begin

    DECLARE @TmpTable TABLE (ID BIGINT)

    INSERT INTO [YAZOO].[MLT_VisitTracking].[dbo].TrackingAcomSearches_tbl
    (VisitSourceId, SiteDomainId, trpUTMid, FlightPlus, StartDate, CountryId, ProvinceId, Locationid, 
    PlaceId, EstabId, CheckInDate, CheckOutDate, Rooms, Room1Adults, Room1Children, Room2Adults, Room2Children, Room3Adults, 
    Room3Children)

    OUTPUT inserted.searchid into @TmpTable

    SELECT @VisitSourceId, @SiteDomainId, @trpUTMid, @FlightPlus, @StartDate, @CountryId, @ProvinceId, @Locationid, 
    @PlaceId, @EstabId, @CheckInDate, @CheckOutDate, @Rooms, @Room1Adults, @Room1Children, @Room2Adults, @Room2Children, @Room3Adults, 
    @Room3Children

    select top 1 @id = searchid from @tmptable

    INSERT INTO [YAZOO].[MLT_VisitTracking].[dbo].TrackingAcomSearchesOutcome_tbl
    (SearchId,
    trpUTMid,
    OutcomeDate,
    OutcomeId,
    HotelsFound,
    Notes)

    SELECT @id,
    @trpUTMid,
    @OutcomeDate,
    @OutcomeId,
    @HotelsFound,
    @Notes

    DELETE FROM [MLT_VisitTracking].[dbo].TrackingAcomSearches_tbl WHERE trpUTMid=@trpUTMid
    DELETE FROM [MLT_VisitTracking].[dbo].TrackingAcomSearchesOutcome_tbl WHERE trpUTMid=@trpUTMid

    FETCH NEXT FROM c INTO @VisitSourceId, @SiteDomainId, @trpUTMid, @FlightPlus, @StartDate, @CountryId,
    @ProvinceId, @Locationid, @PlaceId, @EstabId, @CheckInDate, @CheckOutDate, @Rooms, @Room1Adults, @Room1Children,
    @Room2Adults, @Room2Children, @Room3Adults, @Room3Children, @OutcomeDate, @OutcomeId, @HotelsFound, @Notes  
    end

    close c
    deallocate c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T17:08:49.737

`@@IDENTITY`并且`SCOPE_IDENTITY()`是本地的

你在使用链接服务器吗？检查这个： [从另一台服务器（链接服务器）获取@@Identity](https://stackoverflow.com/questions/4537560/get-identity-from-another-serverlinked-server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T22:46:18.103

为了解决这个问题，我最终在目标服务器上创建了脚本作为存储过程，然后我可以使用范围标识。性能也大大提高，然后我配置了一个启用 RPC 输出的新链接服务器并远程调用该过程。这不是一个优雅的解决方案，但它只是暂时的

# shell - 在 shell 脚本中移动 ftp 中的远程文件

> ID：13588588
> 
> 赞同：0
> 
> 时间：2012-11-27T16:23:51.930
> 
> 标签：shell

我想将文件 ftp 到我的远程服务器，然后将这些文件移动到远程服务器中的另一个目录 ftp 正确发生，但移动引发错误，如 550 RNFR 命令失败。

你能帮忙吗？

我的脚本是

```
#!/bin/sh
echo "Enter the version of the xml (eg:- v17.25)"
read version
HOST_FIRST='un01'
HOST_LAST='01'
USER='someuser'
PASSWD='somepassword'
HOST="$HOST_FIRST$FILE$HOST_LAST"
ftp -n $HOST <<-END_SCRIPT
quote USER $USER
quote PASS $PASSWD
cd /tmp
put myfile.xml
rename myfile.xml /tmp/test_ftp
quit
END_SCRIPT
exit 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:42:56.970

你必须`put myfile.xml`到 tmp 目录，为什么不只是

**编辑**

更改您的脚本

```
rename myfile.xml /tmp/test_ftp 
```

至

```
rename myfile.xml test_ftp 
```

您已经`put`在`/tmp`目录中拥有该文件，您已经完成了`cd /tmp`.

那应该行得通。

**您不能在 ftp 重命名命令中指定路径并期望它也被移动。**

抱歉，这里不是你想要的，但**ftp 中没有移动命令。这是为了安全的方式。**

IHTH。

# wpf - 如何判断所选数据单元是标题还是数据网格的一部分

> ID：13588601
> 
> 赞同：0
> 
> 时间：2012-11-27T16:24:28.893
> 
> 标签：wpf, datagrid, xceed-datagrid

我的 WPF 应用程序中有一个 Xceed 数据网格，每个单元格都有一个`OnClick`事件。但是，我希望能够根据单元格是列标题还是单元格只是存储数据来处理该事件。如果有人对此有任何建议或经验，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T07:50:50.793

```
<Window.Resources>
<Style TargetType="xcdg:DataCell">
    <EventSetter Event="PreviewMouseLeftButtonDown" Handler="dataCellMouseLeftButtonDown"/>
</Style>
<Style TargetType="xcdg:ColumnManagerCell">
    <EventSetter Event="PreviewMouseLeftButtonDown" Handler="colManagerMouseLeftButtonDown"/>
</Style>
</Window.Resources>

<xcdg:DataGridControl ItemsSource="{Binding}"/>

 private void dataCellMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
 {
    MessageBox.Show("Left mouse button down on Cell");
 }

 private void colManagerMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
 {
   MessageBox.Show("Left mouse button down on Column manager cell");
 } 
```

**注意**如果将预览事件替换为普通事件，则数据网格不会触发事件。它将自己处理这些鼠标事件（分别开始内联编辑和排序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:54:51.163

你如何设置事件？您可以针对具有不同样式和事件的 datagridrow、datacell、columnheader 单元格。但是，您必须注意 Xceed 控件处理多个事件的事实，有时您必须使用事件的预览版本。

# ruby-on-rails - Rails 3 未初始化常量 ActiveRecord::RecordInvalid

> ID：13588611
> 
> 赞同：2
> 
> 时间：2012-11-27T16:24:59.860
> 
> 标签：ruby-on-rails

application_controller.rb

```
class ApplicationController < ActionController::Base
  protect_from_forgery  

  rescue_from ActiveRecord::RecordInvalid,  :with => :error_render_method
  rescue_from ActiveRecord::RecordNotFound, :with => :record_not_found

  def error_render_method
  end

  def record_not_found
  end

end 
```

当我运行时，`rspec`我收到此错误：

```
uninitialized constant ActiveRecord::RecordInvalid (NameError) 
```

我用谷歌搜索，发现有些人添加`require 'active_record/errors'`到该文件中，但是当我这样做时，错误仍然存​​在。

我在用`rails (3.2.9)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-15T13:23:05.797

当我开始独角兽时，我遇到了同样的问题。

我通过引用常量来解决它`"ActiveRecord::RecordInvalid"`。（不是赤裸裸的常数`ActiveRecord::RecordInvalid`。）

我不知道原因，但启动独角兽时似乎`ActiveRecord::RecordInvalid`没有加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-10T03:15:05.887

这似乎已在 Rails 4.0 和 4.1 之间得到修复。

# node.js - JadeJS 中的 if 语句

> ID：13588619
> 
> 赞同：0
> 
> 时间：2012-11-27T16:25:23.277
> 
> 标签：node.js, if-statement, mongoose, pug, equality

我在使用 Jade JS 时遇到了一点问题，我无法完成我的应用程序。我有一个包含问题、答案和评论的 Mongo DB。我想在每个答案下显示评论，所以我使用 FOR 循环将答案 ID 与每个评论的“answer_id”进行比较。

所以它会是这样的：

```
for answer in answers
    br
    a #{answer.user}
    span #{answer.date.toLocaleDateString()} (#{answer.date.getHours()}:#{answer.date.getMinutes()})
    br
    pre #{answer.text}
    textarea(id='#{answer._id}',class='comm',placeholder='Comment this answer')
    span
        a.btn(href='javascript:post("#{answer._id}")') Send
    br
    br
        p asdadsdadas
    for comment in comments
        if comment
            if ('#{comment.answer_id}' == '#{answer._id}')
                p '#{answer._id}'
                p '#{comment.answer_id}'
    hr 
```

问题是，对于 Jade，这是不相等的，但如果我将其更改为 != 以检查 '#{answer._id}' 和 '#{comment.answer_id}' 它显示我完全一样......所以我不知道发生了什么事。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T18:05:30.990

你应该使用

```
- if (comment.answer_id == answer._id) 
```

代替

```
if ('#{comment.answer_id}' == '#{answer._id}') 
```

# java - 通过泛型父类访问的子类中的 Java 静态成员

> ID：13588620
> 
> 赞同：9
> 
> 时间：2012-11-27T16:25:26.647
> 
> 标签：java, generics, static, abstract

这似乎是一个新问题，但我上次使用 Java 时，该语言没有泛型。我有一个类层次结构（名称更改为尽可能通用）：

```
public abstract class AbstractBase { .... }
public class ConcreateSubA extends AbstractBase { .... }
public class ConcreateSubB extends AbstractBase { .... }
...
public class ConcreateSubZZ9PluralZAlpha extends AbstractBase { .... }
... 
```

我正在尝试清理一些遗留代码，并且有一个地方可以通过泛型将大量重复重复全部分解为单个例程。（我在考虑泛型，因为当调用这个例程时，它只需要对一个具体类进行操作。）

例程看起来像

```
public <Thing extends AbstractBase> void someFunc()
{
    another_function_call (Thing.concreteSpecialToken);
    // could also be
    //   another_function_call (Thing.concreteSpecialToken());
    // if methods are more feasible than fields

    // Cannot use
    //   another_function_call (Thing().concreteSpecialToken());
    // because creating instances of these types is a Major Operation[tm]
} 
```

我省略了无数行，但这是重要的部分： `someFunc()`是类型参数（它实际上需要参数，但它们都不是事物，所以没有推理）。最终我需要获取一个特殊的令牌，这就是我变得模糊的地方。

标记是每个具体类的巨大的唯一字符串。它们是基于类的，而不是基于实例的。实际的标记值`private static final`在每个子类中声明为一个字段。

所以我需要使用基类的公共方法/字段来（最终）获取子类的私有静态字段。显然我不能`abstract static`在基中声明一个方法，因为那没有意义。如果数据是基于实例的，那么这将是微不足道的，在基类中有一个多态的 getter，但子类的东西是静态的。

我觉得我在这里缺少 Java 泛型的一个特性，但我不能使用`Thing.whatever()`，除非它`whatever`是可以在抽象基类中声明的东西。我遇到了 Java 的限制或我缺乏试图弥合差距的专业知识。我所做的一个看起来很有希望的尝试也有大量的代码重复，一直到类层次结构，一遍又一遍地用完全相同的代码定义抽象方法......这就是泛型应该帮助防止的！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T16:33:23.667

> 我遇到了 Java 的限制或我缺乏试图弥合差距的专业知识。

这是 Java 的一个限制，尽管 IMO 是一个相当合理的限制。基本上，您仍然在尝试使用静态成员，就好像它们是多态的一样，这是行不通的——泛型在这方面对您没有帮助。

选项：

*   使用反射......但请记住，类型擦除意味着您无法获取`Class`for`Thing`除非您明确传递它
*   如果你*有*一个`Thing`无论如何的实例，只需将其设为抽象*实例*成员，在每个实现中碰巧返回一个静态字段的值
*   创建一个单独的类型层次结构，它将使用实例成员

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:32:30.200

如果我理解正确，您需要类型参数的具体类。通常的做法是像这样声明你的方法：`public <T extends AbstractBase> void someFunc(Class<T> clazz)`

这当然意味着需要向方法传递一个额外的参数，并且您需要使用反射来访问静态字段，但鉴于 Java 的类型擦除，这是唯一的方法。

这个故事的寓意是泛型和静态不能很好地结合在一起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:32:49.420

有点笨拙，但如果`someFunc`采用`Class<Thing>`参数，您可以使用反射：

```
public <Thing extends AbstractBase> void someFunc(Class<Thing> clz) {
  // exception handling omitted
  Object whatever = clz.getDeclaredMethod("whatever").invoke(null); 
```

但是您可以通过使用嵌套类来更好地利用多态性，例如

```
public abstract class AbstractBase {
  public static class Info {
    public String getInfo() {
      return "AbstractBase";
    }
  }
}

public class ConcreteSubA extends AbstractBase {
  public static final Info INFO = new Info() {
    public String getInfo() { return "ConcreteSubA"; }
  }
} 
```

并有`someFunc`一个`AbstractBase.Info`参数。

```
public <Thing extends AbstractBase> someFunc(AbstractBase.Info inf) {
  String info = inf.getInfo();
}

// call it as
ConcreteSubB csb = someFunc(ConcreteSubB.INFO); 
```

这个想法是层次结构中的每个*类*都有一个保存其以前静态数据的单例*实例。*`Info`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T19:58:32.037

如果你想保持令牌原样，一个`private static final`字段，你可以通过反射得到它：

```
public <Thing extends AbstractBase> void someFunc(Class<Thing> clz)
{
    try {
        Field field = clz.getField("concreteSpecialToken");
        field.setAccessible(true);
        Object concreteSpecialToken = field.get(null);
        another_function_call (concreteSpecialToken);
    } catch (IllegalAccessException e) {
        handle(e);
    } catch (NoSuchFieldException e) {
        handle(e);
    }
} 
```

在呼叫站点，您必须执行`someFunc(ConcreateSubZZ9PluralZAlpha.class)`. 但是我想知道您是否可以这样做，为什么不将令牌对象作为参数传递，例如 `someFunc(ConcreateSubZZ9PluralZAlpha.concreteSpecialToken)`？或者甚至可以将方法移动`someFunc()`到令牌类本身。

# regex - 使用 VBScript 查找和替换 JSON 文件中节点的花括号之间的所有多行文本

> ID：13588622
> 
> 赞同：2
> 
> 时间：2012-11-27T16:25:28.473
> 
> 标签：regex, vbscript, replace

作为 Windows 登录脚本的一部分（因此需要 VBScript），我想在用户的 Google Chrome 首选项（存储在用户配置文件中的 JSON 文件中）中设置值，以便在他们登录时应用下载设置。

我正在努力实现以下目标：

1.  打开一个 JSON 文件 ( `%userprofile%\Local Settings\Application Data\Google\Chrome\User Data\Default\Preferences`) 并将内容读入一个字符串；
2.  搜索名为“download”的特定节点，该节点预先填充了多行值，这些值可能在构建之间有所不同；
3.  用指定的多行文本替换大括号之间的整个文本；和
4.  将更新后的字符串写入原始文件并保存。

完整的 JSON 文件相当大，但作为输入的示例，它是从典型的 Google Chrome 首选项 JSON 文件中复制而来的：

```
"bookmark_bar": {
    "show_on_all_tabs": false
},
"download": {
    "directory_upgrade": true,
    "prompt_for_download": false
},
"sync": {
    "suppress_start": true
}, 
```

我想以编程方式搜索“下载”节点，并替换该节点大括号之间的所有内容，使其显示为：

```
"download": {
    "default_directory": "C:\\Windows\\Temp",
    "extensions_to_open": "pdf",
    "prompt_for_download": false
}, 
```

...文件的其余内容保持不变。

鉴于要替换的 JSON 部分中的空格和多行，以及在大括号之间包含所有/任何文本的通配符要求，我无法使用 VBScript Replace 函数执行此操作，但我的 RegEx 知识有限.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T17:31:04.123

您可以使用正则表达式进行替换：

```
prefsFile = "%userprofile%\Local Settings\...\Preferences"
prefsFile = CreateObject("WScript.Shell").ExpandEnvironmentStrings(prefsFile)

newPrefs = "..."

Set fso = CreateObject("Scripting.FileSystemObject")

json = fso.OpenTextFile(prefsFile).ReadAll

Set re = New RegExp
re.Pattern = """download"": {[\s\S]*?},"

json = re.Replace(json, """download"": {" & vbCrLf & newPrefs & vbCrLf & "},")

fso.OpenTextFile(prefsFile, 2).Write(json) 
```

该模式`[\s\S]`匹配任何空白或非空白字符。在这种情况下您不能使用`.`，因为该特殊字符与换行符不匹配，并且您希望表达式跨越多行。限定符`*`和`?`分别表示“匹配任意数量的字符”和“使用最短匹配”。`"download":`这样，表达式匹配关键字后面一对花括号之间的所有内容。

# android - 无法将 gps 位置写入 exif

> ID：13588625
> 
> 赞同：3
> 
> 时间：2012-11-27T16:25:35.773
> 
> 标签：android, gps, latitude-longitude, exif

我有一个应用程序使用 LocationManager 获取用户的位置并尝试将该数据写入图像的 Exif 数据。由于某种原因，该值永远不会被写入，并且该位置仍然为空。这是我写入 Exif 并转换纬度和经度的函数：

```
 public void geoTag(String filename){
    ExifInterface exif;

    try {
        exif = new ExifInterface(filename);
        int num1Lat = (int)Math.floor(latitude);
        int num2Lat = (int)Math.floor((latitude - num1Lat) * 60);
        double num3Lat = (latitude - ((double)num1Lat+((double)num2Lat/60))) * 3600000;

        int num1Lon = (int)Math.floor(longitude);
        int num2Lon = (int)Math.floor((longitude - num1Lon) * 60);
        double num3Lon = (longitude - ((double)num1Lon+((double)num2Lon/60))) * 3600000;

        exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE, /*num1Lat+"/1,"+num2Lat+"/1,"+num3Lat+"/1000"*/);
        exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE, num1Lon+"/1,"+num2Lon+"/1,"+num3Lon+"/1000");

        if (latitude > 0) {
            exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE_REF, "N"); 
        } else {
            exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE_REF, "S");
        }

        if (longitude > 0) {
            exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE_REF, "E");    
        } else {
        exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE_REF, "W");
        }

        exif.saveAttributes();
    } catch (IOException e) {
        Log.e("PictureActivity", e.getLocalizedMessage());
    } 

    } 
```

在我目前的位置，纬度和经度值大约是 40.42 和 -81.92

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-05T19:46:05.307

你可以试试这个：

```
int num1Lat = (int)Math.floor(latitude);
int num2Lat = (int)Math.floor((latitude - num1Lat) * 60);
int num3Lat = (int)Math.floor((latitude - num1Lat - ((double)num2Lat)/60) * 3600);

int num1Lon = (int)Math.floor(longitude);
int num2Lon = (int)Math.floor((longitude - num1Lon) * 60);
int num3Lon = (int)Math.floor((longitude - num1Lon - ((double)num2Lon)/60) * 3600);

exif.setAttribute(ExifInterface.TAG_GPS_LATITUDE, num1Lat+"/1,"+num2Lat+"/1,"+num3Lat+"/1");
exif.setAttribute(ExifInterface.TAG_GPS_LONGITUDE, num1Lon+"/1,"+num2Lon+"/1,"+num3Lon+"/1"); 
```

这段代码对我有用。例如，我的一个 EXIF 标签（纬度）显示“37/1,53/1,42/1”，对应于 37.895 度

# django - 是否可以仅在 django admin 中显示自定义权限？

> ID：13588626
> 
> 赞同：1
> 
> 时间：2012-11-27T16:25:38.207
> 
> 标签：django

我想在 Django 管理界面中只显示自定义权限（我在模型中使用 Meta 类创建）。这可能吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:29:23.533

我会考虑创建自己的自定义视图来添加自定义权限，而不是尝试修改 Django 管理员。但是，如果您确定要使用 Django 管理员，可以尝试以下方法：

从子类开始`UserChangeForm`，并覆盖该`__init__`方法。`self.fields['user_permissions'].queryset`使用包含您的自定义权限的查询集进行设置。

```
from django.contrib.auth.forms import UserChangeForm

class MyUserChangeForm(UserChangeForm):
    def __init__(self, *args, **kwargs):
        super(MyUserChangeForm, self).__init__(*args, **kwargs)
        custom_permissions = ????
        self.fields['user_permissions'].queryset = custom_permissions 
```

接下来，子类`django.contrib.auth.admin.UserAdmin`化，并使用您的表单而不是`UserChangeForm`.

```
from django.contrib.auth.admin import UserAdmin

class MyUserAdmin(UserAdmin):
    form = MyUserChangeForm 
```

最后，取消注册 default `UserAdmin`，并注册你自己的。

```
admin.site.unregister(User)
admin.site.register(User, MyUserAdmin) 
```

# c# - Quartz.NET 设置 MisfireInstruction

> ID：13588627
> 
> 赞同：9
> 
> 时间：2012-11-27T16:25:45.570
> 
> 标签：c#, sql, scheduler, quartz.net, quartz.net-2.0

我正在使用 Quartz.NET 在 C# 中工作，并且在 CronTrigger 上设置失火指令时遇到问题。我正在运行安装了 Quartz DB 的 SQL 后端。我有以下代码可以很好地创建作业和运行调度程序。

```
IScheduler _scheduler;
IJobDetail job;
ISchedulerFactory sFactory;
ICronTrigger trig;

sFactory = new StdSchedulerFactory();

_scheduler = sFactory.GetScheduler();
_scheduler.Start();

job = JobBuilder.Create<Test>().WithIdentity("testJob", "testGroup").Build();
trig = (ICronTrigger) TriggerBuilder.Create().WithIdentity("testTrigger", "testGroup").WithCronSchedule("0/10 * * * * ?").Build(); int i = trig.MisfireInstruction;

_scheduler.ScheduleJob(job, trig); 
```

我可以访问的唯一错误指令是`trig.MisfireInstruction`哪个是 int，我无法设置它。还有一些从`WithMisfireHandlingInstruction`CronScheduleBuilder 开始的函数。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-28T09:35:13.910

您的触发器创建应该是这样的：

```
trig = (ICronTrigger)TriggerBuilder
       .Create()
       .WithIdentity("testTrigger", "testGroup")
       .WithCronSchedule("0/10 * * * * ?", x => x.WithMisfireHandlingInstructionFireAndProceed())
       .Build(); 
```

您可以使用以下选项：

*   With MisfireHandlingInstructionDoNothing
*   With MisfireHandlingInstructionFireAndProceed
*   With MisfireHandlingInstructionIgnoreMisfires

[你可以在这里](https://dzone.com/articles/quartz-scheduler-misfire)找到一个很好的解释。

# iphone - 如何为 GameCenter 设置自定义规则（例如难度级别）以找到匹配项

> ID：13588628
> 
> 赞同：2
> 
> 时间：2012-11-27T16:25:43.743
> 
> 标签：iphone, ios, ipad, game-center

需要动态设置一些游戏规则，并在玩家连接之前通知可能的玩家（当 GC 搜索玩家/自动机时）这些规则。假设我想主持/开始游戏，我想设置一些投注单位的起始数量（10...1000）、难度级别（0...10）、评分系统（0..3）等。我想这就像一个表格，其中包含提供此信息的单元格，因此玩家可以决定他/她是否想加入并按照这些规则玩游戏。如何实施？
AFAIK GKMatch 在搜索玩家时仅使用最小和最大数量的玩家，仅此而已。我可以在邀请中提供此类信息，但我需要其他玩家自己寻找游戏，例如浏览现有游戏，包括规则。自游戏开始以来，我的游戏不允许加入玩家，但我需要以某种方式填补会话所需的玩家数量。就像我只想和一个玩家一起玩一样，我开始游戏时玩家数量=2（以及一些自定义规则），所以我需要 GC 来帮助我找到对面的玩家。在加入我之前，该玩家应该被告知我的规则。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T17:28:44.243

你有两种可能性：

使用 的这些属性`GKMatchRequest`：

> `@property(nonatomic, assign) uint32_t playerAttributes`
> 
> *指定本地玩家想在游戏中扮演的角色的掩码。*
> 
> 如果此值为 0（默认值），则忽略此属性。如果该值不为零，则自动使用该值作为限制玩家可以在组中扮演的角色的掩码。与玩家属性自动匹配遵循两个规则：
> 
> 只有当新玩家的掩码与已经在比赛中的任何玩家的掩码按位与等于 0x00000000 时，才能将新玩家添加到比赛中。玩家被添加到匹配中，直到匹配中所有玩家的掩码的按位或等于 0xFFFFFFFF。有关更多信息，请参阅游戏工具包编程指南。
> 
> `@property(nonatomic, assign) NSUInteger playerGroup`
> 
> *标识允许加入比赛的玩家子集的数字。*
> 
> 如果您的游戏设置了 playerGroup 属性，则只有请求共享相同 playerGroup 值的玩家才会由 Game Center 自动处理。您可以为玩家组使用任何您想要的值。例如，您可以定义不同的 playerGroup 值来实现以下任何过滤器：
> 
> 游戏可以根据技能水平限制玩家。提供多个游戏的游戏可以使用它将玩家过滤到他们想要玩的特定游戏中。具有多个胜利条件（例如，夺旗、生存）的游戏可以将玩家与对相同规则感兴趣的其他人匹配。通过应用内购买提供奖励内容的游戏可以匹配拥有相同内容的玩家。

这允许在搜索玩家之前进行一些游戏配置。

对于复杂的规则，您需要在找到比赛并连接球员后发送配置数据（请参阅 GKMatch API）。这里需要使用可靠传输模式。

你也可以结合这两个想法。

# windows - 更改窗口样式后调用 glViewport 时屏幕闪烁

> ID：13588629
> 
> 赞同：0
> 
> 时间：2012-11-27T16:25:48.147
> 
> 标签：windows, opengl, fullscreen, flicker, windowed

在我的 OpenGL 应用程序中，我使用 Raymond Chen 的解决方案在窗口模式和全屏模式之间切换：

[http://blogs.msdn.com/b/oldnewthing/archive/2010/04/12/9994016.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2010/04/12/9994016.aspx)

除了在多显示器设置中使用时（仅）有两个非常烦人的副作用之外，这还有效：

1.  切换窗口模式后，两个屏幕都闪烁/闪烁，就在调用 glViewport 以适应更改的窗口尺寸的那一刻。
2.  切换后，其他应用程序的桌面上的 Windows 无法正确绘制，直到我最小化/最大化它们（或执行类似的操作以强制刷新）。

有人知道这些影响，也许还知道解决方案吗？

ps：进一步的测试表明，这只发生在我的带有 AMD 卡的 PC 上，而不是我的 Nvidia 卡。如果只有一个监视器处于活动状态，则根本不会发生。

# sql - IBM DB2 希望获得表中每个重复项的唯一计数，并将其与表的另一个值一起列出

> ID：13588634
> 
> 赞同：0
> 
> 时间：2012-11-27T16:26:03.870
> 
> 标签：sql, db2

我有一个包含名为 ORDERITEMS_ID 和 ORDERS_ID 的列的 DB2 表 (orderitems) 我正在寻找与每个 orders_id 关联的所有 orderitems_id 的计数。我可以得到计数，但我想要与该计数关联的 order_id。

我试过了

```
SELECT COUNT(orderitems_id) as total 
FROM orderitems 
GROUP BY orders_id 
ORDER BY total DESC 
```

我相信这给了我 order_id 中每个项目的总数。但我不确定如何在结果集中添加 order_id

如果我尝试以下

```
SELECT orders_id, COUNT(orderitems_id) as total 
FROM orderitems 
GROUP BY orders_id 
ORDER BY total DESC 
```

这是一个错误的查询

我已经考虑过加入，但这似乎是在处理两个表......不知道如何附加这些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:40:39.517

试试这个：

```
select distinct orders_id, 
       count(orderitems_id) as total 
from orderitems 
group by orders_id 
order by total desc 
```

准确地总结你想做的事情通常会有所帮助。`orderitems_id`在这种情况下，您需要对每个 distinct进行计数`orders_id`，例如，每个不同的值`orders_id`而不是每一行。当您想要一个取决于列的不同值的结果时，请考虑`distinct`.

# css - 我可以制作一个纯 CSS 选项卡式边框吗？

> ID：13588635
> 
> 赞同：0
> 
> 时间：2012-11-27T16:26:07.370
> 
> 标签：css

我想给一个元素一个边框顶部，在右上角有一个标签，如下所示：

![](../Images/cd7e6764ea4f98ba47c67631e08c9164.png)

由于这将是 Adob​​e Business Catalyst 模板中的重复元素，我希望它是纯 CSS 或至少是 CSS 和 javascript，而不使用任何图像。有什么办法可以做到这一点？

由于它只是一个装饰元素，它不必是跨浏览器的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:36:44.293

看看这个：

[http://jsfiddle.net/8hB7E/](http://jsfiddle.net/8hB7E/)

HTML：

```
<body>
<div class="element">

</div>
</body> 
```

CSS：

```
body { background: #555 }

.element { background: #000; border-top: 2px solid #fff; height: 100px; position: relative; width: 300px; }

.element:after { background: #fff; content: " "; height: 10px; position: absolute; right: 0; top: 0; width: 20px; } 
```

它利用 :after 伪元素（我发现它非常有用！）

有关更多信息，请参见此处：

[http://coding.smashingmagazine.com/2011/07/13/learning-to-use-the-before-and-after-pseudo-elements-in-css/](http://coding.smashingmagazine.com/2011/07/13/learning-to-use-the-before-and-after-pseudo-elements-in-css/)

不幸的是，这在 IE7 或 6 中不起作用——尽管它不是网站功能的核心，所以我认为它是可以的。

# javascript - 在“for”循环中将变量添加到 href

> ID：13588636
> 
> 赞同：0
> 
> 时间：2012-11-27T16:26:07.630
> 
> 标签：javascript

这是代码：

```
for (i = 0; i < 8; i++) {
    var meun = document.createElement("div");

    meun.setAttribute('id', i);
    meun.setAttribute("style", "width:70px; height:70px; background:url(archive/" + i + ".jpg); background-size: 70px 70px; float:left; margin-top:10px; opacity:1");
    document.body.appendChild(frame);
    document.getElementById("frame").appendChild(meun);

    meun.addEventListener('click', function () {
        window.location.href = "i+'.html'"
    }, false);
} 
```

我遇到的问题是`addEventListener`：如何将变量传递`i`给`href`？我想这是语法问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:29:55.003

不仅是语法问题，还需要一个闭包：

```
(function(x) {
    meun.addEventListener('click', function(){window.location.href = x + '.html'}, false);
})(i); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:28:14.730

如果你想使用变量`i`，不要把它放在引号中，这意味着字母“i”：

```
meun.addEventListener('click', function() {
    window.location.href = i + '.html';
}, false); 
```

# excel - Excel VBA：将单元格从多张工作表复制到一张工作表

> ID：13588637
> 
> 赞同：1
> 
> 时间：2012-11-27T16:26:08.987
> 
> 标签：excel, vba

我对 VBA 很陌生，并且正在尝试自动化一个工作过程，我需要从 6 个工作表的数组中提取选定的单元格并将它们合并到另一个工作表中。我的代码可以工作，但有点“笨拙”——我正在使用 excel 复制和粘贴功能，但似乎找不到远离复制和粘贴功能的好解决方案。当我尝试添加粘贴特殊功能时，出现 1004 错误。希望有关于优化这个的建议！

对于要复制的每张工作表，单元格在第一列中标记为“1”、“0”或留空 - 如果单元格为“1”或“0”，我将行中的其他单元格复制到合并工作表中. 行之间有一些间隙，所以我选择使用 For-Loop 而不是 Do-While 语句。

我附上代码如下：

```
Sub TEST()
    Dim i As Integer 'copying row counter for each sheet to be copied
    Dim j As Integer 'pasting row counter in consolidated sheet
    Dim cal(1 To 6) As String  'copied sheetname
          cal(1) = "Picks"
          cal(2) = "Eats"
          cal(3) = "Night Out"
          cal(4) = "Active"
          cal(5) = "Family"
          cal(6) = "Arts"
    Dim x As Integer

    Dim y As Integer 'column for date
    Dim z As Integer 'max row to run till

    y = 1 'column checked in each sheet where condition for copying is met
    z = 300 'number of rows to check in each sheet

    j = 1

    For x = 1 To 6

    For i = 1 To z
        If Sheets(cal(x)).Cells(i, y) = "0" Or Sheets(cal(x)).Cells(i, y) = "1" Then
            Sheets(cal(x)).Select
            Range(Sheets(cal(x)).Cells(i, 2), Sheets(cal(x)).Cells(i, 10)).Select
            Selection.Copy
            Application.Goto ActiveWorkbook.Sheets(Consolidated).Cells(j, 1)
            ActiveSheet.Paste
    Else
        j = j - 1
        End If
        j = j + 1
    Next i
    Next x
End Sub 
```

同样，我很想优化这段代码，使用另一种方法而不是复制粘贴。我也试过：

```
Application.Goto ActiveWorkbook.Sheets(Consolidated).Cells(j, 1)
ActiveSheet.PasteSpecial Operation:=xlPasteValues 
```

这导致了 1004 错误。很想知道出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:43:45.393

您收到错误是因为您尝试粘贴到活动表而不是活动表上的范围，并且因为您的`PasteSpecial`方法参数错误。

这将起作用，尽管这不是您想要做的：（请参阅`CopyWithoutClipboard`下文以获得更好的选择）

```
Sub PasteIntoGoto()
    Sheets("sheet1").Range("A1").Copy
    Application.Goto ActiveWorkbook.Sheets("Sheet3").Cells(1, 1)
    ActiveSheet.Cells(1, 1).PasteSpecial Paste:=xlPasteValues
End Sub 
```

请注意插入在`ActiveSheet`and`PasteSpecial`和`Paste:=`而不是之间的范围`Operation:=`。

你想优化你的代码是对的。也许 Excel VBA 开发中最重要的准则是**永远不要选择任何东西**，这可能会导致各种问题。在您的第一个示例中，您正在`.Select`显式使用，而在第二个示例中，`.GoTo`实际上是在做同样的事情。

无需选择工作表、复制范围、选择另一个工作表并粘贴到另一个范围，您可以将数据的副本写入目标范围（在同一个工作表上或另一个工作表上），如下所示：

```
Sub CopyWithoutClipboard()
    Sheets("sheet1").Range("A1").Copy Sheets("sheet2").Range("A1")
End Sub 
```

显然，您可以使用变量来代替上面代码片段中的硬编码对象。

# c - 在 Linux 中处理 sk_buff 数据包的所有有效负载的正确方法是什么

> ID：13588639
> 
> 赞同：7
> 
> 时间：2012-11-27T16:26:19.267
> 
> 标签：c, networking, linux-kernel, skb

我目前正在尝试调试在以太网之上运行的 ATM 封装层。基本上，ATM 信元在以太网标头之后按顺序存储。但是我怀疑司机对 sk_buffs 的天真方法被打破了。

驱动程序盲目地假设 skb->data 可以迭代，但查看 virtio_net.c:page_to_skb 的内核代码我看到以下行为：

```
memcpy(hdr, p, hdr_len);
len -= hdr_len;
p += offset;
copy = len;

if (copy > skb_tailroom(skb))
        copy = skb_tailroom(skb);

memcpy(skb_put(skb, copy), p, copy); 
```

然后进一步：

```
while (len) {
        set_skb_frag(skb, page, offset, &len);
    page = (struct page *)page->private;
    offset = 0;
} 
```

这似乎表明缓冲区是碎片化的，只有第一部分可以从 skb->data 直接访问。

我应该使用什么来获取基础数据。理想情况下，我想在 memcpy 将块放入我维护的重组缓冲区之前，在以太网数据包中的任意偏移处查看几个字节。我应该用什么来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T17:46:49.637

套接字缓冲区的实现由一个线性数据缓冲区和一个或多个页面缓冲区组成。

套接字缓冲区中是否存在分页数据由`skb->data_len`成员非零表示。

`bool skb_is_nonlinear(const struct sk_buff *skb)`定义在`/include/linux/skbuff.h`用于测试这一点。

skb->data处的非分页数据量可以计算为skb->len - skb->data_len。 `unsigned int skb_headlen(const struct sk_buff *skb)`定义在`/include/linux/skbuff.h`用于测试这一点。

该`skb->data`指针仅指向您描述的驱动程序可能依赖的非分页数据。

`void *skb_header_pointer(const struct sk_buff *skb, int offset, int len, void *buffer)`中定义`/include/linux/skbuff.h`。它需要您想要的套接字缓冲区、字节偏移量和字节长度以及一个本地数据缓冲区，该缓冲区仅在数据位于其中一个页面缓冲区中时使用。

它返回指向线性数据缓冲区中的数据`skb->data`的指针或指向提供的本地数据缓冲区的指针，如果您的偏移量和长度不正确，则返回 NULL。

对于大于协议标头的数据，您可以使用

`int skb_copy_bits(const struct sk_buff *skb, int offset,void *to, int len);`

从给定的套接字缓冲区、字节偏移量和字节长度复制到给定的内核缓冲区。

或者

`int skb_copy_datagram_iovec(const struct sk_buff *from, int offset, struct iovec *to, int size);`

从给定的套接字缓冲区、字节偏移量和字节长度复制到用户空间中的给定 iovec 结构。

在 netfilter 代码和其他以太网驱动程序中可以看到使用示例。

**了解更多信息**

*   [David S. Miller 的套接字缓冲区介绍](http://vger.kernel.org/~davem/skb.html)
*   [David S. Miller 的套接字缓冲区数据布局](http://vger.kernel.org/~davem/skb_data.html)
*   [OSAdewale 的 Roberto Innocente 的套接字缓冲区教程](http://people.sissa.it/~inno/pubs/skb-reduced.pdf)

# php - 输出php数组

> ID：13588640
> 
> 赞同：-2
> 
> 时间：2012-11-27T16:26:29.363
> 
> 标签：php, mysql, arrays

```
<html>
<body>
<?php

include 'index.php';
include '../db.php';
$query_email = "SELECT email FROM email_addresses"; 
$result_query_email = mysqli_query($query_email)
or die(mysqli_error());

while ($row = mysqli_fetch_array()($result_query_email)) {

//$email_user = $row[10];
$email_user = $row['email'];

$data = date("Y.m.d");
$subject = "Good news";
$message = ("Hello!");

$sentemail = mail($email_user, $subject, $message, 
"From: abc <xyz.com>\nX-Mailer: PHP/" . phpversion());
}
if($sentemail) 
{

    print("Email has been sent successfully.<br>");
}
else
{
  print("There was a problem while sending email.<br>");
}

?>

</body>
</html> 
```

此代码用于从数据库中选择电子邮件地址并向他们发送电子邮件。我的代码有什么问题，我无法收到任何电子邮件，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:30:02.583

设置[error_reporting](http://www.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)和[display_errors](http://www.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)来发现里面有`)`缺失

`while (mysql_fetch_array($result_query_email) {`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:30:19.543

这条线在这里

```
while (mysql_fetch_array($result_query_email) 
```

您需要将返回值分配`mysql_fetch_array()`给一个变量，以便能够在`while()`循环中使用它以及缺少的关闭`)`

例如

```
while ($emaildata = mysql_fetch_array($result_query_email)) {
{
    $email_user = $emaildata['email'];
 //.....rest of code 
```

*还*

[请不要`mysql_*`在新代码中使用函数](https://stackoverflow.com/q/12859942)。它们不再被维护并且弃用过程已经开始，见[红框](http://php.net/mysql-connect)。改为学习[准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)；[本文](http://php.net/mysqlinfo.api.choosing)将帮助您决定哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

**编辑**

此外，您似乎正在尝试将变量用作您需要使用的关联数组，`mysql_fetch_assoc()`而不是`mysql_fetch_array()`这样做

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:28:39.090

如果您没有在源代码中提供，请在您的服务器 PHP.ini 中设置正确的 SMTP 服务器地址。

# ruby-on-rails - 当多个应用程序在 Ruby 中共享同一个数据库时，如何管理迁移？

> ID：13588642
> 
> 赞同：6
> 
> 时间：2012-11-27T16:26:35.273
> 
> 标签：ruby-on-rails, ruby, activerecord, sinatra, database-migration

我有一个 Rails 应用程序和一个 Sinatra 应用程序，共享同一个数据库。Sinatra 应用程序使用 ActiveRecord。

我可以从每个应用程序中运行迁移，就好像它们在同一个应用程序中一样？这会导致任何问题吗？

Rails 应用程序中的 schema.rb 文件通过以下方式跟踪当前迁移

```
ActiveRecord::Schema.define(:version => 20121108154656) do 
```

但是，Sinatra 应用程序如何知道数据库的当前版本？

导轨 3.2.2，红宝石 1.9.3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T16:54:02.890

schema_migrations 表中的版本列等同于 ruby​​ 迁移文件示例前面的时间戳：20130322151805_create_customers.rb 因此，如果两个或更多应用程序对 schema_migrations 表有贡献，并且 rails 找不到down() 方法（因为它不会找到另一个应用程序中包含的迁移文件，即 db/migrate/...）

我目前的情况就是这样，我选择了一个主 ActiveRecord 应用程序，它可以随着我们的数据库的发展来管理迁移和数据转换。请记住，交易的一部分是让模型保持最新。这非常耗时，因此我们正在考虑将数据库拆分为业务域并提供 API (JSON) 来查询另一个应用程序的支持数据。这样每个应用程序都管理它的域并负责通过 API 公开数据。

问候。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:37:08.053

如果您将两个应用程序连接到同一个数据库，您应该能够在其上运行迁移，但我强烈建议您使用另一种选项，因为您几乎肯定会在某个时候碰壁：

*   如果可能，将数据库一分为二，每个应用程序负责自己的数据库/迁移。

*   将一个应用程序视为“主”数据库，并将另一个数据库用于特定于第二个应用程序的数据，但使其连接到两个数据库（每个应用程序仍然只将迁移应用到一个数据库）

如果您需要在多个应用程序之间共享数据，另一种选择是在一个应用程序中实现一个 REST 服务并在另一个应用程序上使用它，您可以查看葡萄 gem 以获得一种简单的方法。

编辑：我意识到我忘了谈论 activerecord 迁移，不再有任何“版本”模式，activerecord 所做的是它读取所有迁移文件名，提取它们的标识符（起始部分）并检查它们是否有已经应用了，所以理论上你可以从同一个数据库上的两个应用程序运行迁移，只要它们不干扰。但是如果两个迁移都作用于同一张表，你几乎肯定会在某一时刻遇到大麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T09:51:44.463

Rails 迁移将当前数据库版本存储在数据库的`schema_migrations`表中。因此，您的两个应用程序都将能够检查当前版本。

版本号是时间戳，所以重复值不应该有任何问题，因为几乎不可能在完全相同的毫秒内生成两个迁移。所以你在这里应该没问题。

我看到的唯一问题是，当您在一个应用程序中回滚迁移时，它会将数据库设置为以前的已知版本，我不确定它是否会从数据库中选择前一个（可能来自另一个app)，或上一个迁移文件中的编号。您可能需要测试该场景以确保。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T16:48:12.630

我不同意 Schmurfy，即使他提出的选项是有效的，通过 REST 共享数据也有点矫枉过正（当然，用 ruby​​ / rails 很容易实现）。

如果您的情况很简单，您可以只使用两个应用程序中的一个数据库，并且由于您在这两个应用程序中都使用 AR，所以版本控制没有问题，AR 可以解决这个问题。

我也不知道如果你同时运行 db:migrate 从两个应用程序中会发生什么，如果你使用像 mysql 这样的劣质 dbms，它不允许在事务中进行 DDL，当然没什么好..

此外，查看哪个应用程序需要哪个列并且没有将迁移放在一个地方也会让我感到困扰。您可以使用共享存储库来管理两个应用程序的迁移。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T15:34:51.460

我决定将所有迁移都放在 Rails 应用程序中，因为：

1.  由于只有一个数据库
2.  Rails 管理迁移

这运作良好。

这简化了系统，因为所有迁移都存储在一个地方。而且，无论如何，Sinatra 应用程序都不需要知道它们。

# qt - QML 桌面应用程序部署中无法识别插件

> ID：13588645
> 
> 赞同：1
> 
> 时间：2012-11-27T16:26:43.810
> 
> 标签：qt, plugins, dll, desktop, qml

我在 Windows7 上用 c++ qnd Qt Creator(QML) 编写了一个 Qt Quick Desktop 应用程序。现在我必须部署它。

我在我的应用程序中使用 Qt Quick Desktop Components 插件，我已经根据[这些](https://stackoverflow.com/questions/6298584/installing-qt-quick-components-for-desktop-for-use-with-qt-creator)说明安装了它，并且我正在使用它：“import Qt.labs.components”，如那里所写。

我尝试添加到 .pro 文件：

`QML_IMPORT_PATH = C:\QtSDK\Desktop\Qt\4.7.4\mingw\imports\Qt\labs\components`

但我看到它没有它也能很好地工作，我把它删除了。

我已经阅读了如何在[此处](http://www.johanpaul.com/blog/2011/07/deploying-qt-and-qt-quick-applications-on-windows/)部署此类应用程序的指南，并遵循了它；我现在有一个部署文件夹，其中包含：.exe 文件、所需的 dll 和一个文件夹层次结构，如：Qt/labs/components。

在组件中，我放置了 styleplugin.dll（用于桌面组件）和一个 qmldir 文件，其内容为：`plugin styleplugin`，与文档中的完全一样。

但是当我从另一台计算机的部署文件夹中运行我的 application.exe 时，我得到一个白色的空窗口，这意味着：它没有找到 .dll 文件。

你应该解释一下有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T05:50:26.560

我知道两个原因，当应用程序无法加载插件 dll 时：

1.  插件dll的一些依赖项丢失或找不到，这就是它无法加载的原因。Qt Creator 或 Visual Studio 环境可能与系统环境不同。例如，您的 IDE 可以修改 PATH 环境变量。在启动应用程序的同一环境中使用 Microsoft Dependency Walker 工具检查插件的依赖项可用性。
2.  应用程序在标准目录中找不到插件。要检查这一点，您应该明确指定插件导入目录：

    ```
    QDeclarativeView *rootView = new QDeclarativeView()
    rootView->engine()->addImportPath(QLatin1String("path/to/your/imports")); 
    ```

# excel - Excel 匹配多个条件

> ID：13588655
> 
> 赞同：2
> 
> 时间：2012-11-27T16:27:59.683
> 
> 标签：excel, excel-2007

有人可以帮我把这 2 个条件匹配函数变成 4 个条件匹配函数吗？这个有效，但仅仅是开始：

```
=INDEX(range1,MATCH(1,(A19=range2)*(B19=range3),0)) 
```

我还想要上面公式中的第三和第四场比赛，这两个是 OR 选项。根据工作版本，我认为这可能有效，但它没有：

```
=INDEX(range1,MATCH(1,(A19=range2)*(B19=range3)*(OR(C19=range4,D19=range5)),0)) 
```

我一直在尝试使用 AND 命令，我上面第一个代码的初始版本是这样的：

```
=INDEX(range1,MATCH(1,AND(A19=range2,B19=range3),0)) 
```

它总是在输入 CTRL+ALT+ENTER 后返回 #N/A ，所以这显然是我对 MATCH 或 AND （​​或者我猜两者都有）的理解的问题，

第一个示例完全按预期工作，但不幸的是我不知道为什么，我无法很好地适应它。也许我太累了，脑子里的空间已经用完了 Excel 公式的特殊工作方式，但是我已经阅读并重新阅读了它们的帮助文件，但对我来说仍然没有意义。

一如既往，我们将不胜感激任何帮助。

谢谢，

乔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:39:16.677

我只是在这里猜测，但这行得通吗？

```
=INDEX(range1,MATCH(1,(A19=range2)*(B19=range3)*(((C19 = range4)+(D19 = range5))>0),0)) 
```

# javascript - 优化 jQuery 代码 - 重复部分

> ID：13588662
> 
> 赞同：0
> 
> 时间：2012-11-27T16:28:18.213
> 
> 标签：javascript, jquery, optimization, jquery-selectors

这更像是一个代码美化问题，但仍然......

我有这个 html：（缩短）

```
<div id="sablona" style="display:none;">
    <div style="position:relative;">
        <fieldset>
            <img class="sm_kont" src="../../include/img/remove_16.png" title="Smazat kontakt" alt="Smazat kontakt" />
            <legend></legend>
            <table>
                <tr>
                    <td>
                        <label for="jmeno_n">jméno</label>
                        <input name="jmeno_n" id="jmeno_n" type="text" value="" />
                    </td>
                    <td>
                        <label for="pohlavi_n">pohlaví</label>
                        <select name="pohlavi_n" id="pohlavi_n">
                            <option value="0"></option>
                            <option value="m">muž</option>
                            <option value="z">žena</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <label for="adresa_n">adresa</label>
                        <textarea name="adresa_n" id="zpr_adresa_n" rows="3"></textarea>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>
</div> 
```

我想复制它来改变它的一些关键属性。这是我使用的代码：

```
var count = 0;

function pridat_kontakt () {
    var novy_kontakt = $("#novy_kontakt").val();
    if (novy_kontakt.length == 0) alert("Typ kontaktu nemůže být prázdný!");
    else {
        var kopie = $("#sablona").children().clone(true);
        kopie.find("legend").text(novy_kontakt);
        kopie.find("label, input, select, textarea").each(function () {
            if (typeof $(this).attr("name") != 'undefined') {
                if ($(this).attr("name").length > 0) {
                    var new = $(this).attr("name") + count;
                    $(this).attr("name", new);
                }
            }
            if (typeof $(this).attr("for") != 'undefined') {
                if ($(this).attr("for").length > 0) {
                    var new = $(this).attr("for") + count;
                    $(this).attr("for", new);
                }
            }
            if (typeof $(this).attr("id") != 'undefined') {
                if ($(this).attr("id").length > 0) {
                    var new = $(this).attr("id") + count;
                    $(this).attr("id", new);
                }
            }
        });
        $("[name='fedit']").append(kopie);
        $("#novy_kontakt").val("");
        count++;
    }
} 
```

一切正常，只是看起来不太好。谁能想到美化它的方法？我的意思是 .each() 部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:36:13.123

您可以声明一个函数并在每个部分中使用它：

```
var checkAttr = function(jelem, attrName) {
    var attrValue = jelem.attr(attrName);
    if (typeof attrValue != 'undefined' && attrValue.length > 0) {
        var newAttr = attrValue + count;
        jelem.attr(attrName, newAttr);
    }
}
kopie.find("label, input, select, textarea").each(function () {
       var jthis = $(this);
       checkAttr(jthis, "name");
       checkAttr(jthis, "for");
       checkAttr(jthis, "id");
}); 
```

# c# - 用户控件不呈现 ascx 的内容

> ID：13588663
> 
> 赞同：11
> 
> 时间：2012-11-27T16:28:21.083
> 
> 标签：c#, user-controls

我认为这是一个简单的问题，直到我开始寻找答案并意识到它是如此简单，我是唯一拥有它的人

我的用户控件没有显示任何内容。我究竟做错了什么？（除了让这成为我的生活......）

控制：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="ctrl.ascx.cs" Inherits="proj.UserControls.ctrl" %>

asdjkldasfjasdfljdfasjklasdfjkl 
```

利用：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="page.aspx.cs" Inherits="proj.Admin.page" %>

<%@ Register assembly="proj" namespace="proj.UserControls" tagprefix="cc1" %>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
        <cc1:ctrl ID="test" runat="server" />
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T16:37:03.367

改变：-

```
<%@ Register assembly="proj" namespace="proj.UserControls" tagprefix="cc1" %> 
```

至

```
<%@ Register TagPrefix="cc1" TagName="ctrl" Src="/path/to/ctrl.ascx" %> 
```

您缺少`TagName`，它表示控件声明中冒号后面的文本。您也没有告诉引擎在哪里可以找到源文件（`Src`属性）。更改`/path/to`以表示从根目录到您的控件的路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:51:18.030

如果您创建了自定义控件，那么您应该添加自定义控件的 dll 引用（从 Visual Studio 的工具箱中选择项目）。然后在页面中使用以下标签：

`<%@ Register assembly="proj" namespace="proj.UserControls" tagprefix="cc1" %>`

如果您创建了用户控件，则在您的页面中添加以下行：

`<%@ Register src="~/UserControls/ctrl.ascx" TagName="ctrl" tagprefix="cc1" %>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:36:48.873

代替

```
<%@ Register assembly="proj" namespace="proj.UserControls" tagprefix="cc1" %> 
```

利用

```
 <%@ Register  src="~/UserControls/ctrl.ascx"  TagName="ctrl" tagprefix="cc1" %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-13T16:29:53.777

确保您没有在包含您的控件的面板或 div 上设置 visible="false"。

那会为我节省一个小时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-06T12:23:08.933

我不得不向已经包含很多控件的现有项目添加一个新的用户控件，并且想知道为什么我的没有渲染。原来你也可以在**configuration**、**system.web**、**pages**`Web.config`下指定这个，像这样：

 ******```
<controls>
    <add tagPrefix="cc1" tagName="ctrl" src="~/UserControls/ctrl.ascx" /> 
```

...这将为整个项目注册控件，因此您不必在每个页面上都指定它。对于重用的控件很有用。******

# python - 具有工厂功能的可变分辨率

> ID：13588665
> 
> 赞同：0
> 
> 时间：2012-11-27T16:28:29.110
> 
> 标签：python, django

我遇到了一个我无法解决的有趣/令人沮丧的 Python 问题。我们有这个代码：

```
def eventtag_with_view_factory(view):
    print "==1", view

    class Cls(models.EventTag):

        # means this class does not make django change the database
        class Meta:
            proxy = True

        print "==2", view

        @permalink
        def get_absolute_url(self):
            print "==3", view
            return ("search_query_view", (),
                {'query': quote('#') + self.name, 'view': view})

    return Cls 
```

它是一个工厂函数，返回具有不同绝对 url 的 EventTag。

如果我们调用它一次一切正常，但是当我们调用它两次（从 for 循环调用）时，1\. 和 2\. print 语句为我们提供了新视图，但 3\. 仍然使用调用的第一个值我们的工厂函数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:40:20.130

没有看到更多的代码，我唯一的猜测是你看到的是这样的：http: [//me.veekun.com/blog/2011/04/24/gotcha-python-scoping-closures/](http://me.veekun.com/blog/2011/04/24/gotcha-python-scoping-closures/)

# javascript - 如何从其他模块返回填充的延迟对象？

> ID：13588666
> 
> 赞同：0
> 
> 时间：2012-11-27T16:28:33.960
> 
> 标签：javascript, jquery

我试图理解 JavaScript 中的延迟对象。我也在使用[显示模块模式](http://www.addyosmani.com/resources/essentialjsdesignpatterns/book/#revealingmodulepatternjavascript.)，它运行良好。

我有以下引导程序代码：

```
function bootStrapper() {    
    var result = xmlRepository.loadAll();   
} 
```

在 xmlRepository 我有一个“私人”功能：

```
function loadAllXML() {
    var d = $.Deferred();

    $.ajax({
        type: "GET",
        url: "http://localhost/Autopolicy/dataSource.xml",
        dataType: "xml",
        success: function (xml) {
            d.resolve(xml);
            $xml = xml;
        }
    });

    return d.promise();
} 
```

然后我有一个名为 loadAll() 的“公共”函数，看起来像：

```
function loadAll() {
    loadAllXML().done(function (xml) {
        // I want to return the populated xml to the bootstrapper
    });                
} 
```

返回给引导程序的值始终是未定义的。

如何修改代码以便 var result = xmlRepository.loadAll()); 有一个 xml 填充的结果？

谢谢

# android - 系统更新到 Nexus 7 后启动服务时 ADB 抛出 SecurityException：“调用方 uid=2000 无权与用户 =-2 通信”

> ID：13588668
> 
> 赞同：12
> 
> 时间：2012-11-27T16:28:44.347
> 
> 标签：android, adb

我向 Nexus 7 平板电脑发出以下命令：

```
adb.exe -s 015d2109567231a0f shell am startservice -n com.packagename/.ExServiceName --ei port 59777 
```

并得到：

```
Starting service: Intent { cmp=com.packagename/.ExServiceName (has extras) }
java.lang.SecurityException: Caller uid=2000 is not privileged to communicate with user=-2
    at android.os.Parcel.readException(Parcel.java:1425)
    at android.os.Parcel.readException(Parcel.java:1379)
    at android.app.ActivityManagerProxy.startService(ActivityManagerNative.java:2648)
    at com.android.commands.am.Am.runStartService(Am.java:415)
    at com.android.commands.am.Am.run(Am.java:111)
    at com.android.commands.am.Am.main(Am.java:82)
    at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
    at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:235)
    at dalvik.system.NativeStart.main(Native Method) 
```

### 在我对平板电脑应用系统更新之前，这一切都没有问题！

当前平板电脑信息：

```
Model number: Nexus 7
Android version: 4.2
Kernel version: 3.1.10-g22b4fcd 
```

服务清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.packagename"
    android:versionCode="1"
    android:versionName="1.0">

    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15" />
    <uses-permission android:name="android.permission.INTERNET"/>

    <application android:label="@string/app_name"
        android:icon="@drawable/ic_launcher"
        android:theme="@style/AppTheme">

        <service android:name=".ExServiceName" android:exported="true"></service>

    </application>

</manifest> 
```

我正在开发`Windows 7 x64`

您能否告诉我如何使服务成功接受意图而不抛出任何类型的异常？

谢谢，
康拉德

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-14T10:54:42.503

我在 Android 4.2 版本的 Galaxy Nexus 上遇到了同样的异常。

我通过以下命令成功启动服务。

```
am startservice --user 0 -a <action> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-15T04:41:11.750

在互联网上进行了大量搜索和 Koji Hisano 非常有用的帖子后，我设法让系统栏出现使用：

```
am startservice --user 0 -n com.android.systemui/.SystemUIService 
```

如果使用了 -a 选项，我会收到一条消息：

错误：未找到；没有服务启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T09:04:05.503

您也可以通过以下方式在有根电话上启动该服务：

```
adb.exe -s 015d2109567231a0f shell su -c "am startservice -n com.packagename/.ExServiceName --ei port 59777" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-08T13:37:43.097

对我有用的是：
打开 Android Studio 终端，然后

```
adb shell
run-as com.app_package_name
am startservice --user 0 -n com.app_package_name/.service_package_name.ServiceName 
```

# objective-c - 使用 UIImagePickerController 录制视频并达到 videoMaximumDuration 时更改 UIAlertView 的文本

> ID：13588672
> 
> 赞同：0
> 
> 时间：2012-11-27T16:28:56.067
> 
> 标签：objective-c, ios, uiimagepickercontroller

`UIAlertView`当我用 a 录制视频`UIImagePickerController`并达到 videoMaximumDuration时，我想知道如何更改出现的文本。如果无法更改其文本`UIAlertView`，是否至少可以用另一种语言显示？

编辑：默认文本是“已达到此视频的最大长度”，标题为“视频录制已停止”。

谢谢你，艾马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:02:43.960

警报的文本已本地化为设备的当前区域设置，除非您想在视图层次结构中查找 UIAlertView 并设置其`message`属性（这是脆弱的，需要在所有 iOS 版本中进行测试）重新部署到），您可能需要在捕获会话之上创建一个完全自定义的 UI。选择器控制器委托协议在录制停止和开始时没有回调，因此没有一种好的方法可以手动控制它并提供您自己的警报，而无需在 AVFoundation 中进行低级别的操作。

# java - 使用 NetBeans 7.2.1 在 java Midlet 中打开 HTML 页面

> ID：13588673
> 
> 赞同：1
> 
> 时间：2012-11-27T16:29:03.307
> 
> 标签：java, midlet

作为学校项目，我需要开发一个要求 URI 的 java Mid let。然后应用程序将使用给定的 URI 建立 HTTP 连接并检索 HTML 页面，并将其显示给用户。我可以提供 HTML 链接，但它会在我运行应用程序时显示 HTML 代码。我正在使用 java net beans 谢谢，非常感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:36:34.590

您真正需要的是打开本机浏览器并在其中显示 HTML 页面。这可以使用平台调用来完成：

`getInstance().platformRequest("http://bombusqd.hdd1.ru/m/")`

`getInstance()`是一种方法`MidLet`。

# ruby-on-rails - 可以对 yaml 文件使用 collection_select 吗？

> ID：13588676
> 
> 赞同：1
> 
> 时间：2012-11-27T16:29:14.373
> 
> 标签：ruby-on-rails, internationalization, yaml

我的 Rails 应用程序当前使用**collection_select**来选择下拉列表等的查找值。这有两个优点：

1.  数值一致
2.  选择值的id存储在数据库中，而不是文本值

例如：edit.html.erb

```
<div class="field">
  <%= f.label :course_type %><br />
  <%= f.collection_select :course_type, Lookup.find(:all,:conditions => ["model_name = 'course' and field_name = 'course_type'"]), :id, :lookup_text, include_blank: false,:prompt => "Course Type" %>
</div> 
```

course_controller.rb

```
private
  def get_lookups
    @course = Course.find(params[:id])
    @course_type = Lookup.find(@course.course_type).lookup_text 
```

显示.html.erb

```
<b>Course type:</b>
<%= @course_type %> 
```

我的应用程序将是多语言的，Rails 使用语言环境文件来处理这个问题。

问题是：是否有可能（并且明智）从 yml 文件而不是模型/表中填充查找值，并且可以轻松扩展以处理多种语言吗？如何将上面的代码替换为基于 yml 的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T19:36:11.100

一种解决方案是将翻译保存在数据库中，也许使用我们的[Traco](https://github.com/barsoom/traco)库。我怀疑它会与`collection_select`.

如果您想从翻译 YML 文件中提取选项，我建议[`options_for_select`](http://apidock.com/rails/v3.2.8/ActionView/Helpers/FormOptionsHelper/options_for_select). 总而言之，像：

**en.yml**

```
en:
  my_options:
    one: "Option 1"
    two: "Option 2" 
```

**看法：**

```
select_tag :foo, options_for_select(t("my_options").invert) 
```

如果你翻译非叶键，Rails i18n 会给你一个哈希，比如“my_options”。您需要`invert`因为`options_for_select`需要值之前的文本，而翻译哈希则相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-08T17:55:33.590

要翻译您的`collection_select`.`name_translated`

看法：

```
<%= f.collection_select :product_id, Product.all, :id, :name_translated %> 
```

模型：

```
class Product < ActiveRecord::Base
  def name_translated
    I18n.t(name)
  end
end 
```

YAML 文件：

```
en:
  name1: "Hammer"
  name2: "Plastic sheets"
  name3: "Duct tape" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-08T08:45:59.967

我使用选择：

```
<%= f.select :role, MAIN_CONFIG['manager_roles'].map { |s| [s.last, s.first] }, selected: @manager.role %> 
```

还有我的 yaml 文件 main_config.yml：

```
manager_roles:
  admin: 'Суперадмин'
  partner_admin: 'Администратор'
  manager: 'Менеджер' 
```

# python - 绑定到 NumPy 数组的变量的独立性

> ID：13588684
> 
> 赞同：4
> 
> 时间：2012-11-27T16:29:47.203
> 
> 标签：python, numpy

我有一个 NumPy 数组，我们称之为`A`. 我不清楚以下代码的行为：

```
b = A[3,:];
A[3,:] = 0; 
```

第三行必须保存在 中`b`，但意外地`b`也变成了零！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:38:30.473

事实上，要制作副本，您必须制作`copy`!

```
b = A[3,:].copy() 
```

（顺便说一句，python 不是 C：语句后不需要分号。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T10:02:16.563

从 MATLAB/Octave 迁移我看到了 :-)？

1) 请记住 Python 使用基于 0 的数组，而不是 MATLAB 的基于 1 的数组。 `A[3,:]`实际上会给你第四行。

2) 与 MATLAB 不同，从这样的数组中获取切片会将切片的内存位置从*slicee 存储*到*slicer*中。因此，正如 Andrew J. 所说，您需要复制。

根据您想要“第三行必须保存在 b 中”的声明，您的代码应该是

```
b = A[2,:].copy() 
```

# nservicebus - NServiceBus HandleMessage 异步导致崩溃

> ID：13588685
> 
> 赞同：3
> 
> 时间：2012-11-27T16:29:47.033
> 
> 标签：nservicebus

我正在查看 NServiceBus v3.3.0.0，在我们的 MessageHandler 中它调用外部 WCF 服务。

如果 WCF 服务被同步调用并且该服务抛出异常，NServiceBus 会完美处理它并根据配置重试该过程。

但是，如果异步调用 WCF 服务并引发异常，则订阅者进程将崩溃。

因此，例如，如果 service.Update 抛出，这可以很好地处理异常

```
 public class LeagueMessageHandler : IHandleMessages<LeagueMessage>
   {
       public void Handle(LeagueMessage message)
       {
           var service = new LeagueService.LeagueContractClient();
           var league = service.Update(leagueDto);
       }
   } 
```

但如果对 service.UpdateAsync 的调用引发异常，则进程崩溃

```
 public class LeagueMessageHandler : IHandleMessages<LeagueMessage>
   {
       public async void Handle(LeagueMessage message)
       {
           var service = new LeagueService.LeagueContractClient();
           var league = await service.UpdateAsync(leagueDto);
       }
   } 
```

WCF 服务只是作为服务引用添加到类库中，它生成异步方法包装器。

在 Adam 和 Udi 评论之后进行编辑。

看起来这个问题与 NServiceBus 无关，它更多地与控制台应用程序如何处理抛出异常的异步方法有关。请看线程

[从异步中捕获未处理的异常](https://stackoverflow.com/questions/12314410/catch-unhandled-exceptions-from-async)

斯蒂芬克利里写了这个

[http://nuget.org/packages/Nito.AsyncEx](http://nuget.org/packages/Nito.AsyncEx)

这可以帮助您滚动自己的 SynchronisationContext 来处理捕获异常。所以上面的 WCF 调用是这样包装的......

```
 var league = AsyncContext.Run(() => service.UpdateAsync(leagueDto)); 
```

当抛出异常时，它会在该上下文中被捕获，并且控制台应用程序不再关闭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T08:07:31.737

当您将其称为异步时，异常发生在与处理消息的线程不同的线程上。出于这个原因，NServiceBus 无法知道哪个消息是导致该异常的消息，因此它无法回滚任何内容。

使用 NServiceBus 时，您的整体架构已经是异步的——实际上没有任何需要异步执行这些 WCF 调用。

# c# - 低效的Parallel.For？

> ID：13588688
> 
> 赞同：1
> 
> 时间：2012-11-27T16:30:06.283
> 
> 标签：c#, c#-4.0, task-parallel-library

我在我的代码中使用并行 for 循环在大量实体（12,000）上运行长时间运行的进程。

该过程解析一个字符串，遍历许多输入文件（我已经读过，鉴于基于 IO 的事物的数量，线程的好处可能值得怀疑，但它似乎在其他地方加快了速度）并输出匹配的结果。

最初，该过程进行得非常快 - 但最终会慢到爬行。它可能只是遇到了一些特别棘手的输入数据，但这似乎不太可能仔细观察。

在循环中，我添加了一些调试代码，当它开始/结束迭代时打印“开始处理：”和“完成处理：”，然后编写了一个配对开始和结束的程序，最初是为了找到哪个 ID 是导致崩溃。

但是，从不匹配 ID 的数量来看，该程序似乎同时处理了超过 400 个不同的实体。这似乎是，对于大量的 IO，它可能是问题的根源。

所以我的问题是（是）这个（这些）：

*   我是否正确地解释了不匹配的 ID，或者在幕后我错过了一些聪明的东西，或者甚至是一些明显的东西？
*   如果您同意我发现的内容是正确的，我该如何限制它分拆并立即执行的数量？

我意识到这可能是一个有点非正统的问题，并且由于没有代码，可能很难回答，但感谢您提供任何帮助，如果您想了解更多信息，请在评论中告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:39:45.890

没有看到一些代码，我可以猜测你的问题的答案：

*   不匹配的 ID 向我表明正在处理该数据的线程正在被取消优先级。这可能是由于 IO 或线程池试图优化，但似乎如果您受到强烈的 IO 限制，那么这很可能是您的问题。
*   我会看一下[Parallel.For](http://msdn.microsoft.com/en-us/library/dd781401.aspx)，特别是使用[ParallelOptions.MaxDegreesOfParallelism](http://msdn.microsoft.com/en-us/library/system.threading.tasks.paralleloptions.maxdegreeofparallelism.aspx)将最大任务数限制为合理的数量。我建议从您拥有的处理器内核数量开始，通过反复试验来确定最佳度数。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:09:37.847

让我首先确认从硬盘驱动器同时读取 2 个文件确实是一个非常糟糕的主意（至少在大多数 HD 都是 SSD 之前），更不用说你的整个设备正在使用的数字了。并行性的使用有助于使用实际上可并行化的资源（即 CPU 能力）来优化处理。如果您从硬盘驱动器并行读取进程，那么您将失去大部分好处。

即便如此，即使是 CPU 能力也不容易发生无限并行化。一个普通的台式机 CPU 最多可以同时运行 10 个线程（显然取决于型号，但这是数量级）。

所以有两件事

*   首先，我将假设您的实体使用您的所有文件，但您的文件不会太大而无法加载到内存中。如果是这种情况，您应该将文件读入对象（即读入内存），然后使用这些对象并行处理您的实体。如果没有，您基本上是在每次需要文件时都依赖硬盘驱动器的缓存而不是重新读取文件，并且硬盘驱动器的缓存远小于内存（1000 倍）。

*   其次，您不应该在 12.000 个项目上运行 Parallel.For。Parallel.For 实际上会（尝试）创建 12.000 个线程，这实际上比 10 个线程更糟糕，因为并行化会产生很大的开销，而且你的 CPU 根本不会从中受益，因为它不能运行超过一次10个线程。

您可能应该使用更有效的方法，即`IEnumerable<T>.AsParallel()`扩展（.net 4.0 附带）。这将在运行时确定要运行的最佳线程数，然后将您的可枚举分成尽可能多的批次。基本上，它为你完成了这项工作——但它也会产生很大的开销，所以它只有在处理一个元素实际上对 CPU 来说成本很高时才有用。

根据我的经验，应该始终评估使用任何并行的东西，而不是在现实生活中不使用它，即通过实际分析您的应用程序。不要以为它会更好地工作。

# c# - .net 框架中的哪个库可用于执行程序？

> ID：13588694
> 
> 赞同：0
> 
> 时间：2012-11-27T16:30:23.207
> 
> 标签：c#

我想编写一个具有以下功能的程序：用户执行程序（C# 中的控制台应用程序），键入程序名称，然后按 Enter 键，程序应该初始化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:35:36.987

就这一次，我会给你代码。如果你想让你的启动器更复杂，那部分取决于你。

```
class Program
{
    public static void Main(string[] args)
    {
        Process process = new Process();
        process.StartInfo.FileName = args[0];
        process.StartInfo.UseShellExecute = false;
        process.StartInfo.CreateNoWindow = true;
        process.Start();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:32:02.337

This feature is built into the core of .NET, no external library required:

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:32:34.880

Have a look at the `Process`*^([[MSDN]](http://msdn.microsoft.com/en-us/library/system.diagnostics.process%28v=vs.110%29.aspx))* class. That should get you started, and if you have any trouble, post another question.

Here's the example from the linked MSDN documentation:

```
using System;
using System.Diagnostics;
using System.ComponentModel;

namespace MyProcessSample
{
    class MyProcess
    {
        public static void Main()
        {
            Process myProcess = new Process();

            try
            {
                myProcess.StartInfo.UseShellExecute = false;

                // You can start any process.
                // HelloWorld is a do-nothing example.
                myProcess.StartInfo.FileName = "C:\\HelloWorld.exe";
                myProcess.StartInfo.CreateNoWindow = true;
                myProcess.Start();

                // This code assumes the process you are starting will 
                // terminate itself.  
                //
                // Given that is is started without a window so you cannot 
                // terminate it on the desktop, it must terminate itself 
                // or you can do it programmatically from this application 
                // using the Kill method.
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
            }
        }
    }
} 
```

# parsing - 关注功能如何运作？（编译器）

> ID：13588695
> 
> 赞同：1
> 
> 时间：2012-11-27T16:30:25.410
> 
> 标签：parsing, grammar, context-free-grammar

语法：

```
E -> TE’
E’ -> +TE’ | ε
T -> FΤ’
Τ’ -> *FΤ’ | ε
F -> (E)| id 
```

职能：

```
1\. FIRST(F) = FIRST(T) = FIRST(E) = {(, id}
2\. FIRST(E’) = {+, ε}
3\. FIRST(T’) = {*, ε}
4\. FOLLOW(E) = FOLLOW(E’) = {), $}
5\. FOLLOW(T) = FOLLOW(T’) = {+, ), $}
6\. FOLLOW(F) = {*, +, ), $} 
```

这是我讲座中的语法和功能......有人可以解释一下**FOLLOW**是如何工作的吗？我了解 FIRST 的工作原理，但 FOLLOW 很难理解......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T19:47:07.737

看看[维基百科的 FIRST_and_FOLLOW_sets](http://en.wikipedia.org/wiki/Canonical_LR_parser#FIRST_and_FOLLOW_sets) 。

### 关注（E）：

您查找`E`.
在这里`(E)`并联合所有以下终端和以下非终端的 FIRST 集。
这里只有以下终端`)`。

### 关注（女）：

`F`被`FT`,引用`*FT'`。和 的并`FOLLOW(F)`集也是如此。`FIRST(T) = {(, id}*``FIRST(T') = {*, ε}`

最后，`FOLLOW(F) = {(, id, *, ε}`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T18:58:01.497

这里 FOLLOW(F) 是通过这种方式找到的： T-->FT' 表示 FOLLOW(T) 是 FOLLOW(F) 的子集
T'-->*FT' 表示 FIRST(T') 包含 epsilon 然后除了 epsilon 并添加要设置的其他值。

# c# - 将 EnumerableRowCollection 序列化为 JSONResult

> ID：13588703
> 
> 赞同：0
> 
> 时间：2012-11-27T16:30:35.627
> 
> 标签：c#, .net, json, serialization

我有以下应该返回 JSONResult 的方法，因此我可以在带有 javascript 的 AJAX 方法中使用它并为文本框加载自动完成建议。每次特定下拉列表更改时，我都会加载它。

```
[AcceptVerbs(HttpVerbs.Post), Authorize]
    private JsonResult GetSchemaNodeValues(string SchemaNodeId)
    {
        var query = @"Select ld.""Value"" 
        From ""LookupData"" ld, ""SchemaNode"" sn
        Where sn.""LookupTypeId"" = ld.""LookupTypeId""
        And sn.""SchemaNodeId"" = '{0}'";

        DataSet data = new DataSet();

            data = ServiceManager.GenericService.ExecuteQuery(String.Format(query, SchemaNodeId)).Data;

        var res = data.Tables[0].AsEnumerable().Select(dr => new
        {
            Value = dr["Value"].ToString()
        });

        return JsonConvert.SerializeObject(res);

    } 
```

我收到以下错误`return JsonConvert.SerializeObject(res);`

```
Error   106 Cannot implicitly convert type 'string' to 'System.Web.Mvc.JsonResult' 
```

有没有办法克服这个问题？

在此之前，我尝试使用 System.Web.mvc.Controller.Json(res); 它从一个对象返回一个 JSONResult。

但我无法使用它，因为我的类是 PageDialog 而不是 Controller，因此它无法访问 Controller 的受保护内部方法，如 JSon()。我得到的错误是 JSon() 由于其保护级别而无法访问。Controller 类已锁定，我无法将其公开或创建解决方法，因此我使用 JsonConvert.SerializeObject(res); 更改了方法；

任何建议都将非常受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:33:58.683

```
private dynamic GetSchemaNodeValues(string SchemaNodeId)
{
    ...
    return data.Tables[0].AsEnumerable().Select(dr => new
    {
        Value = dr["Value"].ToString()
    });
} 
```

或者

```
private string GetSchemaNodeValues(string SchemaNodeId)
{
    ...
    var result = data.Tables[0].AsEnumerable().Select(dr => new
    {
        Value = dr["Value"].ToString()
    });
    return JsonConvert.SerializeObject(result);
} 
```

# jquery - jQuery - 获取图片标题

> ID：13588704
> 
> 赞同：5
> 
> 时间：2012-11-27T16:30:35.630
> 
> 标签：jquery, attr

真的很简单，但我无法解决。

如何通过单击周围来获取下面代码中图像的标题`<a>`

```
$(this,'img').attr('title'); 
```

```
<ul>
    <li><a href="01.jpg"><img src="01_th.jpg" title="image_1" /></a></li>
    <li><a href="02.jpg"><img src="02_th.jpg" title="image_2" /></a></li>
    <li><a href="03.jpg"><img src="03_th.jpg" title="image_3" /></a></li>
</ul> 
```

```
$(function(){
    $('li a').click(function(e) {
        e.preventDefault();
        var img_href = $(this).attr('href');
        var img_title = $(this,'img').attr('title');
        alert(img_title); //undefined.
    });
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T16:33:33.223

您必须将要查找的上下文作为第二个参数：

```
$('img', this).attr('title'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:31:55.720

你可以得到这样的img标题

```
$(this).find('img').attr('title'); 
```

# windows-phone-7 - 证书适用于 IP 但不适用于 URL

> ID：13588710
> 
> 赞同：1
> 
> 时间：2012-11-27T16:31:04.927
> 
> 标签：windows-phone-7, ssl-certificate, ie-mobile

我在使用 IEMobile 9 (WP 7.5) 访问我的网站（在 https 上）时遇到问题。

它说证书有问题，好像它无效。一切都可以在我测试过的任何其他浏览器或平台上运行（android（几部手机和一个带有股票浏览器、firefox、opera、dolphin 的银河选项卡）、iOS（带有 safari 和 chrome 的 iPhone 和 ipad）、带有 symbian 的旧诺基亚、Windows 7、 linux和mac）。

为了解决这个问题，我将证书 (.cer) 保存在服务器上并从手机浏览器访问它。它总是抱怨，除非我通过服务器 IP (192.168.xx.xx) 访问它。那时它（说它）正确安装了证书。如果那时我尝试访问仍然使用 IP 的 index.html 一切正常，它不会抱怨证书。但是，如果我尝试使用实际 URL (blah.myblah.com) 访问索引，它会再次抱怨证书，就好像它没有安装一样！

这不是 DNS 的问题，因为它已启动并提供正确的 ip，并且手机已正确设置以使用它。

该证书由 geotrust/rapidssl 为 *.myblah.com 签名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:34:33.507

这很正常。证书颁发给特定的主机+域名。基本上，SSL 的验证码会有类似

```
if (requested host name != certificate issued hostname) {
    issue security alert
} 
```

所以你在做

```
if (192.168.xx.xx != example.com) { 
```

并获得安全警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-08T11:41:24.990

我遇到了与某些 HTTP over TLS 实现如何查找 SubjectAltName(SAN) 相关的证书问题。[RFC2818](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)指出，如果主机名是 DNS 条目，则实现必须根据 subjectAltName 扩展数组检查主机名，以查找与主机匹配的 DNS 条目。如果没有使用 subjectAltName CommonName。如果主机名是 IP，则证书必须包含与 IP 匹配的 subjectAltName IP 条目。另请注意，较新的证书不鼓励通配符证书[RFC6125](https://www.rfc-editor.org/rfc/rfc6125#section-7.2)不鼓励通配符证书，因此可能 windows phone 已经强制执行此操作，尽管我可能错了。

我的第一步是检查证书的 SAN 部分，并确保它具有与您的站点主机匹配的 DNS 条目。

# ruby - 如何扫描字符串以查找精确的关键字匹配？

> ID：13588712
> 
> 赞同：0
> 
> 时间：2012-11-27T16:31:07.170
> 
> 标签：ruby, ruby-on-rails-3, scanf

我正在扫描不同项目的名称和描述，以查看是否有任何关键字匹配。

在下面的代码中，它将返回诸如“googler”或“applecobbler”之类的内容，而我想要做的只是获得完全匹配：

```
[name, description].join(" ").downcase.scan(/apple|microsoft|google/) 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T16:35:32.057

我的正则表达式技能很弱，但我认为您需要使用单词边界：

```
[name, description].join(" ").downcase.scan(/\b(apple|microsoft|google)\b/) 
```

[红字样例](http://rubular.com/r/D2gm1vtTbu)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T17:43:06.097

取决于您想要什么信息，但如果您只想要完全匹配，则比较部分不需要正则表达式。只需比较相关的字符串。

```
splitted_strings = [name, description].join(" ").downcase.split(/\b/)

splitted_strings & %w[apple microsoft google]
# => the words that match given in the order of appearance 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:36:38.960

`\b`在您的正则表达式 ( )中添加适当的边界实体。也可以使用`#grep`方法。而不是加入：

```
array.grep(your_regexp) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T17:25:20.380

看看这个问题，以及我想做这些事情的情况，这就是我要为一个实际程序做的事情，我有来源列表及其相关文本，并且想知道点击率，我会可能会这样写：

```
require 'pp'

names = ['From: Apple', 'From: Microsoft', 'From: Google.com']
descriptions = [
  '"an apple a day..."',
  'Microsoft Excel flight simulator... according to Microsoft',
  'Searches of Google revealed multiple hits for "google"'
]
targets = %w[apple microsoft google]
regex = /\b(?:#{ Regexp.union(targets).source })\b/i

names.zip(descriptions) do |n,d|
  name_hits, description_hits = [n, d].map{ |s| s.scan(regex) }
  pp [name_hits, description_hits]
end 
```

哪个输出：

```
[["Apple"], ["apple"]]
[["Microsoft"], ["Microsoft", "Microsoft"]]
[["Google"], ["Google", "google"]] 
```

这会让我知道单词的字母大小写，所以我可以尝试将苹果水果与 Apple the company 区分开来，并获得字数，帮助显示文本的相关性。

`regex`看起来像：

```
/\b(?:apple|microsoft|google)\b/i 
```

它不区分大小写，但`scan`会以原始大小写返回单词。

`names`，`descriptions`并且`targets`都可能来自数据库或单独的文件，有助于将数据与代码分开，并且需要在目标更改时修改代码。我会使用目标词列表并使用 Regexp.union 来快速构建模式。

# printing - 如何在批处理文件中将打印机有效访问代码添加到打印机？

> ID：13588716
> 
> 赞同：1
> 
> 时间：2012-11-27T16:31:14.320
> 
> 标签：printing, batch-file, vbscript, printers

到目前为止我有这个：

```
Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prnport.vbs -a -r IP_192.168.1.78 -h 192.168.1.78
Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prndrvr.vbs -a -m "RICOH Aficio MP C5501 PCL 6" -h %CD% -i %CD%\OEMSETUP.INF
pause
Cscript %WINDIR%\System32\Printing_Admin_Scripts\en-US\Prnmngr.vbs -a -p "Ricoh Aficio MP C5501" -m "RICOH Aficio MP C5501 PCL 6" -r IP_192.168.1.78
pause 
```

暂停只是为了让我确保一切正常。问题是，打印机具有这些有效的访问代码之一。我正在尝试自动化整个过程，但我无法添加有效的访问代码。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:07:48.770

弄清楚了！

因此，您需要做的是从已经设置好的打印机中导出打印机设置。

```
rundll32 printui.dll,PrintUIEntry /Ss /n "Ricoh Aficio MP C5501" /a "settings.dat"
rundll32 printui.dll,PrintUIEntry /Sr /n "Ricoh Aficio MP C5501" /a "settings.dat" 
```

所以我在设置打印机后运行了第一行。它给了我 .dat 文件。我可以在这个办公室的所有打印机上使用该文件。我只是将第二行附加到上面代码的末尾，瞧！有用！

# c# - 如何使用 ServiceStack.Text JsonSerializer 将数据从文件反序列化到自定义类？

> ID：13588717
> 
> 赞同：1
> 
> 时间：2012-11-27T16:31:18.560
> 
> 标签：c#, json, servicestack

我有以下结构的学生班：

```
 public class Student
    {
       public int StudentId {get;set;}
       public string StudentName {get;set;}
       public string[] Courses {get;set;}
    } 
```

我有一个 student.json 文件，它保存了 Student 类的数据，如下所示：

```
 public void SaveStudentData(Student stud, string path)   //stud is an object of student class that has student information
    {
        string studinfo = JsonSerializer.SerializeToString<Student>(stud);
        StreamWriter sw = File.OpenText(path);
        sw.Write(studinfo);

    } 
```

但是，当我尝试使用以下代码检索数据时：

```
 public Student GetStudentData(string path)
    {
       StreamReader sr = File.OpenText(path);
       string stud = sr.ReadToEnd();
       sr.Close();
       Student studinfo =JsonSerializer.SerializeToString<Student>(stud);
       return studinfo;

    } 
```

线

```
 Student studinfo =JsonSerializer.SerializeToString<Student>(stud); 
```

VS 2012 突出显示它无法将字符串类型转换为学生类型。我想将 json 数据从文件转换为学生类。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:29:39.970

看完[这里](https://github.com/ServiceStack/ServiceStack.Text)

我建议您通过调用

```
T JsonSerializer.DeserializeFromString<T>(string value) 
```

方法，而不是与`SerializeToString<T>`您想要的相反的方法。所以非一般，

```
Student studinfo = JsonSerializer.DeserializeFromString<Student>(stud); 
```

* * *

正如@mythz 所评论的那样，由于您是`using`程序`ServiceStack.Text`集，因此您可以只使用`T.ToJson()`or扩展名。`string.FromJson<T>()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:54:32.583

您正在使用`SerializeToString`which 从您的早期代码中返回一个`string`类型。也许您应该尝试一种将返回`Student`对象的方法。

我不熟悉您正在使用的库。您可以`DataContractJsonSerializer`像这样使用 来序列化和反序列化对象。

```
 public void Save(Student student, string path)
    {
        FileStream fs = new FileStream(path, FileMode.OpenOrCreate);
        DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(Student));
        ser.WriteObject(fs, student);
        fs.Close();
    }

    public Student Load(string path)
    {
        FileStream fs = new FileStream(path, FileMode.Open);
        DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(Student));
        Student s = (Student)ser.ReadObject(fs);
        fs.Close();
        return s;
    } 
```

学生对象被这样装饰的地方

```
[DataContract]
public class Student
{
    [DataMember]
    public int StudentId { get; set; }
    [DataMember]
    public string StudentName { get; set; }
    [DataMember]
    public string[] Courses { get; set; }
} 
```

# static-analysis - PC-Lint 将标头视为库标头

> ID：13588723
> 
> 赞同：0
> 
> 时间：2012-11-27T16:31:46.767
> 
> 标签：static-analysis, pc-lint

使用 PC-Lint，我试图将头文件视为库头，以便我可以抑制其中的消息。我正在使用库模块选项`+libm(module.c)`，该选项应将 module.c 视为库模块，并将它包含的任何头文件（即 module.h）视为库头文件，如 v9.00 的 PC-Lint 手册第 6.1 节所述。当然，module.h 也包含在我的不是库模块的源文件中。

问题是，当我对代码进行 lint 时，即使我提供了`+libm(module.c)`选项，我仍然会从 module.h 收到消息。我怀疑这是因为 module.h 文件包含在我的其他非库模块中。但是这种情况是一个典型的用例，所以这使得这个`+libm`选项毫无用处。我知道我可以使用`+libh(module.h)`或者`+libdir(...)`但我想`+libm(module.c)`为我正常工作。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T16:33:01.423

手册中没有这样介绍，但我的经验表明，并非库模块包含的所有头文件都被视为库。它们不能是：如果模块包含您自己的头文件，您希望明确处理的头文件怎么办？

使用 Lint 选项`-vf`（注意：大输出！）查看 Lint 如何解释您的头文件。库文件就是这样指定的。可以使用普通`-lib*`选项集添加缺少的那些。

# python - How can I tell if the drop-down list of a `ComboBox` is open?

> ID：13588729
> 
> 赞同：1
> 
> 时间：2012-11-27T16:31:57.530
> 
> 标签：python, user-interface, combobox, wxpython

In wxPython, how can I tell what is the state of the drop-down list of a `ComboBox`, that is, is it open or closed?

I'm trying to implement a `ComboBox` that allows the user to delete a value from the list by opening the drop-down list, selecting an item, and pressing delete (*Edit:* when I say selecting here I mean just highlighting an item, without clicking it yet, so the drop-down list remains open).
I can bind the delete key, and I know how to delete an item, the only problem is the delete key has a different function if the drop-down list is closed (its usual function in the text field), which I want to preserve.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:03:46.487

使用 EVT_COMBOBOX。当用户从列表中选择某些内容时触发。我会将选择存储在实例变量中（如 self.currentSelection）。您可能还想存储以前的选择。然后，当用户按下“删除”时，您可以删除新选择或显示提示询问他们是否真的要删除该项目。

更新：正如评论中提到的，我认为 ComboCtrl 是一个不错的选择。您可以在以下位置找到其用法示例：

*   wxPython 演示包
*   [http://xoomer.virgilio.it/infinity77/wxPython/combo/wx.combo.ComboCtrl.html](http://xoomer.virgilio.it/infinity77/wxPython/combo/wx.combo.ComboCtrl.html)
*   [http://robsworldoftech.blogspot.com/2010/02/wxpython-example-for-wxcomboctrl-with.html](http://robsworldoftech.blogspot.com/2010/02/wxpython-example-for-wxcomboctrl-with.html)

# actionscript-3 - 为什么使用自定义事件而不是直接方法调用？

> ID：13588732
> 
> 赞同：11
> 
> 时间：2012-11-27T16:32:15.317
> 
> 标签：actionscript-3, flash, apache-flex, oop, events

我是编程新手，我一直在检查很多游戏编码教程。我注意到他们中的大多数使用自定义事件来触发方法，而不是直接调用方法。

这种做法背后的原因是什么？他们为什么不只是调用该方法？

例如：

* * *

我们有两个对象：`A`和`B`。`A`有触发条件`A.methodA()`时`B`需要使用的方法。`X`

为什么要实施：

> `B`调度一个`A`告诉`A`运行的事件`A.methodA()`

代替：

> `B`用途`A.methodA()`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-27T17:29:23.203

主要原因是利益分离。使用事件时，A 类不需要知道 B 类的存在（反之亦然）。

这样做的一些好处是：

*   更容易的单元测试（你可以在没有 B 类的情况下测试 A 类）
*   更改 A 类或 B 类时破坏代码的可能性较小
*   减少代码中对其他类的引用，从而减少内存泄漏的可能性
*   更清洁的代码
*   更灵活/可重用的代码（一堆其他类都可以监听/响应事件，而无需在调度程序中添加任何额外代码）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T16:48:26.910

通常在更大的应用程序中，使用事件将有助于抽象一切。当您有 15 个以上的类并且它们都将事件分配给控制器时，与通读代码的所有不同部分以跟踪函数相比，弄清楚发生了什么要容易得多。使用回调开始创建意大利面条代码。

但是，直接函数调用将比事件执行得更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T18:04:32.210

就个人而言，我只是为了方便使用而使用自定义事件。我可以让一个类在发生某些事情时调度一个事件（比如动画完成或下载中发生错误），并且任意数量的其他类基于该事件运行任意数量的其他函数。此外，我为可重用性编写代码。每个类的目标是完全独立，以便它可以在任何项目中运行而无需其他包。因此，我没有让一个类调用另一个类的方法，而是从第一个类调度第二个类监听的事件，然后运行该方法。然后，当我需要另一个项目的第一堂课时，我可以复制/粘贴它而无需修改它，也不会丢失任何功能。

编辑：另外，值得注意的是，有时人们会按照您的描述来绕过必须传递事件参数。

假设您在舞台上有一个按钮，您需要能够单击它，但您还需要能够手动调用该方法。有些人没有意识到你可以传入一个空事件并且只有一个方法。或者您可以将其设置为 null 默认参数，见下文：

```
private function onClickHandler( e:MouseEvent = null ):void{
    //as long as you never reference "e" within this method, this method can be used both for MouseEvent listeners and manually calling it elsewhere in the code
} 
```

该技术可以帮助避免事件处理程序只调用另一个方法而不调用其他方法。在我的编程中，我编写的每个 AS3 事件处理程序都默认将事件参数设置为 null。它只是让以后的事情变得更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T19:15:18.120

[你可能想读这个。](http://help.adobe.com/en_US/as3/mobile/WS948100b6829bd5a6d20da321260fed8a52-8000.html)

还要注意使用回调方法允许您直接将参数传递给它，而不是通过自定义事件模型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-18T20:47:52.377

我构建了自己的、非常简化的事件调度系统。AS Event 模型非常强大，但在 99% 的情况下您不需要这种功能。带有作为事件触发的参数的简单回调就足够了。您仍然可以保留事件模型的多功能性，但不需要为一个简单的按钮编写太多代码行。我可以像这样设置一个简单的事件：

```
Buttonizer.autoButton(_buttQuit, this, "onPress");
public function onPressQuit(c:Sprite) {
// Execution goes here
} 
```

你可以建立自己的事件模型，它会让生活更简单，你的代码也更简洁。

# javascript - 在分配中使用 javascript 无效的左侧更新 z-index

> ID：13588733
> 
> 赞同：3
> 
> 时间：2012-11-27T16:32:16.593
> 
> 标签：javascript, html, css, z-index

我在使用 Javascript 时遇到问题。几乎可以肯定我做错了什么，因为我对 js 很陌生。我正在尝试将 div 标签的 z-index 从 -1 修改为 1，以便其中包含的图像出现在其他图像的前面，但继续将“分配中无效的左侧”作为错误。我试过在网上搜索，但找不到解决方案，可能是因为我犯了一个基本错误。我的代码片段如下：

## JavaScript：

```
function bubble1()
{       
    document.getElementById("img-bubble1").style.z-index = "1";//this is the line it crashes on     
    bubble2move = setInterval(function() {bubble2()}, 2000);
} 
```

## html:

```
<td width="50%">
    <div class='image-window'>
        <div id="img-bubble1" class='img img-bubble hide'><img src="../img/img-bubble1.gif"/></div>
        <div id="img-bubble2" class='img img-bubble hide'><img src="../img/img-bubble2.gif"/></div>             
    </div>
</td> 
```

## CSS：

```
.image-window
{
    width: 435px;
    height: 400px;
    float: left;
    position: relative;
    overflow: hidden;
    padding: 0;
    margin: 0;
}

#img-bubble1, #img-bubble2
{
    position: absolute;
    z-index: -1;
}

.img-bubble
{
    width: 206.25px;
    height: 400px;
    position: absolute;
    top: 0;
    right: 0;
} 
```

在此先感谢，再次为我的经验不足感到抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:33:49.547

在 javascript 中处理 CSS 属性时，任何带有连字符的内容都会转换为驼峰式大小写。试试这个：

```
document.getElementById("img-bubble1").style.zIndex = "1"; 
```

[相关问答](https://stackoverflow.com/a/2119641/386152)

编辑：后人的附加信息，正如 khanahk 在评论中所说，变量名中的连字符将被解释为减号，这不是有效的赋值语法。一个有趣**且不推荐**的解决方法是使用括号表示法：

```
document.getElementById("img-bubble1").style["z-index"] = "1"; 
```

# encryption - How do I view PFX file information in a visual manner?

> ID：13588740
> 
> 赞同：20
> 
> 时间：2012-11-27T16:32:36.880
> 
> 标签：encryption, certificate, pfx

I have a PFX file on my drive. I want to see the certificate chain for it. How do I see this? I am asking for a visual tool since I'm sure this won't be the last time I need to view certificate information, and I know of no tool that does this...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-11-05T17:27:14.593

```
certutil -dump filename.pfx 
```

微软文档：[http ://technet.microsoft.com/library/cc732443.aspx](http://technet.microsoft.com/library/cc732443.aspx)

虽然这是针对 Win 8 或 Server 2012。我的开发机器上有 Win 7 - 不确定该程序是默认存在还是随 Visual Studio 一起提供。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-31T02:36:01.893

下面在cmd中也可以正常工作：

> openssl pkcs12 -info -in**证书路径**

有关更多信息，请查看以下链接：

[https://superuser.com/questions/580697/how-do-i-view-the-contents-of-a-pfx-file-on-windows/1212800](https://superuser.com/questions/580697/how-do-i-view-the-contents-of-a-pfx-file-on-windows/1212800)

[https://www.sslshopper.com/article-most-common-openssl-commands.html](https://www.sslshopper.com/article-most-common-openssl-commands.html)

如果遇到 openssl 问题，意味着如果未安装，请下载 openssl 并在 bin 中引用 openssl.exe 的路径而不是 openssl。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:20:47.300

我认为这个问题更适合[superuser](https://superuser.com/)。PFX 文件只是一个 pkcs12 文件，可以使用[openssl pkcs12实用程序对其进行解析。](http://www.openssl.org/docs/apps/pkcs12.html)试验选项以获得您正在寻找的输出。

# iphone - Rails 3：如果在 iPhone 上打开电子邮件，呈现方式会有所不同？

> ID：13588742
> 
> 赞同：0
> 
> 时间：2012-11-27T16:32:45.413
> 
> 标签：iphone, ruby-on-rails, ruby-on-rails-3, rendering

我有一封在标准机器上完美呈现的电子邮件。但是，当用户在他们的 iPhone 上打开电子邮件时，会出现一个灰色框，它会突然变大并占用比正常情况更多的空间。有没有我可以使用的 hack 来让我的 html.erb 页面识别它是否在 iphone 中呈现并相应地调整自己？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:37:05.480

它基本上是您通常必须修改的 CSS。

按照[此链接](http://www.campaignmonitor.com/css/)显示 iphone 设备支持哪些样式等，哪些不支持..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T11:04:34.927

为了获取用户的浏览器信息，有一个很酷的 gem，叫做`Browser`. 我强烈建议你在 Github 上查看[它的 repo](https://github.com/fnando/browser)。

一旦你安装了这个 gem，

```
browser.mobile? 
```

会给你`true`or`false`并且你可以根据答案做任何你想做的事情。

# javascript - Uncaught SyntaxError: Unexpected token :

> ID：13588747
> 
> 赞同：0
> 
> 时间：2012-11-27T16:32:53.817
> 
> 标签：javascript

为什么 `<script> {'foo':'bar'}</script>` 导致**Uncaught SyntaxError: Unexpected token :** at chrome

很好`<script> {foo:'bar'}</script>`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T16:35:58.187

因为它不是对象文字，所以它是一个代码块。括号内的内容不会被解析为键值对，而是被解析为代码。

`foo: 'bar'`就像代码一样好，`foo:`标签也好，`'bar'`表达式也好。

`'foo':`不行，因为作为标签的代码不能是字符串，它必须是标识符。

要使其成为对象文字，您必须使其成为表达式，例如：

```
<script> var x = {'foo':'bar'}</script> 
```

或者：

```
<script> ({'foo':'bar'})</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:36:53.327

请注意，这不是[JSON](http://json.org/)，您需要在其中使用双引号 ( `"`)。

当您将此对象文字直接放入`<script>`元素中时，它不会被解析为[表达式](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Expressions_and_Operators)（它将是一个有效的对象）。相反，大括号被解析为[块](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/block) [语句](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Statements)，并被`foo:`解析为[标签](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/label)。`'foo'`将是一个无效的标签，因此是语法错误。

# javascript - 使用 jquery 禁用提交按钮的问题

> ID：13588750
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:32:56.483
> 
> 标签：javascript, jquery

我正在迭代一个列表，并在文本框中显示它的值。有两个带有名称`checkquantity`&的文本框，`quantity`我正在从列表中迭代它们的值。

现在用户必须输入数量值，如果他们输入的数量值多于分配的数量。然后我必须禁用提交按钮。

*这是我的问题：* 从我下面的代码中，提交按钮仅是第一次禁用。即，如果我第一次输入无效值，那么我的代码工作正常，但如果我再次在另一个文本框中输入有效值，那么我的按钮将启用。但它不应该启用，因为在第一个文本框中输入了无效值。

**注意：**用户只能在文本框名称中输入值，`quantity`并且该文本框将从文本框进行验证`checkquantity`。

请检查我的以下代码并为此建议我一个解决方案。

```
$('input[name="quantity"]').keyup(function() {
    var $tr = $(this).closest("tr");
    var q = +$tr.find('input[name^="quantity"]').val();
    var cq = +$tr.find('input[name^="checkquantity"]').val();

    if (q > cq) {
        $('#submtbtnId').attr('disabled', 'disabled');
    }
    else {
        $('#submtbtnId').removeAttr('disabled');
    }
});
----------------------------------- in
while loop my list is iterating 
{ 
  <tr> 
    <td width = "10%"> 
      <input type = "text" name = "quantity"values = "" id = "quantity" / >   
      <input type = "text" name = "checkquantity" disable = "disable"
          values = "random values coming from my list   
                 eg. 5 or 9 ..." / > < /td>   
  </tr >
}

------------------------- 
 < input type = "submit" id = "submtbtnId" / >​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:49:37.653

如果每次在 keyup 事件中都是这种情况，请通过迭代它们来检查所有文本框..

**更新**

看起来问题出在名为**values**的属性上。如果您尝试使用它来访问该值，`.val()`那么它应该是**value**。

添加了`return false;`条件以确保它在条件失败时退出循环。

**其次**还有一个问题..假设输入**为空**..所以当您将其转换为数字时，它是**0**并且**比较总是失败..**

因此，如果该字段不为空，我添加了一个检查条件，然后才转换为数字

```
$('input[name="quantity"]').on('keyup', function() {
    var check = false;
    $('tbody tr').each(function() {
        var $tr = $(this);
        var q = $tr.find('input[name^="quantity"]').val();
        if(q != ''){
            q = +q;
        }
        var cq = +$tr.find('input[name^="checkquantity"]').val();
        if (q !== '' && q > cq) {
            check = true;
            return false;
        }
    });

    if (check) {
        $('#submtbtnId').prop('disabled', true);
    }
    else {
        $('#submtbtnId').removeAttr('disabled');
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/egZxQ/4/)**

# security - 安全的客户端服务器通道

> ID：13588753
> 
> 赞同：0
> 
> 时间：2012-11-27T16:33:07.357
> 
> 标签：security, ws-security

我正在构建一个需要在客户端和服务器之间建立安全连接并提供 Web 服务的应用程序。我需要保证（客户端和服务器）的真实性，服务器还将处理客户端授权以访问数据和文件。如果考虑使用类似 EKE 的算法对两者进行身份验证，但这些都依赖于先前共享的秘密。

我可以使用客户端密码作为共享密钥，但我需要在客户端注册时安全地建立该密码，在这种情况下，我需要一个安全通道，并对服务器进行身份验证（客户端需要知道他是哪个服务器注册到）。

我宁愿避免使用 CA 来提供带有服务器公钥的证书，因为它只是一项小工作的大量额外代码，而且它不是最好的解决方案，因为我只需要信任 CA。

最终这是让客户端将（客户端）加密的文件发送到服务器并共享它们。

我错过了任何替代方案吗？

Tl;博士如何建立安全的客户端/服务器通道、验证服务器、无需 CA、知道公钥或以前的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:09:24.537

SSL/TLS 提供了广泛的身份验证机制选择，包括预共享密钥、OpenPGP 密钥等。因此您可以选择 SSL 并避免重新发明轮子。

您还可以对单个数据消息进行签名和加密（再次使用 OpenPGP 作为变体）。

# php - Undefined when trying to access array created from JSON data

> ID：13588757
> 
> 赞同：0
> 
> 时间：2012-11-27T16:33:12.130
> 
> 标签：php, javascript, jquery, json

I have been playing with JSON/PHP/JS today and I am having problems..

My PHP works fine which gets a row of data from my SQL table then encodes as JSON. My JS/Jquery file loads the data from the PHP file fine using $.getJSON.

However, when i try and use the data later in the page like so: gender = user['player'].gender, I get user.player is undefined.

This is my code that is relevant:

```
function getUserInfo() {
    var url = "./php/getUserInfo.php";
    $.getJSON(url, function(data) {
        $.each(data.members, function(i, dat) {

            user['player'] = {
                gender: dat.gender,
                fname: dat.first_name,
                lname: dat.last_name,
                username: dat.username,
            };
        });
    });
}

user = {};
getUserInfo();

//Displays an object, which has the correct information I want.
console.log(user);
var gender = user['player'].gender;
console.log(gender);​ 
```

the last line of code gives me the error that user.playe is not defined. but it should display male Help would be helpful, I have tried many things to fix this but cant seem to do so.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:35:44.073

`$.getJSON` 是**异步**的。

发送请求后，它会立即转到下一行，并且不会等待请求完成。

因此，当您尝试访问变量时，它仍然不可用..

尝试将那段代码放在后面`$.each`，它应该可以工作。

# c# - 为什么我要使用仅限于单一类型的 where 约束？

> ID：13588759
> 
> 赞同：3
> 
> 时间：2012-11-27T16:33:24.347
> 
> 标签：c#

所以我在这里查看了 MSDN 示例：[类型参数的约束（C# 编程指南）](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.100%29.aspx)，第一个示例显示了以下泛型类，它定义了`where`具有单个具体类型的约束：`Employee`

```
public class GenericList<T> where T : Employee 
```

现在，当使用`where`约束时，我完全理解定义 > 1 类型时的用法，*或者*最肯定的是使用接口时的用法。但是（我知道这只是一个示例），为什么我只想使用`where`约束来限制单个具体类型？我不能只替换下面的代码：

```
public T FindFirstOccurrence(string s) 
```

有以下因为无论如何只有一个*约束*？

```
public Employee FindFirstOccurrence(string s) 
```

我可以看到使用单个约束部署代码的唯一原因`where`是为了在未来灵活地为 if become 添加额外的约束，`Employee`并且`IEmployee`我为更改设置得更容易一些。

有人可以解释使用`where`单一类型的约束提供什么目的吗？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T16:34:43.323

> 为什么我只想使用 where 约束来限制单个具体类型？

不完全正确 - 约束在`Employee`类型和从它继承的任何类型上，因此它也可以应用于`Manager`和`CEO`类。

定义约束意味着您可以`Employee`在代码中的类型上使用任何可访问的方法，无论传入的类型是`Employee`继承类型还是继承类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:49:29.440

这是您在流畅界面中看到的常见模式。考虑以下示例代码：

```
public class Employee {}
public class Manager : Employee{}

public static T Method<T>(T employee) where T : Employee
{
    //do some stuff with the employee
    return employee;
} 
```

现在在调用该方法时，我们可以这样做：

```
Employee employee = new Employee();
employee = Method(employee);

Manager manager = new Manager();
manager = Method(manager); 
```

如果我们只返回一个`Employee`而不是`T`第二个方法调用将返回一个`Employee`，但这里它*返回一个* `Manager`。我们避免向上转换类型，同时仍然保持静态类型。在其他情况下它也很有用，但基本原则是泛型的常见用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:39:24.000

T 类型是通用类型，正如您所说，它可能是接口或基类。这意味着，除了灵活性和其他类似的东西之外，您还可以插入其他实现/扩展接口/基类的类。所以类型 T 实际上可能意味着多个类。

假设 T 是一个基类`Shape`so`Square`和extend 。当您有约束时，您实际上可以注入 or , , or并且它们中的每一个都有自己的实现。`Rectangle``Triangle``T``T``Square``Rectangle``Triangle`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T16:44:42.333

目的是让编译器知道可以在通用实现中使用哪些方法/属性签名。

考虑一下：

```
public class Employee{
     public string Name{get;set;}
     public double Salary{get;set;}
}

public class Manager : Employee{
    public List<Employee> Manages{get;set;}
}

public class PayrollList<T> : List<T> where T:Employee{
    public void SendOutPeriodPay(){
    // Note that employee.Name and .Salary are accessible 
    // even if the list is of Manager type
        this.ForEach(employee=>PaySystem.SendPay(employee.Name,employee.Salary));
  }
} 
```

# java - JLabel 不显示

> ID：13588764
> 
> 赞同：0
> 
> 时间：2012-11-27T16:33:45.757
> 
> 标签：java, swing, jpanel, jlabel, paintcomponent

我正在完成一场比赛，我已经达到了让我非常沮丧的地步。这可能是一个简单的修复，我忽略了一些东西，所以也许你们可以帮助我。我试图让一系列 5 个 JLabel 以游戏中的 5 个高分出现在屏幕上。但是，它一直显示在背景中，没有标签。以下是我的代码：

```
import java.awt.Graphics;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class EndPanel extends JPanel{

   GameGUI gui;
   JLabel[] array;

   public EndPanel(GameGUI gui) {
       super();
       this.gui = gui;
       array = new JLabel[5];
       for(JLabel i : array) {
          i = new JLabel("");
          i.setVisible(true);
          this.add(i);
       }
       int i = 0;
       for(HighScore h: gui.getGameDriver().getHighScores()) {
          System.out.println(gui.getGameDriver().getHighScores());
          array[i].setText(h.toString());
          i++;
       }

    }

    public void paint(Graphics g) {
       super.paint(g);
       g.drawImage(gui.images.get(32), 0, 0, this);
       g.drawImage(gui.images.get(31), 112, 100, this);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:42:58.530

数组的初始化非常可疑。代替：

```
 for(JLabel i : array) {
      i = new JLabel("");
      i.setVisible(true);
      this.add(i);
   } 
```

尝试：

```
 for (int i = 0; i < array.length; i++) {
      array[i] = new JLabel("");
      array[i].setVisible(true);
      add(array[i]);
   } 
```

未经测试，因为您的代码无法编译。

[编辑] 实际上，您不需要创建 JLabel 数组，因为您将它们丢弃（数组在方法结束时超出范围）。您可以即时创建标签：

```
 for (HighScore h : gui.getGameDriver().getHighScores()) {
      System.out.println(gui.getGameDriver().getHighScores());
      JLabel label = new JLabel(h.toString());
      add(label);
   } 
```

您仍然需要使用布局管理器或绝对位置来设置这些标签的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:42:34.657

不要使用`for each`循环尝试使用常规`for`循环，如下所示：

```
JLabel [] label = new JLabel[5];
    for(int i = 0; i<5;i++){
        label[i] = new JLabel("Label number: " +i);
        panel.add(label[i]);
    } 
```

这应该有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:41:49.950

由于您不使用布局管理器，因此您自己设置了标签位置和大小。否则我猜你所有的标签都有 size=0 并且位于点 0,0。

顺便说一句，您是否有特殊的理由不使用布局管理器，或者您只是不知道它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:39:35.093

尝试在`Jlabel`高分循环内移动初始化代码：

```
 int i = 0;
   for(HighScore h: gui.getGameDriver().getHighScores()) {
      System.out.println(gui.getGameDriver().getHighScores());
      array[i] = new JLabel(h.toString());
      this.add(array[i]);
      i++;
   } 
```

# linq - 通配符搜索

> ID：13588766
> 
> 赞同：2
> 
> 时间：2012-11-27T16:33:49.063
> 
> 标签：linq, silverlight, .net-4.0, linq-to-entities

我有以下要在 IQueryable 数据源中查找的值。

用户可以在我的 Silverlight 应用程序的文本框中键入值以过滤结果，然后这些输入将被过滤并发送到我的域服务。

“*”是用户可以输入的内容来进行通配符搜索，例如，返回“TYPE”以“P32”开头的所有值。

```
List<string> params = new List<string>() { "P32*", "P4552", "P2311" }; 
```

然后我将此列表传递给我的域服务代码中的一个函数：

```
IQueryable<MyClass> temp = this.ObjectContext.MyClass.AsQueryable();
temp = temp.Where(c => params.Contains(c.TYPE)); 
```

这是我在实现通配符搜索之前所做的。最干净的方法是什么？我在想我必须在我的参数列表中循环并尝试在每个字符串上包含（在更多的字符串操作之后），但这种方式感觉很不干净

```
foreach (string x in params)
{
    //look for * wildcard... do some other stuff 
    temp = temp.Where(c=>c.TYPE.Contains(x));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:57:41.447

为此，您需要完全定义通配符的工作方式。完成后，您只需填写以下函数的空白：

```
public static class WildcardExtensions
{
    public static bool WildcardContains(this IEnumerable<string> patterns, string value)
    {
        return patterns.Any(pattern => MatchesWildcard(pattern, value));
    }

    private static bool MatchesWildcard(string pattern, string value)
    {
        // implement your pattern matching logic here
    }
} 
```

然后你的代码改变了一点：

```
temp = temp.Where(c => params.WildcardContains(c.TYPE)); 
```

# json - NSDictionary 删除空值。从 JSON 提要创建

> ID：13588772
> 
> 赞同：1
> 
> 时间：2012-11-27T16:34:14.453
> 
> 标签：json, null, nsmutablearray, nsdictionary

我的 NSDictionaries 中的几个数组中有空值，所以我试图遍历它们并删除所有空值。这是我的尝试。

```
 dict = [dict dictionaryByReplacingNullsWithStrings];
    NSMutableDictionary *mdict = [dict mutableCopy];
    NSArray *clubs = [dict objectForKey:@"clubs"];
    NSArray *badges = [dict objectForKey:@"badges"];
    NSMutableArray *newBadges = [badges mutableCopy];
    NSMutableArray *newClubs = [clubs mutableCopy];

    for(int i = 0; i < [clubs count]-1; i++){
        NSDictionary *theclub = [clubs objectAtIndex:i];
        theclub = [theclub dictionaryByReplacingNullsWithStrings];
        newClubs = [newClubs addObject:theclub];
    }

    for(int i = 0; i < [badges count]-1; i++){
        NSDictionary *thebadge = [clubs objectAtIndex:i];
        thebadge = [thebadge dictionaryByReplacingNullsWithStrings];
        newBadges = [newBadges addObject:thebadge];
    }
    [mdict removeObjectForKey:@"badges"];
    [mdict removeObjectForKey:@"clubs"];

    NSLog(@"new Badges %@", newBadges);

    [mdict setObject:newBadges forKey:@"badges"];
    [mdict setObject:newClubs forKey:@"clubs"]; 
```

问题是我在代码中的两行出现错误：

```
 newClubs = [newClubs addObject:theclub]; 
```

和线

```
 newBadges = [newBadges addObject:thebadge]; 
```

都在两个 for 循环中。

错误如下：

```
**Assigning to 'NSMutableArray* __strong' from incompatible type void.** 
```

我创建此 NSDictionary 的 JSON 提要如下：

```
{
"id":249,
"email":"email@gmail.com",
"full_name":"Some one",
"statement":"Lets kick some robot but. ",
"avatar_url":"http://www.somesite.com/logo.png",
"clubs":
    [{"id":31,"name":"Nintendo Games Club","logo_url":"http://www.somesite.com/logo.png","role_in_club":"Admin","level":{"id":23,"name":"Handicap","position":1,"image_url":"http://www.somesite.com/logo.png","code":"","weeks_to_achieve":1,"times_to_achieve":1,"club_type":{"id":13,"type_name":"Golf","token_criteria":false}}}],

"badges":
   [{"id":29,"name":"Nearest the pin","description":"","image_url":"http://www.somesite.com/logo.png","club_id":null},{"id":28,"name":"Longest Drive","description":"","image_url":"http://www.somesite.com/logo.png","club_id":null}]

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T11:13:43.277

我已经修改了你的代码。你犯了两个我在评论中提到的错误

```
dict = [dict dictionaryByReplacingNullsWithStrings];
NSMutableDictionary *mdict = [dict mutableCopy];
NSArray *clubs = [dict objectForKey:@"clubs"];
NSArray *badges = [dict objectForKey:@"badges"];
// You should make fresh arrays as you're going to copy all the memebers again in them.
NSMutableArray *newBadges = [NSMutableArray array];
NSMutableArray *newClubs = [NSMutableArray array];

for(int i = 0; i < [clubs count]-1; i++){
    NSDictionary *theclub = [clubs objectAtIndex:i];
    theclub = [theclub dictionaryByReplacingNullsWithStrings];
    [newClubs addObject:theclub]; // this line adds object in your array and returns void. see documentation
}

for(int i = 0; i < [badges count]-1; i++){
    NSDictionary *thebadge = [clubs objectAtIndex:i];
    thebadge = [thebadge dictionaryByReplacingNullsWithStrings];
    [newBadges addObject:thebadge];
}
[mdict removeObjectForKey:@"badges"];
[mdict removeObjectForKey:@"clubs"];

NSLog(@"new Badges %@", newBadges);

[mdict setObject:newBadges forKey:@"badges"];
[mdict setObject:newClubs forKey:@"clubs"]; 
```

# c# - 算术运算不起作用

> ID：13588779
> 
> 赞同：1
> 
> 时间：2012-11-27T16:34:33.480
> 
> 标签：c#, .net

```
 float percentrelation = Individualrelatonshipdegree / relationshipdegree * 100; 
```

这个简单的操作返回0，而Individualrelationshipdegree变量的值是19，relationshipdegree是35。但它仍然返回0。不明白这个问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:35:56.963

You are doing integer division. try

```
float percentrelation = 
    1.0f * Individualrelatonshipdegree / relationshipdegree * 100; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T16:38:37.870

只看计算顺序。您想将 19 除以 35。所以它是 0。然后将 0 和 100 相乘。它也是 0。
所以您可以尝试通过类型转换使该表达式的第一个变量浮动：

```
float percentrelation = (float)Individualrelatonshipdegree / relationshipdegree * 100; 
```

**UPD**需要解释类型转换的时刻。计算顺序是从左到右。我们有一个规则，在使用整数（int、byte、long long 等）和 float（float、double 等）操作数时，它们都被强制转换为浮点类型。这就是为什么我们只需要在第一个操作数上进行一次类型转换。这就是为什么 1.0f * 的另一个答案`your expression`也可以正常工作的原因。只是两种不同的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T16:36:09.553

Are the two variables integers? If yes, you might want to cast them first.

```
float percentrelation = (float) Individualrelatonshipdegree / (float) relationshipdegree * 100; 
```

Also, note that float is not very precise. Consider using decimal isntead.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:39:42.413

看看[float（C# 参考）](http://msdn.microsoft.com/en-us/library/b1e65aza.aspx)

基本上你不见了`.F`

例如。`float x = 2.5F/3.5;`

# highcharts - 使用日期缩放时更改 x 轴标签

> ID：13588785
> 
> 赞同：1
> 
> 时间：2012-11-27T16:34:51.607
> 
> 标签：highcharts

我有一个包含许多数据的图表，更准确地说是每天存储的大量数据（这对用户来说看起来不太好，标签太多）。

更准确地说，数据以这种方式存储在数据库中：日期（格式为 YYYY - MM - DD）- 数据。

我想做的是使用 x 轴标签（例如）进行几周的默认缩放（包含大量数据），但有一次用户放大它会自动更改为几天。

任何人都知道我该怎么做？

也许这是一个好的开始：

```
xAxis: {
    type: 'datetime',
    dateTimeLabelFormats: {
        day: '%e of %b'   
    }
},

series: [{
    data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
    pointStart: Date.UTC(2010, 0, 1),
    pointInterval: 24 * 3600 * 1000 // one day
}] 
```

在这里找到：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/datetimelabelformats/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/datetimelabelformats/)

**编辑**

我想展示的是，例如，当有周“缩放”时的平均值，当用户放大（在天视图中）时，有准时值。仅使用一个系列（因为此图上有多个系列）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T04:47:31.833

我认为你最好的选择是从 Highcharts 网站上的[时间序列演示](http://www.highcharts.com/demo/line-time-series)开始工作，因为它涵盖了时间序列数据和可缩放数据，而不会用太多标签使图表超载。

**编辑：**
针对提供的其他详细信息，我不认为 highcharts 旨在在放大/缩小时显示不同的数据。它只会按原样显示可用数据。

如果您希望能够在缩放时调整该数据的视图，我的建议是：

*   [`selection`为事件](http://api.highcharts.com/highcharts#chart.events.selection)添加一个监听器；
    *   创建一个新的临时系列，隐藏旧系列并显示新系列；
    *   通过重新计算值来更改现有系列
*   对平均数据有一个单独的系列，并有一种在完整数据和平均数据之间切换的方法。

这不是您正在寻找的答案，但我不相信有任何其他方法可以完成您想要的。

# java - JFrame与后台运行的图像/程序具有相同的形状

> ID：13588786
> 
> 赞同：3
> 
> 时间：2012-11-27T16:34:53.090
> 
> 标签：java, image, swing, jframe, shape

我的问题很简单，解决方案肯定不是。我正在寻找一种将 JFrame 塑造成与它将显示的图像相同的方法。形状是指具有 alpha != 0 的像素的形状。我已经找到了一个使用 GeneralPath 对象的工作示例，但它为大约 500*400 的图像创建了约 110000 个“节点”，因此开始JFrame花了2多分钟，这绝对不是想要的效果，启动应该在2秒以内。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T23:02:41.547

我个人会放弃窗口形状，转而使用透明窗口，这对你想要做的事情来说更简单......

![在此处输入图像描述](../Images/6ff7d17313a50884c938ac3ee8ab2409.png)

并使用关闭按钮（查看左下角）

![在此处输入图像描述](../Images/afe2915df6dd18d99ee252276a852929.png)

图像周围的红色边框是故意的，因为它显示了“窗口”边界。

这依赖于 Java 1.7 或 Java 1.6_10+，代码中有检查。

```
public class TransparentFrame {

    public static void main(String[] args) {
        new TransparentFrame();
    }

    public TransparentFrame() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setUndecorated(true);
                frame.setContentPane(new ContentPane());

                String version = System.getProperty("java.version");
                System.out.println(version);
                if (version.startsWith("1.7")) {
                    frame.setBackground(new Color(0, 0, 0, 0));
                } else if (version.startsWith("1.6")) {
                    if (supportsPerAlphaPixel()) {
                        setOpaque(frame, false);
                    } else {
                        System.out.println("Per Pixel Alphering is not support with Java " + version);
                        System.exit(1);
                    }
                } else {
                    System.out.println("Per Pixel Alphering is not support with Java " + version);
                    System.exit(1);
                }
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new ImagePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public static boolean supportsPerAlphaPixel() {

        boolean support = false;

        try {

            Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
            support = true;

        } catch (Exception exp) {
        }

        return support;

    }

    public static void setOpaque(Window window, boolean opaque) {

        try {

            Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
            if (awtUtilsClass != null) {

                Method method = awtUtilsClass.getMethod("setWindowOpaque", Window.class, boolean.class);
                method.invoke(null, window, opaque);

            }

        } catch (Exception exp) {
        }

    }

    public class ContentPane extends JPanel {

        public ContentPane() {
            setOpaque(false);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.RED);
            g.drawRect(0, 0, getWidth() - 1, getHeight() - 1);
        }
    }

    public class ImagePane extends JPanel {

        private BufferedImage background;
        private BufferedImage offImage;
        private Ellipse2D offButton;
        private boolean mouseIn;

        public ImagePane() {
            setOpaque(false);
            try {
                background = ImageIO.read(new File("tamagotchi400.png"));
                offImage = ImageIO.read(new File("powerSmall.png"));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            offButton = new Ellipse2D.Float(212, 330, 25, 25);
            MouseAdapter handler = new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    if (e.getClickCount() == 1 && e.getButton() == MouseEvent.BUTTON1) {
                        if (offButton.contains(e.getPoint())) {
                            Window window = SwingUtilities.getWindowAncestor(ImagePane.this);
                            if (window != null) {
                                window.dispose();
                            }
                        }
                    }
                }

                @Override
                public void mouseMoved(MouseEvent e) {
                    Cursor cursor = Cursor.getDefaultCursor();
                    if (offButton.contains(e.getPoint())) {
                        cursor = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
                    }
                    setCursor(cursor);
                }

                @Override
                public void mouseEntered(MouseEvent e) {
                    mouseIn = true;
                    repaint();
                }

                @Override
                public void mouseExited(MouseEvent e) {
                    mouseIn = false;
                    repaint();
                }
            };
            addMouseListener(handler);
            addMouseMotionListener(handler);
        }

        @Override
        public Dimension getPreferredSize() {
            return background == null ? new Dimension(400, 400) : new Dimension(background.getWidth(), background.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (background != null) {
                Graphics2D g2d = (Graphics2D) g.create();
                int x = (getWidth() - background.getWidth()) / 2;
                int y = (getHeight() - background.getHeight()) / 2;
                g2d.drawImage(background, x, y, this);
                if (mouseIn && offImage != null) {
                    g2d.drawImage(offImage, (int) offButton.getX(), (int) offButton.getY(), this);
                }
                g2d.dispose();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T16:41:24.173

我无法理解你的第一个问题。我的英语不太好，这可能是原因。

关于第二个问题，你有没有尝试过关于 TrayIcon 的东西？请看一下：[http](http://docs.oracle.com/javase/tutorial/uiswing/misc/systemtray.html) ://docs.oracle.com/javase/tutorial/uiswing/misc/systemtray.html和[http://docs.oracle.com/javase/6/docs/api/java/awt/托盘图标.html](http://docs.oracle.com/javase/6/docs/api/java/awt/TrayIcon.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-10T11:00:19.857

只需在 JFrame 中添加新标签图像，然后设置 Jframe 背景透明

```
frame.setBackground(new Color(0, 0, 0, 0)); 
```

# wordpress - 如何在WP主题functions.php中查找页面is_home

> ID：13588787
> 
> 赞同：0
> 
> 时间：2012-11-27T16:35:05.887
> 
> 标签：wordpress

我正在使用此代码将一些元框添加到 Wordpress 的主页（ID 6）：

```
function add_page_metaboxes() {
    add_meta_box('meta_p_sub', 'Page Subtitle', 'meta_p_sub', 'page', 'normal', 'high');
    $post_id = $_GET['post'] ? $_GET['post'] : $_POST['post_ID'];
    if ($post_id == '6') {
        add_meta_box('meta_hp_thing', 'Homepage Thing', 'meta_hp_thing', 'page', 'normal', 'low');
    }
}
add_action('add_meta_boxes', 'add_page_metaboxes'); 
```

我希望能够在多个站点上使用它，并且 ID 并不总是“6”。我试过使用`if (is_home()) {...`，`if (is_front_page()) {...`但这似乎不起作用。

如何找出在 WP Admin > Settings > Reading > Front Page 中设置的 ID 并使用它？

干杯! 本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:44:14.750

头版 ID 存储在`page_on_front`选项中。

```
$post_id = get_option( 'page_on_front') 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-27T16:47:41.143

作为替代方案，您可以使用 is_page('slug');

```
if( is_page( 'homepage ) )
{
  // Do your thing...
} 
```

# php - Symfony2：与非命名空间 SDK（特别是 PayPal）集成

> ID：13588791
> 
> 赞同：4
> 
> 时间：2012-11-27T16:35:11.890
> 
> 标签：php, symfony, paypal, composer-php

我已经创建了一个`PaypalBundle`并将 Paypal[商人-php-sdk](https://github.com/paypal/merchant-sdk-php)添加到我的`composer.json`，现在我有了一个`vendor\paypal\merchant-php-sdk`目录。**但是这个 SDK 没有命名空间**，看起来也不是很`OOP`. *访问这些文件的最佳方式是什么？*

*   我应该使用`require`吗？
*   我应该做些什么`autoloading`吗？

我已经研究了类似的做法，`AmazonAPI`但亚马逊代码对定义的命名空间等更加 OOP 友好。

**第 1 步：Composer.json 'Repository' 配置**

```
{
    "type": "package",
    "package": {
        "version": "master",
        "name": "paypal/merchant-php-sdk",
        "source": {
            "url": "https://github.com/paypal/merchant-php-sdk.git",
            "type": "git",
            "reference": "master"
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:06:22.100

您可以使用 Composers[类映射](http://getcomposer.org/doc/04-schema.md#classmap)加载。

```
{
    "autoload": {
        "classmap": ["src/", "lib/", "Something.php"]
    }
} 
```

或者

如果您想在每个请求上明确要求某些文件，那么您可以使用[文件](http://getcomposer.org/doc/04-schema.md#files)自动加载机制。

```
{
    "autoload": {
        "files": ["src/MyLibrary/functions.php"]
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:38:20.567

如果 SDK 在 Packagist 上，那么包作者应该在他们的**composer.json**文件中定义要包含哪些文件；Composer 然后为您手动包含它们的文件。对于它们，您可以从全局命名空间访问它们：

```
<?php
namespace Path\To\Controllers;

class PaymentsController
{
    public function processAction()
    {
        $paypal = new \PayPal();

        // code...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-18T05:42:51.410

*   我对[https://packagist.org/packages/alchemyai/alchemyapi_php](https://packagist.org/packages/alchemyai/alchemyapi_php) 一个无命名空间包有同样的问题，以上都没有解决这个问题。这是我的解决方案：

*   不要更改包中的任何内容，composer 会为我们处理自动加载类映射。

*   例子：

> 作曲家需要 alchemyai/alchemyapi_php “dev-master”

*   将其类名添加到您要使用的文件/类中，如下所示：

> 使用炼金术API；

*   正常使用它：

> $alchemyapi = new AlchemyAPI('jrjeo94j49945hgh92h3493rhf-fake');

*   最后但最重要的是使用选项运行作曲家（来源：[https](https://github.com/composer/composer/issues/1150) ://github.com/composer/composer/issues/1150 ）：

> 作曲家转储自动加载--优化

它会工作，完成。

# c# - 在网络浏览器asp.net中打印预览？

> ID：13588793
> 
> 赞同：0
> 
> 时间：2012-11-27T16:35:12.777
> 
> 标签：c#, asp.net, printing

> **可能重复：**
> [在 asp.net 中生成网页的打印预览](https://stackoverflow.com/questions/10203199/generate-print-preview-of-a-web-page-in-asp-net)

我创建了普通的 asp.net 页面来打印任务详细信息。我有打印样式但我的问题当用户单击打印时如何在 Web 浏览器中打开打印预览有人可以帮助我吗

```
protected void lb_printTask_Click(object sender, EventArgs e)
{
    string taskID = Request.QueryString["taskID"];
    Response.Redirect("~/WebForm1.aspx?taskID=" + taskID);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:08:49.033

好的 找到解决方案

1.  创建 print.aspx 页面
2.  用户 Jquery 在打印预览中打开页面

    $(document).ready(function () { window.print(); });

# c++ - 打开 Al 录制和播放音频 - C++

> ID：13588794
> 
> 赞同：0
> 
> 时间：2012-11-27T16:35:13.350
> 
> 标签：c++, openal

我试图用 open al 录制音频，然后保存文件然后播放。

我已经在网上搜索了 5 个小时，但没有找到一个例子。

有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T22:47:51.893

此网站上有一个适用于 linux 的示例。但如果你赢了，还是苹果。您将需要更多破解它。 [使用 OpenAL 录制音频](https://stackoverflow.com/questions/3056113/recording-audio-with-openal?rq=1)

# .net - 在 WPF (XAML) 中使用表达式设计绘图

> ID：13588797
> 
> 赞同：1
> 
> 时间：2012-11-27T16:35:29.660
> 
> 标签：.net, wpf, xaml, drawing, expression-blend

我有一些表达设计中的艺术品（图像），我想在 WPF 中用作`Image`. 这样做的原因是它是一组图标的一部分，将用于我的应用程序的用户可以放大的区域，我希望它可以缩放。

我的图像具有高斯模糊效果，我不知道如何将其转换为我的`DrawingImage`. 当我尝试从表情设计中导出时，即使从警告中它告诉我它可以导出高斯模糊，它也不会。它将绘图的这一部分导出为 PNG 图像。

这是我到目前为止所得到的：

当我将 XAML 从 Expression Design 复制粘贴到 Expression Blend 时，我得到以下 XAML

```
 <Path Stretch="Fill" Fill="#B3000000" Data="F1 M 116.013,62.3682C 140.838,63.5389 160.541,73.4323 160.02,84.4657C 159.5,95.4992 138.954,103.494 114.128,102.324C 89.3031,101.153 69.6001,91.2596 70.1204,80.2262C 70.6407,69.1927 91.1874,61.1974 116.013,62.3682 Z " HorizontalAlignment="Left" Height="40.184" Margin="70.11,62.254,0,0" VerticalAlignment="Top" Width="89.92">
        <Path.Effect>
            <BlurEffect Radius="1.88976"/>
        </Path.Effect>
    </Path>
    <Ellipse Stretch="Fill" HorizontalAlignment="Left" Height="83.25" Margin="88.042,19.708,0,0" VerticalAlignment="Top" Width="83.25">
        <Ellipse.Fill>
            <RadialGradientBrush RadiusX="0.675" RadiusY="0.675" Center="0.660714,0.339286" GradientOrigin="0.660714,0.339286">
                <RadialGradientBrush.RelativeTransform>
                    <TransformGroup/>
                </RadialGradientBrush.RelativeTransform>
                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                <GradientStop Color="#FFBC0D0D" Offset="1"/>
            </RadialGradientBrush>
        </Ellipse.Fill>
    </Ellipse> 
```

我转换为：

```
<DrawingImage x:Key="redSphere">
    <DrawingImage.Drawing>
        <DrawingGroup>  
            <DrawingGroup.Children>
                <GeometryDrawing Brush="#B3000000" Geometry="F1 M 48.6792,44.0348C 73.5045,45.2056 93.2075,55.099 92.6872,66.1324C 92.1668,77.1658 71.6202,85.1612 46.795,83.9904C 21.9698,82.8197 2.26675,72.9263 2.78708,61.8928C 3.3074,50.8594 23.854,42.8641 48.6792,44.0348 Z "/>
                <GeometryDrawing Geometry="F1 M 62.3333,1.37501C 85.3222,1.37501 103.958,20.0112 103.958,43C 103.958,65.9889 85.3222,84.625 62.3333,84.625C 39.3445,84.625 20.7083,65.9889 20.7083,43C 20.7083,20.0112 39.3445,1.37501 62.3333,1.37501 Z ">
                    <GeometryDrawing.Brush>
                        <RadialGradientBrush RadiusX="0.675" RadiusY="0.675" Center="0.660714,0.339286" GradientOrigin="0.660714,0.339286">
                            <RadialGradientBrush.GradientStops>
                                <GradientStop Color="#FFFFFFFF" Offset="0"/>
                                <GradientStop Color="#FFBC0D0D" Offset="1"/>
                            </RadialGradientBrush.GradientStops>
                            <RadialGradientBrush.RelativeTransform>
                                <TransformGroup/>
                            </RadialGradientBrush.RelativeTransform>
                        </RadialGradientBrush>
                    </GeometryDrawing.Brush>
                </GeometryDrawing>
            </DrawingGroup.Children>
        </DrawingGroup>
    </DrawingImage.Drawing>
</DrawingImage> 
```

我的问题是，现在我无法弄清楚我的`BlurEffect`.

# c# - 服务器打印 RTF 文件

> ID：13588799
> 
> 赞同：-2
> 
> 时间：2012-11-27T16:35:34.137
> 
> 标签：c#, .net, windows, rtf

如何在没有任何用户对话框的情况下从窗口服务应用程序打印 rtf 文件？

我找到了 txt 文件但不是 RTF 的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:32:52.010

一些可能的方法：

1）使用文字自动化

[http://www.codeproject.com/Articles/10999/Printing-Word-Documents-in-C#%3a%20Print%20rtf](http://www.codeproject.com/Articles/10999/Printing-Word-Documents-in-C#%3a%20Print%20rtf)

2）将rtf文件加载到richtextbox（在winform应用程序上）..然后打印内容，如下所示

[如何使用 Visual C# .NET 或 Visual C# 2005 打印 RichTextBox 控件的内容](http://support.microsoft.com/default.aspx?scid=kb;en-us;812425)

3）也试试这个例子..dunno如果它适用于rtf..但它应该

[http://geekswithblogs.net/bleepzter/archive/2008/10/09/printing-a-pdf-file-to-a-network-printer-with-c.aspx](http://geekswithblogs.net/bleepzter/archive/2008/10/09/printing-a-pdf-file-to-a-network-printer-with-c.aspx)

4）您也可以将richtextbox控件的内容保存为图像并打印出来。

[http://stpetrus27.wordpress.com/2011/08/24/c-rtf-to-image/](http://stpetrus27.wordpress.com/2011/08/24/c-rtf-to-image/)

# sql - 将一列拆分为多列，但数据会有所不同 SQL

> ID：13588800
> 
> 赞同：1
> 
> 时间：2012-11-27T16:35:34.160
> 
> 标签：sql, sql-server-2008, tsql

我的数据库中有一组如下所示的行：

```
Mr Joe Bloggs
Joe Bloggs
Joe Jim Bloggs
Joe Jim David Bloggs
Mr Joe Jim Bloggs
Mr Joe Jim David Bloggs 
```

需要输出：

```
Title | First Name | Middle Name | Surname
------------------------------------------
Mr | Joe | x | Bloggs
x | Joe | x | Bloggs
x | Joe | Jim | Bloggs
x | Joe | Jim David | Bloggs
Mr | Joe | Jim | Bloggs
Mr | Joe | Jim David | Bloggs 
```

这将在 SQL 存储过程中运行。我需要的是在循环通过 CURSOR 和 4 个变量以更新数据库中的 4 列时生成的输出。但正如您所见，数据在 1 列中并且各不相同。

我发现很难理解这样做的最佳方式，并希望得到您的帮助。需要帮助请叫我。

与我的类似问题，但我觉得这些并没有给我我需要的完整答案，或者我认为它没有回答我的问题：

*   [将列字符串拆分为多个列字符串](https://stackoverflow.com/questions/6823924/split-column-string-into-multiple-columns-strings)
*   [将选择结果（一列）拆分为多列](https://stackoverflow.com/questions/9980695/split-select-results-one-column-into-multiple-columns)
*   [SQL 单列拆分为多列](https://stackoverflow.com/questions/11391348/sql-single-column-split-over-mutiple-columns)
*   [如何将列值拆分为 SQL 中的不同列](https://stackoverflow.com/questions/11408033/how-can-i-split-column-value-into-different-columns-in-sql)
*   [sql查询将一列拆分为两列](https://stackoverflow.com/questions/12435469/sql-query-to-split-one-column-into-two-columns)
*   [表列在sql中拆分为两列？](https://stackoverflow.com/questions/13507592/table-column-split-to-two-columns-in-sql)

编辑：

```
 --Temporary Table to Merge the full name together in order to split by comma. Each split will have a unique record but with the same address information for each name. 
    CREATE TABLE #TempOutput
    (
        ClientReference varchar(MAX),
        Prefix varchar(MAX),
        Reference int,
        MergedFullName varchar(MAX),
        FormatName varchar(MAX),
        Title varchar(MAX),
        FirstName varchar(MAX),
        MiddleName varchar(MAX),
        Surname varchar(MAX)
    )

    DECLARE @Ref varchar(MAX)
    DECLARE @Prefix varchar(MAX)
    DECLARE @Reference int
    DECLARE @MergedName varchar(MAX)
    DECLARE @FormatName varchar(MAX)
    DECLARE @Title varchar(MAX)
    DECLARE @FirstName varchar(MAX)
    DECLARE @MiddleName varchar(MAX)
    DECLARE @Surname varchar(MAX)

    DECLARE ExtraNameSplitCursor CURSOR FOR
        SELECT 
            [Client Reference], 
            Prefix,
            Reference,
            CASE 
                WHEN LEFT(Surname,3) = 'Mr,' THEN (Title + ' ' + [First Name] + ' ' + [Middle Name] + ' ' + Replace(Surname,'Mr,',''))
                WHEN LEFT(Surname,4) = 'Mrs,' THEN (Title + ' ' + [First Name] + ' ' + [Middle Name] + ' ' + Replace(Surname,'Mrs,',''))
                ELSE (Title + ' ' + [First Name] + ' ' + [Middle Name] + ' ' + Surname) 
            END AS [Merged Full Name]
        FROM #StartResults

    OPEN ExtraNameSplitCursor

    FETCH NEXT FROM ExtraNameSplitCursor INTO @Ref, @Prefix, @Reference, @MergedName
    WHILE @@FETCH_STATUS = 0
        BEGIN
            INSERT INTO #TempOutput (ClientReference, Prefix, Reference, MergedFullName) 
            SELECT @Ref, @Prefix, @Reference, GUID, FROM dbo.fn_SPLIT_LIST_STRING (@MergedName)

            --SELECT CASE 
            --  WHEN @FormatName.GUID = 'Mr ' THEN @Title = 'Mr'
            --  WHEN LEFT(@MergedName,4) = 'Mrs ' THEN @Title = 'Mrs' 
            --  WHEN LEFT(@MergedName,5) = 'Miss ' THEN @Title = 'Miss'
            --  WHEN LEFT(@MergedName,3) = 'Ms ' THEN @Title = 'Ms'
            --  WHEN LEFT(@MergedName,3) = 'Dr ' THEN @Title = 'Dr'
            --  WHEN LEFT(@MergedName,4) = 'Rev ' THEN @Title = 'Rev'
            --  WHEN LEFT(@MergedName,5) = 'Lord ' THEN @Title = 'Lord'
            --  ELSE @Title = '' 
            --END AS Title,
            --CASE 
            --  WHEN MID(@MergedName,2,1) = ' ' THEN @FirstName = '' ELSE @FirstName = CHARINDEX(' ', MergedFullName + ' ') FROM #TempOutput AS FirstName

            FETCH NEXT FROM ExtraNameSplitCursor INTO @Ref, @Prefix, @Reference, @MergedName, @FlatNo, @HouseName, @HouseNo, @Street, @District, @PostTown, @County, @PostCode
        END

    CLOSE ExtraNameSplitCursor
    DEALLOCATE ExtraNameSplitCursor

    --Select statement for temporary table
    SELECT 
        ISNULL(ClientReference,'') AS ClientReference,
        ISNULL(Prefix,'') AS Prefix,
        ISNULL(Reference,'') AS Reference,
        ISNULL(MergedFullName,'') AS MergedFullName, 
        ISNULL(Title,'') AS Title,
        ISNULL(FirstName,'') AS FirstName,
        ISNULL(MiddleName,'') AS MiddleName,
        ISNULL(Surname,'') AS Surname

    FROM #TempOutput Result
    ORDER BY ClientReference
    for xml auto

    --Drop all temporary tables
    DROP TABLE #TempOutput
    DROP TABLE #StartResults

END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T14:57:09.163

我已经解决了我的问题，并感谢您提供的线索和帮助。

我基本上添加了第二个光标，它执行以下操作：

*   抓住合并的全名字段并放入一个临时变量。
*   通过运行 case 语句来检查标题以检查 Mr、Mrs 等。否则在 Title 中输入空白字符串。
*   更新标题修剪合并全名的标题
*   通过 RIGHT(@TempName, CHARINDEX(' ', REVERSE(@TempName)) - 1) 检查姓氏，并假设这是姓氏。
*   更新姓氏修剪并替换合并的全名
*   通过 LEFT(@TempName, CHARINDEX(' ',
    @TempName + ' ') -1)检查左边的名字
*   更新名字修剪并替换合并的全名
*   其他任何东西都放在中间名中。

有点啰嗦，但在我的数据库中 99.9% 的情况下，它的格式都很完美。

如果您想要上面的代码，请告诉我。

谢谢你的时间。

# erlang - 除了本地主机，我无法从任何机器访问氮气/inets 服务器

> ID：13588803
> 
> 赞同：1
> 
> 时间：2012-11-27T16:35:36.703
> 
> 标签：erlang, ubuntu-12.04, nitrogen, inets

感谢这个论坛中的许多讨论，我发现我应该能够构建我计划基于 Nitrogen 为家庭使用的应用程序。

所以我遇到了 Nitrogen 教程、演示和文档，并开始基于自包含的 inets/nitrogen 站点进行一些测试。一切都很顺利，直到我想尝试从另一台 PC 访问我的新网站。当然，我必须先调整我的盒子才能将 wan 请求路由到 lan……但是经过一天的搜索、阅读和测试，我仍然卡住了……

我测试过的内容：

*   使用 Intranet IP 地址或 localhost 从本地主机调用网站：OK
*   从本地主机，访问静态页面和不同的“my_page.erl”路径：OK
*   使用局域网地址从另一台 PC 访问：我可以使用wireshark 捕获以太网帧，但连接因超时而失败。
*   使用 wan 地址从另一台 PC 访问：我可以使用 wireshark 捕获以太网帧（地址转换后），但连接因超时而失败。

![wireshark 和 netstat 结果的屏幕截图](../Images/b7e3405caada64970cd755e6f7a64dc8.png)

*   使用 wan 地址从本地 PC 访问：我可以捕获以太网帧并使用wireshark，但连接因超时而失败。
*   我在我的代码中放了一些 ?DEBUG 宏：但没有一个达到。
*   我尝试访问静态文件：相同的行为。
*   我使用 netstat -ap 检查了进程 beam.smp 正在侦听正确的端口：好的
*   我使用 smartsniff 检查了外部 PC 上的响应帧：lan 和 wan 访问都没有响应。
*   我测试了不同的端口和端口路由。

我必须错过一些明显的东西，为了使这项工作能够进行配置，是否需要进行一些配置？或者我可以做的测试？因为我没有更多的想法。

语境：

*   在 Windows XP 32 上运行的浏览器 firefox 16.0.2 和 chromium 21.0.1138
*   在 Ubuntu 12.04 上运行的服务器
*   默认氮气/inets 应用程序（修改端口为 8020）
*   二郎15B02
*   nprocreg, 0.2.0
*   解析工具，2.0.7
*   通用测试，1.6.2
*   失忆症，4.7.1
*   ssl, 5.1
*   公钥，0.16
*   编译器，4.8.2
*   xmerl, 1.3.2
*   运行时工具，1.8.9
*   加密，2.2
*   内茨，5.9.1
*   萨斯勒，2.2.1
*   标准库，1.18.2
*   内核，2.15.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T13:35:18.027

我输入这个答案只是为了提到问题出在我的防火墙配置中，正如 Syhpoon 指出的那样，所以它已经解决了。

对于其他成员，我应该如何处理这个问题？我不认为这对其他人有很大帮助，但它提醒我们所有坚持以下原则的人：

*   列出游戏中的所有元素
*   “向我的朋友寻求一点帮助”......还不算太晚 :o)

我应该删除主题吗？

# php - 按键对多维数组的值进行排序

> ID：13588808
> 
> 赞同：0
> 
> 时间：2012-11-27T16:35:50.673
> 
> 标签：php

**桌子**

```
cat_id | cat_parent_id | cat_name   
---------------------------------
12     |      0        |  Car    
13     |      0        |  Manga      
14     |      12       |  Volvo      
15     |      12       |  Mercedes-Benz      
16     |      13       |  Naruto     
17     |      13       |  Hunter X Hunter
18     |      0        |  Animals 
```

我试图获取数据库中的类别并将其放入一个数组中，然后使用该数组构建下拉列表的代码。这是下面的代码。

```
while($row = dbFetchArray($result)) {
        list($id, $parentId, $name) = $row;

        if ($parentId == 0) {
            // we create a new array for each top level categories
            $categories[$id] = array('id' => $id, 'name' => $name, 'children' => array());
        } else {
            // the child categories are put int the parent category's array
            $categories[$parentId]['children'][] = array('id' => $id, 'name' => $name); 
        }
}

$list = '';
    foreach ($categories as $key => $value) {
        $name     =  "--" . strtoupper($value['name']) . "--";
        $children = $value['children'];

        $list .="<option value=\"{$value['id']}\"";
        if ($value['id'] == $catId) {
                $list.= " selected";
        }
        $list .= ">$name</option>\r\n";

        foreach ($children as $child) {
            $list .= "<option value=\"{$child['id']}\"";
            if ($child['id'] == $catId) {
                $list.= " selected";
            }

            $list .= ">{$child['name']}</option>\r\n";
        }

    } 
```

$categories 数组的最终值

```
Array
(
    [12] => Array
        (
            [id] => 12
            [name] => Car
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 14
                            [name] => Volvo
                        )

                    [1] => Array
                        (
                            [id] => 15
                            [name] => Mercedez-Benz
                        )

                )

        )

    [13] => Array
        (
            [id] => 13
            [name] => Manga
            [children] => Array
                (
                    [0] => Array
                        (
                            [id] => 16
                            [name] => Naruto
                        )

                    [1] => Array
                        (
                            [id] => 17
                            [name] => Hunter X Hunter
                        )

                )

        )

    [18] => Array
        (
            [id] => 18
            [name] => Animals
            [children] => Array
                (
                )

        )

) 
```

但我想按键“名称”的值对 $categories 进行排序。

我尝试了很多次，到目前为止这是我的解决方案。

```
function sortByName($a, $b) {
    return strcmp($a["name"], $b["name"]);
}

usort($categories,"sortByName");

foreach($categories as $k => $v){
    foreach($v as $kk => $vv) {

        if ($kk == "children") {
            usort($vv,"sortByName");

            print_r($vv );

        }
    }
} 
```

我的问题甚至是第一级键“名称”排序很好，但我对第二级进行排序的解决方案不起作用。

而且当排序发生时，我排序的数组的索引变为0 1 2 3。

例如，当我按键 'name' 18 12 13 的值对其进行排序时，将变为 0 1 2

```
Array(
    [18] => Array
        (
            [id] => 18
            [name] => aa

        )

    [12] => Array
        (
            [id] => 12
            [name] => Car

        )

    [13] => Array
        (
            [id] => 13
            [name] => Manga

        )            
) 
```

我该如何排序，但我也希望 18 12 13 不改变？

所以我希望我的 $categories 数组是这样的

```
Array
(

    [18] => Array
        (
            [id] => 18
            [name] => Animals
            [children] => Array
                (
                )

        )

    [12] => Array
        (
            [id] => 12
            [name] => Car
            [children] => Array
                (
            [0] => Array
                        (
                            [id] => 15
                            [name] => Mercedes-Benz
                        )

                    [1] => Array
                        (
                            [id] => 14
                            [name] => Volvo
                        )

            )

        )

    [13] => Array
        (
            [id] => 13
            [name] => Manga
            [children] => Array
                (
            [0] => Array
                        (
                            [id] => 17
                            [name] => Hunter X Hunter
                        )

                    [1] => Array
                        (
                            [id] => 16
                            [name] => Naruto
                        )

                )

        )
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:38:09.847

太费劲了。使用 NAME 作为数组 KEY，然后用[ksort键排序](http://uk1.php.net/manual/en/function.ksort.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:43:27.337

我认为问题在于 PHP 不会将这些数字索引解释为键，而只是索引，因此它不会在排序后保留它们。如果您将它们转换为字符串然后进行排序，我怀疑它会保留它们。或者，您可以将数字键与您的姓名交换（当然，如果名称是唯一的），做一个简单的 ksort （如前面的答案中所建议的那样），然后再将它们交换回来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:44:57.230

您可以使用 uksort 来执行您想要的操作。但是你的设计有问题。

就像@Lukasz Kujawa 所说，php 数组被设计为在 O(1) 中访问。您的设计，作为 C 数组，强制所有内容为 O(n) 并在过程中添加一个步骤。

我会给你 uksort 的“解决方案”，但对我来说这不是一件好事。

```
uksort($categories,function($a,$b)use($categories){
       return return strcmp($categories[$a]["name"], $categories[$b]["name"]);
} 
```

# android - looking for a workaround for a bug in google maps Projection

> ID：13588810
> 
> 赞同：-2
> 
> 时间：2012-11-27T16:35:52.997
> 
> 标签：android, google-maps

I am working with google maps api 10 for some time now and there is a bug that i just cant fix because im 99.9% sure its within googles library.

I do a lot of Projection `.toPixels()` to draw stuff and all works fine. I zoom with custom zoom methods `mapController.setZoom(getZoom() +1)` and it all works UNTIL i use a pinch-zoom (2-finger zoom). After that, the Projection seems to be stuck within certain zoom levels.

If i pinch zoom from 12 to 11 the maps `getZoomLevel()` gives me 11 (it always reports the right level). Now if i use my zoomOut method i am on level 13 and the projection calculates all right for level 13 but every subsequent zoomOut only changes the maps zoom-level (internally, remember, device has no internet so no map data). The projection continues to calculate everything as if it was still zoomlevel 13!
Should i zoomIn the projection suddenly jumps to level 11, no matter what the real level of the map is. So if i pinch zoomed to 12 the projection is stuck at 11 / 13 and will only jump between those two if i zoom out/in.
IF i pinch-zoom again, the projection is updated but stuck again at the new level to which i pinch-zoomed.

So a pinch zoom without internet completely kills the projection and the whole map becomes useless (in my case i dont really need the visual map, i just need its geoPoint translation, thats the most important part).

Does anyone know a hotfix/workaround or anything that could help me other than to disable more than 1 pointer in the on-touch ?

Map Stuff in the constructor of my customMapView

```
 setVisibility(View.VISIBLE);

    mapController = getController();

    mapController.setZoom(17);

    setBuiltInZoomControls(false);
    getZoomButtonsController().setVisible(false);

    setSatellite(false);
    setTraffic(false);
    setClickable(true);
    preLoad(); 
```

and thats how i zoom with custom buttons

```
mapController.setZoom(getZoomLevel() + 1); // zoom in
mapController.setZoom(getZoomLevel() - 1); // zoom out 
```

1) zoom buttons work
2) pinch zoom out
3) now the buttons/zoom via button shows the behaviour as described above

Additional Info:
i just used the apps "myTracks" and "Torque".
Both use googlemaps.
In both i have recorded tracks.
Now if i disable internet and use 2-finger zoom and after that zoom in/out with the usual buttons, at some point the track wanders off into some direction even if it is perfectly centered. Up to the point where the track is gone after lots of zoom out/in.
The second i reactivate internet and the map is able to load some tiles the NEXT zoom is working and all is fine... because the map seems to require some data from the internet to calculate something within the projection and this something seems to be provided by a 2-finger zoom... thats how i see it.

3 Apps, all the same issue...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:17:20.767

你的问题很混乱，你应该重新措辞。

但至少我知道您正在使用`MapView`未连接到互联网的设备，并且您在将投影与地图缩放级别同步时遇到问题。

首先也是最重要的，问题不在谷歌地图中，​​您需要在代码中查找问题。

实现和之间同步的最常见错误`getZoomLevel()`是`Projection`经常忘记第一个是整数值（它以 1 的倍数的离散步长增加/减少），而地图图像和投影可以在它们之间取值以向用户提供更平滑的放大/缩小。

例如，当您捏合缩放时，当您将手指放在屏幕上并更改地图大小（和投影）时，该方法`getZoomLevel()`始终返回您开始捏合缩放时地图的缩放级别。只有在您停止捏合进行缩放（将手指从屏幕上移开）后，该方法`getZoomLevel()`才会返回最终选择的缩放级别。但是如果没有在这里完成，因为动画会继续将地图图像放大/缩小到最接近的整数缩放级别（`getZoomLevel()`在您停止捏缩放后开始返回的缩放级别）。

希望你能理解。如果没有发布您的代码示例来说明问题，您将获得纠正它的帮助。

问候。

# jquery - Passing data to a jQuery-UI Dialog

> ID：13588813
> 
> 赞同：1
> 
> 时间：2012-11-27T16:35:58.863
> 
> 标签：jquery, jquery-ui

Often I have a table or a list, and I want to create an event when a given row is clicked, and do something specific to the clicked row. To do so, I have been defining data() within click(). Sometimes I just send a piece of data and other times I send the entire row.

Is the way I am doing this the best way, or is there a better way? Is it best to send just the required data to the dialog, or send the entire object over (i.e. row in my case) and extract data within the dialog?

Thanks

```
$("#someTable tbody").on("click", "a.doIt", function() {
    $("#dialog").data('id',$(this).parent().parent().attr('data-id')).dialog("open");
    //$("#dialog").data('id',$(this).parent().parent()).dialog("open");
    return false;
});
$("#dialog").dialog({
    open        : function() {
        alert($(this).data('id')+' is available.');
        //alert($(this).data('row').attr('data-id')+' is available.');
    },
    buttons     : [
        {
            text    : 'CLOSE',
            "class"  : 'gray',
            click    : function() {
                alert($(this).data('id')+' is available.');
                //alert($(this).data('row').attr('data-id')+' is available.');
                $(this).dialog("close");
            }
        }
    ]    
});

<table id="someTable">
    <tbody>
        <tr data-id="123"><td><a href="javascript:void(0)" class="doIt">aaa</a></td><td>bbb</td></tr>
        <tr data-id="321"><td><a href="javascript:void(0)" class="doIt">ccc</a></td><td>ddd</td></tr>
        <tr data-id="111"><td><a href="javascript:void(0)" class="doIt">eee</a></td><td>fff</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:49:07.067

您可以像这样传递 ui-dialog 的数据

```
document.getElementById('dialog-modal').innerHTML = '<span style="font-family:sans-serif;font-size:18px">'+str+'</span>';
    $( "#dialog-modal" ).dialog({
        height: 120,
        modal: true,
        resizable:false,
        buttons: {
            Ok: function() {
                $( this ).dialog( "close" );
            }
        }
    });
    $(".ui-dialog-titlebar").hide(); 
```

您可以更改所需 id 的 innerHTML，然后打开对话框。

更新：

```
$("#someTable tbody").on("click", "a.doIt", function() {
$("#dialog").html($(this).parent().parent().attr('data-id').html());

$("#dialog").dialog({
        height: 120,
        modal: true,
        resizable:false,
        buttons: {
            Ok: function() {
                $( this ).dialog( "close" );
            }
        }
    });}); 
```

# javascript - JSON array requires mandatory field

> ID：13588814
> 
> 赞同：2
> 
> 时间：2012-11-27T16:35:59.207
> 
> 标签：javascript, getjson, json, jsonschema

I'm using the following JSON schema which defines a list of users. I use the schema to register multiple users at a time.

I would like to know if there is a way to specify that each object in the JSON contains at least one property for registration?

Here is my schema:

```
{
   "description":"Schema definition for the request to register",
   "type":"object",
   "properties":{
      "registerRequests":{
         "type":"array",
         "items":{
            "type":"object",
            "properties":{
               "user":{
                  "type":"object",
                  "properties":{
                     "age":{
                        "type":"integer",
                        "optional":true,
                        "minimum":1950,
                        "maximum":2100
                     },
                     "name":{
                        "type":"object",
                        "properties":{
                           "code":{
                              "type":"string",
                              "pattern":"^[\\w\\s!@#\\$%&\\-\\+=;:'\",\\.\\?\\(\\)\\\\/]{1,500}$"
                           },
                           "Desc":{
                              "type":"string",
                              "pattern":"^[\\w\\s!@#\\$%&\\-\\+=;:'\",\\.\\?\\(\\)\\\\/]{1,500}$"
                           }
                        },
                        "optional":true
                     }
                 }
               }
            }
         }
      }
   },
   "additionalProperties":false
} 
```

My input request to register two users:

```
{
   "registerRequests": [
     {
           "user": {
               "age": "25",
               "Desc": "Test"
           }
       },

       {
           "user": {
               "age": "20"
        }
     }
   ]
} 
```

Here I'm sending two user's information and each user object request contains at least one property. If I add a third object without any properties I want to restrict the request in the JSON itself saying at least one field is required on each user object. I'm looking for an attribute similar to pattern or optional .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T11:43:41.310

好的，对此的回答很晚，但是...

直到并包括草案 v3，没有。

使用 v4 草案（即将发布），是的：`"minProperties": 1`.

# javascript - How to dynamically create objects with variables?

> ID：13588821
> 
> 赞同：4
> 
> 时间：2012-11-27T16:36:17.600
> 
> 标签：javascript, qt, qml

I'm having trouble trying to generate objects in QML using Javascript to create them dynamically.

The code I am trying to use is this

```
Grid {
    id: numbers
    anchors.centerIn: parent
    columns: 3
    spacing: 2
    function createNumbers(){
        var component = Qt.createComponent("Button.qml");
        for(var i=1; i<37; i++){
            component.createObject(numbers)
        }
    }
    Component.onCompleted: createNumbers()
} 
```

Which works fine, however I want to include variables to make them each different, so that when I pass the information to Button.qml it sets the following

```
property string text: "1"
property string id: "button1" 
```

I can't figure it out, any help would be great, thanks guys.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:53:10.540

[这](http://doc.qt.digia.com/qt/qml-component.html#createObject-method)是方法的文档`Component.createObject`。

如您所见，您可以使用函数的第二个可选参数设置新对象的参数。在您的情况下，它将是：

```
component.createObject(numbers, {"text": "1", "id": "button1"}); 
```

# php - How to change the passphrase of a private key using PHP's OpenSSL module?

> ID：13588822
> 
> 赞同：5
> 
> 时间：2012-11-27T16:36:19.287
> 
> 标签：php, encryption, openssl, public-key-encryption, encryption-asymmetric

I'm using PHP's OpenSSL module for asymmetric encryption; openssl_pkey_new(), openssl_pkey_export(), and openssl_pkey_get_details() to create the keypair, and openssl_public_encrypt and openssl_private_decrypt() to encrypt and decrypt data.

How can I change the passphrase associated with the private key? Is this possible with the OpenSSL module, or do I have to create a new keypair? That would be extremely inconvenient and require the server to re-encrypt potentially thousands of files on a regular Basis.

Thanks!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-10T20:54:56.833

我需要为我在晚上构建的一个小项目执行此操作。

我们知道以下创建了一个**新**的密钥对（公共/私有）：

```
function newPair (&$private, &$public, $passphrase=null) {
    $res = openssl_pkey_new ();
    if ($res === false) {
        throw new Exception ("Key generation failed: ".openssl_error_string ());
        return false;
    }
    // Sets private by reference
    if (openssl_pkey_export ($res, $private, $passphrase) === false) {
        throw new Exception ("Private key export failed: ".openssl_error_string ());
        return false;
    }
    // Array returns, contains "key" element.
    $public = openssl_pkey_get_details($res);
    if ($public === false) {
        throw new Exception (openssl_error_string ());
        return false;
    }
    $public = $public["key"];
    return true;
} 
```

open_ssl_pkey_export() 具有密码短语的魔力。所以我们可以这样更改密码：

```
function changePassphrase ($private, $old, $new=null) {
    $res = openssl_pkey_get_private ($private, $old);
    if ($res === false) {
        throw new Exception ("Loading private key failed: ".openssl_error_string ());
        return false;
    }
    if (openssl_pkey_export ($res, $result, $new) === false) {
        throw new Exception ("Passphrase change failed: ".openssl_error_string ());
        return false;
    }
    return $result;
} 
```

我希望你能关注我们在这里所做的事情......！（显然异常抛出是完全可选的......我刚刚从我的代码库中逐字提取代码。）

changePassphrase() 将私钥作为**字符串**，以及当前和新的密码短语。我们使用 openssl_pkey_get_private() 来检索私钥的句柄，用旧密码解锁它。

（值得注意的是，密码短语实际上是用来加密私钥的，这听起来可能有点双荷兰语！[Encrypting the encryption key ... ?!] openssl_pkey_get_private() 如果无法解释密钥，则返回 FALSE - 即如果密码错误，并且私钥解密为无效值。有意义吗？）

使用旧密码解锁私钥后，我们获取 OpenSSL 密钥句柄并将其传递给 openssl_pkey_export() - 就像我们在首先创建它之后所做的那样（通过 openssl_pkey_new()）提供新密码......嘿- 转瞬即逝。

我希望我的代码示例读起来干净利落，我尝试以一种易于理解和遵循的方式编写它，没有不必要的“压缩”和捷径。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T21:37:15.733

使用[phpseclib，一个纯 PHP RSA 实现](http://phpseclib.sourceforge.net/index.html)：

```
<?php
include('Crypt/RSA.php');

$rsa = new Crypt_RSA();
$rsa->setPassword('old_password');
$rsa->loadKey('...');

$rsa->setPassword('new_password');
$privatekey = $rsa->getPrivateKey();
$publickey = $rsa->getPublicKey();
?> 
```

# ios - Monotouch- Enable Guard Malloc

> ID：13588836
> 
> 赞同：4
> 
> 时间：2012-11-27T16:37:02.017
> 
> 标签：ios, memory, xamarin.ios, crash, malloc

this is my first question on StackOverflow, hopefully it is a pertinent one! To try to put you in context, I have an odd crash in my application when I try to open the camera with the PresentViewController method. I tried looking into the crash reports, but I do not have any call details, only hexadecimal as following:

```
 Thread 0 Crashed: 
 0   libsystem_kernel.dylib         0x38a97350 0x38a86000 + 70480
 1   libsystem_c.dylib              0x35d3a11e 0x35d0b000 + 192798
 2   libsystem_c.dylib              0x35d7696e 0x35d0b000 + 440686
 3   (project_name)                 0x00882968 0x1000     + 8919400
 4   (project_name)                 0x0083db7c 0x1000     + 8637308
 5   libsystem_c.dylib              0x35d43e90 0x35d0b000 + 233104
 6   UIKit                          0x39d40b00 0x39d3b000 + 23296
 7   QuartzCore                     0x34c52ff2 0x34c4c000 + 28658
 8   QuartzCore                     0x34c52fa2 0x34c4c000 + 28578
 9   QuartzCore                     0x34c52e8e 0x34c4c000 + 28302
 10  QuartzCore                     0x34c4e9ba 0x34c4c000 + 10682
 11  QuartzCore                     0x34c4e876 0x34c4c000 + 10358
 12  QuartzCore                     0x34c4e806 0x34c4c000 + 10246
 13  UIKit                          0x39d3fae8 0x39d3b000 + 19176
 14  UIKit                          0x39d4271e 0x39d3b000 + 30494
 15  UIKit                          0x39d84a6c 0x39d3b000 + 301676
 16  PhotoLibrary                   0x381c39ca 0x38157000 + 444874
 17  UIKit                          0x39d417fe 0x39d3b000 + 26622
 18  QuartzCore                     0x34c4fd5e 0x34c4c000 + 15710
 19  QuartzCore                     0x34c4f8fc 0x34c4c000 + 14588 
```

Anyways, since my crash report is inconclusive (in my opinion), I googled how to usually handle memory issues for iOS and NSZombieEnabled and Enabling Guard Malloc have ben mentioned. NSZombieEnabled is enabled by default in Monotouch, but I didn't find anywhere how to Enable Guard Malloc. Is it even possible for Monotouch? Thank you!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:20:34.813

Without proper stack traces any other debugging tool will be pretty much useless.

You need to symbolicate the crash report - or figure out why yours doesn't symbolicate properly. Usually Xcode does it automatically (it takes a few seconds after you've opened the crash report though), but it requires Spotlight to find the debugging information, so if Spotlight isn't indexing your project directory this is one of the consequences. Another thing that trips up symbolication sometimes is if the solution/project/executable name aren't identical.

You should also look in the device log, many times the exact reason for the crash is printed out there (even with instructions on how to fix it). [Here](http://rolfkvinge.blogspot.com.es/2012/04/native-crashes-in-monotouch.html) is a guide on how to find the device logs if haven't seen them before.

# c# - WPF - ListBox ContentTemplate 文本框 MouseDown 导致列表框项目未被选中

> ID：13588837
> 
> 赞同：1
> 
> 时间：2012-11-27T16:37:02.670
> 
> 标签：c#, wpf, events, datatemplate, listboxitem

摘要：单击列表框项，DataTemplate 中的文本框获得焦点，但未选择列表框项。

我确定这与事件冒泡有关，但我在这里遗漏了一些东西。

我有列表框。每个 ListBoxItem 的 ContentTemplate 都分配给一个包含简单文本框的 DataTemplate。

此 TextBox 旨在显示为虚假的可编辑标签。

问题：单击文本框时，ListBox 的 selectedItem 没有被更新。文本框正在吞噬 mousedown 事件，并且永远不会通知列表框更新到新项目。

我觉得我在这里错过了一些愚蠢的东西。有任何想法吗？有没有办法强制事件冒泡到父 ListView？

我已经尝试了从使文本框的背景为 Null 到处理 previewmousedown 事件和设置 e.handled = false; 的所有方法。

数据模板：

```
<DataTemplate x:Key="ItemTempl">
            <TextBox Height="20" Width="200" Name="tbox" Text="{Binding WordText}" HorizontalAlignment="Stretch">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Background" Value="{x:Null}"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbox}" Value="True">
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="Background" Value="White"/>                                    
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBox.Style>
            </TextBox>
</DataTemplate> 
```

列表显示：

```
<ListView HorizontalAlignment="Stretch" ItemsSource="{Binding Something.Words}" Name="MainListView" SelectedItem="{Binding CurrentItem, Mode=TwoWay}" BorderThickness="0" ItemContainerStyle="{StaticResource ContainerStyle}">
</ListView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:51:27.483

我通过创建自己的处理预览鼠标按下事件并选择项目的列表视图来解决 ListView 的这个特殊问题，您可以根据您的情况进行调整，可能最好在附加属性中执行此操作，这样您就不会必须创建一个新类。

我基本上寻找鼠标的原始来源，即文本框，使用可视树助手跟踪它的可视树一直回到它所在的列表视图项并选择它。

```
 public class MyListView : ListView
    {
        protected override void OnPreviewMouseDown(System.Windows.Input.MouseButtonEventArgs e)
        {
            DependencyObject listViewItem = (DependencyObject)e.OriginalSource;
            while (listViewItem != null && !(listViewItem is ListViewItem))
                listViewItem = VisualTreeHelper.GetParent(listViewItem);

            SelectedItem = ((ListViewItem)listViewItem).Content;

            base.OnPreviewMouseDown(e);
        }
    } 
```

编辑：这是附加的属性版本。

```
public class ListViewExtras : DependencyObject
    {
        public static bool GetWillAlwaysSelect(DependencyObject obj)
        {
            return (bool)obj.GetValue(WillAlwaysSelectProperty);
        }

        public static void SetWillAlwaysSelect(DependencyObject obj, bool value)
        {
            obj.SetValue(WillAlwaysSelectProperty, value);
        }

        // Using a DependencyProperty as the backing store for WillAlwaysSelect.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty WillAlwaysSelectProperty =
            DependencyProperty.RegisterAttached("WillAlwaysSelect", typeof(bool), typeof(ListViewExtras), new PropertyMetadata(false, new PropertyChangedCallback((s, e) =>
            {
                ListView listView = s as ListView;
                if (listView != null)
                {
                    if ((bool)e.NewValue) listView.PreviewMouseDown += listView_PreviewMouseDown;
                    if (!(bool)e.NewValue && (bool)e.OldValue) listView.PreviewMouseDown -= listView_PreviewMouseDown;
                }
            })));

        static void listView_PreviewMouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
        {
            ListView listView = sender as ListView;
            if (listView != null)
            {
                DependencyObject listViewItem = (DependencyObject)e.OriginalSource;
                while (listViewItem != null && !(listViewItem is ListViewItem))
                    listViewItem = VisualTreeHelper.GetParent(listViewItem);
                listView.SelectedItem = ((ListViewItem)listViewItem).Content;
            }
        }
    } 
```

并将其与

```
<ListView HorizontalContentAlignment="Stretch" local:ListViewExtras.WillAlwaysSelect="True"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T20:50:48.227

我将事件处理程序更改为更通用，支持使用 ContainerFromElement 和 ItemContainerGenerator.IndexFromContainer 方法的任何选择器。

```
 private static void OnPreviewListBoxMouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        var listBox = sender as Selector;
        if (listBox != null)
        {
            DependencyObject mouseItem = e.OriginalSource as DependencyObject;
            if (mouseItem != null)
            {
                // Get the container based on the element
                var container = listBox.ContainerFromElement(mouseItem);
                if (container != null)
                {
                    var index = listBox.ItemContainerGenerator.IndexFromContainer(container);
                    Debug.Assert(index >= 0);
                    listBox.SelectedIndex = index;
                }
            }
        }
    } 
```

# objective-c - 如何在工具栏中间添加超大按钮

> ID：13588843
> 
> 赞同：0
> 
> 时间：2012-11-27T16:37:13.420
> 
> 标签：objective-c, ios, xcode, uibarbuttonitem, uitoolbar

我正在编写一个相机应用程序，我需要创建一个带有 3 个按钮的工具栏（当然在屏幕底部），中间的按钮需要超过显示相机图像的导航栏的高度。

我不清楚如何向工具栏添加一个比工具栏本身高约 20% 的按钮。

我已经看到了一些设计，它看起来真的很漂亮，但是我如何以编程方式配置这样的按钮？

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:46:57.097

你可以从创建你自己的 UIView 开始，它包含所有的按钮。

添加每个按钮并定位它，包括超大的中间按钮 - 将其定位在 -y 坐标（例如 -10）。

然后将容器 UIView Clips Subviews 设置为 NO - 这可以在 IB 中或以编程方式完成 -`self.view.clipsToBounds = NO`

这将允许中间按钮在其父容器之外流动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:07:44.653

我自己没有使用过这个，但我认为它描述了你所追求的。

[https://github.com/boctor/idev-recipes/tree/master/RaisedCenterTabBar](https://github.com/boctor/idev-recipes/tree/master/RaisedCenterTabBar)

如果您希望自己修改相机控件的 UI，那么这可能更难实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:42:49.773

您可以制作一个按钮并将其放在标签栏的顶部。或者在 Photoshop 中制作自己的标签栏或其他东西。

# android - Android：SOAP 和 JTDS 开销

> ID：13588851
> 
> 赞同：0
> 
> 时间：2012-11-27T16:38:06.320
> 
> 标签：android, soap, ksoap, overhead, jtds

我目前正在做的是将带有时间戳和其他参数的 GPS 数据发送到远程 MSSQL 数据库。起初，我通过 ksoap2 将它发送到 SOAP WebService。由于开销巨大，我寻找替代方案并通过JTDS实现数据传输以直接插入。在我成功实现这两种方法后，我开始比较它们。我试图找出哪一个会导致更多的流量。我分析了网络流量，令我惊讶的是 SOAP 比 JTDS 便宜。这不是很奇怪吗？我已经发送了相同的数据。我正在使用 JTDS 1.2.7 驱动程序。ksoap 导致约。1.8 kByte 流量和比较 JTDS 导致 ca。2.1 KB。

有没有人有同样的经历或者可以告诉我我可以改变什么？

这是 JTDS 代码。也许有人可以告诉我，是什么导致了流量：

```
try {
   Class.forName("net.sourceforge.jtds.jdbc.Driver");
   String connString = "jdbc:jtds:sqlserver://192.XXX.X.XX/xxxx;encrypt=false;user=XX;password=XX;instance=SQLEXPRESS;";
   conn = DriverManager.getConnection(connString);
} catch (Exception ex){
   ex.printStackTrace();
}

try {
  Log.w("Connection", "open");

  CallableStatement cs = conn.prepareCall("{ call SetGPS(?, ?, ?, ?, ?, ?, ?)}");
  cs.setString(2, latitude);
  cs.setString(3, longitude);
  cs.setInt(4, ID);
  cs.setString(5, timestamp);
  cs.setString(6, IMEI);
  cs.setInt(7, userID);
  cs.registerOutParameter(1, Types.VARCHAR);

  cs.execute();
  String response = cs.getString(1);

  Log.i("GPS Response:", response);

  conn.close();
} catch (Exception ex){
    ex.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T14:01:07.340

好的，我发现是连接的建立导致了 JTDS 网络流量的四分之三。带参数的实际存储过程调用只会导致 ca. 400 字节流量。

因此，如果我们不每次想通过 JTDS (JDBC) 发送数据时都建立连接，那么我们将比使用 SOAP 便宜得多。

希望这有一天会帮助别人；）

# c# - 触发器在应该被触发时没有被触发

> ID：13588855
> 
> 赞同：1
> 
> 时间：2012-11-27T16:38:14.590
> 
> 标签：c#, wpf

我已经为我正在工作的一些软件开发了一个动画，它可以动态地将两个对象倾斜到它们各自的边界，然后一旦被绊倒就会再次返回。我遇到的问题是应该跳闸的脚本没有被执行，我无法弄清楚为什么。

**请注意：_fg 和 _bg 值在类的顶部定义。**

```
public static void Grass(Canvas canvas, int boundry)
{
    Random random = new Random();
    foreach (FrameworkElement element in canvas.Children)
    {
        var elementName = Regex.Split(element.Name, "_");
        if (elementName[0] == "grass")
        {
            switch (elementName[1])
            {
                case "foreground":
                    _fgGrassDrn = (_fgGrassPos == 0 && _fgGrassHbd == 0) ? random.Next(0, 2) : _fgGrassDrn;
                    _fgGrassPos = (_fgGrassDrn == 0) ? _fgGrassPos + 1 : _fgGrassPos - 1;
                    _fgGrassBnd = (_fgGrassDrn == 0) ? boundry : -boundry;
                    if (_fgGrassBnd == boundry) // this is the tripwire code.
                    {
                        _fgGrassHbd = 1;
                        _fgGrassDrn = (_fgGrassDrn == 0) ? 1 : 0;
                    }
                    element.RenderTransform = new SkewTransform(_fgGrassPos, 0);
                    break;
                case "background":
                    _bgGrassDrn = (_bgGrassPos == 0 && _bgGrassHbd == 0) ? random.Next(0, 2) : _bgGrassDrn;
                    _bgGrassPos = (_bgGrassDrn == 0) ? _bgGrassPos + 1 : _bgGrassPos - 1;
                    _bgGrassBnd = (_bgGrassDrn == 0) ? boundry : -boundry;
                    if (_bgGrassBnd == boundry) // this is the tripwire code.
                    {
                        _bgGrassHbd = 1;
                        _bgGrassDrn = (_bgGrassDrn == 0) ? 1 : 0;
                    }
                    element.RenderTransform = new SkewTransform(_bgGrassPos, 0);
                    break;
            }
        }
    }
} 
```

我有一种感觉，我错过了一些非常明显的东西，但我只用 c# 编程了大约 5 天，所以请原谅 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:31:54.760

修复了问题，这确实是我的一个愚蠢的错误。我正在比较方法参数**边界**，它没有考虑草的方向，使其始终为正。

```
if (_fgGrassBnd == _fgGrassPos) {}
if (_bgGrassBnd == _bgGrassPos) {} 
```

**_fgGrassBnd**和**_bgGrassBnd**是计算出的边界（左为正，右为负），这使得该动画按预期工作。

# java - 将文件从 SD 卡移动到应用程序内部数据（存储）

> ID：13588859
> 
> 赞同：1
> 
> 时间：2012-11-27T16:38:20.917
> 
> 标签：java, android, file, move

**背景**

我需要获取以下文件并将其移动到我的应用程序内部存储中。

> *mnt/sdcard/下载*

我可以通过使用以下方法复制文件，然后从 SD 卡中删除文件来成功实现这一点。

```
writer = new BufferedWriter(new FileWriter(file));
writer.write(data);
writer.close(); 
```

复制大文件时，我需要双倍的空间（我没有）。

**问题**

是否可以“移动”文件（更改目录）而不是复制删除

**其他信息** 调查我发现的问题：

```
public boolean renameTo (File newPath) 
```

[文档](http://developer.android.com/reference/java/io/File.html#renameTo%28java.io.File%29)

> 两条路径都在同一个挂载点上。在 Android 上，应用程序在尝试在内部存储和 SD 卡之间进行复制时最有可能遇到此限制。 [引用自这里](https://www.sandersdenardi.com/moving-files-in-android/)

我不知道我是否可以在同一个挂载点上获得两条路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:58:27.240

听起来您正在处理非常大的文件，因此您可能会考虑某种渐进式缩小/增长另一种类型的操作 - 尽管大概只有当您可以检测到完整副本没有足够的空间时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:49:07.383

我之前尝试过相反的操作（SD 内部，同样的事情），复制然后删除过程是我发现唯一可以工作的过程。我想你不能只是“重命名”是有道理的，因为文件位于不同的物理存储区域（不确定这是否适用于某些 Android 设备上的某些“虚拟”SD 卡）。如果它们位于不同的存储空间，则不能只交换文件头上的指针。

# arrays - c++ 类的私有成员

> ID：13588860
> 
> 赞同：-1
> 
> 时间：2012-11-27T16:38:23.560
> 
> 标签：arrays, class, visual-c++, bitmap

我有一个问题，关于在 opengl 中渲染位图文件（手动）：如何从 unsigned char 指针获取数据以便在 glDrawPixels 函数中使用它们？（无符号字符 *bitmap_Image）

```
class bitmap
{
private:
    unsigned long BPP;
    unsigned long width;
    unsigned long height;
    unsigned long size;
    unsigned char *bitmap_Image; // how use this member??
    unsigned int bps;

public:
    bitmap();
    ~bitmap();

    bool Load(const char *filename);
    #pragma pack(push,1)

     typedef struct 
     {
     WORD bfType;
     DWORD bfSize;
     DWORD bfReserved;
     DWORD bfOffBits;
     }BITMAPFILEHEADER;

     //BITMAPINFOHEADER
     typedef struct 
     {
     DWORD biSize;
     LONG biWidth;
     LONG biHeight;
     WORD biPlanes;
     WORD biBitCount;
     DWORD biCompression;
     DWORD biSizeImage;
     LONG biXPelsPerMeter;
     LONG biYPelsPerMeter;
     DWORD biClrUsed;
     DWORD biClrImportant;
     }BITMAPINFOHEADER;

     #pragma pack(pop)

     BITMAPFILEHEADER FileHeader;
     BITMAPINFOHEADER InfoHeader;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:46:06.473

编辑：

再次阅读问题后，您必须声明一个返回内部指针 bitmap_Image 的公共成员。

```
...
public:
   const unsigned char* GetImageData() const { return bitmap_Image; }
   int GetWidth() const { return width; }
   int GetHeight() const { return heigth; }
   int GetBPP() const { return BPP; }
... 
```

围绕该领域的私密性没有其他（标准和安全）方法。

假设 BPP 是 BitsPerPixel 并且是 24 或 32，您可以调用

```
 bitmap* YourBmp = ... // construct and load

 const unsigned char* Ptr = YourBmp->GetImageData();
 int W = YourBmp->GetWidth();
 int H = YourBmp->GetHeight();
 int Fmt  = (YourBmp->GetBPP() == 24) ? GL_BGR : GL_BGRA; // or maybe GL_RGB or GL_RGBA
 int Type = GL_UNSIGNED_BYTE;
 glDrawPixels(W, H, Fmt, Type, Ptr); 
```

如果您的图像使用调色板（8 位或更少），则会出现问题 - 您必须将其转换为 RGB(A)。如果图像的单行大小不能被 4 整除，则存在另一个问题，您可能会在`bitmap_Image`字段中得到无效数组。

`glRasterPos`或`glWindowPos`将帮助您设置要渲染图像的位置。

如果您使用没有固定功能的 GL2.0+（尽管不太可能），那么您应该创建 4 顶点数组并使用简单的片段着色器渲染四边形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:46:13.580

您基本上需要将位图二进制 blob 加载到一个字节（aka. `unsigned char`）数组中，然后将其传递给您的`glDrawPixels()`函数：

```
unsigned char[] myBitmap;
...
glDrawPixels( ..., &myBitmap, ... ); 
```

# dart - dart：调试 dart 客户端和现有 rest api 的客户端/服务器通信？

> ID：13588864
> 
> 赞同：2
> 
> 时间：2012-11-27T16:38:42.707
> 
> 标签：dart, dartium, dart-editor

我有一个 rest api（在 django/python 中开发），我在本地运行并想在 dart 中开发一个简单的客户端应用程序。此客户端使用 XMLHttpRequest 与本地 django 开发服务器通信。问题是 Dart 编辑器中的默认运行配置启动它自己的 Web 服务器，而不是 dartium 或带有 dart2js 的系统浏览器。当我尝试访问我的 rest api 时，这显然会违反跨源策略。

我想知道测试客户端/服务器通信的最佳设置是什么 - 我应该将我的 rest api 配置为代理飞镖编辑器使用的 :3030 端口并使用 URL 配置启动配置，还是有办法告诉 dart 编辑器服务器发送一个“Access-Control-Allow-Origin”http 标头（这真的很酷），或者一些 chrome 启动参数来禁用 XMLHttpRequests 的跨源检查？

似乎是一个明显愚蠢的问题，但我没有找到 (dart) 文档或此处[以前的问题](https://stackoverflow.com/questions/10086215/dart-editor-breakpoints-debug-dynamic-webpage)中描述的任何解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T17:17:22.163

一旦将`Access-Control-Allow-Origin: *`标头添加到您的 REST API 的每个响应中（不要忘记`OPTIONS`请求 - 请参阅[perlight 请求](http://www.w3.org/TR/cors/#preflight-request)），您应该能够毫无问题地使用它`XMLHttpRequest`并像在同一台服务器上一样进行调试。

在开发中，您还可以使用`--disable-web-security`选项启动 Dartium（请参阅[禁用 Chrome 中的同源策略](https://stackoverflow.com/questions/3102819/chrome-disable-same-origin-policy)）

# cocoa - NSImageView 中的缩放图像在启用图层支持时看起来很糟糕

> ID：13588865
> 
> 赞同：1
> 
> 时间：2012-11-27T16:38:44.533
> 
> 标签：cocoa, core-animation, nsimageview

我想要一个带有渐变背景和图像的视图。所以我打开了图层的图层支持，添加`NSImageView`并将图层设置为`CAGradientLayer`. 然而，这使得按比例缩小的图像非常难看。看比较：

层开：![层开](../Images/afa89857fd3973ae3d93e08998c9a3fc.png)，层关：![层关闭](../Images/d55cb7bdb774122d4dc2fb895741ae3b.png)

有没有人也观察到这一点？有没有办法在不关闭图层支持的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T15:25:04.023

在遇到完全相同的问题后，我偶然发现了这个问题。图层支持的 NSImageView 的渲染看起来非常缩放，但非图层支持的渲染看起来很棒。

我尝试了许多不同的方法，但最后实际上是来自我当地 CocoaHeads 小组的人们的建议，最终导致了解决方案。

这是对我有用的代码。

```
 CGImageRef imageRef;
    NSRect     rect;

    rect      = NSZeroRect;
    rect.size = [_imageView bounds].size;

    imageRef = [image CGImageForProposedRect:&rect
                                     context:[NSGraphicsContext currentContext]
                                       hints:@{ NSImageHintInterpolation: @(NSImageInterpolationHigh)}];

    image = [[[NSImage alloc] initWithCGImage:imageRef size:rect.size] autorelease];

    [_imageView setImage:image]; 
```

起初，我只是假设插值模式是问题所在。但是，更改该值似乎并没有什么不同。关于从 NSImage->CGImage->NSImage 去的东西是什么。我讨厌提供一个我不完全理解的解决方案，但至少它是一些东西。

# javascript - Javascript 如何使用函数设置和获取间隔

> ID：13588866
> 
> 赞同：0
> 
> 时间：2012-11-27T16:38:45.713
> 
> 标签：javascript, setinterval, clearinterval

下面的代码是我正在尝试做的一个示例.. 规模较小。此代码实际上从未清除间隔，它们只是开始堆叠。谢谢！

```
<script>
var num = 0;
var counter = setInterval('start_count()',1000);

function start_count(type){
    num++;
    document.getElementById('num_div').innerHTML = num;
}
function stop_count(){
   clearInterval(counter);
   num = 0;
}
</script>
<div id="num_div"></div>
<br>
<input type="button" value="Stop" onClick="stop_count()">
<input type="button" value="Start" onClick="counter = setInterval('start_count()',1000)"> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:46:55.070

请*不要*将字符串传递给`setInterval`，JS 函数是一流的对象，因此它们可以作为参数传递，分配给变量或由其他函数返回。在您的示例中，我将编写以下内容：

```
<input type="button" value="Start" id="intervalStart"/>
<input type="button" value="Start" id="intervalStop"/> 
```

然后，JS：

```
window.onload = function()//not the best way, but just as an example
{
    var timer, num = 0, 
    numDiv = document.getElementById('num_div');//<-- only scan dom once, not on every function call
    document.getElementById('intervalStart').onclick = function(e)
    {
        this.setAttribute('disabled','disabled');//disable start btn, so it can't be clicked multiple times
        timer = setInterval(function()
        {
            numDiv.innerHTML = ++num;
        },1000);
    };
    document.getElementById('intervalStop').onclick = function(e)
    {
        document.getElementById('intervalStart').removeAttribute('disabled');//enable start again, you could do the same with disable btn, too
        clearInterval(timer);
        num = 0;
        numDiv.innerHTML = '';
    };
}; 
```

这段代码需要做更多的工作，尽管至少它不会过多地污染全局命名空间。
请注意，我使用了一个变量来引用`num_div`元素，这样您的间隔回调函数就不必每 1000 毫秒扫描整个 DOM 以查找该元素。不多，但请记住，每次使用 jQuery 选择器或`getElement(s)By*`方法时，JS*都*必须遍历 DOM 并查找元素。保留对您将需要很多元素的引用只会使脚本更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:51:35.477

我认为这段代码会做你想做的事情：

```
<script>
    var num = 0;
    var counter;

    function start_interval() {
        counter = setInterval(function () { start_count() }, 1000)        
    }

    function start_count() {
        num++;
        document.getElementById('num_div').innerHTML = num;
    }
    function stop_count() {
        clearInterval(counter);
        num = 0;
    }
</script>
<div id="num_div"></div>
<br>
<input type="button" value="Stop" onClick="stop_count();">
<input type="button" value="Start" onClick="start_interval();"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:47:30.977

不清楚到底是什么问题。您的代码工作正常（除了关于将字符串传递给 setInterval 的注释）。如果您的问题是多次点击“开始”会增加多个间隔，那么是的。您可以通过检查时钟是否已在运行来解决此问题。

这是一个例子：

```
function startCounter() {
    if (!counter) {
        counter = setInterval(start_count,1000);
    }
}

function start_count(type){
    num++;
    document.getElementById('num_div').innerHTML = num;
}

function stop_count(){
   clearInterval(counter);
   counter = 0;
   num = 0;
} 
```

这是一个[小提琴](http://jsfiddle.net/TWWEk/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:45:40.583

```
<script>
    var num = 0;
    var counter = setInterval(start_count,1000);  
    function start_count(type){     
        num++;     
        document.getElementById('num_div').innerHTML = num;
    }
    function stop_count(){    
        clearInterval(counter);    
        num = 0;
    }
</script>
<div id="num_div"></div>
<br>
<input type="button" value="Stop" onClick="stop_count()">
<input type="button" value="Start" onClick="counter = setInterval(start_count,1000)"> 
```

那是[工作版本](http://jsfiddle.net/CHZ9r/)。但正如评论中提到的，两件事之一应该传递给 a `setInterval`or `setTimeout`：

定义应该执行的代码的函数：

```
setTimeout(function(){
  /* timeout code */
}, 1000); 
```

或对您要调用的函数的引用（不包括引号）：

```
function myTimeoutFunction(){
  /* timeout code */
}
setTimeout(myTimeoutFunction, 1000); 
```

# c# - 使用 c# 和 windows phone 7 解析 xml

> ID：13588868
> 
> 赞同：0
> 
> 时间：2012-11-27T16:39:02.503
> 
> 标签：c#, xml, linq, windows-phone-7, xml-parsing

我有一个这样的xml文件：

```
 <xml>
    <students>
      <person name=jhon/>
      <person name=jack/>
      ...
    </students>
    <teachers>
       <person name="jane" />
       <person name="jane" />
       ...
    </teachers>
  </xml> 
```

如果我使用此代码：

```
var xml = XDocument.Parse(myxmlstring, LoadOptions.None);
foreach(XElement studentelement in xml.Descendants("person"))
{
    MessageBox.Show(studentelement.Attribute("name").Value);
} 
```

一切正常！但是，我不知道我是在迭代学生还是老师。

但是当我尝试时：

```
var a = xml.Element("students"); 
```

a 为空！！！

如何使用 c# 在我的 xml 文档中选择特定元素？

如果我可以先迭代学生，填充一些列表框并迭代老师并做其他事情，那就太棒了。:)

xml文件不能修改，以防万一...

最后，我真正想要的只是在我的文件中获取特定元素的所有子元素。

感谢大家！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:40:46.683

> 但是当我尝试时： var a = xml.Element("students");
> 
> a 为空！！！

是的，因为`xml`是文档，并且它下面只有*一个*直接元素 - 称为`xml`. 如果您使用：

```
var students = xml.Root.Element("students"); 
```

相反，它会`<students>`直接在根元素下方寻找，它会起作用。

或者，您可以使用`Element`两次：

```
var students = xml.Element("xml").Element("students"); 
```

或者使用`Descendants`，当然。

此外，您可以使用`Parent`属性访问元素的父元素......因此，如果您想遍历*所有* `person`元素并出于某种原因使用父元素名称，您当然可以这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:43:57.420

`Element`只返回直接子节点。要递归浏览 xml 树，请`Descendants`改用。

要依次枚举学生和教师，您可以执行以下操作：

```
var xml = XDocument.Parse(myxmlstring, LoadOptions.None);

var students = xml.Descendants("students");
var teachers = xml.Descendants("teachers");

foreach (var studentElement in students.Descendants("person"))
{
    MessageBox.Show(studentElement.Attribute("name").Value);
}

foreach (var teacherElement in teachers.Descendants("person"))
{
    MessageBox.Show(teacherElement.Attribute("name").Value);
} 
```

# sql - 更新无法编译存储过程

> ID：13588869
> 
> 赞同：0
> 
> 时间：2012-11-27T16:39:05.207
> 
> 标签：sql, oracle, plsql, oracle11g

我正在尝试将此更新语句添加到前面有几个插入语句的存储过程中。我在尝试编译时收到 ORA-00933，但没有发现任何问题。我会说我已经习惯了 SQL Server，所以如果这在翻译到 Oracle 方面有些愚蠢，请原谅我。

```
UPDATE
  APEX_QC_TLINK_AGENTS
SET
  I_FK_TLINK_TEAM = SHG_DATAW.APEX_QC_TLINK_TEAMS.I_SK_TLINK_TEAM
FROM
  SHG_DATAW.APEX_QC_TLINK_AGENTS
LEFT JOIN
  CMS_W_AGENT_DETAILS@SHG_SPECIALIST
  ON
    SHG_DATAW.APEX_QC_TLINK_AGENTS.A_FORENAME = CMS_W_AGENT_DETAILS.FIRST_NAME
    AND
    SHG_DATAW.APEX_QC_TLINK_AGENTS.A_SURNAME = CMS_W_AGENT_DETAILS.LAST_NAME
LEFT JOIN
  SHG_DATAW.APEX_QC_TLINK_TEAMS
  ON 
    CMS_W_AGENT_DETAILS.TEAM_NAME = SHG_DATAW.APEX_QC_TLINK_TEAMS.A_TEAMNAME
WHERE
  SHG_DATAW.APEX_QC_TLINK_TEAMS.I_SK_TLINK_TEAM <> APEX_QC_TLINK_AGENTS.I_FK_TEAM; 
```

如果有人需要，我可以提供（如果需要）整个存储过程。

非常感谢一如既往:)

马库斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:52:03.973

Oracle 不支持`UPDATE... FROM`SQL Server 所支持的构造。您应该改用[MERGE 语句](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_9016.htm#i2081218)。它应该是这样的：

```
MERGE INTO APEX_QC_TLINK_AGENTS A
USING
(
SELECT SHG_DATAW.APEX_QC_TLINK_TEAMS.I_SK_TLINK_TEAM
FROM
  SHG_DATAW.APEX_QC_TLINK_AGENTS
LEFT JOIN
  CMS_W_AGENT_DETAILS@SHG_SPECIALIST
  ON
    SHG_DATAW.APEX_QC_TLINK_AGENTS.A_FORENAME = CMS_W_AGENT_DETAILS.FIRST_NAME
    AND
    SHG_DATAW.APEX_QC_TLINK_AGENTS.A_SURNAME = CMS_W_AGENT_DETAILS.LAST_NAME
LEFT JOIN
  SHG_DATAW.APEX_QC_TLINK_TEAMS
  ON 
    CMS_W_AGENT_DETAILS.TEAM_NAME = SHG_DATAW.APEX_QC_TLINK_TEAMS.A_TEAMNAME

) B
ON (B.I_SK_TLINK_TEAM <> A.I_FK_TEAM)
WHEN MATCHED THEN
UPDATE SET A.I_FK_TLINK_TEAM = B.I_SK_TLINK_TEAM; 
```

# selenium - BrowserMob 代理和主机文件

> ID：13588870
> 
> 赞同：3
> 
> 时间：2012-11-27T16:39:06.787
> 
> 标签：selenium, proxy, selenium-webdriver

我正在尝试使用[BrowserMob 代理](http://opensource.webmetrics.com/browsermob-proxy/)来监视 WebDriver(Selenium) 浏览器发送的请求。

我用以下方式实例化代理：

```
 server = new ProxyServer(localProxyPort);       
    server.start(); 
```

然后我创建将使用此代理的 Firefox 配置文件：

```
 FirefoxProfile profile = new FirefoxProfile(); 

    profile.setPreference("network.proxy.type", 1);
    profile.setPreference("network.proxy.http", "localhost");
    profile.setPreference("network.proxy.http_port", localProxyPort); 
```

我的问题是我的“主机”文件中有很多不同的主机映射。BrowserMob 代理忽略系统主机文件，并尝试自行解析 ips。

有一个解决方案：

```
 server.remapHost("somehost.com", "127.0.0.1"); 
```

但我不能为每个主机都这样做。有没有办法强制代理使用我的系统主机映射？

谢谢！

莱昂蒂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T07:15:45.413

我们可以使用相同的函数重新映射多个主机：

```
server.remapHost("somehost.com", "127.0.0.1");
server.remapHost("someotherhost.com", IP Address); 
```

# json - httperf 测试一个 json rest api

> ID：13588874
> 
> 赞同：4
> 
> 时间：2012-11-27T16:39:24.267
> 
> 标签：json, rest, httperf

我有一个包含以下内容的文件：

```
helper?token=99999 method=POST contents='{"key1":99999, "key2":88888, "key3":55}' 
```

然后我运行这个命令：

```
httperf --print-reply --print-request --hog --client=0/1 --server=a_server --port=8080 --uri=/ --rate=25 --send-buffer=4096 --recv-buffer=16384 --add-header='Content-Type:application/json' --method=POST --wsesslog=1,1.000,entrada_carga 
```

但是服务器没有得到任何 json。我已经尝试了不同的转义选项但没有成功。

和 curl 的同一篇文章完美地工作。

您对使用 httperf 发布 json 有任何指示吗？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:37:11.200

您必须在标题末尾添加显式回车，如下所示：

--add-header='内容类型：应用程序/json\n'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-16T06:10:11.037

带有标题、帖子和 ssl 的示例

```
httperf --server yourhost.com.com --uri /smartlog --num-conns=500 --rate=500 --ssl  --method POST --wsesslog=100000,0,httprefpost_data.txt --add-header "sdk:3.0\nconfig:3.0\nzid:0\n" 
```

创建具有以下内容的文件（httprefpost_data.txt）：

```
/smartlog method=POST contents='data=testing&uid=13' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-14T20:44:25.860

使用以下内容将 URL 分解为服务器和 URI：

httperf --print-reply --print-request --server "hostname.com" --uri="rest of url"

# xpages - 富文本控件不存储输入内容

> ID：13588879
> 
> 赞同：1
> 
> 时间：2012-11-27T16:39:35.077
> 
> 标签：xpages

我的 XPage 有一个 RT 控件，用户可以在其中填充文本片段，并用更多文本完成内容。

“填充按钮”的eventHandler：

```
<xp:eventHandler event="onclick" submit="true" refreshMode="partial" refreshId="Body1">
    <xp:this.action><![CDATA[#{javascript:
    var mykey = getComponent("Aufgabe1").getValue();
    var bodytxt:string = @DbLookup(@DbName(), "lookupOrdertypes",mykey,4,"[FAILSILENT]");
    if (checkContent(bodytxt)) getComponent("Body1").setValue(bodytxt);
}]]></xp:this.action>
</xp:eventHandler> 
```

文本被填写，用户看到它并写了一些。最后用户提交表单： 但是在富文本字段中只保存了填写的文本片段！如果用户不使用该按钮，而只键入他的文本，则文本将正确保存。

当我将富文本控件更改为多行编辑框时，一切正常。

谢谢你的帮助

乌韦

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T07:58:28.617

问题是您没有完全刷新富文本，只有具有富文本组件 id 的文本区域。但是还有另外两个组件需要刷新：inputRichText1_mod 和 inputRichText1_h，这两个是*XspInputRichText*组件自动生成的字段。

如果您刷新周围的元素，您的代码应该可以工作：

```
<xp:div id="refreshMe">
   <xp:inputRichText id="Body1" value="#{document1.Body}"></xp:inputRichText>
</xp:div> 
```

现在刷新*div*：

```
<xp:eventHandler event="onclick" submit="true" refreshMode="partial" refreshId="refreshMe">
   <xp:this.action><![CDATA[#{javascript:
      var mykey = getComponent("Aufgabe1").getValue();
      var bodytxt:string = @DbLookup(@DbName(), "lookupOrdertypes",mykey,4,"[FAILSILENT]");
      if (checkContent(bodytxt)) getComponent("Body1").setValue(bodytxt);
   }]]></xp:this.action>
</xp:eventHandler> 
```

# jquery - 如何使用特定的 window.location.href 在 Jasmine 中测试 window.load()？

> ID：13588882
> 
> 赞同：1
> 
> 时间：2012-11-27T16:39:49.803
> 
> 标签：jquery, jasmine

我有以下代码：

```
window.onload= function() {
     var requestData = {
        bookId:$('.bookId').text()
     };
if(window.location.href.indexOf("/viewbook")!=-1){
    $.post("check-book", requestData, function (response) {
       if(response == "already saved") {
           $('.add-btn').attr('disabled', 'disabled');
       }
    });
}
}; 
```

我正在尝试在 Jasmine 中编写一个适当的测试。所以，到目前为止，我有以下代码：

```
describe("should disable button", function () {
it("should check if book exists in list while loading page", function () {
    var localContext = {
        "window":{
            location:{
                href:"/viewbook"
            }

        }
    }
    with(localContext){
        spyOn($, 'post');

        window.load();
        expect(window.location.href).toBe("/viewbook");
        //expect($.post).toHaveBeenCalled();
    }
});

}); 
```

但是当我运行它时，它给了我一个错误，即对象的负载未知。你知道如何测试吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T02:42:23.657

您已经用`window`变量中定义的副本替换了全局（我认为这有点危险）`localContext`。该变量没有`load`方法，因此调用它会给您上述错误。

更好的解决方案是创建一个命名函数并测试其内部结构，然后将该函数分配给`window.onload`，而不是尝试测试分配给全局的匿名函数`window`。

IE

```
function checkBook(){
    // Do stuff
}
window.onload = checkBook; 
```

`checkBook`然后，您可以在测试中尽可能频繁地手动运行。

# ruby-on-rails - 我有一个从 a 到 z 的字符，我需要在服务器上找到，只需单击字母表中的字母

> ID：13588885
> 
> 赞同：0
> 
> 时间：2012-11-27T16:40:04.253
> 
> 标签：ruby-on-rails, char

这是我的 index.html.erb

```
<% for char in 'A'..'Z' %>
  <a href="/pacientes?char=<%= char%>"><%= char%></a>
<% end %> 
```

这是我的控制器：

```
if params[:char].nil?
  @pacientes = Paciente.all
elsif
  @pacientes = Paciente.where("apellido1 = ?", @char = params[:char])
end

respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @pacientes }
end 
```

我需要的是，当我单击字母 A 时，所有以字母 A 开头的人，此时如果在 URL 上放置搜索的完整参数，我就可以找到他们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:48:09.250

你可以使用这个：

```
# in the controller
if params[:char].nil?
  @pacientes = Paciente.all
elsif
  @pacientes = Paciente.where("apellido1 LIKE ?", "#{params[:char]}%")
end

respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @pacientes }
end 
```

一个**较短的版本**：

```
# in the controller
@pacientes = Paciente.where("apellido1 LIKE ?", "#{params[:char]}%")

respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @pacientes }
end 
```

对于较短的版本，如果 params[:char] 为 nil，则 where 子句将返回所有记录。

# php - PHP：将 is_null() 与 !$var 或 isset($var) 一起使用

> ID：13588886
> 
> 赞同：10
> 
> 时间：2012-11-27T16:40:04.523
> 
> 标签：php

虽然我相信答案是*肯定*的，但我在遗留代码中看到了很多以下内容，我怀疑自己。我要求社区进行健全性检查。

### 旧代码

```
if (is_null($result) || !$result) { 
```

### 重构代码

```
if (!$result) { 
```

***注意：****我知道如果`$result`未设置，这将引发通知。*

### 问题

这段代码在逻辑上是等价的吗？

### 代码测试

我测试了[PHP 错误值](http://php.net/manual/en/language.types.boolean.php)的所有组合，但没有收到*Not equal for ...*。

```
$false_values = array(false, 0, 0.0, '0', '', null, array(), new stdClass());

foreach ($false_values as $var) {
    if (!$var != (is_null($var) || !$var)) {
        echo 'Not equal for: ';
        var_dump($var);
    }
} 
```

### 输出

```
$ php check.php
$ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:51:48.467

`null`变量将在布尔上下文中求值`false`。所以这些语句在逻辑上是等价的——当变量为空时，它会被`!$result`语句捕获。

用于[`empty()`](http://us1.php.net/empty)防止通知级别的警告：

```
if (!empty($result)) {
   // do something
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T16:54:55.057

是的，两个片段是等效的。[is_null](http://php.net/is_null)定义为：

> 如果 var 为 null，则返回 TRUE，否则返回 FALSE。

文档还清楚地表明，`is_null`当变量未定义时会抛出警告，就像对`$result`. 如果`$result`未设置，`is_null($result)`则为真，因此您会收到一个警告 - 与您的行为相同`!$result`。

由于 NULL 的布尔评估（不出所料）是错误的，我们可以简单地测试所有有趣的值：

```
$result  is_null($result)  !$result   is_null($result) || !$result
(unset)   true(+warn)     true(+warn)          true (+warn)
null         true            true              true
false(-y)    false           true              true
true(-ish)   false           false             false 
```

请注意，对于所有评估为假的值以及所有评估为真的值，`is_null`和的结果都是相同的。`!$result`因此，没有必要进一步区分（例如，通过测试`0`、`""`等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:56:38.667

由于[http://php.net/is_null](http://php.net/is_null)调用`is_null($var)`应该与`$var === NULL`.

在测试`!$var`值时，任何 null、空、不存在/未设置或零值都将转换为 boolean **false**和任何其他转换为 boolean **true**。

因此调用`(is_null($result) || !$result)`while`$result`将是您的任何一个`$false_values`结果：

```
false          : (is_null(false) || !false)      => (false || true) => true
0              : (is_null(0) || !0)              => (false || true) => true
0.0            : (is_null(0.0) || !0.0)          => (false || true) => true
'0'            : (is_null('0') || !'0')          => (false || true) => true
null           : (is_null(null) || !null)        => (true || true)  => true
array()        : (is_null(array()) || !array())  => (false || true) => true
new stdClass() : (is_null(new cls) || ! new cls) => (false || true) => true 
```

在您的测试`!$var`中测试应该始终`true` **是非常好的您没有得到`Not equal for`**。

如果你想避免通知，你可以使用这个测试：

```
if(isset($var) && $var) echo 'true story'; 
```

或者

```
if(!isset($var) || !$var) echo 'this happens if false or not set at all'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:54:42.663

代码在逻辑上等价于：

```
is_null(null) === true
and
!null === true 
```

是的，正如 leepowers 所说，使用`empty()`

# .htaccess - 非 www 重定向结合 https

> ID：13588892
> 
> 赞同：1
> 
> 时间：2012-11-27T16:40:34.320
> 
> 标签：.htaccess, https

我需要 2 个重定向。第一个是任何不是 https 的请求都应该是 https。第二个是任何非www都应该是www。下面，https 一个有效，但第二个无效，并且添加了原始 url。我需要这两者协同工作

```
# Redirect non https to https
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

# redirect non www to www
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L] 
```

当它们都启用时，第二个在 url 中复制 http_host 两次。

我需要的是 mysite.com 重定向到[https://www.mysite.com](https://www.mysite.com)以及[http://www.mysite.com](http://www.mysite.com)重定向到[https://www.mysite.com](https://www.mysite.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:19:42.173

更新：这在清除缓存后有效。

# mysql - MySQL 准备语句 - ？在 WHERE 子句中

> ID：13588899
> 
> 赞同：1
> 
> 时间：2012-11-27T16:41:12.860
> 
> 标签：mysql, sql

这是一件很简单的事情，但我没能在谷歌上找到答案：

```
 PREPARE stmt1 FROM 'SELECT productCode, productName

                 FROM products

                 WHERE productCode = ?'; 
```

是什么 ？在最后？“？” 不是 SQL 中的通配符，所以它是什么......

——编辑：谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:41:50.710

`?`称为参数占位符。

> 该语句可能不完整，因为在准备时未知的数据值由用作参数标记的问号字符表示。在执行语句时，您需要为语句中的每个参数提供特定的数据值。

*   [MySQL - 准备好的语句](http://khaidoan.wikidot.com/mysql-prepared-statement)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:55:15.657

`?`用作预先未知的值的占位符。

假设`?`您的语句中有两个，那么您可以通过使用索引为它们分配值来定义哪个参数将代替它们的值`?`（就像我们在 java 中所做的那样）

我用一个 Java 的例子来让你理解 PreparedStatement ：

假设我的查询是：

```
PreparedStatement ps = connection.prepareStatement(
                    `select * from employee where ename = ? and location = ?`); 
```

因此，我已经为要检查的值`ename`以及`location`在执行查询时定义了占位符。

现在我在不更改查询的情况下设置值（就像我们在 java 中一样）

```
ps.setString(1,"John");
ps.setString(2,"New York"); 
```

所以现在运行时的查询将是：

`select * from employee where ename = 'John' and location = 'New York'`

下次如果我想更改这些值，我会这样做：

```
ps.setString(1,"Williams");
ps.setString(2,"London"); 
```

所以现在我的查询将是：

`select * from employee where ename = 'Williams' and location = 'London'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:44:27.403

你在使用像 Doctrine 这样的 ORM 吗？ORM 通常使用占位符 (?) 代替值，并且仅在执行前应用它们。

# validation - 电子邮件验证错误消息 - CakePHP

> ID：13588901
> 
> 赞同：0
> 
> 时间：2012-11-27T16:41:16.590
> 
> 标签：validation, cakephp-2.1, cakephp-model

我的用户模型：

```
class User extends AppModel {
    public $validate = array(
        'username' => 'alphaNumeric',
        'password' => 'notempty',
        'confirmpassword' => 'notempty',
        'group_id' => 'notempty',
        'email' => array( 
              'rule' => 'email', 
              'message' => 'Please provide a valid email address.' 
         ),
    );
} 
```

我的用户注册视图：

```
<div class="users form">
        <?php echo $this->Form->create('User'); ?>
    <fieldset>
        <legend><?php echo __('Register User'); ?></legend>
                <?php
                        echo $this->Form->input('User.username');
                        echo $this->Form->input('User.password');
                        echo $this->Form->input('User.confirmpassword', array('type'=>'password', 'label'=>'Confirm password'));
                        echo $this->Form->input('User.group_id');
                        echo $this->Form->input('User.email');
                ?>
        </fieldset>
        <?php echo $this->Form->end(__('Submit')); ?>
</div> 
```

我在控制器中的用户注册操作：

```
public function register() {
            if ($this->request->is('post')) {
                    ...
                    //create mail for verification
                    $email = new CakeEmail();
                    ...
                    $email->to($this->data['User']['email']);
                    $email->send($ms);
            }
} 
```

访问 /users/register，当我在电子邮件字段中输入“asdfgh”之类的内容时，我收到默认的 CakePHP 错误消息：

```
Invalid email: asdfgh
Error: An Internal Error Has Occurred. 
```

而不是电子邮件字段上方的错误消息，告诉我：

```
Please provide a valid email address. 
```

我的问题：当用户的输入数据无效时，它真的应该调用控制器中的动作吗？只有当用户的输入数据有效时，有没有办法在控制器中调用操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:45:04.867

我找到了我的答案！^^

实际上，验证仅在“save()”方法之前完成，而不是在控制器中的操作调用之前完成。但我可以使用以下方法验证控制器中的用户输入：

```
if ( $this->User->validates() ) 
```

在控制器中重新制定我的用户注册操作：

```
public function register() {
            if ($this->request->is('post')) {
                    $this->User->set( $this->data );

                    if ( $this->User->validates() ) {
                            ...
                            //create mail for verification
                            $email = new CakeEmail();
                            ...
                            $email->to($this->data['User']['email']);
                            $email->send($ms);
                    }
            }
} 
```

# java - 存储和搜索大量字符串的最有效方法

> ID：13588905
> 
> 赞同：1
> 
> 时间：2012-11-27T16:41:29.243
> 
> 标签：java, android

我在我的 Android 应用程序中使用了大量的字符串，这些字符串分为三类：1 个单词字符串、2 个单词字符串、3 个单词字符串。我需要能够快速搜索这三个字符串列表，以查找与给定键的匹配项并返回与这些字符串关联的第三个值。

例如，如果我正在寻找钥匙`"New York"`并且我的清单是：

```
New York, test1
New Jersey, test2
Colorado, test3
Arkansas, test4
New York, test5 
```

搜索将返回字符串：`test1 and test5`

存储这些在安卓手机上搜索匹配最快的字符串的最佳方法是什么？

到目前为止我想到的选项是：数据库、xml、csv。还有其他选择吗？对于这种情况，最好的选择是什么？

编辑：如果我想保留项目的顺序，以便它们可以在列表中向上或向下移动，我知道 Hashmap 是无序的。数组列表会起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:44:54.057

为什么不将它们存储为键和值列表之间的映射，并使用 Android 中内置的 SQLLite 数据库将它们永久保存在那里？

因此，本质上，您将拥有以下列表，而不是您的列表：

```
New York: [test1, test5]
New Jersey: test2
Colorado: test3
Arkansas: test4 
```

保持纽约的独特性，您将更快地获得结果。在传统的数据库意义上，它将是您价值观的外键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:45:15.293

最好和最快的方法是使用数据库。使用 SQLite 在数据库中存储和搜索数据。

请参阅：http: [//developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T16:46:11.583

解析您的文件，使用`,`分隔符分割每一行。创建哈希表（的实现之一`java.util.Map`）并将解析的结果放在那里，这`New York`是一个键`test1`，`test5`等是存储在列表中的值：

`Map<String, Collection<String>> map = new HashMap<>();`

现在您可以直接访问此表，并且始终可以找到任何城市的地图。

# c# - 用于大量数据的高性能数据结构

> ID：13588906
> 
> 赞同：8
> 
> 时间：2012-11-27T16:41:36.440
> 
> 标签：c#, performance, data-structures, word-processor

我正在为大型文档开发 .NET 版本的“文字处理器”控件 - 大意味着打印时最多 10000 页。

几年前，我用 Win32 实现了该功能，使用数组来保存行指针，根据需要以块的形式增长数组并调用 RtlMoveMemory (kernel32.dll) 来移动指针。

主要的性能问题是

*   文档按从第 1 行到最后一行的顺序加载...
*   鼠标移动需要通过它从文档顶部的“像素”偏移量找到一条线来调整鼠标光标。
*   绘画需要通过它的偏移量找到一条线并遍历下一行
*   插入和删除不能花费时间（自动换行）

我读过很多关于

*   SortedList：加载速度非常快，但是插入呢？
*   SplayTree：听起来不错，因为用户在同一行上移动了很多鼠标，但是从文档的底部滚动到中间呢？
*   SkipList：听起来整体表现不错，但数据量大时存在内存问题？
*   SortedDictionary 和 AVL 树：因加载缓慢而被取消资格。
*   红黑树：没有最好的，但没有最差的？这是最好的选择吗？

这些结构是否能够在一百万个条目中表现良好？如果是这样，最好的选择是什么？

我可能错过了其他想法/课程。

如果可能，我想坚持使用托管代码，但如果需要，我准备切换到脏代码。

# python - 在 Tkinter 中动态更改小部件背景颜色

> ID：13588908
> 
> 赞同：9
> 
> 时间：2012-11-27T16:41:43.967
> 
> 标签：python, tkinter

我有一个简单的 tkinter 窗口。它由一个小窗口、一个计时器和一个设置计时器的按钮组成。我不想详细介绍代码。

我想更改窗口中所有小部件的背景（按钮、标签等）。

我的第一个想法是使用我将设置的全局变量`"red"`，并将所有小部件`background`选项与全局变量相关联。然后，在按下按钮时，我将全局变量更改为`"green"`（以便所有小部件的背景发生变化）但没有任何反应。

我的理解是*更新*窗口的`.mainloop()`那种。**当我的变量更改而不**重新启动我的应用程序时，如何让小部件更改背景颜色？

 **** * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T17:02:26.727

从我的第一印象来看，我认为这应该是您正在寻找的，作为一个简单的例子

```
from Tkinter import *

root = Tk()
global colour
global colourselection 
global count 
colour = ""
colourselection= ['red', 'blue']
count = 1

def start(parent):
    Tk.after(parent, 1000, change)

def change():
    global colour 
    global colourselection
    global count 
    if (count < 2 ):
        colour = colourselection[count]
        button.configure(bg = colour)
        count + 1
    else:
        colour = colourselection[count]
        button.configure(bg = colour)
        count = 1 
    start(root)

button = Button(text = 'start', command = lambda: start(root))
button.pack()

root.mainloop() 
```

我相信你可以解决任何问题，它没有经过测试

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T18:14:58.927

背景颜色不会自动改变。Tkinter 有能力用字体而不是颜色来做这样的事情。

您将不得不编写一些代码来遍历所有小部件并更改它们的背景颜色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-20T13:34:05.933

（我在类似问题上发布了这个答案，我认为这也适用于这种情况：）

对于我的生活，我无法仅使用 configure 方法让它工作。最终起作用的是将所需的颜色（在我的情况下为按钮）设置为`StringVar()`（直接设置为`get()`），然后也使用按钮上的配置。

我为我最需要的用例写了一个非常通用的示例（这是很多按钮，我需要引用它们（在 Python 2 和 3 中测试）：

蟒蛇 3：

```
import tkinter as tk 
```

蟒蛇2：

```
import Tkinter as tk 
```

代码

```
root = tk.Tk()
parent = tk.Frame(root)

buttonNames = ['numberOne','numberTwo','happyButton']
buttonDic = {}
buttonColors = {}

def change_color(name):
    buttonColors[name].set("red")
    buttonDic[name].config(background=buttonColors[name].get())

for name in buttonNames:
    buttonColors[name] = tk.StringVar()
    buttonColors[name].set("blue")
    buttonDic[name] = tk.Button(
            parent,
            text = name,
            width = 20,
            background = buttonColors[name].get(),
            command= lambda passName=name: change_color(passName)
            )

parent.grid(row=0,column=0)
for i,name in enumerate(buttonNames):
    buttonDic[name].grid(row=i,column=0)

root.mainloop() 
```***

# javascript - AJAX如何为出现的元素设置动画

> ID：13588915
> 
> 赞同：0
> 
> 时间：2012-11-27T16:42:01.133
> 
> 标签：javascript, html, ajax

元素出现后如何设置动画？（以便其他具有相同属性的人保持冷静。）我正在尝试这样做：

```
 $.each(data, function(i, obj) {
            if(obj['Ping'] == "FALSE"){
                out = "<li class='red'>"+obj.Vardas+" is down..."+obj.Data+"</li>";
                /////animation, once the element gets generated
                $(out).prependTo('#database').animate({fontColor:"red", 1000});
                out ="";
            }else{
                out = "<li>"+obj.Vardas+" is up......."+obj.Data+"</li>";
                $(out).prependTo('#database');
                out ="";    
            }
        });

    });
});
</script>
</head>

<body>
    <div style="float:right; overflow-y:scroll; height: 400px; width: 50%">
        <ul id ='database'></ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:10:43.480

jQuery 不能为动画使用颜色。但是对于这样的事情，你可以使用 jQuery Color 插件（[https://github.com/jquery/jquery-color](https://github.com/jquery/jquery-color)）。

这是不透明闪烁的小型工作示例：

```
<head>
  <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
  <script>

    var t = function(){
        for(var i = 0; i < 5; i++){
            $("<li>ata" + i + "tata</li>").prependTo($("ul")).animate({opacity: 0.10}, 200).animate({opacity: 1}, 200);
        }
    }

    $(function(){
        setInterval(t, 1000);
    });

  </script>
</head>

<body>
    <ul> </ul>
</body>
</html> 
```

# php - 返回 false 不允许回显

> ID：13588916
> 
> 赞同：0
> 
> 时间：2012-11-27T16:42:05.173
> 
> 标签：php

以下是我的代码，其中我只面临一个困难，当我运行以下脚本时，由于比较失败，$flag 没有回显，请让我知道如何解决这个问题？

```
$s = "iph4on comes";
$se = "4gb comes in iphone";
$f = 0;

$tf = explode(" ",$searching);
$ms= explode(" ",$search_in);
foreach($tf as $word)
{
if (!preg_match("/$word/i", $search_in))
//if (!strpos($search_in, $word));
return false;
}
{
$f = 1;
}
echo $f;

//Due to return flase above i am not echoing
echo "Comparison Failed"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:44:15.473

`return`终止当前执行的代码块并“返回”到调用该代码的任何内容。如果您在代码的顶层执行 return，它本质上是一个`exit()`调用，并且您的 echo 将永远无法到达。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:47:08.303

你需要`echo`把`return`. `return`将执行返回给调用函数，因此之后的任何代码都不会被执行。

```
 if (!preg_match("/$word/i", $search_in)) {
  $flag = 1;
  echo $flag;
  echo "Comparison Failed"; 
  return false;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:44:47.720

为什么不在`echo $flag`return 语句之前放一个？

```
if (!preg_match("/$word/i", $search_in)){
  echo $flag
  return false;
} 
```

# android - 更新对话框

> ID：13588919
> 
> 赞同：0
> 
> 时间：2012-11-27T16:42:20.070
> 
> 标签：android, datepickerdialog

我的 Activity 上有一个 TextView，用于显示日期。当用户单击 TextView 时，我会像这样启动 DatePickerDialog：

```
public void onClick(View v) {
    if (v.getId() == R.id.date_wrapper) {
        showDialog(DATE_DIALOG_ID);
    }
}

@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DATE_DIALOG_ID:
       GregorianCalendar date = new GregorianCalendar();

       if (mData != null) {
           date.setTimeInMillis(mData.getDate());
       }

       return new DatePickerDialog(this, datePickerListener, date.get(Calendar.YEAR), date.get(Calendar.MONTH), date.get(Calendar.DAY_OF_MONTH));
    }

    return null;
}

private DatePickerDialog.OnDateSetListener datePickerListener = new DatePickerDialog.OnDateSetListener() {

    // when dialog box is closed, below method will be called.
    public void onDateSet(DatePicker view, int selectedYear, int selectedMonth, int selectedDay) {

        GregorianCalendar selectedDate = new GregorianCalendar();
        selectedDate.set(Calendar.YEAR, selectedYear);
        selectedDate.set(Calendar.MONTH, selectedMonth);
        selectedDate.set(Calendar.DAY_OF_MONTH, selectedDay);

        mData.setDate(selectedDate.getTimeInMillis());

        populateDate();
    }
}; 
```

这很好用。但是，当用户单击提交按钮时，我想将日期设置回今天。我可以轻松地将 mData 对象的 Date 变量设置为今天。但是，我不确定如何更新 DatePickerDialog。它已经创建，因此单击 TextView 不会再次运行 onCreateDialog。因此，当我单击 TextView 时，DatePickerDialog 打开，这是我选择的最后一个日期。

如何引用 DatePickerDialog 来更新日期？杀死 DatePickerDialog 也是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:45:23.690

我找到了一个可以接受的解决方案。

当我重置日期时，我还应该调用`removeDialog(DATE_DIALOG_ID);`销毁对话框。下一次`showDialog(DATE_DIALOG_ID);`被调用，它将被重新创建。

# python - 停止 matplotlib 在图例中重复标签

> ID：13588920
> 
> 赞同：88
> 
> 时间：2012-11-27T16:42:24.563
> 
> 标签：python, matplotlib, legend

这是一个非常简化的示例：

```
xvalues = [2,3,4,6]

for x in xvalues:
    plt.axvline(x,color='b',label='xvalues')

plt.legend() 
```

[![在此处输入图像描述](../Images/e51bdb610870bd440412c1117c7c8722.png)](https://i.stack.imgur.com/aO6jN.png)

图例现在将在图例中将“xvalues”显示为蓝线 4 次。有没有比以下更优雅的方法来解决这个问题？

```
for i,x in enumerate(xvalues):
    if not i:
        plt.axvline(x,color='b',label='xvalues')
    else:
        plt.axvline(x,color='b') 
```

[![在此处输入图像描述](../Images/0316af8ef707ca97c5d855b04835cb7a.png)](https://i.stack.imgur.com/o535X.png)

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-11-27T16:53:49.217

`plt.legend`作为参数

1.  `Artist`作为对象的轴手柄列表
2.  字符串标签列表

这些参数都是可选的，默认为`plt.gca().get_legend_handles_labels()`. 您可以在调用`legend`. 这是因为 dicts 不能有重复的键。

例如：

## 对于 Python 版本 < 3.7

```
from collections import OrderedDict
import matplotlib.pyplot as plt

handles, labels = plt.gca().get_legend_handles_labels()
by_label = OrderedDict(zip(labels, handles))
plt.legend(by_label.values(), by_label.keys()) 
```

## 对于 Python 版本 > 3.7

从 Python 3.7 开始，字典默认保留输入顺序。因此，不需要`OrderedDict`形成集合模块。

```
import matplotlib.pyplot as plt

handles, labels = plt.gca().get_legend_handles_labels()
by_label = dict(zip(labels, handles))
plt.legend(by_label.values(), by_label.keys()) 
```

[![在此处输入图像描述](../Images/2ccbb39135b79396156e0e21ae2b3c52.png)](https://i.stack.imgur.com/ER46N.png)

[文档](https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.legend.html)_`plt.legend`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-10-24T14:54:02.807

```
handles, labels = ax.get_legend_handles_labels()
handle_list, label_list = [], []
for handle, label in zip(handles, labels):
    if label not in label_list:
        handle_list.append(handle)
        label_list.append(label)
plt.legend(handle_list, label_list) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-12-19T17:56:00.997

我不知道这是否可以被认为是“优雅的”，但是您可以将标签设置为`"_nolegend_"`第一次使用后设置的变量：

```
my_label = "xvalues"
xvalues = [2,3,4,6]

for x in xvalues:
    plt.axvline(x, color='b', label=my_label)
    my_label = "_nolegend_"

plt.legend() 
```

如果您必须放置多个标签，则可以使用标签字典对其进行概括：

```
my_labels = {"x1" : "x1values", "x2" : "x2values"}
x1values = [1, 3, 5]
x2values = [2, 4, 6]

for x in x1values:
    plt.axvline(x, color='b', label=my_labels["x1"])
    my_labels["x1"] = "_nolegend_"
for x in x2values:
    plt.axvline(x, color='r', label=my_labels["x2"])
    my_labels["x2"] = "_nolegend_"

plt.legend() 
```

[![带有 2 个不同标签的图](../Images/f00531e00aa33ba36a08c5ddc6465414.png)](https://i.stack.imgur.com/tXGJQ.png)

（答案灵感来自[https://stackoverflow.com/a/19386045/1878788](https://stackoverflow.com/a/19386045/1878788)）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-08-21T22:50:26.747

# 问题 - 3D 阵列

问题：[2012 年 11 月](https://stackoverflow.com/q/13588920/10450752)， 2013 年[10 月](https://stackoverflow.com/q/19385639/10450752)

```
import numpy as np
a = np.random.random((2, 100, 4))
b = np.random.random((2, 100, 4))
c = np.random.random((2, 100, 4)) 
```

# 解决方案 - dict 唯一性

对于我的情况`_nolegend_`（[bli](https://stackoverflow.com/a/41228380/10450752)和[DSM](https://stackoverflow.com/a/19386045/10450752)）不起作用，也不会`label if i==0`。 [ecatmur](https://stackoverflow.com/a/13589144/10450752)的答案使用`get_legend_handles_labels`并减少了传说`collections.OrderedDict`。 [Fons](https://stackoverflow.com/a/56253636/10450752)演示了这在没有导入的情况下是可能的。

根据这些答案，我建议使用`dict`独特的标签。

```
# Step-by-step
ax = plt.gca()                      # Get the axes you need
a = ax.get_legend_handles_labels()  # a = [(h1 ... h2) (l1 ... l2)]  non unique
b = {l:h for h,l in zip(*a)}        # b = {l1:h1, l2:h2}             unique
c = [*zip(*b.items())]              # c = [(l1 l2) (h1 h2)]
d = c[::-1]                         # d = [(h1 h2) (l1 l2)]
plt.legend(*d) 
```

或者

```
plt.legend(*[*zip(*{l:h for h,l in zip(*ax.get_legend_handles_labels())}.items())][::-1]) 
```

可能不如[Matthew Bourque](https://stackoverflow.com/questions/13588920/stop-matplotlib-repeating-labels-in-legend/26550501#26550501)的解决方案清晰易记。 *代码高尔夫欢迎。*

# 例子

```
import numpy as np
a = np.random.random((2, 100, 4))
b = np.random.random((2, 100, 4))

import matplotlib.pyplot as plt
fig, ax = plt.subplots(1)
ax.plot(*a, 'C0', label='a')
ax.plot(*b, 'C1', label='b')

ax.legend(*[*zip(*{l:h for h,l in zip(*ax.get_legend_handles_labels())}.items())][::-1])
# ax.legend()   # Old,  ^ New

plt.show() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-23T02:19:12.237

Based on answer [https://stackoverflow.com/a/13589144/9132798](https://stackoverflow.com/a/13589144/9132798) and [https://stackoverflow.com/a/19386045/9132798](https://stackoverflow.com/a/19386045/9132798) `plt.gca().get_legend_handles_labels()[1]` gives a list of names, it is possible to check if the label is already in the list while in the loop plotting (`label= name[i] if name[i] not in plt.gca().get_legend_handles_labels()[1] else ''`). For the given example this solution would look like:

```
import matplotlib.pyplot as plt

xvalues = [2,3,4,6]

for x in xvalues:
    plt.axvline(x,color='b',\
    label= 'xvalues' if 'xvalues' \
            not in plt.gca().get_legend_handles_labels()[1] else '')

plt.legend() 
```

Which is much shorter than [https://stackoverflow.com/a/13589144/9132798](https://stackoverflow.com/a/13589144/9132798) and more flexible than [https://stackoverflow.com/a/19386045/9132798](https://stackoverflow.com/a/19386045/9132798) as it could be use for any kind of loop any plot function in the loop individually. However, for many cycles it probably slower than [https://stackoverflow.com/a/13589144/9132798](https://stackoverflow.com/a/13589144/9132798).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-21T00:29:13.273

这些代码片段对我个人不起作用。我正在用两种不同的颜色绘制两个不同的组。当我只想看到每种颜色一个时，图例将显示两个红色标记和两个蓝色标记。我将粘贴对我有用的简化版本：

### 导入语句

```
import matplotlib.pyplot as plt

from matplotlib.legend_handler import HandlerLine2D 
```

### 绘制数据

```
points_grp, = plt.plot(x[grp_idx], y[grp_idx], color=c.c[1], marker=m, ms=4, lw=0, label=leglab[1])        
points_ctrl, = plt.plot(x[ctrl_idx], y[ctrl_idx], color=c.c[0], marker=m, ms=4, lw=0, label=leglab[0]) 
```

### 添加图例

```
points_dict = {points_grp: HandlerLine2D(numpoints=1),points_ctrl: HandlerLine2D(numpoints=1)}
leg = ax.legend(fontsize=12, loc='upper left', bbox_to_anchor=(1, 1.03),handler_map=points_dict) 
```

# android - SQLite 保存一对多

> ID：13588921
> 
> 赞同：0
> 
> 时间：2012-11-27T16:42:29.863
> 
> 标签：android, one-to-many, ormlite

假设以下数据结构。

```
 @DatabaseTable
    public class Parent {

      @DatabaseField(generatedId=true)
      public int id;

      @DatabaseField
      public String name;

      @ForeignCollectionField
      public ForeignCollection<Child> child;
    }

    and the following Child Class.

    @DatabaseTable
    public class Child {

      @DatabaseField(generatedId=true)
      public int id;

      @DatabaseField
      public String name;

      @DatabaseField(foreign = true, foreignAutoRefresh = true)
      public Parent parent;
    } 
```

当我想保存数据时，我有两个孩子的父母。

如果我执行以下操作：

```
 parentDao.create(parent); 
```

我有 Id 的父母和 null parent_id 的孩子

如果我做

```
 childDao.create(child);
 parentDao.create(parent); 
```

我有一个 parent_id 为 null 的孩子和 parent_id 相同的孩子。

是否有可能以某种方式保存这个结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T01:49:04.210

正确的做法是首先创建*对象*`parent`，以便[ORMLite](http://ormlite.com/)可以分配自动创建的 ID。然后在使用. _ _ 所以像：*`parent``child``parent``child``childDao`*

 *```
parentDao.create(parent);
child.parent = parent;
childDao.create(child); 
```

您还可以使用[foreignautocreate](http://ormlite.com/docs/foreign-auto-create)如果它没有设置 ID，它将自动创建父级。*

# cakephp - Cakephp PubNub 教程

> ID：13588928
> 
> 赞同：0
> 
> 时间：2012-11-27T16:43:08.077
> 
> 标签：cakephp, geolocation, pubnub

我想在我的 cakephp 应用程序中使用 PubNub 的 api，但我找不到任何用于 pubnub 的 cakephp 插件。本质上，我想使用 pubnub api 使用 google maps geolocation api 传递有关用户地理位置的实时消息。是否有关于如何将 pubnub 与 cakephp 应用程序集成的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:47:20.387

我认为 CakePHP 没有 PubNub 插件。看起来有人对此有想法，但尚未开发： [https ://github.com/siran/pubnub](https://github.com/siran/pubnub)

我个人对 PubNub 了解不多，但如果您使用的是 PHP API，那么我想您应该下载它 - [https://github.com/pubnub/pubnub-api/tree/master/php/3.3](https://github.com/pubnub/pubnub-api/tree/master/php/3.3) - 进入您的应用程序中的供应商目录（例如`app/Vendor/PubNub`）并开始在您需要它的 Cake 应用程序中使用它。您可能必须编写自己的 Cake 代码或类来帮助更轻松地使用 API 并使您的代码更可重用，但我真的不能就此提出建议。

但是，看起来最流行的选项是 JavaScript API，您实际上并不需要与 CakePHP 进行任何特殊集成。如果您在应用程序的任何地方都使用 PubNub 脚本，您只需在视图或布局中包含它：

[http://www.pubnub.com/account-javascript-api-include](http://www.pubnub.com/account-javascript-api-include)

# jquery - 使用 jQuery/JavaScript 压缩和解压缩数据？

> ID：13588929
> 
> 赞同：1
> 
> 时间：2012-11-27T16:43:13.843
> 
> 标签：jquery, cordova, jquery-mobile, compression

我正在开发一个使用 jQuery 和 jQuery Mobile 的 PhoneGap 应用程序。我需要一种以某种方式压缩数据（用于本地存储）并使用 JavaScript/jQuery 解压缩数据的方法。到目前为止，我唯一看到的是 jSEND，但据我所知，它只压缩数据，而 PHP 对应方负责解压缩。我需要的是本地压缩/解压缩操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:28:18.207

目前没有 phonegap 压缩库/插件。这将是一个很好的解决方案，不幸的是它也将依赖于平台。

仍然有用于 zip 压缩的 javascript 解决方案：http: [//stuartk.com/jszip/](http://stuartk.com/jszip/)

考虑到这一点，您可以将其作为 BASE64 字符串发送/上传。

# asp.net - WebClient.DownloadString 似乎从外部站点更改了一些 html

> ID：13588932
> 
> 赞同：1
> 
> 时间：2012-11-27T16:43:21.460
> 
> 标签：asp.net, html, webclient

我有一个 ASP.NET 网站 (.aspx)，我从 ASP.NET MVC 4 移动网站 (.cshtml) 中调用它以获取其 html 响应字符串。这两个站点都托管在 Windows Server 2008 R2 系统上。它们是使用 VS2010 Professional 创建和发布的。

- 如果我直接访问外部站点并查看源代码，那么它是正确的。

- 如果我使用以下任何一种方式获取外部 html：

```
 using (WebClient client = new WebClient())
     {
         html = client.DownloadString(strUrl);
     } 
```

或者

```
 using (WebClient client = new WebClient())
     { 
        byte[] DataBuffer = client.DownloadData(strUrl);
        html = Encoding.ASCII.GetString(DataBuffer);
     } 
```

或者

```
WebResponse objResponse;
WebRequest objRequest = System.Net.HttpWebRequest.Create(strUrl);
objResponse = objRequest.GetResponse();
using (StreamReader sr = new StreamReader(objResponse.GetResponseStream()))
{
   html = sr.ReadToEnd();
   sr.Close();
} 
```

然后 html 从此更改（其中 font-family 设置在父表上）：

```
<td align="right" style="color:Red;background-color:White;width:4.375em;border-bottom:1px solid black;border-right:1px solid black;">-27.0%</td> 
```

对此：

```
<td align="right" bgcolor="White" style="border-bottom:1px solid black;border-right:1px solid black;"><font face="Arial,sans-serif" color="Red">-27.0%</font></td> 
```

除了字体样式更改为标签、背景颜色从样式更改为标签属性以及宽度样式被完全删除之外，我看起来没有其他任何更改。这发生在整个页面上。如果我在 html 变量上放置一个断点并查看它，那么在调用 DownloadString 时 html 已经被更改。

有谁知道为什么会这样？

提前致谢。

编辑：此链接：[WebClient.DownloadString() Not Producing Exact HTML](https://stackoverflow.com/questions/2877286/webclient-downloadstring-not-producing-exact-html?rq=1) 与我不在外部页面上使用 Ajax 或 JavaScript 并不完全相同。

编辑：这是来自提琴手的请求标头和调用另一个站点的站点（我使用了 Chrome）：

```
GET / HTTP/1.1
Connection: keep-alive
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: .ASPXBrowserOverride=Mozilla%2f4.0+(compatible%3b+MSIE+6.0%3b+Windows+CE%3b+IEMobile+8.12%3b+MSIEMobile+6.0); 
```

直接访问该站点我得到这个请求标头：

```
Connection: keep-alive
Cache-Control: max-age=0
User-Agent: Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: .ASPXBrowserOverride=Mozilla%2f4.0+(compatible%3b+MSIE+6.0%3b+Windows+CE%3b+IEMobile+8.12%3b+MSIEMobile+6.0); 
```

编辑：

如果我在调试模式下查看客户端对象 client.Headers 在调用 DownloadString 之前和之后为空。此外，在此处调用 DownloadString 之后是 client.ResponseHeaders：

```
{Content-Length: 267123
Cache-Control: private
Content-Type: text/html; charset=utf-8
Date: Tue, 27 Nov 2012 18:37:27 GMT
Set-Cookie: ASP.NET_SessionId=******; path=/; HttpOnly
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
} 
```

解决方案：

不幸的是，我不能接受两个答案。Icarus 和 James Lawruk 的回答都帮助我解决了这个问题。我正在根据最近引导我找到最终解决方案的内容来选择答案。所以感谢你们俩！

因此，简而言之，这是解决方案：

使用 fiddler 查看请求标头并找到用户代理。修改代码如下：

```
using (WebClient client = new WebClient())
     {
         client.Headers.Add("user-agent", "Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11");
         html = client.DownloadString(strUrl);
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T18:47:17.497

尝试设置用户代理值并尝试使用不同的浏览器。这可能证明网站正在根据用户代理标头切换 HTML 响应。

```
webClient.Headers.Add("user-agent", "Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5");
var iphoneHtml = webClient.DownloadString("http://www.yoursite.com");
webClient.Headers.Add("user-agent", "Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11");
var safariHtml = webClient.DownloadString("http://www.yoursite.com"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:24:05.780

正如 Dour 在他的评论中指出的那样，很可能是浏览器嗅探，因为`WebClient`根本不会改变生成的 HTML。

如果您使用 Fiddler 并以完全相同的方式设置请求标头，您可能可以验证这`WebClient`一点。我打赌你会得到相同的 HTML 输出。

# django - Django 将 JSON 传递给 Simile Timeline

> ID：13588934
> 
> 赞同：1
> 
> 时间：2012-11-27T16:43:29.787
> 
> 标签：django, json, simile

我认为这与使用时间轴的关系不大，而与我构建 JSON 对象的方式有关。

我有一个包含 Simile Timeline 小部件的模板。一切都很好当数据被硬编码到模板中时，但这并不好玩......

以下是我构建 JSON 事件并将其传递给视图的方式。

## 看法

```
def load_timeline_events(request):
  raw_events = [{
      "title" : "Data",
      "color" :"red",
      "start" : "0020-01-01",
      "end" : "0022-01-01",
      "description" : "20 - 22"
    },
    {
      "title" : "Log",
      "color" :"blue",
      "start" : "0002-01-01",
      "end" : "0016-01-01",
      "description" : "2 - 16"
    }]
return render('timeline.html', {'EVENTS':json.dumps(raw_events)}) 
```

## 模板

```
load_events : function() {
    timeline.events.loadJSON({
        "events" : {{ EVENTS }},
        "dateTimeFormat" : "iso8601"
    }, timeline.base_uri);
}, 
```

没有返回错误，只是一个空白的时间线框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T19:39:49.780

在将字典传递给模板之前需要转换为 SafeString。无需使用*json*模块。

与此处发现的问题相同：[在 django 模板中使用 JSON](https://stackoverflow.com/questions/6286192/using-json-in-django-template)

## 看法

```
from django.utils.safestring import SafeString
...
def load_timeline_events(request):
    ....
    return render('timeline.html', {'EVENTS':SafeString(raw_events)}) 
```

# html - PhoneGap Android - html5 缓存远程资源（html、js、css 等）

> ID：13588935
> 
> 赞同：4
> 
> 时间：2012-11-27T16:43:39.573
> 
> 标签：html, cordova, cache-manifest

我已经成功创建了一个 android phonegap 项目，并且能够加载远程 Web 应用程序。

关键是，我需要在设备上缓存远程资源，以便我的 phonegap 应用程序在设备没有连接时可以工作。

如果从台式电脑访问网络，缓存清单工作正常。

我需要缓存远程资源，而不是将它们与我的 apk 一起包含在 assets 文件夹中（由于客户要求，我不想每次单个 javascript/html 文件更改时都必须大量分发新的 apk）。

有没有办法做到这一点？谢谢。

**编辑：**找到答案：检查这些链接：

[HTML5 中的应用程序缓存在 Android PhoneGap 应用程序中不起作用](https://stackoverflow.com/questions/12709673/application-cache-in-html5-doesnt-work-in-android-phonegap-application/12710632#12710632)

[http://tmkmobile.wordpress.com/tag/phonegap/](http://tmkmobile.wordpress.com/tag/phonegap/)

# wcf - 使用 WCF（异步）的 Silverlight Dispose 模式

> ID：13588937
> 
> 赞同：1
> 
> 时间：2012-11-27T16:43:43.143
> 
> 标签：wcf, silverlight, dispose, channel, stateful

我对 Silverlight 有点陌生，我想知道如何处理 WCF 服务的故障/处置。

我已经习惯了这样的事情（[wcf abort/close 模式](http://www.codeproject.com/Tips/197531/Do-not-use-using-for-WCF-Clients)），你在 try/catch 中调用服务（确保你关闭或中止）。（在无状态应用程序中运行良好）

研究 Silverlight，我们在哪里应用中止/关闭模式？因为服务调用是异步的并且应用程序状态已满。

目前我唯一能想到的是某种动态代理（使用类似 Castle DP 的东西）以及来自[n 层应用程序的 ChannelFactoryManager，大约在页面](http://www.codeproject.com/Articles/474212/Zombie-Explorer-A-N-Tier-application-from-top-to-b)示例的 1/2 处。代理将确保始终有一个开放的通道，并且 ChannelFactoryManager 将处理故障

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:30:04.730

由于 Silverlight 网络环境的异步特性，我建议您构建更多可测试的 ServiceAgent - 围绕 Silverlight 的客户端代理的长期单例包装器，并带有服务方法的回调。您可以在调用服务方法或使用通道故障事件之前检查真实代理状态（并在需要时重新创建）。例如：

```
public void GetOptionsAsync(Action<GetOptionsCompletedEventArgs> callback)
{
    try
    {
        CheckProxy();

        EventHandler<GetOptionsCompletedEventArgs> handler = null;

        handler = (sender, args) =>
        {
           Proxy.GetOptionsCompleted -= handler;
           if (args.Error != null)
           {
               //...
           }
           if (callback != null)
           {
               callback(args);
           }
        };

        Proxy.GetOptionsCompleted += handler;

        Proxy.GetOptionsAsync();
    }
    catch (Exception unknownException)
    {
       //...
       throw;
    }
}

public override void ResetProxy() //AbortProxy/CloseProxy
{
    if (Proxy != null)
    {
        try
        {
            Proxy.CloseProxy(); //extension method to handle exception while closing
        }
        catch (Exception unknownException) //CommunicationObjectFaultedException
        {
            //...
            Proxy.Abort();
        }               
    }

    CreateProxy();          
}

public override void CheckProxy()
{
    if (Proxy == null || (Proxy.State != CommunicationState.Opened && Proxy.State != CommunicationState.Created))
    {               
        ResetProxy();
    }
}

public override void CreateProxy() //RecreateProxy
{           
     Proxy = new WcfClient();

     Proxy.InnerChannel.Faulted += OnChannelFaulted;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T14:43:32.170

使用 Castle DP 和 ChannelFactoryManager 的解决方案在此处实现和详细说明：

[http://www.codeproject.com/Articles/502121/WCF-in-a-stateful-application-WPF-Silverlight](http://www.codeproject.com/Articles/502121/WCF-in-a-stateful-application-WPF-Silverlight)

# sharepoint - 以编程方式在文档库中搜索特定文档

> ID：13588939
> 
> 赞同：2
> 
> 时间：2012-11-27T16:43:48.013
> 
> 标签：sharepoint, search, sharepoint-2010, sharepointdocumentlibrary

我正在尝试在文档库中搜索特定文档。我对 sharepoint 还很陌生，无法弄清楚如何检索文档。

下面是我的代码：

```
private void button12_Click(object sender, EventArgs e)
{
  using (var site = new SPSite(SiteUrl))
  {
    if (SiteUrl != null)
    {
      using (SPWeb web = site.OpenWeb())
      {
        SPList list = web.Lists["Documents"];

        if (list != null)
        {
          foreach (SPListItem item in list.Items)
          {
            if (item.Name.Any() == textBox1.ToString().Any())
              listBox1.Items.Add("Document Found");
            else
              listBox1.Items.Add("Cannot Find Document");
          }
          web.Close();
        }
        site.Close();
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T10:45:13.017

尝试这个

```
 using (var site = new SPSite(SiteUrl))
        {
            if (SiteUrl != null)
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPList list = web.Lists["Shared Documents"];

                    if (list != null)
                    {
                        int i = 1;
                        foreach (SPListItem item in list.Items)
                        {

                            if (item["Name"].ToString() == TextBox1.Text)
                            {
                                Label1.Text = "Document Found";
                                break;
                            }
                            else if (list.Items.Count == i)
                            {
                                Label1.Text = "Cannot Find Document";
                            }
                            i++;
                        }
                        web.Close();
                    }
                    site.Close();
                }
            }
        } 
```

# java - javac 1.6 和 javac 1.7 处理特殊字符时的不同行为

> ID：13588940
> 
> 赞同：5
> 
> 时间：2012-11-27T16:43:51.747
> 
> 标签：java, encoding, java-7

首先，我要感谢您，并明确表示我已经在这个问题上猛烈抨击了几天，并在其他类似线程中寻找解决方案，但没有成功。

我们的应用程序负责生成 java 类，其中一些可能在类名（因此是文件名）中包含特殊字符，例如 ZoneRéservée435.java 强制编码为 UTF-8。

直到 Java 1.6 的 ant 任务：

```
<javac source="1.5" target="1.5" srcdir="${src.dir}" destdir="${classes.dir}" deprecation="on" debug="on" classpathref="classpath" fork="false" memoryMaximumSize="512m" encoding="UTF-8"> 
```

工作正常。

移至 java 1.7 时，文件名未使用 UTF-8 编码保存，导致文件名类似于：ZoneRe?serve?e435.java

环顾四周，我了解到我需要将环境变量 LC_CTYPE 设置为 UTF-8。这解决了文件名问题，但我仍然收到编译错误

```
error: class ZoneRéservée435 is public, should be declared in a file named ZoneRéservée435.java 
```

尽管它们具有相同的名称，但它们似乎以两种不同的方式进行编码。有趣的是，这种编码差异发生在 java 1.6 上，但编译得很好。

有没有人有任何建议或想法？

据我了解，编码问题与使用以下内容生成类的事实有关：

```
 Writer out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(file), Charset.forName("UTF-8"))); 
```

*   文件内的代码使用 U+00E9 定义特殊字符；
*   文件名使用eU+0301；

关于如何处理这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T20:33:41.520

似乎您的文件系统使用了字母的分解形式`é`（即字符`e`和`´`或`\u0065`与的序列`\u0301`），而您的代码生成器使用了`é`（即`\u00e9`）的组合形式。这是 Apple 的 HFS+ 文件系统上的一个典型问题，它总是使用分解的形式。

你可以做些什么来解决这个问题是修改你的应用程序来分解出现在生成的源文件中的类名`java.text.Normalizer`：

`Normalizer.normalize(classname, Normalizer.Form.NFD)`

另见：[http ://en.wikipedia.org/wiki/Unicode_equivalence](http://en.wikipedia.org/wiki/Unicode_equivalence)

# ajax - 硒等待条件

> ID：13588941
> 
> 赞同：6
> 
> 时间：2012-11-27T16:43:57.047
> 
> 标签：ajax, selenium

我是第一次做 Selenium 测试。在主页上，我调用了一些 AJAX，我希望 Selenium 等待元素加载完成。我不确定它是否有效，但我只需输入 selenium 并且 waitForCondition 可以选择。

不管我选择什么，它总是返回“false”。*如果waitForCondition*甚至可以工作，我现在不知道吗？

我如何测试它是否有效？我在这段代码中做错了什么？

```
 selenium.waitForCondition("//input[@name='Report'", "3000");
 selenium.waitForCondition("//*[@id='MyTable']", "3000");
 selenium.waitForCondition("css=.someClass2", "3000"); 
```

如果我通过自己的类实现 - 它返回“true”

```
private boolean isElementPresent(By by) {
    try {
        driver.findElement(by);
        return true;
    } catch (NoSuchElementException e) {
        return false;
    }
} 
```

isElementPresent(By.xpath("//*[@id='MyTable']")) - 返回 "true"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:48:08.533

`waitForCondition`仅用于 Javascript 调用，不适用于等待元素加载。

你所拥有的一切都`isElementPresent`很好。我会将它与显式等待结合起来，以便更准确地了解元素何时实际加载并出现在屏幕上：

[http://seleniumhq.org/docs/04_webdriver_advanced.html](http://seleniumhq.org/docs/04_webdriver_advanced.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-22T15:00:20.257

**C＃**

你可以这样做：

首先，您可以为条件设置超时值。

然后你可以使用条件。

```
var Wait = new WebDriverWait(GlobalDriver, TimeSpan.FromMinutes(1));
Wait.Until(ExpectedConditions.PresenceOfAllElementsLocatedBy(By.XPath("xPath")))); 
```

或者

```
Wait.Until(driver => driver.FindElement(By.XPath("xPath"))); 
```

就这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T09:54:50.113

你可以这样做：

```
selenium.waitForCondition("selenium.isElementPresent(\"//input[@name='Report']\")", "30000"); 
```

这将等待元素加载到 30 秒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-27T10:56:42.897

希望这对你有用

```
new WebDriverWait(driver, 30).until(new ExpectedCondition<Boolean>() {
public Boolean apply(WebDriver driver) {
    JavascriptExecutor js = (JavascriptExecutor) driver;
    return (Boolean) js.executeScript("return jQuery.active == 0");
} 
```

});

这将检查 jQuery 库在 30 秒内是否有任何活动的 AJAX 请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T19:43:24.380

Aaran 向您推荐了[Selenium WebDriver waits](http://seleniumhq.org/docs/04_webdriver_advanced.html#explicit-and-implicit-waits)的正确文档。

您可以看到他们还写了有关 ExpectedConditions 类的内容。这包含 ExpectedCondition 类的几个有用的实现，例如“是元素存在一个”，即 ExpectedConditions.presenceOfElementLocated 。

这是一个使用它的例子：

```
WebDriver driver = new ChromeDriver();
driver.get("http://www.degraeve.com/reference/simple-ajax-example.php");

driver.findElement(By.name("word")).sendKeys("bird is the word");;
driver.findElement(By.cssSelector("input[type='button']")).click();
WebDriverWait driverWait = new WebDriverWait(driver, 10);
WebElement dynamicElement = driverWait.until(ExpectedConditions.presenceOfElementLocated(By.cssSelector("#result p")));
System.out.println(dynamicElement.getText()); 
```

如果你觉得它太冗长，你为什么不重构它并提取一个函数来接受元素定位器和 webdriver，然后返回元素呢？

DriverWait.until() 接受 ExpectedCondition 实例就像传递谓词函数的一种方式，只是通过一个类来完成，或者在文档示例中是一个匿名嵌套类，因为在 Java 下你不能发送一个函数。

您传递的 ExpectedCondition “函数”还返回一个值，如果您正在等待某个元素（或 WebDriver 中的某个其他值）的条件，这可能很有用，因此返回它可以为您节省额外的调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-15T12:21:47.400

试试这个：

```
await().atMost(10, SECONDS).until(() -> driver.findElements(By.id("elementId")).size() >1); 
```

# python - 在重复字母上使用 `.index()`

> ID：13588943
> 
> 赞同：0
> 
> 时间：2012-11-27T16:44:00.633
> 
> 标签：python, autocomplete, dictionary

我正在构建一个用单词构建字典的函数，例如：

```
{'b': ['b', 'bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'],
'bi': ['bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'],
'birt': ['birt', 'birth', 'birthd', 'birthda', 'birthday'], 
'birthda': ['birthda', 'birthday'], 
'birthday': ['birthday'], 
'birth': ['birth', 'birthd', 'birthda', 'birthday'],
'birthd': ['birthd', 'birthda', 'birthday'], 
'bir': ['bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday']} 
```

这是它的样子：

```
def add_prefixs(word, prefix_dict):
    lst=[]
    for letter in word:
        n=word.index(letter)
        if n==0:
            lst.append(word[0])
        else:
            lst.append(word[0:n])
    lst.append(word)
    lst.remove(lst[0])
    for elem in lst:
        b=lst.index(elem)
        prefix_dict[elem]=lst[b:]
    return prefix_dict 
```

它适用于“生日”之类的单词，但是当我有一个重复的字母时，我遇到了问题......例如，“你好”。

```
{'h': ['h', 'he', 'he', 'hell', 'hello'], 'hell': ['hell', 'hello'], 'hello': ['hello'], 'he': ['he', 'he', 'hell', 'hello']} 
```

我知道这是因为索引（python选择第一次出现字母的索引）但我不知道如何解决它。是的，这是我的作业，我真的很想向你们学习 :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:47:13.930

你已经遍历了这个词；而不是使用`.index()`保持计数器。Python 让这一切变得非常简单；使用`enumerate()`功能：

```
for n, letter in enumerate(word):
    if n==0:
        lst.append(word[0])
    else:
        lst.append(word[0:n]) 
```

现在您不再*使用*该`letter`变量，因此只需`range(len(word)`：

```
for n in range(len(word)):
    if n==0:
        lst.append(word[0])
    else:
        lst.append(word[0:n]) 
```

我们可以将其简化为列表推导：

```
lst = [word[0:max(n, 1)] for n in range(len(word))] 
```

注意`max()`那里；我们没有测试是否为 0，而是为切片`n`设置了最小值。`1`

由于您随后再次*删除*第一个条目（因为它与第二个结果相同）*并*添加了完整的单词，因此只需将 1 添加到`n`计数器：

```
lst = [word[0:n+1] for n in range(len(word))] 
```

您的功能的后半部分*可以*有效地使用该`enumerate()`功能，而不是`.index()`：

```
for b, elem in enumerate(lst):
    prefix_dict[elem]=lst[b:] 
```

现在您的功能要简单得多；请注意，由于您正在就地操作，因此无需*返回：* `prefix_dict`

```
def add_prefixs(word, prefix_dict):
    lst = [word[0:n+1] for n in range(len(word))]
    for b, elem in enumerate(lst):
        prefix_dict[elem]=lst[b:] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:52:53.053

通过考虑索引而不是字母来简化您的解决方案要容易得多。通常在 Python 中，我们循环遍历值，因为这是我们关心的。在这里，我们实际上是为字符串生成前缀，其中内容无关紧要，而是位置重要：

```
def prefixes(seq):
    for i in range(len(seq)):
        yield seq[:i+1]

segments = list(prefixes("birthday"))
print({segment: segments[start:] for start, segment in enumerate(segments)}) 
```

您真正想要的是获取单词的每个前缀，我们可以在极少数情况下执行此操作，即循环遍历索引是一个有效的选项，因为这正是我们正在尝试做的。

然后，我们使用[字典理解](http://www.youtube.com/watch?v=pShL9DCSIUw)为每个段选择正确的“子”组。

这给了我们（为了清楚起见，添加了一些空白）：

```
{
    'birt': ['birt', 'birth', 'birthd', 'birthda', 'birthday'], 
    'bir': ['bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'], 
    'birthday': ['birthday'], 
    'bi': ['bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'], 
    'birthda': ['birthda', 'birthday'], 
    'b': ['b', 'bi', 'bir', 'birt', 'birth', 'birthd', 'birthda', 'birthday'], 
    'birthd': ['birthd', 'birthda', 'birthday'], 
    'birth': ['birth', 'birthd', 'birthda', 'birthday']
} 
```

如果您不介意一些额外的循环，我们甚至可以将其简化为：

```
def prefixes(word):
    for i in range(len(word)):
        segment = word[:i+1]
        yield segment, [segment[:i+1] for i in range(len(segment))]

print(dict(prefixes("birthday"))) 
```

作为旁注，另一个实现`prefixes()`是：

```
def prefixes(seq):
    return prefixes(seq[:-1])+[seq] if seq else [] 
```

但是，这是一个递归函数，并且由于 Python 没有针对递归进行优化，因此这是一种更糟糕的方法。它还创建了一个列表而不是生成器，这在某些情况下内存效率较低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:53:54.490

Martijn[比我快](https://stackoverflow.com/a/13589002/296974)，但我有一些补充：

```
def add_prefixs(word, prefix_dict):
    lst=[]
    for n, letter in enumerate(word):
        if n > 0:
            lst.append(word[0:n])
    lst.append(word)
    for elem in lst:
        b=lst.index(elem)
        prefix_dict[elem]=lst[b:]
    return prefix_dict 
```

如果立即删除它，为什么要放置第 0 个条目？

另一个简化可能是

```
def add_prefixs(word, prefix_dict):
    #lst=[word[0:n] for n, letter in enumerate(word) if n > 0] + [word]
    # why do I think so complicated? Better use
    lst=[word[0:n+1] for n, letter in enumerate(word)]
    prefix_dict.update((elem, lst[b:]) for b, elem in enumerate(lst))
    return prefix_dict 
```

* * *

像这样的班级

```
class Segments(object):
    def __init__(self, string, minlength=1):
        self.string = string
        self.minlength = minlength
    def __getitem__(self, index):
        s = self.string[:self.minlength + index]
        if len(s) < self.minlength + index: raise IndexError
        if index >= len(self): raise IndexError # alternatively
        return s
    def cut(self, num):
        return type(self)(self.string, self.minlength + num)
    def __repr__(self):
        return repr(list(self))
    def __len__(self):
        return len(self.string) - self.minlength + 1 
```

您可以进一步简化：

```
def add_prefixes(word, prefix_dict):
    lst = Segments(word)
    prefix_dict.update((prefix, lst.cut(n)) for n, prefix in enumerate(lst))
    return prefix_dict 
```

嗯。如果我再想一想，这并不简单。但它避免了本质上相同的数据或部分数据的许多副本......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T18:00:25.337

我认为最*pythonic*的方法是：

```
def add_prefixs(word, prefix_dict):
    lst = [word[0:n+1] for n in range(len(word))]
    prefix_dict.update((k, lst[n:]) for n, k in enumerate(lst)) 
```

# linux - 带有自定义软件包的 CentOS 5.8 ISO

> ID：13588945
> 
> 赞同：0
> 
> 时间：2012-11-27T16:44:11.777
> 
> 标签：linux, centos, rpm, yum

如何使用自定义包创建 CentOS 5.8 .iso 映像？我必须创建一个只有我们生产系统所需的包的 iso。我已经在一个文件夹中解决了所有 rpm 及其依赖项。我已经使用 createrepo 从该文件夹成功创建了一个存储库。

据我了解，我应该将 rpm 文件放在 CentOS 文件夹中，而 repodata 文件夹应该包含包管理器所需的元数据。我不知道我是否应该修改现有的 comps.xml 文件或创建一个新文件，或者使用哪种结构，因为这只是默认 CentOS 安装盘中包含的软件包的一个子集。

我知道从默认 iso 中删除包可能是徒劳的，但这是我的工作指令，没有太多工作要做。（也有一些包在默认iso中不可用）

非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:47:14.530

对于具有这种广度的主题，我觉得您的问题有点含糊，但我会尽力提供答案。我认为你应该使用[Kickstart](http://en.wikipedia.org/wiki/Kickstart_%28Linux%29)来完成这项任务，因为无论他们是内部客户还是外部客户，它都会让他们更加满意，并且在事情更新时更容易管理。从查看[CentOS 文档](http://www.centos.org/docs/5/html/Installation_Guide-en-US/ch-kickstart2.html)开始，如果您已经到此为止并且只是询问有关删除软件包的问题，​​请查看文档的[这一](http://www.centos.org/docs/5/html/Installation_Guide-en-US/s1-kickstart2-packageselection.html)部分，它讨论了指定您的软件包和删除您不想要的软件包。

如果您只有一种类型的生产机器，那么这应该照顾它。如果您有多种不同的配置，我建议您查看配置管理工具，例如[Ansible](http://ansible.cc/)、[Puppet](http://puppetlabs.com/)或[Salt](http://docs.saltstack.org/en/latest/contents.html)。这将允许您通过 Kickstart 提供一个基本映像，然后根据使用该系统的任何人的需要构建该映像。

# bash - 剪切和替换 bash

> ID：13588949
> 
> 赞同：3
> 
> 时间：2012-11-27T16:44:15.423
> 
> 标签：bash, shell, cut

我必须处理一个像这样组织的数据的文件

```
AAAAA:BB:CCC:EEEE:DDDD
FF:III:JJJ:KK:LLL
MMMM:NN:OOO:PP
etc 
```

列可以有不同的长度，但行总是有相同的列数。

我希望能够剪切给定行的特定列并将其更改为我想要的值。

例如，我会应用我的命令并将文件更改为

```
AAAAA:BB:XXXX:EEEE:DDDD
FF:III:JJJ:KK:LLL
MMMM:NN:OOO:PP 
```

我知道如何使用 sed 选择特定行，然后剪切该字段，但我不知道如何用我拥有的值替换该字段。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T16:49:42.270

这是一种方法`awk`：

以您的示例为例，如果您想替换第一行的第三个字段：

```
awk 'BEGIN{FS=OFS=":"} {if (NR==1) {$3 = "XXXX"}; print}' input_file 
```

**输入：**

```
AAAAA:BB:CCC:EEEE:DDDD
FF:III:JJJ:KK:LLL
MMMM:NN:OOO:PP 
```

**输出：**

```
AAAAA:BB:XXXX:EEEE:DDDD
FF:III:JJJ:KK:LLL
MMMM:NN:OOO:PP 
```

**解释：**

*   `awk`: 调用 awk 命令
*   `'...'`: 单引号括起来的所有内容都是 awk 的指令
*   `BEGIN{FS=OFS=":"}`:`:`用作输入和输出的分隔符​​。`FS`代表字段分隔符。`OFS`代表输出字段分隔符。
*   `if (NR==1) {$3 = "XXXX"};`: 如果`NR`到目前为止读取的记录数 ( ) 为 1，则将第三个字段 ( `$3`) 设置为 " `XXXX`"。
*   `print`: 打印当前行
*   `input_file`：输入文件的名称。

* * *

相反，如果您尝试完成的只是将文件中所有出现的 替换为`CCC`，`XXXX`只需执行以下操作：

```
sed -i 's/CCC/XXXX/g` input_file 
```

请注意，这也将替换部分匹配项，例如`ABCCCDD`->`ABXXXXDD`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:58:25.470

这可能对您有用（GNU sed）：

```
sed -r 's/^(([^:]*:?){2})CCC/\1XXXX/' file 
```

或者

```
awk -F: -vOFS=: '$3=="CCC"{$3="XXXX"};1' file 
```

# c# - 正则表达式匹配嵌入在另一个引用字符串中的引用字符串

> ID：13588950
> 
> 赞同：7
> 
> 时间：2012-11-27T16:44:15.377
> 
> 标签：c#, regex

我有一个逗号分隔和引号限定的数据源。一个 CSV。但是，数据源提供者有时会做一些不稳定的事情。我已经补偿了除其中一个之外的所有问题（我们逐行读取文件，然后在清理后将其写回），当我的 regex-fu 非常弱时，我正在寻找解决最后一个问题.

**在另一个带引号的字符串中匹配带引号的字符串**

所以这是我们的示例字符串...

```
"foobar", 356, "Lieu-dit "chez Métral", Chilly, FR", "-1,000.09", 467, "barfoo", 1,345,456,235,231, "935.18" 
```

我正在寻找匹配子字符串**"chez Métral"**，以便用子字符串**chez Métral**替换它。理想情况下，尽可能少的代码行。最终目标是在替换已经完成的情况下将行写回（或将其作为方法返回值返回）。

所以我们的示例字符串最终会变成......

```
"foobar", 356, "Lieu-dit chez Métral, Chilly, FR", "-1,000.09", 467, "barfoo", 1,345,456,235,231, "935.18" 
```

我知道我可以定义一个模式，例如`(?<quotedstring>\"\w+[^,]+\")`匹配带引号的字符串，但是我的 regex-fu 很弱（数据库开发人员，几乎从不使用 C#），所以我不确定如何匹配命名组中的另一个带引号的字符串**quotedstring**。

* * *

*仅供参考：对于那些注意到用逗号格式化但没有引号限定的大整数的人来说，这已经被处理了。随机使用行分隔符（有时是 CR，有时是 LF）也是如此。作为其他问题...*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T16:48:04.917

换成这个`regex`

```
(?<!,\s*|^)"([^",]*)" 
```

现在将其替换为`$1`

[在这里](http://regexhero.net/tester/)试试

* * *

`"`与它一起逃脱`""`将成为

```
(?<!,\s*|^)""([^"",]*)"" 
```

# xcode - 如何在同一个 Xcode 项目的不同目标中为变量使用不同的值？

> ID：13588951
> 
> 赞同：4
> 
> 时间：2012-11-27T16:44:18.147
> 
> 标签：xcode, targets

我有一个针对不同目标具有相同代码库的项目，这些目标需要为某些变量提供不同的值。实现这一目标的最佳方法是什么？以下是我的想法：

*   使用包含每个目标值的不同属性列表资源。缺点：我必须在运行时解析属性列表才能获取值。如果有人查看应用程序包内部，这些值就会清晰显示。
*   `#define`在不同的包含文件中使用s。缺点：对于每个新目标，我必须使用宏条件来在实现中包含正确的文件。
*   为每个目标使用不同的实现文件：
    *   具有恒定的全局变量。缺点：命名空间被这些全局变量污染了。
    *   使用一个属性是变量的类。缺点：每个实现都必须重写属性的胶水代码。

有没有人有好的解决方案？还是将通用代码库分解为库并每次使用不同的项目更好？

# javascript - Javascript Regex - 使用替换将结构化字符串解析为对象

> ID：13588956
> 
> 赞同：3
> 
> 时间：2012-11-27T16:44:42.993
> 
> 标签：javascript, regex, parsing

我的目标是解析具有特定格式的字符串以从中生成 javascript 对象结构。

一个想法是使用带有函数的[String.replace作为参数。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_function_as_a_parameter)所以在函数中你得到了比赛的所有部分。到目前为止我的测试/示例：

字符串：

```
 !Norm: DIN 7985;
        M2: 2, 2, 2;
        M3:3,3;
        M10: 20,25;
!Norm: DIN 7985 TX;
    M4: 4,  4    , 4; 
```

我的测试代码：

```
console.clear();
var sTmp = "!Norm: DIN 7985;\n    M2: 2, 2, 2;\n    M3:3,3;\n    M10: 20,25;\n     !Norm: DIN 7985 TX;\n    M2: 6,    10    , 16;";
//console.log(sTmp);

function replacer(match, p1, p2, p3, p4, offset, string){
    //console.log("-");
    console.log("match:", match);
    console.log("p1:", p1);
    console.log("p2:", p2);
    console.log("p3:", p3);
    console.log("p4:", p4);
    console.log("offset:", offset);
    console.log("string:", string);
    return "#";
}
//(?=!Norm:\s?(.+);\s+)
sTmp.replace(/\s*!Norm:\s?(.+);\s+(M\d+:.*\s*;)/g, replacer); 
```

（在萤火虫中测试）控制台日志（缩短）：

```
match: !Norm: DIN 7985; M2: 2, 2, 2;
p1: DIN 7985
p2: M2: 2, 2, 2;
p3: 0
p4: !Norm: DIN 7985; M2: 2, 2, 2; M3:3,3; M10: 20,25; ....
offset: undefined
string: undefined
match: !Norm: DIN 7985 TX; M4: 4, 4 , 4;
p1: DIN 7985 TX
p2: M4: 4, 4 , 4;
p3: 52
p4: !Norm: DIN 7985; M2: 2, 2, 2; M3:3,3; M10: 20,25; !Norm: DIN 7985 TX; M4: 4, 4 , 4;
.... 
```

所以我可以看到这个想法是可行的——它符合规范，我在一个子字符串中得到了信息。现在有 M3:... 零件。那么是否有一个选项可以指定该部分`(M\d+:.*\s*;)`匹配下一个 !Norm: 而不是 ; 第一次出现？我认为它应该可以通过前瞻或其他方式实现？

这个想法背后的目标是从字符串中生成一个像这样的javascript对象：

```
 oDataTmp = {
    DIN 7985 :      {
                        M2        : ["2", "2", "2"],
                        M3        : ["3", "3"],
                        M10       : ["20", "25"],
                    }
    DIN 7985 TX :   {
                        M4        : ["4", "4", "4"],
                    }
} 
```

我知道你可以通过拆分来做到这一点，然后逐行解析。我喜欢完成这个大脑任务并了解如何去做的挑战:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:59:20.403

这是我的正则表达式：

```
\s*!\w+:\s*([^;]+);\s*((?:\s*[^:!]+:[^;]+;)+) 
```

它具有以下匹配组：

*   第 1 组：DIN 部分。
*   第 2 组：当前 !Norm 的所有剩余设置。

此正则表达式并不特别期望关键字 NORM。所以它可能是其他任何东西。如果要捕获它，只需在第一个 \w+ 周围添加括号。

解释：

```
/            # start regex
\s*          # match optional whitespace
!\w+:        # match word between '!' and ':'
\s*          # match optional whitespace
([^;]+);     # capture group 1 - match all characters (without ';') up to the next ';'
\s*          # match optional whitespace
(            # start capture group 2
    (?:          # group (non-capture)
        \s*          # match optional whitespace
        [^:!]+:      # match all characters (without ':' and '!') up to the next ':'
        [^;]+;       # match all characters (without ';') up to the next ';'
    )+           # group end; match this group 1 to n times
)            # end capture group 2
/g           # end regex; set g-Flag for global 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:21:45.307

您需要更改两件事以使所有成员都成为一次捕获。首先`.`不匹配换行符（你不能在 JavaScript 中改变它）。但`[\s\S]`确实如此。是的，使用负前瞻，我们可以确保我们不消耗下一个`!Norm`：

```
/\s*!Norm:\s?(.+);\s+((?:(?![!]Norm)[\s\S])*)/g 
```

我已将文字`!`放在方括号中，以明确它是文字并将其`!`与负前瞻语法的一部分分开。您可以省略方括号，这只是为了便于阅读。所以基本上这将用任意字符填充最后一次捕获，只要它们不开始一个新的`!Norm`.

然后您可以继续，从最后一次捕获中读取各个属性和值。

解释：

```
/            # start regex
\s*          # match optional whitespace
!Norm:       # match '!Norm:'
\s?          # match optional whitespace
(.+);        # capture group 1 - match all characters (whitout '\n') up to the next ';'
\s+          # match 1..n whitespaces
(            # start capture group 2
    (?:          # group (non-capture)
        (?!          # negative lookahead
            [!]Norm      # match '!Norm'
        )            # end negative lookahead
        [\s\S]       # match a white space or other than white space character
                     # this group match a single character as long as it dont start are new !Norm
    )*           # group end; match this group 0..n times
)            # end capture group 2
/g           # end regex; set g-Flag for global 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:32:21.717

所以在这里有一个完整的解决方案，我解析使用的正则表达式的洞来自两个答案的组合：

```
console.clear();
var sData = "!Norm: DIN 933;\n !Norm: DIN 7985;\n    M2: 2, 2, 2;\n    M3:3,3;\n    M10: 20,25;\n     !Norm: DIN 7985 TX;\n    M2: 6,    10    , 16;";
console.log(sTmp);

var oData = {};

// Parse sData with help of Regex replace
sData.replace(/\s*!Norm:\s*([^;]+);\s*((?:(?![!]Norm)[\s\S])*)/g, 
    function replacer(match, sNorm, sScrews, offset, string) {
        //console.log("match:", match);
        //console.log("sNorm:", sNorm);
        //console.log("sScrews:", sScrews);
        //console.log("offset:", offset);
        //console.log("string:", string);

        var oScrews = {};

        sScrews.replace(/\s*(M\d+):\s*([^;]+);\s*/g, 
            function(match, sScrewSize, sScrewList, offset, string) {
                //console.log("match:", match);
                //console.log("sScrewSize:", sScrewSize);
                //console.log("sScrewList:", sScrewList);
                //console.log("offset:", offset);
                //console.log("string:", string);

                oScrews[sScrewSize] = sScrewList.split(/[\s,]+/);

                return "§";
            });

        oData[sNorm] = oScrews;

        return "#";
    });

console.log("oData: ");
console.dir(oData); 
```

结果对象（在控制台中验证）：

```
oData = {
    DIN 7985 :      {
                        M10 : ["20", "25"],
                        M2  : ["2", "2", "2"],
                        M3  : ["3", "3"],
                    }
    DIN 7985 TX :   {
                        M4  : ["4", "4", "4"],
                    }
    DIN 933 :       {}
    }; 
```

# php - 将 GET 变量从一个 Bash/PHP 脚本传递到另一个

> ID：13588962
> 
> 赞同：5
> 
> 时间：2012-11-27T16:44:59.993
> 
> 标签：php, linux, bash, get

我不确定它的正确名称，但我正在我的 Linux 服务器上的 Bash 脚本中执行 PHP 代码。我有两个这样的 Bash 文件，并且希望能够将 GET 变量从一个文件传递到下一个文件。

这是第一个文件的简化版本：

```
#!/usr/bin/php -q
<?php

require("bash2.sh?id=1"); 
```

这是第二个文件的简化版本：

```
#!/usr/bin/php -q
<?php

echo $_GET['id']; 
```

目前，当我在 Crontab 上执行第一个文件时，我收到一条错误消息：

> PHP 警告：require(bash2.sh?id=1): failed to open stream: No such file or directory in /home/bash/bash1.sh on line 2

如果我`?id=1`从 中删除`require()`，它将执行而没有错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:50:00.203

您正在思考网络...您输入的`require`是 PHP 引擎将使用操作系统查找的实际文件名。即它寻找一个`bash2.sh?id=1`你显然没有的文件。

要么你从 withing 调用另一个脚本，比如用`system('./bash2.sh 2');` 或者，包含，然后使用下面的方法来传递数据。

文件 1

```
<?php
$id = 1;
require("bash2.sh"); 
```

文件2

```
<?php
echo $id; 
```

如果您使用第一个示例 ( `system('./bash2.sh 2');`) 那么在 bash2.sh 中您将通过以下方式访问该变量：

```
<?php
echo $argv[1]; //argv[0] is the script name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:50:11.857

您不能将参数添加到硬盘驱动器上的静态文件。但是您可以定义一个可由所需脚本访问的全局变量。

```
<?php
$id=1
require("bash2.php"); 
```

对于你的 bash2.php：

```
<?php
echo $id; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T17:24:32.100

不，伙计，您应该使用参数。当您执行 php 脚本（我猜是在 cron 作业中）时，您添加了诸如`some.php variable1 variable2`.....等之类的参数，

然后在 php 中你得到那个变量`$argv[0], $argv[1] .... etc`。

这就是 bash 脚本的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:50:45.430

尝试这样的事情：

```
<?php

    $id = $_GET['id'];
    exec("./bash2.sh $id");

?> 
```

然后在 bash 脚本中，您将能够访问作为 $1 传递的第一个参数。

[更多信息在这里](http://linux.about.com/od/Bash_Scripting_Solutions/a/How-To-Pass-Arguments-To-A-Bash-Script.htm)和[这里](http://php.net/manual/en/function.exec.php)

希望这可以帮助！

# jquery - 试图让 jquery 调用提交，在 rails 3 中有问题

> ID：13588964
> 
> 赞同：1
> 
> 时间：2012-11-27T16:45:08.417
> 
> 标签：jquery, ruby-on-rails-3

我有一个带有 id 的 link_to 表单助手：

```
<%=  link_to "NEXT", next_wizard_path, :method => :put, :id => 'my-link-check' %> 
```

我希望此链接提交页面上的表单（它实际上是部分的，但在呈现时它的全部一页并不重要）。所以我在标题部分的顶部放了一些jquery：

```
<script>

$(document).ready(function() {
    $('#my-link-check').click(function(event){
    var form = document.getElementById("edit_put");
    if(form!=null)
        form.submit();
    //event.preventDefault(); // Prevent link from following its href, dont think we want this
    });
}); 
</script> 
```

奇怪的是，form.submit 确实有效，如果我在 firebug 中设置了断点并专门单步执行代码，如果我不这样做，它会运行代码但提交实际上不起作用。我很困惑发生了什么，或者为什么会这样。我怀疑它是如何使用 jquery 调用的，因为我根本不精通 jquery。

我应该注意，这是为了将数据保存在[wicked](https://github.com/schneems/wicked)提供和帮助的表单上，这是 ruby​​ on rails 的向导宝石。

我还应该注意到 wicked 的作者建议在“向导页面”之间保存数据，以便在通过 ajax 触摸表单时异步提交数据：

```
def update

# save logic here

  respond_to do |format|
    format.js do
    # whatever
  end
  format.html do
     render_wizard
  end
end 
```

虽然我不知道，但在我们看来是不是让 form_for 成为 remote => true ？我怀疑它比这更复杂。

我还尝试让 link_to 方法成为 put 方法，这确实调用了控制器中的 Update 操作，但它没有传递任何信息，因此它没有保存任何表单更改……这就是为什么我认为通过 javascript 调用提交操作是一个很好的解决方案，显然我错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T18:41:27.613

你为什么注释掉`event.preventDefault();`一行？`my-link-check`带有id的链接是否指向实际地址？

看起来浏览器刚刚更改（或重新加载）页面，脚本执行被终止。有了断点，一切顺利。

尝试取消注释`event.preventDefault();`或放在`return false;`后面`form.submit();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T16:53:36.383

我怀疑 jQuery`submit`只适用于 jQuery 对象，所以它应该是这样的：

```
$(document).ready(function() {
    $('#my-link-check').click(function(event){
    var form = $("#edit_put");
    if(form!=null)
        $(form).submit();
    });
}); 
```

# java - 如何在 Android 中读取/写入自定义 PNG 元数据？

> ID：13588965
> 
> 赞同：3
> 
> 时间：2012-11-27T16:45:07.903
> 
> 标签：java, android, bitmap, png, metadata

我必须将几个文本参数（一个 UUID 和几个表示整数的字符串）关联到一个 PNG 图像，当 PNG 文件通过网络从 Android 设备传递到另一个设备时，它们可以跟随图像。这是我会使用几个自定义辅助块（类似于 EXIF 字段）将我的数据存储在 PNG 图像本身中的典型情况。

也许只有我一个人，但我能找到的关于从 Android 上的 Java 代码读取和写入 PNG 自定义元数据的唯一信息是这个 SO 帖子：

[用 Java 编写图像元数据，最好是 PNG](https://stackoverflow.com/questions/6495518/writing-image-metadata-in-java-preferably-png)

它甚至提供了一些代码（非常冗长，与 Java 一样）。

那些相同的 SO 帖子也指 PNGJ：[http ://code.google.com/p/pngj/](http://code.google.com/p/pngj/)

老实说，我很乐意在这个项目中不再使用另一个库。

有人知道在 Android 的 PNG 文件中写入和读取文本元数据的其他方法吗？也许是一种不那么冗长的方式......也许是一种不需要分离库的方式......

还有其他信息来源吗？有教程吗？有什么例子吗？

如果需要（JPEG 等），我愿意使用不同（但等效）的图像文件格式。

一个同样适用于 iOS 和 Windows 8 Phone 的解决方案将是一个加分项，但实际上并不是必需的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:15:37.827

我最近不得不做类似的事情，所以我不得不研究这个主题。Android 没有为您提供处理 png 元数据的选项。您将不得不使用外部库（PNGJ 似乎是一个不错的选择）。就我而言，由于我正在对 Android 框架进行更改，因此我没有使用外部库，而是对skia（而不是 Android 图形库）进行了更改。

如果您需要更多信息，我可以给您，但我认为这与您的情况无关。

# asp.net - 项目引用错误

> ID：13588970
> 
> 赞同：0
> 
> 时间：2012-11-27T16:45:29.840
> 
> 标签：asp.net, vb.net, class-library

我有一个引用 VB.NET 类库（业务逻辑层）的 ASP.NET 应用程序（表示层），该类库引用另一个 VB.NET 类库（数据逻辑层）。

当我单步执行文件背后代码中的代码时，我现在看到一个错误：

> 无法从程序集“DataLogicLayer，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”加载类型“DataLogicLayer.classname”。":"DataLogicLayer.classname"}System.Exception

ClassName 来自数据逻辑层。我不确定如何解决此错误。

（我检查了程序集是否出现在 BIN 文件夹中。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:31:59.067

我在 Web 应用程序的 web.config 中引用了一个旧程序集。删除程序集引用解决了该问题。

# c - 将整数打印为浮点数

> ID：13588973
> 
> 赞同：2
> 
> 时间：2012-11-27T16:45:46.973
> 
> 标签：c, floating-point

> **可能重复：**
> [将 int 打印为 float 时 printf 的行为是什么？](https://stackoverflow.com/questions/8203754/what-is-printfs-behaviour-when-printing-an-int-as-float)

```
int main()
{
 int x=4;
 int y=987634;
 printf("%f %f",x,y);
} 
```

在编译此代码时，我得到的输出为 0.000000 0.000000。不应该将 x 和 y 类型提升为浮点数吗？O/P 不应该是 4.000000 和 987634.000000 吗？谁能帮我这个。提前感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:50:15.710

转换发生在具有包含特定参数的原型的函数的参数上。的原型`printf()`不包括第一个之后的具体参数

```
int printf(const char *format, ...); 
```

因此，除了“默认参数转换”定义的参数之外，第一个参数之后不会自动转换（基本上任何等级低于 to 的整数类型和任何等级低于to`int`的`int`浮点类型（*谢谢，Pascal Cuoq*） ）。您需要自己使用强制转换操作显式转换它们`double``double`

 *```
 printf("%f %f\n", (double)x, (double)y); 
```

哦……你真的，真的，真的应该包括有问题的原型的标题（在未定义行为的惩罚下）

```
#include <stdio.h> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T16:49:11.133

编译器不知道您的`printf`格式字符串会将参数解释为浮点数。它以 s 的形式直接通过它们`int`。

因为`printf`是一个可变参数函数，所以传递有意义的参数真的取决于你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T16:49:11.567

尝试`printf("%i %i",x,y);`将整数打印为`4 987634`. 有关`printf`格式的详细信息，请参见[http://www.cplusplus.com/reference/cstdio/printf/](http://www.cplusplus.com/reference/cstdio/printf/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T16:51:08.800

`int`s 和`float`s 在内存中的存储方式不同，但是您的编译器不知道您需要浮点数。您需要显式转换它们。

```
printf("%f %f",(float)x,(float)y); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T16:51:36.503

可变参数函数（printf() 是其中之一）不进行类型检查，因为可变参数签名不包含任何类型信息。因此，没有隐式类型转换。您必须手动完成：

```
printf("%f %f", (double)x, (double)y); 
```*

# android - 在 Android 中查看 PDF 文件

> ID：13588974
> 
> 赞同：5
> 
> 时间：2012-11-27T16:45:49.447
> 
> 标签：android, pdf

我正在开发一个应用程序，其中一个按钮在按下时显示 PDF 文件。

显示此 PDF 文件的最佳方式是什么？

我可以通过将其复制到 SD 卡并使用已安装在设备上的 adobe 通过意图启动它来查看它。

但是我不能假设每个设备都安装了 adobe，那么我的替代选择是什么？

我可以将其转换为图像并以这种方式显示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:13:41.310

我怀疑您是否想自己进行 pdf 转换。您可以检查是否有应用程序来处理这样的意图：

```
/**
* Indicates whether the specified action can be used as an intent. This
* method queries the package manager for installed packages that can
* respond to an intent with the specified action. If no suitable package is
* found, this method returns false.
*
* @param context The application's environment.
* @param action The Intent action to check for availability.
*
* @return True if an Intent with the specified action can be sent and
*         responded to, false otherwise.
*/
public static boolean isIntentAvailable(Context context, String action) {
    final PackageManager packageManager = context.getPackageManager();
    final Intent intent = new Intent(action);
    List<ResolveInfo> list =
            packageManager.queryIntentActivities(intent,
                    PackageManager.MATCH_DEFAULT_ONLY);
    return list.size() > 0;
} 
```

取自[这里](http://android-developers.blogspot.com/2009/01/can-i-use-this-intent.html)的 android 开发者博客。

如果他们没有处理 pdf 的应用程序，则显示一个对话框，提供将它们发送到 Play 商店。您可以像这样创建启动 Play 商店的意图：

```
try {
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("market://details? id="+appName)));
} catch (android.content.ActivityNotFoundException anfe) {
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://play.google.com/store/apps/details?id="+appName)));
} 
```

取自[这个](https://stackoverflow.com/questions/10922762/open-link-of-google-play-store-in-mobile-version-android)stackoverflow 链接。

# c++ - 在 main() 中定义全局变量

> ID：13588975
> 
> 赞同：4
> 
> 时间：2012-11-27T16:46:03.263
> 
> 标签：c++, global-variables

**我想根据来自main()**的输入定义全局数组（用于其他函数）；（具体是数组大小）。*extern*关键字没有帮助。

```
#include <iostream>
    using namespace std;

void gen_sieve_primes(void);

int main() {
    int MaxNum;
    cin >> MaxNum;
    int *primes = new int[MaxNum];
    delete[] primes;
    return 0;
}
//functions where variable MaxNum is used 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T16:48:02.020

只需在全局范围内定义它

```
int MaxNum;
int main(){
    cin >> MaxNum;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T16:48:24.987

在主函数的括号外声明数组。

```
#include <iostream>
using namespace std;
void gen_sieve_primes(void);

(Declare the variables here!)

int main() {
     extern int MaxNum;
     cin >> MaxNum;
     int *primes = new int[MaxNum];
     delete[] primes;
     return 0;
}
//functions where variable MaxNum is used 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T16:48:29.593

您在 main 之外声明它：

```
int maxNum;
int main() {
...
} 
```

理想情况下，您根本不这样做。全局变量很少有用，而且几乎从不（或者更确切地说：从不）需要。

# ruby-on-rails - 如何验证非模型（甚至非对象）字段

> ID：13588976
> 
> 赞同：5
> 
> 时间：2012-11-27T16:46:02.207
> 
> 标签：ruby-on-rails, ruby, forms, validation

我有一个表单，其中有很多字段取自数组（不是来自模型或对象）。如何验证这些字段的存在？

```
<%= simple_form_for :solve, :url => solve_problem_path do |f| %>
  <% @input_variables.each do |label| %>
    <%= f.input label %>
  <% end %>
  ...
<% end %> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T18:41:59.613

创建一个简单的类来包装请求参数并使用`ActiveModel::Validations`.

```
# defined somewhere, at the simplest:
require 'ostruct'

class Solve < OpenStruct
  include ActiveModel::Validations
  validates :foo, :bar, :presence => true    

  # you could even check the solution with a validator
  validate do
    errors.add(:base, "WRONG!!!") unless some_correct_condition
  end
end

# then in your controller
def your_method_name
  @solve = Solve.new(params[:solve])

  if @solve.valid?
    # yayyyy!
  else
    # do something with @solve.errors
  end
end 
```

这使您可以像验证模型一样进行验证，并带有 i18n 错误消息等。

**编辑**：根据您的评论，验证您可能做的一切：

```
class Solve < OpenStruct
  include ActiveModel::Validations

  # To get the i18n to work fully you'd want to extend ActiveModel::Naming, and
  # probably define `i18n_scope`
  extend ActiveModel::Naming

  validate do
    # OpenStruct maintains a hash @table of its attributes
    @table.each do |key, val|
      errors.add(key, :blank) if val.blank?
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T18:28:03.277

您可以使用 attr_accessible 执行以下操作：

```
Class YourClass < ActiveRecord::Base    
  attr_accessible :field_1
  attr_accessible :field_2

  validates :field_1, :presence => true
  validates :field_2, :presence => true
end 
```

**编辑 ：**

这可能是一个更好的解决方案：http: [//yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/](http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/)

# vbscript - 在特定行的末尾添加空格字符

> ID：13588977
> 
> 赞同：1
> 
> 时间：2012-11-27T16:46:04.987
> 
> 标签：vbscript, batch-file, batch-rename

我想编写一个 vbscript 或批处理文件来运行近一百个文件（在同一目录中）并执行以下操作：

对于以字符串开头的每一行`"component "`（组件后有一个空格），我想在该行的末尾添加一个空格。其他线路不受影响。

**例如：**

```
this is line one
component this is line two
this is line three 
```

**将更改为：**

```
this is line one
component this is line two (<=space)
this is line three 
```

*（“二”后面只有一个空格。）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T17:01:34.537

```
@echo off
for /f "tokens=1,* delims= " %%a in (file.txt) do (
if "%%a"=="component" (
echo %%a %%b >>temp.txt
) else (
echo %%a %%b>>temp.txt
)
)
del file.txt /f /s /q
ren temp.txt file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:10:10.020

```
@Echo OFF

:: By Elektro H@cker

Set "File=Test.txt"
Set "Word=Component"

FOR /F "Usebackq Tokens=* Delims=" %%# IN ("%FILE%") DO (
    Echo "%%#"| FINDSTR /I "^\"%WORD%.*\"" >NUL && (
        Echo %%# >>".\Output.txt"
    ) || (
        Echo %%#>>".\Output.txt"
    )
)

Pause&Exit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T17:13:31.233

在 VBScript 中，您可以使用正则表达式来做到这一点：

```
in  = "input.txt"
out = "output.txt"

Set fso = CreateObject("Scripting.FileSystemObject")

text = fso.OpenTextFile(in).ReadAll
text = Replace(text, vbCrLf, vbLf)         ' remove CR b/c it interferes with
                                           ' multiline matches

Set re = New RegExp
re.Pattern   = "^(component .*)$"
re.MultiLine = True
re.Global    = True

text = re.Replace(text, "$1 ")
text = Replace(text, vbLf, vbCrLf)         ' restore CRLF

fso.OpenTextFile(out, 2, True).Write(text)

fso.DeleteFile in
fso.MoveFile out, in 
```

# mysql - 有什么方法可以在 MySQL 中将十进制转换为时间？

> ID：13588984
> 
> 赞同：5
> 
> 时间：2012-11-27T16:46:16.390
> 
> 标签：mysql, date, typeconverter

我在 MySQL 中使用十进制数据类型创建了一个名为“hours_spent”的字段来存储时间。这些值的存储方式如下 1.30、2.30 等...（1 小时 30 分钟、2 小时 30 分钟）。

我想计算各种时间值的总和。

时间总和不是我预期的：1.30 + 2.30 = 3.60，而我预期的是 4.00。

我使用 MySQL 中的 SUM 函数来计算 hours_spent 字段。如果值为 0.30 + 1.50 = 1.80，而我预计为 2.20。

我的第一个错误是使用十进制类型而不是时间数据类型，但我无法更改数据类型。

那么，有什么方法可以对时间值求和并得到我期望的结果？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:56:23.887

我在 sqlfiddle 为您准备了一个演示，如果您愿意，可以在那里尝试：

[http://www.sqlfiddle.com/#!2/c9afc/2](http://www.sqlfiddle.com/#!2/c9afc/2)

以下是查询示例：

```
select @indexer:=instr(dateasdecimal, '.')
, left(dateasdecimal, @indexer-1) * 60 + substr(dateasdecimal, @indexer+1)  as totalMinutes
from testtable;

select @indexer:=instr(dateasdecimal, '.')
, sum(left(dateasdecimal, @indexer-1) * 60 + substr(dateasdecimal, @indexer+1))  as totalMinutes
from testtable; 
```

注意：请不要忘记接受您的问题的答案： [https ://meta.stackexchange.com/a/65088/200585](https://meta.stackexchange.com/a/65088/200585)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T18:31:44.147

要将小数转换为秒，您可以使用以下命令：

```
truncate(hours_spent,0)*60+(hours_spent-truncate(hours_spent,0))*100 
```

然后你就可以轻松地计算总和了。然后，您可以使用以下方法将秒数转换为十进制格式：

```
truncate(seconds/60,0)+truncate(mod(seconds, 60)/100,2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-27T02:48:06.270

您始终可以将小数转换为字符串，转换为时间，然后使用 time_to_sec 将该时间相加，并使用 sec_to_time 生成格式化时间。当然，以不同的方式存储这些时间会更好，即使它涉及转换整个数据集。

```
SELECT sec_to_time(sum(time_to_sec(goodTime))) FROM (   
    SELECT CAST(badTime AS TIME) AS goodTime FROM ( 
        SELECT REPLACE(badTime, '.', ':') AS badTime FROM (
            SELECT CAST(badTime AS dec(4,2)) AS badTime FROM (
                SELECT 1.3 AS badTime 
                UNION select 2.3 
            ) z
        ) y
    ) x
) w 
```

# object - 在 c# 中从 Struct 调用属性

> ID：13588985
> 
> 赞同：2
> 
> 时间：2012-11-27T16:46:25.460
> 
> 标签：object, properties, struct, c#-2.0, field

我定义了一个结构，其中包含一个公共字段和一个分别名为 _one 和 One 的公共属性，现在我在主函数中实例化结构（不创建新对象），并从结构中调用属性，我正在编译时间错误说使用未分配的局部变量 One，但是当我调用字段 _one 时，它​​的工作原理非常符合我的预期：

```
 public struct myStruct
    {
        public int _one;
        public int One
        {
            get { return _one; }
            set { _one = value; }
        }
        public void Display()
        {
            Console.WriteLine(One);
        }
    }

static void Main(string[] args)
        {

            myStruct _struct;
            _struct.One = 2; // Does not works
            _struct._one = 2; // Works fine
        } 
```

谁能解释这背后的原因，无法理解这个概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T16:48:30.690

您需要初始化结构才能访问该属性 -`_struct`否则具有默认值：

```
myStruct _struct = new myStruct(); 
```

顺便说一句，[可变值类型是邪恶的](https://stackoverflow.com/questions/441309/why-are-mutable-structs-evil)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T17:46:29.713

这是不直观的行为，但它是*明确分配检查*规则所允许的。在 C# 语言规范的第 5.3 节中进行了极其详细的描述。本章开头的关键短语是：

> 除上述规则外，以下规则适用于结构类型变量及其实例变量：
> - 如果实例变量包含的结构类型变量被认为是明确分配的，则认为该实例变量是明确分配的。
> - 如果一个结构类型变量的每个实例变量都被认为是确定分配的，那么它就被认为是确定分配的。

正是后一条规则允许这样做。换句话说，您还可以通过分配其*所有*变量来初始化结构。您可以通过尝试这些片段来看到这一点：

```
myStruct _struct = new myStruct();
_struct.Display();   // fine by the 1st bullet

myStruct _struct;
_struct.Display();   // bad

myStruct _struct;
_struct._one = 2;
_struct.Display();   // fine by the 2nd bullet 
```

因此，您不会通过分配字段来获得 CS0165，因为这将不允许通过分配其变量来初始化结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T17:01:54.917

倾向于在类定义中使用读写属性而不是公开字段的原因不适用于结构，因为它们既不支持继承也不支持更新通知，并且结构字段的可变性取决于结构实例的可变性，*无论字段是否暴露*。如果一个结构应该表示一组相关但可以自由独立修改的变量，它应该简单地将这些变量公开为字段。如果带有支持字段的属性应该是只读的，则构造函数应该直接设置支持字段，而不是通过属性设置器。

# oracle - Oracle：为什么 select from user_ind_columns 这么慢？

> ID：13588986
> 
> 赞同：2
> 
> 时间：2012-11-27T16:46:27.993
> 
> 标签：oracle, oracle11g, database-metadata

Oracle 版本：Oracle Database 11g Enterprise Edition Release 11.2.0.3.0 - 64bit Production

我正在尝试从我的 Oracle 数据库中获取元数据（我在 Oracle 方面有点菜鸟，更像是一个 Sybase 人）。当我做

```
select * from USER_IND_COLUMNS 
```

仅返回 7211 行需要 4 分 41 秒！谁能告诉我为什么会这样？事实上，通常（在 Toad 或其他方式中）获取元数据似乎非常慢。所有建议表示赞赏，谢谢。

# java - Java - 两条线的碰撞检测

> ID：13588989
> 
> 赞同：0
> 
> 时间：2012-11-27T16:46:42.660
> 
> 标签：java, collision-detection, collision, graphics2d

我有一个游戏，其中敌人由带有大 g2d.setStroke(); 的线条组成；我如何找到这条线和另一条线之间的冲突？这是我画它的地方：

```
g2d.setStroke(new BasicStroke(thickness, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND));
//thickness = 35 --- declared previously
g2d.drawLine(x1, y1, x2, y2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T17:08:36.657

由于数学似乎不是您最喜欢的主题，所以让我们保持简单并使用学校数学。

```
g2d.drawLine(x1, y1, x2, y2);
g2d.drawLine(u1, v1, u2, v2); 
```

两条线段上的一点是：

```
(x, y) = (x1, y1) + alpha * (x2 - x1, y2 - y1)  where alpha in (0 .. 1).
(x, y) = (u1, v1) + beta * (u2 - u1, v2 - v1)  where beta in (0 .. 1). 
```

任何相交点都必须在这两条线段上，因此：

```
x1 + alpha * (x2 - x1) = u1 + beta * (u2 - u1);
y1 + alpha * (y2 - y1) = v1 + beta * (v2 - v1); 
```

这与以下内容相同：

```
alpha * (x2 - x1) = (u1 - x1) + beta * (u2 - u1);
alpha * (y2 - y1) = (v1 - y1) + beta * (v2 - v1); 
```

如果在 { 0, ..., 1 } 内有 alpha 和 beta 的解决方案，那么您就知道了。

如果任何辅因子 - 如`(x2 - x1)`- 为 0，那么您有一个简单的解决方案。否则，您可以除以/乘以一个辅因子。

或者你可以花一点时间学习线性代数基础知识、矩阵和行列式等。有了这些知识，您还可以确定 3D 表面是否朝向您：法线向量。

# eclipse - 如何让 MoreUnit 调试测试而不是运行它们？

> ID：13588995
> 
> 赞同：3
> 
> 时间：2012-11-27T16:46:53.587
> 
> 标签：eclipse, junit, moreunit

我刚刚开始使用[MoreUnit](http://moreunit.sourceforge.net/#home)，它看起来很方便。但是，我缺少的一件事是如何立即使用调试器运行测试，而不仅仅是简单的运行（使用 ^R）。

它不在上下文菜单中，我尝试了一些键盘快捷键变体无济于事......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:55:18.363

通常在 Eclipse 中，您可以在正常运行测试后单击调试按钮来调试它们（最后一次运行将创建一个启动配置，您也可以从调试菜单访问该配置）。

除此之外，您应该在“运行”和“调试”菜单中都找到“运行为 MoreUnit 测试...”（如果没有，请提交功能请求）。

最后，您应该能够通过选择“调试...”来打开“启动配置”向导，并且在左侧的树中应该有一个 MoreUnit 文件夹。树的上方是一个“+”选项，用于在文件夹中创建条目。