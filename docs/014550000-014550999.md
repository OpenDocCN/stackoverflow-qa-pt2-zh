# StackOverflow 问答 14550000-14550999

# xaml - LongListMultiSelector 中的项目之间的空间

> ID：14550001
> 
> 赞同：5
> 
> 时间：2013-01-27T17:24:02.253
> 
> 标签：xaml, windows-phone-8

在我的`LongListMultiSelector`中，如何设置项目之间的垂直空间，使其不会被选择矩形覆盖？只需在下面的 XAML 中添加一个边距，该边距就会被矩形覆盖。

```
<toolkit:LongListMultiSelector ItemsSource="{Binding Items}">
    <toolkit:LongListMultiSelector.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="Some Text" Margin="0,0,0,50" />
        </DataTemplate>
    </toolkit:LongListMultiSelector.ItemTemplate>
</toolkit:LongListMultiSelector> 
```

显示当我尝试选择一个项目时它的行为方式的图片。（注意蓝色矩形） ![在此处输入图像描述](../Images/c2f9457d3729a03dbbfcf288f4816398.png)

这是一个标准邮件应用程序的示例，其中项目有一些空间，但选择矩形没有覆盖它。（这就是我要的）
![在此处输入图像描述](../Images/cb98fa97976924ac62266a4e40e5d1a6.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T20:04:25.937

这是关于基本 XAML 概念的一个非常重要的问题：ItemsControl 数据绑定。C# 中的所有 ItemsControls 都能够获取数据类（称为“Items”）并将它们转换为可视 UIElements（称为“Containers”）。例如，ListBox 可以从其 ItemSource 中获取项目，创建新的 ListBoxItems 并将每个项目设置为其容器的 DataContext。这基本上就是所有 ItemsControl 的数据绑定工作方式。

为什么这很有趣？因为 LongListMultiSelector 是另一个 ItemsControl，它会生成 LongListMultiSelectorItems。在 ListBoxItem 和 LongListMultiSelectorItem 的情况下，实例化的 DataTemplate 都嵌套在 ItemTemplate 内，它只是容器的一部分。但是，您无法从 DataTemplate 内部控制容器的属性。这就是为什么您在这里所做的一切似乎都不起作用的原因。

解决方案：使用 ItemContainerStyle 更改容器本身的属性。

1）在具有以下 C# 和 XAML 代码的项目中打开混合：

```
this.DataContext = "foo bar baz".Split(' '); 
```

```
<Toolkit:LongListMultiSelector ItemsSource="{Binding}">
    <Toolkit:LongListMultiSelector.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding}" />
        </DataTemplate>
    </Toolkit:LongListMultiSelector.ItemTemplate>
</Toolkit:LongListMultiSelector> 
```

2) 选择 LongListMultiSelector。在顶部菜单上选择“对象--> 编辑附加样式--> 编辑ItemContainerSyle--> 创建空”并点击“确定”。

3) 由于 LongListMultiSelectorItem 在 Grid 和 List 之间更改了它的 ItemContainerStyle，因此您需要使用`<Setter />`以下任一样式中的所有 setter 手动替换样式中的所有元素。例如，我将 LongListMultiSelectorItemListStyle 中的所有设置器复制到我的新 LongListMultiSelectorItemStyle1 中。

```
<Style x:Key="LongListMultiSelectorItemGridStyle" TargetType="controls:LongListMultiSelectorItem">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="Padding" Value="0"/>
    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="controls:LongListMultiSelectorItem">
                <Border x:Name="LayoutRoot" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" VerticalAlignment="{TemplateBinding VerticalAlignment}">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal"/>
                            <VisualState x:Name="MouseOver"/>
                            <VisualState x:Name="Disabled">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="LayoutRoot">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource TransparentBrush}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <DoubleAnimation Duration="0" To=".5" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="ContentContainer"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="SelectionStates">
                            <VisualState x:Name="Unselected"/>
                            <VisualState x:Name="Selected">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="SelectionTriangle">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Visible</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="SelectionCheck">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Visible</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="HasSelectionStates">
                            <VisualState x:Name="Opened">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="SelectionRectangle">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Visible</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="OuterCover">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Visible</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Closed"/>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <Grid Margin="1" >
                        <ContentControl x:Name="ContentContainer"
                                Margin="3"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                Content="{TemplateBinding Content}"
                                Foreground="{TemplateBinding Foreground}"
                                HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                />
                        <Rectangle x:Name="SelectionRectangle" Visibility="Collapsed"
                                       Stroke="{StaticResource PhoneAccentBrush}" StrokeThickness="2"/>
                        <Polyline x:Name="SelectionTriangle" Visibility="Collapsed"
                                HorizontalAlignment="Right" VerticalAlignment="Top"
                                Points="50,0 50,50 0,0"
                                Fill="{StaticResource PhoneAccentBrush}"
                            />
                        <Polyline x:Name="SelectionCheck" Visibility="Collapsed"
                                Margin="5" HorizontalAlignment="Right" VerticalAlignment="Top"
                                Points="40,0 43,3 28,18 18,8 21,5 28,12"
                                Fill="{StaticResource PhoneForegroundBrush}"
                                />
                        <Grid x:Name="OuterCover" IsHitTestVisible="True" Visibility="Collapsed" Background="Transparent" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
                    </Grid>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="LongListMultiSelectorItemListStyle" TargetType="controls:LongListMultiSelectorItem">
    <Style.Setters>
        <Setter Property="Background" Value="{StaticResource PhoneAccentBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="controls:LongListMultiSelectorItem">
                    <Grid MinHeight="52">
                        <Grid.Resources>
                            <ExponentialEase EasingMode="EaseIn" Exponent="8" x:Key="ExponentialEaseIn"/>
                            <QuadraticEase EasingMode="EaseOut" x:Key="QuadraticEaseOut"/>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="SelectionEnabledStates">
                                <VisualStateGroup.Transitions>
                                    <VisualTransition x:Name="ClosedToExposed" 
                                                      From="Closed" To="Exposed"
                                                      GeneratedDuration="0:0:0.30">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="0.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.30" Value="1.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                    <VisualTransition x:Name="ExposedToClosed" 
                                                      From="Exposed" To="Closed"
                                                      GeneratedDuration="0:0:0.30">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="1.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.30" Value="0.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                    <VisualTransition x:Name="ExposedToOpened"
                                                      From="Exposed" To="Opened"
                                                      GeneratedDuration="0:0:0.30">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="-58" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="0" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="Presenter">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="24" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="86" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="1.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.30" Value="0.0" EasingFunction="{StaticResource QuadraticEaseOut}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.0" Value="Visible"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="InnerHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                    <VisualTransition x:Name="ClosedToOpened"
                                                      From="Closed" To="Opened"
                                                      GeneratedDuration="0:0:0.15">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="-58" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="0" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="Presenter">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="24" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="86" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.0" Value="Visible"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="InnerHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                    <VisualTransition x:Name="OpenedToClosed"
                                                      From="Opened" To="Closed"
                                                      GeneratedDuration="0:0:0.15">
                                        <Storyboard>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="0" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="-58" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                                           Storyboard.TargetName="Presenter">
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.0" Value="86" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="24" EasingFunction="{StaticResource ExponentialEaseIn}"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0.15" Value="Collapsed"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualTransition>
                                </VisualStateGroup.Transitions>
                                <VisualStateGroup.States>
                                    <VisualState x:Name="Closed"/>
                                    <VisualState x:Name="Exposed">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.Opacity)" 
                                                             Storyboard.TargetName="OuterHintPanel"
                                                             Duration="0" To="1.0"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Opened">
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                             Storyboard.TargetName="SelectBox"
                                                             Duration="0" To="0"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.TranslateX)" 
                                                             Storyboard.TargetName="Presenter"
                                                             Duration="0" To="86"/>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" 
                                                                           Storyboard.TargetName="SelectBox">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" 
                                                                           Storyboard.TargetName="OuterCover">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="Visible"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.Opacity)" 
                                                             Storyboard.TargetName="OuterHintPanel"
                                                             Duration="0" To="0.0"/>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="OuterHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.IsHitTestVisible)" 
                                                                           Storyboard.TargetName="InnerHintPanel">
                                                <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="False"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup.States>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid HorizontalAlignment="Stretch">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0" HorizontalAlignment="Stretch" primitives:ClipToBounds.IsEnabled="True">
                                <ContentPresenter x:Name="Presenter">
                                    <ContentPresenter.RenderTransform>
                                        <CompositeTransform TranslateX="24"/>
                                    </ContentPresenter.RenderTransform>
                                </ContentPresenter>
                            </Grid>
                            <Rectangle x:Name="InnerHintPanel" Grid.Column="0" Width="24"
                                       Height="{TemplateBinding HintPanelHeight}"
                                       HorizontalAlignment="Left"
                                       Fill="Transparent"
                                       StrokeThickness="0">
                                <Rectangle.RenderTransform>
                                    <CompositeTransform TranslateX="24"/>
                                </Rectangle.RenderTransform>
                            </Rectangle>
                            <ContentControl x:Name="InfoPresenter" Grid.Column="1" 
                                            VerticalAlignment="Top"
                                            Content="{TemplateBinding ContentInfo}"
                                            ContentTemplate="{TemplateBinding ContentInfoTemplate}"/>
                        </Grid>
                        <Rectangle x:Name="OuterHintPanel" Width="24"
                                   HorizontalAlignment="Left"
                                   Height="{TemplateBinding HintPanelHeight}"
                                   Fill="{TemplateBinding Background}"
                                   StrokeThickness="0" Opacity="0.0"/>
                        <Grid x:Name="OuterCover" IsHitTestVisible="True"
                              Visibility="Collapsed" Background="Transparent"/>
                        <Canvas HorizontalAlignment="Left">
                            <CheckBox x:Name="SelectBox" VerticalAlignment="Top" Margin="12,-20,5,0" Visibility="Collapsed"
                                      IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsSelected, Mode=TwoWay}">
                                <CheckBox.RenderTransform>
                                    <CompositeTransform TranslateX="-58"/>
                                </CheckBox.RenderTransform>
                            </CheckBox>
                        </Canvas>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style.Setters>
</Style> 
```

4) 确保修复 XMLNS 引用，如*toolkit*和*原语*。

5) 现在您可以编辑样式了。从顶部菜单转到“对象--> 编辑附加样式--> 编辑ItemContainerStyle--> 编辑当前”。

6) 将 ItemContainerStyle Margin 从“0”设置为“0, 0, 50, 0”。

![编辑 LongListMultiSelector 的 ItemContainerSyle 边距](../Images/9a478c9b56e6b4be08eb69a245231e4e.png)

当我们使用修改后的 ItemContainerStyle 运行 LongListMultiSelector 时，我们可以看到项目之间的以下空间：

![项目之间的空间](../Images/f08307bfb460397580903e30c200af05.png)

请务必记住，ItemContainerStyle 是我们武器库中非常强大的武器。我们可以使用 ItemContainerStyle 来编辑容器的样式，甚至是它们的模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T21:40:22.630

我有同样的错误`Primitives`。为了解决这个问题，我添加了这个参考：

```
xmlns:primitives="clr-namespace:Microsoft.Phone.Controls.Primitives;assembly=Microsoft.Phone.Controls.Toolkit" 
```

# visual-studio-2010 - VS2010 VC++ 安装项目缺少语言 dll

> ID：14550008
> 
> 赞同：0
> 
> 时间：2013-01-27T17:24:34.563
> 
> 标签：visual-studio-2010, visual-c++, dll, resources, installation

我在 VS2010 中为我的 VC++ 项目创建了一个安装项目，我让它生成一个安装文件，它包括来自我的 VC++ 项目的主要输出、内容文件、文档文件和资源卫星 DLL。我的 VC++ 项目是多语言的，因此在子目录中包含语言 DLL 文件。我的问题是安装项目不包括这些语言 DLL（也不包括它们必须放置的目录）。

我原以为这些 DLL 包含在项目输出中，但事实并非如此。：-/

我知道我可以通过直接引用文件来手动添加它们，但这意味着包括一个我不想做的绝对引用。此外，固定引用意味着不处理文件的发布/调试版本（无论项目设置如何，都只使用其中一个）。

建议？

编辑：我现在已经尝试过安装项目、InstallShield LE 和 WiX。它们都没有将本地化 dll 包含到安装项目中（仅使用安装项目管理一个工作设置，但可以看到其他安装程序没有包含所需的 dll）。我什至找不到任何关于这是一个已知错误的参考，我真的很努力地寻找解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T12:42:15.133

在那里找到它：

[C# 创建多语言设置](https://stackoverflow.com/questions/798886/c-sharp-creating-a-setup-for-multi-language)

有效。我希望这是你正在寻找的。

# .net - Mono.Cecil 如何定义输出参数

> ID：14550010
> 
> 赞同：4
> 
> 时间：2013-01-27T17:25:06.163
> 
> 标签：.net, il, mono.cecil

我想通过具有输出参数的 Mono.Cecil 添加一个新方法，例如：

```
private static bool XXXXX(out Int32 a) 
```

我尝试了以下代码来添加此参数

```
TypeReference typeInt32 = targetAssembly.MainModule.TypeSystem.Int32.Resolve();
typeInt32 = targetAssembly.MainModule.Import(typeInt32);
method.Parameters.Add(new ParameterDefinition(typeInt32) { Name = "a", IsOut = true }); 
```

我比较了我添加的和编译器生成的 IL 代码。它们是不同的。

**塞西尔添加的我的：**

```
.method private hidebysig static bool XXXXX([out] int32 a) cil managed 
```

**编译器生成：**

```
.method private hidebysig static bool XXXXX([out] int32& a) cil managed 
```

请问有人知道如何使我的 Cecil 添加方法与编译器生成的方法相同吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T22:12:26.593

我认为类型必须通过引用：（`int32&`或`ref int`在 C# 语法中）

```
ByReferenceType typeInt32ByRef = new ByReferenceType(typeInt32);
method.Parameters.Add(
    new ParameterDefinition(typeInt32ByRef) { Name = "a", IsOut = true }); 
```

# jpa - EJB继承策略

> ID：14550015
> 
> 赞同：-1
> 
> 时间：2013-01-27T17:25:46.637
> 
> 标签：jpa, ejb

**大更新：**

好的，我看到我的问题比我想象的要复杂得多。我有这样的表：

```
Patient:
id
bloodtype
level (FK to level table)
doctor (FK to doctor table)
person (FK to person table)

Doctor:
id
person (FK)
speciality
level (FK to level)

Paramedic:
id
person (FK)

Person:
id
name
surname

Account:
id
login
pass

Level:
id
account (FK)
name (one of: 'patient' , 'paramedic' , 'doctor') 
```

在实体类中，我现在`@Inheritance(strategy= InheritanceType.JOINED) @DiscriminatorColumn(discriminatorType=DiscriminatorType.STRING,name="name")`在类*Level*中使用。检查某人是否是前任。患者我有功能：

```
public boolean ifPatient(String login) {
    account = accountfacade.getByLogin(login);
    for (Level l : account.getLevelCollection()) {
        if (l instanceof Patient) {
            return true;
        }
    }
    return false;
} 
```

现在我的情况是：我以医生身份登录。我想添加一个病人。我有这样的事情：

```
public Doctor findDoctor(String login) {
        account = accountfacade.getByLogin(login);
        for (Doctor d : doctorfacade.findAll()) {
            if (d.getLevel().getAccount().getLogin().equals(login)) {
                doctor = d;
                return doctor;
            }
        }
    }
@Override
    public void addPatient(Account acc, Patient pat, Person per, String login) {
    Doctor d = findDoctor(login);
    accountfacade.create(acc);
    personfacade.create(per);
    Patient p = new Patient();
    p.setAccount(acc);
    p.setBlood(pat.getBlood());
// etc
    p.setPerson(per);
    d.getPatientCollection().add(p);
    acc.getLevelCollection().add(p);
    } 
```

但它不起作用。总是完全奇怪的错误，例如表 Account 中主键的重复值（但我使用`TableGenerator`...）或字段 Account 中的 NULL 值但对于 INSERT INTO Doctor （如何？！我正在创建新的 Patient，而不是 Doctor ...）。我现在完全迷路了，所以我认为现在对我来说最重要的是知道我是否真的可以`InheritanceType.JOINED`在这种情况下使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:30:13.910

更新：

您正在使用该字段`nazwa`作为鉴别器

```
@DiscriminatorColumn(discriminatorType=DiscriminatorType.STRING,name="nazwa") 
```

框架在那里存储了它必须用来反序列化对象的类的名称（它是`PoziomDostepu`类的名称）。

据我所知，您为每个班级使用不同的表格，所以这`Strategy.JOINED`没什么意义。

更多更新：

我说的`class`地方是什么意思`entity`。您可以通过更改实体名称（例如“CacaCuloPedoPis”）`PoziomDostepu`并查看插入的新值来检查效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:32:42.457

看起来缺少的只是 PoziomDostepu 类上的 @DiscriminatorValue 注释以使用约束中的值之一，否则它默认为类名。PoziomDostepu 的插入来自 this.poziom - 如果您不想插入 PoziomDostepu 实例，您可以使类抽象并确保此实例是子类。您不需要更改继承类型，因为这样做需要将数据库表更改为每个包含相同的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T01:03:17.783

好的，我已经完成了我想要的。它不优雅，但高效。表和继承策略是一样的。在端点中，我创建帐户和个人实体，然后创建*Patient*实体，但使用 EntityManager *persist()*方法。我还需要手动设置级别的 id，`((Integer)poziomfacade.getEntityManager().createQuery("SELECT max(p.idpoziom) FROM PoziomDostepu p").getSingleResult())+1`因为*级别*实体类中的生成器不起作用。尽管如此，问题已经解决，感谢每一个建设性的评论或回答。

# android - 如何在android中维护数据

> ID：14550018
> 
> 赞同：1
> 
> 时间：2013-01-27T17:26:07.667
> 
> 标签：android

你们能给我一些关于如何保持一定进度的想法吗？我正在开发一个有 10 个阶段的游戏，每个阶段都有许多问题，当用户在某个阶段完成所有问题时，他/她现在可以进入下一个阶段。现在我想要发生的是，如果用户例如达到或解锁了第二阶段，当他/她退出游戏并再次打开游戏时，用户将看到第二阶段的最后一个进度。我是android的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:41:43.620

您可以将所有重要数据保存到：

*   `sharedPreferences`
*   `db`比如 sqliteDb
*   外部的`files`

这取决于您需要存储多少信息。如果您只有一个这样的信息`stage=2`，您可以将其保存在共享首选项中，并在每次主要活动开始时阅读。如果您需要存储更多信息，`username, skill, features, weapon, etc`那么数据库可能是完美的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:30:30.690

如果要持久化的数据是简单的原始数据类型，则可以使用共享首选项；或者如果要保存大数据，请使用文件，或者也可以保存对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:32:07.410

您可以使用 Bundle savedinstancestate 对象来保存您的状态。为此有两个事件 onSavedInstanceState 和 restoreSavedInstanceState

```
@Override
 public void            onSaveInstanceState(Bundle
 outState){
  super.onSaveInstanceState
  (outState);
  outState.putString
   ("key", "value");
   }

 @Override
protected void
onRestoreInstanceState
(Bundle
savedInstanceState) {
situation =
savedInstanceState.
getString
("key");
super.
onRestoreInstanceState
(savedInstanceState);
} 
```

# php - CodeIgniter Active Record 从一个表插入到另一个表

> ID：14550021
> 
> 赞同：5
> 
> 时间：2013-01-27T17:26:15.030
> 
> 标签：php, mysql, codeigniter

使用 codeigniter 活动记录语法将数据从一个表插入到另一个表的语法是什么？我尝试了通常的 mysqli 查询，它可以工作，但我想使用 CodeIgniter Active Record 语法来保持一致性。

我尝试使用这些 CodeIgniter Active Record 查询，但仍然没有运气：

```
function insert_into()  
{    
    $this->db->insert('table1');
    $this->db->set('to_column');  
    $this->db->select('from_column');
    $this->db->from('table2');
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-27T17:50:19.980

我认为最好的方法是使用 get 方法从一个表中获取您想要的数据，然后使用查询结果抓取器函数之一（如 result() ），使用 insert() 逐一迭代行方法。

把它放在代码中：

> ```
> $query = $this->db->get('table1');
> foreach ($query->result() as $row) {
>       $this->db->insert('table2',$row);
> } 
> ```

当然，我认为 table1 与 table2 具有完全相同的结构（每列的列名和数据类型相同）。如果不是这种情况，您将不得不使用分配将列从一个表映射到另一个表，但如果是这种情况，您的代码将更宽。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-03T07:16:19.413

将 $source_table 复制到 $archive_table：

```
if(($this->db->table_exists($source_table) && ($this->db->table_exists($archive_table)){
    if ($this->db->query("CREATE TABLE $archive_table LIKE $source_table")){
        if($this->db->query("INSERT $archive_table SELECT * FROM $source_table")){
           echo 'copied ok';
        }
     } 
} 
```

比遍历整个结果集并一次插入一行更简洁。

# sql-server - 为什么 xp_cmdshell 在 SQL Server 2012 中不起作用？

> ID：14550024
> 
> 赞同：7
> 
> 时间：2013-01-27T17:26:25.237
> 
> 标签：sql-server, sql-server-2012

> **可能重复：**
> [启用“xp_cmdshell”SQL Server](https://stackoverflow.com/questions/5131491/enable-xp-cmdshell-sql-server)

当我`xp_cmdshell`在 SQL Server 2012 中运行命令时，我收到以下消息：

> SQL Server 阻止了对组件“xp_cmdshell”的过程“sys.xp_cmdshell”的访问，因为该组件作为该服务器安全配置的一部分被关闭。系统管理员可以使用 sp_configure 启用“xp_cmdshell”的使用。有关启用“xp_cmdshell”的详细信息，请在 SQL Server 联机丛书中搜索“xp_cmdshell”。

但是，在 SQL Server 2000 中，此查询已成功执行。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-27T18:00:44.170

从 SQL Server 2005 开始，这已被禁用，当时他们引入了[外围应用配置工具](http://msdn.microsoft.com/en-us/library/ms173748%28v=sql.90%29.aspx)，以努力使 SQL Server 在默认情况下更加安全。该工具已停用，但您仍然可以使用[`sp_configure`](http://msdn.microsoft.com/en-us/library/ms188787.aspx). [MSDN 上显示了一个示例](http://msdn.microsoft.com/en-us/library/ms190693.aspx)：

```
-- To allow advanced options to be changed.
EXEC sp_configure 'show advanced options', 1
GO
-- To update the currently configured value for advanced options.
RECONFIGURE
GO
-- To enable the feature.
EXEC sp_configure 'xp_cmdshell', 1
GO
-- To update the currently configured value for this feature.
RECONFIGURE
GO 
```

（我[多年前也写过关于这个的博客](http://aspfaq.com/sql2005/show.asp?id=29)。）

原因是这是一个潜在的安全漏洞。如果您允许 SQL Server 执行[`xp_cmdshell`](http://msdn.microsoft.com/en-us/library/ms175046.aspx)，那么理论上它们可以在那里发送*任何*操作系统命令，从而绕过您认为拥有的任何和所有安全性。当 SQL Server 服务帐户和/或代理帐户被提升到 sysadmin 或其他级别时，这尤其成问题，因为这比仅明确定义他们应该能够做的事情更容易。

与其启用和禁用它以支持命令行交互，一种公开操作系统功能同时仍对安全性有一定控制权的流行方法是使用 SQL-CLR 实现所需的操作系统级功能。这是[使用 CLR 访问文件系统的一个很好的起点](http://msdn.microsoft.com/en-us/library/ms345135%28v=sql.90%29.aspx)（但是，如果您四处搜索，您会发现更现代和详尽的方法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T17:34:48.177

这对于 sql server 2012 是禁用的。但是您可以在 sql server 2008 中运行以下命令。

```
EXEC sp_configure 'xp_cmdshell', 1
RECONFIGURE 
```

# datepicker - 设置 DateInputElement 的初始值

> ID：14550025
> 
> 赞同：0
> 
> 时间：2013-01-27T17:26:28.587
> 
> 标签：datepicker, dart

我需要为 DateInputElement 设置初始值。.dart 文件有一个带有初始值的变量 dob：

```
String dob='01/01/2013' 
```

和 html 有

```
<input id='mydob' type='date' name='dob' required='true' bind-value='dob'/> 
```

显示 UI 时不显示 dob。控件显示 mm/dd/yyyy。如果我在 UI 上选择日期，日期值将填充到 dob 变量中。

虽然 bind-value 设置了双向绑定，但仍然尝试将 value 设置为 dob 如下，但没有成功：

```
<input id='mydob' type='date' name='dob' required='true' value={{dob}}  bind-  value='dob'/> 
```

在生命周期事件中也尝试了以下但没有奏效：

```
DateInputElement e = query('#mydob');
e.value=dob; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T08:49:29.697

您尝试输入该字段的格式是错误的。它应该是`2013-01-01 (YYYY-MM-DD)`根据[RFC](http://www.w3.org/TR/html-markup/references.html#refsRFC3339)。这完全独立于 dart 或任何其他绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T02:20:27.357

我要补充一点，有 0 是必要的。所以它是 2013-01-01 而不是 2013-1-1

# android - 尝试从 MainActivity 访问函数

> ID：14550031
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:05.253
> 
> 标签：android, import

我正在尝试将 MainActivity 函数访问到我的另一个 java 类。但我无法使用这些功能。请告诉我还需要添加什么才能访问它。

我的代码：我在哪里尝试访问我的 MainActivity

```
 package com.example.musicplayer;

  **import com.example.musicplayer.MainActivity;**
  import android.app.Activity;
  import android.os.Bundle;
  import android.view.View;
  import android.view.View.OnClickListener;
  import android.widget.Button;
  import android.widget.TextView;
  import android.widget.Toast;

  public class current_song extends Activity implements OnClickListener{

     MainActivity ma = new MainActivity();
     protected void onCreate(Bundle icicle) {

     Bundle extra = getIntent().getExtras();

     super.onCreate(icicle);
     setContentView(R.layout.songplay_page);

     if(extra != null){
         String song_name = extra.getString("song_name");
         TextView textchange = (TextView)findViewById(R.id.current_song_name);
         textchange.setText(song_name);
         textchange.setSelected(true);
     }       

     Button btn_pause = (Button)findViewById(R.id.pause_btn);
     btn_pause.setOnClickListener(this);    

     Button btn_next = (Button)findViewById(R.id.next_btn);
     btn_next.setOnClickListener(this);

     Button btn_prv = (Button)findViewById(R.id.prv_btn);
     btn_prv.setOnClickListener(this);
 }

   @Override
   public void onClick(View v) {
    // TODO Auto-generated method stub
    Toast.makeText(getApplicationContext(), "In Onclick ()", Toast.LENGTH_SHORT).show();
    switch(v.getId())
    {
        case R.id.pause_btn:
            Toast.makeText(getApplicationContext(), "pause", Toast.LENGTH_SHORT).show();
            ma.pause();
        break;

        case R.id.next_btn:
            ma.next();
        break;

        case R.id.prv_btn:
            ma.prv();
        break;

    }

}

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:47:41.870

确保 MainActivity 有一个零参数构造函数，并且 pause 、 next 和 prv 函数的访问说明符是公共的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:02:03.527

为了响应“*我有一些由我定义的方法 stop()、next()、pri() 我试图在单击每个按钮时访问这些方法。如果您认为“创建一个单独的公共类来共享所有方法“你能告诉我一个例子吗，因为我不知道如何从一个活动访问一个方法到另一个活动。* ”

```
public class myController{

private MyActivity m;

public myController(MyActivity m){
   this.m = m;
}

public void stop(){
   m.stop;
}

} 
```

在其他类中，您在主活动中初始化并将控制器对象传递给它，以便它可以调用停止方法

# python - 字符串中的数字总和

> ID：14550034
> 
> 赞同：9
> 
> 时间：2013-01-27T17:27:14.127
> 
> 标签：python, string, sum, digits

如果我只是`sum_digits`在这里阅读我的函数，这在我的脑海中是有道理的，但它似乎产生了错误的结果。任何提示？

```
def is_a_digit(s):
''' (str) -> bool

Precondition: len(s) == 1

Return True iff s is a string containing a single digit character (between
'0' and '9' inclusive).

>>> is_a_digit('7')
True
>>> is_a_digit('b')
False
'''

return '0' <= s and s <= '9'

def sum_digits(digit):
    b = 0
    for a in digit:
        if is_a_digit(a) == True:
            b = int(a)
            b += 1

    return b 
```

对于函数`sum_digits`，如果我输入`sum_digits('hihello153john')`，它应该产生`9`

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-27T17:32:16.227

请注意，您可以使用内置函数轻松解决此问题。这是一个更惯用和有效的解决方案：

```
def sum_digits(digit):
    return sum(int(x) for x in digit if x.isdigit())

print(sum_digits('hihello153john'))
=> 9 
```

特别要注意的是`is_a_digit()`字符串类型的方法已经存在，它被称为[`isdigit()`](http://docs.python.org/2/library/stdtypes.html#str.isdigit).

并且函数中的整个循环`sum_digits()`可以使用生成器表达式作为`sum()` 内置函数的参数更简洁地表示，如上所示。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-27T17:32:00.463

如果是一个数字，您正在重置`b`每次迭代的值。`a`

也许你想要：

```
b += int(a) 
```

代替：

```
b = int(a)
b += 1 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-27T18:45:31.197

使用内置函数的另一种方法是使用[reduce](http://docs.python.org/2/library/functions.html#reduce)函数：

```
>>> numeric = lambda x: int(x) if x.isdigit() else 0
>>> reduce(lambda x, y: x + numeric(y), 'hihello153john', 0)
9 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T18:25:46.170

一个班轮

```
sum_digits = lambda x: sum(int(y) for y in x if y.isdigit()) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-29T17:59:17.287

另一种方法：

```
def digit_sum(n):
  new_n = str(n)
  sum = 0
  for i in new_n:
    sum += int(i)
  return sum 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-03T07:23:11.873

我想提出一个使用 regx 的不同解决方案，涵盖两种情况：

1.
输入 = 'abcd45def05'
输出 = 45 + 05 = 50

```
import re
print(sum(int(x) for x in re.findall(r'[0-9]+', my_str))) 
```

注意“+”表示出现一次或多次

2.
输入 = 'abcd45def05'
输出 = 4 + 5 + 0 + 5 = 14

```
import re
print(sum(int(x) for x in re.findall(r'[0-9]', my_str))) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-27T17:36:59.897

您的代码的等效项，使用列表推导：

```
def sum_digits(your_string):
    return sum(int(x) for x in your_string if '0' <= x <= '9') 
```

它将比“for”版本运行得更快，并节省大量代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-17T09:35:48.930

只是@oscar 答案的一个变体，如果我们需要总和为个位数，

```
def sum_digits(digit):
    s = sum(int(x) for x in str(digit) if x.isdigit())
    if len(str(s)) > 1:
        return sum_digits(s)
    else:
        return s 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-09T15:03:37.207

```
#if string =he15ll15oo10
#sum of number =15+15+10=40

def sum_of_all_Number(s):
    num = 0
    sum = 0

    for i in s:
        if i.isdigit():
            num = num * 10 + int(i)
        else:
            sum = sum + num
            num = 0
    return sum+num

#if string =he15ll15oo10
#sum of digit=1+5+1+5+1+0=13

def sum_of_Digit(s):
    sum = 0

    for i in s:
        if i.isdigit():
             sum= sum + int(i)

    return sum

s = input("Enter any String ")

print("Sum of Number =", sum_of_all_Number(s))
print("Sum Of Digit =", sum_of_Digit(s)) 
```

# sql-server-2008 - MongoDB查询相关记录

> ID：14550035
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:31.457
> 
> 标签：sql-server-2008, node.js, mongodb

我有一个博客应用程序。我需要做一个**MongoDB 查询**（SQL*很好*，我会翻译它），以获得博客中的特定帖子，以及该帖子之前和之后的即时帖子。

例如，给定这个帖子列表：

```
12/01/13 - Foo
15/01/13 - Bar
17/01/13 - Baz
27/01/13 - Taz 
```

如何编写查询以便获得其中一个 ig`Bar`和**直接的兄弟姐妹** `Foo`and `Baz`？

出于性能原因，我想在*不对数据库进行三个不同查询的情况下执行此操作。*

在我的应用程序中，我获取了一个这样的帖子：

```
model.findOne({
    date: {
        $gte: new Date(2013, 0, 15),
        $lt: new Date(2013, 0, 15, 24)
    },
    slug: 'Bar'
}, function(result){
    return { entry: result };
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:55:56.490

这是一种可能性（涉及 2 个查询，一个查找主要帖子，第二个查找最近的文档）：

*   将数据/帖子视为双向链接列表。
*   您需要将参考 ID 存储为每个帖子文档（数组）中“上一个”和“下一个”帖子的链接。这使得插入稍微复杂一些，但在过去某处按日期插入“新”博客文章似乎不太可能。
*   索引链接字段
*   在链接字段中搜索具有主文档[$ id 的文档](http://docs.mongodb.org/manual/reference/operator/in/)

# wordpress - 使用 functions.php 浏览 Wordpress 同级页面

> ID：14550036
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:32.690
> 
> 标签：wordpress, navigation, siblings

我正在尝试找到一种方法来浏览我的 wordpress 托管网站上的兄弟页面。经过一番搜索，我发现[将](https://stackoverflow.com/questions/4533407/browsing-page-siblings-through-next-previous-links)其放入我的functions.php中：

```
function siblings($link) {
global $post;
$siblings = get_pages('child_of='.$post->post_parent.'&parent='.$post->post_parent);
foreach ($siblings as $key=>$sibling){
    if ($post->ID == $sibling->ID){
        $ID = $key;
    }
}
$closest = array('before'=>get_permalink($siblings[$ID-1]->ID),'after'=>get_permalink($siblings[$ID+1]->ID));

if ($link == 'before' || $link == 'after') { echo $closest[$link]; } else { return $closest; } } 
```

它几乎可以满足我的需要。唯一的问题是：

1.  它按字母顺序对它们进行排序，我需要它们按订单号排序
2.  我需要它循环（所以最后一页链接到第一页）而不仅仅是结束
3.  它会自动显示“Previous of Next”，我想去掉那个“of”

如果有人对这三个问题中的任何一个提出意见，我将不胜感激。我自己正在做一些修补，但我认为你们中的大多数人可能在这方面比我好很多。那个，我已经得到“500个服务器错误”的次数太多了。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:30:15.230

这是您修改后的代码。它解决了您的前两个请求。最后一个不是提供的代码的一部分。此代码不会生成任何一个提及的单词。它只回显或返回永久链接。

```
function siblings($link) {
global $post;
$siblings = get_pages('child_of='.$post->post_parent.'&parent='.$post->post_parent.'&sort_column=menu_order');
foreach ($siblings as $key=>$sibling){
    if ($post->ID == $sibling->ID){
        $ID = $key;
    }    
}

if( $ID == 0 ){
    $closest = array('before'=>get_permalink($siblings[count($siblings)-1]->ID),'after'=>get_permalink($siblings[$ID+1]->ID));  
}elseif( $ID == count($siblings)-1 ){
    $closest = array('before'=>get_permalink($siblings[$ID-1]->ID),'after'=>get_permalink($siblings[0]->ID));
}else{
    $closest = array('before'=>get_permalink($siblings[$ID-1]->ID),'after'=>get_permalink($siblings[$ID+1]->ID));   
}

if ($link == 'before' || $link == 'after') { echo $closest[$link]; } else { return $closest; } } 
```

**编辑：将****&sort_column=menu_order**添加到 get_pages 参数以解决第一个请求

# python - Python从元组转换为字符串

> ID：14550037
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:44.903
> 
> 标签：python, string, tuples

我知道对你们中的许多人来说这很容易，但对我来说不是。所以我试图从shell输出数据，但是当我必须将它转换为字符串时我被卡住了。我试过了`for`，但没有用。所以基本上，我正在尝试的是：对于我的 shell 中的每个新行，输出新行。我举个例子——`free -m`命令。它的输出是

```
 total       used       free     shared    buffers     cached
  Mem:           144        512        111          0          0        121
  -/+ buffers/cache:         23        232
  Swap:            0          0          0 
```

所以，到目前为止我写的是：

```
import commands
foo...
sout = commands.getstatusoutput(inp)
    return ' '.join(str(line) for line in sout)
foo... 
```

但输出只有一行（第一行 - 总计、已使用、免费、共享等）

我希望每个新行都有新行，就像 shell 中的输出一样。如果我离开它没有 .join 它输出类似

```
(0, '             total       used       free     shared    buffers     cached\nMem:           512        144        368          0          0        121\n-/+ buffers/cache:         21        234\nSwap:            0          0          0') 
```

由于我希望它是一个字符串，我什至尝试过`'\n'.join`，但它只输出`0`（wtf）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:37:31.227

您也可以使用更方便的 os.popen。

```
print os.popen('free -m').read() 
```

您可能希望阅读此线程以全面了解可用于从 python 中运行 shell 命令的选项 在 Python[中调用外部命令](https://stackoverflow.com/questions/89228/calling-an-external-command-in-python)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:31:44.957

整个字符串都在元组中，带有换行符和所有内容，所以我想你需要做的就是：

```
print sout[1] 
```

假设这`sout`是您在问题中显示的元组：

```
(0, '             total       used       free     shared    buffers     cached\nMem:           512        144        368          0          0        121\n-/+ buffers/cache:         21        234\nSwap:            0          0          0') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:41:21.513

只需检查换行符，然后在输出中插入换行符。实际上你在这里得到了一个整体的输入。希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:00:10.920

还有另一种方法可以获得相同的结果：

```
 from subprocess import Popen, PIPE
    // Create a subprocess and then interact with the process by reading data from 
    // stdout, untill the end-of-file is reached. Since communicate return tuple 
    // in the form of stdout, stderr), Capture only the output.

    (result, errcode) = Popen('free -m', stdout = PIPE, shell = True).communicate()
    print result 
```

# mysql - 在包含模型后使用最后一个不起作用

> ID：14550038
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:48.873
> 
> 标签：mysql, database, ruby-on-rails-3

我被卡住了（对 Rails 还是很陌生），无法弄清楚为什么它不起作用：

我有：

```
 class Message < ActiveRecord::Base
     attr_accessible :updated_at
     has_many :categories_messages
     has_many :categories, through: :categories_messages
    end

    class CategoriesMessage < ActiveRecord::Base
     attr_accessible :category_id, :message_id
     belongs_to :category
     belongs_to :message
    end

    class Category < ActiveRecord::Base
     attr_accessible :name
     has_many :categories_messages
     has_many :message, through: :categories_messages
    end

    @messagesPer = Category.all.includes(:messages).group('categories.id').order("COUNT(messages.id) DESC")

    <% @messagesPer.each_with_index do |message,  i| %>
         <tr>
            <td><%= i+1 %></td> 
            <td><%= message.name %></td>
            <% if message.categories_messages.exists? %>
                <td><%= message.messages.last.updated_at.to_s.to_date %></td>
                <td><%= message.messages.first.updated_at.to_s.to_date %></td>
                <td><%= message.messages.count %></td>
            <% else %>
                <td>0</td>
                <td>0</td>
            <% end %>
        </tr>
    <% end %> 
```

所以我希望它显示：类别的名称、最后一条消息的创建日期、第一条消息的创建日期以及该类别中的所有消息。

ALL 工作正常，除了它只显示第一条消息的创建日期，但从不显示最后一条消息（仍然显示最后一条消息的第一个日期）。我究竟做错了什么？

更新：

如果我把

```
 @messagesPer = Category.all.includes(:messages).group('categories.id') 
```

它确实显示了最后一条消息和第一条消息的正确日期，但是一旦我添加订单它就会中断......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:45:53.200

在向查询中添加 order 子句后，包含您获得的错误信息可能会有所帮助。

但是，我可以在代码中发现一些奇怪的东西。该`CategoriesMessage`模型似乎只是为了满足一个类别可以包含许多消息的条件，反之亦然。你不需要模型来处理这种多对多关系，Rails 会自动为你处理。

您的模型应如下所示：

```
class Message < ActiveRecord::Base
 attr_accessible :updated_at
 has_and_belongs_to_many :categories
end

class Category < ActiveRecord::Base
 attr_accessible :name
 has_and_belongs_to_many :messages
end 
```

在您的数据库中，您有这些表：`messages`、`categories,`categories_messages `, where the last one is the join table which only contains columns for a`message_id `and a`category_id`。

然后你可以简单地在你的代码中做这样的事情：

```
category.messages.each { |message| puts message.updated_at } 
```

另请参阅[这篇 Ruby on Rails 教程文章](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association)以获取更多信息。如果这对您不起作用，请发布您得到的确切错误。

# javascript - jqrid - 将 cellattr 添加到 json colmodel

> ID：14550040
> 
> 赞同：0
> 
> 时间：2013-01-27T17:27:55.213
> 
> 标签：javascript, json, jqgrid

我一直在尝试向`cellattr`我的 json 响应添加一个函数，`colmodel`但似乎无法触发它。我已经尝试添加类和样式，但我想我会尝试记录一些东西，看看我是否可以让它工作。

这是我返回的 json 中的一个片段：

```
{
"name":"15/09/2012",
"index":"Sep 2012",
"align":"center",
"width":30,
"frozen":false,
"sortable":false,
"cellattr":"function (rowId, tv, rawObject, cm, rdata) { console.log('test'); 
} 
```

想知道是否有人对此有任何经验并可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:56:47.317

看看 JQgrid 在[Wiki](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acolmodel_options)上的 colModel cellattr 是或类型函数而不是字符串，所以你需要有这样的东西

```
{
"name":"15/09/2012",
"index":"Sep 2012",
"align":"center",
"width":30,
"frozen":false,
"sortable":false,
"cellattr":"myfunction" 
}

function myfunction(rowId,val,rawObject,cm,rdata)
{
      return "some string";
} 
```

您定义函数的方式只是定义一个字符串，而不是一个实际的 js 函数。

如果你被内联定义卡住了，你可以使用 function(){} 格式来创建新的匿名函数。

# jquery - jQuery UI 手风琴使所有部分的大小与最大的部分相同

> ID：14550041
> 
> 赞同：4
> 
> 时间：2013-01-27T17:27:58.117
> 
> 标签：jquery, css, jquery-ui-accordion

我正在使用 jQuery UI 手风琴效果，我似乎无法正确调整 div 的大小。我希望第二个是 900x900 以适应嵌入式地图。前一部分只需要大约 400 高，我无法用下面的 CSS 解决问题。

```
.accordion-section{
background: #F5F5F5;
box-shadow: 3px 3px 3px #888;
border-radius: 15px;
position: relative;
margin-top: 2px;
margin-bottom: 10px;
padding: .5em .5em .5em .7em;
display: block;

}

#FIRSTACCORDIONDIV{

overflow:hidden;
    height:400px;

} 
```

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T17:43:48.360

您可以将手风琴的[heightStyle](http://api.jqueryui.com/accordion/#option-heightStyle)选项设置为`content`. 这样，每个部分的高度将仅与容纳其内容所需的一样高。

您可能还想从 CSS 中删除规则，以便用户不会错过标记`#FIRSTACCORDIONDIV`下方的自然部分布局和可能的内容。`400px`

# ios - 解析 XML 有时会返回奇怪的代码

> ID：14550048
> 
> 赞同：1
> 
> 时间：2013-01-27T17:28:13.527
> 
> 标签：ios, xml, xcode, xml-parsing

我正在用 XCode 解析一个非常简单的 XML 文档。有时它工作得很好，其他时候它返回这个：

document.cookie='llllll=9bb65648llllllll_9bb65648; 路径=/';window.location.href=window.location.href;

这是我的头文件：

```
@interface NewsViewController : UIViewController{

NSXMLParser *rssParser;
NSMutableArray *articles;
NSMutableDictionary *item;
NSString *currentElement;
NSMutableString *ElementValue;
BOOL errorParsing;
}

@property (weak, nonatomic) IBOutlet UILabel *newsText;
@property (retain) NSMutableString *theString;

- (void)parseXMLFileAtURL:(NSString *)URL;
@end 
```

这是我的实现代码：

```
-(void)viewDidLoad{
 [self parseXMLFileAtURL:@"http://www.domain.com/news.xml"];
}
- (void)parserDidStartDocument:(NSXMLParser *)parser{
NSLog(@"File found and parsing started");
}

- (void)parseXMLFileAtURL:(NSString *)URL
{

NSString *agentString = @"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_6; en-us) AppleWebKit/525.27.1 (KHTML, like Gecko) Version/3.2.1 Safari/525.27.1";
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:
                                [NSURL URLWithString:URL]];
[request setValue:agentString forHTTPHeaderField:@"User-Agent"];
NSData *xmlFile = [ NSURLConnection sendSynchronousRequest:request returningResponse: nil error: nil ];

articles = [[NSMutableArray alloc] init];
errorParsing=NO;

rssParser = [[NSXMLParser alloc] initWithData:xmlFile];
[rssParser setDelegate:self];

// You may need to turn some of these on depending on the type of XML file you are parsing
[rssParser setShouldProcessNamespaces:NO];
[rssParser setShouldReportNamespacePrefixes:NO];
[rssParser setShouldResolveExternalEntities:NO];

[rssParser parse];

}
- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError {

NSString *errorString = [NSString stringWithFormat:@"Error code %i", [parseError code]];
NSLog(@"Error parsing XML: %@", errorString);

errorParsing=YES;
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{
currentElement = [elementName copy];
ElementValue = [[NSMutableString alloc] init];
if ([elementName isEqualToString:@"item"]) {
    item = [[NSMutableDictionary alloc] init];

}

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
[ElementValue appendString:string];
}
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{
if ([elementName isEqualToString:@"item"]) {
    [articles addObject:[item copy]];
} else {
    [item setObject:ElementValue forKey:elementName];
    NSLog (@"--%@",ElementValue);
}

}

- (void)parserDidEndDocument:(NSXMLParser *)parser {

if (errorParsing == NO)
{
    NSLog(@"XML processing done!");
    theString=[NSString stringWithFormat:@"%@",ElementValue];
    NSLog (@"Parsed: %@",theString);
} else {
    NSLog(@"Error occurred during XML processing");
}

} 
```

我很困惑，但我敢肯定这一定是一些我看不到的简单事情。有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:37:13.403

您尝试解析的响应（可能）不在 XML 中。

NSLog 您的 xml 响应，并查看服务器返回奇怪代码时返回的内容。在解析之前验证 xml。

# python - 使用 requests 模块导出 csv

> ID：14550050
> 
> 赞同：3
> 
> 时间：2013-01-27T17:28:27.873
> 
> 标签：python, export-to-csv, python-requests

我是 Python 的初学者，我一直在尝试将我的数据导出到 csv 文件，但我不知道如何摆脱所有括号和逗号分隔。理想情况下，我需要两列：一列包含“count”的所有值，另一列包含“month”的值。

任何建议表示赞赏。

我的代码：

```
from sunlight import capitolwords
import requests
import csv

r = requests.get ('http://capitolwords.org/api/1/dates.json?phrase=guns&start_date=2011-  
12-01&end_date=2013-01-
15&granularity=month&sort=count&apikey=ab02633fb17841d09f4c3660e0384ae5')
data = r.text

ifile = open('guns.csv', 'rb')
reader = csv.reader(data.splitlines(), delimiter=',')
for row in reader:
    print row 
```

结果：

```
 ['{']
  ['    "results": [']
  ['        {']
  ['            "count": 62.0', '']
  ['            "month": "201212"']
  ['        }', '']
  ['        {']
  ['            "count": 36.0', '']
  ['            "month": "201207"']
  ['        }', '']
  ['        {']
  ['            "count": 35.0', '']
  ['            "month": "201112"']
  ['        }', '']
  ['        {']
  ['            "count": 27.0', '']
  ['            "month": "201202"']
  ['        }', '']
  ['        {']
  ['            "count": 27.0', ''] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T17:35:25.743

由于响应是 Json，因此使用以下命令加载 json 数据：

```
data = r.json()["results"] # read the json response and keep the results part 
```

然后写入 csv 文件：

```
with open("guns.csv", "wb") as csvfile:
    f = csv.writer(csvfile)
    f.writerow(["Count", "Month"]) # write the headers if you like
    for elem in data:
        f.writerow([elem["count"], elem["month"]]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-08T04:26:29.740

我想对@thikonom 上面所说的内容进行一些解释。

```
r.json() 
```

当您使用 r.json() 时，您将**r**中的内容解释为**json**。在您发送的查询字符串中，提示您的数据是 json。如果你熟悉 json，结果也看起来像 json。

```
r.json()["results"] 
```

您现在告诉 json 搜索结果**r**以查找带有键的字典：**results**。能够看到您对查询的期望是一个很大的帮助，其中**结果**显示在您粘贴到上面窗口的结果中。我们还认识到它以字典显示的标准方式显示：

```
{'results': [{'month': '201212', 'count': 62.0}... 
```

等等。**结果**在这种情况下是**键，** **:**之后的其余数据被认为是**键的值**。使用 ~> r.json()["results"] <~ 返回**结果**值。但是，您会注意到**'month'**和**'count'**也包含在 {} 中，这意味着它们本身就是键值对。这意味着您有字典嵌套在字典中！

```
f.writerow([elem["count"], elem["month"]]) 
```

逐行遍历，提取两个键的**值：** **count**和**month**，然后将其存储到 *.csv 文件中。

希望这可以帮助别人！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-27T17:37:09.400

如果 CSV 包不是强制性的，您可以使用正常的输出操作并使用 CSV 保存文件。CSV 只是一个 txt 文件，其中 cols 用逗号分隔。

在这里你怎么能做到这一点。

```
with open("abc.csv","w+") as fh:
    str = "count: 62.0"

    str = str + ",month: 201212" 

    fh.writeline(str) 
```

# image-processing - 将帧从 GIF 提取到 PNG 时丢失数据？

> ID：14550055
> 
> 赞同：4
> 
> 时间：2013-01-27T17:28:54.817
> 
> 标签：image-processing, imagemagick, python-imaging-library, tumblr, gif

当我尝试使用 fraxel 的答案时

`http://stackoverflow.com/questions/10269099/pil-convert-gif-frames-to-jpg`

在图像上`http://24.media.tumblr.com/fffcc2d8e980fbba4f87d51ed4916b87/tumblr_mh8uaqMo2I1rkp3avo2_250.gif`

我得到了一些好的数据，但是对于一些我得到了丢失的数据，它看起来像，例如

## 正确的

![正确_1](../Images/15a35f1afa0e08a33c30c09359e5fb08.png) ![正确_2](../Images/8ed9ddfea253efcdc63e1e0455453cf6.png)

## 失踪

![缺少_1](../Images/97ac0568a6932a5332edffacbd8e70a2.png) ![在此处输入图像描述](../Images/d4f1baa7023ace004eae58df2dd5e209.png)

为了显示这些，我使用 imagemagick's`display foo*` 然后使用空间来移动图像......是否可能 imagemagick 读错了？

编辑：

即使使用转换然后显示通过`display foo*` 我得到以下

![在此处输入图像描述](../Images/a441dcf710b743c23360776511af131f.png) ![在此处输入图像描述](../Images/e1686ee41bb9f1a15566af3f8eb67e82.png) ![在此处输入图像描述](../Images/056cefc100868de0867da2308e2a5263.png) ![在此处输入图像描述](../Images/1a5b3a637f5922c6ac3df94b0db149b4.png)

那么，这可能是 gif 的特征吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:49:38.890

如果您可以坚持使用 ImageMagick，那么解决此问题非常简单：

```
convert input.gif -coalesce output.png 
```

否则，您将不得不考虑如何构建每个 GIF 帧的不同形式。对于这种特定类型的 GIF，以及您的另一个问题中显示的另一种 GIF，以下代码有效（请注意，在您之前的问题中，接受的答案实际上并没有使所有拆分部分透明 - 至少在最新的发布 PIL）：

```
import sys
from PIL import Image, ImageSequence

img = Image.open(sys.argv[1])

pal = img.getpalette()
prev = img.convert('RGBA')
prev_dispose = True
for i, frame in enumerate(ImageSequence.Iterator(img)):
    dispose = frame.dispose

    if frame.tile:
        x0, y0, x1, y1 = frame.tile[0][1]
        if not frame.palette.dirty:
            frame.putpalette(pal)
        frame = frame.crop((x0, y0, x1, y1))
        bbox = (x0, y0, x1, y1)
    else:
        bbox = None

    if dispose is None:
        prev.paste(frame, bbox, frame.convert('RGBA'))
        prev.save('foo%02d.png' % i)
        prev_dispose = False
    else:
        if prev_dispose:
            prev = Image.new('RGBA', img.size, (0, 0, 0, 0))
        out = prev.copy()
        out.paste(frame, bbox, frame.convert('RGBA'))
        out.save('foo%02d.png' % i) 
```

最终，您将不得不重新创建所做的事情`-coalesce`，因为上面的代码可能不适用于某些 GIF 图像。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-27T17:54:54.847

您应该尝试将帧的整个历史记录保留在“背景”中，而不是：

```
background = Image.new("RGB", size, (255,255,255))
background.paste( lastframe )
background.paste( im2 ) 
```

只需在循环之前创建一次“背景”，然后只在其上粘贴（）框架，它应该可以工作。

# regex - XSD 正则表达式不匹配

> ID：14550057
> 
> 赞同：0
> 
> 时间：2013-01-27T17:29:34.820
> 
> 标签：regex, xsd

我正在根据其他人的 XSD 规范创建一个 XML 文件，但我就是不知道为什么它不验证。

这是规则：

```
<xs:simpleType name="NonEmptyStringType">
    <xs:restriction base="xs:string">
        <xs:minLength value="1" />
        <xs:pattern value="[^\t\n\r]*[^\s][^\t\n\r]*" />
    </xs:restriction>
</xs:simpleType> 
```

我在其中阅读模式如下：

*   `[^\t\n\r]*`匹配任何不是制表符、换行符或~~空格~~的内容返回 0 次或更多次
*   `[^\s]`匹配任何不是空格的东西
*   `[^\t\n\r]*`匹配任何不是制表符、换行符或~~空格~~的内容返回 0 次或更多次

以下是许多不匹配的 xml 之一的示例：

```
 <Zipcode>3506 RT</Zipcode> 
```

根据 xmllint，它不匹配`3506 RT`（或者`3506RT`就此而言，以及我希望匹配的许多其他内容），并出现以下错误：

```
element Zipcode: Schemas validity error : Element '{http://www.reeleezee.nl/taxonomy/1.23}Zipcode': [facet 'pattern'] The value '3506 RT' is not accepted by the pattern '[^\t\n\r]*[^\s][^\t\n\r]*'. 
```

关于我没有正确解释的任何提示？（顺便说一句，我不明白他们 NonEmptyStringType 的严格性，我只会使用 .+）

* * *

根据要求，这是邮政编码声明：

```
<xs:element name="Zipcode" minOccurs="0" nillable="true" rse:CanIgnore="true">
    <xs:annotation>
        <xs:documentation>Postcode</xs:documentation>
    </xs:annotation>
    <xs:simpleType>
        <xs:restriction base="NonEmptyStringType">
            <xs:maxLength value="10" />
        </xs:restriction>
    </xs:simpleType>
</xs:element> 
```

如您所见，这链接回 NonEmptyStringType 中的模式（上面发布的第一条规则）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T11:46:40.633

这个正则表达式对我来说看起来不错。我认为这是您的验证工具中的一个错误……它们在极端情况下通常是错误的。

好的，刚刚检查：xerces 接受它；xmllint 失败（我看到您使用的是 xmllint）。我过去多次发现 xerces 是正确的，而 xmllint 在不寻常的情况下会出现问题。这个正则表达式很不寻常。（我不得不说，我真的很喜欢 xmllint，它真的很快，但是 xsd 规范是巨大的、复杂的和令人困惑的，而且 xmllint 的人还没有确定所有的边缘情况）。

我试过的两个在线验证器也接受它：[http](http://www.utilities-online.info/xsdvalidation) ://www.utilities-online.info/xsdvalidation和[http://www.freeformatter.com/xml-validator-xsd.html](http://www.freeformatter.com/xml-validator-xsd.html)

顺便说一句：对于 xerces，我下载了他们的 java 版本，并发现他们的类`jaxp.SourceValidator`是验证的最佳工具。但我相信它已经在 java 中使用了相同的代码。

* * *

*编辑*我在 xerces 中做了更多测试，以确保正则表达式*可以*失败（即它是活动的）。如果有`\n`任何地方，它就会失败。（同样的`\t`，虽然我没有测试`\r`）。

检查规范，`\s`定义为`[#x20\t\n\r]` （在[此表中](http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#nt-MultiCharEsc)）。这清楚地表明正则表达式是说你不能拥有`\t`，`\n`或`\r` *任何地方*。但是您*可以*拥有任意数量的文字空格字符 ( `#x20`)，前提是它们不*都是*空格字符（即至少有一个非空格字符来匹配`[^\s]`- 顺便说一句，可以将其表示为`\S`）。Xerces 证实了这一点：所有空格都会出错。

Maybe they want to allow space literals (both padding and interspersing), provided there is some value in there (i.e. not *all* spaces).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T06:32:33.603

`[^\s] match anything that is not a space`

但是您的输入字符串`3506 RT`有空格！

我认为这就是它失败的原因:) 因为在它`[^\t\n\r]`通过`3506`之后你不会期望一个空格字符`[^\s]`但它会出现！并且`[^\t\n\r]`也通过了，因为下一组字符是`RT`

所以你应该声明的是：

```
<xs:pattern value="[^\t\n\r\s]*[\s][^\t\n\r\s]*" /> 
```

现在这将允许

1.  任何`NOT \t, \n, \r and \s`对模式更严格的东西，您都想添加 + ，它仅在字符串开头至少有一个非空白字符时才允许字符串。
2.  一个空格字符：我们可以通过像这样声明它作为可选字符`[\s]?`.. where ? 允许一次或根本不允许。所以空格字符不能重复。
3.  再说一遍 `NOT \t, \n, \r and \s`。

`<xs:pattern value="[^\t\n\r\s]+[\s]?[^\t\n\r\s]*" />`

实际上，可以通过验证数字和字母字符而不是`[^\t\n\r\s]`声明来使其更加严格。

希望能帮助到你！如果有任何问题困扰您，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:12:35.143

我不相信 \r 是一个空格，它是一个回车（类似于 \n 换行符）。您可能想用 \s 或只是实际的文字“”替换它。

# css - 为 Web 导出图像的最佳实践 - DPI/PPI

> ID：14550062
> 
> 赞同：0
> 
> 时间：2013-01-27T17:30:39.233
> 
> 标签：css, media-queries, retina-display, dpi, ppi

我应该如何为网络准备图像？

每个设备似乎都有不同的分辨率。我一直以 72PPI 导出图像。这些天甚至是正确的数字吗？有些人使用96PPI吗？哪个更适合非“视网膜”图像？

我遇到的大多数教程都建议在样式表中使用这种方法来处理 UI 图形。

[http://miekd.com/articles/using-css-sprites-to-optimize-your-website-for-retina-displays/](http://miekd.com/articles/using-css-sprites-to-optimize-your-website-for-retina-displays/)

基本上，制作两张图像，其中一张的大小正好是另一张的 2 倍。然后...

```
background-size: 50% auto; 
```

...在@2x 图像上。请注意，本文从未指定将图像导出为什么 PPI。

是否可以以 72PPI 导出 1 张图像，以 144PPI 导出一张图像？然后，您甚至不需要在媒体查询中调整更高分辨率的背景大小。

我应该在这里瞄准什么？为网络导出图像的事实上的最佳实践是什么？

另外，有没有人有更好的关于更高 dpi 显示和处理的媒体查询的文章？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:34:46.793

PPI 设置与您在网络上使用的图像完全无关。浏览器根本不关心 PPI 设置是什么，它只使用图像的像素尺寸。

# for-loop - MVC 将数据传递给视图和循环

> ID：14550064
> 
> 赞同：0
> 
> 时间：2013-01-27T17:30:42.557
> 
> 标签：for-loop, asp.net-mvc-4, views, action, models

我对 MVC 感到非常困惑。

我没有要显示的代码，因为我不知道该怎么做。

我有一个对象

```
public class Name()
{
  String name="balh"
  String something="blah blah"
  //this object works fine and doesn't look like this it has the appropriate get;set;
  //use this as just an example
  //please disregard this format
} 
```

现在我有一个

```
List<Name> list;//this just holds all of my objects 
```

我需要将它们传递给视图

我不断看到一些关于模型的东西，但我没有看到它在任何地方声明

我如何在视图中循环以创建这样的东西

```
<div> object1 string</div>
<div> object2 string</div>
<div> object3 string</div>
<div> object4 string</div>
<div> object5 string</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:37:44.607

让我们举个例子。

模型：

```
public class MyViewModel
{
    public string Name { get; set; }
    public string Something { get; set; }
} 
```

控制器：

```
public class HomeController: Controller
{
    public ActionResult Index()
    {
        List<MyViewModel> model = new List<MyViewModel>();
        model.Add(new MyViewModel { Name = "some name", Something = "something" });
        model.Add(new MyViewModel { Name = "some other name", Something = "something else" });
        return View(mdoel);
    }
} 
```

查看 ( `~/Views/Home/Index.cshtml`):

```
@model IEnumerable<MyViewModel>
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Something</th>
        </tr>
    </thead>
    <tbody>
    @foreach (vat item in Model)
    {
        <tr>
            <td>@item.Name</td>
            <td>@item.Something</td>
        </tr>
    }
    </tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T17:33:53.257

假设您使用列表作为模型，您的视图将如下所示：

```
@model List<Name>

@foreach(var item in Model) {
  <div> @item.name @item.something</div>
} 
```

所以你的控制器动作方法可能是：

```
public ViewResult Index() {
  // Somehow build list which is List<Name>
  return View(list);
} 
```

编辑：你似乎很新，所以我建议尝试这个教程： [http ://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T17:59:01.977

使用此代码

```
 @foreach (vat item in Model)
    {
        <tr>
            <td>@item.Name</td>
            <td>@item.Something</td>
        </tr>
    } 
```

# ruby-on-rails - Rails+Devise+OmniAuth：如何跳过 Twitter 的电子邮件验证？

> ID：14550072
> 
> 赞同：0
> 
> 时间：2013-01-27T17:32:17.303
> 
> 标签：ruby-on-rails, ruby, validation, twitter, devise

> **可能重复：**
> [在设计 2.0 上跳过omniauth-twitter 的电子邮件验证](https://stackoverflow.com/questions/10226203/skip-email-validation-for-omniauth-twitter-on-devise-2-0)

我正在对电子邮件使用此验证规则：

```
 validates :email,
            :presence => true, 
            :format => { :with => VALID_EMAIL_REGEX }, 
            :uniqueness => {:case_sensitive => false }

  before_save do |user| 
        user.email = email.downcase#
        user.slug  = user.username.parameterize
  end 
```

我试图补充：

```
 def email_required?
    super && provider.blank?
  end 
```

对于跳过电子邮件验证，如果访问者想通过 Twitter 注册，但我仍然在这里收到错误，看起来这`email_required?`不起作用。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:41:28.273

`email_required`如果您想跳过设计的验证，请参阅：[https](https://github.com/plataformatec/devise/blob/c179cef365f7188c91cbbc3db924a9f1f9563c3c/lib/devise/models/validatable.rb#L29) ://github.com/plataformatec/devise/blob/c179cef365f7188c91cbbc3db924a9f1f9563c3c/lib/devise/models/validatable.rb#L29 但是如果您想跳过自己的电子邮件验证可以使用这样的东西：

```
validates :email,
          :presence => true, 
          :format => { :with => VALID_EMAIL_REGEX }, 
          :uniqueness => {:case_sensitive => false },
          :if => 'provider.blank?' 
```

# ajax - JSF Ajax Update 不更新组件

> ID：14550083
> 
> 赞同：0
> 
> 时间：2013-01-27T17:33:24.037
> 
> 标签：ajax, jsf

以下是场景。我有左侧面板，其中包含所有菜单项。当我单击菜单项时，应在中心/主面板中加载相应的页面，而无需刷新页面。所以我使用 ajax（setupdate 方法）在单击菜单项时加载页面。

我的要求是我为某些菜单项加载了相同的页面。但是基于菜单项选择，我需要从数据库中检索记录，因此页面布局保持不变。但是我为所有菜单项提供了相同的页面。只有第一次，调用被发送到后备 bean，对于后续的点击，不会调用后备 bean，并且提供相同的页面。

我正在使用 PrimeFaces 3.4.1 和 JSF 2.0

注意：我正在动态加载屏幕。在客户端页面中，我使用 #{menuMB.screenName} 动态加载屏幕。

以下是代码片段。

## 模板页面

```
<f:view contentType="text/html; charset=UTF-8" encoding="UTF-8" >

        <div id="outerWrapper">

            <div id="contentWrapper">
                <div id="leftPanel">
                    <div class="companylogo">

                    </div>
                    <div class="jsmenu">
                        <ui:insert name="leftPanel">
                        </ui:insert>
                    </div>
                </div>

                <div id="mainContentWrapper">
                    <div id="pageHeader">
                        <ui:insert name="pageHeader">
                        </ui:insert>
                    </div>
                    <div id="mainContent">
                        <div id="mainStyle">
                            <ui:insert name="mainContent">
                            </ui:insert>
                        </div>
                    </div>
                </div>
                <div class="clearFloat"></div>
            </div>
            <div class="clearFloat"></div>
            <div id="footer">
                <ui:insert name="footer">
                </ui:insert>
            </div>
        </div>
    </f:view> 
```

## 客户端 XHTML

所有页面都加载在 mainContentForm 内的 mainOutputPanel 内。我正在获取需要从支持 bean menuMB 加载的屏幕名称。

```
<h:body>
    <ui:composition template="/pages/protected/templates/layoutTemplate.xhtml">

        <ui:define name="pageHeader">
            <ui:include src="/pages/protected/templates/loginHeader.xhtml">
            </ui:include>
        </ui:define>
        <ui:define name="leftPanel">
            <h:form id="leftMainForm">
                <ui:include src="/pages/protected/templates/requestfactoryleft.xhtml">
                </ui:include>
            </h:form>
        </ui:define>
        <ui:define name="mainContent" >
            <h:form id="mainContentForm" enctype="multipart/formdata" prependId="true">
                <h:panelGroup id="mainOutputPanel" layout="block" >
                    <ui:include src="#{menuMB.screenName}">
                    </ui:include>
                </h:panelGroup>

            </h:form>

        </ui:define>
        <ui:define name="footer">
            <ui:include src="/pages/protected/templates/footer.xhtml">
            </ui:include>
        </ui:define>
    </ui:composition>

</h:body> 
```

## Left XHTML（包含从数据库动态加载的菜单）

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
            xmlns:ui="http://java.sun.com/jsf/facelets"
            xmlns:h="http://java.sun.com/jsf/html"
            xmlns:p="http://primefaces.org/ui"
            xmlns:f="http://java.sun.com/jsf/core" 
            xmlns:c="http://java.sun.com  /jsp/jstl/core">

     <div class="testmenu" style="padding:7px; 
             border-radius: 10px 10px 10px 10px; margin-top: 7px; 
             background: darkgray;  width: 187px;">
        <div id="rfMainMenu">
            <p:panelMenu id="rfleftMainMenu" model="#{menuMB.mnuModel}" >
            </p:panelMenu>
        </div>

     </div>

</ui:composition> 
```

## 支持 bean（在选择菜单项时动态加载页面）

```
@SessionScoped
@ManagedBean(name = "menuMB")
public class MenuMB implements Serializable {

    @PostConstruct
    public void loadMenu() {

      if (getLoggedUser() != null) {
          fmList = loginService.getMenuForUser(getLoggedUser());
      }

    //Call createMenu method to populate the sub menu and menu items

     createMenu(fmList);
  }

    public void loadScreensForUser(ActionEvent event) {
        MenuItem menuItem = (MenuItem) event.getComponent();
        String attrName;

    try {
        if (menuItem != null) {
            selectedMenuItem = menuItem.getId();

            //Get the screen name from the properties file
            menuUrl = RequestFactoryContextUtil.getResourceBundleString(menuItem.getId());

            //Set the screen name to be displayed
            setScreenName(menuUrl);

            //Call update to update the form  
          RequestContext.getCurrentInstance().update("mainContentForm:mainOutputPanel");

        }

    } 

    catch (Exception exc) {

    }

  }

  private void createMenu(List<FunctionMaster> fmList) {
    //Submenu rfSubMenu = new Submenu();

    try {
        if (fmList != null) {
            for (FunctionMaster sub : fmList) {
                if (sub.getParentFunctionID() == 0) {
                    Submenu rfSubMenu = new Submenu();
                    rfSubMenu.setLabel(sub.getScreenDisplayName());
                    getMnuModel().addSubmenu(rfSubMenu);

                    for (FunctionMaster item : fmList) {
                        if (item.getParentFunctionID() != 0) {
                            if (item.getParentFunctionID() == sub.getFunctionID()) {

                                MenuItem rfSubItem = new MenuItem();

                                rfSubItem.setId(item.getFunctionName() + item.getFunctionID().toString());
                                rfSubItem.setValue(item.getScreenDisplayName());

                                rfSubItem.setImmediate(true);

                                rfSubItem.setUpdate(":mainContentForm:mainOutputPanel");
                                rfSubItem.setAjax(true);
                                rfSubItem.setRendered(true);
                                rfSubItem.setIcon("search");
                                //rfSubItem.setIcon("ui-icon-search");

                                 ExpressionFactory factory = FacesContext.getCurrentInstance().getApplication().getExpressionFactory();
                                 //rfSubItem.setActionExpression(factory.createMethodExpression(FacesContext.getCurrentInstance().getELContext(), #{menuMB.loadScreenFromMenu}", Void.class, new Class[]{ActionEvent.class}));
                                 MethodExpression methodExpr = factory.createMethodExpression(FacesContext.getCurrentInstance().getELContext(), "#{menuMB.loadScreensForUser}", Void.class, new Class[]{ActionEvent.class});
                                 MethodExpressionActionListener actionListener = new MethodExpressionActionListener(methodExpr);
                                 rfSubItem.addActionListener(actionListener);

                                 rfSubMenu.getChildren().add(rfSubItem);
                                //addMenuItem(rfSubItem);
                            }
                        }
                    }
                    //mnuModel.addSeparator(new Separator());

                }

            }
        }
      } catch (Exception ex) {
        String excep = ex.getMessage();
    }

  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T07:17:24.243

我注意到`<h:body>`驻留在`<ui:composition`this 之外会导致`<h:body>`被丢弃....（之外的任何东西`<ui:composition`都被忽略）

我建议您将 `<h:body>`标签放在模板本身内

# c++ - 将字符串中的数字相乘c ++

> ID：14550084
> 
> 赞同：-2
> 
> 时间：2013-01-27T17:33:24.910
> 
> 标签：c++, visual-c++, bignum

我正在寻找的是对字符串中的数字使用简单的数学

我试图找到 100 的阶乘，把它放在 int 或 long long 中真的很大，所以我搜索并发现字符串是最好的解决方案，但是

我不能将数字乘以字符串，甚至不能将乘以 int 然后放回字符串中，而且我不能使用不是来自 c++ 标准的库，有人可以帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:44:37.977

为了解决这个问题，您将不得不编写一些将一个数字与另一个数字相乘的代码。这是一个将字符串内容乘以 2 的函数：

```
void times_two(char *str)
{
    int carry = 0;
    for(int i = DIGITS-2; i >= 0; i--)
    {
    int t = str[i] - '0';
    t *= 2;
    t += carry;
    str[i] = (t % 10) + '0';
    carry = (t > 9);
    }
} 
```

它假定字符串是 DIGITS 字符长，并用零“调整”到字符串的右侧以填充它。

当然，如果你试图乘以“超过一个数字”，你将不得不循环你乘以的数字的长度，你还必须关心“进位”是否超过一个二。但原理是一样的。

[我故意不重写我上面的函数来应对这两种情况，因为你做 100 阶乘的目的不是为了找到答案，而是为了学习如何解决编程问题。如果您只想找到答案，您可以使用现代计算器！]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:16:10.367

这是我曾经编写的代码`O(n^2)`及时运行。尽管有更好的算法，例如在 O(nlog n) 时间内运行的快速傅立叶变换 (fft)。乘法函数接受 2 个字符串（数字）并返回它们的乘积。

```
#define itc(n) char(n+48)
#define cti(ch) (ch-48)
 string itos(lld n)
    {
        ostringstream convert;
        convert<<n;
        return convert.str();
    }   

string add(string s1, string s2)
{
    int len1=s1.length(), len2=s2.length();
    if(len1<len2)                                   //s1 should be of greater length than s2
        return add(s2, s1);
    string ans="";
    int carry=0, i, s;
    for(i=1;i<=len1;i++)
    {
        s = carry+cti(s1[len1-i]);

        if(i<=len2)
            s += cti(s2[len2-i]);

        ans = itc(s%10)+ans;                        //finding the character to be added to the ans
        carry = s/10;                               //finding the carry
    }
    if(carry!=0)
        ans = itc(carry)+ans;

    return ans;
}

     string multiply(string s1, string s2)
        {
            int len1=s1.length(), len2=s2.length();
            if(len1<len2)
                return multiply(s2,s1);
            int i,j,p, carry=0;
            string result, net="", c;
            for(i=len2-1;i>=0;i--)
            {
                carry=0;
                result="";
                c="";
                for(j=len1-1;j>=0;j--)
                {
                    p=cti(s1[j])*cti(s2[i]);
                    result = itc((p+carry)%10)+result;
                    carry=(p+carry)/10;
                }
                if(carry!=0)
                {
                    c=itos(carry);
                    result=c+result;

                }
                for(j=i;j<len2-1;j++)
                    result+="0";

                net=add(net,result);
            }
            return net;
        } 
```

# java - 表示区域（存储）区域的最佳方式

> ID：14550086
> 
> 赞同：0
> 
> 时间：2013-01-27T17:33:29.487
> 
> 标签：java, dimensions, area

好吧，我正在开发一个模拟，部落（群体）中的代理可以在固定大小的地图中竞争他们拥有多少区域。（地图是 2D 地图）。他们通过分组相互竞争来竞争，获胜的组得到另一组的所有。这个模拟是用java编写的。

我试图获得一些想法的主要问题是我应该如何存储每个组拥有多少地图。起初我只是使用 Dimension 的一个实例，然后每次一组代理赢得一个区域时将其添加到维度中。但是问题是，拥有的区域可以位于地图中的任何位置，区域之间存在间隙，如下图所示。（抱歉，图片不佳，正在尝试绘制问题使用 gimp)

![在此处输入图像描述](../Images/d3b943de8b97bcb1cbbacd9d8c244948.png)

**注意：不同颜色的矩形代表代理拥有的区域，而紫色圆圈代表代理本身**。

现在另一个想法是拥有一个 ArrayList 的 Dimension 类型，其中包含特定部落代理所拥有的所有区域。

但我在想是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:04:51.213

如果我能给你一些建议，当我之前在做一些与图表相关的事情时，在一篇论文中我发现了如何将图表转换为地图的想法，抱歉我不记得那篇论文的标题，但我记得的是，它们是使用 voronoi 图，在这种情况下，您可以将地图数据存储为一组对象，其中包含代理和团队 ID 执行的操作坐标

还可以引入sales vlume，可以用来解决重叠区域的冲突（区域90%的销售额属于A，所以90%的区域也会给他们）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:04:18.620

每个部落之间存在一对多（技术上是一对零或多）的关系，以及该部落拥有多少地区。您有 3 个基本选择来表示任何一对多关系。

```
1\. You can place a reference in each child to the parent
2\. You can manage a list of children in each parent
3\. You can manage a list of parent-child pairings separately 
```

我要问自己的问题是，您想从模拟中得出什么结果？从那里开始并向后工作。例如，如果您的目标是按部落报告所拥有的物品，那么管理每个部落对象内的区域列表可能是最有效的。如果您的目标是显示谁拥有每个区域的报告，那么在每个区域的对象内引用拥有部落可能会更简单。如果您支持多个视图，在这两个地方进行管理也可能是合理的。

第三个选项，管理对象本身之外的关系，在可能支持多对多关系的时候最有用，比如允许玩家成为多个部落的成员。

# python - 集合双端队列中的错误 - Python

> ID：14550090
> 
> 赞同：2
> 
> 时间：2013-01-27T17:33:56.003
> 
> 标签：python, deque

我正在尝试在 python 中使用 deque 来创建队列。

我不断收到的错误是索引超出范围

```
perf_his[b][c] = 0 
```

IndexError：双端队列索引超出范围

这是我实现的代码的一个小原型。

```
import collections

apps = [1,2,3]
num_thrs = len(apps)
perf_his = []
for a in range(num_thrs):
 perf_his += [collections.deque(maxlen=1)]

for b in range(num_thrs):
 for c in range(0, 1):
  perf_his[b][c] = 0 
```

为了检查我是否正确理解了双端队列，我实现了以下代码：

```
#!/usr/bin/env python

from collections import deque

something = ["foo","bar","baz"]
output = []
diff = 0

d = deque()

for i in something:
    d.append(i)
    print("-> %s" % i)

for i in xrange(len(d)):
    print(d[i])
    output.append(d[i])

for i in xrange(len(something)):
    if output[i] != something[i]:
        diff += 1

print(something,output,diff) 
```

我一直在尝试在 2 天内修复该错误，但我似乎不明白这个问题。有人可以阐明一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:36:37.927

在您的第一段代码中，您永远不会`append()`使用`deque`，因此它永远不会*有*元素“0”，因此您不能分配给它。设置`maxlen`不会创建元素，它只是限制以后可以存在多少元素。

你可能想要的是这样的：

```
for a in range(num_thrs):
  perf_his += [collections.deque()]

for b in range(num_thrs):
  for c in range(0, 1):
    perf_his[b].append(0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T17:56:24.953

*设置maxlen*后，在添加元素之前，双端队列的大小仍然为零。*maxlen=5*的效果是，在 5 次 append 之后，next append 会自动弹出最旧的元素，这样大小就永远不会变大。换句话说，*maxlen*是最大尺寸，而不是最小尺寸。

对于您的应用程序，deque 需要预先填充初始值，然后才能进行任何分配：

```
>>> d = deque([0] * 5, maxlen=5)
>>> d[2] = 100
>>> d
deque([0, 0, 100, 0, 0], maxlen=5) 
```

# c# - BufferedGraphics 闪烁

> ID：14550095
> 
> 赞同：3
> 
> 时间：2013-01-27T17:34:30.763
> 
> 标签：c#, winforms, double-buffering

我试图实现自定义双缓冲，但它会导致闪烁。

这是控件（从控件继承的自定义控件）构造函数中的代码：

```
bufferContext = new BufferedGraphicsContext();
SetStyle(ControlStyles.OptimizedDoubleBuffer, false);
SetStyle(ControlStyles.DoubleBuffer, false);
SetStyle(ControlStyles.ResizeRedraw, false);
SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint, true);
SetStyle(ControlStyles.Opaque, true); 
```

OnPaint 事件：

```
protected override void OnPaint(PaintEventArgs e)
{
    if (buffer == null)
    {
        Draw(e);
        return;
    }

    if (Repaint)
    {
        Repaint = false;
        PaintEventArgs pe = new PaintEventArgs(buffer.Graphics, e.ClipRectangle);
        Draw(pe);
    }

    buffer.Render(e.Graphics);
} 
```

此外，在调整与缓冲相关的大小时会激活此代码：

```
Graphics g = this.CreateGraphics();

if (buffer != null)
{
    buffer.Dispose();
    buffer = null;
}

if (!(bufferContext == null || DisplayRectangle.Width <= 0 || DisplayRectangle.Height <= 0))
{
    buffer = bufferContext.Allocate(g, DisplayRectangle);
    Repaint = true;
} 
```

Draw 方法比较复杂，但它首先用 BackColor 填充控件，其他无关紧要。

我有时可以用眼睛发现闪烁，主要是在调整窗口大小时。据我所知，黑色首先在控件上绘制，然后是缓冲区中的图形，它会导致闪烁。但是，BackColor 绝不是黑色。

该怎么做才能阻止这种情况？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-08-24T14:04:27.257

这个例子展示了如何正确使用缓冲图形：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace GDI_PAINTING_EXAMPLE
{
    public class PaintingExample : Control
    {
        public Graphics G;
        public Bitmap Frame = new Bitmap(256, 256);
        public Bitmap Buffer = new Bitmap(256, 256);

        public PaintingExample()
        {
            // Create a new Graphics instance.
            G = Graphics.FromImage(Buffer);
        }

        protected override void OnPaint(PaintEventArgs e)
        {
            // Clears Buffer To White
            G.Clear(Color.White);

            //
            // Do Your Painting Routine
            //

            //
            // End Your Painting Routine
            //

            // Set Frame to draw as Buffer
            Frame = Buffer;

            // Draw Frame with Paint Event Graphics as one image.
            e.Graphics.DrawImage(Frame, new Point(0, 0));
        }
        protected override void OnPaintBackground(PaintEventArgs pevent)
        {
        }
    }
} 
```

# java - 您可以使用一种方法将项目添加到优先级队列的 3 个不同实现吗？

> ID：14550103
> 
> 赞同：1
> 
> 时间：2013-01-27T17:35:32.753
> 
> 标签：java, generics

我正在为大学做一项任务，其中涉及优先级队列的自定义实现。队列中的每个项目将是一个`Node<E>`存储元素及其优先级（E，p）。整个字段是类型`ArrayList<Node<?>>`，3个实现将是 -

*   未排序的队列，其中项目被添加到最后，并被队列中最长的最高优先级移除 - 类型`ArrayList<Node<String>>`

*   已排序的队列，其中项目从队列的前面移除并添加到下一个最低优先级的第一个项目之前 - 因此优先级 2 的内容将添加到优先级 1 和 3 的项目之间。 - 类型`ArrayList<Node<String>>`

*   队列的排序队列，其中每个节点元素是具有相同优先级的项目的数组列表 - 类型`ArrayList<Node<ArrayList<String>>>`

每个都有自己的入队、出队等方法。

我想知道是否可以定义一个方法，该方法将与优先级队列的所有三个实现一起使用，因为它们对应于应用程序中的相同字段，并且根据字段的定义调用队列类型的相应入队方法.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:42:45.480

为priorityQueue 的方法定义一个*接口*，然后对该接口进行三个实现。

```
interface PrioQueue{
  void enqueue(Node node);
  Node dequeue();
}

class PrioQueueVersion1 implements PrioQueue{
   ....
}

class PrioQueueVersion2 implements PrioQueue{
   ....
}

class PrioQueueVersion3 implements PrioQueue{
   ....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:29:10.167

扩展 MrSmith 的回答，如果您已经拥有三个单独的接口实现，则可以通过接口使用多态性来获得所需的功能。我在下面发布了一个小例子：

```
public interface PrioQ
{
    public void enqueue(Node n);
}

public class A implements PrioQ
{
    public void enqueue(Node n)
    {
      System.out.println("Enqueue from A");
    }
}

public class B implements PrioQ
{
    public void enqueue(Node n)
    {
      System.out.println("Enqueue from B");
    }
}

public class C implements PrioQ
{
    public void enqueue(Node n)
    {
      System.out.println("Enqueue from C");
    }
}

import java.util.ArrayList;
import java.util.List;

public class Driver
{
    public static void main(String[] args)
    {
      List<PrioQ> queues = new ArrayList<>();
      queues.add(new A());
      queues.add(new B());
      queues.add(new C());

      for(PrioQ q : queues){
          q.enqueue(new Node());
      }
    }
} 
```

输出：

```
Enqueue from A 
Enqueue from B
Enqueue from C 
```

这是一个小例子，可能不是您在应用程序中使用它的方式，但希望它有助于加强我关于多态性的观点。

# flickr - 在 Flickr API 中访问非公开照片

> ID：14550104
> 
> 赞同：0
> 
> 时间：2013-01-27T17:35:50.287
> 
> 标签：flickr

![Flickr API 浏览器页面](../Images/490909fa5e98b33b39a9e7d72a5f424e.png)

我正在开发一个使用 Javascript 从 Flickr 获取照片的应用程序。图片中显示的 Photoset ID 不公开，因此当我选择“不签名调用”选项时，API 响应“错误”。我不想公开我的 Flickr 照片，但我想通过 API 从另一个页面调用它们。我知道使用*"token"*是可能的。但是进入“登录页面”需要令牌。

是否可以使用我的 API 密钥访问非公开照片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T14:54:23.093

是的，您的应用可以访问您的私人照片。您将需要了解 Flickr 的[用户身份验证 API](http://www.flickr.com/services/api/auth.oauth.html)，它使用 OAuth 协议。开始有点棘手，但有[第三方库](http://oauth.net/code/)可以帮助完成一些工作。

# html - 如何通过 HTML 呈现无响应的按钮（用于说明目的）

> ID：14550110
> 
> 赞同：0
> 
> 时间：2013-01-27T17:36:31.927
> 
> 标签：html, css, button, mouseover, mousedown

如何通过 HTML/CSS 呈现一个普通（启用外观）按钮，该按钮在鼠标悬停或鼠标悬停时不会改变其外观（出于说明目的，例如按 [x] 取消）？

（即，当您将鼠标悬停在它上面或“按下”它时，我不希望它变得“突出显示”或“推动”。）

我知道我可以使用按钮的图片，但是在不同或未来版本的浏览器下，后续的真实按钮可能看起来不同并且与图片不匹配，这就是我希望通过 HTML/CSS 呈现它的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:56:27.030

也许你可以考虑在按钮上放置`<div>`一个指定宽度和高度的空白，这样会遮挡按钮上的点击？

根据外部元素的定位模式，您可以使用`<div>`来覆盖某些外部元素，或者仅覆盖`<input type="button" ...>`自身（在这种情况下，JavaScript 和 DOM 可以帮助确定按钮的实际大小，从而确定覆盖区域）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:41:02.247

所有主要浏览器都支持[disabled 属性](http://www.w3schools.com/tags/att_button_disabled.asp)，因此您可以使用它。

```
<button type="button" disabled>Click Me!</button> 
```

或者，或者：

```
<input type="button" value="Click Me!" disabled /> 
```

为了使它看起来像已启用，您可以编辑其 CSS 属性以使其处于禁用状态：

```
input[type="button"]:disabled, button[type="button"]:disabled {
  background:#DDD;
  color:#000;
} 
```

但是，正如 OP 指出的那样，这可能使它看起来与某些浏览器/系统上的其他按钮看起来完全不同。您可以在 CSS 规则中省略 background 属性，它们将呈现为任何其他禁用的按钮，但字体颜色类似于启用的按钮。或者，省略禁用的 HTML 属性并将这些按钮置于它们通常属于的上下文之外（作为表单的一部分）。

**编辑：请参阅[安东尼的答案](https://stackoverflow.com/questions/14550110/how-to-render-an-unresponsive-button-via-html-for-illustration-purposes/14550161#14550161)以获得更好的解释需要应用哪些样式才能使其看起来像您期望的那样**；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:41:29.667

您可以使用 CSS 强制禁用的按钮看起来像正常的按钮。

**演示**

*   野生动物园：http: [//jsfiddle.net/9aXW9/2/](http://jsfiddle.net/9aXW9/2/)
*   火狐：http: [//jsfiddle.net/gZtT7/](http://jsfiddle.net/gZtT7/)

^(IE 将其 CSS 隐藏在注册表中。但作为一般规则，应用`color: #000;`和其他修改会使它看起来像一个普通按钮。)

**HTML**

```
<input type="submit" disabled="disabled" value="I cannot be pressed." /> 
```

**CSS**

```
/* Safari */
input[type="submit"]:disabled {
    -webkit-appearance: push-button;
    -webkit-box-align: center;
    text-align: center;
    cursor: default;
    color: ButtonText;
    padding: 2px 6px 3px 6px;
    border: 2px outset ButtonFace;
    background-color: ButtonFace;
    box-sizing: border-box;
    white-space: pre;
}

/* Firefox */
input[type="submit"]:disabled {
    -moz-appearance: button;
    padding: 0px 6px 0px 6px;
    border: 2px outset ButtonFace;
    background-color: ButtonFace;
    color: ButtonText; 
    font: -moz-button;
    line-height: normal;
    white-space: pre;
    cursor: default;
    -moz-box-sizing: border-box;
    -moz-user-select: none;
    -moz-binding: none;
    text-align: center;
    text-shadow: none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:04:59.120

@Navigeteur

只需截取普通按钮的屏幕截图并将其保存为 bmp 或 png 图像并渲染图像而不是按钮 :)

# javascript - 使用 Strophe.js-Register-Plugin 注册 XMPP-Account

> ID：14550114
> 
> 赞同：0
> 
> 时间：2013-01-27T17:37:00.550
> 
> 标签：javascript, xmpp, openfire, strophe

我尝试使用 strophe-register-plugin ( [https://github.com/metajack/strophejs-plugins/tree/master/register](https://github.com/metajack/strophejs-plugins/tree/master/register) ) 注册一个 xmpp 帐户。它适用于示例“ [http://bosh.metajack.im:5280/xmpp-httpbind](http://bosh.metajack.im:5280/xmpp-httpbind) ”中的连接管理器，但我无法使用 OpenFire 连接管理器注册帐户。（正常登录适用于两个连接管理器......）

连接状态变化是 1 -> 10，就是这样。1 表示“连接”，但我不知道 10 是什么意思...

```
var connection = new Strophe.Connection(
//          "http://bosh.metajack.im:5280/xmpp-httpbind");
        "http://localhost/http-bind");

var callback = function (status) {alert(status);
    if (status === Strophe.Status.REGISTER) {
        connection.register.fields.username = "fghdfhg";
        connection.register.fields.name = "dfgfdgfdg";
        connection.register.fields.password = "dfddfgfdg";
        connection.register.submit();
    } else if (status === Strophe.Status.REGISTERED) {
        console.log("registered!");
        connection.authenticate();
    } else if (status === Strophe.Status.CONNECTED) {
        $(document).trigger('connected');
    } else if (status === Strophe.Status.DISCONNECTED) {
        console.log("Disconnected from XMPP-Server");
    }
};

//    connection.connect(data.jid, data.password, callback);
connection.register.connect("xyz.com", callback, 60, 1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-01T09:51:17.913

在 **strophe.register.js**中转到第 215 行并按照以下代码进行更改。

```
 /*if (register.length === 0) {
            that._changeConnectStatus(Strophe.Status.REGIFAIL, null);
            return;
        } else */
this.enabled = true; 
```

试试上面一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T08:52:57.593

这种情况有一个解决方法：[https](https://stackoverflow.com/a/10437474) ://stackoverflow.com/a/10437474和一个错误问题：[https ://github.com/metajack/strophejs-plugins/issues/93](https://github.com/metajack/strophejs-plugins/issues/93)

# java - 无法从 Jar 加载图像

> ID：14550125
> 
> 赞同：2
> 
> 时间：2013-01-27T17:38:00.790
> 
> 标签：java, image, swing, jar, embedded-resource

我正在用 Java 制作一个简单的游戏，并尝试从 jar 文件中加载一个精灵。我正在使用以下代码加载精灵：

```
spriteURL = getClass().getResource("/res/sprites/sprite_fr1.png"); 
```

如果我导出一个 jar 文件并解压缩它，则存在以下文件夹：

> /res/sprites/sprite_fr1.png

但是，当我尝试加载图像时，我捕获了 NullPointerException，尽管据我所知，路径存在？

我在这里做错了什么？

编辑：下面的截图。

![文件夹结构](../Images/231ab42088b75f29cb1b936787b9a6b5.png)

所有精灵都在“精灵”文件夹中作为 PNG 文件。我从 jeu 调用该方法，而不是 jeu/canvases。

问候，本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:42:27.487

在 IDE 中检查项目的类路径。例如，在 Eclipse 中，每个文件夹都有配置（属性-> JAva 构建路径-> 源选项卡）。可以设置为排除 png 文件。

# javascript - 每次添加具有指定选择器的元素时执行 JS 函数

> ID：14550126
> 
> 赞同：0
> 
> 时间：2013-01-27T17:38:09.780
> 
> 标签：javascript, jquery, events, browser

我必须重构具有复杂 UI 的大型单页应用程序。

document.ready 函数中有以下代码

```
$('table.datatable').dataTable({ ... params ... });
$('div.tooltip').tooltip({ ... params ... });
$('ul.dropdownMenu').menu({ ... params ... }); 
```

正如您在这段代码中看到的，我们搜索不同的 HTML 控件并调用适当的 jQuery 插件来实现这些控件的行为。

然而，由于页面是非常动态的新数据表、工具提示和菜单，并且由于 JS 函数在应用程序的一开始就被调用 - 这些元素没有必要的功能，除非我为它们手动调用适当的插件。

我想消除每次 DOM 更改后调用 jQuery 插件的需要，但不知道如何做得更好。

一种选择是每次我向 DOM 添加任何内容并在事件的侦听器中重新调用此插件时触发一个事件，但是我不喜欢这种解决方案，因为每次都需要记住触发事件。

我读到了 jQuery 的`on`函数，它也为尚不存在的元素附加事件，但我需要什么事件？AFAIK 没有 domchange 事件。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:49:58.450

您唯一的选择是在将插件添加到 DOM 后将它们连接到新项目上。最好的跨浏览器选项是挂钩到将这些类型的元素添加到 DOM 的每个地方，并通过调用一些附加函数来简单地处理那里的新项目。您需要寻找的是，在将新元素添加到 DOM 后，您可以轻松地挂接到现有代码的位置，然后在此时修复这些新元素。在不知道您的代码和修改 DOM 的位置的情况下，我们真的无法建议最好的方法来做到这一点。

在跨浏览器的方式中，不可能使用单一方法一般地监视 DOM 中的新项目。 [突变观察者](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)是执行此操作的最新标准方法，但许多浏览器尚不支持它。 [突变事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)发生在突变观察者之前，但现在已被弃用。

jQuery`.on()`在这里不会做你想做的事——它可以用来处理动态添加的 DOM 元素，但不是以你想要的方式。您的插件本可以设计为使用 use 来处理它们的事件`.on()`，但是除非它们是这样设计的并且您可以利用它，否则没有一种简单的方法可以让您使用它来获得所需的行为而无需重写插件的一部分。

# database - Windows 7 应用程序数据库位置

> ID：14550130
> 
> 赞同：0
> 
> 时间：2013-01-27T17:38:42.357
> 
> 标签：database, windows-7

我们的应用程序针对 Windows 7。它是一个数据库 winforms 应用程序。我们希望它符合 Windows 7 徽标。我们的问题是在哪里找到用户数据库。它必须可供所有用户访问，并且当然具有读/写能力。我们不想在安装过程中修改权限。Windows 7 徽标合规性规则不涉及所有用户数据位置。这不是简单的程序数据，如设置。相信很多人都遇到过这个问题。你把数据库放在哪里？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:33:47.077

使用 Environment.SpecialFolder.CommonApplicationData

# android - 使用 HttpURLConnection 的 Android Jelly Bean 4.1 上的 HTTP 基本身份验证问题

> ID：14550131
> 
> 赞同：6
> 
> 时间：2013-01-27T17:38:45.330
> 
> 标签：android, authentication, basic-authentication, httpurlconnection, android-4.2-jelly-bean

我们正在使用 HTTP 基本身份验证向 Web 服务器发出基于 HttpURLConnection 的请求。代码在 Android 版本 2.x、3.x.、4.0.x 上运行良好 现在使用 Jelly Bean 和 v4.1.x 身份验证失败，LogCat 中显示以下消息：

```
01-27 10:54:18.886: ...::doReadRawData(731): An exception occured while reading data from remote host. httpURLConn.responseCode = 401 / httpURLConn.responseMessage = UNAUTHORIZED
01-27 10:54:18.886: ...::doReadRawData(731): java.io.IOException: No authentication challenges found 
```

我们在 Android 文档中用于 HttpURLConnection 的身份验证代码：

```
private void doAuthorize() {
        Authenticator.setDefault(new Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(USER, PASSWORD.toCharArray());
            }
        });
    } 
```

**经过进一步调查和故障排除，我们发现在 4.1 Jelly Bean 中没有调用此代码！**

Android Jelly Bean 4.1 中基本身份验证的解决方法或正确方法是什么？

有人在这个相关主题的 Android 源代码中发现了不同，我认为我们遇到的问题与该差异有关：[HttpURLConnection 在 Android 2.x 中运行良好，但在 4.1 中没有：未发现身份验证挑战](https://stackoverflow.com/questions/11810447/httpurlconnection-worked-fine-in-android-2-x-but-not-in-4-1-no-authentication-c)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:49:00.100

我们能够通过以下新方法解决 Jelly Bean 不调用 Authenticator 的 getPasswordAuthentication() 的问题：

```
@TargetApi(Build.VERSION_CODES.FROYO) 
private void setJellyBeanAuth(HttpURLConnection httpConn) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
        byte[] auth = (USER + ":" + PASSWORD).getBytes();
        String basic = Base64.encodeToString(auth, Base64.NO_WRAP);
        httpConn.setRequestProperty("Authorization", "Basic " + basic);
    }
} 
```

然后在打开连接后调用这个函数：

```
httpURLConn = (HttpURLConnection) url.openConnection();
setJellyBeanAuth(httpURLConn); 
```

Froyo 注释的 @TargetApi 只是必要的，因为我们仍然支持 API 7，而在 API 8 中添加了 Base64

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T04:34:46.237

对于 Android 的 httpURLConnection 的 401 UNAUTHORIZED 响应，您的服务器必须发回这样的身份验证标头...
WWW-Authenticate: Bogus realm="blahblah", comment="use form to log in"
按照
[https://www.rfc -editor.org/rfc/rfc2616](https://www.rfc-editor.org/rfc/rfc2616) 搜索“10.4.2 401 未授权”

# php - 致命错误：找不到 excel 类“COM”

> ID：14550132
> 
> 赞同：0
> 
> 时间：2013-01-27T17:38:47.287
> 
> 标签：php, com

我正在使用 COM 启动一个 Excel 文件，它在我的一台机器 A 上运行，但在另一台机器上运行不佳。当它上传到生产服务器时，它又出现了同样的问题。有什么可能的原因和解决方法？

我正在使用最新的 php 窗口 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:44:56.330

致命错误：找不到 excel 类“COM”

上面的行表示没有为您启动的对象找到类 COM。所以检查你是否包含了类文件。

在您的本地机器上，它没有给出错误并不意味着它工作正常。可能会发生错误报告在本地计算机上关闭而在实时服务器上打开的情况。

所以，我建议请在本地机器上启用错误报告并看看。

您可以通过 php.ini 文件或在您的 php 代码中启用错误报告，如下所示，

```
error_reporting(E_ALL); 
```

# python - Heroku Neo4j 问题

> ID：14550133
> 
> 赞同：1
> 
> 时间：2013-01-27T17:38:50.760
> 
> 标签：python, heroku, neo4j, py2neo

我有使用 py2neo 的 neo4j python 应用程序。它在本地正常工作，但是当我将它部署到 heroku 时，它给出错误 **py2neo.rest.SocketError SocketError: gaierror(-2, 'Name or service not known')**

我不确定是什么问题。我将 url 用于 db 服务的正确问题应该是什么？ **graph_db = neo4j.GraphDatabaseService(" [http://xyz.hosted.neo4j.org:7480/db/data/](http://xyz.hosted.neo4j.org:7480/db/data/) ")**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T20:04:21.430

如下所示配置身份验证： [http ://packages.python.org/py2neo/neo4j.html#authentication](http://packages.python.org/py2neo/neo4j.html#authentication)

用于`heroku config`记下 URL 中的用户名和密码。

例如（明显修改）：

```
$ heroku config
=== secure-caverns-9214 Config Vars
NEO4J_URL: http://username:password@17d0afad4.hosted.neo4j.org:7755
PATH:      bin:node_modules/.bin:/usr/local/bin:/usr/bin:/bin 
```

# eclipse - 同一 Maven 存储库上的两个 Eclipse

> ID：14550135
> 
> 赞同：2
> 
> 时间：2013-01-27T17:38:52.233
> 
> 标签：eclipse, maven, repository, m2e

我有一个 Maven 3.0.4 的外部安装和两个 Eclipse（Juno 和 Indigo）在他们的 m2e 设置中引用它。

我也有一个单一的用户设置文件，它描述了一个本地存储库。两个 Eclipse 都引用了它。

我对 Maven 有疑问，这可能是 Eclipse 之间的冲突。

例如，Eclipse 之一（比如 Indigo）可能对某些全局存储库（比如中央）是盲目的。这意味着它在 Eclipse 的“Maven 存储库”视图中的子节点是空的

![在此处输入图像描述](../Images/26fde665f52b1d35551232c774c39ecd.png)

更新/重建索引无济于事，而且可能什么也没做，因为结束得很快。

重新加载设置也无济于事。

问题是：是否可以将一个 Maven 与多个 Eclipse 一起使用？主体多用户系统是否可能不支持多用途？

哪里的数据可能被破坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:57:21.697

您最好忽略 Eclipse 特定的 Maven 安装。我发现依赖 Eclipse 上的预装软件会导致问题，原因如下。

您永远不会确切知道他们安装了哪个版本的 maven 以及为什么（找出比自己安装更难）

如果它不能在 IDE 中运行，你的构建服务器会有什么机会（当涉及到发布时间时，你会在 Jenkins 或你的 CI 服务器中遇到这些问题）

自己安装 Maven 并从命令行运行它非常容易，而且问题较少。

[http://maven.apache.org/download.cgi](http://maven.apache.org/download.cgi)

如果有一个使用 maven 的开发人员团队，可以考虑自己将它托管在一个 nexus 服务器上。

# ruby-on-rails - 使用 Capybara 时调整 Chrome 的窗口大小

> ID：14550137
> 
> 赞同：11
> 
> 时间：2013-01-27T17:39:08.957
> 
> 标签：ruby-on-rails, google-chrome, selenium, rspec, capybara

我使用 Capybara（含硒）、Chrome 和 RSpec。但我想在一些测试中改变浏览器的宽度。这种情况下的解决方案是什么？

**规范/spec_helper.rb**

```
ENV["RAILS_ENV"] ||= 'test'
require File.expand_path("../../config/environment", __FILE__)
require 'rspec/rails'
require 'rspec/autorun'
require 'capybara/rspec'

# Requires supporting ruby files with custom matchers and macros, etc,
# in spec/support/ and its subdirectories.
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

# Using chrome as browser to test in capybara.
Capybara.register_driver :selenium do |app|
  Capybara::Selenium::Driver.new(app, :browser => :chrome)
end

# RSpec config.
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller    
  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
  config.fixture_path = "#{::Rails.root}/spec/fixtures"

  # If you're not using ActiveRecord, or you'd prefer not to run each of your
  # examples within a transaction, remove the following line or assign false
  # instead of true.
  config.use_transactional_fixtures = false

  # If true, the base class of anonymous controllers will be inferred
  # automatically. This will be the default behavior in future versions of
  # rspec-rails.
  config.infer_base_class_for_anonymous_controllers = false

  # Clean test database.
  config.before(:suite) do
    DatabaseCleaner.strategy = :truncation
  end

  config.before(:each) do
    DatabaseCleaner.start
  end

  config.after(:each) do
    DatabaseCleaner.clean
  end
end 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-27T18:12:01.967

您可以使用 Selenium Webdriver中的[resize_to](http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Window.html#resize_to-instance_method)函数：

```
page.driver.browser.manage.window.resize_to(1024, 768) 
```

[Window](https://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Window.html)有一些其他可能有用的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-10T17:41:40.973

我发现该`Driver#browser`调用现在已被弃用（Capybara 2.5.0）。

您可以使用[`Driver#resize_window_to`](http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Driver/Base#resize_window_to-instance_method)调用来调整窗口大小：

`page.driver.resize_window_to(page.driver.current_window_handle, 1_200, 800)`

你也可以使用[`Session#current_window`](http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Session#current_window-instance_method)then [`Window#resize_to`](http://www.rubydoc.info/github/jnicklas/capybara/Capybara/Window#resize_to-instance_method)：

`page.current_window.resize_to(1_200, 800)`

查看文档以获取更多信息：

[http://www.rubydoc.info/github/jnicklas/capybara/Capybara](http://www.rubydoc.info/github/jnicklas/capybara/Capybara)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-07T09:08:11.670

迟到的答案，但有人可能需要这个。您可以通过提供窗口大小来启动 chromedriver，这样您就不需要在加载页面后调整它的大小：

```
Capybara.register_driver :chrome_sizes do |app|
  profile = Selenium::WebDriver::Chrome::Profile.new 

  Capybara::Selenium::Driver.new(app,
    :browser => :chrome,
    :profile => profile,
    :args => ["--window-size=1240,1400"]
  )
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-16T14:46:13.843

试试这个：

```
it "testname", :js => true do
  set_selenium_window_size(1280, 800) if Capybara.current_driver == :selenium 
  # Resize window. NB: cannot be moved to before :all block, because there Capybara.current_driver will be :webkit. It changes to :selenium inside :js => true blocks.
  # ... the rest of your test ...
end

def set_selenium_window_size(width, height)
  window = Capybara.current_session.driver.browser.manage.window
  window.resize_to(width, height)
end 
```

感谢 Sidane 的要点[https://gist.github.com/Sidane/2204218](https://gist.github.com/Sidane/2204218)

# release-management - 'GA' 对源代码意味着什么？

> ID：14550139
> 
> 赞同：6
> 
> 时间：2013-01-27T17:39:15.570
> 
> 标签：release-management, application-lifecycle, software-lifecycle

GA 代表什么？

喜欢：1.0.0.GA - Bean 验证 (JSR-303)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-27T17:41:01.167

这意味着**一般可用性**或**普遍接受**。

引用维基百科：

**普遍可用性**或**普遍接受**(GA) 是指所有必要的商业化活动都已完成并且软件已通过网络或物理媒体向一般市场提供的时间点。

见[http://en.wikipedia.org/wiki/Software_release_life_cycle](http://en.wikipedia.org/wiki/Software_release_life_cycle)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T17:42:13.350

GA 代表软件版本中的 GENERAL AVAILABILITY。

# java - 无法理解字符串之间编辑距离的想法/用处

> ID：14550143
> 
> 赞同：1
> 
> 时间：2013-01-27T17:39:29.890
> 
> 标签：java, string, algorithm, data-structures, levenshtein-distance

我正在阅读关于 2 个字符串之间的编辑距离的问题。
它可以通过使用编辑距离公式的动态规划来解决。我无法理解的是它的用处。首先，这与知道 2 个字符串的最长公共子序列有何不同？
如果想法是选择一个具有最小编辑距离的字符串，您不妨在字符串中使用最大 LCS。对吗？
此外，当我们实际编写代码来进行替换时，代码将类似于以下内容：

```
if(a.length == b.length){  
   for(int i = 0;i < a.length;i++){  
          a[i] = b[i];  
   }  
}  
else{   
    a = new char[b.length];  
    for(int i = 0;i < a.length;i++){  
          a[i] = b[i];  
    }    
} 
```

我的意思是替换字符。进行分配和检查字符是否相同之间有什么区别，如果不是，那么只有在运行时进行分配？两者都不是恒定时间操作吗？
我对这个问题有什么误解？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:02:48.670

如果在编辑中不允许替换（或者如果替换的成本是插入或删除的两倍），则编辑距离和 LCS 通过一个简单的公式相关联：

ed(x,y) = x.length + y.length - 2*lcs(x,y).length

如果替代是一个单独的单位成本操作，那么 ED 可能会小于这个值。这在实践中很重要，因为我们想要一种方法来创建更短的差异文件。不仅是渐近地限制在一个常数因子上，而且实际上是最小的可能因子。

**在这里编辑**较短的差异文件可能不是问题，如果我们不允许替换，它们不会显着缩短。还有更多有趣的应用程序，例如拼写检查器中的排名更正建议（这是基于下面@nhahtdh 的评论）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:50:05.090

编辑距离与 LCS 完全不同。*编辑距离*是将一个字符串转换为另一个字符串所需的最少编辑操作数。一个非常流行的例子是 具有编辑操作的[莱文斯坦距离：](http://en.wikipedia.org/wiki/Levenshtein_distance)

*   插入一个字符
*   删除一个字符
*   替换一个字符

所有这些操作 a 的成本为*1*。

放有许多其他可能的操作和成本函数。例如，您还可以允许以下操作：交换两个相邻的字符。

例如，它用于比对 DNA 序列（或蛋白质序列）。

如果字符串的长度为 n 和 m，则复杂度为：
时间：**O(n*m)**
空间：**O(min(n,m))**

对于复杂的成本函数，Can 变得更糟。

# python - Scipy leastsq() 函数开销

> ID：14550145
> 
> 赞同：4
> 
> 时间：2013-01-27T17:39:38.603
> 
> 标签：python, numpy, scipy, least-squares

我正在开发一个图像分析程序，并且我已经将瓶颈缩小到尝试多次将 2D 高斯拟合到一个小窗口 (20x20) 像素。90% 的执行时间都花在了这段代码上。

我正在使用 scipy 食谱中给出的代码来解决这个问题：

```
 def gaussian(height, center_x, center_y, width_x, width_y):
           """Returns a gaussian function with the given parameters"""
        width_x = float(width_x)
        width_y = float(width_y)
        return lambda x,y: height*exp(
                    -(((center_x-x)/width_x)**2+((center_y-y)/width_y)**2)/2)

def moments(data):
    """Returns (height, x, y, width_x, width_y)
    the gaussian parameters of a 2D distribution by calculating its
    moments """
    total = data.sum()
    X, Y = indices(data.shape)
    x = (X*data).sum()/total
    y = (Y*data).sum()/total
    col = data[:, int(y)]
    width_x = sqrt(abs((arange(col.size)-y)**2*col).sum()/col.sum())
    row = data[int(x), :]
    width_y = sqrt(abs((arange(row.size)-x)**2*row).sum()/row.sum())
    height = data.max()
    return height, x, y, width_x, width_y

def fitgaussian(data):
    """Returns (height, x, y, width_x, width_y)
    the gaussian parameters of a 2D distribution found by a fit"""
    params = moments(data)
    errorfunction = lambda p: ravel(gaussian(*p)(*indices(data.shape)) -
                                 data)
    p, success = optimize.leastsq(errorfunction, params, maxfev=50, ftol=1.49012e-05)
    return p 
```

通过组合 errorfunction() 和 gaussian() 函数，我能够将执行时间减半，因此每次 leastsq() 调用 errorfunction() 时都会调用一个函数而不是两个。

这让我相信大部分剩余的执行时间都花在了函数调用开销上，因为 leastsq() 算法调用了 errorfunction()。

有没有办法减少这个函数调用开销？我不知所措，因为 leastsq() 将函数作为输入。

如果我的描述令人困惑，我提前道歉，我是一名受过培训的机械工程师，我正在学习 Python。请让我知道是否有任何其他有用的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T18:01:31.837

由于 exp 是单调的，您可以使用高斯的对数作为您的误差函数，例如

```
def log_gaussian(height, center_x, center_y, width_x, width_y):
    """Returns a gaussian function with the given parameters"""
    width_x = float(width_x)
    width_y = float(width_y)
    log_height = log(height)
    return lambda x,y: (log_height - 
             (((center_x-x)/width_x)**2 - ((center_y-y)/width_y)**2)/2) 
```

这将导致每次迭代调用 1 次 log，而不是每次迭代调用 exp 每个数据集行 1 次。

# qt - QTextEdit：仅当滚动条位于底部时才会自动向下滚动

> ID：14550146
> 
> 赞同：2
> 
> 时间：2013-01-27T17:39:50.843
> 
> 标签：qt, user-interface, scrollbar, qtextedit

有一个显示大量文本的 QTextEdit。它不可编辑。假设我想在开头阅读一些内容，向上滚动，但随后添加了一个新行并且滚动条自动转到底部。我在使用各种程序时遇到了类似的问题（不管它们是用什么语言编写的）。如何处理这个问题？

在文本中添加新行时我想要的行为：

*   如果滚动条位于底部，则自动向下滚动。
*   如果滚动条在别处，不要滚动

我想 ensureCursorVisible() 不是解决方案，因为 QTextEdit 不可编辑，用户不会在其中单击，并且光标的位置与垂直滚动条的位置不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:39:52.687

我会制作滚动条位置监听器，它会记住滚动位置（并检查它是否在底部）。

然后，当添加新行时，检查它是否在底部，如果向下滚动，如果在其他地方则滚动回该位置。

检查此[QScrollBar](http://doc.qt.io/qt-4.8/qscrollbar.html)，您可以通过 Horizo​​ntalScrollBar() 和 verticalScrollBar() 从 QTextEdit 中获取它。

* * *

更具体地说，我会将 slot 与来自 QScrollBar - [valueChanged(int value)的信号连接起来，并使用](http://doc.qt.io/qt-4.8/qabstractslider.html#valueChanged)[此处](http://doc.qt.io/qt-4.8/qscrollbar.html#details)描述的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-17T13:16:09.310

不必连接滚动条侦听器。只需在附加文本之前查询滚动条：

```
QScrollBar *scrollbar = textedit->verticalScrollBar();
bool scrollbarAtBottom  = (scrollbar->value() >= (scrollbar->maximum() - 4));
int scrollbarPrevValue = scrollbar->value(); 
```

“减 4” hack`scrollbarAtBottom`是必要的，因为`ensureCursorVisible()`它不会完全滚动到底部，而是在上面一些固定的量。请检查您的字体大小。

现在您可以插入文本：

```
textedit->moveCursor(QTextCursor::End);
// begin with newline if text is not empty
if (! textedit->document()->isEmpty())
    textedit->insertHtml(QStringLiteral("<br>"));
textedit->insertHtml(QStringLiteral("My text here.")) 
```

完成该操作后，要么滚动到底部，要么固定滚动条使其完全不动：

```
if (scrollbarAtBottom)
    textedit->ensureCursorVisible();
else
    textedit->verticalScrollBar()->setValue(scrollbarPrevValue); 
```

# asp.net-mvc - 防止 XSS 黑客攻击的最佳实践

> ID：14550149
> 
> 赞同：1
> 
> 时间：2013-01-27T17:40:19.240
> 
> 标签：asp.net-mvc, xss

我是 25 名开发人员的团队成员。我们使用 mvc.net 应用程序，安全性对我们来说很重要。我们使用`@Html.AntiForgeryToken()`任何与安全性相关的东西，但我们担心防止 XSS 黑客攻击。我们对每个地方都进行编码，但有些地方我们需要用户的 html。防止 XSS 黑客攻击的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T17:41:22.097

防止 XSS 的黄金法则是对您输出到视图的所有内容进行 HTML 编码。

希望`@`Razor 功能已经为您自动执行此操作。

因此，当您编写以下内容之一时，您是非常安全的：

```
@Model.SomeProperty
@Html.DisplayFor(x => x.SomeProperty) 
```

你应该小心`@Html.Raw`助手：

```
@Html.Raw(Model.SomeProperty) 
```

如果你使用它，输出将不会是 HTML 编码的。这并不意味着您的网站容易受到 XSS 注入的攻击。例如，如果您完全控制该属性并且不是来自用户输入，那么您应该是非常安全的。

如果您使用的是 WebForms 视图引擎，那么您应该更加小心，因为该`<%=`函数不对输出进行 HTML 编码。

所以以下是不安全的：

```
<%= Model.SomeProperty %> 
```

您应该使用以下方法之一：

```
<%= Html.DisplayFor(x => x.SomeProperty) %>
<%: Model.SomeProperty %> 
```

另一方面，如果您需要在没有 HTML 编码的情况下输出一些用户输入，我建议您使用[`AntiXSS`](http://wpl.codeplex.com/)Microsoft 的库。它将从输入中过滤掉所有危险标签，您可以安全地输出它。例如，它将`<script>`从输入中删除标签。还有一个[`article on MSDN`](http://msdn.microsoft.com/en-us/library/aa973813.aspx)关于这个库的内容，您可以查看。

# jenkins - Jenkins 上的 Zend Framework 2 单元测试不起作用

> ID：14550150
> 
> 赞同：1
> 
> 时间：2013-01-27T17:40:27.310
> 
> 标签：jenkins, phpunit, zend-framework2

我有一个 zend 框架 2 项目，我正在尝试设置我的 jenkins 以便可以执行单元测试。Jenkins 在 ubuntu 上运行，我正在使用 PHPStorm 在 Windows 7 下开发。

构建.xml

```
<target name="phpunit" description="Run unit tests with PHPUnit">
    <exec executable="phpunit" failonerror="true">
        <arg value="${basedir}/module/Addressbook/test"/>
    </exec>
</target> 
```

# 文件夹结构：

*   项目
    *   模块
        *   地址簿
        *   测试
            *   通讯录测试
                *   控制器
                    *   地址簿控制器测试.php
                *   Boostrap.php
                *   phpunit.xml.dist
                *   测试配置.php
    *   构建.xml

# 詹金斯输出：

```
php单元：
     [执行] Sebastian Bergmann 的 PHPUnit 3.7.13。
     [执行]
     [exec] PHP 致命错误：在第 28 行的 /var/lib/jenkins/workspace/Test/src/module/Addressbook/test/AddressbookTest/Controller/AddressbookControllerTest.php 中找不到类 'AddressbookTest\Bootstrap'
```

我本地机器上的 PHPStorm 在运行 phpunit.xml.dist 时会执行此操作

```
D:\Zend\ZendServer\bin\php.exe -d auto_prepend_file=D:/Zend/Apache2/htdocs/demoshop/vendor/autoload.php C:\Users\ChristianB\AppData\Local\Temp\ide-phpunit.php --configuration D:/Zend/Apache2/htdocs/demoshop/module/Addressbook/test/phpunit.xml.dist
```

How can i use that for jenkins?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:00:22.153

It looks like your include path isn't setup correctly, I wouldn't use exec directly with PHPUNIT when there's better options.

You should look into using PHING tasks with Jenkins, they work excellent together.

You then setup Jenking to trigger your PHING target to run the unit tests for you via the PHPUNIT task, an example phing target for PHPUNIT:

```
<target name="phpunit">
    <phpunit bootstrap="${srcdir}/tests/bootstrap.php">
        <formatter todir="${builddir}/reports" type="xml"/>
        <batchtest>
            <fileset dir="${srcdir}/tests">
                <include name="**/*Test*.php"/>
                <exclude name="**/Abstract*.php"/>
                <exclude name="${srcdir}/vendor/**"/>
            </fileset>
        </batchtest>
    </phpunit>
    <!-- 
        Generate a report from the XML data created.. 
        note: error when using format="frames"
    --> 
    <phpunitreport infile="${builddir}/reports/testsuites.xml" 
        format="noframes" 
        todir="${builddir}/reports/tests"
    />

</target> 
```

# c# - 父子都具有属性的 Xpath - htmlagilitypack

> ID：14550152
> 
> 赞同：0
> 
> 时间：2013-01-27T17:40:43.533
> 
> 标签：c#, xpath, html-agility-pack

我有这样的东西，

```
<div class="rightpanel">
.
.
<ul..>...</ul>
<ul class="side-panel categories"></ul>
.
</div> 
```

我正在尝试使用 htmlagilitypack 选择具有类侧面板类别的 ul。

我努力了，

```
HtmlDocument.DocumentNode.SelectNodes("//div[@class='right-panel']/ul[@class='side-panel categories']") 
```

但它给了我一个空引用异常......请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:03:42.300

在 HTML 中， div 具有 class `rightpanel`，但在您的 XPath 中它是`right-panel`. 请试试这个：

```
HtmlDocument.DocumentNode
      .SelectNodes("//div[@class='rightpanel']/ul[@class='side-panel categories']") 
```

如果 the`<ul>`不是 the 的直接子代`<div>`（即，如果它的父代不是它`<div>`本身，那么您将需要这个：

```
HtmlDocument.DocumentNode
      .SelectNodes("//div[@class='rightpanel']//ul[@class='side-panel categories']") 
```

在 .之前有一个双斜杠`ul`。

# c# - Windows Phone 中的 SQL 查询表达式

> ID：14550162
> 
> 赞同：1
> 
> 时间：2013-01-27T17:41:30.297
> 
> 标签：c#

我有一个 DB - ScoreDB 和表 - ScoreTable 属性名称和分数。我想按降序显示分数：

```
t = from ScoreTable s in scoreDB.ScoreTable
                    orderby s.Score descending
                    select s; 
```

行错误：

```
GameScoreCollection = new ObservableCollection<ScoreTable>(t); 
```

«成员 'BrainGainWP.ScoreTable.Score' 不支持 SQL 转换。»。但是，如果所有工作的订单名称：

```
t = from ScoreTable s in scoreDB.ScoreTable
                    orderby s.Name descending
                    select s; 
```

表代码：

```
[Table]
public class ScoreTable : INotifyPropertyChanged, INotifyPropertyChanging
{       
    [Column(IsPrimaryKey = true, IsDbGenerated = true, DbType = "INT NOT NULL Identity", CanBeNull = false, AutoSync = AutoSync.OnInsert)]
  }

    private string _Name;

    [Column]
    public string Name
    {
        get
        {
            return _Name;
        }
        set
        {
            if (_Name != value)
            {
                NotifyPropertyChanging("Name");
                _Name = value;
                NotifyPropertyChanged("Name");
            }
        }
    }

    [Column]
    private int  _Score;
    public int  Score
    {
        get
        {
            return _Score;
        }
        set
        {
            if (_Score != value)
            {
                NotifyPropertyChanging("Score");
                _Score = value;
                NotifyPropertyChanged("Score");
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:04:43.407

你有`[Column]`你的私有变量`Score`，而不是公共变量：

```
private int  _Score;
[Column]
public int  Score
{
    get
    {
        return _Score;
    }
    set
    {
        if (_Score != value)
        {
            NotifyPropertyChanging("Score");
            _Score = value;
            NotifyPropertyChanged("Score");
        }
    }
} 
```

# joomla - Joomla建设在线但私人

> ID：14550163
> 
> 赞同：0
> 
> 时间：2013-01-27T17:41:32.543
> 
> 标签：joomla, joomla2.5, joomla-extensions, joomla-module

任何人都知道这是怎么可能的。开发您的网站（模块和所有内容，但仅供我（管理员）查看而不是向公众开放。我不想在 XAMPP 中制作它，然后在实时服务器上重新上传它。（它已经导致过去的一些问题）

我认为的一种方法是仅通过 .htacess 限制网站对我的 IP 的访问，这会导致任何故障或任何问题吗？

任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:48:54.800

按照这些说明将您的 Joomla 网站“离线”。干得好：

[http://docs.joomla.org/Taking_the_website_temporarily_offline](http://docs.joomla.org/Taking_the_website_temporarily_offline)

# c++ - 如何通过 calcBackProject 获得包含超过 255 或十进制数字的反投影矩阵？

> ID：14550167
> 
> 赞同：0
> 
> 时间：2013-01-27T17:41:49.517
> 
> 标签：c++, opencv, scale

我需要使用*calcBackProject*然后显示确切的数字。

```
 for ( int i = 0; i < backProj.rows; ++i )
    {
        for ( int j = 0; j < backProj.cols; ++j )
        {
            cout << int(backProj.at< uchar >( i, j )) << " ";
        }
        cout << endl;
    } 
```

但是由于“uchar”，它的最大值是255。我试着用

```
 Mat backProj( slid_.rows, slid_.cols, CV_64FC1 ); 
```

使用*calcBackProject*后，显示它

```
 cout << backProj.at< double >( i, j ); 
```

但它不起作用。

我真的需要大于 255 的确切数字。我以前不想使用*normalize*。我可以通过*calcBackProject 实现*吗？

如果我尝试按**比例缩小**，这个反投影矩阵可以包含十进制吗？因为我不希望 0 存在于这个矩阵中。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T11:26:27.537

最后，我编写了自己的函数来获取反向投影。希望它可以帮助有同样问题的你。

```
float ReadValueFromHist( const Mat& hist, const int x, const int y ) const
{
    int indexAlpha = int( mat.at< Vec4b >( x, y )[ 3 ] ) * bins / 256;
    return hist.at< float >( indexAlpha, 0 );
}

void CalcBackProj()
{
    backProj = Mat( mat.rows, mat.cols, CV_32FC1);
    for ( int i = 0; i < mat.rows; ++i )
    {
        for ( int j = 0; j < mat.cols; ++j )
        {
            backProj.at< float >( i, j ) = ReadValueFromHist( hist, i, j );
        }
    }
} 
```

# php - 如何在 Linux 上获取文件系统 errno

> ID：14550170
> 
> 赞同：4
> 
> 时间：2013-01-27T17:41:58.267
> 
> 标签：php, error-handling

我看到该`file_put_contents`函数正在返回`FALSE`，但是否有可能知道`errno`从 Linux 内核的系统调用返回的错误 ()？

失败的原因可能有很多（甚至可能取决于设备或驱动程序）。所以我想知道确切的错误原因。

`file_put_contents`简单地返回`FALSE`失败。

我想要的将等同于 C`errno`或`perror`C 函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:49:43.867

结果可能有点模棱两可，但最接近`errno`PHP 中的等价物是[`error_get_last`](http://php.net/manual/en/function.error-get-last.php)函数。

# jquery - 手风琴黑屏中的IE 9嵌套形式

> ID：14550171
> 
> 赞同：0
> 
> 时间：2013-01-27T17:41:57.640
> 
> 标签：jquery, html, css, internet-explorer-9, zurb-foundation

我正在使用基金会的手风琴 js。我在 chrome 中查看表单时创建表单没有问题，但是在 IE v 9 中，除了页脚链接之外，整个页面都是黑色的。对于我的网站，我在整个网站中都包含相同的页眉和页脚，这就是为什么我发现这个问题只出现在这个页面上很有趣。

我正在努力在 IE 上寻找一些开发人员的工具，但在那之前我想联系一下，看看是否有人遇到过这个问题。我相信这与 jquery 和 css 有关，因为在页面加载时您可以看到正常的布局，但是之后页面是黑色的。

这是我的js：

```
$(document).ready(function() {

$(window).load(function() {
  $('#loading').hide();                   
  $('div.container div').show();   
  $(".active").trigger('click');
}); 
```

这是问题的链接，请记住这只发生在 ie v 9 中：[http ://rppdesigns.com/dev/pennProp_dev/index.php/home/contact](http://rppdesigns.com/dev/pennProp_dev/index.php/home/contact)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:48:01.863

如果您正在寻找开发人员的工具，我强烈推荐 www.projectseven.com。他们的手风琴工具很棒。我一直在使用它，它在 iPad 和手机上也能正常工作，并适应设备旋转等你可以用事件来控制它。

巴里

# list - 存储多集/无序列表的节省空间的方法

> ID：14550174
> 
> 赞同：2
> 
> 时间：2013-01-27T17:42:16.357
> 
> 标签：list, data-structures, encoding, language-agnostic, multiset

我需要在一个文件中存储大量整数。整数的顺序无关紧要，所以总信息量应该低于有序列表。有没有比任意排序的数组更节省空间的方法来存储数字？

编辑：我假设整数是完全随机的。我真的在寻找一种通用的方法来挤出通过修复排列引入的冗余信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T01:23:14.950

要进行压缩，您实际上需要更高的信息内容。您通常不能压缩随机性。幸运的是，您的问题规范允许您重新排序数据。因此，您可以对数据进行排序，从而增加其信息量。然后，您不需要存储整数列表，只需存储最小的和一阶差分的序列。第一个差异将小于数字本身，因此应该适合更少的位。

排序后的随机生成序列

```
sorted seq     (173 218 257 490 618 638 715 815 856 929 932 996)
number of bits (  6   6   6   7   7   7   7   7   7   7   7   7) 
```

可以存储为

```
first diff     (173 45 39 233 128 20 77 100 41 73 3 64)
number of bits (  6  4  4   6   5  3  5   5  4  5 2  5) 
```

其中例如 45 是 173 和 218 之间的差异，即第一个和第二个元素。这些数字需要 54 位，而以上需要 81 位。如果数字在绘制它们的范围内相当密集，您可能会看到第一个差异的最大位数低于使您能够使用更小的固定位长度的数据。如果您不使用固定大小，您还必须存储分隔符或使用其他一些自适应方案，以便您可以确定一个数字在哪里结束，下一个数字从哪里开始。如果您的数据有大量重复项（如果您的数字是从相对较小的范围内随机抽取的），您可能还需要考虑对第一个差异中的零进行[编码的游程长度。](http://en.wikipedia.org/wiki/Run-length_encoding)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T20:43:42.213

一般来说，我会说不。如果您的数字有某种模式或以某种单一方式分布，那么您应该提及它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-21T19:37:49.213

本文正是这样做的。

用大字母压缩多重集

论文：[https ://arxiv.org/abs/2107.09202](https://arxiv.org/abs/2107.09202)

代码：[https ://github.com/facebookresearch/multiset-compression](https://github.com/facebookresearch/multiset-compression)

摘要：[https ://twitter.com/_dsevero/status/1419661190750425102](https://twitter.com/_dsevero/status/1419661190750425102)

# iphone - iPhone 6.0 模拟器不显示主页按钮或框架

> ID：14550179
> 
> 赞同：12
> 
> 时间：2013-01-27T17:42:51.900
> 
> 标签：iphone, xcode, ios-simulator

当我运行 iOS 模拟器（运行 iOS 6.0 的 iPhone）时，它不显示主页按钮或框架。

我在 VMware 实例上安装了 Mac OS X 和 Xcode。

![没有硬件主页按钮或框架的 iOS 模拟器](../Images/00563059fd60810b32cbf617fde7ca86.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-28T06:17:33.593

将 iPhone 模拟器的缩放比例增加到 100% 或

其他选项是使用**命令窗口+shift+h**

这会像你按下主页按钮一样工作

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-27T17:48:07.790

*iPhone 5 (iOS 6) 没有任何主页按钮或框架。*

*要转到主屏幕，请执行以下步骤：*

> 1.  模拟器
> 2.  硬件
> 3.  家

*获取框架的唯一可能方法是获取 iPhone 模拟器屏幕截图，然后在 Photoshop 中将其裁剪到 iPhone 5 框架中。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-11T18:50:02.450

模拟器打开后按**Command+1**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-28T06:03:45.990

尝试单击命令+2 按钮放大尝试命令+1、命令+3。看到不同的尺寸。检查是否选择了模拟器应用程序。

# python - 扭曲的 adbapi 关闭自动提交 (psycopg2)

> ID：14550182
> 
> 赞同：2
> 
> 时间：2013-01-27T17:43:34.173
> 
> 标签：python, twisted, psycopg2

我插入了很多行，似乎 postgress 跟不上。我google了一下，建议你可以关闭自动提交。我不需要立即提交这些值。如果出现问题，我可以再次获取这些数据。

现在，当我搜索关闭自动提交时，我没有找到我正在寻找的东西。我尝试在 dbpool 构造函数中提供 autocommit=False ：

```
dbpool = adbapi.ConnectionPool('psycopg2', user="xxx", password="xxx", database="postgres", host="localhost", autocommit=False) 
```

2013-01-27 18:24:42,254-collector.EventLogItemController-警告-[失败实例：回溯：：无效连接选项“自动提交”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:43:39.323

psycopg2 不声称支持以下`autocommit`关键字参数`connect`：

```
connect(dsn=None, database=None, user=None, password=None, host=None, port=None, connection_factory=None, async=False, **kwargs)
    Create a new database connection.

    The connection parameters can be specified either as a string:

        conn = psycopg2.connect("dbname=test user=postgres password=secret")

    or using a set of keyword arguments:

        conn = psycopg2.connect(database="test", user="postgres", password="secret")

    The basic connection parameters are:

    - *dbname*: the database name (only in dsn string)
    - *database*: the database name (only as keyword argument)
    - *user*: user name used to authenticate
    - *password*: password used to authenticate
    - *host*: database host address (defaults to UNIX socket if not provided)
    - *port*: connection port number (defaults to 5432 if not provided)

    Using the *connection_factory* parameter a different class or connections
    factory can be specified. It should be a callable object taking a dsn
    argument.

    Using *async*=True an asynchronous connection will be created.

    Any other keyword parameter will be passed to the underlying client
    library: the list of supported parameter depends on the library version. 
```

当前的 postgresql 文档也没有讨论任何“自动提交”参数：

```
http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-CONNSTRING 
```

所以也许问题是这不是为 psycopg2 连接禁用自动提交的正确方法。除此之外，您不会发现关闭自动提交实际上对您有帮助。 `adbapi.ConnectionPool`将为您开始并提交显式事务，回避任何`autocommit`可能给您的行为模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:33:53.977

adbapi 的问题在于：1）它缺少特定于某些数据库后端的功能 2）它的假异步 api。在幕后它使用线程池并调用阻塞方法。

对于 postgres，我建议使用 txpostgres 库（来源在这里：[https](https://github.com/wulczer/txpostgres) ://github.com/wulczer/txpostgres ）。它使用 psycopg2 的异步 api，它允许您指定连接字符串。你可以在这里找到一个例子：http: [//txpostgres.readthedocs.org/en/latest/usage.html#customising-the-connection-and-cursor-factories](http://txpostgres.readthedocs.org/en/latest/usage.html#customising-the-connection-and-cursor-factories)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-20T09:16:43.983

使用`cp_openfun`twisted.enterprise.adbapi.ConnectionPool[构造函数的选项](https://twistedmatrix.com/documents/current/api/twisted.enterprise.adbapi.ConnectionPool.html#__init__)

以连接作为参数调用此函数。

在 psycopg2 的情况下，您可以将该连接的自动提交属性设置为`True`或`False`按[此处所述](http://initd.org/psycopg/docs/connection.html#connection.autocommit)

# c# - 延迟加载实体，正在加载引用但实体属性不是

> ID：14550185
> 
> 赞同：0
> 
> 时间：2013-01-27T17:43:48.473
> 
> 标签：c#, entity-framework, lazy-loading

我仍在 EF 学习过程中，我正在尝试更熟悉 EF 延迟加载。

请考虑以下课程和测试：

```
[Table("Tenant")]
public class  Tenant : IEntity
{
    public int Id { get; set; }
    public virtual string Name { get; set; }
    [Key]
    public string Guid { get; set; }
    public virtual ICollection<User> Users { get; set; }
    public virtual ICollection<CaseType> CaseTypes { get; set; }

    public Tenant()
    {
        Users = new List<User>();
        CaseTypes = new List<CaseType>();
    }
} 
```

和测试：

```
 [Test]
    public void TenantLazyLoading()
    {
        var tenant = _applicationContext.Tenants.Create();
        tenant.Guid = "d176dc7c-6b96-4ab6-bddf-ce5a12024c39";
        _applicationContext.Tenants.Attach(tenant);
        Assert.AreEqual(1, tenant.Users.Count); // Pass, the navigation property users was loaded (lazy)
        Assert.AreEqual("localhost", tenant.Name); // Fail, the tenant name is not loaded
    } 
```

延迟加载显然仅适用于 Navigation 属性，但不适用于 Tenant 属性。我将两个属性 (`Users`和`Name`) 都设为虚拟，但这似乎无关紧要。

我怎样才能`lazy load`获得本地属性`Tenant`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T20:42:52.350

这就是它的工作方式。如果您手动创建实体并将`Attach`其添加到上下文中，则您告诉 EF 您**不想**加载实体的标量属性。

没有延迟加载标量属性，您必须始终明确地执行此操作，或者通过添加...

```
_applicationContext.Entry(tenant).Reload(); 
```

...after `Attach` or by replacing the first three lines by:

```
var tenant = _applicationContext.Tenants
    .Find(new Guid("d176dc7c-6b96-4ab6-bddf-ce5a12024c39")); 
```

# c# - 检查新文件夹是否存在的 C# 控制台应用程序

> ID：14550186
> 
> 赞同：2
> 
> 时间：2013-01-27T17:43:48.853
> 
> 标签：c#

> **可能重复：**
> [如何查看文件系统目录以查看何时将文件添加到其中？](https://stackoverflow.com/questions/7593955/how-can-i-watch-a-file-system-directory-to-see-when-files-are-added-to-it)

我正在用 c# 创建一个控制台应用程序，它的功能之一是扫描修复文件夹路径（例如 c:\FixedFolderA），每分钟说一次并检查是否已创建新文件夹（例如 c:\FixedFolderA\NewFolderB）。

所以会在 c:\FixedFolderA 下创建几个文件夹。

新文件夹将没有子目录，只有我将复制到其他位置的文件。

我不确定执行此操作的最有效设计，需要您的帮助。

我在考虑这个工作流程：

1.  在程序开始时扫描 c:\FixedFolderA。
2.  将所有子目录存储在列表中。
3.  创建一个扫描 c:\FixedFolderA 的工作进程并检查该子目录是否存在于列表中。如果目录不存在，请执行一些操作。

我担心的是 c:\FixedFolderA 中的子目录数量会增加超时，并且程序每分钟都会遍历所有这些目录。

每分钟检查的例程是否应该通过一个流程来完成？

有人可以用最好的设计分享你的想法让我开始吗？

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:50:19.440

如果您打算查看文件夹的更改，请使用[`FileSystemWatcher`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)该类。

此外，如果此控制台应用程序自行执行特定任务，则最好将其转换为[Windows 服务](http://msdn.microsoft.com/en-us/library/y817hyb6.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:18:23.800

当事件发生时得到通知几乎总是比定期查询要好。

对于您所描述的上下文，您可以非常轻松地使用[`FileSystemWatcher`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)该类来指定要通知的文件类型以及要监视的目录。我为您整理了以下代码：

```
FileSystemWatcher fileWatcher = new FileSystemWatcher("C:\\Users\\ByteBlast\\Desktop", "*.*")
{
    EnableRaisingEvents = true, 
    IncludeSubdirectories = true,
    NotifyFilter =  NotifyFilters.DirectoryName
};

fileWatcher.Created += (sender, eventArgs) => Console.WriteLine("{0} Created", eventArgs.FullPath); 
```

在我指定桌面路径的地方，您将指定例如`C:\FixedFolderA`.

您可以通过启用该属性来确保您收到有关子目录更改的通知，`IncludeSubDirectories`就像我在上面所做的那样。

因为您只对文件夹而不是文件感兴趣，所以我将`NotifyFilter`属性设置为`NotifyFilters.DirectroyName`.

将上面的代码放在您的控制台应用程序中`void Main()`，并确保您停止控制台关闭，例如在上面的代码下方包含以下语句`Process.GetCurrentProcess().WaitForExit();`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:49:08.513

您应该仔细查看[File System Watcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx) ，而不是每分钟扫描目录。这将告诉您何时对目录结构进行了更改-因此它将更加有效。您的程序只需要跟踪所做的更改。

# c++ - 如何将字符串中的数据放入cin

> ID：14550187
> 
> 赞同：3
> 
> 时间：2013-01-27T17:43:50.377
> 
> 标签：c++, unit-testing, cin

我需要为不是我编写的小型学习程序编写测试（使用谷歌测试框架）。（它只是一个小型控制台游戏，可以从命令行获取模式或仅在运行时获取模式） 有一个问题：我无法更改源代码，但几乎所有方法都使用了 cout 和 cin。我的问题是**“如何在测试时回答程序的请求（cin）（例如从字符串获取 cin 的数据）？** ”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T18:14:29.180

假设您可以控制`main()`（或在要测试的函数之前调用的其他函数），您可以更改`std::cin`读取位置和`std::cout`写入位置：

```
int main(int ac, char* av[]) {
    std::streambuf* orig = std::cin.rdbuf();
    std::istringstream input("whatever");
    std::cin.rdbuf(input.rdbuf());
    // tests go here
    std::cin.rdbuf(orig);
} 
```

（同样对于`std::cout`）

这个例子保存了原始的流缓冲区，`std::cin`以便在离开之前可以替换它`main()`。然后它设置`std::cin`为从字符串流中读取。它也可以是任何其他流缓冲区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:10:34.870

我的理解是您需要执行以下操作：

1.  启动/启动目标可执行文件（游戏）。
2.  将测试数据发送到目标可执行文件。
3.  从目标可执行文件获取输出。
4.  将输出与预期结果进行比较。

标准 C++ 语言没有与其他程序通信的标准工具。您将需要操作系统的帮助（您没有指定）。

仅使用**C++**或**不使用特定于操作系统的调用**，我建议：

1.  将测试输入写入文件。
2.  运行可执行文件，将测试输入文件作为输入通过管道传输，并将输出通过管道传输到结果文件。
3.  读取并分析结果文件。

否则，请搜索您的操作系统 API 以了解如何写入 I/O 重定向驱动程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:13:01.107

我知道你说你不能修改代码，但我会尽可能地回答这个问题。现实世界通常允许（小的）修改以适应测试。

一种方法是将需要外部输入（数据库、用户输入、套接字等）的调用包装在虚拟的函数调用中，以便您可以模拟它们。（示例如下）。但首先，关于测试的书籍推荐。 [Working Effectively with Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0131177052)是一本伟大的书，用于测试不仅限于遗留代码的技术。

```
class Foo {
public:
   bool DoesSomething() 
   {
      string usersInput;
      cin >> usersInput;
      if (usersInput == "foo") { return true; }
      else { return false; }
   }
}; 
```

会变成：

```
class Foo
{
public:
   bool DoesSomething() {
      string usersInput = getUserInput();
      if (usersInput == "foo") { return true; }
      else { return false; }
   }

protected:
   virtual std::string getUserInput() {
      string usersInput;
      cin >> usersInput;
      return usersInput;
   }

};

class MockFoo : public Foo {
public:
   void setUserInput(std::string input) { m_input = input }
   std::string getUserInput() {
      return m_input;
   }
};

TEST(TestUsersInput)
{
   MockFoo foo;
   foo.setUserInput("SomeInput");
   CHECK_EQUAL(false, foo.DoesSomething());

   foo.setUserInput("foo");
   CHECK_EQUAL(true, foo.DoesSomething());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T18:32:26.663

`cin`您可以通过不直接使用and来提高类的可测试性`cout`。而是使用`istream&`and`ostream&`将输入源和输出接收器作为参数传递。这是一个依赖注入的例子。如果你这样做，你可以传入 a`std::stringstream`而不是`cin`，这样你就可以提供指定的输入并获取测试框架的输出。

也就是说，您可以通过将 cin 和 cout 转换为`stringstream`s 来实现类似的效果（至少暂时如此）。为此，请设置一个 std::stringbuf （或从 a 中“借用”一个`std::stringstream`）并使用`cin.rdbuf(my_stringbuf_ptr)`来更改`streambuf`使用的 by `cin`。您可能希望在测试拆解中恢复此更改。为此，您可以使用如下代码：

```
stringbuf test_input("One line of input with no newline", ios_base::in);
stringbuf test_output(ios_base::out);
streambuf * const cin_buf = cin.rdbuf(&test_input);
streambuf * const cout_buf = cout.rdbuf(&test_output);
test_func(); // uses cin and cout
cout.rdbuf(cout_buf);
cin.rdbuf(cin_buf);
string test_output_text = test_output.str(); 
```

# ios - MFMailComposeViewControllerDelegate 方法不会被 iOS 6 调用

> ID：14550190
> 
> 赞同：0
> 
> 时间：2013-01-27T17:44:02.850
> 
> 标签：ios, ios6, delegates, mfmailcomposeviewcontroller

我展示了 MFMailComposeViewController 控制器并将其设置为委托 - 在 iOS 5 中一切正常，但在 iOS6 中未调用委托方法 (mailComposeController:didFinishWithResult:error:)。

以下是代码片段：

```
MFMailComposeViewController* controller = [[MFMailComposeViewController alloc] init];
controller.mailComposeDelegate = self;
[controller setSubject:<text>];
[controller setMessageBody:<text> isHTML:NO];
[self presentViewController:controller animated:YES completion:nil]; 
```

尽管在按下取消或完成按钮后控制器成功关闭，但在 iOS6 中未调用以下委托方法：

```
- (void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error {
  if (error != nil) {
      NSLog(@"An error occurred while sending e-mail. %@, %@", error, [error userInfo]);
  }
  NSLog(@"done with e-mail");
  [self dismissViewControllerAnimated:YES completion:nil];
} 
```

任何建议将不胜感激！先感谢您。

编辑：方法 viewWillAppear：我的控制器呈现 mailComposeController 也没有被调用！可以作为线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:16:39.230

这个问题是不正确的，因为我实际上在 iOS6 中使用 UIActivityViewController 进行数据共享并且没有创建/呈现 MFMailComposeViewController。这就是为什么我没有看到委托方法被触发的原因。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T01:46:36.723

我有一个在 iOS6 上工作的实现，也遇到了一些问题，听起来很奇怪，不知道它是否对你的情况有帮助，但我从我的 iOS 5 实现中改变了两件事，而不是使用

```
controller.mailComposeDelegate = self; 
```

我用了

```
[controller setMailComposeDelegate:self]; 
```

另外，我错过了 UINavigationControllerDelegate 协议

# python - 在 PyQt 中创建和使用用户定义的插槽

> ID：14550191
> 
> 赞同：1
> 
> 时间：2013-01-27T17:44:07.250
> 
> 标签：python, pyqt, signals-slots

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
from PyQt4 import QtGui, QtCore

class Example(QtGui.QMainWindow):
    def __init__(self):
        super(Example, self).__init__();
        self.initUI()

    def initUI(self):
        field = QtGui.QLineEdit("", self)
        field.resize(field.sizeHint())
        field.move(150, 100)

        submit_button = QtGui.QPushButton("Fill hello world", self)
        submit_button.resize(submit_button.sizeHint())
        submit_button.move(50,300)
        submit_button.clicked.connect(self.modify(field))

    def modify(self, field):
        field.setText("hello")

def main():    #!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
from PyQt4 import QtGui, QtCore

class Example(QtGui.QMainWindow):
    def __init__(self):
        super(Example, self).__init__();
        self.initUI()

    def initUI(self):
        field = QtGui.QLineEdit("", self)
        field.resize(field.sizeHint())
        field.move(150, 100)

        submit_button = QtGui.QPushButton("Fill hello world", self)
        submit_button.resize(submit_button.sizeHint())
        submit_button.move(50,300)
        submit_button.clicked.connect(self.modify(field))

    def modify(self, field):
        field.setText("hello")

def main():
    app = QtGui.QApplication(sys.argv)
    ex = Example()
    ex.show()
    sys.exit(app.exec_())

if __name__=='__main__':
    main()

    app = QtGui.QApplication(sys.argv)
    ex = Example()
    ex.show()
    sys.exit(app.exec_())

if __name__=='__main__':
    main() 
```

行。所以这就是我想要做的。每当单击 sumbit 按钮时，我希望该字段由“hello world”填充。这意味着将提交按钮连接到用户定义的插槽。如何将字段传递给 modify() 函数，在其中可以更改其文本？

目前代码给出错误：

```
 File "test.py", line 21, in initUI
    submit_button.clicked.connect(self.modify(field))
TypeError: connect() slot argument should be a callable or a signal, not 'NoneType' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:51:21.563

首先，您收到错误消息，`connect()`因为您没有将函数作为参数传递，而是函数调用的结果，即`None`. 这一行应该写成：

```
submit_button.clicked.connect(self.modify) 
```

然后修改函数应该更改以知道要填充哪个字段。实现此目的的一种方法是将字段保留在类变量中，并为其添加前缀`self.`：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
from PyQt4 import QtGui, QtCore

class Example(QtGui.QMainWindow):
    def __init__(self):
        super(Example, self).__init__();
        self.initUI()

    def initUI(self):
        self.field = QtGui.QLineEdit("", self)
        self.field.resize(self.field.sizeHint())
        self.field.move(150, 100)

        submit_button = QtGui.QPushButton("Fill hello world", self)
        submit_button.resize(submit_button.sizeHint())
        submit_button.move(50,300)
        submit_button.clicked.connect(self.modify)

    def modify(self):
        self.field.setText("hello")

def main():
    app = QtGui.QApplication(sys.argv)
    ex = Example()
    ex.show()
    sys.exit(app.exec_())

if __name__=='__main__':
    main() 
```

# php - Erlang 和 PHP 之间的加密

> ID：14550195
> 
> 赞同：3
> 
> 时间：2013-01-27T17:44:29.600
> 
> 标签：php, cryptography, erlang, openssl

## 更新 5

将问题切换到 Security StackExchange - 得到了答案。 [https://security.stackexchange.com/questions/30168/aes-cfb-128-decryption-encryption-problem-between-erlang-and-php](https://security.stackexchange.com/questions/30168/aes-cfb-128-decryption-encryption-problem-between-erlang-and-php)

## 更新 4

解决了这个**问题**，或者我想 - 我试图继续实施。结果发现还不够。

一旦我们开始将真实的单词数据放入其中，一切都变得糟糕透顶。一个例子是将纯文本从`1234567812345678`增加到`12345678123456781234567812345678`

在这种情况下，密文的第一个 128 位块是相同的，但第二个是不同的：

PHP： `139 182 94 68 208 173 127 90 14 236 33 230 41 29 210 121 153 57 173 191 237 169 242 222 217 104 116 144 240 175 39 33`

二郎： `<<139,182,94,68,208,173,127,90,14,236,33,230,41,29,210,121,147,172, 114,74,61,11,162,5,112,104,102,63,24,78,34,179>>`

## 更新 3 - （我虽然是）解决了（但我错了）

这个答案提供了最后的线索： [Incorrect key size when porting Crypto++ AES encryption to PHP's mcrypt](https://stackoverflow.com/questions/4052594/incorrect-key-size-in-php-mcrypt-when-porting-cryptopp-aes-encryption-to-phps-m)

问题在于`'cfb'`mode`mycrypt`没有使用正确的反馈块大小来模拟`aes cfb`- 你需要使用 mode `nofb`。

## 更新 2

试图让 AES-CFB-128 在两者之间工作 - 所以我已经确定使用128 块大小和类型`mycrypt`的模式是在 Erlang中的 PHP 等效项。`RINJDAEL_128``'cfb'``crypto:aes_cfb_128/3`

所以我开始用两种语言编写例程来证明这一点。

PHP版本：

```
<?php
// fugly because I don't know enough PHP to write it better
// big apologies to any PHP code poets out there, my bad :(
function dump($String, $Bin) {
echo $String . " is " . ord($Bin[0]) . " " . ord($Bin[1]) . " " . ord($Bin[2]) . " " . ord($Bin[3]) . " " . ord($Bin[4]) . " " . ord($Bin[5]) . " " . ord($Bin[6]) . " " . ord($Bin[7]) . " " . ord($Bin[8]) . " " . ord($Bin[9]) . " " . ord($Bin[10]) . " " . ord($Bin[11]) . " " . ord($Bin[12]) . " " . ord($Bin[13]) . " " . ord($Bin[14]) . " " . ord($Bin[15]) . "\n";
}

$Key  = "abcdefghabcdefgh";
$IV   = "12345678abcdefgh";
$Text = "1234567812345678";

$KeySize  = strlen($Key) * 8;
$IVSize   = strlen($IV) * 8;
$TextSize = strlen($Text) * 8;

$Size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CFB);
echo "Block size is " . $Size . " bytes or " . $Size * 8 . " bits\n";

$Crypt = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $Key, $Text, MCRYPT_MODE_CFB, $IV);
$Decrypt = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $Key, $Crypt, MCRYPT_MODE_CFB, $IV);

echo "Key   is   " . $Key  . " with size " . $KeySize  . "\n";
echo "IV    is   " . $IV   . " with size " . $IVSize   . "\n";
echo "Text  is   " . $Text . " with size " . $TextSize . "\n";

echo "Crypt is " . $Crypt  . "\n";
dump("Crypt", $Crypt);
echo "Decrypt is " . $Decrypt . "\n";
dump("Decrypt", $Decrypt);
?> 
```

当我运行它时，我得到以下 PHP 输出：

```
Block size is 16 bytes or 128 bits
Key   is   abcdefghabcdefgh with size 128
IV    is   12345678abcdefgh with size 128
Text  is   1234567812345678 with size 128
Crypt is ��*�b�ls�M��
Crypt is 139 0 188 42 175 98 18 177 108 27 115 189 77 144 127 176
Decrypt is 1234567812345678
Decrypt is 49 50 51 52 53 54 55 56 49 50 51 52 53 54 55 56 
```

Erlang 版本是：

```
-module(test_crypto).

-export([
         test/0
        ]).

test() ->

    Key  = <<"abcdefghabcdefgh">>,
    IV   = <<"12345678abcdefgh">>,
    Text = <<"1234567812345678">> ,

    KeySize  = bit_size(Key),
    IVSize   = bit_size(IV),
    TextSize = bit_size(Text),

    io:format("Key  is ~p with size ~p~n", [Key, KeySize]),
    io:format("IV   is ~p with size ~p~n", [IV, IVSize]),
    io:format("Text is ~p with size ~p~n", [Text, TextSize]),

    Crypt = crypto:aes_cfb_128_encrypt(Key, IV, Text),
    io:format("Crypt is ~p~n", [Crypt]),

    Decrypt = crypto:aes_cfb_128_decrypt(Key, IV, Crypt),
    io:format("Decrypt is ~p~n", [Decrypt]),
    ok. 
```

当我运行它时，我得到 Erlang 输出：

```
Key  is <<"abcdefghabcdefgh">> with size 128
IV   is <<"12345678abcdefgh">> with size 128
Text is <<"1234567812345678">> with size 128
Crypt is <<139,182,94,68,208,173,127,90,14,236,33,230,41,29,210,121>>
Decrypt is <<"1234567812345678">> 
```

所以每个人都正确地进行了加密/解密循环 - 但加密形式不同 - 我不能在 Erlang 和 PHP 之间使用它。

我确信有一些简单的解释 - 但我不明白它。

PHP 将字符串作为输入 - Erlang 采用二进制文件 - 但似乎 PHP ascii 字符串存储为二进制文件。这是对的还是我错过了什么？

## 更新 1

我发现`crypto:md5_mac/2`可以使用 php 函数复制该函数：

```
function encrypt_term_hex($Key, $Msg) {
    return hash_hmac("md5", $Msg, $Key);
} 
```

* * *

## 原始问题

我想在两个系统之间共享信息，一个用 Erlang 编写，一个用 PHP 编写。

该计划是使用已经在多个 Erlang 系统之间运行的系统，该系统涉及使用在 Erlang 系统之间共享的私钥签署 Erlang 术语。

Erlang 端使用这些函数`crypto:md5_mac/2`，而`crypto:aes_cfb_128_encrypt/3`后者又使用底层的 OpenSSL 加密库。

加密方面（在 Erlang 中）是：

```
encrypt_bin(Key0, PlainT0) ->
    PlainT = extend(PlainT0),
    Key = crypto:md5_mac(get_server_salt(), Key0),
    crypto:aes_cfb_128_encrypt(Key, get_salt(), PlainT). 
```

这个函数的作用是获取一个键值对。然后它将术语的大小扩展到固定大小，使用 md5_mac 和固定（共享）盐生成密钥，最后进行加密 - 使用另一个盐向量对其进行初始化。

到现在为止还挺好。然后我的任务是在 PHP 中复制这个 fn（当然还有它的解密双胞胎）。

Erlang 文档很好：

[http://erlang.org/doc/man/crypto.html](http://erlang.org/doc/man/crypto.html)

试图弄清楚 Erlang 是如何调用底层 Crypto 库的有点困难——因为源代码显示了模糊的 NIF 宏。

PHP 似乎围绕 OpenSSL 实现了一个库包装器，因此它应该是直截了当的。不幸的是，我无法理解它。例如，我查看 openssl-encrypt 并指出它没有记录：

[http://php.net/manual/en/function.openssl-encrypt.php](http://php.net/manual/en/function.openssl-encrypt.php)

有没有什么地方可以得到关于如何在 PHP 中实现 OpenSSL 的好例子/文档？或者 Erlang NIF 加载器是如何工作的？或两者？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:10:29.393

将问题切换到 Security StackExchange - 得到了答案。[https://security.stackexchange.com/questions/30168/aes-cfb-128-decryption-encryption-problem-between-erlang-and-php](https://security.stackexchange.com/questions/30168/aes-cfb-128-decryption-encryption-problem-between-erlang-and-php)

# android - 如何改变下落精灵的路径，让精灵以曲线的方式落入Andengine中的特定位置？

> ID：14550196
> 
> 赞同：1
> 
> 时间：2013-01-27T17:44:29.030
> 
> 标签：android, andengine, game-engine

我有一个下降到底部的精灵..现在在触摸动作中我想改变那个精灵的路径并让它以曲线的方式下降（抛射方式）..请建议我应该使用什么..

# c# - Windows 窗体 - 如何从整个集合中排除按钮

> ID：14550201
> 
> 赞同：3
> 
> 时间：2013-01-27T17:44:51.457
> 
> 标签：c#, winforms, visual-studio-2010

我有一个`Windows Form`只包含`buttons`. 最终目标是制作一个我看到的简单逻辑游戏，但现在的问题是我想在`New`单击按钮时执行不同的操作，但现在它是`buttons`表单中所有内容的一部分，因此有时会对他执行操作也不应该发生。为了让自己清楚，我有两个屏幕截图：

![在此处输入图像描述](../Images/4338240f75c09a974b022b5f396ac17d.png)

所以这就是我想要的样子——我有一个矩阵——3x3（在这种情况下，最后它可以是`NxN`）。通过单击`New`，我希望能够做各种事情，其中​​之一就是将`N`按钮设置为红色。现在发生的事情是有时我的`New`按钮也会被绘制，因为我会像这样查看按钮：

```
 foreach (Control c in this.Controls) 
                        {
                            if (c is Button)
                            {
                 ... 
```

因此有时也会`New`被选中，所以我最终得到了这个：

![在此处输入图像描述](../Images/a2a7b2f3c5d015cbf178e3ab1661f48d.png)

我现在在想的只是在我需要时在代码中执行检查并`New`明确排除我的按钮，但我认为这不是一个好方法，因为我最终可能会在很多地方用代码做这件事我的程序那么在这种情况下正确的解决方案是什么？如果需要一些代码，请询问。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T17:50:08.310

不要循环遍历控件，而是将所有矩阵按钮添加到列表中，并将`new`按钮分开：

```
private Button[] buttons;
private Button newButton; 
```

现在您可以添加任意数量的按钮：

```
for (int i = 0; i < 9; i++)
{
    buttons[i] = new Button();
    buttons[i].Text = "Button" + i;
    Controls.Add(buttons[i])
} 
```

最后，您的`New`按钮将循环播放`buttons`：

```
private void newButton_Click(object sender, EventArgs e)
{
    foreach (Button b in buttons)
    {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-27T17:51:01.010

很可能最简单的解决方案是将 Grid 放在它自己的 Panel ( `pnlGrid`) 中。将所有按钮放在那里，然后您可以执行以下操作：

```
foreach (Control ctl in pnlGrid.Controls) { 
    if (ctl is Button) {
        // Do your logic here
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:49:49.073

您可以从按钮类继承。制作您自己的按钮，使用此控件（将具有与父控件相同的功能）作为集合，并在您遍历控件时检查它。

您也可以为此浇注使用 Tag 属性，但我认为继承会更清晰，为您的代码添加语义含义。

# javascript - 如何使用 JavaScript 生成的 HTML 进行 jQuery 操作？

> ID：14550202
> 
> 赞同：0
> 
> 时间：2013-01-27T17:44:52.463
> 
> 标签：javascript, jquery, leaflet

我使用[LeafletJS](http://leafletjs.com/)创建了一个地图并添加了一个按钮，该按钮用作通过 jQuery 驱动的触发器。但是使用 .click() 事件侦听器不起作用。所以我查看了页面的来源并做了一些实验。

我发现几乎所有通过*JavaScript生成的代码对**jQuery*来说都是不可见的。我几乎无法使用地图的任何元素作为触发器或以任何方式影响它们（例如使用`.css()`）。

我想知道两件事：

*   为什么通过 JavaScript 生成的 HTML对 jQuery是*不可见的？*它是库（[LeafletJS](http://leafletjs.com/)）特定的吗
*   有没有办法使用 jQuery 访问通过 JavaScript 库生成的 HTML 而无需修改它自己的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:48:20.157

您无法使用 jQuery 触摸其中的任何内容的原因是 LeafletJS 中的代码是异步运行的。当您运行 jQuery 代码时，尚未创建相关元素。

您必须在[`whenReady`](http://leafletjs.com/reference.html#map-whenready)回调中运行您的 jQuery 代码。

* * *

如果你只是*想听*点击事件，你可以使用事件委托：

```
$(document).on('click', 'The CSS selector', function () {
    // Your code here...
}); 
```

这会起作用，但出于性能原因，您应该将事件侦听器绑定到您正在调用 LeafletJS 的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:05:53.207

.live（事件，处理程序（事件对象））

不推荐使用的版本：1.7，已删除：1.9

使用“.on()”更正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:52:45.700

要在 JS 生成的 html 中正确使用 click() 函数，您需要使用 live() 函数[http://api.jquery.com/live/](http://api.jquery.com/live/)：

```
$('.element').live('click', function(){
  // your code here
}); 
```

# r - 错误：内存耗尽（达到限制？）

> ID：14550203
> 
> 赞同：5
> 
> 时间：2013-01-27T17:44:54.483
> 
> 标签：r

有谁知道如何解决这个错误？我在 macbook pro 中使用 R。我正在使用一个名为 rsgcc 的集群包

```
thm <- gcc.tsheatmap(b[2:5264,], cpus = 1, cormethod = "GCC", distancemethod = "Raw", clustermethod = "complete")
Dimension information for clustered GE matrix: 5263 9

R(18015,0xac5c3a28) malloc: *** mmap(size=16777216) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
R(18015,0xac5c3a28) malloc: *** mmap(size=16777216) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
R(18015,0xac5c3a28) malloc: *** mmap(size=16777216) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
Error: memory exhausted (limit reached?) 
```

我的会话信息是

```
> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] C/UTF-8/C/C/C/C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T18:11:21.337

就像@arun 评论的那样，您需要开始使用 64 位 R 才能充分发挥您拥有的 16 GB RAM 的潜力。现在，R 可以使用大约 3 GB...

# file - 如何在java中检查真实文件类型？

> ID：14550206
> 
> 赞同：4
> 
> 时间：2013-01-27T17:45:14.857
> 
> 标签：file

我将创建一个`sample.txt`文件。然后我将扩展名更改`sample.txt`为 `sample.tar`

我如何知道示例文件的真实类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T17:48:53.493

一个文件只包含字节。您认为这些字节的含义完全取决于您。任何认为文件具有真实类型的想法都是一种错觉。例如，您可以将其命名为 sample.txt，但它实际上是一个 TAR 文件。

有一些工具可以猜测文件格式可能是什么。然而，这只是一个猜测。文件没有“真实”文件类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T17:47:46.367

您可以使用诸如[Java Mime Magic 之](http://sourceforge.net/projects/jmimemagic/)类的库来检查文件的假定 MIME 类型是否与其内容匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:09:51.837

```
import java.net.FileNameMap;
import java.net.URLConnection;

public class FileUtils {

public static String getMimeType(String fileUrl) throws java.io.IOException {
    FileNameMap fileNameMap = URLConnection.getFileNameMap();
    String type = fileNameMap.getContentTypeFor(fileUrl);

    return type;
}

public static void main(String args[]) throws Exception {
    System.out.println(FileUtils.getMimeType("fileName.extension"));
     //for a.txt
    // output : text/plain
}
} 
```

如果文件不是 rar 或压缩文件，这可以正常工作。

请参阅此链接。[从文件中获取 Mime 类型。](http://www.rgagnon.com/javadetails/java-0487.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:23:44.127

如果您只想知道文件是否为 tar 文件，您可以读取字节 257、258、259、260、261。如果它们是 ASCII 'ustar'，则它是 tar 存档。

# playframework - Play framework 1.2.5 crud search 不能在整数字段上搜索

> ID：14550207
> 
> 赞同：2
> 
> 时间：2013-01-27T17:45:14.743
> 
> 标签：playframework, crud

我在 Play 框架 1.2.5 中使用 crud 模块。我学会了如何自定义空白、显示视图，但是我在 crud 搜索方面遇到了问题。当我在搜索字段中输入字符串时，我得到的结果包括该字符串，但是当我输入一个整数（例如，5）时，它什么也不返回。有趣的是，如果某个字符串字段包含 5，则返回，但整数字段不是？

# android - 如何更改 tabhost 的文本大小？

> ID：14550208
> 
> 赞同：0
> 
> 时间：2013-01-27T17:45:16.440
> 
> 标签：android, android-tabhost, text-size

我想更改 tabhost 中字符串的文本大小。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T17:58:23.210

**1.通过Style-XML给Activity添加主题**

```
<style name="CustomTheme" >
<item name="android:textSize">18sp</item>
<item name="android:textStyle">bold</item>
</style> 
```

然后在`androidManifest.xml`你指定上面的主题为你的`TabActivity`或`Activity`包含你的`TabWidget`：

```
<activity android:name="MyTabActivity" android:theme="@style/CustomTheme"> 
```

**2\. TabHost通过代码的样式指示器**

```
TextView textTab = new TextView(this);
textTab.setText("TAB-INDICATOR");
textTab.setTextSize(18);
textTab.setGravity(Gravity.CENTER_HORIZONTAL | Gravity.CENTER_VERTICAL);
spec = tabHost.newTabSpec("TAB1").setIndicator(textTab).setContent(new Intent(this, Your.class).addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP));
tabHost.addTab(spec); 
```

# sencha-touch-2 - Sencha Touch 2 - 将模型添加到仅存储一次

> ID：14550209
> 
> 赞同：0
> 
> 时间：2013-01-27T17:45:19.837
> 
> 标签：sencha-touch-2

我有一个商店，它通过代理服务器获取它的价值。但我想硬编码一个国家（空国家），应该在 sencha 代码中附加到商店周围

我尝试了一个天真的

```
data: [
    {
        id: '999',
        countryCode: 'NullCountry',
        countryName: 'Null (+nothing)',
        countryPhoneCode: null
    }
] 
```

但它不起作用（这只是一种尝试）。我怎样才能做到这一点？

```
Ext.define('Sencha.store.CountryStore', {
    extend: 'Ext.data.Store',

    config: {
        id : 'CountryStore',
        model:'Sencha.model.user.Country',

        proxy: {
            type: 'rest',
            url : '/countries',
            headers: {
                'Content-Type': 'application/json',
                'Accept' : 'application/json'
            },
            reader: {
                type: 'json',
                rootProperty: 'countries'
            }
        },
        autoLoad: true,
        data: [
            {
                id: '999',
                countryCode: 'NullCountry',
                countryName: 'Null (+nothing)',
                countryPhoneCode: null
            }
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:42:44.817

您可以收听商店[加载](http://docs.sencha.com/touch/2-1/#!/api/Ext.data.Store-event-load)事件，然后添加新记录：

```
Ext.define('Sencha.store.CountryStore', {
    extend: 'Ext.data.Store',

    config: {
        id : 'CountryStore',
        model:'Sencha.model.user.Country',

        proxy: {
            type: 'rest',
            url : '/countries',
            headers: {
                'Content-Type': 'application/json',
                'Accept' : 'application/json'
            },
            reader: {
                type: 'json',
                rootProperty: 'countries'
            }
        },
        autoLoad: true,

        listeners: {
            load: function(me) {
                me.add({
                    id: '999',
                    countryCode: 'NullCountry',
                    countryName: 'Null (+nothing)',
                    countryPhoneCode: null
                });
            }
        }
    }
}); 
```

# ios - 告诉用户有关 ios App 更新的最佳方式是什么？

> ID：14550210
> 
> 赞同：-3
> 
> 时间：2013-01-27T17:45:21.307
> 
> 标签：ios, web-services

如果我正在制作客户端/服务器 ios 应用程序，并且我在 App Store + Internet 上的其他商店发布了该应用程序的新版本。那么，如何设法告诉用户更新应用程序？？？我对此进行了搜索......我有两种方法 1\. 让网络服务返回当前版本的应用程序并通知用户更新它。2.在itunes上查看app的URL，返回信息，我们从中获取版本（对此存疑）因为如果有这样的URL，我们必须在上传前将URL地址写在代码中......请对此进行指导。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:14:21.263

不要重新发明轮子！您正在寻找的是[nicklockwood 的 iVersion](https://github.com/nicklockwood/iVersion)。

# php - Codeigniter - 会话到期和“记住我”功能

> ID：14550213
> 
> 赞同：11
> 
> 时间：2013-01-27T17:45:28.197
> 
> 标签：php, codeigniter

我正在 Codeigniter 中构建“记住我”功能，通常我看到库/项目使用令牌在用户上设置 cookie，此令牌保存在数据库中，并在每次用户访问网站时进行比较。

在 Codeigniter 中，我们可以设置会话过期时间，这导致我尝试不同的方法，这就是我所做的：

*   我将配置中的 session_expiration 设置为 0（无限会话）
*   如果用户未选中“记住我”，我会在会话中设置 2 小时时间，并在窗口关闭时销毁会话。

所以我的登录代码如下所示：

```
if (!$this->input->post('remember_me')) {
                $this->session->sess_expiration = 7200;
                $this->session->sess_expire_on_close = TRUE;
            }

            $this->session->set_userdata($session_data); 
```

还有我的配置文件：

```
$config['sess_expiration']      = 0;
$config['sess_expire_on_close'] = FALSE; 
```

我没有看到人们在项目中使用这个解决方案，我已经对此进行了测试，但它似乎工作正常。

所以，对于我的问题，你会说这是一种安全的做法吗？我应该知道任何安全隐患吗？对此解决方案与 cookie+数据库令牌的任何输入都会很棒。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-08-02T17:24:26.130

我为这个问题找到的最简单的解决方案是通过这种方式修改 Codeigniter 创建的 cookie：

```
 $this->session->set_userdata('user', $user); // a cookie has been created
        if($this->input->post('remember_me'))
        {
            $this->load->helper('cookie');
            $cookie = $this->input->cookie('ci_session'); // we get the cookie
            $this->input->set_cookie('ci_session', $cookie, '35580000'); // and add one year to it's expiration
        } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-18T06:54:45.193

这也可以通过编辑/扩展系统会话库来完成。

**第一：**在配置文件中设置常规会话过期时间。 **第二：**在用户登录功能中添加记住我检查-

```
 if($remember)
    {
        $data['new_expiration'] = 60*60*24*30;//30 days
        $this->session->sess_expiration = $data['new_expiration'];
    }
    $this->session->set_userdata($data); 
```

**第三：**编辑系统Session库【我不确定是否扩展Session会起作用】在`sess_read()`方法中进入这一行

```
if (($session['last_activity'] + $this->sess_expiration) < $this->now) 
```

在该行之前添加以下代码

```
if(isset($session['new_expiration'])){
   $this->sess_expiration = $session['new_expiration'];
} 
```

这对我来说很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T11:23:59.600

我不能说这是不对的，但我可以告诉你我的做法：

首先，我将会话设置为在浏览器关闭时到期，默认正常运行时间为 7200。

然后：

1.  登录设置会话用户数据

2.  “记住我”设置了一个单独的cookie（我存储了一个包含用户电子邮件+密码+id的加密哈希，即：md5（pass+email+id））

每次用户加载页面时，我都会控制是否存在记住我的 cookie，如果存在，我会创建用户会话。

我唯一知道的是该会话使用加密密钥，恶意攻击者将需要时间来解密，因此会话密钥越少，攻击者解密当前密钥的时间就越少。

我总是避免会话不会过期，所以记住我，我认为总是对安全性不利，但无论如何用户是否选择是否使用该功能;)

# php - 检查mysql中的多个电子邮件字段

> ID：14550215
> 
> 赞同：0
> 
> 时间：2013-01-27T17:45:40.277
> 
> 标签：php, html, mysql

我有一个包含多个“电子邮件”输入字段的表单。每个都在 mysql 中检查以检查其是否在数据库中。如果其中一个字段中有不正确的电子邮件，则我现在所拥有的工作是正确的消息，如果所有字段都是空的，它也会回显正确的消息。如果最后一个输入字段是正确的电子邮件，它也可以工作。一个问题是，如果一个或多个不是最后一个字段的字段中有正确的电子邮件地址，并且没有其他不正确的电子邮件，它会回显“未填写”。我可以通过在里面添加一个 break 来纠正这个问题，`{$x = "1"}`但是这会弄乱 mysql 检查，因为它需要继续直到/如果条件不满足。有什么我可以做的吗？

```
foreach($_POST as $value)
  {
     if(empty($value))
      {
       $x = "0";
      } else
     if(!empty($value))
      {
        $usercheck =  "SELECT email FROM users WHERE email = '$value'";
        $usercheck = $db->query($usercheck);

     if($usercheck->num_rows > 0)
      {
        $x="1";
      } else
        {
          $x="2"; break;
        }
      }
  } 

if($x == "0") {echo "none filled in";}
if($x == "1") {echo "all good";}
if($x == "2") {echo $value." is not a user";} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:58:07.243

```
$i=1;  
foreach($_POST as $value)
      {
         if(empty($value))
          {
           $x = "0";
          } else
         if(!empty($value))
          {
            $usercheck =  "SELECT email FROM users WHERE email = '$value'";
            $usercheck = $db->query($usercheck);

         if($usercheck->num_rows > 0)
          {
            $x="1";
          } else
            {
              $x="2";
            }  
          }
       $field[$i]=$x;
       $i++;
      } 
```

现在，您在`$field`数组中的第 1、第 2 和第 3 位置拥有所有三个字段结果。

# google-maps - 谷歌地图 api v3 教程错误。我究竟做错了什么？？

> ID：14550216
> 
> 赞同：1
> 
> 时间：2013-01-27T17:45:49.403
> 
> 标签：google-maps, null

我对编码很陌生，所以我正在尝试使用 api v3 重新创建谷歌地图的教程。当我运行本教程时，我收到一个空点错误，这似乎是（来自日志猫）由于 setupWebView(); 行

我在 .xml 中定义了 webview 并赋予了适当的权限。这是 WebMapActivity 类 -

```
public class WebMapActivity extends Activity implements LocationListener {

private static final String MAP_URL = "http://gmaps-samples.googlecode.com/svn/trunk/articles-    android-webmap/simple-android-map.html";
private WebView webView;
private Location mostRecentLocation;

@Override
/** Called when the activity is first created. */
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
getLocation();
setupWebView();
this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
}
/** Sets up the WebView object and loads the URL of the page **/
private void setupWebView(){
final String centerURL = "javascript:centerAt(" +
mostRecentLocation.getLatitude() + "," +
mostRecentLocation.getLongitude()+ ")";
webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(true);
//Wait for the page to load then send the location information
webView.setWebViewClient(new WebViewClient());
webView.loadUrl(MAP_URL);
}

/** The Location Manager manages location providers. This code searches
    for the best provider of data (GPS, WiFi/cell phone tower lookup,
    some other mechanism) and finds the last known location.
 **/
private void getLocation() {      
LocationManager locationManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
Criteria criteria = new Criteria();
criteria.setAccuracy(Criteria.ACCURACY_FINE);
String provider = locationManager.getBestProvider(criteria,true);

//In order to make sure the device is getting location, request updates.        
locationManager.requestLocationUpdates(provider, 1, 0, this);
mostRecentLocation = locationManager.getLastKnownLocation(provider);
}

/** Sets the mostRecentLocation object to the current location of the device **/
@Override
public void onLocationChanged(Location location) {
mostRecentLocation = location;
}

/** The following methods are only necessary because WebMapActivity implements   
LocationListener    
**/ 
@Override
public void onProviderDisabled(String provider) {
}

@Override
public void onProviderEnabled(String provider) {
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
}

} 
```

这是 .xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<WebView android:id="@+id/webview"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"/>
</LinearLayout> 
```

我希望，当然，你能帮上忙。如果需要更多信息，请告诉我...

谢谢，杰米

# javascript - 三个js贴花

> ID：14550218
> 
> 赞同：1
> 
> 时间：2013-01-27T17:46:07.937
> 
> 标签：javascript, 3d, three.js, decal

如何在三个 js 中为 3d OBJ 模型添加贴花？

```
var loader = new THREE.OBJMTLLoader();
            loader.addEventListener( 'load', function ( event ) {
                object = event.content;
                scene.add(object);
            });

            loader.load('test.obj', 'test.mtl'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T20:21:13.913

也许你必须给出立场。像我这样做。var loader = new THREE.OBJMTLLoader(); loader.addEventListener('load', function (event) { casa = event.content; casa.scale.x = casa.scale.y = casa.scale.z = 14.5; casa.position.y=-40;

```
 casa.updateMatrix();
    scene.add(casa);
});
loader.load(
        'entidades/entidad_1/obj_model/casa.obj',
        'entidades/entidad_1/obj_model/casa.mtl'); 
```

# backbone.js - 仅当按钮位于特定位置时单击事件才有效

> ID：14550219
> 
> 赞同：0
> 
> 时间：2013-01-27T17:46:17.610
> 
> 标签：backbone.js

我有一个主干应用程序，它为用户提供了通过单击按钮来显示地图的选项。在 CharactersView 中，设置了 'showMap' 事件（通过单击 #map_button 触发）以及相应的 showMap 函数，以便在事件触发后显示地图。CharactersView 还渲染 character_template，character_template 包含 #map_button 和具有类“map”的实际地图代码。如果 #map_button 与被渲染的地图位于同一模板（chracters_template）中，则一切正常来自 CharactersView。但是，如果我将#map_button 移到 character_template 之外（例如，移到另一个模板中或直接移到页面正文中），则不再触发 CharactersView 中的 showMap 事件，并且地图不再显示在 character_template 中。请注意，在尝试单击#map_button 之前，我正在等待字符模板呈现到页面，但它仍然无法正常工作。

从上面的描述和下面的代码中，你能告诉我这里可能是什么问题以及我如何解决它。

代码

在 CharactersView 中设置事件绑定，以便在单击按钮时显示地图

```
 events: {

  'click #map_button' : 'showMap'

},

showMap: function(){

      $(".map").toggle();
    } 
```

由字符视图呈现的字符模板。显示的具有“地图”类的实际地图位于由字符视图呈现的同一模板中。

```
<script id="character_template" type="text/x-handlebars">
    <input class='action_button' id='map_button' type='button' value='Show Map' />

   <%= image_tag "http://maps.google.com/maps/api/staticmap?size=300x200&sensor=false&zoom=12&markers={{ latitude }}%2C{{ longitude }}", :class => "map" %>
    </script> 
```

如果我从 character_template 中删除按钮并将其放入另一个模板中，则 CharactersView 中的 click #map_button 事件不再起作用。如果我只是将按钮直接放在html的正文中，结果也是一样的。

...省略了其他代码...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:32:24.923

当您使用事件哈希在视图中设置事件时，Backbone 最终会使用 jQuery 来监听事件。在 Backbone.delegateEvents 中，您可以看到以下代码：

```
this.$el.on(eventName, selector, method); 
```

使用`this.$el.on()`（其中“this”是您的视图）仅监听该视图的 DOM 元素中的事件（[$el](http://backbonejs.org/#View-%24el)是一个缓存的 jQuery 对象）。

因此，如果您将按钮移动到另一个视图，您还需要将事件侦听器添加到该视图：

```
events: {

  'click #map_button' : 'showMap'

}, 
```

基本上，使用视图事件哈希是说，“仅在此视图的 DOM 元素内收听此事件。”

# perl - 在 Windows 上制作 perl 可执行文件

> ID：14550220
> 
> 赞同：0
> 
> 时间：2013-01-27T17:46:35.503
> 
> 标签：perl, windows-7, executable

1.  嗨专家，
2.  我想从 dir **D:\script.pl**中的简单 perl 脚本制作一个可执行文件（只打印 hello world）
3.  我想使用**PAR::pp**来做到这一点。我已经使用 cpanm PAR 安装了它。
4.  有人可以**显示实际步骤**。当我在 cmd 提示符和 padre 中尝试 pp -o name.exe D:\script.pl 时，但没有成功。错误：**pp 未被识别为内部或外部命令**。. .
5.  还有一些问题，我想讨论，但想先弄清楚上面的一个。
6.  系统信息：Windows 7，32 位，PAR 1.007，Strawberry perl 5 v14 sub ver2 v5.14.2。教士IDE。
7.  **PAR存档是否意味着设置文件？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T17:53:54.920

[`pp`](https://metacpan.org/module/pp)实际上`PAR`不再附带，您必须安装[`PAR::Packer`](https://metacpan.org/module/PAR%3a%3aPacker)发行版才能获得它。

# php - Kohana 静态 ORM 方法的执行时间慢

> ID：14550222
> 
> 赞同：0
> 
> 时间：2013-01-27T17:46:50.430
> 
> 标签：php, mysql, kohana-3, kohana-orm, kohana-3.3

我有一个 Kohana 3.3 应用程序，在 WAMP (PHP 5.4.3) 上运行，它使用静态函数来获取最近文章的列表。当我加载页面时，应用程序执行时间（通过 Kohana Profiler）是**6.7 seconds**。当我在不调用 get_recent 方法（传递一个空数组）的情况下加载同一页面时，Application Execution time 为**0.3 seconds**。

这表明此静态方法引起了问题。我已经运行了原始 MySQL，它需要**1.4 秒**。

这是方法内部的代码：

```
$articles = self::factory('user_articles')
                ->join('articles', 'INNER')->on('user_articles.article_id', '=', 'articles.id')
                ->order_by('user_articles.created_at', 'ASC')
                ->limit(10)
                ->group_by('articles.id')->find_all(); 
```

上`user_articles.article_id`和上都有一个索引`articles.id`。我还能做些什么来优化查询或加快执行时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-27T20:05:02.950

尝试获取最后一个查询`echo Database::instance()->last_query`并尝试 MySQL `EXPLAIN`。它将向您显示使用了哪些索引。

PS：你有多少行`articles`和`users`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T07:41:55.350

您可以添加索引`created_at`- 检查原始 SQL 是否有帮助。
最好不要使用 ORM 并尝试运行 DB Builder 查询。

# jquery - jquery刷新div再次显示div

> ID：14550228
> 
> 赞同：0
> 
> 时间：2013-01-27T17:47:28.590
> 
> 标签：jquery, html, refresh

我有一个显示 mysql 查询结果的 div。有时数据库会添加或编辑条目，因此我希望能够通过单击按钮来刷新 div。它有点起作用，但有点不起作用。这是我的代码

```
<a id="refresh" href="#">click</a>

<script>
    $(function() {
      $("#refresh").click(function(evt) {
         $("#container").load("index.php")
         evt.preventDefault();
      })
    })
</script> 
```

第一次单击该链接时，它会在原始容器 div 中显示整个 index.php。之后的每次点击都会像我想要的那样刷新新创建的 index.php，唯一的问题是它显示了双 index.php。有人可以指出我正在犯的可能明显且希望简单的错误吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:56:19.843

在将新数据加载到其中之前，您是否尝试过删除 div 中已有的内容？

像这样的东西

```
<script>
    $(function() {
      $("#refresh").click(function(evt) {
         $("#container").html("");
         $("#container").load("index.php")
         evt.preventDefault();
      })
    })
</script> 
```

# image - 从粘贴板中剥离图像

> ID：14550231
> 
> 赞同：2
> 
> 时间：2013-01-27T17:47:43.147
> 
> 标签：image, uitextview, copy-paste, nsattributedstring, uipasteboard

有人可以指导我如何从粘贴板上的属性文本中删除图像吗？

例子

我有一个支持 NSAttributedString 的 UITextView。如果我允许用​​户从粘贴板上粘贴包含图像的内容（比如从 Safari 应用程序的网页复制的图片和一些文本），当我尝试保存它时，它会使我的应用程序崩溃：

```
*** Assertion failure in -[NSHTMLReader _addAttachmentForElement:URL:needsParagraph:usePlaceholder:], /SourceCache/UIFoundation_Sim/UIFoundation-78/UIFoundation/TextSystem/NSHTMLReader.m:1478
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Unable to find missing_image.tiff!' 
```

仅当图像是源副本的一部分时才会发生这种情况。为什么它指的是 tiff 我不知道，因为我一直在测试的源图像是 jpg 和 png。

如[相关帖子中所述，目标略有不同](https://stackoverflow.com/questions/13301058/pasting-image-into-uitextview-causes-crash)，我避免崩溃的解决方法是将粘贴板强制为常规字符串：

```
- (void)paste:(id)sender
{
    UIPasteboard *pasteBoard = [UIPasteboard generalPasteboard];
    NSString *string = pasteBoard.string;
    [self insertText:string];
} 
```

这确实可以防止崩溃，但也可以防止用户粘贴任何格式化的文本。说出可能来自邮件应用程序的粗体或斜体。

所以我能说得最好，我需要从粘贴板上删除任何图像，以便保留文本格式。谢谢你的帮助。

# json - JSON Schema away 以指定具有某些必填字段的“任何”类型的架构

> ID：14550235
> 
> 赞同：17
> 
> 时间：2013-01-27T17:48:02.120
> 
> 标签：json, jsonschema

假设我有以下 JSON 架构

```
{
 "name":"Product",
 "type":"object",
 "properties":{
   "id":{
     "type":"number",
     "required":true
   },
   "name":{
     "description":"Name of the product",
     "required":true
   },
   "price":{
     "required":true,
     "type": "number",
     "minimum":0,
     "required":true
   },
   "tags":{
     "type":"array",
     "items":{
       "type":"any"
     }
   }
 }
} 
```

但是，我希望标签不是一个数组，而是根模式的一部分。所以你可以指定任何属性，但我特别注意“id”、“name”和“price” 以下哪个是正确的做法，哪些是完全错误的？

```
{
 "name":"Product",
 "type":"object",
 "properties":{
   "id":{
     "type":"number",
     "required":true
   },
   "name":{
     "description":"Name of the product",
     "required":true
   },
   "price":{
     "required":true,
     "type": "number",
     "minimum":0,
     "required":true
   }
 },
 "additionalProperties": {
     "type":"any"
 }
}

{
 "name":"Product",
 "type":"object",
 "properties":{
   "id":{
     "type":"number",
     "required":true
   },
   "name":{
     "description":"Name of the product",
     "required":true
   },
   "price":{
     "required":true,
     "type": "number",
     "minimum":0,
     "required":true
   }
 },
 "extends": {
     "type":"any"
 }
}

{
 "name":"Product",
 "type":["object","any"],
 "properties":{
   "id":{
     "type":"number",
     "required":true
   },
   "name":{
     "description":"Name of the product",
     "required":true
   },
   "price":{
     "required":true,
     "type": "number",
     "minimum":0,
     "required":true
   }
 }
} 
```

我可以想出更多（例如“任何”和“对象”的反转角色），但它们都是这三个示例的派生。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-28T05:24:56.003

[免责声明：这里是下一个 JSON Schema 验证规范的作者]

好的，不清楚你问什么，见下文，但你的一个例子显然没有做你想要的，这是你写的：

```
{ "type": [ "object", "any" ] } 
```

这相当于一个空模式，因此会验证每个实例。

我阅读您的问题的一种方式是您希望您的 JSON 数据是标签数组或至少具有名为`id`,`name`和的成员的对象`price`。由于您似乎使用的是 v3 草案，因此您只有一个解决方案：

```
{
    "type": [
        {
            "description": "schema for tags array here",
        },
        {
            "description": "schema for the base object here"
        }
    ]
} 
```

这种构造意味着实例必须遵循至少一个内部模式`type`（您也可以将其与原始类型混合）。

**但是**：目前的草案现在是 v4，你现在应该写：

```
{
    "anyOf": [
        {
            "description": "schema for tags array here",
        },
        {
            "description": "schema for the base object here"
        }
    ]
} 
```

请注意，并非所有实现都支持 v4 草案或上述构造`type`。事实上，很少有人这样做。请参阅下面的链接以获取支持两者的在线模式验证器的链接。

我阅读您的问题的另一种方式是，您希望允许 , 以外的属性`id`，`name`并`price`成为他们喜欢的任何东西。这很简单。只是不要为`tags`in定义模式`properties`：

```
{
    "type": "object",
    "required": [ "id", "name", "price" ]
    "properties": {
        "id": {
            "type": "number"
        },
        "name": {
            "description": "Name of the product"
        },
        "price": {
            "type": "number",
            "minimum": 0
        }
    }
} 
```

由于您没有指定`additionalProperties`as being `false`，因此对象实例可以具有任意数量的附加成员，并且这些成员可以是任何东西。

链接到可以测试您的模式的在线验证器：[这里](http://json-schema-validator.herokuapp.com)

# ember.js - 使用带有嵌套 CollectionViews 的 Ember JS 创建键盘

> ID：14550236
> 
> 赞同：0
> 
> 时间：2013-01-27T17:48:07.793
> 
> 标签：ember.js, uikeyboard, collectionview

编辑：已解决，是意外创建而不是扩展 ember 视图。请参阅下面的答案。

我正在为浏览器中没有本机触摸屏键盘的触摸屏设备创建键盘（HP 触摸屏上的 Google Chrome，但如果我错了，请纠正我。我愿意接受更简单的解决方案。）

我想将键盘分成单独的行以使样式更容易。

```
keyboardView: Ember.CollectionView.create({
    elementId: 'search-keyboard',
    content: [
        [ 'q','w','e','r','t','y','u','i','o','p' ],
        [ 'a','s','d','f','g','h','j','k','l' ],
        [ 'z','x','c','v','b','n','m' ],
        [ ' ' ]
    ],
    itemViewClass: Ember.CollectionView.extend({
        tagName: 'ul',
        classNames: [ 'keyboard-row' ],
        itemViewClass: Ember.View.create({
            template: Ember.Handlebars.compile( '{{view.content}}' )
        })
    })
}) 
```

当然，我收到了这个错误：

```
Uncaught Error: assertion failed: itemViewClass must be a subclass of Ember.View, not <Ember.View:ember186> 
```

我可以将父视图用作 ContainerView 的解决方案，但这意味着为子 collectionViews 复制 classNames、tagNames 等

有没有办法在不重复代码的情况下创建这个键盘和键盘行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:05:40.520

哎呀，正在创建余烬视图而不是扩展......以下作品：

```
keyboardView: Ember.CollectionView.create({
    elementId: 'search-keyboard',
    content: [
        [ 'q','w','e','r','t','y','u','i','o','p' ],
        [ 'a','s','d','f','g','h','j','k','l' ],
        [ 'z','x','c','v','b','n','m' ],
        [ ' ' ]
    ],
    itemViewClass: Ember.CollectionView.extend({
        tagName: 'ul',
        classNames: [ 'keyboard-row' ],
        itemViewClass: Ember.View.extend({   // extend! don't create!
            template: Ember.Handlebars.compile( '{{view.content}}' )
        })
    })
}) 
```

# ruby-on-rails - Rails 3：respond_with 和 Completed 406 Not Acceptable

> ID：14550238
> 
> 赞同：4
> 
> 时间：2013-01-27T17:48:10.370
> 
> 标签：ruby-on-rails, api, respond-with

我正在为 Rails 应用程序构建 API。我实际上有两个应用程序：一个服务器（API）和一个客户端（与 API 交互）。我正在尝试通过 API 调用进行发布请求以创建模型对象。当对象有效时，会创建模型对象，但出现`Completed 406 Not Acceptable`错误。服务器默默地抛出错误，因此返回一个响应对象。足够的写作/谈话，这里有一些代码：

### 服务器 API 控制器

```
class Api::V1::RequestsController < Api::V1::BaseController
  respond_to :json

  def create
    respond_with Request.create!(params[:request])
  end
end 
```

### 服务器路由

```
namespace :api do
  scope module: :v1 do
    resources :requests, only: [:index, :create]
  end
end 
```

### 客户端控制器

```
class RequestsController < ApplicationController
  def new
    @request = Request.new
  end

  def create
    @request = Request.new(params[:request])
    if response = @request.save
      flash[:success] = "Request successfully sent"

      p response

      redirect_to request_url(@request)
    else
      render :new
    end
  end
end 
```

### 客户模型

```
class Request < ActiveRecord::Base
  include HTTParty

  if Rails.env.development?
    base_uri "http://localhost:3000/"
  end

  def save
    if self.valid?
      self.class.post("/api/requests", { body: {
        request: {
          artist_name: self.artist_name,
          email: self.email,
          phone_number: self.phone_number,
          country: self.country,
          city: self.city
        }
      } })
    else
      false
    end
  end
end 
```

### 服务器日志

```
Started POST "/api/requests" for 127.0.0.1 at 2013-01-27 17:32:35 +0000
Processing by Api::V1::RequestsController#create as HTML
  Parameters: {"request"=>{"artist_name"=>"Knife Party", "email"=>"admin@example.com", "phone_number"=>"07949967627", "country"=>"France", "city"=>"Paris"}}
   (0.4ms)  BEGIN
  Request Exists (0.4ms)  SELECT 1 AS one FROM "requests" WHERE LOWER("requests"."email") = LOWER('admin@example.com') LIMIT 1
  SQL (1.0ms)  INSERT INTO "requests" ("artist_name", "city", "country", "created_at", "email", "phone_number", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["artist_name", "Knife Party"], ["city", "Paris"], ["country", "France"], ["created_at", Sun, 27 Jan 2013 17:32:35 UTC +00:00], ["email", "admin@example.com"], ["phone_number", "07949967627"], ["updated_at", Sun, 27 Jan 2013 17:32:35 UTC +00:00]]
   (0.3ms)  COMMIT
Completed 406 Not Acceptable in 27ms (ActiveRecord: 2.1ms) 
```

### 客户端日志（带有来自服务器的响应对象）

```
#<HTTParty::Response:0x7f836dd944f8 parsed_response="         <!-- Footnotes Style -->\n        <style type=\"text/css\">\n          #footnotes_debug {font-size: 11px; font-weight: normal; margin: 2em 0 1em 0; text-align: center; color: #444; line-height: 16px;}\n          #footnotes_debug th, #footnotes_debug td {color: #444; line-height: 18px;}\n          #footnotes_debug a {color: #9b1b1b; font-weight: inherit; text-decoration: none; line-height: 18px;}\n          #footnotes_debug table {text-align: center;}\n          #footnotes_debug table td {padding: 0 5px;}\n          #footnotes_debug tbody {text-align: left;}\n          #footnotes_debug .name_values td {vertical-align: top;}\n          #footnotes_debug legend {background-color: #fff;}\n          #footnotes_debug fieldset {text-align: left; border: 1px dashed #aaa; padding: 0.5em 1em 1em 1em; margin: 1em 2em; color: #444; background-color: #FFF;}\n          /* Aditional Stylesheets */\n          \n        </style>\n        <!-- End Footnotes Style -->\n        <!-- Footnotes -->\n        <div style=\"clear:both\"></div>\n        <div id=\"footnotes_debug\">\n          Edit: <a href=\"txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;line=8&amp;column=3\" onclick=\"\">Controller</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('partials_debug_info');return false;\">Partials (0)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('stylesheets_debug_info');return false;\">Stylesheets (0)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('javascripts_debug_info');return false;\">Javascripts (0)</a><br />Show: <a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('session_debug_info');return false;\">Session (0)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('cookies_debug_info');return false;\">Cookies (0)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('params_debug_info');return false;\">Params (3)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('filters_debug_info');return false;\">Filters</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('routes_debug_info');return false;\">Routes</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('env_debug_info');return false;\">Env</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('queries_debug_info');return false;\">        <span style=\"background-color:#ffffff\">Queries (4)</span>\n        <span style=\"background-color:#ffffff\">DB (2.011ms)</span>\n</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('log_debug_info');return false;\">Log (0)</a> | \n<a href=\"#\" onclick=\"Footnotes.hideAllAndToggle('general_debug_info');return false;\">General Debug</a><br />\n                      <fieldset id=\"partials_debug_info\" style=\"display: none\">\n              <legend>Partials</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"stylesheets_debug_info\" style=\"display: none\">\n              <legend>Stylesheets</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"javascripts_debug_info\" style=\"display: none\">\n              <legend>Javascripts</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"session_debug_info\" style=\"display: none\">\n              <legend>Session</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"cookies_debug_info\" style=\"display: none\">\n              <legend>Cookies</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"params_debug_info\" style=\"display: none\">\n              <legend>Params</legend>\n              <div>          <table class=\"name_value\" summary=\"Debug information for Params (3)\" >\n            <thead><tr><th>Name</th><th>Value</th></tr></thead>\n            <tbody><tr><td>:request</td><td>{\"artist_name\"=&gt;\"Knife Party\", \"email\"=&gt;\"person@example.com\", \"phone_number\"=&gt;\"07949967627\", \"country\"=&gt;\"France\", \"city\"=&gt;\"Paris\"}</td></tr><tr><td>:action</td><td>\"create\"</td></tr><tr><td>:controller</td><td>\"api/v1/requests\"</td></tr></tbody>\n          </table>\n</div>\n            </fieldset>\n            <fieldset id=\"filters_debug_info\" style=\"display: none\">\n              <legend>Filter chain for Api::V1::RequestsController</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"routes_debug_info\" style=\"display: none\">\n              <legend>Routes for Api::V1::RequestsController</legend>\n              <div>          <table summary=\"Debug information for Routes\" >\n            <thead><tr><th>Path</th><th>Name</th><th>Options</th><th>Requirements</th></tr></thead>\n            <tbody><tr><td>api_requests</td><td>request_method</td><td>{:action=>\"index\"}</td><td>{:request_method=>/^GET$/}</td></tr><tr><td></td><td>request_method</td><td>{:action=>\"create\"}</td><td>{:request_method=>/^POST$/}</td></tr></tbody>\n          </table>\n</div>\n            </fieldset>\n            <fieldset id=\"env_debug_info\" style=\"display: none\">\n              <legend>Env</legend>\n              <div>          <table >\n            <thead><tr><th>Key</th><th>Value</th></tr></thead>\n            <tbody><tr><td>CONTENT_LENGTH</td><td>148</td></tr><tr><td>CONTENT_TYPE</td><td>application/x-www-form-urlencoded</td></tr><tr><td>GATEWAY_INTERFACE</td><td>CGI/1.2</td></tr><tr><td>HTTP_CONNECTION</td><td>close</td></tr><tr><td>HTTP_HOST</td><td>localhost:3000</td></tr><tr><td>HTTP_VERSION</td><td>HTTP/1.1</td></tr><tr><td>ORIGINAL_FULLPATH</td><td>/api/requests</td></tr><tr><td>PATH_INFO</td><td>/api/requests</td></tr><tr><td>QUERY_STRING</td><td></td></tr><tr><td>REMOTE_ADDR</td><td>127.0.0.1</td></tr><tr><td>REQUEST_METHOD</td><td>POST</td></tr><tr><td>REQUEST_PATH</td><td>/api/requests</td></tr><tr><td>REQUEST_URI</td><td>/api/requests</td></tr><tr><td>SCRIPT_NAME</td><td></td></tr><tr><td>SERVER_NAME</td><td>localhost</td></tr><tr><td>SERVER_PORT</td><td>3000</td></tr><tr><td>SERVER_PROTOCOL</td><td>HTTP/1.1</td></tr><tr><td>SERVER_SOFTWARE</td><td>thin 1.5.0 codename Knife</td></tr><tr><td>action_controller.instance</td><td>#&lt;Api::V1::RequestsController:0x007f84c7688618&gt;</td></tr><tr><td>action_dispatch.backtrace_cleaner</td><td>#&lt;Rails::BacktraceCleaner:0x007f84c6f8d8e0&gt;</td></tr><tr><td>action_dispatch.cookies</td><td>#&lt;ActionDispatch::Cookies::CookieJar:0x007f84c7686de0&gt;</td></tr><tr><td>action_dispatch.logger</td><td>#&lt;ActiveSupport::TaggedLogging:0x007f84c6e51468&gt;</td></tr><tr><td>action_dispatch.parameter_filter</td><td>[:password]</td></tr><tr><td>action_dispatch.remote_ip</td><td>127.0.0.1</td></tr><tr><td>action_dispatch.request.content_type</td><td>application/x-www-form-urlencoded</td></tr><tr><td>action_dispatch.request.formats</td><td>[text/html]</td></tr><tr><td>action_dispatch.request.parameters</td><td>{\"request\"=&gt;{\"artist_name\"=&gt;\"Knife Party\", \"email\"=&gt;\"person@example.com\", \"phone_number\"=&gt;\"07949967627\", \"country\"=&gt;\"France\", \"city\"=&gt;\"Paris\"}, \"action\"=&gt;\"create\", \"controller\"=&gt;\"api/v1/requests\"}</td></tr><tr><td>action_dispatch.request.path_parameters</td><td>{:action=&gt;\"create\", :controller=&gt;\"api/v1/requests\"}</td></tr><tr><td>action_dispatch.request.query_parameters</td><td>{}</td></tr><tr><td>action_dispatch.request.request_parameters</td><td>{\"request\"=&gt;{\"artist_name\"=&gt;\"Knife Party\", \"email\"=&gt;\"person@example.com\", \"phone_number\"=&gt;\"07949967627\", \"country\"=&gt;\"France\", \"city\"=&gt;\"Paris\"}}</td></tr><tr><td>action_dispatch.request.unsigned_session_cookie</td><td>{}</td></tr><tr><td>action_dispatch.request_id</td><td>ca38df31ac3758fbed0753f83efe7bf8</td></tr><tr><td>action_dispatch.routes</td><td>#&lt;ActionDispatch::Routing::RouteSet:0x007f84c6d6dc18&gt;</td></tr><tr><td>action_dispatch.secret_token</td><td>184d9143ce94750263caefe09316bcff11b84d5f32f51e6628665f2a7fe946828044aec5f5ce72780c6e3ccf85e26a2b50f306990968e1c44634cae42cc90f1d</td></tr><tr><td>action_dispatch.show_detailed_exceptions</td><td>true</td></tr><tr><td>action_dispatch.show_exceptions</td><td>true</td></tr><tr><td>async.callback</td><td>#&lt;Method: Thin::Connection#post_process&gt;</td></tr><tr><td>async.close</td><td>#&lt;EventMachine::DefaultDeferrable:0x007f84c68daf98&gt;</td></tr><tr><td>rack.errors</td><td>#&lt;IO:0x007f84c285a450&gt;</td></tr><tr><td>rack.input</td><td>#&lt;StringIO:0x007f84c7716a08&gt;</td></tr><tr><td>rack.multiprocess</td><td>false</td></tr><tr><td>rack.multithread</td><td>false</td></tr><tr><td>rack.request.cookie_hash</td><td>{}</td></tr><tr><td>rack.request.form_hash</td><td>{\"request\"=&gt;{\"artist_name\"=&gt;\"Knife Party\", \"email\"=&gt;\"person@example.com\", \"phone_number\"=&gt;\"07949967627\", \"country\"=&gt;\"France\", \"city\"=&gt;\"Paris\"}}</td></tr><tr><td>rack.request.form_input</td><td>#&lt;StringIO:0x007f84c7716a08&gt;</td></tr><tr><td>rack.request.form_vars</td><td>request[artist_name]=Knife%20Party&amp;request[email]=person%40example.com&amp;request[phone_number]=07949967627&amp;request[country]=France&amp;request[city]=Paris</td></tr><tr><td>rack.request.query_hash</td><td>{}</td></tr><tr><td>rack.request.query_string</td><td></td></tr><tr><td>rack.run_once</td><td>false</td></tr><tr><td>rack.session</td><td>{}</td></tr><tr><td>rack.session.options</td><td>{:path=&gt;\"/\", :domain=&gt;nil, :expire_after=&gt;nil, :secure=&gt;false, :httponly=&gt;true, :defer=&gt;false, :renew=&gt;false, :secret=&gt;\"98d3f4e78a03eb75aa2bc26d3d26c10524c72dc70035198d8fc73d99aef3\", :coder=&gt;#&lt;Rack::Session::Cookie::Base64::Marshal:0x007f84c75e6548&gt;, :id=&gt;nil}</td></tr><tr><td>rack.url_scheme</td><td>http</td></tr><tr><td>rack.version</td><td>[1, 0]</td></tr></tbody>\n          </table>\n</div>\n            </fieldset>\n            <fieldset id=\"queries_debug_info\" style=\"display: none\">\n              <legend>Queries</legend>\n              <div>            <b id=\"qtitle_0\">UNKNOWN</b> (<a href=\"javascript:Footnotes.toggle('qtrace_0')\" style=\"color:#00A;\">trace</a>)<br />\n            <span id=\"sql_0\">BEGIN</span><br />\n            <span style='background-color:#ffffff'>SQL (0.000ms)</span>&nbsp;\n            <p id=\"qtrace_0\" style=\"display:none;\"><a href=\"txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;amp;line=9&amp;amp;column=1\">app/controllers/api/v1/requests_controller.rb:9:in `create'</a><br /></p><br />\n            <b id=\"qtitle_1\">SELECT</b> (<a href=\"javascript:Footnotes.toggle('qtrace_1')\" style=\"color:#00A;\">trace</a>)<br />\n            <span id=\"sql_1\">SELECT 1 AS one FROM \"requests\" WHERE LOWER(\"requests\".\"email\") = LOWER('person@example.com') LIMIT 1</span><br />\n            <span style='background-color:#ffffff'>Request Exists (0.001ms)</span>&nbsp;\n            <p id=\"qtrace_1\" style=\"display:none;\"><a href=\"txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;amp;line=9&amp;amp;column=1\">app/controllers/api/v1/requests_controller.rb:9:in `create'</a><br /></p><br />\n            <b id=\"qtitle_2\">INSERT</b> (<a href=\"javascript:Footnotes.toggle('qtrace_2')\" style=\"color:#00A;\">trace</a>)<br />\n            <span id=\"sql_2\">INSERT INTO \"requests\" (\"artist_name\", \"city\", \"country\", \"created_at\", \"email\", \"phone_number\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING \"id\"</span><br />\n            <span style='background-color:#ffffff'>SQL (0.001ms)</span>&nbsp;\n            <p id=\"qtrace_2\" style=\"display:none;\"><a href=\"txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;amp;line=9&amp;amp;column=1\">app/controllers/api/v1/requests_controller.rb:9:in `create'</a><br /></p><br />\n            <b id=\"qtitle_3\">UNKNOWN</b> (<a href=\"javascript:Footnotes.toggle('qtrace_3')\" style=\"color:#00A;\">trace</a>)<br />\n            <span id=\"sql_3\">COMMIT</span><br />\n            <span style='background-color:#ffffff'>SQL (0.000ms)</span>&nbsp;\n            <p id=\"qtrace_3\" style=\"display:none;\"><a href=\"txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;amp;line=9&amp;amp;column=1\">app/controllers/api/v1/requests_controller.rb:9:in `create'</a><br /></p><br />\n</div>\n            </fieldset>\n            <fieldset id=\"log_debug_info\" style=\"display: none\">\n              <legend>Log</legend>\n              <div></div>\n            </fieldset>\n            <fieldset id=\"general_debug_info\" style=\"display: none\">\n              <legend>General (id=\"general_debug_info\")</legend>\n              <div>You can use this tab to debug other parts of your application, for example Javascript.</div>\n            </fieldset>\n\n          <script type=\"text/javascript\">\n            var Footnotes = function() {\n\n              function hideAll(){\n                Footnotes.hide(document.getElementById('partials_debug_info'));\nFootnotes.hide(document.getElementById('stylesheets_debug_info'));\nFootnotes.hide(document.getElementById('javascripts_debug_info'));\nFootnotes.hide(document.getElementById('session_debug_info'));\nFootnotes.hide(document.getElementById('cookies_debug_info'));\nFootnotes.hide(document.getElementById('params_debug_info'));\nFootnotes.hide(document.getElementById('filters_debug_info'));\nFootnotes.hide(document.getElementById('routes_debug_info'));\nFootnotes.hide(document.getElementById('env_debug_info'));\nFootnotes.hide(document.getElementById('queries_debug_info'));\nFootnotes.hide(document.getElementById('log_debug_info'));\nFootnotes.hide(document.getElementById('general_debug_info'));\n\n              }\n\n              function hideAllAndToggle(id) {\n                hideAll();\n                toggle(id)\n\n                location.href = '#footnotes_debug';\n              }\n\n              function toggle(id){\n                var el = document.getElementById(id);\n                if (el.style.display == 'none') {\n                  Footnotes.show(el);\n                } else {\n                  Footnotes.hide(el);\n                }\n              }\n\n              function show(element) {\n                element.style.display = 'block'\n              }\n\n              function hide(element) {\n                element.style.display = 'none'\n              }\n\n              return {\n                show: show,\n                hide: hide,\n                toggle: toggle,\n                hideAllAndToggle: hideAllAndToggle\n              }\n            }();\n            /* Additional Javascript */\n            \n          </script>\n        </div>\n        <!-- End Footnotes -->\n", @response=#<Net::HTTPNotAcceptable 406 Not Acceptable readbody=true>, @headers={"content-type"=>["text/html; charset=utf-8"], "x-ua-compatible"=>["IE=Edge"], "cache-control"=>["no-cache"], "x-request-id"=>["ca38df31ac3758fbed0753f83efe7bf8"], "x-runtime"=>["0.027491"], "connection"=>["close"], "server"=>["thin 1.5.0 codename Knife"]}>

Started POST "/requests" for 127.0.0.1 at 2013-01-27 17:34:07 +0000
Processing by RequestsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"Eat6tObc84Oi+D4hjjoYZermjxi0+QVtEb9FRVJOxnU=", "request"=>{"artist_name"=>"Knife Party", "email"=>"person@example.com", "phone_number"=>"07949967627", "country"=>"France", "city"=>"Paris"}, "commit"=>"Send request"}
Completed 404 Not Found in 34ms

ActionController::RoutingError (No route matches {:action=>"show", :controller=>"requests", :id=>#<Request artist_name: "Knife Party", email: "person@example.com", phone_number: "07949967627", country: "France", city: "Paris">}):
  app/controllers/requests_controller.rb:20:in `create'

  Rendered /Users/aziz/.rvm/gems/ruby-1.9.3-p327@portal/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.8ms) 
```

### 使用的客户端 gem（和版本）

```
gem 'rails', '3.2.11'
gem 'httparty', '0.10.2' 
```

### 使用的服务器 gem（和版本）

```
gem 'rails', '3.2.11' 
```

### 其他注意事项

当我使用 cURL 执行 get 请求以获取所有模型对象时，它可以完美运行。当我尝试使用 cURL 发出 POST 请求时……它不起作用，因为我没有正确使用 cURL，而且我不知道该怎么做。

## 更新

正如 Vadim Chumel 所建议的，我通过添加`.json`到请求 url 来修改保存方法：

```
# ...
self.class.post("/api/requests.json", { body: {
# ... 
```

现在我在服务器（API 端）收到 500 错误；这是请求的日志：

```
Started POST "/api/requests.json" for 127.0.0.1 at 2013-01-28 16:23:23 +0000
Processing by Api::V1::RequestsController#create as JSON
  Parameters: {"request"=>{"artist_name"=>"Knife Party", "email"=>"robert@example.com", "phone_number"=>"07949967627", "country"=>"France", "city"=>"Paris"}}
   (0.2ms)  BEGIN
  Request Exists (1.0ms)  SELECT 1 AS one FROM "requests" WHERE LOWER("requests"."email") = LOWER('robert@example.com') LIMIT 1
  SQL (1.1ms)  INSERT INTO "requests" ("artist_name", "city", "country", "created_at", "email", "phone_number", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["artist_name", "Knife Party"], ["city", "Paris"], ["country", "France"], ["created_at", Mon, 28 Jan 2013 16:23:23 UTC +00:00], ["email", "robert@example.com"], ["phone_number", "07949967627"], ["updated_at", Mon, 28 Jan 2013 16:23:23 UTC +00:00]]
   (0.4ms)  COMMIT
Completed 500 Internal Server Error in 14ms

NoMethodError (undefined method `request_url' for #<Api::V1::RequestsController:0x007f84c70d2660>):
  <a href="txmt://open?url=file:///Users/aziz/Sandbox/ruby/rails/Azoui/warden/app/controllers/api/v1/requests_controller.rb&amp;line=9&amp;column=1">app/controllers/api/v1/requests_controller.rb:9:in `create'</a>

  Rendered /Users/aziz/.rvm/gems/ruby-1.9.3-p327@warden/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms)
  Rendered /Users/aziz/.rvm/gems/ruby-1.9.3-p327@warden/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (0.8ms)
  Rendered /Users/aziz/.rvm/gems/ruby-1.9.3-p327@warden/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (14.1ms) 
```

奇怪的是，在整个服务器项目中，并没有提到`request_url`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T15:46:15.123

当您期待 HTML 时，您的 api 似乎只使用 json 响应。尝试更改此行：

```
self.class.post("/api/requests", { body: { 
```

至：

```
self.class.post("/api/requests.json", { body: { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T16:46:16.200

尝试使用 respond_with 设置位置

```
 @request =  Request.create(params[:request])
 respond_with(@request, :location => nil) 
```

您的客户端也需要显示操作，这就是您遇到路由错误的原因

```
 ActionController::RoutingError (No route matches {:action=>"show", :controller=>"requests", :id=>#<Request artist_name: "Knife Party", email: "person@example.com", phone_number: "07949967627", country: "France", city: "Paris">}):
  app/controllers/requests_controller.rb:20:in `create' 
```

另外我不明白你如何在客户端保存对象。没有关于设置创建的主键记录的逻辑。

# postgresql - PostgreSQL 不能在 PL/pgSQL 中开始/结束事务

> ID：14550241
> 
> 赞同：37
> 
> 时间：2013-01-27T17:48:26.787
> 
> 标签：postgresql, stored-procedures, transactions, plpgsql, postgresql-9.2

我正在寻求澄清如何确保 plpgsql 函数中的原子事务，以及为数据库的这种特定更改设置隔离级别的位置。

在下面显示的 plpgsql 函数中，我想确保删除和插入都成功。当我尝试将它们包装在单个事务中时出现错误：

> ```
> ERROR:  cannot begin/end transactions in PL/pgSQL 
> ```

如果另一个用户在此函数删除自定义行之后但在有机会插入自定义行之前添加了针对环境的默认行为（'RAIN'、'NIGHT'、'45MPH'），则在执行下面的函数*期间*会*发生*什么排？是否存在包装插入和删除的隐式事务，以便如果另一个用户更改了此函数引用的任一行，两者都会回滚？我可以为此功能设置隔离级别吗？

```
create function foo(v_weather varchar(10), v_timeofday varchar(10), v_speed varchar(10),
   v_behavior varchar(10))
   returns setof CUSTOMBEHAVIOR
   as $body$
   begin
      -- run-time error if either of these lines is un-commented

      -- start transaction ISOLATION LEVEL READ COMMITTED;
      -- or, alternatively, set transaction ISOLATION LEVEL READ COMMITTED;

      delete from CUSTOMBEHAVIOR 
      where weather = 'RAIN' and timeofday = 'NIGHT' and speed= '45MPH' ;

      -- if there is no default behavior insert a custom behavior

      if not exists
        (select id from DEFAULTBEHAVIOR where a = 'RAIN' and b = 'NIGHT' and c= '45MPH') then
         insert into CUSTOMBEHAVIOR
           (weather, timeofday, speed, behavior)
         values
           (v_weather, v_timeofday, v_speed, v_behavior);
      end if;

      return QUERY
      select * from CUSTOMBEHAVIOR where ...   ;

      -- commit;
   end
   $body$  LANGUAGE plpgsql; 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-27T17:55:46.270

plpgsql**函数**在事务中自动运行。要么全部成功，要么全部失败。[手册：](https://www.postgresql.org/docs/current/plpgsql-structure.html)

> 函数和触发器过程总是在由外部查询建立的事务中执行——它们不能启动或提交该事务，因为它们没有执行的上下文。但是，包含`EXCEPTION`子句的块有效地形成了一个子事务，可以回滚而不影响外部事务。有关更多信息，请参阅[第 42.6.6 节。](https://www.postgresql.org/docs/current/plpgsql-control-structures.html#PLPGSQL-ERROR-TRAPPING)

因此，如果需要，您可以捕获理论上可能发生的异常（但可能性很小）。
[手册中有关捕获错误的详细信息。](https://www.postgresql.org/docs/current/plpgsql-control-structures.html#PLPGSQL-ERROR-TRAPPING)

您的功能经过审查和简化：

```
CREATE FUNCTION foo(v_weather text
                  , v_timeofday text
                  , v_speed text
                  , v_behavior text)
  RETURNS SETOF custombehavior
  LANGUAGE plpgsql AS
$func$
BEGIN

DELETE FROM custombehavior
WHERE  weather = 'RAIN'
AND    timeofday = 'NIGHT'
AND    speed = '45MPH';

INSERT INTO custombehavior (weather, timeofday, speed, behavior)
SELECT v_weather, v_timeofday, v_speed, v_behavior
WHERE  NOT EXISTS (
   SELECT FROM defaultbehavior
   WHERE  a = 'RAIN'
   AND    b = 'NIGHT'
   AND    c = '45MPH'
   );

RETURN QUERY
SELECT * FROM custombehavior WHERE ... ;

END
$func$; 
```

* * *

如果您确实需要***开始/结束事务***，如标题中所示，请查看Postgres 11 或更高版本中的 SQL**过程**[**`CREATE PROCEDURE`**](https://www.postgresql.org/docs/current/sql-createprocedure.html)（ ）。看：

*   [在 PostgreSQL 中，“存储过程”和其他类型的函数有什么区别？](https://dba.stackexchange.com/questions/194684/in-postgresql-what-is-the-difference-between-a-stored-procedure-and-other-typ/194811#194811)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-09T19:47:17.753

更新：在 PostgreSQL 版本 11 之后。您可以控制存储过程中的事务。

===== 版本 10 之前：

```
START TRANSACTION;
select foo() ;
COMMIT; 
```

“不幸的是 Postgres 没有存储过程，所以你总是需要在调用代码中管理事务” – a_horse_with_no_name

[异常块中的事务 - 如何？](https://stackoverflow.com/questions/42000544/transaction-in-an-exception-block-how?rq=1)

# c# - 排序列表 未在使用 .NET 4.0 的 Systems.Collections.Generic 中定义

> ID：14550245
> 
> 赞同：3
> 
> 时间：2013-01-27T17:48:46.880
> 
> 标签：c#

我下载了一个使用通用版本的库`SortedList`，但是当我尝试编译它时，会弹出以下错误：

`The type or namespace name 'SortedList' does not exist in the namespace 'System.Collections.Generic' (are you missing an assembly reference?)`

我尝试使用完整的命名空间来修复它，`System.Collections.Generic.SortedList<string, string>`但仍然没有运气，同样的错误。

我在 MSDN 中查找，它说 .NET 4.0（我当前使用的版本）支持 SortedList。

此外，我的项目引用了提到的命名空间。

这是代码（对于对 SortedList 的每次引用，错误都会重复不止一次）：

```
public class Map
{
    public SortedList<string, Tileset> Tilesets = new SortedList<string, Tileset>();
    public SortedList<string, Layer> Layers = new SortedList<string, Layer>();
    public SortedList<string, ObjectGroup> ObjectGroups = new SortedList<string, ObjectGroup>();
    public SortedList<string, string> Properties = new SortedList<string, string>();
    public int Width, Height;
    public int TileWidth, TileHeight;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-06-05T10:35:21.347

右键单击项目的引用并选择“添加引用”。选择“程序集”，并在“系统”旁边打勾。单击“确定”，现在应该已修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:14:58.570

这个库是偶然在早期版本的 .NET 下构建的吗？您是否更改了项目的框架版本？

如果是，您可能需要手动将 System.dll 添加到引用中（参考：[另一个 SO 问题](https://stackoverflow.com/questions/6948703/cant-find-observablecollection-in-system-collections-objectmodel)）

# xcode - 带有自定义按钮的故事板

> ID：14550246
> 
> 赞同：0
> 
> 时间：2013-01-27T17:48:52.543
> 
> 标签：xcode, storyboard

我有一个故事板设置正确，按钮导致不同的场景，但是我对按钮的外观不满意。它们在图像周围都有一个完美的方形边框......就像图像在一个盒子里一样。

有什么方法可以删除该边框并简单地将我的图像显示在视图中，但图像仍然用作按钮？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T22:19:17.030

我猜你想要的是使用图像作为“按钮”。

*   选择情节提要中的按钮
*   在“属性检查器”中，选择
*   按钮，键入“自定义”，将“背景”设置为您添加到项目中的图像。应该管用。

# ios - UIDatePicker 给出错误的时间

> ID：14550249
> 
> 赞同：1
> 
> 时间：2013-01-27T17:48:58.610
> 
> 标签：ios, objective-c, timezone, nsdateformatter, uidatepicker

> **可能重复：**
> [将日期从 [NSDate 日期] 关闭几个小时](https://stackoverflow.com/questions/8466744/getting-date-from-nsdate-date-off-by-a-few-hours)
> [NSDate 日期不给我正确的时间](https://stackoverflow.com/questions/14082912/nsdate-date-dont-give-me-the-right-hour)

我有这段代码：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"HH:mm"];

NSString *formattedDateInString = [formatter stringFromDate:[self.datePicker date]];
NSLog(@"This is the formatted date (STRING) ---> %@" ,formattedDateInString);
self.fromHourLabel.text = formattedDateInString;

NSDate *date = [formatter dateFromString:formattedDateInString];
NSLog(@"This is the date (NSDate) ---> %@" ,date);
self.fromHour = date; 
```

我基本上从 UIDatePicker 获取日期，将 Hours 和 Minutes 设置为标签文本并将日期保存到名为 fromHour 的属性中。在`-viewDidLoad`方法中我也有：

```
self.datePicker.timeZone = [NSTimeZone localTimeZone]; 
```

这是输出：

![在此处输入图像描述](../Images/e8dbf3e88d9023c941f2cee348ac6896.png)

如您所见，使用此代码，我有两个主要问题：

*   第一个输出说 17.30 和第二个 16:30（第一个输出是正确的，第二个是错误的）为什么？
*   第二个输出格式为“yyyy-MM-dd HH:mm:ss”，但我只需要“HH:mm”。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T17:59:03.833

我知道有几十个现有问题涵盖了这一点，但我找不到一个。

问题很简单。当您使用`NSLog`或包含`%@`格式说明符的字符串格式打印对象时，将`description`在对象上调用该方法。

始终使用祖鲁时区 (+0000) 显示完整日期的`description`方法。`NSDate`

如果您想以特定格式打印日期，请使用`NSDateFormatter`转换为字符串并打印字符串。

编辑：根据评论中的信息，这里的部分问题是你从正确的`NSDate`. 然后，您将其转换为格式为`HH:mm`. `NSDate`然后，您从该字符串创建一个新的。更好的解决方案是简单地保存原始日期并避免创建第二个日期。

# objective-c - 如何确保某个 ID 在核心数据中只出现一次？

> ID：14550252
> 
> 赞同：0
> 
> 时间：2013-01-27T17:49:16.253
> 
> 标签：objective-c, core-data, xcode4.5

到目前为止，这是我尝试过的：

```
+(NSManagedObject *) getObjectWithStringOfValue:(NSString *) Value fromTable:(NSString*) table withAttribut:(NSString *) AttributName
{
    NSManagedObject * buffer=nil;
    @synchronized(self)
    {
        buffer=[self LookUpObjectWithAttributeValue:Value fromTable:table WithAttribut:AttributName];
        if (buffer == nil)
        {
            //CLog( @"gk boleh create");
            buffer=[self CreateNewObjectFromTable:table];
            [buffer setValue:Value forKey:AttributName];
            [BGMDCRManagedObjectContextThreadHandler commit];
            NSAssert([self LookUpObjectWithAttributeValue:Value fromTable:table WithAttribut:AttributName], @"Object must exist and must only be one");
        }
        else
        {
            //assert(!(buffer.isFault));
        }
    }

    return buffer;
} 
```

基本上@synchronized 是必要的。有可能一个线程看到没有创建对象，而另一个线程做同样的事情，他们都提交了 2 个对象。

但是，这往往会导致死锁。

在我的实现中，每个线程都有自己的 moc。所以 [BGMDCRManagedObjectContextThreadHandler managedobjectcontext] 会将 moc 提供给该线程。每个 moc 都有相同的父对象，即在主线程上创建的主托管对象上下文。

当 LookUpObjectWithAttributeValue 中的 executeFetchRequest 停止时发生锁定。另一方面，主线程也会在@synchronized(self) 上停止。

我想知道如何解决这个问题？

我应该确保主 managedObjectContext 不与主线程相关联吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T05:09:54.633

我很少直接访问核心数据。因此，例如，整个程序中只有一行代码执行 excecuteFetchRequest。

每次孩子间接访问父母时，我都会执行 BlockAndWait

```
[moc performBlockAndWait:^{
    saveSuccesfully = [moc save:&error];
    if (!saveSuccesfully) {
        CLog(@"Error in Saving %@", error);
    }
    else{
    }
}];

[moc performBlockAndWait:^{
    fetchedObjects = [moc executeFetchRequest:request error:&error];
}];

    [moc performBlock:^{
        if (![moc save:&error])
        {
            CLog(@"Error in Saving %@", error);// handle error
        }
    }]; 
```

从此再无僵局。

# java - JPanels里面的JButtons，填满整个面板

> ID：14550255
> 
> 赞同：2
> 
> 时间：2013-01-27T17:49:59.120
> 
> 标签：java, swing, jpanel, jbutton, layout-manager

我一直在努力为插入带有 GridLayout 的 JPanel 中的按钮设置特定大小。

该按钮总是填满整个面板，而如果我删除网格布局，该按钮将不会有相同的行为。

任何提示？

```
package panels;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class ColorDisplay {

private final int X = 100; 
private final int Y = 100;
private final Dimension PANEL_SIZE = new Dimension(500,500);
private JTextField textRed;
private JTextField textGreen;
private JTextField textBlue;
private JLabel labelText, labelRed, labelGreen, labelBlue;
private JPanel displayPanel;
private JPanel textPanel;
private JPanel buttonPanel;
private JButton button;
private final Font font = new Font("Arial", Font.PLAIN, 22);

public static void main(String[] args) {
    // TODO Auto-generated method stub

    new ColorDisplay();

}
public ColorDisplay(){
    JFrame mainFrame = new JFrame();

    // make sure the program exits when the frame close
    mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    mainFrame.setTitle("Color Display");
    mainFrame.setLocation(X,Y);
    mainFrame.setPreferredSize(PANEL_SIZE);

    // ensure an elastic layout
    mainFrame.setLayout(new GridLayout(3, 1));

    mainFrame.setLocationByPlatform(true);

    mainFrame.add(getColorPanel());
    mainFrame.add(getTextPanel());
    mainFrame.add(getButtonPanel());

    mainFrame.pack();
    mainFrame.setVisible(true);

}

public JPanel getColorPanel(){
    displayPanel = new JPanel(new BorderLayout());
    labelText = new JLabel("Color Display", JLabel.CENTER);
    Font fontColorDisplay = new Font("Arial", Font.PLAIN, 42);
    labelText.setFont(fontColorDisplay);

    displayPanel.add(labelText);

    return displayPanel;
}

public JPanel getTextPanel(){
    textPanel = new JPanel(new GridLayout(2,3));
    labelRed = new JLabel("Red", JLabel.CENTER);
    labelGreen = new JLabel("Green", JLabel.CENTER);
    labelBlue = new JLabel("Blue", JLabel.CENTER);
    textRed = new JTextField();
    textGreen = new JTextField();
    textBlue = new JTextField();

    labelRed.setFont(font);
    labelGreen.setFont(font);
    labelBlue.setFont(font);
    textRed.setFont(font);
    textGreen.setFont(font);
    textBlue.setFont(font);

    textPanel.add(labelRed);
    textPanel.add(labelGreen);
    textPanel.add(labelBlue);
    textPanel.add(textRed);
    textPanel.add(textGreen);
    textPanel.add(textBlue);

    return textPanel;
}

public JPanel getButtonPanel(){

    buttonPanel = new JPanel(new BorderLayout());
    button = new JButton("Display Color");
    button.addActionListener(new ButtonListener ()); // Add event handler
    button.setFont(font);
    button.setPreferredSize(new Dimension(100, 100));

    buttonPanel.add(button);
    return buttonPanel;

}

private int getColor(){

    String colorCode = textRed.getText() + textGreen.getText() + textBlue.getText();
    return Integer.parseInt(colorCode);
}

private boolean validateColor(String textValue){
    boolean isValid = false;
    try {
        int num1 = Integer.parseInt(textValue);
        if (num1 >= 0 && num1 <= 255)
            isValid = true;
        else
        {
            isValid = false;
            JOptionPane.showConfirmDialog(null, "Please enter numbers between 0 and 255", "Error", JOptionPane.PLAIN_MESSAGE);
        }
    } catch (NumberFormatException e) {
        JOptionPane.showConfirmDialog(null, "Please enter numerical values", "Error", JOptionPane.PLAIN_MESSAGE);
    }
    return isValid;

}
private class ButtonListener implements ActionListener { // Inner class
    public void actionPerformed(ActionEvent event) {

        if (validateColor(textRed.getText()) && validateColor(textGreen.getText()) && validateColor(textBlue.getText()))
        {
            Color bgColor = new Color(getColor());
            displayPanel.setBackground(bgColor);    
        }

    }
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T17:53:20.397

您的问题是关于`GridLayout`但您使用以下方式显示代码`BorderLayout`：

```
buttonPanel = new JPanel(new BorderLayout());
button = new JButton("Display Color");
button.addActionListener(new ButtonListener ()); // Add event handler
button.setFont(font);
button.setPreferredSize(new Dimension(100, 100)); 
```

?

> 该按钮总是填满整个面板，而如果我删除网格布局，该按钮将不会有相同的行为。

这是`GridLayout`默认行为，它的空间被平均分配，每个组件都占据了整个空间（同样适用于`BorderLayout`）。

还有许多其他`LayoutManager`可以满足您的需求：

*   [布局管理器的视觉指南](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)

您可能想看看[`GridBagLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)哪个更灵活：

```
buttonPanel = new JPanel(new GridBagLayout());
button = new JButton("Display Color");
button.addActionListener(new ButtonListener()); // Add event handler
button.setFont(font);

GridBagConstraints gc=new GridBagConstraints();
gc.fill=GridBagConstraints.HORIZONTAL;
gc.gridx=0;
gc.gridy=0;

buttonPanel.add(button,gc); 
```

![在此处输入图像描述](../Images/c8fad3820005dbe943a887e98d0b0cf1.png)

甚至是默认值`JPanel` `FlowLayout`：

```
 buttonPanel = new JPanel();
    button = new JButton("Display Color");
    button.addActionListener(new ButtonListener()); // Add event handler
    button.setFont(font);

    buttonPanel.add(button); 
```

![在此处输入图像描述](../Images/2d6a9e603b6102265833e6a74929b485.png)

或`LayoutManger`像[`MigLayout`](http://www.miglayout.com/).

**其他建议：**

*   不要调用`setPreferredSize(..)`而不是覆盖`getPreferredSize()`，甚至不仅仅在绘制到`Graphic`s 对象或想要使组件更大/更小时这样做，不要出于布局目的这样做，这是一项`LayoutManager`工作。

*   还要永远记住通过块在[事件调度线程上创建和操作 Swing 组件](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)`SwingUtilities.invokeLater(Runnable r)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:03:13.090

用此方法替换您的 getButtonPanel() （我使用 GroupLayout 使其工作），

```
public JPanel getButtonPanel(){

    JPanel jPanel1 = new JPanel();
    button = new JButton("Display Color");
    button.addActionListener(new ButtonListener ()); // Add event handler
    button.setFont(font);
    javax.swing.GroupLayout jPanel1Layoutx = new javax.swing.GroupLayout(jPanel1);
                    jPanel1.setLayout(jPanel1Layoutx);
                    jPanel1Layoutx.setHorizontalGroup(
                            jPanel1Layoutx.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel1Layoutx.createSequentialGroup().addContainerGap().addComponent(button, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)));
                    jPanel1Layoutx.setVerticalGroup(
                            jPanel1Layoutx.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel1Layoutx.createSequentialGroup().addComponent(button, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE).addGap(0, 12, Short.MAX_VALUE)));

    return jPanel1;

} 
```

您可以设置您喜欢的按钮大小，而不是 24！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-05T14:59:31.510

试试这个，它对我有用。

```
JFrame frame=new JFrame();
JPanel p1 = new JPanel(new GridLayout(2,1));
JLabel lb1= new JLabel("Test1");
JButton button1 = new JButton("Go to whatever");
button1.addActionListener();
JPanel p2=new JPanel();
p2.add(button1);
p1.add(p2);
frame.add(p1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T02:20:05.300

只需创建一个 JPanel，然后将该 JPanel 添加到框架的布局中。现在在 JPanel 中，我们将其称为 holderPanel，添加按钮。现在按钮不会占用整个空间！随意执行以下一些操作以更好地适应您的程序：

*   `holderPanel.setOpaque(false); //So the panel is invisible, but your button is`
*   `holderPanel.setBorder(new EmptyBorder(80, 50, 20, 130));`

# objective-c - 如何在 Objective-C 中将只读属性转换为读写属性？

> ID：14550266
> 
> 赞同：8
> 
> 时间：2013-01-27T17:50:57.577
> 
> 标签：objective-c

在Objective-C中将只读属性转换为读写属性的方法是什么？请记住，我无法访问源代码。

原因：出于模拟目的，我需要在单元测试中执行此操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T19:48:12.133

如果不访问类的主要实现块，或者至少是包含它的编译单元，则无法像这样更改属性的功能，因为您无法访问该单元之外的*ivar*。即使您要在类别中为类添加一个 setter，您也无法影响类的存储，就像您完全在类之外一样。

但是，您可以做的是使用 KVC。*如果可以找到一个*`setValue:forKey:`，将绕过 setter 并直接进入 ivar 。您可以使用它来设置您喜欢的任何值，即使是已声明的属性，只要有您知道其名称的后备存储即可。*`readonly`*

 *它是这样的：

```
//Passaquisset.h
#import <Foundation/Foundation.h>

@interface Passaquisset : NSObject

@property (copy, readonly, nonatomic) NSString * vanadium;

@end 
```

* * *

```
//Passaquisset.m
#import "Passaquisset.h"

@implementation Passaquisset

@synthesize vanadium;

- (id) init {

    self = [super init];
    if( !self ) return nil;

    vanadium = @"Number 23";

    return self;
}

@end 
```

* * *

```
//Elsewhere...
#import <Foundation/Foundation.h>

#import "Passaquisset.h"

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        Passaquisset * pq = [Passaquisset new];
        NSLog(@"%@", [pq vanadium]);

        [pq setValue:@"Number 24" forKey:@"vanadium"];

        NSLog(@"%@", [pq vanadium]);

    }
    return 0;
} 
```

就像我说的那样，这将失败——实际上引发了一个异常——如果既没有同名的 setter 也没有 ivar（或附加下划线`_vanadium`（KVC 非常聪明），例如如果属性的值是完全计算的：

```
//Passaquisset.m

#import "Passaquisset.h"

@implementation Passaquisset

/** KVC will fail with this version! **/

- (NSString *)vanadium
{
    return @"Number 23";
}

@end 
```

为了完整起见，让我提一下，如果属性由完全不同名称的 ivar 支持（例如，`@synthesize vanadium = erythronium;`），您需要知道*ivar 的*名称才能使用 KVC。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T19:48:46.990

您不能简单地将属性变成`readwrite`并希望访问 setter，因为 setter 本身还没有被合成，因此它根本不存在。

您可能会想到做的是猜测 ivar 的名称并在运行时添加一个 setter。

假设您的属性被调用`foo`并且具有该`copy`属性。

1.  猜猜那个ivar的名字。让我们尝试一下`_foo`。

2.  准备一个二传手

    ```
    void fooSetter(id self, SEL _cmd, id newFoo) {
        Ivar ivar = class_getInstanceVariable(self, "_foo");
        id oldFoo = object_getIvar(self, ivar);
        if (oldFoo != newFoo)
             object_setIvar(self, ivar, [newFoo copy]);
    } 
    ```

3.  在`resolveInstanceMethod:`类方法中给类添加setter

    ```
    + (BOOL) resolveInstanceMethod:(SEL)aSEL {
        if (aSEL == @selector(setFoo:)) {
          class_addMethod(self, @selector(setFoo:), (IMP)fooSetter, "v@:@");
          return YES;
        }
        return [super resolveInstanceMethod:aSel];
    } 
    ```

此时您已`setFoo:`在运行时将该方法添加到您的类中，因此您可以通过以下方式访问它

```
YourClass yourObject = ...;
[yourObject setFoo:whatever]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-27T17:57:48.183

我认为覆盖属性意味着再次重新声明它会起作用

在您的 .h 文件中：

```
@property (readonly, copy) NSString *yourProperty;
In your .m file:

@interface MyClass ()

// Redeclare property as readwrite
@property (readwrite, copy) NSString *yourProperty;

@end

@implementation MyClass

@synthesize yourProperty;
@end 
```

或者

我没有经过测试，但我认为，您必须尝试关注

```
[youReadOnlyrProperty retain] 
```*

# php - GROUP BY with WHERE 什么都不显示

> ID：14550269
> 
> 赞同：0
> 
> 时间：2013-01-27T17:51:16.920
> 
> 标签：php, mysql, group-by, where

我有这个

```
$query = mysql_query("SELECT *, COUNT(*) FROM impressions WHERE pub_tag = '$pub_tag' AND pub_id = '$pub_id' AND month = '$date' GROUP BY country");
while($stat_cont = mysql_fetch_array($query)) {
echo '[\''.$stat_cont['country'].'\', '.$stat_cont['COUNT(*)'].'],';
} 
```

它什么也没有显示也没有错误。当删除 WHERE 时，它可以工作。

```
CREATE TABLE IF NOT EXISTS `impressions` (
  `id` int(15) unsigned NOT NULL AUTO_INCREMENT,
  `pub_id` int(10) unsigned NOT NULL,
  `pub_tag` varchar(10) NOT NULL,
  `time` int(10) unsigned NOT NULL,
  `month` int(6) unsigned NOT NULL,
  `ip` int(15) unsigned NOT NULL,
  `country` varchar(100) NOT NULL,
  `country_city` varchar(150) NOT NULL,
  `country_region` varchar(100) NOT NULL,
  `country_code` varchar(2) NOT NULL,
  `revenue` float unsigned NOT NULL,
  PRIMARY KEY (`id`)
) ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:01:57.440

如果您想通过对“国家/地区”进行分组来获得结果，请不要在查询中给出“*”，而是在选择和分组方式中给出国家/地区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:53:02.217

1.  将您的查询放入一个变量中，`echo`然后查看发送到 MySQL 的确切内容。

    `$stmt = "SELECT ... ";`
    `echo $stmt;`

2.  为聚合使用别名：

    `SELECT Country, COUNT(*) AS count ...`

3.  `mysql_`功能已弃用。请不要在新代码中使用它们。它们不再被维护[并被正式弃用](http://j.mp/XqV7Lp)。看到[**红框**](http://j.mp/Te9zIL)了吗？改为了解[*准备好的语句*](http://j.mp/T9hLWi)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://j.mp/QEx8IB)将帮助您决定使用哪个。

4.  MySQL 扩展`GROUP BY`了可能产生不良结果的功能。最好不要选择不在您的`GROUP BY`

# c++ - 实现嵌套在模板类中的类的成员函数

> ID：14550270
> 
> 赞同：1
> 
> 时间：2013-01-27T17:51:19.417
> 
> 标签：c++, templates, visual-c++, compiler-errors

我正在.cpp 中实现模板成员函数，并了解所涉及的限制（一次只能将此类模板模板化为一种类型）。一切都很好，除了这个案例。虽然我已经让嵌套类的构造函数工作，但我遇到了任何其他嵌套类成员函数的问题。作为参考，我正在使用 VC++ 11 进行编译。

在.h中：

```
template<typename T> class TemplateClass
{
 class NestedClass
 {
  NestedClass();

  bool operator<(const NestedClass& rhs) const;
 };
}; 
```

在 .cpp 中：

```
//this compiles fine:
template<typename T>
TemplateClass<T>::NestedClass::NestedClass()
{
 //do stuff here
}

//this won't compile:
template<typename T>
bool TemplateClass<T>::NestedClass::operator<(const TemplateClass<T>::NestedClass& rhs) const
{
 //do stuff here

 return true;
}

template class TemplateClass<int>; //only using int specialization 
```

编辑：这是错误，都指向`operator<`实施行

错误 C2059：语法错误：'const'
错误 C2065：'rhs'：未声明的标识符
错误 C2072：'TemplateClass::NestedClass::operator <'：函数初始化
错误 C2470：'TemplateClass::NestedClass::operator <'：看起来像函数定义，但没有参数列表；跳过明显的正文
错误 C2988：无法识别的模板声明/定义

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:00:03.317

`NestedClass`作为参数类型在范围内，因此您可以尝试以下操作：

```
 bool TemplateClass<T>::NestedClass::operator<(const NestedClass& rhs) const 
```

MSVC 在第一个版本上可能有问题。

# matlab - 如何在 quiver3 plot，MATLAB 中更改线型

> ID：14550271
> 
> 赞同：1
> 
> 时间：2013-01-27T17:51:30.820
> 
> 标签：matlab, graph, plot, styles, line

我无法弄清楚如何更改`quiver3`绘图中的线条样式。
我想将一些线条更改为虚线并保持其他线条稳定。
建议会有所帮助。
我已经尝试过：

```
 quiver3(0,0,0,a(1),a(2),a(3),'LineStyle','solid');
 hold on;    
 quiver3(0,0,0,b(1),b(2),b(3),'LineStyle','solid');
 hold on;    
 quiver3(0,0,0,c(1),c(2),c(3),'LineStyle','dashed'); 
```

还有很多其他的东西。
我是matlab的新手，所以对我轻松一点。请。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:06:24.987

您可以`LineStyle`在创建绘图对象后设置属性

```
h = quiver3((0,0,0,a(1),a(2),a(3));
set(h, 'LineStyle', '--', 'Color', 'r'); 
```

# android - 无限生命周期服务android

> ID：14550274
> 
> 赞同：-2
> 
> 时间：2013-01-27T17:51:47.527
> 
> 标签：android

我在活动中调用服务，但是当我关闭应用程序时，服务也关闭了。如何创建无限生命周期服务？而且，我如何在 BroadcastReceiver 中调用 Activity？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:55:36.220

不可能创造出这样的东西。

您可以做的最接近的事情是将您的服务设置为前台，请参阅[http://developer.android.com/guide/components/services.html#Foreground](http://developer.android.com/guide/components/services.html#Foreground)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:55:48.980

> 如何创建无限生命周期服务？

你不能。操作系统将在它认为合适时终止您的进程，其中包括在用户要求时终止它，例如通过任务杀手应用程序。请牢记这一点来设计您的应用程序。

> 而且，我如何在 BroadcastReceiver 中调用 Activity？

如果`BroadcastReceiver`是 Activity 注册的 via `registerReceiver()`，那么如果`BroadcastReceiver`是 Activity 的内部类，它可以像 Java 中的任何内部类一样正常调用 Activity 上的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T17:55:49.883

如果您希望服务在停止 Activity 后继续运行，请通过 startService 而不是 bindService 启动它。不要忘记再次停止它。

startActivity 启动一个Activity sendBroadcast 启动一个BroadcastReceiver startService 启动一个Activity。

# java - 在 Eclipse IDE 中确定 .class 来自哪个 jar

> ID：14550277
> 
> 赞同：3
> 
> 时间：2013-01-27T17:52:06.657
> 
> 标签：java, eclipse, jar

我正在调试 .maven 项目中的某个东西`Eclipse IDE`。像往常一样，当我`stepped into (F5)`一行时，我到达了一个 java class/file `Persistence.class`。我想确定它`jar`是从哪里来的。

**原因**：有两个项目（现有）在 pom.xml 中配置了某些依赖项。我看到该文件有两个不同的源代码 - 其中一个给出了所需的结果，而另一个没有。我曾尝试寻找等`persistence-api`，`ejb`但在 eclipse 中显示的 Maven 依赖项中没有找到它们中的任何一个。

因此，我想`grep`（`poms`父项目）寻找 jar。

**总结一下**，在 Eclipse 中是否有一个视图可以看到 .class 文件来自哪个 jar？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T17:55:06.437

在 Package Explorer（双箭头）中激活“Link with editor”，然后按 F3。Eclipse 在库中扩展该类。（确保显示的编辑器`Persistence.class`具有焦点）。

对于下一步，假设您使用 m2eclipse，打开 pom 编辑器并查看 Dependency Hierarchy 选项卡。这给出了依赖来自何处的第一个提示。它可能是传递的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:00:44.643

另一种方法是尝试使用 ctrl（mac 上的 cmd）+ t 打开文件。通过这种方式，您可以打开一个类型，并在弹出窗口的底部显示该类在哪个 jar 文件中找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-11T14:32:25.607

ctrl-shift-t 到“打开类型”。

Eclipse 版本：2019-03 (4.11.0)

# javascript - 如何计算圆弧起点和终点的精确点位置

> ID：14550278
> 
> 赞同：2
> 
> 时间：2013-01-27T17:52:27.780
> 
> 标签：javascript, html, canvas

我想通过计算找到弧的终点和起点。

你可以输入

射程半径：150

范围起始角度：60

范围结束角度：160

请参阅[演示 jsFiddle](http://jsfiddle.net/UfTPa/1/show/)

[链接到演示问题的屏幕截图](http://s2.postimage.org/7i4b2mvrd/2013_01_27_191328.jpg)

非常感谢

```
function draw(val,StartAngle,EndAngle,XAxis,YAxis){
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d'),
        x = 200,//center raduis
        y = 400;//center raduis
        d = EndAngle;//End Angle
        s = StartAngle;//Start angle
        X_Axis = XAxis;//feature to enable to move the circle on axis X
        Y_Axis = YAxis;// feature to enable to move the circle on axis Y

        p ={}
        p.r = val;
        p.d = d*2*Math.PI/360;
        p.s = s*2*Math.PI/360;
        p.x = X_Axis + p.d*Math.cos(p.r);
        p.y = Y_Axis + p.d*Math.sin(p.r);

        p.pex = p.x + p.r*Math.cos(d);
        p.pey = p.y - p.r*Math.sin(s);

        p.psx = p.x - Math.sin(s) * p.r;
        p.psy = p.y - Math.cos(s) * p.r ;

        context.clearRect(0, 0, canvas.width, canvas.height);

        context.beginPath();
        context.lineWidth = 1;

        context.arc(p.x ,p.y ,p.r,p.s,p.d);

        context.fillStyle = 'green';
        context.fillRect(x,y+val,2,2); // crnter circle

        context.fillStyle = 'yellow';
        context.moveTo(x-p.d,y+p.d);
        context.lineTo(x+p.d,y+p.d);

        context.stroke();

        // line color
        context.strokeStyle = 'black';
        context.stroke();

        // Cut off the top of the circle.
        //context.clearRect(0, 0, canvas.width, y);

        // This stuff's just to show some dots
        context.fillStyle = 'red';
        context.fillRect(x-1,y-1,2,2); // Middle
        context.fillRect(p.pex,p.pey,4,4);//Target point 1
        context.fillRect(p.psx,p.psy,4,4);// Target point 2

        context.fillRect(x-2,y+d+val-2,4,4); // Point on circle
        context.fillStyle = 'black';

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T17:58:45.360

# 一般解决方案

```
 var r_length = ... // radius
  var r_start_angle = RangeStartAngle / 360 * 2 * Math.PI; // lets convert degrees to radians
  var r_end_angle = RangeEndAngle / 360 * 2 * Math.PI; 
```

**起始位置**

```
 x = circle_center_x + Math.cos(r_start_angle) * r_length;
  y = circle_center_y + Math.sin(r_start_angle) * r_length; 
```

**结束位置**

```
 x = circle_center_x + Math.cos(r_end_angle) * r_length;
  y = circle_center_y + Math.sin(r_end_angle) * r_length; 
```

**绘制圆弧**

```
 context.arc(circle_center_x ,circle_center_y, r_start_angle, r_end_angle); 
```

您可能希望使用该知识重写您的函数

# .net - 在客户端使用时升级 Silverlight 应用程序

> ID：14550285
> 
> 赞同：1
> 
> 时间：2013-01-27T17:52:54.433
> 
> 标签：.net, silverlight

我有一个 Silverlight 5 应用程序，它通过 WCF 服务与服务器通信。

大多数使用该应用程序的用户在浏览器中运行它（主要是 Internet Explorer，但也使用其他浏览器），少数用户安装它 OOB（浏览器外）。

当应用程序启动时，它会检查更新的版本并在必要时进行升级。这里没有什么不寻常的。

不时地，主要是在晚上和周末，我对解决方案进行升级。这可能是数据库中的更改、WCF 服务中的更改、Silverlight 应用程序本身的更改，或所有这些的混合。在大多数情况下，这绝对没有问题。

我的问题是有些用户从不关闭他们的网络浏览器。有些用户甚至通过 Citrix 窗口工作，下班后只关闭 Citrix 窗口回家，让 Silverlight 应用程序运行并存在于 Web 浏览器中。有些根本不关闭浏览器。或者，如果他们运行 OOB，他们会让应用程序保持打开状态。这些是我的问题。因为他们永远不会检查新的更新。Silverlight 应用程序永远不会升级，也不适合可能升级的新 WCF 服务。

这一切都使 Silverlight 应用程序崩溃并抛出奇怪的异常，因为周围的世界已经发生了变化。

***有没有人遇到过类似的问题并且实际上找到了一个好的解决方案？***

我努力了：

*   创建一个计时器，该计时器在任何键盘或鼠标单击时重置，并在给定时间段无活动后退出应用程序。但似乎这个计时器有时不算数，比如从 RDP 或 Citrix 会话进行 dosconnect 时。

*   每次显示某个控件或窗口时检查更新。但这不是一个好的解决方案，因为所有用户可能不会使用相同的。如果他们正在处理某些事情，它也可能会打断用户。

但在我看来，它们都像是有点俗气的变通办法。

任何建议，有人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T20:38:01.687

在用户处于活动状态时重新启动计时器对我来说没有意义。如果它们在发布更新时处于活动状态怎么办？当然，被打断总比让应用程序摔倒更好吗？

最好以固定的时间间隔运行计时器。`CheckAndDownloadUpdateAsync`如果需要重新启动，它将调用并提示用户。

对于计时器不运行或在间隔之间发布关键更新的边缘情况，您可以尝试在`App.Application_UnhandledException`方法中执行更新逻辑。只是不要忘记将事件标记为已处理，您发现确实有要安装的更新...

这样你应该有完整的覆盖范围。

* * *

**编辑：**对于浏览器内应用程序，您只需要担心何时刷新页面，因为[这足以确保 XAP 是最新的](https://stackoverflow.com/questions/5991420/how-to-force-re-download-of-silverlight-xap-file).

您的计时器可以调用一些[JavaScript](https://stackoverflow.com/questions/552756/can-silverlight-initiate-page-refreshes)来实现这一点，但我认为最好在`App.Application_UnhandledException`事件中简单地触发刷新。如果你真的想让它变得无缝，你可以事先将状态写入到 IsolatedStorage。

# asp.net-mvc - 如何在 asp.net mvc 4 中实现社交登录？

> ID：14550286
> 
> 赞同：5
> 
> 时间：2013-01-27T17:53:00.430
> 
> 标签：asp.net-mvc, facebook, asp.net-mvc-4, oauth-2.0, dotnetopenauth

我想使用 oauth 和 facebook、twitter、google 等实现基于角色的登录。它只会使用 oauth 并且会有一个角色系统。不是具有通常注册和登录的默认模板。似乎 dot net open auth 将有助于初始的东西，但我找不到使用或扩展它的好例子。有人可以解释如何从头开始使用 dotnet open auth 以及如何使用它获取额外信息吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T17:55:37.203

1.  启动 Visual Studio 2012
2.  使用 Internet 模板创建一个新的 ASP.NET MVC 4 应用程序
3.  打开`~/App_Start/AuthConfig.cs`文件
4.  通过将您的客户端密钥和密码放入相应的提供程序来取消注释您要使用的提供程序

有关 OAuth 集成的更多信息，我邀请您前往该[`DotNetOpenAuth`](http://www.dotnetopenauth.net/)站点，浏览[`documentation`](http://www.dotnetopenauth.net/documentation/)、下载并使用示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:57:02.627

打开 ~/App_Start/AuthConfig.cs 文件并使用[它](http://www.dotnetexpertguide.com/2012/08/facebook-twitter-oauth-openid-login-with-aspnet-mvc-4-application.html)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Web.WebPages.OAuth;

namespace MVCTemplateProject
{
    public static class AuthConfig
    {
        public static void RegisterAuth()
        {

            OAuthWebSecurity.RegisterMicrosoftClient(
               clientId: "code",
                clientSecret: "code");

            //OAuthWebSecurity.RegisterTwitterClient(
            //    consumerKey: "",
            //    consumerSecret: "");

            //OAuthWebSecurity.RegisterFacebookClient(
            //    appId: "",
            //    appSecret: "");
            OAuthWebSecurity.RegisterLinkedInClient("code", "code");
            OAuthWebSecurity.RegisterGoogleClient();
        }
    }
} 
```

# python - 仅当它们出现在 html 标记内时，如何删除换行符？

> ID：14550288
> 
> 赞同：2
> 
> 时间：2013-01-27T17:53:05.673
> 
> 标签：python, html-parsing

对不起，另一个python新手问题。我有一个字符串：

```
my_string = "<p>this is some \n fun</p>And this is \n some more fun!" 
```

我想：

```
my_string = "<p>this is some fun</p>And this is \n some more fun!" 
```

换句话说，**只有**当它出现在 html 标记内时，我如何才能摆脱它？

我有：

```
my_string = re.sub('<(.*?)>(.*?)\n(.*?)</(.*?)>', 'replace with what???', my_string) 
```

这显然行不通，但我被困住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T17:58:49.260

正则表达式不适合 HTML。不要这样做。请参阅[RegEx match open tags except XHTML self-contained tags](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。

相反，请使用 HTML 解析器。Python 附带[html.parser](http://docs.python.org/3/library/html.parser.html)，或者您可以使用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)或[html5lib](http://code.google.com/p/html5lib/)。然后，您所要做的就是遍历树并删除换行符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:18:33.460

您应该尝试使用 BeautifulSoup ( `bs4`)，这将允许您解析 XML 标记和页面。

```
>>> import bs4
>>> my_string = "<p>this is some \n fun</p>And this is \n some more fun!"
>>> soup = bs4.BeautifulSoup(my_string)
>>> p = soup.p.contents[0].replace('\n ','')
>>> print p 
```

这将拉出 p 标签中的新行。如果内容有多个标签，`None`则可以使用 for 循环，然后收集子项（使用`tag.child`属性）。

例如：

```
>>> tags = soup.find_all(None)
>>> for tag in tags:
...    if tag.child is None:
...        tag.child.contents[0].replace('\n ', '')
...    else:
...        tag.contents[0].replace('\n ', '') 
```

虽然，这可能不会完全按照您想要的方式工作（因为网页可能会有所不同），但可以根据您的需要复制此代码。

# hadoop - 可以在 MR1 上使用 Hadoop 公平/容量调度程序吗？

> ID：14550289
> 
> 赞同：1
> 
> 时间：2013-01-27T17:53:18.820
> 
> 标签：hadoop, mapreduce, scheduling, hadoop-yarn

根据我的阅读，YARN (MRv2) 允许插入调度程序，替换默认的 FIFO 调度程序。我的问题是，我们可以在 MRv1 中做同样的事情吗？有没有办法在旧版本的 Hadoop 中替换 FIFO 调度程序，或者这是只有 YARN 提供的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:12:33.600

我在 0.20.x 版本的 Hadoop 中使用公平调度程序已有一段时间了，从未遇到任何问题。

您可以设置以下属性：

```
<property> 
  <name>mapred.jobtracker.taskScheduler</name> 
  <value>org.apache.hadoop.mapred.FairScheduler</value> 
</property> 
```

然后你可以去`http://<jobtracker URL>/scheduler`

有关如何在 MR1 中设置例如公平调度程序的更多详细[信息](http://archive.cloudera.com/cdh4/cdh/4/mr1/fair_scheduler.html)。

# reverse-engineering - 试图对十六进制转十进制函数进行逆向工程

> ID：14550291
> 
> 赞同：0
> 
> 时间：2013-01-27T17:53:43.600
> 
> 标签：reverse-engineering

我试图弄清楚我的游戏（Need for Speed: High Stakes）如何将玩家的钱从存储在文件中的十六进制值转换为玩家在启动游戏时看到的十进制值。

看着周围的数据，

```
0x30 00 00 00 00 00 00 00 00 00 00 00 00 00 E0 8B 46
0x40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
```

我已经能够找到存储在偏移量 3E 和 3F 处的影响值，但它们如何被视为十六进制值并转换为常规十进制值对我来说是一个谜。

在玩了一会儿十六进制值之后，我能够找到一个模式：

```
Hex    Decimal   
7B 46  16120
8B 46  17904
9B 46  19952
AB 46  22000 
```

有趣的是，AB、9B 和 8B 十进制值之间的差异是 2048（嗯，2 的幂...），虽然，就在我以为我已经开始破解它的时候，我发现 8B 和7B是1784年...

谁能看到这里的模式可能是什么？我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T01:02:18.823

事实证明，没有什么可以进行逆向工程......我只是不明白不同的数据类型是如何工作的 :) 货币价值实际上被存储为浮点数而不是整数。

我将从文件中获取样本值：

```
0x3C  00 38 7C 46 
```

如果您反转字节（以读取 467C3800），然后将其插入任何在线计算器，您将获得 16142.0 的合理值，这正是我使用该样本值寻找的值。

将浮点数存储为十六进制值的整个过程以及 IEEE-754 规范在[这个网站上](http://www.h-schmidt.net/FloatConverter/IEEE754.html)都有很好的描述。

我希望这可以帮助别人！

# scheme - 向 Racket 中的结构添加数据定义

> ID：14550294
> 
> 赞同：1
> 
> 时间：2013-01-27T17:53:57.820
> 
> 标签：scheme, racket

```
(define-struct animal (name species age breakfast-hour dinner-hour))  
(define-struct attendant (name a1 a2 a3))
(define attendant1 (make-attendant "Dave" 'gorillas 'bats 'mandrills ))
(define attendant2 (make-attendant "John" 'crocodiles 'ocelots 'capybara ))                                  
(define attendant3 (make-attendant "Joe" 'pottos 'tapirs 'vultures )) 
```

我将如何向这些添加数据定义？目前给我的所有这些都是“（例如;;动物是......）”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:05:00.107

首先定义结构：

```
(define-struct animal (name species age breakfast-hour dinner-hour))
(define-struct attendant (name a1 a2 a3)) 
```

然后，动物（因为您需要在将它们分配给服务员之前创建它们）：

```
(define gorilla (make-animal "Koko" "Gorilla" 4 8 10))
(define bat (make-animal "Bruce" "Bat" 1 23 5))
(define mandrill (make-animal "Manny" "Mandrill" 5 8 10))
(define crocodile (make-animal "Swampy" "Crocodile" 1 10 18))
(define ocelot (make-animal "Ozzy" "Ocelot" 7 7 17))
(define capybara (make-animal "Capy" "Capybara" 4 6 18))
(define potto (make-animal "Spot" "Potto" 2 2 6))
(define tapir (make-animal "Stripey" "Tapir" 3 10 17))
(define vulture (make-animal "Beaky" "Vulture" 10 9 19)) 
```

最后，您创建服务员，为每个男人或女孩提供相应的动物：

```
(define attendant1 (make-attendant "Dave" gorilla bat mandrill))
(define attendant2 (make-attendant "John" crocodile ocelot capybara))
(define attendant3 (make-attendant "Joe" potto tapir vulture)) 
```

请注意，为了创建服务员，我们必须引用之前定义的动物之一。

# php - 如何将上传的图像始终转换为 JPG 格式？

> ID：14550299
> 
> 赞同：9
> 
> 时间：2013-01-27T17:54:25.143
> 
> 标签：php

我只是上传：

$path = "上传/";

```
$actual_image_name = time().$session_id.".".$ext;
$tmp = $_FILES['photoimg']['tmp_name'];
move_uploaded_file($tmp, $path.$actual_image_name); 
```

我怎样才能添加这个功能imagejpeg？我想总是以 JPG 格式保存图像。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-27T18:22:15.940

试试这个：

```
<?php

$path = "uploads/";

$img = $_FILES['photoimg']['tmp_name'];
$dst = $path . $_FILES['photoimg']['name'];

if (($img_info = getimagesize($img)) === FALSE)
  die("Image not found or not an image");

$width = $img_info[0];
$height = $img_info[1];

switch ($img_info[2]) {
  case IMAGETYPE_GIF  : $src = imagecreatefromgif($img);  break;
  case IMAGETYPE_JPEG : $src = imagecreatefromjpeg($img); break;
  case IMAGETYPE_PNG  : $src = imagecreatefrompng($img);  break;
  default : die("Unknown filetype");
}

$tmp = imagecreatetruecolor($width, $height);
imagecopyresampled($tmp, $src, 0, 0, 0, 0, $width, $height, $width, $height);
imagejpeg($tmp, $dst.".jpg");

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:02:41.867

确保已安装 GD 库并使用它将 gif 或 png 转换为 jpg 之类的

```
 if ($_FILES["photoimg"]["type"] == "image/jpeg" || $_FILES["photoimg"]["type"] == "image/png" || $_FILES["photoimg"]["type"] == "image/gif" )
    {
      if ($_FILES["photoimg"]["type"] == "image/png" || $_FILES["photoimg"]["type"] == "image/gif" )
      {
       imagejpeg(imagecreatefromstring(file_get_contents($_FILES["photoimg"]["tmp_name"])), "converted.jpg");
       $actual_image_name = time().$session_id.".".$ext;
       move_uploaded_file("converted.jpg", $path.$actual_image_name);
      }
      else
      {
        $actual_image_name = time().$session_id.".".$ext;
        $tmp = $_FILES['photoimg']['tmp_name'];
        move_uploaded_file($tmp, $path.$actual_image_name);
      }
    } 
```

# xml - SVG id 的有效字符的 ISO 表

> ID：14550302
> 
> 赞同：4
> 
> 时间：2013-01-27T17:54:44.387
> 
> 标签：xml, unicode, svg, identifier

[SVG 规范](http://www.w3.org/TR/SVG/struct.html#IDAttribute)向读者介绍了XML [Base 规范](http://www.w3.org/TR/2008/REC-xml-20081126)，以了解可能出现在`id`属性值中的字符。

然而，XML Base 规范[并没有拼出](http://www.w3.org/TR/2008/REC-xml-20081126/#sec-suggested-names)这些字符，AFAICT。相反，它根据“Unicode 属性”`ID_Start`和`ID_Continue`.

我正在寻找一个*表*（或*表****s***）*明确*列出那些具有`ID_Start`和/或`ID_Continue`属性的字符。

（如果不同的应用程序或基于 XML 的标准可以使用`ID_Start`和/或`ID_Continue`属性指定他们自己的字符集，我对 HTML5 嵌入的 SVG 感兴趣。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-21T20:50:20.327

我在 Github 上找到了一个 repo，它使用基于 Unicode 标准的 Python 脚本生成了一堆不同的表。例如，这里有`ID_START`, `ID_CONTINUE`,`XID_START`等表`XID_CONTINUE`：[https ://github.com/sourtin/libucd/blob/master/src/tables/bool.rs](https://github.com/sourtin/libucd/blob/master/src/tables/bool.rs)

编辑：我认为它们是从以下提供的 XML 数据库中解析的：[http ://www.unicode.org/Public/5.2.0/ucdxml/](http://www.unicode.org/Public/5.2.0/ucdxml/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:09:36.253

似乎定义了允许的字符范围：

一个属性值为：

```
AttValue   ::= '"' ([^<&"] | Reference)* '"'
               |  "'" ([^<&'] | Reference)* "'" 
```

[http://www.w3.org/TR/2008/REC-xml-20081126/#NT-AttValue](http://www.w3.org/TR/2008/REC-xml-20081126/#NT-AttValue)

参考是：

```
Reference    ::=    EntityRef | CharRef 
```

[http://www.w3.org/TR/2008/REC-xml-20081126/#NT-Reference](http://www.w3.org/TR/2008/REC-xml-20081126/#NT-Reference)

CharRef 将我们带到这里的 Char：

```
Char   ::=    #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]    /* any Unicode character, excluding the surrogate blocks, FFFE, and FFFF. */ 
```

[http://www.w3.org/TR/2008/REC-xml-20081126/#NT-Char](http://www.w3.org/TR/2008/REC-xml-20081126/#NT-Char)

# ruby-on-rails - 创建操作在保存时忽略嵌套属性的 user_id

> ID：14550307
> 
> 赞同：0
> 
> 时间：2013-01-27T17:55:12.390
> 
> 标签：ruby-on-rails

使用 Rails 3.2。我有`shop`和的嵌套属性`photo`。`photo`应该有它，但是当`user_id`它被保存时，除了`user_id`被忽略/忽略之外，一切都被保存了。但这个`update`动作非常好。我的代码有什么问题？

```
# params[:shop]
{"utf8"=>"✓",
 "authenticity_token"=>"AtDD7EgDmX6uBIqdWwD3wwEGFg4tpCx28reWHHN1OmU=",
 "shop"=>{"name"=>"SNSD Hotel",
 "photos_attributes"=>[{"data"=>#<ActionDispatch::Http::UploadedFile:0x007ffd0449eb58 @original_filename="hotel-spa.jpg",
 @content_type="image/jpeg",
 @headers="Content-Disposition: form-data; name=\"shop[photos_attributes][][data]\"; filename=\"hotel-spa.jpg\"\r\nContent-Type: image/jpeg\r\n",
 @tempfile=#<File:/var/folders/5_/5rfbktcs6398t6kb7d387dr80000gn/T/RackMultipart20130128-2801-107zje1>>,
 "user_id"=>1}]},
 "commit"=>"Save"}

# spots_controller.rb
 def create
   @shop = Shop.new(params[:shop])

   photos = params[:shop][:photos_attributes]
   if !photos.blank?
     photos.each do |photo|
       photo.merge!(:user_id => current_user.id)
     end
   end

   abort(params[:shop].inspect) # for discussion purpose

   if @shop.save
     redirect_to shop_path(@shop)
   else
     render :action => :new
   end
 end

# shops/_form.html.erb
<%= form_for @shop, :url => { :action => action, :type => type }, :html => { :multipart => true } do |f| %>
  <%= f.text_field :name %>
  <h3>Pictures</h3>
  <%= f.file_field :shop_photos_data, :multiple => true, :name => "shop[photos_attributes][][data]", :accept => "image/*" %><br>
<% end %> 
```

**添加的模型代码**

```
# photo.rb
class Photo < ActiveRecord::Base
  belongs_to :attachable, :polymorphic => true, :counter_cache => true
  belongs_to :user, :counter_cache => true

  attr_accessible :data, :attachable_id, :attachable_type, :user_id
end

# shop.rb
class Shop < ActiveRecord::Base
  has_many :photos, :as => :attachable, :dependent => :destroy

  accepts_nested_attributes_for :photos
end

# user.rb
class User < ActiveRecord::Base
  has_many :photos, :as => :attachable, :dependent => :destroy
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T15:09:08.317

发布商店和照片的型号代码。你应该有类似...

```
class Shop < ActiveRecord::Base
  belongs_to :user
  has_many :photos
  accepts_nested_attributes_for :photos
...

class Photo < ActiveRecord::Base
  belongs_to :shop 
```

# java - 为 CustomView 创建适配器

> ID：14550309
> 
> 赞同：14
> 
> 时间：2013-01-27T17:55:23.660
> 
> 标签：java, android, adapter

我一直在尝试在网上寻找有关如何做到这一点的任何解决方案或示例，但无法找到任何类似于我的问题的东西。

当数据更改时，我有一个`LinearLayout`想要添加/删除的地方。`Views``ArrayList`

据我了解，唯一的方法是`CustomView`通过扩展`AdapterView`和使用来创建`ArrayAdapter`.

不幸的是，我不了解解决此问题的正确数据流。

我在哪里指定`CustomView`哪个 View 是容器？我可以`CustomView`在`LinearLayout`何时实施它吗？

编辑：我强调 - 我不需要`ListView`. 我需要它`CustomView`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T01:43:20.717

您无需扩展 AdapterView 即可从自定义视图中的适配器生成视图。您可以扩展`LinearLayout`和处理适配器。最简单的解决方案如下所示：

```
public class CustomAdapterView extends LinearLayout {

    private Adapter adapter;
    private final DataSetObserver observer = new DataSetObserver() {

        @Override
        public void onChanged() {
            refreshViewsFromAdapter();
        }

        @Override
        public void onInvalidated() {
            removeAllViews();
        }
    };

    public CustomAdapterView(Context context) {
        super(context);
    }

    public CustomAdapterView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public CustomAdapterView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public Adapter getAdapter() {
        return adapter;
    }

    public void setAdapter(Adapter adapter) {
        if (this.adapter != null) {
            this.adapter.unregisterDataSetObserver(observer);
        }
        this.adapter = adapter;
        if (this.adapter != null) {
            this.adapter.registerDataSetObserver(observer);
        }
        initViewsFromAdapter();
    }

    protected void initViewsFromAdapter() {
        removeAllViews();
        if (adapter != null) {
            for (int i = 0; i < adapter.getCount(); i++) {
                addView(adapter.getView(i, null, this), i);
            }
        }
    }

    protected void refreshViewsFromAdapter() {
        int childCount = getChildCount();
        int adapterSize = adapter.getCount();
        int reuseCount = Math.min(childCount, adapterSize);

        for (int i = 0; i < reuseCount; i++) {
            adapter.getView(i, getChildAt(i), this);
        }

        if (childCount < adapterSize) {
            for (int i = childCount; i < adapterSize; i++) {
                addView(adapter.getView(i, null, this), i);
            }
        } else if (childCount > adapterSize) {
            removeViews(adapterSize, childCount);
        }
    }
} 
```

由于上面的代码只是一个简单的例子，它没有处理适配器返回不同类型视图的情况（例如`Adapter#getViewTypeCount()`返回大于 1 的数字）。

当然，所有为添加/删除视图定义的 LinearLayout 方法都是可用的，因此它们可能会与您的适配器处理发生冲突。您可以通过抛出 UnsupportedOperationException 来禁用它们：

```
 @Override
    public void addView(View child) {
        throw new UnsupportedOperationException(
                "You cannot add views directly without adapter!");
    } 
```

（对于所有其他添加/删除方法等等），或者通过覆盖它们来操作适配器的支持数据集（应该强制实现您的自定义接口，允许在适配器接口旁边进行此类修改）。在这两种情况下，请记住在代码中从超类调用 add remove 方法来处理适配器。

编辑：以及扩展 LinearLayout 并支持适配器的 viewTypesCount 的简单实现：

```
class CustomAdapterViewTypedImpl extends LinearLayout {

    private Adapter adapter;
    private SparseArray<List<View>> typedViewsCache = new SparseArray<List<View>>();
    private final DataSetObserver observer = new DataSetObserver() {

        @Override
        public void onChanged() {
            refreshViewsFromAdapter();
        }

        @Override
        public void onInvalidated() {
            removeAllViews();
        }
    };

    public CustomAdapterViewTypedImpl(Context context) {
        super(context);
    }

    public CustomAdapterViewTypedImpl(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public CustomAdapterViewTypedImpl(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public Adapter getAdapter() {
        return adapter;
    }

    public void setAdapter(Adapter adapter) {
        if (this.adapter != null) {
            this.adapter.unregisterDataSetObserver(observer);
        }
        this.adapter = adapter;
        if (this.adapter != null) {
            this.adapter.registerDataSetObserver(observer);
        }
        initViewsFromAdapter();
    }

    protected void initViewsFromAdapter() {
        typedViewsCache.clear();
        removeAllViews();
        View view;
        if (adapter != null) {
            for (int i = 0; i < adapter.getCount(); i++) {
                view = adapter.getView(i, null, this);
                addToTypesMap(adapter.getItemViewType(i), view, typedViewsCache);
                addView(view, i);
            }
        }
    }

    protected void refreshViewsFromAdapter() {
        SparseArray<List<View>> typedViewsCacheCopy = typedViewsCache;
        typedViewsCache = new SparseArray<List<View>>();
        removeAllViews();
        View convertView;
        int type;
        for (int i = 0; i < adapter.getCount(); i++) {
            type = adapter.getItemViewType(i);
            convertView = shiftCachedViewOfType(type, typedViewsCacheCopy);
            convertView = adapter.getView(i, convertView, this);
            addToTypesMap(type, convertView, typedViewsCache);
            addView(convertView, i);
        }
    }

    private static void addToTypesMap(int type, View view, SparseArray<List<View>> typedViewsCache) {
        List<View> singleTypeViews = typedViewsCache.get(type);
        if(singleTypeViews == null) {
            singleTypeViews = new ArrayList<View>();
            typedViewsCache.put(type, singleTypeViews);
        }
        singleTypeViews.add(view);
    }

    private static View shiftCachedViewOfType(int type, SparseArray<List<View>> typedViewsCache) {
        List<View> singleTypeViews = typedViewsCache.get(type);
        if(singleTypeViews != null) {
            if(singleTypeViews.size() > 0) {
                return singleTypeViews.remove(0);
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T18:15:25.217

看看[AdapterView](http://bitgrind.com/android/android-4.1.1_r4/android/widget/AdapterView.html)的实现。对你来说，它主要是扩展 DataSetobserver 第 794 行。

只是给您一个粗略的想法，
1）在您的自定义视图类中创建扩展 DataSetObserver 的类。

2）从您的自定义视图中声明您自己的接口以获取视图/数据详细信息，并让您的 CustomAdapter 实现它。

3) 每当您的自定义中的 DatSetObserver 的 Array 调用 onChanged()/onInvalidated() 发生变化时。

如果您对 AdapterView 非常认真，请点击[此链接](http://developer.sonymobile.com/2010/05/20/android-tutorial-making-your-own-3d-list-part-1/)。

# c# - 如何在 C# 中删除 HtmlScriptElement

> ID：14550311
> 
> 赞同：1
> 
> 时间：2013-01-27T17:55:32.007
> 
> 标签：c#, removechild

如何以编程方式删除附加的 html 元素？

这是我的代码（我想删除 scriptEl，就像它从未存在过一样），任何到 Web 浏览器的 InvokeScript 都会导致错误或没有任何操作：

```
HtmlElement head = instance.webBrowser.Document.GetElementsByTagName("head")[0];
HtmlElement scriptEl = instance.webBrowser.Document.CreateElement("script");
IHTMLScriptElement element = (IHTMLScriptElement)scriptEl.DomElement; 
element.text = scriptText;
head.AppendChild(scriptEl); 
```

我一直在努力解决这个问题，但没有成功。从命令 InvokeScript 对脚本的每次调用都是有效的。应该存在像 RemoveChild 这样的函数。我怎样才能做到这一点？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:02:03.670

```
List<HtmlElement> toRemove = new List<HtmlElement>();
foreach (HtmlElement element in Form.Children)
{
    if (element.Id != string.Empty)
    {
        toRemove.Add(element);
    }
}
foreach (HtmlElement element in toRemove)
{
    Form.RemoveChild(element);
} 
```

# mysql - Mysql“如果存在则删除函数”失败，代码为 1305

> ID：14550320
> 
> 赞同：5
> 
> 时间：2013-01-27T17:55:53.490
> 
> 标签：mysql, sql-drop

当我尝试执行下面的代码时，我收到`mysql`错误 1305：

```
DROP FUNCTION IF EXISTS myFunction; 
```

只有当函数不存在时才会失败。但为什么？这不是重新创建函数之前的清理步骤吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T18:06:39.597

MySQL[错误 #33813](http://bugs.mysql.com/bug.php?id=33813)解释说这可能是由于区分大小写：

> 从 MySQL 5.0.52 开始，采用模式限定函数名称的 DROP FUNCTION 命令在区分大小写的基础上比较模式名称，即使 lower_case_table_names 设置为 1。这意味着函数没有正确识别。

# jquery - 通过 Stripe 提交信用卡信息并进行验证

> ID：14550341
> 
> 赞同：4
> 
> 时间：2013-01-27T17:58:11.570
> 
> 标签：jquery, validation, stripe-payments

我正在关注 Ryan Bates 的 Railscast 向 Stripe 提交付款。他删除了信用卡信息的 name 属性，这样信用卡信息就不会提交给服务器，只能通过 ajax 调用提交给 Stripe。

这与 jQuery Validation 不兼容，因为它需要一个 name 属性。

我最终决定重新使用 name 属性，但在 Stripe 回调中将其设置为 null。

我的问题是这是否仍然是一个好的、安全的做法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T18:34:44.963

我们建议不要将名称属性放在表单字段中的原因是，您可以确保输入永远不会提交到您的服务器。例如，如果在捕获表单提交事件的客户端代码中存在 JavaScript 错误，则可能会发生这种情况。

话虽如此，这只是一种预防措施，而不是要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:04:30.823

对于 PCI 自满，不建议通过 ajax 提交卡详细信息。我经常处理卡片处理，最好的做法是：

1.  确保 SSL 连接 (HTTPS) 上的页面
2.  使用普通形式的 POST 方法
3.  确保您的服务器配置符合 PCI 合规性要求
4.  从不存储卡的详细信息

您可以在此处阅读有关 PCI 合规性的更多信息：[http ://www.cisco.com/en/US/netsol/ns625/index.html](http://www.cisco.com/en/US/netsol/ns625/index.html)

请注意，如果您遵循适当的 PCI 合规性要求，处理卡详细信息的公司将毫无问题地成为 PCI 合规性。许多银行已经开始强制其客户按照必要的要求遵守 PCI 合规性。

# sql - 如何获取 mysql 查询的大小？

> ID：14550345
> 
> 赞同：0
> 
> 时间：2013-01-27T17:58:28.670
> 
> 标签：sql, mysqli

我想制作一个可以获得 mysql 查询大小的应用程序。例如，安装在不同应用程序服务器中的应用程序进行了此查询“从表中选择 *”...如何从数据服务器端获取此查询的大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:04:01.750

你说的大小是什么意思？获取的行数？在这种情况下，您需要使用：

```
mysqli_num_rows($result); 
```

`$result`是`mysqli_query("SELECT * FROM ``table``")`。_

* * *

或者如果你想知道返回行的长度，你需要使用`char_length`.

```
SELECT char_length(column1) FROM `table` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:04:03.807

您必须对所有结果集的长度求和：

```
select sum(row_size) 
from (
  select 
    char_length(column1)+
    char_length(column2)+
    char_length(column3)+
    .... /* for every columns */
  as row_size 
  from table1
) as tbl1; 
```

# core-data - 核心数据中父节点的并发类型和子节点的并发类型有什么限制？

> ID：14550350
> 
> 赞同：2
> 
> 时间：2013-01-27T17:58:55.110
> 
> 标签：core-data, concurrency

它们应该相同吗？父级有什么样的并发类型？

每次子执行executeFetchRequest 时，都会询问父级。如果来自不同线程的多个子进程执行相同类型的 executeFetchRequest 会怎样？

如果父级被声明为具有主并发类型，然后另一个线程上的子级执行executeFetchRequest，会发生什么？它会等到主线程运行，然后给出结果，然后继续线程吗？什么？

基本上我有各种等待锁定问题，我想了解更多。

实际上，如果网络上有关于多线程父子关系的常见做法的资源，我会感到震惊。在IOS5中我们需要做performBlock。我们是否需要在所有命令中为核心数据执行此操作，因为这意味着此处需要对代码进行大量更改。

更新：

[http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW1](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW1)已经过时了吧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:45:31.020

[使用父/子上下文的详细信息在核心数据发行说明](http://developer.apple.com/library/mac/#releasenotes/DataManagement/RN-CoreData/_index.html)文档中列出，其中指出：

> 因此，您不能使用使用线程限制类型创建的父上下文（请参阅[“托管对象上下文的并发支持”</a>）。](http://developer.apple.com/library/mac/releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-SW1)
> 
> [](http://developer.apple.com/library/mac/releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-SW1)

[](http://developer.apple.com/library/mac/releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-SW1)

[因此，要回答您的问题，父上下文必须具有](http://developer.apple.com/library/mac/releasenotes/DataManagement/RN-CoreData/_index.html#//apple_ref/doc/uid/TP40010637-CH1-SW1)[NSPrivateQueueConcurrencyType](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html#//apple_ref/c/econst/NSPrivateQueueConcurrencyType)或[NSMainQueueConcurrencyType](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html#//apple_ref/c/econst/NSMainQueueConcurrencyType)的并发类型。子上下文可以具有任何并发​​类型。

对于一个很好的概述和大量示例代码，我会查看[Marcus Zarra 的核心数据视频课程](http://ideveloper.tv/video/coredataupdatecourse.html)或[他的书的 beta 版本](http://pragprog.com/book/mzcd2/core-data)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:25:13.260

[除了WWDC 2012 视频](https://developer.apple.com/videos/wwdc/2012/?id=214)和关于父子上下文的[发行说明](http://developer.apple.com/library/mac/#releasenotes/DataManagement/RN-CoreData/_index.html)之外，Apple 没有发布任何真实文档。该视频非常详细地介绍了如何使用它们以及您可能需要使用 performBlock 或 performBlockAndWait 的极少数情况。

大多数人错过的重要一点是并发类型是指上下文将使用哪个线程来访问核心数据堆栈的其余部分，而不是创建上下文的线程。*只要您继续实现线程限制模式，*您几乎不需要在自己的代码中使用 performBlock 或 performBlockAndWait 。这样做通常会触发死锁（尤其是当一个或多个上下文是 NSMainQueueConcurrencyType 时）。

**NSMainQueueConcurrencyType** - 适用于 UI 中使用的 NSManagedObjects。您应该只维护其中之一。

**NSPrivateQueueConcurrencyType** - 适用于后台操作。从外部文件或 Web 服务导入新对象时，parentContext 是主要的 UI 上下文。当您完成创建对象时，`save`会自动通知 parentContext 更改。您还可以使用私有上下文作为 UI 上下文的父级，以便在不阻塞 UI 的情况下从磁盘加载和保存存储。

*因此，如果您创建子上下文并执行获取请求，它会使用线程（由并发类型指定）自动*与父上下文交互。它将自动适当地使用 performBlock。当您保存子上下文时，父上下文会自动获取合并的更改，而无需您对父上下文执行任何操作。

如果您必须使用 performBlock 或 performBlockAndWait，则不再使用线程限制模式。它在线程限制模式中唯一有效的情况是跨越“表亲”上下文，其中父级有多个子级，一个子级的更改保存到父级，父级将这些更改下推给其他子级。

# jquery - newsmap.jp 风格

> ID：14550351
> 
> 赞同：0
> 
> 时间：2013-01-27T17:58:58.357
> 
> 标签：jquery, html, css

我想做一个像[http://newsmap.jp](http://newsmap.jp)这样的网站，有没有插件可以在地图的 UI 中提供帮助？

请注意，其中没有空格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:00:17.877

查看[jQuery Masonry](http://masonry.desandro.com/)插件。只需直接在您的容器上调用它：

```
$('#container').masonry({
    itemSelector : '.itemsClassName',
    columnWidth : 240 // or whatever
}); 
```

[如文档](http://masonry.desandro.com/docs/options.html)中所述，还有更多选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-25T19:13:47.537

那是一个树形图， http: [//jstreemap.com/](http://jstreemap.com/)和[https://developers.google.com/chart/interactive/docs/gallery/treemap](https://developers.google.com/chart/interactive/docs/gallery/treemap)

# c# - 查询表达式中缺少（运算符）

> ID：14550354
> 
> 赞同：0
> 
> 时间：2013-01-27T17:59:03.523
> 
> 标签：c#, ms-access

Lid 是 ms 访问中的自动编号字段。错误消息：查询表达式“Lid=”中缺少（运算符）

```
db.Search_Grid_Add(LoanInfo_dgv, "Select * From Loan_Info Where Lid=" + LoanId_cb.Text + ""); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:00:27.153

也许`LoanId_cb.Text`不被解析为int？尝试：

```
int lid;
string lidText = LoanId_cb.Text.Trim();
if(int.TryParse(lidText , out lid))
{
    db.Search_Grid_Add(LoanInfo_dgv, "Select * From Loan_Info Where Lid="+lidText );
}
else
{
   MessageBox.Show(lidText + " can't be parsed as int.");
} 
```

# css - 图像神秘地忽略了 Firefox 和 IE 中的最大宽度

> ID：14550356
> 
> 赞同：36
> 
> 时间：2013-01-27T17:59:35.887
> 
> 标签：css, internet-explorer, firefox, responsive-design, max

所以我试图在不裁剪任何屏幕尺寸的情况下显示尽可能大的图像。这意味着`height: 100%; width: auto`in`landscape`和`width: 100%; height: auto`in `portrait`。

我正在提供足够大的图像以填充视网膜 iPad，因此几乎每个屏幕尺寸都会缩小图像。除了横向模式下的 Internet Explorer 和 Firefox 之外，它在所有浏览器和方向上都能做到这一点，这使得它们对于几乎每个屏幕来说都太大了。请注意，这仅在风景中。

相关的代码位是：

```
<style type="text/css">

            #container {position:absolute; top:0; left: 0; right: 0; bottom:0; display: block;}

            #content {
              text-align: center;
              margin: 0px;
                font-size:0;
                 position: absolute;
                top:0; left: 0; right: 0; bottom: 0
            }

            #content:before {
              content: '';
              display: inline-block;
              height: 100%; 
              vertical-align: middle;
              margin-right: -0.25em; 
             }

            .sponsor {
              display: inline-block;
              vertical-align: middle;
             }

             #content img {
                max-width: 100%;
                width: 100%;
                height:auto;
            } 
@media all and (orientation: landscape) {
                 #main {        
                    top:0;
                    display: block;  
                    width: 100%;
                    height: 100%;                       
                    margin:0px auto; 
                    text-align:center;
                     }

                    #content img {
                                height:100%;
                                width:auto;
                                max-width:auto !important;
                                max-height:100%;
                                display:block;
                                margin:0 auto;
                }

}
</style>

<div  id="content"> 
 <?php if (has_post_thumbnail( $post->ID ) ): ?>
 <?php $image = wp_get_attachment_image_src( get_post_thumbnail_id( $post->ID ), 'single-post-thumbnail' ); ?>              
         <div title="Click to flip" class="sponsor">

                 <a href="#" class="img-link"> 
                        <img src="<?php echo $image[0]; ?>" alt="" class="feat-1" style="display: block;" />
                    </a>

                     <a href="#"> 
                      <img src="<?php echo kd_mfi_get_featured_image_url('featured-image-2', 'post', 'full'); ?>" alt="" class="feat-2" style="display: none;" />
                    </a>

            </div><?php endif; ?>
</div><!-- End div #content --> 
```

我不太在意比 IE9 更早的版本，但理想情况下想为所有内容提供服务。但是，只要我能提供 IE9+ 和 Firefox，我就会很高兴。

哦，顺便说一句 - Firefox 中的 Inspector 告诉我`width:100%`正在遵守规则，但显然不是。

提前谢谢了！

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-29T07:57:29.927

你有`max-width: 100%`，但100%是什么？父宽度，对吧？但是父级是一个未设置宽度的内联块（class="sponsor"），因此它的宽度取决于子级，尤其是子级的首选宽度。

CSS 规范中未定义此样式的布局。特别是，在这种情况下，孩子的内在宽度取决于父母的宽度，而父母的宽度又取决于孩子的内在宽度。有关相关规范文本，请参阅[http://www.w3.org/TR/CSS21/visudet.html#shrink-to-fit-float](http://www.w3.org/TR/CSS21/visudet.html#shrink-to-fit-float)并注意所有“未定义”位。

我建议给你`<div class="sponsor">`一个宽度。我认为这应该解决问题。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-11-18T22:39:55.100

我的修复是双重的。当没有其他建议时，它起作用了。它仅使用 FF 定位、较旧的`width: 100%`修复程序和一个额外的实验属性。

为了让它工作，我做了以下工作：

```
@-moz-document url-prefix() {
    /* Firefox doesn't respect max-width in certain situations */
    img { width: 100%; max-width: -moz-max-content; }
} 
```

灵丹妙药是实验`-moz-max-content`值。结合`width: 100%`，它使 FF 的行为类似于 Safari/Chrome 的`max-width: 100%;`设置。

我从以下来源发现了这一点：

[http://ss64.com/css/max-width.html](http://ss64.com/css/max-width.html)

# firefox - 用于 Firefox 的 Selenium IDE Ctrl-Tab

> ID：14550360
> 
> 赞同：4
> 
> 时间：2013-01-27T17:59:50.273
> 
> 标签：firefox, selenium, ide, selenium-ide

我正在尝试从我打开到他们自己的选项卡中的列表中以多种形式自动化一些设置。在运行脚本之前准备页面的最简单方法是让它们全部打开。我打算让 selenium 完成对表单的更改，然后我希望它**`Ctrl`+`Tab`**到下一个。我将使用循环来设置计数。我目前有它以 HTML 格式录制，如果我需要将其调整为 java，或者我很乐意这样做。

我试图记录它，但没有成功。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T21:12:02.433

到目前为止，Selenium 中不支持选项卡。[一位 Selenium 开发人员最近的回答](https://stackoverflow.com/a/11358741/1273080)非常清楚地解释了这一点：

> Selenium 目前无法切换选项卡。因此，我们强制浏览器在新窗口中打开链接，但由于我们能够切换窗口，我们强制浏览器采用这种方法。这 **可能**会在以后的版本中修复。

此外，如果您离开 IDE（或将测试用例导出到 WebDriver）并使用更强大的工具（任何针对 Selenium 的全强度编程语言绑定），您可能会使用某种解决方法：

[https://stackoverflow.com/a/12730918/1273080](https://stackoverflow.com/a/12730918/1273080)（点击`Ctrl`+`2`进入第二个选项卡等）但是，这种解决方法通常仅限于特定的浏览器/操作系统/浏览器设置（可以禁用选项卡）。

* * *

也就是说，如果您不坚持使用选项卡而是使用多个浏览器窗口，那么这在 IDE 以及 Selenium RC 和 WebDriver 中相当容易：

Selenium IDE：（您可以通过[openWindow](http://release.seleniumhq.org/selenium-core/1.0/reference.html#openWindow)[`selectWindow`](http://release.seleniumhq.org/selenium-core/1.0/reference.html#selectWindow)生成一个新窗口）

硒 RC：[`selectWindow()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#selectWindow%28java.lang.String%29)

Selenium 网络驱动程序：[`switchTo().window()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.TargetLocator.html#window%28java.lang.String%29)

# android - Android 应用：处理在 Facebook 上发布的应用请求

> ID：14550361
> 
> 赞同：0
> 
> 时间：2013-01-27T17:59:50.777
> 
> 标签：android, facebook

我浏览了各种 Facebook[教程](https://developers.facebook.com/docs/howtos/androidsdk/3.0/app-link-requests/)来处理 Facebook 与 Native Android 应用程序的集成，并成功实现了所有流程，包括 Facebook 登录、获取用户详细信息、分享、选择朋友。我被困在用例中，其中一个用户发送的应用程序邀请请求是为收件人处理的。

**问题陈述：** Facebook[发送请求](http://developers.facebook.com/docs/howtos/androidsdk/3.0/send-requests/)教程很好地解释了向朋友发送应用程序请求，这对我来说很好，因为我可以看到成功响应如下。

```
fbconnect://success?request=<request ID here>&to%5B0%5D=<userID> 
```

但下一步是处理请求。根据教程，一旦收件人用户打开 Facebook for Android 应用程序并点击通知（我在左上角菜单 -> 应用程序部分下看到），该应用程序将使用包含请求数据的意图启动，如下所示。

```
Uri intentUri = getActivity().getIntent().getData(); 
```

可以获取更多请求 ID（一个或多个），如下所示

```
String requestIdParam = intentUri.getQueryParameter("request_ids"); 
```

在我的情况下，Facebook 应用程序启动已安装的应用程序，但 intentUri（上面列出的语句）本身返回为 null。因此，我无法继续进一步提取请求详细信息。

**注意：** *我可以确认发布的请求包含完整的信息，例如使用以下方法的数据，方法是传递发布时获得的硬编码 requestID（以接收用户身份登录应用程序后）。*

```
private void getRequestDetails(String inRequestId) {
        Request request = new Request(Session.getActiveSession(), 
            inRequestId, null, HttpMethod.GET, new Request.Callback() {
                @Override
                public void onCompleted(Response response) {
                Log.d (TAG, response.toString());
                }
            });
        // Execute the request asynchronously.
        Request.executeBatchAsync(request);
    } 
```

早期的帮助/指针将不胜感激。此外，有没有办法通过 Facebook API 查询待处理的应用程序请求，而不是通过 Facebook 原生应用程序意图调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T11:37:03.653

这是 Facebook 错误。只需在 App Dashboard 中添加**Mobile Web**，您将获得 request_ids

# python - Django 项目中不存在 manage.py

> ID：14550363
> 
> 赞同：11
> 
> 时间：2013-01-27T18:00:08.607
> 
> 标签：python, django

我刚刚开始 Django 教程。在运行命令时：

```
$django-admin.py startproject mysite 
```

mysite 项目已创建，但 mysite/ 下没有 manage.py 文件

我试图获得详细的输出：

```
$django-admin.py startproject -v 3 mysite 
/home/pratik/Source/Numerical/ETS/etsproxy/enthought/__init__.py:7: DeprecationWarning: enthought namespace imports are deprecated
  DeprecationWarning)
Rendering project template files with extensions: .py
Rendering project template files with filenames: 
Creating /home/pratik/Projects/django_learn/mysite/mysite/__init__.py
Creating /home/pratik/Projects/django_learn/mysite/mysite/urls.py
Creating /home/pratik/Projects/django_learn/mysite/mysite/settings.py
Creating /home/pratik/Projects/django_learn/mysite/mysite/wsgi.py 
```

我正在使用来自[git 存储库的最新 Django 源](https://github.com/django/django)

关于什么可能是错的任何想法？随着我的进展，我会用更多信息更新这篇文章。

更多信息：

```
$ python
Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

编辑：似乎 manage.py 只是 django-admin.py 的一个包装器，所以现在我至少可以继续学习本教程了

Edit2：我也尝试使用稳定的 1.4.3 版本，但仍然没有运气

```
$ django-admin.py version
1.4.3 
```

Edit3：这是输出`tree`：

```
$ tree
.
`-- mysite
    `-- mysite
        |-- __init__.py
        |-- settings.py
        |-- urls.py
        `-- wsgi.py

2 directories, 4 files 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-12-31T21:35:38.657

你可以手动创建你的 manage.py 吗？

把这段代码放在里面：

```
#!/usr/bin/env python
import os
import sys

if __name__ == "__main__":

    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "{{ project_name }}.settings")

    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

来源： [https ://github.com/django/django/blob/master/django/conf/project_template/manage.py](https://github.com/django/django/blob/master/django/conf/project_template/manage.py)

# python - 比较python中的列表以检测相等性

> ID：14550370
> 
> 赞同：6
> 
> 时间：2013-01-27T18:00:32.830
> 
> 标签：python, list, compare

首先，我是 python 编程的新手，并在其他问题上尝试了很多研究，但我找不到与此类问题相关的东西（所有其他问题都更高级）——那就是继续前进。

**需要的解决方案：** 遍历两个整数列表并比较是否相等。理想情况下，我希望它继续一遍又一遍地遍历列表，直到出现相等（在显示代码后详细介绍）。该数字将`list2`一遍又一遍地生成，直到相等。

**代码说明**：我有两个通过随机数生成生成的列表。列表的大小不相等。因此`list1`有 500 个条目，并且`list2`数量从 1 到 100 不等。

```
#current attempt to figure out the comparison. 
if (list1 = list2):
     print(equalNumber) 
```

也许我对循环不太了解，但我想让它循环遍历列表，我真的不知道从哪里开始。也许我没有使用像 for 循环或 while 这样的循环？

**这是我的号码生成器：**

```
 for i in range(0,500):
          randoms = random.randint(0,1000)
          fiveHundredLoop.append(randoms) 
```

第二个会做一些，但只会有 1 到 100 之间的不同条目。{我可以自己处理这个}

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T18:09:16.097

您的问题有几种可能的解释。

1) 成对循环列表，当一对相等时停止：

```
>>> s = [10, 14, 18, 20, 25]
>>> t = [55, 42, 18, 12, 4]
>>> for x, y in zip(s, t):
        if x == y:
            print 'Equal element found:', x
            break

Equal element found: 18 
```

2) 遍历一个列表，当任何元素等于第一个列表中的*任何其他*元素时停止。这是集合很有用的情况（它们进行快速的成员资格测试）：

```
>>> s = {18, 20, 25, 14, 10}
>>> for x in t:
        if x in s:
            print 'Equal element found', x
            break

Equal element found 18 
```

3）循环遍历两个类似的元素并比较它们的值：

```
>>> s = [10, 14, 18, 20, 25]
>>> t = [55, 42, 18, 12, 4]
>>> [x==y for x, y in zip(s, t)]
[False, False, True, False, False] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-27T18:04:51.470

这是集合的工作：

```
>>> l1 = [1,2,3,4,5]
>>> l2 = [5,6,7,8,9]
>>> set(l1) & set(l2)
{5} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T18:08:12.640

如果你不想使用 set

```
a = [1,2,3]
b = [3,2,4,5]
c = [i for i in a if i in b] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:25:02.613

假设列表为 list1 和 list2。list1 有 500 个条目，值从 0 到 1000，来自随机生成器代码。list2 有 x 个条目 x 不是 500。它可以大于 500 或小于 500。从问题中不清楚，并且值在 1 到 100 的范围内。

```
// This will return the matching one.  
set(list1).intersection(set(list2)) 
```

# c - 如何将文件中的数据读入二维数组？

> ID：14550371
> 
> 赞同：-1
> 
> 时间：2013-01-27T18:00:42.220
> 
> 标签：c, multidimensional-array, file-handling

> **可能重复：**
> [从文本文件中读取字符并存储在二维数组中](https://stackoverflow.com/questions/12887497/reading-characters-from-a-text-file-and-storing-in-a-2d-array)

我想知道如何将 txt 文件中的数据读取到二维数组中。要求是：- 1\. 第一行有一个需要分配给变量的数字。2\. 必须将后面的行读入二维数组，这样每次在行中遇到“\n”时，都将获取下一行并输入数据。这需要在达到 EOF 之前完成。文件处理对我来说有点复杂，因此我遇到了问题。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:21:20.600

使用 fscanf。这就是你需要知道的。在您发布问题之前请谷歌。

# php - 车把的上下文是一个对象吗？

> ID：14550374
> 
> 赞同：1
> 
> 时间：2013-01-27T18:00:50.647
> 
> 标签：php, jquery, handlebars.js

我将来自数据库的响应编码为 json，得到一个具有这种结构的 json，我使用 json_encode 从控制器发送回声（我在 php 中工作）：

```
[
{column1: value, column2: value...}            //row 1
{column1: value, column2: value...}            //row 2
....                                           //row n
] 
```

我的脚本（我在车把中的模板）是：

```
<script id="handlebars_deals_list" type="text/x-handlebars-template">
    {{#each data}}
        {{tittle}}
    {{/each}}
</script> 
```

我以这种方式传递了上下文：

```
var source=jQuery('#handlebars_deals_list').html(); 
var template = Handlebars.compile(source);
var context={data:response};//response is the json data I showed earlier
console.log(context); //Object{data="\n[{"id":"149417","biz_n......null,"index_deal":"0"}]"}
var html=template(context);
console.log(html); //empty!!?!?!?!!?!?!?!?!, why???? 
```

但我没有看到任何模板呈现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:28:59.607

在与这个问题打了一会儿之后，我有了解决方案：

```
function process_deals_date(response){
    var response=jQuery.parseJSON(response); //THIS IS THE KEY
    var source=jQuery('#my_template').html(); 
    var template = Handlebars.compile(source);
    Var html=template(response);            
    console.log(html);      //RIGHT POPULATED THE TEMPLATE 
```

}

# c++ - 没有删除操作符的指针类型

> ID：14550376
> 
> 赞同：1
> 
> 时间：2013-01-27T18:01:05.750
> 
> 标签：c++, smart-pointers

是否可以构造一个指针类型，其行为和行为（就语法而言）像普通指针一样，除了你不能对它调用 delete （可能使用预处理器宏）？

示例用法：

```
borrowed_ptr<int> ptr = new int[42]; 

ptr[12] = 1;
cout<<ptr[12]<<endl; //prints 1

delete ptr; //error: no operator delete for borrowed_ptr<int>

borrowed_ptr<int> ptr2 = new int(2);
delete ptr2; //error 
```

这也应该工作

```
template<typename t>
void func(borrowed_ptr<t> *arg)
{
   delete arg; //error
}

//somewhere else
int *t = new *int;
func(t); 
```

但是，“反向分配”不应该起作用。

```
borrowed_ptr<int> foo = new int(2);
int* bar = foo; //error 
```

声明借用_ptr 时是否需要 * 对我来说并不重要。像这样的代码很重要

```
template <typename T>
void foo(T* whatever)
{
    //do something with whatever
   delete whatever; 
}

template <typename T>
void bar(T* whatever)
{
    //do something with whatever
} 
```

可以像这样使用这个 borrowed_ptr 调用：

```
borrowed_ptr<int> a = new int(2);
foo(a); //error, function tries to delete
bar(a); //fine, and has the same semantics as handing over a raw int* 
```

注意：当指针类型为删除本身时，我不希望删除数据。它应该只是一个借来的ptr，因为它属于别人，所以不能删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:09:08.587

`delete`运算符需要内置指针类型，因此任何*智能*指针都可以解决问题。大多数常用功能都有一些附加功能，您可能想要也可能不想要；如有必要，自己编写并不难；只需将指针包装在一个类中，该类为一元运算符`*`和提供重载`->`。模板化的伪复制构造函数和赋值运算符也可以提供隐式类型转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:10:17.240

是的，您可以使用`std::unique_ptr`. 不要忘记为此包括`<memory>`：

```
#include <memory>

int main() {
   std::unique_ptr<int[]> a(new int[2] {1, 2, ...});

   a[1]; // 2
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:29:43.987

大多数问题源于对热学的不当使用：**您没有删除指针，而是删除了它们指向的内容。**

此时，您需要一个模仿指针的对象，因此，据我所知，您的第一行应该是

```
borrowed_ptr<int> ptr = new int[42]; 
```

而不是`borrowed_ptr<int> *ptr = new int[42];`。这使得`ptr`它成为一个“堆栈对象”，不能对其调用删除。

为了`borrowed_ptr`

```
template<class T>
class borrowed_ptr
{
public:
    borrowed_ptr() :p() {}
    explicit borrowed_ptr(T* p_) :p(p_) {}

    T* operator->() const { return p; } //don't include this operator if just want an array-like behavior
    T& operator*() const { return *p; } p; } //don't include this operator if just want an array-like behavior
    T& operator[](int x) const { return p[x]; }

private:
    T* p; //< here is where pointer lives
}; 
```

这就是所有需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:03:49.097

在 google 上查看 C++ 中智能指针的各种实现。有很多很好的例子可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T18:04:24.970

我猜你真正想要的是[std::shared_ptr](http://en.cppreference.com/w/cpp/memory/shared_ptr)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-27T18:04:57.773

你可以使用 a`unique_ptr`来达到这个目的：

```
unique_ptr<int[]> ptr(new int[10]); 
```

无需调用`delete[]`，无法调用`delete`（没有隐式转换为封装的指针类型）并且提供了下标运算符的重载：

```
cout << ptr[1]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-02T08:50:56.613

您想要的是一个没有引用计数的非拥有“智能”指针，并且允许指针算术。

从 C++17 开始，标准库中没有这种类型。最接近的等价物¹是建议的² [`std::experimental::observer_ptr`](https://en.cppreference.com/w/cpp/experimental/observer_ptr)，但是它在设计上不允许指针算术，原因与您希望禁止“删除”的原因相同：它容易出错。标准库中唯一的其他非拥有智能指针是[`std::weak_ptr`](https://en.cppreference.com/w/cpp/memory/weak_ptr)，尽管它执行引用计数并要求拥有者使用[`std::shared_ptr`](https://en.cppreference.com/w/cpp/memory/shared_ptr)它来管理其生命周期，并且也不允许指针算术。

你必须自己实现它，幸运的是这很简单。您可以从 的[实现](https://github.com/martinmoene/observer-ptr/blob/master/include/nonstd/observer_ptr.h)开始`observer_ptr`，然后添加 for`operator[]`和其他算术运算符的重载。

但是，请注意，对于指向资源的非拥有指针，简单地使用原始指针（或引用）通常被认为是更好的做法，或更“惯用的 C++”。例如，请参阅有关资源管理的[C++ 核心指南。](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#r-resource-management)这使它保持简单，避免代码混乱，并增加互操作性（如常量，智能指针倾向于“感染”代码的其他部分）。原始指针确实有点容易出错，但大多数错误都可以通过静态代码分析来发现。话虽如此，我同意非拥有智能指针在适当使用时有其用例。

¹太接近了，事实上，有人主张`borrowed_ptr`在[这个线程中重命名它](https://www.reddit.com/r/cpp/comments/80xm9g/stdobserver_ptr_should_be_renamed_stdptr/)

²[在此处](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4282.pdf)查看建议

# for-loop - 使用for循环向后获取字符串，Python

> ID：14550377
> 
> 赞同：0
> 
> 时间：2013-01-27T18:01:13.287
> 
> 标签：for-loop, python-3.x

我发现这个以前在这里回答过，[Best way to loop over a python string backwards](https://stackoverflow.com/questions/7961499/best-way-to-loop-over-python-string-backward)

我需要使用OP的原始想法，但是我不太明白range函数中stop参数的含义。0-1 是什么意思？从0-1？这不就是一步吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:08:01.860

为什么不能在先前回答的问题中使用 reversed as 接受？

但是，要回答您的原始问题：

0-1实际上只是一个数字0-1，等于-1

range 的文档说明如下：`range(start[, end[, step]])`. 他的调用如下所示：`range(len(string)-1, 0-1, -1)`

**start** = `len(string)-1`，这是字符串的最后一个字母。

**end** =`0-1`等于`-1`，所以要处理的最后一个字母是`0`。请记住，`range(0, 3)`实际上会`0, 1, 2`在`3`. 负数也是如此，它会在 之前停止`-1`，所以它会在 停止`0`。

**步**= `-1`。Step 代表一次要跨过多少个数字。`-1`意味着它`i`每次都会降低一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:12:20.257

0-1 是-1，它可以写成任何一种方式：

```
>>> -1
-1
>>> 0-1
-1 
```

让我们尝试一个长度为 10 的字符串，停止 0-1 广告步长 -1：

```
>>> range(10, 0-1, -1)
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0] 
```

您会看到使用 -1 而不是 0-1 的相同结果：

```
>>> range(10, -1, -1)
[10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0] 
```

步长 -1 导致范围倒数，让我们尝试步长 1：

```
>>> range(10, 0-1, 1)
[] 
```

有疑问时，把它拿出来

# javascript - Codeigniter 中的 Ajax 不适用于远程主机中的特定控制器

> ID：14550387
> 
> 赞同：0
> 
> 时间：2013-01-27T18:02:07.913
> 
> 标签：javascript, ajax, codeigniter, jquery, codeigniter-2

我的 Web 应用程序向远程服务器中的 Codeigniter-php 代码发出 Ajax 请求。它适用于本地主机，但不适用于远程主机中的特定控制器。这很奇怪，因为两个控制器都在 localhost 中工作。请求：

```
$.ajax({
    async:true,
    type: "POST",
    dataType: "json",  
    url:"/CI/site/index.php/contact/submitContact",
    data: "", //data example 
    success:arrived,
    error:problems }); 

function arrived(data){
    var dataJson = eval(data);                       
}
function problems(){            
    $("#result").text('Problems.');     
} 
```

我检查到了`log_message`。使用下一个功能可以正常工作：

```
 function submitContact(){
     log_message('error', 'submitContact. ');
    //If data are received
    if($_POST){
            log_message('error', 'data. [application/controllers/contact.php]');
        }   
    } 
```

但是，如果我将请求更改为`url:"/CI/site/index.php/control/controlHome"`，则没有任何日志消息，输出如下： `POST http://www.page.com/CI/site/index.php/control/controlHome 500 (Internal Server Error)`

函数`/application/controllers/control.php`如下：

```
 function controlHome(){
    log_message('error', 'controlHome. [application/controllers/control.php]');
    //If data are received
    if($_POST){
         log_message('error', 'data. [application/controllers/control.php]');
    }   
 } 
```

我也尝试过在 ajax 代码中使用完整的 url，但结果是一样的。需要什么设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:19:02.473

用codeigniter 2检查这个AJAX csrf保护。这解决了我同样的问题

[http://aymsystems.com/ajax-csrf-protection-codeigniter-20](http://aymsystems.com/ajax-csrf-protection-codeigniter-20)

更新：我在我的测试服务器上检查了你的 control.php 文件。

```
if($_POST) { /* i only commented gangway library functions  */
} else { /* only replace the load->view with an print_r $data; and its work */ } 
```

并对构建的舷梯库发表评论。并且 control/controlHome 正常工作，没有任何错误。检查导致错误 500 的舷梯库。

# scala - 我应该默认使用 GenSeq 吗？

> ID：14550388
> 
> 赞同：7
> 
> 时间：2013-01-27T18:02:15.363
> 
> 标签：scala, collections

将 GenSeq 用作“默认”集合类型是否是最佳实践？它似乎是最通用的集合接口。但是我没有看到它在代码示例中被广泛使用（而是使用更具体的 Seq）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T20:43:00.303

不，应该出现在 API 中的最通用的集合类型是：

*   `Seq`— 顺序收集
*   `Set`— 数学集（无重复值）
*   `Map`— 关联/关联集（概念上与离散`PartialFunction`s 相同）

与上述区别无关的唯一抽象是`Traversable`和`Iterable`。（例如`Map[K, V]`，两者都是`Iterable[(K, V)]`和`Traversable[(K, V)]`。

如果对一个实际参数来说最重要的是它的元素可以以某种（未指定的）顺序检查，然后`Traversable`捕获该特征。

包含“Like”、“Once”或“Gen”的类或特征名称是使 Scala 集合表现出“最小意外原则”的内部魔法的一部分（其中最主要的是在它们上调用 HOF 的属性，例如`map`或`filter`产生一个与调用该 HOF 的集合匹配的具体类型的结果）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-06-11T08:00:18.573

请注意，您不再需要`GenSeq`Scala [2.13 (June 2019)](https://github.com/scala/scala/releases/tag/v2.13.0)，因为 Parallel 集合现在是一个单独的模块：[`scala/scala-parallel-collections`](https://github.com/scala/scala-parallel-collections)

所以没有更多`GenSeq`（或任何`Genxxx`）

> 要依赖 sbt 中的 scala-parallel-collections，请将其添加到您的 build.sbt：

```
libraryDependencies +=
  "org.scala-lang.modules" %% "scala-parallel-collections" % "0.2.0" 
```

> 在您的代码中，添加此导入：

```
import scala.collection.parallel.CollectionConverters._ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-11T07:10:40.373

是的。Seq 用于序列的非并行（Sequential）集合。

GenSeq 是平行序列和正常序列之间的共同特征。

ParSeq 是使用并行性实现的非顺序序列（双关语）。

GenSeq 中缺少一些方法（如包含），但根据我的经验，它们是手动实现的（您可以尝试查看 Seq 中的实现）。

来源：[https ://docs.scala-lang.org/overviews/parallel-collections/architecture.html](https://docs.scala-lang.org/overviews/parallel-collections/architecture.html)

关于 scala 集合（非并行集合）的另一个好页面：[https ://docs.scala-lang.org/overviews/core/architecture-of-scala-collections.html](https://docs.scala-lang.org/overviews/core/architecture-of-scala-collections.html)

# javascript - 在javascript中检查颜色值

> ID：14550394
> 
> 赞同：1
> 
> 时间：2013-01-27T18:03:35.027
> 
> 标签：javascript, html, css, colors

所以我设置了颜色`<body>`：

```
body
{
    color:Black;
} 
```

在`<head>`and`<style>`标记中，然后我在正文中有各种元素，如果我单击它们，它们会调用一个函数。IE

```
 <p id="CSE1020" onclick="prereq(this)">CSE1020</p> 
```

prereq 函数如下：

```
function prereq(code) {

    if (code.style.color != "black") {
        code.style.color = "black";
        code.style.fontWeight = "normal";
    }
} 
```

否则，如果元素已经是黑色，我会更改颜色。问题/问题是：我必须在元素改变颜色之前单击两次。换句话说，它最初不是“黑色”的。if 语句被执行，即使默认颜色在被点击之前应该是黑色的。当我第一次单击元素时，如何让它识别出它是“黑色”的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:28:04.037

尝试在 CSSRules 中搜索：

```
function prereq(code) {
    var cssRules = window.getMatchedCSSRules(code);
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T21:21:23.843

因此，当我将样式添加到元素本身时它会起作用，即

```
 <p id="CSE1020" style="color:black" onclick="prereq(this)">CSE1020</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:15:29.110

jQuery是一个选项吗？如果是你可以这样做：http: [//jsfiddle.net/CxayY/](http://jsfiddle.net/CxayY/)

```
$('#CSE1020').on('click', function(){
    if($('body').css('color')!='black')
    {
        $('body').css('color','black');
        $('body').css('font-weight','normal');
    }
}); 
```

# multithreading - `getErrno` 和线程

> ID：14550395
> 
> 赞同：8
> 
> 时间：2013-01-27T18:03:35.927
> 
> 标签：multithreading, haskell, ghc, errno

文档[`getErrno`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Foreign-C-Error.html#v:getErrno)内容如下：

> 获取当前线程中errno的当前值。

我不清楚这是否意味着当前的*操作系统*线程。特别是，`errno`当 Haskell 线程从一个 OS 线程迁移到另一个时，（线程）运行时是否会获取并隐藏？

[这个问题](https://stackoverflow.com/questions/10497765/how-to-get-the-errno-from-an-ioerror-in-haskell)似乎是相关的，但我不清楚那里所说的是否与操作系统或 Haskell 线程有关。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T23:22:45.070

至少对于最新版本的 GHC，运行时保存`errno`在线程存储对象 ( `TSO`) 中，并在将运行时线程迁移到另一个 OS 线程时负责管理它。`errno`这意味着在 unbound ( `forkIO`) 和 bound ( `forkOS`) 线程中依赖应该是安全的。这是针对 Linux 的测试：

`err.hs`

```
import Control.Concurrent
import Control.Exception
import Foreign.C

foreign import ccall safe get_ostid :: IO CUInt
foreign import ccall safe sleep :: CUInt -> IO CUInt
foreign import ccall unsafe get_errno :: IO CInt
foreign import ccall unsafe set_errno :: CInt -> IO ()

forkIO' f = do
  done <- newEmptyMVar
  forkIO (f `finally` putMVar done ())
  return (takeMVar done)

prefix = do
  id <- get_ostid
  return $ show id ++ ": "

main = do
  wait <- forkIO' $ do -- spawn a lightweight thread
    errno <- get_errno
    (putStr =<< prefix) >> putStrLn ("outer errno is " ++ show errno)
    (putStr =<< prefix) >> putStrLn "Setting outer errno to 3"
    set_errno 3
    wait' <- forkIO' $ do -- spawn another lightweight thread
      errno <- get_errno
      (putStr =<< prefix) >> putStrLn ("inner errno is " ++ show errno)
      (putStr =<< prefix) >> putStrLn "Setting inner errno to 2"
      set_errno 2
      sleep 2 -- force this lightweight thread to tie up the OS thread
      errno <- get_errno
      (putStr =<< prefix) >> putStrLn ("inner errno is " ++ show errno)
    threadDelay 1000000 -- wait a second
    -- By now, we should be in another OS thread.
    errno <- get_errno
    (putStr =<< prefix) >> putStrLn ("outer errno is " ++ show errno)
    wait'
  wait 
```

`err.c`

```
#include <errno.h>
#include <sys/syscall.h>
#include <unistd.h>

int get_errno(void) { return errno; }
void set_errno(int e) { errno = e; }

unsigned get_ostid(void) {
  return syscall(SYS_gettid);
} 
```

编译：

```
ghc -o err -threaded err.hs err.c 
```

结果应该类似于：

```
12282: outer errno is 0
12282: Setting outer errno to 3
12282: inner errno is 0
12282: Setting inner errno to 2
12283: outer errno is 3
12282: inner errno is 2 
```

操作系统线程 ID 打印在每行的开头。请注意，`errno`已`3`迁移到第二个 OS 线程 ( `12283`)。

# javascript - jQuery Mobile：动态添加内容的标记增强

> ID：14550396
> 
> 赞同：77
> 
> 时间：2013-01-27T18:03:45.823
> 
> 标签：javascript, jquery, html, cordova, jquery-mobile

我想知道如何动态增强 jQuery Mobile 页面？

我曾尝试使用这些方法：

1.  `$('[data-role="page"]').trigger('create');`

    和

2.  `$('[data-role="page"]').page();`

另外，我怎样才能防止仅对复选框进行增强标记？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2013-01-27T18:05:47.043

## 免责声明：

这篇文章也可以作为我博客的一部分在**[这里](http://www.gajotres.net/jquery-mobile-and-how-to-enhance-the-markup-of-dynamically-added-content/)**找到。

## 介绍：

有几种方法可以增强动态创建的内容标记。仅仅动态地向**jQuery Mobile**页面添加新内容是不够的，必须使用经典的**jQuery Mobile**样式来增强新内容。因为这是处理繁重的任务，所以需要一些优先级，如果可能的话，**jQuery Mobile**需要做的增强尽可能少。如果只需要设置一个组件的样式，则不要增强整个页面。

这一切意味着什么？当页面插件调度**pageInit**事件时，大多数小部件使用该事件来自动初始化自己。它会自动增强它在页面上找到的小部件的任何实例。

但是，如果您在客户端生成新的标记或通过 Ajax 加载内容并将其注入页面，则可以触发 create 事件来处理新标记中包含的所有插件的自动初始化。这可以在任何元素（甚至是页面 div 本身）上触发，从而为您节省手动初始化每个插件（listview 按钮、选择等）的任务。

考虑到这一点，让我们讨论增强级别。其中有三个，它们从资源需求较低到较高的排序：

1.  增强单个组件/小部件
2.  增强页面内容
3.  增强整页内容（页眉、内容、页脚）

## 增强单个组件/小部件：

> **重要提示：**以下增强方法仅用于当前/活动页面。对于动态插入的页面，这些页面及其内容在插入 DOM 后将得到增强。在动态创建的页面/活动页面之外调用任何方法都会导致错误。

每个**jQuery Mobile**小部件都可以动态增强：

1.  [**列表视图**](http://api.jquerymobile.com/listview/)：

    标记增强：

    ```
    $('#mylist').listview('refresh'); 
    ```

    删除列表视图元素：

    ```
    $('#mylist li').eq(0).addClass('ui-screen-hidden'); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/LrAyE/](http://jsfiddle.net/Gajotres/LrAyE/)

    *请注意，refresh() 方法仅影响附加到列表的新节点。这样做是出于性能原因。*

    listview 的一大亮点是过滤功能。不幸的是，由于某种原因，jQuery Mobile 无法动态地将过滤器选项添加到现有的列表视图中。幸运的是，有一个解决方法。如果可能，删除当前列表视图并添加另一个打开了文件管理器选项的列表视图。

    这是一个工作示例：[https ://stackoverflow.com/a/15163984/1848600](https://stackoverflow.com/a/15163984/1848600)

    ```
    $(document).on('pagebeforeshow', '#index', function(){       
        $('<ul>').attr({'id':'test-listview','data-role':'listview', 'data-filter':'true','data-filter-placeholder':'Search...'}).appendTo('#index [data-role="content"]');
        $('<li>').append('<a href="#">Audi</a>').appendTo('#test-listview');
        $('<li>').append('<a href="#">Mercedes</a>').appendTo('#test-listview');
        $('<li>').append('<a href="#">Opel</a>').appendTo('#test-listview');
        $('#test-listview').listview().listview('refresh');
    }); 
    ```

2.  [**按钮**](http://api.jquerymobile.com/button/)

    标记增强：

    ```
    $('[type="button"]').button(); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/m4rjZ/](http://jsfiddle.net/Gajotres/m4rjZ/)

    还有一件事，你不需要使用输入元素来创建一个按钮，它甚至可以用一个基本的 div 来完成，这里有一个例子：http: [//jsfiddle.net/Gajotres/L9xcN/](http://jsfiddle.net/Gajotres/L9xcN/)

3.  [**导航栏**](http://api.jquerymobile.com/navbar/)

    标记增强：

    ```
    $('[data-role="navbar"]').navbar(); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/w4m2B/](http://jsfiddle.net/Gajotres/w4m2B/)

    这是一个演示如何添加动态导航栏选项卡：http: [//jsfiddle.net/Gajotres/V6nHp/](http://jsfiddle.net/Gajotres/V6nHp/)

    还有一个在**pagebeforecreate**事件中：http: [//jsfiddle.net/Gajotres/SJG8W/](http://jsfiddle.net/Gajotres/SJG8W/)

4.  [**文本输入、搜索输入和文本区域**](http://api.jquerymobile.com/textinput/)

    标记增强：

    ```
    $('[type="text"]').textinput(); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/9UQ9k/](http://jsfiddle.net/Gajotres/9UQ9k/)

5.  [**滑块和翻转拨动开关**](http://api.jquerymobile.com/slider/)

    标记增强：

    ```
    $('[type="range"]').slider(); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/caCsf/](http://jsfiddle.net/Gajotres/caCsf/)

    pagebeforecreate 事件期间的增强示例：http: [//jsfiddle.net/Gajotres/NwMLP/](http://jsfiddle.net/Gajotres/NwMLP/)

    动态创建滑块有点麻烦，请在此处阅读更多信息：[https ://stackoverflow.com/a/15708562/1848600](https://stackoverflow.com/a/15708562/1848600)

6.  [**复选框和单选框**](http://api.jquerymobile.com/controlgroup/)

    标记增强：

    ```
    $('[type="radio"]').checkboxradio(); 
    ```

    或者如果您想选择/取消选择另一个 Radiobox/Checkbox 元素：

    ```
    $("input[type='radio']").eq(0).attr("checked",false).checkboxradio("refresh"); 
    ```

    或者

    ```
    $("input[type='radio']").eq(0).attr("checked",true).checkboxradio("refresh"); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/VAG6F/](http://jsfiddle.net/Gajotres/VAG6F/)

7.  [**选择菜单**](http://api.jquerymobile.com/select/)

    标记增强：

    ```
    $('select').selectmenu(); 
    ```

    增强示例：http: [//jsfiddle.net/Gajotres/dEXac/](http://jsfiddle.net/Gajotres/dEXac/)

8.  [**可折叠**](http://api.jquerymobile.com/collapsible/)

    不幸的是，可折叠元素无法通过某些特定方法增强，因此必须使用 trigger('create') 代替。

    增强示例：http: [//jsfiddle.net/Gajotres/ck6uK/](http://jsfiddle.net/Gajotres/ck6uK/)

9.  [**桌子**](http://api.jquerymobile.com/table-reflow/)

    标记增强：

    ```
    $(".selector").table("refresh"); 
    ```

    虽然这是一种标准的表格增强方式，但目前我无法让它发挥作用。所以改为使用触发器（'create'）。

    增强示例：http: [//jsfiddle.net/Gajotres/Zqy4n/](http://jsfiddle.net/Gajotres/Zqy4n/)

10.  **[面板](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/panels/)**-*新*

    面板标记增强：

    ```
    $('.selector').trigger('pagecreate'); 
    ```

    *动态添加*到面板的内容的标记增强：

    ```
    $('.selector').trigger('pagecreate'); 
    ```

    示例：http: [//jsfiddle.net/Palestinian/PRC8W/](http://jsfiddle.net/Palestinian/PRC8W/)

## 增强页面内容：

如果我们正在生成/重建整个页面内容，最好一次完成，可以这样做：

```
$('#index').trigger('create'); 
```

增强示例：http: [//jsfiddle.net/Gajotres/426NU/](http://jsfiddle.net/Gajotres/426NU/)

## 增强整页内容（页眉、内容、页脚）：

不幸的是，trigger('create') 不能增强页眉和页脚标记。在这种情况下，我们需要大枪：

```
$('#index').trigger('pagecreate'); 
```

增强示例：http: [//jsfiddle.net/Gajotres/DGZcr/](http://jsfiddle.net/Gajotres/DGZcr/)

**这几乎是一种神秘的方法，因为我在官方jQuery Mobile**文档中找不到它。仍然很容易在**jQuery Mobile**错误跟踪器中找到它，并警告不要使用它，除非它真的很有必要。

注意，**.trigger('pagecreate');** 可以假设每次页面刷新只使用一次，我发现它是不真实的：

[http://jsfiddle.net/Gajotres/5rzxJ/](http://jsfiddle.net/Gajotres/5rzxJ/)

## 3rd 方增强插件

有几个 3rd 方增强插件。有些是对现有方法的更新，有些是为了修复损坏的 jQM 功能。

*   **按钮文本更改**

    不幸的是找不到这个插件的开发者。原始SO来源：[更改按钮文本jquery mobile](https://stackoverflow.com/questions/4009524/change-button-text-jquery-mobile/7279843#7279843)

    ```
    (function($) {
        /*
         * Changes the displayed text for a jquery mobile button.
         * Encapsulates the idiosyncracies of how jquery re-arranges the DOM
         * to display a button for either an <a> link or <input type="button">
         */
        $.fn.changeButtonText = function(newText) {
            return this.each(function() {
                $this = $(this);
                if( $this.is('a') ) {
                    $('span.ui-btn-text',$this).text(newText);
                    return;
                }
                if( $this.is('input') ) {
                    $this.val(newText);
                    // go up the tree
                    var ctx = $this.closest('.ui-btn');
                    $('span.ui-btn-text',ctx).text(newText);
                    return;
                }
            });
        };
    })(jQuery); 
    ```

    工作示例：http: [//jsfiddle.net/Gajotres/mwB22/](http://jsfiddle.net/Gajotres/mwB22/)

## 获取正确的最大内容高度

如果页眉和页脚有一个恒定的高度，内容 div 可以通过一点 css 技巧轻松设置为覆盖全部可用空间：

```
#content {
    padding: 0;
    position : absolute !important; 
    top : 40px !important;  
    right : 0; 
    bottom : 40px !important;  
    left : 0 !important;     
} 
```

这是一个带有**`Google maps api3`**演示的工作示例：http: [//jsfiddle.net/Gajotres/7kGdE/](http://jsfiddle.net/Gajotres/7kGdE/)

此方法可用于获取正确的最大内容高度，并且必须与**pageshow**事件一起使用。

```
function getRealContentHeight() {
    var header = $.mobile.activePage.find("div[data-role='header']:visible");
    var footer = $.mobile.activePage.find("div[data-role='footer']:visible");
    var content = $.mobile.activePage.find("div[data-role='content']:visible:visible");
    var viewport_height = $(window).height();

    var content_height = viewport_height - header.outerHeight() - footer.outerHeight();
    if((content.outerHeight() - header.outerHeight() - footer.outerHeight()) <= viewport_height) {
        content_height -= (content.outerHeight() - content.height());
    } 
    return content_height;
} 
```

这是一个现场 jsFiddle 示例：http: [//jsfiddle.net/Gajotres/nVs9J/](http://jsfiddle.net/Gajotres/nVs9J/)

有一件事要记住。此功能将正确地为您提供最大可用内容高度，同时它可用于拉伸相同的内容。不幸的是，它不能用于将 img 拉伸到完整的内容高度，img 标签的开销为 3px。

## 标记增强预防的方法：

这可以通过几种方式完成，有时您需要将它们结合起来才能达到预期的结果。

*   方法一：

    它可以通过添加这个属性来做到这一点：

    ```
    data-enhance="false" 
    ```

    到页眉、内容、页脚容器。

    这也需要在应用加载阶段开启：

    ```
    $(document).one("mobileinit", function () {
        $.mobile.ignoreContentEnabled=true;
    }); 
    ```

    ***在初始化 jquery-mobile.js 之前初始化它（看下面的例子）。***

    更多相关信息可以在这里找到：

    [http://jquerymobile.com/test/docs/pages/page-scripting.html](http://jquerymobile.com/test/docs/pages/page-scripting.html)

    示例：http: [//jsfiddle.net/Gajotres/UZwpj/](http://jsfiddle.net/Gajotres/UZwpj/)

    要再次重新创建页面，请使用以下命令：

    ```
    $('#index').live('pagebeforeshow', function (event) {
        $.mobile.ignoreContentEnabled = false;
        $(this).attr('data-enhance','true');
        $(this).trigger("pagecreate")
    }); 
    ```

*   方法二：

    第二种选择是使用此行手动执行此操作：

    ```
    data-role="none" 
    ```

    示例：http: [//jsfiddle.net/Gajotres/LqDke/](http://jsfiddle.net/Gajotres/LqDke/)

*   方法三：

    可以防止某些 HTML 元素进行标记增强：

    ```
     $(document).bind('mobileinit',function(){
          $.mobile.page.prototype.options.keepNative = "select, input";
     }); 
    ```

    示例：http: [//jsfiddle.net/Gajotres/gAGtS/](http://jsfiddle.net/Gajotres/gAGtS/)

    ***在 jquery-mobile.js 初始化之前再次初始化它（看下面的例子）。***

## 标记增强问题：

有时从头开始创建组件（如列表视图）时会发生此错误：

> 无法在初始化之前调用 listview 上的方法

可以在标记增强之前通过组件初始化来防止它，这是您可以解决此问题的方法：

```
$('#mylist').listview().listview('refresh'); 
```

## 标记最重要的问题：

如果由于某种原因需要更改默认的 jQuery Mobile CSS，则必须使用**`!important`**覆盖来完成。没有它，默认的 css 样式将无法更改。

例子：

```
#navbar li {
    background: red !important;
} 
```

**`jsFiddle`**示例：http: [//jsfiddle.net/Gajotres/vTBGa/](http://jsfiddle.net/Gajotres/vTBGa/)

## 变化：

*   01.02.2013 - 添加了动态导航栏演示
*   01.03.2013 - 添加了关于如何动态添加过滤到列表视图的评论
*   07.03.2013 - 添加了新章节：**获取正确的最大内容高度**
*   17.03.2013 - 在章节中添加了几句话：**获取正确的最大内容高度**
*   29.03.2013 - 添加了有关动态创建的滑块的新内容并修复了一个示例错误
*   03.04.2013 - 添加了有关动态创建的可折叠元素的新内容
*   04.04.2013 - 添加了第 3 方插件章节
*   20.05.2013 - 添加了动态添加的面板和内容
*   21.05.2013 - 添加了另一种设置完整内容高度的方法
*   20.06.2013 - 添加了新章节：**标记覆盖问题**
*   29.06.2013 - 添加了关于何时使用增强方法的重要说明

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-17T12:58:06.037

从 JQMobile 1.4 你可以对所有孩子做 .enhanceWithin() [http://api.jquerymobile.com/enhanceWithin/](http://api.jquerymobile.com/enhanceWithin/)

```
var content = '<p>Hi</p>';
$('#somediv').html(content);
$('#somediv').enhanceWithin(); 
```

# css - 修复了 CSS 中的标题以进行有条件的向下滚动？

> ID：14550397
> 
> 赞同：14
> 
> 时间：2013-01-27T18:03:48.887
> 
> 标签：css

我只想在用户向下滚动时标题试图离开屏幕时才修复标题 div（如横幅）。不使用JS可以吗？以 Facebook 时间线中的示例为例，如果我们向下滚动，一旦页面的标题离开屏幕，横幅就会向上浮动。我的问题是，是否可以只使用 CSS？

如果不够清楚，我想知道是否可以有条件地应用样式“位置：固定”，例如滚动 80px 页面时。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-27T18:34:58.540

**是的。**你可以只用 CSS 来做到这一点。这是通过将普通滚动标题放置在固定标题上方来完成的，该标题仅在普通滚动标题在其上方滚动后才会显示。这就是[http://techcrunch.com](http://techcrunch.com)的做法。

***更新 [2013 年 10 月 31 日]** - Techcrunch 最近更改了他们的用户界面，所以你再也看不到这个了！*

检查这个演示：http: [//jsfiddle.net/WDnyb/2/](http://jsfiddle.net/WDnyb/2/)

**HTML**

```
<div class="header">Header</div>
<div class="outer">
    <span class="banner">LOGO</span>
    <div class="header">Header</div>
</div>
<div class="content">Content</div> 
```

**相关CSS**

```
.header {
    width: 100%;
    position: fixed;
    top: 0;
    bottom: auto;
}
.outer {
    position: relative;
    height: 100px;
}
.outer .header {
    position: absolute;
    bottom: 0;
    z-index: 2;
    top: auto;
}
.content {
    height: 1500px;
    margin-top: 100px;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-01-21T18:42:18.320

现在可以在没有 javascript 的情况下正确完成此操作`position: sticky`。

有关示例，请参阅[https://css-tricks.com/position-sticky-2/](https://css-tricks.com/position-sticky-2/)。

警告：在撰写本文时，IE11、opera mini~~和 android 的股票浏览器~~不支持它：[https ://caniuse.com/#feat=css-sticky](https://caniuse.com/#feat=css-sticky)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:34:54.713

使用 css 是不可能的。您可以使用 JavaScript 或 jQuery。因为它需要一些条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-11T06:58:44.387

```
Html----included my content within

   <header1>
       ..............
  </header1> 

 JS

  <script>
  $(document).ready(function() {
   var $header1 = $("header1"),
    $clone = $header1.before($header1.clone().addClass("clone"));

     $(window).on("scroll", function() {
    var fromTop = $("body").scrollTop();
    $('body').toggleClass("down", (fromTop > 200));
 });
 });
</script> 
```

我已经使用上面的脚本来修复标题，它在 googlechrome 中工作正常而不是在 firefox 中......

# asp.net - 如果在应用程序运行时打开了任何新选项卡或浏览器，如何获取信息？

> ID：14550402
> 
> 赞同：1
> 
> 时间：2013-01-27T18:04:21.090
> 
> 标签：asp.net

如果在应用程序运行时打开了任何新选项卡或浏览器，如何获取信息？对于在线考试工具，我想实现一个功能，如果用户打开新标签或新浏览器，它会在进行测试时通知我。 **我怎样才能在 .dot 中完成这项任务？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:18:57.037

如果您的考试应用程序将成为 ASP.Net 网站/Web 应用程序，那么**您无法**检测打开了多少选项卡/浏览器实例。您可以查看[HTML5 Fullscreen API](https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode)寻找出路，但我认为并非所有浏览器都支持它。

# sql - 合并第一个表中未引用第二个表行的两个表

> ID：14550403
> 
> 赞同：0
> 
> 时间：2013-01-27T18:04:24.773
> 
> 标签：sql, postgresql, postgresql-9.2

我正在重新发布我删除的先前问题的更清晰版本。

如下面的示例所示，我只想在' 的 id 没有出现在'列中时才`table_b`合并。每个表对于它没有的任何字段都应该有一个空值。`table_a``table_b``table_a``table_b_id`

例子：

**表_a**

```
+----+-------+------------+
| id | name  | table_b_id |
+----+-------+------------+
| 0  | mike  | 1          |
+----+-------+------------+
| 1  | jack  | 1          |
+----+-------+------------+ 
```

**表_b**

```
+----+-------+
| id | name  |
+----+-------+
| 0  | tom   |
+----+-------+
| 1  | joe   |
+----+-------+ 
```

**结果：**

```
+-------------+-------+------------+
| original_id | name  | table_b_id |
+-------------+-------+------------+
| 0           | mike  | 1          |
+-------------+-------+------------+
| 0           | tom   |            |
+-------------+-------+------------+
| 1           | jack  | 1          |
+-------------+-------+------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:24:35.430

您的问题几乎可以直接翻译成查询。您希望查看表**A**已查询但补充了 B 中的行**，**`id`其中B**中**的任何一个都不在`table_b_id`A**中**。因此，以下`UNION`将**A**与 B 的子集**组合**`id`在一起，其中**B**不在`table_b_id`：

```
SELECT table_a.id AS original_id, table_a.name, table_a.table_b_id FROM table_a
UNION ALL
SELECT table_b.id AS original_id, table_b.name, NULL AS table_b_id FROM table_b
  WHERE table_b.id NOT IN (SELECT table_a.table_b_id FROM table_a) 
```

请注意，对于第二组，我们选择`NULL`as`table_b_id`因为**A**没有此字段。

# ios - viewForAnnotation 方法从未被调用

> ID：14550414
> 
> 赞同：0
> 
> 时间：2013-01-27T18:05:22.410
> 
> 标签：ios, mkmapview, mkmapviewdelegate

我已经实现了我的`MKMapViewDelegate`，但由于某种原因，我的`viewForAnnotation`方法从未被调用过。

我可以确认 MapView 上显示了注释。

我在`NSLog()`我的方法中添加了一个，并且从未打印过日志记录语句。

我知道我的课肯定是`MKMapViewDelegate`因为其他方法中的`NSLog()`语句被打印出来了。`MKMapViewDelegate`

我也在`self.mapView.delegate = self`设置`viewDidLoad`

```
@interface MapViewController () <MKMapViewDelegate>
    @property (weak, nonatomic) IBOutlet MKMapView *mapView;
@end

@implementation MapViewController

    @synthesize mapView = _mapView;
    @synthesize annotations = _annotations;

    -(void)setMapView:(MKMapView *)mapView
    {
        _mapView = mapView;
        [self updateMapView];
    }

    -(void)setAnnotations:(NSArray *)annotations
    {
        _annotations = annotations;
         [self updateMapView];
    }

    -(MKAnnotationView *)mapView:(MKMapView *)mapView
               viewForAnnotation:(id<MKAnnotation>)annotation
    {
     // For some reason this method is never called!!!!!!
     NSLog(@"This logging statement is never printed");

   }

    - (void)viewDidLoad
    {
        [super viewDidLoad];
        self.mapView.delegate = self;
    }

    - (void)updateMapView
    {
        if (self.mapView.annotations) [self.mapView removeAnnotations:self.mapView.annotations];
        if (self.annotations) [self.mapView addAnnotations:self.annotations];
    }

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:26:22.103

一个可能的解释是没有注释。

检查实际上将注释添加到`mapView`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:19:13.523

我认为您忘记将委托出口连接到文件所有者。右键单击它并将其委托出口连接到文件所有者。

# javascript - 有没有办法缩小 Rails UJS 响应？

> ID：14550415
> 
> 赞同：2
> 
> 时间：2013-01-27T18:05:30.390
> 
> 标签：javascript, jquery, ruby-on-rails-3, minify, ujs

sprockets 对 js 资产进行了所有的缩小，但是很多 javascript 是用`respond_to :js`UJS 响应编写的。

在编程时使 javascript 可读也使得它在处理它们时被浏览器不需要的无用数据（如可读的变量名和空格）膨胀

有没有办法自动缩小/丑化 UJS 响应，以便它们在编程时保持可读性，但在发送到浏览器时会被缩小？（缩小来源不是一种选择）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T17:41:03.923

首先，您所说的不一定是 UJS，而是[RJS 或 Ruby JavaScript](https://stackoverflow.com/questions/2044414/what-does-rjs-stand-for)或从 ruby​​ 模板动态生成的 javascript。

UJS，非常（大多数？）通常不是通过动态 javascript 完成的，而是通过返回动态数据，然后由静态 javascript 操作。这有很多优点；与这种情况相关：这意味着您的 javascript 已经在客户端进行了缩小（并且可能已缓存），并且您只是通过网络发送序列化数据。

如果可以，您可能需要考虑使用这种方法。

如果不能，您可以使用中间件自动缩小您的 RJS 操作，如下所示（原始伪代码版本）。但要小心。您还需要考虑缩小的好处是否值得付出代价，例如缩小每个请求的时间/成本与向客户端发送较大文件的时间/成本。

有关中间件的更多信息，[请参阅文档](http://edgeguides.rubyonrails.org/rails_on_rack.html#inspecting-middleware-stack)

```
module RJSMinifier
  def initialize(app)
    @app = app
  end

  def call(env)
    status, headers, response = @app.call(env)

    # pseudocode: if this is not an RJS request or the request did not
    # complete successfully, return without doing anything further
    if (this request is not RJS or status is not ok)
      return [status, headers, response]
    end

    # otherwise minify the response and set the new content-length
    response = minify(response)
    headers['Content-Length'] = response.length.to_s

    [status, headers, response]
  end

  def minify(js)
    # replace this with the real minifier you end up using
    YourMinifier.minify(js)
  end
end 
```

# java - (JPQL) - 查询获得最多记录的用户

> ID：14550430
> 
> 赞同：0
> 
> 时间：2013-01-27T18:07:32.317
> 
> 标签：java, mysql, jpa, jpql

请原谅我再次讨论这个问题，但我需要对此进行 JPA 查询：

```
select username, count(*)
from Records
group by username
order by count(*) desc
limit 1 
```

我想过这样的事情：

```
select r.username,count(*) from Records r order by r.username desc 
```

然后打电话

```
getResultList().get(0) 
```

但我只能写：

```
select r from Records r order by r.username desc 
```

在这种情况下，我不知道如何获得我需要的东西。有谁有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:15:41.063

SQL 查询具有 group by 和 order by count。JPA 查询没有任何分组依据和用户名排序。所以我不明白他们怎么能返回同样的东西。

等效的 JPQL 查询是

```
select r.username, count(r.id)
from Record r
group by r.username
order by count(r.id) desc 
```

如果调用`setMaxResults(1)`Query 对象，limit 子句将被添加到生成的 SQL 查询中，使其完全等效。

# c# - WinForms 在设计器中对负载进行了一些更改

> ID：14550432
> 
> 赞同：3
> 
> 时间：2013-01-27T18:07:39.227
> 
> 标签：c#, .net, winforms, windows-forms-designer, nested-controls

这是我多年来注意到的，但以前从未被打扰过。在设计器视图中打开 WinForms 表单时，VS 会立即将某些表单设置为未保存状态。这只发生在一些层次结构稍微复杂的表单上。

麻烦的是，每当发生这种情况时，有关表单的某些内容已经发生了变化（主要是细微的变化）。通常嵌套控件与锚属性集的对齐方式。在这种特殊情况下，我有一个带有嵌套 GroupBox 的 SplitPanel 和一个嵌套的 PropertyGrid 控件。

因此，每次我运行打开表单并保存它时，这种烦人的变化都会出现在运行时，并且也可以在设计器中看到。其他人是否注意到类似的行为？如果是这样，有人找到原因和解决方法吗？

# python - 在 Python 上通过 While 连接数组

> ID：14550440
> 
> 赞同：0
> 
> 时间：2013-01-27T18:09:00.073
> 
> 标签：python, arrays, numpy, while-loop, raw-input

我对python有一些疑问，

我正在尝试写一些东西，在每个 raw-input 之后，我应该将一些数据（以数组形式）输入到程序中。然后这个数据（数组 2 dimensioanl ）应该被添加到另一个 2D 数组全零。然后，当我输入第二个数据时（它应该再次更改为二维数组）并且必须添加到已经包含带有零的数组和来自输入的数组的数组中）。因此，在每个输入之后，应该添加已经创建的数组。这是代码。

```
from numpy import *

var=zeros(shape=(1,11)) #making 2D array with zeros

while True: 

    file=raw_input("write data file name or path")

    c=open(file, 'r')
    ArrayStr=loadtxt(c, dtype='S',) #making array

    var=vstack((ArrayStr, var)) # concatantaing array 
print var 
```

所以最后我得到了数组，它只有2个数组连接（带有零的数组和最后输入的数据数组）

感谢关注和帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:42:17.613

**工作代码**

***in1.txt***

```
ATOM
1
C1
POS
X
1
16.774
117.860
10.374
1.00
0.00 
```

***in2.txt***

```
ATOM
2
C2
POS
X
2
18.774
17.860
30.374
2.00
0.00 
```

**代码**

```
import numpy

zeros = numpy.zeros(shape=(1,11)) #making 2D array with zeros

var = None

for i in range(1, 3):
    i1 = open("in" + str(i) + ".txt")

    a = numpy.loadtxt(i1, dtype='S')

    if var is None:
        var = numpy.vstack((a, zeros))
    else:
        var = numpy.vstack((var, a, zeros))

print var 
```

**输出**

```
>>> 
[['ATOM' '1' 'C1' 'POS' 'X' '1' '16.774' '117.860' '10.374' '1.00' '0.00']
 ['0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0']
 ['ATOM' '2' 'C2' 'POS' 'X' '2' '18.774' '17.860' '30.374' '2.00' '0.00']
 ['0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0' '0.0']]
>>> 
```

# python - 在熊猫中读取带有逗号和字符的 CSV 文件时出现问题

> ID：14550441
> 
> 赞同：8
> 
> 时间：2013-01-27T18:09:06.120
> 
> 标签：python, csv, special-characters, pandas

我正在尝试使用 pandas 读取 csv 文件，该文件有一个名为标签的列，其中包含用户提供的标签，并具有 - 、“”、“”、1950 年代、16 世纪等标签。由于这些是用户提供的，因此也有许多特殊字符被错误输入。问题是我无法使用 pandas read_csv 打开 csv 文件。它显示错误：Cparser，错误标记数据。有人可以帮我将 csv 文件读入熊猫吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-27T18:49:51.763

好的。从格式错误的 CSV 开始，我们无法读取：

```
>>> !cat unquoted.csv
1950's,xyz.nl/user_003,bad, 123
17th,red,flower,xyz.nl/user_001,good,203
"",xyz.nl/user_239,not very,345
>>> pd.read_csv("unquoted.csv", header=None)
Traceback (most recent call last):
  File "<ipython-input-40-7d9aadb2fad5>", line 1, in <module>
    pd.read_csv("unquoted.csv", header=None)
[...]
  File "parser.pyx", line 1572, in pandas._parser.raise_parser_error (pandas/src/parser.c:17041)
CParserError: Error tokenizing data. C error: Expected 4 fields in line 2, saw 6 
```

我们可以制作一个更好的版本，利用最后三列表现良好的事实：

```
import csv

with open("unquoted.csv", "rb") as infile, open("quoted.csv", "wb") as outfile:
    reader = csv.reader(infile)
    writer = csv.writer(outfile)
    for line in reader:
        newline = [','.join(line[:-3])] + line[-3:]
        writer.writerow(newline) 
```

产生

```
>>> !cat quoted.csv
1950's,xyz.nl/user_003,bad, 123
"17th,red,flower",xyz.nl/user_001,good,203
,xyz.nl/user_239,not very,345 
```

然后我们可以阅读它：

```
>>> pd.read_csv("quoted.csv", header=None)
                 0                1         2    3
0           1950's  xyz.nl/user_003       bad  123
1  17th,red,flower  xyz.nl/user_001      good  203
2              NaN  xyz.nl/user_239  not very  345 
```

不过，我会考虑从源头上解决这个问题并以可接受的格式获取数据。像这样的伎俩不应该是必要的，而且很容易无法修复。

# c# - 滑块 - 捕捉到点并拖动事件

> ID：14550444
> 
> 赞同：0
> 
> 时间：2013-01-27T18:09:07.113
> 
> 标签：c#, wpf, events, slider

当滑块的拇指被拖动到新值或单击到具有对齐点的新值时，我需要触发一个事件。我只希望在值更改时发生此事件是这两种方式，使用鼠标，因此 ValueChanged 事件将不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:22:34.820

you can try this litte trick

first you need to set UpdateSourceTrigger to Explicit

```
<Slider Minimum="0"
        Thumb.DragStarted="Slider_DragStarted"
        Thumb.DragCompleted="Slider_DragCompleted"
        Maximum="{Binding YourMaxBinding, Mode=OneWay}"
        Value="{Binding CurrentPosition, Mode=TwoWay, UpdateSourceTrigger=Explicit}" /> 
```

code behind

```
private void Slider_DragStarted(object sender, System.Windows.Controls.Primitives.DragStartedEventArgs e) {
    // try to prevent updating slider position from your view model
    yourViewModel.DontUpdateSliderPosition = true;
}

private void Slider_DragCompleted(object sender, System.Windows.Controls.Primitives.DragCompletedEventArgs e) {
    BindingExpression be = ((Slider)sender).GetBindingExpression(RangeBase.ValueProperty);
    if (be != null) {
      be.UpdateSource();
    }
    yourViewModel.DontUpdateSliderPosition = false;
} 
```

code at your view model

```
private bool _dontUpdateSliderPosition;
public bool DontUpdateSliderPosition {
    get {
        return _dontUpdateSliderPosition;
    }
    set {
        if (Equals(value, _dontUpdateSliderPosition)) {
            return;
        }
        _dontUpdateSliderPosition = value;
        yourPropertyChangedFunc("DontUpdateSliderPosition");
    }
}

private int _currentPosition;
public int CurrentPosition {
    get {
        return _currentPosition;
    }
    set {
        if (Equals(value, _currentPosition)) {
            return;
        }
        _currentPosition = value;
        yourPropertyChangedFunc("CurrentPosition");
    }
}

private CodeBehindFuncToChangeTheSliderPosition(){
    if (!DontUpdateSliderPosition) {
        CurrentPosition = theNewPosition;
    }
} 
```

hope this helps

# oracle - 为什么employee_id 以`###########` 的形式出现，而不是文本文件中的数字？

> ID：14550448
> 
> 赞同：0
> 
> 时间：2013-01-27T18:09:19.677
> 
> 标签：oracle, oracle11g

我有两个文本文件如下：

***项目2.txt***

```
77;445;John;55
78;445;John;50
79;445;John;65 
```

***项目1.txt***

```
80;447;John;35
81;447;John;45
84;447;John;51 
```

现在我创建了一个***外部表***，如下所示：

```
CREATE TABLE WORKING_HOURS_EXT
( employee_id       NUMBER(8), 
  project_id        VARCHAR2(20),
  Ename        VARCHAR2(25), 
  Durations         VARCHAR2(25)
) 
ORGANIZATION EXTERNAL 
( 
  TYPE ORACLE_LOADER 
  DEFAULT DIRECTORY xtern_data_dir 
  ACCESS PARAMETERS 
  ( 
    records delimited by newline 
    fields terminated by ';'  
  ) 
  LOCATION ('Project2.txt', 'Project1.txt') 
) 
PARALLEL; 
```

但现在我的困惑是为什么***employee_id***是作为`###########`文本文件中的数字而不是数字来的？

```
SQL> set linesize 50
SQL> column employee_id format a5;
SQL> column project_id format a10;
SQL> column Ename format a10;
SQL> column Durations format a10;
SQL> select * from WORKING_HOURS_EXT;

EMPLOYEE_ID PROJECT_ID ENAME      DURATIONS
----------- ---------- ---------- ----------
 ########## 447        John       35
 ########## 447        John       45
 ########## 447        John       51
 ########## 445        John       55
 ########## 445        John       50
 ########## 445        John       65

6 rows selected.

SQL> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:00:49.973

如[SQL*Plus User's Guide](http://docs.oracle.com/cd/E11882_01/server.112/e16604/ch_six.htm#i1081036)中所述，数字的格式应如下：

```
column employee_id format 99999 
```

... 不强制使用字母数字格式 wirh `A5`。

# grails - 集成测试中的 Grails 范围服务

> ID：14550450
> 
> 赞同：3
> 
> 时间：2013-01-27T18:09:34.733
> 
> 标签：grails, scope, integration-testing

我有一项需要范围“会话”的服务。所以我只是使用

```
class MyService {
  static scope = "session"
  ...
} 
```

但在我的集成测试中，它没有正确连接：

```
class MyServiceIntegrationSpec extends IntegrationSpec {
  def myService
  ...
} 
```

我总是得到错误：

> 创建名为“myService”的 bean 时出错：范围“会话”对于当前线程不活动；如果您打算从单例中引用它，请考虑为该 bean 定义一个作用域代理；

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:11:50.647

您不能将“较低”范围的 bean 注入单例中。就像您想将控制器注入服务一样。控制器是随每个请求创建的，但服务是应用程序的一个（如果默认为单例）。在这里您可以有不同的会话，但只有一个单例用于测试 - 那么您想在测试中使用哪个会话的服务？

可以从上下文中获取 bean 而不是注入它：

```
def grailsApplication

void testSomething() {
    given:
    def myService = grailsApplication.mainContext.getBean('myService')
... 
```

将测试范围从单例更改为会话也可以解决问题，但我不知道这是否可能。

# php - 为 # 个循环输入数字文本

> ID：14550453
> 
> 赞同：-5
> 
> 时间：2013-01-27T18:09:39.127
> 
> 标签：php, for-loop, iteration, break

我的目标是在文本框中放一些数字文本，例如，如果我输入“3”，它会出来：

你好 1

你好 2

你好 3

我的问题是它一直持续到循环完全完成（好 74 次），并且不遵守输入的值，并在我输入的 3 或某个数字处停止。

```
<div class="Container">
        <h2>Hello Page</h2><hr>
        <form>
            <p>Enter a number:</p>
            <input type="text" name="number">
            <input type="submit" value="Enter">
        </form>

        <?php
        $digit = $_GET['number'];

        if (empty($digit))
            $digit= "";
        elseif (!empty($digit)) {

            for ($digit= 1; $digit< 75; $digit++) {
                if ($digit== TRUE) {
                    echo 'Hello ' . $digit. '<br>';

                } elseif ($digit== $digit) {
                    break;
                }
            }
        }
        ?>

    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:12:29.510

方法一。

```
for($i=0;$i<$_GET['number'];$i++) {
  echo "Hello {$i}<br/>";
} 
```

方法2。

```
$i = 0;
while($i < $_GET['number'])
  echo "Hello {$i}<br/>";
  $i++;
} 
```

方法3。

```
$i = 0;
while(true) {
  if($i >= $_GET['number']) break;
  echo "Hello {$i}<br/>";
  $i++;     
} 
```

方法4。

```
do {
  echo "Hello {$i}<br/>";
  $i++;
} while($i < $_GET['number']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:13:54.390

主要问题是您使用 $digit 作为接收表单输入的变量，并且作为循环中的增量变量。所以基本上你正在覆盖你输入的值。所以基本上你需要使用 2 个变量，而不是 1 个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:18:41.777

你的 $digit 变量是最大值，这样使用它。在此更改您的 for 循环

```
for ($x= 1; $x <= $digit; $x++) {
    echo 'Hello ' . $x. '<br />';
} 
```

然后你会得到你想要的。

# jquery - 如何使用单个 jquery 更改 div 的显示属性和动画

> ID：14550456
> 
> 赞同：0
> 
> 时间：2013-01-27T18:10:08.527
> 
> 标签：jquery, html

我正在制作一个页面，单击一个按钮并使用 jquery animate 命令打开一个完整的菜单。然后当您单击十字图片时，它会再次使用动画命令关闭。但问题是它的位置是固定的，它包含从 1 到 30 的数字。因此，当您隐藏 div 时，它会隐藏，但数字仍然在左侧可见，直到或除非您没有将它的显示属性更改为无

```
//this resets the size of div to 0
$(document).ready(function(){
$("#fullmenu").animate({
  height:'0%',
  width:'0%'
  });
  });
  //This opens the div
    $(document).ready(function(){
  $("#imgdot").click(function(){
  $("#fullmenu").animate({
height:'90%',
width:'90%',
    });
  });
});
 //This closes the div when the image cross is clicked
$(document).ready(function(){
  $("#cross").click(function(){
    $("#fullmenu").animate({
            height:'0%',
            width:'0%'
      });
   });
}); 
```

我的问题是如何将 display 属性更改为 none 并同时为 div 设置动画是单个函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:11:57.207

用这个

```
$('#foo').fadeOut("slow", function(){
    var div = $("<div id='foo'>test2</div>").hide();
    $(this).replaceWith(div);
    $('#foo').fadeIn("slow");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:13:27.520

jQuerys 动画通常不会影响 div 的子元素，

你可以试试这个：

```
$("#fullmenu").animate({
        height:'0%',
        width:'0%'
}).children().hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:14:36.990

```
Css can be changed as $("#divId").css('display','none');

$(document).ready(function(){

  $("#cross").click(function(){

    $("#fullmenu").animate({

            height:'0%',
            width:'0%'
      },complete:function(){

$("#fullmenu").css('display','none')
});
   });
});

That said, you could use :

$(document).ready(function(){

  $("#cross").click(function(){

    $("#fullmenu").slideUp();
   }); 
```

# haskell - 在 Haskell 中查找列表的最大元素和索引

> ID：14550458
> 
> 赞同：10
> 
> 时间：2013-01-27T18:10:15.633
> 
> 标签：haskell, ghci

我正在迈出进入 Haskell 美妙世界的第一步。作为练习，我想实现一个方法来查找列表的最大元素及其索引。我们称这个函数为“maxi”。在列表上调用 maxi 应返回以下结果：

```
ghci> maxi [1, 3, 4, 1, 2, 3]
(4, 2) 
```

4 是这个列表中最大的 int，它位于索引 2 处。

我试图按如下方式实现此功能：

```
maxim :: (Ord a) => [a] -> (a, Int)
maxim l = 
  let pmaxim :: (Ord a) => [a] -> Int -> (a, Int) -- Internal function to do the work
      pmaxim [] _  = error "Empty list"           -- List is empty, error
      pmaxim [x] xi = (x, xi)                     -- List has one item, return it and the index
      pmaxim (x:xs) xi                            -- More than one item, break list apart
        | x > t     = (x, xi)                     -- If current item is bigger, return it and its index
        | otherwise = (t, ti)                     -- If list tail has a bigger item, return that
        where (t, ti) = pmaxim xs (ti + 1)        -- Get max of tail of the list
  in pmaxim l 0                                   -- Call internal function with start index 
```

当我调用它时，我得到了一些非常奇怪的东西：ghci 在返回最大元素的值后似乎挂起。

```
ghci> maxi [1, 3, 4, 1, 2, 3]
(4, 
```

我会大胆猜测这与 Haskell 的懒惰评估性质有关，但我发现很难弄清楚这里到底发生了什么，以及如何解决它。我也非常感谢任何人关于如何在 Haskell 中调试的任何提示。有没有一种简单的方法可以在执行期间打印出值而不影响行为？

我只是想指出，我知道有几种更好的方法可以使用内置的 Haskell 函数来获得这种行为。我正在从头开始实施它以尝试学习 Haskell。

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-27T18:20:00.917

这是因为您的代码中有一个小错误。你有：

```
where (t, ti) = pmaxim xs (ti + 1) 
```

...但实际上应该是：

```
where (t, ti) = pmaxim xs (xi + 1) 
```

这修复了您的代码，现在产生了正确的解决方案：

```
>>> maxim [1, 2, 3, 2, 1]
(3, 2) 
```

您的代码挂起，因为您的计算`ti`导致无限循环，因为您不小心根据自身定义了它。请注意，这`ghc`是一个足够智能的编译器，并且计算出它`t`不依赖于 的值`ti`，这就是为什么即使您的版本无法计算索引，它仍然可以成功计算最大值的原因。

调试纯计算的标准方法是`Debug.Trace`模块。

作为旁注，有一个更简单的解决方案：

```
import Data.List
import Data.Ord

maxi xs = maximumBy (comparing fst) (zip xs [0..]) 
```

编辑：哎呀，我没有看到你是故意从头开始实施它，但我还是会把它留在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-09T09:14:05.090

我看到你已经回答了你的问题。我设法使用 lambda 函数在没有递归的情况下做到了。

```
maxim xs = foldr (\ (x,y) acc -> if (x == maximum xs) then (x,y) else acc) (0,head xs) (zip xs [0..]) 
```

# javascript - 函数对象属性

> ID：14550460
> 
> 赞同：1
> 
> 时间：2013-01-27T18:10:23.750
> 
> 标签：javascript

每个函数对象都有`__proto__`其内部属性。他们也`prototype`有财产。因为`prototype`它也是一个对象，所以它也有一个`__proto__`属性。我的问题是，`__proto__`原型内部和函数对象中的属性是否都指向`Function.prototype`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:17:16.153

不，函数的原型属性（即`SomeFunc.prototype`）是一个普通对象，因此它的内部`__proto__`属性指向`Object.prototype`。

简单的测试方法：

```
function Foo() {};
console.log(Object.getPrototypeOf(Foo) === Object.getPrototypeOf(Foo.prototype));
// logs false
console.log(Object.getPrototypeOf(Foo) === Function.prototype);
// logs true
console.log(Object.getPrototypeOf(Foo.prototype) === Object.prototype);
// logs true 
```

只有函数继承自`Function.prototype`，没有其他对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:19:50.287

函数的属性命名`prototype`是一个普通对象，它成为使用该函数作为构造函数时创建的对象的原型。

函数的实际原型（可通过 访问`__proto__`）是一个名为 的对象`Function.prototype`，它按顺序从`Object.prototype`.

![图表](../Images/b43a3ede1688661df2f6e56d2e8e7de3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:18:41.497

不。

hidden`__proto__`属性实际上不应该被 JS 程序员直接使用，它是作为将对象绑定到其原型链的粘合剂。

像这样：

```
function x () {}

x.__proto__; // is a prototypical function, leading back to `Function.prototype` 
```

但是，`prototype`它只是一个对象，它在函数内部被分配给`__proto__`您正在创建的任何内容的属性`new`。

由于它只是一个常规对象，`__proto__`最终会导致返回`Object.prototype`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:19:46.440

使用运算符时，该`__proto__`属性指向函数。`constructor``new`

如果您的构造函数是 instanceof `Function`，则对象中的所有属性和方法`Function.proptotype`都可以被实例访问，并且将使用与上下文相同的内容。

有些浏览器没有实现对`__proto__`对象的访问，所以如果你不想使用，就会失去兼容性。

MDN 文档中的更多信息：[https ://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Object/proto](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Object/proto)

# string - 对象的参数丢失（iPhone 的 XCode）

> ID：14550462
> 
> 赞同：-1
> 
> 时间：2013-01-27T18:10:38.620
> 
> 标签：string, object, xcode4, parameters, split

我在这里有一个奇怪的行为。XCode 4 for iOS 6 (Iphone 4s) 在初始化部分我想从文件中读取数据。

```
NSString *rawData = [[NSString alloc] initWithContentsOfFile:filePathLib encoding:NSUTF8StringEncoding error:NULL];
NSArray      *zeilen = [rawData componentsSeparatedByString:@";"];
NSLog(@"Check1 \n%@\n%@",rawData, zeilen); 
```

好的，现在 LogItem 向我显示，读取了正确的数据。

现在我有一个 if 条件：

```
if ([zeilen count]==4){
        A      = [zeilen objectAtIndex:0];
        B      = [zeilen objectAtIndex:1];
        C      = [zeilen objectAtIndex:2];
        D      =[[zeilen objectAtIndex:3] intValue];
        NSLog(@"Check2 \n%@\n%@ - %@ - %@ - %@ - %d",rawData, zeilen, A, B, C, D);
} else {
        A = @"A0";
        B = @"B0";
        C = @"C0";
        D = 3;
} 
```

现在我运行这个程序。如果使用了第一个分支，程序就会崩溃，如果使用了第二个，它会完美运行。如果我使用断点，我可以观察到以下内容：

一个 NSString * 0x20063bf0 @"A123" （正确的值）

B、C、D 也正确

后来，崩溃前的一行：

文件读取分支：

A、B 和 C 不可用，D 正确。

默认，分支：

A、B、C、D 正确。

这些变量在其他任何地方都没有被操纵甚至被删除。

有谁知道，问题出在哪里？

我的假设：数组“zeilen”不包含 NSString 值，因此它们以某种方式被删除。但是，我并不真正相信这个理论，因为一开始这些元素是正确且可用的，只是后来它们被删除了。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:19:14.920

解决了它：

代替：

```
A      = [zeilen objectAtIndex:0]; 
```

经过

```
A      = [[NSString alloc] stringWithFormat:@"%@",[zeilen objectAtIndex:0]]; 
```

内存没有分配，因此它丢失了。

# python - 简化函数

> ID：14550466
> 
> 赞同：2
> 
> 时间：2013-01-27T18:11:48.190
> 
> 标签：python, string, int, slice, typeconverter

我已经写了这个函数，我认为它会起作用，但我不能 100% 确定。但我很好奇这很复杂。有什么方法可以让这更简单吗？

这三个参数是 'HH:MM' 形式的时间，其中 00 <= HH <= 23 和 00 <= MM <= 59。前两个时间是时间估计值，第三个是实际时间。返回最接近实际时间的时间估计值，即前两个参数之一。如果它们同样接近，则第一次返回。

```
(str, str, str) -> str  

def closest_time(guess1, guess2, answer):
    if abs((int(answer[:2])) - (int(guess1[:2])) > ((int(answer[:2])) - int(guess2[:2]))):
        return guess2
    if abs((int(answer[:2])) - (int(guess1[:2])) < ((int(answer[:2])) - int(guess2[:2]))):
        return guess1
    if abs((int(answer[:2])) - (int(guess1[:2])) == ((int(answer[:2])) - int(guess2[:2]))):
        if abs((int(answer[3:])) - (int(guess1[3:])) > ((int(answer[3:])) - int(guess2[3:]))):
            return guess2
        if abs((int(answer[3:])) - (int(guess1[3:])) < ((int(answer[3:])) - int(guess2[3:]))):
            return guess1
        if abs((int(answer[3:])) - (int(guess1[3:])) == ((int(answer[3:])) - int(guess2[3:]))):
            return guess1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T18:15:54.137

我会`HH:MM`使用`m = int(HH) * 60 + int(MM)`. 这应该会大大简化问题。

把它们放在一起：

```
>>> def to_minutes(s):
        return int(s[:2]) * 60 + int(s[-2:])

>>> def closest_time(guess1, guess2, answer):
        g1, g2, a = map(to_minutes, [guess1, guess2, answer])
        return guess1 if abs(g1 - a) <= abs(g2 - a) else guess2

>>> closest_time('08:05', '10:30', '08:10')
'08:05'
>>> closest_time('08:05', '10:30', '10:05')
'10:30' 
```

# python - Python 中的套接字服务器

> ID：14550467
> 
> 赞同：0
> 
> 时间：2013-01-27T18:11:53.277
> 
> 标签：python, sockets

我正在尝试设置本地服务器，以便同一本地网络上的其他 PC 可以连接到它。尝试这样做时，在客户端，我收到以下错误：[Errno 10061] No connection could be made because the target machine positively denied it

我已经搜索了几个小时，仍然无法解决这个问题。我也尝试关闭我的防火墙，但没有。

这些是我的服务器和客户端代码：

服务器代码：

```
import socket
import threading
import SocketServer
import datetime

ver_codes = []

class ThreadedTCPRequestHandler(SocketServer.BaseRequestHandler):
    def handle(self):
        print threading.current_thread().isDaemon()
        data = self.request.recv(1024)
        command = data.split()[0]
        if(command=="login"):
            if(logged_in(data.split()[1])==False):
                self.request.sendall(login(data.split()[1], data.split()[2]))
            else:
                self.request.sendall("already in")

class ThreadedTCPServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):
    pass

def client(ip, port, message):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((ip, port))
    try:
        sock.sendall(message)
        response = sock.recv(1024)
        print "Received: {}".format(response)
    finally:
        sock.close()

def logged_in(id_num):
    for i in ver_codes:
        if(i[0]==id_num):
            return True
    return False

def login(username, password):
    login_file = open("Login.txt", "r")
    match = login_file.readline()
    while(match!="*"):
        if(match.split()[0]==username):
            if(match.split()[1]==password):
                ver_codes.append([match.split()[0], encryption_code(match.split()[2])])
                login_file.close()
                return "{} {}".format(match.split()[2], encryption_code(match.split()[2]))
                print "And Here"
        match = login_file.readline()
    return "Denied"
    login_file.close()

def encryption_code(to_encrypt):
    now = datetime.datetime.now()
    return int(str(now.microsecond)) * int(to_encrypt)

if __name__ == "__main__":
HOST, PORT = "localhost", 7274

server = ThreadedTCPServer((HOST, PORT), ThreadedTCPRequestHandler)
ip, port = server.server_address
print server.server_address

server_thread = threading.Thread(target=server.serve_forever)
server_thread.daemon = False
server_thread.start()
print "Server loop running in thread:", server_thread.name 
```

客户代码：

```
import socket
import sys

HOST, PORT = "localhost", 7274
data = " ".join(sys.argv[1:])

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
sock.connect((HOST, PORT))
sock.sendall("login mahdiNolan m1373")

received = sock.recv(1024)
finally:
sock.close() 
```

我真的很感激你能给我的任何帮助！非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T14:00:16.647

您的问题是因为您正在监听`localhost`- 这只会接受来自本地计算机的连接。

如果您想接受来自任何地方的连接，而不是`"localhost"`只传递空字符串`""`。这等效于指定`INADDR_ANY`C 套接字 API - 请参阅[ip](http://www.kernel.org/doc/man-pages/online/pages/man7/ip.7.html)手册页以获取更多信息，或者[此页面](http://www.cs.cmu.edu/~srini/15-441/F01.full/www/assignments/P2/htmlsim_split/node18.html)看起来也有一些有用的解释。简而言之，这意味着“接受任何本地接口上的连接”。

代替空字符串，您可以指定本地接口的 IP 地址以仅接受该接口上的连接 - 除非您的机器内部有多个网卡（例如充当网关），否则您不太可能需要这样做（例如充当网关）并且您只想要在其中一个网络上处理请求。

此外，在客户端，您应该使用机器的实际地址 - 替换`"localhost"`为服务器机器的 IP 地址或主机名。例如，类似`"192.168.0.99"`. 如果你想在 Windows 下找到服务器的 IP 地址，打开一个 DOS 窗口并运行`ipconfig`命令，查找带有的行`IPv4 Address`（假设你很可能有一个 IPv4 网络）。

Windows 防火墙也会阻止服务器接受您已经找到的连接，但您不需要禁用它 - 一旦您运行服务器，您应该会看到一个弹出窗口，您可以在其中指示它接受连接（那是在 Windows 7 上，在其他版本上可能会有所不同）。无论如何，关闭软件防火墙应该可以让一切正常工作，尽管这是否是安全风险超出了这个问题的范围。

# c# - PropertyGrid控件-修改中心分割竖线的位置

> ID：14550468
> 
> 赞同：5
> 
> 时间：2013-01-27T18:11:56.007
> 
> 标签：c#, .net, winforms, propertygrid

我在 WinForms ( [http://msdn.microsoft.com/en-us/library/aa302326.aspx](http://msdn.microsoft.com/en-us/library/aa302326.aspx) ) 中有一个 PropertyGrid 控件。现在我想将中间的垂直线更向左移动（它总是居中，但我的键很短，而值是路径，很长。默认情况下，控件将线放在中间，即使用户可以移动它。关于用户友好性，我想以编程方式将行更多地向左移动。我现在已经多次搜索 WinForms 设计器属性以及 PropertyGrid 控件的成员，但没有找到选项（也没有任何有关它的事件）。

它是否通过私密而隐藏在视线/修改中？我只是监督了吗？（在那种情况下，我真的很抱歉）否则我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-12T17:08:47.900

是的，不幸的是，这需要一些基于反射的黑客才能实现。这是一个示例扩展类：

**PropertyGridExtensionHacks.cs**

```
using System.Reflection;
using System.Windows.Forms;

namespace PropertyGridExtensionHacks
{
    public static class PropertyGridExtensions
    {
        /// <summary>
        /// Gets the (private) PropertyGridView instance.
        /// </summary>
        /// <param name="propertyGrid">The property grid.</param>
        /// <returns>The PropertyGridView instance.</returns>
        private static object GetPropertyGridView(PropertyGrid propertyGrid)
        { 
            //private PropertyGridView GetPropertyGridView();
            //PropertyGridView is an internal class...
            MethodInfo methodInfo = typeof(PropertyGrid).GetMethod("GetPropertyGridView", BindingFlags.NonPublic | BindingFlags.Instance);
            return methodInfo.Invoke(propertyGrid, new object[] {});
        }

        /// <summary>
        /// Gets the width of the left column.
        /// </summary>
        /// <param name="propertyGrid">The property grid.</param>
        /// <returns>
        /// The width of the left column.
        /// </returns>
        public static int GetInternalLabelWidth(this PropertyGrid propertyGrid)
        {
            //System.Windows.Forms.PropertyGridInternal.PropertyGridView
            object gridView = GetPropertyGridView(propertyGrid);

            //protected int InternalLabelWidth
            PropertyInfo propInfo = gridView.GetType().GetProperty("InternalLabelWidth", BindingFlags.NonPublic | BindingFlags.Instance);
            return (int)propInfo.GetValue(gridView);
        }

        /// <summary>
        /// Moves the splitter to the supplied horizontal position.
        /// </summary>
        /// <param name="propertyGrid">The property grid.</param>
        /// <param name="xpos">The horizontal position.</param>
        public static void MoveSplitterTo(this PropertyGrid propertyGrid, int xpos)
        {
            //System.Windows.Forms.PropertyGridInternal.PropertyGridView
            object gridView = GetPropertyGridView(propertyGrid);

            //private void MoveSplitterTo(int xpos);
            MethodInfo methodInfo = gridView.GetType().GetMethod("MoveSplitterTo", BindingFlags.NonPublic | BindingFlags.Instance);
            methodInfo.Invoke(gridView, new object[] { xpos });
        }
    }
} 
```

要移动拆分器位置，请使用 MoveSplitterTo 扩展方法。使用 GetInternalLabelWidth 扩展方法获取拆分器的实际位置。请注意，我观察到，在分配 SelectedObject 并且未显示 PropertyGrid 之前，GetInternalLabelWidth 返回 (-1)。

样品用途：

```
using PropertyGridExtensionHacks;
//...

    private void buttonMoveSplitter_Click(object sender, EventArgs e)
    {
        int splitterPosition = this.propertyGrid1.GetInternalLabelWidth();
        this.propertyGrid1.MoveSplitterTo(splitterPosition + 10);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-26T13:35:56.213

这是一种不依赖于直接使用私有方法或反射的方法。它仍然使用未记录的接口。

在 .NET 4.0 中，该`PropertyGrid.Controls`集合包含 4 个控件。`PropertyGrid.Controls.item(2)`是未记录的`PropertyGridView`（与使用反射的答案相同）。该属性`PropertyGridView.LabelRatio`调整列的相对宽度。`LabelRatio`看起来的范围是 1.1 到 9。较小的值使左列更宽。

我知道`LabelRatio`在您最初显示控件之前的设置是有效的。但是，我不确定一旦控件已显示，您需要做什么才能使其生效。您可以通过 Google MoveSplitterTo 查找 .NET 源代码并查看源代码`PropertyGridView`以获取更多详细信息。涉及它的计算和操作看起来有些复杂，我没有详细分析。

LabelRatio 最初设置为 2（即将可用的 PropertyGrid 宽度分成两半）。将其设置为 3 表示三分之一，4 表示四分之一。代码需要导入 System.Reflection

```
Public Sub MoveVerticalSplitter(grid As PropertyGrid, Fraction As Integer)
    Try
        Dim info = grid.[GetType]().GetProperty("Controls")
        Dim collection = DirectCast(info.GetValue(grid, Nothing), Control.ControlCollection)

        For Each control As Object In collection
            Dim type = control.[GetType]()

            If "PropertyGridView" = type.Name Then
                control.LabelRatio = Fraction

                grid.HelpVisible = True
                Exit For
            End If
        Next

    Catch ex As Exception
        Trace.WriteLine(ex)
    End Try
End Sub 
```

将 PropertyGrid 底部的描述窗格的大小更改为文本行

```
Public Sub ResizeDescriptionArea(grid As PropertyGrid, lines As Integer)
    Try
        Dim info = grid.[GetType]().GetProperty("Controls")
        Dim collection = DirectCast(info.GetValue(grid, Nothing), Control.ControlCollection)

        For Each control As Object In collection
            Dim type = control.[GetType]()

            If "DocComment" = type.Name Then
                Const Flags As BindingFlags = BindingFlags.Instance Or BindingFlags.NonPublic
                Dim field = type.BaseType.GetField("userSized", Flags)
                field.SetValue(control, True)

                info = type.GetProperty("Lines")
                info.SetValue(control, lines, Nothing)

                grid.HelpVisible = True
                Exit For
            End If
        Next

    Catch ex As Exception
        Trace.WriteLine(ex)
    End Try
End Sub 
```

# java - 如何为编辑页面创建验证器

> ID：14550473
> 
> 赞同：1
> 
> 时间：2013-01-27T18:12:15.583
> 
> 标签：java, sql, jsf, jsf-2

我有一个不寻常的问题，我不知道如何解决。

我有一个编辑页面，用于编辑数据库表中的数据。例如，当用户打开页面时，他会看到输入值`90`。使用下面的 Java 代码检查输入字段是否重复到 DB 表中。现在问题来了：当用户打开编辑页面并单击提交按钮时，他每次收到消息时都会收到`90 is already in use!`。我需要找到一个解决方案，如何将原始值传递给验证器，并将值检查到数据库表中。也许这个 sql 查询不正确。

```
// Validate Datacenter ID

    public void validateDatacenterID(FacesContext context, UIComponent component, Object value) throws ValidatorException, SQLException
    {

        Long l;
        String s = value.toString().trim();

        if (s.length() > 18)
        {
                throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                        "  Value is too long! (18 digits max)", null));
        }

        try
        {
            l = Long.parseLong(s);
            if (l > Integer.MAX_VALUE)
            {
                throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                        "  '" + l + "' is too large!", null));
            }
        }
        catch(NumberFormatException nfe) { l = null; }

        if (l != null)
        {

            if (ds == null) throw new SQLException("Can't get data source");

            Connection conn = null;
            PreparedStatement ps = null;
            ResultSet rs;
            int cnt = 0;
            try
            {
                conn = ds.getConnection();
                ps = conn.prepareStatement("SELECT count(1) from COMPONENTSTATS where COMPONENTSTATSID = ?");
                ps.setLong(1, l);
                rs = ps.executeQuery();

                while(rs.next()) cnt = rs.getInt(1);

                if (cnt > 0)
                {
                    throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                        "  '" + l + "' is already in use!", null));
                }

            }
            catch(SQLException x)
            {
                throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                        "  SQL error!", null));
            }
            finally
            {
                if (ps != null) ps.close();
                if (conn != null) conn.close();
            }
        }
        else
        {
            throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
                        s.isEmpty() ? "  This field cannot be empty!" : "  '" + s + "' is not a number!", null));
        }

    } 
```

我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-27T18:29:36.013

不要给出“COUNT(1)”，而是尝试给出“COUNT(*)”或“count(columnName)”。

# html - 填充在 IE7 和 IE8 中不起作用

> ID：14550481
> 
> 赞同：0
> 
> 时间：2013-01-27T18:12:53.340
> 
> 标签：html, css

我在网上搜索了这个问题的解决方案，但我并不幸运。我知道为 IE 设计网页样式比看着长草更糟糕。

所以，我的填充有问题。它在 IE9 和所有其他浏览器中运行良好，但在 IE7 和 IE8 中失败。也可能是较低的版本（我稍后会检查）

UL 应该符合背景谢谢

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org
 /TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>Document sans nom</title>

  <style type="text/css">
   a{font-weight:bold;color:#369;}
   a:link{text-decoration:none;}
   a:visited{color:#936;text-decoration:none;}
    a:hover{text-decoration:underline;}

   .manubar a:link{color: #FFFFFF;}
   .manubar a:visited{color: #DFFFDF;}
   .manubar{
    padding:10px 0 0 0;
    height:26px;
    text-transform:uppercase;
     background-color:#FF8C00;}
    .manubar ul{list-style-type:none;padding:0;margin:0;}
    .manubar ul li{text-align:center;border-left:1px solid 
     #999;display:block;float:left;}
     .manubar ul li:first-child{border:0;}
     .manubar ul li.insert{width:191px;}

     .home{width:94px;}
     .insert{width:94px;}
     .offer{width:94px;}
     .search{width:114px;}
      </style>
      </head>
     <body>

      <div style="height:30px; width:100%;">

      <nav class="manubar">
      <ul >
      <li class="home"  >
        <a href="index.php">Home</a>
    </li>
    <li class="insert">
        <a href="insert.php">Post</a>
    </li>
    <li class="offer">

    <a  href="offer.php">Offer</a>
    </li>
    <li class="search">

        <a  href="searching.php">Search</a>
    </li>

    </ul>
     </nav>
      </div>

      </body>
       </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:23:20.943

[nav](https://developer.mozilla.org/en-US/docs/HTML/Element/nav)标签是在 HTML5 中引入的。所以很明显它不会在旧浏览器中支持。`nav`用标签替换标签`div`以使其工作。（检查提供的链接中的浏览器兼容性部分）

**[小提琴](http://jsfiddle.net/rS5WG/1/)**（替换`nav`为`div`）

**要不然**

将以下代码粘贴在 Head 标签中

```
<!--[if lt IE 9]>
  <script>
      document.createElement('nav');
  </script>
<![endif]-->

<style type="text/css">
  nav{ 
       display: block;
  }
</style> 
```

[来源](https://stackoverflow.com/a/8779603/1577396)

**[工作小提琴](http://jsfiddle.net/rS5WG/2/)**

# html - 右侧带有自定义按钮和图像的 Joomla 文章

> ID：14550485
> 
> 赞同：0
> 
> 时间：2013-01-27T18:13:33.937
> 
> 标签：html, joomla, joomla2.5

我必须创建 Joomla 网站。我是 PHP 程序员，但对 Joomla 很陌生。我花了很多钱，阅读教程和其他人员。网站很简单，就是餐厅的名片。

我已经安装了 Joomla 2.5。我花了两天时间完成了以下工作： - 创建菜单 - 使用语言切换器创建多语言网站（2 种语言） - 创建简单的静态页面（文章） - 创建一个页面作为联系人 - 为我的网站创建简单的模板

但是，我不能做一些事情，也没有在教程或谷歌中找到任何答案。如果你打开这个文件[http://img1.uploadscreenshot.com/images/orig/1/2621034793-orig.jpg](http://img1.uploadscreenshot.com/images/orig/1/2621034793-orig.jpg)你可以在网站上看到三个不同页面的图片：

1) 文章右侧有三张图片。基本上，我不知道**创建包含一些自定义 HTML**的文章的最佳实践是什么（在这种情况下，这些是图像）。例如，我可以创建包含两列的表格——一列用于文本，另一列用于图像。如果没有 Joomla，我会创建两个 div，但是如何在这里完成？同样对于自定义 html，我需要为每种语言做同样的事情 - 我需要为每种语言添加图像，我不喜欢这样。我真的没有找到任何解决方案。你有什么建议吗？

2) 文章右侧有三个按钮。这是登陆页面上的文章。这可能是同一个问题 -**如何创建包含一些自定义 HTML 的文章（在这种情况下，这些是三个按钮 - 指向网站内页面的链接）**？我可以再次创建带有文本和按钮的表格，但这应该针对每种语言进行。这是一个好习惯吗？您还有其他一些建议来创建右侧带有三个按钮的文章吗？也许我可以创建一些自定义模块，但这听起来很奇怪。

3) 带有谷歌地图的联系页面。我已经创建了包含联系方式的联系页面。这是另一个问题，我会在其他时间问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:39:58.977

你好 Renathy，欢迎来到 Joomla！1）您当然可以在编辑器中插入 div 并使用浮动设置它们的样式；但是正如您提到的，这对翻译非常不利，并且允许用户轻松破坏布局。

您有以下选择：

**1.a )** Joomla 2.5+ 支持您可以在每篇文章的图像和链接组中指定的文章图像和缩略图。要扩展到 3 张图像需要做很多工作，您需要编写一个插件（或进行令人讨厌的核心 hack）并覆盖视图；它也没有很好的记录。这里有一个关于它的讨论：[在 Joomla 2.5 中的文章中添加附加图像](https://stackoverflow.com/questions/14510657/add-additional-images-to-articles-in-joomla-2-5)

**1.b）** 使用插件添加上面的额外图像。然后使用一个模块来显示图像而不是视图覆盖。

**1.c)** 使用自定义图像管理解决方案将图像链接到文章，然后使用插件来显示它们。更容易，但仍然需要大量工作。我已经在一个站点上完成了这项工作并且工作正常，尽管我现在会更改很多代码。据我所知，没有可用的扩展可以做到这一点。

所有这三种解决方案都允许您使用适当的 div 浮动响应来使用适当的内容浮动，并将内容的布局与图像隔离开来，从而为内容编辑器提供一个可靠的环境，并且易于翻译（尽管，如果你去对于 1.a) 或 1.b)，我强烈建议您使用适当的翻译套件，例如 Falang 或 JoomFish（Falang 是与旧 1.5 版本不同的 Joomfish 端口）

**2)** 您将使用模块解决上述问题。在您的模板中创建一个主

```
<div class="content-box">
<div class="content-main"> here you will place your component's output.</div>
<div class="content-sidebar"> here you will output a new module position, name it "article-sidebar"</div> 
```

然后像这样设计它：

```
div.content-box {
 /* here you need a clearfix choose one here: https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best/211467#211467 */
}
div.content-box div.content-main {
  width:70%;display:inline-block;float:left;
}
div.content-box div.content-sidebar {
  width:29.99%;float:right;
}
div.content-wide div.content-sidebar {
  display:none;
} 
```

但是您可能不希望在所有页面上都这样做，然后您可以在生成模板时以编程方式处理它。

这个想法是：在您的模板输出中，您正在编写

```
<div class="content-box"> 
```

相反，当您的文章侧边栏包含某些内容时，有条件地添加一个类：

```
<div class="content-<?php 
if ($this->countModules("article-sidebar")==0) 
  echo "wide";
else
  echo "box";
?>"> 
```

这将动态地改变 div 的类，因此您只提供 1 个 css。

此时，创建一个模块并选择“仅在选定页面上”显示它。

**3）** 当你想改变一个视图时，永远不要改变文件。而是将所有视图的 php 复制到模板文件夹/html/com_contact/contact 下的文件夹中。即使您要更改不同的布局，您仍然需要将 default.php 复制到那里。然后更改它插入谷歌地图。

最后的考虑。您应该避免编辑核心文件。Joomla 有时会发布安全更新，应用它们会很痛苦。祝你的网站好运。

# sql-server-2008 - 如何在 SQL Server 中创建函数

> ID：14550486
> 
> 赞同：80
> 
> 时间：2013-01-27T18:13:37.760
> 
> 标签：sql-server-2008

请帮助我，如何使用函数过滤 SQL 中的单词？

我很难解释，所以我举个例子：

```
ID       |       WebsiteName      |
-----------------------------------
1        |      www.yahoo.com     |
2        |      www.google.com    |
3        |      www.youtube.com   | 
```

我想要的是，如何获得网站的名称。我想选择具有这样输出的记录。如何删除“www。” 和记录中的“.com”。

```
ID      |      WebsiteName
--------------------------    
1       |        yahoo 
```

谢谢您的帮助。:D

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2013-01-27T18:16:51.343

这个怎么样？

```
CREATE FUNCTION dbo.StripWWWandCom (@input VARCHAR(250))
RETURNS VARCHAR(250)
AS BEGIN
    DECLARE @Work VARCHAR(250)

    SET @Work = @Input

    SET @Work = REPLACE(@Work, 'www.', '')
    SET @Work = REPLACE(@Work, '.com', '')

    RETURN @work
END 
```

然后使用：

```
SELECT ID, dbo.StripWWWandCom (WebsiteName)
FROM dbo.YourTable ..... 
```

当然，这是**受到严格限制**的，因为它只会`www.`在开头和`.com`结尾剥离 - 仅此而已（因此它不适用于其他主机名称，例如,等`smtp.yahoo.com`其他 Internet 域）`.org``.edu``.de`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-28T16:19:47.700

This one get everything between the "." characters. Please note this won't work for more complex URLs like "www.somesite.co.uk" Ideally the function would check for how many instances of the "." character and choose the substring accordingly.

```
CREATE FUNCTION dbo.GetURL (@URL VARCHAR(250))
RETURNS VARCHAR(250)
AS BEGIN
    DECLARE @Work VARCHAR(250)

    SET @Work = @URL

    SET @Work = SUBSTRING(@work, CHARINDEX('.', @work) + 1, LEN(@work))   
    SET @Work = SUBSTRING(@work, 0, CHARINDEX('.', @work))

    --Alternate:
    --SET @Work = SUBSTRING(@work, CHARINDEX('.', @work) + 1, CHARINDEX('.', @work) + 1)   

    RETURN @work
END 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-27T18:28:49.053

我可以给一个小hack，你可以使用T-SQL函数。试试这个：

```
SELECT ID, PARSENAME(WebsiteName, 2)
FROM dbo.YourTable ..... 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-06T21:19:06.677

You can use stuff in place of replace for avoiding the bug that Hamlet Hakobyan has mentioned

```
CREATE FUNCTION dbo.StripWWWandCom (@input VARCHAR(250)) 
RETURNS VARCHAR(250) 
AS BEGIN
   DECLARE @Work VARCHAR(250)
   SET @Work = @Input

   --SET @Work = REPLACE(@Work, 'www.', '')
   SET @Work = Stuff(@Work,1,4, '')
   SET @Work = REPLACE(@Work, '.com', '')

   RETURN @work 
END 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-17T11:01:17.947

This will work for most of the website names :

`SELECT ID, REVERSE(PARSENAME(REVERSE(WebsiteName), 2)) FROM dbo.YourTable .....`

# android - 新的异步任务 ，什么去哪里？

> ID：14550487
> 
> 赞同：-2
> 
> 时间：2013-01-27T18:13:50.383
> 
> 标签：android, android-asynctask

关于`AsyncTask<ObjectA, ObjectB, ObjectC>`参数，我总是对哪个对象影响什么感到困惑。

一个影响我的`doInBackGround`返回类型，一个影响我的`doInBackGround`输入类型，第三个对象影响其他东西。

当我要更改要发送和返回的类型时，这会变得非常混乱。

有什么`ObjectA`作用

有什么`ObjectB`作用

有什么`ObjectC`作用

（忽略可能滥用效果/影响）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:16:38.537

从[文档](http://developer.android.com/reference/android/os/AsyncTask.html)中：

```
ObjectA - doInBackground();

ObjectB - progress indicator: publishProgress(), etc

ObjectC - onPostExecute(), what doInBackground() must return 
```

实际引用：

> AsyncTask 的泛型类型
> 
> * * *
> 
> 异步任务使用的三种类型如下：
> 
> 1.Params，执行时发送给任务的参数类型。
> 
> 2.Progress，后台计算时发布的进度单元类型。
> 
> 3.Result，后台计算结果的类型。
> 
> 并非所有类型都始终由异步任务使用。要将类型标记为未使用，只需使用类型[**Void**](http://developer.android.com/reference/java/lang/Void.html)：

```
private class MyTask extends AsyncTask<Params, Progress, Result> { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:17:15.407

在提出此类问题之前请阅读文档：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

它说：

> 异步任务使用的三种类型如下：
> 
> 1.  Params，执行时发送给任务的参数类型。
> 2.  进度，在后台计算期间发布的进度单元的类型。
> 3.  Result，后台计算结果的类型。
> 
> 并非所有类型都始终由异步任务使用。要将类型标记为未使用，只需使用类型 Void。

# ios6 - IOS 6 - 自动旋转 MPMovieplayer

> ID：14550489
> 
> 赞同：0
> 
> 时间：2013-01-27T18:13:54.687
> 
> 标签：ios6, mpmovieplayercontroller

所以，我正在修复 Iphone 的界面是纵向的，我想在播放视频时显示风景（使用 MPMoviePlayerController），我已经在 ios6 sdk 中阅读过，ShouldAutorotateToInterfaceOrientation 已被弃用。如何仅旋转此播放器视图？我只能旋转整个应用程序，但不想这样做。

我试过了

```
(BOOL)shouldAutorotate
{
    return [[self.viewControllers lastObject] shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [[self.viewControllers lastObject] preferredInterfaceOrientationForPresentation];
} 
```

在[这个链接](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6/12522119#12522119)或[链接](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6/12522119#12522119)中，但视频仍然没有改变..你能帮帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:13:06.230

首先，在您的应用设置中，您是否允许除纵向之外的任何其他方向？

其次，您的视图控制器是否嵌入在 UINavigationController/UITabBarController/UISplitViewController 中？

您发布的代码应该作为一个类别或通过子类化 UINavigationController 来工作。如果您的容器不是 UINavigationController，它将无法工作。（至少不适用于 UITabBarController）。

您还可以发布您启用视图控制器旋转的代码吗？

此外，显示您的类别/子类的整个代码可能会有所帮助。

# windows - 如何正确地得到这个`echo "echo mukesh >> a.txt" >> b.txt`

> ID：14550490
> 
> 赞同：0
> 
> 时间：2013-01-27T18:13:58.563
> 
> 标签：windows, batch-file

我希望文本文件 b.txt 包含**echo mukesh >> a.txt**

我试过了

```
 echo "echo mukesh >> a.txt" >> b.txt 
```

但它也将文本放在“”上，下面的内容似乎也不起作用

```
 echo echo mukesh >> a.txt >> b.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:17:39.483

转义任何未引用的特殊字符。我放括号以防止尾随空格。

```
 (echo echo mukesh ^>^> a.txt) >> b.txt 
```

# vsto - Excel 互操作 VSTO 图表：检索图表数据范围？

> ID：14550491
> 
> 赞同：1
> 
> 时间：2013-01-27T18:14:03.820
> 
> 标签：vsto, excel-interop

我知道如何设置包含数据的范围（chart.SetSourceData(...)）

但是如何检索图表数据范围？range = chart.GetDataSource() 是否存在？

我找不到它了。

欢迎帮助，

让-玛丽

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-18T21:11:16.867

我认为没有直接的方法。我最好的建议是检查图表的系列并检查系列的值和 XValues。

```
foreach (Series series in chart.SeriesCollection()){
   Range values = series.Values;
   Range xvalues = series.XValues;
} 
```

然后，您可以将所有范围连接在一起并获取图表的源数据。

# mysql - mysql左连接多个表，只有主键作为第一个表的外键

> ID：14550494
> 
> 赞同：0
> 
> 时间：2013-01-27T18:14:14.877
> 
> 标签：mysql, left-join

```
TB 1 : user_profile as ur-> id(PK),name (total 4k records all unique)    
TB 2 : user_course_rel as ucr-> id,course_id,year_id,division,user_id(Fk)    
TB 3 : students_attendance_lect as sal-> id,subject_id,date,student_id(Fk)    
student_id(Fk) = user_id(Fk) = id(PK). 
```

我想离开加入 TB1 并获取属于特定课程、年份、部门的所有学生的姓名，以及主题和日期的参与者，而不是应该是 132 条唯一记录的参与者。
运行以下查询后，我得到总数（4k 条记录）

```
select distinct(ur.id), ur.fname
from user_profile as ur
inner join user_course_rel as ucr
    on ucr.user_id=ur.id
left join students_attendance_lect as sal
    on sal.student_id=ucr.user_id
    and ucr.course_id=1
    and ucr.year_id=1
    and ucr.division=3
    and sal.subject_id=2
    and sal.date='2013-01-21' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:25:01.170

LEFT JOIN 中的几个项目看起来应该在 WHERE 子句中。我不是 100% 清楚您的问题是什么，但请尝试：

```
select distinct(ur.id), ur.fname
from user_profile as ur
inner join user_course_rel as ucr
    on ucr.user_id=ur.id
left join
    (SELECT sal.student_id, sal.subject_id, sal.date
     FROM students_attendance_lect as sal
     WHERE sal.date='2013-01-21'
     AND sal.subject_id = 2) AS sa
    ON sa.student_id=ucr.user_id
WHERE ucr.course_id=1
    and ucr.year_id=1
    and ucr.division=3 
```

您编写它的方式是要求数据库在课程 ID 为 1、部门为 3、主题 ID 为 2 或日期为“2013-01-21”的任何行上进行 LEFT JOIN，你明白吗？

# mysql - 如何返回 mysql 数据库均匀间隔的列和列标题 vb.net？

> ID：14550495
> 
> 赞同：0
> 
> 时间：2013-01-27T18:14:18.247
> 
> 标签：mysql, vb.net, visual-studio-2010

我无法找到有关此的太多信息。

如何均匀返回数据库列标题和空间列查询数据？我已经能够使用 Space() 分隔数据，但记录的字符不同，因此记录数据交错返回，如下所示：

RS.Read() 返回
============================================= ======
3942 员工描述正常工作时间加班时间
343243543 员工描述正常工作时间加班工作时间

代码
================================================== ==
导入 MySql.Data.MySqlClient 导入 MySql.Data

```
MySqlCmd = New MySqlCommand(sql, dbCon)
dbCon.Open()
DR = MySqlCmd.ExecuteReader
    While DR.Read
         TextBox1.Text = TextBox1.Text & _
         DR.Item("DATE") & _
         Space(5) & DR.Item("JOB_NUMBER") & _
         Space(5) & DR.Item("ASSOCIATE") & _
         Space(5) & DR.Item("DESCRIPTION") & _
         Space(5) & DR.Item("REGULAR_HOURS") & _
         Space(5) & DR.Item("OT_HOURS") & _
         vbCrLf & vbCrLf
    End While 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:31:48.803

您可能想查看strings.rset 和strings.lset。您还必须为您的文本框使用等宽字体。更常用的方法是使用 datagridview 而不是文本框。

# sniffer - 使用 JPCAP 构建入侵检测系统的功能

> ID：14550496
> 
> 赞同：1
> 
> 时间：2013-01-27T03:44:17.083
> 
> 标签：sniffer, intrusion-detection

我正在做入侵检测系统的项目。我正在使用 JPCAP 库来捕获数据包。使用 JPCAP，我能够构建 KDD 99 数据集中提到的 TCP 连接的基本特征（例如持续时间、协议类型、服务、源端口、目标端口）。我想构建诸如“**热门指标、num_failed_logins、su_attempted、is_hot_login、is_guest_login”之**类的内容特征。以及基于时间的功能，例如“**计数、serror_rate、rerror_rate、相同的服务率**”。

因此，请给我任何有关从实时流量构建此类功能的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T07:42:33.797

您实现的功能只是网络级别的功能，即时间持续时间、协议类型、服务、源端口、目标端口，您可以通过使用 JPCAP 读取 IP 数据包获得。问题是 JPCAP/Libpcap 只是一个嗅探器库，不处理低级协议问题。用于处理所有 TCP/IP 内容，例如

1.  IP分片
2.  TCP 重传
3.  数据包重新排序

我建议将您的代码与模拟 Linux 2.0.x 的 IP 堆栈的[Libnids集成。](http://libnids.sourceforge.net/)并提供 IP 碎片整理、TCP 流组装和审查[Justniffer](http://justniffer.sourceforge.net/)作为实现。

# ios - 使用 AFNetworking（AFHTTPClient 子类）将 JSON 发送到服务器 => 这是一个异步操作

> ID：14550498
> 
> 赞同：0
> 
> 时间：2013-01-27T18:14:24.890
> 
> 标签：ios, json, asynchronous, afnetworking

因此，经过大量研究，我想出了如何`NSDictionary`从我的 iOS 6 客户端发送一个到我的 Rails 服务器。我用过`AFNetworking`。下面是发送 JSON 的客户端代码。但是，我不确定这是否是异步调用，因为我看不到在哪里使用了操作队列。如果不是，那么如何将其变为异步调用？

```
 -(void)sendEntryToServerAsJSON:(EntryParent*)_entryToBeSaved
  {
     NSDictionary* dictToBeSerialized = [_entryToBeSaved convertEntryParentObjToDict];

     [[appAPIClient sharedClient]postPath:@"entries.json"
                          parameters:dictToBeSerialized
                             success:^(AFHTTPRequestOperation *operation, id responseObject) {
       NSLog(@"Successfully sent JSON %@", [responseObject description]);
      }
                             failure:^(AFHTTPRequestOperation *operation, NSError *error)    {
       NSLog(@"Could not send JSON %@", [error description]);
      }];
  } 
```

这是我的 AFHTTPClient 实现

```
 + (appAPIClient *)sharedClient
 {
   NSLog(@"Inside appAPIClient sharedclient ");
   static appAPIClient *_sharedClient = nil;
   static dispatch_once_t oncePredicate;
   dispatch_once(&oncePredicate, ^{
    _sharedClient = [[self alloc]
                     initWithBaseURL:[NSURL URLWithString:URL_STR]];
  });

   return _sharedClient;
 }
 //==============================================================================

 - (id)initWithBaseURL:(NSURL *)url
 {
   self = [super initWithBaseURL:url];
   if (!self)
  {
    return nil;
   }
   NSLog(@"init with base url - appAPIClient");
   [self registerHTTPOperationClass:[AFJSONRequestOperation class]];

   // Accept HTTP Header; see http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1
[self setDefaultHeader:@"Accept" value:@"application/json"];

   return self;
} 
```

* * *

我将不胜感激任何反馈以改进此代码并使其异步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:16:16.560

一）

请求被添加到主线程运行循环中，因此它们是异步的，没有线程或队列。runloops 有点像 C 的 select 方法

见：
[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSRunLoop_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSRunLoop_Class/Reference/Reference.html)

b）请提出一个单独的问题:)

# powershell-2.0 - 重命名文件并添加长度（以字节为单位）power shell

> ID：14550506
> 
> 赞同：0
> 
> 时间：2013-01-27T18:14:58.923
> 
> 标签：powershell-2.0, rename, maxlength, get-childitem

我有一个问题：在文件名中我必须写下它们的长度

例如 qwerty.tmp → qwerty_12039.tmp ！请帮忙

采用：

获取子项 c:\文件夹 | 重命名项目 -NewName {$_.name -replace ".tmp", $_length ".tmp"}

但它不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:23:33.530

你离开了 '。' 那里。另外：我会改用 BaseName ：

```
ls C:\folder | Rename-Item -NewName { $_.BaseName + $_.Length + '.tmp' } 
```

# xml - 在 Scala 中选择对象序列化格式

> ID：14550507
> 
> 赞同：1
> 
> 时间：2013-01-27T18:15:09.587
> 
> 标签：xml, json, scala, serialization, yaml

我有一个管理节点和弧线图的应用程序，其中节点具有少量属性。现在我需要保存数据，我需要选择一种序列化格式。这是一些明显的列表，但可能还有其他我没有考虑过的。

*   Java 序列化
*   XML
*   JSON
*   yaml
*   谷歌协议缓冲区

出于多种原因，Java 序列化无法启动，即使在 Java 世界中，出于互操作性、模式迁移和易用性的原因，XML 和其他序列化格式也是首选。

Scala 的 XML 支持似乎是一个显而易见的选择。然而，我个人觉得将 XML 文字嵌入源代码的想法令人反感（甚至该语言的创建者也承认他对这个决定感到遗憾）。这个特性在生成标记文本时可能更有意义——但是在序列化对象时，你真的需要一个更高级别的 API，它尽可能地将理解内部数据结构的代码与理解序列化语法的代码分开格式 - 这意味着理想情况下，您永远不会在源代码中看到任何 XML。此外，Google 网络搜索显示许多博客文章声称 Scala 的 XML DOM 有很多缺陷并且使用起来很尴尬。（也有许多图书馆声称可以改善这种情况，但随后就变成了选择哪一个的问题。）

JSON 和 Yaml 也可以工作——这里的问题是最流行的序列化库是在 Java 中的，因此任务涉及选择或编写适当的 Scala 包装器类。此外，这些库中的许多都依赖于 bean 反射，这在 Scala 中是可能的，但有些尴尬，需要额外的注释才能使事情正常工作。

最后，我将 Google protobufs 用于许多其他序列化任务。好的部分是 protoc 编译器可以生成与目标语言习语相匹配的优雅 API。然而，在这种情况下，protobufs 的优势之一，即编码数据流的小尺寸，并不重要，我宁愿有一些序列化数据是人类可读的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T21:33:02.410

在我看来，JSON 是 Scala 世界中的一种流行选择，尤其是 Play 框架提供的基于类型类的 API：[http ://www.playframework.org/documentation/2.0.1/ScalaJson](http://www.playframework.org/documentation/2.0.1/ScalaJson)

# ios - 如何可靠地检测 uiview 框架相对于屏幕的原点 Y？

> ID：14550512
> 
> 赞同：2
> 
> 时间：2013-01-27T18:15:45.233
> 
> 标签：ios, cocoa-touch

> **可能重复：**
> [iPhone - 在整个 UIWindow 中获取 UIView 的位置](https://stackoverflow.com/questions/1465394/iphone-get-position-of-uiview-within-entire-uiwindow)

有没有内置的方法来做到这一点？还是我必须跳过所有超级视图，将所有 Y 原点相加，直到我到达 mainWindow？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:21:09.583

这是[iPhone 的副本 - 在整个 UIWindow 中获取 UIView 的位置](https://stackoverflow.com/questions/1465394/iphone-get-position-of-uiview-within-entire-uiwindow)

只需使用：

`[aView convertPoint:localPosition toView:nil];`

# regex - 将点 (.) 替换为空格 (" ") awk、sed 或 grep

> ID：14550513
> 
> 赞同：0
> 
> 时间：2013-01-27T18:15:53.220
> 
> 标签：regex, sed, awk, grep

我需要以这种方式浏览 tcpdump 文件，这些文件的 IP 地址后跟它们的源或目标端口：`192.168.1.0.80`到这个：`192.168.1.0 80`。

如何使用 awk、sed 或 grep 执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:18:14.193

与`sed`：

```
tcpdump -v -n |
sed -r 's@([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})\.([0-9]{1,5})@\1 \2@g' 
```

## 解释

*   `-r`switch 代表扩展的*正则表达式*（我用它来避免括号反斜杠）
*   `s@@@`是一个替代*骨架*，分隔符可以是我们想要的任何东西，而不仅仅是`s///`. s/之前/之后/
*   `(`分组并捕​​获到 \1（到 \N）
*   `[0-9]{1,3}`任何字符：'0' 到 '9'（1 到 3 次（尽可能匹配））
*   `\.`一个字面的“。”
*   `)`捕获结束
*   `\1`并且`\2`是被捕获的东西
*   `g`修饰符代表*所有出现*

# r - 多核生成地块

> ID：14550515
> 
> 赞同：3
> 
> 时间：2013-01-27T18:16:04.167
> 
> 标签：r, parallel-processing, plot, multicore

我有一个`for`循环，它生成 via`png()`和`dev.off()`一个绘图并将其保存到工作目录。

我拥有的循环类似于以下**示例**

```
test.df<-data.frame(id=1:25000, x=rnorm(25000),y=rnorm(25000))

for (i in test.df$id){
  plot(test.df$x[test.df$id==i], test.df$y[test.df$id==i], xlab="chi",ylab="psi")
} 
```

循环将`for`运行并生成数千个图。是否可以让它在我系统的所有 8 个内核上并行运行，以便我可以更快地获得绘图？

PS。代码是一个**例子**。我原来的问题和情节要复杂得多。不要在示例中传播病毒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:19:05.170

如果您使用的是新版本的 R，那么这应该很简单。诀窍是创建一个可以以任何顺序在任何核心上运行的函数。首先我们创建我们的数据框：

```
test.df = data.frame(id=1:250, x=rnorm(250),y=rnorm(250)) 
```

接下来我们创建在每个核心上运行的函数：

```
#I could also pass the row or the entire data frame
myplot = function(id) {
  fname = paste0("/tmp/plot", id, ".png")
  png(fname)
  plot(test.df$x[id], test.df$y[id], 
      xlab="chi",ylab="psi")
  dev.off()
  return(fname)
} 
```

然后我加载`parallel`包（这带有base R）

```
library(parallel) 
```

然后使用`mclapply`

```
no_of_cores = 8
##Non windows
mclapply(1:nrow(test.df), myplot, 
         mc.cores = no_of_cores)

##All OS's
cl = makeCluster(no_of_cores)
clusterExport(cl, "test.df")
parSapply(cl, 1:nrow(test.df), myplot)
stopCluster(cl) 
```

这里有两个优点：

1.  包`parallel`自带R，所以我们不需要安装任何额外的东西
2.  我们可以关闭“并行”部分：

    ```
    sapply(1:nrow(test.df), myplot) 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-27T19:20:08.650

使用`foreach`包，您必须最低限度地修改您的核心代码。此外，您还可以选择有关操作系统或其他问题的任何后端。

```
##
## Working dir and data generation
##
setwd("/path/to")
N <- 25000
test.df<-data.frame(id=1:N, x=rnorm(N),y=rnorm(N))

##
## Making a cluster
##
require(doSNOW) # Or any other backend of your choice
NC <- 8         # Number of nodes in cluster, i.e. cores
cl <- makeCluster(rep("localhost", NC), type="SOCK")
registerDoSNOW(cl)

## 
## Core loop
##
foreach(i=1:N) %dopar% {
  png(paste("plot",i,".png",sep=""))
  plot(test.df$x[test.df$id==i], test.df$y[test.df$id==i], xlab="chi",ylab="psi")
  dev.off()
}

##
## Stop cluster
##
stopCluster(cl) 
```

选择一个核心很容易：只需替换`%dopar%`为`%do%`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T19:41:00.213

由于`mclapply`windows不支持，所以我为windows用户提供了一个解决方案，使用`parallel`包。

```
cl <- makeCluster(8)
parSapply(cl, 1:20, fun, fun.args) 
```

# ajax - jQuery：用于 ajax 函数的 toggleClass 事件处理函数

> ID：14550519
> 
> 赞同：1
> 
> 时间：2013-01-27T18:16:22.713
> 
> 标签：ajax, jquery, event-handling

我想知道是否有人可以帮助指导我在 jQuery 中使用 toggleClass 时如何编写事件？

我有一个项目列表，当我单击一个项目时，它会突出显示它，当有人从列表中单击另一个项目时，前一个突出显示的项目会消失并突出显示当前的点击。此外，如果我单击已突出显示的同一项目，它就会消失。

现在我正在尝试编写一个函数来仅在突出显示时调用 ajax。所以当再次按下它时（当高亮被移除时）它不会再次运行 ajax 函数。

```
 $(".media").on('click',function(){
            var $this = $(this);

            // highlighting the object
            $this.toggleClass('selectMedia').siblings().removeClass('selectMedia');

            // saving the id

            var selId1 = $this.data('id');
            $.post("ajax/ajax_sessions.php", {"sel_1":selId1}, function(data) {
                alert(data); // alerts 'Updated'
            });
        }); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:21:54.887

只需在执行 AJAX 请求之前检查类的存在：

```
if ( ! $this.hasClass('selectMedia') ) return;

// Now do your AJAX request... 
```

# c# - ASP.NET -> 将 ButtonColumn 添加到 DataTable 或 DataGridView（以编程方式）

> ID：14550521
> 
> 赞同：0
> 
> 时间：2013-01-27T18:16:26.037
> 
> 标签：c#, asp.net

在弄清楚如何将 ButtonColumn 添加到 DataTable（或者，可以说是 DataGrid）时遇到奇怪的问题。我想做的就是能够使用数据表中的数据来告诉按钮在单击时执行某些操作，但我似乎失败了。

谷歌搜索没有显示任何立即有用的东西，因为它们都在使用 ItemTemplates。

```
//dt.Columns.Add("Ajax Link", typeof(Literal));
ButtonColumn newButtonColumn = new ButtonColumn();
newButtonColumn.HeaderText = "Asp.Net Link";
dt.Columns.Add(); // Doesn't want newButtonColumn.

for (int i = 0; i < dt.Rows.Count; i++)
{
    /*
    Literal newAjaxLink = new Literal();
    newAjaxLink.Text = "Test";//"<button type=\"button\" onclick=\"AjaxButton_onClick(" + dt.Rows[i]["UserInfoID"].ToString() + "); StoreUserInfoID(" + dt.Rows[i]["UserInfoID"].ToString() + "); ShowDiv();\">Ajax Link</button>";
    dt.Rows[i]["Ajax Link"] = newAjaxLink; // @todo: HTML button that triggers an AJAX call for load the proper data into the fields. Also to make the DIV visible.
    */

    Button newButton = new Button();
    newButton.ID = dt.Rows[i]["UserInfoID"].ToString(); 
    newButton.Text = "Asp.Net Link";
    newButton.Click += new EventHandler(Button_Link_Click);
    dt.Rows[i]["Asp.Net Link"] = newButton; //@todo: Just a button to open a new window with the proper ID.
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:30:21.450

**你在哪里将按钮添加到相应的东西？**...似乎你只是给按钮赋值，而不是添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:15:24.083

尝试这个

```
DataTable dt = new DataTable("Table"); 
DataColumn col = dt.Columns.Add("ID", typeof(Int32));
col.AllowDBNull = true; 
```

# regex - 整数和浮点数的正则表达式

> ID：14550526
> 
> 赞同：19
> 
> 时间：2013-01-27T18:16:39.593
> 
> 标签：regex

我需要一个正则表达式来匹配整数值和浮点数（而浮点数有一个“。”作为分隔符）。这些数字总是在括号中，并且可能有一个前导“+”。

什么应该是有效的：

*   (1.0)
*   (1)
*   (9.9)
*   (10000000)
*   (+15)

什么应该是无效的：

*   1.0 --- 因为没有括号
*   5 --- 因为没有括号
*   (1,5) --- 因为“，”而不是“。”
*   (a) --- 因为不是数字
*   (1 5) --- 因为不止一个数
*   (1+5) --- 因为......好吧......只是模式失败了
*   [5] --- 因为括号错误

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-27T18:20:07.517

这应该适用于大多数像正则表达式引擎的 perl：

```
/(\d+(?:\.\d+)?)/ 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-04-14T12:06:59.137

不幸的是，当前接受的答案是有缺陷的（它将匹配“1a5”，但不会匹配“.5”）。所以我决定编写自己的 Regex，以及一个便宜的 Perl 脚本来测试它。

## 要求

正则表达式将匹配一个整数或浮点数，前面有一个 +/- 符号。我不关心 E 符号，所以我忽略了它。
nhahtdh 提到“（5.）和（.6）”：“5。” 在我看来不正确，尾随句号没有目的。但是，“.6”确实有效，因为前导句点表示正值 < 1（即，它是“0.6”的缩写）。
最初`(?=.)`是为了确保空白字符串不匹配。
作为奖励，我使用了嵌套组，以便您可以轻松提取数字的不同部分：

*   $1 = 整数
*   $2 = 整数部分
*   $3 = 带前导周期的小数部分
*   $4 = 小数部分

## 正则表达式

```
^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$ 
```

## 测试

```
$ perl -e 'use strict; use warnings; my $a = "1.0"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<1.0>
Integer:<1>
Fraction:<0>
$ perl -e 'use strict; use warnings; my $a = "1"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<1>
Integer:<1>
No fraction
$ perl -e 'use strict; use warnings; my $a = "9.9"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<9.9>
Integer:<9>
Fraction:<9>
$ perl -e 'use strict; use warnings; my $a = "10000000"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<10000000>
Integer:<10000000>
No fraction
$ perl -e 'use strict; use warnings; my $a = "+15"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<+15>
Integer:<15>
No fraction
$ perl -e 'use strict; use warnings; my $a = "1,5"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH
$ perl -e 'use strict; use warnings; my $a = "a"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH
$ perl -e 'use strict; use warnings; my $a = "1 5"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH
$ perl -e 'use strict; use warnings; my $a = "1+5"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH
$ perl -e 'use strict; use warnings; my $a = "5."; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH
$ perl -e 'use strict; use warnings; my $a = ".6"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<.6>
Integer:<>
Fraction:<6>
$ perl -e 'use strict; use warnings; my $a = ".5"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
MATCH
Float:<.5>
Integer:<>
Fraction:<5>
$ perl -e 'use strict; use warnings; my $a = "1a5"; if ($a =~ /^(?=.)([+-]?([0-9]*)(\.([0-9]+))?)$/) { print "MATCH\nFloat:<$1>\n"; print defined $2 ? "Integer:<$2>\n" : "No integer\n"; print defined $4 ? "Fraction:<$4>\n" : "No fraction\n"; } else { print "NO MATCH\n"; }'
NO MATCH 
```

如果有什么我忽略了，请告诉我。

## 添加

强制大括号是微不足道的，只需将整个东西包裹在 ESCAPE 括号中：

```
^\((?=.)([+-]?([0-9]*)(\.([0-9]+))?)\)$ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-02-20T06:56:54.093

我不确定，但我认为接受的答案不会接受`.6`。

```
my $float = qr/(\([-+]?\d*\.?\d+\))/;
my $test = "this is my +15.8 (-17.3) 0.9 (8) .7 -.6 string"
    . "(+5.8) -6.3 (0.9) 8 (.9) (-.16)";

while ($test =~ /$float/g) {
    printf("<$1>\n");
} 
```

我从某个地方偷了这个图案。也许[https://www.regular-expressions.info/floatingpoint.html](https://www.regular-expressions.info/floatingpoint.html)。

```
<(-17.3)>
<(8)>
<(+5.8)>
<(0.9)>
<(.9)>
<(-.16)> 
```

**更新：**添加了括号。

# sql - SQL Server 2008 R2 在单个批量更新问题中触发多行

> ID：14550527
> 
> 赞同：1
> 
> 时间：2013-01-27T18:16:40.623
> 
> 标签：sql, sql-server, sql-server-2008, triggers, sql-update

我以这种方式在 SQL Server 2008 R2 中实现了触发器 -

```
 ALTER TRIGGER [dbo].[trgtblOrgStaffAssocLastUpdate] ON [dbo].[tblOrgStaffAssoc]
       AFTER UPDATE
    AS

    IF EXISTS (SELECT i.* FROM INSERTED i inner join deleted d on i.ORG_ID = d.ORG_ID and isnull(i.StaffType, -1111) = isnull(d.StaffType, -1111)
    where i.Deleted = 0
    and (isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier))          
    ))
    BEGIN

        IF EXISTS (SELECT * FROM DELETED)
        BEGIN   

            --UPDATE PER_ID      
            update l    
            set PER_ID = 1, UpdatedOn =  GETDATE()
            from dbo.tblOrgStaffAssocLastUpadate l inner join [dbo].[inserted] i on l.ORG_ID = i.ORG_ID and l.StaffType = i.StaffType
            inner join [dbo].[deleted] d on i.ORG_ID = d.ORG_ID and i.StaffType = d.StaffType
            where isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier))          
        END         

END 
```

我的目的是在更新 tblOrgStaffAssoc 时更新 tblOrgStaffAssocLastUpadate。只有一排，它工作正常。但是，对于一批发送的多行，它仅在 tblOrgStaffAssocLastUpadate 更新一行，而 tblOrgStaffAssoc 更新了多行。

当我使用中间表 _Inserted 和 _deleted 来缓冲 INSERTED 和 DELETED 数据并使用永久表像这样更新时 -

```
 ALTER TRIGGER [dbo].[trgtblOrgStaffAssocLastUpdate] ON [dbo].[tblOrgStaffAssoc]
   AFTER UPDATE
AS

IF EXISTS (SELECT i.* FROM INSERTED i inner join deleted d on i.ORG_ID = d.ORG_ID and isnull(i.StaffType, -1111) = isnull(d.StaffType, -1111)
where i.Deleted = 0
and (isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier))          
))
BEGIN

    IF EXISTS (SELECT * FROM DELETED)
    BEGIN   
        IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[_inserted]') AND type in (N'U'))
            insert into [dbo].[_inserted]
            select * from inserted 
        else
            select * into [dbo].[_inserted]
            from inserted

        IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[_deleted]') AND type in (N'U'))
            insert into [dbo].[_deleted]
            select * from deleted 
        else
            select * into [dbo].[_deleted]
            from deleted

        --UPDATE PER_ID      
        update l    
        set PER_ID = 1, UpdatedOn =  GETDATE()
        from dbo.tblOrgStaffAssocLastUpadate l inner join [dbo].[_inserted] i on l.ORG_ID = i.ORG_ID and l.StaffType = i.StaffType
        inner join [dbo].[_deleted] d on i.ORG_ID = d.ORG_ID and i.StaffType = d.StaffType
        where isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier))          
    END

END 
```

它工作正常。更改永久表 _Inserted 以使用 #inserted 或表变量 @inserted 也不起作用。

显然使用永久表不是一个好主意。我不知道触发器是如何以这种方式工作的。任何人都可以帮忙吗？

谢谢

编辑以回答@usr 的评论 -

如果我使用它不能正常工作 -

```
update l set PER_ID = 1, UpdatedOn = GETDATE() from dbo.tblOrgStaffAssocLastUpadate l inner join [dbo].[inserted] i on l.ORG_ID = i.ORG_ID and l.StaffType = i.StaffType inner join [dbo].[deleted] d on i.ORG_ID = d.ORG_ID and i.StaffType = d.StaffType where isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) 
```

仅更新一行。其余行根本不更新。即使我可以看到返回多行，如果我使用

```
select l.* from dbo.tblOrgStaffAssocLastUpadate l inner join [dbo].[inserted] i on l.ORG_ID = i.ORG_ID and l.StaffType = i.StaffType inner join [dbo].[deleted] d on i.ORG_ID = d.ORG_ID and i.StaffType = d.StaffType where isnull(i.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) <> isnull(d.PER_ID, cast(cast(0 as binary) as uniqueidentifier)) 
```

就在更新声明之前。这就是我完全困惑的地方，为什么下一个更新语句只更新一行，为什么只有永久表可以持久更新所有行，但不能持久表和表变量。

更新的问题 -

由于多个更新行在单个批次中发送到表。似乎触发器的 INSERT 和 DELETE 表只有一个，最后一个仅在我到达“update l”语句时才更新行。在此之前，它包含多个更新行。当我使用永久表时，我可以看到这一点。我只是不明白 SQL Server 的行为方式。有人看到同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T03:52:54.680

你严重过度复杂化了这一点。您不需要 和 之间的所有这些检查和`INSERTED`链接`DELETED`。

这只是一个触发器`UPDATE`，因此，对于每个更改的行，总是有一个`DELETED`表包含表中的内容，并且对于每个更改的行，*总是*有一个*包含*`INSERTED`表中的内容。因此，出于您的目的，您只需要处理这些表之一。未更改的行不在两个表中。

 *如果这是一个触发器，`INSERT`那么只会有一个`INSERTED`表。同样，`DELETE`触发器只有一个`DELETED`表。

其次，您似乎认为 NULL=NULL 是真的 - 它不是。语句 NULL=NULL 返回 NULL。NULL<>NULL、NULL>=NULL 等也是如此。在数据库中，NULL 表示*不是值*，没有值的东西是无法比较的。所以你的 where 语句也是多余的。

所以我认为你想要的代码是：

```
ALTER TRIGGER [dbo].[trgtblOrgStaffAssocLastUpdate] ON [dbo].[tblOrgStaffAssoc]
   AFTER UPDATE
AS
   UPDATE l    
   SET PER_ID = 1
      ,UpdatedOn =  GETDATE()
   FROM dbo.tblOrgStaffAssocLastUpadate l
        INNER JOIN
        inserted i ON l.ORG_ID = i.ORG_ID and l.StaffType = i.StaffType 
```*

# php - 匹配 MySQL 查询中的数组值

> ID：14550529
> 
> 赞同：4
> 
> 时间：2013-01-27T18:16:51.230
> 
> 标签：php, mysql

我将用一个水果的例子来说明我的问题：

我有一个包含一些fruit_type id 值的数组。

```
$match= array("1","5","8"). 
```

我在“水果”表中有一个单元格（fruit_type）。这个单元格的值是这样的：“1,3,9”。它包含属于该行的所有fruit_type id。

现在我想让我的 SELECT 查询返回所有有任何行的行，所有 id 的 1,5 或 8 的组合。

此查询不起作用，因为这仅在单元格值为 '1,5,8' 而不是 1 或 5 或 8（或它们的组合或全部）时才起作用：

```
SELECT * FROM fruit WHERE fruit_type IN ('".implode("','",$match)."') 
```

有任何想法吗？

编辑（我认为这个问题还不够清楚。所以我在这个例子中想要的是：一个查询将匹配任何（单元格）值的 1 或 3 或 9 与来自 $match 的任何值（1或 5 或 8）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T18:20:08.110

执行此操作时，您将内爆中的每个单独的数字都用引号括起来：

```
SELECT * FROM fruit WHERE fruit_type IN ('" . implode("','",$match) . "') 
```

结果查询如下所示：

```
SELECT * FROM fruit WHERE fruit_type IN ('1','5','8') 
```

所以应该是：

```
SELECT * FROM fruit WHERE fruit_type IN (" . implode(",",$match) . ") 
```

所以生成的查询如下所示：

```
SELECT * FROM fruit WHERE fruit_type IN (1,5,8) 
```

此外，如果您在 PHP 中执行此操作，那么我建议您在`echo`处理我的 DB 命令之前直接输入输出，以实际查看最终的 MySQL 语句是什么。我很确定如果你这样做了，你会马上看到这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T08:31:07.017

问题不在于查询，而在于数据库结构。您不应该将多个 ID 放在单个列中（至少如果您想查询它）。你可以让它工作，但它总是很慢。

而不是列`fruit_type`，你应该有一个表`fruit_type`。

```
CREATE TABLE fruit_fruittype (fruit_id INT, fruit_type_id INT, PRIMARY KEY (`fruit_id`,`fruit_type_id`)); 
```

为每种水果的每种水果类型添加一行。

现在您可以轻松地查询水果的类型：

```
SELECT fruit.* FROM fruit INNER JOIN fruit_fruittype ON fruit.id = fruit_fruittype.fruit_id WHERE fruit_type_id IN (1, 5, 8) GROUP BY fruit.id; 
```

# java - ASCII字符解密

> ID：14550533
> 
> 赞同：0
> 
> 时间：2013-01-27T18:17:22.243
> 
> 标签：java, string, ascii, mime, url-encoding

我有一大串 ASCII 小数，前面有百分比（例如：`"%40%3e%20%12"`除了大得多）。

如何分析此字符串以从中提取所有实际字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:21:51.510

你可能想要：

```
java.net.URLDecoder.decode(str, "UTF-8") 
```

# javascript - jQuery 为多个选择器设置相同的事件

> ID：14550534
> 
> 赞同：2
> 
> 时间：2013-01-27T18:17:39.013
> 
> 标签：javascript, jquery, html, dom

与[这个](https://stackoverflow.com/questions/2534089/jquery-multiple-events-to-trigger-the-same-function)问题相反，我在这里问是否可以做这样的事情：

```
$(several different selectors).click(function() {
    console.log("Click");
}); 
```

所以，如果我有这样的事情：

```
<div id="a">A</div>
<div id="b">B</div>
<div id="c">C</div> 
```

我想做`several different selectors`select `#a`, `#b`and `#c`, 然后无论我点击哪个都会记录“点击”。我试过`$('#a', "#b", "#c")`了，还是不行；有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T18:19:08.363

传递*一个*字符串，[选择器用逗号分隔](http://api.jquery.com/multiple-selector/)：

```
$('#a, #b, #c').click(function() {
    console.log("Click");
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:40:05.893

你可以试试这个，因为我已经试过了，它对我有用

```
 $(document).ready(function () {
        $('#a, #b, #c').click(function () { 
        console.log("Click"); 
      });
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:21:32.757

你的尝试非常接近。[这是文档 multiple selectors](http://api.jquery.com/multiple-selector/)。

你的选择器应该是`$("#a, #b, #c")`

# list - 使用 Scala 进行运行长度编码

> ID：14550537
> 
> 赞同：3
> 
> 时间：2013-01-27T18:17:45.680
> 
> 标签：list, scala

给定一个元素列表，其中一些元素重复多次，我需要生成一个带有元组的新列表，其中每个元组包含一个元素**在一行**中重复的次数和一个元素本身。

例如，给定

```
println(func(List()))              // should be empty list
println(func(List(1, 1)))          // (2,1) <- 1 is repeated 2 times
println(func(List(1, 1, 2, 1)))    // (2,1)(1,2)(1,1) 
```

这是我目前最好的尝试。我觉得我缺少一些非常基本的东西，请帮助我理解什么

```
 def func[X](xs: List[X]): List[(Int, X)] = xs match {
    case Nil => Nil
    case y :: ys   => ys match {
      case Nil     => (1, y) :: Nil
      case z :: zs => if (y != z) (ys.prefixLength(_ == ys.head), y) :: func(ys) 
                      else func(ys)
    }
  } 
```

在分析了问题所在之后，在我看来，当我递归调用时`func(ys)`，`ys`没有足够的信息来计算元素的数量。假设我们正在处理`List(1,1,1,2)`. 好的，所以， `y`是`1`，`z`是`1`，`(1::(2::Nil))`是`zs`。按照我上面的逻辑，1 被看到 2 次的事实在下一次调用中丢失了。

**问题可能是我没有以正确的方式思考这个问题**。我想到的是“沿着列表走，直到你发现这个元素与以前的元素不同，此时，计算一个元素的出现次数并将其放入元组”）

我认识到在上述场景中（在我的代码中），问题是当数字实际上是相同的 (1,1) 时，我们已经看到一个数字的事实不会在任何地方反映出来。但是，鉴于我还没有准备好组成一个元组，请问在哪里可以做到这一点

在回答这个问题时，请坚持案例结构。我意识到可能还有其他更好、更清洁的方法来解决这个问题，我想更好地理解我在这里做错了什么

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T20:07:09.850

你在正确的轨道上。问题是你不能在这里增量构建结果列表——你必须把头从递归调用中得到的列表中拉出来，并检查你是否需要添加一个新的对或增加最后一个的计数一：

```
def func[X](xs: List[X]): List[(Int, X)] = xs match {
  case Nil => Nil
  case y :: ys => func(ys) match {
    case (c, `y`) :: rest => (c + 1, y) :: rest
    case             rest => (    1, y) :: rest
  }
} 
```

注意嵌套匹配模式中的反引号`y`——这对于避免只定义一个名为 的新变量是必要的`y`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-14T00:08:36.527

这是一个更简单的解决方案，使用`span`：

```
def runLength[T](xs: List[T]): List[(Int, T)] = xs match {
  case Nil => List()
  case x :: l => {
    val (front, back) = l.span(_ == x)
    (front.length + 1, x) :: runLength(back)
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T20:24:19.393

它确实是游程编码。

这是一个简单但通用的尝试......

```
package rrs.scribble

object RLE {
  def rle[T](tSeq: List[T]): List[(Int, T)] = {
    def doRLE(seqT: List[T], rle: List[(Int, T)]): List[(Int, T)] =
      seqT match {
        case t :: moreT if t == rle.head._2 => doRLE(moreT, (rle.head._1 + 1, t) :: rle.tail)
        case t :: moreT => doRLE(moreT, (1, t) :: rle)
        case Nil => rle
      }

    if (tSeq.isEmpty)
      List.empty[(Int, T)]
    else
      doRLE(tSeq, List((0, tSeq.head))).reverse
  }
} 
```

在 REPL 中：

```
scala> import rrs.scribble.RLE._
import rrs.scribble.RLE._

scala> rle(List(1, 1, 2, 1))
res0: List[(Int, Int)] = List((2,1), (1,2), (1,1)) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-27T19:33:00.063

这称为**游程编码**。查看[99 个 Scala 问题](http://aperiodic.net/phil/scala/s-99/)中的第 10 个问题（单击问题编号以获取解决方案）。

# c# - SQL Server CE 插入功能出现问题

> ID：14550539
> 
> 赞同：1
> 
> 时间：2013-01-27T18:18:00.933
> 
> 标签：c#, sql-server-ce

我编写了以下函数，该函数在非 int 输入和 int 输入时正确出错，返回审计已正确启动。不幸的是，当我检查表格时，我发现数据从未真正插入。

对于我做错了什么有什么建议吗？

```
public string SqlLocation = "Data Source="+ new FileInfo(Path.GetDirectoryName(Application.ExecutablePath) + "\\DRAssistant.sdf");

public string StartAudit(string sqlLocation, string dps)
{
  int dpsInteger;
  if (!int.TryParse(dps, out dpsInteger))
    return "DPS is not a number!";

  try
  {
    var myConnection = new SqlCeConnection(sqlLocation);
    myConnection.Open();
    var myCommand = myConnection.CreateCommand();
    myCommand.CommandText = string.Format("SELECT dps FROM DispatchReviews 
        WHERE dps = {0}", dpsInteger);
    SqlCeDataReader reader = myCommand.ExecuteReader();
    if (reader.Read())
      { return "DPS review has already started!"; }

    myCommand.CommandText = "INSERT INTO DispatchReviews (dps, starttime, 
        reviewer) VALUES (@dps, @starttime, @reviewer)";

    myCommand.Parameters.AddWithValue("@dps", dpsInteger);
    myCommand.Parameters.AddWithValue("@starttime", DateTime.Now);
    myCommand.Parameters.AddWithValue("@reviewer", Environment.UserName);
    myCommand.Prepare();
    myCommand.ExecuteNonQuery();

    myCommand.Dispose();
    myConnection.Close();
    return "Dispatch Review Started!";
    }
  catch(Exception ex)
    { return "Unable to save DPS!" + ex.Message; }
  } 
```

编辑：原来这只是一个白痴问题——任何查看 SqlLocation 的人都可能知道——每次我构建应用程序时，都会将 .sdf 的新副本复制到应用程序目录中，覆盖之前的. 此外，我正在检查更新的数据库不是执行目录中的数据库，而是被复制到其中的数据库，这就是它始终为空的原因。我注意到了这一点，因为当我第一次尝试多次添加相同的 DPS 时，我会收到 DPS 审核开始消息，但随后的尝试会给出之前创建的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:06:30.647

你能告诉我们你的连接字符串吗？

**最有可能**的是，如果您在 Visual Studio 中对此进行测试，数据库文件将被复制（从您的初始目录到应用程序运行的输出目录），您`INSERT`可能会正常工作 - 但您只是在查看错误的文件当你检查这个事实时。

# java - 将日期时间转换为 yyyy-MM-dd HH:mm:ss" 格式

> ID：14550544
> 
> 赞同：0
> 
> 时间：2013-01-27T18:18:26.223
> 
> 标签：java, sql, hibernate, jpql

嗨，我是 java 和 JPQL 的新手。在这里，我在 GET 方法的 url 中将 dateTime 作为参数传递。我想要的是我希望用户应该以“yyyy-MM-dd HH:mm:ss”格式传递日期时间。但是现在当我传递日期时间时，它与当前的 dateTime 比较。我希望它应该比较预订按用户通过的日期和时间。这是我的方法和查询。请帮我..

```
@GET
    @Path("/getReservationByUserIdAndTypeAndDateTime/{userid}/{type}/{dateTime}")
    public List<Reservation> getReservationByAndUserIdAndTypeAndDateTime(@PathParam("userid") int uid, @PathParam("type") int tid,@PathParam("dateTime")String dateTime) {
        CriteriaBuilder builder = em.getCriteriaBuilder();

        //Timestamp dateTime = new Timestamp(System.currentTimeMillis());
     dateTime = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(Calendar.getInstance().getTime());

        //System.out.println("dateTime-"+dateTime);

        CriteriaQuery<Reservation> criteria = builder.createQuery(Reservation.class);
        Root<Reservation> r = criteria.from(Reservation.class);
        TypedQuery<Reservation> query = em.createQuery(
            criteria.select(r).where(new Predicate[]{
                    builder.equal(r.get(Reservation_.usersId), uid), 
                    builder.equal(r.get(Reservation_.reservationsType), tid),
                    builder.greaterThanOrEqualTo(
                           builder.concat(r.get(Reservation_.date), r.get(Reservation_.time)), dateTime.toString())}));
        return query.getResultList();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T09:30:59.247

使用这个方法非常简单

`String myDateFormat = "yyyy-MM-dd HH:mm:ss";`

```
public String formatDate(Date date)
{
    SimpleDateFormat customFormat = new SimpleDateFormat(myDateFormat );
    customFormat.setLenient(false);
    return customFormat.format(date);
} 
```

您可以通过以下方式将字符串中的日期转换为日期对象`new Date('your date in String')`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-27T18:26:22.690

尝试

`dateTime = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(Integer.parseInt(dateTime));`

代替

`dateTime = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(Calendar.getInstance().getTime());`

用户传递的日期时间应该是 unix 时间戳。

# javascript - Sencha touch reset store start 参数

> ID：14550550
> 
> 赞同：0
> 
> 时间：2013-01-27T18:18:56.083
> 
> 标签：javascript, sencha-touch, sencha-touch-2

我有一家附属于`List`. 该列表还使用`ListPaging`插件来启用分页。在我调用商店的`load`方法（或事件）后，商店将数据加载到列表中，向以下 url 发送请求 -

```
http://localhost/mysite/nodelist.php?_dc=1359309895493
    &tids=1%2C4%2C2%2C5%2C67&page=1&start=0&limit=10 
```

向下滚动列表并按下`Load More...`（由插件附加到列表中）后，商店将另一个请求发送到相同的 url 但具有不同的参数，从而启用分页 -

```
http://localhost/mysite/nodelist.php?_dc=1359310357419
    &tids=1%2C4%2C2%2C5%2C67&page=2&start=10&limit=10 
```

现在我想重置商店的`start`and参数的值。`page`我尝试使用`setExtraParam`代理上的方法重置它，但如果我这样做，那么控件不会保持分页 - 这意味着当我按下时它不会自动更改`page`and参数。`start``Load More...`

那么我该怎么做呢？

这是我商店的示例代码 -

```
Ext.define('MyApp.store.MyStore', {
    extend: 'Ext.data.Store',
    requires: [
        'Ext.data.reader.Json',
        'Ext.data.proxy.Ajax'
    ],

    config: {
        autoLoad: false,
        model: 'MyApp.model.MyModel',
        serverUrl: null,
        pageSize: 2,
        proxy: {
            type: 'ajax',
            actionMethods: {
                read: 'GET'
            },
            url: null,
            reader: {
                type: 'json'
            }
        },
        listeners: {
            beforeload: function () {
                console.log('Before load');
            },
            load: function (store) {
                // console.log('load');
            }
        }
    }
}); 
```

这是列表视图 -

```
list = {
    xtype: 'list',
    cls: 'myList',
    flex: 12,
    itemTpl: '{title}',
    store: 'MyStore',
    plugins: [
        {
            xclass: 'Ext.plugin.ListPaging',
            autoPaging: false
        }
    ],
    listeners: {
        select: {
            scope: this,
            fn: this.onSelect
        },
        swipe: {
            scope: this,
            element: 'element',
            fn: this.onListSwipe
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T19:39:42.110

从查看源代码来看，也许您正在寻找商店的[currentPage配置？](http://docs.sencha.com/touch/2-1/#!/api/Ext.data.Store-property-currentPage)

当您使用 ListPaging 插件加载更多录音时，它所做的只是`nextPage`在 store 中调用，然后`loadPage`使用`currentPage`config 调用。如果您`currentPage`在商店中将配置重置为 1，它只会假设开始回到 0，并且页面当然是 1。

# c++ - C ++挂钩我自己的程序功能

> ID：14550556
> 
> 赞同：4
> 
> 时间：2013-01-27T18:19:11.537
> 
> 标签：c++, x86, profiling, hook

所以我想分析我的应用程序，我特别想记录从程序开始到进入和退出程序内部调用的每个函数（忽略 DLL 中的函数）的时间，即我想要一个看起来像的简单表这个：

```
THREAD_ID FUNCTION_ADDRESS TIME EVENT_TYPE
5520      0xFF435360       0    ENTERED
5520      0xFF435ED3       25   ENTERED
5520      0xFF433550       40   ENTERED
5520      0xFF433550       50   EXITED
5520      0xFF433550       60   ENTERED
5520      0xFF433550       70   EXITED
5520      0xFF435ED3       82   EXITED
5520      0xFF435360       90   EXITED 
```

对于一个看起来像这样忽略编译器优化的程序：

```
void test1(void)
{
   int a = 0;
   ++a;
}

void test(void)
{
    test1();
    test1();
}

void main(void)
{
    test();
} 
```

我找不到任何现成的解决方案，我能找到的最接近的是微软的 VSPerfReport，但它只是输出在每个函数中花费了多长时间，而不是在输入和退出时。

所以我开始研究用一个简单的函数来挂钩我的所有函数，该函数产生一个缓冲区，我可以从中生成上表。为了做到这一点，我只是想创建一个在 main 开始时调用的函数，它可以通过整个 exe 修改 CALL 指令来调用我的钩子函数。

像 MinHook 等那里的库对我来说似乎有点 OTT 并且可能无法工作，因为它是一个 x64 应用程序，我不想挂钩 DLL 函数。

所以我想只修改每个 CALL 指令中的 JMP 指令，即这个程序：

```
void main(void)
{
...asm prologue 
    test();
002375C9  call        test (235037h) 
}
...asm epilogue 
```

这里的调用转到 JMP 的表：

```
@ILT+40(__set_errno):
0023502D  jmp         _set_errno (243D80h)  
@ILT+45(___crtGetEnvironmentStringsA):
00235032  jmp         __crtGetEnvironmentStringsA (239B10h)  
test:
00235037  jmp         test (237170h)  
@ILT+55(_wcstoul):
0023503C  jmp         wcstoul (27C5D0h)  
@ILT+60(__vsnprintf_s_l): 
```

我想通过这个表并将所有与我的应用程序 .exe 中的函数相关的 JMP 重新路由到包含计时代码的钩子函数，然后返回到调用函数。

那么 ILT 代表什么？

这可能吗？我听说过 IAT 挂钩，但在我看来，只有在挂钩 DLL 时才如此。同样在这里，我忽略了退出，尽管另一个 JMP 代替 RET 指令可能会有所帮助？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T05:34:14.677

您是否研究过[Google 的分析工具](http://google-perftools.googlecode.com/svn/trunk/doc/cpuprofile.html)？您可能会发现修改而不是自己制作更容易。它确实进行代码插入以执行其分析，因此至少，它们的注入框架将对您有益。

但是，对于这样的事情，您主要希望避免时间开销，所以我建议按地址跟踪，然后在分析完成后，将地址转换为符号名称。挂钩本身也可能是一项艰巨的任务，我建议制作一个一体式包装器，它不会改变函数入口或出口，而是重定向调用站点。

> 那么 ILT 代表什么？

导入查找表，如果您还计划分析内部函数，它不会有太大用处。掌握它需要深入了解平台模块格式（PE、ELF、MACH-O）的内部结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T06:26:42.080

gcc 可以选择生成对函数进入和退出的钩子的调用。您使用 编译，编译器生成对和`-finstrument-functions`的调用。您可以在 gcc 文档[http://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html)中阅读更多内容。[http://www.ibm.com/developerworks/library/l-graphvis/](http://www.ibm.com/developerworks/library/l-graphvis/)是一篇很好的文章，其中包含如何使用它的示例。`__cyg_profile_func_enter``__cyg_profile_func_exit`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:43:04.503

```
struct my_time_t;
my_time_t get_current_time(); // may be asm

struct timestamp;
struct timer_buffer {
  std::unique_ptr<timestamp[]> big_buffer;
  size_t buffer_size;
  size_t current_index;
  size_t written;
  buffer( size_t size ): big_buffer( new timestamp[size] ), buffer_size(size), current_index(0), written(0) {}
  void append( timestamp const& t ) {
    big_buffer[current_index] = t;
    ++current_index;
    ++written;
    current_index = current_index % buffer_size;
  }
};
struct timestamp {
  static timer_buffer* buff;
  timestamp const* loc;
  my_time_t time;
  const char* filename;
  size_t linenum;
  timestamp( my_time_t t, const char* f=nullptr, size_t l = 0 ):
    loc(this), time(t), f(filename), l(linenum)
  {
    go();
  }
  void go() {
    buff->append(*this);
  }
};
struct scoped_timestamp:timestamp {
  scoped_timestamp( my_time_t t, const char* f=nullptr, size_t l = 0 ):
    timestamp(t, f, l)
  {}
  ~scoped_timestamp() {
    go();
  }
};
#define TIMESTAMP_SCOPE( NAME ) scoped_timestamp NAME(get_current_time(), __FILE__, __LINE__);
#define TIMESTAMP_SPOT() do{timestamp _(get_current_time(), __FILE__, __LINE__);}while(false) 
```

`timestamp::buff`在某处创建。做`buff`足够大的。写一个快速高效的`get_current_time()`。

`TIMESTAMP_SCOPE(_)`在您认为有问题的函数的开头插入。

`TIMESTAMP_SPOT();`在您认为需要时间的位置之间插入。

`timer_buffer`在关闭之前添加一些后处理- 将其写入磁盘或其他任何内容。注意 if `written`> `current_index`，在这种情况下你包装了缓冲区。请注意，以上代码均不包含任何分支，因此它应该相对性能友好（除了不断将拥有的数组移动`buff`到缓存中）。

存在因此`loc`您可以相对轻松地找到创建/销毁对（因为它的二进制值跟踪堆栈的值！），因此您可以在函数调用花费太长时间之后分析缓冲区。将可视化器放在一起并不是那么难，而且我已经看到了与上述类似的方法，用于检测视频流驱动程序代码中的毫秒级时序故障和打嗝。

开始分析`current_index`并向后工作，寻找对，直到你命中`0`（或者，如果`written`!= `current_index`，直到你环绕到`current_index+1`）。恢复调用图应该不难（如果需要）。

去掉上面的大部分内容，并简单地为每个 使用唯一的标签`timestamp`，可以减少缓冲区的大小，但会使重建调用图变得更加困难。

是的，这不是自动仪表。但是你的代码中运行缓慢的部分将是其中相对较小的一部分。因此，开始使用类似上面的东西进行检测，我猜你会比乱搞反汇编编译器的二进制输出和乱搞跳转表更快地得到答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T00:38:58.183

在 Linux 上，您可以使用它`gprof(1)`来获取该数据。但请接受 Bentley 在他的[“Programming Pearls”](http://www.cs.bell-labs.com/cm/cs/pearls/)中关于性能的说法。第二部分是对他的“编写高效程序”（遗憾的是已绝版）的提炼，非常详细地讨论了如何（更重要的是，何时）优化代码。

# c - 有没有办法让复合文字在 c99 中具有可变长度？

> ID：14550557
> 
> 赞同：5
> 
> 时间：2013-01-27T18:19:12.573
> 
> 标签：c, c99, compound-literals

我知道通过正常声明数组可以在运行时确定长度的数组：

```
char buf[len]; 
```

而且我知道我可以将数组声明为复合字面量并将其分配给中途的指针：

```
char *buf;
....
buf = (char[5]) {0}; 
```

但是，将两者结合起来不起作用（标准不允许）。

我的问题是：有什么办法可以实现下面代码的效果？（注`len`）

```
char *buf;
....
buf = (char[len]) {0}; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T18:21:04.663

该语言明确禁止这样做

> **6.5.2.5 复合文字**
> 
> **约束**
> 
> **1**类型名称应指定对象类型或未知大小的数组，但不能指定可变长度数组类型。

如果你需要这样的东西，你必须使用命名的 VLA 对象而不是复合文字。但是，请注意 VLA 类型不接受初始值设定项，这意味着您不能这样做

```
char buf[len] = { 0 }; // ERROR for non-constant `len` 
```

（我不知道这个限制背后的理由是什么。）

因此，除了使用命名的 VLA 对象之外，您还必须想出一些方法将其归零，例如一个`memset`或显式循环。

# mysql - Mysql：查找多个孩子的父母

> ID：14550559
> 
> 赞同：0
> 
> 时间：2013-01-27T18:19:24.813
> 
> 标签：mysql, select, one-to-many

我有 2 张桌子：玩家和物品。现在我正在寻找具有已知属性的物品的玩家。

```
SELECT players.`name` FROM `players`
INNER JOIN `items` ON players.`id`=items.`ownerId` 
WHERE items.`itemType` = 1 AND items.`itemClass` = 2 AND items.`itemColor` = 3 
```

我怎样才能找到拥有不止一件我想要的物品的播放器？甚至可以在一个查询中进行？

前任。我想找到同时拥有这两个项目的玩家： type=1 class=2 color=3 , type=2 class=3 color=4

我知道如何在多个查询中执行此操作：只需在每个下一个查询中添加 player.id IN (...) 即可。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:52:15.350

最好的方法是聚合。

```
select i.ownerId
from Items i
group by i.ownerId
having max(case when i.itemType = 1 and i.itemClass = 2 and i.itemColor = 3
                then 1 else 0
           end) = 1 and
       max(case when i.itemType = 2 and i.itemClass = 3 and i.itemColor = 4
                then 1 else 0
           end) = 1 
```

如果您想了解有关所有者的其他信息，则需要加入玩家表。

`having`在 MySQL 中，您可以将子句简化为：

```
having max(i.itemType = 1 and i.itemClass = 2 and i.itemColor = 3) = 1 and
       max(i.itemType = 2 and i.itemClass = 3 and i.itemColor = 4) = 1 
```

# css - 桌面浏览器与 iOS 浏览器上的字体粗细渲染不同

> ID：14550560
> 
> 赞同：0
> 
> 时间：2013-01-27T18:19:29.057
> 
> 标签：css, fonts, google-webfonts

我正在使用一个名为 Open Sans 的 Google Webfont，其中为 h1 标签指定了 font-weight:800。当我在 iOS 浏览器（iPhone 或 iPad 上的 Chrome 和 Safari）上查看此页面时，字体呈现比在桌面浏览器中呈现更薄。[您可以在此屏幕截图](https://docs.google.com/file/d/0B-eMfd_QyKaJZnIxeUg1dzEwZ2c/edit)中看到不同之处。

我希望字体粗细在所有设备上呈现相同，有人可以帮助我吗？

**我的代码：**

```
h1 {
    font-weight: 800;
    font-family: 'OpenSans' 
}

<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400,600,800' rel='stylesheet' type='text/css'> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:45:04.750

我相信你在这里错过了一个空间：

```
font-family: 'Open Sans' 
```

# javascript - 保存 Rails 之前的验证

> ID：14550562
> 
> 赞同：1
> 
> 时间：2013-01-27T18:19:34.350
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, forms, validation

我想在保存之前通过确定用户是否填写了特定字段、下面的付款金额字段并在提交表单之前选择了 status =“Closed”来进行验证。如果他只做一个而没有另一个，那么表格不应该保存

编辑页面

```
<%= simple_form_for @invoice, :html => { :class => 'form-horizontal' } do |f| %>
<%= render "shared/error_messages", :target => @invoice %>

<%= f.association :customer, disabled: @invoice.persisted? %>
<%= f.input :due_date, as: :string, input_html: { class: "datepicker" }, disabled:  @invoice.persisted? %>
<%= f.input :invoice_date, as: :string, input_html: { class: "datepicker" }, disabled: @invoice.persisted? %>
<%= f.input :payment_method, as: :select, :collection => [['Cash','Cash'],['Cheque','Cheque'],['In-House transfer','In-House transfer'],['Account Ledger','Account ledger']], :selected => ['Cash','Cash'] %>
<%= f.input :reference_no, :label => 'Payment Reference No', as: :string %>
<%= f.input :amount, as: :string %>
<%= f.input :payment_date, as: :string, input_html: {class: "datepicker"} %>
<%= f.input :status, as: :select, collection: Invoice::VALID_STATUS %> 
```

VALID_STATUS = ['草稿'，'打开'，'关闭'，'无效'] Invoice.rb

我希望如果用户将状态更改为已关闭，他应该在表单中输入一个金额。用户不应该能够在不输入金额的情况下将状态更改为已关闭

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:22:30.963

在模型 ( `app/models/invoice_model.rb`) 中

```
validate :close_must_have_amount 
```

然后定义它（同一个文件）

```
def close_must_have_amount
  :status == 'closed' && :amount # May need to tweak this
end 
```

要在客户端应用模型级别验证，您可以使用
[https://github.com/bcardarella/client_side_validations/](https://github.com/bcardarella/client_side_validations/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:37:03.073

1) Javascript 表单验证通常由名称完成。

```
 function ValidateForm(){
     var form = document.forms['myForm'];
     if ((form['status'].value == "Closed") && !(form['amount'].value)){
         alert("You gave a 'Closed' status value, but did not provide an amount, please rectify this problem!");
         return(false);
     } else {
        return(true);
     }
 } 
```

接着：

```
 <%= simple_form_for @invoice, :onsubmit => "ValidateForm();", :html => { :class => 'form-horizontal', :name => 'myForm' } do |f| %>
         <%= f.input :amount, :html => { :name => 'amount'}, as: :string %>
         <%= f.input :status, as: :select, :html => { :name => 'status'}, collection: Invoice::VALID_STATUS %> 
```

提交表单时触发简短演练`onSubmit`，但在实际发布到服务器之前。

由事件触发并终止的 javasctipt 函数`return(false);`将立即终止事件，而`return(true);`（或几乎其他任何东西）使事件按计划继续。

最后，请注意，完全依赖客户端验证是一个糟糕的主意，因为坚定的用户可能会执行以下操作：

1）打开firebug并检查标头等进行完全合法的提交
。2）制作自己的包含虚假/错误数据的HTTP请求。
3) 通过任何一种 HTTP 工具提交。

客户端验证是“很高兴拥有”。服务器端验证是“必须具备的”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:38:48.460

如果您想在客户端执行此操作：

```
<script>
   $(document).ready(function(){
      $('#status').change(function(){
          if($(this).val() == "Closed" && ($('#amount').val() == null || $('#amount') == "")){
            alert("Amount must be needed when status is closed")
          }
        });
     });
</script> 
```

# ios - 用自定义按钮替换左侧导航按钮，然后返回

> ID：14550563
> 
> 赞同：4
> 
> 时间：2013-01-27T18:19:38.657
> 
> 标签：ios, uinavigationbar, uinavigationitem

我有一个`UITableView`内`UINavigationController`。在`UINavigationBar`我的右侧有一个“编辑”按钮。当我点击此按钮时，表格单元格中的所有文本字段都会被激活，因此我可以对其进行编辑。右侧按钮变为“保存”。

我现在希望将左侧的“后退”按钮`UINavigationController`替换为“取消”按钮，当我点击它时不会让我回到上一个`UIViewController`，而只是取消编辑模式。

当我点击“保存”时，“取消”按钮应该变回通常的`UINavigationController`后退按钮。有什么简单的方法可以做到这一点？我尝试访问`[[self navigationItem] leftBarButtonItem]`. 这适用于右侧按钮，但不适用于左侧按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:55:53.727

设置`leftBarButtonItem`为您的取消按钮。在适当的时候，将 设置`leftBarButtonItem`为`nil`删除您的取消按钮。这将自动恢复添加取消按钮之前的原始返回按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:47:27.937

听起来leftBarButtonItem 是一个“BackButton”，它设置在您用于导航到当前视图的UIView(Controller) 上。

[您可以在此问题](https://stackoverflow.com/questions/1453519/how-to-hide-the-back-button-in-uinavigationcontroller)的答案之后隐藏 BackButton 。应该这样做，因为您无法更改它的行为。

我相信您可以[使用 leftBarButtonItem](https://stackoverflow.com/a/3937432/410699)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T18:42:42.587

请参阅[其他 SO question](https://stackoverflow.com/questions/5739599/disabling-back-button-and-put-cancel-button-in-navigation-view-controller-lik)。

然后确保声明类似于此的取消方法。

```
(void)cancel:(id)sender {
   [self.navigationController popViewControllerAnimated:YES];
} 
```

# c++ - 识别数字是否在特定范围内的 C++ 最佳实践

> ID：14550566
> 
> 赞同：0
> 
> 时间：2013-01-27T18:19:51.297
> 
> 标签：c++

哪种方法更好地识别数字？我正在分析一个 9 位整数数组来测试它们是否都在`0-9`包含之间。

```
for (i = 0; i < 9; i++) {
    if (str[i] < 48 || str[i] > 57) {
        cout >> "failed" >> endl;
    }
    else {
        cout >> "passed" >> endl;
    }
}  

for (i = 0; i < 9; i++) {
    if (str[i] < '0' || str[i] > '9') {
        cout >> "failed" >> endl;
    }
    else {
        cout >> "passed" >> endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:21:22.897

你可以只使用[`isdigit`](http://en.cppreference.com/w/cpp/string/byte/isdigit).

您的第二个选项也有效。第一个[不一定要](https://stackoverflow.com/questions/13141776/is-the-character-set-of-a-char-literal-guaranteed-to-be-ascii)，因为`'0'`不一定要对应`48`。这些值保证是连续的，但它们不必开始`48`（尽管它们可能会这样做）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T18:23:55.317

我会`std::all_of`结合使用以下谓词（如果是简短的 lambda 则更好）`std::isdigit()`：

```
bool ok = std::all_of(begin(str), end(str), [] (char c) { return std::isdigit(c); }); 
```

这允许您测试您希望的任何子范围，并且迭代周期是免费的。

您必须包括`<cctype>`标题 (for `std::isdigit()`) 和`<algorithm>`标题 (for `std::all_of`)。

**编辑：**

如果您不想使用 lambda，您甚至可以`std::digit`直接传入该函数，前提是您提供了正确的强制转换（请参阅[此 Q&A](https://stackoverflow.com/questions/7131858/stdtransform-and-toupper-no-matching-function)以获得解释）：

```
bool ok = std::all_of(begin(str), end(str), (int (*)(int))std::isdigit); 
```

强制转换是必要的，因为在`std`命名空间中，存在重载`isdigit`导致重载解析出现问题。[另一个主题](https://stackoverflow.com/questions/7131858/stdtransform-and-toupper-no-matching-function)稍微详细地讨论了一个类似的案例。

或者，如果这看起来很麻烦，您可以这样做：

```
int (*predicate)(int) = std::isdigit;
bool ok = std::all_of(begin(str), end(str), predicate); 
```

那应该可以正常工作！

# javascript - Vim 中 Javascript 微模板的错误突出显示和缩进

> ID：14550567
> 
> 赞同：2
> 
> 时间：2013-01-27T18:20:00.657
> 
> 标签：javascript, html, vim, syntax-highlighting, indentation

我在 Rails 应用程序的 html 和 html.erb 文件中使用 Javascript[微模板。](http://ejohn.org/blog/javascript-micro-templating/)不幸的是，标签内的所有 html 标签`script`（`type="test/html"`没有正确突出显示，也没有得到正确的缩进（在转到下一行后，我总是在第一个位置结束）。

有没有简单的方法来解决这个问题？我在 .vimrc 中使用的哪些 Vim 插件[（链接到 Gist）](https://gist.github.com/4078697)负责在 html 和 html.erb 文件中突出显示和缩进 html（也许我可以在那里修复它）？

# facebook-graph-api - facebook 网络应用程序是否需要访问令牌来读取喜欢的朋友状态

> ID：14550574
> 
> 赞同：0
> 
> 时间：2013-01-27T18:20:36.680
> 
> 标签：facebook-graph-api, facebook-access-token

我正在尝试阅读关于我朋友状态的喜欢。[如果我从图形 api explorer](https://developers.facebook.com/tools/explorer/214109771989025/?method=GET&path=100001021393791?fields=id,name)复制访问令牌，它工作正常。如果我使用 getAccessToken 方法。它只是返回一个带有状态 id 的数组，它是由我传递的。

任何人都可以帮助我如何将访问令牌传递给应用程序。

您可能会说为什么不继续使用从图形浏览器复制的令牌？但是由于最近的更改，offline_access 令牌已被删除，因此该令牌每小时都会过期。顺便说一句，我正在使用带有 php 的图形 api。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:34:51.500

如果状态不是公开的，则应用程序需要用户访问令牌——否则 API 无法检测当前用户是否被允许查看它。

获取长期访问令牌：[https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

# r - R 轴文字无点

> ID：14550575
> 
> 赞同：-2
> 
> 时间：2013-01-27T18:20:38.993
> 
> 标签：r, text, axis

我想将以下 x 轴标签添加到我的条形图中，但不幸的是 R 无法识别字符“！” 并打印点而不是空格：

```
 I want:                I get:
 !src x.x.x.x           X.src.x.x.x.x
 !TCP                   X.TCP
 !udp && !src x.x.x.x   X.udp.....src.x.x.x.x 
```

此外，a 想增加边距，因为文本很长，并且当将大小设置为 'cex.names=0.6' 时，它就消失了！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:38:06.883

我能想到 R 将`X.`替代`!`.

1.  我怀疑您看到的标签是由于 R 读取了您的数据。这些列名在语法上并不是真正有效的，错误的字符已被替换为`X.`. 这发生在数据导入阶段，所以我假设你没有检查 R 是如何读取你的数据的？，或者
2.  您有一个向量，并且该向量的名称同样无效，并且 R 已完成转换。

但是，由于您还没有使这个可重现，它可能是任何东西。

要处理上述情况 1，请编辑您的数据文件以包含有效名称或传入`check.names = FALSE`您`read.table()`用于读取数据的调用。尽管执行后者会使您很难在不完全引用名称的情况下按名称选择变量。

如果您有向量，则可以再次重置名称：

```
> vec <- 1:5
> names(vec) <- paste0("!",LETTERS[1:5])
> vec
!A !B !C !D !E 
 1  2  3  4  5
> barplot(vec) 
```

另请注意，`barplot()`有一个`names.arg`参数可用于将标签传递给它以在每个条形下方绘制。例如：

```
> barplot(vec, names.arg = paste0("!", letters[1:5])) 
```

这意味着您不需要依赖 R 为您读入/转换的内容，因为您可以准确地告诉它用什么来标记情节。

要增加边距的大小，有几种方法可以指定大小，但我发现根据行数设置它最有用。您可以通过图形参数更改它`mar`，该参数的默认值`c(5,4,4,2) + 0.1`分别对应于*底部*、*左侧*、*顶部*和*右侧*边距。用于`par()`更改默认值，例如在下面的代码中存储默认值`op`并指定更大的底部边距

```
op <- par(mar = c(10,4,4,2) + 0.1)
barplot(vec, names.arg = paste0("!", letters[1:5]), las = 2)
par(op) ## reset 
```

会将条形标签旋转`las = 2`90 度以垂直于轴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:37:33.803

一种选择是使用`ann=F`注释并将注释添加到绘图中`mtext`。

```
 x <- 1:2
 y <- runif(2, 0, 100)
 par(mar=c(4, 4, 2, 4))
 plot(x, y, type="l", xlim=c(0.5, 2.5), ylim=c(-10, 110),
       axes=TRUE, ann=FALSE) 
```

然后添加注释：

```
 mtext("!udp && !src x.x.x.x ", side=1, line=2) 
```

![在此处输入图像描述](../Images/9c37b68c6a2f64a27df2f96d795a79a3.png)

**编辑**这是一个条形图的问题，而不是简单的情节。

正如 Gavin 解决方案中所说，可以设置 names 参数。这里我展示一个例子。

```
 barplot(VADeaths[1:2,], angle = c(45, 135),
         density = 20, col = "grey",
         names=c("!src x.x.x.x", "!TCP", "!udp && !src x.x.x.x", "UF"),
         horiz=FALSE) 
```

![在此处输入图像描述](../Images/67680bd3457bf62b4d4af918bf7634a5.png)

# python - 酸洗包装的部分功能

> ID：14550577
> 
> 赞同：9
> 
> 时间：2013-01-27T18:20:43.870
> 
> 标签：python, decorator, partial, pickle

我正在尝试使用部分函数创建一个可腌制的装饰器。但是，在尝试这样做时，我不断收到酸洗错误。

第一个简单的例子如下：

```
def decorator(func):
  def wrapper(**kwargs):
    return partial(func, **kwargs)
  return wrapper

@decorator
def decorated(x, y=1, z=2):
  return x+y+z

y5 = decorated(y=5)
pickle.dumps(y5) 
```

`partial`取自哪里`functools`。

不那么天真的尝试涉及`@wraps`在上面添加一行`def wrapper`。这没有帮助。

我不确定我是否了解酸洗的真正工作原理。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T18:38:41.470

问题出在你的装饰器上，而不是*partial*。*部分*对象应该腌制得很好：

```
>>> from pickle import *
>>> from functools import *
>>> f = partial(pow, 2)
>>> p = dumps(f)
>>> g = loads(p)
>>> g(5)
32 
```

因此，您的代码的这个问题在装饰器中。它不保留原始函数的名称。试试这个：

```
import pickle
from functools import *

def decorator(func):
    def wrapper(**kwargs):
        return partial(func, **kwargs)
    return wrapper

def decorated(x, y=1, z=2):
    return x+y+z

dd = decorator(decorated)

y5 = dd(y=5)
pickle.dumps(y5) 
```

使用的修改`dd`应该允许泡菜逻辑通过其名称发现底层函数。这就是泡菜的工作原理。

要查看 pickle 中的函数名称，请查看*转储*输出：

```
>>> print pickle.dumps(y5)
cfunctools
partial
p0
(c__main__
decorated
p1
tp2
Rp3
(g1
(t(dp4
S'y'
p5
I5
sNtp6
b. 
```

“decorated”这个词需要是可找到的，等于底层函数，并且不被装饰器隐藏。请记住，当函数被腌制时，只会存储它们的名称。该函数的实际内容不在泡菜中。

有一些解决方法，但它们并不漂亮。您可以使用*__setstate__()*来保存函数名称及其源代码。然后添加一个 *__getstate__()*方法来通过执行它的源来恢复函数。

或者，您可以提取函数对象对象中的字节码并保存它们。还原后，编译代码对象并执行它。

简而言之，您使用带有 @ 符号的装饰器的目标与函数酸洗的工作方式直接不一致。为了实现您的目标，您必须自定义函数酸洗以让它保存函数的功能，而不仅仅是它的名称。

# javascript - 将 JS 注入本地扩展文件（在新选项卡中）

> ID：14550578
> 
> 赞同：1
> 
> 时间：2013-01-27T18:20:48.450
> 
> 标签：javascript, google-chrome-extension

我使用该选项卡生成一个新选项`chrome.tabs.create()`卡，转到 chrome 扩展中的页面。然后我想使用`chrome.tabs.executeScript()`将 JavaScript 文件注入新选项卡 (enter_content.js)。但是，当我这样做时，我会遇到错误

> tabs.executeScript 期间出错：无法访问 url“chrome-extension://adcfbbpepclgchodmdfbijpjhkgcamcg/enter.html”的内容。扩展清单必须请求访问此主机的权限。

我的清单看起来像这样

```
{
    "manifest_version": 2,

    "name": "myExtension",
    "version": "1.0",

    "permissions": [
        "contextMenus",
        "tabs",
        "*://*/*"
    ],

    "background": {
        "scripts": ["background.js"]
    },

    "content_scripts": [
      {
        "matches": ["<all_urls>"],
        "js": ["generic_content.js"],
        "all_frames": true,
        "run_at": "document_start"
      }
    ]
} 
```

我需要添加什么才能将代码注入选项卡？

//更新

为了澄清，我有一个上下文菜单，单击它会打开一个新选项卡并将其指向本地文件`enter.html`。该页面仅由一个输入框和一个按钮组成。单击按钮时，*应*使用 .将输入框中的内容发送回后台脚本`chrome.extension.sendMessage()`。但是您似乎无法将扩展程序中的脚本注入页面（这将允许它进行通信），也不能直接通过内联或单独的 js 文件在`enter.html`代码中的 chrome 命名空间中包含任何内容，因为这违反了默认 CSP，如果可能的话，我想保持原样。

我尝试稍微编辑 CSP，但没有任何效果。我`"content_security_policy": "script-src 'self' chrome-extension://adcfbbpepclgchodmdfbijpjhkgcamcg/; object-src 'self'"` 在最后添加并添加了特定页面。

我实际上没有任何完整编写的页面，因为它们都不起作用，所以我无法测试在消息传递方面什么是有效的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T23:00:37.050

我通过使用`addEventListener()`附加到按钮上来解决这个问题，以免妨碍默认 CSP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T02:55:45.267

# 代码中的问题

*   您不能将脚本注入任何扩展页面
*   `chrome-extension://adcfbbpepclgchodmdfbijpjhkgcamcg/*`是无效模式，文档不会对此进行更新。
*   您是否`chrome.extension.getBackgroundPage()`从与 chrome.* API 相关的部分调用，CSP 错误是导致此问题的原因。

# 建议

*   为什么不添加`enter_content.js`到打开的页面正在使用的脚本列表中，而不是无效注入。

# json - 在 JSON 响应或请求中干燥

> ID：14550588
> 
> 赞同：0
> 
> 时间：2013-01-27T18:21:09.653
> 
> 标签：json

这是我的回应

```
[{
    Name: 'Shahrooz',
    family: 'mohseni'
}, {
    Name: 'Jefri',
    family: 'rezaee'
}, {
    Name: 'mjsoft',
    family: 'ali'
}] 
```

在每个请求中，我们为定义 json 对象转换名称和家庭，这并不重要。在大站点中很重要。有什么方法可以压缩 json 来响应或请求吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:37:01.553

也许这可以帮助你：

*   [JSON 压缩算法](http://web-resource-optimization.blogspot.com/2011/06/json-compression-algorithms.html)
*   [RJSON：将 JSON 压缩为 JSON](http://news.ycombinator.com/item?id=4068383)

在之前的文章中提出了两种解决方案：

*   [打包](https://github.com/WebReflection/JSONH)
*   [瑞森](https://github.com/dogada/RJSON)

**[在这里](http://www.cliws.com/e/06pogA9VwXylo_GknPEeFA/)**作者推荐 rjson on jsonh。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T10:47:41.983

如果您是定义协议的人，并且您不想重复自己，那么……只是不要。

例如，您可以传递数组而不是对象，这意味着您只需传递以下内容：

```
[[
    'Shahrooz',
    'mohseni'
], [
    'Jefri',
    'rezaee'
], [
    'mjsoft',
    'ali'
]] 
```

理想情况下，您会设计服务器端以理解这两个版本，因此您可以使用更具可读性的版本进行测试。

或者，另一种选择：

```
{
    'Names': [
        'Shahrooz',
        'Jefri',
        'mjsoft'
    ],
    'Families': [
        'mohseni',
        'rezaee',
        'ali'
    ]
} 
```

甚至：

```
{
    'Keys': ['Name', 'Family'],
    'Values': [
        [
            'Shahrooz',
            'mohseni'
        ], [
            'Jefri',
            'rezaee'
        ], [
            'mjsoft',
            'ali'
        ]
    ]
} 
```

# php - mysql_query SELECT 没有给出想要的结果

> ID：14550605
> 
> 赞同：0
> 
> 时间：2013-01-27T18:22:21.657
> 
> 标签：php, mysql

以下代码始终显示

```
 rows = 0 
```

即使表格在“to”字段中包含 Ravi。有谁知道这段代码有什么问题？

```
 <?php
    $response = array();
    $con = mysql_connect("localhost","root","");
    if(!$con) {
        die('Could not connect: '.mysql_error());
    }
    mysql_select_db("algopm1",$con);
    //if (isset($_POST['to'])) {
        $to = "Ravi";
        $result = mysql_query("SELECT *FROM `events` WHERE to = '$to'");
        if (!empty($result)) {
            if (mysql_num_rows($result)>0) {
                $result = mysql_fetch_array($result);
                echo $result["to"] + " " + $result["from"];
            } else {
                echo 'rows = 0';
            }
        } else {
            echo 'empty for Ravi';
        }
    //} else {
    //}
    ?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T18:25:26.267

`to`是 MySQL 中的[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，如果要使用它，必须用反引号括起来：

```
.... WHERE `to` = ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:54:03.820

尝试这个：

```
<?php
$response = array();
$con = mysql_connect("localhost","root","");
if(!$con) {
    die('Could not connect: '.mysql_error());
}
mysql_select_db("algopm1",$con);
//if (isset($_POST['to'])) {
    $to = "Ravi";
    $result = mysql_query("SELECT *FROM `events` WHERE `to` = '$to'");
    if (!empty($result)) {
        if (mysql_num_rows($result)>0) {
            $row = mysql_fetch_array($result);
            echo $row["to"] + " " + $row["from"];
        } else {
            echo 'rows = 0';
        }
    } else {
        echo "empty for $to";
    }
//} else {
//}
?> 
```

MYSQLI版本+一些调整：

```
<?PHP
    $host = "localhost";
    $user = "root";
    $password = "";
    $database="algopm1";

    $link = mysqli_connect($host, $user, $password, $database);
    IF (!$link){
        echo ("Unable to connect to database!");
    }
    ELSE {
    $query = "SELECT *FROM `events` WHERE `to` = '$to'";
    $result = mysqli_query($link, $query);
     if (mysql_num_rows($result)>0) {

    while($row = mysqli_fetch_array($result, MYSQLI_BOTH)){
    echo $row["to"]. "+". $row["from"];
    }
     }
     ELSE {
         echo 'rows = 0';
     }
    }
    mysqli_close($link);

?> 
```

我想感谢 @njk 和 @Wezy 对 mysql 中保留字的贡献。如果表事件只能包含一个“to”（在这种情况下为“Ravi”），则不需要 WHILE 循环。我怀疑事件的数量可能大于一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T15:20:12.730

@Wezy 有一点，但让我们进行故障排除：

正如@JonathanRomer 在他的评论中建议的那样，做：

```
$result = mysql_query("SELECT *FROM `events` WHERE `to` = '$to'") or die(mysql_error()); 
```

它说什么？它完全失败了吗？

*或者*，就在`mysql_query`这样做之前：

```
die("SELECT *FROM `events` WHERE `to` = '$to'"); 
```

这将打印正在执行的错误查询。接下来，启动`mysql`控制台或`PHPMyAdmin`尝试手动执行此查询。

再说一遍，它说什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-30T19:10:35.973

实际上，我的主要目的是使用 JSON 对这条消息进行编码并在移动设备上接收它。这是完整的代码。出于正常检查目的，可以单独显示值，而不是使用 json_encode(*)。这是我得到的解决方案，它非常适合在我正在使用的 android 应用程序中接收数据。

```
<?php

$host = "localhost";
$user = "root";
$password = "";
$database="algopm1";
$response = array();

$mysqli = new mysqli($host, $user, $password, $database);

if (mysqli_connect_errno()){
    $response["success"] = 0;
    $response["message"] = mysqli_connect_error();
    echo json_encode($response);
}

if(isset($_POST['to'])) {
    $to = $_POST['to'];
    $query = "SELECT *FROM `events` WHERE `to` = '$to'";

    if($stmt = $mysqli->prepare($query)) {
        $stmt->execute();
        $stmt->store_result();
        $i = 0;
        if($stmt->num_rows > 0) {
            $stmt->bind_result($rowto, $rowfrom, $rowevent);
            $response["events"] = array();
            while($stmt->fetch()) {
                $events = array();
                $events["to"] = $rowto;
                $events["from"] = $rowfrom;
                $events["event"] = $rowevent;
                array_push($response["events"], $events);
            }
            $response["success"] = 1;
            echo json_encode($response);
        } else {
            $response["success"] = 0;
            $response["message"] = "No events found";
            echo json_encode($response);
        }
        $stmt->close();
    }
} else {
    $response["success"] = 0;
    $response["message"] = "Required fields are missing";
    echo json_encode($response);
}

$mysqli->close();
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T18:29:51.853

我没有查看您的代码，但我建议您查看

```
http://php.net/manual/en/intro.mysql.php 
```

这在你继续使用mysql而不是mysqli之前。没有什么不同，但 mysqli 似乎对 mysql 有一个包装器，并使用“->”为连接实例化新类。如果那有意义的话。

# c# - 如何在 Visual Studio 2012 中生成 c# 文档到 chm 或 html 文件？

> ID：14550608
> 
> 赞同：4
> 
> 时间：2013-01-27T18:22:36.183
> 
> 标签：c#, visual-studio-2012, documentation-generation

我已阅读[如何将 C# 文档生成到 CHM 或 HTML 文件？](https://stackoverflow.com/questions/2838788/how-to-generate-c-sharp-documentation-to-a-chm-or-html-file). 但是，我使用 Visual Studio 2012 并且该问题的所有答案都在 Visual Studio 2010 及更低版本中。那么，我如何在 Visual Studio 2012 中生成它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T18:27:22.687

Sandcastle 帮助文件生成器是我最喜欢的..

[http://shfb.codeplex.com/](http://shfb.codeplex.com/)

您只需照常编码，它就会自行生成。

这里有一个入门教程：

[http://www.ewoodruff.us/shfbdocs/Index.aspx?topic=html/b772e00e-1705-4062-adb6-774826ce6700.htm](http://www.ewoodruff.us/shfbdocs/Index.aspx?topic=html/b772e00e-1705-4062-adb6-774826ce6700.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T18:40:42.570

Sandcastle 肯定会完成这项工作，但我更喜欢[doxygen](http://www.doxygen.nl/index.html)，它提供了很好的文档。它还可以为您的代码生成类图。

# javascript - javascript hasOwnProperty

> ID：14550611
> 
> 赞同：0
> 
> 时间：2013-01-27T18:23:06.130
> 
> 标签：javascript, multiple-inheritance, hasownproperty

我试图让我的一些类型拥有一种多重“继承”，如下所示：

```
UIControls.ClickableMesh.prototype = Object.create(THREE.Mesh.prototype);

var UIConProto = Object.create(UIControls.UIControl.prototype);

for(var i in UIConProto){
    if(UIConProto.hasOwnProperty(i)){
        UIControls.ClickableMesh.prototype[i] = UIConProto[i];
    }
} 
```

但是 for 循环没有向`UIControls.UIControl.prototype`我的新类型原型添加任何属性`UIControls.ClickableMesh.prototype`。为什么`hasOwnProperty`返回 false ？它应该有一些直接属于对象的成员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:38:36.420

`hasOwnProperty`仅当属性属于对象本身时才返回 true，而不是从其原型继承。例如：

```
function Foo() {
  this.n = 123;
}
Foo.prototype.s = "hello";

var foo = new Foo();

foo.hasOwnProperty("s"); // False, since s is inherited from the prototype object.
foo.hasOwnProperty("n"); // True, since n is the property of foo itself. 
```

您可能会注意到`Object.create()`创建对象的方式，它属于上面示例的第一类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:33:53.760

> hasOwnProperty ... 与*in*运算符不同，此方法**不检查对象的原型链**。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)

JS 中的对象是哈希映射，hasOwnProperty 的唯一目的是检查哈希映射是否包含该属性。hasOwnProperty 不遍历`__proto__`链。

# php - 减慢 php 文件的速度

> ID：14550612
> 
> 赞同：0
> 
> 时间：2013-01-27T18:23:16.160
> 
> 标签：php, ajax

我正在测试一个 Ajax JQuery 脚本，说请稍候，它会将数据提交到 php 文件。但是，为了测试“请稍候”是否有效，是否有办法让 php 文件回显一些数据但延迟返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:25:34.010

是：（功能[睡眠](http://php.net/manual/en/function.sleep.php)）

```
<?php

$numOfSeconds = 10;
sleep($numOfSeconds);

do_stuff(); 
```

# xml - 是否有一种标准方法可以在 Atom 提要中列出条目标签？

> ID：14550614
> 
> 赞同：0
> 
> 时间：2013-01-27T18:23:22.693
> 
> 标签：xml, atom-feed

假设我在帖子或条目上附加了一系列标签（例如“旅行”、“巴黎”、“奶酪”）。是否有在 Atom 提要中列出这些标签的标准方法？即使没有，是否有大多数提要阅读器使用的事实上的标准？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T08:12:54.287

Atom 为帖子的一般分类定义[了一个“类别”元素](https://www.rfc-editor.org/rfc/rfc4287#section-4.2.2)。[Edward O'Connor](http://edward.oconnor.cx/)的[Representing Tags in Atom](http://edward.oconnor.cx/2007/02/representing-tags-in-atom)很好地总结了可用于标签的方式，并提供了有关好处的建议。

# c# - CRM 4.0 - 从电子邮件地址中提取联系人数据

> ID：14550618
> 
> 赞同：0
> 
> 时间：2013-01-27T18:23:51.407
> 
> 标签：c#, asp.net, crm, dynamics-crm-4

我正在尝试使用电子邮件地址来检索联系人数据。我已经在使用它，但我想知道如何扩展它以便也可以返回自定义字段：

```
 public ContactInfo GetContactByEmail(string email, CrmService service)
    {
        QueryExpression query = new QueryExpression();

        query.EntityName = "contact";
        ColumnSet columns = new ColumnSet();
        columns.Attributes.Add("contactid");

        query.ColumnSet = columns;
        query.Criteria = new FilterExpression();
        query.Criteria.FilterOperator = LogicalOperator.And; 

        ConditionExpression condition = new ConditionExpression();
        condition.AttributeName = "emailaddress1";
        condition.Operator = ConditionOperator.Equal;
        condition.Values = new object[] { email.Trim() };
        query.Criteria.Conditions.Add(condition);

        RetrieveMultipleRequest request = new RetrieveMultipleRequest();
        request.Query = query;

        ContactInfo contactInfo = new ContactInfo();

        RetrieveMultipleResponse response = null;
        response = (RetrieveMultipleResponse)service.Execute(request);
        foreach (contact cont in response.BusinessEntityCollection.BusinessEntities)
        {
            contactInfo.contactid = cont.contactid.Value;

           //Would also like to retrieve a custom attribute called ContactType (type int)
        }

        return contactInfo;
    } 
```

任何帮助或示例将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:52:08.233

您只需要向 中添加其他值`ColumnSet`，例如

```
ColumnSet columns = new ColumnSet();
columns.Attributes.Add("new_contacttype"); 
```

注意：这里的名称应该是架构而不是显示。

例子：

*   [使用动态实体](http://msdn.microsoft.com/en-us/library/cc151183.aspx)。
*   [使用 ColumnSet 类](http://msdn.microsoft.com/en-gb/library/bb928432.aspx)。
*   [CrmService.RetrieveMultiple 方法](http://msdn.microsoft.com/en-us/library/bb929002.aspx)。

# javascript - 使用查询获取 HTML 表格元素

> ID：14550620
> 
> 赞同：0
> 
> 时间：2013-01-27T18:24:06.730
> 
> 标签：javascript, jquery, html, html-table

我想使用 jquery 将列添加到我的 html 表的标题部分。这是表的定义：

```
<table id="grid">
    <thead>
            <tr>
        </tr>
    </thead>

    <tbody>

    </tbody>
</table> 
```

尽管我试图以这种方式获取附加新元素的引用：

```
$("#grid thead").find("tr").append("<th> elem </th>"); 
```

我还没有成功。我应该写什么来引用标题的第一行？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:27:45.343

你的代码没问题

[http://jsbin.com/ufiper/2/edit](http://jsbin.com/ufiper/2/edit)

你确定吗 ？见附上的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:36:53.233

当我将其改编为独立页面时，该脚本显然可以正常工作。我在表格之后添加了内联脚本。因此，也许您在头部使用它并需要一个`$(document).ready()`或`$(window).load()`确保代码仅在页面加载时执行？

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>thead test</title>
    </head>
    <body>
        <table id="grid">
            <thead>
                <tr>
                    <td></td>
                </tr>
            </thead>
        </table>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script>
        $(function () {
            $("#grid thead").find("tr").append("<th> elem </th>");
        });
        </script>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:33:17.413

您提供的代码是正确的。由于它仍然对您不起作用，我最好的猜测是您已将此代码放在您的`<head></head>`. 由于浏览器自上而下读取您的代码，并且任何脚本在读取后立即执行，因此当它到达您的脚本时，DOM 尚未准备好，因此没有任何元素与您的选择器匹配。

有两种方法可以解决这个问题：

1.  将代码移动到正文的末尾，就在您的结束 body-tag 之前`</body>`。然后你知道你选择的元素在 DOM 中。

2.  将代码包装在 DOM-ready 回调中，以确保在执行代码之前 DOM 已准备好。

使用 DOM 就绪回调的示例：

```
$(function () {
    $("#grid thead").find("tr").append("<th> elem </th>");
}); 
```

# java - Java，引用类的对象？

> ID：14550621
> 
> 赞同：0
> 
> 时间：2013-01-27T18:24:11.033
> 
> 标签：java

如果我想获取 StoreInventory 类及其属性并在新类中使用这些属性，我如何将 StoreInventory 包含在我的新类 Snacks 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:28:23.283

你说：

> 如果我想获取 StoreInventory 类及其属性并在新类中使用这些属性，我如何将 StoreInventory 包含在我的新类 Snacks 中？

你的逻辑对我来说并不正确。难道不是反过来——StoreInventory 应该保存 Snack 对象而不是保存 StoreInventory 对象的 Snack 对象吗？

请注意，无论您做什么，无论人们建议什么，继承*都不*是您想要的解决方案。使用组合，您的 StoreInventory 对象可能应该包含一个 Snack 数组或一个集合，例如 Snack 的数组列表 -- `ArrayList<Snack>`。

例如，

```
public class StoreInventory {
   private List<Snack> snackList = new ArrayList<Snack>();
   // ... etc...

  public void addSnack(Snack snack) {
     snackList.add(snack);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:25:57.523

两种标准方式：

*   聚合：您`StoreInventory`的类定义中有一个数据成员并使用它。例如：

    ```
    class Snacks {
        private StoreInventory inventory;

        Snacks() {
            this.inventory = new StoreInventory();
        }
    } 
    ```

*   继承：你派生自`StoreInventory`，例如：

    ```
    class Snacks extends StoreInventory {

        Snacks() {
            super(); // <== Initialize the base class
        }
    } 
    ```

    请注意，`super();`如果没有参数，则调用不必是显式的；如果你忽略它，编译器会为你添加它。但是，如果`StoreInventory`需要构造参数，这就是您提供它们的方式。

现在您有了术语，您应该可以轻松找到这两个概念的教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:26:04.687

您可以使用任一继承

```
class Snacks extends StoreInventory 
```

或作文（在你的情况下很可能是这个）：

```
class Snacks {
    private final StoreInventory storeInventory = new StoreInventory();
} 
```

虽然没有更多信息，很难说哪个会更好，但这基本上是你的两个选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T18:26:05.480

您可以`extend`选择`StoreInventory`该类，也可以将其作为一个字段包含在新类中。

这些技术分别称为继承和组合。

看到这个：[http ://www.artima.com/objectsandjava/webuscript/CompoInherit1.html](http://www.artima.com/objectsandjava/webuscript/CompoInherit1.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-27T18:26:44.743

你可以

*   子类它例如`class MyClass extends StoreInventory`
*   或者更好的选择是使用委托，例如

    ```
    private final StoreInventory inventory = .... 
    ```

# c - 64 位 GCC 混合 32 位和 64 位指针

> ID：14550626
> 
> 赞同：5
> 
> 时间：2013-01-27T18:24:43.307
> 
> 标签：c, gcc, x86-64, gnu-assembler

尽管代码有效，但编译器决定混合相同类型的 32 位和 64 位参数，这让我感到困惑。具体来说，我有一个接收三个字符指针的函数。查看汇编代码，三个中的两个作为 64 位指针传递（如预期的那样），而第三个是局部常量，但仍然是字符串，作为 32 位指针传递。我看不出我的函数如何知道第三个参数何时不是完全加载的 64 位指针。显然，只要较高的一侧为 0，这并不重要，但我认为它不会努力确保这一点。在这个例子中，任何东西都可能在 RDX 的高端。我错过了什么？顺便说一句，接收函数假定它是一个完整的 64 位指针，并在入口处包含以下代码：

```
 movq    %rdx, -24(%rbp) 
```

这是有问题的代码：

```
.LC4
    .string "My Silly String"

    .text
    .globl funky_funk
    .type  funky_funk, @function
    funky_funk:
        pushq     %rbp
            movq      %rsp, %rbp
            pushq     %rbx
            subq      $16, %rsp
            movq      %rdi, -16(%rbp)          ;char *dst 64-bit
            movl      %esi, -20(%rbp)          ;int len, 32 bits OK

            movl      $.LC4, %edx              ;<<<<---- why is it not RDX?

            movl      -20(%rbp), %ecx          ;int len 32-bits OK
            movq      -16(%rbp), %rbx          ;char *dst 64-bit
            movq      -16(%rbp), %rax          ;char *dst 64-bit
            movq      %rbx, %rsi               ;char *dst 64-bit
            movq      %rax, %rdi               ;char *dst 64-bit
            call      edc_function

    void funky_funk(char *dst, int len)
    {                                             //how will function know when 
         edc_function(dst, dst, STRING_LC4, len); //a str passed in 3rd parm
    }                                             //is 32-bit ptr vs 64-bit ptr?

    void edc_function(char *dst, char *src, char *key, int len)
    {
         //so, is key a 32-bit ptr? or is key a 64-bit ptr?
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T18:44:12.613

在寄存器中加载 32 位值时，该值是零扩展的。您可能在编译器知道代码位于低 32 位可寻址内存中的模式下工作。

GCC 有几个用于 x64 的内存模型，其中两个具有该属性。来自 GCC 文档：

```
`-mcmodel=small'
     Generate code for the small code model: the program and its
     symbols must be linked in the lower 2 GB of the address space.
     Pointers are 64 bits.  Programs can be statically or dynamically
     linked.  This is the default code model.
`-mcmodel=medium'
     Generate code for the medium model: The program is linked in the
     lower 2 GB of the address space.  Small symbols are also placed
     there.  Symbols with sizes larger than `-mlarge-data-threshold'
     are put into large data or bss sections and can be located above
     2GB.  Programs can be statically or dynamically linked. 
```

（其他的是内核，类似于small但在上/负2GB地址空间中，large没有限制）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T18:51:49.623

将此添加为答案，因为它包含原始问题的“部分难题”：

只要编译器可以确定 [例如通过指定满足此条件的内存模型] .LC4 在前 4GB 内，它就可以执行此操作。%edx 会加载 LC4 的 32 位地址，高位设置为零，所以调用 edc_function() 时，可以使用 %rdx 的全部 64 位，只要地址在较低的4GB，它会工作得很好。

# c# - C# 深入浅出：类型约束

> ID：14550630
> 
> 赞同：2
> 
> 时间：2013-01-27T18:24:50.317
> 
> 标签：c#

我正在深入阅读 C# 并遇到了这个我可以理解的内容：

当它被限制为引用类型时，执行的比较类型取决于类型参数被限制为什么。

但无法理解这一点：

如果进一步限制从重载 == 和 != 运算符的特定类型派生，则使用这些重载。

如果有人通过示例来解释这一点，我将不胜感激...... Plzz

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:27:31.800

`==``!=`是等式和不等式运算符。

这些可以被不同的类型覆盖 - 在已经覆盖它们的类型中，如果用作泛型类型约束，则此实现将用于使用这些运算符进行比较。

在您的示例中，该行不适用，因为您对覆盖的类型没有额外的约束`==`：

```
static bool AreReferencesEqual<T> (T first, T second) where T : class
{ 
  return first==second; 
} 
```

如果您有这样的类型（也可以继承），那么：

如果`T`被约束的类型没有重载`==`，则会进行简单的引用相等测试（默认`Object`实现）。

但是，如果该类型确实重载`==`（例如，一个业务实体，如果两个实例具有相同的实例，则`id`它们被认为是相同的），无论您传入该类型还是继承类型，都将使用该实现。

考虑一个`Person`覆盖`==`. 以及将类型参数约束为`Person`. 如果您有一个`Employee`派生自`Person`并覆盖的`==`，`==`则在泛型方法中使用时，`==`使用的将是那个`Person`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:43:43.710

当它被限制为没有`operator==`and `operator!=`（第一个引号）的引用类型时，编译器知道它不知道除了 use 之外的类型的相等性——它`Object.Equals`只是进行引用比较。

如果约束是一个*确实*有`operator==`and的类型，`operator!=`编译器就知道有其他东西`Object.Equals`可以用于相等性，因此使用该类型`operator==`来测试相等性（这通常不是参考比较）。

# perl - 使用 bash shell 自动拆分由关键字分隔的千兆字节行的最快方法是什么？

> ID：14550635
> 
> 赞同：4
> 
> 时间：2013-01-27T18:25:14.980
> 
> 标签：perl, bash, shell, sed, awk

例如，给定一行`a11b12c22d322 e...`break 字段是数字或空格，我们希望将其转换为

```
a
b
c
d
e
... 
```

`sed`需要将整行读入内存，对于千兆字节的一行，效率不高，如果我们没有足够的内存就无法完成这项工作。

编辑：

谁能解释一下 grep、tr、Awk、perl 和 python 在读取大文件时如何操作内存？他们一次将什么内容和多少内容读入内存？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:01:44.707

如果您使用（我相信这是 Linux 上`gawk`的默认设置），您可以使用该参数指定将多位数字或空格识别为行终止符而不是换行符。`awk``RS`

```
awk '{print}' RS="[[:digit:]]+| +" file.txt 
```

至于你的第二个问题，所有这些程序都需要读取一些固定数量的字节并在内部缓冲区中搜索行分隔符的想法，以模拟一次读取一行的外观。为防止它在搜索行尾时读取太多数据，您需要更改程序关于什么终止行的想法。

大多数语言允许您这样做，但只允许您指定单个字符。`gawk`通过允许您指定正则表达式来识别行尾字符，这很容易。这使您不必自己实现固定大小的缓冲区和行尾搜索。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T20:16:24.743

最快...您可以在 gcc 的帮助下完成，这是一个版本，如果给定，则从给定文件名读取数据，否则从标准输入读取数据。如果这仍然太慢，您可以查看是否可以通过用您自己的缓冲代码替换`getchar()`和`putchar()`（可能是宏并且应该优化得很好）来使其更快。如果我们想变得更可笑，为了更快，你应该有三个线程，所以内核可以用一个内核复制下一个数据块，而另一个内核处理，第三个内核将处理后的输出复制回内核。

```
#!/bin/bash

set -e

BINNAME=$(mktemp)

gcc -xc -O3 -o $BINNAME - <<"EOF"
#include <stdio.h>
#include <stdlib.h>
int main(void)
{
    int sep = 0;

    /* speed is a requirement, so let's reduce io overhead */
    const int bufsize = 1024*1024;
    setvbuf(stdin, malloc(bufsize), _IOFBF, bufsize);
    setvbuf(stdout, malloc(bufsize), _IOFBF, bufsize);
    /* above buffers intentionally not freed, it doesn't really matter here */

    int ch;
    while((ch = getc(stdin)) >= 0) {
        if (isdigit(ch) || isspace(ch)) {
            if (!sep) {
                if (putc('\n', stdout) == EOF) break;
                sep = 1;
            }
        } else {
            sep = 0;
            if (putc(ch, stdout) == EOF) break;
        }
    }

    /* flush should happen by on-exit handler, as buffer is not freed,
       but this will detect write errors, for program exit code */
    fflush(stdout); 

    return ferror(stdin) || ferror(stdout);
}
EOF

if [ -z "$1" ] ; then
  $BINNAME <&0
else
  $BINNAME <"$1"
fi 
```

* * *

编辑：我碰巧也查看了 GNU/Linux stdio.h，一些注释：`putchar`/`getchar`不是宏，但是`putc`/`getc`是，所以使用它们可能是一个轻微的优化，可能避免一个函数调用，更改代码以反映这一点。还添加了检查返回码`putc`，而在它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-27T18:31:59.580

与`grep`：

```
$ grep -o '[^0-9 ]' <<< "a11b12c22d322 e"
a
b
c
d
e 
```

与`sed`：

```
$ sed 's/[0-9 ]\+/\n/g' <<< "a11b12c22d322 e"
a
b
c
d
e 
```

与`awk`：

```
$ awk 'gsub(/[0-9 ]+/,"\n")' <<< "a11b12c22d322 e"
a
b
c
d
e 
```

我会让你进行基准测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-27T18:29:57.973

尝试`tr`：

```
tr -s '[:digit:][:space:]' '\n' <<< "a11b12c22d322e" 
```

这会产生：

```
a 
b 
c 
d 
e 
```

# python - 在 200k 行 MySQL 数据库上计算成对比较的最快方法

> ID：14550639
> 
> 赞同：1
> 
> 时间：2013-01-27T18:25:44.187
> 
> 标签：python

我有 200k 列表存储在 MySQL 数据库中。给定一个列表 A，我需要计算 A 和 200k 个列表中的每个列表 X 之间的相似度分数。假设相似性度量很简单，例如 A 和 X 的集合交集的长度。

鉴于成对比较的性质，我想不出为此改进 O(N) 的方法，因此改进运行时意味着使用多个 CPU 内核。现在，我使用 multithreading.Pool() 将这个任务拆分为 4 个核心，但仍然需要将近 10 分钟才能完成。更糟糕的是，我的电脑会关闭以保护自己。

对于以前处理过此问题的任何人，您是否有可以分享的替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:55:08.633

```
def bestmatch(A, lists):
     a = set(A)
     return min(lists, key=lambda x:  len(set(x) & a) 
```

使用*min*循环 C 速度。*lambda*是一个快速引用*a*的闭包。该`set(A)`步骤仅计算一次，而不是在内循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:56:35.430

假设您的列表表看起来像这样

```
LISTID LISTITEM
1      1
1      2
1      3
2      2
2      4
2      5 
```

列表A是例如。`[1,2]`，你可以像这样在 SQL 中做到这一点：

```
SELECT LISTID, COUNT(*)
FROM T
WHERE LISTITEM IN (1,2)
GROUP BY LISTID 
```

# php - 将对象传递给 PHP 中的其他类时如何访问对象的函数？

> ID：14550642
> 
> 赞同：0
> 
> 时间：2013-01-27T18:25:58.317
> 
> 标签：php

我是 PHP 开发新手，但我有 Java 开发经验。在java中，我们可以将classA的对象传递给classB。然后在classB中我们可以访问classA的方法。我在 PHP 中寻找类似的东西。

在我的测试项目中，我有一个 Vote 类。

```
 <?php

class Vote {    
    private $DeviceID;
    private $FullName;
    private $Rate;
    private $Comment;
    private $PublishTime;

    public function __construct($deviceId, $fName, $rate, $comment) {
        $this->DeviceID = $deviceId;
        $this->FullName = $fName;
        $this->Rate = $rate;
        $this->Comment = $comment;

        if(function_exists('date_default_timezone_set'))
            date_default_timezone_set('Asia/Tehran');
        $date = new DateTime();
        $this->PublishTime = $date->getTimestamp();
    }

    public function getDeviceID() {
        return $this->DeviceID;
    }

    public function getName() {
        return $this->FullName;
    }

    public function getRate() {
        return $this->Rate;
    }

    public function getComment() {
        return $this->Comment;
    }

    public function getPublishTime() {
        return $this->PublishTime;
    }

    public function setDeviceID($deviceId) {
        $this->DeviceID = $deviceId;
    }

    public function setFullName($name) {
        $this->FullName = $name;
    }

    public function setRate($rate) {
        $this->Rate = $rate;
    }

    public function setComment($comment) {
        $this->Comment = $comment;
    }

    public function setPublishTime($publishTime) {
        $this->PublishTime = $publishTime;
    }

    public function toString() {
        echo '<p><b>Device ID:</b>'.$this->getDeviceID().'<br />';
        echo '<b>User Name:</b>'.$this->getName().'<br />';
        echo '<b>Rate:</b>'.$this->getRate().'<br />';
        echo '<b>Comment:</b>'.$this->getComment().'<br />';
        echo '<b>Time:</b>'.$this->getPublishTime().'<br /></p>';
    }
}
?> 
```

我有另一个用于读取和写入数据库的课程。

```
<?php
    require_once 'class.vote.php';

class DBHandler {
    private $DB_HOST = "localhost";
    private $DB_USER = "root";
    private $DB_PASS = "";
    private $DB_NAME = "test";
    private $mysqli;

    public function __construct() {
        // CONNECT TO THE DATABASE
        $this->mysqli = new mysqli($this->DB_HOST, $this->DB_USER, $this->DB_PASS, $this->DB_NAME);
        if (mysqli_connect_errno()) {
            throw new Exception("Unable to connect to the database. Error number: " . $this->mysqli->connect_errno);
    }
    }

    public function __destruct() {
        //We are done with the database. Close the connection handle.
        $this->mysqli->close();

        echo 'DBHandler closed';
    }

    public function writeToDB(Vote $vote) {
        $query = "INSERT INTO vote (DeviceID, FullName, Rate, Comment, PublishTime)
            VALUES ('$vote->getDeviceID()', '$vote->getName()', '$vote->getRate()',
                '$vote->getComment()', '$vote->getPublishTime()')";
        $result = $this->mysqli->query($query);
        echo '$result';
        /* free result set */
        $result->free();
    }
}
?> 
```

我的问题是`writeToDB(Vote $vote)`功能。当我运行项目时，将显示以下错误。任何建议将不胜感激。谢谢

```
Notice: Undefined property: Vote::$getDeviceID in F:\Software\NetBeans\xampp\htdocs\PHPAndroidAPI\class.dbhandler.php on line 32

Notice: Undefined property: Vote::$getName in F:\Software\NetBeans\xampp\htdocs\PHPAndroidAPI\class.dbhandler.php on line 32

Notice: Undefined property: Vote::$getRate in F:\Software\NetBeans\xampp\htdocs\PHPAndroidAPI\class.dbhandler.php on line 32

Notice: Undefined property: Vote::$getComment in F:\Software\NetBeans\xampp\htdocs\PHPAndroidAPI\class.dbhandler.php on line 33

Notice: Undefined property: Vote::$getPublishTime in F:\Software\NetBeans\xampp\htdocs\PHPAndroidAPI\class.dbhandler.php on line 33 
```

=============

# **更新**

我正在使用以下代码来测试我的代码：

```
<?php
    require_once 'class.vote.php';
    require_once 'class.dbhandler.php';

    $deviceId = $_GET["p1"];
    $fName = $_GET["p2"];
    $rate = $_GET["p3"];
    $comment = $_GET["p4"];

    try {
        // Create Vote object based on parameters
        $objVote = new Vote($deviceId, $fName, $rate, $comment);
//        $objVote->toString();

        $objDBHandler = new DBHandler();
        $objDBHandler->writeToDB($objVote);

    } catch (Exception $e) {
        die("There was a problem: " . $e->getMessage());
    }

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:38:06.230

据我所知，函数不能在“双引号”内工作，只能在变量内工作。因此，PHP 正在寻找一个`$vote->getDeviceID`变量而不是一个`$vote->getDeviceID()`函数。您应该将 SQL 更改为，`... VALUES ('".$vote->getDeviceID()."', ...`以便函数在引号之外。

此外，当数据来自用户输入时，您应该特别关注[SQL 注入。](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:45:21.520

您可以使用如下 {} 语法

```
$query = "INSERT INTO vote (DeviceID, FullName, Rate, Comment, PublishTime)
        VALUES ('{$vote->getDeviceID()}', '{$vote->getName()}', '{$vote->getRate()}',
            '{$vote->getComment()}', '{$vote->getPublishTime()}')"; 
```

# eclipse - antlr ide 产生错误的解析器/词法分析器

> ID：14550643
> 
> 赞同：0
> 
> 时间：2013-01-27T18:26:00.197
> 
> 标签：eclipse, antlr3, antlrv3ide

我正在使用 antlr IDE 和 antlr 3.4 进行 Eclipse，并创建了以下组合语法以用于命题逻辑

```
grammar Propositional;

options {
  language = Java;
}

@header {
  package antlr;
}

@lexer::header {
  package antlr;
}

formula:expression;

term 
    : ATOM
    | '(' expression ')'
    ;

negation
    : ('~')* term
    ;

and
    : negation (('^') negation)*
    ;

or
    : and (('|') and)*
    ;

implies
    : or (('>') or)*
    ;

expression
    : implies (('#') implies)*
    ;    

ATOM : 'a'..'z'+;
WS : (' ' | '\t')+ {$channel = HIDDEN;}; 
```

当我保存它时说构建成功并且解释器完全按照我想要的方式工作，但是生成的词法分析器和解析器存在许多问题，例如缺少 throw 语句或不正确的构造函数。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T19:32:11.823

已解决：有点傻，但它不喜欢被称为 antlr 的包

# c++ - 代码块无法创建输出目录

> ID：14550645
> 
> 赞同：1
> 
> 时间：2013-01-27T18:26:04.430
> 
> 标签：c++, debugging, codeblocks

我在 Widnows XP 中使用 Code::Blocks 12.11。我一直在学习 C++，所以我没有从事任何特定的项目，只是个别文件。我正在尝试调试其中一个文件，但从[这个问题](https://stackoverflow.com/questions/5107325/debugging-in-codeblocks)中发现我需要在项目中才能进行调试。所以，我为我所有的 C++ 练习文件创建了一个项目。现在，当我尝试调试（或运行）程序时，Code::Blocks 给了我这个错误：“无法创建输出目录 bin\Debug。

当我从项目中删除文件时，它仍然给我这个错误。我能做些什么来尝试解决这个问题，以便程序可以运行和调试？

* * *

附加信息：

在设置>编译器>全局编译器设置>编译器设置>编译器标志中，我启用了“生成调试符号[-g]”。这是我检查过的许多其他资源都提到的。

此外，在 Debug>Active Debuggers 下，我尝试使用两个调试器，它们都产生相同的错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T12:48:56.023

不如试试把整个工程目录去掉，新建一个空工程，然后把源文件一一放入工程中。请注意，如果`main()`每个源文件中都有方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-03T19:16:42.887

好吧，我的一个朋友遇到了同样的错误。所以我决定检查一下。

我的情况是，错误是因为帐户用户名。

当我检查时，创建文件时的输出目录和显示的错误目录不同。

当我检查时，我用“$aaa$”创建了一个用户帐户名，我得到了同样的错误。

我注意到错误是因为“$”符号。（大概）。

所以，我想问题出在用户名上。尝试将用户名更改为简单的名称。

# c++ - 如何在头文件中组织代码实体？

> ID：14550651
> 
> 赞同：0
> 
> 时间：2013-01-27T18:26:40.423
> 
> 标签：c++, header

> **可能重复：**
> [使用 C++ 头文件的最佳实践](https://stackoverflow.com/questions/410516/best-practices-for-use-of-c-header-files)
> [C++ - .h 文件应该包含哪些内容？](https://stackoverflow.com/questions/1945846/c-what-should-go-into-an-h-file)

我知道这可能是一个微不足道的问题，但我真的很困惑。

*   您应该如何在头文件中组织代码实体？

例如，将每个类声明放在头文件中。全球实体怎么样？我需要将每个声明放在不同的文件中吗？或者把一些相关的放在一个文件中？还是其他一些原则来确定呢？

示例 1

```
// A common header file of "common.h"
#include <vector>
#include <memory>
#include <algorithm>
#include <string>
#include <cmath> 
```

或者只是在需要时包括它们。

示例 2

```
// A header file "report.h" to include functions to report some information
class string;
void Log(std::string& info); // show in a log window
void Message(std::string& info); // show in a message box
void Status(std::string& info); // show in a status bar 
```

或将它们拆分为 3 个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:49:10.090

首先要记住的是头文件是供其他文件使用的；它应该只包含某些服务的消费者使用该服务所需的信息。单个源文件中的程序不需要标头（对于它定义的函数；它会用于它使用的“系统”函数）。标头用于确保服务提供者和服务消费者之间的一致性。

> [你] 把每个类声明放在一个头文件中吗？

不，很多课程，但肯定不是每个课程。

如果一个类只被源文件中的代码使用，那么文件之外的任何东西都不需要知道这个类。类应该在源文件中指定，而不是在头文件中。

即使在接口中使用了一个类，也要仔细考虑是否需要详细的声明，或者提供该类的前向声明是否足够。

> 全球实体怎么样？

除了函数之外，您不应该有很多“全局实体”。尽可能避免使用全局变量。如果其他文件需要全局实体，则应在适当的标题中声明它，通常但不总是定义它所属的类的标题。如果仅在单个文件中需要“全局实体”，则应在适当的名称空间（通常是匿名名称空间）中定义它。

> 我需要将每个声明放在不同的文件中吗？

不，您将它们组合在一起。考虑标准 C++ 库。许多标头定义了多个声明。但是每个标头都定义了一组相关的声明。您想在将所有内容分成不同的标题和拥有如此多的标题之间取得平衡，您找不到任何东西。

第一条经验法则是“每个定义服务的源文件一个标头”。但是，必须明智地使用它。

如果需要多个源文件来实现完整的服务集，那么单个标头可以为完整的服务集提供外部定义（并且可能会有第二个私有标头仅由实现服务的源文件使用，定义他们需要在彼此之间共享的细节，而不与消费者共享）。

在另一个极端，有时一个源文件会实现几组服务。如果这些服务没有密切相关，那就是不寻常的——糟糕的工程。如果它们是相关的，那么单个标题就足够了。我想一个源文件可以有两个公共头文件，但这种情况非常不寻常。

# ios - Monotouch.Dialog：由 SectionHeader 隐藏的 ScopeBar

> ID：14550653
> 
> 赞同：1
> 
> 时间：2013-01-27T18:26:55.983
> 
> 标签：ios, uitableview, xamarin.ios, uisearchbar, monotouch.dialog

使用 MonoTouch.Dialog 我添加了一个简单的表格并添加了一个 ScopeBar：

```
 this.Style = UITableViewStyle.Plain;
     this.EnableSearch = true;
     this.AutoHideSearch = false;
     this.SearchPlaceholder = "Search".t();
     UISearchBar sb = TableView.TableHeaderView as UISearchBar;
     if (sb != null)
     {
        sb.ScopeButtonTitles = new string[] { "Girl".t(),"Boy".t(),"All".t() };
        sb.ShowsScopeBar = true;
        sb.SizeToFit();
     } 
```

看起来不错：

![在此处输入图像描述](../Images/dcb3c3c04696b91840c21177685aecda.png)

当我设置部分并给它一个标题时，该部分出现在范围栏的顶部：

```
Section secMain = new Section("Top 100".t()); 
```

![在此处输入图像描述](../Images/83aaace5c8aacd1cc2dafddbc5e715c5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:46:39.123

为此，您需要更改 MonoTouch.Dialog.DialogViewController 并使`void SetupSearch()`受保护的虚拟。

然后，在您的控制器中使用以下代码覆盖 SetupSearch 方法。这种方法的缺点是您必须使用自定义搜索委托。但是，从您对其他一些问题的回答来看，您似乎已经在这样做了。

```
 protected override void SetupSearch()
    {
        SearchBar = new UISearchBar(new RectangleF (0, 0, TableView.Bounds.Width, 90))
        {
            Delegate = new MySearchBarDelegate(this),
            Placeholder = "Search".t(),
            ShowsScopeBar = true,
            ScopeButtonTitles = new [] { "Girl".t(),"Boy".t(),"All".t() },
            SelectedScopeButtonIndex = 0,
        };

        TableView.TableHeaderView = SearchBar;                  
    }

    public class MySearchBarDelegate : UISearchBarDelegate
    {
        MyViewController _container;

        public SearchDelegate (MyViewController container)
        {
            _container = container;
        }

        public override void SelectedScopeButtonIndexChanged (UISearchBar searchBar, int index)
        {
            _container.SearchScopeChanged(searchBar, index);
        }

        public override void OnEditingStarted (UISearchBar searchBar)
        {
            searchBar.ShowsCancelButton = true;
            _container.StartSearch ();
        }

        public override void OnEditingStopped (UISearchBar searchBar)
        {
            searchBar.ShowsCancelButton = false;
            _container.FinishSearch ();
        }

        public override void TextChanged (UISearchBar searchBar, string searchText)
        {
            _container.PerformFilter (searchText ?? "");
        }

        public override void CancelButtonClicked (UISearchBar searchBar)
        {
            searchBar.ShowsCancelButton = false;
            _container.SearchBar.Text = "";
            _container.FinishSearch ();
            searchBar.ResignFirstResponder ();
        }

        public override void SearchButtonClicked (UISearchBar searchBar)
        {
            _container.SearchButtonClicked (searchBar.Text);
        }
    } 
```

# android - 我的可扩展列表视图包含一个 listView

> ID：14550655
> 
> 赞同：-2
> 
> 时间：2013-01-27T18:26:58.517
> 
> 标签：android, focus, expandablelistview, onitemclicklistener

我的可扩展列表视图包含一个带有 listView 的 childLayout。但是我的这个listView的项目点击监听器没有工作....

我如何为 listView 获取此 onItemClickListener。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:42:18.280

这完全正常 - ItemClick 事件由顶级 ExpandableListView 处理，并且此事件不会传递给子 ListView。`return false`如果您在`onItemClick`处理项的方法中单击 ExpandableListView，则可以将 ItemClick 事件传递给 ListView 。我认为最好的方法是改变你的布局结构 - 将 ListView 放入 ExpandableListView 并处理这样的事件会给你带来太多的头痛。

# php - 覆盖 yii 中的重复验证规则

> ID：14550661
> 
> 赞同：0
> 
> 时间：2013-01-27T18:27:20.853
> 
> 标签：php, yii

plz我有一些我不想在其代码中更改的规则函数（来自数据库的BaseModel）并且我在模型中创建了其他规则函数，我想更改它

基础的“不要改变”

```
public function rules() {
        return array(
            array('start_date, end_date, info, type_id', 'required'),

            array('start_date, end_date, type_id', 'length', 'max'=>10),

    } 
```

我想更改从基本模型继承的模型中的其他功能，这是它的代码

```
public function rules()
    {
        $rules = array(
                    array('start_date, end_date, type_id', 'length', 'max'=>16),
        );
        return array_merge($rules,parent::rules());

    } 
```

它使用最大值作为 10 的问题，而不是 16 我想要它 16 即使我将最后一行更改为

```
 return array_merge(parent::rules(),$rules); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:27:01.630

它可能不起作用的原因是无论顺序如何，规则`'max'=>10`仍然存在。`rules()`替换规则对我有用。

```
public function rules(){
    $rules=parent::rules();
    $rules[1]=array('start_date, end_date, type_id', 'length', 'max'=>16);
    return $rules;
} 
```

**编辑**

要使用“键”替换规则`'start_date, end_date, type_id'`，您需要递归[数组搜索](http://php.net/manual/en/function.array-search.php)：

```
public function rules(){
    $rules=parent::rules();
    $index=0;//index of the rule
    outer: foreach($rules as $rule){
        if(array_search('start_date, end_date, type_id',$rule)!==false)
             break outer;
        $index++;
    }
    $rules[$index]=array('start_date, end_date, type_id', 'length', 'max'=>16);
    return $rules;
} 
```

这将检查现有规则，如果不存在，则将该规则添加为`$rules`. 如果有人编辑基类中的第一个元素，例如向规则添加新属性/字段，这将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-22T16:30:22.087

刚刚完成了同样的任务，创建了一个合并辅助函数：

```
public function mergeRules($parent, $rules)
{
    // creating curent rules map
    $rulesMap = [];
    foreach ($rules as $rule) {
        $validator = $rule[1];
        $attributes = array_map('trim', explode(',', $rule[0]));
        if (!isset($rulesMap[$validator])) {
            $rulesMap[$validator] = [];
        }
        $rulesMap[$validator] = CMap::mergeArray($rulesMap[$validator], $attributes);
    }

    // checking for attributes in parent rules against created rule map
    if (!empty($rulesMap)) {
        foreach ($parent as $i => $rule) {
            $validator = $rule[1];
            if (empty($rulesMap[$validator])) {
                continue;
            }
            $attributes = array_map('trim', explode(',', $rule[0]));
            foreach ($attributes as $k => $attribute) {
                if (in_array($attribute, $rulesMap[$validator])) {
                    unset($attributes[$k]);
                }
            }
            // unset if we got inherited rule of same validator
            if (empty($attributes)) {
                unset($parent[$i]);
            } else {
                $parent[$i][0] = implode(', ', $attributes);
            }
        }
    }

    return array_merge($parent, $rules);
} 
```

然后在 rules() 函数中，您只需调用：

```
public function rules()
{
    // NOTE: you should only define rules for those attributes that
    // will receive user inputs.

    $rules = array(
        blablabla...
    );

    return $this->mergeRules(parent::rules(), $rules);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-09T01:29:58.017

一种方法是给你的规则一个键。

从[文档](https://www.yiiframework.com/doc/guide/2.0/en/input-validation)

```
Note: It is handy to give names to rules i.e.

public function rules()
{
    return [
        // ...
        'password' => [['password'], 'string', 'max' => 60],
    ];
}

You can use it in a child model:

public function rules()
{
    $rules = parent::rules();
    unset($rules['password']);
    return $rules;
} 
```

在您的情况下，您可以在您的父类中执行此操作：-

```
public function rules() {
        return array(
            'requiredArray' => array('start_date, end_date, info, type_id', 'required'),

            'maxLengthArray' => array('start_date, end_date, type_id', 'length', 'max'=>10),

    } 
```

在你的孩子班： -

```
public function rules()
{
    $parent = parent::rules();
    $rules = array(
        'maxLengthArray' => array('start_date, end_date, type_id', 'length', 'max'=>16)
    );
    unset($parent['maxLengthArray']);

    return array_merge($parent,$rules);

} 
```

编辑：

请记住，如果您只想更新 'maxLengthArray' 中的 'one' 属性...其他属性必须在从父级“取消设置”后重新应用（显然 :)）。

例如：- 仅更改 type_id 长度......孩子看起来像：-

```
public function rules()
{
    $parent = parent::rules();
    $rules = array(
        'maxLengthArray' => array('start_date, end_date', 'length', 'max'=>10),
        'typeIdLength' => array('type_id', 'length', 'max'=>16),

    );
    unset($parent['maxLengthArray']);

    return array_merge($parent,$rules);

} 
```

# objective-c - 如何在自定义 NSView 上用 3 个手指（NSEvent）捕捉 1 个水龙头？

> ID：14550669
> 
> 赞同：4
> 
> 时间：2013-01-27T18:27:49.823
> 
> 标签：objective-c, macos, cocoa, mousedown, nsevent

我必须按照代码`mouseDown`在我的自定义上捕获 s`NSView`但我认为这只会捕获多少次点击（使用`clickCount`），而不是使用多少个手指来点击：

```
- (void)updateTrackingAreas{
    if(trackingArea != nil) {
        [self removeTrackingArea:trackingArea];
    }
    int opts = (NSTrackingMouseEnteredAndExited | NSTrackingActiveAlways);
    trackingArea = [[NSTrackingArea alloc] initWithRect:[self bounds]
                                                 options:opts
                                                   owner:self
                                                userInfo:nil];
    [self addTrackingArea:trackingArea];
}

- (void)mouseDown:(NSEvent *)theEvent{
    NSLog(@"%li",theEvent.clickCount);
    if ([theEvent clickCount] == 3){
        NSLog(@"3");
    }else{
        NSLog(@"normal");
    }
} 
```

关于如何在我的自定义 NSView 上用 3 个手指捕捉 1 个水龙头的任何想法？我想重现类似 Finder.app 选项的内容，您可以在其中用 3 根手指点击文件，然后会显示 QuickLook 面板。
谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:52:17.127

尝试在 mouseUp: 方法中执行此操作（而不是 mouseDown:)。此外，您不必设置跟踪区域来接收 mouseUp: 或 mouseDown: 事件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T14:03:50.153

**点击事件**

///////////////////

“如果您在 NSView 中的点击速度足够快，您将从方法“[theEvent clickCount]”中获得事件“点击计数”。

尝试在 mouseDown 中记录点击次数

NSLog(@"%d",[事件点击次数]); 并尝试点击快一点。”

//////////////////

**触摸事件**

/////////////////

在 OS X >= 10.6 中，您可以尝试覆盖这些触摸事件手势

*   (void)touchesBeganWithEvent:(NSEvent *)事件；
*   (void)touchesMovedWithEvent:(NSEvent *)event;
*   (void)touchesEndedWithEvent:(NSEvent *)事件；
*   (void)touchesCancelledWithEvent:(NSEvent *)事件；

&

添加

[自我 setAcceptsTouchEvents:YES]; 在初始化

////////////////

希望能帮助到你 ！！！

# java - java-试图用“&”替换“&”但仍然看到未更改的文本

> ID：14550677
> 
> 赞同：0
> 
> 时间：2013-01-27T18:28:31.847
> 
> 标签：java, xml

> **可能重复：**
> [为什么我不能在 Java 中删除 WhiteSpaces？](https://stackoverflow.com/questions/14539791/why-cant-i-remove-whitespaces-in-java)

在 java 程序中，为了使某些 XML 可解析而不会出现错误，我使用以下代码替换`"&"`字符`"&amp;"`- 变量“origString”将每一行存储在输入文件中（一个接一个）

```
 if(origString.contains("&"))
 {  

      System.out.println(" This line contains & --");

      System.out.println(" origstring=" + origString);

      origString.replace("&" , "&amp;");

      System.out.println(" origstring after replacing '&' =" + origString);
 } 
```

然而，当我运行上面的代码时，我得到相同的字符串值没有改变——即“&”保持原样在 origString 变量中。

我在这里做错了什么？我该如何纠正这个错误？

此外，同样的问题是否适用于替换 "<" 、 ">" 、 """ 、 "'" 字符（使用 XML 文件中可接受的等效文本）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:31:56.773

`String`是不可变的，因此您需要将其分配回`String`变量以实际更改该变量试试这个：

```
origString = origString.replace("&" , "&amp;"); 
```

并以同样的方式检查你是否正在做同样的事情来**替换 "<" 、 ">" 、 """ 、 "'" 字符**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:30:18.627

```
origString = origString.replace("&" , "&amp;"); 
```

# javascript - 在 Phonegap 中使用 setAttribute

> ID：14550678
> 
> 赞同：0
> 
> 时间：2013-01-27T18:28:32.860
> 
> 标签：javascript, cordova, getelementbyid, setattribute

我是使用phonegap的新手，我遇到了一些问题。

我创建了一个基于 Web 的应用程序，它在浏览器中运行得非常好（也在 android 上）。现在我想将它移植到 phonegap 应用程序。让主页运行有点棘手 - 只有几行 javascript，但它可以工作。

此时我在主页上只有一个输入，只是一个文本输入。我发现使用以下方法更改值：

```
$('#input').val('Value'); 
```

但现在我想设置一些其他属性。在javascript中我使用：

```
var input = document.getElementById('input');
input.setAttribute("value", "Value");
input.setAttribute("name", "Name");
input.setAttribute("myOwnAttribute", "Something"); 
```

当我在 phonegap 中尝试这个时，我会得到错误

```
Object #<HTMLDocument> has not method 'getElementById' 
```

如果我尝试

```
$('#input').setAttribute("value", "Value"); 
```

我会得到错误

```
Object has not method 'setAttribute' 
```

那么为什么这不起作用呢？如何设置任何对象的任何属性？

非常感谢

马库斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:02:14.003

试试 attr 函数。

```
$('#input').attr("value", "Value");
$('#input').attr("name", "Name");
$('#input').attr("myOwnAttribute", "Something"); 
```

# php - 在 Codeigniter 上使用 SSL 和 WWW 改进 .htaccess

> ID：14550679
> 
> 赞同：0
> 
> 时间：2013-01-27T18:28:45.487
> 
> 标签：php, .htaccess, codeigniter

我正在尝试使 SSL 和重定向与我的 Web 应用程序完美配合。我希望始终将[https://www.mydomain.com/](https://www.mydomain.com/)加载到浏览器中——尽管，如果他键入子域——它应该被重定向到[https://subdomain.mydomain.com/](https://subdomain.mydomain.com/)。

我的意思是说，一切都应该是 SSL - 这就是我目前正在做的事情

```
Options -Indexes
Options +FollowSymLinks    
DirectoryIndex index.php

<IfModule mod_rewrite.c>

    RewriteEngine on

    RewriteCond %{HTTP_HOST} !^(www) [NC]
    RewriteRule ^(.*)$ http://www.mydomain.com/$1 [L,R=301]

    RewriteCond %{REQUEST_FILENAME} !index.php        
    RewriteRule (.*)\.php$ index.php/$1

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [QSA,L]

</IfModule>

<IfModule !mod_rewrite.c>
    ErrorDocument 404 index.php
</IfModule> 
```

另外，我希望改进这个 .htaccess 文件，以便引入更多安全措施，另外还只允许每个人访问 js、css 和图像文件 - 将所有内容隐藏或重定向到 404 页面。

请指导，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T15:15:53.170

这些重写条件可能会对您有所帮助，我使用它来使我的 CodeIgniter 转到 HTTPS：

```
RewriteEngine on

RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L] 
```

# jquery - #id 和 .class 的性能

> ID：14550689
> 
> 赞同：1
> 
> 时间：2013-01-27T18:29:42.353
> 
> 标签：jquery, optimization, tree

一些帖子建议 #id 在基于速度测试的 Jquery 中比 .class 快，或者 #id 和 .class 已针对浏览器进行了优化。但是，我想这应该取决于它如何遍历 HTML Dom 树。

例如：

```
 P
            |
    ---------------
    |             |
    C1            C2
    |             |
 -------       ------
 |     |       |    |

 C11   C12     C21  C22 
```

对于查找 c12，路径是 P-C1-C11-C1-C12（根据结构，它可能是不同的路径，但我现在可以记住了）

无论 c12 是 class 还是 id，它都是相同的路径，这意味着 $('#C12') 或 $('P C1 .C12') 的性能相同

我的第一个问题是我的理解是否正确？问题 2：我一直在考虑彼此之间的性能，并尽量减少我的代码以将重复项放在一起成为函数，另一方面，这需要时间。我应该继续这样做还是只是让它先工作然后再改变它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:46:11.353

为什么要费心猜测，这里有一个具有相同结构和选择器的实时示例：http: [//jsfiddle.net/3Ah5S/](http://jsfiddle.net/3Ah5S/)

HTML

```
<div id="idP" class="classP">
            <h1>P</h1>
            <div id="idC1" class="classC1">
                <b>C1</b>
                <div id="idC11" class="classC11">
                -->C11
                </div>
                <div id="idC12" class="classC12">
                -->C12
                </div>
            </div>
            <div id="idC2" class="classC2">
                <b>C2</b>
                <div id="idC21" class="classC21">
                -->C21
                </div>
                <div id="idC22" class="classC22">
                -->C22
                </div>
            </div>      
        </div>
        <br/>
        <div id="idResults">

        </div>
        <br/>
        <div id="classResults">

        </div> 
```

jquery测试代码

```
$(document).ready(function(){

                startTime = new Date().getTime();
                for (i = 0; i < 10000; i++)
                {
                    s = $("#idC12");
                }           
    $("#idResults").html("c12 by id time: "+elapsedMilliseconds(startTime));

    startTime = new Date().getTime();
                for (i = 0; i < 10000; i++)
                {
                    s = $(".classC12");
                }           
    $("#classResults").html("c12 by class time: "+elapsedMilliseconds(startTime));
});

function elapsedMilliseconds(startTime)
            {
                var n = new Date();
                var s = n.getTime();
                var diff = s - startTime;
                return diff;
            } 
```

绝对 ID 时间更快，因为它利用特定于浏览器的指令来直接获取您的元素，而无需遍历 DOM 树。

**更新：** 按 ID 搜索更快的原因是浏览器倾向于在渲染页面时为 DOM 树中具有唯一 ID 的每个元素创建一个变量，因此按 ID 查询是最快的方式，因为它将使用直接关联变量。

可以在这里找到一个很好的解释：http: [//javascript.info/tutorial/searching-elements-dom](http://javascript.info/tutorial/searching-elements-dom)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:31:02.020

因此，.videoContainer 应该比 #dialog .videoContainer “更快”，因为它错过了对 #dialog.use 的[测试](https://stackoverflow.com/questions/5797014/why-do-browsers-match-css-selectors-from-right-to-left)

# jquery - 将 each() 与 JSONP 结果一起使用

> ID：14550695
> 
> 赞同：0
> 
> 时间：2013-01-27T18:29:58.130
> 
> 标签：jquery, api, jsonp, each

我正在使用 themoviedb.org API，它提供了返回电影等数据的 JSONP API。

我正在尝试创建一个可以搜索电影的表单，它将根据查询返回 5 个最相关的电影标题。

目前我正在使用：

```
 success: function(parsed_json) {
               console.log(parsed_json);

               $(".search").append("<li data-id=" +parsed_json["results"]["0"]["id"]+ ">" + parsed_json["results"]["0"]["original_title"] + "</li>");
               $(".search").append("<li data-id=" +parsed_json["results"]["1"]["id"]+ ">" + parsed_json["results"]["1"]["original_title"] + "</li>");
               $(".search").append("<li data-id=" +parsed_json["results"]["2"]["id"]+ ">" + parsed_json["results"]["2"]["original_title"] + "</li>");
               $(".search").append("<li data-id=" +parsed_json["results"]["3"]["id"]+ ">" + parsed_json["results"]["3"]["original_title"] + "</li>");
               $(".search").append("<li data-id=" +parsed_json["results"]["4"]["id"]+ ">" + parsed_json["results"]["4"]["original_title"] + "</li>");
               $(".search").append("<li data-id=" +parsed_json["results"]["5"]["id"]+ ">" + parsed_json["results"]["5"]["original_title"] + "</li>");
           } 
```

用 data-id = 电影 id 附加所有电影标题。这似乎是很多编码，我想知道是否有一种方法可以使用 each() 来附加前 5 个相关的电影标题。

JSONP API 信息：http: [//help.themoviedb.org/kb/api/jsonp](http://help.themoviedb.org/kb/api/jsonp)

工作 JSFiddle：http: [//jsfiddle.net/javascript/5ApuF/](http://jsfiddle.net/javascript/5ApuF/)

***编辑：***

我试过了：

```
success: function(parsed_json) {
    var textToInsert = [];
    var i = 0;
    var length = parsed_json.length;
    for (var a = 0; a <length; a += 1) {
        textToInsert[i++]  = '<li>';
        textToInsert[i++] = parsed_json[a];
        textToInsert[i++] = '</li>' ;

    }
    $('.search').append(textToInsert.join(''));

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:39:32.597

我相信这样的事情应该可以满足您的需求......

```
success: function(parsed_json) {
    console.log(parsed_json);
    if (k > 4) {
        return false;
    }
    $.each(parsed_json["results"], function(k, v) {
         $(".search").append("<li data-id=" +v["id"]+ ">" + v["original_title"] + "</li>");
    });
} 
```

祝你好运！我编辑了这个，因为我忘了你只想要 5 个结果 :)

--al

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:48:18.897

尝试

```
for (result in parsed_json["results"]) {
    $(".search").append("<li data-id=" +parsed_json["results"][result]["id"]+ ">" + parsed_json["results"][result]["original_title"] + "</li>");
} 
```

# ruby-on-rails - Rails、Sphinx 和 SQL 注入

> ID：14550698
> 
> 赞同：1
> 
> 时间：2013-01-27T18:30:16.727
> 
> 标签：ruby-on-rails, sql-injection, sphinx

寻找如何使我的狮身人面像搜索词安全，我遇到了这篇文章：

> [http://www.kpdirection.com/featured/how-to-avoid-thinking-sphinx-injection-attacks/#comment-42556](http://www.kpdirection.com/featured/how-to-avoid-thinking-sphinx-injection-attacks/#comment-42556)

但是，它有些旧。我在 Sphinx 文档中找不到关于如何防止 SQL 注入的任何内容。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:39:43.513

嗯，要指出的明显一点是 sphinx 不是 SQL 数据库。它不会执行任意的“sql”命令。

有 sphinxQL - 这是一种与 mysql 通信的方式，如 SQL 语法。但是 1）thinking-sphinx 不使用它，2）标准的 sql 注入预防措施在那里工作（例如使用准备好的查询）

# mysql - 从 MySql 配置我的 ODBC 驱动程序时，我收到错误“架构不匹配”

> ID：14550701
> 
> 赞同：0
> 
> 时间：2013-01-27T18:30:52.003
> 
> 标签：mysql

从 MySql 配置我的 ODBC 驱动程序时，我收到错误“驱动程序和应用程序之间的架构不匹配”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:33:06.580

检查您的应用程序版本是否有合适的版本（32 位或 64 位）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:34:47.817

我猜这是 Windows 7 的 64 位版本？

5.1.10 版本的连接器会出现此问题。不确定5.1.9。

但是，版本 5.1.8 有效。您可以在“档案”下找到[它](http://dev.mysql.com/downloads/connector/odbc/)。

# java - 使 while 循环工作和 if 语句读取负双精度时出现问题

> ID：14550703
> 
> 赞同：0
> 
> 时间：2013-01-27T18:31:09.153
> 
> 标签：java, loops, double

我正在尝试为我的 java 类编写一些简单的代码，我遇到了两个问题。对不起，如果这对你们大多数人来说似乎很容易，我只是从 Java 开始。我遇到的第一个问题是循环不能正常继续。它运行一次就好了，如果在开始时输入“quit”就会退出，但运行一次后，它不会让用户输入另一个值作为emp name。它直接从最后一行输入emp名称到循环的第一行，输入小时费率，没有机会输入新名称或退出。

我的第二个问题是我的 if 语句试图确保输入的小时费率和工作时间值大于 0。如果输入 0，它会给出错误消息，但如果输入负数，程序会继续没有什么是错的。我如何确保输入的值只是一个正双精度，并且它不会接受负双精度或零？

```
// Program to Calculate Payroll
import java.util.Scanner;
import java.text.DecimalFormat;

class Payroll
{
   public static void main(String args[])
   {
   Scanner myScanner = new Scanner(System.in);
   String empName;
   double hourlyRate;
   double hoursWorked;
   double grossPay;
   double netPay;
   double taxes;
   DecimalFormat money = new DecimalFormat("$.00");
//Get User Information
   System.out.print( "Enter employee name or enter 'quit' when finished. " );
   empName = myScanner.nextLine();
   while (!empName.equals("quit"))
   {
     System.out.print( "What is their hourly rate? $");
     hourlyRate = myScanner.nextDouble();
     if (hourlyRate <= 0)
     {
         System.out.println( "Value is not valid, please enter an amount above zero.");
         System.out.print( "What is their hourly rate? $");
         hourlyRate = myScanner.nextDouble();
     }
     System.out.print( "How many hours did they work? ");
     hoursWorked = myScanner.nextDouble();
     if (hoursWorked <= 0)
     {
         System.out.println( "Value is not valid, please enter an amount above zero.");
         System.out.print( "How many hours did they work? ");
         hoursWorked = myScanner.nextDouble();
     }
//Calculate Pay and Taxes
     grossPay = hourlyRate * hoursWorked;
     taxes = .13 * grossPay;
     netPay = grossPay - taxes;
//Display All Information
     System.out.print( "Employee name: ");
     System.out.println(empName);
     System.out.print( "Hourly Rate: ");
     System.out.println(money.format(hourlyRate));
     System.out.print( "Hours Worked: ");
     System.out.println(hoursWorked);
     System.out.print( "Gross Pay = ");
     System.out.println(money.format(grossPay));
     System.out.print( "Federal Taxes = ");
     System.out.println(money.format(taxes));
     System.out.print( "Net Pay = ");
     System.out.println(money.format(netPay));
     System.out.print( "Enter employee name or enter 'quit' when finished. " );
     empName = myScanner.nextLine();
   }
   System.out.println( "Thank you for using this payroll program.");
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:34:51.437

`while`在回应您的第一个问题时，您不会在循环中重新询问员工姓名。您应该初始化`empName`循环外部，但每次循环时也要再次询问。

```
String empName = "";
while (!empName.equals("quit")) {
  //Get User Information  
  System.out.print( "Enter employee name or enter 'quit' when finished. " );
  empName = myScanner.nextLine();

  if (empName.equals("quit")) {
    break;
  } 
```

对于第二个问题，您可以`while`再次使用循环并检查以确保`hourlyRate`大于`0`。只要确保每次循环返回检查时都重新提示。

```
hourlyRate = -1;
while (hourlyRate <= 0) {
  System.out.print( "What is their hourly rate? $");
  hourlyRate = myScanner.nextDouble();
  if (hourlyRate <= 0) {
    System.out.println( "Value is not valid, please enter an amount above zero.");
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:35:43.417

> 它不会让用户为 emp 名称输入另一个值。

您只需询问员工姓名一次，因为它不在循环内。移动代码以询问循环内的名称。您可能会最简单地将代码添加到循环的末尾，但我更喜欢在开始时进行检查并休息一下。

> 我如何确保输入的值只是一个正双精度，并且它不会接受负双精度或零？

您只要求用户更正一次号码。如果您使用 while 循环，它将一直询问，直到速率正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:47:44.957

> 它不会让用户为 emp 名称输入另一个值。

因为你的线路有问题

```
 hoursWorked = myScanner.nextDouble(); 
```

因为这只需要双精度值而不是`\n`值。所以，最后，当程序移动到该行时

```
 empName = myScanner.nextLine(); 
```

它将继续获取`\n`empName，并跳过键盘输入。在询问 empName 值的输入之前，您需要放置另一个 myScanner.nextLine()。

```
 myScanner.nextLine();
 System.out.println("....");
 empName = myScanner.nextLine(); 
```

对于验证，只需像其他建议的那样做

# php - 自定义类别上的 WordPress 自定义帖子类型

> ID：14550704
> 
> 赞同：1
> 
> 时间：2013-01-27T18:31:19.450
> 
> 标签：php, wordpress

有人可以告诉我如何创建自定义类别和帖子类型，包括红框内的项目并将它们添加到 WordPress 仪表板吗？

![在此处输入图像描述](../Images/e9086146ffa4987475db4b6b6deb5dc3.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:41:59.273

**长解释**

下面是一个示例代码：

```
add_action('init', 'demo_register_post_type');

function demo_register_post_type() {
register_post_type('demo', array(
'labels' => array(
'name' => 'Demos',
'singular_name' => 'Demo',
'add_new' => 'Add new demo',
'edit_item' => 'Edit demo',
'new_item' => 'New demo',
'view_item' => 'View demo',
'search_items' => 'Search demos',
'not_found' => 'No demos found',
'not_found_in_trash' => 'No demos found in Trash'
),
'public' => true,
'supports' => array(
'title',
'excerpt'
),
'taxonomies' => array('category', 'post_tag')
));
} 
```

对于类别：

```
add_action('init', 'demo_add_default_boxes');

function demo_add_default_boxes() {
register_taxonomy_for_object_type('category', 'demo');
register_taxonomy_for_object_type('post_tag', 'demo');
} 
```

当然，您可以自定义它，而不是“演示”有别的东西。

* * *

**简短说明**

您需要在 register_post_type() 函数中添加**'taxonomies' => array('category')**。

*   [register_post_type()](http://codex.wordpress.org/Function_Reference/register_post_type)
*   [register_taxonomy()](http://codex.wordpress.org/Function_Reference/register_taxonomy)
*   [register_taxonomy_for_object_type()](http://codex.wordpress.org/Function_Reference/register_taxonomy_for_object_type)

请告诉我们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:42:19.640

要注册新的自定义帖子类型，请使用该[`register_post_type`](http://codex.wordpress.org/Function_Reference/register_post_type)功能。

要添加自定义类别，请使用该[`register_taxonomy`](http://codex.wordpress.org/Function_Reference/register_taxonomy)功能。

添加这些后，它们将自动显示在您的仪表板中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T12:31:31.430

要显示您使用[register_taxonomy](http://codex.wordpress.org/Function_Reference/register_taxonomy)函数添加的自定义类别，您应该将“show_admin_column”参数设置为**true**（默认情况下为 false）

例如。

```
register_taxonomy('event_category', array('event'), array(
  'public' => true,
  'show_in_nav_menus' => true,
  'hierarchical' => true,
  'show_ui' => true,
  'query_var' => true,
  'show_admin_column' => true
)); 
```

# c++ - Windows 上的 Clang 无法编译代码

> ID：14550705
> 
> 赞同：6
> 
> 时间：2013-01-27T18:31:20.413
> 
> 标签：c++, mingw, llvm, clang

在 CMake 和 MinGW 的帮助下，我在 Windows 上构建了 LLVM 和 Clang（3.2 版）。该建筑简单而成功。但是，Clang 无法使用示例代码。

```
#include <stdarg.h>
#include <stdio.h>

int main()
{
    printf("BAD: %lld\n", 1);
    return 0;
} 
```

当我用clang编译它时

```
clang -o printf.exe printf.c -v 
```

在 Windows 上，它失败并显示消息

```
 clang version 3.2 (branches/release_32 172788)
    Target: i686-pc-mingw32
    Thread model: posix
     "D:/llvm/Build/bin/clang.exe" -cc1 -triple i686-pc-mingw32 -S -disable-free -main-file-name printf.c -mrelocation-model static -mdisable-fp-elim -fmath-errno -mconstructor-aliases -target-cpu pentium4 -momit-leaf-frame-pointer -v -resource-dir "D:/llvm/Build/bin\\..\\lib\\clang\\3.2" -fmodule-cache-path "C:\\Users\\usrname\\AppData\\Local\\Temp\\clang-module-cache" -fno-dwarf-directory-asm -ferror-limit 19 -fmessage-length 140 -mstackrealign -fno-use-cxa-atexit -fobjc-runtime=gcc -fdiagnostics-show-option -fcolor-diagnostics -o C:/Users/usrname/AppData/Local/Temp/printf-976141.s -x c printf.c
    clang -cc1 version 3.2 based upon LLVM 3.2svn default target i686-pc-mingw32
    ignoring nonexistent directory "/usr/local/include"
    ignoring nonexistent directory "D:/llvm/Build/bin/../lib/clang/3.2/../../../i686-w64-mingw32/include"
    ignoring nonexistent directory "D:/llvm/Build/bin/../lib/clang/3.2/../../../x86_64-w64-mingw32/include"
    ignoring nonexistent directory "/mingw/include"
    ignoring nonexistent directory "/usr/include"
    #include "..." search starts here:
    #include  search starts here:
     D:/llvm/Build/bin/../lib/clang/3.2/include
     D:/llvm/Build/bin/../lib/clang/3.2/../../../include
     c:/mingw/include
    End of search list.
    printf.c:6:24: warning: format specifies type 'long long' but the argument has type 'int' [-Wformat]
            printf("BAD: %lld\n", 1);
                         ~~~~     ^
                         %d
    1 warning generated.
     "C:/MinGW/bin/gcc.exe" -v -c -m32 -o C:/Users/usrname/AppData/Local/Temp/printf-976142.o -x assembler C:/Users/usrname/AppData/Local/Temp/printf-976141.s
    Using built-in specs.
    COLLECT_GCC=C:/MinGW/bin/gcc.exe
    COLLECT_LTO_WRAPPER=c:/mingw/bin/../libexec/gcc/mingw32/4.6.1/lto-wrapper.exe
    Target: mingw32
    Configured with: ../gcc-4.6.1/configure --enable-languages=c,c++,fortran,objc,obj-c++ --disable-sjlj-exceptions --with-dwarf2 --enable-shared --enable-libgomp --disable-win32-registry --enable-libstdcxx-debug --enable-version-specific-runtime-libs --build=mingw32 --prefix=/mingw
    Thread model: win32
    gcc version 4.6.1 (GCC)
    COLLECT_GCC_OPTIONS='-v' '-c' '-m32' '-o' 'C:/Users/usrname/AppData/Local/Temp/printf-976142.o' '-mtune=i386' '-march=i386'
     c:/mingw/bin/../lib/gcc/mingw32/4.6.1/../../../../mingw32/bin/as.exe -o C:/Users/usrname/AppData/Local/Temp/printf-976142.o C:/Users/usrname/AppData/Local/Temp/printf-976141.s
    C:/Users/usrname/AppData/Local/Temp/printf-976141.s: Assembler messages:
    C:/Users/usrname/AppData/Local/Temp/printf-976141.s:7: Error: bad expression
    C:/Users/usrname/AppData/Local/Temp/printf-976141.s:7: Error: junk at end of line, first unrecognized character is `\'
    clang: error: assembler (via gcc) command failed with exit code 1 (use -v to see invocation) 
```

生成的临时汇编文件为：

```
 .def     _main;
        .scl    2;
        .type   32;
        .endef
        .text
        .globl  _main
        .align  16, 0x90, "\357\276\255\336"
    _main: 
```

Windows 上的 Clang 似乎生成了错误格式的汇编文件。但是在Linux上，它直接生成一个obejct文件而不是一个汇编文件并成功编译。

我该如何解决这个问题？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T18:52:48.003

你的安装有问题。

请在此处找到我的 Clang 版本： [Clang package](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/clang-3.2-release/) and [required GCC package](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/gcc-dw2-4.6-release/i686-w64-mingw32-gcc-dw2-4.6.3-2-release-win32_rubenvb.7z/download)。如Clang包下载目录所示，将两者解压到同一个目录，在PATH中添加“mingw32-dw2/bin”。我测试了你的代码，它可以工作。

请注意您的代码有错误：

```
#include <stdarg.h>
#include <stdio.h>

int main()
{
    printf("BAD: %lld\n", 1LL); // NOTE the suffix specifying "long long"
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T13:33:23.960

观察失败调用的行

"C:/MinGW/bin/gcc.exe" -v -c -m32 -o C:/Users/usrname/AppData/Local/Temp/printf-976142.o -x 汇编 C:/Users/usrname/AppData/本地/临时/printf-976141.s

如果我正确阅读了文档，clang 默认使用 AT&T 语法而不是 Intel。对于您的 gcc 版本，参数可能需要查找丢失/不正确的参数。如果运行成功的构建具有优先权，那么或者尝试编译为 .o，然后首先链接为带有 llvm 的 lld 的 exe，然后是 gnu 的 ld。

# java - 从接口的方法列表中调用单个方法

> ID：14550707
> 
> 赞同：0
> 
> 时间：2013-01-27T18:31:34.763
> 
> 标签：java, android, interface, abstract-class

有人可以解释为什么`getStartScreen()`接口中唯一的方法`Game`被添加为`MrNomGame`类中未实现的方法吗？

```
public class MrNomGame extends AndroidGame 
{
     public Screen getStartScreen() 
     {
        return new LoadingScreen(this); // Instantiate class
     }
}

public abstract class AndroidGame extends Activity implements Game 
{
     AndroidFastRenderView renderView;
     Graphics graphics;
     Audio audio;
     Input input;
     FileIO fileIO;
     Screen screen;
     WakeLock wakeLock;

@Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);

    boolean isLandscape = getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE;
    int frameBufferWidth = isLandscape ? 480 : 320;
    int frameBufferHeight = isLandscape ? 320 : 480;
    Bitmap frameBuffer = Bitmap.createBitmap(frameBufferWidth,
            frameBufferHeight, Config.RGB_565);

    float scaleX = (float) frameBufferWidth
            / getWindowManager().getDefaultDisplay().getWidth();
    float scaleY = (float) frameBufferHeight
            / getWindowManager().getDefaultDisplay().getHeight();

    renderView = new AndroidFastRenderView(this, frameBuffer);
    graphics = new AndroidGraphics(getAssets(), frameBuffer);
    fileIO = new AndroidFileIO(this);
    audio = new AndroidAudio(this);
    input = new AndroidInput(this, renderView, scaleX, scaleY);
    screen = getStartScreen();  //unimplemented method from MrNomGame
    setContentView(renderView);

    PowerManager powerManager = (PowerManager) getSystemService(Context.POWER_SERVICE);
    wakeLock = powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK, "GLGame");
}

@Override
public void onResume() {
    super.onResume();
    wakeLock.acquire();
    screen.resume();
    renderView.resume();
}

@Override
public void onPause() {
    super.onPause();
    wakeLock.release();
    renderView.pause();
    screen.pause();

    if (isFinishing())
        screen.dispose();
}

public Input getInput() {
    return input;
}

public FileIO getFileIO() {
    return fileIO;
}

public Graphics getGraphics() {
    return graphics;
}

public Audio getAudio() {
    return audio;
}

public void setScreen(Screen screen) {
    if (screen == null)
        throw new IllegalArgumentException("Screen must not be null");

    this.screen.pause();
    this.screen.dispose();
    screen.resume();
    screen.update(0);
    this.screen = screen;
}

public Screen getCurrentScreen() {
    return screen;
}

}

public interface Game 
{
    public Input getInput();
    public FileIO getFileIO();
    public Graphics getGraphics();
    public Audio getAudio();
    public void setScreen(Screen screen);
    public Screen getCurrentScreen();
    public Screen getStartScreen();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:38:47.560

**MrNomGame**类扩展了一个抽象类**AndroidGame**。由于**MrNomGame**是一个具体类，它必须实现其父类的所有抽象方法。抽象类**AndroidGame**没有实现 getStartScreen() 方法，因此，它被添加为 MrNomGame 类中的未实现方法。

# performance - 第一次查询 EF 速度低

> ID：14550722
> 
> 赞同：1
> 
> 时间：2013-01-27T18:33:28.213
> 
> 标签：performance, entity-framework, views

我首先使用 EF 代码，一个模型有超过 200 个实体（winforms），当我第一次运行我的程序时，运行第一个查询需要很长时间，然后我使用预先生成的视图来提高性能，启动时间减少到大约 12-13 秒（在预生成视图之前，启动时间大约是 30 秒），我有哪些选项来减少我第一次查询的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:29:44.953

你没有太多选择。首先尝试使用最新的 EF 版本 - 这意味着 EF6 alpha 2，因为有一些改进，但可能还不够。恕我直言，将启动画面添加到您的应用程序并在应用程序启动期间进行“第一次查询”。如果 WinForms 应用程序执行一些复杂的逻辑，它们的启动时间可能会更长。通常整个应用程序在启动期间进行初始化，以便在启动后顺利运行。

# c++ - 获取从另一个地址指向的地址

> ID：14550726
> 
> 赞同：1
> 
> 时间：2013-01-27T18:33:56.210
> 
> 标签：c++, c, pointers, memory-address

为了练习，我试图获取某个内存地址指向的地址。我有一个***工具***可以显示我必须得到的结果。就我而言，它是：

```
"clientApp.exe"+0x11F9B08 -> 0E4C5F90 
```

所以我假设这基本上意味着：`("The base address of the .exe" + 0x11F9B08)`并且指向地址`0x0E4C5F90`。

我已经有了clientApp.exe 的基地址。我用`EnumProcessModules`和`GetModuleFileNameEx`为此。

*小片段*

```
if ( GetModuleFileNameEx( hProcess, hMods[i], szModName, sizeof(szModName) / sizeof(TCHAR)))
{
    if(gameName.compare(szModName))
    {
        dwClientBase = (DWORD)hMods[i]; //base address
        break;
    }
} 
```

然后稍后我试图获取指向的地址。但以下给了我一个完全不同的结果：

```
DWORD result = (DWORD)(dwClientBase + 0x11F9B08); 
```

这给了我：`23042824`。我正在寻找：`0x0E4C5F90`。我想我已经接近了，但不确定接下来我可以尝试什么。

任何人都知道我应该怎么做才能获得与***工具***给我的结果相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:10:26.893

您不取消引用指针。尝试任一

```
DWORD result = *(DWORD*)(dwClientBase + 0x11F9B08); 
```

或者

```
DWORD result = *(DWORD*)(0x11F9B08); 
```

转换为`DWORD*`表示编译器将数字视为指针，然后取消引用`*`它会导致读取实际数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:16:02.837

什么类型`dwClientBase`？如果它是 a`DWORD`那么你应该转换为 a`BYTE *`然后做你的算术，确保取消引用指针以返回该地址指向的值：

```
DWORD result = *(DWORD *)( (BYTE *)dwClientBase + 0x11F9B08); 
```

向指针添加数字时，编译器将添加等于该数字乘以指针类型大小的字节数。这就是为什么我们转换为`BYTE *`第一个，所以我们添加的正是`0x11F9B08`字节。

# android - 可以在 XML 中创建固定宽度的可绘制对象吗？

> ID：14550730
> 
> 赞同：11
> 
> 时间：2013-01-27T18:34:30.510
> 
> 标签：android, drawable, xml-drawable, layer-list

我试图简化一些图形，从每个密度需要 9 个补丁，到仅使用 XML 可绘制对象。这是一个相当简单的图形：

![9 补丁可绘制](../Images/168067cfdf4da789fd186372f5b1ca36.png)

2段：

*   两个段宽 8dp
*   顶部为 2dp 高
*   底部填充视图
*   右侧填充透明

设置为背景图像时给出此结果：

![9-patch 作为列表项示例](../Images/aa0f28ede53a2773857b11ee06efbe2e.png)

看起来这应该很容易重新创建为 XML 可绘制对象，并且可以避免创建 5 个不同的 9-patch 图形。但是，我已经查看了图层列表可绘制对象、插图可绘制对象、剪辑可绘制对象——它们似乎都要求您事先知道视图的大小（例如，要为插入保持 2dp，您需要设置`insetRight`为视图的宽度 - 2dp）。我也尝试使用`shape`标签的`size`标签，但这并没有保持固定的大小，只是固定的比例（所以对于更高的视图，它会按比例缩放）。

我是否忽略了一些简单的事情，或者这是我必须在布局后以编程方式检查的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T09:05:08.763

这是不可能的。这是我找到的最佳解决方案。只有 xml，没有编码，没有位图，没有额外的视图）

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
<item>
    <shape
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:shape="rectangle">

        <solid
            android:color="#ff0000" />
    </shape>
</item>
<item
    android:top="4dp">
    <shape
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:shape="rectangle">

        <solid
            android:color="#00ff00" />
    </shape>
</item>

<item
    android:left="10dp">
    <shape
        android:shape="rectangle">
        <solid
            android:color="#FFFFFF" />
    </shape>
</item> 
</layer-list> 
```

![在此处输入图像描述](../Images/7c306e4bacfa645a4bdd0dc12e08032d.png)

通过代码，您可以制作具有所需行为的自己的可绘制类型。Xml drawable 非常有限。恕我直言，我的建议最接近您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T15:37:13.143

我认为@Leonidos 的答案非常接近我的建议，除了我将可绘制对象用作单独的视图而不是整个列表详细信息布局的背景。这允许它是一个固定的宽度，并让项目文本有自己的背景。如果我不理解您的限制，请告诉我。

以下文件是“res/drawable/list_left_border”

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item>
        <shape android:shape="rectangle" >
            <solid android:color="#e76e63" />
        </shape>
    </item>
    <item android:top="2dp">
        <shape android:shape="rectangle" >
            <solid android:color="#ffc257" />
        </shape>
    </item>

</layer-list> 
```

然后在“res/layout/list_item.xml”中的列表项布局

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
    tools:context=".MainActivity" >

    <View
        android:background="@drawable/list_left_border"
        android:layout_width="8dp"
        android:layout_height="match_parent" />

    <TextView
        android:id="@+id/listItemText"
        android:textSize="15sp"
        android:padding="10dp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

这是图像。背景是粉红色的，表明列表项是透明的。

![在此处输入图像描述](../Images/04e8187078852f223a91f06616ce2be0.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T14:35:43.037

我将更进一步，建议对 AndroidGuy 的答案进行轻微修改，该答案本身包括 Leonidos 的答案。

相同的可绘制 XML，不同的列表项 XML 如下：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
tools:context=".MainActivity" >

<FrameLayout
    android:layout_width="match_parent"
    android:layout_height="100sp">

    <ImageView
        android:layout_width="8dp"
        android:layout_height="match_parent"
        android:src="@drawable/list_left_border" />

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:text="Item Text"
        android:textSize="22sp" >
    </TextView>
</FrameLayout> 
```

FrameLayout 提供原始背景行为，而不是分离到新视图中。

我在下面展示了这一点，并展示了背景：

![插图](../Images/748aee460eeb4d91a8061a4e021e772a.png)

但这并不真正值得积分。

# javascript - onChange 在 selectedIndex 不起作用

> ID：14550731
> 
> 赞同：1
> 
> 时间：2013-01-27T18:34:31.150
> 
> 标签：javascript, jquery, select, onchange

我有一个 CMS，我尝试使用 jQuery 和 CSS3 对其进行自定义，但我遇到了语言选择（下拉列表）的问题。
我定制了`<select>`以下本教程[http://tutorialzine.com/2011/02/converting-jquery-code-plugin/](http://tutorialzine.com/2011/02/converting-jquery-code-plugin/)

一切正常，但选择的**onChange**不起作用。因此，当我尝试从下拉列表（选择）中更改语言时，只会更改选择中的名称，但不会更改站点的语言。

这是我的选择：

```
<select name="lang" class="language" onChange="location.href=\''.$filename.'?lang=\' + this.options[this.options.selectedIndex].value +  \''.$trackpage.'\'"> 
```

我认为问题是由 jquery.tzSelect.js 引起的（请参阅教程），因为在这个插件中有一个`selectedIndex`（这与 select 的 selectedIndex 冲突）：

```
if(i==select.attr('selectedIndex')){
                    selectBox.html(option.text());
                } 
```

我试图从插件中删除此行代码但不起作用。
请帮忙！
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:37:23.763

您可以使用

```
this.value 
```

代替

```
this.options[this.options.selectedIndex].value 
```

# .net - TFS Build 不会下载缺失的 NuGet 包

> ID：14550737
> 
> 赞同：8
> 
> 时间：2013-01-27T18:34:54.040
> 
> 标签：.net, tfs, tfsbuild

我一直在尝试设置我的构建服务器（Team Foundation Service）以自动下载第 3 方库并成功构建，但我不知道该怎么做。

有办法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-28T23:31:23.267

您需要为要在构建机器上构建的解决方案启用包还原。这至少是我为让 NuGet 与 Team build 一起工作所做的工作。这是关于包还原以及如何在构建期间使用它的链接 [http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages](http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-21T11:38:30.090

为了建立 John Korsnes 在他的评论中所说的内容（因为仅凭这一点还不足以解决我的问题），从 NuGet 2.7 开始，您不需要显式启用包还原，因为它默认处于启用状态。对于我的项目，我缺少引用（特别是“名称空间'System.Web'中不存在类型或名称空间名称'优化'”）。

问题的解决方法是转到源代码管理资源管理器并**删除 \packages 文件夹**。我签入了更改并排队了另一个构建。这需要一段时间，因为构建服务器下载了包，但构建成功完成。

# function - SML：为什么函数总是采用一个参数使语言变得灵活

> ID：14550740
> 
> 赞同：4
> 
> 时间：2013-01-27T18:35:42.170
> 
> 标签：function, sml

我（从一本 SML 书中）了解到，SML 中的函数总是只需要一个参数：一个元组。一个接受多个参数的函数只是一个接受一个元组作为参数的函数，在函数绑定中通过一个元组绑定来实现。我明白这一点。

但是在这之后，这本书说了一些我不明白的东西：

`this point makes SML language flexible and elegant design, and you can do something useful that you cannot do in Java.`

为什么这种设计使语言灵活？文本指的是什么，SML可以但java不能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T00:42:16.797

使用元组而不是多个参数增加了灵活性，因为高阶函数可以与任何“arity”的函数一起使用。例如，要创建 list `[f x, f y, f z]`，您可以像这样使用高阶函数`map`：

```
map f [x, y, z] 
```

这很容易——你可以用任何语言做到这一点。但是现在让我们考虑`f`实际需要两个参数的情况。如果`f`是一个真正的二元函数（假设 SML 有这样的函数），我们需要一个不同的版本`map`，可以使用二元函数而不是一元函数（如果我们想使用三元函数，我们会也需要一个版本）。但是使用元组我们可以这样写：

```
map f [(x,a), (y,b), (z,c)] 
```

这将创建列表`[f (x,a), f (y,b), f (z,c)]`。

PS：在 SML 中，所有需要多个参数的函数都采用元组并不是真的。通常函数使用柯里化而不是元组来表示多个参数，但我想你的书还没有柯里化。柯里化函数不能以与上述相同的方式使用，因此在这个意义上它们并不通用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T01:05:05.560

实际上，我认为您根本不了解这一点。

首先，SML 中的函数不接受元组作为参数，它们可以接受任何东西作为参数。有时使用元组作为传递多个参数的方法很方便。例如，一个函数可以将记录作为参数、整数、字符串，甚至可以将另一个函数作为参数。也可以说它可以“无参数”，因为它可以将单位作为参数。

如果我正确理解您关于采用“多个参数”的函数的说法，那么您就是在谈论[currying](http://en.wikipedia.org/wiki/Currying)。例如

```
fun add x y = x + y 
```

在 SML 中，柯里化被实现为派生形式（句法糖）。有关其实际工作原理的详细说明，请参阅[此答案](https://stackoverflow.com/a/14438864/577513)。总之，SML 中只有匿名函数，但是我们可以将它们绑定到名称，以便以后可以“引用”/使用它们。

看哪，乱七八糟的要开始了。

在谈论任何事情的灵活性之前，我认为这是为了说明我的想法。我非常喜欢这种[对编程语言灵活性的](http://gerbil.org/tom/papers/flex.shtml)定义：“ *[...] 语言中的发音可以使用出乎意料的多种方式*”

在 SML 的情况下，选择了一种小而简单的核心语言。这使得实现编译器和解释器变得容易。灵活性体现在 SML 语言的许多特性已经使用这些核心语言特性来实现，例如匿名函数、模式匹配和 SML 具有高阶函数的事实。
这方面的例子有柯里化、case 表达式、记录选择器、if-the-else 表达式、表达式序列。

我想说这使得 SML 核心语言非常灵活，坦率地说非常优雅。

关于 SML 可以做什么，Java 不能（在这种情况下），我不太确定作者的去向。但是我很确定作者可能有点偏颇，因为您也可以在 java 中做任何事情。然而，它可能需要大量的编码:)

# wordpress - 标签和类别的 Wordpress 分页 404 错误

> ID：14550744
> 
> 赞同：1
> 
> 时间：2013-01-27T18:36:09.420
> 
> 标签：wordpress, pagination, http-status-code-404

我正在使用 wordpress 分页。我的代码有问题。分页在主页上工作正常。但在标签页和类别页上显示 404 错误。当我转到任何标签或类别时，它第一次显示正常，但是当我导航到下一页时，它显示 404 页面错误。

这是分页代码。

```
 <?php
function kriesi_pagination($pages = '', $range = 2)
{  
     $showitems = ($range * 2)+1;  

     global $paged;
     if(empty($paged)) $paged = 1;

     if($pages == '')
     {
         global $wp_query;
         $pages = $wp_query->max_num_pages;
         if(!$pages)
         {
             $pages = 1;
         }
     }   

     if(1 != $pages)
     {
         echo "<div class='pagination'>";
         if($paged > 2 && $paged > $range+1 && $showitems < $pages) echo "<a href='".get_pagenum_link(1)."'>&laquo;</a>";
         if($paged > 1 && $showitems < $pages) echo "<a href='".get_pagenum_link($paged - 1)."'>&lsaquo;</a>";

         for ($i=1; $i <= $pages; $i++)
         {
             if (1 != $pages &&( !($i >= $paged+$range+1 || $i <= $paged-$range-1) || $pages <= $showitems ))
             {
                 echo ($paged == $i)? "<span class='current'>".$i."</span>":"<a href='".get_pagenum_link($i)."' class='inactive' >".$i."</a>";
             }
         }

         if ($paged < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($paged + 1)."'>&rsaquo;</a>";  
         if ($paged < $pages-1 &&  $paged+$range-1 < $pages && $showitems < $pages) echo "<a href='".get_pagenum_link($pages)."'>&raquo;</a>";
         echo "</div>\n";
     }
}
?> 
```

这是循环

```
<?php global $wp_query;
$args = array_merge( $wp_query->query_vars, array( 'post_type' => 'fahrzeug' ) );
query_posts( $args );
if ( have_posts() ) : while ( have_posts() ) : the_post(); 
$omc_review_enable =  get_post_meta(get_the_ID(), 'omc_review_enable', true);
$omc_final_score =  get_post_meta(get_the_ID(), 'omc_final_score', true);
$omc_final_percentage = $omc_final_score * 20 ;
$format = get_post_format();
if ( false === $format )
$format = 'standard';
?>      

<article class="omc-blog-two omc-half-width-category" id="post-<?php the_ID(); ?>">     
    <?php 
      global $h_sticky;
      global $displayed;
      $home_page = get_option ('shareit_home', 0);
      if (!$displayed and $h_sticky && $home_page == 1) {
        echo $h_sticky;
        $displayed = true;
      } 
    ?>  
    <div class="omc-resize-290 omc-blog">       

        <?php $category = get_the_category();?>
        <h3 class="omc-blog-two-cat"><a href="<?php echo home_url(); echo ('/?cat='.$category[0]->term_id); ?>"><?php echo $category[0]->cat_name; ?></a></h3>

        <?php if ($omc_review_enable == 1) { ?><span class="omc-blog-two-stars-under leading-article"><span class="omc-blog-two-stars-over leading-article" style="width:<?php echo $omc_final_percentage; ?>%"></span></span><?php } ?>

        <a href="<?php the_permalink();?>" >

            <?php if ($format == 'video' || $format == 'audio') { ?><span class="module-a-video-icon-big omc-half-width-icon omc-module-b-left"></span><?php } ?>

            <?php if (has_post_thumbnail()) { 
                //Changes made by wisdmlabs starts
                //the_post_thumbnail('half-landscape', array('class' => 'omc-image-resize')); //this is the original line
                the_post_thumbnail('mycustomsize',array('class'=>'custom-img-size'));
                //changes made by wisdmlabs ends

            } else {

                //echo('<img src="'.get_template_directory_uri().'/images/no-image-half-landscape.png" class="omc-image-resize" alt="no image" />');

            } ?>

        </a>

    </div><!-- /omc-resize-290 -->

    <div class="omc-blog-two-text">

        <h2><a href="<?php the_permalink();?>"><?php the_title();?></a></h2>

<!--

        <p class="omc-blog-two-date">
        <?php
         the_time('F jS, Y') ?> | <em><?php
             _e('by', 'gonzo'); ?> <?php the_author() ?></em></p>

-->

        <p class="omc-blog-two-exceprt" ><?php wpe_excerpt('blog_2', 'wpe_excerptmore'); ?></p>

<a href="<?php echo do_shortcode('[wpv-post-field name="Webseite zum Fahrzeug"]'); ?>" target="_blank" ><!--<?php echo do_shortcode('[wpv-post-field name="Webseite zum Fahrzeug"]'); ?>--><button class="btn_map" style="background-color:red;

" ><span class="button_title">Zum Anbieter</span></button></a>

        <br class="clear" />

    </div><!-- /omc-blog-two-text -->

</article>
<?php
//
//kriesi_pagination(2,2);
//
endwhile;  endif; ?> 
<br class="clear" />
<?php
kriesi_pagination();
wp_reset_query();
?> 
```

任何人都可以帮助我那里有什么问题吗？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T11:22:27.857

1）在WordPress中以管理员身份登录。

2) 转到设置选项卡。

3) 转到阅读选项卡。4) 将博客页面显示最多从默认的 10 更改为 * 小于 10 的任意数字。例如，5。

5）保存更改。

查看博客。

将数字编辑为小于10，希望对您有所帮助。它修复了我的。

在调试时，我发现默认每页帖子选项应小于 query_posts 函数中的任何自定义 posts_per_page。就这样。很奇怪，但这就是事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:57:52.690

我打赌你应该在存档页面上使用[paginate_links() 函数而不是 get_pagenum_link() ......](https://codex.wordpress.org/Function_Reference/paginate_links)

# database-design - DB设计帮助简单的产品和材料情况

> ID：14550751
> 
> 赞同：0
> 
> 时间：2013-01-27T18:37:05.293
> 
> 标签：database-design

我目前有 3 个简单的表：products（prodid、name 和 prodmatid）、materials（matid、name）和 prodmat（prodmatid、prodid 和 matid）。

我不确定以上是否是一个好的设计。产品可以由不同的材料组成，prodmat 表一次只允许一种材料用于产品 - 所以如果 productA 有 5 种材料，那么它需要 prodmat 中的 5 行。这是一种愚蠢的做法，我应该如何设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:45:02.170

在您的设计中，您似乎有一个表格中不需要的额外列`products`。您可以删除该列，因为您可以在表`prodmatid`中找到该关系。`prodmat`

所以你的结构是：`products (prodid, name)`, `materials (matid, name)`, 和`prodmat (prodmatid, prodid, matid)`

这允许产品“我的产品”、材料“材料 1”和“材料 2”，结果将是：

```
product (1, 'My Product')
material (1, 'Material 1'), material (2, 'Material 2')
prodmat (1, 1, 1), prodmat (2, 1, 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T18:41:19.820

这被称为`third normal form`并且是设计关系数据库的**公认方法。**

见[http://en.wikipedia.org/wiki/Third_normal_form](http://en.wikipedia.org/wiki/Third_normal_form)

**编辑**

有些人（包括我自己）会`prodmatid`从材料表中删除，因为`prodid`并且`matid`可以用作主键。其他人喜欢为每个表拥有 1 个唯一的主键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:06:43.617

假设这不是家庭作业......我会做这样的事情：

表：产品 Prodid (PK)、名称（我想一些额外的列会派上用场……比如……保质期？需要特殊存储？）

表：材料 Matid (PK)、名称、计量单位（以克、公斤、米、物品为单位...）（再次，价格？保质期？）

表：ProdMat PK：Prodit+MAtid、Prodit (FK)、Matid (FK)、数量。

所以，回到你的例子，让我们看看产品 Gizmo：

```
Products Table
Prodid  | Name
  00203 | Gizmo 
```

它由 5 种不同的“材料”制成：

```
Table: ProdMat 
Prodit | Matid | Qty
 00203 | 0034  | 2
 00203 | 0010  | 11
 00203 | 0567  | 1 
 00203 | 0002  | 1
 00203 | 0039  | 1.675 
```

这些是：

```
Table: Materials
 Matid | Name                  | u-o-m 
 0034  | Cogs, brass, diam.2"  | Units
 0010  | Spring, small         | Units
 0567  | Gizmo shell (lower)   | Units 
 0002  | Gizmo shell (upper)   | Units
 0039  | Sand                  | Pounds 
```

现在，如果您的问题包括子组件，或者作为原材料进入并可以进行内部加工以精炼、机加工或无论如何转化为一种或多种半加工材料/产品的材料/产品，而这些材料/产品可能反过来成为另一个产品......然后事情开始变得有趣。

# java - Root的get方法不能使用Entity参数

> ID：14550755
> 
> 赞同：1
> 
> 时间：2013-01-27T18:37:25.450
> 
> 标签：java, jpa-2.0, root

我使用 JPA2 作为 MySQL 连接器并使用查询构建器来构建查询。在尝试按实体参数对结果列表进行排序时，我发现了一些错误：

```
SEVERE: java.lang.IllegalArgumentException: The attribute [customer}] from the managed type [EntityTypeImpl@1572996478:Documentation [ javaType: class pl.ego.software.entity.Documentation descriptor: RelationalDescriptor(pl.ego.software.entity.Documentation --> [DatabaseTable(documentation)]), mappings: 20]] is not present. 
```

我不确定为什么，但这是唯一不存在于整个实体中的实体参数。尝试使用 Root 类的 get 方法时会引发此异常。

```
Root<Documentation> u = select.from(Documentation.class);
CriteriaBuilder builder = em.getCriteriaBuilder();
if (sortField != null) {
    Order o;
    if (sortOrder == SortOrder.ASCENDING) {
        o = builder.asc(u.get(sortField));
    } else {
        o = builder.desc(u.get(sortField));
    }
    select.orderBy(o);
} 
```

当 sortField 值设置为“客户”时，u.get(sortField) 会引发上述异常。如果 sortField 设置为某个不同的值，则一切正常。

这是确保该参数存在的实体代码的一部分。

```
@Size(max = 150)
@Column(name = "customer")
private String customer; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:50:23.810

不完全是，但你的帖子给了我一些线索。基本上是的，由于字段名称末尾的“}”符号引发了异常，但直到现在才知道为什么:)我遇到了一些问题

```
 sortBy="#{element.customer} " 
```

尽头是一片空白。

```
 sortBy="#{element.customer}" 
```

删除它修复了整个事情;）

# c++ - 如何动态访问函数对象的目标

> ID：14550757
> 
> 赞同：1
> 
> 时间：2013-01-27T18:37:36.220
> 
> 标签：c++, c++11, functor

我有一个函数对象向量 ( `std::function`)，它们都派生自一个公共基类 ，`base`如下所示。在对向量进行迭代时，我想访问并可能更改目标中的变量——例如`test`。在编译时，`std::function::target()`可以返回一个指向原始目标的指针，但有没有办法在运行时做到这一点——即动态访问`test`？函子向量可以由任意数量的不同目标函数组成。Boost 不是此代码库的选项。

```
#include <iostream>
#include <functional>
#include <vector>

typedef std::function<double(double)> Tfunc;

struct base { bool test; };

struct half : public base {
  template<typename T> T operator()(T x) { return x*0.5; }
};

struct square : public base {
  template<typename T> T operator()(T x) { return x*x; }
};

int main() {
  std::vector<Tfunc> v;
  v.push_back( half() );
  v.push_back( square() );

  v[0].target<half>()->test=false;
  v[1].target<square>()->test=true;

  for (auto &f : v)
    std::cout << f(2.0) << " " << f.target_type().name() << "\n";

  return 0;
} 
```

输出：

```
1 4half
4 6square 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:54:40.680

你真的需要使用继承将测试变量放在仿函数中吗？您可以像这样组合函子和测试变量：

```
struct math_operation
{
     Tfunc f;
     bool  test;
};

std::vector<math_operation> v;
v.push_back( math_operation() );
v.push_back( math_operation() );
v[0].f = half();
v[1].f = square();
v[0].test = false;
v[1].test = true; 
```

# php - 分发用 C 编写的 PHP 扩展的最简单方法是什么

> ID：14550758
> 
> 赞同：6
> 
> 时间：2013-01-27T18:37:38.063
> 
> 标签：php, c++, wrapper, php-extension

我为 djondb 创建了一个扩展，它是库的一个包装器，它是一个 C++ 库，我编译了它，并且可以从 djondb 站点下载它，我不是 PHP 专家，我遇到了一些问题分发，主要是我意识到我需要为每个平台进行每次编译并为每个平台创建一个安装程序，这很耗时，我想要的是分发源代码并允许用户以最简单的方式安装它，

我已经尝试过的：

1.  使用 phpize, configure, make, sudo make install 用户可以在 Linux 和 Mac 上非常容易地安装库，问题是用户需要在他们的计算机上安装 g++，make 等，而这个安装过程并没有在 Windows 上工作。
2.  为每个平台（Linux x86、x64、Mac、Windows 等）编译，并将每个 tar.gz 上传到站点，用户下载它并将每个文件放在正确的文件夹中。这里的问题是配置过于手动，用户往往会错过一些步骤，而且对用户不友好。另一个问题是我需要使用虚拟机编译每个版本，这很耗时。（现在我要包括 PHP 5.3 和 5.4 的版本，这意味着 8 个虚拟机来创建所有二进制文件）
3.  我试图在 PEAR 上创建一个帐户，但注册屏幕总是说我不需要一个帐户来实现我创建的目的......（似乎这是 PEAR 系统中的一个常见问题，但没有找到如何创建帐户来提议包）。
4.  在 PECL 上做了一个提案，但没有人回复邮件列表，似乎这也很常见。

所以我现在被 1 和 2 种分发方式困住了，什么是分发 PHP 扩展的最佳方式，该扩展是使用 C++ 创建的，以用户友好的方式创建且易于安装？

提前致谢，如果您对项目的结构或 phpize/configure/make 过程的完整解释有更多疑问，可以在[https://github.com/djondb/djondb_phpext看到项目代码。](https://github.com/djondb/djondb_phpext)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T19:43:42.537

走中间道路：为 Linux / OS X 用户分发源代码，他们可以自己构建它，并为 Windows 用户提供编译好的 DLL。这至少会限制您需要编译的版本数量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:49:20.290

作为维护我们公司使用的扩展的 PHP 开发人员，只提供源代码并期望用户在他们的机器上编译它是非常好的。

如果你想变得更好，为你自己支持的每台机器编译一个版本也是一种可接受的方式（例如参见 Zend），并将它放在易于下载的地方（如 sourceforge/github 等）。

然后，只需倾听用户的意见并随时改进您的（发布）系统。

# requirejs - Requirejs：构建后删除/删除 build.txt

> ID：14550761
> 
> 赞同：6
> 
> 时间：2013-01-27T18:38:00.213
> 
> 标签：requirejs

使用 r.js 库成功优化和构建模块后，您会找到包含所有模块及其依赖项的摘要的 build.txt 文件。

我不希望这个 build.txt 文件到达生产服务器。

除了手动删除 build.txt 之外，还有什么方法可以禁止或删除此文件？

手动删除不是我正在寻找的答案，因为您有时可能会忘记删除它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T11:43:08.500

据我了解[源代码](https://github.com/jrburke/r.js/blob/master/dist/r.js#L22811)e，没有办法阻止build.txt的创建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-02T00:10:17.570

已请求此功能：[https ://github.com/jrburke/r.js/pull/722/files](https://github.com/jrburke/r.js/pull/722/files)

要使用它，您需要在 build.js 文件中添加以下选项：

```
noBuildTxt: true 
```

正如路易斯指出的那样，它实际上并没有被添加：/

如果您愿意，您可以按照我的做法重新构建您的应用程序，这样您就不需要模块属性，添加 noBuildTxt 选​​项，然后*假装*它可以工作。（删除 modules 属性是摆脱模块定义的原因，而不是 noBuildTxt）

# objective-c - MBProgressHUD 阻止用户交互

> ID：14550765
> 
> 赞同：36
> 
> 时间：2013-01-27T18:38:09.183
> 
> 标签：objective-c, cllocationmanager, nsthread, mbprogresshud

我的应用程序`MBProgressHUD`在屏幕上有一个，同时`CLLocationManager`在后台的一个单独线程中获取用户当前位置。有时定位过程开始需要很长时间，显然我想让用户决定是否离开屏幕。问题是用户界面似乎被阻止了，`MBProgressHUD`因此用户无法按下后退按钮。

有没有解决这个问题的实现设计？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-01-27T18:42:15.997

为了实现非模态行为，只需禁用用户交互，`MBProgressHUD`以便触摸将通过它。

**Objective-C**

```
theHUD.userInteractionEnabled = NO; 
```

**斯威夫特 4.x**

```
theHUD.isUserInteractionEnabled = false 
```

# php - 我用于测试电话问题的正则表达式

> ID：14550766
> 
> 赞同：0
> 
> 时间：2013-01-27T18:38:10.643
> 
> 标签：php, regex

我想验证这些电话号码格式：

```
517123123
+48517123123
+48 517 123 123

(48)517123123
(48)517 123 123

517-123-123
48 517-123-123
48/517-123-123

48 517 123 123 
```

我写了这个正则表达式： `(\+?)+(((\(([0-9]+){2,2}\)))|(([0-9]+){2,2})?)+(\/?)+(\s?)+(([0-9]+){9,9}|([0-9]+){3,3}(\s|-){1,1}([0-9]+){3,3}(\s|-){1,1}([0-9]+){3,3})`

问题是它使大数字`8978978979878978967`有效。我的错误在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:44:48.423

只看正则表达式的结尾，我发现您似乎在多个地方都在做一些事情；

```
([0-9]+){3,3} 
```

`+`表示至少有一次 [0-9] 重复，这是一个`1111111111111`完全有效的匹配。然后，您将其限制为恰好 3 个匹配项，这仍然是一个非常长的数字。如果您想要 3 位数字，请删除`+`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:50:20.047

目前我看不到你的正则表达式在做什么，里面有太多多余的东西。

1.  您的群组过多

2.  你想重复可选字符！？

    例如：

    *   `(\+?)+`，你不需要一个小组，你也不想重复，所以`\+?`这里就是你想要的。

    *   `(\s?)+`，你想说“0个或更多空格”吗？然后`\s*`就是你需要的。

3.  当你写 eg`{9,9}`时，你可以去掉一个数字，`{9}`是一样的。

4.  您正在嵌套量词，**这就是您允许太多字符的地方**。你有多个地方，你在哪里`([0-9]+){9,9}`，这意味着 1 个或多个数字并重复 9 次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:51:15.123

可能是你失去了锚……但是，使用我的正则表达式`^(\+?(\(\d{2}\)|(\d{2})|(\d{2}[/ ])))?((\d{3} \d{3} \d{3})|(\d{3}-\d{3}-\d{3})|(\d{9}))$`

# c++ - 在 QTreeWidget 中插入元素时内存泄漏？

> ID：14550767
> 
> 赞同：0
> 
> 时间：2013-01-27T18:38:10.917
> 
> 标签：c++, qt, qt4, qtreewidget

当我将元素插入 a时，我为两者`QTreeWidget`分配内存`QStringList``QTreeWidgetItem`

```
QStringList *temp;
while(other_elements)
{
    temp = new QStringList();
    temp->push_back("first_field");
    temp->push_back("second_field");

    items.append(new QTreeWidgetItem((QTreeWidget*)0, *temp));

    element_iterator++;
}

myTreeWidget->insertTopLevelItems(0, items); 
```

我读到调用函数`QTreeWidgetItem`时会自动释放`clear()`，但是`QStringList`呢？是内存泄漏吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:47:05.413

你的代码会泄露，但不是你想的那样。

维护的`QStringList`将`QTreeWidgetItem`与树项一起删除 - 这将正常工作。

**但是**`temp`你分配的不会。当您将它传递`*temp`给构造函数时，该项目将存储它的*副本*。在构造函数调用之后，您分配的对象仍然存在并且很好 - 因为您没有删除它，所以它被泄露了。

将您的代码更改为以下内容以避免泄漏和不必要的堆分配：

```
while(other_elements)
{
    QStringList temp;
    temp.push_back("first_field");
    temp.push_back("second_field");

    items.append(new QTreeWidgetItem((QTreeWidget*)0, temp));

    element_iterator++;
} 
```

# php - IF 字符串等于 TEXT 然后 IMAGECREATEFROMPNG

> ID：14550769
> 
> 赞同：0
> 
> 时间：2013-01-27T18:38:18.217
> 
> 标签：php, if-statement, imagecreatefrompng

我目前有一个 imagecreatefrompng 函数并且它可以工作，但是当我在其上使用 IF 语句时，它不起作用并显示它无法加载图像......这是我所拥有的：

```
$design = $_GET["design"];

if ($design == "DESIGN_1") { $image = imagecreatefrompng('designs/hill.png'); }
if ($design == "DESIGN_2") { $image = imagecreatefrompng('designs/hill2.png'); } 
```

* * *

* * *

在标题中我有：

`http://www.website.com/create.png?design=DESIGN_1`

它显示 HILL.PNG

* * *

* * *

但是当我在标题中有以下内容时：

`http://www.website.com/create.png?design=DESIGN_2`

它不显示 HILL2.PNG 但显示图像未找到符号。

* * *

* * *

PS。两个图像都在设计文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:03:15.850

PHP代码没问题。

图像“designs/hill2.png”可能有错误

检查它 `<img src="http://www.website.com/designs/hill2.png"/>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:41:53.020

`.png`如果您导航到它，您可以在浏览器中查看第二个吗？会不会是格式错误的图像文件？由于代码看起来很好，并且实际上是在尝试显示图像......我不得不认为图像本身存在问题。

# oracle - 需要变量帮助的 Oracle 游标

> ID：14550770
> 
> 赞同：0
> 
> 时间：2013-01-27T18:38:22.457
> 
> 标签：oracle, cursor, temp-tables

我正在尝试做一个类似下面的游标，在不同的方法中苦苦挣扎，但没有结果。看来，我一个人也做不了，决定请你帮忙。下面的代码显示了我想要实现的目标，而不是现成的方法。请帮忙。

我不知道这很重要，但请注意，我需要循环更新 CUSTOMERS。我还需要在这个循环中从另一个引用客户的表中选择一些数据，然后在第三个表中插入一些数据并更新客户表。

```
DECLARE
  CURSOR MY_CURSOR
  IS
    SELECT CUSTOMERID FROM CUSTOMERS WHERE ACTIVE = 1 ;
  MY_RECORD MY_CURSOR%ROWTYPE;
BEGIN
  FOR MY_RECORD IN MY_CURSOR
  LOOP

 DECLARE TEMPORARY_TABLE TABLE (A DATE, B NUMBER, C VARCHAR)

 INSERT INTO @TEMPORARY_TABLE(A,B,C) (SELECT CREATEDDATE, ID, NAME FROM ACCOUNT WHERE CUSTOMER = MY_RECORD.CUSTOMERID)

 INSERT INTO SOME_EVENT_TABLE(ID, NAME, DATE, ACCOUNT_ID) VALUE (some_seq.NEXTVAL, @TEMPORARY_TABLE[C], @TEMPORARY_TABLE[A], @TEMPORARY_TABLE[B])

     UPDATE CUSTOMERS SET LAST_ACCOUNT_CHECK_NAME=@TEMPORARY_TABLE(C), LAST_INSERTED_EVENT_ID = some_seq.CURRVAL  WHERE ID = MY_RECORD.CUSTOMERID

  END LOOP;
  COMMIT;
END; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:53:43.457

首先，您不能像在 SQL Server 中那样在 Oracle 中声明临时表。但是，无论如何，你真的不需要它。

像这样的东西应该工作：

```
FOR MY_RECORD IN MY_CURSOR LOOP
  FOR  R IN (SELECT CREATEDDATE, ID, NAME 
               FROM ACCOUNT WHERE CUSTOMER = MY_RECORD.CUSTOMERID) LOOP
    INSERT INTO some_event_table(ID, NAME, DATE, ACCOUNT_ID)
    VALUES (some_seq.NEXTVAL, R.NAME, R.CREATEDATE, R.ID);

    UPDATE customers 
       SET last_account_check_name = R.name
         , last_inserted_event_id = some_seq.CURRVAL
     WHERE id = MY_RECORD.CUSTOMER_ID;
  END LOOP;
END LOOP;
COMMIT; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T02:07:53.397

SQL 中的逐行操作非常低效。如果您以基于集合的方式执行此操作，您将获得更好的性能。

```
INSERT INTO some_event_table(ID, NAME, DATE, ACCOUNT_ID)
SELECT some_seq.NEXTVAL, a.name, a.createdate, a.id
  FROM ACCOUNT a
 INNER JOIN customers c ON c.customerid = a.customerid
 WHERE c.active = 1;

UPDATE customers 
   SET last_account_check_name = 
          ( SELECT a.name FROM account a WHERE a.customerid = c.customerid ),
       last_inserted_event_id = some_seq.CURRVAL
 WHERE c.active = 1; 
```

这可能存在并发问题（如果在两个语句之间更新客户会发生什么？），但这可能足以满足您的需求。

# ios - 比较两个 NSDictionaries 并在键不匹配时删除

> ID：14550777
> 
> 赞同：1
> 
> 时间：2013-01-27T18:39:01.997
> 
> 标签：ios, compare, nsdictionary

在我的应用程序中，我使用了两个 NSMutableDictionaries。让我们称它们为 basicDictionary 和 refreshDictionary。

在 basicDictionary 我有价值观，让我们说

key:"1" value:"2000" photo:someUIImage //假设我想跟踪玩家的得分 key:"2" value:"1500" photo:someUIImage2 key:"3" value:"1500" photo:someUIImage3键：“4” 值：“1500” 照片：someUIImage4

key 代表玩家 id，rest 很清楚。

我每 20 秒调用一次服务器 api 来刷新玩家的分数。因为我不想加载照片以及即时使用刷新调用给我带来只有玩家 ID 和他的实际分数。

所以每 20 秒我就会得到保存在 refreshDictionary 中的数据。只有 id 和该 id 的当前分数。

刷新字典示例：

键：“1” 值：“2500” 键：“2” 值：“2800” 键：“3” 值：“2700”

我用新值更新了我的 tableView。如您所见，我只获得了 3 个玩家的数据，因为玩家 4 删除了他的个人资料。现在我的问题是，如何更新 basicDictionary 以删除播放器 4？

我知道我应该使用`if (!([basicDictionary isEqualToDictionary:refreshDictionary))` 它，但是它不会告诉我它们在哪个键上不相等。

那么你们会怎么做呢？我应该在嵌套循环中遍历它们吗？当字典更大时，这似乎会消耗大量时间。哦，顺便说一句，我的字典总是以相同的方式排序（按玩家 ID）

我的想法是，我比较这两个字典

```
 - (void)connectionDidFinishLoading:(NSURLConnection *)connection {
        if (refresh)
        { //compare dictionaries and modify basicDictionary that is data source for my tableview by deleting where key doesn't match
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:59:01.140

此代码将为您提供更改的密钥：

*注意：由于键的查找基本上是跳转到哈希图（o1 操作）中，因此您不必担心您所说的第二个数组遍历*

```
#import <Foundation/Foundation.h>

@interface NSDictionary (changedKeys)
- (NSArray*)changedKeysIn:(NSDictionary*)d;
@end

@implementation NSDictionary (changedKeys)
- (NSArray*)changedKeysIn:(NSDictionary*)d {
    NSMutableArray *changedKs = [NSMutableArray array];
    for(id k in self) {
        if(![[self objectForKey:k] isEqual:[d objectForKey:k]])
            [changedKs addObject:k];
    }
    return changedKs;
}
@end

int main(int argc, char *argv[]) {
    @autoreleasepool {
        NSDictionary *d1 = @{@"1":@"value",@"2":@"value",@"3":@"value",@"4":@"value"};
        NSDictionary *d2 = @{@"1":@"value",@"2":@"newvalue",@"3":@"value"};

        NSArray *ks = [d1 changedKeysIn:d2];
        NSLog(@"%@", ks);   

    }

    return 0;
} 
```

编辑： self.allKeys 更改为 self - 已经可以枚举字典

# sql - 如何在存储过程中使用 IF？

> ID：14550778
> 
> 赞同：-1
> 
> 时间：2013-01-27T18:39:03.780
> 
> 标签：sql, stored-procedures

```
IF Dealdate = @DealDate 
```

我`IF`在存储过程中使用命令。在该命令中，我使用变量检查表中的列，但它无法执行并返回此错误：

> *列名“交易日期”无效。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:42:19.613

如果您想检查表中是否存在`DealDate`等于等于的行`@DealDate`，这就是您要执行的操作，

```
IF EXISTS (SELECT * FROM MyTable WHERE DealDate = @DealDate)
BEGIN
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:30:09.383

如果要检查表中的值。你需要像这样检查表中列的值 IF EXISTS (SELECT DealDate FROM MyTable WHERE DealDate = @DealDate) BEGIN --你的逻辑在这里。结尾

但是您收到错误“无效的列名'Dealdate'”，这表明您的代码“if Dealdate = @DealDate”没有指定什么是Dealdate，所以SQL服务器给出了这个错误，因为Dealdate不是一个变量，所以SQL Server尝试搜索对于具有这样名称的列，但由于我们的代码中未指定表名，因此会出现此错误。

# sql - 我的触发器是否更新了所有记录

> ID：14550784
> 
> 赞同：1
> 
> 时间：2013-01-27T18:39:43.827
> 
> 标签：sql, sql-server, sql-server-2008, triggers, sql-server-2008-r2

我编写了一个简单的触发器，它使用 id 列值设置列值。这是我的触发器。

```
CREATE TRIGGER SubSectionsPrioritytrigger
ON SubSections
AFTER INSERT
AS
UPDATE dbo.SubSections
SET Priority = Id 
```

在编写此触发器之后，是否会在每次插入后更新所有记录。或唯一创建的新行。

有人可以提供有关此的任何信息。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:43:40.977

它完全按照你写的

```
UPDATE dbo.SubSections
SET Priority = Id 
```

任何行都会被更新。

您可以将其更改为

```
UPDATE dbo.SubSections  
SET  SubSections.Priority = Inserted.Id 
FROM INSERTED
WHERE INSERTED.id = SubSections.id 
```

这只会影响插入的行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-27T18:48:33.320

要仅更新插入的行，您可以执行以下操作：

```
UPDATE dbo.SubSections  
SET  SubSections.Priority = SubSections.Id 
FROM INSERTED
WHERE INSERTED.Id = dbo.SubSections.Id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-27T19:11:28.297

要将最后插入的行更新为您想要的任何值，您需要指定使该行与其他行唯一的行 ID。并且在您的触发器中，您没有指定导致表中所有行都被更新的 where 子句。每当与触发器关联的表上发生任何操作/事件时，意味着插入/更新或删除新记录时，就会在 SQL Server 的内存中创建一个魔术表，我们可以使用关键字“Inserted”访问该魔术表在插入或更新的情况下，在删除的情况下为“已删除”。所以你的查询应该是这样的。

更新 dbo.SubSections
SET SubSections.Priority = SubSections.Id FROM INSERTED WHERE INSERTED.Id = dbo.SubSections.Id

# c# - 在 Castle Windsor 中，参数传递不优于默认实现

> ID：14550785
> 
> 赞同：1
> 
> 时间：2013-01-27T18:39:44.753
> 
> 标签：c#, .net, dependency-injection, castle-windsor, constructor-injection

我希望参数实现优于默认注册的实现，但它不起作用。

*   事实上，[文档表明它应该可以工作](http://docs.castleproject.org/Windsor.How-Dependencies-Are-Resolved.ashx)

### 不正确的偏好演示

```
 private static void Main(string[] args)
    {
        PassParamThatsAlreadyRegisteredAtResolutionTime();
        Console.ReadLine();
    }

    private static void PassParamThatsAlreadyRegisteredAtResolutionTime()
    {
        Console.WriteLine("Passing argument that is already registered 
                    does not take precedence over the default implementation");
        var container = new WindsorContainer();
        container.Register(
            Component.For<ISimpletonManager>()
                     .ImplementedBy<SimpletonManager>()
                     .LifestyleTransient()
                     .Properties(PropertyFilter.IgnoreAll));
        container.Register(Component.For<ISimpleton>().UsingFactoryMethod(() =>
                                     new Simpleton("Default Implementation"))
                                    .LifestyleTransient());
        // The above line could equally be the following, result is the same:
        // container.Register(Component.For<ISimpleton>()
        //                     .ImplementedBy<Simpleton>().LifestyleTransient());
        var runtimeConstructorParam = new Simpleton("Passed In Implementation");
        var runtimeArguments = new Arguments(
                                 new object[] {runtimeConstructorParam});
        var shouldBeManagerWithPassedInSimpleton = container
                             .Resolve<ISimpletonManager>(runtimeArguments);
        Console.WriteLine(shouldBeManagerWithPassedInSimpleton.Log);
    } 
```

### 控制台输出

```
Passing argument that is already registered
does not take precedence over the default implementation
Birth With Child Simpleton: Default Implementation 
```

### 如何反转偏好？

*   我需要能够忽略默认注册的依赖项，而是使用提供的参数作为 ISimpleton 依赖项进行 Castle Windsor 解析？
*   我需要实现自己的[IDependencyResolver](http://docs.castleproject.org/Windsor.How-Dependencies-Are-Resolved.ashx)吗？如何？
*   或者[DynamicParameters](http://docs.castleproject.org/Windsor.Inline-dependencies.ashx)在这里有用吗？

### 提供的依赖项 - Simpleton 类

```
public class Simpleton : ISimpleton
{
    public Simpleton(string id)
    {
        Id = id;
    }

    public string Id { get; set; }
} 
```

### 已解析类型 - SimpletonManager

```
public class SimpletonManager : ISimpletonManager
{
    private ISimpleton _child;

    public SimpletonManager(ISimpleton simpleton)
    {
        Child = simpleton;
    }

    public ISimpleton Child
    {
        get { return _child; }
        set
        {
            _child = value;
            Log = "Birth With Child Simpleton: " + Child.Id;
        }
    }

    public string Log { get; private set; }
} 
```

* * *

[[使用 Castle.Core.dll 和 Castle.Windsor.dll 3.1.0 (2012-08-05)](http://www.castleproject.org/download/#windsor3) ]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T22:53:38.023

与[您的其他问题](https://stackoverflow.com/questions/14549577/failure-to-pass-generic-arguments-with-castle-windsor)一样，依赖项的类型与`Arguemnts`公开的类型不同

# python - 在 Python3 中使用类作为占位符

> ID：14550790
> 
> 赞同：0
> 
> 时间：2013-01-27T18:40:27.213
> 
> 标签：python, class, placeholder, slots

我看过很多关于 python 类的教程，但我正在尝试用它们做一些更基本的事情，但不知何故它不能正常工作。

我试图通过将它们放入班级的占位符来制作 3 维点。

但是，当我尝试打印`make3Dpoint(x,y)`

我得到类似的东西`<__main__.point object at 0x02D8FA30>`。

当我尝试将此输出附加到列表时，我只会得到*nonetype*。

显然我是这方面的初学者，我不想采用任何高级方法来解决这个问题（而且我不允许参加这个课程）。我不想修改类本身。

反正有没有使这个输出可用？

```
class point():
    __slots__ = ('x','y','depth')

def calculate(x,y):
    z = x * y + 2 * x * y + 4
    return z

def make3Dpoint(x,y):
    z = calculate(x,y)
    point=point()
    point.x = x
    point.y = y
    point.depth = z
    return point 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:53:18.677

list`append`方法返回`None`，但元素被添加到列表中。

```
>>> a = [1, 2]
>>> print(a.append(3))
None
>>> a
[1, 2, 3] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:12:25.233

像这样构造你的代码：

```
def calculate(x,y):
    z = x * y + 2 * x * y + 4
    return z

class Point:
    __slots__ = ('x', 'y', 'depth')

    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.depth = calculate(x,y)

points = []
points.append( Point(2,3) )
print points 
```

# python - Python - 将整数分解为素数

> ID：14550794
> 
> 赞同：5
> 
> 时间：2013-01-27T18:40:59.900
> 
> 标签：python, prime-factoring

我写了一个整数分解函数，但是在弄乱了它之后，我意识到它有几个数字的问题......

```
>>> pFactors(99) # it does work for numbers with multiple of one prime factor
[3, 3, 11]
>>> pFactors(999) # however, sometimes, it doesn't
[3, 37] # the actual prime factorization of 999 is [3, 3, 3, 37]. 
>>> pFactors(88)
[2, 11]
>>> pFactors(888)
[2, 3, 37] 
```

我的代码有什么问题？

```
def pFactors(n):
   """Finds the prime factors of 'n'"""
   from primes import isPrime
   from math import sqrt
   pFact, limit, check, num = [], int(round(sqrt(n), 2)) + 1, 2, n
   if isPrime(n):
      return [n]
   for check in range(2, limit):
      if isPrime(check) and num % check == 0:
         pFact.append(check)
         num /= check
         if isPrime(num):
            pFact.append(num)
            break
   pFact = sorted(pFact)
   return pFact 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T19:05:24.177

像这样修改：

```
def pFactors(n): 
        """Finds the prime factors of 'n'""" 
        from math import sqrt 
        pFact, limit, check, num = [], int(sqrt(n)) + 1, 2, n 
        if n == 1: return [1] 
        for check in range(2, limit): 
             while num % check == 0: 
                pFact.append(check) 
                num /= check 
        if num > 1: 
          pFact.append(num) 
        return pFact 

for i in range(1,1000):
        print pFactors(i) 
```

尽管我喜欢您最初编写的代码，但有几点：

1.  您不需要 isPrime。原因是任何在限制范围内除以 num 的素数也将是除以 num 的任何复合的最小除数，因此当您除掉这些素数时，您将阻止它们组成的复合被发现为范围后面的除数，只剩下主要因素。

2.  您不需要对数组进行排序，它已经通过`check`升序排序。

3.  添加的while循环确保只要它们继续除num，就可以正确找到重复因子。

4.  您可以使用同余过滤掉小于限制的所有数字的 2/3 以检查为除数，您知道怎么做吗？

上面结果的最后几行是：

```
[11, 89]
[2, 2, 5, 7, 7]
[3, 3, 109]
[2, 491]
[983]
[2, 2, 2, 3, 41]
[5, 197]
[2, 17, 29]
[3, 7, 47]
[2, 2, 13, 19]
[23, 43]
[2, 3, 3, 5, 11]
[991]
[2, 2, 2, 2, 2, 31]
[3, 331]
[2, 7, 71]
[5, 199]
[2, 2, 3, 83]
[997]
[2, 499]
[3, 3, 3, 37] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:48:36.077

在 999 示例中，将其除以 3 后，结果 (333) 也可除以 3，即得到 111，您也可以除以 3（得到 37）。但是在您的代码中，您只需将其除一次 - 您需要做的是，一旦您找到一个除以您当前数字的素数，就是继续除以该数字，直到它不再可能。

# python - 如何在多行文本中查找关键字？

> ID：14550795
> 
> 赞同：0
> 
> 时间：2013-01-27T18:41:03.923
> 
> 标签：python, regex, beautifulsoup

我有一个从一些新闻门户网站接收新闻的应用程序，我想找到这个新闻的关键字并将它们保存在一个特殊的表格中，但我不知道如何找到这些关键字！

因为代码每 5 分钟运行一次，所以它使用了大量的服务器源，我希望没有繁重的代码！

我自己有一个老想法，按单词拆分文本并计算它们并获得前 5 个单词，但几乎总是关键字应该是“a”或“the”等

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:09:47.780

查看自然语言工具包 ( [NLTK](http://nltk.org/) )，包括免费提供的[书籍](http://nltk.org/book/)。这将使您入门，尽管这是一个开放式问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T21:03:14.653

[您可以从 Gutenberg 项目 ( http://www.gutenberg.org/files/29765/29765-8.txt](http://www.gutenberg.org/files/29765/29765-8.txt) )下载英语词典，例如 Webster's Unabridged Dictionary，并将其解析为代词和介词，并将结果用作列表在您的计数中要忽略的单词。

基于上述内容的快速而肮脏的解析实验提供了以下列表：

```
AMONGST         A               ABOON           AGAINST         AMID            
AT              ATAFTER         BATING          BEHITHER        BESIDE          
BESIDES         BETWIXT         DURANTE         DURING          EMFORTH         
FOREBY          FORENENST       FROM            HE              HERS            
HERSELF         HIMSELF         HIMSELVE        HIR             HIS             
HO              I               ICH             IDEM            IK              
INTO            INWITH          IT              ITSELF          MALGRE          
MYSELF          MYSELVEN        O'              OF              ONESELF         
ONTO            OURSELVES       OUTCEPT         OUTTAKE         PER             
REGARDING       RESPECTING      SENZA           SHE             SITH            
THAT            THEM            THEMSELVES      THESE           THILK           
THOSE           THRU            THURGH          THY             THYSELF         
UMBE            UNNEAR          UPON            UPTILL          US              
VERSUS          WE              WHATE'ER        WHATEVER        WHATSOEVER      
WHICH           WHO             WHOEVER         WHOM            WHOMSOEVER      
WHOSE           WHOSESOEVER     WHOSO           WHOSOEVER       WITHOUTEN       
YER             YMEL            YOU             YOURS           YOURSELF        
YOW 
```

如前所述，需要细化...

# php - mysql_ 到 mysqli_ 的转换问题

> ID：14550799
> 
> 赞同：1
> 
> 时间：2013-01-27T18:41:28.173
> 
> 标签：php, mysql, mysqli

我有一个小网站，我想切换到 mysqli_* 功能，在[阅读](https://wikis.oracle.com/display/mysql/Converting+to+MySQLi) [了很多](http://codular.com/php-mysqli)内容后，我决定通过替换所有来进行切换`mysql_`-`mysqli_`然后我检查并验证一切都正确更改...

现在，`mysqli_connect()`工作 - （我从它得到一个有效的资源连接）但在 PHP 脚本的更下方，我有一个`mysqli_query`函数，`NULL`无论我作为 SQL 输入什么，它都会返回。

有什么想法会发生什么吗？

相关代码：

```
function connecti_database() {
  mysqli_connect(DB_HOST, DB_USER, DB_PASS, DB_DATABASE);
}

connecti_database();
$sql = 'SELECT * FROM table where id = 5';
$result = mysqli_query($sql);
var_dump($result); // this returns NULL every time 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T18:44:18.343

mysqli 函数需要**两个**参数，而不是一个
......并且开发人员**需要首先阅读文档**。

```
function connecti_database() {
  global $mysqli;
  $mysqli = mysqli_connect(DB_HOST, DB_USER, DB_PASS, DB_DATABASE);
  mysqli_select_db($mysqli,DB_DATABASE);
}

connecti_database();
$sql = 'SELECT * FROM table where id = 5';
$result = mysqli_query($mysqli, $sql); 
```

PHP 手册： http: [//php.net/manual/en/mysqli.query.php](http://php.net/manual/en/mysqli.query.php)

```
mixed mysqli_query ( mysqli $link , string $query [, int $resultmode = MYSQLI_STORE_RESULT ] ) 
```

# haskell - 全新安装期间的 Snap 框架编译错误

> ID：14550800
> 
> 赞同：1
> 
> 时间：2013-01-27T18:41:31.003
> 
> 标签：haskell, haskell-snap-framework

第一次安装 Snap 时收到以下错误。我试过先安装抢劫但得到同样的错误。我正在使用 Ubuntu 12.04 32 位桌面（全新安装）和 ghc 7.4.1。

其他人得到这个错误吗？解决方案？谢谢。

```
[18 of 29] Compiling Snap.Snaplet.HeistNoClass ( src/Snap/Snaplet/HeistNoClass.hs, dist/build/Snap/Snaplet/HeistNoClass.o )

src/Snap/Snaplet/HeistNoClass.hs:195:32:
Couldn't match expected type `n0 (Either e'0 b0)'
            with actual type `Text'
Expected type: String -> n0 (Either e'0 b0)
  Actual type: String -> Text
In the first argument of `(.)', namely `T.pack'
In the first argument of `mapEitherT', namely
  `(T.pack . intercalate "")'
cabal: Error: some packages failed to install:
sample1-0.1 depends on snap-0.10.0.1 which failed to install.
snap-0.10.0.1 failed during the building phase. The exception was:
ExitFailure 1
snaplet-sqlite-simple-0.4.0 depends on snap-0.10.0.1 which failed to install. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:56:44.833

on的依赖[`errors`](http://hackage.haskell.org/package/errors)被[`either`](http://hackage.haskell.org/package/either)指定为`either >= 3.0.1`，并且`either`没有被列为构建依赖[`snap`](http://hackage.haskell.org/package/snap)（因为使用的模块`Control.Monad.Trans.Either`是从 重新导出的`Control.Error`，这不是必需的，即使`snap`直接使用来自 的代码`either`）。因此，构建`snap`会引入最新版本的`either`.

但是，在 中`either-3.1`，类型发生了`mapEitherT`变化。它曾经是

```
mapEitherT :: Functor m => (e -> f) -> (a -> b) -> EitherT e m a -> EitherT f m b 
```

中`either-3.0.*`，现在是

```
mapEitherT :: (m (Either e a) -> n (Either e' b)) -> EitherT e m a -> EitherT e' n b 
```

代码是为旧版本编写的。

您可以限制`either`要使用的版本，

```
cabal install snaplet-sqlite-simple --constraint="either < 3.1" 
```

建造它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T15:40:09.077

我将 snap 0.11 上传到 hackage，这也应该可以解决问题。

# git - “致命：错误修订”是什么意思？

> ID：14550802
> 
> 赞同：85
> 
> 时间：2013-01-27T18:41:40.680
> 
> 标签：git

在上下文中：

```
git revert HEAD~2 myFile
fatal: bad revision '/Users/rose/gitTest/myFile' 
```

我确定 HEAD~2 存在。

**编辑**琥珀是正确的。我的意思是使用`reset`而不是`revert`.

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-01-27T18:43:06.423

如果您只想将单个文件恢复到给定提交中的状态，您实际上想要使用以下`checkout`命令：

```
git checkout HEAD~2 myFile 
```

* * *

该`revert`命令用于恢复整个提交（它不会将您恢复*到*该提交；它实际上只是恢复该提交*所做*的更改- 如果您在指定的提交之后有另一个提交，则以后的提交将不会被恢复）。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-05-25T02:48:48.563

我在 IntelliJ 中遇到了这个错误，这些答案都没有帮助我。所以这就是我解决它的方法。

不知何故，我的一个子模块添加了一个`.git`目录。在我删除它后，所有 git 功能都返回了。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-27T18:43:16.107

`git revert`不带文件名参数。你想要`git checkout`吗？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-01-23T10:06:33.530

我对 Idea / Webstorm 有一个“致命：错误修订”，因为我在另一个目录中有一个 git 目录，而没有使用正确的子模块或子树。

我检查了`.git`目录：

```
find ./ -name '.git' -print 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-27T18:45:42.153

## Git revert 只接受提交

从文档：

> 给定一个或多个现有提交，还原相关补丁引入的更改...

`myFile`被解释为提交 - 因为`git revert`不接受文件路径；只提交

## 更改一个文件以匹配先前的提交

要更改一个文件以匹配先前的提交 - 使用`git checkout`

```
git checkout HEAD~2 myFile 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-20T16:16:38.930

我对 Intellij 有类似的问题。问题是有人将我试图在 Intellij 中比较的文件添加到 .gitignore，而实际上没有从 Git 中删除该文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-28T06:18:02.713

如果要删除任何提交，则可能需要使用 git rebase 命令

git rebase -i HEAD~2

它将向您显示最后 2 条提交消息，如果您删除提交消息并保存该文件，删除的提交将自动消失...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-27T18:44:23.023

你为什么要在`myFile`那里指定？

Git revert 恢复您指定的提交。

```
git revert HEAD~2 
```

恢复`HEAD~2`提交

```
git revert HEAD~2 myfile 
```

恢复`HEAD~2`和`myFile`

我拿`myFile`的是您要还原的文件吗？在这种情况下使用

`git checkout HEAD~2 -- myFile`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-10T11:52:16.960

在我的情况下，我有一个不一致的状态，其中有问题的文件（带有错误的提交哈希）实际上没有添加到 Git，这与 IntelliJ 的状态发生了某种冲突。在命令行上使用 git 手动添加文件为我解决了这个问题。

# javascript - 如何从 javascript 更改 XML 对象，而不仅仅是其值的副本？

> ID：14550810
> 
> 赞同：0
> 
> 时间：2013-01-27T18:42:29.647
> 
> 标签：javascript, xml, dom, reference

我有一些 XML `clientXML`，我想替换一个`<issue>`（包括嵌套在问题中的所有内容）。新`<issue>`的被称为`newXMLIssue`。我已经确定了要替换的问题

```
var oldXMLIssue = clientXML.querySelector("[XMLId=" + XMLIssueId + "]"); 
```

将其替换为

```
oldXMLIssue = newXMLIssue; 
```

但我相信这只是替换了对象的副本，因为

```
alert(oldXMLIssue.childNodes[2].textContent); 
```

输出新信息（我想要的东西），但是

```
alert(clientXML.querySelector("[XMLId=" + XMLIssueId + "]").childNodes[2].textContent); 
```

仍然只输出旧信息。（两个警报语句应输出相同）。

如何更改对象本身，而不仅仅是它的副本？

# xml - XML 验证错误：没有文档元素？

> ID：14550812
> 
> 赞同：0
> 
> 时间：2013-01-27T18:42:43.753
> 
> 标签：xml, validation, dtd

我不明白为什么 XML 文档中的这个 DTD 不会验证。它给我的错误是最后一行的“没有文档元素”。这很愚蠢，因为我可以删除除两行之外的所有代码，它仍然给我错误。我是 XML 的初学者，所以也许有更多经验的人来看看我？

```
<?xml version = "1.0" encoding="utf-8" standalone="yes"?>
<!DOCTYPE events [
<!ELEMENT events (event)+>
<!ELEMENT event (itenerary, description, icon?, leader+, coordinator+, maxpart, registeredpart, carpool?, difficulty, cost?, destination)>
<!ELEMENT itenerary (startdate, enddate, departuretime, location)>
<!ELEMENT contact (name,phone+)>
<!ELEMENT name (firstname, lastname)>
<!ELEMENT startdate (year, month, day)>
<!ELEMENT enddate (year, month, day)>
<!ELEMENT year (#PCDATA)>
<!ELEMENT month (#PCDATA)>
<!ELEMENT day (#PCDATA)>
<!ELEMENT departuretime (hours,minutes)>
<!ELEMENT hours (#PCDATA)>
<!ELEMENT minutes (#PCDATA)>
<!ELEMENT location (street,city)>
<!ELEMENT street (#PCDATA)>
<!ELEMENT city (#PCDATA)>
<!ELEMENT description (#PCDATA)>
<!ELEMENT icon (#PCDATA)>
<!ELEMENT leader (contact+)>
<!ELEMENT firstname (#PCDATA)>
<!ELEMENT lastname (#PCDATA)>
<!ELEMENT phone (landline?, cell?)> 
<!ELEMENT coordinator (contact)>
<!ELEMENT landline (#PCDATA)>
<!ELEMENT cell (#PCDATA)>
<!ELEMENT maxpart (#PCDATA)>
<!ELEMENT registeredpart (#PCDATA)>
<!ELEMENT carpool (#PCDATA)>
<!ELEMENT difficulty (#PCDATA)>
<!ELEMENT cost (#PCDATA)>
<!ELEMENT destination (location)> 
]> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:51:04.780

[W3C XML/HTML 标记验证](http://validator.w3.org/)服务只验证文档，而不是 DTD 本身。将有效文档附加到您的 DTD 以检查 DTD 和文档，[如下所示](http://validator.w3.org/check?uri=http%3A%2F%2Fphihag.de%2F2013%2Fso%2Fdtd-14550812.xml&charset=%28detect+automatically%29&doctype=Inline&group=0)：

```
<?xml version = "1.0" encoding="utf-8" standalone="yes"?>
<!DOCTYPE events [
<!ELEMENT events (event)+>
<!ELEMENT event (itenerary, description, icon?, leader+, coordinator+, maxpart, registeredpart, carpool?, difficulty, cost?, destination)>
<!ELEMENT itenerary (startdate, enddate, departuretime, location)>
<!ELEMENT contact (name,phone+)>
<!ELEMENT name (firstname, lastname)>
<!ELEMENT startdate (year, month, day)>
<!ELEMENT enddate (year, month, day)>
<!ELEMENT year (#PCDATA)>
<!ELEMENT month (#PCDATA)>
<!ELEMENT day (#PCDATA)>
<!ELEMENT departuretime (hours,minutes)>
<!ELEMENT hours (#PCDATA)>
<!ELEMENT minutes (#PCDATA)>
<!ELEMENT location (street,city)>
<!ELEMENT street (#PCDATA)>
<!ELEMENT city (#PCDATA)>
<!ELEMENT description (#PCDATA)>
<!ELEMENT icon (#PCDATA)>
<!ELEMENT leader (contact+)>
<!ELEMENT firstname (#PCDATA)>
<!ELEMENT lastname (#PCDATA)>
<!ELEMENT phone (landline?, cell?)> 
<!ELEMENT coordinator (contact)>
<!ELEMENT landline (#PCDATA)>
<!ELEMENT cell (#PCDATA)>
<!ELEMENT maxpart (#PCDATA)>
<!ELEMENT registeredpart (#PCDATA)>
<!ELEMENT carpool (#PCDATA)>
<!ELEMENT difficulty (#PCDATA)>
<!ELEMENT cost (#PCDATA)>
<!ELEMENT destination (location)> 
]>
<events>
  <event>
    <itenerary><!-- Did you mean itinerary ? -->
      <startdate><year>2013</year><month>1</month><day>1</day></startdate>
      <enddate><year>2013</year><month>1</month><day>2</day></enddate>
      <departuretime><hours>12</hours><minutes>01</minutes></departuretime>
      <location>
        <street>Kölner Straße</street>
        <city>Düsseldorf</city>
      </location>
    </itenerary>
    <description>A short trip</description>
    <leader>
      <contact><name><firstname>John</firstname><lastname>Smith</lastname></name><phone/></contact>
    </leader>
    <coordinator>
      <contact><name><firstname>Jane</firstname><lastname>Smith</lastname></name><phone/></contact>
    </coordinator>
    <maxpart>??</maxpart>
    <registeredpart>???</registeredpart>
    <difficulty>easy</difficulty>
    <destination>
      <location>
        <street>Aachener Straße</street>
        <city>Düsseldorf</city>
      </location>
    </destination>
  </event>
</events> 
```

# c++ - C++ 如何检查 std::ios 对象的真值？

> ID：14550813
> 
> 赞同：4
> 
> 时间：2013-01-27T18:42:45.217
> 
> 标签：c++, casting, boolean, iostream

当我运行代码时

```
istream s;
if (s)
  // ... 
```

我可以测试 istream（或任何 ios 对象）的真值。据我了解，这是因为 ios 定义`operator!`函数的方式。（供参考，[http://www.cplusplus.com/reference/ios/ios/operatornot/。](http://www.cplusplus.com/reference/ios/ios/operatornot/.)）我的问题是：为什么`s`像上面那样放入 if 语句会导致`operator!`函数被评估？作为第二个问题，如果我将任何对象放在 if 语句中，C++ 将使用哪些可能的方式来评估其真实性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T18:47:52.133

在 C++03 中，此检查是通过`operator void*`成员函数完成的，如果流处于良好状态，则返回非空指针，否则返回 NULL。由于空指针评估为假，非空指针评估为真，因此此检查工作正常。

但是，它确实存在问题，因为您可以这样做：

```
std::cout << std::cout; 
```

这将调用`operator void*`函数并打印出 0 或 的地址`cout`，具体取决于流是否良好。这不是一件好事，因为上面的代码似乎没有这样做。更糟糕的是，你可以做

```
delete std::cout; 
```

如果流不好，这会导致未定义的行为。

在 C++11 中，这已更改，因此流具有一个`explicit operator bool`成员函数，它允许将流显式转换为布尔值。这消除了上述问题，并且是支持 if 检查对象的首选方式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:46:33.883

模板`basic_ios`有一个`explicit operator bool`在这种情况下被调用的。在过去是这样`operator void*`，但这是有争议的，因为有些人担心有一天有人会写作`delete my_stream`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T18:46:43.437

`std::istream`有一个`operator bool()`在 if 语句中调用的重载。`operator!`也是一个成员函数，它检查流中是否发生错误，但在这种情况下不在 if 语句中使用。

# jquery - Bootstrap - 为什么我的 div 内容在浏览器调整大小时合并？

> ID：14550814
> 
> 赞同：0
> 
> 时间：2013-01-27T18:42:46.170
> 
> 标签：jquery, css, twitter-bootstrap

我正在使用 Twitter Bootstrap 进行网站布局。我将所有`row-fluid`行用于行，并且在求和时我的所有跨度都等于 12。但是我一直遇到 div 之间的内容“泄漏”而不是像流体网格示例中那样堆叠的问题。我`<HEAD>`按照建议包含在这个中。

```
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet"> 
```

例如：

```
<div class="row-fluid">
<div class="span8 offset1 categoryLabel" id="category"></div>
<div class="span1 sortby">ALPHABETIC</div>
<div class="span1 sortby">POPULARITY</div>
<div class="span1 sortby">DATE</div>
</div>                                              
<div class="row-fluid"> 
```

布局在较大的分辨率上很好。但是一旦我缩小浏览器的大小，“字母、流行度和日期”都会相互渗透，所以看起来像：“Alphularidate”。他们没有像预期的那样“堆叠”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:58:32.640

这是因为 span1 列对于您的列标题来说不够宽。请参阅此示例，其中我将文本缩小并为列着色[http://jsfiddle.net/panchroma/QKZzZ/](http://jsfiddle.net/panchroma/QKZzZ/)

```
body{
font-size:50%;
}
.span1, .span8{
background-color:#ccc;
} 
```

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:01:35.190

至少在您的问题中，您还没有定义一个容器 div 来包装您的行。容器 div 是 bootstrap 脚手架的关键部分，如果丢失，将导致各种奇怪的行为。

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span8 offset1 categoryLabel" id="category"></div>
    <div class="span1 sortby">ALPHABETIC</div>
    <div class="span1 sortby">POPULARITY</div>
    <div class="span1 sortby">DATE</div>
  </div><!-- end row -->
  <!-- more rows here -->
</div><!-- end container --> 
```

您可以检查或下载这个流畅的 Twitter Bootstrap 示例作为参考：http: [//twitter.github.com/bootstrap/examples/fluid.html](http://twitter.github.com/bootstrap/examples/fluid.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-27T21:49:05.430

将引导 cdn 链接更新到 2.2，它现在可以正常工作。

# couchdb - 在 couchbase 2.0.2 中，如何获取文档的所有版本

> ID：14550816
> 
> 赞同：2
> 
> 时间：2013-01-27T18:43:01.587
> 
> 标签：couchdb, couchbase

当我使用 Couchdb 时，文档可以有很多转数，我可以从 http api 获取所有转数

但是当我使用 Couchbase 时，我尝试使用：rev=1-000000000000000, revs=true, revs_info=true

它总是不显示任何previus rev

这是另一个要获取的参数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T11:14:20.277

我认为您正在混合 Couchbase 和 Couchdb 的功能。

Couchbase 有一个“rev”元数据，它是用于跨数据中心复制 (XDCR) 的内部属性。Couchbase 2.0 不存储文档的多个修订版本。您只有 1 个版本的文档。

这种修订的概念仅在 Couchdb 产品中使用。

# spotify - Libspotfiy，在同一个句柄上注册多个回调

> ID：14550829
> 
> 赞同：0
> 
> 时间：2013-01-27T18:44:10.057
> 
> 标签：spotify, libspotify

向 libspotify 句柄添加多个回调是否有效？IE：

IE

```
sp_playlist_callbacks pl_callbacks1 = {
.tracks_added = &tracks_addedA,
};

sp_playlist_callbacks pl_callbacks2 = {
.tracks_added = &tracks_addedB,
};

sp_playlist_add_callbacks(pl, &pl_callbacks1, NULL);
sp_playlist_add_callbacks(pl, &pl_callbacks2, NULL); 
```

那么，tracks_addedA 和tracks_addedB 会被libspotify 调用吗？这似乎有效，但我不知道它是偶然还是设计？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T21:17:23.893

是的，这很好 - 回调键在回调指针和用户数据上。我们使用的另一种方法是使用具有不同用户数据值的相同回调指针。

# python - 隐藏的命令窗口、STARTUPINFO 和全局名称“子进程”未定义

> ID：14550834
> 
> 赞同：0
> 
> 时间：2013-01-27T18:44:36.317
> 
> 标签：python, windows, command-line, import, subprocess

我一直致力于为命令行程序创建 GUI 前端，我在这里得到的所有帮助都令人惊叹。我永远无法感谢你们。

这是我一直在研究的一个测试程序，它在 Windows 中显示 .CAB 文件的内容：

```
#!python2.7

import sys
import os
from tkFileDialog import *
from subprocess import *
from Tkinter import *

def getfilename():
    blankline = 0 # counter to help remove blank lines
    filename = askopenfilename(filetypes=[("All files","*"), ("Cab files","*.cab")]) # get the filename
    if filename == "": # if the user hits the Cancel button, don't change anything in the list box
        return
    listbox.delete(0, END) # clear the list box
    numberinlist = 0 # count the number of lines in the list box to delete the extra blank line at the end of the list
    if os.name == 'nt': # send the command without opening a command window
        start_info = subprocess.STARTUPINFO()
        start_info.dwFlags |= subprocess._subprocess.STARTF_USESHOWWINDOW
    commandline = Popen(['expand', '-D', filename], shell=False, stdout=PIPE, stdin=PIPE, stderr=STDOUT, startupinfo=start_info)
    # commend the above 4 lines and uncomment the below line and the program works but opens a command window
    #commandline = Popen(['expand', '-D', filename], shell=False, stdout=PIPE, stdin=PIPE, stderr=STDOUT)
    while True: # read expand.exe's output and strip undeeded characters at the end of each line
        listboxline = commandline.stdout.readline().rstrip()
        listbox.insert(END, listboxline)
        numberinlist += 1
        if len(listboxline) ==0: # check for blank lines
            blankline += 1
            if blankline == 3: # expand.exe sends an extra three blank lines, see if it's the third blank line
                listbox.delete(numberinlist - 1) # if it is the third blank line remove the extra line at the end
                break # quit the while loop, expand.exe is finished after the third blank line

# set up the window    
mywindow = Tk()
mywindow.geometry('400x400')

# add a frame to position the list box in
frame1 = Frame(mywindow)
frame1.pack(fill=BOTH, expand=1)

# name the scroll bars
vertscrollbar = Scrollbar(frame1, orient=VERTICAL)
horzscrollbar = Scrollbar(frame1, orient=HORIZONTAL)

# name the list box and attach the scroll bars
listbox = Listbox(frame1, selectmode=EXTENDED, yscrollcommand=vertscrollbar.set, xscrollcommand=horzscrollbar.set)
vertscrollbar.config(command=listbox.yview)
horzscrollbar.config(command=listbox.xview)

# create the scroll bars and list box
vertscrollbar.pack(side=RIGHT, fill=Y)
horzscrollbar.pack(side=BOTTOM, fill=X)
listbox.pack(side=LEFT, fill=BOTH, expand=1)

# add another frame to position the button in
frame2 = Frame(mywindow)
frame2.pack(fill=X)

# create the button and tell it to go to the getfilename function when clicked
filebutton = Button(frame2, text="Open cab file", command=getfilename)
filebutton.pack()

# start the GUI
mywindow.mainloop() 
```

我添加了很多评论，所以如果有人正在寻找不同问题的答案，他们可能会在这个程序示例中找到答案。这个想法是将'expand.exe -D'的结果逐行显示到列表框中，而不弹出Windows，命令行，shell窗口，而是将其保留在后台。从第一行 (shebang) 可以看出，我使用的是 Python 2.7。我遇到的问题是我收到了错误：

```
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Python27\lib\lib-tk\Tkinter.py", line 1410, in __call__
    return self.func(*args)
  File "D:\Python\2.7\listcab.pyw", line 17, in getfilename
    start_info = subprocess.STARTUPINFO()
NameError: global name 'subprocess' is not defined 
```

我一直在搜索 stackoverflow 和 Google 以查找此错误，但我一直找不到任何东西。我确定这是我的导入列表的一个简单问题，但我不知道它是什么。我仍然没有完全理解 Python 的不同导入命令，使用哪些，何时使用它们以及它们之间的区别是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:48:06.520

由于您使用了星形导入...

```
from subprocess import * 
```

您不应该为从中导入的内容添加前缀：

```
subprocess.STARTUPINFO() 
```

其实应该只是...

```
STARTUPINFO() 
```

* * *

如果你想使用前缀，你只想做......

```
import subprocess 
```

它不是将所有名称从`subprocess`全局命名空间导入，而是导入`subprocess`自身，然后让您使用其名称和前缀。

然后你会使用像`subprocess.Popen()`, `subprocess.STARTUPINFO()`, 等等这样的东西。

这通常被认为是进行导入的首选方式；如果两个不同的模块具有类似命名的函数，它可以避免名称冲突，并使事物的来源更加清晰。

# javascript - Javascript对象属性值作为表达式不起作用

> ID：14550835
> 
> 赞同：-3
> 
> 时间：2013-01-27T18:44:38.480
> 
> 标签：javascript, jquery, undefined, expression

我是 JS 新手，我进行了一些调查，但找不到解决方案。如果它是重复的，请原谅我。

上下文：我有数千个对象，其中大多数具有相同的属性。在 javascript 中，我获取对象的所有属性并将它们格式化为在 html 中显示。由于某些对象没有所有属性，因此我得到未定义的值。为了解决这个问题，我写了这段代码：

```
var twitter = $.map(tweets, function(obj, index) {
                  return {                      
                     Format: ((typeof obj.VideographyFeatures.Format === "undefined") ? "N/A" : obj.VideographyFeatures.Format)
                  };
               }); 
```

但它不起作用。对于没有“VideographyFeatures”属性的对象，我仍然收到以下错误。

“未捕获的类型错误：无法读取未定义的属性‘格式’”。

我的目标是获得：

```
{
Format: "N/A"
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:46:17.987

如果`obj.VideographyFeatures`未定义，则无法将其`Format`属性传递给`typeof`表达式。

你需要检查`typeof obj.VideographyFeatures`。

# animation - 为什么 animateColor 在这里失败？

> ID：14550842
> 
> 赞同：0
> 
> 时间：2013-01-27T18:45:07.880
> 
> 标签：animation, colors, svg

*下面的代码片段是从 J Eisenberg 的SVG Essentials*的示例 11-9 中稍作修改而提取的。

```
<!DOCTYPE html>
<html>
  <head><title>title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     width="300" height="200" viewBox="0 0 300 200">
      <circle cx="60" cy="60" r="30"
       style="fill: #ff9; stroke: gray; stroke-width:10;">
        <animateColor attributeName="fill"
         begin="0.5s" dur="2s" from="#ff9" to="red" fill="freeze"/>
        <animateColor attributeName="stroke"
         begin="0.5s" dur="2s" from="gray" to="blue" fill="freeze"/>
      </circle>
    </svg>
  </body>
</html> 
```

代码的目的是呈现一个圆圈，其填充和描边颜色在 2 秒的时间间隔内从`#ff9`黄色和灰色 (resp.) 变为红色和蓝色 (resp.)。

当我使用 Firefox 访问此页面时，我确实看到了一个带有灰色轮廓的黄色圆圈，但颜色从未改变。

为了达到预期的效果

> *我必须如何更改上面的代码*？

* * *

PS：当然，艾森伯格的书很旧（2002 年），但是 AFAICT 的语法`animateColor`仍然是他所描述的。此外，FWIW、Firefox 正确显示了我在同一本书中尝试过的其他动画示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:47:27.010

[`<animateColor>`](http://www.w3.org/TR/SVG/animate.html#AnimateColorElement)在 SVG 规范中已弃用，不应使用。幸运的是，有一个简单的修复方法只需将其替换为`<animate>`

# c++ - 简单的 C++ 数学给出不正确的结果

> ID：14550844
> 
> 赞同：-2
> 
> 时间：2013-01-27T18:45:24.687
> 
> 标签：c++, math, expression, vst

我正在编写一个 VSTi 插件，我需要计算部分输出包络的系数。

基本上我收到的数学表达式的答案不正确，我已将其简化为几个步骤，但仍然不正确。相同的表达式适用于计算器，但不能翻译成代码。我一直在使用调试器并检查变量的内容，发现 0.25 / 88200 给出的结果是 2.8344671201814060e-006 而不是 0.00000283446712 应该是这样。代码中前面的类似数学运算符合预期。

```
currentDecCoeff = 0.25 / 88200;
is making currentDecCoeff = 2.8344671201814060e-006 (and not 0.00000283446712) 
```

所有相关变量都是双精度类型，我什至将其输入为数值（如上）而不是变量，它仍然给出错误的答案。

任何人都可以阐明为什么会发生这种情况，并提供一些关于尝试甚至解决方案的想法。

如果需要，我可以在上下文中添加代码。干杯

本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:47:30.987

它们对 9 位有效数字相同，请[查阅科学记数法](http://en.wikipedia.org/wiki/Scientific_notation)。

详细地说，科学记数法用于通过删除前导零或尾随零轻松显示非常小（或非常大）的数字。通常，它具有以下形式：

```
y x 10^z 
```

要获得值，请求解总和。C 显示为：

```
yEz 
```

因此，2.4x10^6（或 2.4E6）是 2400000。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:48:11.237

该符号`e-006`意味着将我剩下的乘以 10^(-6)。所以确实你的结果是正确的。

# c# - 手动更改禁用 ListViewItem 的样式

> ID：14550848
> 
> 赞同：0
> 
> 时间：2013-01-27T18:46:15.607
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

我的`ListView`Metro 应用程序中有一个灰色的禁用项目。我想将这些项目的样式更改为启用项目的默认样式，但仍然需要禁用这些项目。我认为如果我只需要以某种方式跳过禁用项目的灰色并且我不知道该怎么做，它会产生相同的效果，所以请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T06:01:06.773

您需要修改`ListViewItem`. 最简单的方法是在设计器中右键单击 a`ListViewItem`并选择`Edit Template`> `Edit a Copy...`：

![在此处输入图像描述](../Images/281eee2edcc0d9226d93595ed5853ca0.png)

下一步是命名新样式并选择应放置的位置：

![在此处输入图像描述](../Images/ae8ac61aca86c3c102bfeb2460bd8b20.png)

在样式中找到以下块：

```
<VisualState x:Name="Disabled">
    <Storyboard>
        <DoubleAnimation Duration="0" To="{StaticResource ListViewItemDisabledThemeOpacity}" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="contentPresenter"/>
    </Storyboard>
</VisualState> 
```

您可以将其删除或注释掉，以防止项目变灰。当然，你也可以`Disabled`以任何你想要的方式改变视觉状态的风格。

# c++ - char 之前的 C++ 预期主表达式（头文件）

> ID：14550850
> 
> 赞同：0
> 
> 时间：2013-01-27T18:46:23.293
> 
> 标签：c++

国际标准书号

```
int isValid(const char str[]);
int isRegistered(FILE* fp, const char str[], char area[], char publisher[], char title[]); 
```

错误：

```
ISBN.h:2:18: error: FILE was not declared in this scope
ISBN.h:2:24: error: fp was not declared in this scope
ISBN.h:2:28: error: expected primary-expression before const
ISBN.h:2:46: error: expected primary-expression before char
ISBN.h:2:59: error: expected primary-expression before char
ISBN.h:2:77: error: expected primary-expression before char
ISBN.h:2:89: error: expression list treated as compound expression in initializer [-fpermissive] 
```

不确定我是否理解错误，因为我有另一个具有相同类型参数的头文件，不会产生任何错误：

ISBN前缀.h

```
FILE* open(const char filename[]);
int isRegistered(FILE* fp, int area);
int minNoDigits(FILE* fp, int area);
int isRegistered(FILE* fp, int area, const char publisher[]);
int close(FILE* fp); 
```

1.  这些函数原型是我们的教授给我们的。
2.  `isRegistered`被定义了3次，但参数数量不同，所以当你使用`main`带有X个参数的函数时，它会只使用带有所述参数的相应版本吗？
3.  我得到与 my 对应的第二组错误，`ISBN.cpp`其中包括 my `ISBN.h`：

    ISBN.cpp: 在函数 int isRegistered(FILE*, const char*, char*, char*, char*): ISBN.cpp:36:89: 错误: int isRegistered(FILE*, const char*, char*, char *, char*) 重新声明为不同类型的符号 ISBN.h:2:5: 错误：int isRegistered 的先前声明

国际标准书号.cpp

```
#include "ISBN.h"
#include <cstring>
#include <iostream>
#include <cstdio>
using namespace std;

int isValid(const char str[])
{

}

int isRegistered(FILE* fp, const char str[], char area[], char publisher[], char title[])
{

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:56:00.247

`FILE`是标题的一部分，`<cstdio>`在您开始在标题中使用它之前不包含它。这就像你必须如何`#include <iostream>`使用`std::cout`. 您通常应该在每个文件的基础上包含您需要的每个标题，而不是依赖其他文件为您包含它们。

要注意的另一件事是，您通常应该先处理列出的第一个错误。一个错误可能会导致无意义错误的连锁反应，最终很容易让你偏离正轨。

# iphone - Iphone 不会在图像标签中显示 svg 图像

> ID：14550851
> 
> 赞同：0
> 
> 时间：2013-01-27T18:46:23.507
> 
> 标签：iphone, svg, image

我正在尝试使用 img 标签获取图像格式的 svg 以在 iphone 上显示。在所有现代浏览器中都很好，当我将浏览器大小缩小到移动视图时，可以在浏览器中调整大小。

问题是它不会在 iphone 上显示。我尝试使用嵌入标签，图像确实显示，但不会拾取 css 进行响应式调整大小。

这是我尝试的两种方法。

```
<img src="img/bg1.svg" />

<embed src="img/bg1.svg" type="image/svg+xml" /> 
```

我在 illustrator 中构建并保存了图像，并使用 svg tiny 1.1 设置保存了它，该设置据说适用于移动设备。

关于为什么这不起作用的任何想法？或者为所有移动设备显示 svg 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T04:07:17.903

我相信您可以使用`<iframe>`指向 SVG 文件的链接来嵌入图像。

# git - Git Azure 部署缺少内容目录中的文件（MVC4 项目）

> ID：14550859
> 
> 赞同：15
> 
> 时间：2013-01-27T18:47:12.783
> 
> 标签：git, azure

我一直在从本地 git 存储库推送到 azure，没有任何问题。

但是，由于添加了一些静态内容（一些 png 文件）并将它们推送到 azure，我注意到它们没有被推送到 azure 上的 wwwroot 目录。

这些文件正在被 git 跟踪并登陆 azure 服务器上的 git repo。我能够通过 ftp 连接和浏览文件夹来验证这一点。

但是，如果我通过 ftp 浏览到 wwwroot 目录，我可以看到我的新文件没有被复制到这个目录。

注意：我有两个很好的屏幕截图，显示了一个目录中的文件，但没有显示另一个目录中的文件，但不幸的是，由于我是新用户，因此无法在此处发布图像。

所以要确认：

*   我在 /Content/images 中添加了一个新文件 - test.png
*   git 正在跟踪 test.png。
*   test.png 已到达 azure 服务器，我可以在 ftping 到 /repository/ProjectName/Content/images 目录时看到它
*   test.png 没有被复制到 wwwroot/Content/images 目录中，因此没有出现在我的 azure 网站上

这些 ime 的构建操作与出现在 wwwroot 目录中的其他图像相同（内容，请勿复制）。

推送到 azure 时，如何将新的静态资源复制到 wwwroot 目录中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-27T20:49:44.920

此问题的最常见原因是项目中的文件未正确标记为内容，导致它们无法部署。在这种情况下，您会在通过 WebDeploy 部署时看到相同的行为。

如果你看到这种行为并且你的文件被正确地标记为内容，那么我很想看到一个 repro，最好是 github repo 的形式，我可以尝试将自己推送到 Azure。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-01T12:11:46.557

在提交到 git 之前构建解决方案来修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-07T11:54:37.197

有一个类似的问题，git 正在获取添加的图像，但是当我部署到服务器时，图像没有通过并且出现错误

> 您要查找的资源已被删除、名称已更改或暂时不可用

或者基本上是**404 错误**。

对我来说，问题是**project.csproj**文件没有将图像作为资源的引用。因此，我在 Notepad++ 中编辑了我的 project.csproj，或者您可以在任何其他编辑器中进行编辑，并在 ItemGroup 下添加以下内容 -

```
<ItemGroup>
  <Content Include="Content\images\test.png" />
</ItemGroup> 
```

确保您使用的是**\（反斜杠）**而不是 **/（正斜杠）**

PS：这可能不是最好的解决方案，但工作正常。

# sqlite - MonoTouch：SQLIte.net 发送多个参数

> ID：14550862
> 
> 赞同：1
> 
> 时间：2013-01-27T18:47:30.563
> 
> 标签：sqlite, xamarin.ios

我正在使用 Monotouch ( [https://github.com/praeclarum/sqlite-net](https://github.com/praeclarum/sqlite-net) )的 SQLite ORM

我正在尝试发送多个参数，但未添加作为字符串的参数：

```
var items = db.Query<NameListItem>
        (Select * from table where field=? and field2=?,"SomeString",123); 
```

当我启用跟踪时，它会正确显示查询：

```
Select * from table where field=? and field2=?
0: SomeString
1: 123 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:58:00.353

你确定表名真的是“表”吗？使用 SQLite-net，表的名称通常是您要存储的数据结构的名称。

例如，您的查询应该如下所示：

```
var items = db.Query<NameListItem> ("select * from NameListItem where field = ? and field2 = ?", "SomeString", 123); 
```

# php - preg_replace：试图理解将标题作为 url 的 slug

> ID：14550870
> 
> 赞同：1
> 
> 时间：2013-01-27T18:48:05.380
> 
> 标签：php, preg-replace

嗨，第一次处理 preg_replace，发现特别难理解的学习者。

尝试将标题字符串更改为 slug 以用于 url 结构，其中删除所有特殊字符`( ) ? *`，如将多个空格替换为单个空格`-`，并将所有文本转换为小写。

这是我有趣的代码，但没有得到期望的输出。

```
$title_slug = $q_slug->title;
$title_slug = preg_replace("/[\s+\?]/", " ", $title_slug);        
$title_slug = str_replace("  ", " ", $title_slug);
$title_slug = str_replace(" ", "-", $title_slug);
$title_slug = preg_replace("/[^\w^\_]/"," ",$title_slug);
$title_slug = preg_replace("/\s+/", "-", $title_slug);
$title_slug = strtolower($title_slug);

return $title_slug; 
```

编辑：添加示例

示例：`if my title is what is * the() wonder_ful not good?? and where???` 结果：`if-my-title-is-what-is-the-wonder_ful-not-good-and-where`

随意大笑:)并感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T18:53:02.090

Check out [this tutorial](http://cubiq.org/the-perfect-php-clean-url-generator) for a clean URL generator, or even use [this existing SO solution](https://stackoverflow.com/a/2955878/427992) which eschews regular expressions altogether. This will probably get the job done:

```
function toAscii($str) {
   $clean = iconv('UTF-8', 'ASCII//TRANSLIT', $str);
   $clean = preg_replace("/[^a-zA-Z0-9\/_| -]/", '', $clean);
   $clean = strtolower(trim($clean, '-'));
   return preg_replace("/[\/_| -]+/", '-', $clean);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T18:51:27.853

这是[一个很好的功能](http://forum.codecall.net/topic/59486-php-create-seo-friendly-url-titles-slugs/#axzz2JCfcCHFX)：

```
function toSlug ($string) {
        $string = strtolower($string);
        // Strip any unwanted characters
        $string = preg_replace("/[^a-z0-9_\s-]/", "", $string);
        // Clean multiple dashes or whitespaces
        $string = preg_replace("/[\s-]+/", " ", $string);
        // Convert whitespaces and underscore to dash
        $string = preg_replace("/[\s_]/", "-", $string);

        return $string;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T18:53:48.160

Try this:

```
$string = strtolower($string);
$string = preg_replace("/\W+/", "-", $string); // \W = any "non-word" character
$string = trim($string, "-"); 
```

# javascript - 检索最终 URL phonegap 下载

> ID：14550879
> 
> 赞同：1
> 
> 时间：2013-01-27T18:48:46.563
> 
> 标签：javascript, url, cordova, download

我正在实现 HTML 页面的离线缓存，支持最少的图片和 css。

我使用 phonegap API 检索文件然后解析它。我正在检索 CSS 和图片链接，使用 BuildUrlCss 函数构建请求（处理根、相对和绝对 URL）：

```
 fileTransfer.download(
   uri,
   Path,
   function(entry) {
      alert("download complete: " + entry.fullPath);

      entry.file(function(file){
        var reader = new FileReader();
        reader.onloadend = function(evt) {
             // Retrieve CSS file linked in article
             var cssRegExp = /<link.*?href=(?:"|)(.*\.css).*?>/g;
             while (cssFile = cssRegExp.exec(evt.target.result)) {
                  alert(BuildUrlCss(cssFile[1], Url));
              }
            reader.readAsText(file);
      });
   },
   function(error) {
      alert("download error source " + error.source);
      alert("download error target " + error.target);
   }
 ) 
```

只要传递的 URL 中没有 http 重定向，这就可以正常工作。

我想知道是否有任何方法可以在成功函数中检索 phonegap API 使用的“最终”Url（因为 phonegap API 支持 http 重定向并下载指向的 Url），例如，或者使用任何其他 javascript 函数或库？

非常感谢你的帮助。这个问题快把我逼疯了...

问候。

弗洛朗

#

这是一个更新，我尝试了 wget 并在 Firebug 中检查了我的 url，并注意到 wget/browser 收到了 302 响应，给出了最终 URL。

这是我想在 javascript 中获得的最终 url。

# javascript - SerialPort 没有方法“列表”

> ID：14550880
> 
> 赞同：4
> 
> 时间：2013-01-27T18:49:02.213
> 
> 标签：javascript, node.js, serial-port, node-serialport

我有一个非常简单的脚本，仅用于可用的串行端口，然后连接到一个，编写一个字符并将响应放在控制台上。[代码在这里](http://pastebin.com/bDZG4cMe)

在我的脚本目录中，我做了：

```
#npm install serialport
#npm list
 /home/uminded/Programming/nodeJS/test
 └─┬ serialport@1.0.8
   ├── async@0.1.18
     etc...
#node test.js
   spits out entire serialport.js to command line then...
 has no method 'list'
 at Object.<anonymous> (/home/uminded/Programming/nodeJS/test/test.js:4:12)
 at Module._compile (module.js:449:26)
 at Object.Module._extensions..js (module.js:467:10)
 at Module.load (module.js:356:32)
 at Function.Module._load (module.js:312:12)
 at Module.runMain (module.js:492:10)
 at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
```

serialport.js 脚本确实有 SerialPort.list 的导出，为什么找不到它？

另外你们用什么程序来编写和调试节点相关的js？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-27T18:53:20.143

`list`是[模块的](https://github.com/voodootikigod/node-serialport/blob/master/serialport.js#L292)[属性`serialport`](https://github.com/voodootikigod/node-serialport/blob/master/serialport.js#L292)，而不是`serialport.SerialPort`. 像这样替换第一行：

```
var serialport = require("serialport");
var SerialPort = serialport.SerialPort;
var util = require("util"), repl = require("repl");

serialport.list(function (err, ports) {
  ports.forEach(function(port) {
    console.log(port.comName);
    console.log(port.pnpId);
    console.log(port.manufacturer);
  });
}); 
```

# python - mysql为数组中的每个值选择数据

> ID：14550883
> 
> 赞同：0
> 
> 时间：2013-01-27T18:49:21.607
> 
> 标签：python, mysql, django

我有一个清单：

`destinations = test_task.destination_list()`- 这是一个字符串列表，包含分配给当前 test_task 对象的国家名称。

我有一个带有字段的表**CDR ：**

```
id(pk)
number(charfield)
area(charfield). 
```

我需要从 CDR 表中选择 3 个随机数，其中每个目的地的 area=destination。

我可以只使用一个选择吗？还是我需要为每个目的地制作一个循环？哪个是正确的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:00:49.707

正如我在评论中提到的，我认为没有可行的方法可以通过单个查询来做到这一点。如果您使用循环，您可以将[随机排序](http://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by-fields)、[values_list](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values-list)和“ [in](https://docs.djangoproject.com/en/dev/ref/models/querysets/#in) ”运算符组合用于查询集。

```
final_list = []
for destination in destinations:
    final_list += YourCDRModel.objects.filter(area__in=destination).values_list('number', flat=True).order_by('?')[0:3] 
```

请注意，如 *order_by* 文档中所述，此查询可能很慢，如果目的地数量很多，可能会变得更慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T19:05:40.877

最简单的方法是确保每个目标按 rand() 排序并限制为 3 进行循环和查询。如果您不想这样做并且想要执行单个查询，mysql 无法返回 3使用单个查询的每行结果。您有义务要求全额退货，并将减少结果数量的逻辑放入我们的代码中。您可以运行诸如“SELECT * FROM CDR WHERE IN (? ,? ...) ORDER BY RAND() 之类的查询，然后循环进入结果，直到每种类型有 3 行。

如果您的目的地数组不是太大，我建议循环进入目的地并查询每个目的地，而不是选择所有可能的结果并使用代码循环进入它。

# java - 在获取单词数的同时显示单词搜索的可能性

> ID：14550884
> 
> 赞同：0
> 
> 时间：2013-01-27T18:49:23.147
> 
> 标签：java, search, word, wordsearch

我这里有这个代码，它是单词搜索游戏的一部分。我试图让它在用户退出或时间结束时显示网格中存在的所有单词。那，到目前为止我已经实现了。我的问题是我还想显示存在的单词数量，所以是一个数字。我怎样才能让它在顶部显示“有（单词数）当前单词”，然后是它下面的单词。

```
try {
                            FileInputStream fstream = new FileInputStream("allWordsEn.txt");
                            DataInputStream in = new DataInputStream(fstream);
                            BufferedReader br = new BufferedReader(new InputStreamReader(in));
                            String strLine;
                            int presentWords = 0;
                            System.out.println("There were " + presentWords + " present words. They are:");
                            //Read File Line By Line
                            while ((strLine = br.readLine()) != null)   
                            {
                              if(canFind(strLine, t40)) 
                              {
                                presentWords++;
                                System.out.print(strLine + " ");
                              }
                            }
                            //Close the input stream
                            in.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T18:56:55.463

使用[String Builder](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)来构建您的单词列表，如下所示：

```
 //Before the loop
    StringBuilder s = new StringBuilder();
    //inside the loop
    s.append(strLine + " ");
    //after the loop
    System.out.println("There were " + presentWords + " present words. They are:" + s.toString()); 
```

# c - scanf的异常行为

> ID：14550888
> 
> 赞同：0
> 
> 时间：2013-01-27T18:50:10.810
> 
> 标签：c, scanf

我正在使用 GCC 编译器。在我的程序中，我使用了 3`scanf`秒，但在执行时只执行了 2`scanf`秒。为什么跳过 1 `scanf`？它只执行 else 条件。

```
#include <stdio.h>
int main()
{
    int h, c, t;
    printf("tensile");
    scanf("%d", &h);
    printf("tensile1");
    scanf("%d", &c);
    printf("tensile2");
    scanf("%d", &t);
    if( h > 50 && c > 0.7 && t > 5600)
        printf("HI");
    else
        printf("bye");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T20:57:26.900

您将其定义`c`为 an`int`并将其与`0.7`. 即使忽略任何`scanf`问题，这也没有多大意义。为每个变量确定它应该只包含整数还是（可能是小数）实数。对于整数，您可能需要`int`. 对于实数，您可能需要`double`. 然后您需要使用正确的格式`scanf`，具体取决于变量的类型。阅读您的`scanf`文档以了解详细信息。

使用该`"%d"`格式，`scanf`将读取单个整数（在跳过任何空格，包括换行符之后），然后停止。如果输入是`"12.34"`，它将读取`"12"`，存储`12`在变量中，并将 留`".34"`在输入流中。当他们看到角色时，以后调用`scanf`with将失败。使用其中一种浮点格式来读取类型变量并允许输入，例如.`"%d"``'.'``double``"12.34"`

`scanf`返回一个结果，表明它成功读取了多少项目，或者一个错误指示。您应该测试该结果，以便您的程序能够检测到错误，而不是盲目地继续使用错误数据运行。

*准确地*向我们展示（即复制和粘贴）您为程序提供的输入将使您更容易回答您的问题。

打印变量的值和返回的结果`scanf`将有助于*您*了解正在发生的事情——或者您可以在调试器中检查值（如果可用）。

一些需要注意的事情：`scanf`将报告输入语法错误的失败（例如，如果它正在寻找一个实数并且您输入`"foobar"`），但它不一定会诊断溢出。如果您输入`1.0e99999999`浮点输入，则行为是*undefined*。避免该问题的唯一真正方法是避免使用`scanf`数字输入。`*scanf`（恕我直言，这是 C 标准定义函数的方式中的一个缺陷。）

众所周知，浮点比较不可靠。If`c`是一个浮点变量，`c > 0.7`可以为真或假，因为该值`0.7`不能以二进制浮点精确表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:53:32.403

将变量 c 的数据类型更改为 float 并使用 %f 作为格式说明符。它正在跳过，因为您正在为整数变量提供浮点值

# ios - 通过导入图像更改 UIWindow 的背景？

> ID：14550892
> 
> 赞同：0
> 
> 时间：2013-01-27T18:50:36.540
> 
> 标签：ios, uiview

我正在使用这个可用的示例代码来创建一个简单的应用程序......我唯一需要做的就是将背景更改为我计算机上的图像。我使用的示例代码可[在此处](http://developer.apple.com/library/ios/#samplecode/GLPaint/Introduction/Intro.html)获得。我不知道在哪里以及如何实现可用于设置背景图像的代码（如下所示）。如果有人可以就如何将下面的代码合并到我正在使用的示例代码中提供一些建议，我将不胜感激。

我正在尝试将此代码实现到上面提供的应用程序代码中：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    UIColor *background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"BrainBrain.png"]];
    self.window.backgroundColor = background;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T19:03:43.773

只需放置这两行

```
UIColor *background = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"BrainBrain.png"]];
self.window.backgroundColor = background; 
```

进入`application:didFinishLaunchingWithOptions:launchOptions:`你的方法`AppDelegate`

# c++ - 创建对象后设置指向 const 对象的指针

> ID：14550893
> 
> 赞同：-3
> 
> 时间：2013-01-27T18:50:41.890
> 
> 标签：c++, pointers, constants

```
class a
{
    const std::string * ptr;
    void setPtr(const std::string & text)
    {
       ptr = &text; //it's wrong, I can set something to the pointer only at definition
    }
} 
```

解决方案是什么？指向我的对象的指针必须是 const（a 类的对象不能修改它），但我需要在运行时更改指针（它指向的内容）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:52:29.130

你可以用你当前的代码做到这一点。这条线

```
const std::string * ptr; 
```

mean`ptr`是指向 a 的指针`const std::string`。`ptr`本身不是恒定的，因此您可以更改它所指向的内容。

看到[这个工作演示](http://ideone.com/7c2nSM)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T21:01:51.627

您要么`const`在示例中遗漏了 a ：

```
void setPtr(const std::string & text) const 
```

或者你在打电话`setPtr`，`const`

```
const a* foo = something;
foo->setPtr(somestring); 
```

基本上有三个规则：

您不能通过成员函数修改非常量`a`实例`const`。
您不能通过指针或对它`a`的引用来修改非常量实例。 您不能修改实例。`const`
`const` `a`

# data-binding - 将项目添加到 ListView 会引发 Catastrophic Failure 异常

> ID：14550898
> 
> 赞同：1
> 
> 时间：2013-01-27T18:51:26.840
> 
> 标签：data-binding, windows-8, windows-runtime

我有这个列表视图和一个按钮：

```
<ListView x:Name="MyList" ItemsSource="{Binding}" Grid.Row="1"></ListView>
<Button x:Name="Add" Content="Add Item" Click="Add_Click" Grid.Row="2" /> 
```

我初始化一个字符串列表并将其分配给 ListView：

```
List<string> names;

private void FillListView()
{
    names = new List<string>();
    names.Add("Foo");
    MyList.DataContext = names;
}

private void Add_Click(object sender, RoutedEventArgs e)
{
    MyList.Items.Add("Bar");
} 
```

还有一个处理程序可以向 ListView 添加一个字符串，但是当我单击按钮时，我得到了**Catastrophic failure (Exception from HRESULT: 0x8000FFFF (E_UNEXPECTED))**。

我也尝试将新字符串直接添加到集合中，如下所示：

```
private void Add_Click(object sender, RoutedEventArgs e)
{
    names.Add("Bar");
} 
```

在这种情况下， ListView 没有更新，当我触摸它时，我得到**Value does not fall in the exception range 0x80070057**。

如何将集合绑定到 ListView，然后添加更多项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:08:19.827

通过您的 ViewModel 进行添加，而不是在 ListView 本身上添加，因此您的代码已死在：

```
private void Add_Click(object sender, RoutedEventArgs e)
{
    names.Add("Bar");
} 
```

您只需要将类型`names`从 List 更改为[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx?cs-save-lang=1&cs-lang=csharp)以便在添加/删除项目时通知绑定引擎并将更改反映在 UI 中。

```
 ObservableCollection<string> names;

    private void FillListView()
    {
        names = new ObservableCollection<string>();
        names.Add("Foo");
        MyList.DataContext = names;
    } 
```

# ruby-on-rails-3 - 带有 OAuth2 的 Twitter gem 示例应用程序

> ID：14550900
> 
> 赞同：2
> 
> 时间：2013-01-27T18:51:28.617
> 
> 标签：ruby-on-rails-3, twitter, oauth-2.0, twitter-gem

我正在尝试让我的应用程序与 twitter gem 一起使用，但我似乎无法使用 OAuth2 执行授权协议。我想知道是否有可用的示例应用程序，这样我就可以看到我做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:00:04.183

我不知道您使用的是什么身份验证引擎，但这里有一些omniauth + devise gem 的示例。

[https://github.com/holden/devise-omniauth-example](https://github.com/holden/devise-omniauth-example)

[https://github.com/bradrobertson/devise-omniauth-example](https://github.com/bradrobertson/devise-omniauth-example)

[https://github.com/plataformatec/devise/wiki/Example-Applications](https://github.com/plataformatec/devise/wiki/Example-Applications)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T03:36:06.390

我维护了一个示例应用程序，该应用程序演示了如何使用 twitter gem 和 OmniAuth 使用“使用 Twitter 登录”工作流程。你应该能够通过查看它来弄清楚它。

[https://github.com/sferik/sign-in-with-twitter](https://github.com/sferik/sign-in-with-twitter)

# java - 图像处理java

> ID：14550909
> 
> 赞同：0
> 
> 时间：2013-01-27T18:52:16.883
> 
> 标签：java, matlab, image-processing, javacv

我是一个完整的java初学者。在我最后一年的项目中，我必须做一些与实时图像处理相关的事情。我现在正在做的是尝试在 JavaCv 的帮助下将 Matlab 程序转换为 Java。我将无法真正处理 3-D 矩阵。这里有3个问题。

1.  **从 RGB 3-D 图像中获取红色分量**：Matlab 代码：`Red=I(:,:,1);`Java 代码：`cvInRangeS(imgRGB, cvScalar(0, 0, 0, 0), cvScalar(255, 0, 0, 0), imgR);`我可以在 java 中这样做吗？

2.  **在一维矩阵中，如何将以下代码转换为java？**Matlab 代码：`imgB(find(imgA~=0))=255;`Matlab 代码的意思是，为 imgA`int`中的每个非零像素输入 255。`imgB`

3.  **我可以从一维`IplImage`类型图像中提取一些坐标吗？**如果是，该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:28:17.483

> 1 - 从 RGB 3-D 图像 Matlab 代码中获取 R：Red=I(:,:,1); Java代码：cvInRangeS(imgRGB, cvScalar(0, 0, 0, 0), cvScalar(255, 0, 0, 0), imgR); 我可以在java中这样做吗？

如果你想从图像中得到**红色**，你可以试试这个：

```
 BufferedImage image = ImageIO.read(new File("////////image path"));
    for (int i = 0; i < image.getWidth(); i++) {
        for (int j = 0; j < image.getHeight(); j++) {
            Color c = new Color(image.getRGB(i, j));
            int red = c.getRed();//////////here you get the Red color , you can make it array 2D 
            System.out.println(red);
        }
    } 
```

> 2-在一维矩阵中，如何将以下代码转换为java？Matlab代码：imgB(find(imgA~=0))=255; Matlab 代码的意思是，对于来自 imgA 的每个非零像素，在 imgB 中放置一个 int 255。

你可以这样做

```
 for (int i = 0; i < imgA.getWidth(); i++) {
        for (int j = 0; j < imgA.getHeight(); j++) {
            if (Color.BLACK.getRGB() != imgA.getRGB(i, j)) {
                imgB.setRGB(i, j, 255);
            }
        } 
```

注意：使用[BufferedImage](http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html)定义图像

# c - 锁定 api 的正确约定是什么？

> ID：14550910
> 
> 赞同：1
> 
> 时间：2013-01-27T18:52:18.687
> 
> 标签：c, multithreading

问题是关于编码风格。如何创建面向外部但能很好地处理锁定的功能。

```
void Timer_start(Timer *t){ //this is a user facing function
    if (t->state == Timer_paused){ 
        Timer_resume(t);               
    } else {
        Timer_initialize(t);
    }
}

void Timer_resume(Timer *t){ //this is also a user facing function
    Lock_acquire(t->lock);
    //...do work 
    Lock_release(t->lock);
}

void Timer_initialize(Timer *t){ //and so is this
    //...do work (just to illustrate the the functions arent necessarily simply wrapped with the locking functions)
    Lock_acquire(t->lock);
    //...do work 
    Lock_release(t->lock);
} 
```

在示例中，`Timer_start`应该像其他两个函数一样包裹在`Lock_acquire`其中，`Lock_release`因为在状态检查后可能会立即被中断。问题是我无法将函数包装在正确的锁定函数中，因为被调用的函数本身会获取锁定。是否有一种编码风格可以很好地处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:05:09.353

为什么没有本地（静态）函数来执行 _resume 和 _init 的胆量，然后所有面向外部的函数都只有锁定并调用内部函数。

```
static void Timer_resume_impl(Timer *t) {
   do work
}
static void Timer_initialize_impl(Timer *t) {
   do work
}

void Timer_start(Timer *t) {
   Lock_acquire(t->lock);
   if (t->state == Timer_paused) {
      Timer_resume_impl(t);
   }
   else {
      Timer_initialize_impl(t);
   } 
   Lock_release(t->lock);
}
void Timer_resume(Timer *t) {
   Lock_acquire(t->lock);
   Timer_resume_impl(t);
   Lock_release(t->lock);
}
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:11:23.583

您可以实现`Timer_resume_unlocked` and `Timer_start_unlocked`，这将要求调用者负责锁定。然后制作`Timer_resume`并`Timer_start`成为一个包装器，除了锁定和调用它们的对应物之外什么都不做`_unlocked`。

是否将`_unlocked`变体作为公共 API 的一部分由您自己决定，但通常，用户最终比您希望的更可能需要它们。

如果可以在 API 的调用者一方正确实施，另一种选择是将适当的锁定留给 API 的调用*者*。通常可以向不使用锁的库添加一个愚蠢的“锁定所有内容”安全层，但是当它被证明是多余的时，不可能从库的内部*删除锁定。*

或者你可以使用递归锁定（有[很好](http://www.zaval.org/resources/library/butenhof1.html)的反对它的论据，但它仍然是一种可能性）。

# c# - 运行时错误，即使有错误处理

> ID：14550911
> 
> 赞同：0
> 
> 时间：2013-01-27T18:52:19.343
> 
> 标签：c#, exception-handling, asp.net-mvc-4

我已经按照以下教程使用剃刀语法对我的 MVC4 项目进行异常处理：http: [//www.devcurry.com/2012/06/aspnet-mvc-handling-exceptions-and-404.html](http://www.devcurry.com/2012/06/aspnet-mvc-handling-exceptions-and-404.html)

在遵循它之后，我仍然会遇到运行时错误，因此当我输入错误的 url 时，不会重定向到我的错误页面。当我这样做时，异常被记录下来，并且我通过了我在教程中添加的方法，但最后它转到了以下页面：

http://[ipadress]:9880/Error?aspxerrorpath=/test

并向我展示：

```
Runtime Error

Description: An exception occurred while processing your request. Additionally, another exception occurred while executing the custom error page for the first exception. The request has been terminated. 
```

本教程和我的项目之间唯一的主要区别是我使用了额外的段语言。

我为错误处理实现了以下代码。

在我的 routeConfig 文件中：

```
 routes.MapRoute(
            name: "FailWhale",
            url: "{language}/FailWhale/{action}/{id}",
            defaults: new { language = "en-US", controller="Error" ,action = "FailWhale", id = UrlParameter.Optional }
        ); 
```

在我的过滤器配置中：

```
 public class HandleAndLogErrorAttribute : HandleErrorAttribute
    {
        public override void OnException(ExceptionContext filterContext)
        {
            var exception = filterContext.Exception;
            var httpException = exception as HttpException;

            if (httpException != null) LogGateway.For(this).Fatal("Fatal Http exception occured --- " + httpException.Message);
            else LogGateway.For(this).Fatal("Fatal exception occured --- " + exception.Message);

            base.OnException(filterContext);
        }
    } 
```

我的 web.config：

```
<customErrors mode="On" defaultRedirect="Error">
  <error statusCode="404" redirect="en-US/FailWhale" />
</customErrors> 
```

我的错误控制器：

```
 public ActionResult FailWhale()
    {
        Response.StatusCode = 404;
        Response.TrySkipIisCustomErrors = true;

        LogGateway.For(this).Error("Fatal Http exception occured --- " + Response.StatusCode + ": " + Response.StatusDescription);

        return View();
    } 
```

我可能在这里监督一些事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T17:28:48.953

我已将运行该网站的 PC 链接到 dyndns.org 子域进行测试，发现我的问题得到了正确处理。

# knockout.js - “无法读取未定义的属性‘x’”

> ID：14550912
> 
> 赞同：2
> 
> 时间：2013-01-27T18:52:25.957
> 
> 标签：knockout.js

这是我相关小提琴的链接：http: [//jsfiddle.net/mwassmer/Kwmn5/](http://jsfiddle.net/mwassmer/Kwmn5/)

我试图让用户将一个或多个行从第一个表（可用的数据库字段）移动到第二个表（要保存到用户自定义“数据集”的字段），反之亦然。

当“addSelected”事件处理程序运行时，我收到“无法读取未定义的属性‘isChecked’”错误，除非最后一行且仅最后一行被选中。我仍在尝试在 Knockout 的上下文中正确使用“this”，所以我认为问题与我对“this”的误用有关。任何帮助，将不胜感激。

相关代码摘录如下：

```
 self.addSelected = function() {
    ko.utils.arrayForEach(self.dbRows(), function(row)
    {
        if (row.isChecked) {
            row.isChecked = false;
            self.dsRows.push(row);
            self.dbRows.remove(row);
        }
    });
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T19:14:43.953

问题是您正在删除您正在迭代的数组的一个元素。

的来源`ko.utils.arrayForEach`是：

```
 var arrayForEach =  function (array, action) {
        for (var i = 0, j = array.length; i < j; i++)
            action(array[i]);
    } 
```

解决此问题的一种方法是在删除元素之前创建数组的副本。你可以这样做：

```
array.slice(0) 
```

在您的代码中：

```
self.addSelected = function() {
    ko.utils.arrayForEach(self.dbRows().slice(0), function(row)
    {
        if (row.isChecked) {
            row.isChecked = false;
            self.dsRows.push(row);
            self.dbRows.remove(row);
        }
    });
}; 
```

更新的小提琴在[这里](http://jsfiddle.net/delixfe/xY3xk/)。

# wordpress - 仅当它们属于 WordPress 中已发布的帖子/页面时才允许文件访问

> ID：14550918
> 
> 赞同：0
> 
> 时间：2013-01-27T18:52:53.663
> 
> 标签：wordpress, file, plugins, attachment

我需要知道是否有一个插件可以根据相关的帖子/页面的状态限制对上传文件的访问。

换句话说，当我将图像上传到帖子中但帖子未发布时，我需要 WordPress 不允许访问该图像，直到我将帖子切换到已发布。

我可以自己编写代码，所以请让我知道是否已经有插件，这样我可以节省时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T15:10:19.297

好吧，我不知道有什么特定的插件可以做到这一点，但是您实际上需要做的是更改`.htaccess`直接访问文件的权限以实现 URL 限制。

Stephan Harris 写了一篇非常好的文章，用几种方法在 wordpress 中处理了这个问题。

[http://www.stephenharris.info/2012/restricting-direct-access-to-files-in-wordpress/](http://www.stephenharris.info/2012/restricting-direct-access-to-files-in-wordpress/)

Stephan Harris 在他的文章中提到了那些防止直接访问的方法。我仍然很难想象在已发布/未发布的基础上需要这样做的情况。

但仍然 - 您可以轻松检查后期状态（使用[get_post_status()](http://codex.wordpress.org/Function_Reference/get_post_status)）并将其应用到他的脚本/方法中以实现您想要的。特别看一下他重定向所有（图像）请求以通过 index.php 的方法-在那里您可以轻松地插入权限检查。

您可以应用的第二种方法是更改​​上传文件夹，从而使人们更难以“猜测”，正如您所说的那样，URL。这可以在逐个帖子的基础上（每个帖子不同的文件夹）或通过随机字符串来完成。

您可以通过多种方式做到这一点，这里描述了其中一种方式：

[http://codex.wordpress.org/Function_Reference/wp_upload_dir](http://codex.wordpress.org/Function_Reference/wp_upload_dir)

或者简单地使用一个像[THIS ONE](http://www.semiologic.com/software/uploads-folder/)这样的插件，它会根据帖子标题给出一个文件夹名称。在发布之前，未经授权的用户是不知道的。）

# java - repaint() 没有调用 PaintComponent 来使用 Graphics2D

> ID：14550925
> 
> 赞同：1
> 
> 时间：2013-01-27T18:53:36.493
> 
> 标签：java, swing, bufferedimage, graphics2d, paintcomponent

我花了几天时间试图让 Graphics2D 类在我的代码中工作。我的结构是这样的，当注册点击事件时，重新绘制的调用就完成了，但是当它到达调用 repaint() 的阶段时，这只会产生一个空指针异常。

调试时一切都按预期工作，而不是从paintComponent方法中调用，但是当尝试使用paintComponent和repaint（）正确调用代码以允许Graphics2D类显示每个点的线条时，它不起作用。

我已经包含了我难以开始工作的代码部分。任何帮助都将不胜感激。先感谢您。

下面是包含我的 mouseListener 的 GUI 类。

```
public class GUI extends JPanel implements MouseListener {

private JLabel label;

    public BufferedImage getImg() {
    return img;
    }

    public void mouseClicked(java.awt.event.MouseEvent e) {
    // TODO Auto-generated method stub
    label = new JLabel();

    //set point equal to the location of the mouse click on the image label
    Point b = e.getPoint();

    //place we are going to print the dots
    segmentation.x = b.x; //gets the x coordinate 
    segmentation.y = b.y; //gets the y coordinate

    System.out.println("x = " + segmentation.x);
    System.out.println("y = " + segmentation.y);        

    //set the global img in the segmentation class equal to that of the one in the current tab
    segmentation.setImg(tabbedPane.getSelectedIndex(), getImg());
    segmentation.paintUpdate();
    label = segmentation.getLabel();

    //if i run this line of code the existing label I already have with simply vanish because of the paintComponent method not being called upon properly.
    //tabbedPane.setComponentAt(tabbedPane.getSelectedIndex(), label);
} 
```

这是包含我无法正确调用的 paintComponent 方法的 Segmentation 类。

```
public class Segmentation extends JLabel {

public int[] xpoints = new int[50];
public int[] ypoints = new int[50];
private int npoints = 0;
public int x;
public int y;
GeneralPath polyline;
Graphics2D g2;
JLabel label;
BufferedImage img;
ImageIcon icon;

public void paintUpdate() {
    repaint();
}

public void setImg(int tabNum, BufferedImage img) {
    this.img = img;
}

public GeneralPath createPath() {

    //      if (npoints > 0) {
    polyline.moveTo(xpoints[0], ypoints[0]);

    for(int i = 1; i < xpoints.length; i++) {
        //add the position of the point to the respective x and y arrays
        polyline.lineTo(xpoints[i], ypoints[i]);        
    }
    //      }
    return polyline;
}

public void paintComponent(Graphics g) {
    super.paintComponent(g);

    System.out.println("we're in the paint component method");

    //set up for the new jlabel
    label = new JLabel();
    label.setIcon(new javax.swing.ImageIcon(img));
    label.setHorizontalAlignment(JLabel.LEFT);
    label.setVerticalAlignment(JLabel.TOP);

    //add the position of the point to the respective x and y arrays
    xpoints[npoints] = x;
    ypoints[npoints] = y;

    if (npoints == 0) {
        JOptionPane.showMessageDialog(null, "Your first point has been added successfully");
    }
    else {
        JOptionPane.showMessageDialog(null, "Your " + npoints + " rd/th" + " point has been added successfully");
    }

    polyline = createPath();

    // Draws the buffered image to the screen.
    g2.drawImage(img, 0, 0, this);

    g2.draw(polyline);

    npoints++;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T18:59:26.757

您的 Segmentation 类有两个 JLabel，一个是该类本身的对象，它具有 paintComponent 覆盖并且可能从未使用过：

```
public class Segmentation extends JLabel { 
```

另一个名为 label 的 JLabel 由类中的组合持有，该类没有方法覆盖，实际上已使用该方法覆盖，并且似乎“隐藏”了该类的实例：

```
JLabel label 
```

如果要调用paintComponent，则需要使用实际上覆盖该方法的标签对象。

此外，您似乎正在`paintComponent(...)`方法中创建组件（??）。永远不要这样做，也不要在此方法中使用程序逻辑。

编辑：
要在图像上绘图，我通常会覆盖 paintComponent 并使用其 Graphics/Graphics2D 对象进行绘制。例如：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.RenderingHints;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.geom.Line2D;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import javax.imageio.ImageIO;
import javax.swing.*;

public class DrawOnLabel extends JLabel {
   public static final String GIRAFFE_IMG_URL = "http://upload.wikimedia.org/wikipedia/commons/thumb" +
        "/9/9e/Giraffe_Mikumi_National_Park.jpg/474px-Giraffe_Mikumi_National_Park.jpg";
   private static final Color LINES_COLOR = Color.red;
   private static final Color CURRENT_LINE_COLOR = new Color(255, 200, 200);
   private List<Line2D> lineList = new ArrayList<Line2D>();
   private Line2D currentLine = null;

   public DrawOnLabel() throws IOException {
      URL giraffeUrl = new URL(GIRAFFE_IMG_URL);
      BufferedImage img = ImageIO.read(giraffeUrl);
      ImageIcon icon = new ImageIcon(img);
      setIcon(icon);

      MyMouseAdapter myMouseAdapter = new MyMouseAdapter();
      addMouseListener(myMouseAdapter);
      addMouseMotionListener(myMouseAdapter);
   }

   @Override
   protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      Graphics2D g2 = (Graphics2D) g;
      g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);

      g2.setColor(LINES_COLOR);
      for (Line2D line : lineList) {
         g2.draw(line);
      }
      if (currentLine != null) {
         g2.setColor(CURRENT_LINE_COLOR);
         g2.draw(currentLine);
      }
   }

   private class MyMouseAdapter extends MouseAdapter {
      Point p1 = null;

      @Override
      public void mousePressed(MouseEvent e) {
         p1 = e.getPoint();
      }

      @Override
      public void mouseReleased(MouseEvent e) {
         if (currentLine != null) {
            currentLine = new Line2D.Double(p1, e.getPoint());
            lineList.add(currentLine);
            currentLine = null;
            p1 = null;
            repaint();
         }
      }

      @Override
      public void mouseDragged(MouseEvent e) {
         if (p1 != null) {
            currentLine = new Line2D.Double(p1, e.getPoint());
            repaint();
         }

      }
   }

   private static void createAndShowGui() {
      DrawOnLabel mainPanel = null;
      try {
         mainPanel = new DrawOnLabel();
      } catch (IOException e) {
         e.printStackTrace();
         System.exit(-1);
      }

      JFrame frame = new JFrame("DrawOnLabel");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.setResizable(false);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

# templates - 如何使用 C++ 模板传递函数及其签名（haskell 样式）？

> ID：14550927
> 
> 赞同：3
> 
> 时间：2013-01-27T18:54:03.267
> 
> 标签：templates, functional-programming, metaprogramming

作为一个编程练习，我决定尝试为我正在用 c++ 做的一门课程实现我所有的haskell 作业。目前，我正在尝试发送此功能：

```
int callme(){
    cout << "callme called" << endl;
    return 0;
} 
```

到这个功能：

```
template<class type1,class type2> void callfunc(type1(*f)(type2)){
    (*f)(); 
} 
```

用这个电话：

```
int main(){
    callfunc<int,void>(callme);
} 
```

但我得到了错误：

```
macros.cc: In function ‘int main()’:
macros.cc:45:29: error: no matching function for call to ‘callfunc(int (&)())’ 
```

是什么赋予了？我能够以完全相同的方式发送一个函数作为参数，只是没有模板......唯一应该改变的是在编译之前将类型名称替换到它们的适当位置，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T07:39:16.543

我认为'void'是c ++中的'特例'。编译器无法将 f() 与 f(void) 匹配，将其替换为任何其他类型，它将编译。对我来说，这只是另一个 c++ 魔法，但也许有人知道得更好。这将编译：

```
int callme(int){ printf("ok int\n"); return 0; }
int callme(char){ printf("ok char\n"); return 0; }
template<class type1,class type2> void callfunc(type1(*f)(type2), type2 p) {
  (*f)(p);
}

int main() {
  callfunc<int,int>(callme, 1);
  callfunc<int,char>(callme, 1);
} 
```

# c - 在 C 中对整数使用 read() 系统调用

> ID：14550930
> 
> 赞同：0
> 
> 时间：2013-01-27T18:54:47.730
> 
> 标签：c

我必须使用从文件中一次读取来构建一个包含字符、整数和浮点数的结构。我可以很好地阅读字符，但我在阅读整数时遇到了问题

```
CountryData ReadingFile(Directory* CountryDirectory,int SortedCountryData,char *Code,int NumberofCountries)
{
    int Location,i;  // Will store Location in array and location in bytes
    char Buff[40]; //Buffer the size of the stuct
    char Tok[25];
    CountryData Country;
    off_t offset;  //Offset value
    ssize_t count;

    Location = BinarySearch(CountryDirectory,Code,0,NumberofCountries-1); //Findlocation in array
    Location =CountryDirectory[Location].Offset; //Find location in bytes
    offset = lseek(SortedCountryData, Location, SEEK_SET); //Seek to location in file
    count = read(SortedCountryData,Buff,40); //Read file

     //Data in Buff should be Code[4],Name[25],int,float

    for(i=0;i<4;i++)//Get code
    {
    Tok[i] = Buff[i];
    }
    strncpy(Country.Code,Tok,sizeof(Country.Code));//Copy Code

    for(i=0;i<25;i++)//Get Name
    {
    Tok[i]=Buff[i+4];
    }
    strncpy(Country.Name,Tok,sizeof(Country.Name));//Copy Name

        //This is where I try to read the int
    char INTEGER[4];
    for(i=0;i<4;i++) //Read an int
    {
        INTEGER[i]=Buff[33+i];
    }
    int A =(int)INTEGER;
    printf("Tok: %d",A);

    return(Country);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:05:34.513

我相信@slugonamission 关于指针问题是正确的，但是如果我正确理解了这个问题，int 作为 int 存储在文件中，你处理 char 数组的原因是你被迫改变你的方式做`read`。

为此尝试 memcpy。还要注意字节序问题。

```
int A;
memcpy(&A, Buff + 33, 4 * sizeof(char)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:07:31.327

问题在于它`INTEGER`是一个数组，它相当于 C 中的一个指针。所以，当你将它转换为 an 时`int`，你是在转换指针，而不是值，这会给你带来疯狂的结果。解决方案？转换为`int`指针，然后取消引用：

```
int *A = (int *) INTEGER;
printf("Tok: %d",*A); 
```

作为一种快捷方式，您可以使用一些指针算法来避免循环：

```
int *A = (int *) (Buff + 33);
printf("Tok: %d",*A); 
```

如果您需要一个副本，那不会制作副本（例如，如果您打算更改`int`并希望保持缓冲区完整）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T23:06:51.623

假设 int 和 float 是“二进制”编码的（写）我会做这样的事情：

```
struct Data
{
    union 
    {
        char Buff[40];
        struct 
        {
            char Country_Code[4];
            char Name[25];
            int  A;  /* char A[5]; convert to int using atoi */
            float F; /* char F[6]; convert to float using atof */
        };
    };
};

CountryData ReadingFile(........)
{

    int Location,i;  // Will store Location in array and location in bytes
    CountryData Country;
    off_t offset;  //Offset value
    size_t count; 
```

......

```
 Data BUFF;
    count = read(SortedCountryData,BUFF.Buff,40); //Read file

     //Data in Buff should be Code[4],Name[25],int,float

    strncpy(Country.Code,BUFF.Country_Code,sizeof(Country.Code));//Copy Code
    strncpy(Country.Name,BUFF.Name,sizeof(Country.Name));//Copy Name
    int A =BUFF.A;
    printf("Tok: %d",A);
    return(Country);
} 
```

但是如果 int 和 float 也是字符串编码的（在文本模式下，有 5 和 6 个字符，但包括终止符），我们可以在结构中将声明更改为`char A[5]`and `char F[6]`，并使用 atoi 和 atof 将其转换为 int 或 float分别。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-27T18:57:05.060

```
char INTEGER[4];
for(i=0;i<4;i++) //Read an int
{
    INTEGER[i]=Buff[33+i];
}
int A =(int)INTEGER; 
```

问题与保存您的值的数组有关。数组可以在 C 中自动衰减为指针，因此这里发生的情况是，在最后一行使用时，您的字符数组首先被转换为指针。在此之后，它将被转换为一个整数（并且你的编译器应该给你一个警告）。

要解决这个问题，要么实现你自己的字符串到整数例程，要么使用`atoi`.

# php - PHPExcel Mysql日期格式

> ID：14550931
> 
> 赞同：0
> 
> 时间：2013-01-27T18:54:48.843
> 
> 标签：php, codeigniter, phpexcel

我正在从 mysql 数据库中检索数据并使用它来生成一个 excel 文件。我不断收到受日期语法影响的损坏的 xlsx 文件。您如何从数据库中选择一个日期（类型）值并使用 PHPExcel 将其输入到单元格中？例如

```
$objPHPExcel -> getActiveSheet() -> SetCellValue('A' . $i, $result["name"]); 
$objPHPExcel -> getActiveSheet() -> SetCellValue('B' . $i, $result["dateofcontract"]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:07:59.833

根据文档，您可以这样做：

```
/* PHPExcel_Cell_AdvanceValueBinder required for this sample */
require_once 'PHPExcel/Cell/AdvancedValueBinder.php';

// MySQL-like timestamp '2008-12-31' or date string
PHPExcel_Cell::setValueBinder(new PHPExcel_Cell_AdvancedValueBinder());
$objPHPExcel->getActiveSheet()
            ->setCellValue('B' . $i, $result['dateofcontract']));
$objPHPExcel->getActiveSheet()
            ->getStyle('B' . $i)
            ->getNumberFormat()
            ->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_DATE_YYYYMMDDSLASH) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T22:04:13.230

PHPExcel 中有用于将 unix 时间戳或 PHP DateTime 对象转换为 Excel 日期时间戳的内置函数，并且还将一些字符串日期格式转换为 Excel 日期时间戳：

```
PHPExcel_Shared_Date::PHPToExcel() 
```

然后将生成的 Excel 日期时间戳值设置为单元格值，并将单元格 numberformat 样式设置为表示日期/时间格式的掩码。这正是peterm 提到的Advanced Value Binder 所做的，尽管Advanced Value Binder 还操纵您可能不希望更改的某些其他值（例如百分比）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:05:11.573

取决于日期在数据库中的存储方式，将其检索为时间戳，然后使用 php 的`date()`函数。

例如。

`"SELECT UNIX_TIMESTAMP(dateofcontract) AS dateofcontract"`

`$formattedDate = date("m.d.y",$dateofcontract) // outputs 03.10.01`

显然，您需要将 db 查询结果分配给`$dateofcontract`，以查看日期的所有可能格式，请参见此处：[date()](http://php.net/manual/en/function.date.php)

# hover - 设置打印文本的属性？

> ID：14550932
> 
> 赞同：0
> 
> 时间：2013-01-27T18:54:53.697
> 
> 标签：hover, raphael, attr

我正在设计一个光滑的 raphael 显示器，但我似乎无法在实例化后将 print()'d 文本元素的 attr 设置为悬停：

```
var w = Raphael("weddings", 85, 30);
var fonts = [0, w.getFont("helvetica-neue-thin"), w.getFont("arial")];
w.print(0, 15, "Weddings", fonts[1], 20).attr({fill: "#000000"}); 
```

以下不产生任何结果：

```
$("#weddings").hover(function () {
w.attr("color", "#000");
},
function () {
w.attr("color", "#FFFFFF");
}); 
```

我以为：

```
w.print.attr("color", "#FFFFFF"); 
```

可能工作，但它没有。我在这里遗漏了什么？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T19:30:16.187

你先注册字体了吗？请参阅[.registerFont() 函数](http://raphaeljs.com/reference.html#Raphael.registerFont)。

然而，我有一个微弱的怀疑，你实际上并不想以这种复杂的方式呈现字体，而只是想在屏幕上写一些文本，然后在悬停时改变它。如果是这样，有一个无限简单的方法：

```
var w = Raphael(0, 0, 85, 30);
var text = w.text(0, 15, "Weddings").attr({'font-family': "helvetica-neue-thin", 'text-anchor': 'start', 'fill': '#000'});

text.hover(
    function () {
        this.attr("fill", "#F00");
    },
    function () {
        this.attr("fill", "#000");
    }
 ); 
```

（你仍然需要在某处加载字体，因为它不是标准的，但那是你的事。）

# javascript - 如何添加或删除html5的音频属性 ?

> ID：14550933
> 
> 赞同：0
> 
> 时间：2013-01-27T18:55:07.203
> 
> 标签：javascript, jquery, html, html5-audio

我用 html5 和 javascript 创建了一个多轨播放器。

```
var track_1 = document.getElementById('audio_1'); 
```

我制作了自定义控制按钮：音量、播放、停止、暂停，例如：

```
$bt_play_audio_mixette_1.click(function() {
    if (track_1.paused == false) {
        track_1.pause();
    } else {
        track_1.play();
    }
}); 
```

我有一个按钮“循环”，我想修改为动态`<audio>`属性`loop`。

我尝试过`.attr();`或`.prop();`但没有成功。

你知道这段代码有什么问题吗：

```
var loop_1_active = true;
$bt_loop_audio_1.click(function() {
    if (track_1.prop("autoplay", true)) {
        track_1.prop("autoplay", false);
        loop_1_active = false;
    } else {
        track_1.prop('loop', true)
        track_1.attr("autoplay", true);
    }
}); 
```

编辑 ：

如果我使用 jquery 对象：

```
var track_1_B = $('#audio_1'); 
```

我不能用`pause();`

> 错误 :ReferenceError: track_1 未定义 track_1.pause();

如果我使用纯 JS：

```
var track_1 = document.getElementById('audio_1'); 
```

我可以使用`pause();`，但我不能更改循环属性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:02:11.583

也使用 jquery：

```
var $track_1 = $('#audio_1'); // jquery object
var track_1 = document.getElementById('audio_1'); // pure js DOM element 
```

并且仅在 jquery 对象上使用 jquery 方法。

```
$track1.click(//...
$track1.attr(//...
$track1.prop(//... 
```

DOM 元素上的其他方法

```
trakck1.pause(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T18:59:37.050

`if (track_1.prop("autoplay", true)) {`实际上将 autoplay 属性设置为 true 而不是检查它是否为 true 并且将始终返回一个真实值。改用`if (track_1.prop("autoplay")) {`. 我现在看到这`track_1`是一个 dom 元素而不是 jQuery 对象，因此需要将其转换为一个才能使用`prop()`...例如`$(track_1).prop("autoplay")`。您也可以直接访问元素属性，无需使用 jQuery

```
var track_1 = document.getElementById('audio_1');
var loop_1_active = true;
$bt_loop_audio_1.click(function() {
    if (track_1.autoplay) {
        track_1.autoplay = false;
        loop_1_active = false;
    } else {
        track_1.loop = true;
        track_1.autoplay = true;
    }
}); 
```

# javascript - 替换元素时，事件和数据会发生什么

> ID：14550940
> 
> 赞同：0
> 
> 时间：2013-01-27T18:56:09.860
> 
> 标签：javascript, ajax, events

我很想知道，当ajax加载时替换了A元素时，所有被它蒙蔽的事件和数据都会被断开或直接删除？

`$(parent), $(document) or $(window)`如果一旦被替换，我不相信任何没有被蒙蔽的事件和数据将保持不变。如果是这样，它们是否只是被断开或删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T18:59:00.410

如果一个事件直接绑定到一个元素（不使用委托事件处理），那么当该元素被删除时，它的事件处理程序也将被删除。

类似地，如果任何属性或属性已添加到该 DOM 元素，它们将与该特定 DOM 元素一起使用，因此如果 DOM 元素被删除，它们也会被删除。

如果使用委托事件处理（观察冒泡到更高级别的父对象的事件，例如`body`or `document`，那么这些事件将仍然存在，因为事件实际附加到的对象没有被替换。

* * *

您的问题没有用 jQuery 标记，但是您使用了一些类似 jQuery 的示例，因此在 jQuery 世界中，附加的事件如下：

```
$("#myObject").on('click', fn); 
```

更换时将被删除`#myObject`。但是，像这样的委托事件：

```
$(document.body).on('click', '#myObject', fn); 
```

即使`#myObject`被具有相同 ID 的不同对象替换，仍然有效，因为事件实际附加到的对象（`document.body`在这种情况下）没有被删除或替换。

# php - PHP 从数据库中选择全部并与日历进行比较

> ID：14550947
> 
> 赞同：1
> 
> 时间：2013-01-27T18:57:02.607
> 
> 标签：php, mysql, select, for-loop, pdo

我为当月创建了一个日历，但我还需要检查数据库中是否存在具有相同月份和年份的行。而不是显示当天的工作时间行。这是我的代码

```
echo '
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Hours</th>
                        <th>Minutes</th>
                        <th></th>
                    </tr>
                </thead>
            <tbody class="listUser">';

            //get how many day on the month
            $daysOfMonth = date('t', strtotime("$month/1/$year"));
            //select all from the db
            $result = $this->_dbconn->prepare('SELECT time.day, time.hours, time.minutes FROM work_time AS time WHERE year=? AND month=?');
            $result->execute(array($year, $month));
            $rows = $result->fetchAll(PDO::FETCH_ASSOC);

            //printVar($rows);

            for($i=1; $i<$daysOfMonth; $i++){
                $i = (strlen($i) < 2)? $i = '0'.$i : $i=$i;
                echo '<tr>';
                    echo '<td>'.$year.''. $month .''.$i.'</td>';
                    echo '<td><input class="span1" type="number" /></td>';
                    echo '<td><input class="span1" type="number" /></td>';
                    echo '<td><input class="btn" type="submit" value="save" /></td>';
                echo '</tr>';
            }
            echo '
                </tbody>
            </table>'; 
```

# php - 使用 JInput 过滤整数

> ID：14550950
> 
> 赞同：1
> 
> 时间：2013-01-27T18:57:10.237
> 
> 标签：php, joomla, joomla2.5, joomla3.0

我正在从 JInput 中检索一个必须是整数的值。

```
$input = new JInput();
$post = $input->getArray($_POST);
$value= $input->$post['value']; 
```

现在显然我不能使用 is_int() 因为`$_POST`使值成为字符串 - 通常使用 filter_input() 解决。这给我留下了一个小问题——因为我想拒绝任何不是整数的东西——不要将它转换为整数。使用类似的东西

```
$value=JFactory::getApplication()->input->get('value', '0', 'INT'); 
```

强制字符串为整数。（例如，输入 1.2 将给出 $value 1 等）。所以我被困在如何实现这个过滤器上。理想情况下，我想做一些类似的事情

```
if(is_int($delete)) {
    //Carry on processing data
} else {
    //Stop function and display a JError
JLog::add("Value is not a integer", JLog::WARNING, 'jerror');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:51:55.147

为什么不使用：

```
$input = new JInput;
$value = $input->getInt('value'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T23:38:51.993

最后在 SO under [check for integer or float values](https://stackoverflow.com/questions/3461693/check-for-integer-or-float-values)上找到了它。

使用的最终代码是：

```
$input = new JInput();
$post = $input->getArray($_POST);
$value= $input->$post['value'];
//checks value is numeric and if it is a int
if(is_numeric($value) && (int) $value == $value) {
    //process data
} else {
    JLog::add("Value is not a integer", JLog::WARNING, 'jerror');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T11:12:00.043

```
$input = new JInput;
$email = $input->get('email', '', 'post');
$time = $input->get('time', '', 'post');
$move = $input->get('move', '', 'post');
$idcat = $input->get('idcat', '', 'post'); 
```

# java - play 2.1-rc2 java：处理带有固定空参数的javascript路由

> ID：14550951
> 
> 赞同：0
> 
> 时间：2013-01-27T18:57:17.430
> 
> 标签：java, javascript, scala, playframework-2.0

我正在使用 Play Framework 2.1-RC2，并且有几条路线看起来像：

```
POST  /resource                 SomeController.action(parent = null)
POST  /parent/:parent/resource  SomeController.action(parent: String) 
```

假设我已`jsRoutes`使用该`play.Routes.javascriptRouter`方法将这些路由导出到 javascript，我想调用`jsRoutes.SomeController.action()`或`jsRoutes.SomeController.action("some-id")`获取适当的路由。但是，这是我得到的 javascript 函数：

```
function (parent) {
    if (parent == "null") {
        return _wA({
            method: "POST",
            url: "/" + "resource"
        })
    }
    if (true) {
        return _wA({
            method: "POST",
            url: "/" + "parent/" + (function (k, v) {
                return v
            })("parent", parent) + "/resource"
        })
    }
} 
```

似乎 Play 的`String`路径绑定器已将固定`null`值转换为 javascript`String`文字`"null"`。

我查看了[这个问题](https://stackoverflow.com/questions/10286725/how-to-bind-double-parameter-with-play-2-0-routing)和[这个代码文件](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/java/play/mvc/PathBindable.java)，但我真的找不到我要找的东西。我不想为`String`该类使用大部分冗余的包装器。你会认为这会得到开箱即用的支持。这是框架的限制还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T10:53:34.760

这似乎是框架的限制。`"null"`每当我需要访问第一条路由时，我最终都会传递给 javascript 函数。丑陋，但在问题解决之前一直有效。

# java - 使用java以最简单的形式将XML解析为DB

> ID：14550952
> 
> 赞同：0
> 
> 时间：2013-01-27T18:57:32.620
> 
> 标签：java, xml, jaxb

**问题：**我有一个 XML，我想解析它并通过 XML 文件的名称创建一个表，并且只将某些值加载到表中。

我发现很少有库，但我觉得内置的 JAXB（或者还有其他简单的方法吗？）足以完成这个简单的任务。

在此之前我不知道解析 XML，经历了这么多教程都谈到了从 XML 创建一个类和 java 对象，我的要求很简单，只需在根元素(class=" java.util.ArrayList) 。

有人可以帮助我如何实现这一目标吗？

我正在尝试解析的 XML 在这里[http://txtup.co/wSXCA](http://txtup.co/wSXCA)

**我需要在 void class="java.util.ArrayList" 中的每个 void method="add" 下提取以下属性：**

```
@property(description)
@property(jndiName)
@property(url) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T06:10:39.730

正如 home 所提到的，我能够解码我的 XML 文档。在提出问题之前，我不知道它是一个 java 序列化对象 xml，我能够以任何方式获得我的 XML 解码，如下所示。

```
 XMLDecoder d = new XMLDecoder(
                      new BufferedInputStream(
                          new FileInputStream("Test.xml")));
   Object result = d.readObject();
   d.close(); 
```

# php - 轻量级自动 phpunit 测试框架

> ID：14550954
> 
> 赞同：1
> 
> 时间：2013-01-27T18:57:49.517
> 
> 标签：php, unit-testing, phpunit, automated-tests

我正在为我将要开发的几个 php 站点寻找一个轻量级和低配置的自动测试框架。我知道 Selenium，但我也听说它可能有点消耗资源（这是真的吗？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T10:50:30.233

（根据您的评论：“*在每次 git 提交（或每个时间段）之后运行一堆单元测试*”）[PHPUnit](http://www.phpunit.de/manual/current/en/)就是您想要的。它是 PHP 的事实上的标准单元测试，并且功能丰富。

Selenium 用于浏览器控制，可用于网站的功能测试，就像用户一样进行交互（即您指定要按下的按钮和键盘点击）。Selenium 测试有更多的开销，所以你应该只将它们用于单元测试不能做的测试。（您的 Selenium 测试也将隐含地测试您的 javascript、AJAX、Apache 配置等，因此它们无法像好的单元测试那样针对问题。）

# java - 当 glassfish Web 容器中的 servlet 使用 FileWriter 实例时，我如何知道我的文件保存在哪里

> ID：14550955
> 
> 赞同：0
> 
> 时间：2013-01-27T18:57:50.710
> 
> 标签：java, servlets, glassfish

在阅读有关 servlet 的这本书时，我遇到了一个示例，它使用 FileWriter 类在 servlet 被销毁之前保存它的持久状态。测试了示例并且工作正常，这是代码：

```
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class InitDestroyCounter extends HttpServlet {

  int count;

  public void init(ServletConfig config) throws ServletException {
    // Always call super.init(config) first  (servlet mantra #1)
    super.init(config);

    // Try to load the initial count from our saved persistent state
    try {
      FileReader fileReader = new FileReader("InitDestroyCounter.initial");
      BufferedReader bufferedReader = new BufferedReader(fileReader);
      String initial = bufferedReader.readLine();
      count = Integer.parseInt(initial);
      return;
    }
    catch (FileNotFoundException ignored) { }  // no saved state
    catch (IOException ignored) { }            // problem during read
    catch (NumberFormatException ignored) { }  // corrupt saved state

    // No luck with the saved state, check for an init parameter
    String initial = getInitParameter("initial");
    try {
      count = Integer.parseInt(initial);
      return;
    }
    catch (NumberFormatException ignored) { }  // null or non-integer value

    // Default to an initial count of "0"
    count = 0;
  }

  public void doGet(HttpServletRequest req, HttpServletResponse res) 
                               throws ServletException, IOException {
    res.setContentType("text/plain");
    PrintWriter out = res.getWriter();
    count++;
    out.println("Since the beginning, this servlet has been accessed " +
                count + " times.");
  }

  public void destroy() {
    saveState();
  }

  public void saveState() {
    // Try to save the accumulated count
    try {
      FileWriter fileWriter = new FileWriter("InitDestroyCounter.initial");
      String initial = Integer.toString(count);
      fileWriter.write(initial, 0, initial.length());
      fileWriter.close();
      return;
    }
    catch (IOException e) {  // problem during write
      // Log the exception.
    }
  }
} 
```

停止 glassfish 服务器后，我从部署文件夹复制/粘贴 war 文件，解压缩并查找“InitDestroyCounter.initial”文件，但在其中找不到，所以我想知道 glassfish 将这个创建的文件保存在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:08:46.887

（不是答案，但对于清晰的评论来说太长了。）

1.  您不能将文件保存到战争中。¹

2.  您应该通过写入绝对路径来写入已知文件位置。这可以通过 JNDI、初始化上下文参数、启动参数、环境变量等来定义。

3.  IMO 即使*不是*战争，您也不应该将其写入网络应用程序，因为您的文件将受制于您的部署机制，并且可能会被清除。

^(1 是的，你可以。不。)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T20:14:10.177

所有其他关于 WAR 修改都是正确的，但对于上面的代码：

这个

```
FileWriter fileWriter = new FileWriter("InitDestroyCounter.initial"); 
```

是一个捷径

```
File f = new File("InitDestroyCounter.initial");
FileWriter fileWriter = new FileWriter(f); 
```

所以请随意询问 File 对象的绝对位置：

```
System.out.println(f.getAbsolutePath()); 
```

总而言之，您上面的所有代码都将使用 JVM 的当前/工作目录来存储和读取文件。请记住，应根据 Java EE 规范避免 I/O 访问：[Java EE 程序员不写入文件](https://stackoverflow.com/questions/1789597/java-ee-programmers-do-not-write-to-files)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T19:08:25.990

在任何 java web/app 服务器中，您不应该期望直接在部署的存档中进行修改。相反，它会在当前工作目录中写入文件。

如果您在 linux 中，我找到了一个地方（[http://www.java.net/forum/topic/glassfish/glassfish/paths-glassfish](http://www.java.net/forum/topic/glassfish/glassfish/paths-glassfish)），他们声称您可以使用以下命令检索当前的工作目录：

```
asadmin generate-jvm-report | grep "user.dir" 
```

所以你可以看到它说什么。

但是据我所知，它应该是`config`服务器的目录。所以也许看看那里的文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-28T18:10:09.563

GlassFish 绝对保证当前工作目录将始终是域的“config”目录。例如在默认情况下：

/domains/domain1/config

该保证仅适用于使用 asadmin 启动 GlassFish 的情况。

注意：我写了代码，所以我确定！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-30T22:58:16.687

从我所做的答案和测试中，所有这些都可以指向路径：

```
System.getProperty("user.dir")

new File(".").getAbsolutePath()

getAbsolutePath(); 
```

正如你在这里看到的：

```
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class InitDestroyCounter extends HttpServlet
{
    int Cnt;

    String FR_File_Str;

    @Override
    public void init(ServletConfig ServlConf) throws ServletException
    {
        // Always call super.init(ServletConfig) first;
        super.init(ServlConf);

        // Try to load the initial Cnt from our saved persistent state;
        try
        {
            File FR_File = new File("InitDestCounter.init");
            FileReader FR = new FileReader(FR_File);

            BufferedReader BR = new BufferedReader(FR);

            String Initial_str = BR.readLine();

            Cnt = Integer.parseInt(Initial_str);

            FR_File_Str = FR_File.getAbsolutePath();

            return;
        }
        catch(FileNotFoundException Ignored){} // No saved state;
        catch(IOException Ignored){} // Problem during read;
        catch(NumberFormatException Ignored){} // Corrupted saved state;

        // No luck with the saved state, check for and init parameter;
        String Initial_str = getInitParameter("initial_cnt");

        try
        {
            Cnt = Integer.parseInt(Initial_str);
            return;
        }
        // Null or non-integer value;
        catch(NumberFormatException NFE){}

        // Default, if non of the above worked;
        Cnt = 0;
    }

    @Override
    public void doGet(HttpServletRequest  Request,
                      HttpServletResponse Response)
                      throws ServletException, IOException
    {
        Response.setContentType("text/html");

        PrintWriter PW = Response.getWriter();

        Cnt++;

        PW.println("<H4>Since the beginning this servlet had been "+
                   "accessed "+Cnt+" times.</H4>");
        PW.println("<H4>"+System.getProperty("user.dir")+"</H4>");
        PW.println("<H4>"+new File(".").getAbsolutePath()+"</H4>");
        PW.println("<H4>FR_File_Str = "+FR_File_Str+"</H4>");
    }

    public void SaveState()
    {
        // Try to save the accumulated count;
        try
        {
            FileWriter FW = new FileWriter("InitDestCounter.init");

            String Initial_str = Integer.toString(Cnt);

            FW.write(Initial_str, 0, Initial_str.length());

            FW.close();

            return;
        }
        catch(IOException IOE){} // Problem during write;
    }

    @Override
    public void destroy()
    {
        SaveState();
    }
} 
```

出于礼貌，我不会接受我自己的回答。感谢大家的回答和评论。

# vb.net - 在 Vb.net 中，更改按钮的背景色后无法获取按钮的默认样式

> ID：14550958
> 
> 赞同：-1
> 
> 时间：2013-01-27T18:58:00.987
> 
> 标签：vb.net, button

在 Vb.net 中，我在 mousehover 事件上更改了按钮背景色，但在 mouseleave 事件上，我无法将按钮的颜色更改为标准样式。Button 看起来是全银色，缺少通常的光泽外观

在 Mousehover 事件上我给了 Button1.BackColor = Color.Orange 和在 Mouseleave 事件上我给了 Button1.BackColor = Color.Silver ，但无法获得按钮的默认样式。怎样做才能恢复按钮的默认样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:23:44.087

使用**Button1.MouseEnter**不会改变按钮颜色，直到鼠标稳定在按钮上，而使用**Button1.MouseHover**将在颜色鼠标悬停在按钮上时改变按钮颜色。

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    'AddHandler Button1.MouseEnter, AddressOf btn1MouseHover
    AddHandler Button1.MouseHover, AddressOf btn1MouseHover
    AddHandler Button1.MouseLeave, AddressOf btn1MouseLeave
End Sub

Private Sub btn1MouseLeave(ByVal sender As Object, ByVal e As EventArgs)
    Button1.UseVisualStyleBackColor = True
End Sub

Private Sub btn1MouseHover(ByVal sender As Object, ByVal e As EventArgs)
    Button1.BackColor = Color.Red
End Sub 
```

# java - OpenGL：使用顶点数组渲染数千个立方体，效果不太好

> ID：14550959
> 
> 赞同：1
> 
> 时间：2013-01-27T18:58:07.780
> 
> 标签：java, opengl, rendering, lwjgl, vertex-array

我正在尝试使用顶点数组通过 LWJGL 渲染大约 2097152 个立方体（不是一次全部）。我已经实现了多种类型的多边形剔除，以将我的性能从大约 2 FPS 提高到大约 60 FPS。在整个项目中，我一直在使用即时模式渲染，我认为是时候升级了。这就是顶点数组的用武之地。

我不想使用 VBO，所以我现在一直在尝试 VAO。我似乎无法找到一种实用（或有效）的渲染方法。遗憾的是，我尝试的一切都比即时模式更差 FPS。每一帧我为每个具有可见多边形的立方体加载一个 FloatBuffer，然后使用常见的顶点数组方法绘制它们。这个设置让我很头疼，因为我得到的 FPS 比使用即时模式和不剔除任何多边形时要少。

我想我做错了什么。所以在你们这些聪明的、有抱负的 OpenGL/LWJGL 程序员中，有谁知道如何以更有效和高效的方式完成这项工作？

这是我的渲染代码（截断到不会太乱）：

```
for(int z = 0; z < chunk.bpc; z++) {
for(int y = 0; y < chunk.bpc; y++) {
    for(int x = 0; x < chunk.bpc; x++) {
        if(((z == chunk.bpc - 1 || z == 0) || (y == chunk.bpc - 1 || y == 0) || (x == chunk.bpc - 1 || x == 0)) 
            && chunk.data[(x * chunk.bpc + z) * chunk.bpc + y] == i) {

                List<Float> vertices = new ArrayList<Float>();

                float xp = x + locX, yp = y + locY, zp = z + locZ;

            if(z == chunk.bpc - 1 && chunk.z$ == null) {
                vertices.add(xp); vertices.add(yp); vertices.add(zp + size);
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp + size);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp + size);
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp + size);
            }

            if(z == 0 && chunk.z_ == null) {
                vertices.add(xp); vertices.add(yp); vertices.add(zp);
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp);
            }

            if(y == chunk.bpc - 1 && chunk.y$ == null) {
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp);
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp + size);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp + size);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp);
            }

            if(y == 0 && chunk.y_ == null) {
                vertices.add(xp); vertices.add(yp); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp + size);
                vertices.add(xp); vertices.add(yp); vertices.add(zp + size);
            }

            if(x == chunk.bpc - 1 && chunk.x$ == null) {
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp);
                vertices.add(xp + size); vertices.add(yp + size); vertices.add(zp + size);
                vertices.add(xp + size); vertices.add(yp); vertices.add(zp + size);
            }

            if(x == 0 && chunk.x_ == null) {
                vertices.add(xp); vertices.add(yp); vertices.add(zp);
                vertices.add(xp); vertices.add(yp); vertices.add(zp + size);
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp + size);
                vertices.add(xp); vertices.add(yp + size); vertices.add(zp);
            }

            float[] verts = new float[vertices.size()];
            for(int a = 0; a < verts.length; a++) {
                verts[a] = vertices.get(a);
            }

            FloatBuffer cubeBuffer = BufferUtils.createFloatBuffer(verts.length);
            cubeBuffer.put(verts);
            cubeBuffer.flip();

            GL11.glEnableClientState(GL11.GL_VERTEX_ARRAY);

            GL11.glVertexPointer(3, 0, cubeBuffer);

            GL11.glDrawArrays(GL11.GL_QUADS, 0, verts.length / 3);

            GL11.glDisableClientState(GL11.GL_VERTEX_ARRAY);
        }
    }
}
} 
```

（忽略其中一些变量，它们只是剔除不同的多边形）

所以我不知道是否有更有效的方法来做到这一点，但如果有的话，如果我能得到一些指示会很好​​。提前致谢！哦，还有...

我的渲染方式有些严重错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:31:35.543

不要在*每一帧都*重新生成几何图形。内部渲染循环中的动态内存分配通常是一个坏主意。

*当*一个块进入视图时以及如果/当​​该块被修改时，生成一个块的几何图形。

也许使用 LRU 缓存来存储几何图形，以便不可见的块慢慢地从缓存中清除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:37:25.527

虽然我读过关于 LWJGL 和 VAO 的文章，但我从未亲自使用过它们，但 VBO 总是为我解决问题。但是，如果我查看您的代码片段，您似乎每帧都调用此片段。所以，本质上你是在改变每一帧的数据，创建一个新的缓冲区，将数据从缓冲区传输到缓冲区，然后在缓冲区中渲染数据。每帧创建一个新的缓冲区是昂贵的，所以这样做一次然后重用你的缓冲区。如果您每帧都更改数据，那么 VAO 和 VBO 可能不会为您提供比立即模式更多的性能。原因在于，在即时模式下，您将每帧的数据传输到 GPU 内存并进行渲染，这种传输成本很高。另一方面，

# mysql - 为什么我的 MySQL 函数返回 NULL？

> ID：14550961
> 
> 赞同：0
> 
> 时间：2013-01-27T18:58:08.043
> 
> 标签：mysql, function

**功能：**

```
DELIMITER $$

DROP FUNCTION IF EXISTS `ToYear` $$
CREATE FUNCTION .`ToYear` (input varchar(47)) RETURNS year
BEGIN
  RETURN year(str_to_date(@input,_utf8'%m/%d/%Y'));
END $$

DELIMITER ; 
```

**函数调用**

```
SELECT ToYear('8/12/2013') 
```

为什么我的函数在放入返回年份的 SELECT 语句时返回 NULL？

```
SELECT year(str_to_date('8/12/2013',_utf8'%m/%d/%Y')); 
```

回报：`2013`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:04:28.460

```
DELIMITER $$

DROP FUNCTION IF EXISTS `ToYear` $$
CREATE FUNCTION `ToYear` (input char(10)) RETURNS year
BEGIN
  RETURN year(str_to_date(input,_utf8'%m/%d/%Y'));
END $$

DELIMITER ; 
```

# php - 如何从 html 表单字段中获取 Web 链接

> ID：14550962
> 
> 赞同：0
> 
> 时间：2013-01-27T18:58:12.590
> 
> 标签：php

我正在使用一个简单的 html 表单从用户那里获取数据，用户首先预览这些数据，然后将其发布到 Mysql 数据库中。表格是：

```
<form name="MyForm" enctype="multipart/form-data" method="post" action="myupload.php">
<p>Your name <input type="text" name="FormName" size="25" maxlength="50"> </p>
<p>Your email <input type="text" name="FormEmail" size="25" maxlength="50"></p>
<p> Link <input type="text" name="FormLink" size="25" maxlength="50"></p>
<p> <input type="submit" name="Submit" value="Submit"></p> 
</form> 
```

在 php 页面中，我使用以下代码：

```
$_SESSION['MyName']= $_POST['FormName'];
$_SESSION['MyEmail']= $_POST['FormEmail'];
$_SESSION['MyLink']= $_POST['FormLink'];

$myName = $_SESSION['MyName'];
$myEmail = $_SESSION['MyEmail'];    
$myLink = $_SESSION['MyLink'];

echo "Name: $myConName <br> "; 
echo "Email: $myConEmail <br>";  
echo "<a href=$myLink target=\"_blank\"> Read more</a></p>"; 
```

但是，如果用户输入，`http://www.google.com/`那么它可以正常工作，但如果用户输入`www.google.com/`，则无法显示网页（Google.com）。

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:12:59.573

像这样的东西应该工作：

```
if (substr($url, 0, 7) != 'http://') { 

  $myLink = "http://".$myLink;

} 
```

实际上它还应该检查是否没有“https://”——所以这可能是一个选项：

```
if ((substr($url, 0, 7) != 'http://')&&(substr($url, 0, 8) != 'https://')) { 

  $myLink = "http://".$myLink;

} 
```

或者这也可能是一个选择：

```
if (substr($url, 0, 4) != 'http') { 

  $myLink = "http://".$myLink;

} 
```

…虽然非常接近 powtac 的建议…</p>

这实际上可能与此“几乎重复”：

[检查字符串是否包含“HTTP://”](https://stackoverflow.com/questions/4487794/checking-if-string-contains-http)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T19:03:36.917

`http://www.google.com/`是绝对 URI，`www.google.com/`是相对 URI，因此它不指向 Google 的服务器（除非显示链接的页面也是如此）。

你可以：

*   什么都不做，让用户自己负责获取正确的 URL（他们可能会犯很多其他错误）
*   尝试解析所有 URL，如果响应不是 200，则拒绝或要求用户确认 URL
*   解析所有 URI 并拒绝任何非绝对 URI

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T19:02:40.947

之后：`$myLink = $_SESSION['MyLink'];`添加

```
$myLink = substr($myLink, 0, 4) == 'http' ? $myLink : 'http://'.$myLink; 
```

# php - 不回显完整的字符串

> ID：14550965
> 
> 赞同：1
> 
> 时间：2013-01-27T18:58:28.737
> 
> 标签：php

我有必须更改的谷歌坐标，但是当我回显它们时，例如，

```
echo (string)28.9871692657471; 
```

我得到的结果

```
28.987169265747 
```

结尾的“1”消失

```
echo (string) 28.9875984191895 
```

结尾的“5”消失

我试过直接echo它，不强制转换，但什么都没有改变，我想做的就是有这个基本的操作，

```
28.9875984191895 + 0.0000000000001 = 28.9875984191896 
```

有什么我想念的吗？因为我在互联网上搜索时找不到任何相关信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T19:00:46.840

浮点数对此不够准确，但无论如何`php.ini`设置`precision`会影响将浮点数转换为字符串时显示的十进制位数，因此请尝试调整它（编辑`php.ini`文件或使用`ini_set("precision",50);`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T19:01:57.413

根据[浮点数的 PHP 文档](http://php.net/manual/en/language.types.float.php)：

> 所以永远不要相信浮点数结果到最后一位，也不要直接比较浮点数是否相等。如果需要更高的精度，可以使用[任意精度的数学函数](http://php.net/manual/en/ref.bc.php)和[gmp](http://php.net/manual/en/ref.gmp.php)函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T19:58:55.327

试试这个

```
echo bcadd("28.9875984191895", "0.0000000000001", 13); 
```

最后一个参数是要显示的小数位数

# node.js - 理解 Node.js 中的流

> ID：14550967
> 
> 赞同：7
> 
> 时间：2013-01-27T18:58:37.987
> 
> 标签：node.js, stream

我目前正试图围绕 Node 的流。我想我明白了，但我不确定。让我困惑的是[多米尼克·塔尔的这句话](https://github.com/dominictarr/event-stream)：

> 流是最好的节点，也是最容易被误解的想法，[...]

由于 Dominic 绝对是一个非常聪明的人（而且我想比我更聪明），我不确定我是否真的正确理解了流，或者我是否错过了重点 ;-)。因此，我想解释一下我是如何理解流的，并请您批准或拒绝。

我对流的基本理解是，流是将数据从源传输到目标的抽象包装器。有可读可写流和可读写的双工流。这个想法是抽象出实际的源或目标，以便您可以专注于处理流，而无需知道您正在处理的实际资源是什么。您只是在访问一个流以进行读取和/或写入。

**我对 Node.js 流的理解是否正确？** 基本上，这与 .NET 中的流的想法相同（这是我过去 12 年左右的背景）。 **Node.js 流与 .NET 中的流有何不同？**

举个例子：如果我想从文件或网络资源中读取，我只是使用流将实际源抽象出来，然后从该流中读取。我什至可以更改源代码，但我的流式读取代码仍然可以以完全相同的方式工作。这个对吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-27T19:34:08.903

我认为你做对了。Node 中的流就像花园软管一样工作。您可以连接源和目标（作为可读/可写或双工流），还可以将流的输出连接到另一个流的输入，进一步扩展数据的传输方式。

[Substack](https://github.com/substack)在去年的 LXJS 会议上就 Node.js 中的 Streams 做了一个精彩的演讲：
**[LXJS 2012 - James Halliday - Harnessing The Awesome Power Of Streams](http://www.youtube.com/watch?v=lQAV3bPOYHo)**

它非常压缩（您必须不时暂停视频，因为他的实时编码速度非常快），但对流的工作方式给人留下了很好的印象。

# android - 在 android 中使用 koush websockects 时出错

> ID：14550974
> 
> 赞同：0
> 
> 时间：2013-01-27T18:59:30.857
> 
> 标签：android, node.js, websocket

我正在尝试将 node.js 服务器与 android 应用程序连接，所以我使用的是 koush 的 websockets：

[https://github.com/koush/android-websockets](https://github.com/koush/android-websockets)

因此，我已经克隆了项目并将其复制到 android 应用程序的项目中，我可以毫无问题地导入 WebSockectClient：

```
import com.codebutler.android_websockets.WebSocketClient; 
```

因此我想一切都很好，但问题是在示例代码中是下一个句子：

```
WebSocketClient client = new WebSocketClient(URI.create("wss://irccloud.com"), new WebSocketClient.Handler() {...} 
```

这使得 Eclipse 引发错误：

```
WebSocketClient.Handler cannot be resolved to a type 
```

查看类 WebSocketClient.java 没有 Handler 方法...所以我不知道该怎么做，我缺少什么...如果示例代码错误或什么，但我猜问题出在我的代码中。

有什么建议吗？

编辑：

我注意到 WebSocketClient 的生成器要求一个 Listener 对象而不是那个 Handler ......但是改变它仍然不起作用并且代码有另一个错误，我想我会尝试另一种 websockects 实现，你会推荐我? 高托克斯？

编辑2：

我现在正在使用 Gottox 的 socket.io 并且一切运行良好

如果有人想要它，我在这里提供 git 的链接：

[https://github.com/Gottox/socket.io-java-client](https://github.com/Gottox/socket.io-java-client)

# php - preg_replace 用 li 包装作为链接的图像

> ID：14550975
> 
> 赞同：0
> 
> 时间：2013-01-27T18:59:31.747
> 
> 标签：php, preg-replace

抱歉标题有点混乱，但我正在尝试使用 preg 替换将`<li></li>`标签包裹在作为链接（so `<a href="#"><img src="#" /></a>`）的图像周围，我尝试了以下代码：

```
preg_replace('/(<a [^>]+>)/','<li>\1</li>',$myVar ); 
```

但这有一个奇怪的结果——有人能指出我正确的方向吗？我知道它可以用 jQuery 完成，但我更喜欢 PHP 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:21:51.577

这可能会做到：

```
preg_replace('/<a(.*)>(.*)<\\/a>/','<li><a$1>$2</a></li>',$myVar ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T01:01:55.843

尽管你**永远不应该使用像**[@slugonamission](https://stackoverflow.com/users/235700/slugonamission)这样的正则表达式来解析一个html字符串，在评论中写道，这里：

```
$str = preg_replace('~<a .*?>\s*<img .*?>\s*</a>~i','<li>$0</li>',$str); 
```

# php - 为什么在 Zend Framework 2 中使用服务管理器？

> ID：14550978
> 
> 赞同：11
> 
> 时间：2013-01-27T18:59:47.020
> 
> 标签：php, service, zend-framework2, factory-pattern, service-management

假设我有一项服务：

```
namespace Helloworld\Service;

class GreetingService
{
    public function getGreeting()
    {
        if(date("H") <= 11)
            return "Good morning, world!";
        else if (date("H") > 11 && date("H") < 17)
            return "Hello, world!";
        else
            return "Good evening, world!";
    }
} 
```

我为它创建了一个可调用的

```
public function getServiceConfig()
{
    return array(
        'invokables' => array(
            'greetingService'
                => 'Helloworld\Service\GreetingService'
        )
    );
} 
```

然后在我的控制器中我可以这样做：

```
public function indexAction()
{
    $greetingSrv = $this->getServiceLocator()
        ->get('greetingService');

    return new ViewModel(
        array('greeting' => $greetingSrv->getGreeting())
    );
} 
```

据说这使控制器依赖于服务（和 ServiceManager）

更好的解决方案是为该服务创建工厂或在 ServiceManager 中返回一个闭包并在控制器中创建一个设置器：

```
class IndexController extends AbstractActionController
{
    private $greetingService;

    public function indexAction()
    {

        return new ViewModel(
            array(
                'greeting' => $this->greetingService->getGreeting()
            )
        );
    }

    public function setGreetingService($service)
    {
        $this->greetingService = $service;
    }
} 
```

和

```
'controllers' => array(
    'factories' => array(
        'Helloworld\Controller\Index' => function($serviceLocator) {
            $ctr = new Helloworld\Controller\IndexController();

            $ctr->setGreetingService(
                $serviceLocator->getServiceLocator()
                    ->get('greetingService')
            );

            return $ctr;
        }
    )
) 
```

我的问题是为什么？为什么第二种方法比第一种更好？这意味着什么`controller is dependent of the service`？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-27T19:26:02.877

`ServiceManager`默认情况下，它会注入到任何 ZF2 控制器中，因为它扩展了实现`AbstractController`接口`ServiceLocatorAwareInterface`。

第二种方法具有“[冗余](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)”的形式，因为除了已经可以访问`ServiceManager`实例之外，每当您需要在控制器之间共享服务时，您都需要为每个控制器配置注入机制。由于您的控制器已经对 ServiceManager 具有依赖关系，因此使用第一种方法并将您的域相关服务注册到`ServiceManager`，从而集中对服务层的访问会更有意义。

> [注意：答案的以下部分可能超出了问题的范围，但它旨在提供原始答案的“隐藏”背景。]

假设我们正在构建一个复杂的系统，在该系统中低耦合、可重用性和可测试性得到提升。我们的系统是多层的，我们构建了一切，直到服务层。请注意，到目前为止，我们还没有考虑“MVC”Web 层，甚至没有选择给定的框架。

在我们的服务层（我将考虑这一层，因为它是问题中提到的那个），我们假设我们采用了业务逻辑和对象图构造（或依赖解析）之间的分离[原则。](https://www.youtube.com/watch?v=wEhu57pih5w)所以我们可能有几个通过工厂构建的复杂服务。

现在我们的服务层已经构建好了，我们决定将它“插入”到 ZF2 之上。自然，我们的服务应该可以从控制器访问，正如您的问题所说明的那样，我们有不止一种方法可以做到这一点。但是，我们希望避免冗余并利用我们已经构建的内容。让我们假设以下工厂：

```
//The following class is a part of our Service layer
public class ComplexServiceFactory{

    private dependencyA;
    private dependencyB;

    public function buildComplexService()
    {
        $service = new ComplexService();
        $service->setDependencyA($this->dependecyA);
        $service->setDependencyB($this->dependecyB);
        return $service;
    }

} 
```

我们现在要做的只是调整（实际上扩展）我们的工厂，以便`ServiceManager`逻辑可以使用它。这个类可以被认为是用于将我们的系统“插入”到 ZF2 的机制的一部分（它实际上是一个[Adapter](http://en.wikipedia.org/wiki/Adapter_pattern)）

```
public class SMComplexServiceFactory extends ComplexServiceFactory implements
    Zend\ServiceManager\FactoryInterface
{

    public function createService(ServiceLocatorInterface $sm)
    {
        $this->setDependencyA($sm->get('dependecyA'));
        $this->setDependencyB($sm->get('dependecyB'));
        return parent::buildComplexService;
    }

} 
```

通过这样做，我们不会将对象图构造带到 MVC 层**（否则它将违反[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)和不必要的跨层耦合）**。服务管理器 + 我们的“适配”工厂类在某种意义上是我们的依赖解析机制。事实是我们的系统仍然是可移植的，例如我们可以选择另一个系统（另一个框架）并且相对于 MVC 平台具有较低的依赖性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-26T16:24:49.613

非常有用的问题。他一再被抚养长大。[我想你可以在这里](http://zend-framework-community.634137.n4.nabble.com/ZF2-Injecting-objects-to-a-controller-or-getting-objects-from-the-service-locator-td4656872.html)得到一个准确的答案

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-28T06:29:43.937

向@yechabbis 答案添加一些内容：

的工厂模式`ServiceConfiguration`确实适用于复杂的基础设施，或者只是不使用`closures`/`callable functions`在配置中。这有两个原因：

*   可读性/更简洁的代码
*   表现

在里面设置工厂模式`getServiceConfig`很好，干净，快速。没有类被实例化，但会在调用服务密钥时实例化。但是，如果您使用闭包模式或可调用函数设置服务，那么这些类将始终在每次请求时实例化！

这可能只是一个示例，但您显示的代码也最好用作`ViewHelper`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-14T15:45:33.177

我认为第二种方法更好，它使控制器类独立于 GreetingService。当您想使用另一个由控制器使用的问候服务时，此方法将很有用。您根本不需要更改控制器类中的代码，而是通过使用该工厂关闭更改服务管理器来做到这一点。

我相信这是控制反转或依赖注入的主要思想，所有的布线和配置都是在类之外完成的（在这种情况下：控制器类）。

所以，在我看来，这就是为什么第二种方法更好的原因。

# python - python web.py 异步执行外部程序

> ID：14550979
> 
> 赞同：0
> 
> 时间：2013-01-27T18:59:48.847
> 
> 标签：python, linux, web.py

我有一个 web.py 应用程序在内置的cherrypy 服务器上运行。我想在用户发布到 url 时执行一个外部脚本，该脚本将在 python 子进程的后台运行。Popen 调用和 web.py 将重定向到另一个页面，在该页面中使用 jquery 监视脚本的进度阿贾克斯请求。但我无法在这里正确实施。代码片段如下，如果需要，我可以提供更多信息。

```
 import web
    from multiprocessing import Process
    import subprocess, shlex
    import time, json
    from login import authorize, sessidGen

    def __callProcess(processString,mod='w',shell=False):
        if not shell: args = shlex.split(processString)
        else: args = processString
        out = open('./bteq/logs/output.log',mod)
        err = open('./bteq/logs/error.log',mod)
        p = subprocess.Popen(args,stdout=out,stderr=err,shell=shell)
        return p

    def setExec():
        __callProcess("chmod +x ./bteq/*.sh",shell=True)

    def bteqExec(filename,system):
        if system not in ['prod','da','cdw','cdw2','cert','']: return False
        processString = " ".join([filename,system])
        p = __callProcess(processString)
        return p.pid

    render = web.template.render('templates/',base='layout')
    render_plain = web.template.render('templates/')

    class Executor:     
        def GET(self):
            authorize()
            session = web.ctx.session
            inputs = web.input(sessid={},type={})
            if not inputs.sessid or session.id != inputs.sessid: web.seeother('/')
            if inputs.sessid and inputs.type:
                return render.executor('BTEQ Executor',inputs.type,inputs.sessid)
            else: raise web.seeother('/')

        def POST(self):
            authorize()
            session = web.ctx.session
            inputs = web.input(sessid={},type={},act={})
            if not inputs.sessid or session.id != inputs.sessid: web.seeother('/')
            if inputs and inputs.act == 'start':
                pid = bteqExec('python ./bteq/timer.py','')
                session.id = sessidGen()
                session.exctrpid = pid
                return web.seeother('/progress.htm')
            else: raise web.seeother('/')

    class progress:
        def GET(self):
            authorize()
            session = web.ctx.session
            inputs = web.input(ajax={})
            if inputs.ajax == 'true': 
                web.header('Content-Type', 'application/json')
                if session.count >= 100: session.count = 0
                session.count += 10
                pid = session.exctrpid
                out = open('./bteq/logs/output.log','r')
                err = open('./bteq/logs/error.log','r')
                output = ('<strong>OUTPUT:</strong><br>'+out.read()).replace('\n','<br>')
                err = err.read()
                if err:error = ('<strong>ERRORS:</strong><br>'+err.read()).replace('\n','<br>')
                else: error = None
                d = {'count':session.count,'msg':output,'err':error,'rc':pid,'session_id':session.session_id}
                return json.dumps(d)
            r = web.template.Template('$def with (title)\n$var title: $title\n')
            return render_plain.layout_pgbar(r('progress test')) 
```

由于 subprocess.Popen 对象不可腌制，因此无法将其作为会话变量放入，我想从进度类中获取 p.poll() 和 p.stdout.read() 。

此外，我希望代码可在 linux 和 windows 中运行，我在 windows 中设置了我的开发设置，并将其部署在 linux 服务器上。

有人可以在这里帮我吗...

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:13:51.773

我把它变成了一个*多* **处理进程**，并从生成的进程中为*子*进程执行*p.wait()*，生成的进程负责其余的步骤并将结果更新到数据库中。

 *web.py 进度页面将在数据库中检查执行进度，从而解决。

代码：

```
from multiprocessing import Process

class ProcHandler(Process):
    def __init__(self,  *args, **kwargs):
        #Initialize 
        Process.__init__(self, *args, **kwargs)

    def run(self):
        p = bteqExec('python ./bteq/timer.py','')
        rc = p.wait()
        # do update the resulting to database. and make the web.py 
        # Progress class read from database entry made by this Process.
        return 
```*

# php - SQL Select 查询返回不需要的数据

> ID：14550981
> 
> 赞同：0
> 
> 时间：2013-01-27T18:59:54.117
> 
> 标签：php, mysql, select, pdo

我有一个表，其中填充了从数据库中选择学生编号的查询中的数据。视图是这样的：

![图片](../Images/ed522df0238009466df87f88c95b70bd.png)

如您所见，同一条数据被多次输出。我有一个功能，无论出于何种原因，辅导员都无法完成学生，然后他们可以将学生发送给另一位辅导员。现在为了维护历史数据，我保留了所有这些数据。现在，当我回到我的学生队列时，它会显示所有当前数据（我想要的）和所有过去的历史数据（我不想要的）

这是我的 sql 语句：

```
 try 
                {
            $query = $dbh->prepare("SELECT 
        session.session_id AS id, 
        session.anum, 
        student.first, 
        student.last, 
        session.why, 
        session.studentcomments, 
        session.aidyear,
        support.counselorcomments 
        FROM 
        student INNER JOIN session ON student.anum = session.anum 
        INNER JOIN session_status ON session.status = session_status.status 
        LEFT JOIN support ON session.session_id = support.session_id
        WHERE session.status = 0 OR session.status = 2");

    $query->execute();
            $result = $query->fetchall();
                }
                    catch (PDOException $e) {
                    error_log($e->getMessage());
                    die($e->getMessage());
} 
```

现在我设置数据库的方式是我希望它保持工作状态。我只是认为我查询数据的方式是问题所在。

这是mysql中数据的图片：

![在此处输入图像描述](../Images/c5b9c7ba4a90d11d36149abe7fe9fefe.png)

**编辑**

现在，由于该问题已得到解决，因此我遇到了一个错误，即每当发生插入时（更新 support.starttime 时间戳），上述记录就会消失，这是我更新的 sql

```
$query = $dbh->prepare("SELECT session.session_id AS id, session.anum, student.first, student.last, session.why, 
                        session.studentcomments, session.aidyear, support.counselorcomments FROM student LEFT JOIN 
                        session ON student.anum = session.anum LEFT JOIN session_status ON 
                        session.status = session_status.status LEFT JOIN support ON session.session_id = support.session_id
                        WHERE (session.status) IN (0) OR (session.status) IN (2) 
                        AND support.starttime = (SELECT MAX(support.starttime) FROM support INNER JOIN session ON session.session_id = 
                        support.session_id)"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T19:13:22.773

如果我正确阅读了您的问题，您只需要 Session 表中的最新行，对吗？

如果是这样，您将需要在 Where 子句中实现子选择以获取 MAX(session.starttime)。

如果是这种情况，您可以使用以下语法：

```
WHERE ...(what you already have)...
  AND session.startime = (SELECT MAX({YourTable}.starttime)
                            FROM {YourTable}
                           WHERE {YourTable}.anum = session.anum) 
```

如果我有所有涉及的表的详细信息，我会为您编写整个查询。这回答了你的问题了吗？

更新答案：

您必须告诉子查询您想要开始时间的 session_id，您可以通过将子查询表与主查询结果集连接来做到这一点。

您的子查询应该是：

(SELECT MAX(a.starttime) FROM 支持 WHERE a.session_id = session.session_id)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T00:12:48.003

```
SELECT DISTINCT 
    session.session_id as id,
    session.anum,
    student.first,
    student.last,
    session.why,
    session.studentcomments,
    session.aidyear,
    support.counselorcomments
FROM student
        INNER JOIN session 
            ON student.anum = session.anum
        LEFT JOIN support 
            ON session.session_id = support.session_id
        WHERE session.status IN (0,2) 
```

像 ALberto 告诉我的那样使用 DISTINCT！谢谢阿尔贝托

# sql-server - Microsoft SQL Server 管理工作室 (T-SQL)

> ID：14550992
> 
> 赞同：0
> 
> 时间：2013-01-27T19:01:14.880
> 
> 标签：sql-server, tsql, ssms

![在此处输入图像描述](../Images/3f2ea219201c2a7282c85f08a41ed986.png)

如何连接或建立以下表格的关系：

第一个表称为`Case`：

```
CaseID,
Name,
Number of hours 
```

第二个表称为`professor case`：

```
professorID,
CaseID 
```

第三张表称为`professor`：

```
professsorID,
name,
Lastname 
```

这是应该的样子，我不知道如何连接它们

![第二](../Images/21fe4c384678a5c65f04e9ac7adb3ba2.png)

![瑟](../Images/44fdcb42005f360831583fd26960736f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T19:06:09.617

如果您问如何`join`使用`professor`和`Case`表，请执行以下操作：

```
SELECT 
  professor.name,
  professor.Lastname,
  case.Name,
  case.NumberOfHours
FROM
  Professor professor
    INNER JOIN ProfessorCase pc ON pc.professorId = professor.professorId
    INNER JOIN Case case ON pc.CaseId = case.CaseId 
```

这为您提供了与教授相关的所有案例。