# StackOverflow 问答 14824000-14824999

# c - 如何从c中的另一个结构访问指向结构的双指针

> ID：14824005
> 
> 赞同：0
> 
> 时间：2013-02-12T01:25:32.073
> 
> 标签：c, pointers, structure

错误是：请求成员“a”不是结构或联合。

```
#include<stdio.h>

typedef struct mia {
    int a;
}hola;

typedef struct m {
    hola **r;
}bic;

int main() {
    bic y;
    scanf("%d", &(y.r->a));
    printf("%d", (y.r->a));
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:28:50.640

为此，您将需要更复杂的语法：

```
int main()
{
    hola x;
    hola *ptr = &x;
    bic y = { &ptr };

    scanf("%d", &((*y.r)->a));
    printf("%d\n", (*y.r)->a);
    printf("%d\n", ptr->a);
    printf("%d\n", x.a);

    return 0;
} 
```

**输入**

```
100 
```

**输出**

```
100
100
100 
```

请注意，您可以取出`hola *`指针：

```
hola *ptr = *y.r;
printf("%d", ptr->a); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T01:32:44.067

在开始从指针访问数据之前，您需要先分配一些内存；否则，这是未定义的行为。您当前的结构需要两级分配 - 一个用于指向 的指针`hola`，另一个用于`hola`自身。您还需要添加另一个级别的取消引用，因为`->`适用于指向`struct`s 的指针，而不是指向指向`struct`s 的指针的指针：

```
bic y;
y.r = malloc(sizeof(hola*));
*y.r = malloc(sizeof(hola));
// You need an extra level of dereference (i.e. an asterisk)
scanf("%d", &((*y.r)->a));
printf("%d", ((*y.r)->a));
// Don't forget to free the memory you allocated,
// in reverse order:
free(*y.r);
free(y.r); 
```

这是[关于 ideone 的演示](http://ideone.com/yR7kkY)。

# mysql - PHP：查看不成功的电子邮件

> ID：14824006
> 
> 赞同：2
> 
> 时间：2013-02-12T01:25:35.500
> 
> 标签：mysql, php

我试图弄清楚如何显示发送的不成功电子邮件列表以及测试它的方法。我可以显示已发送电子邮件的列表，但我不确定如何检索未成功发送的电子邮件列表。

这是我用来从 mysqldb 中检索它的内容：

```
 //get the email address list
            $query = "SELECT email FROM users 
                    WHERE id IN (SELECT participant_id FROM roster AS ur WHERE ur.roster_id=".$roster['roster_id'].")";
            $result = mysql_query($query);
            $emailstring2 = "";
            $email2 = $result;
            while ($row = mysql_fetch_object($email2)){
            $emailstring2 .= $row->email. "\n ";
} 
```

在消息部分，我通过以下方式检索它：

```
 $message .="Successful emails: \n".$emailstring2." \r\n"; 
```

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T01:26:40.403

一个关键字将为您提供未发送的关键字：[`NOT`](http://dev.mysql.com/doc/refman/5.0/en/logical-operators.html#operator_not)

```
WHERE id NOT IN 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:15:28.333

您不能以这样的简单方式从 PHP 中执行此操作。

把它想象成一封通过邮政服务的信。你所能做的就是把信交给邮递员，并希望它到达目的地。邮递员不会回来告诉您投递是否成功，或者收件人是否真的阅读了这封信。PHP 的 mail() 函数（及其派生函数）返回 TRUE 以指示消息已被接受以进行传递尝试，*而不是*成功传递。（交付可能需要数小时或数天才能完成。）

因此，您能做的最好的事情就是大致的交货通知。有几种方法可以做到这一点：

*   在电子邮件中使用跟踪像素，当用户打开邮件时会被 ping 通。然而，鉴于现在大多数电子邮件客户端默认“不显示图像”，我认为这种技术相当不可靠。
*   使用收件人唯一的退回地址发送每封邮件。如果邮件无法投递，它将返回到自定义地址——并且该返回消息可用于指示原始收件人的电子邮件地址不正确。这可能是最准确的方法，但配置起来并不简单。
*   使用退货收据。就像跟踪像素一样，我认为大多数电子邮件客户端默认从不发送这些，因此这也可能不可靠。
*   使用交货状态通知。这将需要使用支持它的服务器并将其发送到支持它的服务器。
*   通过将为您进行此类跟踪的服务发送您的邮件。（例如 MailChimp 或持续联系）

# c# - 使用 C# 将文本框值转换为 Windows 应用商店中的另一种数据类型

> ID：14824013
> 
> 赞同：0
> 
> 时间：2013-02-12T01:26:23.707
> 
> 标签：c#, windows-8, textbox, windows-store-apps, windows-store

对不起这个问题。我只是对 Windows 商店中将值从文本框转换或解析为 int、float、double 等的代码感到困惑。我是 C# 用户，我尝试了这段代码

```
block1 = Convert.ToDouble(text1.Text); or block1 = double.Parse(text1.Text); 
```

这些方法对我不起作用，有人可以帮助我吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:38:24.357

如果您希望能够轻松选择要将字符串转换为（int、double、float）的类型，您可以创建一个简单的方法来转换字符串。

就像是

```
private T ConvertTo<T>(string value) where T : IConvertible
{
    try
    {
      return (T)Convert.ChangeType(value, typeof(T));
    }
    catch (Exception)
    {
    }
    return default(T);
} 
```

用法：

```
string value = "33";

int intVal = ConvertTo<int>(value);
float floatVal = ConvertTo<float>(value);
double doubleVal = ConvertTo<double>(value); 
```

# c++ - 腻子 - 看不到错误堆栈跟踪的顶部

> ID：14824021
> 
> 赞同：-1
> 
> 时间：2013-02-12T01:27:00.280
> 
> 标签：c++, compiler-errors, putty

我正在使用 Putty 进行编码（在 C++ 中，它的价值），我目前遇到一个错误，它给了我一个非常长的堆栈跟踪。显然，跟踪太长了，Putty 不会让我滚动到它起源的最顶部（我输入“make”的地方）。有没有办法解决这个问题（除了明显地修复错误）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:32:09.783

有两种方法。

1.  更改窗口缓冲区大小。打开Putty，加载连接（不要双击或点击打开），单击`Window`左侧面板并将其增加到`Lines of scrollback`3000（我认为默认值为200）。
2.  同样，加载连接，然后在左侧面板上的会话下，您将有一个子类别`logging`，您可以在其中设置一个文件，其中将记录整个会话历史记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T01:38:40.163

要增加回滚的行数，在建立腻子连接之前，单击类别窗口并将回滚的行增加到 10000 或 20000，这可能适合您。

# c++ - 将字符串转换为 wchar_t（宽字符）C++

> ID：14824022
> 
> 赞同：0
> 
> 时间：2013-02-12T01:27:09.477
> 
> 标签：c++

我想知道如何转换`string str = "whatever"`为，`wchar_t`以便字符串可以存储为`wchar_t chResponse[] = ...(converted from string)..`

我正在尝试以下代码：

```
string str = "whatever";
std::wstring_convert<std::codecvt_utf8<wchar_t>> utf8conv;
auto w_result = utf8conv.from_bytes(str); // convert utf8 to wchar_t
wchar_t chResponse[] = w_result; 
```

它给了我这个错误：

```
error C2075: 'chResponse' : array initialization needs curly braces 
```

# javascript - 使用 HTML5 拖放 api 时滚动页面

> ID：14824023
> 
> 赞同：0
> 
> 时间：2013-02-12T01:27:09.097
> 
> 标签：javascript, html, drag-and-drop

我正在使用[HTML5 Sortable](http://farhadi.ir/projects/html5sortable/)重新排列列表水平列表中的项目。该列表是一个时间线，并从屏幕左右溢出。

是否有插件或技术可以在拖动对象时在时间轴上向左或向右滚动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:39:35.993

拖动和滚动 div 的实现：

[http://hitconsultants.com/dragscroll_scrollsync/scrollpane.html](http://hitconsultants.com/dragscroll_scrollsync/scrollpane.html)

插入：

[http://plugins.jquery.com/project/Dragscrollable](http://plugins.jquery.com/project/Dragscrollable)

# bit-manipulation - 用于 4 位 LCD 控制的 PIC 位掩码和移位

> ID：14824025
> 
> 赞同：0
> 
> 时间：2013-02-12T01:27:25.857
> 
> 标签：bit-manipulation, pic, masking, bit-shift, lcd

我有一个关于掩码和位移的问题。

我有以下代码：

```
void WriteLCD(unsigned char word, unsigned commandType, unsigned usDelay)
{
    // Most Significant Bits
    // Need to do bit masking for upper nibble, and shift left by 8.
    LCD_D = (LCD & 0x0FFF) | (word << 8);
    EnableLCD(commandType, usDelay); // Send Data

    // Least Significant Bits
    // Need to do bit masking for lower nibble, and shift left by 12.
    LCD_D = (LCD & 0x0FFF) | (word << 12);
    EnableLCD(commandType, usDelay); // Send Data
} 
```

“字”为 8 位，通过 4 位 LCD 接口输入。这意味着我必须在发送数据之前将最高有效位和最低有效位分开。

LCD_D 是一个 16 位数字，其中只有我传递给它的最重要的位我想要真正“做”一些事情。我希望保留之前的 12 位，以防他们在做其他事情。

在将上下半字节适当地传递给 LCD_D 方面，我的位屏蔽和移动“字”的逻辑是否正确？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T08:38:15.433

在这两种情况下，除了需要在移位之前将“word”转换为无符号短（16 位）之外，看起来还可以，这样移位就不会在 char 上执行并丢失数据。例如：

```
LCD_D = (LCD & 0x0FFF) | ((unsigned short) word << 8); 
```

# php - Zend Framework 2 记录到 MySQL DB 的附加列插入 null

> ID：14824026
> 
> 赞同：0
> 
> 时间：2013-02-12T01:27:29.517
> 
> 标签：php, mysql, zend-framework2

我有以下代码部分，我正在努力从 Paypal 事务中写入 MySQL 数据库。我只包含了相关的 Zend DB 日志部分，Paypal 界面工作正常，根据数据输出。

```
$paypalLog = array(
'transactionId' => 'transactionId',
'transactionType'  => 'transactionType',
'paymentType'   => 'paymentType',
'orderTime' => 'orderTime',
'amt' => 'amt',
'currencyCode' => 'currencyCode',
'feeAmt' => 'feeAmt',
'taxAmt' => 'taxAmt',
'paymentStatus' => 'paymentStatus',
'pendingReason' => 'pendingReason',
'reasonCode' => 'reasonCode'
);    

$data = array(
        'transactionId' => $transactionId,
        'transactionType'  => $transactionType,
        'paymentType'   => $paymentType,
        'orderTime' => $orderTime,
        'amt' => $amt,
        'currencyCode' => $currencyCode,
        'feeAmt' => $feeAmt,
        'taxAmt' => $taxAmt,
        'paymentStatus' => $paymentStatus,
        'pendingReason' => $pendingReason,
        'reasonCode' => $reasonCode
        );

     $mapping = array(
        'message'   => 'message',
        'extra' => $data);

     print_r($mapping);

     $writer = new Zend\Log\Writer\Db($db, 'paypal', $paypalLog);
     $logger = new Zend\Log\Logger();
     $logger->addWriter($writer);
     $logger->info($mapping); 
```

当我运行我的代码时，打印返回以下内容，因此数据可用

```
Array ( [message] => message [extra] => Array ( [transactionId] => 03V084280U905161H [transactionType] => expresscheckout [paymentType] => instant [orderTime] => 2013-02-12T01:16:40Z [amt] => 9.00 [currencyCode] => AUD [feeAmt] => 0.52 [taxAmt] => 0.00 [paymentStatus] => Completed [pendingReason] => None [reasonCode] => None ) ) 
```

我的表定义如下，并且我已授予用户完全权限。

```
CREATE TABLE `paypal` (
  `timestamp` varchar(45) DEFAULT NULL,
  `priority` varchar(45) DEFAULT NULL,
  `priorityName` varchar(45) DEFAULT NULL,
  `message` varchar(45) DEFAULT NULL,
  `transactionId` varchar(45) NOT NULL,
  `transactionType` varchar(45) DEFAULT NULL,
  `paymentType` varchar(45) DEFAULT NULL,
  `orderTime` datetime DEFAULT NULL,
  `amt` varchar(45) DEFAULT NULL,
  `currencyCode` varchar(45) DEFAULT NULL,
  `feeAmt` varchar(45) DEFAULT NULL,
  `taxAmt` varchar(45) DEFAULT NULL,
  `paymentStatus` varchar(45) DEFAULT NULL,
  `pendingReason` varchar(45) DEFAULT NULL,
  `reasonCode` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`transactionId`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1$$ 
```

但是，当我在 MySQL 方面运行跟踪时，它只是不断尝试插入空值。

```
130212 12:19:38    29 Connect   user@localhost on database
       29 Query INSERT INTO `paypal` () VALUES ()
       29 Quit 
```

欢迎任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T07:07:12.770

感谢 cathulhu 的投入，非常感谢，我通过以下方式完成了这项工作

```
 // Array of db columns
  $paypalLog = array('transactionId' => 'transactionId',
    'transactionType'  => 'transactionType',
    'paymentType'   => 'paymentType',
    'orderTime' => 'orderTime',
    'amt' => 'amt',
    'currencyCode' => 'currencyCode',
    'feeAmt' => 'feeAmt',
    'taxAmt' => 'taxAmt',
    'paymentStatus' => 'paymentStatus',
    'pendingReason' => 'pendingReason',
    'reasonCode' => 'reasonCode'
    );  

  // Map data into array matching column names
  $data = array(            
        'transactionId' => $transactionId,
        'transactionType'  => $transactionType,
        'paymentType'   => $paymentType,
        'orderTime' => $orderTime,
        'amt' => $amt,
        'currencyCode' => $currencyCode,
        'feeAmt' => $feeAmt,
        'taxAmt' => $taxAmt,
        'paymentStatus' => $paymentStatus,
        'pendingReason' => $pendingReason,
        'reasonCode' => $reasonCode
        );

     // Array to construct the DB logger table structure with extra columns
    $mapping = array(   
        'timestamp' => 'timestamp',
        'priority'  => 'priority',
        'priorityName'  => 'priorityName',
        'message'   => 'message',
        'extra' => $paypalLog);      

     // Array to log actual data
     $mylog = array(
        'message' => 'some msg',
        'extra' => $data);

     // Configure the write/logger and specify the array members to log
     $writer = new Zend\Log\Writer\Db($db, 'paypal', $mapping);
     $logger = new Zend\Log\Logger();
     $logger->addWriter($writer);
     $logger->info($mylog['message'], $mylog['extra']); 
```

我现在从 MySQL 常规日志中看到了这个输出

```
Connect user@localhost on database
       54 Query INSERT INTO `paypal` (`timestamp`,`priority`,`priorityName`,`message`,`transactionId`,`transactionType`,`paymentType`,`orderTime`,`amt`,`currencyCode`,`feeAmt`,`taxAmt`,`paymentStatus`,`pendingReason`,`reasonCode`) VALUES ('2013-02-15T07:52:52+01:00','6','INFO','My log message','88L4229675348363C','expresscheckout','instant','2013-02-15T06:52:58Z','9.00','AUD','0.52','0.00','Completed','None','None')
       54 Quit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T13:25:49.707

尝试替换这一行：

```
$logger->info($mapping); 
```

和：

```
$logger->info($mapping['message'], $mapping['extra']); 
```

Zend/Logger 的 info 方法期望接收两个单独的参数。

**编辑：**

进一步查看您的代码，我发现了另一个问题。列图只是一种原型。您真正想要记录的是您的数据和一些日志消息，对吗？

```
 $mapping = array(
        'message'   => 'message',
         'extra' => $paypalLog);      // Not $data !

    $mylog = array(
        'message' => 'My log message',
        'extra' => $data); 
```

进而：

```
 $writer = new \Zend\Log\Writer\Db($db, 'paypal', $mapping); // Writer needs mapping info, not data :-)
    $logger = new \Zend\Log\Logger();
    $logger->addWriter($writer);
    $logger->info($mylog['message'], $mylog['extra']);    // ...and your log record goes here, to logger instance 
```

# java - 将肥皂消息作为字符串处理

> ID：14824033
> 
> 赞同：1
> 
> 时间：2013-02-12T01:28:51.810
> 
> 标签：java, jax-ws, webservice-client

是否可以在将 Jax-WS 生成的 SOAP 消息作为字符串发送到服务器之前对其进行操作？我想在消息发送之前截取消息并修改一些标签。

我想这样做是因为我需要向服务器发送一个 SOAP 请求。这个请求的一个标签有很多xml文档作为它的内容。对于每个文档，我需要在一些标签中重新声明命名空间（Jax-WS 智能地只声明一次）。我不能使用任何前缀。我也需要签署xml。如果我可以将消息作为字符串进行操作，那么所有这些问题都会更容易解决。

我已经看到与axis类似的东西，但我没有找到如何使用Jax-WS来做到这一点。

谢谢你。

**更新：**我已经尝试过使用处理程序（SOAP 和逻辑处理程序）。我的问题是，即使我使用处理程序修改了消息，Jax-WS 也会更改消息。我的肥皂消息的正文需要如下所示：

```
<soap12:Body>
  <cteDadosMsg xmlns="http://www.portalfiscal.inf.br/cte/wsdl/CteRecepcao">
      <enviCTe xmlns="http://www.portalfiscal.inf.br/cte" versao="1.04">
         <idLote>1</idLote>
         <CTe  xmlns="http://www.portalfiscal.inf.br/cte">
         </CTe>
         <CTe  xmlns="http://www.portalfiscal.inf.br/cte">
         </CTe>
      </enviCTe>
   </cteDadosMsg>
</soap12:Body> 
```

看我的 CTe 标记需要重复命名空间声明（与 enviCTe 使用的相同）。我尝试执行以下步骤：

1) 使用 Jaxb 创建了包含 enviCTe 的文档。

2）将其转换为字符串并调整CTe标签的命名空间声明（使用String.replace）。

3) 将 xml 字符串添加到 cteDadosMsg。Jax-WS 对字符进行转义（例如替换 < `&lt;`）。Web 服务不理解带有转义字符的 xml。

4) 添加了一个LogicalHandler 用于解除payload 的转义（替换`&lt;`为< 等等）。

5) 完成此操作后，**Jax-WS 再次调整命名空间声明**，我的 CTe 标记的 xmlns 属性消失。:P 那是我的问题。Jax-WS 甚至在使用处理程序修改消息之后“修复”消息。

我没有将 Jaxb 生成的 xml 添加为字符串，而是尝试将其添加为 Document。我没有转义的问题，但我仍然无法为每个 CTe 标记重复命名空间声明。当我解决这个问题时，我仍然必须签署 xml 的一些标签。所以我真的很想在消息发送之前拦截消息并将其修改为字符串。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:39:26.797

您可以使用`Handlers`. 有关详细信息，请参阅[此处](http://jax-ws.java.net/articles/handlers_introduction.html)。

# css - Firefox 是否支持修饰二级列表，例如。li ul li > 一个

> ID：14824035
> 
> 赞同：0
> 
> 时间：2013-02-12T01:29:22.977
> 
> 标签：css

无法让firefox在2级菜单上使用css，即chrome确实使用css，但firefox忽略它有什么想法吗？它的悬停部分似乎不支持是否有其他编写方式？

```
/* Level 2 */
.accordion li ol li { 
background: #eeeeee;
font-size: 12px; 
font-family:Verdana, Geneva, sans-serif;
}

.accordion li ol li:hover { 
background: #ffffff;
}
.accordion li ol li > a { 
background: #ffffff;
color: #777777;
font-size: 12px; 
font-family:Verdana, Geneva, sans-serif;
transition: color ease-in 99999999s
}
.accordion li ol li:hover > a { 
color: #5CACFC;
} 
```

# javascript - 使用 Javascript 在 Windows 8 应用程序中获取计算机制造商和型号#

> ID：14824036
> 
> 赞同：2
> 
> 时间：2013-02-12T01:29:26.550
> 
> 标签：javascript, windows

我正在尝试获取有关运行我的应用程序的计算机/平板电脑的信息。这是出于分析目的。具体来说，我想知道制造商和型号。

理想情况下，我会得到如下信息：

```
Manufacturer: Toshiba
Model: Satellite S850-BT3N22 
```

但我会拿走我能得到的任何东西。我花了一些时间尝试自己的解决方案以及在 SO 上找到它，但我无法找到解决方案。

我花了一些时间试图得到这个：

```
var hardwareToken = Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null);
var idReader = Windows.Storage.Streams.DataReader.fromBuffer(hardwareToken.id);        
var idArray = new Array(hardwareToken.id.length);
idReader.readBytes(idArray); 
```

所以现在 idArray 是一个整数数组。我试过将此字节数组转换为字符串，但它会将其转换为一堆看起来像汉字的东西。我不认为这就是这个 hardwareToken.id 的目的。以下是 idReader 数组的 javascript 控制台的示例输出：

```
idArray.toString();
"3,0,26,139,5,0,90,224,6,0,1,0,4,0,246,50,1,0,248,181,2,0,80,124,9,0,250,137" 
```

我尝试的下一件事是在此处从 msdn 模拟“设备枚举示例”：http: [//code.msdn.microsoft.com/windowsapps/Device-Enumeration-Sample-a6e45169](http://code.msdn.microsoft.com/windowsapps/Device-Enumeration-Sample-a6e45169)

从这里我可以看到我的网络上的几个不同的设备，我可以得到 System.ItemNameDisplay 和 System.Devices.ModelName，但是我看不到区分哪个设备是计算机的方法。它提供了所有的 Pnp 设备。

如果有人可以帮助我获得这些信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T01:39:18.927

您可以尝试使用[BrowserSpy 之](http://browserspy.dk/)类的工具来获取此信息。他们几乎处于该领域的前沿。

据我所知，没有纯粹的 Javascript 方法可以做到这一点。

[您可以在此处](http://msdn.microsoft.com/en-us/library/windows/apps/jj553431)找到更多信息。

就您指定的呼叫而言，您可以找到以下信息：

```
CPU ID of the processor
Size of the memory
Serial number of the disk device
Network adapter (such as NIC MAC address)
Audio adapter
Docking station
Bluetooth address
Mobile broadband device ID
BIOS 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:05:33.263

我得到了一个答案：

使用 Windows.Security.ExchangeActiveSyncProvisioning.EasClientDeviceInformation，如下所示：

```
var deviceInfo = new Windows.Security.ExchangeActiveSyncProvisioning.EasClientDeviceInformation();
var manufacturer = deviceInfo.systemManufacturer;
var productName = deviceInfo.systemProductName; 
```

这是样本数据：

```
manufacturer: SAMSUNG ELECTRONICS CO., LTD.
productName: 700Z3A/700Z4A/700Z5A/700Z5B 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T20:58:46.237

我今天不得不处理这个。关键是查看 DeviceContainer 上的 System.Devices.LocalMachine 属性，如果设备代表本地系统，则该属性为真（请参阅设备容器属性）。

下面是一个基于 MS 设备枚举示例的简单粗暴的 C# 示例；希望获取该示例的 JS 版本并以相同的方式对其进行调整应该很容易：

```
string[] properties = { "System.Devices.LocalMachine", "System.ItemNameDisplay", "System.Devices.ModelName", "System.Devices.ModelNumber", "System.Devices.Manufacturer" };
var containers = await PnpObject.FindAllAsync(PnpObjectType.DeviceContainer, properties);

foreach (PnpObject container in containers)
{
    bool localMachine = (bool)container.Properties["System.Devices.LocalMachine"];
    if (localMachine)
    {
        string name = (string)container.Properties["System.ItemNameDisplay"];
        string modelName = (string)container.Properties["System.Devices.ModelName"];
        string modelNumber = (string)container.Properties["System.Devices.ModelNumber"];
        string manufacturer = (string)container.Properties["System.Devices.Manufacturer"];
        // do as you like now...
        break;
    }
} 
```

# c++ - 如何为模板类编写复制构造函数 - C++

> ID：14824040
> 
> 赞同：0
> 
> 时间：2013-02-12T01:29:50.123
> 
> 标签：c++, templates, copy-constructor

在我的头文件中，我有

```
template <typename T>
class Vector {
    public:
         // constructor and other things

         const Vector& operator=(const Vector &rhs);   
}; 
```

这是我迄今为止尝试过的一个声明

```
template <typename T> Vector& Vector< T >::operator=( const Vector &rhs )
{
    if( this != &rhs )
    {
        delete [ ] array;
        theSize = rhs.size();
        theCapacity = rhs.capacity();

        array = new T[ capacity() ];
        for( int i = 0; i < size(); i++ ){
            array[ i ] = rhs.array[ i ];
        }
    }
    return *this;
} 
```

这就是编译器告诉我的

```
In file included from Vector.h:96,
                 from main.cpp:2:
Vector.cpp:18: error: expected constructor, destructor, or type conversion before ‘&amp;’ token
make: *** [project1] Error 1 
```

如何正确声明复制构造函数？

注意：这是一个项目，我不能更改标题声明，所以像这样的建议[虽然](https://stackoverflow.com/questions/12892942/c-template-class-copy-constructor-and-assignment-operator)有用，但在这个特定情况下没有帮助。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:41:59.390

*注意：您声明一个赋值运算符，而不是复制构造函数*

1.  `const`您在返回类型之前错过了限定符
2.  你错过了`<T>`返回类型和函数参数的模板参数（）

用这个：

```
template <typename T>
const Vector<T>& Vector<T>::operator=(const Vector<T>& rhs) 
```

# javascript - 如何在 HTML 中旋转表格中的列文本

> ID：14824044
> 
> 赞同：2
> 
> 时间：2013-02-12T01:30:03.663
> 
> 标签：javascript, jquery, html, jquery-ui, css

我厌倦了尝试从 html 中的表格中旋转列文本。

这就是我所拥有的，它只适用于 chrome 和 Firefox，但不适用于 IE9。 [http://contoso2.azurewebsites.net/scores/listscores](http://contoso2.azurewebsites.net/scores/listscores)

我看到了这些关于垂直文本的例子。我正在使用 IE9，它看起来不错，我想他们正在使用类似画布的东西，我真的不确定。

[http://jsfiddle.net/R4JvP/11/](http://jsfiddle.net/R4JvP/11/) [http://www.ok-soft-gmbh.com/jqGrid/CheckboxesWithVerticalHeaders1.htm](http://www.ok-soft-gmbh.com/jqGrid/CheckboxesWithVerticalHeaders1.htm)

第二个链接是我感兴趣的显示`rotation: (-90)deg`如何在所有浏览器中实现此功能中的所有标题列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T14:20:00.353

你可以使用`-ms-transform: rotate(-45deg);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T14:22:53.313

```
-moz-transform: rotate Firefox 4+
-webkit-transform: rotate Safari 5+, Chrome 10+
-ms-transform: rotate Internet Exlorer 9+
transform: rotate 
```

# javascript - 浏览到同一页面而不刷新

> ID：14824047
> 
> 赞同：1
> 
> 时间：2013-02-12T01:30:08.533
> 
> 标签：javascript, asp.net, html

我是 ASP、JS、HTML5 的菜鸟。我正在编写一个由 ASP.net 驱动并具有 Prev 和 Next 按钮的快速内部网站。每次用户按下 Next 按钮时，都需要滚动到下一个书签。但是，在我看来，页面每次都从服务器刷新。

在不刷新的情况下创建指向同一页面的 JavaScript 链接最直接的方法是什么？目前我有 id 像'#1'这样的跨度，我正在使用

`button onclick="JavaScript:window.location.hash = '#1'`

我尝试了很多变化，但似乎都没有。

请注意：我只是想导航到同一页面上的书签。没有数据需要去服务器，页面也不需要以任何方式改变。

（编辑：将代码中的“替换”更改为“哈希”，因为这会引起混淆）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T01:53:04.043

不要使用`window.location.replace`，而是尝试简单地分配给`window.location`or`window.location.href`或`window.location.hash`。

恐怕其他回答者要么不理解问题，要么不理解问题。当然，您可以跳转到由 ID 标识的页面上的某个位置，而无需重新加载它。这是浏览器如何工作的基础。这是 window.location.reload 函数存在的原因之一，因此如果需要，您可以重新加载它。您也不限于使用 href 导航到 ID；当然你可以用 window.location 来做（只是不能用 window.location.replace）。

更新：您尝试做的事情没有任何问题，并且页面不应该重新加载。您的页面中一定有其他东西导致了这种行为，尽管我无法想象它可能是什么。尝试一个真正简单的测试用例，然后从那里开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T01:44:01.897

您所需要的只是让一些具有`id`属性的`<a href>`元素和使用哈希链接到这些项目的元素：

```
<h3 id="section_1">Section One</h3>
<p>...</p>
<div>Prev | <a href="#section_2">Next</a></div>

<h3 id="section_2">Section Two</h3>
<p>...</p>
<div><a href="#section_1">Prev</a> | <a href="#section_3">Next</a></div>

<h3 id="section_3">Section Three</h3>
<p>...</p>
<div><a href="#section_2">Prev</a> | Next</div> 
```

这些行中有一些东西......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T03:10:31.670

事实证明，我的按钮在一个表单中。除了使用window.location.hash='#1'，按钮*类型*必须设置为按钮。如果未明确设置按钮类型，则默认情况下会*提交*，这就是导致页面刷新的原因。否则，按钮可能不应该在表单中。

```
<button type='button' onclick="JavaScript:window.location.hash = '#1'">导航不刷新
</按钮>

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T01:40:06.947

您可能希望查看[JQuery Ajax](http://api.jquery.com/jQuery.ajax/)，它可以为您提供您正在寻找的行为，即无需刷新页面，执行一些涉及与服务器通信并获取响应的操作。

# python - 发出通过管道传送到 shell 脚本的终端命令

> ID：14824053
> 
> 赞同：0
> 
> 时间：2013-02-12T01:30:47.397
> 
> 标签：python, bash, shell, subprocess, pipe

我有一个看似简单的用例：我启动一个脚本（python 或 bash），它从命令提示符运行模拟器，然后模拟器接受命令，直到我键入 ctrl-c 或退出。我想从 shell 做同样的事情，我下面的代码不起作用。我想做的是测试自动化，所以我想从命令外壳直接向应用程序发出命令。在python中，我有以下内容：

```
 import os 
    import subprocess

    command = ['/usr/local/bin/YCTV-SIM.sh', '-Latest'] #emulator for yahoo widgets
    process = subprocess.Popen( command, shell=True, stdin=subprocess.PIPE )

    time.sleep(12) #wait for launch to finish
    print '/widgets 1' #first command to issue
    print '/key enter' #second command to issue

    process.wait() 
```

如您所见，这是一些非常简单的东西。当从命令 shell 启动“YCTV-SIM.sh”时，我进入输入模式，我的键条目被发送到应用程序 shell（YCTV-SIM.sh 读取原始输入），所以理想情况下，我能够将文本直接传送到此应用程序外壳。到目前为止，什么都没有发生；测试输出到控制台窗口，但应用程序不响应我尝试发出的命令。我正在使用 python 2.6.3，如果这很重要，但不需要 Python ..

语言在这一点上是无关紧要的，所以 PERL、Python、Bash、TCL ......任何你能提出的建议都可能会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:42:50.473

您需要重定向`stdin`子进程并写入其中。参见例如[`subprocess.Popen.communicate`](http://docs.python.org/2/library/subprocess.html#subprocess.Popen.communicate)。

# java - 将值放入 ConcurrentHashMap 是否是原子的？

> ID：14824058
> 
> 赞同：4
> 
> 时间：2013-02-12T01:32:09.067
> 
> 标签：java, database, multithreading, concurrency, atomic

我正在做一个与数据库建立连接的项目。我需要看看有多少次`exception is happening`。我正在使用`Multithreaded code`，这意味着多个线程将连接到数据库并插入数据库。因此，在某些时候连接可能会丢失，因此我们需要查看这些异常发生了多少次。

所以我写了一个下面的代码，在 catch 块中，我正在捕获异常并在每次有任何异常时增加一个计数器并将其放入`ConcurrentHashMap`.

```
class Task implements Runnable {

     public static final AtomicInteger counter_sql_exception = new AtomicInteger(0);
     public static final AtomicInteger counter_exception = new AtomicInteger(0);
     public static ConcurrentHashMap<String, Integer> exceptionMap = new ConcurrentHashMap<String, Integer>();

     @Override
     public void run() {

     try {

         //Make a db connection and then executing the SQL-

         } catch (SQLException e) {
              synchronized(this) {
                   exceptionMap.put(e.getCause().toString(), counter_sql_exception.incrementAndGet());
              }
              LOG.Error("Log Exception")
          } catch (Exception e) {
              synchronized(this) {
                   exceptionMap.put(e.getCause().toString(), counter_exception.incrementAndGet());
              }
              LOG.Error("Log Exception")
        }
      }
  } 
```

**我的问题是 -**今天我进行了一次代码审查，我的一位高级团队成员说，你不需要`synchronized(this)`在`exceptionMap`. `catch block`我说是的，我们将需要，因为递增计数器是原子的。在映射中添加新值是原子的。但是在没有同步的情况下两者都不是原子的。他说`ConurrentHashMap`会为你做这件事。

那么我是否需要`synchronized(this)`阻止它`exceptionMap`。如果不是那为什么？如果是，那么我应该向他引用什么理由。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T01:41:21.923

如果你想计算每个异常发生的次数，那么你需要这样的东西：

```
private static final ConcurrentMap<String, AtomicInteger> exceptionMap = new ConcurrentHashMap<String, AtomicInteger>();

private static void addException(String cause) {
  AtomicInteger count = exceptionMap.get(cause);
  if(count == null) {
    count = new AtomicInteger();
    AtomicInteger curCount = exception.putIfAbsent(cause, count);
    if(curCount != null) {
      count = curCount;
    }
  }
  count.incrementAndGet();
} 
```

请注意，除非您定期将其清除，否则拥有异常的静态映射是资源泄漏。

正如@dnault 提到的，您还可以使用[番石榴的 AtomicLongMap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/AtomicLongMap.html)。

更新：对您的原作的一些评论：

*   你是对的，你*确实*需要另一个包装同步块来确保最新的值实际上进入了地图。但是，正如@Perception 在评论中已经指出的那样，您正在同步*错误的对象实例*（因为您正在更新静态地图，所以您需要一个静态实例，例如`Task.class`）
*   但是，您使用的是静态计数器，但 String 键对于不同的异常可能不同，因此您实际上并没有计算每个异常原因，而是将随机数作为各种映射值
*   最后，正如我在示例中所展示的，您可以通过适当使用 ConcurrentMap 来解决上述问题并完全丢弃同步块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T06:41:56.193

这种方式也应该有效。

```
private static final ConcurrentMap<String, Integer> exceptionMap = new ConcurrentHashMap<String, Integer>();

private static void addException(String cause) {
    Integer oldVal, newVal;
    do {
      oldVal = exceptionMap .get(cause);
      newVal = (oldVal == null) ? 1 : (oldVal + 1);
    } while (!queryCounts.replace(q, oldVal, newVal)); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T13:48:15.647

`ConcurrentHashMap`不允许空值，所以`replace`如果用`oldValue == null`. `delta`我使用此代码通过返回来增加计数器`oldValue`。

```
private final ConcurrentMap<Integer,Integer> counters = new ConcurrentHashMap<Integer,Integer>();

private Integer counterAddDeltaAndGet(Integer key, Integer delta) {
    Integer oldValue = counters.putIfAbsent(key, delta);
    if(oldValue == null) return null;

    while(!counters.replace(key, oldValue, oldValue + delta)) {
        oldValue = counters.get(key);
    }

    return oldValue;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-17T15:57:51.857

您不必使用`synchronized`块和`AtomicInteger`. 您可以只使用`ConcurrentHashMap.compute`作为线程安全原子操作的方法来完成。所以你的代码看起来像这样

```
public class Task implements Runnable {

    public static final Map<String, Integer> EXCEPTION_MAP = new ConcurrentHashMap<String, Integer>();

    @Override
    public void run() {
        try {

            // Make a db connection and then executing the SQL-

        } catch (Exception e) {
            EXCEPTION_MAP.compute(e.getCause().toString(), (key, value) -> {
                if (value == null) {
                    return 1;
                }
                return ++value;
            });
        }

    }

} 
```

# sql-server-2008 - 选择一个网格区域/销售人员/类别组合，其中所有订单项都有多个数量

> ID：14824066
> 
> 赞同：0
> 
> 时间：2013-02-12T01:32:59.833
> 
> 标签：sql-server-2008, select, adventureworks

使用 AdventureWorks 2008 R2，我想查询一个网格

1.  在纵轴上列出每个区域/销售人员组合
2.  在水平轴上列出每个子类别
3.  `all the line items`每个单元格指定在该类别/地区/销售人员组合中具有`2 or more`数量的销售总数（唯一 SalesOrderID s）

这是一个示例（虚构的数据，我不知道如何查询真实的东西！）：

```
 M.Bikes     Chains     Gloves
Northwest   John Doe     15          4          3
Canada      John Doe     4           2          1
Northwest   Jill Doe     0           5          3
Canada      Jill Doe     1           5          1
etc 
```

我认为下面的 SQL 将为我提供山地自行车（subcat id 1），但我不知道如何轻松添加更多列。如果我开始对每一列进行独立查询，它会变得非常慢，非常快（尤其是当我必须将所有这些列重新连接在一起时！）

```
select
    terr.Name as Territory,
    sp.BusinessEntityID,
    SUM(case when detail.OrderQty > 1 then 1 else 0 end) as MatchingSales

from
    sales.salesorderdetail detail
    inner join sales.SalesOrderHeader header on header.SalesOrderID = detail.SalesOrderID
    inner join sales.SalesPerson sp on sp.BusinessEntityID = header.SalesPersonID
    inner join sales.SalesTerritory terr on terr.TerritoryID = sp.TerritoryID
    inner join sales.SpecialOfferProduct sop on sop.ProductID = detail.ProductID
    inner join Production.Product on Product.ProductID = sop.ProductID
    inner join Production.ProductSubcategory subcat on subcat.ProductSubcategoryID = Product.ProductSubcategoryID

where
    subcat.ProductSubcategoryID = 1 --mountain bikes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:52:04.793

我想先说我没有安装 AdventureWorks，所以我无法检查查询...我也不知道销售人员姓名列的名称，所以您很可能不得不更改它，但是在这里，您只需在每个子类别的顶部添加一列。我还假设原始查询是正确的。

```
select
terr.Name as Territory,
sp.Name SalesPerson,
SUM(case when detail.OrderQty > 1 and subcat.ProductSubcategoryID = 1 then 1 else 0 end) as MBikes,
SUM(case when detail.OrderQty > 1 and subcat.ProductSubcategoryID = 2 then 1 else 0 end) as Chains,
SUM(case when detail.OrderQty > 1 and subcat.ProductSubcategoryID = 3 then 1 else 0 end) as Gloves
from
sales.salesorderdetail detail
inner join sales.SalesOrderHeader header on header.SalesOrderID = detail.SalesOrderID
inner join sales.SalesPerson sp on sp.BusinessEntityID = header.SalesPersonID
inner join sales.SalesTerritory terr on terr.TerritoryID = sp.TerritoryID
inner join sales.SpecialOfferProduct sop on sop.ProductID = detail.ProductID
inner join Production.Product on Product.ProductID = sop.ProductID
inner join Production.ProductSubcategory subcat on subcat.ProductSubcategoryID = Product.ProductSubcategoryID
group by terr.Name, sp.Name 
```

# php - 使用一项访问二维关联数组的键

> ID：14824067
> 
> 赞同：0
> 
> 时间：2013-02-12T01:33:40.630
> 
> 标签：php, associative-array

对于“提交”输入项：

```
name="remove['.$username.']['.$event_id.']" 

if (isset($_POST[remove])) {
    foreach ($_POST[remove] as $username => $event_obj) {
        foreach ($event_obj as $event_id => $obj) {
            delete .... WHERE event_id='$event_id' AND username='$username'");
        }
    }
} 
```

是否有更短的方法来获取在具有一个项目的数组中使用的关联键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:21:12.123

用于一次[`array_keys()`](http://php.net/array_keys)获取所有`event_id`值。这也只需要对每个用户名进行一次查询。

```
if( isset( $_POST['remove'])) {
    foreach( $_POST['remove'] as $username => $event_obj) {
        $event_ids = array_map( 'intval', array_keys( $event_obj));
        $sql = 'DELETE FROM mytable 
                    WHERE event_id IN ( ' . implode( ' OR ', $event_ids) . ' ) 
                        AND username = "' . $username  . '"'; // Sanitize $username
    }
} 
```

# ios - 基本 - 如何更改导入的库

> ID：14824069
> 
> 赞同：0
> 
> 时间：2013-02-12T01:34:31.770
> 
> 标签：ios, objective-c, subclass

我想使用我在 CocoaControls 上找到的一个名为 SDNestedTable 的控件：[https ://github.com/serverdensity/ios-SDNestedTable](https://github.com/serverdensity/ios-SDNestedTable)

我已经对类进行了子`SDNestedTableViewController`类化，但我想更改表格单元格的背景颜色，但没有提供这样做的方法。

`SDGroupCell`库中的其他类是`SDSubCell`继承自`SDSelectableCell`. `SDSelectableCell`包含 3 种根据单元格状态更改背景的方法。

以下是中的相关方法`SDSelectableCell.m`：

```
- (void) styleEnabled
{
    for (UIView *view in checkBox.subviews) [view removeFromSuperview];
    [checkBox addSubview:onCheckBox];
    checkBox.alpha = 1.0;
    itemText.alpha = 1.0;
    self.backgroundView.backgroundColor = UIColorFromRGBWithAlpha(0x0d2e4d, 1.0);
}

- (void) styleDisabled
{
    for (UIView *view in checkBox.subviews) [view removeFromSuperview];
    [checkBox addSubview:offCheckBox];
    checkBox.alpha = 1.0;
    itemText.alpha = 0.4;
    self.backgroundView.backgroundColor = [UIColor colorWithWhite:0.0 alpha:1.0];
}

- (void) styleHalfEnabled
{
    for (UIView *view in checkBox.subviews) [view removeFromSuperview];
    [checkBox addSubview:onCheckBox];
    checkBox.alpha = 0.45;
    itemText.alpha = 0.7;
    self.backgroundView.backgroundColor = UIColorFromRGBWithAlpha(  , 1.0);
} 
```

* * *

我可以看到两种方法，但我是新手，想验证处理这个问题的最佳方法：

1) 只需更改 SDSelectableCell.m 中的代码。我必须更改 3 行来设置 3 种颜色，然后我就完成了。但是，我认为导入这样的库并更改代码是不好的做法。如果从事该项目的人必须重新导入库并且不知道它已更改，我可以预见将来会出现问题。

1a）我想我也可以重命名/重构所有内容，使其不再是 SD，这至少可以防止其他人认为它是原始的 SDNestedTable 库。

2）我可以继承`SDSelectableCell`并覆盖这 3 种方法。虽然，这需要我对库中的所有其他类进行子类化，因为它们实例化了 SDSelectable 单元格，而我必须更改所有这些。

3）其他方式？类别和扩展似乎不起作用，但也许我错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:17:57.763

快速浏览一下 github 代码后，它们似乎为您提供了一种简单的方法，可以按照您喜欢的方式设置单元格。在您`SDNestedTableDelegate`实施该`-mainTable:itemDidChange:`方法。

```
- (void)mainTable:(UITableView *)mainTable itemDidChange:(SDGroupCell *)item
{
    SelectableCellState state = item.selectableCellState;
    switch (state) {
        case Checked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        case Unchecked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        case Halfchecked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        default:
            break;
    }
} 
```

* * *

***更新***

`SDNestedTableViewController`当您通过覆盖`-mainTable:setItem:forRowAtIndexPath:`和进行子类化时，该库似乎为您提供了格式化项目和子项目的地方`-item:setSubItem:forRowAtIndexPath:`。将其与上述项目相结合确实更改了代码并提取了通用功能，从而为您提供：

```
- (void)PRIVATE_finalizeSelectableCell:(SDSelectableCell *)item
{
    SelectableCellState state = item.selectableCellState;
    switch (state) {
        case Checked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        case Unchecked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        case Halfchecked:
            item.backgroundView.backgroundColor = [UIColor ...];
            break;
        default:
            break;
    }
}
- (void)mainTable:(UITableView *)mainTable itemDidChange:(SDGroupCell *)item
{
    [self PRIVATE_finalizeSelectableCell:item];
}
- (SDGroupCell *)mainTable:(UITableView *)mainTable setItem:(SDGroupCell *)item forRowAtIndexPath:(NSIndexPath *)indexPath 
{
    [self PRIVATE_finalizeSelectableCell:item];
    return item;
}
- (SDSubCell *)item:(SDGroupCell *)item setSubItem:(SDSubCell *)subItem forRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self PRIVATE_finalizeSelectableCell:subItem];
    return subItem;
} 
```

# php - 不分大小写的字符串比较

> ID：14824070
> 
> 赞同：0
> 
> 时间：2013-02-12T01:34:42.927
> 
> 标签：php, string-matching, case-insensitive

我正在尝试以不区分大小写的方式查找 "Username" 或 "Password" 的不同变体，如下所示：

```
$unVar1 = "username";
$unVar2 = "user name";
$usernameVariations1 = strcasecmp($unVar1, $unVar2);

$unVar3 = "User";
$unVar4 = "id";
$usernameVariations2 = strcasecmp($unVar3, $unVar4);

$pwVar1 = "password";
$pwVar2 = "pass";
$passwordVariations1 = strcasecmp($pwVar1, $pwVar2);

if ($element->value === $usernameVariations1
   || $element->value === $usernameVariations2
   || $element->value === $passwordVariations1) {
  echo "Weee!";
}
else {
  echo "boo!";
} 
```

问题是它为输出`boo`中的每个元素输出“” `foreach()`。我究竟做错了什么？是否可以将所有这些值放在一个数组中？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:36:49.023

你让这件事变得更复杂了。如果您的用户名和密码不区分大小写，则在比较时将它们设为小写：

```
if (strtolower($username) === strtolower($element->value))
{
     // ok
} 
```

现在，如果您允许在中间添加空格和缩写，那么您可以尝试 B 计划：

```
$valid_usernames = array('Username', 'username', 'user name', 'UsE Nam');
if (in_array($element->value, $valid_usernames))
{
     // ok
} 
```

请记住，您现在有责任保持`$valid_usernames`完整。

# linux - 我有执行权限但没有写权限 - 如何执行创建文件的脚本？

> ID：14824072
> 
> 赞同：0
> 
> 时间：2013-02-12T01:35:12.837
> 
> 标签：linux, unix, permissions, filesystems, chmod

有一个我不拥有的脚本，但我对它有执行（和读取）权限。我对文件系统没有任何写权限。该脚本尝试在文件系统上创建一些文件，然后将其删除。

因此，当我运行脚本时，我收到“权限被拒绝”消息，因为我没有在文件系统上写入的权限。

我该如何解决这个问题？

不能改变的一件事是，我不能为我的用户请求文件系统的永久写权限。但是我希望能够创建文件，如果它是通过脚本完成的。

*   如果您建议的更改需要编辑脚本或其权限，我可以要求管理员为我执行此操作。但通常管理员不会授予我对系统上任何文件的永久写入权限。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:41:46.327

您可以询问您的管理员他是否愿意让您运行此脚本，并且仅使用 sudo 运行此脚本。

由于您无法修改脚本，因此一旦他批准了脚本的内容，他们就可以考虑这样做。

在 /etc/sudoers

```
youruser ALL= NOPASSWD: /path/to/your/script 
```

他可能还可以限制脚本运行的对象，因此您只有有限的访问权限，而不是完全的 root 访问权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T01:52:15.387

在我看来，值得在某处寻找可供用户进行此类访问的文件夹。也许可以写入 a `user/`or`tmp/`目录？您要写入的路径是什么？

如果失败了，我会调查为什么脚本需要写入和删除文件。是否可以使用不那么持久的东西，例如变量而不是写入文件并完全避免写入文件？你在写什么类型/大小的数据？

最后，也许系统被锁定是有充分理由的，也许您可​​以找到一个更宽松的系统来用于您的目的。不让用户写入*任何*文件听起来很不寻常。

# java - 正则表达式 java 解析

> ID：14824075
> 
> 赞同：0
> 
> 时间：2013-02-12T01:35:35.097
> 
> 标签：java, regex, string, parsing, text

我正在使用 Java 尝试解析文件。我在文档中寻找年龄的人。以下是我到目前为止看到的示例：

> 49岁
> 
> 31 岁
> 
> , 26,
> 
> , 45,
> 
> 30多岁，
> 
> 三十年代末，

基本上，我需要提取文件中所有年龄的人。我不确定会达到这些参数的正确正则表达式是什么。对于像“三十”这样的数字，做所有数字系列“四十”、“五十”等的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T01:43:46.403

在这种情况下，在这种情况下，我不会使用正则表达式。我宁愿构建一个扫描输入的函数。我认为它会更可靠。正则表达式，有时会有点乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:10:02.913

*对于除*最后一个以外的所有示例输入，使用类似以下模式的方法可以直接提取年龄：

```
Pattern pattern = Pattern.compile("[^\\d]*(\\d+)[^\\d]*");
Matcher matcher = pattern.matcher("30s"); // 49-years-old, 31 years old
if (matcher.matches()) {
   System.out.println(matcher.group(1));
} 
```

但是当年龄用文字写出来时，没有直接的解决方案，可能还有你的模式（或者你将采取的任何算法来提取它）；必须随着时间的推移而发展，因为人们可能会以您必须适应的不同*风格输入他们的年龄。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T17:11:21.110

我从斯坦福的 CS 朋友那里找到了我的问题的答案。

当您可以为您生成正则表达式代码时，为什么要手动找出所有正则表达式代码？

[http://txt2re.com/index-java.php3](http://txt2re.com/index-java.php3)

该网站使您可以非常轻松地选择您要提取的信息。它成功地找到了我想从字符串中提取的所有可能性，我只需单击我想要的部分。

该工具击败了我发现的关于正则表达式的所有其他内容。

# c - 如何使函数中的指针更改C中的指针

> ID：14824076
> 
> 赞同：1
> 
> 时间：2013-02-12T01:35:48.573
> 
> 标签：c, pointers

嘿伙计们，

我一直在阅读一些关于指针和指针的东西，并开始感到好奇。我唯一不明白的是指针在函数中的行为，因此下面的代码：

```
#include <stdio.h>

int pointeeChanger(char* writeLocation) {

    writeLocation = "something";
    return 0;
}

int main(void)
{

    char crypted[] = "nothing";
    char* cryptedPointer = crypted;

    pointeeChanger(cryptedPointer);

    printf("The new value is: %s", cryptedPointer);

    return 0;
} 
```

我的意图是通过给函数的指针来调整指针，“加密”var。唯一的问题是它不起作用。您能否解释一下我的思考过程中出了什么问题。我对C相当陌生，所以我的错误可能是相当基本的。

提前致谢！

问候，

基普特斯克里迪

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T01:45:11.687

C 字符串不是学习指针的最佳材料，因为它们被实现为指向`char`. 让我们`int`改用：

```
#include <stdio.h>

void pointeeChanger(int* writeLocation) {
    // Using dereference operator "*"
    *writeLocation = 42; // something
}

int main(void) {
    int crypted = 0; // Nothing
    pointeeChanger(&cryptedPointer); // Taking an address with "&"
    printf("The new value is: %d", crypted);
    return 0;
} 
```

这按预期工作。

就地修改字符串要困难得多，因为您被迫处理内存管理问题。具体来说，您复制到的字符串必须分配足够的空间以容纳新字符串。这不适用于“nothing”和“something”，因为替换要长两个字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T01:39:39.087

简短的回答：`writeLocation`是一个局部变量，是`cryptedPointer`. 修改`writeLocation`时，`cryptedPointer`不修改。

如果要修改`cryptedPointer`，则必须将指针传递给它，如下所示：

```
#include <stdio.h>

int pointeeChanger(char** writeLocation) {            /* Note: char** */

    *writeLocation = "something";                     /* Note: *writeLocation */
    return 0;
}

int main(void)
{

    char crypted[] = "nothing";
    char* cryptedPointer = crypted;

    pointeeChanger(&cryptedPointer);                  /* Note: &cryptedPointer */

    printf("The new value is: %s", cryptedPointer);

    return 0;
} 
```

但是，此代码还有其他问题。调用后`pointeeChanger()`，`cryptedPointer`不再指向`crypted`数组。我怀疑您实际上想更改该数组的内容。此代码无法做到这一点。

要更改您的值，`crypted[]`您需要使用`strcpy()`or (preferably) `strncpy()`。此外，您将需要注意`crypted[]`数组的大小 -`"something"`长度大于`"nothing"`并将导致缓冲区溢出，除非`crypted[]`将其做得更大。

此代码将修改原始`crypted[]`数组：

```
#include <stdio.h>
#include <string.h>

#define MAX_STR_LEN 64

/*
 * Only char* required because we are not modifying the
 * original pointer passed in - we are modifying what it
 * points to.
 */
int pointeeChanger(char* writeLocation)
{
    /*
     * In C, you need to use a function like strcpy or strncpy to overwrite a
     * string with another string. Prefer strncpy because it allows you to
     * specify a maximum size to copy, which helps to prevent buffer overruns.
     */
    strncpy(writeLocation, "something", MAX_STR_LEN);

    /* strncpy doesn't automatically add a \0 */
    writeLocation[MAX_STR_LEN] = '\0';

    return 0;
}

int main(void)
{
    /*
     * The +1 is because an extra character is required for the 
     * null terminator ('\0')
     */
    char crypted[MAX_STR_LEN + 1] = "nothing";

    pointeeChanger(crypted);

    printf("The new value is: %s", crypted);

    return 0;

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T01:45:06.623

这取决于您实际想要做什么：

您要更改`cryptedPointer`指向的内容，还是更改`cryptedPointer`指向的内容？

第二个可以通过以下方式完成：

```
 strcpy(writeLocation, "something"); 
```

请注意，如果`something`长于原始字符串的大小，则会溢出缓冲区，这是一件坏事。所以要解决这个问题，你必须有`char crypted[10] = "nothing";`, 为字符串“something”腾出空间。

您显然也可以执行以下操作：

```
 writeLocation[2] = 'f';
 writeLocation[3] = 'f'; 
```

并`printf`打印“noffing”

但是如果你想做第一个变体，那么你需要将一个指针传递给指针：

```
int pointeeChanger(char** writeLocation) {

    *writeLocation = "something";
    return 0;
} 
```

然后调用：

```
pointeeChanger(&cryptedPointer); 
```

请注意，当它返回时，`cruptedPointer`它指向一个无法修改的常量字符串，您的原始字符串可以在其中`crypted`进行修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T02:40:50.840

想想汤姆受雇于莎莉为黑手党打破指关节。

按值传递：如果 Sally 让 Tom 数数他今天在工作中折断的指节数，那么 Sally 无法知道 Tom 计算出的数字是多少，直到他从路上回来。一开始他们的脑海中都有一个数字“零”的副本，但汤姆的数字可能会在一天中增加。

请注意“复制”一词。当您将值传递给函数时，您传递的是对象的副本。当您在函数中修改对象时，您修改的是副本而不是原始对象。

Pass-by-reference：如果 Sally 告诉 Tom 计算他在天空中折断的指节数，那么她（以及任何其他感兴趣的人）可以参考天空。通过改变天空，汤姆也将改变莎莉的号码。

编辑：C 没有按引用传递，尽管它确实有指针，它们是引用类型。传递指针仍然是按值传递，仍然形成具有相同指针值的副本。因此，您的任务是副本，而不是原件。

# .net - 在 VB 中使用指针调用

> ID：14824081
> 
> 赞同：0
> 
> 时间：2013-02-12T01:36:48.797
> 
> 标签：.net, vb.net, pointers

如何在 VB 中从 XLDownload.dll 调用此函数？

```
DWORD __stdcall QueryTaskInfo(LONG lTaskId, LONG *plStatus, ULONGLONG *pullFileSize, ULONGLONG *pullRecvSize); 
```

我尝试使用 ByRef ULong 和 ByVal IntPtr 来调用，但都不起作用。它们都导致 PInvokeStackImbalance 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:16:59.717

```
<DllImport("XLDownload.dll", CharSet := CharSet.Auto, SetLastError := True, BestFitMapping := False, CallingConvention := CallingConvention.StdCall)> _
Private Shared Function QueryTaskInfo(lTaskId As UInt32, ByRef plStatus As UInt32, ByRef pullFileSize As UInt64, ByRef pullRecvSize As UInt64) As UInt32
End Function 
```

# c++ - 将指向原始对象的指针初始化为临时对象

> ID：14824082
> 
> 赞同：0
> 
> 时间：2013-02-12T01:36:52.180
> 
> 标签：c++, pointers, constructor, initialization, constants

我认为这是**MSVC**中的有效代码：

```
MyClass* pMc = &MyClass(); 
```

但是，当我尝试对原始数据类型做同样的事情时，我遇到了编译错误。

```
int* pInt = &int(); 
```

错误：

```
error C2101: '&' on constant 
```

我有3个问题：

1.  为什么`int()`给我一个常数？
2.  为什么首先存在错误[C2101](http://msdn.microsoft.com/en-us/library/4asz0fdf%28v=vs.80%29.aspx)？获取常量的地址有什么问题？
3.  有没有办法可以声明指向临时对象的 int （或其他原始）引用？（即不先创建局部变量）

关于第三个问题：

我**不想**做这样的事情：

```
int i = int();
int* pInt = &i; 
```

如果我正在使用对本地对象的引用（原因无关紧要），我不想必须两次声明每个对象。这很乏味，很烦人，而且名字真的很混乱。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T01:41:44.133

我不知道 1 的答案（我认为错误是错误的，因为我很确定`int()`不是常数），但是

(2) 占用临时地址是非法的。您的代码不应该编译，但它确实是因为非标准的 MSVC++ 扩展。

(3) 是的，使用 rvalue-references 或 const lvalue-references：

```
const int& tmp = int();
int&& tmp = int(); // same as former but isn't const 
```

临时对象的生命周期将延长，直到引用超出范围。

但是，我希望您有充分的理由使用上述两种方法之一，而不是

```
int tmp; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:00:48.797

代码行在一个编译器中以违反标准的方式编译，但取消引用该指针是下一行的未定义行为。所以要小心。

我认为这可能有效：

```
template<typename T>
T* make_tmp_ptr(T&&t) {
   return &t;
} 
```

然后调用`make_tmp_ptr(int())`，您将获得一个指向临时的指针，该指针`int`将持续到表达式结束。

# html - h2的背景图片/颜色后面的插入框阴影，上面需要它

> ID：14824083
> 
> 赞同：0
> 
> 时间：2013-02-12T01:37:05.890
> 
> 标签：html, background, css

正如标题所暗示的那样，我的 H2 元素背景下方的嵌入框阴影存在问题，我需要它位于元素上方。

[http://jsfiddle.net/9QYT4/](http://jsfiddle.net/9QYT4/)

我已经设置了背景图像，以便根据访问的站点的页面轻松编辑颜色，感谢任何有关如何使阴影出现在 h2 上方的帮助，谢谢！

另外，是否也可以用 png 渐变做这样的事情？这将是一个更好的解决方案，因为我试图只在右侧获得阴影（但它也显示在顶部和底部）

SASS

```
#region-postscript-second {
width:300px;
background:#fff;
margin: 20px;
box-shadow: inset -6px 0 10px rgba(0, 0, 0, 0.15);
h2 {
    background: url('http://vt.lexcorp.ca/sites/all/themes/vermont/img/middle-heading-bg.png') center center no-repeat #8CCC1B;
    font-size:20px;
    text-transform:uppercase;
    font-weight:normal;
    color:#646567;
    text-align:center;
}} 
```

查看 JSfiddle 上的 HTML，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:50:15.663

我在包含你的影子的元素之后创建了伪元素：http: [//jsfiddle.net/jPUX3/](http://jsfiddle.net/jPUX3/)

```
#region-postscript-second:after{
    content: " ";
    display: block;
    position: absolute;
    right: 0;
    top: 0;
    height: 100%; width: 14px;
    box-shadow: inset -14px 0 8px -8px rgba(0, 0, 0, .25);
} 
```

并添加到#region-postscript-second：

```
position: relative; 
```

最后是关于一侧盒子阴影的东西 - [http://css-tricks.com/snippets/css/css-box-shadow/](http://css-tricks.com/snippets/css/css-box-shadow/)

# jquery - 打开从 Web.API 控制器发现的静态 html 页面

> ID：14824089
> 
> 赞同：0
> 
> 时间：2013-02-12T01:38:25.017
> 
> 标签：jquery, asp.net-web-api

我有一个 Web.API 服务在“ `http://mywebserver/report`”处运行，在我的控制器中，我检查以搜索服务器上是否存在静态 html 文件，如下所示：

```
bool exists = File.Exists( Path.Combine( HostingEnvironment.MapPath( @"\atlas" ), "report.html") ); 
```

这工作正常，并且发现我的文件没问题-'atlas' 是虚拟目录路径，所以我应该能够打开' `http://mywebserver/atlas/report.html`'。问题是，当我将文件存在的布尔值返回给客户端并且可以打开时，如果我尝试从我的 jQuery 打开文件，它会将它放在原始 URL 中，并尝试打开“ `http://mywebserver/report/report.html`”，这不会工作。

在 IIS 中，我无法将虚拟目录和应用程序目录映射到同一位置……而且我不想在客户端上的完整 Web 服务 URL 中硬编码，例如 window.open(" `http://mywebserver/atlas/`" + "报告.html”）。

有没有办法解决这个问题？也许是一种让我的控制器将正确的 URL 推送回客户端以打开的方法？如何获取到虚拟目录的 URL 映射？我想我正在努力做到这一点......我只是希望如果找到文件，它会在新窗口中打开......

# objective-c - 标签栏项目位置未与栏的背景对齐

> ID：14824098
> 
> 赞同：0
> 
> 时间：2013-02-12T01:39:11.953
> 
> 标签：objective-c

我在尝试将我自己的设计实现到标签栏时遇到了麻烦。不知何故，即使它们具有相同的高度，项目和背景也无法正确对齐。这些按钮似乎比背景更远，我不知道为什么。

实现项目/按钮的代码：（这是在“Tab1ViewController.m”的“viewDidLoad”中添加的，这是我的 5 个视图控制器中的第一个）

```
UIImage *selectedImage0 = [UIImage imageNamed:@"searchSEL"];
UIImage *unselectedImage0 = [UIImage imageNamed:@"search"];

UIImage *selectedImage1 = [UIImage imageNamed:@"homeSEL"];
UIImage *unselectedImage1 = [UIImage imageNamed:@"home"];

UIImage *selectedImage2 = [UIImage imageNamed:@"dareSEL"];
UIImage *unselectedImage2 = [UIImage imageNamed:@"dare"];

UIImage *selectedImage3 = [UIImage imageNamed:@"starSEL"];
UIImage *unselectedImage3 = [UIImage imageNamed:@"star"];

UIImage *selectedImage4 = [UIImage imageNamed:@"friendsSEL"];
UIImage *unselectedImage4 = [UIImage imageNamed:@"friends"];

UITabBar *tabBar = self.tabBarController.tabBar;
UITabBarItem *item0 = [tabBar.items objectAtIndex:0];
UITabBarItem *item1 = [tabBar.items objectAtIndex:1];
UITabBarItem *item2 = [tabBar.items objectAtIndex:2];
UITabBarItem *item3 = [tabBar.items objectAtIndex:3];
UITabBarItem *item4 = [tabBar.items objectAtIndex:4];

[item0 setTitle:@""];
[item1 setTitle:@""];
[item2 setTitle:@""];
[item3 setTitle:@""];
[item4 setTitle:@""];
[item0 setFinishedSelectedImage:selectedImage0 withFinishedUnselectedImage:unselectedImage0];
[item1 setFinishedSelectedImage:selectedImage1 withFinishedUnselectedImage:unselectedImage1];
[item2 setFinishedSelectedImage:selectedImage2 withFinishedUnselectedImage:unselectedImage2];
[item3 setFinishedSelectedImage:selectedImage3 withFinishedUnselectedImage:unselectedImage3];
[item4 setFinishedSelectedImage:selectedImage4 withFinishedUnselectedImage:unselectedImage4]; 
```

并添加背景，我刚刚将此代码添加到我的 appDelegate.m 中的 didFinishLaunchingWithOptions

```
UITabBar *tabBar = [UITabBar appearance];
[tabBar setBackgroundImage:[UIImage imageNamed:@"bg"]]; 
```

按钮为 64x49 像素，背景为 320x49 像素。

我将无法在一段时间内回答或阅读评论，但我会尽快，希望有人能提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:49:28.850

好吧，想通了，这很明显。项目下的部分是标题应该在的位置。而且由于我的图标只占用了图标空间而不是标题空间，因此标题所在的位置是空的。

通过为栏创建整个背景图像并在其上指定边框和渐变来解决该问题，并且只是将图标分别创建为小白/黑图像和透明背景。

# php - 使用php将图像上传到aws ec2

> ID：14824104
> 
> 赞同：1
> 
> 时间：2013-02-12T01:39:37.560
> 
> 标签：php, amazon-ec2

我正在尝试将文件上传到亚马逊的虚拟机。我有一些问题。

我想我必须给我的服务器文件夹（777）权限才能上传我的文件。如果我不这样做是行不通的。这个可以吗？

授予这些权限是否安全？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T17:54:29.327

您无需将文件的权限设置为 777 即可将其写入目录。相反，该目录需要有权限才能被用户写入。

如果您正在运行 apache，则该进程以用户身份运行，`www-data`并且无论您尝试将文件写入何处，都必须具有该用户的写入权限。如果您正在写信`/var/www/my_file_uploads`，请尝试以下操作：

```
chown -R www-data:www-data /var/www/my_file_uploads 
```

请注意，通过这样做，您将阻止您家用计算机上的其他人也读取该文件（除非您明确允许它）。

# android - 这个错误在eclipse（android）中是什么意思，使用kso ap2访问webservice？

> ID：14824110
> 
> 赞同：2
> 
> 时间：2013-02-12T01:40:10.210
> 
> 标签：android, wsdl, ksoap2, logcat

我收到以下错误。该程序应该打印它从在线 wsdl 访问的值。但它不打印任何内容，并且 LogCat 中出现以下错误：

```
02-12 01:34:50.472: D/ExchangeService(672): Received deviceId from Email app: null
02-12 01:34:50.472: D/ExchangeService(672): !!! deviceId unknown; stopping self and retrying
02-12 01:34:55.544: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.544: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.544: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.544: D/ExchangeService(672): !!! EAS ExchangeService, onStartCommand, startingUp = false, running = false
02-12 01:34:55.564: W/ActivityManager(288): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
02-12 01:34:55.564: D/ExchangeService(672): !!! Email application not found; stopping self
02-12 01:34:55.574: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.574: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.584: W/ActivityManager(288): Unable to start service Intent { act=com.android.email.ACCOUNT_INTENT } U=0: not found
02-12 01:34:55.584: W/Trace(672): Unexpected value from nativeGetEnabledTags: 0
02-12 01:34:55.594: E/ActivityThread(672): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d07d98 that was originally bound here
02-12 01:34:55.594: E/ActivityThread(672): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d07d98 that was originally bound here
02-12 01:34:55.594: E/ActivityThread(672):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
02-12 01:34:55.594: E/ActivityThread(672):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
02-12 01:34:55.594: E/ActivityThread(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
02-12 01:34:55.594: E/ActivityThread(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
02-12 01:34:55.594: E/ActivityThread(672):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
02-12 01:34:55.594: E/ActivityThread(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
02-12 01:34:55.594: E/ActivityThread(672):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-12 01:34:55.594: E/ActivityThread(672):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
02-12 01:34:55.594: E/ActivityThread(672):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
02-12 01:34:55.594: E/ActivityThread(672):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
02-12 01:34:55.594: E/ActivityThread(672):  at java.lang.Thread.run(Thread.java:856)
02-12 01:34:55.684: E/StrictMode(672): null
02-12 01:34:55.684: E/StrictMode(672): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d07d98 that was originally bound here
02-12 01:34:55.684: E/StrictMode(672):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
02-12 01:34:55.684: E/StrictMode(672):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
02-12 01:34:55.684: E/StrictMode(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
02-12 01:34:55.684: E/StrictMode(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
02-12 01:34:55.684: E/StrictMode(672):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.emailcommon.service.AccountServiceProxy.getDeviceId(AccountServiceProxy.java:116)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.exchange.ExchangeService.getDeviceId(ExchangeService.java:1249)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1856)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
02-12 01:34:55.684: E/StrictMode(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
02-12 01:34:55.684: E/StrictMode(672):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-12 01:34:55.684: E/StrictMode(672):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
02-12 01:34:55.684: E/StrictMode(672):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
02-12 01:34:55.684: E/StrictMode(672):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
02-12 01:34:55.684: E/StrictMode(672):  at java.lang.Thread.run(Thread.java:856)
02-12 01:34:55.694: W/ActivityManager(288): Unbind failed: could not find connection for android.os.BinderProxy@413a7a10
02-12 01:34:55.714: E/ActivityThread(672): Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d074a0 that was originally bound here
02-12 01:34:55.714: E/ActivityThread(672): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d074a0 that was originally bound here
02-12 01:34:55.714: E/ActivityThread(672):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
02-12 01:34:55.714: E/ActivityThread(672):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
02-12 01:34:55.714: E/ActivityThread(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
02-12 01:34:55.714: E/ActivityThread(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
02-12 01:34:55.714: E/ActivityThread(672):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
02-12 01:34:55.714: E/ActivityThread(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
02-12 01:34:55.714: E/ActivityThread(672):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-12 01:34:55.714: E/ActivityThread(672):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
02-12 01:34:55.714: E/ActivityThread(672):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
02-12 01:34:55.714: E/ActivityThread(672):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
02-12 01:34:55.714: E/ActivityThread(672):  at java.lang.Thread.run(Thread.java:856)
02-12 01:34:55.724: E/StrictMode(672): null
02-12 01:34:55.724: E/StrictMode(672): android.app.ServiceConnectionLeaked: Service com.android.exchange.ExchangeService has leaked ServiceConnection com.android.emailcommon.service.ServiceProxy$ProxyConnection@40d074a0 that was originally bound here
02-12 01:34:55.724: E/StrictMode(672):  at android.app.LoadedApk$ServiceDispatcher.<init>(LoadedApk.java:969)
02-12 01:34:55.724: E/StrictMode(672):  at android.app.LoadedApk.getServiceDispatcher(LoadedApk.java:863)
02-12 01:34:55.724: E/StrictMode(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1418)
02-12 01:34:55.724: E/StrictMode(672):  at android.app.ContextImpl.bindService(ContextImpl.java:1407)
02-12 01:34:55.724: E/StrictMode(672):  at android.content.ContextWrapper.bindService(ContextWrapper.java:473)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:157)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.emailcommon.service.ServiceProxy.setTask(ServiceProxy.java:145)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.emailcommon.service.ServiceProxy.test(ServiceProxy.java:191)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.exchange.ExchangeService$7.run(ExchangeService.java:1850)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:551)
02-12 01:34:55.724: E/StrictMode(672):  at com.android.emailcommon.utility.Utility$2.doInBackground(Utility.java:549)
02-12 01:34:55.724: E/StrictMode(672):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
02-12 01:34:55.724: E/StrictMode(672):  at java.util.concurrent.FutureTask.run(FutureTask.java:234)
02-12 01:34:55.724: E/StrictMode(672):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
02-12 01:34:55.724: E/StrictMode(672):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
02-12 01:34:55.724: E/StrictMode(672):  at java.lang.Thread.run(Thread.java:856)
02-12 01:34:55.734: W/ActivityManager(288): Unbind failed: could not find connection for android.os.BinderProxy@40d250b8
02-12 01:34:55.754: D/dalvikvm(672): GC_CONCURRENT freed 488K, 21% free 2459K/3100K, paused 75ms+4ms, total 155ms 
```

出了什么问题，以及如何正确设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:18:53.703

这里发生的事情通常是由活动和服务之间的绑定引起的。该活动已停止，因此系统认为不再需要该服务并可能停止该服务，从而导致该错误。

快速解决方法是添加**unbindService(mConnection);** 在您的 onstop() 或 onDestroy() 方法中。

如果你想让服务在启动它的活动被销毁后仍然运行，你应该首先使用**startService**。

```
ComponentName myService = startService(new Intent(this, myClass.class));
bindService(new Intent(this, myClass.class), myServiceConn, BIND_AUTO_CREATE); 
```

来自 Android 文档：

对于[startService](http://developer.android.com/reference/android/content/Context.html#startService%28android.content.Intent%29)：

> 使用 startService() 会覆盖由 bindService(Intent, ServiceConnection, int) 管理的默认服务生命周期：它要求服务在调用 stopService(Intent) 之前保持运行，无论是否有任何客户端连接到它。

对于[绑定服务](http://developer.android.com/reference/android/content/Context.html#bindService%28android.content.Intent,%20android.content.ServiceConnection,%20int%29)：

> 只要调用上下文存在，系统就会认为该服务是必需的。例如，如果这个 Context 是一个停止的 Activity，那么在 Activity 恢复之前，服务将不需要继续运行。

# java - 为什么这两个 Java 对象不等于？

> ID：14824113
> 
> 赞同：1
> 
> 时间：2013-02-12T01:40:32.757
> 
> 标签：java, equals

我编写了一些代码，发现对象 ar eno equals - 这是一个微不足道的问题，但不明白默认 equals 是如何工作的。

```
class A {
    String id;
    public A(String id) {
        this.id = id;
    }

    public static void main(String args[])
    {
        A a = new A("1");
        A b = new A("1");
        System.out.println(a.id);
        System.out.println(b.id);
        System.out.println(a.equals(b));
    }
} 
```

结果是：

```
1
1
false 
```

但我想知道`a.equals(b) == true`为什么会这样`false`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T01:46:34.407

您的类目前仅扩展`Object`类，并且在 Object 类`equals`方法中看起来像这样

```
public boolean equals(Object obj) {
    return (this == obj);
} 
```

您需要的是覆盖此方法，例如像这样

```
@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (obj == null)
        return false;
    if (getClass() != obj.getClass())
        return false;
    A other = (A) obj;
    if (id == other.id)
        return true;
    if (id == null)
        return false;
    if (other.id == null)
        return false;
    if (!this.id.equals(other.id))
        return false;
    return true;
} 
```

此外，当您覆盖时，`equals`您可能应该覆盖`hashCode`方法，但这不是您问题的主题。[你可以在这里](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java)阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T01:50:09.147

如果您不覆盖对象上的 equals()，则您正在比较两个不同的内存引用。所以重写 equals() 来比较 id 字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T01:46:31.300

它默认覆盖`Object`'s`equals`方法，它检查“相同的对象”而不是“相同的内容”。如果你想拥有`a.equals(b) == true`，你应该覆盖它：

```
@Override
public boolean equals (Object obj) {
    if (obj instanceof A) {
        A a = (A) obj;
        if (id == null) {
            return a.id == null;
        } else {
            return id.equals(a.id);
        }
    }
    return false;
} 
```

----- 已编辑 -----

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-22T22:03:54.043

你应该为你的代码重写一个 equals() 方法，就像你需要一个 toString() 方法一样。

# php - Magento 客户激活模块 hack 客户组

> ID：14824115
> 
> 赞同：1
> 
> 时间：2013-02-12T01:40:46.827
> 
> 标签：php, magento

我安装了一个免费的扩展程序，在客户登录之前需要管理员批准。我正在破解它，试图让它允许除一个之外的所有客户组。我认为以下是我要编辑的功能，但是当我进行测试注册时，测试 cookie 不会显示在我的控制台中。有任何想法吗？

```
/**
     * Flag new accounts as such
     *
     * @param Varien_Event_Observer $observer
     */
    public function customerSaveBefore($observer)
    {
        $customer = $observer->getEvent()->getCustomer();

        $storeId = Mage::helper('customeractivation')->getCustomerStoreId($customer);
        $session = Mage::getSingleton('customer/session'); // var $session Mage_Customer_Model_Session
$customer_info = $session->getCustomer(); // var $customer Mage_Customer_Model_Customer
$userinfo = $customer_info->_origData; // fetch users info

// get user's customer group id number
$customer_group = $userinfo['group_id']; 
setcookie("Group", "yes");

        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED, $storeId))
        {
            return;
        }

        if (!$customer->getId())
        {
            $defaultStatus = Mage::getStoreConfig(self::XML_PATH_DEFAULT_STATUS, $storeId);
            $customer->setCustomerActivated($defaultStatus);
            $customer->setCustomerActivationNewAccount(true);
        }
    } 
```

我的代码是：

```
$customer_info = $session->getCustomer(); // var $customer Mage_Customer_Model_Customer
$userinfo = $customer_info->_origData; // fetch users info

// get user's customer group id number
$customer_group = $userinfo['group_id']; 
setcookie("Group", "yes"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T08:22:16.647

第一：请不要试图破解模块。更好地创建自己的模块，重写原始模块的类，这样您仍然可以更新原始模块。

第二：你确定那部分代码被执行了吗？如果你在其中输入一个 die() 会发生什么？

[第三：您可以通过实现firegento-debug](https://github.com/firegento/firegento-debug)模块查看所有触发事件的列表，因此您可以检查该事件是否真的被触发并调用了观察者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:06:51.597

嗨，我正在自定义相同的扩展名。

问题是你没有得到客户群。

试试这条线来获取客户群

$customer = $observer->getEvent()->getCustomer();

$groupId = $customer->getGroupId();

# java - 当方法仅在同步块中调用时使方法同步是多余的吗？操作系统级别会发生什么？

> ID：14824116
> 
> 赞同：3
> 
> 时间：2013-02-12T01:41:02.940
> 
> 标签：java, multithreading, synchronization

假设您有一个**仅在同步块中调用的方法 foo()。**

正在制作方法

`synchronized void foo() {..}`

与只是

`void foo() {..}`

多余的或不好的做法，还是使方法的意图更清晰？在方法签名上使用 synchronized 关键字会使程序变慢吗？我想知道更好的做法是什么，或者我是否错过了大局的一部分。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:09:39.137

这不是多余的，实际上在你已经持有的锁上同步是相当普遍的。

在什么是线程安全和什么不是线程安全之间有明确定义的 API 更容易使用，最好的边界可能是在类级别。因此，如果该类的其余部分是线程安全的，并且 foo() 方法在同步时也是线程安全的，那么您也可以这样做并在您的类文档中记录下来。如果同步 foo() 会给你一个混合了线程安全和非线程安全调用的 API，那么这将在以后导致混乱。

关于性能，我怀疑这将是一个问题（无争议的锁应该有最小的开销）。让代码工作，然后看看你是否需要让它更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:55:48.480

通常，这意味着`foo()`它本身不是原子动作，它可能不保留不变量，它只是更宏大的同步方案的一部分。

那么它不应该*声明*，`synchronized`否则读者可能会得到错误的想法；它也有点慢。

相反，你可以

```
void foo()
{
    assert Thread.holdsLock(this);
    ...
} 
```

它有两个目的

1.  说明此方法只能在外部`synchonized(this)`块中调用
2.  在运行时检查该要求（我将为所有非生产运行启用断言）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T19:50:20.450

我想您的`foo()`方法在 A 类中，而调用者代码（在同步块中调用它）在另一个 B 类中。

我的建议是不要创建 A 的方法`synchronized`，因为在单线程程序中调用会系统性地变慢。

正如您所指出的，最好使用同步块使客户端类（例如B）执行同步作业。

总之，我的建议是不要声明同步方法，因为它更灵活：您可以使用带有外部同步块的类来制作线程安全的程序，也可以制作快速的单线程应用程序。您还可以警告您的用户您的 A 类不是线程安全的。

# jquery - 使用脚本标签附加字符串会导致加载缓慢

> ID：14824118
> 
> 赞同：0
> 
> 时间：2013-02-12T01:41:16.437
> 
> 标签：jquery, performance, firefox

我们从 REST 调用中得到以下响应：

```
{content: "some html here with <script type="text/javascript" src="blah.js"></script>"} 
```

我们将它附加到 dom 中，如下所示：

```
someContainer.html(data.content) 
```

Chrome 一次加载 4 到 6 个，就像加载任何其他用例一样。快速地。

Firefox 仅按顺序加载它们，并且需要 5 或 6 秒。

我们有哪些选项可以让 Firefox 更快地加载这些内容？为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T14:36:53.070

发生这种情况是因为脚本可以使用 document.write 修改解析树，因此据我所知，如果您希望行为实际正确，则必须先运行第一个，然后才能知道是否加载下一个。

# php - 插件开发过程中如何获取用户信息？

> ID：14824120
> 
> 赞同：0
> 
> 时间：2013-02-12T01:41:43.103
> 
> 标签：php, wordpress

我问了一个关于在[这里](https://stackoverflow.com/questions/14823863/how-to-get-the-site-name-during-plugin-development)获取 wordpress 网站标题的问题。

我还需要获取用户信息，但如果我不使用网络模式而是开发插件，文档中的任何内容都不起作用**。**所以我不能使用`wp_get_current_user()`or `is_user_logged_in()`or `get_userdata()`。

我找不到有关此的文档。

你能告诉我如何检查用户是否注册，如果是，获取它的用户名和实名。或者给我相应文档的链接。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:56:45.960

只需传递用户 id (int) 参数，它就像一个魅力。

```
<?php $user_info = get_userdata(1);
  echo 'Username: ' . $user_info->user_login . "\n";
  echo 'User level: ' . $user_info->user_level . "\n";
  echo 'User ID: ' . $user_info->ID . "\n"; 
```

来源 -> 了解更多信息

[http://codex.wordpress.org/Function_Reference/get_userdata](http://codex.wordpress.org/Function_Reference/get_userdata)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:28:59.580

如果我使用 wp_loaded 动作，让 wordpress 完全加载，它可以工作，

```
function myfunction() {
      global $current_user;
      get_currentuserinfo();

      echo 'Username: ' . $current_user->user_login . "\n";
      echo 'User email: ' . $current_user->user_email . "\n";
      echo 'User first name: ' . $current_user->user_firstname . "\n";
      echo 'User last name: ' . $current_user->user_lastname . "\n";
      echo 'User display name: ' . $current_user->display_name . "\n";
      echo 'User ID: ' . $current_user->ID . "\n";
}
add_action('wp_loaded', 'myfunction');
... 
```

# java - 带有 mDBapi.putfile 的变量？

> ID：14824123
> 
> 赞同：1
> 
> 时间：2013-02-12T01:41:46.773
> 
> 标签：java, android, dropbox-api

我试图使用 dropbox api 从列表视图上传文件。我的代码是：

```
 File file = new File(mFileMag.getCurrentDir() + "/" + item);
                inputStream = new FileInputStream(file);
               Entry newEntry = mDBApi.putFile(file, inputStream, //This is my issue
                        file.length(), null, null); 
```

我的问题是，变量不能与 mDBapi.putfile 一起使用吗？我是否被迫使用硬编码字符串？尝试使用我的文件变量会导致：

“DropboxAPI 类型中的 putFile(String, InputStream, long, String, ProgressListener) 方法不适用于参数 (File, FileInputStream, long, null, null)”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:23:10.640

[此呼叫](https://www.dropbox.com/static/developers/dropbox-android-sdk-1.5.3-docs/index.html)状态的文档：

> public DropboxAPI.Entry putFile(java.lang.String path, java.io.InputStream is,

...

> path - 放置文件的完整 Dropbox 路径，包括目录和文件名。is - 要从中上传的 InputStream。

因此，'path' 应该是所需远程路径的字符串（在 Dropbox 上），而 'is' 是检索实际文件内容的方式。

看起来您正在尝试将文件对象本身作为“路径”传递，但相反，您应该能够根据需要构建所需路径的字符串（可能包括原始名称。）

# javascript - 排序后从 Datatables.net 获取数据

> ID：14824126
> 
> 赞同：8
> 
> 时间：2013-02-12T01:42:01.683
> 
> 标签：javascript, jquery, jquery-datatables

我正在使用[数据表](http://datatables.net)来显示一些数据。我也有用于向数据添加新行的输入。当我添加这一行时，我重新初始化表，它会根据我给它的排序规则自动对新行进行排序。我的问题是：有没有办法按照当前查看的顺序从表中获取数据？每当我尝试 `$('#tableCompetitors').dataTable().fnGetData()`时，它都会按照添加到表中的顺序为我提供数据，而不是按照它呈现的顺序。

那么有没有一种简单的方法可以做我想做的事？

PS如果有帮助。原始数据源是从文本框提供的数组数组。我解析它，将它推送到一个数组，然后将该数组用作数据源。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-03T12:14:05.123

我遇到了同样的问题。虽然公认的解决方案可能有效，但我找到了更好的方法：

```
$("example").DataTable().rows({search:'applied'}).data() 
```

有关更多信息，请参阅[选择器修饰符](https://datatables.net/reference/type/selector-modifier)文档。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-12T02:49:54.810

这是使用 3 个 API 回调的一种解决方案。

1.  为变量创建`CurrentData`
2.  重置`CurrentData`为空数组`fnPreDrawCallback`，在呈现新表之前在其中触发
3.  `fnRowCallback`允许访问每一行的数据数组，将该数组推入`CurrentData`数组
4.  `fnDrawCallback`在表格呈现后触发，现在可以访问`CurrentData`数组中的排序数据

JS

```
 var currData = [];
  $('#example').dataTable({
    "fnPreDrawCallback": function(oSettings) {
        /* reset currData before each draw*/
        currData = [];
    },
    "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
        /* push this row of data to currData array*/
        currData.push(aData);

    },
    "fnDrawCallback": function(oSettings) {
        /* can now access sorted data array*/
        console.log(currData)
    }
}); 
```

演示：http: [//jsfiddle.net/ne24B/](http://jsfiddle.net/ne24B/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T18:25:15.737

只是想给你另一种选择。

以下将获取表中的所有行，即使它们被过滤掉：

```
var currData = [];
var oTable = $('#example').dataTable();

oTable.$("tr").each(function(index, row){
    //generate your array here
    // like $(row).children().eq(0) for the first table column
    currData.push($(row).children().eq(0));
    // return the data in the first column
    currData.push($(row).children().eq(0).text());
}); 
```

或者，如果您只想要与过滤器匹配的结果，则：

```
var currData = [];
var oTable = $('#example').dataTable();

oTable.$("tr", {"filter":"applied"}).each(function(index, row){
    //generate your array here
    // like $(row).children().eq(0) for the first table column
    currData.push($(row).children().eq(0));

    // return the data in the first column
    currData.push($(row).children().eq(0).text());
}); 
```

currData 将包含第一列数据的排序列表。

编辑：将整行的文本放入数组中。

```
$(row + " td").each(function(index, tdData){
    currData.push($(tdData).text());
}); 
```

或者

```
$(row).children().each(function(index, tdData){
    currData.push($(tdData).text());
}); 
```

这样，您可以更好地控制数组可以包含的内容。我的 2 美分。

# python - 使用 LXML 和 Python 解析 XML

> ID：14824130
> 
> 赞同：1
> 
> 时间：2013-02-12T01:42:15.960
> 
> 标签：python, xpath, lxml

我有以下 XML：

```
<nfl>
  <season season="2012"/>
    <conference label="AFC">
      <division label="Eastern Division">
        <team city="Buffalo" name="Bills"  alias="Buf" />
        <team city="Miami" name="Dolphins"  alias="Mia" />
        <team city="New England" name="Patriots"  alias="NE" />
        <team city="New York" name="Jets"  alias="NYJ" />
      </division>
      <division label="Western Division">
        <team city="Denver" name="Broncos"  alias="Den" />
        <team city="Kansas City" name="Chiefs"  alias="KC" />
        <team city="Oakland" name="Raiders"  alias="Oak" />
        <team city="San Diego" name="Chargers"  alias="SD" />
      </division>
      <division label="Northern Division">
        <team city="Cincinnati" name="Bengals"  alias="Cin" />
        <team city="Cleveland" name="Browns"  alias="Cle" />
        <team city="Pittsburgh" name="Steelers"  alias="Pit" />
        <team city="Baltimore" name="Ravens"  alias="Bal" />
      </division>
      <division label="Southern Division">
        <team city="Houston" name="Texans"  alias="Hou" />
        <team city="Tennessee" name="Titans"  alias="Ten" />
        <team city="Indianapolis" name="Colts"  alias="Ind" />
        <team city="Jacksonville" name="Jaguars"  alias="Jac" />
    </division>
  </conference>
  <conference label="NFC">
    <division label="Eastern Division">
      <team city="Dallas" name="Cowboys"  alias="Dal" />
      <team city="New York" name="Giants"  alias="NYG" />
      <team city="Philadelphia" name="Eagles"  alias="Phi" />
      <team city="Washington" name="Redskins"  alias="Was" />
    </division>
    <division label="Western Division">
      <team city="St. Louis" name="Rams"  alias="StL" />
      <team city="Arizona" name="Cardinals"  alias="Ari" />
      <team city="San Francisco" name="49ers"  alias="SF" />
      <team city="Seattle" name="Seahawks"  alias="Sea" />
    </division>
    <division label="Northern Division">
      <team city="Chicago" name="Bears"  alias="Chi" />
      <team city="Detroit" name="Lions"  alias="Det" />
      <team city="Green Bay" name="Packers"  alias="GB" />
      <team city="Minnesota" name="Vikings"  alias="Min" />
    </division>
    <division label="Southern Division">
      <team city="Atlanta" name="Falcons"  alias="Atl" />
      <team city="New Orleans" name="Saints"  alias="NO" />
      <team city="Tampa Bay" name="Buccaneers"  alias="TB" />
      <team city="Carolina" name="Panthers"  alias="Car" />
  </division>
</conference>

</nfl> 
```

我想将团队“城市”、“名称”和“别名”以及父“部门标签”、“会议标签”和“季节”加载到我的模型中。

在 Python 中，我按如下方式遍历数据：

```
from lxml import etree
doc = etree.parse('thisxmlfile.xml')
for s in doc.xpath('//season'):
    for c in doc.xpath('//conference'):
        for t in doc.xpath('//conference/division/team'):
            print s.get('season'), c.get('label'), t.get('city'), t.get('name'), t.get('alias') 
```

但当然，它会遍历所有“团队”标签两次——每个“会议”标签一次。我想要做的是遍历所有“团队”标签一次并获得父“分区标签”、父“会议标签”和父“季节”。

很确定我需要参考 XPATH Axes 并寻求帮助？

我正在寻找的输出是：

```
2012 AFC Buffalo Bills Buf
2012 AFC Miami Dolphins Mia
2012 AFC New England Patriots NE
.
.
.
2012 NFC New Orleans Saints NO
2012 NFC Tampa Bay Buccaneers TB
2012 NFC Carolina Panthers Car 
```

注意：上面的输出不包括“部门标签”，但是一旦我弄清楚如何获得“会议标签”，它应该很容易。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:12:45.873

以下是获得所需输出的方法：

```
from lxml import etree

doc = etree.parse('thisxmlfile.xml')

# There is only one "season" element
season = doc.find('season').get('season')     

# XPath query relative to root node
for conference in doc.xpath('conference'):
    # XPath query relative to "conference" node     
    for team in conference.xpath('division/team'):     
        print season, conference.get('label'),
        print team.get('city'), team.get('name'), team.get('alias') 
```

# ruby-on-rails-3 - 使用 state_machine 返回某个状态的所有记录

> ID：14824134
> 
> 赞同：0
> 
> 时间：2013-02-12T01:43:03.597
> 
> 标签：ruby-on-rails-3, state-machine

您将如何使用 state_machine 返回某个状态下的记录列表？类似于以下内容：

```
@locked = current_user.docs.locked? 
```

干杯。

**编辑**

好像`current_user.docs.with_state(:locked).all`也行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:15:42.630

一个简单的`current_user.docs.where(:state => "locked")`工作，我只是认为会有更好的方法。

# c - 使用 fgets 从文件读取 Seg Fault 错误

> ID：14824138
> 
> 赞同：0
> 
> 时间：2013-02-12T01:43:34.520
> 
> 标签：c, fgets

```
//declare double pointer so that create array can "return" an array
int **aryReturn;
int size;
char trashdata[100];

//open file
FILE *inFilePtr = fopen(*(argv + 1), "r" );

if (inFilePtr != NULL)
    printf(" the value of argv 1 is %s \n", argv[1]); 

while (fgets(trashdata, sizeof(int) * 10, inFilePtr) != NULL){
    fgets(trashdata, 10, inFilePtr);
    size++;
} 
```

谁能告诉我为什么我的循环条件不起作用！我在 fgets 处收到一个显示 fp(0x0) 的段错误。我努力了

```
while (!feof(inFilePtr)) 
```

我基本上得到了同样的错误，但它说 feof 是问题所在。

我的文件似乎正确打开，因为 if 语句打印.. 并且 argv 具有预期的文件名

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:53:54.060

好吧，我看到了一些问题......

*   `size`未初始化
*   `gets()`连续调用两次似乎很奇怪，请参阅`feof()`
*   在针对 NULL 测试结果后，您没有做任何事情`fopen()`，因此第一个`gets()`可能会因为这个原因而爆炸……您收到该消息了吗？

只有最后一件事似乎可能引发异常，但我的理念始终是*修复已知问题并重新测试*......预测错误之间的交互是浪费时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:12:13.217

我认为您在参数中提供的文件名要么不存在，要么存在一些访问冲突。您可以通过在执行 fopen 命令后打印 errno 来检查这一点。

```
fprintf (stderr, "Couldn't open file %s; %s\n", argv[1], strerror (errno)); 
```

你也可以试试这个代码一次：

```
#include<errno.h>
#include<stdio.h>
int main(int argc, char **argv)
{
    int **aryReturn;
    int size=0;
    char trashdata[100];

    //open file
    FILE *inFilePtr = fopen(*(argv + 1), "r" );

    printf(" the value of argv 1 is %s \n", argv[1]);
    if (inFilePtr == NULL)
    {
        fprintf (stderr, "Couldn't open file %s; %d\n", argv[1],errno);
        exit(0);
    }
    while (!feof(inFilePtr)){
    fgets(trashdata, 10, inFilePtr);
    printf("%s",trashdata);
    size++;
    }
} 
```

# java - Java：SortedMap 出现意外的大小问题

> ID：14824142
> 
> 赞同：-1
> 
> 时间：2013-02-12T01:43:55.030
> 
> 标签：java, indexoutofboundsexception, sortedmap

这段代码：

```
intersectionMap.size() + "" + intersectionMap.isEmpty() 
```

退货

```
9true 
```

有什么想法吗？我想不出会发生这种情况的任何原因。我使用 Java 提供的 SortedMap 类型，如此处所示[SortedMap](http://docs.oracle.com/javase/6/docs/api/java/util/SortedMap.html)（集体决策，我不熟悉该类型）。

`intersectionMap`是从一组对象中获得的，这些对象是解析某些地图数据 (xml) 的结果。

也许有些大师知道发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:59:29.290

SortedMap 是一个接口。我们需要知道正在使用的实际实现。您可能没有自己创建实现，那么您必须在调试中查看它或阅读库的文档。

在我的项目中，我可以看到大约 40 种不同的 SortedMap 接口实现，因此我们几乎无法猜测您的应用程序中使用了哪一种。

如果从 AbstractMap 继承并且这两个方法都没有被覆盖，那么它几乎可以保证正常工作。这是原来的实现：

```
public boolean isEmpty() {
return size() == 0;
} 
```

# visual-studio-2012 - jquery.d.ts 中的重复标识符“nodeName”

> ID：14824143
> 
> 赞同：1
> 
> 时间：2013-02-12T01:43:59.430
> 
> 标签：visual-studio-2012, typescript

我在 Visual Studio 2012 的 TypeScript 项目中引用了 jquery.d.ts 并收到以下错误：

> 错误 1 ​​重复标识符 'nodeName' C:\DEV\MyProject\Scripts\JQuery\jquery.d.ts 786 2 pageMain.ts

这导致 jquery.d.ts 中的以下代码：

```
interface EventTarget {
    nodeName: string;
} 
```

我已经重新启动了 VS2012，然后在删除项目的所有 .sou 文件后再次启动。

我检查了我所有的参考资料（包括），没有发现对 EventTarget 的其他参考资料。

我查看了lib.d.ts，确实有一个EventTarget接口，但它没有实现nodeName。

仅供参考：我在我的机器上找到了两个 lib.d.ts 副本，并检查了它们：有谁知道编译器使用哪一个？我对两者都做了修改（将 window.alert 更改为 window.alert2），但它们没有效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T10:21:50.640

您的 jQuery.d.ts 需要更新。

这是测试问题的快速方法：

```
declare var x: EventTarget;
x.nodeName = ''; 
```

如果你在 TypeScript Playground 上运行它，你会发现它`nodeName`不存在于`EventTarget`. 事实上，如果你查看 lib.d.ts 文件，你会发现：

```
interface EventTarget {
    removeEventListener(type: string, listener: EventListener, useCapture?: bool): void;
    addEventListener(type: string, listener: EventListener, useCapture?: bool): void;
    dispatchEvent(evt: Event): bool;
} 
```

但是，如果您使用 Web Essentials 在 Visual Studio 中运行相同的代码，您会发现EventTarget 上`nodeName` *确实存在该代码。*这是因为 Web Essentials 使用的是较新版本的 lib.d.ts - 如果禁用 Web Essentials，您将收到与在 Playground 中看到的相同的错误。

随着标准定义的改进以跟上浏览器实际支持的内容，这些问题偶尔会发生。您的定义文件应进行调整以与您的开发工具保持一致，并优先更改 jquery.d.ts 等文件，而不是 lib.d.ts。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T19:19:50.067

有趣的错误，我遇到了与 className 而不是 nodeName 相同的问题

在花了一些时间尝试解决问题后，我在 jquery.d.ts 文件中找到了这篇文章链接

我正在维护 general.d.ts 文件以创建所需的接口项。我在文件中添加了以下定义

```
 interface EventTarget {
         className: string;
    } 
```

我立即收到重复标识符的错误消息。我保留它并保存了general.d.ts，然后回到我原来的工作文件，我发现编译器通过了。我的假设是 Web Essentials 错误无法正确加载定义。

# ajax - CodeIgniter 验证错误到 Ajax 打印内联

> ID：14824149
> 
> 赞同：0
> 
> 时间：2013-02-12T01:44:22.603
> 
> 标签：ajax, codeigniter, validation

我通过 ajax 将动态创建的表单字段发送到 CodeIgniter。

```
 <div class="form-element">
        <input type="radio" id="delete-radio[1]" name="delete-radio[1]" value="1">
    </div>

    <div class="form-element">
        <label for="member_id[1]">Membership ID</label>
        <input type="text" id="member_id[1]" name="member_id[]" autocomplete="off" value="<?php echo set_value('member_id[1]'); ?>"/>
        <?php echo form_error('member_id[1]', '<div class="error">', '</div>'); ?>
    </div>

    <div class="form-element">
        <label for="member_name[1]">Name</label>
        <input type="text" id="member_name[1]" name="member_name[]" autocomplete="off" value="<?php echo set_value('member_name[1]'); ?>"/>
        <?php echo form_error('member_name[1]', '<div class="error">', '</div>'); ?>
    </div>

    <div class="form-element">
        <label for="member_address[1]">Address</label>
        <input type="text" id="member_address[1]" name="member_address[]" autocomplete="off" value="<?php echo set_value('member_address[1]'); ?>"/>
        <?php echo form_error('member_address[1]', '<div class="error">', '</div>'); ?>
    </div> 
```

我使用以下内容将它们发送到他们的控制器：

```
$('#submit').click(function() {
    var form_data = $('#ajax-form').serialize();
    alert(form_data);

    $.ajax({
        url: "<?php echo site_url('ajax_ci/ajax_check'); ?>",
        type: 'POST',
        async : false,
        data: form_data,
        success: function(msg) {
            $('#form-name').append(msg);
        }
    });
    return false;
}); 
```

这是控制器：

```
if ($this->input->is_ajax_request()) {
    $this->form_validation->set_rules('member_id[]', 'member ID', 'trim|required|xss_clean');
    $this->form_validation->set_rules('member_name[]', 'member name', 'trim|required|xss_clean');
    $this->form_validation->set_rules('member_address[]', 'member password', 'trim|required|xss_clean');

    if($this->form_validation->run() == FALSE) {
        echo validation_errors();       
    } else {
        // connect to database
    }

} else {
    echo "Work on it! Don't give up!";
} 
```

下面的屏幕截图是当前发生的情况。 ![在此处输入图像描述](../Images/c509af2f59eb3cc0af43ecd4ee7aad56.png) **但我希望这些错误出现在他们各自的个人身上`form_errors`** ![在此处输入图像描述](../Images/567fea5e4dcda60aef28bc9834bf2311.png)

**在我当前的设置中这可能吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:26:32.620

在您从服务器返回的验证错误中，您需要包含有关哪个字段失败的信息。可能是 (fieldname=>errormsg) 的数组。然后，您的 ajax 响应处理程序可以找到正确的字段并将消息相应地附加到 DOM。

# python - Python 字典排序

> ID：14824153
> 
> 赞同：3
> 
> 时间：2013-02-12T01:44:57.080
> 
> 标签：python, dictionary

我正在编写一个 web 应用程序，它需要一个 json 文件，它在 python 列表中具有正确的 json 对象顺序。它应该按 x, y 排序，但无论我尝试什么，值总是返回为 y, x。

```
list: [{'y': 0.0, 'x': 1360633172168}, {'y': 0.0, 'x': 1360633172168}, ... 
```

在将值写入控制台之前，任何人都可以阐明如何重新排序这些值吗？

```
 label = ["x", "y"]
        sen = []
        for i in average:
            now = int(round(time.time() * 1000))
            l = now, i[0]
            sen.append(l)
        x = [dict(zip(label, e)) for e in sen] 
```

我尝试了几种方法，每次都得到相同的结果。

亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T01:52:46.257

唯一的解决方案是传递一个数组，或存储排序 python 端的键，并使用它访问字典。

JSON：

```
{
    "order": ["x", "y"],
    "d": {x: 34, y:36}
} 
```

PYTHON：

```
for key in order:
    print d[key] 
```

这将允许您以正确的顺序浏览 dict 键。

字典是[哈希映射](http://en.wikipedia.org/wiki/Hash_table)的一种形式，因此它们不保留键顺序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T01:58:04.700

你可能想调查[`collections.OrderedDict`](http://docs.python.org/2/library/collections.html#collections.OrderedDict)

```
In [9]: d = collections.OrderedDict()

In [10]: d['x'] = 1360633172168

In [11]: d['y'] = 0.0

In [12]: d
Out[12]: OrderedDict([('x', 1360633172168), ('y', 0.0)])

In [13]: d['x']
Out[13]: 1360633172168

In [14]: d['y']
Out[14]: 0.0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T01:52:48.050

如果您确实需要按特定顺序设置键，则需要手动构建“JSON”输出，因为 Python`dict`和`json`模块都不支持固定键顺序。

# javascript - 哪个 javascript 命令/库在边框外创建一个带有关闭按钮的对话框？

> ID：14824157
> 
> 赞同：-1
> 
> 时间：2013-02-12T01:45:16.510
> 
> 标签：javascript, user-interface

看图片。

![在此处输入图像描述](../Images/cd27f0be1e96b976b13e0b2140aaf911.png)

我不认为它是 jQuery，因为 jQuery.ui 对话框看起来不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:54:48.003

[Fancybox](http://fancybox.net/blog)可以为您做到这一点：

```
jQuery(document).ready(function() {
    $.fancybox(
        '<h2>Hi!</h2><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam quis mi eu elit tempor facilisis id et neque</p>',
        {
                'autoDimensions'    : false,
            'width'                 : 350,
            'height'                : 'auto',
            'transitionIn'      : 'none',
            'transitionOut'     : 'none'
        }
    );
}); 
```

小提琴示例：http: [//jsfiddle.net/mh9nB/](http://jsfiddle.net/mh9nB/)

# html - 标题中 div 标签的水平对齐

> ID：14824162
> 
> 赞同：1
> 
> 时间：2013-02-12T01:45:42.763
> 
> 标签：html, css, css-float

我正在尝试使我的所有 div 标签在我的标题中水平对齐....但现在它们都是垂直对齐...如何使其水平对齐....

在下面提供我的小提琴

[http://jsfiddle.net/TdcRJ/4/](http://jsfiddle.net/TdcRJ/4/)![在此处输入图像描述](../Images/d9c2d3e83749373a2a60555e2c5a2162.png)

```
<div class="navbar-inner">
        <div class="container-header">
            <!-- <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </a> -->
            <!-- <div class="clear"></div> -->

            <div class="companyLogo" style="width: 1009px;">
                <div style="
    display: inline-block;
">
                    <a class="brand" href="&lt;?= HOME_URL ;?&gt;" style="">
                    Company LOGO
                    </a>
                </div>
                <div style="clear: left;">
                    <p>47657 Lakeview Blvd</p>
                    <p>Fremont CA 94538</p>
                    <p>510-657-8981</p>
                </div>

                <div>
                    <p>welcome xyz! xyz@defie.co</p>
                </div>

                <div class="inline" style="padding-top: 12px;">

                        <ul class="homePageLists" style="">
                            <li style="padding-bottom: 5px; list-style: none; color: #333;">
                                <a style="color: #333;" href="http://www.w3schools.com/" target="_blank">
                                  <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_menu.png">
                                   Menu
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #; ">
                                <a style="color: #653921;" href="http://www.w3schools.com/" target="_blank">
                                  <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_inventory.png">
                                  Inventory
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #653921; ">
                                <a style="color: #653921;" href="http://www.w3schools.com/" target="_blank">
                                  <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_inventory.png">
                                  BOM List
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #653921; ">
                                <a style="color: #653921;" href="http://www.w3schools.com/" target="_blank">
                                    <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_inventory.png">
                                    Sub BOM List
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #9e1c20; ">
                                <a style="color: #9e1c20;" href="http://www.w3schools.com/" target="_blank">
                                    <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_product.png">
                                    Product
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #ff5100; ">
                                <a style="color: #ff5100;" href="http://www.w3schools.com/" target="_blank">
                                    <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_customer.png">
                                    Customer List
                                </a>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; color: #184179;">
                                <a style="color: #ff5100;" href="http://www.w3schools.com/" target="_blank">
                                    <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                    Vendor List
                                </a>
                            </li>
                        </ul>

                </div><!--/.nav-collapse -->

                <div>
                    <p>ABC Systems</p>
                    <p>1234 lakeview Blvd</p>
                    <p>CA 94538</p>
                    <p>510-657-8981</p>
                </div>

            </div>

            <div class="login-container">

                <form method="post" action="/Account" class="bs-docs-example form-horizontal" id="createUserForm">
                    <div class="login-box">
                        <div class="login-label">Email</div><div class="login-input"><input type="text" name="email" value=""></div>
                    </div>
                    <div class="login-box">
                        <div class="login-label">Password</div><div class="login-input"><input type="password" name="password" value=""></div>
                    </div>
                    <div class="login-button">
                    <input type="submit" value="Submit">
                    </div>
                    <div class="clear"></div>
                </form>

                        </div>          <div class="clear"></div>

        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-01T04:32:21.243

您可以将 float:left 或 float:right 放入所有 Div

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:00:40.500

`float:left;`您可以在要水平对齐的所有 DIV 中使用 css 样式。

# python - 如何从 Tkinter Text Widget 获取输入？

> ID：14824163
> 
> 赞同：138
> 
> 时间：2013-02-12T01:45:44.940
> 
> 标签：python, tkinter

如何从小`Text`部件获取 Tkinter 输入？

**编辑**

我问这个问题是为了帮助其他有同样问题的人——*这*就是没有示例代码的原因。这个问题困扰了我好几个小时，我用这个问题来教别人。*请*不要把它当作一个真正的问题来评价——答案才是最重要的。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2013-02-12T01:45:44.940

要从文本框中获取 Tkinter 输入，您必须向普通`.get()`函数添加更多属性。如果我们有一个文本框`myText_Box`，那么这就是检索其输入的方法。

```
def retrieve_input():
    input = self.myText_Box.get("1.0",END) 
```

第一部分，`"1.0"`意味着输入应该从第一行读取，字符零（即：第一个字符）。`END`是设置为字符串的导入常量`"end"`。该`END`部分意味着阅读直到到达文本框的末尾。唯一的问题是它实际上在我们的输入中添加了一个换行符。因此，为了修复它，我们应该更改`END`为`end-1c`（感谢[Bryan Oakley](https://stackoverflow.com/users/7432/bryan-oakley)）`-1c`删除 1 个字符，而`-2c`这意味着删除两个字符，依此类推。

```
def retrieve_input():
    input = self.myText_Box.get("1.0",'end-1c') 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-03-24T20:00:19.473

这是我使用 python 3.5.2 的方法：

```
from tkinter import *
root=Tk()
def retrieve_input():
    inputValue=textBox.get("1.0","end-1c")
    print(inputValue)

textBox=Text(root, height=2, width=10)
textBox.pack()
buttonCommit=Button(root, height=1, width=10, text="Commit", 
                    command=lambda: retrieve_input())
#command=lambda: retrieve_input() >>> just means do this when i press the button
buttonCommit.pack()

mainloop() 
```

这样，当我在文本小部件中输入“blah blah”并按下按钮时，我输入的任何内容都会被打印出来。所以我认为这是将用户输入从文本小部件存储到变量的答案。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-15T15:07:37.980

要从 python 3 中的文本框中获取 Tkinter 输入，我使用的完整学生级程序如下：

```
#Imports all (*) classes,
#atributes, and methods of tkinter into the
#current workspace

from tkinter import *

#***********************************
#Creates an instance of the class tkinter.Tk.
#This creates what is called the "root" window. By conventon,
#the root window in Tkinter is usually called "root",
#but you are free to call it by any other name.

root = Tk()
root.title('how to get text from textbox')

#**********************************
mystring = StringVar()

####define the function that the signup button will do
def getvalue():
##    print(mystring.get())
#*************************************

Label(root, text="Text to get").grid(row=0, sticky=W)  #label
Entry(root, textvariable = mystring).grid(row=0, column=1, sticky=E) #entry textbox

WSignUp = Button(root, text="print text", command=getvalue).grid(row=3, column=0, sticky=W) #button

############################################
# executes the mainloop (that is, the event loop) method of the root
# object. The mainloop method is what keeps the root window visible.
# If you remove the line, the window created will disappear
# immediately as the script stops running. This will happen so fast
# that you will not even see the window appearing on your screen.
# Keeping the mainloop running also lets you keep the
# program running until you press the close buton
root.mainloop() 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-01-27T15:51:47.597

为了在`Text`小部件中获取字符串，可以简单地使用[`get`](http://effbot.org/tkinterbook/text.htm#Tkinter.Text.get-method)定义的方法，`Text`该方法接受 1 到 2 个参数作为字符`start`的`end`位置，`text_widget_object.get(start, end=None)`. 如果仅`start`通过`end`且未通过，则仅返回位于 的单个字符`start`，如果`end` *也*通过，则返回位置之间的所有字符`start`并`end`作为字符串返回。

还有一些特殊的字符串，它们是底层 Tk的*变量。*其中之一将是`"end"`或代表小部件`tk.END`中最后一个字符的可变位置。`Text`一个例子是返回小部件中的所有文本，`text_widget_object.get('1.0', 'end')`或者`text_widget_object.get('1.0', 'end-1c')`如果您不想要最后一个换行符。

# 演示

请参阅下面的演示，该演示使用滑块*选择*给定位置之间的字符：

```
try:
    import tkinter as tk
except:
    import Tkinter as tk

class Demo(tk.LabelFrame):
    """
    A LabeFrame that in order to demonstrate the string returned by the
    get method of Text widget, selects the characters in between the
    given arguments that are set with Scales.
    """

    def __init__(self, master, *args, **kwargs):
        tk.LabelFrame.__init__(self, master, *args, **kwargs)
        self.start_arg = ''
        self.end_arg = None
        self.position_frames = dict()
        self._create_widgets()
        self._layout()
        self.update()

    def _create_widgets(self):
        self._is_two_args = tk.Checkbutton(self,
                                    text="Use 2 positional arguments...")
        self.position_frames['start'] = PositionFrame(self,
                                    text="start='{}.{}'.format(line, column)")
        self.position_frames['end'] = PositionFrame(   self,
                                    text="end='{}.{}'.format(line, column)")
        self.text = TextWithStats(self, wrap='none')
        self._widget_configs()

    def _widget_configs(self):
        self.text.update_callback = self.update
        self._is_two_args.var = tk.BooleanVar(self, value=False)
        self._is_two_args.config(variable=self._is_two_args.var,
                                    onvalue=True, offvalue=False)
        self._is_two_args['command'] = self._is_two_args_handle
        for _key in self.position_frames:
            self.position_frames[_key].line.slider['command'] = self.update
            self.position_frames[_key].column.slider['command'] = self.update

    def _layout(self):
        self._is_two_args.grid(sticky='nsw', row=0, column=1)
        self.position_frames['start'].grid(sticky='nsew', row=1, column=0)
        #self.position_frames['end'].grid(sticky='nsew', row=1, column=1)
        self.text.grid(sticky='nsew', row=2, column=0,
                                                    rowspan=2, columnspan=2)
        _grid_size = self.grid_size()
        for _col in range(_grid_size[0]):
            self.grid_columnconfigure(_col, weight=1)
        for _row in range(_grid_size[1] - 1):
            self.grid_rowconfigure(_row + 1, weight=1)

    def _is_two_args_handle(self):
        self.update_arguments()
        if self._is_two_args.var.get():
            self.position_frames['end'].grid(sticky='nsew', row=1, column=1)
        else:
            self.position_frames['end'].grid_remove()

    def update(self, event=None):
        """
        Updates slider limits, argument values, labels representing the
        get method call.
        """

        self.update_sliders()
        self.update_arguments()

    def update_sliders(self):
        """
        Updates slider limits based on what's written in the text and
        which line is selected.
        """

        self._update_line_sliders()
        self._update_column_sliders()

    def _update_line_sliders(self):
        if self.text.lines_length:
            for _key in self.position_frames:
                self.position_frames[_key].line.slider['state'] = 'normal'
                self.position_frames[_key].line.slider['from_'] = 1
                _no_of_lines = self.text.line_count
                self.position_frames[_key].line.slider['to'] = _no_of_lines
        else:
            for _key in self.position_frames:
                self.position_frames[_key].line.slider['state'] = 'disabled'

    def _update_column_sliders(self):
        if self.text.lines_length:
            for _key in self.position_frames:
                self.position_frames[_key].column.slider['state'] = 'normal'
                self.position_frames[_key].column.slider['from_'] = 0
                _line_no = int(self.position_frames[_key].line.slider.get())-1
                _max_line_len = self.text.lines_length[_line_no]
                self.position_frames[_key].column.slider['to'] = _max_line_len
        else:
            for _key in self.position_frames:
                self.position_frames[_key].column.slider['state'] = 'disabled'

    def update_arguments(self):
        """
        Updates the values representing the arguments passed to the get
        method, based on whether or not the 2nd positional argument is
        active and the slider positions.
        """

        _start_line_no = self.position_frames['start'].line.slider.get()
        _start_col_no = self.position_frames['start'].column.slider.get()
        self.start_arg = "{}.{}".format(_start_line_no, _start_col_no)
        if self._is_two_args.var.get():
            _end_line_no = self.position_frames['end'].line.slider.get()
            _end_col_no = self.position_frames['end'].column.slider.get()
            self.end_arg = "{}.{}".format(_end_line_no, _end_col_no)
        else:
            self.end_arg = None
        self._update_method_labels()
        self._select()

    def _update_method_labels(self):
        if self.end_arg:
            for _key in self.position_frames:
                _string = "text.get('{}', '{}')".format(
                                                self.start_arg, self.end_arg)
                self.position_frames[_key].label['text'] = _string
        else:
            _string = "text.get('{}')".format(self.start_arg)
            self.position_frames['start'].label['text'] = _string

    def _select(self):
        self.text.focus_set()
        self.text.tag_remove('sel', '1.0', 'end')
        self.text.tag_add('sel', self.start_arg, self.end_arg)
        if self.end_arg:
            self.text.mark_set('insert', self.end_arg)
        else:
            self.text.mark_set('insert', self.start_arg)

class TextWithStats(tk.Text):
    """
    Text widget that stores stats of its content:
    self.line_count:        the total number of lines
    self.lines_length:      the total number of characters per line
    self.update_callback:   can be set as the reference to the callback
                            to be called with each update
    """

    def __init__(self, master, update_callback=None, *args, **kwargs):
        tk.Text.__init__(self, master, *args, **kwargs)
        self._events = ('<KeyPress>',
                        '<KeyRelease>',
                        '<ButtonRelease-1>',
                        '<ButtonRelease-2>',
                        '<ButtonRelease-3>',
                        '<Delete>',
                        '<<Cut>>',
                        '<<Paste>>',
                        '<<Undo>>',
                        '<<Redo>>')
        self.line_count = None
        self.lines_length = list()
        self.update_callback = update_callback
        self.update_stats()
        self.bind_events_on_widget_to_callback( self._events,
                                                self,
                                                self.update_stats)

    @staticmethod
    def bind_events_on_widget_to_callback(events, widget, callback):
        """
        Bind events on widget to callback.
        """

        for _event in events:
            widget.bind(_event, callback)

    def update_stats(self, event=None):
        """
        Update self.line_count, self.lines_length stats and call
        self.update_callback.
        """

        _string = self.get('1.0', 'end-1c')
        _string_lines = _string.splitlines()
        self.line_count = len(_string_lines)
        del self.lines_length[:]
        for _line in _string_lines:
            self.lines_length.append(len(_line))
        if self.update_callback:
            self.update_callback()

class PositionFrame(tk.LabelFrame):
    """
    A LabelFrame that has two LabelFrames which has Scales.
    """

    def __init__(self, master, *args, **kwargs):
        tk.LabelFrame.__init__(self, master, *args, **kwargs)
        self._create_widgets()
        self._layout()

    def _create_widgets(self):
        self.line = SliderFrame(self, orient='vertical', text="line=")
        self.column = SliderFrame(self, orient='horizontal', text="column=")
        self.label = tk.Label(self, text="Label")

    def _layout(self):
        self.line.grid(sticky='ns', row=0, column=0, rowspan=2)
        self.column.grid(sticky='ew', row=0, column=1, columnspan=2)
        self.label.grid(sticky='nsew', row=1, column=1)
        self.grid_rowconfigure(1, weight=1)
        self.grid_columnconfigure(1, weight=1)

class SliderFrame(tk.LabelFrame):
    """
    A LabelFrame that encapsulates a Scale.
    """

    def __init__(self, master, orient, *args, **kwargs):
        tk.LabelFrame.__init__(self, master, *args, **kwargs)

        self.slider = tk.Scale(self, orient=orient)
        self.slider.pack(fill='both', expand=True)

if __name__ == '__main__':
    root = tk.Tk()
    demo = Demo(root, text="text.get(start, end=None)")

    with open(__file__) as f:
        demo.text.insert('1.0', f.read())
    demo.text.update_stats()
    demo.pack(fill='both', expand=True)
    root.mainloop() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-19T14:30:30.697

我认为这是一个更好的方法-

```
variable1=StringVar() # Value saved here

def search():
  print(variable1.get())
  return ''

ttk.Entry(mainframe, width=7, textvariable=variable1).grid(column=2, row=1)

ttk.Label(mainframe, text="label").grid(column=1, row=1)

ttk.Button(mainframe, text="Search", command=search).grid(column=2, row=13) 
```

按下按钮时，将打印文本字段中的值。但请确保您单独导入 ttk。

**基本应用程序**的**完整代码**是-

 **```
from tkinter import *
from tkinter import ttk

root=Tk()
mainframe = ttk.Frame(root, padding="10 10 12 12")
mainframe.grid(column=0, row=0, sticky=(N, W, E, S))
mainframe.columnconfigure(0, weight=1)
mainframe.rowconfigure(0, weight=1)

variable1=StringVar() # Value saved here

def search():
  print(variable1.get())
  return ''

ttk.Entry(mainframe, width=7, textvariable=variable1).grid(column=2, row=1)

ttk.Label(mainframe, text="label").grid(column=1, row=1)

ttk.Button(mainframe, text="Search", command=search).grid(column=2, row=13)

root.mainloop() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-19T18:12:30.650

我遇到了从 Text 小部件获取整个文本的问题，以下解决方案对我有用：

```
txt.get(1.0,END) 
```

其中 1.0 表示第一行，第零个字符（即在第一行之前！）是起始位置，END 是结束位置。

感谢此[链接中的 Alan Gauld](https://mail.python.org/pipermail/tutor/2005-February/035669.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-10-20T16:35:33.187

我确实也是来寻找如何从 Text 小部件获取输入数据的。关于字符串末尾换行的问题。您可以只使用 .strip() 因为它是一个始终是字符串的 Text 小部件。

此外，我正在共享代码，您可以在其中查看如何创建多个 Text 小部件并将它们作为表单数据保存在字典中，然后单击提交按钮获取该表单数据并使用它做任何您想做的事情。我希望它可以帮助其他人。它应该可以在任何 3.x python 中工作，并且可能也可以在 2.7 中工作。

```
from tkinter import *
from functools import partial

class SimpleTkForm(object):
    def __init__(self):
        self.root = Tk()

    def myform(self):
        self.root.title('My form')
        frame = Frame(self.root, pady=10)
        form_data = dict()
        form_fields = ['username', 'password', 'server name', 'database name']
        cnt = 0
        for form_field in form_fields:
            Label(frame, text=form_field, anchor=NW).grid(row=cnt,column=1, pady=5, padx=(10, 1), sticky="W")
            textbox = Text(frame, height=1, width=15)
            form_data.update({form_field: textbox})
            textbox.grid(row=cnt,column=2, pady=5, padx=(3,20))
            cnt += 1

        conn_test = partial(self.test_db_conn, form_data=form_data)
        Button(frame, text='Submit', width=15, command=conn_test).grid(row=cnt,column=2, pady=5, padx=(3,20))
        frame.pack()
        self.root.mainloop()

    def test_db_conn(self, form_data):
        data = {k:v.get('1.0', END).strip() for k,v in form_data.items()}
        # validate data or do anything you want with it
        print(data)

if __name__ == '__main__':
    api = SimpleTkForm()
    api.myform() 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-11-13T18:10:36.657

我认为创建一个简单的 Text 扩展并`text`变成一个属性是最干净的方法。然后，您可以将该扩展名粘贴在您始终导入的某个文件中，并使用它代替原始`Text`小部件。这样，您不必记住、编写、重复等所有 tkinter 让您跳过做最简单的事情的箍，您有一个可以在任何项目中重用的简单接口。您也可以对 执行此操作`Entry`，但语法略有不同。

```
import tkinter as tk

root = tk.Tk()    

class Text(tk.Text):
    @property
    def text(self) -> str:
        return self.get('1.0', 'end-1c')

    @text.setter
    def text(self, value) -> None:
        self.replace('1.0', 'end-1c', value)

    def __init__(self, master, **kwargs):
        tk.Text.__init__(self, master, **kwargs)

#Entry version of the same concept as above      
class Entry(tk.Entry):
    @property
    def text(self) -> str:
        return self.get()

    @text.setter
    def text(self, value) -> None:
        self.delete(0, 'end')
        self.insert(0, value)

    def __init__(self, master, **kwargs):
        tk.Entry.__init__(self, master, **kwargs)      

textbox = Text(root)
textbox.grid()

textbox.text = "this is text" #set
print(textbox.text)           #get  

entry = Entry(root)
entry.grid()

entry.text = 'this is text'   #set
print(entry.text)             #get

root.mainloop() 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2019-09-03T19:37:08.093

假设您有一个`Text`名为`my_text_widget`.

要从**获取**输入，`my_text_widget`您可以使用该`get`函数。

假设您已导入`tkinter`. 让我们先定义`my_text_widget`，让它只是一个简单的文本小部件。

```
my_text_widget = Text(self) 
```

要从小部件**获取**输入，`text`您需要使用该`get`功能，`text`并且`entry`小部件都具有此功能。

```
input = my_text_widget.get() 
```

我们将它保存到变量的原因是为了在进一步的过程中使用它，例如，测试输入是什么。**

# ruby-on-rails - 如何在 Rails 中创建具有不同类型的模型

> ID：14824166
> 
> 赞同：0
> 
> 时间：2013-02-12T01:46:07.490
> 
> 标签：ruby-on-rails

我想用变量 a、b 和 c 创建一个模型 Test 来响应函数 p、q 和 r。我想用变量 a、b、c、d 和 e 创建另一个模型 Supertest，它响应函数 p、q、r、s 和 t。

我可以创建一个模型 Test 并给它一个类型（常规或超级）还是必须创建两种类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T01:52:26.197

听起来你只想让一个类从另一个类继承。

这是来自[ruby​​learning.com的示例](http://rubylearning.com/satishtalim/ruby_inheritance.html)

```
class Mammal  
  def breathe  
    puts "inhale and exhale"  
  end  
end  

class Cat < Mammal  
  def speak  
    puts "Meow"  
  end  
end  

rani = Cat.new  
rani.breathe  
rani.speak 
```

# mysql - 使用 NOT IN 和多对多关系进行选择

> ID：14824168
> 
> 赞同：4
> 
> 时间：2013-02-12T01:46:27.997
> 
> 标签：mysql, many-to-many

我有一个多对多的关系

```
--------------------
| user_id | name   |
--------------------
| 1       | user1  |
--------------------
| 2       | user2  |
--------------------
| 3       | user3  |
--------------------

--------------------
| type_id | name   |
--------------------
| 1       | type1  |
--------------------
| 2       | type2  |
--------------------
| 3       | type3  |
--------------------

---------------------
| user_id | type_id |
---------------------
| 1       | 1       |
---------------------
| 1       | 2       |
---------------------
| 1       | 3       |
---------------------
| 2       | 1       |
---------------------
| 2       | 2       |
---------------------
| 3       | 3       |
--------------------- 
```

我正在尝试构建一个查询，以便如果我的用户属于 3 类，则根本不返回该用户。到目前为止，我有一个查询排除了类型 3 的用户，但如果其他类型也分配给他们，则它们将被返回。

```
SELECT COUNT(DISTINCT `t`.`user_id`) 
FROM `user` `t` 
LEFT OUTER JOIN `type` `type_type` ON (`t`.`user_id`=`type_type`.`user_id`) 
LEFT OUTER JOIN `type` `type` ON (`type`.`type_id`=`type_type`.`type_id`) 
WHERE ((type.type_ids NOT IN (3)); 
```

上面的查询仍然会返回`user_id 1`，因为该用户被分配了多种类型，我如何消除类型 3 的用户，无论他们被分配了多少其他类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T01:51:03.043

试试这个为你的`where`条款：

```
where t.user_id not in (select user_id from usertypes where type_id = 3) 
```

在 MySQL 中，以下可能更有效：

```
where not exists (select 1 from usertypes ut where ut.type_id = 3 and ut.user_id = t.user_id) 
```

顺便说一句，“t”是一个糟糕的别名`users`，尤其是当您使用另一个名为`types`. “u”将是一个更好的别名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T01:50:15.863

您的`IN()`子查询需要返回`user_id`具有`type_id = 3`.

```
SELECT
  COUNT(DISTINCT `t`.`user_id`)
FROM 
 `user` `t` 
WHERE `user_id NOT IN (SELECT `user_id` FROM `type_type` WHERE `type_id` = 3) 
```

也可以使用`LEFT JOIN`针对同一个子查询的 a 来完成，在表中查找`NULL`s 。`type_type`

```
SELECT
  COUNT(DISTINCT `t`.`user_id`)
FROM 
 `user` `t` 
 LEFT JOIN (
   SELECT `user_id` FROM `type_type` WHERE `type_id` = 3
 ) user3 ON t.user_id = user3.user_id
WHERE user3.type_id IS NULL 
```

[http://sqlfiddle.com/#!2/b36b1/7](http://sqlfiddle.com/#!2/b36b1/7)

实际上，连接子查询甚至不是必需的。它适用于普通的`LEFT JOIN`.

```
SELECT
  COUNT(DISTINCT `t`.`user_id`)
FROM 
 `user` `t` 
 LEFT JOIN type_type ON t.user_id = type_type.user_id AND type_type.type_id = 3
WHERE type_type.type_id IS NULL 
```

[http://sqlfiddle.com/#!2/b36b1/10](http://sqlfiddle.com/#!2/b36b1/10)

# visual-studio - 无法控制 Visual Studio 中的启动项目

> ID：14824174
> 
> 赞同：3
> 
> 时间：2013-02-12T01:46:54.577
> 
> 标签：visual-studio, visual-studio-2012, project, startup

Visual Studio 2012 不允许我设置多个启动项目。

我努力了：

*   右键单击解决方案/设置启动项目...

    结果：什么都没有发生。

*   查看/[属性页](http://msdn.microsoft.com/en-us/library/a1awth7y%28v=vs.110%29.aspx)

    结果：弹出“对象引用未设置为对象的实例。”

我没有运行加载项，并禁用了所有无需卸载即可禁用的扩展。主动扩展是

*   微软网络开发工具
*   NuGet 包管理器
*   适用于 JavaScript 的 Windows 库的 Visual Studio 扩展（1.0.8377.0 和 1.0.9200.20512
*   视觉SVN

这是一个已知的问题？有修复/解决方法吗？如果 VS2012 UI 继续失败，我可以通过编辑 .sln/.csproj 文件来指定启动项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-13T00:34:28.863

我很确定这与`NuGet Package Manager`. 我按照[这里](https://stackoverflow.com/a/13746023/114029)的描述做了。

`Tools => Extensions and Updates...`在Visual Studio 2012/Visual Studio 2013 Preview中卸载 NuGet 包管理器并重新启动。现在我可以愉快地再次配置我的解决方案属性了！

再次安装`NuGet Package Manager`，问题又出现了。:(

这是一个姑息的答案。如果有明确的答案，请分享！:)

[确保您对此Connect Bug](http://connect.microsoft.com/VisualStudio/feedback/details/763961/cannot-open-property-pages-for-solution)投票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-29T16:03:52.237

在搜索我遇到的相关问题时发现了这篇文章。我认为其他人知道我发现了什么会有所帮助。

我的问题是试图在启动项目之间切换，IIS Express 总是会加载同一个项目。我的解决方案是编辑项目属性>Web> 为每个项目分配不同的端口号。现在，当我选择设置为启动项目时...它实际上可以工作

注意**我在使用 NuGet 时没有任何问题，可能是因为我使用的是 2013 的发布版本

# jsf-2 - 获取 SelectOneMenu 的选定值

> ID：14824178
> 
> 赞同：5
> 
> 时间：2013-02-12T01:47:45.887
> 
> 标签：jsf-2, managed-bean, selectonemenu

我正在 jsf 页面上测试组件“SelectOneMenu”。我通过我的 ManageBean 动态地填充这个组件（这将从数据库中获取所有动物）。

我想知道是否可以看到该“SelectOneMenu”（组合框）的用户选择项，我正在尝试使用 value="#{animalsManage.animalSelect}" 但它只在页面的开头被调用。另外，我正在使用 inputText 来查看“SelectOneMenu”的选定项的值。

我做错了什么？

JSF：

```
 <body>
    <ui:component>
        <h:form>
                    <h:outputText value="Select one Mets File" />
                    <h:selectOneMenu id="combo" value="#{animalsManage.animalSelected}">
                        <f:selectItem itemLabel="Select..."  noSelectionOption="true"/>
                        <f:selectItems value="#{animalsManage.allAnimals}" />
                    </h:selectOneMenu>
                    <h:inputText id="textbox" value="#{animalsManage.animalSelected }" />
        </h:form>
    </ui:component>
</body> 
```

管理豆：

```
 @ManagedBean
    @ViewScoped
    public class AnimalsManage implements Serializable {

    @EJB
    private AnimalsFacadeREST animalsFacadeREST;
    private String animalSelected;
    private List< SelectItem> selectAnimals;

    public List<SelectItem> getAllAnimals() {
            List<Animals> al = animalsFacadeREST.findAll();
            selectAnimals = new ArrayList< SelectItem>();
            int i = 0;
            for (Animals animal: al) {
                selectAnimals.add(new SelectItem(i, animal.getName()));
                i++;
            }
            return selectAnimals;
    }

    public String getAnimalSelected() {
       return animalSelected;
    }

    public void setAnimalSelected(String animalSelected) {
        this.animalSelected = animalSelected;
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T13:02:13.323

提出的问题有很多解决方案。我在这里提出两个基本思想。

1.  服务器端解决方案。只需`<f:ajax>`在您的内部附加标签`<h:selectOneMenu>`即可更新选定的值并重新呈现用户的选择，例如

    ```
    <h:selectOneMenu id="combo" value="#{animalsManage.animalSelected}">
        <f:selectItem itemLabel="Select..."  noSelectionOption="true"/>
        <f:selectItems value="#{animalsManage.allAnimals}" />
        <f:ajax execute="combo" render="textbox" />
    </h:selectOneMenu>
    <h:inputText id="textbox" value="#{animalsManage.animalSelected }" /> 
    ```

    如果您愿意，您还可以通过指定标记`listener="#{animalsManage.performCustomAjaxLogic}"`对ajax 侦听器中的选定元素执行一些自定义逻辑。`<f:ajax>`

2.  客户端解决方案。只需在基本更改事件中使用 id="textbox" 更新元素。因此，如果您使用 jQuery，解决方案将是

    ```
    $('#combo').change(function() {
        $('#textbox').val($('#combo').val());
    }); 
    ```

    认为客户端解决方案只会绑定输入组件的文本值。

# ruby - 类型错误：无法访问 Mail::Multibyte::Chars

> ID：14824179
> 
> 赞同：2
> 
> 时间：2013-02-12T01:47:49.197
> 
> 标签：ruby

我最近更新了 Gemfile 上的 gems 并开始获取：

```
irb(main):002:0> User.new(:email => "foob@gmail.com").valid?
TypeError: Cannot visit Mail::Multibyte::Chars 
```

用户模型关系：

```
validates_uniqueness_of :email 
```

如果我们取消验证，一切正常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T03:46:00.760

我在我的 Sinatra 应用程序中遇到了同样的问题，它似乎是由邮件 gem 引起的。我可以通过在 Bundle.require 之前要求“active_support”来修复它：

```
require 'active_support'

Bundler.require(:default, ENV['RACK_ENV'].to_sym) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-02T23:30:04.367

[我正在运行的Mailman](https://github.com/titanous/mailman)脚本遇到了这个问题。我通过更改脚本的运行方式来修复它，从：

```
bundle exec script/mailman.rb 
```

至

```
bundle exec rails runner script/mailman.rb 
```

我怀疑我也可以在 Mailman 之前在实际脚本中加载 Rails。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T12:21:19.740

因为我是一个信守诺言的人：

我的修复是移动`gem pony`到我的 Sinatra 应用程序中 Gemfile 中加载的最后一个 gem。

当我尝试时，Cory 的解决方案并不存在，fwiw。

# mysql - mySQL 查询键值对

> ID：14824180
> 
> 赞同：0
> 
> 时间：2013-02-12T01:47:52.220
> 
> 标签：mysql, wordpress

我正在对 wordpress 表（postmeta）进行查询。该表有键和值，我需要一个查询来获取匹配“key1”等于“value1”和“key2”等于“value2”的所有行，按 value2 排序

该表基本上有一个 id、postid、key 和 value 列。

我什至不确定从哪里开始。我可以找到一个很好的值，即...其中 key='featured' & value=true。但是我需要按 key='hits' 的行的值排序的前 25 个值，这意味着我需要那些精选行的相应 hits 键的值

我不知道该怎么做。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:29:14.353

使用您提供的有限细节很难准确地说出如何做到这一点。但是当您想返回键/值对时，您可以使用以下内容。

您可以多次加入您的桌子：

```
select p1.postid,
  p1.value Featured,
  p2.value Hits
from postmeta p1
left join postmeta p2
  on p1.postid = p2.postid
  and p2.key = 'hits'
where p1.key ='featured'; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/04209/1)

或者您可以将聚合函数与`CASE`表达式一起使用（使用`sum()`假定为数值，您可以将`max()`/`min()`用于字符串值：

```
select postid,
  sum(case when `key` = 'featured' then value end) Featured,
  sum(case when `key` = 'hits' then value end) Hits
from postmeta
group by postid 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/04209/3)

# mongodb - 使用嵌入式文档编辑模型（Lithium Framework - MongoDB）

> ID：14824188
> 
> 赞同：2
> 
> 时间：2013-02-12T01:48:44.163
> 
> 标签：mongodb, lithium

我正在使用 Lithium PHP Framework - 与 MongoDB 数据库 - 为我的应用程序创建一些输入/编辑表单。

我在 MongoDB 中使用嵌入式文档的概念。我花了一些时间来调整初始保存，但我已经设置好了，所以它可以正常工作。

当我查看 MongoDB 时 - 我的对象如下所示：

```
 {
     _id: "5119951516c19",
     level_name: "Testing",
     questions: [
       {
           question_id: "5119951516cb5",
           question_text: "Why is the sky blue"
       },
       {
           question_id: "5119951516cc3",
           question_text: "Why is grass green"
       }
    ]
 } 
```

现在，如果我想做一个非常简单的编辑，例如：

```
$level = Levels::find($id);
$level["level_name"] = "Testing - UPDATE";
$level->save(); 
```

好消息是有问题的领域可以保存。但是，坏消息是它破坏了我的整个对象模型。MongoDB 中的新对象模型保存如下：

```
{
  0: {
    question_id: "5119951516cb5",
    question_text: "Why is the sky blue"
   },
  1: {
    question_id: "5119951516cc3",
    question_text: "Why is grass green"
  },
  _id: "5119951516c19",
  level_name: "Testing - UPDATE",
  questions: [
    {
      question_id: "5119951516cb5",
      question_text: "Why is the sky blue"
    },
    {
      question_id: "5119951516cc3",
      question_text: "Why is grass green"
    }
  ]
} 
```

基本文档保持不变 - 但不知何故，嵌入式文档在键“0”和“1”下被扔到顶层。

我搜索了高低，我无法弄清楚为什么会发生这种情况。由于我的保存功能非常简单，我假设这是 Lithium 中的一个错误。这很好——只要我有办法绕过它。

提前致谢。

# algorithm - 信息检索：时间范围内的 URL 命中

> ID：14824189
> 
> 赞同：0
> 
> 时间：2013-02-12T01:48:45.750
> 
> 标签：algorithm, information-retrieval

算法挑战：

问题陈述：您将如何为 Google 之类的东西设计日志系统，您应该能够查询在两个时间范围内打开 URL 的次数。

i/p : start_time , end_time , URL1 o/p : URL1 在开始和结束时间之间打开的次数。

一些规范： 数据库不是最佳解决方案 对于给定的时间戳，可能已多次打开 URL。一个 URL 可能在两个时间戳内被打开了很多次。start_time 和 end_time 可以相隔一个月。时间可以精确到一秒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T01:49:21.753

一种解决方案：

哈希的哈希

键值 URL 哈希----> T1 CumFrequency

例如：

Amazon Hash--> T CumFreq 11 00 am 3（上午 11:00 开 3 次） 11 15 am 4（上午 11:15 开 1 次，cumfreq 为 3+1=4） 11 30 am 11（开 4时间在上午 11:30 时，cumfreq 为 3+4+4=11) i/p : 11:10 am , 11 : 37 am , Amazon

可以通过减去最后一个时间戳小于 11:10 即上午 11:00 和最后一个活动时间戳小于上午 11:37 即上午 11:30 来获得操作。因此结果是 11-3 = 8 ....

我们能做得更好吗？

# python - 完整性错误。在表上插入或更新违反外键约束

> ID：14824195
> 
> 赞同：1
> 
> 时间：2013-02-12T01:49:19.607
> 
> 标签：python, django, django-models

我一直在努力解决这个问题。我正在使用 CSV 在 django 中导入数据，但这不是我的问题。

插入数据时出现此错误：

```
IntegrityError at /import-user-profile/
insert or update on table "association_userprofile_club" violates foreign key constraint "association_userprofile_club_club_id_fkey"
DETAIL:  Key (club_id)=(0) is not present in table "association_club". 
```

使用 postgreSQL，不知道是不是这个原因。

以下是相关型号：

```
class UserProfile(models.Model):  
    user = models.OneToOneField(User)  
    membership_number = models.CharField(max_length=30,help_text='Membership number.')
    club = models.ManyToManyField(Club)
    date_joined = models.DateField(blank=True)
    street_address = models.CharField(max_length=100,help_text='Max 100 characters.',blank=True)
    suburb = models.CharField(max_length=40,help_text='Max 40 characters.',blank=True)
    postcode = models.CharField(max_length=10,help_text='Max 6 characters.',blank=True)
    state = models.CharField(max_length=30,help_text='Max 4 characters.',blank=True)
    home_phone = models.CharField(max_length=30,help_text='Max 30 characters.',blank=True)
    mobile_phone = models.CharField(max_length=30,help_text='Max 30 characters.',blank=True)
    ticketed_steward = models.CharField(max_length=1, choices=[('0', 'No'), ('1', 'Yes')],blank=True)
    ticketed_time_keeper = models.CharField(max_length=1, choices=[('0', 'No'), ('1', 'Yes')],blank=True)
    AFA_judge = models.CharField(max_length=1, choices=[('0', 'No'), ('1', 'Yes')],blank=True)
    associate_members = models.ManyToManyField(User,blank=True, related_name='+')

    def __str__(self):  
          return "%s's profile" % self.membership_number 
```

和

```
class Club(models.Model):
    club_name = models.CharField(max_length=50,help_text='Name of the club, MAX 50 characters.')
    club_coordinater = models.CharField(max_length=50,blank=True)
    contact_email = models.EmailField(blank=True)
    contact_phone = models.CharField(max_length=30,blank=True)
    contact_fax = models.CharField(max_length=30,blank=True)
    address_location = models.CharField(max_length=50,blank=True)
    address_suburb = models.CharField(max_length=50,blank=True)
    address_postcode = models.CharField(max_length=50,blank=True)
    address_state = models.CharField(max_length=4,help_text='State the club is in, MAX 4 characters.',blank=True)
    incorporated = models.CharField(max_length=3, choices=[('0', 'No'), ('1', 'Yes')],blank=True)
    old_id = models.CharField(max_length=20,blank=True)
    website = models.URLField(blank=True)
    joined = models.DateField(blank=True)

    def __unicode__(self):
        return self.club_name 
```

这应该可以正常工作，因为俱乐部正在正确返回。

```
def import_user_profile(request):
    if request.user.is_authenticated():
        file = database_loc + "tblHandlers.csv"
        data = ""
        with open(file, 'rb') as f:
            reader = csv.reader(f)
            for row in reader:
                if row[0] != "pkMemberNumber":
                    #0:pkMemberNumber 1:Club 2:fldContactOpen 3:fldLastName 4:fldFirstName 5:fldStreet 6:fldSuburb 7:fldState 8:fldPostcode 9:fldHome 10:fldMobile 11:fldEmail 12:fldJunior 13:fldNewsletter 14:fldNotes 15:dtejoined 16:dteExpiry 17:dateRenewed 18:fldFinMem1 19:fldFinMem2 20:fldDOB 21:fldHanderAge 22:fldStewTicket 23:fldTimeTicket 24:fldSnrTimeTicket
                    user = User.objects.get(username=row[0]+row[4]+row[3])

                    try:
                        club = Club.objects.get(club_name=str(row[1]))
                        club.save()
                    except:
                        club = Club.objects.get(club_name="No Club")
                        club.save()

                    try:
                        profile = UserProfile.objects.get(user=user)
                    except:
                        profile = UserProfile(user=user)

                    #profile.user=user
                    profile.membership_number=row[0]
                    thing = str(club.id)
                    profile.club=thing
                    profile.date_joined=date_re(row[15])
                    profile.street_address=row[5]
                    profile.suburb=row[6]
                    profile.postcode=row[8]
                    profile.state=row[7]
                    profile.home_phone=row[9][0:30]
                    profile.mobile_phone=row[10]
                    profile.ticketed_steward=row[22]
                    profile.ticketed_time_keeper=row[23]
                    profile.AFA_judge="0"
                    profile.save()

                    user_receipts = UserReceipts(user_id=profile.id,recept="",date_paid=date_re(row[17]),membership_valid_to=date_re(row[16]))  
        html = "<html><body>" + data + "</body></html>"
        return HttpResponse(html) 
```

Django说问题发生在：

```
profile.club=thing 
```

一些帮助可以挽救我的理智！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:12:57.630

```
 try:
     club = Club.objects.get(club_name=str(row[1]))
     club.save() # <-- You don't need to save. You haven't changed anything on the club.
 except:
     club = Club.objects.get(club_name="No Club")
     club.save() # <-- You don't need to save. You haven't changed anything on the club. 
```

django 声明的模型 id 是数字的，所以不要使用`thing = str(club.id)`.

此外，使用属性`pk`比使用属性更可取，`id`因为`pk`它将始终指向真正的主键名称。这意味着如果您更改了模型的主键，则无需更改`id`代码中的所有访问权限。

您需要更改`profile.club=thing`为，`profile.club.add(club.pk)`因为您的`club`属性被声明为 a `models.ManyToManyField(Club)`，它是一系列`Club`对象，而不是单个对象。

或者...您可以更改它并使用`models.ForeignKey(Club)`与属性名称 ( ) 更一致的a `club`（仅在您的用户只能同时是一个俱乐部的成员时这样做）

# java - 无法正确格式化 setText()

> ID：14824196
> 
> 赞同：1
> 
> 时间：2013-02-12T01:49:20.497
> 
> 标签：java, android, textview, settext

我正在尝试将 a 的文本设置为`TextView`“（+teamName）分数：”

我目前拥有的： `textview1.setText(+teamName "Score:");` 包含一个错误，因为标准格式应该是`("" + teamName)`

**我如何让它显示`TextView`THEN 引号？这甚至可能吗？**

（注意：`teamName`指向一个字符串）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T01:50:49.627

这是可能的。`+`在需要的地方使用字符串变量 ( `teamName`) 和`"Score: "`

```
textview1.setText(teamName + " Score:"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T01:51:48.043

```
String text = String.format("%s Score", teamName);
textview1.setText(text); 
```

# php - Symfony2 表单在提交时编码密码

> ID：14824198
> 
> 赞同：2
> 
> 时间：2013-02-12T01:49:22.773
> 
> 标签：php, forms, symfony

我为自定义用户对象构建了一个用户类型。其中一个字段是密码。

理想情况下，当我将表单作为数据转换器/相关提交时，我希望它对密码进行编码，而不必在控制器中处理它。但是，它是一个加盐密码，所以这会带来一个问题，因为我喜欢在每次生成密码时重新生成盐。我不知道有什么方法可以将这个额外的值输入到我的 DataTransformer 中。

所以，我基本上有两个问题：

*   让它作为 UserType (AbstractType) 的一部分进行编码是一个好/坏的主意，还是应该在控制器中处理它？
*   我如何将所需的信息传递给我的 DataTransformer 以使这成为可能？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T03:38:39.247

因此，我进行了一些挖掘和查找，并从 FOSUserBundle 中获得了一些线索。

要回答我的第一个问题，看起来两者都不是最好的选择，因此使第二个问题变得毫无意义。

我最终做了什么：

*   向我的用户实体添加一个新字段，`$plainPassword`. 然后我将我的 UserType 的映射更改为该字段，而不是直接更改 $password。
    *   一定要`$plainPassword`填空`User::eraseCredentials`
*   制作了一个名为 UserManager 的新服务。在此，我给了它一个`updateUser()`处理密码实际编码的函数（不再由控制器处理，耶！）。

这或多或少是 FOSUserBundle 所做的。然后他们手动调用 updateUser（我相信来自控制器）。但是，我希望能够在很大程度上忘记这一步。这就是 Doctrine Events 发挥作用的地方。

我添加了两个 Doctrine 事件侦听器（都到 UserManager）：prePersist 和 preUpdate。

两者都基本上检查我们是否正在处理用户对象，然后调用`updateUser()`以更新用户的密码。preUpdate 必须有一个额外的步骤来手动设置新值。

为确保它触发，`User::setPlainPassword()`清除密码并刷新我的盐（这是必要的，因为 plainPassword 不是映射属性，因此仅更改它不会允许用户触发 preUpdate）。

很多移动的部分，但现在我有了它，每当我`User::setPlainPassword()`用来更改明文密码（无论在哪里），它现在都会正确编码并保存实际的密码值。哇！

* * *

```
namespace My\Bundle\UserBundle\DependencyInjection;

use Doctrine\ORM\Event\PreUpdateEventArgs;
use Doctrine\ORM\Event\LifecycleEventArgs;
use My\Bundle\UserBundle\Entity\User;
use Symfony\Component\Security\Core\Encoder\EncoderFactoryInterface;

class UserManager
{
    protected $encoderFactory;

    public function __construct(EncoderFactoryInterface $encoderFactory)
    {
        $this->encoderFactory = $encoderFactory;
    }

    public function getEncoder(User $user)
    {
        return $this->encoderFactory->getEncoder($user);
    }

    public function updateUser(User $user)
    {
        $plainPassword = $user->getPlainPassword();

        if (!empty($plainPassword)) {
            $encoder = $this->getEncoder($user);
            $user->setPassword($encoder->encodePassword($plainPassword, $user->getSalt()));
            $user->eraseCredentials();
        }
    }

    public function preUpdate(PreUpdateEventArgs $event)
    {
        $user = $event->getEntity();

        if (!($user instanceof \GamePlan\Bundle\UserBundle\Entity\User)) {
            return;
        }

        $this->updateUser($user);
        $event->setNewValue('password', $user->getPassword());
        //die($event->getOldValue('password') . ' ' . $event->getNewValue('password') . ' ' . $event->hasChangedField('password') ? 'Y' : 'N');
    }

    public function prePersist(LifecycleEventArgs $event)
    {
        $user = $event->getEntity();

        if (!($user instanceof \GamePlan\Bundle\UserBundle\Entity\User)) {
            return;
        }

        $this->updateUser($user);
    }
} 
```

* * *

```
// In My\Bundle\UserBundle\Entity\User
public function setPlainPassword($plainPassword)
{
    $this->plainPassword = $plainPassword;

    // Change some mapped values so preUpdate will get called.
    $this->refreshSalt(); // generates a new salt and sets it
    $this->password = ''; // just blank it out
} 
```

* * *

```
# In My/Bundle/UserBundle/Resources/config/services.yml
services:
    my_user.manager:
        class: My\Bundle\UserBundle\DependencyInjection\UserManager
        arguments:
            - @security.encoder_factory
        tags:
            - { name: doctrine.event_listener, event: prePersist }
            - { name: doctrine.event_listener, event: preUpdate } 
```

# c++ - 数字格式构造？

> ID：14824204
> 
> 赞同：-2
> 
> 时间：2013-02-12T01:49:57.367
> 
> 标签：c++

在二进制`01010`、八进制`01122`、十进制整数`1234`和十六进制之外`0xFF`，有没有人知道**如何构建新的数字格式**？例如，**`0x11AEGH`**它的范围是否从**`0`**-**`9`**到**`A`**- **`H`**。我将构建密码生成器，所以如果有人可以在上面放一些可能有帮助的东西，那将非常有帮助。

首先，是否有任何功能可以做到这一点？基本上我想转换`0x11AEGH`成二进制，八进制，整数等等......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T01:55:35.567

在 N 元系统中格式化一个数字需要两件事：一个字母表，以及获得整数除法 + 余数结果的能力。

考虑使用拉丁字母在 base-26 系统中格式化数字。重复获得`R`除以 26 的余数，选择字母 number `R`，并将其添加到您正在格式化的数字的前面。将数字除以 26 的整数，并将其用于算法的下一步。当你到达零时停止。

例如，如果您`1234`使用 base-26 打印，您可以这样做：

*   1234 % 26 是 12 `M`。1234/26 为 47
*   47 % 26 是 21 `V`。47 / 26 是 1
*   1 % 26 是 1。添加`B`。1 / 26 为零；停止。

所以`1234`在 base-26 中是`BVM`.

要转换回来，从前面开始，然后`A`从每个数字中依次减去指定的“零”（在上面的例子中），如下所示：

*   `B`-`A`是 1。结果是`1`
*   `V`-`A`是 21。结果是 1*26+21，即 47
*   `M`-`A`是 12。结果是 47*26+12，即 1234。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T08:17:02.380

您可能可以使用[Long.parseLong(String representation, int radix) 之](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Long.html#parseLong%28java.lang.String,%20int%29)类的函数，`Long.toString(long value, int radix)`就像它们在 Java 中一样。其他语言也可能具有类似的功能。

这种方法限制了最大可能的基数（基数），并且您无法控制表示不同数字的字符（使用字母数字字符）。然而，它是一个现成的解决方案，无需任何额外的编码。

# build-process - 如何从 guice 源构建 guice-3.0-no_aop.jar

> ID：14824209
> 
> 赞同：0
> 
> 时间：2013-02-12T01:50:35.910
> 
> 标签：build-process, guice

目前在我们的 Android 项目中，我们正在为 Guice 链接 guice-3.0-no_aop.jar。我需要围绕注入做一些计时测量，所以我查看了 Guice 的源代码（git clone [https://code.google.com/p/google-guice/](https://code.google.com/p/google-guice/)），但不知道如何制作所需的文件。我已经尝试使用 build.xml 中列出的不同选项（例如“ant jar”或“ant dist”）进行 ant build，但这些都不会生成文件。

那么谁能告诉我如何从源代码构建这个jar？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:21:43.250

来自 google-guice 组：

如果你想使用 Ant：

```
ant no_aop<br>
cd build/no_aop<br>
ant jar<br>
cd ../.. 
```

并且 no_aop 风味罐可以在以下位置找到：

```
build/no_aop/build/dist/guice-snapshot.jar 
```

IE。"build/no_aop" 下的树就像原始树一样，但已被 'munged' 以删除 AOP，因此它仍然使用二进制文件的原始文件名

如果你想使用 Maven：

```
mvn package 
```

并且 no_aop 风味罐可以在以下位置找到：

```
core/target/guice-<version>-no_aop.jar 
```

与 Maven 的不同之处在于“munging”是作为主构建的一部分完成的，并且“no_aop”风味 jar 附加在原始 jar 旁边

# sql - 如何根据另一个字段中的数量创建将一行转换为多行的视图？

> ID：14824212
> 
> 赞同：1
> 
> 时间：2013-02-12T01:50:51.577
> 
> 标签：sql, sql-server-2008

我正在使用 Microsoft SQL

我有一个表 CR_INVLINES 显示如下

```
STOCKCODE     QTY   BARCODE  
GUITAR101     3     456812313
DESK          1     568123122
LAMP          2     845646962 
```

*我需要我的视图返回的是数量倍数的行，如下所示：*

```
STOCKCODE       BARCODE
GUITAR101       456812313
GUITAR101       456812313
GUITAR101       456812313
DESK            568123122
LAMP            845646962
LAMP            845646962 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:05:00.143

您可以使用递归 CTE 来获得结果：

```
;WITH CTE AS
(
    SELECT *
    FROM CR_INVLINES
    UNION ALL 
    SELECT stockcode, qty-1, BARCODE
    FROM CTE
    WHERE qty-1 >= 1
)
SELECT STOCKCODE, Barcode
FROM CTE
order by stockcode
OPTION(MAXRECURSION 0); 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/2d44f/4)

这给出了结果：

```
| STOCKCODE |   BARCODE |
-------------------------
|      DESK | 568123122 |
| GUITAR101 | 456812313 |
| GUITAR101 | 456812313 |
| GUITAR101 | 456812313 |
|      LAMP | 845646962 |
|      LAMP | 845646962 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T01:55:59.030

好吧，为此，您需要一个数字表。这是一个在许多情况下都有效的快速简便的解决方案：

```
with numbers as (
       select row_number() over (order by (select null)) as num
      )
select il.stockcode, barcode
from CR_INVLINES il join
     numbers n
     on il.qty <= n.num 
```

更正式的答案是这样的：

```
with digits as (
     select 0 as d union all select 1 union all select 2 union all select 3 union all select 4 union all
     select 5 union all select 6 union all select 7 union all select 8 union all select 9
   ),
   numbers as (
    select d1.d*100+d2.d*10+d3.d
    from digits d1 cross join digits d2 cross join digits d3
   )
select il.stockcode, barcode
from CR_INVLINES il join
     numbers n
     on il.qty < n.num 
```

（请注意`<=`更改为，`<`因为这组数字现在有一个 0。）

# hadoop - Hadoop Reducer：如何使用推测执行输出到多个目录？

> ID：14824215
> 
> 赞同：1
> 
> 时间：2013-02-12T01:51:03.030
> 
> 标签：hadoop, speculative-execution

我有一个 reducer，它需要将结果输出到不同的目录，以便我们以后可以将输出用作 Hive 作为分区表的输入。（Hive 基于文件夹名称创建分区）。为了写出这些位置，我们目前没有使用任何 Hadoop 框架来完成这项工作，我们只是在“Hadoop 背后”的不同位置写出，可以这么说。换句话说，我们没有使用 hadoop 的 API 来输出这些文件。

我们遇到了`mapred.reduce.tasks.speculative.execution`set to的问题`true`。我理解是这种情况，因为同一任务的多个任务尝试正在写入同一位置。

有没有办法正确使用Hadoop的API从同一个reducer输出到几个不同的文件夹，这样我也可以使用`mapred.reduce.tasks.speculative.execution=true`？（我知道 MultipleOutputs，我不确定它是否支持推测执行。）

如果是这样，有没有办法做到这一点*并*输出到 S3？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:47:06.203

Hadoop 通常处理推测执行的方式是为每个任务尝试创建一个输出文件夹（在实际 HDFS 输出目录的 _temporary 子文件夹中）。

当任务成功时， `OutputCommitter`for `OutputFormat`then 只是将临时任务文件夹的内容移动到实际的输出文件夹，并删除那些失败/中止的其他临时任务文件夹（这是大多数`FileOutputFormat`s 的默认行为）

因此，对于您的情况，如果您要写入作业输出文件夹之外的文件夹，那么您需要扩展/实现自己的输出提交程序。在创建文件时，我会遵循相同的原则——包括完整的任务 ID（包括尝试 ID），以避免在推测执行时发生名称冲突。如何跟踪作业中创建的文件并管理中止/失败场景中的删除取决于您（可能是任务 ID 的一些文件通配符？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T04:49:38.773

您可能对此感兴趣： http: [//hadoop.apache.org/docs/r2.3.0/api/org/apache/hadoop/mapreduce/lib/output/MultipleOutputs.html](http://hadoop.apache.org/docs/r2.3.0/api/org/apache/hadoop/mapreduce/lib/output/MultipleOutputs.html)

# ruby-on-rails - 在 Rails 应用程序中显示 Dropbox API thumbnail() 的响应

> ID：14824220
> 
> 赞同：0
> 
> 时间：2013-02-12T01:51:44.160
> 
> 标签：ruby-on-rails, dropbox-api

我已在我的 rails 应用程序中成功返回了一个`thumbnail()`请求（使用[Dropbox SDK](https://www.dropbox.com/developers)），但我不明白如何处理响应。我想在网页上显示缩略图。

我还尝试将响应保存到 tmp 文件，但得到`UndefinedConversionError`("\xFF" from ASCII-8BIT to UTF-8) 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-17T16:00:18.430

我实际上正在做你所要求的。我所做的是将返回的字节转换为 base64 字符串。在 C# 中这很容易，因为有一个转换函数可以做到这一点。

然后，在网页上，您必须将 img 标签的 src 属性设置为

```
<img src="data: image/jpg;base64,PlaceBase64StringHere"...../> 
```

转换后的字符串有一点开销，但它很容易处理，您可以使用客户端浏览器的强大功能来呈现图像。

# asp.net - 如何遍历数据表中的行？

> ID：14824227
> 
> 赞同：1
> 
> 时间：2013-02-12T01:52:30.393
> 
> 标签：asp.net, vb.net

我在获取循环以查看更多数据时遇到了一些麻烦，而不仅仅是第一行数据。引用的数据集函数可以毫无问题地获取所有必需的行，因此我确定问题一定出在代码上。

```
Dim dtLogin As System.Data.DataTable
    Dim userDetails As New dsMembersTableAdapters.mi_membersTableAdapter
    Dim rowsLogin As System.Data.DataRow

    'Fill datatable using method from dataset
    dtLogin = userDetails.GetUserData()

    'Find cotrols hidden in Login View
    Dim user As String = txtUser.Text
    Dim pass As String = txtPass.Text

    'Search all users
    For Each rowsLogin In dtLogin.Rows
        'Find Username Entered
        If user = dtLogin.Rows.Item(0).Item(1) Then
            'Checks users password matches
            If pass = dtLogin.Rows.Item(0).Item(2) Then
                If dtLogin.Rows.Item(0).Item(6) = 1 Then
                    'Log User In
                    FormsAuthentication.RedirectFromLoginPage(dtLogin.Rows.Item(0).Item(1), True)
                Else
                    'Account Not Active Message
                    lblValidation.Text = "There is a problem with your account, please contact the website administration"
                End If
            Else
                'Incorrect Password Message
                lblValidation.Text = "Incorrect Password"
            End If
        Else
            'No User in DB Message
            lblValidation.Text = "No User Found" + dtLogin.Rows.Item(0).Item(1)
        End If
    Next 
```

如果有人可以提供帮助或直接指向我，那就太好了！提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:56:44.910

当您使用时，`For Each rowsLogin In dtLogin.Rows`您是在告诉编译器，对于每个`dtLogin.Rows`项目，将其分配给变量`rowsLogin`.

所以，每次，在循环内，你停止使用`dtLogin.Rows.Item(0).Item(2)`like in`If pass = dtLogin.Rows.Item(0).Item(2) Then`而是`If pass = rowsLogin.Item(0).Item(2) Then`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T10:49:32.843

```
dim bUserFound as boolean = false       
For Each rowsLogin In dtLogin.Rows
            'Find Username Entered
            If user = rowsLogin(1) Then
bUserFound = true
                'Checks users password matches
                If pass = rowsLogin(2) Then
                    If rowsLogin(6) = 1 Then
                        'Log User In
                        FormsAuthentication.RedirectFromLoginPage(rowsLogin(1), True)
                    Else
                        'Account Not Active Message
                        lblValidation.Text = "There is a problem with your account, please contact the website administration"
                    End If
                Else
                    'Incorrect Password Message
                    lblValidation.Text = "Incorrect Password"
                End If
            Else
                'No User in DB Message
               ' lblValidation.Text = "No User Found" + rowsLogin(1)

            End If
        Next 

if not bUserFound then
lblValidation.Text = "No User Found"
end if 
```

要获得更清晰的代码，您应该使用 rowsLogin("USER_NAME") 而不是 rowsLogin(1)、rowsLogin("USER_PWD") 而不是 rowsLogin(2) 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T01:57:23.263

`dtLogin.Rows.Item(0).Item(1)`- Rows.Item 之后的 (0) 指的是行集合中的索引，因此您始终查看第一行。

而不是`dtLogin.Rows.Item(0).Item(1)`在循环中使用等，使用`rowsLogin.Item(1)`.

# asp.net-mvc - CS0234：Mvc 在 System.Web 命名空间中不存在

> ID：14824228
> 
> 赞同：38
> 
> 时间：2013-02-12T01:52:32.267
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我根据由 Wiley Publishing, Inc. 出版的 Scott Hanselmen、Phil Haack 和 Rob Conery 的 Professional ASP.NET 3.5 MVC 第 13 章将 ASP.net 4 webform 项目转换为 Asp.net MVC4（ISBN：978- 0-470-38461-9）。我也关注了这个[博客](http://www.britishdeveloper.co.uk/2011/05/convert-web-forms-mvc3-how-to.html)。现在我可以添加控制器、视图等。所有的引用都已正确设置。没有构建错误。但是在启动转换后的项目时，我得到了编译错误。我在同一台机器上安装了 mvc3。我什至更改了对它的引用。它还在抱怨。你能帮忙吗？谢谢。

```
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 

Compiler Error Message: CS0234: The type or namespace name 'Mvc' does not exist in the namespace 'System.Web' (are you missing an assembly reference?)

Source Error:

Line 109:            <namespaces>
Line 110:                <add namespace="System.Web.Helpers"/>
Line 111:                <add namespace="System.Web.Mvc"/>
Line 112:                <add namespace="System.Web.Mvc.Ajax"/>
Line 113:                <add namespace="System.Web.Mvc.Html"/> 

Source File: c:\Users\Jon\Documents\Visual Studio 2012\Projects\CMT\Apps\Branches\3.0\Web.config    Line: 111 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2014-10-15T20:28:17.430

我有同样的问题，我已经解决了：

1.右键单击解决方案并单击`'Clean Solution'`

2.单击`'References'`解决方案资源管理器中的文件夹并选择问题参考（在您的情况下，它似乎是 System.Web.Mvc），然后右键单击并单击`'Properties'`。

3.在属性窗口中，确保`'Copy Local'`属性设置为`'True'`

这对我有用。希望它适用于其他人

**有用的说明**：正如@Vlad 在评论中提到的那样：

如果它已经设置为 True：

1.  设置为假
2.  再次设置为真
3.  重建

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-10-10T17:40:37.163

当您将 Web 应用程序部署到服务器时，可能会发生此问题，因此您必须检查您是否已经安装了 MVC3。

检查文件夹是否`C:\Program Files\Microsoft ASP.NET\ASP.NET MVC 3`存在。

如果不存在，则需要从[http://www.microsoft.com/en-us/download/details.aspx?id=1491安装](http://www.microsoft.com/en-us/download/details.aspx?id=1491)

* * *

如果您不想安装，您可以在 bin 文件夹中本地添加所有 DLL 并添加对它们的引用，如果您在服务器上托管不部署 ASP.NET 网页或 MVC3，则此工作正常。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-12T04:18:16.807

检查 web.config 中的运行时标记，并验证是否声明了如下内容：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
.....
</runtime> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-09-12T15:22:38.087

添加 Microsoft.AspNet.Mvc nuget 包。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-03-16T19:41:21.547

我尝试了所有这些答案，甚至关闭了 Visual Studio 并删除了所有 bin 目录。

再次启动后，MVC 引用似乎有一个黄色感叹号，所以我将其删除并再次添加。

现在它可以工作了，无需复制本地。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-11-05T14:08:57.507

以前的答案都不适合我。

我注意到我的项目正在使用`System.Web.Mvc`来自 .NET Framework 的引用来引用另一个项目。

我刚刚删除了该程序集并添加了“ [Microsoft.AspNet.Mvc](https://www.nuget.org/packages/microsoft.aspnet.mvc/) ”NuGet 包，这解决了我的问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-11-29T17:42:37.200

您需要在项目中包含对程序集 System.Web.Mvc 的引用。

您的 C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework.NETFramework\v4.0 中可能没有 System.Web.Mvc

所以你需要添加它，然后将它作为对你的项目的引用

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-17T15:39:17.317

我遇到了这个问题，但是 IIS 中的所有应用程序在以前工作时都被破坏了。标记的解决方案都没有帮助我。问题最终是 web.config 的额外副本已被引入我的根目录。我删除了该文件并解决了问题。

# ruby - rspec 类方法 TestFirst Tutorial Tem 转换器

> ID：14824231
> 
> 赞同：1
> 
> 时间：2013-02-12T01:52:45.867
> 
> 标签：ruby

在一个项目上工作并且失去了开始......这是来自规范的描述：

```
describe Temperature do
describe "can be constructed with an options hash" do
describe "in degrees fahrenheit" do
  it "at 50 degrees" do
    Temperature.new(:f => 50).in_fahrenheit.should == 50
  end 
```

坚持了一段时间，我认为我的问题与获取论点有关，但无法弄清楚如何。我的代码引入了结果“nil”而不是 50。

```
 class Temperature
    attr_accessor :f

 def in_fahrenheit
 @f
 end

 end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T01:58:15.193

实际上，您没有在`:f`任何地方为访问器设置值。您应该为此定义自己的构造函数：

```
class Temperature

  def initialize(args)
    self.f = args[:f]
  end

  attr_accessor :f
  def in_fahrenheit
    f
  end
end

t = Temperature.new(:f => 50)

t.f # => 50
t.in_fahrenheit # => 50 
```

# ruby-on-rails - Rails - 无法运行应用程序：无法加载 EventMachine C 扩展；

> ID：14824235
> 
> 赞同：5
> 
> 时间：2013-02-12T01:53:05.633
> 
> 标签：ruby-on-rails, ruby, bundler, eventmachine

当我在 Lion OS X 上运行应用程序时，我收到此错误：

```
Unable to load the EventMachine C extension; To use the pure-ruby reactor, require 'em/pure_ruby'
/Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/eventmachine.rb:8:in `require': no such file to load -- rubyeventmachine (LoadError)
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/eventmachine-1.0.0/lib/eventmachine.rb:8:in `<top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `each'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `block in require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `each'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290@global/gems/bundler-1.0.21/lib/bundler.rb:122:in `require'
    from /Users/adam/rubydev/future_computers/config/application.rb:7:in `<top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:53:in `require'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
    from /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'adam 
```

我真的不知道如何解决这个问题，我已将`eventmachine`gem 添加到 Gemfile 中，但它没有帮助......

你能帮我吗，请，如何解决它？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-28T16:28:43.133

就我而言，这解决了它：

*   $ gem 卸载事件机器
*   在提示符处告诉它卸载所有版本（它告诉你依赖项）
*   $捆绑安装

我正在阅读此[https://github.com/eventmachine/eventmachine/issues/333](https://github.com/eventmachine/eventmachine/issues/333)。eventmachine 有问题，所以确保我得到最新版本似乎是个好主意。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-06T12:27:58.683

[对我来说，使用经过调整](https://github.com/eventmachine/eventmachine/issues/186#issuecomment-1051918)的配置从源代码编译 eventmachine 很有帮助。尝试：

如果已安装 eventmachine，请卸载它：

```
gem uninstall eventmachine 
```

获取事件机器源：

```
git clone https://github.com/eventmachine/eventmachine.git
cd eventmachine 
```

通过在之后添加来编辑`ext/extconf.rb`和`ext/fastfilereader/extconf.rb`文件`CONFIG['CXX'] = "g++"``require 'mkmf'`

编译安装gem：

```
rake gem
gem install pkg/eventmachine-1.0.3.gem 
```

现在 eventmachine 应该可以正常工作了:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T02:42:30.973

正如消息所说，最简单的解决方法就是`require 'em/pure_ruby'`. 我想你可以把它放在**config/inlitializers**文件夹中，你可以调用文件**event_machine.rb**

但它不会具有与 C 扩展相同的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T01:40:27.517

Providing another solution as I just wasted hours tracking this issue down. I was doing `bundle install --deployment` and then committing the result to a separate branch in git so I could deploy this branch straight to servers without having to do `bundle install` again.

The problem is that eventmachine has a `.gitignore` file in it which tells git to ignore all `*.so` files. Because of this when I was committing, the `.so` files didn't commit, and wouldn't show up as untracked in a `git status`. Also since the gemspec was present, bundle thought the package was completely installed.

My solution was to add a command as part of the build process to go and whack all the `.gitignore` files in the gems before committing.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-22T21:43:10.927

您可能会在安装 gem 时发现各种错误，或者尝试寻找由于 ruby​​-devel 未安装而导致 ruby​​ 应用程序安装失败的解决方案。

我刚刚在我的 Kali linux 上安装了

sudo apt-get install ruby​​-dev

一切都解决了。我试图安装bettercap。

这个答案有帮助：[https ://stackoverflow.com/a/4502672/6503117](https://stackoverflow.com/a/4502672/6503117)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-30T19:08:01.330

`bundle exec jekyll serve --livereload --trace`当我在 Jekyll.4.2.1-Ruby.3.0.3p137(mingw)-Windows 上运行时，我遇到了这个错误。我跑了`gem install eventmachine --platform=ruby`，它编译了，`C:\Ruby30-x64\lib\ruby\gems\3.0.0\gems\eventmachine-1.2.7`但是当你运行`bundle install`它时，它也会创建`C:\Ruby30-x64\lib\ruby\gems\3.0.0\gems\eventmachine-1.2.7-x64-mingw32`。该命令`bundle info eventmachine`给了我`C:/Ruby30-x64/lib/ruby/gems/3.0.0/gems/eventmachine-1.2.7-x64-mingw32`，这在 Gemfile.lock 中以`eventmachine (1.2.7-x64-mingw32)`. 所以我改变了那行`eventmachine (1.2.7)`，然后输出`bundle info eventmachine`给了我`C:/Ruby30-x64/lib/ruby/gems/3.0.0/gems/eventmachine-1.2.7`，最后命令`bundle exec jekyll serve --livereload --trace`起作用了✔️

# algorithm - 如何生成一组易于检查但难以欺骗的（短）唯一标识符？

> ID：14824236
> 
> 赞同：0
> 
> 时间：2013-02-12T01:53:11.247
> 
> 标签：algorithm, security

例如，许多软件使用的许可证密钥。我曾想过对一个序列进行加密签名，所以我可能有 4 个字节的 ID 和 8 个字节的签名，但我找不到合适的算法。

我需要的是攻击者无法轻易生成的东西，但它存储在不到大约 20 个 ASCII 字节中。我还需要对独特性充满信心。这不需要完全安全，只需要防止偶然攻击即可。

注意：我在 appengine 上的 java 中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:31:40.000

只需为每个 ID 生成一个[GUID](http://en.wikipedia.org/wiki/Guid)并跟踪您在数据库中生成的那些。GUID 的世界是如此之大，以至于每个都是独一无二的。它不是加密的，因此任何拥有足够多生成的人口的人都有可能产生匹配，但我认为可能性仍然很小。

GUID 是 128 位，可以使用[Base64](http://en.wikipedia.org/wiki/Base64)编码为 23 个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:12:10.323

将包括 id 在内的值计算为字符串，并使用基于字节的 HDMAC 以及密钥和最大长度。只需确保您在要加密的值中有一个独特的部分。这可能是服务器时间或其他一些 ID。需要测试长度是否在 20 个字符的要求范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T02:06:59.057

听起来像[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)。不过，您可能需要手动确保唯一性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T15:24:20.223

加密是可逆的，因此保证输出对于唯一输入是唯一的。只需每次使用相同的密钥加密 0、1、2、3、4、5 等。对于 128 位输出，在 ECB 模式下使用 AES 和 128 位数字。其他模式也需要相同的 IV/Nonce。对于 64 位数字，使用 DES。对于其他尺寸数字，请使用 Hasty Pudding 密码或滚动您自己的简单 Feistel 密码以获得您想要的尺寸。

ECB 不是最安全的模式，但我没有得到您在这里寻找非常高级别安全性的印象。

# javascript - 如何在 javascript 中读取对象文件列表数组？

> ID：14824240
> 
> 赞同：3
> 
> 时间：2013-02-12T01:54:20.607
> 
> 标签：javascript, jquery, arrays, html, arraylist

我创建了一个数组来存储选定文件的列表。好吧，老实说，我查看了代码，当我意识到它可以满足我的目的时，我就使用了它。现在我需要访问这个数组才能手动删除一些文件，但是我尝试过使用每个扇区的索引，但这不起作用。

这就是我创建数组和存储文件的方式。

```
 var files = [];
 $("button:first").on("click", function(e) {
                $("<input>").prop({
                    "type": "file",
                    "multiple": true
                }).on("change", function(e) {
                    files.push(this.files);
                }).trigger("click");

}); 
```

* * *

如果数组 files[] 包含对象 fileList 或从数组中获取索引，我该如何读取它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T03:59:34.237

Here's how I understand your code:

Each time the first button in the dom is clicked a file input dialogue which accepts multiple files is generated. Upon return the dialogue emits a `change` event with a `files` variable (a FileList object) attached to the function context (`this`). Your code pushes the newly created FileList onto the `files` array. Since the input accepts multiple files each object pushed onto the `files` array is a FileList object.

So if you want to iterate through all elements in the files array you can put a function in the `change` event handler:

```
var files = [];
$("button:first").on("click", function(e) {
    $("<input>").prop({
        "type": "file",
        "multiple": true
    }).on("change", function(e) {
        files.push(this.files);
        iterateFiles(files);
    }).trigger("click");
});

function iterateFiles(filesArray)
{
    for(var i=0; i<filesArray.length; i++){
        for(var j=0; j<filesArray[i].length; j++){
            console.log(filesArray[i][j].name);
            // alternatively: console.log(filesArray[i].item(j).name);
        }
    }
} 
```

In the `iterateFiles()` function I wrote `filesArray[i][j]` isn't really a multidimensional array -- but rather a single dimensional array containing FileList objects which behave very much like arrays...except that you can't delete/splice items out of them -- they are read-only.

For more info on why you can't delete see: [How do I remove a file from the FileList](https://stackoverflow.com/questions/3144419/how-do-i-remove-a-file-from-the-filelist)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:05:12.347

Since you are using jQuery you can use `$.grep`

```
files=$.grep( files, function(elementOfArray, indexInArray){
       /* evaluate by index*/
       return indexInArray != someValue;
       /* OR evaluate by element*/
       return  elementOfArray != someOtherValue;
}); 
```

API Reference: [http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T02:06:25.813

像这样的东西？

```
for(var i = 0; i < files.length; i++) {
   alert(files[i][0].name);
   if (files[i][0].name == 'file.jpg') {
      files.splice(i, 1) //remove the item
   }
} 
```

也就是说，由于您选择它的方式，每个 FileList 中总是有一个文件。因此，对于每个文件列表，您只对其中的第一个文件感兴趣。对于每个文件，您只需获取此处定义的属性：http: [//help.dottoro.com/ljbnqsqf.php](http://help.dottoro.com/ljbnqsqf.php)

# python - 在基于类的表单之间传递数据

> ID：14824241
> 
> 赞同：1
> 
> 时间：2013-02-12T01:54:23.853
> 
> 标签：python, django, django-forms, django-views

我对 Django 和基于类的表单相当陌生，我无法理解它们如何相互交互。在[django 项目示例](https://docs.djangoproject.com/en/dev/topics/class-based-views/generic-editing/#basic-forms)之后，我尝试构建一个“搜索表单”，它将位于我项目的所有页面上：

```
# forms.py
from django import forms

class SearchForm(forms.Form):
    myquery = forms.CharField(max_length=255,label="", help_text="sq")

    def __unicode__(self):
        return self.myquery

# views.py
from searchapp.forms import SearchForm
from django.views.generic.edit import FormView
from django.views.generic import TemplateView

class SearchView(FormView):
    template_name = 'index.html'
    form_class = SearchForm
    success_url = '/searchres/'

    def form_valid(self, form):
        thequery=form.cleaned_data.get('myquery')
        return super(SearchView, self).form_valid(form)

    class Meta:
        abstract = True

class SearchResView(SearchView):
    template_name = 'searchres.html'

#urls.py
from django.conf.urls import patterns, include, url
from django.conf import settings
from deals.views import IndexView
from searchapp.views import SearchView, SearchResView

urlpatterns = patterns('',
    url(r'^index/', SearchView.as_view(),name="home"),
    url(r'^searchres/', SearchResView.as_view(),name="searchresx"),
) 
```

该计划是从一个简单的表单开始，让用户输入搜索查询，并在结果页面上显示输入表单。我在这里有以下问题（抱歉 - 我是 Django 新手，尤其是基于类的视图）：

*   如何将数据（“查询”）传递给success_url？即我希望success_url 能够访问“thequery”，这样我就可以在我的模板标签上使用类似{{thequery}} 的东西。
*   提交表单（name="home"）后，我在我的萤火虫上看到了表单中的 POST 数据，但我只能看到“myquery”而不是“thequery”。如何在这里使用 get_context_data() 来添加/发布“查询”变量？
*   最后，我想知道是否可以基于“thequery”字符串构造success_url，即类似success_url = '/searchres/?q=' + thequery

在此先感谢您-我希望了解更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T15:37:55.147

我建议为此使用基于函数的视图。如果您选择子类化通用视图，您将需要挖掘大量文档和可能的源代码，以找到正确的方法来覆盖。（如果你真的很感兴趣，那么看看这个`ListView`类以及`get_queryset()`,`get()`和`post()`方法）

单个 django 视图通常会处理呈现空表单和处理提交的表单。

因此，搜索页面（包括表单和结果）位于[http://your-site.com/search](http://your-site.com/search)。您的网址配置是 -

```
urlpatterns = patterns('',
    #...
    (r'^search/$', 'searchapp.views.search'),
) 
```

你的观点看起来像这样 -

```
def search(request):
    if request.method == 'POST':
        form = SearchForm(request.POST)
        if form.is_valid():
            my_query = form.cleaned_data['myquery']
            object_list = YourModel.objects.filter(# some operation involving my_query)
            return render_to_response('search_results.html', {'object_list': object_list})
     else:
        form = SearchForm()
     render_to_response('search_form.html', {'form': form}) 
```

（请注意，我假设您的表单方法是 post 而不是 get - 我知道这不是很好的 http，但它是 django 的常见模式）

回答您的问题 -

1.  不要使用自己的方法来清理数据。将[clean_myquery](https://docs.djangoproject.com/en/1.4/ref/forms/validation/#cleaning-a-specific-field-attribute)方法添加到您的表单并使用`form.fields['myquery'].clean()`（或者，如果您已`is_valid()`在表单上调用，则可以使用 访问它`form.cleaned_data['myquery']`）。

您想尝试避免将要处理的数据传递给模板。在视图中进行尽可能多的处理，然后渲染模板。但是，如果您想将 myquery 作为字符串传递给模板以呈现，则将其添加到上下文字典（第二个非关键字参数）中`render_to_response`-

```
return render_to_response('search.html', {'object_list': object_list, 'myquery': my query}) 
```

1.  发布数据是从表单字段构造的。您没有表单域`thequery`。视图正在处理 POST 数据 - 它不是由 html 完成的创建它（它又由 Form 类构造）。您的变量`thequery`在视图中声明。

2.  Django 的 URL 调度程序忽略 URL 中的查询字符串，因此[http://your_site.com/ssearch](http://your_site.com/ssearch)将由与[http://your_site.com/search?myquery=findstuff](http://your_site.com/search?myquery=findstuff)相同的视图处理。只需将模板中的 html 从`<form method='post'>`to 更改为并使用`request.GET`. （您需要从我上面描述的视图中更改代码，以包含一个新检查，以查看您是在处理表单提交还是只是呈现空白表单）

好好阅读有关[视图](https://docs.djangoproject.com/en/1.4/topics/http/views/)、[表单](https://docs.djangoproject.com/en/1.4/topics/forms/)和[url 调度](https://docs.djangoproject.com/en/1.4/topics/http/urls/)程序的文档。

# c - 使用 MPI 支持编译 Valgrind

> ID：14824242
> 
> 赞同：2
> 
> 时间：2013-02-12T01:54:23.713
> 
> 标签：c, mpi, valgrind

我正在尝试在 Linux 下`Valgrind`完全支持安装。`MPI`根据 Valgrind[文档](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.mpiwrap)。我应该在`MPI`已经安装的情况下进行编译，但是根据[MPICH](http://wiki.mpich.org/mpich/index.php/Support_for_Debugging_Memory_Allocation)和[OpenMPI](http://www.open-mpi.org/faq/?category=debugging#memchecker_how)文档，我应该在`Valgrind`已经安装的情况下进行编译。这很令人困惑，那么我应该先安装哪个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:11:02.607

这里没有循环依赖。相反，您面临着两种不同的方法，它们将 Valgrind 客户端请求放在不同的位置。

Open MPI 可以使用 OMPI 特定的 Valgrind 支持来构建。这与使用 MPI 支持构建 Memchecker 不同，因为它还允许检查 OMPI 内部（这就是为什么它还要求您在 OMPI 中启用调试）。Memchecker 客户端请求以非常特定于 OMPI 的方式成为库代码的一部分。这不需要更改 Valgrind 代码，即它应该适用于任何 Valgrind 安装（假设满足最低版本要求）

另一方面，Open MPI 以及任何其他 MPI 实现都提供`PMPI`分析接口。Memchecker 可以使用它来提供*通用 MPI 支持*。如文档中所述，Memchecker 构建了一个函数库，用于替换（和包装）原始 MPI 调用（这就是`PMPI`机制的工作原理 - 所有`MPI_*`调用都是弱符号，可以被其他同名符号覆盖，真正的 MPI电话实际上`PMPI_*`是`MPI_*`被定义为 ELF 系统上的弱别名）。这不需要更改 MPI 库代码。它应该适用于任何 MPI 实现，但只有用户内存会被正确调试，即可能在 MPI 库代码中检测到误报（尽管这些不一定是误报，并且可能意味着库本身有错误）。

MPICH 中的 Valgrind 支持也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:09:32.677

你说你要安装带有 MPI 支持的 valgrind。这意味着您可能会使用 mpicc 或其他一些 mpi 编译器。valgrind 要求的是，使用相同的编译器构建。如果您打算使用 valgrind 本身调试任何这些 mpi 编译器，则需要按照 Valgrind 集成部分下的说明进行操作。

没有关于您使用哪个发行版的信息。在 Debian 系统上，valgrind-mpi 可能是您正在寻找的软件包。

# python - 正则表达式：如何在我的模式中排除逗号？

> ID：14824248
> 
> 赞同：1
> 
> 时间：2013-02-12T01:55:08.937
> 
> 标签：python, regex, pattern-matching

我想找到两端夹着逗号的第一个数字，我想出了这个：

```
m = re.search("\,([0-9])*\,",line) 
```

但是，这会将带有逗号的数字返回给我，我该如何排除它们？

`m.group(0)`返回

```
',1620693,' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T01:58:06.193

`group(0)`将始终返回整个比赛。

请参阅 python 文档：

```
>>> m = re.match(r"(\w+) (\w+)", "Isaac Newton, physicist")
>>> m.group(0)       # The entire match
'Isaac Newton'
>>> m.group(1)       # The first parenthesized subgroup.
'Isaac' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T01:57:58.953

使用`m.group(1)`. 您也不需要转义（反斜杠）逗号。 `m.group(0)`指的是整个比赛，后面的每个数字指的是匹配的组。

# ruby-on-rails-3 - Rails & Postgresql 创建一个从 1 自动递增的字段

> ID：14824256
> 
> 赞同：0
> 
> 时间：2013-02-12T01:55:58.567
> 
> 标签：ruby-on-rails-3, postgresql, auto-increment

我正在寻找`id_visual`在我的表`orders`中创建一个名为的字段，该字段从 1 开始并从那里自动递增。我可以在我的模型中创建一个方法来做到这一点，但我认为必须有一个更好更简单的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:46:43.520

据我所知，您想要一个基于主 ID 的辅助 ID？身份密钥只能是基于表的，不能依赖于另一个密钥。您必须在代码中执行此操作，然后将其保存到 before_create 的新字段中。执行此操作的最简单方法是针对您要标识的每个订单，根据主键是什么，获取小于或等于您正在使用的订单的所有订单的计数。它是一个简单的查询计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:01:39.490

这是您的数据库应该在某个级别提供的东西，无论是在事务中还是在其他锁定中。

看看这个问题，了解一些将 postgres 配置为自动增加列的方法：

[PostgreSQL 自动增量](https://stackoverflow.com/questions/787722/postgresql-autoincrement)

# html - div中的可变高度列表项目，底部对齐

> ID：14824258
> 
> 赞同：0
> 
> 时间：2013-02-12T01:56:04.053
> 
> 标签：html, css

我们可以将这个现有的小提琴（解决方案）用于条形图并应用不同的高度值，

[http://jsfiddle.net/RYBFF/1/](http://jsfiddle.net/RYBFF/1/)

实际发生的是 bar 项目被锚定到 ul 容器的顶部，而当我们缩放项目时它应该被锚定到底部。

```
li.different {
    height: 80px !important;
} 
```

例如，将不同的类应用于列表项之一将证明该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:01:06.550

*   将显示模式更改为`inline-block`
*   消除`float: left;`

并最终为列表中的第一项添加一些边距。

`vertical-align`仅适用于内联或内联块元素。您的列表项是块元素。

[小提琴](http://jsfiddle.net/YRJwx)

# ios - CoreData：访问 NSManagedObject 的实例

> ID：14824263
> 
> 赞同：0
> 
> 时间：2013-02-12T01:56:37.887
> 
> 标签：ios, core-data, pointers

我有 3 个场景，每个场景都收集用户的输入。每个场景有 5 个 UITextField。第 4 个场景显示了 UITableView 中的所有 15 个文本字段。

我不确定这是否是最好的方法，但我有以下场景 1 的代码：

```
//Meetings is NSManagedObject class. Meetings.h and .m was created from the Meetings entity from Core Data
//I have this code once in the file right before I start saving the data
Meetings *meetings = (Meetings *) [NSEntityDescription insertNewObjectForEntityForName:@"Meetings" inManagedObjectContext:self.managedObjectContext];

// I have similar code below for each user's input.  
 NSString *date = [[NSString alloc] initWithFormat:@"%@", [dateFormatter stringFromDate:selectedDate]];
            DateLabel.text = date;
            [meetings setDateLabel:date];
            ...
            [meetings setTimeLabel:time];
            ..

//Code below is to save.  I have this once at the end of the file to save the data
NSError *error = nil;
if (![managedObjectContext save:&error]) {
    // Handle the error.
}
//The log below shows the saved data fine.  Thus, the data is being saved in managnedObjectContext.
NSLog (@"This is the DateLabel %@", meetings.DateLabel); 
```

问题：如何访问场景 2 和 3 中的指针 *meetings 以保存 managedObjectContext 中的其余字段？我从场景 2 中做了一个 NSLog，它显示为 Null：

```
//In Scene 2 viewDidLoad method I did the following to check: 

self.managedObjectContext = [(STAppDelegate *)[[UIApplication sharedApplication]  delegate] managedObjectContext];
Meetings *meetings = (Meetings *) [NSEntityDescription insertNewObjectForEntityForName:@"Meetings" inManagedObjectContext:self.managedObjectContext];
NSLog (@"This is the DateLabel from Scene 2 %@", meetings.DateLabel); 
```

日志显示：

```
2013-02-11 18:04:05.447 MyApp[3505:c07] This is the DateLabel from Scene 2 (null) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:15:51.147

您需要将指向会议对象的指针从前一个屏幕向前传递到下一个屏幕，方法是将它们存储在一个属性中，或者您可以传递对象的 id 并根据需要为最终屏幕获取它们。

假设以下是您的代码的反映。类名可能不相同，但我认为您可以根据需要跟踪和更改它们。

**场景 1 头文件：**

```
//
//  Scene1ViewController.h
// ... etc.

#import <UIKit/UIKit.h>
#import "Meetings.h"

@interface Scene1ViewController : UIViewController
@property (nonatomic, strong) Meetings *meetingsForScene1;
// ... etc.
@end 
```

**场景 2 头文件：**

```
//
//  Scene2ViewController.h
//  ... etc.

#import <UIKit/UIKit.h>
#import "Meetings.h"

@interface Scene2ViewController : UIViewController
@property (nonatomic, strong) Meetings *meetingsFromScene1;
@property (nonatomic, strong) Meetings *meetingsForScene2;
//  ... etc.
@end 
```

*`meetingsForScene2`根据您的要求，可能合适也可能不合适。您可能只需将来自 Scene2 的数据添加到`meetingsFromScene1`并将该实例传递到下一个场景。*

**场景 1 实施`-prepareForSegue:sender:`：**

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    UIViewController *destinationViewController = segue.destinationViewController;

    if ([segue.identifier isEqualToString:@"YourSegueIdentifierForTransistionFromScene1ToScene2"]) {
        Scene2ViewController *scene2 = [destinationViewController isKindOfClass:[Scene2ViewController class]] ? (Scene2ViewController *)destinationViewController : nil;

        NSAssert(scene2, @"scene2 should not be nil");
        NSAssert(self.meetingsForScene1, @"self.meetingsForSecen1 should not be nil");

        scene2.meetingsFromScene1 = self.meetingsForScene1;
    }
} 
```

请注意，您可能在 Scene2 上有两个属性。一个用于当前场景的数据，一个用于前一个场景的数据。重要的属性是保存前一场景数据的属性。Scene1 中的`-prepareForSegue:sender:`方法是设置Scene1 的数据到Scene2 上的属性的合适时机。

我已经包括了一些`NSAssert`电话来做一些检查。考虑删除生产代码中的那些。另外，请注意分配时的检查`*scene2`。如果您的目标控制器不是正确的“种类”，您会立即发现。

我不一定提倡这种方法是解决您的问题的“最佳”方法，但如果不能完全解决问题，这种方法至少会提供解决方案的途径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:17:06.120

好吧，您在 viewDidLoad 方法中所做的是在您的 NSManagedObjectContext 实例中创建一个新对象。

您应该做的是为您之前创建的会议对象发出获取请求。

也许您应该阅读有关 Core Data 的教程。以下很容易理解：[http ://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)

# sql - Sql 日期 > 日期超过 8 小时

> ID：14824267
> 
> 赞同：1
> 
> 时间：2013-02-12T01:57:03.563
> 
> 标签：sql, oracle

我正在尝试查询图表日期是系统时间，数据绘制在执行日期时间之后超过 8 小时。

我正在使用以下查询：

```
 select * from pat_results where app_type like 'L' and (chart_dt_utc > perform_dt_utc +8) 
```

两列的日期和时间格式均为 2012-12-29 11:44:00

+8 正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:00:20.623

不，+ 8 增加 8*天*。你要：

```
select * from pat_results where app_type like 'L' and datediff(hour, chart_dt_utc, perform_dt_utc) > 8 
```

编辑：哦。出于某种原因，我认为您使用的是 SQL Server。好吧，我只想说，使用 RDBMS 中存在的任何等效项。

编辑 2：在 Oracle 中，您可以这样做：

```
select * from pat_results where app_type like 'L' 
  and (chart_dt_utc > perform_dt_utc + (8 / 24)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:00:24.927

否。在允许您将数字添加到日期的数据库中，数字以天为单位。

您要添加的值是 8/24.0 - 包括小数位，因为某些数据库将 8/24 计算为整数并给您 0。

# salesforce - 第一个 Box.com 集成。如何查询文件夹列表？

> ID：14824268
> 
> 赞同：0
> 
> 时间：2013-02-12T01:57:18.753
> 
> 标签：salesforce, integration

我的 oAuth 东西按预期工作。那里没有挑战。我现在需要使用访问令牌来做某事。我没有尝试过任何工作。我确信这很简单，但我不确定如何将 curl 中的示例转换为 http post/get 请求。

Box.com 帮助说： curl [https://api.box.com/2.0/folders/FOLDER_ID](https://api.box.com/2.0/folders/FOLDER_ID) \ -H "Authorization: Bearer YOUR_ACCESS_TOKEN"

我如何使用 http post/get 编写它？

只要请求是通过标准的 http 功能发送的，我认为我的平台并不重要。无论如何，我使用 Apex 在 Salesforce.com 中编写此内容。

注意：我知道 AppExchange 上有一个应用程序可以集成 Box.com 和 Salesforce。出于我的目的，我不想依赖特定平台独有的应用程序。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:45:51.667

它只是一个带有标头和可选 XML / JSON 作为 POST 有效负载的 GET 请求，不确定您的具体问题是什么？你真的试过写一些代码吗？

简单示例： http: [//www.salesforce.com/us/developer/docs/api_asynch/Content/asynch_api_quickstart_login.htm](http://www.salesforce.com/us/developer/docs/api_asynch/Content/asynch_api_quickstart_login.htm)

更高级一点：http: [//developer.force.com/cookbook/recipe/scheduling-an-apex-call-from-the-command-line](http://developer.force.com/cookbook/recipe/scheduling-an-apex-call-from-the-command-line)

CURL 是一个强大的工具，[它的命令行选项](http://curl.haxx.se/docs/manpage.html)列表不适合胆小的人。仍然 - 将其用作参考，尤其是“-H”表示 HTTP 标头。我认为“\”只是表示它是一个多行命令，你可以忽略它。

# javascript - 编辑表格上的值后如何更新字段（使用jquery或javascript）

> ID：14824270
> 
> 赞同：1
> 
> 时间：2013-02-12T01:57:31.003
> 
> 标签：javascript, jquery, ruby-on-rails-3.2, shopping-cart

我有一个购物车，在有人将商品添加到购物车后，他们可以更改数量并单击更新以进行所需的更改。但是，单击它后，我希望它说已更新！

现在，如果有人再次点击该字段来更新它。它应该变回一个显示更新的按钮。

我该怎么做呢？我对 jquery 或 javascript 不是很熟悉

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:26:04.437

不确定您是如何触发服务器更新的，但这里有一个简短的片段，您可以使用它：

```
 $('document').ready(function(){

       $('#yourInputField').change(function() {

           $('#yourButton').addClass('enable');

        });

         $('#yourButton').on("click",function() {

          //Fire ajax for server, onsuccess is ajax success method
           onsuccess(e){
           $(this).removeClass('enable');
           $(this).addClass('disable');
           };

        });

    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:22:38.923

这是一个让您入门的基本示例：

**HTML**

```
<div class="item">
    <input class="amount" type="text" />
    <div class="update">
        <button class="update-button" type="button">Update</button>
        <div class="update-message">Updated!</div>
    </div>
</div> 
```

**JS**

```
$('.update-button').click(function () {
    // Hide the update button
    $(this).hide()
    // Show the update message
    $(this).siblings('.update-message').show();
});

$('.amount').click(function () {
    // Show the update button
    $(this).closest('.item').find('.update-button').show();
    // Hide the update message
    $(this).closest('.item').find('.update-message').hide();
}); 
```

[jsfiddle](http://jsfiddle.net/KYYHz/)

# ruby-on-rails - 决定使用数组属性还是嵌套模型

> ID：14824273
> 
> 赞同：0
> 
> 时间：2013-02-12T01:57:50.770
> 
> 标签：ruby-on-rails

可能是一个相当基本的问题，但请耐心等待。

`ContentBlock`我正在构建一个页面，其中包含许多由模型表示的模块化内容。每个`ContentBlock`都有至少一个链接，每个链接都有几个不同的属性。我最初的方法是将这些链接作为数组添加到模型中，因为似乎没有任何真正需要将它们单独存储在数据库中，并且它们没有任何自己的逻辑。现在我正在考虑构建一个用于创建/编辑的表单，`ContentBlock`如果链接有一个单独的嵌套模型，似乎构建起来会容易得多。

我正在强烈考虑转换为使用模型，但我的直觉是，存储像数据库中的链接这样相对微不足道的东西是一种“错误”。鉴于我仍然习惯于使用 Rails，这种感觉是不是错位了？我应该为任何事物创建模型吗？还是我应该先寻找某种最低标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:12:11.897

为嵌套模型创建表单肯定更容易。由于您的链接具有属性，因此建议您制作一个模型。我倾向于为不容易适应领域的概念制作模型。如果您担心查询性能，您可以随时进行[预加载](http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:38:28.973

我认为取决于您计划管理多少数据，您想针对这些数据做什么，这些数据代表什么，等等......

我们的一个项目是建造一些东西，可以为一组餐馆创建食谱。食谱（一些文本，如说明等...）-> 成分，我们使用数组，因为这些都是单行文本，永远不会超过几手。此外，这些成分没有进一步的依赖性。食谱只会呈现为 html，并且不会针对它们进行搜索（至少不会针对 db）。

另一个项目需要构建一个与您的非常相似的页面，但页面的每个“组件”都做了不同的事情，并且有些链接到应用程序中的其他对象，如视频和其他资产、模板等......我们见过人们通过所见即所得或通过某种 JS 方式完成此类工作，并将整个有效负载/结构保存在数据库中。我们发现两者都非常混乱。

出现的一个问题是，如果资产/关联对象被错误或故意删除但存在于许多页面中，会发生什么情况。使用允许的模型来确保如果某些东西被删除，它会在所有链接的关联中被删除（尽管这带来了它自己的问题，但更多的是关于页面在显示时更有意义）。

此外，我们的页面有可能变得非常大，不同类型的组件具有不同的外观和交互性，这确实是我们能够正确管理它的唯一方法。

因此，我会查看您的要求并相应地计划，上下文很重要。如果你必须改变它（这种情况经常发生），那么你就会改变它。

# javascript - JQuery - 回调下拉列表加载

> ID：14824280
> 
> 赞同：4
> 
> 时间：2013-02-12T01:58:17.407
> 
> 标签：javascript, jquery, asp.net-mvc

我需要在加载后从下拉列表中选择一个值：

**编辑：**在与视图关联的脚本中，我有：

```
//Dropdown cascade call when trigger is called and fill councilDropdown:
$("#districtDropdown").cascade({
    url: "/Address/ListCouncilByDistrict",
    paramName: "districtId",
    firstOption: 'Selecione o Concelho...',
    childSelect: $("#councilDropdown")
});

$("#PostalCode").keyup(function () {
loadPTPostalCode();
});

$("#PostalCodeExtension").keyup(function () {
    loadPTPostalCode();
});

function loadPTPostalCode()
{
  if ($("#PostalCode").val() >= 1000) {
    $.ajax({
        url: '/Address/GetPTPostalCode',
        type: "POST",
        dataType: "json",
        data: { postalCode: $("#PostalCode").val(), postalCodeExtension: $("#PostalCodeExtension").val() },
        success: function (data) {
            if (data != null) {
                $("#districtDropdown").val(data.PTDistrict_Id); // Set the Dropdown value
                $('#districtDropdown').trigger('change'); // Trigger (force the dropdown to load

                // *** This is done to soon, the dropdownlist of the Councils is not all loaded yet ***
                $("#councilDropdown").val(data.PTCouncil_Id);
            }
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
            alert(textStatus)
        }
    });
} 
```

}

**编辑：**观点

```
@model Heelp.ViewModels.AddressPTViewModel

<h2>Create</h2>

@using (Ajax.BeginForm(MVC.Address.CreateAddressPT(), new AjaxOptions { OnSuccess = "showLoginConfirmationResultMessage" }, new { @id = "AddressForm" }))
{
@Html.AntiForgeryToken()

<div class="address1">
    @Html.LabelFor(model => model.Address1)
    @Html.TextBoxFor(model => model.Address1)
    @Html.ValidationMessageFor(model => model.Address1)
</div>
<div class="address2">
    @Html.TextBoxFor(model => model.Address2)
    @Html.ValidationMessageFor(model => model.Address2)
</div>
<div class="city">
    @Html.LabelFor(model => model.City)
    @Html.TextBoxFor(model => model.City)
    @Html.ValidationMessageFor(model => model.City)
</div>
<div class="postalCode">
    @Html.DisplayNameFor(m => m.PostalCode)
    @Html.TextBoxFor(m => m.PostalCode, new { @Value = "" })
    @Html.ValidationMessageFor(m => m.PostalCode)
</div>
<div class="postalCodeExtension">
    @Html.LabelFor(model => model.PostalCodeExtension)
    @Html.TextBoxFor(model => model.PostalCodeExtension)
    @Html.ValidationMessageFor(m => m.PostalCodeExtension)
</div>
<div class="postalCodeCity">
    @Html.LabelFor(model => model.PostalCodeCity)
    @Html.TextBoxFor(model => model.PostalCodeCity)
    @Html.ValidationMessageFor(m => m.PostalCodeCity)
</div>
<div id="district">
    @Html.DisplayNameFor(m => m.PTDistrict_Id)
    @Html.DropDownListFor(m => m.PTDistrict_Id, Model.PTDistrictList, HeelpResources.PTDistrictViewDropDownListFirstRecord, new { id = "districtDropdown" })
    @Html.ValidationMessageFor(m => m.PTDistrict_Id)
</div>
<div id="council">
    @Html.DisplayNameFor(m => m.PTCouncil_Id)
    @Html.DropDownListFor(m => m.PTCouncil_Id, Model.PTCouncilList, HeelpResources.PTCouncilViewDropDownListFirstRecord, new { id = "councilDropdown" })
    @Html.ValidationMessageFor(m => m.PTCouncil_Id)
</div>
<p>
    <input type="submit" value="Create" />
</p>
}
<div>
 @Html.ActionLink("Back to List", "Index")
</div> 
```

编辑：

级联功能：

```
// Cascade function
(function ($) {
$.fn.cascade = function (options) {
    var defaults = {};
    var opts = $.extend(defaults, options);

    return this.each(function () {
        $(this).change(function () {
            var selectedValue = $(this).val();
            if (selectedValue == '') {
                opts.childSelect.empty();
                return;
            }
            var params = {};
            params[opts.paramName] = selectedValue;
            $.post(opts.url, params, function (items) {
                //$.getJSON(opts.url, params, function (items) {
                opts.childSelect.empty();
                if (opts.firstOption != "")
                    opts.childSelect.append(
                        $('<option/>')
                            .attr('value', '')
                            .text(opts.firstOption));
                $.each(items, function (index, item) {
                    // alert(opts.firstOption);
                    opts.childSelect.append(
                        $('<option/>')
                            .attr('value', item.Id)
                            .text(item.Name)
                    );
                });
            });
        });
    });
};
})(jQuery); 
```

但是当我这样做时，由于 Dropdownlist 尚未加载，因此 val() 尚不存在。

例如，如果我之前放置了一条警报消息，它可以正常工作，因为它是加载下拉列表的时间。

如何仅在加载下拉列表后设置理事会下拉列表的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T08:05:57.977

根据您的要求“**仅在加载下拉列表后设置理事会下拉列表的值**”。

您需要执行*同步 Ajax 请求*。您可以将**async**选项指定为**false**以获取同步 Ajax 请求。

```
$.ajax({
    url: '/Address/GetPTPostalCode',
    type: "POST",
    dataType: "json",
    data: { postalCode: $("#PostalCode").val(), postalCodeExtension: $("#PostalCodeExtension").val() },
    success: function (data) {
        if (data != null) {
            $("#districtDropdown").val(data.PTDistrict_Id); 
            $('#districtDropdown').trigger('change'); 

            // *** This is done to soon, the dropdownlist of the Councils is not all loaded yet ***
            $("#councilDropdown").val(data.PTCouncil_Id);
        }
    },
    async:   false
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T19:00:53.563

我会更新级联插件以在更新 ddl 时触发事件。

```
(function ($) {
$.fn.cascade = function (options) {
    var defaults = {};
    var opts = $.extend(defaults, options);

    return this.each(function () {
        $(this).change(function () {
            // #### store reference to changed element for later ####
            var self = this,
                selectedValue = $(this).val();
            if (selectedValue == '') {
                opts.childSelect.empty();
                return;
            }
            var params = {};
            params[opts.paramName] = selectedValue;
            $.post(opts.url, params, function (items) {
                //$.getJSON(opts.url, params, function (items) {
                opts.childSelect.empty();
                if (opts.firstOption != "")
                    opts.childSelect.append(
                        $('<option/>')
                            .attr('value', '')
                            .text(opts.firstOption));
                $.each(items, function (index, item) {
                    // alert(opts.firstOption);
                    opts.childSelect.append(
                        $('<option/>')
                            .attr('value', item.Id)
                            .text(item.Name)
                    );
                });
                // #### Trigger event ####
                self.trigger("update");
            });
        });
    });
};
})(jQuery); 
```

现在你可以绑定到：

```
 ...
    // *** #### fixed #### This is done to soon, the dropdownlist of the Councils is not all loaded yet ***
    $("#councilDropdown").on("updated",function(){
        $(this).val(data.PTCouncil_Id);
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T11:14:53.397

尝试在下拉菜单上创建两个事件 1\. 自定义事件和 2\. 更改事件

当用户手动更改下拉值时，将触发更改事件。

```
$('#dictrctDropdown').change(function (event){
    $('#dictrctDropdown').trigger('custom');
});

$('#dictrctDropdown').on('custom', function (event, param1){
    // Load council dropdown 
    if(param1){
       $("#councilDropdown").val(param1);
    }
}); 
```

从“/Address/GetPTPostalCode”成功回调引发“dictrctDropdown”的自定义事件

```
function loadPTPostalCode()
{
  if ($("#PostalCode").val() >= 1000) {
    $.ajax({
        url: '/Address/GetPTPostalCode',
        type: "POST",
        dataType: "json",
        data: { postalCode: $("#PostalCode").val(), postalCodeExtension: $("#PostalCodeExtension").val() },
        success: function (data) {
            if (data != null) {

        $.getJSON('disctrictURL','data to post (if any)',function(response){
        //Load district dropdown
    /*
    $.each(items, function (index, item) {
                        // alert(opts.firstOption);
                        opts.childSelect.append(
                            $('<option/>')
                                .attr('value', item.Id)
                                .text(item.Name)
                        );
                    });

    */
        $("#districtDropdown").val(data.PTDistrict_Id); // Set the Dropdown value
        });

        //Now use district id load council dropdown and set value 
    $.getJSON('councilURL','data to post (if any)',function(response){
    //Council dropdown
    $("#districtDropdown").val('council id'); // Set the Dropdown value
    });

               }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(textStatus)
            }
        });
    } 
```

希望这会有所帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-19T01:20:09.127

我想说这里有两种方法。

## 1

最好的做法是向您的级联添加回调功能。可以这样做：

```
...
$.post(opts.url, params, function (items) {
 //$.getJSON(opts.url, params, function (items) {
 opts.childSelect.empty();
 if (opts.firstOption != ""){
  opts.childSelect.append(
   $('<option/>')
   .attr('value', '')
   .text(opts.firstOption));
  $.each(items, function (index, item) {
   // alert(opts.firstOption);
   opts.childSelect.append(
    $('<option/>')
     .attr('value', item.Id)
     .text(item.Name)
    );
  });
  if( typeof(opts.callback) == "function" )opts.callback();//issue callback
 }
});
... 
```

它将通过在此处设置级联来使用：

```
$("#districtDropdown").cascade({
 url: "/Address/ListCouncilByDistrict",
 paramName: "districtId",
 firstOption: 'Selecione o Concelho...',
 childSelect: $("#councilDropdown"),
 callback: function(){ districtCallback(); }
}); 
```

并以您想要的任何方式定义，如下所示：

```
function districtCallback(){
 $("#councilDropdown").val($("#districtDropdown").val());
} 
```

## 2

又快又脏.. **[jsFiddle 演示](http://jsfiddle.net/V4A3z/)**

```
success: function (data) {
 if (data != null) {
  $("#districtDropdown").val(data.PTDistrict_Id); // Set the Dropdown value
  $('#districtDropdown').trigger('change'); // Trigger (force the dropdown to load
  (function councilVal(){
   if( typeof($("#councilDropdown").val()) != "undefined" ){
    $("#councilDropdown").val(data.PTCouncil_Id);
   }else{
    setTimeout(councilVal,50);
   }
  })()
 }
} 
```

# javascript - 将 2D JavaScript 数组转换为 1D 数组

> ID：14824283
> 
> 赞同：43
> 
> 时间：2013-02-12T01:58:56.010
> 
> 标签：javascript

我想将 2D JavaScript 数组转换为 1D 数组，以便将 2D 数组的每个元素连接成一个 1D 数组。

在这里，我正在尝试转换`arrToConvert`为一维数组。

```
var arrToConvert = [[0,0,1],[2,3,3],[4,4,5]];

console.log(get1DArray(arrToConvert)); //print the converted array

function get1DArray(2dArr){
    //concatenate each element of the input into a 1D array, and return the output
    //what would be the best way to implement this function?
} 
```

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2016-10-01T10:58:47.870

## 使用 ES6 扩展运算符

```
arr1d = [].concat(...arr2d); 
```

请注意，此方法仅在`arr2d`子数组少于 100 000 个时才有效。如果你的数组比那个大，你会得到一个`RangeError: too many function arguments`.

## 对于 > ~100 000 行

```
arr = [];
for (row of table) for (e of row) arr.push(e); 
```

*`concat()`无论如何，在这种情况下太慢了。*

## Underscore.js 方式

这将递归地展平任何深度的数组（也应该适用于大型数组）：

```
arr1d = _.flatten(arr2d); 
```

*如果您只想将其展平一个级别，`true`请作为第二个参数传递。*

## 一个简短的 < ES6 方式

```
arr1d = [].concat.apply([], arr2d); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-02-12T02:00:36.283

尝试[`.concat()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/concat)：

```
var arrToConvert = [[0,0,1],[2,3,3],[4,4,5]];
var newArr = [];

for(var i = 0; i < arrToConvert.length; i++)
{
    newArr = newArr.concat(arrToConvert[i]);
}

console.log(newArr); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-10-12T02:31:03.427

尝试[`.reduce()`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)

```
var test2d = [
  ["foo", "bar"],
  ["baz", "biz"]
];
var merged = test2d.reduce(function(prev, next) {
  return prev.concat(next);
}); 
```

**来源**：http: [//jsperf.com/2-dimensional-array-merge](http://jsperf.com/2-dimensional-array-merge)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-12T02:06:05.990

怎么样：

```
var arrToConvert = [[0,0,1],[2,3,3],[4,4,5]];

function get1DArray(arr){
    return arr.join().split(",");
}

console.log(get1DArray(arrToConvert)); 
```

[http://jsfiddle.net/JRR4J/](http://jsfiddle.net/JRR4J/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T02:19:09.247

```
var arrToConvert = [[0, 0, 1], [2, 3, 3], [4, 4, 5]];

function get1DArray(arr){

    var result = new Array();

    for (var x = 0; x < arr.length; x++){
        for (var y = 0; y < arr[x].length; y++){

        result.push(arr[x][y])

        }
    }

    return result
}

alert (get1DArray(arrToConvert)) 
```

[http://jsfiddle.net/Saturnix/ReeqQ/](http://jsfiddle.net/Saturnix/ReeqQ/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-06T08:32:50.547

```
var arrToConvert = [[0,0,1],[2,3,3],[4,4,5]];

var modifiedArray = arrToConvert.map(function(array){ 
    return array[0]+array[1]+array[2];
}); 
```

另一个例子

```
var passengers = [ 
  ["Thomas", "Meeks"],
  ["Gregg", "Pollack"],
  ["Christine", "Wong"],
  ["Dan", "McGaw"]
];

var modifiedNames = passengers.map(function(convArray){
    return convArray[0]+" "+convArray[1];
}); 
```

# css - 是否可以始终在 Chrome 中为某个网站加载自定义样式表？

> ID：14824287
> 
> 赞同：0
> 
> 时间：2013-02-12T01:59:13.790
> 
> 标签：css, google-chrome, google-chrome-extension

我在 Windows 上的 Google Chrome 上阅读[http://developer.android.com/guide/components/loaders.html上的 Android 指南/文档。](http://developer.android.com/guide/components/loaders.html)

我已经使用 Chrome 开发人员工具进行了某些更改，例如

*   将身体背景更改为灰色
*   将等宽字体从 courier new 更改为 consolas

为了更容易阅读。出于某种原因，该站点不遵守 Chrome 字体设置规则，即使其他站点这样做。所以我必须手动进入并将等宽字体从 courier new 更改为 consolas。

但是一旦重新加载页面，这些更改就会消失。是否有可能使这些更改永久化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:22:04.490

您可以处理设置 > 显示高级设置 > Web 内容 > 自定义字体。我在mac上，但应该有相当于pc的东西。此外，要运行您自己的 css，只需使用网上商店中的任何扩展程序。其中之一是[样式选择器](https://chrome.google.com/webstore/detail/style-chooser/daodklicmmjhcacgkjpianadkdkbkbce?hl=en#)

# macos - 允许的应用程序文件位置 - 有或没有沙盒

> ID：14824289
> 
> 赞同：0
> 
> 时间：2013-02-12T01:59:36.890
> 
> 标签：macos, cocoa, sandbox

好的，我的问题很直截了当，但我绝对找不到一个直截了当的答案。所以，如果你能提供帮助，我会很高兴。

**我想要的是 ：**

我的应用程序可以自由写入一些数据的地方（在 10.6 上 - 没有沙箱 - 或 10.7 及更高版本，有沙箱）。

**简单来说 ：**

*   我想知道是否有任何系统函数（例如`NSHomeDirectory()`）指向我可以写入的安全位置（OS X 版本无关紧要）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:26:02.873

好的，所以我在这里，回答我自己的问题。

那么，如果我们只需要访问**Application Support**目录（如果它不存在则创建它），不管我们是在 10.6（未启用沙盒）还是 10.7+ 上怎么办？

这是**通用**解决方案*（我自己为此写了一个类别`NSFileManager`，但即使是简单的函数或宏也可以......）*：

**界面 ：**

```
// NSFileManager+Paths.h

#import <Foundation/Foundation.h>

@interface NSFileManager (Paths)

+ (NSString*)applicationSupportDirectory;

@end 
```

**执行 ：**

```
// NSFileManager+Paths.m

#import "NSFileManager+Paths.h"

@implementation NSFileManager (Paths)

+ (NSString*)applicationSupportDirectory
{
    NSError *error;
    return [[[NSFileManager defaultManager] URLForDirectory:NSApplicationSupportDirectory inDomain:NSUserDomainMask appropriateForURL:nil create:YES error:&error] path];
}

@end 
```

比较简单吧？

* * *

**提示：**请查看下面的 2 条评论，以*修复*此答案以获得更优雅的解决方案。

# glassfish - 将包含 JavaFX .jar 的 .war 部署到 GlassFish NoClassDefFoundError

> ID：14824290
> 
> 赞同：1
> 
> 时间：2013-02-12T01:59:51.460
> 
> 标签：glassfish, javafx

我的 JavaFX 应用程序需要另一个 jar 文件中的类。

两者都部署为战争文件的一部分

JavaFX jar 未找到 WEB-INF/lib/MyJavaFXClient.jar 中包含的 my-xxx.class

我的war文件的内容是：

```
 images/
    META-INF/
    META-INF/MANIFEST.MF
    WEB-INF/
    WEB-INF/lib/
    WEB-INF/lib/bin/glass.dll
    WEB-INF/lib/MyJavaFxClient.jar ( this is the jar my JavaFX app requires )
    WEB-INF/sun-web.xml
    WEB-INF/web.xml
    index.jsp 
    index.html
    MyJavaFxApp.jnlp
    MyJavaFxApp.jar  (my JavaFx app) 
```

JNLP：

```
<?xml version="1.0" encoding="utf-8"?>
<jnlp spec="1.0" xmlns:jfx="http://javafx.com" href="MyJavaFxApp.jnlp">
<information>
    <title>App: TestDriver</title>
    <vendor>Demo</vendor>
    <description>JavaFX application test client</description>
    <homepage href="http://localhost:8080/testdriver/"/>
    <offline-allowed/>
</information>

<security>
   <all-permissions/>
</security>
<resources>
<jfx:javafx-runtime version="2.2+" 
     href="http://javadl.sun.com/webapps/download/GetFile/javafx-latest/windows-      i586/javafx2.jnlp"/>
</resources>
<resources>
    <j2se version="1.6+" java-vm-args="-verbose:class
          href="http://java.sun.com/products/autodl/j2se"/>
    <property name="javafx.verbose" value="true"/>
    <property name="java.library.path" value="WEB-INF/lib/bin"/>
    <jar href="MyJavaFxApp.jar" size="318607" download="eager" />
</resources>
<applet-desc  width="800" height="600" 
              main-class="com.javafx.main.NoJavaFXFallback"  
              name="MyJavaFxApp" >
    <param name="requiredFXVersion" value="2.2+"/>
</applet-desc>
<jfx:javafx-desc  width="800" height="600" 
                  main-class="ui.client.MyJavaFXMain"  name="MyJavaFxApp" />
<update check="background"/>
</jnlp> 
```

# android - Android 上的推送器

> ID：14824292
> 
> 赞同：3
> 
> 时间：2013-02-12T02:00:01.867
> 
> 标签：android, websocket, pusher

我正在尝试让 Pusher 在 Android 上运行。这是我的需求。

*   必须支持“私人”渠道
*   必须支持安全连接
*   必须能够覆盖 pusher/auth 端点。

注意：我已经尝试过以下路线......

*   在 WebView 中加载 pusher.js 并让它回退到 SockJS
*   [https://github.com/pusher/pusher-phonegap-android](https://github.com/pusher/pusher-phonegap-android)（似乎不支持安全连接）
*   [https://github.com/EmoryM/Android_Pusher/blob/master/src/com/emorym/android_pusher](https://github.com/EmoryM/Android_Pusher/blob/master/src/com/emorym/android_pusher)（需要将私钥推送到客户端，也不是最新的）
*   [https://github.com/jmschultz/JavaPusherClient](https://github.com/jmschultz/JavaPusherClient)（不支持私人频道）

其他人对此有任何运气吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T10:06:08.127

Pusher 有一个 Java 库：[https ://github.com/pusher/pusher-java-client](https://github.com/pusher/pusher-java-client)

这里有一个非常简单的示例应用程序： [https ://github.com/pusher/pusher-android-example](https://github.com/pusher/pusher-android-example)

您可以通过 告诉`Pusher`实例使用加密连接`PusherOptions`。见： [https ://github.com/pusher/pusher-java-client/blob/master/src/main/java/com/pusher/client/PusherOptions.java#L24](https://github.com/pusher/pusher-java-client/blob/master/src/main/java/com/pusher/client/PusherOptions.java#L24)

我认为这很可能会更新为默认设置，或者如果未加密的连接失败，至少重新连接将通过 SSL 尝试。

# html - 由于垂直滚动条而出现水平滚动条 - HTML 布局

> ID：14824294
> 
> 赞同：0
> 
> 时间：2013-02-12T02:00:08.687
> 
> 标签：html, css

请看一下 [http://jsfiddle.net/RRkC7/](http://jsfiddle.net/RRkC7/)

我已将封闭 DIV 标记“c”的宽度设置为子表 t1 的宽度。但是，由于水平滚动条的原因，出现了垂直滚动条。理想情况下，由于“c”的宽度与“t1”完全相同，因此不应出现水平滚动。

以及如何避免这种情况的想法。

请注意，我不能硬编码任何东西。当添加更多内容时，内部 TABLE 的宽度可能会增加，当这种情况发生时，我会调整容器 div 标签的大小。

我还希望在表格宽度超过某个数字的情况下同时出现水平和垂直滚动条。

谢谢，阿伦

```
<div id="p" style="overflow:hidden">
    <div id="c" style="overflow:auto">
        <table id="t1">
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
            <tr><td>testing_testing_testing</td><td>testing_testing_testing</td></tr>
        </table>
    </div> </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:06:05.827

这可能是因为填充，我不知道，但修改你的 javascript 工作。

```
$(function(){
    $("#c").width($("#t1").width() + 20);
    $("#c").height(150);
}) 
```

[http://jsfiddle.net/RRkC7/1/](http://jsfiddle.net/RRkC7/1/)

我玩弄了表格内的元素，宽度改变得很好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:50:56.713

这不是关于从宽度中添加或减去固定量，而是如果您注意到 CSS`padding: 5px`将 div 的宽度增加了 2 倍的填充，`padding-left`并且`padding-right`会出现在图片中。因此，您需要添加确切的填充量，在本例中为 10 像素。

您可以计算宽度和填充，如

```
$(function(){
    var toBeWidth = $("#t1").width() + (parseInt($("#t1").css("padding-left").split("px")[0])*2)
    $("#c").width(toBeWidth);
    $("#c").height(150);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T02:02:20.700

为您的 c div 指定宽度，并且不要为表格定义任何宽度，因此在这种情况下，表格将继承 c div 的宽度。现在使用表的溢出属性。因此，现在滚动条只会在表格获得更多数据并且其宽度将大于为 c div 定义的宽度时才会出现。

```
 overflow:scroll; 
```

# jquery - 相关下拉框未将正确信息传递给表单

> ID：14824299
> 
> 赞同：0
> 
> 时间：2013-02-12T02:00:24.200
> 
> 标签：jquery, forms, drop-down-menu

以[这个问题](https://stackoverflow.com/questions/4521984/conditional-simple-drop-down-list/4522020)为基础，我一直在尝试使用相关下拉框设置表单。用户从下拉框 1 中选择他们想要的信息会话，隐藏的下拉框将显示该（并且仅该）信息会话的相关日期。有 2 个（最初是隐藏的）下拉框，显示哪个取决于用户在第一个下拉框中选择的内容。

它在视觉上有效，但在尝试发布数据时效果不佳。从我通过 Firebug 可以看出，“禁用”在任何时候都不会从“真”改变，所以表单抱怨默认不是一个选项。firstChoice 选项失败，secondChoice 选项通过正常。

# HTML

```
<div id="myQuestions">
<select id="QuestionOptions" class="required" name="SESHTYPE">
<option selected="selected" value="Default">Choose information session.</option>
<option value="firstChoice">First One</option>
<option value="secondChoice">Second One</option>
</select>
</div>
<div id="myAnswers">
<div id="firstChoice" disabled="true" style="display: none;">
<select id="mce-INFODATE" name="INFODATE">
<option value="Default">Please choose a date:</option>
<option value="7th March">Thursday, 7th March</option>
<option value="20th March">Wednesday, 20th March</option>
<option value="11th April">Thursday, 11th April</option>
</select>
</div>
<div id="secondChoice" disabled="true" style="display: none;">
<select id="mce-INFODATE" name="INFODATE">
<option value="Default">Please choose a date:</option>
<option value="16th April">Tuesday, 16th April</option>
</select>
</div> 
```

# Javascript

```
 jQuery(document).ready(function($) {
    $('#QuestionOptions').change(function () {
    $('#myAnswers > div').hide().prop("disabled", true);
    $('#myAnswers').find('#' + $(this).val()).show().prop("disabled", false);
    });
    }); 
```

编辑：多一点挖掘，我发现你不能[像从这里一样在](http://api.jquery.com/disabled-selector/)div 上使用 disabled ；使用 children() 会让我到达我想去的地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T07:17:39.170

首先，您不能有两个具有相同名称和 id 的选择，它们需要不同。

其次，不能禁用 a `<div>`，只能隐藏它，但**可以**禁用 a `<select>`。也许尝试类似：

```
$('#myAnswers > div').hide()
$('#myAnswers select').prop("disabled", true);
var selectedDiv = $('#myAnswers').find('#' + $(this).val());
selectedDiv.show()
selectedDiv.find('select').prop("disabled", false); 
```

# php - 从 ajax 加载的脚本访问 JavaScript 函数

> ID：14824302
> 
> 赞同：0
> 
> 时间：2013-02-12T02:00:34.910
> 
> 标签：php, javascript, ajax, hmvc

我有一个在 HMVC 方法中使用 CodeIgniter 的 PHP 项目。

现在，我遇到了一个问题，我真的很困惑下一步该做什么。这是我的情况：

我有一个看起来像这样的视图：

```
//logs_v_month.php

<div id="logs" class="tab-pane active">

</div>

<script type="text/javascript">
$(function(){       
    $.ajax({
      url: "<?php echo load_global_assets('system/js/log.js')?>",
      dataType: "script",
      success: function(e){}
    });
});

</script> 
```

然后我有一个控制器：

```
//view.php
function display_logs_month(){
    $data['logs_v'] = $this->load->view('logs_v_month');                        

echo json_encode($data);
} 
```

然后我有另一个视图，即主视图。

```
//logs.php
<div class="tab-content" id="logs_content">
    <!--logs loaded via ajax call-->
</div>
<script type="text/javascript">
function view_month(group_id, start_end){
$.ajax({
    type : "POST",
    dataType: "json",
    url : "<?=base_url()?>logs/view/display_logs_month",                        
    data : {"group_id" : group_id},
    success : function (data){  
        $("div#logs").remove();                     
        $("#logs_content").append(data.logs_v);//logs_v             
    },
    error : function(data){
    console.log(data);
    }
    });
} 
```

logs.php 视图有一个通过 view.php 控制器加载 logs_v_month.php 视图的 ajax 调用。

我的问题是，如何从 logs.php 视图中的 logs_v_month.php 访问 JavaScript 函数（也通过 ajax 加载）？

我尝试在网上搜索答案，人们给出的大多数答案都是使用 eval() 函数，但许多人不鼓励使用它。

有没有办法可以重组或重新排列我的 JavaScript，以便在这种情况下轻松访问它们？如果这可以解决问题，我也会考虑命名空间。

我刚开始学习 CI 和 HMVC，所以我对此很陌生。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:11:20.230

您需要将返回的脚本放入页面的 DOM 中。

当您在 ajax 调用的成功方法中获取脚本数据时，您可以创建一个脚本元素，其中包含代码并将其附加到 DOM，例如：

```
success:function(data){
    var scriptElement = document.createElement('script');
    scriptElement.setAttribute('type', 'text/javascript');
    scriptElement.textContent = data;
    var head = document.getElementsByTagName('head').item(0);
    head.appendChild(scriptElement);
} 
```

现在，所有脚本都可以访问这些函数。

# php - Jquery：循环迭代

> ID：14824304
> 
> 赞同：1
> 
> 时间：2013-02-12T02:00:37.067
> 
> 标签：php, jquery, iteration

不确定它是否实际上迭代一次，但只生成一个对话框。jquery 循环针对每个 PHP 循环迭代的隐藏输入，从 1 开始计数；总共有两个“roomID”。

使用警报给了我两个，但它没有用 jquery 分配对话框，这反过来给了我第一个。为什么会这样？

有没有更好的方法来做到这一点：

```
$('input#roomID').each(function() {
   var roomID = $('input#roomID').val();
   alert($(this).val());

            $( 'div.edit-dialog-'+roomID ).dialog({ 
                autoOpen: false,
                height: 500,
                width: 550,
                modal: true,
                position:['middle','middle'],
                draggable: true,
                //resizable: true,
                buttons: {
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                    close: function() {
                        allFields.val( "" ).removeClass( "ui-state-error" );
                    }
            });

            $( 'a.room-edit-'+roomID).click(function() {
                $( 'div.edit-dialog-'+roomID ).dialog( "open" );
            });
    }); 
```

我对 Jquery 有点陌生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T02:03:21.300

您正在选择 id '#'。

Dom 需要唯一的 id。

试着把它变成一个类。

所以而不是

```
<input id="roomID" type="text" /> 
```

添加班级

```
<input class="roomID" type="text" /> 
```

然后

```
$('input.roomID').each(); 
```

将选择带有类的页面上的所有输入`roomID`

**编辑**

jQuery 的每个函数都会经过选择器匹配。所以说你有这个HTML：

```
<input class="hello" />
<input class="hello" />
<span class="hello">text</span> 
```

然后当你像这样调用每个：

```
$('.hello').each(function(i, ele){}); 
```

每次函数将具有`this`（或将作用域）到各个 dom 元素时，jQuery 都会调用该函数 3 次。它按照它们在 dom 中出现的顺序执行此操作。所以第一次通过它将是`input`then 。`input``span`

每次都`this`将指向各自的 dom 元素，而不是 jQuery 映射元素。这就是为什么您需要`$(this)`访问 jquery 的辅助方法而不是仅仅访问`this.val()`.

它还使用 2 个参数调用该函数，第一个是迭代次数，所以在这种`span`情况下这将是 2。第二个也是元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:12:52.257

[如果您使用另一个选择器](http://api.jquery.com/attribute-contains-selector/ "选择器")来自定义输入，这会更好。

```
 <input name="new3" />
 <input name="new2" />
 <input name="new1" />

 <script>
     $('input[name*="new"]').val('xxxxx');
 </script> 
```

# c# - 在不使用 SaveChanges 的情况下更新一对多关系

> ID：14824307
> 
> 赞同：0
> 
> 时间：2013-02-12T02:00:50.670
> 
> 标签：c#, entity-framework, one-to-many, savechanges

当调用上下文的 SaveChanges() 方法时，更改另一端的关系会自动更新。

例如，如果我有一个老师 mrX，他有一个虚拟的 ICollection 学生，包括 littleJohnny

```
mrX.Students.Remove(littleJohnny);
Debug.Assert(littleJohnny.Teacher!=null); //assert should pass
context.SaveChanges();
Debug.Assert(littleJohnny.Teacher==null); //assert should pass

mrX.Students.Add(littleJohnny);
context.SaveChanges();//revert to previous state

littleJohnny.Teacher=null;
Debug.Assert(mrX.Students.Contains(littleJohnny)); //assert should pass
context.SaveChanges();
Debug.Assert(!mrX.Students.Contains(littleJohnny)); //assert should pass 
```

1.  有没有办法在不将数据保存到实体框架 4.3 和 5.0 中的数据库的情况下更新此类关系？

2.  在另一种情况下，如果我有一个映射到上述实体的 ViewModel，是否有一种简单的方法可以复制此 EF 行为 -> 即跟踪关系并在调用方法时更新关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T12:31:08.547

试着打电话`context.ChangeTracker.DetectChanges()`

如果这不起作用，那么您的相关实体尚未正确初始化

# java - 如何在不使用“class”关键字的情况下编写java程序？

> ID：14824310
> 
> 赞同：-1
> 
> 时间：2013-02-12T02:01:09.730
> 
> 标签：java

有没有可能的方法，或者我们不能写任何方法，因为我们可以看到 java 中的一切都是从只使用类开始的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:02:31.277

不可以，Java 程序中的所有代码都*必须*包含在一个类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:03:22.983

编辑：你完全可以，OP发现了这一点，但没有在问题中提及。

```
enum Main {
    FOO, BAR;

    public static void main(String[] args) {
        System.out.println("Hello world");
    }
} 
```

[工作得很好。](http://ideone.com/a7Dxlk)

原答案：

你不能......但是在 Java 8 中这可能会改变，当你被允许向接口添加静态方法时。我*认为*Java 8 将允许您编写

```
interface Foo {
   public static void main(String[] args) {
      ...
   }
} 
```

但我需要仔细检查，答案可能在不断变化。

# jquery - 以某种方式在不使用 .on() 的情况下监听新元素

> ID：14824312
> 
> 赞同：0
> 
> 时间：2013-02-12T02:01:27.397
> 
> 标签：jquery, html

我有一个简单的悬停功能，可以向 LI 添加关闭按钮。问题是，创建了新的 LI，并且悬停不再起作用。我知道`.On();`会监视新创建的元素，但这似乎只适用于`.click()`.

JS：

```
 $("#sortable li").hover(function () {
     $(this).find(".close").show();
 },
 function () {
     $(this).find(".close").hide();
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:06:18.813

您可以使用委托形式的事件处理，但它不适用于伪事件`hover`，因此您需要同时观察 mouseenter 和 mouseleave 事件。

```
$("#sortable").on("mouseenter", "li", function() {
    // mouse over code here
    $(this).find(".close").show();
});

$("#sortable").on("mouseleave", "li", function() {
    // write your hover out code here
    $(this).find(".close").hide();
}); 
```

或更紧凑的形式：

```
$("#sortable").on({
    mouseenter: function() {
        // mouse over code here
        $(this).find(".close").show();
    }, 
    mouseleave: function() {
        // mouse leave code here
        $(this).find(".close").hide();
    }
 }, "li"); 
```

它的工作方式是鼠标事件在零件链中冒泡，因此这种委托形式`.on()`监视`#sortable`父级以查找源自子`li`标记的事件，然后在它们与所需事件匹配时触发您的回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:05:27.107

```
$('#sortable').on({
    mouseenter: function() {
            $(this).find(".close").show();
        },
    mouseleave: function() {
            $(this).find(".close").hide();
        }
}, 'li'); 
```

# kernel - inotify 未在 close() / 终止时释放监视句柄

> ID：14824315
> 
> 赞同：1
> 
> 时间：2013-02-11T13:41:28.103
> 
> 标签：kernel, inotify

我正在尝试使用 inotify 来监视容器使用的资源，并且遇到了看起来像错误的东西。我正在使用以下代码进行测试：

```
#include <stdio.h>
#include <errno.h>
#include <sys/inotify.h>

int main(int argc, char ** argv)
{
  int fd;
  int wd;
  int error;
  fd = inotify_init();
  if (fd >= 0) {
    printf("inotify_init: success fd=[%d]\n", fd);

    wd = inotify_add_watch(fd, "/tmp", IN_ALL_EVENTS);
    if (wd >= 0) {
      printf("inotify_add_watch: success fd=[%d] wd=[%d]\n", fd, wd);
    }

    if (inotify_rm_watch(fd, wd) >= 0) {
      printf("inotify_rm_watch: success fd=[%d] wd=[%d]\n", fd, wd);
    } else {
      printf("inotify_rm_watch: error fd=[%d] wd=[%d] errno=[%d]\n", fd, wd,     errno);
    }

    error = close(fd);
    if (error) {
      printf("close(fd) error: %d\n", error);
    } else {
      printf("close(fd) success fd=[%d] error=[%d]\n", fd, error);
    }
  } else {
    printf("inotify_init failed: %d\n", fd);
  }
  return 0;
} 
```

这应该在 上添加一个监视`/tmp`，立即将其删除，然后关闭 inotify 实例。

如果我在我的笔记本电脑（Arch Linux，使用 3.7.5 内核）上运行它，那么一切都会按预期工作：`for i in $(seq 1 200); do ./a.out; done`只要我愿意，我会很高兴地添加和删除手表。同样在使用 2.6.32 内核的旧 Ubuntu 10.04 机器上。

但是，在具有 3.2.0 内核的 Ubuntu 12.04 机器上，发出相同的命令将显示`n`成功运行的运行，然后立即开始失败，其中`n`等于 /proc/sys/fs/inotify/max_user_instances：换句话说，实例未正确关闭。inotify 文件描述符已成功删除，这使我假设 inotify 代码中存在某种回归。

有没有其他人遇到过这个问题，或者能够重现它？我没有在 Internet 上发现任何有关此问题的信息，但我想不出还有什么可能导致此问题。

# wordpress - 两个 CSS3 投影（左/右和左/右/下）

> ID：14824316
> 
> 赞同：0
> 
> 时间：2013-02-12T02:02:08.203
> 
> 标签：wordpress, css, html, dropshadow

我有一个正在开发的 wordpress 网站，我需要将 CSS3 阴影添加到四个元素。Content-menu-wrapper 独立于其他 div（未以图形方式连接）并且可以正常工作。

下一个 div 是内容包装器、页脚、页脚底部。每个 div 以图形方式“连接”一个在另一个之上。内容包装器需要顶部、左侧和右侧的阴影。页脚需要左右阴影。Footer-bottom 需要在左、右和底部有阴影。

当我尝试将阴影编辑为“测试”时，阴影就消失了。很可能我使用错误的代码。下面是内容菜单包装器的功能代码。

CSS：

```
#content-menu-wrapper
{
    background-color: white;
    margin:0px auto 15px auto;
    height: 32px;
    -webkit-box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
    -moz-box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
} 
```

请帮助我提供其他三个 div 的代码。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:34:15.010

左右很容易：

```
box-shadow: -15px 0 15px -15px rgba(0, 0, 0, 0.6),
             15px 0 15px -15px rgba(0, 0, 0, 0.6); 
```

然而，让三个侧面看起来不错是非常困难的，因为使用上述技术在角落有间隙。

我的建议是将所有元素包含在一个包装 div 中并将其应用于该 div `box-shadow`。使 CSS 更干净，更容易实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:15:11.333

使用[此在线工具](http://www.wordpressthemeshock.com/css-drop-shadow/)为您的 div 获取阴影的 css。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T15:19:19.713

根据上面jimjimmy的回答，我可以通过将内容和页脚div包装在一个更大的div中来解决这个问题。这些是细节：首先我在 common.css 中创建了一个新的 div id，“content-shadow”。

然后我添加了 box-shadow 属性以及我的 content-wrapper div 中的复制/粘贴属性，以便网站的格式正确。就我而言，它看起来像这样：

```
#content-shadow {

    border-left:0px solid #E7E7E7;
    border-right:0px solid #E7E7E7; 
    border-bottom:0px solid #E7E7E7;
    border-top:0px solid #E7E7E7;
    background-color:#FFFFFF;
    margin:0px auto 0px auto;
    margin-bottom:0px;
    margin-top:0px;
    width: 1000px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.6);
} 
```

接下来，我在我的主题的 header.php 文件中放置了一个 div，位于“content-wrapper”div 之前。保存该文件我移到了 footer.php 文件，并在文件末尾的适当位置放置了一个标签。对我来说，这是在“content-bottom-empty-space”div 之上，所以我可以在我的网站底部留出一点空间。

保存文件，现在它将/应该在整个 wordpress 中传播。我希望这对某人有所帮助。

# java - Java 构造函数不会接受正确的参数

> ID：14824317
> 
> 赞同：1
> 
> 时间：2013-02-12T02:02:11.077
> 
> 标签：java, constructor

我正在尝试为我正在制作的基于文本的游戏制作一个构造函数，并且无法让`Character`构造函数采用`String`and `int`。使用时只需要一个`char`.

```
public class Character {

public int attack, rangedAttack, manaAttack, defense, rangedDefense, manaDefense, strength, agility, intelligence ,race;
String name;

public Character(String Name, int Race) {
    name = Name;
    race = Race; 
}; 
```

这是我尝试使用构造函数的地方。

```
public class QuestOfVallock{

public static void main(String[] args){
       Character self = new Character();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:05:37.030

您定义了一个以 String 和 int 作为参数的构造函数，您必须以这种方式调用它：

```
Character self = new Character("Bobby the mighty elf", 1); 
```

如果你没有定义一个构造函数，你就不能调用没有参数的构造函数，除非你没有在类中定义另一个构造函数。

还：

*   不要定义一个名为的类，`Character`因为它已经是包 java.lang 中一个重要类的名称。
*   对变量（参数或成员变量）使用一些更好的命名约定：它们不应该大写，而是使用驼峰命名法。
*   最好通过将变量设为私有并使用 getter/setter 来访问它们来封装您的变量。如果它们是常量（在对象生命周期内不会改变），您可以考虑将它们设为“public final”或仅定义 getter，而不定义 setter。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T02:04:30.500

当您使用这样的参数定义自己的构造函数时

```
public Character(String Name, int Race) {
    name = Name;
    race = Race; 
} 
```

Java 不会为您放置默认构造函数，并且它是未定义的。您需要自己实现它。

**编辑1：**

Java中的变量命名甚至参数都应该是驼峰式的

**编辑2：**

有时我们定义了一个 setter 方法或构造函数，它们的参数名称（变量名称）在实例变量上也是相同的。看一个例子

```
public class Person
{
   private String name; // <-- 

   public Person(String name) // <--
   {

   }

   public void setName(String name)
   {

   }
} 
```

当你做这样的作业时

```
public Person(String name)
{
   name = name;  
} 
```

嗯，这很令人困惑。Java 会给你一个警告，变量赋值没有影响，我们也可能认为`name`(instance) 被赋值了一个新值。

解决问题使用`this.<variable name>`

```
public Person(String name)
{
   this.name = name;  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T02:04:49.213

它看起来像是与[java.lang.Character](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html)的命名空间冲突。

尝试声明一个包以避免歧义或将 Character 类重命名为其他名称。

```
package mygame;
public class Character {

    public int attack, rangedAttack, manaAttack, defense, rangedDefense, manaDefense, strength, agility, intelligence ,race;
    String name;

    public Character(String name, int race) {
        this.name = name;
        this.race = race; 
    }
} 
```

然后像这样实例化你的 Character 类：

```
mygame.Character self = new mygame.Character("John Doe", 1); 
```

更新：正如其他人所指出的，如果您定义了一个或多个构造函数，Java 不会为您创建默认构造函数（一个没有参数的构造函数）。但我仍然坚持我的回答，即包裹是要走的路。不鼓励使用默认包，仅适用于开始开发的小型应用程序。请参阅[使用 Java 的默认包是一种不好的做法吗？](https://stackoverflow.com/questions/7849421/is-use-of-javas-default-package-bad-style)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T02:09:02.053

另请注意...

```
public class Character {

    public int attack, rangedAttack, manaAttack, defense, rangedDefense, manaDefense, strength, agility, intelligence ,race;
    String name;

    public Character(String Name, int Race) {
        name = Name;
        race = Race; 
    } //<-- shouldn't have semicolon here...
} //<-- should match the braces for the class... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T02:04:21.913

当您定义带参数的构造函数时，默认构造函数将不再可用，直到您显式声明它：

所以你应该添加这个构造函数：

```
public Character(){ /* do something */ } 
```

或调用正确的构造函数。请记住，Java 没有参数的默认值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T02:05:22.060

**首先**
避免使用该名称`Character`，因为`java.lang`包中有一个已命名的类`Character`，它是原始数据类型的包装类`char`。
该类`java.lang.Character`用于自动装箱转换，[更多信息在这里](http://docs.oracle.com/javase/tutorial/java/data/autoboxing.html)

**其次**
将该类重命名为`Champion`，它肯定会起作用。:)

**第三**
，您没有将正确的参数传递给参数。当您将括号留空时，您的构造函数需要参数

## 它看起来像什么

```
public class Character {//<-- avoid this name

public int attack, rangedAttack, manaAttack, defense, rangedDefense, manaDefense, strength, agility, intelligence ,race;
String name;

public Character(String Name, int Race) {
    name = Name;
    race = Race; 
};//<-- Y U PUT SEMICOLON ? 
```

* * *

```
public class QuestOfVallock{

public static void main(String[] args){
       Character self = new Character(); //<-- Y U NO GIVE HIM PARAMETERS ?
} 
```

## 它应该是什么

```
public class Champion { //<-- Java-approved name

public int attack, rangedAttack, manaAttack, defense, rangedDefense, manaDefense, strength, agility, intelligence ,race;
String name;

public Character(String Name, int Race) {
    name = Name;
    race = Race; 
}//<-- No semicolon
}//<-- Closing brace for class 
```

* * *

```
public class QuestOfVallock{

public static void main(String[] args){
       Champion self = new Champion("Little Java Child",1001); //<-- Unique race
}
}//<-- closing brace for class 
```

* * *

我还建议`Race`在`interface`

```
public interface RaceConstants {
    int ELF = 1;
    int JAVA_CHILD = 1001;
    int DWARF = 2;
} 
```

所以你`main()`看起来像这样：

```
public static void main(String[] args){
       Champion self = new Champion("Little Java Child",RaceConstants.JAVA_CHILD; //<-- Unique race
} 
```

# algorithm - 最大加权二分匹配_with_有向边

> ID：14824320
> 
> 赞同：2
> 
> 时间：2013-02-12T02:02:24.873
> 
> 标签：algorithm, graph, complexity-theory, matching

我知道各种算法来计算**加权无向**二部图的最大加权匹配（即分配问题）：

例如......匈牙利算法、Bellman-Ford 甚至 Blossom 算法（适用于一般的，即非二分图）。

但是，如果二部图的边是**加权和定向**的，我如何计算最大加权匹配？

我会很感激具有多项式复杂性或先验变换的算法的指针，以使图形无向，以便我可以应用上述任何算法。

**编辑：**请注意，匹配应该使边缘的权重最大化，这就是为什么有向边缘会有所不同（A->B 的权重可能与 B->A 的权重完全不同）。

诚然，如果我要最大化基数，则有向边不会产生影响，我可以应用任何众所周知的算法来最大化基数：Hopcroft–Karp，最大网络流量......

**编辑2**：由于*匹配*是一个通常应用于无向图的术语，让我澄清一下我在这个问题中*匹配的确切含义：**一组不共享开始或结束顶点的有向边*。更正式地说，如果 U->V 和 U'->V' 是匹配的一部分，则 V /= U' 和 V' /= U。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:52:34.993

dfb 的评论是正确的，对于任意两个顶点 A、B，您可以丢弃两条边 AB 和 BA 中较便宜的那个。

证明是单行的：

**定理：**对于任意两个顶点 A，B，最大匹配 M 永远不会包含 AB 和 BA 的便宜边。

**证明：**设 M 为最大匹配。假设 AB 在 M 中并且比 BA 便宜。定义 M' = M - {AB} + {BA}。M' 显然仍然是一个匹配项，但它更昂贵。这与 M 是最大匹配的假设相矛盾。

# ssl - 将网站从 HTTP 迁移到完全 HTTPS 和 SEO 影响

> ID：14824326
> 
> 赞同：5
> 
> 时间：2013-02-12T02:02:32.323
> 
> 标签：ssl, seo

好吧，您认为这可能是互联网上被问到最多的问题之一，并且您已经厌倦了阅读完全相同的答案。因此，让我们专注于最常见的答案之一，而忘记其他答案。

**常见的答案之一是：**

> “https-site 和 http-site 是两个完全不同的网站；这有点像网站的 www 版本和非 www 版本。确保您有从 http URL 到 https 的 301 重定向。 " （来源： [http](http://www.seomoz.org/ugc/seo-for-https-with-s-like-secure) ://www.seomoz.org/ugc/seo-for-https-with-s-like-secure ）

**所以这是我的问题：**

为什么人们这么说，`https`并且`http`是两个不同的网站？[https://www.mydomain.com](https://www.mydomain.com)与[http://www.mydomain.com](http://www.mydomain.com)有何不同？

URI相同，内容相同。只有协议改变。

为什么该协议会对 SEO 产生任何影响？无论内容是否从 A 点加密到 B 点，为什么这对 SEO 很重要？

谢谢你的帮助！

-H

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T10:49:19.110

Http 和 https 在*技术上*可能是两个不同的站点。您可以将您的服务器配置为提供完全不同的内容。它们有两个不同的 url（不同之处在于 s）。

话虽如此，无论网站是否安全，几乎所有同时使用 http 和 https 的网站管理员都提供几乎相同的内容。Google 认识到这一点，并允许您同时运行两者，而不必担心重复的内容惩罚。

如果您从一个移动到另一个，则应将其与其他 url 更改类似地对待。

*   放置 301 重定向，以便每个页面都能正确重定向到其新 url 的相同内容
*   在 Google 网站管理员工具中注册这两个版本

我没有亲自做过这个切换，但它应该是可行的，没有问题。在过去的几年里，我已经对其他类型的站点范围的 url 进行了更改而没有出现任何问题。

另一种选择是同时运行 http 和 https 并逐渐切换用户。例如，当他们登录时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-08T06:47:44.940

更新到 2014 年 8 月的上述答案，谷歌刚刚确认受 SSL 保护的网站将开始获得排名提升。在此处查看官方声明：http: [//googlewebmastercentral.blogspot.in/2014/08/https-as-ranking-signal.html](http://googlewebmastercentral.blogspot.in/2014/08/https-as-ranking-signal.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:54:55.000

不要从协议的角度考虑它。从搜索引擎的角度考虑它的潜力。

[http://example.com](http://example.com)和[http://www.example.com](http://www.example.com)可以是完全不同的站点。

[http://example.com/](http://example.com/)和[http://www.example.com/home](http://www.example.com/home)可以是完全不同的页面。

[https://www.example.com](https://www.example.com)和[http://www.example.com](http://www.example.com)同样可以是完全不同的站点。

*除此之外*，https 页面的排名非常困难。谷歌等

如果您的整个站点都是 https 并且向 HTTP 请求弹出 SSL 证书，G 认为它们是安全的并且它们是 https 是有原因的。在这方面有时不是很聪明。例如，如果您有安全的产品或类别页面，那么与竞争对手相比，它们根本不会排名。我已经一次又一次地看到了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-11T18:26:58.793

最近几个月，很明显谷歌将温和地强制网站管理员转向 HTTPS。

> 为什么有人说https和http是两个不同的网站？www.mydomain.com 与 www.mydomain.com 有何不同？

答：使用 site: 运算符查找重复的内容。转到浏览器并键入：

站点：[http ://example-domain.com](http://example-domain.com)

和

站点：[https ://example-domain.com](https://example-domain.com)

如果您在 Google 或其他搜索引擎中看到这两个版本的索引，则它们是重复的。您必须将 HTTP 版本重定向到 HTTPS 版本，以避免削弱您的网站权限以及可能受到 Google Panda 算法的惩罚。

> 为什么该协议会对 SEO 产生任何影响？

回答：

1.  对于电子商务网站，如果没有安全性，Google 不会对它们进行很好的排名。他们不希望用户窃取他们的银行信息等。
2.  谷歌将在未来为迁移到 HTTPS 的网站提供排名提升。虽然现在不是一个很大的排名信号，但它可能会变得更大。
3.  谷歌浏览器的人已经提交了一份提案，针对所有不使用 HTTPS 的网站向用户发出警告。是的，我知道这听起来很疯狂，但是看一下这个。

从[本指南](https://thebc.co/seo/move-website-http-https-ssl-tls-without-killing-rank/)中获取的有关如何在不影响排名的情况下迁移到 HTTPS 的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-27T08:43:19.953

最近，如果 SSL 在 Firefox 浏览器中处于非活动状态，则会显示错误。您必须启用 SSL 并将 URL 重定向到 HTTPS 301

# jquery - 在 jquery mobile 上使用自定义 jquery？

> ID：14824328
> 
> 赞同：0
> 
> 时间：2013-02-12T02:02:46.140
> 
> 标签：jquery, jquery-mobile

我在 jquery 移动网站中使用了一些自定义 jquery 事件。我在 jquery-mobile 包含之前包含了这个 custom.js——因为我相信这是正确的做法。jquery 被首先包括在内。这些文件包含在每一页上。

```
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="/components/m/js/custom.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

当我加载我的主索引页面时，没有使用 custom.js 的元素。当我点击一个页面进入更深的地方时，我的问题就出在哪里。因此，我单击一个链接以查看在 custom.js 中有事件的艺术家当 jquery mobile 执行此操作时，我的单击事件不起作用。

但是，如果我重新加载页面，自定义单击事件将正常工作。

我错过了什么？我应该使用 .live('click' 而不是 .click 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:39:10.623

在与 Gajotres 交谈后（通过上述评论的电子邮件），我们得出以下结论。

我的自定义 js 文件实际上必须在 jQM 文件之后。

```
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script src="/components/m/js/custom-alt.js"></script> 
```

另外，这是我的自定义 js 文件的样子：

```
$(document).bind("pageinit", function() {
    var btnAddComment = $('#btn-addcomment');

    // register functions with jqm framework
    $(btnAddComment).bind('touchstart mousedown', function(e){
        e.preventDefault();
        clickCommentAdd(); 
    }); 

    function clickCommentAdd() {
        $("#form-comment").toggle();
        return false;
    }
}); 
```

以前，我使用的是“mobileint”而不是“pageint”，并且引用自 Gajotres：

> 原因是，pageinit 事件仅在加载 jQuery Mobile js 文件时起作用。我还看到您甚至尝试使用 mobileinit。好吧，该事件应该在 jQuery Mobile js 文件之前使用（到目前为止还不错），但是您可以使用它来绑定和单击事件，因为您需要加载 jQM js 文件来初始化页面元素。

# c# - 陷印两个时间编辑时间表

> ID：14824329
> 
> 赞同：0
> 
> 时间：2013-02-12T02:02:48.217
> 
> 标签：c#, vb.net, winforms, visual-studio-2010, datetime

我有这个示例表格，它设置和比较两个时间表。

![在此处输入图像描述](../Images/e8663a07e66736af3cdede40ef82f906.png)

如果第二个时间表在第一个时间表（时间开始和时间结束）之间，我想捕获无法设置第二个时间表的时间。

**例如： 第一个时间表：上午 8:00:00 到上午 10:00:00 我想捕获第二个时间表，以便它不能设置在第一个时间表之间，例如上午 8:30:00、9:00： 00 AM、9:30:00 等。.它将设置为上午 10:00:00 或以上。我怎么可能做到这一点？**

我已经完成了某种代码，但弄清楚如何做到这一点对我来说很难。任何人都可以帮忙吗？

这是我的示例代码：

```
 Private Sub Test_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If timeStart.EditValue > timeEnd.EditValue Then
            XtraMessageBox.Show("Time end must higher than time start", "", MessageBoxButtons.OK, MessageBoxIcon.Hand)
            Exit Sub
        ElseIf timeStart.EditValue = timeEnd.EditValue Then
            XtraMessageBox.Show("Time start must not be equal to time end", "", MessageBoxButtons.OK, MessageBoxIcon.Hand)
            Exit Sub
        ElseIf timeStart1.EditValue < timeEnd.EditValue Then
            XtraMessageBox.Show("Invalid", "", MessageBoxButtons.OK, MessageBoxIcon.Hand)
            Exit Sub
        ElseIf timeEnd1.EditValue < timeEnd.EditValue Then
            XtraMessageBox.Show("Invalid", "", MessageBoxButtons.OK, MessageBoxIcon.Hand)
            Exit Sub
        End If

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T09:55:35.770

```
Dim t1Start = timeStart.EditValue
Dim t1End = timeEnd.EditValue
Dim t2Start = timeStart1.EditValue
Dim t2End = timeEnd1.EditValue

If (t2Start >= t1Start And t2Start <= t1End) Or _
    (t2End >= t1Start And t2End <= t1End) Or _
    (t1Start >= t2Start And t1Start <= t2End) Then

    XtraMessageBox.Show("The times should not overlap", "", MessageBoxButtons.OK, MessageBoxIcon.Hand)

End If 
```

可能有四种情况：

```
1st range   <------->      <------->   <------->   <------->
2nd range       <----->  <----->        <----->   <---------> 
```

*   第一个比较对测试的第二个范围的开始位于最合适的中间。
*   第二个比较对测试第二个范围的末端位于第一个范围的中间。
*   唯一剩下的情况是当整个第一个范围在第二个范围之间时。第三个比较对检查第一个范围的开始在第二个范围之间。

这处理了重叠范围的所有情况。

# .net - 树视图节点事件

> ID：14824331
> 
> 赞同：0
> 
> 时间：2013-02-12T02:03:14.967
> 
> 标签：.net, vb.net, events, treeview

`TreeView`我想在用户选择一个节点后向我添加一个事件。

```
For i = 0 To Informacion.Count - 1 Step +1
        arreglosplit = Informacion(i)

        Select Case arreglosplit(3)

            Case "ab"
                Dim nn As TreeNode = New TreeNode(arreglosplit(5).ToString)

                n0.Nodes.Add(nn)
            Case "bc"
                Dim nn As TreeNode = New TreeNode(arreglosplit(5).ToString)
                n1.Nodes.Add(nn)

            Case "cd"
                Dim nn As TreeNode = New TreeNode(arreglosplit(5).ToString)
                n2.Nodes.Add(nn)

            Case "de"
                Dim nn As TreeNode = New TreeNode(arreglosplit(5).ToString)
                n3.Nodes.Add(nn) 
```

选择后如何添加事件将文本设置为a `TextBox`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:11:30.883

您可以使用`AfterSelect`/`BeforeSelect`事件。这在 MSDN 上很容易搜索到。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.afterselect.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.afterselect.aspx)

# sql - SQL Server 查询两次返回同一行

> ID：14824334
> 
> 赞同：3
> 
> 时间：2013-02-12T02:03:37.693
> 
> 标签：sql, sql-server

我似乎在使用以下查询时遇到了问题。`mc_WorkoutDetails`它基本上可以工作，但我有一个案例，它从两次返回一行！

这是原始查询：

```
ALTER PROCEDURE [dbo].[mc_Workouts_GetActivities]
    @WorkoutID                  bigint
AS
BEGIN
    SET NOCOUNT ON

    SELECT d.ID, a.Description,
            CASE WHEN Reps = 0 THEN NULL ELSE Reps END AS Reps,
            CASE WHEN Sets = 0 THEN NULL ELSE Sets END AS Sets,
            CASE WHEN Minutes = 0 THEN NULL ELSE Minutes END AS Minutes,
            d.Comments, c.Name AS Category, a.CategoryID,
            (CASE WHEN v.ActivityID IS NULL THEN 0 ELSE 1 END) AS HasVideo,
            a.ID AS ActivityID
    FROM mc_WorkoutDetails d
            INNER JOIN mc_Activities a ON d.ActivityID = a.ID
            INNER JOIN mc_Activities_Categories c ON a.CategoryID = c.ID
            LEFT OUTER JOIN mc_TrainerVideos v ON a.ID = v.ActivityID
    WHERE (d.WorkoutID = @WorkoutID)
    ORDER BY SortOrder, a.Description

    RETURN @@ERROR
END 
```

然后我尝试改变：

```
INNER JOIN mc_Activities a ON d.ActivityID = a.ID
INNER JOIN mc_Activities_Categories c ON a.CategoryID = c.ID 
```

到：

```
LEFT OUTER JOIN mc_Activities a ON d.ActivityID = a.ID
LEFT OUTER JOIN mc_Activities_Categories c ON a.CategoryID = c.ID 
```

但这似乎没有帮助。我仍然得到重复的行。

谁能看到发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:13:20.990

您可以做的是使用组将连接添加回同一个表以清除重复的行。

因此，在 FROM mc_WorkoutDetails d 之后将此添加到您的联接中：

```
inner join (select [columns you want to select], max(id) id
            from mc_WorkoutDetails
            group by [columns you want to select] ) q on q.id = d.id 
```

让我知道这是否有意义。基本上，您正在执行不同的操作并获取最大 id，因此您消除了连接中的一行。您必须记住，即使您希望存在重复项，即使假设它们存在，它们也会被消除。

完整的改变将是：

```
ALTER PROCEDURE [dbo].[mc_Workouts_GetActivities]
@WorkoutID                  bigint
AS
BEGIN
SET NOCOUNT ON

SELECT d.ID, a.Description,
        CASE WHEN Reps = 0 THEN NULL ELSE Reps END AS Reps,
        CASE WHEN Sets = 0 THEN NULL ELSE Sets END AS Sets,
        CASE WHEN Minutes = 0 THEN NULL ELSE Minutes END AS Minutes,
        d.Comments, c.Name AS Category, a.CategoryID,
        (CASE WHEN v.ActivityID IS NULL THEN 0 ELSE 1 END) AS HasVideo,
        a.ID AS ActivityID
FROM mc_WorkoutDetails d
inner join (select Reps, Sets, Comments, Minutes, max(id) id
            from mc_WorkoutDetails
            group by Reps, Sets, Comments, Minutes ) q on q.id = d.id
        INNER JOIN mc_Activities a ON d.ActivityID = a.ID
        INNER JOIN mc_Activities_Categories c ON a.CategoryID = c.ID
        LEFT OUTER JOIN mc_TrainerVideos v ON a.ID = v.ActivityID
WHERE (d.WorkoutID = @WorkoutID)
ORDER BY SortOrder, a.Description

RETURN @@ERROR
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:55:18.377

感谢大家的意见。这里的一般建议是正确的：表中有两行`mc_workoutDetails`引用了表中的同一行`mc_Activities`。

虽然外键是唯一主键的一部分，但它是复合键，因此只要键中的另一列不同，该列就可以包含重复项。

# c++ - 具有相等参数的 std::vector::erase

> ID：14824340
> 
> 赞同：0
> 
> 时间：2013-02-12T02:04:51.340
> 
> 标签：c++, stl

调用迭代方法是否安全，例如 STL 容器擦除（覆盖采用 2 个迭代器），例如在我的情况下`std::vector::erase()`，两个参数都是`vec.end()`？我做了一个实验，看起来这个调用什么也没做，但我想确保我可以在代码中安全地使用它，否则我必须测试我的迭代器并避免`erase()`它们是否相等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T02:14:11.970

C++ 标准 (n3337)，23.2.3，序列容器，表 100（'序列容器要求）- 行`a.erase(q1,q2)`：

> 效果：擦除范围内的元素`[q1,q2)`。

这意味着这`a.erase(q,q)`是安全的，因为它什么都不做。

Loki Astari 对[这个 SO 问题](https://stackoverflow.com/questions/81656)的回答有一份 C++ 标准草案的列表。不幸的是，官方副本不是免费提供的，所以我使用的是 n3337，它似乎是最接近 C++11 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T02:15:55.447

它是安全的；这是一个有效的空操作，因为 end() -> end() 是一个空范围。

# java - Android Holo Light 样式会根据所选的上下文而变化

> ID：14824342
> 
> 赞同：8
> 
> 时间：2013-02-12T02:05:05.727
> 
> 标签：java, android, android-theme, android-context, android-styles

我一直在尝试为我的`Views`整个应用程序找到奇怪的格式样式不一致的原因，我想我已经用这个例子缩小了范围。

`Views`我使用完全相同的程序设置了两个等效的各种 s 布局，并且**只**改变了`Context`创建时提供的内容。在第一组中，每个`View`都是通过应用程序的上下文创建的`Activity.getApplicationContext()`，而在第二组中，`View`s 是通过 为活动的上下文提供的`this`。

结果大不相同：

![在此处输入图像描述](../Images/0a20e3c3239a016ebf34e872bdadb851.png)

关于为什么使用应用程序上下文会导致屏幕截图中出现垃圾格式（并且不一致 - 颜色是白色和灰色）的任何建议？

**活动代码：**

```
import android.os.Bundle;
import android.app.Activity;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.Spinner;
import android.widget.TextView;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // TextViews
        TextView tv1 = new TextView(getApplicationContext());
        tv1.setText("With Application  context");
        TextView tv2 = new TextView(this);
        tv2.setText("With Activity  context");      

        // Spinners
        Spinner sp1 = new Spinner(getApplicationContext());
        sp1.setAdapter(new ArrayAdapter<String>(getApplicationContext(), android.R.layout.simple_spinner_item, new String[] {"App context 1", "App context 2", "App context 3"}));
        Spinner sp2 = new Spinner(this);
        sp2.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, new String[] {"Act context 1", "Act context 2", "Act context 3"}));

        // Edittexts
        EditText et1 = new EditText(getApplicationContext());
        et1.setText("Application Context");
        EditText et2 = new EditText(this);
        et2.setText("Activity Context");        

        // Buttons
        Button b1 = new Button(getApplicationContext());
        b1.setText("Application Context");
        Button b2 = new Button(this);
        b2.setText("Activity Context");     

        // Layout structure
        LinearLayout ll = new LinearLayout(this);
        ll.setOrientation(LinearLayout.VERTICAL);

        ll.addView(tv1);
        ll.addView(sp1);
        ll.addView(et1);
        ll.addView(b1);
        ll.addView(tv2);
        ll.addView(sp2);
        ll.addView(et2);
        ll.addView(b2);

        setContentView(ll);
    }

} 
```

**显现：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.test.test"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" 
        android:theme="@android:style/Theme.Holo.Light" >
        <activity
            android:name="com.test.test.MainActivity"
            android:label="@string/app_name" 
            android:theme="@android:style/Theme.Holo.Light" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T07:51:14.713

在 Android 源`getApplicationContext()`返回 Application 对象，它扩展`ContextWrapper`，所以使用`getApplicationContext()`你传递`ContextWrapper`子类，但是当你传递时`this`，你传递一个`Activity`扩展的对象，`ContextThemeWrapper`所以你传递`ContextThemeWrapper`子类。现在 和 之间的区别在于`ContextWrapper`，`ContextThemeWrapper`它`ContextWrapper` [只是将其所有调用委托给另一个 Context](http://developer.android.com/reference/android/content/ContextWrapper.html)并`ContextThemeWrapper` [允许您从包装的 context 中修改主题](http://developer.android.com/reference/android/view/ContextThemeWrapper.html)。

虽然，问题更多是关于为什么会发生这种情况（与明确的原因相反），这里还有一些有用的帖子解释了错误使用应用程序上下文的危险以及如何正确选择上下文：

*   [何时调用活动上下文或应用程序上下文？](https://stackoverflow.com/questions/7298731/when-to-call-activity-context-or-application-context)
*   [到处使用应用程序上下文？](https://stackoverflow.com/questions/987072/using-application-context-everywhere)

最重要的是来自@CommonsWare： *“getApplicationContext() 不是一个完整的上下文，因此不支持 Activity 所做的一切。”*

**关于上下文的很棒的帖子应该可以澄清一切：**

*   [http://www.doubleencore.com/2013/06/context/](http://www.doubleencore.com/2013/06/context/)

# events - Magento 1.7 - 成功订购后更改可下载的产品网址

> ID：14824347
> 
> 赞同：0
> 
> 时间：2013-02-12T02:05:43.523
> 
> 标签：events, magento, url, download, product

成功订购后更改可下载产品网址时遇到很多麻烦。

现在我正在听“sales_model_service_quote_submit_after”和低谷：

```
$order = $observer->getEvent()->getOrder();
$items = $order->getAllItems();
foreach ($items as $product)
{
    $links = $product->getProduct()->getDownloadableLinks();
    foreach ($links as $link)
    {
        $link->setLinkUrl('My New Url');
    }
} 
```

我正在尝试设置一个新的。它可以工作，但似乎稍后会重置为原始值。我可能需要找到另一个观察者事件，但我不知道哪个是正确的。我还尝试了“之前”和“成功”的。

感谢您的宝贵帮助:)。再见' ！

编辑：sales_order_save_before 效果更好！但它执行不止一次。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:35:17.490

giftcards_observer_sales_order_place_after 成功了。

# javascript - 正确定位前一个 div

> ID：14824350
> 
> 赞同：0
> 
> 时间：2013-02-12T02:06:06.460
> 
> 标签：javascript, jquery

html:

```
<div class="wrap">
   <div class="fotorama"><img src="img1.jpg">/></div>
   <div class="fotorama-fullscreen">Open fullscreen</div>
</div>

<div class="wrap">
   <div class="fotorama"><img src="img2.jpg">/></div>
   <div class="fotorama-fullscreen">Open fullscreen</div>
</div>

<div class="wrap">
   <div class="fotorama"><img src="img3.jpg">/></div>
   <div class="fotorama-fullscreen">Open fullscreen</div>
</div> 
```

jQuery

```
$(".fotorama-fullscreen").each(function(){
    $this = $(this);
    $this.on('click', function(){
        $("#wrapper").fadeTo(1000, 0, function(){
            $("#main").isotope("destroy");
            $this.prev().trigger('fullscreenopen'); <== My trigger
            $("#wrapper").fadeTo(1000, 1);
        });
    });
}); 
```

我有一堆画廊，我按下一个按钮就可以全屏打开。上面的代码可以在桌面上工作，但是当我在 iPad 上时，它不会打开画廊，这让我觉得`.prev();`在 ipad 上不起作用？还是我在寻找和解决正确路径时做错了什么？

# vim - 让 AutoComplPop 搜索整个项目（或打开缓冲区）？

> ID：14824351
> 
> 赞同：1
> 
> 时间：2013-02-12T02:06:14.367
> 
> 标签：vim

我开始使用[AutoComplPop](http://www.vim.org/scripts/script.php?script_id=1879)来自动完成代码。它适用于我正在编辑的单个文件，但如果 file1 正在引用 file2 中定义的方法，则找不到它。

文档没有指定是否有办法让它搜索整个项目目录，甚至只是所有打开的缓冲区，所以我不知道这是否只是插件不做的事情，或者我是否需要启用某些东西.

如果相关的话，我正在两个 Ruby 文件上对其进行测试。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-11-10T12:44:43.820

看起来问题的原因是 ACP 将[`complete`选项](http://usevim.com/2012/07/06/vim101-completion/)设置为`.,w,b,k`（参见 autocomplpop/plugin/acp.vim 中的第 125 行），

> ```
> call l9#defineVariableDefault('g:acp_completeOption', '.,w,b,k') 
> ```

而按下时使用的默认值`\<C-n>`是`.,w,b,u,t,i`。看起来最后一个字母`i`实际上有所不同：出于某种原因，vim*不会*使用在缓冲区中打开的包含文件中的单词来完成另一个缓冲区中的单词。所以，`b`选项是不够的，`i`还必须包括在内。将以下行添加到我的 .vimrc 帮助

```
let g:acp_completeOption = '.,w,b,u,t,i' 
```

至少它适用于 C++ 文件，但我不确定它是否能解决 Ruby 脚本的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:35:34.983

哦，酷，这个插件看起来很像[neocomplcache](https://github.com/Shougo/neocomplcache)，但可能更干净......看起来有点旧。很少有人担心那个项目有这么多未结的票，而且两年内没有更新。

无论如何，根据[文档](https://bitbucket.org/ns9tks/vim-autocomplpop/src/13fe3d8064647e2cdf07e12840108c3f917f5636/doc/acp.txt?at=default)，它并没有……真的……说。很可能是以下情况之一：

*   你的`pwd`. 如果您的源代码的根目录是，`some/path`那么它也应该是您当前的工作目录。尝试输入`:cd some/path`以查看是否有所作为。
*   运行时路径`rtp`。看看添加带有源文件的目录是否可以解决`&rtp`问题。
*   `path`。_ 与设置相同的交易`&rtp`。

这个插件很可能只是依赖与 vim 捆绑的内置 ruby​​ 全能补全功能。试试`help ft-ruby-omni`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T08:13:57.267

根据光标左侧的内容，ACP（与所有替代方案一样）决定使用哪种完成机制。

但是 ACP 只使用 Vim 的默认补全机制：如果`<C-x><C-o>`和`<C-n>`/`<C-p>`不提供您要查找的内容，ACP 将无济于事。先试试看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-05T14:07:25.313

我只是遇到了同样的问题，实际上我找到了解决方案。显然，您必须在`.vimrc`文件中设置以下内容：

```
let g:acp_behaviorKeywordCommand = "\<C-x>\<C-i>" 
```

这将使 acp 在您的源包含的每个文件中查找完成，就好像您实际上正在键入`<C-p>`. 但是，它很慢，在尝试后我决定在`<C-p>`没有匹配项和其他情况下的默认行为时恢复使用。

# asp.net - 查询在 SQL Server 中成功执行，但在 .NET 中未成功执行

> ID：14824358
> 
> 赞同：0
> 
> 时间：2013-02-12T02:07:01.897
> 
> 标签：asp.net, sql-server

我编写了一个在 .NET 应用程序和 SQL Server 中运行良好的查询。

但是，当我使用宽参数进行测试时，我发现对于那个特定的，它没有在 .NET 应用程序中显示任何内容，而是在 SQL Server 中显示结果。

我试着google，没有结果，有点奇怪。所以，我在这里问。

这是我的查询：

```
 SELECT DISTINCT 
        tblCustomers.customerID AS Customer#, 
        tblCustomers.firstName + ' ' + tblCustomers.surname AS Name, 
        tblCustomers.street AS Street, 
        tblCustomers.suburb AS Suburb, 
        tblCustomers.postCode AS Postcode, 
        tblCustomers.state AS State, 
        tblCustomers.country AS Country, 
        tblCustomers.phone AS [Phone No.], 
        tblCustomers.fax AS Fax, 
        tblCustomers.mobilePhone AS [Mobile Phone], 
        tblCustomers.email AS [E-mail]
  FROM    
        tblCustomers 
  INNER JOIN
        tblProduct_Backorder ON tblCustomers.customerID = tblProduct_Backorder.customerId
  WHERE     
        (tblCustomers.customerID IN
              (SELECT     
                   customerId
                FROM          
                    tblProduct_Backorder AS tblProduct_Backorder_1
                WHERE      
                    (productId IN
                            (SELECT     
                                 productID
                             FROM 
                                 tblProducts
                             WHERE      
                                (skuCode = 76761)
                    )
                 )
           )
       ) 
```

此查询不适用于`skuCode = 76761`，但此查询在 SQL Server 中运行良好。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:20:19.283

您的问题确实没有足够的信息让我们甚至开始猜测导致问题的原因。与此同时，试试这个而不是你的查询：

```
SELECT c.customerID AS [Customer#],
        c.firstName + ' ' + tblCustomers.surname AS Name,
        c.street AS Street,
        c.suburb AS Suburb,
        c.postCode AS Postcode,
        c.state AS State,
        c.country AS Country,
        c.phone AS [Phone No.],
        c.fax AS Fax,
        c.mobilePhone AS [Mobile Phone],
        c.email AS [E-mail]
 FROM   dbo.tblCustomers c
 WHERE  EXISTS ( SELECT 1
                 FROM   dbo.tblProduct_Backorder b
                 JOIN   dbo.tblProduct p
                        ON b.productId = p.productId
                 WHERE  p.skuCode = 76761
                        AND b.customerId = c.customerId ); 
```

如果我正确理解您的表格关系，它将产生相同的结果，同时做的工作会少得多。

对于您的原始问题，您还应该发布 .net 代码。另外，“没有结果”是什么意思？一个空的结果？超时？一个错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:49:23.360

我在 xQbert 的评论的帮助下找到了解决方案。我花时间了解了查询是如何在 SQL Profiler 中执行的。表 tblProdus 中的 skuCode 是 nvarchar(6)，表 tblProduct_BackOrder 中是整数。因此，我使用 Convert() 函数将相同参数转换为整数。

# ios6 - 使 UIActivityViewController 图标中的自定义项变得丰富多彩？

> ID：14824359
> 
> 赞同：3
> 
> 时间：2013-02-12T02:07:16.033
> 
> 标签：ios6, uiactivityviewcontroller, uiactivity

我按照[如何在 iOS 中创建自定义 UIActivity？](https://stackoverflow.com/questions/12766300/how-can-i-create-a-custom-uiactivity-and-uiactivityprovider-in-ios-6)它按预期工作。看起来 iOS 为所有自定义图标以及它自己的“书签”、“打印”等强制赋予金属外观和感觉。无论如何让我的图标变得丰富多彩？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:35:47.810

从 iOS 6 开始，无法执行此操作。

`UIImage`方法返回的`UIActivity`所有颜色数据`activityImage`都将被忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-14T04:51:37.843

在 iOS 10 中，将`activityCategory`类属性设置为 .share。这将导致活动图标以彩色显示在 UIActivityViewController 的顶行。

在您的 UIActivity 子类中：

在 iOS 10 中，将`activityCategory`类属性设置为 .share。这将导致活动图标以彩色显示在 UIActivityViewController 的顶行。

在您的 UIActivity 子类中：

```
class MyCustomActivity: UIActivity
{
    ...

    override open class var activityCategory: UIActivityCategory
    {
        get
        {
            return UIActivityCategory.share;
        }
    }

    ...
} 
```

# php - mysqli_fetch: returns one row

> ID：14824368
> 
> 赞同：-2
> 
> 时间：2013-02-12T02:09:14.527
> 
> 标签：php, jquery, mysql, json, mysqli

I am making a private message system and I'm using the `mysqli_fetch()` function in a `while` statement to return all the rows associated with the query. However, PHP only returns the last row in MYSQL.

Here is my code:

```
<?php
$Connect = new mysqli("localhost", "root", "", "Data");
error_reporting(E_ALL ^ E_NOTICE);
session_start();
$Val = $_POST['ID'];
$Get = 'SELECT * FROM CMessages WHERE PID="'.$Val.'"';
$Username = $_SESSION['Username'];
$Admin = $_SESSION['Admin'];

    if($Result = $Connect->query($Get))
    {
    while($Row = $Result->fetch_assoc())
    {
        $User = $Row['Username'];
        $Msg = $Row['Msg'];
        $Date = $Row['Date'];
        $ID = $Row['ID'];

        if($User == $Username)
        {
            $MText['T'] = '<div id="Msg">' . $User . ' : ' . $Msg . ' - ' . $Date .' - <a class="TLink" href="MDelete.php?ID='.$ID.'">Delete</a></div>';
        }
        elseif(isset($Admin))
        {
            $MText['T'] = '<div id="Msg">' . $User . ' : ' . $Msg . ' - ' . $Date .' - <a class="TLink" href="MDelete.php?ID='.$ID.'">Delete</a></div>';
        }
        else
        {
            $MText['T'] = '<div id="Msg">' . $User . ' : ' . $Msg . ' - ' . $Date .'</div>';
        } 
    }
    }

   echo json_encode($MText);
   ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:17:43.563

It returns all rows but , in the while loop, you are always overwriting the `$MText` variable. Therefore only the last one will be displayed with `json_encode`.

Maybe you meant to write `$MText['T'][]` instead of `$MText['T']`.

# linux - 我怎么知道哪些包是用 apt-get 命名的？

> ID：14824369
> 
> 赞同：0
> 
> 时间：2013-02-12T02:09:22.960
> 
> 标签：linux, terminal, apt-get, linux-mint

Linux 菜鸟在这里。我想下载一个程序。可以说这次它是一个 ssh 服务器。

我怎么知道要输入什么`sudo apt-get ???? install`？

我试过了`ssh`，`sshserver`只是在我的头顶，但他们没有工作。

有没有搜索功能之类的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T02:11:25.423

`apt-cache search`是您可能会发现有用的东西。 `apt-cache search ssh server`应该向您展示相关的软件包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:15:04.063

`bash-completion`安装软件包后，您可以尝试执行以下操作：

`sudo apt-get install openss``tab`

你会找到 ：

> openssh-blacklist openssh-blacklist-extra openssh-client openssh 服务器 openssl openssl-blacklist openssl-blacklist-extra

# java - Java：CyclicBarrier 不起作用

> ID：14824370
> 
> 赞同：0
> 
> 时间：2013-02-12T02:09:27.677
> 
> 标签：java, multithreading, loops, cycle, barrier

软件应该做一些计算：总共 62500 个循环，一个循环持续时间是 0.5 秒。那将是大约 8 小时的工作（for in for in for）。我必须分成 100 个单独的线程，工作时间将减少到 8 分钟。我无法打开 62500 个线程，因为 CPU，我必须找到仅打开 100 个线程而不是再次打开 100 个线程的解决方案。我尝试使用 CountDownLatch 但我无法重置循环，所以我的解决方案是 CyclicBarrier。

```
private CycleBarrier cb;

// this Overrided run is called only once from the view to not block the UI.
@Override
public void run(){

   // count is the number of the actions that i want to do
   // this is why I'm using CycleBarrier
   for(int count = 0; count < 2; count++){
      System.out.println("MAIN THREAD: #"+count);

      int x1 = 0;
      cb = new CycleBarrier(100, new Runnable(){
         @Override
         public void run(){
            // HOW TO STOP CYCLE ???
         }
      });

      for(int i = 0; i < 100; i++){
         new Thread(new Test(x1, cb)).start();
         x1 += 25;
      }
   }
} 
```

和**测试**类

```
public class Test implements Runnable{

   int x1;
   CycleBarrier cb;

   public Test(int _x1, CycleBarrier _cb){
      x1 = _x1;
      cb = _cb;
   }

   @Override
   public void run(){
      // this for in for has 6250 loops
      for(int i = x1; < x1+25; i++){
         for(int j = 0; j < 250; j++){
            System.out.println("   |--> LOOK I'm WORKING: "+i+" "+j);
         }
      }

      // After the job is done, it should be put in to await
      cb.await();
   }
} 
```

循环不工作。一下子开200个。我尝试调试（eclipse）但我不知道为什么，线程从一个跳到另一个，我无法跟踪结果。

控制台应如下所示：

```
MAIN THREAD: #0
   LOOK I'm WORKING: 0 0
   LOOK I'm WORKING: 0 1
   ...
   LOOK I'm WORKING: 25 254
   LOOK I'm WORKING: 25 255

MAIN THREAD: #1
   LOOK I'm WORKING: 0 0
   LOOK I'm WORKING: 0 1
   ...
   LOOK I'm WORKING: 25 254
   LOOK I'm WORKING: 25 255 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:25:13.367

```
cb = new CycleBarrier(100, new Runnable(){
@Override
 public void run(){
        // HOW TO STOP CYCLE ???
     }
  });

  for(int i = 0; i < 100; i++){
     new Thread(new Test(x1, cb)).start();
     x1 += 25;
  } 
```

在您的代码中，您将在新的 Runnable 中打开一个新的线程对象。所以有两个线程。

# zend-framework - Zend Form 在控制器中更改元素类型

> ID：14824371
> 
> 赞同：1
> 
> 时间：2013-02-12T02:09:29.650
> 
> 标签：zend-framework, hidden

我有我的 Zend_Form，有时，其中一个字段应该被隐藏，并且用户看不到。当我在控制器中调用表单时，有没有办法可以将其中一个字段更改为隐藏？

谢谢库沙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T05:33:03.503

您可以使用以下方法*删除*元素：

```
$form->removeElement('my-element-name'); 
```

在控制器中。

您还可以创建两种形式，一种覆盖另一种，孩子在其中调用`$this->remove('my-element-name')`.

或者，您可以让表单构造函数接受一个布尔值`$flag`，以确定是否将字段添加到表单中。

所以，正如你所看到的，有很多不同的方式来构建它。

将该字段更改为“隐藏”类型（即`<input type="hidden">`）是另一回事，但我不确定这就是您的意思/需要/想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:13:25.113

我对此的最佳解决方案是在需要隐藏元素时向元素添加特定类。这可能不是完美的解决方案，但让我解释一下。

首先，在 Zend Form 中从一种元素类型切换到另一种元素类型非常困难。您的元素实际上是类。所以文本是 Zend_Form_Element_Text - 所以它不像改变 'type' 属性那么容易。

如果元素必须保留在表单上（因此，不要像上面的答案建议的那样将其删除），那么您唯一的其他选择就是使用 CSS 隐藏它。

需要隐藏时尝试以下代码：

```
$element = $form->getElement('MyElement');
$newClass = trim($element->getAttrib('class') . ' hidden');
$element->setAttrib('class', $newClass); 
```

然后，当然，为 .hidden 类创建 CSS。

希望这可以帮助！

# .net - 完全证明包装面板的内容？

> ID：14824373
> 
> 赞同：1
> 
> 时间：2013-02-12T02:09:45.313
> 
> 标签：.net, wpf, xaml, wrappanel

如果你把它放到 Kaxaml 中：

```
<WrapPanel Width="500"
           ScrollViewer.VerticalScrollBarVisibility="Visible">
  <Button Width="110"
          Height="100"></Button>
  <Button Width="130"
          Height="100"></Button>
  <Button Width="70"
          Height="100"></Button>
  <Button Width="50"
          Height="100"></Button>
  <Button Width="329"
          Height="100"></Button>
  <Button Width="126"
          Height="100"></Button>
  <Button Width="86"
          Height="100"></Button>
  <Button Width="48"
          Height="100"></Button>
  <Button Width="200"
          Height="100"></Button>
  <Button Width="190"
          Height="100"></Button>
</WrapPanel> 
```

您会看到一堆按钮与参差不齐的右侧对齐（但左侧对齐）。

**有没有办法让每个“行”的内容按比例扩展以填充该行？** （所以它的左右两边都会有直线？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:43:14.227

与它`WrapPanel`本身不同的是，你所看到的正是它的设计目的。您当然可以自己编写`Panel`来做到这一点，但我认为`TabPanel`（用于布置`TabControl`选项卡的默认设置）可以满足您的要求。

# symfony - Symfony 2.0：如何在没有实体的情况下验证嵌入的表单集合

> ID：14824374
> 
> 赞同：2
> 
> 时间：2013-02-12T02:09:44.863
> 
> 标签：symfony, symfony-forms

如何在 Symfony 2.0 中验证嵌入的表单集合（没有实体）？如果解决方案就在这条线上，那么目前升级到 2.1 并不是一个方便的选择。

我尝试使用`Valid`约束，但它导致所有验证失败。

```
public function getDefaultOptions(array $options)
{
    $collectionConstraint = new Collection(array (
        ...

        // I tried Valid constraint but this "removes" all validation
        'travel_links' => new Valid(),
    ));

    return array ('validation_constraint' => $collectionConstraint);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:43:53.990

在 Symfony 2.1 中，您可以使用**约束**选项：

```
$builder
->add('firstName', 'text', array(
   'constraints' => new Length(array('min' => 3)),
))
->add('lastName', 'text', array(
   'constraints' => array(
       new NotBlank(),
       new Length(array('min' => 3)),
),
)); 
```

显然，这在 Symfony 2.0 中不起作用**。**但是， Symfony 2.0 中提供了一个名为**validation_constraint**的有限约束选项。

```
$builder
->add('firstName', 'text', array(
   'validation_constraint' => new Length(array('min' => 3)),
)); 
```

如果您需要验证多个条件（例如 NotBlank、Lenght），您可以自己定义一个**[自定义约束](http://symfony.com/doc/current/cookbook/validation/custom_constraint.html)**来一次完成所有验证。:)

编辑：不要忘记包含`use Symfony\Component\Validator\Constraints\Length`或您正在使用的任何约束。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T10:31:15.683

在 Symfony2.x 的实际版本中，您可以将 cascade_validation 设置为 true（默认为 false） [http://symfony.com/doc/current/reference/forms/types/form.html](http://symfony.com/doc/current/reference/forms/types/form.html)

文档说：“将此选项设置为 true 以强制对嵌入的表单类型进行验证。例如，如果您有一个带有嵌入 CategoryType 的 ProductType，则在 ProductType 上将 cascade_validation 设置为 true 将导致 CategoryType 中的数据也被验证。

除了使用此选项，您还可以在模型中使用 Valid 约束来强制验证存储在属性上的子对象。”

# android - 如何修复 Android 上的图像下载/保存错误

> ID：14824382
> 
> 赞同：1
> 
> 时间：2013-02-12T02:11:24.300
> 
> 标签：android, url, bitmap, android-asynctask, inputstream

我正在编写一个 Android 应用程序，我从互联网上获取一些图像以显示在画廊中。图像在被设置为 FragmentStatePagerAdapter 的 ViewPager 中的片段获取之前首先保存到磁盘。

我遇到的问题是，在下载第三张图片后，之后的任何图片都会导致 NullPointerException，其中 URL 显然为空。这是我使用的 downloadBitmap() 方法：

```
 static Bitmap downloadBitmap(String url) {
    final AndroidHttpClient client = AndroidHttpClient
            .newInstance("Android");
    final HttpGet getRequest = new HttpGet(url);

    try {
        HttpResponse response = client.execute(getRequest);
        final int statusCode = response.getStatusLine().getStatusCode();
        if (statusCode != HttpStatus.SC_OK) {
            Log.w("ImageDownloader", "Error " + statusCode
                    + " while retrieving bitmap from " + url);
            return null;
        }

        final HttpEntity entity = response.getEntity();
        if (entity != null) {
            InputStream inputStream = null;
            try {
                inputStream = entity.getContent();
                final Bitmap bitmap = BitmapFactory
                        .decodeStream(inputStream);
                return bitmap;
            } finally {
                if (inputStream != null) {
                    inputStream.close();
                }
                entity.consumeContent();
            }
        }
    } catch (Exception e) {
        // Could provide a more explicit error message for IOException or
        // IllegalStateException
        getRequest.abort();
        Log.w("ImageDownloader", "Error while retrieving bitmap from "
                + url);
    } finally {
        if (client != null) {
            client.close();
        }
    }
    return null;
} 
```

同样，在下载第三个图像后，该方法开始吐出错误，指出“从检索位图时出错”，而没有附加到末尾的 URL，这意味着我正在将空字符串或空白字符串传递给该方法。但是，情况并非如此，因为在使用 Log.d("URL", saidURL) 运行方法之前记录我传递的 URL 字符串表明 URL 完全有效。downloadBitmap() 代码在以下 AsyncTask 中调用。

```
 class RetrieveImagesTask extends
        AsyncTask<ArrayList<Magazine>, String, ArrayList<Magazine>> {

    @Override
    protected ArrayList<Magazine> doInBackground(
            ArrayList<Magazine>... arg0) {

        Bitmap bitmap;
        for (Magazine mag : arg0[0]) {
            if (!new File(filesDir, mag.ID + ".jpg").exists())
                try {
                    FileOutputStream out = new FileOutputStream(filesDir + mag.ID
                            + ".jpg");
                    Log.d("URL", mag.imageURL);
                    bitmap = downloadBitmap(mag.imageURL);
                    bitmap.compress(Bitmap.CompressFormat.JPEG, 90, out);
                } catch (Exception e) {
                    e.printStackTrace();
                }
        }
        return arg0[0];
    } 
```

对这种奇怪的事态有什么帮助吗？可能是内存不足的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T06:32:38.140

```
static Bitmap downloadBitmap(String url) {
final AndroidHttpClient client = AndroidHttpClient
        .newInstance("Android");
final HttpGet getRequest = new HttpGet(url);

try {
    HttpResponse response = client.execute(getRequest);
    final int statusCode = response.getStatusLine().getStatusCode();
    if (statusCode != HttpStatus.SC_OK) {
        Log.w("ImageDownloader", "Error " + statusCode
                + " while retrieving bitmap from " + url);
        return null;
    }

    final HttpEntity entity = response.getEntity();
    if (entity != null) {
        InputStream inputStream = null;
        try {
            inputStream = entity.getContent();

            final Bitmap bitmap;

 int h = 100; // height in pixels
                int w = 100; // width in pixels
                if (bitmap != null) {
                    bitmap = Bitmap.createScaledBitmap(
                            BitmapFactory
                    .decodeStream(inputStream), h, w, true);

            return bitmap;
        } finally {
            if (inputStream != null) {
                inputStream.close();
            }
            entity.consumeContent();
        }
    }
} catch (Exception e) {
    // Could provide a more explicit error message for IOException or
    // IllegalStateException
    getRequest.abort();
    Log.w("ImageDownloader", "Error while retrieving bitmap from "
            + url);
} finally {
    if (client != null) {
        client.close();
    }
}
return null; 
```

}

# android - App Widget 更新难题：Binder Transaction、RemoteViews、setImageURI 和方向更改失败

> ID：14824393
> 
> 赞同：3
> 
> 时间：2013-02-12T02:12:29.043
> 
> 标签：android, orientation, screen-orientation, android-appwidget, remoteview

我在更新 AppWidgets 时遇到问题，并且 android 中的限制/错误的汇合正在阻止我找到解决方法。

我的应用小部件是可主题化的，因此我需要能够在运行时更新其上的图像视图（以及文本视图和意图）。我正在更新多达 9 个图像视图，但我使用的图形大小相当适中（最大 11kb png）。我通过 RemoteViews 对象推送的数据总大小应该在 100kb 以下，完全在 1mb 的限制之内。我认为屏幕上的实际可绘制资源最终会比原始 png 更大，但 10% 的限制似乎足以解释这一点。但是，对于某些手机和启动器，我收到“FAILED BINDER TRANSACTION”错误。

我为此找到了两种解决方案：

1）使用 setImageViewUri（调用 setImageURI）而不是 setImageViewResource 与 RemoteViews 对象，这摆脱了通过 RemoteViews 对象发送可绘制对象，而是从 URI 加载图像。解决内存错误（参见[https://groups.google.com/forum/#!topic/android-developers/KKEyW6XdDvg/discussion](https://groups.google.com/forum/#!topic/android-developers/KKEyW6XdDvg/discussion)）

2) 将应用小部件的更新分成多个 RemoteViews 调用。所以我更新了 3 个图像，调用 updateAppWidget，创建一个新的 RemoteViews 对象，更新接下来的 3 个图像，调用 updateAppWidget 等。

第一种方法的问题在于它仅适用于中等密度设备。由于 android 代码库中的错误，所有其他设备都无法正确缩放图像（请参阅错误报告：[http](http://code.google.com/p/android/issues/detail?id=22590) ://code.google.com/p/android/issues/detail?id=22590 ）

第二种方法的问题在于，当屏幕方向发生变化时，android 会使用它存储在某个秘密位置的最后一个 RemoteViews 调用来销毁并重新创建小部件视图。这意味着 appwidget 没有完全重绘，因为我拆分了 RemoteView 调用并且小部件最终无法使用。似乎没有可靠的方法来确定 android 何时销毁和重新创建应用程序小部件 - 服务中的 onConfigurationChanged 并不总是触发，也没有进行任何活动级别的调用（即我可以找到的 onUpdate、onReceive）。为了使小部件能够在方向更改时完全正确地重绘，我只能使用一个 RemoteViews (updateAppWidget) 调用，因此该解决方案将不起作用。

有谁知道如何解决这个问题？我想知道是否可以实现我自己的 RemoteViews，它调用了一个非错误的 setImageURI 函数（在自定义 ImageView 类中），以便正确进行缩放。似乎很多工作只是更新了一些小部件，我不确定 android 是否会让我以这种方式扩展 RemoteViews/ImageView。

当屏幕方向改变并强制它重绘整个小部件时，是否有拦截android？

希望听到任何其他建议或解决方法的想法！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:35:01.990

我在开发集合的 AppWidgets 时遇到了同样的问题。很多时候会发生以下情况：

*   旋转时，ListView 完全消失了；
*   按钮监听器（实际称为`PendingIntents`）停止响应；
*   图像中的变化`setImageViewResource`没有得到更新；

.. 等等。我得出了与您相同的结论：**android 使用它存储在某个秘密位置的最后一个 RemoteViews 调用销毁并重新创建小部件视图**。在承认这一点之后，这是一个*微调*调用时间的问题，`AppWidgetManager.getInstance(context).updateAppWidget()`因为我想在告诉 ListView 刷新自己之后禁用*clickListeners（或 PendingIntents）*（这是调用 Web 服务并检索非平凡的网络操作数据量）并希望在 ListView 完成加载后启用侦听器，同时保持 RemoteViews 完全加载以处理旋转。

我是如此接近放弃并用作替代方案..

> 当屏幕方向改变并强制它重绘整个小部件时，是否有拦截android？

..与 AppWidget 不同的是，它**确实拦截了 Android 旋转变化的服务。**如果您的选项用完了，我建议您尝试一下：

```
public class MyWidget extends AppWidgetProvider {
@Override
    public void onConfigurationChanged(Configuration newConfig)
    {
                // insert code here
    }
} 
```

[在 StackOverflow 中](https://stackoverflow.com/questions/3503114/after-orientation-change-buttons-on-a-widget-are-not-responding)了解有关该服务的更多信息。

# jquery - 选项卡不断返回到第一个选项卡 jquery

> ID：14824395
> 
> 赞同：1
> 
> 时间：2013-02-12T02:12:55.263
> 
> 标签：jquery, asp.net, cookies, tabs

我有两个标签，第一个只有 gridview，另一个标签有按钮。现在，每当我单击第二个选项卡上的按钮时，它必须根据其功能填充第二个选项卡上的 gridview，它确实已填充，但是页面返回到第一个选项卡，然后我必须单击下一个选项卡以查看填充的 gridview在第二个选项卡中。我听说要让它留在那个标签上，我必须使用 cookie。但我是 jquery 的新手，所以我真的不知道该怎么做。这是我的代码。

```
 $(function() {
var tabs = $( "#tabs" ).tabs();
 tabs.find( ".ui-tabs-nav" ).sortable({
 axis: "x",
 stop: function() {
 tabs.tabs( "refresh" );
             }
 });
  }); 
```

这是div：

```
<div id="tabs" class="tab"> 
          <ul> 
         <li><a href="#tabs-2" >Visitors For Today</a></li> 
         <li><a href="#tabs-1">Reports</a></li> 
          </ul>
    <div id = "tabs-1">
         //some codes
    </div>
    <div id = "tabs-2">
         //somecodes
    </div>

</div> 
```

对不起，我真的不擅长这个，但这对吗？

```
 $(function() {
    var tabs = $( "#tabs" ).tabs({
    cookie: {
               name: 'my-unique-cookie',
               expires: 1,
               path: '/'
                     }
            });
        tabs.find( ".ui-tabs-nav" ).sortable({
            axis: "x",
             stop: function() {
             tabs.tabs( "refresh" );
             }
          });
     }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:39:05.300

就像你说的，你可以使用jquery cookies（[http://www.electrictoolbox.com/jquery-cookies/](http://www.electrictoolbox.com/jquery-cookies/)）来保存当前标签的索引，然后当你重新加载页面时，将`active`选项设置`tabs()`为你的索引刚刚保存（[http://api.jqueryui.com/tabs/#option-active](http://api.jqueryui.com/tabs/#option-active)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:51:19.327

它真的应该像添加对[cookie 插件](https://github.com/carhartl/jquery-cookie)的引用一样简单（*下载它并将其添加到您的项目中，然后添加本地引用*），然后将您的`tabs()`调用修改为如下所示：

```
 $("#tabs").tabs({
        cookie: {
            name: 'my-unique-cookie',
            // store cookie for a day, without, it would be a session cookie
            expires: 1,
            path: '/'
        }
    }); 
```

您可能希望同时自定义`name`和`path`选项。选项参考位于[https://github.com/carhartl/jquery-cookie#cookie-options](https://github.com/carhartl/jquery-cookie#cookie-options) - 保留原样，cookie 将对整个站点有效并命名为`my-unique-cookie`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T02:21:37.103

利用浏览器历史记录和重新加载按钮

你可以使用 [http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

观看演示

[http://www.asual.com/jquery/address/samples/express/](http://www.asual.com/jquery/address/samples/express/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T03:33:41.827

抱歉更新晚了。我已经在不使用 cookie 的情况下解决了这个问题，因为它在 asp 中。事情是这样的：

```
$("#tabs").tabs({

activate: function() { 

var selectedTab = $("#tabs").tabs('option', 'active');

$("#<%= hdnSelectedTab.ClientID %>").val(selectedTab);

//alert(selectedTab);

},

active: $("#<%= hdnSelectedTab.ClientID %>").val()

}); 
```

然后在 asp 上：

`<asp:HiddenField ID="hdnSelectedTab" runat="server" Value="0" />`

希望这会有所帮助。感谢您的所有帮助。我无法使用 cookie，因为我发现很难理解对不起，我对 jquery 真的很陌生

注意：我使用的是 jquery-ui 1.9，代码会根据您的版本而有所变化

# ios - 应用程序在重新获得焦点时崩溃

> ID：14824403
> 
> 赞同：0
> 
> 时间：2013-02-12T02:13:48.180
> 
> 标签：ios, objective-c, ios6, ios-simulator

当我从主页按钮失去焦点后重新打开我的应用程序时，我遇到了一种奇怪的行为。在模拟器上，应用程序屏幕会黑屏 5 秒或更长时间，然后才能恢复应用程序。在测试设备上，应用程序要么进行长时间的延迟，要么完全退出并重置为启动状态。我已经将 NSLog 调试注释放在“applicationWillEnterForeground”和“applicationDidBecomeActive”中，但这些仅在长时间延迟后才会出现，所以我现在假设这些函数中的任何内容都不会导致这种延迟。

我在我的程序中使用了以下组件： * 一个标签栏控制器 * 2 个计时器，地图工具包 * IP 套接字流 * 24 个视图控制器在情节提要上串在一起。* 不少背景图片和图片按钮

如果我知道程序的哪些部分导致了这个错误，我会很乐意发布代码，但事实上我一无所知。有没有其他人遇到过这种类型的错误？我列出的任何组件是否有导致类似错误的历史？

发现此错误时，我的开发还很遥远，并且在增量开发过程中我没有测试通过主页按钮失去焦点。其他较小的项目（使用套接字和计时器）在相同的测试硬件上没有遇到相同的错误。

我正在使用“applicationWillResignActive”来禁用计时器，并关闭流。我正在使用“applicationDidBecomeActive”重新启动计时器，并重新打开流。延迟发生在“applicationWillEnterForeground”和“applicationDidBecomeActive”运行之前。此外，我尝试禁用启动流和计时器的代码，但这对错误没有任何影响。

我正在使用 xCode4.4.1、ios6，并且专门为 iPad 构建。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:24:24.613

It's possible that the debugger is playing tricks with your mind regarding when it shows that you hit a breakpoint and the code execution of applicationWillEnterForeground. I suggest you commit your most recent code to source control and start deleting sections one at a time till you see the behavior go away.

# javascript - 使用带有主干的 fetch 更新集合

> ID：14824405
> 
> 赞同：7
> 
> 时间：2013-02-12T02:13:53.680
> 
> 标签：javascript, backbone.js

根据官方文档，当我做这样的事情时：

```
collection.fetch({update: true, remove: false}) 
```

我为每个新模型获得一个“添加”事件，为每个更改的现有模型获得一个“更改”事件，而不删除任何内容。

为什么如果我调用一个静态数据源（集合的 url 总是返回相同的 json），那么每个接收到的项目都会调用一个 add 事件？

这里有一些代码（我没有渲染任何东西，我只是在调试）：

```
<!doctype html>
<html>
  <head>
    <title>Example</title>
  </head>
  <body>
    <a href="#refresh">Refresh</a>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/underscore-min.js"></script>
    <script src="js/backbone-min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html> 
```

继承人的JS

```
(function($){
    //Twitter Model
    ModelsTwitt = Backbone.Model.extend({});
    //Twitter Collection
    CollectionsTwitts = Backbone.Collection.extend({
        model:ModelsTwitt,
        initialize:function(){
            console.log('Twitter App Started');
        },
        url:'data/195.json'
    });
    //Twitts View
    ViewsTwitts = Backbone.View.extend({
        el:$('#twitter-list'),
        initialize:function(){
            _.bindAll(this, 'render');
            this.collection.bind('reset',this.render);
            this.collection.bind('add',this.add);
        },
        render:function(){
            console.log("This is the collection",this.collection);
        },
        add:function(model){
            console.log("add event called",model);  
        }
    });
    //Twitter Router
    Router = Backbone.Router.extend({
        routes:{
            '':'defaultRoute',//Default list twitts route
            'refresh':'refreshView'
        },
        defaultRoute:function(){
            this.twitts = new CollectionsTwitts();
            new ViewsTwitts({collection:this.twitts});
            this.twitts.fetch();
        },
        refreshView:function(){
            this.twitts.fetch({update:true,remove:false});
        }
    });
    var appRouter = new Router();
    Backbone.history.start();
})(jQuery); 
```

基本上，我使用默认路由获取集合，它与所有模型和属性一起正确获取。

当我点击刷新链接时，我会调用 refreshView，它基本上会尝试使用新模型更新集合。我不明白的是，为什么如果响应相同，集合的所有模型都被检测为新模型，从而触发*add*？

[这是一个功能链接：](https://googledrive.com/host/0B2e89I7TTTCjdnhwaEZtdkpzZnc/index.html)打开控制台，即使集合相同，您也会看到当您单击刷新时如何调用添加事件。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T02:29:51.617

我的猜测是您的模型没有`idAttribute` [(doc)](http://backbonejs.org/#Model-idAttribute)。Backbone 查找的默认键是`id`，并且您的 JSON 条目没有，因此它无法判断哪些模型已经存在。

尝试将您的模型更改为此（或另一个键，如果这不是唯一的）：

```
ModelsTwitt = Backbone.Model.extend({
  idAttribute: 'id_event'
}); 
```

# kendo-ui - kendo 内联编辑启用和禁用字段

> ID：14824415
> 
> 赞同：2
> 
> 时间：2013-02-12T02:15:15.073
> 
> 标签：kendo-ui

我如何在添加模式下启用某些字段并在编辑模式下禁用。我添加了以下代码，但我无法在添加模式下启用描述字段。请告知我如何实现这一目标？谢谢

```
model.fields(p=> p.Description).Editable(false); 
```

我想在添加模式下启用描述并在编辑模式下禁用。以下代码不起作用。请告知代码是否有任何问题以及是否有其他方法。谢谢你

```
function onEdit(e) {
    var indexCell = e.container.context.cellIndex;
    var grid = $('#BTSession').data('kendoGrid');

    if (!e.model.isNew()) { // when Editing
        if (indexCell != 'undefined' && grid.columns[indexCell].Title == "Description") {
                $('#BTSession').data("kendoGrid").closeCell();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T07:11:39.537

有两个问题：

1.  `title`是小写的。检查应该是：`grid.columns[indexCell].title`
2.  `isNew()`总是`false`。或者，您可以在添加新记录时检查是否`id`存在。`undefined`

就像是：

```
function onEdit(e) {
    var indexCell = e.container.context.cellIndex;
    var grid = $('#BTSession').data('kendoGrid');

    if (e.model.id) { // when Editing the id is defined
        if (indexCell != 'undefined' && grid.columns[indexCell].title == "Description") {
            grid.closeCell();
        }
    }
} 
```

**注意**：如果在您的模型`id`中未调用该列`id`（可以说`myId`），请使用正确的名称。

**编辑：**[在此处](http://jsfiddle.net/OnaBai/ehnSq/)查看运行示例

# php - PHP：通过路径/域的 cookie

> ID：14824416
> 
> 赞同：-1
> 
> 时间：2013-02-12T02:15:19.663
> 
> 标签：php, cookies, setcookie

是否可以在脚本开始时设置一次路径和域并让所有未来的集合都符合相同？

从文档：

```
 bool setcookie ( string $name [, string $value [, int $expire = 0 [, string $path [, string $domain [, bool $secure = false [, bool $httponly = false ]]]]]] ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:19:56.327

当然：

```
function own_setcookie($name, $value, $expire=0) {
    setcookie($name, $value , $expire, 'myPath', 'myDomain');
} 
```

然后使用：

```
own_setcookie('myName', 'myValue'); 
```

# cuda - 解决方法 cutil.h

> ID：14824420
> 
> 赞同：0
> 
> 时间：2013-02-12T02:16:40.133
> 
> 标签：cuda, installation

我正在尝试使用使用 CUDA 2.2 配置的名为 GPU-HMMER 的软件包。但是，它会引发以下错误：

```
cuda_kernel.cu:1:19: fatal error: cutil.h: No such file or directory 
```

我意识到 CUDA 5.0 没有这个文件，我不确定如何使用 CUDA 5.0 正确安装这个软件

以下链接发布了类似的问题：

[CUDA5 示例：有人将一些 cutil 定义翻译成 CUDA5 吗？](https://stackoverflow.com/questions/12474191/cuda5-examples-has-anyone-translated-some-cutil-definitions-to-cuda5)

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:22:06.200

我在尝试编译 CUDA 样本时遇到了同样的问题。我刚刚对 cutil.h 做了一个快速的谷歌搜索，发现一个旧版本托管在 assembla 上。

[Cutil.h 在 Assembla 上。](https://www.assembla.com/code/cuda/subversion/nodes/NVIDIA%20GPU%20Computing%20SDK/C/common/inc/cutil.h?rev=5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:49:51.033

我刚刚发现 Assembla 链接已损坏。cutil.h 的另一个副本可以在以下链接中找到

www2.icmc.usp.br/~castelo/CUDA/.../inc/cutil.h

# java - Android：如何通过编码在 Strings.xml 中存储变量的值

> ID：14824424
> 
> 赞同：3
> 
> 时间：2013-02-12T02:18:05.853
> 
> 标签：java, android, xml

要求：我需要将用户 ID 和密码的值作为字符串值存储在 String.xml 中，这些值确实由用户获取。

问题：据我所知，解决方案是使用共享首选项。虽然我使用 Shared Preferences ，但值不会存储在 String.xml

这是我的 Strings.xml

```
<?xml version="1.0" encoding="utf-8"?>
 <resources>

<string name="app_name">Sp</string>
<string name="hello_world">Hello world!</string>
<string name="menu_settings">Settings</string>
<string name="id" ></string>  <!-- fill in this value from java code, how ? -->
<string name="pwd"></string>  <!-- fill in this value from java code, how ? -->

 </resources> 
```

布局页面：activity_main.xml

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:tools="http://schemas.android.com/tools"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 tools:context=".MainActivity" >

 <EditText
     android:id="@+id/text"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:layout_alignParentTop="true"
     android:layout_centerHorizontal="true"
     android:layout_marginTop="178dp"
     android:ems="10"
     android:text="id" >

     <requestFocus />
 </EditText>

 <Button
     android:id="@+id/button"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:layout_below="@+id/editText1"
     android:layout_centerHorizontal="true"
     android:layout_marginTop="44dp"
     android:text="Send" />

 <TextView
     android:id="@+id/textView1"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:layout_alignBottom="@+id/text"
     android:layout_alignParentLeft="true"
     android:layout_marginBottom="40dp"
     android:layout_marginLeft="22dp"
     android:text="id" />

 </RelativeLayout> 
```

EdText.java

```
import android.app.Activity;

import android.content.SharedPreferences;

import android.content.SharedPreferences.Editor;

import android.os.Bundle;

import android.util.Log;

import android.view.View;

import android.widget.Button;

import android.widget.EditText;

public class EdText extends Activity {

    @Override

    public void onCreate(Bundle savedInstanceState)

    {

       super.onCreate(savedInstanceState);

       setContentView(R.layout.activity_main);

    final EditText et=(EditText)findViewById(R.id.text);

    Button but = (Button) findViewById(R.id.Button);
    but.setOnClickListener(new View.OnClickListener(){

        public void onClick(View arg0) 
        {
            String s1 = ((EditText)findViewById(R.id.text)).getText().toString().trim();

          //Saving your strings
    SharedPreferences prefs = getSharedPreferences("myPrefsKey", Context.MODE_PRIVATE);
    Editor editor = PreferenceManager.getDefaultSharedPreferences(Context).edit();
        editor.putString("s1", s1.getText().toString());
    editor.commit();     

    //retrieving your strings from preferences
    SharedPreferences prefs2 = getSharedPreferences("myPrefsKey",Context.MODE_PRIVATE);
    String s12 = prefs.getString("s12", ""); //empty string is the default value

     }

    });
} } 
```

感谢您的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:20:14.130

我不知道你从哪里得到这个想法，但它是静态的，因此无法在运行时更改。

但是，您可以在这里解决

首先创建一个类并为其添加一个公共静态字符串

例如

```
public class StringGen {

public static String username
    public static String password
} 
```

设置您的数据或登录

```
StringGen.username = *yourString* 
```

只需在您的应用程序上调用它（活动等）

```
String myUsername = StringGen.username 
```

干杯

# java - 如何在没有构造函数参数的情况下添加类的实例？

> ID：14824425
> 
> 赞同：0
> 
> 时间：2013-02-12T02:18:34.113
> 
> 标签：java, constructor, instance-variables

我正在尝试创建一个梦幻足球选秀计划。我遇到困难的第一步是正确地将数据读入列表。我想逐行扫描数据。我创建了一个循环来设置每个角色名称，然后继续添加所有具有该角色的人，直到“-----”出现在一行上。然后将该角色添加到角色列表中。我相信我的循环是正确的，但是，我不知道如何正确使用我的 Person 构造函数，以便它包含我无法使用 Person 类中的 setData 方法实现的等级、名称和来源。我仍然是编程的初学者，我想知道我是否遗漏了什么。

# 数据文件

领导者

1 超人 DC

2 美国队长漫威

3 教授 X 漫威

4 铲子神秘人

膂力

1 绿巨人奇迹

2 金刚狼奇迹

3 奇迹之物

4 野兽奇迹

5 雷神漫威

6 愤怒的神秘人先生

7 不可思议的皮克斯先生

...等等

# 主班

```
import java.util.HashMap;
import java.util.List;
import java.util.Scanner; 
import java.io.*; 
import java.util.ArrayList;

public class FantasyTeamDraft {

/**
 * Joseph Simmons
 * CPS 181
 * February 6, 2013
 */
public static void main(String[] args) throws IOException{
    Scanner scan = new Scanner (System.in);

    System.out.println("Enter the name and location of the file wanted for the draft: "); 
    File draftData = new File (scan.next());
    Scanner scanData = new Scanner(draftData); 

    List <Role> listOfRoles = new ArrayList <Role> (); 
    while (scanData.hasNext()) {
        String line = scanData.nextLine(); 
        if (!isInteger (line)) {
            Role role = new Role (); 
            role.setRoleName(line); 
            String personLine = scanData.nextLine(); 
            while (isInteger(personLine)){
                Person person = new Person(); 
                person.setData(personLine);
                role.addPerson(person); 
            }
            listOfRoles.add(role); 
    } 
        }

}

public static boolean isInteger (String line) {
    try {
        Integer.parseInt(line.split("\t") [0]); 
    } catch (NumberFormatException e) {
        return false; 
    }
    return true; 
} 
```

}

# 人物类

```
import java.util.Scanner;

public class Person {

private int rank; 
private String name; 
private String origin;

public Person () {

}
public Person (int rank, String name, String origin) {
    this.rank = rank; 
    this.name = name; 
    this.origin = origin; 
}

public void setData (String line) {
    String [] array = line.split("\t"); 
    this.rank = Integer.parseInt(array [0]); 
    this.name = array [1]; 
    this.origin = array [2]; 
} 
```

}

# 角色类

```
 import java.util.List;
import java.util.Scanner;

public class Role {

private String roleName = ""; 
private List <Person> listOfPeople;

public Role (String roleName) {
    this.roleName = roleName;  
}

public void setRoleName (String line) {
    this.roleName = line; 
}

public String getRoleName() {
    return roleName; 
}

public void addPerson (Person person) {
    this.listOfPeople.add(person);  
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:35:01.193

在你的代码中我看到

```
 while (isInteger(personLine)){
            Person person = new Person(); 
            person.setData(personLine);
            role.addPerson(person); 
        } 
```

`isInteger(personLine)`如果计算结果为真，这将是无限循环。也许应该是 if 而不是 while，或者您需要`personLine`在每次迭代中进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:52:46.093

你有两个构造函数

> 公众人物 () {

```
public Person (int rank, String name, String origin) {
this.rank = rank; 
this.name = name; 
this.origin = origin; 
} 
```

如果我正确理解您的问题，为了设置等级、名称和来源的值，您需要调用第二个构造函数。但是在你的循环中

```
while (isInteger(personLine)){
            Person person = new Person(); 
            person.setData(personLine);
            role.addPerson(person); 
        } 
```

您在`new Person()`此处调用，尝试更改它以调用另一个构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T04:58:51.520

创建一个接受字符串的构造函数，就像 setData 一样，然后在该构造函数中调用您的 setData 方法，将字符串发送给它。这样您就可以保留 setData，而您的构造函数基本上是 setData()。

如果您想绝对保持构造函数的原样，则必须在 main 中拆分字符串

# php - php sql查询函数语法不起作用

> ID：14824429
> 
> 赞同：-2
> 
> 时间：2013-02-12T02:19:24.280
> 
> 标签：php, sql, function

我正试图让我的功能正常工作，过了一会儿我猛击键盘，然后一切正常，我注意到：

{

```
function get_people_fullname($db, $people_id) {

$query = 'SELECT 
            people_fullname
        FROM 
            people
        WHERE
            people_id = '.$people_id;

$result = mysql_query($query, $db) or die(mysql_error($db));
$row = mysql_fetch_assoc($result);
return $row['people_fullname'];} 
```

}

查询去哪里

```
people_id = '.$people_id; 
```

哪个有效

```
I originally had 

people_id = $people_id'; 
```

这是行不通的

我只是迷路了，我认为这是一个更有经验的人可以向我解释的简单事情？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:21:02.770

您需要使用双引号来获取变量的值，

```
$query = "SELECT 
            people_fullname
        FROM 
            people
        WHERE
            people_id = $people_id"; 
```

在 php 中，比方说`$a = 5`，

```
echo 'a is $a'; // will result:        a is $s
echo "a is $a"; // will result:        a is 5 
```

作为旁注，[`SQL Injection`](http://bobby-tables.com/)如果变量的值（*s*）来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用`PreparedStatements`，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:21:17.930

单引号没有变量替换 - 如果你想用一个值替换 $var ，双引号就是你想要的

# git - Git 合并，不包括从一个分支到另一个分支的提交

> ID：14824431
> 
> 赞同：16
> 
> 时间：2013-02-12T02:20:04.520
> 
> 标签：git

在开发过程中，我经常需要提交和推送“中间”提交，即提交代码不可编译或正在更改某些内容等。我不想进行此类提交，但这对于轻松继续我的工作是必需的从办公室到家，有时让其他开发人员让他们成为他们可以开始工作的基础。

我以为我已经找到了解决该问题的方法：

1.  我创建了一个单独的“开发”分支并进行所有中间提交。

2.  一旦代码处于良好状态，请合并到 master。所以主人不会包含“中间”提交，而只有“正常”提交。

3.  删除带有所有中间提交的“dev”分支。

但这不起作用。当我进行合并时，不仅合并提交包含在 master 中，而且还包含来自“dev”分支的所有“中间”提交。所以删除“dev”分支什么都没有，它的“中间”提交保留在那里。

所以问题是：是否有可能以 master 仅包含其自己的提交 + 合并提交而不包括来自第二个分支的提交的方式进行合并？如果不可能，您能否建议我如何实现我的目标 - 能够临时保存中间结果，但以后也可以无缝删除它们？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-12T02:28:41.510

当您将“dev”分支合并到 master 时，请尝试

```
git checkout master
git merge --squash dev
git commit -m "Add new feature." 
```

该`--squash`选项会将您所有的中间更改压缩为一个大更改。

`git rebase --interactive`如果您需要更多的有限控制（例如，[重新排序提交](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Reordering-Commits)和执行多个小压缩） ，您也可以使用。[这个答案](https://stackoverflow.com/a/2427520/250168)`git merge --squash`解释了和之间的区别`git rebase --interactive`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T02:28:06.880

你想要的是一个“壁球”合并：

```
git checkout master
git merge --squash dev
git commit -m 'current stable work from dev branch' 
```

这样做是在您的工作树中创建与常规合并相同的状态，但不会创建将所有中间提交作为祖先的合并提交。中间提交不会成为`master`分支历史的一部分。手册页中此选项的文档`git merge`说：

> 生成工作树和索引状态，就好像发生了真正的合并（合并信息除外），但实际上不进行提交或移动`HEAD`, 也不记录`$GIT_DIR/MERGE_HEAD`以使下一个 git commit 命令创建合并提交。这允许您在当前分支之上创建一个提交，其效果与合并另一个分支相同（或者在章鱼的情况下更多）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T03:47:23.330

添加另一个名为 RC（候选发布）的分支。此分支将仅合并已完成的功能分支。你可以让 dev 一起尝试未完成的分支。您只集成到主版本候选者，其中只包含合并的已完成功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-24T00:38:50.273

您可以使用`.patch`来自 GitHub 的，例如[https://github.com/rails/rails/pull/123.patch](https://github.com/rails/rails/pull/123.patch)

```
git apply 123.patch
# review changes, edit files etc.
git add .
git commit -m "committing #123" 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-12T02:28:03.993

您不能在合并期间删除提交。您可以压缩中间提交，但这是一个坏主意，在您发布它们时可能对您不起作用。您也可以在不进行合并（`git merge --squash`后跟`git commit`）的情况下将它们压缩到 master 分支，然后将 master 分支合并到 dev 分支中。

# android - OverlayItem Drawable 在被点击后移动

> ID：14824433
> 
> 赞同：2
> 
> 时间：2013-02-12T02:20:09.220
> 
> 标签：android, google-maps, drawable, overlayitem

我有一个应用程序，它显示用户可以放置和添加详细信息的图标。最近我注意到，当用户单击其中一个图标时，它会略微向下移动。欢迎任何建议！

**前** ![点击前](../Images/9cc2d35e7ab5ad0c5b9f517439d629fe.png)

**后** ![点击后](../Images/c166831f6d5b45270efbb73939b17ce1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T19:29:36.530

问题是在 myItemizedOverlay 中，我有一个 onTap 方法，它显示有关该点的信息，包括它的图标。

打开对话框时，我使用了对放置在地图上的图标的引用。

解决方案是创建一个全新的图标（可绘制）并使用它而不是参考。

# java - 小于 1 和大于 0 的值的百分比计算

> ID：14824438
> 
> 赞同：3
> 
> 时间：2013-02-12T02:21:16.597
> 
> 标签：java

我正在尝试使用 BigDecimal 显示百分比。

例如，如果我必须做

```
 double val = (9522 / total ) * 100;

    System.out.println("Val is :" + val); 
```

其中总计为 1200000。

我想将计算显示为百分比，但由于计算的值小于 0 ，我无法显示百分比

我也试过

```
 BigDecimal decimal = new BigDecimal((9522 * 100 ) / total);
    BigDecimal roundValue = decimal.setScale(2, BigDecimal.ROUND_HALF_UP);
    System.out.println("decimal: " + decimal);
    System.out.println("roundValue: " + roundValue); 
```

但结果相同。

即使是小数，我如何显示百分比？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T02:22:56.650

问题是你正在做整数除法。

如果你想要分数结果，你需要做浮点除法。

```
double val = (9522 / (double) total) * 100; 
```

将您的操作数之一转换为双精度数将导致 Java 执行正确类型的除法，而不是默认为整数除法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T02:22:31.800

您必须通知 Java 您希望至少将分子或分母中的一个视为双精度数，以确保结果是双精度数。

这将起作用：

```
double val = ((double)9522 / total ) * 100;

System.out.println("Val is :" + val); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T02:25:30.160

> BigDecimal decimal = new BigDecimal((9522 * 100 ) / total);

这*不是*您对 进行操作的方式`BigDecimal`：在`BigDecimal`构造时，精度已经消失，因为计算`(9522 * 100 ) / total`是在编译时完成的。这就是结果与整数相同的原因：实际上，整个计算都是以整数完成的。

以下是使用`BigDecimal`对象计算的方法：

```
BigDecimal decimal = new BigDecimal(9522)
    .multiply(new BigDecimal(100))
    .divide(new BigDecimal(total)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T02:22:38.587

如果你将两个整数相除，你会得到截断的结果。添加 a`.0`使其转换为浮点数，然后您将不会得到截断的结果

```
new BigDecimal((9522.0 / total) *100); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T02:25:07.190

您可能缺少演员表。

```
double val = (9522 / (double)total ) * 100;

System.out.println("Val is :" + val); 
```

我怀疑 total 是一个 int，因此 9522/1200000 结果是一个整数，它被截断为 0，因为该操作意味着结果必须小于 1。如果将 total 转换为 double，则结果将是双倍，你将能够保留小数。

# php - “echo”和“printf”返回的埃塞俄比亚字体不可见

> ID：14824442
> 
> 赞同：2
> 
> 时间：2013-02-12T02:21:57.347
> 
> 标签：php, html, css, fonts

编辑：当我使用类似的东西时

```
 echo 'coming up is ethiopic font: እናመሰግናለን'; 
```

它工作正常，但是当函数返回一些埃塞俄比亚字符串时，如下所示，返回的字符串不可见。

```
 echo 'coming up is ethiopic font:'.my_string(); 
```

当 my_string() 返回一些埃塞俄比亚字体时，该部分将不可见。

PHP是否有任何全局设置？或者我能做什么？

正如您在[此处](http://ethiopianlanguages.com/ethiopian-calendar/)页面的页脚看到的那样，字体是部分可见的（至少如果您的电脑上有字体，它是可见的）。

问题出现在我的主机服务器上，但在我的本地服务器上没有问题

编辑：我的问题似乎与 php 函数不同。我尝试将代码从侧栏重新定位到标题部分，并且相同的代码在标题部分中可以正常工作，但在侧栏中却不行。因此，我怀疑其他事情。我在问题中添加了 CSS 和 HTML 标签。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:33:09.900

编码可能有问题。我曾经在使用印地语和孟加拉语字体时遇到过类似的问题。通过玩`some javascript font library`and解决了这个问题`string utf8_encode ( string $data )`。后来我们通过嵌入 css3 web-fonts 将其替换为替代解决方案。CSS3 允许使用网络字体，这是解决此类问题的好方法。

# sql - Rails 原始 SQL 示例

> ID：14824453
> 
> 赞同：293
> 
> 时间：2013-02-12T02:22:51.383
> 
> 标签：sql, ruby-on-rails

如何将此代码转换为原始 sql 并在 rails 中使用？因为当我在heroku中部署这段代码时，会出现请求超时错误。我认为如果我使用原始sql会更快。

```
@payments = PaymentDetail.joins(:project).order('payment_details.created_at desc')
@payment_errors = PaymentError.joins(:project).order('payment_errors.created_at desc')

@all_payments = (@payments + @payment_errors) 
```

* * *

## 回答 #1

> 赞同：519
> 
> 时间：2013-02-12T19:48:23.317

你可以这样做：

```
sql = "Select * from ... your sql query here"
records_array = ActiveRecord::Base.connection.execute(sql) 
```

`records_array`然后将是您可以迭代的数组中的 sql 查询的结果。

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2015-01-16T18:33:51.447

我知道这是旧的......但我今天遇到了同样的问题并找到了解决方案：

```
Model.find_by_sql 
```

如果要实例化结果：

```
Client.find_by_sql("
  SELECT * FROM clients
  INNER JOIN orders ON clients.id = orders.client_id
  ORDER BY clients.created_at desc
")
# => [<Client id: 1, first_name: "Lucas" >, <Client id: 2, first_name: "Jan">...] 
```

* * *

```
Model.connection.select_all('sql').to_hash 
```

如果您只想要一个值的哈希值：

```
Client.connection.select_all("SELECT first_name, created_at FROM clients
   WHERE id = '1'").to_hash
# => [
  {"first_name"=>"Rafael", "created_at"=>"2012-11-10 23:23:45.281189"},
  {"first_name"=>"Eileen", "created_at"=>"2013-12-09 11:22:35.221282"}
] 
```

结果对象：

`select_all`返回一个`result`对象。你可以用它做一些神奇的事情。

```
result = Post.connection.select_all('SELECT id, title, body FROM posts')
# Get the column names of the result:
result.columns
# => ["id", "title", "body"]

# Get the record values of the result:
result.rows
# => [[1, "title_1", "body_1"],
      [2, "title_2", "body_2"],
      ...
     ]

# Get an array of hashes representing the result (column => value):
result.to_hash
# => [{"id" => 1, "title" => "title_1", "body" => "body_1"},
      {"id" => 2, "title" => "title_2", "body" => "body_2"},
      ...
     ]

# ActiveRecord::Result also includes Enumerable.
result.each do |row|
  puts row['title'] + " " + row['body']
end 
```

资料来源：

1.  [ActiveRecord - 通过 SQL 查找](http://guides.rubyonrails.org/active_record_querying.html#finding-by-sql)。
2.  [Ruby on Rails - Active Record 结果](http://api.rubyonrails.org/classes/ActiveRecord/Result.html) 。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2016-09-20T14:13:47.007

您可以使用`ActiveRecord`. 我会建议使用 SQL 块

```
query = <<-SQL 
  SELECT * 
  FROM payment_details
  INNER JOIN projects 
          ON projects.id = payment_details.project_id
  ORDER BY payment_details.created_at DESC
SQL

result = ActiveRecord::Base.connection.execute(query) 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-02-12T18:39:33.180

您可以执行直接 SQL 以对两个表进行单个查询。我将提供一个经过清理的查询示例，以希望防止人们将变量直接放入字符串本身（SQL 注入危险），即使此示例未指定对它的需求：

```
@results = []
ActiveRecord::Base.connection.select_all(
  ActiveRecord::Base.send(:sanitize_sql_array, 
   ["... your SQL query goes here and ?, ?, ? are replaced...;", a, b, c])
).each do |record|
  # instead of an array of hashes, you could put in a custom object with attributes
  @results << {col_a_name: record["col_a_name"], col_b_name: record["col_b_name"], ...}
end 
```

*编辑*：正如 Huy 所说，一个简单的方法是`ActiveRecord::Base.connection.execute("...")`. 另一种方式是`ActiveRecord::Base.connection.exec_query('...').rows`。并且您可以使用本机准备语句，例如，如果使用 postgres，准备语句可以使用 raw_connection、prepare 和 exec_prepared 完成，如[https://stackoverflow.com/a/13806512/178651中所述](https://stackoverflow.com/a/13806512/178651)

您还可以将原始 SQL 片段放入 ActiveRecord 关系查询中：http: [//guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html) 以及关联、范围等。您可以使用 ActiveRecord 关系查询构造相同的 SQL，并且可以用正如 Ernie 在[http://erniemiller.org/2010/03/28/advanced-activerecord-3-queries-with-arel/](http://erniemiller.org/2010/03/28/advanced-activerecord-3-queries-with-arel/)中提到的 ARel 。而且，当然还有其他 ORM、gem 等。

如果这将被大量使用并且添加索引不会导致其他性能/资源问题，请考虑在数据库中为 payment_details.created_at 和 payment_errors.created_at 添加一个索引。

如果需要一次显示大量记录而不是所有记录，请考虑使用分页：

*   [https://www.ruby-toolbox.com/categories/pagination](https://www.ruby-toolbox.com/categories/pagination)
*   [https://github.com/mislav/will_paginate](https://github.com/mislav/will_paginate)

如果您需要分页，请考虑首先在数据库中创建一个名为 payment_records 的视图，该视图结合了 payment_details 和 payment_errors 表，然后为该视图创建一个模型（它将是只读的）。一些 DB 支持物化视图，这可能是提高性能的好主意。

还要考虑 Rails 服务器和 DB 服务器上的硬件或 VM 规格、配置、磁盘空间、网络速度/延迟/等、接近度等。如果没有，请考虑将 DB 放在与 Rails 应用程序不同的服务器/VM 上，等等.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-03-08T14:02:37.160

我想使用`exec_query`该类`ActiveRecord`，因为它返回查询转换为对象的映射，因此当主题是原始 SQL 时，使用对象进行迭代变得非常实用和高效。

例子：

```
values = ActiveRecord::Base.connection.exec_query("select * from clients")
p values 
```

并返回这个完整的查询：

```
[{"id": 1, "name": "user 1"}, {"id": 2, "name": "user 2"}, {"id": 3, "name": "user 3"}] 
```

仅获取值列表

```
p values.rows

[[1, "user 1"], [2, "user 2"], [3, "user 3"]] 
```

仅获取字段列

```
p values.columns

["id", "name"] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-02T09:30:46.683

您还可以将原始 SQL 与 ActiveRecord 条件混合使用，例如，如果您想在条件中调用函数：

```
my_instances = MyModel.where.not(attribute_a: nil) \
  .where('crc32(attribute_b) = ?', slot) \
  .select(:id) 
```

# ruby-on-rails - 你能在 Heroku 上将 Rails 应用程序转换为 Sinatra

> ID：14824455
> 
> 赞同：0
> 
> 时间：2013-02-12T02:22:58.047
> 
> 标签：ruby-on-rails, heroku, sinatra

有谁知道使用 Heroku 将 Rails 应用程序转换为 Sinatra 是否有任何问题？我已经运行了一个 Heroku 应用程序，它目前是一个简单的 Rails 应用程序，基本上是几个视图和一个没有数据库交互的控制器。如果我只是将所有内容从 Rails 更改为 Sinatra，是否有任何潜在问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T02:29:36.457

除了您需要的手动工作之外，应该没有任何问题。您需要确保并更新您的`Procfile`以正确运行您的 Sinatra 应用程序。有关在 Heroku 的开发[中心部署基于机架的应用程序](https://devcenter.heroku.com/articles/rack)的信息，请参见此处。我还建议使用 Foreman 进行本地开发，它应该有助于更轻松地发现在 Heroku 上运行的任何可能的问题：[https ://devcenter.heroku.com/articles/procfile#developing-locally-with-foreman](https://devcenter.heroku.com/articles/procfile#developing-locally-with-foreman)

# python - 使用 matplotlib 中的 dataframe.plot() 函数编辑条的宽度

> ID：14824456
> 
> 赞同：46
> 
> 时间：2013-02-12T02:23:01.880
> 
> 标签：python, matplotlib, pandas, histogram, bar-chart

我正在使用以下方法制作堆积条形图：

```
DataFrame.plot(kind='bar',stacked=True) 
```

我想控制条形的宽度，使条形像直方图一样相互连接。

*我查看了文档但无济于事 - 有什么建议吗？有可能这样做吗？*

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2014-12-05T17:46:24.480

对于遇到这个问题的任何人：

从 pandas 0.14 开始，用条形图有一个“宽度”命令： [https ://github.com/pydata/pandas/pull/6644](https://github.com/pydata/pandas/pull/6644)

上面的例子现在可以简单地通过使用来解决

```
df.plot(kind='bar', stacked=True, width=1) 
```

见[`pandas.DataFrame.plot.bar`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.bar.html)或。[`pandas.DataFrame.plot`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html)_`kind='bar'`

更改条形的宽度时，也可以通过指定`figsize=`参数来更改图形大小。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-12T23:14:31.553

如果认为您必须使用 matplotlib 对条形图进行“后处理”，因为 pandas 在内部设置条形的宽度。

形成条形的矩形位于容器对象中。因此，您必须遍历这些容器并分别设置矩形的宽度：

```
In [208]: df = pd.DataFrame(np.random.random((6, 5)) * 10,               
                        index=list('abcdef'), columns=list('ABCDE'))

In [209]: df
Out[209]: 
     A    B    C    D    E
a  4.2  6.7  1.0  7.1  1.4
b  1.3  9.5  5.1  7.3  5.6
c  8.9  5.0  5.0  6.7  3.8
d  5.5  0.5  2.4  8.4  6.4
e  0.3  1.4  4.8  1.7  9.3
f  3.3  0.2  6.9  8.0  6.1

In [210]: ax = df.plot(kind='bar', stacked=True, align='center')

In [211]: for container in ax.containers:
              plt.setp(container, width=1)
   .....:         

In [212]: x0, x1 = ax.get_xlim()

In [213]: ax.set_xlim(x0 -0.5, x1 + 0.25)
Out[213]: (-0.5, 6.5)

In [214]: plt.tight_layout() 
```

![堆叠条.png](../Images/566170d41dba76889a2ca90d71144d52.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-24T03:44:44.653

“我想控制条形的宽度，使条形像直方图一样相互连接。”

更好的选择是使用**sns.displot()**

示例代码：

```
emp = pd.read_csv("https://raw.githubusercontent.com/arora123/Data/master/emp-data.csv")

sns.displot(emp, x='Department', hue='Gender', multiple='stack',  
             height=8, aspect=1.7); 
```

[![在此处输入图像描述](../Images/1da49f9961b1cd46715455e6dc903906.png)](https://i.stack.imgur.com/7nB90.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-16T10:11:40.853

# matplotlib 解决方案

根据 需要修改`width`参数`ax.bar`[![在此处输入图像描述](../Images/c61e8d313891e8733f020604719d6028.png)](https://i.stack.imgur.com/g2jBm.png)

**代码**

```
import numpy as np
import pandas as pd
from matplotlib import pyplot as plt

df = pd.DataFrame(np.arange(15).reshape(5, 3), columns=list('ABC'))

print(df)

fig, axs = plt.subplots(1, 2)

ax = axs[0]
xs = np.arange(df.shape[1])
ys = np.zeros(xs.shape)
for ind in df.index:
    ax.bar(xs, df.loc[ind, :], label=ind, bottom=ys, width=.4)
    ys += df.loc[ind, :]
plt.setp(ax, xticks=xs, xticklabels=list(df))
ax.legend(title='rows')
ax.set_xlabel('columns')

ax = axs[1]
xs = np.arange(df.shape[0])
ys = np.zeros(xs.shape)
for col in list(df):
    ax.bar(xs, df.loc[:, col], label=col, bottom=ys, width=.4)
    ys += df.loc[:, col]
plt.setp(ax, xticks=xs, xticklabels=df.index.to_numpy().tolist())
ax.legend(title='columns')
ax.set_xlabel('rows')

plt.show() 
```

**df=**

```
 A   B   C
0   0   1   2
1   3   4   5
2   6   7   8
3   9  10  11
4  12  13  14 
```

# node.js - 在 exec-maven-plugin > Node.js > r.js 某处吃掉的错误消息

> ID：14824460
> 
> 赞同：5
> 
> 时间：2013-02-12T02:23:43.983
> 
> 标签：node.js, maven, requirejs, stderr

我们使用[exec-maven-plugin](http://mojo.codehaus.org/exec-maven-plugin/)在 Node.js 下运行 RequireJS 的优化器（r.js）（因为它比 Rhino 快很多）：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>exec-maven-plugin</artifactId>
    <version>1.2</version>
    <executions>
        <execution>
            <id>compile-js</id>
            <phase>prepare-package</phase>
            <goals>
                <goal>exec</goal>
            </goals>
            <configuration>
                <executable>${node.executable}</executable>
                <arguments>
                    <argument>${project.build.directory}/dependency/requirejs/r.js</argument>
                    <argument>-o</argument>
                </arguments>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

问题是，只要在编译过程中出现任何问题，r.js 应该脱口而出的错误消息都不会显示在 Maven 的控制台输出中。我要解决的问题是，我使用 -X 标志重新运行 Maven 命令以获取调试输出，以便 exec-maven-plugin 输出正在执行的实际命令。它是这样的：

```
项目根/目标/依赖项/节点/节点\
    项目根/目标/依赖/requirejs/r.js \
    -o src/main/webapp/app.build.json

```

当我从命令行手动运行命令时，我会在控制台中得到实际的编译错误，然后继续修复它们。

我已经尝试过将 stderr 重定向到 stdout`2>&1`但无济于事（在 Windows 上），因为我无法立即找到一种方法来使 exec-maven-plugin 像重定向位一样作为参数。我没有走得太远，因为这只是一个疯狂的猜测，即这是一个标准错误/标准输出问题——它可能是，但我只是在猜测。

关于可能发生的事情的任何指示，或者我可以采取的进一步诊断步骤的任何建议？请记住，这个问题有多个活动部分：Maven、exec-maven-plugin、Node.js、r.js 和一个疲惫的脑袋。

PS 我正在考虑将[requirejs-maven-plugin](https://github.com/mcheely/requirejs-maven-plugin)作为最后的手段，因为项目时间表不允许我现在对 POM 进行彻底检查。我正在尝试查看当前设置是否可以做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T09:17:57.547

如何将调用包装在脚本中，`node.js`然后`r.js`从`maven-exec`插件调用？

从外观上看`r.js`，它似乎`console.log`用于它的输出。也许从 shell 脚本运行它可以让您捕获输出，将其通过管道传输到文件中，正则表达式错误等。

根据操作系统，这可能很容易做到。

# gnupg - gpg 物理保护私钥文件

> ID：14824463
> 
> 赞同：5
> 
> 时间：2013-02-12T02:24:03.817
> 
> 标签：gnupg

我刚刚开始使用 GPG。我创建了一个密钥对，现在有几个 .gpg 文件：

```
drwx------  2 jason jason  4096 Feb 11 21:10 ./
drwx------ 90 jason jason 45056 Feb 11 20:49 ../
-rw-------  1 jason jason  9398 Feb 11 20:49 gpg.conf
-rw-rw-r--  1 jason jason  2316 Feb 11 21:10 mypk
-rw-------  1 jason jason  1633 Feb 11 20:52 pubring.gpg
-rw-------  1 jason jason  1633 Feb 11 20:52 pubring.gpg~
-rw-------  1 jason jason   600 Feb 11 20:52 random_seed
-rw-------  1 jason jason  1794 Feb 11 20:52 secring.gpg
-rw-------  1 jason jason  1280 Feb 11 20:52 trustdb.gpg 
```

我是否正确理解 secring.gpg 是我的私钥？这个文件受我的密码保护，对吧？可以将此文件保留在我的机器上吗？我应该把它移到更安全的地方（比如拇指驱动器）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T09:32:31.747

> 我是否正确理解 secring.gpg 是我的私钥？

来自`man gpg`：

```
~/.gnupg/secring.gpg
       The secret keyring.  You should backup this file. 
```

* * *

> 这个文件受我的密码保护，对吧？

如果你设置一个，是的。实际上不是文件本身受到保护，但每个包含的密钥都可以（您的密钥环中可以有多个私钥）。

* * *

> 可以将此文件保留在我的机器上吗？我应该把它移到更安全的地方（比如拇指驱动器）吗？

这取决于您的需求和对机器的信任。

*   您是否有特殊的安全需求、共享您的机器或期望它被黑客/被盗/...？最好将其放在外部设备上，然后在使用`--secret-keyring /path/to/secring.gpg`时引用它`gpg`或将其放入您的`gpg.conf`: `secret-keyring /path/to/secring.gpg`。
*   你相信你的计算机的完整性，甚至可能加密你的文件吗？你会经常使用你的密钥吗？最好将文件保存在硬盘上，因为这样可以省去使用`gpg`.

要将您的密钥放在单独的设备上，请考虑使用[OpenPGP 卡](http://wiki.debian.org/Smartcards/OpenPGP)。使用一个，您的密钥将永远不会离开该卡（用于签名和解密），而是用于备份目的。肯定也会增加书呆子因素。;)

# backbone.js - 命名空间后无法让应用程序工作

> ID：14824465
> 
> 赞同：0
> 
> 时间：2013-02-12T02:24:10.770
> 
> 标签：backbone.js

我有一个正常工作的 Backbone 应用程序，但是，当我尝试在命名空间下重新组织代码时，我无法让它做任何事情。对于我知道正在初始化的视图（通过控制台日志消息），我什至无法触发事件（通过单击 id），所以我想知道我是否以某种方式引入了一些基本缺陷。我正在遵循这个博客（法语）[http://www.atinux.fr/2011/12/10/organiser-son-code-backbone-js-en-modules/](http://www.atinux.fr/2011/12/10/organiser-son-code-backbone-js-en-modules/)

在主 application.js（见下文）中，我在文档准备好启动应用程序后实例化所有视图和模型。由于创建此命名空间而引入的一项更改是为视图设置模型`this.models.game`

```
this.views.clock_view      = new this.Views.clockView({ model: this.models.game}); 
```

在模块文件夹中，我有一个views.js 和一个models.js。`app.Views or app.Models`我像这样创建了每个视图和对象，并以相应的开头

```
app.Views.announceView = Backbone.View.extend({
 ....
app.Views.optionsView = Backbone.View.extend({
 ... 
```

这个 app.Views.optionsView 正在初始化（根据初始化程序中的 console.log 语句）但是当我点击 #new_game 时，startNewGame 中的 console.log 没有被触发

```
 'click #new_game': 'startNewGame'
      // 'click .action_button': 'startNewGame'

    },

    startNewGame: function() {
      console.log("startNewGame");
      this.model.new();
    }, 
```

由于命名空间，我所做的另一个关键更改是在其他视图之一中创建新视图时。在上一个（非命名空间应用程序）下，我从 QuestionListView 创建了单个问题项

```
 var view = new QuestionListItemView({ model: game }); 
```

但现在我在做

```
 var view = new app.Views.questionListItemView({ model: app.models.game }) 
```

因为模型的实例保存`this.models.game`在 application.js 中，但是，我也尝试使用 'this.models.game'

```
 var view = new app.Views.questionListItemView({ model: this.models.game }) 
```

不管怎样，在涉及游戏模型之前，我无法触发上面列出的 startNewGame 函数，所以这不仅仅是如何识别模型的问题。

我还想知道在从内部创建新视图时是否应该在“新”之后使用 this.Views 或 app.Views

```
 var view = new app.Views.questionListItemView({ model: this.models.game }) 
```

如果您能帮助我找出我引入的任何缺陷，我将不胜感激。

应用程序.js

```
var app = {
  // Classes
  Collections: {},
  Models: {},
  Views: {},
  // Instances
  collections: {},
  models: {},
  views: {},
  init: function () {
    this.models.game          = new this.Models.game();
    this.views.story_view     = new this.Views.storyView();  #doesn't have a model
    this.views.clock_view      = new this.Views.clockView({ model: this.models.game}); 
    this.views.field_view      = new this.Views.fieldView({ model: this.models.game});
    this.views.options_view    = new this.Views.optionsView({ model : this.models.game});
    this.views.announcement_view = new this.Views.announceView({ model: this.models.game});
    this.views.question_list_view      = new this.Views.questionListView({ model : this.models.game});
    this.views.question_list_item_view = new this.Views.questionListItemView({ model : this.models.game});
  }
};

$(document).ready(function () {

  app.init();
}) ; 
```

选项视图正在初始化，但是当我单击该 #id 时无法触发 startNewGame 函数

```
app.Views.optionsView = Backbone.View.extend({
    // el: $("#options"),
    el: $("#options"),
    initialize: function() {
        console.log("app views OptionsView initialized");
      // this.model.bind("gameStartedEvent", this.removeGetAnswerButton, this);
      this.model.bind("gameStartedEvent", this.disableNewGame, this);

    },
    events: {
      'click #demo': 'startDemo',
      'click #new_game': 'startNewGame'
      // 'click .action_button': 'startNewGame'

    },
    startDemo: function(){
      console.log("start demo");
     this.model.demo();
    }, 
    startNewGame: function() {
      console.log("startNewGame");
      this.model.new();
    },
    disableNewGame: function(){
        $('#new_game').attr("disabled", true);
    }

  }); 
```

更新我的文件结构如下所示

```
<%= javascript_include_tag 'application.js'%>
<%= javascript_include_tag 'modules/models'%>
<%= javascript_include_tag 'modules/views'%> 
```

在视图和模型文件的顶部，我只是做这样的事情

```
app.Views.optionsView = Backbone.View.extend({ 
```

即..没有准备好进一步的文件。事实上，在这些文件中包含另一个准备好的文档会破坏 application.js init

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T05:08:04.167

在使用命名空间之前，我在视图中以这种方式定义了元素

```
el: $("#options") 
```

正如对该问题的评论所指出的那样，这不是理想的方法（请参阅下面的@muistooshort 评论），（即使它有效）。

以这种方式定义 el

```
 el: '#options' 
```

让它工作，并让 Backbone 自己“将其转换为节点对象”。

# javascript - 来自 JSON 的多个系列的 Highcharts

> ID：14824467
> 
> 赞同：1
> 
> 时间：2013-02-12T02:24:33.440
> 
> 标签：javascript, json, highcharts

经过几天的阅读和测试（并且已经在这里发布但有一个错误的问题）我真的需要你，因为我一次又一次地失败......

我的目标：在相同的图表上有许多系列（以及未来的许多图表）我的数据源：一个 mysql 和一个 json 输出：

```
"[{"name":"Station 1","data":"1360191600,398.625"},{"name":"Station 1","data":"1360192500,398.625"},{"name":"Station 1","data":"1360193400,398.25"},{"name":"Station 1","data":"1360194300,397.375"},{"name":"Station 1","data":"1360195200,397.5"},{"name":"Station 1","data":"1360196100,397.5"},{"name":"Station 1","data":"1360199700,396.75"},{"name":"Station 1","data":"1360200600,397"}... 
```

这些数据是一个例子，因为在正常时间我有很多站，有些只有时间戳数据。

此刻我最大的失败是将这些信息发送到 series:[] 选项。

我尝试了一些这样的循环：

```
 data=JSON.parse(data) ;
            var series = [];
            series.data = [];
            $.each(data,function(i,ligne) {

                var string = JSON.stringify(ligne);
                var obj = $.parseJSON(string);
                //var index_serie = obj.name.slice(0,1) ;
                console.log(obj) ;
                points=(obj.data) ;
                series.name=obj.name ;
                series.data.push(points) ;
            }) ;
            options.series.push(series) ;
            console.log(options.series) ;

            var chart = new Highcharts.Chart(options); 
```

图表的选项是在 ajax 调用之前定义的。

我尝试使用其他格式的 json，例如 ["name":"station1","data":"[1321654,10],[5465... 但我很难在我的 sql 查询中添加 [] 和GROUP_CONCAT 有一些限制（2014 字符）

所以帮助我创建一个很好的循环，以便用他们的名字等渲染多个系列

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T13:25:43.633

您不能将“几乎”JSON 更改为“另一个”JSON 吗？也许是这样的：

```
[{
    "name":'station 1',
    "data": [ [360191600,398.625], [360191600,398.625], [360191600,398.625] ... [360191600,398.625] ]
}, {
    "name":'station 2',
    "data": [ [360191600,398.625], [360191600,398.625], [360191600,398.625] ... [360191600,398.625] ]
}] 
```

如果没有，您必须为您的值添加一些解析，例如：

```
data = JSON.parse(data);
var names = [];
$.each(data, function (i, ligne) {
    var ind = names.indexOf(ligne.name),
        splited = ligne.data.split(','),
        x = parseFloat(splited[0]),
        y = parseFloat(splited[1]);
    if (ind == -1) {
        /*series name spotted first time need to add new series */
        ind = names.push(ligne.name) - 1;
        options.series.push({
            data: [],
            name: ligne.name
        });
    } 
    if(!isNaN(x) && !isNaN(y)){
        options.series[ind].data.push([x,y]);    
    }
}); 
```

和工作jsfiddle：http: [//jsfiddle.net/3bQne/40/](http://jsfiddle.net/3bQne/40/)

# php - PHP 5.4 超时调用闭包

> ID：14824468
> 
> 赞同：2
> 
> 时间：2013-02-12T02:24:47.317
> 
> 标签：php, oop, timeout, closures, interceptor

我只是在模拟我正在研究的拦截类。想法是您通过 Intercept 类实例化该类，然后使用该对象，就好像它是您正在拦截的类一样。每次调用该类时都会运行指定的回调。这是代码：

```
<?php
class Intercept {

    protected $class = null;
    protected $callback = null;

    public function __construct($class, $callback = null) {

        $this->class = new $class();
        $this->callback = $callback;
    }

    protected function run_callback() {

        $this->callback();
    }

    public function __get($name) {

        $this->run_callback();
        return $this->class->$name;
    }

    public function __set($name, $value) {

        $this->run_callback();      
        return $this->class->$name = $value;
    }

    public function __isset($name) {

        $this->run_callback();
        return isset($this->class->$name);
    }

    public function __unset($name) {

        $this->run_callback();
        unset($this->class->$name);
    }

    public function __call($method, $args) {

        $this->run_callback();
        return call_user_func_array(array($this->class, $method), $args);
    }

    public function __toString() {

        $this->run_callback();
        return $this->class;
    }

    public function __invoke() {

        $this->run_callback();
        return $this->class();
    }
}

class test {
    public function hello() { 
        return 'world'; 
    }
}

$closure = function() {
    echo 123;
};

$test=new Intercept('test', $closure);
echo $test->hello(); 
```

现在，运行上面的代码**应该**会显示“world123”。但是由于一些我看不到的奇怪原因，它最终超时了。我在我的本地机器和各种 php 5.4 在线测试站点上进行了尝试。同样的事情也会发生。我已将其缩小到 run_callback() 方法中正在运行的闭包 ($this->callback())。如果我只是删除 $this->callback()，它工作正常。为什么会这样？

**编辑，当我写这个问题时，我发现不是：**

```
$this->callback(); 
```

这样做将停止超时：

```
$closure = $this->callback;
$closure(); 
```

似乎每次我尝试直接从类属性运行闭包时都会调用 __call 方法。这是预期的行为还是我偶然发现了一个 PHP 错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T02:29:54.333

很确定这是因为你有一个函数调用堆栈的无限循环。当你这样做

```
$this->callback(); 
```

您正在尝试执行成员函数`callback()`，它不存在，所以`__call()`被执行，它`callback()`再次尝试，它不存在，所以`__call()`被执行，依此类推。

您应该使用以下内容：

```
call_user_func( $this->callback); 
```

或者，就像您编辑过的那样，这也可以：

```
$closure = $this->callback;
$closure(); 
```

希望这可以澄清正在发生的事情。超时只是因为您的资源不足（在本例中为时间）而发生。根本问题是无限循环。

# c++ - 有没有办法将源代码格式化为每行只包含一个语句？

> ID：14824469
> 
> 赞同：0
> 
> 时间：2013-02-12T02:24:52.623
> 
> 标签：c++, formatting

我想知道格式化 ac 源代码以使每一行只包含一个语句的自动方式。

例如，

由此

```
1: if(true) break; 
```

对此：

```
1: if(true)
2:     break; 
```

任何有用的评论将不胜感激。谢谢你。

注意：请仔细阅读我想要的内容（每行只有一个语句！）。我已经尝试过 Astyle 和其他美化工具，但这些工具并没有提供我想要的功能。另外，我用谷歌搜索了它，但没有找到结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:29:46.070

[Astyle](http://astyle.sourceforge.net/)是一种工具，可以将源代码重新格式化为任意数量的样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:34:11.803

检查[AStyle](http://astyle.sourceforge.net/)（艺术风格）。

**用法示例：**

```
astyle --style=allman /home/user/project/foo.cpp 
```

**文档：**

[http://astyle.sourceforge.net/astyle.html](http://astyle.sourceforge.net/astyle.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T03:37:49.297

有[GNU indent](http://www.gnu.org/software/indent)，它应该可用于任何 Linux 发行版并作为 Windows 下 CygWin 的一部分。它是非常可配置的（默认样式是可怕的......）。或者您可以选择[emacs](http://www.gnu.org/software/emacs/)或[xemacs](http://xemacs.org)，它们都具有针对各种语言的可配置（自动）缩进。再次，根据口味配置，默认设置几乎不会更糟。

# java - 每秒而不是一次执行和显示图形

> ID：14824471
> 
> 赞同：1
> 
> 时间：2013-02-12T02:24:56.647
> 
> 标签：java, swing, graphics, event-dispatch-thread

我正在模拟生物体的生长，使用生物体的 jLabels。但是，当我实现一个 for 循环和一个计时器来尝试显示它移动时，它会冻结，然后显示标签的最终位置，而不是显示它移动。谁能向我解释为什么会这样？

```
public class TestView extends FrameView {
   public TestView(SingleFrameApplication app) {
      super(app);
      initComponents();
      picture = new JLabel();
      picture.setIcon(new ImageIcon(System.getProperty("user.dir") +
            File.separator + "mouse.gif"));
      picture.setBounds(0, 0, 100, 100);
      mainPanel.add(picture);

      for (int x = 0; x < 20; x++) {
         move();
         wait(50);
      }
   }

   public static void wait(int n) {
       long t0, t1;
       t0 = System.currentTimeMillis();
       do {
           t1 = System.currentTimeMillis();
       } while (t1 - t0 < n);
   }

   public static void move() {
       picture.setBounds(picture.getX() + 5, picture.getY(), 100, 100);
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T13:00:48.067

您可能会喜欢[*扩散受限聚合*](http://apricot.ap.polyu.edu.hk/dla/dla.html)和其他[模拟](http://apricot.ap.polyu.edu.hk/)的这个示例。

# java - 如何从jsp访问java接口

> ID：14824472
> 
> 赞同：1
> 
> 时间：2013-02-12T02:24:59.463
> 
> 标签：java, jsp, struts2

我正在尝试从我的 jsp 访问常量接口，但它显示以下错误。

```
Caused by: tag 'select', field 'list', name 'title': 
The requested list key 'Constants.TITLE' 
could not be resolved as a collection/array/map/enumeration/iterator type. 
Example: people or people.{name} - [unknown location] 
```

我的界面

```
public interface Constants {
    public List<String> TITLE = Arrays.asList("Mr","Mrs","Ms","Miss"); 
    // public String[] TITLE = {"MR","MRs"}; << does not work as well
   //public static final String[] TITLE = {"MR","MRs"}; << does not work as well
} 
```

我的 Jsp 代码

```
...
<%@page import="com.myconstants.Constants" %>
<head>
</head>
<body>
     <s:form>
     <s:select label="title" name="title" list="Constants.TITLE" value=" "/>
     </s:form>
 .... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:40:28.820

做一堂课。将列表放在一个类中。使用普通的 OGNL 静态属性访问：

```
<s:select key="title" list="@some.package.Constants@TITLES" /> 
```

*我*会这样做吗？可能不是; 更难 I18Nize，更难在 JSP 中找到/重构用法（取决于 IDE）。一般来说，我建议通过操作中的服务/层将数据暴露给视图层。

# c - 堆栈的“顶部”是否与开始和结束都不同？

> ID：14824482
> 
> 赞同：1
> 
> 时间：2013-02-12T02:26:13.857
> 
> 标签：c, libyaml

我正在使用 C libYAML 库来处理 YAML 配置文件，我对它的代码中的这个结构元素有点困惑：

```
/** The stack of mapping pairs (key, value). */
struct {
    /** The beginning of the stack. */
    yaml_node_pair_t *start;
    /** The end of the stack. */
    yaml_node_pair_t *end;
    /** The top of the stack. */
    yaml_node_pair_t *top;
} pairs; 
```

它使用三个指针，`start`，`end`和`top`。两者似乎都很明显`start`，`end`它们是数据区域的开始和结束，但什么是`top`？

[（作为参考，此代码出现在此处](http://pyyaml.org/browser/libyaml/branches/stable/include/yaml.h?rev=372#L741)的第 741 行。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:31:49.467

start 和 end 指的是堆栈的最大边界。顶部是一个动态指针，指向当前位置，并随着您调用嵌套级别的函数而变化。

# mongodb - MongoDB 甚至不使用最简单的索引

> ID：14824484
> 
> 赞同：0
> 
> 时间：2013-02-12T02:26:20.560
> 
> 标签：mongodb, indexing, mongodb-indexes

请看下面的例子。在我看来，查询应该被索引覆盖`{a: 1}`，但是`explain()`给了我一个`indexOnly: false`. 我做错了什么？

```
> db.foo.save({a: 1, b: 2});
> db.foo.save({a: 2, b: 3});
> db.foo.ensureIndex({a: 1});
> db.foo.find({a: 1}).explain();
{
    "cursor" : "BtreeCursor a_1",
    "nscanned" : 6,
    "nscannedObjects" : 6,
    "n" : 6,
    "millis" : 0,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "isMultiKey" : false,
    "indexOnly" : false,
    "indexBounds" : {
        "a" : [
            [
                1,
                1
            ]
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T08:14:58.743

索引仅表示覆盖查询（[http://docs.mongodb.org/manual/applications/indexes/#indexes-covered-queries](http://docs.mongodb.org/manual/applications/indexes/#indexes-covered-queries)），其中查询及其排序和数据都可以在单个索引中找到。

您的查询的问题：

```
db.foo.find({a: 1}).explain(); 
```

是它必须检索完整的文档，这意味着它无法在索引中找到所有数据。相反，您可以使用：

```
db.foo.find({a: 1}, {_id:0,a:1}).explain(); 
```

这意味着您只投影`a`使整个查询适合索引的字段，因此`indexOnly`是正确的。

# c# - 我可以仅使用套接字在 Java 和 C# 之间进行通信吗？

> ID：14824491
> 
> 赞同：10
> 
> 时间：2013-02-12T02:26:55.553
> 
> 标签：c#, java, sockets, networking

更具体地说，如果计算机有服务器（`java.net.ServerSocket`实例），我可以使用 C#`System.Net.Sockets.Socket`实例连接到它吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-12T03:47:10.570

主要问题是您需要非常小心地对发送和接收的数据进行编码。这是一对协同工作的程序。C# 客户端发送一个字符串，首先将其长度作为整数发送，然后发送字符串本身的字节。Java 服务器读取长度，然后读取消息并将输出打印到控制台。然后编写回显消息，计算其长度，提取字节并将其发送回 C# 客户端。客户端读取长度、消息并打印输出。应该有一种方法可以避免所有按位的东西，但老实说，我对这些东西有点生疏，尤其是在 Java 方面。

Java 服务器：

```
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

public class JavaSocket {

    public static void main(String[] args) throws IOException {

        ServerSocket serverSocket = new ServerSocket(4343, 10);
        Socket socket = serverSocket.accept();
        InputStream is = socket.getInputStream();
        OutputStream os = socket.getOutputStream();

        // Receiving
        byte[] lenBytes = new byte[4];
        is.read(lenBytes, 0, 4);
        int len = (((lenBytes[3] & 0xff) << 24) | ((lenBytes[2] & 0xff) << 16) |
                  ((lenBytes[1] & 0xff) << 8) | (lenBytes[0] & 0xff));
        byte[] receivedBytes = new byte[len];
        is.read(receivedBytes, 0, len);
        String received = new String(receivedBytes, 0, len);

        System.out.println("Server received: " + received);

        // Sending
        String toSend = "Echo: " + received;
        byte[] toSendBytes = toSend.getBytes();
        int toSendLen = toSendBytes.length;
        byte[] toSendLenBytes = new byte[4];
        toSendLenBytes[0] = (byte)(toSendLen & 0xff);
        toSendLenBytes[1] = (byte)((toSendLen >> 8) & 0xff);
        toSendLenBytes[2] = (byte)((toSendLen >> 16) & 0xff);
        toSendLenBytes[3] = (byte)((toSendLen >> 24) & 0xff);
        os.write(toSendLenBytes);
        os.write(toSendBytes);

        socket.close();
        serverSocket.close();
    }
} 
```

AC#客户端：

```
using System;
using System.Net;
using System.Net.Sockets;

namespace CSharpSocket
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            string toSend = "Hello!";

            IPEndPoint serverAddress = new IPEndPoint(IPAddress.Parse("192.168.0.6"), 4343);

            Socket clientSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            clientSocket.Connect(serverAddress);

            // Sending
            int toSendLen = System.Text.Encoding.ASCII.GetByteCount(toSend);
            byte[] toSendBytes = System.Text.Encoding.ASCII.GetBytes(toSend);
            byte[] toSendLenBytes = System.BitConverter.GetBytes(toSendLen);
            clientSocket.Send(toSendLenBytes);
            clientSocket.Send(toSendBytes);

            // Receiving
            byte[] rcvLenBytes = new byte[4];
            clientSocket.Receive(rcvLenBytes);
            int rcvLen = System.BitConverter.ToInt32(rcvLenBytes, 0);
            byte[] rcvBytes = new byte[rcvLen];
            clientSocket.Receive(rcvBytes);
            String rcv = System.Text.Encoding.ASCII.GetString(rcvBytes);

            Console.WriteLine("Client received: " + rcv);

            clientSocket.Close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-26T16:42:06.447

我想知道如何循环这个方法，这样你就可以一遍又一遍地发送客户端消息。如果您觉得这很有用，请告诉我。我使用 Export Ant 脚本在 Eclipse 上构建它。我也会包含 ant 脚本

```
package lineage;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

public class l2protector {
    public static void main(String[] args) throws IOException {
        boolean runserver = true;
        ServerSocket serverSocket = new ServerSocket(1040, 10);
        Socket socket = serverSocket.accept();
        InputStream is = socket.getInputStream();
        OutputStream os = socket.getOutputStream();
        do
        {
            try {
                serverSocket = new ServerSocket(1040, 10);
                socket = serverSocket.accept();
                is = socket.getInputStream();
                os = socket.getOutputStream();
                // Receiving
                byte[] lenBytes = new byte[4];
                is.read(lenBytes, 0, 4);
                int len = (((lenBytes[3] & 0xff) << 24) | ((lenBytes[2] & 0xff) << 16) |
                          ((lenBytes[1] & 0xff) << 8) | (lenBytes[0] & 0xff));
                byte[] receivedBytes = new byte[len];
                is.read(receivedBytes, 0, len);
                String received = new String(receivedBytes, 0, len);
                if(received != null) {
                    System.out.println("Server received: " + received);
                }
                // Sending
                String toSend = "Echo: " + received;
                byte[] toSendBytes = toSend.getBytes();
                int toSendLen = toSendBytes.length;
                byte[] toSendLenBytes = new byte[4];
                toSendLenBytes[0] = (byte)(toSendLen & 0xff);
                toSendLenBytes[1] = (byte)((toSendLen >> 8) & 0xff);
                toSendLenBytes[2] = (byte)((toSendLen >> 16) & 0xff);
                toSendLenBytes[3] = (byte)((toSendLen >> 24) & 0xff);
                os.write(toSendLenBytes);
                os.write(toSendBytes);
                socket.close();
            }
            catch(Exception e) {
                serverSocket.close();
            }

        }
        while(runserver);
        serverSocket.close();
    }
} 
```

蚂蚁脚本：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- WARNING: Eclipse auto-generated file.
              Any modifications will be overwritten.
              To include a user specific buildfile here, simply create one in the same
              directory with the processing instruction <?eclipse.ant.import?>
              as the first entry and export the buildfile again. --><project name="AntiCheat" default="dist" basedir=".">
    <description>
    simplest example build file
  </description>
    <!-- set global properties for this build -->
    <property name="src" location="src" />
    <property name="build" location="build" />
    <property name="dist" location="dist" />
    <property name="version" value="1.0" />

    <target name="init">
        <!-- Create the time stamp -->
        <tstamp />
        <!-- Create the build directory structure used by compile -->
        <mkdir dir="${build}" />
    </target>

    <target name="compile" depends="init" description="compile the source">
        <!-- Compile the java code from ${src} into ${build} -->
        <javac srcdir="${src}" destdir="${build}" />
    </target>

    <target name="dist" depends="compile" description="generate the distribution">
        <buildnumber />
        <!-- Create the distribution directory -->
        <mkdir dir="${dist}/lib" />

        <!-- Put everything in ${build} into the MyApplication-${version}.${build.number}.jar -->
        <jar destfile="${dist}/lib/MyApplication-${version}.${build.number}.jar" basedir="${build}" />
    </target>

    <target name="clean" description="clean up">
        <!-- Delete the ${build} and ${dist} directory trees -->
        <delete dir="${build}" />
        <delete dir="${dist}" />
    </target>
</project> 
```

# c# - 检测 Win8 Metro Style App 中的视觉状态变化并基于此更改数据绑定

> ID：14824492
> 
> 赞同：1
> 
> 时间：2013-02-12T02:27:18.097
> 
> 标签：c#, xaml, microsoft-metro, winrt-xaml

我不确定我是否做错了，我尝试找到一种方法来根据视觉状态手动更改与 UI 的数据绑定，例如，如果 Snapped，UI 将选择性地使用部分数据源或只是使用一组新的数据，但我想保持整洁，所以我真的不想同时维护2组。

有没有办法检测视觉状态的变化？还是我应该找到不同的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T05:25:05.190

Grid App 模板中 GroupedItemsPage 的构造函数中的以下代码行演示了您可以将自定义绑定代码放置在何处。这个简单的示例显示应用程序的当前 VisualState 以响应[CurrentStateChanged](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.visualstategroup.currentstatechanged.aspx)事件：

```
ApplicationViewStates.CurrentStateChanged += (s, e) => pageTitle.Text = e.NewState.Name; 
```

对于您引用的更具体的 Snapped 案例，您还可以利用[OrientationChanged](http://msdn.microsoft.com/en-us/library/windows/apps/windows.graphics.display.displayproperties.orientationchanged.aspx)

```
DisplayProperties.OrientationChanged += (s) => pageTitle.Text = DisplayProperties.CurrentOrientation.ToString(); 
```

# wordpress - 将 wordpress woo Commerce 与骨干网.js/node.js 框架一起使用

> ID：14824493
> 
> 赞同：0
> 
> 时间：2013-02-12T02:27:21.153
> 
> 标签：wordpress, node.js, backbone.js, woocommerce

我已经外包了一个利用backbone.js 和node.js 来完成任务的Web 应用程序的开发。现在我需要添加用户登录和购物车功能。我正在考虑为此使用wordpress woo commerce，因为它易于使用。这样做可行吗。

如果没有任何关于 node.js 简单电子商务解决方案的建议，仅用于管理用户订单和购物车功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:27:14.297

我真的很喜欢使用 WooCommerce，他们有一些文档可以自己使用插件进行修改。

Wordpress 本身就是一个很棒的工具，它不仅可以使用它提供的所有自定义功能来写博客。

我建议使用 Wordpress 和 WooCommerce

# r - 如何将数据框的列移动到前几列之后的行中？

> ID：14824495
> 
> 赞同：14
> 
> 时间：2013-02-12T02:27:42.043
> 
> 标签：r, dataframe

我有一个数据框，每一行代表一系列学校

```
edu <- read.table(header=TRUE, text="Elem Mid High
e1 m1 h1
e2 m2 h2
e1 m2 h2
e3 m1 h1") 
```

我想把它变成一个边缘列表

```
 s1 s2
1 e1 m1
2 e2 m2
3 e1 m2
4 e3 m1
5 m1 h1
6 m2 h2
7 m2 h2
8 m1 h1 
```

对于有向图（通过 igraph 包）。

这是我的做法：

```
e2m <- edu[,1:2]
m2h <- edu[,2:3]
colnames(e2m) <- c("s1", "s2")
colnames(m2h) <- c("s1", "s2")
schools <- rbind(e2m,m2e) 
```

“学校”包含我想要的内容，但如果我想添加第四列（例如“Uni”），它是迭代的并且变得很麻烦。什么是矢量化的方式来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T02:42:12.940

这是一个可能的解决方案：

```
len <- seq_along(edu)
a <- head(len, -1)
b <- tail(len, -1)

data.frame(s1=as.character(unlist(edu[, a])), s2=as.character(unlist(edu[, b]))) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T02:49:26.870

直接将 OP 的代码翻译成应用程序。这不是矢量化的：

```
do.call(rbind, lapply(seq(ncol(edu)-1), FUN=function(x){
  r <- edu[,x:(x+1)]
  colnames(r) <- c('s1', 's2')
  r
}

)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T05:57:59.627

使用@Tyler 的方法：

```
# assuming a new column added
edu$Uni <- as.factor(c("u1", "u2", "u1", "u1")) 
```

.

```
rows  <- nrow(edu)
total <- prod(dim(edu))  # ie: nrow(edu) * ncol(edu)  

X <- as.character(unlist(edu))
data.frame(s1=X[1:(total-rows)],  s2=X[(rows+1):total]) 
```

结果：

```
 s1 s2
1  e1 m1
2  e2 m2
3  e1 m2
4  e3 m1
5  m1 h1
6  m2 h2
7  m2 h2
8  m1 h1
9  h1 u1  <~~~ Added "Uni" column
10 h2 u2  <~~~ Added "Uni" column
11 h2 u1  <~~~ Added "Uni" column
12 h1 u1  <~~~ Added "Uni" column 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T04:14:43.027

函数接受的具有矩阵输出的替代方案`igraph`。

```
t(
  matrix(
   apply(edu,1,function(x) x[c(1,rep(2:(length(x)-1),each=2),length(x))]),
   nrow=2
        )
 ) 
```

结果：

```
 [,1] [,2]
[1,] "e1" "m1"
[2,] "m1" "h1"
[3,] "e2" "m2"
[4,] "m2" "h2"
[5,] "e1" "m2"
[6,] "m2" "h2"
[7,] "e3" "m1"
[8,] "m1" "h1" 
```

并转换为图表：

```
> graph.edgelist(result)
IGRAPH DN-- 7 8 -- 
+ attr: name (v/c) 
```

# sorting - 在woocommerce中按评级对产品进行排序

> ID：14824503
> 
> 赞同：2
> 
> 时间：2013-02-12T02:29:08.110
> 
> 标签：sorting, e-commerce, woocommerce

我正在尝试通过平均评分对 Woocommerce 产品类别页面上的产品进行排序。

我找到了将评级放在产品页面上的代码，将代码添加到 functions.php（见下文），但选择评级没有任何作用。

我需要调用（或创建）什么 meta_key 才能让它工作？

```
add_filter('woocommerce_get_catalog_ordering_args','custom_woocommerce_get_catalog_ordering_args');

function custom_woocommerce_get_catalog_ordering_args( $args ) {    
    if (isset($_SESSION['orderby'])) {

        switch ($_SESSION['orderby']) :

            case 'date_asc' :

                $args['orderby'] = 'date';

                $args['order'] = 'asc';

                $args['meta_key'] = '';

            break;

            case 'price_desc' :

                $args['orderby'] = 'meta_value_num';

                $args['order'] = 'desc';

                $args['meta_key'] = '_price';

            break;

            case 'title_desc' :

                $args['orderby'] = 'title';

                $args['order'] = 'desc';

                $args['meta_key'] = '';

            break;

            case 'rating_desc' :

                $args['orderby'] = 'rating';

                $args['order'] = 'desc';

                $args['meta_key'] = '';

            break;

        endswitch;

    }

    return $args;    
}

add_filter('woocommerce_catalog_orderby', 'custom_woocommerce_catalog_orderby');

function custom_woocommerce_catalog_orderby( $sortby ) {            
    $sortby['rating_desc'] = 'Rating';
    $sortby['title_desc'] = 'Reverse-Alphabetically';

    $sortby['price_desc'] = 'Price (highest to lowest)';

    $sortby['date_asc'] = 'Oldest to newest';

    return $sortby;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-27T09:59:19.943

尝试将您的案例“rating_desc”更改为此

```
case 'rating_desc' :

    add_filter( 'posts_clauses', array( $this, 'order_by_rating_post_clauses' ) );

break; 
```

当我遇到类似问题时，经过一番挖掘后，在第 492 行找到了*include\class-wc-query.php中的那段代码。*如果您需要核心函数*order_by_rating_post_clauses*，它位于第 547 行的同一文件中。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-03T10:06:08.957

`WC_Shortcode_Products`在默认 wc 商店页面中使用了用于生成带有排序参数的 wc 循环：

```
for($i=1;$i<=$num;$i++){
    $atts = array_merge(array(
        'columns' => $columns,
        'orderby' => $order_by,
        'order' => $sort_by,
        'rows' => $rows,
        'page' => $i,
    ));
    $shortcode = new WC_Shortcode_Products($atts, 'recent_products');
    $html ='';
    $html .= $shortcode->get_content();
    echo $html;
} 
```

# ios - 以可重用的方式抽象 dispatch_async 调用

> ID：14824505
> 
> 赞同：2
> 
> 时间：2013-02-12T02:29:14.883
> 
> 标签：ios

我正在尝试更好地创建更多可重用的代码。目前在我们的应用程序中，我们有一个 DataManager 单例，所有对数据库的调用都会经过。因此，对于昂贵的数据库查找，我想将该调用放在嵌套的 dispatch_async 块中，以免阻塞主线程。所以目前，

在 ViewControllerA 中：

```
dispatch_queue_t aQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(aQueue, ^{
  NSArray *array = [DataManager myExpensiveMethodCall];
  dispatch_async(dispatch_get_main_queue(), ^{
    [self setEvents:array];
  });
}); 
```

我想知道是否有办法更好地抽象这种类型的“模式”。我在 Apple 的示例代码中看到了它，并且每当我需要执行昂贵的方法然后更新 UI 时，我基本上都会执行这种类型的嵌套 dispatch_async 调用。我只是好奇将这种类型的代码放在需要做这种事情的任何 ViewController 中是否“可以”，或者是否有更好的方法。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:14:07.680

在 .h 文件中，将其放在任何 @interface 之外

```
typedef void(^MyBlockType)(void); 
```

在你的 .m 文件中，你可以使用这样的东西

```
+(void)doAsyncWithBlock:(MyBlockType)asyncBlock andSyncBlock:(MyBlockType)syncBlock
{
    dispatch_queue_t aQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_async(aQueue, ^{
        if( asyncBlock != nil )
        {
            asyncBlock();
        }
        dispatch_async(dispatch_get_main_queue(), ^{
            if( syncBlock != nil )
            {
                syncBlock();
            }
        });
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:21:13.567

是的，可以做到这一点，我看到的主要优势是您可以消除对 GCD 的依赖，并使您的大部分代码与您的主要并发技术无关。

我认为启动一个负责管理异步工作单元的调度和协调它们的回调的新类是合理的，而不是将其添加到视图控制器类中。这样的对象以后可以维护自定义调度队列或`NSOperationQueue`s 或任何未来的技术出现。我正在想象一个带有默认实例的东西，它还提供一个 API 来调度与底层线程技术无关的块。使用 GCD 的一个可能示例如下：

```
typedef void(^AsynchronousWorkManagerBlock)();

@interface AsynchronousWorkManager : NSObject

+ (AsynchronousWorkManager *)defaultManager;

- (void)executeInBackground:(AsynchronousWorkManagerBlock)backgroundBlock
     withMainThreadCallback:(AsynchronousWorkManagerBlock)callbackBlock;

@end

@implementation AsynchronousWorkManager

+ (AsynchronousWorkManager *)defaultManager
{
    static dispatch_once_t onceToken;
    static AsynchronousWorkManager *DefaultManager = nil;
    dispatch_once(&onceToken, ^{
        DefaultManager = [[self alloc] init];
    });
    return DefaultManager;
}

- (void)executeInBackground:(AsynchronousWorkManagerBlock)backgroundBlock
     withMainThreadCallback:(AsynchronousWorkManagerBlock)callbackBlock
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        backgroundBlock();
        dispatch_async(dispatch_get_main_queue(), callbackBlock);
    });
}

@end 
```

客户端代码可以这样调用它：

```
[[AsynchronousWorkManager defaultManager] executeInBackground:^{
                                            NSLog(@"This code is happening in the background");
                                        }
                                      withMainThreadCallback:^{
                                            NSLog(@"This code is happening on the main thread");
                                        }];

[[AsynchronousWorkManager defaultManager] executeInBackground:^{
                                            sleep(3);
                                        }
                                      withMainThreadCallback:^{
                                          NSLog(@"Done Sleeping");
                                      }]; 
```

稍后，如果您决定改用 using`NSOperationQueue`而不是 GCD，则无需更改 API 即可直接更改，如以下示例实现所示：

```
@interface AsynchronousWorkManager ()

@property (nonatomic, strong) NSOperationQueue *operationQueue;

@end

@implementation AsynchronousWorkManager

+ (AsynchronousWorkManager *)defaultManager
{
    static dispatch_once_t onceToken;
    static AsynchronousWorkManager *DefaultManager = nil;
    dispatch_once(&onceToken, ^{
        DefaultManager = [[self alloc] init];
    });
    return DefaultManager;
}

- (id)init
{
    if (self = [super init]) {
        _operationQueue = [[NSOperationQueue alloc] init];
    }

    return self;
}

- (void)executeInBackground:(AsynchronousWorkManagerBlock)backgroundBlock
     withMainThreadCallback:(AsynchronousWorkManagerBlock)callbackBlock
{
    NSBlockOperation *blockOperation = [NSBlockOperation blockOperationWithBlock:backgroundBlock];
    blockOperation.completionBlock = ^{ [[NSOperationQueue mainQueue] addOperationWithBlock:callbackBlock]; };

    [self.operationQueue addOperation:blockOperation];
}

@end 
```

我不完全确定这是多么必要，但由于它可以在没有太多代码的情况下完成，我认为它可能是值得的，而不仅仅是过度工程的练习。如果您的应用程序广泛使用不同的优先级队列或更专业的 GCD 功能，我会谨慎使用此功能，因为可能会在没有真正获得任何底层实现灵活性的情况下引入泄漏抽象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T04:54:21.137

我通常定义这两个函数。它们使代码更紧凑，并遵循我在您不想阻塞主线程的地方使用的模式（因此 RUN_ON_BACKGROUND_THREAD 调用是异步的）但是可以阻塞后台线程以更新主线程（因此RUN_ON_UI_THREAD) 调用是同步的。如果调用是从主线程调用的，它还允许直接执行调用，从而避免死锁。

```
void RUN_ON_UI_THREAD(dispatch_block_t block)
{
    if ([NSThread isMainThread])
        block();
    else
        dispatch_sync(dispatch_get_main_queue(), block);
}

void RUN_ON_BACKGROUND_THREAD(dispatch_block_t block)
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), block);
} 
```

# spring - 为什么我的 AspectJ Advice 会被执行两次？

> ID：14824515
> 
> 赞同：2
> 
> 时间：2013-02-12T02:30:05.970
> 
> 标签：spring, testng, aspectj

我的建议正在正确执行并执行正确的操作，但执行两次。我希望它只执行一次。应该触发建议的方法仅执行一次，因为 startTestSuite 标题仅在日志中打印一次。Bean 和上下文是在 TestNG 类中生成的。我尝试在 initSpring() 方法上使用 @BeforeClass 和 @BeforeSuite 标签运行它，结果相同。
进一步的上下文：这样做的目的是获取测试套件何时开始和结束的时间戳，并获取各个测试开始和结束的时间戳。最终，我将捕获测试失败时的堆栈跟踪，以便我们可以构建测试自动化问题最多的模式，并使我们能够将精力集中在需要修复的更重要的自动化领域，而不是解决琐碎的事情。

日志文件

```
[INFO] 2013-02-11 17:56:07.646-0800 test.ui.tests.BVT.initSpring: context object instantiated
[INFO] 2013-02-11 17:56:07.647-0800 test.ui.tests.BVT.initSpring: Shutdown hook registered
[INFO] 2013-02-11 17:56:07.647-0800 test.ui.tests.BVT.initSpring: Obtained a Instrumentation proxy
[INFO] 2013-02-11 17:56:07.661-0800 instrumentation.dao.implement.TestSuiteDaoImpl.beforeTestSuite: ***************Running Advice: beforeTestSuite: startTestSuite
[INFO] 2013-02-11 17:56:07.948-0800 instrumentation.dao.implement.TestSuiteDaoImpl.beforeTestSuite: ***************Running Advice: beforeTestSuite: startTestSuite
[INFO] 2013-02-11 17:56:07.952-0800 test.ui.tests.InstrumentationImpl.startTestSuite: Going to print the title: startTestSuite
[INFO] 2013-02-11 17:56:07.952-0800 test.ui.helpers.TitleLogger.testTitle: ********************
[INFO] 2013-02-11 17:56:07.952-0800 test.ui.helpers.TitleLogger.testTitle: ** startTestSuite **
[INFO] 2013-02-11 17:56:07.953-0800 test.ui.helpers.TitleLogger.testTitle: ********************
[INFO] 2013-02-11 17:56:07.953-0800 test.ui.tests.BVT.initSpring: Called the Proxy 
```

测试NG类

```
public class BVT extends SeleniumTest {    
@BeforeSuite
        public void initSpring() {
            titleLog.testTitle("initSpring");
            context = new FileSystemXmlApplicationContext(new String[]{"spring-beans.xml"});
            Assert.assertNotNull(context, "Unable to load spring-beans.xml");
            logger.info("context object instantiated");
            context.registerShutdownHook();
            logger.info("Shutdown hook registered");
            instrument = (Instrumentation) context.getBean("InstrumentationProxy");
            Assert.assertNotNull(instrument, "Unable to create a Instrumentation Proxy");
            logger.info("Obtained a Instrumentation proxy");
            instrument.startTestSuite();
            logger.info("Called the Proxy");
        }
} 
```

代理接口

```
public interface Instrumentation {
    public void startTestSuite();
} 
```

称为代理方法

```
@Override
    public void startTestSuite() {
        logger.info("Going to print the title: startTestSuite");
        titleLog.testTitle("startTestSuite");   
    } 
```

建议

```
@Override
    @Before("execution(void test.ui.tests.InstrumentationImpl.startTestSuite())")
    public void beforeTestSuite(JoinPoint jp) {
        logger.info("***************Running Advice: " + jp.getSignature().getName());
        DateTimeHelper dth = new DateTimeHelper();
        TestSuite ts = new TestSuite();

        //Get the current time
        Timestamp start = dth.getCurrentSqlTimestamp();

        //Update the object with the starting time
        ts.setTestSuiteStart(start);

        //Commit to the database
        saveTestSuite(ts);  
    } 
```

spring-beans.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/aop 
        http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd">
    <context:component-scan base-package="instrumentation.dao.implement" />
    <context:annotation-config />
    <aop:aspectj-autoproxy /> 

    <bean id="basicDS" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="${driver}" />
        <property name="username" value="${username}" />
        <property name="password" value="${password}" />
        <property name="url" value="${url}" />
    </bean>
    <bean
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="file:datasource.properties" />
    </bean>
    <bean id="testSuite" class="instrumentation.dao.implement.TestSuiteDaoImpl" autowire="constructor" />
    <bean id="Instrumentation" class="test.ui.tests.InstrumentationImpl" />
    <bean id="InstrumentationProxy" 
                 class="org.springframework.aop.framework.ProxyFactoryBean">
        <aop:scoped-proxy proxy-target-class="false"/>
        <property name="target" ref="Instrumentation" />
    </bean> 
```

更新：我将切入点更改为此（Insturmentation vs InstrumentationImpl），它触发了四次。

```
 @Before("execution(void test.ui.tests.Instrumentation.startTestSuite())") 
```

这是添加了 jp.getTarget().toString() 的日志。

```
[INFO] 2013-02-13 14:51:30.258-0800 amazon.omaha.test.ui.tests.BVT.initSpring: context object instantiated
[INFO] 2013-02-13 14:51:30.259-0800 amazon.omaha.test.ui.tests.BVT.initSpring: Shutdown hook registered
[INFO] 2013-02-13 14:51:30.270-0800 amazon.omaha.test.ui.tests.BVT.initSpring: Obtained a Instrumentation proxy
[INFO] 2013-02-13 14:51:30.276-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: *************************************************
[INFO] 2013-02-13 14:51:30.276-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ** afterTestSuite Advice Method startTestSuite **
[INFO] 2013-02-13 14:51:30.276-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: *************************************************
[INFO] 2013-02-13 14:51:30.276-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ***********************************************************
[INFO] 2013-02-13 14:51:30.277-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ** amazon.omaha.test.ui.tests.InstrumentationImpl@cb754f **
[INFO] 2013-02-13 14:51:30.278-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ***********************************************************
[INFO] 2013-02-13 14:51:30.573-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: *************************************************
[INFO] 2013-02-13 14:51:30.575-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ** afterTestSuite Advice Method startTestSuite **
[INFO] 2013-02-13 14:51:30.575-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: *************************************************
[INFO] 2013-02-13 14:51:30.576-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ***********************************************************
[INFO] 2013-02-13 14:51:30.576-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ** amazon.omaha.test.ui.tests.InstrumentationImpl@cb754f **
[INFO] 2013-02-13 14:51:30.576-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ***********************************************************
[INFO] 2013-02-13 14:51:30.581-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ********************
[INFO] 2013-02-13 14:51:30.582-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ** startTestSuite **
[INFO] 2013-02-13 14:51:30.582-0800 amazon.omaha.test.ui.helpers.TitleLogger.testTitle: ********************
[INFO] 2013-02-13 14:51:30.582-0800 amazon.omaha.test.ui.tests.BVT.initSpring: Called the Proxy 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-12T23:49:35.440

如果没有更多上下文，很难说这里发生了什么，但我猜你的方面不知何故被注册了两次。

# javascript - 将变量传递给 Javascript

> ID：14824516
> 
> 赞同：0
> 
> 时间：2013-02-12T02:30:10.250
> 
> 标签：javascript, html

所以我是一个 Javascript 新手，在弄清楚如何将变量从我的 HTML 模板传递给 Javascript 时遇到了麻烦。

我想将用户输入的搜索查询传递给 javascript。

这是我获取搜索查询的模板。

```
<form class="well-whatsnext form-search" style="text-align:center; border-radius:10px 10px 10px 10px; width:900px; height:0px;background-repeat:no-repeat;margin-bottom:100px;"  action="/search/?q="> 
<center>
 <input type="text" id = "form-search" value="Search for Stuff" class="input-xxlarge search-query" style="margin: 30px 0px 0px 70px; height:50px;width:600px;font-size:20px;vertical-align:middle;text-align:center;border-radius:10px 0px 0px 10px;float:left;border-right:0px;color:grey;border-right:0px;" name="q">
</center>
<br>
</form> 
```

这是我的 Javascript 片段：

```
$("#form-search").click(function() {
    // This sends us an event every time a user clicks the button
    mixpanel.track('MainSearch', {'query' : search-query, 'url' : window.location.pathname});
}); 
```

很明显，这`search-query`不是引用查询的正确方法，因为我没有得到我想要的正确输出。

如何捕获用户搜索的查询变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:32:05.240

用于`$('.search-query').val()`获取具有该类名的输入元素的值：

```
{ 'query' : $('.search-query').val() ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T02:36:56.777

尽可能使用纯 JavaScript。

```
{'query': document.getElementById('form-search').value} 
```

# jquery - jQuery从父母的父母中选择一个孩子

> ID：14824519
> 
> 赞同：0
> 
> 时间：2013-02-12T02:30:22.543
> 
> 标签：jquery

我有这个我刚刚建立的自定义菜单：

```
<div class="select_input_wrap">
    <div class="select_input_wrap_left">
        <input class="select_input" type="text" id="search_topics" autocomplete="off" spellcheck="false">
    </div>
    <div class="select_input_wrap_right"></div>
    <div class="clear"></div>
    <div class="select_input_menu" id="search_topics_menu">
        <ul class="custom_select_menu">
            <li>Option 1Option 1Option 1Option 1Option 1Option 1Option 1</li>
            <li>Option 2</li>
            <li>Option 3</li>
            <li>Option 1</li>
            <li>Option 2</li>
            <li>Option 3</li>
            <li>Option 1</li>
            <li>Option 2</li>
            <li>Option 3</li>
            <li>Option 1</li>
            <li>Option 2</li>
            <li>Option 3</li>
            <li>Option 1</li>
            <li>Option 2</li>
            <li>Option 3</li>
        </ul>
    </div>
</div> 
```

当有人单击 时`<li>`，我想从其中抓取文本并将其放置在位于`<li>`. 这不是我页面上唯一的菜单，因此使用`$(this)`，否则就像将`.text()`in 放入某个类或 id 的输入字段一样简单。

我一直在尝试这样的东西：

```
$('.custom_select_menu li').click(function() {
    //$(this).closest('.select_input').val($(this).text());
    //$(this).closest('.select_input_wrap').children('input').val($(this).text());
}); 
```

但我就是无法到达那里。请有人可以解释如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:32:57.017

你在正确的轨道上，但`children`只选择所选元素的子元素，而不是后代，你可以使用`find`方法来代替。

```
$('.custom_select_menu li').click(function() {
    $(this).closest('.select_input_wrap').find('input').val($(this).text());
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:37:39.223

这需要一些解释：

当您单击您的 LI 时，处理程序函数将在 LI 的上下文中执行。

所以，$(this) 指的是嵌入你的 LI 的 jQuery 对象。

第一的：

```
$(this).closest('.select_input').val($(this).text()); 
```

将不起作用，因为您`.select_input`不是祖先的一部分-实际上这是您的 li 的父母的父母的兄弟姐妹的孩子:)。`closest()`只搜索祖先的完整行。

第二：

```
$(this).closest('.select_input_wrap').children('input').val($(this).text()); 
```

也不起作用，因为`children()`它只在子级的第一级深处搜索，所以你应该使用`find()`它，这会很好 - 在任何深度递归查找搜索

这就是为什么修改一点你的第二次尝试会起作用的原因：

```
$(this).closest('.select_input_wrap').find('input').val($(this).text()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T02:36:53.947

像这样的东西对你有用吗？

```
$('.custom_select_menu li').click(function() {
    var field = $(this).parents('.select_input_wrap').find('.select_input');
    field.val($(this).text());
}); 
```

演示：http: [//jsfiddle.net/ZKnQh/](http://jsfiddle.net/ZKnQh/)

# python - 使用 python 动态地将 matplotlib 图像提供给网络

> ID：14824522
> 
> 赞同：23
> 
> 时间：2013-02-12T02:31:13.397
> 
> 标签：python, matplotlib, cgi

[在这里](https://stackoverflow.com/questions/5515278/plot-matplotlib-on-the-web)以类似的方式提出了这个问题，但答案超出了我的想象（我对 python 和 Web 开发非常陌生），所以我希望有一种更简单的方法，或者可以用不同的方式来解释。

我正在尝试使用 matplotlib 生成图像并提供它，而无需先将文件写入服务器。我的代码可能有点傻，但它是这样的：

```
import cgi
import matplotlib.pyplot as pyplot
import cStringIO #I think I will need this but not sure how to use

...a bunch of matplotlib stuff happens....
pyplot.savefig('test.png')

print "Content-type: text/html\n"
print """<html><body>
...a bunch of text and html here...
<img src="test.png"></img>
...more text and html...
</body></html>
""" 
```

我认为我应该创建一个 cstringIO 对象，然后执行以下操作，而不是执行 pyplot.savefig('test.png')：

```
mybuffer=cStringIO.StringIO()
pyplot.savefig(mybuffer, format="png") 
```

但我从那里迷路了。我见过的所有例子（例如[http://lost-theory.org/python/dynamicimg.html](http://lost-theory.org/python/dynamicimg.html)）都涉及到类似的事情

```
print "Content-type: image/png\n" 
```

而且我不知道如何将它与我已经输出的 HTML 集成。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-12T11:03:13.123

你应该

*   首先写入一个 cStringIO 对象
*   然后写HTTP头
*   然后将 cStringIO 的内容写入标准输出

因此，如果发生错误`savefig`，您仍然可以返回其他内容，甚至是另一个标题。一些错误不会被更早地识别出来，例如，文本的一些问题、图像尺寸过大等。

你需要告诉`savefig`在哪里写输出。你可以做：

```
format = "png"
sio = cStringIO.StringIO()
pyplot.savefig(sio, format=format)
print "Content-Type: image/%s\n" % format
msvcrt.setmode(sys.stdout.fileno(), os.O_BINARY) # Needed this on windows, IIS
sys.stdout.write(sio.getvalue()) 
```

如果要将图像嵌入 HTML：

```
print "Content-Type: text/html\n"
print """<html><body>
...a bunch of text and html here...
<img src="data:image/png;base64,%s"/>
...more text and html...
</body></html>""" % sio.getvalue().encode("base64").strip() 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-06-01T12:56:54.553

上面的答案有点过时了——这就是我在 Python3+ 上获取图形数据的原始字节的方法。

```
import matplotlib.pyplot as plt
from io import BytesIO
fig = plt.figure()
plt.plot(range(10))
figdata = BytesIO()
fig.savefig(figdata, format='png') 
```

如其他答案所述，您现在需要将“Content-Type”标头设置为“image/png”并写出字节。

根据您使用的网络服务器，代码可能会有所不同。我使用 Tornado 作为我的网络服务器，执行此操作的代码是：

```
self.set_header('Content-Type', 'image/png')
self.write(figdata.getvalue()) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-10T18:40:39.730

python3对我有用的是：

```
buf = io.BytesIO()
plt.savefig(buf, format='png')
image_base64 = base64.b64encode(buf.getvalue()).decode('utf-8').replace('\n', '')
buf.close() 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-12T10:53:43.640

我的第一个问题是：图像是否经常变化？你想保留旧的吗？如果它是实时的，那么您对优化的追求是合理的。否则，动态生成图像的好处并不是那么显着。

目前的代码需要 2 个请求：

1.  获取您已有的 html 源代码
2.  获取实际图像

可能最简单的方法（将网络请求保持在最低限度）是@Alex L 的评论，它允许您通过构建一个嵌入了图像的 HTML 来在单个请求中完成它。

您的代码将类似于：

```
# Build your matplotlib image in a iostring here
# ......
#

# Initialise the base64 string
#
imgStr = "data:image/png;base64,"

imgStr += base64.b64encode(mybuffer)

print "Content-type: text/html\n"
print """<html><body>
# ...a bunch of text and html here...
    <img src="%s"></img>
#...more text and html...
    </body></html>
""" % imgStr 
```

这段代码可能不会开箱即用，但显示了这个想法。

请注意，如果您的图像没有真正经常更改或生成它需要很长时间，这通常是一个坏主意，因为它每次*都会生成。*

另一种方法是生成原始 html。加载它将触发对“test.png”的请求。您可以通过您已经提到的缓冲区流解决方案或从静态文件单独提供该服务。

就个人而言，我会坚持使用解耦的解决方案：通过另一个进程生成图像（确保始终有可用的图像）并使用非常轻量级的东西来生成和提供 HTML。

高温下，

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-12T02:46:34.003

除非我严重误解了您的问题，否则您需要做的就是 cd 到图像的位置并运行： python -m SimpleHTTPServer 8000 &

然后打开浏览器，`http://localhost:8000/`在 URL 栏中输入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-03T00:50:18.603

我知道我在这里聚会有点晚了，但我遇到了同样的问题，最后得到了下面的小脚本。

这个 python 3.6+ 代码：

*   启动一个 Web 服务器并告诉您在哪里查看它
*   扫描自身以查找以“plot_”开头的类方法，并为浏览器提供绘图列表
*   对于单击的绘图，提示输入所需的参数（如果有），包括自动刷新周期（以秒为单位）
*   执行情节并刷新

从代码中可以看出，临时诊断和监控（在我的例子中是机器学习进度）故意最小化。

您可能需要安装任何依赖项（plac + 绘图所需的任何其他库，例如我使用 pandas、matplotlib）

您可以通过双击（无参数）或命令行（带/不带参数）运行文件

**代码：**

```
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import io
from http.server import HTTPServer,BaseHTTPRequestHandler
import urllib
import inspect

class PlotRequestHandler(BaseHTTPRequestHandler):

    def do_GET(self):
        args = urllib.parse.parse_qs(self.path[2:])
        args = {i:args[i][0] for i in args}
        html = ''

        if 'mode' not in args:
            plots = ''
            for member in dir(self):
                if member[:5] == 'plot_':
                    plots += f'<a href="http://{self.server.server_name}:{self.server.server_port}/?mode=paramcheck&graph={member}">{member[5:].replace("_"," ").title()}</a><br/>\n'
            html = f'''<html><body><h1>Available Plots</h1>{plots}</body></html>'''

        elif args['mode'] == 'paramcheck':
            plotargs = inspect.getargspec(getattr(self,args['graph'])).args
            if len(plotargs) == 1 and plotargs[0].lower()=='self':
                args['mode'] = 'plotpage'
            else:
                for arg in plotargs:
                    if arg.lower() != 'self':
                        html += f"<input name='{arg}' placeholder='{arg}' value='' /><br />\n"
                html = f"<html><body><h1>Parameters:</h1><form method='GET'>{html}<input name='refresh_every' value='60' />(Refresh in sec)<br /><input type='hidden' name='mode' value='plotpage'/><input type='hidden' name='graph' value='{args['graph']}'/><input type='submit' value='Plot!'/></form></body></html>"

        if 'mode' in args and args['mode'] == 'plotpage':
            html = f'''<html><head><meta http-equiv="refresh" content="{args['refresh_every']};URL=\'http://{self.server.server_name}:{self.server.server_port}{self.path}\'" /></head>
                       <body><img src="http://{self.server.server_name}:{self.server.server_port}{self.path.replace('plotpage','plot')}" /></body>'''

        elif 'mode' in args and args['mode'] == 'plot':
            try:
                plt = getattr(self,args['graph'])(*tuple((args[arg] for arg in inspect.getargspec(getattr(self,args['graph'])).args if arg in args)))
                self.send_response(200)
                self.send_header('Content-type', 'image/png')
                self.end_headers()
                plt.savefig(self.wfile, format='png')
            except Exception as e:
                html = f"<html><body><h1>Error:</h1>{e}</body></html>"

        if html != '':
            self.send_response(200)
            self.send_header('Content-type', 'text/html')
            self.end_headers()
            self.wfile.write(bytes(html,'utf-8'))

    def plot_convergence(self, file_path, sheet_name=None):
        if sheet_name == None:
            data = pd.read_csv(file_path)
        else:
            data = pd.read_excel(file_path, sheet_name)

        fig, ax1 = plt.subplots()

        ax1.set_xlabel('Iteration')
        ax1.set_ylabel('LOSS', color='tab:red')
        ax1.set_ylim([0,1000])
        ax1.plot(data.iteration, data.loss, color='tab:red')

        ax2 = ax1.twinx()

        ax2.set_ylabel('Precision, Recall, f Score')
        ax2.set_ylim([0,1])
        ax2.plot(data.iteration, data.precision, color='tab:blue')
        ax2.plot(data.iteration, data.recall, color='tab:green')
        ax2.plot(data.iteration, data['f-score'], color='tab:orange')

        fig.tight_layout()
        plt.legend(loc=6)
        return plt

def main(server_port:"Port to serve on."=9999,server_address:"Local server name."=''):
    httpd = HTTPServer((server_address, server_port), PlotRequestHandler)
    print(f'Serving on http://{httpd.server_name}:{httpd.server_port} ...')
    httpd.serve_forever()

if __name__ == '__main__':
    import plac; plac.call(main) 
```

# jquery - 隐藏和显示嵌套的 div？

> ID：14824523
> 
> 赞同：0
> 
> 时间：2013-02-12T02:31:27.233
> 
> 标签：jquery, function, parent-child, html

我一直在为一些次要的 html / jquery 逻辑而苦苦挣扎。

我将 Divs 称为“工作”，在其中有一个画廊。

```
<div class="work">
        <span class="workTitle">A Work</span>
        <div class="gallery" style="" >
            <img src="images/works/01.jpg" width="200" height="200" /> 
            <img src="images/works/01.jpg" width="200" height="200" /> 
            <img src="images/works/01.jpg" width="200" height="200" /> 
            <img src="images/works/01.jpg" width="200" height="200" /> 
        </div>
    </div> 
```

当我点击一个作品时，它们的高度和边距在 jquery 中通过切换类来改变：

```
work.click(function() {

    work.removeClass("on");
    $(this).addClass("on");
}); 
```

但问题是，当我尝试在我的“工作”div 中添加画廊 div 时，我希望它们被隐藏并且它们的“封闭”高度不会被扭曲。

当我单击“已打开”“工作”项目时，我还想再次关闭“打开”类。但是 ToggleClass 让每一件作品都自己打开，而不是一件一件地关闭。

最后一个问题是，我如何为高度设置动画？我得到了一个特定的值，但它只是为边距参数设置动画。

提前致谢！

梅丁。

* * *

还有为什么它没有任何想法？

```
$(".work").click(function () {
    openWork($(this));
});

function openWork($) {
    $.animate({ marginLeft: openMargin }, 500, 'swing', function() {
        // completion handler
        $.animate({ height: workHeight }, 500, function () {
            closeWorks($(".work").not($(this)));
        });
    });
}

function closeWorks($) {
    $.animate({ height: '100%' }, 500, 'swing', function() {
        $.animate({ marginLeft: closedMargin }, 500, 'swing', function() {});
}); 
```

我试图将您的 jq_array 想法划分为函数。开放工程（）；看起来不错，但 closeWorks(); 只是不工作...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:39:43.943

嗯......我会拆分你的问题，因为有太多不同的部分。无论如何，我的一点：

> 当我单击“已打开”“工作”项目时，我还想再次关闭“打开”类。但是 ToggleClass 让每一件作品都自己打开，而不是一件一件地关闭。

```
$(".work").click(function() {
    jq_array = $(".work").not($(this));   //all the others
    jq_array.removeClass("on");           //close any other, if open
    $(this).toggleClass("on");            //open or close the clicked one
}); 
```

然后：

> 最后一个问题是，我如何为高度设置动画？我得到了一个特定的值，但它只是为边距参数设置动画。

```
var height_sttring = "200px";   // craft the height string

$('#selector').animate(
    { height: height_sttring }, //this is an hash, can contain more keys
    1000,                       // how many milliseconds
    function() {
    // completion handler
    }
); 
```

> 但问题是，当我尝试在我的“工作”div 中添加画廊 div 时，我希望它们被隐藏并且它们的“封闭”高度不会被扭曲。

无法理解您的意思，对不起..
**编辑** 尝试：

```
.work {
    position: relative;
}
.work > .gallery {
    display: none;
    position: absolute;     // this way it will no more occupy "physical" space in the DOM.
    bottom: 10px;           // of course you can adjust this.
}
.work.on > .gallery {
    display: block;
} 
```

这应该可行，尽管您应该进行一些实验以使其适合您的动画时间。我会先扩展父级`div.work`，然后淡入内部`div.gallery`。

# haskell - 为什么 GHC 打印 15 元组而不打印 16 元组？

> ID：14824524
> 
> 赞同：6
> 
> 时间：2013-02-12T02:31:36.193
> 
> 标签：haskell

为什么这行得通

```
print (True, True, True, True, True, True, True, True, True, True, True, True, True, True, True) 
```

虽然这不是

```
print (True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T02:44:20.867

因为有`Show`15 元组的实例：

```
Prelude> :i (,,,,,,,,,,,,,,)
data (,,,,,,,,,,,,,,) a b c d e f g h i j k l m n o
  = (,,,,,,,,,,,,,,) a b c d e f g h i j k l m n o
    -- Defined in `GHC.Tuple'
<<skip>>
instance (Read a, Read b, Read c, Read d, Read e, Read f, Read g,
          Read h, Read i, Read j, Read k, Read l, Read m, Read n, Read o) =>
         Read (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o)
  -- Defined in `GHC.Read'
instance (Show a, Show b, Show c, Show d, Show e, Show f, Show g,
          Show h, Show i, Show j, Show k, Show l, Show m, Show n, Show o) =>
         Show (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o)
  -- Defined in `GHC.Show' 
```

并且没有 16 元组：

```
Prelude> :i (,,,,,,,,,,,,,,,)
data (,,,,,,,,,,,,,,,) a b c d e f g h i j k l m n o p
  = (,,,,,,,,,,,,,,,) a b c d e f g h i j k l m n o p
    -- Defined in `GHC.Tuple' 
```

查看[文档](http://www.haskell.org/ghc/docs/latest/html/libraries/base-4.6.0.1/Text-Show.html)

AFAIK 实例是在 ghc 内部库中的某处手写的，不太可能有人需要显示 16 元组。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-12T07:07:47.163

这在 Haskell 报告[第 6.1.4 节元组](http://www.haskell.org/onlinereport/basic.html#basic-tuples)中定义：

> 元组的大小没有上限，但一些 Haskell 实现可能会限制元组的大小，并限制与较大元组关联的实例。然而，每个 Haskell 实现都必须支持最大为 15 的元组，以及 Eq、Ord、Bounded、Read 和 Show 的实例。Prelude 和库定义元组函数，例如 zip 用于最大为 7 的元组。

# javascript - javascript打开和关闭当前窗口

> ID：14824532
> 
> 赞同：3
> 
> 时间：2013-02-12T02:32:50.747
> 
> 标签：javascript, browser-history

我的工作是为受虐妇女建立一些网站。他们请求了一个“Escape”按钮以快速离开页面，以防他们进入。

他们给我的示例要么是普通链接（您可以在其中单击“返回”并返回上一页），要么是带有弹出窗口和新窗口的复杂解决方案，但仍会导致简单的“返回”以查看它们所在的位置。就个人而言，我认为这两个都不是一个好主意。我已经搜索并尝试了几种关闭当前窗口并打开另一个窗口的方法，但我无法找到适用于主要浏览器的解决方案。如果有人知道如何做到这一点，或者对如何解决他们的问题有更好的想法，我将不胜感激。

这篇文章（[Html javascript to open new window and close current window](https://stackoverflow.com/questions/3681178/html-javascript-to-open-new-window-and-close-current-window)）在 chrome 中工作，但不幸的是我需要它至少在 IE、Firefox 和 Chrome 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:38:22.643

你可以看看[捕鼠器](http://craig.is/killing/mice)。它使键绑定相对简单。使用它，您可以执行以下操作：

```
Mousetrap.bind('esc', function(e) {
    window.location.history.back();
    // Or alternatively, window.close() to just close the window
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:38:23.067

也许试试这个：

<a href="javascript:window.opener='x';window.close();">关闭</a>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T02:13:12.147

在我们几个人（和互联网）之间，我们找不到他们正在寻找的一个很好的解决方案。在与客户进行了更多讨论后，我们同意制作一个指向中性页面的标准链接，但包括关于其在线安全的免责声明以及如何进行隐私浏览的链接。它不像我们任何人希望的那样优雅，但它是迄今为止我们最好的解决方案。

感谢您的建议，有些人有一些很好的承诺，但没有完全得到客户想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T02:42:12.657

据我所知，没有完全跨浏览器兼容的方式来关闭当前窗口。我建议做的只是`Esc`导航到其他网站或页面。您可以在您的网站上创建一个页面，显示来自 Google 新闻或其他内容的随机文章，或者您可以直接去那里。除非您的网站被调用`battered-women.com`或其他东西，否则它可能会达到与完全关闭窗口相同的效果。

```
document.addEventListener('keydown', function (e) {
    var key = e.keyCode ? e.keyCode : e.which;
    if (key == '27') {
        //destroy all visible content in case new page takes a long time to load
        document.getElementsByTagName('body').innerHTML = '';
        window.location = 'http://news.google.com/';
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T02:43:59.747

使用 JavaScript 将整个页面替换为空白 div 怎么样？需要更改页面的解决方案的问题是您无法控制网络延迟。从页面中删除所有内容将是您完全控制的事情。

下面的解决方案仅显示一个具有 100% 高度和宽度的 div，其位置固定，隐藏了页面上的任何内容。当页面隐藏时，您可以安全地更改位置，而无需担心加载时间。

```
<div id="HideMe" style="display: none; position: fixed; width: 100%; height: 100%; background-color: #fff">&nbsp;</div>
<a href="#" id="escape">Escape!</a> 
```

和

```
$("#escape").on("click",function(){
    $("#HideMe").show();
    location.href = "/*New URL*/";
}); 
```

[http://jsfiddle.net/ySq8L/](http://jsfiddle.net/ySq8L/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T02:39:53.350

不会使用`window.location.replace`做的伎俩？

[http://jsfiddle.net/atesgoral/xS3q5/](http://jsfiddle.net/atesgoral/xS3q5/)

单击浏览器的后退按钮不会返回上一页，因为历史记录将被覆盖。

# ruby-on-rails - Rails 将数据发送到 csv

> ID：14824534
> 
> 赞同：0
> 
> 时间：2013-02-12T02:33:25.553
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我在一个模块中有一个方法，它生成一个名为 to_csv 的 csv 文件。

我的控制器动作：

```
def download_csv
    @rating = RatingSet.find(params[:rating_set_id])
    rating_id = @rating.id
     respond_to do |format|
                format.csv { send_data @rating.to_cvs(rating_id) }
  end
end 
```

我的路线：

```
download_csv_co_view_rating_index GET  /co_view_rating/download_csv(.:format)     co_view_rating#download_csv 
```

我的观点：

```
<small><%=link_to "Download CSV Data", :controller => "co_view_rating", :action => "download_csv", :rating_set_id => rating.id %></small> 
```

当我点击链接时，链接将打开：

> co_view_rating/download_csv?rating_set_id=6

但什么也没有发生。我错过了什么/做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:39:06.123

您需要将格式类型传递给您的 link_to 助手：

```
<%= link_to "Download CSV Data", url_path(:format => :csv), ... %> 
```

### 更新

如果您还需要包含参数，请执行以下操作：

```
<%= link_to "Download CSV Data", url_path(params.merge(format: "csv")), ... %> 
```

# python - 是否可以在 python 中创建一个类似于 bash 的 shell，即：Bash 替换？

> ID：14824538
> 
> 赞同：2
> 
> 时间：2013-02-12T02:33:49.900
> 
> 标签：python, bash, shell, replace

我想知道是否可以在 python 中创建一个 bash 替换。我以前做过 REPL，知道子进程和类似的东西，但想知道如何在 OSX 终端中使用我的类似 python 的 bash 替换，就好像是一个本地 shell 环境（有限制）。

或者只是按原样运行 ipython ......

PD 大多数谷歌答案都与创建 shell*脚本*有关。我有兴趣创建*一个外壳*..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:39:11.883

这当然是可能的——查看[hotwire](https://code.google.com/p/hotwire-shell/)以获得用 python 编写的 shell 的一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:40:00.577

是的当然。您可以简单地制作一个可执行的 Python 脚本，调用它`/usr/bin/pysh`，将此文件名添加到`/etc/shells`，然后将其设置为用户的默认登录 shell，使用`chsh`.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-10-13T05:41:55.617

我不是要打广告，而是自己写一个开源的，纯粹用 Python。你可以在这里查看：[Project Shell](https://github.com/GenericError/Project-Shell)

所以**是**的，这绝对是可能的，尽管对于用 Python 编写的需要大量数字运算的命令可能会有一些性能影响。

# sqlalchemy - 为什么 column.in_ 在 SQL 中变成 '='？

> ID：14824548
> 
> 赞同：1
> 
> 时间：2013-02-12T02:35:48.197
> 
> 标签：sqlalchemy

```
Query(State).filter(State.c.abbr.in_(stateList)).all() 
```

SQLError: (TypeError) 字符串格式化期间并非所有参数都转换 u'SELECT states.abbr AS states_abbr \nFROM states \nWHERE **states.abbr = %s** ORDER BY states.abbr' [['AL', 'AZ', 'WY' , 'AB', 'BC', 'MB', 'NB']]

我认为 in_ 应该转换为 WHERE ... IN 子句...？

我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T04:14:35.933

尝试打印`stateList`. 确保这`stateList`是一个字符串列表，而不是其他东西——比如列表列表。

另一件要检查的事情 - 什么样的对象`State`是？它是表还是映射对象。如果它是映射对象，您可以使用`State.abbr.in_()`.

# c# - 不从数据库中检索数据

> ID：14824549
> 
> 赞同：1
> 
> 时间：2013-02-12T02:35:48.677
> 
> 标签：c#, oledb

我已经尝试构建并运行此代码，但它总是向我发送错误：'因为未从数据库中检索数据。

我的代码在构建后没有错误。我一直在搜索，但我看不出有什么问题。

我希望我能为这种情况找到一些答案。谢谢

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.OleDb;

namespace WindowsFormsApplication1
{

    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {    
        }

        private void listView1_SelectedIndexChanged(object sender, EventArgs e)
        {        
        }

        private void button1_Click(object sender, EventArgs e)
        {

            string ProviderName = null;
            string CatalogName = null;
            string DataSourceName = null;
            string ConnectionString = null;
            string CommandString = null;
            const int MaxRows = 100;

            ProviderName = "Provider=Something;";
            CatalogName = "Catalog=Something;";
            DataSourceName = "DataSource=Something";

            ConnectionString = ProviderName+CatalogName+DataSourceName;

            ////////////////////////////////////////////////////////////////////////////////

            CommandString = "Something";

            OleDbConnection DBConnection = null;
            try
            {
                DBConnection = new OleDbConnection(ConnectionString);
            }catch (Exception ex){

            MessageBox.Show("Error: Not connected. \n{0}", ex.Message);
                return;
            }

            try
            {
                OleDbCommand DBCommand = new OleDbCommand(CommandString, DBConnection);
                DBConnection.Open();

                OleDbDataReader DBReader = DBCommand.ExecuteReader();

                    /////////////////////////////////////////////////////////////////////////

                DateTime DBTimestamp = new System.DateTime();
                Double DBValue = new System.Double();
                int DBQualityCode;
                int DBFlags;
                String ColumnEntry;

                listView1.View = View.Details;
                listView1.GridLines = true;
                listView1.TabIndex = 0;
                listView1.Width = 400;

                listView1.Columns.Add(new ColumnHeader());
                listView1.Columns[0].Text = ("Timestamp");
                listView1.Columns[0].TextAlign = (HorizontalAlignment.Center);
                listView1.Columns[0].Width = 150;

                listView1.Columns.Add(new ColumnHeader());
                listView1.Columns[1].Text = ("Value");
                listView1.Columns[1].TextAlign = (HorizontalAlignment.Center);
                listView1.Columns[1].Width = 60;

                listView1.Columns.Add(new ColumnHeader());
                listView1.Columns[2].Text = ("Quality Code");
                listView1.Columns[2].TextAlign = (HorizontalAlignment.Center);
                listView1.Columns[2].Width = 60;

                listView1.Columns.Add(new ColumnHeader());
                listView1.Columns[3].Text = ("Flags");
                listView1.Columns[3].TextAlign = (HorizontalAlignment.Center);
                listView1.Columns[3].Width = 60;

                ListViewItem SingleRow;

                int count = 0;

                //////////////////////////////////////////////////////////////////////////

               while ((DBReader.Read() && (count < MaxRows)))
                {
                    DBTimestamp = DBReader.GetDateTime(1);
                    DBValue = DBReader.GetDouble(2);
                    DBQualityCode = DBReader.GetInt32(3);
                    DBFlags = DBReader.GetInt32(4);

                    //////////////////////////////////////

                    ColumnEntry = String.Format("{0:dd.MM.yy HH:mm:ss}{1:D2}", DBTimestamp, DBTimestamp.Millisecond);
                    SingleRow = new ListViewItem(ColumnEntry);

                    ColumnEntry = String.Format("{0:F}", DBValue);
                    SingleRow.SubItems.Add(ColumnEntry);

                    ColumnEntry = String.Format("{0:X2}", DBQualityCode);
                    SingleRow.SubItems.Add(ColumnEntry);

                    ColumnEntry = String.Format("{0:X4}", DBFlags);
                    SingleRow.SubItems.Add(ColumnEntry);

                    listView1.Items.Add(SingleRow);

                    count = count + 1;
               }
               DBReader.Close();
            }
            catch (Exception ex)
            {

                MessageBox.Show("Error:Failed to retrive Data From Database. \n{0}", ex.Message);
            }
            finally
            {

                DBConnection.Close();

            }    
                //////////////////////////////////////////////////

        }
    }
} 
```

# java - 在 Java 中使用 MySQL 日期+时间

> ID：14824550
> 
> 赞同：-6
> 
> 时间：2013-02-12T02:35:50.120
> 
> 标签：java, mysql, database, datetime

是否有任何 Java 库或类可以轻松使用 MySQL 日期时间字段？

例如，将采用 MySQL 日期格式的字符串并返回 Java 日期对象的东西？

如果不是，以 MySQL 日期时间以外的格式存储日期/时间是否更好，以便更容易在 Java 中使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:38:06.910

我建议您使用 SimpleDateFormat 类。您将需要弄清楚日期如何存储在 MySQL 中并相应地使用该模式。

有关详细信息，请阅读[http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)。

# ruby-on-rails - 在控制器中渲染 JSON

> ID：14824551
> 
> 赞同：114
> 
> 时间：2013-02-12T02:35:58.353
> 
> 标签：ruby-on-rails, json, ruby-on-rails-3.2

我正在阅读一本书，并且在关于控制器的章节中谈到渲染内容时，对于 JSON，它有一个这样的示例，但没有详细说明，所以我无法弄清楚这个示例适合的更大图景：

```
render :json => @projects, :include => tasks 
```

还有一些将 JSONP 与回调函数一起使用的示例：

```
render :json => @record, :callback => 'updateRecordDisplay' 
```

有人可以解释这些吗？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-02-12T02:53:48.923

您通常会返回[JSON](http://json.org/)，因为：

A) 您正在将部分/全部应用程序构建为单页应用程序 (SPA)，并且您需要客户端 JavaScript 能够在不完全重新加载页面的情况下提取额外数据。

*或者*

B) 您正在构建一个第三方将使用的 API，并且您已决定使用 JSON 来序列化您的数据。

[或者，可能，你正在吃你自己的狗粮并且*两者都做*]

在这两种情况下`render :json => some_data`，都会对提供的数据进行 JSON 化。第二个示例中的`:callback`关键需要更多解释（见下文），但它是同一想法的另一种变体（以 JavaScript 可以轻松处理的方式返回数据。）

### 为什么`:callback`？

JSONP（第二个示例）是一种绕过[同源策略](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript)的方法，该策略是每个浏览器内置安全性的一部分。如果您有您的 API，`api.yoursite.com`并且您将通过 JavaScript 为您的应用程序提供服务，`services.yoursite.com`那么（默认情况下）将无法从 to 发出（`XMLHttpRequest`XHR - aka ajax）请求。人们一直在绕过这个限制的方式（在[跨域资源共享规范最终确定之前](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)）是通过从服务器发送 JSON 数据，*就好像它是 JavaScript 而不是 JSON 一样*）。因此，而不是发回：`services``api`

 *```
{"name": "John", "age": 45} 
```

服务器反而会发回：

```
valueOfCallbackHere({"name": "John", "age": 45}) 
```

因此，客户端 JS 应用程序可以创建一个`script`指向的标记，`api.yoursite.com/your/endpoint?name=John`并使用*来自其他来源的数据*`valueOfCallbackHere`调用函数（必须在客户端 JS 中定义）。）

 ** * *

## 回答 #2

> 赞同：74
> 
> 时间：2013-02-12T02:53:11.687

你到底想知道什么？ActiveRecord 具有将记录序列化为 JSON 的方法。例如，打开您的 rails 控制台并输入`ModelName.all.to_json`，您将看到 JSON 输出。`render :json`本质上调用`to_json`并使用正确的标头将结果返回给浏览器。这对于您希望返回 JavaScript 对象以供使用的 JavaScript 中的 AJAX 调用很有用。此外，您可以使用该`callback`选项指定要通过 JSONP 调用的回调的名称。

例如，假设我们有一个`User`看起来像这样的模型：`{name: 'Max', email:' m@m.com'}`

我们还有一个如下所示的控制器：

```
class UsersController < ApplicationController
    def show
        @user = User.find(params[:id])
        render json: @user
    end
end 
```

现在，如果我们像这样使用 jQuery 进行 AJAX 调用：

```
$.ajax({
    type: "GET",
    url: "/users/5",
    dataType: "json",
    success: function(data){
        alert(data.name) // Will alert Max
    }        
}); 
```

如您所见，我们设法从 Rails 应用程序中获取 ID 为 5 的用户，并在我们的 JavaScript 代码中使用它，因为它是作为 JSON 对象返回的。回调选项只是调用以 JSON 对象作为第一个也是唯一的参数传递的命名的 JavaScript 函数。

要给出该`callback`选项的示例，请查看以下内容：

```
class UsersController < ApplicationController
    def show
        @user = User.find(params[:id])
        render json: @user, callback: "testFunction"
    end
end 
```

现在我们可以创建一个 JSONP 请求，如下所示：

```
function testFunction(data) {
    alert(data.name); // Will alert Max
};

var script = document.createElement("script");
script.src = "/users/5";

document.getElementsByTagName("head")[0].appendChild(script); 
```

使用此类回调的动机通常是为了规避限制跨源资源共享 (CORS) 的浏览器保护措施。然而，JSONP 不再使用那么多了，因为存在其他更安全、更容易绕过 CORS 的技术。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-02-12T02:52:10.003

例如

```
render :json => @projects, :include => :tasks 
```

您声明要呈现`@projects`为 JSON，并将`tasks`Project 模型上的关联包含在导出的数据中。

例如

```
render :json => @projects, :callback => 'updateRecordDisplay' 
```

您说您想呈现`@projects`为 JSON，并将该数据包装在一个 javascript 调用中，该调用将呈现如下：

```
updateRecordDisplay({'projects' => []}) 
```

这允许将数据发送到父窗口并绕过跨站点伪造问题。**

# c - 增加 C 的打印屏幕的宽度？

> ID：14824552
> 
> 赞同：0
> 
> 时间：2013-02-12T02:35:59.960
> 
> 标签：c

我们的输出出现在 C 中的屏幕是 8 个制表位宽。是否有任何技巧可以增加 C 的打印屏幕的宽度？如果有必要，我正在 windows 上的 codeblocks IDE 上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T02:46:08.793

C 编程语言和库本身没有打印屏幕。它们将输出发送到流。例如，在函数的情况下`printf`，有一个名为 stdout 的默认输出流，它会回显到您的终端，因此以下两个调用是等效的：

```
 printf( "hi!\n" );
 fprintf( stdout, "hi!\n" ); 
```

流的一行输出由换行符 ( `\n`) 分隔。（但由于您在 Windows 上，您可能需要以 结束行`\r\n`，特别是如果您有时将输出重定向到文本文件。请参见[此处](http://en.wikipedia.org/wiki/Newline)。）

因此，我认为您的问题实际上是关于如何控制终端在自动换行（或截断）之前将打印的字符数。（也许您的终端将如何处理选项卡？）这将取决于您正在运行的硬件、操作系统和外壳，但如果您使用的是 unix 样式外壳， [Termcap可能是您想要开始的地方。](http://en.wikipedia.org/wiki/Termcap)如果您使用的是 windows`CMD.EXE`窗口，则可以通过“属性菜单”的“布局”选项卡访问一些设置，该选项卡可通过菜单栏左上角的窗口菜单图标访问；这将让您设置屏幕缓冲区宽度，从而控制长行是否会换行或导致水平滚动条。

# c# - 无法弄清楚控件失去焦点的原因

> ID：14824553
> 
> 赞同：0
> 
> 时间：2013-02-12T02:36:01.200
> 
> 标签：c#, wpf, focus

我在每个单元格中创建了一个带有可编辑文本块的自定义网格控件。编辑是通过双击触发的，如下所示：

```
void TextBlock_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
{
    if (e.ClickCount == 2) Edit();
}

public void Edit()
{
    TextBox.Text = TextBlock.Text;
    TextBlock.Visibility = System.Windows.Visibility.Collapsed;
    TextBox.Visibility = System.Windows.Visibility.Visible;
    Dispatcher.BeginInvoke((ThreadStart)delegate
    {
        TextBox.Focus();
        TextBox.SelectAll();
    });
} 
```

这部分按预期工作。

我想让用户能够通过按标签前进或移动标签返回来切换到下一个单元格。我添加了一个触发事件，如下所示：

```
void TextBox_KeyDown(object sender, System.Windows.Input.KeyEventArgs e)
{
    if (e.Key == System.Windows.Input.Key.Tab)
    {
        e.Handled = true;
        OnTab(System.Windows.Input.Keyboard.IsKeyDown(System.Windows.Input.Key.LeftShift) || System.Windows.Input.Keyboard.IsKeyDown(System.Windows.Input.Key.RightShift));
    }
} 
```

`Edit()`外部网格处理此事件并在下一个或上一个可编辑单元格上调用该方法。*只要我实际上没有在文本框中输入，*这几乎可以按预期工作。出于某种原因，如果我输入了任何内容，则 LostFocus 事件不仅会针对当前单元格（在`Edit()`调用`Focus()`文本框后预期）而且还会针对下一个单元格触发。这是 LostFocus 事件的代码。（虽然我很确定这不相关。）

```
void TextBox_LostFocus(object sender, RoutedEventArgs e)
{
    bool TextChanged = TextBox.Text != TextBlock.Text;
    TextBlock.Text = TextBox.Text;
    TextBlock.Visibility = System.Windows.Visibility.Visible;
    TextBox.Visibility = System.Windows.Visibility.Collapsed;
    if (TextChanged) OnTextChanged();
} 
```

我可以创建某种奇特的门来让文本框忽略此事件，但我更好奇它为什么会触发，或者至少我如何才能找到答案。

谢谢。

**编辑：**

所以很明显，即使有一些门控，我仍然很兴奋。我添加了一个名为的布尔值`Editing`并更改了该`Edit()`方法以使其像这样工作：

```
public void Edit()
{

    TextBox.Text = TextBlock.Text;
    TextBlock.Visibility = System.Windows.Visibility.Collapsed;
    TextBox.Visibility = System.Windows.Visibility.Visible;

    Thread Task = new Thread(() =>
    {
        Editing = true;
        Dispatcher.BeginInvoke((ThreadStart)delegate
        {
            System.Windows.Input.Keyboard.Focus(TextBox);
            TextBox.SelectAll();
            EditGate.Set();
        });
        EditGate.WaitOne();
        Editing = false;
    });
    Task.Start();
} 
```

然后更改了 LostFocus 处理程序：

```
void TextBox_LostFocus(object sender, RoutedEventArgs e)
{
    if (Editing) return;

    // ... Some more code.
} 
```

不幸的是，这也不起作用。事情最终是这样的：

1.  当前单元格：编辑开始为假
2.  当前单元格：Tab 事件触发
3.  下一个单元格：调用 Edit()
4.  下一个单元格：编辑设置为 True
5.  下一个单元格：调用 EditGate.WaitOne()
6.  下一个单元格：Keyboard.Focus() 调用
7.  当前单元格：焦点丢失（编辑仍然是错误的）
8.  下一个单元格：Textbox.SelectAll() 调用
9.  下一个单元格：调用 EditGate.Set()
10.  下一个单元格：编辑设置为 False
11.  下一个单元格：失去焦点（编辑现在是错误的）

我不确定为什么 LostFocus 事件会在其他所有事件*之后*触发。它几乎就像它知道我要做什么一样。:P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:50:52.003

我认为这可能是由于`KeyboardFocus`，在 WPF 中，您可以设置“逻辑”焦点，`KeyboardFocus`这只是一个猜测，但是当您在 TextBox 中键入时，正在获取`KeyBoardFocus`可能会改变逻辑焦点状态的内容。

我有点难以测试，但尝试在`Edit()`方法中设置键盘焦点，看看会发生什么。

```
public void Edit()
{
    TextBox.Text = TextBlock.Text;
    TextBlock.Visibility = System.Windows.Visibility.Collapsed;
    TextBox.Visibility = System.Windows.Visibility.Visible;
    Dispatcher.BeginInvoke((ThreadStart)delegate
    {
        Keyboard.Focus(TextBox);
        TextBox.SelectAll();
    });
} 
```

我一直在从后面的代码中操作 WPF 焦点时遇到问题，我猜是因为这不是它的设计工作方式，使用 Xaml 触发器对焦点进行排序可能会更好（如果可能的话）

也许 FocusManager 类可能会有所帮助，在这里您可以添加删除当前/下一个项目的焦点处理程序，

```
 FocusManager.RemoveLostFocusHandler(TextBox, TextBox_LostFocus);
 FocusManager.AddLostFocusHandler(TextBox, TextBox_LostFocus); 
```

# windows-phone-8 - 如何在 WP8 中找到所选的语音语言

> ID：14824556
> 
> 赞同：0
> 
> 时间：2013-02-12T02:37:03.927
> 
> 标签：windows-phone-8, locale, text-to-speech

WP8 中有没有办法确定

*   选择的语音语言
*   用户选择的语言环境信息

在将 SpeechSynthesizer 类用于 Text to Speech 时，我想使用最合适的语言

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:42:13.207

默认情况下阅读[MSDN 文档](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj207057%28v=vs.105%29.aspx)，`SpeechSynthesizer`该类将默认用户在设置中选择的任何内容。

> 创建 Windows.Phone.Speech.Synthesis.SpeechSynthesizer 对象后，您可以指定要加载的语音的语言。Windows.Phone.Speech.Synthesis.SpeechSynthesizer 实例可以加载安装在手机上的任何语音并使用它来生成语音。如果未指定语言，API 将加载与用户在手机设置/语音中选择的语言相匹配的语音。

# c - 结构内部相同的结构类型？

> ID：14824563
> 
> 赞同：0
> 
> 时间：2013-02-12T02:37:44.000
> 
> 标签：c, struct

我怎样才能拥有包含自身类型的结构。

```
struct node { struct node *nodes[MAX]; int ID; };

struct node *node1, *node2;
node1 = (struct node*) malloc(sizeof(struct node));
node2 = (struct node*) malloc(sizeof(struct node));
node1->ID = 1;
node2->ID = 2;
node1->nodes[0] = node2;
node2->nodes[0] = node1; 
```

没有错误，但程序无法正确执行。

编辑：我添加了更多我的代码。

最终：创建无限递归是我的错误。我将继续删除此威胁。很抱歉您花费了这么多时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T02:39:23.397

*那是因为您正在存储一个指向该结构的指针*数组。那是完全不同的。

您不能在其内部拥有相同的结构。那将是一个无限递归的定义。

现在，如果您想展示更多您的程序，我们或许可以帮助您了解为什么您的程序没有按您预期的方式运行。您可能没有初始化指针，因为对它们到底是什么感到困惑。

**[编辑]**现在您已经发布了一些代码，并且忽略了您没有确切说明出了什么问题，我希望您在检查图形时尝试遍历整个指针列表，但您从未初始化它。

当你`malloc`，内存将未初始化。C 中的标准做法是`calloc`改用它将所有字节设置为零。由于您似乎将`nodes`数组用作列表，因此您可能希望向`num_edges`节点添加一个字段并创建一个函数以在两个节点上进行双向连接。

```
struct node {
    int num_edges;
    struct node *nodes[MAX];
};

int join( struct node *a, struct node *b )
{
    if( a->num_edges >= MAX || b->num_edges >= MAX ) return 0;
    a->nodes[a->num_edges++] = b;
    b->nodes[b->num_edges++] = a;
    return 1;
} 
```

您还可以测试是否有这样的`a`优势`b`：

```
int has_edge( struct node *a, struct node *b )
{
    int i;
    for( i = 0; i < a->num_edges; i++ ) {
        if( a->nodes[i] == b ) return 1;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T02:40:31.807

您的代码是完全有效的 - 在结构中具有*指向*相同结构的指针是可以的。

# zend-framework2 - 扩展 ZfcUser 授权

> ID：14824564
> 
> 赞同：0
> 
> 时间：2013-02-12T02:37:45.447
> 
> 标签：zend-framework2, zfcuser

我正在寻找有关如何最好地扩展 zfcuser 以包含除用户名/电子邮件和密码之外的第三个身份验证属性的方向和/或指导。

我希望添加一个“域”字段以包含在身份验证中。

我已经想出了如何使用自定义实体将属性添加到用户对象（和 orm 映射）并将其添加到登录表单，但我需要进行身份验证才能使用第三个字段以及用户名/电子邮件和密码并且可用在设定的身份中。

对此的任何指导表示赞赏。

# android - PhoneGap - 只显示有电话号码的联系人

> ID：14824571
> 
> 赞同：9
> 
> 时间：2013-02-12T02:38:59.963
> 
> 标签：android, cordova, contacts

有没有办法只显示有电话号码的联系人？

现在我正在获取所有联系人，然后遍历每个联系人并找出他们的电话号码，但我想知道是否有办法将参数传递给`contactFindOptions`对象，以便它只获取具有电话号码的联系人？

这就是我的代码当前的样子：

```
var options = new ContactFindOptions();
options.filter=""; //Can i pass something here to pick only contacts with phone number
options.multiple=true; 
var fields = ["displayName", "phoneNumbers"];
navigator.contacts.find(fields, onSuccess, onError, options);

function onSuccess(contacts) {
    for (var i=0; i<contacts.length; i++) {
        console.log("Display Name = " + contacts[i].displayName);
        if(null != contacts[i].phoneNumbers)
            {
                for(var j=0;j<contacts[i].phoneNumbers.length;j++)
                {
                      console.log("Name = " + contacts[i].displayName);
                      console.log("Phone = " + contacts[i].phoneNumber[j].value);

                }
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-16T21:33:33.513

这个插件看起来是最好的方法：[https](https://github.com/dbaq/cordova-plugin-contacts-phone-numbers) ://github.com/dbaq/cordova-plugin-contacts-phone-numbers 。

它只搜索带有电话号码的联系人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-12T17:58:04.637

是的，我们可以使用**hasPhoneNumber**过滤器选项。代码片段如下：

```
 var contactFindOptions = new ContactFindOptions();
            contactFindOptions.filter = "";
            contactFindOptions.multiple = true;
            contactFindOptions.hasPhoneNumber = true;
            navigator.contacts.find(
                    ["phoneNumbers"],
                    function (contacts) {
                       // you will get contacts in this callback success function
                    },
                    function (e) {
                        if (e.code === ContactError.NOT_SUPPORTED_ERROR) {
                           console.log("Searching for contacts is not supported.");
                        } else {
                            console.log("Search failed: error " + e.code);
                        }
                    },
                    contactFindOptions); 
```

**注意： hasPhoneNumber（仅限 Android）：过滤搜索以仅返回通知了电话号码的联系人。（布尔值）（默认值：假）**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T23:19:10.410

我相信 Cordova API 不允许过滤来完成你所需要的。

从他们这里的文档：http: [//docs.phonegap.com/en/2.5.0/cordova_contacts_contacts.md.html#contacts.find](http://docs.phonegap.com/en/2.5.0/cordova_contacts_contacts.md.html#contacts.find)

它说：

在查询联系人数据库时，contactFindOptions.filter 字符串可用作搜索过滤器。如果提供，则对contactFields 参数中指定的每个字段应用不区分大小写的部分值匹配。如果在与任何指定字段的比较中找到匹配项，则返回联系人。

我不相信您可以使用它来确定电话号码字段的非空值。

# html - 将表格分成 2 列

> ID：14824579
> 
> 赞同：0
> 
> 时间：2013-02-12T02:39:48.500
> 
> 标签：html, css, twitter-bootstrap

我想要做的是将以下表格分成两列，垂直分隔线将两列分开，但似乎无法弄清楚。

这是[我希望它看起来像的图像](http://i.imgur.com/uUJf7rb.png)。

**HTML：**

```
<div class="container">  
  <form class="form-large">
    <!-- THIS FORM NEEDS TO BE SPLIT IN 2 COLUMNS SUCH THAT I CAN PUT CONTENT IN BOTH -->   
  </form>
</div> 
```

**CSS：**

```
.form-large {
    max-width: 884px;
    padding: 15px 15px 10px;
    margin: 0 auto 20px;
    background-color: #fff;
    border: 1px solid #d6d6d6;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
    -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
    box-shadow: 0 1px 2px rgba(0,0,0,.05);
} 
```

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:47:02.190

只需添加一个左右 div`display: inline-block`并设置宽度：

[http://jsfiddle.net/ExplosionPIlls/eGjPa/](http://jsfiddle.net/ExplosionPIlls/eGjPa/)

您已要求提供确切的宽度，因此如果您想防止包装，只需放在`white-space: nowrap`表格上即可。否则，使用百分比宽度或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T16:36:34.650

制作一个像素 1px X 2px .. 并应用它具有垂直背景

```
.form-large { 
    ...
    background:transparent url(1pxX2pximage.img) repeat-y scroll 0 584px;
    ...
} 
```

# filter - 过滤后如何在剑道 ui 网格上显示水平滚动条？

> ID：14824585
> 
> 赞同：6
> 
> 时间：2013-02-12T02:40:01.490
> 
> 标签：filter, grid, kendo-ui

我有一个包含许多列的剑道 UI 网格。溢出的列可以通过水平滚动来查看。但是，如果你

1) 滚动到最初未显示的列，然后

2) 对该列进行过滤，以使没有符合过滤条件的行

网格将不再允许水平滚动。应用了过滤器的列无法清除。

过滤后如何显示水平滚动条？

这是一个jsfiddle，您可以在其中看到问题

[http://jsfiddle.net/9sxkG/1/](http://jsfiddle.net/9sxkG/1/)

这是代码：

```
var dataItem = {};
var columns = [];

for (var i = 0; i < 20; i++) {
    dataItem['col' + i] = i;
    columns.push( {
        field: 'col' + i,
        width: 80,
        filterable: true,
        type: 'number'
    } );
}

$("#grid").kendoGrid({
    scrollable:true,
    columns: columns,
    filterable: true,
    dataSource: [dataItem]
}); 
```

例如，转到第 18 列并过滤等于 20 以查看问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T14:24:05.447

我有同样的问题，我解决了它在网格中添加一个空行。
代码：

```
var dataItem = {};
var columns = [];

for (var i = 0; i < 20; i++) {
  dataItem['col' + i] = i;
  columns.push( {
    field: 'col' + i,
    width: 80,
      filterable: true,
      type: 'number'
  } );
}

$("#grid").kendoGrid({
    scrollable:true,
    columns: columns,
    filterable: true,
    dataSource: [dataItem],
    dataBound: function(e) {  
        if(this.dataSource.view().length == 0) {
             var colspan = this.content.find("table col").length;
             this.content.find("table").append("<tr><td colspan=" + colspan + "></td></tr>");
        }
        $("#grid").find(".k-grid-footer-wrap").scrollLeft($("#grid").find(".k-grid-content").scrollLeft());        
        this.content.bind('scroll', function () {
            $("#grid").find(".k-grid-footer-wrap").scrollLeft(this.scrollLeft);
        });
    }
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T00:14:45.380

基于 Trey Gramman 添加*清除过滤器*按钮的方法：

```
$("#grid").kendoGrid({
    scrollable: true,
    columns   : columns,
    filterable: true,
    toolbar   : [
        {
            name      : "clean_filter",
            imageClass: "k-icon k-i-funnel-clear",
            text      : "clean filter"
        }
    ],
    dataSource: [dataItem]
});

$(".k-grid-clean_filter", "#grid").on("click", function (e) {
    $("#grid").data("kendoGrid").dataSource.filter({});
}); 
```

看到它在[这里](http://jsfiddle.net/9sxkG/3/)运行。

它不能解决滚动标题的问题，但至少允许您继续（如果没有找到更好的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T20:05:38.690

有趣的德利马。我认为您最简单的答案是在网格旁边添加一个按钮以“刷新”网格。以下 javascript 将导致刷新。

```
function LoadAllPositions() {
    $("#grid").data("kendoGrid").dataSource.read();
} 
```

# java - 如何使用 Google File Picker 和基于 Google Drive Java SDK 的 servlet 下载用户选择的文件？

> ID：14824598
> 
> 赞同：0
> 
> 时间：2013-02-12T02:42:48.297
> 
> 标签：java, google-drive-api

我使用 google Filepicker 让用户选择目标文件，然后从浏览器中的选择器中获取文件 ID。我让用户将此 id 发布到我的 servlet，我希望 servlet 下载此文件进行处理。

我正在努力解决如何使用这个 java 代码，如[示例](https://developers.google.com/drive/manage-downloads#downloading_google_documents)中所示。在下面的代码示例中，如何实例化 Drive 和 File？请假设文件 id 已经可以从 Google Picker 获得。

```
private static InputStream downloadFile(Drive service, File file) {
        if (file.getDownloadUrl() != null && file.getDownloadUrl().length() > 0) {
          try {
            HttpResponse resp =
                service.getRequestFactory().buildGetRequest(new GenericUrl(file.getDownloadUrl()))
                    .execute();
            return resp.getContent();
          } catch (IOException e) {
            // An error occurred.
            e.printStackTrace();
            return null;
          }
        } else {
          // The file doesn't have any content stored on Drive.
          return null;
        }
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:59:11.407

Google Drive 文档解释了如何检索 OAuth 2.0 凭据以及如何使用它们来实例化服务对象：

[https://developers.google.com/drive/credentials](https://developers.google.com/drive/credentials)

Picker API 只为您提供已选择文件的 ID。您必须发送`files.get`请求以检索文件元数据，即片段中的 File 对象：

[https://developers.google.com/drive/v2/reference/files/get](https://developers.google.com/drive/v2/reference/files/get)

# html - 由于 wp_head 和 Content-Lang 而无法验证 HTML5 网站

> ID：14824601
> 
> 赞同：2
> 
> 时间：2013-02-12T02:43:20.230
> 
> 标签：html, validation, head, meta

我有 energyshop.se，它是 wordpress 中的一个网上商店，但主题为空白，所以它看起来不像博客。

当我尝试通过 validator.w3.org 验证 html 时，我只有 1 个验证输出错误，它的内容如下：

第 27 行，第 54 列：使用 meta 元素指定文档范围的默认语言已过时。考虑改为在根元素上指定语言。

但我有这样的头脑和元数据：

```
<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'> 
```

尽管如果我检查页面，这一行稍后会下降，可能会覆盖最上面的页面：

```
<meta http-equiv="Content-Language" content="sv-SE" /> 
```

但它不在我的任何 .php 文件中，但我认为在`<?php wp_head?>`header.php 中

我该如何编辑？因为我试图删除它，但是我需要的 header.php 中的其他东西消失了。但后来我也得到了一个干净的验证，没有错误！

那么最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T14:06:37.043

是的，这是不正确的 html5 字符编码，当您尝试验证代码时会导致验证错误。见参考：http: [//isobar-idev.github.com/code-standards/#_character_encoding](http://isobar-idev.github.com/code-standards/#_character_encoding)

wp_head() 是 word press 中的“钩子”。您需要深入研究它以根除导致您的页面无法验证的元标记。看到这个：[http ://wordpress.org/support/topic/wp_head-question](http://wordpress.org/support/topic/wp_head-question)

# c++ - 删除 qtabwidget

> ID：14824603
> 
> 赞同：0
> 
> 时间：2013-02-12T02:43:52.787
> 
> 标签：c++, qt4.8, qtabwidget

我的程序不断崩溃，返回码为 0。原因在我的 qtabwidget 中，但我找不到错误。

```
 QTabWidget *layout_tabs;

// create tabs
void myclass::fill_tabs(void)
{
  kill_tabs(); // remove old tabs 
  layout_tabs = new QTabWidget();

  // program adds content into a few tabs, like:
  // widgets created, content created, put into layout, put into widget..
  layout_tabs->addTab(widget, "description");
  layout_tabs->addTab(widget2, "description2");

  layout_tabs->show();
}

void myclass::kill_tabs(void)
{
  if(layout_tabs==nullptr)
    return;
  layout_tabs->hide();

  QWidget *window;

  for ( int i=layout_tabs->count()-1; i>=0; --i)
    {
        window = layout_tabs->widget(i); // remember widget
        layout_tabs->removeTab(i); // remove tab
        free(window); // remove widget
    }

  free(layout_tabs); // remove qtabwidget
  layout_tabs=nullptr;
} 
```

filltabs() 函数被使用了几次。旧的 tabwidget 被销毁，新的 tabwidget 被创建。如果我不删除选项卡小部件，但只删除选项卡，这并不重要。程序仍然以返回码 0 退出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T22:22:32.777

你打电话`free(layout_tabs)`，但你用`operator new()`. 您应该`delete layout_tabs`改为取消分配它。我看不到你的`window`变量是如何分配的，但你应该检查它是否也应该被释放`operator delete()`，或者你是否`QTabWidget`拥有它的内存（即它是否负责管理该内存）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:57:49.767

设置`QApplication::quitOnLastWindowClosed`为假。

```
#include <QApplication>

// ...

qApp->setQuitOnLastWindowClosed (false); 
```

或者，您可以将选项卡（主窗口/主窗口小部件）的容器设置为将属性`Qt::WA_QuitOnClose`设置为 false。

```
myWidget->setAttribute(Qt::WA_QuitOnClose, false); 
```

其中任何一个都应该解决它。以“0”返回也不是崩溃。零通常表示正常退出。

[http://qt-project.org/doc/qt-4.8/qapplication.html#quitOnLastWindowClosed-prop](http://qt-project.org/doc/qt-4.8/qapplication.html#quitOnLastWindowClosed-prop)

[http://qt-project.org/doc/qt-4.8/qt.html#WidgetAttribute-enum](http://qt-project.org/doc/qt-4.8/qt.html#WidgetAttribute-enum)

# iphone - 如何在不创建引用插座的情况下访问静态 TableViewcells 中的文本字段？

> ID：14824608
> 
> 赞同：-1
> 
> 时间：2013-02-12T02:44:41.347
> 
> 标签：iphone, ios, uitableview, uitextfield, iboutlet

我有很多文本字段静态放置在静态 TableViewcells 中。如何在不为每个文本字段创建引用出口的情况下访问其中的文本？我尝试过对单元格进行子视图。它不工作。有什么选择吗？

我试过这个。它不工作。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

UITableViewCell *cell = [super tableView:tableView
                   cellForRowAtIndexPath:indexPath];
     for (UIView *subview in [cell subviews]){
        if([subview isKindOfClass:[UITextField class]]){
            UITextField *inputField = (UITextField *)subview;
            NSLog(@"%@",inputField.text);
        }
     }

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:15:34.690

您可以使用 IBOutletCollection。这使您可以将它们全部连接到一个数组，您可以在其中通过索引访问它们，或使用 setValue:forKey: 一次解决它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:47:50.717

您始终可以遍历单元格的每个子视图以找到`UITextField`. 就像是：

```
NSArray *subviews = [cell subviews];
for (view in subviews) {
    if([view isKindOfClass:[UITextField class]]) {
        //Do what you want with your UITextField
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T03:59:54.210

跟着这些步骤：

1.  设置`tag`为您的`textField`：

    ```
    textField.tag = kTextFieldTag; 
    ```

2.  `subView`用`cell`那个检索`tag`

    ```
    UITextField *refTextField = [cell viewWithTag:kTextFieldTag]; 
    ```

在这里，`kTextFieldTag`是恒定的。

# python - 子类unittest不继承父类的属性

> ID：14824609
> 
> 赞同：0
> 
> 时间：2013-02-12T02:44:45.360
> 
> 标签：python, unit-testing, inheritance

```
# parent
class Parent(unittest.TestCase):
   @classemthod
   def setUpClass(cls):
      cls.attr1 = '123'

# real test
class TestMe(Parent):

   @classmethod
   def setUpClass(cls):
      cls.attr2 = '456'
      super(Parent, cls).setUpClass() 
```

但是如果我们尝试访问`attr1`from `TestMe`，解释器会说该属性不存在。

我也尝试添加`__init__`但`TestMe`没有帮助。

知道为什么我不能这样做吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-03T20:37:08.763

您没有`super`按预期使用。你要求父类的超类，所以你最终调用了`unittest.setUpClass`，这当然什么都不做。

将其更改为

```
@classmethod
def setUpClass(cls):
    super(TestMe, cls).setUpClass() 
```

# xaml - 使用单独的 .xaml 文件来使用 WP8 应用程序中的资源

> ID：14824613
> 
> 赞同：4
> 
> 时间：2013-02-12T02:45:42.677
> 
> 标签：xaml, windows-phone-8

我想使用外部文件来自定义我的应用程序的样式，但它不起作用。我正在[逐步](http://windowsphonegeek.com/articles/windows-phone-7-mango-implicit-styles)执行此操作，但是当我执行项目时，异常属于：

> **System.Windows.ni.dll 中出现“System.Windows.Markup.XamlParseException”类型的第一次机会异常**

我的 XAML 代码：

应用程序.xaml：

```
<Application.Resources>
    <local:LocalizedStrings xmlns:local="clr-namespace:App1" x:Key="LocalizedStrings"/>
    <ResourceDictionary x:Key="myDict">
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Resources.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

资源.xaml：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Style TargetType="TextBox" x:Key="MyTextBox">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0.5"/>
        <Setter Property="BorderBrush" Value="Gray"/>
        <Setter Property="Opacity" Value="0.5"/>
        <Setter Property="Foreground" Value="Red"/>
    </Style>

</ResourceDictionary> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T02:57:32.147

尝试将本地资源声明移动`ResourceDictionary`到您正在创建并分配给`Application.Resources`属性的内部：

```
<Application.Resources>
    <ResourceDictionary x:Key="myDict">
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Resources.xaml"/>
        </ResourceDictionary.MergedDictionaries>

        <local:LocalizedStrings xmlns:local="clr-namespace:App1" x:Key="LocalizedStrings"/>
        <!-- other resources in here -->
    </ResourceDictionary>
</Application.Resources> 
```

# selenium - 如何通过 selenium webdriver 单击图像链接？

> ID：14824614
> 
> 赞同：2
> 
> 时间：2013-02-12T02:45:50.463
> 
> 标签：selenium

我有以下html页面源，我尝试通过xpath/cssselector单击图像。没有一个可以工作，你能帮我找到我的代码的问题吗？我用的是IE9。

```
<pretable border="0" cellpadding="0" cellspacing="0" width="700">
      <tr>
         <td rowspan="2" width="120">
          <a href="#" onclick="oCMenu.m['top1'].b.moveIt(8,60); oCMenu.showsub('top1'); " 
            onclick="return false" class="FontNormal">
           <img border="0" src="images/shim.gif" width="112" height="73"></a></td>  
       </tr>
  </pretable> 
```

我的代码是：

```
 ieDriver.findElement(By.xpath("//html/table/tr[1]/td/a[@class='FontNormal']/img[@src='images
     /shim.gif']")).click();

    ieDriver.findElement(By.cssselector("class='FontNormal'")).click(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-02T05:52:34.730

有了可用的 DOM 结构，我们总是可以使用 CSS 选择器。

CSS 选择器

```
css=a[href='images/shim.gif']
css=a[href*='shim.gif'] 
```

然后执行

```
driver.findElement(By.cssSelector("a[href='images/shim.gif']")).click(); 
```

或者

```
driver.findElement(By.cssSelector("a[href*='shim.gif']")).click(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:33:09.077

您正在尝试提供完整的 xpath，但它与您提供的 html 不匹配。

'table' 与 'pretable' 不同，无论如何您都不需要提供完整路径。相反，只需为您的 xpath 试试这个：

```
XPath("//a[@class='FontNormal']") 
```

在这里，xpath 将搜索**任何**附加了“FontNormal”类的链接。如果只有一个，这将选择您的元素。如果还有更多，您可能需要更具体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-02T18:16:10.690

首先编写正确的 xpath 以识别您要执行点击操作的 web 元素

```
 driver.findElement(By.Xpath("//img[@ src='images/shim.gif']")).click(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-11T15:22:29.863

```
element(By.xpath('//html/table/tr[1]/td/a[@class='FontNormal']/img[@src='images
     /shim.gif']')).click(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-26T02:02:23.163

将[Firebug](https://addons.mozilla.org/en-us/firefox/addon/firebug/)与[Firepath 一起](https://addons.mozilla.org/en-us/firefox/addon/firepath/)用于 Mozilla Firefox。这将自动为您生成 xpath。

```
Webelement element = driver.findElement(By.xpath("*xpath here*");
element.click(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-23T06:01:41.257

使用 xpath 点击图片链接。

driver.findElement(By.xpath("//img[contains(@src,'/static/images/image_name.png')]")).click();

您可以根据图像源更改图像路径。

# ember.js - 获取传递给 Ember.TextField 中 valueBinding 的文本值（ember-validations）

> ID：14824617
> 
> 赞同：1
> 
> 时间：2013-02-12T02:46:13.453
> 
> 标签：ember.js

如果父对象无效，我正在编写一个扩展来`Ember.TextField`更改文本字段的类。我正在使用[ember-validations 库](https://github.com/lcoq/ember-validations)对我的 ember-data 对象进行验证。我现在有这个工作，但我希望能够在不传递`validationMethod`变量的情况下做到这一点。如何仅从`valueBinding`视图中获取传入的文本字符串？

**地址.js.coffee**

```
App.Address = DS.Model.extend(Ember.Validations,
  street_1: DS.attr('string')
  street_2: DS.attr('string')
  ...

  validations:
    street_1:
      presence: true
) 
```

**valid_text_field.js.coffee**

```
Ember.ValidatedTextField = Ember.TextField.extend(
  validationMethod: null
  classNameBindings: 'error'

  focusOut: ->
    object = @get('controller').get('content')
    object.validateProperty(@get('validationMethod'))

  error: (->
    object = @get('controller').get('content')
    if object.get("isValid")
      return false
    else
      error_keys = object.get("validationErrors." + @get('validationMethod') + ".keys")
      if error_keys
        return error_keys.length > 0
      else
        return false
  ).property('controller.content.isValid')
) 
```

**编辑.handlebars**

```
{{view Ember.ValidatedTextField validationMethod="street_1" valueBinding="street_1" id="street_1" placeholder="Street 1" required="true"}}
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:54:00.353

虽然我不能建议它，因为它是内部代码，但您可以从绑定本身获取字符串。

```
validationMethod = @get("valueBinding._from").split(".").get("lastObject") 
```

查看我们如何处理 Ember-Bootstrap 的标签以获取另一个示例：[https ://github.com/emberjs-addons/ember-bootstrap/blob/master/packages/ember-bootstrap/lib/forms/field.js](https://github.com/emberjs-addons/ember-bootstrap/blob/master/packages/ember-bootstrap/lib/forms/field.js)

# windows-phone-8 - 你能判断耳机/耳机是否插入WP8

> ID：14824620
> 
> 赞同：9
> 
> 时间：2013-02-12T02:46:57.990
> 
> 标签：windows-phone-8, headphones

是否可以判断耳机是否已插入 Windows Phone 8 设备？我想使用 Text to Speech API，但不想通过扬声器阅读消息

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-04T18:02:23.627

实际上，是的，您可以在 WP8 上使用。这不是一个显而易见的 API，但只要手机运行高于 GDR1 的任何东西，这些人就知道如何做到这一点。

[http://developer.nokia.com/community/wiki/How_to_detect_the_audio_path_(headset_connection)_on_Windows_Phone](http://developer.nokia.com/community/wiki/How_to_detect_the_audio_path_(headset_connection)_on_Windows_Phone)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T02:51:54.263

不，你不能。

查看这些谷歌结果：

1.  [http://answers.microsoft.com/en-us/winphone/forum/wp8-wpmusic/volume-change-and-headphone-detection-in-wp8/c9ddac53-b55b-4aaf-85ef-e208d69c1c0a](http://answers.microsoft.com/en-us/winphone/forum/wp8-wpmusic/volume-change-and-headphone-detection-in-wp8/c9ddac53-b55b-4aaf-85ef-e208d69c1c0a)
2.  [http://social.msdn.microsoft.com/Forums/uk/wpdevelop/thread/7a0766ad-a2c0-4e98-88f8-80e88fa1a175](http://social.msdn.microsoft.com/Forums/uk/wpdevelop/thread/7a0766ad-a2c0-4e98-88f8-80e88fa1a175)

# javascript - 确保不会多次下载相同的 javascript 文件

> ID：14824627
> 
> 赞同：0
> 
> 时间：2013-02-12T02:47:56.877
> 
> 标签：javascript, jquery, requirejs

我正在尝试开发一个可嵌入的小部件。此小部件将一些 UI 元素呈现到客户页面中。

此小部件将如下所示：

```
<script src="//example.com/widget.js?param1=a&param2=b" async></script> 
```

允许用户在单个页面上嵌入多个小部件，每个小部件具有一组不同的参数。

在这个小部件脚本中，我试图加载渲染我的小部件所需的其他 javascript 和 css 文件。

这是我用来加载其他 javascript 文件的函数。

```
function loadScript(scriptUrl) {
    var s = document.createElement('script');
    s.async = true;
    s.src = scriptUrl;
    document.body.appendChild(s);
} 
```

问题在于，当每页有多个嵌入时，以这种方式加载的每个脚本都会加载多次。

如何确保每个文件只加载一次？例如，我尝试在该加载器脚本中加载一个 jQuery 引用，我看到如果我将我的小部件嵌入 5 次，则会有 5 次调用 jquery 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:26:37.203

3 extra lines of code

```
var scripts = {};  //record what is loaded
function loadScript(scriptUrl) {
    if (scripts[scriptUrl]) return;  //exit if loaded
    scripts[scriptUrl] = 1;  //mark that it is loaded
    var s = document.createElement('script');
    s.async = true;
    s.src = scriptUrl;
    document.body.appendChild(s);
} 
```

# java - 划分每个线程以使用特定范围内的 ID

> ID：14824628
> 
> 赞同：2
> 
> 时间：2013-02-12T02:48:03.353
> 
> 标签：java, multithreading

我正在做一个项目，我需要确保每个线程`ID`在特定范围内每次都是唯一的。例如-

如果`number of threads is 2`然后`number of tasks is 10`每个线程将执行 10 个任务。这意味着 2 个线程将执行 20 个任务。

所以我正在寻找这样的东西 -

在上面的例子中，第一个线程应该使用`id between 1 and 10`，第二个线程应该使用`id between 11 and 20`。

另一个例子。所以假设如果我有`3 thread`，`number of tasks as 20`那么第一个线程应该使用 ID between `1 and 20`，第二个线程应该在 between`21 and 40`和第三个线程之间`41 and 60`。

下面是我到目前为止的代码，它的作用是将 id 作为 an`AtomicInteger`并且每次从 1 开始我都会获得唯一的 id。

```
class ThreadTask implements Runnable {
    private final AtomicInteger id;
    private int noOfTasks;

    public ThreadTask(AtomicInteger id2, int noOfTasks) {
        this.id = id2;
        this.noOfTasks = noOfTasks;
    }

    @Override
    public void run() {

        while(noOfTasks > 0) {
            System.out.println(id.getAndIncrement());
              // And use this id for other things.
        noOfTasks--;
         }
    }
}

public class XMPTest {

    public static void main(String[] args) {

        final int noOfThreads = 2;
        final int noOfTasks = 10;

        final AtomicInteger id = new AtomicInteger(1);

        //create thread pool with given size 
        ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

        // queue some tasks 
        for (int i = 0; i < noOfThreads; i++) {
            service.submit(new ThreadTask(id, noOfTasks));
        }
    }
} 
```

我怎样才能限制这一点，使线程 1 应该在之间获得 id，`1 and 10`而第二个线程应该在之间获得 id`11 and 20`

**更新代码：-** 我正在尝试以下代码

```
public static void main(String[] args) {

    final int noOfThreads = 2;
    final int noOfTasks = 10;

    //create thread pool with given size 
    ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

    // queue some tasks 
    for (int i = 0, int nextId = 1; i < noOfThreads; i++, nextId += noOfTasks) {
        service.submit(new ThreadTask(nextId, noOfTasks));
    }
}

class ThreadTask implements Runnable {
    private final int id;
    private int noOfTasks;

    public ThreadTask(int nextId, int noOfTasks) {
        this.id = nextId;
        this.noOfTasks = noOfTasks;
    }

    public void run() {

        for (int i = id; i <= noOfTasks; i++) {
            System.out.println(i);
        }
    }
} 
```

所以对于第一个线程，它打印出 1 - 10 这很好。但是在第二个线程中，nextId 是 11，noOfTasks 是 10，所以我的 for 循环将第二次在 run 方法中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:06:02.390

在启动线程之前，在单线程代码中拆分范围，然后将范围传递给每个线程。

例如：

```
public static void main(String[] args) {

    final int noOfThreads = 2;
    final int noOfTasks = 10;

    //create thread pool with given size 
    ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

    // queue some tasks 
    for (int i = 0, int nextId = 1; i < noOfThreads; i++, nextId += noOfTasks) {
        service.submit(new ThreadTask(nextId, noOfTasks));
    }
}

class ThreadTask implements Runnable {
    private final int id;
    private int noOfTasks;

    public ThreadTask(int nextId, int noOfTasks) {
        this.id = nextId;
        this.noOfTasks = noOfTasks;
    }

    public void run() {

        for (int i = id; i < id + noOfTasks; i++) {
            System.out.println(i);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:03:30.040

您将需要增加 id，因此它不能是最终的。我也不明白为什么需要使用 AtomicInteger，因为 Dispatcher 线程（在这种情况下处理 main 函数的线程）中没有争用。如果您仍然需要使用它，我会这样做。

```
public class XMPTest {

public static void main(String[] args) {

    final int noOfThreads = 2;
    final int noOfTasks = 10;

    AtomicInteger id = new AtomicInteger(1);

    //create thread pool with given size 
    ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

    // queue some tasks 
    for (int i = 0; i < noOfThreads; i++) {
        service.submit(new ThreadTask(id, noOfTasks));
        id.addAndGet(1);
    }
} 
```

}

# java - 如何将输出保存到名为“output.txt”的文件中

> ID：14824629
> 
> 赞同：-2
> 
> 时间：2013-02-12T02:48:02.970
> 
> 标签：java, file-io, io

我从来没有将输出保存到文件中，而且我不知道该怎么做，所以如果有人可以帮助我，那就太棒了。如果需要，代码发布在下面。

代码：

```
import java.util.*;
import java.io.*;

public class Wordcount {

    public static void main(String[] args) {
        int vowels=0;
        int punctuation=0;
        int sentences=0;
        int words=0;
        int lines=0;
        int alphaNumeric=0;

       try{
       //creates scanner that reads file name    
       Scanner input = new Scanner(System.in);
       System.out.println("Enter file name: ");

       //creates file object of file inputted above
       File file = new File(input.nextLine());
       //if statement for when the file is empty
       if (file.length()==0){
           System.out.println("The input file is empty.");
           System.exit(1);
       }
       //scanner made for reading words of file
       Scanner fileReader = new Scanner(file);
       //new scanner is created to specifically assist in counting the 
       //number of lines in the file
       Scanner lineCounter = new Scanner(file);
       //while loop to count the lines
       while (lineCounter.hasNextLine()) {
           lines++;
           lineCounter.nextLine();
       }

       //while loop that is created to examine each word of the file 
       while(fileReader.hasNext()){
           String word = fileReader.next();
           //for loop which examines each character of each word in the file
           //characters are stored in temp variable ch
           for (int i=0; i<word.length();i++){
               char ch= word.charAt(i);
               //checks for vowels
               if(ch=='a'||ch=='e'||ch=='i'||ch=='o'||ch=='u')
                   vowels ++;
               //checks for sentences
               if((ch=='!'||ch=='.'||ch=='?'))
                   sentences ++;
               //checks for alphanumerical character
               if(Character.isLetterOrDigit(ch))
                   alphaNumeric ++;
               //checks for punctuation
               switch(ch){
                   case ',': case '[': case ']': case ':': case '`': case '-':
                   case '!': case '_': case '(': case ')': case '.': case '?':
                   case '"': case ';':
                    punctuation ++;
                    break;

               }    
           }
           //increments the words and then goes back into the loop
           words ++;

       }
       //output
        System.out.println("The number of words in the file name: " + words);
        System.out.println("The number of lines in the file name: " + lines);
        System.out.println("The number of alphanumeric characters "
                + "in the file name: " + alphaNumeric);
        System.out.println("The number of sentences in the file name: "
                + sentences);
        System.out.println("The number of vowels in the file name: " + vowels);
        System.out.println("The number of punctuations in the file name: " 
                + punctuation);

       }catch(FileNotFoundException e){
           e.printStackTrace();
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T02:51:03.797

Unix系统：`java MyClass > output.txt`

# scheme - 评估 Scheme 中的自然对数

> ID：14824632
> 
> 赞同：2
> 
> 时间：2013-02-12T02:48:07.600
> 
> 标签：scheme

e=1/0!+1/1!+1/2!+1/3！……</p>

我写了这样的代码，但无论我输入什么，它都只返回 2.... 你能帮我吗？

```
 (define (fact n)
        (if (= n 0)
            1
            (* n (- n 1))))

    (define (e limit)
            (if (= limit 0)
                1
                (+ (/ 1 (fact limit))  (e (- limit 1))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:16:48.817

过程中有一个错误`fact`：

```
(define (fact n)
  (if (= n 0)
      1
      (* n (fact (- n 1))))) ; you forgot to recursively call `fact` 
```

彻底测试每个程序，一个简单的单元测试就会发现问题出在程序中`fact`而不是在`e`程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T03:23:27.513

请告诉我，这不是你的作业，你只是在修补 Scheme。:)

我没有得到`2`任何输入`e`。`e`对于除此之外的任何输入，我都会得到除零错误`0`。

撇开这些不谈，你在`fact`. 也许括号把你绊倒了，你已经盯着这个太久了：

```
(define (fact n)
    (if (= n 0)
        1
        (* n (- n 1)))) 
```

...应该：

```
(define (fact n)
    (if (= n 0)
        1
        (* n (fact (- n 1))))) 
```

请记住，您不能实现递归函数……没有函数调用自身。

这应该可以解决您的问题。

也许现在 TA 不能这么快地提供帮助，但如果这是为了你的家庭作业，你需要努力将你遇到的问题分解为最简单的元素，以便在更多的编程中生存下来，这只会变得更加困难。特别是在这种情况下，您需要停下来询问是否确实有效，取决于`fact`它`e`是否确实有效，然后发现它没有，然后从那里开始。

# php - 正则表达式 php 解析邮政编码并从字符串中删除

> ID：14824637
> 
> 赞同：-2
> 
> 时间：2013-02-12T02:48:53.843
> 
> 标签：php, regex, zipcode

我有一个正在解析地址的应用程序，并且一直在尝试实现以下正则表达式来从地址中获取美国邮政编码。一旦我抓住它，我想从地址字符串中删除邮政编码，因为邮政编码会干扰获取电话号码。但是，以下不是抓取邮政编码。

```
$string = "John Doe 1234 Main Street Peoria, IL 60601 (555) 555-5555";
function extract_zipcode_from($string){
  preg_match_all("/\b[A-Z]{2}\s+\d{5}(-\d{4})?\b/", $string, $matches);
  return $matches[0];
}
$zip = extract_zipcode_from($string);
$zip = print_r(implode("\n", $zip),true);
$string = str_ireplace($zip,"",$string); 
```

谁能建议如何让它工作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T05:00:25.910

试试这个代码，这会给你电话和拉链，而不用替换任何东西。

**假设 Zip 和 phone 将始终位于字符串的末尾，那么 zip 之后的任何内容都是电话号码。**

```
$string = "John Doe 1234 Main Street Peoria, IL 60601 (555) 555-5555";

preg_match("/(?P<zip>\d{5})(?P<phone>.*)$/",$string,$match);

echo "Zip : ".$match['zip'];
echo "<br>";
echo "Phone : ".$match['phone']; 
```

# rest - Resty-GWT 动态代码生成

> ID：14824641
> 
> 赞同：0
> 
> 时间：2013-02-12T02:49:38.410
> 
> 标签：rest, gwt, dynamic, resty-gwt

我正在使用 resty-gwt 库，想知道是否可以动态使用 JsonEncoderDecoder 接口？

例如。我有一个pojo如下：

```
@JsonTypeInfo(use=Id.CLASS, include=As.PROPERTY, property="class")
 public class MyObject {....} 
```

使用响应中返回的类名：是否可以使用生成器生成接口

```
public interface MyObjectCodec extends JsonEncoderDecoder<MyObject > {} 
```

并以某种方式调用 GWT.create(MyObjectCodec.class) 以便我可以解码对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T11:58:21.953

即使我从未尝试过，我相信你也可以。

从 restyGWT.gwt.xml 中提取

```
 <generate-with class="org.fusesource.restygwt.rebind.RestServiceGenerator">
    <when-type-assignable class="org.fusesource.restygwt.client.RestService" />
  </generate-with>
  <generate-with class="org.fusesource.restygwt.rebind.JsonEncoderDecoderGenerator">
    <when-type-assignable class="org.fusesource.restygwt.client.JsonEncoderDecoder" />
  </generate-with>
  <generate-with class="org.fusesource.restygwt.rebind.DirectRestServiceGenerator">
    <when-type-assignable class="org.fusesource.restygwt.client.DirectRestService" />
  </generate-with> 
```

因此，如果您正在编写 JsonEncoderDecoder，则生成器应该为您生成代码。

您应该能够使用该方法`JSONValue encode(T value)`在 JSONValue 中编码您的对象

我不知道你所说的动态是什么意思，但 IMO 它都是“静态的”，这意味着它并不真正依赖于运行时变量或任何东西。

# doxygen - 如何让 doxygen 使用 C# 命名格式？

> ID：14824644
> 
> 赞同：1
> 
> 时间：2013-02-12T02:50:28.500
> 
> 标签：doxygen

我的项目在 C# 中，我正在使用 doxygen 生成一些文档。我将 INPUT 选项设置为指向所有 *.cs 源文件所在的目录。一切都很好。但是当classes.html索引页面生成时，一些类名（特别是内部类和枚举）出现了C++风格。例如：

类名::枚举值

而它应该是

类名.枚举值

有任何解决这个问题的方法吗？

# php - PHP glob函数匹配目录但不匹配文件

> ID：14824653
> 
> 赞同：0
> 
> 时间：2013-02-12T02:51:39.707
> 
> 标签：php, glob

我正在尝试使用 PHP 函数`glob()`来匹配**目录，而不是文件**。我可以让它匹配使用的所有文件夹`glob('*')`，但它也匹配文件。我可以使用 匹配所有文件`glob(*.*)`，但这不是我想要的。

有没有办法从匹配系统中*减去*参数，或者我应该用它来限制结果？`glob()``preg_match()`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T02:54:04.640

根据[手册](http://php.net/manual/en/function.glob.php)：

> GLOB_ONLYDIR - 仅返回与模式匹配的目录条目

所以那将是：

```
glob('*', GLOB_ONLYDIR) 
```

# c++ - 在插入数组时按名称升序对书籍列表集合进行排序？？？C++

> ID：14824666
> 
> 赞同：0
> 
> 时间：2013-02-12T02:54:15.037
> 
> 标签：c++, arrays, sorting

嗨，我是 C++ 的新手，我正在尝试了解如何在将书单插入数组时按名称升序对它们进行排序。

这是我的代码的一部分，只是插入部分。

```
void insertion()
{
    if (tail < MAX)
    {
        cout << "\nWhat is the name of the book?\n";
        cin.ignore(); 
        cin.getline(BookCollection[tail].title, 1023); 

        cout << "\nWhat is the price?\n";
        cin >> BookCollection[tail].price;
        cin.ignore(); 

        BookCollection[tail].id = tail;

        tail++;
    }
    else
    {
        cout << "\nERROR: Your collection is full. Cannot add new entries.\n";
        cin.ignore(); 
    }
} 
```

# html - 为什么页脚会掩盖内容？

> ID：14824667
> 
> 赞同：0
> 
> 时间：2013-02-12T02:54:16.217
> 
> 标签：html, css

我在这里有一个正在开发的网站：`http://184.173.208.195/~secoast/about/mission`它应该有一个“粘性页脚”，但是为了让阴影正确显示在内容的底部，我不得不稍微修改代码。这样做时，页脚现在出现在长页面内容的底部。

这是粘性页脚的代码：

```
/* Begin Sticky Footer code */
html, body, #wrap       { height: 100%;}
body > #wrap            { height: auto; min-height: 100%; }
#main                   { padding-bottom: 50px; }  /* must be same height as footer 
*/
body.inside #main       { 
    height: 100%;
    margin-top: 5px;
    background: #fff url(../photos/bg_main.png) repeat-y;
    position: relative;
    -webkit-box-shadow: 3px 3px 5px rgba(50, 50, 50, 0.75);
    -moz-box-shadow:    3px 3px 5px rgba(50, 50, 50, 0.75);
    box-shadow:         3px 3px 5px rgba(50, 50, 50, 0.75);
    }

.white-bar-top  { 
    width: 959px; 
    height: 20px; 
    margin-left: 1px;
    background: #fff; 
    margin-top: -10px; 
}

.white-bar-bottom { 
    width: 959px; 
    height: 20px; 
    clear: both;
    background: #fff;
    position: absolute; 
    bottom: 0;  
    left: 1px;
    }   

#footer {
    position: relative;
    width: 100%;
    background-color: #dadfdb;
    margin-top: -50px; /* negative value of footer height */
    height: 50px;
    clear: both; 
} 
```

这是html

```
<!DOCTYPE html>
<html lang="en">
<head>

<!-- Meta Data -->
<meta charset="UTF-8">
<meta name="author" content="SE Coastal Wind Coalition">

<!-- Title -->
<title>Mission | About Us |SE Coastal Window Coalition</title>
<meta name='keywords' content='your, default, keywords, here' />
<meta name='description' content='Your default description here' />
<link rel='canonical' href='http://184.173.208.195/~secoast/about/mission' />
<!-- generated by seo_lite -->

<!-- Styles -->
<link rel="stylesheet" href="http://184.173.208.195/~secoast/css/styles.css?v=1.0">
<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="http://184.173.208.195/~secoast/fancybox/jquery.fancybox.css?v=2.0.6" media="screen" />

<!-- Scripts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<!--[if lt IE 9]>
<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- <script src="http://cloud.github.com/downloads/malsup/cycle/jquery.cycle.all.latest.js"></script> -->
<script src="http://184.173.208.195/~secoast/js/jquery.dropmenu.js"></script>
<script>
$(document).ready(function(){
$("#nav-one").dropmenu({
openAnimation: "size",
closeAnimation: "slide",
openSpeed: 300,
closeSpeed: 200,
closeDelay: 500,
zindex: 1000
});
});
</script>       

<!-- Fancybox -->
<script type="text/javascript" src="fancybox/jquery.fancybox.js?v=2.0.6"></script>

<!-- page-specific scripts -->  
</head>

<body class="inside base-3-col">
<div id="wrap">

<div id="header">

<!-- navigation code goes here -->

</div><!-- end #header -->

<div id="main" class="clearfix">

<img class="banner" src="http://184.173.208.195/~secoast//photos/banner-inside.jpg" alt="banner-inside" width="962" height="125" />
<div id="page-title-banner">
<h2>About the Southeast Coastal Wind Coalition</h2>
</div>
<div class="white-bar-top"></div>
<div id="section-sub-nav"><!-- this only shows on base-3-col pages -->
<ul>
<li><a href="#">Nav One</a></li>
<li><a href="#">Nav Two</a></li>
<li><a href="#">Nav Three</a></li>
<li><a href="#">Nav Four</a></li>
</ul>
</div>

<div id="sidebar-nav" class="clearfix">
<ul>
<li><a class="selected" href="http://184.173.208.195/~secoast/about/mission">Mission</a></li>
<li><a  href="http://184.173.208.195/~secoast/about/members">Members</a></li>
<li><a  href="http://184.173.208.195/~secoast/about/management">Management</a></li>
<li><a  href="http://184.173.208.195/~secoast/about/board-of-directors">Board of Directors</a></li>
<li><a  href="http://184.173.208.195/~secoast/about/state-policy-liaison">State Policy Liaison</a></li>
</ul>
</div>

<div id="main-content">

<h3>Our Mission</h3>

<p>
<img alt="" src="http://184.173.208.195/~secoast/images/uploads/offshoregrande.jpg" style="width: 610px; height: 440px; " /><br />
<span style="font-size:9px;"><span style="font-family:trebuchet ms,helvetica,sans-serif;">PHOTO: COURTESY OF SIEMENS AG @2013\. ALL RIGHTS RESERVED.</span></span></p>
<p>
Page text goes here.</p>

</div><!-- end #content-two-thirds-->
<div class="white-bar-bottom" class="white-bar"></div>
</div><!-- end #main -->
</div><!-- end #wrap -->

<div id="footer">
<div id="footer-content">
<ul id="footer-nav">
<li class="no-icon"><a href="#">Donate</a></li>
<li class="no-icon"><a href="#">Contact</a></li>
<li><a class="social facebook" href="#">Facebook</a></li>
<li><a class="social twitter" href="#">Twitter</a></li>
<li><a class="social linkedin" href="#">LinkedIn</a></li>
<li><a class="social youtube" href="#">Youtube</a></li>
<li class="no-icon">&copy;2012 Southeast Coastal Wind Coalition</li>    
<li class="no-icon"><a href="http://www.rouviere.com">Website by Rouviere Media</a></li>
</ul>
</div><!-- end #footer-content -->
</div><!-- end #footer -->
</body>
</html> 
```

我将不胜感激使页脚保持在主要内容下方的任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:06:44.790

在本地重新创建页面非常困难。您应该考虑创建一个独立的问题示例，以允许其他人进行调试。

但是看看你的编码和你陈述的问题，似乎`#footer`用 a定位你`margin-top: -50px;`是导致问题的原因。

```
#footer {
    position: relative;
    width: 100%;
    background-color: #dadfdb;
    margin-top: -50px; /* negative value of footer height */
    height: 50px;
    clear: both; 
} 
```

您正在定位`margin-top: -50px;`以使页脚保持不变，但它现在与您的主要内容重叠 -50px，对吗？

所以也许解决方案是给`<div>`页脚之前的立即数一个 50px 的边距——甚至更多——来补偿？

```
body.inside #wrap { 
    height: 100%;
    margin-bottom: 50px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:39:14.610

我建议您应该使用 Javascript 通过检测窗口高度来执行**HARD STOP的操作，如下所示**

```
var ht= window.innerHeight
if(ht< 760){
document.getElementById("footer").style = "width: 100%;background-color: #dadfdb;margin-top: -50px;height: 50px;clear: both;"
}else{
document.getElementById("footer").style = "width: 100%;background-color: #dadfdb;margin-top: -50px;height: 50px;clear: both;position:relative"
} 
```

您可能还想查看 Jquery 的 resize 事件以获取相同的[Here](http://api.jquery.com/resize/)

而offCourse 媒体查询是另一种做同样的方式。请看[这里](http://webdesignerwall.com/tutorials/responsive-design-with-css3-media-queries)

# c - 合并排序功能

> ID：14824668
> 
> 赞同：0
> 
> 时间：2013-02-12T02:55:00.180
> 
> 标签：c, merge, sorting

我正在尝试提出一种算法，该算法使用与 C 库中定义的 qsort 函数相同的参数递归调用合并排序函数。但是，尽管我的值打印出来了，但它们并不按顺序排列。有人可以看看我的功能并告诉我如何纠正这个问题吗？我还包括我使用的比较功能。提前致谢

```
 int cmp (const void *first, const void *second)
    {  
        if (first < second)
            return -1;
        else if (first > second)
            return 1;
        else
            return 0;
    }

    static void msort (void *b,size_t n,size_t s, int(*cmp)(const void*,const void*) )

    {
        char *tmp;

        void *t;
        if ((t = malloc(s*n)) == NULL)
        {
            printf("\nError: No Memory.");
            return;
        }   
        char *b1, *b2;
        size_t n1, n2;

        n1 = n / 2;
        n2 = n - n1;
        b1 = b;
        b2 = (char *) b + (n1 * s);

        if (n2 <= n1)
            return;

        msort (b1, n2, s, cmp);
        msort (b2, n1+1, s, cmp);

        tmp = t;

        while (n1 > 0 && n2 > 0)
        {
            if ((*cmp) (b1, b2) <= 0)
            {
                memcpy (tmp, b1, s);
                tmp += s;
                b1 += s;
                --n1;
            }
            else
            {
                memcpy (tmp, b2, s);
                tmp += s;
                b2 += s;
                --n2;
            }
        }
        if (n1 > 0)
            memcpy (tmp, b1, n1 * s);
        memcpy (b, t, (n - n2) * s);
    } 
```

这是我的主要内容。我遗漏了您在此处看到的一些功能。

```
int main()
{
    int n;
    int *a, *b, *c;

printf("enter n: ");
if(scanf("%d", &n) != 1 || n < 10)
{
    fprintf(stderr, "bad input.  goodbye\n");
    abort();
}

printf("sizeof(double) %d\n", sizeof(double) );

printf("running experiments with n=%d\n", n);

a = gen_int_array(n, 5000);
//b = clone_int_array(a, n);
c = clone_int_array(a, n);

//ssort(a, n);
//isort(b, n);
//msort_int(c, n);

//msort_int(d, n);
msort (c, n, sizeof(int), cmp );

if(n<50)
dump_int_array(c, n);

free(a);
free(b );
free(c); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T02:59:51.087

一个问题是您的比较功能；它正在比较两个指针，仅此而已 - 而不是指向的值。由于您没有向我们展示您正在合并排序的数组的定义，因此我们无法轻松提供更多帮助。但是，假设您正在对 的数组进行排序`int`，那么比较器可能是：

```
int comparator(void const *v1, void const *v2)
{
    int i1 = *(int *)v1;
    int i2 = *(int *)v2;
    if (i1 < i2)
        return -1;
    else if (i1 > i2)
        return +1;
    else
        return 0;
} 
```

请注意，此公式避免了算术溢出和其他此类未定义的行为。它也是比较结构和其他更复杂值的不错模板；您可以添加更多对`<`和`>`测试，直到您没有更多标准来分隔两个值。

我们还可以观察到您的代码中肯定存在内存泄漏。您在函数内部分配了一个数组，但您不释放它或返回指向它的指针。

* * *

### SSCCE 与原始`msort()`和`comparator()`

SSCCE 是一个[简短的、独立的、正确的示例](http://sscce.org/)。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

static int comparator(void const *v1, void const *v2)
{
    int i1 = *(int *)v1;
    int i2 = *(int *)v2;
    if (i1 < i2)
        return -1;
    else if (i1 > i2)
        return +1;
    else
        return 0;
}

static void sort_check(int *array, size_t n)
{
    size_t fail = 0;

    for (size_t i = 1; i < n; i++)
    {
        if (array[i-1] > array[i])
        {
            fprintf(stderr, "Elements %zu (value %d) and %zu (value %d) are out of order\n",
                    i-1, array[i-1], i, array[i]);
            fail++;
        }
    }
    if (fail != 0)
        exit(1);
}

static void msort(void *b, size_t n, size_t s, int(*cmp)(const void*, const void*) )
{
    char *tmp;
    void *t;

    if ((t = malloc(s*n)) == NULL)
    {
        fprintf(stderr, "Error: No Memory.\n");
        return;
    }

    char *b1, *b2;
    size_t n1, n2;

    n1 = n / 2;
    n2 = n - n1;
    b1 = b;
    b2 = (char *) b + (n1 * s);

    if (n2 <= n1)
        return;

    msort (b1, n2, s, cmp);
    msort (b2, n1+1, s, cmp);

    tmp = t;

    while (n1 > 0 && n2 > 0)
    {
        if ((*cmp) (b1, b2) <= 0)
        {
            memcpy (tmp, b1, s);
            tmp += s;
            b1 += s;
            --n1;
        }
        else
        {
            memcpy (tmp, b2, s);
            tmp += s;
            b2 += s;
            --n2;
        }
    }
    if (n1 > 0)
        memcpy (tmp, b1, n1 * s);
    memcpy (b, t, (n - n2) * s);
}

static int *gen_int_array(size_t n, int max_val)
{
    int *a = malloc(n * sizeof(*a));
    if (a == 0)
    {
        fprintf(stderr, "Out of memory.\n");
        exit(1);
    }
    for (size_t i = 0; i < n; i++)
        a[i] = rand() % max_val;
    return(a);
}

static int *clone_int_array(int *master, size_t n)
{
    int *a = malloc(n * sizeof(*a));
    if (a == 0)
    {
        fprintf(stderr, "Out of memory.\n");
        exit(1);
    }
    for (size_t i = 0; i < n; i++)
        a[i] = master[i];
    return(a);
}

static void dump_array(FILE *fp, char const *tag, int *a, size_t n)
{
    char const *pad = "";
    fprintf(fp, "Array: %s (size %zu)\n", tag, n);
    for (size_t i = 0; i < n; i++)
    {
        fprintf(fp, "%s%d", pad, a[i]);
        pad = ",";
    }
    putc('\n', fp);
}

int main(int argc, char **argv)
{
    int n;
    int *a, *b;

    if (argc == 1)
        n = 10;
    else
        n = atoi(argv[1]);
    if (n <= 0)
        n = 10;

    printf("running experiments with n = %d\n", n);

    a = gen_int_array(n, 5000);
    b = clone_int_array(a, n);

    dump_array(stdout, "Unsorted", a, n);

    printf("Q-Sort\n");
    qsort(a, n, sizeof(int), comparator);
    dump_array(stdout, "Q-sorted", a, n);
    sort_check(a, n);

    printf("M-Sort\n");
    msort(b, n, sizeof(int), comparator);
    dump_array(stdout, "M-sorted", b, n);
    sort_check(b, n);

    free(a);
    free(b);

    return(0);
} 
```

这个的输出（没有参数，在 Mac OS X 10.7.5 上）是：

```
running experiments with n = 10
Array: Unsorted (size 10)
1807,249,73,3658,3930,1272,2544,878,2923,2709
Q-Sort
Array: Q-sorted (size 10)
73,249,878,1272,1807,2544,2709,2923,3658,3930
M-Sort
Array: M-sorted (size 10)
1807,249,73,3658,3930,1272,2544,878,2923,2709
Elements 0 (value 1807) and 1 (value 249) are out of order
Elements 1 (value 249) and 2 (value 73) are out of order
Elements 4 (value 3930) and 5 (value 1272) are out of order
Elements 6 (value 2544) and 7 (value 878) are out of order
Elements 8 (value 2923) and 9 (value 2709) are out of order 
```

如您所见，`qsort()`以正确的顺序获取数据。`msort()`不会改变任何东西的顺序。测试工具未设置为管理 0 行数据，但运行`msort 1`从`msort()`函数获取核心转储。当退化案例因分段错误而失败时，这总是一个不好的迹象。

大小为 1 的问题（和大小为 0）通过检查`n`进入`msort()`并返回 if来解决`n <= 1`。

下一个问题是条件 where `if (n2 <= n1)`; 它早早返回。事实上，这个条件总是会触发一个偶数的`n`; 当您从 的奇数值开始时`n`，递归会生成一个偶数值，并且会提前返回。因此，排序永远不会发生。这是演示此行为的函数的（部分）检测版本：

```
static void msort(void *b, size_t n, size_t s, int (*cmp)(const void *v1, const void *v2) )
{
    if (n <= 1)
        return;     /* Already sorted */

    printf("-->> msort(%zu)\n", n);
    void *t = malloc(s*n);

    if (t == NULL)
    {
        fprintf(stderr, "Error: No Memory.\n");
        printf("<<-- msort(%zu)\n", n);
        return;
    }

    size_t n1 = n / 2;
    size_t n2 = n - n1;

    if (n2 <= n1)
    {
        fprintf(stderr, "Oops: %zu <= %zu\n", n2, n1);
        free(t);
        printf("<<-- msort(%zu)\n", n);
        return;
    }

    char *b1 = b;
    char *b2 = (char *) b + (n1 * s);

    msort(b1, n2, s, cmp);
    msort(b2, n1+1, s, cmp);

    char *tmp = t;

    while (n1 > 0 && n2 > 0)
    {
        if ((*cmp)(b1, b2) <= 0)
        {
            memcpy(tmp, b1, s);
            tmp += s;
            b1 += s;
            --n1;
        }
        else
        {
            memcpy(tmp, b2, s);
            tmp += s;
            b2 += s;
            --n2;
        }
    }
    if (n1 > 0)
        memcpy(tmp, b1, n1 * s);
    memcpy(b, t, (n - n2) * s);
    free(t);
    printf("<<-- msort(%zu)\n", n);
} 
```

样品运行：

```
running experiments with n = 1
Array: Unsorted (size 1)
1807
Q-Sort
Array: Q-sorted (size 1)
1807
M-Sort
Array: M-sorted (size 1)
1807

running experiments with n = 2
Array: Unsorted (size 2)
1807,249
Q-Sort
Array: Q-sorted (size 2)
249,1807
M-Sort
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
Array: M-sorted (size 2)
1807,249
Elements 0 (value 1807) and 1 (value 249) are out of order

running experiments with n = 3
Array: Unsorted (size 3)
1807,249,73
Q-Sort
Array: Q-sorted (size 3)
73,249,1807
M-Sort
-->> msort(3)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
<<-- msort(3)
Array: M-sorted (size 3)
249,73,1807
Elements 0 (value 249) and 1 (value 73) are out of order

running experiments with n = 4
Array: Unsorted (size 4)
1807,249,73,3658
Q-Sort
Array: Q-sorted (size 4)
73,249,1807,3658
M-Sort
-->> msort(4)
Oops: 2 <= 2
<<-- msort(4)
Array: M-sorted (size 4)
1807,249,73,3658
Elements 0 (value 1807) and 1 (value 249) are out of order
Elements 1 (value 249) and 2 (value 73) are out of order

running experiments with n = 5
Array: Unsorted (size 5)
1807,249,73,3658,3930
Q-Sort
Array: Q-sorted (size 5)
73,249,1807,3658,3930
M-Sort
-->> msort(5)
-->> msort(3)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
<<-- msort(3)
-->> msort(3)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
-->> msort(2)
Oops: 1 <= 1
<<-- msort(2)
<<-- msort(3)
<<-- msort(5)
Array: M-sorted (size 5)
249,73,1807,3658,3930
Elements 0 (value 249) and 1 (value 73) are out of order

running experiments with n = 6
Array: Unsorted (size 6)
1807,249,73,3658,3930,1272
Q-Sort
Array: Q-sorted (size 6)
73,249,1272,1807,3658,3930
M-Sort
-->> msort(6)
Oops: 3 <= 3
<<-- msort(6)
Array: M-sorted (size 6)
1807,249,73,3658,3930,1272
Elements 0 (value 1807) and 1 (value 249) are out of order
Elements 1 (value 249) and 2 (value 73) are out of order
Elements 4 (value 3930) and 5 (value 1272) are out of order 
```

这是你的问题......我已经展示了一些调试技术，并诊断了一些问题。请注意，跟踪函数进入和退出可能会有所帮助（尽管我作弊并且没有诊断大小 0 或 1 进入/退出）。特别是在递归代码中，它有助于识别函数的关键参数（这里，`n`虽然数组的开始地址也可能是相关的），以便可以检测到单独的调用。

* * *

我感到无聊，或粗心，或其他什么...此代码有效。递归调用中的更改，以及合并循环结束时的清理，以及复制回原始数组。并完全删除了可疑的`if (n2 <= n1)`块；我想不出它的目的。哦，还有更多诊断，在进入和退出时打印数组。

```
static void msort(void *b, size_t n, size_t s, int (*cmp)(const void *v1, const void *v2) )
{
    if (n <= 1)
        return;     /* Already sorted */

    printf("-->> msort(%zu)\n", n);
    dump_array(stdout, "Entry to msort()", (int *)b, n);
    void *t = malloc(s*n);

    if (t == NULL)
    {
        fprintf(stderr, "Error: No Memory.\n");
        printf("<<-- msort(%zu)\n", n);
        return;
    }

    size_t n1 = n / 2;
    size_t n2 = n - n1;

    char *b1 = b;
    char *b2 = (char *) b + (n1 * s);

    msort(b1, n1, s, cmp);
    msort(b2, n2, s, cmp);

    char *tmp = t;

    while (n1 > 0 && n2 > 0)
    {
        if ((*cmp)(b1, b2) <= 0)
        {
            memcpy(tmp, b1, s);
            tmp += s;
            b1 += s;
            --n1;
        }
        else
        {
            memcpy(tmp, b2, s);
            tmp += s;
            b2 += s;
            --n2;
        }
    }
    if (n1 > 0)
        memcpy(tmp, b1, n1 * s);
    else if (n2 > 0)
        memcpy(tmp, b2, n2 * s);
    memcpy(b, t, n * s);
    free(t);

    dump_array(stdout, "Exit from msort()", (int *)b, n);
    printf("<<-- msort(%zu)\n", n);
} 
```

# html - 导航对齐问题

> ID：14824670
> 
> 赞同：0
> 
> 时间：2013-02-12T02:55:18.360
> 
> 标签：html, css, image

我有一个精灵，由 4 个气泡组成，我将用于所选版本的导航，如下所示：

![在此处输入图像描述](../Images/a6aaa074e4f3762b2255cc45bfc4763d.png)

我能找到的最好的例子就是[Dribbble](http://dribbble.com/jobs)。查看标题导航选择的导航。他们使用类似于我的气泡来覆盖“工作”链接，除了他们使用纯 css 来实现外观，而我使用的是图像。

这是我的代码：

```
.inline-block{
  /* Inline block class for li navigation */
  display:-moz-inline-stack;
  display:inline-block;
  zoom:1;
  *display:inline;
}
#header li a{
  width:40px;   /* without padding = 110px*/
  height:15px;  /* without padding = 31px*/
  padding:8px 35px;
}
#header li a.selected{
  background: url('../img/btn-header-sprite.png') 0 -1px;
  display:inline-block;
}
#header li a{
  color:#FFF;
  font-weight:bold;
  font-size:15px;
}
#header li:hover{
  background-position:0 -34px;
}
#header li:active{
  background-position:0 -67px;
} 
```

现在它看起来像这样： ![在此处输入图像描述](../Images/23f808e3c0a3869675fe025b15bc40a8.png)

我必须单独对齐每个填充，如您所见，如果填充不正确，则文本不会在气泡中居中。有没有更好的方法来格式化这个，而不是单独给每个气泡填充？

感谢大家的帮助！如果您需要更多说明，请说！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:05:41.493

你可以试试

```
display:table-cell;
vertical-align: middle; 
```

# jquery - 如何更改 select2 框的高度

> ID：14824676
> 
> 赞同：87
> 
> 时间：2013-02-12T02:57:01.700
> 
> 标签：jquery, jquery-select2

我喜欢[https://github.com/ivaynberg/select2](https://github.com/ivaynberg/select2)中的 select2 框， 我使用 format: 选项来格式化每个元素，它看起来很棒。

一切都很好，除了所选元素由于图像而大于选择框的高度。

我知道如何改变宽度，但是如何改变高度，以便在选择元素后，它显示完整的东西（大约 150 像素）

这是我的启蒙：

```
<script>
    $("#selboxChild").select2({
        matcher: function(term, text) { 
            var t = (js_child_sponsors[text] ? js_child_sponsors[text] : text); 
            return t.toUpperCase().indexOf(term.toUpperCase()) >= 0; 
        },
        formatResult: formatChild,
        formatSelection: formatChild,
        escapeMarkup: function(m) {
            return m;
        }
    });
</script> 
```

这是我的选择框

```
<select id="selboxChild" style="width: 300px; height: 200px">
    <option value="">No child attached</option>
</select> 
```

**澄清：我不希望更改每个选项的高度** 我正在寻找选择框以在选择孩子后更改高度。

因此，当页面首次加载时，它会显示“未选择孩子”当您单击下拉菜单并选择一个孩子时，您会看到孩子的图像。现在我需要选择框来展开！否则孩子的照片就被剪掉了。

有人明白吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2017-01-24T14:39:43.653

您应该在 CSS 中添加以下样式定义：

```
.select2-selection__rendered {
    line-height: 31px !important;
}
.select2-container .select2-selection--single {
    height: 35px !important;
}
.select2-selection__arrow {
    height: 34px !important;
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-03-27T20:12:37.323

你可以用一些简单的CSS来做到这一点。根据我的阅读，您想使用“select2-choices”类设置元素的高度。

```
.select2-choices {
  min-height: 150px;
  max-height: 150px;
  overflow-y: auto;
} 
```

这应该给你一个 150px 的设置高度，如果需要它会滚动。只需调整高度，直到您的图像符合需要。

您还可以使用 css 设置 select2-results 的高度（选择控件的下拉部分）。

```
ul.select2-results {
  max-height: 200px;
} 
```

200px 是默认高度，因此将其更改为所需的下拉高度。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-09-02T02:45:02.137

您可能想先为您的 select2 提供一个特殊的类，然后仅修改该类的 css，而不是在站点范围内更改所有 select2 css。

```
$("#selboxChild").select2({ width: '300px', dropdownCssClass: "bigdrop" }); 
```

**SCSS**

```
.bigdrop.select2-container .select2-results {max-height: 200px;}
.bigdrop .select2-results {max-height: 200px;}
.bigdrop .select2-choices {min-height: 150px; max-height: 150px; overflow-y: auto;} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-05-18T07:05:31.570

这对我有用

```
.select2-container--default .select2-results>.select2-results__options{
    max-height: 500px !important;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-08-23T15:40:20.100

编辑 select2.css 文件。转到高度选项并更改：

```
.select2-container .select2-choice {
    display: block;
    height: 36px;
    padding: 0 0 0 8px;
    overflow: hidden;
    position: relative;

    border: 1px solid #aaa;
    white-space: nowrap;
    line-height: 26px;
    color: #444;
    text-decoration: none;

    border-radius: 4px;

    background-clip: padding-box;

    -webkit-touch-callout: none;
      -webkit-user-select: none;
       -khtml-user-select: none;
         -moz-user-select: none;
          -ms-user-select: none;
              user-select: none;

    background-color: #fff;
    background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #eee), color-stop(0.5, #fff));
    background-image: -webkit-linear-gradient(center bottom, #eee 0%, #fff 50%);
    background-image: -moz-linear-gradient(center bottom, #eee 0%, #fff 50%);
    background-image: -o-linear-gradient(bottom, #eee 0%, #fff 50%);
    background-image: -ms-linear-gradient(top, #fff 0%, #eee 50%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#ffffff', endColorstr = '#eeeeee', GradientType = 0);
    background-image: linear-gradient(top, #fff 0%, #eee 50%);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-03-25T18:28:58.507

The selected answer is correct but you shouldn't have to edit the *select2.css* file. You can add the following to your own custom css file.

```
.select2-container .select2-choice {
    display: block!important;
    height: 36px!important;
    white-space: nowrap!important;
    line-height: 26px!important;
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-10-19T03:30:27.267

我来这里是为了寻找一种方法来指定启用 select2 的下拉菜单的高度。这对我有用：

```
.select2-container .select2-choice, .select2-result-label {
  font-size: 1.5em;
  height: 41px; 
  overflow: auto;
}

.select2-arrow, .select2-chosen {
  padding-top: 6px;
} 
```

前：

![在此处输入图像描述](../Images/334401f863eb08e0c4750563b3bdc484.png) ![在此处输入图像描述](../Images/54fb1c309d666c417ec6810bfee831f0.png)

后： ![select-2 启用了具有 CSS 定义高度的下拉菜单](../Images/aec30b213a12c5c47e5876589424010d.png) ![在此处输入图像描述](../Images/4e95aebe20bed5137fec8b7817b4a107.png)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-02-26T22:47:25.377

这是我对 Carpetsmoker 的回答的看法（我喜欢它，因为它是动态的），已针对 select2 v4 进行了清理和更新：

```
$('#selectField').on('select2:open', function (e) {
  var container = $(this).select('select2-container');
  var position = container.offset().top;
  var availableHeight = $(window).height() - position - container.outerHeight();
  var bottomPadding = 50; // Set as needed
  $('ul.select2-results__options').css('max-height', (availableHeight - bottomPadding) + 'px');
}); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-09-06T06:09:35.833

我在这里找到的懒惰解决方案 [https://github.com/panorama-ed/maximize-select2-height](https://github.com/panorama-ed/maximize-select2-height)

**最大化选择2高度**

这个包短小精悍。它神奇地扩展了您的 Select2 下拉菜单以填充窗口的高度。

它考虑了下拉菜单中元素的数量、Select2 在页面上的位置、页面的大小和滚动位置、滚动条的可见性以及下拉菜单是向上还是向下呈现。每次打开下拉菜单时，它都会自行调整大小。缩小后，大约为 800 字节（包括注释）！

（请注意，此插件仅适用于 Select2 v4.xx。）

```
$("#my-dropdown").select2().maximizeSelect2Height(); 
```

享受！

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-03-15T16:25:08.220

似乎样式表选择器随着时间的推移发生了变化。我正在使用 select2-4.0.2 并且当前设置框高度的正确选择器是：

```
.select2-container--default .select2-results > .select2-results__options {
    max-height: 200px
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-11-16T14:15:08.307

我知道这个问题已经很老了，但我在 2017 年一直在寻找同样问题的解决方案，并自己找到了一个。

```
.select2-selection {
    height: auto !important;
} 
```

这将根据其内容动态调整输入的高度。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-06-02T12:03:08.647

我想出了：

```
.select2,
.select2-search__field,
.select2-results__option
{
    font-size:1.3em!important;
}
.select2-selection__rendered {
    line-height: 2em !important;
}
.select2-container .select2-selection--single {
    height: 2em !important;
}
.select2-selection__arrow {
    height: 2em !important;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-01-08T08:45:38.923

只需添加 select2.css

```
/* Make Select2 boxes match Bootstrap3 as well as Bootstrap4 heights: */
.select2-selection__rendered {
line-height: 32px !important;
}

.select2-selection {
height: 34px !important;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-09-20T10:55:47.910

以上解决方案都不适合我。这是我的解决方案：

```
/* Height fix for select2 */
.select2-container .select2-selection--single, .select2-container--default .select2-selection--single .select2-selection__rendered, .select2-container--default .select2-selection--single .select2-selection__arrow {
    height: 35px;
}

.select2-container--default .select2-selection--single .select2-selection__rendered {
    line-height: 35px;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-09-20T09:03:38.643

我正在使用 Select2 4.0。这对我有用。我只有一个 Select2 控件。

```
.select2-selection.select2-selection--multiple {
    min-height: 25px;
    max-height: 25px;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-01-14T09:36:35.573

我使用以下内容动态调整 select2 下拉元素的高度，使其非常适合选项的数量：

```
$('select').on('select2:open', function (e) {
  var OptionsSize = $(this).find("option").size(); // The amount of options 
  var HeightPerOption = 36; // the height in pixels every option should be
  var DropDownHeight = OptionsSize * HeightPerOption;
  $(".select2-results__options").height(DropDownHeight);
}); 
```

确保在 css 中取消设置（默认）最大高度：

```
.select2-container--default .select2-results>.select2-results__options {
  max-height: inherit;
} 
```

（仅在 select2 的第 4 版中测试过）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-23T14:30:27.940

在 4.0.6 上，以下是对我有用的解决方案。必须包含`select2-selection__rendered`并`select2-selection__arrow`垂直对齐下拉标签和箭头图标：

```
.select2-container .select2-selection, 
.select2-selection__rendered, 
.select2-selection__arrow {
    height: 48px !important;
    line-height: 48px !important;
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-01-24T08:30:20.370

如果这里有人尝试将 bootstrap4 的输入样式和表单组高度与 select2 匹配，这就是我所做的，

```
.select2-container{
    .select2-selection{
        height: 37px!important;
    }
    .select2-selection__rendered{
        margin-top: 4px!important;
    }
    .select2-selection__arrow{
        margin-top: 4px;
    }
    .select2-selection--single{
        border: 1px solid #ced4da!important;
    }
    *:focus{
        outline: none;
    } 
} 
```

这也将删除轮廓。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-11-23T20:12:06.163

在 select2.css 之后加入另一个 css 文件，并在该 css 中添加以下内容：

```
.select2-container .select2-selection {
  height: 34px; 
} 
```

即，如果您希望选择框高度的高度为 34px。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-06-14T09:44:05.767

如果你有几个`select2`，只是想调整一个。做这个：

获取元素的 id：

```
 <div id="skills">
      <select class="select2" > </select>
  </div> 
```

并添加这个 CSS：

```
 #skills > span >span >span>.select2-selection__rendered{
       line-height: 80px !important;
  } 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-01-17T02:59:37.410

我遇到了类似的问题，这些解决方案中的大多数都很接近，但没有雪茄。以下是最简单的形式：

```
.select2-selection {
    min-height: 10px !important;
} 
```

您可以将最小高度设置为您想要的任何值。高度将根据需要扩展。我个人觉得填充有点不平衡，而且字体太大，所以我也在这里添加了这些。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-07-02T03:16:18.497

这是我的解决方案。 **注意：对于引导程序 4**

```
.select2-container {
    height: calc(1.5em + .75rem + 2px) !important;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-05-22T12:26:12.310

恕我直言，将高度设置为固定数字很少有用。将其设置为屏幕上可用的任何空间都更有用。

这正是这段代码的作用：

```
$('select').on('select2-opening', function() {
    var container = $(this).select2('container')
    var position = $(this).select2('container').offset().top
    var avail_height = $(window).height() - container.offset().top - container.outerHeight()

    // The 50 is a magic number here. I think this is the search box + other UI
    // chrome from select2?
    $('ul.select2-results').css('max-height', (avail_height - 50) + px)
}) 
```

我为 select2 3.5 制作了这个。我没有用 4.0 对其进行测试，但从文档来看可能也适用于 4.0。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-05-25T11:29:04.110

对于 v4.0.7，您可以通过覆盖 CSS 类来增加高度，如下例所示：

```
 .select2-container .select2-selection--single {
    height: 36px;
}

.select2-container--default .select2-selection--single .select2-selection__rendered {
    line-height: 36px;
}

.select2-container--default .select2-selection--single .select2-selection__arrow {
    height: 36px;
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-10-01T04:20:19.960

试试这个，它对我有用：

```
<select name="select_name" id="select_id" class="select2_extend_height wrap form-control" data-placeholder="----">
<option value=""></option>
<option value="1">test</option>
</select>

.wrap.select2-selection--single {
    height: 100%;
}
.select2-container .wrap.select2-selection--single .select2-selection__rendered {
    word-wrap: break-word;
    text-overflow: inherit;
    white-space: normal;
}

$('.select2_extend_height').select2({containerCssClass: "wrap"}); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-08-25T14:14:02.657

使用几行 CSS 样式自定义 Select 2 渲染组件的非常简单的方法：

```
// Change the select container width and allow it to take the full parent width
.select2 
{
    width: 100% !important
}

// Set the select field height, background color etc ...
.select2-selection
{    
    height: 50px !important
    background-color: $light-color
}

// Set selected value position, color , font size, etc ...
.select2-selection__rendered
{ 
    line-height: 35px !important
    color: yellow !important
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-09-26T03:39:52.103

应用此覆盖 CSS 以增加结果框高度

```
.select2-container--bootstrap4 .select2-results>.select2-results__options {
    max-height: 20em;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-05-10T08:59:54.437

添加样式

```
.select2-container .select2-selection--single{
     height:0%;
 } 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2021-11-08T03:08:11.893

如果以上所有答案都对您不起作用（这对我不起作用）这对我有用

```
.select2-results__options {
        max-height: 300px; //This can be any height you want
        overflow:scroll;
    } 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2015-10-07T10:27:22.043

您不需要更改所有 select2 的高度 - 源`<input>`类被复制到 select2-container，因此您可以通过输入类来设置它们的样式。例如，如果您想设置 select2 某些实例的高度样式，请将 class your-class 添加到源`<select>`元素，然后`your-class`在 CSS 文件中使用“.select2-container.”。

问候。

存在一些问题：`select2*`未复制类名称。

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2015-01-30T12:56:16.770

快速简便，将其添加到您的页面：

```
<style>
    .select2-results {
        max-height: 500px;
    }
</style> 
```

# c++ - 使用可调用参数重载可调用对象

> ID：14824681
> 
> 赞同：2
> 
> 时间：2013-02-12T02:57:55.960
> 
> 标签：c++, templates, lambda, functional-programming, template-meta-programming

我正在尝试将下面的 C# 代码转换为 C++：

```
void SomeCall(Action action)
{
   // do things like action();  

}

void SomeCall(Action<Action> action)
{
   // define some action1   
   // do things like action(action1);   

} 
```

SomeCall 的 C++ 等效项应该能够采用 std::function 以及具有相同签名的内联和轮廓 C++ lambda。

在浏览了许多关于 C++ std::function 和 lambdas 重载的 SO 问题之后，答案似乎应该如下所示：

```
template<typename Func>
enable_if<Func is something callable>
void SomeCall(Func&& action)
{
 ...
}

template<typename Func>
enable_if<Func is something callable taking another callable as the parameter>
void SomeCall(Func&& action)
{
 ...

} 
```

你能帮我填空吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T17:25:46.757

您可以尝试使用标准重载，如下所示：

```
void Fn( std::function<int(int)>& fn )
{
}

void Fn( std::function<int(float)>& fn )
{
} 
```

如果这是不可接受的，您将不得不对模板元编程进行大量研究，以使 enable_if 以您想要的方式工作，这是可以想象的最虐待狂的编程形式。不过说真的，您可以尝试从 Andrei Alexandrescu 的 Modern C++ Design 开始。

# c++ - 使用指针传递 C-String 参数

> ID：14824682
> 
> 赞同：0
> 
> 时间：2013-02-12T02:58:06.243
> 
> 标签：c++, function, pointers, arguments, c-strings

我整天都被这个程序卡住了。我终于觉得我真的很接近了。我必须找到字符串中元音和字符的数量。然后在最后输出它们。但是，当我编译我的程序时崩溃了。我检查了语法，整天都在看我的书。如果有人可以提供帮助，我将不胜感激！因为我还有 5 个类似的函数要编写来操作 c 字符串。谢谢！

```
#include <iostream>
#include <string>
using namespace std;

int specialCounter(char *, int &);

int main()
{

const int SIZE = 51;        //Array size
char userString[SIZE];      // To hold the string
char letter;
int numCons;

// Get the user's input string
cout << "First, Please enter a string (up to 50 characters): " << endl;
cin.getline(userString, SIZE);

// Display output
cout << "The number of vowels found is " << specialCounter(userString, numCons) <<      "." << endl;
cout << "The number of consonants found is " << numCons << "." << endl;

}

int specialCounter(char *strPtr, int &cons)
{
int vowels = 0;
cons = 0;

while (*strPtr != '/0')
{
    if (*strPtr == 'a' || 'A' || 'e' || 'E' || 'i' || 'I' || 'o' || 'O' || 'u' || 'U')
    {
        vowels++;       // if vowel is found, increment vowel counter
                    // go to the next character in the string
    }
    else
    {
        cons++;         // if consonant is found, increment consonant counter
                    // go to the next character in the string
    }

    strPtr++;

}
return vowels;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:04:03.937

我将假设您仅限于不使用`std::string`or`std::getline`并且您必须假设用户输入的内容少于 51 个字符。

您的崩溃源于：

```
while (*strPtr != '/0') 
```

空字符是转义码。`'/0'`是具有实现定义值的多字符文字。这意味着它可能总是正确的。将其更改为：

```
while (*strPtr != '\0') //or while (strPtr) 
```

除此之外，您的元音检查存在逻辑错误。您必须对照每个元音检查它，如下所示：

```
if (*strPtr == 'a' || *strPtr == 'e') //etc. 
```

如果您与每个字符的`toupper`or`tolower`版本进行比较以将比较次数减少 2 倍，您会发现会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:04:24.173

```
while (*strPtr != '/0') 
```

应该：

```
while (*strPtr != 0) 
```

或者

```
while (*strPtr != '\0'); 
```

你的编译器没有给你警告吗？如果是这样，请不要忽略警告。如果没有，请获得更好的编译器。

另请参阅其他比较中有关错误的评论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T03:10:15.470

其他答案应该可以解决您的问题，我可以建议您编写单独的函数而不是一个全能函数吗？

```
bool IsSpecialChar(char c)
{
 switch(c)
 {
    case 'a':
    case 'A':
    case 'e':
    case 'E':
    case 'i':
    case 'I':
    case 'o':
    case 'O':
    case 'u':
    case 'U':
    return true;
 }
   return false; 
}

int specialCounter(char *strPtr, int &cons)
{
  int vowels = 0;
  cons = 0;
  while (*strPtr != '\0')
  {
    IsSpecialChar(*strPtr) ? vowels++ : cons++;
    strPtr++;

  }
  return vowels;
} 
```

# regex - 正则表达式除字符串以外的所有字符

> ID：14824684
> 
> 赞同：1
> 
> 时间：2013-02-12T02:58:24.197
> 
> 标签：regex, regex-negation, regex-lookarounds

我想选择除以字符串 . 开头的所有空格字符之外的所有空格字符`Send,`。

前瞻使用`(?!)`将不起作用。还有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:00:21.097

听起来像往后看*就*足够了。如果字符串`Send,`紧接在您想要的空间之前，那么它将是：

```
(?<!Send,)\s 
```

如果字符串没有直接出现在空格之前，那么您的选项可能取决于您特定的正则表达式风格，因为许多不支持可变长度查找。

# php - 使用 JQuery/Ajax 从 PHP while 循环提交表单

> ID：14824685
> 
> 赞同：0
> 
> 时间：2013-02-12T02:58:27.437
> 
> 标签：php, javascript, ajax, jquery

我已经搜索和搜索并且无法解决我的问题..帮助;）

我有一个在 while 循环中创建的表单。然后我使用 AJAX 来处理它。问题是它只会合并第一个表单，即使我单击第二个表单。假设这是由于每个表单都需要唯一的 ID。我这样做有问题......任何帮助都会很棒。

**我的 PHP 表单**

```
echo '<table width="100%" border="0" cellspacing="0" cellpadding="0" >';
echo ' <tr>';
echo ' <td style="color:#bbb">Team Name</td>';
echo '<td style="color:#bbb">Event Name</td>';
echo ' <td style="color:#bbb">Event Level</td>';
echo ' <td style="color:#bbb">Comments</td>';
echo '<td style="color:#bbb">&nbsp;</td>';
echo ' <td style="color:#bbb">&nbsp;</td>';
echo ' </tr>';

while ($row = mysql_fetch_array($pendingresult)) {
    $id = $row['reg_id'];
    print "<form id=\"$id\" name=\"CDs\" method=\"post\" action=\"$_SERVER[PHP_SELF]\">";
    echo '<tr class="commentContainer">';
    echo "<td><input type=\"text\" name=\"team_name\" value=\"$row[team_name]\"</td>";
    echo "<td><input type=\"text\" name=\"reg_id\" value=\"$row[reg_id]\"</td>";
    echo "<td><input type=\"text\" name=\"team_level\" value=\"$row[team_level]\"</td>";
    echo "<td><input type=\"text\" name=\"notes\" value=\"$row[comments]\"</td>";
    echo "<td>";
    echo "<td class=\"delete\" align=\"center\" id=" . $row['reg_id'] . " width=\"10\"><a href=\"#\" id=\"$row[reg_id]\"><img src=\"admin/images/delete.png\" border=\"0\" ></a></td>";
    echo "<td class=\"approve\" align=\"center\" id=" . $id . " width=\"10\"><a href=\"#\" id=\"$row[reg_id]\"><img src=\"admin/images/approve.png\" border=\"0\" ></a></td>";
    echo "</td>";
    echo "</tr>";
    echo "</form>";
} 
```

**我的 AJAX**

```
$(document).ready(function () {});
$(function () {
  $(".approve").click(function () {
    var commentContainer = $(this).parent('tr:first');
    var id = $(this).attr("id");
    var string = 'id=' + id;
    var formData = this.form.id;
    $.ajax({
      type: "POST",
      url: "approve.php",
      data: $("formData").serialize(),
      cache: false,
      success: function () {
        commentContainer.slideUp('slow', function () {
          $(this).remove();
        });
      }
    });
    return false;
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-22T16:04:57.723

在您的 ajax 更改中

数据：$("formData").serialize()

至

数据：$("form#"+id).serialize()

它将捕获您正在处理的当前表格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:27:47.873

您在 while 循环中使用表单字段，这意味着它们是具有相同名称的输入字段数组。

所以你需要将它们组合成一个变量并相应地传递它。

**例子**

```
var team_name = $("input[name=team_name]").map(function(){
   return $(this).val();
}).get().join(",");
```

等等其他领域。

试试看。

# asp.net - razor view html表单验证错误？

> ID：14824687
> 
> 赞同：0
> 
> 时间：2013-02-12T02:58:30.423
> 
> 标签：asp.net, razor, asp.net-mvc-4

我进行了搜索，结果一直在说 2 件事。1）我需要`<httpRuntime requestValidationMode="2.0" />`在`system.web`我正在使用的配置中使用。然后另一个是通过关闭页面验证`<pages validateRequest="false"></pages>`。这给了我一个配置错误。

如何关闭所有页面/表单的验证？

# c - Linux ANSI C 同时访问文件和锁定

> ID：14824690
> 
> 赞同：0
> 
> 时间：2013-02-12T02:58:41.793
> 
> 标签：c, linux, file, locking

我正在编写同时访问文件的 Linux ANSI C cgi-bin 服务器程序。

1.  是否可以区分文件存在和文件锁定？我用谷歌找不到答案。我想编写一个程序，如果 fd<0（认为文件被锁定了一段时间），它会尝试打开文件几秒钟。但如果文件不存在，它的 fd 也 <0。所以程序会浪费时间等待。

2.  假设有几个线程尝试在没有锁定的情况下附加到同一个文件。一个尝试添加“AAAA”，另一个尝试添加“BBBB”。结果文件可以像“AABBAABB”吗？或者它总是像 AAAABBBB 或 BBBBAAAA？还是结果无法预料？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T04:55:12.820

我假设 IEEE Std 1003.1-2001 可能会遵循 ISO C 标准......

如果 fopen 失败，即 fd < 0，那么系统会设置一些错误代码……您可以检查这些错误代码。如果文件不存在，返回的错误将是

ENOENT 文件名的一个组成部分没有命名现有文件或文件名是一个空字符串。

如需更多参考，请访问： http: [//pubs.opengroup.org/onlinepubs/009695399/functions/fopen.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/fopen.html)

对于第 2 点：我一直在通过 100 多个进程同时写入单个文件来记录系统中的某些数据，但从未见过记录合并（文件始终以附加模式打开）。即它总是像 AAAABBBB

# sublimetext2 - 句柄无效

> ID：14824691
> 
> 赞同：2
> 
> 时间：2013-02-12T02:58:49.283
> 
> 标签：sublimetext2

我正在使用 Sublime Text 2。每当我从命令行启动 Sublime Text 并运行我正在工作的代码时，我总是得到：

```
[Error 6] The handle is invalid 
```

但是当我从“windows + r”启动 Sublime 时，一切都按原样进行。为什么？

我正在使用 Sublime 的便携式版本，我的工作目录是 D（因为我不拥有我正在使用的计算机）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T08:38:57.747

我从
`alias subl="start sublime_text.exe"`
带有双引号的别名的 git bash 开始，它运行良好。

如果我以其他任何方式进行操作，它就不能正常工作，并且在 Sublime Text 2 的控制台中会出现与上述相同的错误。

# javascript - 带有漂亮照片的 Instagram API

> ID：14824696
> 
> 赞同：0
> 
> 时间：2013-02-12T03:00:18.447
> 
> 标签：javascript, ajax, json, api, instagram

我正在尝试将 prettyPhoto 从我的网站上的 Instagram 提要中添加到我的图片中，可以在[www.dirtycookie.co上看到](http://www.dirtycookie.co)

我可以成功地从 instagram API 中提取图片，但是我无法将 prettyPhoto 功能添加到提要中的图片中。这是我使用 prettyPhoto 挂钩的 ajax 调用：

```
<script>

$(function() {
    $.ajax({
        type: "GET",
        dataType: "jsonp",
        cache: false,
        url: "https://api.instagram.com/v1/users/<?=$user_id?>/media/recent/?access_token=13137.f59def8.1a759775695548999504c219ce7b2ecf",
        success: function(data) {
            for (var i = 0; i < <?=$num_to_display?>; i++) {
           jQuery('.instagram').append('<div class="instagram-placeholder"><a href="' + data.data[i].images.standard_resolution.url + '"  rel="prettyPhoto"><img alt="'+ data.data[i].caption.text +'" class="instagram-image" src="' + data.data[i].images.thumbnail.url +'"/></a></div>');  
            }     

        }
    });
});

</script> 
```

它几乎表现得好像 jquery.prettyPhoto.js 没有被调用，我已经确认它在 /js/ 文件夹中。

这是我的初始化脚本和正文的底部：

```
<script type="text/javascript" charset="utf-8">
  $(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto();
  });
</script> 
```

使用 Firebug 我可以看到 Ajax 正确地放入了 rel="prettyPhoto" 。

有人有什么建议吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:57:01.633

您正在将 prettyPhoto() 函数附加到“domready”的锚点上，甚至在从 AJAX 调用中提取内容之前。因此它不起作用。试试这个。

```
$(function() {
    $.ajax({
        type: "GET",
        dataType: "jsonp",
        cache: false,
        url: "https://api.instagram.com/v1/users/<?=$user_id?>/media/recent/?access_token=13137.f59def8.1a759775695548999504c219ce7b2ecf",
        success: function(data) {
            for (var i = 0; i < <?=$num_to_display?>; i++) {
           jQuery('.instagram').append('<div class="instagram-placeholder"><a href="' + data.data[i].images.standard_resolution.url + '"  rel="prettyPhoto"><img alt="'+ data.data[i].caption.text +'" class="instagram-image" src="' + data.data[i].images.thumbnail.url +'"/></a></div>');  
            }     
$("a[rel^='prettyPhoto']").prettyPhoto();

        }
    });
}); 
```

# visual-studio-2010 - Visual Studio 2010 Reporting Services 错误消息 子报表的数据检索失败

> ID：14824698
> 
> 赞同：0
> 
> 时间：2013-02-12T03:00:20.727
> 
> 标签：visual-studio-2010, reporting-services

在 StackOverFlow 中阅读此线程后：[SSRS Subreport VS2010 data retrieve failed for the subreport](https://stackoverflow.com/questions/4261970/ssrs-subreport-vs2010-data-retrieval-failed-for-the-subreport)后，我​​仍然收到“子报告的数据检索失败”。主报表和子报表在 BIDS 2008 中运行良好，因此我的 .cs 或 .aspx 页面一定有问题。我正在使用的代码如下。谁能告诉我我做错了什么？谢谢！

页面：

```
<asp:DropDownList ID="DropDownListVisit" runat="server" DataTextField="VisitList"
    DataValueField="VisitID" AutoPostBack="True"  AppendDataBoundItems="true"
    onselectedindexchanged="DropDownListVisit_SelectedIndexChanged"
    DataSourceID="EntityDataSourceVisitDropDown">
    <asp:ListItem Text="--- Select Ship & Visit ---" Value="" Selected="True"></asp:ListItem>
</asp:DropDownList>

<asp:EntityDataSource ID="EntityDataSourceVisitDropDown" runat="server"
    ConnectionString="name=Admiral_NSSAEntities"
    DefaultContainerName="Admiral_NSSAEntities" EnableFlattening="False"
    EntitySetName="vw_VisitList"
    Select="it.[VisitID], it.[VisitList], it.[ShipName], it.[StartDate]"
    OrderBy="it.[ShipName] asc, it.[StartDate] desc">
</asp:EntityDataSource>

<rsweb:ReportViewer ID="ReportViewerSummeryReportOutBrief" runat="server" Font-Names="Verdana"
    Font-Size="8pt" InteractiveDeviceInfos="(Collection)"
    WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" Width="1139px"
    Height="894px" PageCountMode="Actual" PromptAreaCollapsed="True"
    style="margin-right: 0px">
    <LocalReport ReportPath="Secured\Reports\SummeryReportOutBrief.rdlc">
        <DataSources>
            <rsweb:ReportDataSource DataSourceId="EntityDataSourceVisitInfo"
                Name="VisitInfo" />
            <rsweb:ReportDataSource DataSourceId="EntityDataSourceWorkOrders"
                Name="WorkOrders" />
            <rsweb:ReportDataSource DataSourceId="EntityDataSourcePartsDataByWorkOrder"
                Name="PartsDataByWorkOrder" />
        </DataSources>
    </LocalReport>
</rsweb:ReportViewer>

<asp:EntityDataSource ID="EntityDataSourcePartsDataByWorkOrder" runat="server"
    ConnectionString="name=Admiral_NSSAEntities"
    DefaultContainerName="Admiral_NSSAEntities" EnableFlattening="False"
    EntitySetName="vw_PartsDataByWorkOrder" >
</asp:EntityDataSource>

<asp:EntityDataSource ID="EntityDataSourceWorkOrders" runat="server"
    AutoGenerateOrderByClause="True" AutoGenerateWhereClause="True"
    ConnectionString="name=Admiral_NSSAEntities"
    DefaultContainerName="Admiral_NSSAEntities" EnableFlattening="False"
    EntitySetName="vw_WorkOrders" Where="">
    <WhereParameters>
        <asp:ControlParameter ControlID="DropDownListVisit" DbType="Guid"
            Name="VisitID" PropertyName="SelectedValue" />
    </WhereParameters>
</asp:EntityDataSource>

<asp:EntityDataSource ID="EntityDataSourceVisitInfo" runat="server"
    AutoGenerateOrderByClause="True" AutoGenerateWhereClause="True"
    ConnectionString="name=Admiral_NSSAEntities"
    DefaultContainerName="Admiral_NSSAEntities" EnableFlattening="False"
    EntitySetName="vw_VisitInfo" Where="">
    <WhereParameters>
        <asp:ControlParameter ControlID="DropDownListVisit" DbType="Guid"
            Name="VisitID" PropertyName="SelectedValue" />
    </WhereParameters>
</asp:EntityDataSource>

</asp:Content> 
```

后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Microsoft.Reporting.WebForms;
using System.Configuration;

public partial class Secured_Reports_SummeryReportOutBriefAll : System.Web.UI.Page
{    
    protected void Page_Load(object sender, EventArgs e)
    {               
        if (DropDownListVisit.SelectedValue == "")
        {
            this.ReportViewerSummeryReportOutBrief.Visible = false;

            ReportViewerSummeryReportOutBrief.LocalReport.Refresh();             
            ReportViewerSummeryReportOutBrief.LocalReport.SubreportProcessing += new SubreportProcessingEventHandler(SubreportProcessingEventHandler);               
        }
    }

    public void SubreportProcessingEventHandler(object sender, SubreportProcessingEventArgs e)
    {

        e.DataSources.Add(new ReportDataSource("PartsDataByWorkOrder", this.EntityDataSourcePartsDataByWorkOrder));
    }

    protected void DropDownListVisit_SelectedIndexChanged(object sender, EventArgs e)
    {
        //In App_Code _TemplateFiles
        Reports.ShowReport(this.DropDownListVisit, this.ReportViewerSummeryReportOutBrief);
    }

} 
```

# amazon-web-services - 哪个 oracle .jar 文件与 AWS 工具包一起用于 Eclipse？

> ID：14824700
> 
> 赞同：0
> 
> 时间：2013-02-12T03:00:33.370
> 
> 标签：amazon-web-services

有谁知道哪个 Oracle .jar 文件适合用于从 AWS Toolkit for Eclipse 连接到 AWS Oracle RDS？（当前版本是 AWS 上最新最好的版本：11.2.0.2.v5）

谢谢，黛比![截屏](../Images/a421ff9d464f53e85a5f438f1a3e5fc7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:03:38.013

您只需使用支持您正在使用的功能的任何[下载。](http://www.oracle.com/technetwork/database/enterprise-edition/jdbc-112010-090769.html)

# javascript - 显示选项文本而不是值

> ID：14824703
> 
> 赞同：1
> 
> 时间：2013-02-12T03:00:58.967
> 
> 标签：javascript, html, forms, dom, option

我有这个代码可以在文本框中显示下拉值。实际上，当我从文本框中的下拉列表中选择一个值时，会显示一个值。如何修改以显示选项文本 insted 值？

```
<select id="Ultra" onchange="run()">
    <!--Call run() function-->
    <option value="0">Select</option>
    <option value="8">text1</option>
    <option value="5">text2</option>
    <option value="4">text3</option>
</select>

<br>
<br>
TextBox1
<br>

<form>
    <input id="srt" placeholder="get value on option select" type="text">
    <br>
    TextBox2<br>
    <input id="rtt" onkeyup="up()" placeholder="Write Something !" type="text">
    <script>
    function run() {
        document.getElementById("srt").value = document.getElementById("Ultra").value;
    }

    function up() {
        //if (document.getElementById("srt").value != "") {
        var dop = document.getElementById("srt").value;
        //}
        pop(dop);
    }

    function pop(val) {
        alert(val);
    }
    </script>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:07:46.097

您需要获取所选选项的文本，例如

```
<!-- pass reference to the element in the call -->
<select id="Ultra" onchange="run(this)"> 
```

脚本：

```
function run(sel) {
  var i = sel.selectedIndex;
  if (i != -1) {
    document.getElementById("srt").value = sel.options[i].text;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:07:58.893

var Select = document.getElementById("Ultra");

var selectedText = Select.options[Select.selectedIndex].text;

# sql - 根据 SQLite 中的一系列值和分数表按总分分组

> ID：14824705
> 
> 赞同：0
> 
> 时间：2013-02-12T03:01:46.243
> 
> 标签：sql, sqlite

给定一张关于人们何时开始和完成任务的大数据表，例如：

```
人 | 任务 | 开始日期 | 结束日期
---------------------------------------------
A 清洁 20-FEB-2012 22-FEB-2012
N 菜肴 2012 年 2 月 20 日 2012 年 2 月 24 日
Z 清洁 21-FEB-2012 23-FEB-2012

```

和一个分数表，根据完成任务所需的时间为每项任务分配 2、3、4 分，例如：

```
| 任务 | 天数 | 分数
--------------------------
清洁 2 2
清洁 1.5 3
清洁 1 4
菜肴 3 2
菜肴 2.5 3
菜肴 2 4

```

我如何生成一个查询，该查询给出每个人对每项任务的总体得分，例如：

```
人 | 任务 | 总体得分
---------------------------------------------
A清洁3.1
一道菜2.7
N 清洁 3.4

```

解决方案一直在巧妙地躲避我，将不胜感激！我目前正在使用 SQLite。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:28:39.347

你的定义有点模糊。但是，以下内容应该对您有所帮助：

```
select t.person, t.task, sum(s.score)
from tasks t left outer join
     score s
     on t.task = s.task and
        s.daysTaken = t.julianday(dateended) - t.julianday(datestarted)
group by t.person, t.task 
```

处理范围有点困难。您需要获取区间的两端，然后进行连接：

```
select t.person, t.task, sum(s.score)
from tasks t left outer join
     (select s.*,
             (select min(days_taken) from score s2 where s2.person = s.person and s2.task = s.task and s2.days_taken > s.days_taken
             ) as nextDays_Taken
      from score s
     ) s
     on t.task = s.task and
        t.julianday(dateended) - t.julianday(datestarted) >= s.days_taken and
        t.julianday(dateended) - t.julianday(datestarted) < nextDays_Taken
group by t.person, t.task 
```

# django-class-based-views - 搜索表单无法使用基于类的视图

> ID：14824706
> 
> 赞同：0
> 
> 时间：2013-02-12T03:01:58.097
> 
> 标签：django-class-based-views

我正在尝试创建一个搜索表单，但它不起作用。这是我的代码：

```
class LocationSearchMixin(object):
    def get_queryset(self):
        q = self.request.GET.get('q')
        if q is None:
            return queryset

class StoreListView(LocationSearchMixin, ListView):
    model = Store

<form action="" method="GET">
    <input type="text" name="q" />
    <button type="submit">search</button>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:03:12.887

您必须在 LocationSearchMixin 中添加一些内容：

```
class LocationSearchMixin(object):
    def get_queryset(self):
        queryset = super(LocationSearchMixin, self).get_queryset()
        q = self.request.GET.get('q')
        if q is None:
            return queryset
        return queryset.filter(location__istartswith=q) 
```

# html - 将视口元标记设置为 1300？

> ID：14824707
> 
> 赞同：0
> 
> 时间：2013-02-12T03:02:04.123
> 
> 标签：html, css, mobile, viewport

我正在尝试修复我的网页设计中的一些页面，并遇到了一个问题，在我的常规桌面浏览器上看起来不错的侧边栏横幅广告似乎在 iPhone 和 Android 设备上显示“屏幕外”。通过将视口元标记设置为更高的值（例如 1300），问题似乎消失了。虽然没有发现任何副作用，但我很好奇将标签设置为这么高的值是否表明存在更大的设计问题？

```
<meta name="viewport" content="width=1300" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:36:54.780

您应该使用此元标记：

```
<meta name="viewport" content="width=device-width"> 
```

例如，如果您在移动设备上查看您的网站，您的网站将会很小且无法查看。

```
<meta name="viewport" content="width=1300" /> 
```

您的元标记所做的是对浏览器说，

> “无论该网站的屏幕宽度（视口宽度）如何，都可以将其渲染为 1300 像素宽的屏幕。”

如果您的视口小于 1300 像素，则将执行“缩小”，如果视口大于 1300 像素，则“放大”。

现在，在我看来，如果你用它来修复你的布局，你会遇到更大的问题。我强烈建议您将引导程序作为一种使您的布局响应的方式。Bootstrap 是一个 css 文件库，您可以将其添加到您的站点中来做很多事情，其中​​之一是创建一个流畅的、响应式的网格系统。

我建议从[这里](http://twitter.github.com/bootstrap/index.html)开始了解引导程序及其可以做什么，然后在谷歌搜索一些文章。每个人都喜欢它！相信我，一旦你意识到它可以让你的生活变得多么简单，你也会爱上它。

[http://twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html)

# android - 如何使用 Jsoup 获取直接从父级下降的子元素？

> ID：14824708
> 
> 赞同：1
> 
> 时间：2013-02-12T03:02:05.190
> 
> 标签：android, jsoup

你使用 Jsoup 来获取一个网站。该网站有多个 div 类，例如：

```
<div class="itemcategories">
Category: <a id="cat_result_7_newamerican" class="category" rel="newamerican" href="/search?cflt=newamerican&amp;find_loc=willowbrook%2C+IL">American (New)</a>
</div>

<div class="itemcategories">
Categories: 
<a id="cat_result_6_breakfast_brunch" class="category" rel="breakfast_brunch" href="/search?cflt=breakfast_brunch&amp;find_loc=willowbrook%2C+IL">Breakfast & Brunch</a>, 
<a id="cat_result_6_tradamerican" class="category" rel="tradamerican" href="/search?cflt=tradamerican&amp;find_loc=willowbrook%2C+IL">American (Traditional)</a>
</div> 
```

等等。

如果我使用以下查询选择器：

```
categories = doc.select("div[class=itemcategories] > a[class=category]"); 
```

*每个直接从div class="itemcategories"* parent下降的子元素都存储在类别 Elements 对象的下一个索引中。所以我无法确定哪些孩子属于哪些父母。有没有办法“连接”每个 div 类中的所有子级并将它们保存在 Elements 对象的单独索引中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:08:54.270

分两步做怎么样？

```
Elements parents = doc.select("div.itemcategories");
for (Element parent : parents)
{
    Elements categories = parent.select("a.category");
    // do something with categories
} 
```

注意使用`.foo`代替`[class=foo]`选择器语法。

**注意**我对 jsoup 的 API 不是很熟悉，所以这段代码可能并不完全正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:23:50.750

除了@Matt Ball 解决方案，我还想出了一步解决方案：

```
// Select the parent's
categories = doc.select(".itemcategories"); 
```

然后简单地使用 children() 方法来获取孩子和 text() 方法来获取所需的文本：

```
categories.get(counter).children().text(); 
```

# qt - QwtPlotCurve 中奇怪的第二行

> ID：14824709
> 
> 赞同：0
> 
> 时间：2013-02-12T03:02:05.393
> 
> 标签：qt, plot, qwt

我有一个文本文件，我可以在其中获取我的值，

我有一个计时器，它可以作为 x 轴的增量器，因此绘图是实时的。

这是我的代码。

```
void gui::x()
{
    int xy = 0;

    QVector<double> x(1000), y(1000);
    FILE *file;

    char line[1024];
    file = fopen("x.txt", "r");

    while (fgets(line,1024,file) != NULL)
    {
        fscanf(file,"%lf %lf", &y[xy], &x[xy]);
        xy++;
    }

    fclose(file);

    QwtPlotCurve *curve = new QwtPlotCurve;
    curve->attach(plot_all[3]);
    curve->setData(y,x);
    curve->

    QwtPlotCurve *curve2 = new QwtPlotCurve;
    curve2->attach(plot[3]);
    curve2->setData(y,x);
} 
```

问题是我的情节下方有一条奇怪的第二行。

谁能帮我？

![心电图](../Images/84b7ce001b02d12d5f690e0d0de89058.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:28:15.817

我通过使用数组而不是向量来解决它。

```
void gui::ecg()
{
    int xy = 0;

    double x[1000], y[1000];
    FILE *file;

    char line[1024];
    file = fopen("ecg.txt", "r");

    while (fgets(line,1024,file) != NULL)
    {
        fscanf(file,"%lf %lf", &y[xy], &x[xy]);
        xy++;
    }

    fclose(file);

    QwtPlotCurve *curve = new QwtPlotCurve;
    curve->attach(plot_all[0]);
    curve->setData(x,y,1000);
    curve->setPen(QPen(Qt::blue,1));

    QwtPlotCurve *curve2 = new QwtPlotCurve;
    curve2->setStyle(QwtPlotCurve::Lines);
    curve2->attach(plot[0]);
    curve2->setData(x,y,1000);
    curve2->setPen(QPen(Qt::blue,1));
} 
```

# python - 使用 SQLAlchemy 记录金字塔异常 - 命令未提交

> ID：14824737
> 
> 赞同：3
> 
> 时间：2013-02-12T03:06:09.447
> 
> 标签：python, sqlalchemy, pyramid

我正在使用带有 SQLAlchemy 的 Pyramid Web 框架，连接到 MySQL 后端。我组装的应用程序可以运行，但我试图通过一些增强的日志记录和异常处理来添加一些润色。

我基于 Pyramid 网站上的基本 SQLAlchemy 教程，使用如下会话：

```
DBSession = scoped_session(sessionmaker(extension=ZopeTransactionExtension())) 
```

使用 DBSession 查询效果很好，如果我需要向数据库添加和提交某些内容，我会执行类似的操作

```
DBSession.add(myobject)
DBSession.flush() 
```

所以我得到了我的新身份证。

然后我想将日志记录添加到数据库中，所以我按照[本教程](http://docs.pylonsproject.org/projects/pyramid_cookbook/en/latest/logging/sqlalchemy_logger.html)进行操作。这似乎工作得很好。我最初确实遇到了一些奇怪的事情，我不确定 SQLAlchemy 是如何工作的，所以我将“transaction.commit()”更改为“DBSession.flush()”以强制提交日志（已解决以下！）。

接下来，我想添加自定义异常处理，目的是我可以为任何没有明确捕获并仍然记录的内容放置一个友好的错误页面。因此，基于[此文档](http://docs.pylonsproject.org/projects/pyramid_cookbook/en/latest/pylons/exceptions.html)，我创建了如下错误处理程序：

```
from pyramid.view import (
    view_config,
    forbidden_view_config,
    notfound_view_config
    )

from pyramid.httpexceptions import (
    HTTPFound,
    HTTPNotFound,
    HTTPForbidden,
    HTTPBadRequest,
    HTTPInternalServerError
    )

from models import DBSession

import transaction
import logging

log = logging.getLogger(__name__)

#region Custom HTTP Errors and Exceptions
@view_config(context=HTTPNotFound, renderer='HTTPNotFound.mako')
def notfound(request):
    log.exception('404 not found: {0}'.format(str(request.url)))
    request.response.status_int = 404
    return {}

@view_config(context=HTTPInternalServerError, renderer='HTTPInternalServerError.mako')
def internalerror(request):
    log.exception('HTTPInternalServerError: {0}'.format(str(request.url)))
    request.response.status_int = 500
    return {}

@view_config(context=Exception, renderer="HTTPExceptionCaught.mako")
def error_view(exc, request):
    log.exception('HTTPException: {0}'.format(str(request.url)))
    log.exception(exc.message)

    return {}
#endregion 
```

所以现在我的问题是，异常被捕获并且我的自定义异常视图按预期出现。但是异常不会记录到数据库中。这似乎是因为 DBSession 事务在任何异常时都会回滚。所以我将日志处理程序改回“transaction.commit”。这实际上将我的异常日志提交到数据库，但是现在任何日志语句之后的任何 DBSession 操作都会引发“实例未绑定到会话”错误......这是有道理的，因为根据我在 transaction.commit 之后的理解() 会话被清除。控制台日志总是准确地显示我想要记录的内容，包括将日志信息写入数据库的 SQL 语句。但除非我使用 transaction.commit()，否则它不会提交异常，

Sooooo ....我该如何设置以便我可以登录到数据库，同时也可以捕获并成功地将异常记录到数据库中？我觉得我希望日志处理程序使用某种单独的数据库会话/连接/实例/某些东西，以便它是独立的，但我不清楚它是如何工作的。

或者我应该构建我想做的完全不同的事情？

编辑：我最终使用了一个单独的、特定于日志的会话，专门用于向数据库添加提交日志信息。这似乎运作良好，直到我开始将 Pyramid 控制台脚本集成到混合中，其中我遇到了脚本中的会话和数据库提交问题，不一定像在实际 Pyramid Web 应用程序中那样工作。

事后看来（以及我现在正在做的事情），我使用标准的日志记录和 FileHandlers（特别是 TimedRotatingFileHandlers）并登录到文件系统，而不是记录到数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T06:44:53.333

使用`transaction.commit()`对其他正在提交的模型的更改也会产生意想不到的副作用，这并不是太酷 - 使用 ZopeTransactionExtension 设置“正常” Pyramid 会话背后的想法是，单个会话在请求开始时开始，然后如果一切都成功了会话被提交，如果有异常，那么一切都回滚。最好保留此逻辑并避免在请求中间手动提交内容。

（作为旁注 - DBSession.flush() 不提交事务，它发出 SQL 语句，但事务可以稍后回滚）

对于异常日志之类的东西，我会考虑设置一个单独的会话，它不绑定到 Pyramid 的请求/响应周期（没有 ZopeTransactionExtension），然后使用它来创建日志记录。添加日志记录后，您需要手动提交事务：

```
record = Log("blah")
log_session.add(record)
log_session.commit() 
```

# javascript - AngularJS - 定义一个对象但不运行 ngRepeat

> ID：14824738
> 
> 赞同：1
> 
> 时间：2013-02-12T03:06:11.077
> 
> 标签：javascript, angularjs

我在需要构建内容类型时遇到问题。首先，我定义我的模型。我正在使用 Drupal，所以我需要发送嵌套在以下内容中的值：

```
field_whatever.und[0].value = ""; 
```

假设我为图像定义了一个数组：

```
$scope.field_my_images = {"und": [{}]}; 
```

因为我有一个空白数组：

```
<div ngRepeat="image in field_my_images.und"><img ng-src="{{image.url}}" /></div> 
```

将第一个数组元素打印为空白。当我将新对象推送到 field_my_images 时，它可以正常工作，除了第一个空白元素。

这样做的正确方法是什么？

我可以根据需要添加详细信息并更具体....

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T03:14:14.347

你不应该用这个来初始化你的范围吗？

```
$scope.field_my_images = {"und": []}; 
```

否则，你没有一个空数组，你有一个包含空对象的数组。

# javascript - 如何获取 iframe 元素的 innerHTML 内容

> ID：14824739
> 
> 赞同：4
> 
> 时间：2013-02-12T03:06:26.447
> 
> 标签：javascript, html, google-chrome, iframe, google-chrome-extension

您好我正在尝试获取 iframe 元素的内部 HTML

我的html文档一个结构是这样的

```
<body>
    <div>
        <iframe id="frame1">
            <html>
                <button id="mybutton">click me</button>
            </html>
        </iframe>
    </div>
</body> 
```

我正在创建一个 chrome 扩展我必须在单击带有 id mybutton 的按钮时显示警报我编写了一个内容脚本

```
var greeting = "hola, ";

document.body.innerHTML='<div><iframe id="frame1" src="http://onemoredemo.appspot.com/"></iframe></div>' ;

var iframe = document.getElementById("frame1");
var iframeDocument = iframe.contentDocument || iframe.contentWindow.document

var button = iframeDocument.getElementById("mybutton") ;

if(button ==null)
alert("button is null") ; 
```

当我访问一个页面时，我在 chrome 中安装了这个扩展，然后文档正文变成了一个带有按钮的 iframe。但我正面临一个按钮为空的警报，但 iframe 中有按钮，为什么我的这个按钮为空？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T03:08:01.120

要在 iframe 中获取按钮，这可以工作：

```
var iframe = document.getElementById("frame1");
var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
var button = iframeDocument.getElementById("mybutton"); 
```

显然，您可以使用 导航以获取您想要的内容`iframeDocument`，并`.innerHTML`按照您似乎知道的方式使用。如果 iframe 指向的域不是其父域，则您无法获取 iframe 的内容。

**更新：**

**准备好后**，您需要使用代码来获取框架的文档及其内容，因此您应该使用以下内容：

```
window.onload = function () {
    var greeting = "hola, ";

    var div1 = document.createElement("div");
    var frame1 = document.createElement("iframe");
    frame1.id = "frame1";
    frame1.onload = function () {
        alert("loaded");

        var iframe = document.getElementById("frame1");
        var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;

        var button = iframeDocument.getElementById("mybutton");

        if (button == null) {
            alert("button is null");
        }
    };
    frame1.src = "http://onemoredemo.appspot.com";
    div1.appendChild(frame1);
    document.body.appendChild(div1);
}; 
```

**演示：http:** [//jsfiddle.net/nqTnz/](http://jsfiddle.net/nqTnz/)

重要的是如何创建元素并将其附加到 DOM - 而不仅仅是使用`innerHTML`. iframe的`onload`方法是保证它已经准备好。由于跨域问题，实际操作代码在 jsFiddle 中不起作用，但这是您应该需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:20:53.210

在 jQuery 的源代码中，获取 iframe 文档的解决方案是这样的：

```
var iframeDocument = iframe.contentDocument || iframe.contentWindow.document; 
```

然后您通常可以使用`getElementsByTagName`或`getElementById`选择 DOM 元素：

```
var elem;
if (iframeDocument) {
   elem = iframeDocument.getElementById('mybutton');
} 
```

# mysql - MySQL 调整查找重复查询以包含 NULL

> ID：14824743
> 
> 赞同：0
> 
> 时间：2013-02-12T03:07:20.637
> 
> 标签：mysql, null, duplicates

我正在解决查找重复记录的古老问题。我大部分时间都在那里并且有一个可以工作的查询，但是我在调​​整它以包含多个字段中可能的 NULL 值时遇到了麻烦。这是我所拥有的（PartID 是唯一字段，所有其他字段都包含可能的重复值）：

```
SELECT * 
    FROM PartData AS x
        INNER JOIN x on PartData AS x2 
        ON x.field1=x2.field1 AND x.field2=x2.field2 AND x.field3=x2.field3 AND x.field4=x2.field4
    WHERE x.PartID<>x2.PartID 
```

这工作正常，并找到我没有字段为 NULL 的重复记录。我现在需要调整这个查询，以在比如说 field2 和 field3 中包含 NULL 值的可能性。我希望我的查询不仅返回所有 4 个字段都匹配的记录，而且还返回任何字段为 NULL 的记录（以确定是否重复或只是缺少信息）。

在我的搜索中，我遇到了这种方法：

```
SELECT * 
    FROM PartData AS x
         WHERE EXISTS (SELECT PartID FROM PartData AS x2
    WHERE (x.field1=x2.field1 OR (x.field1 IS NULL) OR (x2.field1 IS NULL)) AND
          (x.field2=x2.field2 OR (x.field2 IS NULL) OR (x2.field2 IS NULL)) AND
          (x.field3-x2.field3 OR (x.field3 IS NULL) OR (x2.field3 IS NULL)) AND
          (x.field4=x2.field4 OR (x.field4 IS NULL) OR (x2.field4 IS NULL)) AND
          x.PartID<>x2.PartID) 
```

但是当我尝试这个时，它返回 0 行。这是不正确的，因为我知道有重复项并且我之前的查询返回了它们。是不是因为第二个版本没有JOIN？我在这里想念什么？

编辑：我希望看到看起来像这样的结果：

```
PartID   field1    field2    field3    field4

1234     1000      2000      NULL      4000
1235     1000      2000      3000      NULL
1241     1001      2001      3001      4001
1242     1001      2001      3001      4001
1253     1002      NULL      NULL      4002
1254     1002      NULL      NULL      4002
1265     1003      2002      2003      NULL
1266     1003      2002      2003      2004 
```

其中每“对”行代表一个重复或可能的重复。它们可以具有全面匹配的值、匹配的值和匹配的 NULL，或者只是在某处包含一个 NULL。

更理想的是，我希望结果看起来像这样：

```
PartID   field1    field2    field3    field4    PartIDa

1234     1000      2000      NULL      4000      1235
1235     1000      2000      3000      NULL      1234
1241     1001      2001      3001      4001      1242
1242     1001      2001      3001      4001      1241
1253     1002      NULL      NULL      4002      1254
1254     1002      NULL      NULL      4002      1253
1265     1003      2002      2003      NULL      1266
1266     1003      2002      2003      2004      1265 
```

在同一行中使用重复的 PartID，但这可能必须是下一步，除非在这个阶段有一种简单的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:35:30.610

尝试像这样修改您的查询：

```
SELECT *
  FROM PartData AS x
       INNER JOIN PartData AS x2 ON
         (x.field1=x2.field1 OR (x.field1 IS NULL AND x2.field1 IS NULL)) AND
         (x.field2=x2.field2 OR (x.field2 IS NULL AND x2.field2 IS NULL)) AND
         (x.field3=x2.field3 OR (x.field3 IS NULL AND x2.field3 IS NULL)) AND
         (x.field4=x2.field4 OR (x.field4 IS NULL AND x2.field4 IS NULL))
 WHERE x.PartID<>x2.PartID 
```

请注意，在比较`x.fieldX`和时`x2.fieldX`，要找到匹配`NULL`的 s，它们都需要是`NULL`，而不是一个或另一个（`AND`，不是`OR`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:13:17.057

您的查询似乎不起作用，因为`x.field1=x2.field2`应该是`x.field1=x2.field1`

# html - 在图像上覆盖 HTML5 画布

> ID：14824747
> 
> 赞同：24
> 
> 时间：2013-02-12T03:07:48.400
> 
> 标签：html, css, html5-canvas

我想要一张从我的数据库上传的图像，在它之上，相同位置的完全相同大小是 HTML5 画布。

我发现的大多数解决方案都在使用 JQuery/JavaScript，但是如果可能的话，我想要一个类似的解决方案，因为图像是从数据库输出的，并且页面上可能有多个图像，并且每个图像都会使用 CSS3有一个画布。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-12T23:37:56.400

是的。

您可以完全在 CSS 中完成此操作，但您必须为每个图像添加一些特定的 HTML 管道。

如果您厌倦了额外的管道，javascript 可以为您完成大部分管道。

这是纯 CSS 版本的小提琴：

[http://jsfiddle.net/m1erickson/g3sTL/](http://jsfiddle.net/m1erickson/g3sTL/)

的HTML：

```
<div class="outsideWrapper">
    <div class="insideWrapper">
        <img src="house-icon.jpg" class="coveredImage">
        <canvas class="coveringCanvas"></canvas>
    </div>
</div> 
```

当然，在您的版本中，您可以将图像 src 替换为动态数据库调用以获取图像。

CSS：

```
.outsideWrapper{ 
    width:256px; height:256px; 
    margin:20px 60px; 
    border:1px solid blue;}
.insideWrapper{ 
    width:100%; height:100%; 
    position:relative;}
.coveredImage{ 
    width:100%; height:100%; 
    position:absolute; top:0px; left:0px;
}
.coveringCanvas{ 
    width:100%; height:100%; 
    position:absolute; top:0px; left:0px;
    background-color: rgba(255,0,0,.1);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T22:32:12.960

[可能重复](https://stackoverflow.com/questions/5241365/how-to-set-the-background-image-of-a-html-5-canvas-to-png-image)。

根据数据库中有多少图像，您可以为每个图像文件的名称（例如`canvas #foo { background:url(foo.jpg) }`）有一个单独的画布ID。我会将其加载到单独的样式表中。:)

如果您的数据库是动态的，那么维护 Javascript 解决方案可能会更容易。几行 javascript 就足够了，而不是不断地用新名称更新样式表。也更不容易~~出错~~。

# list - 采用一对值和一个列表的 Haskell 函数

> ID：14824753
> 
> 赞同：0
> 
> 时间：2013-02-12T03:08:58.420
> 
> 标签：list, function, haskell

我的家庭作业一直把我逼上绝路。我应该编写一个名为的函数，该函数`myRepl`接受一对值和一个列表并返回一个新列表，以便列表中该对的第一个值的每次出现都被第二个值替换。

**例子：**

```
ghci> myRepl (2,8) [1,2,3,4] 
> [1,8,3,4]. 
```

到目前为止，我有这样的东西（但它非常粗糙并且根本无法正常工作。我需要算法方面的帮助：

```
myRep1 (x,y) (z:zs) = 
       if null zs then [] 
       else (if x == z then y : myRep1 zs 
             else myRep1 zs ) 
```

我不知道如何创建一个接受一对值和一个列表的函数。我不确定正确的语法是什么，我不确定如何进行算法。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T04:04:41.990

怎么样：

```
repl (x,y) xs = map (\i -> if i==x then y else i) xs 
```

## 解释

`map`是一个函数，它接受一个函数，将其应用于列表中的每个值，并将该函数的所有返回值组合到一个新列表中。

该`\i ->`符号是编写完整函数定义的快捷方式：

```
-- Look at value i - if it's the same as x, replace it with y, else do nothing
replacerFunc x y i = if x == y then y else i 
```

然后我们可以重写`repl`函数：

```
repl (x, y) xs = map (replacerFunc x y) xs 
```

恐怕`map`您只需要知道该功能 - 了解它的工作原理相对容易。请参阅文档： [http ://www.haskell.org/hoogle/?hoogle=map](http://www.haskell.org/hoogle/?hoogle=map)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T13:01:49.927

没有这个怎么写`map`？现在，一个好的经验法则是首先排除递归的基本情况：

```
myRep1 _ [] = ??? 
```

现在，如果列表元素是您要替换的元素，您需要一种特殊情况。我会为此推荐一个警卫，因为它读起来比`if`：

```
myRep1 (x,y) (z:zs) 
    | x == z = ???
    | otherwise = ??? 
```

由于这是家庭作业，我留了一些空白供您填写:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-13T18:20:32.847

```
myRepl :: Eq a => (a, a) -> [a] -> [a]
myRepl _      []                   = []
myRepl (v, r) (x : xs) | x == v    = r : myRepl (v, r) xs
                       | otherwise = x : myRepl (v, r) xs 
```

未元组参数，无点，根据`map`：

```
replaceOccs :: Eq a => a -> a -> [a] -> [a]
replaceOccs v r  =  map (\ x -> if x == v then r else x) 
```

# javascript - touchenter 事件未被调用

> ID：14824754
> 
> 赞同：7
> 
> 时间：2013-02-12T03:09:14.163
> 
> 标签：javascript, jquery, touch, touch-event

谁能告诉我为什么 touchenter 事件在此代码中不起作用。mouseenter 在桌面上工作正常。应该很简单，但我错过了一些东西。

这里的例子 - [http://jsfiddle.net/gCEqH/6/](http://jsfiddle.net/gCEqH/6/)

完整代码如下：

```
<!DOCTYPE html>
<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    </head>

    <body>
        <img id="myImg" src="http://jackiehutchings.com/wp-content/uploads/2011/09/g-plus-icon-96x96.png" />        

        <script>
            $(window).load(function() { 
            $('#myImg').on("touchenter mouseenter", function(event){
                alert('entered!');
            });
        });
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T23:08:29.083

也许这样的事情会起作用？

```
var elementIdTouching = "";
$('body').on("touchmove", function(e){
    var tList = e.touches; // get list of all touches
    for (var i = 0; i < tList.length; i++) {
        var thisTouch = tList[i]; // not 100% sure about this
        var elementTouching = document.elementFromPoint( 
            thisTouch.screenX, 
            thisTouch.screenY
        );
        if (elementTouching.id != elementIdTouching) {
            elementIdTouching = elementTouching.id;
            if (elementTouching.id == "myImg") {
                alert("entered!");
            }
        }
    }
}).on("touchend", function(e){
    elementIdTouching = "";
});
$('#myImg').on("mouseenter", function(e){
    alert('entered!');
}); 
```

tList ~ [https://developer.mozilla.org/en-US/docs/Web/API/TouchList](https://developer.mozilla.org/en-US/docs/Web/API/TouchList)

免责声明：我没有测试过这个。

# html - 使用 CSS 定位没有容器的文本

> ID：14824755
> 
> 赞同：4
> 
> 时间：2013-02-12T03:09:19.000
> 
> 标签：html, css, text

我不确定这是否可行，但如果可以的话，它将非常有帮助。我正在 Volusion 框架中的电子商务网站上工作，并且在 Volusion 网站上动态生成了很多文本。大多数文本都像往常一样在`<span>`s 或`<div>`s 中，但每隔一段时间就会在类别标题之后显示一个“：”。您可以在我正在处理的页面中获取的以下代码中看到它：

```
<td>
<span class="PageText_L71n">Qty</span>:
<input type="text" class="v65-productdetail-cartqty" name="QTY.WA-SSPURSE" size="3" maxlength="8" onkeydown="javascript:QtyEnabledAddToCart();" value="1">
</td> 
```

您可以在`</span>`刚刚显示但不在任何容器中的冒号之后看到冒号。有什么方法可以针对吗？我正在尝试在它上面加上一个`display:none`或`visibility:hidden`，因为我正在做相当多的自定义编码，它现在就挂在那里。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T03:46:37.153

如果您提前知道冒号的容器，您可以更改字体颜色以匹配背景或使用`font-size: 0`（我喜欢它，因为它也删除了不必要的空间）：

```
td {
    font-size: 0;
}
td * {
    font-size: 14px;
} 
```

显然，针对特别适用于您网站的细节进行调整。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T04:49:15.287

如果 td 中的所有元素都是已知的，则使用 :after 和 :before 伪选择器定位所有元素。

```
td span:after {
    content:"<span class="hide">"; }
td input:before {
    content:"</span>"; }
.hide {
    display:none; } 
```

我没有测试过，也没有使用过这些选择器，但它应该可以工作。

如果有多个相同类型的元素，比如三个输入，您可以在 td 上使用 nth-child 选择器。

# javascript - 获取窗口Javascript的正确尺寸

> ID：14824757
> 
> 赞同：0
> 
> 时间：2013-02-12T03:09:29.587
> 
> 标签：javascript, jquery, jquery-mobile

我手机的屏幕高度是 800px。当我这样做时：

```
var windowSize = $(window).height();
alert(windowSize); 
```

它说它只有508px；

我正在使用 jQuery Mobile，不确定这是否会影响屏幕尺寸。

最好的办法是获得正确的手机屏幕高度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:39:25.253

您正在寻找的是：

```
screen.height 
```

[http://www.w3schools.com/jsref/obj_screen.asp](http://www.w3schools.com/jsref/obj_screen.asp)

# google-app-engine - ndb.transaction_async() 与事务中的异步调用

> ID：14824763
> 
> 赞同：12
> 
> 时间：2013-02-12T03:10:25.220
> 
> 标签：google-app-engine, app-engine-ndb

我正在将我的 ndb 代码库尽可能多地移动到异步的过程中。有一种情况我不太确定如何进行：事务。

正如我所看到的，我有 3 个可用选项：

### 选项 1：`ndb.transaction()`同步调用，并让事务的函数调用异步方法。

```
def option_1():
    @ndb.tasklet
    def txn():
        e = yield Foo.get_by_id_async(some_id)
        if e is None:
            e = yield Foo().put_async()
        raise ndb.Return(e)

    # The doc for ndb.transaction() says that it takes a function or tasklet.
    # If it's a tasklet, does it wait on the Future that is returned?
    # If it doesn't wait, what is the proper way to call a tasklet in a transaction
    # and get access to its return value?
    return ndb.transaction(txn) 
```

### 选项 2：`ndb.transaction()`异步调用，并让事务的函数调用同步方法。

```
@ndb.toplevel
def option_2():
    def txn():
        e = Foo.get_by_id(some_id)
        if e is None:
            e = Foo().put()
        return e

    result = yield ndb.transaction_async(txn)
    return result 
```

### 选项 3：`ndb.transaction()`异步调用，并让事务的函数调用异步方法。

```
@ndb.toplevel
def option_3():
    @ndb.tasklet
    def txn():
        e = yield Foo.get_by_id_async(some_id)
        if e is None:
            e = yield Foo().put_async()
        raise ndb.Return(e)

    result = yield ndb.transaction_async(txn)
    return result 
```

我觉得选项 3 是可以选择的，但我宁愿依靠专家意见/建议......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T17:18:36.127

是的，＃3绝对是要走的路。另外两个的问题是他们混合了异步和同步代码，除了在应用程序的最顶层之外，这通常不是一件好事。

PS。事实上，如果它是一个小任务，事务会等待回调。

# sql - 如何动态选择免费的表列？

> ID：14824764
> 
> 赞同：2
> 
> 时间：2013-02-12T03:10:25.703
> 
> 标签：sql, oracle, oracle10g, sql-update, dynamic-programming

考虑下表

```
--------------------------------
ID   | ColA    | ColB   | ColC
--------------------------------
1    | ABC     |        |
2    |         | XYZ    |
3    | PQR     |        |
4    | MNO     | PQR    | 
```

现在我必须在此表中添加一个值（EFG），`ID = 1`在任何列中，如`ColA`，`ColB`或`ColC`取决于哪个是免费的（空的）。这是动态或编程完成的（考虑任何语言，我只想知道逻辑）。

例如：

如果`ID = 1`，列`ColB`将使用值更新，因为它是第一个空闲列。
如果`ID = 2`，列`ColA`将使用值更新，因为它是第一个空闲列。
如果`ID = 3`，列`ColB`将使用值更新，因为它是第一个空闲列。
如果`ID = 4`，列`ColC`将使用值更新，因为它是第一个空闲列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:17:04.807

由于记录已经插入，您只需要更新行，

```
UPDATE  tableName
SET     ColA = CASE WHEN ColA IS NULL THEN 'NewValue' ELSE ColA END,
        ColB = CASE WHEN ColA NOT NULL AND ColB IS NULL THEN 'NewValue' ELSE ColB END,
        ColC = CASE WHEN ColA NOT NULL AND ColB NOT NULL AND ColC IS NULL THEN 'NewValue' ELSE ColC END
WHERE   ID = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:18:29.530

尝试这个：

```
UPDATE table
   SET ColA=IF(ColA IS NULL, 'EFG', ColA),
       ColB=IF(ColA IS NULL, ColB, IF(ColB IS NULL, 'EFG', ColB)),
       ColC=IF(ColA IS NULL, ColC, IF(ColB IS NULL, ColC, IF(ColC IS NULL, 'EFG', ColC)))
 WHERE ID=1 
```

`ColA`如果、`ColB`和`ColC`都已满，您没有定义行为应该是什么，但在上面给出的示例代码中，什么都不会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T03:17:12.277

以此为起点：

```
UPDATE Table Set 
ColA = CASE WHEN ColA IS NULL THEN 'EFG' ELSE ColA END,
ColB = CASE WHEN ColB IS NULL THEN 'EFG' ELSE ColB END,
ColC = CASE WHEN ColC IS NULL THEN 'EFG' ELSE ColC END
WHERE ID = 1 
```

# javascript - history.pushState - 不工作？

> ID：14824766
> 
> 赞同：19
> 
> 时间：2013-02-12T03:10:31.960
> 
> 标签：javascript, html, history, pushstate, pjax

我想在不重新加载的情况下更改 html。我这样做：

```
$('#left_menu_item').click(function(e) {
    if (!!(window.history && history.pushState)) {
        e.preventDefault();
        history.pushState(null, null, newUrl);
    }
}); 
```

它工作正常。但是，如果我想使用“返回”按钮返回 - 浏览器会更改以前的 url，但它不会重新加载页面。为什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-12T05:19:10.270

这种行为是预期的，并且符合操作历史堆栈的[规范](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)。

这是一个解释起来相对复杂的问题。但简而言之，可以这样想：用户在历史堆栈上推送的任何历史条目（使用 pushState 等）在您从中移动时都不值得页面加载，因为它被认为是假的（用户生成的）历史条目。

**为什么？** 这种行为是一件好事，并且与让开发人员对页面有更多控制权而不被迫重新加载它的意图一致（将其想象为 ajax：您可以做以前只能通过页面重新加载才能完成的事情，例如获取数据，但是现在您可以在不使用[XMLHttpRequest](http://www.w3schools.com/xml/xml_http.asp)对象重新加载页面的情况下执行此操作）.. 如果您想模仿单击后退按钮时重新加载页面的行为.. 您可以`location.reload()`在处理`window.onpopstate`事件时简单地调用

* * *

**如何？** 这可能超出了您的问题范围，但我只是想把它放在那里来描述我们在说什么

[让我在这里](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)使用现有示例进行解释（摘录文本将用*斜体显示*）：

*假设[http://mozilla.org/foo.html](http://mozilla.org/foo.html)执行以下 JavaScript：*

```
var stateObj = { foo: "bar" };
history.pushState(stateObj, "page 2", "bar.html"); 
```

*这将导致 URL 栏显示[http://mozilla.org/bar.html](http://mozilla.org/bar.html)，但不会导致浏览器加载 bar.html 甚至检查 bar.html 是否存在。*

可以将其想象为您正在历史堆栈中创建一个与实际页面加载无关的条目.. 而不是“假”页面加载（即您只是使用 javascript 来操作 dom 并插入 html）..

*现在假设用户现在导航到[http://google.com](http://google.com)，然后点击返回。此时，URL 栏将显示[http://mozilla.org/bar.html](http://mozilla.org/bar.html)，页面将获得一个 popstate 事件，其 state 对象包含 stateObj 的副本。页面本身看起来像 foo.html，尽管页面可能会在 popstate 事件期间修改其内容。*

[这里的重点是 bar.html 是位于原始http://mozilla.org/foo.html](http://mozilla.org/foo.html)之上的虚假历史条目.. 所以你会在 url [http://mozilla.org/bar 上看到。 html](http://mozilla.org/bar.html)但内容将属于 ​​foo （在此示例中，请注意，当我们推送 bar.html 时，我们没有操纵 dom 的内容。如果我们在您的示例中确实喜欢......那么该内容也会显示出来）。这里的关键是页面**重新加载！**.. 因为我们提供的页面在历史堆栈上有一个 genuin 条目（即使在 url 上......我们正在显示一个与历史堆栈上的假条目相关联的 url）。

还将此讨论与手动处理 popstate 事件的页面分开。这是一个不同的故事，只会使事情复杂化。

*如果我们再次单击返回，URL 将变为[http://mozilla.org/foo.html](http://mozilla.org/foo.html)，并且文档将获得另一个 popstate 事件，这次是一个空状态对象。在这里，返回也不会改变上一步中的文档内容，尽管文档可能会在接收到 popstate 事件后手动更新其内容。*

在这里..页面**将无法加载！**.. 那是因为我们正在从一个虚假的历史堆栈条目转移到真实的历史堆栈条目（并且真实的历史堆栈条目已经在上一步中加载......所以页面重新加载，就是这样）。

就是这个例子。这个概念有点难以解释，我鼓励你通过点击真实和虚假页面的组合来测试你的代码，你会看到页面实际加载和不加载的模式。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-02T07:02:58.900

```
window.onpopstate = function(event) {    
    if(event && event.state) {
        location.reload(); 
    }
} 
```

这就是我使用的:)

# file - 如何告诉 VS2010 的 IntelliSense 忽略 .glsl 文件

> ID：14824767
> 
> 赞同：4
> 
> 时间：2013-02-12T03:10:33.443
> 
> 标签：file, visual-studio-2010, glsl, intellisense

我有一个 C++ VS2010 解决方案，它也有 .glsl 着色器文件（我使用 Visual Studio 和 NShader 语法荧光笔来编辑它们）。
但是，在我的 VS2010 的“错误列表”窗口中，永久列出了与这些 .glsl 文件相关的 100 个错误（最常见的错误是“IntelliSense：无法打开源文件 xxx.glsl” - 由于我的 .glsl 文件中的 #include .

如何告诉 IntelliSense 忽略具有此扩展名的文件（因为它无法处理它们）？

# magento - 在 Magento 中设置产品上线和禁用日期

> ID：14824768
> 
> 赞同：1
> 
> 时间：2013-02-12T03:10:36.960
> 
> 标签：magento

您好，我想弄清楚我什么时候可以让我的产品在预定日期上线，然后以禁用状态关闭。基本上我每天都会列出一种产品。我想要一个更简单的解决方案，而不是每天熬夜。

我被告知要创建一个日期属性“发布日期”，然后放置一个 cron 作业来更新产品。我不知道如何开发一个 cron 工作新手。请帮忙！一步一步的指导......这对许多 Magento 用户来说将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-14T16:20:46.857

来自[www.ecomdev.org](http://shop.ecomdev.org/scheduled-products.html)（页面已不存在）

**简介** 本文将帮助您了解目录产品的基本自定义以及在 Magento 中执行自定义 cron 作业。

**功能** 在开始开发之前，您应该想象它的作用并选择适合所有需求的功能。

该模块的要求如下：

*   它应该允许管理员用户指定产品的激活和到期日期。

*   它应该检查指定日期的产品并根据日期类型执行以下操作：

    *   如果激活日期成真，则激活产品
    *   如果到期日期成真，则激活产品

所以模块开发应该遵循以下步骤：

1.  创建自定义属性后端模型以允许存储日期时间属性的日期（Magento 本机 eav 实现从日期时间字符串中删除时间部分）

2.  为产品创建两个属性，这可能通过激活和到期日期来实现，并为其分配自定义属性后端模型产品的激活和到期日期以及启用/禁用它们

**基本结构**

现在您知道它应该如何工作了，因此您可以创建一个基本的模块结构。

模块的结构应包含以下内容：

*   模块引导程序和主要配置文件
*   用于属性添加和设置模型的 SQL 升级脚本
*   也将包含 cron 作业的事件观察者类
*   自定义属性后端模型

您应该在创建结构之前命名模块。模块名称由模块名称空间和内部模块名称组成，由下划线符号分隔。所以这个模块的名称将是“EcomDev_ScheduledProduct”，其中“EcomDev”是我的扩展命名空间。

首先，您应该创建模块引导配置文件以启用您的模块。位于“app/etc/modules”文件夹中的引导文件。文件名应与模块名相同。因此，您应该创建文件“EcomDev_ScheduledProduct.xml”，文件结构应包含模块名称、其代码池、活动状态和用于指定所需模块的依赖节点。所以它应该如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <EcomDev_ScheduledProduct>
            <active>true</active> <!-- the module activity state -->
            <codePool>community</codePool> <!-- the module code pool -->
            <depends>
                <Mage_Catalog />  <!-- the module depends on Mage_Catalog module, so it mentioned here -->
            </depends>
        </EcomDev_ScheduledProduct>
    </modules>
</config> 
```

该模块指定放置在社区代码池中，因此应放置在“app/code/community”文件夹中，其路径应为“app/code/community/EcomDev/ScheduledProduct”。

现在您应该创建模块配置文件，您将在其中指定模型命名空间和设置脚本初始化语句。

让我们创建它：“app/code/community/EcomDev/ScheduledProduct/etc/config.xml”</p>

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <EcomDev_ScheduledProduct>
            <version>1.0.0</version>
        </EcomDev_ScheduledProduct>
    </modules>
    <global>
        <models>
            <ecomdev_scheduledproduct>
            <!-- specification of model name space,
                 so we can call models like Mage::getModel('ecomdev_scheduledproduct/somemodelname') -->
                <class>EcomDev_ScheduledProduct_Model</class>
            </ecomdev_scheduledproduct>
        </models>
        <resources>
            <!-- specifying of setup model and setup script path in sql folder -->
            <ecomdev_scheduledproduct_setup>
                <setup>
                    <module>EcomDev_ScheduledProduct</module>
                    <class>EcomDev_ScheduledProduct_Model_Mysql4_Setup</class>
                </setup>
                <connection>
                    <!-- use catalog connection to modify products -->
                    <use>catalog_setup</use>
                </connection>
            </ecomdev_scheduledproduct_setup>
        </resources>
    </global>
</config> 
```

**属性后端模型** 在创建设置脚本之前，您需要处理日期时间属性后端模型以在设置中指定它。在模块“模型”文件夹中创建它。在此模块中，您应该将其命名为“EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime”，路径“Attribute_Backend_Datetime”解释了模型的作用。在其中你应该重写“beforeSave($object)”、“afterLoad($object)”和“formatDate($date)”方法来改变你的属性存储逻辑。您可能还想添加“compareDateToCurrent($date)”方法来检查产品保存之前的激活或到期日期是否正确。该模型应从“Mage_Eav_Model_Entity_Attribute_Backend_Datetime”扩展而来。“app/code/community/EcomDev/ScheduledProduct/Model/Attribute/Backend/Datetime.php”</p>

```
<?php
/**
 * Expiry and Activation dates custom backend model
 *
 */
class EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime extends Mage_Eav_Model_Entity_Attribute_Backend_Datetime
{
    /**
     * Activation date attribute code
     *
     * @var string
     */
    const ATTRIBUTE_ACTIVATION_DATE = 'ecomdev_activation_date';
    /**
     * Expiry date attribute code
     *
     * @var string
     */
    const ATTRIBUTE_EXPIRY_DATE = 'ecomdev_expiry_date';
    /**
     * Status attribute code
     *
     * @var string
     */
    const ATTRIBUTE_STATUS = 'status';
    /**
     * Checks date to update product status
     * on the save in the admin panel
     *
     * @param Mage_Catalog_Model_Product $object
     * @return EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime
     */
    public function beforeSave($object)
    {
        parent::beforeSave($object);
        $code = $this->getAttribute()->getAttributeCode();
        $compareResult = $this->compareDateToCurrent($object->getData($code));
        if ($compareResult !== false) {
            // If the date is set
            if (($compareResult < 0 && $code == self::ATTRIBUTE_ACTIVATION_DATE) ||
                ($compareResult >= 0 && $code == self::ATTRIBUTE_EXPIRY_DATE)) {
                // If the date is in the past and it's activation date
                // or the date is in the future and it's expiry date,
                // so the product should be deactivated
                $object->setData(
                    self::ATTRIBUTE_STATUS,
                    Mage_Catalog_Model_Product_Status::STATUS_DISABLED
                );
            }
        }
        return $this;
    }
    /**
     * Magento native function doesn't save
     * the time part of date so the logic of retrieving is changed
     *
     * @param   string|int $date
     * @return  string|null
     */
    public function formatDate($date)
    {
        if (empty($date)) {
            return null;
        } elseif (!($date instanceof Zend_Date)) {
            // Parse locale representation of the date, eg. parse user input from date field
            $dateString = $date;
            $usedDateFormat = Mage::app()->getLocale()->getDateTimeFormat(
                Mage_Core_Model_Locale::FORMAT_TYPE_SHORT
            );
            // Instantiate date object in current locale
            $date = Mage::app()->getLocale()->date();
            $date->set($dateString, $usedDateFormat);
        }
        // Set system timezone for date object
        $date->setTimezone(Mage_Core_Model_Locale::DEFAULT_TIMEZONE);
        return $date->toString(Varien_Date::DATETIME_INTERNAL_FORMAT);
    }
    /**
     * Compare date to current date
     *
     * Returns -1 if the date is in the past, and 1 if it's in the future,
     * returns 0 if the dates are equal.
     *
     * @param string $date
     * @return int
     */
    public function compareDateToCurrent($date)
    {
        if (empty($date)) {
            return false;
        }
        $compareDate = Mage::app()->getLocale()->date($date, Varien_Date::DATETIME_INTERNAL_FORMAT);
        $currentDate = Mage::app()->getLocale()->date();
        return $currentDate->compare($compareDate);
    }
    /**
     * Converts timezone after object load, fixes issue in the core form element
     *
     * @param Mage_Core_Model_Abstract $object
     * @return EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime
     */
    public function afterLoad($object)
    {
        $code = $this->getAttribute()->getAttributeCode();
        if ($object->getData($code) && !($object->getData($code) instanceof Zend_Date)) {
            $date = Mage::app()->getLocale()->date();
            $dateString = $object->getData($code);
            $currentTimezone = $date->getTimezone();
            $date->setTimezone(Mage_Core_Model_Locale::DEFAULT_TIMEZONE);
            $date->set($dateString, Varien_Date::DATETIME_INTERNAL_FORMAT);
            $date->setTimezone($currentTimezone);
            $object->setData($code, $date);
        }
        return parent::afterLoad($object);
    }
} 
```

**设置** 现在您需要创建设置模型和设置脚本。在配置文件中，设置模型类名称为“EcomDev_ScheduledProduct_Model_Mysql4_Setup”。该模块扩展了目录功能，因此模块设置模型扩展了目录设置模型。“app/code/community/EcomDev/ScheduledProduct/Model/Mysql4/Setup.php”</p>

```
<?php
/**
 * Setup model for scheduled product module, extended from catalog module setup
 */
class EcomDev_ScheduledProduct_Model_Mysql4_Setup extends Mage_Catalog_Model_Resource_Eav_Mysql4_Setup
{
} 
```

您需要在“sql/ecomdev_scheduledproduct_setup”文件夹中创建安装脚本。模块版本是 1.0.0，实际上是第一个版本，所以需要命名为“mysql4-install-1.0.0.php”。此脚本应包含将属性添加到 EAV。同样对于这个模块，我们应该在“catalog_product_entity”表中添加列，因为它会加快产品批量状态更新过程。“app/code/community/EcomDev/ScheduledProduct/sql/ecomdev_scheduledproduct_setup/mysql4-install-1.0.0.php”</p>

```
<?php
/* @var $this EcomDev_ScheduledProduct_Model_Mysql4_Setup */
$this->startSetup();
// For performance reasons we should add this fields to main entity table
// Activation date column adding to product entity table
$this->getConnection()->addColumn(
    $this->getTable('catalog/product'),
    EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_ACTIVATION_DATE,
    'DATETIME DEFAULT NULL'
);
// Expiry date column adding to product entity table
$this->getConnection()->addColumn(
    $this->getTable('catalog/product'),
    EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_EXPIRY_DATE,
    'DATETIME DEFAULT NULL'
);
// Activation date attribute information adding to the product entity
$this->addAttribute(
    'catalog_product',
    EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_ACTIVATION_DATE,
    array(
        'type'      => 'static',
        'input'     => 'date',
        'label'     => 'Activation Date',
        'global'    => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_GLOBAL,
        'backend'   => 'ecomdev_scheduledproduct/attribute_backend_datetime',
        'visible'   => 1,
        'required'  => 0,
        'position'  => 10,
        'group'     => 'Schedule Settings'
    )
);
// Expiry date attribute information adding to the product entity
$this->addAttribute(
    'catalog_product',
    EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_EXPIRY_DATE,
    array(
        'type'      => 'static',
        'input'     => 'date',
        'label'     => 'Expiry Date',
        'global'    => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_GLOBAL,
        'backend'   => 'ecomdev_scheduledproduct/attribute_backend_datetime',
        'visible'   => 1,
        'required'  => 0,
        'position'  => 20,
        'group'     => 'Schedule Settings'
    )
);
$this->endSetup(); 
```

**事件观察** 器 创建设置脚本和后端模型后，您需要注意属性的输入字段渲染，这就是为什么您需要观察“adminhtml_catalog_product_edit_prepare_form”事件的原因。因此，您应该使用“observeProductEditFortInitialization(Varien_Event_Observer $observer)”方法创建“EcomDev_ScheduledProduct_Model_Observer”类。它应该检查具有日期属性代码的元素的表单对象，如果发现任何元素，则向它们添加日期时间格式。

```
<?php
/**
 * Observer for core events handling
 *
 */
class EcomDev_ScheduledProduct_Model_Observer
{
    /**
     * Observes event 'adminhtml_catalog_product_edit_prepare_form'
     * and adds custom format for date input
     *
     * @param Varien_Event_Observer $observer
     * @return void
     */
    public function observeProductEditFortInitialization(Varien_Event_Observer $observer)
    {
        $form = $observer->getEvent()->getForm();
        $elementsToCheck = array(
            EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_ACTIVATION_DATE,
            EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_EXPIRY_DATE
        );
        foreach ($elementsToCheck as $elementCode) {
            $element = $form->getElement($elementCode);
            if (!$element) {
                continue;
            }
            $element->setFormat(
                Mage::app()->getLocale()->getDateTimeFormat(
                    Mage_Core_Model_Locale::FORMAT_TYPE_SHORT
                )
            );
            $element->setTime(true);
        }
    }
} 
```

您还需要在模块配置文件 (config.xml) 中定义事件观察器：

```
<config>
    <!-- here goes the code you've created before
          ...
          ...
      -->
    <adminhtml>
        <events>
            <adminhtml_catalog_product_edit_prepare_form>
                <observers>
                    <ecomdev_scheduledproduct>
                        <type>singleton</type>
                        <model>ecomdev_scheduledproduct/observer</model>
                        <method>observeProductEditFortInitialization</method>
                    </ecomdev_scheduledproduct>
                </observers>
            </adminhtml_catalog_product_edit_prepare_form>
        </events>
    </adminhtml>
</config> 
```

**Cron 作业** 当您为属性设置管理界面后，您需要创建一个自动激活/停用产品的 cron 作业。您可以将逻辑放在“EcomDev_ScheduledProduct_Model_Observer”类中，因为 cron 作业处理调用的实现类似于事件处理，只是不会获取 $observer 参数。

```
<?php
/**
 * Observer for core events handling and cron jobs processing
 *
 */
class EcomDev_ScheduledProduct_Model_Observer
{
    /*
     * here goes the code you've created before
     * ............
     * ............
     */
    /**
     * Cron job for processing of scheduled products
     *
     * @return void
     */
    public function cronProcessScheduledProducts()
    {
        $currentDate = Mage::app()->getLocale()->date()->toString(
            Varien_Date::DATETIME_INTERNAL_FORMAT
        );
        $productModel = Mage::getModel('catalog/product');
        /* @var $expiredProductsCollection Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection */
        // Prepare collection of scheduled for expiry but haven't yet deactivated products
        $expiredProductsCollection = $productModel->getCollection()
            // Add filter for expired but products haven't yet deactivated
            ->addFieldToFilter(
                EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_EXPIRY_DATE,
                array(
                    'nnull' => 1,  // Specifies that date shouldn't be empty
                    'lteq' => $currentDate // And lower than current date
                )
            )
            ->addFieldToFilter(
                EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_STATUS,
                Mage_Catalog_Model_Product_Status::STATUS_ENABLED
            );
        // Retrieve product ids for deactivation
        $expiredProductIds = $expiredProductsCollection->getAllIds();
        unset($expiredProductsCollection);
        if ($expiredProductIds) {
            Mage::getSingleton('catalog/product_action')
                ->updateAttributes(
                         $expiredProductIds,
                         array('status' => Mage_Catalog_Model_Product_Status::STATUS_DISABLED),
                         Mage_Core_Model_App::ADMIN_STORE_ID
                );
        }
        /* @var $expiredProductsCollection Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection */
        // Prepare collection of scheduled for activation but haven't yet activated products
        $activatedProductsCollection = $productModel->getCollection()
            ->addFieldToFilter(
                EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_ACTIVATION_DATE,
                array(
                    'nnull' => 1, // Specifies that date shouldn't be empty
                    'lteq' => $currentDate // And lower than current date
                )
            )
            // Exclude expired products
            ->addFieldToFilter(
                EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_EXPIRY_DATE,
                array(
                    array('null' => 1), // Specifies that date shouldn't be empty
                    array('gt' => $currentDate) // And greater than current date
                )
            )
            ->addFieldToFilter(
                EcomDev_ScheduledProduct_Model_Attribute_Backend_Datetime::ATTRIBUTE_STATUS,
                Mage_Catalog_Model_Product_Status::STATUS_DISABLED
            );
        // Retrieve product ids for activation
        $activatedProductIds = $activatedProductsCollection->getAllIds();
        unset($activatedProductsCollection);
        if ($activatedProductIds) {
            Mage::getSingleton('catalog/product_action')
                ->updateAttributes(
                         $activatedProductIds,
                         array('status' => Mage_Catalog_Model_Product_Status::STATUS_ENABLED),
                         Mage_Core_Model_App::ADMIN_STORE_ID
                );
        }
    }
} 
```

当然，您应该在配置文件 (config.xml) 中定义您的 cron 作业：

```
<config>
    <!-- here goes the code you've created before
          ...
          ...
      -->
    <crontab>
        <jobs>
            <ecomdev_scheduledproduct_process_schedule>
                <schedule>
                    <!-- Schedule for every 5 minutes -->
                    <cron_expr>*/5 * * * *</cron_expr>
                </schedule>
                <run>
                    <model>ecomdev_scheduledproduct/observer::cronProcessScheduledProducts</model>
                </run>
            </ecomdev_scheduledproduct_process_schedule>
        </jobs>
    </crontab>
</config> 
```

**结果** 现在您应该登录到管理面板，导航“系统 -> 缓存管理 -> 刷新 Magento 缓存”以启用您的扩展。您可以在“计划设置”选项卡的“目录 -> 管理产品 -> 编辑/添加产品”页面中找到您创建的字段。并且不要忘记在您的系统 crontab 中设置 Magento cron。

**结论** 现在您知道了如何使用 Magento 中的 cron 作业为目录创建简单的自定义。Magento Connect 上提供的模块可作为免费社区扩展：[预定产品](http://shop.ecomdev.org/scheduled-products.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-11T17:14:42.940

我认为[Product Scheduler](https://ewebler.com/store/product-scheduler-magento-2.html)最适合您的要求。它有助于

*   设置产品启用/禁用日期
*   商店产品可用性的时间跨度
*   设置新产品发布日期

# ruby-on-rails - rails，创建一个对象

> ID：14824769
> 
> 赞同：0
> 
> 时间：2013-02-12T03:10:38.777
> 
> 标签：ruby-on-rails, object

早上好，

我有两个脚手架人和城市。

```
rails g scaffold person :name, city_id
rails g scaffold city :cityname 
```

和一个公式视图/人/

```
 <div class="field">
     <%= f.label :name %><br />
     <%= f.text_field :name %>
  </div>
  <div class="field">
     <%= f.label :city_id %><br />
     <%= f.text_field :city_id %>
  </div>
    <div class="field">
    <%= f.label :cityname%><br />
    <%= f.text_field :cityname%>
  </div> 
```

它不去，我必须创建一个城市对象并将 id 放在 city_id hidden_​​field 中，然后在选择创建按钮后所有应该保存在数据库中。

是不是太难了？你会给谁做这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:16:48.877

无需通过`city_id`。

```
 <%= form_tag url_for(:controller => :your_controller, :action => :some_action, :method => :get do %>
    <div class="field">
      <%= label_tag :name %><br />
      <%= text_field_tag :name %>
    </div>
    <div class="field">
      <%= label_tag :cityname%><br />
      <%= text_field_tag :cityname%>
    </div>
  <% end %> 
```

在控制器中：

```
 def some_action
    city = City.find_or_create_by_cityname(params[:cityname])
    person = Person.new(params[:name])
    person.city_id = city.id
    person.save!
  end 
```

# java - 无法在 Jframe/标签内重新绘制

> ID：14824772
> 
> 赞同：0
> 
> 时间：2013-02-12T03:10:58.480
> 
> 标签：java, swing, jframe, jlabel, event-dispatch-thread

基本上，有两个不同的 BufferedImage 称为 img_w 和 img_b1 ...一旦我将 Jframe/label 设置为其中之一，它就永远不会改变或永远不会 repants() 到新的 Imagebuffered 值...

提前致谢..

```
BufferedImage img_w = new BufferedImage(old_width_i, old_height_i, BufferedImage.TYPE_INT_RGB);
BufferedImage img_b1 = new BufferedImage(old_width_i, old_height_i, BufferedImage.TYPE_INT_RGB);

// add data into the img_w and img_b1

JFrame frame=new JFrame();
JLabel label = new JLabel(new ImageIcon(img_w));
frame.getContentPane().add(label, BorderLayout.WEST);
frame.pack();
frame.setVisible(true); 
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

try {
    Thread.sleep(1000);
} catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}

//I am trying to sleep only cause I want to make out if the image is changing or not or basically , to have a rotating illusion...

System.out.println("Hello");
frame.getContentPane().add(new JLabel(new ImageIcon(img_w)), BorderLayout.WEST);
frame.repaint();

label = new JLabel(new ImageIcon(img_b1));
frame.getContentPane().add(label,BorderLayout.WEST); //display the image (works)
label.repaint(); //update the display??
frame.repaint();
frame.getContentPane().repaint(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:57:19.093

这个...

```
try {
    Thread.sleep(1000);
} catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

将阻止 UI 处理绘制请求，直到结束。你永远不应该阻止 EDT。

下面的示例（很简单）并演示了一种在图片之间手动移动的简单方法。

```
public class FlipPictures {

    public static void main(String[] args) {
        new FlipPictures();
    }

    public FlipPictures() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new PicturePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class PicturePane extends JPanel {

        private JLabel picture;
        private File[] pictures;
        private int currentPicture = -1;

        public PicturePane() {

            pictures = new File("/point/me/to/a/directory/of/images").listFiles(new FileFilter() {
                @Override
                public boolean accept(File pathname) {
                    String name = pathname.getName().toLowerCase();
                    return name.endsWith(".png") 
                            || name.endsWith(".gif") 
                            || name.endsWith(".jpg")
                            || name.endsWith(".jpeg")
                            || name.endsWith(".bmp");
                }
            });

            setLayout(new BorderLayout());
            picture = new JLabel();
            picture.setHorizontalAlignment(JLabel.CENTER);
            picture.setVerticalAlignment(JLabel.CENTER);
            add(picture);

            JButton change = new JButton("Change");
            add(change, BorderLayout.SOUTH);

            change.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    changePicture();
                }
            });
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        protected void changePicture() {

            if (pictures != null && pictures.length > 0) {

                currentPicture++;
                if (currentPicture >= pictures.length) {
                    currentPicture = 0;
                }

                try {
                    // This is a potentionally blocking process and really should be threaded...
                    picture.setIcon(new ImageIcon(ImageIO.read(pictures[currentPicture])));
                    picture.setText(null);
                } catch (IOException ex) {
                    ex.printStackTrace();
                    picture.setText(ex.getMessage());
                }

            } else {

                picture.setText("No Pictures :(");

            }

        }

    }

} 
```

**更新**

或者，如果您更喜欢在图像之间自动切换

```
public class FlipPictures {

    public static void main(String[] args) {
        new FlipPictures();
    }

    public FlipPictures() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new PicturePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class PicturePane extends JPanel {

        private JLabel picture;

        public PicturePane() {
            setLayout(new BorderLayout());
            picture = new JLabel();
            picture.setHorizontalAlignment(JLabel.CENTER);
            picture.setVerticalAlignment(JLabel.CENTER);
            add(picture);

            BackgroundSwitcher switcher = new BackgroundSwitcher(this);
            switcher.execute();

        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        public void setPicture(BufferedImage image) {

            picture.setIcon(new ImageIcon(image));

        }

    }

    public class BackgroundSwitcher extends SwingWorker<Void, BufferedImage> {

        private File[] pictures;
        private int currentPicture = -1;
        private PicturePane picturePane;

        public BackgroundSwitcher(PicturePane picturePane) {
            pictures = new File("/point/me/to/a/directory/of/images").listFiles(new FileFilter() {
                @Override
                public boolean accept(File pathname) {
                    String name = pathname.getName().toLowerCase();
                    return name.endsWith(".png")
                            || name.endsWith(".gif")
                            || name.endsWith(".jpg")
                            || name.endsWith(".jpeg")
                            || name.endsWith(".bmp");
                }
            });
            this.picturePane = picturePane;
        }

        @Override
        protected void process(List<BufferedImage> chunks) {
            picturePane.setPicture(chunks.get(chunks.size() - 1));
        }

        @Override
        protected Void doInBackground() throws Exception {
            if (pictures != null && pictures.length > 0) {
                while (true) {

                    currentPicture++;
                    if (currentPicture >= pictures.length) {
                        currentPicture = 0;
                    }

                    try {
                        publish(ImageIO.read(pictures[currentPicture]));
                    } catch (IOException ex) {
                        ex.printStackTrace();
                    }
                    Thread.sleep(1000);
                }
            }
            return null;
        }
    }
} 
```

你可能想看看[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T04:20:15.840

您的代码不完整，所以我们所能做的就是猜测。下次发布[SSCCE](http://sscce.org/)。

我猜问题在于您正在将组件添加到可见框架中。您没有在面板上调用 revalidate()，因此标签的大小保持 (0, 0)。

但是，无需创建新的 JLabel。只需通过调用现有标签的 setIcon() 方法来更改图像，标签就会自行重新绘制。无需在框架或任何其他组件上调用 repaint()。

# orchardcms - 如何在 Orchard CMS 中对子页面进行分组

> ID：14824774
> 
> 赞同：2
> 
> 时间：2013-02-12T03:11:18.047
> 
> 标签：orchardcms

我想知道 Orchard 中是否有一种方法或任何人都知道的插件/模块可以让您在 Orchard 中创建子页面，这样当我转到内容 - > 页面时，我不会查看大量页面列表；我想查看主页面列表及其下分组的子页面？

这可能吗？

在相关说明中......当您使用导航小部件（使用菜单）时，当我在“子页面”上时，我想将主要项目突出显示为当前导航项目。

例如，我的公司页面有一个单独的领导页面，当您在该页面上时，我想突出显示公司导航栏项目（因为领导是一个子页面）。

任何建议都会非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T08:57:29.023

您可以通过多种方式在 Orchard 中实现这一目标：

1.  您可以使用博客和博客文章：

    *   博客是父页面
    *   博客文章是子页面
    *   博客文章的 URL 可以包含博客的 URL，您可以使用它来创建菜单。
2.  您还可以使用`Orchard.Lists`模块，它使您能够添加`Containable`和`Container`部件以获得类似于博客的功能，但适用于其他内容类型。[您可以在此处](http://docs.orchardproject.net/Documentation/Creating-lists)查看有关如何操作的教程

3.  您可以使用`Orchard.Taxonomies`模块来创建页面层次结构并为您的菜单使用分类法

4.  最后，您可以通过使用普通页面并为它们提供分层命名的 slug 手动执行此操作（例如，父页面可以有 URL `/parent`，子页面可以有 slug `/parent/child`）。然后，您可以手动创建一个分层菜单，由您创建的页面组成，并使用 slugs 在菜单中突出显示您的父页面。

# c# - 不是所有网站都使用 CAS 自动登录？

> ID：14824778
> 
> 赞同：0
> 
> 时间：2013-02-12T03:12:14.500
> 
> 标签：c#, single-sign-on, cas, autologin

我已经有一个工作的 CAS 并且其他站点具有单点登录的能力。但是有一个站点，它不会自动登录。尽管我已在 CAS 中成功登录，但它会将我重定向到站点登录页面。

SSO 是否有可能在其他站点上不起作用？为什么是这样？SSO 将在该站点上工作的要求是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T10:51:21.010

SSO 适用于所有其他服务站点。上述情景。您所描述的只有在您传递`renew=true`参数时才会发生`serviceUrl`。

例如：您对 CAS 服务器的请求 url 如下所示

[https://www.yourcasserver.com/cas/login?service=http://youwebapp.com&renew=true](https://www.yourcasserver.com/cas/login?service=http://youwebapp.com&renew=true)

在这种情况下，参数`renew=true`，它允许客户端建议 CAS 服务器登录始终对用户进行身份验证，而不管是否已经存在单点登录会话。

这是 CAS 服务器的有用特性，因为某些服务希望使用 CAS 作为身份验证机制，但允许访问敏感材料。他们可以强制 CAS 重新对用户进行身份验证，以确保他们登录的是正确的用户（并且它不是未终止的预先存在的 SSO 会话。

要为所有客户端应用程序使用 CAS SSO 服务，您必须设置“renew=false”参数，否则您没有将任何更新参数传递给 CAS 登录页面 URL。

# sql - 基本 SQL 子查询

> ID：14824780
> 
> 赞同：2
> 
> 时间：2013-02-12T03:12:15.990
> 
> 标签：sql, select, subquery

我有一张名为 products 的表。基本上我需要在这样的各个字段中使用相同的单词进行搜索，这样可以正常工作。

```
SELECT
    `id`,
    `product-id`,
    `country`,
    `name`,
    `description`,
    `branch`,
    `stock`,
    `price`
FROM
    `products`
WHERE
    `name` LIKE "%car%"
OR `description` LIKE "%car%"
OR `branch` LIKE "%car%"
OR `product-id` LIKE "%car%" 
```

问题是现在我想要一个不同的查询。我只想显示来自特定国家/地区的所有汽车，以及其他字段。所以如果我运行这个查询

```
SELECT
    DISTINCT(b.`id`) id,
    a.id,
    a.`product-id`,
    a.`country`,
    a.`name`,
    a.`description`,
    a.`branch`,
    a.`stock`,
    a.`price`
FROM
    `products` as a,
(
    SELECT
        *
    FROM
        `products`
    WHERE
        `country` = "Canada"
    LIMIT 0,
    10
)AS b
WHERE
    a.`id` = b.`id`
OR  b.`product-id` LIKE "%car%"
OR  b.`name` LIKE "%car%"
OR  b.`branch` LIKE "%car%"
OR  b.`description` LIKE "%car%"

LIMIT 0, 10 
```

我从多个国家/地区获得结果，我做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:20:09.617

您不需要额外的连接。只需将条件添加到`where`带有适当括号的子句中：

```
SELECT
    `id`,
    `product-id`,
    `country`,
    `name`,
    `description`,
    `branch`,
    `stock`,
    `price`
FROM
    `products`
WHERE
    country = 'Canada' and
    ( `name` LIKE "%car%"
     OR `description` LIKE "%car%"
     OR `branch` LIKE "%car%"
     OR `product-id` LIKE "%car%"
    )
limit 30 
```

我认为这个限制在这里是合适的，尽管我不确定问题的意图是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:18:04.963

你只需要对你的条件进行分组，

```
SELECT  ...
FROM    ...
WHERE   (a.`id` = b.`id`) AND
        (  
            b.`product-id` LIKE "%car%" OR  
            b.`name` LIKE "%car%" OR  
            b.`branch` LIKE "%car%" OR  
            b.`description` LIKE "%car%"
        ) 
```

# php - 分页脚本不显示超过 3 个链接

> ID：14824781
> 
> 赞同：0
> 
> 时间：2013-02-12T03:12:19.390
> 
> 标签：php, pagination

我正在使用下面的 php 脚本从 mysql 生成注释，并同时对其进行分页。我在数据库中有 19 行，并且我在变量中设置了每页 5 条评论。所以我应该有 4 个链接，即`[1] [2] [3] [4]`. 但我只得到 3 个链接。我没有收到任何错误。即使我将每页设置为 2，我仍然得到 3 个链接。

```
 <?php    
         $per_page = 5;
         $total_query = $query = mysql_query("SELECT COUNT(*) FROM comments ")  or die (mysql_error());

         $pages =  ceil(mysql_result($total_query, 0) / $total_query);

         $page = (isset($_GET['page'])) ? (int)$_GET['page'] : 1;

         $start = ($page - 1) *  $per_page ;

         $query = mysql_query("SELECT * FROM comments LIMIT $start, $per_page")  or die (mysql_error());   

         while ($comment = mysql_fetch_assoc($query)) {

         <?php echo $comment['owner'] ; ?>

         <?php echo htmlspecialchars($comment['body']) ;?>

         <?php $date = date_create($comment['created']); 
         echo  date_format($date, 'F j, Y g:i a'); ?>  

          if ($pages >= 1 && $page <= $pages) {

     for ($x = 1; $x<=$pages; $x++) {

     echo ($x == $page)  ? '<a href="http://127.0.0.1/page.php?page='.$x.'">' . $x 

.'</a> </span>' : '<a href="http://127.0.0.1/page.php?page='.$x.'"> [' . $x .' ]</a> ';

  }
  }
  ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:29:53.500

您的线路：

```
$pages =  ceil(mysql_result($total_query, 0) / $total_query); 
```

得到结果并除以... `$total_query`，应该是`$per_page`。

# java - 来自非结构化文本的通用日期解析库

> ID：14824782
> 
> 赞同：2
> 
> 时间：2013-02-12T03:12:23.867
> 
> 标签：java, parsing, date, text

有人可以建议任何能够从非结构化数据中解析日期/时间日历事件的 Java 库。例子

*   今晚10点开始！2 月 10 日星期日 => 2013 年 2 月 10 日晚上 10 点
*   明天（2 月 10 日）=> 2013 年 2 月 10 日
*   2 月 10 日星期日\r\n每天放映至 2 月 16 日

等等

输入数据来自用户，因此他可以输入任何随机格式的数据。我开始识别所有可能的标记并进行正则表达式匹配来表达所有标记。我想知道是否有人可以建议一些 Java 库，这实际上可能有助于解析。

我浏览了关于 SO 的其他帖子，但他们似乎建议了技术，我想知道是否有人有图书馆。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T14:01:23.157

[您可以从http://opennlp.apache.org/](http://opennlp.apache.org/)上的 Apache openLNP（自然语言处理）获取一些主干源代码，或者通过在您的服务器上实现 openNLP 来设置一个可调用的 RESTful Web 服务。实施 OOB openNLP 的好处是您可以通过 nameFinder 接口获取日期、时间、组织、位置和人员的实体提取器。您还可以为感兴趣的项目构建一个更典型的上下文示例文件，指示其适当的实体类型，并针对它训练 NLP 模型以获得更好的上下文命中率。我在[http://www.augmentedintel.com/apps/csharpnlp/extract-names-from-text.aspx](http://www.augmentedintel.com/apps/csharpnlp/extract-names-from-text.aspx)的投资组合的应用程序部分中有一个 C# NLP 的工作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-01T22:37:05.560

UTAH ( [https://github.com/sonalake/utah-parser](https://github.com/sonalake/utah-parser) ) 能够将非结构化文本通用解析为地图。完成后，您应该可以将其放入格式化程序中。

# c++ - C++ 错误 - 运算符 = 不匹配

> ID：14824783
> 
> 赞同：0
> 
> 时间：2013-02-12T03:12:31.223
> 
> 标签：c++, arrays, casting, operands

```
class RLE_v1
{
    struct header
    {
        char sig[4];
        int fileSize;
        unsigned char fileNameLength;
        std::string fileName;
    } m_Header;

    RLE<char> m_Data;

public:
    void CreateArchive(const std::string& source)
    {
        std::ifstream::pos_type size;
        char* memblock;
        std::ifstream file (source, std::ios::in|std::ios::binary|std::ios::ate);
        if (file.is_open())
        {
            size = file.tellg();
            memblock = new char [static_cast<unsigned int>(size)];
            file.seekg (0, std::ios::beg);
            file.read (memblock, size);
            file.close();
            //
            // trying to make assignment to m_Data here.
            //
            delete[] memblock;
        }
    }

    void ExtractArchive(const std::string& source);
}; 
```

我正在尝试将“memblock”char 数组中的数据复制到变量 m_Data 中，但是当我尝试这样做时，我得到了错误`no match for operator "=" matches these operands`。我不知道如何使它们相等，因为`m_Data`已经是 type `char`。

这是具有变量 m_Data 作为 mem 的 RLE 类

```
template <typename T>
struct RLE
{

    T* m_Data;  // Memory which stores either compressed or decompressed data
    int m_Size; // Number of elements of type T that data is pointing to

    RLE()
        : m_Data(nullptr)
        , m_Size(0)
    { }

    ~RLE()
    {
        delete m_Data;
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:18:44.637

除了产生错误的实际行之外，您已经显示了所有内容。

但我看到的是这个。您有一个具有成员的类：

```
RLE<char> m_Data; 
```

模板扩展后，该结构将具有成员：

```
char *m_Data; 
```

`operator=`当你分配`memblock`给时你说没有`m_Data`。所以我只能得出结论，你正在这样做：

```
m_Data = memblock; 
```

*您实际上*应该在哪里执行此操作：

```
m_Data.m_Data = memblock;
m_Data.m_Size = size; 
```

与其直接对结构的内部进行操作，不如创建一个函数：

```
template <typename T>
void RLE<T>::Alloc( size_t size )
{
    if( m_Data != nullptr ) delete [] m_Data;
    m_Data = new T [size];
    m_Size = size;
} 
```

# c++ - MD5 哈希函数输出垃圾

> ID：14824785
> 
> 赞同：1
> 
> 时间：2013-02-12T03:13:18.067
> 
> 标签：c++, hex, md5, output

我正在研究一个 C++ 类，我们正在学习 MD5 散列函数。但是，我遇到了这个问题，我在其中执行以下操作：

```
string input = "testInput";
unsigned char *toHash = new unsigned char[input.size()+1];
strcpy( (char*)toHash, input.c_str() );

unsigned char output[MD5_DIGEST_LENGTH];

MD5(toHash, input.size(), output);

cout << hex << output << endl; 
```

但我总是得到一些奇怪的垃圾字符，而不是我正在寻找的东西，比如一长串数字/字母。这是怎么回事？

~ 被低级 C++ 搞糊涂了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T04:15:33.077

不要被数组的“无符号字符”类型所迷惑，这意味着数组中的每个值都是一个 8 位无符号整数。特别是它*并不*意味着写入数组的数据将是人类可读的 ASCII 字符。

如果你想以人类可读的十六进制形式查看数组的内容，你可以这样做（而不是 cout 命令）：

```
for (int i=0; i< MD5_DIGEST_LENGTH; i++) printf("%02x ", output[i]);
printf("\n"); 
```

# java - 同时使用 WASD 和方向键

> ID：14824786
> 
> 赞同：3
> 
> 时间：2013-02-12T03:13:20.163
> 
> 标签：java, keyboard, processing, 2d-games

我正在处理中开发一个两人游戏（在 Java 上运行）。一位用户将使用 WASD 键控制他的角色，另一位用户将使用箭头键控制移动。我遇到的问题是`keyPressed`在按下箭头时使用否定 WASD，反之亦然。我已经搞砸了很长时间。有谁知道解决方法或注意到我做错了什么？

```
//global variables
int wide = 600; //canvas width
int tall = 600; //canvas height
int s = 50; //player size
float speed = 2.5; //player movement speed

//colors
int redColor = #CB4646; //player 1 color
int blueColor = #4652CB; //player 2 color
int backgroundColor = #DBE3B3; //background color
float player1X = 600/3-s;  //HOW COME width/3 DOESN'T WORK??????????
float player2X = 600*2/3;
float playerY = 600/2-(s/2);

//players
Player player1 = new Player(player1X, playerY, s, speed, "wasd", redColor); //player 1
Player player2 = new Player(player2X, playerY, s, speed, "arrows", blueColor); //player 2

//setup
void setup(){
  background(backgroundColor);
  size(wide, tall);
  smooth();
  println(player2.controls);
}

//draw
void draw(){
  background(backgroundColor);
  player1.usePlayer();
  player2.usePlayer();
}

class Player{

   //class variables
   float x; // x position
   float y; // y position
   int s; //size
   float speed; //speed
   String controls; //controls
   int colors; //player color
   char keyControls [] = new char [4];

   //construct
   Player(float tempX, float tempY, int tempS , float tempSpeed, String tempControls, int tempColors){
     x = tempX; 
     y = tempY; 
     s = tempS; 
     speed = tempSpeed; 
     controls = tempControls; 
     colors = tempColors; 
   }

   void usePlayer(){

     // draw player
     fill(colors);
     rect(x, y, s, s);

     //move player
     keyPressed();

     //wraparound
     boundaries();

   }

   void keyPressed(){

     //sets controls for wasd
     if(controls == "wasd"){ 
          if(key == 'w' || key == 'W'){ 
            y -= speed; //move forwards
          }
          if(key == 's' || key == 'S'){
            y += speed; //move backwards
          }
            if(key == 'd' || key == 'D'){
            x += speed; //move right
          }
          if(key == 'a' || key == 'A'){
            x -= speed; //move left
          }
         }

      //sets controls for arrows 
      if(controls == "arrows"){ 
        if(key == CODED){
          if(keyCode == UP){ 
            y -= speed; //move forwards
          }
          if(keyCode == DOWN){
            y += speed; //move backwards
          }
            if(keyCode == RIGHT){
            x += speed; //move right
          }
          if(keyCode == LEFT){
            x -= speed; //move left
          }
         }  
        }  
       }

    //pacman style wraparound
    void boundaries(){
     if(x == width) x = 2;
     if(y == height) y = 2;
     if(x == 0) x = width-s;
     if(y == 0) y = height-s;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:35:02.297

独立跟踪您的密钥，不要依赖事件全局变量。

```
boolean[] keys = new int[255];

void keyPressed() {
  keys[keyCode] = true;
}

void keyReleased() {
  keys[keyCode] = false;
}

void draw() {
  updatePlayers();
  drawStuff();
}

void updatePlayers() {
  if(keys[LEFT]) { p1.move(-1,0); }
  if(keys[RIGHT]) { p1.move(1,0); }
  if(keys[UP]) { p1.move(0,-1); }
  if(keys[DOWN]) { p1.move(0,1); }

  if(keys['a']) { p2.move(-1,0); }
  if(keys['d']) { p2.move(1,0); }
  if(keys['w']) { p2.move(0,-1); }
  if(keys['s']) { p2.move(0,1); }
} 
```

请注意，这必须是一系列 if 语句，因为您要处理所有按下的键。如果有人左右握持，p1 会左右移动。

另请注意，此示例代码不会过滤您为特殊键获得的高于 255 的代码，因此您可能希望在事件处理程序的开头放置“if(keyCode>255) return”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T07:54:24.623

是`key`全局变量吗？我没有看到它被传递给播放器。如果它是全局的，那么它一次只能持有一个键，这就排除了同时控制两个玩家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-24T22:06:54.487

这是我用来处理同时按键（沿对角线移动）的 Arduino/处理代码。它解决了`boolean[] cannot be cast to int[]`@Brannon 所示的错误问题，并使用 keyCodes 而不是 key。

```
import processing.serial.*;
​
boolean[] keys = new boolean[255];
Serial port;
​
void setup() { 
 port = new Serial(this, Serial.list()[1], 9600);
​
}
​
void draw() {

  // loop through boolean array and see which ones (index = keyCode)
  // are true, then write to them.
  for(int i = 0; i < 255; i++) {
    if(keys[i]) { 
      if (i == 87) { port.write('w'); }
      if (i == 65) { port.write('a'); }
      if (i == 83) { port.write('s'); }
      if (i == 68) { port.write('d'); }
    } 
  }
}
​
void keyPressed() {
  keys[keyCode] = true;
}
​
void keyReleased() {
  keys[keyCode] = false;
} 
```

# c++ - cout (C++) 的问题

> ID：14824787
> 
> 赞同：0
> 
> 时间：2013-02-12T03:13:43.580
> 
> 标签：c++, cout

我很难弄清楚这里出了什么问题：

```
#include <iostream>
#include <cmath>
#include <iomanip>

using namespace std;

double fact(double);
double sinTaylor(double);
double cosTaylor(double);

int main()
{
    double number, sineOfnumber, cosineOfnumber;

    cout << "Enter a number, then I will calculate the sine and cosine of this number" << endl;

    cin >> number;

    sineOfnumber = sinTaylor(number);
    cosineOfnumber = cosTaylor(number);

    cout << fixed << endl;
    cout << cosineOfnumber << endl;
    cout << sineOfnumber << endl;

    return 0;
}

double fact(double n)
{
    double product = 1;
    while(n > 1)
     product *= n--;
    return product;
}

double sinTaylor(double x)
{
    double currentIteration, sumSine;

    for(double n = 0; n < 5; n++)
    {
        currentIteration = pow(-1, n)*pow(x, 2*n+1) / fact(2*n+1);
        sumSine += currentIteration;
    }
    return sumSine;
}

double cosTaylor(double y)
{
    double currentIteration, sumCosine;

    for(double n = 0; n < 5; n++)
    {
        double currentIteration = pow(-1, n)*pow(y, 2*n) / fact(2*n);
        sumCosine += currentIteration;
    }
    return sumCosine;
} 
```

好的，这是我的代码。我对此很满意。除了一件事：sineOfnumber 和 cosOfnumber，在调用 sinTaylor 和 cosTaylor 之后，会在下面的 cout 行中相互添加，相互打印。换句话说，如果数字等于假设，.7853, 1.14 将打印在打算打印 cosineOfnumber 的行中，并且 sineOfnumber 将正常打印结果。谁能帮我确定这是为什么？太感谢了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T03:23:17.570

Are you ever initializing the variables sumSine and sumCosine in your functions? They're not guaranteed to start at zero, so when you call += inside your loop you could be adding computed values to garbage.

Try initializing those two variables to zero and see what happens, as other than that the code seems okay.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:28:38.140

正弦的系列是（对不起 LaTeX）：

```
sin(x) = \sum_{n \ge 0} \frac{x^{2 n + 1}}{(2 n + 1)!} 
```

如果你看，给定术语 t_{2 n + 1} 你可以计算术语 t_{2 n + 3} 为

```
t_{2 n + 3} = t_{2 n + 1} * \frac{x^2}{(2 n + 2)(2 n + 3)} 
```

因此，给定一个术语，您可以轻松计算下一个术语。如果您查看余弦的系列，它是相似的。生成的程序更有效（没有重新计算阶乘）并且可能更精确。将浮点数相加时，将它们从最小到最大相加更为精确，但我怀疑这会有所不同。

# nginx - Nginx 不适用于可用的站点

> ID：14824795
> 
> 赞同：0
> 
> 时间：2013-02-12T03:14:36.013
> 
> 标签：nginx

这是我的配置： **nginx.conf**

```
user  www-data;
worker_processes  2;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
worker_rlimit_nofile 8192;

events {
    worker_connections  1024;
        use epoll;
}

http {
        client_max_body_size 15m;
        server_names_hash_bucket_size 64;
        postpone_output 1460;
        sendfile_max_chunk 128k;
        sendfile on;
        fastcgi_cache_path /tmp/fcgi-cache/ levels=1:2   keys_zone=one:10m;
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
        server_tokens off;
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;
        error_log /var/log/nginx/error.log;

    tcp_nopush     on;

    keepalive_timeout  65;

    gzip  on;
        ssi on;

        include /etc/nginx/conf.d/*.conf;
        include /etc/nginx/sites-enabled/*;
} 
```

这是我在可用站点中的 domain.com 配置：

```
server {

root /var/www/domain.com/;

access_log /var/log/nginx/default-access.log;
error_log /var/log/nginx/default-error.log;

include /etc/nginx/templates/default;
include /etc/nginx/templates/php;
include /etc/nginx/templates/phpmyadmin;

} 
```

当我输入 url domain.com 时，它会显示默认的 nginx 页面。当我评论包括/etc/nginx/conf.d/*.conf；我什至无法加载 nginx 页面，它就像服务器甚至无法正常工作一样。我已经在站点可用中编写了我的站点，并为站点启用了 ln -s。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T14:57:48.747

你必须把 server_name domain.com; 在服务器块中:)

# php - 根据他正确的时区获取用户时间

> ID：14824797
> 
> 赞同：0
> 
> 时间：2013-02-12T03:14:39.227
> 
> 标签：php, javascript, timezone

我正在开发一个应用程序，我需要根据用户的正确时区为他的活动发布时间。现在我已经探索了很多方法，如 javascript，php，但我不能确定它们中的任何一个都会给出正确的时间，因为我不能依赖 JS，因为用户可能将他的时区设置错误并进入 php，我的服务器可能是世界各地取决于托管服务。

我检查了一些问题，建议要获取特定时区的时间，我应该 ping 一些地理数据库并根据从 php 收到的 IP 地址获取用户的时区。你们所有的专家都在那里，请建议最好的技术是什么？据我所知，twitter 之类的也使用某种 ip 数据库来获取操纵时间。

提前致谢。

**note**还没解决，我会定期更新状态。

**我正在寻找一个一致的答案。请你们在那里，帮助我和其他在他们的编程生涯中至少会偶然发现这个问题的人**

**更新：**正如我所说我会更新，我通知大家我最终使用 JS 来获取用户的时间，因为依赖第三方 Ip 数据库提供时区信息然后使用它可能存在限制。所以谢谢大家..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:31:38.133

您可以使用[http://www.ip2location.com/](http://www.ip2location.com/) DB 和 api 获取时区并使用 DateTime::setTimezone 计算用户的时间

[http://php.net/manual/en/datetime.settimezone.php](http://php.net/manual/en/datetime.settimezone.php)

# session - Phantomjs 和会话

> ID：14824798
> 
> 赞同：12
> 
> 时间：2013-02-12T03:14:43.483
> 
> 标签：session, cookies, login, phantomjs

登录后，我无法通过网站保持会话冲浪。

我确实可以成功登录该网站（我指定无论页面是什么，登录后您将被重定向到主页）但是我必须移动到另一个页面。首先我尝试使用 page.open() 然后使用 page.evaluate 更改 location.href 窗口属性，但不幸的是，在这两种情况下，结果都是我不再登录。我跟踪了登录状态，只是在每个页面加载事件上使用递增的 png 名称（1.png、2.png 等）呈现页面。我也尝试了 --cookies-file=cookies.txt 参数，但没有太大帮助。

我的问题是：使用 phantomjs 在网站页面中“移动”的最佳方式是什么？在这些情况下是否有特定的方法来处理会话（也许在每个 .open() 上手动发送 cookie，只是说）？

感谢帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T08:36:16.780

会话需要 cookie。您必须在 phantomjs 中添加一个额外的参数。

```
--cookies-file=/path/to/cookies.txt 
```

[在这里](https://github.com/ariya/phantomjs/wiki/API-Reference)查看更多信息。

**编辑**：您是否`cookies.txt`包含某些内容？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-05-18T18:45:16.307

我对 cookie 文件方法有疑问。该文件将被写入，我可以在文件中看到“cookie 信息”，但未来的请求将被解释为未经身份验证。作为最后的努力，我只是将 page.cookies 数组序列化为 JSON 并将其保存到文件中。我的下一个脚本将打开该文件，将其反序列化为一个变量并将 page.cookies 设置为该变量。果然这行得通！只是以为我会传递它。

# javascript - 'target.html()' 为 null 或不是对象

> ID：14824799
> 
> 赞同：2
> 
> 时间：2013-02-12T03:14:43.763
> 
> 标签：javascript, jquery

我正在尝试从元素中替换所有出现的某个字符（引号）。我的代码在 Chrome 和 FF 中运行良好，但在 IE 中失败，调试器说 -`'target.html()' is null or not an object`

这是我的代码的样子 -

```
text = "some random text";
target = $('#target');
target.append(text);
target.html(target.html().replace(/"/g, " ")); 
```

是什么导致 IE 中出现该错误，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:47:33.640

'target' 用作属性，如果将其用作变量名，IE 不喜欢它。事实上，它甚至拒绝承认`event.target`并坚持`event.srcElement`（告诉我它..）。

无论如何，如果您将对象重命名为`$target`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:48:22.333

我收到此类错误的主要原因之一是 HTML 格式不正确（在我发现之前它确实让我很痛苦）。其他浏览器允许缺少 '>' 或其他语法错误，但 IE 非常严格。

所以只要仔细看看 target.html() 中的标记是正确的。

# sql - 从 RosterResource 表中获取 UserID

> ID：14824801
> 
> 赞同：-1
> 
> 时间：2013-02-12T03:14:50.390
> 
> 标签：sql, sql-server-2008, tsql

我有 5 个表：位置、收费、资源、名册和 SpecialRoster。

```
CREATE TABLE Location(
LocationID int identity,
StartDate datetime,
DaysInRoster int)

CREATE TABLE Charge(
ChargeID int identity,
TotalAmount money,
ChargeDate datetime,
UserID int)

CREATE TABLE [Resource](
ResourceID int identity,
ResourceName varchar(100))

CREATE TABLE Roster(
RosterDay int,
ResourceID int,
StartDate datetime,
EndDate datetime,
UserID int)

CREATE TABLE SpecialRoster(
RosterDate datetime,
ResourceID int,
UserID int) 
```

我需要构建一个报告，按 ResourceID 显示不同日期的 Charge.TotalAmount 总和。

Charge 只有一个 UserID，但规则相当简单：如果 date 和 ResourceID 在 SpecialRoster 中，则 UserID 取自 SpecialRoster 如果没有，则 Resource 的 UserID 和日期的 RosterDay 取自当时的 Roster时间

基本上，我需要通过 Roster 或 SpecialRoster 中的 UserID 将 ResourceID 映射到 Charge。

RosterDay 是花名册的当前日期，可以从位置计算，其中`RosterDay = DateDiff(day, Location.RosterStartDate, GetDate()) % Location.DaysInRoster`

即，整个名册在该地点的开始时间与名册期间的天数之差的模数。

我写了一个函数来做到这一点：

```
CREATE FUNCTION dbo.GetRosteredUser
(
@ResourceID int,
@Date datetime,
@LocationID int
)
RETURNS  int
AS
BEGIN

DECLARE @UserID int
DECLARE @RosterOffset int

Select @UserID = UserID from SpecialRoster Where ResourceID = @ResourceID and RosterDate = @Date 

If @UserID is NOT NULL 
    return @UserID
else
    Select @RosterOffset = DATEDIFF(day, StartDate, @Date) % DaysInRoster 
    from Location Where LocationID = @LocationID

    Select @UserID = UserID from Roster Where ResourceID = @ResourceID and RosterDay = @RosterOffset
    and ( @Date between StartDate and EndDate or @Date > StartDate and EndDate is NULL)
    return @UserID
END
GO 
```

但是该功能不是很好，因为它很慢，并且只允许报告一次运行一天：

```
Select a.ResourceID, Name, a.UserID, Sum(c.TotalAmount ) as AmountCharged
from Charge  c 
left outer join (
Select ResourceID, Name, 
dbo.GetUserByResourceDate(ResourceID, '1/FEB/2013', 1) as UserID 
from [Resource]) a
on c.UserID = a.UserID 
Where ChargeDate between '1/FEB/2013' and '2/FEB/2013'
group by a.ResourceID, Name, a.UserID 
```

有一个更好的方法吗？用户将希望运行它来比较一段时间内资源的生产力。例如：

```
Date         ResourceID Name    UserID   TotalAmount
01/FEB/2013  1          Sales1  22       $1024
02/FEB/2013  1          Sales1  11       $1454
03/FEB/2013  1          Sales1  14       $1900
04/FEB/2013  1          Sales1  23       $3045 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:01:41.343

也许，这样的事情可能会有所帮助：

```
SELECT
  re.ResourceID,
  re.ResourceName,
  ch.UserID,
  AmountCharged = SUM(ch.TotalAmount)
FROM
  Location lo
  CROSS JOIN Charge ch
  CROSS APPLY (
    SELECT DATEDIFF(DAY, lo.StartDate, ch.ChargeDate) % lo.DaysInRoster
  ) x (RosterDay)
  INNER JOIN
    [Resource] re
    LEFT JOIN Roster ro
    ON
      ro.RosterDay = x.RosterDay
      AND ch.ChargeDate BETWEEN ro.StartDate
      AND ro.RecourceID = re.ResourceID
    LEFT JOIN SpecialRoster sr
    ON
      sr.RosterDate = ch.ChargeDate
      AND sr.RecourceID = re.ResourceID
  ON
    ch.UserID = ISNULL(sr.UserID, ro.UserID)
GROUP BY
  re.ResourceID,
  re.ResourceName,
  ch.UserID
WHERE
  lo.LocationID = @LocationID
  AND ch.ChargeDate BETWEEN ...
; 
```

在上面的脚本中，假设所有日期时间值实际上只是日期。

此外，我有点惊讶地没有找到`Location`指定的任何其他表之间的连接。如果有一个并且您只是忘记提及它，请让我知道您是否需要任何帮助以将必要条件合并到脚本中。

# hadoop - 用hadoop处理非常小的文件

> ID：14824802
> 
> 赞同：0
> 
> 时间：2013-02-12T03:15:07.587
> 
> 标签：hadoop

我有一个关于使用 hadoop 处理小文件的问题。我的文件只有大约 1,000 条左右的记录，但我希望这些记录大致均匀地分布在节点之间。有没有办法做到这一点？我是hadoop的新手，到目前为止，似乎所有的执行都发生在一个节点上，而不是同时发生在多个节点上。让我知道我的问题是否有意义或者我是否需要澄清任何事情。就像我说的，我对 Hadoop 很陌生，但希望能得到一些澄清。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T05:44:18.897

使用[NLineInputFormat](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/mapred/lib/NLineInputFormat.html)并指定每个映射器要处理的记录数。这样，单个块中的记录将由多个映射器处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:07:37.000

另一种选择是将您的一个输入文件拆分为多个输入文件（在一个输入路径目录中）。然后，这些输入文件中的每一个都将能够分布在 hdfs 上，并且映射操作将发生在拥有这些输入拆分的工作机器上。

# jquery - 如何获取最近的元素id属性

> ID：14824803
> 
> 赞同：0
> 
> 时间：2013-02-12T03:15:19.037
> 
> 标签：jquery, jquery-selectors

我正在尝试找到具有 id 属性的最近元素并获取`id`. 该元素可以是`<p>, <div>`或其他元素。

我试过了

```
element=$('#test').closest('div[id]').attr('id'); 
```

但只有当元素是 a 时它才会获得 id `div`。我想要更普遍。有没有办法做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T03:15:59.640

您可以完全摆脱`div`并查找具有`id`属性的所有元素：

```
$('#test').closest('[id]').attr('id'); 
```

# java - 等待所有线程完成它们的工作，然后测量经过的时间

> ID：14824806
> 
> 赞同：1
> 
> 时间：2013-02-12T03:15:38.780
> 
> 标签：java, multithreading, executorservice

我`Executor service`在我的一个中使用`Multithreaded code`。我正在尝试查看我的所有线程是否都完成了他们的工作，然后我需要执行某些任务。

目前我需要测量经过的时间，所以我只能在所有线程完成执行那里的作业后才能测量经过的时间。所以我目前有这个代码？我正在测量`time elapsed`。`finally block`

```
ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

long startTime = System.nanoTime();
try {
    for (int i = 0; i<noOfThreads; i++) {
        service.submit(new Task());
    }
    service.shutdown();
    service.awaitTermination(Long.MAX_VALUE, TimeUnit.SECONDS);

    //Do I need this while block here?
    while (!service.isTerminated()) {

    }
} catch (InterruptedException e) {
    //Log exception here
} finally {
    long estimatedTime = System.nanoTime() - startTime;
    logTimingInfo(estimatedTime, noOfTasks, noOfThreads);
} 
```

我不确定我是否需要`while loop`这里？我目前的做法是否正确？

**更新代码：-**

所以下面的代码应该可以正常工作。正确的？

```
ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

long startTime = System.nanoTime();
try {
    for (int i = 0; i<noOfThreads; i++) {
        service.submit(new Task());
    }
    service.shutdown();
    service.awaitTermination(Long.MAX_VALUE, TimeUnit.SECONDS);     
} catch (InterruptedException e) {
    //Log exception here
} finally {
    long estimatedTime = System.nanoTime() - startTime;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:27:25.050

问：你需要`while`吗？答：没有。

在服务终止或几秒钟过去之前，之前的`awaitTermination`调用不会返回。`(2^63 - 1)`（那是一个*很*长的时间。）

* * *

**更新**- 更新版本对我来说看起来不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T03:19:33.430

您不需要重新发明轮子。您可以使用[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/CompletionService.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/CompletionService.html)

这工作得很好。这也应该解决您的问题陈述。

# django - 将根元素添加到 json 响应（django-rest-framework）

> ID：14824807
> 
> 赞同：21
> 
> 时间：2013-02-12T03:15:39.200
> 
> 标签：django, django-rest-framework

我正在尝试确定使用 django 和 django-rest-framework 将根元素添加到所有 json 响应的最佳方法。

我认为添加自定义渲染器是完成我想要实现的目标的最佳方式，这就是我迄今为止想出的：

```
from rest_framework.renderers import JSONRenderer

class CustomJSONRenderer(JSONRenderer):
#override the render method
def render(self, data, accepted_media_type=None, renderer_context=None):
    #call super, as we really just want to mess with the data returned
    json_str = super(CustomJSONRenderer, self).render(data, accepted_media_type, renderer_context)
    root_element = 'contact'

    #wrap the json string in the desired root element
    ret = '{%s: %s}' % (root_element, json_str) 

    return ret 
```

现在棘手的部分是`root_element`根据`render()`被调用的视图动态设置。

任何指针/建议将不胜感激，

干杯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-14T22:30:00.297

对于后代，以下是最终解决方案。它与原来的相比略有增长，因为它现在也重新格式化了分页结果。

我之前也应该指定 JSON 根元素的原因是为了与 Ember 前端解决方案集成。

序列化器：

```
from rest_framework.serializers import ModelSerializer
from api.models import Contact

class ContactSerializer(ModelSerializer):
    class Meta:
        model = Contact
        #define the resource we wish to use for the root element of the response
        resource_name = 'contact' 
        fields = ('id', 'first_name', 'last_name', 'phone_number', 'company') 
```

渲染器：

```
from rest_framework.renderers import JSONRenderer

class CustomJSONRenderer(JSONRenderer):
    """
        Override the render method of the django rest framework JSONRenderer to allow the following:
        * adding a resource_name root element to all GET requests formatted with JSON
        * reformatting paginated results to the following structure {meta: {}, resource_name: [{},{}]}

        NB: This solution requires a custom pagination serializer and an attribute of 'resource_name'
        defined in the serializer
    """
    def render(self, data, accepted_media_type=None, renderer_context=None):
        response_data = {}

        #determine the resource name for this request - default to objects if not defined
        resource = getattr(renderer_context.get('view').get_serializer().Meta, 'resource_name', 'objects')

        #check if the results have been paginated
        if data.get('paginated_results'):
            #add the resource key and copy the results
            response_data['meta'] = data.get('meta')
            response_data[resource] = data.get('paginated_results')
        else:
            response_data[resource] = data

        #call super to render the response
        response = super(CustomJSONRenderer, self).render(response_data, accepted_media_type, renderer_context)

        return response 
```

分页：

```
from rest_framework import pagination, serializers

class CustomMetaSerializer(serializers.Serializer):
    next_page = pagination.NextPageField(source='*')
    prev_page = pagination.PreviousPageField(source='*')
    record_count = serializers.Field(source='paginator.count')

class CustomPaginationSerializer(pagination.BasePaginationSerializer):
    # Takes the page object as the source
    meta = CustomMetaSerializer(source='*')
    results_field = 'paginated_results' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-30T06:12:34.130

感谢 ever.wakeful 让我完成了 95% 的工作。

就个人而言，我想将元数据添加到某个对象的每个 api 请求中，无论它是否被分页。我还想简单地传入我手动定义的 dict 对象。

**调整自定义渲染器**

```
class CustomJSONRenderer(renderers.JSONRenderer):
    def render(self, data, accepted_media_type=None, renderer_context=None):
        response_data = {}
        # Name the object list 
        object_list = 'results'
        try:
            meta_dict = getattr(renderer_context.get('view').get_serializer().Meta, 'meta_dict')
        except:
            meta_dict = dict()
        try:
            data.get('paginated_results')
            response_data['meta'] = data['meta']
            response_data[object_list] = data['results']
        except:
            response_data[object_list] = data
            response_data['meta'] = dict()
            # Add custom meta data
            response_data['meta'].update(meta_dict)
            # Call super to render the response
            response = super(CustomJSONRenderer, self).render(response_data, accepted_media_type, renderer_context)
        return response 
```

**父序列化器和查看示例**

```
class MovieListSerializer(serializers.ModelSerializer):
    class Meta:
        model = Movie
        meta_dict = dict()
        meta_dict['foo'] = 'bar'

class MovieViewSet(generics.ListAPIView):
    queryset = Movie.objects.exclude(image__exact = "")
    serializer_class = MovieListSerializer
    permission_classes = (IsAdminOrReadOnly,)
    renderer_classes = (CustomJSONRenderer,)
    pagination_serializer_class = CustomPaginationSerializer
    paginate_by = 10 
```

# macos - 在 Sandbox 中写入 /Volumes 的权利

> ID：14824810
> 
> 赞同：0
> 
> 时间：2013-02-12T03:15:59.523
> 
> 标签：macos, cocoa, sandbox

我有一个应用程序，它监视 /Volumes 目录的更改并允许用户访问出现在目录中的已安装卷。

令我惊讶的是，像 NSWorkspace.mountedLocalVolumePaths、NSWorkspaceDidMountNotification 通知和 FSEventStreamCreate 这样的许多方法都没有错误地返回，我能够像以前一样监视目录，但是写入 /Volumes 的任何子目录都不起作用，并且将文件 URL 添加到粘贴板失败带有 __CFPasteboardIssueSandboxExtensionForPath 错误。

是否有我需要的权利，或者除非用户在对话框中选择它们或拖放，否则这是否严格禁止获得对卷的写访问权限？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T11:28:56.597

没有这样的权利，但您可以要求用户授予您对 /Volumes 的权限，并使用[Security-Scoped Bookmarks](http://developer.apple.com/library/mac/#documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html#//apple_ref/doc/uid/TP40011183-CH3-SW16)保存这些权限。

# ruby-on-rails - 轨道记录推送

> ID：14824811
> 
> 赞同：0
> 
> 时间：2013-02-12T03:16:22.000
> 
> 标签：ruby-on-rails

**控制器.rb**

```
@payments = PaymentDetail.joins(:project) 
```

在视图文件中@payments.count 等于 550

当我像这样更改控制器时

```
@payments = PaymentDetail.joins(:project)
@payment_errors = PaymentError.joins(:project)
@payment_errors.each {|payment_error| @payments << payment_error} 
```

仍在查看文件@payments.count 等于 550 而它必须是 (550+@payment_errors.count)

为什么我不能将 @payment_error 记录推送到 @payments ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:22:25.177

您正在尝试将`PaymentError`数据添加到`PaymentDetail`错误的表中。如果您在数组中需要它，请使用`to_a`.

你可以这样做：

```
 @payments = PaymentDetail.joins(:project).to_a + PaymentError.joins(:project).to_a 
```

用于`will_paginate`数组。在你的控制器中添加这一行：

```
 `require 'will_paginate/array'` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:20:26.687

这是因为延迟加载。

```
PaymentDetail.joins(:project) 
```

这不会立即加载付款。相反，一旦您开始访问付款（`each`例如在循环中），就会加载付款。您可以通过将结果转换为数组来强制加载。试试这个：

```
@payments = PaymentDetail.joins(:project).to_a
@payment_errors = PaymentError.joins(:project).to_a
@payments += @payment_errors 
```

或者，如果您不需要`@payment_errors`单独的 var：

```
@payments = PaymentDetail.joins(:project).to_a + PaymentError.joins(:project).to_a 
```

# css - IE <=8 的不带 javascript 的响应式网页设计。可能吗？

> ID：14824812
> 
> 赞同：0
> 
> 时间：2013-02-12T03:16:33.127
> 
> 标签：css, internet-explorer, media-queries, javascript

我一直在尝试建立自己的网站；我正在阅读 RWD（响应式网页设计）。我遇到了 IE 问题。我可以为 IE<=8 设置默认样式显示，但我看到了 [1]：[http](http://www.etondigital.com) ://www.etondigital.com站点 您可以访问该站点，并且在禁用 javascript 的 IE 7 中仍然可以响应。我很难弄清楚这是怎么可能的。它从三列变为一列。如果您了解网站功能，请告诉我。谢谢

/ ***** ***** *我已经添加了我的代码，并且关于我附加的链接，我如何在没有javascript的情况下在Ie8及以下实现将它从三行更改为一行而没有任何通知，如eton数字网站

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Second Theme</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
            <!--so html 5 tags work in ie browsers 8 and lower-->
        <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <style type="text/css">
        body{
   font:normal 100% Cambria, Georgia, serif;
   margin:10px;
}

.wrapper{
    margin: 0em auto;
    width: 93.75%;      /* 960/1024 */
    background:gray;
    padding:.625em;

}

.box{
width:29.847%;/*274/918*/
    float:left;
    margin-right:2em;
}

.clear{
    clear:both;
}

        </style>
    <body>
       <div class="warapper">
        <aside class="bottom_sidebar">
            <div class="box one">
                <h1>One</h1>
                <p>is simply dummy text of the printing and typesetting 
                    industry. Lorem Ipsum has been the industry's standard 
                    dummy text  ever since the 1500s, when an unknown printer
                     took a galley of type and scrambled it to make a</p>

            </div>
            <div  class="box">
                <h1>Two</h1>
                <p>is simply dummy text of the printing and typesetting 
                    industry. Lorem Ipsum has been the industry's standard 
                    dummy text  ever since the 1500s, when an unknown printer
                     took a galley of type and scrambled it to make a</p>
            </div>
            <div  class="box">
                <h1>Three</h1>
                <p>is simply dummy text of the printing and typesetting 
                    industry. Lorem Ipsum has been the industry's standard 
                    dummy text  ever since the 1500s, when an unknown printer
                     took a galley of type and scrambled it to make a</p>
            </div> 
            <div class="clear"></div>
        </aside>
    </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:21:09.180

如果您对所有块级元素使用基于百分比的宽度，则可以使您的网站响应式，而无需使用`@media`CSS at-rule。否则，您将需要使用 JavaScript 来让网站响应 IE 中的媒体查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:28:54.323

最好的方法，也是最简单的方法，是通过引导程序。它与 IE7+ 兼容，可以随心所欲。它不是一个模板，而是一组 .css 文件，这些文件预先编码了类，使您可以在短时间内构建最佳的响应式布局。我建议花一些时间在 Google 上搜索 Bootstrap 并阅读所有有关详细信息，但**Bootstrap 绝对是要走的路。**

[http://twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html)

# java - 在方法参数中创建对象

> ID：14824820
> 
> 赞同：-1
> 
> 时间：2013-02-12T03:17:29.830
> 
> 标签：java

在类中创建方法时，如果使用参数：

`public String Method(ClassName NewObject){}`

或者在我下面的例子中：

```
public String EqualsTo(Deck aCard){} 
```

它会在该方法中创建该类的新对象吗？如果没有人介意解释我使用该参数发生了什么？

注意：忽略任何小的语法错误，因为我刚刚构建了这个以更好地解决我的问题，所以这不是一个完整的类。

```
import java.util.Scanner;
import java.util.Random;

public class Deck {
private int suit;
private int rank;
private Random generator = new Random();
Scanner in = new Scanner(System.in);

    //Default constructor
    public Deck() {
    suit = suit.random(4);
    rank = rank.random(13);
    }

public String EqualsTo(Deck aCard){}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:34:24.650

基本的东西：Java 是按值传递的。

1.  未创建新对象。
2.  调用实体创建的对象引用值被复制到方法参数`aCard`中。
3.  对此对象所做的任何修改都将对调用实体保持可见。这是因为引用值指向对象的相同地址位置。

这是一个例子。

```
public class Test2 {

    public int bla;

    public static void main(String[] args) {
        Test2 test = new Test2();
        test.bla = 878;
        test.doSome(test); // Calling Location
        System.out.println(test.bla);
    }

    public void doSome(Test2 test) {
        test.bla = 95;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T03:21:03.330

使用`new`关键字时会创建对象。另一方面，当您将方法声明为

```
public String EqualsTo(Deck aCard){} 
```

它说该`EqualsTo()`方法将`Deck` *引用*作为参数。为了使用该方法，您需要创建一个`Deck`对象并保留对它的引用。然后你发送对方法的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T03:21:20.067

该参数充当该类型对象的占位符。它实际上并没有创建它，方法签名说：

1.  我是一个`EqualsTo()`方法，我需要/需要一种`Deck`实例/对象作为参数。

2.  它返回 a`String`作为结果。

顺便说一句，我建议使用布尔值作为 EqualsTo 方法的返回类型，而不是“字符串”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T03:46:35.520

***不***

```
public String EqualsTo(Deck aCard){} 
```

***调用时不***创建新对象。

这里是创建对象的地方。用例

```
Deck deck1 = new Deck(); // NEW OBJECT CREATED
Deck deck2 = new Deck(); // NEW OBJECT CREATED

String result = deck1.EqualsTo(deck2); // NO NEW OBJECT CREATED, 
                                     // JUST PASSED REFERENCE OF EXISTING OBJECT
                                     // (except the result of course, which is probably a new object) 
```

# c# - 派生类的重复依赖

> ID：14824821
> 
> 赞同：0
> 
> 时间：2013-02-12T03:17:29.470
> 
> 标签：c#, dependencies, derived-class

我有一个基类：

```
class B { } 
```

它有很多依赖项：

```
public B(IFoo foo, IBar bar, IFooBar fooBar, IAlice alice, IBob bob) { } 
```

我有很多看起来像这样的派生类：

```
public class D : B { } 
```

但是它们需要满足 的构造函数`B`，所以它们有依赖关系：

```
public D(IFoo foo, IBar bar, IFooBar fooBar, IAlice alice, IBob bob)
    : base(foo, bar, fooBar, alice, bob) { } 
```

就像我说的，我有很多这样的。这似乎很糟糕。它是重复的。单个代码更改会影响`B`许多类，而这些类都需要一个小的、无聊的更改。

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:23:46.907

I would look at what changes you're making to B and if they're indicative of needing an extra subclass that most subclasses of B SHOULD subclass.

Having lots of constructor arguments isn't really a problem, just an inconvenience. You may wish to make a class to store all the base class arguments. When you need an instance of D, populate an instance of it and then pass that to D, which will then pass it to B and extract all its data.

```
public Bargs(IFoo foo, IBar bar, IFooBar fooBar, IAlice alice, IBob bob) { }
public B(Bargs myArgs){}
public D(Bargs myArgs) : B(myArgs){} 
```

# python - 在图例中绘制代表误差条大小？

> ID：14824822
> 
> 赞同：1
> 
> 时间：2013-02-12T03:17:39.813
> 
> 标签：python, matplotlib, legend, subplot

我有一些数据（有错误）要绘制在相当密集的显示中。我想在没有误差条的情况下绘制这些点（因为它太忙了），但是要在图例中绘制一个有代表性的误差条（它显示了具有准确大小的误差条）。

这是我到目前为止所拥有的（不成功）。

```
import pylab as pl
p1, = pl.plot([1,2,3], label="test1")
p2, = pl.plot([3,2,1], label="test2")

errorbarsize = 1.65 # Need this to be properly scaled in the legend

# p3, = pl.plot([1], label='data', color="red") # works
# p3, = pl.scatter(1, 1, label='data', color="red")
# p3, = pl.errorbar(1, 1, yerr=errorbarsize, label='data', color="red")

l1 = pl.legend([p1], ["Label 1"], loc=1)
l2 = pl.legend([p2], ["Label 2"], loc=2) # this removes l1 from the axes.
l3 = pl.legend([p3], ["Label 3"], loc=3, numpoints=1)

gca().add_artist(l1) # add l1 as a separate artist to the axes
gca().add_artist(l2) # add l2 as a separate artist to the axes 
```

另外，如果我可以将其绘制在单独的图例中，那将是最好的，但这可能要求太多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-10T20:13:43.167

这是使用 Thorsten Kranz 建议的示例，以及如何显示代表性误差线的另一个示例...

```
import matplotlib.pyplot as plt
import numpy as np

fig, axs = plt.subplots(2,1)

# -- make some fake data
x = np.random.normal(loc=4, size=100)
x.sort()
y = np.random.normal(loc=5, size=100)
y.sort()
y_errorbarsize = y.std()
x_errorbarsize = y.std()

### Example 1
# From Thorsten Kranz comment...
axs[0].plot(x, y, label="Example #1")

axs[0].fill_between(x,y-y_errorbarsize/2, y+y_errorbarsize/2,alpha=0.3)

### Example 2

axs[1].scatter(x, y, label="Example #2", alpha=0.8)

# Place our representative error bar by hand.
axis_coordinates_of_representative_error_bar = (0.1, 0.8)
screen_coordinates_of_representative_error_bar = axs[1].transAxes.transform(axis_coordinates_of_representative_error_bar)
screen_to_data_transform = axs[1].transData.inverted().transform
data_coordinates_of_representative_error_bar = screen_to_data_transform(screen_coordinates_of_representative_error_bar)
foo = data_coordinates_of_representative_error_bar

axs[1].errorbar(foo[0], foo[1], xerr=x_errorbarsize/2, yerr=y_errorbarsize/2, capsize=3)

plt.show()
plt.close() 
```

[![在此处输入图像描述](../Images/39e4d3ce48d2ea2feabb3da5ae565af9.png)](https://i.stack.imgur.com/8bvIF.png)

# sql-server - T-SQL 存储过程返回表

> ID：14824824
> 
> 赞同：0
> 
> 时间：2013-02-12T03:17:44.847
> 
> 标签：sql-server, tsql, stored-procedures

如何创建返回此 SELECT 语句的（表格）结果的 T-SQL 存储过程：

```
USE automation

SELECT insurer.name,
insurer.case_name,
contact.name,
contact_address.line_1,
contact_address.city,
state.state_abbr,
contact_address.zip

FROM person as insurer

INNER JOIN persons_relationship on persons_relationship.person2_id = insurer.person_id
INNER JOIN person contact on contact.person_id = persons_relationship.person_id
INNER JOIN person_address contact_person_address on contact_person_address.person_id = contact.person_id
INNER JOIN address contact_address on contact_address.address_id = contact_person_address.address_id
INNER JOIN state on state.state_id = contact_address.state_id

insurer.person_class_id = 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T05:58:07.970

做这样的事情：

```
USE Automation
GO

CREATE PROCEDURE dbo.YourProcedureNameHere
AS
   SELECT 
       insurer.name,
       insurer.case_name,
       contact.name,
       contact_address.line_1,
       contact_address.city,
       state.state_abbr,
       contact_address.zip
   FROM 
       person as insurer
   INNER JOIN 
       persons_relationship on persons_relationship.person2_id = insurer.person_id
   INNER JOIN 
       person contact on contact.person_id = persons_relationship.person_id
   INNER JOIN 
       person_address contact_person_address on contact_person_address.person_id = contact.person_id
   INNER JOIN 
       address contact_address on contact_address.address_id = contact_person_address.address_id
   INNER JOIN 
       state on state.state_id = contact_address.state_id 
```

你就完成了。现在您可以将您的声明称为：

```
EXEC sp_executesql N'dbo.YourProcedureNameHere' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T06:02:36.033

我建议你也放

```
SET NOCOUNT ON 
```

直接在**AS**之后。一些数据访问库对*x 记录受影响*的消息感到困惑，这会将其关闭。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-12T03:23:01.863

put this query in the stored procedure and when you will run this stored procedure you will get tabular result

# ios - 从 ttf 文件中获取字体

> ID：14824828
> 
> 赞同：2
> 
> 时间：2013-02-12T03:18:14.847
> 
> 标签：ios, fonts, core-text, font-family, custom-font

在我的 iOS 应用程序中，我使用从文件动态加载的自定义字体。

要在代码中使用它们，我需要知道加载的字体系列。那么，有什么办法可以做到吗？

*更新：*

我无法以某种方式对字体系列进行硬编码，因为我的应用程序从服务器加载它。当然，有一种方法可以在服务器响应中传递字体系列，但现在我正在寻找一个不会影响服务器的更好版本（不需要更改它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T05:34:20.103

我做的字体加载...

```
NSData *fontData = [NSData dataWithContentsOfFile:filePath];
if (fontData) {
    // create font from loaded data and get it's postscript name
    CGDataProviderRef fontDataProvider = CGDataProviderCreateWithCFData((CFDataRef)fontData);
    CGFontRef loadedFont = CGFontCreateWithDataProvider(fontDataProvider);
    NSString *postScriptName = (NSString *)CGFontCopyPostScriptName(loadedFont);

    // if the font with same postscript name wasn't already registered - do it
    if (postScriptName && ![UIFont fontWithName:postScriptName size:10]) {
        NSError *error;
        if (!CTFontManagerRegisterGraphicsFont(loadedFont, (CFErrorRef *)&error)) {
            NSLog(@"Can't load font: %@", error);
        }
    }

    CGFontRelease(loadedFont);
    CGDataProviderRelease(fontDataProvider);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:23:50.427

在[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIFont_Class/Reference/Reference.html)中，请参阅名为“**获取可用字体名称**”的部分。您可以列出所有系列名称以及所需系列的各个字体名称。我通常只是暂停调试器并自己从命令行调用函数。这是获取 iOS 将使用的名称的最安全方法。还是您在谈论下载字体并加载它们？这不仅需要知道他们的名字。

**编辑**好的，那么您正在下载字体。在这种情况下，您将不得不进入 Core Text 的世界。请参阅[此参考](https://developer.apple.com/library/ios/#documentation/Carbon/Reference/CoreText_FontManager_Ref/Reference/reference.html)以开始使用（注意称为“注册字体”的功能）。如果您成功注册它，那么它将使用上述方法显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T04:45:11.630

我从堆栈溢出的某个地方得到了这段代码。希望能帮助到你。它列出了所有加载的字体名称...

```
NSArray *familyNames = [[NSArray alloc] initWithArray:[UIFont familyNames]];

NSArray *fontNames;
NSInteger indFamily, indFont;
for (indFamily=0; indFamily<[familyNames count]; ++indFamily) {
   NSLog(@"Family name: %@", [familyNames objectAtIndex:indFamily]);
   fontNames = [[NSArray alloc] initWithArray:
   [UIFont fontNamesForFamilyName:
   [familyNames objectAtIndex:indFamily]]];
   for (indFont=0; indFont<[fontNames count]; ++indFont) {
      NSLog(@"    Font name: %@", [fontNames objectAtIndex:indFont]);
   }
} 
```

# php - android HttpPost 中的 JSON _POST 为空

> ID：14824829
> 
> 赞同：1
> 
> 时间：2013-02-12T03:18:16.597
> 
> 标签：php, android, json, http-post

我不明白我的 _POST 是空的

我创建了一个 JSONOBJECT 我将它传递给 HTTPPost 像这样：

```
 HttpPost post = new HttpPost(URL);

                StringEntity se = new StringEntity(json.toString());
                se.setContentType(new BasicHeader(HTTP.CONTENT_TYPE,
                        "application/json"));
                post.setEntity(se);
                response = client.execute(post); 
```

然而它显示为一个空数组

这是完整的代码

创建我 JSON 对象（可以调试它并观察它填充

```
public static final JSONObject GetJSONObject(Customer customer) {

        try {
            JSONObject values = new JSONObject();
            values.put(Customer.KEY_NAME, customer._name); // Contact Name
            values.put(Customer.KEY_PH_NO, customer._phone); // Contact Phone
            values.put(Customer.KEY_EMAIL, customer._email);
            values.put(Customer.KEY_UUID, customer._UUID);
            values.put(Customer.KEY_GEOUUID, customer._geoUUID);
            values.put(Customer.KEY_SALESREPUUID, customer._salesRepUUID);
            values.put(Customer.KEY_CUST_LAST_UPDATE, customer.last_update);
            values.put(Customer.KEY_CUST_NOTES, customer._notes);
            return values;
        } catch (JSONException e) {
            Log.d("ERROR", e.getMessage());
            System.exit(1);
        }
        return null;
    } 
```

开始发送线程

```
 ma.ShowToastMsg("Updating Contract To mySQL" + customer._name);
    mh.sendJSONTHREAD("http://.php",
            GetJSONObject(customer));
public void sendJSONTHREAD(final String URL, final JSONObject json) {
    new Thread(new Runnable() {
        public void run() {
            sendJson(URL, json);
        }
    }).start();
} 
```

发送

```
public void sendJson(final String URL, final JSONObject json) {
    Looper.prepare(); // For Preparing Message Pool for the child Thread
    HttpClient client = new DefaultHttpClient();
    HttpConnectionParams.setConnectionTimeout(client.getParams(), 10000); // Timeout
                                                                            // Limit
    HttpResponse response;

    try {
        HttpPost post = new HttpPost(URL);

        StringEntity se = new StringEntity(json.toString());
        se.setContentType(new BasicHeader(HTTP.CONTENT_TYPE,
                "application/json"));
        post.setEntity(se);
        response = client.execute(post);

        /* Checking response */
        if (response != null) {
            Log.d("RESPONSE", EntityUtils.toString(response.getEntity()));

            //InputStream in = response.getEntity().getContent(); // Get the
                                                                // data in
                                                                // the
                                                                // entity
            //Log.d("HTTPPOST", in.toString());
        }

    } catch (Exception e) {
        e.printStackTrace();
        // createDialog("Error", "Cannot Estabilish Connection");
    }

    Looper.loop(); // Loop in the message queue

} 
```

和 PHP 方面的事情

```
include("settings.php");

mysql_connect($loginURL,$username,$password);
@mysql_select_db($database) or die("-9");

echo var_dump($_POST);

$varname = mysql_real_escape_string(strip_tags($_POST['name']));
$varemail = mysql_real_escape_string(strip_tags($_POST['email']));
$varphone = mysql_real_escape_string(strip_tags($_POST['phone']));
$varUUID = mysql_real_escape_string(strip_tags($_POST['UUID']));
$vargeopointUUID = $_POST['geopointUUID'];

echo var_dump($_POST); 
```

* * *

echo var_dump($_POST) - 返回数组（0）{}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T03:22:42.427

POST 不希望传递 JSON，而是希望传递如下名称/值对：

```
List<NameValuePair> params = new ArrayList<NameValuePair>();
params.add(new BasicNameValuePair("key1", "value1"));
params.add(new BasicNameValuePair("key2", "value2"));
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
```

如果您想将 JSON 传递给 php，则需要检查和解析`$HTTP_RAW_POST_DATA`.

解析原始过去数据的一种方法（由 OP 引用）如下（php）：

```
$obj = json_decode($HTTP_RAW_POST_DATA); $varname =$obj->{'name'}; 
```

# mysql - 检查存储过程中的 select 语句是否返回行

> ID：14824831
> 
> 赞同：6
> 
> 时间：2013-02-12T03:18:25.803
> 
> 标签：mysql, sql, stored-procedures, aggregate-functions

如何检查存储过程中的 select 语句是否返回任何行。

```
select * from creditcards;
If sqlcod = 0 THEN 
```

例如，我想做这样的事情，但 sqlcod 似乎在 MySql 中不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T03:20:08.970

尝试使用`COUNT`，

```
DELIMITER $$
CREATE PROCEDURE procName()
BEGIN
    SET @recCount = (select count(*) from creditcards);
    If @recCount = 0 THEN
        -- statement here ;
    END IF;
END $$
DELIMITER ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T04:17:09.103

尝试使用如下所示：

使用`FOUND_ROWS()`和`SQL_CALC_FOUND_ROWS`：

```
DELIMITER $$ 

create procedure myproc() 
begin 
   SELECT SQL_CALC_FOUND_ROWS * 
   FROM tbl_name 
   WHERE id > 100 
   LIMIT 10; 

   if SELECT FOUND_ROWS() = 0 then 
   -- log away bro! 
   end if; 
end $$
DELIMITER $$ 
```

# android - 使用 AlarmManager 执行重复性任务

> ID：14824833
> 
> 赞同：2
> 
> 时间：2013-02-12T03:18:34.587
> 
> 标签：android, gps, alarmmanager

我正在尝试创建一个基本应用程序，该应用程序仅在每个工作日上午 8:00 开启，每 5 分钟检查一次 GPS，直到上午 8:55，该服务将停止，直到下一个工作日上午 8:00。做这个的最好方式是什么？我在想有一个 AlarmManager 会启动一个服务，它将另一个 AlarmManger 设置为 5 分钟。当该警报管理器启动 GPSService 时，GPSService 会执行此操作，然后设置另一个警报管理器在 5 分钟内自行启动，直到它计算出已经过了 8:55 并且根本不设置另一个警报管理器。但这**不是**一种有效或最佳实践，因此任何建议（最好是代码示例！）将不胜感激。

谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:28:52.500

当然还有其他方法可以实现相同的目标。它们都不会在设备方面特别“有效”，因为它们会每隔 5 分钟唤醒设备并使用 gps 无线电一段时间，我认为你不会变得更好或更糟任何可能的方法来实现它。

您可以使用`setReapeating()`5 分钟的间隔时间，并检查您的服务以确定您是否需要取消安排警报。如果您只是在寻找不同的方式。

但老实说，我认为按照您描述的方式进行操作没有任何问题。

# perl - perl 和 excel 图形轴

> ID：14824839
> 
> 赞同：0
> 
> 时间：2013-02-12T03:19:08.523
> 
> 标签：perl, excel, graph, scale, win32ole

我正在摆弄在 perl 脚本中创建的 excel 图表，并尝试设置最小和最大轴，但是我似乎无法理解 VBA 到 Perl 的转换。

请你帮忙。

我已经尝试了几种不同的方法，但这就是我现在所拥有的。

```
 $chart1->{Chart}->Axes(xlCategory)->MinorUnit => 0;
   $chart1->{Chart}->Axes(xlCategory)->MajorUnit => 100; 
```

我也尝试过以下方法。

```
 $chart1->{Chart}->Axes(xlCategory)->MinimumScale => 0;
   $chart1->{Chart}->Axes(xlCategory)->MaximumScale => 100; 
```

提前谢谢了。

微

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T00:31:41.483

经过一番搜索和反复试验，我设法解决了这个问题。所需的代码如下。

对于 x 轴；

```
$chart1->{Chart}->Axes(xlCategory,xlPrimary)->{MinimumScale} = 0;
$chart1->{Chart}->Axes(xlCategory,xlPrimary)->{MaximumScale} = 100; 
```

对于 y 轴；

```
$chart1->{Chart}->Axes(xlValue,xlPrimary)->{MinimumScale} = 0;
$chart1->{Chart}->Axes(xlValue,xlPrimary)->{MaximumScale} = 100; 
```

# c# - SQL Update 实际上没有更新？完毕

> ID：14824841
> 
> 赞同：-1
> 
> 时间：2013-02-12T03:19:13.573
> 
> 标签：c#, sql

已解决：我想出了自己的问题。它按我想的那样工作。我只是没有阅读正确的行。

我正在尝试在表 [Profiles] 中连续更新几列。运行此代码时我没有收到任何错误，但它实际上并没有更新列。我以前从未使用过更新。我究竟做错了什么。

```
string currentPage = Request.Url.ToString();
Uri myUri = new Uri(currentPage);
string position = HttpUtility.ParseQueryString(myUri.Query).Get("position");
string electionYear = HttpUtility.ParseQueryString(myUri.Query).Get("year");
var finalkey = Session["Userid"].ToString() + "^" + position + "^" + electionYear;
string sqlquery = "UPDATE [Profiles] SET Qualifications=@Qualifications, Platform=@Platform, FamilyLife=@FamilyLife, Website=@Website where FinalKey=@FinalKey";
SqlConnection conn = new SqlConnection(dbLocation);
SqlCommand comm = new SqlCommand(sqlquery, conn);
try
{
conn.Open();
comm.Parameters.AddWithValue("@FinalKey", finalkey);
comm.Parameters.AddWithValue("@Qualifications", qualificationsBox.Text);
comm.Parameters.AddWithValue("@Platform", platformBox.Text);
comm.Parameters.AddWithValue("@FamilyLife", familyBox.Text);
comm.Parameters.AddWithValue("@Website", candWebsiteBox.Text);
comm.ExecuteNonQuery();
}
catch { }
conn.Close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:33:06.507

请通过设置断点参考**finalkey的值！**只有不更新的可能是，

没有找到与此**finalkey**值匹配的记录。

另外的选择

手动设置 where 类值 Like where finalvalue="user1dec" 并检查它是否有效，然后你可以......

**var finalkey = Session["Userid"].ToString() + "^" + position + "^" +electionYear;**

# c# - 如何最好地构建此 API 以存储通用委托以供以后执行

> ID：14824842
> 
> 赞同：2
> 
> 时间：2013-02-12T03:19:33.093
> 
> 标签：c#, design-patterns, generics, reflection, delegates

我有一个自定义的 MVC 框架，我正在对路由 API 进行大修。我试图想出一种干净的方法来隔离我的框架中的“设置”和“执行”，它广泛使用了委托和泛型。现在我从调用方设想这个：

```
//setup
MyRouter.AddRoute("/foo", () => new MyHandler(), (h) => h.MyMethod);
//h.MyMethod only exists in MyHandler, not in HttpHandler
//execution
MyRouter.Execute(HttpContext); 
```

我目前可以使 AddRoute 方法签名“工作”：

```
delegate T HandlerInvoker<T>();
delegate string HandlerCallMethod<T>(T handler);
...
public void AddRoute<T>(string pattern, HandlerInvoker<T> invoker, HandlerCallMethod<T> caller) where T is HttpHandler{...} 
```

如果我不需要存储调用者和调用者并且可以做到这一点，那么这会很好。但是，我确实需要存储调用者和调用者以供以后执行。

目前我想做的事情：

*   将它们存储在 a 中`List<object>`，然后使用反射来调用它们。这似乎非常复杂，可能性能不太好
*   走向`AddRoute`执行。这可能会让人们更难使用我的 API，但最终可能会成为我唯一的“好”选择
*   问一个SO问题:)

有没有什么好方法可以存储这些泛型类型而无需大量痛苦的反思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:13:52.093

您可以存储一个匿名委托来为您执行所有转换。

看起来以下内容会起作用（未以任何方式测试）：

```
List<Action> handlers;
handlers.Add(() => caller(invoker())); 
```

请注意，如果您正在缓存，这将不起作用`invoker`。

在这种情况下，您需要保留价值，`Lazy`应该做到这一点。

```
List<Action> handlers;
Lazy<T> lazy = new Lazy<T>(invoker);
handlers.Add(() => caller(lazy.Value); 
```

后者只会创建`invoker`每次调用该方法的返回值的一个实例。并且由于`lazy`是一个局部变量，它会自动推入一个类，只要为`handlers`您保留一个引用，它就会被保留。

请注意，我忽略了模式，但您似乎不需要任何帮助。

# java - 如何在 android 中没有更新值的情况下仅获取加速度计 X、Y、Z 值？

> ID：14824844
> 
> 赞同：1
> 
> 时间：2013-02-12T03:19:49.543
> 
> 标签：java, android, mobile

嗨，我有一个类，它基本上收集 GPS 数据（经度、纬度和方位）、时间（以 H、M 和 S 为单位）和加速度计数据（X、Y、Z）都在按钮单击上。到目前为止，我已经让 GPS 的东西正常工作（除了 Bearing 出于某种原因只显示 0？？我需要为此设置一些特殊权限吗？？）以及在单击按钮时显示的时间，但加速度计X、Y 和 Z 不断变化，因为它们与听众联系在一起。有没有像 getX()、getY() 或 getZ() 这样的方法，它只会在按钮单击时给我一个 X、Y、Z 读数，而不会每次都改变。到目前为止，这是我的代码：

```
package com.example.servicetest3;

import java.util.Calendar;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity implements SensorEventListener {

private static final long MINIMUM_DISTANCE_CHANGE_FOR_UPDATES = 0; // in Meters
private static final long MINIMUM_TIME_BETWEEN_UPDATES = 1000; // in Milliseconds

protected LocationManager locationManager;    
protected Button retrieveLocationButton;
protected TextView displayView;

//accelerometer vars
Sensor accelerometer;
SensorManager sm;
TextView acceleration;
TextView time;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    retrieveLocationButton = (Button) findViewById(R.id.retrieve_location_button);
    displayView = (TextView) findViewById(R.id.displayView);

    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            MINIMUM_TIME_BETWEEN_UPDATES, 
            MINIMUM_DISTANCE_CHANGE_FOR_UPDATES,
            new MyLocationListener()
    );

    //time
    time = (TextView) findViewById(R.id.time);

    //set up Accelerometer service and its corresponding textViews
    acceleration = (TextView) findViewById(R.id.acceleration);
    sm = (SensorManager) getSystemService(SENSOR_SERVICE);
    accelerometer = sm.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    sm.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_NORMAL);

retrieveLocationButton.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            showCurrentLocation();
            int hour = Calendar.getInstance().get(Calendar.HOUR);
            int minute = Calendar.getInstance().get(Calendar.MINUTE);
            int second = Calendar.getInstance().get(Calendar.SECOND);
            time.setText(Integer.toString(hour) + " | " + Integer.toString(minute) + " | " + Integer.toString(second));
        }
});        

}    

protected void showCurrentLocation() {

    Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);

    if (location != null) {

        String message = String.format(
                "Current Location \n Longitude: %1$s \n Latitude: %2$s \n Bearing: %3$s",
                location.getLongitude(), location.getLatitude(), location.getBearing()
        );
        displayView.setText(message);

        //Toast.makeText(MainActivity.this, message, Toast.LENGTH_LONG).show();
    }

}   

private class MyLocationListener implements LocationListener {

    public void onLocationChanged(Location location) {
        String message = String.format(
                "New Location \n Longitude: %1$s \n Latitude: %2$s \n Bearing: %3$s",
                location.getLongitude(), location.getLatitude(), location.getBearing()
        );
        //Toast.makeText(MainActivity.this, message, Toast.LENGTH_LONG).show();
    }

    public void onStatusChanged(String s, int i, Bundle b) {
        Toast.makeText(MainActivity.this, "Provider status changed",
                Toast.LENGTH_LONG).show();
    }

    public void onProviderDisabled(String s) {
        Toast.makeText(MainActivity.this,
                "Provider disabled by the user. GPS turned off",
                Toast.LENGTH_LONG).show();
    }

    public void onProviderEnabled(String s) {
        Toast.makeText(MainActivity.this,
                "Provider enabled by the user. GPS turned on",
                Toast.LENGTH_LONG).show();
    }

}

//accelerometer
public void onSensorChanged(SensorEvent event) {
   acceleration.setText("X: " + event.values[0] + 
                        "\nY: " + event.values[1] +
                        "\nZ: " + event.values[2]);

}

@Override
public void onAccuracyChanged(Sensor sensor, int accuracy) {
    // TODO Auto-generated method stub

}
} 
```

请尽快帮忙！！！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:22:05.267

`onSensorChanged()`获取值后，只需取消注册侦听器即可。

```
public void onSensorChanged(SensorEvent event) {
    acceleration.setText("X: " + event.values[0] + 
                        "\nY: " + event.values[1] +
                        "\nZ: " + event.values[2]);

    sm.unregisterListener(this);
} 
```

# mongodb - Mongodb findAndModify 原子性

> ID：14824845
> 
> 赞同：4
> 
> 时间：2013-02-12T03:19:53.180
> 
> 标签：mongodb, locking, atomic, findandmodify

我想知道如何从 find 中引用返回的文档属性并在 modify 中使用它。前任 ：

```
var totalNoOfSubjects = 5;
db.people.findAndModify( {
    query: { name: "Tom", state: "active", rating: { $gt: 10 } },
    sort: { rating: 1 },
    update: { $set: { average: <reference score value returned by find>/totalNoOfSubjects} }
    } ); 
```

我的理解是 findAndModify 锁定了文档，因此我想使用在 find 中找到的属性在 modify 中执行更新。这将使操作原子化。

我想知道这是否受 mongo 支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:28:46.067

不，您不能在更新部分时引用找到的文档中的值 a `findAndModify`。在这方面是一样的`update`。

因此，您不能以原子方式执行此操作，因为您需要首先获取文档，然后制作`update`or`findAndMondify`以包含从获取的文档计算的值。

请参阅[https://jira.mongodb.org/browse/SERVER-458](https://jira.mongodb.org/browse/SERVER-458)了解未来可能解决的一种方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T04:15:22.767

原子性正是`findAndModify`.

如[docs 中所述](http://docs.mongodb.org/manual/reference/method/db.collection.findAndModify/)，Mongo 将找到一个或多个文档（匹配`query`指定）修改一个文档（使用`update`指定）。整个过程是原子的。默认实现让 Mongo 返回找到的文档（处于未更改状态）。这可以使用`new`选项进行修改。

# javascript - jQuery - 恢复删除的选择选项

> ID：14824852
> 
> 赞同：1
> 
> 时间：2013-02-12T03:20:30.837
> 
> 标签：javascript, jquery, drop-down-menu

我有多个具有相同选项的下拉菜单。如果选择了一个选项，其他下拉菜单将不会显示所选选项。当我尝试重置所选选项时，它没有恢复已删除的选择选项。

HTML部分：

```
<select id="selectNumber" class="selectbox">
    <option value="0">Choose a number</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
</select>
<select id="selectNumber2" class="selectbox">
    <option value="0">Choose a number</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
</select> 
```

Javascript部分：

```
$(".selectbox").change(function(){
    var selectedIndex = $(this).index();    
    var myVal = $(this).val();
    $(".selectbox").each(function(i){        
        if (selectedIndex != i){
            $("option", this).each(function(){                
               if (myVal == $(this).val() && myVal != 0){
                   $(this).detach();
               }else{
                   $(this).prepend();
                   //not work

               }

            });
        }
    });
}); 
```

[演示但不工作](http://jsfiddle.net/planetoid/7Ssu7/)

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:52:08.050

当您执行 detach() 时，对象将被删除，需要放入“全局”变量以保存为引用。出于您的目的，您可以使用 .hide() 和 .show() ，因为它将对象保留在列表中，而不会导致 DOM 插入或删除（因此性能肯定更好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:02:19.010

好吧，您当前的代码不起作用，因为您没有将选定的值存储在另一个下拉列表中。另外，就像其他人说的那样，使用`hide`and`show`代替`detach`and `prepend`。

[您可以在jsfiddle](http://jsfiddle.net/7Ssu7/6/)中看到我的解决方案（在 firefox 中测试）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T04:07:24.510

这应该做你想做的

```
/* store options */
var $selects = $(".selectbox");
var $opts = $selects.first().children().clone();

$selects.change(function () {       
    var myVal = $(this).val();
    if (myVal !='0') {
         $selects.not(this).children('[value="'+myVal+'"]').remove();
    }else{
        var replaceVal=$(this).data('currVal');
        $selects.not(this).append( $opts.filter( '[value="'+replaceVal+'"]').clone())
    }
    $(this).data('currVal', myVal);

}); 
```

演示[http://jsfiddle.net/7Ssu7/8/](http://jsfiddle.net/7Ssu7/8/)

**编辑版本 - 保持排序顺序**

```
/* store options */
var $selects = $(".selectbox");
var $opts = $selects.first().children().clone();

$selects.change(function () {
    /*create array of all selected values*/    
    var selectedValues=$selects.map(function(){
        var val=$(this).val();
        return val !=0? val :null;
    }).get();

    $selects.not(this).each(function(){     

        var $sel=$(this), myVal=$sel.val() ||0;        
        var $options=$opts.clone().filter(function(i){
            var val=$(this).val();         
            return  val==myVal || $.inArray(val, selectedValues) ==-1;
        });
        $sel.html( $options).val( myVal)
    });  

}); 
```

演示：http: [//jsfiddle.net/8uunN/1/](http://jsfiddle.net/8uunN/1/)

# vb.net - 在组合框中添加项目

> ID：14824859
> 
> 赞同：0
> 
> 时间：2013-02-12T03:22:04.177
> 
> 标签：vb.net, winforms, combobox, datatable

我想添加一个`combobox`已经与一些数据绑定的项目。

**代码：**

```
Public Sub showSection()
        sb = New StringBuilder()
        sb.Remove(0, sb.Length)
        sb.Append("SELECT DISTINCT Section ")
        sb.Append(" FROM Employee ")
        sb.Append(" ORDER BY Section")
        Dim sqlSection As String = sb.ToString()

        da = New SqlDataAdapter(sqlSection, Conn)
        da.Fill(ds, "Section")

        dt = ds.Tables("Section")
        bs.DataSource = dt

        With cbSection
            .DisplayMember = "Section"
            .ValueMember = "Section"
            .DataSource = ds.Tables("Section")
            .DataBindings.Add("SelectedValue", bs, "Section")
        End With
End Sub 
```

但我想添加项目，比如`"---All---"`，所以这应该是输出。

```
---All---
HR
Store
Packing
Training
Qc
Qa
Stock 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T11:08:37.447

这是简单的解决方案

```
Dim dr As DataRow = dt.NewRow()
dr("Section") = "---All---"
dr("SectionId") = 0
dt.Rows.InsertAt(dr, 0)

With cbSection
    .DisplayMember = "Section"
    .ValueMember = "SectionId"
    .DataSource = ds.Tables("Section")
    .DataBindings.Add("SelectedValue", bs, "Section")
End With

cbSection.SelectedIndex = 0 
```

# makefile - 使用 gnu 工具链（配置、Makefile 等）将 GLib 添加到现有应用程序

> ID：14824860
> 
> 赞同：0
> 
> 时间：2013-02-12T03:22:04.927
> 
> 标签：makefile, configure, glib, autoconf, automake

我已经向现有的大型应用程序添加了代码，并且需要使 GLib 成为一项要求，因为我的代码依赖于它。为了开发，我只是手动编辑了 Makefile 来添加

```
-lglib-2.0 
```

到 LIBS= 变量和

```
-I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include $< 
```

到以 ${CC} 开头的行。

但是，我不知道如何在应用程序中使其永久/可移植 - 即当有人在未来执行 ./configure 时，生成的 Makefile 还应该包括上述内容（酌情，因为这些取决于 pkg-config输出，我学到了）。我更新的代码库包括 gnu 工具链中的以下文件：

```
Makefile.in
Makefile.manual
config.h.in
configure
configure.in 
```

我只有少量的 CS 学位和几年的开发经验，所以 GNU 工具链对我来说仍然是完全无法理解的。:-/ 通过谷歌搜索，我的印象应该是还有[一个 configure.ac 文件](https://stackoverflow.com/questions/1732822/portably-include-glib-headers-in-autoconf-automake)或者我应该添加一个宏来要求 glib 的东西，但是包中没有包含这样的文件，我就是这样对整个 automake/autoconf/configure/makefile 业务的学习无助。提前感谢您的任何建议或指示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T08:10:50.323

1.  您不应手动编辑任何生成的文件。这包括用于构建应用程序的最终 Makefile。
2.  在`configure.ac`中，列出了每个依赖项，因此应该在那里检查 GLib。从此文件`configure`中生成最终的 shell 脚本。
3.  GLib 提供了[pkgconfig](http://www.freedesktop.org/wiki/Software/pkg-config)描述，因此您几乎总是希望使用它来获得正确的编译和链接标志。
4.  结合 pkgconfig 和 Autotools 只是调用`PKG_CHECK_MODULES`宏的问题。[Autotools Mythbuster](http://www.flameeyes.eu/autotools-mythbuster/pkgconfig/pkg_check_modules.html)是一个很好的资源，它描述了如何做到这一点。
5.  最后归结为将这些行添加到您的`configure.ac`：

    ```
    PKG_PROG_PKG_CONFIG
    PKG_CHECK_MODULES([GLIB], [glib-2.0]) 
    ```

    这些行到你的`Makefile.am`：

    ```
    foo_CXXFLAGS = $(GLIB_CFLAGS)
    foo_LIBS = $(GLIB_LIBS) 
    ```

# python - linux中不同类型的脚本

> ID：14824862
> 
> 赞同：0
> 
> 时间：2013-02-12T03:22:10.240
> 
> 标签：python, linux, perl, scripting

我对linux很陌生，我想学习脚本。似乎有很多选项可以从 bash shell 脚本、python、perl lisp 以及我不知道的更多内容中学习脚本。我只是想知道它们的优点和缺点是什么，什么是一个好的起点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T03:27:38.073

最基本的脚本形式是 Bourne shell 脚本。这可以像在一个文件中放入多个命令一样简单，每行一个命令。

```
# simple shell script example
clear
ls 
```

这是一个示例程序，它清除终端屏幕，然后列出当前目录中的文件。对于此示例，shell 脚本是迄今为止最简单的方法。

根据我的经验，一旦 Bourne shell 脚本获得了一堆特性，它们就会变得非常难以维护。此外，如果您需要使用可能包含空格的文件名或目录名，那么正确引用您的变量以使脚本正常工作是非常痛苦的。一种更现代的脚本语言将成为一个福音。

我个人的选择是 Python。它很容易学习，你永远不会发现它对于任何问题都不够强大。您还会发现，在编写 Python 脚本六个月后，您仍然可以看到它的作用，而无需全神贯注并在脑海中对代码进行逆向工程。

我建议你找一本好书，读一读，做练习。如果您使用 Python 书籍，您将从 Python 开始；如果你得到一本高级 UNIX 书籍，它会教你 shell 脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:30:48.033

每个程序员对此都会有一个有偏见的答案，但要记住的一件事是你的目标是什么。例如，如果您只想成为一名成功的系统管理员，那么您的目标可能最好通过学习更有利于系统管理员任务的语言来实现（例如 bash）。但是，如果您希望进行更通用的编程，包括数据分析，则最好将您的研究重点放在 Python 或 Perl 等更通用的语言上。对于 Web 开发，Ruby 可能值得学习，等等。这真的取决于你为什么对学习脚本感兴趣。

如果您真的没有具体原因并且正在寻求一般性建议，那么从一种语言开始并精通它然后扩展到其他语言可能是明智的。这些天，规范路径可能是 bash --> Python。当然，这只是一个人的看法。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T03:40:26.137

我想很多时候，刚接触编程的人看到了所有的选项，却不知道从哪里开始。您在帖子中列出了一堆不同的语言。我的建议是选择其中一种语言并找到一本书或教程并完成它。

我开始对“脚本”感兴趣，而不仅仅是想出一个适合我需要的 mIRC 脚本。但是，完成之后，我将操作系统从 Windows 更改为 Linux，mIRC 脚本不再适合我。所以我开始使用 Perl 和 Python，看看哪个最适合 xChat。

最终，这一切归结为你需要尝试一门语言并动手学习。我最终完成了项目，并使用了 PHP。在完成这些工作的同时，我还阅读了 Michael Hartl 的教程并使用了一些 Ruby on Rails。现在我正在使用 Node.js (javascript) 重写它。

最好的选择，只需选择一种语言并开始使用它。

# apache - 我的 .htaccess/mod_rewrite 规则有问题吗？

> ID：14824868
> 
> 赞同：1
> 
> 时间：2013-02-12T03:22:42.170
> 
> 标签：apache, .htaccess, mod-rewrite

.htaccess 中的下一个简单规则，用于将所有非 www 的请求重定向到 www：

```
 RewriteCond %{HTTP_HOST} !^www\.(.*)$ [NC]
  RewriteRule ^(.*)$ http://www.%1/$1 [R=301,L] 
```

并在使用同类 URL 进行检查时

```
http://example.com/something 
```

这将我重定向到

```
http://www./something 
```

似乎 RewriteCond 有效，但正则表达式的结果中没有任何内容，我认为必须是没有 www 的主机名。怎么了——谁知道呢？

重定向到具体主机的规则变体，例如：

```
 RewriteCond %{HTTP_HOST} !^www\.(.*)$ [NC]
  RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

和其他类似的变体工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:26:11.800

而不是捕获`HTTP_HOST`into `%1`with `(.*)`（这对你不起作用），只需`%{HTTP_HOST}`替换`RewriteRule`：

```
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

你拥有它的方式，你似乎`%1`没有因为`!`否定而被填充。

### 从[文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)[中`RewriteRule`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)：

> 使用 NOT 字符否定模式时，不能在该模式中包含分组的通配符部分。这是因为，当模式不匹配（即否定匹配）时，组没有内容。因此，如果使用否定模式，则不能在替换字符串中使用 $N！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:37:31.707

这种标准的做法似乎是：

```
RewriteCond %{HTTP_HOST} ^example\.com$
RewriteRule ^(.*) http://www.example.com/$1 [R=301] 
```

这就是[mediatemple](http://kb.mediatemple.net/questions/85/Using+.htaccess+rewrite+rules#gs)、[wordpress](http://wordpress.org/support/topic/all-non-www-urls-redirect-to-www-url)等推荐他们的用户设置他们的 .htaccess 文件的方式。

# c++ - Visual Studio Project always out of date, "up to date is missing @ECHO", why is Visual Studio looking for this input?

> ID：14824873
> 
> 赞同：2
> 
> 时间：2013-02-12T03:23:05.067
> 
> 标签：c++, visual-studio-2010, build, qmake, jam

## Background:

My team wants Visual Studio for development on an existing codebase, for its various tools, and that's what most developers are used to using. However, the existing build system (an internal flavor of Jam) is very entrenched, and for a variety of factors cannot be changed.

## The idea:

1.  Create a project for each component. I did this using a description generated by Jam of what files go into each library, and making that into a QT project file. I call qmake on this to generate Visual Studio projects with "qmake -tp vc".

2.  Disable Visual Studio's build. I did this by changing the Type of each source file to "does not participate in build" (by changing each to )

3.  Add a pre-build event that calls the Jam build.

## Problem:

Now, when I try to build from Visual Studio, it works, in that it calls Jam. However, I would expect Visual Studio to think the project is always up-to-date, considering it is not actually tracking any source files for compile. But it is always out-of-date, and must call the pre-build command before debugging (which attaches the debugger to the executable, and works just fine).

I used DebugView to see what was going on, and for many of my projects, I get the following in the log

```
[12900] Project '<my project's name>' is not up to date because 1 build inputs were missing. 
[12900] devenv.exe Information: 0 : 
[12900]  up to date is missing: '<my project's location>\@ECHO' 
```

I've searched high and low, but cannot find any reference to @echo as a file input to anything anywhere. Does anybody know, and/or is there a way to track down why it is looking for this?

# javascript - 拥有多个 javascript 对象实例

> ID：14824880
> 
> 赞同：1
> 
> 时间：2013-02-12T03:23:49.333
> 
> 标签：javascript, object

我试图寻找一个类似的问题，要么不能正确地表达它，要么我很傻。我对 JavaScript 比较陌生，并且对创建多个对象实例有疑问：

这里是：

假设您正在尝试使用 javascript 动态构建“列表构建器”。您创建多个列表并向其中添加项目。所以你像这样构建一个类（注意，代码主要是说明性的，试图澄清问题）：

```
var dynamicList = function(listName){
    this.listTitle = listName;
}

dynamicList.prototype = {

    buildList : function(){
        var template = $('<ul id="'+ this.listTitle +'"></ul>').append('<h2>' + this.listTitle + '</h2>';
        $(body).append(template);
    }

} 
```

现在问题来了：

假设我使用输入表单来创建列表包装器，并且每次提交表单时，都会生成一个新列表。这是如何管理的？我认为每次都需要创建一个新对象：

```
var list1 = new dynamicList("[user input title from form]"); //first list
list1.buildList();

var list2 = new dynamicList("[user input title from form]"); //second list
list2.buildList();

var list3 = new dynamicList("[user input title from form]"); //third list
list3.buildList();    

var list[n] ... // and so on
list[n].buildList(); 
```

但我无法弄清楚如何做到这一点。我可以动态创建变量名，或者如何解决这个问题？您会将其包装在更高级别的对象中并为创建的每个列表创建一个增量系统吗？这甚至是一个问题，还是您可以递归地使用`var list = new dynamicList`每种形式？

我希望我以一种每个人都能理解的方式来描述我的问题，感谢您花时间阅读它。对于如何构造代码以确保最大的可扩展性，我也很感激任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:31:55.417

如果你想拥有 n 个东西并能够引用它们 - 将它们放入一个数组中。

```
var myLists = []; //Shorthand for new Array()

var list = new DynamicList("[user input title from form]"); //first list
list.buildList()
myLists.push(list);

list = new DynamicList("[user input title from form]"); //second list
list.buildList()
myLists.push(list); 
```

您还可以通过创建构造函数来摆脱 buildList() 调用。

# php - How do I implement $_GET along with getdate() php

> ID：14824888
> 
> 赞同：-1
> 
> 时间：2013-02-12T03:25:04.330
> 
> 标签：php, get, getdate

I want to use the $_GET[] along with the getdate() to pull in the date as query string in the form of: YYYY-mm-dd. If no date is entered, then get the current date. This is what I have done, but I don't have a clue as to if I'm close or not.

```
if(!isset($_GET['date']))
{
//$date = "2012-09-15"; 
$date = date('Y-m-d');
}
elseif(DateTime::createFromFormat('Y-m-d', $_GET['date']))
{
//$date = DateTime::createFromFormat('Y-m-d',$_GET['date']);
$date = $_GET['date'];
}
else
{
$date = date('Y-m-d');
}
$calendar = DateTime::createFromFormat('Y-m-d', $date);

//This is something else I was attempting

//if(isset($_GET['date']) ? $_GET['date'] : $date = date('Y-m-d')
//$date = explode("-", $_GET['date']);
//$date = date('Y-m-d');
// Create new DateTime object passing the date as a string.
$calendar = DateTime::createFromFormat('Y-m-d', $date); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:32:33.120

不知道你在追求什么，但 PHP 的日期格式会是这样的

```
int strtotime ( string $time [, int $now = time() ] ) 
```

# android - Developing an Android Client Server app

> ID：14824889
> 
> 赞同：0
> 
> 时间：2013-02-12T03:25:14.707
> 
> 标签：android, client-server

I am developing an app as follows: Android APP (As a client)..it will send data to a Server (Java application running on a PC). I implemented this using socket programming and it is working. I have following issues:

1.  When I click the send button on my app the APP UI freezes for ~7 seconds. It is able to ping and connect to server but during this time frame the UI freezes and if I click any other button on the app I get a message app is stuck (but the app comes back ok after ~ 7 seconds). What is the best way to resolve it.

2.  Once data (strings) is received on the PC, I want to show it in the form of List Box UI so that user can select/double click on the specific string and a message box is open showing that that particular string is selected. What is the best way to develop this UI and how can it be invoked directly as soon as server receives the data from Client (android app) and this UI should show up.

Please let me know. All help is appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:27:43.203

将所有与网络相关的代码放入单独的线程中，或者（更容易）和[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html). 否则，您会阻止 UI，正如您已经注意到的那样，应用程序实际上会在较新的 Android 版本（ICS 和 JB）上崩溃。

如果你搜索 SO 和互联网，你会发现很多例子。

# python - 如何绘制相交的平面？

> ID：14824893
> 
> 赞同：23
> 
> 时间：2013-02-12T03:26:03.880
> 
> 标签：python, matplotlib

我想使用 matplotlib 或多或少地绘制我在下面附上的图，其中包括两个相交的平面，具有适当的透明度，指示它们的相对方向，以及以 2D 投影的两个平面中的圆和矢量。

我不确定是否有这样做的现有软件包，有什么提示吗？![图片来源：M Strassler](../Images/15ba0b8a72af2bacba1a1c307112ea25.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-12T05:24:44.077

```
from mpl_toolkits.mplot3d import axes3d
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

dim = 10

X, Y = np.meshgrid([-dim, dim], [-dim, dim])
Z = np.zeros((2, 2))

angle = .5
X2, Y2 = np.meshgrid([-dim, dim], [0, dim])
Z2 = Y2 * angle
X3, Y3 = np.meshgrid([-dim, dim], [-dim, 0])
Z3 = Y3 * angle

r = 7
M = 1000
th = np.linspace(0, 2 * np.pi, M)

x, y, z = r * np.cos(th),  r * np.sin(th), angle * r * np.sin(th)

ax.plot_surface(X2, Y3, Z3, color='blue', alpha=.5, linewidth=0, zorder=-1)

ax.plot(x[y < 0], y[y < 0], z[y < 0], lw=5, linestyle='--', color='green',
        zorder=0)

ax.plot_surface(X, Y, Z, color='red', alpha=.5, linewidth=0, zorder=1)

ax.plot(r * np.sin(th), r * np.cos(th), np.zeros(M), lw=5, linestyle='--',
        color='k', zorder=2)

ax.plot_surface(X2, Y2, Z2, color='blue', alpha=.5, linewidth=0, zorder=3)

ax.plot(x[y > 0], y[y > 0], z[y > 0], lw=5, linestyle='--', color='green',
        zorder=4)

plt.axis('off')
plt.show() 
```

![结果](../Images/fc336a950e15fdf9b11a5f131549965b.png)

### 警告：

*   我正在运行一个非常接近当前主版本的版本，所以我不确定在旧版本中可以使用什么

*   拆分绘图的原因是“上方”和“下方”以某种神秘的方式确定（我不确定它`zorder`实际上做了什么），并且实际上取决于绘制艺术家的顺序。因此曲面不能相交（一个将在另一个上方），因此您需要分别绘制交叉点两侧的部分。（您可以在我没有拆分的黑线中看到它，看起来就像在上蓝色平面的“顶部”）。

*   表面的“正确”排序似乎也取决于视角。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T05:59:46.487

Matplotlib 确实具有 3d 投影功能，但虚线在最终的 2D 图像视图中以恒定宽度绘制，看起来不像平放在倾斜平面上。如果几何图形很简单，并且“轨道”是圆形的，它可能会起作用，但如果您想绘制从某个角度看到的椭圆，则查看者可能希望在整个 3D 排列上获得更多视觉线索。

如果我必须像这样制作一个漂亮的精美插图，但更好更漂亮，并且不必自动化，我会首先为每个飞机创建图形 - 至少是虚线圆圈一个简单的平面 2D 图像，使用目前看起来很方便的任何东西 - 一个矢量绘图程序，如 Illustrator 或 Inkscape，或者如果有数据要遵循，则在 matplotlib 中。

Then, I'd use POV-Ray or Blender to model the planes at whatever angles, spheres for the round things (planets?). The 2D graphics already generated would become textures to be mapped to the planes. POV-Ray uses a scripting language allowing a record to be kept, modified, and copied for future projets. If it were really one-time and I didn't mind doing it all by hand, Blender is good. Whichever tool I use, the result is an image showing the desired projection of the 3D geometric elements into 2D.

Are the round things, what I'm calling "planets" supposed to be flat circles in the final work, like in the examples? Then I'd draw them with a vector drawing app over the rendered 3D image. But I suspect you'd prefer spheres in 3D.

The samples shown have no lighting or shadows. Shadows would help with clarifying the geometry in 3D, although the first of those two illustrations isn't too bad. The short green line showing the inclined plane's planet over the red line seems clear enough but a shadow would help. The second illustration does look a bit more confusing as to the shape, location an intersections of the various entities. Here, shadows would help more. POV-Ray or Blender will happily create these with little effort. Even more, inter-reflections, known as radiosity, help with seeing 3D relations in 2D images. This advanced effect is easy to do these days, not needing expertise in optics or graphics, just knowing that it exists.

Of course, this advice is no good unless one is already familiar with 3D graphics and tools such s POV-Ray.

对于自动化解决方案，在一些快速而肮脏的程序中使用 OpenGL 可能是最好的。不过，阴影可能需要一些工作。

# php - PHP MeCard 解码器或 MeCard 到 VCard 转换器

> ID：14824897
> 
> 赞同：0
> 
> 时间：2013-02-12T03:26:20.463
> 
> 标签：php, qr-code, vcf-vcard

我正在研究 QR 码解析器，我想知道是否有人知道 MeCard 库或将 MeCard 转换为 VCard 的代码。如果没有，那里有 MeCard 的官方规范文档吗？我知道 NTT DoCoMo 创建了它，但我在上面找不到任何类型的 RFC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T04:41:45.047

从[http://code.google.com/p/zxing/wiki/BarcodeContents](http://code.google.com/p/zxing/wiki/BarcodeContents)，我在[http://www.nttdocomo.co.jp/english/service/developer/make/找到了 DoCoMo 的 MeCard 规范的链接内容/条码/功能/应用程序/地址簿/index.html](http://www.nttdocomo.co.jp/english/service/developer/make/content/barcode/function/application/addressbook/index.html)。它非常简单，通过函数调用将其转换为 VCard 应该是微不足道的。

== 编辑 ==

我写了一个小转换函数。以防万一将来有人想要该代码，代码如下：

```
private function MeCardtoVCard($mecard_text)
{
    // Useful References:
    // http://www.nttdocomo.co.jp/english/service/developer/make/content/barcode/function/application/addressbook/index.html
    // http://code.google.com/p/zxing/wiki/BarcodeContents
    // http://en.wikipedia.org/wiki/VCard
    // https://theqrplace.wordpress.com/2011/05/02/qr-code-tech-info-mecard-format/

    $vcard = '';

    if (stripos($mecard_text, "mecard") === 0) 
    {
        $mecard_text = str_replace("\n", "", $mecard_text); // Strip out newlines
        $mecard_text = substr($mecard_text,7); // Strip off the MECARD: header

        $lines = explode(";", $mecard_text);

        if (count($lines) > 0)
        {
            // Using Version 2.1 because it is the most commonly supported.
            $vcard = "BEGIN:VCARD\nVERSION:3.0\n"; 

            foreach($lines as $l)
            {
                $line_elements = explode(":",$l);

                if (count($line_elements) > 1)
                {
                    // Must split into two parts.  Not sure how DoCoMo escapes
                    // data that actually contains a ":", so for now we are presuming
                    // that the first token is the property name and all other elements 
                    // are the value

                    $property = $line_elements[0];
                    $value = implode(":", array_slice($line_elements,1));

                    if ($property != '' && $value != '')
                    {
                        if ($property == 'N')
                        {
                            // MeCards only support first and last name.
                            $tmp = explode(",",$value);
                            if (count ($tmp) == 1)
                            {   
                                $vcard .= "N:;" . $tmp[0] . "\n";
                            }
                            else 
                            {
                                $vcard .= "N:" . implode(";",explode(",",$value)) . "\n";
                            }
                        }

                        if ($property == 'TEL') 
                        {
                            // MeCard does not use card types, so we will presume all of them are type CELL
                            $vcard .= "TEL:" . $value . "\n";
                        }

                        if ($property == 'ADR') 
                        {
                            // MeCard: "The fields divided by commas (,) denote PO box, room number, house number, city, prefecture, zip code and country, in order."
                            // VCard: "...post office box; the extended address; the street address; the locality (e.g., city); the region (e.g., state or province); the postal code; the country name" See http://www.ietf.org/rfc/rfc2426.txt 3.2.1
                            $vcard .= "ADR:" . implode(";",explode(",",$value)) . "\n";
                        }

                        if (in_array($property, array('NOTE', 'BDAY', 'URL', 'NICKNAME')))
                        {
                            $vcard .= $property . ':' . $value . "\n";
                        }
                    }
                }
            }

            $vcard .= "END:VCARD\n";

            return $vcard;
        }
        else 
        {
            return false;
        }
    }       

    return false;
} 
```

# json - 如何通过AngularJS路由保存数据？

> ID：14824901
> 
> 赞同：15
> 
> 时间：2013-02-12T03:26:52.940
> 
> 标签：json, scope, angularjs

我是 AngularJS 的新手，正在尝试为自己构建一个简单的小应用程序。我有正在获取的应用程序的 JSON 数据`$resource`，并且这些数据在多个视图/路由中应该是相同的。但是，当我转到新路线时，JSON 数据（存储为`$scope.data`）不再可用于新视图。我该怎么做才能将此数据传递给新视图而不需要再次获取？（教程电话目录应用程序每次都会根据我所知重新获取此数据。）

据我了解，`$rootScope`可以做到这一点，但似乎普遍不赞成。如果这没有多大意义，我深表歉意；我在这里非常深入。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-12T03:35:22.137

使用服务来存储数据。将该服务注入需要访问此数据的每个控制器。每次创建和执行控制器时（因为您切换到另一个视图/路由），它都可以向服务请求数据。如果服务还没有数据，它可以向服务器发出请求并向控制器返回一个承诺（参见下文了解如何执行此操作）。如果服务有数据，它可以立即将数据返回给控制器。

另请参阅[在服务中处理 $http 响应](https://stackoverflow.com/questions/12505760/angularjs-processing-http-response-in-service)

请注意，服务是单例的，与控制器不同。

另一种变化：创建服务时，它可以自己获取数据，然后将其存储以供以后使用。控制器可以比 $watch 服务上的属性或功能。有关此方法的示例，请参阅 [如何在 Angular 中存储当前用户上下文？](https://stackoverflow.com/questions/14206492/how-do-i-store-a-current-user-context-in-angular)

# database - 如果我不创建记录集对象，是否需要在 MS Access 中关闭记录集？

> ID：14824902
> 
> 赞同：3
> 
> 时间：2013-02-12T03:27:06.693
> 
> 标签：database, vba, ms-access-2007, recordset

我已经读过在 Access 中关闭记录集对象很重要，但是使用我的代码，我从不创建记录集对象，我总是只使用内联引用，例如：

```
Dim ClientName As String

ClientName = CurrentDB.OpenRecordset([some SQL]).Fields(0).Value 
```

我看不到像 CurrentDB.CloseRecordset 这样的东西，而且我认为 CurrentDB.Close 不是一个好主意。在这种情况下，我是否需要关闭任何记录集，还是会自动关闭？

我通过 ODBC 连接将 MS Access 2007 与 SQL Server 后端一起使用。

如果我的任何术语或使用错误，请随时纠正我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T05:59:45.723

显然 CurrentDB.OpenRecordset '追加到记录集集合'

此代码是否有效，是否表明您已添加到记录集集合中：

```
Dim ClientName As String

msgbox CurrentDB.Recordsets.Count

ClientName = CurrentDB.OpenRecordset([some SQL]).Fields(0).Value

msgbox CurrentDB.Recordsets.Count 
```

并四肢走动，这行得通吗：

```
Dim ClientName As String

msgbox CurrentDB.Recordsets.Count

ClientName = CurrentDB.OpenRecordset([some SQL]).Fields(0).Value

msgbox CurrentDB.Recordsets.Count

msgbox CurrentDB.Recordsets(0).Close 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T06:16:06.293

您的代码创建了一个临时记录集；它在语句完成后立即超出范围。所以你不能`.Close`记录集，因为它不再存在。

情况类似于此即时窗口会话...

```
? CurrentDB.Recordsets.Count
 0 
strSelect = "SELECT Count(*) FROM Dual;"
MyVar = CurrentDB.OpenRecordset(strSelect)(0)
? MyVar
 1 
? CurrentDB.Recordsets.Count
 0 
```

# c++ - C ++：std :: shared_ptr有什么区别 和 std::shared_ptr ?

> ID：14824905
> 
> 赞同：0
> 
> 时间：2013-02-12T03:27:18.723
> 
> 标签：c++, shared-ptr

`std::shared_ptr<T>`和 和有什么不一样`std::shared_ptr<T const>`？

你什么时候会使用其中一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T03:34:19.840

*   **`shared_ptr<int>`**是一个`shared_ptr`非常量`int`。您可以修改 int 和`shared_ptr`

*   **`shared_ptr<const int>`**是一个`shared_ptr`对一个`const int`。您不能`const int`将`shared_ptr`点修改为，因为它是`const`. 但是您可以修改`shared_ptr`自身（分配给它，调用其他非常量方法等）

*   **`const shared_ptr<int>`**是一个`const shared_ptr`非常量`int`。您不能修改`shared_ptr`（通过调用`reset`或任何非常量方法），但您可以修改`int`它指向

*   **`const shared_ptr<const int>`**是一个`const shared_ptr`对一个`const int`。你不能修改千斤顶。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T03:33:55.647

```
shared_ptr<T> 
```

在引擎盖下存储一个 T*，而

```
shared_ptr<T const> 
```

在引擎盖下存储一个 T const*。因此，它与指向某些数据的指针和指向某些常量数据的指针之间的区别相同。

当您只想让它表现得像一个常规指针（带有引用计数）时，您会使用 shared_ptr 并且当您想要存储指向某些常量数据的 ref-counted 指针（您从不打算修改的数据）时，您会想要使用 shared_ptr .) 回想一下，指向常量数据的指针（不能修改指向的数据，但可以修改指针）和常量指针（可以修改指向的数据，但不能修改指针本身）之间存在区别。 ) 最后还有一个指向常量数据的常量指针，您既不能修改指向的数据，也不能修改指针本身。

# exception - LLVM 异常抛出

> ID：14824906
> 
> 赞同：14
> 
> 时间：2013-02-12T03:27:22.157
> 
> 标签：exception, llvm

我已阅读[此博客文章](http://blog.llvm.org/2011/11/llvm-30-exception-handling-redesign.html)、[此文档页面](http://www.llvm.org/docs/ExceptionHandling.html)和[此示例](https://llvm.org/svn/llvm-project/llvm/trunk/examples/ExceptionDemo/ExceptionDemo.cpp)，但我仍然不明白如何使用 LLVM 的 IRBuilder 为非 C++ 面向语言抛出基本异常。

据我了解，我必须：

*   创建一个`llvm::Value`包含抛出的值。
*   调用*"a function"*，将抛出的值传递给它。此函数不会返回。

该示例使用系统倒带函数 ( `_Unwind_RaiseException`) 来引发 C++ 异常，我真的不明白如何使用我自己的引发函数（因为我只需要引发对象指针）。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-17T09:13:01.950

简短的回答是这`_Unwind_RaiseException`不是特定于 C++ 的函数。它来自 libunwind 库，允许抛出任何类型的异常。

可以在[这些博客文章](http://monoinfinito.wordpress.com/category/programming/c/exceptions/page/3/)中找到更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T16:25:14.443

由于您不想使用现有的 C++ 异常处理基础架构，因此您需要为您的语言复制其中的一部分。

[您可以在compiler-rt](https://github.com/llvm-mirror/compiler-rt/blob/master/lib/gcc_personality_v0.c)中使用 C unwinder 的实现（或者在[libstdc++](http://code.google.com/codesearch#Yj7Hz1ZInUg/trunk/gcc-4.2.1/libstdc%2B%2B-v3/libsupc%2B%2B/eh_personality.cc)中使用更复杂的实现），然后在[libstdc](http://code.google.com/codesearch#Yj7Hz1ZInUg/trunk/gcc-4.2.1/libstdc%2B%2B-v3/libsupc%2B%2B/eh_throw.cc&ct=rc&cd=1&q=__cxa_throw) ++中调用unwinder 。

# wcf - 什么是 StreamBody，为什么我不能从 Delphi 客户端使用它？

> ID：14824909
> 
> 赞同：0
> 
> 时间：2013-02-12T03:27:39.853
> 
> 标签：wcf, delphi, stream

我正在构建一个 WCF 服务，将文档（Docx/Doc、PDF、Xls）返回到客户端。

在当前实现中，WCF 服务将输出文档作为`Stream`客户端返回。

不费吹灰之力，我可以通过将返回的内容复制`Stream`到 a`FileStream`并将其保存到本地文件系统来在 .Net 客户端应用程序上使用它。而且我还设法构建了一个 Delphi 客户端，它可以使用一个非常简单的 WCF 服务，它将字符串返回给客户端。

但问题是我找不到使用返回`Stream`类型的 WCF 服务的方法，因为返回`Stream`的实际上是`StreamBody`并且我不知道如何将其保存`StreamBody`到 Delphi 上的本地文件中。也许在 Delphi 中不可能这样做？

我正在使用 Delphi 2007 和 VS 2010 .Net 4.0 根据[SO 中的这个问题](https://stackoverflow.com/questions/10818391/sending-large-data-from-wcf-server-to-delphi-client)，也许使用`Stream`根本不是一个好主意。而且我认为对于文档我可以返回`bye[]`到客户端，但我仍然喜欢`Stream`通过网络而不是 Array 的想法。

# asp.net-mvc-3 - Sitecore 上下文未加载到自定义控制器中

> ID：14824912
> 
> 赞同：1
> 
> 时间：2013-02-12T03:27:59.860
> 
> 标签：asp.net-mvc-3, sitecore, sitecore6

我遵循了本[教程](http://www.experimentsincode.com/?p=407)，并创建了以下代码：

```
using Glass.Sitecore.Mapper;
using Sitecore.Mvc.Controllers;
using Sitecore.SecurityModel;
using SitecoreCMSMVCBase.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace SitecoreCMSMVCBase.Controllers
{
    public class CommentController : SitecoreController
    {
        ISitecoreContext _context;
        ISitecoreService _master;

        public CommentController()
            : this(
            new SitecoreContext(),
            new SitecoreService("master"))
        {

        }
        /// <summary>
        /// This constructor can be used with dependency injection or unit testing
        /// </summary>
        public CommentController(ISitecoreContext context, ISitecoreService master)
        {
            _context = context;
            _master = master;
        }

        [HttpGet]
        public override ActionResult Index()
        {
            var model = _context.GetCurrentItem<CommentPage>();
            return View(model);
        }

        [HttpPost]
        public ActionResult Index(Comment comment)
        {
            var webModel = _context.GetCurrentItem<CommentPage>();

            if (ModelState.IsValid)
            {
                var masterModel = _master.GetItem<CommentPage>(webModel.Id);

                if (masterModel.CommentFolder == null)
                {
                    CommentFolder folder = new CommentFolder();
                    folder.Name = "Comments";

                    using (new SecurityDisabler())
                    {
                        _context.Create(masterModel, folder);
                    }
                    masterModel.CommentFolder = folder;
                }

                using (new SecurityDisabler())
                {
                    comment.Name = DateTime.Now.ToString("yyyyMMddhhmmss");

                    //create the comment in the master database
                    _master.Create(masterModel.CommentFolder, comment);
                    webModel.CommentAdded = true;
                }
            }

            return View(webModel);
        }
    }
} 
```

模型与教程相同，所以我不会粘贴它们。

我的路由配置如下所示：

```
routes.MapRoute(
    "CommentController", // Route name
    "Comment/{action}/{id}", // URL with parameters
    new { controller = "Comment", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

当我导航到`/comment`我看到这个异常：

```
Glass.Sitecore.Mapper.MapperException: Context has not been loaded 
```

我尝试评论我的路由规范（因为教程中没有关于路由的内容），然后错误不同（由 Sitecore CMS 本身抛出）：

> 未找到请求的文档

你知道如何将 Sitecore 上下文加载到自定义控制器中，并使这个简单的示例工作吗？我到处寻找，但找不到任何好的答案...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T12:58:33.177

我认为这更像是 Glass 设置问题，而不是 MVC 路由问题。要设置 Glass，您需要在 Global.asax 文件的应用程序启动方法中初始化上下文。

```
var loader = new Glass.Sitecore.Mapper.Configuration.Attributes.AttributeConfigurationLoader(
        "Glass.Sitecore.Mapper.Tutorial.Models, Glass.Sitecore.Mapper.Tutorial");

Glass.Sitecore.Mapper.Context context = new Context(loader); 
```

对于其他与 Glass 设置相关的内容，我建议遵循 glass.lu 网站上的第一个教程。 [http://www.glass.lu/tutorials/glass-sitecore-mapper-tutorials/tutorial-1-setup/](http://www.glass.lu/tutorials/glass-sitecore-mapper-tutorials/tutorial-1-setup/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T04:02:11.997

这种方法根本不需要 Glass！

第一步是在`Global.asax`文件中设置您的路线。

```
routes.MapRoute(
    "DemoController", // Route name
    "Demo/{action}/{param}", // URL with parameters
    new { controller = "Demo", action = "Index", param = "", scItemPath = "/sitecore/content/DemoHomePage" } // Parameter defaults
); 
```

请注意，控制器不是作为参数，而是固定的，以防止 Sitecore 对其进行处理。更多信息[在这里](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2012/11/The-Sitecore-Default-MVC-Route-is-not-a-Catchall-Route.aspx)和[这里](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2012/11/Fun-Facts-about-MVC-Route-Initialization-in-the-Sitecore-ASPNET-CMS.aspx)。请注意，还有一个附加参数 - `scItemPath`。它包含默认情况下将包含在页面上下文中的项目的路径。

有了这条路线，我们的流量就由动作`/demo`来处理。在此操作中，您只需添加以下行：`DemoController``Index`

```
Sitecore.Data.Items.Item item = Sitecore.Mvc.Presentation.PageContext.Current.Item; 
```

`item` variable will contain your Sitecore item pointed by `scItemPath`.

And that's all - it should work well now - hope it helps!

# c# - 更好的方式来满足字符串列表

> ID：14824915
> 
> 赞同：1
> 
> 时间：2013-02-12T03:28:21.713
> 
> 标签：c#, linq

我有以下代码使用 linq to entity 更新我的表。

它需要两个参数，一个是字符串和字符串列表。我的 linq 查询使用 \r\n 更新列。

我期待我的字符串列表（HoursByRate）有一到五个值。

例如，如果我的字符串列表只有一个值，在这种情况下，我可以将其余的 (HoursByRate2 -5) 分配为空白空间吗？或者

写一个单独的方法来满足这个逻辑？

```
 string HoursByRate1 = HoursByRate[0].ToString();
 string HoursByRate2 = HoursByRate[1].ToString();//assign empty if no value
 string HoursByRate3 = HoursByRate[2].ToString();
 string HoursByRate4 = HoursByRate[3].ToString();
 string HoursByRate5 = HoursByRate[4].ToString();
var query = 
// var querySEVTs =
    from SEVTs in db.SEVTs
    where
    SEVTs.SESID == BookingSesid
    select SEVTs;
foreach (var SEVTs in query)
{
    SEVTs.USER3 = (HoursByRate1 + SqlFunctions.Char(10) + SqlFunctions.Char(13) + HoursByRate2 + SqlFunctions.Char(10) + SqlFunctions.Char(13) + HoursByRate3 + SqlFunctions.Char(10) + SqlFunctions.Char(13) + HoursByRate4 + SqlFunctions.Char(10) + SqlFunctions.Char(13) + HoursByRate5 + SqlFunctions.Char(10) + SqlFunctions.Char(13));
}
db.SaveChanges();
; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:54:11.673

你不应该首先遇到这个问题 - 重新考虑你的数据库模式：

使用在用户表上有外键和单个小时费率的表（例如“hourlyRates”）。每个用户（或您的主表是什么）可以有多行，在您的情况下为一到五。要获取给定用户的所有小时费率，您可以根据用户 ID 将用户表与 hourlyRate 表连接起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T04:56:42.553

```
string value = string.Empty;
for (int i = 0; i < 5; i++)
       {
           string str = " ";
           if (i < HoursByRate.Count())
               str = HoursByRate[i];
           value += str + ((char)10).ToString() + ((char)13).ToString();
       }

foreach (var SEVTs in query)
{
    SEVTs.USER3 = value;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T05:04:52.190

您是否尝试执行 String.Join 方法的功能？

```
SEVTs.USER3 = String.Join(SqlFunctions.Char(10) + SqlFunctions.Char(13), HoursByRate) 
```

# java - cachingHttpclient 不能忽略标头“Cache-Control: no-cache”

> ID：14824916
> 
> 赞同：3
> 
> 时间：2013-02-12T03:28:28.297
> 
> 标签：java, caching, cache-control, apache-httpclient-4.x

我正在使用 Apache cachingHttpClient 从 java 代码中查询 REST API。

尽管接收到“Cache-Control：no-cache”标头导致cachingHttpClient不缓存文件，但我仍想缓存一些http响应。

使用独立的 http 代理，例如 squid、mod_cache...，我可以调整配置以忽略这些标头并覆盖默认行为。

我宁愿不使用独立的 http 代理，而是使用 100% java 代码。

1.  是否有另一个 http 客户端可以提供更多的缓存控制？
2.  我可以实现一个中间层/代理来重写标题吗？
3.  我可以通过继承修补缓存HttpClient 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T20:11:09.697

该请求被方法`CachedResponseSuitabilityChecker`中的拒绝`canCachedResponseBeUsed`。如果您需要不同的行为，那就是实现您自己版本的类，然后使用 long 构造函数`cachingHttpClient`

```
CachingHttpClient(HttpClient backend, 
     CacheValidityPolicy validityPolicy,
     ResponseCachingPolicy responseCachingPolicy,
     HttpCache responseCache,
     CachedHttpResponseGenerator responseGenerator,
     CacheableRequestPolicy cacheableRequestPolicy,
     CachedResponseSuitabilityChecker suitabilityChecker, 
     ConditionalRequestBuilder conditionalRequestBuilder, 
     ResponseProtocolCompliance responseCompliance, 
     RequestProtocolCompliance requestCompliance) 
```

# php - jGrowl 并关闭回调以请求 Ajax？

> ID：14824922
> 
> 赞同：0
> 
> 时间：2013-02-12T03:28:59.347
> 
> 标签：php, jquery, ajax, getjson, jgrowl

我有一个关于如何维护所呈现的 jGrowls 状态的 jQuery / jGrowl 问题。我有一个使用 PHP/MySQL 构建的通知系统。那是容易的部分。我已经设法让 jGrowls 正确显示。

现在，我想保持消息/jGrowls 的状态，直到用户单击每个 jGrowl 的“关闭”或关闭所有 jGrowl 的“全部关闭”链接。我有一个 users_notifications MySQL 表，我可以在其中管理哪些通知已被“读取”。我认为最好的方法是使用 close() 或 beforeClose() 回调向服务器发出 getJSON (ajax) 请求，但我不确定如何编写。我需要通过请求将通知 ID 传回。

```
<?php
if (!empty($notifications))
{
    foreach ($notifications as $notification)
    {
?>
        <script>
            <!--
            $(document).ready(function() {
                var notification = <?php echo json_encode($notification); ?>;
                $.jGrowl(notification.message, {
                    beforeClose: function(){
                        var markReadUrl = '<?php echo site_url('notifications/ajax_mark_as_read') ?>' + '/' + notification.id;
                        $.getJSON(markReadUrl, function(data) {
                            console.log(data);
                        });
                    }
                });
            });
            //-->               
        </script>
<?php
    }
}
?> 
```

02/12 更新：我想我发现了让我困惑的地方。

测试时我使用了 2 或 3 个通知 (jGrowls)。我期待当用户单击单个 jGrowl 关闭链接时会触发 beforeClose() 回调函数，即 jGrowl 右侧的“x”链接。'x' 关闭是否有回调？请注意，当用户单击“全部关闭”时，beforeClose() 回调会正确触发，并触发每个 jGrowl 的函数。所以，在某种程度上，“关闭所有”就像一个“标记为已读”链接，而“x”链接什么也不做。这是预期的功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T13:13:06.750

你是对的，你可以选择两个不同的回调，你可以使用'close'或'beforeClose'。我可能会选择“beforeClose”，因为此时通知已被解除，接下来将开始从页面中删除它的过程。

因此，利用回调可能如下所示：

```
$.jGrowl('Message here...', {
    beforeClose: function(){
        $.ajax({
            url: '/path/to/dismiss/action',
            success: function(){}
        });
    }
}); 
```

如果这是您将在每个通知中使用的内容，您可以执行以下操作...

```
$.jGrowl.defaults.beforeClose = function(){
    //...
} 
```

我的猜测是，您将需要以某种方式单独跟踪通知，这样当您发出 ajax 请求以将其关闭时，您将传回主键或类似的东西。我建议的一件事是使用 beforeOpen 回调并使用 data() 方法为您的主键设置唯一标识符。这样，当您设置消息时它就被绑定了，您可以稍后在它被关闭时引用它，而不必担心在其他地方处理信息。

希望这可以帮助！

# php - 分页没有结果显示在下一页

> ID：14824924
> 
> 赞同：1
> 
> 时间：2013-02-12T03:29:37.023
> 
> 标签：php, mysql

我最近在做关于分页的项目，但问题是当我点击“搜索”按钮时，第一页中的数据会出现，但第二页是空白的，当我回到第一页时，页面完全空白. 这是代码。谢谢！

```
<form method="post">
<div><table>
                    <td><b>Select Section:</b></td>
                    <td><select name="level">
                                        <option value="Nursery">Nursery</option>
                                        <option value="K-1">K-1</option>
                                        <option value="K-2">K-2</option>
                                        <option value="Grade 1">Grade 1</option>
                                        <option value="Grade 2">Grade 2</option>
                                        <option value="Grade 3">Grade 3</option>
                                        <option value="Grade 4">Grade 4</option>
                                        <option value="Grade 5">Grade 5</option>
                                        <option value="Grade 6">Grade 6</option>
                                        <option value="please_select" selected="selected" id="ps">Please Select</option>
                                        </select></td>

                     <td><input type='image' name='submit' src='images/search1.jpg' id='img11' value='Search'/></td>
                     <span class='label'>&nbsp;</span>
     </tr>             
    </table></div>

<CENTER><table class="table1" border = "1" cellspacing="0" cellpadding="9">
<tr class="tr1">
    <th class="th1">Student Name</th>
    <th class="th1">Year Level</th>
</tr>

<?php
    if (!isset($_POST['level'])) 
    { 
    $_POST['level'] = "undefine";   
    }
    $level = $_POST['level'];

    @$page = (int) $_GET['page'];
    if ($page < 1) $page = 1;
    $numPages = 6;
    $resultsPerPage = 5;
    $startResults = ($page - 1) * $resultsPerPage;
    $numberOfRows = mysql_num_rows(mysql_query('SELECT * FROM students'))or die(mysql_error());
    $totalPages = ceil($numberOfRows / $resultsPerPage);

    $id=1;

    $sql="SELECT * FROM students where level = '$level' LIMIT $startResults, $resultsPerPage" or die(mysql_error());
    $result=mysql_query($sql);
    while ($row = mysql_fetch_assoc($result)){
    if($level == ""){
    echo "<script>alert(\"Please Enter Year Level!\");</script>";
    return 'student_list';
    }
    else{
    echo "<tr class='tr1'>";
    echo "<center>";
            echo "<td class='1'>" . $row['surname'] .", " .$row['firstname']." ". $row['middlename']. "</td>";
            echo "<td class='1'>". $row['level'] . "</td>";
    echo "</center>";
    echo "</tr>";
    }
   }
    $id++;
    $boundaryPages = floor($numPages / 2);
    $range = array('start' => 1, 'end' => $totalPages);
    $even = ($numPages % 2 == 0);
    $theEnd = $totalPages - $boundaryPages;

    if($even) $theEnd++;

    if($totalPages > $numPages)
    {
        if($page <= $boundaryPages)
            $range['end'] = $numPages;
        elseif ($page >= $theEnd)
            $range['start'] = $totalPages - $numPages + 1;
        else
        {
            $range['start'] = $page - $boundaryPages;
            $range['end'] = $page + $boundaryPages;
            if($even) $range['end']--;
        }
    }
    if($page > 1)
        echo '<a href="?page='.($page - 1).'">&laquo;</a>&nbsp';

        for ($i = $range['start']; $i <= $range['end']; $i++)
        {
            if($i == $page)
                echo '<strong>'.$i.'</strong>&nbsp;';
            else
                echo '<a href="?page='.$i.'">'.$i.'</a>&nbsp;';
        }
    if ($page < $totalPages)
        echo '<a href="?page='.($page + 1).'">&raquo;</a>&nbsp;'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:38:41.323

如果你想携带有关搜索参数的数据，你想将它添加到你的分页链接中，并使用`$_GET`;访问它。或使用[会话](http://www.php.net/manual/en/features.sessions.php)。否则，您的应用程序将丢失`$_POST`以下页面上的所有数据知识。

# c - C系统调用，删除文件

> ID：14824926
> 
> 赞同：-6
> 
> 时间：2013-02-12T03:30:03.587
> 
> 标签：c, system

现在，当我一遍又一遍地使用 write 系统调用时，它只是附加到一个文件，让我们调用 file.txt，如果我要在 C 中调用 sys call write，在 file.txt 上，它会不断地出现。有一种情况，给定同一个文件，我想删除它的所有内容，只添加一行。我该怎么做？我不想创建一个新文件，我想在同一个文件中工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:33:13.850

行为取决于文件打开的模式：听起来你当前在`append`模式下打开；您需要以常规写入方式打开才能获得所需的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T03:39:30.557

传给或传给, , ,或。`O_TRUNC`_`open()``"w"``"wb"``"w+"``"wb+"``"w+b"``fopen()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T03:39:42.867

只需调用`truncate`或`ftruncate`将文件剪切为零字节。然后写下你想要的那一行。您不需要关闭或重新打开文件，您可以使用现有的句柄。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T03:38:26.253

当您调用 fopen() 时，您需要将其传递给适当的模式：读取、写入、追加等。这是对[fopen()](http://en.cppreference.com/w/c/io/fopen)的一个很好的回顾。

# php - 通过 php 将字符串/数据发送到连接到我的服务器的设备

> ID：14824931
> 
> 赞同：2
> 
> 时间：2013-02-12T03:31:20.067
> 
> 标签：php, tcp, udp, wifi, arduino

再会，

我有一个硬件设备（RN-XV WiFi 芯片），它已通过端口 80 成功连接到我的服务器 IP 地址。我能够发送垃圾数​​据，它响应“服务器无法服务此请求”，意思是是一个连接。

现在，我需要与该设备通话/向其发送数据/字符串。我知道一些基本的 PHP，但我不知道如何解决这个问题。我的设备已连接到服务器，但：

1.  要向它发送数据，我必须知道所连接设备的 IP/端口对吗？我怎么知道呢？

2.  如果我能够获得这个..发送数据是否是通过 PHP 打开 TCP 连接并发送字符串的问题？

3.  现在我已连接到服务器，我能够以某种方式发送字符串，但它返回时服务器无法处理此请求。我如何实际将数据发送到特定的 PHP 文件以进行读取？

请帮忙！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:54:04.027

您必须为套接字编写程序。请参阅此页面以进行 php 套接字编程 [http://php.net/manual/en/book.sockets.php](http://php.net/manual/en/book.sockets.php)

使用此功能，您可以连接到每个端口、发送数据并以您想要的每种格式获得响应。

示例：用于连接到设备

```
<?php
    $fp = fsockopen("udp://127.0.0.1", 2000, $errno, $errstr);
    if (!$fp) {
        echo "ERROR: $errno - $errstr<br />\n";
    } else {
       fwrite($fp, "data for send");
       while ( !feof( $fp ) ) { 
          $ret .= fgets( $fp, 4096 ); 
       }
       echo $ret;
       fclose($fp);
    }
?> 
```

更多示例[http://php.net/manual/en/function.fsockopen.php](http://php.net/manual/en/function.fsockopen.php)

# macos - 如何使用符号链接导航？

> ID：14824932
> 
> 赞同：0
> 
> 时间：2013-02-12T03:31:20.383
> 
> 标签：macos, bash, shell, unix, terminal

如何使用符号链接导航？

我创建了一个符号链接，让我们说“项目”到我的“/Desktop/Work/Projects”文件夹。因此，如果我在我的根目录中输入“ls”，我会看到一堆东西，它们之间的符号链接。'cd projects' 失败并出现以下错误：

```
-bash: cd: projects: No such file or directory 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:35:07.100

符号链接已损坏。如果你的`/Desktop/Work/Projects`意思是“你的” `/home/youruser/Desktop/Work/Projects`，那么这就是你应该符号链接到的路径：

```
ln -s "/home/youruser/Desktop/Work/Projects" "/home/youruser/projects" 
```

# ruby-on-rails - 在 Rails 中更新单个属性

> ID：14824939
> 
> 赞同：4
> 
> 时间：2013-02-12T03:32:19.570
> 
> 标签：ruby-on-rails

我想问一下如何直接更新rails中的单个属性。我已经尝试了很多方法来解决它，但它们都不起作用。目前，在我看来，我有这行代码：

`<%= link_to("Ban", admin_update_path(user), :confirm => "Are you sure?")%>`

然后在我的控制器中：

```
def update 
       @user = User.first

        if @user.update_attributes(:reputation =>1)
            redirect_to admin_viewAllUsers_path, :notice => "User banned!"
        else
            render "index"
        end  

    end 
```

然后在我的路线中：

```
get "admin/edit"
put "admin/update" 
```

注意：如果我在路由中使用 put "admin/update"，我会得到 "No route matches [GET] "/admin/update.2" 错误，但是当我使用 get "admin/update" 时我没有得到任何错误，但我的 :reputation 不会更新。顺便说一句，:reputation 是一个整数

此外，如果我使用 User.find(params[:id]) 而不是 User.first，我会得到“找不到没有 ID 的用户”错误。

请帮忙。我该怎么办？我哪里做错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T04:48:04.757

对于单个属性，您可以使用：

```
@user.update_attribute(:reputation,1) 
```

对于我的意见更新操作，它是不同的（更改姓名，姓氏等）不仅禁止，我认为您应该创建操作`ban`：

```
 def ban 
      @user = User.find(params[:id])
      @user.update_attribute(:reputation,1)
      redirect_to admin_viewAllUsers_path, :notice => "User banned!"
    end 
```

及其路线：

```
match 'admin/users/:id/ban', :to => 'users#ban', :as => 'admin_user_ban', :via => :post 
```

最后链接：

```
<%= link_to("Ban", admin_user_ban_path(user), :confirm => "Are you sure?", :method => :post)%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T03:51:46.613

为什么不

```
@user.reputation = 1
if @user.save
  #do something
else
  puts "Did not save"
end 
```

您的accessible_attributes 中有声誉吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T06:12:03.743

您的路线需要 PUT 方法。沿着这些路线的东西......

```
<%= link_to("Ban", admin_path(user), :confirm => "Are you sure?", :method => :put)%> 
```

您在路由文件中的编辑和放置方法并不表示 :id 属性。在你的情况下，是这样的：

```
get "admin/:id/edit"
put "admin/:id" 
```

# c# - Webservice API 设计：仅返回显示类型或类型代码或两者兼而有之？

> ID：14824940
> 
> 赞同：0
> 
> 时间：2013-02-12T03:32:31.577
> 
> 标签：c#, web-services, rest, architecture, software-design

Web 服务设计——我的 Web 服务应该如何响应？

例如，电话号码的类型可以是“家庭电话”、“商务电话”、“客户服务电话”等

我的 Web 服务 API 应该在响应中返回“PhoneTypeCode”还是 PhoneTypeName（用于显示）？

```
Example of Business telephone type

1) PhoneTypeCode: "business"
2) PhoneType: "Business telephone"
3) Return both? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T03:47:26.570

根据您的需要，两种方法都可以。

决定时考虑：

*   如果客户对不同的类型有特殊的处理——在这种情况下，代码会更容易处理。
*   如果存在本地化问题并且您的服务已经提供本地化响应（即，您将数字/日期作为本地化字符串返回，或者您需要在请求中传递文化并且其他字符串相应地本地化）。如果您的服务器不提供任何本地化支持-返回字符串可能是 confsing。
*   如果类型集完整 - 如果不将类型重新定义为字符串（非本地化）可能会更好，因为它会强制客户端更早地开始处理“未知”类型。

# android - 无法在 Android 中显示 xml 的 UI

> ID：14824951
> 
> 赞同：2
> 
> 时间：2013-02-12T03:33:50.300
> 
> 标签：android, android-layout, android-xml

我似乎无法在 layout-land-1208x752 文件夹中显示或查看我的 xml 的 UI，但在另一个文件夹中，它显示正确。

![在此处输入图像描述](../Images/ef1a945b50815ac1b3a7fa610338fe59.png)

我在 Stack Overflow 中读过类似的问题，但似乎都没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T10:48:45.673

要更新您的 ADT，请转到帮助 -> 安装新软件并添加[https://dl-ssl.google.com/android/eclipse/](https://dl-ssl.google.com/android/eclipse/)作为存储库

或者如果你已经完成了尝试检查来自 eclipse 的更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T06:25:24.787

这是我的工作，请检查您的 xml 文件或更新 ADT。

# php - 预选匹配 db 值的选项而不添加新的 Select 选项

> ID：14824952
> 
> 赞同：0
> 
> 时间：2013-02-12T03:33:53.623
> 
> 标签：php, select, selected

我正在创建一个客户帐户页面，该页面显示数据库中的相关信息并允许客户编辑他们的信息。

下面的代码从数据库中检索并显示客户的帐户信息，并预先选择正确匹配其信息的值。我的问题是特定于 Select 元素的 - 它不是从现有的选择选项中进行选择，而是在数据库中添加一个带有值的额外选择选项，以便数据库中的值显示两次。

**编辑 -**例如，如果 'gift_privacy' 的 db 值为 'Standard'，则选择选项显示为：*Standard、Standard、Gift ID Req、Not_Enrolled* 而不是 *Standard、Gift ID Req、Not_Enrolled*

如何更正此代码以便将`selected="selected"`其应用于现有选项？

```
<?php   
try {  
$stmt = $conn->prepare("SELECT * FROM customer_info WHERE user_id = :user_id");  
$stmt->bindValue(':user_id', $user_id); 
$stmt->execute();
}catch(PDOException $e) {echo $e->getMessage();}
$row = $stmt->fetch();
$search = array('_', ',');
$replace = array(' ', ', ');
$rows = str_replace($search, $replace, $row);
?>
<select name="gift_privacy">
<option selected="selected" value="<?php echo $rows['gift_privacy']; ?>"><?php echo $rows['gift_privacy']; ?></option>
<option value="Standard">Standard</option>
<option value="Gift_ID_Req">Require program ID</option>
<option value="Not_Enrolled">Do not enroll</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:14:58.127

尝试：

```
<?php
$gifts = array(
    "Standard" => "Standard",
    "Gift_ID_Req" => "Require Program ID",
    "Not_Enrolled" => "Do not Enroll");

$gift = $rows['gift_privacy'];
//$gift = "Gift_ID_Req";
foreach($gifts as $key => $value) {
    if($key == $gift) {
        echo '<option selected="selected" value="'. $key .'">'. $value .'</option>';
    } else {
        echo '<option value="'. $key .'">'. $value .'</option>';
    }
}
?> 
```

代替：

```
<option selected="selected" value="<?php echo $rows['gift_privacy']; ?>"><?php echo $rows['gift_privacy']; ?></option>
<option value="Standard">Standard</option>
<option value="Gift_ID_Req">Require program ID</option>
<option value="Not_Enrolled">Do not enroll</option> 
```

当然，有多种方法可以给猫剥皮，您可以检查是否`$rows['gift_privacy']`与每行上的当前选项匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T04:59:03.970

试试这个 。这是解决您问题的简单方法。

```
<select name="gift_privacy">
<option value="Standard" <?php if($rows['gift_privacy']=='Standard') echo "selected='selected'"; ?>>Standard</option>
<option value="Gift_ID_Req" <?php if($rows['gift_privacy']=='Gift_ID_Req') echo "selected='selected'"; ?>>Standard</option>
<option value="Not_Enrolled" <?php if($rows['gift_privacy']=='Not_Enrolled') echo "selected='selected'"; ?>>Standard</option>
</select> 
```

# php - 无法从 PHP 中的递归函数获取 xml 元素属性值？

> ID：14824953
> 
> 赞同：0
> 
> 时间：2013-02-12T03:33:54.543
> 
> 标签：php, xml, recursion, simplexml

我无法获取 xml 元素的属性值，因为每次单击链接时都没有值，`id=`但是当查看我的 xml 时有一个属性值，为什么会发生这种情况我错过了什么？

这是我的PHP代码：

```
 <?php
function parse_recursive(SimpleXMLElement $element, $level = 0)
{
    $indent = str_repeat('', $level); 

    $value = trim((string) $element); 
    $children = $element->children(); 
    $attributes = $element->attributes();

    echo '<ul>';
    if(count($children) == 0 && !empty($value))
    {   
        if($element->getName() == 'GroupName'){
            echo '<li><a href="http://localhost:8080/test/test.php?id=';
            if(count($attributes) > 0)
            {
                foreach($attributes as $attribute)
                {
                    if($attribute->getName() == 'Id'){
                        echo $attribute;
                    }
                }
            }
            echo '">'.$element.'</a></li>';
        }
    }   

    if(count($children))
    {
        foreach($children as $child)
        {
            parse_recursive($child, $level+1);
        }
    }
    echo '</ul>';
}

$xml = new SimpleXMLElement('main.xml', null, true);
parse_recursive($xml);
?> 
```

这是我的xml结构：

![在此处输入图像描述](../Images/639e4f6ffd98fd0a4b6420b3c88c7d1a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:39:00.870

您的代码似乎只会为`GroupName`元素输出任何内容：

```
if($element->getName() == 'GroupName'){ 
```

它只会输出元素的`Id`属性。`GroupName`

源 XML 中的单曲`GroupName`没有`Id`属性。

# arrays - 如何在 Perl 中打印 @slice 数组元素？

> ID：14824955
> 
> 赞同：1
> 
> 时间：2013-02-12T03:33:56.133
> 
> 标签：arrays, perl, hash, slice

我有这部分代码来捕获沉浸在哈希中的数组的更大值。当 Perl 识别出最大值时，@slice 数组将删除数组：

```
if ( max(map $_->[1], @$val)){
my @slice = (@$val[1]);             
my @ignored = @slice;
delete(@$val[1]);
print "$key\t @ignored\n";
warn Dumper \@slice; 
```

}

数据：自卸车：

`$VAR1 = [ [ '3420', '3446', '13', '39', 55 ] ];`

我想在一行中打印由制表符 (\t) 分隔的这些信息，如下所示：

```
miRNA127 dvex589433 -    131     154
miRNA154 dvex546562 +    232     259    
miRNA154 dvex573491 +    297     324    
miRNA154 dvex648254 +    147     172
miRNA154 dvex648254 +    287     272
miRNA32 dvex320240 -     61  83
miRNA32 dvex623745 -     141     163
miRNA79 dvex219016 +     ARRAY(0x100840378) 
```

但在最后一行总是得到这个结果。

我怎样才能生成这个输出？：

```
miRNA127 dvex589433 -    131     154
miRNA154 dvex546562 +    232     259    
miRNA154 dvex573491 +    297     324    
miRNA154 dvex648254 +    147     172
miRNA154 dvex648254 +    287     272
miRNA32 dvex320240 -     61  83
miRNA32 dvex623745 -     141     163
miRNA79 dvex219016 +     3420    3446 
```

附加说明：在这种情况下，我想捕捉 $VAR->[1] 中的最大值并查看 $VAR->[0] 中最小值的减法是否 <= 到 55。如果不是，我需要消除此 AoA（最大值）并用它填充 @ignored 数组。接下来，我想打印一些@ignored 的值，比如一个列表。接下来，使用结果 AoA，我想迭代最后一个流程......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:53:53.943

```
print "$key\t $ignored[0]->[0]\t$ignored[0]->[1]"; 
```

你有一个数组数组，所以每个元素`@ignored`都是一个数组。符号`$ignored[0]`到达第零个元素（这是一个数组），`->[0]`并`->[1]`检索该数组的第零个和第一个元素。

例如：

```
use strict;
use warnings;
use Data::Dumper;

my @ignored;
$ignored[0] = [ '3420', '3446', '13', '39', 55 ];
my $key = 'miRNA79 dvex219016 +';

print Dumper \@ignored;
print "\n";

print "$key\t$ignored[0]->[0]\t$ignored[0]->[1]"; 
```

输出：

```
$VAR1 = [
          [
            '3420',
            '3446',
            '13',
            '39',
            55
          ]
        ];

miRNA79 dvex219016 +    3420    3446 
```

生成相同输出的另一个选项是对`join`所有带有 a 的值`\t`：

```
print join "\t", $key, @{ $ignored[0] }[ 0, 1 ]; 
```

# iphone - 在现有的 Xcode 故事板上使用 pkrevealcontroller

> ID：14824959
> 
> 赞同：3
> 
> 时间：2013-02-12T03:34:33.167
> 
> 标签：iphone, ios, uinavigationcontroller, storyboard

我正在尝试将 pkrevealcontroller 滑动菜单集成到现有的 iOS 项目中，该项目具有带有 segues 等的现有情节提要。我扩展了 UINavigationViewController 并将我的新类链接到情节提要上的导航控制器。在我的应用程序委托中，我执行以下操作：

```
MainNavViewController *frontViewController = [[MainNavViewController alloc] initWithRootViewController:[[myRootViewController alloc] init]];
UIViewController *rightViewController = [[menuViewController alloc] init];

self.revealController = [PKRevealController  revealControllerWithFrontViewController:frontViewController
                                                                rightViewController:rightViewController
                                                                            options:nil];

self.window.rootViewController = self.revealController; 
```

当我运行应用程序时，它成功地将滑动菜单图标添加到导航栏，并且前视图按我想要的方式滑动。但它没有使用我在情节提要上添加的标题或转场。我正在尝试甚至可能。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T04:53:22.507

我认为问题在于您正在实例化一个新的frontViewController——这不是您故事板中的那个。我不完全确定如何做到这一点，但我会这样尝试。我会在情节提要中添加一个 UIViewController——将其类更改为 PKRevealController，并使其成为情节提要中的初始控制器，但不要将其连接到其余场景。在 IB 中给 MainNavViewController 一个标识符，然后将应用程序委托中的代码更改为：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    self.revealController = (PKRevealController *)self.window.rootViewController;
    UIViewController *rightViewController = [[menuViewController alloc] init];
    MainNavViewController *frontViewController = [[UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil] instantiateViewControllerWithIdentifier:@"frontViewController"];
    [self.revealController setFrontViewController:frontViewController];
    [self.revealController setRightViewController:rightViewController];
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T13:09:33.190

我的应用程序委托没有`revealController`变量，因此必须创建该手册，这是您必须做的事情吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-11T14:02:49.770

在**Swift**中使用这个，

```
func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {

    var frontViewController:UIViewController = UIStoryboard(name: "Main", bundle: nil).instantiateViewControllerWithIdentifier("frontVC") as! UIViewController

    var leftViewController:UIViewController = UIStoryboard(name: "Main", bundle: nil).instantiateViewControllerWithIdentifier("leftVC") as! UIViewController

    var revealController:PKRevealController = PKRevealController(frontViewController: frontViewController, leftViewController: leftViewController)

    self.window?.rootViewController = revealController

    return true
} 
```

# assembly - 防止此 YASM 警告的正确方法是什么？

> ID：14824960
> 
> 赞同：1
> 
> 时间：2013-02-12T03:35:01.920
> 
> 标签：assembly, nasm, yasm

我在 YASM 中有这行代码（32 位代码）：

```
call 0xC0000000 
```

哪个工作正常，但是给了我这个警告：

```
warning: value does not fit in signed 32 bit field 
```

有很多方法可以绕过警告，或者压制，甚至完全忽略它。
但我想知道的是：

首先避免此警告的*正确方法是什么？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T07:58:02.300

看起来用 -0x40000000 替换它可以修复它（因为这个值是有符号的）。

# yii - yii 通过 post 搜索表单而不是 get

> ID：14824963
> 
> 赞同：0
> 
> 时间：2013-02-12T03:35:07.867
> 
> 标签：yii

我有一个简单的搜索

```
public function search() {
    $criteria=new CDbCriteria;
    $criteria->with = array('agent');

    $criteria->compare('full_name',$this->full_name,true);

    if ($this->gender_id != "") {
        $criteria->compare('gender_id',$this->gender_id);
    }

    return new CActiveDataProvider($this, array(
        'criteria'=>$criteria,
        'pagination'=>array(
            'pageSize'=>30,
        ),
    ));
} 
```

但是我不喜欢使用`get`方法搜索时地址栏出现搜索参数。我已将搜索小部件更改为使用该`post`方法：

```
$form=$this->beginWidget('CActiveForm', array(
    'action'=>Yii::app()->createUrl($this->route),
    'method'=>'post',
)); 
```

但是现在当我点击搜索按钮时，页面只是刷新而不是显示搜索结果，我想我在这里遗漏了一些东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T03:43:10.057

在控制器的 actionAdmin 函数中，将 $_GET 替换为 $_POST ...

```
if(isset($_GET['Model']))
    $model->attributes=$_GET['Model']; 
```

将上述行中的 $_GET 替换为 $_POST ，例如：

```
if(isset($_POST['LoginLog']))
    $model->attributes=$_POST['LoginLog']; 
```

在搜索的旁注中，始终建议使用 GET 而不是 POST，我使用的基本规则是，每当需要提交一些数据时，它应该是 POST，每当需要获取一些数据时，它应该是 GET..

更新：我能想到的主要原因是我会使用 GET 进行搜索

1) 在搜索中，用户需要返回到前一个过滤器的功能，如果用作获取 url 参数，则很简单。

2）如果过滤器参数在url中，在某些过滤器之后非常容易分享结果..想象你想与朋友分享一些结果，你会给他一步一步过滤的说明（如果是POST），或者给出一个直接的 url(GET)

3) 从 url 更改参数非常容易，假设当前您正在访问第 2 页，但在显示过滤器的页面上仅显示指向下 5 页的链接，但您想直接跳转到第 15 页结果..

还有很多优点，我现在能想到的就这些了。。

# ruby - ruby 和 gems 已安装，但 sass gem 无法正常工作

> ID：14824965
> 
> 赞同：7
> 
> 时间：2013-02-12T03:35:26.987
> 
> 标签：ruby, gem, sass

我知道我已经安装了 ruby​​ 和 gem，因为我之前已经安装了一堆 gem。另外，当我执行以下操作时

```
~$ ruby --version
ruby 1.8.7 (2010-08-16 patchlevel 302 [i486-linux]

~$ gem --version
1.3.7 
```

正如你所看到的，他们返回了版本——然而当我尝试这样做时——

```
~$ sass --watch happy.scss:happy.css
bash: sass: command not found 
```

我对一切都是相对的菜鸟，但对红宝石和宝石更是如此。为了或多或少地揭示我对事物的理解水平，我对 Debian 的了解已经足够多，以获得一个可以让 Clojure 运行并让 Web 应用程序正常工作的环境（我花了将近一年的空闲时间来做这件事——我以前对编程几乎一无所知）。我正在努力让 sass 工作以减轻我在网页设计方面的精神负担，而我只是在这方面碰到了一堵砖墙。

这会是 PATH 问题吗？如果是这样，那么需要什么才能使一颗宝石起作用-

顺便说一句，这是我安装 sass 时会发生的情况——

```
# gem install sass
Successfully installed sass-3.2.5
1 gem installed
Installing ri documentation for sass-3.2.5...
Installing RDoc documentation for sass-3.2.5... 
```

任何人都可以提供的任何帮助将不胜感激。我整天都在这个，无法为我的生活弄明白。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T03:37:40.043

```
justin ⮀ ~ ⮀ gem install sass  
Fetching: sass-3.2.5.gem (100%)
Successfully installed sass-3.2.5
1 gem installed

justin ⮀ ~ ⮀ sass -v
Sass 3.2.5 (Media Mark) 
```

对我来说似乎没问题。我会检查你的路径。

正确的 PATH 取决于您的 gem 的安装位置。我使用 RVM，所以它会有所不同。您可以尝试在加载 ruby​​gems 的 ruby​​ 代码中抛出异常，这应该给您一个起点。

```
> rails c
Loading development environment (Rails 3.2.11)
1.9.3p362 :001 > throw test

ArgumentError: wrong number of arguments (0 for 2..3)
        from (irb):1:in `test'
        from (irb):1
        from /Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
        from /Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
        from /Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:5:in `require'
        from script/rails:5:in `<main>' 
```

所以我看到了`/Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/gems/railties-3.2.11/lib/rails/commands/console.rb`

所以我的 bin 路径在`/Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/bin`

如果我

`> ls /Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/bin`

```
b2json              capify              fog                 html2haml           nokogiri            rails               ri                  sass-convert        therubyracer        tilt
bundle              coderay             geocode             httpclient          oauth               rake2thor           ruby_noexec_wrapper scss                thin                tt
cap                 erubis              haml                j2bson              rackup              rdoc                sass                sprockets           thor 
```

繁荣萨斯

所以就我而言，我想添加`/Users/justin/.rvm/gems/ruby-1.9.3-p362@rails3.2/bin`

但我使用 RVM，所以它为我做到了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-03T20:23:02.150

尝试找出 Sass 的安装位置。就我而言，宝石路径是

```
[~] which gem
/usr/bin/gem 
```

但是 Sass 安装在我的 $PATH 之外的另一个路径中

```
[~] find . -name '*sass*'
./ruby/gems/doc/sass-3.4.22/rdoc/lib/sass
./ruby/gems/gems/sass-3.4.22/test/sass
./ruby/gems/gems/sass-3.4.22/bin/sass
./ruby/gems/gems/sass-3.4.22/lib/sass
./ruby/gems/bin/sass 
```

所以，我需要将 $HOME/ruby/gems/bin 添加到我的 $PATH; 然后，它解决了这个问题。

# javascript - 使用 testacular 是否可以同时通过测试运行 Jasmine 和 Mocha？

> ID：14824966
> 
> 赞同：0
> 
> 时间：2013-02-12T03:35:28.610
> 
> 标签：javascript, jasmine, mocha.js, karma-runner

使用 testacular 是否可以使用相同的配置文件“testacular.conf.js”同时通过测试运行 Jasmine 和 Mocha，并在 intellij 中运行它？

还是一次只能使用一个？那么只有茉莉花还是摩卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T01:00:31.663

不用担心。到目前为止，我发现这是不可能的，但没关系。我正在使用 chai 来代替茉莉花。但是，现在我在理解 angular-mocks.js 时遇到了问题。新问题woo

# c# - 我将如何将我的 3D 迷宫转换为 2D 迷宫？

> ID：14824968
> 
> 赞同：0
> 
> 时间：2013-02-12T03:35:38.643
> 
> 标签：c#, algorithm, xna, maze

我想要的有点像迷你地图。我已经为 3d 迷宫和 2d 迷宫构建了我的算法，但我不确定如何将 3d 转换为 2d 等价物。 [这是我的代码，我的代码来自 gist.github](https://gist.github.com/anonymous/4760028)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:49:21.023

您可以截取一架飞机穿过玩家当前所在关卡的屏幕截图，并将阻挡多边形涂成黑色，其余的留下白色。但首先，您需要从该平面切出所有相交区域。不确定您是否可以在游戏中使用 XNA 轻松做到这一点。

我敢打赌，通过删除当前关卡以外的所有关卡并制作一个巨大的屏幕截图，将其保存为该关卡的地图，在 3D 编辑器中手动操作会更容易，尽管如果您要向各个方向旋转立方体，您需要这样做很多次。

另一种方法是将整个地图的迷你副本分成立方体的 3d 矩阵并绘制所需的 2d 数组选择。

# http - “作业进行中”的最合适的 HTTP 状态代码

> ID：14824969
> 
> 赞同：15
> 
> 时间：2013-02-12T03:35:47.537
> 
> 标签：http, rest, response, httpresponse, http-status-codes

向客户端提供的最合适的 HTTP 状态代码是什么，以表示“您的请求很好，但仍在进行中；请稍后在完全相同的地方查看。”

例如，假设客户端提交了一个初始请求以启动一个繁重的查询，服务器立即返回一个 URL，客户端可以定期轮询该 URL 以获取结果。如果客户端在作业完成之前调用此 URL，那么返回的最合适的 HTTP 状态代码是什么？

**202 接受**将是我的第一个冲动。这是最好的，还是有更好的，在 REST 接口中更符合此目的？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-12T03:41:08.173

对我来说，*202 Accepted*是最好的选择。

请参阅W3C 网站上的[文档。](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

> 10.2.3 202 接受
> 
> 请求已被接受处理，但处理尚未完成。该请求最终可能会或可能不会被执行，因为在实际进行处理时它可能会被禁止。无法从诸如此类的异步操作中重新发送状态代码。
> 
> 202 响应是故意不置可否的。它的目的是允许服务器接受对其他进程的请求（可能是一个每天只运行一次的面向批处理的进程），而不需要用户代理与服务器的连接持续到进程完成。与此响应一起返回的实体应该包括请求当前状态的指示以及指向状态监视器的指针或用户可以期望何时完成请求的一些估计。

# android - 获取带有 Android Cordova 链接的 jQuery 以在浏览器中打开

> ID：14824970
> 
> 赞同：0
> 
> 时间：2013-02-12T03:36:02.250
> 
> 标签：android, jquery, cordova, hyperlink

我有一个 Android cordova 应用程序，我使用 jQuery Mobile 作为界面。基本上我试图让某些链接在浏览器窗口而不是cordovas childbrowser中打开。

我这里有一些代码，我认为应该可以工作，但我似乎无法调试。有人可以看看吗？

[http://t.co/kAJ7mrj5](http://t.co/kAJ7mrj5)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:53:02.157

虽然我不确定这是否是问题，但我看到了这个属性：

```
 onclick="navigator.app.loadUrl(http://forum.xda-developers.com/showthread.php?t=1703488", {openExternal: true}); 
```

我认为应该是：

```
 onclick="navigator.app.loadUrl('http://forum.xda-developers.com/showthread.php?t=1703488', {openExternal: true});" 
```

注意引号。

# java - Java 窗口控件

> ID：14824971
> 
> 赞同：0
> 
> 时间：2013-02-12T03:36:08.343
> 
> 标签：java, window, controls, reset

不知道该怎么说，但我已经创建了一个有效的二十一点游戏。庄家和用户有两张牌，你可以打或留，它工作正常。但是，一手牌结束后，我想显示一个窗口，说你想再玩一次。如果他们单击“是”，则游戏将重置。我已经创建了这个休息方法，但是我可以让它重置游戏所在的当前窗口的唯一方法是使用游戏中的重置按钮。有没有办法让弹窗重置游戏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:37:10.967

假设您已经编写了一个 Swing GUI（您没有说），我认为您想研究使用 JOptionPane 因为这将作为一个模式对话框打开，迫使用户在允许他与任何交互之前处理该对话框程序的其他部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T03:58:33.677

您可以使用 JOptionPane 并打开返回值。如果`YES_OPTION`，打电话`resetGame()`。否则，关闭游戏或采取适当的措施。

```
int choice = JOptionPane.showConfirmDialog(null, 
    "Would you like to play another game?", "New Hand", 
    JOptionPane.YES_NO_OPTION);

switch (choice) {
  case JOptionPane.YES_OPTION:
    resetGame();
    break;
  case JOptionPane.NO_OPTION;
    closeGame();
    break;
  case JOptionPane.CLOSE_OPTION;
    closeGame();
    break;
} 
```

# list - 比较两个列表项的 Haskell 函数

> ID：14824972
> 
> 赞同：0
> 
> 时间：2013-02-12T03:36:16.340
> 
> 标签：list, haskell, compare

我正在编写一个名为 myElems 的 Haskell 函数

它接受两个值列表，如果第一个列表中的所有值都在第二个列表中，则返回 true。例如，`myElems "db" "abcd"`应该返回`true`而`myElems [1,2] [0,1,3,4]`应该返回`false`。

`myElem`功能是这样的

```
myElem n [] = False
myElem n (x:xs) = if n == x then True else myElem n xs 
```

这个函数工作得很好，但是当我尝试将它应用到具有这种形式的 myElems 函数时

```
myElems xs [] = False
myElems [] ys = False
myElems (x:xs) (y:ys) = if myElem y xs /= myElem x ys then False else myElems (tail xs) (tail ys) 
```

它根本不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T03:43:38.227

你的意思是

```
myElems [] ys = True
myElems (x:xs) ys = if myElem x ys then myElems xs ys else False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T03:49:17.057

[我知道这不是确切的答案，但是Learn You Haskell](http://learnyouahaskell.com/modules)书推荐的内容怎么样：

```
import qualified Data.Set as Set  
Set.fromList [2,3,4] `Set.isSubsetOf` Set.fromList [1,2,3,4,5] 
```

# ruby - Ruby Factory Method rpsec 温度转换器

> ID：14824974
> 
> 赞同：0
> 
> 时间：2013-02-12T03:36:31.340
> 
> 标签：ruby

不太了解这里的工厂方法......这是respec行：

```
Temperature.from_celsius(50).in_celsius.should == 50 
```

这是我现在拥有的：

出错...不太确定如何满足这一点。谢谢

```
class Temperature
attr_accessor :f
attr_accessor :c   

   def initialize(args)
     @f = args[:f]
     @c = args[:c]
   end

  def in_fahrenheit
     @f or
    (@c*9.0/5.0)+32 
  end

  def in_celsius

   @c or
  (@f-32)*(5.0/9.0)
   end

   def self.from_celsius(c)
    new c
    end

   end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T03:45:26.250

这应该有帮助

```
class Temperature
  def initialize c
    @c = c
  end

  def in_celsius
    @c
  end

  def in_fahrenheit
    @c *9.0 /5.0 +32
  end

  # factory pattern typically instantiates a new object
  def self.from_celsius(c)
    new c
  end
end

puts Temperature.from_celsius(50).in_celsius      #=> 50
puts Temperature.from_celsius(100).in_fahrenheit  #=> 212 
```

除非您希望`attr_accessor :c`用户可以公开访问`temp.c`. 没有它，用户将被迫使用`temp.in_celsius`或`temp.in_fahrenheit`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T20:30:46.117

您收到“错误：无法将符号转换为整数 -”的原因是因为您在 Temperature.from_celsius(50) 中，当您应该向它传递一个键和符号时，您正在向它传递一个整数对于选项哈希。

*初始化*

```
class Temperature
  def initialize(opts = {})
    @options = opts
  end 
```

*类工厂方法*

```
def self.from_celsius(x)
    Temperature.new(:c => x)
end 
```

*实例方法*

```
def in_celsius
    if @options[:c] == nil
      return (@options[:f]-32) * (5/9.to_f)
    else
      return @options[:c]
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T03:45:11.973

您需要在初始化方法中分配给 :c 。然后你需要 self.from_celsius 返回一个新的温度实例。你可能想要这样的东西：

```
class Temperature
  attr_accessor :c
  def initialize c
    @c = c
  end

  def in_celsius
    @c
  end

  def in_fahrenheit
    9/5 * @c + 32
  end

  def self.from_celsius(num)
    Temperature.new(num)
  end

  def self.from_fahrenheit(num)
    Temperature.new((num-32)*5/9)
  end
end 
```

现在 rspec 显示为真

```
1.9.1p378 :047 > Temperature.from_celsius(50).in_celsius.should == 50
 => true 
1.9.1p378 :131 > Temperature.from_fahrenheit(32).in_celsius.should == 0
 => true 
```

# java - 使用 JAXB 是否可以生成超类型？

> ID：14824981
> 
> 赞同：0
> 
> 时间：2013-02-12T03:37:13.173
> 
> 标签：java, jaxb

这这可能吗？

所以如果我有 jaxb 课程

```
package com.example.client.jaxb.beans
AccountInfo.java
Contact.java 
```

我可以生成

```
package com.example.client.jaxb.beans
IApplicationBeans.java
AccountInfo.java implements IApplicationBeans
Contact.java implements IApplicationBeans 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:39:19.273

这是不可能的。jaxb 编译器希望尽可能地保持“像 bean 一样”。由于 bean 是 pojo，因此将它们放在继承结构中没有多大意义。

# asp.net - 引用空引用的模型视图

> ID：14824987
> 
> 赞同：0
> 
> 时间：2013-02-12T03:37:49.763
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4, views, model-view

我有一个包含多个模型的视图页面，我无法显示数据，但我可以很好地保存任何添加的数据。它只是在页面加载时显示数据告诉我我传入的模型传递了一个空引用。

主视图：

```
@model Project.Models.ProfileModel
@{
    ViewBag.Title = "Profile";
}

<hgroup class="title">
    <h1>@ViewBag.Title.</h1>
</hgroup>

<div id="wrap">
    <div id ="right">
        @(ViewBag.HasLocalPassword ? Html.Partial("_ChangePasswordPartial", Model.PasswordModel) : Html.Partial("_SetPasswordPartial", Model.PasswordModel))

    </div>
    <div id="left">
            @Html.Partial("_UsernamePartial", Model.UsernameModel)
            @Html.Partial("_PlayNamePartial", Model.PlayNameModel)

    </div>

</div> 
```

我的模型：

```
 public class ProfileModel
{
    public PasswordModel PasswordModel { get; set; }
    public PlayNameModel PlayNameModel { get; set; }
    public UsernameModel UsernameModel { get; set; }
} 
```

控制器 - 对于每个模型，我都有一个 get 和 post 方法，除了`PlayName`只有一个 GET。

用户名控制器：

```
public ActionResult _UsernamePartial()
    {
        var usernameModel = new UsernameModel();
        using (var db = new DataContext())
        {
            usernameModel.Username =
                (from u in db.Users where u.ID == WebSecurity.CurrentUserId select u.Username).FirstOrDefault();
        }
        return PartialView(usernameModel);
    } 
```

`@Html.Partial("_UsernamePartial", Model.UsernameModel)`显示`Object reference not set to an instance of an object.`，我不确定如何正确解决此问题。

```
public ActionResult Profile(ManageMessageId? message)
    {
        ViewBag.StatusMessage =
            message == ManageMessageId.ChangePasswordSuccess ? "Your password has been changed."
            : message == ManageMessageId.SetPasswordSuccess ? "Your password has been set."
            : message == ManageMessageId.RemoveLoginSuccess ? "The external login was removed."
            : "";
        ViewBag.HasLocalPassword = OAuthWebSecurity.HasLocalAccount(WebSecurity.GetUserId(User.Identity.Name));
        ViewBag.ReturnUrl = Url.Action("Profile");
        return View();
    } 
```

用户名发帖：

```
[HttpPost]
    public ActionResult _UsernamePartial(UsernameModel usernameModel)
    {
        if (ModelState.IsValid)
        {
            using (var db = new DataContext())
            {
                User user = db.Users.FirstOrDefault(u => u.ID == WebSecurity.CurrentUserId);
                user.Username = usernameModel.Username;
                db.SaveChanges();
            }
        }
        return View("_UsernamePartial");
    } 
```

用户名页面：

```
@model Acatar.Models.UsernameModel

@using (Html.BeginForm("_UsernamePartial", "Account")) {

       <p id="legend">Username</p>
       @Html.TextBoxFor(m=>m.Username)

    <button type="submit" value=" Username">Save</button>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T05:28:30.270

您的 Null Ref 是没有绑定模型的 View() Factory 调用的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:32:32.943

在类中使用此代码

```
public virtual PasswordModel PasswordModel1 
        {
            get {

                PasswordModel PasswordModel2 = this.PasswordModel.FirstOrDefault();

                if (PasswordModel2 == null)
                {
                    PasswordModel2 = new PasswordModel();

                }

                return PasswordModel2;
            }
        } 
```

在视图中使用此代码

```
@Html.Partial("_UsernamePartial", Model.UsernameModel, new ViewDataDictionary(Html.ViewDataContainer.ViewData)
 {
     TemplateInfo = new System.Web.Mvc.TemplateInfo { }
 }) 
```

对其他模型也这样做希望它会帮助你。

# c# - 按角色过滤用户

> ID：14824988
> 
> 赞同：0
> 
> 时间：2013-02-12T03:38:03.837
> 
> 标签：c#, asp.net-mvc, entity-framework, asp.net-mvc-4, entity-framework-5

我有一个带有标准帐户控制器的常规 MVC 应用程序。我在 UserProfile 类中添加了几个字段，所以现在看起来像这样：

```
 public class UserProfile
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int UserId { get; set; }
        public string UserName { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Email { get; set; }
        public string Address { get; set; }
        public string Phone { get; set; }
        public string FullName { get { return FirstName + " " + LastName; } }
        public int GroupId { get; set; }
        [ForeignKey("GroupId")]
        public ICollection<Group> Groups { get; set; }
        } 
```

所以，基本上说用户可以分配到多个组。（同样在 Group 类中，我说 Group 可以包含多个用户，显然）。

现在，每个用户都必须具有特定的角色。（管理员、教师、学生等）

我通过遵循这样的在线教程添加了角色支持：

```
<roleManager enabled="true" defaultProvider="SimpleRoleProvider">
      <providers>
        <clear/>
        <add name="SimpleRoleProvider" type="WebMatrix.WebData.SimpleRoleProvider, WebMatrix.WebData"/>
      </providers>
    </roleManager>
    <membership defaultProvider="SimpleMembershipProvider">
      <providers>
        <clear/>
        <add name="SimpleMembershipProvider" type="WebMatrix.WebData.SimpleMembershipProvider, WebMatrix.WebData" />
      </providers>
    </membership> 
```

现在我想按 RoleName 过滤所有用户。但我没有办法做到这一点。
IE。像这样的东西。`Users.Where(x=>x.RoleName=="Admin").Select(x=>x.FullName)`
（`Users`是 Group 类型的属性`ICollection<Users>`）。我如何在没有角色类的情况下获得角色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:16:48.687

asp.net 成员有一个带有 GetUsersInRole 方法的静态 Roles 类，HttpContext 中的 CurrentUser 也可以告诉您活动用户所在的角色。

[http://msdn.microsoft.com/en-us/library/system.web.security.roles.getusersinrole.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.roles.getusersinrole.aspx)

[http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T05:09:56.710

这是一个基于卢克建议的例子。

您的 UsersContext 类构造函数应如下所示：

```
 public class UsersContext : DbContext
    {
        public UsersContext()
            : base("DefaultConnection")
        {
        }

        public DbSet<UserProfile> UserProfiles { get; set; }
        public DbSet<RoleModel> Roles { get; set; }
        public DbSet<UsersInRole> UsersInRoles { get; set; }
    } 
```

请注意，我添加了两个额外的 DbSet。这些已经在会员数据库中，这只是我们映射它们的方式。

“RoleModel”和“UsersInRole”模型声明如下：

```
 [Table("webpages_Roles")]
public class RoleModel
{
    [Key]
    public int RoleId { get; set; }
    public string RoleName { get; set; }
}

[Table("webpages_UsersInRoles")]
public class UsersInRole
{
    [Key, Column(Order=0)]
    public int UserId { get; set; }
    public virtual UserProfile User { get; set; }

    [Key, Column(Order = 1)]
    public int RoleId { get; set; }
    public RoleModel Role { get; set; }
} 
```

之后，您可以向您的 UserProfile 模型添加一个新的导航属性，如下所示：

```
[Table("UserProfile")]
public class UserProfile
{
   [Key]
   [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
   public int UserId { get; set; }
   public string UserName { get; set; }
   public virtual ICollection<UsersInRole> UsersInRole { get; set; }
} 
```

然后用类似这样的方式调用它：

```
var context = new UsersContext();
context.UserProfiles.First(d => d.UserName == "username").UsersInRole.Select(d => d.Role); 
```

但老实说，可能使用 @awright18 提到的 GetUsersInRole 方法更容易。

# python - 如何向 Tkinter 文本框小部件添加滚动条

> ID：14824992
> 
> 赞同：0
> 
> 时间：2013-02-12T03:38:48.757
> 
> 标签：python, tkinter, scrollbar

我最近重新访问了我的一个较旧的 GUI 项目，并决定它的文本小部件需要一个垂直滚动条，因为输出通常很长。我自己找不到这个，想知道是否可以得到一些帮助。这是必要的代码：

```
from Tkinter import *

class Application(Frame):
    def __init__(self,master):
        Frame.__init__(self,master)
        self.grid()
        self.widget()
    def widget(self):
        self.results_plain_label = Label(self,
                                         text = "Deciphered Message")
        self.results_plain_label.grid(row = 13, column =5, pady = 5 )
        self.results_plain_text = Text (self, width = 100, height = 6,
        wrap = WORD, font ("Times New Roman", ))
        self.results_plain_text.grid(row = 14, column = 5, pady = 5, sticky = W)

Mainloop initialization stuff 
```

那么，我将如何`scroll-bar`在`results_plain_text`文本框中添加一个？

# jasper-reports - 如何在 iReport 3.0.0 中显示一个空表？

> ID：14824995
> 
> 赞同：0
> 
> 时间：2013-02-12T03:39:03.807
> 
> 标签：jasper-reports, ireport

我正在修改一个现有的 iReport 文件，据说该文件要求程序输入。然后将输入放在一个表中，我假设它会在数据进入时自动添加行。

但是，该程序不会发布数据，并且不再需要这样做。所以现在我只需要显示一个空表。

我在 iReport 中所做的是删除所有参数痕迹（因为不再需要它们，然后复制并粘贴所有单元格，直到它们到达页面底部。现在没有单元格（除了标题和顶部）行，因为它们有静态文本）是可见的，其中一份报告甚至显示了一个空白页。

我尝试将报告属性：无数据时：设置为无数据部分或所有部分 - 无详细信息，但它仍然是空的，没有可见的单元格。我还尝试在文本字段中放置一个空格，希望它会显示，甚至用矩形替换它们（这在另一个报告中有效）。但是，没有任何效果。报告仍然只显示标题。

我怎样才能解决这个问题？谢谢。

这是JRXML：

```
<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
         name="ApprenticeEmployment1"
         columnCount="1"
         printOrder="Vertical"
         orientation="Landscape"
         pageWidth="1008"
         pageHeight="612"
         columnWidth="948"
         columnSpacing="0"
         leftMargin="30"
         rightMargin="30"
         topMargin="20"
         bottomMargin="20"
         whenNoDataType="AllSectionsNoDetail"
         isTitleNewPage="false"
         isSummaryNewPage="false">
    <property name="ireport.scriptlethandling" value="0" />
    <property name="ireport.encoding" value="UTF-8" />
    <import value="java.util.*" />
    <import value="net.sf.jasperreports.engine.*" />
    <import value="net.sf.jasperreports.engine.data.*" />

    <parameter name="imagedir" isForPrompting="false" class="java.lang.String"/>

    <field name="REGION" class="java.lang.String"/>
    <field name="PROVINCE" class="java.lang.String"/>
    <field name="FULL_QUALIFICATION" class="java.lang.String"/>
    <field name="DELIVERY" class="java.lang.String"/>
    <field name="SECTOR" class="java.lang.String"/>
    <field name="STUDENT_ID" class="java.lang.String"/>
    <field name="LAST_NAME" class="java.lang.String"/>
    <field name="FIRST_NAME" class="java.lang.String"/>
    <field name="MI" class="java.lang.String"/>
    <field name="CONTACT_NUMBER" class="java.lang.String"/>
    <field name="E_MAIL" class="java.lang.String"/>
    <field name="STREET" class="java.lang.String"/>
    <field name="BARANGAY" class="java.lang.String"/>
    <field name="CITY" class="java.lang.String"/>
    <field name="SEX" class="java.lang.String"/>
    <field name="DOB" class="java.lang.String"/>
    <field name="AGE" class="java.math.BigDecimal"/>
    <field name="CIVIL_STAT" class="java.lang.String"/>
    <field name="EDUC_LEVEL" class="java.lang.String"/>
    <field name="DATE_STARTED" class="java.lang.String"/>
    <field name="DATE_FINISHED" class="java.lang.String"/>
    <field name="REMARKS" class="java.lang.String"/>

        <background>
            <band height="0"  isSplitAllowed="true" >
            </band>
        </background>
        <title>
            <band height="51"  isSplitAllowed="true" >
                <staticText>
                    <reportElement
                        x="0"
                        y="30"
                        width="948"
                        height="21"
                        key="staticText-1"/>
                    <box></box>
                    <textElement textAlignment="Center" verticalAlignment="Bottom">
                        <font pdfFontName="Helvetica-Bold" isBold="true"/>
                    </textElement>
                <text><![CDATA[Apprentice Report Form]]></text>
                </staticText>
                <image  hAlign="Center" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                    <reportElement
                        x="238"
                        y="0"
                        width="470"
                        height="37"
                        key="image-1"/>
                    <box></box>
                    <graphicElement stretchType="NoStretch"/>
                    <imageExpression class="java.lang.String"><![CDATA[$P{imagedir}+"goldilocks-small.JPG"]]></imageExpression>
                </image>
            </band>
        </title>
        <pageHeader>
            <band height="0"  isSplitAllowed="true" >
            </band>
        </pageHeader>
        <columnHeader>
            <band height="65"  isSplitAllowed="true" >
                <staticText>
                    <reportElement
                        x="0"
                        y="18"
                        width="34"
                        height="31"
                        key="staticText-3"/>
                    <box>                   <topPen lineWidth="0.25"/>
                    <leftPen lineWidth="0.25"/>
                    <bottomPen lineWidth="0.25"/>
                    <rightPen lineWidth="0.25"/>
</box>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font/>
                    </textElement>
                <text><![CDATA[Sex]]></text>
                </staticText>
                <staticText>
                    <reportElement
                        x="271"
                        y="18"
                        width="58"
                        height="31"
                        key="staticText-4"/>
                    <box>                   <topPen lineWidth="0.25"/>
                    <leftPen lineWidth="0.25"/>
                    <bottomPen lineWidth="0.25"/>
                    <rightPen lineWidth="0.25"/>
</box>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font/>
                    </textElement>
                <text><![CDATA[Scholarship]]></text>
                </staticText>
                <staticText>
                    <reportElement
                        x="453"
                        y="18"
                        width="42"
                        height="31"
                        key="staticText-5"/>
                    <box>                   <topPen lineWidth="0.25"/>
                    <leftPen lineWidth="0.25"/>
                    <bottomPen lineWidth="0.25"/>
                    <rightPen lineWidth="0.25"/>
</box>
                    <textElement textAlignment="Center" verticalAlignment="Middle">
                        <font/>
                    </textElement>
                <text><![CDATA[Client Type
]]></text>
                </staticText>
                <staticText>
                    <reportElement
                        x="0"
                        y="1"
                        width="741"
                        height="17"
                        key="staticText-6"/>
            </band>
        </columnHeader>
        <detail>
            <band height="456"  isSplitAllowed="true" >
                <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                    <reportElement
                        x="0"
                        y="432"
                        width="34"
                        height="18"
                        key="textField-378"
                        stretchType="RelativeToTallestObject"
                        positionType="Float"/>
                    <textElement verticalAlignment="Middle">
                        <font size="8"/>
                    </textElement>
                <textFieldExpression   class="java.lang.String"><![CDATA[]]></textFieldExpression>
                </textField>
                <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                    <reportElement
                        x="0"
                        y="72"
                        width="34"
                        height="18"
                        key="textField-458"
                        stretchType="RelativeToTallestObject"
                        positionType="Float"/>
                    <textElement verticalAlignment="Middle">
                        <font size="8"/>
                    </textElement>
                <textFieldExpression   class="java.lang.String"><![CDATA[]]></textFieldExpression>
                </textField>
            </band>
        </detail>
        <columnFooter>
            <band height="0"  isSplitAllowed="true" >
            </band>
        </columnFooter>
        <pageFooter>
            <band height="0"  isSplitAllowed="true" >
            </band>
        </pageFooter>
        <summary>
            <band height="0"  isSplitAllowed="true" >
            </band>
        </summary>
</jasperReport> 
```

不过，我确实编辑了很多“框”，所以如果格式错误，那是我的问题，而不是 JRXML 本身。

问候， Zack_Falcon

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-08T15:14:30.550

要创建一个包含 N 条空记录的表，即使您没有数据。

1.  创建对象表
2.  将您的 DataSEt 附加到此表或使用空数据源
3.  在“报告检查器”中选择您的表格，然后单击右键
4.  选择：“编辑表数据源”
5.  在你写的窗口中：`new net.sf.jasperreports.engine.JREmptyDataSource(44)`
6.  运行您的报告

`44`是显示空记录的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T11:15:30.283

在表格属性中，在表格部分下选择“所有部分，无详细信息”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T07:54:30.867

你可以试试这个条件

```
$P{Parameter}==null ? "All" : $P{Parameter} 
```

如果您不选择任何输入值，此条件将为您提供所有文本。

# python - pygame - 粒子效果

> ID：14824996
> 
> 赞同：3
> 
> 时间：2013-02-12T03:39:09.517
> 
> 标签：python, 2d, pygame, particles

我正在使用 Pygame 制作二维游戏。
我想在我正在开发的游戏中添加粒子效果。我想做一些事情，比如产生烟雾、火、血等。我很好奇有没有简单的方法来做到这一点？我什至不知道从哪里开始。
我只需要一个可以扩展的基本案例..
请帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T15:15:53.603

您可能只想创建一个由 rect 组成的类，每次更新烟雾时，该类会向上并随机向右或向左移动。然后随时制作大量它们。我将尝试在下面制作一个示例代码，但我不能保证它会起作用。您可以为其他粒子效果创建类似的类。

```
class classsmoke(pygame.Rect):
    'classsmoke(location)'
    def __init__(self, location):
        self.width=1
        self.height=1
        self.center=location
    def update(self):
        self.centery-=3#You might want to increase or decrease this
        self.centerx+=random.randint(-2, 2)#You might want to raise or lower this as well

#use this to create smoke
smoke=[]
for i in range(20):
    smoke.append(classsmoke(insert location here))
#put this somewhere within your game loop
for i in smoke:
    i.update()
    if i.centery<0:
        smoke.remove(i)
    else:
        pygame.draw.rect(screen, GREY, i) 
```

另一种选择是使类只是一个元组，如下所示：

```
class classsmoke():
    'classsmoke(location)'
    def __init__(self, location):
        self.center=location
    def update(self):
        self.center[1]-=3
        self.center[0]+=random.randint(-2, 2)

#to create smoke
smoke=[]
for i in range(20):
    smoke.append(classsmoke(insert location here))
#put inside game loop
for i in smoke:
    i.update()
    if i.centery<0:
        smoke.remove(i)
    else:
        pygame.draw.rect(screen, GREY, (i.center[0], i.center[1], 1, 1)) 
```

或者，要完全避免上课：

```
#to create smoke:
smoke=[]
for i in range(20):
    smoke.append(insert location here)
#put within your game loop
for i in smoke:
    i[1]-=3
    i[0]+=random.randint(-2, 2)
    if i[1]<0:
        smoke.remove(i)
    else:
        pygame.draw.rect(screen, GREY, (i[0], i[1], 1, 1)) 
```

选择您的偏好，并为其他粒子效果做类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:39:59.880

检查库中的粒子效果[PyIgnition](http://www.pygame.org/project-PyIgnition-1527-.html)

![http://www.pygame.org/shots/1527.jpg](../Images/c986e23e473e70e40cf7e09942e96be1.png)