# StackOverflow 问答 13635000-13635999

# python - 合并列表中的项目

> ID：13635000
> 
> 赞同：3
> 
> 时间：2012-11-29T21:24:39.623
> 
> 标签：python, sorting, dictionary

Python3：

```
dct = {'Mazda': [['Ford', 95], ['Toyota', 20], ['Chrysler', 52], ['Toyota', 5], ['Toyota', 26]]} 
```

我有上面的字典，其中的值是列表中的列表。我想做的是组合列表中相同的项目并将整数添加到该值。

例如。因为丰田在那里 3x 然后将所有数字组合在一起给我另一个列表

```
[Toyota, 51] 
```

最终结果应该是不需要按这个顺序

```
dct = {'Mazda': [['Ford', 95], ['Toyota', 51], ['Chrysler', 52]]} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:35:11.590

对于问题中的输入：

```
dct = {'Mazda': [['Ford', 95],  ['Toyota', 20], ['Chrysler', 52],
                 ['Toyota', 5], ['Toyota', 26]]} 
```

尝试这个：

```
from collections import defaultdict

for k, v in dct.items():
    aux = defaultdict(int)
    for car, num in v:
        aux[car] += num
    dct[k] = map(list, aux.items()) 
```

现在`dct`包含预期的结果：

```
dct
=> {'Mazda': [['Ford', 95], ['Toyota', 51], ['Chrysler', 52]]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:29:18.133

存储两个列表：一个包含汽车名称，一个包含数字。遍历字典中的列表，如果汽车不存在，则在每个列表中添加一个新元素，否则将数字添加到汽车索引中。最后，`zip()`这两个列表在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T21:35:26.000

```
dct = {'Mazda': [['Ford', 95], ['Toyota', 20], ['Chrysler', 52], ['Toyota', 5], ['Toyota', 26]]}

newdct = {}
for item in dct:
    newdct[item] = []
    unqItems = {}
    for val in dct[item]:
        if val[0] not in unqItems:
            unqItems[val[0]] = 0
        unqItems[val[0]] += val[1]
    for u in unqItems:
        newdct[item].append([u, unqItems[u]])
print newdct 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T21:36:26.537

使用`itertools.groupby()`：

```
In [66]: dct = {'Mazda': [['Ford', 95], ['Toyota', 20], ['Chrysler', 52], ['Toyota', 5], ['Toyota', 26]]}

In [67]: from itertools import groupby

In [68]: from operator import *

In [69]: dct = {'Mazda': [['Ford', 95], ['Toyota', 20], ['Chrysler', 52], ['Toyota', 5], ['Toyota', 26]]}

In [70]: { x: [[k,sum(y[1] for y in g)] for k,g in groupby(sorted(dct[x]),
                                              key=itemgetter(0))] for x in dct}

Out[70]: {'Mazda': [['Chrysler', 52], ['Ford', 95], ['Toyota', 51]]} 
```

# javascript - 区分 JavaScript 中的正则表达式解析异常

> ID：13635005
> 
> 赞同：7
> 
> 时间：2012-11-29T21:25:03.037
> 
> 标签：javascript, regex

我正在编写一个允许用户指定正则表达式的应用程序。当然，用户会犯错误，所以我需要一种方法来处理无法解析的正则表达式，并就如何解决问题给用户一些可行的建议。

我遇到的问题是抛出的异常`new RegExp("something awful")`对正则表达式 n00bs 没有帮助，并且每个浏览器都有不同的消息。例如：

鉴于：

```
try{
    new RegExp("(pie");
}catch(e){
    console.log(e.message);
} 
```

*   Firefox 抛出“未终止的括号”。
*   Safari 抛出“丢失 )”
*   Chrome 抛出“未终止组”

如果这些消息字符串是用户语言本地化的，或者它们随着时间的推移而漂移，这不会让我感到惊讶，这使得与 exception.message 解开这个结是一个疯狂的结。

我的目标是捕捉异常，弄清楚它的真正含义，并提出对初学者更友好的信息。（在本例中，最终突出显示不匹配的括号。）

我应该使用其他一些异常标识符吗？有没有更好的方法来区分这些？如果这一切都失败了，是否有人刚刚收集了几个最流行的浏览器中的所有这些字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:37:04.993

想法：在运行时把它全部弄清楚。例如

```
var tellMeWhatIDidWrong = (function() {

    var tests = {
        '(': 'You did not close your group... duh!',
        ')': 'You seem to have an unmatched parenthesis.',
        '*': 'That token is illegal in that position'
    };

    var errors = {};

    for (var i in tests) {
        try { RegExp(i); } catch(e) { 
            errors[String(e).split(':').pop()] = tests[i];
        }
    }

    return function(regexStr) {
        try { RegExp(regexStr); } catch(e) {
            e = String(e).split(':').pop();
            if (e in errors) {
                return errors[e];
            }
            return 'Unknown error';
        }
        return 'Nothing -- it is fine!';
    };

}());

tellMeWhatIDidWrong('(abc?'); // -> "You did not close your group... duh!" 
```

当然，这只有在浏览器的内置错误报告足够具体时才会有效。他们中的许多人都很糟糕。例如，Opera 完全没有给出关于该问题的任何提示，因此上述方法无法正常工作，任何其他依赖 Opera 原生错误消息的解决方案也不会。

我建议将正则表达式发送到运行 node.js 的应用程序并获得漂亮的 V8 错误消息 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:05:58.670

根据我的评论，我编写了一个小脚本来“收集”可能的错误消息和导致它们的模式。

[JSFiddle](http://jsfiddle.net/7fYTr/1/)（仅在 Chrome 上尝试过，~~我希望 RegExp 异常对象对其他浏览器具有相同的结构~~）

这个想法是这样的：你有一个工作正则表达式，它使用尽可能多的正则表达式特性。然后你随机改变它（添加、删除或换出字符）并尝试编译它。您可以这样做几千次，并收集所有错误消息。希望机会比我们任何人都更善于提出可能的畸形模式。

您绝对应该改进基本模式，以包含JavaScript 提供的**所有**正则表达式功能，并在替换表中包含**所有元字符。**但除此之外，我似乎一直收到 6 条可能的错误消息：

```
Unterminated group
Invalid group    
Nothing to repeat
Unmatched ')'
Unterminated character class
\ at end of pattern 
```

尝试在不同的浏览器中运行这个脚本，分析导致错误的模式，然后你应该能够编写你的工具。

**编辑：**

好的，因为我担心这在其他开箱即用的浏览器中不起作用，因为它们将实际消息存储在异常对象内的其他地方。但是从你的问题来看，你似乎已经想通了，从哪里获取每个浏览器的消息，所以你需要做的改变应该很小，我希望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:46:41.220

使用 PEG.js 或 JISON 创建正则表达式解析器。您将能够获得特定且一致的错误。

这个文件有一个正则表达式的 YACC 语法：http: [//swtch.com/usr/local/plan9/src/cmd/grep/grep.y](http://swtch.com/usr/local/plan9/src/cmd/grep/grep.y)；将它与 JISON 一起使用可能不会太难。

PERL 正则表达式的 BNF 语法：[http ://www.cs.sfu.ca/~cameron/Teaching/384/99-3/regexp-plg.html](http://www.cs.sfu.ca/~cameron/Teaching/384/99-3/regexp-plg.html)

# remote-debugging - Weblogic Fastswap 和远程调试

> ID：13635011
> 
> 赞同：2
> 
> 时间：2012-11-29T21:25:09.803
> 
> 标签：remote-debugging, hotswap

当我在 weblogic.xml 中启用快速交换时，我能够部署我的爆炸式战争，但无法从 Eclipse 进行远程调试。有人遇到过这个问题吗？请分享你的想法。

# orchardcms - 根据正在创建的另一个 ContentItem 创建一个 ContentItem？

> ID：13635017
> 
> 赞同：0
> 
> 时间：2012-11-29T21:25:36.343
> 
> 标签：orchardcms

问题是，每次创建 ContentItem 时，我都想创建它的本地化版本。本地化版本应该与原始版本相同，但我将进行一些本地化。因此，基本上，每当我创建指定类型的 ContentItem 时，我都会对其进行复制并进行本地化更改，将原始 ContentItem 标记为本地化 ContentItem 的 LocalizationPart.MasterContentItem，然后保留该项目。

最初，当调用 IContentHandler.Created 方法时，我尝试创建原始项目的副本。问题是控制器还没有“尝试更新”项目，所以它缺少数据。我似乎无权访问控制器，以便尝试手动更新项目。

我也等不及控制器 TryUpdate() ContentItem，然后通过其他一些 IContentHandler 方法访问已经更新的 Item，因为在此之前调用了它们。

此外，持久化新创建的 ContentItem 是它在 WorkContext 中完成的最后一件可能的事情，因此在请求线程非常死之前我无法查询数据库。

因此，任何关于如何复制正在创建的 ContentItem 并将副本作为另一个项目保存的见解都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:54:47.873

我能够通过 IContentHandler.Published 方法访问更新的 ContentItem。这里的不便之处在于，在 ContentItem 为“已发布”之前不会调用该方法。不过，在我的场景中，这并不是真正的问题，因为我将不显示它们（原始的 ContenItem 和本地化的 ContentItem）或两者都显示。

# php - PHPSecLib 受密码保护的 RSA 和用户身份验证

> ID：13635018
> 
> 赞同：2
> 
> 时间：2012-11-29T21:25:51.907
> 
> 标签：php, ssh, rsa, sftp, phpseclib

我正在尝试使用 PHPSecLib 通过 PHP 中的 SFTP 连接到 SSH2 服务器。但我的问题是，服务器需要一个受密码保护的密钥文件，还需要用户名和密码。似乎只能提供用户名+密码或用户名+密钥文件（可选密码保护）。

我怎样才能使用所有这些东西登录？

[http://phpseclib.sourceforge.net/](http://phpseclib.sourceforge.net/)

我的代码看起来像

```
$key = new Crypt_RSA();
$key->setPassword('keypwd');
$key->loadKey(file_get_contents('ssh_file.ppk'));

$sftp = new Net_SFTP('hostname', 22);

if (!$sftp->login('username', $key))
  echo 'Failed';
else
  echo 'Success'; 
```

但是我应该把“密码”放在哪里？

-- 编辑：服务器只需要 RSA 密钥，但不知何故，密钥未正确加载

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T22:05:06.533

有一个示例指定如何[在 phpseclib 网站上](http://phpseclib.sourceforge.net/ssh/examples.html#encrsakey)加载受密码保护的密钥文件。注意线`$key->setPassword('whatever');`

```
<?php
include('Net/SSH2.php');
include('Crypt/RSA.php');

$ssh = new Net_SSH2('www.domain.tld');
$key = new Crypt_RSA();
$key->setPassword('whatever');
$key->loadKey(file_get_contents('privatekey'));
if (!$ssh->login('username', $key)) {
    exit('Login Failed');
}

echo $ssh->exec('pwd');
echo $ssh->exec('ls -la'); 
```

请记住，您不会将密码发送到服务器。您只需要密码即可成功加载密钥文件。然后将用户名和密钥发送到服务器以对您进行身份验证。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T23:10:49.133

无法解决，因为脚本需要 RSA 并且密钥是 DSA

# php - 子表中的外键如何自动获取它在父表中的实际值

> ID：13635026
> 
> 赞同：0
> 
> 时间：2012-11-29T21:26:14.093
> 
> 标签：php, mysql

任何人都可以判断子表中的外键是否可以自动获取它在父表中实际具有的值？我有两个表学生和课程表。学生 SSC 是课程中的外键。我将数据正确插入到学生表中。但是当我将数据插入课程表时它给了我一个错误？有什么建议吗？变量的值是通过表单的 post 方法获得的。

```
$query1=mysql_query("INSERT INTO course VALUES('','$subject','$total','$attendce','$ssn')")or die(mysql_error()); 
```

这是我得到的错误....

> 无法添加或更新子行：外键约束失败（`cast_db`.`course`, CONSTRAINT `course_ibfk_1` FOREIGN KEY (`cnic`) REFERENCES `student` (`cnic`) ON DELETE CASCADE ON UPDATE CASCADE）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:31:44.550

That's not how foreign keys work. You have to create a parent record first, get that record's ID (whatever the primary key happens to be) value, and then use that value in your child record insertions.

Remember - a parent table can have MANY records. There is no way for a database to know which of those records is the parent of a new child record. You **HAVE** to explicitly say that "this new child record has parent X".

# windows-phone-8 - 如何在运行时从后台代理检测 WP8 分辨率

> ID：13635027
> 
> 赞同：1
> 
> 时间：2012-11-29T21:26:18.780
> 
> 标签：windows-phone-8

也许它就在我的鼻子底下，但我找不到。当它来自后台代理时，如何在运行时检测 WP8 分辨率？

有 MSDN 多分辨率文章提供了一种方法，但它使用 App 对象：

```
App.Current.Host.Content.ScaleFactor 
```

我认为这个对象在后台代理中不可用。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T06:58:23.063

我认为在后台代理中不可能，但是您可以在首次启动应用程序时检测分辨率并将其存储在**IsolatedStorageSettings.ApplicationSettings**中。然后您可以在后台代理中使用这些值。

# python - python中zip的反函数是什么？

> ID：13635032
> 
> 赞同：209
> 
> 时间：2012-11-29T21:26:25.347
> 
> 标签：python, list, numpy, tuples

> **可能重复：**
> [Python 中的转置/解压缩函数](https://stackoverflow.com/questions/19339/a-transpose-unzip-function-in-python)

我使用 numpy 库中的 zip() 函数对元组进行排序，现在我有一个包含所有元组的列表。从那以后我修改了那个列表，现在我想恢复元组，这样我就可以使用我的数据了。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：413
> 
> 时间：2012-11-29T21:28:51.800

```
lst1, lst2 = zip(*zipped_list) 
```

应该给你解压缩的列表。

`*zipped_list`解压缩 zipped_list 对象。然后它将所有元组从 zipped_list 对象传递给 zip，它只是将它们打包回来，就像你传入它们时一样。

因此，如果：

```
a = [1,2,3]
b = [4,5,6] 
```

然后`zipped_list = zip(a,b)`给你：

```
[(1,4), (2,5), (3,6)] 
```

还给`*zipped_list`你

```
(1,4), (2,5), (3,6) 
```

压缩它`zip(*zipped_list)`会给你两个集合：

```
[(1, 2, 3), (4, 5, 6)] 
```

# c# - 以编程方式登录 FOPE

> ID：13635034
> 
> 赞同：0
> 
> 时间：2012-11-29T21:26:31.067
> 
> 标签：c#, .net, httpwebrequest, webclient

> **可能重复：**
> [如何在 HttpWebRequest 中使用 cookie](https://stackoverflow.com/questions/2972643/how-to-use-cookies-with-httpwebrequest)

我一直在尝试登录 FOPE 并在另一个线程中查询结果（[自动化 Microsoft FOPE（Forefront Online Protection for Exchange）搜索](https://stackoverflow.com/questions/13165432/automating-microsoft-fope-forefront-online-protection-for-exchange-searches)）。

我终于使用 WPF Webbrowser 控件实现了它。可悲的是，这是一种非常混乱的方式，而且由于多线程或任何类似的事情都是不可能的，因此速度肯定非常慢。所以现在我希望能够将其转换为 HttpWebRequest / HttpWebResponse 或 WebClient （尽管我不确定它的多线程部分）设置。

逻辑流程如下：

1.  **认证**
2.  检索每个子域的页面
3.  提取HREF
4.  取回
5.  详细资料
6.  解析详细信息
7.  返回 CSV

粗体验证是我唯一苦苦挣扎的部分。我的 WebFu 很弱，所以试图破译我在 FireBug 中看到的东西充其量是可笑的。它似乎确实使用了 FedAuth cookie，但这与我能够破译的一样多。

所以基本上，如果我想在网络浏览器中获得第 2 步，我会转到[这个链接](https://admin.messaging.microsoft.com/TraceMessage.mvc/AsyncMessageList/123456?s=me@example1.org&r=sub.example.com&d=10/31/2012%204:16:48%20PM&e=11/29/2012%204:16:48%20PM&a=-5)。它会将我重定向[到此](https://sts.messaging.microsoft.com/login.aspx?ReturnUrl=/Default.aspx?wa=wsignin1.0&wtrealm=https%253a%252f%252fadmin.messaging.microsoft.com&wctx=rm%253d0%2526id%253dpassive%2526ru%253d%25252fTraceMessage.mvc%25252fAsyncMessageList%25252f123456%25253fs%25253dme%252540example1.org%252526r%25253dsub.example.com%252526d%25253d10%25252f31%25252f2012%252525204%25253a16%25253a48%25252520PM%252526e%25253d11%25252f29%25252f2012%252525204%25253a16%25253a48%25252520PM%252526a%25253d-5&wct=2012-11-29T21%253a18%253a30Z&wa=wsignin1.0&wtrealm=https://admin.messaging.microsoft.com&wctx=rm=0&id=passive&ru=%252fTraceMessage.mvc%252fAsyncMessageList%252f123456%253fs%253dme%2540example1.org%2526r%253dsub.example.com%2526d%253d10%252f31%252f2012%2525204%253a16%253a48%252520PM%2526e%253d11%252f29%252f2012%2525204%253a16%253a48%252520PM%2526a%253d-5&wct=2012-11-29T21:18:30Z)处以登录。

在 Web 浏览器中进行身份验证后，它会加载第 2 步页面，我可以继续。谁能帮我弄清楚如何在不使用 Web 浏览器（或类似浏览器）的情况下登录。我在这里使用 HttpWebRequest 尝试了各种示例，但没有一个成功。

**更新#1**

有人要求我发布一些示例代码，所以我有。这不是我尝试过的唯一样本，但看起来它可能有机会。

```
 string email = "username";
        string password = "password";

        HttpWebRequest request;
        HttpWebResponse response;
        CookieContainer cookies;

        string url = string.Format("https://sts.messaging.microsoft.com/login.aspx?ReturnUrl=%2fDefault.aspx%3fwa%3dwsignin1.0%26wtrealm%3dhttps%253a%252f%252fadmin.messaging.microsoft.com%26wctx%3drm%253d0%2526id%253dpassive%2526ru%253d%25252f%26wct%3d2012-11-30T20%253a22%253a41Z&wa=wsignin1.0&wtrealm=https%3a%2f%2fadmin.messaging.microsoft.com&wctx=rm%3d0%26id%3dpassive%26ru%3d%252f&wct=2012-11-30T20%3a22%3a41Z&email={0}&Password={1}", email, password);
        request = (HttpWebRequest)WebRequest.Create(url);
        request.AllowAutoRedirect = true;
        request.CookieContainer = new CookieContainer();
        response = (HttpWebResponse)request.GetResponse();
        //if (response.StatusCode != HttpStatusCode.Found)
        //{
        //    MessageBox.Show("Something Wrong");
        //    response.Close();
        //    request.KeepAlive = false;
        //    return;
        //}
        cookies = request.CookieContainer;
        response.Close();
        request = (HttpWebRequest)WebRequest.Create("https://admin.messaging.microsoft.com/TraceMessage.mvc/Details/123456?rid=1234567890&d=destDomain.com&p=username&a=-5");
        request.AllowAutoRedirect = true;
        request.CookieContainer = cookies;
        response = (HttpWebResponse)request.GetResponse();

        using (Stream s = response.GetResponseStream())
        {
            StreamReader sr = new StreamReader(s);
            string line;
            while (!sr.EndOfStream)
            {

            }
        } 
```

# ruby-on-rails - 继续搜索直到达到限制

> ID：13635035
> 
> 赞同：1
> 
> 时间：2012-11-29T21:26:38.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3, search, ruby-on-rails-3.2

我有一个搜索，可以找到所有 3 个匹配类别、所有 2 个类别和所有 1 个类别，如下所示。

```
def self.three_matching_cat(rel)
  cats = rel.prefs.map {|p| p.category_id}
  self.where(:category_id => cats).group(:name).having("count(*) >2").map {|p| p.name}    
end 
```

我想要做的是将结果总数限制为 10，但要确保返回具有 3 个匹配类别的所有结果，并且只继续搜索，直到找到总共 10 个结果。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T20:10:37.647

所以我最终做的只是将所有数组相加，然后对其进行切片。IE：

```
(a + b + c)[0,10].uniq 
```

# ruby-on-rails - 如何在视图中的表单字段上实现弹出框（bootstrap-saas）

> ID：13635037
> 
> 赞同：0
> 
> 时间：2012-11-29T21:26:42.940
> 
> 标签：ruby-on-rails

我正在尝试使用`bootstrap-saas`gem 在 Rails 视图中的表单字段上实现弹出框。

```
<%= form_for(@user, :html => { :class => "form-horizontal" }) do |f| %>

  <div class="control-group">
<%= f.label :fname, "First Name", :class => "control-label" %>

    <div class="controls">
  <%= f.text_field :fname, class: "input-large", rel: "popover", :"data-content"=>"Enter First Name" %>
</div>

  </div>

<% end %> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T01:11:03.437

**在 assets/javascript/ custom.js**上创建一个新的 js 文件

 **```
$(document).ready(function(){
  $(".popover-input").popover();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:47:47.353

您需要打开弹出框。最常见的方法是给 popover 一个类，并使用 JS（我的示例将使用 jQuery）来打开它。

```
# view
# ...
<%= f.text_field :fname, class: "input-large popover-input", rel: "popover", :"data-content"=>"Enter First Name" %> 
```

（注意额外的类名`popover-input`。随便你怎么称呼它。）

```
# JS
# ...
$(".popover-input").popover(); 
```

瞧！

Popovers的[Bootstrap 页面](http://twitter.github.com/bootstrap/javascript.html#popovers)显示了可用于 popovers 的其他选项。**

# xslt - 如何在 XLST 的逗号分隔列表中提取特定值并将该值与另一个值进行比较？

> ID：13635041
> 
> 赞同：0
> 
> 时间：2012-11-29T21:27:02.270
> 
> 标签：xslt

我是 XSLT 的新手，并且对 XSLT 中的换行符有类似的要求以[获取逗号分隔值，](https://stackoverflow.com/questions/5121534/line-break-in-xslt-for-a-comma-separated-value)但是我需要执行以下操作

1.  检查该值是否为单个字符串，例如 Apples，或者是否为逗号分隔列表，例如 Apples、Pears 等
2.  如果它是逗号分隔列表，则检查列表是否具有特定值或值
3.  如果值存在，那么做一些事情
4.  如果它是单个字符串，例如 Apple 然后做一些事情

XSLT 2.0 如何实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T00:32:10.907

您可以标记列表。像这样的函数可能会完成这项工作（为了演示目的，嵌入到工作 XSLT 中）：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:my="NS:MY">
  <xsl:function name="my:test">
    <xsl:param name="string"/>
    <xsl:variable name="tokens" select="tokenize(normalize-space($string),'\s*,\s*')"/>
    <xsl:choose>
      <xsl:when test="normalize-space($string)='Apples'">
        Do something where we have a single "Apples" 
      </xsl:when>
      <xsl:when test="normalize-space($string)='Pears'"> 
        Do something where we have a single "Pears" 
      </xsl:when>
      <xsl:when test="$tokens='Apples' and $tokens='Pears'"> 
        There are Apples and Pears 
      </xsl:when>
      <xsl:when test="$tokens='Apples'"> 
        There are Apples in the list 
      </xsl:when>
      <xsl:when test="$tokens='Pears'"> 
        There are Pears in the list 
      </xsl:when>
      <xsl:otherwise> 
        Didn't find what we're looking for 
      </xsl:otherwise>
    </xsl:choose>
  </xsl:function>

  <xsl:template match="/">
    <out>
      <xsl:value-of select="my:test('Apples')"/>
      <xsl:value-of select="my:test('Pears,Oranges')"/>
      <xsl:value-of select="my:test(' Apples ,Pears,Oranges')"/>
      <xsl:value-of select="my:test('Oranges , Bananas, Strawberries')"/>
    </out>
  </xsl:template>
</xsl:stylesheet> 
```

您也可以使用[正则表达式](http://www.w3.org/TR/xpath-functions/#regex-syntax)。

See the XPath documentation for what [`normalize-space()`](http://www.w3.org/TR/xpath-functions/#func-normalize-space) and [`tokenize()`](http://www.w3.org/TR/xpath-functions/#func-tokenize) do. You might want to replace the bogus namespace "NS:MY" with something sensible.

# c# - 将实体与父实体映射时的 ValueInjector Stack Overflow

> ID：13635043
> 
> 赞同：4
> 
> 时间：2012-11-29T21:27:16.837
> 
> 标签：c#, mapping, valueinjecter

我正在使用 ValueInjecter 来处理我的 POCO 实体到我的 DTO 实体的映射。我一直在使用[Automapper Simulation](http://valueinjecter.codeplex.com/wikipage?title=Automapper%20Simulation&referringTitle=Home)作为我的主要映射器。这使我可以简单地编写如下映射：

```
var entity = GetEntityFromDatabase();
var dto = Mapper.Map<Entity, EntityDTO>(entity); 
```

这一直很好，直到我需要从我的数据库中获取具有父子关系的实体。问题是我一直在使用的这段代码将递归地遍历所有属性。如果我有一个像这样的 POCO，

```
public class Entity {
    public Guid Id {get; set;}
    public Entity Parent {get; set;}
    public IEnumerable<Entity> Children {get; set;}
} 
```

我的代码将在无限循环中爆炸，试图映射循环引用。我想继续使用 Automapper Simulation 源作为我的主要映射器，但我一直在弄清楚如何解决我的问题。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T19:42:58.647

我相信我通过更改 Automapper Simulation Mapper.cs 文件解决了这个问题。我在递归上实现了一个深度，如果超过该深度，我将对象设置为一个已经创建的对象。我确信这可以改进，但是，嘿，它现在有效！

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using Omu.ValueInjecter;

namespace MySystem.Services.Mapping
{
    // the static mapper class
    public static class Mapper
    {
        private static IList<ObjectContainer> _objects;

        //map source to an existing target
        public static TTarget Map<TSource, TTarget>(TSource source, TTarget target)
        {
            target = MapperFactory.GetMapper<TSource, TTarget>().Map(source, target);
            return target;
        }

        //create a new target and map source on it 
        public static TTarget Map<TSource, TTarget>(TSource source)
        {
            _objects = new List<ObjectContainer>();
            var target = (TTarget)Creator.Create(typeof(TTarget));
            var obj = MapperFactory.GetMapper<TSource, TTarget>().Map(source, target);
            _objects.Add(new ObjectContainer()
                             {
                                 original = source,
                                 converted = obj
                             });
            return obj;
        }

        public static object Map(object source, object target, Type sourceType, Type targetType)
        {
            target = target ?? Creator.Create(targetType);
            var getMapper = typeof(MapperFactory).GetMethod("GetMapper").MakeGenericMethod(sourceType, targetType);
            var mapper = getMapper.Invoke(null, null);
            var map = mapper.GetType().GetMethod("Map");
            var obj = map.Invoke(mapper, new[] { source, target });
            _objects.Add(new ObjectContainer()
                             {
                                 original = source,
                                 converted = obj
                             });
            return obj;
        }

        public static object MapFinal(object source, object target, Type sourceType, Type targetType)
        {
            foreach (var obj in _objects)
            {
                if (source.Equals(obj.original))
                {
                    return obj.converted;
                }
            }
            return null;
        }
    }

    public class ObjectContainer
    {
        public object original { get; set; }
        public object converted { get; set; }
    }

    public static class MapperFactory
    {
        private static readonly IDictionary<Type, object> Mappers = new Dictionary<Type, object>();

        public static ITypeMapper<TSource, TTarget> GetMapper<TSource, TTarget>()
        {
            //if we have a specified TypeMapper for <TSource,Target> return it
            if (Mappers.ContainsKey(typeof(ITypeMapper<TSource, TTarget>)))
                return Mappers[typeof(ITypeMapper<TSource, TTarget>)] as ITypeMapper<TSource, TTarget>;

            //if both Source and Target types are Enumerables return new EnumerableTypeMapper<TSource,TTarget>()
            if (typeof(TSource).IsEnumerable() && typeof(TTarget).IsEnumerable())
            {
                return (ITypeMapper<TSource, TTarget>)Activator.CreateInstance(typeof(EnumerableTypeMapper<,>).MakeGenericType(typeof(TSource), typeof(TTarget)));
            }

            //return the default TypeMapper
            return new TypeMapper<TSource, TTarget>();
        }

        public static void AddMapper<TS, TT>(ITypeMapper<TS, TT> o)
        {
            Mappers.Add(typeof(ITypeMapper<TS, TT>), o);
        }

        public static void ClearMappers()
        {
            Mappers.Clear();
        }
    }

    public interface ITypeMapper<TSource, TTarget>
    {
        TTarget Map(TSource source, TTarget target);
    }

    public class TypeMapper<TSource, TTarget> : ITypeMapper<TSource, TTarget>
    {
        public virtual TTarget Map(TSource source, TTarget target)
        {
            target.InjectFrom(source);
            target.InjectFrom<NullablesToNormal>(source);
            target.InjectFrom<NormalToNullables>(source);
            target.InjectFrom<IntToEnum>(source);
            target.InjectFrom<EnumToInt>(source);
            target.InjectFrom<MapperInjection>(source);

            return target;
        }
    }

    public class EnumerableTypeMapper<TSource, TTarget> : ITypeMapper<TSource, TTarget>
        where TSource : class
        where TTarget : class
    {
        public TTarget Map(TSource source, TTarget target)
        {
            if (source == null) return null;
            var targetArgumentType = typeof(TTarget).GetGenericArguments()[0];

            var list = Activator.CreateInstance(typeof(List<>).MakeGenericType(targetArgumentType));
            var add = list.GetType().GetMethod("Add");

            foreach (var o in source as System.Collections.IEnumerable)
            {
                var t = Creator.Create(targetArgumentType);
                add.Invoke(list, new[] { Mapper.Map(o, t, o.GetType(), targetArgumentType) });
            }
            return (TTarget)list;
        }
    }

    public static class TypeExtensions
    {
        //returns true if type is IEnumerable<> or ICollection<>, IList<> ...
        public static bool IsEnumerable(this Type type)
        {
            if (type.IsGenericType)
            {
                if (type.GetGenericTypeDefinition().GetInterfaces().Contains(typeof(System.Collections.IEnumerable)))
                    return true;
            }
            return false;
        }
    }

    public static class Creator
    {
        public static object Create(Type type)
        {
            if (type.IsEnumerable())
            {
                return Activator.CreateInstance(typeof(List<>).MakeGenericType(type.GetGenericArguments()[0]));
            }

            if (type.IsInterface)
                throw new Exception("don't know any implementation of this type: " + type.Name);

            return Activator.CreateInstance(type);
        }
    }

    public class MapperInjection : ConventionInjection
    {
        public const int MaxDepth = 20;
        public static int _depth = 0;

        protected override bool Match(ConventionInfo c)
        {
            return c.SourceProp.Name == c.TargetProp.Name &&
                !c.SourceProp.Type.IsValueType && c.SourceProp.Type != typeof(string) &&
                !c.SourceProp.Type.IsGenericType && !c.TargetProp.Type.IsGenericType
                ||
                 c.SourceProp.Type.IsEnumerable() &&
                   c.TargetProp.Type.IsEnumerable();
        }

        protected override object SetValue(ConventionInfo c)
        {
            if (c.SourceProp.Value == null)
            {
                return null;
            }
            if (_depth > MaxDepth)
                return Mapper.MapFinal(c.SourceProp.Value, c.TargetProp.Value, c.SourceProp.Type, c.TargetProp.Type);
            _depth++;
            object val = Mapper.Map(c.SourceProp.Value, c.TargetProp.Value, c.SourceProp.Type, c.TargetProp.Type);
            _depth--;
            return val;
        }
    }

    public class EnumToInt : ConventionInjection
    {
        protected override bool Match(ConventionInfo c)
        {
            return c.SourceProp.Name == c.TargetProp.Name &&
                c.SourceProp.Type.IsSubclassOf(typeof(Enum)) && c.TargetProp.Type == typeof(int);
        }
    }

    public class IntToEnum : ConventionInjection
    {
        protected override bool Match(ConventionInfo c)
        {
            return c.SourceProp.Name == c.TargetProp.Name &&
                c.SourceProp.Type == typeof(int) && c.TargetProp.Type.IsSubclassOf(typeof(Enum));
        }
    }

    //e.g. int? -> int
    public class NullablesToNormal : ConventionInjection
    {
        protected override bool Match(ConventionInfo c)
        {
            return c.SourceProp.Name == c.TargetProp.Name &&
                   Nullable.GetUnderlyingType(c.SourceProp.Type) == c.TargetProp.Type;
        }
    }

    //e.g. int -> int?
    public class NormalToNullables : ConventionInjection
    {

    protected override bool Match(ConventionInfo c)
    {
        return c.SourceProp.Name == c.TargetProp.Name &&
               c.SourceProp.Type == Nullable.GetUnderlyingType(c.TargetProp.Type);
    }
} 
```

# mysql - 这个 MySQL 查询有什么问题 - 在触发器中声明？

> ID：13635049
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:27:27.953
> 
> 标签：mysql, database, syntax, triggers

```
DELIMITER $$
CREATE TRIGGER before_insert_wall BEFORE INSERT ON wall FOR EACH ROW
BEGIN
DECLARE x INT;
SET x = (SELECT count(*) FROM wall); 
IF x > 10 THEN
DELETE
FROM wall
ORDER BY DATE ASC 
LIMIT 1
END IF;
END&&

DELIMITER ; 
```

只是什么都没有发生。我没有触发器出现在 phpmyadmin 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:33:49.843

你用过吗？

```
DELIMITER $$ 
```

然后`;`将无关紧要到触发器结束。

在触发器结束时`END $$`

**编辑**

```
END&& 
```

应该读

```
END $$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:59:05.383

也许另一个`;`在这里

```
DELETE
FROM wall
ORDER BY DATE ASC 
LIMIT 1; 
```

# objective-c - 无法设置视图控制器的后栏按钮项的标题

> ID：13635052
> 
> 赞同：0
> 
> 时间：2012-11-29T21:27:35.203
> 
> 标签：objective-c, uinavigationcontroller, uibarbuttonitem, xcode4.5, osx-mountain-lion

我正在使用具有导航控制器的应用程序训练自己，并且用户可以在两个视图控制器之间切换。
根视图控制器类称为 ViewController，这就是我在应用程序委托中以编程方式添加导航控制器的方式：

```
self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
navController= [[UINavigationController alloc]initWithRootViewController: viewController];
self.window.rootViewController= navController; 
```

这是导航控制器：

```
@property (strong, nonatomic) UINavigationController* navController; 
```

第二个视图控制器称为 SecondViewController。每当用户单击条形按钮项时，我都会推送它：

```
self.navigationItem.rightBarButtonItem=[[UIBarButtonItem alloc]initWithTitle: @"Second View" style: UIBarButtonItemStylePlain target: self action: @selector(switchView:)]; 
```

这是执行的选择器：

```
- (void) switchView : (id) sender
{
    if(!nextController)
    {
        nextController= [[SecondViewController alloc]initWithNibName: @"SecondViewController" bundle: nil];
    }
    [self.navigationController pushViewController: nextController animated: YES];
} 
```

然后在第二个视图控制器中自动出现一个标题为“返回”的按钮，它切换到第一个视图。这对我来说很好，但我想设置标题和样式。所以我正在尝试更改标题：

```
self.navigationItem.backBarButtonItem.title= @"First View"; 
```

但是无事可做，标题还是“回”，怎么改呢？

另外，我不是采用了错误或低效的方法，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:52:12.923

如果您在 中设置类的`title`属性，则当您将 a 压入堆栈时，该字符串将显示为后退按钮的文本。`ViewController``viewDidLoad``SecondViewController`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:46:56.047

试试这个来改变按钮标题。初始化并添加您自己的 leftBarButtonItem 并隐藏股票后退按钮。

```
UIBarButtonItem* backBtn =  [[UIBarButtonItem alloc] initWithTitle:@"BUTTON_NAME" style:UIBarButtonItemStyleDone target:self action:@selector(backAction)];

self.navigationItem.leftBarButtonItem = backBtn;
self.navigationItem.hidesBackButton = YES; 
```

如果可以的话，您将想要隐藏原始的后退按钮，并且只需制作一个 backAction，它可以是使用 popViewcontrollerAnimated 函数的东西（如果您一开始就按下 viewcontroller）。

```
- (void) backAction {
    [self.navigationController popViewControllerAnimated:YES];
} 
```

# ios - Strange behavior from affine transform rotation on iOS

> ID：13635055
> 
> 赞同：1
> 
> 时间：2012-11-29T21:27:49.250
> 
> 标签：ios, uiimageview, cgaffinetransform

I want to do a fairly simple rotation of a UIImageView. Basically I have an image of a wheel in a perfectly square image and I want to rotate it under animation.

So I tried this:

```
- (void)testButtonPressed:(id)sender {
    NSLog(@"Test button pressed");
    CGAffineTransform transform = CGAffineTransformMakeRotation(1.0);

    [UIView animateWithDuration:10.0 delay:0 options:UIViewAnimationOptionCurveLinear
                     animations:^{
                         dial.transform = transform;  // "dial" is a UIImageView
                     }
                     completion: ^(BOOL finished){
                     }];
 } 
```

What happens is that, when the animation begins the image (that's about 300 square) immediately jumps up 50-100 pixels and is "squeezed" into a narrow oval. After that, the animation proceeds just fine.

I tried using `beginAnimation` instead and got the same behavior.

I understand that I don't understand the stuff about the rotation origin (the docs talk in circles), but the squeezing seems odd, and the fact that it all occurs at once (vs being animated) is strange.

Any ideas?

(This is running on the iPhone 6.0 simulator from Xcode 4.5.1\. Is is possibly just a simulator thing?)

**Update:** I got a chance to work on it a little more (I do it in-between "real" work). I created a new XIB that never had autolayout and the wheel was "normal" but the background was vertically compressed.

Then a bit of inspiration. I noticed that the image views were marked "autoresize" in the NLog dumps. Didn't see a way to turn that off from IB, but did see that you can turn off "Autoresize Subviews" on the main view. Did that and it behaved perfectly!

I'm thinking that some of the new features introduced for autolayout are the culprit here. Don't know, though, if I've found all the magical settings yet.

**But...** Still have the problem that the "transparent" parts of my images are black on the iPad, even after turning off "Opaque" on everything.

**Update:** I've finally figured out that my images were in JPG 24 bit mode rather than 32 bit mode. This works on the simulator -- pure black is interpreted as transparent. But it doesn't work on the iPad. Using 32 bit images fixes that and (with "autoresize subviews turned off to eliminate the odd distortions/translations) everything is fine ***except*** ... rotations > 180 degrees animate backwards. The animation is being "smart" and taking the "shortest path".

I suppose I'll simply have to break the animation into two steps.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T21:40:43.090

你为什么不用 CABasicAnimation 来做呢。

```
CABasicAnimation* rotationAnimation;
rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
rotationAnimation.toValue = [NSNumber numberWithFloat: -M_PI_2 ];
rotationAnimation.duration = 2.0;
rotationAnimation.cumulative = YES;
rotationAnimation.repeatCount = 1.0; 
rotationAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseOut];

[imageView.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"]; 
```

# objective-c - Cocoa/Objective-C - 从其他窗口层发送/接收点击？

> ID：13635056
> 
> 赞同：1
> 
> 时间：2012-11-29T21:27:54.293
> 
> 标签：objective-c, macos, cocoa

我正在制作一个类似于 GeekTool 的应用程序。我不太熟悉 GeekTool 在内部的工作方式，但它的外观和行为相似。基本上我有一个覆盖整个屏幕的无边框窗口，这很好用。我目前在*“kCGDesktopIconWindowLevel”*层上有窗口，但是我不能与桌面上的任何东西交互（移动/打开文件等）。*当我在此级别（ kCGDesktopIconWindowLevel-1* ）下有一层窗口时，我可以与桌面交互，但不能与我的窗口交互，我需要能够交互。无论如何我可以从上层接收点击或将它们发送到下层吗？

顺便说一句，如果您对如何实现这一点有更好的想法但避免这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T20:36:04.663

我建议您在以下位置创建一个这样的事件点击（从[这个答案](https://stackoverflow.com/a/3135508/1362154)中提取）`applicationDidFinishLaunching:`：

```
CGEventMask emask;
CFMachPortRef myEventTap;
CFRunLoopSourceRef eventTapRLSrc;

// We only want one kind of event at the moment: Left mouse down
emask = CGEventMaskBit(kCGEventLeftMouseDown);

// Create the Tap
myEventTap = CGEventTapCreate (
    kCGSessionEventTap, // Catch all events for current user session
    kCGTailAppendEventTap, // Append to end of EventTap list
    kCGEventTapOptionListenOnly, // We only listen, we don't modify
    emask,
    &myEventTapCallback,
    NULL // We need no extra data in the callback
);

// Create a RunLoop Source for it
eventTapRLSrc = CFMachPortCreateRunLoopSource(
    kCFAllocatorDefault,
    myEventTap,
    0
);

// Add the source to the current RunLoop
CFRunLoopAddSource(
    CFRunLoopGetCurrent(),
    eventTapRLSrc,
    kCFRunLoopDefaultMode
); 
```

将您的窗口设置为通常忽略鼠标事件——`[myWindow setIgnoresMouseEvents: YES];`

然后你的事件点击会寻找它想要“捕捉”的鼠标点击——像这样：

```
static CGEventRef myEventTapCallback (
    CGEventTapProxy proxy,
    CGEventType type,
    CGEventRef event,
    void * refcon
) {
    CGPoint mouseLocation;

    // If we would get different kind of events, we can distinguish them
    // by the variable "type", but we know we only get mouse moved events

    mouseLocation = CGEventGetLocation(event);

    // Figure out if the mouse is clicking on something we want to "catch"
    if (/* want this click */)
       [myWindow setIgnoresMouseEvents: NO];

    // Pass on the event, we must not modify it anyway, we are a listener
    return event;
} 
```

鼠标事件完成后，将窗口返回到忽略鼠标事件。

# for-loop - batch file get rid of "to specify a file name or a directory name on the target" message

> ID：13635057
> 
> 赞同：1
> 
> 时间：2012-11-29T21:27:55.490
> 
> 标签：for-loop, batch-file, subroutine, xcopy

I have an issue with my batch file that incorporates a 10sec delay between everytime it looks at a specified folder then CALLS a subroutine for naming convention:[...batch that copies modified files in directory to another directory](https://stackoverflow.com/questions/13631690/batch-file-incorporate-another-batch-that-copies-modified-files-in-directory-to/13631809#comment18702602_13631809)

I have modified the code according to Ken White which has been very helpful, however I have another issue that is further related to this batch, being that when the batch is ran and I do a test file update and save within the source directory, the batch asks me in the cmd console "to specify a file name or a directory name on the target" for EVERY file that it looks at. Since I want this to be automatically running in the background I don't want to have to have user input for it to run properly. Any help or suggestions would be very helpful.

Here is what I have currently:

```
@Echo Off & setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION
:: variables
set drive=C:\Users\me\Desktop\Test Source Folder\
set backupcmd=xcopy /m /s /c /d /e /h /i /r /y
Set _Delay=10
Set _Monitor=C:\Users\me\Desktop\Test Source Folder
Set _Base=%temp%\BaselineState.dir
Set _Chck=%temp%\ChkState.dir
Set _OS=6

:_RevLoop
set basename=
for %%a in (*.*) do (
if not defined baseName (
    rem Is first name of first set
    set baseName=%%~Na
    set baseExt=%%~Xa
    set lastname=%%~Na
    ) else (
    rem Check if this name begin with same baseName
    set name=%%~Na
    for %%b in (!baseName!) do set name=!name:*%%b=!
      if "!name!" neq "%%~Na" (
         rem Yes: Is next name of same set
         set lastName=%%~Na
      ) else (
         rem No: Is first name of next set: copy previous set and pass to next one
         %backupcmd% "!lastName!!baseExt!" "C:\Users\me\Desktop\Test Destination Folder\!baseName!!baseExt!"
         set baseName=%%~Na
         set baseExt=%%~Xa
         set lastName=%%~Na
      )
   )      
)
rem Copy last set
%backupcmd% "!lastName!!baseExt!" "C:\Users\me\Desktop\Test Destination Folder\!    baseName!!baseExt!"

Ver|Findstr /I /C:"Version 5">Nul
If %Errorlevel%==0 Set _OS=5 & Set /A _Delay=_Delay*1000
:_StartMon
Call :_SetBaseline "%_Base%" "%_Monitor%"
:_MonLoop
If %_OS%==5 (Ping 1.0.0.0 -n 1 -w %_Delay%>Nul) Else Timeout %_Delay%>Nul
Call :_SetBaseline "%_Chck%" "%_Monitor%"
FC /A /L "%_Base%" "%_Chck%">Nul
If %ErrorLevel%==0 Goto _MonLoop

echo ___ Backing up JobBoss files...
::%backupcmd% "C:\Users\me\Desktop\Test Source     Folder" "C:\Users\me\Desktop\Test Destination Folder\"

::CALL "C:\users\me\Desktop\Test Source Folder\Test.bat"

ECHO ___ Checking for new file revisions...

GOTO :_RevLoop

Echo.Backup Complete!

Goto :_StartMon
:::::::::::::::::::::::::::::::::::::::::::::::::::
:: Subroutine
:::::::::::::::::::::::::::::::::::::::::::::::::::
:_SetBaseline
If Exist "%temp%\tempfmstate.dir" Del "%temp%\tempfmstate.dir"
For /F "Tokens=* Delims=" %%I In ('Dir /S "%~2"') Do (
Set _Last=%%I
 >>"%temp%\tempfmstate.dir" Echo.%%I
)
>"%~1" Findstr /V /C:"%_Last%" "%temp%\tempfmstate.dir"
Goto :EOF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:55:14.937

假设您在复制文件时不需要重命名文件，请尝试

```
%backupcmd% "!lastName!!baseExt!" "C:\Users\me\Desktop\Test Destination Folder\" 
```

注意：我发现尾随`\`否定了`/i`开关的需要。

**编辑：**新策略。首先使用上述命令复制基本文件，然后当您复制最终文件时，它将覆盖它而不提示。

```
for %%a in (*.*) do (
    if not defined baseName (
        rem Is first name of first set
        set baseName=%%~Na
        set baseExt=%%~Xa
        set lastname=%%~Na
        %backupcmd% "%%a" "C:\Users\me\Desktop\Test Destination Folder\"
    ) else (
        rem Check if this name begin with same baseName
        set name=%%~Na
        for %%b in (!baseName!) do set name=!name:*%%b=!
        if "!name!" neq "%%~Na" (
            rem Yes: Is next name of same set
            set lastName=%%~Na
        ) else (
            rem No: Is first name of next set: copy previous set and pass to next one
            %backupcmd% "!lastName!!baseExt!" "C:\Users\me\Desktop\Test Destination Folder\!baseName!!baseExt!"
            set baseName=%%~Na
            set baseExt=%%~Xa
            set lastName=%%~Na
            %backupcmd% "%%a" "C:\Users\me\Desktop\Test Destination Folder\"
        )
    )
) 
```

# javascript - popup window opens larger than intended dimensions

> ID：13635058
> 
> 赞同：1
> 
> 时间：2012-11-29T21:27:56.177
> 
> 标签：javascript, popup, window

I have been trying to figure out the following problem for way too long now and I can't seem to get a grip on what I'm doing wrong...

For my online portfolio, I have a splash "enter" image that is supposed to open a new window with a fixed size of 1013px for the width and 632px for the height. I chose this size for the window because this is the size of my background image and I am not intending on making the actual page scrollable. All of my content is supposed to just fit within the fixed window.

However, I'm noticing discrepancies among browsers. On my very own computer, a Macbook Pro, using a recent version of Safari, I keep on getting about 80+ pixels of white space underneath my background. On my girlfriend's computer, (also a Macbook Pro,) this problem also occurs. But, when I test the website on my iMac desktop, which happens to have Safari, Chrome, and Firefox all installed, the window opens up to the correct dimensions, with no extra white space. Finally, although I haven't been able to see it functioning in person, I've been told that there is white space added at the bottom AND on the right side of my background when the website is opened up on a Windows-based computer.

The link to the splash page is: [http://www.jamesbarracca.com](http://www.jamesbarracca.com)

Can you please tell me why I am having this issue? Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:53:37.757

我建议更改您的 JavaScript 以更严格地控​​制弹出窗口的大小。可能发生的情况是，在各种不同的浏览器和不同的机器上，弹出窗口的默认大小是不同的。

看看[这篇文章](http://macboypro.wordpress.com/2009/05/16/pop-up-a-new-browser-window-with-a-fixed-size/)的例子。

摘录：

```
<script type="text/javascript">
    function openpopup(address, width, height) {
        window.open(
            address, 
            "",
            "fullscreen=no,toolbar=no,status=no," + 
            "menubar=no,scrollbars=no,resizable=no," +
            "width=" + width + ",height=" + height
        );
    }
</script> 
```

然后，您可以使用以下内容调用此新函数：

```
<a href="javascript: openpopup('http://www.google.com', '1013', '632')">
  <img src="/my/image/path.png" />
</a> 
```

如您所见 - 该功能允许您指定弹出窗口的宽度和高度，关闭滚动条/调整大小等功能。希望能帮助到你！

# javascript - 使用href链接时如何避免IE上的“导航离开”错误

> ID：13635062
> 
> 赞同：0
> 
> 时间：2012-11-29T21:28:12.800
> 
> 标签：javascript

我有以下代码：

```
<a href="javascript:popup('example.htm')">example</a>

<SCRIPT>
function popup(URL)
{
popup=window.open(.....);
popup.focus;
}
</SCRIPT> 
```

在 IE 上单击链接时，在打开弹出窗口之前出现“正在导航...”错误。如何在不使用 JQuery 的情况下修复代码以直接进入弹出窗口？

我发现

```
window.onbeforeunload = null; 
```

但是我应该将它插入我的代码中的哪个位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:02:36.347

```
window.onbeforeunload = null; 
```

可以在你的代码中去任何你想去的地方。在弹出函数中使用返回值`false`也可能会纠正问题。

祝你好运！

# javascript - 嵌套 JSON 使用节点名称作为有序列表的标题

> ID：13635064
> 
> 赞同：0
> 
> 时间：2012-11-29T21:28:15.193
> 
> 标签：javascript, jquery, json, nested

今天半天我一直在努力解决这个问题。我已经嵌套了 JSON，我希望能够将每个节点抓取并解析为一个单独的 ol，并以第一个 li 中使用的节点名称作为标题。我可以很好地解析响应并遍历它，但是改变它以将节点分成块是我卡住的地方。到目前为止，这是我的 js：

```
function parseData(obj) {
            var newId = '';
            var hashId = '#pay-data';

            $.each(obj, function(key, val) {
                if(val && typeof val === "object") {
                    $('#pay-data').append('<ol>');
                    parseData(val);
                } else {
                    console.log(key + ' - ' + val);
                    $('#pay-data').append('<li>' + key + ' - ' + val + '</li>');
                }
            });
        } 
```

这是 JSON 的一个示例：

```
{
"success":true,
"payAndBenefits":{
"employers":[{
    "rewards":
        {
            "totalCompensationValue":1466.95,
            "otherDeductions":141.82,
            "netPay":605.18,
            "incomeTaxes":101,
            "governmentReqd":50,
            "employerRetirementContributions":90.12,
            "employerPaidBenefits":376.83,
            "employeeRetirementContributions":102
        },
        "pay":
            {
                "paySiteURL":"https://someurl.com",
                "payPeriodEnding":"2012-09-30",
                "payDate":"2012-10-01",
                "otherDeductions":[
            {
                "description":"G T L Offset",
                "amountYTD":45,
                "amountThisPeriod":6
            },
            {
                "description":"Before Tax Dent",
                "amountYTD":-900,
                "amountThisPeriod":-147.82
            },
            {
                "description":"Checking deposit",
                "amountYTD":-6668,
                "amountThisPeriod":-605.18
            }
        ],
        "netPayYTD":6668,
        "netPayThisPeriod":605.18,
        "incomeTaxesDeductions":[
            {
                "description":"Federal Income Tax",
                "amountYTD":-909,
                "amountThisPeriod":-101
            }
        ],
        "grossPayYTD":9800,
        "grossPayThisPeriod":1000,
        "governmentRequiredDeductions":[
            {
                "description":"Social Security Tax",
                "amountYTD":-450,
                "amountThisPeriod":-50
            }
        ],
        "employeeRetirementPlanContribDeductions":[
            {
                "description":"401(k)",
                "amountYTD":-918,
                "amountThisPeriod":-102
            }
        ],
        "earnings":[
            {
            "description":"Regular",
            "amountYTD":9000,
            "amountThisPeriod":1000
            },
            {
                "description":"Vacation",
                "amountYTD":800,
                "amountThisPeriod":null
            }
        ]
    },
    "employerName":"Company Name", 
```

似乎我应该可以在这里某个地方使用 object.name ，但我完全被卡住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:36:42.193

我猜你想要这样的东西。

```
function parseData(obj, targetDOMElement) {

  $.each(obj, function(key, val) {

    if(val && typeof val === "object") {

      var newTarget = $('<ol>'); // create the new list item
      newTarget.append('<li>' + key + '</li>'); // append the title as you wanted
      targetDOMElement.append(newTarget);  // add it to the target container
      parseData(val, newTarget); // parse the children and set the created list as the new target

    } else {

      // or just add the key-value pair to the target
      targetDOMElement.append('<li>' + key + ' - ' + val + '</li>');

    }

  });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:35:04.150

您将所有 li 附加到根元素：

```
$('#pay-data').append('<li>' + key + ' - ' + val + '</li>'); 
```

相反，您需要将它们附加到您刚刚创建的 ol 中。一种方法是更改​​ parseData 函数以同时传递当前对象和当前 ol 节点：

```
function parseData(object, olNode) {...} 
```

例如：

```
$('#pay-data').append('<ol>');
parseData(val); 
```

会成为：

```
// append a new ol node and store it in nextolNode
var nextolNode=olNode.append('<ol>');
parseData(val,nextolNode); 
```

# sql-server - 动态列的水平总和

> ID：13635066
> 
> 赞同：0
> 
> 时间：2012-11-29T21:28:19.177
> 
> 标签：sql-server, dynamic, pivot-table

我目前正在尝试获取报告的水平总和。当前使用动态查询和数据透视表。下面是我的代码

声明@cols nvarchar(max) 声明@pvt_cols nvarchar(max) 声明@sqlquery nvarchar(max)

```
select @cols= Coalesce(@cols+',','')
    + 'Coalesce([' +MonthYR+ '],0) AS [' + MonthDescription +'] '
            ,@pvt_cols=coalesce(@pvt_cols +',','') +' ['+[MonthYR] +']' 
from @Calendar 
where CASDT between '20110401' and '20111230' (generates column with month headers)

print @cols     
print @pvt_cols
print '--------------------'

Set @sqlquery='Select ProdDesc,'+@cols + ',Total
            from (Select    ProdDesc, 
                    MonthYr, 
                    NetAmount,
                    SUM(NetAmount ) over (partition by ProdDesc) as Total 
            from #Comtempt1
             ) as dat 
                    pivot(
            SUM(NetAmount) for MonthYr in 
            (' + @pvt_cols + '))pvt'

print @sqlquery

exec sp_executesql @sqlquery 
```

我能够获得总数，但它显示了整个记录的总数，而我只需要根据用户输入的日期获得总数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:03:29.397

```
declare @cols nvarchar(max) declare @pvt_cols nvarchar(max) declare @sqlquery nvarchar(max)
declare @total nvarchar(max)
select @cols= Coalesce(@cols+',','')
    + 'Coalesce([' +MonthYR+ '],0) AS [' + MonthDescription +'] '
            ,@pvt_cols=coalesce(@pvt_cols +',','') +' ['+[MonthYR] +']' 
            ,@total= Coalesce(@total+'+','') + 'Coalesce([' +MonthYR+ '],0)'
from @Calendar 
where CASDT between '20110401' and '20111230' (generates column with month headers)

print @cols     
print @pvt_cols
print '--------------------'

Set @sqlquery='Select ProdDesc,'+@cols + ',' + @Total + ' Total
            from (Select    ProdDesc, 
                    MonthYr, 
                    NetAmount,
                    SUM(NetAmount ) over (partition by ProdDesc) as Total 
            from #Comtempt1
             ) as dat 
                    pivot(
            SUM(NetAmount) for MonthYr in 
            (' + @pvt_cols + '))pvt'

print @sqlquery

exec sp_executesql @sqlquery 
```

# asp.net-mvc - Windows 身份验证重定向页面？

> ID：13635067
> 
> 赞同：1
> 
> 时间：2012-11-29T21:28:32.967
> 
> 标签：asp.net-mvc, asp.net-mvc-4, windows-authentication

我有一个**Windows 身份验证**Intranet 站点。

```
<authentication mode="Windows"  >
</authentication>
<authorization>
  <deny users="?" />
</authorization> 
```

如果用户在Controller上授权失败，

```
[Authorize(Roles="Admin")]
public class SearchController : BaseController 
```

我希望他们定向到 ~/UnAuthorized/Index

这可以在**Web.Config**中设置吗，类似于我可以重定向到登录页面的表单身份验证？我只想重定向到一个简单的 [AllowAnonymous] 控制器，我在 (~/UnAuthorized/Index)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:33:58.957

不，这不能轻易设置。如果用户未针对给定应用程序进行身份验证，则用户代理会提示他提供他的凭据。您无法通过 Windows 身份验证对此对话框的 UI 方面进行太多控制。

# jquery - 从右向左滑动切换 DIV

> ID：13635073
> 
> 赞同：0
> 
> 时间：2012-11-29T21:28:40.780
> 
> 标签：jquery, css, jquery-animate

我正在尝试将一个 DIV 从右向左滑动到另一个 DIV 上。它适用于最初的幻灯片，但它是不工作的幻灯片。它再次从右向左滑动消失，然后我尝试再次单击该按钮，但在第一次打开和关闭后它将不起作用。

我要遵循的代码：

```
function changeFeat () {
    if(jQuery('#featartinside').css('display') == 'none') {
        jQuery('#featartinside').animate({
            width: 730,
            marginLeft: 1,
            marginRight: -730,
            display: 'toggle'
        }, 'slow');
    } else {
        jQuery('#featartinside').animate({
            width: -730,
            marginLeft: 1,
            marginRight: 730,
            display: 'toggle'
        }, 'slow');
    }
}

#featartban {
    position: relative;
    background: url(../images/featart.png) top left no-repeat;
    width: 54px;
    height: 279px;
    cursor: pointer;
    float: left;
    left: 730px;
    margin-bottom: -279px;
}

#featartinside {
    height: 279px;
    width: 0;
    margin-left: 730px;
    background: #D13630;
    float: left;
    margin-bottom: -279px;
} 
```

就像我说的那样，它可以很好地打开，但关闭不起作用，因为它继续从右到左而不是从左到右关闭。然后我无法打开和关闭第二次。

编辑 HTML：

```
<div id="featartban" onclick="changeFeat(); return false;"></div>
<div id="featartinside" style="display: none;"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:53:19.997

坚持使用 jQuery。

```
<div id="featartban"></div>
<div id="featartinside" style="display: none;"></div>​ 
```

```
var $featartban = $("#featartban");
var $featartinside = $("#featartinside");
$featartban.toggle(function show() {
  $featartinside.animate({
    width: 730,
    marginLeft: 1,
    marginRight: -730,
    display: 'toggle'
  }, 'slow');
}, function hide() {
  $featartinside.animate({
    width: 0,
    marginLeft: 730,
    marginRight: 0,
    display: 'toggle'
  }, 'slow');
});​ 
```

[`.toggle()`](http://api.jquery.com/toggle-event/)（不与 混淆[`.toggle()`](http://api.jquery.com/toggle/)）很棒。

[看到它住在这里。](http://jsfiddle.net/DsUU8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-30T07:07:43.420

你可以试试这个

JS：

```
/*creating click event*/
$(document).ready(function(){
  $('a#click-a').click(function(){
    $('.nav').toggleClass('nav-view');
  });
}); 
```

演示：[http ://www.themeswild.com/read/slide-navigation-left-to-right](http://www.themeswild.com/read/slide-navigation-left-to-right)

# ios - 在当前版本正在审核中时，将应用内购买项目添加到下一个版本

> ID：13635076
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:28:55.000
> 
> 标签：ios, app-store, app-store-connect

我已经向 AppStore 提交了一个应用程序，它正在等待审核。与此同时，我正在为下一个版本的应用程序添加应用程序内购买。为此，我需要将它们添加到 iTunes Connect 中以进行测试。

我不确定添加 IAP 是否会以某种方式影响当前版本（目前正在等待审核）？

有谁知道如何处理这种情况？应该很常见吧？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:36:58.720

不，它不会影响应用审查

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:39:28.783

您的应用以潜在 IAP 项目列表开始，这些项目传递给 IAP sdk 以获取信息。由于新项目不应该出现在旧版本应用程序的列表中，我看不出它们会如何影响它。如果您从服务器检索列表，则需要确保在任何情况下都为应用程序的每个版本返回正确的列表。如果您没有适当的逻辑，那么事情可能会变得混乱，但无论如何都需要修复（想象一下不升级的用户）。

# python - 金字塔 CSRF 令牌从 GET 更改为 POST

> ID：13635077
> 
> 赞同：1
> 
> 时间：2012-11-29T21:28:55.000
> 
> 标签：python, csrf, pyramid

我正在使用 python requests 模块登录网页。我`csrf_token`通过`GET`在 url 上发出请求，解析它`BeautifulSoup`以获得`csrf_token`很好并且工作得很好，但是当我做 a`POST`并使用`csrf_token`from 时`GET`，`csrf_token`已经改变了，我无法使用无效登录`csrf_token`。

我理解`csrf`从`GET`to 的变化，`GET`但不应该从`GET`to变化`POST`。如何让 csrf_token 不改变？我也可以访问源代码，但我没有写它。

当我进入代码时，`pdb.set_trace()`我可以将 更改`csrf_token`为我从中获得的`GET`内容并继续，然后一切正常。

这是我的请求代码：

```
import sys
import requests
from bs4 import BeautifulSoup

#~ URL       = 'https://portal.bitcasa.com/login'
URL       = 'http://0.0.0.0:12080/login'
EMAIL     = 'foo@foo.com'
PASSWORD  = 'abc123'
CLIENT_ID = 12345

client = requests.session(config={'verbose': sys.stderr})

# Retrieve the CSRF token first

soup = BeautifulSoup(client.get(URL).content)
csrftoken = soup.find('input', dict(name='csrf_token'))['value']

print csrftoken

# Parameters to pass
data    = dict(email=EMAIL, password=PASSWORD, csrf_token=csrftoken)
headers = dict(referer=URL)
params  = dict(client_id=CLIENT_ID)

r = client.post(URL, data=data, headers=headers, params=params)

print r
print r.text 
```

我可以使用此方法登录其他网页。

我还可以提供哪些其他信息来帮助您帮助我？

谢谢

# java - java复制构造函数和继承

> ID：13635078
> 
> 赞同：7
> 
> 时间：2012-11-29T21:29:05.183
> 
> 标签：java, inheritance, copy-constructor

经过一番搜索，我没有找到关于复制构造函数和继承的问题的任何好的答案。我有两个班级：用户和实习生。Trainee 继承自 User 并在 Trainee 中添加了两个 String 参数。现在我设法制作了 User 的复制构造函数，但我对 Trainee 的复制构造函数不满意。User 拷贝构造函数的代码是这样的：

```
public User (User clone) {
    this(clone.getId(), 
         clone.getCivilite(),
         clone.getNom(), 
         clone.getPrenom(), 
         clone.getEmail(), 
         clone.getLogin(), 
         clone.getTel(), 
         clone.getPortable(), 
         clone.getInscription(), 
         clone.getPw()
    );
} 
```

我尝试在我的 Trainee 复制构造函数中使用 super ：

```
public Trainee (Trainee clone) {
    super (clone);
    this (clone.getOsia(), clone.getDateNaiss());
} 
```

但它不起作用，我被迫编写完整版本的复制构造函数：

```
public Trainee (Trainee clone) {
    this(clone.getId(), 
         clone.getCivilite(),
         clone.getNom(),
         clone.getPrenom(), 
         clone.getEmail(), 
         clone.getLogin(), 
         clone.getTel(), 
         clone.getPortable(), 
         clone.getInscription(), 
         clone.getPw(), 
         clone.getOsia(), 
         clone.getDateNaiss()
    );
} 
```

由于我的主要构造，我必须像这样转换我的新实例：

```
 User train = new Trainee();
  User train2 = new Trainee((Trainee) train); 
```

所以我的问题是：有没有更清洁的方法来做到这一点？我不能用超级吗？

预先感谢您的回答和帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T21:33:38.637

最好使“完整”复制构造函数`Trainee`也采用`User`：

```
public Trainee(Trainee clone)
{
    this(clone, clone.getOsai(), clone.getDateNaiss());
}

public Trainee(User clone, String osai, String dateNaiss)
{
    super(clone);
    this.osai = osai;
    this.dateNaiss;
} 
```

尽可能保持在每个类中拥有一个“主”构造函数的模式是值得的，所有其他构造函数都直接或间接地链接到该构造函数。

`Trainee` *现在，尚不清楚在不*指定现有用户信息的情况下创建 a 是否有意义......或者可能以其他方式指定它。在这种情况下，您*可能**确实*需要两组单独的构造函数——一组用于复制构造函数，一组用于“只给我所有值”构造函数。这真的取决于你的背景——我们不能仅仅从这一点上看出来。

在这种情况下，您将稍微违反“一个主构造函数”规则，但您可以认为有*两个*主构造函数，每个用于不同目的的一组构造函数。从根本上说，你会遇到“继承变得混乱”——这太常见了:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:34:25.523

我会做：

```
 public Trainee (User clone) // By specifying `User` you allow the use in your code
 {
    super (clone);
    if (clone instanceof Trainee) {
      this.osia = clone.getOsia();
      this.dateNaiss = clone.getDateNaiss());
    }
 } 
```

# c++ - 在 Eclipse CDT (Juno/Kepler/Luna) 索引器中启用 C++11

> ID：13635079
> 
> 赞同：37
> 
> 时间：2012-11-29T21:29:10.087
> 
> 标签：c++, c++11, eclipse-cdt

如何在 Juno/Kepler/Luna 的 Eclipse CDT 索引器上启用对新 C++ 标准的支持？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-11-29T21:29:10.087

**请注意**，此问题（和答案）仅涉及**Eclipse 索引器**，该索引器用于在编译发生之前突出显示错误。**C++ 编译器设置没有改变！**（因此，由于缺少 C++11 设置，编译仍可能失败，但请查看“相关”部分）

要更改**Eclipse 索引器**设置，请转到 `Project properties`-> `C/C++ General`-> `Preprocessor Include Paths, Macros etc.`-> 选项卡`Providers`->`CDT GCC Built-in Compiler Settings`

并附加`-std=c++0x`（或`-std=c++11`）到`Command to get compiler specs:`

之后它应该看起来像：

> ${COMMAND} -E -P -v -dD ${INPUTS} -std=c++0x

![应用了更改的配置窗格的屏幕截图](../Images/afced736fa1506ba0b9aaae510072e74.png)

**来源**

*   [http://wiki.eclipse.org/CDT/User/FAQ#CDT_does_not_recognize_C.2B.2B11_features](http://wiki.eclipse.org/CDT/User/FAQ#CDT_does_not_recognize_C.2B.2B11_features)
*   [http://www.eclipse.org/forums/index.php/mv/msg/373462/909018/#msg_909018](http://www.eclipse.org/forums/index.php/mv/msg/373462/909018/#msg_909018)

**有关的**

*   [Eclipse CDT C++11/C++0x 支持](https://stackoverflow.com/q/9131763/760746)
*   [https://stackoverflow.com/a/17499266/760746（C++11-](https://stackoverflow.com/a/17499266/760746)启用编译器（Kepler 及之前））
*   [https://stackoverflow.com/a/22480299/760746（C++11-](https://stackoverflow.com/a/22480299/760746)启用编译器（Kepler（更新）和更新版本）

**更新**

用 Eclipse 测试成功

*   开普勒 (CDT 8.2)
*   露娜 (CDT 8.4)

# c - 无效写入——Valgrind

> ID：13635084
> 
> 赞同：2
> 
> 时间：2012-11-29T21:29:21.420
> 
> 标签：c, memory, free, valgrind

嗨，我遇到了 munmap_chunk(): invalid pointer: error in my c 程序。

主要问题是......我什至不确定指针可能变为无效的所有方式是什么。我已经检查了我的代码中没有足够空间调用的字符串，但没有发现任何看起来会超出界限的东西！

相关代码如下（无论如何我认为是相关代码）

```
//Takes in a username and suggests friends of friends who are the opposite sex as friends of username
395 void suggest_friends(char* username, FILE* out) {
396     //printf("ENTER suggest_friends\n");
397     to_lowercase(username);
398 
399     if (check_username(username) == 0) {
400 
401         struct user_node *user = search_username(username);
402         if (user != NULL) {
403 
404             struct friend_node *a_friend = user->a_friend;
405             struct friend_node *friends_friend = NULL;
406             struct friend_node *temp_friends_friend = NULL;
407 
408             struct friend_suggest_node *list = NULL;
409             struct friend_suggest_node *list_it = NULL;
410             struct friend_suggest_node *new_suggest = NULL;
411             int friend_suggest_switch = -1;
412 
413             int print_string_size = 50;
414             int print_string_len = 0;
415             char* print_string = calloc(print_string_size + 1, sizeof(char));
416             char* user_string = NULL;
417             int num_suggestions = 0;
418             int num_mutual_friends = 0;
419             int max_friends = 0;
420 
421             //Iterate over all friends
422             while (a_friend != NULL) {
423 
424                 friends_friend = a_friend->user->a_friend;
425                 //Does friend have friends of opposite sex that I'm not friends with?
426                 //Iterate over friend's friends
427                 while (friends_friend != NULL) {
428 
429                     num_mutual_friends = 0;
430                     //mutual friend found
431                         //Different gender, and not friends
432                     if (friends_friend->user->gender != user->gender && are_friends(friends_friend->u    ........ser, user) != 0) {
433 
434                         //are there are elements in the suggested friends list yet??
435                         if (list == NULL) {
436 
437                             new_suggest = malloc(sizeof(struct friend_suggest_node));
438                             new_suggest->user = friends_friend->user;
439                             new_suggest->next = NULL;
440                             list = new_suggest;
441                             friend_suggest_switch = 0;
442                         }
443                         //there are already elements
444                         else {
445 
446                             friend_suggest_switch = 0;
447                             //Loop over suggested friends, to check if friends friend already found
448                             list_it = list;
449                             while (list_it != NULL) {
450 
451                                 //if the user is already in the suggested list
452                                 if (list_it->user == friends_friend->user) {
453                                     friend_suggest_switch = -1;
454                                     break;
455                                 }
456                                 list_it = list_it->next;
457                             }
458 
459                             //if the friend to suggest is a new suggestion
460                             if (friend_suggest_switch == 0) {
461 
462                                 //add friend to suggest to the front of the list
462                                 //add friend to suggest to the front of the list
463                                 new_suggest = malloc(sizeof(struct friend_suggest_node));
464                                 new_suggest->user = friends_friend->user;
465                                 new_suggest->next = list;
466                                 list = new_suggest;
467                             }
468                         }
469 
470                         //if the friend found was new
471                         if (friend_suggest_switch == 0) {
472 
473                             //INTENTION? LOOP OF THE FRIEND OF A FRIEND'S FRIEND LIST!?
474                             //Loop over the remainder of the user's friends's, friend list
475                                 //whom is about to be suggested as a mutual friend
476                             temp_friends_friend = friends_friend->user->a_friend;
477                             while (temp_friends_friend != NULL) {
478 
479                                 //if user is found who is a mutual friend with user
480                                 if (are_friends(temp_friends_friend->user, user) == 0) {
481 
482                                     num_mutual_friends++;
483                                 }
484 
485                                 temp_friends_friend = temp_friends_friend->next_friend;
486                             }
487 
488                             //if more mutual friends then previous choice,
489                                 //set user_string equal to this user now
490                             if (num_mutual_friends > max_friends) {
491                                 max_friends = num_mutual_friends;
492                             }
493 
494                             //get string for user
495                             user_string = get_user_string(friends_friend->user);
496                             num_suggestions++;
497                             //+3 for \0 and ', '
498                             print_string_len = strlen(user_string) + 3;
498                             print_string_len = strlen(user_string) + 3;
499 
500                             //if length exceeds size of string
501                             if (print_string_len > print_string_size) {
502 
503                                 while (print_string_len >= print_string_size) {
504                                     print_string_size *= 2;
505                                 }
506 
507                                 char* temp_string = calloc(print_string_size + 1, sizeof(char));
508                                 strcpy(temp_string, print_string);
509                                 free(print_string);
510                                 print_string = temp_string;
511                                 temp_string = NULL;
512                             }
513 
514                             //add ", " fot string for formatting
515                             if (strlen(print_string) > 0) {
516                                 strcat(print_string, ", \0");
517                                 //TBR
518                                 //printf("AFTER TACKING ON COMMA!\n");
519                             }
520                             strcat(print_string, user_string);
521                             //TBR
522                             //fprintf(out, "before fail 111\n");
523                             //fprintf(out, "user_string is  %s\n", user_string);
524                             //fprintf(out, "user_string ptr is %p\n", user_string);
525                             free(user_string);
526                             //TBR
527                             //fprintf(out, "after fail 111???\n");
528                             user_string = NULL;
529                         }
530                     }
531 
532                     friends_friend = friends_friend->next_friend;
533                 }
534 
535                 a_friend = a_friend->next_friend;
536             }
537 
538             if (num_suggestions != 0) {
539                 fprintf(out, "%s may know following people because they have %d mutual friend(s):\n%s    ........\n", username, max_friends, print_string);
540             }
541             else {
542                 fprintf(out, "Sorry, there are no friend suggestions for %s.\n", username);
543             }
544 
545             free(print_string);
546             print_string = NULL;
547         }
548         else {
549             fprintf(out, "User %s does not exist. Please try again.\n", username);
550         }
551     }
552     else {
553         fprintf(out, "%s username is not a valid username\n", username);
554     }
555     //printf("EXIT suggest_friends\n");
556 }

//Takes a user_node and returns a char* to a string holding the user's info
771     //in the format name/age/gender/location
772 char* get_user_string(struct user_node *user) {
773     char age[5];
774     sprintf(age, "%d", (user->age));
775     char* gender = NULL;
776 
777     //Female
778     if (user->gender == 0) {
779         gender = "female\0";
780     }
781     //male
782     else {
783         gender = "male\0";
784     }
785 
786     //allocate memory for length of location, name, age, and gender + 3 '/'s + \0
787         //+20 for good measure!!!
788     char* user_string = NULL;
789     user_string = calloc((strlen(user->name) + strlen(user->location) + strlen(age) + strlen(gender)     ........+ 4 + 20), sizeof(char));
790     strcat(user_string, user->name);
791     strcat(user_string, "/");
792     strcat(user_string, age);
793     strcat(user_string, "/");
794     strcat(user_string, gender);
795     strcat(user_string, "/");
796     strcat(user_string, user->location);
797     return user_string;
798 } 
```

当我通过 valgrind 运行它时，我得到以下输出：

```
==10158== Memcheck, a memory error detector
==10158== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==10158== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==10158== Command: ./social_network -f crash_tester.txt crash_test_output.txt
==10158== 
==10158== Invalid write of size 1
==10158==    at 0x402C36B: strcat (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==10158==    by 0x804A434: suggest_friends (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==  Address 0x41f12bb is 0 bytes after a block of size 51 alloc'd
==10158==    at 0x402A5E6: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==10158==    by 0x804A1F3: suggest_friends (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158== 
==10158== Invalid write of size 1
==10158==    at 0x402C390: strcat (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==10158==    by 0x804A434: suggest_friends (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==  Address 0x41f12cf is not stack'd, malloc'd or (recently) free'd
==10158== 
==10158== Invalid read of size 1
==10158==    at 0x4089E29: vfprintf (vfprintf.c:1630)
==10158==    by 0x4091EBE: fprintf (fprintf.c:33)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==  Address 0x41f12bb is 0 bytes after a block of size 51 alloc'd
==10158==    at 0x402A5E6: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==10158==    by 0x804A1F3: suggest_friends (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158== 
==10158== Invalid read of size 4
==10158==    at 0x40C40BC: __GI_mempcpy (mempcpy.S:60)
==10158==    by 0x40B6769: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1350)
==10158==    by 0x4089E01: vfprintf (vfprintf.c:1630)
==10158==    by 0x4091EBE: fprintf (fprintf.c:33)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==  Address 0x41f12bb is 0 bytes after a block of size 51 alloc'd
==10158==    at 0x402A5E6: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==10158==    by 0x804A1F3: suggest_friends (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804B25A: command_read (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049460: read_args_file (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x8049294: switch_parsing (in /home/ethan/cs2506/comp-org-3/social_network)
==10158==    by 0x804ACF7: main (in /home/ethan/cs2506/comp-org-3/social_network)
==10158== 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T01:17:38.440

我相信问题出在这里：

```
print_string_len = strlen(user_string) + 3;

//if length exceeds size of string
if (print_string_len > print_string_size) {

    while (print_string_len >= print_string_size) {
        print_string_size *= 2;
    }

    char* temp_string = calloc(print_string_size + 1, sizeof(char));
    strcpy(temp_string, print_string);
    free(print_string);
    print_string = temp_string;
    temp_string = NULL;
}

//add ", " fot string for formatting
if (strlen(print_string) > 0) {
    strcat(print_string, ", \0");
}
strcat(print_string, user_string); 
```

当您尝试根据缓冲区限制预先检查最终结果长度时，最终结果长度计算不正确。您忘记包含缓冲区的预先存在的内容；例如`strlen(print_string)`。

所以我认为你需要改变：

```
print_string_len = strlen(user_string) + 3; 
```

到：

```
print_string_len = strlen(print_string) + strlen(user_string) + 3; 
```

# c# - 将其分配给新列表对象和复制列表之间的区别

> ID：13635086
> 
> 赞同：0
> 
> 时间：2012-11-29T21:29:23.980
> 
> 标签：c#

这可能是基本问题，但任何人都可以解释这是如何工作的。下面的代码只是示例，但实时这种情况可能会发生在不同的地方。例如：在为具有 Orders 属性的复杂对象（如 Customer）创建 DTO 时。Orders (=List) 是否需要在 Customer 的构造函数中实例化，还是直接将其分配给查询结果或存储过程。

```
List<string> list1 = new List<string>()
{
    "One", "Two","Three"
};

List<string> list2 = new List<string>();
list2 = list1;        
foreach (var s in list2)
  Console.WriteLine(s);

List<string> list3 = list1;
if (list3 != null) //is this the only difference
{
 foreach (var s in list3)     
     Console.WriteLine(s);     
} 
```

我尝试检查 IL 代码，但它不是自我解释的。

```
 IL_0031: stloc.0
    IL_0032: newobj instance void class [mscorlib]System.Collections.Generic.List`1<string>::.ctor()
    IL_0037: stloc.1
    IL_0038: ldloc.0
    IL_0039: stloc.1
    IL_003a: ldloc.0
    IL_003b: stloc.2
    IL_003c: nop
    IL_003d: ldloc.1
    IL_003e: callvirt instance valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<!0> class [mscorlib]System.Collections.Generic.List`1<string>::GetEnumerator()
    IL_0043: stloc.s CS$5$0000 
```

> 我很抱歉发布了一个令人困惑的例子。下面是实际场景

DTO：

```
public class CustomerBO
{
        public CustomerBO()
        {
            Orders = new List<OrderBO>(); 
        }
       List<OrderBO>() Orders { get; set;}
      //other properties of customer
} 
```

现在在 DAL 层：

```
objCustomer.Orders = Repository.GetAll<OrderBO>("dbo.GetOrdersList"); 
```

我的问题是，如果我在 CustomerBO 构造函数中初始化 Orders 对象（或）跳过它并在表示层中检查 null 是否可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:32:22.637

list2：您首先创建一个空列表，然后将其删除并使 list2 指向与 list1 相同的对象。

list3：与list1直接指向同一个对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T21:34:13.960

行：`List<string> list3 = list1;`不是复制列表，它只是复制对列表的*引用*，因为 与`List`C# 中的所有类一样，是一个引用类型。 `list3`不是一个新列表，它只是访问上面相同列表的另一种方式。这可能很好，也可能不是，在一个不太人为的例子中，很难说出你期待什么以及你可能需要什么。

`if (list3 != null) //is this the only difference`

至于你是否需要那条线，这取决于。如果在创建列表和使用它之间执行了一些可能导致`list3`为空的代码，那么检查它可能是一个好主意。没有更“真实”的例子很难说。在给出的示例中，不需要它，因为它`list3`永远不能为空。

另请注意，没有理由`new List<string>()`排队`List<string> list2 = new List<string>();`。您只是立即分配`list1`给`list2`，因此您在使用之前丢弃了新创建的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:33:46.383

您无需重新分配。声明变量时，会保留内存以包含数据的地址。当您执行类似 的分配时`list2 = list1`，您将引用设置为`list2`引用与 相同的内存地址`list1`。

如果您`list2`先初始化，您只是创建了一个对象，该对象将被垃圾收集器回收而不被使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T21:43:46.703

我相信下面的示例可以阐明分配列表对象和创建新列表对象之间的区别：

```
var l1 = new List<string>()
{
    "One", "Two","Three"
};

var l2 = l1;
l1.SequenceEqual(l2);           // true
Object.ReferenceEquals(l1, l2); // true

var l3 = new List<string>();
foreach (var s in l1)
    l3.Add(s);
l1.SequenceEqual(l3);           // true
Object.ReferenceEquals(l1, l3); // false 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T21:51:45.010

```
List<string> list1 = new List<string>()
{
    "One", "Two","Three"
}; 
```

类比：从记事本上撕下一张纸，在最上面写下“这张纸叫做‘list1’”。盖新房子，把“一”、“二”、“三”放在房子里，把房子的地址写在纸上。

```
List<string> list2 = new List<string>(); 
```

类比：从记事本上撕下一张纸，在最上面写下“这张纸叫做‘list2’”。盖一所新房子，把房子的地址写在纸上。

```
list2 = list1; 
```

类比：从名为“list2”的文件中删除地址，并从名为“list1”的文件中复制地址。两份文件现在拥有相同的地址。

含义：建筑部门偶尔会检查每个人的文件。他们去每张纸上的每个地址，并在他们在那里找到的房子上画一个绿色的复选标记。然后他们拆除了所有没有绿色复选标记的房屋。您刚刚创建的房子（您在“list2”纸上覆盖的地址）将在不久的将来被摧毁；没有人会踏入那所房子，而你建造它的努力付诸东流。

```
foreach (var s in list2)
  Console.WriteLine(s); 
```

类比：去“list2”纸上的地址，从房子里取出每件物品，然后打印在报纸上（抱歉，类比不成立！）

```
List<string> list3 = list1; 
```

类比：从记事本上撕下一张纸，在最上面写下“这张纸叫做‘list3’”。将“list1”中的地址复制到这张新的“list3”纸上。

```
if (list3 != null) //is this the only difference
{ 
```

类比：检查“list3”纸上是否写有地址。（顺便说一句，这在这段代码中不是必需的，因为我们可以证明它必须有一个写在上面的地址。）

```
 foreach (var s in list3)     
     Console.WriteLine(s);     
} 
```

类比：到“list3”纸上的地址，从房子里取出每件物品，然后打印在报纸上。当然，此时所有的文件上都有相同的地址，所以你要去同一个房子；因此，您将两次列出同一所房子的内容。

# vba - 如何粘贴到excel中B列的最后一行？

> ID：13635089
> 
> 赞同：3
> 
> 时间：2012-11-29T21:29:35.900
> 
> 标签：vba, excel

我需要将单元格从 H2:L2 一直向下剪切并将其粘贴到 B 列的最后一行。

数据每次都会不同，所以我不能硬编码任何范围。

VBA代码会很好，从H2：L2向下剪切并粘贴/插入B列的最后一行。

到目前为止，我得到了。

```
Range("H2:L2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.Cut 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T21:39:41.620

这是一段应该完成您正在寻找的代码。

```
Start code including your cut segment...
Dim lastRow As String

lastRow = ActiveSheet.Cells(Rows.Count, "B").End(xlUp).Row + 1
Range("B" & lastRow).Select
Selection.PasteSpecial
Rest of code... 
```

有许多书籍可以帮助进行这种类型的编码并进行逐步培训。我偏爱微软“Step by Step”系列出版的系列。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-05T09:01:37.493

请看下面（ps。我没有测试过）

```
Sub copypaste()

Dim wb As Workbook, ws As Worksheet, rng As Range, lr As Long

Set wb = Workbooks("Name_of_your_workbook.xlsm")
Set ws = wb.Sheets("Your_Sheet_Name")

Set rng = ws.Range("H2:L2")

lr = Sheet("Your_Sheet_Name").Cells(Rows.Count, "B").End(xlUp).Row

rng.Copy Destination:=ws.Range("B" & lr)

Cells(1, 1).Select

End Sub 
```

# c# - 使用 Visual Studio 2010 处理顺序工作流时的 while 活动问题

> ID：13635092
> 
> 赞同：0
> 
> 时间：2012-11-29T21:29:52.157
> 
> 标签：c#, visual-studio-2010, sharepoint

我正在使用 Visual Studio 2010 处理顺序工作流程。在 while 循环中定义了一个办公室任务。在 while 循环之后，我定义了一个 IfElse 活动，在其中我定义了另一个 while 活动。我正在尝试调试应用程序，但它没有命中在第一个 while 循环之后定义的 if else 活动。我不确定问题可能是什么。

# php - PHP 5.4.4-9（debian 测试）- require_once 不递归地提取文件

> ID：13635101
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:30:39.380
> 
> 标签：php

在尝试实现使用类 B 的类 A 时，我遇到了一种意外行为。以下是文件的内容：

```
> cat test.php
<?php

error_reporting(E_ALL);
require_once("A.php");
//require_once("B.php"); //now it'd work, but it's not the point

$a = new A();
$b = $a->getB();
var_dump($b);
$b->sayHi();
> cat A.php
<?php

require_once('B.php');

class A
{
        private $b;

        public function getB()
        {
                return $this->b;
        }

        public function __construct()
        {
                $b = new B();
        }
}
> cat B.php
<?php

class B
{
        public function sayHi()
        {
                echo "Hi!";
        }
}
> php test.php
NULL
PHP Fatal error:  Call to a member function sayHi() on a non-object in /var/www/przypadek_testowy/test.php on line 10 
```

是否有一些我应该知道的 PHP 怪癖？在这种情况下，在 test.php 中要求 B.php 很难看，我更喜欢更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:33:17.317

替换`$b = new B();`为：`$this->b = new B();`在您的`A`班级中。

另请参阅这[`require_once`](http://php.net/require_once)是一个语句，而不是一个函数。所以你可以不带引号使用它。

# ruby - Finding Records From This Month Datamapper with Sinatra

> ID：13635107
> 
> 赞同：0
> 
> 时间：2012-11-29T21:31:29.517
> 
> 标签：ruby, sinatra, datamapper

I'm building a little Sinatra web app at the moment and having problems understanding queries with DataMapper.

I have a field in my database which I've called date, I'd love to query this and only return records from this current month.

I've tried this:

> query = "2012-11"
> 
> @trips = Trip.all(:date.like => '%query%')

Which doesn't seem to work, I'm hoping someone might spot my error and give me some guidance! Hope someone can help, thanks for taking the time to read.

Dave

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:35:44.103

改为提供一个范围：

```
@trips = Trip.all(:date => (query..query)) 
```

我还将修复您的日期格式并提供月、日和年。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:47:13.497

你可以试试这个：

```
require 'date'

date_c = Date.today
next_y, next_m = date_c.month == 12 ?
  [date_c.year+1, 1] : [date_c.year, date_c.month+1]
date_a = Date.new(date_c.year, date_c.month)
date_z = Date.new(next_y, next_m)

Trip.all :date => date_a..date_z 
```

这将返回当前月份条目

# sql - How to 'remember' a value to insert into two tables in sqlite?

> ID：13635108
> 
> 赞同：2
> 
> 时间：2012-11-29T21:31:33.090
> 
> 标签：sql, sqlite

I have a trigger that I want to insert the same random value into two tables. How do I do this?

```
CREATE TRIGGER insertTrigger AFTER INSERT ON TableAB 
BEGIN
    INSERT INTO TableA(id, num) VALUES(RANDOM(), 1);
    INSERT INTO TableB(id, num) VALUES(??, 1);
END;
```

I am not really using Random, but my own custom sqlite function which essentially does the same thing, but I need to remember that value to insert into TableB. How do I do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T11:12:14.807

SQLite 没有变量之类的东西，但您可以从刚刚插入第一个表的记录中读取值：

```
CREATE TRIGGER insertTrigger
AFTER INSERT ON TableAB
BEGIN
    INSERT INTO TableA(id, num) VALUES(RANDOM(), 1);
    INSERT INTO TableB(id, num) SELECT id, 1
                                FROM TableA
                                WHERE rowid = last_insert_rowid();
END; 
```

# c# - Populating a DataGridViewComboBoxColumn with dictionary keys and values

> ID：13635109
> 
> 赞同：3
> 
> 时间：2012-11-29T21:31:42.423
> 
> 标签：c#, winforms, ado.net

I have a dictionary that has as its keys a three letter country code, and as its values the name of the country.

```
Dictionary<string, string> CountryList=new Dictionary<string, string>(); 
```

I also have a DataGridView and a DataTable. What I'd like to do is to create a DataGridViewComboBoxColumn for certain columns in my DataTable-columns that display country information. So, for example, one of my columns in my DataTable is called `Country`, and I'd like for that column to have a drop down combo box that displays the name of the country, and that when selected, populates the cell in the DataTable with the key from the dictionary (the three letter code). However, I'm totally stumped as to how to do this. Do I have to set the DataSource to the keys, and the DisplayMember to the values? I tried that, and got an error:

```
DataGridViewComboBoxColumn buildCountries = new DataGridViewComboBoxColumn();
buildCountries.HeaderText = "List of Countries";
buildCountries.DataSource = CountryList.Keys.ToString();
buildCountries.DisplayMember = CountryList.Values.ToString(); 
```

> Complex DataBinding accepts as a data source either an IList or an IListSource

I'm not sure how to go about doing this.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T21:40:29.217

使用`Keys.ToString()`，您正在创建一个表示 Keys 集合的字符串，而不是获取键列表。这将返回：

> System.Collections.Generic.Dictionary'2+KeyCollection[System.String,System.String]

DisplayMember 是 DataSource 中应显示在 ComboBox 中的每个项目的属性名称 - 这应该是`"Value"`。

尝试这个：

```
Dictionary<string, string> CountryList=new Dictionary<string, string>();

DataGridViewComboBoxColumn buildCountries = new DataGridViewComboBoxColumn();
buildCountries.HeaderText = "List of Countries";
buildCountries.DataSource = CountryList.ToArray();
buildCountries.ValueMember = "Key";
buildCountries.DisplayMember = "Value"; 
```

`CountryList.ToArray()`会给你一个`KeyValuePair<string, string>`s 数组，它确实实现了 IList。

如果要获取所选国家/地区代码，请使用`buildCountries.SelectedValue`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T21:59:31.157

我不是 100% 肯定的，但我认为您将无法按照您尝试的方式完成此操作。我知道这可能被认为是重型火炮，但您可以从中创建一个`DataTable`并对其`Dictionary`进行操作`DataBinding`。

```
DataGridViewComboBoxColumn buildCountries = new DataGridViewComboBoxColumn();
buildCountries.HeaderText = "List of Countries";
DataTable dataTable = new DataTable();
dataTable.Columns.Add("Keys");
dataTable.Columns.Add("Values");
KeyValuePair<string, string> [] array = CountryList.ToArray();
foreach(KeyValuePair<string, string> kvp in array)
{
        dataTable.Rows.Add(kvp.Key, kvp.Value);
}
buildCountries.DataSource = dataTable;
buildCountries.DisplayMember = "Values";
buildCountries.ValueMember = "Keys";
dataGridView1.Columns.Add(buildCountries); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-25T01:33:43.430

您可以使用以下内容将字典设置为 DataGridViewComboBoxColumn 的数据源

```
 buildCountries .DisplayMember = "Key";
 buildCountries .ValueMember = "Value";
 buildCountries .DataSource = new BindingSource(CountryList, null); 
```

# javascript - Mongoose JS path default generating id

> ID：13635114
> 
> 赞同：1
> 
> 时间：2012-11-29T21:32:05.153
> 
> 标签：javascript, node.js, mongoose

Take a look at the following schema:

```
var userSchema = new mongoose.Schema({
  fullName: {
    type: String,
    required: true,
    index: true
  },
  activationId: {
    type: mongoose.Schema.ObjectId
  }
});

userSchema.path('activationId').default(function() {
  return new mongoose.Schema.ObjectId.fromString('actvt');
}); 
```

It is about the "activationId", I want to generate an ID (unique code, objectID prefered since that is already built-in Mongoose) once a user gets created, so if I have the following code:

```
var newUser = new User({
  fullName: 'Rick Richards'
});

newUser.save(function(error, data){
  console.log(data.activationId); // Should give the activationId
}); 
```

But this solution gives me the following error:

```
TypeError: undefined is not a function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:21:06.240

您可以通过为作为构造函数的字段定义一个`default`属性来做到这一点：`activationId``ObjectId`

```
var userSchema = new mongoose.Schema({
  fullName: {
    type: String,
    required: true,
    index: true
  },
  activationId: {
    type: mongoose.Schema.ObjectId
    default: mongoose.Types.ObjectId
  }
}); 
```

# c - 在 for 循环中使用 fork() 创建子项以运行 execlp()

> ID：13635116
> 
> 赞同：0
> 
> 时间：2012-11-29T21:32:08.697
> 
> 标签：c, linux, for-loop, exec, fork

我正在编写一个将运行 Linux 命令的 C 程序，例如：

> $ 猫 /etc/passwd | 切-f1 -d：| 种类

这个想法是使用 fork() 创建子进程以使用 execlp() 运行命令。我计划使用两个管道进行通信并使用 dup() 引导输入输出。

输出错误：

> ls -l | wc -c on 命令返回 1746 程序返回 1761

代码（编辑以反映建议）：

```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <limits.h>

int main()
{
  int i,fd1[2],status,listpid[2];
  pid_t child;
  pipe(fd1);

  for(i=0; i< 2; i++)
  {
    printf("\ncreating child\n");
    if((child = fork()) == -1)
    {
      perror("fork");
      exit(EXIT_FAILURE);

    }
    else if(child == 0)
    {
      if(i == 0)
      {
    close(1); dup(fd1[1]);
    close(fd1[0]);
    close(fd1[1]);
    printf("\nrunning ls -l\n");
    fflush(stdout);
    execlp("ls","ls","-l", (char *)NULL);
    exit(EXIT_SUCCESS);

      }
      else if(i == 1)
      {
    close(0); dup(fd1[0]);
    close(fd1[1]);
    close(fd1[0]);
    printf("\nrunning wc -c\n");
    fflush(stdout);
    execlp("wc","wc","-c", (char *)NULL);
    exit(EXIT_SUCCESS);

      }

    }
    else
    {
      listpid[i]=child;
    }

  }

  close(fd1[0]);
  close(fd1[1]);

  for(i = 0; i < 2; i++) 
  {
    waitpid(listpid[i], &status, 0);

    if(WIFEXITED(status)) 
    {
      printf("\n[%d] TERMINATED (Status: %d)\n",listpid[i], WEXITSTATUS(status));

    }

  }
  exit(EXIT_SUCCESS);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:51:23.947

首先，您不能在循环中 waitpid ——如果 ls 的输出足够大，它将填满管道，因此在有人读取它之前它不会完成：您必须在 for 循环之后等待两个孩子。其次——只要管道的另一端打开，wc 就会继续运行，也就是说，您也必须关闭父管道中的管道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T07:06:32.643

更新后，两个子进程的行为正常。但是，您仍然需要添加：

```
close(fd1[0]);
close(fd1[1]); 
```

在`for`启动子项的`for`循环和收集退出状态的循环之间。

因为管道的写端仍然是打开的，`wc`没有收到EOF，所以它没有终止，所以你的进程无限期地等待。

# facebook - Facebook-SDK: $_REQUEST['signed_request'] vs. $facebook -> getSignedRequest()

> ID：13635117
> 
> 赞同：1
> 
> 时间：2012-11-29T21:32:18.260
> 
> 标签：facebook, facebook-php-sdk

Can somebody explain me what the difference between those two is? I thought they should return the same values, but what I get is:

$REQUEST['signed_request']

```
 NAqZcEqPisfOqf_3SyKf_zvLyiE_gjpyQIknmQ1xXpQ.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImFwcF9kYXRhIjoiMTAwMDAxNDcwODI3NzQxIiwiZXhwaXJlcyI6MTM1NDIzMDAwMCwiaXNzdWVkX2F0IjoxMzU0MjI0NDAyLCJvYXV0aF90b2tlbiI6IkFBQUdEMzVJM0k3VUJBRDZ3a1pCWkJXbFhidUFuUEdVMERTUW93R1pCSUI1NDE1Zkt1RjdaQ1JrNjFaQWF4ZExBeHVIRWNYS2N2WkJBSlRtN01BOGx3YmZaQXIyRWhtWkFNY3JkQXQ2WkNZZ3lTdFFaRFpEIiwicGFnZSI6eyJpZCI6IjQwMDQ3MDE3MDAwOTQ4NSIsImxpa2VkIjp0cnVlLCJhZG1pbiI6dHJ1ZX0sInVzZXIiOnsiY291bnRyeSI6ImRlIiwibG9jYWxlIjoiZW5fVVMiLCJhZ2UiOnsibWluIjoyMX19LCJ1c2VyX2lkIjoiNjA0MjA3Njk0In0 
```

and getSignedRequest()

```
Array ( [algorithm] => HMAC-SHA256 [app_data] => 100001470827741 [expires] => 1354230000 [issued_at] => 1354224402 [oauth_token] => AAAGD35I3I7UBAD6wkZBZBWlXbuAnPGU0DSQowGZBIB5415fKuF7ZCRk61ZAaxdLAxuHEcXKcvZBAJTm7MA8lwbfZAr2EhmZAMcrdAt6ZCYgyStQZDZD [page] => Array ( [id] => 40047123009485 [liked] => 1 [admin] => 1 ) [user] => Array ( [country] => de [locale] => en_US [age] => Array ( [min] => 21 ) ) [user_id] => 2237694 ) 
```

Edit: Thanks to yellow I found out that the former is base64encoded. It can be decoded using this [function](https://developers.facebook.com/docs/howtos/login/signed-request/):

```
function parse_signed_request($signed_request) {
 list($encoded_sig, $payload) = explode('.', $signed_request, 2); 

 // decode the data
 $sig = base64_url_decode($encoded_sig);
 $data = json_decode(base64_url_decode($payload), true);

 return $data;
}

function base64_url_decode($input) {
  return base64_decode(strtr($input, '-_', '+/'));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:06:12.747

难道 $REQUEST['signed_request'] 是 base64url 编码的吗？您可以在此站点上阅读有关 signed_request 的更多信息：[https ://developers.facebook.com/docs/howtos/login/signed-request/](https://developers.facebook.com/docs/howtos/login/signed-request/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:10:22.720

getSignedRequest() 返回 $REQUEST['signed_request'] 的解析版本，这意味着它已被解码并验证哈希是否有效，以确保请求实际上来自 Facebook。

# .net - Jenkins + SVN + .NET 项目 + 代码审查。最好的方法是什么？

> ID：13635119
> 
> 赞同：5
> 
> 时间：2012-11-29T21:32:22.460
> 
> 标签：.net, git, svn, msbuild, jenkins

将 .NET 项目与 Jenkins 和 SVN 集成的最佳方法是什么（我不知道现在是否有机会切换到 git）并能够在构建之后和生产之前查看代码。

我想要这样的东西：

1.  开发人员签出存储库。
2.  开发人员实现了一些东西。
3.  开发人员将更改提交到存储库 A (SVN)
4.  Jenkins 监控存储库 A (SVN)
5.  Jenkins 开始构建。
6.  Jenkins 开始单元测试。
7.  一切都好。
8.  Jenkins 提交对存储库 B 的更改。（审查存储库）
9.  QA 人员审查代码。
10.  QA 人员提交对存储库 C 的更改（生产）

6a。并非一切都好。6b。Jenkins 向开发人员发送通知，他的提交破坏了构建，我们回到第 2 步。

我知道如何执行步骤 1-6。或多或少。我知道我可以用 MSBuild 构建所有东西，所以这应该不难，但我不知道如何配置步骤 6-9，

吉特：

我认为使用 git 会容易得多。我看到在构建后操作中有 Git Publisher，我可以将更改推送到分支 - “review-branch”或类似的东西，并向审阅者发送通知。他们将提取存储库，一切都会很棒。嗯，詹金斯也应该向该分支创建拉取请求，而不是推动审查分支。但正如我所说，这将是 git 的场景。我在这里写了它，因为对我来说 git 在这里是更好的选择，但也许不可能。我只是想知道如果我们在谈论 git，我是否没有遗漏一些东西。

SVN：

在这里，我不知道该怎么做。Jenkins 是否有内置的东西来处理“推送”到第二个 SVN 存储库？如何将代码提交到存储库 B？

评论：最好的方法是什么？- (GIT) Jenkins 创建拉取请求 - 如果可能 - (GIT) Jenkins 推送到第二个审查分支并通过电子邮件发送通知或在某些问题跟踪器 (Redmine/Jira) 上创建一些票证 - (SVN) Jenkins 承诺审查存储库并发送电子邮件或创建票证。- 或者最好将所有内容与 ReviewBoard/Gerrit 或类似的东西集成。现在我从来没有使用过这样的软件，我读到 Gerrit 有点麻烦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T18:29:51.967

您需要记住一些事情：

> 在版本控制系统中，*一切都是可逆的*

这意味着您可以对提交的代码进行代码审查，并在新的提交中修复任何问题。事实上，这实际上对 Subversion 有好处，因为 Subversion 为您提供了一个包含所有代码更改的漂亮修订号。这样，每个人都在同一个页面上。（*“我们正在审查修订版 23,340”*）。大多数代码审查都在寻找忘记检查空指针等问题。如果代码真的很糟糕，Subversion 可以很容易地完全逆转更改。

Jenkins 会立即告诉您构建是否有问题，我们的政策是开发人员有 10 分钟的时间来解决问题，或者撤回他们的更改。（90% 的情况下，他们会撤回更改）。我们有我们的系统设置，因此开发人员和 Jenkins 都使用相同的构建机制。这允许开发人员在提交更改之前测试构建并运行单元测试。

这就是为什么大多数版本控制系统没有*搁置*，并且您看不到三组存储库和大多数地方的原因。这不是你的公寓。你妈妈不会来看你的代码历史的。它不必漂亮和整洁。让它反映正在发生的事情。

简化。删除最后三个步骤。进行代码审查并在同一存储库中修复代码。这意味着必须维护的存储库减少了 66%。硬件减少 66%。和，

* * *

您真正需要的只是一种跟踪代码审查的方法。您可以使用[Crucible 之](http://www.atlassian.com/software/crucible/overview)类的东西，但也可以使用 Jenkins。使用 Jenkins 跟踪更改有两种方法：

*   **为各个构建添加描述**：操作简单，不需要额外的插件。描述灵活。您可以进入一个项目，查看所有构建的列表并查看描述。简单易行。
*   **升级的构建插件**：其中有两种：一种是标准的，一种是*简单*的。

[推广](https://wiki.jenkins-ci.org/display/JENKINS/Promoted+Builds+Simple+Plugin)的构建简单插件......嗯......很简单。您在 Jenkins 配置页面中指定所有不同的提升级别，这就是所有构建将使用的。每个单独的构建只允许一个升级级别，并且这一切都是手动完成的。

标准的[升级构建插件](https://wiki.jenkins-ci.org/display/JENKINS/Promoted+Builds+Plugin)需要更多的工作，但它也更强大。它允许每个 Jenkins 作业都有自己的构建提升方案。促销可以是手动的也可以是自动的。当构建被*提升*时，它可以产生其他操作，例如发送电子邮件、部署到服务器等。另外，您可以显示多个提升。想象一下以下促销级别：

*   **构建通过单元测试**：构建完成并通过其单元测试时自动升级。可以向负责代码审查的 QA 人员发送一封电子邮件：
*   **代码审查完成。没有大问题**：构建通常很好。也许有一些小问题，但这个构建可以用于部署到其他环境以进行进一步测试。
*   **代码审查已完成：发现重大问题**：此版本存在重大问题，不应视为已准备好部署到另一个环境以进行进一步测试。
*   **开发人员修复了此构建中发现的问题：**构建仍然很糟糕，但至少您知道开发人员声称可以处理此构建中的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T16:30:22.357

[回答“可以做到”部分]

是的，詹金斯可以做你描述的事情。我已经使用 SVN 为存储库设置了使用所有需要的部分的作业（但不是您的过程）。我不确定GIT。

> 1.  Jenkins 开始单元测试。

添加构建步骤以执行 Windows 批处理文件。

> 1.  Jenkins 提交对存储库 B 的更改。（审查存储库）

如果使用 SVN，请查看[Jenkins SVN Publisher Plugin](https://wiki.jenkins-ci.org/display/JENKINS/SVN+Publisher)。对于 GIT，它似乎可以使用[Git 插件](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin)，但有一个小警告：“安装插件本身就像一个魅力，但配置系统以在 Windows 下正常工作可能会很棘手。让我们看看你可能遇到的问题。”

# c++ - && || 操作员交互

> ID：13635121
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:32:33.090
> 
> 标签：c++, logical-operators, operator-precedence

我需要知道如何在语句中评估逻辑 AND 和 OR 运算符。我找到了一些试图解释它的网站，但我无法对它们做出正面或反面。我知道我可以使用大括号来按我想要的方式订购它，但我想了解它是如何工作的。

例如会

```
if( b1 && b2 || b3 ) 
```

被评估为：

```
(b1 && b2) || b3 
```

或作为：

```
b1 && (b2 || b3) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T21:33:45.643

您可以在任何优先级高于的[运算符优先级表](http://en.cppreference.com/w/cpp/language/operator_precedence)中找到，这意味着它被评估为`&&``||`

```
(b1 && b2) || b3 
```

请注意，两者`&&`和`||`都是短路的，这意味着不必评估`b2`and 。`b3`例如，如果`b1`评估为`false`，`b2`则根本不会评估。此外，如果`b1 && b2`评估为`true`，`b3`则不会被评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:46:48.380

`&&`并在这方面工作`||`。`*``+`

# sql-server - WHERE - 操作顺序

> ID：13635122
> 
> 赞同：1
> 
> 时间：2012-11-29T21:32:36.337
> 
> 标签：sql-server, sql-server-2008-r2, operator-precedence

[这个](https://stackoverflow.com/questions/10552817/shorthand-if-statements-in-sql/10552851#10552851)问题的评论：

> 不要依赖短路......可以按照 SQL Server 认为合适的任何顺序评估这些子句。

因为它与这个答案有关：

```
SELECT * FROM TABLE WHERE (@vari is null or col = @vari) 
```

1.  它是否正确？
2.  是否有一个很好的测试设置，也许在 SQL fiddle 中，可以重现这种现象？（使用这个词很松散）
3.  这只发生在 WHERE 子句中吗？或者也许只有 AND/OR 运算符？

我问这个是因为我没有在网上找到任何*明确*说明这一点的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:35:27.783

在这里阅读

> [http://connect.microsoft.com/SQLServer/feedback/details/537419/sql-server-should-not-raise-illogical-errors](http://connect.microsoft.com/SQLServer/feedback/details/537419/sql-server-should-not-raise-illogical-errors)

[SQLFiddle](http://www.sqlfiddle.com/#!6/436ca/1)

样品设置

```
create table albert(a int NOT NULL,
                        b varchar(23) NOT NULL)
create table stina (a int NOT NULL)
go
insert albert (a, b)
     values (1, '99'),
             (2, 'Gurka'),
             (3, '89')
insert stina (a) values(1), (3), (9), (12)
go

SELECT a.a, a.b + 100
FROM albert a
JOIN stina s ON s.a = a.a 
```

# solr - 突出显示 Solr 字段

> ID：13635128
> 
> 赞同：2
> 
> 时间：2012-11-29T21:33:06.427
> 
> 标签：solr, highlighting, solrj

我正在尝试正确配置/查询 Solr（通过 SolrJ）以执行以下操作：

*   提供热门片段
*   突出显示字段中的搜索词

我的片段工作正常，但我不知道如何让 Solr 突出显示字段中的搜索词。[Solr 突出显示](https://stackoverflow.com/questions/5152900/solr-highlighting)建议在片段中返回整个字段而不返回任何字段（以避免重复），但是我会丢失正在工作的片段。

有没有办法让 Solr 提供片段（突出显示）并突出显示完整字段文本中的搜索词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:17:58.470

基于[突出显示参数](http://wiki.apache.org/solr/HighlightingParameters)的各种设置，我认为您不能在单个 Solr 查询中执行此操作，主要是因为突出显示片段大小只能指定一次，而不是基于每个字段。您需要向 Solr 发出两个单独的查询：

1.  查询 1：为您的代码段指定的突出显示选项`&hl.fragsize=<small number>`
2.  查询 2：为完整字段文本指定的突出显示选项`&hl.fragsize=0&hl.maxAnalyzedChars=<some very large number>`。

对于需要突出显示的片段和突出显示同一字段的全文的用例是什么？是否可以根据用户交互将其分解为两个单独的调用？我猜您可能会显示带有片段的搜索结果，然后允许用户在单击结果后查看整个文本......也许？

# javascript - 使用javascript执行服务器端ruby文件

> ID：13635133
> 
> 赞同：1
> 
> 时间：2012-11-29T21:33:26.923
> 
> 标签：javascript, html, ruby

我的服务器上有一个 ruby​​ 文件（一个简单的测试文件）。我想知道如何使用 javascript 通过单击按钮在服务器上执行该文件。没有什么我想要的，比如 rails 或 asp 或 php。这只是一个小测试，我想看看它能走多远。在终端上，我所要做的就是`ruby test.rb`. 有没有办法在 html 页面上使用 javascript 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:37:35.740

调整脚本，以便您的网络服务器可以使用[Rack](http://en.wikipedia.org/wiki/Rack_%28web_server_interface%29)或[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)访问它。

然后你只需要向它发出一个 HTTP 请求。您可以设置`location = URI`、调用`submit()`表单、使用`XMLHttpRequest`或许多其他选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:37:36.380

好吧，浏览器不运行 Ruby，所以我认为您需要通过单击该按钮向您的服务器发送请求，然后服务器将运行该文件。

试试 Sinatra：[http ://www.sinatrarb.com/](http://www.sinatrarb.com/)

# jquery - 为什么所有 LI 都以最大宽度消耗？

> ID：13635136
> 
> 赞同：0
> 
> 时间：2012-11-29T21:33:44.957
> 
> 标签：jquery, html, css

**编辑**：JSFIDDLE：http: [//jsfiddle.net/mHWqX/](http://jsfiddle.net/mHWqX/)

它的作用：

![在此处输入图像描述](../Images/c877e130ac6adaa8ff8f130b4bd9cab7.png)

如何避免每个 LI 遵循相同的宽度/填充？我想要在悬停中类似的东西：

```
||||||||||
|||||||||| Regular
||||||||||
||||||||||||||||||||
|||||||||||||||||||| Hover
||||||||||||||||||||
||||||||||
|||||||||| Regular
||||||||||
||||||||||
|||||||||| Regular
||||||||||
||||||||||
|||||||||| Regular
|||||||||| 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:39:10.303

更新/工作版本：http: [//jsfiddle.net/mHWqX/2/](http://jsfiddle.net/mHWqX/2/)

解决方案非常简单：将样式设置在锚上而不是 li 上。这将导致所有 lis 的宽度仍在增长，但由于样式位于 上`a`，因此只有“活动”锚点会增长。

# javascript - 如何在 SVG 动画期间获取元素的坐标

> ID：13635143
> 
> 赞同：0
> 
> 时间：2012-11-29T21:33:58.857
> 
> 标签：javascript, animation, svg

我有这样的代码：

```
<defs>
    <g id="g0">
        <circle cx="0" cy="1" r="16" fill="blue" id="pr0" stroke-width="0" stroke="#2986dc"/>
        <circle cx="0" cy="0" r="14" fill="red" id="pp0" />
    </g>
</defs>
<use x="603" y="484" id="u0" href="#g0">
    <animateTransform attributeName="transform" attributeType="XML" type="rotate" id="t0" dur="30s" repeatCount="indefinite" from="0 494 494" to="360 494 494"/>
</use> 
```

如何使用 JavaScript 在动画期间获取组的坐标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:27:15.303

[SVG 1.2 Micro DOM](http://www.w3.org/TR/SVGTiny12/svgudom.html)提供了访问动画值的`get*PresentationTrait*()`方法类，但我认为浏览器还不支持它们。所以也许最简单的方法是使用 JavaScript 动画。

# python - 将 Pygame 与 PyPy 一起使用

> ID：13635144
> 
> 赞同：7
> 
> 时间：2012-11-29T21:34:04.303
> 
> 标签：python, pygame, pypy

我对 python 很陌生，但我想通过制作游戏来学习它，而 pygame 似乎是最好的选择。由于 PyPy 是 Python 的最快实现（我认为），我决定使用它。但我不知道如何让这两者一起工作。

我在窗户上。

如果有人这么好心地一步一步地告诉我我需要做什么，我将非常感激。

到目前为止，我已经安装（解压到文件夹）PyPy，将 pypy.exe 设置为默认打开 .py 文件，安装 Pygame 并尝试运行示例 .py 文件之一。我在文件中的第一行导入时收到“找不到模块 pygame”错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T21:42:14.293

pygame 与 pypy 不[兼容](https://bitbucket.org/pypy/compatibility/wiki/Home#!pygame-pygame)，因此要使用它，您必须坚持使用 cPython。

* * *

**更新（2018 年 4 月）**：

[正如在这个答案](https://stackoverflow.com/a/50045201/1350899)中所指出的，PyPy [v6.0](https://morepypy.blogspot.co.at/2018/04/pypy27-and-pypy35-v60-dual-release.html)版本现在可以与 pygame 一起使用——虽然还没有与当前的稳定版本（pygame 1.9.3）一起使用，但与当前的开发分支（1.9.4.dev0）一起使用。

通过以下方式在 ubuntu 17.10 上测试：

*   [下载](http://pypy.org/download.html)并解压最新的 linux 预编译版本
*   安装 pygame 的构建依赖项：`sudo apt build-dep python-pygame`
*   安装点子：`./bin/pypy3 -m ensurepip`
*   安装pygame：`./bin/pypy3 -m pip install 'Pygame>=1.9.4.dev0'`
*   运行演示：`./bin/pypy3 -m pygame.examples.aliens`

适用于 pypy3 和 pypy2 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T21:58:23.173

Pygame 游戏实际上花费很少的时间来运行 python 代码。绝大多数人都花在了 SDL`fill`和`flip`运营上。大多数`fill`s 是不必要的。这有多重要？好吧，拿走我的电脑。假设您编写了一个游戏，该游戏有一个循环，只为背景绘制一种颜色。它将获得大约 40 fps。这是因为它基本上是单独访问每个像素并写入它。这是每帧使用 200 x 300 = 60000 次操作，*什么都不做。*

因此，不要绘制整个背景，只需绘制在前一帧上绘制的部分。

这会使您的代码更加复杂，但会产生*巨大*的性能提升。

另外，不要忘记运行[cProfile](http://docs.python.org/2/library/profile.html)以查看问题区域在哪里。看，不要猜。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-26T14:10:38.537

看起来 PyPy v6（2018 年 4 月）将改善这种情况并使 PyPy 与 PyGame 和其他 C python 扩展兼容。有关示例，请参见[https://renesd.blogspot.co.uk/2018/03/pygame-on-pypy-usable.html 。](https://renesd.blogspot.co.uk/2018/03/pygame-on-pypy-usable.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-04T05:45:05.460

我们目前在包索引上还没有 PyPy 的二进制文件。所以你需要从源码编译pygame，而不是仅仅使用pip来安装pygame。

获取 PyPy 版本 6+（或每晚下载一个）。

windows上从源码编译的说明可以使用：[https ://www.pygame.org/wiki/CompileWindows](https://www.pygame.org/wiki/CompileWindows)

只需使用`pypy3`二进制而不是那个`python`。

# .net - Powershell SQL Server 2008 远程数据库备份

> ID：13635145
> 
> 赞同：3
> 
> 时间：2012-11-29T21:34:04.847
> 
> 标签：.net, sql-server-2008, powershell, smo

我正在尝试将 LAN 上的远程数据库备份到网络共享驱动器。我使用 .NET 使用相同的方法进行了测试，它确实有效，但我计划在没有 Jenkins 持续集成工具的情况下使用这个 PowerShell 脚本。

```
$dbserver = "dbserver"
$location = "\\otherserver\Temp\"
$user = "user"
$pwd = "password"

$timestamp=((get-date).toString("yyyy_MM_dd_hh_mm"))
$file = $location + "jira_" + $timestamp + ".bak"

[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.Smo") | Out-Null
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.SmoExtended") | Out-Null
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.ConnectionInfo") | Out-Null

$connection = New-Object "Microsoft.SqlServer.Management.Common.ServerConnection" 
$connection.ServerInstance =$dbserver
$connection.LoginSecure = $false
$connection.Login = $user 
$connection.Password = $pwd

$server = New-Object "Microsoft.SqlServer.Management.Smo.Server" $connection
$backup = New-Object "Microsoft.SqlServer.Management.Smo.backup"
$backup.Action = 'Database'

$device = New-Object ('Microsoft.SqlServer.Management.Smo.BackupDeviceItem') ($file, 'File')
#$device.DeviceType = 'File'
#$device.Name = $file

$backup.MediaDescription = "Disk"
$backup.Database= "jira"
$backup.Devices.Add($device)
$backup.SqlBackup 
```

我没有收到任何异常，但也没有任何信息可以帮助我对代码进行故障排除。使用所有可用的 throw, catch, try 我只能得到。

```
MemberType          : Method
OverloadDefinitions : {System.Void SqlBackup(Microsoft.SqlServer.Management.Smo.Server srv)}
TypeNameOfValue     : System.Management.Automation.PSMethod
Value               : System.Void SqlBackup(Microsoft.SqlServer.Management.Smo.Server srv)
Name                : SqlBackup
IsInstance          : True 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T03:39:18.757

SqlBackup is a method. When you call a method you need to include opening and closing parenthesis:

```
$backup.sqlbackup($server) 
```

Omitting the parens will output the method signature instead of calling the method. Omitting the method signature is not an error hence no error.

# javascript - jQuery选择选项值

> ID：13635148
> 
> 赞同：3
> 
> 时间：2012-11-29T21:34:16.753
> 
> 标签：javascript, jquery

当没有城市选项时，如何将“城市”值设置为与国家/地区值相同的值？

例如，贝宁没有在其中选择城市的选项。在此链接[http://jsfiddle.net/yPb6N/1/](http://jsfiddle.net/yPb6N/1/)上，如果您选择“贝宁”，它会在下拉列表下方显示`Benin undefined`。你如何让它显示`Benin Benin`？

```
<select id="country-select">
    <option value="us">US</option>
    <option value="germany">Germany</option>
     <option>Ireland</option>
    <option>Benin</option>
    <option>Italy</option>
</select>

<select id="us-select" class="sub-menu hide">
    <option value="austin">Austin</option>
</select>

<select id="germany-select" class="sub-menu hide">
    <option value="berlin">Berlin</option>
</select>
<p></p>
<font size="5"><font color="red"><div class="countryvalue" >Value</div></font></font> <br/>
​

function countrySelectChanged() {
    $('.sub-menu').hide();
    var selectedCountry = $('#country-select').val();
    if (selectedCountry) {
        $('#' + selectedCountry + '-select').show();
    }
}

$(document).ready(function() {

    $('#country-select').change(countrySelectChanged );
     countrySelectChanged();

    $("#country-select").change(function () {
          var str = $('#country-select').val() + " " + $("#" + $("#country-select option:selected").val()  + "-select option:selected").val();
          $("#country-select option:selected").each(function () {
            });
          $(".countryvalue").text(str);
        })
        .change();
    });
​

.hide {
display: none;            
}​ 
```

我的代码不起作用

```
 if (($('#country-select').val() != "us") || ($('#country-select').val() != "germany")) {
    $("#" + $("#country-select option:selected").val() + "-select option:selected").val() == $('#country-select').val();
} 
```

谢谢 ：-）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:50:07.427

这一行：

```
var str = $('#country-select').val() + " " + $("#" + $("#country-select option:selected").val()  + "-select option:selected").val(); 
```

需要类似于：

```
var country = $('#country-select option:selected').val();
var city = $("#" + country  + "-select option:selected").val() || country;
$(".countryvalue").text(country + " " +city); 
```

这样，如果城市名称不存在，它将使用国家名称。此外，它不会为同一个元素执行多个选择器，这很浪费。

[这是更新的小提琴。](http://jsfiddle.net/yPb6N/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:58:05.040

基本上@Aesthete 所说的，我只是重构了整个函数（花了几分钟），也许你喜欢它（我更新了小提琴：http: [//jsfiddle.net/yPb6N/4/](http://jsfiddle.net/yPb6N/4/)）：

```
$(document).ready(function() {
  var country
    , city
    , $selected
    , $cs = $('#country-select')
    , $cv = $(".countryvalue");  
  $cs.on('change', function() {
      country = $cs.val() || $cs.text();
      $selected = $cs.find(':selected');
      city = $selected.val() || $selected.text();
      $('.sub-menu').addClass('hide');
      if($selected.val()) { 
        $('#' + $selected.val() + '-select').removeClass('hide');
        city = $('#' + $selected.val() + '-select').val() || country;
      }
      $cv.text(country + ' ' + city);
  });
  $cs.trigger('change');    
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:48:42.080

如果没有与该国家/地区关联的城市，我想您只想打印国家/地区名称。如果是这样，我创建了这个小提琴：http: [//jsfiddle.net/scaillerie/tSgVL/1/](http://jsfiddle.net/scaillerie/tSgVL/1/)。

实际上，您必须测试与您所在国家/地区关联的列表是否存在：

```
hasCity = $("#" + $("#country-select option:selected").val() + "-select").length !== 0 
```

然后打印或不打印国家。

* * *

**编辑**

似乎您想复制该国家/地区，因此根据之前的测试，您将拥有：

```
str = $country.val() + " " + (hasCity ? $("#" + country_val  + "-select option:selected").val() : $country.val()); 
```

# php - 使用 Bash 的 Cron 作业中的环境变量

> ID：13635149
> 
> 赞同：0
> 
> 时间：2012-11-29T21:34:21.823
> 
> 标签：php, bash, cron

通常，当我需要在 Cron 作业中使用环境变量时，我只需在 cron 选项卡中声明它们。但是，我在无法直接访问 cron 选项卡的服务器上工作。有人告诉我可以使用 bash 脚本来设置 cron 作业的变量。我对 bash 不太熟悉，也不太清楚命令的流程是什么。

我的 cron 工作将每周执行一次 Php 脚本。所以我需要一个单独的 cron 作业来运行 bash 脚本？这个 bash 脚本会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T03:58:53.003

如果您无权更改 crontab，则必须更改 PHP 脚本。你必须改变其中之一。

您可以将 PHP 脚本*替换*为设置环境变量的 bash 脚本，然后在其新主页中调用 PHP 脚本。但随后您必须移动 PHP 脚本并为 bash 脚本指定 PHP 脚本的旧名称。

至少，除非您可以修改 cron 作业以调用 bash 脚本而不是 PHP 脚本，否则就是这种情况。但是如果你能做到，我不知道你为什么不能添加环境变量设置。

无论如何，独立运行的单独脚本无法代表 cron 作业设置环境变量。

# multithreading - 多线程游戏循环渲染/更新 (boost-asio)

> ID：13635154
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:34:38.607
> 
> 标签：multithreading, opengl, rendering, boost-asio, boost-thread

所以我有一个单线程游戏引擎类，它有单独的输入、更新和渲染函数，我刚刚开始学习使用美妙的 boost 库（asio 和线程组件）。而且我正在考虑将我的**更新**和**渲染**函数分离到单独的线程中（也许也将**输入**和**更新**函数彼此分离）。当然这些函数有时会访问内存中的相同位置，所以我决定使用 boost/thread 的 strand 功能来防止它们同时执行。

现在我的主要游戏循环如下所示：

```
void SDLEngine::Start()
{
    int update_time=0;
    quit=false;
    while(!quit)
    {
        update_time=SDL_GetTicks();
        DoInput();//get user input and alter data based on it
        DoUpdate();//update game data once per loop
        if(!minimized)
            DoRender();//render graphics to screen
        update_time=SDL_GetTicks()-update_time;
        SDL_Delay(max(0,target_time-update_time));//insert delay to run at desired FPS
    }
} 
```

如果我使用单独的线程，它看起来像这样：

```
void SDLEngine::Start()
{
    boost::asio::io_service io;
    boost::asio::strand strand_;
    boost::asio::deadline_timer input(io,boost::posix_time::milliseconds(16));
    boost::asio::deadline_timer update(io,boost::posix_time::milliseconds(16));
    boost::asio::deadline_timer render(io,boost::posix_time::milliseconds(16));
    //
    input.async_wait(strand_.wrap(boost::bind(&SDLEngine::DoInput,this)));
    update.async_wait(strand_.wrap(boost::bind(&SDLEngine::DoUpdate,this)));
    render.async_wait(strand_.wrap(boost::bind(&SDLEngine::DoRender,this)));
    //
    io.run();
} 
```

如您所见，在循环开始之前：输入->更新->渲染->延迟->重复

每一个都一个接一个地运行。如果我使用多线程，我将不得不使用**链**，这样更新和渲染就不会同时运行。那么，在这里使用多线程仍然值得吗？他们基本上仍然会在不同的内核中一次运行一个。我基本上没有多线程应用程序的经验，因此不胜感激。

哦，还有一件事：我正在使用 OpenGL 进行渲染。像这样的多线程会以任何方式影响 OpenGL 的渲染方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T05:21:25.373

您对所有处理程序使用相同的**链**，因此根本没有多线程。此外，您的**deadline_timer**在范围内`Start()`，您不会在任何地方传递它。在这种情况下，您将无法从处理程序重新启动它（注意它不是“间隔”计时器，它只是一个“一次性计时器”）。

我认为这个“改造”没有任何意义，因为在这个例子中你根本没有从**asio**和/或线程中获得任何好处。

这些方法（输入、更新、渲染）太大了，它们做了很多事情，你不能在没有阻塞的情况下调用它们。很难准确地说，因为我不知道游戏是什么以及它是如何工作的，但我更愿意执行以下步骤：

*   尝试修改网络 i/o 使其完全异步
*   尝试使用所有 CPU 内核

关于您尝试过的内容：我认为如果您在代码中搜索真正可以立即并行运行的操作，这是可能的。例如：如果你为每个 NPC 计算一些不依赖于其他角色的东西，你可以`io_service.post()`每个人都使用当前正在运行`io_service.run()`的所有线程。所以你的程序保持单线程，但你可以在一些“大”操作上使用，比如说，7个其他线程

# c++ - c++ 重载运算符新删除，

> ID：13635157
> 
> 赞同：1
> 
> 时间：2012-11-29T21:34:52.433
> 
> 标签：c++, overloading, new-operator

嗨，这有点复杂，所以如果其中任何一个没有意义，请告诉我，我们的团队正在编写一个 C++ 应用程序，我们之前已经重载了 operator new。最近我遇到了这篇文章：[http](http://www.flipcode.com/archives/How_To_Find_Memory_Leaks.shtml) ://www.flipcode.com/archives/How_To_Find_Memory_Leaks.shtml关于如何通过我们的内存分配获取调试信息。

应用程序中的所有文件#include 一个我们有编译时平台配置的文件，在该文件中我添加了以下内容：

```
#ifdef _DEBUG
void* operator new(size_t size, const char *filename, const char *funcname, int line);
void* operator new[](size_t size, const char *filename, const char *funcname, int line);
#define new new(__FILE__, __FUNCSIG__, __LINE__)
#endif 
```

由于我们只为我们的平台构建链接 libcmt.lib，为了使用 STL，我删除了我们旧的 operator new 实现，它看起来像：

```
// in a .cpp file:
void*
operator new(size_t size) { ... } 
```

并将其替换为：

```
// in the same .cpp file as above...
#undef new
void* operator new(size_t size, const char *filename, const char *funcname, int line) { ... }
#define new new(__FILE__, __FUNCSIG__, __LINE__) 
```

这适用于编译，但我从 libcmt.lib 得到一堆链接器错误：

例如：libcmt.lib(malloc.obj)：错误 LNK2001：未解析的外部符号 __imp_HeapAlloc

添加回 operator new 的旧实现（没有附加参数）允许链接器成功链接所有内容。

我的问题：我希望 libcmt 看到我的宏（#define new new( **FILE** , **FUNCSIG** , **LINE** )），因此当它链接时尝试链接我定义的版本（使用调试宏）。

我怎样才能让它工作？（我还尝试使用 Visual Studio 中的属性表来定义宏）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:50:13.937

你不能让它工作。如果在任何包含标准头的文件中定义了此宏，则行为未定义。当然，项目的正常发展将导致人们定义类 local `operator new`，或使用放置新，或该宏将破坏的多种技术中的任何一种。它与`#define while if`. 即使您不使用标准库，在宏中重新定义关键字也肯定会遇到麻烦。

# iphone - 一次获取更大的 Facebook 个人资料图片和个人数据

> ID：13635158
> 
> 赞同：0
> 
> 时间：2012-11-29T21:34:53.057
> 
> 标签：iphone, objective-c, facebook, facebook-graph-api

请帮助从 Facebook 获取更大的个人资料图片。我下面的方法返回一个指向一个小链接的链接。

```
- (void)openSession{

    NSArray *permissions = [NSArray arrayWithObject:@"email"];
    NSDictionary *parameters = [NSDictionary dictionaryWithObject:
                                @"picture,email,name,username,location,first_name,last_name"
                                                           forKey:@"fields"];
    [FBSession openActiveSessionWithReadPermissions:permissions
                                       allowLoginUI:YES
                                  completionHandler:^(FBSession *session,
                                                      FBSessionState state,
                                                      NSError *error) {
                                      if (session.isOpen) {
                                          [FBRequestConnection startWithGraphPath:@"me" parameters:parameters
                                                                       HTTPMethod:@"GET"
                                                                completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {

                                                                    //save personal details using "id result"
                                                                    [...saving method here...]
                                                                    //manage session
                                                                    [self sessionStateChanged:session state:state error:error];
                                                                }];
                                      }
                                  }];
} 
```

我也发现了这种方式：如果在网络浏览器中点击这个链接，我可以得到更大的图像（bla-bla-bla 是我的 Facebook id:))）

[http://graph.facebook.com/92875029-bla-bla-bla-84538042/picture?type=large](http://graph.facebook.com/92875029-bla-bla-bla-84538042/picture?type=large)

但看起来上面的链接指向一个重定向页面，因为加载图像后，链接变为：

[http://profile.ak.fbcdn.net/hprofile-ak-snc6/1864-bla-bla-bbla-bla482_n.jpg](http://profile.ak.fbcdn.net/hprofile-ak-snc6/1864-bla-bla-bbla-bla482_n.jpg)

好吧，没关系，无论如何我都不能在上面的方法中使用它。

所以实际上我正在获取个人资料图片，但正如我所说，它很小。

请帮助扩大它，但在我使用的方法范围内。提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:16:44.957

将参数更改为：

```
@"picture.type(large),email,name,username,location,first_name,last_name" 
```

# java - 尝试设置用户输入的 id 时出现 NullPointerException

> ID：13635162
> 
> 赞同：0
> 
> 时间：2012-11-29T21:35:05.990
> 
> 标签：java, android

我正在尝试处理我的 android 项目，但在我的主函数中出现空指针异常。因此，基于输入的 id，我希望设置从 editText 输入的 id 并在我调用 get 函数时检索它，这将完成条件的 where 子句。这是我的代码：

/*---GetSet.java ---- */

```
public class GetSet {

long gwid=0;

public void setId(long id)
{
    gwid = id;
}

public long getId()
{
    return gwid;
}

} 
```

以下是我的 MainActivity.java 文件

```
public class MainActivity extends Activity {

EditText etGWid;
Button OKbtn;

public final static String EXTRA_MESSAGE = "com.example.myfirstapp.MESSAGE";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    etGWid = (EditText)findViewById(R.id.etGWID);
    OKbtn = (Button)findViewById(R.id.OKbtn);

    final GetSet obj_getset = null;
    final SharedPreferences app_preferences = PreferenceManager.getDefaultSharedPreferences(this);  
            // Create a shared preferences variable using the SharedPreferenceManager for storing GWids

    SharedPreferences.Editor editor = app_preferences.edit();  // We also need a shared preferences editor to handle the shared preference requests
    // Call the edit method (library function) to editor variable can edit the key, values.

    editor.putInt("47688507", 47688507);   // put in the shared preferences values of user GWids and give them a key for retrieval purposes
    editor.putInt("1234567", 1234567);
    editor.putInt("7654321", 7654321);

    editor.commit();   //commit is necessary to save the shared preferences

    OKbtn.setOnClickListener(new View.OnClickListener() {

        @SuppressWarnings("null")
        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub

            String gwidCheck = etGWid.getText().toString();  //get the value user enters for GWid

            if(app_preferences.contains(gwidCheck))       // this will check the stored shared preferences and compare with the value entered
            {
                Context context = getApplicationContext();
                CharSequence text = "Login Successfull";
                int duration = Toast.LENGTH_SHORT;                              //If it exists, then create a toast message for success

                //etGWid.setText("");    // make the textbox empty
                long setid = Long.parseLong(gwidCheck);   // take the string gwid and convert to long
                obj_getset.setId(setid);    // set the gwid entered
                Toast toast = Toast.makeText(context, text, duration);
                toast.show();
                intentfunction();
            } 
            else
            {
                Context context = getApplicationContext();
                CharSequence text = "Login Failed";                     // If doesnt exist, create a toast for fail
                int duration = Toast.LENGTH_SHORT;

                Toast toast = Toast.makeText(context, text, duration);
                toast.show();
            }

        }
    });
}

private void intentfunction()
{
     Intent intent = new Intent(this, SelectOptions.class);
     //editText = (EditText) findViewById(R.id.editText1);
     //editText = new EditText(this);

    String message = "TestHello";
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

第 69 行是我得到以下问题的地方：

```
 obj_getset.setId(setid); 
```

这是 MySQLitehelper.java 文件中的一种方法，用于根据 id 检索行：

```
 public Cursor getRecord(long rowId) throws SQLException
{
        Cursor mCursor =
        db.query(true, TABLE_NAME, new String[] {COLUMN_ID,
        COLUMN_DATE, COLUMN_LOCATION, COLUMN_TIME},
        COLUMN_ID + "=" + getset.getId(), null, null, null, null, null);
        if (mCursor != null) 
        {
            mCursor.moveToFirst();
        }
 return mCursor;
 } 
```

我的问题是，如何设置用户输入的值以便我可以获取该值并基于该值，我可以将条件放在我的 where 子句中，就像上面一样。我哪里错了？

# 日志猫

```
11-29 21:19:22.525: D/AndroidRuntime(10323): Shutting down VM
11-29 21:19:22.525: W/dalvikvm(10323): threadid=1: thread exiting with uncaught         exception (group=0x40a70930)
11-29 21:19:22.583: E/AndroidRuntime(10323): FATAL EXCEPTION: main
11-29 21:19:22.583: E/AndroidRuntime(10323): java.lang.NullPointerException
11-29 21:19:22.583: E/AndroidRuntime(10323):    at     com.example.upd.MainActivity$1.onClick(MainActivity.java:69)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at     android.view.View.performClick(View.java:4202)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at android.view.View$PerformClick.run(View.java:17340)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at android.os.Handler.handleCallback(Handler.java:725)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at android.os.Handler.dispatchMessage(Handler.java:92)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at android.os.Looper.loop(Looper.java:137)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at android.app.ActivityThread.main(ActivityThread.java:5039)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at java.lang.reflect.Method.invokeNative(Native Method)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at java.lang.reflect.Method.invoke(Method.java:511)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
11-29 21:19:22.583: E/AndroidRuntime(10323):    at dalvik.system.NativeStart.main(Native Method)
11-29 21:19:25.702: I/Process(10323): Sending signal. PID: 10323 SIG: 9 
```

程序意外关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:53:10.143

`final GetSet obj_getset = null;`

好吧，你当然会得到一个 nullPointerException；您的 obj_getset 在那里被定义为 null 。

# java - 将数据 a 从 Oracle ResultSet 插入 DB2 数据库，无需迭代

> ID：13635169
> 
> 赞同：0
> 
> 时间：2012-11-29T21:35:30.793
> 
> 标签：java, oracle, unix, db2, resultset

我有一个奇怪的问题需要解决，我有一个 Java 中的结果集，其中包含来自一个 Oracle DB 的数据，我需要将此数据插入到 DB 2 表中。查询和 DB2 表都具有相同的结构，但是记录太多（超过 200k），因此使用迭代进行操作太慢。

我想做类似的事情：

```
Connection DB2Connection = DriverManager.getConnection(Url,Usr,Pwd);

ResultSet rs_oracle = statement.executeQuery("Select * from ORACLE.table1");
ResultSet rs_db2 = statement2.executeQuery("Select * from DB2.table2")
/*PSEUDO*/
rs_db2 += rs_oracle;

DB2Connection.commit(); 
```

并将 rs_oracle 中的所有记录插入到 DB2 表中。

没有迭代有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:40:05.990

您可以使用准备好的语句并对其进行批量插入。

# excel - excel在单元格中的x个字符后自动插入文本

> ID：13635170
> 
> 赞同：0
> 
> 时间：2012-11-29T21:35:40.560
> 
> 标签：excel, concatenation, excel-formula, worksheet

我有一个长的 excel 公式，超过了 excel 在单个单元格中允许的 255 个字符的限制。我通过`"&"`在每 255 个字符后添加来解决此问题，以便公式的下一部分与前一部分连接。

```
 ="text...text"&"text..text"&ROWS(A$1:A1)&"text...text"&"text...text" and so on 
```

我想在我的公式中添加一段代码，以便自动执行此操作。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T00:40:57.100

在[Excel 2010](http://office.microsoft.com/en-gb/excel-help/excel-specifications-and-limits-HP010342495.aspx)中，255 个字符是对列宽的限制。单元格限制为 32,767 个字符。

解决此类限制的常规方法包括文本换行和插入文本框。合并单元格是另一种解决方案，但不推荐。

由于提到了公式，因此可以通过滚动或扩展公式栏（在这两种情况下使用最右边的箭头）或拖动其下边界来扩展公式栏中容易看到的大约 200 个字符的正常限制。

在公式栏中`Alt`+`Enter`可能有助于插入换行符，以便将复杂公式的重复元素排列起来以进行比较。

# php - MySQL 子字符串和中间解析错误

> ID：13635173
> 
> 赞同：1
> 
> 时间：2012-11-29T21:35:53.650
> 
> 标签：php, mysql, linux, substring

有一个有趣的错误——对我来说——。

请按照我执行的查询。

一切正常。

```
mysql> select hex(current_user());
Result : 726F6F74406C6F63616C686F7374 
```

一切正常。

```
mysql> select substring(hex(current_user()),1,15);
Result : 726F6F74406C6F6 
```

我将空字符串添加到子字符串方法的第二个和第三个参数。一切正常。

```
mysql> select substring(hex(current_user()),''+1,''+15);
Result : 726F6F74406C6F6 
```

当我将空字符串添加到子字符串的第一个参数时.. 只返回 726.:S 我期待我最新查询的相同结果。

```
mysql> select substring(hex(current_user())+'',1,15);
Result : 726

mysql> select substring(hex(current_user())+'',2,15);
Result : 26

mysql> select substring(hex(current_user())+'',3,15);
Result : 6

mysql> select substring(hex(current_user())+'',4,15);
Result : NULL 
```

我用 Mysql 5.0.95 和 5.1.61 测试过，同样的问题..！我用中间函数而不是子字符串测试了相同的查询..再次相同。

任何的想法 ？我正在研究某种 Web 应用程序防火墙规则绕过，我意识到了那个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:07:32.513

当您应用“+”运算符时，它将十六进制转换为整数（通过从十六进制获取字符直到第一个非数字字符：726）。并且空字符串也被转换（到整数：0）。

例子：

```
''+1 => 0+1=1
726F6F74406C6F63616C686F7374+'' => 726+0 = 726 
```

[concat()](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)函数应该用于连接字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:50:14.743

如果你想要可靠的结果，你应该使用 concat ......

```
SELECT hex(current_user()),
    hex(current_user())+'', 
    substring(hex(current_user())+'',1,15),
    concat(hex(current_user()), ''), 
    substring(concat(hex(current_user()), ''),1,15); 
```

# c++ - c++ stl priority_queue，带有自定义比较器作为函数参数

> ID：13635179
> 
> 赞同：1
> 
> 时间：2012-11-29T21:36:15.147
> 
> 标签：c++, stl, priority-queue

我想使用 priority_queue 并将其传递给一个函数：

```
// compare points according their distance to some target point
struct MyComparator {
    Point target;
    MyComparator(Point t) : target(t) {}

    bool operator() (const Point& p1, const Point& p2) {
         return distance(target, p1) < distance(target, p2);
    }
};

typedef priority_queue<Point, vector<Point>, MyComparator> myque;
void myfunc(const Point& target, myque& que) { ... }

// call myfunc
Point target = ...;
myque queue(MyComparator(target));
myfunc(target, queue); 
// error :
no matching function for call to ‘myfunc(const Point&, myque (&)(MyComparator))’ 
```

如何解决此错误？

谢谢。

# javascript - Firefox 和 Safari 中的 javascript onclick 行为有何不同？

> ID：13635180
> 
> 赞同：1
> 
> 时间：2012-11-29T21:36:20.220
> 
> 标签：javascript, firefox, safari, onclick, submit

我正在调试一个问题，并在 Firefox 和 Safari 处理 onclick JavaScript 时发现了奇怪的行为。

这是我的代码：

```
<form id="createMessageForm" action="onclick.php?refresh=<?php echo ++$_REQUEST['refresh'];?>" method="post" >
<input type="hidden" id="iteration" value="1"/>
</form>
<a href="page2.html" target="_blank" onclick="document.getElementById('createMessageForm').submit();return true;">Hello</a> 
```

在 Firefox 中加载它，它总是为我打开“page2”。但是在 Safari 中加载它，它只为我打开“page2”大约 10 次，或者更少。这就像取决于浏览器是否可以完成'return true;' 表单提交与否之前的声明。

我认为 JavaScript 总是单线程的，那么在这样的代码中预期的行为是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:06:05.443

正如您所说，Javascript 是单线程的。然而，它也很高兴异步工作。

HTTP 请求是 javascript 中的异步事件，因为它们可能需要未知的时间才能完成。Javascript 调用 HTTP 请求，然后继续它必须做的任何事情，直到 HTTP 请求完成并将控制权返回给 Javascript（或者在这种情况下，完成并触发浏览器加载新页面）。

在您的情况下，您基本上是从 Javascript 发出两个 HTTP 请求，一个接一个。第二个被触发是因为 Javascript 不等待第一个响应；它只是继续到下一个。您看到的不可预知的结果基本上是两个 HTTP 请求中的任何一个首先完成响应的结果，直到让浏览器加载新页面。

这也是 AJAX 的工作原理——AJAX 中的“A”代表异步。Javascript 发出 HTTP 请求，并且很乐意继续做任何你想做的事情。HTTP 请求由浏览器处理，当请求准备好时，浏览器会触发一个事件让 Javascript 接收。这就是为什么对于 AJAX 调用，您需要给它一个“成功”功能，而不是仅仅`if(success)`在下一行代码中说。

这导致我提出解决您问题的建议。将表单提交作为 AJAX 事件触发。这样，浏览器在响应时将永远不会尝试将其作为新页面加载。如果您愿意，您仍然可以告诉浏览器在之后立即触发单独的页面加载，尽管我建议等待第一次调用完成，否则您将不知道它是否真的成功了。

希望能给你一些帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:53:29.487

一旦表单在 onclick.php 中提交并处理服务器端，就使 php**重定向到 page2，没有任何理由去做你正在做的事情，至少你编写的代码没有显示任何理由这样做。**

我引用它：

```
<form id="createMessageForm" action="onclick.php?refresh=<?php echo ++$_REQUEST['refresh'];?>" method="post" >
<input type="hidden" id="iteration" value="1"/>
</form>
<a href="page2.html" target="_blank" onclick="document.getElementById('createMessageForm').submit();return true;">Hello</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:05:09.430

你的问题是什么？它基本上是Pointy所说的。取决于浏览器的实现。

如果你的问题是如何解决它只是改变

```
return true; into -> return false; 
```

在你的链接中

# http - 其他 HTTP 方法是否可以接受 HTTP 303？

> ID：13635181
> 
> 赞同：7
> 
> 时间：2012-11-29T21:36:23.707
> 
> 标签：http, rest, http-status-codes, http-redirect, http-status-code-303

[RESTful Web 服务](http://shop.oreilly.com/product/9780596529260.do)鼓励使用[HTTP 303](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4)将客户端重定向到资源的规范表示。它仅在`HTTP GET`.

这是否也适用于其他 HTTP 方法？如果客户端尝试使用`HTTP PUT`或`DELETE`访问非规范 URI，是否可以接受（和/或推荐）返回 HTTP 303？最佳做法是什么，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-30T09:41:32.747

> 此状态码通常适用于任何 HTTP 方法。它主要用于允许 POST 操作的输出以将用户代理重定向到选定的资源，因为这样做可以提供与 POST 响应相对应的信息，该信息可以独立于原始的形式单独识别、添加书签和缓存要求。

**来源**：[https ://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p2-semantics-21#section-7.4.4](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-p2-semantics-21#section-7.4.4)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T23:59:22.153

我刚刚在书中发现了一个有趣的部分。根据第 378 页部分`302 ("Found")`：

> 此状态码是大多数与重定向相关的混淆的最终来源。它应该像 307（“临时重定向”）一样处理。事实上，在 HTTP 1.0 中，它的名称是“临时移动”。不幸的是，在现实生活中，大多数客户端处理 302 就像处理 303（“查看其他”）。差异取决于客户端在响应**PUT、POST 或 DELETE**请求时收到 302 时应该做什么。如果您对详细信息感兴趣，请参阅下面的 307 条目。
> 
> 为了解决这种歧义，在 HTTP 1.1 中，此响应代码被重命名为“Found”，并创建了响应代码 307。

换句话说，HTTP 302 被拆分为 HTTP 303 和 307。接下来，在第 380 页部分`307 ("Temporary Redirect")`：

> 对于 GET 请求，唯一被请求的是服务器发送一个表示，此状态码与 303 相同（“查看其他”）。307 是对 GET 的良好响应的典型情况是服务器想要将客户端发送到镜像站点时。但是对于**POST、PUT 和 DELETE 请求**，服务器应该采取一些行动来响应请求，这个状态码与 303 有很大的不同。
> 
> 响应**POST、PUT 或 DELETE**的 303表示操作已成功，但响应实体主体未与此请求一起发送。如果客户端想要响应实体主体，它需要向另一个 URI 发出 GET 请求。响应 POST、PUT 或 DELETE 的 307 意味着服务器甚至没有尝试执行该操作。客户端需要将整个请求重新提交到`Location`标头中的 URI。

换句话说，**HTTP POST、PUT、DELETE 在 HTTP 303、307 上是合法的**。上一段解释了预期的行为。

话虽这么说，我在这里引用了这本书，而不是 HTTP 规范（它对预期的行为可疑地保持沉默）。

# c++ - 类型（类型名称）上的 C++ 问题

> ID：13635182
> 
> 赞同：-2
> 
> 时间：2012-11-29T21:36:25.913
> 
> 标签：c++, class, templates

示例代码：

文件：LinkedStack.h

```
#include "NodeType.h"

#ifndef LINKEDSTACK_H
#define LINKEDSTACK_H

template <class ItemType>
class LinkedStack {
public:
    NodeType topPtr;
}; 
```

文件：NodeType.h

```
#ifndef NODETYPE_H
#define NODETYPE_H

template <class ItemType>
class NodeType {
public:

    ItemType info;
    NodeType *nextElement;

};

#endif  /* NODETYPE_H */ 
```

文件：main.cpp

```
#include "NodeType.h"
#include "LinkedStack.h"

using namespace std;

int main(int argc, char** argv) {

    return 0;
} 
```

当我运行它时，我不断得到：

**LinkedStack.h:20：错误：“NodeType”未命名类型**

然而 NodeType 已经被定义和包含了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:39:15.270

`NodeType`是一个`template`。改成：

```
NodeType<ItemType> topPtr; 
```

# c# - 始终处理 MVC API 中的某些异常

> ID：13635186
> 
> 赞同：1
> 
> 时间：2012-11-29T21:36:30.657
> 
> 标签：c#, exception-handling, asp.net-mvc-4

是否可以让我的 API 始终处理给定的异常？在每一个方法中，我都在捕获 DbEntityValidationExceptions 和 ValidationExceptions。每个方法都以相同的方式实现这些捕获。有没有办法委派我的 API 或项目在任何时候抛出这些错误时都可以使用的路由？

这是每个方法的示例（再次具体来说，这是一个 APIController）：

```
 try
        {
            //Do something
        }
        catch(ValidationException ex)
        {
            var errors = ErrorsAdd(new[] { ex.ValidationResult });
            throw new HttpResponseException(Request.CreateResponse(HttpStatusCode.NotFound, errors, _format));
        }
        catch (DbEntityValidationException ex)
        {
            var errors = ErrorsAdd(ex.EntityValidationErrors);
            throw new HttpResponseException(Request.CreateResponse(HttpStatusCode.NotFound, errors, _format));
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:42:44.430

创建一个全局过滤器来处理这些异常并采取适当的行动。在默认的 MVC 站点中应该已经有一个处理所有异常的 ErrorFilter。你可以像它一样创建一个，除了只处理特定的错误。

# c++ - 使用 Doxygen 或类似方法记录枚举标志

> ID：13635187
> 
> 赞同：1
> 
> 时间：2012-11-29T21:36:31.637
> 
> 标签：c++, enums, documentation, doxygen, flags

我刚刚将[Doxygen](http://www.doxygen.nl "多氧")添加到我的工具集中，虽然我对大多数技术都很满意，但我对如何记录枚举标志有点困惑（也适用于一般的文档，有或没有 Doxygen） . 给定以下课程：

```
class foo
{
   /// @enum  Options
   /// @brief Specifies options for the object. Options are combined using
   ///        the bitwise OR operator e.g. "OPTION1 | OPTION2".
   enum Options
   {
   OPTION1 = 1, //< Option 1 description.
   OPTION2 = 2, //< Option 2 description.
   OPTION3 = 4  //< Option 3 description.
   };

   /// @brief Does something.
   /// @param options  Specifies options.
   void bar(int options) {/* Do something */}
}; 
```

如何向用户指示如何使用 bar 函数的 options 参数？参数是 int 类型，而不是 Options，因此参数和枚举之间没有直接联系。如果参数是选项类型，那么文档将链接到枚举的描述，这是我想要的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:42:48.287

所以使参数类型`Options`。您可以编写返回`Options`句柄的重载运算符`&`以及`|`您需要的任何其他逻辑运算符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:10:51.770

记录以“指定选项”命名的变量`options`不是有意义的注释。变量名称已经说明了您现有的评论所说的内容。所以让你的评论有意义：

```
/// @brief Does something.
/// @param options  Specifies options for the object, which must be a bitwise OR
///                 of zero or more of the bit flags in enum foo::Options.
void bar(int options) {/* Do something */} 
```

# haskell - 如何从“多态数据类型 a”转到 Show 类的实例（不使用“派生 Show”）

> ID：13635189
> 
> 赞同：1
> 
> 时间：2012-11-29T21:36:41.273
> 
> 标签：haskell

在此文本下方，您可以看到一些用于创建 Arukone 谜题的代码。但是有一个问题：多态数据类型`Puzzle a`代表了一个带有 type 标签的 Arukone 谜题`a`。

但我想有一个带有 Show 类实例的拼图类型（不使用`deriving Show`.） show 函数就足够了，showsPrec 不是必需的。

那么你知道这是如何工作的吗？我想为`a`以下类的实例的所有类型定义 Show `ToChar`？

```
class ToChar a where
 toChar :: a -> Char

instance ToChar Char where
 toChar = id

instance ToChar Int where
 toChar = head . show 
```

**代码 ：**

```
import Data.Maybe (listToMaybe)

data Size  = Size Int Int deriving (Eq, Show)
data Pos   = Pos  Int Int deriving (Eq, Show)
data Link l = Link l Pos Pos
data Puzzle l = Puzzle Size [Link l]

assign :: Int -> a -> [a] -> [a]
assign 0 v (_:vs) = v:vs
assign n v (v’:vs) = v’: assign (n - 1) v vs

assign2 :: Int -> Int -> a -> [[a]] -> [[a]]
assign2 r c v vs = assign r (assign c v (vs !! r)) vs

assignPos :: Pos -> a -> [[a]] -> [[a]]
assignPos (Pos r c) = assign2 (r-1) (c-1)

tabulate :: Int -> (Int -> a) -> [a]
tabulate 0 _ = []
tabulate i f = f 0 : tabulate (i - 1) (f . (+1))

tabulate2 :: Int -> Int -> (Int -> Int -> a) -> [[a]]
tabulate2 b h f = tabulate h (\r -> tabulate b (\c -> f r c))

tabulatePos :: Size -> (Pos -> a) -> [[a]]
tabulatePos (Size h b) f = tabulate2 b h (\r c -> f (Pos (r +1) (c + 1)))

showPuzzle :: Puzzle a -> [[Maybe a]]
showPuzzle (Puzzle sz links) = tabulatePos sz findPosMaybe
  where findPosMaybe pos =  -- edit: findPosMaybe needs to be further left than the next line
          listToMaybe [l | Link l pos1 pos2 <- links, pos1 == pos || pos2 == pos] 
```

**解决方案和输入**

```
*Main> show (Puzzle (Size 2 3) [Link 1 (Pos 1 1) (Pos 1 3), Link 2 (Pos 2 1) (Pos 2 3)])

"1 1\n2 2"

*Main> show (Puzzel (Size 5 5) [Link ’a’ (Pos 3 1) (Pos 4 3), Link ’b’ (Pos 5 1) (Pos 1 5), Link ’c’ (Pos 2 5) (Pos 5 5), Link ’d’ (Pos 4 1) (Pos 2 2)])

"    b\n d  c\na    \nd a  \nb   c"          <-- result -- remarks the spaces 
```

*最后一个例子的 putStrLn*

```
 b
 d  c
a 
d a 
b   c 
```

欢迎所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:55:08.457

首先让我们使用`ToChar`该类将 Maybe 元素转换为空格或值：

```
maybeToString :: ToChar a => Maybe a -> String
maybeToString Nothing = " "
maybeToString (Just x) = toChar x : "" 
```

现在我们可以制作 Show 实例：

```
instance ToChar a => Show (Puzzle a) where
  show = unlines . map (concatMap maybeToString) . showPuzzle 
```

我不清楚你是否想要填充，所以你可以改变你的 MaybeToString 来说明`" "`你`toChar x : " "`是否想要更多的空间。

通过上面的定义，我们得到：

```
*Main> show (Puzzle (Size 2 3) [Link (1 :: Int) (Pos 1 1) (Pos 1 3), Link 2 (Pos 2 1) (Pos 2 3)]) 
"1 1\n2 2\n"
*Main> putStrLn $ show (Puzzle (Size 2 3) [Link (1 :: Int) (Pos 1 1) (Pos 1 3), Link 2 (Pos 2 1) (Pos 2 3)]) 
1 1
2 2 
```

示例 2：

```
*Main> show (Puzzle (Size 5 5) [Link 'a' (Pos 3 1) (Pos 4 3), Link 'b' (Pos 5 1) (Pos 1 5), Link 'c' (Pos 2 5) (Pos 5 5), Link 'd' (Pos 4 1) (Pos 2 2)])
"    b\n d  c\na    \nd a  \nb   c\n"
*Main> putStr it
    b
 d  c
a    
d a  
b   c 
```

# c# - 如何显示所有可能颜色的网格？

> ID：13635191
> 
> 赞同：2
> 
> 时间：2012-11-29T21:36:58.190
> 
> 标签：c#, colors, grid, selector, picker

如何按逻辑顺序创建所有可能的 RGB 颜色组合的网格？像这样的东西：

![在此处输入图像描述](../Images/77ddfc68f1bdc1f92ffc180b0cd65130.png) 每种颜色使用 256 个值将产生 (256^3=) 16,777,216 种可能的颜色，这些颜色可以排列成（16,777,216 的平方=）4,096 x 4,096 的正方形。

我知道如何制作一组颜色然后显示它们，但我要的是在颜色之间进行平滑过渡的逻辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:53:29.827

不要在 RGB 中思考，在 HSL（色相、饱和度、亮度）或 HSV 颜色空间中思考。它们更接近人类认为彼此“接近”的东西。

要获得与示例中的颜色类似的颜色：

1.  将饱和度保留为“1”。
2.  要穿过（不同的颜色，RED->YELLOW->GREEN->ETC），增加“Hue”。
3.  往下走（颜色变深的地方）会降低亮度。

[这](http://en.wikipedia.org/wiki/HSL_and_HSV)是一篇关于 HSL 和 HSV 颜色空间的文章。在那篇文章中，他们有一些转换回 RGB 的算法，但[这里](http://www.cs.rit.edu/~ncs/color/t_convert.html)有一篇关于 C 语言转换的简单文章。

编辑：还有[一个在 c#](http://www.splinter.com.au/converting-hsv-to-rgb-colour-using-c/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:23:47.020

您无法通过 4kX4k 正方形上的链接图像中的排列来获得*所有*可能的颜色，因为计算机显示的 RGB 颜色位于三维空间中。这就是为什么图形程序中有不同的颜色模型，它们通常显示三个值选择器，或者至少将一个维度拉到线性选择器控件中，而将其他两个维度留在平方控件中。

有时您还会看到六边形控件或三角形颜色的排列以及单独的亮度选择器。

链接的图像完全错过了灰色。它实际上是 HSL 颜色空间中色相和亮度的组合选择器。可以很容易地确定具有强烈颜色的中间线，从一个基色开始，逐步添加下一个基色，当达到最大值时减少第一个颜色，然后以相同的模式过渡到第三个，最后回到第一种颜色。在通往顶部的路上，有一个到白色的线性过渡，在向下到黑色的路上。

最后，您在颜色空间中的六个边界平面上拥有所有颜色，但平面之间的整个空间尚未覆盖。为此，您需要一个单独的颜色饱和度选择器。从最大水平降低饱和度覆盖灰色。

如果你真的想要一个正方形空间上的所有颜色，你可以创建大小为 256x256 的块，这些块一次又一次地重复，并稍微添加第三种颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T21:55:26.680

一般来说，在平面上表示 3d 空间是很困难的，特别是如果你想看到一些不透明的云......所以降低强度可能是一种方法。

查看 HSI/HSL/HSV - [http://en.wikipedia.org/wiki/HSI_color_space](http://en.wikipedia.org/wiki/HSI_color_space)。

# facebook - Facebook Like 按钮是否需要 App ID？

> ID：13635196
> 
> 赞同：33
> 
> 时间：2012-11-29T21:37:17.803
> 
> 标签：facebook, button, plugins, facebook-like

当转到所有社交插件的设置页面时，它们现在提供使用 APP ID 的示例代码。

[http://developers.facebook.com/docs/plugins/](http://developers.facebook.com/docs/plugins/)

Like Button 和其他插件现在需要 APP ID 吗？如果在使用插件时不包含 APP ID 会怎样？

我查看了 Facebook 开发人员博客并阅读了有关[Like Button Migration](http://developers.facebook.com/blog/archive#2012)的信息。[无论是在那里还是在FB Like Reference](https://developers.facebook.com/docs/reference/plugins/like/)中，我都无法找到一个直接的答案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T21:41:06.443

> ## 注意：
> 
> **这是一个过时的信息，官方facebook的行为已经改变。**

很简单，答案是**否定**的，看看下面的官方[Facebook 资源](http://developers.facebook.com/docs/reference/plugins/like/)。

**注意：**要做到这一点不需要应用程序ID，您必须在退出Facebook时访问上述页面。看下面的屏幕截图。

![在此处输入图像描述](../Images/6605273b9372bc7b5912067ba9b4d290.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-10T14:22:27.683

所以，我只是尝试了 sємsєм 方法，正如评论所说：Facebook 想让你登录以获取代码，如果你有一个应用程序，你必须选择一个。
但如果你不这样做，它会给你一个没有任何应用参考的代码。

所以当你得到一个代码时——无论你选择什么应用程序——你只需要删除 .js URL ( `&appId=##############`) 中的 appId 参数，你就得到了（对于最新的 HTML5 代码，第 6 行）：

```
js.src = "//connect.facebook.net/en_US/all.js#xfbml=1"; 
```

div 元素的代码不会改变。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-26T22:37:54.393

我只是在没有 appID 的 iframe 标记内使用 URL 代码，它可以正常工作，

这是一个例子：

```
<iframe src="http://www.facebook.com/plugins/like.php?href=<%=request.original_url%>&width&layout=button_count&action=like&show_faces=false&share=false&height=35&appId=" frameBorder="0" width="150" height="25">
</iframe> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-20T22:19:52.347

正如 semsem 所说，简单的答案是“不，它不是必需的”......有一些方法可以让 appId 与“like”按钮相关联。这是我的工作经验。我不是 Facebook 或 Open Graph 专家，所以 YMMV。

**为什么我们避免在按钮上使用 appId：**

我们正在提供一项服务，其中我们有一个网站（可以说是引擎），该网站提供向学生（客户）分发在线课程的服务。使用我们的服务向学生传播课程的讲师（也是客户）可以根据自己的意愿为网站打上烙印，并将他们的域映射到我们网站上为这些课程提供服务的部分。

作为一个简化的示例：我们从[http://courses.example.com/instructor_name](http://courses.example.com/instructor_name)提供服务，但我们希望学生通过[http://www.instructors-domain.com/](http://www.instructors-domain.com/)访问内容。任何课程都将是基本 URL 之外的子目录。

将“赞”按钮与我们的 Facebook 应用程序相关联，不允许任何跨域恶作剧。虽然这样做有正当理由，但它不适用于我们公司所处的位置和产品发展。所以我们需要找到一种解决方法。

我们想让人们“喜欢”一门课程，让“故事”指向网络上的适当位置，以及进行一些自定义（例如“NAME 喜欢 FBAppName 上的*在线课程*”）。我们基本上做到了这一点。我们失去了一些我们认为在我们进化的这一点上可以接受的功能。

**它的短处**

我使用了 Facebook“like”按钮的 iframe 版本，由相应的 Facebook 开发人员页面指定（有关链接，请参阅 semesm 对链接的回答，我没有代表）。我拿了他们的代码片段并手动删除了 iframe src 中的 appId 查询字符串。

在“喜欢”页面本身（与“喜欢”按钮相同的页面）中，我使用了 Open Graph 元标记，**包括**指定 appId。（这些标签被指定：fb:app_id、og:type、og:url、og:site_name、og:title、og:description、og:image。）

og:type 是我们的自定义类型，形式为“namespace:app_custom_object_name”。

**失败的方法**

我的第一次尝试是使用我理解的首选方法，即开发人员“like-button”页面的“Get Code”部分中的“HTML5”选项卡。我尝试了他们的方法从适当的位置剥离 appId。这种方法被证明是无效的。

如果域与 Facebook 应用程序中的域*不*匹配，则不会有“喜欢”按钮。

如果域匹配，则会出现“喜欢”按钮*。*但是，实际“喜欢”某些东西需要点击 3 次。第一次单击将“赞许”图标更改为普通锚点，其中包含一个没有明显意义的单词（我忘记了单词是什么）。第二次单击将打开登录/授权窗口以使用我们的应用程序。第三个实际上提出了现代花哨的“喜欢”框，您可以在其中输入评论。我没有找到解决这种行为的方法。

请注意，当我以这种方法在适当的域上指定 appId 时，它会按预期工作（尽管与我们期望的行为不一致）。

我没有在“like-button”页面的“Get Code”部分尝试其他两个选项。

**知情的猜测和谣言**

在我围绕这方面的研究中，我的总体印象是要求 appId 是 Facebook 未来的发展方向。谁知道旧方法是否会被贬值，可能永远不会，尽管我在文档中没有发现任何关于这种“遗留”行为的内容。这对我来说是有意义的，因为他们提供的新产品和这种方法可用的高级跟踪。

我看到有人认为以这种方式使用的“点赞”类似于二等公民……在某些方面被视为劣等公民。在我自己的实验中，我发现完全指定的 appId（在“喜欢”按钮本身中）的行为与部分指定的 appId 不同，并且更易于访问和可预测（就 Open Graph 查询和我有限的 Facebook 测试的可见性而言） . （同样，我没有找到关于这方面的可靠文档，也没有努力完全理解这些差异。）

愿此信息对其他人有所帮助。祝你好运！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-14T21:53:53.127

根据[Facebook 的社交插件常见问题解答](https://developers.facebook.com/docs/plugins/faqs#faq_585424284973304)

> *   网络：如果您在网络上使用社交插件，则无需创建 Facebook 应用程序来集成社交插件。
> *   iOS/Android：如果您在 iOS 或 Android 应用程序中使用社交插件，您需要创建一个 Facebook 应用程序并将其与您的应用程序标识符相关联。

似乎官方的答案是它们仅适用于 iOS/Android。

# redirect - IIS 7 web.config 重定向除特定目录之外的所有流量

> ID：13635197
> 
> 赞同：1
> 
> 时间：2012-11-29T21:37:18.387
> 
> 标签：redirect, dns, web-config

我正在使用 web.config 文件将我的所有流量从一个域重定向到另一个域。它工作得很好，但是因为我在市场上有一个旧版本指向原始域的移动应用程序，所以我需要直接保留一个完整的。

例如：来自 www.domain1.com 的所有流量都将重定向到 www.domain2.com，但所有流向 www.domain1.com/folder1/ 的流量除外

# c# - 处理 LuaInterface 中的语法错误

> ID：13635199
> 
> 赞同：0
> 
> 时间：2012-11-29T21:37:21.813
> 
> 标签：c#, error-handling, lua, syntax-error, luainterface

我正在尝试使用[LuaInterface](http://code.google.com/p/luainterface/)将 Lua 脚本接口集成到我的 C# 项目中。

如果我执行语法正确的代码，它会按预期工作，但是一旦将语法错误（或看起来的任何其他错误）引入脚本，`SEHException`就会抛出没有关于错误的任何信息。

触发行为的简单示例：`new LuaInterface.Lua().DoString("die");`

当然，这完全抵消了 Lua 的错误处理机制，对我来说是一个阻碍。

显然这是一个自 2011 年以来开放的[已知错误。](http://code.google.com/p/luainterface/issues/detail?id=38)

是否有任何解决方法，没有此错误的 LuaInterface 版本，或者是否有替代的 lua 包装器可以正确处理错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T00:01:46.063

遇到的 Lua 错误（语法或运行时错误）`DoString`应该导致`LuaException`被抛出。它的消息将包含 Lua 生成的错误字符串。例如，给定您的示例：

```
try
{
    new LuaInterface.Lua().DoString("die");
}
catch (LuaException ex)
{
    Console.WriteLine(ex.Message);
} 
```

您应该收到以下错误：

```
[string "chunk"]:1: '=' expected near '<eof>' 
```

您没有为您的一个班轮显示任何上下文。它是否包含在 try-catch 块中？

如果是这样，也许这是[一个错误](http://code.google.com/p/luainterface/issues/detail?id=38)？

# javascript - 通过JS插入DOM元素时根据子元素调整父Divs的大小

> ID：13635200
> 
> 赞同：0
> 
> 时间：2012-11-29T21:37:23.730
> 
> 标签：javascript, css, gwt

我有一个 GWT 应用程序，它在其主网页上使用以下 DIV 布局：

```
<div id="mainContainer">
    <div id="applicationHeader">
        <div id="imageLoader"></div>
        <div id="applicationHeaderMain">
            <div id="logo"></div>
            <div id="banner"></div>
            <div id="menu"></div>
        </div>
    </div>
    <div id="applicationContainer"></div>
    <div id="applicationFooter"></div>    
</div> 
```

the`applicationHeader`和 the都`applicationContainer`使用 CSS-Command`width:100%;`来调整它们的大小以适应浏览器尺寸。在 ApplicationContainer 内，我有一个 TabPanel。

现在我有一个函数可以调整其中一个选项卡中的一些元素的大小，然后 TabPanel 有时会超过浏览器的总宽度。TabPanel 本身将正确适应其子元素的大小，`mainContainer`似乎也可以这样做，但`applicationHeader`-DIV 将保持其实际大小，尽管其父元素已调整大小。

如何使`applicationHeader`-DIV 正确调整大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:58:14.553

如果没有看到代码示例，很难给你一个明确的答案，但我会看看以下情况。

1.  applicationHeader div 的 css 位置属性设置为默认值（静态）以外的值。这可能会导致它将其宽度设置为其直接父元素以外的元素的全宽。

2.  applicationHeader div 具有除 mainContainer 之外的父元素。也许某些 javascript 正在动态修改 html 结构并产生意想不到的效果。

如果您可以提供更多详细信息，我会尽力为您提供更多帮助。

# java - 在 SD 卡 Android 上解析 XML 文件

> ID：13635201
> 
> 赞同：0
> 
> 时间：2012-11-29T21:37:25.120
> 
> 标签：java, android, xml, xml-parsing

我想解析一个位于 sdcard/myFiles 下的 XML 文件。我的应用程序要解析的 XML 文件可以（并且很可能）包含大量文本。我已经阅读了很多关于 XML 解析的内容，但我无法掌握它。尤其是最适合我的应用程序的方法（SAX、DOM 等）。

我的 XML 文件将如下所示：

```
<Food>
    <info>Dish.1.</info>
    <info>Ingredients that belongs to dish 1</info>
    <info />
    <info>Dish.2.</info>
    <info>Ingredients that belongs to dish 2</info>
    <info />
    <info>Dish.3.</info>
    <info>Ingredients that belongs to dish 3</info>
</Food> 
```

我不确定这种 xml-layout 叫什么，但是当没有“层次结构”时，我不知道从哪里开始。好吧，Dish.1 下的所有内容。属于 Dish.1。直到第 2 道菜。进入图片等。我必须补充一点，“主要”标签中的文本将始终是 Dish.*。( * 递增 1)

最终Dish.1。将进入具有（列）rowId：1，（列）名称：Dish.1，（列）成分：属于...的成分的数据库表

因此，我还必须解析标签信息的内容以将其放入正确的列中。

任何帮助将不胜感激，如果甚至不可能，我也想知道这一点。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T23:56:53.100

您绝对可以从 SD 卡解析 XML。如果您要处理大量数据，我建议您使用 SAX 或 PullParser，因为这些将使用更少的内存来解析数据。

但是，从您发布的示例 XML 中，我建议您多了解一下 XML 约定，也许可以通过像[这样](http://www.w3schools.com/xml/)的教程。

# .net - 从 Apache/Mono 服务器访问 SQL 数据库

> ID：13635202
> 
> 赞同：1
> 
> 时间：2012-11-29T21:37:32.060
> 
> 标签：.net, sql, apache, mono

我有一个为.net 站点运行 Mono 的 Apache 服务器（它很乱）。SQL 数据库托管在 web.com 上的虚拟 IIS 服务器上。

当站点和数据库没有分开时，我的连接字符串有效，但是当它们在那里时什么都没有。

这是我在 web.config 中的内容：

```
<appSettings>
<add key="ConnectionString"     value="server=mssql2.myregisteredsite.com;uid=******;Integrated Security=SSPI;pwd=****;Network Library=DBMSSOCN;database=*****;pooling=true;max pool size=1000" />
</appSettings> 
```

出于某种原因，它在两个地方

```
<connectionStrings>
<add name="SiteDB" connectionString="data source=mssql2.myregisteredsite.com;Persist Security Info=True; initial catalog=****;user id=***** ; Network Library=DBMSSOCN;password=*****" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

我试过用 xxx.xxx.xxx.xxx,1433 的 IP 换出源域，但这不起作用。

# java - 如何在 JSP 中传递值 进入java方法

> ID：13635207
> 
> 赞同：0
> 
> 时间：2012-11-29T21:37:38.087
> 
> 标签：java, html, jsp, jakarta-ee, servlets

我有一个这种格式的 JSP 文件（两个选择标签）-

```
<%@ page import="mypackage.*" %>

<all the main tags>...

<form> 
<select> options... </select> 
<select> options... </select> 
<input type="submit" value="submit" /> 
</form>

<textarea></textarea> 
```

“mypackage”中有一个java方法，它应该`<select>`在点击提交后从标签中获取参数。该方法返回一个字符串，我想在`<textarea>`. 我该怎么做？

非常感谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:40:27.990

将其作为`HTTP POST`或发送`HTTP GET`到 servlet，并通过`doGet()`或`doPost()`方法接收。您可以通过 访问它`HttpServletRequest.getParameter()`。

```
void doPost(HttpServletRequest request, HttpServletResponse response) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:20:45.553

我看到您正在将 mypackage.* 类导入您的 JSP。实际上，您可以在 JSP 中包含 Java 代码并直接调用该类。就像是：

```
<%
    MyClass c = new MyClass();
    String result = c.doSomething(request.getParameter("select"));
    out.println("<textarea>" + result + "</textarea>");
%> 
```

应该足够了（但不好：结果应该被转义）。

但是，这段代码不是很容易维护，可以做得更好（kaustav datta 的答案是一种标准的做法）。

它可以使用 Spring 框架的 MVC 部分以更优雅的方式完成：http: [//static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html)

刚开始需要一些配置，需要一些时间来理解，但是当你得到它时，它是非常好的。

在您的情况下，以下形式的控制器就足够了：

```
@Controller
public class SelectController {

   private final class MyClass c = new MyClass();

   @RequestMapping(value="/select", method = RequestMethod.POST)
   public String doSelect(@RequestParam("selection") final String selection, final ModelMap model) {
       final String result = c.doSomething(selection);
       modelMap.addAttribute("result", result);

       return "yourJsp";
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:24:57.420

`request.getParameterValues("select")`

这`getParameterValues`是请求接口的一个方法，它在此方法的参数中返回一个字符串，并通过您的控制器的名称

当您从文本框中获取值时，请使用该方法`request.getParameter("name");`

# c# - 下载 Amazon S3 对象，Windows 说文件已损坏

> ID：13635210
> 
> 赞同：3
> 
> 时间：2012-11-29T21:38:04.990
> 
> 标签：c#, .net, vb.net, amazon-s3, amazon-web-services

我目前正在使用 .NET SDK 从 Amazon S3 下载文件，我目前有以下代码来执行此操作（仅允许使用这些文件）：

```
 With request
        .WithBucketName(bucketName)
        .WithKey(key)
    End With
    response2 = client.GetObject(request)
    Dim strReader As MemoryStream = New MemoryStream
    response2.ResponseStream.CopyTo(strReader)

    Response.ContentType = getContentType(key)
    Response.OutputStream.Write(strReader.GetBuffer, 0, strReader.GetBuffer.Length)
    Dim fileName As String = Path.GetFileName(key)
    Response.AddHeader("Content-Disposition", "attachment;filename=" + fileName)
    Return ""

End Function
Private Function getContentType(ByVal fileToContent As String) As String
    Dim fileExtension As String = Path.GetExtension(fileToContent)
    Dim contentType As String
    Select Case fileExtension
        Case ".bmp"
            contentType = "image/bmp"
        Case ".png"
            contentType = "image/png"
        Case ".xlsx", ".xls"
            contentType = "application/vnd.ms=excel"
        Case ".jpg", ".jpeg", ".gif"
            contentType = "image/jpeg"
        Case ".pdf"
            contentType = "application/pdf"
        Case ".ppt", ".pptx"
            contentType = "application/vnd.ms-powerpoint"
        Case ".doc", ".docx"
            contentType = "application/msword"
        Case Else
            contentType = "text/plain"
    End Select
    Return contentType
End Function 
```

我有 2 个问题：首先，当我尝试在客户端窗口上打开文件时，告诉我（对于 MS Office 文件）文件已损坏，有时它会设法打开它们，有时却没有。其次，似乎如果我的文件具有.pptx 之类的扩展名，并且我在内容类型中说“PowerPoint”，那么浏览器似乎会尝试向它们附加一个扩展名，例如“.ppt”或“.doc”。有什么办法可以解决吗？

编辑：打开 MS Office 文件时收到的实际消息：'PowerPoint 在 PowerPointFile.ppt 中发现不可读的内容。是否要恢复此演示文稿的内容？如果您信任此演示文稿的来源，请单击是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:53:29.510

好的，对于#1，不要`GetBuffer`在 MemoryStream 上使用。使用[`ToArray`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)：

```
Dim bytes = strReader.ToArray()
Response.OutputStream.Write(bytes, 0, bytes.Length) 
```

`GetBuffer`返回缓冲区，而不是写入流的内容。

对于 #2，您需要为`.***x`Office 文档使用不同的 MIME 类型。见[这里](https://stackoverflow.com/a/4212908/492405)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-27T20:26:07.210

以下代码将从该位置获取文件并自动将其下载到您的浏览器中，而不会收到损坏的文件警告。

```
using(var response = client.GetObjectAsync(request).Result) 
{
  using( var responseStream = response.ResponseStream )
  {

    Response.ContentType = response.Headers.ContentType;
    Response.AddHeader("Content-Length", response.Headers.ContentLength.ToString());
    Response.AddHeader("Content-Disposition", "attachment; filename=\"" + uri.Key + "\"");
    Response.ContentType = "application/octet-stream";

    var memoryStream = new MemoryStream();
    responseStream.CopyTo(memoryStream);

    Response.BinaryWrite(memoryStream.ToArray()); //All byte data is converting to files                                     

  }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-04-23T15:43:49.877

感谢您的努力，但我们可以通过以二进制格式发送正文中的文件来解决此问题。

```
const uploadS3 = (url,file) =>{
  var requestOptions = {
    method: 'PUT',
    body: file,
    redirect: 'follow',
}; 
```

# fonts - 为什么我的字体没有注册？

> ID：13635212
> 
> 赞同：2
> 
> 时间：2012-11-29T21:38:19.007
> 
> 标签：fonts, itextsharp

我有一个使用 iTextSharp 的程序，其中包含代码

```
FontFactory.RegisterDirectories();

foreach (string fontname in FontFactory.RegisteredFonts)
{
   Log.Info("**** Found registered font: " + fontname);
} 
```

当我运行它时（在 CentOS 机器上使用 Mono），日志只显示核心 PostScript 字体：

*   电击蝙蝠
*   时代罗马
*   倍斜体
*   helvetica-boldoblique
*   快递粗体字
*   黑体字
*   海尔维提卡
*   快递倾斜
*   helvetica-oblique
*   快递粗体
*   时代粗体
*   信使
*   时代大胆
*   象征

但是我的`/usr/share/fonts`目录树下有 156 个 TTF 文件（这是`RegisterDirectories`函数代码中提到的目录之一）。为什么这些不被注册？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T10:03:45.950

iText 和 iTextSharp 之间存在细微差别。

在 iText 中，`registerDirectories()`看起来像这样：

```
public int registerDirectories() {
    int count = 0;
    String windir = System.getenv("windir");
    String fileseparator = System.getProperty("file.separator");
    if (windir != null && fileseparator != null) {
        count += registerDirectory(windir + fileseparator + "fonts");
    }
    count += registerDirectory("/usr/share/X11/fonts", true);
    count += registerDirectory("/usr/X/lib/X11/fonts", true);
    count += registerDirectory("/usr/openwin/lib/X11/fonts", true);
    count += registerDirectory("/usr/share/fonts", true);
    count += registerDirectory("/usr/X11R6/lib/X11/fonts", true);
    count += registerDirectory("/Library/Fonts");
    count += registerDirectory("/System/Library/Fonts");
    return count;
} 
```

然而，在 iTextSharp 中，该方法如下所示：

```
public virtual int RegisterDirectories() {
    string dir = Path.Combine(
        Path.GetDirectoryName(
            Environment.GetFolderPath(Environment.SpecialFolder.System)), "Fonts");
    return RegisterDirectory(dir);
} 
```

Java 是独立于平台的，所以我们必须寻找“通常的嫌疑人”。C# 是特定于 Windows 的，因此我们可以依赖环境来告诉我们在哪里可以找到字体。您的问题告诉我们 Mono 不支持此功能，因此您必须使用`FontFactory.RegisterDirectory("/usr/share/fonts");`

# ruby - Rsync：纯 Ruby 实现？

> ID：13635213
> 
> 赞同：7
> 
> 时间：2012-11-29T21:38:20.327
> 
> 标签：ruby, rsync

我有一个 Rsync 程序[Deltacopy](http://www.aboutmyip.com/AboutMyXApp/DeltaCopy.jsp)，其可执行文件作为客户端和服务器，但如果可能的话，我想用 Rsync 的纯 Ruby 实现来替换它。我发现了像 Six-rsync 和 rsync-update 这样的 gem，但它们似乎不是通用的实现。我正在寻找一个纯 Ruby 解决方案，因此不涉及可执行文件，最好可在多个操作系统上运行。如果可能的话，一个简单的样本会很棒。

我只寻找[Rsync](http://en.wikipedia.org/wiki/Rsync)，请不要其他传输或备份解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T02:31:40.480

有这个：

*   “最便宜的 Rsync 替换（使用 Ruby）”
    *   存档 dzone：[https ://web.archive.org/web/20090101014459/http://snippets.dzone.com/posts/show/1812](https://web.archive.org/web/20090101014459/http://snippets.dzone.com/posts/show/1812)
    *   存档原件：[https ://web.archive.org/web/20070615023341/http://eigenclass.org/hiki.rb?cheap+rsync](https://web.archive.org/web/20070615023341/http://eigenclass.org/hiki.rb?cheap+rsync)
*   [https://github.com/avh4/ruby-sync](https://github.com/avh4/ruby-sync)
    *   “一个完整的 ruby​​ 文件同步库，支持与本地和 FTP/SSH 目录同步/镜像。”
*   [http://synchzor.com/](http://synchzor.com/)

祝你好运，先生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T02:06:22.093

我从未使用过它，但看起来 rrsync 可能值得一试。

[https://github.com/RichGuk/rrsync](https://github.com/RichGuk/rrsync)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:22:01.680

我会尝试使用 Ruby 内联（[http://rubygems.org/gems/RubyInline](http://rubygems.org/gems/RubyInline)和[http://www.zenspider.com/ZSS/Products/RubyInline/](http://www.zenspider.com/ZSS/Products/RubyInline/)）。您也许可以将 Rsync 源代码与 Ruby Inline 一起使用。

但是，我不知道这将如何在 Windows 平台上工作。

* * *

rsync源代码：[http ://rsync.samba.org/download.html](http://rsync.samba.org/download.html)

# java - 当我传递一个null时，java会运行哪个重载函数

> ID：13635214
> 
> 赞同：1
> 
> 时间：2012-11-29T21:38:23.607
> 
> 标签：java, methods, reference, null, overloading

所以我可以将空值传递给java中的函数。我也可以在java中重载函数。但考虑以下

```
public static void main(String ... args){
    doStuff(null);
}

public static void doStuff(String s){
      solveWorldHunger();
}

public static void doStuff(Integer i){
      nukeCanada();
}

public static void nukeCanada(){
 System.out.println("NO!");
}

public static void solveWorldHunger(){
  System.out.println("YAY!");
} 
```

无论源代码的顺序如何，前面的程序总是会打印出 YAY...

任何人都可以解释为什么 jvm 始终决定在`solveWorldHunger`函数上运行`nukeCanada`函数吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-29T21:40:05.277

编译器很清楚你不能存储`null`在`primitive int`. 因此，它决定使用`String`作为参数的方法。

但是，当您将第二种方法更改`Integer`为作为参数时，您将收到编译器错误。因为它们都有资格被`null`参数调用。所以，会有歧义。

所以，尝试改变你的第二种方法： -

```
public static void doStuff(String s){
      solveWorldHunger();
}

public static void doStuff(Integer i){  // Integer instead of `int`
      nukeCanada();
} 
```

并在`null`. 您将看到编译器错误。

因此，在这种情况下，您可以像这样使用类型转换调用适当的方法：-

```
doStuff((Integer)null);  // Calls Integer version
doStuff((String)null);   // Calls String version 
```

* * *

另外，请注意，如果您`2nd method`的参数是`super type`of `String`，`Object`则不会有歧义，因为编译器现在将选择最具体的参数，即`String`参数。

因此，只有当您有两个方法的类型不在同一个继承层次结构中时，才会出现歧义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:41:14.740

只有您的 doStuff(String) 方法可以采用 NULL 参数...原始 int 永远不能为空。如果您有第二个传递对象的方法重载，您将无法再将 null 作为该方法的参数传递。

# python - 转换一个字符串，使第一个字母为大写，其他所有字母为小写

> ID：13635215
> 
> 赞同：10
> 
> 时间：2012-11-29T21:38:24.273
> 
> 标签：python

> **可能重复：**
> [如何将字符串中每个单词的首字母大写（Python）？](https://stackoverflow.com/questions/1549641/how-to-capitalize-the-first-letter-of-each-word-in-a-string-python)

是否有转换字符串的选项，使得第一个字母为大写，其他所有字母为小写....如下所示..我知道转换为大写和小写有大写和小写....

> ```
> string.upper() //for uppercase 
> string.lower() //for lowercase
>  string.lower() //for lowercase
> 
> INPUT:-italic,ITALIC
> 
> OUTPUT:-Italic 
> ```

[http://docs.python.org/2/library/stdtypes.html](http://docs.python.org/2/library/stdtypes.html)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-29T21:40:26.000

只需使用`str.title()`：

```
In [73]: a, b = "italic","ITALIC"

In [74]: a.title(), b.title()
Out[74]: ('Italic', 'Italic') 
```

帮助（）`str.title()`：

```
S.title() -> string

Return a titlecased version of S, i.e. words start with uppercase
characters, all remaining cased characters have lowercase. 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-29T21:42:47.523

是的，只需使用 capitalize() 方法。

例如：

```
x = "hello"
x.capitalize()
print x   #prints Hello 
```

标题实际上会将每个单词大写，就好像它是标题一样。Capitalize 只会将字符串中的第一个字母大写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:41:51.827

一个简单的方法：

```
my_string = 'italic'
newstr = my_string[0]
newstr = newstr.upper()
my_string = newstr + my_string[1:] 
```

使它们小写（第一个字母除外）：

```
my_string= 'ITALIC'
newstr = my_string[1:]
newstr = newstr.lower()
my_string = my_string[0] + newstr 
```

我不知道是否有内置功能可以做到这一点，但这应该可以。

# android - Chrome for Android 根据分辨率呈现不同的字体

> ID：13635217
> 
> 赞同：2
> 
> 时间：2012-11-29T21:38:26.067
> 
> 标签：android, google-chrome, font-face, resolution, webfonts

> 编辑 1：显然，我还没有足够的声誉来发布图片，所以我不得不从外部链接它们。
> 
> 编辑 2： 显然，我没有足够的声誉来发布两个以上的超链接，对于不得不复制和粘贴 URL 带来的不便，我深表歉意。

为朋友建立了一个站点 (http://vitkodance.com)，并使用`@font-face`了 Google Web 字体的实现。然后我用一系列后备调用字体。标题是脚本风格，正文是衬线风格。当我在手机上的 Chrome for Android 上加载网站时，字体呈现方式不同，具体取决于手机的方向（以及可用的分辨率）。

这是纵向站点（后备字体）：[Chrome for Android Portrait Rendering](https://www.dropbox.com/s/7syygs1txdnuvfu/Screenshot_2012-11-29-15-45-31.png)。

这是风景中的网站（预期）：[Chrome for Android Landscape Rendering](https://www.dropbox.com/s/7syygs1txdnuvfu/Screenshot_2012-11-29-15-45-31.png)。

在我的 Nexus 7 平板电脑上，字体在两个方向都按预期显示。有没有办法来解决这个问题？这是基于我选择的字体的预期行为，还是必须处理字体大小（以 em 为单位）和行高值的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T22:09:22.103

我遇到了同样的问题并问了类似的问题。

目前，这是一个在这里跟踪的错误[http://code.google.com/p/chromium/issues/detail?id=138257](http://code.google.com/p/chromium/issues/detail?id=138257)

Android 版 Chrome 显示备用字体，但 Dolphin 浏览器显示正确的字体，至少在我的设备上是这样。所以这似乎是一个 Chromium 错误。

对于某些人来说，定义初始比例可以解决问题，如下所示：

```
<meta name="viewport" content="initial-scale=1"> 
```

添加`-webkit-text-size-adjust:100%`到您的 CSS 也可以解决问题。

我希望我有一个明确的答案，但似乎没有。让我知道事情的后续。

**编辑答案**：

我对该问题的解决方案是完全放弃 Google Webfonts，而是将字体下载到 Web 服务器并通过 CSS 调用它们，如下所示：

```
@font-face {
    font-family: 'Droid Sans';
    src: url('fonts/DroidSans-webfont.eot');
    src: url('fonts/DroidSans-webfont.eot?#iefix') format('embedded-opentype'),
         url('fonts/DroidSans-webfont.woff') format('woff'),
         url('fonts/DroidSans-webfont.ttf') format('truetype'),
         url('../fonts/DroidSans-webfont.svg#DroidSansRegular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

Google 的 webfonts 是开源的，因此您应该可以轻松找到字体的下载。

此解决方案适用于 Dolphin 和 Chrome for Android。

# coldfusion - ColdFusion Fusebox 5 - 设置和目录约定

> ID：13635224
> 
> 赞同：1
> 
> 时间：2012-11-29T21:39:14.657
> 
> 标签：coldfusion, installation, fusebox

我正在研究使用 Fusebox 框架进行的一些 ColdFusion 开发——我已经安装了 CF10 并下载了 Fusebox 5.5 和他们的示例骨架应用程序，但我仍然想要他们的[设置指南](http://www.fusebox.org/index.cfm/getting-started/setting-up-fusebox/)。

我可以通过在我的 webroot 中放置一个目录和一个基本的 index.cfm 来获得一个基本的应用程序（Hello World 风格），但是当我尝试访问框架应用程序时，我收到一个错误，说找不到 Fusebox 文件。

有人可以描述在我的 Web 服务器中构建我的应用程序和 FuseBox 文件的常见约定/最佳实践吗？

我目前有以下结构：

```
+ wwwroot
    +skeletonapplication (the skeleton application)
    +FBCore (Fusebox core files) 
```

此外，文档提到我需要在 index.cfm 中添加一行以确认目录结构 - 任何人都可以进一步了解配置行的外观吗？

[最后，如果有人可以为单个应用程序提供通用目录结构最佳实践，那就太好了。我希望他们与Initialize](http://www.initializr.com/)等使用的典型布局有共同点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T22:43:04.747

默认情况下，Fusebox 核心文件应位于 webroot 中名为 /fusebox5 的文件夹中。或者（可能是推荐的部署）是将它们定位在 webroot 之外，并在您的 Application.cfc 或 ColdFusion Admin 中创建一个名为 fusebox5 的映射到该目录。

从那里开始，它清楚地显示了 Fusebox 5 应用程序的正确结构。Fusebox 应用程序有两种实现，它们也可以在一定程度上混合和匹配：隐式和 XML（显式）。

```
+wwwroot
    +myApp
        +controller
        +model
        +view
        +layouts
+fusebox5 
```

您可以通过调整 application.cfc 中的行来自定义 fusebox 核心文件的位置：

```
<cfcomponent extends="fusebox5.Application" output="false"> 
```

假设您将核心文件移动到 webroot 的 FBCore 目录中：

```
<cfcomponent extends="FBCore.Application" output="false"> 
```

查看 Fusebox.org 的最新下载，开箱即用它对新开发人员并不友好。尝试下载版本 5 和版本 4 的示例书店应用程序（如果您想查看工作中的 xml）。该框架停滞了多年，但有一个新的小组正在研究该框架，但我不确定该小组现在的位置。

Sean Corfield 是 Fusebox 过去的核心维护者之一，他最近写道，他认为他的 FW/1 框架是 Fusebox 的继任者。Fusebox 被吹捧为“功能完备”的框架，这意味着为它计划的所有大功能都已完成，我认为 FW/1 也处于类似的状态。

维护最积极的框架是 Coldbox。它也支持 xml 和现在的隐式 (no-xml) 风格，它背后的团队几乎太定期地发布大量产品和功能（很难跟上！）。它确实附带了很多文档，但该框架可以在阳光下完成所有工作。他们发布了一个 Lite 版本，可能会让新开发人员更容易加入。

# c# - 使用 linq 查询填充 ListBox - 未设置值

> ID：13635226
> 
> 赞同：2
> 
> 时间：2012-11-29T21:39:25.477
> 
> 标签：c#, linq, data-binding, listbox

谁能告诉我为什么这不会将 ListItems 上的值设置为 ID？值和文本都显示为 DISPLAY_NAME

```
 lstSelected.DataSource = entities.User
     .Where(x => SelectedItems.Contains(x.ID))
     .Select(x => new ListItem { Text = x.DISPLAY_NAME, Value = x.ID })
     .ToList<ListItem>();

  lstSelected.DataBind(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:41:51.073

尝试设置`DisplayMember`和`ValueMember`属性（或者`DataTextField`如果`DataValueField`您使用的是 asp.net）

```
lstSelected.DisplayMember = "DISPLAY_NAME";
lstSelected.ValueMember = "ID";
lstSelected.DataSource = entities.User
     .Where(x => SelectedItems.Contains(x.ID))
     .ToList();
lstSelected.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:02:58.830

您有 2 个选项（您都以错误的方式使用）：

设置`DataSource`,`DataTextField`和`DataValueField`:

```
lstSelected.DataSource = entities.User
       .Where(x => SelectedItems.Contains(x.ID))
       .ToList<ListItem>();

lstSelected.DataTextField = "DISPLAY_NAME";
lstSelected.DataValueField = "ID";

lstSelected.DataBind(); 
```

或实例化`ListItem`s 并将它们添加到您的`ListBox`：

```
List<ListItem> mySelectedItems  = entities.User
       .Where(x => SelectedItems.Contains(x.ID))
       .Select(x => new ListItem { Text = x.DISPLAY_NAME, Value = x.ID })
       .ToList<ListItem>();

foreach(ListItem item in mySelectedItems)
{
    lstSelected.Items.Add(item);
}
lstSelected.DataBind(); 
```

# objective-c - 从不同的视图切换视图 Objective-c

> ID：13635232
> 
> 赞同：1
> 
> 时间：2012-11-29T21:39:51.140
> 
> 标签：objective-c

我正在使用 MFSideMenu 制作一个 facebook 风格的滑出菜单。我正在尝试获取它，因此当我单击菜单幻灯片中的某个单元格时，它会切换到特定视图...

我的问题是，如何将初始视图设置为切换到新视图，而不是菜单视图本身...

显然，使用下面的代码将改变这个视图，我需要能够改变另一个视图，称为 HomeViewController 到另一个视图......

```
[self presentModalViewController:viewControllerNameHere animated:YES]; 
```

谢谢你的帮助！

# php - WordPress，启用对特定页面的评论？

> ID：13635233
> 
> 赞同：1
> 
> 时间：2012-11-29T21:39:51.877
> 
> 标签：php, wordpress

我知道如何在所有页面上启用/禁用评论。但是我怎样才能在不使用 UI 的情况下只启用一些。在`functions.php`我只想去

```
if($this_is_a_page_i_want_comments_on) { enable_comments(); } 
```

`enable_comments();`不存在，这是我需要帮助的部分。

我可以使用 WordPress Admin 来做到这一点，允许在所有页面上发表评论，然后转到每个页面并在我不想要的地方禁用评论。不过，这将花费太长时间。

PS我正在使用Genesis框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:49:51.767

只需连接到`comments_open`过滤器 :) 如果您[在源代码中查找](http://core.trac.wordpress.org/browser/tags/3.4.2/wp-includes/comment-template.php#L772)该`comments_open()`函数的工作原理，您会注意到该函数获取了有问题的帖子，然后通过`comments_open`过滤器运行它。这是一个覆盖它的示例函数：

```
function my_override_comments_open( $open ) {
    if ( $this_is_a_page_i_want_comments_on ) {
        $open = true;
    }
    return $open;
}
add_filter('comments_open', 'my_override_comments_open', 1000); 
```

我假设您知道如何识别要启用评论的页面 - 这取决于您。

PP：我不知道它是否可以在 Genesis 中工作（我想应该可以）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:42:24.493

```
if (is_single('page_name_here') || is_single('other_page')) {
    // Show the comment form here
} 
```

不确定是否有更好的方法，这只是我的解决方案！

# python - 如何使用python的yield语句

> ID：13635237
> 
> 赞同：0
> 
> 时间：2012-11-29T21:40:03.323
> 
> 标签：python, generator, yield, subset

我有一个项目列表，并希望生成所有可能的子集。因此，我使用了一个递归函数，其中项目编号和所有选定项目的列表作为参数。该函数以 0 作为第一个参数调用，并执行以下操作：

*   它查看 index 参数描述的项目
*   它选择它
*   它使用递增的索引参数调用自身
*   它取消选择项目
*   它使用递增的索引参数调用自身

我需要可能的子集来优化某些东西，但由于列表会很长，我无法查看所有子集。起初我尝试使用蛮力来考虑所有子集，但这是一个幼稚的想法。现在新的计划是创建一个贪心算法，它采用第一个“有用”的选择：我想查看所有子集，直到找到一个适合我的需要并认为 python 的 yield 语句正是正确的选择。这是一些代码：

```
def bruteForceLeft(selected,index):
    #left is the list of which i need subsets
    #its a gobal variable. to test the code, just make sure that you have a 
    #list called left in scope
    if index==len(left):
        #print(selected)
        yield selected
    else:
        #the algorithm stores the selection in a tuple of two lists
        #that's necessary since there's a second list called right as well
        #I think you can just ignore this. Think of selected as a list that
        #contains the current selection, not a tuple that contains the current
        #selection on the right as well as the left side.
        selected[0].append(left[index])
        bruteForceLeft(selected,index+1)
        selected[0].pop()
        bruteForceLeft(selected,index+1)

#as you can see I pass a tuple of two empty lists to the function.
#only the first one is used in this piece of code
for option in bruteForceLeft( ([],[]) ,0):
    print(option)
    #check if the option is "good"
    #break 
```

输出是：没有

起初我以为我在生成子集时出错了，但是在 if 条件下你可以看到我有一个注释打印语句。如果我取消注释此打印语句，而是注释掉 yield 语句，所有可能的选择都会被打印 - 并且 for 循环被破坏

使用 yield 语句，代码运行没有错误，但它也不做任何事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:42:32.913

问题是当您递归调用时`bruteForceLeft`，产生的值不会神奇地从封闭函数中产生。因此，您需要自己重新生成它们：

```
def bruteForceLeft(selected,index):
    #left is the list of which i need subsets
    if index==len(left):
        #print(selected)
        yield selected
    else:
        #the algorithm stores the selection in a tuple of two lists
        #that's necessary since there's a second list called right as well
        #I think you can just ignore this. Think of selected as a list that
        #contains the current selection, not a tuple that contains the current
        #selection on the right as well as the left side.
        selected[0].append(left[index])
        for s in bruteForceLeft(selected,index+1):
            yield s
        selected[0].pop()
        for s in bruteForceLeft(selected,index+1):
            yield s 
```

（编辑：我实际上只是测试了这个，你的代码有错误，但我很确定不是重新生成是问题）

# prolog - 如何编写一个序言语句以从列表中删除每个偶数顺序元素

> ID：13635241
> 
> 赞同：1
> 
> 时间：2012-11-29T21:40:16.667
> 
> 标签：prolog

我想写一个序言语句来从列表中删除每个偶数顺序元素

输入： `[a,b,c,d,e]` 输出：`[a,c,e]`

谁能帮助我如何为此编写序言声明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:06:26.203

这是我对您的问题的解决方案。

```
remove_even_order([],[]). %this line says if I somehow get to an empty list the result I should return is an empty list 
remove_even_order([Head_ODD|[]],[Head_ODD]). 
remove_even_order([Head_ODD,Head_EVEN|Tail],[Head_ODD|RezultTail]) :- remove_even_order(Tail,RezultTail). 
```

这个问题是一个微不足道的问题，但如果你想要我，我会为你评论每一行。

以下是您要求的评论：

**第一行：** 这行说如果我以某种方式到达一个空列表，我应该返回的结果是一个空列表

**第二行：**这里我们说如果一个列表只包含一个元素（Head_ODD），那么结果列表也应该只包含那个头

**第三行：**如果我们的列表在结果列表中有 2 个或更多元素（Head_ODD,HEAD_EVEN + Tail），我应该只放置 HEAD_ODD ，并尝试递归解决 Tail 的其余部分

# xml - Kettle 'XML 输出' 步骤改变 / 到 /

> ID：13635242
> 
> 赞同：2
> 
> 时间：2012-11-29T21:40:19.483
> 
> 标签：xml, url, pentaho, kettle

我正在尝试使用 Kettle 将 xml 输出到文件，但它正在更改我的 URL：

```
http://test.com 
```

到：

```
http:&#47;&#47;test.com 
```

知道如何防止网址更改吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T16:16:31.113

我知道这种行为，我使用“输出到文件”步骤而不是“输出到 xml”步骤来解决。在此步骤之前添加一个名为 new xml 的新步骤，并将 xml 行输出到“最终输出到文件”步骤。这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:54:01.587

根据[StackOverflow 上的这个问题，](https://stackoverflow.com/questions/539143/xml-entity-for)`/`对编码没有一般要求，但`&#47;`它是正确的转义码，因此 Kettle 的行为在这里似乎不是必需的。查看您可以在该步骤中设置的内容，唯一可能与此相关的是 XML 文件中写出的文本的编码。我不知道你现在设置了什么，但你可能需要尝试不同的编码来避免这个问题。

如果做不到这一点，我会在论坛上联系 Pentaho 或提交错误，因为这种行为似乎没有充分的理由。

# java - 检测对象 Slick2d 上的鼠标点击

> ID：13635244
> 
> 赞同：0
> 
> 时间：2012-11-29T21:40:25.753
> 
> 标签：java, slick2d

我制作的这段代码成功地在 800x600px 的板上创建了一个 16x12 的 50x50 方格的网格。如您所见，玩家移动到玩家鼠标点击的坐标。

网格的每个方格上都有一个 Felt（字段）对象，可以是 laast（锁定）。如果字段锁定属性设置为 1，则不应将播放器移动到该位置。

我如何检测玩家试图继续前进以实现这一目标的领域？

```
public class SimpleGame extends BasicGame{

    private Image plane;
    private float planeX;
    private float planeY;

    public SimpleGame()
    {
        super("SpilTest");
    }

    @Override
    public void init(GameContainer gc) throws SlickException {
        plane = new Image("figur.png");
    }

    @Override
    public void update(GameContainer gc, int delta) throws SlickException {
        Input input = gc.getInput();

        if (input.isMousePressed(input.MOUSE_LEFT_BUTTON)) {
            this.planeX = input.getMouseX() - 30;
            this.planeY = input.getMouseY() - 50;
        }

    }

    public void render(GameContainer gc, Graphics g) throws SlickException {

        Felt board[][] = nytGrid();

        int distancex = 0;
        int distancey = 0;
        int counter = 0;

        for (int i=0; i < board.length ; i++) {
            for (int j=0; j < board[i].length ; j++) {                
                if (board[i][j].getLaast() == 1) {
                    g.setColor(Color.red);
                    g.fillRect(distancex, distancey, 50, 50);
                }

                distancex += 50;
                counter++;
                if (counter == 16) {
                    distancey += 50;
                    distancex = 0;
                    counter = 0;
                }
            }
        }

        g.drawImage(plane, planeX, planeY);

    }

    public static void main(String[] args) throws SlickException {

         AppGameContainer app = new AppGameContainer(new SimpleGame());

         app.setDisplayMode(800, 600, false);
         app.setTargetFrameRate(60);
         app.start();
    }

    public Felt[][] nytGrid() {

        Felt [][] board = new Felt[16][12];        

        for (int i=0; i < board.length ; i++) {
            for (int j=0; j < board[i].length ; j++) {
                int x = i;
                int y = j;
                board[i][j] = new Felt(x, y);

                if (i == 5 && j == 5) {
                    board[i][j].setLaast(1);
                }
            }
        }

        return board;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T09:34:30.863

首先，您可能应该在 init() 方法中初始化板而不是渲染，因此不必每帧都这样做，并将网格的声明移动到类中的平面、平面 X 和平面 Y 声明旁边.

现在要禁止移动到锁定的正方形，首先添加一个方法来检查某个坐标处的正方形是否被锁定，因此类似于：

```
private boolean isLocked(int x, int y) {
    int square = board[x/50][y/50];
    if (square == 1) return true;
    else return false;
} 
```

接下来修改 update() 方法中更新平面坐标的部分，模糊如下：

```
if (input.isMousePressed(input.MOUSE_LEFT_BUTTON)) {
        int destX = input.getMouseX() - 30;
        int destY = input.getMouseY() - 50;
        if (!isLocked(destX, destY)) {
                   this.planeX = destX;
                   this.planeY = destY;     
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-02T15:42:09.900

这简单！

```
int mx = Mouse.getX();
int my = Mouse.getY(); 
```

但是，它为您提供了世界坐标，您必须将其转换为像素：

```
int mx = Mouse.getX();
int my = Mouse.getY() * -1 + (Window.WIDTH / 2) + 71; 
```

# ios - 我需要 View 还是 ViewController？

> ID：13635249
> 
> 赞同：0
> 
> 时间：2012-11-29T21:40:32.600
> 
> 标签：ios, uikit

我正在使用包含各种子控件的 xib 文件构建自定义视图。我有一些容器控件需要保存我的自定义视图。我有点不清楚我是否需​​要创建一个以某种方式从 xib 文件加载自身的视图，或者一个执行此操作的 ViewController。

不管它完成了，我希望我的自定义视图是可重用的，以及出现在 Xcode 工具箱中的东西，以及侧面按钮和文本框等，所以我可以直观地设计包含我的自定义视图的其他视图。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:53:51.157

您的组件是否管理其他视图控制器（例如 UITabBarViewController 所做的）？如果是，则使其成为视图控制器的子类，如果不是，则它只是一个控件，例如开关或花哨的按钮，滚轮等，然后使其成为 UIView 的子类。

# ruby-on-rails - 资产管道未导入 ERB

> ID：13635250
> 
> 赞同：3
> 
> 时间：2012-11-29T21:40:35.100
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, asset-pipeline

我最近将一个旧应用程序升级到 Ruby on Rails 3.2.9。在启用资产管道时，我将`css.scss`文件更改为，`css.scss.erb`以便我可以使用帮助程序仅加载指纹图像文件，如下所示：

```
`background: url(<%= asset_path "wishlist.png" %>)` 
```

这适用于独立文件，但是当`css.scss.erb`文件必须由 导入时`screen.css.scss`，它会返回以下错误：

```
`Invalid CSS after "...d: url(": expected ")", was "<%= asset_path ..." 
```

我尝试了有关此[问题](https://stackoverflow.com/questions/8230725/css-in-rails-asset-path-not-processed-by-erb-in-development)的所有建议，但在使应用程序加载指纹文件时，它们都没有避免错误。

有什么解决办法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T20:55:53.990

问题是[Ruby on Rails 资产管道指南中](http://guides.rubyonrails.org/asset_pipeline.html)提供的 sass-helpers使用连字符而不是下划线。将所有内容更改`image_path`为`image-path`（等等），它应该可以正常工作，如下所示：

`background: url(image_path("wishlist.png"));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:35:16.023

这不是一个直接的解决方案，但如果您使用的是 sass-rails，那么您可以使用它提供的资产路径帮助程序，如此[处所述](http://guides.rubyonrails.org/asset_pipeline.html#css-and-sass)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T15:45:11.463

试试这个链接：http: [//guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

此外，您应该检查您的宝石是否已更新。尝试将“load 'deploy/assets'”添加到您的 Capfile（不带引号）

如果上述方法均无效，请尝试关闭开发环境中的调试：config.assets.debug = false（在您的环境/development.rb 上执行此操作）

这样您就可以尝试更自由地检查代码而无需部署

希望这对您有所帮助。问题解决后分享结果！;)

# ruby - 如何计算来自 Gmail atom 提要的电子邮件链中的对话数

> ID：13635254
> 
> 赞同：0
> 
> 时间：2012-11-29T21:41:03.623
> 
> 标签：ruby, xml, email, gmail, atom-feed

有没有办法计算构成 Gmail 电子邮件链的对话数量？XML 提要只为包含多封电子邮件的电子邮件链返回一个条目。

因此，例如，如果我有 3 封电子邮件由同一个电子邮件地址发送且具有相同的主题行，则这三封电子邮件将全部组合在一起以显示为一封电子邮件，从而使我错误地计数为 1。

我尝试过的事情-

1) 禁用 - 来自电子邮件设置的对话视图

2）使用的 ruby​​ gem`gmail`确实计算了单个电子邮件，但我不能仅按日期按时间过滤，这对我来说是绝对必须的（因为我会每隔一小时检查一次新电子邮件）

任何人都可以建议一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:32:28.127

似乎[gmail gem](https://github.com/nu7hatch/gmail)被硬编码为仅使用日期。如果你对它进行分叉并进行这些修改，你可能会使其工作。

在 lib/gmail.rb 中，添加一个`to_imap_datetime`方法：

```
class Object
  def to_imap_date
    Date.parse(to_s).strftime("%d-%B-%Y")
  end

  def to_imap_datetime
    Time.parse(to_s).strftime("%d-%b-%Y %H:%M %z")
  end
end 
```

在 lib/gmail/mailbox.rb 的`emails`方法中，将调用从 更改`to_imap_date`为`to_imap_datetime`。

现在你应该能够做到这一点：

```
gmail.inbox.count(:after => 1.hour.ago) 
```

# mysql - mysql 插入条件

> ID：13635255
> 
> 赞同：1
> 
> 时间：2012-11-29T21:41:05.027
> 
> 标签：mysql, insert, conditional-statements

我有一个 mysql 数据库和一个向其中插入内容的表单。`Status`如果有一行等于“新建”或“重新部署”并且是相同的 $tag （这是他们输入到表单区域的内容），我想阻止添加一行

基本上，如果 $tag 已经存在且状态为“new”或“redeploy”，我想阻止人们添加条目。有点难以解释

这是我目前的查询任何帮助或想法将不胜感激。

```
mysql_query ("INSERT INTO Assets (`Badge`, `First Name`, `Last Name`, `Service Tag`, `Asset Tag`, `Status`, `Employee Status`, `Username`, `deleted`)
                     VALUES('$badge', '$first', '$last', '$tag', '$asset', '$status', '$estatus', '$user', '$deleted') ") or die (mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:42:59.927

最好的方法是对表使用检查约束。这样，无论插入/更新如何进行，您的条件将始终得到执行。

[http://www.w3schools.com/sql/sql_check.asp](http://www.w3schools.com/sql/sql_check.asp)

对于这样的事情，您可能还想创建一个函数。所以你的函数看起来像：

```
CREATE FUNCTION CheckAssetRows(@Tag VARCHAR(50))
RETURNS INT
AS 
BEGIN
    DECLARE @NumInvalidRows INT

    SELECT @NumInvalidRows = COUNT(*) 
    FROM Asset 
    WHERE [Service Tag]=@Tag
    AND [Status] in ('New', 'Redeploy')

    RETURN @NumInvalidRows
END
GO 
```

您的检查很容易：

```
ALTER TABLE ASSET
ADD CONSTRAINT chk_Tag CHECK(CheckAssetRows([Service Tag]) = 0) 
```

# java - 将多个 JPanel 叠放在一起

> ID：13635278
> 
> 赞同：2
> 
> 时间：2012-11-29T21:42:36.420
> 
> 标签：java, swing, jpanel, layout-manager

我有这段代码，它制作了一个 JPanel 并将其添加到 JScrollPanel。它工作正常，但是当我尝试添加第二个 JPanel 时，它会删除第一个并添加第二个。我希望能够将 JPanel 放在 JPanel 之上，我该怎么做？

```
// Location of an image:
String file = wfc.getSelectedFile().getPath();

// Creates images from different types:
ImageHandler image = new ImageHandler();
BufferedImage imageData = image.imageData(file);

// Extends JPanel, Layer is a JPanel
Layer layer = new Layer(image.width(), image.height());
layer.setImage(imageData);
layer.setSizeFromLoaded();
// A list of all the JPanels added
Layers.set(Layers.layers.size(), layer);

// Adds a JPanel to the JScrollPanel
imagePane.getViewport().add(layer, BorderLayout.CENTER); 
```

这是完整的方法，它打开文件浏览器，然后选择图像时运行上面的代码

```
private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {
    WebFileChooser wfc = null;
    if(wfc == null){
        wfc = new WebFileChooser(this, "Open an Image");
        wfc.setSelectionMode(SelectionMode.SINGLE_SELECTION);
        wfc.setAvailableFilter(GlobalConstants.IMAGES_AND_FOLDERS_FILTER);
        wfc.setChooseFilter(GlobalConstants.IMAGES_FILTER);
        wfc.setCurrentDirectory("/Users");
    }
    wfc.setVisible(true);

    if(wfc.getResult() == StyleConstants.OK_OPTION){
        String file = wfc.getSelectedFile().getPath();

        ImageHandler image = new ImageHandler();
        BufferedImage imageData = image.imageData(file);

        Layer layer = new Layer(image.width(), image.height());
        layer.setImage(imageData);
        layer.setSizeFromLoaded();
        Layers.set(Layers.layers.size(), layer);

        imagePane.getViewport().add(layer, BorderLayout.CENTER);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T21:50:35.040

您可能希望考虑将面板放入使用[`CardLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html).

这将使您可以轻松地在面板之间切换，从而产生分层面板的错觉，而无需手动操作。

就像是...

```
JPanel master = new JPanel(new CardLayout());
master.add(new ChildPane()); // Or what ever child you want to add
master.add(new ChildPane()); // Or what ever child you want to add
//...
JScrollPane scrollPane = new JScrollPane(master); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T22:35:09.150

我使用了 Zove Games 的建议并将其放在 JLayerdPanel 中，并且效果很好！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:44:52.360

您可以将两个面板放在一个 JPanel 中，然后将其放在 JScrollPane 中。

# bash - 如何使用 shell 命令检查 SVN 签出文件并在目录中创建链接

> ID：13635279
> 
> 赞同：3
> 
> 时间：2012-11-29T21:42:36.090
> 
> 标签：bash, svn

基本上我的问题是如何使用 bash shell 命令自动执行以下操作，这样我就可以轻松跟踪修改后的文件。

1.  列出 svn 签出文件
2.  在名为“change”的目录中创建指向上述文件的链接文件

* * *

```
laptop$ svn status -q

M            rcms/src/config/ta_show.c
M            rcms/src/config/ta_config.c

laptop$ cd  change
laptop$ link -s ../rcms/src/config/ta_show.c ta_show.c
laptop$ link -s ../rcms/src/config/ta_config.c ta_config.c

laptop$ ls
lrwxrwxrwx 1 root root 59 Nov 27 12:24 ta_show.c -> ../rcms/src/config/ta_show.c
lrwxrwxrwx 1 root root 59 Nov 27 12:24 ta_config.c -> ../rcms/src/config/ta_config.c 
```

我正在考虑使用如下 shell 命令：

```
$ svn status -q | sed 's/M       //' | xargs -I xxx ln -s ***BETWEEN REAL FILE AND BASE FILENAME*** 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:07:08.340

你有两件事需要关注：

*   每个文件之间的空行，svn status 'M'
*   提取文件名

awk 一个班轮可以做到：

```
awk '$0{x=$2;gsub(".*/","",x);print "ln -s ../"$2" "x}' 
```

因此，如果您将`svn status`输出通过管道传输到上面的行，它会为您打印`ln -s`命令行。

如果您希望执行 ln -s 行，您可以将输出通过管道传输到 sh ( `svn status|awk ...|sh`) 或替换`print`为`system`

最后，我想以下面的输出为例：

```
kent$ echo "M            rcms/src/config/ta_show.c

M            rcms/src/config/ta_config.c"|awk '$0{x=$2;gsub(".*/","",x);print "ln -s .."$2" "x}'
ln -s ../rcms/src/config/ta_show.c ta_show.c
ln -s ../rcms/src/config/ta_config.c ta_config.c 
```

# ios - iOS日历访问权限对话框，强制它出现？

> ID：13635288
> 
> 赞同：27
> 
> 时间：2012-11-29T21:42:59.660
> 
> 标签：ios, calendar, ios6, ios-permissions

我编写了一个请求访问 iPad 日历的应用程序。在 iOS 6 下，会出现一个系统对话框，询问用户是否可以。

问题是，一旦发生这种情况，我就无法复制。出于测试目的，我想强制该对话框始终出现。相反，操作系统会缓存以前的设置，并且不会再次弹出对话框。即使我从 iPad 上删除应用程序并重新安装，情况仍然如此。（更改应用程序名称和捆绑包可以解决问题，但我不想每次测试时都这样做。）

有谁知道如何强制它出现？

谢谢。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-12-03T23:56:23.080

设置 > 通用 > 重置 > 重置位置和隐私

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-18T12:07:54.317

您可以按照 Greg Maletic 的建议*重置位置和隐私*，但如果您不想重置所有应用程序，则只需更改应用程序的捆绑标识符即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-28T07:14:06.093

在 iOS 9 及更高版本上，卸载并安装应用程序，将出现访问权限对话框。但 iOS 8 会记住你的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-23T04:44:13.530

在**iOS 10.2.1**上：

我只是再次卸载并重新安装该应用程序，权限对话框再次出现。

# arrays - 如何在 Bash 中找到数组元素的总和？

> ID：13635293
> 
> 赞同：15
> 
> 时间：2012-11-29T21:43:29.893
> 
> 标签：arrays, bash, shell, unix

我正在尝试添加由`read -a`命令的用户输入定义的数组元素。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-29T21:50:45.747

```
read -a array
tot=0
for i in ${array[@]}; do
  let tot+=$i
done
echo "Total: $tot" 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-11-29T22:01:35.427

给定一个（整数）数组，这是一种添加其元素的有趣方法（在 bash 中）：

```
sum=$(IFS=+; echo "$((${array[*]}))")
echo "Sum=$sum" 
```

例如，

```
$ array=( 1337 -13 -666 -208 -408 )
$ sum=$(IFS=+; echo "$((${array[*]}))")
$ echo "$sum"
42 
```

优点：没有循环，没有 subshel​​l！

缺点：仅适用于整数

### 编辑 (2012/12/26)。

随着这篇文章的出现，我想与您分享另一种有趣的方式，使用`dc`，它不仅限于整数：

```
$ dc <<< '[+]sa[z2!>az2!>b]sb1 2 3 4 5 6 6 5 4 3 2 1lbxp'
42 
```

这条奇妙的线将所有数字相加。整齐，嗯？

如果您的号码在数组中`array`：

```
$ array=( 1 2 3 4 5 6 6 5 4 3 2 1 )
$ dc <<< '[+]sa[z2!>az2!>b]sb'"${array[*]}lbxp"
42 
```

事实上，负数有一个问题。数字 '-42' 应该被赋予`dc`as `_42`，所以：

```
$ array=( -1.75 -2.75 -3.75 -4.75 -5.75 -6.75 -7.75 -8.75 )
$ dc <<< '[+]sa[z2!>az2!>b]sb'"${array[*]//-/_}lbxp"
-42.00 
```

会做。

优点：适用于浮点数。

缺点：使用外部进程（但如果您想进行非整数运算，则别无选择 - 但`dc`可能是此任务中最轻的）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-07-27T12:42:12.977

我的代码（我实际使用的）受到[gniourf_gniourf](https://stackoverflow.com/a/13635566/1300875)答案的启发。我个人认为这更易于阅读/理解和修改。也接受浮点数，而不仅仅是整数。

对数组中的值求和：

```
arr=( 1 2 3 4 5 6 7 8 9 10 )
IFS='+' sum=$(echo "scale=1;${arr[*]}"|bc)
echo $sum # 55 
```

只需稍加改动，即可得到平均值：

```
arr=( 1 2 3 4 5 6 7 8 9 10 )
IFS='+' avg=$(echo "scale=1;(${arr[*]})/${#arr[@]}"|bc)
echo $avg # 5.5 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-01-26T16:06:36.450

gniourf_gniourf 的[答案](https://stackoverflow.com/a/13635566/8271263)非常好，因为它不需要循环或 bc。对于任何对真实示例感兴趣的人，这里有一个函数可以汇总从 /proc/cpuinfo 读取的所有 CPU 内核，而不会弄乱 IFS：

```
# Insert each processor core count integer into array
cpuarray=($(grep cores /proc/cpuinfo | awk '{print $4}'))
# Read from the array and replace the delimiter with "+"
# also insert 0 on the end of the array so the syntax is correct and not ending on a "+"
read <<< "${cpuarray[@]/%/+}0"
# Add the integers together and assign output to $corecount variable
corecount="$((REPLY))"
# Echo total core count
echo "Total cores: $corecount" 
```

我还发现从双括号内调用数组时算术扩展工作正常，无需读取命令：

```
cpuarray=($(grep cores /proc/cpuinfo | awk '{print $4}'))
corecount="$((${cpuarray[@]/%/+}0))"
echo "Total cores: $corecount" 
```

通用的：

```
array=( 1 2 3 4 5 )
sum="$((${array[@]/%/+}0))"
echo "Total: $sum" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-11-04T19:31:07.583

我喜欢简洁，所以这是我倾向于使用的：

```
IFS="+";bc<<<"${array[*]}" 
```

它本质上只是列出了数组的数据并将其传递给 BC 来评估它。“IFS”是内部字段分隔，它本质上是指定如何分隔数组，我们说用加号分隔它们，也就是说当我们将它传递给BC时，它会收到一个由加号分隔的数字列表，所以很自然它将它们加在一起。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-01-26T19:14:14.753

另一种`dc`&`bash`方法：

```
arr=(1 3.88 7.1 -1)
dc -e "0 ${arr[*]/-/_} ${arr[*]/*/+} p" 
```

输出：

```
10.98 
```

`0 1 3.88 7.1 _1 + + + + p`上面用运行表达式`dc`。请注意虚拟值`0`，因为 s 太多了`+`，还请注意通常的负数前缀`-`必须更改为`_`in `dc`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-30T16:09:11.027

```
arr=(1 2 3) //or use `read` to fill the array
echo Sum of array elements: $(( ${arr[@]/%/ +} 0))
Sum of array elements: 6 
```

解释：

1.  `"${arr[@]/%/ +}"`将返回`1 + 2 + 3 +`
2.  通过在最后添加额外的零，我们将得到`1 + 2 + 3 + 0`
3.  通过像这样用 BASH 的数学运算包装这个字符串`$(( "${arr[@]/%/ +} 0"))`，它将返回总和

**这可以用于其他数学运算。**

1.  对于减去只是`-`使用
2.  用于乘法`*`，`1`而不是`0`

**也可以与逻辑运算符一起使用。**

1.  布尔和示例 - 检查所有项目是否为真 (1)

    `arr=(1 0 1)`

    `if [[ $((${arr[@]/%/ &} 1)) -eq 1 ]]; then echo "yes"; else echo "no"; fi`

    这将打印：否

2.  布尔或示例 - 检查任何项目是否为真 (1)

    `arr=(1 0 0)`

    `if [[ $((${arr[@]/%/ |} 0)) -eq 1 ]]; then echo "yes"; else echo "no"; fi`

    这将打印：是

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-21T16:01:31.610

我发现使用递增变量非常简单：

```
result2=0
for i  in ${lineCoffset[@]};
do
    result2=$((result2+i))  
done
echo $result2 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-11T11:22:09.233

一个简单的方法

```
function arraySum 
{
        sum=0
        for i in ${a[@]};
        do
              sum=`expr $sum + $i`  
        done
        echo $sum
}

a=(7 2 3 9)
echo -n "Sum is = " 
arraySum ${a[@]} 
```

# sql - 我需要创建一个根据前缀合并所有表的视图（每月添加新表）

> ID：13635295
> 
> 赞同：0
> 
> 时间：2012-11-29T21:43:48.323
> 
> 标签：sql, sql-server, sql-server-2012

我的客户使用的集成软件是从 RMS 系统中提取 ISAM 文件并创建许多具有相同架构的表，但是他们使用的软件不支持将它们合并在一起。

以下是一些示例表名：

*   SOME_TABLE_XYZ_2012OCT
*   SOME_TABLE_ABC_2012OCT
*   SOME_TABLE_LMN_2012OCT
*   SOME_TABLE_XYZ_2012NOV
*   SOME_TABLE_ABC_2012NOV
*   SOME_TABLE_LMN_2012NOV

我需要将这些全部汇总到一个名为 SOME_TABLE 的单个视图中，并将数据联合全部放在一起。它必须是动态的，因为可以有新的 3 个字符代码，并且显然每月都会创建新表。

理想情况下，我想要一个创建名为 SOME_TABLE 的视图的 SP，然后我可以查询 SOME_TABLE 以完成我需要的工作（将 ETL 计划到 sql server 2012 数据仓库中）。我知道我可以让 SP 返回一个游标，但是如果我需要性能和其他 ETL 工具的易用性，创建视图可以让我灵活地使其成为索引视图。

我想查询 sys.tables （或任何它），并从那里开始为创建视图构建一个 sql 语句。

关于如何解决这个问题的任何其他好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:53:57.247

您可以使用此查询批处理来创建视图。但是你需要不断更新它。

```
declare @v nvarchar(max) =
    (
        select stuff((
        select cast(' union all select * from ' as nvarchar(max)) + quotename(name)
          from sys.tables
         where name like 'SOME\_TABLE\____\_[0-9][0-9][0-9][0-9][a-Z][a-Z][a-Z]' escape '\'
           for xml path('a'), type
        ).value('.','nvarchar(max)'),1,11,'')
    );
set @v = 'CREATE VIEW SOME_TABLE AS ' + @v;
exec (@v); 
```

这是一个存储过程，它采用基表名称，并为它创建一个视图（我将上面的代码包装到一个带参数的过程中）

```
 SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    CREATE PROCEDURE spCreateUnionedView
        @BaseTableName varchar(100)
    AS
    BEGIN
        SET NOCOUNT ON;

        declare @v nvarchar(max) =
        (
            select stuff((
            select cast(' union all select * from ' as nvarchar(max)) + quotename(name)
              from sys.tables
             where name like replace(@BaseTableName, '_', '\_') + '\____\_[0-9][0-9][0-9][0-9][a-Z][a-Z][a-Z]' escape '\'
               for xml path('a'), type
            ).value('.','nvarchar(max)'),1,11,'')
        );

        declare @s nvarchar(max) = 'DROP VIEW ' + @BaseTableName;
        exec (@s);

        set @v = 'CREATE VIEW ' + @BaseTableName + ' AS ' + @v;
        exec (@v);

    END
    GO 
```

# simple.data - 没有 where 子句的 Simple.Data 连接，包括任何主表列

> ID：13635296
> 
> 赞同：1
> 
> 时间：2012-11-29T21:44:02.150
> 
> 标签：simple.data

我正在使用 Simple.Data 并且一直在尝试找到一个示例，该示例可以让我使用 WHERE 子句中的唯一条件来自连接表进行连接。我见过的所有示例总是在 WHERE 中包含主表中的至少一列。以以下数据为例：

```
private void TestSetup()
{
    var adapter = new InMemoryAdapter();
    adapter.SetKeyColumn("Events", "Id");
    adapter.SetAutoIncrementColumn("Events", "Id");
    adapter.SetKeyColumn("Doors", "Id");
    adapter.SetAutoIncrementColumn("Doors", "Id");
    adapter.Join.Master("Events", "Id").Detail("Doors", "EventId");
    Database.UseMockAdapter(adapter);
    db.Events.Insert(Id: 1, Code: "CodeMash2013", Name: "CodeMash 2013");
    db.Events.Insert(Id: 2, Code: "SomewhereElse", Name: "Some Other Conf");
    db.Doors.Insert(Id: 1, Code: "F7E08AC9-5E75-417D-A7AA-60E88B5B99AD", EventID: 1);
    db.Doors.Insert(Id: 2, Code: "0631C802-2748-4C63-A6D9-CE8C803002EB", EventID: 1);
    db.Doors.Insert(Id: 3, Code: "281ED88F-677D-49B9-84FA-4FAE022BBC73", EventID: 1);
    db.Doors.Insert(Id: 4, Code: "9DF7E964-1ECE-42E3-8211-1F2BF7054A0D", EventID: 2);
    db.Doors.Insert(Id: 5, Code: "9418123D-312A-4E8C-8807-59F0A63F43B9", EventID: 2);
} 
```

我试图找出我需要在 Simple.Data 中使用的语法来获得类似于此 T-SQL 的内容：

```
SELECT d.Code FROM Doors AS d INNER JOIN Events AS e ON d.EventID = e.Id WHERE e.Code = @EventCode 
```

当我传入“CodeMash2013”​​事件代码时，最终结果应该只有 EventId 1 的三个 Door 行。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T15:26:04.550

首先，一般的一点：因为你已经有了针对连接事件表的标准，所以 LEFT OUTER 是多余的；仅返回具有匹配事件代码的行，这意味着仅从门连接到事件成功的那些行。

如果您在数据库中设置了参照完整性，并且具有从 Doors 到 Events 的外键关系，那么 Simple.Data 可以自动处理连接。考虑到这一点，此代码将适用于 InMemoryAdapter 和 SQL Server：

```
List<dynamic> actual = db.Doors.FindAll(db.Doors.Events.Code == "CodeMash2013")
               .Select(db.Doors.Id, db.Events.Name)
               .ToList();

Assert.AreEqual(3, actual.Count); 
```

如果您没有设置参照完整性，那么您应该设置，但如果由于某种原因无法设置，则以下内容将适用于 SQL Server，但会触发我刚刚修复但尚未修复的 InMemoryAdapter 中的错误尚未发布：

```
dynamic eventAlias;
List<dynamic> actual = db.Doors.All()
              .Join(db.Events, out eventAlias)
              .On(db.Doors.EventID == eventAlias.Id)
              .Select(db.Doors.Id, db.Events.Name)
              .Where(eventAlias.Code == eventCode)
              .ToList();

Assert.AreEqual(3, actual.Count); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T22:29:45.840

更新：此答案适用于使用 Simple.Data SQL Server Provider，而不是 InMemoryAdapter

您可能会为此使用以下内容：

```
db.Doors.All()
  .Select(
    db.Doors.Code)
  .LeftJoin(db.Events).On(db.Doors.EventID == db.Events.Id)
  .Where(db.Events.Code == eventCode); 
```

您可能需要根据您的提供者在使用 LeftJoin 和 OuterJoin 之间进行试验。例如，如果您使用 ADO 提供程序，这两个函数都生成 LEFT JOIN 语句，因为 LEFT JOIN 和 LEFT OUTER JOIN 在 t-sql 中是同义词。

如果出于某种原因需要使用别名，则语法略有不同。

```
dynamic EventAlias;
db.Doors.All()
  .LeftJoin(db.Events.As"e", out EventAlias).On(db.Doors.EventID == db.EventAlias.Id)
  .Select(
    db.Doors.Code)
  .Where(db.EventAlias.Code == eventCode); 
```

没有理由为什么 where 子句必须包含主键表中的字段。您可以[在 Simple.Data 文档站点上](http://simplefx.org/simpledata/docs/pages/Retrieve/LazyLoadingJoins.htm)找到更多连接示例。到达那里时单击显式连接。

# javascript - 模拟 Javascript 'alert' 阻塞性质

> ID：13635297
> 
> 赞同：19
> 
> 时间：2012-11-29T21:44:03.273
> 
> 标签：javascript, alert

是否可以创建一个自定义模式消息，在用户输入之前“阻止”脚本的执行？

例如，如果不使用本机窗口警报/提示功能，如何实现这一点？

```
setInterval(function(){ 
     alert('Click OK to Continue');  // timing stops until user hits ok
},4000); 
```

我知道您可以让您的自定义对话框在用户输入时调用回调函数，但我有兴趣能够强制执行这种阻塞行为

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T22:02:55.847

> 是否可以创建一个自定义模式消息，在用户输入之前“阻止”脚本的执行？

不。没有办法像原生弹出窗口那样有效地阻止执行或用户交互（因为使用自定义弹出窗口，用户在技术上总是能够使用开发人员工具摆脱它）。

但是，正如 pst 在对该问题的评论中所说，异步灯箱并不繁琐，并且在阻止用户交互方面*几乎*与弹出窗口一样有效，因此我建议找到一个提供您喜欢的灯箱并与之一起运行的库。

> 例如，如果不使用本机窗口警报/提示功能，如何实现这一点？

*即使使用*本机窗口警报/提示功能，您也无法使用该代码执行您所说的操作（请参阅[此小提琴](http://jsfiddle.net/MixolydianV/bstxt/)- 在关闭弹出窗口之前等待 4 秒）。您需要以下内容：

```
function timeoutFunction() {
    alert('Click OK to Continue');  // timing ACTUALLY stops until user hits ok
    setTimeout(timeoutFunction, 4000);
}
setTimeout(timeoutFunction,4000); 
```

如果没有原生弹出窗口，这是您无法实现的（准确地说 - 参见上面的灯箱）。

甚至`while(true)`循环通常不会像弹出窗口那样阻塞 - Firefox 至少有一个“停止脚本”消息，在它运行时间过长后会弹出，我相当确定其他主要浏览器也会这样做。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T21:47:09.253

不，你不能（至少不能在浏览器中）。Javascript API 大多是异步的。`alert`/`prompt`是例外。但是，使用异步提示和回调并不难。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-08-13T20:58:41.020

有点旧，但如果它有帮助，我已经找到了我的解决方案：

`var answer = confirm("are you sure?"); if(!answer)return;`

# objective-c - UINavigationBar 在 4" 或 3.5" 上的位置不正确

> ID：13635299
> 
> 赞同：0
> 
> 时间：2012-11-29T21:44:17.250
> 
> 标签：objective-c, ios, xcode, ios6, iphone-5

我很难让我的应用程序在新 iPhone 5 的屏幕上工作。我可以为 3.5" 屏幕设置所有布局，但是当我将其更改为 4" 时，一切都会移动，然后它会影响 3.5"。但我最大的问题是我的导航栏每次都会移动到屏幕底部我改变尺寸。

尽管我不想使用 AutoLayout，但我正在使用 AutoLayout，因此我可以允许 iOS5 用户使用我的应用程序。

这就是我的意思：![UINavigationBar 移到底部](../Images/d541b04f2d15408c8170ec48d0671596.png)

导航栏约束是：

*   **顶部、右侧和左侧：** Superview。
*   **底部：**它下方的 UIImageView 的顶部。

# iphone - 移动文档文件夹的路径？

> ID：13635301
> 
> 赞同：0
> 
> 时间：2012-11-29T21:44:36.113
> 
> 标签：iphone, objective-c, ios, core-data, icloud

要访问我的应用程序文档文件夹，我使用以下代码：

```
[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject]; 
```

我想访问这个文件夹，但是：

```
~/Library/Mobile Documents 
```

我怎样才能轻松地将其作为路径值访问？我可以用类似的方式做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:34:31.177

移动文档是 iCloud 文档。因此，您想将文档存储在 iCloud 中。

在 OS X 上，它们肯定在 ~/Library/Mobile Documents（10.7 和 10.8）中，但在 iOS 上，您不应该查看。

```
 "All documents of an application are stored either in the local sandbox or in an iCloud container directory."...

  "A user should not be able to select individual documents for storage in iCloud. " 
```

[http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/DocumentBasedAppPGiOS/ManageDocumentLifeCycle/ManageDocumentLifeCycle.html](http://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/DocumentBasedAppPGiOS/ManageDocumentLifeCycle/ManageDocumentLifeCycle.html)

因此，如果您的用户选择 iCloud，那么您应该使用 iCloud。

iCloud 文档模型会持续多久，谁都猜不透，但这就是它今天的工作方式。整个事情似乎是糟糕的 UI 设计的杰作，正如对您问题的直接回答所示：

```
 -(NSURL*)ubiquitousContainerURL {

     return [[NSFileManager defaultManager] URLForUbiquityContainerIdentifier:nil];

 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:22:11.257

使用常量访问系统提供的目录的好处是，如果 Apple 决定更改结构，您的应用程序仍然可以工作。硬编码之类的东西`~/Library/Mobile Documents`很脆弱。

`NSSearchPathForDirectoriesInDomain`但是，您可以使用与`NSLibraryDirectory`常量相同的方式访问 Library 目录。然后，您应该只附加`Mobile Documents`目录路径。

```
// Set the NO to YES to get the full path, not the ~ version.
NSString *path = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, NO) lastObject]; 
path = [path stringByAppendingPathComponent:@"Mobile Documents"]; 
```

查看[http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSSearchPathDirectory](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSSearchPathDirectory)中的常量值，它似乎目录没有特定的常量`Mobile Documents`，因此硬编码方法可能是您唯一的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-08T13:38:55.287

在我最近的 macOS 应用程序中，我有同样的需求：如何访问 iCloud 目录的根文件夹。

**重要的！** 这是为非沙盒版本编写的，因为该应用程序仅适用于我自己。如果您计划在 Mac App Store 上发布应用程序，请不要关闭沙盒版本。

1.  我在应用程序的权利文件中关闭了沙盒。
2.  此代码将访问您的 iCloud 根文件夹：

    ```
    let pathToiCloudFolder = NSString(string: "com~apple~CloudDocs").expandingTildeInPath

    let backUpFolderUrl = FileManager.default.urls(for: .libraryDirectory, in:.userDomainMask).first!
    let backupUrl = backUpFolderUrl.appendingPathComponent("Mobile Documents/" + pathToiCloudFolder)

    print("Backup Folder:", backupUrl) 
    ```

# jquery - 两次调用相同的 jQuery UI 滑块是否每次都会创建不同的滑块对象？

> ID：13635303
> 
> 赞同：0
> 
> 时间：2012-11-29T21:44:44.923
> 
> 标签：jquery, jquery-ui

我想知道是否两次（或多次）调用同一个滑块对象会创建两个不同的对象？在调用另一个之前，我需要先销毁原件吗？如何使用 Firebug/Chrome 控制台检查是否存在两个滑块对象？

html:

```
<div id='test-slider'></div> 
```

javascript:

```
$('#test-slider').slider({
  value: test_value,
  min: 0,
  max: 10,
  step: 1
});

$('#test-slider').slider({
  value: test_value_2,
  min: 0,
  max: 100,
  step: 10
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:30:14.157

不，它将第一个滑块对象设置为您第二次调用它时使用的值。

# java - java在超时值后杀死一个线程

> ID：13635306
> 
> 赞同：1
> 
> 时间：2012-11-29T21:45:01.487
> 
> 标签：java

我在 java 中有一个要求，我希望线程在特定时间段后死亡并杀死自己，比如在它开始处理 1 分钟后。java是否为此提供了一种方法？

这里要添加的一件事是我正在使用 ThreadPoolExecutor 并将 RUNnable 对象提交给 ThreadPoolExecutor 以在队列中执行。这是我们框架的一部分，我无法删除 ThreadPoolExecutor。鉴于此，我该如何使用 ExecutorService？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:46:56.657

这是同样的[问题](https://stackoverflow.com/questions/2733356/killing-thread-after-some-specified-time-limit-in-java)。请使用`ExecutorService`执行`Runnable`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T21:55:53.117

您不能只是“杀死线程”，因为线程可以持有锁或其他资源（如文件）。而是将`stop`方法添加到`Runnable`您在线程中执行，这将设置内部标志并`run`定期在方法中检查它。像这样：

```
class StopByPollingThread implements Runnable {
    private volatile boolean stopRequested;
    private volatile Thread thisThread;

    synchronized void start() {
        thisThread = new Thread(this);
        thisThread.start();
    }

    @Override
    public void run() {
        while (!stopRequested) {
            // do some stuff here
            // if stuff can block interruptibly (like calling Object.wait())
            // you'll need interrupt thread in stop() method as well
            // if stuff can block uninterruptibly (like reading from socket)
            // you'll need to close underlying socket to awake thread
            try {
                wait(1000L);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    synchronized void requestStop() {
        stopRequested = true;
        if (thisThread != null)
            thisThread.interrupt();
    }
} 
```

此外，您可能想阅读Goetz 的*Java concurrency in practice*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T21:47:03.147

使用`ExecutorService`with`Future.get`或`invoke*`style 方法，这应该会给你你想要的。但是，您始终可以简单地定期检查线程内是否已达到超时，以便线程可以正常退出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T21:47:07.960

您可以中断线程，但根据您在工作线程中执行的操作，您需要手动检查 Thread.isInterrupted()。有关详细信息，请参阅[此](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#interrupt%28%29)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T21:48:45.333

您可以尝试 Thread.interrupt() 并在线程本身中使用 Thread.isInterrupted() 检查中断。或者，如果你的线程休眠了一段时间，那么就在 InterruptedException 上退出。这对你正在做的事情真的很重要。如果您正在等待 IO 任务，请尝试关闭流并在 Thread 中抛出 IOException 时退出。

# c# - 我的更新方法中的 OleDbException

> ID：13635310
> 
> 赞同：-5
> 
> 时间：2012-11-29T21:45:25.203
> 
> 标签：c#, oledb

为什么我有这个错误？错误消息是：INSERT INTO 语句中的语法错误。

我想在我的数据库中添加一条记录，但它不起作用。问题出在哪里？

代码是：

```
using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        OleDbDataAdapter DbDataAdabter = new OleDbDataAdapter();
        DbDataAdabter.SelectCommand = new OleDbCommand("SELECT * FROM [Phone-Book]", connection);

        OleDbCommandBuilder cb = new OleDbCommandBuilder(DbDataAdabter);
        connection.Open();
        DataRow dataRow = myDataset.Tables["salam"].NewRow();

        dataRow[1] = textBox2.Text;
        dataRow[2] = textBox3.Text;
        dataRow[3] = textBox4.Text;
        dataRow[4] = textBox5.Text;

        dataRow.EndEdit();
        myDataset.Tables["salam"].Rows.Add(dataRow);

        DbDataAdabter.Update(myDataset , "salam");

        connection.Close();
        connection.Dispose();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:56:25.510

考虑到信息和结果查询中固有的元数据，错误在于 Update() 方法生成的代码。如果您将异常的 SqlString 属性提供给我们会有所帮助，这样我们就可以看到发送到 Sql Server 的内容。

我会告诉你，你的代码首先跳出来的问题是使用`Select *`. 几乎所有使用`*`不是`Count(*)`a 的查询都不是您应该在生产代码中使用的查询；它们用于从 Management Studio 执行的一次性查询，但不适用于程序或其他查询使用的查询。

在这种情况下，`SELECT *`您无法控制查询产生的列数；如果有人稍后加入并添加一列，您的应用程序突然开始表现不佳，因为您只需要 3 列，而不是 4 列。在从代码执行的任何 SELECT 语句上使用属性列表。

# meteor - 在 Meteor 中，如何从非 Mongo 集合中删除项目？

> ID：13635312
> 
> 赞同：1
> 
> 时间：2012-11-29T21:45:36.467
> 
> 标签：meteor

在 Meteor 中，我从非 Mongo 源（特别是 IMAP）发布了一个集合。

```
Meteor.publish("search_results", function(user, password, str) {
  var self = this;
  res_msg = [];

  Imap.connect({...  });

  Imap.search(str, resultcb);
  for (var i = 0; i < res_msg.length; i++) {
    self.set("s_results", Meteor.uuid(), {uid: res_msg[i].uid, date: res_msg[i].date,  headers:res_msg[i].headers});
  }

  self.flush();
  self.complete();
  self.flush();
  console.log("total messages : ", res_msg.length);
}); 
```

这工作正常。然而，在第二次通过时，新项目被附加到集合中。似乎没有办法从非 Mongo 集合中删除记录。

从文档看来，如果我使用 this.unset，它将更改属性，而不是删除记录。

我不能在客户端或服务器端使用 collection.remove({}) 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:32:01.763

我找到了一种非常丑陋的方法来做到这一点，所以我把这个问题留了下来，希望有更好的选择。

基本上，如果您取消设置所有属性，文档就会消失。问题是如何在发布方法中迭代集合以查找所有文档，以便可以取消设置属性。创建集合似乎不起作用，更不用说 .find();

我将 ID 列表存储在一个单独的数组中。丑陋，我知道。我希望你能做得更好。

```
for (i = 0; i < uuids.length; i++) {
  self.unset("s_results", uuids[i], {});
}
uuids = [];
Imap.search(str, resultcb);
for (var i = 0; i < res_msg.length; i++) {
  var u = Meteor.uuid();
  self.set("s_results", u, {uid: res_msg[i].uid, date: res_msg[i].date, headers:res_msg[i].headers});
  uuids.push(u);
} 
```

# windows-phone-7 - 不在情节提要中播放动画（使用 ObjectAnimationUsingKeyFrames）

> ID：13635314
> 
> 赞同：0
> 
> 时间：2012-11-29T21:45:44.713
> 
> 标签：windows-phone-7, animation

我无法播放动画故事板。仅显示最后一张图片动画。有什么问题？

我的代码创建动画：

```
public static class AnimationHelper
    {
        private const string PathImageAnimation = "/LeSommet.ZooSnap.UI.WindowsPhone;component/Resources/Images/Animation/ButtonState{0}.png";

        public static void StartAnimation(UIElement target)
        {
            Storyboard storyboard = new Storyboard();

            ObjectAnimationUsingKeyFrames objectAnimation = new ObjectAnimationUsingKeyFrames();
            objectAnimation.AutoReverse = false;
            objectAnimation.SpeedRatio = 2;
            Storyboard.SetTargetProperty(objectAnimation, new PropertyPath("Source"));
            Storyboard.SetTarget(objectAnimation, target);

            for (int i = 1; i <= 4; i++)
            {
                DiscreteObjectKeyFrame discreteObject = new DiscreteObjectKeyFrame()
                {
                    KeyTime = TimeSpan.FromMilliseconds(1000),
                    Value = new BitmapImage(new Uri(string.Format(PathImageAnimation, i), UriKind.Relative))
                };
                objectAnimation.KeyFrames.Add(discreteObject);
            }
            storyboard.Children.Add(objectAnimation);

            storyboard.Begin();
        }
    } 
```

我的代码图像 xaml：

```
<Image Source="/LeSommet.ZooSnap.UI.WindowsPhone;component/Resources/Images/Animation/ButtonState5.png"                            
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Width="110" Height="110" Stretch="Fill"
                           x:Name="imageSquareAnimation"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T08:08:57.827

你所有的关键帧都在同一时间吗？

```
 KeyTime = TimeSpan.FromMilliseconds(1000), 
```

你可以试试：

```
 KeyTime = TimeSpan.FromMilliseconds(1000 * i), 
```

尝试学习如何使用 Blend - 它有一个出色的编辑器来帮助您创建动画。

# c# - 从 twitter 获取用户流

> ID：13635317
> 
> 赞同：0
> 
> 时间：2012-11-29T21:46:00.173
> 
> 标签：c#

一个月前在 c# Windows 窗体应用程序中构建了一个 twitter 工具。我可以发送推文并查看家庭时间线、朋友时间线和提及时间线。我使用 twitterizer dll 和 OAuthTokens 方法，但是有刷新限制，而且速度很慢。

现在我想启动一个流式 Twitter 应用程序，但我找不到合适的示例或文档。我开始了，但我没有找到可以启动流的函数，但它在字符串或文本框中。我的问题是如何从主时间线获取流。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using Twitterizer;
using Twitterizer.Streaming;

namespace Twww
{
    public partial class Form1 : Form
    {
        public OAuthTokens tokens = new OAuthTokens();
        private string userAgent = null;

        public Form1()
        {
            InitializeComponent();
            /* input tokens removed in example code */

            tokens.AccessToken = accessToken;

            tokens.AccessTokenSecret = accesssecret;

            tokens.ConsumerKey = consumerKey;

            tokens.ConsumerSecret = consumerSecret;
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Twitterizer.Streaming.UserStreamOptions options = new UserStreamOptions();
            OAuthTokens token = new Twitterizer.OAuthTokens ();
            TwitterStream stream = new TwitterStream(token, userAgent, options);
        }
    }
} 
```

我试图让它适用于用户流，但我得到 401 或 403 错误，谁说我没有权利

```
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Threading.Tasks;
using Twitterizer;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            OAuthTokens tokens = new OAuthTokens();
            string consumerKey = "XX";
            string consumerSecret = "XX";
            string accessToken = "XX";
            string accesssecret = "XX";

            tokens.AccessToken = accessToken;
            tokens.AccessTokenSecret = accesssecret;
            tokens.ConsumerKey = consumerKey;
            tokens.ConsumerSecret = consumerSecret;

            string url = "https://userstream.twitter.com/1.1/user.json?with=followings&replies=all";
            WebClient wc = new WebClient();
            wc.Credentials = new NetworkCredential("XX", "XX");
            StreamReader reader = new StreamReader(wc.OpenRead(url));

            string line;
            while ((line = reader.ReadLine()) != null)
            {
                dynamic json = JsonConvert.DeserializeObject(line);
                if (json.text != null)
                {
                    Console.WriteLine(json.text);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:48:33.257

检查一下，您在 twitterizer 中有一个精心设计的 TwitterStream 指南：

[http://thewayofcode.wordpress.com/tag/json/](http://thewayofcode.wordpress.com/tag/json/)

# android - 如何在 Android 数字键盘中允许特定字符？

> ID：13635319
> 
> 赞同：1
> 
> 时间：2012-11-29T21:46:05.027
> 
> 标签：android, keyboard, android-edittext

我正在开发一个科学应用程序，并且我有一个 EditText，我必须在其中输入一个输入数值，所以 inputType 是“number|numberSigned|numberDecimal”，但问题是当我想输入一个科学记数法数字时，例如“45.6 E05”，由于 EditText 的 InputType，我无法输入“E”字符。

如何在 EditText 聚焦时允许“E”字符并且只显示数字键盘？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:16:37.857

没有办法显示带有额外字母的数字键盘，`E`解决此问题的两种方法是制作一个输入编辑文本的按钮`E`或使用如下`android:digits`属性：

```
android:digits="1234567890E." 
```

括号中的所有字符都是您希望用户能够输入的字符

要使用按钮进行操作，`onClickListener`您只需在其中输入以下代码

```
edittext.setText(edittext.getText().toString() + "E" 
```

另一方面，如果你想在光标位置插入字符，那么你应该试试这个（取自[这里](https://stackoverflow.com/questions/7661104/insert-character-between-the-cursor-position-in-edit-text)）

```
int start =edittext.getSelectionStart();
String s = "E";
edittext.getText().insert(start, s); 
```

# python - 自定义 Django 模型字段中的“对象没有属性”

> ID：13635320
> 
> 赞同：2
> 
> 时间：2012-11-29T21:46:19.677
> 
> 标签：python, django, model, field, rfc5545

我正在尝试创建一个 Django 模型字段，该字段表示 HTML 中包含天、小时、分钟和秒文本输入字段的持续时间，并使用 ical 格式（RFC5545）将持续时间存储在数据库中。

（这与我关于[如何在 Django 中创建 ical 持续时间字段的问题有关？](https://stackoverflow.com/questions/13597063/how-to-create-an-ical-duration-field-in-django)）

这是我的方法：

感谢 bakkal 和 Pol。下面是我想出的。

```
from django.db import models
from icalendar.prop import vDuration
from django.forms.widgets import MultiWidget
from django.forms import TextInput, IntegerField
from django.forms.util import flatatt
from django.forms.fields import MultiValueField
from django.utils.encoding import force_unicode
from django.utils.safestring import mark_safe
from django.utils.text import capfirst
from django.utils.translation import ugettext_lazy as _
from django.core import validators
from datetime import timedelta

def is_int(s):
    try: 
        int(s)
        return True
    except ValueError:
        return False

class Widget_LabelInputField(TextInput):
    """
    Input widget with label
    """
    input_type="numbers"
    def __init__(self, labelCaption, attrs=None):
        self.labelCaption = labelCaption
    super(Widget_LabelInputField, self).__init__(attrs)

    def _format_value(self, value):
        if is_int(value):
            return value
        return '0'

    def render(self, name, value, attrs=None):
        if value is None:
            value = '0'
        final_attrs = self.build_attrs(attrs, type=self.input_type, name=name)
        if value != '':
            # Only add the 'value' attribute if a value is non-empty.
            final_attrs['value'] = force_unicode(self._format_value(value))
        if (self.labelCaption):
        typeString = self.labelCaption + ': '
        else:
            typeString = ''           
        return mark_safe(u'' + typeString + '<input%s style=\'width: 30px; margin-right: 20px\'/>' % flatatt(final_attrs))

class Widget_DurationField(MultiWidget):
    """
    A Widget that splits duration input into two <input type="text"> boxes.
    """

    def __init__(self, attrs=None):
        widgets = (Widget_LabelInputField(labelCaption='days', attrs=attrs),
                   Widget_LabelInputField(labelCaption='hours', attrs=attrs),
                   Widget_LabelInputField(labelCaption='minutes', attrs=attrs),
                   Widget_LabelInputField(labelCaption='seconds', attrs=attrs)
                   )
        super(Widget_DurationField, self).__init__(widgets, attrs)

    def decompress(self, value):
        if value:
            duration = vDuration.from_ical(value)
            return [str(duration.days), str(duration.seconds // 3600), str(duration.seconds % 3600 // 60), str(duration.seconds % 60)]
        return [None, None, None, None]

class Forms_DurationField(MultiValueField):
    widget = Widget_DurationField
    default_error_messages = {
        'invalid_day': _(u'Enter a valid day.'),
        'invalid_hour': _(u'Enter a valid hour.'),
        'invalid_minute': _(u'Enter a valid minute.'),
        'invalid_second': _(u'Enter a valid second.')
    }

    def __init__(self, *args, **kwargs):
        errors = self.default_error_messages.copy()
        if 'error_messages' in kwargs:
            errors.update(kwargs['error_messages'])
        fields = (
            IntegerField(min_value=-9999, max_value=9999,
                      error_messages={'invalid': errors['invalid_day']},),
            IntegerField(min_value=-9999, max_value=9999,
                      error_messages={'invalid': errors['invalid_hour']},),
            IntegerField(min_value=-9999, max_value=9999,
                      error_messages={'invalid': errors['invalid_minute']},),
            IntegerField(min_value=-9999, max_value=9999,
                      error_messages={'invalid': errors['invalid_second']},),
        )
        super(Forms_DurationField, self).__init__(fields, *args, **kwargs)

    def compress(self, data_list):
        if data_list:
            if data_list[0] in validators.EMPTY_VALUES:
                raise ValidationError(self.error_messages['invalid_day'])
            if data_list[1] in validators.EMPTY_VALUES:
                raise ValidationError(self.error_messages['invalid_hour'])
            if data_list[2] in validators.EMPTY_VALUES:
                raise ValidationError(self.error_messages['invalid_minute'])
            if data_list[3] in validators.EMPTY_VALUES:
                raise ValidationError(self.error_messages['invalid_second'])

            return vDuration(timedelta(days=data_list[0],hours=data_list[1],minutes=data_list[2],seconds=data_list[3]))
        return None

class Model_DurationField(models.Field):
    description = "Duration"

    def __init__(self, *args, **kwargs):
        super(Model_DurationField, self).__init__(*args, **kwargs)

    def db_type(self, connection):
        return 'varchar(255)'

    def get_internal_type(self):
        return "Model_DurationField"

    def to_python(self, value):
        if isinstance(value, vDuration) or value is None:
            return value

        return vDuration.from_ical(value) 

    def get_prep_value(self, value):
        return value.to_ical() 

    def formfield(self, **kwargs):
        defaults = {
            'form_class': Forms_DurationField,
            'required': not self.blank,
            'label': capfirst(self.verbose_name),
            'help_text': self.help_text}
        defaults.update(kwargs)
        return super(Model_DurationField, self).formfield(**defaults) 
```

它适用于以下模型：

```
class TestModel(models.Model):
    ID = models.CharField(max_length=255)
    start = models.DateTimeField(null=True)
    #duration = models.CharField(max_length=255,null=True) commented out
    otherDuration = duration.Model_DurationField(null=True) 
```

但不是在这个：

```
class TestModel(models.Model):
    ID = models.CharField(max_length=255)
    start = models.DateTimeField(null=True)
    duration = models.CharField(max_length=255,null=True)  # not commented out
    otherDuration = duration.Model_DurationField(null=True) 
```

我收到以下错误：

```
File "/somepath/models.py", line 5, in TestModel
    otherDuration = duration.Model_DurationField(null=True)
AttributeError: 'CharField' object has no attribute 'Model_DurationField' 
```

这让我感到困惑......似乎python认为我的字段是前一个字段的属性，但前提是它是一个CharField。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:56:02.247

我犯傻了。问题是我将定义模型的文件命名为duration.py，因此与“duration”字段存在命名冲突。我重命名了文件，它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:50:58.710

`./manage syncdb`换模型后你跑了吗？

如果您决定更改模型，它不会更新当前数据库。唯一的方法是重置它然后运行syncdb。

如果您使用的是 SQLite - 只需删除 db 文件，运行 syncdb，它将使用您更新的模型生成一个数据库。请注意，它将删除所有现有记录！

# ios - UITableViewCell 当单元格变得可见时重新添加自定义内容

> ID：13635321
> 
> 赞同：0
> 
> 时间：2012-11-29T21:46:22.147
> 
> 标签：ios, uitableview

我在我的 中添加了一个自定义按钮`cell.contentView`，我注意到每次将单元格从屏幕的可见部分滚动并重新打开时，按钮都会重新添加 - 它的半透明部分变得越来越坚固。处理它的正确方法是什么，以便在滚动 tableView 时它不会在顶部堆叠更多对象？请注意，每个单元格的自定义内容都不同，因此我无法将其放入`if (cell == nil) {...}`块中。

我的代码是：

```
UISegmentedControl *btn = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:btn_title]];
// set various other properties of btn
...
[cell.contentView addSubview:btn]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:55:10.917

每次单元格出列时，您必须在添加新子视图之前删除旧子视图，否则您将获得堆叠效果。您可以在以下两个位置之一执行此操作：

a) 在中，在通话后和添加新视图之前`tableView:cellForRowAtIndexPath:`删除旧视图。`dequeueReusableCellWithIdentifier:`

b) 如果您使用 的子类`UITableViewCell`，则可以覆盖`prepareForReuse`以删除不需要的视图。 `prepareForReuse`每次单元格出列以供重用时都会调用它，因此它是摆脱上次配置单元格时的旧视图的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:08:13.190

我将为您发布的代码发布示例修复。它可以扩展以处理更多视图。

步骤是：

1.  在您的 CustomCell 类中创建一个方法来处理整个设置（例如`setupWithItems:`：）
2.  一旦你有一个单元格`cellForRowAtIndexPath:`（在出队或创建它之后），你应该调用`setupWithItems:`单元格应该显示的新项目列表。
3.  在您的`setupWithItems:`实现中，请确保从其父视图中删除 UISegmentedControl。您可以轻松地做到这一点，因为分段控件存储为自定义单元格的属性。
4.  在您的`setupWithItems:`实现中，创建一个新的 UISegmentedControl 并将其添加到 CustomCell 的视图层次结构中。

示例代码：

```
-(UITableViewCell*)tableView:(UITableView*)tableView cellForRowAtIndexPath:(NSIndexPath*)indexPath
{
    CustomCell* cell = [tableView dequeueReusableCellWithIdentifier:kSomeIdentifier];

    if (!cell)
    {
        // Create a new cell
    }

    NSArray* currentCellItems = [self cellItemsForRow:indexPath.row];

    [cell setupWithItems:currentCellItems];

    return cell;
} 
```

在您的 CustomCell 子类中：

```
- (void)setupWithItems:(NSArray*)items
{
    if (self.segmentedControl)
    {
        [self.segmentedControl removeFromSuperView];
        self.segmentedControl = nil;
    }

    // More setup...

    UISegmentedControl *btn = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:btn_title]];
    // set various other properties of btn

    [cell.contentView addSubview:btn];
} 
```

# javascript - Javascript随机数不显示结果

> ID：13635322
> 
> 赞同：0
> 
> 时间：2012-11-29T21:46:23.233
> 
> 标签：javascript, html, random

我有一个旨在生成随机数的网页，然后当数字 = 5 时，它会显示一条获胜消息..如果不显示失败消息，但它没有显示任何警报..我错过了什么吗？

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">

function WinLose()
{
var x=document.getElementById("demo");
x=x.innerHTML=Math.floor((Math.random()*5)+1);
return x;
if (x=4)
{
    alert("winner!");
}
else
{
    alert("loser");
}
}
</script>

</head>
<body>

<p id="demo">Click the button to display a random number between 1 and5.</p>

<button onclick="WinLose()">Try it</button>

</body>
</html> 
```

编辑：设法让这个位工作，所以现在它根据其数量显示赢或松，但有谁知道我如何交换 if 语句中的警报以显示 DIV 部分。我包含了一个 jQuery 文件，因此它可以接受隐藏/显示效果......我尝试过的任何东西都不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:47:35.020

`return x`为 x 生成随机值后，您就拥有了。这意味着该行之后没有javascript代码将在该函数中运行。

此外，您的 if 语句需要使用 '==' 进行比较，而不是使用分配的 '='。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T21:53:59.167

是的，这可能很艰难。主要问题再次必须不是`return x`“==”。所以这

```
if (x=4) 
```

真的应该说：

```
if (x==4) 
```

您之前所说的是您将 x 分配为 4，因此这根本没有任何意义，并且把一切都搞砸了。

希望这对你有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T21:58:24.190

你的代码：

```
x=x.innerHTML=Math.floor((Math.random()*5)+1); 
```

`x``x.innerHTML`正在接收`x.innerHTML = random number`。

正确方法：（去掉“x=”）

```
x.innerHTML = Math.floor((Math.random()*5)+1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T22:42:30.330

这是一个将警报外部化的简化版本（我假设您以后不打算使用它们）

```
function WinLose(){
  var x=Math.floor((Math.random()*5)+1);
  document.getElementById("demo").innerHTML=x;
  return (x==5) ? "Winner!" : "Loser";
}

alert(WinLose()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T21:55:14.067

您需要`return x`在生成随机值之后；你必须添加`x == 4`

```
function WinLose()
{
var x=document.getElementById("demo");
x=x.innerHTML=Math.floor((Math.random()*5)+1);
if (x==4) {
    alert("winner!");
} else {
    alert("loser");
}
    return x;
} 
```

[演示](http://jsfiddle.net/ENLLg/)

# css - 顶部定位：-px

> ID：13635324
> 
> 赞同：0
> 
> 时间：2012-11-29T21:46:26.243
> 
> 标签：css

我正在重叠一个 div（div2 over div1），`top: -50px;`用来将其向上推。现在这在下一个 div (div3) 之前留下了 50px 的位置。我怎样才能“清除”它并使 div (div3) 正好落在我定位 -50px 的 div (div2) 之下？

```
<div id="div1" style="width: 1000px; height: 90px; background: red;"></div>
<div id="div2" style="position: relative; top:-50px; width: 1000px; height: 90px; background: blue;"></div>
<!--50 wasted pixels here-->
<div id="div3" style="width: 1000px; background: green; height:90px;"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:49:49.953

添加`margin-top: -50px`到您的#div3：

```
<div id="div3" style="width: 1000px; background: green; height:90px; margin-top: -50px;"></div> 
```

小提琴：http: [//jsfiddle.net/N7z6e/](http://jsfiddle.net/N7z6e/)

# ruby-on-rails-3 - rails carrierwave 图像的可选 url 导致 rails 3 出现错误

> ID：13635327
> 
> 赞同：0
> 
> 时间：2012-11-29T21:46:39.417
> 
> 标签：ruby-on-rails-3, carrierwave

我正在尝试设置一个上传图片页面，用户可以在其中选择上传图片网址。我正在使用carrierwave 视图：

```
<%= form_for @rating, :html => {:multipart => true} do |f| %>

    <p>
      <%= f.file_field :pic_url %>
    </p>

    <p>
      <%= f.label :remote_pic_url_url, 'or image url' %>
      <br/>
      <%= f.text_field :remote_pic_url_url %>
    </p>

    <div class="actions">
      <%= f.submit 'Upload Picture', :class => 'btn btn-primary' %>
    </div> 
```

该模型：

```
class Rating < ActiveRecord::Base
  attr_accessible :pic_url, :remote_pic_url_url, :rating

  mount_uploader :pic_url , ImageUploader
end 
```

当我尝试仅输入图像 url 时，我收到一条错误消息： `Pic url You are not allowed to upload "" files, allowed types: jpg, jpeg, gif, png`

如何使该字段可选。我的印象`remote_{columnName}_url`是在carrierwave中添加额外的url字段的约定，这将为我解决这个问题..

控制器代码：

```
# POST /ratings
  # POST /ratings.json
  def create
    @rating = Rating.new(params[:rating])

    respond_to do |format|
      if @rating.save
        format.html { redirect_to @rating, :notice => 'Rating was successfully created.' }
        format.json { render :json => @rating, :status => :created, :location => @rating }
      else
        format.html { render :action => "new" }
        format.json { render :json => @rating.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T00:15:11.243

看到[这个线程](https://github.com/jnicklas/carrierwave/issues/354)。

您遇到的错误 ( `You are not allowed to upload "" files, allowed types: jpg, jpeg, gif, png`) 与您在以下情况下遇到的错误相同：

```
@rating.remote_pic_url_url = "http://www.google.com"
@rating.save 
```

这里的问题是 Carrierwave 打开 URL，然后使用 调用生成的文件`base_uri.path`，它返回`/`，因此出现错误。如果您输入的 URL 没有扩展名，那么这就是原因。

如果没有，那么我不确定为什么它不起作用。我在自己的项目中使用相同的方法（即设置`remote_{columnname}_url`然后保存记录）并且效果很好。虽然我通常不使用扩展白名单验证器，但我添加了一个并且（至少在控制台中）它与有效的 URL（即指向具有有效扩展名的图像的 URL）也可以正常工作。

您可以在控制台中尝试以下步骤，看看它是否正确保存？（在 JPG/GIF/PNG 文件中插入一些有效的 URL）：

```
@rating = Rating.new(remote_pic_url_url: 'http://...')
@rating.save 
```

# xamarin.android - 单人游戏；不能覆盖任何以 SpriteBatch 作为参数的方法

> ID：13635330
> 
> 赞同：1
> 
> 时间：2012-11-29T21:46:45.407
> 
> 标签：xamarin.android, xna-4.0, monogame

对monogame来说很新（确切地说是android的mono），但是通过一些youtube教程，这个过程相当轻松。我正在尝试覆盖一些函数（来自“XNA 库项目”dll），我可以很好地覆盖所有函数。但是，当我尝试覆盖作为参数传入 SpriteBatch 的任何内容时，出现以下错误：

> 错误 5 'Parkour.Screens.EditorScreen.Draw(Microsoft.Xna.Framework.Graphics.SpriteBatch)': 找不到合适的方法来覆盖 D:\Data\programming 等\comps\TIGsport\XNA\Parkour\Parkour\Parkour\ Screens\EditorScreen.cs 117 30 跑酷安卓

我绝对确定该方法存在，因为 XNA 项目运行良好。Draw 功能也会在 mono for android 项目中自动更正弹出。但奇怪的是，在我收到错误后，它似乎已经从自动更正中消失了。

这是包含要覆盖功能的整个类，这样你们就可以确定没有任何问题。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework.Graphics;

namespace SimpleTilebasedLibrary.Utils
{
    public class LoopContainer<T> where T : ILoopable
    {
        protected List<T> _items = new List<T>();
        private List<T> _addList = new List<T>();
        private List<T> _removeList = new List<T>();

        public List<T> items
        {
            get{return _items;}
        }

        public virtual void add(T item)
        {
            //if (_addList.Contains(item)) return;
            //_addList.Add(item);
            _items.Add(item);
        }

        public virtual void remove(T item)
        {
            if (_removeList.Contains(item)) return;
            _removeList.Add(item);
        }

        public T get(int index)
        {
            return _items[index];
        }

        public T get(string name)
        {
            foreach (T item in items)
            {
                if (item.getName() == name)
                {
                    return item;
                }
            }

            return default(T);
        }

        public virtual void Update()
        {
            items.AddRange(_addList);
            _addList.Clear();

            foreach (T item in items)
            {
                if (item.status == Status.DEAD)
                {
                    _removeList.Add(item);
                    //break; //root of all evil
                    continue;
                }

                item.Update();
            }

            //remove
            foreach (T i in _removeList)
            {
                items.Remove(i);
            }
            _removeList.Clear();

        }

        public virtual void postUpdate()
        {
            foreach (T item in items)
            {
                item.postUpdate();
            }
        }

        public virtual void Draw(SpriteBatch spritebatch)
        {
            foreach (T item in items)
            {
                item.Draw(spritebatch);
            }
        }
    }
} 
```

以及试图覆盖它的类

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using SimpleTilebasedLibrary;
using SimpleTilebasedLibrary.Entities;
using SimpleTilebasedLibrary.Tilesystem;
using SimpleTilebasedLibrary.Services;
using Microsoft.Xna.Framework.Input;
using SimpleTilebasedLibrary.Components;
using SimpleTilebasedLibrary.Utils;
using SimpleTilebasedLibrary.UI;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

namespace Parkour.Screens
{
    public class EditorScreen : GameScreen //need to couple gamescreens with inputcontexts?
    {
        public ParkourWorld world;
        int currentTile = 0;
        GameObject tile;

        Checkbox editorEnabled;
        Checkbox solidCB;
        Checkbox autotileCB;

        public EditorScreen(ParkourWorld world)
            : base("editorscreen")
        {
            this.world = world;
            tile = new GameObject("tileset", 16, 16); //never actually tested this, doesn't work!
            tile.GetC<GraphicsC>().setScale(2, 2);
            //add(tile); //something fucks up the coordinates when you add it...

            editorEnabled = new Checkbox(Color.White, 10);
            editorEnabled.GetC<TransformC>().Y = 10;
            editorEnabled.GetC<TransformC>().X = 100;

            solidCB = new Checkbox(Color.Red, 10);
            solidCB.GetC<TransformC>().Y = 10;//30;
            solidCB.GetC<TransformC>().X = 120;
            //add(solidCB);

            autotileCB = new Checkbox(Color.Blue, 10);
            autotileCB.GetC<TransformC>().Y = 10;//50;
            autotileCB.GetC<TransformC>().X = 140;
            //add(autotileCB);

            editorEnabled.value = false;
        }

        public override void Update()
        {
            base.Update();

            if (GameServices.get<InputManager>().hasScrolledDown() && currentTile > 0)
            {
                currentTile--;
            }

            if (GameServices.get<InputManager>().hasScrolledUp() && currentTile < tile.GetC<GraphicsC>().totalFrames - 1) 
            {
                currentTile++;
                Console.WriteLine(currentTile);
            }

            tile.GetC<GraphicsC>().gotoAndStop(currentTile);

            //

            if (Mouse.GetState().LeftButton == ButtonState.Pressed && editorEnabled.value)
            {
                GameCamera camera = GameServices.get<CameraManager>().getActiveCamera();

                int x = TileMath.PixelToTile((Mouse.GetState().X + (camera.GetC<CameraC>().leftX * camera.GetC<CameraC>().zoom)) / camera.GetC<CameraC>().zoom, world.tilegrid.tileWidth);
                int y = TileMath.PixelToTile((Mouse.GetState().Y + (camera.GetC<CameraC>().UpY * camera.GetC<CameraC>().zoom)) / camera.GetC<CameraC>().zoom, world.tilegrid.tileHeight);

                if (Keyboard.GetState().IsKeyDown(Keys.Z))
                {
                    world.tilegrid.setTile(x, y, 0, null);
                    //world.tilegrid.getTile(x, y, 0).id = 1;
                    //world.tilegrid.getTile(x, y, 0).solid = false;
                }
                else
                {
                    Tile t = world.tilegrid.setTile(x, y, 0, currentTile);
                    if (t != null) t.solid = solidCB.value;

                    if(autotileCB.value)world.tilegrid.AutoTile(t, 0, x, y, true);
                    //world.tilegrid.setTile(x, y, 0, null);
                }
            }

            // enable and disable cb's //
            if (GameServices.get<InputManager>().wasKeyPressed(Keys.LeftShift))
            {
                solidCB.value = !solidCB.value;
            }

            if (GameServices.get<InputManager>().wasKeyPressed(Keys.Q))
            {
                autotileCB.value = !autotileCB.value;
            }

            if (GameServices.get<InputManager>().wasKeyPressed(Keys.E))
            {
                editorEnabled.value = !editorEnabled.value;
            }

            solidCB.Update();
            autotileCB.Update();
        }

        public override void Draw(SpriteBatch spritebatch)
        {
            base.Draw(spritebatch);
            tile.Draw(spritebatch);
            editorEnabled.Draw(spritebatch);
            solidCB.Draw(spritebatch);
            autotileCB.Draw(spritebatch);

            CameraC camera = GameServices.get<CameraManager>().getActiveCameraC();

            int width = TileMath.PixelToTile(camera.viewrect.Left + camera.viewrect.Width + (world.tilegrid.tileWidth * 2), world.tilegrid.tileWidth);
            int height = TileMath.PixelToTile(camera.viewrect.Top + camera.viewrect.Height + (world.tilegrid.tileHeight * 2), world.tilegrid.tileHeight);

            if (editorEnabled.value)
            {
                spritebatch.End();
                spritebatch.Begin(SpriteSortMode.Deferred, null, SamplerState.PointClamp, null, null, null, GameServices.get<CameraManager>().getActiveCameraC().getTransformation());

                //getTile(width - 1, 0).GetComponent<GraphicsC>().sprite.gotoAndStop(4);

                Rectangle rect = new Rectangle();
                Color trans = new Color(255, 0, 0, 10);
                for (int x = TileMath.PixelToTile(camera.viewrect.Left, world.tilegrid.tileWidth); x < width; x++)
                {
                    for (int y = TileMath.PixelToTile(camera.viewrect.Top, world.tilegrid.tileHeight); y < height; y++)
                    {
                        if (world.tilegrid.getTile(x, y, 0) != null)
                        {
                            if (!world.tilegrid.getTile(x, y, 0).solid) continue;
                            rect.X = x * world.tilegrid.tileWidth;
                            rect.Y = y * world.tilegrid.tileHeight;
                            rect.Width = world.tilegrid.tileWidth;
                            rect.Height = world.tilegrid.tileHeight;
                            spritebatch.Draw(GameServices.get<AssetManager>().CreateColoredTexture(trans), rect, Color.White);
                        }
                    }
                }

                spritebatch.End();
                spritebatch.Begin();
            }
        }

    }

} 
```

里面有很多对你们没用的东西，但为了完整起见，我想把它包括在内。

我对另一个具有需要重写的 Draw(SpriteBatch) 函数的类有完全相同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T04:55:24.957

结果我传入了一个 MonoGame spritebatch，其中库需要一个 XNA spritebatch。我用 MonoGame 在一个单独的项目中重新编译了库，所有问题都得到了解决。

# asp.net-mvc - 将 C# 循环重构为 Knockout 映射插件

> ID：13635340
> 
> 赞同：1
> 
> 时间：2012-11-29T21:47:18.463
> 
> 标签：asp.net-mvc, knockout.js, knockout-mapping-plugin

服务器向客户端发送一个复杂对象的位置，目标是从 C# 的*“foreach”*转换到 KnockoutJS 的*“data-bind="foreach:”，*请考虑使用各种信息填充购物车的这段代码：

```
@{
    foreach (var item in GetItems(Model))
    {
    <dt>
        <input type="radio" id='mode_@(item.ID)' name="mode" value="@item.ID" />
        @item.Label - $@item.PriceToAdd
    </dt>
    <dd>
        @Html.Raw(item.Explanation) </dd>
        }
    }
} 
```

是否应该在渲染视图之前调整服务器的代码以展平对象，或者 KnockoutJS 是否可以处理展开它？如果服务器发送 JSON 会更容易吗？

**跟进：** 很明显，问题归结为映射插件，mfanto 的第一个答案让我成功了：

```
self.items = ko.mapping.fromJS(@Html.Raw(JsonConvert.SerializeObject(Model.Items))); 
```

firebug 向我显示以下输出：

```
self.items = ko.mapping.fromJS([{"ID":60},{"ID":62},{"ID":63},{"ID":64},{"ID":9}]); 
```

~~也许映射器失败是因为我的一个项目（id = 9）与其他项目具有不同的元素。~~

可能我需要研究映射器的一种更先进的用法？

格式化输出比较 JsonConvert 与 JavaScriptSerializer 返回的值

```
...
self.itemsJSON = ko.mapping.fromJS(@Html.Raw(JsonConvert.SerializeObject(Model.Items)));
self.items = @Html.Raw(new JavaScriptSerializer().Serialize(Model.Items)); 
```

当上面的代码渲染到 Firebug 中的断点时：

```
self.itemsJSON = ko.mapping.fromJS([{"ID":60},{"ID":62},{"ID":63},{"ID":64},{"ID":9}]);
self.items = [  //line breaks inserted for clarity
{"Explanation":"Item1's text.","Label":"Item1's Label","MsgConfirm":null,"PriceToAdd":1255,"TaxExempt":false,"PercentToAdd":0,"SortOrder":1,"ID":60},
{"Explanation":"Item2's text.","Label":"Item2's Label","MsgConfirm":null,"PriceToAdd":1255,"TaxExempt":false,"PercentToAdd":0,"SortOrder":2,"ID":62},
{"Explanation":"Item3's text.","Label":"Item3's Label","MsgConfirm":null,"PriceToAdd":295,"TaxExempt":false,"PercentToAdd":0,"SortOrder":3,"ID":63},
{"Explanation":"Item4's text.","Label":"Item4's Label","MsgConfirm":null,"PriceToAdd":395,"TaxExempt":false,"PercentToAdd":0,"SortOrder":4,"ID":64},
{"Explanation":null,"Label":"[foo]","MsgConfirm":null,"PriceToAdd":150,"TaxExempt":false,"PercentToAdd":0,"SortOrder":99,"ID":9}
]; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:54:38.170

在使用 Knockout 之前，您不需要展平对象。[ko.mapping 插件](http://knockoutjs.com/documentation/plugins-mapping.html)将创建具有可观察属性的视图模型，并且可以处理复杂的嵌套对象。

要将其与 ASP.NET MVC 模型一起使用，请使用 @Html.Raw() 和 Json 序列化程序（在本例中为[Json.NET](http://james.newtonking.com/pages/json-net.aspx)：

```
function AppViewModel() {
    var self = this;
    self.items = ko.mapping.fromJS(@Html.Raw(JsonConvert.SerializeObject(Model.Items)));
}

ko.applyBindings(new AppViewModel()); 
```

从那里，您可以使用 foreach：

```
<table>
    <tbody data-bind="foreach: items">
        <tr>
            <td data-bind="text: PriceToAdd()"></td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T23:31:44.437

你可以选择任何一种方式。使用 Razor 在服务器上渲染它，或者在客户端使用淘汰赛渲染它......更基本的问题是你想在哪里渲染它。这里没有正确或错误的答案。

如果您选择淘汰赛，您需要处理的不仅仅是让服务器可能使您的模型变平。Knockout 将需要 ajax 请求来读取然后保存您的数据，这是两种解决方案根本不同的地方

如果您正在考虑将敲除简单地用作客户端模板引擎，那么像[jsrender](https://github.com/BorisMoore/jsrender)这样的东西可能是一个更好的解决方案。

# javascript - HTML 中的相对路径适用于 CSS，不适用于 Javascript

> ID：13635342
> 
> 赞同：2
> 
> 时间：2012-11-29T21:47:23.643
> 
> 标签：javascript, html, iis

在我们的 IIS 服务器上，样式表的相对路径可以正常工作......

`<link rel="stylesheet" href="path/to/styles.css">`

但是Javascript文件的相对路径不起作用......

`<script type="text/javascript" src="path/to/script.js"></script> <!-- This won't load!! -->`

Javascript文件的绝对路径确实有效......

`<script type="text/javascript" src="http://www.somecdn.com/jquery.js">`

内联Javascript也很好......

```
<script type="text/javascript">
    alert("You'll see me, that's for sure!");
</script> 
```

图像的相对路径也很好......

`<image src="path/to/image.png" alt="You can see me!" />`

因此，我想知道某处是否存在 IIS 设置，它根据请求的资源的 MIME 类型改变路径的工作方式。是否有其他原因导致样式表的相对路径可以工作而 javascript 文件的相对路径不可以？显然，这是一个向这里的 IT 人员提出的问题，他们似乎不知道是什么导致了问题。

# mvvm-light - MVVM Light 全局消息注册？

> ID：13635343
> 
> 赞同：1
> 
> 时间：2012-11-29T21:47:24.207
> 
> 标签：mvvm-light

我正在使用 MVVM light 来构建我的应用程序，到目前为止它已经取得了很好的效果。但我有一个小问题需要解决。

有没有办法在视图启动之前为每个视图模型全局注册消息侦听器。类似于 GlobalMessageRegistrationClass() 的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T19:19:55.370

如果您使用的是 MVVM Light 工具包，那么您必须创建一个应该从 MVVM Light 工具包类“ViewModelbase”继承的基本 Videmodel 类。然后，您的所有视图模型类都应该从您的自定义视图模型基类继承，而不是 MVVM 轻工具包基类“ViewModelbase”。在自定义视图模型基类的构造函数中，您可以注册消息。

# python - 使用 django 重定位迁移依赖项

> ID：13635348
> 
> 赞同：0
> 
> 时间：2012-11-29T21:47:47.223
> 
> 标签：python, django

我一直在管理我的 MacBook 的 Django 站点，同时将更改（通过 github）同步到我的 webfaction 生产和登台服务器。

我购买了一台新的 MacBook，并想开始重建我的环境。我的问题是 GH 版本化文件在项目中更深——与 manage.py 处于同一级别并包含 settings.py、模板文件、mvc 文件等。但是，它们不包括通过安装创建的文件和数据django 应用程序和依赖项。为此，我在将它们安装到我的 MacBook 环境后立即在 prod/staging 服务器上手动安装它们。

我很难理解的是这些依赖项的位置。我是 PHP 开发的受害者，并且习惯于我的所有文件都在公共文件夹中。

现在我已经把我的 github 仓库拉下来了，我想有办法复制所有这些东西吗？我不认为我能记住我从一开始就安装的许多依赖项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:11:31.130

管理特定项目的依赖项的典型方法是使用`pip`，`virtualenv`并写入/存储您为该特定项目安装的所有依赖项，方法是`virtualenv`运行

```
pip freeze > requirements.txt 
```

在项目的（根）目录中，然后将`requirements.txt`文件提交到项目的 git 存储库中。

您可以稍后通过简单地发出以下命令重新安装所有这些依赖项：-

```
pip install -r requirements.txt 
```

如果此时失败，您将不得不手动尝试找出在您尝试运行 python 项目时缺少哪些依赖项，并手动`pip install`每个依赖项，直到您的项目正常工作。

如果您仍然有旧的 macbook（可能仍然有），您`requirements.txt`现在可以通过运行`pip freeze > requirements.txt`. 但是，如果您没有使用`virtualenv`，您实际上会将您在旧 Macbook 系统范围内安装的所有依赖项冻结到您的`requirements.txt`文件中。

# box-api - 我可以通过 REST API 获取企业设置吗？

> ID：13635352
> 
> 赞同：2
> 
> 时间：2012-11-29T21:48:06.980
> 
> 标签：box-api

Box 中的“我的企业帐户”具有一些企业设置，例如密码策略。我可以使用 REST API 检索这些设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T00:36:20.280

目前您只能获取每个用户的设置，而不是一般企业设置：

[http://developers.box.com/docs/#users-get-the-current-users-information-2](http://developers.box.com/docs/#users-get-the-current-users-information-2)

# apache - 使用 DNS CNAME 的可见域重定向

> ID：13635356
> 
> 赞同：0
> 
> 时间：2012-11-29T21:48:34.773
> 
> 标签：apache, redirect, dns, cname

嗨，我是这个东西的新手。你能教我这个吗？

我们正在使用 DNS 重定向域。例如，我们有一个名为 www.olddomain.com 和 www.newdomain.com 的域，如果我们访问访问 www.newdomain.com 意味着我们可以访问应用程序。如果我们访问 www.olddomain.com，我们也可以访问相同的应用程序，因为我们通过 DNS CNAME 进行了重定向。但是地址栏仍然显示 www.olddomain.com

我们希望地址栏也更改为新域 www.newdomain.com 我希望可以通过 apache 中的一些重定向来完成。你能教我怎么做吗。

如果我们访问这两个域名，它应该转到同一个应用程序（它由 DNS CNAME 发生）以及我希望地址栏也更改为 www.newdomain.com，如果我们访问 www.olddomain.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:12:45.833

看看 Apache 的[mod_rewrite](https://httpd.apache.org/docs/current/mod/mod_rewrite.html)，看在上帝的份上，找一个可以为你做这类事情的人。

# html - HTML5 Canvas：绘图光标的位置

> ID：13635362
> 
> 赞同：1
> 
> 时间：2012-11-29T21:48:47.447
> 
> 标签：html, canvas, cursor, drawing, position

我不知道如何在 moveTo() 之后获取实际的绘图光标位置。查看我的代码：

```
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");

ctx.beginPath();
ctx.moveTo(10, 20);
// here i want to get from "ctx" actual offset
ctx.lineTo(20,30);
ctx.closePath(); 
```

有什么办法或者我必须将偏移量存储在我自己的变量 offsetX, offsetY 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T23:31:20.253

我假设你的意思是你有一堆相对路径命令，你想移动它们。

例如，要在左上角画一个三角形，你可以这样写：

```
ctx.beginPath();
ctx.moveTo(0, 0);
ctx.lineTo(100,0);
ctx.lineTo(50,100);
ctx.closePath(); // makes the last line for you
ctx.stroke(); 
```

那么，如果您想使用相同的路径，但要从 (175, 175) 开始绘制三角形呢？无需更改您`moveTo`和所有后续绘图命令，您所要做的就是*翻译*上下文。

```
ctx.save();
ctx.translate(175, 175);

ctx.beginPath();
ctx.moveTo(0, 0);
ctx.lineTo(100,0);
ctx.lineTo(50,100);
ctx.closePath(); // makes the last line for you
ctx.stroke();

// save/restore lets you undo the translation so the next object starts at (0,0)
// you could just call ctx.translate(-175, -175); at the end instead though
ctx.restore(); 
```

翻译上下文会改变绘图表面的原点，并允许您随其移动所有坐标（临时或不移动）。这意味着您可以定义一堆路径并在各处使用相同的命令重绘它们，使用`ctx.translate`.

在这里查看两个三角形：

[http://jsfiddle.net/qzYFC/](http://jsfiddle.net/qzYFC/)

# openxml-sdk - XML SDK 2.0 - 图像 - Excel 文件

> ID：13635363
> 
> 赞同：1
> 
> 时间：2012-11-29T21:48:51.473
> 
> 标签：openxml-sdk

通过使用 Open XML SDK 2.0，我确实执行了 Excel 文件的反射代码。除了其他内容外，Excel 文件的某些单元格中还有一些图像。当我运行生成的代码时，文件显示图像就好了。

我需要做的是以编程方式注入图像来代替现在存在的图像。问题是，我无法在生成的代码中找到图像的位置。我怎么能弄清楚这个？另外，以编程方式用新图像替换这些图像的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:19:14.963

您可能想查看有关使用 OpenXML SDK 将图像插入 Excel 文件的类似问题：[C# & OpenXML: Insert an image into an excel document](https://stackoverflow.com/questions/5793950/c-sharp-openxml-insert-an-image-into-an-excel-document)。

基本上，这些文件是作为单独的文档*部分*创建的。我链接到的答案应该向您展示如何将新图像插入文档，但是，为了用您的自定义图像替换现有图像，您可能只需修改适当的二进制数据`ImagePart`（以及其他一些相关属性）。

如果您在执行此任务的代码方面需要一些帮助，请告诉我。

# c# - SQL 数据读取器：不存在数据时尝试读取无效

> ID：13635366
> 
> 赞同：1
> 
> 时间：2012-11-29T21:49:07.490
> 
> 标签：c#, sql, sql-server, sqldatareader

我正在尝试使用 a`SqlDataReader`运行查询，然后在消息框中显示结果，但我不断收到错误消息

> *不存在数据时尝试读取无效。*

这是我的代码。

```
 public void button1_Click(object sender, EventArgs e)
 {
    string results = "";
    using (SqlConnection cs = new SqlConnection(@"Server=100-nurex-x-001.acds.net;Database=Report;User Id=reports;Password=mypassword"))
    {
         cs.Open();
         string query = "select stationipaddress from station where stationname = @name";
         using (SqlCommand cmd = new SqlCommand(query, cs))
         {
              // Add the parameter and set its value -- 
              cmd.Parameters.AddWithValue("@name", textBox1.Text);
              using (SqlDataReader dr = cmd.ExecuteReader())
              {
                   while (dr.Read())
                   {
                        label3.Text = dr.GetSqlValue(0).ToString();
                        results = dr.GetValue(0).ToString();
                        //MessageBox.Show(dr.GetValue(0).ToString());
                        //MessageBox.Show(results);
                    }
                    MessageBox.Show(results);
              }
         }
    } 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T21:51:25.477

这是正确的。
当您退出 while 循环时，DataReader 已到达加载数据的末尾，因此不能用于获取不存在的当前记录的值。

Read 方法将 SqlDataReader (dr) 推进到下一条记录，如果有更多行，则返回 true，否则返回 false。

如果您只有一条记录，则可以`results`以这种方式使用变量

```
MessageBox.Show(results); 
```

现在，这将起作用，因为您的 sql 语句中有一个 TOP 1，但是，如果您有多个记录，它将仅显示最后一条记录的值。

同样正如 marc_s 在其评论中指出的那样，如果您的表为空，则您的代码不会落入 while 循环中，因此您可能可以使用如下消息初始化结果变量：

```
 results = "No data found"; 
```

编辑：在下面看到您的评论，那么您应该以这种方式更改您的代码

```
.....
// Use parameters **ALWAYS** -- **NEVER** cancatenate/substitute strings 
string query = "select stationipaddress from station where stationname = @name";
using (SqlCommand cmd = new SqlCommand(query, cs))
{
    // Add the parameter and set its value -- 
    cmd.Parameters.AddWithValue("@name", textBox1.Text);
    using (SqlDataReader dr = cmd.ExecuteReader())
    {

        while (dr.Read())
        {
            label3.Text = dr.GetSqlValue(0).ToString();
            results = dr.GetValue(0).ToString();
        }
    }
}
..... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-09T23:20:00.650

我在尝试获取我知道的 GUID 时遇到了类似的问题 - 我可以直接在 SQL Management Studio 中运行相同的 SQL 并获得我的结果。因此，我没有尝试将其作为 GUID 带回（它保存在 char(35) 字段中，即使它确实是 GUID！），我将其作为字符串带回，而是：

```
 SqlConnection sqlConn = null;
        string projId = String.Empty;
        string queryString = "SELECT * FROM project WHERE project_name='My Project'";

        try
        {
            sqlConn = new SqlConnection(connString);
            SqlCommand cmd = new SqlCommand(queryString, sqlConn);
            sqlConn.Open();

            SqlDataReader reader = cmd.ExecuteReader();
            if (reader.HasRows)
            {
                while (reader.Read())
                {
                    projId = reader.GetSqlValue(0).ToString();   // <-- safest way I found to get the first column's parameter -- increment the index if it is another column in your result
                }                    
            }
            reader.Close();
            sqlConn.Close();
            return projId;                
        }
        catch (SqlException ex)
        {                
            // handle error
            return projId;
        }
        catch (Exception ex)
        {
            // handle error
            return projId;
        }
        finally
        {
            sqlConn.Close();
        } 
```

# mysql - 防止 2 个用户同时更新同一记录

> ID：13635369
> 
> 赞同：2
> 
> 时间：2012-11-29T21:49:11.797
> 
> 标签：mysql, database, concurrency

我有一张桌子`tbl_orders`。它有一个数量字段`quantity`。在我的应用程序的某些部分，我需要将数量减 1。

我已经知道`id`记录的（可从客户端获得），所以我发出更新声明：

```
UPDATE tbl_orders
SET quantity=quantity-1
WHERE id= 6 
```

问题是这个查询可能会意外地同时运行多次。例如，两个客户服务运营商可能同时更新同一记录。这意味着当它应该只减少一次时，数量将减少 2。

我尝试将更新放入事务中，但这只会延迟第二个事务，直到第一个事务被提交。一旦它被提交，第二次更新就会运行并再次减少记录。

如果一个人正在修改记录，我如何确保其他查询失败？

**更新：**

为了使更新有效，客户端的数量在数据库中是相同的。例如，如果用户在他的浏览器上看到一个数量 5 并想要减少它，那么数据库中的值必须相同。

**更新 2**

[我在这里](http://docs.doctrine-project.org/en/2.0.x/reference/transactions-and-concurrency.html#optimistic-locking)找到了使用 Doctrine 2 进行乐观锁定的一个很好的解释：

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T21:57:13.670

我过去使用/看到的一种方法是使用时间戳列。查询时，请确保您在开始编辑记录时拥有 ID 和原始时间戳。然后，当您尝试更新时，通过发送

```
update YourTable
   set counter = counter -1,
       TheTimestampColumn = new timestamp value
   where ID = yourID
     and TheTimeStampColumn = timeStampEditStartedWith 
```

这样，谁先得到原始起始时间戳，谁就赢了。对于以下内容，您必须跟踪更新了多少记录，如果该计数为零，则您将通知用户在您查看记录时另一个人对记录进行了更改。是否要重新加载最新数据？（或类似的东西）。

# google-drive-api - Drive API - 外部共享

> ID：13635372
> 
> 赞同：2
> 
> 时间：2012-11-29T21:49:29.663
> 
> 标签：google-drive-api

我知道由于隐私问题，Google Drive SDK 不会在权限对象的值字段中显示用户电子邮件。如果我们没有该用户电子邮件地址，是否有办法知道文档是否与域外的任何人共享？

此外，使用文档的所有者身份验证检索权限是否允许我们查看该电子邮件地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T09:13:50.817

您无法使用 Drive API 做到这一点。但是，您可以使用旧的和已弃用的 Gdata DocumentList API 来实现此结果

# r - 财务 - 使用 plyr 和 rportfolio 的随机投资组合 - 需要拆分列

> ID：13635376
> 
> 赞同：2
> 
> 时间：2012-11-29T21:49:38.897
> 
> 标签：r, finance, plyr, reshape2

我试图将实际投资组合的表现与假设的随机投资组合的表现进行比较。

这是我正在使用的数据集的示例。它显示了两个月的数据，投资组合中经理的姓名，以及这些经理的回报、分配和归属。

```
"date" "manager" "return" "allocation" "attribution"
2005-01-31 "manager01" -0.00763241754291056 0.146 6.94549996404861e-05
2005-01-31 "manager02" 0.0292205518315147 0.048 4.09087725641205e-05
2005-01-31 "manager03" -0.0354047394153526 0.049 -8.85118485383814e-05
2005-01-31 "manager04" 0.0424244772606645 0.124 -0.000148485670412326
2005-01-31 "manager05" -0.0574606103881735 0.134 0.000206858197397425
2005-01-31 "manager06" 0.0465278163188542 0.098 -0.000265208553017469
2005-01-31 "manager07" 0.157063203979822 0.142 -0.000219888485571751
2005-01-31 "manager08" -0.0594342759491509 0.071 2.97171379745754e-05
2005-01-31 "manager09" -0.0199466865109495 0.093 6.18347281839434e-05
2005-01-31 "manager10" 0.118839410130508 0.095 0.000190143056208813
2005-02-28 "manager01" 0.0403671815817711 0.119 -0.000460185870032191
2005-02-28 "manager02" 0.0246109773791459 0.064 -3.93775638066334e-05
2005-02-28 "manager03" 0.00868489880733732 0.065 -4.08190243944854e-05
2005-02-28 "manager04" -0.082332291530606 0.105 2.46996874591818e-05
2005-02-28 "manager05" -0.0903959999837099 0.114 -0.000117514799978823
2005-02-28 "manager06" 0.0514735666329574 0.081 -6.17682799595489e-05
2005-02-28 "manager07" -0.00914374153663751 0.164 -8.41224221370651e-05
2005-02-28 "manager08" -0.0367283709786134 0.083 -4.77468822721974e-05
2005-02-28 "manager09" -0.04752320926613 0.079 -3.8018567412904e-05
2005-02-28 "manager10" -0.0657464361573664 0.126 -0.000309008249939622 
```

为了将数据导入 R，将数据复制到剪贴板，然后

```
mydata<-read.table("clipboard",header=TRUE) 
```

为了创建随机投资组合，我使用`ddply`、`mutate`和 和中`rlongonly`的函数。`plyr``rportfolio`

```
library(plyr)
library(rporfolio)

mydata.new<-ddply(mydata,.(date),mutate,new.attr=t(rlongonly(m=1,n=length(date),k=10,x.u=.15))*return) 
```

在`rlongonly`函数中：

*   m 的值是我想要创建的随机投资组合的数量。
*   n 的值是该时间段的分配数。
*   k 的值是非零分配的数量。
*   xu 的值是分配的上限。

归因仅仅是回报*分配。

如果我有 m=1，一切都很好。如果我有 m>1，则输出的尺寸不正确。

```
mydata.new2<-ddply(mydata,.(date),mutate,new.attr=t(rlongonly(m=2,n=length(date),k=10,x.u=.15))*return)
dim(mydata.new) 
```

mydata.new2 应该有 7 列时只有 6 列。最后一列“new.attr”基本上是 2 列合二为一。

当我尝试`melt`mydata.new2 时，我收到以下错误。

```
library(reshape2)
drop<-names(mydata.new2) %in% c("manager","return","allocation")
melt(mydata.new2[!drop],id="date")

> Error in rbind(deparse.level, ...) : 
> numbers of columns of arguments do not match 
```

如何拆分“new.attr”列，以便可以融合和绘制数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T01:18:27.387

首先我重新生成你的数据，你必须使用 dput(mydata) 并在下次发布结果。

然后我生成你的 mydata.new2 向量。

```
library(plyr)
library(rportfolios)

mydata.new2<-ddply(mydata,
                  .(date),
                  mutate,
                  new.attr=t(rlongonly(m=2,n=length(date),k=10,x.u=.15))*return) 
```

我将数值四舍五入，我和我显示数据

```
 mydata.new2[,-c(1,2)] <- numcolwise(round_any)(mydata.new2,0.0001)
 head(mydata.new2)
        date   manager  return allocation attribution new.attr.1 new.attr.2
1 2005-01-31 manager01 -0.0076      0.146       1e-04    -0.0009    -0.0007
2 2005-01-31 manager02  0.0292      0.048       0e+00     0.0032     0.0040
3 2005-01-31 manager03 -0.0354      0.049      -1e-04    -0.0024    -0.0049
4 2005-01-31 manager04  0.0424      0.124      -1e-04     0.0029     0.0025
5 2005-01-31 manager05 -0.0575      0.134       2e-04    -0.0047    -0.0042
6 2005-01-31 manager06  0.0465      0.098      -3e-04     0.0051     0.0039 
```

这里我有 7 列，而不是你说的 6 列。

我尝试融化数据：

```
library(reshape2)
drop<-names(mydata.new2) %in% c("manager","return","allocation")
melt(mydata.new2[!drop],id="date") 
```

但是在这里你会得到错误：

```
 numbers of columns of arguments do not match 
```

由于 mydata.new2 data.frame 中的**嵌套 data.frame** new.attr。这是由于使用了**mutate**。这里最好使用**转换**，因为您不需要迭代地进行转换。

所以 ：

```
mydata.new2<-ddply(mydata,
                  .(date),
                  transform,
                  new.attr=t(rlongonly(m=2,n=length(date),k=10,x.u=.15))*return) 
```

你得到你的结果

```
head(melt(mydata.new2[!drop],id="date"))
        date    variable         value
1 2005-01-31 attribution  6.945500e-05
2 2005-01-31 attribution  4.090877e-05
3 2005-01-31 attribution -8.851185e-05
4 2005-01-31 attribution -1.484857e-04
5 2005-01-31 attribution  2.068582e-04
6 2005-01-31 attribution -2.652086e-04 
```

# c++ - 当用户被要求按 i 查看库存时双线

> ID：13635382
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:49:56.613
> 
> 标签：c++, validation, char

嘿基本上我有2个功能：

```
void Inventory:: showInventory()
{
    char input[80];
    cin >> input;
    char inventoryRequest[] = "i";
    //compare the player input to inventoryRequest (i) to see if they want to
    //look at inventory.
    int invent = strcmp (input,inventoryRequest);

    if(invent == 0) {
        //vector<string> inventory;
        cout << "You have " << inventory.size() << " items.\n";
        cout << "\n******Inventory******";
        cout << "\nYour items:\n";

        for (int i= 0; i< inventory.size(); ++i) {
            cout<< inventory[i] << endl;
        }
    }

}

void Inventory :: displayInventory(const string str) {
    char input = 0;
    do
    {
        cout << str << endl;
        cin >> input;
    }
    while((input != 'i') && (input != 'I') && (input != 'n') && (input != 'N'));
    showInventory();
    //return input;
} 
```

showInventory 将玩家输入与 i 进行比较。显示库存只允许用户按 i 或 n。i 查看库存，n 跳过。但是当我被按下时。它会导致双线。

这意味着我必须按两次才能查看库存。

我已经尝试了很多方法来阻止这种情况的发生。但我没有成功，而且大多数时候根本无法查看库存。

任何人都可以帮我解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:02:21.107

尝试使用参数输入 on `void Inventory::showInventory()`，并消除第二个`cin`，如下所示：

```
void Inventory:: showInventory(char input)
{
    //char input[80];
    //cin >> input;
    //char inventoryRequest[] = "i";
    //int invent = strcmp (input,inventoryRequest);
    //compare the player input to inventoryRequest (i) to see if they want to look at inventory.
    //if(invent == 0)  // REPLACE THIS WITH THE LINE BELOW
    if(input == 'i') 
```

然后当你调用它时，这样做：

```
 showInventory(input); 
```

# jquery - 查询。我已经达到了我想要的效果，但我只想让它在主页上工作

> ID：13635383
> 
> 赞同：0
> 
> 时间：2012-11-29T21:50:03.717
> 
> 标签：jquery, jquery-selectors

我目前正在制作我的第二个网站，并且是第一次使用 Jquery。我想在我的页面一侧连续 4 个小方块淡入，在加载主页时按顺序淡入。

我已经做到了！它看起来很棒，但我不希望每次观众点击不同的页面时都会发生这种效果。

如果有人能告诉我如何编写这个动画，让它淡入我的索引页面，我将不胜感激。

下面列出了我当前的代码，

非常感谢！

```
$(document).ready(function(){

  $('.wrapper').fadeIn(1000);

  $("#BlockOne").fadeIn('slow');

  $("#BlockTwo").fadeIn(2500);

  $("#BlockThree").fadeIn(2500);

  $("#BlockFour").fadeIn('slow');

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:51:59.710

仅将代码放在主页上的脚本块中。**大概**所有其他页面都需要单独的 css 以确保您始终可以看到这些块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T23:31:09.557

在按钮的单击事件处理程序中定义代码并使用**.one**绑定它。

然后**触发点击**事件..看起来它有效..

```
$(document).ready(function() {
    // This will fire only once..
    $('button').one('click', function() {
        $('.wrapper').fadeIn(1000);
        $("#BlockOne").fadeIn('slow');
        $("#BlockTwo").fadeIn(2500);
        $("#BlockThree").fadeIn(2500);
        $("#BlockFour").fadeIn('slow');
    });

    $('button').click();
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T21:56:05.017

有很多方法可以解决这个问题。

您根本无法在主页以外的页面上输出此 javascript。如果您需要使隐藏元素出现在其他页面上的功能，您可以只使用替代 javascript 来立即显示它们，而无需`fadeIn`.

您可以在所有页面上输出一个通用功能，但使用文档位置上的条件来确定是淡入还是立即显示。

您可以在 cookie、HTMLS localStorage 或会话存储中保存一些值，以充当标志来确定是淡入显示还是立即显示。

我个人更喜欢后者，因为用户没有通过主页到达您的网站？我认为您的意图是在第一个访问的页面上产生淡入效果，不一定是主页。

# delphi - DBGo INSERT INTO 通过 SQL.CommandText

> ID：13635385
> 
> 赞同：0
> 
> 时间：2012-11-29T21:50:04.867
> 
> 标签：delphi

我已经习惯使用`SQL.TEXT`变量来初始化我的查询，以避免两个语句：`SQL.Clear; SQL.Add( );`使用 DBExpress。

将 dbGo 用于一个新的小项目，这使得：

```
SQL.CommandText := 'INSERT INTO LeaveClass (id,name,color,status) VALUES (1,''Joe'',255,''Ok'')';
ExecSql; 
```

此命令因语法错误而中断。但是如果我们使用：

```
SQL.Clear;
SQL.Add( 'INSERT INTO LeaveClass (id,name,color,status) VALUES (1,''Joe'',255,''Ok'')' );
ExecSql; 
```

它工作正常！好吧，在解决这个问题并找到解决方法之前，我已经浪费了一些时间。我会犯什么错误？可能是`dbGo.ADOQUERY.Sql.Clear`任务通过`dbGo.ADOQUERY.SQL.CommandText`没有进行的深层清洁。诡异的。有什么命令吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T23:16:40.970

`CommandText`真的只适用于`SELECT`或其他返回数据（记录集）的操作。它不是为`ExecSQL`或`INSERT`/`DELETE`类型操作而设计的。

只需使用`ADOQuery.SQL.Text`：

```
ADOQuery1.SQL.Text := 'INSERT INTO LeaveClass (id,name,color,status) VALUES (1,''Joe'',255,''Ok'')';
ADOQuery1.ExecSQL;
ADOQuery1.Close; 
```

直接设置`Text`属性会自动替换之前的属性，不再需要`Clear`.

# java - maven依赖拉错误的依赖

> ID：13635388
> 
> 赞同：10
> 
> 时间：2012-11-29T21:50:13.920
> 
> 标签：java, maven, dependencies, apache-httpcomponents

我有如下依赖：

```
 <dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpclient</artifactId>
        <version>4.2</version>
        <scope>compile</scope>
    </dependency> 
```

当我部署一切正常时，这会拉下另一个`httpcore.4.1.4`引发 ClassDefNotFound 的依赖项。`httpcore.4.2`

我添加了两个依赖项，如下所示：

```
 <dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpclient</artifactId>
        <version>4.2</version>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.apache.httpcomponents</groupId>
        <artifactId>httpcore</artifactId>
        <version>4.2</version>
        <scope>compile</scope>
    </dependency> 
```

并且仍然面临同样的问题，即：mvn down `httpcore.4.1.2`not`httpcore.4.2`

我该如何解决这个问题？

编辑：

添加;

```
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2</version>
            <scope>compile</scope>
        </dependency>
    </dependencies>
    </dependencyManagement> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T21:52:10.233

您可能有一个传递依赖项，您的其他依赖项之一取决于您不想要的版本。

要获得所有依赖项的概述，直接和传递，请尝试：

> mvn 依赖：树

如果你发现同一个依赖的不同版本之间发生了崩溃，你应该做的第一件事是弄清楚崩溃是否很严重（你需要两者吗？）如果不是，升级，使最低的依赖版本等于最高的. 如果它是传递依赖关系，请考虑升级它的版本。

如果您只想锁定特定版本的依赖项，您有一些选择：

排除传递依赖：

```
<dependency>
  <groupId>com.something</groupId>
  <artifactId>something</artifactId>
  <exclusions>
    <exclusion>
      <groupId>com.somethingElse</groupId>
      <artifactId>somethingElse</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

包括特定版本：

```
<dependency>
  <groupId>com.somethingElse</groupId>
  <artifactId>somethingElse</artifactId>
  <version>2.0</version>
</dependency> 
```

在你的 pom 中显式添加的任何依赖版本都将覆盖相同 groupId/artifactId 的任何传递依赖的版本。

尽管有点困惑，但您应该尝试获取依赖项的兼容版本，即具有相同版本传递依赖项的版本。

# android - 如何将值从一个片段转移到另一个片段

> ID：13635390
> 
> 赞同：1
> 
> 时间：2012-11-29T21:50:23.187
> 
> 标签：android, bundle, fragment

[例子](https://stackoverflow.com/questions/7149802/how-to-transfer-some-data-to-another-fragment) 这个例子我看不懂。如何申请我的计划

我尝试在我的程序中写

一般用的我都可以。但是替换了片段。我不知道怎么用。

传递对象的值。

```
 public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        View view = inflater.inflate(R.layout.templistmune, container, false);
FragmentManager DS2 = getFragmentManager();
    FragmentTransaction DSE2 = DS2.beginTransaction();
    Fragment DF2 = DS2.findFragmentById(R.id.frameLayout4);
    if (DF2 == null) {
        String title = "Fragment A";
        templistview2 usermune = new templistview2(title);
        DSE2.add(R.id.frameLayout4, usermune);
        DSE2.addToBackStack(null);
        DSE2.commit();   
/////////////////////////////////////////////////////////   
        Bundle bundle = new Bundle();
        String SAS="50";
        bundle.putString("ST", SAS);
        DF2.setArguments(bundle);
////////////////////////////////////////////////
        } 
```

对象 templistview2.java 的选取值

```
 public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        View view = inflater.inflate(R.layout.templistmune2, container, false);
////////////////////////////////////////////////////////////////////////////////////
     Bundle bundle = this.getArguments();
    String myST = bundle.getString("ST", SAS);
 ///////////////////Error SAS cannot be resolved to a variable  /////////////////

        return view;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:13:40.157

您只是添加了`Bundle`when `DF2`is null... 所以您的程序要么在`NullPointerException`某个地方崩溃，要么运行但没有`Bundle`通过。

所以放置

```
 Bundle bundle = new Bundle();
    String SAS="50";
    bundle.putString("ST", SAS);
    DF2.setArguments(bundle); 
```

在 if 结构之外。

# php - 如何将变量从 php 发送到 android 应用程序？

> ID：13635395
> 
> 赞同：2
> 
> 时间：2012-11-29T21:50:47.323
> 
> 标签：php, android

大家好，我当前的 android 应用程序中有一个活动，其中有一个 webview。我想知道如何从该网站上的 php 中获取变量并将其存储到我的 android 应用程序上的变量中（是的，我控制了网站，并具有完整的编辑功能）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T03:42:58.357

I would explain the things need to be done in general. First, at your android app side, there should be code something like this.

1)At your android side

```
String url = "www.yoururl.com/yourphpfile.php";
List<NameValuePair> parmeters = new ArrayList<NameValuePair>();
            parameters.add(new BasicNameValuePair("category",category));
            parameters.add(new BasicNameValuePair("subcategory",subcategory));// These are the namevalue pairs which you may want to send to your php file. Below is the method post used to send these parameters

  DefaultHttpClient httpClient = new DefaultHttpClient();

  HttpPost httpPost = new HttpPost(url); // You can use get method too here if you use get at the php scripting side to receive any values.

  httpPost.setEntity(new UrlEncodedFormEntity(parameters));

  HttpResponse httpResponse = httpClient.execute(httpPost);

  HttpEntity httpEntity = httpResponse.getEntity();

  is = httpEntity.getContent();

   BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8); // From here you can extract the data that you get from your php file..

        StringBuilder builder = new StringBuilder();

        String line = null;

        while ((line = reader.readLine()) != null) {
            builder.append(line + "\n");
        }

        is.close();
        json = sb.toString(); // Here you are converting again the string into json object. So that you can get values with the help of keys that you send from the php side.

        String message = json.getString("message");
         int success = json.getInt("success"); // In this way you again convert json object into your original data. 
```

2) At your php side

```
$response = array();

// check for post fields
if (isset($_POST['category']) && isset($_POST['subcategory'])) {

    $category = $_POST['category'];
    $subcategory = $_POST['subcategory'];

    // include db connect class
    require_once __DIR__ . '/db_connect.php';

    // connecting to db
    $db = new DB_CONNECT();

    // mysql inserting a new row
    $result = mysql_query("INSERT INTO categorytable(category, subcategory) VALUES('$category', '$subcategory')");

    // check if row inserted or not
    if ($result) {
        // successfully inserted into database
        $response["success"] = 1;
        $response["message"] = "Data inserted into database.";

        // echoing JSON response
        echo json_encode($response);// Here you are echoing json response. So in the inputstream you would get the json data. You need to extract it over there and can display according to your requirement.
} 
```

As you said you are fairly proficient in php, you might have found that the above things in php made as simple as possible and It's not secured. So, you can follow some pdo or some other secured ways to code at php side. Make sure you surround the code at your android side in asynctask in order to run in separate thread wherever you need. Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:18:04.717

您的 android 应用程序需要在您设置 PHP 脚本以返回所需数据的 URL 处向您的 PHP 应用程序发出请求。

您可以直接返回 HTML，或者如果您只想返回数据并让您的 Android 应用程序返回，JSON 是一种出色的数据传输格式。XML 也很流行，但 JSON 更精简，并且现在有很好的支持。

# c++ - 迭代乘法时核心转储

> ID：13635398
> 
> 赞同：1
> 
> 时间：2012-11-29T21:51:01.033
> 
> 标签：c++

我正在尝试做一些非常简单的事情。我有一个函数类和一个从函数类派生的多项式类。在多项式中，我重载了 *= 运算符。但是，当我调用此运算符时，程序会转储核心并崩溃。

```
Polynomial& Polynomial::operator*= (double c)
{
    for(int i = 0; i <= degree; i++)
        a[i] = a[i] * c;
return *this;
} 
```

多项式类将系数保存在数组 a 中。a 的索引与该特定系数的 x 的幂直接相关。函数 main 将常数 c 传递给我们，然后我们将每个系数乘以该常数。

该函数的原型是作业的一部分，或者我会更改它。我假设在返回类型方面我做错了什么。任何帮助表示赞赏。

如果需要，我愿意提供更多代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T21:52:16.117

返回类型很好，我猜问题是`i <= degree`而不是`i < degree`. C++ 中的数组是从 0 开始的。

编辑：或者您可能希望保持`<=`与多项式的一致性，在这种情况下，您需要`degree+1`为数组分配项目。

# ruby-on-rails - Rails 3 验证数值在空白/无时抛出参数错误

> ID：13635399
> 
> 赞同：2
> 
> 时间：2012-11-29T21:51:04.213
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation

这似乎很简单，但我想要求一个数字并确保它不大于或小于预定数量：

```
validates :age_min, presence: true, numericality: {
  greater_than: 0, less_than_or_equal_to: :age_max
} 
```

该测试按预期工作

```
test 'user should not be valid with age min greater than age max' do
  user = FactoryGirl.build(:user, age_min: 30, age_max: 20)
  assert !user.valid?
end 
```

但是，当我尝试测试时，这`age_min`是必需的：

```
test 'user should not be valid without age_min' do
  user = FactoryGirl.build(:user, age_min: nil, age_max: 20)
  assert !user.valid?
end 
```

我明白了`ArgumentError: comparison of Float with nil failed`

Rails 没有考虑 nil 值似乎很奇怪，或者我错过了什么？看来您应该能够在不编写自定义验证器的情况下使其工作，但也许我弄错了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:07:40.400

由于您对age_min id 的数值验证取决于age_max 的值，而不是固定值，因此我认为您希望将验证分开并使用procs 防止nil 值

```
validates :age_min, :age_max, :presence => true
validates :age_min, :numericality => {greater_than: 0, less_than_or_equal_to: :age_max}, :unless => Proc.new {|user| user.age_min.nil? || user.age_max.nil? } 
```

# php - PHP：正则表达式中的剩余文本

> ID：13635400
> 
> 赞同：2
> 
> 时间：2012-11-29T21:51:13.837
> 
> 标签：php, regex

尝试编写一个脚本，其中用户输入 [link](http://www.example.com) 并返回一个名为“link”的超链接，其中“http://www.example.com”作为 href。这是我的代码：

```
if(preg_match("/\[[a-zA-Z0-9]*\]([a-zA-Z0-9]*)/", $input))
{
    $input = preg_replace("/\[([a-zA-Z0-0-9]*)\](([a-zA-Z0-9]*))/", "<a href='$2'>$1</a>", $input);
} 
```

我不断回来的是`[link](http://www.example.com)(http://www.example.com)`。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:55:48.873

您忘记转义文字括号（因此该`(([a-zA-Z0-9]*))`部分仅匹配空字符串）。

此外，如果您想匹配链接，您至少需要允许使用斜杠、冒号和点：

```
$input = preg_replace("%\[([A-Z0-9]*)\]\(([A-Z0-9/:.]*)\)%i", "<a href='$2'>$1</a>", $input); 
```

或者可能

```
$input = preg_replace("%\[([A-Z0-9]*)\]\((https?://[A-Z0-9/.]*)\)%i", "<a href='$2'>$1</a>", $input); 
```

# javascript - 我可以移动滚动条并使其始终可见吗？

> ID：13635404
> 
> 赞同：0
> 
> 时间：2012-11-29T21:51:30.280
> 
> 标签：javascript, html, css, scroll

![在此处输入图像描述](../Images/626b44ac5e0fa9db5f76264c580fedf6.png) ![在此处输入图像描述](../Images/9d1f2d6d3235516fa28ad600ef8a1393.png)

当我展开我的一个节点，并且数据下降到窗口底部下方时，滚动条出现并且使顶部栏有点挤压。有什么办法可以让滚动条只显示在底部的白色区域。另外，即使不需要它，我可以让它始终显示，因此它不会出现和消失吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T21:53:29.983

给白色区域一个固定的高度并设置`overflow`为`auto`或`scroll`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:55:52.637

我只会在可能大于窗口的元素上使用 css 'min-height'； `body { min-height: 101%; }`可能会这样做。

# sql - 在 Derby 中插入行之前如何设置列值？

> ID：13635407
> 
> 赞同：3
> 
> 时间：2012-11-29T21:51:35.873
> 
> 标签：sql, oracle, triggers, derby

我正在尝试在我的 Derby 数据库中创建 Oracle 的 ORA_ROWSCN 的粗略模拟。我正在使用 Derby 进行单元测试，这样测试人员就不必安装 Oracle Express 或类似的东西。所以我有一个看起来像这样的声明：

```
CREATE TRIGGER 
my_table_bi NO CASCADE BEFORE 
INSERT ON my_table
REFERENCING NEW AS NEW
FOR EACH STATEMENT MODE DB2SQL
NEW.ORA_ROWSCN = 1 
```

我最终想让它变得更复杂，但我想从让它变得可能开始。我收到一条错误消息

> 语法错误：在第 6 行第 5 列遇到“NEW”

我错过了什么？这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-25T03:56:50.457

我用它来模拟插入前，如果还不算太晚，它可能会对你有所帮助。

```
DROP TRIGGER TRI_UPPER_FIRSTNAME_PERSONNES;
CREATE TRIGGER TRI_UPPER_FIRSTNAME_PERSONNES
AFTER INSERT ON PERSONNES
REFERENCING NEW AS NEW
FOR EACH ROW
UPDATE PERSONNES SET FIRSTNAME_PER = UPPER(NEW.FIRSTNAME_PER) WHERE NEW.SID_PER = SID_PER; 
```

# .net - 托管代码中的 ARP 请求

> ID：13635414
> 
> 赞同：2
> 
> 时间：2012-11-29T21:52:07.053
> 
> 标签：.net, vb.net, networking, arp

我正在尝试利用 (vb) .NET 中 ARP 协议的强大功能来构建家庭 LAN 上所有联网设备及其硬件 (MAC) 地址的列表。我已经想出了如何计算子网上的所有 IP 地址，但我一直在寻找一种干净的方法来发送 ARP 请求并读取响应。

请注意，*所有*联网设备都包括非 Windows 设备（例如智能手机）。这意味着**WMI 是不可能的**。

现在我不知道哪种方式更麻烦：A）将本机[IP 助手](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366073%28v=vs.85%29.aspx)API 包装在托管代码中以使用其 SendArp 方法，或 B）向每个主机发送 ping 请求以填充 ARP 缓存，然后解析输出`arp.exe -a`。

有谁知道只使用托管代码来处理 ARP 请求/响应的方法？使用套接字对象和一点点魔法来实现似乎并不难，但我找不到任何提供 ARP API 的第三方网络库。恐怕我没有足够的知识来自己创造一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:56:17.433

因此，我决定包装 Windows API 将是最不混乱的解决方案，并提出以下内容供所有人查看：

首先，我创建了`Friend NotInheritable Class`一个名为**NativeMethods**的私有构造函数（大致相当于 C# 中的静态内部类）和一个名为**IPHelper**的子类（也是静态内部类） 。这是我放置从 pinvoke.net （[源代码](http://pinvoke.net/default.aspx/iphlpapi/SendARP.html)）无耻复制的 DllImport 的地方。

```
Friend NotInheritable Class NativeMethods
    Private Sub New()
    End Sub

    Friend NotInheritable Class IPHelper
            Private Sub New()
            End Sub

            ' Possible return values
            Friend Const NO_ERROR As Integer = 0
            Friend Const ERROR_BAD_NET_NAME As Integer = 67
            Friend Const ERROR_BUFFER_OVERFLOW As Integer = 111
            Friend Const ERROR_GEN_FAILURE As Integer = 31
            Friend Const ERROR_INVALID_PARAMETER As Integer = 87
            Friend Const ERROR_INVALID_USER_BUFFER As Integer = 1784
            Friend Const ERROR_NOT_FOUND As Integer = 1168
            Friend Const ERROR_NOT_SUPPORTED As Integer = 50

            ' API function declaration.
            <DllImport("iphlpapi.dll", SetLastError:=True)>
            Friend Shared Function SendARP(
                     DestIP As UInt32,
                     SrcIP As UInt32,
                     pMacAddr() As Byte,
                     ByRef PhyAddrLen As Int32) As UInt32
            End Function

    End Class
End Class 
```

现在最重要的是，我编写了一个使用 SendARP 方法的公共类**ArpRequest 。**

```
Imports System.Net
Imports System.Runtime.InteropServices
Imports System.ComponentModel
Imports System.IO
Imports System.Net.NetworkInformation

Public Class ArpRequest

    Private _address As IPAddress

    Public Sub New(address As IPAddress)
            _address = address
    End Sub

    ''' <summary>
    ''' Gets the MAC address that belongs to the specified IP address.
    ''' </summary>
    ''' <remarks>This uses a native method and should be replaced when a managed alternative becomes available.</remarks>
    Public Function GetResponse() As PhysicalAddress
            Dim ip As UInteger = BitConverter.ToUInt32(_address.GetAddressBytes(), 0)
            Dim mac() As Byte = New Byte(5) {}

            Dim ReturnValue As Integer = CInt(NativeMethods.IPHelper.SendARP(CUInt(ip), 0, mac, mac.Length))

            If ReturnValue = NativeMethods.IPHelper.NO_ERROR Then
                    Return New PhysicalAddress(mac)
            Else
                    ' TODO: handle various SendARP errors
                    ' http://msdn.microsoft.com/en-us/library/windows/desktop/aa366358(v=vs.85).aspx
                    Throw New Win32Exception(CInt(ReturnValue))
            End If
    End Function
End Class 
```

用法很简单（但要注意 Win32Exceptions）：

```
 Dim ip = System.Net.IPAddress.Parse("0.0.0.0") ' replace with actual ip
    Dim arp = New ArpRequest(ip)
    Dim hardwareAddress = arp.GetResponse() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:01:38.460

有关的：

*   [如何通过 .NET 访问 ARP 协议信息？](https://stackoverflow.com/questions/1148778/how-do-i-access-arp-protocol-information-through-net)

接受的答案使用 COM，但引用了一个非常有趣的链接，指向似乎创建了基于 C# 的数据包捕获库的开发人员，以及如何使用它获取 ARP 信息的示例。也许这对你有用？

请注意，我不知道“SharpPcap”是否包装了非托管代码。

没有可以直接处理 ARP AFAIK 的内置托管代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-19T16:59:42.137

我创建了您要求的这样一个库：[ArpLookup](https://github.com/georg-jung/ArpLookup)。

实际上，您不能使用套接字对象来生成 ARP 数据包，因为原始套接字被禁用/仅管理员/等。在所有相关的现代操作系统中。因为我想编写跨平台代码，所以我将您的两个想法都实现为一个更适合的 Linux，一个是 Windows。在 Windows 上使用本机 API。在 Linux 上，`/proc/net/arp`读取包含系统 arp 表的文件。如果未找到请求的 IP，则会发送 ping 并再次进行查找。这适用于 Linux，包括。Android（给定相关的应用权限）但不是在 macOS 上。

# android - 视频播放完毕后的对话框（OnCompletionListener + Dialog）

> ID：13635419
> 
> 赞同：0
> 
> 时间：2012-11-29T21:52:31.520
> 
> 标签：android, dialog, onclicklistener

视频播放完毕后，我正试图获得一个警告对话框。

这是我到目前为止的代码：

```
 public class VideoActivity extends Activity{
 private Context mContext; 

        public void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.videoview);
          this.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
          VideoView vv = (VideoView) findViewById(R.id.videoview);
          MediaController mc = new MediaController(this);

    public OnCompletionListener onCompletion(final String key){
            OnCompletionListener ocl = new OnCompletionListener(){  

    public void onCompletion(MediaPlayer mp) {      
    AlertDialog.Builder dialog = new AlertDialog.Builder(mContext); //Lag en dialog utifra kontekst
    dialog.setTitle("Hello"); //Hent ut tittelen til overlayItem
    dialog.setMessage("hello");  //Hent ut teksten til overlayItem
    dialog.setCancelable(false);

    dialog.setPositiveButton("Something", new OnClickListener() {           
        public void onClick(DialogInterface dialog, int id) {
            Intent intent = new Intent(mContext, VideoMenu.class);                      
            mContext.startActivity(intent);
        }
    });

    dialog.show(); //Vis dialogen
} 
```

还有另一种方法可以做到这一点吗？我一直在疯狂地搜索，但找不到任何帮助。使用此代码，我得到一个空指针异常。

谢谢！:)

```
11-29 23:12:54.215: E/AndroidRuntime(8445): FATAL EXCEPTION: main
11-29 23:12:54.215: E/AndroidRuntime(8445): java.lang.NullPointerException
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.app.AlertDialog.resolveDialogTheme(AlertDialog.java:142)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.app.AlertDialog$Builder.<init>(AlertDialog.java:359)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at com.example.norskattraksjon.VideoActivity$1.onCompletion(VideoActivity.java:97)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.widget.VideoView$3.onCompletion(VideoView.java:345)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.media.MediaPlayer$EventHandler.handleMessage(MediaPlayer.java:1773)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.os.Looper.loop(Looper.java:137)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at android.app.ActivityThread.main(ActivityThread.java:4517)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at java.lang.reflect.Method.invokeNative(Native Method)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at java.lang.reflect.Method.invoke(Method.java:511)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:993)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:760)
11-29 23:12:54.215: E/AndroidRuntime(8445):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:34:03.573

您已定义`mContext`但仍需要对其进行初始化：

```
private Context mContext; // Defined

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mContext = this; // Initialized
    ... 
```

# c# - 作为事件处理程序的 lambda 表达式如何更改局部变量？

> ID：13635420
> 
> 赞同：1
> 
> 时间：2012-11-29T21:52:32.840
> 
> 标签：c#, lambda, event-handling

我正在为我的一门课程编写一些测试，我需要测试是否正在引发一个事件。除了尝试并查看发生了什么之外，我编写了类似于以下极其简化的代码的代码。

```
public class MyEventClass
{
    public event EventHandler MyEvent;
    public void MethodThatRaisesMyEvent()
    {
        if (MyEvent != null)
            MyEvent(this, new EventArgs());
    }
}

[TestClass]
public class MyEventClassTest
{
    [TestMethod]
    public void EventRaised()
    {
        bool raised = false;
        var subject = new MyEventClass();
        subject.MyEvent += (s, e) => raised = true;

        subject.MethodThatRaisesMyEvent();

        Assert.IsTrue(raised);
    }
} 
```

当我开始尝试弄清楚它是如何工作的时候，我并不感到惊讶。具体来说，如果没有 lambda 表达式，我将如何编写它以便`raised`可以更新局部变量？换句话说，编译器如何重构/翻译这个？

我走到这一步...

```
[TestClass]
public class MyEventClassTestRefactor
{
    private bool raised;

    [TestMethod]
    public void EventRaised()
    {
        raised = false;
        var subject = new MyEventClass();
        subject.MyEvent += MyEventHandler;

        subject.MethodThatRaisesMyEvent();

        Assert.IsTrue(raised);
    }

    private void MyEventHandler(object sender, EventArgs e)
    {
        raised = true
    }
} 
```

但这会更改`raised`为类范围的字段，而不是本地范围的变量。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T21:54:59.893

> 具体来说，我如何在没有 lambda 表达式的情况下编写它，以便可以更新引发的局部变量？

您将创建一个额外的类来保存*捕获的变量*。这就是 C# 编译器所做的。额外的类将包含一个带有 lambda 表达式主体的方法，并且该`EventRaised`方法将创建该捕获类的一个*实例*，使用该实例中的变量而不是“真正的”局部变量。

在不使用事件的情况下演示这一点是最简单的 - 只是一个小型控制台应用程序。这是带有 lambda 表达式的版本：

```
using System;

class Test
{
    static void Main()
    {
        int x = 10;
        Action increment = () => x++;

        increment();
        increment();
        Console.WriteLine(x); // 12
    }
} 
```

这里的代码类似于编译器生成的代码：

```
using System;

class Test
{
    private class CapturingClass
    {
        public int x;

        public void Execute()
        {
            x++;
        }
    }

    static void Main()
    {
        CapturingClass capture = new CapturingClass();
        capture.x = 10;
        Action increment = capture.Execute;

        increment();
        increment();
        Console.WriteLine(capture.x); // 12
    }
} 
```

当然，它可能会*比*这复杂得多，特别是如果您有多个具有不同范围的捕获变量 - 但如果您能理解上述工作原理，那是重要的第一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T21:58:44.647

编译器生成这样的类，它具有带有 lambda 委托签名的方法。所有捕获的局部变量都移至此类字段：

```
public sealed class c_0
{
    public bool raised;

    public void m_1(object s, EventArgs e)
    {
       // lambda body goes here
       raised = true;
    }
} 
```

最后的编译器技巧是用`raised`生成类的这个字段替换局部变量的用法：

```
[TestClass]
public class MyEventClassTest
{
    [TestMethod]
    public void EventRaised()
    {
        c_0 generated = new c_0();
        generated.raised = false;

        var subject = new MyEventClass();
        subject.MyEvent += generated.m_1;

        subject.MethodThatRaisesMyEvent();

        Assert.IsTrue(generated.raised);
    }
} 
```

# java - java源代码压缩器？

> ID：13635421
> 
> 赞同：7
> 
> 时间：2012-11-29T21:52:35.873
> 
> 标签：java, minify

是否有用于缩小 Java 源代码的工具？

我知道对这样的工具没有太多实际需求，但我有兴趣将一些学生的代码简化为“基本”，以展示他们的变量名是如何被解释的（有点——它将完全重新执行编译器会忽略他们对变量名的选择）。（这个教学过程的下一步可能是向他们展示编译后的代码）。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T21:54:20.323

在 java 世界中，由于混淆的目的，我们主要谈论混淆（即使在我看来对应用程序文件大小的影响可能很有用，几年前我在 Android 应用程序上使用了很多）。

最好的 java 混淆器可能是[Progard](http://proguard.sourceforge.net/)。像所有这些一样，它可以将所有（非导出的）类和/或变量名简化为一个字母，这是混淆的一部分，也是缩小的一部分。

如果你想显示一些 java.util ，你必须在之后[反编译字节码。](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files)

# windows - Git 从 index.lock 重命名为 index 失败

> ID：13635429
> 
> 赞同：62
> 
> 时间：2012-11-29T21:53:07.450
> 
> 标签：windows, git, windows-7, github

使用 GitHub Windows 客户端，我进行了*同步*以将远程更改拉到本地计算机，但在完成同步之前，我的磁盘空间不足并且同步失败。现在我似乎有一堆本地更改，这些更改实际上是从原点提取的更改。我试图运行 git pull 但得到：

```
C:\Users\Tom\SourceLog [master +4 ~26 -0 !]> git pull
Updating b3a86e1..5afd74f
error: Your local changes to the following files would be overwritten by merge:
        SourceLog.Interface/IChangedFile.cs
        SourceLog.Interface/ILogEntry.cs
        ...
Please, commit your changes or stash them before you can merge.
error: The following untracked working tree files would be overwritten by merge:
        Lib/MSBuildExtensionPack/4.0.6.0/Ionic.Zip.dll
        Lib/MSBuildExtensionPack/4.0.6.0/MSBuild.ExtensionPack.dll
        ...
Aborting 
```

所以现在我试图放弃本地更改，但我得到：

```
C:\Users\Tom\SourceLog [master +4 ~26 -0 !]> git checkout -- .
Rename from '.git/index.lock' to '.git/index' failed. Should I try again? (y/n) y
Rename from '.git/index.lock' to '.git/index' failed. Should I try again? (y/n) n
fatal: unable to write new index file 
```

我怎样才能清理这个？（在开始同步之前我没有任何本地更改。）

## 更新

好像不能重置头。。

```
C:\Users\Tom\SourceLog [master +4 ~0 -0 !]> git reset head
Rename from '.git/index.lock' to '.git/index' failed. Should I try again? (y/n) y
Rename from '.git/index.lock' to '.git/index' failed. Should I try again? (y/n) n
error: Could not write new index file.
fatal: Could not reset index file to revision 'head'. 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-29T22:41:37.053

看起来以下进程锁定了`.git\index`文件：

```
ssh-agent.exe
C:\Users\Tom\AppData\Local\GitHub\PortableGit_8810fd5c2c79c73adcc73fd0825f3b32fdb816e7\bin\ssh-agent.exe 
```

我终止了进程并运行`git reset HEAD`，看起来我现在恢复正常了。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2017-03-30T02:25:15.707

就我而言，这是由于在管理员和非管理员命令提示符下使用相同的 Git 存储库造成的。last`git pull`来自 admin cmd 时，`index`是由它创建的，然后非 admin cmd 没有足够的权限对​​其进行修改。

我的解决方案是重新创建`index`（同时保持工作树完好无损）：

```
del .git\index
del .git\index.lock
git reset --mixed head 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2020-04-25T23:32:59.360

就我而言，我必须**关闭**从**WSL** Ubuntu 终端打开的**VS 代码。**`code .`

 *** * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-12-03T09:55:18.083

这可能是一个真正的问题，请尝试以管理员身份而不是用户身份运行您的终端。为我工作

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-07-12T11:15:11.613

`Rename from '.git/index.lock'...`我在尝试执行时看到此消息

`git checkout -b my-branch`

对我来说，解决方法是将命令行作为`admin`.

具体来说，我以非管理员身份使用出色的[cmder应用程序，导致出现重命名消息。](https://github.com/cmderdev/cmder)通过以管理员身份运行[cmder](https://github.com/cmderdev/cmder)，然后再次执行结帐，它工作正常。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-08-26T06:17:32.300

Git 2.10（2016 年第三季度，4 年后）应该会改善 Windows 上的情况

请参阅[Ben Wijen (](https://github.com/bwijen) [)的](https://github.com/bwijen)[提交 05d1ed6](https://github.com/git/git/commit/05d1ed6148305d299693000856e4971e9f642662)（2016 年 8 月 23 日） 。[`Ben`](https://github.com/bwijen)

> ## `mingw`: 确保临时文件句柄不被子进程继承
> 
> 当索引被锁定并且子进程继承了所述锁的句柄并且父进程想要​​在子进程退出之前移除锁时，在Windows上会出现一个问题：它不会工作，因为如果进程持有则无法删除文件处理它们。
> 
> 症状：

```
Rename from 'xxx/.git/index.lock' to 'xxx/.git/index' failed.
Should I try again? (y/n) 
```

> 生成子进程`bInheritHandles==FALSE`将不起作用，因为不会继承任何文件句柄，甚至不会继承(stdin/stdout/stderr)中的`hStdXxx`句柄。`STARTUPINFO`
> 
> 打开每个文件`O_NOINHERIT`也不起作用，例如`git-upload-pack`期望继承的文件句柄。
> 
> 这给我们留下了唯一的出路：创建带有`O_NOINHERIT`标志的临时文件。但是，此标志是特定于 Windows 的。
> 出于我们的目的，它等价于`O_CLOEXEC`（在 Windows 上不存在），所以[让我们打开带有标志的临时文件并将该`O_CLOEXEC`](https://github.com/git/git/blob/05d1ed6148305d299693000856e4971e9f642662/tempfile.c#L117-L128)标志 [映射](https://github.com/git/git/blob/05d1ed6148305d299693000856e4971e9f642662/tempfile.c#L117-L128)[到`O_NOINHERIT`Windows 上](https://github.com/git/git/blob/05d1ed6148305d299693000856e4971e9f642662/compat/mingw.h#L70-L72)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-29T22:01:52.907

要放弃本地更改，请转到

```
git reset HEAD 
```

然后检查你的旧提交，删除新提交，然后再次拉取。

```
git checkout "hashOld"
git branch -d "hashNew"
git pull 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-01-29T13:29:51.817

对我来说这是这个错误：

`Rename from 'D:/dev/repo/.git/refs/remotes/origin/my-branch.lock' to 'D:/dev/repo/.git/refs/remotes/origin/my-branch' failed. Should I try again? (y/n)`

重命名“my-branch”文件，重试，“my-branch.lock”重命名成功，不确定这是否正确，但有效。保留了 master 和 my-branch 中的本地更改。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-10-18T19:11:16.320

我删除`index`和`index.lock`（在`.git`文件夹中）并运行`git checkout .`以撤消更改并解决，但如果我想提交更改，我会在`git add -A`之后运行`git commit -m "description"`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-10-25T13:03:17.873

在存储在 Google Drive 文件夹中的项目中运行时，我连续多次收到此错误`git reset HEAD`，但几分钟后问题就消失了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-03-12T17:30:59.480

我遇到了这个问题，想为未来的搜索者发布答案。仅 Windows 确认。当我的 git 存储库位于需要提升权限的目录下时，我得到了这个，并且我从一个无权写入该文件夹的进程（cmd.exe）运行 git，因此它无法清除锁定。

答案很简单，以管理员身份运行。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-05-20T08:01:08.273

我已经在一个类似的问题上回答了这个问题。也可以帮助其他人，在这里引用相同的内容：

“如果任何 Windows 用户偶然发现了这一点：

我遇到了同样的问题，因为我分配了所有权限，所以权限并没有解决它。删除 index.lock 也没有帮助。

我尝试使用 WSL 并显示此错误：

> 另一个 git 进程似乎正在此存储库中运行。

基于此，我退出了 VS Code（即我正在使用的 IDE）运行的每个进程，然后一切恢复正常。

注意：仅仅关闭 VS Code 并没有帮助，必须从任务资源管理器中结束所有进程。

更重要的是，尝试结束您使用 git 的所有进程。对我来说，这只是 VS Code。”

原始答案：[https ://stackoverflow.com/a/67615831/13404308](https://stackoverflow.com/a/67615831/13404308)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-13T20:26:35.243

我对 Git 也有类似的问题。我的解决方案是通过Windows资源管理器在本地删除解决方案，然后重新克隆存储库。这删除了本地存储在我的机器上的所有文件，并导致

```
Rename from '.git/..' to '.git/..' failed. Should I try again? (y/n) y 
```

离开。克隆存储库后，我再次尝试了我的命令（在我的情况下是 GIT COMMIT）并且失败没有再次发生。

当我试图解决将功能分支合并到开发分支后发生的合并冲突时，问题就出现了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-01-12T18:50:13.680

杀死锁定文件的进程，或者如果它是一个新的 repo，删除 .git 文件夹`rm -rf .git`并重新开始`git init`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-12-22T15:54:22.103

这是在运行防病毒软件或 OS Defender（例如 Windows Defender）时引起的。解决方案：关闭杀毒软件几分钟让你添加、提交和推送。打开防病毒软件。
它会起作用的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-02-26T05:28:52.550

我正在使用乌龟 Git。我刚刚打开了一个新的 Windows 资源管理器，它解决了这个问题。（对于命令行 Git 可能只是打开一个新的 shell）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-26T07:25:11.640

当我用 master 重新设置我的分支时，我似乎遇到了问题。我的解决方案是关闭所有正在打开的解决方案，并将我的分支硬重置为原点并再次变基。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-03-06T07:23:10.940

`git init`解决了我的问题。我遇到了以下问题。

`Rename from '.git/objects/pack/pack-XXXXX.pack' to '.git/objects/pack/old-XXXXX.pack' failed. Should I try again? (y/n)`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-07-17T08:27:18.440

我更改项目权限

[![在此处输入图像描述](../Images/5802eaaca978f5db862f2fcbcc8745f4.png)](https://i.stack.imgur.com/bQWrh.png)

然后，我退出代码编辑器

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-07-22T22:02:17.493

就我而言，我`git pull`以管理员身份完成了操作，而我的普通用户不再拥有足够的权限。

我的解决方案是将所有权重置为我的普通用户。

1.  右键单击**.git**，然后打开***Properties***。
2.  在***安全***选项卡上，单击***高级***。
3.  在***Advanced Security Settings的******Owner***旁边，单击***Change***（即使它已经正确）。
4.  在***Select User***中，选择普通用户，然后单击***Okay***。
5.  在***Security***选项卡的***Owner***下，您现在有一个***Replace owner of subcontainers and objects***复选框 - 选中此项并单击***Okay***。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-12-18T22:29:48.280

我尝试了很多建议。有时，提交会成功，但随后会返回错误。最后，暂停 Dropbox 同步似乎成功了！我不知道 Dropbox 同步如何导致此错误超过几分钟（同步我的 24K 所需的时间`.git/index`）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2022-01-04T19:58:27.803

就我而言，它只是打开了 Windows 资源管理器，它正在打开我想要重命名的目录上方的目录。关闭 Windows 资源管理器后，问题立即消失。

我以管理员身份使用 Bash Git。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2021-05-30T21:10:45.547

我将（在 Windows 10 中）整个项目复制到一个新文件夹中。从那里推到原点（当时没有发出索引问题）。然后我又回到了项目目录，问题就出现在这里。删除 .git 目录。重新初始化（git init）。添加到索引 (git add . )。从远程来源获取并合并。这里的所有都是它的。**

# javascript - 如何使 HTML 5 的地理位置不太准确？

> ID：13635431
> 
> 赞同：0
> 
> 时间：2012-11-29T21:53:11.663
> 
> 标签：javascript, html

我目前正在使用 html 5 的地理位置功能。一切正常，这是一个很好的功能。但是，这听起来可能违反直觉，我希望它获得的位置不太准确。

目前，它正在获取我的确切位置，并且由于数据隐私，我不想要这个。有没有办法让它不那么准确？

我目前正在尝试创建一个名为 getRandomGeoValue 的函数，如下所示：

```
function getRandomGeoValue(geoValue)
{

} 
```

该函数采用地理值（纬度或经度）并返回随机不准确的地理值。我正在尝试使用 Javascripts Math.random() 函数，但结果太不准确了。

理想情况下，误差约为 17 英里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:00:30.800

您可以获取当前位置（可能是纬度和经度）并对其应用几种转换之一：

1.  将其四舍五入到最近的 10 英里（或您想要的任何精度级别）
2.  将每个纬度和经度值四舍五入到最接近的 10 秒（或您想要的任何精度级别）
3.  向纬度和经度添加一个随机值，使其 +/- 5 英里（或您想要的任何精度级别）。

如果您的纬度/经度值以度为单位，那么您可以使用此函数将其四舍五入到最接近的 N 英里：

```
function roundPosition(lat, lon, roundMiles) {
    // 69.11 miles per degree of latitude
    var roundFactor = 69.11 / roundMiles;
    lat = Math.round(lat * roundFactor) / roundFactor;

    // miles in 1 degree of longitude = 69.11 * cos(latitude in radians)
    var latRadians = (lat / 180) * Math.PI;
    var milesPerDegreeLong = 69.11 * Math.cos(latRadians);
    roundFactor = milesPerDegreeLong / roundMiles;
    lon = Math.round(lon * roundFactor) / roundFactor;
    return({latitude: lat, longitude: lon});
} 
```

此函数返回一个对象，该对象具有新的四舍五入的纬度和经度作为属性。

示例用法：

```
var latitude = 69.2;
var longitude = 180.9;
var newPos = roundPosition(latitude, longitude, 17);
// newPos.latitude and newPos.longitude contain the new rounded values 
```

# excel - 从命令行创建 Excel 文件

> ID：13635434
> 
> 赞同：7
> 
> 时间：2012-11-29T21:53:20.327
> 
> 标签：excel, command, excel-2007

有没有办法从命令行创建一个新的 Excel 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T23:29:31.010

如果您需要创建的 Excel 文件始终相同，您可以手动创建模板，然后随意创建新文件，例如...

```
copy template.xlsx myNewSpreadsheet.xlsx 
```

如果您需要创建内容不同的文件，我建议从 David 提出的 powershell 解决方案开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T23:19:17.120

您可以使用 PowerShell 执行此操作：

```
PS> $excel = New-Object -ComObject "Excel.Application"
PS> $wb = $excel.Workbooks.Add()
PS> $ws = $wb.ActiveSheet
PS> $excel.Visible = $True

       < do some work >

PS> $wb.SaveAs("xltest.xlsx")
PS> $wb.Close()
PS> $excel.Quit() 
```

# git - Git'合并'，但在同一分支中指定远程/本地/基础提交

> ID：13635440
> 
> 赞同：3
> 
> 时间：2012-11-29T21:53:29.903
> 
> 标签：git, merge

我的难题是这个。我团队的一名成员修改了供应商组件。然后将该组件升级到当前版本，覆盖我团队的更改。

我的队友对有问题的部分进行了重大更改，但升级添加的更改很少。我所拥有的是：

```
---component version 1.0----team change A---team change B---component version 2.0
        (stock)                                              (result of upgrade) 
```

我想要的是像这样进行合并：

```
 ----team change A---team change B
         /                                 \
---component version 1.0                    successful 'merge'
        (stock)                            /
         \------------component version 2.0
                       (result of upgrade) 
```

基本原理是，如果我们可以看到供应商从 to 更改，我们的更改 from to 和合并这两组更改，那么应用团队更改`component version 1.0`会`component version 2.0`更`component version 1.0`容易`team change B`。

据我了解，这样做的唯一方法是将分支重置为`team change B`，从中签出一个新分支并将和`component version 1.0`之间的差异应用为补丁，合并创建的分支并提交解决方案。`component version 1.0``component version 2.0`

我希望有一种方法可以基本上模拟合并`git merge --BASE='component version 1.0' --LOCAL='team change B' --REMOTE='component version 2.0'`，这样我就可以使用合并解析工具来确定生成的文件的样子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T03:47:44.893

如果您不想重置分支（也许它已发布到共享存储库并且您不希望人们不得不处理强制更新），您可以简单地将升级恢复到版本 2.0，重新执行在 1.0 版导入的分支上升级到 2.0 版，然后合并该分支。

例如（假设您的分支已被调用`master`并且`master`当前已签出）：

```
# create a commit that is the opposite of HEAD, effectively undoing it
git revert HEAD^
# create a new branch based on the original vendor import
git checkout -b vendor <sha1-of-vendor-1.0-commit>
# import the vendor 2.0 code
git read-tree -u --reset master^
git commit -m "vendor 2.0 code"
# merge in the new vendor code
git checkout master
git merge vendor 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:18:16.170

你应该可以这样做（假设`master`是你的分支的名称，它可能不是）：

```
git checkout master
git reset --hard <SHA of team change B>
git checkout -b vendor-upgrade <SHA of component version 1.0>
# replace contents of working directory with component version 2.0
git add <everything that needs to be added>
git commit -m "component version 2.0"
git checkout master
git merge vendor-upgrade 
```

根据团队变更的性质，您可能需要处理一些合并冲突，这取决于您是`vendor-upgrade`在完成后删除分支还是将其留在那里等待不可避免的 3.0 版本发布。 ..

# javascript - Ajax 在之前尽快请求，或者文档也准备好了吗？

> ID：13635445
> 
> 赞同：7
> 
> 时间：2012-11-29T21:53:48.247
> 
> 标签：javascript, jquery, ajax, optimization

我正在优化一个页面，但我无法区分这些结果之间的差异（第一个显然更快，但我不确定它是否会稍微减慢页面的渲染速度）：

这将尽快启动请求，并在文档就绪时修改 DOM：

```
<script>
$.ajax({
    url: '/some-url',
    success: function() {
        $(document).ready(function() {
            // do something
        });
    }
});
</script>
</body> 
```

这将在准备好文件时开始请求：

```
<script>
$(document).ready(function() {
    $.ajax({
        url: '/some-url',
        success: function() {
            // do something
        }
    });
});
</script>
</body> 
```

推荐哪一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T22:01:56.667

这里的最佳实践是尽快启动*Ajax 请求，但仅在文档准备好 (* *DOMContentLoaded* )时才开始修改 DOM 。为此，您可以使用与 jQuerys 扩展的*jXHR对象连接的 jQuerys* *Deferred*对象。

 *```
<script>
    var req      = $.ajax({}),
        docReady = jQuery.Deferred();

    $(function() {
        docReady.resolve();
    });

    $.when( req, docReady ).done(function( data ) {
        // read the returned data and modify the DOM
    });
</script> 
```

在 DOM 准备好之前等待开始请求是浪费时间。XHR 请求对 DOM 发生的事情没有任何业务和兴趣。

* * *

将这两件事完全解耦更有意义。如果由于某种原因 DOM 需要很长时间才能准备好，您不会浪费时间让*HTTP 请求*运行并收集其数据。反过来，如果*请求*很慢，你也会浪费时间。所以你当前的片段就像

```
DOM ready    
           -> XHR request    
                          -> Do something useful 
```

而我的例子就像

```
DOM ready    
XHR request
            -> Do something useful as soon as the DOM and request are ready 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:46:36.293

由于`$.ajax`不以任何方式依赖 DOM，所以没有理由不能尽快调用它。在这种情况下，我会将它放在该`<head>`部分中，并在其依赖的脚本/脚本文件完成后立即调用它（至少是 jQuery 库）。更快地触发 AJAX 请求意味着响应能够更快地返回 - 它可能不会实际发生，但这并不重要。

检查以确保 DOM 在内部准备就绪`success`对您来说是必要的，这是执行代码的最快方式。使用`$.when( req ).done(function () {})`会创建另外 2 个 jQuery 方法调用，它们可能会或可能不会显着延迟`success`代码的执行——它会延迟它，但它可能是微不足道的。

此外，您在方法中使用的示例`document.ready`创建`success`了DOM 已准备好并可以立即执行的**可能性**（如果 AJAX 请求在 DOM 完全加载之前完成，这是我不期望的）。在 jAndy 的示例中，它`document.ready`立即运行`$.ajax`，它**保证**它将为准备好的文档绑定一个事件处理程序......这意味着它必须被存储（导致 DOM 稍后准备好），然后在事件发生时稍后查找，并执行。同样，区别在于**可能性**与**保证**……而且一切都可能微不足道（只要您不使用第二个示例）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-29T22:08:34.987

在这个简单的示例中，两个版本都应该这样做。哪个更好取决于您的页面和其他脚本。如果您的脚本稍微复杂一点，并且您需要将数据传递给必须从页面获取的 ajax-request，并且您的页面此时尚未准备好 - 您将遇到错误。

另一件事是，您页面上的任何脚本都会在处理它时阻塞浏览器，因此更复杂的代码没有 doc-ready 可能会导致页面渲染过程中的短暂停止。在大多数情况下，我更喜欢让浏览器加载所有 HTML、CSS 和 JS——然后开始我的渐进式增强和加载附加内容。

但同样——在这个简单的例子中——我看不出有什么不同。*

# saxparser - 在 Marklogic 5 中加载大型非本地文件

> ID：13635446
> 
> 赞同：0
> 
> 时间：2012-11-29T21:53:49.567
> 
> 标签：saxparser, marklogic

我有一个非常大的文件，它与 Marklogic 服务器不在同一个盒子上。将文件放在同一台服务器上不是一种选择。

将文件加载到数据库中的最佳方法是什么？我认为`SAX`解析器可以挑选节点并将它们加载到数据库中。

```
<a>
  <b>xxx</b>
  <b>yyy</b>
  <b>zzz</b>
</a> 
```

因此，使用上面的 xml，我将在 Marklogic 中创建一个包含 . 然后，使用`SAX`解析器，我会抓取第一个`<b>`元素并将其作为`<a>`. 我会重复所有剩余的`<b>`元素。

这听起来像是最好的方法吗？它会表现出色吗？

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T23:40:37.937

正如 Eric 所指出的，一份大文档可能不是您想要的。MarkLogic 设计用于处理许多（数千到数十亿）一口大小（数十到数百千字节）的文档。如果您熟悉关系数据库，您可以将关系行（而不是表）大致等同于 MarkLogic 数据库中的文档。

你能提供更多关于你想要做什么的细节吗？您希望执行哪些类型的查询？您的数据实际上是什么样的？“非常大”有多大？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:17:19.247

首先，一旦您在 MarkLogic 中拥有所有数据，您就不太可能将所有数据都放在一个 Document 中。

您可以使用 mlcp 之类的工具来帮助您分解文档并加载它。请参阅[http://developer.marklogic.com/products/mlcp](http://developer.marklogic.com/products/mlcp)以及[http://docs.marklogic.com/guide/ingestion ，尤其是](http://docs.marklogic.com/guide/ingestion)[http:](http://docs.marklogic.com/guide/ingestion/content-pump) //docs.marklogic 上有关 mlcp（内容泵）的部分。 [com/guide/摄取/内容泵](http://docs.marklogic.com/guide/ingestion/content-pump)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T22:52:37.230

您可能会发现 xmlsh 的 StAX 脚本功能对您很有用。这类似于 SAX 解析，但更容易处理，因为它是 PULL 而非 PUSH 技术，因此没有回调。而且它完全可编写脚本的代码比纯 Java 少得多，同时速度几乎一样快。

[http://www.xmlsh.org/FunctionsStAX](http://www.xmlsh.org/FunctionsStAX)

-大卫

# algorithm - 在具有不同概率的范围内生成随机数

> ID：13635448
> 
> 赞同：8
> 
> 时间：2012-11-29T21:53:55.337
> 
> 标签：algorithm, math, random, probability

如何在 A = 1 和 B = 10 之间生成一个随机数，其中每个数字都有不同的概率？

示例：数字/概率

1 - 20%

2 - 20%

3 - 10%

4 - 5%

5 - 5%

...等等。

我知道一些硬编码的变通办法，不幸的是这些变通办法对更大的范围没有用，例如 A = 1000 和 B = 100000。

假设我们有一个

```
 Rand() 
```

返回随机数 R, 0 < R < 1 的方法，任何人都可以使用正确的方法发布代码示例吗？在 c#/java/actionscript 中可取。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:54:33.037

构建一个包含 100 个整数的数组，并用 20 个 1、20 个 2、10 个 3、5 个 4、5 个 5 等填充它。然后从数组中随机选择一个项目。

```
int[] numbers = new int[100];
// populate the first 20 with the value '1'
for (int i = 0; i < 20; ++i)
{
    numbers[i] = 1;
}
// populate the rest of the array as desired.

// To get an item:
// Since your Rand() function returns 0 < R < 1
int ix = (int)(Rand() * 100);
int num = numbers[ix]; 
```

如果项目的数量相当少并且您的精度不是太严格，则此方法效果很好。也就是说，如果你想要 4.375% 的 7，那么你需要一个更大的数组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-30T00:03:39.743

Knuth 将一个优雅的算法归功于 AJ Walker（Electronics Letters 10, 8 (1974), 127-128；ACM Trans. Math Software 3 (1977), 253-256）。

这个想法是，如果你总共有 n 个不同颜色的 k * n 个球，那么可以将这些球分布在 n 个容器中，这样容器号就可以了。i 包含颜色 i 和最多一种其他颜色的球。证明是对 n 的归纳。对于感应步骤，选择球数最少的颜色。

在您的示例中，n = 10。将概率与合适的 m 相乘，使它们都是整数。所以，也许 m = 100，你有 20 个颜色为 0 的球，20 个颜色为 1 的球，10 个颜色为 2 的球，5 个颜色为 3 的球，等等。所以，k = 10。

现在生成一个维度为 n 的表格，其中每个条目是概率（颜色 i 与另一种颜色的球的比率）和另一种颜色。

要生成一个随机球，请在 [0, n) 范围内生成一个随机浮点数 r。令 i 为整数部分（r 的下限），x 为多余部分（r - i）。

```
if (x < table[i].probability) output i
else output table[i].other 
```

该算法的优势在于，对于每个随机球，您只需进行一次比较。

让我举一个例子（与 Knuth 相同）。

考虑模拟掷一对骰子。

所以 P(2) = 1/36, P(3) = 2/36, P(4) = 3/36, P(5) = 4/36, P(6) = 5/36, P(7) = 6/36, P(8) = 5/36, P(9) = 4/36, P(10) = 3/36, P(11) = 2/36, P(12) = 1/36。

乘以 36 * 11 得到 393 个球，11 个颜色 2，22 个颜色 3，33 个颜色 4，……，11 个颜色 12。我们有 k = 393 / 11 = 36。

表[2] = (11/36, 颜色 4)

表[12] = (11/36, 颜色 10)

表[3] =（22/36，颜色 5）

表[11] = (22/36, 颜色 5)

表[4] =（8/36，颜色 9）

表[10] = (8/36, 颜色 6)

表[5] =（16/36，颜色 6）

表[9] =（16/36，颜色 8）

表[6] =（7/36，颜色 8）

表[8] =（6/36，颜色 7）

表[7] = (36/36, 颜色 7)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T22:07:41.567

假设您有一个函数`p(n)`可以为您提供所需的随机数概率：

```
r = rand()  // a random number between 0 and 1
for i in A to B do
    if r < p(i) 
      return i
    r = r - p(i)    
done 
```

更快的方法是创建一个 (B - A) * 100 个元素的数组，并用从 A 到 B 的数字填充它，这样数组中出现的每个项目的数量与数组大小的比率就是它的概率。然后，您可以生成一个统一的随机数以获取数组的索引并直接访问该数组以获取您的随机数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T22:06:58.590

根据概率将您的统一随机结果映射到所需的输出。

例如，对于您的示例：

```
If `0 <= Round() <= 0.2`: result = 1.
If `0.2 < Round() <= 0.4`: result = 2.
If `0.4 < Round() <= 0.5`: result = 3.
If `0.5 < Round() <= 0.55`: result = 4.
If `0.55 < Round() <= 0.65`: result = 5.
... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-29T18:29:40.503

这是[Knuth 算法](http://www.geeksforgeeks.org/random-number-generator-in-arbitrary-probability-distribution-fashion/)的一个实现。正如一些答案所讨论的那样，它的工作原理是 1）创建一个总频率表 2）生成一个随机整数 3）用上限函数对其进行四舍五入 4）找到随机数落入的“总和”范围并输出原始数组实体基于它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T05:38:42.243

**逆变换**

在概率论中，累积分布函数 F(x) 返回任意随机抽取的值（称为 X）<= 某个给定值 x 的概率。例如，如果我在这种情况下做 F(4)，我会得到 0.6。因为您的示例中概率的运行总和是`{.2, .4, .5, .55, .6, .65, ....}`. 即随机得到一个小于或等于 4 的值的概率是 0.6。然而，我真正想知道的是累积概率函数的*倒数*，称之为F_inv。我想知道给定累积概率的 x 值是多少。我想传入 F_inv(.6) 并返回 4。这就是为什么这被称为逆变换方法。

因此，在逆变换方法中，我们基本上是试图在累积分布中找到随机均匀 (0,1) 数落在其中的区间。这适用于 perreal 和 icepack 发布的算法。这是用累积分布函数表示它的另一种方式

```
Generate a random number U
for x in A .. B
   if U <= F(x) then return x 
```

请注意，如果较小的概率出现在分布的开头，则让循环从 B 到 A 并检查 U >= F(x) 可能更有效

# mysql - MySQL 创建临时表错误

> ID：13635450
> 
> 赞同：2
> 
> 时间：2012-11-29T21:53:57.070
> 
> 标签：mysql, easyphp

我正在使用 MySQL 5.5.27-log 运行 EasyPHP 5.4.6。

当我尝试使用以下内容创建临时表时：

```
CREATE TEMPORARY TABLE temp_table (x int); 
```

我收到以下错误：

```
ERROR 1005 (HY000): Can't create table 'temp_table' (errno: 22) 
```

但是，如果我删除“临时”，它会起作用。

临时表的语法是从示例页面逐字复制的。我尝试用谷歌搜索错误号，但没有产生任何我可以使用的东西。

谁能想到会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:29:48.063

errno: 22 表示 MySQL 正在尝试访问具有无效路径 (fopen -> INVAL) 的文件。MySQL 不太可能生成无效路径，因此请检查您的临时路径是否设置正确。如果您在 MySQL 配置中有自定义设置 tmpdir，请确保它是有效路径。`SHOW VARIABLES LIKE '%tmp%'`如果不是，请使用;检查当前值 如果某些内容不正确或缺失，请检查系统的 TEMP 环境变量是否设置正确。有关更多信息，请查看[http://dev.mysql.com/doc/refman/5.5/en/temporary-files.html](http://dev.mysql.com/doc/refman/5.5/en/temporary-files.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:15:43.047

确保您使用的用户已`create_tmp_table_priv`授予权限（`user`数据库表`mysql`）

# vb.net - 表单不等待线程完成并挂起我的应用程序

> ID：13635463
> 
> 赞同：-1
> 
> 时间：2012-11-29T21:54:59.493
> 
> 标签：vb.net, multithreading, backgroundworker, background-process

这是我的应用程序，您可以看到 3 个按钮，启用开始按钮、禁用暂停和禁用停止。

![在此处输入图像描述](../Images/6e7d96e66e4d0abd80b2d2b853d30633.png)

问题是我的表单中有一个单独的线程来创建一个“进程”（并在黑色富文本框中打印信息），我的意图是可以暂停或停止它，但是当我启动线程时，暂停按钮和停止按钮在一秒钟内将启用变为禁用。

我可以告诉表单在使用**_WaitHandle_FirstThreadDone.WaitOne()**启动线程后等待，然后我可以看到启用了暂停和停止按钮，但问题是我的应用程序挂起，直到“进程”完成..所以我不能按任何按钮。

拜托，我需要帮助才能做到这一点...

我的表格的重要部分：

```
Public Class Form1

#Region "Append text function"

    ' Append Text
    Public Sub AppendText(box As RichTextBox, color As Color, text As String)

        Control.CheckForIllegalCrossThreadCalls = False

        Dim start As Integer = box.TextLength
        box.AppendText(text)
        Dim [end] As Integer = box.TextLength

        ' Textbox may transform chars, so (end-start) != text.Length
        box.[Select](start, [end] - start)
        If True Then
            box.SelectionColor = color
            ' could set box.SelectionBackColor, box.SelectionFont too.
        End If
        box.SelectionLength = 0
        ' clear
    End Sub

#End Region

#Region "Thread"

    Public _WaitHandle_FirstThreadDone As New System.Threading.AutoResetEvent(False)

    Public Sub ThreadProc(ByVal aDir As DirectoryInfo)

        Dim aFile As FileInfo

        For Each aFile In aDir.GetFiles()

            If accepted_extensions.ToLower.Contains(aFile.Extension.ToLower) Then

                ' print output
                AppendText(consolebox, Color.Yellow, "Processing: ")
                AppendText(consolebox, Color.White, aFile.ToString() + vbNewLine)
                consolebox.ScrollToCaret()
                processedfiles += 1
                totalfiles_label.Text = "Processed " + processedfiles.ToString() + " of " + totalfiles.ToString() + " total video files"

                ' MEDIAINFO:  (ac3, dts, wav and multitrack)
                If ac3 = True Or dts = True Or wav = True Or multitrack = True Then

                    MI.Open(aFile.FullName)

                    Dim Pos As Integer = 0
                    To_Display = Nothing

                    While Pos < MI.Count_Get(StreamKind.Audio)

                        ' AC-3
                        If ac3 = True Then
                            If MI.Get_(StreamKind.Audio, Pos, "Format").ToString() = "AC-3" Then
                                results_box.AppendText("AC3 Track: " + aFile.FullName.ToString() + vbNewLine)
                                results_box.SelectionStart = results_box.Text.Length
                                results_box.ScrollToCaret()
                                problems += 1
                                problems_label.Text = problems.ToString() + " problems found"
                            End If
                        End If

                        System.Math.Max(System.Threading.Interlocked.Increment(Pos), Pos - 1)
                    End While
                End If
            End If
        Next

        _WaitHandle_FirstThreadDone.Set()
    End Sub

#End Region

#Region "Organize function"

    Public Sub MediaInfo(Directory)
        Dim MyDirectory As DirectoryInfo
        MyDirectory = New DirectoryInfo(NameOfDirectory)
        MediaInfoWorkWithDirectory(MyDirectory)
    End Sub

    Public Sub MediaInfoWorkWithDirectory(ByVal aDir As DirectoryInfo)
        Dim nextDir As DirectoryInfo
        Dim t As New Threading.Thread(AddressOf ThreadProc)
        t.Start(aDir)
        '
        For Each nextDir In aDir.GetDirectories
            If playlist = True Then
                Using writer As StreamWriter = New StreamWriter(aDir.FullName & "\" & nextDir.Name & "\" & nextDir.Name & ".m3u", False, System.Text.Encoding.UTF8)
                    'overwrite existing playlist
                End Using
            End If
            MediaInfoWorkWithDirectory(nextDir)
        Next
    End Sub

#End Region

#Region "Action buttons"

    ' start button
    Public Sub Button2_Click(sender As Object, e As EventArgs) Handles start_button.Click

                consolebox.Clear()

                ' pause / cancel button ON
                start_button.Enabled = False
                pause_button.Enabled = True
                cancel_button.Enabled = True

                ' Organization process
                NameOfDirectory = userSelectedFolderPath
                MediaInfo(NameOfDirectory)
                '  _WaitHandle_FirstThreadDone.WaitOne()
                consolebox.AppendText(vbNewLine + "[+] Organization finalized!" + vbNewLine)
                consolebox.Refresh()
                consolebox.SelectionStart = consolebox.Text.Length
                consolebox.ScrollToCaret()

                ' pause / cancel button OFF
                start_button.Enabled = True
                pause_button.Enabled = False
                cancel_button.Enabled = False

    End Sub

#End Region

    Private Sub pause_button_Click(sender As Object, e As EventArgs) Handles pause_button.Click
        paused = True
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T05:49:03.567

应用程序挂起的原因是程序正在按顺序爆破数据。您应该在循环的部分内添加一个 if 语句，以检查处理之间的暂停条件。像您一样将开/关控件放在子例程中并不是一个好主意，因为它只能在所有操作完成后启用按钮。

IE停止进程

```
对于 i 到 10 做
如果 checkbox1.checked = True then Exit Sub '检查停止条件
'处理视频
环形

```

要暂停它，您可以实现停止，但让它记住在恢复时从哪里开始。

还有，为什么你有死亡的面孔？那东西会杀死脑细胞。

# mysql - 基于另一个表中不存在而从一个表中删除记录

> ID：13635469
> 
> 赞同：0
> 
> 时间：2012-11-29T21:55:22.873
> 
> 标签：mysql

我有两个包含成员数据的表 - ' `members`' 和 ' `member_data`'。由于某种原因（我继承了这个），该`member_data`表的记录多于该`members`表。两个表都有一个`member_id`似乎与两个表之间的用户信息匹配的列。

`member_data`如果在 ' ' 表中找不到匹配项，我想从 ' ' 表`member_id`中删除记录`members`。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:59:27.593

您可以尝试使用`NOT IN`语句：

```
DELETE FROM `member_data`
WHERE `member_data`.`member_id`
NOT IN (
   SELECT `members`.`member_id`
   FROM `members`
); 
```

无论如何，您应该更正插入或不删除意外行的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:00:19.663

```
delete from member_data where member_id not in (select member_id from members); 
```

此查询将从 member_data 表中删除成员表中不存在的所有记录。

# java - JProfiler - [n 类] 是什么意思？

> ID：13635473
> 
> 赞同：2
> 
> 时间：2012-11-29T21:55:42.087
> 
> 标签：java, performance, spring, singleton, jprofiler

这是我在分析应用程序时在 Jprofiler 的内存视图中看到的内容。有什么意义

> [2 类] 。

我期望这个类是一个单例并且只有一个实例。我有什么不同的理解吗？

```
com.xxx.yyy.dao.impl.MyDAOImpl$$FastClassByCGLIB$$7574275c {[2 classes] 4 instances 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T21:59:03.850

可能是您在使用不同类加载器的环境中工作。在这种情况下，每次由“新”类加载器加载的某个类请求单例时，都会创建一个新的类实例和一个新的单例对象实例。然而，如果分析器说 2 个类实例有 4 个实例，则意味着您没有单例，而是 2 个单例。

# oracle - 如何创建用户输入的查询搜索

> ID：13635481
> 
> 赞同：0
> 
> 时间：2012-11-29T21:55:56.580
> 
> 标签：oracle, sqlplus

我正在尝试创建一个生成工具租金的报告，因为它需要是交互式的，我希望用户能够输入工具的部分名称或全名以显示该工具的所有租金。

```
TTITLE CENTER ==================== SKIP 1-
CENTER 'U  T O O L' skip 1-
CENTER ==================== SKIP 1 - 
LEFT 'Rental Report ' SKIP 1 -
LEFT ============ SKIP 2-
RIGHT 'Page:' -
FORMAT 999 SQL.PNO SKIP 2 

set pagesize 50

column MEMBERNAME HEADING 'Member Name'  format a20
column TOTAL HEADING 'Total Cost' format L9,999.99

compute sum label 'Total Cost: ' of TOTAL on MEMBERNAME
Break on Rental_ID on Member_ID on MEMBERNAME on Member_ID on Tel SKIP 1

select Member.Member_ID, SUBSTR(Member.FName,0,10) || SUBSTR(' ',0,10) ||
SUBSTR(Member.SName,0,15) as MEMBERNAME, Member.Tel,
Rental.Rental_ID,
Tool.Name, 
Rental.DateOut,
Rental.DateIn,
Rental_Line.Qty,
Rental_Line.Price,
Rental_Line.Qty*Rental_Line.Price as TOTAL
from Rental_Line
INNER JOIN Rental
on Rental.Rental_ID = Rental_Line.Rental_ID
INNER JOIN Member
on Rental.Member_ID = Member.Member_ID
INNER JOIN Tool_Instance
on Rental_Line.Tool_Instance_ID = Tool_Instance.Tool_Instance_ID
INNER JOIN Tool
on Tool_Instance.Tool_ID = Tool.Tool_ID
where Tool.Name = '%&_%'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:03:19.730

您可以创建一个接收参数的存储过程，例如：

```
CREATE PROCEDURE rentalReport(toolName IN varchar)
AS
--your query here
where Tool.Name = toolName 
```

不确定确切的语法，没有使用过 Oracle db ..

更多信息： http: [//www.ics.com/files/docs/dx/tut6.html](http://www.ics.com/files/docs/dx/tut6.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T01:37:11.283

您应该使用[`ACCEPT`](http://docs.oracle.com/cd/B19306_01/server.102/b14357/ch12005.htm#sthref1777)命令 - 它使用户能够与您的脚本进行交互。像这样：

```
09:26:55 SYSTEM@dwal> create table t (key number primary key, value varchar2(10));

Table created.

09:27:15 SYSTEM@dwal> insert into t values (1, 'abcdef');

1 row created.

09:27:20 SYSTEM@dwal> insert into t values (2, 'ghijkl');

1 row created.

09:27:32 SYSTEM@dwal> commit;

Commit complete.

09:28:48 SYSTEM@dwal> accept search_str char prompt "enter parameter > ";
enter parameter > def
09:30:01 SYSTEM@dwal> select * from t where value like '%&search_str.%';

       KEY VALUE
---------- ----------
         1 abcdef 
```

# mysql - MySQL，PHP 内连接并在不同的表格中显示结果 html

> ID：13635489
> 
> 赞同：0
> 
> 时间：2012-11-29T21:56:24.257
> 
> 标签：mysql, sql

我有一个小问题。我在数据库中有两个表：

```
[place]                        [client]

id     country                 id     name     id_place
--------------                 ------------------------
1      Canada                  1      Mike     1
2      USA                     2      Susan    1
3      China                   3      Juan     3
                               4      Nelly    2
                               5      Kevin    3 
```

使用 SQL 查询：

```
SELECT 
    place.country, cliente.name 
FROM 
    place, client 
INNER JOIN 
    client ON place.id = client.id_place 
```

我使用以下方法显示结果：

```
while ($list = mysql_fetch_array($query))
{
     echo $list['contry']." | ".$list['name'];
} 
```

结果是：

```
Canada | Mike
Canada | Susan
USA    | Nelly
China  | Juan
China  | Kevin 
```

到现在为止还挺好。我的问题是我想显示结果如下：

```
<h1> Canada: <h1>
<h3> -Mike <h3>
<h3> -Susan <h3>

<h1> USA: <h1>
<h3> -Nelly <h3>

<h1> China: <h1>
<h3> -Juan <h3>
<h3> -Kevin <h3> 
```

我怎么能做到这一点？请帮助我...谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:01:01.220

这应该有效：

```
$h1 = NULL;

while ( $list = mysql_fetch_array($query) ) {
    if($h1 <> $list['contry']) {
        echo "<h1>" . $list['contry'] . ":</h1>\n";

        $h1 = $list['country'];
    }

    echo "<h3>- " . $list['name'] . "</h3>\n";
} 
```

`$h1`被初始化为`NULL`。当循环开始时，它检查是否`$h1`等于`$list['country']`. 如果不是，它将输出国家/地区的标头并将它们设置为等效，以免重复。

您还应该停止使用`mysql_`函数，因为它们已[被弃用](http://www.deprecatedphp.com/mysql)并使用`mysqli_`or`PDO`代替。

# ruby-on-rails - 只要我在请求结束时清除它，在rails中创建一个类实例变量就“线程安全”？

> ID：13635494
> 
> 赞同：0
> 
> 时间：2012-11-29T21:56:36.837
> 
> 标签：ruby-on-rails, ruby

只要我在请求结束时清除它，存储类级别实例不变（即 MyClass.foo）是否被认为是“线程安全的”？例如在 before_filter 中设置值并在 after_filter 中清除它？

我的理解是，如果我不清除它......它将存在于我不想要的未来请求中。但如果我设置它并清除它.. 够好吗？或者两个请求是否会重叠并导致冲突和数据变异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:11:18.063

这可能是一个非常糟糕的主意，因为它可能会在请求和会话之间泄露信息。如果您需要一个线程安全的短期缓存，您可以随时将方法添加到`request`为您创建的对象上。

如果您试图将会话信息下推到模型的全局上下文中，那么您将违反 MVC 设计模式。模型需要的任何信息都应该以明确定义的方式传递，特别是因为这使得测试数量级更简单、更可靠。

# facebook - 通知中经过 Facebook 身份验证的推荐的 redirect_uri 是什么

> ID：13635496
> 
> 赞同：1
> 
> 时间：2012-11-29T21:56:55.353
> 
> 标签：facebook, facebook-graph-api, referrals

为了交换从 Facebook 身份验证推荐接收的代码，/oauth/access_token 需要一个 redirect_uri 参数。

在大多数情况下，在 code= 参数之前处理所有内容似乎是可行的。但这似乎不适用于来自通知的经过身份验证的推荐。网址如下所示：

?ref=noti&code=abc...&fb_source=notification&request_ids=123...&app_request_type=user_to_user

我已经尝试了查询字符串参数的每种组合，但似乎没有任何方法可以将代码交换为令牌。

这个的redirect_uri是什么？

# vb.net - vb.net 重新着色

> ID：13635499
> 
> 赞同：-2
> 
> 时间：2012-11-29T21:57:12.023
> 
> 标签：vb.net, colors, picturebox

我想知道如何在我的项目中更正此功能，

我的计划是

让我的 picBox2 变成位图

从中获取 RGB 像素

然后把它放回一个新的位图之后我可以使用这个函数来转换我的图像的颜色

我是这样写的：

```
 For row = 1 To 300
        For col = 1 To 300
            'MsgBox(row, MsgBoxStyle.YesNo + MsgBoxStyle.Question, "DEBUGSHIT")

            PixelColor = BitMapforRGB.GetPixel(row, col)
            PixelColor = BitMapforRGB.GetPixel(row, col)

            R = (PixelColor.R + vsbRed.Value) * 0.5
            G = (PixelColor.G + vsbGreen.Value) * 0.5
            B = (PixelColor.B + vsbBlue.Value) * 0.5

            Dim newColor As New Color
            newColor = Color.FromArgb(R, G, B)

            RGBtoBitmap.SetPixel(row, col, newColor)

        Next
    Next

    'I try to change it to 
    'Dim MyShade As Color = ColorTranslator.FromOle(
    '   RGB(Red(row,col),Green(row,col),Blue(row,col))
    'but it seem not right.

    Dim reColor As New Bitmap(Me.pixBox2.Image)
    pixBox2.Image = reColor
End Sub 
```

ps：这个错误是Parameter must be positive and < Height.

参数名称：y

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T05:56:52.650

您应该从 0 迭代到图像的大小。即 0 到`BitMapforRGB.Width-1`for `col`。

# c# - 通过约定/反射动态连接视图、模型和演示者

> ID：13635503
> 
> 赞同：2
> 
> 时间：2012-11-29T21:57:22.977
> 
> 标签：c#, reflection, mvp

我正在尝试使用 MVP 模式开发应用程序。

问题是手动连接所有代码。我希望减少所需的代码。我试图复制另一个解决方案，但我无法开始工作。我正在使用 Winforms，而我用作源的解决方案正在使用 WPF。

它会根据一些约定进行连接：

> *视图事件按名称连接。例如：视图上的“Loaded”事件将连接到演示器上的“OnLoaded()”方法按钮命令按名称连接。例如：MoveNext”按钮被连接到“OnMoveNext()”方法。网格双击被连接到名称。例如：双击“Actions”将被连接到“OnActionsChoosen(ToDoAction)”*

WPF中的工作代码是：

```
 private static void WireListBoxesDoubleClick(IPresenter presenter)
    {
        var presenterType = presenter.GetType();
        var methodsAndListBoxes = from method in GetActionMethods(presenterType)
                                  where method.Name.EndsWith("Choosen")
                                  where method.GetParameters().Length == 1
                                  let elementName = method.Name.Substring(2, method.Name.Length - 2 /*On*/- 7 /*Choosen*/)
                                  let matchingListBox = LogicalTreeHelper.FindLogicalNode(presenter.View, elementName) as ListBox
                                  where matchingListBox != null
                                  select new {method, matchingListBox};

        foreach (var methodAndEvent in methodsAndListBoxes)
        {
            var parameterType = methodAndEvent.method.GetParameters()[0].ParameterType;
            var action = Delegate.CreateDelegate(typeof(Action<>).MakeGenericType(parameterType),
                                                 presenter, methodAndEvent.method);

            methodAndEvent.matchingListBox.MouseDoubleClick += (sender, args) =>
            {
                var item1 = ((ListBox)sender).SelectedItem;
                if(item1 == null)
                    return;
                action.DynamicInvoke(item1);
            };
        }   
    }

    private static void WireEvents(IPresenter presenter)
    {
        var viewType = presenter.View.GetType();
        var presenterType = presenter.GetType();
        var methodsAndEvents =
                from method in GetParameterlessActionMethods(presenterType)
                let matchingEvent = viewType.GetEvent(method.Name.Substring(2))
                where matchingEvent != null
                where matchingEvent.EventHandlerType == typeof(RoutedEventHandler)
                select new { method, matchingEvent };

        foreach (var methodAndEvent in methodsAndEvents)
        {
            var action = (Action)Delegate.CreateDelegate(typeof(Action),
                                                          presenter, methodAndEvent.method);

            var handler = (RoutedEventHandler)((sender, args) => action());
            methodAndEvent.matchingEvent.AddEventHandler(presenter.View, handler);
        }
    }

    private static IEnumerable<MethodInfo> GetActionMethods(Type type)
    {
        return from method in type.GetMethods(BindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.Instance)
               where method.Name.StartsWith("On")
               select method;
    }

    private static IEnumerable<MethodInfo> GetParameterlessActionMethods(Type type)
    {
        return from method in GetActionMethods(type)
               where method.GetParameters().Length == 0
               select method;
    } 
```

无论如何，我尝试将其移植到 WinForm 应用程序，但没有成功。我将 更改`RoutedEventHandlers`为`EventHandlers`，但找不到如何处理`LogicalTreeHelper`。

我有点坚持这一点。我可以手动完成，但我发现这个迷你框架非常天真，几乎疯了。

PS：来源是[http://msdn.microsoft.com/en-us/magazine/ee819139.aspx](http://msdn.microsoft.com/en-us/magazine/ee819139.aspx)

**编辑**

我才意识到一件事。我没有变笨，上面的代码对测试不太友好，是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:07:26.983

好的。我自己弄好了。我只是发布答案，因为至少另一个人觉得有趣。

一、观点

```
public interface IBaseView
{
    void Show();
    C Get<C>(string controlName) where C : Control; //Needed to later wire the events
}

public interface IView : IBaseView
{
    TextBox ClientId { get; set; } //Need to expose this
    Button SaveClient { get; set; }
    ListBox MyLittleList { get; set; }
}

public partial class View : Form, IView
{
    public TextBox ClientId //since I'm exposing it, my "concrete view" the controls are camelCased
    {
        get { return this.clientId; }
        set { this.clientId = value; }
    }

    public Button SaveClient
    {
        get { return this.saveClient; }
        set { this.saveClient = value; }
    }

    public ListBox MyLittleList
    {
        get { return this.myLittleList; }
        set { this.myLittleList = value; }
    }

    //The view must also return the control to be wired.
    public C Get<C>(string ControlName) where C : Control
    {
        var controlName = ControlName.ToLower();
        var underlyingControlName = controlName[0] + ControlName.Substring(1);
        var underlyingControl = this.Controls.Find(underlyingControlName, true).FirstOrDefault();
        //It is strange because is turning PascalCase to camelCase. Could've used _Control for the controls on the concrete view instead
        return underlyingControl as C;
    } 
```

现在主持人：

```
public class Presenter : BasePresenter <ViewModel, View>
{
    Client client;
    IView view;
    ViewModel viewModel;

    public Presenter(int clientId, IView viewParam, ViewModel viewModelParam)
    {
        this.view = viewParam;
        this.viewModel = viewModelParam;

        client = viewModel.FindById(clientId);
        BindData(client);
        wireEventsTo(view); //Implement on the base class
    }

    public void OnSaveClient(object sender, EventArgs e)
    {
        viewModel.Save(client);
    }

    public void OnEnter(object sender, EventArgs e)
    {
        MessageBox.Show("It works!");
    }

    public void OnMyLittleListChanged(object sender, EventArgs e)
    {
        MessageBox.Show("Test");
    }
} 
```

“魔法”发生在基类。在wireEventsTo(IBaseView 视图)

```
public abstract class BasePresenter
    <VM, V>
    where VM : BaseViewModel
    where V : IBaseView, new()
{

    protected void wireEventsTo(IBaseView view)
    {
        Type presenterType = this.GetType();
        Type viewType = view.GetType();

        foreach (var method in presenterType.GetMethods())
        {
            var methodName = method.Name;

            if (methodName.StartsWith("On"))
            {
                try
                {
                    var presenterMethodName = methodName.Substring(2);
                    var nameOfMemberToMatch = presenterMethodName.Replace("Changed", ""); //ListBoxes wiring

                    var matchingMember = viewType.GetMember(nameOfMemberToMatch).FirstOrDefault();

                    if (matchingMember == null)
                    {
                        return;
                    }

                    if (matchingMember.MemberType == MemberTypes.Event)
                    {
                        wireMethod(view, matchingMember, method);    
                    }

                    if (matchingMember.MemberType == MemberTypes.Property)
                    {
                        wireMember(view, matchingMember, method);    
                    }

                }
                catch (Exception ex)
                {
                    continue;
                }
            }
        }
    }

    private void wireMember(IBaseView view, MemberInfo match, MethodInfo method)
    {
        var matchingMemberType = ((PropertyInfo)match).PropertyType;

        if (matchingMemberType == typeof(Button))
        {
            var matchingButton = view.Get<Button>(match.Name);

            var eventHandler = (EventHandler)EventHandler.CreateDelegate(typeof(EventHandler), this, method);

            matchingButton.Click += eventHandler;
        }

        if (matchingMemberType == typeof(ListBox))
        {
            var matchinListBox = view.Get<ListBox>(match.Name);

            var eventHandler = (EventHandler)EventHandler.CreateDelegate(typeof(EventHandler), this, method);

            matchinListBox.SelectedIndexChanged += eventHandler;
        }
    }

    private void wireMethod(IBaseView view, MemberInfo match, MethodInfo method)
    {
        var viewType = view.GetType();

        var matchingEvent = viewType.GetEvent(match.Name);

        if (matchingEvent != null)
        {
            if (matchingEvent.EventHandlerType == typeof(EventHandler))
            {
               var eventHandler = EventHandler.CreateDelegate(typeof(EventHandler), this, method);
               matchingEvent.AddEventHandler(view, eventHandler);
            }

            if (matchingEvent.EventHandlerType == typeof(FormClosedEventHandler))
            {
                var eventHandler = FormClosedEventHandler.CreateDelegate(typeof(FormClosedEventHandler), this, method);
                matchingEvent.AddEventHandler(view, eventHandler);
            }
        }
    }
} 
```

我已经在这里工作了。它会将 Presenter 上的 EventHandler 自动连接到 IView 上控件的默认事件。

另外，附带说明一下，我想分享 BindData 方法。

```
 protected void BindData(Client client)
    {
        string nameOfPropertyBeingReferenced; 

        nameOfPropertyBeingReferenced = MVP.Controller.GetPropertyName(() => client.Id);
        view.ClientId.BindTo(client, nameOfPropertyBeingReferenced);

        nameOfPropertyBeingReferenced = MVP.Controller.GetPropertyName(() => client.FullName);
        view.ClientName.BindTo(client, nameOfPropertyBeingReferenced);
    }

    public static void BindTo(this TextBox thisTextBox, object viewModelObject, string nameOfPropertyBeingReferenced)
    {
        Bind(viewModelObject, thisTextBox, nameOfPropertyBeingReferenced, "Text");
    }

    private static void Bind(object sourceObject, Control destinationControl, string sourceObjectMember, string destinationControlMember)
    {
        Binding binding = new Binding(destinationControlMember, sourceObject, sourceObjectMember, true, DataSourceUpdateMode.OnPropertyChanged);
        //Binding binding = new Binding(sourceObjectMember, sourceObject, destinationControlMember);
        destinationControl.DataBindings.Clear();
        destinationControl.DataBindings.Add(binding);
    }

    public static string GetPropertyName<T>(Expression<Func<T>> exp)
    {
        return (((MemberExpression)(exp.Body)).Member).Name;
    } 
```

这从绑定中消除了“魔术字符串”。我认为它也可以用于 INotificationPropertyChanged。

无论如何，我希望有人觉得它有用。如果您想指出代码异味，我完全可以。

# c# - 事件处理程序的匿名方法不是泄漏？

> ID：13635505
> 
> 赞同：4
> 
> 时间：2012-11-29T21:57:35.340
> 
> 标签：c#, .net

每当您将委托添加到事件处理程序时，您应该稍后将其删除，对吗？因此，如果您将匿名方法附加到事件，这是否会导致事件处理程序泄漏，因为您以后无法删除它？[这个来自http://msdn.microsoft.com/en-us/library/0yw3tz5k%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/0yw3tz5k%28VS.80%29.aspx)的代码示例似乎暗示这是一个不错的做法。

```
// Create a handler for a click event
button1.Click += delegate(System.Object o, System.EventArgs e)
                   { System.Windows.Forms.MessageBox.Show("Click!"); }; 
```

这真的是一个好的做法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T22:00:58.447

> 每当您将委托添加到事件处理程序时，您应该稍后将其删除，对吗？

不一定，不。通常，只要可以引发事件本身，您就希望事件处理程序保持有效——这在 UI 中当然很常见。

> 这真的是一个好的做法吗？

绝对可以，只要您*不需要*解开处理程序。想想你在什么时候解开事件处理程序。如果它是“当表单（或按钮或其他任何东西）可以进行垃圾收集时”，那么删除处理程序有什么好处？就让它用表格被垃圾收集......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T22:02:42.837

> 每当您将委托添加到事件处理程序时，您应该稍后将其删除，对吗？

好吧，并非*总是*如此。您想要删除要添加的事件处理程序的原因有两个：

1.  您不断地向同一个实例添加处理程序，但这些处理程序是短暂的。如果您没有删除它们，那么将添加越来越多的处理程序，而其中大多数都不需要。
2.  您的处理程序在内部保留对一个对象的引用，该对象的生命周期比事件所属的任何对象的生命周期短得多，并且一旦其他对象超出范围，事件处理程序将不会（或不能）被调用. 保留事件处理程序将强制它在内存中停留的时间比预期的要长，或者可能导致使用“陈旧”且不应再使用的对象。（例如，如果资源已被释放，您不希望再触发该事件。）

#2 是一个问题的原因是垃圾收集在 C# 中的工作方式。它将所有可以 100% 确定在范围内的对象标记为“活动”，然后将所有这些“活动”对象引用的所有对象都标记为“活动”，直到它遵循每个活动对象中的每个引用。任何从未被标记为“活着”的东西都被认为是“死的”并且有资格进行垃圾收集。

当您将事件处理程序附加到委托包含两件事的事件时，一个对象的实例和一个在该对象上运行的方法。该引用的对象将无法被垃圾收集，直到：

1.  带有事件的对象不再“活着”。
2.  您删除了事件处理程序（即对您的委托的引用），从而允许您的对象更早地被释放。

That said, a significant percentage of cases don't apply to either of those, so there's no need to bother removing the event handlers.

As an example, I often see people removing event handlers just before the event object goes out of scope. That's pointless. If the object is out of scope there's no problem with it holding onto references to...whatever.

Now, if you are in one of those few situations in which you do need to unsubscribe the event handler, and you're using an anonymous method you need to...not. Just create a class that can make it a named method and use that.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T22:01:48.643

使用匿名方法（或 lambda 表达式）订阅事件*可能*会导致内存泄漏，但在这种情况下不会。

在这种情况下，编译器将在当前类中生成一个匿名方法，并且只要您的按钮不会比您的对象寿命更长，您就不会遇到任何与内存相关的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-29T22:19:56.417

正如您所说，使用内联匿名委托作为事件处理程序确实可以防止删除这些处理程序。这确实会导致问题，特别是如果委托来自不同的对象。如果您有一个带有公共事件 E 的 A 类，并且 E 被一个附加匿名处理程序 H 的 B 类（与 A 没有包含/包含关系）订阅，则 H 在技术上是 B 的成员，因此只要正如它所提到的（通过附加到 A 的事件），B 不会被 GCed。B 的生命周期与 A 的生命周期相关，如果您不希望或不希望现在发生内存泄漏。

现在，这并不总是一个问题。如果 B 包含 A，或者相反，那么 A 和 B 的生命周期无论如何都已经绑定在一起了；在您的情况下，按钮本身很可能会在附加处理程序的包含控件之前被处理掉。类似地，A 和 B 可能是长期存在的对象（例如，程序的主窗体和数据存储库）并且在程序终止之前不会被 GC。只要您永远不必关心 A 和 B 之间的生命周期差异，*并且*您永远不需要将 H 与 E 分离以停止展示 H 的任何行为，那么您可以附加所有您喜欢的匿名处理程序。

# java - 处理许多传入数据包的最佳方法

> ID：13635510
> 
> 赞同：8
> 
> 时间：2012-11-29T21:58:07.183
> 
> 标签：java, multithreading, sockets

我目前正在开发一个简单的 P2P 网络作为练习。网络中的每个节点都向其他节点的子集发送心跳，以便能够检测到已离开网络的节点。除了心跳包之外，当新节点加入/离开网络时，当他们想要定位资源（小文本文件）等时，我会发送数据包。所有数据包都是 UDP 数据包。

每当我收到一个数据包时，我都会启动一个新线程来处理该特定数据包。然而，我担心我在一个应用程序生命周期中启动的线程数量加起来相当多（特别是因为心跳）。（还有我想避免的死锁等风险）。

我想过有一个队列或其他东西，我将所有传入的数据包放入其中，并让一个线程一次处理来自该队列的所有数据包（类似于生产者-消费者模式）。我希望快速处理数据包，这样发件人就不会认为数据包丢失了。

处理大量不同传入数据包而不必为每个数据包启动新线程的最佳方法是什么？我应该使用我所拥有的，生产者消费的还是不同的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:15:49.797

您的应用程序处理一个数据包需要多长时间？

对于 ping 的，在收到它们时处理它们可能会更快，您可以将其他的放在共享数据结构中，例如特定的阻塞队列，因此当队列为空时，工作线程等待新作业，当添加了一个新的工作，一个线程被唤醒并完成工作。

可能每个数据包启动一个线程会使您在启动和停止线程上花费比实际执行工作更多的时间。

如果对于所有类型的数据包来说，响应数据包的事情并不是那么耗时，那么可能是花费在队列锁和调度线程上的额外时间会使您的程序变慢而不是更快。

在任何情况下，使用线程池并从一开始就启动工作人员。如果您愿意，您可以根据过去几分钟的负载动态增加或减少工作线程的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:48:06.730

我会使用一个`event driven architecture`. 为每个数据包创建一个新线程是不可扩展的，因此这将适用于一定数量的工作负载，但有一点它不再适用。您可以将其与 Facebook 聊天等聊天程序进行比较，其中消息是数据包。事件驱动的架构将是可扩展的，恕我直言，这正是您所寻找的。只需进行一些谷歌搜索，那里有许多编程语言的库，所以只需为您选择合适的库（我喜欢在 Erlang、Scala、C 或 Python 中这样做）。

编辑：好的，没有看到java标签。但语言无关紧要。

看看这个链接，例如： [http ://www.nightmare.com/medusa/async_sockets.html](http://www.nightmare.com/medusa/async_sockets.html)

我发现了解事件驱动编程的想法非常好。

# printing - Zebra TLP 2844 打印机拒绝打印太多行

> ID：13635518
> 
> 赞同：0
> 
> 时间：2012-11-29T21:58:32.493
> 
> 标签：printing, zebra-printers, epl

我正在尝试在连续纸上打印一些长度可变的凭证。问题是打印机拒绝打印超过大约 2300 点（大约 26 厘米或 10.4 英寸）的任何东西，只是假装它不存在。非常轻的代码会触发问题，因此这不是缓冲区问题。打印机还设法读取“打印”命令，并且所有行的格式都完全相同，因此也不是格式问题。这是一个不太简单但几乎可以说明我观点的代码示例：

```
N //clear buffer
Q10,0 //set paper to continuous mode with 10 points between documents
R0,0 //set reference point 
ZT //print from top to bottom 
A100,50,0,1,1,2,N,"ASDFQWERTY 50"
A100,100,0,1,1,2,N,"ASDFQWERTY 100"
A100,150,0,1,1,2,N,"ASDFQWERTY 150"
A100,200,0,1,1,2,N,"ASDFQWERTY 200"
A100,250,0,1,1,2,N,"ASDFQWERTY 250"
A100,300,0,1,1,2,N,"ASDFQWERTY 300"
A100,350,0,1,1,2,N,"ASDFQWERTY 350"
A100,400,0,1,1,2,N,"ASDFQWERTY 400"
A100,450,0,1,1,2,N,"ASDFQWERTY 450"
A100,500,0,1,1,2,N,"ASDFQWERTY 500"
A100,550,0,1,1,2,N,"ASDFQWERTY 550"
A100,600,0,1,1,2,N,"ASDFQWERTY 600"
A100,650,0,1,1,2,N,"ASDFQWERTY 650"
A100,700,0,1,1,2,N,"ASDFQWERTY 700"
A100,750,0,1,1,2,N,"ASDFQWERTY 750"
A100,800,0,1,1,2,N,"ASDFQWERTY 800"
A100,850,0,1,1,2,N,"ASDFQWERTY 850"
A100,900,0,1,1,2,N,"ASDFQWERTY 900"
A100,950,0,1,1,2,N,"ASDFQWERTY 950"
A100,1000,0,1,1,2,N,"ASDFQWERTY 1000"
A100,1050,0,1,1,2,N,"ASDFQWERTY 1050"
A100,1100,0,1,1,2,N,"ASDFQWERTY 1100"
A100,1150,0,1,1,2,N,"ASDFQWERTY 1150"
A100,1200,0,1,1,2,N,"ASDFQWERTY 1200"
A100,1250,0,1,1,2,N,"ASDFQWERTY 1250"
A100,1300,0,1,1,2,N,"ASDFQWERTY 1300"
A100,1350,0,1,1,2,N,"ASDFQWERTY 1350"
A100,1400,0,1,1,2,N,"ASDFQWERTY 1400"
A100,1450,0,1,1,2,N,"ASDFQWERTY 1450"
A100,1500,0,1,1,2,N,"ASDFQWERTY 1500"
A100,1550,0,1,1,2,N,"ASDFQWERTY 1550"
A100,1600,0,1,1,2,N,"ASDFQWERTY 1600"
A100,1650,0,1,1,2,N,"ASDFQWERTY 1650"
A100,1700,0,1,1,2,N,"ASDFQWERTY 1700"
A100,1750,0,1,1,2,N,"ASDFQWERTY 1750"
A100,1800,0,1,1,2,N,"ASDFQWERTY 1800"
A100,1850,0,1,1,2,N,"ASDFQWERTY 1850"
A100,1900,0,1,1,2,N,"ASDFQWERTY 1900"
A100,1950,0,1,1,2,N,"ASDFQWERTY 1950"
A100,2000,0,1,1,2,N,"ASDFQWERTY 2000"
A100,2050,0,1,1,2,N,"ASDFQWERTY 2050"
A100,2100,0,1,1,2,N,"ASDFQWERTY 2100"
A100,2150,0,1,1,2,N,"ASDFQWERTY 2150"
A100,2200,0,1,1,2,N,"ASDFQWERTY 2200"
A100,2250,0,1,1,2,N,"ASDFQWERTY 2250"
A100,2300,0,1,1,2,N,"ASDFQWERTY 2300"
A100,2350,0,1,1,2,N,"ASDFQWERTY 2350"
A100,2400,0,1,1,2,N,"ASDFQWERTY 2400"
A100,2450,0,1,1,2,N,"ASDFQWERTY 2450"
A100,2500,0,1,1,2,N,"ASDFQWERTY 2500"
A100,2550,0,1,1,2,N,"ASDFQWERTY 2550"
A100,2600,0,1,1,2,N,"ASDFQWERTY 2600"
A100,2650,0,1,1,2,N,"ASDFQWERTY 2650"
A100,2700,0,1,1,2,N,"ASDFQWERTY 2700"
A100,2750,0,1,1,2,N,"ASDFQWERTY 2750"
A100,2800,0,1,1,2,N,"ASDFQWERTY 2800"
A100,2850,0,1,1,2,N,"ASDFQWERTY 2850"
A100,2900,0,1,1,2,N,"ASDFQWERTY 2900"
A100,2950,0,1,1,2,N,"ASDFQWERTY 2950"
A100,3000,0,1,1,2,N,"ASDFQWERTY 3000"
P1 
```

如 EPL2 手册 (http://www.zebra.com/content/dam/zebra/manuals/en-us/printer/epl2-pm-en.pdf) 中所述，第一个“N”之前有一个空行. 将命令发送到打印机时，我也不包括注释。但是，这只会打印到“ASDFQWERTY 2300”行并忽略除此之外的所有内容。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T21:33:59.073

从公司收到的支持电子邮件中回答自己。该打印机型号限制为 11 英寸，因此最后我不得不将文档拆分为多个请求。

# php - 在表单验证 jquery 更新 div

> ID：13635519
> 
> 赞同：2
> 
> 时间：2012-11-29T21:58:34.667
> 
> 标签：php, jquery, html, session

我正在尝试使用 jquery 进行登录。应该对文本字段进行验证以回显错误消息。如果表单已完全验证，则 jquery 中的函数应更新 div，其中有输入表单并将其更改为会话名称。但是有一个问题，当发布的表单被验证然后 div 保持为空，没有会话名称。

HTML：

```
<html>
<head>
<script type="text/javascript" src="jquery-1.8.3.min.js"></script>
<script type="text/javascript">
jQuery(function(){
    jQuery('#form').submit(function(){
        jQuery.ajax({
            type: 'POST',
            url: jQuery('#form').attr('action'),
            data: jQuery('#form').serialize(),
                success: function(data){
                    if(data == 'success'){ 
                        jQuery('#user').load(location.href+' #user>*');
                    }else{
                        jQuery('#info').html(data);
                    }                   
                }
        });
        return false;
    });
});
</script>
</head>
<body>
<div id="user">
<div id="info"></div>
<?php
session_start();
if(isset($_SESSION['user'])){
echo $_SESSION['user'];
}else{
echo '
<form method="post" action="session.php" id="form">
<input type="text" name="user" />
<input type="submit" name="do" value="ok" />
</form>
';
}
?>
</div>
</body>
</html> 
```

PHP：

```
<?php

$user = mysql_real_escape_string($_POST['user']);

if(empty($user)){
    echo 'psc';
}else{
    echo 'success';
    session_start();
        $_SESSION['user'] = $user;
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T23:30:04.280

我认为`type: 'POST'`在您的 ajax 调用中通常以小写形式完成：`type: 'post'`. 我不确定这是否是问题，但您可能想尝试一下。

除此之外，您的代码的另一个问题是您没有阻止提交表单。所以基本上你正在发送一个 ajax 消息，但随后会立即加载一个新页面，并在单击提交按钮时发生默认提交。我认为这具有加载空白页面的效果？

要解决此问题，您可以在`submit`处理程序中添加以下行：

```
jQuery('#form').submit(function(event){
   event.preventDefault(); 
```

请注意，我已将事件添加到处理程序参数，然后调用该`preventDefault()`方法以阻止表单实际提交。在处理程序中返回 false 不会为您执行此操作。

# php - 为什么这个使用 rand() 的 MySQL 查询大约有三分之一的时间没有返回结果？

> ID：13635520
> 
> 赞同：2
> 
> 时间：2012-11-29T21:58:41.033
> 
> 标签：php, mysql

我有一个**itemproperties**表，我想从中获取一个随机**itemproperty**，但是我希望它的随机性比其他 itemproperties 更倾向于某些**itemproperties**。

为了实现这一点，我设置了一个名为 rarity 的列**，**用于存储该项目应该显示的频率（更高 = 更频繁），以及一个名为**rarity_position**的列，它是使用以下查询配置的：

```
SET @i:=0;UPDATE itemproperty SET rarity_position = @i:=@i+rarity; 
```

这提供了以下结果：

![稀有结果](../Images/a011cea82c86b0161c2728813a40b0db.png)

然后抓取一个随机值，我想我会使用：

```
SELECT * FROM itemproperty 
WHERE id = (
        SELECT id 
        FROM itemproperty 
        WHERE rarity_position >= FLOOR
                (
                    RAND()*
                    (
                        SELECT MAX(rarity_position) FROM itemproperty
                    )
                )
        ORDER BY rarity_position 
        ASC LIMIT 1
) LIMIT 1 
```

为了选择具有最高 rarity_position 最大值的随机数，然后获取 rarity_position 刚好高于该值的 item 属性。

大多数情况下，这按预期工作，但大约三分之一的时间没有结果。

可能相关的服务器信息：

```
Software: MySQL
Software version: 5.0.95-log - MySQL Community Server (GPL)
Protocol version: 10
Server charset: UTF-8 Unicode (utf8) 
```

您可以使用此模型重现该行为：

```
create table itemproperty (
  id int, rarity int, rarity_position int
);
insert into itemproperty
values
  ( 1, 50, 50 ),
  ( 2, 50, 100 ),
  ( 3, 50, 150 ),
  ( 4, 50, 200 ),
  ( 5, 50, 250 ),
  ( 6, 50, 270 ),
  ( 7, 50, 320 ),
  ( 8, 50, 370 ),
  ( 9, 50, 420 ),
  ( 10, 50, 470 ),
  ( 11, 50, 520 )
; 
```

如果您尝试仅执行子查询，则每次都有效：

```
 SELECT id 
    FROM itemproperty 
    WHERE rarity_position >= FLOOR
            (
                RAND()*
                (
                    SELECT MAX(rarity_position) FROM itemproperty
                )
            )
    ORDER BY rarity_position 
    ASC LIMIT 1 
```

但是，如果您将其封装在：

```
SELECT * FROM itemproperty
WHERE id = (
 // here the above request
) LIMIT 1; 
```

它不会按预期工作。

是什么导致它每次都没有返回结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:16:21.013

```
SELECT *
FROM itemproperty 
ORDER BY RAND() * rarity DESC
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T04:06:45.333

找到了一个类似于 zerkms 方法的可行解决方案：

```
ORDER BY -LOG(1.0 – RAND()) / rarity 
```

[来源](http://www.kahunaburger.com/2008/10/13/selecting-random-weighted-records-from-mysql/#comment-42836 "来源")

值得注意的是，缺少的部分似乎与以下问题有关： [MySQL query with RAND() subquery condition](https://stackoverflow.com/questions/13363468/mysql-query-with-rand-subquery-condition)

我猜在 WHERE 中有 RAND() 会导致一些奇怪。

# mysql - 限制在子查询内

> ID：13635524
> 
> 赞同：3
> 
> 时间：2012-11-29T21:58:49.247
> 
> 标签：mysql, sql

我有一个可以包含主要消息以及子消息的消息表。我想要实现的只是获得前 2 个最近的子消息。

```
SELECT message.id, message.date_sent,message.object_id, message.content, 
       SubMessage1.content, SubMessage1.id, SubMessage1.date_sent,
       SubMessage2.content, SubMessage2.id, SubMessage2.date_sent
  FROM messages As Message 
  LEFT
 OUTER
  JOIN ( SELECT messages.object_id as object_id, messages.content as content,
                messages.id as id , messages.date_sent as date_sent
           FROM messages
          ORDER
             BY messages.date_sent ASC LIMIT 1,1
       ) as SubMessage1
    ON Message.id = SubMessage1.object_id
  LEFT
 OUTER
  JOIN ( SELECT messages.object_id as object_id, messages.content as content,
                messages.id as id , messages.date_sent as date_sent
           FROM messages
          ORDER
             BY messages.date_sent ASC LIMIT 2,1
       ) as SubMessage2
    ON Message.id = SubMessage2.object_id
 WHERE Message.id = 1 
```

当我删除限制时，我总是得到第一个结果。但是当我输入限制时，我得到空值。有任何想法吗？建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:41:50.613

这里的问题是`ORDER BY ... LIMIT ...`in 子查询在in 连接*之前*`ON Message.id = ... .object_id`应用。因此，连接只有机会检查*一条*消息并确定它是否是子消息。大多数时候，它不会，所以你会得到`NULL`价值。

要解决此问题，您需要将`ON`-clauses 的内容移动到`WHERE`子查询内的 -clauses 中。通常这会有点混乱，但是由于您只想检索单记录结果集，所以还不错：

```
SELECT message.id, message.date_sent, message.object_id, message.content, 
       SubMessage1.content, SubMessage1.id, SubMessage1.date_sent,
       SubMessage2.content, SubMessage2.id, SubMessage2.date_sent
  FROM messages AS Message 
  LEFT
 OUTER
  JOIN ( SELECT messages.object_id AS object_id, messages.content AS content,
                messages.id AS id, messages.date_sent AS date_sent
           FROM messages
          WHERE messages.object_id = 1
          ORDER
             BY messages.date_sent ASC LIMIT 1,1
       ) AS SubMessage1
    ON TRUE
  LEFT
 OUTER
  JOIN ( SELECT messages.object_id AS object_id, messages.content AS content,
                messages.id AS id, messages.date_sent AS date_sent
           FROM messages
          WHERE messages.object_id = 1
          ORDER
             BY messages.date_sent ASC LIMIT 2,1
       ) AS SubMessage2
    ON TRUE
 WHERE Message.id = 1
; 
```

（请注意，这在查询中包含三次参数：可能不太理想，但实际上不是问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:26:48.687

```
SELECT * FROM messages WHERE id = 1
Union all
SELECT * FROM messages WHERE object_id=1
ORDER BY date_sent ASC LIMIT 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:24:44.290

如果你想要 2 行，请使用

```
LIMIT 2 
```

在 SQL 领域，计数是从 1 而不是 0。

此外，在具有 2 个参数的 mysql LIMIT 中是：

```
LIMIT offset, row_count 
```

但是使用 1 个参数是：

```
LIMIT row_count 
```

我想见见那个决定像那样移动参数并踢他的裤子的天才。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-29T22:36:30.850

LIMIT 命令的起始索引为 0。您可能希望将限制更改为 (0, 1) 和 (1, 1)。

# windows-8 - 将 Windows.Storage.Streams.IRandomAccessStream 转换为 System.IO.Stream

> ID：13635525
> 
> 赞同：5
> 
> 时间：2012-11-29T21:58:52.230
> 
> 标签：windows-8, microsoft-metro

我怎样才能转换`Windows.Storage.Streams.IRandomAccessStream`为`System.IO.Stream`？

我正在使用一个接受`System.IO.Stream`作为输入的 C# 库，但是当我在 Metro 中打开文件时，我得到`Windows.Storage.Streams.IRandomAccessStream`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-30T02:42:48.473

最简单的方法是调用[`AsStream`](http://msdn.microsoft.com/en-us/library/system.io.windowsruntimestreamextensions.asstream.aspx).

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-29T22:18:11.200

您可以转换`Windows.Storage.Streams.IRandomAccessStream`为 a `byte[]`，然后再转换`byte[]`为`System.IO.Stream`.

**来自 IRandomAccessStream 的字节 []**

```
 var file = await new FileOpenPicker().PickSingleFileAsync();
        var fStream = await file.OpenAsync(FileAccessMode.Read);

        var reader = new DataReader(fStream.GetInputStreamAt(0));
        var bytes = new byte[fStream.Size];
        await reader.LoadAsync((uint)fStream.Size);
        reader.ReadBytes(bytes); 
```

**从字节流[]**

```
var stream = new MemoryStream(bytes); 
```

# python - 给定一组点 xi=(xi,yi) 在 Python 中拟合椭圆

> ID：13635528
> 
> 赞同：3
> 
> 时间：2012-11-29T21:59:20.890
> 
> 标签：python, geometry, ellipse

我正在从二维点（x，y）计算一系列索引。一个指标是短轴和长轴之间的比率。为了适合椭圆，我正在使用以下[帖子](http://nicky.vanforeest.com/misc/fitEllipse/fitEllipse.html#the-approach)

当我运行这些函数时，最终结果看起来很奇怪，因为中心和轴长度与 2D 点不成比例

```
center =  [  560415.53298363+0.j  6368878.84576771+0.j]
angle of rotation =  (-0.0528033467597-5.55111512313e-17j)
axes =  [0.00000000-557.21553487j  6817.76933256  +0.j] 
```

提前感谢您的帮助

```
import numpy as np
from numpy.linalg import eig, inv

def fitEllipse(x,y):
    x = x[:,np.newaxis]
    y = y[:,np.newaxis]
    D =  np.hstack((x*x, x*y, y*y, x, y, np.ones_like(x)))
    S = np.dot(D.T,D)
    C = np.zeros([6,6])
    C[0,2] = C[2,0] = 2; C[1,1] = -1
    E, V =  eig(np.dot(inv(S), C))
    n = np.argmax(np.abs(E))
    a = V[:,n]
    return a

def ellipse_center(a):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    num = b*b-a*c
    x0=(c*d-b*f)/num
    y0=(a*f-b*d)/num
    return np.array([x0,y0])

def ellipse_angle_of_rotation( a ):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    return 0.5*np.arctan(2*b/(a-c))

def ellipse_axis_length( a ):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    up = 2*(a*f*f+c*d*d+g*b*b-2*b*d*f-a*c*g)
    down1=(b*b-a*c)*( (c-a)*np.sqrt(1+4*b*b/((a-c)*(a-c)))-(c+a))
    down2=(b*b-a*c)*( (a-c)*np.sqrt(1+4*b*b/((a-c)*(a-c)))-(c+a))
    res1=np.sqrt(up/down1)
    res2=np.sqrt(up/down2)
    return np.array([res1, res2])

if __name__ == '__main__':

    points = [(560036.4495758876, 6362071.890493258),
     (560036.4495758876, 6362070.890493258),
     (560036.9495758876, 6362070.890493258),
     (560036.9495758876, 6362070.390493258),
     (560037.4495758876, 6362070.390493258),
     (560037.4495758876, 6362064.890493258),
     (560036.4495758876, 6362064.890493258),
     (560036.4495758876, 6362063.390493258),
     (560035.4495758876, 6362063.390493258),
     (560035.4495758876, 6362062.390493258),
     (560034.9495758876, 6362062.390493258),
     (560034.9495758876, 6362061.390493258),
     (560032.9495758876, 6362061.390493258),
     (560032.9495758876, 6362061.890493258),
     (560030.4495758876, 6362061.890493258),
     (560030.4495758876, 6362061.390493258),
     (560029.9495758876, 6362061.390493258),
     (560029.9495758876, 6362060.390493258),
     (560029.4495758876, 6362060.390493258),
     (560029.4495758876, 6362059.890493258),
     (560028.9495758876, 6362059.890493258),
     (560028.9495758876, 6362059.390493258),
     (560028.4495758876, 6362059.390493258),
     (560028.4495758876, 6362058.890493258),
     (560027.4495758876, 6362058.890493258),
     (560027.4495758876, 6362058.390493258),
     (560026.9495758876, 6362058.390493258),
     (560026.9495758876, 6362057.890493258),
     (560025.4495758876, 6362057.890493258),
     (560025.4495758876, 6362057.390493258),
     (560023.4495758876, 6362057.390493258),
     (560023.4495758876, 6362060.390493258),
     (560023.9495758876, 6362060.390493258),
     (560023.9495758876, 6362061.890493258),
     (560024.4495758876, 6362061.890493258),
     (560024.4495758876, 6362063.390493258),
     (560024.9495758876, 6362063.390493258),
     (560024.9495758876, 6362064.390493258),
     (560025.4495758876, 6362064.390493258),
     (560025.4495758876, 6362065.390493258),
     (560025.9495758876, 6362065.390493258),
     (560025.9495758876, 6362065.890493258),
     (560026.4495758876, 6362065.890493258),
     (560026.4495758876, 6362066.890493258),
     (560026.9495758876, 6362066.890493258),
     (560026.9495758876, 6362068.390493258),
     (560027.4495758876, 6362068.390493258),
     (560027.4495758876, 6362068.890493258),
     (560027.9495758876, 6362068.890493258),
     (560027.9495758876, 6362069.390493258),
     (560028.4495758876, 6362069.390493258),
     (560028.4495758876, 6362069.890493258),
     (560033.4495758876, 6362069.890493258),
     (560033.4495758876, 6362070.390493258),
     (560033.9495758876, 6362070.390493258),
     (560033.9495758876, 6362070.890493258),
     (560034.4495758876, 6362070.890493258),
     (560034.4495758876, 6362071.390493258),
     (560034.9495758876, 6362071.390493258),
     (560034.9495758876, 6362071.890493258),
     (560036.4495758876, 6362071.890493258)]

    a_points = np.array(points)
    x = a_points[:, 0]
    y = a_points[:, 1]
    from pylab import *
    plot(x,y)
    show()
    a = fitEllipse(x,y)
    center = ellipse_center(a)
    phi = ellipse_angle_of_rotation(a)
    axes = ellipse_axis_length(a)

    print "center = ",  center
    print "angle of rotation = ",  phi
    print "axes = ", axes

    from pylab import *
    plot(x,y)
    plot(center[0:1],center[1:], color = 'red')
    show() 
```

每个顶点是一个 xi,y,i 点 ![在此处输入图像描述](../Images/b74fd748efa6f604dccef8b0412b7002.png)

二维点和拟合椭圆中心的图 ![在此处输入图像描述](../Images/0e4ce8fe80d06398d440a92ea46e48a1.png)

使用 OpenCV 我有以下结果：

```
import cv

PointArray2D32f = cv.CreateMat(1, len(points), cv.CV_32FC2)
for (i, (x, y)) in enumerate(points):
    PointArray2D32f[0, i] = (x, y)
    # Fits ellipse to current contour.
   (center, size, angle) = cv.FitEllipse2(PointArray2D32f)

(center, size, angle) 
((560030.625, 6362066.5),(10.480490684509277, 17.20206642150879),144.34889221191406) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T23:01:48.687

的计算`fitEllipse`返回虚假结果，因为 和 的值`x`与`y`值之间的变化相比非常大。例如，如果您尝试打印出特征值`E`，您会看到

```
array([  0.00000000e+00 +0.00000000e+00j,
         0.00000000e+00 +0.00000000e+00j,
         0.00000000e+00 +0.00000000e+00j,
        -1.36159790e-12 +8.15049878e-12j,
        -1.36159790e-12 -8.15049878e-12j,   1.18685632e-11 +0.00000000e+00j]) 
```

它们几乎都是零！显然，这里存在某种数值上的不准确性。

您可以通过将数据的平均值移近零来解决此问题，以便这些值更“正常”大小并且数字之间的变化变得更加显着。

```
x = a_points[:, 0]
y = a_points[:, 1]
xmean = x.mean()
ymean = y.mean()
x = x-xmean
y = y-ymean 
```

然后可以成功找到中心、phi 和轴，然后将中心重新移回 (xmean, ymean)：

```
center = ellipse_center(a)
center[0] += xmean
center[1] += ymean 
```

* * *

```
import numpy as np
import numpy.linalg as linalg
import matplotlib.pyplot as plt

def fitEllipse(x,y):
    x = x[:,np.newaxis]
    y = y[:,np.newaxis]
    D =  np.hstack((x*x, x*y, y*y, x, y, np.ones_like(x)))
    S = np.dot(D.T,D)
    C = np.zeros([6,6])
    C[0,2] = C[2,0] = 2; C[1,1] = -1
    E, V =  linalg.eig(np.dot(linalg.inv(S), C))
    n = np.argmax(np.abs(E))
    a = V[:,n]
    return a

def ellipse_center(a):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    num = b*b-a*c
    x0=(c*d-b*f)/num
    y0=(a*f-b*d)/num
    return np.array([x0,y0])

def ellipse_angle_of_rotation( a ):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    return 0.5*np.arctan(2*b/(a-c))

def ellipse_axis_length( a ):
    b,c,d,f,g,a = a[1]/2, a[2], a[3]/2, a[4]/2, a[5], a[0]
    up = 2*(a*f*f+c*d*d+g*b*b-2*b*d*f-a*c*g)
    down1=(b*b-a*c)*( (c-a)*np.sqrt(1+4*b*b/((a-c)*(a-c)))-(c+a))
    down2=(b*b-a*c)*( (a-c)*np.sqrt(1+4*b*b/((a-c)*(a-c)))-(c+a))
    res1=np.sqrt(up/down1)
    res2=np.sqrt(up/down2)
    return np.array([res1, res2])

def find_ellipse(x, y):
    xmean = x.mean()
    ymean = y.mean()
    x -= xmean
    y -= ymean
    a = fitEllipse(x,y)
    center = ellipse_center(a)
    center[0] += xmean
    center[1] += ymean
    phi = ellipse_angle_of_rotation(a)
    axes = ellipse_axis_length(a)
    x += xmean
    y += ymean
    return center, phi, axes

if __name__ == '__main__':

    points = [(560036.4495758876, 6362071.890493258),
     (560036.4495758876, 6362070.890493258),
     (560036.9495758876, 6362070.890493258),
     (560036.9495758876, 6362070.390493258),
     (560037.4495758876, 6362070.390493258),
     (560037.4495758876, 6362064.890493258),
     (560036.4495758876, 6362064.890493258),
     (560036.4495758876, 6362063.390493258),
     (560035.4495758876, 6362063.390493258),
     (560035.4495758876, 6362062.390493258),
     (560034.9495758876, 6362062.390493258),
     (560034.9495758876, 6362061.390493258),
     (560032.9495758876, 6362061.390493258),
     (560032.9495758876, 6362061.890493258),
     (560030.4495758876, 6362061.890493258),
     (560030.4495758876, 6362061.390493258),
     (560029.9495758876, 6362061.390493258),
     (560029.9495758876, 6362060.390493258),
     (560029.4495758876, 6362060.390493258),
     (560029.4495758876, 6362059.890493258),
     (560028.9495758876, 6362059.890493258),
     (560028.9495758876, 6362059.390493258),
     (560028.4495758876, 6362059.390493258),
     (560028.4495758876, 6362058.890493258),
     (560027.4495758876, 6362058.890493258),
     (560027.4495758876, 6362058.390493258),
     (560026.9495758876, 6362058.390493258),
     (560026.9495758876, 6362057.890493258),
     (560025.4495758876, 6362057.890493258),
     (560025.4495758876, 6362057.390493258),
     (560023.4495758876, 6362057.390493258),
     (560023.4495758876, 6362060.390493258),
     (560023.9495758876, 6362060.390493258),
     (560023.9495758876, 6362061.890493258),
     (560024.4495758876, 6362061.890493258),
     (560024.4495758876, 6362063.390493258),
     (560024.9495758876, 6362063.390493258),
     (560024.9495758876, 6362064.390493258),
     (560025.4495758876, 6362064.390493258),
     (560025.4495758876, 6362065.390493258),
     (560025.9495758876, 6362065.390493258),
     (560025.9495758876, 6362065.890493258),
     (560026.4495758876, 6362065.890493258),
     (560026.4495758876, 6362066.890493258),
     (560026.9495758876, 6362066.890493258),
     (560026.9495758876, 6362068.390493258),
     (560027.4495758876, 6362068.390493258),
     (560027.4495758876, 6362068.890493258),
     (560027.9495758876, 6362068.890493258),
     (560027.9495758876, 6362069.390493258),
     (560028.4495758876, 6362069.390493258),
     (560028.4495758876, 6362069.890493258),
     (560033.4495758876, 6362069.890493258),
     (560033.4495758876, 6362070.390493258),
     (560033.9495758876, 6362070.390493258),
     (560033.9495758876, 6362070.890493258),
     (560034.4495758876, 6362070.890493258),
     (560034.4495758876, 6362071.390493258),
     (560034.9495758876, 6362071.390493258),
     (560034.9495758876, 6362071.890493258),
     (560036.4495758876, 6362071.890493258)]

    fig, axs = plt.subplots(2, 1, sharex = True, sharey = True)
    a_points = np.array(points)
    x = a_points[:, 0]
    y = a_points[:, 1]
    axs[0].plot(x,y)
    center, phi, axes = find_ellipse(x, y)
    print "center = ",  center
    print "angle of rotation = ",  phi
    print "axes = ", axes

    axs[1].plot(x, y)
    axs[1].scatter(center[0],center[1], color = 'red', s = 100)
    axs[1].set_xlim(x.min(), x.max())
    axs[1].set_ylim(y.min(), y.max())

    plt.show() 
```

![在此处输入图像描述](../Images/792768a9ab696af0ed283ab6116a0bd2.png)

# sql-server - 优化包含窗口函数的参数化 T-SQL 查询的执行计划

> ID：13635531
> 
> 赞同：20
> 
> 时间：2012-11-29T21:59:30.533
> 
> 标签：sql-server, tsql, sql-server-2008-r2, query-optimization

**编辑：我更新了示例代码并提供了完整的表和视图实现以供参考，但基本问题保持不变。**

我在尝试查询的数据库中有一个相当复杂的视图。当我尝试通过将 WHERE 子句硬编码为特定的外键值来从视图中检索一组行时，视图会以最佳执行计划（正确使用索引等）快速执行

```
SELECT * 
FROM dbo.ViewOnBaseTable
WHERE ForeignKeyCol = 20 
```

但是，当我尝试向查询添加参数时，我的执行计划突然分崩离析。当我运行下面的查询时，我得到的是索引扫描而不是到处搜索，而且查询性能很差。

```
DECLARE @ForeignKeyCol int = 20

SELECT * 
FROM dbo.ViewOnBaseTable
WHERE ForeignKeyCol = @ForeignKeyCol 
```

我正在使用 SQL Server 2008 R2。这里给出了什么？使用导致次优计划的参数是什么？任何帮助将不胜感激。

作为参考，这里是我收到错误的对象定义。

```
CREATE TABLE [dbo].[BaseTable]
(
    [PrimaryKeyCol] [uniqueidentifier] PRIMARY KEY,
    [ForeignKeyCol] [int] NULL,
    [DataCol] [binary](1000) NOT NULL
)

CREATE NONCLUSTERED INDEX [IX_BaseTable_ForeignKeyCol] ON [dbo].[BaseTable]
(
    [ForeignKeyCol] ASC
)

CREATE VIEW [dbo].[ViewOnBaseTable]
AS
SELECT
    PrimaryKeyCol,
    ForeignKeyCol,
    DENSE_RANK() OVER (PARTITION BY ForeignKeyCol ORDER BY PrimaryKeyCol) AS ForeignKeyRank,
    DataCol
FROM
    dbo.BaseTable 
```

我确信窗口函数是问题所在，但我正在通过窗口函数分区的单个值过滤我的查询，所以我希望优化器先过滤然后运行窗口函数。它在硬编码示例中执行此操作，但在参数化示例中不执行此操作。下面是两个查询计划。顶层规划好，底层规划差。

![查询执行计划](../Images/11eab71394c2060a7f8a58ea33f71275.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-08T21:55:56.213

使用时`OPTION (RECOMPILE)`请务必查看执行后（“实际”）计划，而不是执行前（“估计”）计划。一些优化仅在执行时应用：

```
DECLARE @ForeignKeyCol int = 20;

SELECT ForeignKeyCol, ForeignKeyRank
FROM dbo.ViewOnBaseTable
WHERE ForeignKeyCol = @ForeignKeyCol
OPTION (RECOMPILE); 
```

执行前计划：

![执行前计划](../Images/67000c6c9f808d7d66626fdd602368b3.png)

执行后计划：

![执行后计划](../Images/abf80512e9f4a3f2873cc90bf03818da.png)

在 SQL Server 2012 build 11.0.3339 和 SQL Server 2008 R2 build 10.50.4270 上测试

### 背景和限制

在 SQL Server 2005 中添加窗口函数时，优化器无法将选择推过这些新的序列投影。为了解决一些导致性能问题的常见场景，SQL Server 2008 添加了一个新的简化规则 ，`SelOnSeqPrj`它允许在值为常量的情况下推送合适的选择。此常量可能是查询文本中的文字，也可能是通过 获取的参数的嗅探值`OPTION (RECOMPILE)`。`NULLs`尽管查询可能需要`ANSI_NULLS OFF`看到这一点，但没有特别的问题。据我所知，仅将简化应用于常量值是实现限制；没有特别的原因不能将其扩展到使用变量。我的回忆是`SelOnSeqPrj`规则解决了最常见的性能问题。

### 参数化

*当查询成功*自动参数化`SelOnSeqPrj`时，不应用该规则。没有可靠的方法来确定查询是否在 SSMS 中自动参数化，它仅表示*尝试*了自动参数。需要明确的是，占位符 like 的存在仅表明尝试了自动参数化。判断一个准备好的计划是否被缓存以供重用的可靠方法是检查计划缓存，其中“参数化计划句柄”提供了临时计划和准备好的计划之间的链接。**`[@0]`**

 **例如，以下查询在 SSMS 中似乎是自动参数化的：

```
SELECT *
FROM dbo.ViewOnBaseTable
WHERE ForeignKeyCol = 20; 
```

但计划缓存显示不同：

```
WITH XMLNAMESPACES
(
    DEFAULT 'http://schemas.microsoft.com/sqlserver/2004/07/showplan'
)
SELECT
    parameterized_plan_handle =
        deqp.query_plan.value('(//StmtSimple)[1]/@ParameterizedPlanHandle', 'nvarchar(64)'), 
    parameterized_text =
        deqp.query_plan.value('(//StmtSimple)[1]/@ParameterizedText', 'nvarchar(max)'),
    decp.cacheobjtype,
    decp.objtype,
    decp.plan_handle
FROM sys.dm_exec_cached_plans AS decp
CROSS APPLY sys.dm_exec_sql_text(decp.plan_handle) AS dest
CROSS APPLY sys.dm_exec_query_plan(decp.plan_handle) AS deqp
WHERE
    dest.[text] LIKE N'%ViewOnBaseTable%'
    AND dest.[text] NOT LIKE N'%dm_exec_cached_plans%'; 
```

![即席计划缓存条目](../Images/7967fbab115bfaa80f4f7a184b63be76.png)

如果启用了强制参数化的数据库选项，我们会得到一个参数化结果，其中未应用优化：

```
ALTER DATABASE Sandpit SET PARAMETERIZATION FORCED;
DBCC FREEPROCCACHE;

SELECT *
FROM dbo.ViewOnBaseTable
WHERE ForeignKeyCol = 20; 
```

![强制参数化计划](../Images/40a5162e5b9c7ee1c9c3ea896e489a77.png)

计划缓存查询现在显示一个参数化缓存计划，由参数化计划句柄链接：

![参数化计划缓存](../Images/8d215f6fc790a1faa43b7afa9bbe9a52.png)

### 解决方法

在可能的情况下，我的偏好是将视图重写为内联表值函数，其中可以使选择的预期位置更加明确（如有必要）：

```
CREATE FUNCTION dbo.ParameterizedViewOnBaseTable
    (@ForeignKeyCol integer)
RETURNS TABLE
WITH SCHEMABINDING
AS
RETURN
    SELECT
        bt.PrimaryKeyCol,
        bt.ForeignKeyCol,
        ForeignKeyRank = DENSE_RANK() OVER (
            PARTITION BY bt.ForeignKeyCol 
            ORDER BY bt.PrimaryKeyCol),
        bt.DataCol
    FROM dbo.BaseTable AS bt
    WHERE
        bt.ForeignKeyCol = @ForeignKeyCol; 
```

查询变为：

```
DECLARE @ForeignKeyCol integer = 20;
SELECT pvobt.*
FROM dbo.ParameterizedViewOnBaseTable(@ForeignKeyCol) AS pvobt; 
```

执行计划：

![功能计划](../Images/8ce1cdbb91bc7c70490a719684f60643.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:49:13.970

您总是可以采用 CROSS APPLY 方式。

```
ALTER VIEW [dbo].[ViewOnBaseTable]
AS
SELECT
    PrimaryKeyCol,
    ForeignKeyCol,
    ForeignKeyRank,
    DataCol
FROM (
    SELECT DISTINCT
        ForeignKeyCol
    FROM dbo.BaseTable
) AS Src
CROSS APPLY (
    SELECT
        PrimaryKeyCol,
        DENSE_RANK() OVER (ORDER BY PrimaryKeyCol) AS ForeignKeyRank,
        DataCol
    FROM dbo.BaseTable AS B
    WHERE B.ForeignKeyCol = Src.ForeignKeyCol
) AS X 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-29T22:05:55.050

我认为在这种特殊情况下，这可能是因为您的参数和表之间的数据类型不完全匹配，因此 SQL Server 必须进行隐式转换，这不是一个 sargable 操作。

检查您的表数据类型并使您的参数类型相同。或者在查询之外自己做演员。**

# ios - 使用 Redis 构建 Django 活动提要

> ID：13635533
> 
> 赞同：1
> 
> 时间：2012-11-29T21:59:39.977
> 
> 标签：ios, django, json, redis, feed

如何使用 Django 和 Redis 构建活动提要？

示例：在我的 iOS 应用程序的“主页”部分，我想用用户通过 JSON 生成的活动来填充它。

**鲍勃喜欢凯尔的诗。**

**鲍勃开始跟踪凯尔。**

**Bob 点赞了 6 首诗** ------>（所有 6 首诗在提要中汇总在一起）

**鲍勃评论凯尔的诗：美丽的作品！**

我该怎么做呢？如果问题不清楚，请告诉我，以便我为您和其他遇到此帖子并可能会发现它有用的人更清楚！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:59:26.580

你实际上在做什么需要

1.  聚合逻辑（你可以用 python 编写，因为你的主要框架是 django）
2.  在后台运行的任务队列，执行这些聚合逻辑
3.  redis 数据库中的非规范化和重复数据，重复主数据库中的关系数据，例如您的 postgresql 数据库

您可以将活动提要分解为其组件，这些组件在 redis 上聚合在一起，但在关系数据库中彼此相关。

`Bob`和`Kyle`和是对象`poems`，`Beautiful piece`分别是存储在您的关系数据库中的用户对象、用户对象、诗歌对象和评论对象。

您的活动类型是“关注”、“喜欢”、“评论”。

然后，您可以编写您的 python 逻辑将它们聚合成一个单独的提要项，该提要项存储在您的 redis 数据库中，每个提要项都由对象和活动类型（以及该活动发生的时间戳）组成。

这是开始时的主要设计考虑因素。

这是一个很好的例子 - [https://github.com/SupermanScott/redis-activity-example](https://github.com/SupermanScott/redis-activity-example)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-02T12:12:01.950

Stream-Framework 是一个开源库，用于构建提要并支持 Redis 和 Cassandra 作为存储后端。

你可以在[github上查看](http://github.com/tschellenbach/Stream-Framework)

免责声明：我是 Stream-Framework 的作者之一

# vb.net - 如何用鼠标移动图片框，但鼠标留在它的位置？

> ID：13635536
> 
> 赞同：0
> 
> 时间：2012-11-29T21:59:54.350
> 
> 标签：vb.net, visual-studio-2010, vb.net-2010

我有一些代码可以移动控件，但是当您到达屏幕末尾时，您必须释放鼠标右键，再次右键单击图像，然后再次拖动，.. 重复..

现在我尝试重写代码，以便在不移动鼠标的情况下移动控件。这就是我现在所拥有的：

```
Private Sub Form1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseMove
    Dim xx As String = DirectCast(e, MouseEventArgs).Button.ToString
    If xx = "Right" Then
        Dim Px As Point = New Point(Me.Location.X + SplitContainer1.Location.X + SplitContainer1.SplitterDistance + CInt((SplitContainer1.Width - SplitContainer1.SplitterDistance) / 2), Me.Location.Y + SplitContainer1.Location.Y + CInt(SplitContainer1.Height / 2))
        Windows.Forms.Cursor.Position = Px
        PictureBox1.Left = PictureBox1.Left + (e.X - Px.X)
        PictureBox1.Top = PictureBox1.Top + (e.Y - Px.Y)
    End If
End Sub 
```

然而图像并没有移动，它随着鼠标返回到原来的位置。

如何让这段代码在不让鼠标改变位置的情况下移动图片框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:25:45.070

啊，我很容易解决它：

```
Dim TemporaryMousePointerLocation As Point 
Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseMove
    Static UpdateMouseOnNextMove As Boolean = False ' we need to have an update delay between each mouse move, if we update the position of the mouse each mousemove then there will be no movement
    If DirectCast(e, MouseEventArgs).Button = MouseButtons.Right Then
        If UpdateMouseOnNextMove Then
            PictureBox1.Left -= (Windows.Forms.Cursor.Position.X - TemporaryMousePointerLocation.X)
            PictureBox1.Top -= (Windows.Forms.Cursor.Position.Y - TemporaryMousePointerLocation.Y)
            Windows.Forms.Cursor.Position = TemporaryMousePointerLocation 
            UpdateMouseOnNextMove = False
        Else
            UpdateMouseOnNextMove = True ' allow cursor to move a bit so we can update the position of the mouse
        End If
    Else
        TemporaryMousePointerLocation = Windows.Forms.Cursor.Position
    End If
End Sub 
```

如果有更好的代码可以使用，请告诉我。

# javascript - 如何在算术表达式中编写构造函数？

> ID：13635537
> 
> 赞同：1
> 
> 时间：2012-11-29T21:59:56.470
> 
> 标签：javascript, constructor, arithmetic-expressions

我想减少 JavaScript 中丑陋的代码，尤其是与构造函数有关的代码。

我有一个向量定义为：

```
function Vector2(X, Y) {
    this.x = 0.0;
    this.y = 0.0;

    if (X)
        this.y = Y;
    if (Y)
        this.y = Y;
} 
```

现在，为了将两个向量相加，我必须写：

```
var vector1 = new Vector2(1.0, 0.5);
var vector2 = new Vector2(4.5, 1.0);

vector1.x += vector2.x;
vector1.y += vector2.y; 
```

我想让代码更漂亮，更容易阅读，并在使用许多构造函数时制作更小的文件。我希望能够写的是：

```
vector1 += vector2; 
```

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T22:02:37.673

你可以有这个：

```
function Vector(X, Y) {
    this.x = X || 0.0; // yes, I simplified a bit your constructor
    this.y = Y || 0.0;
}
Vector.prototype.add = function(v) {
   this.x += v.x;
   this.y += v.y; 
} 
```

你只需要做

```
var vector1 = new Vector(4,4);
var vector2 = new Vector(1,3);
vector1.add(vector2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:14:28.100

```
vector1 += vector2; 
```

我不知道你来自什么语言，但你不能覆盖 JavaScript 中的运算符。

# java - 当没有指定匹配项时匹配到默认令牌

> ID：13635538
> 
> 赞同：0
> 
> 时间：2012-11-29T21:59:57.943
> 
> 标签：java, default, match, token, antlr3

我想匹配一个众所周知的标识符列表，如果没有众所周知的标识符，我希望它成为类似于默认令牌的东西。它会是这样的：

令牌1：'令牌1'；

令牌2：'令牌2'；

默认值：以上都不是，必须遵循字母（字母|编号）*；

任何人都知道是否有可能做到这一点？

问候，

瑞

# asp.net - 默认页面未使用 Site.Master 内容呈现

> ID：13635539
> 
> 赞同：0
> 
> 时间：2012-11-29T22:00:04.480
> 
> 标签：asp.net

我有一个 GoDaddy.com 的托管帐户，运行 .NET 4.0 的 IIS 7 服务器，我正处于为我们教会开发网站的早期阶段。内容是一个免费的基于 CSS 的模板，我已将其移至带有母版页的 ASP.NET Web 应用程序中。（如果需要对内容进行评论，请记住这是一个非常早期的发展阶段......但我愿意接受任何建议。:)）

出于某种原因，当我输入默认页面的完整 URL 时，页面会正确呈现。但是，如果我只输入文件夹名称而不输入页面名称，我只能从页面本身获取内容。

你自己看：

[http://www.websmithsllc.com/lpacftp/Home.aspx](http://www.websmithsllc.com/lpacftp/Home.aspx)

[http://www.websmithsllc.com/lpacftp](http://www.websmithsllc.com/lpacftp)

我不认为这是我在内容页面和母版页之间的连接的问题，因为当我使用完整的 URL 时它会正确呈现。因此，我认为问题出在以下三个方面之一：

1.  我的发布方式：一键访问 FTP 目录
2.  项目设置：目前Home.aspx为起始页
3.  我的主机上的设置有问题。

我真的希望问题不是#3，因为到目前为止我的经验是他们的技术支持在 Visual Studio / IIS 开发和发布领域严重缺乏。

现在，一些额外的线索。我知道 Site.Master 文件正在被渲染，至少在某种程度上是这样。正在显示的菜单是在 Site.Master.Page_Load 事件处理程序中创建的：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        //Load sidebar content
        Page p = HttpContext.Current.CurrentHandler as Page;
        menuContent.Text = Helpers.StaticHelperMethods.GenerateMenuContent(p.Title);
    } 
```

静态方法： public static string GenerateMenuContent(String pageTitle) { StringBuilder menu = new StringBuilder();

```
 if (pageTitle == "Home")
        {
            menu.Append("<a href=\"Home.html\" class=\"but but_t\"  title=\"Home Page\">Home</a>\n");
        }
        else
        {
            menu.Append("<a href=\"Home.html\" class=\"but\"  title=\"Home Page\">Home</a>\n");
        }
    More similar code... 
```

在这种情况下，p.Title 应该 == "Home"，但代码响应好像没有响应，而且我不知道如何（如果可以）实时调试以查看发生了什么。最后，如果您仔细查看第二个链接，您会注意到一些常用的 ASP.NET 广告文本，这些文本似乎来自 BodyContent asp:Content 对象中的常用“Default.aspx”文件。但是，查看属性/Web 选项卡，我可以看到启动操作是特定页面：Home.aspx。

所以 - 希望我没有在这里添加大量不必要的信息，但至少足以让有更多经验的人帮助我找出我在这里做错了什么。

提前感谢您在这方面可以为我提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:15:51.253

您需要一个默认页面。创建它，然后在 Page_Load 后面的代码中编写：

Response.Redirect("Home.aspx");

或者更改 IIS 中的默认页面。或者将您的主页更改为 Default.aspx（并重命名类和页面指令）。

在这三者中，创建重定向到 Home.aspx 的 Default.aspx 页面可能是最简单的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:33:28.443

是的，马修马丁是正确的。您的托管服务的 IIS 未配置为将“Home.aspx”作为默认页面。您需要让他们将其添加到 IIS 配置中，或者将您的主页重命名为 Default.aspx，或者创建一个重定向到您的 Home.aspx 的“虚拟”Default.aspx。

# mysql - MySQL 连接器 6.6.4 与 mod_mono 和 mono

> ID：13635542
> 
> 赞同：0
> 
> 时间：2012-11-29T22:00:15.183
> 
> 标签：mysql, mono

这是 PublicTokenKey 以及我需要在 web.config 中编写的内容。我的意思是具有 6.6.4 版本的 MySql.Data.Dll（我从官方网站下载了最新版本）谢谢，提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T13:42:45.430

这是 PublicTokenKey -> c5687fc88969c44d

如果您使用 linux，您可以从以下路径找到此信息：/usr/lib/mono/gac/MySql.Data/6.6.4.0__c5687fc88969c44d 对于 Windows，请参阅此链接： [https ://blogs.msdn.com/b/wriju/存档/2008/07/01/how-to-find-public-key-token-for-a-net-dll-or-assembly.aspx?Redirected=true](https://blogs.msdn.com/b/wriju/archive/2008/07/01/how-to-find-public-key-token-for-a-net-dll-or-assembly.aspx?Redirected=true)

# c++ - 一个 c++ 程序在两个 IDE 中返回不同的结果

> ID：13635546
> 
> 赞同：15
> 
> 时间：2012-11-29T22:00:30.067
> 
> 标签：c++, eclipse, gcc, codeblocks

我在里面写了下面的`c++`程序`CodeBlocks`，结果是9183。我又写进去`Eclipse`，运行后返回9220。两者都使用`MinGW`。正确的结果是 9183。这段代码有什么问题？谢谢。源代码：

```
#include <iostream>
#include <set>
#include <cmath>

int main()
{
   using namespace std;
   set<double> set_1;
   for(int a = 2; a <= 100; a++)
   {
       for(int b = 2; b <= 100; b++)
       {
           set_1.insert(pow(double(a), b));
       }
   }
    cout << set_1.size();

return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T22:16:34.160

由于 CodeBlocks 在 32 位模式下编译和 Eclipse 在 64 位模式下编译，您可能会看到精度错误：

```
$ g++ -m32 test.cpp
$ ./a.out
9183
$ g++ -m64 test.cpp
$ ./a.out
9220 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T22:23:59.873

如果我将两个参数都转换为 double 我会得到你所期望的：

```
pow(static_cast<double>(a), static_cast<double>(b)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T23:01:06.960

差异似乎是由于浮点运算使用的是 53 位精度还是 64 位精度。如果在循环前面添加以下两行（假设 Intel 架构），它将使用 53 位精度并`9220`在编译为 32 位应用程序时给出结果：

```
uint16_t precision = 0x27f;
asm("fldcw %0" : : "m" (*&precision)); 
```

控制此精度的是 FPU 的第 8 位和第 9 位。上面将这两个位设置为`10`. 将它们设置为`11`64 位精度。而且，为了完整起见，如果将位设置为`00`（值 0x7f），则大小将打印为`9230`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-29T22:07:52.920

实际上，无论如何，您实际上不应该依赖`==`（或技术上`x <= y && y <= x`）双打。所以这段代码会产生依赖于实现的结果（严格来说不是 UB，根据评论，但我的意思是 :)）

# ruby-on-rails - 启用动作缓存后，format.js 不会操作 dom

> ID：13635548
> 
> 赞同：11
> 
> 时间：2012-11-29T22:00:33.927
> 
> 标签：ruby-on-rails, ajax, caching, action-caching

*注意：我在这里提出我正在做的逻辑。*

**我在做什么：**

想想我们列出产品和分页的基本索引操作。现在使用 remote-true 选项，我启用了基于 ajax 的分页。到目前为止，一切都很好。看一下示例代码。

产品控制器：

```
 def index
  @products = Product.paginate(:order =>"name ASC" ,:page => params[:page], :per_page => 14)
   respond_to do |format|
     format.html # index.html.erb
     format.json { render json: @products }
     format.js
   end
 end 
```

索引.html.erb

```
<h1>Products</h1>
<div id="products">
    <%= render "products/products" %> // products partial is just basic html rendering
</div>

<script>
$(function(){
   $('.pagination a').attr('data-remote', 'true')
});
</script> 
```

索引.js.erb

```
 jQuery('#products').html("<%= escape_javascript (render :partial => 'products/products' ) %>");
  $('.pagination a').attr('data-remote', 'true'); 
```

**所以有什么问题：**

现在我想对此启用动作缓存。但是 index.js.erb 文件并没有操作 DOM。如果我删除了 remote-true 功能，那么缓存就可以正常工作。

对于动作缓存，我在控制器顶部添加了这一行：

```
 caches_action :index, :cache_path => Proc.new { |c| c.params } 
```

有什么建议么？

**更新：**

问题是 jquery 代码没有执行。从[这个](https://stackoverflow.com/questions/5400083/jquery-script-request-not-caching)问题

*我发现出了什么问题。jQuery 实际上用 a 包围传入的脚本，以便浏览器评估传入的代码。但是缓存机制只是将代码保存为文本，当再次请求时，它会将代码作为文本返回，但不对其进行评估。因此，需要明确地评估代码*

**但是这个问题怎么解决？？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T09:32:15.077

经过一些试验和错误，我想我有一个解决方法。

**页面链接**

代替

`$(function() { $('.pagination a').attr('data-remote', 'true') });`

采用

```
$(function() {
  $('.pagination a').click(function() {
    $.ajax({
      url: this.href,
      dataType: 'script'
    });
    return false;
  });
}); 
```

因此应用服务器创建的响应将作为 javascript 运行

**控制器**

接下来，将您的`caches_action`线路更改为

```
caches_action :index, cache_path: proc { |c| c.params.except(:_).merge(format: request.format) } 
```

因为ajax`_`为某种时间戳附加了一个参数

希望这有效:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T17:52:13.387

我看不出使用`remote: true`. 其他人建议使用`.ajax`而不是`remote: true`，但这正是远程功能所做的，所以应该没有任何区别。

`jQuery.ajax`另一个答案的代码明确使用`dataType`. 不过，您实际上可以这样做`remote: true`。

在您的 HTML 链接中，您只需指定`data-type="script"`. 或者，根据您发布的 JS，您可以这样做：

```
$(function(){
   $('.pagination a').attr('data-remote', 'true').attr('data-type', 'script');
}); 
```

编辑：另外，我在这里更深入地介绍了数据类型属性及其与 Rails 的工作方式：[http ://www.alfajango.com/blog/rails-3-remote-links-and-forms-data-用 jquery 输入/](http://www.alfajango.com/blog/rails-3-remote-links-and-forms-data-type-with-jquery/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-18T16:30:44.143

我想我找到了解决这个问题的方法。我有一个控制器，它具有`caches_action`使用 format.js 通过 ajax 获取一些数据的操作，但它不能开箱即用。

我发现，尽管请求被传输到服务器，并且服务器正确解析请求并“呈现”`index.js.erb`模板，但 DOM 中没有任何更新。您的解决方案`$.ajax`为`dataType:'script'`我解决了这个问题，但是，我不喜欢用 jquery 绑定到链接上的点击，这应该默认发生......我能够通过将我的更改为使其正常`link_to`工作这：

`= link_to "click me", user_action_path(params), remote: true, data:{type: 'script'}`

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T07:49:22.243

我遇到了同样的问题，但是在我的 3.0.3 应用程序中，使用 :remote => true 我添加了 :'data-type' =>: 脚本并且运行良好。

但是，就我而言，当通过 ajax 加载列表时，我看不到任何改进。

# java - 骆驼 - unmarshal().serialization() - ClassNotFoundException

> ID：13635550
> 
> 赞同：0
> 
> 时间：2012-11-29T22:00:40.253
> 
> 标签：java, apache-camel, osgi, apache-karaf, apache-servicemix

我试图用序列化方法解组一个不是当前包但在公共组件包中的bean。

当骆驼尝试解组我的 bean 时，我收到以下错误：

> 22:43:11,865 | 错误 | nModule-thread-1 | 默认错误处理程序 | 89 - org.apache.camel.camel-core - 2.8.0.fuse-06-11 | exchangeId 交付失败：ID-ITEM-64684-49962-1354223882336-2-1。交付尝试后用尽：1 捕获：java.lang.ClassNotFoundException: commons.InformationInput java.lang.ClassNotFoundException: commons.InformationInput at java.net.URLClassLoader$1.run(URLClassLoader.java:202)[:1.6.0_33] at java .security.AccessController.doPrivileged(Native Method)[:1.6.0_33] at java.net.URLClassLoader.findClass(URLClassLoader.java:190)[:1.6.0_33] at java.lang.ClassLoader.loadClass(ClassLoader.java: 306)[:1.6.0_33]http://stackoverflow.com/questions/6749334/osgi-bundle-access-spring-context-file-from-another-bundle at java.lang.ClassLoader.loadClass(ClassLoader.java: 247）[：1.6。

我的包含 bean 的包已正确启动，并且我在包定义的**Export-Package**中定义了**commons**包

 **有没有人设法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T12:19:55.623

当正在序列化/反序列化类的包事先不知道必须导入哪些包时，有时会发生这种情况。

一种解决方法是使用[DynamicImport-Package](http://wiki.osgi.org/wiki/DynamicImport-Package)。例如：

```
DynamicImport-Package: * 
```

这意味着包可以导入任何包中的类，但要注意成本（请参阅链接文章）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T16:46:38.833

这听起来类似于 Hibernate 发出一个 OSGi 环境，由于类加载问题而失败。我会推荐一些分类类好友加载。在包含该类的公共包的清单中添加此

```
Eclipse-BuddyPolicy:registered 
```

然后在你的依赖伙伴中确保你将它作为一个依赖包添加到它的清单中。

```
Eclipse-RegisterBuddy:com.nameofmycommonbundle 
```

这应该可以解决您的问题。

这是hibernate参考的[参考](https://community.jboss.org/wiki/HibernateAndEclipseIntegration)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T14:16:42.737

我通过在骆驼核心捆绑包上启用动态导入找到了一种解决方法。这可以在 karaf 控制台上完成：`dev:dynamicimport <camel-core-bundle-id>`**

# android - 如何将 MapView 从像素缩放到米

> ID：13635551
> 
> 赞同：3
> 
> 时间：2012-11-29T22:00:44.310
> 
> 标签：android, google-maps, android-mapview, scale

我正在制作一个使用 Google Maps API 的 Android 应用程序，我想将 MapView 缩放到 X_pixels:X_meters。

比如我屏幕上5个像素的MapView，现实上20米。

那可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:30:15.310

使用以下代码：

```
 int nPixles = 5; //number of pixels
    GeoPoint g0 = mapview.getProjection().fromPixels(0, mapview.getHeight()/2);
    GeoPoint g1 = mapview.getProjection().fromPixels(nPixles, mapview.getHeight()/2);
    float[] results = new float[1];
    Location.distanceBetween(g0.getLatitudeE6()/1E6, g0.getLongitudeE6()/1E6, g1.getLatitudeE6(), g1.getLongitudeE6()/1E6, results);
    float distanceInMeters = results[0]; 
```

这会计算屏幕中心纬度水平的距离（以米为单位）。因为地球是球形的，从屏幕底部到顶部的距离不同。这主要是在低缩放级别时注意到的。

问候。

# css - 绝对可靠的固定 TD 宽度？

> ID：13635553
> 
> 赞同：0
> 
> 时间：2012-11-29T22:00:46.557
> 
> 标签：css, html, width, html-table

我现在正在摆弄表格列宽。由于 HTML5 中不推荐使用 width 属性，因此我试图通过 CSS 设置表格列宽。然而，由于某种原因，这不能可靠地工作。

更加具体...

我想通过使用表格来构建甘特图（对于那些还没有听说过它的人的某种时间表）。每个月由许多列组成，这些列代表相应月份的天数。标题使用 colspan 跨越一个月的所有日子。每天应该是 10px 宽度。因此，跨越 31 天（例如 1 月）的 TD 使用属性 style="width: 310px" 进行装饰。

项目任务还包括三个跨栏：第一栏是项目开始和任务开始日期之间的空闲时间，第二栏是任务活动的时间，第三栏是之间的时间任务本身的结束和整个项目的结束日期。

我希望这个解释能帮助你解决我的问题......

奇怪的是，这些列似乎以某种方式忽略了它们的宽度设置。它在 DOM 检查器中可见，就像 FireFox 提供的那样。它没有被删除，因此它被接受并在 DOM 中实际使用，但计算出的 TD 宽度并未反映此设置。一些 TD 比 style 属性给出的宽度更小，另一些则更宽。

我根本不明白为什么。

那么，有没有办法将跨列的宽度设置为绝对可靠且可重复的**固定**值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:09:13.310

表格单元格宽度的计算方式不同。

与`width:`设置为金色的普通元素不同，表格单元格可以根据其内容具有不同的宽度。表格单元格的内容可能永远不会泄漏。因此，如果您有一个较长的单元格，它会扩大宽度，覆盖您的`width:`设置，从而“弄乱”其余单元格（如果您对所有单元格都有固定宽度）。

我的建议：给`<table>`自己一个宽度，让它自己整理。结果通常是最佳的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:49:39.413

正如您在提供的 Fiddle 中看到的那样，在 TH 和 TD 中有竞争对手的宽度设置。我已经从每个 TD 中删除了宽度设置，只保留了 TH 中的宽度设置。有了它，它现在似乎可以工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:49:42.393

在每个 TD 元素中，插入一个 div 并设置所需的宽度。这将确保宽度是固定的。

```
<table>
  <tr>
      <td><div style="width: 200px;">Fixed 200px width</div></td>
  </tr>
</table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-18T08:10:48.857

在每个 td 中插入 div 或`<p>`标签并设置 div 的宽度或`<p>`代替`<td>`它本身.. 几天前我遇到了同样的问题，但现在它正在工作。

# scala - 如何在Scala中处理空输入参数

> ID：13635554
> 
> 赞同：12
> 
> 时间：2012-11-29T22:00:45.853
> 
> 标签：scala

我知道在 Scala 中，一个方法永远不应该返回`null`……但是输入参数呢？鉴于以下代码片段...

```
object MyObject {

    def myMethod(p: String): Option[String] = {
        if (p == null) throw new IllegalArgumentException("p is null.")
        ...
    }
} 
```

...我检查的方式是否`p`正确？有什么建议吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-29T22:49:28.257

约定是 Scala 代码不使用空值（有少量异常，在使用这些库函数时应该立即修复）。

因此，Scala 中的 null 表示出现问题（至少是[PBCAK](http://www.urbandictionary.com/define.php?term=pbcak)），因此您不妨抛出异常。这不是常规操作；这是严重搞砸的事情。在遇到严重错误的地方捕获异常。捕捉 an`IllegalArgumentException`而不是 a`NullPointerException`不会增加额外的信息。只留下原件。

如果代码来自 Java，处理它的规范方法是将其包装在 中`Option`，这将转换`null`为`None`. 那么你可能甚至不需要抛出异常；只返回一个`None`.

```
def myMethod(p: String) = Option(p).map(_.toLowerCase) 
```

如果您在它为空时无法继续，那么您需要考虑信息异常是否会有所帮助。 `Option(p).orElse(throw new IllegalArgumentException("Null!"))`是表达异常抛出情绪的一种紧凑方式。

在 Scala 2.10 中，您还可以包装一些东西，`scala.util.Try(...)`这些东西会自动为您捕获和打包异常。如果您想要一个打包的异常而不是抛出一个异常，这就是要走的路。（并使用`Try`而不是`Option`。）

```
import scala.util.Try
def myMethod(p: String) = Try(p.toLowerCase) 
```

最后，对于替代结果的更一般处理，请使用`Either`. 错误处理的约定是预期的输出是 a `Right(whatever)`，而`Left(whatever)`表示出现了问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T22:07:11.350

有几种方法，你的方法是一种。

您还可以使用：

```
require(p != null, "p is null.") 
```

或者“更实用”的方式是使用`Option`：

```
def myMethod(p: String): Option[String] = {

  // no exception
  for {
    pp <- Option(p)
  } yield p + " foo bar"
} 
```

编辑：

或者，如果您希望没有抛出异常的错误，您可以使用`Either`：

```
def myMethod(p: String): Either[Exception, String] = {
  if(p == null) Left(new IllegalArgumentException("p is null."))
  else Right(p + "foo bar")
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:29:15.770

Scala 习语本质上是“永远不要使用空值”。因此，除非您正在编写一个需要适应肮脏的 Java 用户的 API，否则我不会担心它。否则，您将最终为您编写的每个方法的每个参数插入此样板检查。

你漂亮的单行方法

```
def square(x: String): String = math.pow(x.toInt, 2).toInt.toString 
```

会变成一些尴尬的东西

```
def square(x: String): String = 
    if (x == null) throw new NullPointerException()
    math.pow(x.toInt, 2).toInt.toString
} 
```

或者

```
def square(x: String): String = Option(x) match {
    case Some(x) => math.pow(x.toInt, 2).toInt.toString
    case None => throw new NullPointerException()
} 
```

多么可怕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-12T15:54:16.990

我最喜欢的方法是：

```
object HandlingInputValidation {

  def main(args: Array[String]) = {
    println("A1: " + handleInput("Correct ") + " END")
    println("A2: " + handleInput("Correct") + " END")
    println("A3: " + handleInput("") + " END")
    println("A4: " + handleInput(" ") + " END")
    println("A5: " + handleInput(null) + " END")
  }

  def handleInput(data: String): Option[String] = {
    Option(data).map(_.trim.toLowerCase)
  }
 } 
```

在这种情况下，`null`will be `None`，并且空格将被修剪。

# hibernate - 刷新后调用 Hibernate PostInsertEventListener

> ID：13635555
> 
> 赞同：4
> 
> 时间：2012-11-29T22:00:47.153
> 
> 标签：hibernate, event-handling

我有一个实现 Hibernate 的类，它通过 Spring`PostInsertEventListener`与 Hibernate 相关联。`SessionFactory`拦截器是为`post-insert`事件类型指定的。每当我执行`session.save(entity)`. 但是，执行发生在事务被刷新之前。如果数据库抛出异常，这是有问题的。

**问题：**有没有一种方法可以指定在 调用拦截器**后**`session.flush()`调用拦截器？

我尝试`insertEvent.getSession().flush()`在事件侦听器中执行此操作，但由于尚未设置 id，因此会产生主键违规异常。

我还没有探索这`registerSynchronization`条路，因为我似乎缺少一些基本配置。正在使用的事务管理器`org.springframework.orm.hibernate3.HibernateTransactionManager`和事务边界由`@Transactional`注释指定。休眠版本是 3.6

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T00:58:39.507

当前解决方案：

将 Post(Insert|Update|Delete)Event 存储在以 Session 为键的 Map 中。从 Session 的 FlushEventListener 中的映射中获取事件并处理该事件。

使用的地图是[Guava Cache](http://code.google.com/p/guava-libraries/wiki/CachesExplained)，过期间隔设置为分钟。这将捕获由于 SQLException 而导致 flush() 失败并且需要从映射中删除该会话的条目的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-18T10:52:18.683

您可以`post-commit-(update|delete|insert)`用于侦听器类型。它在提交事务后调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T22:07:05.593

使用[FlushEventListener](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/event/FlushEventListener.html)怎么样？

# c# - 在 rnHibernate 的 where 子句中使用 null

> ID：13635562
> 
> 赞同：0
> 
> 时间：2012-11-29T22:01:17.147
> 
> 标签：c#, fluent-nhibernate, nhibernate-mapping

我正在尝试过滤掉映射中的结果。但是我试图从 int 字段中过滤掉空值。nHiberate 抛出异常。如果我使用数字，它会起作用。这是代码：

```
table("products");
            Id(x => x.productID);
            Map(x => x.canOverwrite);           
            Map(x => x.format);
            Map(x => x.freeShipping);
            Map(x => x.height);           
            Map(x => x.lastUpdated);
            Map(x => x.length);           
            Map(x => x.releaseDate);
            Map(x => x.removeDate);                       
            HasMany(x => x.ProductContributors).Where(c => c.sortID != null).KeyColumn("productID").Not.LazyLoad(); 
```

关于如何使它工作的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:24:20.423

在贡献者中，我也有一个禁用的布尔值。我将其添加到实体和映射中。然后我按禁用 == false 过滤。不是真正的解决方案，更多的是解决方法。

# eclipse - 在 Eclipse 中设置 JDK

> ID：13635563
> 
> 赞同：143
> 
> 时间：2012-11-29T22:01:26.457
> 
> 标签：eclipse, java

我有两个 JDK，用于 Java 6 和 7。

我想使用两者来构建我的项目。最初我们只针对 1.6 构建。我在我的项目设置中看到我可以选择 1.5、1.6 1.7 作为编译器级别。

这些选项是如何添加到 IDE 中的？我从未安装过 Java 1.5。假设我想要 Java 1.4。我怎样才能让它出现在列表中？我在我的 IDE 首选项中添加了两个不同的 JRE，但这些不是出现在下拉列表中的内容。

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-11-29T23:20:09.647

您可以管理`Window -> Preferences -> Java -> Installed JRE's tab`.

在项目构建路径配置对话框中，在库选项卡下，您可以删除条目`JRE System Library`，单击`Add Library`并选择已安装的 JRE 进行编译。一些编译器可以配置为在后级编译器版本上进行编译。我认为这就是您看到附加版本选项的原因。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2015-04-15T01:37:41.120

正如 MayoMan 所提到的，可能需要一些额外的步骤来正确设置项目和默认工作区 JRE。这是 Eclipse Luna 中的完整序列：

*   右键单击您的项目>属性
*   选择左侧的“Java Build Path”，然后选择“JRE System Library”，点击Edit…</li>
*   选择“工作区默认 JRE”
*   单击“已安装的 JRE”
*   如果您在列表中看到所需的 JRE，请选择它（选择 JDK 也可以）
*   如果没有，请单击搜索...，导航到计算机 > Windows C: > 程序文件 > Java，然后单击确定
*   现在您应该看到所有已安装的 JRE，选择您想要的
*   单击确定/完成一百万次

容易……不。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2019-10-12T11:20:03.943

要告诉 eclipse 使用 JDK，您必须按照以下步骤操作。

1.  选择**窗口**菜单，然后选择**首选项**。您可以看到一个对话框。
2.  然后选择**Java** ---> **Installed JRE's**
3.  然后单击**添加**并选择**标准 VM**，然后单击**下一步**
4.  在 JRE 主页中，导航到已安装 JDK 的文件夹（例如，在我的系统中，我的 JDK 位于 C:\Program Files\Java\jdk1.8.0_181\ 中）
5.  现在点击**完成**。

完成上述步骤后，您现在就完成了，eclipse 将开始使用选定的 JDK 进行编译。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-30T00:15:19.123

Eclipse 的编译器可以确保您的 java 源代码符合给定的 JDK 版本，即使您没有安装该版本。此功能对于确保代码的向后兼容性很有用。

您的代码仍将由您选择的 JDK 编译和运行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-02-12T00:57:53.293

**配置 JDK**

1.  Windows -> Preferences -> Installed JREs，配置已安装的 JDK
2.  项目属性、Java 编译器、启用项目特定设置（或配置工作区设置）、JDK 合规性
3.  项目属性、Java 构建路径、库、添加库、JRE 系统库、工作区默认或备用 JRE（在

**马文**

但是，如果您使用的是 maven，前提是您拥有最新的 JRE（Windows/Preferences/Installed JRE）——例如 JDK 1.8

可以通过配置maven-compiler-plugin源和目标属性来选择级别1.6、1.7、1.8，像这样

```
 <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.3</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                </configuration>
            </plugin> 
```

理想情况下，如果您有一个父 pom，您可以在一个地方为父 pom 中的所有模块（Eclipse 项目）执行此操作。

**源和目标** 如果我们想使用 Java 8 语言特性，-source 应该设置为 1.8。此外，要使编译的类与 JVM 1.8 兼容，–target 值应为 1.8。

**一次更新在许多项目中损坏的 JRE 库（使用 Maven）**

与其一一更新 JRE 库，不如让 Maven 为您完成。

选择项目并右键单击 Maven -> Update Project，将系统库设置为已安装 JDK 的路径，以防路径损坏（因为您安装了新的 JDK 或从另一台计算机导入等）和根据 pom.xml 中的 maven 源和目标设置设置 JDK 合规性。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-30T08:07:43.413

JDK 1.8 有一些不支持许多 eclipse 的更丰富的功能。

如果您在 java 编译器中没有找到 1.8 的 java 合规级别，请继续安装以下 eclipse 32 位或 64 位，具体取决于您的系统支持。

1.  安装 jdk 1.8，然后在环境变量中设置 JAVA_HOME 和 CLASSPATH。
2.  下载eclipse-jee-neon-3-win32并解压：支持java 1.8
3.  或下载 Oracle Enterprise Pack for Eclipse (12.2.1.5) 并解压：支持 64 位操作系统的 java 1.8
4.  右键单击您的项目>属性
5.  选择左侧的“Java Compiler”，并将 Java 合规级别设置为 1.8 [从下拉列表中选择 1.8]
6.  尝试运行一个支持java 8的java程序，如下面的lambda表达式，如果没有编译错误，则意味着你的eclipse支持java 1.8，如下所示：

    ```
    interface testI{
        void show();
    }

    /*class A implements testI{
        public void show(){
            System.out.println("Hello");
        }
    }*/

    public class LambdaDemo1 {
        public static void main(String[] args) {
            testI test ;
            /*test= new A();
            test.show();*/
            test = () ->System.out.println("Hello,how are you?"); //lambda 
            test.show();
        }        
    } 
    ```

# php - 回显 PHP 字符串

> ID：13635573
> 
> 赞同：0
> 
> 时间：2012-11-29T22:02:03.547
> 
> 标签：php, css

好的，我已经让 PHP 成功打开并读取包含许多图像的目录的内容。我将所有这些数据传递到一个数组中，对结果进行排序，最后遍历所有图像，以便它给我一个刺痛感，然后我将其回显到 html 页面上。在这个字符串中，我为每个 div 设置了 css 类，以便在页面呈现每个 div 时正确显示。

我的问题是与实际 PHP 设置每个 div 的类有关。基本上我有两个类，我根据它们的数量应用于每个 div。例如在第一个水平行中，第 1 到第 3 个 div 获取到的类，`.box`以便设置 a`margin-right:10px;`和第 4 个获取它自己的类，`.box last`其中设置`margin-right:0px;`。

所以我想问的是，有没有办法编写一些逻辑来告诉 PHP 代码为第 1 到第 3 个 div 应用一个类，为每行的每 4 个 div 应用一个单独的类？有效地，行中的前三个 div 得到在课堂上，每行的第四个 div 得到另一个？

```
<?php 
$dir = "images/"; 

$images = array();

$returnstr = "";

if ($handle = opendir($dir)) {
    while ( false !== ($entry = readdir($handle))) {
        if ($entry != "." && $entry != ".."){
            $images[] = $entry;
        }
    }
    closedir($handle);
}

natsort($images);

$newArray = array_values($images);

foreach ($newArray as $key => $value) {
    $returnstr .= '<li class="box">';
    $returnstr .= '<a href="#" name="" class="thumb" id="' . $key . '"><img src="'. $dir . '/' . $value . '"/></a>';
    $returnstr .= '</li>';
}

?> 
```

这是第 1 - 3 个 div 的 CSS ......

```
.box {

float: left;
/*margin-right:10.5px;*/
margin-right:10px;
/*width: 92px;
height: 92px; */
width: 232.5px;
height:150px;
/*height: 232px; */
/*background-color: #999;
border: 1px solid*/
margin-bottom: 10px;  
list-style: none;  
} 
```

...以及网格中每 4 个 div 的 CSS

```
.box.last {
margin-right: 0px;
} 
```

这是我试图实现的 html。

```
<li class="box">
  <a href="#" name="cap1" class="thumb" id=""><img src="images/1.jpg"/></a>
</li>

<li class="box">
  <a href="#" name="cap2" class="thumb" id=""><img src="images/2.jpg"/></a>
</li>

<li class="box">
  <a href="#" name="cap3" class="thumb" id=""><img src="images/3.jpg"/></a>
</li>

<li class="box last">
  <a href="#" name="cap4" class="thumb" id=""><img src="images/4.jpg"/></a>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:11:53.633

`.last`您可以使用 css 选择器为第四个`<li>`元素提供特殊边距，而不是使用 php 添加类，如下所示：

```
li.box:nth-child(4){
    margin-right: 0px;
} 
```

这将适用于`<li>`其父容器的第四个孩子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:10:05.283

您需要使用模数，例如：

```
foreach ($newArray as $key => $value) {
    $returnstr .= '<li class="box';
    if (($key > 0) && (($key % 4) == 0)) {
        $returnstr .= ' last';
    }
    $returnstr .= '">';
    $returnstr .= '<a href="#" name="" class="thumb" id="' . $key . '"><img src="'. $dir . '/' . $value . '"/></a>';
    $returnstr .= '</li>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:10:30.950

这可以通过将`foreach`循环更改为：

```
$i = 1;
foreach ($newArray as $key => $value) {
  $last_class = ($i == 4) ? ' last' : '' ;
  $returnstr .= '<li class="box' . $last_class . '">';
  $returnstr .= '<a href="#" name="" class="thumb" id="' . $key . '"><img src="'. $dir . '/' . $value . '"/></a>';
  $returnstr .= '</li>';
  $i++;
} 
```

这样，无论是什么`$key`（在关联数组的情况下），您仍然只将其应用于第四项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T22:10:35.250

```
foreach( $newArray as $key => $value ) {
    if( $key % 4 == 0 ) {
        $returnstr .= '<li class="box last">';
    } else {
        $returnstr .= '<li class="box">';
    }
} 
```

试试看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T22:11:38.783

这可能很脏，但您可以简单地使用计数器，如下所示：

```
 $counter = 1;
foreach ($newArray as $key => $value) {
    if ($counter==4) {
        $returnstr .= '<li class="last">';
    }
    else
    {
        $returnstr .= '<li class="box">';
    }
    $returnstr .= '<a href="#" name="" class="thumb" id="' . $key . '"><img src="'. $dir . '/' . $value . '"/></a>';
    $returnstr .= '</li>';

    $counter++;
} 
```

它应该可以解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-29T22:13:06.070

您可以使用[模运算符 %](http://www.php.net/manual/en/language.operators.arithmetic.php)以及每次通过循环递增的整数来执行此操作。简单的例子：

```
<?php

$n = 0;
foreach ($newArray as $key => $value) {
    $n++;
    if($n > 0 && ($n % 4) === 0){
        $everyFourthRowCss = " last";
    } else {
        $everyFourthRowCss = "";
    }
    $returnstr .= "<li class='box{$everyFourthRowCss}'>";
    $returnstr .= '<a href="#" name="" class="thumb" id="' . $key . '"><img src="'. $dir . '/' . $value . '"/></a>';
    $returnstr .= '</li>';
} 
```

# css - 图像在 Phonegap、jQuery 移动应用程序中无法正确缩放

> ID：13635575
> 
> 赞同：2
> 
> 时间：2012-11-29T22:02:09.433
> 
> 标签：css, cordova, jquery-mobile

我正在使用 PhoneGap 和 jQuery mobile 创建一个 iPhone 应用程序。我正在使用一个简单的图像标签并将宽度设置为 100%，将高度设置为自动，但图像没有正确缩放并被截断。我也尝试过使用具有相同结果的 max-width 。知道如何解决这个问题吗？

```
<div data-role="page">
    <img class="banner" src="..." style="width: 100%; height: auto;">
</div> 
```

我什至试过这个：

```
$('img.banner').each(function(){
    $(this).width($(window).width());                      
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T20:26:34.007

好吧，我现在觉得很傻。我从来自 Wordpress 网站的 JSON 响应中获取该图像。当我解析 JSON 以获取图像时，我使用的是图像的缩略图版本（令我惊讶的是，它并不是真正的缩放缩略图，它只是主图像的 150x150 正方形裁剪）。

所以我改变了我的参考：

```
json.page.thumbnail 
```

至

```
json.page.attachments[0].images.full.url 
```

现在图像缩放得很好（宽度：100%，高度：自动）。

感谢大家的帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T20:13:23.293

我假设您的图像实际上嵌套在带有 a 的 div 中，`data-role="content"`而您的问题是该类`ui-content`默认具有 15px 填充。

纠正这个问题的最简单方法是简单地覆盖该页面的 CSS 以摆脱该填充，如果您需要它用于其他元素，那么只需将它们包装在一个 div 中并向这些 div 添加填充。

例如

CSS

```
.imgContPage { padding:0px; } 
```

标记

```
 <div data-role="page">
    <div data-role="content" class="imgContPage">
    <img class="banner" src="http://dummyimage.com/600x400/000/fff.png&text=PlaceHolder" style="width: 100%; height: auto;">
    </div>
</div> 
```

链接到[JSBin](http://jsbin.com/apaveh/1/)

或者，您可以在您的上设置负边距`img`以补偿填充，但是您需要计算宽度以使其填充到右侧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T10:12:59.597

以前我也遇到过同样的问题。我试过最小高度。为什么两者都有 `maximum-scale=1`，`minimum-scale=1`？试试`minimum-scale=1`。试一试

# ios - 在 Xcode 中设置断点时 iOS App 崩溃

> ID：13635577
> 
> 赞同：1
> 
> 时间：2012-11-29T22:02:18.990
> 
> 标签：ios, xcode, crash, breakpoints

我有一个正在开发的应用程序，在该应用程序运行时在 Xcode 中设置断点会导致它崩溃。至少我认为这是一个崩溃。控制台中*没有任何*内容说明发生了什么。该应用程序刚刚终止。

请注意，断点没有被击中，只是设置它的行为导致了这一点。

我开发了许多应用程序，这是第一个这样做的。有没有人有任何想法可能发生什么或如何解决这个问题？这真的减慢了我的调试速度。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:17:38.833

我假设您使用的是 Xcode 4.x。尝试进入您的方案设置并切换到不同的调试器（如果您当前设置了 LLDB，则为 GDB，反之亦然）。

如果这不起作用，我们需要更多信息：

*   您使用的是哪个版本的 Xcode 和 iOS？
*   问题出现在模拟器或您的设备上，还是两者都有？
*   您是否尝试在代码中的不同位置放置断点？

据我所知，这是一个调试器问题。因此，您的应用程序实际上并没有崩溃，而是调试会话崩溃导致应用程序终止。当您在 Xcode 中点击停止或在应用程序连接到 Xcode 中的调试器时断开设备连接时，您可以观察到类似的效果。

可能是 Xcode 和 iOS 版本不匹配的问题。请提供有关您的环境的更多信息，以帮助诊断问题。

# jquery - 复制最后一个表行但在jquery中更改类

> ID：13635581
> 
> 赞同：0
> 
> 时间：2012-11-29T22:02:30.020
> 
> 标签：jquery, html

我有以下问题。

我有一张桌子，如下例所示。计划是复制一行，但不复制一个新类。该类应在删除类中更改。jsfiddle 中的示例：http: [//jsfiddle.net/klaas3/wgRYR/](http://jsfiddle.net/klaas3/wgRYR/)目标是保持最后一行始终为绿色，其他行为红色。

```
<table class="test">
<thead>
    <tr>
        <td>header 1</td>
        <td>header 2</td>
        <td>header 3</td>
        <td>header 4</td>
    </tr>
</thead>
<tbody>
    <tr class="1">
        <td>data 1</td>
        <td>data 2</td>
        <td>data 3</td>
        <td class="remove"></td>
    </tr>
    <tr class="2">
        <td>data 1</td>
        <td>data 2</td>
        <td>data 3</td>
        <td class="remove"></td>
    </tr>
    <tr class="new">
        <td>data 1</td>
        <td>data 2</td>
        <td>data 3</td>
        <td class="new"></td>
    </tr>
</tbody> 
```

我使用最后一列（带有新的和删除的类或红色和绿色）作为按钮。

我已经准备好了以下内容，但似乎出了点问题：

```
$("table.test tr.new:last td.new").click(function(){
$('table.test tr.new:last  td.new').removeClass('new').addClass('remove').fadeIn("fast");
$('table.test tr.new:last').clone(true).insertAfter('table.test tr.new:last');
}); 
```

请注意，我不是一个非常有经验的 jquery 用户。此外，当单元格类发生更改时，我也会使用 db id 更改表行类。（但我会尝试自己用一个工作样本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:23:08.580

**编辑：**

您需要在更改类之前克隆元素

还要关闭/删除点击事件处理程序使用[.off()](http://api.jquery.com/off/)

```
$("table.test tr.new:last td.new").click(function(){
    var x = $('table.test tr.new:last').clone(true);
    // you can use "this" instead of $('table.test tr.new:last  td.new') since you are inside it's event handler
    $(this).removeClass('new').addClass('remove').off('click');// <-- removes handler from current td 
    x.insertAfter('table.test tr.new:last');
});​ 
```

[http://jsfiddle.net/XvDBC/](http://jsfiddle.net/XvDBC/)

# javascript - 查找包含 AutoCompleteExtender 的 UpdatePanel 的 ID

> ID：13635582
> 
> 赞同：1
> 
> 时间：2012-11-29T22:02:33.507
> 
> 标签：javascript, asp.net, ajax, json, autocomplete

我正在使用 Ajax Autocomplete 来查找学生姓名并返回学生 ID。我的更新面板如下所示：

```
<asp:UpdatePanel ID="StudentSearchUpdatePanel" runat="server">
    <ContentTemplate>
        <dl>
            <dt>Enter student ID:</dt>
            <dd>
                <asp:TextBox ID="StudentIDTextBox" runat="server" Wrap="False" MaxLength="6"></asp:TextBox>
                <asp:Button ID="SelectStudentIDButton" runat="server" Text="Select" OnClick="SelectStudentIDButton_Click"  />
                <asp:Label ID="StudentIDEntryError" runat="server" Visible="false" Font-Bold="True" ForeColor="Red" Text="Please enter a 6-digit student ID number."></asp:Label>
            </dd>
            <dt>Or, begin typing student last name:</dt>
            <dd><asp:TextBox ID="StudentNameSearchTextBox" runat="server"></asp:TextBox></dd>
        </dl>

        <ajaxToolkit:AutoCompleteExtender ID="StudentNameSearchTextBox_AutoCompleteExtender" runat="server"
            TargetControlID="StudentNameSearchTextBox" 
            ServiceMethod="GetStudents"
            OnClientPopulated="getStudents_Populated_Json"
            OnClientItemSelected="selected_Student" 
            MinimumPrefixLength="2" 
            CompletionSetCount="20" 
            UseContextKey="True" >
        </ajaxToolkit:AutoCompleteExtender>
    </ContentTemplate>
</asp:UpdatePanel> 
```

GetStudents_Populated_Json 看起来像这样：

```
 function getStudents_Populated_Json(sender, e) {
        var students = sender.get_completionList().childNodes;
        for (var i = 0; i < students.length; i++) {
        var student = eval('(' + students[i]._value + ')');
         students[i].innerHTML = student.LastName + ' ' + student.FirstName;
      } 
```

最后，selected_student：

```
 function selected_Student(sender, e) {    
      var selectedStudent = eval("(" + e._value + ")");  
 } 
```

在 selected_student 中，我想找到 UpdatePanel (StudentSearchUpdatePanel) 的 ID，这样我就可以找到“StudentIDTextBox”并将 selectedStudent.ID 放在 StudentIDTextBox.innerHTML 中。如何识别 StudentIDTextBox 并将其设置为 selected_Student 的 innerHTML？

（学生班级是 ID、FirstName、LastName。我已经验证 selectedStudent.ID 给出了准确的 id）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:26:50.287

一个更简单的解决方案是让您轻松找到所需的文本框的 ID（如果放在首位）。

一种方法是`ClientIDMode="Static"`在您的`asp:TextBox`. 这将强制控件`id`在客户端上具有与控件的服务器名称相同的属性。这样，要在客户端（使用 JS）上找到此控件，您只需：

```
var myTextbox = document.getElementById('StudentNameSearchTextBox');
myTextbox.value = student.LastName + ' ' + student.FirstName; 
```

希望有帮助。

# c# - 托管类型等效于 [MarshalAs(UnmanagedType.I8)]

> ID：13635586
> 
> 赞同：0
> 
> 时间：2012-11-29T22:02:39.860
> 
> 标签：c#, pinvoke

我继承了一个用 C 语言编写的 dll，我可以从 C# 中的 Windows 应用程序（Framework 2.0）访问它。最近一些机器已经升级到 64 位 Windows 7，并且这些机器上的 dll 不再返回正确的值。我相信这是因为 C 函数具有预期为 64 位的参数类型。

这是C函数的签名

```
int doFlightCalc_S(double LatA, 
                   double LonA, 
                   double LatB, 
                   double LonB, 
                   int month, 
                   int aircraftCd, 
                   int nbrPsgrs, 
                   int taxiInTm, 
                   int taxiOutTm, 
                   int fuelStopTime, 
                   int *results) 
```

这是从 C# 访问函数的定义

```
[DllImport("doFlightCalc.dll", CallingConvention = CallingConvention.Cdecl)]
        private static extern int doFlightCalc_S(
             [MarshalAs(UnmanagedType.R8)] double latA,
             [MarshalAs(UnmanagedType.R8)] double lonA,
             [MarshalAs(UnmanagedType.R8)] double latB,
             [MarshalAs(UnmanagedType.R8)] double lonB,
             [MarshalAs(UnmanagedType.I4)] int month,
             [MarshalAs(UnmanagedType.I4)] int aircraftCd,
             [MarshalAs(UnmanagedType.I4)] int nbrPsgrs,
             [MarshalAs(UnmanagedType.I4)] int taxiInTm,
             [MarshalAs(UnmanagedType.I4)] int taxiOutTm,
             [MarshalAs(UnmanagedType.I4)] int fuelStopTime,
            [MarshalAs(UnmanagedType.LPArray)] [Out] int[] results); 
```

如果我将 C dll 编译为 64 位 dll，同时保留函数原样，我需要对 C# 中的函数进行哪些更改？

我会假设我必须将 I4s 更改为 I8s，但是我会用什么类型替换 int 和 double 呢？将以下内容：

```
 [MarshalAs(UnmanagedType.R8)] double lonB,
             [MarshalAs(UnmanagedType.I4)] int month, 
```

改为：

```
 [MarshalAs(UnmanagedType.R8)] (what would go here?) lonB,
             [MarshalAs(UnmanagedType.I8)] long (is long correct here?) month, 
```

还是我在叫错树？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:18:34.077

编译 64 位时根本不需要进行任何更改。C 和 C# 版本在 32 位和 64 位上相互匹配。

您似乎认为 C int 在 Windows 上的 64 位代码中是 8 字节宽。它不是。它有 4 个字节宽。

您可以删除所有 MarshalAs 属性，因为它们只是重新声明默认编组。

从 32 位操作系统切换到 64 位操作系统似乎不太可能真的是造成差异的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:08:50.320

根据 MSDN 页面（[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.unmanagedtype.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.unmanagedtype.aspx)），枚举`UnmanagedType.I8`对应于一个 8 字节有符号整数，或者在 C#`System.Int64`中具有别名`long`. 我个人的偏好是始终使用结构类型名称`Int64`而不是别名，因为它只会让我想到可移植 C89 中的糟糕编程，其中`long`可能意味着 32 位或 64 位整数。

同样，`R8`是一个 8 字节的浮点数。类型`System.Double`对应于该成员。

```
[MarshalAs(UnmanagedType.R8)] Double lonB,
[MarshalAs(UnmanagedType.I8)] Int64 month, 
```

或者这个，取决于你的编码风格偏好

```
[MarshalAs(UnmanagedType.R8)] double lonB,
[MarshalAs(UnmanagedType.I8)] long month, 
```

但是我不明白为什么 64 位会有所不同，除非参数需要指针类型（因为这是 32 位和 64 位系统之间唯一应该不同的原始类型）。

**编辑**：忽略我的回答：我没有完全阅读你的问题。如果 C 函数定义了`int`参数，那么无论编译它的平台是 32 位还是 64 位性质（假设两个版本都使用相同的编译器和操作系统），它们都将始终具有相同的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:09:51.190

`double`将保持为`double`. 在C# `double`中是64位实数，`R8`是64位实数。`long`在 C# 中是一个`Int64`所以这也是正确的类型。`I8`是一个 64 位无符号整数，和 long 一样。但是，没有理由使用`I8`，因为 C 代码中的值都是 32 位整数（C int == I4 == C# int）。

# backbone.js - 使用 StackMob.Model 而不是 Backbone.Model 时出现“未定义”

> ID：13635595
> 
> 赞同：1
> 
> 时间：2012-11-29T22:03:28.380
> 
> 标签：backbone.js, stackmob

我正在将 Backbone.js 和 StackMob 用于移动应用程序，但遇到了一个我无法理解的奇怪问题。根据 StackMob 文档，StackMob.Model 扩展了 Backbone.Model，因此可以访问相同的方法，并且应该以相同的方式工作。据我了解，这是一个简单的交换。

情况如下：

我有一个由对 FourSquare 的 API 调用填充的集合，该集合作为列表呈现到视图中。列表中的每个模型都使用 data-id 属性呈现：

```
 $("ul#resultsList").append("<li class='result' data-id='" + place.get('id') + "'><span class='listingName'>" + place.get("name") + "</span><span class='listingDetail'>" + place.get("location")["address"] + "</span><span class='listingDetail'>" + place.category + "</span></li>"); 
```

（上面的代码是循环构建列表的内容）。

该列表显示得很好，并且该端的所有内容都可以正常工作。然后，我将以下内容附加到每个列表项的单击事件中：

```
saveItem: function(e) {
    window.item = $(e.currentTarget).data("id");
    window.newplace = this.collection.get(window.item);
    console.log("New place: "+ window.newplace); //shows the model in Backbone, undefined in StackMob
    App.navigate("#add", {
        trigger: true
    });
}, 
```

这段代码主要查看点击的项目，然后获取 ID，然后根据 ID 在集合中查找该模型并将其存储到 window.newplace。

然后，应用导航到#add，它使用 window.newplace 作为模型来实例化视图：

```
addItem: function() {
    if (!window.newplace) {
    window.newplace = new Place({});
    }
    this.changePage(new AddItemView({model:window.newplace}), "slide");
}, 
```

**这是问题所在：**

当 Place 模型设置为 Backbone.Model 时，这完全可以正常工作。一旦我将它切换到 StackMob.Model，它就会将 window.newplace 显示为未定义。

我无法想象为什么切换这些会产生任何影响，但它似乎确实如此。

只是为了清楚起见，这里是使用 Stackmob.Model 时的模型：

```
window.Place = StackMob.Model.extend({
...
}); 
```

有任何想法吗？如果它根本不起作用，我会把它归结为一些非常愚蠢的事情，但由于它可以很好地扩展 Backbone，但不能很好地扩展 StackMob，我真的很困惑。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T01:41:23.680

好的，我想出了一个解决这个问题的方法。

这是交易。当我打电话`this.collection.get(window.item)`时，我正在寻找`Place`被点击对象的 ID 属性（因为我将该 ID 传递到 URL 中，点击时很容易检索）。

使用 Backbone，该 ID 显示为对象的根属性，位于 place.id。对于 StackMob，无论出于何种原因，它都不是。它存储在 Attributes 对象里面`Place`（就像你调用了 一样`place.set("id")`）。

因此，当我通过 ID 获取它时，StackMob 正在寻找对象上的根属性“id”，没有找到它，并返回“未定义”。

通过放入`this.id = this.get("id")`模型的初始化，我能够将它放到根目录并成功检索模型。

我仍然不确定为什么使用 Backbone 将 ID 设置在根目录，而不是 StackMob，但无论如何，至少有一个解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T00:52:54.020

在使用 StackMob.Model、StackMob.Collection 和其他 StackMob 项之前，您需要先调用 StackMob.init(..)。

在您调用 StackMob.init(..) 之前，您的外部脚本可能已被执行。

希望有帮助！

埃里克

# jquery - jQuery：添加多个动态值

> ID：13635596
> 
> 赞同：1
> 
> 时间：2012-11-29T22:03:54.927
> 
> 标签：jquery

**我想要实现的是：**

我有多个具有相同类但值不同的*td 。*

```
<td class="goals_238"> 3 </td>
<td class="goals_311"> 0 </td>
<td class="goals_128"> 1 </td>
<td class="goals_238"> 4 </td>
<td class="goals_238"> 3 </td> 
```

我想获取“goals_238”的值并将它们相加。

“goals_238”的最终结果将是 = 10

这整件事是针对运动成绩表的，因此是“目标”类。

我可以打印“goals_238”出现了多少次，但做数学对我来说完全是另一个层次。

```
var gamesPlayed = ( $('.goals_238').length );
$('p#goals_238').html(gamesPlayed); 
```

关于我将如何处理的任何线索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:09:01.333

```
var sum = 0;
$.each($('.goals_238'), function(i, e){
    sum += parseInt($(e).html());
}); 
```

# javascript - 如何通过getElementsbyClass将第二行设置为不同的颜色

> ID：13635598
> 
> 赞同：0
> 
> 时间：2012-11-29T22:04:10.697
> 
> 标签：javascript, html, jsp

我有以下代码：

```
<script type = "text/javascript">
function showColors() {

var cells = getElementsbyClass("design");
for (var i = 0, len = cells.length; i < len; ++i) {
    cells[i].style.backgroundColor = "#ddd";
}

}

if(document.getElementsByClassName) {

getElementsByClass = function(classList, node) {    
    return (node || document).getElementsByClassName(classList);
  };

 </script> 
```

```
<script type = "text/javascript">
window.onload = function() {

showColors();

  }
 </script>
table id="foo">
<tbody>
    <tr class = "design">
        <td>One</td><td>Two</td><td>Three</td>
    </tr>
    <tr class = "design">
        <td>One</td><td>Two</td><td>Three</td>
    </tr>
    <tr class = "design">
        <td>One</td><td>Two</td><td>Three</td>
    </tr>
</tbody>
 </table>
</body> 
```

我的问题：如何通过 getElementsbyClass() 将第二行设置为不同的颜色。您怎么看，实际代码不起作用:(。请不要使用JQuery或selectivizr。请留在示例中:)。我需要一个动态的例子。我知道css会工作！！！同样重要的是：它应该适用于所有浏览器！！

非常感谢您的回答:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:08:05.010

使用 CSS：

```
.design:nth-child(even){ background-color:#ddd } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:14:32.207

如果循环所做的唯一事情是更改背景颜色，则`i`每次只需添加 2 而不是使用以下值递增`++`：

```
var cells = document.getElementsByClassName("design");
for (var i = 0, len = cells.length; i < len; i+=2) {
   cells[i].style.backgroundColor = "#ddd";
} 
```

演示：http: [//jsfiddle.net/ytCZa/](http://jsfiddle.net/ytCZa/)

如果循环需要为每一行做其他事情，那么只需`i`在设置颜色之前使用模运算符测试是否可被 2 整除：

```
if (i % 2 === 0)
   cells[i].style.backgroundColor = "#ddd"; 
```

但是请注意，您有一个错字：您`getElementsbyClass`在调用函数时用小写“b”拼写了函数，但在定义它时用大写“b”拼写，这不起作用，因为 JS 区分大小写。该`if`声明也缺少结束语`}`。

在上面的代码和演示中，我根本没有使用你的`getElementsByClass`函数：它不做任何不做的事情`getElementsByClassName`，它依赖于`getElementsByClassName`工作，所以你不需要它。如果出于某种原因你*真的*想要它，这里有一个演示，我已经修复了代码以使其工作：http: [//jsfiddle.net/ytCZa/1/](http://jsfiddle.net/ytCZa/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:18:31.573

希望这对你有帮助！

乐。这个更好

```
<!DOCTYPE html>
<html>
<script type = "text/javascript">
    function showColors() {
        var cells = document.getElementsByClassName("design");
        for (var i = 0, len = cells.length; i < len; ++i) {
            if (i % 2 == 0)
            {
                cells[i].style.backgroundColor = "#ddd";
            }
            else
            {
                cells[i].style.backgroundColor = "#aaa";
            }
        }
    }
    if(document.getElementsByClassName) {
        getElementsByClass = function(classList, node) {    
            return (node || document).getElementsByClassName(classList);
        };
    };

window.onload = function(){
    showColors();
}
 </script>
<body>
    <table id="foo">
        <tbody>
            <tr class = "design">
                <td>One</td><td>Two</td><td>Three</td>
            </tr>
            <tr class = "design">
                <td>One</td><td>Two</td><td>Three</td>
            </tr>
            <tr class = "design">
                <td>One</td><td>Two</td><td>Three</td>
            </tr>
        </tbody>
    </table>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T22:26:52.090

为什么不获取 tbody 元素，遍历 TR 元素并添加更改类，如下所示：

```
var i
  , current
  , rows = document.getElementById('table-body').getElementsByTagName('tr');

for(i = 0; i < rows.length; i++) {
  current = current !== 'class1' ? 'class1' : 'class2';
  rows[i].setAttribute('class', current);
} 
```

​</p>

您可以在 js-fiddle 看到一个工作示例：http: [//jsfiddle.net/VF3Ay/3/](http://jsfiddle.net/VF3Ay/3/)

# vba - 从 VBA 中的另一个子例程中抑制 MsgBox

> ID：13635599
> 
> 赞同：5
> 
> 时间：2012-11-29T22:04:13.703
> 
> 标签：vba, msgbox

我有一个 VBA 子程序，它调用由其他人编写的子程序。偶尔，另一个子会打开一个带有 OK 按钮的 MsgBox。另一个 sub 需要很长时间才能运行，我调用了数百次，所以我希望能够在一夜之间运行它。不幸的是，我想不出一种方法来自动单击 MsgBox 上的 OK。

我努力了

```
Application.DisplayAlerts = False 
```

但这不会抑制消息框。

有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T07:59:56.450

一种方法是稍微修改原始 sub 的代码。您将需要获得必要的权限...

*   通过在末尾添加一个额外的可选参数来修改原始 sub 的标题，将默认值设置为`True`. 这将导致类似于`Sub OriginalSubName(`原始参数集的结果`, Optional ShowMessages = True)`
*   在调用 msgbox 的地方，这样修改代码：

    ```
    If showMessages = True Then 'The = True part is important here - see below.
    showMessages is a Variant type
        'The original statement that calls the msgBox
    End If 
    ```

*   保留原始子的其余代码不变

*   `False`通过作为额外参数输入来修改调用原始 sub 的行。这将导致`OriginalSubName`您的参数集`, False`。这样，默认情况下您不会抑制对话框，但是当您在子中使用它时会这样做。

想知道为什么我使用可选的 Variant 类型参数吗？

*   可选部分：这可以防止其他现有的 sub 在调用修改后的 sub 时崩溃
*   Variant 类型部分：可选参数始终是 Variant 类型。这也是为什么您需要使用`If showMessages = True Then`而不仅仅是`If showMessages Then`.

# view - 从命令的Handler获取启动View

> ID：13635602
> 
> 赞同：-1
> 
> 时间：2012-11-29T22:04:35.067
> 
> 标签：view, command, handler, jface, treeviewer

我有一定的看法。

在这个视图中有一个 TreeViewer。

当我右键单击树的一个元素时，我会打开触发“重命名”命令的上下文菜单。

在这个命令的 HANDLER 中，如何获取被选元素的视图 ID？

有可能得到它吗？

非常感谢大家解答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T07:00:37.377

见[`HandlerUtil`](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/handlers/HandlerUtil.html)。在此示例中，由于您右键单击视图中的元素，它应该会变为活动状态，您可以使用

```
HandlerUtil.getActivePartId(e); 
```

# batch-file - 为 MSBuild 使用变量时，AssemblyInfo 不起作用

> ID：13635608
> 
> 赞同：0
> 
> 时间：2012-11-29T22:05:24.627
> 
> 标签：batch-file, msbuild, assemblyinfo, msbuildextensionpack

我有以下行很好用

```
<AssemblyInfo AssemblyInfoFiles="$(MSBuildProjectDirectory)\DesktopAgent\properties\AssemblyInfo.cs" 
              AssemblyCopyright="Copyright 2012 Alpine Access" 
              AssemblyVersion="1.0.0.56"
              AssemblyFileVersion="1.0.0.56">
</AssemblyInfo> 
```

我尝试像这样输入线路，但这不起作用

```
<AssemblyInfo AssemblyInfoFiles="$(MSBuildProjectDirectory)\DesktopAgent\properties\AssemblyInfo.cs" 
              AssemblyCopyright="Copyright 2012 Alpine Access" 
              AssemblyVersion="$(VersionNumber)"
              AssemblyFileVersion="$(VersionNumber)">
</AssemblyInfo> 
```

我的 assemblyinfo 文件中的版本号是 1.0.0.32 所以在第一种情况下，我实际上看到它发生了变化，但第二种情况不起作用:(。

我有一个 bat 文件，里面有这一行

```
msbuild /property:version=%1;anotherProperty=value project.build 
```

我像这样运行命令

```
build.bat 1.0.0.61 
```

它不起作用:(。有什么想法为什么在使用属性时会中断？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T05:54:29.193

`VersionNumber`必须在项目文件中定义为属性：

```
 <PropertyGroup>
    <!-- properties -->
    <VersionNumber Condition="'$(VersionNumber)' == ''">1.0.0.0</VersionNumber>
  </PropertyGroup> 
```

然后该命令必须设置相同的属性：

```
msbuild your.csproj /property:VersionNumber=%1 
```

# c#-4.0 - 从 IEnumerable 对象列表创建逗号分隔列表

> ID：13635609
> 
> 赞同：0
> 
> 时间：2012-11-29T22:05:31.807
> 
> 标签：c#-4.0

我有以下代码：

```
IEnumerable<token> token;
token = abc.GetToken(bcd); // this gets a list of guid tokens. 
```

我需要从中获取所有令牌，并将其转换为逗号分隔的列表。像 guid1、guid2、guid2 ... 是否有单行代码可以做到这一点？或者我将不得不遍历 IEnumerable 列表并将其添加为字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T22:07:20.523

也许？

```
string csv = string.Join(",", token); 
```

假设您的课程`token`已相应地被覆盖`ToString`。

# sql - 从 SQL Server 中的 group by 中获取第一个或最重复的值

> ID：13635614
> 
> 赞同：0
> 
> 时间：2012-11-29T22:05:58.263
> 
> 标签：sql, sql-server

我有一个丑陋的表格，其中包含来自我无法控制的来源的代码和名称，就像这个（OriginalTable）：

```
Code    | Name
--------------------
001-001 | Name1_a
001-002 | Name1_a
001-002 | Name1_b
001-003 | Name1_a
002-001 | Name2_a
002-001 | Name2_b
002-002 | Name2_a
003-001 | Name3
... 
```

问题是我需要每个代码（SmallCode）的前 3 位数字的唯一名称，如下表所示：

```
Id  | Code  | Name
--------------------
1   | 001   | NameX
2   | 002   | NameY
3   | 003   | NameZ 
```

我想用于选择名称的标准是它应该是每个 SmallCode 中重复次数最多的名称或第一个名称。例如，NameX 是所有以 001 或第一个开头的代码中重复次数最多的名称（在这两种情况下都是 Name1_a）。与 002 的 NameY 和 003 的 NameZ 相同。

现在我正在使用这个查询：

```
select Substring(Code,1,3) as SmallCode, Code, Name
into #tmpCode
from OriginalTable

select SmallCode, Min(Code) as Code
into #tmpReducedCode
from #tmpCode
group by SmallCode

insert into ResultTable (Code, Name)
select a.SmallCode, a.Name
from #tmpCode a
    inner join #tmpReducedCode b
        on a.Code = b.Code 
```

但这是我的结果，这是错误的，因为代码 002-001 (Name2_a, Name2_b) 有 2 个不同的名称

```
1   | 001   | Name1_a
2   | 002   | Name2_a
3   | 002   | Name2_b
4   | 003   | Name3 
```

所以问题是：如何将 OriginalTable 分成这两个表，为每个小代码选择最重复或第一次出现的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:24:38.717

对于第一个表：

```
select Substring(Code,1,3) as SmallCode, Code, Name
into #tmpCode
from OriginalTable

select SmallCode, Name
into #tmpReducedCode
from (
    select SmallCode, Name, row_number() over (partition by SmallCode order by Total desc) rn
    from (
        select SmallCode, Name, count(*) Total
        from #tmpCode
        group by SmallCode, Name) x) y
where rn=1;

select distinct a.SmallCode, b.Name
from #tmpCode a
    inner join #tmpReducedCode b
        on left(a.Code,3) = b.SmallCode 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:36:29.830

为每个代码运行子查询：

```
select distinct substring(Code,1,3) as "Code", 
    (select top 1 Name
    from OrginalTable tab2
    where substring(tab2.Code,1,3)=substring(tab1.Code,1,3)
    group by substring(Code,1,3), Name 
    order by count(Name) desc) as "Name"
from OrginalTable tab1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T23:05:14.203

我认为最好的方法是使用窗口函数：

```
select cast(LEFT(code, 3) as int) as id,
       RIGHT(code, 3) as code,
       name
from (select cn.*, ROW_NUMBER() over (partition by code order by cnt desc) as seqnum
      from (select code, name, COUNT(*) as cnt
            from OriginalTable ot
            group by code, name
           ) cn
     ) cn
where seqnum = 1 
```

这假设您使用的是 SQL Server 2005 或更新的版本。

# c++ - 如何使用 SOCI 从数据库中获取整行到用户定义的对象类型？

> ID：13635616
> 
> 赞同：5
> 
> 时间：2012-11-29T22:06:03.557
> 
> 标签：c++, soci

我扩展了我的课程（来自这个问题：[How to get a whole row from database using SOCI?](https://stackoverflow.com/questions/13633580/how-to-get-a-whole-row-from-database-using-soci/)）拥有两个私有成员，还添加了 getter 和 setter。但是在编译我的程序时，我又遇到了错误。

**我的类.h**

```
#include <soci.h>
#include <postgresql/soci-postgresql.h>
#include <string>

class MyClass
{
public:
    MyClass();
    MyClass(int i, std::string);

    void setI(int i);
    int getI() const;
    void setS(std::string s);
    std::string getS() const;

private:
    int i_;
    std::string s_;
};

namespace soci
{
    template <>
    struct type_conversion<MyClass>
    {
        typedef MyClass base_type;

        static void from_base(int i, std::string s, soci::indicator ind, MyClass & mi)
        {
            if (ind ==  soci::i_null)
            {
                throw soci_error("Null value not allowed for this type");
            }

            mi.setI(i);
        mi.setS(s);
        }

        static void to_base(const MyClass & mi, int & i,  std::string &s, soci::indicator & ind)
        {
            i = mi.getI();
        s = mi.getS();
            ind = soci::i_ok;
        }
    };
} 
```

**我的类.cpp**

```
#include "myClass.h"

MyClass::MyClass()
{

}

MyClass::MyClass(int i, std:string s)
{
    this->i_ = i;
    this->s_ = s;
}

int MyClass::getI() const
{
    return this->i_;
}

void MyClass::setI(int i)
{
    this->i_ = i;
}

std::string MyClass::getS() const
{
    return this->s_;
}

void MyClass::setS(std::string s)
{
    this->s_ = s;
} 
```

**我的ClassTest.cpp**

```
#include <iostream>
#include "myClass.h"

int main(int argc, char **argv)
{

    soci::session sql;
    sql.open(soci::postgresql, "dbname=mydb user=postgres password=postgrespass");
    MyClass i;
    sql << "SELECT id, name FROM person;", soci::into(i);
    std::cout << i.getI() << " " << i.getS();
    sql.close();

    return 0;
} 
```

我这样编译它：

> g++ myClassTest.cpp myClass.h myClass.cpp -o App -lsoci_core -lsoci_postgresql -ldl -lpq -I /usr/local/include/soci -I /usr/include/postgresql

我得到的错误是：

```
In file included from /usr/local/include/soci/into-type.h:13:0,
                 from /usr/local/include/soci/blob-exchange.h:12,
                 from /usr/local/include/soci/soci.h:18,
                 from myClass.h:1,
                 from myClassTest.cpp:2:
/usr/local/include/soci/exchange-traits.h: In instantiation of ‘soci::details::exchange_traits<MyClass>’:
/usr/local/include/soci/into.h:29:60:   instantiated from ‘soci::details::into_type_ptr soci::into(T&) [with T = MyClass, soci::details::into_type_ptr = soci::details::type_ptr<soci::details::into_type_base>]’
myClassTest.cpp:27:65:   instantiated from here
/usr/local/include/soci/exchange-traits.h:35:5: error: incomplete type ‘soci::details::exchange_traits<MyClass>’ used in nested name specifier
In file included from /usr/local/include/soci/into.h:13:0,
                 from /usr/local/include/soci/soci.h:22,
                 from myClass.h:1,
                 from myClassTest.cpp:2:
/usr/local/include/soci/type-conversion.h: In member function ‘void soci::details::conversion_into_type<T>::convert_from_base() [with T = MyClass]’:
myClassTest.cpp:34:1:   instantiated from here
/usr/local/include/soci/type-conversion.h:59:9: error: no matching function for call to ‘soci::type_conversion<MyClass>::from_base(soci::type_conversion<MyClass>::base_type&, soci::indicator&, MyClass&)’
/usr/local/include/soci/type-conversion.h:59:9: note: candidate is:
myClass.h:28:21: note: static void soci::type_conversion<MyClass>::from_base(int, std::string, soci::indicator, MyClass&)
myClass.h:28:21: note:   candidate expects 4 arguments, 3 provided
myClass.cpp:8:28: error: found ‘:’ in nested-name-specifier, expected ‘::’ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-01T09:59:54.727

你试过 SOCI 3.2 吗？我对这个版本做了类似的事情，效果很好：

```
vector<Entry> Entry::findByName(string name) {

    Entry entry;

    vector<Entry> entries;

    //Starting a connection to database
    session sql(firebird, "service=/srv/firebird/registry.gdb user=SYSDBA password=password");

    //Querying data using a prepared statement and place data into a Entry object
    statement st = (sql.prepare <<
                "select NAME, ADDRESS, PHONE from ENTRY WHERE NAME like '%' || :NAME || '%'",
                into(entry), use(name));
    st.execute();

    //Checking if we can fetch a row from resultset
    while (st.fetch())
    {
        //Pushing the object with mapped data into the entries vector
        entries.push_back(entry);
    }

    return entries;
} 
```

您可以将其更改为：

```
Entry Entry::findByName(string name) {

    Entry entry;

    //Starting a connection to database
    session sql(firebird, "service=/srv/firebird/registry.gdb user=SYSDBA password=password");

    //Querying data using a prepared statement and place data into a Entry object
    statement st = (sql.prepare <<
                "select NAME, ADDRESS, PHONE from ENTRY WHERE NAME like '%' || :NAME || '%'",
                into(entry), use(name));
    st.execute();

    //Checking if we can fetch a row from resultset
    if (st.fetch())
    {
        return entry;
    }

    return NULL;
} 
```

注意：它们都是我的模型类的静态类，它实现了 ActiveRecord 的自定义版本。

# ios - 如何更好地初始化字符串以避免死存储

> ID：13635626
> 
> 赞同：0
> 
> 时间：2012-11-29T22:06:54.313
> 
> 标签：ios, xcode, cocoa-touch, nsstring, dead-code

我发现了一些*这样*的问题，但我找不到这个特定的问题。我有许多初始化为的字符串

```
NSString *string = [[NSString alloc] init]; 
```

然后根据 if/else 块的结果为其分配一个值：

```
if ([anotherThing isEqualToString:@"boogers"]) {
    string = [NSString stringWithFormat:@"some characters"];
} else {
    string = [NSString stringWithFormat:@"some _other_ characters"];
} 
```

然后`string`在该方法的后面使用。

我怎样才能做到这一点，而不会在 alloc/init 阶段留下一个死存储？如果我在 if （或 else ）内分配，当我需要它的时候，字符串已经消失了几行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T22:09:25.147

你不必在第一行初始化字符串——你只需要声明它：

```
NSString *string = nil;
if ([anotherThing isEqualToString:@"boogers"]) {
    string = @"some characters";
} else {
    string = @"some _other_ characters";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:21:55.333

[NSString stringWithFormat:] 将为您初始化一个新的 NSString 对象，基本上您所做的是每次声明一个新对象，只需将字符串的指针设置为 NSSTring *someString, *someOtherString, *allTheStringsYouNeed; 然后使用任何类方法来初始化它甚至@“Characters”；将在编译器在运行时为您执行此操作时正常工作。

# php - PHPExel 创建 XLS 重载内存

> ID：13635633
> 
> 赞同：2
> 
> 时间：2012-11-29T22:07:12.113
> 
> 标签：php, phpexcel

我需要知道在使用 PHPEXEL 创建 XLS 时是否有减少内存使用的方法。这些文件大约有 15000 行。

我有这个脚本：

```
 $payroll_incomes = $payroll_incomes->execute(null, Doctrine::HYDRATE_ARRAY);
$objPHPExcel->getActiveSheet()->fromArray($payroll_incomes[0], null, 'A1');

// Rename worksheet

$objPHPExcel->getActiveSheet()->setTitle('INGRESOS');

// Set active sheet index to the first sheet, so Excel opens this as the first sheet

$objPHPExcel->setActiveSheetIndex(0);

// Redirect output to a client’s web browser (Excel5)

header('Content-Type: application/vnd.ms-excel');

header('Content-Disposition: attachment;filename="Ingresos.xls"');

header('Cache-Control: max-age=0');

$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');

$objWriter->save('php://output') 
```

当我运行此脚本时，我收到此消息

```
Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 20 bytes) in /var/www/payroll/plugins/sfPhpExcelPlugin/lib/PHPExcel/PHPExcel/Worksheet.php on line 962 
```

谢谢！！

**更新**

我添加了这行代码：

```
$cacheMethod = PHPExcel_CachedObjectStorageFactory::cache_to_phpTemp;

$cacheSettings = array( ' memoryCacheSize ' => '10KB');

PHPExcel_Settings::setCacheStorageMethod($cacheMethod, $cacheSettings);

$objPHPExcel = new PHPExcel(); 
```

所以它的工作非常出色:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T07:24:35.360

首先查看 PHPExcel 文档中有关单元缓存的部分：这是一种在处理较大的电子表格时减少 PHPExcel 内存需求的方法，并且正是为此目的而实现的。

# jquery - css: make ":after content" 在所有浏览器中可点击

> ID：13635634
> 
> 赞同：1
> 
> 时间：2012-11-29T22:07:16.593
> 
> 标签：jquery, html, css

如何使 css`"content:"`在所有浏览器中都可点击？它适用于 Firefox、IE，但不适用于 Chrome。

***HTML***

```
<div class="letters" id="letter_b">B<a id="success_b"></a></div> 
```

***CSS***

```
.letters a:after {
    color: #303030;
    content: "clickable text";
    font-weight: 500;
    margin-left: 15px;
    width: 200px
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:12:16.163

使链接`<a>`显示为`inline-block`元素 - [**DEMO**](http://jsfiddle.net/5WQJE/)

# api - google maps api 获取国家和城市

> ID：13635638
> 
> 赞同：8
> 
> 时间：2012-11-29T22:07:36.103
> 
> 标签：api, google-maps, google-maps-api-3

我可以使用 ajax 自动完成以从谷歌地图 api 获取国家/地区吗？当有人键入“United”以在该国家/地区的谷歌地图 api 上搜索并显示类似的结果时？

你能给我举个例子，或者链接到谷歌地图 api 的解决方案吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-30T22:57:22.040

看看[Google Places Autocomplete API](https://developers.google.com/places/documentation/autocomplete)。这是一篇[博文，可助您一臂之力](http://googlegeodevelopers.blogspot.com/2012/05/faster-address-entry-with-google-places.html)。

# javascript - 使用 JQuery 设置输入项的大小

> ID：13635643
> 
> 赞同：0
> 
> 时间：2012-11-29T22:07:50.823
> 
> 标签：javascript, jquery

有以下代码：

```
$(".translated").mouseenter(function(){
    if ($(this).hasClass("editable")){
        return;
    }
    var h=$(this).height();
    var w=$(this).width();
    $(this).empty();
    $("<input/>", {
        type: "text",
        height:h,
        width:w,
        value:$(this).text()
        }).appendTo(this);
    $(this).height(h);
    $(this).width(w);
    $(this).addClass("editable");
}); 
```

此代码从`<div>`容器中删除文本并将`<input>`项目插入其中。但是有一个问题：尽管 和 的值不同，但新项目的`<input>`高度大于容器。我该如何解决？ `<div>``h``w`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:22:56.770

您需要计算元素的边框和填充占用了多少额外空间`<input>`，然后从容器的高度中减去`<div>`。这将为您提供设置`<input>`元素所需的实际高度：

```
var h = $(this).height(); // The height of the container <div>
//...
var $newInput = $("<input/>", { type: "text", value:$(this).text()}).appendTo(this);
var fullHeight = newElem.outerHeight();
var innerHeight = newElem.height();
var paddingEtc = fullHeight - innerHeight;
$newInput.height(h - paddingEtc); 
```

您可能也必须遵循相同的方法来设置宽度`<input>`。

你可以看到它在这里工作（目前只有高度）：http: [//jsfiddle.net/XrGxx/](http://jsfiddle.net/XrGxx/)

# process - 如何使用 vbscript 暂停/恢复进程

> ID：13635645
> 
> 赞同：2
> 
> 时间：2012-11-29T22:07:59.137
> 
> 标签：process, vbscript, resume, suspend

有没有办法使用 vbscript 暂停和恢复进程？目前我创建了一个输入框来终止进程但不是终止它有没有办法暂停它？

```
'Terminate all processes involving the name <strProcessToKill>
Option Explicit
Dim strComputer, strProcessToKill, objWMIService, colProcess, objProcess

strComputer = "."
strProcessToKill = InputBox("Process to kill","Userinput")
Set objWMIService = GetObject("winmgmts:" _ 
   & "{impersonationLevel=impersonate}!\\" _ 
   & strComputer _ 
   & "\root\cimv2") 
Set colProcess = objWMIService.ExecQuery _
   ("Select * from Win32_Process Where Name = '" & strProcessToKill & "'")
For Each objProcess in colProcess
   msgbox "... terminating " & objProcess.Name
   objProcess.Terminate()
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T21:49:54.213

AFAIK，您无法通过脚本 API 暂停或恢复 VBScript 的进程。您必须[`pssuspend`](http://technet.microsoft.com/en-us/sysinternals/bb897540)为此类任务付出类似的代价。

# c++ - 链表上的 Ostream 重载运算符

> ID：13635652
> 
> 赞同：0
> 
> 时间：2012-11-29T22:08:19.553
> 
> 标签：c++

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:26:54.233

I think it's your declarations which are causing the problem:

```
friend ostream & operator << (ostream & out, const term & object); 
```

and

```
ostream & operator << (ostream & out, const Polynomial & object); 
```

These don't match. One is using a `term` object and the latter is using a `Polynomial` object. I'm assuming you want this function to use a term object because the function uses data memebers specific to the struct `term`. So change the latter to accept a `term` object:

```
ostream & operator << (ostream & out, const term & object); 
```

# java - 需要帮助修复我的 Java 代码，将字母电话号码转换成它们的完整号码等价物

> ID：13635658
> 
> 赞同：0
> 
> 时间：2012-11-29T22:08:34.957
> 
> 标签：java

该程序的目标是让它接受一个电话号码，如 1-800Flower，并将其更改为相当于电话键盘的号码，如 1-8003569377 我似乎无法正确地将字母转换为数字。

```
import java.util.Scanner;  
public class Phonekeypad 
{
  public static int getNumber (char uppercaseLetter)
  {  
     int k = 0;
     switch (uppercaseLetter) 
     {
        case 65: k = 2;
        break;
        case 66: k = 2;
        break;
        case 67: k = 2;
        break;
        case 68: k = 3;
        break;
        case 69: k = 3;
        break;
        case 70: k = 3;
        break;
        case 71: k = 4;
        break;
        case 72: k = 4;
        break;
        case 73: k = 4;
        break;
        case 74: k = 5;
        break;
        case 75: k = 5;
        break;
        case 76: k = 5;
        break;
        case 77: k = 6;
        break;
        case 78: k = 6;
        break;
        case 79: k = 6;
        break;
        case 80: k = 7;
        break;
        case 81: k = 7;
        break;
        case 82: k = 7;
        break;
        case 83: k = 7;
        break;
        case 84: k = 8;
        break;
        case 85: k = 8;
        break;
        case 86: k = 8;
        break;
        case 87: k = 9;
        break;
        case 88: k = 9;
        break;
        case 89: k = 9;
        break;
        case 90: k = 9;
        break;        
    }
     return k;
  }

public static void main(String[] args) 
{ 
     String s;
     System.out.println("Enter a string: ");
     Scanner input = new Scanner(System.in);
     s = input.next().toUpperCase();
     for (int i=0; i<s.length(); i++)
     {
         char c = s.charAt(i);
        // Is this a letter?
         if (Character.isLetter(c))
         { 
            int n;
            n = getNumber(c);
            char cn = 0;
            switch (n)
            {
             case 2: cn = '2';
             break;
             case 3: cn = '3';
             break;
             case 4: cn = '4';
             break;
             case 5: cn = '5';
             break;
             case 6: cn = '6';
             break;
             case 7: cn = '7';
             break;
             case 8: cn = '8';
             break;
             case 9: cn = '9';
             break;
            }
            s.replace(c, cn);
         }
     }
         System.out.println(s);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:16:02.490

你需要改变

```
 s.replace(c, cn); 
```

至

```
 s = s.replace(c, cn); 
```

否则字符串`s`将不会被更新。这背后的原因是在Java 中所有字符串都是不可变的（即它们不能改变）。每当您“更改”一个字符串时，您真正要做的就是创建两个字符串并交换它们的引用。replace() 知道这一点。这就是为什么不修改作为参数传递的字符串的原因。相反，replace() 返回一个新字符串，该字符串表示已替换字符的字符串“s”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:20:41.207

查看dreamcrash 的解决方案。无关，您可以通过组合案例语句来简化一些代码。例如，而不是

```
case 65: k = 2;
break;
case 66: k = 2;
break;
case 67: k = 2;
break; 
```

你可以有

```
case 65:
case 66:
case 67: k = 2;
break; 
```

# django - 使用 Solr 和 Haystack 进行拼写检查未显示任何结果

> ID：13635660
> 
> 赞同：3
> 
> 时间：2012-11-29T22:08:46.697
> 
> 标签：django, solr, spell-checking, django-haystack

我们的 Solr 构建的功能是

```
 http://192.168.1.106:8983/solr/spell?q=query&spellcheck=true&spellcheck.build=true 
```

确实根据我们基于索引的字典成功返回拼写建议

然而 django-haystack 变量 {{suggestion}} 甚至 python 命令 SearchQuerySet().spelling_suggestion("query") 返回“None”。

我们使用 haystack 提供的标准视图和 url。

安装应用程序是 Python 2.7.2、Django 1.3.2、Haystack 2.0、Apache Solr 3.6.1（在标准 Jetty 上运行）、PySolr 2.1。

这是我们正在使用的一些代码：

在 settings.py

```
 HAYSTACK_CONNECTIONS = {
        'default': {
           'ENGINE': 'haystack.backends.solr_backend.SolrEngine',
           'URL': 'http://192.168.1.106:8983/solr',
           'INCLUDE_SPELLING': True,
        },
    } 
```

在 /PATH/TO/SOLR/example/solr/conf/solrconfig.xml 中：

```
 <searchComponent name="spellcheck" class="solr.SpellCheckComponent">
      <str name="queryAnalyzerFieldType">textSpell</str>
        <lst name="spellchecker">
          <str name="name">default</str>
          <str name="field">text</str>
          <str name="spellcheckIndexDir">spellchecker</str>
        </lst>
      </searchComponent>

      <requestHandler name="/spell" class="solr.SearchHandler" startup="lazy">
        <lst name="defaults">
          <str name="df">text</str>
          <str name="spellcheck.onlyMorePopular">false</str>
          <str name="spellcheck.extendedResults">false</str>
          <str name="spellcheck.count">10</str>
        </lst>
        <arr name="last-components">
          <str>spellcheck</str>
        </arr>
      </requestHandler> 
```

所以问题是：代码中的问题在哪里导致已安装的应用程序“干草堆”无法与 Solr 找到的拼写建议的结果进行通信？或者换句话说，为什么 haystack 没有显示拼写建议，而 Solr 提供了一些拼写建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T18:42:45.220

您是否在 Django 设置文件的 CONNECTIONS 中将 INCLUDE_SPELLING 设置定义为 True？[http://django-haystack.readthedocs.org/en/latest/searchqueryset_api.html#spelling-suggestion](http://django-haystack.readthedocs.org/en/latest/searchqueryset_api.html#spelling-suggestion)

可能有帮助的一件事是查看 Haystack 发送给 Solr 的确切内容。您可以在搜索功能的 Haystack 的 backends/solr_backend.py 中的 SolrBackend 类中添加打印语句，以便您可以看到正在使用的 URL。这至少会告诉你 Haystack 是否按顺序执行搜索建议。

您可能还想直接从 Github 存储库检查 Haystack 更新。那里的发展[相当活跃](https://github.com/toastdriven/django-haystack/commits/master)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-28T08:22:58.627

我一直在努力解决这个错误，并且 spelling_suggestion 没有显示任何内容，直到我添加到请求处理程序“/select”组件拼写检查器。所以默认连接如上所述，'/select' 处理程序如下所示：

```
<requestHandler name="/select" class="solr.SearchHandler">
 <lst name="defaults">
   <str name="echoParams">explicit</str>
   <int name="rows">10</int>
   <str name="df">text</str>
 </lst>

 <arr name="last-components">
    <str>spellcheck</str>
 </arr> 
```

此外，我还在 search_indexes.py 中添加了我的 RestaurantIndex 的属性，例如：

```
#Suggestions - so obvious
suggestions = indexes.CharField()

def prepare(self, obj):
    prepared_data = super(RestaurantIndex, self).prepare(obj)
    prepared_data['suggestions'] = prepared_data['text']
    return prepared_data 
```

在这种情况下，“文本”将是您自己的建议字段。在此之后，在 python shell 中你可以执行这个并且结果会出现：

```
sqs = SearchQuerySet().auto_query('Restauront')

spelling = sqs.spelling_suggestion() 
```

我对此的建议是餐厅。

干杯!

PS：如果您需要额外的配置，请说出来。

# python - 未知选项：-B

> ID：13635663
> 
> 赞同：1
> 
> 时间：2012-11-29T22:09:09.373
> 
> 标签：python

我是该站点的新手，而不是经验丰富的程序员。我正在尝试在我的 mac（豹版 10.5.8）上安装文本对齐器。我以前在其他计算机上使用过该程序，没有任何困难。它需要安装`XCode`(done)、`SOX`(done) 和`HTK`(done)。但是，导航到适当的文件夹后，我输入命令：

```
$ ./align.py [audio data folder] 
```

并弹出此错误：

```
Unknown option: -B
usage: /System/Library/Frameworks/Python.framework/Versions/2.5/Resources/Python.app/Contents/MacOS/Python [option] ... [-c cmd | -m mod | file | -] [arg] ...
Try `python -h' for more information. 
```

所以我输入：

```
$ python -h 
```

这给了我一个选项列表，包括：

```
-B     : don't write .py[co] files on import; also PYTHONDONTWRITEBYTECODE=x 
```

就像我说的，我对编程世界很陌生，所以我不确定如何处理这些信息或如何解决问题。我尝试更新 python，即使我以前的版本（2.5.1）应该可以工作。我现在安装了 2.7.3。任何建议将不胜感激！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T00:40:55.337

可执行脚本的第一行称为“she-bang”。它告诉 shell 使用哪个解释器来运行以下代码。

运行 ./align.py 导致它中断的原因是，当您使用该表单时，您会告诉它使用第一行中指定的任何内容执行：

```
#!/usr/local/bin/python 
```

这表示要使用专门位于此位置的 python。通常你不想要一个明确的路径，因为如果它不是你系统上合适的python，它可能会导致问题（就像它对你所做的那样）。除非您有某些特定需求，否则更好的方法是允许它使用您自己的环境解析的任何 python：

```
#!/usr/bin/env python 
```

它在您运行时起作用：“python align.py”，因为现在您绕过了 shebang 行，并使用脚本作为第一个参数调用您自己的 python。这直接运行它。

我假设脚本的第一行包含指向错误 python 的 shebang 并包含 -B 标志。

# jquery - 在richtable中使用jquery显示/隐藏div

> ID：13635671
> 
> 赞同：0
> 
> 时间：2012-11-29T22:09:31.553
> 
> 标签：jquery, jsf, xhtml, richfaces

我有一个 Rich Faces 表，其中包含 div 中的数据。当您将鼠标悬停在 Richtable 行上的特定行上时，我想显示另一个 div，以显示与该记录关联的额外数据，并在使用 jquery 鼠标移出时隐藏一个 div。我可以使用 jquery 显示/隐藏 div。但问题是它显示/隐藏与每一行关联的每个 div 标签，而不是显示/隐藏特定行的 div。我如何确保只有鼠标悬停的行显示与其关联的 div 标签？

这是代码片段：

```
<s:div style="float:left; ">
  <rich:dataTable id="pendingOptyTbl" value="#{searchResultList}"
    var="item" style="border: none; float: left;width:100%;">  
      <rich:column style="border: none;">
          <s:div style="position:relative;height: 35px;">
            <s:div style="float:left; width: 700px; " >
               <a4j:outputPanel style="width: 700px;" onmouseout="jQuery('accountDetails').hide();"   onmouseover="jQuery('.accountDetails').show();">
                    <s:div>
                           <h:outputText value="#{searchController.getCapitalizeName(item.label)} : " >
                    </s:div>
               </a4j:outputPanel>
            </s:div>
        <s:div  style="float:left;top:-10px;right:80px; width:360px;position:absolute;" styleClass="searchDetailsClass">
                <a4j:outputPanel id="searchDetails" ajaxRendered="true" styleClass="accountDetails"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T12:52:00.453

也许不是最好的解决方案，但您可以尝试使用行索引的 jQuery id 选择器：

```
<h:form id="form">
    <rich:dataTable id="table" rowKeyVar="idx" ...>
        <rich:column>
        ...
            <a4j:outputPanel onmouseover="jQuery('#form\\:table\\:#{idx}\\:searchDetails').show();"
                onmouseout="jQuery('#form\\:table\\:#{idx}\\:searchDetails').hide();"> 
```

`<a4j:outputPanel id="searchDetails">`您可以使用 Firebug找出生成的 id 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T00:21:21.163

因此，我使用与 Vladimir 的答案类似的方法解决了这个问题，但我不是用 id 而是用 StyleClass 做的。我添加了 styleClass="detail-#{idx}" 并使用 onmouseover="jQuery('.detail-#{idx}').show();" 进行了搜索。这将使用 div 的样式类搜索元素。每个 div 都有不同的 styleclass，因为有一个行索引与之关联。我希望这将有助于将来的某人。仅供参考：使用 Vladimir 描述的 Id 对我不起作用。

# java - 缩放字符串以适合标签（Java，AWT）

> ID：13635674
> 
> 赞同：1
> 
> 时间：2012-11-29T22:09:38.897
> 
> 标签：java, text, awt

我必须编写应用程序，它可以根据整个框架的大小来缩放标签和按钮的字体大小。我的想法是增加字体的大小，直到整个文本适合标签或按钮。

如何检查所有字符串是否适合按钮/标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:27:18.930

类似于以下内容

```
JComponent c = ... // it can be label, button or any other component
FontMetrics fm = c.getFontMetrics(c.getFont()); // or another font
int strw = fm.stringWidth("My text"); 
```

[我从Getting string size in java (without a Graphics object available) 中](https://stackoverflow.com/questions/4914145/getting-string-size-in-java-without-having-a-graphics-object-available)拿了这个例子

# dependencies - 如何编写一个 pip 要求文件，使其不安装 beta 版本？

> ID：13635676
> 
> 赞同：4
> 
> 时间：2012-11-29T22:09:40.803
> 
> 标签：dependencies, versioning, pip

此刻，如果您这样做，`pip install nose-cov==1.6`您将安装以下软件包：

```
cov-core==1.7
coverage==3.6b1
nose==1.2.1
nose-cov==1.6 
```

不幸的是，这个包`coverage`似乎是一个 beta 版本，并且有点错误，覆盖率测试失败，而事实上我有 100% 的覆盖率。当我有一个 requirements.txt 文件列出了一堆包时，这尤其麻烦，每个包都可能在未来开始下载他们自己需求的 beta 版本。

有没有办法告诉`pip`避免测试版？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T14:46:50.023

目前看来这是不可能的。我被迫为倾向于在 pypi 上发布 beta 的软件包硬指定版本。

# c - int * 和 int [] 之间的实际区别是什么？

> ID：13635682
> 
> 赞同：1
> 
> 时间：2012-11-29T22:09:57.583
> 
> 标签：c, pointers

> **可能重复：**
> [数组名称是 C 中的指针吗？](https://stackoverflow.com/questions/1641957/is-array-name-a-pointer-in-c)

我将一个`int *`变量传递给一个定义为的函数，`func(int var[])`编译器抱怨从不兼容的指针类型传入参数。有什么区别，或者根本没有区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:12:01.510

所有类型的函数声明`R foo(T[])`和`R foo(T *)`都是相同的`T`。

你的错误在别处。

（您可以`foo`使用指向 a 的指针`T`或使用 s 数组的名称进行调用`T`，因为后者在调用期间会衰减为合适的指针。）

**例子：**

```
void foo(int *);
void bar(int[]);

void example(int * a)
{
    int n = 10;
    int p[] = { 1, 2, 3 };

    foo(a);     bar(a);
    foo(p);     bar(p);    // all those are OK
    foo(&n);    bar(&n);
} 
```

# session - 管理员会话用户编辑帖子

> ID：13635683
> 
> 赞同：0
> 
> 时间：2012-11-29T22:09:59.617
> 
> 标签：session, admin

在数据库中，我有一列`acc_type`as `int`，如果 $_SESSION['accountTpye']==1 然后允许该用户编辑其他用户的帖子，我正在尝试对此进行编码，

我应该使用 and 而不是 && 吗？” 或 , || ”。

示例代码：

```
if(isset($_SESSION['username']) && ($_SESSION['username']==$dnn2['author'] || $_SESSION['accc_type']==1['username'])) {
    echo "<a href='edit.php'>Edit</a>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:14:08.940

```
if((isset($_SESSION['username']) && $_SESSION['username']==$dnn2['author']) || $_SESSION['acc_type']==1){
    echo "<a href='edit.php'>Edit</a>";
} 
```

这部分没有意义：

```
$_SESSION['acc_type']==1['username'] 
```

如果您只是删除最后一个 ['username'] 然后将会话用户名部分包装为条件的第一部分，因此 acc_type 不依赖它，那么事情应该没问题

更新：

在您的 login.php 文件中找到此部分：

```
$req = mysql_query('select password,id from users where username="'.$username.'"');
$dn = mysql_fetch_array($req);
if($dn['password']==sha1($password) and mysql_num_rows($req)>0)
{
     $form = false;
     $_SESSION['username'] = $_POST['username'];
     $_SESSION['userid'] = $dn['id']; 
```

您还需要选择 acc_type。假设它是 users 表中的一个字段，修改查询以读取：

```
'select password,id, acc_type from users where username="'.$username.'"' 
```

然后确保设置会话变量：

```
 $form = false;
     $_SESSION['username'] = $_POST['username'];
     $_SESSION['userid'] = $dn['id'];
     $_SESSION['acc_type'] = $dn['acc_type']; 
```

当您对此进行测试时，请确保您注销然后重新登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:16:35.200

我认为这将解决您的问题：

```
if(isset($_SESSION['username']){

  if( ($_SESSION['username']==$dnn2['author']) || ($_SESSION['acc_type']==1)  ){
      echo "<a href='edit.php'>Edit</a>";
   } 
```

}

# google-apps-script - 从 UiApp 发布 Google Wallet 购物车

> ID：13635684
> 
> 赞同：0
> 
> 时间：2012-11-29T22:10:01.210
> 
> 标签：google-apps-script, google-checkout

我们使用 Google Apps Script / UiApp 编写了一个高度专业化的事件注册系统，数据由 Google Docs 电子表格和各种其他数据源提供支持。

我们的下一步是与 Google Wallet 集成，以便我们可以处理付款。用户将在基于 UiApp 的注册系统中开始注册，从而将他们的详细注册数据插入到电子表格中，但状态为待付款。然后，用户将单击“立即购买”按钮或链接以导航到 Google 电子钱包以完成付款。

有没有办法做到这一点？有没有人成功地将购物车从 UiApp 发布到 Google 钱包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T01:57:23.707

我自己从未尝试过，但请使用 Google 协作平台小工具查看[此示例。](https://developers.google.com/checkout/developer/Google_Checkout_Store_Gadget_How_To)一般来说，如果它在那里工作，它将与 Apps Script 一起工作。

不过，您可能需要转换到 HtmlServices .. 可能仅适用于启动 Wallet 调用的部分（Checkout 已更名为 Wallet）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T22:07:00.360

您可以使用锚点添加指向 UiApp 的链接作为解决方法。看到[这个答案。](https://stackoverflow.com/a/10745403/3169358)

基本上事情是：

```
 var link = app.createAnchor('A Link =D ',"http://your.link.com");
 app.add(link); 
```

希望它有帮助=)

# .net - 查看对象的所有属性和值（包括子对象）

> ID：13635694
> 
> 赞同：0
> 
> 时间：2012-11-29T22:10:47.903
> 
> 标签：.net, reflection, properties

我想知道.Net 中是否有一个内置功能可以（在运行时）输出给定对象中的所有属性和值，如果可能的话，甚至包括子对象。

我正在考虑 Reflection 或[XML Serializion](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)并看到[一些人提到 JSON](https://stackoverflow.com/questions/2730734/is-there-a-built-in-net-method-for-getting-all-of-the-properties-and-values-for)，但无法真正弄清楚如何以正确的方式做到这一点......有谁知道这是否可能是.Net中的内置功能或者是否有一个很好的例子/工具，要么已经这样做了，要么可以引导我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:18:39.770

使用[反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.80%29.aspx)。

要查看对象的所有公共属性和值：

```
foreach(var prop in obj.GetType().GetProperties()) //note: you can pass in binding flags to GetProperties to get static, private, etc properties
{
    var propVal = prop.GetValue(obj);

    //prop has information such as Name, PropertyType
    //propVal is the value of that property for obj
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:22:24.057

您可以使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/71s92ee1.aspx)类或查看[JSON.Net](http://json.codeplex.com/)框架。

# java - java中的旋转字符串数组

> ID：13635697
> 
> 赞同：2
> 
> 时间：2012-11-29T22:10:53.930
> 
> 标签：java, arrays, rotation, tetris

我将如何在 java 中为我正在制作的俄罗斯方块游戏旋转字符串数组。例如字符串数组

```
[
"JJJJ",
"KKKK",
"UUUU"
] 
```

会成为

```
[
"UKJ",
"UKJ",
"UKJ",
"UKJ"
] 
```

我可以使用此代码使用 char 矩阵来做到这一点

```
public char[][] rotate(char[][] toRotate)
{
    char[][] returnChar = new char[toRotate[0].length][toRotate.length];
    for(int rows = 0; rows<toRotate.length; rows++)
    {
        for(int cols = 0; cols<toRotate[0].length; cols++)
        {
            returnChar[cols][toRotate.length-1-rows]=toRotate[rows][cols];
        }
    }
    return returnChar;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:31:02.097

字符串在 Java 中是不可变的，因此您有几个选择

1.  为 rotate(char [][]) 编写一个包装器，将其转回字符串数组
2.  修改函数以从输入创建一个新的字符串数组
3.  创建一个数据结构，以最有效的格式保存数据，然后让 getter 以您想要的格式返回数据。

3本质上是您“应该”做的事情。在俄罗斯方块游戏中，您将创建一个游戏区域大小的矩阵（可能是填充的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:36:22.347

使用 Array String 类似于您所做的：

```
public static String[] rotate(String [] toRotate)
  {

      String [] returnChar = new String[toRotate[0].length()];
      String [] result = new String[toRotate[0].length()];
      Arrays.fill(returnChar, "");

      for(int rows = 0; rows<toRotate.length; rows++)
          for(int cols = 0 ; cols < toRotate[rows].length(); cols++)
              returnChar[cols] = returnChar[cols] + toRotate[rows].charAt(cols);

      for(int i = 0; i < returnChar.length; i++)
          result[i] =  new StringBuffer(returnChar[i]).reverse().toString();

      return result;
  } 
```

我遍历`char`每个`String`数组中的所有内容`toRotate`，将此字符（ ）连接到数组上的`toRotate[rows].charAt(cols)`每个字符串`returnChar[cols]``returnChar`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:31:35.253

该函数完成将字符串转换为的工作，`char[][]`以便您可以使用您的函数。

```
 public static String[] rotateString(String[] toRotate) {
    char[][] charStrings = new char[toRotate.length][];
    for(int i = 0; i < toRotate.length; i++) {
      charStrings[i] = toRotate[i].toCharArray();
    }

    // This is YOUR rotate function
    char[][] rotatedStrings = rotate(charStrings);
    String[] returnStrings = new String[rotatedStrings.length];
    for(int i = 0; i < rotatedStrings.length; i++) {
      returnStrings[i] = new String(rotatedStrings[i]);
    }

    return returnStrings;
  } 
```

# google-app-engine - 用于 Google Cloud SQL GAE 的 SmartGWT Hibernate 数据源设置

> ID：13635707
> 
> 赞同：0
> 
> 时间：2012-11-29T22:11:41.760
> 
> 标签：google-app-engine, smartgwt, google-cloud-sql, smartgwt-pro

我正在寻找一个项目示例，其中 SmartGWT Hibernate Datasouce 使用 GAE 作为服务器连接到 Google Cloud SQL 数据库。我会很惊讶成为这个世界上第一个尝试的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T17:28:21.160

我们建议改用 SQLDataSource（更简单、更快、更灵活）。Google 在此处记录了适当的 JDBC 设置：

[https://developers.google.com/appengine/docs/java/cloud-sql/developers-guide#use_with_lang](https://developers.google.com/appengine/docs/java/cloud-sql/developers-guide#use_with_lang)

SmartGWT 在此处记录了如何向 SQLDataSource 提供 JBDC 设置：

[http://www.smartclient.com/smartgwtee/javadoc/com/smartgwt/client/docs/SqlSettings.html](http://www.smartclient.com/smartgwtee/javadoc/com/smartgwt/client/docs/SqlSettings.html)

您将使用 MySQL 作为数据库类型，因为 CloudSQL 与 MySQL 兼容。

如果您选择使用 Hibernate，我们还没有尝试过，但大概可以为 Hibernate 提供相同的 JDBC 设置 - 请参阅 Hibernate 文档。

# ruby - Redis-RB 开箱即用，在本地抛出 ECONNREFUSED 错误

> ID：13635710
> 
> 赞同：3
> 
> 时间：2012-11-29T22:11:46.410
> 
> 标签：ruby, ruby-on-rails-3, redis

我添加`gem 'redis'`到我的 Gemfile。冉`bundle install`。重新启动本地服务器，然后在我的控制台中运行 hello world 示例，结果出现错误。知道有什么问题吗？

```
[kudo (develop)]$ rails console
Loading development environment (Rails 3.2.3)
1.9.3p125 :001 > redis = Redis.new
=> #<Redis client v3.0.2 for redis://127.0.0.1:6379/0> 
1.9.3p125 :002 > redis.set("mykey", "hello world")
Redis::CannotConnectError: Error connecting to Redis on 127.0.0.1:6379 (ECONNREFUSED)
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:268:in `rescue in establish_connection'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:263:in `establish_connection'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:69:in `connect'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:282:in `ensure_connected'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:173:in `block in process'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:248:in `logging'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:172:in `process'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis/client.rb:84:in `call'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis.rb:608:in `block in set'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis.rb:36:in `block in synchronize'
from /Users/pejman/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis.rb:36:in `synchronize'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/redis-3.0.2/lib/redis.rb:607:in `set'
from (irb):2
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
from /Users/pejman/.rvm/gems/ruby-1.9.3-p125@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>'1.9.3p125 :003 > 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:30:20.317

最终变得非常简单。

要安装 redis（服务器），我运行（在终端中）：

```
brew install redis 
```

然后在一个单独的终端窗口中，我启动了服务器：

```
redis-server 
```

现在我已经准备好了。我的 redis.set 命令现在在 rails 控制台中运行良好。

这是我发现的一个很好的资源，可以更深入地介绍它：http: [//jimneath.org/2011/03/24/using-redis-with-ruby-on-rails.html](http://jimneath.org/2011/03/24/using-redis-with-ruby-on-rails.html)

# sitecore - 在 Sitecore 项目存储桶中搜索标签/构面

> ID：13635714
> 
> 赞同：2
> 
> 时间：2012-11-29T22:12:05.337
> 
> 标签：sitecore

我希望使用来自 Shared Source 的 Sitecore Item Buckets 包，因为我需要分面搜索功能，并且使用内置功能而不是通过自己的 Lucene.Net 搜索编写是有意义的。

[Sitecore 项目桶](http://marketplace.sitecore.net/en/Modules/Sitecore_Item_Buckets.aspx "Sitecore 项目桶")

我在搜索时遇到问题，或者我阅读的文档有误。

根据第 2.2.3 和 3.1.3 节中的文档，我只需将一个字段标记为“Is Facet”，我的过滤器就会显示在搜索结果中。

我还在模板上定义了一个标签字段，并将“/sitecore/system/Modules/Item Buckets/Item Buckets Settings”中的标签父字段更改为指向正确的文件夹。这工作正常，我可以将一组标签应用于一个项目并使用“tag:CSharp”从 Bucket UI 进行搜索，它会返回正确的结果，但列表中再次没有显示过滤器。在所有情况下，我都重建了存储桶索引。

我错过了什么吗？这些是否应该自动显示在列表中，我是否需要更改一些设置或提供我自己的实现？

[截屏](http://imgur.com/68295)

这一切都在 Buckets Client UI 中，我还没有开始编写任何代码，并且是在全新安装 Sitecore 6.5 (update-5/rev. 120706)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T20:08:26.003

我不确定围绕此的文档措辞在我提到的几点上是否完全清楚。如果您进一步阅读文档，第 4.3 节：

> 物品桶附带 5 种不同类型的刻面。
> 
> 1.  模板
> 2.  字段
> 3.  日期
> 4.  地点
> 5.  作者
> 
> 如果您想引入自己的分面类别，那么您只需要实现 IFacet 接口。

文档中有一个 IFacet 实现的例子，或者使用[dotPeek](http://www.jetbrains.com/decompiler/)查看现有 Facets 的实现。

您还需要向 Sitecore 添加一个项目：/sitecore/system/Modules/Item Buckets/Facets

# iphone - EasyTableView 单元格设置值仅一次

> ID：13635715
> 
> 赞同：0
> 
> 时间：2012-11-29T22:12:14.333
> 
> 标签：iphone, objective-c, ios, uitableview

我在我的项目中使用 EasyTableView。我想在第一次显示视图中使用一些方法和其他方法在接下来的显示中：

```
- (void)easyTableView:(EasyTableView *)easyTableView setDataForView:(UIView *)view forIndexPath:(NSIndexPath *)indexPath {
    WCTableUserView *userView = (WCTableUserView *)view;
    if (**first display**) {
        User *user = [usersArray objectAtIndex: (NSUInteger) indexPath.row];
        userView.nameLabel.text = user.firstName;
        userView.cityLabel.text = user.cityName;
    } else {
        userView.cityLabel.text = @"Test";
    } 
```

我怎样才能做到这一点？

**编辑** 例如，我在表中有 12 个视图。但是只有 6 个是可见的，当我滚动表格视图时，我想检查单元格是否已经显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:14:37.553

检查索引路径。

```
if(indexpath.row==0) /*first*/ .... 
```

# html - 背景大小的 IE8 问题

> ID：13635717
> 
> 赞同：0
> 
> 时间：2012-11-29T22:12:29.330
> 
> 标签：html, css, internet-explorer

我正在做一个真正的基本设计作为我公司的一个副项目，但是我无法让背景大小做任何有意义的事情（或找到任何保留它当前功能的替代方案）。我一直在研究这个特定问题大约一个半小时，任何帮助将不胜感激。

我正在开发的网站可以在[http://code.msap.com/gflyer/flyer1.html找到](http://code.msap.com/gflyer/flyer1.html)

重要的是要注意我不能在容器 div 之前或之后修改任何内容。我也不能使用 javascript，所有的 CSS 都必须在线完成。

有人能在这里引导我朝着正确的方向前进吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:31:37.447

IE8 不支持 CSS `background-size`。

您唯一的解决方案是：

1.  忽略它; IE8 用户只需要升级。

2.  使用 Javascript polyfill 模拟`background-size`IE8 及更早版本中的属性。

3.  重写您的 HTML 以使背景图像位于其自己的`<img>`标记中，该标记的大小适当并在元素后面分层，使其看起来像背景图像。

4.  使用 Chrome-Frame 插件，它使 IE 使用 Chrome 渲染引擎。（您的用户必须自己安装插件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T14:39:43.417

我为 IE8 创建了一个[背景大小的 polyfill](https://github.com/louisremi/background-size-polyfill)，使用起来非常简单：

```
.selector { 
    background-size: cover;
    -ms-behavior: url(/backgroundsize.min.htc);
} 
```

# wordpress - 将 HTML/CSS 模板转换为 Wordpress 模板：CSS 图像路径更改

> ID：13635719
> 
> 赞同：0
> 
> 时间：2012-11-29T22:12:41.700
> 
> 标签：wordpress

我买了一个具有以下结构的模板：

```
css/..
img/..
js/..
*.html files 
```

style.css 位于 css/ 文件夹中。

为了创建一个功能性的 Wordpress 主题，我是否必须将 style.css 移动到根文件夹并调整 style.css 中的所有路径以匹配图像的新位置？（因为它们不在 ../img 中，但现在在 img 中）。

我不能在某处指定 style.css 文件路径吗？还是必须在根文件夹中才能成为有效模板？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T14:32:17.657

是的，您需要将 style.css 放在根文件夹中。这实际上是有效 WordPress 主题的最低要求。

但是，您的主题文件夹中的 style.css 只需要包含有关您的主题的信息，如下所示：

```
/*************************************************
Theme Name: YOUR THEME NAME HERE
Theme URI: http://yoururlhere.com/
Description: This theme was custom made
Author: Your Name Here
Author URI: http://yoururlhere.com
Version: 1.0
Tags: flexble-width

***************************************************/ 
```

只要你有这个，你就可以在你的 CSS 文件夹中添加尽可能多的其他样式表，并在主题标题中链接到它们。

如果您希望将基本的 HTML 模板转换为 WordPress 主题，那么值得一看[Theme Matcher](http://themematcher.com)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T16:03:06.370

您也可以为您的主题使用**自定义静态变量**。

将此行放在您的**functions.php**文件中。

```
define("ASSETS",get_bloginfo('template_url')); 
```

我认为这种用法是关于 sql 查询的更好方法。

**用法 ;**

```
<link rel="stylesheet" href="<?php echo ASSETS; ?>/CSS/file.css"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T02:07:49.190

无论您选择在哪里包含您的 CSS 文件（最有可能在 head.php 或 footer.php 中），您都可以调用

```
<?php get_template_directory_uri();?> 
```

您可以像这样将您的 CSS 和 IMG 目录移动到您的主题中

```
wp-content/themes/your-theme/css/ and wp-content/themes/your-theme/img/ 
```

然后，当您想将它们包含在您的主题中时，您可以这样做：

```
<link rel="stylesheet" href="<?php echo <?php get_template_directory_uri();?>/css/your-stylesheet.css"/> 

<img src="<?php get_template_directory_uri();?>/img/your-image.jpg"/> 
```

在您的样式表中，只需确保您的图像调用与图像目录相关，并且一切正常。

# visual-studio - Visual Studio 可以将其“类视图”导出为纯文本吗？

> ID：13635723
> 
> 赞同：4
> 
> 时间：2012-11-29T22:12:53.903
> 
> 标签：visual-studio, class, class-hierarchy

Visual Studio（2010 或 2012）可以将其“类视图”导出为纯文本吗？除了手动之外，我没有看到任何选项或其他方式来执行此操作。

是否有任何其他工具可用于从代码或 Visual Studio 项目创建纯文本类视图/层次结构/列表？

理想的情况正是我在 Visual Studio 的“类视图”中看到的，所有项目都展开了，但是是纯文本。

谢谢！

# java - How to create an object of an specific class given a key String in Java?

> ID：13635724
> 
> 赞同：1
> 
> 时间：2012-11-29T22:12:53.747
> 
> 标签：java, oop

I'm working on an example of a Zoo that has several different types of Animal. The user enters commands such "add tiger" and then a Tiger is added to the Zoo.

In my command interpreter class I have some code like this:

```
String animalName...
Animal newAnimal;
if (animalName.equals("tiger"))
    newAnimal = new Tiger();
else if (animalName.equals("elephant"))
    newAnimal = new Elephant(); 
```

The problem here is that when a new kind of animal is added to the program, this piece of code must also be changed. I'd like to add new animals just by subclassing Animal without changing anything in the already existing classes.

The name given by the user in her command isn't necessarily identical to the class name of the animal (for example, "add Bengal tiger" would add a BengalTiger object).

If possible, I'd prefer to avoid using reflection.

* * *

This is the final code:

```
private static String getClassName(String name) {
    char ch;
    int i;
    boolean upper = true;
    StringBuilder s = new StringBuilder("animals.");

    for (i=0; i<name.length(); i++) {
        ch = name.charAt(i);
        if (ch!=' ') {
            if (upper)
                s.append(Character.toUpperCase(ch));
            else
                s.append(Character.toLowerCase(ch));
            upper = false;
        } else
            upper = true;

    }
    return s.toString();
}

@Override
public Animal addAnimal(String s) {
    try {
        Animal animal = (Animal)Class.forName(getClassName(s)).newInstance();
        addAnimal(animal);
        return animal;
    } catch (InstantiationException e) {
        throw new IllegalArgumentException("There are no animals called like this");
    } catch (IllegalAccessException e) {
        throw new IllegalArgumentException("There are no animals called like this");
    } catch (ClassNotFoundException e) {
        throw new IllegalArgumentException("There are no animals called like this");
    } catch (ClassCastException e) {
        throw new IllegalArgumentException("There are no animals called like this");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:20:03.237

You should use dynamic class loading: `Class.forName(name)`, e.g.:

```
String animal = ... // e.g. elephant
String className = "com.mycompany.animals." + animal.substring(0, 1).toUpperCase() + animal.subString(1);
Animal obj = (Animal)Class.forName(className); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T22:17:42.133

You need to use Class.forName(X) to make this happen. Class.forName will help you get the load the actual class as string value. Refer to [http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Class.html#forName(java.lang.String](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Class.html#forName(java.lang.String)).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T22:17:32.250

```
Object animalObj = Class.forName(animalString); 
```

But it has to be the exact name (with the same capitalization).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T22:29:25.827

For completeness sake, here's rather verbose solution based on AbstractFactory pattern. You will need to subclass *two* interfaces instead of one (animal type's factory and animal type itself), but, hey, **there's no reflection!**

```
interface Animal {
    String whoAmI();
}

class Tiger implements Animal {
    @Override
    public String whoAmI() {
        return "Tiger";
    }
}

interface AnimalFactory {
    Animal create();
}

abstract class AbstractAnimalFactory implements AnimalFactory {
    protected AbstractAnimalFactory(String animalName, FactoriesRegistry registry) {
        registry.register(animalName, this);
    }
}

class TigersFactory extends AbstractAnimalFactory {
    TigersFactory(FactoriesRegistry registry) {
        super("tiger", registry);
    }

    @Override
    public Animal create() {
        return new Tiger();
    }
}

class FactoriesRegistry {
    HashMap<String, AnimalFactory> byAnimalName = new HashMap<String, AnimalFactory>();

    Animal produce(String id) {
        AnimalFactory factory = byAnimalName.get(id);
        if (factory != null)
            return factory.create();
        else
            throw new IllegalArgumentException("Unknown animal " + id);
    }

    public void register(String animalName, AnimalFactory factory) {
        byAnimalName.put(animalName, factory);
    }
}

public class SOSample {
    public static void main(String[] args) {
        FactoriesRegistry registry = new FactoriesRegistry();
        TigersFactory tigersFactory = new TigersFactory(registry);
        System.out.println(registry.produce("tiger").whoAmI());
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T22:47:54.683

Reflection isn't the only Solution for this Problem like @Victor Sorokin mentioned. But it's the most simple/clean one to code!!!

Solution with reflection:

```
public interface Animal {
    // put your contract here
}

public class AnimalFactory {
    public static final AnimalFactory INSTANCE = new AnimalFactory();

    private Map<String, Class<? extends Animal>> animalTypeMap;

    private AnimalFactory() {};

    public Animal createAnimal(String key) {
        Animal animal = null;
        if (animalTypeMap != null) {
            Class<? extends Animal> animalType = animalTypeMap.get(key);
            if (animalType != null) {
                try {
                    animal = animalType.newInstance();
                } catch (Throwable error) {
                    throw new RuntimeException("Unable to create animal with key='" + key + "'", error);
                }
            }
        }
        return animal;
    }

    public Map<String, Class<? extends Animal>> getAnimalTypeMap() {
        if (animalTypeMap == null) {
            animalTypeMap = new HashMap<String, Class<? extends Animal>>();
        }
        return animalTypeMap;
    }

    public void setAnimalTypeMap(Map<String, Class<? extends Animal>> animalTypeMap) {
        this.animalTypeMap = animalTypeMap;
    }

    public void addAnimalType(String key, Class<? extends Animal> animalType) {
        getAnimalTypeMap().put(key, animalType);
    }

    public void removeAnimalType(String key, Class<? extends Animal> animalType) {
        if (animalTypeMap != null) {
            animalTypeMap.remove(key);
        }
    }    
} 
```

And then, you use it like this:

```
Animal myAnimal = AnimalFactory.INSTANCE.createAnimal("myAnimalKey"); 
```

With this solution you just need to fill in that Map with the Animal types you need! The other solution it's also a clean/good solution, but is very verbose...

# php - 将 vcf 保存到联系人

> ID：13635730
> 
> 赞同：2
> 
> 时间：2012-11-29T22:13:18.143
> 
> 标签：php, android, jquery-mobile, vcf-vcard

我已经创建了 vcf 文件并将其上传到我的网站。当我按下我创建的“保存联系人”而不是将其保存到联系人的下载按钮时，它会像这样打开它：

```
BEGIN:VCARD
VERSION:2.1
N:John;Doh;;;
FN:John Doh
TEL;CELL:+99999999
EMAIL;WORK:ben@gmail.com
ADR;HOME:;;Las Vegas; Nevada;USA;;
END:VCARD 
```

现在不清楚的是，如果我将 vcf 文件发送到我的 gmail 并按下下载按钮，它会询问我是否要将其保存为联系人。

为什么有区别？我需要做什么才能通过单击我网站上的保存联系人将其保存到联系人？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T17:47:11.070

当您从您的网站下载 vCard 时，Web 服务器可能没有`Content-Type`为 vCard 文件分配正确的内容。

尝试配置您的 Web 服务器以将内容类型分配给`text/vcard`具有`vcf`扩展名的文件。如果该内容类型不起作用，请尝试[vCard Wikipedia 页面](http://en.wikipedia.org/wiki/VCard#Media_type)上的一些内容类型。

# objective-c - Objective-C 版本比较

> ID：13635732
> 
> 赞同：0
> 
> 时间：2012-11-29T22:13:29.097
> 
> 标签：objective-c

> **可能的重复：**
> [比较版本号](https://stackoverflow.com/questions/5160216/comparing-version-numbers)
> [如何在Objective-C中一个数字中的部分较少的版本号上使用比较？](https://stackoverflow.com/questions/12308659/how-to-use-compare-on-a-version-number-where-theres-less-parts-in-one-number-in)

我正在尝试根据本质上类似于版本号`NSMutableArray`的属性对自定义对象进行排序。`referenceID`

似乎将其`referenceID`视为一个`NSNumber`并使用它进行排序`compareTo:`几乎是正确的，但它打破的是以下情况：

```
Result:           Should Be:
1.1.1             1.1.1
1.1.10            1.1.2
1.1.2             ...
...               1.1.9
1.1.9             1.1.10

(Where ... is 1.1.2 through 1.1.9) 
```

是否有任何内置函数可以正确排序？还是我应该开始编写排序算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:29:06.813

如果您的参考 id 是一个字符串，您可以使用`localizedStandardCompare:`，它根据数值比较字符串中的数字。

示例（带有`sortedArrayUsingComparator`, 因为 OP 在他的评论中使用了它）：

```
NSArray *versions = @[@"2.1.1.1", @"2.10.1", @"2.2.1"];
NSArray *sorted = [versions sortedArrayUsingComparator:^NSComparisonResult(NSString *s1, NSString *s2) {
    return [s1 localizedStandardCompare:s2];
}];
NSLog(@"%@", sorted); 
```

输出：

```
2012-11-29 23:51:28.962 test27[1962:303] (
    "2.1.1.1",
    "2.2.1",
    "2.10.1"
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:16:57.017

用块排序

* * *

```
@autoreleasepool {
    //in this example, array of NSStrings
    id array = @[@"1.1.1",@"2.2",@"1.0",@"1.1.0.1",@"1.1.2.0", @"1.0.3", @"2.1.1.1", @"2.1.1", @"2.1.10"];

    //block
    id sorted = [array sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
        NSArray *comps1 = [obj1 componentsSeparatedByString:@"."];
        NSArray *comps2 = [obj2 componentsSeparatedByString:@"."];

        //get ints from comps
        int res1 = 0;
        for (int i=0; i<comps1.count; i++) {
            res1 += [comps1[i] intValue] * (4 - i);
        }
        int res2 = 0;
        for (int i=0; i<comps2.count; i++) {
            res2 += [comps2[i] intValue] * (4 - i);
        }

        return res1<res2 ? NSOrderedAscending : res1>res2 ? NSOrderedSame : NSOrderedDescending;
    }];

    NSLog(@"%@", sorted);
} 
```

# asp.net-mvc-4 - asp.net mvc 中长时间运行的工作流

> ID：13635733
> 
> 赞同：0
> 
> 时间：2012-11-29T22:13:35.643
> 
> 标签：asp.net-mvc-4, workflow-foundation-4

我正在使用 asp.net mvc4 开发一个 Intranet 站点来管理我们的一些数据。该站点的一个重要功能是触发导入/导出作业。这些工作可能需要 5 分钟到 1 小时之间的任何时间。该站点的用户需要能够确定作业当前是否正在运行以及先前作业的状态。许多工作通常会包含有关重复数据的警告消息，并且这些警告需要在站点上可见。

我的计划是将这些长时间运行的进程实现为 asp.net 站点将与之交互的 WCF 工作流服务。我已经通过活动实现了很多业务逻辑，并使用简单的控制台应用程序对其进行了测试。我应该注意我正在使用关联句柄来根据站点上的特定“项目”对服务进行分区。

我的问题是如何通过查询活动作业的状态（如果存在）以及以前作业的警告消息来进行。我怀疑最好的方法是使用 AppFabric 跟踪服务并让我的 asp.net 查询 SQL 监控存储并报告当前状态。在设置 AppFabric 并添加自定义跟踪消息后，我遇到了一些问题。我的第一个问题是我无法弄清楚如何过滤掉未使用正确关联句柄的工作流实例，因为我只想显示特定项目的工作流。另一个问题是跟踪数据库可能会延迟很多，这会导致我在尝试确定工作流是否正在运行时出现问题。

另一种可能的解决方案是让工作流使用其当前状态和任何错误消息显式更新数据库。我倾向于这个解决方案，但可以使用一些专家建议。

TL;DR：我需要知道查询 WCF 工作流服务的执行状态和任何警告消息的最佳方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T20:27:30.880

由于您想在工作流完成后查询工作流状态和消息，我将首先创建一个表，您可以在其中将客户端发送的相关值转换为相关的工作流 ID。我将创建一个自定义活动来执行此操作，并在创建工作流的接收之后立即删除它。

接下来，我将创建客户端应用程序用来查询状态的常规 WCF 服务。此 WCF 服务可以查询 WF 持久性存储以查看给定的工作流是否仍在运行。如果是这样，活动书签列将告诉您工作流当前正在等待哪些 SOAP 消息。

就消息而言，您可以使用 AppFabric 跟踪基础架构来存储和检索它们，或者您可以创建自定义活动并将它们存储在您自己的数据库中。这真的取决于您是否也对生成的标准 WF 跟踪消息感兴趣。

**检查运行工作流实例的更新：**

将 IsRunning 消息添加到您的工作流程有几个缺点。对于一个，您需要确保一个分支继续循环并等待消息，但在另一个真正的工作流分支完成后立即停止。当然可能，但它会使工作流程复杂化，并且可能是错误的来源。而且由于它不是业务问题的一部分，就我而言，它在工作流程中确实没有位置。这也意味着您必须从磁盘加载工作流并将其持久化，只是为了告诉您它在那里。如果它已完成，您将需要等待故障以指示没有工作流实例。这通常意味着您会在默认情况下 60 秒后收到超时异常。添加限制，您的请求可能会排队，因为有太多其他工作流实例或正在处理的 SOAP 请求。因此超时可能意味着工作流实例存在但由于系统限制而无法访问。相反，我会选择简单的事情并检查实例存储中的记录是否仍然可用。来自活动书签列的附加信息将告诉您工作流正在等待什么，我过去曾使用这些信息通过启用/禁用 UI 元素来动态更新 UI。

# python - 如何找出哪个套接字客户端发送消息？

> ID：13635734
> 
> 赞同：0
> 
> 时间：2012-11-29T22:13:38.120
> 
> 标签：python, sockets

我正在开发一个聊天程序。我有一个服务器和一个客户端，多个用户可以连接到服务器。目前，我只是让服务器发回客户端发送给服务器的任何消息。我想添加身份验证，以便在身份验证失败时接受/拒绝连接。

客户：

```
class Network:
    # initialize the socket
    def __init__(self, client, host=host, port=port):
        self.client = client;
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM);
        self.port = port;
        self.host = host;
        self.addr = (host, port);

    # conenct to the server
    def connect(self):
        self.socket.connect(self.addr);

    # receive data from server if there is any
    def read(self):
        while True:
            time.sleep(0.1)
            try:
                data = self.socket.recv(1024);
            except:
                break;
                # instead of breaking, create "connection lost" then open the login form again
            print "in client: ", data;
            data_split = data.split("\r\n");
            for ds in data_split:
                self.client.msgbox.addMsg(ds);

    # send chat message to the server
    def send(self, msg):
        self.socket.send(msg);

    # authenticate user
    # if
    def authenticate(self, info):
        self.socket.send(info); 
```

服务器：

```
class Server:
    # init the socket
    def __init__(self, host=host, port=port):
        self.host = host;
        self.port = port;
        self.addr = (host, port);
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM);

    # send data to client
    def send(self, soc, data):
        try:
            soc.send(data);
        except:
            return "couldn't send message";

    # receive data from client
    def receive(self, soc):
        while True:
            try:
                return soc.recv(size);
            except:
                return disconnect;

    # connect client
    def connect(self):
        self.socket.bind(self.addr);
        self.socket.listen(5);
        self.socket_s = [self.socket];
        self.read_socs = [self.socket];
        self.write_socs = [];
        self.user_addr = {};

    # validate the user
    def validate(self, username, password):
        if username in users:
            sha = s256.new();
            sha.update(password);
            password = sha.hexdigest();

            if password == users[username]:
                print "in server: true";
                return True;
            else:
                print "in server: false";
                return False;

    # server
    def serve(self):
        while True:
            r_socs, w_socs, exceptions = select.select(self.read_socs, [], []);
            for s in r_socs:
                if s in self.socket_s:
                    print "accepting socket connect";
                    soc, address = s.accept();
                    print "in server: ", soc, address;
                    self.read_socs.append(soc);
                    self.write_socs.append(soc);
                    for ws in self.write_socs:
                        self.send(ws, "len(users) == " + str(len(self.write_socs)) + "\n");
                        print connection;
                else:
                    data = self.receive(s);
                    print "in server: " + data;
                    if auth in data:
                        ds = data.split(" ");
                        res = self.validate(ds[1], ds[2]);
                    elif data == disconnect:
                        s.close();
                        self.read_socs.remove(s);
                        self.write_socs.remove(s);
                        for ws in self.write_socs:
                            print "in server: " + ws
                            self.send(ws, "len(users) == " + str(len(self.write_socs)) + "\n");
                    else:
                        for ws in self.write_socs:
                            print "in server: " + ws;
                            self.send(ws, data); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:22:49.463

您的设计实际上不会起作用，因为接收到的 TCP 消息中的数据不一定与来自另一端的单个发送相关——它可能是半条消息、3 条消息或 5-1/2 条消息。如果您只是在 localhost 上进行测试，带有少量消息，它通常*似乎*在您的测试中有效，然后当您将其放到 Internet 上时完全失败。这就是为什么您需要在 TCP 之上构建某种协议，该协议使用定界符（如换行符）、长度前缀（如网络字符串）或自定界对象（如 JSON）。

无论如何，您知道每条消息进入的套接字。您可以将套接字映射到用户，或者只使用套接字本身或它们的 fd 来做出决定。因此，就像您跟踪要传递给的所有已知套接字一样`select`，您还可以跟踪所有已知要进行身份验证的套接字。如果消息进入的套接字在该列表中，则它已通过身份验证；否则，除非是身份验证消息，否则该消息将被拒绝。

假设您有一个简单的线路协议：

```
def __init__(self):
    self.sockets = [] # add clients here, along with listener
    self.authsockets = [] # add authenticated clients here
    self.buffers = defaultdict(str)

def loop(self):
    r, w, x = select.select([sockets], [sockets], [sockets])
    for sock in r:
        buffers[sock] = buffers[sock] + sock.recv(4096)
        lines = buffers[sock].split('\n')
        if buffers[sock][-1] != '\n':
            buffers[sock], lines = lines[-1], lines[:-1]
        else:
            buffers[sock] = ''
        for line in lines:
            processCommand(sock, line)
    # etc.

def processCommand(self, sock, command):
    if self.isAuthCommand(command):
        if self.isValidAuthCommand(command):
            self.authsockets.append(sock)
        return
    if not sock in self.authsockets:
        return # ignore commands before auth
    self.doNormalThing(command) 
```

我已经去掉了所有不相关的东西——处理接受、断开连接、错误、写入等。但是你在阅读中遇到了类似的问题。首先，您假设套接字始终是可写的，这是不正确的。您需要为每个套接字排队一个写入缓冲区，并在`select`告诉您可以时写入。同样，这似乎可以在 localhost 上运行，但它会在互联网上崩溃。其次，写入套接字可能不会发送整个缓冲区，因此您需要查看写入了多少字节并将 buffer[bytecount:] 保留到下一次。

# javascript - 在页面重新加载时存储 jquery 选择器

> ID：13635737
> 
> 赞同：0
> 
> 时间：2012-11-29T22:13:47.453
> 
> 标签：javascript, jquery, dom

是否可以为唯一的 dom 对象存储 jQuery 选择器并在页面重新加载后重新使用它？

```
$('body')
.on('click', '*', function(e) {
    e.stopPropagation();
    var whatIwanttostore = $(this);
}); 
```

我考虑过向上导航 DOM，存储元素的索引并构造一个看起来像`$('div:nth-child(1) div:nth-child(2) div:nth-child(4)')`或者可能这样做的选择器，但只会向上直到最近的带有 id 的元素，但这似乎不是最好的方法.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:24:06.797

您要存储的是 jQuery 对象，而不是选择器，这是不可能的。页面是无状态的，并且（几乎）对前一页面一无所知。

如果你想存储选择器（例如'div:nth-child(1) div:nth-child(2) div:nth-child(4)'），你可以使用cookies，或者在现代浏览器中使用sessionStorage/localStorage .

# vt100 - VT100 的左上角是 0,0 还是 1,1？

> ID：13635740
> 
> 赞同：0
> 
> 时间：2012-11-29T22:14:14.783
> 
> 标签：vt100

我编写/维护了一个名为 ucon (http://www.umonfw.com/ucon) 的终端仿真器。我想把它称为一个真正的终端仿真器是可悲的，因为虽然它做了很多好事，但它在处理 VT100 转义序列方面并不是很好。无论如何，我从未解决的一个问题是左上角 (TLC) 的实际坐标位置。很长一段时间以来，我一直认为 1,1 是 TLC（这就是 VI 似乎使用的）；但是，在某些情况下，0,0 似乎是 TLC。另外，我偶尔会看到程序实际上使用了转义序列“<1b>[0;0f”，它强制光标定位到 0,0; 因此，如果我们假设光标不是故意移出屏幕，则必须假设 0,0 是 TLC.... ????

有没有VT100大师？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-25T19:08:10.963

[根据ANSI X3.64 标准](http://en.wikipedia.org/wiki/ANSI_escape_code)，左上角是 1,1 。零值表示默认值。在这种情况下，TLC 是默认设置。

# web-applications - 会话对象动作上下文struts2

> ID：13635748
> 
> 赞同：0
> 
> 时间：2012-11-29T22:14:43.553
> 
> 标签：web-applications, struts2, actioncontext

我正在浏览一些类似[这个 SO question](https://stackoverflow.com/questions/10296108/struts2-actioncontext-and-valuestack)的链接，发现每个新的操作请求都会创建一个新的操作上下文。

假设如果有对 Action A 的请求，则创建一个新的 ActionContext AC1。我将 ("xxx","yyy") 之类的内容保存到 AC1 中的会话映射中。

然后是同一用户对操作 B 的请求。如果创建了一个新的 ActionContext AC2，它会以某种方式从 AC1 获取会话对象还是为空？

会话对象不是来自同一浏览器的同一用户的多个请求吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:36:38.893

是的，对于给定用户的会话，会话是“全局的”（需要注意的是，新窗口/选项卡/等在客户端之间的行为可能会有所不同）。这就是使它成为会议的原因。

动作上下文可能包含*任何内容*，包括会话。仅仅因为每个请求都有一个新的上下文并不意味着多个上下文中的数据都会不同。

它没有从 AC1 获取会话，而是从会话中获取。AC2对AC1一无所知。

# c++ - 在类构造函数中确认来自文本文件的变量初始化

> ID：13635753
> 
> 赞同：3
> 
> 时间：2012-11-29T22:15:07.493
> 
> 标签：c++, class

我创建了一个类，并在构造函数中执行以下操作：

```
MyClass(string file)
{
    ifstream str;
    str.open (file, ifstream::in);

    // initialize class variables based on values from file

    str.close();
} 
```

我怎么知道在读取文件时是否出现错误并且值未正确初始化？上述方法是错误的吗？如果我想从构造函数中的文件初始化我的变量，我还能怎么做？

编辑，澄清：我要问的是这样的声明：

```
MyClass myclass("path/to/my/file.txt"); 
```

我怎么知道一切都已正确初始化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:20:57.240

一种可能性是使用异常：

```
...
ifstream str;
str.exceptions(std::ifstream::failbit);
// continue as before 
```

然后，如果你的构造函数抛出一个异常，你就知道有些东西不起作用。

另一种可能性是检测构造函数中的故障并设置一个可以由调用代码检查的状态变量。

以下是两种解决方案：

```
#include <iostream>
#include <exception>
#include <string>
#include <fstream>

struct MyClass1 {
  int i;
  MyClass1(const char * iniFile) {
    std::ifstream in;
    in.exceptions(std::ifstream::failbit);
    in.open(iniFile);
    in >> i;
  }
};

struct MyClass2 {
  int i;
  bool isValid;
  MyClass2(const char * iniFile) {
    try {
      std::ifstream in;
      in.exceptions(std::ifstream::failbit);
      in.open(iniFile);
      in >> i;
      isValid = true;
    } catch(std::ios_base::failure &fail) {
      isValid = false;
    }
  }
};

int main () {
  try {
    MyClass1 mc1("somefile.txt");
  } catch(std::exception& fail) {
    std::cout << "oops 1\n";
  }

  MyClass2 mc2("somefile.txt");
  if(!mc2.isValid) {
    std::cout << "oops 2\n";
  }
} 
```

假设`somefile.txt`不存在，那应该打印两行“oops”。

最后，第三种可能性是确保构造函数**永远不会失败**。`catch`在您的情况下，您可以在块中提供默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:22:18.143

您将以与往常相同的方式检查文件返回的值。如果您正在使用`fread`，请检查`ferror`. 如果您正在进行`atoi`转换，请检查`atoi`. 那，或者您可以实现异常处理。

要检查文件外部的错误代码，请通过引用传递一个 int 指针或一个 int 并将其用作整个构造函数的控件。当构造函数返回时检查该值。如果在构造函数执行期间的任何时候`ferror`不为零，则您的控件应防止在构造函数中进一步执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T22:25:56.727

就个人而言，我会使用 Rob 已经回答的异常。

另一种选择是传递对成功标志的引用。

```
MyClass(std::string filename, bool& success)
{
  success = true;
  if(!str.open(filename))
  {
    success = false;
  }      
} 
```

像这样检查成功。

```
bool success;
MyClass("filename", success);
if(!success)
{
  // Something failed during the class instantiation.
} 
```

# activerecord - Yii 条件关系

> ID：13635756
> 
> 赞同：2
> 
> 时间：2012-11-29T22:15:21.057
> 
> 标签：activerecord, yii, foreign-keys

我有一个`chat`带有字段的表

```
 admin TINYINT
 owner_id INTEGER 
```

目标是在 Yii 中建立两个关系：

```
'admin'=>array(
    self::BELONGS_TO, 'Admin', 'owner_id',
    'condition'=>'admin=1',
 ),

'user'=>array(
    self::BELONGS_TO, 'User', 'owner_id',
    'condition'=>'admin=0',
 ), 
```

但是，我得到了`General error: 1 no such column: admin`, 并且只能通过在 Admin 表中添加`all_ones`和`all_zeros`列来管理，所以我可以写

```
 'admin'=>array(
            self::BELONGS_TO, 'Admin', array('owner_id' => 'id', 'admin' => 'all_ones'),
        ),

        'user'=>array(
            self::BELONGS_TO, 'User', array('owner_id' => 'id', 'admin' => 'all_zeros'),
        ), 
```

在不使用这样的黑客的情况下，我可以用什么方法来实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T07:37:48.363

解决方案1：

将您的关系放在用户模型上（因为关系条件确实过滤了相关模型，而不是定义关系的模型）

```
//On the User model:

'chatsAdmin'=>array(
   self::HAS_MANY, 'Chat', 'owner_id',
   'condition'=>'admin=1',
),
'chats'=>array(
   self::HAS_MANY, 'Chat', 'owner_id',
   'condition'=>'admin=0',
), 
```

解决方案2：

使用 finder 获取一组过滤的聊天（或 DataProvider）

```
//relation on chat (without condition!)
'user'=>array(self::BELONGS_TO, 'User', 'owner_id')

//finder on chat model, will return ALL (use CActiveDataProvider if you need paging..)

Chat::model()->with('user')->findAll('user.admin=:admin', array(':admin'=>1)) 
```

# javascript - 将元素/函数处理程序传递给 gwt 函数

> ID：13635758
> 
> 赞同：2
> 
> 时间：2012-11-29T22:15:37.427
> 
> 标签：javascript, gwt

我正在使用 GWT 创建一个仅限客户端的库。我使用 JSNI 调用函数是来自 JS 的 Java。问题是我试图传递一个元素或一个函数处理程序，但似乎没有发生任何事情。我没有从 GWT 或 js 中得到异常。这是我的 JSNI 函数与网桥。

```
public static String testMe(Object obj) 
  {
      return "Response to " + obj.toString();     
  }

  public static native void defineBridgeMethod() /*-{
     $wnd.testMe = function(msg) {
        return @com.mycompany.mywebapp.client.MyWebApp::testMe(Ljava/lang/Object;);
     };

  }-*/; 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T23:24:33.920

你没有使用`msg`，你的意思是用它作为参数调用函数：

```
public static native void defineBridgeMethod() /*-{
  $wnd.testMe = $entry(function(msg) {
    return @com.mycompany.mywebapp.client.MyWebApp::testMe(Ljava/lang/Object;)(msg);
  });
}-*/; 
```

或者您可以将函数直接分配给窗口：

```
public static native void defineBridgeMethod() /*-{
  $wnd.testMe = $entry(
    @com.mycompany.mywebapp.client.MyWebApp::testMe(Ljava/lang/Object;)
  );
}-*/; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T08:52:53.217

The easiest way to export a gwt project to js is using [gwt-exporter](http://code.google.com/p/gwt-exporter/). Gwtexporter allows to export any gwt project without writing a single line of jsni code and it has plenty of features which allows to customize classes and methods exposed to js, and even it could produce the documentation for your js api.

In your case, implement the `Exportable` interface in the class with your static method, and annotate your method.

```
public class MyClass implements Exportable {
  @Export("$wnd.testMe")
  public static String testMe(Object obj)  {
    return "Response to " + obj.toString();     
  }
} 
```

Then you have to call the `exportAll()` method in your entry point and leave the gwt compiler and gwtexporter generator do their magic

```
public void onModuleLoad() {
  ExporterUtil.exportAll();
} 
```

Here you have a [tutorial](http://code.google.com/p/gwtchismes/wiki/Tutorial_ExportingGwtLibrariesToJavascript_en) of how to export a gwt-library to js, although the [documentation](http://code.google.com/p/gwt-exporter/wiki/GettingStarted) of the project is quite good.

Some of the projects using this technique are [chronoscope](http://code.google.com/p/gwt-chronoscope/wiki/JavaScriptAPI), [gwtupload(jsupload)](http://code.google.com/p/gwtupload/wiki/JsUpload_Documentation) and [gwtquery(jsquery)](http://code.google.com/p/gwtquery/wiki/JsQuery).

# css - 边框将滚动条推到视口之外

> ID：13635759
> 
> 赞同：0
> 
> 时间：2012-11-29T22:15:41.717
> 
> 标签：css, scrollbar, border

我的左边框将滚动条推到浏览器右边缘的中途。这是 Chrome 和 IE8/9 中的问题。

这是我应用于 BODY 的 2 种样式：

```
border-left : black 7px solid;
overflow-y : scroll; 
```

将边框应用于身体以外的其他东西有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T00:15:34.070

将此添加到样式表的顶部并在带边框的元素上声明宽度应该可以解决问题：

```
* {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

# javascript - 如何用js删除标签？

> ID：13635761
> 
> 赞同：0
> 
> 时间：2012-11-29T22:15:47.150
> 
> 标签：javascript, jquery, html

例如：

```
<ul>
    <li id="l1"></li>
    <li id="l2"></li>
    <li id="l3"></li>
    <li id="l4"></li>
    <li id="l5"></li>
</ul> 
```

如何删除一行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T22:18:31.573

```
$('#l1').remove();  // To remove specific element that has id

$('li').remove();   // To remove all li's

$('.l1').remove();  // To remove elements with class l1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T22:21:38.067

您可以删除：

```
/**
id is a variable that you can get from anywhere wish you
**/

$("#l"+id).remove(); 
```

**其他选项更具体**

```
$("#l1").remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T22:18:28.663

使用[`remove()`](http://api.jquery.com/remove/)jQuery 函数。

尝试使用：`$('#l1').remove();`删除单个`li`元素。

# excel - Excel VBA Selection.Copy 不再有效

> ID：13635768
> 
> 赞同：1
> 
> 时间：2012-11-29T22:16:21.170
> 
> 标签：excel, selection, vba

我从此代码中收到“编译错误：预期的函数或变量”

```
Cells(3, 2).Select
ActiveCell.FormulaR1C1 = Formula 'Inserts formula
'Copies formula across the row
Cells(3, 2).Copy
Range(Cells(3, 2), Cells(3, 10)).PasteSpecial xlPasteFormulas 
Range(Cells(3, 2), Cells(3, 10)).Select
'Copies the formula down to end of list
selection.Copy '<---- Here it says it can't compile
Range(selection, selection.End(xlDown)).FillDown 
```

在此处使用“选择”会产生错误，但可以在另一个工作簿中使用。我正在尝试将公式插入到单元格中，将其复制到一个范围内，然后填充到数据块的末尾。我怎样才能让它再次工作？或者，是否有另一种方法可以使用公式填充一系列单元格（经常更改，因此将其放入变量中。）

谢谢你的帮助，
塞缪尔·史密斯

# android - 图像不合适

> ID：13635775
> 
> 赞同：0
> 
> 时间：2012-11-29T22:16:53.297
> 
> 标签：android, android-layout

我需要我的看起来像[这样](http://i.imgur.com/gwDZE.png)，这是 iPhone 版本。目前我的 android 看起来像[这样](http://i.imgur.com/o5wBh.png)。这是 XML 布局代码。

```
<?xml version="1.0" encoding="UTF-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/scrollview01"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/relativelayout01"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <RelativeLayout
            android:id="@+id/relativelayout02"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:paddingLeft="6dp"
            android:paddingRight="6dp" >

            <TextView
                android:id="@+id/model"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_centerVertical="true"
                android:text="300"
                android:textColor="#ffffff"
                android:textSize="24sp"
                android:textStyle="bold"
                android:visibility="visible" />

            <ImageView
                android:id="@+id/brandname"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_alignParentTop="true"
                android:paddingTop="6dp"
                android:src="@drawable/logo_chrysler" />
        </RelativeLayout>

        <RelativeLayout
            android:id="@+id/relativelayout04"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/relativelayout02"
            android:background="@drawable/shape_header"
            android:paddingLeft="10dp"
            android:paddingRight="10dp" >

            <RadioGroup
                android:id="@+id/RadioGroup1"
                android:layout_width="68dp"
                android:layout_height="20dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:orientation="horizontal"
                android:paddingTop="5dp" >

                <RadioButton
                    android:id="@+id/option1"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="true"
                    android:visibility="invisible" >
                </RadioButton>

                <RadioButton
                    android:id="@+id/option2"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="false"
                    android:visibility="invisible" >
                </RadioButton>

                <RadioButton
                    android:id="@+id/option3"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="true"
                    android:visibility="invisible" >
                </RadioButton>

                <RadioButton
                    android:id="@+id/option4"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="false"
                    android:visibility="invisible" >
                </RadioButton>

                <RadioButton
                    android:id="@+id/option5"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="false"
                    android:visibility="invisible" >
                </RadioButton>

                <RadioButton
                    android:id="@+id/option6"
                    android:layout_weight="2"
                    android:button="@drawable/custom_radio"
                    android:checked="false"
                    android:visibility="invisible" >
                </RadioButton>
            </RadioGroup>
        </RelativeLayout>

        <RelativeLayout
            android:id="@+id/relativelayout03"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_below="@id/relativelayout04"
            android:paddingLeft="20dp"
            android:paddingRight="20dp" >

            <ImageView
                android:id="@+id/vehicleimg"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_alignTop="@+id/relativelayout03"
                android:src="@drawable/chrysler_twohundred" />

            <ImageView
                android:id="@+id/vhc"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentBottom="true"
                android:layout_alignParentRight="true"
                android:src="@drawable/icon_vhc"
                android:visibility="gone" />

            <ImageView
                android:id="@+id/subhead"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentBottom="true"
                android:layout_alignParentLeft="true"
                android:src="@drawable/shape_subhead" />
        </RelativeLayout>

        <RelativeLayout
            android:id="@+id/relativeLayout05"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_below="@id/relativelayout03" >

            <TextView
                android:id="@+id/line1"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:background="@drawable/border" />

            <TextView
                android:id="@+id/status"
                android:layout_width="fill_parent"
                android:layout_height="28dp"
                android:layout_centerInParent="true"
                android:gravity="center"
                android:text=""
                android:textSize="16sp" />

            <TextView
                android:id="@+id/line2"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_below="@id/status"
                android:background="@drawable/border" />
        </RelativeLayout>

        <LinearLayout
            android:id="@+id/linearLayout01"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/relativeLayout05"
            android:paddingLeft="4dp"
            android:paddingRight="4dp"
            android:focusable="true"      
            android:focusableInTouchMode="true" >

            <ImageButton
                android:id="@+id/unlock"
                style="@style/chryslerButtonStyle"
                android:padding="10dp"
                android:src="@drawable/icon_unlock" />

            <ImageButton
                android:id="@+id/lock"
                style="@style/chryslerButtonStyle"
                android:padding="10dp"
                android:src="@drawable/icon_lock" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/linearLayout02"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/linearLayout01"
            android:paddingLeft="4dp"
            android:paddingRight="4dp" >

            <ImageButton
                android:id="@+id/remotestart"
                style="@style/chryslerButtonStyle"
                android:padding="10dp"
                android:src="@drawable/icon_ignitionstart" />

            <ImageButton
                android:id="@+id/remoteturnoff"
                style="@style/chryslerButtonStyle"
                android:padding="10dp"
                android:src="@drawable/icon_ignitionstop" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/linearLayout03"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@id/linearLayout02"
            android:background="#000000"
            android:orientation="vertical"
            android:paddingLeft="4dp"
            android:paddingRight="4dp" >

            <ImageButton
                android:id="@+id/remotehornsandlights"
                android:layout_width="fill_parent"
                android:layout_height="75dp"
                android:background="@drawable/chrysler_btn_bkg"
                android:padding="10dp"
                android:src="@drawable/icon_lightsandhorn" />

            <Button
                android:id="@+id/vehiclehealthcheck"
                android:layout_width="fill_parent"
                android:layout_height="75dp"
                android:background="@drawable/chrysler_btn_bkg"
                android:text="Vehicle Information"
                android:textColor="#ffffff"
                android:textSize="24sp" />

            <Button
                android:id="@+id/Tweddle"
                android:layout_width="fill_parent"
                android:layout_height="75dp"
                android:background="@drawable/chrysler_btn_bkg"
                android:drawableRight="@drawable/tweddle_status"
                android:paddingLeft="82dp"
                android:paddingRight="60dp"
                android:text="Via Mobile"
                android:textColor="#ffffff"
                android:textSize="24sp"
                android:visibility="gone" />

        </LinearLayout>

        <LinearLayout
            android:id="@+id/linearLayout04"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/linearLayout03"
            android:background="#000000"
            android:orientation="horizontal"
            android:paddingLeft="4dp"
            android:paddingRight="4dp" >

            <ImageButton
                android:id="@+id/contactus"
                style="@style/chryslerButtonStyle"
                android:src="@drawable/icon_contactus" />

            <ImageButton
                android:id="@+id/help"
                style="@style/chryslerButtonStyle"
                android:src="@drawable/icon_help" />

            <ImageButton
                android:id="@+id/ext1"
                style="@style/chryslerButtonStyle"
                android:background="@drawable/chrysler_btn_bkg"
                android:visibility="invisible" />

            <ImageButton
                android:id="@+id/ext2"
                style="@style/chryslerButtonStyle"
                android:background="@drawable/chrysler_btn_bkg"
                android:paddingRight="10dp"
                android:visibility="invisible" />

        </LinearLayout>
    </RelativeLayout>

</ScrollView> 
```

当我从图形视图布局中双击图像时，会突出显示以下代码。

```
<ImageView
                android:id="@+id/vehicleimg"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_alignTop="@+id/relativelayout03"
                android:src="@drawable/chrysler_twohundred" /> 
```

我尝试的是更改 layout_width 和 height 以包装内容或 fill_parent，尝试了它的各种组合。在@+id/relativelayout03 中也试过这个。有人对此有想法吗？问题在于中心图像。它应该被拉长并且应该像第一个一样，没有边界，它应该融入其中。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T23:08:17.567

您是否尝试在 ImageView 中设置 android:scaleType？就像是：

```
<ImageView
                android:id="@+id/vehicleimg"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_alignTop="@+id/relativelayout03"
                android:src="@drawable/chrysler_twohundred" 
                android:scaleType="fitXY"/> 
```

有关可用选项，请参阅[http://developer.android.com/reference/android/widget/ImageView.html#attr_android:scaleType](http://developer.android.com/reference/android/widget/ImageView.html#attr_android:scaleType)。

# php - Preg_replace 不会导致未定义索引错误的模板替换

> ID：13635776
> 
> 赞同：0
> 
> 时间：2012-11-29T22:16:54.690
> 
> 标签：php, regex, preg-replace

我有一个模板，其中包含某些要替换为给定值的字段。

每个字段都有一个用大括号括起来的名称。例如： {address} 替换值包含在索引为名称的数组中。例如`array('address'=>'101 Main Street', 'city’=>'New York')`

我正在使用以下内容，并且效果很好（大多数情况下）

```
$template_new= preg_replace('/\{\?(\w+)\?\}/e', '$array["$1"]', $template); 
```

问题是如果我有一个`{bad_name}`不在数组中，我会收到以下错误：

> **注意**：未定义的索引： **/var/www/classes/library.php(860) 中的 xxx：第****1**行 的正则表达式代码

 **我的愿望是将这些留在原处而不改变它们。

我的第一个想法是替换`$array["$1"]`为`(isset($array["$1"])?$array["$1"]': '{'.$1.'}')`，但它没有用。

我也试过try/catch，但也没有用

请提供任何建议。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:33:00.947

[使用preg_replace_callback()](http://php.net/manual/en/function.preg-replace-callback.php)并执行以下操作会更好：

```
<?php
class Substitute {

    public function __construct($template) {
        $this->template = $template;
        $this->values = array();
    }

    public function run($values) {
        $this->values = $values;
        return preg_replace_callback('/\{\?(\w+)\?\}/', array($this, 'subst'), $this->template);
    }

    private function subst($matches) {
        if (isset($this->values[$matches[1]])) {
            return $this->values[$matches[1]];
        }
        // Don't bother doing the substitution.
        return $matches[0];
    }
} 
```

请记住，我是在脑海中输入的，所以可能存在错误。

假设您能够使用匿名函数，以下是您如何使用匿名函数执行相同操作的方法：

```
function substitute($template, $values) {
    return preg_replace_callback(
        '/\{\?(\w+)\?\}/',
        function ($matches) use ($values) {
            if (isset($values[$matches[1]])) {
                return $values[$matches[1]];
            }
            // Don't bother doing the substitution.
            return $matches[0];
        },
        $template);
} 
```

更紧凑！**

# javascript - 用于按时间顺序显示和隐藏 div 的 JavaScript

> ID：13635780
> 
> 赞同：0
> 
> 时间：2012-11-29T22:17:11.820
> 
> 标签：javascript, jquery, html, css, fade

我在让我的代码正常工作时遇到问题。我知道我已经问过这个问题几次了，但我真的需要一些意见。感谢这个网站上的某个人，我能够让代码在 jsFiddle 中工作，但不能在我的浏览器中工作。

知道我做错了什么吗？

HTML

```
<div class="fader tutorial" id="createquestion1">
    <div class="arrow-w" style="font-size:1em;"></div>
    &nbsp;Start by creating a title and selecting a folder for your question to be stored in.
</div>

<div class="fader tutorial" id="createquestion2">
    <div class="arrow-w" style="font-size:1em;"></div>
    &nbsp;Categories are key to your reporting effectiveness, be sure to include categories that relate to this question.
</div>

<div class="fader tutorial" id="createquestion3">
    <div class="arrow-w" style="font-size:1em;"></div>
    &nbsp;Select your options and/or upload an attachment (file, video or audio).
</div>

<div class="fader tutorial" id="createquestion4">
    <div class="arrow-w" style="font-size:1em;"></div>
   To create questions easier update your question preferences in your account area options.&nbsp
</div>

<div class="fader tutorial" id="createquestion5">
    <div class="arrow-w" style="font-size:1em;"></div>
    &nbsp;Your rationale can be used to provide feedback to students on this question and you also can use internal comment to track notes on changes, updates, textbook information and more.
</div>

<div class="fader tutorial" id="createquestion6">
    <div class="arrow-w" style="font-size:1em;"></div>
   Write your questions, answers and you are ready to go.&nbsp;
</div>

<input type="button" value="Start" id="start"/> 
```

JS

```
function fadeLoop() {

    var counter = 0,
        divs = $('.fader').hide(),
        dur = 500;

    function showDiv() {
        divs.fadeOut(dur) // hide all divs
            .filter(function(index) {
                return index == counter % divs.length;
            }) // figure out correct div to show
            .delay(dur) // delay until fadeout is finished
            .fadeIn(dur); // and show it
        counter++;
    }; // function to loop through divs and show correct div
    showDiv(); // show first div    
    return setInterval(function() {
        showDiv(); // show next div
    }, 5 * 1000); // do this every 5 seconds     };

$(function() {
    var interval;

    $("#start").click(function() {
        if (interval == undefined){
            interval = fadeLoop();
            $(this).val("Stop");
        }
        else{
            clearInterval(interval);
            $(this).val("Start");
            interval = undefined;
        }
    }); });​ 
```

CSS

```
#start{
    right:1em;
    top:1em;
    padding:1em;
}

.tutorial {
    display: table;
    border: 4px solid #8C3087;
    -webkit-border-radius: 15px;
    -moz-border-radius: 15px;
    border-radius: 15px;
    -moz-box-shadow:1px 1px 3px 2px #ccc;
    -webkit-box-shadow: 1px 1px 3px 2px #ccc;
    box-shadow: 1px 1px 3px 2px #ccc;
    position:absolute;
    padding: 11px;
    font-family: 'Archivo Narrow', sans-serif;
    background-color:#ECA100;
    width:200;
    z-index:2000;
    font-size:12pt; 
    color:#000;
    vertical-align:top;
}

.arrow-n,
.arrow-e,
.arrow-s,
.arrow-w {
  /*
   * In Internet Explorer, The"border-style: dashed" will never be
   * rendered unless "(width * 5) >= border-width" is true.
   * Since "width" is set to "0", the "dashed-border" remains
   * invisible to the user, which renders the border just like how
   * "border-color: transparent" renders.
   */
    border-style: dashed;
    border-color: transparent;
    border-width: 0.53em;
    display: -moz-inline-box;
    display: inline-block;
  /* Use font-size to control the size of the arrow. */
    font-size: 100px;
    height: 0;
    line-height: 0;
    position: relative;
    width: 0;
    text-align:left;
}

.arrow-n {
    border-bottom-width: 1em;
    border-bottom-style: solid;
    border-bottom-color: #8C3087;
    bottom: 0.25em;
}

.arrow-e {
    border-left-width: 1em;
    border-left-style: solid;
    border-left-color: #8C3087;
    left: 0.25em;
}

.arrow-s {
    border-top-width: 1em;
    border-top-style: solid;
    border-top-color: #8C3087;
    top: 0.25em;
}

.arrow-w {
    border-right-width: 1em;
    border-right-style: solid;
    border-right-color: #8C3087;
    right: 0.25em;
}

/* Create Multiple Choice Question */
#createquestion1 {
    top:140px;
    left:320px;
    text-align:left;
}
#createquestion2 {
    top:240px;
    left:320px;
    text-align:left;
}
#createquestion3 {
    top:340px;
    left:320px;
    text-align:left;
}
#createquestion4 {
    top:60px;
    right:10px;
    text-align:right !important; 
}
#createquestion5 {
    top:520px;
    left:320px;
    text-align:left;
}
#createquestion6 {
    top:140px;
    left:100px;
    text-align:right !important;
} 
```

任何人都可以帮助我！我正在使用的页面是一个asp。我也对新想法持开放态度。理想情况下，我希望完全在 CSS3 中实现这一点......​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T23:47:25.560

工作代码：:-)

```
</script>
<script src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
fadeLoop()
function fadeLoop() {

    var counter = 0,
        divs = $('.fader').hide(),
        dur = 300;

    function showDiv() {
        $("div.fader").fadeOut(dur) // hide all divs
            .filter(function(index) {
                return index == counter % divs.length;
            }) // figure out correct div to show
            .delay(dur) // delay until fadeout is finished
            .fadeIn(dur); // and show it
        counter++;
    }; // function to loop through divs and show correct div
    showDiv(); // show first div    
    return setInterval(function() {
        showDiv(); // show next div
    }, 7 * 1000); // do this every 5 seconds    
};

$(function() {
    var interval;

    $("#start").click(function() {
        if (interval == undefined){
            interval = fadeLoop();
            $(this).val("Stop");
        }
        else{
            clearInterval(interval);
            $(this).val("Start");
            interval = undefined;
        }
    });
});
});
</script>
<!--#include file="header.asp"-->
<% if Request("interactive") = "on" then %>
<form name="tutorial">

<div class="fader"><div class="arrow-w arrowlocation1" style="font-size:1em;" ></div><div id="tutorial1" class="tutorial createquestion1">Start by creating a title and selecting a folder for your question to be stored in.</div></div>

<div class="fader"><div class="arrow-w arrowlocation2" style="font-size:1em;" ></div>
<div id="tutorial2" class="tutorial createquestion2">Categories are key to your reporting effectiveness, be sure to include categories that relate to this question.</div></div>

<div class="fader"><div class="arrow-w arrowlocation3" style="font-size:1em;" ></div>
<div id="tutorial3" class="tutorial createquestion3">Select your options and/or upload an attachment (file, video or audio).</div></div>

<div class="fader"><div class="quicktiptitle quicktiplocation4">QUICK TIP</div><div class="arrow-n arrowlocation4" style="font-size:1em;" ></div>
<div id="tutorial4" class="quicktip createquestion4">To create questions easier update your question preferences in your account area options.</div></div>

<div class="fader"><div class="arrow-w arrowlocation5" style="font-size:1em;" ></div>
<div id="tutorial5" class="tutorial createquestion5">Your rationale can be used to provide feedback to students on this question and you also can use internal comment to track notes on changes, updates, textbook information and more.</div></div>

<div class="fader"><div class="arrow-e arrowlocation6" style="font-size:1em;" ></div>
<div id="tutorial6" class="tutorial createquestion6">Write your questions, answers and you are ready to go.</div></div>

<div class="fader"><div class="arrow-w arrowlocation7" style="font-size:1em;" ></div>
<div class="quicktiptitle quicktiplocation7">QUICK TIP</div>
<div id="tutorial7" class="quicktip createquestion7"> Click on this icon to open and close sections that you don't use. These will remain closed whenever you visit this page until you open them again.</div></div></form>

<% end if %> 
```

# devexpress - 如何动态填充 XtraGrid？

> ID：13635786
> 
> 赞同：0
> 
> 时间：2012-11-29T22:17:28.750
> 
> 标签：devexpress, xtragrid

我有一个需要显示大表中数据的网格。我不想一次加载整个表，因为这会很难记忆。我知道服务器模式下存在虚拟负载，但我是从本地 csv 文件加载而不使用任何 sql 服务器数据库。

是否有任何此类虚拟加载方法来支持自定义数据访问对象，以便当用户在网格上向下滚动时我可以从我的 csv 中获取数据？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T21:04:39.130

我不相信任何这样的事情存在。但是，可以通过实现 DevExpress.Data.IListServer 接口来实现自己的功能。从我读过的关于这个主题的内容来看，这似乎不是一项微不足道的任务。这些链接可能会让您入门。

[简单的 IListServer 实现](http://www.devexpress.com/Support/Center/p/E1307.aspx)

[XtraGrid 是否支持虚拟负载模式？](http://www.devexpress.com/Support/Center/p/A1022.aspx)

一种替代方法可能是将 csv 数据导入 SQLite 数据库。然后您可以使用 LinqServerModeSource 作为您的数据源。以下链接提供了有关如何执行此操作的详细信息。

[SQLite 和服务器模式](http://www.devexpress.com/Support/Center/p/Q293056.aspx)

希望这可以帮助。

# php - Wordpress= 显示 x 从图库字段中随机选择的图像数量

> ID：13635787
> 
> 赞同：0
> 
> 时间：2012-11-29T22:17:28.683
> 
> 标签：php, wordpress

我正在使用 Wordpress 中的高级自定义字段插件在我的网站中实现图库。我想显示来自画廊字段的 5 张随机图像。

我有以下代码显示画廊字段中的所有图像：

```
 <?php $images = get_field('gallery');
      if( $images ): ?>
        <?php foreach( $images as $image ): ?>
          <img scr="<?php echo $image['url']; ?>">
        <?php endforeach; ?> 
    <?php endif;  ?> 
```

$images 的 Print_r 产生以下输出：

```
Array ( [0] => Array ( [id] => 46 [alt] => [title] => 500x10002 [caption] =>  [description] =>   [url] => 500x1000.jpg [sizes] => Array ( [thumbnail] => 500x1000-100x100.jpg [medium] => 500x1000-150x300.jpg [large] => 500x1000.jpg [post-feature-image] => 500x1000.jpg ) ) [1] => Array ( [id] => 45 [alt] => [title] => 500x500 [caption] => [description] =>   [url] => 500x500.jpg [sizes] => Array ( [thumbnail] => 500x500-100x100.jpg [medium] => 500x500-300x300.jpg [large] => 500x500.jpg [post-feature-image] => 500x500.jpg ) ) [2] => Array ( [id] => 44 [alt] => [title] => 2000x500 [caption] => [description] =>   [url] => 2000x500.jpg [sizes] => Array ( [thumbnail] => 2000x500-100x100.jpg [medium] => 2000x500-300x75.jpg [large] => 2000x500-1024x256.jpg [post-feature-image] => 2000x500-610x152.jpg ) ) [3] => Array ( [id] => 43 [alt] => [title] => 1000x500 [caption] => [description] =>   [url] => 1000x500.jpg [sizes] => Array ( [thumbnail] => 1000x500-100x100.jpg [medium] => 1000x500-300x150.jpg [large] => 1000x500.jpg [post-feature-image] => 1000x500-610x305.jpg ) ) [4] => Array ( [id] => 42 [alt] => [title] => 500x2000 [caption] => onderschifttttt [description] =>   [url] => 500x2000.jpg [sizes] => Array ( [thumbnail] => 500x2000-100x100.jpg [medium] => 500x2000-75x300.jpg [large] => 500x2000-256x1024.jpg [post-feature-image] => 500x2000.jpg ) ) ) 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:30:18.547

您的逻辑可能如下所示：

```
$max_images_to_show = 5;
$images_available = count($images);
$images_to_show = array();

if ($images_available <= $max_images_to_show) {
    $images_to_show = $images;
} else {
    while(count($images_to_show) < $max_images_to_show) {
        $random_index = rand(0, count($images) - 1);
        $images_to_show[] = array_slice($images, $random_index, 1);
    }
}

// show images from $images_to_show 
```

# c++ - 如何使用 boost::python 从 Python 类型中提取包装的 C++ 类型？

> ID：13635790
> 
> 赞同：1
> 
> 时间：2012-11-29T22:17:32.647
> 
> 标签：c++, boost-python, py++

我已经使用 Py++ 包装了一个 C++ 类，并且在 Python 中一切正常。我可以实例化 c++ 类、调用方法等。

我现在正在尝试将一些 Python 嵌入到 C++ 应用程序中。这在大多数情况下也可以正常工作。我可以调用 Python 模块上的函数、获取返回值等。

我正在调用的 python 代码返回我包装的类之一：

```
import _myextension as myext
def run_script(arg):
    my_cpp_class = myext.MyClass()
    return my_cpp_class 
```

我从 C++ 调用这个函数，如下所示：

```
// ... excluding error checking, ref counting, etc. for brevity ...
PyObject *pModule, *pFunc, *pArgs, *pReturnValue;

Py_Initialize();
pModule = PyImport_Import(PyString_FromString("cpp_interface"));
pFunc = PyObject_GetAttrString(pModule, "run_script");
pArgs = PyTuple_New(1); PyTuple_SetItem(pArgs, 0, PyString_FromString("an arg"));

pReturnValue = PyObject_CallObject(pFunc, pArgs);

bp::extract< MyClass& > extractor(pReturnValue); // PROBLEM IS HERE
if (extractor.check()) {                         // This check is always false
    MyClass& cls = extractor();
} 
```

问题是提取器从未实际提取/转换 PyObject* 为 MyClass（即 extractor.check() 始终为假）。

根据[文档，](http://www.boost.org/doc/libs/1_47_0/libs/python/doc/tutorial/doc/html/python/object.html#python.extracting_c___objects)这是提取包装 C++ 类的正确方法。

我尝试从 Python 函数返回基本数据类型（ints/floats/dicts），并且它们都被正确提取。

有什么我想念的吗？有没有另一种方法来获取数据并转换为 MyClass？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:12:16.670

我发现了错误。我没有在我的主可执行文件中链接我的绑定，因为绑定是在一个单独的项目中编译的，该项目只创建了 python 扩展。

我假设通过使用`pModule = PyImport_Import(PyString_FromString("cpp_interface"));`绑定加载扩展也会被加载，但事实并非如此。

**为了解决这个问题，我只是将包含我的 boost::python 绑定的文件（对我来说，只是 wrapper.cpp）添加到我的主项目中并重新构建。**

# jquery - jQuery UI 对话框未以 iPad 为中心

> ID：13635792
> 
> 赞同：0
> 
> 时间：2012-11-29T22:17:39.243
> 
> 标签：jquery, jquery-ui

我对在 iPad 上打开视频的 jQuery UI 对话框有疑问。

它在所有平台上的所有浏览器上都能正常工作，除了 iPad，它不会使对话框居中。它显示在 0,0。

该站点是 www.rainforestretreat.co.nz，您可以通过单击左侧导航中的视频链接查看问题。

我正在触发对话框并开始播放视频：

```
$(".fancyBox").click(function(){
                $("#video").dialog({
                    height:500,
                    width:800,
                    open: function(event, ui){
                        $('#overlay').fadeIn();
                        _V_("RRVideo").ready(function(){
                            var myPlayer = this;
                            myPlayer.play();
                        });
                    },
                    close: function(event, ui){
                        $('.ui-dialog').hide();
                        $('#overlay').fadeOut();
                        _V_("RRVideo").ready(function(){
                            var myPlayer = this;
                            myPlayer.pause();
                        });
                    },
                    show: 'fade'
                });
                return false;
            }); 
```

我尝试添加 position:'center' 作为选项，但这并没有什么不同。（当我定位顶部和底部时，其他浏览器反映了更改，但在 iPad 上没有进行任何更改）。

有没有人遇到过这个？

# php - 无法让 ManyToOne 工作

> ID：13635796
> 
> 赞同：2
> 
> 时间：2012-11-29T22:17:44.160
> 
> 标签：php, doctrine-orm

我怎样才能解决这个问题？

```
<?php

namespace entity;

/**
 * @Entity @Table(name="debt")
 * */
class Debt {

/**
 * @Id @Column(type="integer") @GeneratedValue
 * */
protected $id;

/**
 * @Column(type="integer")
 * */
protected $value;

/**
 * @ManyToOne(targetEntity="people", inversedBy="debts")
 * */
protected $who;

public function setValue($value) {
    $this->value = $value;
}

public function setWho(Who $who) {
    $this->who = $who;
}
public function getValue() {
    return $this->value;
}
public function getWho() {
    return $this->who;
}

}

<?php

namespace entity;

/**
 * @Entity @Table(name="people")
 * */
class People {

/**
 * @Id @Column(type="integer") @GeneratedValue
 * */
protected $id;

/**
 * @Column(type="string")
 * */
protected $name;

/**
 * @OneToMany(targetEntity="debt", mappedBy="who")
 * */
protected $debts;

public function setName($name) {
    $this->name = $name;
}

public function assignDebt(Debt $debt) {
    $this->debts[] = $debt;
}

public function getName() {
    return $this->name;
}

public function getDebts() {
    return $this->debts;
}

} 
```

当我尝试：`$em->getRepository("entity\Debt")->findAll()`我收到此错误：

警告：require(C:\Windows\TEMP__CG__entitypeople.php)：无法打开流：C:\xampp\htdocs\skola\vendor\doctrine\orm\lib\Doctrine\ORM\Proxy\ProxyFactory 中没有这样的文件或目录。第 92 行的 php

致命错误：require()：在 C 中打开所需的 'C:\Windows\TEMP__CG__entitypeople.php' (include_path='.;C:\xampp\php\pear;C:\pear;\xampp\php\PEAR') 失败:\xampp\htdocs\skola\vendor\doctrine\orm\lib\Doctrine\ORM\Proxy\ProxyFactory.php 在第 92 行

当我删除这部分时，它也可以工作：

```
/**
 * @ManyToOne(targetEntity="people", inversedBy="debts")
 * */
protected $who; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T22:26:14.073

您需要在 Doctrine 中设置代理目录

该目录用于编写学说的代理，当然需要有写权限

[http://docs.doctrine-project.org/en/2.0.x/reference/configuration.html#proxy-directory-required](http://docs.doctrine-project.org/en/2.0.x/reference/configuration.html#proxy-directory-required)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-11T10:49:16.503

您必须首先设置代理类的生成。您可以通过设置配置启用自动生成学说代理类： $config->setAutoGenerateProxyClasses(tr

```
$config = new Configuration;
$config->setMetadataCacheImpl($cache);
$driverImpl = $config->newDefaultAnnotationDriver('/path/to/lib/MyProject/Entities');
$config->setMetadataDriverImpl($driverImpl);
$config->setQueryCacheImpl($cache);
$config->setProxyDir('/path/to/myproject/lib/MyProject/Proxies');
$config->setProxyNamespace('MyProject\Proxies');

if ($applicationMode == "development") {
    $config->setAutoGenerateProxyClasses(true);
} else {
    $config->setAutoGenerateProxyClasses(false);
} 
```

# angularjs - AngularJS：如何在不使用属性的情况下双向绑定到父范围属性？

> ID：13635799
> 
> 赞同：1
> 
> 时间：2012-11-29T22:17:53.640
> 
> 标签：angularjs

所以我想做我在这个问题中所做的事情： [AngularJS: Two way data binding failed if element has ngModel and a directive with a local scope](https://stackoverflow.com/questions/13632042/angularjs-two-way-data-binding-fails-if-element-has-ngmodel-and-a-directive-wit)

但不使用属性值进行绑定。我试过只使用等号

```
scope: {bindToParent: '='}, 
```

但它似乎不起作用？有人可以更改此 jsfiddle： http: [//jsfiddle.net/ews7S/1/](http://jsfiddle.net/ews7S/1/) 以向我展示如何直接绑定到父属性而无需在元素中使用属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:37:30.133

你有你的小提琴：

```
<input type="text" ng-model="testModel" dir="123"> 
```

如果你不想`dir`有一个值，那么，`dir`不需要一个值。这在您的小提琴中也适用：

```
<input type="text" ng-model="testModel" dir> 
```

# javascript - d3py 示例代码中的 IO 错误——没有这样的文件或目录：'static/d3.js'

> ID：13635804
> 
> 赞同：2
> 
> 时间：2012-11-29T22:18:23.337
> 
> 标签：javascript, python, d3.js, d3py

我正在尝试运行 d3py 自述文件中可用的 d3py 示例代码（请参阅下面的链接），并且收到以下错误：

[https://github.com/mikedewar/d3py/blob/master/README.md](https://github.com/mikedewar/d3py/blob/master/README.md)

（32 位 Windows 上的 python 2.7.3）

```
>>> # instantiate the figure object
>>> fig = d3py.Figure(df, name="basic_example", width=300, height=300) 
        Traceback (most recent call last):
        File "<stdin>", line 1, in <module>
        File "build\bdist.win32\egg\d3py\d3py.py", line 97, in __init__
    IOError: [Errno 2] No such file or directory: 'static/d3.js'
>>> 
```

我在 PowerShell 中使用以下命令安装了 d3py 包：

```
easy_install https://github.com/mikedewar/d3py/tarball/master 
```

并且，在 python 会话（即`import d3py`）中导入包不会导致任何错误。我该怎么做才能使示例代码正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:02:21.697

所以 d3py 是一个非常原始的项目，老实说，我们的 setup.py 非常糟糕。这意味着您要么需要对 setup.py 进行一些修复，要么需要在项目文件夹中创建一个名为 static 的文件夹，并确保 d3.js 在该文件夹内。

假设您将使用第二个选项，只是为了清楚起见：

在终端中，切换到保存项目的目录，例如

```
cd ~/Desktop/my/awesome/project 
```

创建一个名为 static 的文件夹：

```
mkdir static 
```

然后进入该目录并从 repo 中获取 d3.js 文件：

```
cd static
curl -O https://raw.github.com/mikedewar/d3py/static/d3.js 
```

为这个可怕的黑客道歉！从 python 内部基于 d3 的绘图肯定会发生，但可能不会在这个项目中发生！

话虽如此，一旦你让它运行，d3py 就会像宣传的那样工作！一个非常流行的 d3py 用例（我们还没有完全意识到它会流行）是人们使用它来快速模拟一些 javascript，使用 d3py 的输出作为更高级的可视化的起点。

# wpf - listboxItem的布局

> ID：13635809
> 
> 赞同：0
> 
> 时间：2012-11-29T22:18:38.790
> 
> 标签：wpf, layout, listbox, datatemplate, itemtemplate

我正在尝试制作一个`ListBox`在 Item 右侧包含一个字符串，在左侧包含一个字符串的方法，我已经尝试过，但是这些字符串彼此重叠。

```
<ListBox Name="ChaptersList" Height="200" Margin="10,10,10,0" VerticalAlignment="Top" SelectionChanged="ChaptersList_SelectionChanged" MouseDoubleClick="ChaptersList_MouseDoubleClick" RenderTransformOrigin="0.5,0.5" TextOptions.TextHintingMode="Animated">
    <ListBox.RenderTransform>
        <TransformGroup>
            <ScaleTransform/>
            <SkewTransform/>
            <RotateTransform/>
            <TranslateTransform/>
        </TransformGroup>
    </ListBox.RenderTransform>

    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <Label Content="{Binding Path=Title}" VerticalAlignment="Center" Margin="5"/>
                <Label Content="{Binding Path=Name}" HorizontalAlignment="Right" Margin="5"/>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

（我的第一个字符串应该是多行的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:32:01.720

您可以使用`Grid`两行（其中`Height`设置为`Auto`）和文本换行行为，您必须将`ScrollViewer.HorizontalScrollBarVisibility="Disabled"`属性添加到`ListBox`.

```
<ListBox Name="ChaptersList" 
                 Height="250" Margin="10,10,10,0" VerticalAlignment="Top"  RenderTransformOrigin="0.5,0.5" TextOptions.TextHintingMode="Animated"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 >
            <ListBox.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </ListBox.RenderTransform>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Text="{Binding Path=Title}" TextWrapping="Wrap" HorizontalAlignment="Left" Margin="5"/>
                        <TextBlock Grid.Row="1" Text="{Binding Path=Name}" HorizontalAlignment="Right" Margin="5"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T18:00:14.140

编辑：我找到了一个简单的解决方案：使用 Expression Blend 结束编辑模板。它为您提供了一个设计师来调整布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:22:34.417

使用堆栈面板：

```
 <ListBox Name="ChaptersList" Height="200" Margin="10,10,10,0" VerticalAlignment="Top" SelectionChanged="ChaptersList_SelectionChanged" MouseDoubleClick="ChaptersList_MouseDoubleClick" RenderTransformOrigin="0.5,0.5" TextOptions.TextHintingMode="Animated">
        <ListBox.RenderTransform>
            <TransformGroup>
                <ScaleTransform/>
                <SkewTransform/>
                <RotateTransform/>
                <TranslateTransform/>
            </TransformGroup>
        </ListBox.RenderTransform>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                        <Label Content="{Binding Path=Title}" VerticalAlignment="Center" Margin="5"/>
                        <Label Content="{Binding Path=Name}" HorizontalAlignment="Right" Margin="5"/>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

# objective-c - 将 NSArray 项与 NSArray 中的所有其他项进行比较

> ID：13635811
> 
> 赞同：0
> 
> 时间：2012-11-29T22:19:10.763
> 
> 标签：objective-c, ios, nsarray

我有一个 NSArray 的 NSStrings 并且想知道如何将数组中的每个项目与数组中的每个其他项目进行比较，以查看**是否有任何与其他字符串不同的字符串**。

我看过一个 c++ 例子

```
for (int i = 0; i < list.size(); i++) {
  for (int j = i+1; j < list.size(); j++) {
    // compare list.get(i) and list.get(j)
  }
} 
```

但是，如果在目标 C 中有更好更简单的方法，那是不是很伤人？我还需要做的另一件事是确保该项目在循环时不会自我比较。

任何帮助或示例将不胜感激。

更新****粗体**是问题的更新部分**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T23:03:19.733

如果我正确阅读了您的问题，您希望字符串仅在列表中出现一次，对吗？

```
NSCountedSet *counted = [NSCountedSet setWithArray:list];
for (NSString *string in counted) {
    NSUInteger count = [counted countForObject:string];
    if (count == 1) {
        // process "string", it appears in the list just once
    }
} 
```

如果您只想知道列表中是否有多个不同的值，请执行以下操作：

```
NSSet *set = [NSSet setWithArray:list];
if (set.count == 1) {
    // There is only one distinct value in the list
} else {
    // There is more than one distinct value in the list
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:32:44.200

我会使用 NSMutableDictionary。这与“将两个列表合并为唯一值”非常相似，苹果文档实际上在某处解释了复杂的方式。我忘记了在哪里找到的，但简单的方法就在这里：[合并两个数组，同时保留原始数组顺序](https://stackoverflow.com/questions/5815695/merge-two-arrays-while-preserving-the-original-array-order)

所以你要做的是遍历所有内容，看看是否有一个键（设置为字符串），如果没有，通过 setObject: forKey: 方法添加一个，然后通过字典枚举或者只是在之后获取 allKeys 值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:34:39.543

使用两套。如果字符串进入第一组没有冲突，则将其添加到第二组。如果字符串在第一组中遇到冲突，则将其从第二组中删除。当您处理完所有字符串后，第二组包含唯一的字符串。

# java - 每个 INSERT 的表 ID 的增量值

> ID：13635812
> 
> 赞同：1
> 
> 时间：2012-11-29T22:19:11.793
> 
> 标签：java, postgresql, database-design, servlets, auto-increment

我正在使用 PostgreSQL 和我的所有表设置。我目前有`comments`一个名为主键的表，`comment_id`其`VARCHAR`长度为 4。

我有一个表单设置来向数据库中插入一个新的评论，但我很困惑如何让我的 Java servlet ++ 来自它以前的值的 comment_id。例如 0001 到 0002。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:22:00.967

您不想为您的 id 列使用 VARCHAR。在 postgres 中，您可以创建一个序列，然后为每个插入获取该序列的下一个值。

[这是文档](http://www.postgresql.org/docs/9.1/static/sql-createsequence.html)

基本上，你会做类似的事情

```
CREATE SEQUENCE mysequence START 101 
```

然后，当您插入时，您会执行类似的操作

```
INSERT INTO my_comment values (nextval('mysequence'), 'this is my comment'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T22:41:32.310

使用[**`serial`**伪数据类型](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html#DATATYPE-SERIAL)开始。它自动创建和附加序列对象，并从序列中设置`DEFAULT`为`nextval()`。它可以满足您的所有需求。列的有效类型是`integer`。还有`bigserial`. 只需点击手册的链接即可。

```
CREATE TABLE comments (
    comment_id serial PRIMARY KEY
   ,comment text NOT NULL
   ); 
```

您可以*忽略*命令列`INSERT`：

```
INSERT INTO my_comment (comment)
VALUES ('My comment here'); 
```

`comment_id`是自动填写的。
但是您应该*始终*为`INSERT`. 如果您稍后更改表格布局，您的代码可能会以有害的方式中断。可以跳过临时命令的列列表或保证表结构时（例如在同一事务中创建表时）。除此之外，提供一个列列表！

如果您想要`comment_id`返回结果，而无需再次往返服务器：

```
INSERT INTO my_comment (comment)
VALUES ('My comment here');
**RETURNING** comment_id;
```

优秀手册中的详细信息在[这里](http://www.postgresql.org/docs/current/interactive/sql-insert.html)。

# javascript - 动态添加 jPlayer

> ID：13635815
> 
> 赞同：2
> 
> 时间：2012-11-29T22:19:18.353
> 
> 标签：javascript, jquery, jplayer

我有以下代码，用于尝试通过函数动态添加 jplayers。

```
function audio_player(audio, title, type) {

    var id = $('.audio').length;

    $('#audio').append('<div id="jquery_jplayer_'+id+'" class="audio"></div><div id="jp_container_'+id+'" class="jp-audio"><div class="jp-type-single"><div class="jp-gui jp-interface"><ul class="jp-controls"><li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li><li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li><li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li><li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li><li><a href="javascript:;" class="jp-unmute" tabindex="1" title="unmute">unmute</a></li><li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li></ul><div class="jp-progress"><div class="jp-seek-bar"><div class="jp-play-bar"></div></div></div><div class="jp-volume-bar"><div class="jp-volume-bar-value"></div></div><div class="jp-time-holder"><div class="jp-current-time"></div><div class="jp-duration"></div></div></div><div class="jp-title"><ul><li>'+title+'</li></ul></div><div class="jp-no-solution"><span>Update Required</span>To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.</div></div></div>');

    $("#jquery_jplayer_"+id).jPlayer({
        ready: function () {
            $(this).jPlayer("setMedia", {
                mp3: audio
            });
        },
        play: function() { // To avoid jPlayers playing together.
            $(this).jPlayer("pauseOthers");
        },
        swfPath: "../js",
        cssSelectorAncestor:"#jp_container_"+id,
        supplied: type,
        errorAlerts: true,
        warningAlerts: false,
        wmode:"window"
    });
}

$(document).ready(function() {
    audio_player("http://www.jplayer.org/audio/mp3/TSP-01-Cro_magnon_man.mp3", "Test Title", "mp3");
    audio_player("http://www.jplayer.org/audio/mp3/TSP-01-Cro_magnon_man.mp3", "Test2 Title", "mp3");
}); 
```

使用此代码，我收到错误

```
TypeError: $(...).jPlayer is not a function 

wmode:"window" 
```

当我使用相同的代码时，只在他们的演示中进行设置（document.ready() 中的所有 javascript 并静态声明）一切正常。

关于出了什么问题/如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T18:19:33.853

最终通过这样做来解决它：

```
$(document).ready(function() {
    function audio_player(audio, title, type) {

      var id = $('.audio').length;

      $('#audio').append('<div id="jquery_jplayer_'+id+'" class="audio" data-file="'+audio+'" data-type="'+type+'"></div><div id="jp_container_'+id+'" class="jp-audio"><div class="jp-type-single"><div class="jp-gui jp-interface"><ul class="jp-controls"><li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li><li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li><li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li><li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li><li><a href="javascript:;" class="jp-unmute" tabindex="1" title="unmute">unmute</a></li><li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li></ul><div class="jp-progress"><div class="jp-seek-bar"><div class="jp-play-bar"></div></div></div><div class="jp-volume-bar"><div class="jp-volume-bar-value"></div></div><div class="jp-time-holder"><div class="jp-current-time"></div><div class="jp-duration"></div></div></div><div class="jp-title"><ul><li>'+title+'</li></ul></div><div class="jp-no-solution"><span>Update Required</span>To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.</div></div></div>');

      $('#jquery_jplayer_'+id).jPlayer({
          ready: function(event) {
              $(this).jPlayer("setMedia", {
                  mp3: $(this).attr('data-file')
              });
          },
          play: function() { // To avoid both jPlayers playing together.
              $(this).jPlayer("pauseOthers");
          },
          swfPath: js,
          cssSelectorAncestor:'#jp_container_'+id,
          supplied: type,
          errorAlerts: true,
          warningAlerts: false,
          wmode:"window"
      });
    }

    audio_player("file.mp3", "Test Title", "mp3");
    audio_player("file2.mp3", "Test2 Title", "mp3");
}); 
```

# jquery - jQuery 与另一个 jQuery 冲突

> ID：13635816
> 
> 赞同：0
> 
> 时间：2012-11-29T22:19:26.090
> 
> 标签：jquery, conflict

我有一个奇怪的案例，我相信两个 jQuery 插件相互冲突：一方面，我有一个 [ddsmoothmenu][1] 在我安装（WP 插件）Revolution 滑块之前一直运行良好插入。安装后，菜单停止工作。该插件具有无冲突模式，一旦打开，可以解决菜单问题，但来自其他文件/插件的其他 jQuery 效果停止工作。一种解决方案是更换菜单，但我真的很喜欢而且宁愿不这样做（除非绝对必要）。

有什么建议么？

非常感谢

更新：这里是菜单 jQuery：

```
var ddsmoothmenu={

//Specify full URL to down and right arrow images (23 is padding-right added to top level LIs with drop downs):
arrowimages: {down:['downarrowclass', 'down.gif', 11], right:['rightarrowclass', 'down.gif']},
transition: {overtime:300, outtime:300}, //duration of slide in/ out animation, in milliseconds
shadow: {enable:false, offsetx:5, offsety:5}, //enable shadow?
showhidedelay: {showdelay: 100, hidedelay: 200}, //set delay in milliseconds before sub menus appear and disappear, respectively

detectwebkit: navigator.userAgent.toLowerCase().indexOf("applewebkit")!=-1, //detect WebKit browsers (Safari, Chrome etc)
detectie6: document.all && !window.XMLHttpRequest,
css3support: window.msPerformance || (!document.all && document.querySelector), //detect browsers that support CSS3 box shadows (ie9+ or FF3.5+, Safari3+, Chrome etc)
ismobile:navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i) != null,     //boolean check for popular mobile browsers

getajaxmenu:function($, setting){ //function to fetch external page containing the panel DIVs
var $menucontainer=$('#'+setting.contentsource[0]) //reference empty div on page that will hold menu
$menucontainer.html("Loading Menu...")
$.ajax({
    url: setting.contentsource[1], //path to external menu file
    async: true,
    error:function(ajaxrequest){
        $menucontainer.html('Error fetching content. Server Response: '+ajaxrequest.responseText)
    },
    success:function(content){
        $menucontainer.html(content)
        ddsmoothmenu.buildmenu($, setting)
    }
}) 
```

},

```
buildmenu:function($, setting){
var smoothmenu=ddsmoothmenu
var $mainmenu=$("#"+setting.mainmenuid+">ul") //reference main menu UL
$mainmenu.parent().get(0).className=setting.classname || "ddsmoothmenu"
var $headers=$mainmenu.find("ul").parent()
$headers.hover(
    function(e){
        $(this).children('a:eq(0)').addClass('selected')
    },
    function(e){
        $(this).children('a:eq(0)').removeClass('selected')
    }
)
$headers.each(function(i){ //loop through each LI header
    var $curobj=$(this).css({zIndex: 100-i}) //reference current LI header
    var $subul=$(this).find('ul:eq(0)').css({display:'block'})
    $subul.data('timers', {})
    this._dimensions={w:this.offsetWidth, h:this.offsetHeight, subulw:$subul.outerWidth(), subulh:$subul.outerHeight()}
    this.istopheader=$curobj.parents("ul").length==1? true : false //is top level header?
    $subul.css({top:this.istopheader && setting.orientation!='v'? this._dimensions.h+"px" : 0})
    $curobj.children("a:eq(0)").css(this.istopheader? {paddingRight: smoothmenu.arrowimages.down[2]} : {}).append( //add arrow images
        '<img src="'+ (this.istopheader && setting.orientation!='v'? smoothmenu.arrowimages.down[1] : smoothmenu.arrowimages.right[1])
        +'" class="' + (this.istopheader && setting.orientation!='v'? smoothmenu.arrowimages.down[0] : smoothmenu.arrowimages.right[0])
        + '" style="border:0;" />'
    )
    if (smoothmenu.shadow.enable && !smoothmenu.css3support){ //if shadows enabled and browser doesn't support CSS3 box shadows
        this._shadowoffset={x:(this.istopheader?$subul.offset().left+smoothmenu.shadow.offsetx : this._dimensions.w), y:(this.istopheader? $subul.offset().top+smoothmenu.shadow.offsety : $curobj.position().top)} //store this shadow's offsets
        if (this.istopheader)
            $parentshadow=$(document.body)
        else{
            var $parentLi=$curobj.parents("li:eq(0)")
            $parentshadow=$parentLi.get(0).$shadow
        }
        this.$shadow=$('<div class="ddshadow'+(this.istopheader? ' toplevelshadow' : '')+'"></div>').prependTo($parentshadow).css({left:this._shadowoffset.x+'px', top:this._shadowoffset.y+'px'})  //insert shadow DIV and set it to parent node for the next shadow div
    }
    $curobj.hover(
        function(e){
            var $targetul=$subul //reference UL to reveal
            var header=$curobj.get(0) //reference header LI as DOM object
            clearTimeout($targetul.data('timers').hidetimer)
            $targetul.data('timers').showtimer=setTimeout(function(){
                header._offsets={left:$curobj.offset().left, top:$curobj.offset().top}
                var menuleft=header.istopheader && setting.orientation!='v'? 0 : header._dimensions.w
                menuleft=(header._offsets.left+menuleft+header._dimensions.subulw>$(window).width())? (header.istopheader && setting.orientation!='v'? -header._dimensions.subulw+header._dimensions.w : -header._dimensions.w) : menuleft //calculate this sub menu's offsets from its parent
                if ($targetul.queue().length<=1){ //if 1 or less queued animations
                    $targetul.css({left:menuleft+"px", width:header._dimensions.subulw+'px'}).animate({height:'show',opacity:'show'}, ddsmoothmenu.transition.overtime)
                    if (smoothmenu.shadow.enable && !smoothmenu.css3support){
                        var shadowleft=header.istopheader? $targetul.offset().left+ddsmoothmenu.shadow.offsetx : menuleft
                        var shadowtop=header.istopheader?$targetul.offset().top+smoothmenu.shadow.offsety : header._shadowoffset.y
                        if (!header.istopheader && ddsmoothmenu.detectwebkit){ //in WebKit browsers, restore shadow's opacity to full
                            header.$shadow.css({opacity:1})
                        }
                        header.$shadow.css({overflow:'', width:header._dimensions.subulw+'px', left:shadowleft+'px', top:shadowtop+'px'}).animate({height:header._dimensions.subulh+'px'}, ddsmoothmenu.transition.overtime)
                    }
                }
            }, ddsmoothmenu.showhidedelay.showdelay)
        },
        function(e){
            var $targetul=$subul
            var header=$curobj.get(0)
            clearTimeout($targetul.data('timers').showtimer)
            $targetul.data('timers').hidetimer=setTimeout(function(){
                $targetul.animate({height:'hide', opacity:'hide'}, ddsmoothmenu.transition.outtime)
                if (smoothmenu.shadow.enable && !smoothmenu.css3support){
                    if (ddsmoothmenu.detectwebkit){ //in WebKit browsers, set first child shadow's opacity to 0, as "overflow:hidden" doesn't work in them
                        header.$shadow.children('div:eq(0)').css({opacity:0})
                    }
                    header.$shadow.css({overflow:'hidden'}).animate({height:0}, ddsmoothmenu.transition.outtime)
                }
            }, ddsmoothmenu.showhidedelay.hidedelay)
        }
    ) //end hover
}) //end $headers.each()
if (smoothmenu.shadow.enable && smoothmenu.css3support){ //if shadows enabled and browser supports CSS3 shadows
    var $toplevelul=$('#'+setting.mainmenuid+' ul li ul')
    var css3shadow=parseInt(smoothmenu.shadow.offsetx)+"px "+parseInt(smoothmenu.shadow.offsety)+"px 5px #aaa" //construct CSS3 box-shadow value
    var shadowprop=["boxShadow", "MozBoxShadow", "WebkitBoxShadow", "MsBoxShadow"] //possible vendor specific CSS3 shadow properties
    for (var i=0; i<shadowprop.length; i++){
        $toplevelul.css(shadowprop[i], css3shadow)
    }
}
$mainmenu.find("ul").css({display:'none', visibility:'visible'}) 
```

},

```
init:function(setting){
if (typeof setting.customtheme=="object" && setting.customtheme.length==2){ //override default menu colors (default/hover) with custom set?
    var mainmenuid='#'+setting.mainmenuid
    var mainselector=(setting.orientation=="v")? mainmenuid : mainmenuid+', '+mainmenuid
    document.write('<style type="text/css">\n'
        +mainselector+' ul li a {background:'+setting.customtheme[0]+';}\n'
        +mainmenuid+' ul li a:hover {background:'+setting.customtheme[1]+';}\n'
    +'</style>')
}
this.shadow.enable=(document.all && !window.XMLHttpRequest)? false : this.shadow.enable //in IE6, always disable shadow
jQuery(document).ready(function($){ //ajax menu?
    if (typeof setting.contentsource=="object"){ //if external ajax menu
        ddsmoothmenu.getajaxmenu($, setting)
    }
    else{ //else if markup menu
        ddsmoothmenu.buildmenu($, setting)
    }
}) 
```

}

```
} //end ddsmoothmenu variable​​ 
```

不，我不会加载多个版本的 jQuery。我正在通过 WordPress 中的注册和入队脚本加载所有 jQuery（对不起，如果我之前不清楚，这是一个 WordPress 网站）。

WordPress Revolution Slider 的代码是一个高级插件，所以我不确定我是否可以在此处发布。如果有人能帮我澄清一下，我也很乐意补充

更新2：经过额外测试，有冲突的jQuery文件是这两个（上面一个和这个）：

```
(function($) {
var aux     = {
        // navigates left / right
        navigate    : function( dir, $el, $wrapper, opts, cache ) {

            var scroll      = opts.scroll,
                factor      = 1,
                idxClicked  = 0;

            if( cache.expanded ) {
                scroll      = 1; // scroll is always 1 in full mode
                factor      = 3; // the width of the expanded item will be 3 times bigger than 1 collapsed item 
                idxClicked  = cache.idxClicked; // the index of the clicked item
            }

            // clone the elements on the right / left and append / prepend them according to dir and scroll
            if( dir === 1 ) {
                $wrapper.find('div.ca-item:lt(' + scroll + ')').each(function(i) {
                    $(this).clone(true).css( 'left', ( cache.totalItems - idxClicked + i ) * cache.itemW * factor + 'px' ).appendTo( $wrapper );
                });
            }
            else {
                var $first  = $wrapper.children().eq(0);

                $wrapper.find('div.ca-item:gt(' + ( cache.totalItems  - 1 - scroll ) + ')').each(function(i) {
                    // insert before $first so they stay in the right order
                    $(this).clone(true).css( 'left', - ( scroll - i + idxClicked ) * cache.itemW * factor + 'px' ).insertBefore( $first );
                });
            }

            // animate the left of each item
            // the calculations are dependent on dir and on the cache.expanded value
            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this);
                $item.stop().animate({
                    left    :  ( dir === 1 ) ? '-=' + ( cache.itemW * factor * scroll ) + 'px' : '+=' + ( cache.itemW * factor * scroll ) + 'px'
                }, opts.sliderSpeed, opts.sliderEasing, function() {
                    if( ( dir === 1 && $item.position().left < - idxClicked * cache.itemW * factor ) || ( dir === -1 && $item.position().left > ( ( cache.totalItems - 1 - idxClicked ) * cache.itemW * factor ) ) ) {
                        // remove the item that was cloned
                        $item.remove();
                    }                       
                    cache.isAnimating   = false;
                });
            });

        },
        // opens an item (animation) -> opens all the others
        openItem    : function( $wrapper, $item, opts, cache ) {
            cache.idxClicked    = $item.index();
            // the item's position (1, 2, or 3) on the viewport (the visible items) 
            cache.winpos        = aux.getWinPos( $item.position().left, cache );
            $wrapper.find('div.ca-item').not( $item ).hide();
            $item.find('div.ca-content-wrapper').css( 'left', cache.itemW + 'px' ).stop().animate({
                width   : cache.itemW * 2 + 'px',
                left    : cache.itemW + 'px'
            }, opts.itemSpeed, opts.itemEasing)
            .end()
            .stop()
            .animate({
                left    : '0px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating   = false;
                cache.expanded      = true;

                aux.openItems( $wrapper, $item, opts, cache );
            });

        },
        // opens all the items
        openItems   : function( $wrapper, $openedItem, opts, cache ) {
            var openedIdx   = $openedItem.index();

            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this),
                    idx     = $item.index();

                if( idx !== openedIdx ) {
                    $item.css( 'left', - ( openedIdx - idx ) * ( cache.itemW * 3 ) + 'px' ).show().find('div.ca-content-wrapper').css({
                        left    : cache.itemW + 'px',
                        width   : cache.itemW * 2 + 'px'
                    });

                    // hide more link
                    aux.toggleMore( $item, false );
                }
            });
        },
        // show / hide the item's more button
        toggleMore  : function( $item, show ) {
            ( show ) ? $item.find('a.ca-more').show() : $item.find('a.ca-more').hide(); 
        },
        // close all the items
        // the current one is animated
        closeItems  : function( $wrapper, $openedItem, opts, cache ) {
            var openedIdx   = $openedItem.index();

            $openedItem.find('div.ca-content-wrapper').stop().animate({
                width   : '0px'
            }, opts.itemSpeed, opts.itemEasing)
            .end()
            .stop()
            .animate({
                left    : cache.itemW * ( cache.winpos - 1 ) + 'px'
            }, opts.itemSpeed, opts.itemEasing, function() {
                cache.isAnimating   = false;
                cache.expanded      = false;
            });

            // show more link
            aux.toggleMore( $openedItem, true );

            $wrapper.find('div.ca-item').each(function(i) {
                var $item   = $(this),
                    idx     = $item.index();

                if( idx !== openedIdx ) {
                    $item.find('div.ca-content-wrapper').css({
                        width   : '0px'
                    })
                    .end()
                    .css( 'left', ( ( cache.winpos - 1 ) - ( openedIdx - idx ) ) * cache.itemW + 'px' )
                    .show();

                    // show more link
                    aux.toggleMore( $item, true );
                }
            });
        },
        // gets the item's position (1, 2, or 3) on the viewport (the visible items)
        // val is the left of the item
        getWinPos   : function( val, cache ) {
            switch( val ) {
                case 0                  : return 1; break;
                case cache.itemW        : return 2; break;
                case cache.itemW * 2    : return 3; break;
            }
        }
    },
    methods = {
        init        : function( options ) {

            if( this.length ) {

                var settings = {
                    sliderSpeed     : 500,          // speed for the sliding animation
                    sliderEasing    : 'easeOutExpo',// easing for the sliding animation
                    itemSpeed       : 500,          // speed for the item animation (open / close)
                    itemEasing      : 'easeOutExpo',// easing for the item animation (open / close)
                    scroll          : 1             // number of items to scroll at a time
                };

                return this.each(function() {

                    // if options exist, lets merge them with our default settings
                    if ( options ) {
                        $.extend( settings, options );
                    }

                    var $el             = $(this),
                        $wrapper        = $el.find('div.ca-wrapper'),
                        $items          = $wrapper.children('div.ca-item'),
                        cache           = {};

                    // save the with of one item    
                    cache.itemW         = $items.width();
                    // save the number of total items
                    cache.totalItems    = $items.length;

                    // add navigation buttons
                    if( cache.totalItems > 3 )  
                        $el.prepend('<div class="ca-nav"><span class="ca-nav-prev">Previous</span><span class="ca-nav-next">Next</span></div>') 

                    // control the scroll value
                    if( settings.scroll < 1 )
                        settings.scroll = 1;
                    else if( settings.scroll > 3 )
                        settings.scroll = 3;    

                    var $navPrev        = $el.find('span.ca-nav-prev'),
                        $navNext        = $el.find('span.ca-nav-next');

                    // hide the items except the first 3
                    $wrapper.css( 'overflow', 'hidden' );

                    // the items will have position absolute 
                    // calculate the left of each item
                    $items.each(function(i) {
                        $(this).css({
                            position    : 'absolute',
                            left        : i * cache.itemW + 'px'
                        });
                    });

                    // click to open the item(s)
                    $el.find('a.ca-more').live('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        $(this).hide();
                        var $item   = $(this).closest('div.ca-item');
                        aux.openItem( $wrapper, $item, settings, cache );
                        return false;
                    });

                    // click to close the item(s)
                    $el.find('a.ca-close').live('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        var $item   = $(this).closest('div.ca-item');
                        aux.closeItems( $wrapper, $item, settings, cache );
                        return false;
                    });

                    // navigate left
                    $navPrev.bind('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        aux.navigate( -1, $el, $wrapper, settings, cache );
                    });

                    // navigate right
                    $navNext.bind('click.contentcarousel', function( event ) {
                        if( cache.isAnimating ) return false;
                        cache.isAnimating   = true;
                        aux.navigate( 1, $el, $wrapper, settings, cache );
                    });

                    // adds events to the mouse
                    $el.bind('mousewheel.contentcarousel', function(e, delta) {
                        if(delta > 0) {
                            if( cache.isAnimating ) return false;
                            cache.isAnimating   = true;
                            aux.navigate( -1, $el, $wrapper, settings, cache );
                        }   
                        else {
                            if( cache.isAnimating ) return false;
                            cache.isAnimating   = true;
                            aux.navigate( 1, $el, $wrapper, settings, cache );
                        }   
                        return false;
                    });

                });
            }
        }
    };

$.fn.contentcarousel = function(method) {
    if ( methods[method] ) {
        return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
        return methods.init.apply( this, arguments );
    } else {
        $.error( 'Method ' +  method + ' does not exist on jQuery.contentcarousel' );
    }
};

})(jQuery); 
```

关于如何使这项工作的任何想法？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:39:31.443

Jquery 插件通常如下所示：

```
(function( $ ) {
  $.fn.myPlugin = function() {
    // Do your awesome plugin stuff here
  };
})( jQuery ); 
```

尝试将 myPlugin 重命名为另一个。两个插件可以使用其他类似插件但不同版本的插件吗？您可以找到它们，并重命名其中一个重复项，但您需要禁用更新已更改的 WordPress 插件

# batch-file - Installshield - 如何让安装程序将批处理文件引发的错误显示为弹出窗口

> ID：13635817
> 
> 赞同：1
> 
> 时间：2012-11-29T22:19:25.107
> 
> 标签：batch-file, installshield

我目前正在创建安装程序。我有一个批处理文件，它检查任务列表以查看任务是否正在运行。如果任务正在运行 - 我想暂停安装程序并让用户选择重试或关闭。用户将手动关闭任务并点击重试或关闭安装程序。

我不确定如何将批处理文件错误响应与 installshield 联系起来。

是否可以单独使用批处理文件而不涉及安装脚本来执行此活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T01:50:02.450

这是不可能的。.BAT 文件超出进程，无法与 InstallShield 通信。

使用 InstallScript，您可以查询 WMI (Win32_Process) 并以更强大的方式驱动 UI。

# asp.net - 无法从 MVC2 升级到 MVC3

> ID：13635818
> 
> 赞同：3
> 
> 时间：2012-11-29T22:19:28.987
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-2

我有一个使用 .NET Framework 4 的 MVC2 Web 应用程序，并按照T 的[这些](http://www.asp.net/whitepapers/mvc3-release-notes#upgrading)说明进行操作。但是，在第 10 步，当我保存更新的*ProjectTypeGuids*时，我收到一条消息，提示**“ 无法打开项目文件*projectname* .csproj。此安装不支持项目类型。”**

我确实安装了 MVC3 并且正在运行 VS2010，所以我不知道出了什么问题。有人对此事有任何想法吗？谢谢！

编辑：

物有所值。如果我从头开始创建一个空白项目，我就有能力创建一个新的 MVC3 项目。但是，如果我右键单击我的解决方案并单击*添加*->*新项目...*我只能添加 MVC2 项目。这使我认为该解决方案以某种方式配置为仅支持 MVC2，但是我不知道如何更改它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:48:49.260

有一个额外的包是[ASP.NET MVC 3 Tools Update](http://www.microsoft.com/en-us/download/details.aspx?id=1491)，你也必须下载并安装它。

解决方案1：

打开 Visual Studio 在文件中查找对话框并选择您的项目文件夹，然后搜索旧 GUID 并将其替换为新的。在执行此操作之前备份目录。实际上，您必须选择整个解决方案文件夹并搜索所有文件而不是特定扩展名。

解决方案 2：您必须仔细查看您的 csproj 和 sln 文件，并将其与您系统上正在运行的文件进行比较，以找出差异。如果您有 winmerge 之类的文件比较工具，请使用它逐个字符地比较文件

# html - 为什么相对 div 不生成高度？

> ID：13635819
> 
> 赞同：3
> 
> 时间：2012-11-29T22:19:37.447
> 
> 标签：html, css, css-position

我有一个 2 列网格。在第 1 列中，将有一个 div 的多个实例。在一个 div 内有两个绝对定位的 div - 一个数字和一个描述。出于某种原因，当我有多个 div 时，它们会相互堆叠，这是因为“模板”div 没有高度。

为什么其中的内容不会自动生成高度`div`？

```
.main {
  position: relative;
  margin: 25px 0;
  display: block;
}

.col1 {
  width: 200px;
  position: absolute;
  left: 0;
}

.col2 {
  width: 200px;
  position: absolute;
  right: 0;
}

.indicator {
  width: 10px;
  height: 10px;
  background-color: #0f0;
  color: #454;
  position: absolute;
  left: 0;
}

.text {
  position: absolute;
  right: 0;
}

.box {
  position: relative;
}
```

```
<div class="main">
  <div class="col1">
    <div class="box">
      <div class="indicator">
        1
      </div>
      <div class="text">
        Text text text text text text text text text text text text text text text text text text text text text text text text text.
      </div>
    </div>

    <div class="box">
      <div class="indicator">
        1
      </div>
      <div class="text">
        Text text text text text text text text text text text text text text text text text text text text text text text text text.
      </div>
    </div>

    <div class="box">
      <div class="indicator">
        1
      </div>
      <div class="text">
        Text text text text text text text text text text text text text text text text text text text text text text text text text.
      </div>
    </div>

    <div class="box">
      <div class="indicator">
        1
      </div>
      <div class="text">
        Text text text text text text text text text text text text text text text text text text text text text text text text text.
      </div>
    </div>

  </div>

  <div class="col2">
    Col 2 content.
  </div>
</div>
```

小提琴：http: [//jsfiddle.net/techydude/UcFXX/1/](http://jsfiddle.net/techydude/UcFXX/1/)

这是一个非常基本的问题，但我宁愿理解问题背后的原因，而不是通过增加高度来解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:23:03.837

绝对定位将元素从“流”中移除，因此就其父级而言，它并不真正存在，也不会计算为父级高度的一部分。

# php - 将查询转换为数组

> ID：13635824
> 
> 赞同：0
> 
> 时间：2012-11-29T22:19:56.353
> 
> 标签：php

我正在尝试将查询结果转换为数组。

转这个

```
$result = mysql_query("SELECT * FROM WHATEVER"); 
```

进入

```
$result = array('id' => 1, 'name' => 'bob'); 
```

但我不想`print_r()`，我想回显 php 可执行代码。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:26:50.753

尝试：

```
$records = array();
$query = mysql_query("SELECT * FROM WHATEVER ");
while ($result = mysql_fetch_assoc($query)) {
    $records[] = $result;
} 
```

现在您可以`$records`用作您的（可重复使用的）数组。

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:26:41.853

您可以使用 PDO 和[PDOStatement::fetchAll()](http://php.net/manual/en/pdostatement.fetchall.php)

```
$dsn = 'mysql:dbname=testdb;host=127.0.0.1';
$user = 'dbuser';
$password = 'dbpass';
$dbh = new PDO($dsn, $user, $password);
$sth = $dbh->prepare("SELECT * FROM WHATEVER");
$sth->execute();
$results = $sth->fetchAll(); // get all rows
var_dump($results);

//to get only first row:
$result = $results[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:33:31.190

尝试：

```
while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
 printf("ID: %s  Name: %s", $row["id"], $row["name"]); //or echo
} 
```

[手动的](http://php.net/manual/en/function.mysql-fetch-array.php)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-29T22:25:59.920

简单的：

```
$result = mysql_query("SELECT * FROM WHATEVER ");
if($result)
{
$result = mysql_fetch_array($result,MYSQL_ASSOC);
/*
manipule $result according you need
*/
print_r($result);
}
else{
echo mysql_error();
} 
```

# c# - 如何使类型在所有命名空间中可用？

> ID：13635829
> 
> 赞同：-1
> 
> 时间：2012-11-29T22:20:29.223
> 
> 标签：c#, namespaces, using

我以通常的方式使 Excel 对象可用于一个类：

`using Excel=Microsoft.Office.Interop.Excel;`

但是，我将在这个项目中开发许多类，其中大部分都需要使用 Excel 对象，而且似乎我必须将它放在每个文件的标题中。有没有办法让我以某种方式`using`在项目级别输入此语句，这样我就不必在每个文件中添加它，并且如果由于某种原因我决定开始使用不同的 Excel 库，则更容易更改？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T22:23:04.523

不，C# 中没有项目范围的`using`指令。您需要在每个想要利用它的文件中添加一个指令。

# asp.net - 当服务器处于压力之下时，Http 400 到中间层

> ID：13635831
> 
> 赞同：2
> 
> 时间：2012-11-29T22:20:42.910
> 
> 标签：asp.net, .net, asmx, begininvoke, http-status-code-400

我正在做一个项目，我们有一个 asp.net 网站，它使 asmx Web 服务调用到中间层。中间层的超时时间为 5 秒。我们注意到的一件事是，在流量高峰期，我们偶尔会在调用中间层时获得 http 400。

我们已经对其中一些 http 400 请求在网站层进行了网络跟踪，并注意到 1）3 次 tcp 握手速度很快 2）帖子的实际第一个数据包直到 5 秒后才启动。来自帖子第一个数据包的 ack 很快返回 3) 此后不久发送了一个 fin ack（可能是由于超时），之后 Web 服务层快速返回 http 400（400 可以理解为 post不完整）

有时在第 3 步之前会有额外的 5 秒延迟。知道为什么会发生这种情况吗？第 2 步对我来说是一个非常奇怪的行为。在发送帖子之前是否存在资源争用导致此延迟？也许某种可以以不同方式配置的资源？

我们使用标准的 .net 异步方法来发出请求 (BeginInvoke)。在我们调用 api 之前，帖子正文完全可以作为字符串使用。

我认为 cpu 可能太高了，导致 2 之前的延迟。以前有人见过吗？我知道这段时间cpu至少有80%。它可能会更高，但我们的性能计数器不是很高的分辨率。我们正在尝试在重现期间获得更高分辨率的性能计数器，以进一步确认这一点。如果您有任何其他想法，请告诉我！

谢谢！

# javascript - 构建一个有效的 js/jQ 'thousands' 逗号分隔符，适用于大数字 (10^6+)

> ID：13635833
> 
> 赞同：0
> 
> 时间：2012-11-29T22:20:48.977
> 
> 标签：javascript, jquery

我已经花时间研究了每个建议的解决方案，以解决在用户键入时调整用户输入字符串以格式化大数字以具有逗号分隔符的问题：

9999999999 --> 9,999,999,999 等等。

这里有几个关于堆栈溢出的讨论：

[如何在 JavaScript 中用逗号打印一个数字作为千位分隔符](https://stackoverflow.com/questions/2901102/how-to-print-number-with-commas-as-thousands-separators-in-javascript)

[添加逗号作为千位分隔符（javascript） - 输出被删除](https://stackoverflow.com/questions/13621769/adding-comma-as-thousands-separator-javascript-output-being-deleted-instead)

还有更多相关的查询，我已经测试了我能找到的那些，它们对于高达 4 或 5 的幂的数字效果很好，例如 12,345 很好，

但是更大的数字最终会带有太多的逗号：

1,,,,,0,,,0,,,000

例如是我目前已经实现的代码的输出。（它还将退格键注册为击键，所以当我退格三次时，它会添加一个逗号......）

```
function numberWithCommas(n){
    var s=n.split('.')[1];
    (s) ? s="."+s : s="";
    n=n.split('.')[0]
    while(n.length>3){
        s=","+n.substr(n.length-3,3)+s;
        n=n.substr(0,n.length-3)
    }
    return n+s
} 
```

然后在输入上：

```
onkeyup="this.value=numberWithCommas(this.value);" 
```

我是否错误地使用了该功能？或者它对于更大的数字根本不可行。有没有办法可以调整它以适用于任何大小的数字？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:24:54.037

您只是将逗号添加到第一次迭代后已经作为逗号的值......您应该在函数开头重置逗号`numberWithCommas`：

```
n = n.replace(/,/g, ""); 
```

# c# - 用户在 MVC 模式中动态创建的页面？

> ID：13635834
> 
> 赞同：-2
> 
> 时间：2012-11-29T22:20:50.537
> 
> 标签：c#, asp.net-mvc-3, data-structures

我尝试使用 MVC、C# 实现用户动态创建的页面。我的意思是用户可以创建一个包含用户选择的组件的页面，而我说的是动态页面。我不是指页面上的动态数据网格。

我应该怎么办 ？

我应该如何找到解决方案？

我应该如何设计一个结构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:36:33.643

***根据您的标题更改（MVC 不是 WPF）：***

您可以通过会话状态和称为模型绑定的概念在 MVC 中的请求之间保留/传输数据，该概念本质上可以帮助您从控件中的任何对象中隐藏对象，以及表单变量等。

无论使用会话状态，这里都有更多信息：http: [//msdn.microsoft.com/en-us/library/ms972429.aspx](http://msdn.microsoft.com/en-us/library/ms972429.aspx)

以及有关 MVC 模型绑定的更多信息：http: [//msdn.microsoft.com/en-us/magazine/hh781022.aspx](http://msdn.microsoft.com/en-us/magazine/hh781022.aspx)

希望能帮助到你

# c++ - C++ 中的特殊 Person 类

> ID：13635840
> 
> 赞同：1
> 
> 时间：2012-11-29T22:21:40.423
> 
> 标签：c++, arrays, class

我是 C++ 的新手，因为我正在大学学习它，但我遇到了一个问题。我有一个项目要做，应该很容易做，但我似乎遇到了一些困难。我必须实现一个 Person 类，它正好有 3 个参数：姓名、名字（这是我的大问题，因为可以在 char* 数组中放入多个姓名，所以它将是一个 char**）和年龄。我的老师给了我一个 testPerson.cc 文件，它使用我的 Person 类来创建几种类型的 Person。我的问题是当我创建构造函数时，因为我必须处理几种情况：例如，如果一个人只有一个名字，例如：

```
 const Personne lea ("Tralala", "Lea", 45); 
```

或者一个人有几个名字：

```
 const char* prenoms1[] = {"Marcel", "Firmin", "Gaston", 0};
  const Personne marcel ("Meharcele",  prenoms1, 78); 
```

我确信我必须有 3 个属性：name(char*)、firstname(char**)、age(int)。

这是老师给我的文件中的一个片段（在创建我的 Person 类时我必须尊重）：

```
int main () {
  cout << "We create the next persons:\n";

  // version of constructor with several names:
  const char* prenoms1[] = {"Marcel", "Firmin", "Gaston", 0};
  const Personne marcel ("Meharcele",  prenoms1, 78);

  // version of constructor with only one name:
  const Personne lea ("Tralala", "Lea", 45); 
```

如您所见，对于只有 1 个 fname 或多个 fname 的情况，我需要几个构造函数这是我的类：

```
#include "personne.h"

Personne::Personne(const char* name, const char** fnames, int a) {
    nom = name;
    prenom = fnames;
    age = a;

}
Personne::Personne(const char* name, const char* fname, int a) {
    nom = name;
    prenom = fname; //here I have a problem, since the attribute prenom is of type char**
    age = a;

}

void Personne::setAge(int& a) {
  age = a;
}

void Personne::setNom(const char* name) {
  nom = name;
}

void Personne::setPrenoms(const char** fnames) {

}

int Personne::getAge() const {
  return age;
}

char* Personne::getNom() const {
  return nom;
}

char** Personne::getPrenoms() const {
  return prenom;
} 
```

我花了几个小时思考一个解决方案，我搜索了很多（所以我做了功课），只是我不知道如何实施正确的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:29:22.630

一些考虑：

*   单个名字可以看作是一个元素的数组，因此您仍然可以使用数组在内部存储名字列表，并在只有一个时让它的大小为 1。
*   在您的构造函数中，您正在分配在构造函数的调用者中分配在堆栈上的指针，虽然这不会在您的特定剪辑中产生问题，但这不是正确的方法：您应该创建自己的每个副本人的价值，这样他们就不会在参数丢失后丢失并在析构函数中管理它们的`Personne`破坏`~Personne()`
*   我不知道你是否被允许使用 STL 库，在这种情况下考虑使用[`string`](http://www.cplusplus.com/reference/string/string/)来存储名称和名称[`vector<string>`](http://www.cplusplus.com/reference/vector/vector/)列表，它们会为你做大部分的脏活

# javascript - jquery使带有图像的div变小

> ID：13635842
> 
> 赞同：0
> 
> 时间：2012-11-29T22:21:55.373
> 
> 标签：javascript, jquery, fadeout

嘿伙计们，我在一个 div 中得到了一个图像，并通过延迟将其在特定时间向下移动。我只是想知道它什么时候向下移动，我如何使它随着它沿着屏幕向下移动而变得更小，直到它最终在我给它的特定位置完全消失。

到目前为止，此代码使其向下移动，并带有延迟功能和持续时间。

```
$('#fourth').animate({
    width: '100px',
    height: '100px'
}, 3000, function() {
    $(this).show('fast').animate({
        top : '-=-100'
    }, 
    {duration: 2000}
) 
```

感谢所有的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:30:42.523

只需将宽度和高度添加到`animate`.

```
$(this).show('fast').animate({
    top : '-=-100',
    width: 0,
    height: 0
}, 
{duration: 2000}) 
```

[http://jsfiddle.net/xMV5Q/1/](http://jsfiddle.net/xMV5Q/1/)

此外，`-=-`与`+=`哪个更易于理解的相同。

# facebook - 在调用 FB.init() 之前调用自动创建 FB.getLoginStatus()

> ID：13635848
> 
> 赞同：1
> 
> 时间：2012-11-29T22:22:16.023
> 
> 标签：facebook, facebook-graph-api, facebook-like, facebook-opengraph, connect

我在 Safari 和其他浏览器中收到此错误：

“fb-root” div 尚未创建，自动创建

all.js:52

在调用 FB.init() 之前调用 FB.getLoginStatus()。

all.js:52

在我的标题中，我有这个：

```
<html  xmlns="http://www.w3.org/1999/xhtml" 
 xmlns:og="http://ogp.me/ns#"  
 xmlns:fb="http://www.facebook.com/2008/fbml"
 xml:lang="en" lang="en">

<script type="text/javascript" src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>

<meta property=""fb:admins"" content=""508331528"" />
<meta property=""fb:page_id"" content=""118806721611355"" />
<meta property=""fb:app_id"" content=""426360900751901"" /> 
```

（我意识到我不应该拥有所有三个属性标签，但我尝试了各种场景）

在页面的正文中，我有这两个简单的 facebook 标签：

```
<fb:like data-href="http://www.PrintMyWatercolor.com" layout="button_count" style="width: 90px;" data-show-faces="true" data-send="true" action="recommend"></fb:like>

<fb:comments href="http://www.PrintMyWatercolor.com" numposts="25" width="590"></fb:comments> 
```

据我了解，这应该没问题。我在页面上没有任何明确的 facebook javascript 代码。如何解决此错误？

谢谢，

凯尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T00:36:30.837

1.  您似乎（从该示例中）没有`<div id="fb-root"></div>`Javascript SDK 附加到的

2.  您加载 Javascript SDK 的方法不是异步的，因此 SDK 可能在页面完成之前加载，请改用文档中的方法，该方法[通过在文档](https://developers.facebook.com/docs/reference/javascript/)的其余部分加载后附加 SDK 来工作

# sql-server - Service Broker 激活 SP 和 TempDB 对象权限

> ID：13635852
> 
> 赞同：0
> 
> 时间：2012-11-29T22:22:27.737
> 
> 标签：sql-server, service, broker

我有一个激活 SP，它调用另一个 SP，它调用其他 SP 来插入和更新 TempDB 中存在的表。我已经使用具有 SA 权限的用户创建了队列，并且激活 SP 具有 SA 权限（尝试解决该问题）。

我继续收到此错误：对象“xxxxxxxx”、数据库“tempdb”、模式“dbo”的 SELECT 权限被拒绝。

我有能力在没有 Service Broker 的情况下执行该过程（直接调用 SPs Service Broker 正在调用）并且它工作正常。

有人有想法么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T03:32:24.550

我不记得它到底是怎么回事，但是激活过程的执行上下文很奇怪。设置跟踪（或扩展事件）并查看谁在调用您的过程。我的猜测是你会感到惊讶。您可以在过程中抛出“execute as”子句，进入某些模块签名，或授予过程执行者权限。

# recursion - 为什么这不会导致叉子炸弹

> ID：13635854
> 
> 赞同：1
> 
> 时间：2012-11-29T18:41:03.400
> 
> 标签：recursion, fork

这个程序打印 2^3 次 hi 就退出了 不就是 fork 调用递归调用 main 函数吗？

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[])
{
    fork();
    fork();
    fork();

    puts("hi");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T19:03:43.053

它不是递归的，也不会无限期地分叉。这就是它不分叉炸弹的原因。Fork 不会导致`main`被调用。fork 所做的是创建当前进程状态的副本，并*从 fork 调用*中将 0 返回给子副本，并将进程 id 返回给父级。

遍历您的程序，它会准确地创建 7 个原始副本，总共调用 8 次`puts("hi")`.

```
original   copy 1    copy 2    copy 3    copy 4    copy 5    copy 6    copy 7 
fork 1 --> created
fork 2 ------------> created
fork 3 ----------------------> created
"hi"                           "hi"
            fork 2 --------------------> created
            fork 3 ------------------------------> created
            "hi"                                   "hi"
                     fork 3 -------------------------------> created
                     "hi"                                    "hi"
                                         fork 3 ----------------------> created
                                         "hi"                           "hi" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T19:06:25.480

你自己回答了。fork() 不调用 main()。一个进程调用 fork() 但两个进程返回（好吧，我们假设没有错误）

所以，fork()-1 被调用，并返回两次（一个在父级，一个在子级）。他们都转到下一个语句。

然后 fork()-2 被调用两次（一个在父级中，一个在子级中）并且两个调用都返回两次，再次，一个在父级中一次在子级（ren）中。

然后 fork()-3 被调用，这次是 4 次，8 次返回。它们都打印出来，然后您将所有“hihihihihihihihi”都发送到您的屏幕上。

请查看[fork](http://linux.die.net/man/2/fork)的手册页。

# php - 如何执行存储为字符串的 PHP 代码？

> ID：13635859
> 
> 赞同：0
> 
> 时间：2012-11-29T22:22:41.710
> 
> 标签：php, syntax

我想执行一个字符串，就好像它是 PHP 代码一样。

一个例子是：

```
$string='round(24.6,2)'; 
```

我想转换`$string`为可执行语法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:24:30.813

您可以使用`eval('round(24.6,2)')`，但由于多种原因，这通常不受欢迎。你为什么要这样做？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T22:24:40.827

```
eval() 
```

是你想要的功能。但是： eval() 是邪恶的！

# python - For循环正在跳过一些东西！Python

> ID：13635866
> 
> 赞同：0
> 
> 时间：2012-11-29T22:23:06.473
> 
> 标签：python, loops, skip

我正在尝试运行此代码，以便它为列表的所有元素运行一个函数。出于说明目的，基本上它应该打印：

```
'----------Possible Word:', possible_word 
```

对于我列表中的所有项目。所以，如果我输入 ['p', 'r', 's'] 它将运行该打印 3 次，每个项目一个。我的代码在下面——当我运行它时，它只运行 p 和 s，而不是 r，这真的很奇怪。有任何想法吗？

```
def check_matches(input):
print 'Input:', input
for possible_word in input:
    print '----------Possible Word:', possible_word
    valid = True
    for real_word in word_dictionary:
        possible_word_list = list(possible_word)
        real_word_list = list(real_word)
        print possible_word_list
        print real_word_list
        number_of_characters_to_check = len(possible_word_list)
        for x in range(0, number_of_characters_to_check):
            print possible_word_list[x] + real_word_list[x]
            if (possible_word_list[x] != real_word_list[x]):
                valid = False
    if (valid == False):
        input.remove(possible_word)
print all_possible
return input 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T22:25:28.020

当您运行时，`input.remove(possible_word)`您正在更改您碰巧迭代的列表的大小，这会导致特殊的结果。一般来说，不要改变你正在迭代的任何东西。

更简洁的例子：

```
>>> lst = ['a', 'b', 'c']
>>> for el in lst:
    print el
    lst.remove(el)

a
c 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T22:28:28.517

乔恩克莱门茨是对的。你通常不想做这样的事情。但是，我假设您对它有特定的需求。

答案很简单。换行

```
for possible_word in input: 
```

到这条线

```
for possible_word in input[:]: 
```

这将制作列表的副本供您迭代。这样，当您删除一个项目时，它不会影响您的循环。

# stored-procedures - SSRS - 将 Null 传递给多值参数

> ID：13635877
> 
> 赞同：2
> 
> 时间：2012-11-29T22:24:37.973
> 
> 标签：stored-procedures, ssrs-2008, parameter-passing, reporting-services

我在这里陷入困境，使用 SSRS 并尝试将 NULL 值与其他值一起从多值参数提供到用于数据集的存储过程中。

用户在报告的多值参数中选择的值将馈送到存储过程中的单个输入参数。例如，名为@Color 的多值下拉菜单可以将“Red”、“White”和“Blue”提供给存储过程的“@ColorList”参数。存储过程使用 SQL 语句构建函数的参数并给出结果集。除了值之外，我还想将 NULL 值添加到多值参数，因为某些记录没有颜色值。

不幸的是，我没有修改存储过程的权限，所以我不能使用 ISNULL(Value,'') 变通方法或使用 'IN' 语法更改任何内容。存储过程正在报告中执行，如下所示：

```
 EXEC StoredProc
 @Name = @Name
 @ColorList = @Color 
```

@Color 使用 JOIN 表达式传递

```
=JOIN(Parameters!Color.Value,",") 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:39:36.477

听起来您很了解自己的情况：您不能将 NULL 的值作为参数传递，因为 NULL 根本不是一个值，也没有任何值。您*可以*将字符串“NULL”作为参数@color 传递，但您最好创建一个色彩丰富的（我们应该说，独特的？）独特的变量，例如`noColor`只是为了让事情变得清晰。

# c++ - 异步 C++11 中未来的析构函数

> ID：13635883
> 
> 赞同：3
> 
> 时间：2012-11-29T22:24:46.397
> 
> 标签：c++, gcc, c++11

`future`编译器不应该在完成后立即调用未来的析构函数`main`，也就是说，不应该是`f()`调用的函数吗？（gcc 4.7.2 不这样做）。

```
#include <iostream>
#include <thread>
#include <future>

using namespace std;

void f() {
    cout << "thread...\n";
}

int main() {
    auto future = async(&f);
    cout << "I am main\n";
} 
```

**编辑**：我**只** `Hello from main`得到。文本`thread...`根本不打印。

**编辑2**：未来调用的析构函数`wait()`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T22:27:00.120

**注意：下面的过时信息（C++ 14 之前）。**有关最新信息，请参阅 Jonas 的答案。

* * *

> 编译器不应该在 main 完成后立即调用未来 future 的析构函数

就*在* `main`完成之前。但是，是的。

> 也就是说，无论如何都不应该调用函数 f() 吗？

没有为什么？是什么让你认为析构函数`std::future`会这样做？这不是析构函数的工作。事实上，根据§30.6.6/9，析构函数的唯一作用是释放未来的共享状态并销毁`*this`。而已。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-14T09:27:43.037

*这是未来的说法（双关语）：*

FWIW，康拉德的回答仅适用于 C++11。在 C++14 中，这种行为发生了变化。根据[cppreference](https://en.cppreference.com/w/cpp/thread/future/%7Efuture)：

> 这些操作不会阻塞共享状态准备就绪，除非满足以下所有条件时它可能会阻塞：共享状态是通过调用 std::async 创建的，共享状态尚未准备好，并且这是对共享状态的最后引用。

尽管上面的引用没有提到启动策略，但我只能在任务异步启动的情况下确认这种行为。`std::async(std::launch::deferred, ...)`根据我的测试，从未明确等待过的未来似乎不会在未来的破坏时得到评估。

另请注意，这仅适用于从 创建的期货`std::async`，因此`wait();`在`std::future`.

最后，从 Boost 1.73 开始，在创建时**没有**对 进行类似的更改，即 Boost 版本的行为仍与 C++14 之前的版本相同。`boost::future``boost::async(boost::launch::async, ...)``std::future`

# php - 下载 PDF 在 ipad/iphone 上不起作用

> ID：13635886
> 
> 赞同：1
> 
> 时间：2012-11-29T22:25:07.490
> 
> 标签：php, html

在我的浏览器中，我可以下载所有格式，zip、kml、pdf，但是当我从 iphone 或 ipad 尝试时，它适用于 zip 和 kmls，但不适用于 pdf。有人可以指出我做错了什么吗？我正在使用的代码是：

```
<?php
    $file = "/raid0/data/naswebsite/Projects/Projects/" . $_GET["file"];
    $parts = explode('/', $file);
    $download = $parts[count($parts) - 1];

    if (!file_exists($file))
    {
        echo "The file $file does not exist on the server.";
        exit;
    }

    if (strpos(strtolower($file), ".zip"))
    {   
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename=' .urlencode($download));
        header('Content-Transfer-Encoding: binary');
    }
    else if (strpos(strtolower($file), ".pdf"))
    {   
        header('Content-Type: application/vnd.adobe.pdf');
        header('Content-Disposition: attachment; filename=' .urlencode($download));
        header('Content-Transfer-Encoding: binary');
    }
    else if (strpos(strtolower($file), ".kml"))
    {   
        header('Content-Type: application/vnd.google-earth.kml+xml');
        header('Content-Disposition: attachment; filename=' .urlencode($download));
        header('Content-Transfer-Encoding: binary');
    }
    else
    {
        header('Content-Type: application/text');
        header('Content-Disposition: attachment; filename=' .urlencode($download));
        header('Content-Transfer-Encoding: binary');        
    }

    readfile($file);    
?> 
```

我还要注意我尝试过使用

```
header('Content-Type: application/pdf'); 
```

这也不适用于苹果设备。

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:33:31.790

您是否尝试过内联：

```
header('Content-disposition: inline; filename=' .urlencode($download));
header('Content-type: application/pdf'); 
```

我对此进行了测试，它在我的 ipad 上运行良好。很好，我的意思是它显示它。您没有准确描述您期望在这里发生的事情。

# javascript - Momentjs 我的格式有什么问题

> ID：13635887
> 
> 赞同：0
> 
> 时间：2012-11-29T22:25:12.843
> 
> 标签：javascript, date, momentjs

难道我做错了什么：

```
moment('Nov 29th 2012', 'MMM Do YYYY').format('DD/MM/YYYY'); 
```

我认为它应该给予`29/11/2012`，但它给予`01/11/2012`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:28:24.163

这似乎有效：

```
moment('Nov 29th 2012', 'MMM DD YYYY').format('DD/MM/YYYY'); 
```

我不确定为什么 momentjs 需要额外的`D`.

# visual-studio-2012 - 从 Visual Studio Team Services 中删除团队项目

> ID：13635889
> 
> 赞同：77
> 
> 时间：2012-11-29T22:25:15.260
> 
> 标签：visual-studio-2012, tfs, azure-devops, team-project

我在域 visualstudio.com 上使用 Team Services，我需要删除一个项目，我发现我需要使用命令提示符来删除项目，但是当我尝试脚本时，它似乎不起作用

我的脚本是，

```
TfsDeleteProject 
  /force collection:https://mytfs.visualstudio.com/DefaultCollection MyProject 
```

我的第一个错误是我没有将 DefaultCollection 附加到 URL，但现在我得到了我没有权限的错误。

![](../Images/fbece46447f18b079f0def6416fcf268.png)

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-11-30T12:56:02.720

感谢@Christopher，我能够使脚本正常工作。

您可以使用“开发人员命令提示符”中的以下命令：

```
TfsDeleteProject /collection:https://mytfs.visualstudio.com/DefaultCollection MyProject 
```

![带有工作脚本的命令提示符的打印屏幕](../Images/c5a2bc354b0dffcf38e42d56105b2106.png)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-11-19T02:10:48.720

您现在可以通过 visualstudio.com 进行操作

1.  [![齿轮](../Images/389459928f36fa6421ab3c34cbce6fc5.png)](https://i.stack.imgur.com/dUmhS.png)通过选择齿轮图标 打开团队项目集合的管理上下文。

    [![行政](../Images/704d70c2f5e43253cd0514c3174e5a32.png)](https://i.stack.imgur.com/Mpul3.png)

2.  打开[![操作菜单](../Images/06f353bb926fd77bbfe9b003e5bd8c7e.png)](https://i.stack.imgur.com/pxd65.png)要删除的团队项目的菜单。

    [![在此处输入图像描述](../Images/19ccfce71011cc0c31f25ba2accf532c.png)](https://i.stack.imgur.com/PCCyc.png)

    如果您没有看到操作图标[![操作菜单](../Images/b7da698c8d3971a45cae80c71067ccc2.png)](https://i.stack.imgur.com/KoNun.png)，则说明您没有访问 VSTS 或者您不是 Project Collection Administrators 组的成员。

3.  您必须键入团队项目的名称才能启动删除操作。

    [![删除项目](../Images/fef957b26d4ec3cfd1c73ad1cd31caef.png)](https://i.stack.imgur.com/Owl8E.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-08T01:18:57.320

1.  打开“Program Files>Microsoft Visual Studio”下的“<strong>Developer Command Prompt”或在 Windows 8 中输入“<strong>Developer”。

2.  在命令提示符下，使用下面的这个命令模板从 TFS 中删除您的项目。将**YourTFSName**替换为您的名称，并将**ProjectName**替换为您的项目名称。

    ```
    TfsDeleteProject /collection:https://YourTFSName.visualstudio.com/DefaultCollection ProjectName 
    ```

3.  如果系统提示您确认，请点击`Enter`然后。`Y`

4.  完毕。通过在线登录到您的 TFS 进行仔细检查。

来自[http://bizvise.com/2013/03/08/how-to-delete-team-project-from-my-team-foundation-service-tfs-default-collections/](http://bizvise.com/2013/03/08/how-to-delete-team-project-from-my-team-foundation-service-tfs-default-collections/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-18T21:37:31.660

尽管接受的答案绝对正确且非常清楚，但我设法迷路并遇到了“灰色的删除按钮”问题，只是想分享我做错了什么。

对于有灰色删除按钮问题的人，请确保您在“**查看集合管理页面**”（如接受的答案中所示）内，而不是项目本身内。

如果 VS Team Services 顶部的最后一个面包屑是项目的名称，那么您来错地方了（看起来很相似）。此处的删除按钮（在右键单击项目名称时出现）将灰显。[![在此处输入图像描述](../Images/a8b1aa7f60cf7beb59abd01a7a960d00.png)](https://i.stack.imgur.com/KQd1J.png)

如果您在单击设置（齿轮）后单击显示“查看收藏管理页面”的链接，您将在正确的位置。[![在此处输入图像描述](../Images/8967663fd1b22d6af649210dc57283c4.png)](https://i.stack.imgur.com/ELevY.png)

[![在此处输入图像描述](../Images/6763c91fdb039f45b2d27ef4a07c85a8.png)](https://i.stack.imgur.com/4rOht.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-10T17:23:16.867

如果您的项目名称有空格，则必须使用**“MyProject name”** TfsDeleteProject /collection: [https://mytfs.visualstudio.com/DefaultCollection](https://mytfs.visualstudio.com/DefaultCollection) "MyProject name"

# wordpress - 在 wordpress 中显示多个字段 slug types_render_field

> ID：13635895
> 
> 赞同：2
> 
> 时间：2012-11-29T22:25:52.493
> 
> 标签：wordpress, custom-post-type

我创建了一个类型组，我在其中插入了一个带有 img slug 的图像字段，您可以创建多个实例。现在我的问题是我只想显示 img slug 字段的一个字段值。使用

```
types_render_field('img', array()) 
```

它显示了我为 img slug 字段插入的所有飞行。我也试过

```
types_render_field('img[0], array()); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-15T02:17:27.563

同样的问题，如果有人需要，终于找到了这个解决方案：

```
types_render_field('photos', array("index" => 0)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:33:40.383

除了使用 types_render_field，我使用 get_post_custom 函数访问自定义字段值。

# .net - 已添加处理项目。输入字典

> ID：13635898
> 
> 赞同：0
> 
> 时间：2012-11-29T22:25:59.750
> 
> 标签：.net, winforms, exception-handling, dictionary

我在 Visual Studio 中做一个项目，但是当我想打开表单时，它给了我这个尴尬的错误：

> 为防止在加载设计器之前可能丢失数据，必须解决以下错误： 项目已添加。字典中的键：“帮助” 正在添加的键：“帮助”

为什么我会看到这个问题，我该如何解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:52:44.057

单击解决方案资源管理器中的显示所有文件图标。打开 Properties 节点，打开 Resources.resx，右键单击 Resources.Designer.cs 并单击 Include in project

# javascript - 打字稿和谷歌闭包

> ID：13635901
> 
> 赞同：4
> 
> 时间：2012-11-29T22:26:19.093
> 
> 标签：javascript, obfuscation, typescript, google-closure-compiler

我使用 Typescript 命令 (tsc) 创建一个包含所有平台类的单个 Javascript 文件。

```
tsc "./Main.ts" -out "./script/myProject_debug.js" --declarations 
```

然后，我想用 Google Closure (compiler.jar) 混淆这个文件，如下所示：

```
java -jar ./compiler/compiler.jar --compilation_level ADVANCED_OPTIMIZATIONS --js "./script/myProject_debug.js" > "./script/myProject.js". 
```

但是，当我执行生成的混淆/优化代码时，出现以下错误： Uncaught TypeError: Cannot read property 'prototype' of undefined

匹配以下非混淆 JS 代码（由 tsc 命令生成）：

```
var __extends = this.__extends || function (d, b) {
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
} 
```

这部分用于翻译“extends”Typescript 关键字，b 的等价物是未定义的。

是否有人遇到类似的错误或/并获得能够使用 Typescript 编译文件对 Google Closure 进行混淆的解决方案？

我尝试使用 uglifyjs 命令，输出文件完美运行，但我想要完全混淆（类、参数、变量、方法等）。此外，欢迎 Google Closure 提供的额外优化。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:35:22.857

的定义`__extends`有一个问题，这很可能导致您看到的错误。

```
var __extends = this.__extends || function (d, b) { ... }; 
```

引用意味着与`this.__extends`相同`window.__extends`，但是闭包编译器不知道（甚至从未尝试）意识到`this`全局上下文中的引用实际上是`window`对象。用`--warning_level=VERBOSE`编译器编译会发出警告：

```
Dangerous use of the global this object at line 1 character 16
var __extends = this.__extends || function (d, b) {
                ^ 
```

此外，这`this.__extends`是对外部/未定义属性的引用，编译器也在`VERBOSE`级别上发出警告。

我已经使用[Closure-compiler 服务 UI](http://closure-compiler.appspot.com/home)修改并注释了定义以在没有警告的情况下进行编译：

```
// ==ClosureCompiler==
// @compilation_level ADVANCED_OPTIMIZATIONS
// @warning_level VERBOSE
// @output_file_name default.js
// @formatting pretty_print
// ==/ClosureCompiler==

var __extends = window['__extends'] || function (d, b) {
  /** @constructor */
  function __() { this.constructor = d; }
  __.prototype = b.prototype;
  d.prototype = new __();
}

/**
 * @constructor
 * @extends {String}
 */
function foo2() {this.foo = 'bar'; }
__extends(foo2, String);

var bar2 = new foo2;
alert(bar2.toLowerCase); 
```

[修改和编译代码的 JSFiddle](http://jsfiddle.net/wXBLB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T13:32:40.260

好的，我发现了问题。

正如我之前所说， b 在中未定义：

```
var __extends = this.__extends || function (d, b) {
   function __() { this.constructor = d; }
   __.prototype = b.prototype;
   d.prototype = new __();
} 
```

当 typescript “编译”成 javascript 时，如果您按项目获得了一个命名空间，但您将与此命名空间相关的所有类都写在单独的文件中，Typescript 在最终生成的 js 文件中执行以下操作：

```
var namespace;
(function (namespace) {

    var Class1 = (function (dependency) {
        [...]
        return Class1;
    })(namespace.dependency);

    namespace.Class1 = Class1;
})(namespace || (namespace= {}));

var namespace;
(function (namespace) {

    var Class2 = (function (dependency) {
        [...]
        return Class2;
    })(namespace.dependency);

    namespace.Class2 = Class2;
})(namespace || (namespace= {}));

var namespace;
(function (namespace) {

    var Main = (function (dependency) {
        [...]
        return Main;
    })(namespace.Class2);

    namespace.Main = Main;
})(namespace || (namespace= {})); 
```

我不确切知道它是如何工作的，但是即使这段代码没有问题并且 JS 可以处理它，google-closure-compiler 在某处删除了一些类。因此缺少一些依赖项并且 b 未定义。

所以我发现如果你像下面这样声明你的命名空间，你就不会再遇到错误了（闭包会将你的所有类保留在最终混淆的 js 文件中，只要使用“Main”类或者你保留一个引用您在全局窗口对象中的命名空间）：

```
var namespace;
(function (namespace) {

    var Class1 = (function (dependency) {
        [...]
        return Class1;
    })(namespace.dependency);

    namespace.Class1= Class1;

    var Class2 = (function (dependency) {
        [...]
        return Class2;
    })(namespace.dependency);

    namespace.Class2= Class2;

    var Main = (function (dependency) {
        [...]
        return Main;
    })(namespace.Class2);

    namespace.Main = Main;
})(namespace || (namespace= {})); 
```

我想我会在 typescriptlang.org 上打开一个问题。顺便说一下，它正在优化生成的文件大小。

谢谢您的回答！

# javascript - 引导选项卡中的谷歌地图

> ID：13635903
> 
> 赞同：15
> 
> 时间：2012-11-29T22:26:24.227
> 
> 标签：javascript, jquery, google-maps-api-3, twitter-bootstrap

我试图让谷歌地图出现在香草引导选项卡中。我直接从 Bootstrap 文档中构建了一个小提琴，其 Gmap 脚本与 Google 推荐的非常相似。

我将`map`对象转储到 console.dir 并且它已正确初始化。在早期的项目中，我可以使用该`resize`功能在选项卡中显示地图——但它似乎不适用于 Bootstrap。

有没有人得到这个工作？

这是通用的 jsfiddle—— [http://jsfiddle.net/B4zLe/4/](http://jsfiddle.net/B4zLe/4/)

编辑：添加代码

JAVASCRIPT：

```
var map;

jQuery(function($) {
    $(document).ready(function() {
        var latlng = new google.maps.LatLng(-34.397, 150.644);
        var myOptions = {
            zoom: 8,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        console.dir(map);
        google.maps.event.trigger(map, 'resize');

        $('a[href="#profile"]').on('shown', function(e) {
            google.maps.event.trigger(map, 'resize');
        });
    });
}); 
```

HTML：

```
<div>
<div class="bs-docs-example">
    <ul id="myTab" class="nav nav-tabs">
    <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
    <li><a href="#profile" data-toggle="tab">Map</a></li>
</ul>
<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade in active" id="home">
        <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher synth. Cosby sweater eu banh mi, qui irure terry richardson ex squid. Aliquip placeat salvia cillum iphone. Seitan aliquip quis cardigan american apparel, butcher voluptate nisi qui.</p>
    </div>
    <div class="tab-pane fade" id="profile">
        <div id="map_canvas"></div>   
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-09-11T17:46:28.883

Boostrap 3 的更新答案：

```
$("a[href='#my-tab']").on('shown.bs.tab', function(){
  google.maps.event.trigger(map, 'resize');
}); 
```

请注意，您选择的是选项卡的链接，而不是选项卡本身。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-09-05T23:53:07.280

不要`.tab-content > .tab-pane {display: none}`
使用这个

```
.tab-content > .tab-pane {
    display: block;
    height:0;
    overflow:hidden;
}

.tab-content > .active {
    display: block;
    height:auto;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-08T09:05:18.697

显示选项卡时调整地图大小

[http://jsfiddle.net/B4zLe/49/](http://jsfiddle.net/B4zLe/49/)

```
 $('#myTab a[href="#profile"]').on('shown', function(){
        google.maps.event.trigger(map, 'resize');
        map.setCenter(latlng);
 }); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-11-29T23:39:37.470

您对“调整大小”事件的强大程度有点过于乐观了。从[文档中：](https://developers.google.com/maps/documentation/javascript/reference)

*   resize：当 div 改变大小时，开发者应该在地图上触发这个事件：google.maps.event.trigger(map, 'resize')

换句话说，调整大小不会做任何花哨的事情，比如将地图调整到窗口大小，而只会调整到它所在的容器——在这种情况下，“map_canvas”div。但是，这个 div 没有维度，所以地图的大小为零。

由于您添加了一些侦听器以确保地图将更改为其父级的大小，因此这是一个非常简单的修复 - 只需添加一些代码以将父级 div 修改为所需的大小，地图就会调整为它的大小。例如：

```
$("#map_canvas").css("width", 400).css("height", 400); 
```

将其大小调整为 400x400。[这是一个示例](http://jsfiddle.net/B4zLe/5/)，您应该能够将其更改为您想要的任何内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-21T15:39:27.893

我也遇到了带有 Bootstrap 3 的 Google Maps 的问题，但是我用基于[Andy B](https://stackoverflow.com/users/374873/andy-b)代码的小技巧解决了这个问题：

```
 var cl=0;
 $("a[href='#maptab']").on('shown.bs.tab', function(){
     cl++;
     if(cl == 1){   // this is to prevent map initialized twice or more
         initialize();
     }
     else{
        //do nothing        
     }
 }); 
```

好吧..至少它对我有用:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-05T11:04:32.277

```
var map;

jQuery(function($) {
    $(document).ready(function() {
        var latlng = new google.maps.LatLng(-34.397, 150.644);
        var myOptions = {
            zoom: 8,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        console.dir(map);
        google.maps.event.trigger(map, 'resize');

        $('a[href="#profile"]').on('shown', function(e) {
            google.maps.event.trigger(map, 'resize');
        });
        $("#map_canvas").css("height", 400);
    });
}); 
```

**[小提琴](http://jsfiddle.net/swaranan/h04oqewp/)**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-25T21:21:39.533

问题在 2016 年仍然存在，删除 google DOM 处理程序并使用上面已经写过的 jQuery“显示”触发器调用 initialize() 函数。然后在点击 TAB 时加载地图

~~google.maps.event.addDomListener(window, 'load', 初始化);~~

```
jQuery('a[href="#googlemaps-tab-name"]').on('shown.bs.tab', function(e)
{   
    initialize();
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-25T14:52:14.373

Bootstrap 3.3.7、jquery 1.11.3 和选项卡仍然存在问题。一切正常，直到您尝试将地图放入加载时首先隐藏的选项卡中。然后你加载地图，一切都应该工作，但你只看到地图的灰色（或任何其他颜色，不确定）区域。你可以在那里做任何事情，但你看不到地图本身。在地图内拖动时，您可能会看到一些东西，但总的来说 - 空白地图。

**选项 1** - 您可以在调整窗口大小时看到地图。但是也有垮台——一旦你改变标签，它就会再次消失。

**选项 2** - 您可以将地图放在第一个选项卡上并完成它。

**选项 3** - 您可以编写代码来“调整”地图的大小（如前所示）。但是在那里我遇到了问题 - 这并不总是有效。至少它对我不起作用：

```
.on("shown", function(){})
.on("shown.bs.tab", function(){});
.on("show.bs.tab", function(){});
... 
```

几乎任何变化都不起作用。我设法通过使用链接ID而不是href比较使其在第一次选项卡单击时工作，但是当我单击另一个选项卡并再次返回时，再次出现灰色地图......我就像 - 认真的！？

最后，我想出了解决方案：在特定的选项卡上单击（我推荐按 id），它完成了所有必要的事情。这意味着跟随 - 每次您单击其他地方（其他链接或选项卡）并返回地图选项卡时，它都会重新加载该地图（因此可能会有点慢 - 取决于互联网），但至少我得到了地图，而不是空的谷歌地图的灰色图像。

希望将来能帮助别人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-23T04:36:29.360

使用下面的脚本

```
$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {

            init();

        }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-15T14:08:10.647

[cevatasln](https://stackoverflow.com/users/3361336/cevatasln)绝对出色的解决方案。我也是，我使用了所有可能的 jQuery 和 Javascript 解决方案，但没有一个有效！如果您想定位**特定标签**并使用**动态图库或其他东西，**这对您有用

```
.tab-content > #tab5.tab-pane {
   display: block;
   height:0;
   max-height:0;
   overflow:hidden;
}

.tab-content > #tab5.active  {
   display: block;
   height:auto;
   max-height: 100%;
} 
```

# facebook - Facebook OpenGraph 故事链接到 Facebook 上的应用程序

> ID：13635911
> 
> 赞同：3
> 
> 时间：2012-11-29T22:26:52.437
> 
> 标签：facebook, redirect, facebook-opengraph, facebook-canvas

我正在通过 Canvas 开发 Facebook 中包含的游戏应用程序。该游戏由几个独立于顺序的“级别”组成，每个级别都与数据库中的条目相关。打个比方，你可以把它想象成类似于hangman，因为游戏每次都是一样的，但内容不同（对于hangman，就是猜的词）。

当用户玩一个关卡时，我通过 OpenGraph API 创建一个故事。例如，假设 Bob 玩 Alpha 关卡，他的朋友 Sue 看到他的 feed 故事，上面写着“Bob 在 SomeGame 中玩了 Alpha”。我想要那个故事中的一个链接，让 Sue 直接进入 SomeGame 中的“Alpha”关卡，而*不是*游戏中用户可以选择关卡的通用入口点（即，当你点击 Canvas URL 时通常会发生什么）。看来您可以使用参数，如下所示：

apps.facebook.com/somegame?level_id=1234,

然后在您的 Canvas URL 端点中，您可以根据这些参数进行重定向。但这是处理这个问题的首选方法吗？

另外，如果 Feed 中的故事标题是“Bob 在 SomeGame 中玩了 Alpha”，我希望“Alpha”上的链接可以让 Sue 玩“Alpha”，但据我所知，该链接是由 og 生成的:url 在对象元数据中，这意味着它必须链接到

www.somegame.com/level/:id，而不是

apps.facebook.com/somegame?context_params=some_stuff。

但我真的不想让人参观

www.somegame.com/level/:id

直接 - 我希望他们留在 Facebook 内，并在 Canvas 托管的应用程序中查看它。

如果我给予，我可以获得我想要的行为

www.somegame.com/level/:id

一个 javascript 重定向，它使用级别 id 的参数：

(top.location.href="http://apps.facebook.com/somegame?level_id=1234)

然而，这似乎是一个 hack，我希望有一种更简洁的方法来做到这一点，而不需要浏览器驱动的重定向。谢谢！

# watir - 将测试结果导出到 Excel

> ID：13635917
> 
> 赞同：0
> 
> 时间：2012-11-29T22:27:02.537
> 
> 标签：watir

我正在通过命令行界面对 watir 进行测试。

我想要的是，当 watir 完成运行最后一行指令时，它应该在 excel 中导出消息，例如。“测试用例 1 通过。” 或“测试用例 1 失败”。

我正在使用 Watir

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:44:02.593

如果您想写入 excel，可以使用各种 gem（库）。这里有几个选项。

**win32ole**

有各种可以编写 excel 文件的 gem。就个人而言，我使用 win32ole gem，因为它不需要安装额外的 gem。

使用此 gem 创建 excel 文件的示例是：

```
require 'win32ole'
excel = WIN32OLE.new('Excel.Application')
excel.visible = true
workbook = excel.Workbooks.Add()
worksheet = workbook.Worksheets(1)
worksheet.Range("A1:B1").value = ["Test","Result"]
worksheet.Range("A2:B2").value = ["Test Name 1", "Pass"] 
```

您可以添加格式等 - 请参阅[http://davidsulc.com/blog/2011/03/27/using-ruby-and-win32ole-to-manipulate-excel/](http://davidsulc.com/blog/2011/03/27/using-ruby-and-win32ole-to-manipulate-excel/)

**CSV**

如果您不需要任何格式，您可以考虑使用[CSV gem](http://ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html)创建一个 csv 文件。

使用此 gem 创建 csv 文件的示例是：

```
require 'csv'
CSV.open("C:/Users/user/Desktop/file.csv", "wb") do |csv|
  csv << ["Test","Result"]
  csv << ["Test Name 1", "Pass"]
end 
```

有关更多详细信息，请参阅[文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html)。

# vim - 让 Vim 在进入或退出插入时执行动作

> ID：13635923
> 
> 赞同：3
> 
> 时间：2012-11-29T22:27:33.563
> 
> 标签：vim

每当我进入“插入”模式时，我都会尝试禁用我的触摸板。我相信这可以`map`通过使用以下命令来完成，并且可以通过以下命令来完成：

```
map i     :silent !synclient TouchpadOff=1 <i> <CR>
map <ESC> :silent !synclient TouchpadOff=0 <ESC> <CR> 
```

但这显然不起作用，因为 map 不会递归到以前的定义，而是忽略它。怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T22:48:56.933

您可以使用进入或离开插入模式时触发的事件来设置自动命令：

```
auto InsertEnter * :silent !synclient TouchpadOff=1
auto InsertLeave * :silent !synclient TouchpadOff=0 
```

您可能还想对其他事件采取行动，您也可以使用 获取已知事件的列表`:help autocmd-events`。

# opengl - OpenGL 在着色器中采样一个立方体贴图面

> ID：13635924
> 
> 赞同：2
> 
> 时间：2012-11-29T22:27:33.753
> 
> 标签：opengl, glsl

我想对 OpenGL 立方体纹理应用过滤器。面对面。如何在着色器中仅对立方体贴图的一个面进行采样？我不能使用 GL_texture_view_ARB，因为我只有 Opengl 3.3。我可以使用 sampler2DArray 并将我的立方体贴图绑定到指定的单元吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T02:57:46.783

我想您需要手动创建 6 个立方体贴图面，并使用不同的过滤器对其进行采样。您可能需要将一张面的纹理坐标从 3D 矢量转换为 2D texcoord，以下是执行此操作的信息：[http](http://www.nvidia.com/object/cube_map_ogl_tutorial.html) ://www.nvidia.com/object/cube_map_ogl_tutorial.html ，请搜索“映射纹理坐标”到该网页上的 Cube Map Faces”。

# javascript - 使非 html5 输入具有“占位符”

> ID：13635933
> 
> 赞同：0
> 
> 时间：2012-11-29T22:28:38.670
> 
> 标签：javascript, jquery, html, css

我有几个`<input>`元素需要使用类似 HTML5 的占位符。只有当输入没有文本时才会在焦点上消失并在模糊时重新出现。我已经看到了一些 javascript-heavy 的实现，并且我一直在寻找一个轻量级（最好是仅 css）的解决方案。

这是HTML：

```
<div class="email-container">
    <span class="default-value">Email</span>
    <input class="text-input" name="login" type="email"/>
</div>
<div class="pw-container">
    <span class="default-value">Password</span>
    <input class="text-input" name="login" type="pw"/>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:28:38.670

我找不到任何完全符合我要求的东西（如“仅 css”），但我确实使用 jQuery 提出了几个很好的解决方案：

1.  我将输入的背景设置为透明，将“占位符”文本的 z-index 设置为 -1。这使我可以单击“文本”并实际单击输入。看到[这个 jsFiddle](http://jsfiddle.net/AacP8/5/)。

2.  我允许“占位符”文本位于输入之上，但我使用文本上的单击处理程序将焦点转移到输入。看到[这个 jsFiddle](http://jsfiddle.net/hZR3k/2/)。

在这两种情况下，实现的主力都是这个 jQuery 代码：

```
$('.text-input').each(function(){
    var input = $(this);
    //Initially hide the default value if the input is non-empty
    input.siblings('.default-value').toggle(!input.val());
    input.on("focus blur", function(){
        if(input.val().length === 0){
            input.siblings('.default-value').toggle();
        }
    }
)});​ 
```

难题的另一个重要部分是弄清楚如何使用`position: absolute`并`position: relative`让“占位符”文本很好地位于输入中，同时仍然允许输入自由移动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:34:01.250

Modernizer 项目在这里有一个优秀的跨浏览器 HTML5 填充列表：[https ://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)

如果您转到该页面并向下滚动到“Web 表单：输入占位符”，您会看到许多出色的项目，它们将完全满足您的需求。

# php - 时间前的日期格式

> ID：13635935
> 
> 赞同：-1
> 
> 时间：2012-11-29T22:28:55.630
> 
> 标签：php

我仍然是 PHP 的初学者，但我需要一些帮助。我得到了评论的日期格式，我正在尝试插入“时间前”格式。我遇到了麻烦。这是代码：

```
<?php
$name = mysql_real_escape_string($_POST['name']);
$comment = mysql_real_escape_string($_POST['comment']);
$submit = $_POST['submit'];
$date = date("M jS Y | g:i a T");
$ip = "".$_SERVER['REMOTE_ADDR']."";

if($submit)
{
if($name&&$comment)
{

$query=mysql_query("

INSERT INTO comment (id, articleid, name, comment, date, ip) VALUES ('','".  mysql_real_escape_string($_GET['id']) ."','$name','$comment','$date','$ip')

");
header("Location: " . mysql_real_escape_string($_GET['id']) . "");

}
else
{
    echo "<div class='red'>You must fill in all fields!</div>";
} 
```

} ?>

这是输出：

```
<div class="article-body">
<div class="user"><b><?php echo $row['name'] ?></b> <span>says:</span></div> 
<div class="comments">
<?php echo $row['comment'] ?> <br /><p></p>

<p style="font-size:12px;">Posted on <b><?php echo $row['date'] ?></b></p>
</div>
</div> 
```

我尝试使用谷歌摆弄几个代码，但没有成功，因为我是一个菜鸟。哈哈。

对此有什么看法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T01:05:04.457

如果没有看到您的 MySQL 表架构/数据类型，我的猜测是您的`date`数据是无效`date`值。（我假设您的`date`专栏不是`TEXT`or `VARCHAR`）

```
$date = date("M jS Y | g:i a T"); 
```

您可以添加`or die(mysql_error)`到您的查询以验证这一点 -

```
$query=mysql_query("INSERT INTO comment (id, articleid, name, comment, date, ip) VALUES ('','".  mysql_real_escape_string($_GET['id']) ."','$name','$comment','$date','$ip')") or die(mysql_error); 
```

根据手册 - h​​ttp: [//dev.mysql.com/doc/refman/5.6/en/datetime.html](http://dev.mysql.com/doc/refman/5.6/en/datetime.html)您的日期数据类型是`date`、`datetime`和`timestamp`。

```
date => 'YYYY-MM-DD' => set in php using date("Y-m-d");
datetime => 'YYYY-MM-DD HH:MM:SS' => set in php using date("Y-m-d H:i:s");
timestamp => 0000000000 => set in php using strtotime(date("Y-m-d H:i:s")); 
```

# python - 如何从不同文件中获取数据并在 python 中组合成一个数组？

> ID：13635943
> 
> 赞同：2
> 
> 时间：2012-11-29T22:29:27.547
> 
> 标签：python, export-to-csv, analysis, typing

我必须收集数据来证明我的假设，即用惯用手打字比用非惯用手打字更快。我写了下面的代码，给参与者一个随机词，然后他们必须复制它。该代码将计算键入每个单词所需的时间，然后将该数据保存到新文件中。将为每个接受测试的参与者创建一个新的 CSV 文件。

现在我需要编写另一个脚本来找到每个参与者每手牌的平均值，然后创建一个包含平均值的数组，这样我就可以创建一个图表来证明我的假设是否正确。我将如何从不同的文件中获取数据并将其组合到一个数组中？

我的脚本：

```
import random
import time

name = raw_input('Enter name: ')  # get some name for the file
outfile = file(name + '.csv', 'w')  # create a file for this user's data

# load up a list of 1000 common words
words = file('1-1000.txt').read().split()

ntrials = 50

answers = []
print """Type With Dominant Hand"""
for i in range(ntrials):
    word = random.choice(words)
    tstart = time.time()
    ans = raw_input('Please type ' + word + ': ')
    tstop = time.time()
    answers.append((word, ans, tstop - tstart))
    print >>outfile, 'Dominant', word, ans, tstop - tstart  # write the data to the file
    if (i % 5 == 3):
        go = raw_input('take a break, type y to continue: ')

print """Type With Nondominant Hand"""      
for i in range(ntrials):
    word = random.choice(words)
    tstart = time.time()
    ans = raw_input('Please type ' + word + ': ')
    tstop = time.time()
    answers.append((word, ans, tstop - tstart))
    print >>outfile, 'Nondominant', word, ans, tstop - tstart  # write the data to the file
    if (i % 5 == 3):
        go = raw_input('take a break, type y to continue: ')

 outfile.close()  # close the file 
```

上述脚本的示例结果：

```
Dominant sit sit 1.81511306763
Dominant again again 2.54711103439
Dominant from from 1.53057098389
Dominant general general 1.98939108849
Dominant horse horse 1.93938016891
Dominant of of 1.07597017288
Dominant clock clock 1.6587600708
Dominant save save 1.42030906677
Nondominant story story 3.92807888985
Nondominant of of 0.93910908699
Nondominant test test 1.69210004807
Nondominant low low 1.13296699524
Nondominant hit hit 1.15252614021
Nondominant you you 1.22019600868
Nondominant river river 1.42011594772
Nondominant middle middle 1.61595511436 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T00:43:31.277

如果您不熟悉 numpy，这可能看起来像是另一种语言，但这里有一个利用它的解决方案（注意缺少循环！）

为了测试，我创建了第二个用户数据文件，每个条目增加 1 秒。

```
import glob
import numpy as np

usecols = [0, 3] # Columns to extract from data file
str2num = {'Dominant': 0, 'Nondominant': 1} # Conversion dictionary
converters = {0: (lambda s: str2num[s])} # Strings -> numbers

userfiles = glob.glob('*.csv')
userdat = np.array([np.loadtxt(f, usecols=usecols, converters=converters)
                    for f in userfiles])

# Create boolean arrays to filter desired results
dom    = userdat[..., 0] == 0 
nondom = userdat[..., 0] == 1 

# Filter and reshape to keep 'per-user' layout
usercnt, _, colcnt = userdat.shape
domdat    = userdat[dom   ].reshape(usercnt, -1, colcnt)
nondomdat = userdat[nondom].reshape(usercnt, -1, colcnt)

domavgs    = np.average(domdat,    axis=1)[:, 1]
nondomavgs = np.average(nondomdat, axis=1)[:, 1]

print 'Dominant averages by user:    ', domavgs
print 'Non-dominant averages by user:', nondomavgs 
```

输出：

```
Dominant averages by user:     [ 1.74707571  2.74707571]
Non-dominant averages by user: [ 1.63763103  2.63763103] 
```

如果您要进行大量分析，我强烈建议您了解 numpy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:50:27.777

```
persons = ["billy","bob","joe","kim"]
num_dom,total_dom,num_nondom,total_nondom=0,0,0,0
for person in persons:
   data = file('%s.csv' %person, 'r').readlines()
   for line in data:
      if "Nondominant" in line:
         num_nondom+=1
         total_nondom+=int(line.split(' ')[-1].strip())
      elif "Dominant" in line:
         num_dom+=1
         total_nondom+=int(line.split(' ')[-1].strip())
      else: continue
dom_avg = total_dom/num_dom
nondom_avg = total_nondom/num_nondom
print "Average speed with Dominant hand: %s" %dom_avg
print "Average speed with Non-Dominant hand: %s" %nondom_avg 
```

用您的主题名称填充“人员”数组，然后对数据做您喜欢的事情。

PS。Heltonbiker 注意到您的想法并添加了它。还通过添加条来修复换行错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T22:53:02.980

```
def avg_one(filename):
    vals = { 'Dominant': [], 'Nondominant': [] }
    for line in input:
        hand, _, _, t = split(line.strip())
        vals[hand].append(float(t))
    d = vals['Dominant']
    nd = vals['Nondominant']
    return (sum(d)/len(d), sum(nd)/len(nd))

data = []
for f in os.listdir():
    if f.endswith('.csv'):
        data.append(avg_one(f))

doms, nondoms = zip(data)

print "Dominant: " + repr(doms)
print "Nondominant: " + repr(nondoms) 
```

这假定同一目录中没有其他具有不同格式的 .csv 文件（并且解析失败）。一般来说，这需要更多的错误检查，但它可以理解这个想法。

# php - xampp 错误：不使用 codeigniter 连接到数据库服务器

> ID：13635949
> 
> 赞同：0
> 
> 时间：2012-11-29T22:29:58.153
> 
> 标签：php, codeigniter, xampp

我正在做一个codeigniter项目。我在本地使用 wampserver 开发它，但我想用 xampp 进行一些更改。它在远程站点上运行良好。不幸的是，当我尝试在本地运行它时，我得到：

```
A Database Error Occurred
Unable to connect to your database server using the provided settings.
Filename: F:\xampp-portable\htdocs\....\database\DB_driver.php
Line Number: 124 
```

在我的 index.php 文件中，我添加了：

```
mysql_connect("localhost","root","") or die ("Could not connect to mysql server.");
mysql_select_db("contacts_db") or die ("Could not connect to database."); 
```

这不会产生错误。谁能给我一些关于下一步检查的指示？

提前致谢，

账单

好的，这是第 124 行的代码：

```
function initialize()
{
    // If an existing connection resource is available
    // there is no need to connect and select the database
    if (is_resource($this->conn_id) OR is_object($this->conn_id))
    {
        return TRUE;
    }

    // ----------------------------------------------------------------

    // Connect to the database and set the connection ID
    $this->conn_id = ($this->pconnect == FALSE) ? $this->db_connect() : $this-        >db_pconnect();

    // No connection resource?  Throw an error
    if ( ! $this->conn_id)
    {
        log_message('error', 'Unable to connect to the database'); // 124

        if ($this->db_debug)
        {
            $this->display_error('db_unable_to_connect');
        }
        return FALSE;
    } 
```

约翰是对的，尽管我现在很困惑。我在 index.php 中设置了以下代码，以在 xampp 和服务器数据库配置文件之间自动切换：

```
define('ENVIRONMENT', isset($_SERVER['SERVER_NAME'])=='my_domain_name.com' ? 'production' : 'development');

    echo 'SERVER_NAME  '.$_SERVER['SERVER_NAME']; // getting localhost
    echo 'env '.ENVIRONMENT; // getting production. 
```

我认为这会导致使用 $_SERVER['SERVER_NAME']=localhost 将 ENVIRONMENT 常量设置为“开发”。有人介意解释我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T04:32:44.533

请检查您的`config/database.php`文件，因为我知道 codeigniter 中的配置数据库在此文件中。您需要注意的一些值是：

```
$db['default']['hostname'] = '';
$db['default']['username'] = '';
$db['default']['password'] = '';
$db['default']['database'] = ''; 
```

# algorithm - 挑选元素游戏

> ID：13635953
> 
> 赞同：1
> 
> 时间：2012-11-29T22:30:14.910
> 
> 标签：algorithm, dynamic-programming

这是一个简单的游戏：
有一个集合，A={a1,...,an}，对手可以选择集合的第一个或最后一个元素之一，最后收集更多数字的人获胜。现在说每个参与者都尽力而为，我需要做的是编写一个动态算法来估计他们的分数。
任何想法或线索都会受到真正的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T22:41:27.193

这里有一个提示：要编写动态规划算法，您通常需要递归。给定

```
A={a1,...,an} 
```

复发看起来像这样

```
f(A)= max( f({a1,...,a_n-1}) ,  f({a2,...,a_n}) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T10:29:22.227

实际上 dfb 给出的递归关系可能不会导致正确的答案，因为它不会导致正确的次优结构！假设玩家 A 开始游戏：他的问题结构是 [a1,a2,...an] 选择一个元素后，a1 或 an ，轮到玩家 B 下棋，然后移动之后就是玩家A的举动。所以在两步之后，玩家 A 会再次轮到他，这将是他的正确子问题。正确的递归关系将是

假设剩下 i 到 j 个元素：

`A(i,j)= max(min( A(i+1,j-1),A(i+2,j)+a[i] ), min(A(i,j-2),A(i+1,j-1))+a[j])`

参考以下链接： http: [//people.csail.mit.edu/bdean/6.046/dp/](http://people.csail.mit.edu/bdean/6.046/dp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T23:17:40.393

实际上你不需要动态规划，因为很容易为上面的游戏找到一个显式的解决方案。

情况 n 是偶数或 n = 1。第二个移动的玩家总是输。

情况 n 为奇数且 n > 1。如果以下两种情况之一发生，则第二个玩家有一个获胜策略：

1.  偶数索引的元素总和大于所有奇数索引的元素

2.  除最后一个以外的所有奇数元素的总和都大于其余所有元素，并且除第一个以外的所有奇数元素的总和都大于其余所有元素。

证明草图：

情况 n 是偶数或 n = 1：令 Sodd 和 Seven 是所有具有偶数/奇数索引的元素的总和。假设 Sodd > 七，否则相同的论点成立。第一个玩家有一个获胜的策略，因为他可以以这样一种方式玩，他会得到所有奇怪的索引项目。

n 为奇数的情况，n > 1 也可以直接求解。事实上，第一个玩家有两个选择，他可以获得集合的第一个或最后一个元素。在剩余的元素中，将它们划分为具有奇数和偶数索引的两个子集；根据上面的论点，第二个玩家将选择总和最大的子集。如果你扩展树游戏，你最终会得到上面的语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T09:25:55.903

## 示例代码

这是用于计算第一和第二玩家的最佳分数的 Python 代码。

```
A=[3,1,1,3,1,1,3]

cache={}
def go(a,b):
    """Find greatest difference between player 1 coins and player 2 coins when choosing from A[a:b]"""
    if a==b: return 0 # no stacks left
    if a==b-1: return A[a] # only one stack left
    key=a,b
    if key in cache:
        return cache[key]

    v=A[a]-go(a+1,b) # taking first stack
    v=max(v,A[b-1]-go(a,b-1)) # taking last stack

    cache[key]=v
    return v

v = go(0,len(A))
n=sum(A)
print (n+v)/2,(n-v)/2 
```

## 反例

请注意，该代码包含此问题的其他答案之一的反例。

考虑案例 [3,1,1,3,1,1,3]。

通过对称性，第一个玩家移动总是离开模式 [1,1,3,1,1,3]。

对于这个偶数元素的总和是 1+3+1=5，而奇数元素的总和是 1+1+3=5，所以论证是从这个位置第二个玩家总是赢 5，而第一个玩家总是会赢 5，所以第一个玩家会赢（因为他得到 5 加上第一步的 3）。

然而，这个逻辑是有缺陷的，因为第二个玩家实际上可以获得更多。

```
First player takes 3, leaves [1,1,3,1,1,3] (only choice by symmetry)
Second player takes 3, leaves [1,1,3,1,1]
First player takes 1, leaves [1,3,1,1] (only choice by symmetry)
Second player takes 1, leaves [1,3,1]
First player takes 1, leaves [3,1] (only choice by symmetry)
Second player takes 3, leaves [1]
First player takes 1 
```

因此，总体而言，第一位玩家获得 3+1+1+1=6，而第二位玩家获得 3+1+3=7，第二位玩家获胜。

缺陷在于，虽然第二个玩家确实可以玩这样他们将赢得所有偶数或所有奇数的位置，但这不是最佳游戏，在某些情况下他们实际上可以做得更好。

# jsf - 标签库支持命名空间：http://java.sun.com/jsf/html，但没有为名称定义标签：facet

> ID：13635957
> 
> 赞同：5
> 
> 时间：2012-11-29T22:30:38.743
> 
> 标签：jsf

我正在测试[https://www.primefaces.org/showcase/ui/overlay/dialog/loginDemo.xhtml](https://www.primefaces.org/showcase/ui/overlay/dialog/loginDemo.xhtml)上的 PrimeFaces 示例。我在 Eclipse Dynamic web 项目中正确导入了 PrimeFaces 和 JSF 2.1，但是在启动网页（使用 Tomcat）时出现以下错误：

```
javax.faces.view.facelets.TagException: /login.xhtml at line 30 and column 36 <f:facet> Tag Library supports namespace: http://java.sun.com/jsf/html, but no tag was defined for name: facet
        org.apache.myfaces.view.facelets.compiler.CompilationManager.pushTag(CompilationManager.java:282)
        org.apache.myfaces.view.facelets.compiler.SAXCompiler$CompilationHandler.startElement(SAXCompiler.java:250)
        com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:506)
        com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.startElement(XMLDTDValidator.java:745)
        com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:376)
        com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2717)
        com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:607)
        com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
        com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:489)
        com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:835)
        com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
        com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
        com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1210)
        com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:568)
        com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse(SAXParserImpl.java:302)
        javax.xml.parsers.SAXParser.parse(SAXParser.java:195)
        org.apache.myfaces.view.facelets.compiler.SAXCompiler.doCompile(SAXCompiler.java:739)
        org.apache.myfaces.view.facelets.compiler.Compiler.compile(Compiler.java:128)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory._createFacelet(DefaultFaceletFactory.java:300)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory.access$000(DefaultFaceletFactory.java:53)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory$1.newInstance(DefaultFaceletFactory.java:114)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory$1.newInstance(DefaultFaceletFactory.java:111)
        org.apache.myfaces.view.facelets.impl.FaceletCacheImpl.getFacelet(FaceletCacheImpl.java:83)
        org.apache.myfaces.view.facelets.impl.FaceletCacheImpl.getFacelet(FaceletCacheImpl.java:50)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory.getFacelet(DefaultFaceletFactory.java:199)
        org.apache.myfaces.view.facelets.impl.DefaultFaceletFactory.getFacelet(DefaultFaceletFactory.java:182)
        org.apache.myfaces.view.facelets.FaceletViewDeclarationLanguage._getFacelet(FaceletViewDeclarationLanguage.java:2622)
        org.apache.myfaces.view.facelets.FaceletViewDeclarationLanguage.buildView(FaceletViewDeclarationLanguage.java:452)
        org.apache.myfaces.lifecycle.RenderResponseExecutor.execute(RenderResponseExecutor.java:78)
        org.apache.myfaces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:241)
        javax.faces.webapp.FacesServlet.service(FacesServlet.java:199)
note The full stack trace of the root cause is available in the Apache Tomcat/7.0.21 logs. 
```

LoginBean.java 包含：

```
package classi;
import java.awt.event.ActionEvent;

import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

import org.primefaces.context.RequestContext;
public class LoginBean
{
    private String username;  

    private String password;  

    public String getUsername() {  
        return username;  
    }  

    public void setUsername(String username) {  
        this.username = username;  
    }  

    public String getPassword() {  
        return password;  
    }  

    public void setPassword(String password) {  
        this.password = password;  
    }  

    public void login(ActionEvent actionEvent) {  
        RequestContext context = RequestContext.getCurrentInstance();  
        FacesMessage msg = null;  
        boolean loggedIn = false;  

        if(username != null  &&/*&&*/ username.equals("admin") && password != null  && password.equals("admin")) {  
            loggedIn = true;  
            msg = new FacesMessage(FacesMessage.SEVERITY_INFO, "Welcome", username);  
        } else {  
            loggedIn = false;  
            msg = new FacesMessage(FacesMessage.SEVERITY_WARN, "Login Error", "Invalid credentials");  
        }  

        FacesContext.getCurrentInstance().addMessage(null, msg);  
        context.addCallbackParam("loggedIn", loggedIn);  
    }  
} 
```

login.xhtml 包含：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.org/ui">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Insert title here</title>
</head>
<body>
<h:outputLink id="loginLink" value="javascript:void(0)" onclick="dlg.show()" title="login">     
    <p:graphicImage value="/images/login.png" />  
</h:outputLink>  

<p:growl id="growl" showDetail="true" life="3000" />  

<p:dialog id="dialog" header="Login" widgetVar="dlg">  
    <h:form>  

        <h:panelGrid columns="2" cellpadding="5">  
            <h:outputLabel for="username" value="Username:" />  
            <p:inputText value="#{loginBean.username}"   
                    id="username" required="true" label="username" />  

            <h:outputLabel for="password" value="Password:" />  
            <h:inputSecret value="#{loginBean.password}"   
                    id="password" required="true" label="password" />  

            <f:facet name="footer">  
                <p:commandButton id="loginButton" value="Login" update=":growl"   
                    actionListener="#{loginBean.login}"   
                    oncomplete="handleLoginRequest(xhr, status, args)"/>  
            </f:facet>

        </h:panelGrid>  

    </h:form>  
</p:dialog>  

<script type="text/javascript">  
    function handleLoginRequest(xhr, status, args) {  
        if(args.validationFailed || !args.loggedIn) {  
            jQuery('#dialog').effect("shake", { times:3 }, 100);  
        } else {  
            dlg.hide();  
            jQuery('#loginLink').fadeOut();  
        }  
    }  
</script>  
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T22:44:38.130

尝试更改`xmlns:f="http://java.sun.com/jsf/html"`为`xmlns:f="http://java.sun.com/jsf/core">`

# php - 如何将类加载为 CodeIgniter 中的方法

> ID：13635959
> 
> 赞同：0
> 
> 时间：2012-11-29T22:30:45.280
> 
> 标签：php, codeigniter

几天前我开始使用 Codeigniter，我想知道它是如何工作的？

我的意思是整个加载类，例如：

```
$this->load->model('model_class_file'); 
```

然后将其用作

```
$this->model_class_file->method(); 
```

它是如何被调用的，我还应该了解什么关于 php 的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:40:35.750

Simple`$this->load`是一个包含`Loader`对象的属性，带有一个调用`model()`来加载模型文件的方法。然后将该模型作为数组元素保存到私有属性中。

访问时`$this->whatever_name_you_put`，PHP 会**[神奇地](http://php.net/manual/en/language.oop5.magic.php "__得到（）")**在私有属性中搜索该索引，并使其可用。

# ruby-on-rails-3 - Rails - 遏制 SSLCA 错误？- Curl::Err::SSLCACertificateError

> ID：13635960
> 
> 赞同：1
> 
> 时间：2012-11-29T22:30:46.200
> 
> 标签：ruby-on-rails-3, curl, ssl-certificate, curb

当我更新我的 Rails gem 时，我发现这个错误（仅在生产中，在开发环境中运行良好）：

```
Curl::Err::SSLCACertificateError 
```

似乎这是一个 SSL 证书颁发机构错误，但为什么只有在生产中不起作用？我能做些什么来解决这个问题？

我的路边宝石是 v.0.8.3 和 rails 3.2.8（市长更新是 rake，现在是 v.10.0.2，但我不知道这是否会影响路边宝石的良好工作）。

仅供参考，这是引发错误的代码：

```
 loginData = { :login => "myuser", :password => "mypass" }
    loginJson = ActiveSupport::JSON.encode(loginData)

    req = Curl::Easy.http_post("https://mysite.com", loginJson
    ) do |curl|
        curl.headers['Content-type'] = 'application/json'
    end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-10T17:38:48.170

听起来您在服务器上使用自签名 SSL 证书，这很好。我对内部服务做同样的事情。您只想让您的客户端也知道自定义 SSL 证书，这样它就知道它是可以信任的。

这样的事情应该可以解决问题：

```
req = Curl::Easy.http_post("https://mysite.com", loginJson) do |curl|
  curl.headers['Content-type'] = 'application/json'
  curl.cacert = "/path/to/ca.crt"
  curl.cert = "/path/to/cert.pem"
end 
```

当然，您可能希望将这些字符串常量提取到配置文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T23:21:15.500

我找到了另一种解决方案，当我请求“卷曲”时，我提出了这个额外的规定：

```
 curl.ssl_verify_peer = false 
```

我不知道在安全方面是否是最好的解决方案，但目前它有效......

# mysql - mysql 按日期和用户标识选择行对

> ID：13635962
> 
> 赞同：1
> 
> 时间：2012-11-29T22:30:51.260
> 
> 标签：mysql, row

我正在寻找一种方法来更改行对的两个值的列值。通过分组来找到正确的行对。问题是因为分组只返回了一个row_id。

案例：一位培训师一天可以有两个活动。
如果客户计划进行培训活动，培训师会拜访该客户，因此他无法在第二次课程中拜访另一位客户。
计划培训活动的客户会收到提供的活动，这些活动的位置值为“空”或带有他们的 customerid。
这样，客户可以在一天内计划多个会话，而当第一个事件在另一个客户处时，另一个客户不能申请第二个事件。
事件分两步声明：首先状态更改为“待处理”，事件获得过期日期，下一步将状态更改为“已进行”。当挂起的事件到期时，状态将更改回“打开”。

问题：无法始终清除该位置。如果其他事件已发生或未决，则无法清除该位置。当两个事件都“打开”时，必须清除两者的位置。

设计：事件表包含一个列“位置”。如果计划了活动，则将这一天的所有“位置”字段设置为 customerid；

```
eventid - orderid - eventdatetime - expiredate - status - location
2 - NULL - 12 december 2012  9:00 - NULL - open - 45
3 - 54   - 12 december 2012 13:00 - 23nov2012 - pending - 45
4 - 74   - 13 december 2012  9:00 - 23nov2012 - pending - 45
5 - 23   - 13 december 2012 13:00 - NULL - taken - 45
6 - NULL - 14 december 2012  9:00 - NULL - open - NULL
7 - NULL - 14 december 2012 13:00 - NULL - open - NULL 
```

如果 eventid 3 过期，状态必须设置为 'open' 并且 eventid 2 AND 3 的位置必须设置为 NULL 如果 eventid 4 过期，状态必须设置为 'open 但 eventid 4 的位置 AND 5 必须保持不变

我在两个查询中执行此操作：

查询一：

```
update trainingevents
set orderid = null
set expiredate = null
set status = "open"
where expiredate > now() 
```

查询二：

```
update trainingevents
set location = null
set expiredate
where eventid in (
    select eventid from trainingevents
    where count(orderid)=0 and count(location)>0
    group by date_format(eventdatetime, only date)
) 
```

我使用分组来查找对，但分组只返回一个 eventid。

有什么建议可以同时获得这两个 eventid？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T12:08:44.727

如果您想更新两行，则无需分组（假设我理解正确）。

你可以这样重写查询二：

```
update trainingevents
set location = null
set expiredate = null
where eventid in (
    select eventid from trainingevents
    where orderid is null and location is not null
) 
```

或者，更简单地说

```
update trainingevents
set
location = null,
expiredate = null
where orderid is null and location is not null 
```

# iphone - 从网站订购多个异步 JSON 解析

> ID：13635963
> 
> 赞同：1
> 
> 时间：2012-11-29T22:30:56.543
> 
> 标签：iphone, objective-c, ios

简要介绍一下我在做什么：我有两个数组，它们都包含 50% 的表格视图信息。为什么？因为其中一个阵列从互联网上提取当前信息，而另一个阵列保存了用户数据。我不知道如何以一种不混乱的方式从互联网上获取当前信息，因为我是 Objective-C 的业余爱好者，更不用说在 Objective-C 中建立网络了。无论如何，因此互联网数组正在使用 AFNetworking 提取与已保存数组（保存在核心数据中）中的对象相对应的信息。因此它是我想要的异步的。现在问题来了，或者至少我可以从这种情况中得到什么。

我正在做一个 for 循环，它有效地计算保存数组中的对象并传递每个对象的唯一 ID，以便可以下载、解析来自 Internet 的相应信息并将其添加到 Internet 数组中。但是，由于网络是异步的，因此循环实际上是一次从 Internet 下载所有信息。因此，对象将按照先下载的顺序写入互联网阵列。因此 savedArray[0] 不对应于 internetArray[0] 中的对象。正如您可以想象的那样，这是一个相当大的缺陷，因为当我将值插入到我的 tableView 中时，没有什么真正匹配/有意义。

我真的在寻找一种方法来推迟信息的下载，直到之前的下载完成并添加到 internetArray，我到底该怎么做？现在是代码。这是我获得适当密钥的地方：

```
for ( int i = 0; i < [mySavedObjects count]; i++) {
    MySavedObject* mySavedObject = [mySavedObjects objectAtIndex:i];
    [self retrieveMissingInformation: myObject.Id];
    [self.tableView reloadData];
} 
```

这是我实际获取信息的地方（为了空间而简化）：

```
- (void)retrieveMissingInformation:(NSString *) Id
{
 // create URL here.
AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request
              success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
                        NSLog(@"Success");
                        // Do some safety checks & parse the JSON, returning a searchResult.
                        [searchResults addObject:searchResult];
            } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON)
                        // Do some error messages etc.
}];

[queue addOperation:operation]; //where queue is an ivar NSOperationQueue.
} 
```

最后，在 cellForRowAtIndexpath 中，我使用了这两个：

```
MySavedObject *mySavedObject = [mySavedObjects objectAtIndex:indexPath.row]; 
```

&

```
SearchResult *searchResult = [searchResults objectAtIndex:indexPath.row]; 
```

获取单元格的值。

对不起，巨大的文字墙。我真的不够好，无法有效地解释事情，经常在术语上结结巴巴，不得不求助于自己的例子。订购这个烂摊子的任何帮助，我将不胜感激。

问候，
迈克。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T02:11:51.190

好的工作伙伴，你偶然发现了一个常见的设计模式。

正如您所看到的，对于异步请求，执行几乎是同时发生的，因此当您从 for 循环的角度考虑“队列”时，您无法保证顺序。

您需要考虑下载队列的方式是递归。

换句话说，而不是：

```
// your current method of queue-ing the submission of data
for(int i = 0; i < arrData.count; i++)
{
    [self doAsyncDataSendForIndex:i];
} 
```

你需要开始做这样的事情：

```
// perform the first submit for the first element in your array
[self doAsyncDataSendForIndex:dataIndex];

// a completion callback method
-(void)asyncFinishDownloading
{
    [self parseResult:serverReturnedData];
}

-(void)parseResult:(id)serverData
{
    // do all the processing of the data that you need here

    ...

    // update index for next round
    dataIndex++;

    // -----------------------------------------------------------------
    // now at the end of this method, perform a recursive call 
    // of your async download method again 
    // -----------------------------------------------------------------
    [self doAsyncDataSendForIndex:dataIndex];
} 
```

使用对下载进行排队的回调委托方式，您是在告诉代码仅在处理完最后一次异步下载后才下载下一个数据。

现在您可以使用许多库来帮助您处理异步内容。我自己使用 ASIHttpRequest 和 ASIFormData，你也可以使用更新的 AFNetworking。

```
-(void)asyncSubmitData:(id)someData
{
    NSURL *url = [NSURL urlWithString:@"http://www.yourserver.com/...."];

    ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

    // setup your POST request parameters
    [request setPostValue:someData forKey:@"someKey"];
    ...

    // setup the completion callback delegate action
    [request setCompletionBlock:^{
        // process your server returned data here
        NSString *serverResponse = [request responseString]; // raw server response

        ...

        // increment your index and call your download method again
        dataIndex++;

        [self asyncSubmitData:[myArray objectAtIndex:dataIndex]];
    }];

    // setup fail block in case the server fails
    [request setFailedBlock:^{
        NSLog(@"Server error: %@", [[request error] localizedDescription];
    }];

    // start the asynchronous request now
    [request startAsynchronous];
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T00:21:58.263

推迟信息的下载并有效地使所有网络请求串行（一次一个）会起作用，但这不是一个很好的解决方案，因为进行并发网络请求通常很方便 - 例如，允许四个请求一次可能比连续发出所有请求花费的时间更少。

一个更好的解决方案是在返回时正确处理一条数据。为此，您需要以更结构化的方式处理返回的数据。不只是将其附加到数组中，请执行以下操作之一：

**A.**将返回的数据放入字典中。字典可以从索引或适当的键映射到返回的数据。（提示：如果你想将一个 int 作为键放入字典中，请构造一个包含该 int 的 NSNumber。） **建议使用此选项而不是 B。**

**B.**将返回的数据插入数组。为了使这些有意义，在您进行任何获取之前，您应该用表示“尚未获取此数据位”的占位符对象填充您的数组。一种可能的占位符对象选择是 NSNull - 它只是一个表示 null/nil 的对象。

因此，您可以在 cellForIndexPath: 中返回正确的项目，方法是浸入您的字典或数组。

这两个数据结构的想法只是我想到的最明显的想法，毫无疑问还有其他方法可以解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T00:16:08.933

我想我理解你的问题，听起来你使用了错误的数据结构来存储数据。

您有一个正在生成请求的数组，这些请求的结果存储在一个单独的、不相关的数组中。

当您使用 objectId 生成信息请求时，您能否将结果存储在 NSDictionary 而不是数组中，并使用 objectId 作为该数组的键？

您在成功方法中有 NSURLRequest，因此如果它是查询字符串上的参数，您应该能够通过 NSURL.query 从请求中检索您的 objectId

# c# - Windows 8 通过 FTP 上传文件

> ID：13635973
> 
> 赞同：1
> 
> 时间：2012-11-29T22:31:20.210
> 
> 标签：c#, windows-8, ftp

> **可能重复：**
> [Metro 应用程序中的 FTP](https://stackoverflow.com/questions/12886362/ftp-in-a-metro-app)

有谁知道如何在 Windows 8 上通过 FTP 上传文件？我尝试使用 FtpWebRequest 类，但它在 Windows 8 上不可用。BackgroundUploader 类也不支持 FTP 协议......有什么解决方案吗？

# opengl - 如何在OpenGL中将颜色更改为随机？

> ID：13635980
> 
> 赞同：3
> 
> 时间：2012-11-29T22:31:39.460
> 
> 标签：opengl

我已经尝试了无数次来尝试让它发挥作用。我已经移动了很多东西，但仍然没有任何效果。当我按下 M 键时，我的灯会变成随机颜色。但是，它们仅变为白色。

这就是我所拥有的...

浮动颜色数组[100][3]；// 为随机颜色创建一个数组

**按键功能：**

```
 case 'm' | 'M':
        updateLights(2);
    break; 
```

**defined_to_openGL 函数：**

```
for (int i = 0; i < 3; i++)
{

    glPushMatrix();
    glColor3f(colorArray[i][0],colorArray[i][1],colorArray[i][2]);
        glTranslatef(-50*i/2,-20,0.5); // Begin the first circle at -50, -20\. Then multiply by i to create a space between them.
        drawLights(2.0f);
    glPopMatrix();

    if(i <= 3)
    {
        glPushMatrix();
        glColor3f(colorArray[i][0],colorArray[i][1],colorArray[i][2]);
            glTranslatef(-38,-20,0.5);
            drawLights(2.0f);
        glPopMatrix();

        glPushMatrix();
        glColor3f(colorArray[i][0],colorArray[i][1],colorArray[i][2]);
            glTranslatef(-12,-20,0.5);
            drawLights(2.0f);
        glPopMatrix();
    }

} 
```

**更新灯功能：**

```
{
    cout << "update lights" << endl;
    for(int i = 0; i < 3; i++)
    {
        colorArray[i][0] = rand() % 255;
        colorArray[i][1] = rand() % 255;
        colorArray[i][2] = rand() % 255;
        glutPostRedisplay();
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T22:37:18.213

您正在使用which为每种颜色强度`glColor3f`接受 3 个浮点参数，同时产生一个 in 的输出。`[0.0,1.0]``rand()%255``[0,254]`

您可以切换到`glColor3ub( GLubyte red, GLubyte green, GLubyte blue)`接受无符号字节的哪个（并更改模为，`%256`因为您正在跳过一个值`255`）或`[0.0,1.0]`通过将随机生成更改 为来生成一个值，`rand()/((float)RAND_MAX+1)` 但这意味着您必须将类型更改`colorArray`为`GLFloat`。

# php - 在 php 中包含一个类时的奇怪行为

> ID：13635981
> 
> 赞同：2
> 
> 时间：2012-11-29T22:31:50.307
> 
> 标签：php, jquery, ajax, wamp

我在使用 PHP 时遇到了一种奇怪的行为。基本上我想在 PHP 脚本中需要一个类。我知道这是直截了当的，我以前做过，但是当我这样做时，它会改变我的 jquery (1.8.3) ajax 响应的行为。我正在运行 wamp 设置，我的 PHP 版本是 5.4.6。

这是我的 index.html 的示例

头（省略 jquery js 包括）

```
<script>
    $(document).ready(function(){
        $('#submit').click(function(){
            var action = $('#form').attr('action');
            var form_data = {
                fname: $('#fname').val(),
                lname: $('#lname').val(),
                phone: $('#phone').val(),
                email: $('#email').val(),
                is_ajax: 1
            };

            $.ajax({
                type: $('#form').attr('method'),
                url: action,
                data: form_data,
                success: function(response){
                    switch(response){
                        case 'ok':
                            var msg = 'data saved';
                        break;
                        case 'ko':
                            var msg = 'Oops something wrong happen';
                        break;
                        default:
                            var msg = 'misc:<br/>'+response;
                        break;
                    }
                    $('#message').html(msg);
                }
            });

            return false;
        });
    });
</script> 
```

身体

```
<div id="message"></div>
<form id="form" action="handler.php" method="post">
    <p>
        <input type="text" name="fname" id="fname" placeholder="fname">
        <input type="text" name="lname" id="lname" placeholder="lname">
    </p>
    <p>
        <input type="text" name="phone" id="phone" placeholder="phone">
        <input type="text" name="email" id="email" placeholder="email">
    </p>
    <input type="submit" name="submit" value="submit" id="submit">
</form> 
```

至于 handler.php 文件：

```
<?php
    require('class/Container.php');

    $filename = 'xml/memory.xml';

    $is_ajax = $_REQUEST['is_ajax'];
    if(isset($is_ajax) && $is_ajax){

        $fname = $_REQUEST['fname'];
        $lname = $_REQUEST['lname'];
        $phone = $_REQUEST['phone'];
        $email = $_REQUEST['email'];

        $obj = new Container;
        $obj->insertData('fname',$fname);
        $obj->insertData('lname',$lname);
        $obj->insertData('phone',$phone);
        $obj->insertData('email',$email);
        $tmp = $obj->give();
        $result = $tmp['_obj'];
        /*
            Push data inside array
        */
        $array = array();
        foreach($result as $key => $value){
            array_push($array,$key,$value);
        }

        $xml = simplexml_load_file($filename);
        // check if there is any data in
        if(count($xml->elements->data) == 0){
            // if not, create the structure
            $xml->elements->addChild('data','');
        }
        // proceed now that we do have the structure
        if(count($xml->elements->data) == 1){
            foreach($result as $key => $value){
                $xml->elements->data->addChild($key,$value);
            }
            $xml->saveXML($filename);
            echo 'ok';
        }else{
            echo 'ko';
        }
    }
?> 
```

容器类：

```
<?php
    class Container{
        private $_obj;

        public function __construct(){
            $this->_obj = array();
        }

        public function addData($data = array()){
            if(!empty($data)){
                $oldData = $this->_obj;
                $data = array_merge($oldData,$data);
                $this->_obj = $data;    
            }
        }

        public function removeData($key){
            if(!empty($key)){
                $oldData = $this->_obj;
                unset($oldData[$key]);
                $this->_obj = $oldData;
            }
        }

        public function outputData(){
            return $this->_obj;
        }

        public function give(){
            return get_object_vars($this);
        }

        public function insertData($key,$value){
            $this->_obj[$key] = $value;
        }
    }
?> 
```

奇怪的是，我的结果总是属于默认的 switch 语句，而 ajax 响应同时适合当前的语句。然后我注意到，如果我只是将 Container 类粘贴到 handler.php 文件的顶部，一切正常，但它有点挫败了我试图实现的目标。

我尝试了不同的方法来包含 Container 类，但它似乎不是特定于当前场景的问题。

我还在学习 PHP，我的猜测是我错过了一些非常基本的东西。我还在stackoverflow上搜索我遇到的问题以及PHP.net，但没有成功。

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:56:39.853

我的猜测是您的类文件末尾有空格，这导致输出为“ok”而不是“ok”。这可能是使用某些应用程序编辑文件或在关闭后意外添加空格的结果`?>`。尝试一起删除 php 类中的关闭`?>`。这不仅是允许的（无论如何，php 都会在文件末尾自动结束处理），而且在许多样式指南中经常鼓励这样做，以防止出现您所描述的那种事情。

对于这种情况，我通常会做的另一件事是返回一个 json 字符串，而不是返回一个纯字符串，jQuery 会自动为您转换成一个 javascript 对象。这也可以防止或至少让您立即知道您遇到了上述类型的问题。

所以php会像这样回显：

```
exit( json_encode( array( 'status' => 'ok' ) ) ); 
```

和 jQuery 会收到这样的：

```
 $.ajax({
        type: $('#form').attr('method'),
        url: action,
        data: form_data,
        dataType: 'json',
        success: function(response){
            switch(response.status){
                case 'ok':
                    var msg = 'data saved';
                break;
                case 'ko':
                    var msg = 'Oops something wrong happen';
                break;
                default:
                    var msg = 'misc:<br/>'+response;
                break;
            }
            $('#message').html(msg);
        }
    }); 
```

请注意在 ajax 调用中添加的`dataType`参数，以及`response.status`用于检查我们在 PHP 中创建的状态属性。

这也允许您在响应中返回多个值。您可以在 PHP 端构建您喜欢的对象或数组，并且您基本上会收到与 javascript 端的 javascript 对象相同的内容。

# joomla - 获取 Joomla 中刚刚创建的文章的 SEF URL

> ID：13635988
> 
> 赞同：2
> 
> 时间：2012-11-29T22:32:16.387
> 
> 标签：joomla, joomla1.5

当我在管理面板中创建新内容项时，我想立即知道该项目的 sef url。这可能使用php代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:37:14.693

谈到核心内容管理器，您不能这样做。原因，直到项目没有被保存，它才没有进入数据库，也没有它的 id。您可以使用 ajax 自动保存和检索数据，但它与纯功能有很大不同。

# .htaccess - wordpress htaccess 重写

> ID：13635989
> 
> 赞同：0
> 
> 时间：2012-11-29T22:32:20.177
> 
> 标签：.htaccess

我有一个 wordpress 博客。

我的问题是。如何重写此网址

```
www.1234.com/?s=&cp_state=city 
```

在这

```
www.1234.com/city 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T04:34:42.780

尝试在 WP 指令（如果有）或任何其他指令之前将这些行添加到根目录中的 .htaccess 文件中。例子：

```
#These are the 2 lines to add
RewriteEngine On
RewriteRule ^(city)/?$ ?s=&cp_state=$1 [L]
#End of added lines

# BEGIN WordPress - This is just an example, there might be more or different.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress - WP directives end here 
```

请求的 URL 可以是`www.1234.com/city`或`www.1234.com/city/`带有或不带有`www`.

如有必要，为了测试重定向是否正常，在 index.php 的开头添加如下内容：

```
<?php
if ($_GET['cp_state'] == 'city') {
    echo "cp_state = city<br /><br />";
}
?> 
```

应显示字符串“cp_state = city”。

# facebook-php-sdk - “必须使用活动访问令牌”（2012 年 12 月）&& 为 Ajax 调用设置 Facebook 的 PHP-SDK 以获取用户 ID 的正确方法

> ID：13635991
> 
> 赞同：8
> 
> 时间：2012-11-29T22:32:21.590
> 
> 标签：facebook-php-sdk

这让我很头疼。我有一个页面选项卡应用程序，其中 DB-interaction 使用 facebook-user-id 分配和保存数据以及检查用户权限。直到不久之前，一切都运行良好，但现在随着即将到来的 12 月更改，此设置不再起作用：

**配置.php：**

```
$facebook = new Facebook( array(
'appId' => $app_id,
'secret' => $app_secret,
'cookie' => true
)); 
```

**index.php：** 包含 config.php 并获取签名请求（对问题不重要

**javascript.js：** 调用read-user-status.php并处理数据

**read-user-status.php：** 给出 json-response，包括 config.php 并调用 $facebook -> getUser()-function 来获取 uid

即使在页面加载后直接从 index.php 调用，我有时也会得到 uid，有时却没有。奇怪的是，我通常需要稍等片刻，直到我重新加载页面，然后它才能再次工作。但情况并非总是如此。这一切对我来说都很奇怪。

**编辑：**应该提到这个电话：

```
$uid = $facebook -> getUser();
if ($uid) {
    try {
       // Proceed knowing you have a logged in user who's authenticated.
       $user_profile = $facebook -> api('/me');
    } catch (FacebookApiException $e) {
       error_log($e);
       $uid = FALSE;
     echo "EXCEPTION $e";
   }
} 
```

给出“异常必须使用活动访问令牌来查询有关当前用户的信息”。

我知道那里有很多类似的问题，但没有一个答案对我的特定问题（并且可能对所依赖的新突破性更改）有帮助。

**EDIT2：**我现在认为它是一个 sdk 错误（[https://developers.facebook.com/bugs/238039849657148](https://developers.facebook.com/bugs/238039849657148)，感谢 CBroe）。任何解决方法的建议当然都非常受欢迎。

**编辑 3，临时解决方案** 每次发出 ajax 请求时，都会发布从 FB.getLoginStatus 或 FB.login 获得的令牌，并在 php 文件中读出并通过 $facebook -> setAccessToken 设置它。并非在所有情况下都适用（您肯定需要使用 post），速度较慢并带来一些安全问题，但仍然有效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-02T11:19:08.690

听起来你受到了我在 11 月初报告的错误的影响，[https://developers.facebook.com/bugs/238039849657148](https://developers.facebook.com/bugs/238039849657148)

他们已经确认并说他们正在努力解决问题——但由于距离现在只有几天的时间了，他们应该快一点……</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T13:59:18.850

我通过执行以下操作得到了这个工作......

```
if(!$user){

$loginUrl = $facebook->getLoginUrl(array(
                'scope' => 'email',
                'redirect_uri' => $app_url
                ));
    header('Location: ' . $loginUrl);
} 
```

**我还添加了我的应用程序以集成：**

*   使用 Facebook 登录的网站
*   脸书上的应用
*   页面选项卡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-13T15:09:50.410

如果你很幸运，并且你的 php sdk 版本仍然在 _graph 方法声明之后注册会话变量：

```
//在下面找到这个方法
        受保护的函数 _graph ($path, $method = 'GET', $params = array ())
        {

//粘贴在下面的_graph方法声明代码之后：
            if (isset($_SESSION["fb_".$this->getAppId()."_access_token"]))
            {
                $this->setAccessToken($_SESSION["fb_".$this->getAppId()."_access_token"]);
            }
//到这里
//你可以走了
//请记住：您的 sdk 版本必须在会话中注册访问令牌变量
//在ajax调用之后
//我使用 git 来获取在 github 上发布的 sdk 的最后一次提交之前的版本

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T08:42:43.403

尝试通过向请求添加访问令牌。

```
$accessToken = $facebook->getAccessToken();
$user_profile = $facebook->api('/me?access_token=' . $accessToken); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T16:46:47.547

我找到了一个解决方法，直到它被修复（看起来，在更改发生之前不会及时）。每次您发出 ajax 请求时，您都会发布从 FB.getLoginStatus 或 FB.login 获得的令牌，并在 php 文件中读出并通过 $facebook -> setAccessToken 设置它。并非在所有情况下都适用（您肯定需要使用 post），速度较慢并带来一些安全问题，但仍然有效。

# java - 类首选项中的方法 init 不能应用于给定类型

> ID：13635998
> 
> 赞同：0
> 
> 时间：2012-11-29T22:32:59.737
> 
> 标签：java, init

```
method init in class Preferences cannot be applied to given types;
required: String
found: no arguments
reason: actual and formal argument lists differ in length 
```

并`Preferences.init();`在 NetBeans 中标记为红色

不知道是什么问题？

运行时出现以下错误：

```
 Exception in thread "main" java.lang.RuntimeException: Uncompilable source code - Erroneous sym type: processing.app.Preferences.init
    at arduinojava.ArduinoJava.main(ArduinoJava.java:34)
Java Result: 1 
```

这是代码：

```
/*
* This class will get the input from arduino board and output
* the data to the scanner
* Code adopted from Silveira Neto
*/

package arduinojava;

import gnu.io.CommPortIdentifier;
import gnu.io.SerialPort;
import java.io.InputStream;
import java.io.OutputStream;
import processing.app.Preferences;

/**
*
* @author kinley tshering
*/
public class ArduinoJava {

static InputStream input;
static OutputStream output;
static CommPortIdentifier portId;
static SerialPort port;

/**
* @param args the command line arguments
*/

public static void main(String[] args) {
  //code application logic here

     Preferences.init();
     System.out.println("Using port: " + Preferences.get("serial.port"));
    try {
            portId = CommPortIdentifier.getPortIdentifier(
                   Preferences.get("serial.port"));

          //port = (SerialPort)portId.open("serial talk", 4000);
          port = (SerialPort)portId.open("", 4500);
          input = port.getInputStream();
          output = port.getOutputStream();
           port.setSerialPortParams(Preferences.getInteger("serial.debug_rate"),
                  SerialPort.DATABITS_8,
                  SerialPort.STOPBITS_1,
                  SerialPort.PARITY_NONE);

          while(true){
                      while(input.available() > 0) {
                                   System.out.print((char)(input.read()));
                       }
           }
  }
  catch(gnu.io.NoSuchPortException nsp)  {
       System.err.println("ERROR: " + nsp.getMessage());
   }
  catch(gnu.io.UnsupportedCommOperationException usp)  {
       System.err.println("ERROR: " + usp.getMessage());
   }
   catch(gnu.io.PortInUseException pie)  {
       System.err.println("ERROR: Port " + port + " is already in use\nCLose the port and restart.");
   }
   catch(java.io.IOException ioe) {
       System.err.println("IO ERROR: " + ioe.getMessage() );
   }
   catch(Exception exe) {
       System.err.println("ERROR: Unexpected error occured \n" + exe.getMessage() );
    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:34:19.197

```
method init in class Preferences cannot be applied to given types;
required: String
found: no arguments 
```

看来您在类中没有任何方法 init()**没有**参数`Preferences`。

您需要调用以下内容：

```
Preferences.init("yourString"); 
```

注意：我们不知道调用方法`yourString`时应该是什么。`init()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:34:33.953

> 类 Preferences 中的方法 init 不能应用于给定类型；必需：找到字符串：无参数

错误说明了一切，您的 init() 方法需要一个 String 参数，而您没有传递任何参数。

这个 Preferences.init();

应该

```
 Preferences.init("pass a string argument here"); 
```

# php - 如何在 PHP 中选择以某个单词开头的文件？

> ID：13635999
> 
> 赞同：3
> 
> 时间：2012-11-29T22:32:59.393
> 
> 标签：php, regex, filesystems

我有一个需要读取多个 xml 数据文件的小型 php 应用程序。这些文件将以下列方式生成：

```
contractors1.xml
contractors2.xml
contractors3.xml
...
contractors100.xml 
```

如何选择目录中以“contractors”开头、后跟以“.xml”结尾的数字的任何文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:34:50.817

```
glob() 
```

是您需要执行此操作的功能。

这应该工作

```
<?php
foreach (glob("contractors*.xml") as $filename) {
    echo "$filename size " . filesize($filename) . "\n";
}
?> 
```