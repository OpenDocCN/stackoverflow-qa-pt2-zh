# StackOverflow 问答 15704000-15704999

# python - 使用多处理将数据写入 hdf 文件

> ID：15704010
> 
> 赞同：9
> 
> 时间：2013-03-29T13:15:41.240
> 
> 标签：python, multiprocessing, hdf5

这似乎是一个简单的问题，但我无法理解它。

我有一个模拟，它在双循环中运行并将结果写入 HDF 文件。该程序的一个简单版本如下所示：

```
import tables as pt

a = range(10)
b = range(5)

def Simulation():
    hdf = pt.openFile('simulation.h5',mode='w')
    for ii in a:
        print(ii)
        hdf.createGroup('/','A%s'%ii)
        for i in b:
            hdf.createArray('/A%s'%ii,'B%s'%i,[ii,i])
        hdf.close()
    return
Simulation() 
```

这段代码完全符合我的要求，但由于该过程可能需要很长时间才能运行，我尝试使用多处理模块并使用以下代码：

```
import multiprocessing
import tables as pt

a = range(10)
b = range(5)

def Simulation(ii):
    hdf = pt.openFile('simulation.h5',mode='w')
    print(ii)
        hdf.createGroup('/','A%s'%ii)
        for i in b:
            hdf.createArray('/A%s'%ii,'B%s'%i,[ii,i])
        hdf.close()
    return

if __name__ == '__main__':
    jobs = []
    for ii in a:
        p = multiprocessing.Process(target=Simulation, args=(ii,))
        jobs.append(p)       
        p.start() 
```

然而，这只会将最后一个模拟打印到 HDF 文件中，不知何故它会覆盖所有其他组。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-29T13:33:36.050

每次以 write ( `w`) 模式打开文件时，都会创建一个新文件——因此如果文件已经存在，则文件的内容会丢失。只有最后一个文件句柄才能成功写入文件。即使您将其更改为附加模式，您也不应该尝试从多个进程写入同一个文件——如果两个进程同时尝试写入，输出将会出现乱码。

相反，让所有工作进程将输出放入队列中，并让一个**专用进程**（子进程或主进程）处理队列的输出并写入文件：

* * *

```
import multiprocessing as mp
import tables as pt

num_arrays = 100
num_processes = mp.cpu_count()
num_simulations = 1000
sentinel = None

def Simulation(inqueue, output):
    for ii in iter(inqueue.get, sentinel):
        output.put(('createGroup', ('/', 'A%s' % ii)))
        for i in range(num_arrays):
            output.put(('createArray', ('/A%s' % ii, 'B%s' % i, [ii, i])))

def handle_output(output):
    hdf = pt.openFile('simulation.h5', mode='w')
    while True:
        args = output.get()
        if args:
            method, args = args
            getattr(hdf, method)(*args)
        else:
            break
    hdf.close()

if __name__ == '__main__':
    output = mp.Queue()
    inqueue = mp.Queue()
    jobs = []
    proc = mp.Process(target=handle_output, args=(output, ))
    proc.start()
    for i in range(num_processes):
        p = mp.Process(target=Simulation, args=(inqueue, output))
        jobs.append(p)
        p.start()
    for i in range(num_simulations):
        inqueue.put(i)
    for i in range(num_processes):
        # Send the sentinal to tell Simulation to end
        inqueue.put(sentinel)
    for p in jobs:
        p.join()
    output.put(None)
    proc.join() 
```

* * *

为了比较，这是一个使用的版本`mp.Pool`：

```
import multiprocessing as mp
import tables as pt

num_arrays = 100
num_processes = mp.cpu_count()
num_simulations = 1000

def Simulation(ii):
    result = []
    result.append(('createGroup', ('/', 'A%s' % ii)))
    for i in range(num_arrays):
        result.append(('createArray', ('/A%s' % ii, 'B%s' % i, [ii, i])))
    return result

def handle_output(result):
    hdf = pt.openFile('simulation.h5', mode='a')
    for args in result:
        method, args = args
        getattr(hdf, method)(*args)
    hdf.close()

if __name__ == '__main__':
    # clear the file
    hdf = pt.openFile('simulation.h5', mode='w')
    hdf.close()
    pool = mp.Pool(num_processes)
    for i in range(num_simulations):
        pool.apply_async(Simulation, (i, ), callback=handle_output)
    pool.close()
    pool.join() 
```

它看起来更简单不是吗？然而，有一个显着的区别。`output.put`用于发送 args的原始代码`handle_output`在其自己的子进程中运行。`handle_output`将从队列中取出并立即处理它们`args`。`output`使用上面的 Pool 代码，`Simulation`累积一大堆`args`in`result`并且直到返回后才`result`发送到。`handle_output``Simulation`

如果`Simulation`需要很长时间，则将有很长的等待时间，而没有写入任何内容`simulation.h5`。

# wordpress - 网站不会加载。发生这种情况时，为什么我的浏览器地址栏中会显示“:4001”？

> ID：15704011
> 
> 赞同：0
> 
> 时间：2013-03-29T13:15:48.013
> 
> 标签：wordpress, migration, request

我已将本地安装的 Wordpress 迁移到我的主机。

现在，当我尝试加载该站点（例如“www.mynewsite.com”）时，浏览器会搅动一段时间，然后报告我的站点无法加载，因为响应时间太长。

我注意到我的浏览器的地址栏现在显示为：www.mynewsite.com:4001

当“：4001”在您的网址末尾被标记时是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T20:44:42.607

:4001 是您的端口号，看起来您的网站是在该端口上开发的，连接到您网站的数据库并编辑您的 WP 安装的选项表（默认 wp_options）更新条目`siteurl`和`home`（通常分别为条目 1 和 37）到您的新 url。

如果您使用与实时站点相同的主机名在本地进行开发，则需要禁用主机名，以便查看实时站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:39:44.003

您的基本 wordpress 配置是什么？在将 wordpress 网站移动到新主机时，您需要在 wp-config.php 中设置网站地址。这是因为当您在 localhost 上安装 wordpress 时，它会将 127.0.0.1 作为本机路径，您需要重新配置配置文件，看起来您的本地设置运行在 4001 端口上！

# objective-c - NSOperationQueue waitUntilAllOperationsAreFinished 在后台不工作

> ID：15704015
> 
> 赞同：5
> 
> 时间：2013-03-29T13:15:57.927
> 
> 标签：objective-c, nsoperation, nsoperationqueue

我正在开发的应用程序会定期从应用程序服务器刷新其本地数据缓存（10 多个请求，每个请求都需要相当长的时间）。我目前正在异步运行这些请求，以免阻塞 UI 线程。`beginBackgroundTaskWithExpirationHandler`由于这些请求确实需要一段时间来处理然后加载到核心数据中，我想利用`NSOperationQueue`.

在我将所有请求添加到操作队列后，我使用`waitUntilAllOperationsAreFinished`to 阻塞直到所有操作完成（这不在主线程上）。我在原型中看到的问题是，当我运行应用程序并立即将其后台运行（按主页按钮）时，`waitUntilAllOperationsAreFinished`即使在所有操作完成后仍然被阻止......但是一旦我再次打开应用程序，处理程序完成。如果我运行该应用程序并让它保持在前台，一切都会很好。在我的实际应用程序中，这种行为似乎并不总是发生，但使用下面的示例代码，它似乎：

```
#import "ViewController.h"

@interface ViewController ()

@property (assign, nonatomic) UIBackgroundTaskIdentifier task;
@property (strong, nonatomic) NSOperationQueue *queue;

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self performSelectorInBackground:@selector(queueItUp) withObject:nil];
}

- (void)queueItUp {
    UIApplication *application = [UIApplication sharedApplication];

    self.queue = [[NSOperationQueue alloc] init];
    self.task = [application beginBackgroundTaskWithExpirationHandler:^{
        NSLog(@"Took too long!");

        [self.queue cancelAllOperations];
        [application endBackgroundTask:self.task];
        self.task = UIBackgroundTaskInvalid;
    }];

    for (int i = 0; i < 5; i++) {
        [self.queue addOperationWithBlock:^{
            [NSThread sleepForTimeInterval:3];
            NSLog(@"Finished operation.");
        }];
    }

    NSLog(@"Waiting until all operations are finished.");

    [self.queue waitUntilAllOperationsAreFinished];

    [application endBackgroundTask:self.task];
    self.task = UIBackgroundTaskInvalid;

    NSLog(@"All done :)");
}

@end 
```

我究竟做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T19:48:20.010

您的示例代码在 iPhone 或模拟器上的 iOS 6.1 上的任何时候都不会永久阻塞。在 line 处放一个断点`[application endBackgroundTask:self.task];`，你每次都会命中它。

您看到的行为是因为您在告诉应用程序结束后台任务后在后台登录。我不确定确切的细节，但日志以某种方式排队，以便在您的应用程序恢复到前台时打印到控制台。可能是线程执行被暂停的情况。

如果您`NSLog(@"All done");`在调用 之前移动到`endBackgroundTask:`，您将看到记录的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T19:12:43.470

使用您的示例代码，操作完成得很好。你挂在上面`NSLog(@"All done :)");`。您的队列仍然存在并且没有挂起的操作，但是您可能不再有活动的运行循环，并且主线程在您和后台被阻塞。由于您已完成待处理的后台操作，因此您已被阻止。当您恢复您的应用程序时，它会从中断的地方继续。如果你这样做：

```
 [[self queue] addOperationWithBlock:^{
        NSLog(@"All done :)");
    }]; 
```

行为应该更加明显。它正在做你告诉它做的事情。

你有一堆操作在排队，你已经调用了`waitUntilAllOperationsAreFinished`. 当他们完成时，您将被阻止在后台。

当这组操作完成时，您似乎正在尝试执行某些操作。NSOperation 提供了具有允许您构建这种行为的依赖项和完成块的能力。您可以对操作进行分组并设置在您的操作组完成时运行的完成块或操作。[并发编程指南](http://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationObjects/OperationObjects.html#//apple_ref/doc/uid/TP40008091-CH101-SW1)中涵盖了其中一些内容

# jquery - 获取相对于 div 位置的鼠标坐标在 Firefox 中不起作用

> ID：15704016
> 
> 赞同：0
> 
> 时间：2013-03-29T13:16:02.530
> 
> 标签：jquery

为什么下面的示例代码在我的浏览器 firefox v. 19.0.2 中不起作用？

```
<html>
<head>
<style>
#example {
position: absolute;
top: 20px;
left: 50px;
width: 300px;
height: 300px;
background-color: #C00;
}
</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script>
$("#example").mousemove(function(e) {
var xPos = e.pageX - $(this).position().left;
var yPos = e.pageY - $(this).position().top;
$("#pos").text("x: " + xPos + " / y: " + yPos);
});
</script>
</head>
<body>
<div id="example"></div>
<div id="pos"></div>
</body>
</html> 
```

`<div>`我看不到ID 为 pos的标签中应该存在的坐标。ThanX 提前为您提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:19:17.933

当元素尚不存在于 DOM 中时，您将附加事件处理程序。将您的 JavaScript 包装在[.ready()](http://api.jquery.com/ready/)处理程序中：

```
$(document).ready(function() {
    $("#example").mousemove(function(e) {
        var xPos = e.pageX - $(this).position().left;
        var yPos = e.pageY - $(this).position().top;
        $("#pos").text("x: " + xPos + " / y: " + yPos);
    }); 
}); 
```

# c# - 我可以在不使用 c# 中的“foreach”的情况下轻松访问下一次迭代吗？

> ID：15704022
> 
> 赞同：1
> 
> 时间：2013-03-29T13:16:13.233
> 
> 标签：c#, iterator

我有一个 C# 集合，我想知道是否可以访问下一个生成的值，类似于使用 Python 的`.next()`方法可以访问的值。例如

```
 double diffFoo = myList.next() - myObject.Foo;
 double diffBar = myList.next() - myObject.Bar;
 ... 
```

代替，

```
 double diffFoo = myList[0] - myObject.Foo;
 double diffBar = myList[1] - myObject.Bar;
 ... 
```

在这种情况下，`foreach`循环是不合适的，因为每次“迭代”都使用不同的类方法。如果/当订单需要在代码中更改时，我想这样做以节省必须保持更新的索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:32:28.627

不要忽视低技术的解决方案：

```
int index = 0;
double diffFoo = myList[index++] - myObject.Foo;
double diffBar = myList[index++] - myObject.Bar; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T13:33:48.677

您可以使用[IEnumerator.MoveNext](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.movenext.aspx)方法。

```
var enumerator = myList.GetEnumerator();

enumerator.MoveNext();
double diffFoo = enumerator.Current - myObject.Foo;

enumerator.MoveNext();
double diffBar =enumerator.Current - myObject.Bar; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T13:22:19.660

如果您愿意，可以使用列表中的枚举器：

```
var s = new List<string>() { "A", "B", "C" };
var enumerator = s.GetEnumerator();
enumerator.MoveNext();
Debug.WriteLine(enumerator.Current);
enumerator.MoveNext();
Debug.WriteLine(enumerator.Current); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T13:19:23.667

IEnumerator 接口提供了一个名为 GetNext() 的方法。您可以从集合中获取下一个项目。还有 IEnumerator 的通用版本：IEnumerator，请参见[此处](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)。

请参阅[此处](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)以供参考。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T13:19:42.137

您应该阅读有关`IEnumerable`,`IEnumerable<T>`和[**`IEnumerator`**](http://msdn.microsoft.com/pl-pl/library/system.collections.ienumerator.aspx)接口的信息。它们被`foreach`循环使用。

您可以调用`GetEnumerator`集合来获取枚举器实例。有了它，您可以使用`MoveNext()`方法和`Current`属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-29T13:21:31.520

像这样的东西可以工作

```
var someEnumerator = getInt().GetEnumerator();
while(someEnumerator.MoveNext())
{
    int intEnumerate = someEnumerator.Current;
    Console.WriteLine(intEnumerate);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-29T13:21:52.420

我不知道 Python，但它现在存在于 c# 中！

任何实现 IEnumerable 的对象都支持此功能。

看看产量运算符[http://msdn.microsoft.com/en-us/library/9k7k7cf0(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/9k7k7cf0(v=vs.80).aspx)

# c# - WinRT 掩码图像

> ID：15704025
> 
> 赞同：1
> 
> 时间：2013-03-29T13:16:15.993
> 
> 标签：c#, .net, graphics, windows-runtime

我在 WinRT 中屏蔽图像时遇到问题。基本上，我需要做的是从基础图像中剪下一个拼图形状。我将拼图形状作为 PNG 黑白图像，其中形状本身是白色的，背景是黑色的，也是拼图的透明形状。这实际上是 iOS 应用程序的一个端口，他们使用带有黑白蒙版的 CGContextClipToMask 来剪切拼图。我尝试使用 WriteableBitmapEx 中的 Blit 来掩盖图像，但我从未达到我想要的结果，我得到的最接近的是正确切割的形状，但背景是黑色的，而不是什么都没有。切出这种形状的正确方法是什么？感谢所有的答案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:45:04.327

实际上，Windows 8 中的 WinRT/XAML 没有`OpacityMask`其他 XAML 框架的实现。您可以使用`WriteableBitmap`来操纵像素，但它有点慢，尤其是在 ARM 设备上。更快的解决方案是使用 Direct2D，它内置了一个[FillOpacityMask](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371943%28v=vs.85%29.aspx)方法。由于 SharpDX为 .NET 很好地[包装了它](http://sharpdx.org/documentation/api/m-sharpdx-direct2d1-rendertarget-fillopacitymask)，您也可以使用 C# 来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:28:30.377

我没有代码，但最简单的情况是在 Photoshop/GIMP/任何在线透明度工具中打开 PNG 文件，然后将黑色像素 alpha 映射为零。

另一个例子是直接在代码中执行此操作，WriteableBitmapEx 具有更改每个像素的功能，您所要做的就是循环遍历所有黑色像素并将 alpha 更改为 0。

# c++ - 带有 unique_ptr-s 的向量

> ID：15704028
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:16:20.383
> 
> 标签：c++, c++11, move-semantics

我有这样的代码：

```
#include <memory>
#include <vector>

namespace daq
{

class Animal
{
public:
    Animal(){};
};

class Pig : public Animal
{
public:
    Pig() : Animal () {};
};

class Farm
{
public:
    void addAnimal(Animal& animal)
    {
        mAnimals.push_back(std::unique_ptr<Animal>(animal)); // error
    }

private:
    std::vector<std::unique_ptr<Animal>> mAnimals;
};
} /* namespace daq */ 
```

但是我在方法 Farm::addAnimal 中遇到错误：

没有匹配函数调用'std::unique_ptr::unique_ptr(daq::Animal&)'</p>

我应该将什么传递给 push_back 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:28:36.063

A`unique_ptr`接受一个*指针*作为构造函数参数，但您传递的是一个*引用*。这基本上是编译器告诉你的：你不能`std::unique_ptr`从 a 构造 a `daq::Animal&`。

您可以将原始指针传递给使用`Animal`分配的类型的对象`new`，或者（最好）您应该以这种方式传递`unique_ptr`构造并在将其作为参数提供时*从它移开*`push_back()`：

```
void addAnimal(std::unique_ptr<Animal>&& animal)
//                                    ^^
//                                    This is to make it absolutely clear that
//                                    your intention is to bind to an object
//                                    the client wants to move from. It is not
//                                    especially needed here (unique_ptr is not
//                                    copyable), but it makes your interface
//                                    more explicit about it. [Credits to sehe]
{
    mAnimals.push_back(std::move(animal)); // OK
}

int main()
{
    daq::Farm farm;
    std::unique_ptr<daq::Animal> pig(new daq::Pig());
    farm.addAnimal(std::move(pig)); // OK
} 
```

您必须在`std::move()`此处使用，因为`unique_ptr`s 是不可复制的，因此您有效地将所有权`pig`从调用它的例程转移到包含它的向量（`addAnimal()`作为此转移的中间人）。

# c++ - 如何让 Matlab 保持一个 mex 会话活着

> ID：15704035
> 
> 赞同：0
> 
> 时间：2013-03-29T13:16:57.237
> 
> 标签：c++, matlab

我的问题是关于如何对 Matlab 和我的 c++ 代码进行编程，以便它们可以交互。更具体地说，我有一个处理数据、创建对象、导出该对象的统计信息并写入 mat 文件的 c++ 程序。然后我将它加载到matlab中做进一步的分析和可视化。但是，处理数据和创建对象所需的时间是巨大的，而导出统计数据的时间可以忽略不计。另一方面，有许多统计数据和它们的不同组合，很难预测我们将使用哪些组合。所以我希望我可以多次交互运行“统计”部分，而无需重复处理数据的工作。

我的问题是：我可以要求 Matlab： 1\. 调用 c++ 代码；2\. 处理数据并创建对象后，使该对象在内存中保持“活动”状态 3\. 再次调用 c++ 代码以请求将统计信息加载到我的工作区中。4\. 用不同的统计数据重复 3。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:29:03.760

另一个选项可能是在 MEX 函数中创建一个 C++ 类实例，并将指向它的指针返回给 MATLAB，将指针传递给任何后续调用。如果您使用这种方法，您还应该为其创建一个 MATLAB 句柄类包装器，以允许您在其析构函数中正确清理内存。[这](http://www.mathworks.co.uk/matlabcentral/answers/783)是一篇建议发帖人这样做的帖子，[这](http://www.mathworks.com/matlabcentral/fileexchange/38964)是 Mathworks FileExchange 上的方法示例。

此方法对您的问题的适用性取决于问题的复杂性。如果问题与其他方法非常复杂（例如，您需要使用某个库中的 C++ 类并且实例必须在调用之间保持活动状态，或者如果全局变量无法解决问题，我个人只会走这条路您需要跟踪很多实例，这自然最好由一组 C++ 类来表示，您可以在其中正确分离您的关注点）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:25:54.550

实现此目的的一种方法是在 c++ [mex 代码](http://www.mathworks.com/help/matlab/matlab_external/introducing-mex-files.html)中将要再次访问的变量声明为[全局](http://www.learncpp.com/cpp-tutorial/42-global-variables/)变量。这些变量将保留在内存中，您可以再次访问它们（当您调用 mex 函数时），直到您清除该 mex 函数或关闭 Matlab 会话。我为此使用了全局变量，它对我来说效果很好。

另一种选择是使用[持久变量](http://www.mathworks.com/help/matlab/ref/persistent.html)。从文档

> 持久变量类似于全局变量，因为 MATLAB® 软件为两者创建了永久存储。它们与全局变量的不同之处在于，持久变量只有在其中声明它们的函数才知道。这可以防止持久变量被其他函数或 MATLAB 命令行更改。

# .net - 严重依赖 Application.DoEvents() 的 Windows 窗体应用程序如何在无需重新设计的情况下降低其稳定性？

> ID：15704037
> 
> 赞同：3
> 
> 时间：2013-03-29T13:17:09.223
> 
> 标签：.net, multithreading, winforms, crash, application-design

我现在负责维护的应用程序严重依赖 Application.DoEvents() 方法，虽然我没有确凿的证据证明所有突然和莫名其妙的应用程序崩溃都是由使用此方法引起的，但到目前为止，大多数我发现的问题似乎在某种程度上与代码执行流程围绕此方法的方式有关。

我在整个代码中看到的模式或多或少如下：

1.  触发用户触发的事件

2.  事件处理程序运行

然后：

1.  产生了一个新线程

2.  与其阻塞 UI 线程和 UI 直到生成的线程不再运行，或者让控制权离开事件处理程序，代码循环，每次通过调用 Application.DoEvents()，直到它接收到指示生成的线程的信号不再运行。（在某些情况下，派生线程在等待其他事件完成时同时调用 Application.DoEvents()。）

3.  在允许控制离开事件处理程序之前，在 #2 中看到的模式会重复多次。

或者：

1.  通过 Show() 或 ShowDialog() 方法创建和显示表单。

2.  与其阻塞 UI 线程和 UI 的其余部分，直到用户与 Form 交互，或者让控件离开事件处理程序，代码循环，每次通过调用 Application.DoEvents()，直到它接收到一个指示用户已与表单交互。

3.  下一个 Form 显示给用户，并重复相同的练习，直到许多 Forms 之后的控件最终被允许离开事件处理程序。

我知道当您面前没有代码时很难诊断问题，但是假设对 Application.DoEvents() 的调用在某种程度上与该应用程序的不稳定行为有关，那么最简单的方法是什么无需从头开始重新设计即可修复此应用程序？

是否只是让事件处理程序生成一个新线程，允许控制权立即离开事件处理程序，然后使用 WaitHandle 或其他方式阻止生成的线程而不是重复调用 Application.DoEvents()信号机制，直到生成的线程接收到另一个线程已完成其工作或用户已与表单交互的通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:35:31.413

Besides of good tips with removing DoEvents from threads, have you tried to play with BackgroundWorker class? It's better suited for simple threads operations and communication with forms. [http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx) [http://www.dotnetperls.com/backgroundworker](http://www.dotnetperls.com/backgroundworker)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:02:20.913

您的继承设计存在多个大问题。在不使用核武器的情况下，正如 Hans 所建议的那样（实际上并不是一个坏主意），首先要彻底摆脱来自非 GUI 线程的任何 Application.DoEvents() 调用。

然后开始处理其他堆肥。

# android - Webview 在移动设备中显示黑屏？

> ID：15704041
> 
> 赞同：1
> 
> 时间：2013-03-29T13:17:22.120
> 
> 标签：android, webview, screen

正在实施一个电影应用程序。因此，使用 iframe 嵌入 youtube。它在大型设备中工作，但在移动设备中它在流式传输后显示黑屏？请帮我

```
this.webview.getSettings().setJavaScriptEnabled(true);
this.webview.getSettings().setBuiltInZoomControls(true);
this.webview.getSettings().setJavaScriptCanOpenWindowsAutomatically(false);
this.webview.getSettings().setPluginState(WebSettings.PluginState.ON);
this.webview.getSettings().setSupportMultipleWindows(false);
this.webview.getSettings().setSupportZoom(false);
this.webview.setVerticalScrollBarEnabled(false);
this.webview.setHorizontalScrollBarEnabled(false);

final String mimeType = "text/html";
final String encoding = "UTF-8";
String html = getHTML();
webview.loadDataWithBaseURL("", html, mimeType, encoding, ""); 
```

和：

```
public String getHTML1() {
    Log.d("trailer_2 HTML", "ok");
    String html1 = "<html><head><meta name=\"viewport=target-densitydpi=device-dpi\"        content=\"width=320"
            + this.frame_width
            + ", height"
            + this.frame_height
            + ",initial-scale=1.0, minimum-scale=1.0,user-scalable=no\"/>"
            + "</head>"
            + "<body style=\" background:transparent; margin: 0; padding: 0\">"
            + "<iframe class=\"youtube-player\" style=\"border:0; width: 100%; height:100%; padding:0px; margin:0px\" id=\"ytplayer\" type=\"application/x-shockwave-flash\"allowscriptaccess=\"always\" allowfullscreen=\"true\" src=\"http://www.youtube.com/embed/"
            + "H7Ht-m2QMDY"
            + "?fs=0\" frameborder=\"0\">\n"
            + "</iframe>\n";
    return html1;

} 
```

在清单中我提到`android:hardwareAccelerated="true"`和`<uses-permission android:name="android.permission.INTERNET" />`

..提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:48:42.677

您的手机需要 Flash 播放器支持。如果你也有 Flash 播放器

第一次不会显示，你需要双击播放器才能工作。取而代之的是

你可以使用安卓原生 YouTube 播放器 API。它现在是测试版，但它可以工作

惊人的。

# php - 在 yii 中创建文本字段

> ID：15704046
> 
> 赞同：0
> 
> 时间：2013-03-29T13:17:34.753
> 
> 标签：php, yii

我需要帮助。我有 4 个组合框的页面。现在，我需要在同一页面上创建一个额外的文本字段。我有两张桌子。现在用户可以从表 A 中输入一些内容到该文本字段中，并且该数据假设进入表 B。表 A 和 B 是相关的。

出色地：

```
TABLE A:         
======== 
ID   Mark             
1    AA                
2    BB                
3    CC                
.    .                  
.    .                 

TABLE B:
========
A_ID
1
2
3
.
. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:14:47.227

您实现它的确切方式取决于关系类型，即`BELONGS_TO`或`HAS_MANY`？

一个好的开始方法是创建一个从`CFormModel`;扩展的新表单模型。在这里，您可以定义模型`A`和`B`模型的属性，以及您可能需要的任何其他属性，以及它们的相关验证规则。

然后，您的控制器将处理将接收到的数据分离为单独的目标模型以进行保存、更新等的请求。

如果您需要任何具体示例或说明，请告诉我。

# css - 容器 div 中的 3 个 div，如果另一个被取消，则使其中一个扩展

> ID：15704048
> 
> 赞同：1
> 
> 时间：2013-03-29T13:17:37.710
> 
> 标签：css

我在父 div 中有 3 个 div，如下所示：

```
<div id="maincontent>
  <div class="left"></div>
  <div class="mainbody"></div>
  <div class="right"></div>
</div> 
```

该网站的宽度为 1000 像素。

我需要将`.mainbody`div 保持在至少 570 像素，但如果从页面中删除其他 2 个 div 之一，则使其扩展，每个 div 的宽度均为 215 像素。

所有 3 个 div 也都向左浮动。

我尝试使用`min-width`并`max-width`打开，`.mainbody`但它并没有真正起作用。还有其他想法吗？

我当前的 CSS：

```
#maincontent {

  width: 100%;
  overflow: hidden;
}

.left, .right, .mainbody {

  float: left;
}

.left, .right {

  width: 215px;
}

.mainbody {

  width: 570px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:32:15.967

## 仅 CSS 解决方案 1

**这假设问题在说明“是否从页面中删除其他 2 个 div 之一”时是准确的。**

[请参阅使用以下代码的这个小提琴](http://jsfiddle.net/yKGzr/4/)，其中的关键部分是基于您提到的 html 结构更改的更改`:first-child`。`:last-child`当`left`被删除时，`mainbody`变为`first-child`，当`right`被删除时，`mainbody`变为`last-child`，因此如果发生这种情况，请重置`width`。

**关键 CSS**

```
.mainbody {
    width: 570px;
    float: left;
}

.mainbody:first-child,
.mainbody:last-child {
    width: 785px;
}

.left,
.right {
    width: 215px;
    float: left;
} 
```

## 仅 CSS 解决方案 2

**这占了`div`其余的，但没有内容并且宽度为零（这显然是实际情况）。**

有一个纯 CSS 的解决方案（[参见这个小提琴](http://jsfiddle.net/yKGzr/6/)），但它需要重新构建元素的 HTML 顺序并调整它们的浮动方式。

**需要的 HTML 结构（`mainbody`最后一个）**

```
<div id="maincontent1">
  <div class="left"></div>
  <div class="right"></div>
  <div class="mainbody"></div>
</div> 
```

**关键 CSS**

```
.mainbody {
    min-width: 570px;
    overflow: hidden; /* this triggers expansion between left/right */
}

.left {
    width: 215px; /* this is assumed to be zero if no content in div */
    float: left;
}

.right {
    width: 215px; /* this is assumed to be zero if no content in div */
    float: right;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:23:39.300

只是广告和事件的功能。`.click(), .ready()`ETC

```
if($('.right').is(':visible') == false){ 
   $('.mainbody').width(785+'px'); 
}
else{ } 
```

或使用`.size() / .length()`

# nginx - Nginx 用排除重写文件夹

> ID：15704052
> 
> 赞同：1
> 
> 时间：2013-03-29T13:17:55.063
> 
> 标签：nginx, rewrite

我正在研究 nginx 网络服务器。

我想重定向文件夹 1 www.site.com/folder1/ 中的所有网址，但不重定向子文件夹 1 www.site.com/folder1/subfolder1

我为 nginx 配置创建了这些规则，但没有运气。

> 位置 = /文件夹/子文件夹 {
> 
> }
> 
> 位置/文件夹{
> 
> 重写 ^/folder(.*) www.redirect.com 永久；
> 
> }

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T03:58:19.320

好的，这是一个精炼的答案，包括我读过的一些评论以及我的一个评论，
以便能够访问我添加的子文件夹中的资产`try_files`，并为`301`重定向添加了所有其他 url 中的重定向。

```
location /folder/subfolder {
    try_files $uri $uri/ =404;
}

location /folder {
    return 301 $scheme://example.com;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:55:26.903

删除“=”，因为那是“精确”匹配。所以它只匹配文件夹本身，并且对“/folder/subfolder/a_file.html”的请求将与该块不匹配。您还需要在重写规则中添加 $scheme。如果您只想重定向到主页 ( [http://www.redirect.com](http://www.redirect.com) )，您可以删除 "$1" 部分。

```
location /folder/subfolder {

}

location /folder {

  rewrite ^/folder(.*)$ $scheme://www.redirect.com$1 permanent;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:37:37.900

您的新规则集应如下所示。我假设有效的文件命中是可以的（即用户知道文件）。如果您不想要这种行为，请将 try_files 替换为 @rw 块的内容：

```
location /folder {
    try_files $uri $uri/ @rw;
}
location @rw {
    rewrite ^/folder/([^\/]*) http://www.redirect.com/ permanent;
} 
```

这些应该有效。

# bash - 了解脚本以检查文件是否存在

> ID：15704053
> 
> 赞同：2
> 
> 时间：2013-03-29T13:17:55.763
> 
> 标签：bash, file, unix

我有以下命令来检查文件是否存在，如果不可用则创建它：

```
if test "${LOG_FILE:=}x" != "x"; then
    touch $LOGAP
    exit_code=$?
fi 
```

请帮助我理解这个脚本，如何使用测试条件`"${LOG_FILE:=}x" != "x"`来检查是否存在。我正在使用 bash shell。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T13:27:43.630

**基本思想**
脚本检查是否`$LOG_FILE`设置了变量。如果是，它会触及名称存储在`$LOGAP`.

**解释**
让我们拆分它：

```
test == if 
```

所以

```
if test "${LOG_FILE:=}x" != "x"; then 
```

是相同的

```
if [ "${LOG_FILE:=}x" != "x" ]; then 
```

让我们做一个测试：

```
LOG_FILE="FILE_TEST"
echo "${LOG_FILE:=}x" 
```

将输出

```
FILE_TESTx 
```

所以它所做的是检查`LOG_FILE`是否设置了变量。如果设置了，

```
[ "${LOG_FILE:=}x" != "x" ] 
```

将会

```
[ "FILE_TESTx" != "x" ] 
```

这是真的。

如果`LOG_FILE`没有设置，

```
[ "${LOG_FILE:=}x" != "x" ] 
```

将会

```
[ "x" != "x" ] 
```

这是错误的。

就是说是`x`有什么开始的。你可以把它改成

```
[ "${LOG_FILE:=}HELLO_MY_NAME_IS_BLABLA" != "HELLO_MY_NAME_IS_BLABLA" ] 
```

最后，你有一个

```
touch $LOGAP 
```

这将`touch`（如果未创建则创建文件，如果已存在则更新修改日期）。它还需要设置变量`$LOGAP`。

* * *

不得不说，检查文件是否存在的最快方法是：

```
if [ ! -f /tmp/foo.txt ]; then
 ...
fi 
```

# android - 在 Android 中创建仅包含按钮和透明背景的布局

> ID：15704056
> 
> 赞同：0
> 
> 时间：2013-03-29T13:17:58.253
> 
> 标签：android, layout, transparent

我想创建一个只包含一个按钮的布局，我希望布局更加透明，我希望它“不存在”，换句话说，我希望我的布局只是一个非全尺寸的“窗口”但只有按钮大小，所以我将能够继续使用在我的应用程序后面打开的任何应用程序。

我试过 ：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
android:windowBackground="@android:color/transparent" 
android:windowIsTranslucent="true" >

<ToggleButton android:id="@+id/lockButton"
    style="@style/lockToggle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true">
</ToggleButton> 
```

背景确实是透明的，但仍然是一层，后面的应用程序无法使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:21:48.837

由于您需要操作其他应用程序，因此您肯定需要服务

试着检查一下

[创建系统覆盖窗口（始终在顶部）](https://stackoverflow.com/questions/4481226/creating-a-system-overlay-always-on-top-button-in-android)

# vbscript - 在 vbscript 中使用 icacls 更改子文件夹的所有者

> ID：15704060
> 
> 赞同：1
> 
> 时间：2013-03-29T13:18:09.333
> 
> 标签：vbscript

我有一个拥有 700 多个用户的网络，我想创建一个脚本，可以将主文件夹的所有者更改为域管理员，将子文件夹的所有者更改为用户自己。

这是我可以在我的大学的帮助下创造的，但由于某种原因这不起作用。谁能帮助我。谢谢。

```
Set objFSO  = CreateObject("Scripting.FileSystemObject")

Set objFile = objFSO.OpenTextFile("G:\Userhome\userdirlist.txt", 1)

Set oShell  = WScript.CreateObject("WSCript.shell")

Do Until objFile.AtEndOfStream

    struserfolder = objFile.ReadLine

    oshell.run ("icacls G:\userhome\"+ struserfolder +"\*.*  /setowner domainname\" + "struserfolder" + " /t")
    oshell.run ("icacls G:\userhome\"+ struserfolder +"\*.*  /setowner domainname\Domain Admins")
Loop 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T18:40:28.010

当您可能打算使用**变量**时，您使用**字符串** 。改变这个：`"struserfolder"` **`struserfolder`**

 **```
oshell.run ("icacls G:\userhome\"+ struserfolder +"\*.* /setowner domainname\" _
  + **"struserfolder"** + " /t")
```

进入这个：

```
oshell.run "icacls G:\userhome\"+ struserfolder +"\*.* /setowner domainname\" _
  + **struserfolder** + " /t"
```

此外，您必须用空格引用参数。缺少引号可能是阻止第二个命令工作的原因，因为`icacls`试图将所有者设置为`domainname\Domain`而不是`domainname\Domain Admins`. 这应该这样做：

```
oshell.run "icacls G:\userhome\" + struserfolder _
  + "\*.* /setowner ""domainname\Domain Admins""" 
```

顺便说一句，您为什么要两次更改所有者？任何对象都只能有一个所有者，如果您将域管理员组设置为文件夹中顶级对象的所有者，您将不会获得任何东西。

如果您想授予域管理员访问用户主目录的权限，请将所有者更改为本地管理员组（域管理员自动成为该组的成员）并将文件夹的完全控制权授予管理员、系统和用户。然后将更改的权限沿目录树传播：

```
path = Chr(34) & "G:\userhome\" & struserfolder & Chr(34)

oshell.run "icacls " & path & " /setowner Administrators /t /c"
oshell.run "icacls " & path & " /grant Administrators:(OI)(CI)F " _
  & "SYSTEM:(OI)(CI)F domainname\" & struserfolder & ":(OI)(CI)F"
oshell.run "icacls " & path & " /reset /t /c" 
```

* * *

**编辑：**该`Run`方法返回执行命令的退出状态，当事情没有按预期工作时，它可能会给你一些指示：

```
rc = oshell.run("icacls " & path & " /setowner Administrators /t /c", 0, True)
WScript.Echo "icacls returned with exit code " & rc & "." 
```

一个问题可能是默认情况下`Run`是异步的（参数`bWaitOnReturn`默认为`False`），即调用立即返回，而命令 ( `icacls`) 仍在后台运行。这可能会导致后续命令尝试更改尚未获得所有权的对象的权限。

比返回码更有帮助的通常是命令的输出。但是，按照您执行命令的方式，不会显示命令窗口，即使显示了，它也会在命令完成后立即自动关闭。不过，您可以强制命令窗口在命令完成后变得可见并保持打开状态。

```
oshell.run "**%COMSPEC% /k** icacls " & path & " /setowner Administrators /t /c" _
  , **1**, True
```

当然，您通常不希望在生产中使用它，但在调试脚本时它非常有用。

另一种选择是完全避免`Run`并通过该[`Exec`](http://msdn.microsoft.com/en-us/library/ateytk4a%28v=vs.84%29.aspx)方法运行命令。这样您就可以访问已创建进程的[StdOut](http://msdn.microsoft.com/en-us/library/cbxxzwb5%28v=vs.84%29.aspx)和[StdErr ：](http://msdn.microsoft.com/en-us/library/ye284tb8%28v=vs.84%29.aspx)

```
Set icacls = oshell.Exec("icacls " & path & " /setowner Administrators /t /c")
Do While icacls.Status = 0
  WScript.Sleep 100
Loop
WScript.Echo "icacls returned with exit code " & icacls.ExitCode & "."
WScript.Echo icacls.StdOut.ReadAll & icacls.StdErr.ReadAll 
```**

# ruby - 使用 Mongoid 的自引用嵌入文档

> ID：15704061
> 
> 赞同：0
> 
> 时间：2013-03-29T13:18:12.203
> 
> 标签：ruby, mongodb, mongoid

假设我有一个名为 Foo 的 mongoid 模型，它嵌入了许多 Bar。

```
class Foo
    ...
    embeds_many :bar
    ...
end

class Bar
    ...
    embedded_in :foo
    ...
end 
```

我想创建一个 Bar 链接到它自己的关系。该关系将始终涉及嵌入在同一个 Foo 文档中的两个文档。在调用关系时，我似乎无法做到这一点而没有返回 nil。我试过了

```
belongs_to :discovered_by, :class_name => 'Bar' 
```

并且

```
has_one :discovered_by, :class_name => 'Bar' 
```

虽然在 Bar 文档中设置了 found_by id，并在我尝试执行以下操作时指向另一个 Bar 文档，但我得到 nil（假设第一个 Foo 的第一个 Bar 设置了 found_by_id）

```
Foo.first.bars.first.discovered_by 
```

尽管文档设置了 id，这将始终返回 nil。知道为什么会这样吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T16:49:04.957

You [cannot have references to embedded models](https://stackoverflow.com/questions/3890633/how-to-reference-an-embedded-document-in-mongoid) - even when they're both embedded in the same document. If you correctly configure the relationship

```
belongs_to :discovered_by, :class_name => 'Bar', inverse_of: :discovered
has_one :discovered, :class_name => 'Bar', inverse_of: :discovered_by 
```

Mongoid will raise a `Mongoid::Errors::MixedRelations` exception. Maybe you could reconsider if embedding these objects is still the best choice. A workaround is storing only the id and query the parent object:

```
class Bar
    include Mongoid::Document
    embedded_in :foo
    field :discovered_by_id, type: Moped::BSON::ObjectId

    def discovered_by
      foo.bars.find(discovered_by_id) if discovered_by_id
    end

    def discovered_by=(bar)
      self.discovered_by_id = bar.id
    end
end 
```

# algorithm - 检测网络流周期性的有效方法

> ID：15704062
> 
> 赞同：1
> 
> 时间：2013-03-29T13:18:12.537
> 
> 标签：algorithm, period

我有很多 netflow 数据`(i.e src_ip, dest_ip, beg_time, end_time, data_size, etc)`，其中一些是定期发生的，我想找出来。

考虑我有**n 个**netflow（可能在 10^6 左右），其中**m**个是**周期性**的。我怎样才能找到哪些是周期性的？

我可以写一个代码，但它至少会是 O(n^3 logn)，这在 10^4 个 netflow 之后将永远需要。

我已经搜索过它，但找不到任何东西。

注意：可以考虑数据是按照开始时间排序的，开始时间是32位无符号整数（c++中的uint32）

**更正**：`src_ip`是唯一的，`dest_ip`不是唯一的，`time for periodicity`是未知的。可能是 5 分钟，也可能是 5 天。您可以忘记`src_ip, dest_ip, end_time, data_size`流的其他属性。**我只是在寻找开始时间是周期性的事件，**你可以考虑，我已经排除了不相关的事件，比如不同的 src_ip，等等......

任何帮助将不胜感激，

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:29:48.047

我会尝试在与您的数据相对应的信号上计算 FFT。

例如，我会将块`beg_time`=1、`end_time`=5、`data_size`=100 转换为幅度为 100 的 1 到 5 个时间单位的方脉冲。

如果你想一起分析所有东西，你可以叠加你得到的所有脉冲。

如果将所有内容放在一起没有意义，则仅叠加来自相同`src_ip`或来自同一对的脉冲`src_ip`和`dst_ip`。

然后对通过叠加获得的信号进行 FFT，看看频域中是否有明显的峰值，或者看起来都是随机的，没有突出的峰值。

FFT 在 O(n*log(n)) 时间内运行，其中`n`是信号样本的数量。

我确信必须有更好的方法来做到这一点，但它可能值得一试。

# jquery - jquery表示类和id

> ID：15704065
> 
> 赞同：0
> 
> 时间：2013-03-29T13:18:24.907
> 
> 标签：jquery

在jquery中，有人在“”双引号中提到类名和ID，有人用单引号''表示......这两件事有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:20:23.413

在 JavaScript 中，双引号和单引号绝对没有区别。只是偏好问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:22:12.640

“提及班级名称和ID”是什么意思？

顺便说一句，一般来说单双看看这里：

[何时在 JavaScript 中使用双引号或单引号？](https://stackoverflow.com/questions/242813/when-to-use-double-or-single-quotes-in-javascript)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T13:26:48.590

在某些情况下，当您还想在字符串中使用双引号时，您可能需要使用单引号，例如：

```
<script>

    // Finds all inputs with a name attribute that contains the word 'man' and sets the value with some text.
    $('input[name~="man"]').val('mr. man is in it!');

</script> 
```

除此之外，它们之间没有任何区别。只是偏好问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T14:17:28.637

在 jquery 中有人使用类名，id 像这样 $('.someclass') $('#someclass') 或 $(".someclass") $("#someclass")。那么这两者之间的主要区别是什么

# datagrid - 没有分页的燃料 UX 数据网格

> ID：15704066
> 
> 赞同：1
> 
> 时间：2013-03-29T13:18:25.563
> 
> 标签：datagrid, fuelux

我正在尝试在 Rails 3.2 应用程序中使用 Fuel UX Datagrid。我的用例需要一个带有固定标题的网格（Fuel UX Datagrid 已经支持）以及没有分页的垂直和水平滚动。我找到了垂直滚动加分页的示例，但没有找到关闭分页的水平滚动示例。Fuel UX 支持这个吗？有人可以发布任何示例吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:39:34.450

对此没有现有选项，但应该可以通过配置数据源以返回所有记录并使用 CSS 隐藏分页控件来禁用分页。水平滚动可能更困难，但一般来说，JavaScript 尽量通用，以允许您自定义标记和 CSS。随意试验并向[https://github.com/ExactTarget/fuelux/issues报告任何自定义问题](https://github.com/ExactTarget/fuelux/issues)

# fbconnect - 登录成功后的javascript函数

> ID：15704080
> 
> 赞同：0
> 
> 时间：2013-03-29T13:19:14.743
> 
> 标签：fbconnect, django-authentication, django-allauth

我正在使用`django-allauth`，所以当我`"/accounts/facebook/login"`从主页调用时，会打开 FB 对话框，并且重定向 URL 只是主页。

现在，我想`Javascript`在用户成功登录后重定向到主页时运行一个函数。可悲的是我不知道该怎么做。功能是打开一个弹出窗口，但那是另一回事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:30:53.420

如果用户已登录，您可以将该条件发送到带有上下文的模板，如下所示..

```
context = {
'hede': 'hodo', etc..... 
'user_loged_in': True
} 
```

比，在你的模板

```
{% if user_loged_in %}
<script>alert('stuff');</script>
{% endif %} 
```

# javascript - jQuery Mobile：如何返回一页？

> ID：15704089
> 
> 赞同：0
> 
> 时间：2013-03-29T13:19:54.033
> 
> 标签：javascript, asp.net-mvc, jquery-mobile, asp.net-mvc-4

**背景**

我正在编写一个 MVC 4 / jQuery Mobile 网站。我有一个`Header.cshtml`这样定义的共享视图：

```
@model string

<div data-role="header" data-position="fixed">
    <a data-rel="back" href="javascript:history.back()">Go back</a>
    <h1>@Model</h1>
    @Html.ActionLink("Home", "Index", "Home", null, new
    {
        data_icon = "home",
        @class = "ui-btn-right jqm-home"
    })
</div> 
```

我这样称呼：

```
@Html.Partial("Header", "Registration") 
```

**问题**

以上在我的桌面浏览器中运行良好，但是当我使用 Mobilizer ( [http://www.springbox.com/about/tools/](http://www.springbox.com/about/tools/) ) 进行测试时，它似乎`history.back()`不适用于手机。所以然后我想..好吧，总是有不止一种方法可以完成工作..所以我尝试了这个：

```
<a data-rel="back" href="@Request.UrlReferrer">Go back</a> 
```

奇怪的是，这也不起作用，我不知道为什么。我猜这`UrlReferrer`是在浏览器中调用某些东西，而移动浏览器不支持它。不幸的是，我实际上无法测试该理论，因为 Mobilizer 似乎不允许我检查页面源。

无论如何，我需要一个解决方案..当然我可以停止使用这个通用共享视图并将其复制粘贴到任何地方，但不用说那会很糟糕......谁能告诉我如何解决这个问题，所以我可以重复使用我的标头代码吗？

**编辑**

起初我以为@DWolf 已经解决了这个问题。但现在我发现它没有。

我已经检查并确认 Mobilizer 不是问题所在。我通过测试不同的模拟器来做到这一点。本例中 ElectricPlum 的 iPhone 模拟器： [http ://www.hanselman.com/blog/SimulatingAnIPhoneOrIPadBrowserForASPNETMobileWebDevelopmentWithWebMatrix2OrVisualStudio2012.aspx](http://www.hanselman.com/blog/SimulatingAnIPhoneOrIPadBrowserForASPNETMobileWebDevelopmentWithWebMatrix2OrVisualStudio2012.aspx)

所以，`data-add-back-btn="true"`也行不通。虽然 jQuery Mobile 的后退按钮内置功能不起作用，但这似乎很奇怪……那是什么？！？！？帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:53:45.190

jquery mobile保持页面缓存，所以如果你从第1页翻到第2页，它会显示第2页，但它会在幕后继续到第1页

如果你添加

```
data-add-back-btn="true" 
```

到你的页面

```
<div data-role="page" id="page2" data-add-back-btn="true" > 
```

它将返回 1 页

# javascript - 如何显示一位小数（不四舍五入）并为整数显示 .0？

> ID：15704090
> 
> 赞同：0
> 
> 时间：2013-03-29T13:19:55.873
> 
> 标签：javascript, jquery

有没有一种很好的方法来显示一直显示小数点后一位但不四舍五入的十进制数字？所以你有以下数字：

```
3.55
3.5
3 
```

我想让他们展示

```
3.5
3.5
3.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:23:33.487

您也可以使用该`toFixed()`方法，但这会将浮点数转换为字符串。

```
var float = 3.55

float.toFixed(1); 
```

这将四舍五入，但在任何位置舍入小数点 0.5

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:21:50.490

改为使用`Math.floor`。

```
pad(Math.floor(num * 10) / 10); 
```

如果需要，在哪里`pad`添加。`.0`

请记住，这`Math.round`可能会更好。既然`3.55`应该`3.6`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:34:25.620

试试这个（其中 x 是你的浮点数）：

```
function format_float(float x )
 {
   if ((x).tostring().contains(".") ) 
   {return parseFloat((x).tostring().Substring(0,indexof(".")+1)) ;}
   else 
   {return x.toFixed(1);}
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T13:59:10.913

要消除对 pad 功能的需要：

```
function toOnePlace(n) {
  n = ('' + n).split('.');
  return n[0] + '.' + (n[1]? n[1].charAt(0) : 0);
} 
```

# java - 使用 TestExecutionListener 时 Spring 测试注入不起作用

> ID：15704091
> 
> 赞同：15
> 
> 时间：2013-03-29T13:19:57.483
> 
> 标签：java, spring, liquibase, spring-test

我想结合使用自定义`TestExecutionListener`在`SpringJUnit4ClassRunner`我的测试数据库上运行 Liquibase 模式设置。我的`TestExecutionListener`工作正常，但是当我在我的类上使用注释时，被测 DAO 的注入不再起作用，至少实例为空。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "file:src/main/webapp/WEB-INF/applicationContext-test.xml" })
@TestExecutionListeners({ LiquibaseTestExecutionListener.class })
@LiquibaseChangeSet(changeSetLocations={"liquibase/v001/createTables.xml"})
public class DeviceDAOTest {

    ...

    @Inject
    DeviceDAO deviceDAO;

    @Test
    public void findByCategory_categoryHasSubCategories_returnsAllDescendantsDevices() {
        List<Device> devices = deviceDAO.findByCategory(1); // deviceDAO null -> NPE
        ...
    }
} 
```

监听器相当简单：

```
public class LiquibaseTestExecutionListener extends AbstractTestExecutionListener {

    @Override
    public void beforeTestClass(TestContext testContext) throws Exception {
        final LiquibaseChangeSet annotation = AnnotationUtils.findAnnotation(testContext.getTestClass(),
                LiquibaseChangeSet.class);
        if (annotation != null) {
            executeChangesets(testContext, annotation.changeSetLocations());
        }
    }

    private void executeChangesets(TestContext testContext, String[] changeSetLocation) throws SQLException,
            LiquibaseException {
        for (String location : changeSetLocation) {
            DataSource datasource = testContext.getApplicationContext().getBean(DataSource.class);
            DatabaseConnection database = new JdbcConnection(datasource.getConnection());
            Liquibase liquibase = new Liquibase(location, new FileSystemResourceAccessor(), database);
            liquibase.update(null);
        }
    }

} 
```

日志中没有错误，只是`NullPointerException`在我的测试中。我看不到 my 的使用如何`TestExecutionListener`影响自动装配或注入。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-29T13:54:16.677

我查看了 spring DEBUG 日志，发现当我省略自己的 TestExecutionListener 时，spring 设置了一个 DependencyInjectionTestExecutionListener。使用 @TestExecutionListeners 注释测试时，侦听器会被覆盖。

所以我只是用我的自定义显式添加了 DependencyInjectionTestExecutionListener ，一切正常：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "file:src/main/webapp/WEB-INF/applicationContext-test.xml" })
@TestExecutionListeners(listeners = { LiquibaseTestExecutionListener.class,
    DependencyInjectionTestExecutionListener.class })
@LiquibaseChangeSet(changeSetLocations = { "liquibase/v001/createTables.xml" })
public class DeviceDAOTest {
    ... 
```

更新：行为记录[在这里](http://static.springsource.org/spring/docs/3.1.2.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#testcontext-fixture-di)。

> ... 或者，您可以通过使用 @TestExecutionListeners 显式配置您的类并从侦听器列表中省略 DependencyInjectionTestExecutionListener.class 来完全禁用依赖注入。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-01-08T23:13:36.423

我建议考虑只做类似的事情：

```
@TestExecutionListeners(
        mergeMode =TestExecutionListeners.MergeMode.MERGE_WITH_DEFAULTS,
        listeners = {MySuperfancyListener.class}
) 
```

这样您就不需要知道需要哪些侦听器。我推荐这种方法，因为 SpringBoot 尝试通过使用`DependencyInjectionTestExecutionListener.class`.

# java - 出于性能原因，替代 Spring 的 @Configurable？

> ID：15704094
> 
> 赞同：0
> 
> 时间：2013-03-29T13:20:00.510
> 
> 标签：java, spring, configurable, aspect

我在一段必须高性能的代码中将@Configurable bean 用于非托管spring 实例。我们在 new 运算符中使用了很多非托管 bean，在我们的分析中，我们注意到 @Configurable 注释的使用大大减慢了速度。

对于这个特定的部分，我们想要一种更快的从上下文中提取 bean 的方法（只是一个直接的 applicationContext.getBean()）。我知道我们放弃了 IoC 这样做，但这是一种特殊情况，而不是正常模式。

我们使用 CTW 进行编织，但我想知道 spring 在幕后使用什么机制来获取应用程序上下文，以便我们可以简单地抓取它并使用 getBean？静态应用程序上下文？它是否存储在 threadlocal 某处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:52:41.597

方面是由 AspectJ 管理的单例。当您将切面放入 Spring 配置文件时，Spring 实际上并没有创建切面。相反，它使用 获得对方面的引用`aspectOf()`。

这意味着（在您进行编织时的编译时）您的 @Configurable 注释被挂钩到单例`AnnotationBeanConfigurerAspect`中。然后，当您加载应用程序上下文时，Spring 获取对同一单例方面的引用并调用方面`setBeanFactory()`上的方法（因为它实现了`BeanFactoryAware`）。

这种*魔法*当然会带来麻烦。如果您有两个应用程序上下文，那么第二个将覆盖第一个的配置，这可能会非常混乱。

要直接回答您的问题，这意味着您所要做的就是创建一个实现的新方面`BeanFactoryAware`（这里是[AnnotationBeanConfigurerAspect](http://alvinalexander.com/java/jwarehouse/spring-framework-2.5.3/aspectj/src/org/springframework/beans/factory/aspectj/AnnotationBeanConfigurerAspect.aj.shtml)的代码，您可以将其用作示例），然后在您的 spring 配置文件和您的aspect 现在可以访问 bean 工厂。

如果您要追求性能，请注意，上面的内容并不比`BeanFactory`在启动应用程序时创建对 的静态引用并实例化它更干净，因此您最好使用静态引用，因为它更简单。

# opengl - 为什么上传到着色器时需要将四元数转换为 4x4 矩阵？

> ID：15704096
> 
> 赞同：5
> 
> 时间：2013-03-29T13:20:11.247
> 
> 标签：opengl, matrix, glsl, skeletal-mesh

我已经阅读了几篇关于 OpenGL 中骨骼动画的教程，它们似乎都一心一意地使用四元数进行旋转，使用 3d 矢量进行平移，而不是矩阵。

但是当他们进入顶点蒙皮过程时，他们将所有四元数和 3d 向量组合成一个 4x4 矩阵，然后上传矩阵以在着色器中进行其余的计算。4x4 矩阵有 16 个元素，而四元数 + 3d 向量只有 7 个。那么为什么我们要在上传之前将它们转换为 4x4 矩阵呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T13:30:39.057

因为只有两个 4×4 矩阵，每个骨骼一个顶点被分配和加权，你只需要做两个 4 向量 4×4 矩阵乘法和一个加权和。

与此相反，如果您作为单独的四元数和翻译提交，则必须执行两个 3 向量 3×3 矩阵乘法加上四个 3 向量 3 向量加法和加权和的等价。要么首先将四元数转换为旋转矩阵，然后再转换为 3 向量 3×3 矩阵乘法，或者直接进行 3 向量四元数乘法，计算量大致相同。之后，您必须使用模型视图矩阵进行后乘。

完全可以使用 4 元素向量 uniform 作为四元数，但是您必须在顶点着色器中链接大量计算：首先将顶点旋转两个四元数，然后对其进行平移*，*然后将其与模型视图矩阵相乘. 通过简单地上传两个在着色器中加权的变换矩阵，您可以在 GPU 上节省大量计算。在 CPU 上执行四元数矩阵乘法只对每个骨骼执行**一次**计算，而在着色器中执行它会针对每个单个顶点执行计算。如果您必须使用不同的输入日期进行大量相同的计算，那么 GPU 非常棒。但是，如果您只需要计算少数几个值，它们会被大量数据重用，那么它们就很糟糕了。然而，CPU 喜欢这种任务。

由 4×4 矩阵表示的齐次变换的好处是，单个矩阵可以包含整个变换链。如果将旋转和平移分开，则必须按顺序执行整个操作链。只有一次旋转和平移，它比单个 4×4 矩阵变换的操作少。添加一个转换，您就达到了收支平衡。

即使在应用于网格的骨架姿势中，变换矩阵也是**相同的**对于所有顶点。假设网格在一对骨骼周围有 100 个顶点（这是一个很小的数字，顺便说一句），那么您必须对每个顶点进行上述计算，浪费宝贵的 GPU 计算周期。为了什么？确定一些 32 个标量值（或 8 个 4 向量）。现在比较一下：100 个 4 向量（如果您只考虑顶点位置）与仅 8 个。这是在着色器中处理四元数姿势所施加的计算开销的数量级。在 CPU 上计算一次，然后将其分配给预先计算好的 GPU，以便在基元之间共享。如果你编码正确，单个矩阵列的整个计算将很好地适应 CPU 管道，使得它的性能大大优于每次并行化它的尝试。并行化不是免费的！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-29T13:26:22.327

在现代 GPU 中，上传到常量缓冲区的数据格式没有限制。

当然，您需要以不同的方式编写顶点着色器，以便使用四元数而不是矩阵进行蒙皮。事实上，我们[在引擎](http://www.crytek.com/download/izfrey_siggraph2011.pdf)中使用了双四元数蒙皮。

请注意，旧的固定功能硬件蒙皮确实只适用于矩阵，但那是很久以前的事了。

# login - 通过 Google Plus API 登录

> ID：15704108
> 
> 赞同：1
> 
> 时间：2013-03-29T13:21:03.617
> 
> 标签：login, google-plus, access-token

我正在尝试在我的用户注册我的网站时收集他的数据。

我在提出请求时要求以下范围

```
<span id="signinButton">
  <span
    class="g-signin"
    data-callback="signinCallback"
    data-clientid="1085488274737.apps.googleusercontent.com"
    data-cookiepolicy="single_host_origin"
    data-requestvisibleactions="http://schemas.google.com/AddActivity"
    data-scope="https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/plus.login">
  </span>
</span> 
```

然后我首先尝试通过`https://www.googleapis.com/oauth2/v1/userinfo?access_token=`使用上一步中获得的访问令牌发出 GET 请求来获取用户的电子邮件 ID 和 google plus ID。这工作得很好。它给了我用户的 ID 和电子邮件。

但是，如果我使用获得的 ID 和访问令牌来获取更多的个人资料详细信息和他圈子中的朋友，则它不起作用。

```
https://www.googleapis.com/plus/v1/people/userID/?key= 
```

它说无效密钥无效。

因此，我完全一无所知。提到数据范围有什么错误吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T13:54:16.537

在进行`/plus/v1/people/{userID}`调用时，您可以指定`key`或`access_token`，并使用相应的参数。如果您指定密钥，这应该是在 API 控制台中分配给您的应用程序密钥。如果您使用 access_token，则可以使用您在登录按钮过程中收到的访问令牌。

既然你有它，似乎最好使用这样的 access_token ：

> [https://www.googleapis.com/plus/v1/people/me?access_token=11111111111111111111111](https://www.googleapis.com/plus/v1/people/me?access_token=11111111111111111111111)

# php - 如何获取任何给定browsenodeid的所有亚马逊产品

> ID：15704111
> 
> 赞同：1
> 
> 时间：2013-03-29T13:21:17.753
> 
> 标签：php, amazon-web-services, amazon

我想获得任何指定browsenodeid的最大产品数量。我正在尝试通过循环执行操作并将 ItemPage 增加 1。这是我的代码：

```
for($i = 1; $i <= 10; $i++):
    $sin = array(
      "Operation"     => "ItemSearch",
      "SearchIndex"   => $cat_name,
      "BrowseNode"    => $browse_node_id,
      "ItemPage"      => $i,
      "Condition"     => "All",
      "ResponseGroup" => "Medium, Reviews, OfferFull",
      "MerchantId"    => "Amazon"       
    );
 endfor; 
```

但是，如果我在 while 循环中运行它直到 11，它不会返回任何超过 10 页的结果。但在亚马逊上，它显示了 400 页的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T09:12:10.943

API 不会为任何搜索返回超过 10 个结果页面。获得更多结果的一种方法是设置 MinimumPrice 和 MaximumPrice 以便获得 10 或更少的页面，然后调整范围并重复。

# http - 如果标记为公开，是否应设置 Cache-Control max-age？

> ID：15704116
> 
> 赞同：0
> 
> 时间：2013-03-29T13:21:26.897
> 
> 标签：http, caching, http-headers, browser-cache, cache-control

我试图找出适合我的网站的最佳缓存标头，但找不到关于同时设置`max-age`和`public`.

在我的情况下，我有一些文件我不担心它们会过期，如果我要设置 max-age 它可能是一个月或一年。但我的问题是，是否应该`max-age`省略，只指定`Cache-Control: public`？这不是说“尽可能长时间缓存”吗？

**TL;DR**`max-age`设置if是否有任何优点/缺点，`public`并且对象具有无限期的到期时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:28:02.903

`Cache-Control: public`意味着资源是公开可用的，因此可能会被放入缓存中，可供多个用户使用（例如公司 Internet 代理）。它与资源可以缓存多长时间无关。请参阅[RFC2616](https://www.rfc-editor.org/rfc/rfc2616#section-14.9.1)。

# javascript - 如何在 d3 方法链中有效地将数据从字符串转换为 int？

> ID：15704128
> 
> 赞同：3
> 
> 时间：2013-03-29T13:21:57.683
> 
> 标签：javascript, d3.js

我正在 d3 中制作交互式条形图，但遇到了问题。条形图从表单中读取数据，但它以字符串的形式读取数据。当我使用数据绘制这样的条时：

```
var bars = svg.selectAll("rect")
    .data(dataset)
    .enter()
    .append("rect")
    .attr("x", function(d,i) {
        return i * (w / dataset.length);
    })
    .attr("y", function(d) {
        return h - (d * 4);
    })
    .attr("width", w / dataset.length - barPadding)
    .attr("height", function(d) {
        return d * 4;
    })
    .attr("fill", function(d) {
        return "rgb(" + (d * redLevel) + ", 0, " + (d * blueLevel) + ")";
    }); 
```

数据作为字符串读取。`parseInt(d)`每次我想使用的时候我都可以使用，`d`但这会非常低效。在方法链之外很容易做到`var d = parseInt(d)`，但这不适用于 d3。建议？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-29T13:24:32.240

您可以在绑定数据之前映射数据：

```
.data(dataset.map(function(d) { return +d; })) 
```

然后一元运算`+`符将数字字符串转换为数字。

# emacs - 绝对纯粹的emacs初始化

> ID：15704129
> 
> 赞同：1
> 
> 时间：2013-03-29T13:22:05.127
> 
> 标签：emacs

我想在没有安装任何插件的情况下运行 emacs。Emacs 手册说您可以使用`-q`选项来跳过初始化文件。我已经尝试`emacs -q`并发现来自 /usr/share/emacs/site-lisp 的插件（ubuntu 在此处安装插件）仍然被加载。

我在 google 上搜索了 emacs 的初始化例程，但没有发现任何有用的信息。我很好奇 emacs 在初始化时逐步执行的操作，以及哪些变量、选项、环境等可能会改变默认行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T13:40:45.803

尝试`emacs -Q`

从手册页：

> **-Q, --quick**
> 类似于“-q --no-site-file --no-splash”。此外，避免处理 X 资源。

* * *

如果您只想避免加载站点 lisp 代码，则可能需要运行

`emacs -q --no-site-file`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T13:44:12.520

Emacs == 自文档化。

`C-h``i``g` `(emacs) Emacs Invocation` `RET`

如果您真的想了解详细信息，可以使用 startup.el 仔细阅读

`M-x` `find-library` `RET` `startup` `RET`

# c# - 在导体中激活的新项目不显示它

> ID：15704130
> 
> 赞同：1
> 
> 时间：2013-03-29T13:22:06.593
> 
> 标签：c#, caliburn.micro, contentcontrol

我正在使用 Caliburn.Micro.Contrib 的[ConductResult](https://github.com/kmees/CMContrib/blob/master/src/CMContrib.SL/Results/ConductResult.cs "进行 IResult，激活导体中的项目")激活导体中的新项目。导体是 类型`Conductor<IScreen>.Collection.OneActive`，并且已经有一个项目显示并正常工作。

但是，新项目在激活后不会显示。我已经检查过了，指挥的**ActiveItem**设置为那个新项目，新项目**也被激活**了。View的新项目的**IsVisible**也设置为true，所以我不明白为什么它不可见。

指挥者视图的 XAML 非常简单：

```
<UserControl x:Class="..."
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:cal="http://www.caliburnproject.org"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="{Binding Path=ActiveItem, Converter={StaticResource objectTypeConverter}}" Margin="5" />
        <ItemsControl Grid.Row="1" ItemsSource="{Binding Items}" BorderBrush="Aqua" BorderThickness="10 ">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel>
                        <TextBlock Text="{Binding Converter={StaticResource objectTypeConverter},ConverterParameter=something}" Margin="5" />
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        <ContentControl Grid.Row="2" x:Name="ActiveItem" />
    </Grid>
</UserControl> 
```

（TextBlock 和 ItemsControl 用于调试目的；它们证明新项目是在导体内进行的（即 Items 集合包含它）并且新项目设置为 ActiveItem）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-22T07:57:46.517

就我而言，我`IoC.Get<IShell>`用来访问父视图模型。

默认引导程序说`container.PerRequest<IShell, ShellViewModel>();` 这就是为什么我得到了我的`ShellViewModel`类的另一个实例，很好地激活了该项目，但没有更新 UI。

一种解决方法是替换`container.PerRequest`为`container.Singleton`. 另一种是`IoC.Get<IShell>()`改成`( (IShell)Parent )`

# php - 开发环境

> ID：15704131
> 
> 赞同：0
> 
> 时间：2013-03-29T13:22:07.117
> 
> 标签：php, html, installation, dreamweaver, development-environment

我有点问题，我想不通。我在办公室设置了一个本地开发服务器和另一个在线专用服务器，以测试我的网络应用程序。只要我在办公室工作并使用 LAN/WLAN，这一切都很好。

但有时我想在家里做一些快速的代码更改。这就是我的问题开始的地方。我尝试了几种可能性。FTP、VPN、WebDAV……它确实有效，但速度非常慢。我需要 5 分钟来尝试一两行代码。

您的开发环境是如何设置的，我应该使用什么选项来使“连接”变得更快？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:27:04.637

尝试通过远程文件系统访问进行开发非常缓慢。几个选项：

*   使用远程桌面 (RDP) 连接到您的机器并进行本地开发。
*   您始终可以使用 skydrive / google drive / dropbox 路线将您的开发文件同步到您的家用计算机，这样您就可以在两者上都有本地副本。
*   不要忽视源代码控制（尽管这样您只能对签入的内容进行更新，因此如果您在没有签入的情况下离开办公室，您将无法在家中做任何事情）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:31:01.703

通常，像这样的极端减速是由于您使用的 IDE 造成的。它想为您读取和解析“项目”中的所有内容，并且通过慢速连接（ftp、sftp、ssh 等）来执行此操作。

如果您使用的是 dreamweaver，请查看此[知识库文章](http://helpx.adobe.com/dreamweaver/kb/hang-opening-document-dreamweaver-cs5.html)和此[Google 搜索](https://www.google.com/webhp?sourceid=chrome-instant&ion=1&ie=UTF-8#hl=en&sclient=psy-ab&q=dreamweaver%20slow%20ftp&oq=&gs_l=&pbx=1&fp=bfd4e169a20676d6&ion=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.44442042,d.dmQ&biw=1615&bih=823)。

最终，您将受到一些性能影响，但您应该能够配置您的 IDE 以将其最小化。您也可以随时退回使用 FileZilla 或 WinSCP 之类的东西以及您最喜欢的编辑器……也许是[带有远程访问的 Sublime Text](http://wbond.net/sublime_packages/sftp)。

# javascript - 日期和时间范围选择器

> ID：15704140
> 
> 赞同：3
> 
> 时间：2013-03-29T13:22:22.630
> 
> 标签：javascript, jquery, html

谁能推荐我一个美好的一天（只有名字 - 例如：星期一）和时间范围选择器..

我已经尝试过[http://pttimeselect.sourceforge.net/example/index.html](http://pttimeselect.sourceforge.net/example/index.html)和[http://haineault.com/media/jquery/ui-timepickr/page/](http://haineault.com/media/jquery/ui-timepickr/page/) 但他们没有日期选择..

有人知道另一个吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:25:54.677

我真的很喜欢这个： http: [//ghusse.github.com/jQRangeSlider/](http://ghusse.github.com/jQRangeSlider/)

它是高度可定制的。支持日期、整数，并且有很多选项可以满足您的特殊需求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-30T17:15:02.510

[我认真地花了几个小时为我们的网站ParkMe.com](http://parkme.com)寻找类似的东西。似乎有人会在所有实现中创建一个。

当我找不到任何东西时，我花了整个周末写自己的东西。这就是我想出的。

[http://keithhackbarth.github.io/jquery-datetime-picker/](http://keithhackbarth.github.io/jquery-datetime-picker/)

[https://github.com/keithhackbarth/jquery-datetime-picker](https://github.com/keithhackbarth/jquery-datetime-picker)

不尝试自我插入..只是想我想出了一个半体面的解决方案。

# android - android中的慢速互联网连接问题

> ID：15704141
> 
> 赞同：5
> 
> 时间：2013-03-29T13:22:27.713
> 
> 标签：android, connection

我正在 Android 中创建一个应用程序来检查 Internet 连接。当 Internet 连接速度很慢时，我想显示一条 toast 消息。或者当服务器没有响应请求时。在这种情况下，我想举杯祝酒，例如*Connection is slow !!!* . 在我的代码中，我找到了互联网是否连接，但不知道如何吐司互联网缓慢的消息......

```
public boolean isConnectingToInternet(){
    ConnectivityManager connectivity = (ConnectivityManager) _context.getSystemService(Context.CONNECTIVITY_SERVICE);
      if (connectivity != null) 
      {
          NetworkInfo[] info = connectivity.getAllNetworkInfo();
          if (info != null) 
              for (int i = 0; i < info.length; i++) 
                  if (info[i].getState() == NetworkInfo.State.CONNECTED)
                  {
                      return true;
                  }

      }
      return false;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T13:30:41.010

*   对于 WiFi 链接速度检查[WifiInfo.getLinkSpeed()](http://developer.android.com/reference/android/net/wifi/WifiInfo.html#getLinkSpeed%28%29)
*   对于移动数据链路，您只能检查[TelefonyManager.getNetworkType()](http://developer.android.com/reference/android/telephony/TelephonyManager.html#getNetworkType%28%29)以确定当前的移动数据链路类型。然后，您应该按链接类型接近实际速度（即，对于高达 128 kbps 的 GPRS，对于高达 236.8 kpbs 的 EDGE，对于高达 2 Mbps 的 3G，对于高达 7.2 Mbps 的 HDSPA）。考虑到这只是一个近似值。您可以使用 HDSPA 进行连接，但您的运营商将最高速度限制为 2 Mbps。

现在，您必须获得速度并设置条件是否低于 100kbps，“低互联网连接”

# selinux - 在不禁用 selinux 的情况下将文件从 windows 服务器下载到 linux 服务器

> ID：15704142
> 
> 赞同：1
> 
> 时间：2013-03-29T13:22:32.190
> 
> 标签：selinux

我正在 Linux 服务器上用 PHP 开发一个站点，我需要将文件从 Windows 服务器下载到 Linux 机器。我可以通过 SeLinux 中的一些更改或设置它的一些属性（setsebool -P httpd_disable_trans=1）来做到这一点。但是我们的客户拒绝为此功能妥协任何安全性因此需要找到任何其他解决方法。任何人都可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T08:31:59.207

看起来 PHP/apache 无法访问 samba 端口或网络。请参阅链接[http://wiki.centos.org/TipsAndTricks/SelinuxBooleans](http://wiki.centos.org/TipsAndTricks/SelinuxBooleans)。

尝试运行“sealert”以获取更多信息并提示要修复的内容。

'sealert' 是一个非常聪明的工具，可以从日志中分析 SELinux 拒绝，并提供许多解决方法。它捆绑在 Fedora 和其他一些发行版中。即使它需要 X 服务器，使用 X 协议转发连接您的服务器也足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T17:44:55.460

SELinux 提供了广泛的选项来提供对指定进程/功能/用户等的访问。这是从 RedHat 支持页面中引用的 HTTP 服务器：

> 启用 SELinux 后，Apache HTTP Server (httpd) 默认运行受限。受限进程在它们自己的域中运行，并与其他受限进程分开。如果受限进程被攻击者破坏，根据 SELinux 策略配置，攻击者对资源的访问以及他们可能造成的损害是有限的。

除了其他答案提到的，即打开端口并使它们能够绕过 SELinux 协议（这可能是一个明显的安全问题，取决于目录访问的上下文/范围）之外，还有 SELinux 上下文*类型*，您可以分配/更改到特定目录以允许服务器仅访问该目录，而不是其他任何内容。

要允许`httpd`服务写入目录，您需要将其 SELinux 上下文标签从默认值更改`httpd_sys_content_t`为`httpd_sys_content_rw_t`。要对目录进行临时更改，请执行

```
chcon -R -t httpd_sys_content_rw_t /your_directory/ 
```

此更改将在重新启动后恢复为默认值，或者通过执行

```
restorecon -R -v /your_directory/ 
```

要永久更改指定目录，请执行以下操作：

```
# semanage fcontext -a -t httpd_sys_content_rw_t "/your_directory(/.*)?"
# restorecon -R -v /your_directory/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-15T16:54:55.610

这一切都取决于您连接到 Windows 服务器的方式。

如果这是通过http，那么似乎没有特定的布尔值。如果这是通过 ftp 完成的，则有 httpd_can_connect_ftp 允许 apache 连接到 ftp。如果这是通过 cifs 上的挂载来完成的，那么您可以查看 httpd_use_cifs。

从 /var/log/audit/audit.log 获取准确的 AVC 将极大地帮助找出可能出错的地方。

# php - PHP DOMDocument 未正确呈现 Unicode 字符

> ID：15704144
> 
> 赞同：9
> 
> 时间：2013-03-29T13:22:43.177
> 
> 标签：php, unicode, domdocument

我正在使用 CKEditor 让用户发表评论，用户也可以将 unicode 字符放在评论框中。

当我提交表单并检查 $_POST["reply"] 时，unicode 字符显示得非常好。我也在`header('Content-type:text/html; charset=utf-8');`页面顶部使用过，但是当我使用 PHP DOMDocument 处理它时，所有字符都变得不可读。

```
$html_unicode = "xyz unicode data";
$html_data = '<body>'.$html_unicode . '</body>';
$dom = new DOMDocument();
$dom->loadHTML($html_data );

$elements = $dom->getElementsByTagName('body'); 
```

当我回响

```
echo $dom->textContent; 
```

输出变为

```
§Ø³ÙØ¨ÙÙ ÙÙÚº ØºØ±ÙØ¨ Ú©Ù Ø¢ÙÛ ÙÛÙ 
```

如何使用 PHP DOMDocument 取回正确的 unicode 字符。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-01-23T01:12:15.087

这对我有用：

```
$html_unicode = "xyz unicode data";
$html_data = '<body>'.$html_unicode . '</body>';

$dom = new DOMDocument();
$html_data  = mb_convert_encoding($html_data , 'HTML-ENTITIES', 'UTF-8'); // require mb_string
$dom->loadHTML($html_data);

$elements = $dom->getElementsByTagName('body'); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-29T13:39:00.750

试试这个 ：）

```
<?php
    $html_unicode = "xyz unicode data";
    $html_data = '<body>'.$html_unicode . '</body>';
    $dom = new DOMDocument();
    $dom->loadHTML($html_data );

    $elements = $dom->getElementsByTagName('body');
    echo utf8_decode($dom->textContent);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T13:39:25.550

感谢上帝，我通过更换得到了解决方案

```
$html_data = '<body>'.$html_unicode . '</body>'; 
```

和

```
$html_data = '<head><meta http-equiv="Content-Type" 
content="text/html; charset=utf-8">
</head><body>' . $html_unicode . '</body>'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-22T10:36:08.567

这适用于阿拉伯语

```
<?php
echo "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=Windows-1256\"></head><body>";
$html = file_get_contents("    url    ");
$dom = new DOMDocument();
@$dom->loadHTML($html);
$ExTEXT = $dom->getElementById('tag id');
echo utf8_decode($ExTEXT->textContent);
echo "</body></html>"; 
```

# c# - 在 C# 中添加委托

> ID：15704148
> 
> 赞同：5
> 
> 时间：2013-03-29T13:23:03.877
> 
> 标签：c#, f#, delegates

如何在不使用 += 表示法的情况下向委托添加新功能？

我想知道如何从另一种 CLR 语言（即 F#）中执行他的操作。（我知道在 F# 中有更好的方法来处理事件，但我很好奇..）

```
static int Square (int x) { return x * x; }
static int Cube(int x) { return x * x * x; }
delegate int Transformer (int x);

Transformer d = Square ;
d += Cube; 
```

**编辑**

正如丹尼尔在评论中所指出的那样，没有直接的方法可以做到这一点的事实可能是 dotnet 团队的设计决定，即不要过多地改变队列。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T14:02:25.990

这是在 F# 中执行此操作的一种方法。由于使用[Delegate.Combine](http://msdn.microsoft.com/en-us/library/30cyx32c.aspx) ，您需要向下转换：

```
let square x = x * x
let cube x = x * x * x

type Transformer = delegate of int -> int

let inline (++) (a: 'T) (b: 'T) = 
    System.Delegate.Combine(a, b) :?> 'T

let d = Transformer(square)
let e = d ++ Transformer(cube) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T13:59:23.250

代表。合并？

```
d = (Transformer) Delegate.Combine(d, new Transformer(Cube)); 
```

# android - 如何从代码中应用按钮样式？

> ID：15704151
> 
> 赞同：0
> 
> 时间：2013-03-29T13:23:13.547
> 
> 标签：android

我在以下位置定义了自定义按钮样式`styles.xml`：

```
<style name="buttonBlack">
    <item name="android:background">@drawable/selector_button_black_bg</item>
    <item name="android:textColor">@android:color/white</item>
</style> 
```

当我通过布局xml设置它时，它工作正常：

```
<Button style="@style/buttonBlack" ... /> 
```

当我通过代码设置它时，它不起作用（我得到空按钮，没有背景）：

```
Button button = new Button(this, null, R.style.buttonBlack); 
```

我在这里做错了什么？

这是选择器：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" android:drawable="@drawable/button_black_pressed" />
    <item android:state_focused="true" android:drawable="@drawable/button_black_focused" />
    <item android:drawable="@drawable/button_black_normal" />
</selector> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-04T12:15:29.890

你应该使用`ContextThemeWrapper`

```
Button button = new Button(new ContextThemeWrapper(context, R.style.buttonBlack)); 
```

# java - Android 应用和 PHP Web 服务安全

> ID：15704157
> 
> 赞同：1
> 
> 时间：2013-03-29T13:23:45.307
> 
> 标签：java, php, android, web-services

我正在构建一个使用 PHP Web 服务的 android 应用程序（我也在构建它）。

我的问题是，如何防止未经授权的用户使用我的网络服务？例如，有人可以获取我的网络服务的地址并在我的应用程序之外使用它（例如，将发布变量发送到我的服务）吗？

另一个相关问题是如何防止我的网络服务上的垃圾邮件请求？会不会是记录 IP 地址并限制呼叫量的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:41:14.683

PHP 可以通过 POST 或 GET 从您的站点甚至 Internet 浏览器接收数据。用于执行此操作的方法之一是[curl](http://curl.haxx.se/)。

你指的这个问题被称为[Cross-site request forgery](http://en.wikipedia.org/wiki/Cross-site_request_forgery)。

如果可以的话，你应该在你的应用程序中实现[HTTPS](http://httpd.apache.org/docs/2.2/ssl/)的使用，这可以解决许多安全问题。

**如果您不能使用 HTTPS**（无论是昂贵的还是任何其他问题）：

你必须在你的 PHP 中验证通过 POST 或 GET 接收到的信息，这种语言有很大的能力解决这些“问题”；看看PHP 官方[文档的这一](http://php.net/manual/en/)[部分](http://php.net/manual/en/reserved.variables.server.php)。

假设您正在构建一个登录系统：您也可以在登录页面中添加一个隐藏元素，其中包含只能发生一次的唯一密码，将此密码保存在会话中，因此，登录脚本会在会话中查找此代码，与发布到脚本的内容进行比较，应该继续进行。

而且，如果您想获取访问者的 IP 地址：

```
function getRealIpAddr()
{
    if (!empty($_SERVER['HTTP_CLIENT_IP']))   //check ip from share internet
    {
      $ip=$_SERVER['HTTP_CLIENT_IP'];
    }
    elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))   //to check ip is pass from proxy
    {
      $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
    }
    else
    {
      $ip=$_SERVER['REMOTE_ADDR'];
    }
    return $ip;
} 
```

最后，阅读[本文](https://stackoverflow.com/questions/2242210/allow-get-request-but-only-in-my-domain)。

**编辑**

如果您无法支付 HTTPS 证书，（正如[Halim Qarroum](https://stackoverflow.com/users/1175633/halim-qarroum)所说），您可以使用：

> [自签名 SSL 证书](http://en.wikipedia.org/wiki/Self-signed_certificate)，免费。当然这有它的优点和缺点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:39:00.960

您可以在 Android 设备和您的 Web 服务 API 端点之间使用`HTTPS`连接。

限制您的网络服务，使其仅接受`HTTPS`连接。您可以使用 Apache（可能使用[SSLRequireSSL 指令](http://www.apache-ssl.org/docs.html#SSLRequireSSL)）或直接在 PHP 连接处理程序中轻松完成此操作。

使用`HTTPS`传输流时，您可以在对 Web 服务进行 API 调用时传递特定参数，以确保请求已从您的应用程序发送。没有人能够知道传输了哪些特定数据，也无法重现与您的远程服务的*可接受*连接。

关于您的第二个问题，您确实可以限制给定时间内的请求数量。在 PHP 中或通过使用特定工具（例如[fail2ban](http://www.fail2ban.org/wiki/index.php/Main_Page)）。

# ios - 仅从 UIView 的 3 个侧面绘制阴影

> ID：15704163
> 
> 赞同：24
> 
> 时间：2013-03-29T13:24:06.123
> 
> 标签：ios, objective-c, cocoa-touch, uiview, uikit

我已经成功地在我周围画了一个阴影，`UIView`如下所示：

```
block1.layer.masksToBounds = NO;
block1.layer.shadowOffset = CGSizeMake(0, 0);
block1.layer.shadowRadius = 1;
block1.layer.shadowOpacity = 0.7; 
```

现在发生的是我有一个矩形`UIView`，我想在它的三个边上画阴影，让它的底部**没有***阴影*。

我知道我必须`block1.layer.shadowPath`通过创建一个新的来指定，`UIBezierPath`但我不知道该怎么做。

显然，设置`layer.shadowOffset`不会对我有用。

提前致谢！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-29T14:01:48.653

我知道你说设置`layer.shadowOffset`对你不起作用，但你可以输入负值，所以设置它`layer.shadowOffset = CGSizeMake(0.0, -2.0)`会接近你正在寻找的效果，但我当然希望你希望它在三个方面均匀.

所以我们一起去吧`layer.shadowPath`！

```
UIView *block1 = [[UIView alloc] initWithFrame:CGRectMake(32.0, 32.0, 128.0, 128.0)];
[block1 setBackgroundColor:[UIColor orangeColor]];
[self.view addSubview:block1];

block1.layer.masksToBounds = NO;
block1.layer.shadowOffset = CGSizeMake(0, 0);
block1.layer.shadowRadius = 1;
block1.layer.shadowOpacity = 0.7;

UIBezierPath *path = [UIBezierPath bezierPath];

// Start at the Top Left Corner
[path moveToPoint:CGPointMake(0.0, 0.0)];

// Move to the Top Right Corner
[path addLineToPoint:CGPointMake(CGRectGetWidth(block1.frame), 0.0)];

// Move to the Bottom Right Corner
[path addLineToPoint:CGPointMake(CGRectGetWidth(block1.frame), CGRectGetHeight(block1.frame))];

// This is the extra point in the middle :) Its the secret sauce.
[path addLineToPoint:CGPointMake(CGRectGetWidth(block1.frame) / 2.0, CGRectGetHeight(block1.frame) / 2.0)];

// Move to the Bottom Left Corner
[path addLineToPoint:CGPointMake(0.0, CGRectGetHeight(block1.frame))];

// Move to the Close the Path
[path closePath];

block1.layer.shadowPath = path.CGPath; 
```

为了让您了解发生了什么，这是您刚刚绘制的实际阴影路径:)

![在此处输入图像描述](../Images/c9bed8e2ced5ff9f55b25a76b99e0590.png)

可以只在其他行之前或之后移动那个额外的中间点，以选择将省略哪一侧。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-10-30T07:58:14.880

感谢[Ashok R](https://stackoverflow.com/users/3647770/ashok-r)的快速代码，对其他答案有所改进。

由于我们在视图的背景中创建了一个三角形视图，所有边都带有阴影，因此不需要边上的白色三角形阴影。

如果视图的宽度相对大于高度，它会中断。

[![带有三角形阴影的图像](../Images/97d6a63de59aa9a8cdea55a20e43d39c.png)](https://i.stack.imgur.com/zjHwm.png)

一种解决方法是将不需要阴影的线的路径稍微移向视图的那一侧，**而不是完全创建三角形视图路径**。

我为此创建了一个扩展 -

```
extension UIView {
    func addshadow(top: Bool,
                   left: Bool,
                   bottom: Bool,
                   right: Bool,
                   shadowRadius: CGFloat = 2.0) {

        self.layer.masksToBounds = false
        self.layer.shadowOffset = CGSize(width: 0.0, height: 0.0)
        self.layer.shadowRadius = shadowRadius
        self.layer.shadowOpacity = 1.0

        let path = UIBezierPath()
        var x: CGFloat = 0
        var y: CGFloat = 0
        var viewWidth = self.frame.width
        var viewHeight = self.frame.height

        // here x, y, viewWidth, and viewHeight can be changed in
        // order to play around with the shadow paths.
        if (!top) {
            y+=(shadowRadius+1)
        }
        if (!bottom) {
            viewHeight-=(shadowRadius+1)
        }
        if (!left) {
            x+=(shadowRadius+1)
        }
        if (!right) {
            viewWidth-=(shadowRadius+1)
        }
        // selecting top most point
        path.move(to: CGPoint(x: x, y: y))
        // Move to the Bottom Left Corner, this will cover left edges
        /*
         |☐
         */
        path.addLine(to: CGPoint(x: x, y: viewHeight))
        // Move to the Bottom Right Corner, this will cover bottom edge
        /*
         ☐
         -
         */
        path.addLine(to: CGPoint(x: viewWidth, y: viewHeight))
        // Move to the Top Right Corner, this will cover right edge
        /*
         ☐|
         */
        path.addLine(to: CGPoint(x: viewWidth, y: y))
        // Move back to the initial point, this will cover the top edge
        /*
         _
         ☐
         */        
        path.close()
        self.layer.shadowPath = path.cgPath
    } 
```

并为您希望阴影出现的任何一侧设置布尔值 true

`myView.addshadow(top: false, left: true, bottom: true, right: true, shadowRadius: 2.0)`

> // 阴影半径在上面是可选的，默认设置为 2.0

[![在此处输入图像描述](../Images/867aa83b06ffb6d220e88c8f41778d95.png)](https://i.stack.imgur.com/R0crX.png)

或者 `myView.addshadow(top: true, left: true, bottom: true, right: true, shadowRadius: 2.0)`

[![在此处输入图像描述](../Images/6401de0bacb852afe52e40c4bf3ee681.png)](https://i.stack.imgur.com/5Uzza.png)

或者 `myView.addshadow(top: false, left: false, bottom: true, right: true, shadowRadius: 2.0)`

[![在此处输入图像描述](../Images/b54f61948739f2b732399ca1b9d1fa71.png)](https://i.stack.imgur.com/fSx0x.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-10-13T03:32:20.523

更新***Ryan Poolos***对 Swift 3.0 的回答

感谢***瑞安·普洛斯***

```
class sampleViewController: UIViewController {
    var block1: UIView! = nil

    override func viewDidLoad() {

        super.viewDidLoad()
        block1 = UIView(frame: CGRect(x: 32.0, y: 32.0, width: 128.0, height: 128.0))
        block1.backgroundColor = UIColor.orange
        self.view.addSubview(block1)

        block1.layer.masksToBounds = false
        block1.layer.shadowOffset = CGSize(width: 0.0, height: 0.0)
        block1.layer.shadowRadius = 1.0
        block1.layer.shadowOpacity = 0.7

        let path = UIBezierPath()

        // Start at the Top Left Corner
        path.move(to: CGPoint(x: 0.0, y: 0.0))

        // Move to the Top Right Corner
        path.addLine(to: CGPoint(x: block1.frame.size.width, y: 0.0))

        // Move to the Bottom Right Corner
        path.addLine(to: CGPoint(x: block1.frame.size.width, y: block1.frame.size.height))

        // This is the extra point in the middle :) Its the secret sauce.
        path.addLine(to: CGPoint(x: block1.frame.size.width/2.0, y: block1.frame.size.height/2.0))

        // Move to the Bottom Left Corner
        path.addLine(to: CGPoint(x: 0.0, y: block1.frame.size.height))

        path.close()

        block1.layer.shadowPath = path.cgPath
    }
} 
```

***结果：***

[![图片](../Images/23cdc4da426c1b4a5b077d9d22891622.png)](https://i.stack.imgur.com/5jE9b.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-07-04T11:19:04.860

试试这个

```
extension CALayer {
func applySketchShadow(color: UIColor, alpha: CGFloat, x: CGFloat, y: CGFloat, blur: CGFloat, spread: CGFloat)
{
    shadowColor = color.cgColor
    shadowOpacity = alpha
    shadowOffset = CGSize(width: x, height: y)
    shadowRadius = blur / 2.0
    if spread == 0 {
        shadowPath = nil
    } else {
        let dx = -spread
        let rect = bounds.insetBy(dx: dx, dy: dx)
        shadowPath = UIBezierPath(rect: rect).cgPath
    }
} 
```

# xml - 允许用户在 Java EE/Wicket 上下载生成的 XML

> ID：15704164
> 
> 赞同：0
> 
> 时间：2013-03-29T13:24:10.050
> 
> 标签：xml, jakarta-ee, dynamic, download, wicket

我的应用程序（带有 Java EE 的 Wicket 框架）具有类似向导的样式并生成一个 xml 文件。我想为用户提供一个可以下载文件的按钮。我怎样才能提供这样的功能，最好不要将文件保存在服务器上？

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:11:39.103

我只是使用 org.apache.wicket.markup.html.link.DownloadLink

HTML：

`<input wicket:id="export" type="button">`

爪哇：

```
File file = new File(appHome + "/template.xlsx");
add(new DownloadLink("export", file, "template.xlsx"));` 
```

我将文件存储在服务器上，但这里有另一个问题，其中包含有关如何动态生成文件的更多信息： [如何使用 Wicket 的 DownloadLink 和动态生成的文件？](https://stackoverflow.com/questions/7646270/how-to-use-wickets-downloadlink-with-a-file-generated-on-the-fly)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T15:35:34.100

这个例子是一个很好的起点：[AJAX 更新和文件下载一气呵成](https://cwiki.apache.org/WICKET/ajax-update-and-file-download-in-one-blow.html)。

然后，您唯一需要做的就是为您生成的 XML 实现 IResourceStream。

```
public class YourXmlDownload implements Serializable, IResourceStream {

    protected byte[] xmlContent = null;

    // ...

    @Override
    public final Bytes length() {
        return Bytes.bytes(xmlContent.length);
    }

    @Override
    public final InputStream getInputStream() throws ResourceStreamNotFoundException {
        return new ByteArrayInputStream(xmlContent);
    }

} 
```

您可以使用如上例所示的 ByteArrayInputStream。

# jquery - jQuery一次将类添加到下一个列表项并循环回到开头

> ID：15704169
> 
> 赞同：2
> 
> 时间：2013-03-29T13:24:24.653
> 
> 标签：jquery, pagination, carousel, listitem

我创建了一个循环播放 x 数量幻灯片的 jQuery 圆形轮播。我一直在为这个滑块添加分页。每个点都是与每张幻灯片相关的列表项。当第一张幻灯片可见时，第一张幻灯片具有当前课程。当您单击下一步时，该类将从 li 编号 1 中删除并添加到 li 编号 2。

我遇到的问题是，一旦我浏览了所有列表项，我希望将“当前”类添加回第一个列表项 - 单击上一个按钮时也需要发生相反的情况。

这是我的分页jQuery代码：

```
window.next = function() {
var li = jQuery("li.current");
if (li.length)
    li.removeClass("current").next().addClass("current");
else
    jQuery("li").first().addClass("current");
}
window.prev = function() {
var li = jQuery("li.current");
if (li.length)
    li.removeClass("current").prev().addClass("current");
else
    jQuery("li").last().addClass("current");
}
} 
```

和我的 html 标记：

```
<ul>
<li class="current"></li>
<li></li>
<li></li>
</ul> 
```

谁能告诉我如何让这个循环？你可以在这里看到我的工作[http://www.samskirrow.com/projects/carousel](http://www.samskirrow.com/projects/carousel)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:28:58.540

你可以简单地检查是否`next`存在，如果不存在，你必须在最后，所以选择第一个：

```
if (li.length){

    var $next = li.next();

    if($next.length == 0) $next = $("li").first();

    li.removeClass("current");
    $next.addClass("current");
} 
```

同样对于上一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:28:29.927

试试这个：

```
window.next = function() {
   var li = jQuery("li.current");
   if (li.length && li.next().length)
       li.removeClass("current").next().addClass("current");
   else {
       li.removeClass("current");
       jQuery("li").first().addClass("current");
   }
}

window.prev = function() {
   var li = jQuery("li.current");
   if (li.length && li.prev().length)
       li.removeClass("current").prev().addClass("current");
   else {
       li.removeClass("current");
       jQuery("li").last().addClass("current");
   }
} 
```

# .net - Windows 8 - 程序集不允许部分受信任的调用者

> ID：15704179
> 
> 赞同：0
> 
> 时间：2013-03-29T13:24:59.207
> 
> 标签：.net, exception, .net-assembly

我们将应用程序的二进制文件夹复制到公司网络内的共享目录中。

我们总是可以在那里启动应用程序来测试它。现在它仍然可以在任何地方工作，但是在安装了 Windows8 的新笔记本电脑上，我们收到以下错误：

```
System.Security.SecurityException: 
That assembly does not allow partially trusted callers 
```

现在我发现这必须在应用程序中使用的 dll 不“信任”彼此。但我不知道为什么这只发生在一台机器上。所有其他设备都可以像这样启动应用程序而不会出现任何问题。

如果不问，我希望问题很清楚；）

# android - 在 database.close() 之后重新编译compiledQuery

> ID：15704180
> 
> 赞同：0
> 
> 时间：2013-03-29T13:25:01.783
> 
> 标签：android, sqlite

我在 android 应用程序中使用 SQLite，我需要执行一些复杂的插入语句（带有子查询）。

我发现`SQLiteStatement`为此目的非常有用。它可以作为返回自增主键的插入语句多次编译和执行。

由于我正在关闭我的`SQLiteOpenHelper`（关闭包含`SQLiteDatabase`）`Activity#onPause()`并在其中重新打开它，因此`Activity#onResume()`我将一次又一次地获得不同`SQLiteDatabase`的实例。

`SQLiteDatabase`我应该为每个实例重新编译查询吗？

或者我可以在静态变量中缓存编译语句并成功地将它用于不同的`SQLiteDatabase`实例？

源代码建议我应该（`SQLiteStatement`包含参考`SQLiteDatabase`）......但我不确定。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T21:43:40.983

`SQLiteStatement`对象与特定`SQLiteDatabase`对象相关联，并且不能移动到另一个对象（没有此功能，并且编译的结果无论如何在任何其他数据库中都不起作用）。

您必须为新的数据库对象创建新的语句对象。

# r - 如何使用 ddply + kmean 将低集群分配给低价值数据组，将高集群分配给高价值数据组？

> ID：15704182
> 
> 赞同：1
> 
> 时间：2013-03-29T13:25:03.110
> 
> 标签：r, plyr, k-means

我有一个类似于下面的数据框：

```
data<-data.frame(COL1=c(rep("111",20),rep("222",20)),COL2=c(rep("A",10),rep("B",10),rep("A",10),rep("B",10)),DATA=c(runif(5,0.1,0.9),runif(5,4,5),runif(5,0.1,0.9),runif(5,4,5),runif(5,0.1,0.9),runif(5,4,5),runif(5,0.1,0.9),runif(5,4,5)))

   COL1 COL2      DATA
1   111    A 0.6589137
2   111    A 0.4791792
3   111    A 0.5192251
4   111    A 0.5477179
5   111    A 0.6042456
6   111    A 4.4296944
7   111    A 4.9811469
8   111    A 4.5962728
9   111    A 4.0031918
10  111    A 4.5544146
11  111    B 0.5128113
12  111    B 0.7389391
13  111    B 0.4927115
14  111    B 0.1817374
15  111    B 0.4768918
16  111    B 4.3521823
17  111    B 4.4698346
18  111    B 4.8915773
19  111    B 4.5110891
20  111    B 4.0065105
21  222    A 0.6943656
22  222    A 0.5678733
23  222    A 0.5874319
24  222    A 0.1088618
25  222    A 0.8541726
26  222    A 4.8997936
27  222    A 4.1151180
28  222    A 4.4085173
29  222    A 4.2121693
30  222    A 4.5036859
31  222    B 0.8518654
32  222    B 0.7736430
33  222    B 0.4561808
34  222    B 0.2723595
35  222    B 0.1602266
36  222    B 4.7649421
37  222    B 4.4689368
38  222    B 4.9889973
39  222    B 4.6369252
40  222    B 4.2927547 
```

我需要根据列 COL1 和 COL2 为数据分配 2 个集群。

我使用 ddply 聚合如下，但它随机分配了集群。

```
ddply(data,.(COL1,COL2),summarise,DATA=DATA,clusters=kmeans(DATA,centers=2,iter.max=500)$cluster)

   COL1 COL2      DATA clusters
1   111    A 0.6589137        2
2   111    A 0.4791792        2
3   111    A 0.5192251        2
4   111    A 0.5477179        2
5   111    A 0.6042456        2
6   111    A 4.4296944        1
7   111    A 4.9811469        1
8   111    A 4.5962728        1
9   111    A 4.0031918        1
10  111    A 4.5544146        1
11  111    B 0.5128113        2
12  111    B 0.7389391        2
13  111    B 0.4927115        2
14  111    B 0.1817374        2
15  111    B 0.4768918        2
16  111    B 4.3521823        1
17  111    B 4.4698346        1
18  111    B 4.8915773        1
19  111    B 4.5110891        1
20  111    B 4.0065105        1
21  222    A 0.6943656        1
22  222    A 0.5678733        1
23  222    A 0.5874319        1
24  222    A 0.1088618        1
25  222    A 0.8541726        1
26  222    A 4.8997936        2
27  222    A 4.1151180        2
28  222    A 4.4085173        2
29  222    A 4.2121693        2
30  222    A 4.5036859        2
31  222    B 0.8518654        2
32  222    B 0.7736430        2
33  222    B 0.4561808        2
34  222    B 0.2723595        2
35  222    B 0.1602266        2
36  222    B 4.7649421        1
37  222    B 4.4689368        1
38  222    B 4.9889973        1
39  222    B 4.6369252        1
40  222    B 4.2927547        1 
```

我怎样才能使它看起来像下面，较低的值分配到较低的集群？

```
 COL1 COL2      DATA CLUSTER
1   111    A 0.4501382       1
2   111    A 0.5396776       1
3   111    A 0.1534554       1
4   111    A 0.7031021       1
5   111    A 0.7345412       1
6   111    A 4.9698809       2
7   111    A 4.9623179       2
8   111    A 4.3449659       2
9   111    A 4.7022103       2
10  111    A 4.6236821       2
11  111    B 0.3343663       1
12  111    B 0.3664970       1
13  111    B 0.1355580       1
14  111    B 0.4256151       1
15  111    B 0.2017380       1
16  111    B 4.3215547       2
17  111    B 4.2263868       2
18  111    B 4.6150686       2
19  111    B 4.4623177       2
20  111    B 4.8687472       2
21  222    A 0.2413381       1
22  222    A 0.8124635       1
23  222    A 0.7832933       1
24  222    A 0.6445864       1
25  222    A 0.1860951       1
26  222    A 4.4659675       2
27  222    A 4.5866642       2
28  222    A 4.8920004       2
29  222    A 4.2855749       2
30  222    A 4.5555983       2
31  222    B 0.1678164       1
32  222    B 0.5800995       1
33  222    B 0.1556406       1
34  222    B 0.1761227       1
35  222    B 0.4119303       1
36  222    B 4.1318505       2
37  222    B 4.4020672       2
38  222    B 4.3807045       2
39  222    B 4.3920436       2
40  222    B 4.7933142       2 
```

我从每个集群中挑选最大值，然后比较它们，然后重新排序集群，但代码看起来真的很笨拙......有没有更好的方法来做到这一点？

非常感谢！！！

# asp.net - 在 ASP.NET 1.1 中将 http 重定向到 https

> ID：15704184
> 
> 赞同：1
> 
> 时间：2013-03-29T13:25:10.740
> 
> 标签：asp.net, .net, https

每当使用 http 请求时，我想使用 https 重定向回页面。

我用过这段代码：

```
bool isSecure = false;
isSecure = Request.IsSecureConnection;

if(!isSecure)
{
    string redirectUrl = Request.Url.ToString().Replace("http:", "https:");
    Response.Redirect(redirectUrl);
} 
```

页面示例如下

请求页面： http: [//google.com/test.aspx ?id=12233](http://google.com/test.aspx?id=12233)

重定向回：[https ://google.com/test.aspx?id=12233](https://google.com/test.aspx?id=12233)

目前它指向相同： http: [//google.com/test.aspx](http://google.com/test.aspx?id=12233) ?id=12233 并显示错误：Internet Explorer 无法显示网页

**我正在测试的网站目前没有经过 SSL 认证..但我的问题是..它不应该将页面重定向到 https，然后显示错误**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:34:26.973

HTTPS 默认端口为 443

如果您的服务器上的 443 端口上没有服务侦听，则重定向将立即失败。我猜地址栏中 url 的更新将取决于浏览器。

# javascript - 根据链接 URL 激活 jquery tabber

> ID：15704186
> 
> 赞同：0
> 
> 时间：2013-03-29T13:25:26.190
> 
> 标签：javascript, jquery

我对 jquery 很陌生，我决定构建一个 jquery tabber。到目前为止一切顺利，但我有一个小问题！！！我看不到如何根据 URL 激活 tabber。例如，当链接为 www.myweb.com#tab2 时，第二个 tabber 将被激活。我的jquery如下。

```
$(document).ready(function() {

    // When page loads...
    $(".tab_content").hide(); //Hide all content
    $("ul.tabs li:first").addClass("active").show(); //Activate first tab
    $(".tab_content:first").show(); //Show first tab content

    // On Click Event
    $("ul.tabs li").click(function() {
        $("ul.tabs li").removeClass("active"); //Remove any "active" class
        $(this).addClass("active"); //Add "active" class to selected tab
        $(".tab_content").hide(); //Hide all tab content

        var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to identify the active tab + content
        $(activeTab).fadeIn(); //Fade in the active ID content
        return false;
    });

}); 
```

和 HTML 列表如下

```
<ul class="tabs">
    <li><a href="#tab1">Design Team</a></li>
    <li><a href="#tab2">Publications</a></li>
    <li><a href="#tab3">Awards &amp; Recognitions</a></li>
    <li><a href="#tab4">Our Mission</a></li>
    <li class="last-item"><a href="#tab1">Company Profile</a></li>
</ul> 
```

现在，当有人使用此链接访问我的网站时`www.mywebsite.com#tab3`，我希望激活 tab3。我知道 jquery tabber 有这个，但我不知道如何用我自己的 jquery tabber 实现这一点。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:24:27.630

很简单。您可以`trigger` `click`根据您的哈希索引进行事件。

这对你有用。如果您在单击 for say tab3 后刷新页面并且您的 url 包含 hash index `#tab3`，则您的第三个选项卡将自动聚焦。

我假设您的or标签及其中提琴 中有一个 id `tab1`, `tab2`, `tab3`, 。将这些代码添加到您现有的代码中而不影响它们，您就完成了。`tab4``li``a`

```
$(function(){
    if(location.href.indexOf('#') != -1){
        var namedAnchor = window.location.hash;
        var findToTab = namedAnchor;
        $(findToTab).trigger('click');
    }
}); 
```

**编辑：**
但是，如果您不想为任何一个`li`或`a`标签分配任何 ID，您可以这样做。

```
$(function(){
    if(location.href.indexOf('#') != -1){
        var namedAnchor = window.location.hash;
        var findToTab = namedAnchor;
        $("ul.tabs li a[href='" + findToTab + "']").trigger('click');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:31:44.107

激活`href`属性等于的项目`location.hash`：

```
$(document).ready(function () {
   var hash = location.hash;
   $(".tab_content").hide(); //Hide all content
   if ($("ul.tabs li a[href='" + hash + "']").length) { //check if such link exists
      $("ul.tabs li a[href='" + hash + "']").parent().addClass("active"); //Activate tab
      $(hash).show();
   }
   else {
      $("ul.tabs li:first").addClass('active');
      $(".tab_content:first").show()
   }       
} 
```

# vb.net - 在 VB.net 中读取 Excel 文件时出现问题

> ID：15704192
> 
> 赞同：1
> 
> 时间：2013-03-29T13:25:38.973
> 
> 标签：vb.net, excel, file-upload, oledbconnection, data-connections

我一直在尝试上传和读取 Excel 文件（.xls 或 .xlsx）

我正在使用以下代码成功上传：

```
Protected Sub btnUpload_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles    btnUpload.Click
    Dim filepath As String = ""
    If FileUpload1.HasFile Then
        Try
            Dim filename As String = FileUpload1.PostedFile.FileName
            Dim extension = (filename.Substring(filename.LastIndexOf("."), (filename.Length() - filename.LastIndexOf("."))))
            If extension = ".xlsx" Or extension = ".xls" Then
                filepath = "\" & Common.toUnix(Now) & "_" & filename
                FileUpload1.SaveAs(Server.MapPath("~/") & filepath)
                  ' ====   NOW READ THE FILE
            Else
                StatusLabel.InnerText = "Only Excel file types are accepted (.xls/.xlsx)<br> File Uploaded had extension: " & extension
            End If

        Catch ex As Exception
            StatusLabel.InnerText = "Upload status: The file could not be uploaded. The following error occured: " + ex.ToString()
        End Try

    End If
End Sub 
```

它可以上传，但是在尝试读取文件时出现此错误：

```
System.Data.OleDb.OleDbException (0x80004005): The Microsoft Jet database engine cannot open the file ''. It is already opened exclusively by another user, or you need permission to view its data. 
```

我正在使用类似于此的代码阅读：

[vb.net 遍历 xls / xlsx 文件？](https://stackoverflow.com/questions/989347/vb-net-traversing-an-xls-xlsx-file)

因此连接如下：

```
 Dim connString As String = "Provider=Microsoft.Jet.OLEDB.4.0" & _
                           ";Data Source=" & ExcelFile & _
                           ";Extended Properties=Excel 8.0;"

    Dim conn As OleDbConnection = Nothing
    Dim dt As System.Data.DataTable = Nothing
    Dim excelDataSet As New DataSet()

    Try

        conn = New OleDbConnection(connString)

        conn.Open()  '<<< ERROR IS RAISED ON THIS LINE
        dt = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, Nothing)
        If dt Is Nothing Then
            Return Nothing
        End If

        Dim excelSheets(dt.Rows.Count) As String
        Dim i As Integer = 0
        For Each row As DataRow In dt.Rows
            excelSheets(i) = row("payments").ToString
            System.Math.Min(System.Threading.Interlocked.Increment(i), i - 1)
            If i = SheetNumber Then
                Exit For
            End If
        Next

     .................. 
```

我正在上传到共享服务器，因此无法控制此类权限，但我确实具有读/写权限并且上传图像工作正常，但它正在读取我无法开始工作的这个文件。

**笔记**

.xls 文件会发生此错误，使用 .xlsx 时会出现此错误：

```
System.Data.OleDb.OleDbException (0x80004005): Cannot update. Database or object is read-only. at System.Data.OleDb.OleDbConnectionInternal 
```

此错误发生在此行：

```
 For Each row As DataRow In dt.Rows 
```

所以看起来它正在上传并打开文件正常，但没有读取行......

我也不知道为什么会这样！

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T00:16:59.720

ACE 是残酷的，一直有问题，它不能同时存在于 32 位和 64 位版本的系统上。结果我根本不使用它。

为了读取 Excel XLSX 文件，我使用“ [EPPlus](http://epplus.codeplex.com/releases/view/89923) ”，它已被证明非常容易处理并且非常高效。

它仅适用于 XLSX（**不是**XLS）

示例...（简单只是将第一张表作为数据表拉出）

```
 Public Function XlsxToDataTable(byteStream As IO.MemoryStream) As DataTable
        Using pac As New OfficeOpenXml.ExcelPackage(byteStream)
            Dim wb As OfficeOpenXml.ExcelWorkbook = pac.Workbook
            Dim ws As OfficeOpenXml.ExcelWorksheet = wb.Worksheets(1) '1 based
            Dim out As New DataTable
            For iC As Integer = 1 To ws.Dimension.End.Column
                out.Columns.Add(ws.Cells(1, iC).Value.ToString)
            Next
            For iR As Integer = 2 To ws.Dimension.End.Row
                Dim nr As DataRow = out.NewRow
                For iC As Integer = 1 To ws.Dimension.End.Column
                    nr(iC - 1) = ws.Cells(iR, iC).Value
                Next
                out.Rows.Add(nr)
            Next
            Return out
        End Using
    End Function 
```

# java - Netbeans 的 Java 便笺簿

> ID：15704198
> 
> 赞同：1
> 
> 时间：2013-03-29T13:25:55.997
> 
> 标签：java, netbeans, ide

很多时候，我发现自己想要测试语句、正则表达式或其他简单的 Java 语句，而不必编写测试类和部署整个应用程序。

我相信 Eclipse 中存在类似的东西，但是对于 Netbeans 或在线表达式测试器是否有类似的东西？

以前用过[这个](http://writecodeonline.com/php/)在线PHP测试器，很方便。像 Java 这样的东西也会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-09T10:28:48.647

我写[http://jpad.io](http://jpad.io)就是为了这个目的。

[![在此处输入图像描述](../Images/87b5d93d22872a6d1c3241bac3203b16.png)](https://i.stack.imgur.com/LlzFJ.png)

我想运行 java 代码片段而没有所有的臃肿，我还想看到结果很好地显示。

# symfony - 无法识别的字段：symfony2 FosUserbundle 的 usernameCanonical

> ID：15704199
> 
> 赞同：0
> 
> 时间：2013-03-29T13:25:57.897
> 
> 标签：symfony, fosuserbundle

我对 FOSUserBundle 有疑问。一个已知问题：'Unrecognized field: usernameCanonical for symfony2 FosUserbundle' 当我尝试登录时

和

在架构更新时，我收到此错误：

```
Duplicate definition of column 'username' on entity 'Acme\ProjectBundle\Entity\User' in a field or discriminator column mapping. 
```

仅当我将“FOSUserBundle：~”添加到 config.yml 中的学说映射设置时，我才会收到此错误

我已经尝试了很多解决方案，但我没有解决我的问题：/请帮助我。

我关注了 FOS 的团队：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md)

在一切正常之前...

我有 Symfony 2.1.9

# 我的 config.yml：

```
doctrine:
dbal:
    default_connection: default
    connections:
        default:
            driver:   "%database_driver%"
            host:     "%database_host%"
            port:     "%database_port%"
            dbname:   "%database_name%"
            user:     "%database_user%"
            password: "%database_password%"
            charset:  UTF8
        service:
            driver:   "%database_driver2%"
            host:     "%database_host2%"
            port:     "%database_port2%"
            dbname:   "%database_name2%"
            user:     "%database_user2%"
            password: "%database_password2%"
            charset:  UTF8
orm:
    auto_generate_proxy_classes: "%kernel.debug%"
    #auto_mapping: true
    default_entity_manager: default
    entity_managers:
        default:
            metadata_cache_driver: apc
            result_cache_driver: apc
            query_cache_driver: apc
            connection: default
            mappings:
                FOSUserBundle: ~
                AcmeProjectBundle: {type: yml, dir: Resources/config/doctrine/ } #also tried wit '~'
fos_user:
    db_driver: orm # other valid values are 'mongodb', 'couchdb' and 'propel'
    firewall_name: main
    user_class: Acme\ProjectBundle\Entity\User 
```

# 我的 Acme\ProjectBundle\Entity\User.php：

```
namespace Acme\ProjectBundle\Entity;

 use FOS\UserBundle\Entity\User as BaseUser;
 use Doctrine\ORM\Mapping as ORM;
 use Symfony\Bridge\Doctrine\Validator\Constraints\UniqueEntity;
 use Symfony\Component\Validator\Constraints as Assert;
 use Symfony\Component\Security\Core\User\UserInterface;

 class User extends BaseUser implements UserInterface, \Serializable
 {
      const TYPE_ADMIN        = 0;
      const TYPE_USER         = 2;
      const TYPE_ARTIST       = 3;

/**
 * @var string $salt
 */
protected $salt;

/**
 * @var boolean $is_active
 */
private $is_active;
protected $id;

private $name;

protected $username;

protected $email;

/**
 * @var tinyint $type
 */
private $type;

protected $password;

private $description;

/**
 * Get id
 *
 * @return integer 
 */
public function getId()
{
    return $this->id;
}

/**
 * Set name
 *
 * @param string $name
 * @return User
 */
public function setName($name)
{
    $this->name = $name;

    return $this;
}

/**
 * Get name
 *
 * @return string 
 */
public function getName()
{
    return $this->name;
}

/**
 * Set type
 *
 * @param integer $type
 * @return User
 */
public function setType($type)
{
    $this->type = $type;

    return $this;
}

/**
 * Get type
 *
 * @return integer 
 */
public function getType()
{
    return $this->type;
}

/**
 * Set description
 *
 * @param string $description
 * @return User
 */
public function setDescription($description)
{
    $this->description = $description;

    return $this;
}

/**
 * Get description
 *
 * @return string 
 */
public function getDescription()
{
    return $this->description;
}

/**
 * Set username
 *
 * @param string $username
 * @return User
 */
public function setUsername($username)
{
    $this->username = $username;

    return $this;
}

/**
 * Get username
 *
 * @return string 
 */
public function getUsername()
{
    return $this->username;
}

/**
 * Set password
 *
 * @param string $password
 * @return User
 */
public function setPassword($password)
{
    $this->password = $password;

    return $this;
}

/**
 * Get password
 *
 * @return string 
 */
public function getPassword()
{
    return $this->password;
}

/**
 * Set email
 *
 * @param string $email
 * @return User
 */
public function setEmail($email)
{
    $this->email = $email;

    return $this;
}

/**
 * Get email
 *
 * @return string 
 */
public function getEmail()
{
    return $this->email;
}

public function isPasswordName()
{
    return ($this->name != $this->password);
}

public function isPassUsername()
{
    return ($this->password != $this->username);
}
/**
 * @var \DateTime $date
 */
private $date;

/**
 * Set date
 *
 * @param \DateTime $date
 * @return User
 */
public function setDate($date)
{
    $this->date = $date;

    return $this;
}

/**
 * Get date
 *
 * @return \DateTime 
 */
public function getDate()
{
    return $this->date;
}

private $updateDate;

/**
 * Set updateDate
 *
 * @param \DateTime $updateDate
 * @return User
 */
public function setUpdateDate($updateDate)
{
    $this->updateDate = $updateDate;

    return $this;
}

/**
 * Get updateDate
 *
 * @return \DateTime 
 */
public function getUpdateDate()
{
    return $this->updateDate;
}

public function setIsActive($value)
{
    $this->is_active = $value;

    return $this;
}

public function gettIsActive()
{
    return $this->is_active;

    return $this;
}

/**
 * Set salt
 *
 * @param string $salt
 * @return User
 */
public function setSalt($salt)
{
    $this->salt = $salt;

    return $this;
}

/**
 * Get salt
 *
 * @return string 
 */
public function getSalt()
{
    return $this->salt;
}

/**
 * @inheritDoc
 */
public function eraseCredentials()
{
}

public function __construct()
{
parent::__construct();
    $this->isActive = true;
    $this->salt = md5(uniqid(null, true));
}

public function getRoles()
{
    switch ($this->getType())
    {
            case 0:
                    return array('ROLE_ADMIN');
                    break;
            case 1:
            case 2:
            case 3:
                    return array('ROLE_USER');
                    break;

    }

}

/**
 * @see \Serializable::serialize()
 */
public function serialize()
{
    return serialize(array(
                    $this->id,
    ));
}

/**
 * @see \Serializable::unserialize()
 */
public function unserialize($serialized)
{
    list (
                    $this->id,
    ) = unserialize($serialized);
}
/**
 * @var integer $first_login
 */
private $first_login;

/**
 * Get is_active
 *
 * @return boolean 
 */
public function getIsActive()
{
    return $this->is_active;
}

/**
 * Set first_login
 *
 * @param integer $firstLogin
 * @return User
 */
public function setFirstLogin($firstLogin)
{
    $this->first_login = $firstLogin;

    return $this;
}

/**
 * Get first_login
 *
 * @return integer 
 */
public function getFirstLogin()
{
    return $this->first_login;
}
/**
 * @var \Doctrine\Common\Collections\ArrayCollection
 */
private $userPoints;

/**
 * @var integer $privacy
 */
private $privacy;

/**
 * Set privacy
 *
 * @param integer $privacy
 * @return User
 */
public function setPrivacy($privacy)
{
    $this->privacy = $privacy;

    return $this;
}

/**
 * Get privacy
 *
 * @return integer 
 */
public function getPrivacy()
{
    return $this->privacy;
}
/**
 * @var integer
 */
private $enable;

/**
 * Set enable
 *
 * @param integer $enable
 * @return User
 */
public function setEnable($enable)
{
    $this->enable = $enable;

    return $this;
}

/**
 * Get enable
 *
 * @return integer 
 */
public function getEnable()
{
    return $this->enable;
}
} 
```

# 我的安全.yml

```
security:
firewalls:
    main:
        pattern: ^/
        form_login:
            provider: fos_userbundle
            login_path: /login
            use_forward: false
            check_path: /login_check
            csrf_provider: form.csrf_provider
        logout:       true
        anonymous:    true
providers:
    fos_userbundle:
        id: fos_user.user_provider.username

encoders:
    FOS\UserBundle\Model\UserInterface: sha512

role_hierarchy:
    ROLE_ADMIN:       ROLE_USER
    ROLE_SUPER_ADMIN: ROLE_ADMIN

access_control:
    - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/register, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/resetting, role: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/admin/, role: ROLE_ADMIN } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-22T16:09:57.233

看来您的 FOSUserBundle 版本不好......我在 1.3.* 上遇到了同样的问题，我解决了这个问题，只是将其更改为版本“~2.0@dev”。

你可以查看你的“fos_user”表来检查这个；如果它只包含一个“id”字段，则您的用户实体没有扩展正确的“FOS\Entity\User”对象......尝试在“composer.json”中升级您所需的捆绑包版本，然后重建您的表（在完整的硬重建下 - 数据丢失）：

```
php app/console doctrine:schema:drop --force
php app/console doctrine:schema:create 
```

如果您的“fos_user”表包含所有必填字段，那么您很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T13:53:13.940

查看有关创建使用类的文档：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md)

您的 User 类不应重复基类中的所有属性（用户名等）。它应该只有新的属性，如名称和 ID。

虽然您没有显示您的学说映射文件，但我猜您可能复制的所有内容都很好？仅映射新属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T13:42:57.680

事实上，我想，你应该在 config.yml 上有一些代码作为

```
fos_user:  
    db_driver: orm # other valid values are 'mongodb', 'couchdb' and 'propel'
    firewall_name: main  
    user_class: Acme\ProjectBundle\Entity\User 
```

你应该不需要添加某事。FOSUser的`orm`设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-21T10:36:59.080

```
orm:
    auto_generate_proxy_classes: "%kernel.debug%"
    #auto_mapping: true
    default_entity_manager: default
    entity_managers:
       default:            
          // that's for APCu or APC
          metadata_cache_driver: apc
          result_cache_driver: apc
          query_cache_driver: apc 
```

在 dev env APC 中禁用，这就是您收到此错误的原因。您必须为 dev 评论它或启用 cacheClassLoader

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-01T11:45:37.060

我遇到了这个麻烦并应用了 PieroWbmstr 的建议，并开始使用 2.0 而不是 1.3.6 ...在 config.yml 中设置为 true 的教义.orm.auto_mapping

一旦我进行了 composer.json 版本切换和升级，我的学说：模式：更新立即识别出当前数据库实例中缺少的新字段，并应用它们。

FOS/UserBundle 中较新版本的用户类似乎没有任何显着的变化会迫使映射很好地发挥作用。有谁知道这两个版本有什么区别？或者更直接地说，为什么旧​​版本不让教义识别它是 xml 映射（提示：在我的两个 FOS/UserBundle 版本中，我将本地自定义捆绑包设置为使用注释）。

谢谢

# android - 如何在imageview上与android中的手指一起画线

> ID：15704205
> 
> 赞同：8
> 
> 时间：2013-03-29T13:26:24.083
> 
> 标签：android, drawing, imageview

在我的应用程序中，我想用手指在 imageview 上画线。我想要如下输出：![在此处输入图像描述](../Images/bcaa914acbd9838d524224c12f21eb70.png)

在这个屏幕中，鱼是图像视图，红线是画线。所以我按照下面的链接来开发应用程序 [链接](http://androidrises.blogspot.in/2012/10/draw-line-on-finger-touch.html)。这是我的代码：

```
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.addphoto);

    btnAddPhoto=(Button)findViewById(R.id.add);
    btnEdit=(Button)findViewById(R.id.edit);
    imageView=(ImageView)findViewById(R.id.photo);

    btnAddPhoto.setOnClickListener(this);
    btnEdit.setOnClickListener(this);
    imageView.setOnTouchListener(this);         
}

    @Override
public void onWindowFocusChanged(boolean hasFocus){
    width=imageView.getWidth();
    height=imageView.getHeight();

    Log.e("heightttt",""+height);
    Log.e("Widthhhh",""+width);

}

    @Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    if(v.equals(btnAddPhoto)){

        popup.setVisibility(View.VISIBLE);
    }

    if(v.equals(btnEdit)){
       bitmap = Bitmap.createBitmap((int) width, (int) height,Bitmap.Config.ARGB_8888);
        canvas = new Canvas(bitmap);
        paint = new Paint();
        paint.setColor(Color.BLACK);
        imageView.setImageBitmap(bitmap);
        imageView.setOnTouchListener(this);
    }
}

    public boolean onTouch(View v, MotionEvent event) {
        int action = event.getAction();
        switch (action) {
        case MotionEvent.ACTION_DOWN:
          downx = event.getX();
          downy = event.getY();
          break;
        case MotionEvent.ACTION_MOVE:
          break;
        case MotionEvent.ACTION_UP:
          upx = event.getX();
          upy = event.getY();
          canvas.drawLine(downx, downy, upx, upy, paint);
          imageView.invalidate();
          break;
        case MotionEvent.ACTION_CANCEL:
          break;
        default:
          break;
        }
        return true;
      } 
```

在此编码中，每当我运行应用程序时，都会打开以下屏幕。

![在此处输入图像描述](../Images/dfd3e20263b765f7cc6770c8ad3b051e.png)

然后通过使用添加按钮，我从我的画廊添加了照片。这是屏幕下方。

![在此处输入图像描述](../Images/a7b7e24f783308a0fbf3f888bad30078.png)

然后，每当我单击edittool按钮时，鱼的图像视图就消失了，我只能像下面这样绘制直线。但我想在 imageview 上画线以及像第一个屏幕一样的手指。

![在此处输入图像描述](../Images/b99a034d5e838405f199b9799bf10951.png)

请任何人帮助我。我是安卓新手。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-29T13:44:35.277

您应该覆盖`onDraw`视图的方法。

screen_drawing_room.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/rlid"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >
<LinearLayout   <!--set background for the bottom layout set image here. -->
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="bottom"
    android:orientation="vertical"
    android:weightSum="1.0" >

    <LinearLayout
        android:id="@+id/view_drawing_pad" <!--your drawing pad on foreground -->
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >
    </LinearLayout>
</LinearLayout>
</RelativeLayout 
```

在你的活动中`onCreate()`

```
DrawingView mDrawingView=new DrawingView(this);
setContentView(R.layout.screen_drawing_room);    
LinearLayout mDrawingPad=(LinearLayout)findViewById(R.id.view_drawing_pad);
mDrawingPad.addView(mDrawingView); 
```

绘图视图.java

定义您的绘图视图。以下可用于手绘。修改相同以绘制线条、文本和填充颜色（封闭区域）。对于洪水填充，请参阅链接[android using flood fill algorithm getting out of memory exception](https://stackoverflow.com/questions/12669740/android-using-flood-fill-algorithm-getting-out-of-memory-exception)中接受的答案。

```
class DrawingView extends View {
    Paint       mPaint;
    //MaskFilter  mEmboss;
    //MaskFilter  mBlur;
    Bitmap  mBitmap;
    Canvas  mCanvas;
    Path    mPath;
    Paint   mBitmapPaint;

    public DrawingView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(0xFFFF0000);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(20);

        mPath = new Path();
        mBitmapPaint = new Paint();
        mBitmapPaint.setColor(Color.RED);
    }
    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
        mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
        mCanvas = new Canvas(mBitmap);
    }
    @Override
    public void draw(Canvas canvas) {
        // TODO Auto-generated method stub
        super.draw(canvas);
        canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
        canvas.drawPath(mPath, mPaint);
    }
    private float mX, mY;
    private static final float TOUCH_TOLERANCE = 4;

    private void touch_start(float x, float y) {
        //mPath.reset();
        mPath.moveTo(x, y);
        mX = x;
        mY = y;
    }
    private void touch_move(float x, float y) {
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
            mPath.quadTo(mX, mY, (x + mX)/2, (y + mY)/2);
            mX = x;
            mY = y;
        }
    }
    private void touch_up() {
        mPath.lineTo(mX, mY);
        // commit the path to our offscreen
        mCanvas.drawPath(mPath, mPaint);
        //mPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SCREEN));
        // kill this so we don't double draw
        mPath.reset();
       // mPath= new Path();
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        float x = event.getX();
        float y = event.getY();

        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                touch_start(x, y);
                invalidate();
                break;
            case MotionEvent.ACTION_MOVE:
                touch_move(x, y);
                invalidate();
                break;
            case MotionEvent.ACTION_UP:
                touch_up();
                invalidate();
                break;
        }
        return true;
    }   
} 
```

您的绘图视图已设置。从图形文件夹下的 sdk 上的示例中研究 fingerpaint.java。

结果快照。您在背景中看到的是图像。在前景我画了嗨。我在拐角处画线。如果你能认出它是红色的。

画出看起来像边框的线条。将油漆的描边宽度设置为您喜欢的任何值。同样，您可以通过更改 x1,y1 和 x2,y2 坐标来绘制所需的线条。

```
Display display = ( (Activity) mcontext).getWindowManager().getDefaultDisplay();  
float w = display.getWidth(); 
float h = display.getHeight();
canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
canvas.drawLine(0, 0, w, 0,mBitmapPaint);
canvas.drawLine(0, 0, 0, h,mBitmapPaint);
canvas.drawLine(w,h,w,0,mBitmapPaint);
canvas.drawLine(w, h, 0,h , mBitmapPaint); 
```

![在此处输入图像描述](../Images/abecc449e83e80f8fa161315e46c0b37.png)

编辑：

从图库中获取图像

```
File fp;
Drawable d;   

public void  setImagefrmGallery() {
    // To open up a gallery browser
    Intent intent = new Intent();
    intent.setType("image/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Picture"),1);
    // To handle when an image is selected from the browser, add the following to your Activity 
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        if (requestCode == 1) {
            // currImageURI is the global variable I�m using to hold the content:// URI of the image
            Uri currImageURI = data.getData();
            System.out.println("Hello======="+getRealPathFromURI(currImageURI));
            String s= getRealPathFromURI(currImageURI);
            File file = new File(s);

            if (file.exists()) {
                fp=file.getAbsolutePath();
                d = Drawable.createFromPath(file.getAbsolutePath());
                mDrawingPad.setBackgroundDrawable(d);
            } else {
                System.out.println("File Not Found");
            }
        }
    }
}

// And to convert the image URI to the direct file system path of the image file
public String getRealPathFromURI(Uri contentUri) {
    // can post image
    String [] proj={MediaStore.Images.Media.DATA};
    Cursor cursor = managedQuery( contentUri,
            proj, // Which columns to return
            null, // WHERE clause; which rows to return (all rows)
            null, // WHERE clause selection arguments (none)
            null); // Order-by clause (ascending by name)
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index); 
} 
```

# gwt - GWT 移动开发

> ID：15704207
> 
> 赞同：6
> 
> 时间：2013-03-29T13:26:27.890
> 
> 标签：gwt, mobile, mgwt

我正在寻找构建一个针对移动浏览器的 GWT 应用程序。我的要求：

*   适用于所有现代浏览器的移动友好小部件，包括 IE、Firefox（不仅仅是 webkit）。

我还没有找到任何支持良好的框架来执行此操作。

我看过：

*   mgwt：由一位开发人员支持，仅适用于 webkit，所有浏览器没有通用主题
*   SmartGWT Mobile：仍处于测试阶段，仅适用于 webkit
*   jqm4GWT：没有很好的支持，JQuery Mobile dev 没有很好地与 GWT 集成

遗憾的是，与带宽较慢（例如 JSF）的服务器端相比，GWT 对于移动开发人员来说应该非常高效。

有人对使用 GWT 的移动开发有任何建议吗？鉴于移动浏览的大量增加，对移动 GWT 的需求没有增加令我感到惊讶。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T20:01:11.447

我决定使用 JQM4GWT 并进行一些定制。这并不理想，但这里是我的一些意见：

*   与 JQuery mobile 相比，mGWT 背后的资源目前过于有限
*   mGWT 浏览器支持不是很好
*   mGWT 社区很小
*   mGWT 小部件看起来不太好
*   我不是默认主题的忠实粉丝，我更喜欢在包括桌面浏览器在内的所有浏览器中拥有一致的外观。

If we look at the resources behind JQuery Mobile and the amount of testing that goes into all the different browsers its hard to compete. There is a huge community reporting bugs which only improves the framework faster and there is a large team working on the development of the framework.

Hopefully Google will devote more resources to mGWT and it can be a competitive framework but I feel in its current state its not mature enough and its much safer using JQM4GWT for the immediate future.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T16:21:51.370

我仍然会押注 mGWT 和 PhoneGap 的组合。

## 原因

1.  mGWT 开发人员是 Daniel Kurka，他**是 Google Web Toolkit 指导委员会**[**成员**](https://groups.google.com/forum/?fromgroups=#!topic/mgwt/SKcQp408RDg)和**员工**@google 。[](https://groups.google.com/forum/?fromgroups=#!topic/mgwt/SKcQp408RDg)
***   他的**[StackOverflow 个人资料](https://stackoverflow.com/users/201251/daniel-kurka)**。*   mGWT 处于主动开发模式 - [https://code.google.com/p/mgwt/source/list](https://code.google.com/p/mgwt/source/list)*   mGWT 已经在使用 GWT 2.5*   与 SmartGWT、Sencha 和其他库不同，mGWT 是基于原生 DOM 的。*   Firefox 问题已记录并正在处理 - [https://code.google.com/p/mgwt/issues/detail?id=194](https://code.google.com/p/mgwt/issues/detail?id=194)*   phonegap 的新版本 - [http://blog.daniel-kurka.de/2013/03/gwt-phonegap-24-released.html](http://blog.daniel-kurka.de/2013/03/gwt-phonegap-24-released.html)**

 *** * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-30T03:49:19.713

有趣的发展，Daniel Kurka 几周前分享了他已被谷歌聘用。这可能是对 mgwt 的真正推动。 [https://groups.google.com/forum/?fromgroups=#!topic/mgwt/SKcQp408RDg](https://groups.google.com/forum/?fromgroups=#!topic/mgwt/SKcQp408RDg)**

# sql - datepart 从 2 年开始的几个月

> ID：15704210
> 
> 赞同：0
> 
> 时间：2013-03-29T13:26:33.080
> 
> 标签：sql

我有这个代码：

```
SELECT Jmeno, COUNT(Ucast)
  FROM Hraci
 INNER JOIN Ucast_Zapas ON Ucast_Zapas.ID_Hrace_zapas=Hraci.IDHrace
 INNER JOIN Zapas ON Zapas.ID_zapas=Ucast_Zapas.ID_zapasu_ucast
 INNER JOIN Kategorie ON Kategorie.IDkategorie=Zapas.Kategorie_zapas
 WHERE (Ucast=1)
   AND (Kategorie.IDkategorie=1)
   AND (datepart(year, Zapas_Datum) = '2013')
   AND (datepart(MONTH, Zapas_Datum) BETWEEN 1 AND 5) 
GROUP BY Jmeno; 
```

当我想要 2013 年 8.-12.month 和 2014 年 1.-8.month 时，我想写什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:33:30.477

如果我正确理解您的要求，您想返回 ZAPAS_Datum 字段介于 8/2013 和 8/2014 之间的所有记录吗？如果是这样，那么这应该工作：

```
SELECT Jmeno, COUNT(Ucast)
  FROM Hraci
 INNER JOIN Ucast_Zapas ON Ucast_Zapas.ID_Hrace_zapas=Hraci.IDHrace
 INNER JOIN Zapas ON Zapas.ID_zapas=Ucast_Zapas.ID_zapasu_ucast
 INNER JOIN Kategorie ON Kategorie.IDkategorie=Zapas.Kategorie_zapas
 WHERE (Ucast=1)
   AND (Kategorie.IDkategorie=1)
   AND Zapas_Datum >= '8/1/2013' 
   AND Zapas_Datum < '9/1/2014' 
GROUP BY Jmeno; 
```

顺便说一句——根据您的 RDBMS，您可能需要以不同于上面的方式格式化您的日期。

# php - 始终如一地将随机字符串更改为颜色

> ID：15704220
> 
> 赞同：9
> 
> 时间：2013-03-29T13:26:57.307
> 
> 标签：php

我有一些要为其生成随机颜色的 ID。制作随机颜色不是问题，但必须保持一致。

我可以对 ID 进行 MD5（或某种其他类型的哈希），这样代码就可以知道预期有多少字符，但底线是它必须为相同的 ID/哈希/字符串生成相同的（随机）颜色。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-29T14:46:55.627

RGB 代码所需要的只是从随机字符串到 6 位十六进制值的一致映射。为什么不使用 md5 作为十六进制字符串的一种方式，然后取前 6 位数字？

```
<?php
function rgbcode($id){
    return '#'.substr(md5($id), 0, 6);
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-31T05:26:09.143

这是我在自己的一个项目中使用的一个简单函数，用于创建可以与 PHP 一起使用的 RGB 值`imagecolorallocatealpha`：

```
function randomRgbGeneratorFromId( $id = null ) {
    $md5 = md5( $id );
    $md5 = preg_replace( '/[^0-9a-fA-F]/', '', $md5 );
    $color = substr( $md5, 0, 6 );
    $hex = str_split( $color, 1 );
    $rgbd = array_map( 'hexdec', $hex );
    $rgba = array(
        ( $rgbd[0] * $rgbd[1] ),
        ( $rgbd[2] * $rgbd[3] ),
        ( $rgbd[4] * $rgbd[5] ),
    );
    return $rgba;
} 
```

当然，您始终可以使用以下方式输出到您的 CSS / HTML：

```
 echo sprintf( 'rgb(%s)', implode( ',', randomRgbGeneratorFromId( $id ) ) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:37:49.570

首先将随机字符串转换为 6 位数的十六进制数，然后删除浮点数并将字符串转换为整数并将它们转换为十六进制字符串，然后在六位十六进制数之前放置一个哈希，该随机字符串有一个颜色，你可能会发现十六进制数大于六位一，如果是这样，继续将该数字除以 2，直到它变成 5 位十六进制数，第六位将是总十六进制数除以 2 的次数，有你的颜色代码。

# java - 在jar中读取资源文件

> ID：15704221
> 
> 赞同：0
> 
> 时间：2013-03-29T13:26:59.150
> 
> 标签：java

我正在尝试读取 .jar 文件中的初始文本文件。我尝试使用 ClassLoader 加载文件，但没有成功。奇怪的是，这种方式它在 Eclipse 中工作，但它没有作为单独的可执行 jar 文件。

现在我将尝试重现这种情况：

A类：

```
/**
 * Read initial file.
 *
 * @return initial file
 */
private SomeObject readInitialObject() {
    String path = "object/Welcome.xml";
    File f = new File(path);
    Reader r = new Reader(f);
    SomeObject o = r.read();
    return o;
} 
```

类阅读器：

```
private File importedFile; 
public void read() {
...
 DocumentBuilderFactory dbFactory = DocumentBuilderFactory
                .newInstance();
        DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
        Document doc = dBuilder.parse(FileLoader.load(importedFile.
                                                           getPath()));
} 
```

类文件加载器

```
/**
 * Load input stream.
 *
 * @param path file path
 * @return input stream
 */
public static InputStream load(final String path) {
    InputStream input = FileLoader.class.getResourceAsStream(path);
    if (input == null) {
        input = FileLoader.class.getResourceAsStream("/" + path);
    }

    return input;
} 
```

![.jar 文件：](../Images/c58a272cbe5a9eb0d93f3fa9d0561475.png)

收到您的建议，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:34:35.090

以[分布式 jar 文件未获取我的 .txt 文件](https://stackoverflow.com/questions/15703939/distributed-jar-file-not-picking-up-my-txt-file)为例。

您需要指定相对于您正在使用的类的`getResourceAsStream`路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:31:06.490

在 jar 文件中，文件结构与您的实际结构略有不同。您可以打开 jar 以查看文件的确切路径。另请参阅[http://docs.oracle.com/javase/tutorial/deployment/jar/build.html](http://docs.oracle.com/javase/tutorial/deployment/jar/build.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:32:58.070

问题可能是 Windows 不区分大小写，但在 jar 中，文件名区分大小写（如在 Linux 上）。进一步不要使用 File ，就像你使用的`/`那样 not `\`。

所以我认为实际的文件有点不同。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-29T13:33:47.887

打开你的jar文件看看你有没有导出文件！-如果否 -> 再次将项目导出到 jar 文件并选择要导出的文件 - 如果是 -> 检查文件路径

# iphone - 在自动完成搜索中，我想从 tableview 中获取数据

> ID：15704225
> 
> 赞同：0
> 
> 时间：2013-03-29T13:27:23.290
> 
> 标签：iphone, ios, objective-c

在自动完成搜索中，我想从 tableview 中获取数据。我使用下面的代码进行自动搜索，但不是自动搜索。如果有人知道，请帮助我

```
- (void)searchAutocompleteEntriesWithSubstring:(NSString *)substring {
    // Put anything that starts with this substring into the autocompleteUrls array
    // The items in this array is what will show up in the table view
    [autoCompleteData removeAllObjects];
    for(NSString *curString in pastData) {
        NSRange substringRange = [curString rangeOfString:substring];
        if (substringRange.length!= 0) {
            [autoCompleteData addObject:curString];  
        }
    }
    [routeName reloadData];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:51:35.493

您需要在每次击键时过滤数据。您可以在`textField:shouldChangeCharactersInRange:replacementString:`.

我建议您只过滤表格视图的数据数组和`reloadData`. 使用谓词，您可以以闪电般的速度和很少的代码进行过滤：

```
autoCompleteData = [currentDataArray filteredArrayUsingPredicate:
  [NSPredicate predicateWithFormat:@"self CONTAINS[cd] %@", search text]]; 
```

# php - 有没有办法设置 Tropo 通话的最长持续时间？

> ID：15704226
> 
> 赞同：1
> 
> 时间：2013-03-29T13:27:25.730
> 
> 标签：php, voip, tropo

根据在线文档，Tropo 通话时间限制为 2 小时。有没有办法改变这个值？换句话说，有没有办法设置 Tropo 通话的最长持续时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:49:10.730

Tropo 目前不支持呼出电话没有时间限制。在他们的支持论坛中获得更多信息：[https ://www.tropo.com/account/tickets/tickets.jsp?bb-cid=94&bb-tid=1285258&bb-name=tropo_support](https://www.tropo.com/account/tickets/tickets.jsp?bb-cid=94&bb-tid=1285258&bb-name=tropo_support)

# wordpress - Wordpress 管理界面需要永远加载

> ID：15704227
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:27:30.880
> 
> 标签：wordpress

TLDR 版本：无法加载 Wordpress 管理界面

我有一个 WordPress 博客，我已经使用了 2 年多了。

最近我一直遇到这个问题。所有页面登录，添加新帖子，仪表板，即所有管理界面页面都需要永远加载。

我试过调试这个问题，下面是我的萤火虫的网络统计信息。

![在此处输入图像描述](../Images/06fe68a8c56dbaa7c0312216c7fe6093.png)

看来我的 wp-admin.min.css 需要很长时间才能加载。

另外，我认为这可能与我所做的 Wordpress 最新更新有关。但我不确定，我该如何解决这个问题？

我对此进行了很多搜索，但找不到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:01:10.207

它可能根本不是您的 WordPress 安装（而是您自己的互联网连接或机器设置）。登录页面对我来说加载得非常快，[在这里你可以看到 Pingdom 的完整分析](http://tools.pingdom.com/fpt/#!/oswX8M0zZ/http://yassershaikh.com/wp-login.php)。

加载不到半秒。我会尝试其中一些方法来缩小问题范围：

*   重启
*   尝试不同的浏览器
*   尝试不同的计算机
*   尝试不同的网络/位置

# .net - Run devenv from commandline

> ID：15704230
> 
> 赞同：1
> 
> 时间：2013-03-29T13:27:42.787
> 
> 标签：.net, command-line, devenv

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim lRet&
    lRet = Shell("cmd /k devenv m:\myproject.sln /build Release", 1)

End Sub 
```

This fails with the command line saying "devenv" is misspelt or not found.

Does anybody know why?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:20:54.193

I ran all "bat" files that I could find in the VC programs directory. First I started them not as as admin, and it did not work. When I started the bats as an admin, the command would finally work. Also I had to move to the VS path using CD.

# bash - 是否有 grep 的逆：在长模式中找到短线？

> ID：15704235
> 
> 赞同：4
> 
> 时间：2013-03-29T13:27:58.347
> 
> 标签：bash, search, while-loop, grep, pattern-matching

在 grep 从查找文件的长行中的模式文件中找到一个短模式的地方，我需要一个工具来提取可以在较长模式中找到的查找文件的短行。

换句话说，给定莎士比亚的作品，每行一句话，说一本法语词典，我想找出在莎士比亚的哪一行中找到了哪些法语单词，从而可以检测到莎士比亚的一行可能包含更多的事实。一个法语单词，并且一个法语单词可能出现在不止一行的莎士比亚。

例如：

```
pattern_file={
"The sun is shining!"
"It is a beautiful day!"}

lookup_file={
"Rain"
"Sun"
"Cloud"
"Beautiful"
"Shining"} 
```

我想要的是

```
function file pattern 
```

给出在较长模式中找到的行和较长模式本身以逗号分隔，并检测到多个匹配项。

```
ideal_result_file={
"Sun","The sun is shining!"
"Beautiful","It is a beautiful day!",
"Shining", "The sun is shining!"} 
```

目前，我使用 grep 逐行遍历整个查找文件：

```
 while read line
    do
      grep  -is $line pattern_file | sed 's/^/'"$line"'\,/g' >> result_file.csv
    done < lookup_file 
```

这非常慢！我的 lookup_file 包含超过 50 000 行，而我的 pattern_file 包含 500 行。使用 grep 在我的 lookup_file 中查找更短的模式需要几秒钟，而使用我的循环方法的单次传递需要几天/几周。

任何语言的解决方案将不胜感激。

[与在大型数据集上使用 grep 或 fgrep 的非常慢的循环](https://stackoverflow.com/questions/14143163/very-slow-loop-using-grep-or-fgrep-on-large-datasets)有些相关
[Perl 比 bash 快吗？](https://stackoverflow.com/questions/1132135/is-perl-faster-than-bash)

该解决方案需要与 GB 大小的循环和模式文件兼容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:31:42.330

您可以使用`-f`开关在 grep 中使用“模式文件”：

```
egrep -i -f lookup_file pattern_file >> result_file 
```

这会更快，因为`grep`编译`lookup_file`成一个同时检查所有匹配项的状态机，而不是分别针对每一行检查每个模式。

如果您的 lookup_file 包含文本而不是正则表达式，您可以使用 fgrep ，它会更快。

要获得理想的输出，您可以使用 -n 和 -o 开关，并获得与每一行匹配的模式列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T18:15:54.733

由于您指出任何语言都可以接受，因此我将发布一种完全不同的方法：使用 shell 脚本，您将永远无法击败内存工具或数据库的性能。如果您有大量数据，则应该使用专门用于此类操作的数据库，并且可以更好地扩展。

所以这是一个使用 sqlite ( [www.sqlite.org](http://www.sqlite.org) ) 的简单示例。

您需要将模式和数据导入表格，例如（如果需要，您可以编写脚本）：

```
CREATE TABLE patterns (pattern TEXT);
CREATE TABLE data (sentence TEXT);

BEGIN;

INSERT INTO patterns VALUES ('Sun');
INSERT INTO patterns VALUES ('Rain');
INSERT INTO patterns VALUES ('Cloud');
INSERT INTO patterns VALUES ('Beautiful');

INSERT INTO data VALUES ('The sun is shining');
INSERT INTO data VALUES ('It is a beautiful day');
INSERT INTO data VALUES ('It is cloudy and the sun shines');

COMMIT; 
```

然后运行`select`查询以获得所需的输出：

```
select pattern, group_concat(sentence) as doesmatch from (
    select pattern, sentence, lower(pattern) as lpattern, lower(sentence) as lsentence
    from patterns left outer join data
    where like('%' || lpattern || '%', lsentence)
) group by pattern; 
```

如果您在命令行上使用它时将第一个片段保存为`data.sql`第二个片段：`query.sql`

```
sqlite3 sentences.db < data.sql    # this imports your data, run once
sqlite3 sentences.db < query.sql 
```

这给了你：

```
Beautiful|It is a beautiful day
Cloud|It is cloudy and the sun shines
Sun|The sun is shining,It is cloudy and the sun shines 
```

我相信这就是你想要的。为了使它更花哨，请使用您最喜欢的更高级的工具和数据库库。我会为此选择python。

进一步改进的建议：

*   使用`regex`而不是`like`过滤整个单词（即模式“sun”匹配“sun”但不匹配“sunny”），

*   导入实用程序，

*   输出格式，

*   查询优化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T22:52:55.290

您的解决方案实际上可能很慢，因为它创建了 50.000 个进程，所有进程都读取 500 行模式文件。

另一个“纯 bash 和 unix utils”解决方案可能是让它`grep`做它最擅长的事情，并将输出与你的 pattern_file 匹配。

所以使用`grep`来查找匹配的行和实际匹配的部分。

我在这里使用单词匹配，可以通过删除 grep 行中的开关来关闭它，`-w`并获得示例中描述的初始行为。

输出尚未重定向到`result_file.csv`.. 这很容易在以后添加 8)

```
#!/bin/bash
# open pattern_file
exec 3<> pattern_file

# declare and initialize integer variables
declare -i linenr
declare -i pnr=0

# loop for reading from the grep process
#
# grep process creates following output:
#   <linenumber>:<match>
# where linenumber is the number of the matching line in pattern_file
# and   match is the actual matching word (grep -w) as found in lookup_file
# grep output is piped through sed to actually get
#   <linenumber> <match>
while read linenr match ; do

   # skip line from pattern_file till we read the line
   # that contained the match
   while [[ ${linenr} > ${pnr} ]] ; do
       read -u 3 pline
       pnr+=1
   done

   # echo match and line from pattern_file
   echo "$match, $pline"
done < <( grep -i -w -o -n -f lookup_file pattern_file | sed -e 's,:, ,' )

# close pattern_file
exec 3>&- 
```

结果是

```
sun, The sun is shining
shining, The sun is shining
beautiful, It is a beautiful day! 
```

对于给出的例子。注意：匹配现在是保留大小写的完全匹配。所以这不会导致`Sun, ...`但会导致`sun, ...`.

结果是一个脚本，它使用 grep 读取 pattern_files 一次，在最好的情况下读取 pattern_file 和 lookup_file 一次 - 取决于实际实现。它只会启动两个额外的进程：`grep`和`sed`. （如果需要，`sed`可以用外循环中的一些 bash 替换来替换）

我没有尝试使用 50.000 行 lookup_file 和 500 行 pattern_file。但我认为它可能和 grep 一样快。

只要`grep`可以将lookup_file保存在内存中，它可能是合理的快。（谁知道）

无论它是否解决了您的问题，我都会对它与您的初始脚本相比的性能感兴趣，因为我确实缺少很好的测试文件。

如果`grep -f lookup_file`使用太多内存（正如您之前在评论中提到的），它可能是一种解决方案，可以将其拆分为实际适合内存的部分并多次运行脚本或使用不止一台机器，在这些机器上运行所有部分并且只是收集并连接结果。只要 lookup_files 不包含欺骗，您就可以连接结果而不检查欺骗。如果排序很重要，您可以对所有单个结果进行排序，然后使用`sort -m`.

只要您只拆分一次lookup_file 并重新运行脚本，拆分lookup_file 不会显着影响运行时间，因为您的pattern_file 可能足够小，它的500 行无论如何都可以保留在内存缓存中！？如果您使用多于一台机器，lookup_file 可能也是如此 - 它的部分可能只保留在每台机器的内存中。

**编辑：**

正如我在评论中指出的那样，这不适用于开箱即用的重叠文件，因为`grep -f`似乎只返回最长的匹配并且不会重新匹配，所以如果`lookup_file`包含

```
Sun
Shining
is
S 
```

结果将是

```
sun, The sun is shining
is, The sun is shining
shining, The sun is shining 
```

并不是

```
sun, The sun is shining
is, The sun is shining
shining, The sun is shining
s, The sun is shining
s, The sun is shining
s, The sun is shining 
```

因此，所有匹配项`s`（匹配三次）都丢失了。

事实上，这是这个解决方案的另一个问题：如果一个字符串被找到两次，它将被匹配两次，并且将返回相同的行，这可以通过`uniq`.

**可能的解决方法：**拆分`lookup_file`搜索字符串的按字符串长度。这将减少运行 grep 所需的最大内存，但也会稍微减慢整个过程。但是：然后您可以并行搜索（如果在同一台服务器上执行此操作，可能需要检查`grep`s选项）。`--mmap`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-29T14:31:43.473

您需要交换“模式”和“查找”文件的含义，并使用 grep 的`-o`开关。

```
$ cat patterns 
The sun is shining!
It is a beautiful day!

$ cat lookup 
Rain
Sun
Cloud
Beautiful

$ grep -iof lookup patterns 
sun
beautiful 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-29T16:03:51.207

编辑：对不起，前面的例子不起作用。

这似乎是 perl 的完美匹配。从...开始

```
#!/usr/bin/perl

open PATTERNS, "patterns";
open LOOKUP, "lookup";

my @l = <LOOKUP>;

while (chomp(my $re = <PATTERNS>)) {
     print "$re\n" if grep(/$re/, @l); 
} 
```

请注意，我在这里切换了模式和查找的含义。图案就是图案。如果您想打印图案而不是线条，那很好，但我不会更改它们的名称。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-06T01:01:35.683

使用哈希表或集合（取决于您的语言）以全小写形式存储字典。对于每一行，将行拆分为基于非字母字符的单词数组。根据这些单词构建一个微型哈希表，转换为小写，以消除重复。遍历该微型哈希表中的每个单词，验证它是否存在于您的字典哈希表中。如果存在，则打印该单词和整行。

这是 Perl 中的一个实现。

```
#! /usr/bin/perl

my $dictFile=$ARGV[0];
my $srchFile=$ARGV[1];
(-f $dictFile and -f $srchFile) or die "Usage: $0 dictFile srchFile";

# Load dictionary into hash table
my %dict=();
open($df, "<$dictFile") or die "Cannot open $dictFile";
while (<$df>) {
  chomp;
  $dict{lc($_)}=1;
}

# Search file for your dictionary words
open($sf, "<$srchFile") or die "Cannot open $srchFile";
my $lineNo=0;
while ($line=<$sf>) {
  $lineNo++;
  chomp($line);
  my %words=();
  my @sentence=split(/[^a-zA-ZÀ-ÿ0-9]+/, $line);
  foreach $word (@sentence) {
    $words{lc($word)}=1;
  }
  while ( my ($key) = each(%words) ) {
    if ($dict{$key}) {
      print "$lineNo, $key, $line\n";
    }
  }
} 
```

模式.txt

```
The sun is shining!
It is a beautiful day! 
```

查找.txt

```
Rain
Sun
Cloud
Beautiful
Shining 
```

`$ ./deepfind lookup.txt pattern.txt`

```
1, shining, The sun is shining!
1, sun, The sun is shining!
2, beautiful, It is a beautiful day! 
```

编辑：根据您的评论，这是在“句子”中定义“单词”集的另一种方法。这准备了与字典中找到的任何序列的长度相匹配的所有可行序列。

```
#! /usr/bin/perl
my $dictFile=$ARGV[0];
my $srchFile=$ARGV[1];
(-f $dictFile and -f $srchFile) or die "Usage: $0 dictFile srchFile";
# Load sequence dictionary into hash table
my %dict=();
my %sizes=();
open($df, "<$dictFile") or die "Cannot open $dictFile";
while (<$df>) {
  chomp;
  $dict{lc($_)}=1;
  $sizes{length($_)}=1;
}

# Search file for known sequences
open($sf, "<$srchFile") or die "Cannot open $srchFile";
my $lineNo=0;
while ($line=<$sf>) {
  $lineNo++;
  chomp($line);
  # Populate a hash table with every unique sequence that could be matched
  my %sequences=();
  while ( my ($size) = each(%sizes) ) {
    for (my $i=0; $i <= length($line)-$size; $i++) {
      $sequences{substr($line,$i,$size)}=1;
    }
  }
  # Compare each sequence with the dictionary of sequences.
  while ( my ($sequence) = each(%sequences) ) {
    if ($dict{$sequence}) {
      print "$lineNo, $sequence, $line\n";
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-04T18:47:51.450

使用后缀数组或后缀数组怎么样？[您可以在此处](http://sary.sourceforge.net/)找到一个具有坚持使用类似 grep 选项的优势的实现，尽管我从未使用过它，也无法证明它的效率和易用性。

后缀树/数组需要预处理将在 O(n) 到 O(n log n) 时间内搜索的文件（n 是查找文件的长度），并且后缀树/数组本身将比原始文件（常数因子），但有磁盘绑定算法，它们经常用于搜索整个人类基因组（几 GB）。然后在文件中搜索字符串只需要 O(m) 时间，其中 m 是字符串的长度，这比 grep (O(n log m)?) 快得多。由于您似乎会多次搜索同一个文件，因此对后缀树/数组所需的预处理步骤的投资可能是值得的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-08T18:20:25.030

结合上面提到的一些想法，我提出了一个两遍系统，使用`grep`和合并结果`join`如下：

**模式**

```
The sun is shining!
It is a beautiful day! 
```

**抬头**

```
Rain
Sun
Cloud
Beautiful
Is 
```

**脚本**

```
grep -i -o -n -f lookup patterns > tmp1
grep -i -n -f lookup patterns > tmp2
join -t ':' -o 1.2,2.2 tmp1 tmp2 | sed -e 's/:/,/' 
```

产生以下结果

```
sun,The sun is shining!
is,The sun is shining!
is,It is a beautiful day!
beautiful,It is a beautiful day! 
```

如果您想要查找匹配和模式逗号分隔的输出，这里有一个可以工作的小型 python 2.x 脚本。它将查找读入缓冲区，并通过模式。

**脚本.py**

```
import sys, re

lookups = [re.compile(l.strip(),re.I) for l in open(sys.argv[1])]
for line in open(sys.argv[2]):
    for lookup in lookups:
        if lookup.search(line):
            print "{0},{1}".format(lookup.pattern, line), 
```

运行`python script.py lookup patterns`产量：

```
Sun,The sun is shining!
Is,The sun is shining!
Beautiful,It is a beautiful day!
Is,It is a beautiful day! 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-03-29T13:47:03.790

这可能不会更快，但您可以尝试：

```
for i in `cat lookup_file`; 
  do  
    tmpv=`grep -i ${i} pattern_file | xargs echo ${i},`; 
    echo ${tmpv} | sed '/^$/d'; 
done 
```

# vb.net - 将 ActiveFilterString 子句添加到 DevExpress GridView CustomFilterRow

> ID：15704236
> 
> 赞同：0
> 
> 时间：2013-03-29T13:28:00.987
> 
> 标签：vb.net, gridview, devexpress, .net-2.0

我有 DevExpress `GridView`，我有一个数据表作为数据源。现在我有一个隐藏列，用于使用`CustomFilterRow`事件过滤视图。现在的问题是，当用户放入任何过滤器时，它会被忽略，因为`e.Handled`事件`CustomFilterRow`设置为`True`. 我想要的是还使用用户的过滤器字符串过滤视图，使我的过滤器保持活动状态，即无论用户提供什么过滤器，它都将始终添加我最初在`CustomFilterRow`事件中提供的过滤器算法。

```
Private Sub GridView_Dept_CustomRowFilter(ByVal sender As Object, ByVal e As DevExpress.XtraGrid.Views.Base.RowFilterEventArgs) Handles GridView_Dept.CustomRowFilter
    If IsLoadComplete = False Then
        Exit Sub
    End If
    Dim view As GridView = CType(sender, GridView)
    Dim dv As DataView = view.DataSource
    If Not IsEqual(dv(e.ListSourceRow).Item("EXUSER"), Me.GridViewUser.GetFocusedRowCellValue("EXUSER")) Then
        e.Visible = False
        e.Handled = True
    End If
End Sub 
```

DevExpress - 9.2 .Net - 2.0 VS - 2008

PS - 由于公司政策，我不允许升级到更高版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T09:11:35.943

才知道答案。如果我将 写`e.Handled =True`为事件的最后一行，它总是被执行，那么用户自定义过滤器总是被忽略，但如果我`e.Handled = True`在我的自定义条件块中写入，那么一切正常。

因此，任何在事件参数对象中具有`e.Handled`属性的事件，请小心将`e.Handled`属性设置为`True`. 您应该始终确保将`e.Handled`属性设置为`True`仅在满足覆盖默认功能的条件内。将`e.Handled`属性设置`True`为函数末尾将始终覆盖默认功能，这可能不是所需的行为。

# bit-shift - 循环整数中的每个字节

> ID：15704241
> 
> 赞同：0
> 
> 时间：2013-03-29T13:28:19.420
> 
> 标签：bit-shift, bits

我试图创建一个函数，以整数形式旋转每个字节（我在整数中只设置了一个位，并且最后一个字节没有使用）但是我把这个堆叠起来我到目前为止

```
private int RotateBytes(int num,int length)
{     
  int mask = 0x00818181;
  mask &= num;
  int newnum = num<<length;

} 
```

# css - 简单的垂直多级菜单

> ID：15704244
> 
> 赞同：2
> 
> 时间：2013-03-29T13:28:32.777
> 
> 标签：css, menu, submenu

我正在寻找一些非常简单的垂直多级菜单，但我没有找到任何东西。例如，我对菜单的想法是这样的：

```
<ul id="menu">
<li><a href="#">Item 1</a></li>
<li class="parent"><a href="#">Item 2</a>
    <ul>
        <li> <a href="#">Sub 1</a></li>
        <li> <a href="#">Sub 2</a></li>
    </ul>
</li>
<li><a href="#">Item 3</a></li>
<li><a href="#">Item 4</a></li>
<li><a href="#">Item 5</a>
    <ul>
        <li> <a href="#">Sub 1</a></li>
        <li> <a href="#">Sub 2</a></li>
    </ul>
</li>
<li><a href="#">Item 6</a></li> 
```

我想首先隐藏所有子类别。如果我单击某个类别，页面将加载，并且带有 class="parent" 的类别将显示其类别。我的问题是，我怎样才能只用 css 来达到这个目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:31:38.980

这基本上是悬停菜单的工作原理；`<ul>`默认隐藏并在悬停时显示。

[jsFiddle](http://jsfiddle.net/uHfLL/)

```
#menu li > ul {
    display:none;
}

#menu li:hover > ul {
    display:block;
} 
```

如果您也想`.parent`显示，只需将其与悬停规则一起放入：

[jsFiddle](http://jsfiddle.net/uHfLL/1/)

```
#menu li:hover > ul,
#menu li.parent > ul{
    display:block;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:36:40.240

要隐藏您需要将这些添加到 css 文件的子类别

```
#menu li > ul { display:none;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:31:57.360

```
#menu ul li ul {display: none;}
#menu ul li.parent ul {display: block;} 
```

# git - 不使用git客户端通过http协议访问github

> ID：15704248
> 
> 赞同：0
> 
> 时间：2013-03-29T13:28:53.893
> 
> 标签：git, github, wget

我一直在尝试更多地了解 git 内部结构，特别是协议。我知道如何使用 git 客户端，但我想尝试在没有它的情况下使用 git 协议以了解更多信息。当我尝试跑步时

```
wget https://github.com/git/git.git/info/refs 
```

或在浏览器中访问 url 我得到一个 403 禁止。为什么我在尝试读取文件时需要进行身份验证？有没有解决的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:20:13.877

该 URL 将与[github 禁用](https://github.com/blog/809-git-dumb-http-transport-to-be-turned-off-in-90-days)的 git 的愚蠢 HTTP 方法一起使用。您需要使用托管在其他地方的存储库来处理它。使用 github，您需要使用更新的智能 HTTP 传输。

# php - 如何从一个html中插入mysql选择多个

> ID：15704252
> 
> 赞同：-2
> 
> 时间：2013-03-29T13:29:05.830
> 
> 标签：php, mysql

如何从 HTML 中插入 MySQL 选择多个

这是我的代码 HTML：

```
<select name="domaine[]" id="domaine" class="validate[required]" multiple>
            <option></option>
            <option value="WEB">WEB</option>
            <option value="Java2EE">Java2EE</option>
            <option value="android">android</option>
            <option value="VB.Net">VB.Net</option>
            <option value="iOS">iOS</option>
            <option value="C++">C++</option>
</select> 
```

这是我的 php 代码：

```
try{
        $cdb=new PDO('mysql:host=localhost;dbname=source', 'root','');

}  catch (Exception $e){
    die("erreur".$e->getMessage());

}  
$cin=$_SESSION['cin'];

$rep=$cdb->prepare("insert into dev (cin,comp)values('$cin','".$_POST["domaine"]."')");
$rep->execute(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:40:04.037

您使用 PDO 非常好，但您的代码仍然容易受到攻击。 `VALUES`接受多个参数。

```
if (isset($_POST['domaine']) && is_array($_POST['domaine'])) {
    //(?,?),(?,?),(?,?) for 3 domaine
    $values = implode(',', array_fill(0, count($_POST['domaine']), '(?,?)'));
    $query = "INSERT INTO dev (cin, comp) VALUES $values";
    $params = array();
    foreach ($_POST['domaine'] as $d) {
        array_push($params, $cin, $d);
    }
    $rep = $cdb->prepare($query);
    $rep->execute($params);
} 
```

您也可以`prepare`使用单个`INSERT`语句和循环`execute`，但我相信这更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:50:04.237

`$_POST["domaine"]`是一个**数组**，因此将其“按原样”放置将导致数据库记录中的“数组”。您需要确定哪种类型的“array->string”方法最适合您的应用程序并在插入数据库之前使用它。

最简单的方法是使用`join($sep, $_POST['domaine'])`or `serialize($_POST['domaine'])`。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-29T13:31:31.713

```
foreach ( $_POST["domaine"] as $aSelectedOption){
$rep=$cdb->prepare("insert into dev (cin,comp)values('$cin','".$aSelectedOption."') ");
$rep->execute();
} 
```

这将为每个选中的选项插入一个条目

你也可以使用 json_encode 和 json_decode 虽然我不建议这样做。

# c++ - MFC CListCtrl 拖动文件到 Windows 资源管理器

> ID：15704254
> 
> 赞同：1
> 
> 时间：2013-03-29T13:29:23.597
> 
> 标签：c++, winapi, visual-c++, mfc, explorer

我正在编写一个 MFC 应用程序。

我想将文件从`CListCtrl`我的应用程序中拖到 Windows 资源管理器中。

怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T10:04:00.170

您需要连接`LVN_BEGINDRAG`以检测拖放的开始，然后使用填充了文件信息`DoDragDrop`的基于数据源进行调用（最容易处理的格式是）。Windows shell 处理其他一切。`IDataObject``CF_HDROP`

幸运的是，在 MFC 课程中已经为您完成了很多腿部工作`COleDataSource`。还有一些很好的例子：

[代码项目 - 如何在您的程序和资源管理器之间实现拖放](http://www.codeproject.com/Articles/840/How-to-Implement-Drag-and-Drop-Between-Your-Progra)

[MSDN - 使用拖放和剪贴板传输外壳对象](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb776905%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T16:47:23.117

您需要`OnDrop()`在`CListCtrl`派生类中重写并提供`COleDataSource`.

# javascript - Meteor.js 部署到“example.com”还是“www.example.com”？

> ID：15704266
> 
> 赞同：29
> 
> 时间：2013-03-29T13:30:05.343
> 
> 标签：javascript, mongodb, dns, meteor, web-deployment

我最近使用以下命令部署了一个流星应用程序：

```
$ meteor deploy example.com 
```

后来（认为它是相同的）使用以下内容：

```
$ meteor deploy www.example.com 
```

它最终为应用程序的两个不同版本提供服务，一个托管在“example.com”中，另一个托管在“www.example.com”中。

我可以恢复其中一个部署吗？我应该恢复哪一个？

如果没有，我应该在我的域提供商上设置什么样的配置？

谢谢你，若奥

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-29T15:37:00.760

当人们访问您的页面时，您希望他们看到**mydomain.com**还是**www.mydomain.com**？

如果它是*mydomain.com*，那么您想设置您的 DNS 区域文件，其中包含`A`指向 IP 的域的记录`origin.meteor.com`

如果它是*www.mydomain.com*，那么您希望为`CNAME`指向的子域“www”设置 DNS 区域文件`origin.meteor.com`

然后，您希望将“域转发”从其中一个选项设置为另一个选项。例如，我将[http://playlistparty.net](http://playlistparty.net)设置为转发到[http://www.playlistparty.net](http://www.playlistparty.net)。

在此之后，您只需运行：

```
meteor deploy www.playlistparty.net 
```

您可以使用 --delete 选项删除不会使用的部署。

```
meteor deploy www.playlistparty.net --delete 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-29T13:57:40.127

### 在自定义域名上部署

将流星部署到您的域名：

```
meteor deploy mydomain.com 
```

将 *.mydomain.com 或 www.mydomain.com（如果您只想设置 www 子域）和 mydomain.com 的 CNAME 记录设置为：`origin.meteor.com`

或者

将 *.mydomain.com 和 mydomain.com 的“A”记录指向 : `107.22.210.133`。

**要删除您可能不小心输入的现有文件：**

```
meteor deploy www.mydomain.com --delete 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-12-28T13:33:23.670

好的，我找到了一个简单的方法：

如果您希望 www 重定向到非 www，您可以使用此方法。您也可以稍微修改代码以换一种方式。

简单设置

```
@ (CNAME) : origin.meteor.comm
www (CNAME) : origin.meteor.com 
```

然后，部署您的主应用程序（不带 www）。

```
meteor deploy yourapp.com 
```

现在，创建一个名为 redirect 的新流星应用程序

```
meteor create redirect
cd redirect 
```

设置生成的 js 文件内容如下：

```
if (Meteor.isClient) {
  var url = document.URL;
  url = url.replace("www.", "");
  window.location.href = url;
} 
```

然后部署您的重定向应用程序（使用 www）

```
meteor deploy www.yourapp.com 
```

您所做的是，您将两个不同的应用程序部署到您的域的 www 和非 www。www 上的流星应用程序所做的只是将您重定向到非 www 域。它还将**www.yourapp.com/some/path**重定向到**yourapp.com/some/path**。简单而强大的解决方案:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-27T00:09:55.120

我对此进行了很多谷歌搜索，所以我将分享最终为我工作的内容。我正在寻找所有查询以转到我网站的 HTTPS 和 www 版本。只是设置 CNAME 实际上并没有更改为重定向到 www 版本。我在 Modulus 上托管并最终执行了以下操作：

1.  强制 HTTPS

    *   Modulus 有一个 HTTPS 重定向，否则我已经使用 Force-SSL 包和 NGINX 在以前未托管在 Modulus 上的应用程序中成功地做到了这一点。
2.  指向主机 IP 的域

    *   设置您的域、example.com、A 记录以指向我们的托管 IP。
    *   为“www”子域设置我的 CNAME 以指向相同的 IP。
3.  强制 www

    *   将环境变量 ROOT_URL 设置为`'https://www.example.com'`
    *   下载规范包：[https ://atmospherejs.com/wizonesolutions/canonical](https://atmospherejs.com/wizonesolutions/canonical)

# python - 使用特定项目的值向熊猫数据框添加新列？

> ID：15704274
> 
> 赞同：6
> 
> 时间：2013-03-29T13:30:44.363
> 
> 标签：python, pandas

我有这个熊猫数据框：

```
d=pandas.DataFrame([{"a": 1}, {"a": 3, "b": 2}]) 
```

并且我正在尝试根据数组中的数字索引向它添加一个仅针对某些行的非空值的新列。例如，仅将新列“c”添加到中的第一行`d`：

```
# array of row indices
indx = np.array([0])
d.ix[indx]["c"] = "foo" 
```

这应该将“foo”添加为第一行的列“c”值，并为所有其他行添加 NaN。但这似乎并没有改变数组：

```
d.ix[np.array([0])]["c"] = "foo"
In [18]: d
Out[18]: 
   a   b
0  1 NaN
1  3   2 
```

我在这里做错了什么？如何做呢？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:51:51.233

```
In [11]: df = pd.DataFrame([{"a": 1}, {"a": 3, "b": 2}])

In [12]: df['c'] = np.array(['foo',np.nan])

In [13]: df
Out[13]: 
   a   b    c
0  1 NaN  foo
1  3   2  nan 
```

如果您要分配数值，则以下内容将起作用

```
In [16]: df['c'] = np.nan

In [17]: df.ix[0,'c'] = 1

In [18]: df
Out[18]: 
   a   b   c
0  1 NaN   1
1  3   2 NaN 
```

# c++ - 何时在编译过程中内联函数

> ID：15704275
> 
> 赞同：2
> 
> 时间：2013-03-29T13:30:44.717
> 
> 标签：c++, compiler-construction, inline

在`gcc`, 使用

*   `-E`给出预处理后的代码；
*   `-S`，汇编代码；
*   `-c`，代码已编译，但未链接。

是否有任何接近 a 的东西`-I`，可以让我查看函数是否已内联，即查看代码扩展，就好像内联函数是预处理宏一样？

如果没有，我应该通过汇编代码，还是稍后执行内联应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:33:51.630

我认为检查汇编代码是查看内联内容的最佳（而且几乎是唯一）方法。

请记住，在某些情况下，某些内联可能会在链接时发生。请参阅[链接器可以内联函数吗？](https://stackoverflow.com/questions/5987020/can-the-linker-inline-functions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:42:16.950

您可以使用该`-Winline`选项来查看函数是否不能被内联并且它被声明为内联。

引自[http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options)

`-Winline Warn if a function that is declared as inline cannot be inlined. Even with this option, the compiler does not warn about failures to inline functions declared in system headers. The compiler uses a variety of heuristics to determine whether or not to inline a function. For example, the compiler takes into account the size of the function being inlined and the amount of inlining that has already been done in the current function. Therefore, seemingly insignificant changes in the source program can cause the warnings produced by -Winline to appear or disappear.`

但是，`inline`不是命令， `inline`函数与否（尽管声明为`inline`）由编译器决定。`It may consider the size of the function being inlined and how many times inline already been done in the current function.`

查看一个函数是否真的存在的最好方法`inlined`是检查汇编代码。例如，您可以使用

gcc -O2 -S -c foo.c

生成汇编代码`foo.c`并输出汇编代码文件`foo.s`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T13:40:16.653

这里的问题是，通常内联是链接时间优化（当有多个目标文件时），因为编译器在链接时间之前根本看不到其他目标文件中的函数实现。

因此，在多目标文件编译中，您最好的办法是检查生成的程序集，但是在每个目标文件中，内联是可能的，假设要内联的函数在同一个编译单元中，但是大多数编译器不这样做内联点，因为它不知道可以从哪里调用这个函数，以及它本身是否应该被内联。

因此，通常内联是在链接时执行的，但是对于非常小的函数，它可以而且应该在编译时完成。

我也相信，如果你用 clang/llvm 编译你的代码，你会得到带有内联的 ac 输出文件，虽然我还没有尝试过。

请注意，为了让 GCC 进行链接时间优化（包括内联），您必须为其提供一个参数，我认为它是 -flto。

另一种方法是让所有内联函数在所有编译单元中可见（例如在头文件中），这实际上通常会确保内联，以避免在不同的目标文件中多次声明同一函数。

检查程序集是否内联的一种简单方法是将源代码中对函数的调用次数与程序集中的调用次数进行比较。

# c++ - QDataStream 有时使用 32 位，有时使用 40 位浮点数

> ID：15704276
> 
> 赞同：2
> 
> 时间：2013-03-29T13:30:48.730
> 
> 标签：c++, wav, qt4.8

我正在编写一个应用程序，该应用程序应该将浮点数组写入 WAVE 文件。我为此使用了 QDataStream，但这会导致我无法解释的非常不可能的输出。似乎 QDataStream 有时会选择 32 位浮点数，有时会选择 40 位浮点数。这会弄乱整个输出文件，因为它必须遵守严格的格式。

我的代码大致如下所示：

```
float* array;
unsigned int nSamples;

void saveWAV(const QString& fileName) const 
{
    QFile outFile(fileName);
    if (outFile.open(QIODevice::WriteOnly | QIODevice::Text)) 
    {
        QDataStream dataStream(&outFile);
        dataStream.setByteOrder(QDataStream::LittleEndian);
        dataStream.setFloatingPointPrecision(QDataStream::SinglePrecision);

        // ... do all the WAV file header stuff ...

        for(int ii = 0; ii < nSamples; ++ii) 
            dataStream << array[ii];
    }
} 
```

我想不出为什么这段代码会产生这样的副作用。所以我做了一个最小的例子来了解发生了什么。我用这个替换了for循环：

```
float temp1 = 1.63006e-33f;
float temp2 = 1.55949e-32f;

dataStream << temp1;
dataStream << temp1;
dataStream << temp2;
dataStream << temp1;
dataStream << temp2; 
```

然后我使用 Matlab 打开输出文件并查看写入文件的字节。那些是：

```
8b 6b 07 09      // this is indeed 1.63006e-33f (notice it's Little Endian)
8b 6b 07 09 
5b f2 a1 0d 0a    // I don't know what this is but it's a byte to long
8b 6b 07 09 
5b f2 a1 0d 0a 
```

我非常随意地选择了这些值，它们恰好具有这种效果。一些值导出为 4 字节，而另一些值导出为 5 字节数字。有谁知道这可能是什么原因？

**编辑：** 当检查两个花车的大小时，它们看起来确实有 4`char`秒长，不过：

```
 qDebug() << sizeof(temp1); // prints '4'
    qDebug() << sizeof(temp2); // prints '4' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T16:20:19.570

答案在于打开输出文件：`QIODevice::Text`标志应该被忽略，因为它是一个二进制文件。如果包含 text-flag，`0d`则在每个`0a`. 因此，每个包含`0a`字符的浮点数似乎都`char`更长。

此答案的所有学分都归于以下给出的答案： [浮点长度在 32 和 40 位之间变化](https://stackoverflow.com/questions/15768405/length-of-float-changes-between-32-and-40-bit?lq=1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:51:56.343

注意：我不是 100% 确定我在下面，并且很想听到我错了，但我认为是这样的：

[`QDataStream`](http://qt-project.org/doc/qt-4.8/qdatastream.html)有它自己的序列化格式，虽然我没有检查，但可能与此有关。关键是，它并不意味着你想用它做什么：只写任何二进制格式。您可以使用该类，但我相信您只需要使用[`writeRawData()`](http://qt-project.org/doc/qt-4.8/qdatastream.html#writeRawData)方法，并自己处理字节顺序等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T21:17:08.177

即使我没有使用 IODevice::Text 标志，我也遇到了类似的问题。我发现添加一行

```
dataStream.device()->setTextModeEnabled(false); 
```

解决了问题以确保您处于二进制模式。

# playlist - 声音管理器 2 和播放列表自动播放下一首歌曲不起作用

> ID：15704277
> 
> 赞同：1
> 
> 时间：2013-03-29T13:30:50.623
> 
> 标签：playlist, soundmanager2

我有一个文字 JS 对象来创建和播放我的播放列表。在 HTML 页面中，我有一个包含所有曲目的列表。当我单击某个曲目时，一切正常，但是当我单击一个曲目并等待曲目结束时，下一首曲目无法播放。这是我的代码的一部分：

```
 playSound : function(track){
        console.log("Play this song");

        DG_PLAYER.TrackPlaying = track;

        soundManager.destroySound('MySoundID');

                DG_PLAYER.Sound =   soundManager.createSound({
                                        id:'MySoundID',
                                        url:track.sound,
                                        autoLoad: true,
                                        autoPlay: true,
                                        onload: function() { console.log('sound loaded!', this); },
                                        onfinish: function(){
                                            console.log('end song');
                                    var nextSong = DG_PLAYER.getNextSong();
                                            DG_PLAYER.playSound(nextSong);
                                        },
                                        onfailure : function(){console.log('some error')},
                                        whileloading : function(){console.log('i m loading');},
                                        whileplaying : function(){console.log('i m playing');}
                                    });

    }, 
```

如果我像这样更改 onfinish 事件的行： setTimeOut(function(){DG_PLAYER.playSound(nextSong);},2000) 它工作正常。有人可以帮助我吗？

另一件事是，当第一首歌曲完成并为下一首歌曲调用 Play 时，该曲目未加载（onload 事件没有返回消息）。谢谢，对不起我的英语不好。一种。

好的，我尝试在设置中添加“flashVersion：9”，这可以解决问题，但在 IE 8 上我现在有 un action script 消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:00:09.327

[来自 SoundManager2 的修订历史](http://www.schillmania.com/projects/soundmanager2/doc/download/#revision-history)：

> Adobe 于 2013 年 2 月 26 日发布的 Flash Player 11.6.602.171 引入了 SM2 的默认 Flash 8 (flashVersion: 8) 基于 API 的 JS/Flash 交互的问题，其中从回调等调用的 SM2 方法`onfinish()`不起作用。这主要破坏了用于顺序播放声音、串行加载一系列声音等的方法。（有关更多信息，请参阅[讨论](https://getsatisfaction.com/schillmania/topics/recent_chrome_update_seems_to_have_broken_my_sm2_audio_player)。）
> 
> 请注意，这不会影响`soundManager.setup({ flashVersion: 9})`正在使用的情况；但是，SM2`flashVersion: 8`默认使用。
> 
> 具体来说，Flash 启动的事件（例如声音结束）使 Flash -> JS 调用 SM2 API，随后调用用户指定的事件处理程序。如果用户指定的 SM2`onfinish()`处理程序立即调用类似 play() 的 SM2 方法，该方法进行 JS -> Flash 调用，则此调用要么静默失败，要么被阻塞。其他使用类似回调模式的 JS + Flash 库也可能会受到影响，如果它们的 SWF 是针对 Flash 8 API 构建的。
> 
> 怀疑是时序或递归/堆栈问题，发现`setTimeout(callback, 0)`向用户指定的 SM2 回调引入了一个类似`onfinish()`恢复的顺序/播放列表功能。
> 
> Adobe 于 2013 年 3 月 12 日发布的 Flash Player 11.6.602.180 表现出相同的行为。为避免额外的黑客攻击，SM2 将此应用于所有基于 Flash 8 的 API 回调，无论安装的是什么版本的 Flash Player。由于这一变化，预计不会出现倒退。
> 
> 或者，这个问题可以通过使用来避免，`soundManager.setup({ flashVersion: 9 })`因为基于 Flash 9 的 API 似乎没有这个问题。

# python - Python循环遍历一系列变量

> ID：15704280
> 
> 赞同：8
> 
> 时间：2013-03-29T13:30:53.660
> 
> 标签：python

我有许多变量 iE: `x1`to`x10`

现在我想得到他们每个人的内容。

是否可以将变量放在一起`xi`？还是我应该只使用列表？

我相信这里的语法有点迷失了！类似的事情就是我在想的：

```
while i <= 10:
    print(test+i) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-29T13:33:04.273

```
variables = [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9]
for x in variables:
    print x 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-29T13:35:03.570

如果您不想使用列表...

```
for i in range(10):
    print(eval("x" + str(i))) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-29T13:31:58.760

你应该只使用一个列表。然后，您将能够使用循环遍历[`for`元素](http://www.tutorialspoint.com/python/python_for_loop.htm)。

您还可以通过 index: 来处理元素`x[i]`。请记住，列表索引从零开始，而不是从一开始。如果索引不是小的连续整数，您可能需要考虑使用字典而不是列表。

# html - 在这种情况下哪个是正确的 html 标签

> ID：15704281
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:30:56.733
> 
> 标签：html, css

我打算将图像添加到输入字段中，因此如果您单击该图像，则输入字段中的文本将清晰可见。

我打算使用绝对定位。我的问题是哪个 html 标签最适合这种情况？

这是我使用的代码。

```
<DOCTYPE html>
    <head>
        <title></title>
        <style>
            #search_form {
                width: 380px;
                height: 110px;
                position: relative;
                background: -webkit-gradient(linear, left top, left bottom, from(#43689a), to(#6399e7));

            }

            #search_form input {
                width: 300px;
                height: 30px;
                border-radius: 18px;
                border: 1px solid #ccc;
                margin-left: 70px;
                margin-top: 40px;
                padding-left: 36px;
            }

            #search_form input:focus {
                outline: none;
            }
            #search_form button {
                position: absolute;
                width: 16px;
                height: 16px;
                background: url(f.png) no-repeat 50% 50%;
                border: 0;
                top: 47px;
                left: 85px;
                cursor: hand;
                text-indent: -9999px;
            }

        </style>
    </head>
    <body>
        <div id="search_form">
            <form>
            <input type="text" placeholder="Search....">
            <button>Submit</button>
        </form>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:34:27.570

除了使用`<img>`标签之外，您还可以将图像放置在输入字段的背景中。

```
 #search_form input { background:url(../imagepath/image.jpg); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:35:36.980

### `<img>`

通常，您会希望对大多数图像工作使用`<img>`标签。

```
<img src="blah.png" /> 
```

### CSS`background-image`

你也可以使用一个普通的并在 CSS 中`<div>`设置它的规则。`background-image`

**HTML**

```
<div class="handsome-bg"></div> 
```

**CSS**

```
.handsome-bg {
    background-image:url(blah.png);
} 
```

### 哪一个？

两者都有优势和劣势，但一般都坚持`<img>`。例如，`<img>`更麻烦的事情是根据屏幕尺寸或密度选择不同的图像（我想在视网膜显示器上使用高分辨率图像）。

# php - Php - 监听端口 - 但按需运行

> ID：15704288
> 
> 赞同：0
> 
> 时间：2013-03-29T13:31:18.157
> 
> 标签：php, sockets, client, listener, long-running-processes

我不确定任何技术术语，但我认为我正在以一种可以理解的方式描述这一点。

我将编写一个 php 脚本，它会监听一个端口，并根据需要发送数据，即一个基本的游戏监听过程。网上有很多地方都有这方面的提示，所以我想我会没事的，但欢迎对教程提出任何进一步的建议。

那不是我的问题。这是：

我想要做的是拥有一个**不会**自动运行此脚本的服务器。相反，我想要的是当有人在他们的客户端上启动游戏时，它将进行测试以查看我的服务器上是否已经运行了一个监听脚本，如果没有，它将启动它。（我还不知道该怎么做，但我不认为这太难了。只需将一些数据发送到该端口，看看是否有响应。）

然后当其他人加入时，他们将看到在服务器上运行的脚本并使用它，而不是启动他们自己的。

这个想法有问题吗？

如果第一个人退出，脚本会关闭吗？

让“第一个玩家”启动脚本并对脚本提出不关闭的要求会更好吗？（即脚本将永远运行，直到服务器重新启动 - 基本上我的服务器不介意我运行长时间运行的脚本，只要它们不使用太多处理，但它们不允许我启动脚本-up 如果服务器重新启动。）

这个永远运行的脚本会避免任何“第一玩家”关机问题吗？

如果两个人在检查脚本是否正在运行时被认为是“第一个玩家”，但其中一个人比另一个人早几毫秒启动脚本，这肯定会在服务器上创建两个脚本，导致一种听的回声效果。我将如何克服这一点？

乔恩

# .htaccess - .htaccess 从 url 中删除模式

> ID：15704294
> 
> 赞同：0
> 
> 时间：2013-03-29T13:31:50.907
> 
> 标签：.htaccess

有没有办法从 url 中删除一些模式？

例如，这是我的模式`-=-something_dynamic-=-` ，这是我的网址

```
_http://mysite.com/category/-=-something_dynamic-=-subcategory/ 
```

我希望成为

```
_http://mysite.com/category/subcategory/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:37:42.833

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^(category)/.*?(subcategory)/?$ /$1/$2/ [L,NC,NE,R=301] 
```

# php - 无法从数组写入 csv

> ID：15704295
> 
> 赞同：0
> 
> 时间：2013-03-29T13:31:50.970
> 
> 标签：php, parsing, csv

我阅读了大多数关于我的问题的讨论，但我没有找到解决方案。所以，我有一个 .csv 文件，我从中读取、提取所有内容并填充一个多维数组。那就是我为此编写的代码：

```
 if (($handle = fopen("dateRegion.csv", "r")) !== FALSE) {
 # Set the parent multidimensional array key to 0.
 $pr = 0;
  while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
    # Count the total keys in the row.
    $count = count($data);
    # Populate the multidimensional array.
    for ($x = 0; $x < $count; $x++) {
        $brim[$pr][$x] = $data[$x];
    }
 $pr++;
  }
fclose($handle); 
```

}

之后，我提取我需要的元素并将其放入另一个数组中。该数组将是新 .csv 文件的内容。

这是代码：

```
 $parserCsv = array();
      $dip=1;
       do {
        $region = $brim[$dip][7];
        $sex = $brim[$dip][8];
        $frequency = $brim[$dip][9];
        $value = $brim[$dip][10];
        $parserCsv[] = array($region, $sex, $frequency, $value);
      $dip++;
       } while($dip <= 6336); 
```

这是数组的“var_dump()”：

```
Array(
[0] => Piemonte
[1] => maschi
[2] => 2005
[3] => 16.972) 
```

等等

我尝试使用 fputcsv() 方法将数组 $parserCsv 的内容与该脚本一起放入：

```
$fp = fopen('csvExtract.csv', 'w');
 foreach ($parserCsv as $fields) {
  fputcsv($fp, $fields);
 }
fclose($fp); 
```

但它没有用。文件 csvExtract.csv 的内容为空白。我不明白我的错误，我尝试了其他解决方案，例如创建数组 $parserCsv，例如：

```
 $parserCsv = array(
    array($region), array($sex), array($frequency), array($value)); 
```

什么都没有改变。有人有什么建议吗？

编辑：使用 mkjasinski 建议的解决方案编辑代码！该代码现在正在运行。感谢所有的答复。

布鲁斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:39:47.347

试试这个：

```
if (($handle = fopen("dateRegion.csv", "r")) !== FALSE) {
    # Set the parent multidimensional array key to 0.
    $pr = 0;
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        # Count the total keys in the row.
        $count = count($data);
        # Populate the multidimensional array.
        for ($x = 0; $x < $count; $x++) {
            $brim[$pr][$x] = $data[$x];
        }
        $pr++;
    }
    fclose($handle);
} 
```

还有这个：

```
$parserCsv = array();
$dip=1;
do {
    $region = $brim[$dip][7];
    $sex = $brim[$dip][8];
    $frequency = $brim[$dip][9];
    $value = $brim[$dip][10];
    $parserCsv[] = array($region, $sex, $frequency, $value);
    $dip++;
} while($dip <= 6336); 
```

并保存：

```
$fp = fopen('csvExtract.csv', 'w');
foreach ($parserCsv as $fields) {
    fputcsv($fp, $fields);
}
fclose($fp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:39:37.563

你有一些错误吗？文件是否在其他软件中打开？（比如 MS Excel？）

以下代码在 CSV 中输入 4 条记录

```
$parserCsv = array(
   array('Piemonte'),
   array('maschi'),
   array(2005),
   array(16.972)
);

$fp = fopen('blah.csv', 'w');
foreach($parserCsv as $fields)
{
   fputcsv($fp, $fields);
}
fclose($fp); 
```

# angularjs - Angular UI Bootstrap 对话框宽度

> ID：15704296
> 
> 赞同：20
> 
> 时间：2013-03-29T13:31:53.860
> 
> 标签：angularjs, angular-ui, angular-ui-bootstrap

Angular UI 引导对话框易于实现，但难以定制。

你到底是怎么改变宽度的？甚至最大宽度？

[http://angular-ui.github.com/bootstrap/#/dialog](http://angular-ui.github.com/bootstrap/#/dialog)

我已经尝试过`$dialog.dialog({width:600})`和其他变化，但没有快乐。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-01-05T14:01:22.553

For version 0.8/0.9 the layout has changed so you do not specify the modal class, I fiddled a little around with it and found that I you can use a nested CCS definition like this:

```
.xx-dialog .modal-dialog {
    width :90%;
    min-width: 800px;
} 
```

And the when you launch the modal dialog specify the windowsStyle like this:

```
modalInstance = $modal.open({
        templateUrl: 'templates/editxxx.html',
        controller: EditXXCtrl,
        windowClass: 'xx-dialog',
        resolve: {
            xx_uuid: function () {
                return xx_guid;
            }
        }
    }); 
```

But be aware that the windowsstyle is for the WHOLE window including the backdrop . Hope it helps

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-09T16:22:54.127

默认的 CSS 类是`modal`，使用`dialogClass`选项（或`options`属性，如果你使用`modal`指令）来指定额外的 CSS 类，例如：

```
$dialog.dialog({dialogClass: 'modal modal-huge'}); 
```

对于模态指令：

```
<div modal="modalVisible" close="close()" 
     options="{dialogClass:'modal modal-huge'}">
   <div class="modal-header"><h3>Hello</h3></div>
   <div class="modal-body">Hello world!</div>
   <div class="modal-footer">
        <button ng-click="dialogs.escolherModelo=false" 
                class="cancel btn btn-warning">Cancel</button>
   </div>
</div> 
```

如果您弄乱了对话框宽度，为了使对话框居中，CSS 规则需要`margin-left`宽度的一半的负数：

```
.modal-huge {
    width: 80%;
    margin-left: -40%;
}
@media (max-width: 600px) {
    .modal-huge {
        width: 580px;
        margin-left: -290px;
    }
} 
```

[更新]

> 它现在被称为 windowClass 并且您的 css 规则应该用于内部 .modal-dialog，所以它就像 - .modal-huge .modal-dialog – SET

哎呀，似乎在 javascript 世界中什么都没有解决。这是未经测试的：

```
$dialog.dialog({windowClass: 'modal-huge'}); 
```

对于模态指令：

```
<div modal="modalVisible" close="close()" 
     options="{windowClass:'modal-huge'}">
   <div class="modal-header"><h3>Hello</h3></div>
   <div class="modal-body">Hello world!</div>
   <div class="modal-footer">
        <button ng-click="dialogs.chooseModel=false" 
                class="cancel btn btn-warning">Cancel</button>
   </div>
</div> 
```

如果您弄乱了对话框宽度，为了使对话框居中，CSS 规则需要`margin-left`宽度的一半的负数：

```
.modal-dialog .modal-huge {
    width: 80%;
    margin-left: -40%;
}
@media (max-width: 600px) {
    .modal-dialog .modal-huge {
        width: 580px;
        margin-left: -290px;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-29T13:45:35.387

检查浏览器控制台中的对话框将看到宽度仅使用 css 设置。文档中的选项允许在正文和/或对话框上使用用户定义的类名，以便您可以针对页面内的各种类型进行调整

文档参考：[https ://github.com/angular-ui/bootstrap/blob/master/src/modal/docs/readme.md](https://github.com/angular-ui/bootstrap/blob/master/src/modal/docs/readme.md)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-15T01:57:42.540

以下是我如何使用 $dialog 服务以角度向模态对话框添加另一个类：

```
var opts = {
    backdrop: true,
    keyboard: true,
    backdropClick: true,
    templateUrl: 'my-partial.html',
    controller: 'MyPartiallController',
    dialogClass: 'modal myWindow'
};
var d = $dialog.dialog(opts);
d.open(); 
```

对话框将以 class="modal myWindow" 打开 - 注意您必须包含 'modal' 否则对话框内容将出现在背景下方。

然后使用这个 css 你可以改变宽度：

```
.modal.myWindow {
    width:700px;
    margin-left:-350px
} 
```

您必须包括宽度 1/2 的负左边距，否则它将偏离中心。

# .net - LESS 与文化代码结合使用

> ID：15704301
> 
> 赞同：1
> 
> 时间：2013-03-29T13:31:58.970
> 
> 标签：.net, css, less

我正在构建一个多语言网站，需要在页面上切换一些 CSS 来处理不同的语言。我正在将文化代码粘贴到页面中，并且正在寻找一种方法来使用它来引用仅用于该语言的不同选择器。我想知道有没有人为此目的使用过 LESS。如果您有任何提示或教程，请发布。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:35:56.657

我没有将它用于这种国际化。但是您可以通过将`.culture-code`类添加到`<html>`元素来轻松地设置样式：

```
 /* default */
 body {
  background:white;
 }

/* these only apply to the body element when your culture code class is applied to the page */
.culture-code body {
  background:red;
}
.culture-code-2 body {
  background:blue;
} 
```

如果您要为每个文化代码使用*非常*不同的样式表，您可以创建不同的较少样式表，以文化代码命名它们，然后使用您的后端语言导入该样式表。但是，希望您只进行细微的调整:)

# php - PHP SocketServer 不接受超过 255 个并发连接

> ID：15704309
> 
> 赞同：0
> 
> 时间：2013-03-29T13:32:34.940
> 
> 标签：php, windows, windows-server-2008, socketserver

我在 Windows Server 2008 机器上运行 PHP (5.4.12) 脚本。当并发连接总数达到 255 时，脚本崩溃。

在 PHP 5.2.x 系统上，SocketServer 以错误结束：“尝试对不是套接字的东西进行操作。”

PHP 5.4.12，不会崩溃，但不再处理连接。

我正在使用以下代码，取自 PHP.net 网站： http: [//php.net/manual/en/sockets.examples.php](http://php.net/manual/en/sockets.examples.php)

```
 <?php
error_reporting(E_ALL);
set_time_limit(0);
ob_implicit_flush();

$address = '192.168.1.7';
$port = 8676;

if (($sock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP)) === false) {
    echo "socket_create() last error " . socket_strerror(socket_last_error()) . "\n";
}
if (socket_bind($sock, $address, $port) === false) {
    echo "socket_bind() last error " . socket_strerror(socket_last_error($sock)) . "\n";
}

if (socket_listen($sock, 5) === false) {
    echo "socket_listen() last error " . socket_strerror(socket_last_error($sock)) . "\n";
}

$clients = array();

do {
    $read = array();
    $read[] = $sock;

    $read = array_merge($read,$clients);

    $write = NULL;
    $except = NULL;
    if(socket_select($read,$write , $except , $tv_sec = 5)===false)
    {
        echo(PHP_EOL.'\n\ncrash\n\n'.PHP_EOL);
        exit();
    }

    if (in_array($sock, $read)) {        

        if (($msgsock = socket_accept($sock)) === false) {
            echo "socket_accept() falló: razón: " . socket_strerror(socket_last_error($sock)) . "\n";
//            break;
        }
        $clients[] = $msgsock;
        $key = array_keys($clients, $msgsock);
        $msg = "{$key[0]} welcome msg\n".PHP_EOL;
        socket_write($msgsock, $msg, strlen($msg));

    }

    // Handle Input
    foreach ($clients as $key => $client) { // for each client        
        if (in_array($client, $read)) {
            if (false === ($buf = socket_read($client, 2048))) {
                echo "socket_read() last error: " . socket_strerror(socket_last_error($client)) . "\n";
//                break 2;
            }
            if (!$buf = trim($buf)) {
                continue;
            }
            if ($buf == 'quit') {
                $talkback = print_r($clients);
                socket_write($client, $talkback, strlen($talkback));
                unset($clients[$key]);
                socket_close($client);
                break;
            }
            if ($buf == 'shutdown') {
                socket_close($client);
                break 2;
            }
            $talkback = "Client {$key}: Echo: '$buf'.\n";
            socket_write($client, $talkback, strlen($talkback));
            echo "$buf\n";
        }

    }        
} while (true);

socket_close($sock);
?> 
```

我已经通过运行“EchoServerTest.exe”测试了脚本。我创建了许多并发连接。

一开始我以为是WinSock的问题，但是找不到WinSock有255个连接的限制。

我还更改了注册表设置 TcpNumConnections、TcpTimedWaitDelay 和 MaxUserPort。

我在 Ubuntu 服务器上使用了相同的代码，所以问题与 Windows 有很大关系。我在两台不同的服务器上进行了测试，都是 Windows Server 2008（32 位和 64 位）。一个在本地，一个在互联网上。所以应该排除防火墙或其他外部问题。

我别无选择。

在你问之前，你真的需要这么多连接吗？是的。有很多“死”连接，所以我修改了代码。现在那些“死”连接现在“超时”。所以我有一些时间来解决这个问题，但最终并发连接数会再次达到255。

关于这个有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-27T12:32:42.473

我认为问题出在这一行：

```
if (socket_listen($sock, 5) === false) { 
```

您手动将排队等待处理的积压传入连接数限制为 5。在 Linux 中，这被默默地截断为`SOMAXCONN`，而不是在 Windows 上。尝试使用`SOMAXCONN`而不是 5。

# android - 基于位置的警报数据库

> ID：15704312
> 
> 赞同：1
> 
> 时间：2013-03-29T13:32:45.050
> 
> 标签：android, sqlite, reminders, location-based

我有个问题。我想在 android 设备中制作基于位置的提醒/警报。我已经尝试对其进行编码。但它不起作用。我尝试根据地理编码器用户位置匹配 sqlite 中的数据和地址。

这里是数据库适配器查询

```
public void postCheck(String addr) {
    openConn();
    Cursor cur = db.rawQuery("select " + ALAMAT + " from " + TableName, null);
    if(addr == ALAMAT && cur != null) {
        cur.moveToFirst();
        Toast.makeText(konteks, "Anda ada tugas",
                    Toast.LENGTH_LONG).show();
    } else {
        Toast.makeText(konteks, "Anda tidak ada tugas",  
                    Toast.LENGTH_LONG).show();
    }
    closeConn();
} 
```

这是活动中的代码

```
public void cekTugas() {
    //cek tugas
    if(alamat != "") {
        dbHandler.postCheck(alamat);
    }
} 
```

我把它放在 onCreate 的线程之后

```
//thread untuk menjalankan LBS
    timer = new Timer();
    timer.schedule(new TimerTask() {
        Handler handlerLokasi = new Handler(Looper.getMainLooper());

        @Override
        public void run() { 
            // TODO Auto-generated method stub
            handlerLokasi.post(new Runnable() {

                @Override
                public void run() {
                    // TODO Auto-generated method stub
                    cekLokasi();
                }
            });
        }
    }, 0, 300000);

    //cek tugas
    cekTugas(); 
```

谢谢你的帮助...

# microsoft-metro - Metro App 识别 Segoe UI 符号中的所有表情符号

> ID：15704315
> 
> 赞同：0
> 
> 时间：2013-03-29T13:32:57.130
> 
> 标签：microsoft-metro, winrt-xaml, emoticons

有没有办法列出**Segoe UI Symbol**字体中的所有表情符号？

我可以得到所有的符号没有问题，但我如何识别其中哪些是表情符号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:57:52.280

据我所知，没有直接的方法可以做到这一点。通过一些谷歌搜索，我想出了：

表情符号 => Segoe UI 符号 (87)

表情符号：2639-263b, 2661, 2665, 2764, 1f48b, 1f48f-1f49f, 1f600-1f64f（您可以检查 unicode 范围以验证它是否是表情符号）

☹☺☻ ♡ ♥ ❤

您可能最好使用charmap + 进行体力劳动并将它们硬编码到您的应用程序中，因为无论如何它的工作量并不大。

资料来源：

[http://en.wikipedia.org/wiki/User:ChristTrekker/UnicodeSymbol](http://en.wikipedia.org/wiki/User:ChristTrekker/UnicodeSymbol)

[http://en.wikipedia.org/wiki/Emoji](http://en.wikipedia.org/wiki/Emoji)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T09:12:47.253

有一个很棒的应用程序叫做[Xaml Candy](http://apps.microsoft.com/windows/en-us/app/xaml-candy/8b9e2d69-feed-409c-befb-4ea97f97351a)，看看吧。必须有开发者的应用程序。选择应用栏图标很有帮助。免责声明：我不是这个应用程序的开发者，也不是推广它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T19:09:53.980

在 Windows8 中，标准应用程序“符号表”

# ssl-certificate - 在 Tcl 中将客户端证书发送到服务器

> ID：15704321
> 
> 赞同：0
> 
> 时间：2013-03-29T13:33:08.273
> 
> 标签：ssl-certificate, tcl

目前我的应用程序（在 C 中）使用 SSL 证书对 Web 服务器进行身份验证。我现在将大部分功能（如果不是全部）移至 Tcl。

我找不到任何关于如何做到这一点的教程或示例（我更喜欢使用 Tcl ::http:: 但 TclCurl 会很好）。

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T17:24:15.580

Johannes 的回答是对的，除非您想为不同的站点提供不同的身份。在这种情况下，您可以使用，它允许您在调用该命令之前`tls::init`设置默认的 TLS 相关选项。`tls::socket`

```
package require http
package require tls
http::register https 443 ::tls::socket

# Where is our identity?
tls::init -keyfile "my_key.p12" -cafile "the_server_id.pem"

# Now, how to provide the password (don't know what the arguments are)
proc tls::password args {
    return "the_pass";  # Return whatever the password is
}

# Do the secure connection
set token [http::geturl https://my.secure.site/]

# Disable the key
tls::init -keyfile {} 
```

Note that the way of providing the password *is* bizarre, and I know for sure that this mechanism isn't going to be nice when doing asynchronous connections. (There's a standing Feature Request for improving the integration between the http and tls packages…)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T15:36:12.307

要将 https 与 tcl 一起使用，您通常使用该[`tls`](http://tls.cvs.sourceforge.net/viewvc/tls/tls/tls.htm?revision=HEAD)包。[http 包](http://www.tcl.tk/man/tcl8.6/TclCmd/http.htm#M44)的手册页为您提供了如何执行此操作的示例：

```
package require http
package require tls

::http::register https 443 ::tls::socket

set token [::http::geturl https://my.secure.site/] 
```

如果您阅读[tls](http://tls.cvs.sourceforge.net/viewvc/tls/tls/tls.htm?revision=HEAD#tls%3a%3aimport)包的文档`tls::socket`，您会发现有一些选项可以通过客户端证书。结合起来给你：

```
::http::register https 443 [list ::tls::socket \
        -cafile caPublic.pem -certfile client.pem] 
```

`-password`如果证书文件受密码保护，您可能必须指定回调参数。

请注意，此解决方案对来自您的应用程序的每个 https（无论目标如何）请求都使用客户端证书。

**编辑**：正如 Donal 所建议的，使用它可能`tls::init`比使用`::http::register`.
一个例子：

```
package require http
package require tls

::http::register https 443 ::tls::socket

proc ::get_cert_pass {} {
     return "passw0rd"
}

# Add the options here
::tls::init -cafile caPublic.pem -certfile client.pem -password ::get_cert_pass
set tok [::http::geturl https://my.secure.site/] 
```

要发出请求，请始终使用最后 2 行。

# java - 为表动态创建表行

> ID：15704323
> 
> 赞同：0
> 
> 时间：2013-03-29T13:33:14.360
> 
> 标签：java, android

我正在尝试从设备 SD 卡上存储的数据填充我的游戏的高分表。

这是我的`LeaderboardActivity.java`：

```
public class LeaderboardActivity extends Activity {
private Leaderboard leaderboard;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_leaderboard);

    TableLayout highscoresTable = (TableLayout) findViewById(R.id.highscoresTable);
    this.leaderboard = new Leaderboard();

    ArrayList<Player> players = leaderboard.getScores();
    if(!(players==null))
    {
        Collections.sort(players);

        for(Player p:players)
        {
            TableRow newRow = new TableRow(this);
            TextView name = new TextView(this);
            TextView time = new TextView(this);

            name.setText(p.getName());
            name.setGravity(Gravity.CENTER_VERTICAL);
            name.setPadding(15, 0, 15, 0);
            time.setText(p.getTime());
            time.setGravity(Gravity.CENTER_VERTICAL);
            time.setPadding(15, 0, 15, 0);

            newRow.addView(name);
            newRow.addView(time);
            highscoresTable.addView(newRow);
        }
        setContentView(highscoresTable);
    }
    else
    {
        Log.i("DEBUG", "players is equal to null!");
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_leaderboard, menu);
    return true;
}
} 
```

这是我的 XML `activity_leaderboard.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@color/background"
android:orientation="horizontal" > 
```

```
<TableLayout
    android:id="@+id/highscoresTable"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="15dp" >

    <TableRow
        android:id="@+id/headerRow"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="center_vertical|fill_horizontal"
        android:showDividers="middle" >

        <TextView
            android:text="NAME"
            android:gravity="center_vertical"
            android:padding="15dp">
        </TextView>

        <TextView
            android:gravity="center_horizontal|center_vertical"
            android:padding="15dp"
            android:text="TIME" />

    </TableRow>

    <TableRow
        android:id="@+id/testRow"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:text="TEST"
            android:gravity="center_vertical"
            android:paddingLeft="15dp"
            android:paddingRight="15dp">
        </TextView>

        <TextView
            android:gravity="center_horizontal|center_vertical"
            android:paddingLeft="15dp"
            android:paddingRight="15dp"
            android:text="NOT REAL" />

    </TableRow>

</TableLayout>

</LinearLayout> 
```

出于某种原因，当我运行我的排行榜时，它会导致`RuntimeException`

我怎样才能得到这个工作？

* * *

### 更新

根据要求，这是我的日志：

```
03-29 13:45:41.136: E/AndroidRuntime(9894): FATAL EXCEPTION: main
03-29 13:45:41.136: E/AndroidRuntime(9894): java.lang.RuntimeException: Unable to start activity ComponentInfo{*.*.*.*/*.*.*.*.LeaderboardActivity}: android.content.res.Resources$NotFoundException: String resource ID #0x77
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.os.Looper.loop(Looper.java:123)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread.main(ActivityThread.java:4627)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at java.lang.reflect.Method.invokeNative(Native Method)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at java.lang.reflect.Method.invoke(Method.java:521)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at dalvik.system.NativeStart.main(Native Method)
03-29 13:45:41.136: E/AndroidRuntime(9894): Caused by: android.content.res.Resources$NotFoundException: String resource ID #0x77
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.content.res.Resources.getText(Resources.java:201)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.widget.TextView.setText(TextView.java:2817)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at *.*.*.*.LeaderboardActivity.onCreate(LeaderboardActivity.java:44)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-29 13:45:41.136: E/AndroidRuntime(9894):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
03-29 13:45:41.136: E/AndroidRuntime(9894):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:52:31.793

您的`p.getTime()`方法返回一个`int`. 使用此`int`值`setText()`会使`TextView`您认为您正在使用引用`string`资源的 id 设置文本，而这很可能不是这种情况。而是使用：

```
time.setText(String.valueOf(p.getTime())); 
```

# asp.net - 设计具有多行和多列的自定义下拉菜单

> ID：15704324
> 
> 赞同：0
> 
> 时间：2013-03-29T13:33:14.943
> 
> 标签：asp.net, html, jquery-ui, css

我有一个要求，如图所示。任何人都可以帮助我实现这一目标。

简介：单击按钮时，应打开一个窗格，其中包含包含文本的行和列，单击它时需要执行适当的操作。源也可以是动态的......![语言下拉](../Images/a26b3c2227188946aaa9322b956ef8da.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:44:18.390

有许多技术可以实现这种设计。你可以完全使用 html 和 css 来完成，方法是让一个看起来像下拉弹出窗口的图像在下面有一个绝对定位的 div。[或者，您可以使用名为“ PopupControl](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/PopupControl/PopupControl.aspx) ”的 asp.net ajax 控件工具包控件，该控件基本上将所有 html/css 抽象出来，允许您只指定一个目标面板。还有各种 jquery 插件，这里是[abeatifulsite](http://labs.abeautifulsite.net/jquery-dropdown/)的一个。

# jquery - 主干和引导日期选择器

> ID：15704329
> 
> 赞同：0
> 
> 时间：2013-03-29T13:33:30.290
> 
> 标签：jquery, ruby-on-rails, backbone.js, datepicker

我有一个 Rails 应用程序，我正在尝试在我的视图中添加一些交互式内容。所以我有一个用于 datepicker 的 bootstrap-datepicker-rails gem 和用于数据处理的主干.js。但是当我尝试收听 datepicker 的 'changeDate' 事件时，我得到了一些错误。视图中的挂钩事件根本不起作用，只是不会调用该方法：

```
events: 
  'changeDate #dpstart': 'tryit'

tryit: ->
  console.log(this)
  this 
```

当我尝试在路由器中捕获事件时，我无法访问我的收藏：

```
initialize: ->
    @datepicker = $('#dpstart').datepicker({
      "format": "yyyy-mm-dd",
      "weekStart": 1,
      "autoclose": true
      })       
    @datepicker.on('changeDate', @refetch, this) 
```

这样会产生错误，因为它无法获取**此**上下文，并且

```
initialize: ->
    @datepicker = $('#dpstart').datepicker({
      "format": "yyyy-mm-dd",
      "weekStart": 1,
      "autoclose": true
      })       
    @datepicker.on('changeDate', @refetch) 
```

这种方式工作正常，但在@refetch 中我没有获得主干上下文，因此无法访问模型。我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:40:59.517

要么自己绑定上下文（因为你[有](http://underscorejs.org/#bind)下划线或lowdash）。或者使用Backbone 的[这个方法](http://backbonejs.org/#Events-listenTo)来做你的绑定（更好）。

关于为什么第一个没有被调用，请确保 datepicker 方法返回的内容是您将其绑定到的 jQuery 元素 ($('#dpstart'))。我不这么认为，所以你基本上听错了我的假设。

# c# - 设置将字符串保存到本地文件夹 winRT 中的文件的最大文件大小

> ID：15704333
> 
> 赞同：2
> 
> 时间：2013-03-29T13:33:33.893
> 
> 标签：c#, logging, windows-8, windows-runtime

有谁知道是否可以为我在我的应用程序本地文件夹中创建的文件设置最大文件大小（用于 WinRT 应用程序）。在这一点上，我制作了一个这样的 StorageFile：

```
private StorageFile m_StorageFile = null;

m_StorageFile = await ApplicationData.Current.LocalFolder.CreateFileAsync("Myfile.log",
                                                                              CreationCollisionOption.OpenIfExists); 
```

但我希望本地文件夹中的文件的最大大小为 10MB。因此，当它变大时，它应该清除旧条目或清除自身。

我找到了许多关于您可以写入本地文件夹文件的最大大小的答案，但没有一个描述如何为本地文件夹中的文件设置最大文件的答案。

我需要这个，因为我正在尝试实现登录到我的应用程序，我曾经能够在 web.config 文件中设置它，如下所示：

```
<maximumFileSize value="10MB" /> 
```

使用 Log4Net 但这尚未更新到 .Net 框架 4.5 这就是为什么我遵循本教程的原因，他们提供了替代方案，但我找不到有关最大文件大小的任何信息，链接到教程

[http://code.msdn.microsoft.com/windowsapps/Logging-Sample-for-Windows-0b9dffd7](http://code.msdn.microsoft.com/windowsapps/Logging-Sample-for-Windows-0b9dffd7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T09:12:16.000

在查看了@Igor 留下的评论后，我想出了使用以下代码解决我的问题的方法：

```
IRandomAccessStream sessionRandomAccessFile1 = await this.m_StorageFile1.OpenAsync(FileAccessMode.Read);
                IRandomAccessStream sessionRandomAccessFile2 = await this.m_StorageFile2.OpenAsync(FileAccessMode.Read);

                if (sessionRandomAccessFile1.Size == 0)
                {
                    await FileIO.AppendLinesAsync(m_StorageFile1, lines);
                }
                else if (sessionRandomAccessFile1.Size < 5000000)
                {
                    if (sessionRandomAccessFile1.Size > 4999900 )
                    {
                        await m_StorageFile2.DeleteAsync();
                        AssignLocalFile();
                    }
                    await FileIO.AppendLinesAsync(m_StorageFile1, lines);

                }
                else if (sessionRandomAccessFile2.Size < 5000000)
                {
                    if (sessionRandomAccessFile1.Size > 5000000 && sessionRandomAccessFile2.Size > 4999900)
                    {
                        await m_StorageFile1.DeleteAsync();
                        AssignLocalFile();
                    }
                    await FileIO.AppendLinesAsync(m_StorageFile2, lines);

                } 
```

在方法assignlocalfile中，我只是在删除它们后创建新文件：

```
 private async void AssignLocalFile()
    {
        m_StorageFolder = await ApplicationData.Current.LocalFolder.CreateFolderAsync("VakantieApplicatie", CreationCollisionOption.OpenIfExists);
        m_StorageFile1 = await m_StorageFolder.CreateFileAsync(m_Name.Replace(" ", "_") + "1.log",
                                                                                CreationCollisionOption.OpenIfExists);
        m_StorageFile2 = await m_StorageFolder.CreateFileAsync(m_Name.Replace(" ", "_") + "2.log",
                                                                                CreationCollisionOption.OpenIfExists);
    } 
```

这样，我的最大总大小为 10MB，当一个 5MB 的文件已满时，它将切换到另一个而不删除前一个文件，因为您在搜索错误时可能需要它（在记录的情况下），当其他 5 MB 已满，它将清除第一个并再次开始在那里写入，因为在 5 MB 的错误记录之后，我认为您将不再需要该数据。

# load-balancing - 在负载均衡器连接之前运行脚本

> ID：15704335
> 
> 赞同：2
> 
> 时间：2013-03-29T13:33:47.510
> 
> 标签：load-balancing, haproxy

好吧，所以我想我会问很棒的 stackoverflow 社区，看看我是否能得到答案。

我的问题是，我想运行一个脚本，特别是 php，但只要连接进入 haproxy，我就可以在技术上执行任何类型。如果需要，我可以更改我的负载平衡软件，也可以使用非负载平衡软件。

事件顺序

*   通过 haproxy 尝试连接
*   haproxy 看到它是某个端口/端口范围
*   haproxy 触发脚本
*   haproxy 像它应该的那样转发连接。

这怎么可能？此外，脚本需要在转发流量之前触发

我想有人会问，所以我会提前解释。我有一个在线游戏，但我不希望它一直运行。如果有人尝试连接，它会通过 api/脚本启动游戏。

更新***** 我在考虑逻辑。您可以做的是设置一个服务来侦听游戏服务器上的这些端口，然后当它看到连接时运行关闭侦听器并启动游戏的脚本，但如果游戏关闭，您可能希望自动重新启动侦听器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T11:05:17.563

我真的不明白你的逻辑......为什么你要这样做......

以下是显示如何配置 HAproxy 以触发 xinetd 脚本的 URL。我知道这确实是您想要的，但至少它会给您提供确切解决方案的线索。

[http://sysbible.org/2008/12/04/have-haproxy-check-mysql-status-through-a-xinetd-script/](http://sysbible.org/2008/12/04/having-haproxy-check-mysql-status-through-a-xinetd-script/)

# java - 如何在 Spring 应用程序的响应中正确返回图像？

> ID：15704342
> 
> 赞同：5
> 
> 时间：2013-03-29T13:34:05.837
> 
> 标签：java, image, spring, httpresponse

我正在为我的 web 应用程序使用 Spring 3.0.1.RELEASE（我无法升级它），并且我正在尝试从网页上的数据库中呈现一些图像。

我有以下简单的 Spring 配置：

弹簧应用程序.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:task="http://www.springframework.org/schema/task"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd">

    <task:annotation-driven />

    <context:annotation-config />

    <context:spring-configured />

    <context:component-scan base-package="com.me" />

    <bean id="hibernateSessionFactory" class="com.me.dbaccess.HibernateSessionFactory">
        <constructor-arg ref="sessionFactory"/>
    </bean>
</beans> 
```

弹簧-mvc.xml：

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <mvc:annotation-driven/>

    <bean id="tilesViewResolver" class="com.me.util.TilesExposingBeansViewResolver">
        <property name="viewClass" value="com.me.util.TilesExposingBeansView"/>
        <property name="exposeContextBeansAsAttributes" value="true"/>
    </bean>

    <bean id="tilesConfigurer"
          class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
        <property name="definitions">
            <list>
                <value>/WEB-INF/config/tiles-defs.xml</value>
            </list>
        </property>
    </bean>
</beans> 
```

我有以下控制器：

```
@Controller
public class PhotoController {
    @RequestMapping("/carPhoto.html")
    @ResponseBody
    public byte[] getCarPhoto(
            @RequestParam(UrlParameters.PHOTO_ID) Integer photoId,
            @RequestParam(UrlParameters.PHOTO_TYPE) String photoType) {
        //return image's bytes array from db by photo Id and Type;
    }
} 
```

最后，我有一个简单的 jsp 页面：

```
<%@page contentType="text/html; charset=utf-8"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<img id="photoImage" src="<c:url value="/carPhoto.html?photoType=1&photoId=22556793"/>" /> 
```

如果我打开此页面 - 我可以毫无问题地看到此图像。

但是，如果我复制图像“src”属性并将其粘贴到浏览器的地址栏（Firefox 19.0.2）中，那么浏览器会为我提供保存 carPhoto.html，而不仅仅是渲染图像。我应该执行一些额外的设置吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-30T08:55:40.917

问题是，您必须指定 mime 类型（如果您的图像较大，您也需要指定其长度）。

另一种解决方案 () 是返回[Spring`ResponseEntity`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/http/ResponseEntity.html)或[`HttpEntity`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/http/HttpEntity.html)（如果您始终返回 http 状态代码 200，则 HttpEntity 就足够了，如果您想返回其他 http 状态代码，例如未找到，则需要 ResponseEntity（HttpEntity 的子类））。

```
@Controller
public class PhotoController {
    @RequestMapping("/carPhoto.html")
    @ResponseBody
    public HttpEntity<byte[]> getCarPhoto(
            @RequestParam(UrlParameters.PHOTO_ID) Integer photoId,
            @RequestParam(UrlParameters.PHOTO_TYPE) String photoType) {

        byte[] image = image's bytes array from db by photo Id and Type;

        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.IMAGE_JPEG); //or what ever type it is
        headers.setContentLength(image.length);
        return new HttpEntity<byte[]>(image, headers);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T14:20:56.583

有几种方法。最简单的方法是使用带有 byte[] 的 @ResponseBody 作为返回类型，设置 Content-Type 等，然后使用 HttpServletResponse 将字节写入输出流。

一个更优雅的解决方案 (IMO) 将返回一个 ModelAndView，然后将其上的视图设置为自定义视图，该视图设置正确的标头（Content-Type 等）并将字节写入 HttpServletResponse 的输出流。

* * *

# android - 许多活动中包含的常见迷你活动

> ID：15704344
> 
> 赞同：0
> 
> 时间：2013-03-29T13:34:14.090
> 
> 标签：android, android-mediaplayer

我正在制作一个音乐播放器应用程序。我需要在许多其他活动中显示一个小型音乐播放器，例如 List_of_tracks_activity、Song_details_activity 等。像这样：

![在此处输入图像描述](../Images/74b517099ade5188728904ef2fe85904.png)

有什么方法可以让我为这个迷你播放器创建一个单独的活动并简单地包含在我需要的所有其他活动中。

或者，我必须在所有活动中包含代码。

而且，有没有关于我应该如何为此设计布局的教程？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:37:34.703

为此目的使用片段。Fragment 具有一些属性，例如活动和视图。 [在这里查看更多信息](http://developer.android.com/guide/components/fragments.html)，它很容易实现并且非常有用。

# asp.net - sessionState 超时不适用于 DefaultSessionProvider

> ID：15704356
> 
> 赞同：4
> 
> 时间：2013-03-29T13:34:54.117
> 
> 标签：asp.net, web-config

我有一个网站，我使用 ASP.NET 成员资格来管理用户创建、登录、角色管理。我使用 Visual Studio 2012。在 web.config 中有很多由 Visual Studio 创建的元素。与会话状态相关的元素之一如下。

```
sessionState mode="InProc" customProvider="DefaultSessionProvider"

name="DefaultSessionProvider" type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" 
```

在[这个链接](http://msdn.microsoft.com/en-us/library/h6bb9cz9%28v=vs.100%29.aspx)中，它说`Custom provider is used when mode is set to Custom`。第一个问题是，如果是这种情况，为什么 Visual Studio 将会话状态的模式属性生成为 InProc 并同时设置自定义提供程序？第二个问题是会话状态超时。当我向会话状态添加超时值时，时间到了它不会超时。

```
sessionState mode="InProc" customProvider="DefaultSessionProvider" timeout="30" 
```

当我删除 CustomProvider 属性时，超时开始工作。有人对这种情况有更多了解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T17:14:46.193

我意识到有关超时的问题与 CustomProvider 属性无关。问题是表单超时和会话状态超时被设置为不同的值。一旦我将它们设置为相同的值，它就开始工作了。

但是 Visual Studio 使用 mode = InProc 和 customProvider = DefaultSessionProvider 创建 sessionState 元素的事实仍然很奇怪，因为 Microsoft 网站说唯一使用 customProvider 的时间是 mode 设置为 Custom 时。

# android - 安卓。收到短信时选中另一个活动中的复选框

> ID：15704357
> 
> 赞同：0
> 
> 时间：2013-03-29T13:34:55.180
> 
> 标签：android, android-activity, checkbox, sms

（对不起我的英语）我有一张带有 telit gt864-quad 调制解调器 GSM 的 Picdem.net2 开发卡。当连接到开发卡的东西出现问题（例如水控制器的问题）时，开发卡会向我的安卓手机发送一条短信，以阻止我。

当短信到来时，它应该显示一个通知，并选中另一个名为“etat”（状态）的活动中的“警报”复选框。SMS 活动名为“SMSReceive”。

所以实际上我可以接收短信，它会带来一个警报通知，如果我点击它，谁会引导到应用程序。但我不知道如何检查复选框...

(CheckBox)findViewById(R.id. ...) 不起作用。

```
package com.example.locatiris;

import android.net.Uri;
import android.os.Bundle;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.Activity;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.BroadcastReceiver;
import android.content.res.Resources;
import android.support.v4.app.NotificationCompat;
import android.telephony.SmsMessage;
import android.widget.Toast;
import android.app.PendingIntent;
import android.widget.CheckBox;

public class SMSReceive extends BroadcastReceiver
{
CheckBox water = null;
private static final int Notification_ID = 1234;
private static final String ACTION = "android.provider.Telephony.SMS_RECEIVED";

    public void onReceive(Context context, Intent intent)
    {

    Bundle bundle = intent.getExtras();
    //SMS pdus = format de SMS
    Object messages[] = (Object[]) bundle.get("pdus");
    SmsMessage smsMessage[] = new SmsMessage[messages.length];

    for(int i=0; i<smsMessage.length; i++)
    {
        smsMessage[i] = SmsMessage.createFromPdu((byte[])messages[i]);
        //récupérer le numéro
     String msg_from = smsMessage[i].getOriginatingAddress();
     //Récuperer message
     String msg_cont = smsMessage[i].getMessageBody();

        if(msg_from.equals("+33NUMBER") & msg_cont.contains("water"))
        {
            Toast toast = Toast.makeText(context,
            "Message reçu " + smsMessage[0].getMessageBody(),
            Toast.LENGTH_LONG);
            toast.show();
             //faire une action lors de réception
            createNotification(context);

        }                    
    }
}

} 
```

以下是如何开始“etat”活动：

```
public class etat extends Activity// implements View.OnClickListener
{
EditText Chau = null;
EditText Vann = null;
EditText Serr = null;
EditText Digi = null;
Button Actu = null;

@Override
public void onCreate(Bundle savedInstanceState) 
{ ... 
```

这是通知创建者：

```
private final void createNotification(Context context2)
{
    //vibreur spécial
    long[] a = {0, 200, 200, 200, 500, 200, 500, 200, 200, 500, 200 };

    //creer notification et ses parametres
    NotificationCompat.Builder builder =  
            new NotificationCompat.Builder(context2)  
    .setSmallIcon(R.drawable.ic_launcher)
    .setTicker("Problème location détecté")
    .setWhen(System.currentTimeMillis())
    .setAutoCancel(true)
    .setVibrate(a)
    .setSound(Uri.parse("file:///sdcard/Music/ZOUZ2.mp3"))
    .setContentTitle("ALERTE Location")
    .setContentText("Un problème est survenu dans la location");

    //ouvrir l'application au clic sur notification
    Intent notificationIntent = new Intent(context2, MainActivity.class);  
    PendingIntent contentIntent = PendingIntent.getActivity(context2, 0, notificationIntent,   
            PendingIntent.FLAG_UPDATE_CURRENT);  
    builder.setContentIntent(contentIntent);  

    NotificationManager manager = (NotificationManager) context2.getSystemService(Context.NOTIFICATION_SERVICE);  
    manager.notify(Notification_ID, builder.build());  
} 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:46:41.710

在通知单击时使用以下代码来调用活动

```
Intent intent = new Intent(this, etat.class);
intent.putExtra("isSMSReceived", true/false);
startactivity(intent) 
```

在您的活动中使用此代码

```
Intent intent = getIntent();
boolean state = intent.getBooleanExtra("isSMSReceived");

CheckBox cb = (CheckBox)findViewById(R.id. ...);
cb.setChecked(state); 
```

# wordpress - 停止 wordpress 修订并自动保存到页面

> ID：15704359
> 
> 赞同：2
> 
> 时间：2013-03-29T13:35:02.310
> 
> 标签：wordpress, revision

Wordpress 修订和自动保存正在将我的更改恢复到 wordpress 页面。不管我做了多少改变，总是回到那个点。

是否有一些解决方案可以停止这样做但不禁用对所有站点的修订。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T14:16:35.983

要**禁用自动保存**，请将下面的代码放在您的 functions.php 中。

```
function disableAutoSave(){
     wp_deregister_script('autosave');
}
add_action( 'wp_print_scripts', 'disableAutoSave' ); 
```

要**禁用后期修订**，请将以下代码放入您的 wp-config.php 文件中。

```
define( 'WP_POST_REVISIONS', false ); // no revisions 
```

**注意：使用上述代码将禁用整个站点的自动保存和/或发布修订。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T09:07:51.817

我相信正确的代码应该是如上代码抛出通知消息。

```
add_action( 'admin_init', 'disable_autosave' );
function disable_autosave() {
    wp_deregister_script( 'autosave' );
} 
```

# jquery - jquery中的连接错误

> ID：15704363
> 
> 赞同：0
> 
> 时间：2013-03-29T13:35:09.807
> 
> 标签：jquery, html, dom, attr

我的`jquery`代码有这个问题。我需要它将一个`jquery`变量值连接到一个 html 属性`href`。然而，它不断返回`[object%20Object]`实际变量值的位置。

这是我的jQuery。

```
var searchValname = $("input#name"); 
var alink = $("a#name");
alink.click(function(){ 
    alink.attr("href","searchDBfiltered.php?type=hospitalnumber&val=" + searchValname);
}); 
```

预计将返回`searchDBfiltered.php?type=hospitalnumber&val= (variable value)`。它反而显示`[object%20Object]`. 请问有什么问题吗？我用谷歌搜索了这个没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:37:03.517

这是因为您当前正尝试将实际的 #name 对象插入链接中，而您确实需要该值。

```
var searchValname = $("input#name").val(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:38:44.193

jQuery 对象就是这样 - 对象。当您将一个对象连接到一个字符串时，`toString()`会调用一个隐式函数，除非另有定义，否则它将返回`"[object Object]"`.

如果您尝试连接输入的值，您应该使用`.val()`：

```
alink.attr("href","searchDBfiltered.php?type=hospitalnumber&val=" +
    searchValname.val());
//               ^^^^^^ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:37:07.190

尝试更新第一行：

```
var searchValname = $("input#name").val(); 
var alink = $("a#name");
alink.click(function(){ 
alink.attr("href","searchDBfiltered.php?type=hospitalnumber&val=" + searchValname);
}); 
```

# ios - Cocos2d 2.0：“清除”缓存的最佳实践是什么时候？

> ID：15704367
> 
> 赞同：3
> 
> 时间：2013-03-29T13:35:24.243
> 
> 标签：ios, memory-management, cocos2d-iphone, automatic-ref-counting, cctexturecache

在每个场景的开头调用以下“清除”方法是一种好习惯吗？如果不是，我什么时候应该给他们打电话，是否有任何教程解释何时使用每个电话？我错过了什么吗？

```
 [CCTextureCache purgeSharedTextureCache];
    [CCSpriteFrameCache purgeSharedSpriteFrameCache];
    [CCAnimationCache purgeSharedAnimationCache];
    [CCShaderCache purgeSharedShaderCache];
    [[CCFileUtils sharedFileUtils] purgeCachedEntries]; 
```

（我正在使用 Cocos2d 2.0 并且启用了 ARC，不认为它是相关的，但仍然认为值得一提）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T17:33:22.600

**IMO 完全清除 cocos2d 的缓存是不好的做法！**清除缓存是一种有用的工具，就像锤子在修理电子设备时一样有用。

清除所有内容只是让角色在下一帧中重新加载他们清除的动画和纹理是适得其反的，因为他们需要它们！如果您无条件地清除缓存，那么您还没有完成资产内存管理工作（好吧）。

仍然可以使用来清除所有内容，但它们应该很少见（比如在 UIKit 应用程序中完全关闭 cocos2d） - 因为你为什么要删除**所有缓存的资源**？你删除了你添加的内容，如果这还不够，你已经做了尽可能多的事情。

作为应用程序开发人员，您应该了解应用程序的总内存使用量以及哪些资产正在使用，哪些未使用。包括cocos2d处理的资源。仅发布您知道当前未使用且在不久的将来也不需要的那些资产。真的就这么简单，但它比简单地清除缓存更费力——这似乎可以完成这项工作，但实际上是一件很糟糕的事情。

在内存警告期间专门清除缓存的一个问题是，当您当前预加载资产时可能会出现内存警告。现在，当您在加载资产时清除缓存时，您是在自找麻烦，因为已经预加载的资产将被删除，然后需要在需要时再次加载。在最坏的情况下，如果由于首先加载资产所需的额外内存而立即发生重新加载，这实际上会导致不可恢复的内存警告（即，纹理在加载时会使用 2 倍内存，而加载时间很短！）。

在大多数情况下，清除缓存只会延迟与内存警告相关的终止，同时会增加游戏的延迟。在其余情况下，它只会在游戏口吃恢复时造成糟糕的体验，可能需要更长的时间。

Cocos2D 在内存警告期间清除缓存只是作为最后的手段，主要针对那些不会关心诸如内存使用之类的废话的开发人员。这是一个适用于最初几个应用程序开发步骤的解决方案，甚至可能适用于开发人员的第一个应用程序，但对于任何认真/雄心勃勃的努力来说实际上几乎没有用处。

作为一个关注质量的雄心勃勃的应用程序开发人员，您应该以更优雅的方式对内存警告做出反应。这意味着您首先要努力完全减少内存警告（[这里有一些提示](http://www.learn-cocos2d.com/2012/11/optimize-memory-usage-bundle-size-cocos2d-app/)），当它们确实发生时，您需要确保两件事：

1.  您的应用程序可能很快就会终止 - 请务必保存应用程序的状态。
2.  您释放任何您绝对确定此时不需要的内存。

关于#2：如果您正在编程接近边缘，您可能希望回退到某种“内存安全”模式，在该模式下完全调低应用程序的内存使用量，例如通过显示更少的精灵、粒子、结合使用两个纹理，以额外的加载时间为代价移除某些纹理等。

如果您无法通过第 2 步释放足够的内存，那么第 1 步几乎不可避免地会发生，无论您是否清除 cocos2d 的缓存。清除 CCTextureCache 的“未使用”纹理会有所帮助，但由于精灵帧保留了纹理，因此如果您使用纹理图集而不首先释放相应的精灵帧，它通常不会做太多（或什么都不做）。记在脑子里。

因此，处理内存警告的过程是：

1.  知道哪些资产正在使用，哪些只是被缓存以减少加载时间。
2.  移除“当前不需要”的精灵帧，然后调用 CCTextureCache 的 removeUnusedTextures。这最有可能释放您的应用程序正在使用的大部分内存，而不再需要它。
3.  删除您可能在代码中分配但当前未使用的任何其他无关内存 - 或退回到“内存安全”模式（无论您如何实现）。
4.  希望最好的。

**不要无条件清除 cocos2d 的缓存！**这没有帮助，它可能只会让事情变得更糟。

考虑到所有的 cocos2d 缓存，CCTextureCache 将保留 99% 的内存。因此，无论如何清除任何其他缓存几乎都是毫无意义的，只需忽略它们即可。

您实际上只需要查看您当前正在使用的纹理图集，以及您不删除精灵帧及其纹理的那些。

如果您开始使用 .pvr.ccz 纹理，您甚至可以完全忽略“缓存以减少加载时间”，并在您停止使用每个纹理图集时从内存中删除它 - 因为 .pvr.ccz 加载速度如此之快，几乎没有就切换场景而言，有任何区别。这也有助于首先避免内存警告。

# php - SQL 根据字段值从数组中删除数据

> ID：15704368
> 
> 赞同：0
> 
> 时间：2013-03-29T13:35:28.620
> 
> 标签：php, mysql, sql, html-table

我对此还是很陌生，并且遇到了一个问题，我一直在浏览很多教程，但无法找到解决问题的方法。

我有一个选择查询从我的 sql 数据库中获取数据但是我需要为每个访问它的用户自定义数据，所以需要添加一个进一步的查询，我有一个 cookie 读入用户值'$user'和数据库中有一个列未放入表中，但是需要检查列“privacy”的值是否设置为“1”并且 $user 不是该行的调查者丢弃并且不放入桌子。但是填充所有未设置为privacy='1'或设置为privacy=1且调查员='$user'的数据

```
$sql="SELECT * FROM evidence WHERE $evidencevariable = '".$evidencespecify."'";

$result = mysql_query($sql);

if($result === FALSE) {
    die(mysql_error());}

echo "<table class='sortable' border='1' id='table'>
<thead><tr>
<th>Id</th>
<th>Case Id</th>
<th>Investigator</th>
<th>Evidence Type</th>
<th>Created</th>
<th>Modified</th>
<th>LS</th>
<th>PS</th>
<th>Length</th>
<th>Importance</th>
<th>Information</th>
</tr></thead><tbody>";

while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . $row['Id'] . "</td>";
  echo "<td>" . $row['Case_ID'] . "</td>";
  echo "<td>" . $row['Investigator'] . "</td>";
  echo "<td>" . $row['Evidence_Type'] . "</td>";
  echo "<td>" . $row['Created'] . "</td>";
  echo "<td>" . $row['Modified'] . "</td>";
  echo "<td>" . $row['LS'] . "</td>";
  echo "<td>" . $row['PS'] . "</td>";
  echo "<td>" . $row['Length'] . "</td>";
  echo "<td>" . $row['Importance'] . "</td>";
  echo "<td>" . $row['Information'] . "</td>";
  echo "</tr>";
  }
echo "</tbody></table>"; 
```

我该如何解决这个问题，我需要在开始时向 select 语句添加更多内容，还是有办法在将数据放入表之前查询数组以删除数据？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:41:16.430

看来您可以轻松地将 sql 修改为：

```
$sql="SELECT * FROM user WHERE $evidencevariable='$evidencespecifiy' AND (Privacy=0 or (Privacy=1 AND investigator='$user'))"; 
```

# php - 如何避免在网站中出现“空白”帖子？

> ID：15704376
> 
> 赞同：0
> 
> 时间：2013-03-29T13:35:55.407
> 
> 标签：php, post, whitespace

我有这个网站：[http](http://aasiskos.webpages.auth.gr/1905_YPA/Rating.php) ://aasiskos.webpages.auth.gr/1905_YPA/Rating.php 。我登录（ user = mpa@mpa.com 和 pass = 123a ），然后我可以通过推送绿色图像来添加评论。我试图限制“发表评论”的事情。我想避免使用空格（无文字）发布评论。但它不起作用。不是空格的帖子也不会显示。问题在于下面代码中的最后一个“其他”内容。我该如何改变呢？

```
$link=mysql_connect('localhost', 'student1905','123456');
mysql_select_db('student1905');

$title= $_POST["title"];
$text= $_POST["text"];

if (!$link) {
   die('Could not connect: ' . mysql_error());
}
else {
header("Location:Rating.php"); 
}

if (  ($_POST[title]=" ")     ||       ($_POST[text]=" ")  ) {
header("Location:Rating.php"); 
}
else
{
$sql = "INSERT INTO kritikes (Auxon, Date, Title, Text) VALUE ('',CURDATE(),'$_POST[title]', '$_POST[text]')";
mysql_query($sql);
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:41:28.213

您可以使用 PHP 的[`trim()`](http://php.net/manual/en/function.trim.php)函数从字符串的开头和结尾删除空格。这将很容易让您评估内容。

但是，您的代码还有其他几个问题。首先，`Rating.php`如果您的数据库连接存在，您将重定向到。这将阻止 PHP 中的任何未来代码运行。

您还使用了已弃用的函数系列。`mysql_*`带来严重的安全隐患。你真的应该考虑使用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)。除此之外，您的代码对[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)是开放的，因此您当然应该确保清理输入。

话虽如此，以下代码应该适合您，但您需要根据我上面关于`mysql_*`SQL 注入的建议进行更改：

```
$link = mysql_connect('localhost', 'student1905','123456');
mysql_select_db('student1905');

$title= trim($_POST["title"]);
$text = trim($_POST["text"]);

if(!$link) 
{
   die('Could not connect: ' . mysql_error());
}
else {
    if(strlen($title) == 0 || strlen($text) == 0) 
    {
        header("Location:Rating.php"); 
    }
    else
    {
        $sql = "INSERT INTO kritikes (Auxon, Date, Title, Text) VALUE ('',CURDATE(),'$title', '$text')";
        mysql_query($sql);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:37:37.247

用于`trim`删除任何前导或尾随空格。然后检查消息是否为空（即。`strlen($message) === 0`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:38:43.280

你可以这样做-

```
if(trim($_POST[title])=="") {
  // your code
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T13:40:48.440

尝试更新这一行：

```
if (  ($_POST[title]=" ")     ||       ($_POST[text]=" ")  ) 
```

到 ：

```
if (  strlen(trim($_POST[title]))== 0    ||       strlen(trim($_POST[text]))== 0  ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T13:41:00.477

1.  对于空格，使用 str_replace： 例如，$string = str_replace(' ', '', $string);
2.  对于所有空格，使用 preg_replace：

    $string = preg_replace('/\s+/', '', $string);

3.  如果您只是在字符串的开头或结尾处理多余的空格，您可以使用 trim()、ltrim() 或 rtrim() 来删除它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-29T13:41:59.647

将您的帖子变量读入实际变量，同时进行修剪。然后，进行检查以确保它们都不是空字符串。如果两者都不为空，则继续执行 sql 查询。请参见下面的示例。

```
$title = trim($_POST['title']);
$text  = trim($_POST['text']);
if($title != '' && $text != '') {
    $sql = "INSERT INTO kritikes (Auxon, Date, Title, Text) VALUE ('',CURDATE(),'$title', '$text')";
    mysql_query($sql);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-29T13:42:00.327

您可以`trim()`用来取出任何前导和尾随空格。例子：

```
 trim('  h i '); //is equal to "h i"
 trim('hello world'); //is equal to "hello world" 
```

它不会删除中间的空格。

`empty`无论字符串包含多少空格，您都可以使用它来检查字符串是否为空。例子：

```
 empty(""); //returns true
 empty("  "); //returns true
 empty("  a"); //returns false 
```

# c# - 在 Webmatrix 页面 C# 中将字段名称传递给 Razor @helper

> ID：15704379
> 
> 赞同：2
> 
> 时间：2013-03-29T13:36:00.483
> 
> 标签：c#, razor, webmatrix, helpers

此代码获取在我的 .cshtml 页面中显示的唯一组织名称列表：

```
IEnumerable<dynamic> data = db.Query("Select * from provider 
   where submitter_element = '210300'");  
                            //the 210300 could be any value passed to the query

var items = data.Select(i => new { i.org_name }).Distinct();
   foreach(var name in items){
     <text>@name.org_name<br></text> 
```

每个记录`data`本身都是唯一的，但每个字段中的数据包含相同的值，即多个提供者具有相同的 org_name。

我希望能够重复使用`data`多次来创建多个唯一列表。我希望将其传递给@helper 进行显示。为此，我有以下内容：

```
@helper ListBoxDistinctDisplay(IEnumerable<dynamic> queryResult)
{  
   IEnumerable<dynamic> distinctItems = queryResult.Select(i => new { i.org_name }).Distinct();
   foreach(var listItem in distinctItems){
   <text>@listItem.org_name<br></text>
} 
```

然后在我的 .cshtml 页面中，我这样做：

```
@DisplayHelpers.ListBoxDistinctDisplay(data) 
```

...和宾果游戏，我在“查看”页面上获得了我的唯一列表。

工作完美，除了你看到我必须在助手中指出 .org_name 。

我的问题是如何将字段名称（org_name）传递给助手，以便无论他的字段名称如何，我的助手都可以重复使用？

或者......我不知道有一种完全不同的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T12:28:15.593

既然你喜欢使用动态，我会坚持下去。您可能想要传递选择器：

```
@helper ListBoxDistinctDisplay(IEnumerable<dynamic> queryResult, Func<dynamic, dynamic> selector)
{
    IEnumerable<dynamic> distinctItems = queryResult.Select(x => new {selectedField = selector(x)}).Distinct();
    foreach (var listItem in distinctItems)
    {
        <text>@listItem.selectedField<br/></text>
    }
} 
```

叫它：

```
@DisplayHelpers.ListBoxDistinctDisplay(data, x => x.org_name) 
```

# facebook - facebook 的 og:type 允许的值是什么？

> ID：15704380
> 
> 赞同：6
> 
> 时间：2013-03-29T13:36:02.937
> 
> 标签：facebook, facebook-opengraph

我找到了指向此页面的链接，但它没有提供我需要的信息：

[https://developers.facebook.com/docs/opengraph/#types](https://developers.facebook.com/docs/opengraph/#types)

可能的类型有哪些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T00:13:40.920

只要您在应用程序中设置了[Open Graph Story](https://developers.facebook.com/docs/opengraph/#stories) ，属性的`type`for可以是您想要的任何东西。当你设置你的故事时，你会被要求提供一个对象，比如“cook”、“eat”、“walk”等，以及一个对象，比如“food”、“dessert”或“route” . 该对象被合并到您在开放图形标签中提供的“类型”中。`og:type``action`

例如，如果我的应用程序 DessertTaster 有一个开放的图表故事：

```
{user} tasted this dessert 
```

动词（动作）是“味道”，宾语是“甜点”，对应的`og:type`标签是：

```
<meta property="og:type" content="desserttaster:dessert" /> 
```

如果您开发了一个使用默认故事之一的应用程序（这是 facebook 鼓励的），那么您可能有一个 og 故事对，其中包含一个`news.reads`带有 object的操作`article`。

```
<meta property="og:type" content="article" /> 
```

在这种情况下，不需要应用程序命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-17T19:23:04.687

[Facebook Developers Sharing Guide for Webmasters](https://developers.facebook.com/docs/sharing/webmasters)中有一个指向 List of Types 的链接，[它们](https://ogp.me/?fbclid=IwAR0Dr3Rb3tw1W5wjFtuRMZfwewM2vlrSnNp-_ZKlvCzo5nKuX2TuTqt0kU8#types)是：

```
music.song
music.album
music.playlist
music.radio_station
video.movie
video.episode
video.tv_show
video.other
article
book
profile
website 
```

# mysql - MySQL：按相似程度排序的“LIKE”语句

> ID：15704381
> 
> 赞同：0
> 
> 时间：2013-03-29T13:36:12.687
> 
> 标签：mysql, sql, sql-like

我有一个简单的 MySQL 查询，它运行在大量关键字上，目的是按关键字搜索。

```
SELECT * from table_name WHERE column_name LIKE '%keyword%' 
```

如何使用搜索关键字按相似度（在本例中为字符串长度）对结果集进行排序`inter`？例如，结果集是这样的。

```
international
internal
internet
interval
intern
internee
internship 
```

是否可以单独使用 SQL 或者我需要在编程级别上进行操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:39:03.180

您可以使用以下字符串长度对数据进行排序`order by length(column_name) desc`：

```
SELECT * 
from table_name 
WHERE column_name LIKE '%inter%'
order by length(column_name) desc 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/a8de4/1)。我选择了降序，但您可以`desc`通过升序删除 to order。

# c++ - const char * 和 char *

> ID：15704383
> 
> 赞同：6
> 
> 时间：2013-03-29T13:36:34.500
> 
> 标签：c++, char, constants

我明白那个

```
char *s = "Hello World!" ; 
```

存储在只读内存中，字符串文字不能通过指针修改。

这与

```
const char *s = "Hello World!"; 
```

'string' char * 或 const char * 的类型也是？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T13:41:32.903

区别在于后者是合法的，而前者是不合法的。这是在 C++11 中所做的更改。形式上，`"Hello World!"`有类型`const char[13]`；它可以转换为`const char*`. 在过去，它的类型可以是`char[13]`，可以转换为`char*`. C++ 通过添加 更改了数组的类型`const`，但保留了转换，`char*`以便使用的现有 C 代码`char*`可以在 C++ 中工作，但修改指针指向的文本会产生未定义的行为。C++11 删除了对 的转换`char*`，所以现在你只能合法地做

```
const char *s = "Hello world!"; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-29T13:41:21.347

通过将类型指定为`const char *`，它会更难意外覆盖内存，因为如果您尝试编译器将给出错误：

```
const char *s = "Hello World!";
s[0] = 'X';  // compile error 
```

如果你不使用`const`，那么问题可能直到运行时才被发现，或者它可能只是导致你的程序出现微妙的错误。

# c# - 可以在单点触控中动态执行代码吗？

> ID：15704385
> 
> 赞同：5
> 
> 时间：2013-03-29T13:36:40.740
> 
> 标签：c#, iphone, ipad, xamarin.ios

在 C# .net 中，我们可以使用 .net 动态运行代码`System.Codedom.Provider`。同样，有任何可能在 Monotouch (iPhone/iPad) 中动态执行代码。

提前致谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:48:12.247

不可能。首先是因为 Xamarin.iOS[实际工作](http://docs.xamarin.com/guides/ios/advanced_topics/limitations)方式的限制（它不像常规的 .NET 应用程序那样运行，而是编译为普通的 iOS 应用程序），并且因为 Apple Appstore 中的[安全](https://stackoverflow.com/questions/4733847/can-you-build-dynamic-libraries-for-ios-and-load-them-at-runtime)模型。毕竟，如果行为随时可能发生变化，您就不能声明应用程序是安全的或符合法规的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-28T08:17:27.923

由于 Xamarin.iOS 版本 7.2 对 C# 的动态功能有一些基本支持。从[发行说明](http://docs.xamarin.com/releases/ios/xamarin.ios_7/xamarin.ios_7.2/)：

> 实验性：C# 动态支持。我们使 C# 动态与 Xamarin.iOS 一起使用成为可能，但该功能非常复杂，我们需要早期采用者让我们知道他们在其他平台上运行或希望在 Xamarin.iOS 上运行的动态代码。

我已经成功编译并执行了匿名类型的动态访问：

```
 dynamic d = new { name = "x" };
 tmp = d.name; 
```

目前，您需要添加 Microsoft.CSharp.dll 作为依赖项 - 否则您将收到类似于此的异常：

```
Error CS0518: The predefined type `Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported (CS0518) (DynamicSupportOniOS)
Error CS1969: Dynamic operation cannot be compiled without `Microsoft.CSharp.dll' assembly reference (CS1969) (DynamicSupportOniOS) 
```

不幸的是，ExpandoObject 和 Json.Net 的 JObject 现在都不能工作：

```
dynamic x = new ExpandoObject();
x.NewProp = "demo"; // this still works
Console.WriteLine(x.NewProp); // fails with Xamarin.iOS 7.2

dynamic d = JObject.Parse("{number:1000, str:'string', array: [1,2,3,4,5,6]}");
Console.WriteLine(d.number); // fails with Xamarin.iOS 7.2 
```

我为此创建了两个错误报告：[https://bugzilla.xamarin.com/show_bug.cgi?id=20081](https://bugzilla.xamarin.com/show_bug.cgi?id=20081)和[https://bugzilla.xamarin.com/show_bug.cgi?id=20082](https://bugzilla.xamarin.com/show_bug.cgi?id=20082)。

# java - 匹配休眠查询中限制中列表的所有内容

> ID：15704387
> 
> 赞同：1
> 
> 时间：2013-03-29T13:36:54.773
> 
> 标签：java, hibernate

我想达到上述要求。

我有一个像

```
public class Test{private String id;private List<Items> items;} 
```

项目类如

```
public class Item{private String name; private String state;} 
```

我想查询特定限制组中所有项目的状态。

比方说。

有像{Done,Done需要确认,拒绝}这样的状态

我想查询{完成，完成需要确认}组中的所有项目状态。

如果有一个项目的状态不在上述状态中，则不应将其作为查询结果。

我检查这种事情。我想知道我这样做是否正确或如何去做。

`criteria.add(Restrictions.in("item.state", states));`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T19:41:56.337

使用您尝试过的标准：

```
criteria.add(Restrictions.in("item.state", states)); 
```

会给你以下错误

```
org.hibernate.QueryException: could not resolve property: item of: Test 
```

这是因为您的 Test 类中没有“item”属性。

为了让它工作，你需要为你的 Item 创建一个别名并在你的限制中使用它：

```
Criteria crit = hibSession.createCriteria(Test.class);
crit.createAlias("items", "item_");
crit.add(Restrictions.in("item_.state", states)); 
```

# camera - 使用 MTP 控制尼康相机

> ID：15704389
> 
> 赞同：4
> 
> 时间：2013-03-29T13:37:00.727
> 
> 标签：camera, mtp

我想知道如何开始控制我的尼康数码单反相机？我一直在阅读 Nikon SDK 和 MPT/PTP 并且对如何开始编写脚本来控制它感到非常困惑。谢谢你帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-21T07:09:53.937

这就是你要找的东西：http: [//sourceforge.net/projects/nikoncswrapper/](http://sourceforge.net/projects/nikoncswrapper/)

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-05T10:47:57.367

如果你只是想编写脚本，在 Linux 下 libgphoto2 和 gphoto2 是一个好的开始。

您可以在 Windows 下使用它们，我不确定是否有可用的预编译版本，但这也需要安装 USB 包装库，而且有点繁琐。

上面的下一步是在 cygwin 中编译 libgphoto2（网上有一些很好的指南），但这有点矫枉过正。

我目前在 Windows 中使用 digicamcontrol，对于 Nikon 和 C# 代码，它非常好用，而且速度非常快，而且它在 USB 前端没有任何麻烦。编写一个小的 C# 来做你想做的事情（未知）然后从脚本中运行它不会太难。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-04T13:32:41.900

万一有人还在看这个：如果您要做的是编写自己的代码来访问尼康数码单反相机，答案会有点复杂。 [上面提到的 Thomas Dideriksen 的 SDK 包装器](http://sourceforge.net/projects/nikoncswrapper/)非常适合轻松访问 Nikon 的 SDK 以控制几乎所有相机功能 - 但它仅限于 USB 电缆访问，因为该 SDK 不支持无线访问。如果后者是您想要的，那么您最好的选择可能是 Duka Istvan 的 digiCamControl，Simeon 在上面建议。此开源 C# 项目可用作独立库。（请参阅[开发文档页面](http://digicamcontrol.com/doc/development)。）但是，文档并没有那么完整，因此弄清楚如何控制所有相机参数可能会很棘手。

# maven - 有没有人有用于站点部署到融合的示例 pom 和设置文件？

> ID：15704392
> 
> 赞同：0
> 
> 时间：2013-03-29T13:37:06.473
> 
> 标签：maven, pom.xml, xml-rpc, password-protection, confluence

我正在尝试使用 Maven 构建使用 XML-RPC 部署到 Confluence 站点。我很难找到用于分发管理的正确协议。它受密码保护。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-12T20:53:38.753

我不认为这是一个好主意。Maven 站点不太适合 Confluence：它们具有特定的布局……您应该自定义很多东西以创建可以上传到 Confluence 的站点，而部署只是冰山一角。

相反，我建议您考虑用 Markdown（或 asciidoc，...）编写的不同内容。将这些类型的内容转换为与 Confluence 兼容的 HTML 非常容易。

顺便说一句，如果您需要上传 maven 站点样式，我建议您看一下[maven-confluence-plugin](https://code.google.com/p/maven-confluence-plugin/)：在 wiki 页面中，您可以找到要应用的配置来做您需要的事情。
我也在开发一个类似的插件。它被称为[confluence-maven-plugin](https://github.com/sixro/confluence-maven-plugin)。然而，我的插件的原理不是能够上传网站，而是将简单的 Markdown 文档上传到汇合点，主要由 a 指导，`README.md`就像你在使用 Github/BitBucket/etc 时可能会做的那样......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T02:05:38.823

使用以下一项或两项：

*   [代理配置](https://developer.atlassian.com/display/DOCS/Working+with+the+SDK#WorkingwiththeSDK-RunningBehindaCorporateFirewall)
*   [Maven 服务器身份验证](https://maven.apache.org/ref/3.0.4/maven-settings/settings.html#class_server)

# forms - 将表单 DateTime data2 设置为表单 data1 + 1 天

> ID：15704394
> 
> 赞同：1
> 
> 时间：2013-03-29T13:37:08.570
> 
> 标签：forms, symfony, entity, symfony-2.2

如果没有在表单中输入 endDate 的数据，我在将表单字段 DateTime（名为 endDate）设置为表单字段 DateTime（名为 startDate + 24h）时遇到问题）解决方案（感谢答案）是这样的[：](https://stackoverflow.com/questions/15599375/formtype-default-input-value-in-same-form)

```
 $em = $this->getDoctrine()->getManager();
            $task->setEndDate($form->get('startDate')->getData());
            $task->getEndDate()->modify('+1 day');
            $em->persist($task);
            $em->flush(); 
```

但是当我修改 endDate + 1 day 时， startDate 也被修改了。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:39:59.113

在 PHP 中，对象总是通过引用传递，\DateTime 的实例也是如此。要解决此问题，请克隆对象而不是传递相同的引用：

```
$task->setEndDate(clone $form->get('startDate')->getData()); 
```

# html - 在不影响 DOM 的情况下更改 div 大小

> ID：15704414
> 
> 赞同：0
> 
> 时间：2013-03-29T13:38:24.717
> 
> 标签：html, css

我正在处理这个类似网格的用户列表，但我无法实现我的目标。我的目标是当您将鼠标悬停在用户的 div 上时，将显示有关他的信息。我希望 div 在不破坏 DOM 树的情况下增加其大小并与其他 div 重叠。

我希望你知道我的意思.. :)

![在此处输入图像描述](../Images/49cf9126f98a694ad654c48df960f018.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:46:33.130

这是一个想法：

您可以让每个项目都放在一个`position: relative`div 中，然后当项目悬停或任何增长项目的事件时，给项目`position: relative; left: 0; top: 0;`并更改高度。

绝对位置会将其移出线并使其看起来仍然存在，因此其他 div 都不会移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:44:37.637

您可以使用 jQuery 的`.css()`功能：

```
$(document).ready(function()
{
    $(".user").hover(function()
    {
        $(this).css({ "z-index": "9999" });
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:45:13.357

只是使用`z-index`不会有帮助。但是将它与如下所示的布局相结合：

```
<div class="box">
    <div class="content">
        <!-- Your box content -->
    </div>
</div> 
```

风格：

.box {浮动：左；位置：相对；溢出：可见；}

.content { 位置：绝对；}

重叠很重要，一行`z-index`比前一行高。

# javascript - 隐藏选择选项不反映

> ID：15704420
> 
> 赞同：0
> 
> 时间：2013-03-29T13:38:54.653
> 
> 标签：javascript, jquery, html

我试图从选择中隐藏一些选项。使用的解决方案是这样的：

```
 this.selectBox.children(".myOption_"+optionValue).wrap("<span></span>"); 
```

this.selectBox 是上述选择的 jQuery 对象。

在 Firefox 中它工作得很好，但在 IE8 中没有反映更改：如果您应该查看选择，它似乎没有变化。但是，如果用户选择了一个选项，则该值会尊重已删除的元素。

这是一个例子：

```
<option value="val1">Test1</option>
<option value="val2">Test2</option>
<option value="val3">Test3</option>
<option value="val4">Test4</option> 
```

现在，当我选择“Test1”时，会调用一个函数并执行上述代码。从用户的角度来看，选项将保持不变。但是，如果他现在再次尝试选择“Test1”，则提供的值实际上将是“val2”，并且应该删除该选项。同样，什么也没有发生，所以他再次选择“Test1”，值将是“val3”，依此类推。

为了显示发生的更改，我必须隐藏然后显示选择。

```
this.selectBox.children(".myOption_"+optionValue).wrap("<span></span>");
this.selectBox.hide().show(); 
```

上面的代码将使更改可见（隐藏单击的选项）。

更让人好奇的是这个小提琴：

[http://fiddle.jshell.net/FAkEK/25/show/](http://fiddle.jshell.net/FAkEK/25/show/)

在同一个浏览器上正常工作。

我不明白为什么会突然发生这种情况。

为什么会这样？我应该在哪里寻找问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:23:45.260

我不确定您为什么要隐藏该选项而不是删除它，但这里有一个关于如何做到这一点的示例。它基于[此解决方案](https://stackoverflow.com/questions/2031740/)来隐藏选项。

在这里小提琴-> [http://jsfiddle.net/kAp42/2/](http://jsfiddle.net/kAp42/2/)

这里的 JSBin（应该在 IE8 中工作）-> [http://jsbin.com/uyuram/1](http://jsbin.com/uyuram/1)

```
var $select = $('select');

$select.prop('selectedIndex', -1); //ensure we can hide the first option

$select.change(function () {
    //not sure why you would not want to remove the option instead of hiding it byt, if you want to hide... 
    $select.children('option:selected').wrap('<span class="hide-option"></span>');

    //remove it
    //$select.children('option:selected').remove();

    this.selectedIndex = -1; //ensure we can hide the last option
}); 
```

# sql - 如何删除一个特定列中所有不为 NULL 的行？

> ID：15704421
> 
> 赞同：1
> 
> 时间：2013-03-29T13:38:56.587
> 
> 标签：sql

我试图删除在“toevoeging”列中有值的所有行

我做了这个查询：

```
DELETE FROM gebruiksoppervlakte WHERE toevoeging = NOT NULL; 
```

为什么这是不可能的？所以我想保留有NULL的行谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:40:34.297

您需要使用`IS NOT NULL`而不是`toevoeging = NOT NULL`：

```
DELETE 
FROM gebruiksoppervlakte 
WHERE toevoeging IS NOT NULL; 
```

`NULL`是缺乏价值的东西。因此，使用`IS NULL`or`IS NOT NULL`意味着您的列要么缺少值，要么不缺少值。

编辑，这将删除表中列中有值的所有内容`toevoeging`。如果您有要删除的空字符串，那么您将要使用：

```
DELETE 
FROM gebruiksoppervlakte 
WHERE toevoeging = ''; 
```

请参阅[演示](http://www.sqlfiddle.com/#!2/6fea9/1)。

如果要删除具有`null`值的行，则将使用：

```
DELETE 
FROM gebruiksoppervlakte 
WHERE toevoeging IS NULL; 
```

看[演示](http://www.sqlfiddle.com/#!2/529ef/1)

编辑#2，根据我们在聊天中的对话，您试图删除所有有值但该值不是空字符串的行。然后剩余的行需要更新到`null`列中。因此，您需要同时使用删除和更新：

```
DELETE 
FROM gebruiksoppervlakte 
WHERE toevoeging IS NOT NULL
  and toevoeging <> '';

update gebruiksoppervlakte
set toevoeging = null; 
```

看[演示](http://www.sqlfiddle.com/#!2/332f9/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:42:14.713

> 使用 WHERE 子句定位具有 NULL 值的行时，切勿使用“= NULL”比较，而始终使用 IS NULL 或 IS NOT NULL 比较运算符。

所以正确的查询是：

```
DELETE FROM gebruiksoppervlakte WHERE toevoeging IS NOT NULL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-09T16:31:44.360

因为 NULL 不能比较，所以下面的工作与 完全相同`... WHERE toevoeging IS NOT NULL`：

```
DELETE FROM gebruiksoppervlakte
WHERE toevoeging = toevoeging
   ; 
```

# jquery - 如何在jsf中使用jquery datepicker

> ID：15704425
> 
> 赞同：1
> 
> 时间：2013-03-29T13:39:06.127
> 
> 标签：jquery, jsf, jsf-2, jquery-ui-datepicker

我想使用 jquery 日期选择器：http: [//jqueryui.com/datepicker/](http://jqueryui.com/datepicker/)

但我不知道我需要什么，这是我的代码：

```
<script src="css/jquery-1.9.1.js"></script>
<script src="css/jquery.ui.core.js"></script>
<script src="css/jquery.ui.widget.js"></script>
<script src="css/jquery.ui.datepicker.js"></script>
<script type="text/javascript">
    $(".datepicker").datepicker({
    showOn: "button",
    buttonImage: "images/calendar.gif",
    buttonImageOnly: true
}); 
```

我放日期选择的地方是这样的：

```
<h:inputText styleClass="datepicker"></h:inputText> 
```

但是现在，当我单击 inputText 时，不会显示日期选择器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:42:54.580

确保在页面加载后设置 datepicker：

```
$(document).ready(function() {
  $(".datepicker").datepicker({
    showOn: "button",
    buttonImage: "images/calendar.gif",
    buttonImageOnly: true})
}); 
```

# c# - 找不到作为 ServiceHost 指令中的服务属性值提供的类型“BookService.Service1”

> ID：15704427
> 
> 赞同：0
> 
> 时间：2013-03-29T13:39:10.360
> 
> 标签：c#, wcf

嗨，我刚刚学习 WCF，并正在尝试为现有的 ASP.NET MVC 4 应用程序创建 Web 服务。这是我到目前为止所做的：

我创建了一个 WCF 服务应用程序。我定义了数据契约和数据成员：

```
[DataContract]
public class BookData
{
    [DataMember]
    public int Id { get; set; }

    [DataMember]
    public string Name { get; set; }

    [DataMember]
    public string Author { get; set; }

    [DataMember]
    public string Description { get; set; }

    [DataMember]
    public DateTime PublicationDate { get; set; }

    [DataMember]
    public int CategoryId { get; set; }

    [DataMember]
    public decimal Price { get; set; }

    [DataMember]
    public string BookUrl { get; set; }
} 
```

我已经定义了服务合同：

```
[ServiceContract]
public interface IBookService
{
    IEnumerable<BookData> GetBooks(int pageNumber, int numberOfBooksOnPage);
    IEnumerable<BookData> GetBookByCategory(int categoryId, int pageNumber, int numberOfBooksOnPage);
    BookModel GetBookById(int bookId);
    int CountBooks();
    int CountBooksByCategory(int categoryId);
    void AddBook(BookData book);
    void UpdateBook(BookData book);
    void DeleteBook(int bookId);
} 
```

有一个现有的 Service1.svc 文件，我将其重命名为 BookService.svc。当双击这个文件时，它实际上是一个类，我让它继承自 IBookService 并实现了所有方法。

当我右键单击 BookService.svc 并单击浏览器中的视图时，我收到此错误：

> 找不到类型“BookService.Service1”，作为 ServiceHost 指令中的服务属性值提供，或在配置元素 system.serviceModel/serviceHostingEnvironment/serviceActivations 中提供。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-03-17T19:49:47.813

回答一个老问题只是为了所有谷歌搜索者的利益:) 我也遇到了同样的问题。

在尝试解决它时，我发现我忘记在“file.svc”的标记部分更改类名。

右键单击“file.svc”并选择“查看标记”

在那里你会发现一个很长的行，其中包含如下部分： Service="SomeRootNameSpace.class1" 你应该将 'class1' 更改为真实的类名。

请让我知道它是否有帮助或者您是否已经解决了它。如果以上不清楚，请告诉我，我会尝试重新解释。

# ios - NSArray 从其他数组添加对象

> ID：15704428
> 
> 赞同：6
> 
> 时间：2013-03-29T13:39:10.917
> 
> 标签：ios, objective-c, nsarray

我有三个`NSArray`对象。我需要将此数组的所有对象添加到`NSArray`称为**allMyObjects**的对象中。

有`NSArray`标准的解决方案，例如通过初始化方法，还是我需要自定义方法来从其他数组中检索所有对象并将所有检索到的对象放入我的**allMyObjects**数组？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-29T13:58:01.743

不知道这是否算作您的问题的一个足够简单的解决方案，但这是直接的方法（正如其他回答者所暗示的那样）：

```
NSMutableArray *allMyObjects = [NSMutableArray arrayWithArray: array1]; 
[allMyObjects addObjectsFromArray: array2]; 
[allMyObjects addObjectsFromArray: array3]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-29T14:14:41.287

一旦看到这个，

```
NSArray *newArray=[[NSArray alloc]initWithObjects:@"hi",@"how",@"are",@"you",nil];
    NSArray *newArray1=[[NSArray alloc]initWithObjects:@"hello",nil];
    NSArray *newArray2=[[NSArray alloc]initWithObjects:newArray,newArray1,nil];
    NSString *str=[newArray2 componentsJoinedByString:@","];
    NSCharacterSet *doNotWant = [NSCharacterSet characterSetWithCharactersInString:@"()\n "];
    str = [[str componentsSeparatedByCharactersInSet:doNotWant] componentsJoinedByString: @""];
     NSArray *resultArray=[str componentsSeparatedByString:@","];
    NSLog(@"%@",resultArray); 
```

运单：-

```
(
    hi,
    how,
    are,
    you,
    hello
) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-29T13:43:37.147

您可以在数组上调用`addObjectsFromArray:`方法。`allMyObjects`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-10T12:05:25.910

这是添加代码以存储和从数组到数组中获取数据。

将数组存储到数组

```
NSMutableArray rowOneRoundData = [NSMutableArray arrayWithObjects: @"45",@"29",@"12",nil];
 NSMutableArray   rowTwoRoundData = [NSMutableArray arrayWithObjects: @"41",@"45",@"45",nil];
   NSMutableArray rowThreeRoundData = [NSMutableArray arrayWithObjects: @"12",@"45",@"22",nil];
   NSMutableArray rowFourRoundData = [NSMutableArray arrayWithObjects: @"45",@"12",@"61",nil];
   NSMutableArray rowFiveRoundData = [NSMutableArray arrayWithObjects: @"12",@"14",@"14",nil];
   NSMutableArray rowSixRoundData = [NSMutableArray arrayWithObjects: @"12",@"12",@"12",nil];
   NSMutableArray rowSevenRoundData = [NSMutableArray arrayWithObjects: @"12",@"36",@"83",nil];
   NSMutableArray rowEightRoundData = [NSMutableArray arrayWithObjects: @"37",@"57",@"45",nil];
   NSMutableArray rowNineRoundData = [NSMutableArray arrayWithObjects: @"12",@"93",@"83",nil];
   NSMutableArray rowTenRoundData = [NSMutableArray arrayWithObjects: @"16",@"16",@"16",nil];
   NSArray circleArray = [[NSArray alloc]initWithObjects:rowOneRoundData,rowTwoRoundData,rowThreeRoundData,rowFourRoundData,rowFiveRoundData,rowSixRoundData,rowSevenRoundData,rowEightRoundData,rowNineRoundData,rowTenRoundData, nil]; 
```

从圆形数组中获取数据

```
for (int i= 0; i<10;i++)
{
NSArray *retriveArrar = [[circleArray objectAtIndex:i] mutableCopy];
} 
```

# c# - 正则表达式根据匹配替换

> ID：15704429
> 
> 赞同：0
> 
> 时间：2013-03-29T13:39:19.417
> 
> 标签：c#, regex, pos-tagger

我正在做一些 POS 标记分析，我需要替换一些标记。我正在使用正则表达式来识别标签：

```
Regex regex = new Regex(@"/(?<firstMatch>[^\s]+)( )"); 
```

//“/”和“”之间的任何内容，示例标签：/NN、/VB 等...

现在，我将标签名称放入 firstMatch 组，因此我可以像访问它们一样

```
foreach (Match m in regex.Matches(allText))
{
    Console.WriteLine(m.Groups["firstMatch"].Value);
} 
```

我想要做的是用其他标签替换标签名称，具体取决于它的名称。就像，如果标签名称是 DTI，我想用 DT 替换它。如果是NNS，我想用NN替换它。依此类推，从我拥有的标签列表中。我可以这样做吗？我在想是否有匹配替换，所以我可以使用它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:58:17.450

```
Dictionary<string,string> tags = new Dictionary<string,string>();

public string UpadeInput(String input)
{
    tags.Add("DTI", "DT");
    tags.Add("NNS", "NN");
    tags.Add("LongAnnoyingTag", "ShortTag");
    MatchEvaluator evaluator = new MatchEvaluator(ModifyTag);
    return Regex.Replace(input,@"(?<=/)(?<firstMatch>[^\s]+)(?= )", evaluator);
}

public string ModifyTag(Match match)
{
    return tags[match.Value];
} 
```

**编辑**组合标签。

您可以更改`ModifyTag`方法以处理不同的情况。

```
public string ModifyTag(Match match)
{
    String tag = match.Value;
    if(!tag.Contains("+"))
    {
        return tags[match.Value];
    }
    else
    {
        string[] composedTags = tag.Split('+');
        return String.Format("{0}+{1}", tags[composedTags[0]], tags[composedTags[1]]);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:47:01.070

如果我理解你的问题

```
Regex.Replace(input,"/(?<firstMatch>[^\s]+)[^\s](?= )","$1"); 
```

这将用相同的标签名称替换标签名称，除了最后一个字符..

# visual-studio-2010 - Sharepoint 2010 中内容类型的自定义代码隐藏表单

> ID：15704435
> 
> 赞同：0
> 
> 时间：2013-03-29T13:39:42.920
> 
> 标签：visual-studio-2010, sharepoint, contenttype

我需要创建从 SharePoint 2010 中的 TASK 内容类型派生的自定义内容类型。这里的要点是，当用户打开我的自定义内容类型的任务时，我希望打开我的自定义 aspx 编辑和查看表单以及后面的代码。并且应该为其他类型的任务打开默认表单。

如何通过 Visual Studio 2010 解决方案做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T07:01:32.897

[在这里](http://msdn.microsoft.com/en-us/library/aa544142%28v=office.14%29.aspx)您可以找到如何创建自定义表单模板，但关键是在那里使用的用户控件不能包含代码。您必须使用后面的代码创建另一个用户控件并将其添加到上述用户控件中。

# c++ - 将构造函数参数转发给放置 new 运算符

> ID：15704436
> 
> 赞同：1
> 
> 时间：2013-03-29T13:39:43.230
> 
> 标签：c++, boost

我正在尝试使用模板化对象池，但无法重载放置新运算符。new 运算符适用于默认构造函数，但不适用于非默认构造函数。我在这里粘贴我的简单代码。

```
#include <boost/pool/object_pool.hpp>
#include <cstddef>

template<typename T>
class objectPool
{
    public:
        void* operator new (std::size_t num) { void *vp = _pool.malloc(); T *t = ::new(vp)T; return t; }
        void* operator new[] (std::size_t num) { void *vp = NULL; assert(0); return vp; }
        void operator delete (void *vp) { _pool.free(static_cast<T*>(vp)); return; }
        void operator delete [] (void *vp) { assert(0); return; }

    private:
        static boost::object_pool<T> _pool;
};

template<typename T>
boost::object_pool<T> objectPool<T>::_pool;

class number : public objectPool<number>
{
    long long _value1, _value2;
    public:
    number(long long value1, long long value2) : _value1(value1), _value2(value2) { return; }
    ~number(){ return; }
    void print() { std::cerr<<"_value1:"<<_value1<<"_value2:"<<_value2; return; }
};

int
main(int ac, char **av)
{
    number *n = new number(1000, 2000);
    n->print();
    delete n;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:48:50.763

运算符`new`不调用构造函数，它分配内存[http://www.cplusplus.com/reference/new/operator%20new/](http://www.cplusplus.com/reference/new/operator%20new/)

当你使用它时，构造函数被调用：

```
//normal new
new T(a1, a2);
//placement new
new (na1, na2) T(a1, a2) 
```

你应该在你的`new`运营商中删除新的电话并返回`vp`

# c++ - 相同的代码，向量更改为 unordered_set 时出错

> ID：15704441
> 
> 赞同：0
> 
> 时间：2013-03-29T13:39:58.043
> 
> 标签：c++, visual-c++, vector, compiler-errors, set

我有一个像这样的课程：

```
class VectorAttrIterator : public AttrIterator {
    vector<AttrValue>* values;
    vector<AttrValue>::iterator it;
public:
    VectorAttrIterator(vector<AttrValue>* _values) : values(_values) {
        it = (*values).begin();
    };

    bool hasNext() {
        return it != (*values).end();
    };

    AttrValue next() {
        int ret = (*it);
        it++;
        return ret;
    };

    ~VectorAttrIterator() {
        delete values;
    };
}; 
```

有用。然后我想做一些类似的事情`unordered_set`：

```
class UnorderedSetAttrIterator : public AttrIterator {
    unordered_set<AttrValue>* values;
    unordered_set<AttrValue>::iterator it;
public:
    UnorderedSetAttrIterator(vector<AttrValue>* _values) : values(_values) {
        it = (*values).begin();
    };

    bool hasNext() {
        return it != (*values).end();
    };

    AttrValue next() {
        int ret = (*it);
        it++;
        return ret;
    };

    ~UnorderedSetAttrIterator() {
        delete values;
    };
}; 
```

唯一的更改`vector`是更改为`unordered_set`和类重命名。但我收到如下错误：

```
Error   42  error C2065: 'values' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   40
Error   43  error C2228: left of '.begin' must have class/struct/union  h:\dropbox\sch\cs3202\code\source\includes\iterator.h   40
Error   44  error C2440: 'initializing' : cannot convert from 'std::vector<_Ty> *' to 'std::tr1::unordered_set<_Kty> *' h:\dropbox\sch\cs3202\code\source\includes\iterator.h   39
Error   45  error C2439: 'UnorderedSetAttrIterator::values' : member could not be initialized   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   39
Error   46  error C2065: 'it' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   44
Error   47  error C2065: 'values' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   44
Error   48  error C2228: left of '.end' must have class/struct/union    h:\dropbox\sch\cs3202\code\source\includes\iterator.h   44
Error   49  error C2065: 'it' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   48
Error   50  error C2065: 'it' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   49
Error   51  error C2065: 'values' : undeclared identifier   h:\dropbox\sch\cs3202\code\source\includes\iterator.h   54 
```

怎么了？为什么未声明值？**[完整来源](http://pastie.org/7161606#7)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:54:46.590

看起来这条线是这个问题：

```
UnorderedSetAttrIterator(vector<AttrValue>* _values) : values(_values) { 
```

您是否忘记将参数类型从 更改`vector`为`unordered_set`？

# mysql - 替换mysql中的单词

> ID：15704449
> 
> 赞同：-3
> 
> 时间：2013-03-29T13:40:18.087
> 
> 标签：mysql, replace, updates

我想使用 PHP & MySQL 替换文本字符串中的一些单词。

例如 -

数据库中的文本列包含值“Word1 word2 word3 word4 word5 word3”。

我想用“newword”替换“word3”和“word4”。挑战不是替换最后一个单词，也就是“word3”

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:08:53.300

在 PHP 中：

```
<?php
$mystr = "Word1 word2 word3 word4 word5 word3";
$mywords = explode(' ', $mystr);
for ($i = 0; $i < count($mywords)-1; $i++) {
  if ($mywords[$i] == 'word3' || $mywords[$i] == 'word4') {
    $mywords[$i] = 'newword';
  }
}
$newstr = implode(' ', $mywords);
print("newstr = $newstr");
?> 
```

这会将单词拆分为一个数组，将所有单词替换为数组的最后一个元素*之外*`word3`的所有元素，然后将单词重新连接成一个字符串。输出符合预期：`word4``newword`

 *```
Word1 word2 newword newword word5 word3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:50:49.287

您可以使用通配符和控制符号来替换 %word% 或 %wo.d%，就像在达到一定数量的符号时停止替换一样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:54:13.460

MySQL：

```
UPDATE `tableName`
SET `field` = REPLACE( ' word3 ', ' newword ', REPLACE(' word4 ', ' newword ', `field`) ); 
```

* * *

`word3`注意and之前和之后的额外空格`word4`。

* * *

根据评论：

```
UPDATE `tableName`
SET `field` = TRIM( REPLACE(' word3 word4 ', ' newword ', CONCAT( ' ', `field` )) ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:02:38.780

您可以使用此 php 脚本将“word3”和“word4”替换为“newword”。

<?php

$arr = array("word1","word2","word3","word4","word5","word3","word4");

print_r(str_replace("word3","newword",$arr,$i));

print_r(str_replace("word4","newword",$arr,$i));

echo "替换：$i"; ?>*

# c# - 如何从接口 AttributeUsage = AttributeTargets.Method 读取属性值

> ID：15704454
> 
> 赞同：0
> 
> 时间：2013-03-29T13:40:44.807
> 
> 标签：c#, attributes

您好，我有一个属性类，例如：

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = true, Inherited = true)]
    public class ServiceMethodSettingsAttribute : Attribute
    {
        public string ServiceName { get; private set; }
        public RequestMethod Method { get; private set; }

        public ServiceMethodSettingsAttribute(string name, RequestMethod method)
        {
            ServiceName = name;
            Method = method;
        }
    } 
```

我有接口（RequestMethod 我的枚举）

```
 [ServiceUrl("/dep")]
    public interface IMyService
    {
        [ServiceMethodSettings("/search", RequestMethod.GET)]
        IQueryable<Department> Search(string value);
    }

 public class MyService : BaseService, IMyService
    {        
        public IQueryable<Department> Search(string value)
        {
            string name = typeof(IMyService).GetAttributeValue((ServiceMethodSettingsAttribute dna) => dna.ServiceName);
            var method = typeof(IMyService).GetAttributeValue((ServiceMethodSettingsAttribute dna) => dna.Method);
        }
    } 
```

我从这里有属性阅读器[如何在运行时读取类的属性？](https://stackoverflow.com/questions/2656189/how-do-i-read-an-attribute-on-a-class-at-runtime)

```
 public static class AttributeExtensions
    {
        public static TValue GetAttributeValue<TAttribute, TValue>(this Type type, Func<TAttribute, TValue> valueSelector)
            where TAttribute : Attribute
        {
            var att = type.GetCustomAttributes(typeof(TAttribute), true).FirstOrDefault() as TAttribute;
            if (att != null)
            {
                return valueSelector(att);
            }
            return default(TValue);
        }
    } 
```

我无法从*ServiceMethodSettings*属性中获取值。我的声明有什么问题以及如何以正确的方式读取值？

我也有 ServiceUrl 属性

```
[AttributeUsage(AttributeTargets.Interface, AllowMultiple = true, Inherited = true)]
    public class ServiceUrlAttribute : System.Attribute
    {
        public string Url { get; private set; }

        public ServiceUrlAttribute(string url)
        {
            Url = url;
        }
    } 
```

它运作良好。

可能是 AttributeUsage AttributeTargets.Method 中的原因

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:46:39.273

您需要从`MethodInfo`对应于方法的属性中获取属性，例如

```
MethodInfo method = typeof(IMyService).GetMethod("Search");
ServiceMethodSettingsAttribute attr = (ServiceMethodSettingsAttribute) method.GetCustomAttributes(typeof(ServiceMethodSettingsAttribute), true).FirstOrDefault(); 
```

对您的方法的一个直接更改是为装饰方法名称添加一个参数：

```
public static TValue GetMethodAttributeValue<TAttribute, TValue>(this Type type, string methodName, Func<TAttribute, TValue> valueSelector)
    where TAttribute : Attribute
{
    MethodInfo method = type.GetMethod(methodName);
    if(method == null) return default(TValue);
    var att = method.GetCustomAttributes(typeof(TAttribute), true)
        .Cast<TAttribute>()
        .FirstOrDefault();

    if (att != null)
    {
        return valueSelector(att);
    }
    return default(TValue);
} 
```

您也可以使用表达式而不是将名称指定为字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:46:39.433

你将不得不去`MethodInfo`你的类型。尝试调用`GetMethods()`.

# ios - 从 UITableView / Feed 缩放 Facebook 应用风格的照片

> ID：15704461
> 
> 赞同：7
> 
> 时间：2013-03-29T13:41:03.340
> 
> 标签：ios, uitableview, uiimageview, uiviewanimation

在 Facebook 应用程序中，当您在动态消息上并点击照片以查看它时，会发生一些事情：

1.  图像动画/移动到屏幕的中心，无论它在表格视图中的当前位置（中间，部分远离屏幕朝向底部，顶部，等等）

2.  当图像移动到屏幕中心时，表格视图的其余部分会淡出（alpha = 0）

3.  当您向上或向下拖动图像时，表格视图的 alpha 会按比例（我认为）恢复为图像从屏幕中心的偏移量

4.  此时，您会注意到在 Feed 中，图像过去所在的位置现在是空的（给您的印象是您将图像“带到”前面）。您可以通过向上/向下拖动图像来查看这一点，并且您可以看到图像后面的 Feed/table 视图。

5.  在 #2 之后，如果图像已经成比例（也就是说，Feed/table 视图上的图像预览是按比例缩放的，没有任何裁剪），那么它只会移动到中心。如果图像被完全裁剪（因为它太高，等等，无法正确放入 Feed 中），那么图像的其余部分会在它移动到屏幕中心的同时显示出来。

6.  一旦图像移动到屏幕中央，画廊视图控制器元素就会出现（完成按钮、赞/评论按钮等）

7.  在 #4 之后，如果您滑动到另一个图像（在全屏图像视图中向左/向右滑动到同一相册中的另一个图像），然后尝试在 #3 中向上/向下拖动，您会看到第一个图像回到了它在 Feed 中的位置。

8.  最后，如果您将图像向上/向下拖动超过某个阈值，则会将其关闭并再次显示 Feed。

**这就是我认为在概念上正在发生的事情，如果这是正确的方法，我想确认一下（下面的这些项目符号不映射到上面的项目符号）：**

1.  当用户点击图像时，将该 imageView 添加为 table view 的容器视图的子视图，但将其添加到完全相同的位置，以便看不到 imageView 从单元格到主视图的移动。

2.  然后将该图像移动到屏幕中心的动画。同时降低table view的alpha，使其在imageView到达屏幕中心的同时达到0。

3.  一旦图像到达屏幕中心，推送模态视图控制器而不对其进行动画处理，并将 imageView 添加为模态视图控制器视图的子视图（上面的效果 #6）

4.  图像的任何拖动都会降低模态视图控制器的 alpha 并增加 Feed 表视图的 alpha（上面的效果 #3），并且拖动到某个阈值以上会触发隐藏图库并再次显示 Feed 的动画（效果 #8以上）

**问题：**

1.  我在正确的轨道上吗？如果是这样，我如何将单元格中的 imageView 带入前视图 - 并将其保持在相同的位置？

2.  当您滑动到另一个图像时，原始图像将“恢复”到其在表格视图单元格中的原始位置。这实际上只是将一个 imageView 从一个视图移动到下一个视图吗？您如何将其发送回原始单元格 - 当用户点击图像时保留指向该单元格的指针，然后执行类似的操作`customCell.imageViewContainerView addSubview:originalImageView`？如果用户滑回原始图像，这是否需要反转？

这整件事对我来说似乎是一个不平凡的实现，但我认为效果很棒，而且我也很好奇它是如何完成的。我是不是想多了，实际上有一个非常简单的方法可以做到这一点，或者我是否应该向编写 FB 应用程序的人提供道具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T11:26:09.430

> 我在正确的轨道上吗？如果是这样，我如何将单元格中的 imageView 带入前视图 - 并将其保持在相同的位置？

我认为您在概念步骤上是正确的。从单元格中获取 imageView 并将其添加到控制器视图中并不难。您可以使用以下方法

```
- (CGRect)convertRect:(CGRect)rect toView:(UIView *)view 
```

以获得图像视图的正确位置。

> 当您滑动到另一个图像时，原始图像将“恢复”到其在表格视图单元格中的原始位置。这实际上只是将一个 imageView 从一个视图移动到下一个视图吗？你怎么把它发送回原始单元格 - 当用户点击图像时保持指向该单元格的指针，然后执行 customCell.imageViewContainerView addSubview:originalImageView 之类的操作？如果用户滑回原始图像，这是否需要反转？

我认为这是由画廊和表格视图控制器之间的某种协议制成的。也许它只是隐藏/显示图像，画廊中的图像实际上是一个不同的对象。无论如何，如果你想使用相同的 imageview，你可以在两个控制器之间发送带有协议的对象。

希望这会有所帮助；）我认为关键在于 convertRect 方法。

# php - 贝宝 PHP SDK 未找到！致命错误：找不到类“字符串”

> ID：15704462
> 
> 赞同：0
> 
> 时间：2013-03-29T13:41:07.110
> 
> 标签：php, sdk, paypal

我需要在以下位置执行 `phpsdk` `paypal`示例：

[http://www.fastbreakplay.com/preview/paypal/sample/](http://www.fastbreakplay.com/preview/paypal/sample/)

但我收到以下错误：

> 致命错误：第 53 行的 /home/fastbre/public_html/preview/paypal/sample/vendor/paypal/rest-api-sdk-php/lib/PayPal/Common/Model.php 中找不到类“字符串”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T22:51:16.903

您使用的产品是 rest-api-sdk-php

[https://github.com/paypal/rest-api-sdk-php](https://github.com/paypal/rest-api-sdk-php)

如果您查看问题，两天前报告了一个可能与您的问题有关的问题。

[https://github.com/paypal/rest-api-sdk-php/issues/4](https://github.com/paypal/rest-api-sdk-php/issues/4)

正如您在问题中看到的那样，他们在更新时遇到了一些问题。那可能会搞砸各种事情。他们建议删除 vendor 文件夹和 composer.lock 文件；然后进行作曲家更新。

由于您的问题出在供应商目录中，并且您可能在此更新问题发生时一直在安装，您可能想尝试他们的建议。

# android - 将图像列表视图的值传递给另一个活动

> ID：15704465
> 
> 赞同：0
> 
> 时间：2013-03-29T13:41:13.237
> 
> 标签：android, listview, android-listview

```
 Integer[] leftItems = new Integer[]{R.drawable.ic_1, R.drawable.ic_2, R.drawable.ic_3, R.drawable.ic_4, R.drawable.ic_5};
        Integer[] rightItems = new Integer[]{R.drawable.ic_6, R.drawable.ic_7, R.drawable.ic_8, R.drawable.ic_9, R.drawable.ic_10};

        leftAdapter = new ItemsAdapter(this, R.layout.item, leftItems);
        rightAdapter = new ItemsAdapter(this, R.layout.item, rightItems);
        listViewLeft.setAdapter(leftAdapter);
        listViewRight.setAdapter(rightAdapter);

        leftViewsHeights = new int[leftItems.length];
        rightViewsHeights = new int[rightItems.length]; 
```

对于 leftlist 视图 onclick 我使用下面的代码

```
listViewLeft.setOnItemClickListener(new android.widget.AdapterView.OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {

            // TODO Auto-generated method stub
            Integer name = (Integer) arg0.getItemAtPosition(arg2);
            Intent Courses = new Intent(ItemsActivity.this, ViewMyImage.class);
            Courses.putExtra("position",arg2);
            Courses.putExtra("name",name.toString());
            startActivity(Courses);

        }

    }); 
```

在 ViewMyImage.java 我使用这个代码来获取值

```
int value = getIntent().getExtras().getInt("position");
        String name = getIntent().getExtras().getString("name");
        Toast.makeText(getApplicationContext(), name,Toast.LENGTH_LONG).show(); 
```

**我想要图像 ic_X 的值，我可以再次显示图像。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:48:35.187

尝试使用`getResources().getIdentifier`从字符串名称中查找可绘制对象：

```
int value = getIntent().getExtras().getInt("position");
int drawableid = getResources().getIdentifier("ic_"+value , 
                                                 "drawable", getPackageName());
Drawable drawableimg = getResources().getDrawable(drawableid); 
```

现在`drawableimg`用于设置 ImageView 背景图像使用`ImageView.setImageDrawable`

并且发送方式是传递 Drawable id，而不是如果位置从以前的 Activity 到`ViewMyImage`Activity 使用`Courses.putExtra("position",leftItems[arg2])`. 在第二个活动中，您可以`setImageDrawable`直接将值传递给 id

# mysql - 为什么 MySQL 查询需要 1 毫秒到 7 秒？

> ID：15704468
> 
> 赞同：3
> 
> 时间：2013-03-29T13:41:20.673
> 
> 标签：mysql, sql

我有一个 SQL 查询（见下文），它返回的正是我所需要的，但是当通过 phpMyAdmin 运行时，需要 0.0009 秒到 0.1149 秒，偶尔会一直到 7.4983 秒。

询问：

```
SELECT
  e.id,
  e.title,
  e.special_flag,
  CASE WHEN a.date >= '2013-03-29' THEN a.date ELSE '9999-99-99' END as date
  CASE WHEN a.date >= '2013-03-29' THEN a.time ELSE '99-99-99' END as time,
  cat.lastname,
  FROM e_table as e
  LEFT JOIN a_table as a ON (a.e_id=e.id)
  LEFT JOIN c_table as c ON (e.c_id=c.id)
  LEFT JOIN cat_table as cat ON (cat.id=e.cat_id)
  LEFT JOIN m_table as m ON (cat.name=m.name AND cat.lastname=m.lastname)
  JOIN (
          SELECT DISTINCT innere.id
          FROM e_table as innere
          LEFT JOIN a_table as innera ON (innera.e_id=innere.id AND
                                          innera.date >= '2013-03-29')
          LEFT JOIN c_table as innerc ON (innere.c_id=innerc.id)
          WHERE (
                  (
                    innera.date >= '2013-03-29' AND 
                    innera.flag_two=1
                  ) OR 
                  innere.special_flag=1
                ) AND
                innere.flag_three=1 AND 
                innere.flag_four=1
          ORDER BY COALESCE(innera.date, '9999-99-99') ASC,
                   innera.time ASC,
                   innere.id DESC LIMIT 0, 10
       ) AS elist ON (e.id=elist.id)
  WHERE (a.flag_two=1 OR e.special_flag) AND e.flag_three=1 AND e.flag_four=1
  ORDER BY a.date ASC, a.time ASC, e.id DESC 
```

解释计划： ![上述查询说明计划](../Images/09a7e30cbea7238b1e5f79ebf699bc2a.png)

问题是：该查询的哪一部分可能导致性能差异很大？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T16:14:23.427

要专门回答您的问题：它不是导致广泛性能的查询的特定部分。这就是 MySQL 做它应该做的事情 - 作为一个关系数据库管理系统 (RDBMS)，而不仅仅是一个围绕逗号分隔文件的愚蠢 SQL 包装器。

执行查询时，会发生以下情况：

1.  查询被编译为“参数化”查询，消除了所有变量到纯结构化 SQL。
2.  检查编译缓存以查找是否为查询找到了最近可用的执行计划。
3.  如果需要，查询会编译成执行计划（这就是“解释”显示的内容）
4.  对于每个执行计划元素，检查内存缓存是否包含新鲜和可用的数据，否则中间数据是从主表数据组装而成的。
5.  通过将所有中间数据放在一起来组装最终结果。

您所看到的是，当查询花费 0.0009 秒时，缓存足够新鲜，可以同时提供所有数据，而当它在 7.5 秒达到峰值时，查询表中的某些内容发生了变化，或者其他查询“推送”了内存缓存数据，或者 DBMS 有其他原因怀疑它需要重新编译查询或再次获取所有数据。可能其他一些变化与使用的索引是否仍然在内存中足够新鲜地缓存有关。

总结这一点，查询速度非常慢，你有时很幸运缓存使它看起来很快。

为了解决这个问题，我建议研究两件事：

1.  首先也是最重要的 - 这种大小的查询在其执行计划中不应有一行读取“没有可能的键”。研究索引是如何工作的，确保你意识到 MySQL 对每个连接表使用单个索引的限制的影响，并调整你的数据库，以便计划的每一行在“key”下都有一个条目。
2.  其次，检查查询本身。当 DBMS 所要做的只是合并原始数据时，它们的速度是最快的。`CASE`使用诸如和之类的编程元素`COALESCE`通常很有用，但它们确实迫使数据库在运行时评估更多的东西，而不仅仅是获取原始表数据。尝试消除此类语句，或将它们移动到业务逻辑中，作为检索数据的后处理。

最后，永远不要忘记 MySQL 实际上是一个相当愚蠢的 DBMS。它针对大多数网站所需的简单数据获取查询的性能进行了优化。因此，对于大多数通用问题，它比 SQL Server 和 Oracle 快得多。一旦你开始用函数、案例、巨大的连接或匹配条件等使事情复杂化，竞争对手通常会得到更好的优化，并且在他们的查询编译器中也有更好的优化。因此，当 MySQL 在特定查询中开始变慢时，请考虑将其拆分为 2 个或更多较小的查询，以免混淆，并在 PHP 或您调用的任何语言中进行一些后处理。我已经看到很多情况下，这会大大提高性能，只是不要混淆 MySQL，尤其是在涉及子查询的情况下（如您的情况）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:42:05.260

让我们开始您的外部和内部查询都使用“e”表，最低要求为 flag_three = 1 AND flag_four = 1（无论您的内部查询的（（ x 和 y ）或 z）条件如何。此外，您的外部WHERE 子句明确引用了 a.Flag_two，但没有 NULL 强制您的 LEFT JOIN 实际上成为（INNER）JOIN。此外，看起来每个“e”记录必须有一个类别，因为您正在寻找“cat. lastname”，如果没有找到则没有 coalesce()。这是有道理的，因为它似乎是一个“查找”表引用。至于“m_table”和“c_table”，你没有得到或做任何事情，所以他们可以被完全删除。

下面的查询会得到相同的结果吗？

```
select 
      e1.id,
      e1.Title,
      e1.Special_Flag,
      e1.cat_id,
      coalesce( a1.date, '9999-99-99' ) ADate,
      coalesce( a1.time, '99-99-99' ) ATime
      cat.LastName
   from
      e_table e1
         LEFT JOIN a_table as a1
             ON e1.id = a1.e_id
            AND a1.flag_two = 1
            AND a1.date >= '2013-03-29'

         JOIN cat_table as cat 
             ON e1.cat_id = cat.id
   where
          e1.flag_three = 1
      and e1.flag_four = 1 
      and (   e1.special_flag = 1
           OR a1.id IS NOT NULL )
   order by
      IF( a1.id is null, 2, 1 ),
      ADate,
      ATime,
      e1.ID Desc
   limit
      0, 10 
```

Main WHERE 子句仅适用于那些将“三和四”标志设置为 1 加上（特殊标志存在或存在有效的“a”记录在所讨论的给定日期/之后）。

从此，简单的排序和限制。

至于获取日期和时间，您似乎只希望包含日期/之后的记录，否则忽略它们（例如它们旧且不适用，您不想看到它们）。

按顺序，我正在为“a”ID 的 NULL 值测试 FIRST。如果是这样，我们知道他们都将被强制设置为“9999-99-99”的日期和“99-99-99”的时间，并希望它们被推到底部（因此为 2），否则，有一个“a " 记录，你首先想要那些（因此是 1）。然后，分别按日期/时间排序，如果同一日期/时间中有多个，则 ID 降序排列。

最后，为了帮助索引，我会确保你的“e”表有一个索引

```
( id, flag_three, flag_four, special_flag ). 
```

对于“a”表，索引

```
(e_id, flag_two, date) 
```

# php - 从阵列取消设置导致内部服务器错误

> ID：15704471
> 
> 赞同：0
> 
> 时间：2013-03-29T13:41:29.813
> 
> 标签：php, arrays

我正在尝试通过删除重复值来合并两个数组。也就是说，如果 `$array_two[$i]->id == $array_one[$j]->yelp_id`那么它是重复的。所以我试图删除它。

这是我的代码..

```
for($i=0;$i<count($array_two);$i++)
   {
   for($j=0;$j<count($array_one); $j++)
    {
      if($array_two[$i]->id == $array_one[$j]->yelp_id)
       {            

        //print_r($array_two[$i]);
        unset($array_two[$i]);

        }

    }
}
$array=array_merge($array_one,$array_two); 
```

当我这样做时，我得到一个

> 内部服务器错误 500..

但是当我使用打印时，`print_r`我得到了重复的条目..

这段代码有什么问题？

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:45:42.620

您需要在`break;`之后添加，`unset($array_two[$i]);`因为它仍在经历`for($j)`并试图再次达到该值，但它不再存在。

此外，您应该将`count()`函数移到 for 循环声明之外。它每次都重新计算长度，如果您从数组中删除项目，它将不会命中数组中的最后几个项目，因为每次计数都会减少。

```
$count1 = count($array_two);
$count2 = count($array_one);
for ($i = 0; $i < $count1; $i++) {
    for ($j = 0; $j < $count2; $j++) {
        if ($array_two[$i]->id == $array_one[$j]->yelp_id) {
            unset($array_two[$i]);
            break;
        }
    }
} 
```

# ios - 核心数据 - 以一对多关系访问实例与获取请求？

> ID：15704475
> 
> 赞同：0
> 
> 时间：2013-03-29T13:41:55.480
> 
> 标签：ios, objective-c, core-data, database-performance

我的应用程序中有一个带有“笔记本”实体的核心数据模型。有两种方法可以访问一个或多个“笔记本”实例：

*   通过执行带有谓词的 NSFetchRequest 请求具有特定“标题”或“索引”属性的实例。
*   通过在我的核心数据模型中添加一个“AppData”实体，放弃“Notebook”中的“index”属性，而是从“AppData”到“Notebook”建立一对多的有序关系。然后我会在第一个应用程序启动时创建一个“AppData”实例（并且在之后的每次启动时，我都会获取该唯一一个“AppData”实例的请求）并通过其对多关系访问所有“笔记本”实例。要按标题访问笔记本，我将使用 indexOfObjectPassingTest 或快速 obj-c 枚举，要按索引访问，我将使用 objectAtIndex。

查询“笔记本”实例及其属性的“AppData”实例比每次都设置对托管对象上下文的获取请求要容易得多。

但是，哪种方法会更快？一种方法会使用更多内存还是在内存中停留更多时间？我读到多对关系中的对象是延迟加载的，但是什么时候加载该集合中的对象？什么时候卸载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:57:16.107

该`AppData`实体似乎是多余的。您必须先获取它，那么为什么不获取所有`Notebook`实例呢？过滤（按标题、其他 ID 属性）在两种情况下都是相同的。

获取请求不必很痛苦：

```
NSFetchRequest *fetch = [NSFetchRequest fetchRequestWithEntityName:@"Notebook"];
NSArray *fetchedObjects = [moc executeFetchRequest:fetch error:nil]; 
```

此外，根据数据量，您可以在内存中过滤这些数据，或在获取请求中包含谓词。

当然，无论在何种情况下，都要放弃你对“索引属性”的想法。Core Data 是一个对象图，而不是数据库。这样做的唯一理由可能是您需要与某些使用唯一标识符的外部框架或数据存储同步。

为方便起见，您可以在托管对象的类别中创建一个方法。

```
+(NSArray*) appNotebooks {
   NSArray * fetchedResults = // fetch the appropriate entities
   return fetchedResults;
} 
```

然后你会像这样使用它：

```
Notebook.appNotebooks; 
```

# jquery - JQuery next().attr() 不工作

> ID：15704480
> 
> 赞同：0
> 
> 时间：2013-03-29T13:42:04.170
> 
> 标签：jquery, internet-explorer, next

这是我的 JS 代码

```
var inputid = $("#"+parentId).next().attr('id');
var tdid = $("#"+inputid).next().attr('id'); 
```

这里'parentId'是我函数中的一个参数。基本上 parentId 是 td 的 id，在 td 之后我有一个隐藏的文本字段，然后是另一个 td。

td->隐藏文件->td

首先我得到第一个 td 的 id，通过使用该 id 得到隐藏字段的 id，然后通过使用隐藏字段的 id 得到下一个 td 的 id。

这在除 IE 之外的所有浏览器中都可以正常工作。当我提醒它时，它给出了“未定义”。

这是我的html

```
<td id="tone_one" class="ttd_class class_tone" height="25px;" style="border-left: 3px solid #000000; border-right: 3px solid #000000;" align=center valign=bottom bgcolor="#ffffff" >&nbsp;</td><input type="hidden" id="tone_one_txt" name="tone_one_txt">

<td id="tone_two" class="ttd_class class_ttwo" height="25px;"  style="border-left: 3px solid #000000; border-right: 3px solid #000000;" align=center valign=bottom bgcolor="#ffffff" >&nbsp;</td><input type="hidden" id="tone_two_txt" name="tone_two_txt"> 
```

我是 JQuery 的新手。请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:56:42.030

问题是您的 HTML 没有被 IE 正确解释。只需将隐藏的输入字段放在相同`td`的位置，然后尝试下面的代码。它适用于所有浏览器：

HTML

```
<table>
    <tr>
        <td id="tone_one" class="ttd_class class_tone" height="25px;" style="border-left: 3px solid #000000; border-right: 3px solid #000000;" align=center valign=bottom bgcolor="#ffffff">&nbsp;
            <input type="hidden" id="tone_one_txt" name="tone_one_txt">
        </td>
        <td id="tone_two" class="ttd_class class_ttwo" height="25px;" style="border-left: 3px solid #000000; border-right: 3px solid #000000;" align=center valign=bottom bgcolor="#ffffff">&nbsp;
            <input type="hidden" id="tone_two_txt" name="tone_two_txt">
        </td>
    </tr>
</table> 
```

JS

```
var inputid = $("#"+parentId).children().attr('id');
var tdid = $("#"+inputid).closest('td').next().attr('id'); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-29T13:44:36.060

像这样使用。

```
var inputid = $("#parentId").next().attr('id'); 
```

# javascript - 代码整理？

> ID：15704498
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:42:56.987
> 
> 标签：javascript, jquery, performance

这已经在这里得到了完整的回答： [链接](https://codereview.stackexchange.com/questions/24499/code-tidying-up) 什么是整理javascript代码的最佳方法我已经写了这个，但似乎很长，有什么建议可以缩短它？

```
jQuery("document").ready(function(jQuery){

if ( jQuery(window).width() < 960) {
        jQuery(".main").animate({"top":"22%"});
        jQuery('#tblcontents').toggle(function(){
        jQuery(".main").fadeOut(1000);
         }, function(){ 
        jQuery(".main").fadeIn(1000);
        jQuery(".main").animate({"top":"22%"});

    });

}
else {
}

    jQuery('.menu-button').click(function(){
    jQuery("#sb-container div").css("transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-webkit-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-ms-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-moz-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-o-transform", "rotate(0deg)"  );
    jQuery(".main").animate({"right":"1%"}, "slow");
});

jQuery(function(){
    jQuery('.toggle_div').toggle(function(){
    jQuery(".main").animate({"right":"50%"}, "slow");
 }, function(){ 
    jQuery(".main").animate({"right":"1%"}, "slow");
    });
});

jQuery(".pulse").effect("pulsate", { times:100 }, 2000).click(function(){
    jQuery(".pulse").effect().stop(true, true);
    jQuery(".pulse").animate({"opacity":"1"}, "fast");
});
    jQuery('.thumb').click(function(){
    jQuery("#sb-container div").css("transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-webkit-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-ms-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-moz-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-o-transform", "rotate(0deg)"  );
    jQuery("#sb-container").animate({"left":"0px"}, "slow");
    jQuery(".main").animate({"right":"1%"}, "slow");
    });

jQuery(window).scroll(function () {
    if (jQuery(this).scrollTop() > 20) {
    jQuery("#sb-container div").css("transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-webkit-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-ms-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-moz-transform", "rotate(0deg)"  );
    jQuery("#sb-container div").css("-o-transform", "rotate(0deg)"  );
    jQuery(".main").animate({"right":"1%"}, "slow");

    } else{
            jQuery( "#sb-container" ).draggable()
    }
});

});

     jQuery(function() {
jQuery( "#sb-container" ).draggable()
}); 
```

如何减少此处显示的代码量？什么是最佳实践，我错过了什么？我还需要查询窗口宽度的 else 语句，因为它们在大多数情况下没有任何功能。克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:47:53.730

您可以通过像这样批量设置样式来清理代码的某些组件：

```
// it looks like you reuse this same set of styles in a few places
// define them once as a variable and assign as needed
var defaultStyles = 
{
    "transform": "rotate(0deg)",
    "-webkit-transform": "rotate(0deg)",
    "-ms-transform": "rotate(0deg)",
    "-moz-transform": "rotate(0deg)",
    "-o-transform": "rotate(0deg)"
}; 
```

* * *

```
jQuery('.menu-button').click(function() {
    jQuery("#sb-container div").css(defaultStyles);
    jQuery(".main").animate({"right":"1%"}, "slow");
}); 
```

* * *

```
jQuery('.thumb').click(function(){
    jQuery("#sb-container div").css(defaultStyles);
    jQuery("#sb-container").animate({"left":"0px"}, "slow");
    jQuery(".main").animate({"right":"1%"}, "slow");
}); 
```

* * *

```
if (jQuery(this).scrollTop() > 20) {
    jQuery("#sb-container div").css(defaultStyles);
    jQuery(".main").animate({"right":"1%"}, "slow");
} 
```

# html - 如何在 JQM 中以编程方式创建列表视图

> ID：15704501
> 
> 赞同：4
> 
> 时间：2013-03-29T13:43:04.693
> 
> 标签：html, jquery-mobile, jquery, jquery-mobile-listview

我有一个来自 ajax 的数组，我需要创建[jQuery Mobile Listview](http://api.jquerymobile.com/listview/)。我没有找到这种方法，所以可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T13:46:10.550

这是一个工作示例：http: [//jsfiddle.net/Gajotres/SS7vJ/](http://jsfiddle.net/Gajotres/SS7vJ/)

另一个带有数组的示例：http: [//jsfiddle.net/Gajotres/yHHWQ/](http://jsfiddle.net/Gajotres/yHHWQ/)

```
$(document).on('pagebeforeshow', '#index', function(){       
    $('<ul>').attr({'id':'test-listview','data-role':'listview', 'data-filter':'true','data-filter-placeholder':'Search...'}).appendTo('#index [data-role="content"]');
    $('<li>').append('<a href="#">Audi</a>').appendTo('#test-listview');
    $('<li>').append('<a href="#">Mercedes</a>').appendTo('#test-listview');
    $('<li>').append('<a href="#">Opel</a>').appendTo('#test-listview');
    $('#test-listview').listview().listview('refresh');
}); 
```

也不要忘记调用 .listview( 两次，第一次没有刷新参数，第二次使用刷新参数。没有它你会收到这个错误：

> 无法在初始化之前调用 listview 上的方法

如果您想了解更多关于 jQuery mobile 如何处理动态添加的内容及其标记的信息，请查看这篇**[文章](http://www.gajotres.net/jquery-mobile-and-how-to-enhance-the-markup-of-dynamically-added-content/)**，为了透明，它是我的个人博客，或者在**[这里](https://stackoverflow.com/a/14550417/1848600)**找到它。

# html - 在 IE 中显示 DIV 而不是部分/文章

> ID：15704507
> 
> 赞同：1
> 
> 时间：2013-03-29T13:43:23.210
> 
> 标签：html, css

我基本上想创建一个支持 HTML5 语义元素的网页，但是对于不注意 HTML5 元素的浏览器，我能做什么？

例如，我想使用`<section></section>`现代浏览器注意到的，但是如果有人在旧浏览器中访问我的网站，我该怎么做才能显示 DIV 而不是 SECTION？

我尝试使用以下代码，它只对 Internet Explorer 有用，但对其他浏览器有用吗？

```
<section class="main">
  <!--[if IE]>
  <div  class="main-ie"> Only displayed only in IE .</div>
  <![endif]-->
</section> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:46:03.627

HTML5 Shiv 支持在旧版 Internet Explorer 中使用 HTML5 分段元素，并为 Internet Explorer 6-9、Safari 4.x（和 iPhone 3.x）和 Firefox 3.x 提供基本的 HTML5 样式。

```
<!--[if IE]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:44:35.373

解决这个问题的好方法是包含 JavaScript polyfill 库[Modernizr](http://modernizr.com/)。它使 HTML5 元素在旧版本的 IE 中工作。这样你现在就可以开始使用 HTML5 语义标签，而不是等到旧的 IE 死掉；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T13:46:53.723

您可以为 IE 添加这个小脚本：

```
(function(){if(!/*@cc_on!@*/0)return;var e = "abbr,article,aside,audio,bb,canvas,datagrid,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(','),i=e.length;while(i--){document.createElement(e[i])}})() 
```

如果您使用`document.createElement`.

参考：[http ://css-tricks.com/snippets/javascript/make-html5-elements-work-in-old-ie/](http://css-tricks.com/snippets/javascript/make-html5-elements-work-in-old-ie/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T13:45:39.737

把这段代码放在你的head标签中 IE浏览器支持HTML5标签，

```
 <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <script src="http://www.toyotapriusprojects.com/wp-content/themes/html5/lib/js/innershiv.min.js"></script>
        <![endif]--> 
```

# javascript - 谷歌图表工具提示

> ID：15704510
> 
> 赞同：0
> 
> 时间：2013-03-29T13:43:31.347
> 
> 标签：javascript, tooltip, google-visualization

有什么方法可以让 Google Charts 中的工具提示始终可见？正如我在 API 中找到的那样，我只能完全禁用它们。![在此处输入图像描述](../Images/2f0a7d499b3ad672ac2214486353bda0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-15T11:57:12.827

```
var svg = document.getElementById('div_id').getElementsByTagName('svg')[0];     
var parent = svg.childNodes[4].firstChild.nextSibling.firstChild.nextSibling.firstChild.parentNode;
for(var i=0; i<svg.childNodes[4].childNodes[1].childNodes[1].childElementCount; i++) {
    var g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
    var text = document.createElementNS('http://www.w3.org/2000/svg', 'text');  
    var child = svg.childNodes[4].firstChild.nextSibling.firstChild.nextSibling.firstChild; 
    text.setAttribute('x', child.getAttribute('x'));
    text.setAttribute('y', child.getAttribute('y'));
    text.setAttribute('fill', '#000000');
    text.setAttribute('dy', '-2');      
    text.textContent = 'Hell0'; 
    parent.removeChild(child);
    g.appendChild(child);   
    g.appendChild(text);
    parent.appendChild(g);
} 
```

我在上面的 javascript 代码中编写了此代码，以将文本“Hell0”附加到每列的顶部。

这种方法的缺点是工具提示和交互性不起作用。所以你需要禁用如下

```
tooltip: {tigger: 'none'},
enableInteractivity: false, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T01:03:04.780

目前在 Google Visualization API 中没有办法做到这一点。

您可以尝试[HTML Tooltips](https://developers.google.com/chart/interactive/docs/customizing_tooltip_content#enabling_html_tooltip)并查看是否可以找出 CSS 以使其正常显示（可能）。

或者，您可以编写自己的 Javascript 来显示您想要的任何内容。不幸的是，我在任何地方都没有看到这样的工作示例。如果您确实找到了解决方案，请在此处分享并将其标记为答案！

# web-services - wsdl 的打字稿定义

> ID：15704513
> 
> 赞同：0
> 
> 时间：2013-03-29T13:43:34.193
> 
> 标签：web-services, wsdl, typescript, typing, javascript-debugger

我正在使用 asp:ScriptManager 从 javascript 调用我的 webmethods。现在我迁移到 TypeScript 并希望我的 WebMethods 和 DTO 定义可以从 TypeScript 中使用。我进行了搜索，但找不到任何执行此操作[的内容（建议除外](http://typescript.codeplex.com/workitem/370)）。

现在我正在实现一个代码生成工具，它采用 wsdl 并生成打字稿类型。完成后我会在这里分享它，但与此同时，如果你知道任何可以做到这一点的工具，我会很高兴听到。

提前致谢。

* * *

这就是我从 javascipt 调用 webmethods 的方式。

## 1) web.config

```
<system.serviceModel>
<services>
  <service name="Services.MyService" behaviorConfiguration="metadataBehavior">
    <endpoint binding="basicHttpBinding" contract="Services.MyService"/>
    <endpoint address="/ajax" behaviorConfiguration="Services.MyServiceAspNetAjaxBehavior" binding="webHttpBinding" contract="Services.MyService"/>
  </service>
</services>
<behaviors>
  <endpointBehaviors>
    <behavior name="Services.MyServiceAspNetAjaxBehavior">
      <enableWebScript />
    </behavior>
  </endpointBehaviors>
</behaviors>
</system.serviceModel> 
```

## 2) 默认.aspx

```
<form id="form1" runat="server">
    <asp:ScriptManager ID="Scriptmanager1" runat="server">
        <Services>
            <asp:ServiceReference Path="~/MyService.svc/ajax" />
        </Services>
    </asp:ScriptManager>
</form> 
```

## 3) 一些文件.js

```
<script>
    MyService.SomeMethod(someParameter1, someParameter2, function(result) {
        alert("Success: " + result);
    }, function(err){
        alert("Error: " + err);
    });

</script> 
```

我可以在 ~/MyService.svc/ajax/jsdebug 上看到一个 js 文件，该文件具有调用我的 web 服务的功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T11:28:06.823

好吧，这是我编写和使用的代码，但是您需要为自己的 wsdl 更改一些参数。反馈是appriciated。

此外，如果有人升级并将其制成博客文章，那会很棒（我没有博客）我想很多人会需要它，这可以节省我们项目的大量时间并整理东西。

顺便说一句，我在 Linqpad 中运行此代码。这就是为什么方法不是静态的，并且在 Main() 的最后一行有一个 object.Dump() 调用

```
void Main()
{
    var svcUrl = "http://localhost:12345/MyService.svc";
    var declaration = "declare var MyService: MyServiceClient;";
    var koRef = "/// <reference path=\"../../Scripts/typings/knockout.mapping/knockout.mapping.d.ts" +
    "\" />\r\n/// <reference path=\"../../Scripts/typings/knockout/knockout.d.ts\" />";

    TypeScriptWebServiceAndKnockOutTypings(svcUrl, declaration, koRef).Dump();
}

string TypeScriptWebServiceAndKnockOutTypings(string svcUrl, string declaration, string koRef)
{
    var outputPath = @"d:\output";

    File.Delete(outputPath + ".cs");
    File.Delete(outputPath + ".dll");
    Process.Start(@"C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\x64\svcutil.exe",  " /language:cs /out:" + outputPath + ".cs " + svcUrl).WaitForExit();
    Process.Start(@"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe", " /t:library /out:"+ outputPath + ".dll  "+ outputPath + ".cs").WaitForExit();

    var a = Assembly.LoadFile(outputPath + ".dll");

    var sbEnums = new StringBuilder();
    var sbClasses = new StringBuilder();

    #region types conversions

    var dictTypesNormal = new Dictionary<Type, string>();
    dictTypesNormal.Add(typeof(Int32), "number");
    dictTypesNormal.Add(typeof(UInt32), "number");
    dictTypesNormal.Add(typeof(Int64), "number");
    dictTypesNormal.Add(typeof(UInt64), "number");
    dictTypesNormal.Add(typeof(float), "number");
    dictTypesNormal.Add(typeof(double), "number");
    dictTypesNormal.Add(typeof(bool), "bool");
    dictTypesNormal.Add(typeof(string), "string");
    dictTypesNormal.Add(typeof(Object), "any");
    dictTypesNormal.Add(typeof(DateTime), "Date");

    var dictTypesKnockout = new Dictionary<Type, string>();
    dictTypesKnockout.Add(typeof(Int32), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(UInt32), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(Int64), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(UInt64), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(float), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(double), "KnockoutObservableNumber");
    dictTypesKnockout.Add(typeof(bool), "KnockoutObservableBool");
    dictTypesKnockout.Add(typeof(string), "KnockoutObservableString");
    dictTypesKnockout.Add(typeof(Object), "KnockoutObservableAny");
    dictTypesKnockout.Add(typeof(DateTime), "KnockoutObservableDate");

    var classNames = a.DefinedTypes.Where(t => !t.IsEnum).Select(t=>t.Name).ToList();
    var enumNames = a.DefinedTypes.Where(t => t.IsEnum).Select(t=>t.Name).ToList();

    #region get type name

    Func<Type, string> getTypeNameNormal = t => {
        if(dictTypesNormal.ContainsKey(t)) 
            return dictTypesNormal[t];

        if(classNames.Contains(t.Name.Replace("[]", ""))) 
            return t.Name;

        if(enumNames.Contains(t.Name.Replace("[]", ""))) 
            return "Enum" + t.Name;

        throw new Exception(string.Format("Unknown type [{0}]", t.Name));
    };

    Func<Type, string> getTypeNameKnockout = t => {
        if(dictTypesKnockout.ContainsKey(t)) 
            return dictTypesKnockout[t];

        if(classNames.Contains(t.Name.Replace("[]", ""))) 
            return t.Name + "_KnockoutMapped";

        if(enumNames.Contains(t.Name.Replace("[]", ""))) 
            return "KnockoutObservableEnum" + t.Name + "EnumMember";

        throw new Exception(string.Format("Unknown type [{0}]", t.Name));
    };

    #endregion

    #region convert field 

    Func<string, Type, string> convertFieldNormal = null; convertFieldNormal = (pName, f) => {

        // void
        if(f == typeof(void)) 
            return "";

        // array
        if(f.IsArray)
            return string.Format("{0}{1}[]", pName, convertFieldNormal("", f.GetElementType()));

        // property
        if(!f.IsGenericType) 
            return string.Format("{0}: {1}", pName, getTypeNameNormal(f));

        // nullable
        if(f.GetGenericTypeDefinition() == typeof(Nullable<>)) 
            return string.Format("{0}: {1}", pName, getTypeNameNormal(f.GetGenericArguments()[0]));

        // dictionaries
        if(f.GetGenericTypeDefinition().ToString().Contains("Dictionary")) 
            return string.Format("{0}: {{ {1}; {2}; }}[]", pName, convertFieldNormal("Key", f.GetGenericArguments()[0]), convertFieldNormal("Value", f.GetGenericArguments()[1]));

        throw new Exception(string.Format("Unknown generic type [{0}] for property {1}", f.Name, pName));
    };

    Func<string, Type, string> convertFieldKnockout = null; convertFieldKnockout = (pName, f) => {

        // void
        if(f == typeof(void)) 
            return "";

        // array
        if(f.IsArray)
            return string.Format("{0}{1}[]", pName, convertFieldKnockout("", f.GetElementType()));

        // property
        if(!f.IsGenericType) 
            return string.Format("{0}: {1}", pName, getTypeNameKnockout(f));

        // nullable
        if(f.GetGenericTypeDefinition() == typeof(Nullable<>)) 
            return string.Format("{0}: {1}", pName, getTypeNameKnockout(f.GetGenericArguments()[0]));

        // dictionaries
        if(f.GetGenericTypeDefinition().ToString().Contains("Dictionary")) 
            return string.Format("{0}: {{ {1}; {2}; }}[]", pName, convertFieldKnockout("Key", f.GetGenericArguments()[0]), convertFieldKnockout("Value", f.GetGenericArguments()[1]));

        throw new Exception(string.Format("Unknown generic type [{0}] for property {1}", f.Name, pName));
    };

    #endregion

    #endregion

    #region enums

    foreach (var e in a.DefinedTypes.Where(t => t.IsEnum))
    {
        #region enum definition
        sbEnums.AppendLine(string.Format("enum Enum{0} {{", e.Name));

        sbEnums.AppendLine(string.Format("\t{0} = {1},", "Tümü", -1)); 

        foreach (var v in Enum.GetValues(e))
        {
            sbEnums.AppendLine(string.Format("\t{0} = {1},", v.ToString(), (int)v)); 
        }

        sbEnums.AppendLine("}");
        #endregion

        #region knockout

        sbEnums.AppendLine(string.Format(
            @"interface KnockoutObservable{0} extends KnockoutObservableBase {{
                (): {0};
                (value: {0}): void;

                subscribe(callback: (newValue: {0}) => void , target?: any, topic?: string): KnockoutSubscription;
                notifySubscribers(valueToWrite: {0}, topic?: string);
            }}", "Enum" + e.Name + "EnumMember"));

        #endregion

        #region enum member

        sbEnums.AppendLine(string.Format(
            @"class Enum{0}EnumMember {{
                constructor(public Key: Enum{0}, public Value: string) {{ }};
                public toString() {{ return this.Value }};
              }}", e.Name));

        #endregion

        #region combobox definition
        sbEnums.AppendLine(string.Format("var {0}s: Enum{0}EnumMember[] = [", e.Name));

        sbEnums.AppendLine(string.Format("\t new Enum{0}EnumMember(Enum{0}.{1}, \"{1}\"),", e.Name, "Tümü")); 

        foreach (var v in Enum.GetValues(e))
        {
            sbEnums.AppendLine(string.Format("\t new Enum{0}EnumMember(Enum{0}.{1}, \"{1}\"),", e.Name, v.ToString())); 
        }

        sbEnums.AppendLine("];");
        #endregion

        //public OnayDurumlari = ko.observable([{ Key: 3, Value: "Tümü" }, { Key: 0, Value: "Onay Bekliyor" }, { Key: 1, Value: "Onaylı" }, { Key: 2, Value: "Red" }]); 

        sbEnums.AppendLine();
    }

    #endregion

    #region classes

    #region find classes & methods

    var classes =  (from t in a.DefinedTypes
                    where t.IsEnum == false
                    let methods = (from m in t.GetMethods()
                                    where !m.IsSpecialName 
                                    && m.IsFinal 
                                    && m.IsVirtual 
                                    && m.IsHideBySig 
                                    && m.IsSecurityCritical 
                                    && !m.Name.EndsWith("Async")
                                    select m)
                    where t.DeclaredProperties.Any()
                        || methods.Any()
                    select new
                    {
                        t.Name,
                        t.DeclaredProperties,
                        methods,
                    });

    #endregion

    foreach (var t in classes)
    {
        #region interface definition

        sbClasses.AppendLine(string.Format("{1} {0} {{", t.Name, t.DeclaredProperties.Any() ? "class" : "interface"));

        foreach (var p in t.DeclaredProperties)
        {
            if(p.Name == "ExtensionData") continue;
            var f = p.GetGetMethod().ReturnType;

            sbClasses.AppendLine(string.Format("\t{0};", convertFieldNormal(p.Name, f)));
        }

        #region methods

        foreach (var m in t.methods)
        {
            sbClasses.AppendLine(string.Format("\t{0}({1}Success: ({2}) => void, Fail?: (err: Sys$Net$WebServiceError) => void ) : void;", 
                m.Name, 
                string.Concat(m.GetParameters().Select(p => convertFieldNormal(p.Name, p.ParameterType) + ", ")),
                convertFieldNormal("result", m.ReturnType)));
        }

        #endregion

        sbClasses.AppendLine("}");

        #endregion

        #region knockout

        if(t.DeclaredProperties.Any())
        {
            sbClasses.AppendLine(string.Format(@"
                interface KnockoutObservable{0} extends KnockoutObservableBase {{
                    (): {0};
                    (value: {0}): void;

                    subscribe(callback: (newValue: {0}) => void , target?: any, topic?: string): KnockoutSubscription;
                    notifySubscribers(valueToWrite: {0}, topic?: string);
                }}", t.Name));
//  
//          sbClasses.AppendLine(string.Format(@"
//              interface KnockoutObservableStatic {{
//                  (value: {0}): KnockoutObservable{0};
//                  new (value: {0}): KnockoutObservable{0};
//              }}", t.Name));

            #region KnockoutObservableArray

            sbClasses.AppendLine(string.Format(
                @"interface {0}_KnockoutObservableArray extends KnockoutObservableArrayFunctions {{
                    (): {0}_KnockoutMapped[];
                    (value: {0}_KnockoutMapped[]): void;

                    subscribe(callback: (newValue: {0}_KnockoutMapped[]) => void, target?:any, topic?: string): KnockoutSubscription;
                    notifySubscribers(valueToWrite: {0}_KnockoutMapped[], topic?: string);
                }}", t.Name));

            #endregion

            #region _KnockoutMapped
            sbClasses.AppendLine(string.Format("interface {0}_KnockoutMapped {{", t.Name));

            foreach (var p in t.DeclaredProperties)
            {
                if(p.Name == "ExtensionData") continue;
                var f = p.GetGetMethod().ReturnType;

                sbClasses.AppendLine(string.Format("\t{0};", convertFieldKnockout(p.Name, f)));
            }               
            sbClasses.AppendLine("}");
            #endregion

        }
        #endregion

        sbClasses.AppendLine();
    }

    #endregion

    #region knockout

    var sbKnockout = new StringBuilder();

    #region mapper
    sbKnockout.AppendLine("module Mapper {");
    classes.Where(c=>c.DeclaredProperties.Any()).ToList().ForEach(c=>{
        sbKnockout.AppendLine(string.Format("\texport function fromJs_{0}(r : {0}) : {0}_KnockoutMapped {{return ko.mapping.fromJS(r);}}", c.Name));
        sbKnockout.AppendLine(string.Format("\texport function toJs_{0}(r : {0}_KnockoutMapped) : {0} {{return ko.mapping.toJS(r);}}", c.Name));
        sbKnockout.AppendLine(string.Format("\texport function fromJsArray_{0}(r : {0}[]) : {0}_KnockoutMapped[] {{return r.map(k => ko.mapping.fromJS(k));}}", c.Name));
        sbKnockout.AppendLine(string.Format("\texport function toJsArray_{0}(r : {0}_KnockoutMapped[]) : {0}[] {{return r.map(k => ko.mapping.toJS(k));}}", c.Name));
    });
    sbKnockout.AppendLine("}");
    sbKnockout.AppendLine();
    #endregion

    #region knockout definitions
    sbKnockout.AppendLine("declare var ko;");
    dictTypesKnockout.Select(k=>k.Value).Distinct().ToList().ForEach(k=>{
        sbKnockout.AppendLine(string.Format("interface {0} {{}}", k));
    });
    sbKnockout.AppendLine("interface KnockoutSubscription {}");
    sbKnockout.AppendLine("interface KnockoutObservableArrayFunctions {}");
    sbKnockout.AppendLine();
    #endregion

    #endregion

    return koRef 
         + "interface Sys$Net$WebServiceError {_timedOut: bool;_message: string;_stackTrace: string;_exceptionType: string;_errorObject: {ExceptionDetail: {HelpLink: any; InnerException: any; Message: string; StackTrace: string;Type: string;};ExceptionType: string;Message: string;StackTrace: string;};}\r\n\r\n"
         + sbEnums.ToString()
         + sbClasses.ToString()
         + sbKnockout
         + declaration;
} 
```

# php - 制作表格时出错！解析错误：语法错误，第 18 行 /srv/disk6/1346207/www/standingroomonly.co.nf/form.php 中的意外“}”

> ID：15704515
> 
> 赞同：-2
> 
> 时间：2013-03-29T13:43:44.683
> 
> 标签：php, mysql, forms

尝试制作表格时出现此错误：

```
Parse error: syntax error, unexpected '}' in /srv/disk6/1346207/www/standingroomonly.co.nf/form.php on line 18 
```

当我使用这个 php 时：

```
<?php

define('DB_NAME', 'myname');
define('DB_USER', 'myuser');
define('DB_PASSWORD', 'mypassword');
define('DB_HOST', 'myhost');

$link = mysql_connect (DB_HOST, DB_USER, DB_PASSWORD);

if (!$link) {
    die('Could not connect: ' . mysql_error());
}

$db_selected = mysql_selected_db(DB_NAME, $link);

if (!$db_selected) {
    die('Can\'t use ' . DB_NAME . ': ' . mysql_error())
}

$value = $_POST['name'];

$sql = "INSERT INTO form (name) VALUES ('$value')";

if (!mysql_query($sql)) {
    die('Error: ' . mysql_error());
}

mysql_close();
?> 
```

如您所见，我正在尝试将名称文本框中的内容传输到 mySQL 数据库。但是当我按提交时出现错误！请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:44:54.290

你忘了`;`之后`mysql_error())`

代替

`if (!$db_selected) { die('Can\'t use ' . DB_NAME . ': ' . mysql_error()) }`

和

`if (!$db_selected) { die('Can\'t use ' . DB_NAME . ': ' . mysql_error()); }`

# css - Opera选择背景图像不显示

> ID：15704516
> 
> 赞同：2
> 
> 时间：2013-03-29T13:43:46.257
> 
> 标签：css, select, xhtml, background-image, opera

CSS

```
noindex:-o-prefocus, .city-list select {
    height:20px;
    margin:3px 0 0;
    background-image: url("back.png");
    background-position: 100% 100%;
    background: rgba(0,0,0,0);
    border-style:none;
} 
```

HTML

```
<div class="city-list">
    <select name="">
      <option></option>
    </select>

</div> 
```

我使用 doctype 和 background: rgba(0,0,0,0) 但不适用于歌剧 12.14。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:49:09.450

你试试 `background-color:rgba(0,0,0,0);`？

# css - 如何防止 div 与 position:relative 分配额外的空间

> ID：15704517
> 
> 赞同：2
> 
> 时间：2013-03-29T13:43:46.517
> 
> 标签：css, html

[这是jsfiddle示例](http://jsfiddle.net/MybuG/)

这是代码..

```
 <div id="xxx1"> 
     <div class="xxx1">
            txt
    </div> </div> 
```

和 CSS

```
#xxx1{
    border:1px solid black;
    min-height:25px;

}
.xxx1{
    border:1px solid green;
    height:50px;
    position:relative;
    top:-50px;
} 
```

我想从 div id "xxx1" 中删除多余的空间。怎么做？而且我不能使用固定高度，因为如果我想在该 div 中添加更多数据，我希望该 div 增加它的高度。

[这是jsfiddle示例](http://jsfiddle.net/MybuG/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:47:24.823

如果我理解了这个问题，请摆脱`padding`.`body`

[jsFiddle](http://jsfiddle.net/4EvuF/)

```
body {
    margin:0;
} 
```

您可能还会发现将和`box-sizing:border-box`集成到和`border``padding``width``height`

[jsFiddle](http://jsfiddle.net/xZxtt/)

```
#xxx1{
    box-sizing: border-box;
}
.xxx1{
    box-sizing: border-box;
} 
```

## 编辑

RE: 不.. 我想删除 div id "xxx1" 中的空格。

好吧，您可以通过多种方式做到这一点，正确的方式取决于上下文。这里有一对：

*   使用 .xxx1 定位，`position:absolute`以便将其从页面流中取出。[jsFiddle](http://jsfiddle.net/WaVSW/)

*   `height:0px`在向其添加内容时使用 JavaScript设置和设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:49:04.047

在这里尝试像这样改变它

```
.xxx1{
border:1px solid green;
height:auto;
position:relative;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-04T01:01:55.563

**您无法删除相对定位添加的间距。** 在身体上设置填充和边距不会这样做。设置 box-sizing 不会这样做。将字体大小设置为 0 不会这样做。用 javascript 做一些事情是愚蠢的。

您有以下选择：

1.  使下一项具有负边距（ick）。
2.  浮动项目，这不会允许重叠（如果你需要的话）
3.  **将外部 div 设置为相对位置，将要移动的项目设置为绝对位置（并设置顶部（或底部）和左侧（或右侧）值。这会根据其外部 div 定位要移动的项目（不是窗户）。**

3 号几乎总是最好的方法。考虑一下页面将如何随着内容的变化而变化，以确保您选择了正确的选项（以及正确的位置）。

如果您设置为相对位置的外部 div 未在空间中调整（使用顶部/底部/左侧/右侧），则该 div 没有任何多余的多余空间。如果需要调整外层div和内层div，将所有移动的div设置为absolute，最近的parent设置为relative；移动（上/下/右/左）将基于该相对父级。

# javascript - 类似于 onSelect 事件的事件？微小的

> ID：15704518
> 
> 赞同：4
> 
> 时间：2013-03-29T13:43:47.613
> 
> 标签：javascript, events, tinymce

如何在tinymce上触发文本选择事件？onselect 事件不起作用。有没有针对此的特定事件？

我是否必须改为使用鼠标向下、鼠标移动和鼠标向上？

我一直在寻找这个，但似乎不存在仅触发文本选择的事件。

谢谢

# ios - iOS 开发模拟器视图被压扁

> ID：15704519
> 
> 赞同：0
> 
> 时间：2013-03-29T13:43:53.370
> 
> 标签：ios, objective-c, view, xcode4

我刚刚开始 iOS 编程，正在学习斯坦福的 iTunesU 教程。

在第一个教程中，我们展示了如何构建一个简单的 RPN 计算器。当我在模拟器中构建和编译时正常启动，但一切都被“压扁”了。我认为这是因为 XCode 中的 View 比 iOS 模拟器大。如何在 Xcode 中调整视图的大小，或者我错过了什么。这是 iOS 模拟器视图与 xcode 的对比 ![在此处输入图像描述](../Images/024a2d1976df3cfb2731f477a4c784b7.png)

![在此处输入图像描述](../Images/54a6b1195306b0ac295dc7c198fd6f58.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:51:22.163

看起来您在 Xcode 的 Interface Builder 中的视图是 4" 视图，而模拟器正在运行 3.5" 设备。你可以改变任何一个。

Xcode 中的视图大小可以通过选择整个视图来更改，在属性检查器中，您可以在 Freeform、3.5、4 之间更改大小。

您可以通过转到硬件>设备>选择您的设备来更改模拟器中的设备

但是，重叠的按钮等更多地与使用 Auto Layout 或误用 struts 相关。您可以关闭 Auto Layout 并使用 struts，或者接受挑战来学习 Auto Layout。这是自动布局的开始：[什么是自动布局？](https://stackoverflow.com/questions/12424248/what-is-auto-layout)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:53:56.947

您正在使用最新 iPhone 的设备模拟器并没有被“压扁”，它有 4 英寸显示屏而不是 3.5 英寸。要更改设备，请转到模拟器栏中的硬件->设备。并且 iPhone 框架没有显示在最新版本的模拟器中，因此要按 Home 按钮，您可以在 Hardware->Home 下进行操作。

# algorithm - 一组学生有多少种坐成一排的方式，同班的学生必须交替坐下

> ID：15704521
> 
> 赞同：5
> 
> 时间：2013-03-29T13:44:11.270
> 
> 标签：algorithm, permutation

有`M`来自`N`班级的学生，是来自,`A[i]`的学生人数。所有这些学生都会坐成一排，有座位，同一个班级没有两个学生并排坐。`class_i``sum(A[i]) == M``M`

这些学生有多少种有效`M`的连续坐姿？

例如，如果 N = 2，A = {1, 2}，则输出应为 2；

如果 N = 2, A = {1, 3}，则输出应为 0；

如果 N = 3，A = {1, 2, 3}，则输出应为 120。

技术指标：N<47；A[i] < 47; 总和（A）< 447；

如果输出大于 1000000007，则输出（结果 % 1000000007）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:15:17.433

这个解决方案可能不是最优的，但我认为这是一个好的开始。

这个问题有两个组成部分：

1.  将每个座位标记为一类（X 种方式）
2.  为学生分配座位（Y 种方式）

最终答案等于 X*Y。

第 2 部分非常简单。Y = A(1)！*A2）！*...*一个）！

不过，计算第一部分很棘手。你可以用DP来解决它。复杂度 = N*A(1) *A(2)* ...*A(N) （这对我来说太贵了）

DP问题是：

F(a1,a2,..,an,last_letter=1) = F(a1-1,a2,..,an,last_letter!=1)+F(a1,a2-1,..,an,last_letter! =1)+...+F(a1,a2,..,an-1,last_letter!=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T14:53:29.457

首先请注意，给定输入列表的有效座位安排`A`使得，当新的大小类别到达`sum(A)=n`时，很容易计算有效座位安排的数量：`m`

*   `m`将新学生适合所有可能的`n+1`有效职位（有`n`老学生，这意味着`n+1`有效职位）。这就是组合的准确定义，`C(n+1,m)`这样的组合是有的。
*   然后排列`m`新学生以获得所有可能的有效座位安排。

因此，新尺寸级别的到来使`m`有效座位安排的数量增加了`C(n+1,m) * m!`. 这建议使用以下算法（在 Python 中）：

```
import math
import scipy.misc

def f(A) :
    if len(A) == 2 :
        a,b = A
        if a == b  : 
        # two solutions o+o+ and +o+o without order consideration, then multiply by 2! * 2! to get all possible orders within classes
            return math.factorial(a) * math.factorial(b) * 2 
        elif abs( a - b ) == 1 : 
        # o+o+o without order consideration, then multiply by 2! * 3! to get all possible orders within classes
            return math.factorial(a) * math.factorial(b)
        else : # no solution
            return 0
    else : # the number of valid arrangement is multiplied by C(n+1,m) * m!
        return sum( f(A[:i]+A[i+1:]) * scipy.misc.comb( sum(A)-ai + 1, ai ) * math.factorial(ai) for i, ai in enumerate(A) ) 
```

让我们检查一下我们得到的结果是否与 OP 的示例相同：

```
f( [ 1,2 ] )
2

f( [ 1,3 ] )
0

f( [ 1, 2, 3 ] )
120.0 
```

有用！让我们尝试三个 30 名学生的班级：

```
f( [ 30, 30, 30 ] )
2.6058794190003256e+115 # this is greater than the number of baryons in the universe! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T00:54:49.053

考虑以下python代码：

```
import math

mem={}

def get_id(A, forbidden):
    count = {}
    for a in A:
        if a<>forbidden:
            n = A[a]
            count[n] = count.get(n,0)+1
    return frozenset( [A.get(forbidden, 0)] + count.items() )

def class_seatings(A, forbidden=None):
    if sum(A.values())==1:
        if forbidden in A:
            return 0
        else:
            return 1
    ssum = 0
    for a in A:
        if a <> forbidden:
            n = A[a]
            A2 = dict(A) 
            if n==1:
                del A2[a]
            else:
                A2[a] -= 1
            id = get_id(A2, a)
            if id not in mem:
                mem[id] = class_seatings(A2, a)
            cs = mem[id]
            ssum += cs
    return ssum

def student_seatings(A):
    assert all(map(lambda x: x>0, A.values()))
    facts = map(lambda x: math.factorial(x), A.values())
    mult = reduce(lambda x,y: x*y, facts, 1)
    return mult*class_seatings(A) % 1000000007 
```

看起来它得到了正确的基本情况：

```
>>> student_seatings( {1:1, 2:2} )
2
>>> student_seatings( {1:1, 2:2, 3:3} )
120
>>> student_seatings( {1:1, 2:3} )
0
>>> student_seatings( {1:2, 2:2} )
8 
```

`mem`但是，在您提到的要求之前，使用and的基本记忆方案`get_id`开始崩溃。要看到这一点，请观看进度

```
mem={}
for upper in range(2,11):
    A = dict( (x,x) for x in range(1,upper) )   
    print len(A), student_seatings(A)
    print len(mem) 
```

产生

```
1 1
0
2 2
4
3 120
20
4 309312
83
5 579005048
329
6 462179000
1286
7 481882817
5004
8 678263090
19447
9 992777307
75581 
```

有人关心改进它吗？

# git - 长文件名停止从 github.com 拉取

> ID：15704524
> 
> 赞同：0
> 
> 时间：2013-03-29T13:44:17.770
> 
> 标签：git, github

在通过 github.com web 界面创建文件时，出现文件内容粘贴到新文件名文本框中的意外。这在 github 存储库中创建了一个非常长的文件名。文件名包含双引号、单引号、来自 M$ Word 的 utf-8 奇怪引号等...

创建此文件后，拉取请求将不起作用。我收到一条错误消息，指出 git 无法创建此文件。

由于我无法在 Windows 或 linux 上提取此文件，因此我无法删除/提交并推回存储库。有没有办法远程删除 github.com 中 git 存储库中的文件？

额外的：

我无法在 github 中编辑文件，因为单击非常长的文件名会导致 github 旋转。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T00:28:02.007

Run these commands (assuming you are talking about the master branch):

```
git clone --no-checkout *my-repo*
cd *repo*
git branch -f master origin/master^
git push -f origin master 
```

This clones the repo without checking out and then sets the master branch by one commit.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:51:17.327

在 github Web 界面中，您可以单击`Edit`此文件。在编辑模式下，您可以重命名文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T00:13:51.600

我写信给 GitHub 支持，他们说：

> “将要，
> 
> 好的，是的。那是一个很长的名字。我们不应该让这种情况发生。非常感谢您指出这一点。
> 
> 我们目前没有办法从网络上删除文件，但我认为很明显我们一直在考虑并朝着这个方向前进。我要告诉在那个地区工作的人这件事。”

如果它可以帮助其他人，对于 Windows，我想出了一个使用 DOS 8.3 命名约定的解决方案。我在 DOS 中创建了一个文件，它使用长文件名的前六个字符加上波浪号，然后是数字索引。

In this case, I created a file in my working directory called `02_RUL~2`. Then I could do git status, which showed the name change, then I could commit that, push to the repository, and then delete the new short file name, without ever having to pull the existing file down from the repository. Who would have thought that stupid naming convention would help some day?

# php - 在 PHP/MySQL 中手动转义

> ID：15704525
> 
> 赞同：0
> 
> 时间：2013-03-29T13:44:29.307
> 
> 标签：php, escaping

我尝试理解 PHP 中的手动转义。我读了这个例子：

```
    如果（$_POST）
  {    
    $query = '更新
                赫斯特勒
              放
                zulieferer = \''.mysql_real_escape_string($_POST['zulieferer']).'\',
                Telefon = \''.mysql_real_escape_string($_POST['telefon']).'\',
                城市 = \''.mysql_real_escape_string($_POST['telefax']).'\'
              在哪里
                id = '.$_POST['id'];
    $update = mysql_query ($query) 或死 (mysql_error());
  }

```

该语句以撇号开头。不幸的是，我找不到描述。

第一部分？'更新赫斯特勒 SET zulieferer = \'

第二部分？'.mysql_real_escape_string($_POST['zulieferer'])。'

第三部分？', 电话 = \'

第 4 部分？'.mysql_real_escape_string($_POST['telefon'])。'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:47:04.190

第一部分是这样的：

```
'UPDATE 
            hersteller 
          SET
            zulieferer = \'' 
```

注意额外的`'`。

转义字符`\`用于转义第`'`一个字符，以便将其作为字符插入到字符串中，而不是解释为字符串的结尾。

它类似于：

```
$message = 'Let\'s get started';

$query = 'INSERT INTO table SET value = \'' . $value . '\''; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:47:17.657

一个`\`字符将后面的字符标记为“纯文本”或没有意义的文本。这样，您的输出将如下所示`zuliefer = 'thevalue'`。

对于这个例子，如果你不想转义所有字符，你可以用双引号开始变量。

```
$query = "UPDATE 
        hersteller 
      SET
        zulieferer = '" . mysql_real_escape_string($_POST['zulieferer'])."',
        telefon    = '".mysql_real_escape_string($_POST['telefon'])."',
        city        = '".mysql_real_escape_string($_POST['telefax'])."'
      WHERE 
        id = '".$_POST['id'] . "'";
$update = mysql_query ($query) or die (mysql_error()); 
```

-[更多阅读 PHP 字符串中的单引号和双引号](https://stackoverflow.com/questions/3446216/what-is-the-difference-between-single-quoted-and-double-quoted-strings-in-php)

-[更多关于逃跑的阅读](https://stackoverflow.com/questions/10646142/what-does-it-mean-to-escape-a-string)

-[关于字符串和其中符号含义的 PHP 手册](http://php.net/manual/en/language.types.string.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:48:55.237

该代码有点难以阅读，原因有两个：

1.  它在 SQL 语句和 php 字符串中使用单引号
2.  它是一个跨越多行的长字符串

这可能更容易阅读：

```
$query = 'UPDATE '.
         '   hersteller '.
         'SET '.
         '   zulieferer = "'.mysql_real_escape_string($_POST['zulieferer']).'", '.
         '   telefon    = "'.mysql_real_escape_string($_POST['telefon']).'", '.
         '   city       = "'.mysql_real_escape_string($_POST['telefax']).'" '.
         ' WHERE  '.
         '   id = '.$_POST['id']; 
```

**编辑：**关于您的评论：

```
$query = "DELETE FROM description WHERE id = '" . $this->getId() . "'"; 
```

这与我上面重写的目的相同，只是交换了单引号和双引号的使用。它在 SQL 中使用双引号作为 php 字符串分隔符和单引号。两种变体都很好，因为 PHP 和 MySQL 都允许使用这两种引号。您的 $query 变量实际上将包含`DELETE FROM description WHERE id = '1234'`. 但是请注意，两个版本在语法上并不相同。PHP 处理双引号与单引号有点不同。在双引号中，PHP 将用该变量的内容替换变量名，而在单引号中则不会。

```
$query = "DELETE FROM description WHERE id='$id'"; <-- PHP will insert the variable $id
$query = 'DELETE FROM description WHERE id="$id"'; <-- PHP will not touch the string 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T13:50:29.783

> 该语句以撇号开头。不幸的是，我找不到描述。

在 PHP 中，您可以使用一对`'`或一对`"`. 主要区别在于`"`-strings也被评估以寻找`$`变量。

对于这两种字符串类型，您显然可以转义`'`or`"`字符以使其出现在字符串中：

```
echo "He said \"Welcome\".";
// He said "Welcome". 
```

例如，在您的情况下，假设 POST 变量等于`x`：

```
'zulieferer = \''.mysql_real_escape_string($_POST['zulieferer']).'\''
// zulieferer = 'x' 
```

由于该字符串不使用`"`，我建议您将其重构为：

```
$a = mysql_real_escape_string($_POST['zulieferer']);
$b = mysql_real_escape_string($_POST['telefon']);
$c = mysql_real_escape_string($_POST['telefax']);
$d = (int) $_POST['id'];
$query = "UPDATE hersteller 
          SET zulieferer = '$a', telefon = '$b', city = '$c'
          WHERE id = $d"; 
```

*附带说明：[您不应该](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)使用`mysql_*`函数。请改用准备好的语句。*

# wcf - WCF RESTful 服务 - HTTP POST 请求

> ID：15704537
> 
> 赞同：3
> 
> 时间：2013-03-29T13:45:00.783
> 
> 标签：wcf, http-post, httprequest, fiddler

我使用以下发布方法开发了 WCF 服务：

```
[OperationContract]
[WebInvoke(Method = "POST",
    ResponseFormat = WebMessageFormat.Json,
    BodyStyle = WebMessageBodyStyle.Wrapped,
    UriTemplate = "/InsertBearingData")]
bool InsertBearingData(String JSONString); 
```

我正在使用 Fiddler 为这个方法制定一个 HTTP POST 请求，但是它正在返回`Status Code - 400 Bad Request`. 这是制定的要求：

**请求标头：**

```
Host: localhost:21468
Content-Length: 96
Content-Type: application/json 
```

**请求正文：**

```
[{"start time":"29-03-2013 11:20:11.340","direction":"SW","end time":"29-03-2013 11:20:14.770"}] 
```

你能告诉我如何制定一个好的请求以获得成功的响应吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T15:10:41.200

您的代码中有几个问题：

*   参数的数据类型是字符串，但你传递的是一个 JSON 数组给它；字符串参数需要传递 JSON 字符串。
*   操作的主体样式设置为`Wrapped`，这意味着参数应该被*包装*在一个对象中，该对象的键是参数名称，例如`{"JSONString":<the actual parameter value>}`

要接收与您发送的请求类似的请求，您需要进行如下操作：

```
[ServiceContract]
public interface ITest
{
    [WebInvoke(Method = "POST",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Bare,
        UriTemplate = "/InsertBearingData")]
    bool InsertBearingData(MyType[] param);
}

[DataContract]
public class MyType
{
    [DataMember(Name = "start time")]
    public string StartTime { get; set; }
    [DataMember(Name = "end time")]
    public string EndTime { get; set; }
    [DataMember(Name = "direction")]
    public string Direction { get; set; }
} 
```

# .net - 如何在 Excel 中表达 NaN 值？

> ID：15704538
> 
> 赞同：7
> 
> 时间：2013-03-29T13:45:08.420
> 
> 标签：.net, excel

我正在编写一个 .NET 程序，它生成一个在 Excel 中打开的 XML 文档。细胞通常看起来像：

```
 <ss:Cell>
      <ss:Data ss:Type="Number">123</ss:Data>
    </ss:Cell> 
```

但有时我写的值有 NaN、DIV/0 或 INF。在这些情况下，123 将被该文本值替换，并且 Excel 不会因为文本而打开文件。

我不认为 Excel 有常量，所以我不确定如何处理这种情况，而不是输入一个“-1”值。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T23:39:14.937

以下是 Excel 知道的以 XML 格式存储的不同错误代码：

```
<Cell><Data ss:Type="Error">#DIV/0!</Data></Cell>
<Cell><Data ss:Type="Error">#NUM!</Data></Cell>
<Cell><Data ss:Type="Error">#VALUE!</Data></Cell>
<Cell><Data ss:Type="Error">#N/A</Data></Cell>
<Cell><Data ss:Type="Error">#NAME?</Data></Cell>
<Cell><Data ss:Type="Error">#REF!</Data></Cell>
<Cell><Data ss:Type="Error">#NULL!</Data></Cell> 
```

只有前两个与您的问题相关，但为了完整起见，我添加了其他两个。

> 但有时我写的值有 NaN、DIV/0 或 INF

`DIV/0`映射到`#DIV/0!`. 我认为 Excel 之间`NaN`或`INF`在 Excel 中没有区别，它们似乎都表示为`#NUM!`. 例如，以下两个公式都导致`#NUM!`，即使第一个是无效数字而第二个非常大。

```
=ASIN(2)
=EXP(EXP(10)) 
```

有趣，很难用：Excel 允许您毫无问题地将这些文字错误值（包括所有标点符号）输入到工作表的单元格中。从某种意义上说，这些*是*内置常量。

# android - 工作灯选项菜单

> ID：15704539
> 
> 赞同：3
> 
> 时间：2013-03-29T13:45:08.733
> 
> 标签：android, ibm-mobilefirst, android-optionsmenu

我正在尝试在 WL 应用程序中实现 optionsMenu，在 Android 中对其进行测试（我的项目设置中的 sdk 级别 10，运行时为 Android 4.0.3）。但没有菜单可用。我通过 HTC usb 直通连接到我的本地服务器，所以我必须处理工作灯设置以更改网络地址。

我浏览了 IBM 文档（WL 入门和信息中心），但没有完整的解释/代码。

这是我的问题/问题：

1）如何处理 application-descriptor.xml 中的工作灯设置（我需要将其作为附加的 optionsMenu 项访问以进行本地测试）：

```
<android version="1.0">
    <worklightSettings include="true"/> 
```

2) 我应该在哪里初始化 optionsMenu？（我在我的 html 页面中调用 document.ready jquery 函数中的一个函数）

3) 我在 Android/native/res/drawable 中放了图标 (xxxx.png)，够了吗？

4) android sdk level 10 有具体问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:54:20.177

从**API Level 10**开始，Google 开始引入新的 UI 控件。其中之一是操作栏，它是选项菜单的继承者。Worklight 不完全支持操作栏。

作为一种解决方法，`AndroidManifest.xml`将 更改`minSdkValue`为`8`，这将带回“常规” `OptionsMenu`。我们希望在未来的版本中更好地处理这种情况。

1.  你已经正确地声明了它。
2.  `wlCommonInit()`您可以在（位于`yourProject\apps\yourApp\common\js\appName.js`）中初始化它
3.  是的。确保它们具有每个 DPI（文件夹）的正确分辨率。但是，我会将它们放入 中`nativeResources\res\<dpiFolder>`，因为如果您碰巧删除了本机文件夹，这些图像也会消失。通过将它们放入`nativeResources`，一旦在构建时创建它们，它们将被复制到本机文件夹。
4.  是的，见上文。

# java - MongoDB 聚合不能使用 $limit 两次

> ID：15704540
> 
> 赞同：0
> 
> 时间：2013-03-29T13:45:11.187
> 
> 标签：java, mongodb, aggregation-framework, jongo

我有以下`MongoDB`集合“ `Games`”：

```
{ 
"_id" : ObjectId("515461d3c6c18efd4a811fd3"), 
"gameid" : NumberLong("86982207656"), 
"tableName" : "Hydra Zoom 40-100 bb", 
"nplayers" : 6, 
"playersList" : [   
                                    {           "exist" : true,         
                                                        "suspended" : false,
                                                        "grade" : 0,
                                                        "clusterId" : -1,
                                                        "playerid" : "DoomY9999",
                                                        "playsWithFriends" : 0,
                                                        "squeezePlay" : 0,
                                                        "weakShowdown" : 0,
                                                        "numberOfPlays" : 1
                                     },
                                  {
                                                        "exist": true,
                                                        "suspended" : false, 
```

我想将以下**MySQL**查询映射到 MongoDB

```
String query = "SELECT idplayer, COUNT(idplayer) AS countplayer "
                    + "FROM (SELECT b.idgame, b.idplayer "
                    + "FROM associations a, associations b "
                    + "WHERE a.idplayer=? "
                    + "AND b.idgame=a.idgame "
                    + "AND b.idplayer <> ? "
                    + "ORDER BY b.idgame DESC LIMIT 1000) as c"
                    + " GROUP BY idplayer "
                    + "ORDER BY countplayer DESC LIMIT 5;"; 
```

**查询描述**：此 SQL 查询计算出现与玩家“X”玩同一游戏的最频繁玩家。结果将是玩家的名字和一起玩的次数

LIMIT 的简短说明：第一个“ `LIMIT 1000`”实际上是我们要检查的游戏的限制，因为数据库可能非常大，我们只分析按 DESC 顺序排列的最后 1000 场游戏（最近有更高的“ `gameid`”）。

第二个限制5：用于“前5”的朋友。我们将总结他们的人数。

**到目前为止，我已经完成了：**几乎所有使用聚合框架的东西，都为`"ORDER BY b.idgame DESC LIMIT 1000) as c"`. 这对我来说很重要，因为它经历的游戏数量可能非常高。

这是我在**MongoDB**（Java 驱动程序）中的查询：

```
 //build the query
    DBObject match1 = new BasicDBObject("$match", new BasicDBObject("playersList.playerid",_playerid));
    DBObject unwind = new BasicDBObject("$unwind", "$playersList");
    DBObject match2 = new BasicDBObject("$match", new BasicDBObject("playersList.playerid",new BasicDBObject("$ne",_playerid)));

    DBObject groupFields = new BasicDBObject("_id","$playersList.playerid");
    groupFields.put("times", new BasicDBObject("$sum",1));
    DBObject group = new BasicDBObject("$group", groupFields);
    DBObject sort = new BasicDBObject("$sort", new BasicDBObject("times",-1) );
    DBObject limit = new BasicDBObject("$limit", 5 );

    DBObject group2 = new BasicDBObject("$group", "gameid");
    DBObject sort2 = new BasicDBObject("$sort", new BasicDBObject("gameid",-1) );
    DBObject limit2 = new BasicDBObject("$limit", 1000 );

    DB db = mongoDb;
    DBCollection coll = db.getCollection("games");

    //aggregation query
    //THIS WORKS
    AggregationOutput output = coll.aggregate( match1, unwind, match2, group, sort, limit);

    //THIS DOESN'T WORK!
     AggregationOutput output = coll.aggregate( match1, unwind, match2, group, sort, limit, group2, sort2, limit2); 
```

请帮我解决这个查询。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T04:55:36.560

第一次操作后该字段`game`不在结果中，因此基于该字段的第二次操作将不起作用。`group``group``game`

为了更有效的查询，您应该重新排序聚合操作以尽早减少数据。我在展开 playerList 之前移动了比赛的匹配，没有必要拥有第二组。

聚合操作在 mongo shell 中是这样的：

```
// playerId to search for coplayers
var playerId = "DoomY9999"

db.game.aggregate([
    // First $match can take advantage of suitable index if available

    // Find all games that playerid X has played
    { $match : { "playersList.playerid" : playerId } },

    // Sort by most recent games (gameid descending)
    { $sort : { "_id.gameid" : -1 } },

    // Limit number of games to examine
    { $limit : 1000 },

    // Create a stream of documents from the playersList array
    { $unwind : "$playersList" },

    // Match players except for playerid X
    { $match : { "playersList.playerid" : {$ne : playerId }} },

    // Count number of games each player has played
    { $group : {
        _id : "$playersList.playerid",
        count : { $sum : 1 }
    }},

    // Sort by most frequent players (count descending)
    { $sort : { "count" : -1 } },

    // Limit results to 5 players
    { $limit : 5 },

    // Rename the result fields
    { $project : {
        _id : 0,
        coplayer : "$_id",
        count : 1
    }}
]) 
```

# tkinter - ubuntu 中的 Python Tkinter

> ID：15704542
> 
> 赞同：1
> 
> 时间：2013-03-29T13:45:16.470
> 
> 标签：tkinter

我在 ubuntu 中给出这个命令

```
def gui_c(self):   
    self.button1=Button(app,text="Search",command=self.search_())
    self.button1.grid() 
```

我想`search_()`通过单击此按钮来发挥作用。但在单击此函数之前，已调用此函数并且未执行 self.button1.grid()。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T16:19:52.067

要传递函数而不是执行它，去掉 () 括号，所以使用`command=self.search_`代替`command=self.search_()`

这是python引用函数本身的方式。例如：

```
>>> def foo():
...     print("Spam eggs bacon and spam")
... 
>>> foo()
Spam eggs bacon and spam

>>> foo
<function foo at 0x7f4dac4ec2a8>

>>> a = foo
>>> a
<function foo at 0x7f4dac4ec2a8>

>>> a()
Spam eggs bacon and spam 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T08:56:32.547

你只需要写：

```
def gui_c(self):   
    self.button1=Button(app,text="Search",command=self.search_)
    self.button1.grid() 
```

当我刚接触 Tkinter 时，我也有这个疑问。

# asp.net - 将 asp.net - SQL Server 站点移动到新主机时如何最大限度地减少停机时间？

> ID：15704543
> 
> 赞同：1
> 
> 时间：2013-03-29T13:45:23.187
> 
> 标签：asp.net, sql-server, asp.net-mvc

我们正在将带有 sql server 2012 db 的活动 ASP.NET 站点迁移和升级到新的托管公司，并希望最大限度地减少停机时间。

我们的计划：

1.  重新创建数据库并在新主机上发布升级后的解决方案
2.  测试新安装
3.  关闭活动站点
4.  将域名指针指向新主机

在迁移和测试期间（上述步骤 1 和 2），现有站点将保持活动状态，用户将继续创建和更新记录。（这可能需要数小时的测试和修复，我们宁愿不要关闭那么久。用户可能会在数十个表中创建数百条新记录。）

完全恢复旧数据库的最终备份是用旧数据库的最终记录更新新数据库的最佳（或唯一）方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:07:46.737

您的计划听起来不错，尽管您没有协调数据库的步骤。完全恢复将是更容易的途径，但根据大小，它可能会增加您的停机时间。您的另一个选择是只移动您需要的数据，但是“数十个”表可能会使它变得更加复杂。如果您能找到一种简单的方法来协调新记录，那可能会更快。你的步骤是

1.  （相同）重新创建数据库并在新主机上发布升级后的解决方案
2.  （相同）测试新安装（这可能需要一段时间......并且要彻底。你说“几个小时”但此时并不着急）
3.  （相同）使用某种类型的“我们正在移动并将关闭几个小时”消息关闭活动站点
4.  （新）现在站点已关闭，您可以将数据库与完全恢复或新记录进行协调。这将导致您的停机时间（除了 DNS 更改延迟）
5.  （相同）一旦 DB 好，更新 DNS

在第 2 步期间，我将模拟第 4 步运行，这样您就可以很好地了解您预计会宕机多长时间......同时进行完全恢复和部分恢复。

# redirect - iMacros 阻止重定向

> ID：15704545
> 
> 赞同：2
> 
> 时间：2013-03-29T13:45:30.123
> 
> 标签：redirect, imacros, url-redirection

我正在使用 iMacros 制作自动化脚本。在我的过程中的某个时刻，一个网页被调用，它立即重定向到我应该继续我的测试的支付提供商。在到达支付页面时（被重定向后），脚本超时。但是，当我直接从付款页面运行相同的规则时，它可以正常工作。

我看不出什么会影响脚本，除了重定向。

程序：

1.  访问表格
2.  填写表格
3.  确认购物篮
4.  点击前往支付提供商
5.  加载重定向页面，构建支付提供商数据以发送
6.  重定向到支付提供商
7.  点击信用卡继续付款。TAG 命令找不到信用卡图像，但是当我使用相同的命令运行不同的脚本，但从这个页面作为起点时，它可以工作。

有什么建议可以让 iMacros 处理重定向吗？

# scala - 在不断增长的 scala.collections.mutable.Queue 上是否有一种优雅的方式来 foldLeft？

> ID：15704547
> 
> 赞同：7
> 
> 时间：2013-03-29T13:45:36.003
> 
> 标签：scala, functional-programming, queue, mutable

我有一个递归函数，我试图`@tailrec`通过让内部递归部分 ( `countR3`) 将元素添加到队列 ( `agenda`is a `scala.collections.mutable.Queue`) 来实现。我的想法是让函数的外部部分覆盖议程并总结结果。

注意：这*是*一个家庭作业问题，因此我不想发布整个代码；然而，实现尾递归*并不是*功课的一部分。

这是与我的问题相关的代码部分：

```
import scala.collection.mutable.Queue

val agenda: Queue[Tuple2[Int, List[Int]]] = Queue()

@tailrec
def countR3(y: Int, x: List[Int]): Int = {
  if (y == 0) 1
  else if (x.isEmpty) 0
  else if …
  else {
    agenda.enqueue((y - x.head, x))
    countR3(y, x.tail)
  }
}
⋮
agenda.enqueue((4, List(1, 2)))
val count = agenda.foldLeft(0) {
  (count, pair) => {
    val mohr = countR3(pair._1, pair._2)
    println("count=" + count + " countR3=" + mohr)
    count + mohr
  }
}
println(agenda.mkString(" + "))
count 
```

这*似乎*可行……问题在于它不会遍历添加到议程中的所有项目，但它确实会处理其中的*一些*。您可以在下面的输出中看到这一点：

```
count=0 countR3=0
count=0 countR3=0
count=0 countR3=0
(4,List(1, 2)) + (3,List(1, 2)) + (2,List(2)) + (2,List(1, 2)) + (1,List(2)) + (0,List(2)) 
```

[最终议程的六个项目中，仅处理了前三个。]

当你在 Java 中迭代集合时，我通常很清楚改变集合的危害。但是队列是一种不同颜色的马。当然，我知道我可以简单地编写一个命令式循环，如下所示：

```
var count = 0
while (!agenda.isEmpty) {
  val pair = agenda.dequeue()
  count += countR3(pair._1, pair._2)
} 
```

这工作得很好，但这是 Scala，我正在探索是否有一种*功能更优雅*的方式。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T12:35:39.577

虽然可能不完全地道，但您可以试试这个：

```
Stream.continually({ if (agenda.isEmpty) None else Some(agenda.dequeue()) }).
    takeWhile(_.isDefined).flatten.
    map({ case (x, y) => countR3(x, y) }).
    toList.sum 
```

*   `Stream.continually({ if (agenda.isEmpty) None else Some(agenda.dequeue()) })`为您提供了无限的队列项目流，其中包含`Option[Tuple2[Int, List[Int]]]`.
*   然后，一旦遇到第一个项目，即当队列耗尽时，`takeWhile(_.isDefined)`就切断序列。`None`
*   由于前面的调用仍然产生一个`Option`s 序列，我们需要用`flatten`.
*   `map({ case (x, y) => countR3(x, y) })`基本上将您的功能应用于每个项目。
*   最后，`toList`强制评估流（这就是我们正在使用的），然后`sum`计算列表项的总和。

我认为问题`agenda.foldLeft`（它只处理“一些”排队的项目）是我猜它需要一个（可能不可变的）当前排队项目的列表，因此不受计算期间添加的项目的影响。

# php - 将空值设置为不在 MySQL 中的日期

> ID：15704554
> 
> 赞同：3
> 
> 时间：2013-03-29T13:45:51.157
> 
> 标签：php, mysql, date-formatting

因此，我正在使用该代码从 MySQL 获取一些数据：

```
<?
$query=mysql_query("SELECT date,COUNT(*) as num FROM downloads WHERE prjID='".$_GET['id']."' GROUP BY date ORDER BY date ASC");
$num=mysql_num_rows($query);
$res='';
$i=0;
while($row=mysql_fetch_array($query)){

$i++;
$date=date("d.m.Y", strtotime($row['date']));

$dan=date("d", strtotime($row['date']));
$mesec=date("m", strtotime($row['date']));
$leto=date("Y", strtotime($row['date']));

if($i=1){
$danPrvi=$leto.", ".($mesec-1).", ".$dan;
$dan1=date("d", strtotime(time()));
$mesec1=date("m", strtotime(time()));
$leto1=date("Y", strtotime(time()));
$danZadnji=$leto1.", ".($mesec1-1).", ".$dan1;
}

$numb=1;

if($row['num']!=1){
$res.="[Date.UTC(".$leto.",".($mesec-1).",".$dan."),".$row['num']."], ";
}
else{
if($i!=$num){
$res.="[Date.UTC(".$leto.",".($mesec-1).",".$dan."),".$numb."], ";
}
else{
$res.="[Date.UTC(".$leto.",".($mesec-1).",".$dan."),".$numb."]";
}
}
}
?> 
```

我得到这样的结果：

```
1.3.2013 - 1
6.3.2013 - 5 
```

但我想得到这样的结果：

```
1.3.2013 - 1
2.3.2013 - 0
3.3.2013 - 0
4.3.2013 - 0
5.3.2013 - 0
6.3.2013 - 1 
```

我也在使用 Highcharts，所以日期值的格式必须像 Date.UTC(year, month-1, day)

# 编辑：

我的数据库中没有所有日期。在我的例子中，只有 1.3.2013 和 6.3.2013，那么我将如何检测并设置 0 值之间的所有日期，没有值 >=1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T14:02:19.417

我想您需要做的是设置一个构造来保存您感兴趣的日期，并在查询中使用它或对查询数据进行后处理。例如：

```
<?php
$query=mysql_query("SELECT date,COUNT(*) as num FROM downloads WHERE prjID='".$_GET['id']."' GROUP BY date ORDER BY date ASC");
$num=mysql_num_rows($query);

// Get the first and last dates in the result set
$firstRow = mysql_result($query, 0);
$lastRow = mysql_result($query, $num-1);

// Now make thos the begin and end dates
$beginDate = new DateTime(strtotime($firstRow['date']));
$endDate = new DateTime(strtotime($lastRow['date']));
$currentDate = $beginDate;
$interestingDates = array();

// Populate our interestingDates array with all counts set to 0
while ($currentDate <= $endDate){
    $interestingDates[$currentDate->format('d.m.Y')] = 0;
    $currentDate->add(new DateInterval('P1D'));
}

// Reset the data result for looping over
mysql_data_seek($query,0);
while($row=mysql_fetch_array($query)){
    // Go ahead and format the string
    $formatedString = date("d.m.Y", strtotime($row['date']));

    // If the string is in our interestingDates array, update the count
    if (array_key_exists($formatedString, $interestingDates)){
        $interestingDates[$formatedString] = $row['num'];
    }
}

// Print it out
foreach ($interestingDates as $key=>$value){
    print "$key - $value\n";
} 
```

**注意 1：** [mysql_query](http://php.net/manual/en/function.mysql-query.php) *自 PHP 5.5.0 起已弃用，将来将被删除。请使用另一个 API - 我推荐* [pdo_mysql](http://www.php.net/manual/en/ref.pdo-mysql.php)。

**注 2：** *当前查询未参数化。使用 PDO，这可能看起来像：*

```
$sth = $dbh->prepare('SELECT date,COUNT(*) as num FROM downloads WHERE prjID= :prjID GROUP BY date ORDER BY date ASC');
$sth->bindParam(':prjID', $_GET['id'], PDO::PARAM_INT);
$sth->execute(); 
```

*免责声明*-我实际上并没有运行此代码，我只是将其写在脑海中。您可能需要对其进行测试/调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T15:42:39.190

**警告**！在 SQL 中这样做是一种非常糟糕的风格，但如果你愿意——你可以:)

[http://sqlfiddle.com/#!2/b491a/1/0](http://sqlfiddle.com/#!2/b491a/1/0)

```
SELECT dynamic_date AS date, COUNT(downloads.date) AS num FROM (
    SELECT DATE_ADD(start, INTERVAL i - 1 DAY) AS dynamic_date, prjID FROM
      (
        SELECT @i := @i + 1 AS i FROM 
        (SELECT 0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t1,
        (SELECT 0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t2,
        (SELECT 0 UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) t3,
        (SELECT @i:=0) init
      ) i_sequence,
      (SELECT MIN(date) start, MAX(date) finish, prjID FROM downloads WHERE prjID=5 GROUP BY prjID) minmax
    WHERE DATE_ADD(start, INTERVAL i - 1 DAY) <= finish
) date_sequence
LEFT JOIN downloads ON dynamic_date = downloads.date and downloads.prjID=date_sequence.prjID
GROUP BY dynamic_date
; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:54:44.267

假设您有所有日期的数据，而不是特定 id 的数据，您可以进行条件总和：

```
SELECT date, sum(case when prjID='".$_GET['id']."' then 1 else 0 end) as num
FROM downloads
GROUP BY date
ORDER BY date ASC 
```

# vb.net - System.ArgumentOutOfRangeException 是什么意思？(vb.net)

> ID：15704555
> 
> 赞同：2
> 
> 时间：2013-03-29T13:45:55.157
> 
> 标签：vb.net, first-chance-exception

我**在 mscorlib.dll 中发生了“System.ArgumentOutOfRangeException”类型的第一次机会异常**，它正在影响我的程序。这是我的代码。下面是我对代码的文字摘要。

```
Private Sub Group_LeaderTextBox_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles Group_LeaderTextBox.LostFocus
    Dim ListCounter As Integer
    Dim Checker As Integer = 0
    Dim NewString As String

    If Group_LeaderTextBox.Text <> "" Then
        If ListBox_ParticipantsNames.Items.Count = 0 Then
            ListBox_ParticipantsNames.Items.Add(Group_LeaderTextBox.Text & " (Group Leader)")
        Else
            For ListCounter = 0 To ListBox_ParticipantsNames.Items.Count - 1
                If ListBox_ParticipantsNames.Items.Item(ListCounter).ToString.Substring(0) = Group_LeaderTextBox.Text Then
                    If ListBox_ParticipantsNames.Items.Item(0).ToString.Substring(ListBox_ParticipantsNames.Items.Item(0).ToString.Length - 14) = "(Group Leader)" Then
                        NewString = ListBox_ParticipantsNames.Items.Item(0).ToString.Replace(" (Group Leader)", "")
                        ListBox_ParticipantsNames.Items.RemoveAt(0)
                        ListBox_ParticipantsNames.Items.Insert(0, NewString)
                    End If
                    ListBox_ParticipantsNames.Items.RemoveAt(ListCounter)
                    ListBox_ParticipantsNames.Items.Insert(0, Group_LeaderTextBox.Text & " (Group Leader)")
                    Exit For
                Else
                    Checker += 1
                End If
            Next

            If Checker = ListBox_ParticipantsNames.Items.Count Then
                If ListBox_ParticipantsNames.Items.Item(0).ToString.Substring(ListBox_ParticipantsNames.Items.Item(0).ToString.Length - 14) = "(Group Leader)" Then
                    ListBox_ParticipantsNames.Items.RemoveAt(0)
                    ListBox_ParticipantsNames.Items.Insert(0, Group_LeaderTextBox.Text & " (Group Leader)")
                Else
                    ListBox_ParticipantsNames.Items.Insert(0, Group_LeaderTextBox.Text & " (Group Leader)")
                End If
            End If
        End If
    Else
        If ListBox_ParticipantsNames.Items.Item(0).ToString.Substring(ListBox_ParticipantsNames.Items.Item(0).ToString.Length - 14) = "(Group Leader)" Then
            ListBox_ParticipantsNames.Items.RemoveAt(0)
        End If
    End If
End Sub 
```

因此，此代码用于在文本框“Group_LeaderTextBox”（我们称之为“X”）失去焦点时向列表框添加值。

逻辑是这样的（按编写代码的顺序）：

但首先，一些先决条件：

*   有两种方法可以将项目添加到列表框中，一种是通过 X（失去焦点），第二种是通过另一个文本框（我们称之为“Y”）。（不重要）
*   X 中添加到列表框中的所有文本首先出现在列表框中，无论列表框中已经存在什么。
*   来自 X 的文本，比如“John”，当添加到列表框中时，将显示添加的字符串“(Group Leader)”。因此，在失去焦点时，“John”将显示为“John (Group Leader)”。请记住，也可以有来自 Y 的输入，但是来自 Y 的输入只是它包含的文本。
*   如果（失去焦点）X 为空，则如果列表框中的第一项包含子字符串“（组长）”，它将被删除。因此，如果从 X 中删除“John”，则将删除“John (Group Leader)”。如果没有组长，什么都不会发生。

逻辑：

假设我在 X 中输入了“John”。失去焦点时，如果列表框为空，“John (Group Leader)”将简单地添加到列表框中。否则，例如，如果我已经通过 Y 向列表框中添加了一些项目，程序将检查列表框中是否已经存在“John”。如果有，并且列表中没有组长，则项目“John”将替换为添加到列表顶部的“John（组长）”（这不起作用）。如果已经有组长，“John（组长）”仍然会出现在最上面，但之前的组长会被降级。因此，如果之前的 "Dick" :P 是之前的组长，则字符串 "(Group Leader)" 将从 "Dick (Group Leader)" 中删除。

现在，如果在检查整个列表后，没有与“John”匹配的项目，那么程序将像以前一样检查是否已经有组长。如果有，那么之前的组长将被简单地替换为“John（组长）”。如果没有任何组长，那么“John（组长）”将被简单地添加到列表的顶部（这也不起作用）。

**问题 1（场景）**

X：约翰

名单：
约翰·
瑞奇
·简

或（无论列表的顺序如何）

名单：
瑞奇
·约翰·
简

在 X 失去焦点时，项目“John”应该已被删除并替换为添加到列表顶部的“John (Group Leader)”，但什么都没有发生。

**问题 2（场景）**

X：约翰

名单：
瑞奇
简

在 X 失去焦点时，“John (Group Leader)”应该被添加到列表的顶部，但什么都没有发生。

因此，每当我遇到这些问题时，异常都会出现在我的即时窗口中。谁能帮我？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:11:56.713

由于您只提供了一个小代码片段，因此很难诊断所有程序的逻辑，但至于您遇到的错误，您的参与者名称是否可能少于 14 个字符？看这一行：

```
If ListBox_ParticipantsNames.Items.Item(0).ToString.Substring(ListBox_ParticipantsNames.Items.Item(0).ToString.Length - 14) = "(Group Leader)" Then 
```

您可能会遇到先有鸡还是先有蛋的问题，如果您的第一个参与者的姓名不以“（组长）”结尾，那么您添加它，但如果它不以“（组长）”结尾，那么您会收到错误消息。如果`ListBox_ParticipantsNames.Items.Item(0).ToString.Length`小于 14，您将得到一个负数，这将产生索引超出范围异常。

请参阅文档： http:
[//msdn.microsoft.com/en-us/library/hxthx5h6 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/hxthx5h6(v=vs.100).aspx)

> ArgumentOutOfRangeException：startIndex 小于零或大于此实例的长度。

执行以下操作可能更容易：

```
Dim l_participantName As String = ListBox_ParticipantsNames.Items.Item(0).ToString()
l_participantName = l_participantName.PadLeft(14) ' Guarantees the length of the string is at least 14 characters
If l_participantName.Substring(l_participantName.Length - 14) = "(Group Leader)" Then 
```

更容易：

```
If ListBox_ParticipantsNames.Items.Item(0).ToString.EndsWith("(Group Leader)") Then 
```

# php - Facebook::getLoginUrl() 返回错误的 url

> ID：15704563
> 
> 赞同：0
> 
> 时间：2013-03-29T13:46:16.017
> 
> 标签：php, facebook, sdk

我正在尝试在我的网站上添加 Facebook PHP SDK，但是，如果没有人连接到 facebook，getLoginUrl() 会给我一个错误的 url（内部服务器错误）。

他是我的代码：

```
include("facebook/src/facebook.php");
$config = array();
$config['appId'] = 'myAppId';
$config['secret'] = 'mySecretKey';
$facebook = new Facebook($config);
$user_id = $facebook->getUser();

if($user_id)
{
    // We have a user ID, so probably a logged in user.
    // If not, we'll get an exception, which we handle below.
    try
    {
        $user_profile = $facebook->api('/me','GET');
        echo "Name: " . $user_profile['name'];
    }
    catch(FacebookApiException $e)
    {
        // If the user is logged out, you can have a 
        // user ID even though the access token is invalid.
        // In this case, we'll get an exception, so we'll
        // just ask the user to login again here.
        $login_url = $facebook->getLoginUrl(); 
        echo 'Please <a href="' . $login_url . '">login.</a>';
        error_log($e->getType());
        error_log($e->getMessage());
    }   
}
else // The problem is below \\
{       
    // No user, print a link for the user to login
    $login_url = $facebook->getLoginUrl(array('scope' => 'email,publish_stream,user_location,user_birthday'));
    echo 'Please <a href="' . $login_url . '">login.</a>';
} 
```

任何想法 ？

# c++ - 在 C++ 中返回 std::vector 的有效方法

> ID：15704565
> 
> 赞同：149
> 
> 时间：2013-03-29T13:46:25.143
> 
> 标签：c++, return-value, stdvector

在函数中返回 a 时复制了多少数据，`std::vector`以及将 std::vector 放在自由存储区（在堆上）并返回指针而不是返回指针的优化程度，即：

```
std::vector *f()
{
  std::vector *result = new std::vector();
  /*
    Insert elements into result
  */
  return result;
} 
```

比：

```
std::vector f()
{
  std::vector result;
  /*
    Insert elements into result
  */
  return result;
} 
```

?

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2013-03-29T13:48:50.170

在 C++11 中，这是首选方式：

```
std::vector<X> f(); 
```

即按值返回。

对于 C++11，`std::vector`具有移动语义，这意味着在函数中声明的*局部向量将在返回时**移动*，在某些情况下，编译器甚至可以忽略移动。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2013-03-29T14:15:49.890

你应该按价值返回。

该标准具有提高按价值退货效率的特定功能。它被称为“复制省略”，在这种情况下更具体地说是“命名返回值优化 (NRVO)”。

编译器不必实现它，但是编译器也不必*实现*函数内联（或根本执行任何优化）。但是，如果编译器不进行优化，标准库的性能可能会很差，并且所有严肃的编译器都实现了内联和 NRVO（以及其他优化）。

应用 NRVO 时，以下代码不会有复制：

```
std::vector<int> f() {
    std::vector<int> result;
    ... populate the vector ...
    return result;
}

std::vector<int> myvec = f(); 
```

但用户可能想要这样做：

```
std::vector<int> myvec;
... some time later ...
myvec = f(); 
```

复制省略不会阻止此处的复制，因为它是赋值而不是初始化。但是，您*仍然*应该按值返回。在 C++11 中，赋值被不同的东西优化，称为“移动语义”。在 C++03 中，上面的代码确实会导致复制，虽然*理论上*优化器可能能够避免它，但实际上它太难了。因此`myvec = f()`，在 C++03 中，您应该这样编写：

```
std::vector<int> myvec;
... some time later ...
f().swap(myvec); 
```

还有另一种选择，即为用户提供更灵活的界面：

```
template <typename OutputIterator> void f(OutputIterator it) {
    ... write elements to the iterator like this ...
    *it++ = 0;
    *it++ = 1;
} 
```

然后，您还可以在此基础上支持现有的基于矢量的界面：

```
std::vector<int> f() {
    std::vector<int> result;
    f(std::back_inserter(result));
    return result;
} 
```

如果您现有的代码以比预先固定数量更复杂的方式使用，这*可能*比您现有的代码效率低。`reserve()`但是如果你现有的代码基本上是重复调用`push_back`向量，那么这个基于模板的代码应该也一样好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-29T13:51:02.430

[是时候发布关于RVO](http://en.wikipedia.org/wiki/Return_value_optimization)的答案了，我也是……

如果按值返回一个对象，编译器通常会对其进行优化，使其不会被构造两次，因为在函数中将其构造为临时对象然后复制它是多余的。这称为返回值优化：创建的对象将被移动而不是被复制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-29T13:50:37.300

一个常见的 pre-C++11 习惯用法是传递对正在填充的对象的引用。

然后没有向量的复制。

```
void f( std::vector & result )
{
  /*
    Insert elements into result
  */
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-29T13:53:48.330

如果编译器支持命名返回值优化（[http://msdn.microsoft.com/en-us/library/ms364057(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms364057(v=vs.80).aspx)），则可以直接返回向量，前提是没有：

1.  返回不同命名对象的不同路径
2.  引入了 EH 状态的多个返回路径（即使在所有路径上都返回了相同的命名对象）。
3.  返回的命名对象在内联 asm 块中引用。

NRVO 优化了冗余的复制构造函数和析构函数调用，从而提高了整体性能。

您的示例中应该没有真正的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-24T13:50:45.183

```
vector<string> getseq(char * db_file) 
```

如果你想在 main() 上打印它，你应该循环执行。

```
int main() {
     vector<string> str_vec = getseq(argv[1]);
     for(vector<string>::iterator it = str_vec.begin(); it != str_vec.end(); it++) {
         cout << *it << endl;
     }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-09-29T03:17:21.447

尽管“按值返回”可能很好，但它是一种可能导致错误的代码。考虑以下程序：

```
 #include <string>
    #include <vector>
    #include <iostream>
    using namespace std;
    static std::vector<std::string> strings;
    std::vector<std::string> vecFunc(void) { return strings; };
    int main(int argc, char * argv[]){
      // set up the vector of strings to hold however
      // many strings the user provides on the command line
      for(int idx=1; (idx<argc); ++idx){
         strings.push_back(argv[idx]);
      }

      // now, iterate the strings and print them using the vector function
      // as accessor
      for(std::vector<std::string>::interator idx=vecFunc().begin(); (idx!=vecFunc().end()); ++idx){
         cout << "Addr: " << idx->c_str() << std::endl;
         cout << "Val:  " << *idx << std::endl;
      }
    return 0;
    }; 
```

*   Q：执行上述操作会发生什么？A：核心转储。
*   问：为什么编译器没有捕捉到错误？答：因为程序在句法上是正确的，尽管不是语义上的。
*   问：如果修改 vecFunc() 以返回引用会发生什么？A：程序运行完成并产生预期的结果。
*   问：有什么区别？答：编译器不必创建和管理匿名对象。程序员已指示编译器仅将一个对象用于迭代器和端点确定，而不是像损坏的示例那样使用两个不同的对象。

即使使用 GNU g++ 报告选项 -Wall -Wextra -Weffc++，上述错误程序也不会显示错误

如果您必须产生一个值，那么以下将代替调用 vecFunc() 两次：

```
 std::vector<std::string> lclvec(vecFunc());
   for(std::vector<std::string>::iterator idx=lclvec.begin(); (idx!=lclvec.end()); ++idx)... 
```

以上在循环迭代期间也不会产生匿名对象，但需要一个可能的复制操作（正如一些注释，在某些情况下可能会被优化掉。但是引用方法保证不会产生任何副本。相信编译器会执行 RVO 不能替代尝试构建最高效的代码。如果您可以讨论编译器执行 RVO 的需要，那么您就领先了。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-07-22T11:10:54.753

```
 vector<string> func1() const
   {
      vector<string> parts;
      return vector<string>(parts.begin(),parts.end()) ;
   } 
```

这在 c++11 之后仍然有效，因为编译器会自动使用移动而不是复制。

# java - 解析数学二维函数模式

> ID：15704571
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:46:44.383
> 
> 标签：java, parsing

我一直在考虑计算输入定义的函数的定积分的程序。

可接受的输入是“+,-,*,^”运算符和“Sin,Cos,Tg,Ctg,Log”三角函数的组合，例如：

> 2*x^2+x^(log(5+Sin(x)+1)*x^5)/(Tg(Log(x)))

唯一困难的是解析输入字符串；这种方法有望作为产品：

```
public static double customFunc(double x,...)
{
     return <client input>;
} 
```

在我的例子中：

```
public static double customFunc(double x,...)
{
     return 2*x^2+x^(log(5+Sin(x)+1)*x^5)/(Tg(Log(x)));
} 
```

所以，我完全不知道我该怎么办......你有任何提示，样本，想法或解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:00:00.730

如果你想创建自己的解析器，我真的推荐[ANTLR](http://www.antlr.org)。这是一个很棒的解析工具，特别是如果你想有自己的逻辑围绕它。[这里](http://javadude.com/articles/antlr3xtut/)还有一组非常有用的教程视频。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:59:52.200

我想我可以给你一些想法。

您必须解析函数字符串，并分离出运算符。

您可以使用 Map 将运算符映射到 Java 函数。

```
+ to +
Sin to Math.sin(x)
etc. 
```

然后，您将构建将在 StringBuilder 中进行计算的 Java 行。

不知何故，您将执行您创建的 Java 行。那是我不知道该怎么做的部分。

# jsf-2 - 使用 JSF PhaseListener 重定向到页面

> ID：15704581
> 
> 赞同：0
> 
> 时间：2013-03-29T13:47:15.620
> 
> 标签：jsf-2, liferay-6

场景 1：如果friendlyURL 是'/requestform/servicerequest'`requestProcessorBean.userRequestVO == null`然后使会话无效并重定向到'/web/pds/login' 页面..

场景2：如果friendlyURL是'/requestform/servicerequest'`requestProcessorBean.userRequestVO != null`然后重定向到'serviceRequest.xhtml'页面。

我想知道如何使用 JSF Phase Listener 实现场景 1。我已经按如下方式实现了场景 1： **requestForm.xhtml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<f:view xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
    </h:head>
    <h:body>
        <h:outputFormat rendered="#{lookupBean.friendlyURL == '/requestform/servicerequest' and (requestProcessorBean.userRequestVO != null)}">
            <ui:include src="serviceRequest.xhtml" />
        </h:outputFormat>
    </h:body>
</f:view> 
```

我正在使用 Liferay 6.0 和 JSF 2.0。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T04:34:35.750

我真的不会为条件重定向推荐阶段监听器。改为使用[`<f:event type="preRenderView"/>`](https://stackoverflow.com/a/8399591/1530938). 但是，如果由于某种原因您被限制使用相位监听器，您的实现将如下所示：

1.  定义一个 PhaseListener 看起来像这样

    ```
    /*we're defining the PhaseListener as a ManagedBean so
     * we can inject other beans into it 
     */
    @ManagedBean(name = "thePhaseListener")
    @RequestScoped
    public class TestPhaseListener implements PhaseListener {

       @ManagedProperty(value = "#{requestProcessorBean}")
       transient private RequestProcessorBean requestProcessorBean;

       @ManagedProperty(value = "#{lookupBean}")
       transient private LookupBean lookupBean;

       @Override
       public void afterPhase(PhaseEvent event) {
          //throw new UnsupportedOperationException("Not supported yet.");
       }

       @Override
       public void beforePhase(PhaseEvent event) {

           try {

              if (lookupBean.getFriendlyURL.equals("/requestform/servicerequest") && (requestProcessorBean.getUserRequestVO() == null)) {
                event.getFacesContext().getExternalContext().redirect("/web/pds/login");
               }
            } catch (IOException ex) {
              Logger.getLogger(TestPhaseListener.class.getName()).log(Level.SEVERE, null, ex);
            }
         }

       @Override
       public PhaseId getPhaseId() {
          return PhaseId.RESTORE_VIEW; // The RESTORE_VIEW phase is the first in the lifecycle of a JSF view
       }
    } 
    ```

2.  在您想要的页面上使用以下标签注册您的新 PhaseListener

    ```
    <f:phaseListener type="com.you.TestPhaseListener"/> 
    ```

就像我在这篇文章开头提到的那样，这种方法不必要地笨重，需要付出太多努力才能实现如此之少和 IMO，这是对相位监听器的滥用。

# javascript - 如何在内部获取函数 - jQuery

> ID：15704597
> 
> 赞同：0
> 
> 时间：2013-03-29T13:48:23.357
> 
> 标签：javascript, jquery, scope

我正在使用 jQuery **[Block UI 插件](http://www.malsup.com/jquery/block/)**。如下所示；

```
$('#someid .someclass').click(function(){
  var id = "someidx";
  var newval = "somevalx";
  $.blockUI({
    onBlock: function() {
      $.ajax({
        type: 'POST',
        url: 'target.php',
        data: 'data='+newval,
        cache: false,
        success: function(result) {
          if(result == "true"){
            $('#mymessage').addClass("asuccess");
          }else{
            $('#mymessage').addClass("aerror");
          }
        }
      });
     },
     onUnblock: function(){
       //some functions;
     },
     message: $('#mymessage'),  
  });
  $(this).hide();
  $(this).siblings('.class1').hide();
  $(this).siblings('.class2').show();
  $(this).parent("td").siblings(".class3").html(newval);
}); 
```

这工作正常。但是我想在里面做一些功能`if(result == "true")`。也就是说，如果 ajax 结果为真，我想做这些事情。我想要做;

```
success: function(result) {
  if(result == "true"){
    $('#mymessage').addClass("asuccess");
    $(this).hide();
    $(this).siblings('.class1').hide();
    $(this).siblings('.class2').show();
    $(this).parent("td").siblings(".class3").html(newval);
  }else{
    $('#mymessage').addClass("aerror");
  }
} 
```

如果 ajax 返回为真，则将这些东西放入成功嵌套中。但这在`if(result == "true")`嵌套中不起作用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T13:52:55.797

您可以在顶层函数中设置一个变量，`this`并在内部函数中使用它。

```
$('#someid .someclass').click(function () {

    var self = $(this);

    var id = "someidx";
    var newval = "somevalx";
    $.blockUI({
        onBlock: function () {
            $.ajax({
                type: 'POST',
                url: 'target.php',
                data: 'data=' + newval,
                cache: false,
                success: function (result) {
                    if (result == "true") {
                        $('#mymessage').addClass("asuccess");
                        self.hide();
                        self.siblings('.cancel').hide();
                        self.siblings('.edit').show();
                        self.parent("td").siblings(".cell2").html(newval);
                    } else {
                        $('#mymessage').addClass("aerror");
                    }
                }
            });
        },
        onUnblock: function () {
            //some functions;
        },
        message: $('#mymessage'),

    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T13:50:55.897

添加

```
 context: self,  // oops - fixed now (was "this") 
```

接您的`$.ajax()`电话。这将确保`this`在调用 AJAX 回调时引用单击的元素。没有那个，`this`指的是 ajax 设置对象，而不是原始的 DOM 元素。

*编辑*——你还需要 Daniel Imms 的回答中的“self”变量（如果没有这个“上下文”的东西，它本身将完全适合）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:52:57.237

```
$('#someid .someclass').click(function(){
    var self = $(this);
    // other code
}); 
```

您现在可以`self`在 AJAX 处理程序中使用作为单击元素的引用。

# security - CakePHP 安全组件黑洞登录（data[_Token][key] 字段未生成）

> ID：15704600
> 
> 赞同：7
> 
> 时间：2013-03-29T13:48:37.990
> 
> 标签：security, cakephp, cakephp-2.3

当我尝试登录时，请求被`Security`组件黑洞。我怎样才能让它正常工作？

我有一个简单的登录表单

```
 <div class="container container-login">
    <h2><?php echo __('Login'); ?></h2>
    <div class="wrap-form-signin">
    <?php
    echo $this->Form->create('User', array('action' => 'login', 'class' => 'form-signin'));
    echo $this->Form->input('username', array('label' => '', 'placeholder' => __('Email')));
    echo $this->Form->input('password', array('label' => '', 'placeholder' => __('Password')));
    echo $this->Form->submit(__('Login'));
    echo $this->Form->end();
    ?>
    </div>
</div> 
```

控制器动作如下：

```
public function login() {
        if ($this->request->is('post')) {
            if ($this->Auth->login()) {
                return $this->redirect($this->Auth->redirectUrl());             
            } else {
                $this->Session->setFlash(__('Username or password is incorrect'), 'default', array(), 'auth');
            }
        }
} 
```

并且该`Security`组件包含在`AppController`

```
public $components = array('Security', ... ); 
```

在error.log中我得到：

```
2013-03-29 13:40:58 Error: [BadRequestException] The request has been black-holed
Request URL: /users/login
Stack Trace:
#0 C:\wamp\www\cdx\lib\Cake\Controller\Component\SecurityComponent.php(234): SecurityComponent->blackHole(Object(UsersController), 'auth')
#1 [internal function]: SecurityComponent->startup(Object(UsersController))
#2 C:\wamp\www\cdx\lib\Cake\Utility\ObjectCollection.php(131): call_user_func_array(Array, Array)
#3 [internal function]: ObjectCollection->trigger(Object(CakeEvent))
#4 C:\wamp\www\cdx\lib\Cake\Event\CakeEventManager.php(247): call_user_func(Array, Object(CakeEvent))
#5 C:\wamp\www\cdx\lib\Cake\Controller\Controller.php(670): CakeEventManager->dispatch(Object(CakeEvent))
#6 C:\wamp\www\cdx\lib\Cake\Routing\Dispatcher.php(183): Controller->startupProcess()
#7 C:\wamp\www\cdx\lib\Cake\Routing\Dispatcher.php(161): Dispatcher->_invoke(Object(UsersController), Object(CakeRequest), Object(CakeResponse))
#8 C:\wamp\www\cdx\app\webroot\index.php(92): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#9 {main} 
```

我怎样才能找到使我的请求进入黑洞的原因？

当我尝试使用自定义黑洞处理程序时，错误的类型是`auth`. 但这就是我能得到的所有信息

我的 CakePHP 版本是 2.3.1

编辑：登录在没有`Security`组件的情况下运行良好。将其添加到 后`AppController`，登录停止工作。

**EDIT2：我在表格中没有任何`data[_Token][key]`字段**

**EDIT3 解决方案：我团队中的某个人已经覆盖了 HTMLHelper 类，并且它错过了 _tags 数组中的“hiddenblock”，导致缺少 _Token 字段。有关详细信息，请参阅我和 thaJeztah 的答案以及下面的评论**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T22:27:19.957

您按什么顺序添加组件？安全组件应该放在其他处理表单数据的组件*之前*`startup()`：

*“如果您使用安全组件的表单保护功能和其他在启动（）回调中处理表单数据的组件，请确保将安全组件放在 $components 数组中的这些组件之前。”*

[安全](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html)

因为 AuthComponent*确实*在 中处理表单数据[`startup()`](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Controller/Component/AuthComponent.php#L281)，所以我认为这适用，因此请确保 SecurityComponent在 $components 数组中的 AuthComponent*之前；*

```
public $components = array(
    'Security',
    'Session',
    'Auth' => array(
        // auth component settings
    )
); 
```

## 更新

OP 发布的“最终”答案明确表明*无法回答*这个问题。事实证明，团队中的某个人对 HtmlHelper 进行了修改，导致它*不*输出“隐藏”块，因此*不*输出 CSRF 令牌。

**在正常情况下，您*永远不*应该修改 CakePHP 框架文件本身。CakePHP 提供了在不修改“核心”CakePHP 文件的情况下覆盖其功能（包括 Helpers）的方法。**

## 为什么修改 CakePHP 文件*不好*

例如，考虑一辆汽车。如果机械师不喜欢这种设计并**决定“交换”刹车和油门踏板怎么办？**

当然，**如果您知道这种修改**，汽车仍然可以行驶。但是，如果没有这些重要信息，任何其他驱动程序肯定会*崩溃*（并且想*知道到底发生了什么！？*）

如果框架的默认行为不符合您的需要，请扩展这些类。不要*自己*修改框架文件（除非**真的**没有其他选择）。如果绝对有必要对框架进行修改，请务必与团队讨论这一点，并就所做的更改编写文档。

请记住，**如果不对更新的版本进行相同的修改，就无法再将框架更新到较新的版本**。同样，如果更改没有记录在案，有人可能会更新 CakePHP 并破坏您的修改。

此外，*如果*您覆盖或修改 CakePHP，请确保覆盖与 CakePHP 的默认行为兼容，并且 CakePHP 的单元测试仍然正确运行（或为修改创建新的单元测试）

## 在 CakePHP 中使用“自定义”助手

如果您需要自定义 CakePHP 助手（或其他组件），有多种选项可以在不修改 CakePHP 文件的情况下这样做；

**1.扩展助手**

```
class AwesomeHtmlHelper extends HtmlHelper {
    /**
     * enhanced tableHeaders method, outputs tableHeaders in a 'thead' tag
     *
     * {@inheritdoc}
     */
    public function tableHeaders(array $names, array $trOptions = null, array $thOptions = null)
    {
        $output = parent::tableHeaders($names, $trOptions, $thOptions);
        return '<thead>' . $output . '</thead>';
    }
} 
```

然后，以常规方式使用您的 Helper：

```
echo $this->AwesomeHtml->tableHeaders(array('Date', 'Title', 'Active')); 
```

**2\. 'Drop-in' 替换 - 使用别名 (CakePHP > 2.3)**

从 CakePHP 2.3 开始，可以为 Helper 使用别名。此功能可用于（例如）您的应用程序中存在两个具有相同名称的 Helper（例如 Plugin.HtmlHelper）的情况。

此外，这允许您使用自己的 Helper 覆盖 CakePHP Helper。请参阅此处的文档：[使用和配置助手](http://book.cakephp.org/2.0/en/views/helpers.html#using-and-configuring-helpers)

**请注意，这将覆盖应用程序中*任何地方的 Helper！***

```
public $helpers = array(
    'Html' => array(
        'className' => 'AwesomeHtml'
    )
); 
```

现在，`$this->Html`实际上将`AwesomeHtmlHelper`在您的意见中提及：

```
echo $this->eHtml->tableHeaders(array('Date', 'Title', 'Active')); 
```

将输出您的“增强”表头

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T19:26:40.047

**编辑：实际上没有错误**

```
return $this->Html->useTag('hiddenblock', $out); 
```

**行，这是一个团队成员对`HtmlHelper`我不知道的修改，这阻止`_Token`了在页面中打印的输入。主要问题仍然存在，这是`data[_Token][key]`我必须添加的表单中没有输入**

* * *

我终于发现了问题所在。由于课堂上可能出现错误，因此没有`_Token`字段`FormHelper`。我不得不编辑`secure`看起来像这样的方法：

```
public function secure($fields = array()) {
    if (!isset($this->request['_Token']) || 
            empty($this->request['_Token'])) {
        return;
    }
    $locked = array();
    $unlockedFields = $this->_unlockedFields;

    foreach ($fields as $key => $value) {
        if (!is_int($key)) {
            $locked[$key] = $value;
            unset($fields[$key]);
        }
    }

    sort($unlockedFields, SORT_STRING);
    sort($fields, SORT_STRING);
    ksort($locked, SORT_STRING);
    $fields += $locked;

    $locked = implode(array_keys($locked), '|');
    $unlocked = implode($unlockedFields, '|');
    $fields = Security::hash(serialize($fields) . $unlocked . Configure::read('Security.salt'), 'sha1');

    $out = $this->hidden('_Token.fields', array(
        'value' => urlencode($fields . ':' . $locked),
        'id' => 'TokenFields' . mt_rand()
    ));
    $out .= $this->hidden('_Token.unlocked', array(
        'value' => urlencode($unlocked),
        'id' => 'TokenUnlocked' . mt_rand()
    ));
    return $this->Html->useTag('hiddenblock', $out);
} 
```

此方法返回一个空字符串。因此，我没有返回结果，`useTag`而是简单地返回了`$out`.

我必须做的另一件事是添加该`data[_Token][key]`字段。最后，该方法如下所示：

```
public function secure($fields = array()) {
        if (!isset($this->request['_Token']) || 
                empty($this->request['_Token'])) {
            return;
        }
        $locked = array();
        $unlockedFields = $this->_unlockedFields;

        foreach ($fields as $key => $value) {
            if (!is_int($key)) {
                $locked[$key] = $value;
                unset($fields[$key]);
            }
        }

        sort($unlockedFields, SORT_STRING);
        sort($fields, SORT_STRING);
        ksort($locked, SORT_STRING);
        $fields += $locked;

        $locked = implode(array_keys($locked), '|');
        $unlocked = implode($unlockedFields, '|');
        $fields = Security::hash(serialize($fields) . $unlocked . Configure::read('Security.salt'), 'sha1');
        $key = $this->request['_Token']['key'];

        $out = $this->hidden('_Token.fields', array(
            'value' => urlencode($fields . ':' . $locked),
            'id' => 'TokenFields' . mt_rand()
        ));
        $out .= $this->hidden('_Token.key', array(
            'value' => $key,
            'id' => 'TokenKey' . mt_rand()
        ));
        $out .= $this->hidden('_Token.unlocked', array(
            'value' => urlencode($unlocked),
            'id' => 'TokenUnlocked' . mt_rand()
        ));
        return $out;
        //return $this->Html->useTag('hiddenblock', $out);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T12:57:54.323

很难使用您提供的信息进行测试，但我会尝试将表单创建调用更改为： `echo $this->Form->create('User', array('url' => array('controller' => 'users', 'action' => 'login'), 'class' => 'form-signin'));`

`auth`错误类型表示表单验证错误或控制器/操作不匹配错误。如果您显示表单的页面不是 NOT `/users/login`，则可能会发生这种情况，因为在使用安全组件时跨控制器通信是黑洞。希望能帮助到你

编辑：验证错误也可能表明您没有`username`为 Auth 组件定义结帐[说明书](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#configuring-authentication-handlers)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T16:01:57.450

回答是因为我无法发表评论。您是否尝试过向 Security 组件添加回调并查看它到底生成了什么？

看：[http ://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#handling-blackhole-callbacks](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#handling-blackhole-callbacks)

您究竟打算将安全组件用于什么目的？你想防止什么？

您是否尝试过使用会话令牌而不是表单令牌？ [http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#csrf-protection](http://book.cakephp.org/2.0/en/core-libraries/components/security-component.html#csrf-protection)

```
public $components = array(
    'Security' => array(
        'csrfUseOnce' => false
    )
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-20T17:29:38.100

我对来自 login.ctp 的用户登录表单以及从另一个视图中将其用作元素都遇到了同样的问题，并设法通过使用 $this->Form->end() 关闭表单来解决此问题，否则它不会添加隐藏的输入形成令牌....希望这有帮助。

# php - 从 php 访问 git 提交历史、标签等

> ID：15704606
> 
> 赞同：0
> 
> 时间：2013-03-29T13:48:57.017
> 
> 标签：php, git, codeigniter

我希望能够直接在生产站点上将我的提交历史作为更改日志输出。现在我在想最好的方法是运行任何命令给我我想要`exec()`的东西，但我在这种事情周围看不到太多。

1.  `exec()`将其拉入应用程序是否合适？
2.  有没有我忽略的安全问题（因为我看不到太多）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:09:05.727

看一眼：

[https://github.com/kbjr/Git.php](https://github.com/kbjr/Git.php)

这是一个很好的运行 Git 命令的 PHP 客户端，应该比`exec()`手动操作要容易得多。

# c# - 尝试在数据库中输入值时 INSERT INTO 语句中的语法错误

> ID：15704607
> 
> 赞同：0
> 
> 时间：2013-03-29T13:48:57.653
> 
> 标签：c#, asp.net, database, ms-access

嗨，我基本上是在创建一个注册页面。我收到一条错误消息，提示“INSERT INTO 语句中的语法错误”。有时也会收到错误消息，说明连接已打开或其他内容。它以前在不同的表和不同的字段等中工作......代码如下

```
public partial class Registration : System.Web.UI.Page
{
    static OleDbConnection con = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=D:\New folder\Project 1.0\WebSite1\New Microsoft Office Access 2007 Database.accdb");
    OleDbDataAdapter ada = new OleDbDataAdapter();
    OleDbCommand cmd = new OleDbCommand();
    OleDbDataReader dr;
protected void Page_Load(object sender, EventArgs e)
{

}

protected void Button1_Click(object sender, EventArgs e)
{
    string str = "insert into User_Registeration (First_Name, Last_name, Phone_No, Username, Password, Email, Address, City, Country, Zipcode)" +
         "values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
    con.Open();
    cmd = new OleDbCommand(str, con);
    cmd.Parameters.AddWithValue("@p1", TextBox1.Text);
    cmd.Parameters.AddWithValue("@p2", TextBox2.Text);
    cmd.Parameters.AddWithValue("@p3", TextBox3.Text);
    cmd.Parameters.AddWithValue("@p4", TextBox4.Text);
    cmd.Parameters.AddWithValue("@p5", TextBox5.Text);
    cmd.Parameters.AddWithValue("@p6", TextBox6.Text);
    cmd.Parameters.AddWithValue("@p7", TextBox8.Text);
    cmd.Parameters.AddWithValue("@p8", TextBox12.Text);
    cmd.Parameters.AddWithValue("@p9", TextBox9.Text);
    cmd.Parameters.AddWithValue("@p10", TextBox11.Text);
    cmd.ExecuteNonQuery();
    con.Close();
} 
```

}

我的 mc 访问表具有以下结构...

ID 名字 姓氏 电话号码 用户名 密码 电子邮件地址 城市 国家 邮政编码

有人可以帮帮我吗？：） 谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T13:56:35.533

你应该使用这个查询：

```
 string str = "insert into User_Registeration (First_Name, Last_name, Phone_No, [Username], [Password], [Email], [Address], City, Country, Zipcode)" +
     " values (@p1, @p2, @p3,@p4, @p5,@p6, @p7,@p8,@p9,@p10)"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:08:50.640

问题是由 PASSWORD 一词引起的。这个词是[JET](http://support.microsoft.com/kb/321266) (MS-Access)中的保留词
要在 sql 命令中使用该词，您需要用方括号将其封装起来。

当然，当您向查询添加参数时，您应该确保添加查询中占位符所期望的确切数量的参数。
您有 10 个占位符 (?)，因此您需要 10 个参数并按照各个字段预期的确切顺序

所以，总结

```
string str = "insert into User_Registeration (First_Name, Last_name, Phone_No, " + 
             "Username, [Password], Email, Address, City, Country, Zipcode)" +
             "values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:52:36.743

您在这一行中缺少一个空格：

```
string str = "insert into User_Registeration (First_Name, Last_name, Phone_No, Username, Password, Email, Address, City, Country, Zipcode)" +
     "values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"; 
```

应该 ：

```
string str = "insert into User_Registeration (First_Name, Last_name, Phone_No, Username, Password, Email, Address, City, Country, Zipcode)" +
     " values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"; 
```

# python - scikit-learn (SVMLIB) 中奇怪的 SVM 预测性能

> ID：15704612
> 
> 赞同：3
> 
> 时间：2013-03-29T13:49:20.170
> 
> 标签：python, svm, scikit-learn

我在 10000x1000 的大型数据集（10000 个具有 1000 个特征的对象）上使用来自 scikit-learn 的 SVC。我已经在其他来源中看到 SVMLIB 不能扩展到超过 ~10000 个对象，我确实观察到了这一点：

```
training time for 10000 objects: 18.9s
training time for 12000 objects: 44.2s
training time for 14000 objects: 92.7s 
```

你可以想象当我尝试 80000 时会发生什么。然而，我发现非常令人惊讶的是，SVM 的 predict() 比训练 fit() 花费的时间更多：

```
prediction time for 10000 objects (model was also trained on those objects): 49.0s
prediction time for 12000 objects (model was also trained on those objects): 91.5s
prediction time for 14000 objects (model was also trained on those objects): 141.84s 
```

让预测在线性时间内运行是微不足道的（尽管在这里它可能接近线性），而且通常比训练快得多。那么这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:03:56.227

您确定在预测时间的测量中不包括训练时间吗？你有时间的代码片段吗？

# excel - 在excel中将一个值从厘米转换为英寸

> ID：15704617
> 
> 赞同：1
> 
> 时间：2013-03-29T13:49:30.127
> 
> 标签：excel, vba

使用此函数可以将厘米格式的数字转换为英寸：

```
=CONVERT(A1,"cm","in") 
```

我想要的是，不是替换数字，而是将转换后的数字放在原始数字旁边。实际上这是一个更复杂的情况：

原始单元格：

```
35 - 45 cm 
```

转换后（全部在一个单元格中）：

```
35 - 45 cm
(14 - 18 inch) 
```

那么，由于这种格式的单元格很多，可能使用宏，如何以自动方式在 excel 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T18:12:10.340

公式方法 - 如果您的值从 A1 开始，则将其放在 B1 中并填写。

```
= A1 & CHAR(10) & "(" & ROUND(CONVERT(
VALUE(LEFT(A1,SEARCH("-",A1)-1)),"cm","in"),1) & " - " &
ROUND(CONVERT(
VALUE(MID(SUBSTITUTE(A1,"cm",""), SEARCH("-",A1)+1,10)),"cm","in"),1) & "in)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T16:40:41.023

我将从这个开始，但我建议向我提供更多信息，以便更好地解决您的问题：

```
Sub AddConversionToCell()

    FirstNumberAsIn = WorksheetFunction.Convert(Left(Range("A1").Value, 2), "cm", "in")
    SecondNumberAsIn = WorksheetFunction.Convert(Mid(Range("A1").Value, 6, 2), "cm", "in")
    Range("A1").Value = Range("A1").Value & " ( " & FirstNumberAsIn & " - " & SecondNumberAsIn & " inch)"

End Sub 
```

# android - 复选框值保存在android中的共享首选项？

> ID：15704624
> 
> 赞同：0
> 
> 时间：2013-03-29T13:50:15.350
> 
> 标签：android

嗨，我已经在列表视图中创建了基本适配器。我已经实现了自定义复选框。如果我单击了保存在共享首选项中的多个项目，我们需要什么。如果我未选中意味着删除该共享首选项中的项目。请给我解决方案。

在这里，我在此代码下面提到：

```
holder.checkBox.setOnClickListener(new View.OnClickListener() {

public void onClick(View v) {
    if (((CheckBox) v).isChecked()) {

        if (checkBoxState[position] = true) {
            // Calculate function
            chk = Integer.toString(v.getId());
            total += Double.valueOf(category.arrListPrice
                    .get(position));
            System.out.println("********************Checked"
                    + total);
            checkboxvalue.add(chk);
            adapter_list.notifyDataSetChanged();
        }

    } else {

        if (checkBoxState[position] = false) {
            System.out.println("*********************unchecked"
                    + total);
            total -= Double.valueOf(category.arrListPrice
                    .get(position));
            checkboxvalue.remove(chk);
            adapter_list.notifyDataSetChanged();
        }

    }

    if (listener != null) {
        Log.e("Callback", Double.toString(total));
        listener.totalAmount(Double.toString(total));

    }

}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:06:51.573

```
public void saveCheckBox(position int, boolean isChecked){
   SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences();
   SharedPreferences.Editor editor = prefs.edit();

    editor.putBoolean("checkbox_"+position,isChecked);
    editor.commit();
 }

  public boolean getCheckBoxState(int position){
  SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences();
  prefs.getBoolean("checkbox_"+position, false);
 } 
```

仅当复选框的位置始终相同时，这才有效，如果位置不同，您应该找到其他方法来确定单击了哪个复选框

# php - 使用 JS、HTML5 和 PHP 的 SSH 终端

> ID：15704626
> 
> 赞同：5
> 
> 时间：2013-03-29T13:50:17.503
> 
> 标签：php, javascript, html, ssh, terminal

我正在寻找像[GateOne](https://github.com/liftoff/GateOne)这样的解决方案，我可以将它安装在支持 PHP 的服务器上，但我没有 ssh 连接。它还支持 Python，但如果没有实际的 SSH 访问权限，我将无法在其上执行任何操作。这意味着只需将其放入文件夹即可工作。

我见过[JavaScript（或 JS+PHP）终端客户端](https://stackoverflow.com/questions/294945/javascript-or-jsphp-terminal-client)，但解决方案似乎已经过时了。

例如，我希望能够执行一个简单`ln -s ./dir1 ./dir2`的创建符号链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:55:16.480

我认为您实际上并不想要SSH。如果您真的只想运行非交互式命令，也许您应该尝试一个简单的 php shell，例如[http://phpshell.sourceforge.net/ ？](http://phpshell.sourceforge.net/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-02T07:51:55.780

我终于发现我现在使用的[codiad](http://codiad.com/)的终端方式比 phpshell 更好。我去了那个解决方案。它也允许管理 Web 项目，但我认为它是目前可用的最先进的终端，不需要通过命令行进行任何安装。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-20T19:46:37.407

我写了一个使用 php 和 xterm 的 php ssh 客户端，你可以在 github 页面上获取源代码[https://github.com/roke22/PHP-SSH2-Web-Client](https://github.com/roke22/PHP-SSH2-Web-Client)

也请发送一些反馈。

我希望对你有所帮助。

# android - 如何使用代码清除应用程序中的数据和chach

> ID：15704627
> 
> 赞同：0
> 
> 时间：2013-03-29T13:50:17.987
> 
> 标签：android, android-permissions, android-date

您好，我有一个正在开发的应用程序，我想在它关闭时清除它的所有数据。我不介意它是否需要添加权限或类似的东西。我还需要它来清除我所有的共享偏好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:54:29.923

您可以使用此代码从 sharedpreferences 中删除所有数据。

这是为了在应用程序关闭时清除数据：-

```
 @Override
public void onDestroy() {
super.onDestroy(); 
SharedPreferences preferences = getSharedPreferences("your prefre name", 0);
 preferences.edit().clear().commit();
} 
```

这是您希望通过单击按钮等任何活动清除所有数据的时候：-

```
 SharedPreferences preferences = getSharedPreferences("your prefre name", 0);
    preferences.edit().clear().commit(); 
```

它应该可以解决您的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:53:18.610

您可以像这样清除共享首选项。

```
SharedPreferences preferences = getSharedPreferences("yourpref", 0);
preferences.edit().clear().commit(); 
```

# openssl - Thawte 证书的“签名中的证书无法验证”

> ID：15704629
> 
> 赞同：5
> 
> 时间：2013-03-29T13:50:20.573
> 
> 标签：openssl, digital-signature, signtool

我需要使用存储在 company.pfx 中的证书对 Application.exe 文件进行签名。所以，我使用了signtool：

```
signtool.exe sign /p password /f company.pfx /t http://timestamp.verisign.com/scripts/timestamp.dll /v Application.exe

The following certificate was selected:
    Issued to: Company, Inc.
    Issued by: Thawte Code Signing CA - G2
    Expires:   Wed Aug 27 02:59:59 2014
    SHA1 hash: A2A0BD7C4516BF8C88AECC3A568CE9BB5D63902D

Done Adding Additional Store
Successfully signed and timestamped: App1_old.exe

Number of files successfully Signed: 1
Number of warnings: 0
Number of errors: 0 
```

signtool 说没有错误。但是在数字签名详细信息中有一条消息*“无法验证签名中的证书”。*并且没有认证路径。

在详细信息中有一个属性“扩展错误信息”表示*“吊销状态：吊销功能无法检查吊销，因为吊销服务器处于脱机状态。”*

[应用程序.exe 映像](http://imageshack.us/photo/my-images/202/so1s.png/)

为了调查这个问题，我在应用程序上使用了 sigcheck（-a 密钥），它显示*“已验证：无法将证书链构建到受信任的根授权”。*

然后我已将 pfx 文件导入 repository，似乎证书没问题。

[证书图片](http://imageshack.us/photo/my-images/543/so2.png/)

我已经搜索了有关我的主题的 stackoverflow 并找到了一些链接，这很有帮助。

[如何使用我的证书链创建 PFX？](https://stackoverflow.com/questions/6654543/how-to-create-pfx-with-my-chain-of-certificates)

[如何使用代码签名证书对 ActiveX 控件进行签名并成为经过验证的发布者？](https://stackoverflow.com/questions/2814233/how-can-i-sign-an-activex-control-with-a-code-signing-certificate-and-be-a-verif)

解决方案是从 pfx 中提取证书（使用 OpenSSL）并使用 /ac 参数应用它

```
openssl pkcs12 -in company.pfx -out company_cl.pem -nodes -clcerts
openssl x509 -in company_cl.pem -out company_cl.cer -outform DER
signtool sign /ac company_cl.cer /p password  /f company.pfx /t http://timestamp.verisign.com/scripts/timstamp.dll /v Application.exe

The following certificate was selected:
    Issued to: Company, Inc.
    Issued by: Thawte Code Signing CA - G2
    Expires:   Wed Aug 27 02:59:59 2014
    SHA1 hash: A2A0BD7C4516BF8C88AECC3A568CE9BB5D63902D

Cross certificate chain (using machine store):
    Issued to: thawte Primary Root CA
    Issued by: thawte Primary Root CA
    Expires:   Thu Jul 17 02:59:59 2036
    SHA1 hash: 91C6D6EE3E8AC86384E548C299295C756C817B81

        Issued to: Thawte Code Signing CA - G2
        Issued by: thawte Primary Root CA
        Expires:   Sat Feb 08 02:59:59 2020
        SHA1 hash: 808D62642B7D1C4A9A83FD667F7A2A9D243FB1C7

            Issued to: Company, Inc.
            Issued by: Thawte Code Signing CA - G2
            Expires:   Wed Aug 27 02:59:59 2014
            SHA1 hash: A2A0BD7C4516BF8C88AECC3A568CE9BB5D63902D

Done Adding Additional Store
Successfully signed and timestamped: Application.exe

Number of files successfully Signed: 1
Number of warnings: 0
Number of errors: 0 
```

现在数字安全详细信息中的消息是“数字签名正常”。

但我不明白为什么我需要使用 /ac 参数。有没有人有任何想法？

* * *

已编辑。

我已经使用 Application.exe 验证了应用程序的第一个版本（没有 /ac），它为我提供了更多信息：

```
signtool.exe verify /v /kp Application.exe

Verifying: Application.exe
Hash of file (sha1): 5CBB228F4F206C65AAC829ACF40C297F291FE0A7

Signing Certificate Chain:
    Issued to: Company, Inc.
    Issued by: Thawte Code Signing CA - G2
    Expires:   Wed Aug 27 02:59:59 2014
    SHA1 hash: A2A0BD7C4516BF8C88AECC3A568CE9BB5D63902D

The signature is timestamped: Fri Mar 29 18:42:56 2013
Timestamp Verified by:
    Issued to: Thawte Timestamping CA
    Issued by: Thawte Timestamping CA
    Expires:   Fri Jan 01 02:59:59 2021
    SHA1 hash: BE36A4562FB2EE05DBB3D32323ADF445084ED656

        Issued to: Symantec Time Stamping Services CA - G2
        Issued by: Thawte Timestamping CA
        Expires:   Thu Dec 31 02:59:59 2020
        SHA1 hash: 6C07453FFDDA08B83707C09B82FB3D15F35336B1

            Issued to: Symantec Time Stamping Services Signer - G4
            Issued by: Symantec Time Stamping Services CA - G2
            Expires:   Wed Dec 30 02:59:59 2020
            SHA1 hash: 65439929B67973EB192D6FF243E6767ADF0834E4

SignTool Error: WinVerifyTrust returned error: 0x800B010A
        A certificate chain could not be built to a trusted root authority.

Number of files successfully Verified: 0
Number of warnings: 0
Number of errors: 1 
```

*“无法将证书链构建到受信任的根机构。”* 但为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T21:51:04.323

我发现了一篇关于使用 Thawte 证书签署文件的文章：http: [//codingexpedition.wordpress.com/2011/04/21/thawte-code-signing-pfx/](http://codingexpedition.wordpress.com/2011/04/21/thawte-code-signing-pfx/)

似乎总是需要**/ac signtool 选项。**因此，我已将 Thawte 证书提取到 .cer 文件中，并使用 /ac 参数应用它。

```
openssl pkcs12 -in company.pfx -out company_ca.pem -nokeys -cacerts
openssl x509 -in company_ca.pem -out company_ca.cer -outform DER
signtool sign /ac company_ca.cer /p password /f company.pfx /t timeserver /v Application.exe 
```

它工作正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T09:42:33.787

看起来像使用旧版本

```
C:\Program Files\Microsoft SDKs\Windows\v6.0\Bin\signtool.exe 
```

也解决了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-18T08:31:30.173

This issue might be because of missing intermediate certificate. Compare the certificate in both machines (by double click on same machine) and observe Certificate path tab. If any intermediate certificate node is missing then export the same certificate from old machine and import it on new machine.

# fft - 频率向量中的 bin 与频率峰值之间的关系

> ID：15704634
> 
> 赞同：0
> 
> 时间：2013-03-29T13:50:32.900
> 
> 标签：fft, frequency, bins

我想知道频率箱和峰值频率之间是否存在任何一般关系：比如一个波 x=Asin(2*pi*w*t +phi)，通过 fft 和 fftshift 得到正频率和负频率（-w 和 w Hz），例如给出频域 f = f=linspace(-fs/2, fs/2, L); 其中 fs 是采样频率，L 是 fft 的长度或任何其他方式。你如何找到 w 和 -w 所在的 bin？除了查看输出数据并手动查找 int 之外？fft 如何回馈频率？谢谢...

# java - 将参数从 JNLP 传递到 JavaFX2

> ID：15704637
> 
> 赞同：3
> 
> 时间：2013-03-29T13:50:41.677
> 
> 标签：java, applet, javafx-2, jnlp

我正在尝试将 JNLP 文件中定义的参数传递给我的 JavaFX 2 应用程序。我认为这将是直截了当的，但我似乎无法让它发挥作用。我已经阅读了很多关于该主题的内容，但没有成功。

这是定义参数的 JNLP 文件的一部分：

```
...
<applet-desc  width="800" height="600" main-class="com.javafx.main.NoJavaFXFallback"  name="Module" >
    <param name="requiredFXVersion" value="2.2+"/>
    <param name="key1" value="value1"/>
</applet-desc>
... 
```

我尝试使用以下代码读取 JavaFX 2 应用程序中的参数：

```
@Override
public void start(Stage stage) throws Exception {
    System.out.println("key1 = " + getParameters().getNamed().get("key1"));
    ...
} 
```

但是，如果我清理并构建项目并通过 JNLP 文件启动它，我会检查 Java 控制台并获得：

```
key1 = null 
```

任何想法可能是什么问题？提前致谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T12:00:28.753

```
<applet-desc  width="800" height="600" main-class="com.javafx.main.NoJavaFXFallback"  name="Module" >
    <param name="requiredFXVersion" value="2.2+"/>
    <param name="key1" value="value1"/>
</applet-desc> 
```

AFAIK applet-desc 元素仅在没有可用的 javafx-runtime 时使用。将主类指向`com.javafx.main.NoJavaFXFallback`意味着您不提供小程序的 pre-javafx 版本。

相反，真正的主要方法及其参数由下面的元素指出：

```
<jfx:javafx-desc  width="960" height="720" main-class="brickbreaker.Main"  name="BrickBreaker" >
    <fx:param name="sampleParam" value="Built with 1.7.0_17"/>
    <fx:param name="noValueParam"/>
    <fx:argument>Arg1</fx:argument>
    <fx:argument>Arg2 with spaces </fx:argument>
</jfx:javafx-desc> 
```

> JavaFX 应用程序支持两种类型的应用程序参数：命名和未命名（请参阅 API for Application.Parameters）。
> 
> 静态命名参数可以使用添加到应用程序包中，未命名参数可以使用添加。它们适用于所有执行模式，包括独立应用程序。

来源：[http ://docs.oracle.com/javafx/2/deployment/packaging.htm](http://docs.oracle.com/javafx/2/deployment/packaging.htm)

# java - solr 和 lucene 的区别

> ID：15704644
> 
> 赞同：175
> 
> 时间：2013-03-29T13:51:00.967
> 
> 标签：java, solr, lucene

我知道 Lucene 和 Solr 是 2 个不同的[Apache 项目](http://lucene.apache.org/)，它们可以一起工作，但我不明白每个项目的目的是什么。

到目前为止我的理解是 Lucene 用于创建搜索索引，Solr 使用该索引来执行搜索。我是对的还是这是一种完全不同的方法？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2013-03-29T15:49:13.917

***@darkheir：Lucene 和 Solr 是 2 个不同的 Apache 项目，它们可以一起工作，我不明白每个项目的目的是什么。***

1.  Solr 在后台使用 Lucene。Lucene 不知道 Solr API。

2.  Lucene 是一个强大的搜索引擎框架，它让我们可以为我们的应用程序添加搜索功能。它公开了一个易于使用的 API，同时隐藏了所有与搜索相关的复杂操作。任何应用程序都可以使用这个库，而不仅仅是 Solr。

3.  Solr 是围绕 Lucene 构建的。它不仅仅是一个围绕 Lucene 的 http 包装器，而且[还**为 Lucene 添加了更多的武器库**](https://web.archive.org/web/20140625111518/http://heliosearch.org/lucene-solr-history/)（已归档）。Solr 开箱即用。它是一个 Web 应用程序，除了 Lucene 提供的功能外，还提供相关的基础设施和更多功能。

***@darkheir：Lucene 用于创建搜索索引，Solr 使用此索引执行搜索。我是对的还是这是一种完全不同的方法？***

4.  **Lucene 不只是为 Solr 的消费创建索引**。Lucene 处理所有与搜索相关的操作。任何应用程序都可以使用 Lucene 框架。

    例如 Solr、Elastic Search、LinkedIn（是的，在后台）等。

查看这篇文章：[Lucene vs Solr](http://www.lucenetutorial.com/lucene-vs-solr.html)

**更新（2014 年 6 月 18 日）**

**什么时候使用 Lucene？**

*   你是一名搜索工程师并且
*   你是一个程序员并且
*   您希望完全控制 Lucene 的几乎所有内部​​结构和
*   您的要求要求您对 Lucene 和
*   您愿意处理搜索的基础设施元素，例如扩展、分发等。

**什么时候使用 Solr？**

*   以上至少一项没有意义。或者
*   您想要开箱即用的东西（即使没有 Java 知识）或
*   您的基础架构要求超过了搜索自定义要求。

**注意**：我并不是说 Solr 很难定制。Solr 非常灵活，并提供了很多可插拔的 API 点，让您可以随意插入代码。

有些人属于“*必须使用 Lucene* ”阵营，但仍然喜欢 Solr 而不是普通的 Lucene，因为它易于使用。但是，他们从不克制自己最大限度地定制 Solr。

顺便说一句，我看到 Solr (4.x) 上的资源比 Lucene (4.x) 上的资源多。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-03-29T15:39:12.897

Lucene 是一个实现索引、分析、搜索等的低级 Java 库（带有 .NET 端口等）。

Solr 是一个使用 Lucene 的独立预配置产品/webapp。如果您更喜欢处理 HTTP API 而不是 Java API，那么 Solr 适合您。Solr 还有一些额外的功能（例如[grouping](http://wiki.apache.org/solr/FieldCollapsing)）。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-06-18T13:00:36.600

> 概念化 Solr 和 Lucene 之间关系的一种简单方法是汽车及其引擎。你不能开引擎，但你可以开汽车。同样，Lucene 是一个程序库，您不能按原样使用它，而 Solr 是一个完整的应用程序，您可以开箱即用。

来源：[Lucene-vs-solr - Lucene 教程](http://www.lucenetutorial.com/lucene-vs-solr.html)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-11-11T16:05:57.213

**Solr 建立在 lucene 之上以提供搜索平台。**

搜索平台从下到上分为以下几层：

*   数据
    *   目的：表示各种数据类型和来源
*   文件建设
    *   目的：为索引建立文档信息
*   索引和搜索
    *   目的：建立和查询文档索引
*   逻辑增强
    *   目的：用于处理搜索查询和结果的附加逻辑
*   搜索平台服务
    *   目的：增加搜索引擎核心的附加功能，提供服务平台。
*   界面应用
    *   目的：最终用户搜索界面或应用程序

![solr 堆栈](../Images/dd64510dffa2cbbb0555613bfe9a5925.png)

参考文章：[企业搜索](http://manmustbecool.github.io/MyWiki/papers/Enterprise%20search%20with%20development%20for%20network%20management%20system.pdf)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-08-25T12:00:09.837

SOLR 是Lucene 索引的**包装器。**

很容易理解：SOLR 是**汽车**，Lucene 是它的**引擎**。您只需要知道如何驾驶汽车（SOLR），还需要了解引擎（Lucene）的一些知识，以防您的汽车引擎出现任何问题。

安全驾驶:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-25T17:47:05.997

您可以通过以下方式进行想象 - Apache Lucene 是 Apache Solr 内部使用的库。它是用 Java 编写的，并提供了惊人的全文搜索和索引功能。它可以分析来自世界各地的大量语言并准备这些语言的文本以进行高效快速的搜索和分析。Lucene 是一个库 - 您可以直接在应用程序中使用它并自己实现所有内容，但 Apache Solr 提供了很多开箱即用的功能。

Apache Solr 搜索引擎提供了诸如 HTTP API 之类的东西，您可以使用这些 API 向它们发送数据，然后在该数据上进行搜索。您可以使用 API 控制搜索引擎，创建分布式环境并自动将数据分布到多个节点等等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-05T07:05:07.077

你可以在这里找到关于 lucence 和 solar 用途的很好的比较：

[http://www.lucenetutorial.com/lucene-vs-solr.html](http://www.lucenetutorial.com/lucene-vs-solr.html)

TLDR：Lucence 只是引擎，Solar 是您可以驾驶的汽车（配备了 rest-api 等）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-27T13:29:04.287

**Apache Lucene 是搜索引擎**的香草版本，而****Apache Solr 继承了 Lucene**，具有 Apache Lucene 开箱即用不提供的新内置功能。**

 **您可以使用 Apache Solr 风格而不是使用 Apache Lucene 来节省您的资源和手动工作。如果您想创建自己的定义，您也可以在 Solr 和 Lucene 中通过添加自定义 jar 和自定义代码来完成。**

# extjs4 - 无法更新 extjs 中的多条记录

> ID：15704647
> 
> 赞同：0
> 
> 时间：2013-03-29T13:51:11.843
> 
> 标签：extjs4

我创建了一个这样的按钮处理程序：

```
function(){
        var selection = grid_mt_p.getView().getSelectionModel().getSelection();
        /*var len = selection.length;
        for(var i=0;i<len;i++){
            selection[i].set('ma_phong', "");
        }*/
        if (Ext.isArray(selection)) {
            Ext.each(selection, function(s) {
                s.set({ma_phong: ""});
            });
        }
    } 
```

但是当我单击按钮时，它只会更改第一个选择的 ma_phong 。我的代码是错误的还是我忘记了什么？

# timer - JEE6 @Schedule 方法

> ID：15704653
> 
> 赞同：0
> 
> 时间：2013-03-29T13:51:35.510
> 
> 标签：timer, glassfish

我正在使用 Glassfish 3.1.2.2。我有一个 EJB 3.1 无状态 bean，它有一个方法注释为：

```
@Schedule(second = "*", minute = "*/5", hour = "5-23", persistent = false) 
```

所以这个方法会在 5:05, 5:10, 5:15, ... 运行。

如果这个方法运行超过 5 分钟会发生什么？是否会同时运行此方法的两次调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T18:21:00.863

如果您的方法在`@Singleton`bean 中，则只有一次方法调用会同时运行。但是，容器可能会在完成时重试执行该方法，这可能会导致该方法的持续执行。[这个问题](https://stackoverflow.com/questions/14402068/ejb-schedule-wait-until-method-completed)中描述了一种防止这种情况的技术。

# android - 创建像全景图这样的应用程序

> ID：15704657
> 
> 赞同：1
> 
> 时间：2013-03-29T13:51:42.320
> 
> 标签：android, android-camera

我正在创建像全景 360 这样的应用程序。问题是我如何使用传感器加速度计来捕捉连续图像并知道图像与最后捕捉的图像的 40% 重叠我已经做了很多谷歌搜索，但对我来说没有任何帮助可以帮助我出去。遇到这种问题我该怎么办

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:17:03.937

嗯......这将是困难的，它可能需要一个非常先进的算法才能正常工作。

我不知道像这样简单的东西是否可以工作，所以用一粒盐来处理这个问题，但是如何将每个图像裁剪为 20x20 像素之类的东西。将所有最暗的像素更改为黑色，将所有最亮的像素更改为白色。然后循环遍历 2 张图像的所有像素，并比较 40% 的像素是否彼此相等。并根据像素相似的位置以某种方式将它们缝合在一起......

# c++ - 在 C++ 中使用递归函数反转字符串

> ID：15704660
> 
> 赞同：0
> 
> 时间：2013-03-29T13:51:53.323
> 
> 标签：c++, string, function, recursion

为了探索我对递归的理解，我试图通过使用递归函数来反转字符串。这似乎应该比现在对我来说更简单。谁能告诉我我做错了什么。当我执行下面的代码时，它会产生一个空行。我在这里四处寻找类似的主题，但每件事都是用其他语言写的……令我惊讶的是。

```
#include <iostream>
#include <string>

using namespace std;

/**
    Recursivly reverses a string
    @param return last_char, the last character currently in the string
    @param go, the recursive function to return the character and continue     within the function
    **/
char string_reverse(string word)
{

    if (word.length()-1 > 0)
    {
    char last_char = word[word.length()-1];
    word.erase(word.length()-1);
    char go = string_reverse(word);
    return go;

    }

else 
    return false;

}

int main()
{
cout << "Enter a string: ";
string input;
getline(cin, input);
string last;
last = last + string_reverse(input);
cout << last << endl;

/*char fig = string_reverse(input, fig);
cout << fig << endl;
*/

system("pause");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:55:37.233

在中`string_reverse`，您应该返回`last character`++ `string_reverse(word)`。`first character`

在您的`else`中，返回一个空字符串，这样您就不会遇到输入错误。

当您调用该函数时，不要对 做任何其他事情`word`，只需调用`string_reverse(word)`

把它们放在一起：

```
#include <iostream>
#include <string>

using namespace std;

/**
    Recursivly reverses a string
    @param return last_char, the last character currently in the string
    @param go, the recursive function to return the character and continue
    within the function
    **/
string string_reverse(string word)
{

    if (word.length()-1 > 0)
    {
    string first_char = word.substr(0,1);
    string last_char = word.substr(word.size()-1,1);
    string middle = word.substr(1, word.size()-2);
    return last_char + string_reverse(middle) + first_char;

    }

else 
    return "";

}

int main()
{
cout << "Enter a string: ";
string input;
getline(cin, input);
cout << string_reverse(input); << endl;

system("pause");
return 0;
} 
```

但是，对于奇数字母计数，这将失败。“c”将输出“cc”。我会把它留给你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T13:55:14.170

`string_reverse()`返回`char`。您不可能使用单个`char`.

最重要的是，其中的逻辑距离做任何接近反转字符串的事情`string_reverse()`还有*很长的路要走。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-29T13:59:27.633

您需要返回字符串，还需要将提取的字符添加到返回值

```
string string_reverse(string word)
{
    if (word.length() - 1 > 0)
    {
        char last_char = word[word.length()-1];
        word.erase(word.length()-1);
        string go = string_reverse(word);
        return go.insert(0, 1, last_char);
    }
    else
        return "";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:13:53.410

你的反向身体根本不起作用。反转的思路如下：

```
If the string len is 1, return it.
Otherwise,
   Remove the first character.
   Recursively reverse the remaining string.
   Add the first character above to the reversed string.
   Return the new string. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-09T18:13:19.407

如果您返回字符串，您可以获得的最短版本将是：

```
std::string string_reverse(const std::string& str)
{
  return str.size() > 1? string_reverse(str.substr(1)) + str[0] : str;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-08T20:42:34.767

这是对上述答案之一的小调整，可处理偶数或奇数长度的字符串：

```
string reverse (string str)
{

if (str.length() == 0)
    return "";
else
    if (str.length() == 1)
        return str.substr(0,1);
    else
    {
        string first_char = str.substr(0,1);
        string last_char = str.substr(str.size()-1,1);
        string middle = str.substr(1, str.size()-2);
        return last_char + reverse(middle) + first_char;
    }
 } 
```

长度为 0 的字符串和长度为 1 的字符串必须分别与递归情况分开处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-04T05:16:04.123

Found an easy way to rewrite code without all the function calls that works for odd or even number strings. Seems more efficient please note if there is any bugs, this was a homework question I solved. Would love any comments to correct issues

```
string R_reverse(string input)
{
	if (input.length() == 0)
		return input;
	else
	{
		string old = input.substr(0,1);
		string newstr = input.substr(1, (input.length() - 1));
		return R_reverse(newstr) + old;
	}
}
```

# c++ - patsubst 在 GNU make 中不起作用？

> ID：15704662
> 
> 赞同：2
> 
> 时间：2013-03-29T13:52:06.323
> 
> 标签：c++, makefile, gnu-make

我在 Windows 8 上使用 GNU make 来了解 makefile。我所指的教程是为 Linux 编写的，所以我正在更正据我所知给出的 makefile，例如将 '/' 替换为 '\' 等。

我的makefile内容是：

```
CC=g++
INCLIST=functions.h
INCDIR=..\include
OBJDIR=.\obj
BINDIR=..\bin
_OBJLIST = main.o
OBJ=$(patsubst %,$(OBJDIR)\%,$(_OBJLIST))

all: main.o

main.o: main.cpp
    $(CC) -c -I $(INCDIR) main.cpp -o $(OBJ) 
```

我可以通过手动编译 main.cpp

```
g++ -c -I ..\include main.cpp -o .\obj\main.o 
```

但是，当我运行时`make`，输出是：

```
g++ -c -I ..\include main.cpp -o .\obj% 
```

并且目标文件是在当前目录而不是`.\obj`目录中创建的，并且被命名`./obj%`而不是 required `main.o`。我在 Ubuntu 上运行了相同的设置，它运行良好，谁能解释为什么？

谢谢.. ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T18:38:56.807

反斜杠是转义标记，因此 \% 是文字百分号。此外， / 也适用于 Windows。

# c++ - QTCreator 在调试 C++ 程序时无法识别可执行文件

> ID：15704663
> 
> 赞同：1
> 
> 时间：2013-03-29T13:52:17.513
> 
> 标签：c++, qt-creator

我已经通过 sudo apt-get install 在 ubuntu 12.04 中安装了 QTCreator。我的问题是 QTcreator 无法在调试模式下识别可执行文件，尽管它在没有调试的情况下运行良好..当我只是运行我的程序时。QTCreator 在调试时向我抛出的错误是：

```
s/Prog": not in executable format: File format not recognized 
```

我可以在 QtCreator 之外使用 gdb。我所有的工具链都只显示了 GCC（x86 64 位）......这个设置好吗？如果没有请推荐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-16T22:26:33.977

我遇到了同样的问题，`Ubuntu 13.10`我所做的是`sudo apt-get install gdb`，之后调试器工作正常。然而，对我来说似乎很奇怪的是，虽然我已经拥有`gdb`and `gdb64`in `/usr/bin`，`apt`但并没有说它`gdb`已经安装并且它安装了它（可能是升级版本）。

还要检查您的工具链，并确保您正在使用`gdb 64-bit`您的可执行文件是否构建在`64-bits`.

我用`Qt Creator 3.1.0`，也许你也应该升级你`QtCreator`的。

希望这可以帮助。

# r - 计算数据字符串列中非 NA 的简单方法

> ID：15704665
> 
> 赞同：8
> 
> 时间：2013-03-29T13:52:27.333
> 
> 标签：r, na

我试图找到一种简单的方法来计算数据框列中的非缺失案例。我已经使用了以下功能：

```
foo<- function(x) { sum(!is.na(x)) } 
```

然后通过 sapply() 将其应用于数据帧

```
stats$count <- sapply(OldExaminee, foo2, simplify=T) 
```

虽然这工作正常，但我只是不相信没有更简单的计数方法，即基本函数集中的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-29T15:15:27.330

对于 a`data.frame`你可以使用`colSums`and得到它`is.na`：

```
set.seed(45)
df <- data.frame(matrix(sample(c(NA,1:5), 50, replace=TRUE), ncol=5))
#    X1 X2 X3 X4 X5
# 1   3  2 NA  2 NA
# 2   1  5  1  1  4
# 3   1  1  3  2  3
# 4   2  2  3  5  3
# 5   2  2  5  2  2
# 6   1  2 NA  3  3
# 7   1  5  5  5  2
# 8   3 NA  4  1  5
# 9   1  2  3 NA  1
# 10 NA  1  1  2  2

colSums(!is.na(df))
# X1 X2 X3 X4 X5 
#  9  9  8  9  9 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-29T14:12:07.660

你可以使用 na.omit

```
length(na.omit(x)); 
```

连同申请，因为 caelorus 的帖子表明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T13:55:51.797

您可以使用`which`和`length`：

```
length(which(!is.na(x$col))) 
```

`which`返回匹配元素的索引（在本例中为非`NA`s），并`length`告诉您这些索引有多少。

一次对所有列：

```
apply(OldExaminee, 2, function(x){ length(which(!is.na(x))) }) 
```

# php - PHP 页面加载，但也在 chrome 浏览器中显示原始代码

> ID：15704674
> 
> 赞同：0
> 
> 时间：2013-03-29T13:52:50.173
> 
> 标签：php, web

我是 PHP 新手，遇到了一些问题。

当我通过 IDE 的编译器运行它们时，我在 Netbeans 7.3 中编写的 .php 文件可以正常工作。但是当我在 Google Chrome 浏览器中运行它们时**，**相同的网页会显示原始代码。

这是一个示例代码 -

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title> Add Your Highscore! </title>
    </head>
    <body>
        <h2> Guitar Wars - Add you highscore!</h2>
        <?php
        //echo "successful!!";

        if(isset($_POST['submit'])){
        $name=$_POST['name'];
        $score=$_POST['score'];
        $screenshot=$_FILES['screenshot']['name'];
        $screenshot_type=$_FILES['screenshot']['type'];
        $screenshot_size=$_FILES['screenshot']['size'];

        $output=false;
        if(!empty($name)&&!!empty($score)&&!empty($screenshot))
       {  

            if ((($screenshot_type == 'image/gif') || ($screenshot_type == 'image/jpeg') || ($screenshot_type == 'image/pjpeg') || ($screenshot_type == 'image/png'))
        && ($screenshot_size > 0) && ($screenshot_size <= GW_MAXFILESIZE)) {
        if ($_FILES['screenshot']['error'] == 0) {
          // Move the file to the target upload folder
          $target = 'images' . $screenshot;
          if (move_uploaded_file($_FILES['screenshot']['tmp_name'], $target)) 
            // Connect to the database
         {
            $db=  mysqli_connect('localhost','root', 'akash123','gwdb') 

                  or die('Error in connecting to the database');
        //echo "</br> successful connection";
        $query= "insert into guitar wars values(0,NOW(),$name, $score, $screenshot ";
        //echo "</br> successful query";
        $result= mysqli_query($db,$query) ;

       mysqli_close($db,$query);
       echo "</br> Successful!";
       $name='';
       $score='';
       $screenshot='';

        mysqli_close($db);
        }
        else
        {echo "There was a problem uploading the image";
        }

        }  
        else
        {echo "There was a problem uploading the image";

        $output=true;
        }
        }

        else{echo '<p class="error">The screen shot must be a GIF, JPEG, or PNG image file no greater than ' . (GW_MAXFILESIZE / 1024) . ' KB in size.</p>';
        $output=true;
        }}

        else{echo "* Enter all the information to add your highscore";
        $output=true;
        }

        }

        else
        { 
            $output=true;
            $name='';
            $score='';
        }

            if ($output){ 
            ?>

<form enctype="multipart/form-data" method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">
    <input type="hidden" name="MAX_FILE_SIZE" value="65536"/>
<label for="name">Full Name:</label>
<input type="text" id="name"  name="name" value="<?php echo $name ; ?>" /></br>
<label for="score">Your Highscore :</label>
<input type="text" id="score"  name="score" value="<?php echo $score ; ?>" /></br>
<label for="screenshot"> Screenshot of your Highscore: </label>
<input type="file" id="screenshot" name="screenshot" /></br>
<input type="submit" name="submit" value="Add"/>

</form>
    <?php

        }

        ?>
    </body>
</html> 
```

Internet Explorer 毫无希望，因为它试图下载 .php 文件。

这个结果的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:54:19.520

您的网络服务器可能没有将文件传递给 PHP 解释器。检查您的网络服务器配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:10:09.123

你不能在浏览器中“打开”一个 php 文件，你必须“运行”它。netbeans 将运行文件（请注意，它们不会像 java 那样被编译）

if you are testing on your local machine, you need an apache installation which runs php ([xampp](http://www.apachefriends.org/en/xampp.html) for example).

if you are using xampp:

open the htdocs folder inside the xampp folder.

create a new folder for your webapp.

put your php file in that folder.

in your web browser, NAVIGATE to your php page (in the address bar, type in the IP address of the machine running xampp, or localhost, or however you have it configured, mylocalhostip/mywebapp/myphpfile.php for example.

then it should work fine

# regex - 正则表达式和拆分/替换 VB.NET

> ID：15704678
> 
> 赞同：0
> 
> 时间：2013-03-29T13:53:05.610
> 
> 标签：regex, vb.net

我通过正则表达式得到这个值 `<a href="http://www.site.com/path/index.php" class="visio_large" target=""><span>Click here</span></a>`

如何获取 URL“ [http://site.com/path/index.php](http://site.com/path/index.php) ”（不带引号）并保留所有其余值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:03:40.083

尝试避免使用正则表达式解析 HTML。

但是，如果您确定 HTML 的简洁性并且需要快速破解，那么您可以使用这个正则表达式：

`/<a href="(.+)">/`

使用构建它`New Regex()`并匹配`.Match()`并获取值`.Value`

# python - 烧瓶句柄异常不适用于 test_request_context

> ID：15704680
> 
> 赞同：1
> 
> 时间：2013-03-29T13:53:17.427
> 
> 标签：python, flask

我注意到`app.handle_exception`当异常发生时似乎没有被调用`app.test_request_context`：

```
from flask import *

app = Flask(__name__)
app.handle_exception = lambda e: 'exception!'

@app.route('/foo')
def foo():
    x = 1 / 0
    return 'ok'

if __name__ == '__main__':
    #app.run(port=81) # handle_exception works here
    with app.test_request_context('/foo'):
        print app.dispatch_request() # but not here 
```

这是预期的行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:16:55.653

您可以轻松地覆盖此行为并使用相同的处理程序强制处理异常。

```
def run_test(path=None,check_func=None,*args,**kwargs):
    with app.test_request_context(path,*args,**kwargs):
        try:
            data=app.dispatch_request() 
            if check_func is not None:
                 check_func()
            else:
                print data
        except Exception as e:
            print app.handle_exception(e)

run_test('/')
run_test('/other')

def current_test(data):
     assert 'has some content' in data
run_test('/should_be_checked',check_func=current_test) 
```

还有一句话。

您的方法不起作用，因为您只是不使用 Flask 的那部分，它实际上捕获了异常。您正在直接调用上下文。

从文档中引用：

> 如果你研究一下 Flask WSGI 应用程序的内部工作原理，你会发现一段代码看起来很像这样：

```
def wsgi_app(self, environ):
    with self.request_context(environ):
        try:
            response = self.full_dispatch_request()
        except Exception, e:
            response = self.make_response(self.handle_exception(e))
        return response(environ, start_response) 
```

* * *

但！以下是正确的方法，因为每个级别的所有 Flask 方法都将以适当的方式调用：

```
with app.test_request_context():
    with app.test_client() as client:
        resp = client.get('/')
        #and if you need content of response: print resp.data 
```

## ---

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T15:28:50.683

不确定这是否是您所追求的：根据[dispatch_request 的文档](http://flask.pocoo.org/docs/api/#flask.Flask.dispatch_request)：

> 请求调度。匹配 URL 并返回视图或错误处理程序的返回值。这不必是响应对象。为了将返回值转换为正确的响应对象，请调用 make_response()。
> 
> 在 0.7 版更改：这不再进行异常处理，此代码已移至新的 full_dispatch_request()。

所以，也许换...

```
with app.test_request_context('/foo'):
    print app.dispatch_request() # but not here 
```

...和...

```
with app.test_request_context('/foo'):
    print app.full_dispatch_request() # Hopefully this works now :) 
```

# javascript - Constructor.prototype 不在原型链中？

> ID：15704682
> 
> 赞同：7
> 
> 时间：2013-03-29T13:53:27.693
> 
> 标签：javascript, prototype

相关：[关于原型链、原语和对象的混淆](https://stackoverflow.com/q/15705232/369489)

在 Firebug 控制台中：

```
a = 12
a.constructor.prototype.isPrototypeOf(a) // prints 'false' 
```

我认为这应该打印`true`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T14:04:15.790

`a = 12`创建一个原始数字，它与对象不完全相同`Number`。出于属性访问的目的，基元被隐式转换为对象。

```
a = 12; //a is a primitive
b = new Number(12); //b is an object
a.constructor.prototype.isPrototypeOf(a); //false because a is primitive
b.constructor.prototype.isPrototypeOf(b); //true because b is an object 
```

根据[ECMAScript 规范](http://es5.github.com/#x15.2.4.6)：

> 当使用参数*V*`isPrototypeOf`调用该方法时，将执行以下步骤：
> 
>  *1.  如果*V*不是对象，则返回`false`。*

 *严格来说，原始数字不是对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:59:07.967

```
a = new Number(12);
a.constructor.prototype.isPrototypeOf(a) // prints 'true' 
```

我不够聪明，无法告诉你为什么我只知道事情就是这样。是的，这很奇怪。

现在，你可以说*“`12`是一个原始的并且`new Number(12)`是一个对象”。*但是你怎么解释这个？

```
(12).toFixed(3); // "12.000" 
```

显然，JavaScript 在某个地方决定原语也可能是一个对象。

为什么会存在这种区别？你如何在这两种形式之间转换？这对性能有何影响？我没有答案的与这个问题相关的所有问题。*

# xamarin.ios - Monotouch 设置 UIButton 在事件处理程序方法中突出显示

> ID：15704686
> 
> 赞同：1
> 
> 时间：2013-03-29T13:53:37.580
> 
> 标签：xamarin.ios, uibutton

我创建了一个按钮，我希望在单击时突出显示该按钮。这是单击按钮时的事件处理程序。

```
void buttonClicked (object sender, EventArgs e){
        UIButton button = (UIButton)sender;
        button.Highlighted = true;
                    Console.WriteLine(button.Title(UIControlState.Normal));
} 
```

事件处理程序被调用，因为控制台打印出正确的标题。但是，该按钮未突出显示。这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T19:03:37.310

您的用例建议使用`Selected`属性和`SetImage(highlightBackgroundImg, UIControlState.Selected)`.

```
button.SetImage(img, UIControlState.Selected);
button.TouchUpInside += (s, e) => {
   button.Selected = true;
} 
```

# asp.net-mvc-4 - “发现多个操作”错误

> ID：15704687
> 
> 赞同：0
> 
> 时间：2013-03-29T13:53:41.360
> 
> 标签：asp.net-mvc-4, asp.net-web-api, asp.net-mvc-routing, asp.net-web-api-routing

我为我的 web api 服务设置了以下默认路由...

```
config.Routes.MapHttpRoute(
    name: "DefaultControllerWithIdAndAction",
    routeTemplate: "api/{controller}/{id}/{action}",
    defaults: new {action = RouteParameter.Optional}
    );

config.Routes.MapHttpRoute(
    name: "DefaultPost",
    routeTemplate: "api/{controller}",
    defaults: new { action = "Post" },
    constraints: new { httpMethod = new HttpMethodConstraint(HttpMethod.Post) }
    );

config.Routes.MapHttpRoute(
    name: "DefaultGetWithId",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { action = "Get" },
    constraints: new { httpMethod = new HttpMethodConstraint(HttpMethod.Get) }
    );

config.Routes.MapHttpRoute(
    name: "DefaultPutWithId",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { action = "Put" },
    constraints: new { httpMethod = new HttpMethodConstraint(HttpMethod.Put) }
    );

config.Routes.MapHttpRoute(
    name: "DefaultDeleteWithId",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { action = "Delete" },
    constraints: new { httpMethod = new HttpMethodConstraint(HttpMethod.Delete) }
    );

config.Routes.MapHttpRoute(
    name: "DefaultControllerWithAction",
    routeTemplate: "api/{controller}/{action}",
    defaults: new { action = RouteParameter.Optional }
    ); 
```

我在“UsersController”下有以下服务：

```
public UserDto Get(string id){}

[HttpGet]
public UserDto ByEmail(string email)

[HttpGet]
public bool IsEmailUnique(string email) 
```

问题是我在尝试访问这三个服务中的任何一个时都会收到“发现多个操作”错误。请求应该从所有路由中选择最后一个路由并执行请求。

如果我要执行'/api/users/byemail?email=blah@blah.com'，不应该知道'ByEmail'是动作并且使用方法和动作，匹配正确的方法吗？我想我错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:26:32.970

似乎您已将 BeEmail 和 IsEmailUnique 方法映射到 GET 操作，这导致找到多个操作。

~~由于您已经为命名操作 (DefaultControllerWithAction) 设置了路由模板，您可以删除 [HttpGet] 属性。~~

~~在此之后，路由模板“DefaultControllerWithAction”应该很好地整理出“/api/users/byemail”~~

**编辑：** 似乎在同一个 ApiController 中混合传统和基于动词的路由存在问题。这[在 codeplex 上](http://aspnetwebstack.codeplex.com/workitem/184)有记录，并且有一篇博客文章声称已经解决了这个问题（尚未测试）： [http ://blog.appliedis.com/2013/03/25/web-api-mixing-traditional-verb-based -路由/](http://blog.appliedis.com/2013/03/25/web-api-mixing-traditional-verb-based-routing/)

**edit2：**
刚刚对此进行了测试，Kip Streithorst 的解决方案适合您的情况。

```
第 1 步：硬编码默认值，而不是指定该操作是可选的。
第 2 步：使用硬编码的默认操作名称装饰您的“基于动词的控制器”
```

对于您的获取请求，这将是：

```
    config.Routes.MapHttpRoute(
        名称：“DefaultControllerWithAction”，
        routeTemplate: "api/{controller}/{action}",
        默认值：新 { action = "DefaultAction }
        );
    config.Routes.MapHttpRoute(
        名称：“DefaultGetWithId”，
        routeTemplate: "api/{controller}/{id}",
        默认值：新 { action = "Get" },
        约束：新 { httpMethod = 新 HttpMethodConstraint(HttpMethod.Get) }
        );
    config.Routes.MapHttpRoute(
        name: "DefaultControllerWithIdAndAction",
        routeTemplate: "api/{controller}/{id}/{action}",
        默认值：新 { action = "DefaultAction" }
        );

```

和

```
    [动作名称（“默认动作”）]
    公共 UserDto 获取（字符串 id）{}

    [HttpGet]
    公共 UserDto ByEmail（字符串电子邮件）

    [HttpGet]
    公共布尔 IsEmailUnique（字符串电子邮件）

```

# jquery - JQuery Mobile 中的水平布局

> ID：15704691
> 
> 赞同：0
> 
> 时间：2013-03-29T13:53:48.460
> 
> 标签：jquery, css, jquery-mobile, jquery-mobile-grid, jquery-mobile-select

我正在开发一个 jquery 移动应用程序。在我的应用程序中，我有一些想要水平布局的表单数据。目前，我有以下内容：

```
<div data-role="content">        
  <ul data-role="listview"> 
    <li data-role="list-divider">Information Here</li>
  </ul><br />

  <ul id="myList" data-role="listview" data-inset="true" data-theme="d" data-dividertheme="d">
    <li data-role="list-divider">Choice</li>
    <li data-role="fieldcontain">
      <div class="ui-grid-c">
        <div class="ui-block-a" style="font-weight:normal;">From</div>
        <div class="ui-block-b">
          <select name="selector1" id="selector"1 data-native-menu="false">
            <option value="__">Please Choose</option>                
          </select>                    
        </div>
        <div class="ui-block-c" style="font-weight:normal;">To</div>                
        <div class="ui-block-d">
          <select name="selector2" id="selector2" data-native-menu="false">
            <option value="__">Please Choose</option>                
          </select>                    
        </div>
      </div>
    </li>
  </ul>
</div> 
```

我的挑战是，网格方法均匀地划分了 4 列。实际上，我只想将元素水平放置。我不需要所有东西都均匀分布。但是，我不确定如何执行此操作。

如何水平布局内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:20:53.003

像这样的东西：http: [//jsfiddle.net/Gajotres/K9duV/](http://jsfiddle.net/Gajotres/K9duV/)

```
<ul id="myList" data-role="listview" data-inset="true" data-theme="d" data-dividertheme="d">
<li data-role="list-divider">Choice</li>
<li>
  <div class="ui-grid-a">
    <div class="ui-block-a" style="font-weight:normal;">
        <div data-role="fieldcontain" id="left-select">
            <label for="selector1">From:</label>            
            <select name="selector1" id="selector1" data-native-menu="false">
                <option value="__">Please Choose</option>                
            </select>
        </div>   
    </div>
    <div class="ui-block-b">
        <div data-role="fieldcontain" id="right-select">
            <label for="selector2">To:</label>               
            <select name="selector2" id="selector2" data-native-menu="false">
                <option value="__">Please Choose</option>                
            </select>                                
        <div>    
    </div>
  </div>
</li>
</ul> 
```

# android - Android MediaController 恢复后在 getCurrentPosition() 中抛出 IllegalStateException

> ID：15704694
> 
> 赞同：0
> 
> 时间：2013-03-29T13:54:03.940
> 
> 标签：android, illegalstateexception, mediacontroller

希望有人可以在这里帮助我...

我有一个流`.mp3`文件的活动。它看起来像这样：

```
public class PlayMediaActivity extends Activity implements OnPreparedListener, MediaController.MediaPlayerControl{
  private static final String TAG = "AudioPlayer";

  private MediaPlayer mediaPlayer;
  private MediaController mediaController;

  private Handler handler = new Handler();

  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_play_media);

    String title = this.getIntent().getStringExtra("Title");
    String URL = this.getIntent().getStringExtra("URL");

    this.setTitle(title); // Title on top of activity.

    ((TextView)findViewById(R.id.now_playing_text)).setText(title);

    mediaPlayer = new MediaPlayer();
    mediaPlayer.setOnPreparedListener(this);

    mediaController = new MediaController(this);

    try {
      mediaPlayer.setDataSource(URL);
      mediaPlayer.prepare();
      mediaPlayer.start();
    } catch (IOException e) {
      Log.e(TAG, "Could not open file " + title + " for playback.", e);
    }

  }

  @Override
  protected void onStop() {
        super.onStop();
        mediaController.hide();
        mediaPlayer.stop();
        mediaPlayer.release();
  }

  @Override
  public boolean onTouchEvent(MotionEvent event) {
    //the MediaController will hide after 3 seconds - tap the screen to make it appear again
    mediaController.show();
    return false;
  }

  //--MediaPlayerControl methods----------------------------------------------------
  public void start() {
    mediaPlayer.start();
  }

  public void pause() {
    mediaPlayer.pause();
  }

  public int getDuration() {
    return mediaPlayer.getDuration();
  }

  public int getCurrentPosition() {
    return mediaPlayer.getCurrentPosition();
  }

  public void seekTo(int i) {
    mediaPlayer.seekTo(i);
  }

  public boolean isPlaying() {
    return mediaPlayer.isPlaying();
  }

  public int getBufferPercentage() {
    return 0;
  }

  public boolean canPause() {
    return true;
  }

  public boolean canSeekBackward() {
    return true;
  }

  public boolean canSeekForward() {
    return true;
  }
  //--------------------------------------------------------------------------------

  public void onPrepared(MediaPlayer mediaPlayer) {
    Log.d(TAG, "onPrepared");
    mediaController.setMediaPlayer(this);
    mediaController.setAnchorView(findViewById(R.id.main_audio_view));

    handler.post(new Runnable() {
      public void run() {
        mediaController.setEnabled(true);
        mediaController.show();
      }
    });
  }

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_play_media, menu);
    return true;
}
} 
```

在我使用 telnet（“gsm 呼叫”）模拟电话并中断音频之前，这似乎很有效。当我完成通话后切换回我的应用程序时，它会抛出一个`IllegalStateException`from `getCurrentPosition()`：

```
03-29 13:33:59.896: E/AndroidRuntime(1238): FATAL EXCEPTION: main
03-29 13:33:59.896: E/AndroidRuntime(1238): java.lang.IllegalStateException
03-29 13:33:59.896: E/AndroidRuntime(1238):     at  android.media.MediaPlayer.getCurrentPosition(Native Method)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at com.lcboise.lifechurch.PlayMediaActivity.getCurrentPosition(PlayMediaActivity.java:79)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.widget.MediaController.setProgress(MediaController.java:381)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.widget.MediaController.show(MediaController.java:284)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.widget.MediaController.show(MediaController.java:249)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at com.lcboise.lifechurch.PlayMediaActivity.onTouchEvent(PlayMediaActivity.java:61)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.app.Activity.dispatchTouchEvent(Activity.java:2099)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1675)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2194)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1878)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.os.Looper.loop(Looper.java:130)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at android.app.ActivityThread.main(ActivityThread.java:3683)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at java.lang.reflect.Method.invokeNative(Native Method)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at java.lang.reflect.Method.invoke(Method.java:507)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-29 13:33:59.896: E/AndroidRuntime(1238):     at dalvik.system.NativeStart.main(Native Method) 
```

任何想法我做错了什么？是否有一些状态我必须在中断时保存，然后在应用程序恢复时恢复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T19:12:26.933

这是一个完整的工作示例`MediaPlayer`，`MediaController`它将在来电时暂停/恢复音频。如果有人发现错误，请告诉我。

```
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnErrorListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.ProgressDialog;
import android.content.DialogInterface;
import android.telephony.PhoneStateListener;
import android.telephony.TelephonyManager;
import android.util.Log;
import android.view.ContextThemeWrapper;
import android.view.Menu;
import android.view.MotionEvent;
import android.widget.MediaController;
import android.widget.TextView;

public class PlayMediaActivity extends Activity implements OnPreparedListener, OnErrorListener, MediaController.MediaPlayerControl{
      private static final String TAG = "AudioPlayer";

      private MediaPlayer myMediaPlayer;
      private MediaController mediaController;

      private int seek_position = 0;

      private boolean isPaused = false; // If the player was paused before being stopped.

      private PhoneStateListener phoneStateListener = null;

      ProgressDialog dialog = null;

      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_play_media);

        String title = this.getIntent().getStringExtra("Title");
        String URL = this.getIntent().getStringExtra("URL");

        ((TextView)findViewById(R.id.now_playing_text)).setText(title);

        // Register for phone events so we can pause/restart audio when a call happens.
        phoneStateListener = new PhoneStateListener() {
            @Override
            public void onCallStateChanged(int state, String incomingNumber) {
                if (state == TelephonyManager.CALL_STATE_RINGING) {
                    //Incoming call: Pause music
                    boolean s = isPaused;
                    pause();
                    isPaused = s; // Want to restore the state before we paused for phone call.
                } else if(state == TelephonyManager.CALL_STATE_IDLE) {
                    //Not in call: Play music
                    if(isPaused == true) {
                        pause();
                    }
                    else {
                        if(!isPlaying()) { // Only start if it's not currently started.
                            start();
                        }
                    }
                } else if(state == TelephonyManager.CALL_STATE_OFFHOOK) {
                    //A call is dialing, active or on hold. Pause music
                    boolean s = isPaused;
                    pause();
                    isPaused = s; // Want to restore the state before we paused for phone call.
                }
                super.onCallStateChanged(state, incomingNumber);
            }
        };

        try {           
            myMediaPlayer = new MediaPlayer();
            myMediaPlayer.setOnPreparedListener(PlayMediaActivity.this);
            myMediaPlayer.setOnErrorListener(PlayMediaActivity.this);

            mediaController = new MediaController(PlayMediaActivity.this);
            mediaController.setMediaPlayer(PlayMediaActivity.this);
            mediaController.setAnchorView(findViewById(R.id.main_audio_view));
            mediaController.setEnabled(true);

            // Inform the user that we are doing something (reading from the network).
            ContextThemeWrapper cw = new ContextThemeWrapper( PlayMediaActivity.this, R.style.AlertDialogTheme );
            dialog = ProgressDialog.show(cw, "", "Loading. Please wait...", true);

            myMediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
            myMediaPlayer.setDataSource(URL);

            myMediaPlayer.prepareAsync();
        } 
        catch (Exception e) 
        {
            Log.e(TAG, "Could not open file " + title + " for playback.", e);

            if(dialog != null) {
                dialog.dismiss();
            }

            ShowDialog("Unable to play audio. Try again later.");
        }
      }

    private void ShowDialog(String message) {
        // Alert the user something went wrong.
        ContextThemeWrapper cw = new ContextThemeWrapper( PlayMediaActivity.this, R.style.AlertDialogTheme );

        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder( cw );

        alertDialogBuilder.setTitle("Oops!");

        // set dialog message
        alertDialogBuilder
                .setMessage(message)
                .setCancelable(true) // Allow back hardkey to dismiss
                .setPositiveButton("OK",new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {
                        // if this button is clicked, close current activity
                        dialog.dismiss();
                        PlayMediaActivity.this.finish();
                    }
                  });

        alertDialogBuilder.setOnCancelListener(new DialogInterface.OnCancelListener() {  // Catch back key press.        
            @Override
            public void onCancel(DialogInterface dialog) {
                //do whatever you want the back key to do
                dialog.dismiss();
                PlayMediaActivity.this.finish();
            }
        });

        // create alert dialog
        AlertDialog alertDialog = alertDialogBuilder.create();

        // show it
        alertDialog.show();
    }

      @Override
      protected void onStop() { // Activity becomes hidden.
            super.onStop();
            mediaController.hide(); // So you don't get the "Leaked activity..." message.

            if(this.isPaused == true) {
                seek_position = myMediaPlayer.getCurrentPosition();
            }
      }

      @Override
      protected void onDestroy() {
           super.onDestroy();

           myMediaPlayer.stop();
           myMediaPlayer.release();
           myMediaPlayer = null;

           // Unregister for phone state information as part of cleanup.
           TelephonyManager mgr = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
           if(mgr != null) {
               mgr.listen(phoneStateListener, PhoneStateListener.LISTEN_NONE);
           }
      }

      @Override
      protected void onResume() {
           super.onResume();

           if(this.isPaused == true) { // Restore the playback position if it was paused.
               myMediaPlayer.seekTo(seek_position);
           }
      }

      @Override
      public boolean onTouchEvent(MotionEvent event) {
        //the MediaController will hide after 3 seconds - tap the screen to make it appear again
        mediaController.show();
        return false;
      }

      //--MediaPlayerControl methods----------------------------------------------------
      public void start() {
          myMediaPlayer.start();

        this.isPaused = false;
      }

      public void pause() {
          myMediaPlayer.pause();

        this.isPaused = true;
      }

      public int getDuration() {
        return myMediaPlayer.getDuration();
      }

      public int getCurrentPosition() {
        return myMediaPlayer.getCurrentPosition();
      }

      public void seekTo(int i) {
        myMediaPlayer.seekTo(i);
      }

      public boolean isPlaying() {
        return myMediaPlayer.isPlaying();
      }

      public int getBufferPercentage() {
        return 0;
      }

      public boolean canPause() {
        return true;
      }

      public boolean canSeekBackward() {
        return true;
      }

      public boolean canSeekForward() {
        return true;
      }
      //--------------------------------------------------------------------------------

      public void onPrepared(MediaPlayer mediaPlayer) {
          Log.d(TAG, "onPrepared");

          if(dialog != null) {
              dialog.dismiss();
          }

          // Show and play the media AFTER it's been prepared.
          mediaController.show();       
          mediaPlayer.start();

          // Register for call state information AFTER we have started the media. This registration fires
          // the IDLE event, which would try and start the media. This causes a error in the media player
          // because we are "prepared" yet.
          TelephonyManager mgr = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
          if(mgr != null) {
              mgr.listen(phoneStateListener, PhoneStateListener.LISTEN_CALL_STATE);
          }
      }

      public boolean onError(MediaPlayer mp, int what, int extra) {

          if(dialog != null) {
            dialog.dismiss();
          }

          ShowDialog("Unable to play audio. Try again later.");

          return true;
      }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_play_media, menu);
        return true;
    }

} 
```

# java - IN Thread-Safe 如何编写 Map 和其他线程读取

> ID：15704696
> 
> 赞同：1
> 
> 时间：2013-03-29T13:54:08.720
> 
> 标签：java, android

如何在 Thread-Safe Map 和其他线程中写入线程读取它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T13:55:02.027

不用写了`ConcurrentHashMap`，就用[这个吧](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)。

# spring - 带有 Spring Java 配置的 EJB3

> ID：15704698
> 
> 赞同：2
> 
> 时间：2013-03-29T13:54:16.027
> 
> 标签：spring, ejb-3.0, stateless-session-bean

我需要将一个 spring bean 注入一个 EJB 3 无状态会话 bean。spring bean 在 jar 文件中声明并通过 spring @Configuration 类进行初始化。到目前为止，我遇到的所有示例仅建议使用 beanRefContext.xml 文件（以维护单个应用程序上下文）。但是由于我们所有的spring bean都是使用java配置定义的，有没有办法将beanRefContext.xml文件和spring的java配置结合起来呢？简而言之，有没有办法将 AnnotationConfigApplicationContext 用作 beanRefContext 的 bean 工厂？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T16:00:13.367

我遇到了同样的问题。

这是解决方案：

```
<bean class="org.springframework.context.annotation.AnnotationConfigApplicationContext">
  <constructor-arg>
    <list>
      <value type="java.lang.Class">com.company.app.SpringConfiguration</value>
    </list>
  </constructor-arg>
</bean> 
```

您必须使用`<list>`Spring 如何处理构造函数参数中的可变参数。

# graphics - 对齐相机的观察方向以查看特定方向

> ID：15704703
> 
> 赞同：0
> 
> 时间：2013-03-29T13:54:21.990
> 
> 标签：graphics, 3d, computer-vision, perspectivecamera, projective-geometry

我正在使用点云和多个图像。我知道相机的内在和外在参数。我想要的是找到旋转矩阵，它将旋转我的相机（不改变位置）以在某个方向上查看。更具体地说，我会将平面拟合到点云，然后我想将相机的观察方向对齐以垂直于平面查看（不改变其位置）。

因此，给定相机的旋转矩阵，我也会找到图像的单应变换。

请有人帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:55:10.143

设`dir1`为相机的当前方向， 为相机的`dir2`目标方向。计算归一化方向向量：

```
d1 = dir1 / |dir1|
d2 = dir2 / |dir2| 
```

我们想要得到一个从`d1`到旋转的矩阵`d2`。换句话说，这个矩阵应该`theta`在 的方向上绕轴旋转一个角度`u`，其中：

```
u = (d1 x d2) / |d1 x d2|       <-- normalized cross product of d1 and d2
sin(theta) = |d1 x d2|          <-- the length of the cross product
cos(theta) = d1 * d2            <-- dot product of d1 and d2 
```

最后，我们将上面的值代入这个公式（你可以[在这里](http://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle)阅读更多内容），得到请求的矩阵：

![旋转矩阵](../Images/ad5b8b25626fa35537b84233fbdd5bfb.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-04T11:06:48.057

假设`x`是图像的中心然后说`c = [a,b,1]`（这是考虑到图像是 2D 图像）。

现在你有了内在参数矩阵`K`和外在旋转矩阵`R`

我们可以在这种风格中找到方向：

```
temp_X = inverse(K) * c
temp_X = transpose(R) * temp_X
direction = temp_X / norm(temp_X)

final direction = t - direction 
```

我不知道这是否完全正确，但你可以试一试。

# php - 弹出窗口以打开 PHP 页面

> ID：15704704
> 
> 赞同：3
> 
> 时间：2013-03-29T13:54:23.410
> 
> 标签：php, javascript, jquery

我有一个管理用户页面，允许用户删除和更新用户。我想让删除和更新用户页面成为带有关闭窗口选项的弹出窗口。但我不知道怎么做，这是我的管理用户代码

```
<?php
//MY PHP stuff
?>
<!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Strict//EN”
“http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”&gt;
<html xmlns=”http://www.w3.org/1999/xhtml”&gt;
<head>
<meta http-equiv=”Content-Type” content=”text/html; charset=utf-8” />
<title>Manage Users</title>
<link rel="stylesheet" type="text/css" href="../allcss/style.css" />
</head>

<body>

<?php
require('../Login/includes/header.inc.php');
?>

<div id="personalised">
<p>Hello, </p>
</div>
<div id="content">
<table>
  <tr>
    <th scope="col">User email</th>
    <th scope="col">User name</th>
    <th scope="col">User role</th>
    <th>&nbsp;</th>
    <th>&nbsp;</th>
  </tr>
  <?php while($row = $result ->fetch_assoc()) { ?>
  <tr>
    <td><?php echo $row['user_email']; ?></td>
    <td><?php echo $row['user_name']; ?></td>
    <td><?php echo $row['user_role']; ?></td>
    <td><a href="update_users.php?person_id=<?php echo $row['person_id']; ?>">EDIT</a></td>
    <td><a href="delete_users.php?person_id=<?php echo $row['person_id']; ?>">DELETE</a></td>
  </tr>
  <?php } ?>
</table>
</div>

</body>
</html> 
```

这是 update_user.php 页面

```
<?php

require_once 'login.php'; 
$table="users";
$OK = false;
$done = false;
$conn = new mysqli ($host, $user, $password, $database) or die("Connection Failed");

$stmt= $conn->stmt_init();

if (isset($_GET['person_id']) && !$_POST) {
  // prepare SQL query
  $sql = 'SELECT person_id, user_email, user_name, user_role FROM users
          WHERE person_id = ?';
  if ($stmt->prepare($sql))
  {
  $stmt->bind_param('i', $_GET['person_id']);
  $stmt->bind_result($person_id, $user_email, $user_name, $user_role);
  $OK = $stmt->execute();
  $stmt->fetch();
  $_SESSION['uemail_update'] = $user_email; //new
  }
}
if (isset($_POST ['update'])) {
  // prepare update query
  $sql = 'UPDATE users SET user_name = ?, user_role = ?
          WHERE person_id = ?';
  if ($stmt->prepare($sql)) {
    $stmt->bind_param('ssi', $_POST['user_name'], $_POST['user_role'], $_POST['person_id']);
    $done = $stmt->execute();
  }
}
// redirect if $_GET['aperson_id'] not defined
if ($done) {
  header('Location: update_users_confirm.php');
  exit;
}
if (!isset($_GET['person_id'])) {
  header("Location: manage_users.php");
  exit;
}
// store error message if query fails
if (isset($stmt) && !$OK && !$done) {
  $error = $stmt->error;
}
?>
<!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Strict//EN”
“http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd”&gt;
<html xmlns=”http://www.w3.org/1999/xhtml”&gt;
<head>
<meta http-equiv=”Content-Type” content=”text/html; charset=utf-8” />
<title>Project Confirmation</title>
<link rel="stylesheet" type="text/css" href="../allcss/style.css" />
</head>

<body>

<?php
require('../Login/includes/header.inc.php');
?>

<div id="personalised">
<p>Hello, </p>
</div>
<div id="content">
<?php 
if (isset($error)) {
  echo "<p class='warning'>Error: $error</p>";
}
if($person_id == 0) { ?>
  <p class="warning">Invalid request: user does not exist.</p>
<?php } else { ?>
<form id="form1" method="post" action="">
  <p>
    <label for="user_name">User name:</label>
    <input name="user_name" type="text" class="widebox" id="user_name" value="<?php echo htmlentities($user_name, ENT_COMPAT, 'utf-8'); ?>">
  </p>
  <p>
    User role: <select name="user_role" size="1" id="user_role">
    <option value="PT">Part timer</option>
    <option value="FT">Full timer</option>
    <?php echo htmlentities($user_role, ENT_COMPAT, 'utf-8'); ?></select>
  </p>
  <p>
    <input type="submit" name="update" value="Update Entry" id="update">
    <input name="person_id" type="hidden" value="<?php echo $person_id; ?>">
  </p>
</form>
<?php } ?>
</div>

</body>
</html> 
```

有人可以帮我让 update_user.php 页面出现在一个弹出窗口中，该窗口在提交时也应该显示 Confirmation.php 页面。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T14:17:37.270

您可以通过`JavaScript`查看下面给出的解决方案来做到这一点：

**在 head 部分的页面顶部添加此脚本**

```
<script>
function pop_up(url){
window.open(url,'win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=1076,height=768,directories=no,location=no') 
}
</script> 
```

**在您的代码中替换这些行**

```
<td>
    <a href="update_users.php?person_id=<?php echo $row['person_id']; ?>" onclick="pop_up(this);">EDIT</a>
</td>
<td>
    <a href="delete_users.php?person_id=<?php echo $row['person_id']; ?>" onclick="pop_up(this);">DELETE</a>
</td> 
```

希望它会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:02:56.560

使用 java 脚本功能。

```
function popupCenter(pageURL, title, w, h) {
    var left = (screen.width / 2)  - (w / 2);
    var top  = (screen.height / 2) - (h / 2);
    var targetWin = window.open(pageURL, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width='+w+', height='+h+', top='+top+', left='+left);
}

<a href="#" onclick="popupCenter('delete_users.php?person_id=<?php echo $row['person_id']; ?>')">DELETE</a> 
```

# java - Android webservice 客户端：数据如何从 xml 文件中提取数据

> ID：15704707
> 
> 赞同：2
> 
> 时间：2013-03-29T13:54:36.667
> 
> 标签：java, android, eclipse, web-services, webservice-client

我正在创建一个 android webservice 客户端（restful web 服务）。我试图从 web 服务中读取一个简单的值，但是在我的应用程序中，我无法从 web 服务 xml 文件中提取数据值。

**从 web 服务返回的数据如下所示：**

![在此处输入图像描述](../Images/59adbbfdd4fe9ac6488508ff4f535298.png)

**在我的应用程序中，数据如下所示：**

![在此处输入图像描述](../Images/8300c89478b73adc838673fb058b412e.png)

**我只需要读出值而不是整个 xml 文件。有什么想法我该怎么做？**

这是我的代码：

```
 MainActivity.java
package com.hit.resttest;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import java.io.IOException;
import java.io.InputStream;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.protocol.BasicHttpContext;
import org.apache.http.protocol.HttpContext;

import android.os.AsyncTask;

import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class MainActivity extends Activity implements OnClickListener 
{

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        findViewById(R.id.my_button).setOnClickListener(this);
    }

    @Override
    public void onClick(View arg0) 
    {
     Button b = (Button)findViewById(R.id.my_button);
     b.setClickable(false);
     new LongRunningGetIO().execute();
    }

    private class LongRunningGetIO extends AsyncTask <Void, Void, String> 
    {
     protected String getASCIIContentFromEntity(HttpEntity entity) throws IllegalStateException, IOException 
     {
      InputStream in = entity.getContent();
      StringBuffer out = new StringBuffer();
      int n = 1;
      while (n>0) {
       byte[] b = new byte[4096];
       n =  in.read(beer);
       if (n>0) out.append(new String(b, 0, n));
     }
     return out.toString();
    }

     @Override
     protected String doInBackground(Void... params) 
     {
      HttpClient httpClient = new DefaultHttpClient();
      HttpContext localContext = new BasicHttpContext();
      HttpGet httpGet = new HttpGet("http://192.168.1.118:8080/WebService/random");
      String text = null;
      try 
      {
       HttpResponse response = httpClient.execute(httpGet, localContext);
       HttpEntity entity = response.getEntity();
       text = getASCIIContentFromEntity(entity);
      } 

      catch (Exception e) 
      {
       return e.getLocalizedMessage();
      }
      return text;
     }

     protected void onPostExecute(String results) 
     {
      if (results!=null) 
      {
       EditText et = (EditText)findViewById(R.id.my_edit);
       et.setText(results);
      }

       Button b = (Button)findViewById(R.id.my_button);
       b.setClickable(true);
      }
     }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T19:48:21.540

您必须解析 xml 并将值设置为视图。这是示例。

```
//import 
import java.io.StringReader;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.InputSource;

String test = "<Response><Terminal><Name>name</Name><Value>1</Value></Terminal></Response>";
    // parse
    try {

        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
        InputSource s = new InputSource(new StringReader(test)); 
        Document doc = dBuilder.parse(s);

        doc.getDocumentElement().normalize();

        System.out.println("Root element :" + doc.getDocumentElement().getNodeName());

        NodeList nList = doc.getElementsByTagName("Terminal");

        System.out.println("----------------------------");

        for (int temp = 0; temp < nList.getLength(); temp++) {

            Node nNode = nList.item(temp);

            System.out.println("\nCurrent Element :" + nNode.getNodeName());

            if (nNode.getNodeType() == Node.ELEMENT_NODE) {

                Element eElement = (Element) nNode;

                System.out.println("value : " + eElement.getElementsByTagName("Value").item(0).getTextContent());

            }
        }
        } catch (Exception e) {
        e.printStackTrace();
        } 
```

# c# - 如何使用 Control.Invoke() 抛出不会被忽略的异常？

> ID：15704711
> 
> 赞同：2
> 
> 时间：2013-03-29T13:54:50.333
> 
> 标签：c#, multithreading, winforms, exception

**动机**

我`Task`在一个`Windows.Forms`应用程序中使用 a ，我想处理`Task`由 using引发的任何异常，`Task.ContinueWith()`并`Control.Invoke()`在主 UI 线程上重新引发任何异常。

但是，如果我使用，我无法注意到异常`Control.Invoke()`- 但如果我使用`Control.BeginInvoke()`.

有谁知道为什么它不工作`Control.Invoke()`，以及如何让它工作？

**解决方法**

我目前使用`Control.BeginInvoke()`的是 throw 而不是使用`Control.Invoke()`

**重现步骤**

环境：Windows 7 x64，Visual Studio 2012，为 .Net 4 编译（但 .Net 4.5 作为 VS2012 的一部分安装）。

(1) 使用名为`form1`.

(2) 在名为 的表单上放置一个按钮`button1`，并为其添加一个名为 的处理程序`button1_Click()`。

(3) 执行`button1_Click()`如下：

```
private void button1_Click(object sender, EventArgs e)
{
    Task.Factory.StartNew(() =>
    {
        Thread.Sleep(1000);
        this.BeginInvoke(new Action(() =>
        {
            throw new InvalidOperationException("TEST");
        }));
    });
} 
```

(4) 运行程序并单击按钮。一秒钟后，将显示一个异常对话框，如您所料。

(5) 现在`this.BeginInvoke`改为`this.Invoke`。

(6) 再次运行程序并单击按钮。现在异常被默默地忽略了！

两者都在指定的 UI 线程上执行`Invoke()`，所以我不明白为什么在一种情况下会忽略异常，而在另一种情况下不会忽略异常...`BeginInvoke()``Control`

我猜这一定与`Control.Invoke()`如果它抛出异常就永远不会返回的事实有关，但是我的大脑很痛苦，试图弄清楚为什么这意味着异常（显然）被完全忽略了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:13:26.970

This is by design, Invoke() handles exceptions differently than BeginInvoke(). It will marshal the exception back and re-throw it so that you know that the invoked method failed. This cannot work for BeginInvoke() since the thread has moved on already, so it is raised on the UI thread. The next problem is that the Task class swallows exceptions so you never see it.

You are doing this the hard way. If you like the default exception dialog then just use it with raising an exception at all:

```
this.BeginInvoke(new Action(() => {
    using (var dlg = new ThreadExceptionDialog(new InvalidOperationException("TEST"))) {
        dlg.ShowDialog();
        Environment.Exit(1);
    } 
```

# javascript - 我可以使用javascript进行负载平衡吗？

> ID：15704713
> 
> 赞同：-3
> 
> 时间：2013-03-29T13:55:03.200
> 
> 标签：javascript, load-balancing

我有 4 台服务器，每台服务器都有相同的应用程序。我在网络上的负载均衡器是一个简单的循环。问题是如果其中一个应用程序关闭，负载均衡器仍会尝试连接到它，然后向我的用户返回一个 http 错误。

javascript中有没有一种方法可以调用一个服务器，如果出现错误，然后调用下一个服务器？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T13:58:10.090

这里的真正答案必须是修复或更换负载均衡器，因为将调用路由到死服务器的负载均衡器没有......有用...... :-)

但回答你实际提出的问题：

简短的回答可能是“不”，但请继续阅读。

长答案是它可能取决于您所说的“呼叫”是什么意思。如果您的意思是通过 ajax 调用服务器，那么您必须设置服务器以支持[跨域资源共享](http://www.w3.org/TR/access-control/)（并要求您的用户使用[与其兼容的浏览器](http://caniuse.com/#feat=cors)），否则您将被阻止标准操作程序。但是如果你这样做了，基本上就是如果你在响应对负载平衡地址的 ajax 调用时遇到错误，你会使用特定的服务器地址再次尝试。

您可以执行相同的操作来加载图像（`error`通过使用特定地址再次尝试响应事件）。

但是，如果您的用户只是关注指向您的负载平衡地址的链接或其他任何东西，这将无济于事，这使我们回到：这确实需要在负载平衡器级别进行修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:00:07.487

根据负载均衡器，它应该能够在其他主机不可用时故障转移到其他主机。通常，您会设置一个状态页面（如果基于 Web）或一个端口来监控，如果它不可用，负载均衡器将自动从池中删除主机并将所有会话转移到其他主机（同样，这是假设一个基于网络的应用程序）。

尝试这一点的下一层将在服务器级别。如果这是一个基于 Web 的应用程序，大多数 Web 服务器都带有一些心跳功能，您可以使用这些功能来故障转移到其他 Web 服务器。

如果其他选项不可用，则在客户端执行此操作（除非您谈论服务器编译的 JS）将是您的最后选择。但是，在进一步提供帮助之前，我们需要有关您的应用程序的更多信息。

# android - 获取 JSON 响应 Android

> ID：15704715
> 
> 赞同：1
> 
> 时间：2013-03-29T13:55:09.303
> 
> 标签：android, json

```
HttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(URL);

try {
    StringEntity documentStringified = new StringEntity(Obj.toString());
    httpPost.setEntity(documentStringified);
} catch (UnsupportedEncodingException e) {
    Log.d("UnsupportedEncodingException", e.toString());
}

try {
    HttpResponse response = httpClient.execute(httpPost);
    Log.d("Response", response.toString());
} catch (IOException e) {
    Log.d("IOException", e.toString());
} 
```

我无法获得`response`. 如何打印响应`Logger or console.` `response.toString()`或`response.getEntity.toString()`不起作用。

我应该将内容类型设置为`"application/json"`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:57:56.543

一般的做法是：

```
String result = EntityUtils.toString(response.getEntity()); 
```

此外，您可以检查响应代码。有时，请求会失败。

```
int status = response.getStatusLine().getStatusCode();
if (status == 200) {
    String result = EntityUtils.toString(response.getEntity());    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T13:57:24.273

从响应中取出`InputStream`，然后使用 a`Scanner`来使用它的内容。

```
String responseContent = new Scanner(inputStream).useDelimiter("\\A").next(); 
```

`useDelimiter("\\A")`表示“分隔符是流的结尾”，因此`next()`会消耗所有内容。

# html - 角度路由发生了一些奇怪的事情

> ID：15704720
> 
> 赞同：7
> 
> 时间：2013-03-29T13:55:31.373
> 
> 标签：html, angularjs

我仍在学习 angularjs，所以也许有些愚蠢的东西我不理解，但是在使用路由时我有一个非常奇怪的行为。

在我的应用程序中，我使用以下代码来定义我的路线：

```
var app = angular.module('app', []);
app.config(['$routeProvider', '$locationProvider', function ($routeProvider, $locationProvider) {
  $routeProvider.
    when('/pneumatici/:chunka', {}).
    when('/pneumatici/:chunka/:chunkb', {});

  $locationProvider.html5Mode(true);
}]); 
```

在控制器中，我以这种方式管理它们：

```
app.controller('appCtrl', ['$scope', '$route', '$routeParams', '$location', function ($scope, $route, $routeParams, $location) {
  $scope.$on('$routeChangeSuccess', function (current,previous) {
    if (!($location.path().indexOf('/pneumatici') === -1)) {
      $scope.chunka = $route.current.params.chunka; $scope.chunkb = $route.current.params.chunkb;

      /** do my stuff with chunka and chunkb **/

    } else {
      window.location.href = $location.path();
    }
  }); 
```

我没有 ngView，没有模板，什么都没有。它就像一个魅力。

请注意我实际强制页面加载的行，以防 url 不打算由控制器 appCtrl 管理。我被迫这样做，因为一旦我定义了捕获“$ routeChangeSuccess”的路线，点击时页面中的所有链接都会被角度捕获，即使链接没有使用“when”定义的格式，也不会发生页面加载。我想用“否则”来做，但如果可行的话，我不明白怎么做。

**现在的问题。** 在页面中，我当然有像“/privacy.html”这样的链接，如果我点击它们，页面加载就会正确触发，我确实看到了“/privacy.html”，但不幸的是，**如果我点击后退按钮**，我可以看到浏览器的 url 更改为（比方说）/pneumatici/foo/bar 但没有触发页面加载。

请注意，在 privacy.html 页面中，我没有定义角度路由，没有 .config 没有 .when；定义了一个带有控制器的anagular应用程序，但没有在任何地方注入“$ routeProvider”，也没有定义任何路由。

怎么了？我做错了什么？

谢谢你的帮助！

**更新。** 我找到了一个可行的解决方案添加：

```
angular.element("a").prop("target", "_self"); 
```

对于“target”设置为“_self”的所有“a”元素，角度路由都被忽略，不知道。

尽管如此，如果我从整体上看这个策略对我来说听起来不是很优雅，我很想改进它。我不喜欢的是，因为我在 .config 中定义了路线，所以我应该能够告诉 angular 跳过与我在那里定义的格式/路径不匹配的任何 url。

但是我不知道这是否可行，**有人知道吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-09T14:19:32.527

通过打开 html5mode，您的应用应该会默认拦截网站上的所有内容（来自“/”。）

从这个角度来看，似乎 $location.path() 应该在您的显式覆盖中工作，但它并不真正正确（`$location.url()`将是）并且浏览器已经具有正确的 URL，所以也许您不能强制重新加载[location.href = location.href](https://stackoverflow.com/questions/9414889/location-href-location-href-wont-redirect#9414917)在您的特定浏览器中。

与其走这条路，我会做以下事情来让它干燥：

如果添加基本 href：

```
<base href="/pneumatici/"></base> 
```

并在您的条款中替换`/pneumatici/`为：`/``when`

```
$routeProvider.
    when('/:chunka', {}).
    when('/:chunka/:chunkb', {}); 
```

那么你应该只需要这个：

```
$scope.$on('$routeChangeSuccess', function (current,previous) {

    $scope.chunka = $route.current.params.chunka;
    $scope.chunkb = $route.current.params.chunkb;

  /** do my stuff with chunka and chunkb **/
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T05:28:09.443

我认为你应该让 Angular 像这样管理你的所有路由：

```
var app = angular.module('app', []).config(function($routeProvider, $locationProvider) {
$locationProvider.html5Mode(true).hashPrefix('!');

$routeProvider
    .when('/',
    {
        controller: 'HomeController',
        templateUrl: '/partials/home.html'
    })
    .when('/about',
    {
        controller: 'AboutController',
        templateUrl: '/partials/about.html'
    })
    .when('/privacy',
    {
        controller: 'PrivacyController',
        templateUrl: '/partials/privacy.html'
    })
    .when('/404',
    {
        controller: 'NotFoundController',
        templateUrl: '/partials/404.html',
    })
    .otherwise({
        redirectTo: '/404'
    });
}); 
```

请注意上述其他情况。这告诉 Angular 在无法识别路线时加载 404 页面。

# java - 在网格上绘制形状

> ID：15704724
> 
> 赞同：0
> 
> 时间：2013-03-29T13:55:45.610
> 
> 标签：java, java-2d

我需要在网格上绘制随机形状，例如线条正方形等。这部分我可以做到。我的问题是我正在绘制的线条的起点和终点落在网格单元格中的任何位置。我希望他们只在交叉点。网格中的一个单元格是 10x10 像素网格。我是否必须编写算法将像素分配给网格上最近的交点，或者有更简单的方法。我正在使用缓冲图像来绘制网格。请帮忙。这就是我到目前为止所拥有的

```
for (int i = 0; i < 61; i++) {
                g2d.drawLine((imgDim.width + 2) / 40 * i, 0,
                        (imgDim.width + 2) / 40 * i, imgDim.height - 1);
                g2d.drawLine(0, (imgDim.height + 2) / 60 * i,
                        imgDim.width - 1, (imgDim.height + 2) / 60 * i);
            } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T22:02:45.037

严重地？为了使随机点（pixelX，pixelY）捕捉到网格的最近点。

```
int gridSize = 10;
int x = (pixelX + gridSize / 2) / gridSize * gridSize;
int y = (pixelY + gridSize / 2) / gridSize * gridSize; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T15:22:18.640

你是怎么想出随机点的？在那里进行调整可能是最简单的方法。也就是说，只需在您用来计算分数的过程中删除 0 即可。然后当你准备好画它时，加一个 0 回来。

# jquery - 带有谷歌地图页面结构的 ASP.NET MVC4 和 jQuery Mobile

> ID：15704725
> 
> 赞同：0
> 
> 时间：2013-03-29T13:55:49.360
> 
> 标签：jquery, google-maps, jquery-mobile, asp.net-mvc-4

我正在开发一个网站，该网站应该在桌面和移动浏览器上都能很好地显示和响应。因此，我使用 MVC 4 的优秀特性在使用 .mobile.cshtml 扩展名的视图之间切换。由于我熟悉 jQuery，我想将 jQuery Mobile 用于移动视图。

因此，我创建了一个带有标准 html、标题和正文元素的 _Layout.Mobile.cshtml 视图。body 元素包含以下内容：

```
<body>
    <div data-role="page" id="@ViewBag.PageId">
        <div data-role="header" data-position="fixed">
            <h1>@ViewBag.Title</h1>
            @Html.ActionLink("Indstillinger", "Manage", "Account", null, new { @class= "ui-btn-right", data_icon = "gear"})
            <div data-role="navbar">
                @RenderSection("PageNavigation", required: false)
            </div>
        </div>  
        <div data-role="content" class="map-content">   
            @RenderBody()       
        </div>
    </div><!-- /page -->
</body> 
```

PageNavigation 部分用于放置一个 jQuery Mobile 持久导航栏，其中包含指向两个不同视图的两个项目。

第一个视图如下所示：

```
@model MyModel
@{
    ViewBag.Title = "Some title";
    ViewBag.PageId = "pageuniquename";
  Layout = "~/Views/Shared/_Layout.Mobile.cshtml";
}
@section PageNavigation
{
<ul>    
    <li>@Html.ActionLink("List display", "Index", "Controller",new { @class= "ui-btn-active ui-state-persist"})</li>
    <li>@Html.ActionLink("Map display", "Map", "Controller")</li>
</ul>
}
@Html.Partial("~/Views/Shared/Mobile/_TestPartial.cshtml", Model) 
```

第二个视图如下所示：

```
@model MyModel
@{
    ViewBag.Title = "Map display";
    ViewBag.PageId = "mappage";
    Layout = "~/Views/Shared/_Layout.Mobile.cshtml";
}
@section PageNavigation
{
<ul>    
    <li>@Html.ActionLink("List display", "Index", "Controller")</li>
    <li>@Html.ActionLink("Map display", "Map", "Controller",new { @class= "ui-btn-active ui-state-persist"})</li>
</ul>
}
<div id="mapCanvas"></div> 
```

谷歌地图是由布局页面中的这段代码初始化的：

```
$(document).on("pageshow", "#mappage", initializeMap); 
```

地图初始化很好，我可以添加标记。我可以通过导航栏在页面之间切换 - 尽管有时由于某种原因似乎无法调整地图大小。

但地图根本不响应任何事件——甚至无法缩放或平移。

如您所见，我尝试通过在 ViewBag 中设置 PageId 属性并在布局页面中呈现该 ID 来为页面提供唯一 ID。而且我可以看到每个页面的标记都正确加载——至少看起来是这样。

我还没有弄清楚，是每个视图都应该连接到布局还是只应该是第一个视图。使用 MVC 4 开发 jQuery 移动网站的正确方法是什么？

**编辑** 在 iPad 上访问该站点时，这些事件似乎可以正常触发 - 但是当我通过带有 iPad 用户代理的桌面浏览器 (Chrome) 访问该站点时 - 没有触发任何事件。我仍然希望您对如何在 MVC4 中为 jQuery Mobile 构建页面提出意见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T19:10:41.033

嗯，这很尴尬......原来Chrome开发者工具有一个“模拟触摸事件”选项，默认情况下是禁用的。打开它会使谷歌地图按预期响应。

# jquery - css jquery 将元素固定在右侧。Firefox中的动画BUG

> ID：15704727
> 
> 赞同：5
> 
> 时间：2013-03-29T13:56:04.090
> 
> 标签：jquery, css, firefox

我为我的问题创建了一个小提琴：

[小提琴](http://jsfiddle.net/88SZZ/)

```
$('#move').click(function (e) {
    e.preventDefault();

    $(this).not('.up').animate({
        bottom: '50%'
    }, 1000, function () {
        $(this).addClass('up');
    });

    $('.up').animate({
        bottom: '0%'
    }, 1000, function () {
        $(this).removeClass('up');
    });
}); 
```

Firefox 中有一个错误（我的版本：19.0.2）。

当您单击红色按钮时，它会跳到右侧（距离正好是滚动条的宽度）。当它在右侧并且您调整窗口（或小提琴框架）的大小时，它会跳回来。

我做错什么了吗？有没有好的解决方案来解决它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-29T14:42:24.403

好吧，如果您更改宽度属性，那么即使在 Firefox 上也可以正常工作

试试这个

改变

```
width:100px 
```

到

```
min-width:100px; 
```

希望能帮助到你。

# vb.net - 文本框数据绑定到 2 个属性

> ID：15704728
> 
> 赞同：1
> 
> 时间：2013-03-29T13:56:06.530
> 
> 标签：vb.net

我有一个保存到订单数据表的表单。表单中的一些字段链接到包含客户姓名和地址详细信息的表。我的订单数据表中的托运人姓名字段是一个组合框 - 您选择名称，该名称的相应地址信息将显示在属于我的订单数据表的地址、城市和电话号码字段的文本框中。为此，我为该字段使用组合框控件的数据绑定属性，并为文本框使用 Text 属性（绑定到源表，我称之为shipperdata。）当我运行表单时，它会显示我想要的信息.

问题：当我保存表格时，托运人的名字保存得很好。但是，与托运人名称相关的其他字段则不是。我意识到绑定属性不允许我将文本框的内容绑定到我的订单数据表。

我进入设计器并想尝试一个实验，认为如果组合框可以绑定到源并将文本绑定到订单数据表，我应该能够使用文本框来做到这一点。正确的？显然没有那么多。这是我尝试过的：

```
'Shipper1address1TextBox
        '
        Me.Shipper1address1TextBox.DataBindings.Add(New System.Windows.Forms.Binding("Text", Me.ShippersBindingSource, "SHIPPERADDRESS1", True))
        Me.Shipper1address1TextBox.DataBindings.Add(New System.Windows.Forms.Binding("Text", Me.OrdersBindingSource, "shipper1address1", True))
        Me.Shipper1address1TextBox.Location = New System.Drawing.Point(188, 429)
        Me.Shipper1address1TextBox.Name = "Shipper1address1TextBox"
        Me.Shipper1address1TextBox.Size = New System.Drawing.Size(200, 20)
        Me.Shipper1address1TextBox.TabIndex = 32 
```

我收到一条错误消息，提示我无法绑定 2 个属性。

有趣的部分：表单实际上是“详细信息”，所以我决定将 datagridview 拖到我已经设置的旁边，看看它的外观。在详细视图中，您会认为数据已正确保存到订单数据表中。但是，当我在 gridview 中查看表格时，地址和电话等的值并没有写在那里。然后我提醒自己，它只绑定到托运人数据表。

我的问题：如何将相应的地址和电话信息保存到订单表中，同时仍绑定到源以便显示？如果我为订单数据表设置绑定属性，那就太好了……除了现在它不显示地址信息。有没有办法用文本框来完成这个？在这一点上，我也猜测与设计师搞混可能不是一个好主意。也许是另一种选择？数据表中文本框中包含的值未保存似乎很奇怪。

谢谢你看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-15T19:37:19.223

每个文本框只能添加一个数据绑定。您在代码中添加了两个.......

Me.Shipper1address1TextBox.DataBindings.Add

阿龙。

# ruby-on-rails - cancan 没有评估实例级别的能力检查

> ID：15704730
> 
> 赞同：3
> 
> 时间：2013-03-29T13:56:13.920
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我正在尝试将 cancan 整合到我的第一个 Ruby on Rails 应用程序中。

我在开始时遇到问题......这肯定是一些基本的东西。

我的应用程序有一个项目列表，用户可能有权查看其中的任意数量，也可能没有权限。

我将此添加到我的 ProjectsController 中：

```
class ProjectsController < ApplicationController
  load_and_authorize_resource 
```

我的初始化方法如下所示：

```
 def initialize(user)
    user ||= User.new # guest user
    puts "********  Evaluating cancan permissions for: " + user.inspect
    can :read, Project do |project|
      puts "********  Evaluating project permissions for: " + project.inspect
      # project.try(project_users).any?{|project_user| project_user.user == user} 
      1 == 1  #POC test!
    end
  end 
```

当我有这个时，会出现项目索引页面，但没有列出任何项目。

我在这里有2个问题：

1.  由于所有项目都返回 true，因此不应该出现所有项目吗？
2.  第二个 puts 语句没有写入 rails 服务器控制台，但第一个是。这是为什么？？？

如果我将初始化方法更改为：

```
 def initialize(user)
    user ||= User.new # guest user
    puts "********  Evaluating cancan permissions for: " + user.inspect
    can :read, Project
  end 
```

...我看到了所有的项目，正如我所期望的那样

如果我删除 can :read, Project 行，我会得到一个试图访问项目索引页面的安全异常......也是我所期望的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:05:16.273

仅当项目实例可用时才评估传递给 :read 能力的块 ( `@project`)。因为您正在谈论索引操作，所以只有集合可用（`@projects`）。这解释了为什么您的第二个 puts 语句从未出现。为了限制您的索引操作，您需要将条件哈希传递到`can`方法中，或者使用范围（除了块之外）。所有这些信息都在 Github 上的 CanCan wiki 中明确列出。

所以`puts`问题是可以解释的。没有意义的是没有项目展示。在评估索引操作时，CanCan 实际上会默认完全忽略该块。这意味着`can :read, Project`无论如何（即使在第一个示例中）您的能力对于索引操作都是必不可少的。

我有兴趣让您尝试添加一个简单的范围，看看它是否会起作用。尝试：

```
can :read, Project, Project.scoped do |project|
  true
end 
```

然后看看索引操作会发生什么。

编辑：

鉴于您现在可以在索引中看到项目，您似乎需要将范围传递给能力和块。请阅读[这个 Github 问题](https://github.com/ryanb/cancan/issues/275)，其中 Ryan 解释了为什么没有在索引操作上评估块。

> 块仅用于根据对象的属性定义能力。[...]这是唯一应该使用块的情况，因为该块仅在对象可用时才执行。所有其他条件都应在块外定义。

请记住，如果您的能力对于条件哈希来说不是太复杂，那么您应该使用它。条件哈希[在 Github 上的 CanCan wiki 页面上进行了解释。](https://github.com/ryanb/cancan/wiki/Defining-Abilities)如果确实需要范围，则需要传入范围**和块**。假设您具有上述能力。

1.  On the index action, CanCan will disregard the block because a Project object (`@project`) is not available. It will instead return projects that are within the scope given, in this case `Project.scoped` (which will just be all projects).
2.  On the show action, `@project` is available, so CanCan will evaluate the block and allow the action if the block evaluates to true.

So the reason you need to pass both is so that CanCan can handle both the index and show actions. In most cases, your block will define the same thing as the scope does, only the block will be written in Ruby while your scope will be written Rails' ActiveRecord syntax. You can fine more information about here: [Defining Abilities with Blocks](https://github.com/ryanb/cancan/wiki/Defining-Abilities-with-Blocks).

# c++ - JNI - jByteArray 到 cli::array

> ID：15704736
> 
> 赞同：0
> 
> 时间：2013-03-29T13:56:39.740
> 
> 标签：c++, java-native-interface

我第一次使用 JNI，并试图通过 C++ JNI 程序集将字节数组从 Java 小程序传递到 C# DLL。

JNI 签名...

```
JNIEXPORT void JNICALL Java_MyApplet_invokeManager(JNIEnv *jniEnvPtr, jobject javaObj, jbyteArray encodedData) 
```

对 C# DLL 的调用...

```
myManager->ShowQueue(encodedData); 
```

错误信息...

```
error C2664: 'MyModule::JNIToManaged::ShowQueue' : cannot convert parameter 2 from 'jbyteArray' to 'cli::array<Type,dimension> ^'   C:\Development\CrystalClient\CrystalPrintJNI\CrystalPrintJNI\CrystalPrintJNI.cpp 
```

我是否需要遍历 jByteArray 并将字节存储到一个新数组中？有人可以提供一些指导吗？谢谢！

# android - Android 将彩信标记为失败

> ID：15704738
> 
> 赞同：1
> 
> 时间：2013-03-29T13:56:51.057
> 
> 标签：android, android-contentprovider, mms

我想在我的数据库中将我的一些 MMS 标记为失败。我已将该`msg_box`字段更改为`5`（这是正确的值）。但是在本机消息应用程序中，它们没有被标记为失败。就好像消息已正确发送一样。

要更改上述字段，我使用了以下代码：

```
ContentValues mmsValues = new ContentValues();
mmsValues.put("msg_box", table);
Uri uUri = Uri.parse("content://mms/");
context.getContentResolver().update(uUri, values, "id=" + msgId, null); 
```

我想更改表中的状态`content://mms-sms/conversations`，更改`err_type`为`10`. 但我不能，因为我们不允许在该表中插入/更新/删除。

有没有办法做到这一点 ？

# java - 什么时候必须关闭数据库？

> ID：15704740
> 
> 赞同：2
> 
> 时间：2013-03-29T13:56:57.120
> 
> 标签：java, android, performance, sqlite, memory-management

我在这里看到了很多关于它的帖子，但我只是无法让我的应用程序停止向我发送关于我没有关闭数据库的错误。我的数据库有时是由活动访问，有时是来自后台类（服务）。

我添加到活动的 using DB

```
protected void onDestroy() {
    Log.d("OnDestroy", "called");
    sqlAdapter helper = new sqlAdapter(StartScreen.this);
    helper.close();
    super.onDestroy();
} 
```

正如许多帖子中所建议的那样，但它不会解决问题。

有什么想法或解释可以帮助我理解吗？该应用程序没有崩溃或其他任何事情，但有很多关于我没有关闭数据库的错误

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:09:48.793

每次完成后都应该关闭它。如果您创建一个`cursor`来访问它，那么在您获取数据并保存它或完成对它的处理之后，您应该关闭`cursor`. 然后在下次需要时再次打开它。[这个答案](https://stackoverflow.com/questions/10677781/how-to-open-close-sqlite-db-in-android-properly)应该可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:36:09.763

在您的示例中，您似乎正在创建一个新对象`onDestroy`而不是关闭旧对象。所以每次你做

```
sqlAdapter helper = new sqlAdapter(StartScreen.this); 
```

您正在创建一个新对象，并且您将拥有大量未关闭的引用，这就是导致警告的原因。

相反，看起来您可能正在寻找一种单例设计模式，它允许您在应用程序中维护一个对象，然后在`onDestroy`.

```
public void onDestroy() {
    super.onDestroy();
    // close database
    final MySqlHelper helper = MySqlHelper.getInstance();
    helper.getDatabase().close();
} 
```

否则，它会一直保持打开状态，直到`onDestroy`就像您现在尝试做的那样。这当然应该在适当的情况下使用，并且您正在您的应用程序中积极使用它。如果您很少使用数据库，每次使用后关闭它就可以了。

这个想法是，如果您执行适量的数据库*打开*/*关闭调用，并且在该用例中效率更高，那么您将减少它们。*

这是一个非常非常精简的单例示例。

```
public class MySqlHelper extends SQLiteOpenHelper {
    static MySqlHelper mInstance = null;
    static SQLiteDatabase mDatabase = null;

    public static MySqlHelper getInstance() {
        if (mInstance == null) {
            // call private constructor
            mInstance = new MySqlHelper();
        }
        mDatabase = mInstance.getWritableDatabase();
        while(mDatabase.isDbLockedByCurrentThread() || mDatabase.isDbLockedByOtherThreads()) {
            // loop until available
        }
        return mInstance;
    }

    private MySqlHelper() {
        // mContext here is just a placeholder for your ApplicationContext
        // that you should have available to this class.
        super(mContext, DATABASE_NAME, null, DATABASE_VERSION);
    }

    // all other filled out methods like onCreate, onUpgrade, etc
} 
```

现在您可以使用它来实现您的数据源

```
public class MyDataSource {
    // Database fields
    private final SQLiteDatabase mDatabase;
    private final MySqlHelper mHelper;

    public MyDataSource() {
        mHelper = MySqlHelper.getInstance();
        mDatabase = mHelper.getDatabase();
    }

    // add your custom methods 

    private int update(ContentValues values, String whereClause) {
        int rowsUpdated = 0;
        synchronized (mDatabase) {
            rowsUpdated = mDatabase.update(MySqlHelper.TABLE_NAME, values, whereClause, null);
        }
        return rowsUpdated;
    }

    public int updateById(ContentValues values, int id) {
        final String whereClause = MySqlHelper.COLUMN_ID + "=" + id;
        return this.update(values, whereClause);
    }
} 
```

# visual-studio-2010 - 在鼠标悬停时显示类型成员的 VSIX 的名称是什么？

> ID：15704743
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:11.967
> 
> 标签：visual-studio-2010, visual-studio-extensions

曾经在 Visual Studio 2010 下拥有该扩展，但我再也找不到它了。

该扩展提供以下帮助程序：

*   当将鼠标悬停在代码编辑器中的类型上时，会弹出一个小窗口并显示类型内的成员，省去了打开文件以查看该类型包含哪些成员的麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T04:40:08.693

您可能正在谈论[Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/)的解决方案导航器功能。

> 解决方案导航器还提供 C# 和 VB 代码中的交互式工具提示（替换默认的“快速信息”工具提示），为您提供相同类型的数据，但触手可及。

# ios - 如何捕获状态 - 比 BOOL 更灵活，但比 NSString 更独特

> ID：15704746
> 
> 赞同：0
> 
> 时间：2013-03-29T13:57:19.657
> 
> 标签：ios, objective-c

我正在调用一种方法来设置状态，在本例中**为 animateState**。状态参数可以是定义的集合之一：例如“hide”、“show”、“active”、“inactive”。所以它不仅仅是 BOOL，但比开放的 NSString 更独特。

目前我正在通过使用 NSString 来解决这个问题，并使用它的**isEqual**方法检查状态。它有效，但并不理想。

```
-(void) animateState:(NSString*)state{
    if ([state isEqual:@"hide"]){
...
    } else if ([state isEqual:@"show"]){
...
    } else if ([state isEqual:@"active"]){
...
    } else if ([state isEqual:@"inactive"]){
...
    }
} 
```

如何限制参数并最终使 if/switch 检查更有效？这种情况有什么最佳实践吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T14:02:29.530

将`enum`在这里做得很好，`enum`在头文件中定义某处：

```
typedef enum{
    AnimateStateHide,
    AnimateStateShow,
    AnimateStateActive,
    AnimateStateInactive
} AnimateState; 
```

然后你可以像这样调用你的方法：

```
-(void) animateState:(AnimateState)state{
    switch(state) {

        case AnimateStateHide:
            //Code here;
            break;

        case AnimateStateShow:
            //Code here;
            break;

        case AnimateStateActive:
            //Code here;
            break;

        case AnimateStateInactive:
            //Code here;
            break;
    }
} 
```

# ruby - 将对象作为主体传递给 rspec

> ID：15704747
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:19.890
> 
> 标签：ruby, rspec

我正在`catalog`从 Ruby 应用程序中对对象运行 rspec 测试，使用`Rspec::Core::Runner::run`：

```
File.open('/tmp/catalog', 'w') do |out|
  YAML.dump(catalog, out)
end

...

unless RSpec::Core::Runner::run(spec_dirs, $stderr, out) == 0
  raise Puppet::Error, "Unit tests failed:\n#{out.string}"
end 
```

（完整代码可以在[https://github.com/camptocamp/puppet-spec/blob/master/lib/puppet/indirector/catalog/rest_spec.rb](https://github.com/camptocamp/puppet-spec/blob/master/lib/puppet/indirector/catalog/rest_spec.rb)找到）

为了传递我想要测试的对象，我将它作为 YAML 转储到一个文件（当前`/tmp/catalog`）并在我的测试中将它作为主题加载：

```
describe 'notrun' do
  subject { YAML.load_file('/tmp/catalog') }
  it { should contain_package('ppet') }
end 
```

有没有一种方法可以将`catalog`对象作为测试对象传递而不将其转储到文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T12:43:13.637

我不太清楚您到底要达到什么目标，但根据我的理解，我觉得使用 before(:each) 钩子可能对您有用。您可以在此块中定义可用于该范围内所有故事的变量。

这是一个例子：

```
require "rspec/expectations"

class Thing
  def widgets
    @widgets ||= []
  end
end

describe Thing do
  before(:each) do
    @thing = Thing.new
  end

  describe "initialized in before(:each)" do
    it "has 0 widgets" do
      # @thing is available here
      @thing.should have(0).widgets
    end

    it "can get accept new widgets" do
      @thing.widgets << Object.new
    end

    it "does not share state across examples" do
      @thing.should have(0).widgets
    end
  end
end 
```

您可以在以下位置找到更多详细信息： [https ://www.relishapp.com/rspec/rspec-core/v/2-2/docs/hooks/before-and-after-hooks#define-before(:each)-block](https://www.relishapp.com/rspec/rspec-core/v/2-2/docs/hooks/before-and-after-hooks#define-before(:each)-block)

# spring-security - 更改 Spring security 3.1 自定义登录标准名称

> ID：15704751
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:31.660
> 
> 标签：spring-security

我正在使用带有 Hibernate 的 spring security 3.1 并使用自定义 UserdetailsS​​ervice 类和自定义登录页面进行身份验证。

问题是我怎样才能摆脱在登录表单中使用标准的弹簧安全命名约定，

`j_spring_security_check`,
`j_spring_security_logout`,
`j_username`– 用户名,
`j_password`– 密码

并使用替代品。

Spring 安全文档说，透露这些细节不是一个好习惯。但我找不到任何关于如何为此目的使用自定义 url 的示例。

如果有人可以提供示例实现，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T15:35:42.767

它们在`<form-login>`和`<logout>`属性中配置：

```
<form-login username-parameter="" password-parameter="" login-processing-url="" />
<logout logout-url="" /> 
```

请参阅文档：[http](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-http-children) ://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-http-children 。

# java - 传递命令行 java 程序参数

> ID：15704753
> 
> 赞同：-1
> 
> 时间：2013-03-29T13:57:37.727
> 
> 标签：java, command-line-arguments

我正在编写一个必须通过命令行运行的 java 服务器。我想向服务器传递不同的端口号来监听。但是，我不确定在运行服务器时如何将端口号作为命令行参数传递给 ServerSocket 类。

```
public class Server {

    public static void main(String[] args) {
        Server server = new Server();
    }

    public Server() {
        ServerSocket socket = new ServerSocket(5000);
        // I want to specify the port number above as an argument when running the server. 
    }

} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T13:59:59.787

你可以把它传入：

```
public class Server {

    private static final int DEFAULT_PORT = 5000;

    public static void main(String[] args) {
        int port = args.length > 0? Integer.parseInt(args[0]): DEFAULT_PORT;
        Server server = new Server(port);
    }

    public Server(int port) {
       ServerSocket socket = new ServerSocket(port);
       ...
    } 
```

您可以使用[条件运算符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.25)来确定在没有传入值的情况下是否应使用默认端口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T14:01:29.503

使用系统属性的另一种解决方案：

```
ServerSocket socket = new ServerSocket(Integer.getInteger("server.socket.port")); 
```

使用以下命令行：

```
java -Dserver.socket.port=5000 Server 
```

主要优点是`Integer.getInteger("server.socket.port")`可以在项目的其他任何地方访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T14:00:41.303

像这样：

```
...
public static void main( String[] args ) {
    Server server = new Server( Integer.parseInt( args[0] ) );
}

public Server( int portNumber ) {
    ServerSocket socket = new ServerSocket( portNumber );
}
... 
```

# arrays - 分配二维数组时出现Android NullPointerException错误

> ID：15704754
> 
> 赞同：0
> 
> 时间：2013-03-29T13:57:39.987
> 
> 标签：arrays, json, nullpointerexception

我有来自我的网站的 Json 响应，我解析了该响应。我可以毫无问题地写入屏幕解析数据，但是当我想分配二维数组时出现 NullPoniterException 错误。

我像这样定义了数组和jsonarray和jsonobject ...

```
final String[][] sonuclarDizi = null;
    String kayitSayisi = jObj.getString("kayitSayisi");
 int kayitsay = Integer.parseInt(kayitSayisi.toString());
 JSONArray menuitemArray = jObj.getJSONArray("sonuclar");

for (int i = 0; i < kayitsay; i++) {
                                System.out.println(i+". sonucun sube id si "+menuitemArray.getJSONObject(i).getString("sube_id"));
                                System.out.println(i+". sonucun ders_id si "+menuitemArray.getJSONObject(i).getString("ders_id"));
                                System.out.println(i+". sonucun kodu si "+menuitemArray.getJSONObject(i).getString("kodu"));
                                System.out.println(i+". sonucun adi si "+menuitemArray.getJSONObject(i).getString("adi"));
                                System.out.println(i+". sonucun ortalama_yazi si "+menuitemArray.getJSONObject(i).getString("ortalama_yazi"));
                                System.out.println(i+". sonucun sube id si "+menuitemArray.getJSONObject(i).getString("kredi"));
                                System.out.println(i+". sonucun devamDurumu si "+menuitemArray.getJSONObject(i).getString("devamDurumu"));
                                System.out.println(i+". sonucun sube id si "+menuitemArray.getJSONObject(i).getString("ortalama"));
                                System.out.println(i+". sonucun sonuc si "+menuitemArray.getJSONObject(i).getString("sonuc"));
                                System.out.println(i+". sonucun sube id si "+menuitemArray.getJSONObject(i).getString("basarili"));
                                System.out.println(i+". sonucun harf si "+menuitemArray.getJSONObject(i).getString("harf"));
                            } 
```

这部分正在工作。但下面部分返回 NullPointerException 错误。

```
for (int i = 0; i < kayitsay; i++) {
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("sube_id"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("ders_id"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("kodu"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("adi"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("ortalama_yazi"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("kredi"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("devamDurumu"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("ortalama"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("sonuc"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("basarili"));
                                sonuclarDizi[i][1]=(menuitemArray.getJSONObject(i).getString("harf"));
                            } 
```

非常感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:02:40.983

`sonuclarDizi`是一个空数组。您声明了它，但您需要先实例化它，然后才能向它添加项目。

```
String[][] sonuclarDizi;

sonuclarDizi = new String[kayitsay][];

for (int i = 0; i < kayitsay; i++) {
  sonuclarDizi[i] = new String[11];
  /* ... */
} 
```

# json - 如何在 Play Framework 2.x 中实现嵌入式对象的隐式 Json 写入

> ID：15704756
> 
> 赞同：24
> 
> 时间：2013-03-29T13:57:40.883
> 
> 标签：json, scala, playframework, playframework-2.0

有两个类`Foo`和`Bar`。`Foo`包含一个字段`Bar`。问题是，如何`Writes`为 class实现隐式 json `Foo`？

这是代码：

```
package models

import play.api.libs.json._

case class Foo(id: String, bar: Bar)

object Foo {
  implicit val implicitFooWrites = new Writes[Foo] {
    def writes(foo: Foo): JsValue = {
      Json.obj(
        "id" -> foo.id,
        "bar" -> foo.bar
      )
    }
  }
}

case class Bar(x: String, y: Int)

object Bar {
  implicit val implicitBarWrites = new Writes[Bar] {
    def writes(bar: Bar): JsValue = {
      Json.obj(
        "x" -> bar.x,
        "y" -> bar.y
      )
    }
  }
} 
```

当我尝试编译时，出现以下错误：

> 没有为类型 models.Bar 找到 Json 反序列化器。尝试为此类型实现隐式写入或格式。

我不明白这个编译器错误，因为我为 models.Bar 类实现了隐式写入。这里有什么问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-29T14:45:32.560

这是一个可见性问题，在声明隐式 Writes[Foo] 时，您不会使其隐式 Writes[Bar] 可见：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

import play.api.libs.json._

case class Bar(x: String, y: Int)

object Bar {
  implicit val implicitBarWrites = new Writes[Bar] {
    def writes(bar: Bar): JsValue = {
      Json.obj(
        "x" -> bar.x,
        "y" -> bar.y
      )
    }
  }
}

case class Foo(id: String, bar: Bar)

object Foo {

  import Bar._

  implicit val implicitFooWrites = new Writes[Foo] {
    def writes(foo: Foo): JsValue = {
      Json.obj(
        "id" -> foo.id,
        "bar" -> foo.bar
      ) 
    } 
  }     
}

// Exiting paste mode, now interpreting.

import play.api.libs.json._
defined class Bar
defined module Bar
defined class Foo
defined module Foo

scala> Json.prettyPrint(Json.toJson(Foo("23", Bar("x", 1))))
res0: String = 
{
  "id" : "23",
  "bar" : {
    "x" : "x",
    "y" : 1
  }
} 
```

此外，如果您使用的是 Play 2.1+，请务必查看 2.10 宏的全新用法：[http ://www.playframework.com/documentation/2.1.0/ScalaJsonInception](http://www.playframework.com/documentation/2.1.0/ScalaJsonInception)

如果您对案例类的使用感到满意，并且 val/vars 的名称被用作 json 输出中的键，就像您的案例 BTW 一样，那么您可以使用两个单行：

```
implicit val barFormat = Json.writes[Bar]
implicit val fooFormat = Json.writes[Foo] 
```

这将为您提供确切的等价物：

```
scala> import play.api.libs.json._
import play.api.libs.json._

scala> case class Bar(x: String, y: Int)
defined class Bar

scala> case class Foo(id: String, bar: Bar)
defined class Foo

scala> implicit val barWrites = Json.writes[Bar]
barWrites: play.api.libs.json.OWrites[Bar] = play.api.libs.json.OWrites$$anon$2@257cae95

scala> implicit val fooWrites = Json.writes[Foo]
fooWrites: play.api.libs.json.OWrites[Foo] = play.api.libs.json.OWrites$$anon$2@48f97e2a

scala> Json.prettyPrint(Json.toJson(Foo("23", Bar("x", 1))))
res0: String = 
{
  "id" : "23",
  "bar" : {
    "x" : "x",
    "y" : 1
  }
} 
```

# objective-c - Obj-c Xcode 静态分析在指针分配上产生“空指针的取消引用”

> ID：15704757
> 
> 赞同：2
> 
> 时间：2013-03-29T13:57:48.963
> 
> 标签：objective-c, xcode, static-analysis, objective-c-runtime

我正在尝试实现一件棘手的事情：我所有的模型类都有其属性的自动 NSCoding 实现。这让我可以在我的类中添加和删除属性，并且不用担心丢失的东西未被编码/解码。（实际上，它也有其他用途，但这是主要思想）。

当使用 initWithCoder 从存档初始化我的对象时，感谢 Obj-C 运行时，我浏览了我的属性列表，并尝试直接将 ivars 分配给值。由于各种专横的原因，我不想通过 setter，因此 setValue:forKey: 是被禁止的。

有趣的问题，不是吗？我必须说我对 C 指针的微妙之处并不完全有信心......

这是代码：

```
unsigned int outCount;
objc_property_t *properties = class_copyPropertyList(class, &outCount);

for (unsigned int index = 0; index < outCount; index++) {
    objc_property_t property = properties[index];
    NSString *propertyNameString = [NSString stringWithUTF8String:property_getName(property)];

    id value = [coder decodeObjectForKey:propertyNameString];
    if (value == nil) {
        continue;
    }

    const char *attributes = property_getAttributes(property);
    NSString *typeAttribute = [[NSString stringWithUTF8String:attributes] substringWithRange:NSMakeRange(1, 1)];
    const char *ivarName = [[@"_" stringByAppendingString:propertyNameString] UTF8String];

    if ([typeAttribute isEqualToString:@"@"]) {
        Ivar ivar = class_getInstanceVariable([self class], ivarName);
        object_setIvar(self, ivar, value);
    }
    else if ([typeAttribute isEqualToString:@"d"]) {
        double *doublePointer = getIvarPointer(self, ivarName);
        *doublePointer = [value doubleValue];
    }
    else if ([typeAttribute isEqualToString:@"i"]) {
        int *intPointer = getIvarPointer(self, ivarName);
        *intPointer = [value intValue];
    }
    else if ([typeAttribute isEqualToString:@"c"]) {
        char *charPointer = getIvarPointer(self, ivarName);
        *charPointer = [value boolValue];
    }
    else if ([typeAttribute isEqualToString:@"Q"]) {
        NSUInteger *uintegerPointer = getIvarPointer(self, ivarName);
        *uintegerPointer = [value unsignedIntegerValue];
    }
}

free(properties); 
```

'getIvar' 函数看起来像这样（是的，我在对象类上使用 class_getInstanceVariable，因为 ARC 不允许使用 object_getInstanceVariable...）：

```
static void* getIvarPointer(id object, char const *name)
{
    Ivar ivar = class_getInstanceVariable(object_getClass(object), name);
    if (!ivar) return 0;
    return (unsigned char *)(__bridge void *)object + ivar_getOffset(ivar);
} 
```

运行 Xcode 的静态分析器时，我收到一条警告“**取消引用空指针（从变量 'doublePointer' 加载）** ”。有趣的是，int 和 NSUInteger 出现了类似的消息，但现在似乎消失了……它从未出现在“char”中。

任何想法、建议或有见地的批评都将不胜感激。

我必须说，代码确实有效。我确实在我的对象类中自动解码了 double 和 int。但我想了解为什么静态分析器会告诉我这样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:18:03.930

由于您的 getIvarPointer() 函数可以清楚地返回 0，因此您必须在我认为的每个 *ptr 做作中处理这种可能性。例如：

```
if ([typeAttribute isEqualToString:@"d"]) {
    double *doublePointer = getIvarPointer(self, ivarName);
    if (doublePointer) {
        *doublePointer = [value doubleValue];
    } else {
        // Handle this as you can ;)
    }
} 
```

# facebook - facebook FB.login 在 Safari 中返回空白弹出窗口

> ID：15704759
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:50.560
> 
> 标签：facebook, oauth, safari, facebook-javascript-sdk

facebook javascript SDK 在尝试登录时给了我一个白色的弹出窗口，我遵循了他们的官方“如何使用 javascript 进行身份验证”文档，它适用于 chrome、firefox 但不适用于 safari 或 IE

有任何想法吗？

# python - python fdb，试图连接到外部 firebird 1.5 超级服务器

> ID：15704760
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:53.693
> 
> 标签：python, windows-server-2008, firebird

我正在尝试使用 Python fdb 库从我的本地计算机连接到位于服务器上的 Firebird 1.5 数据库。但我没有运气。
服务器是运行 Firebird 1.5.6 作为服务的 Windows 2008 服务器 R1。它还有一个名为`firebird`.
我如何通过python连接到它？我正在使用这段代码：

```
import fdb
db = fdb.connect(host='192.168.40.28', database="C:\databases\database12.GDB", user='admin', password='admin') 
```

但它会产生这个结果：

```
Traceback (most recent call last):
  File "data.py", line 4, in <module>
    db = fdb.connect(host='192.168.40.28', database="C:\databases\database12.GDB", user='admin', password='admin')
  File "/usr/local/lib/python2.7/dist-packages/fdb/fbcore.py", line 666, in connect
    "Error while connecting to database:")
fdb.fbcore.DatabaseError: ('Error while connecting to database:\n- SQLCODE: -902\n- Unable to complete network request to host "192.168.40.28".\n- Failed to establish a connection.', -902, 335544721) 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T15:10:55.873

假设 IP`192.168.40.28`是正确的，我的下一个问题是您没有`3050`打开端口（那是 Firebird 的默认端口）。检查服务器的防火墙并打开端口。您可以使用其他端口而不是`3050`通过`RemoteServicePort`在`firebird.conf`文件中设置参数，但是您也必须在`connect`方法中设置端口参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T15:06:16.710

正如其他答案所述，检查端口 3050 是否打开。

但是，**fdb**只支持 Firebird 2.0 或更高版本。对于 Firebird 1.5，您可以使用[pyodbc](https://pypi.python.org/pypi/pyodbc/)或[pyfirebirdsql](https://pypi.python.org/pypi/firebirdsql/)

~~Note that, among other issues (like not handling Firebird INTEGER datatypes properly), pyfirebirdsql isn't 100% compliant with [PEP 249 -- Python DB API 2.0](http://www.python.org/dev/peps/pep-0249/) as calls to `Cursor.rowcount` [always return -1](https://github.com/nakagami/pyfirebirdsql/blob/master/firebirdsql/fbcore.py#L630).~~

* * *

*Edit: After posting this, I took it upon myself to write the code for pyfirebirdsql's `rowcount` function, so now it works as expected, instead of always returning 1\. Shortly after that, the pyfirebirdsql author fixed the INTEGER issues as well.*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T17:13:17.793

您必须检查主机中打开的端口，如 ain 所说。顺便说一句，fdb 仅适用于 firebird 2.0 及更高版本。看看这个。 [https://fdb.readthedocs.org/en/latest/getting-started.html#installation](https://fdb.readthedocs.org/en/latest/getting-started.html#installation)

# c# - WPF TreeView如何为TreeViewItem的子元素添加TreeViewItem控件模板

> ID：15704761
> 
> 赞同：1
> 
> 时间：2013-03-29T13:57:56.260
> 
> 标签：c#, wpf, mvvm, treeview, treeviewitem

如何创建像这样的树视图：

```
 <TreeViewItem Header="Customers" ItemsSource="{Binding Customers}"> 
```

*   顾客
    *   安娜
        *   删除
        *   打开
    *   彼得
        *   删除
        *   打开
    *   安德鲁
        *   删除
        *   打开

我想创建类似这样的子项模板

```
 <TreeViewItem Header="{Binding Header}">
   <TreeViewItem Header="Delete"/>
   <TreeViewItem Header="Open"/>
 </TreeViewItem> 
```

但它并不能很好地工作，因为我最终得到了带有 datatemplate treeviewitem 的 treeviewitem，但我想覆盖子元素的 controltemplate，而不是父元素。当然，我想避免我的绑定是 TreeViewItem，也不想用那些静态对象“打开”、“删除”来创建孩子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T09:47:08.643

[这](http://www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode)`TreeView`是我读过的最好的文章之一。

如果 Delete 和 Open 命令是某个集合的项目，则可以在内部`TreeView.Resources`声明几个不同的 DataTemplates 。`DataType`（命令的 TargetType 是 ICommand）。

但似乎你根本不需要 TreeView。客户是列表的标题。如果您希望它是可扩展的，请使用[Expander](http://msdn.microsoft.com/en-us/library/system.windows.controls.expander.aspx)控件。
那么为每个客户提供一个数据模板就足够了。

```
<DataTemplate DataType="CustomerTypeName">
    <Expander Header="{Binding CustomerName}">
        <Button Command="{Binding DeleteCustomerCmd}" Content="Delete" Margin="15,0,0,0"/>
        <Button Command="{Binding OpenCustomerCmd}" Content="Open" Margin="15,0,0,0"/>
    <Expander/>
<DataTemplate> 
```

但是在这里你会遇到一些选择突出显示的问题。

```
public class CommandWrapper
{
    ICommand Command {get;set;}
    string CommandName {get;set;}
}

public class CustomerViewModel
{
    Customer Customer {get;set;}
    IEnumerable<CommandWrapper> Commands {get;}
} 
```

让客户收藏`CustomerViewModel`。那么以下 XAML 可以提供帮助：

```
<TreeView ItemsSource="{Binding ...}">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="TypeHoldingCustomersCollection" 
            ItemsSource="{Binding Customers}">
            <TextBlock Text="Customers"/>
        </HierarchicalDataTemplate>

        <HierarchicalDataTemplate DataType="CustomerViewModel" 
            ItemsSource="{Binding Commands}">
            <TextBlock Text="{Binding Path=Customer.Name}"/>
        </HierarchicalDataTemplate>

        <DataTemplate DataType="CommandWrapper">
            <Button Content="{Binding CommandName}" Command="{Binding Command}"/>
        </DataTemplate>
    </TreeView.Resources>
</TreeView> 
```

# php - 为什么用户登录不正确时不显示错误

> ID：15704769
> 
> 赞同：0
> 
> 时间：2013-03-29T13:58:16.043
> 
> 标签：php, login

我有以下代码：

```
session_start ();
include 'core/init.php';

$username = '';
$password = '';
$dbusername = '';
$dbpassword = '';
if (isset($_POST['Email']) && isset($_POST['Password']))
{
    $username = $_POST['Email'];
    $password = md5($_POST['Password']);

    $query = mysql_query("SELECT * FROM member WHERE Email ='$username' AND Password='$password'");

    $numrow = mysql_num_rows ($query);
    // user login
    if ($numrow!=0)
    {
        while ($row = mysql_fetch_assoc($query))
        {
            $dbusername = $row['Email'];
            $dbpassword = $row['Password'];
        }

        //Check to see if they match
        if ($username==$dbusername&&$password==$dbpassword)
        {
            $_SESSION ['Email']=$username;
            header('Location: member.php?username='.$username);
        }
    }
    else 
    {
        // admin login
        $query2 = mysql_query("SELECT * FROM admin WHERE Email ='$username' AND Password ='$password'");
        $numrow2 = mysql_num_rows ($query2);
        if ($numrow2!=0)
        {
            while ($row = mysql_fetch_assoc($query2))
            {
                $dbusername = $row['Email'];
                $dbpassword = $row['Password'];
            }

            //Check to see if they match
            if ($username==$dbusername&&$password==$dbpassword)
            {
                $_SESSION ['Email']=$username;
                header("Location: admin.php");
            }else{
                if (empty ($username) === true|| empty($password) === true) {
                    echo "Please enter a username and password";
                } else if ($username!=$dbusername){
                    echo "That user does not exist! Have you registered?";
                } else if ($username=$dbusername&&$password!=$dbpassword) {
                    echo "Incorrect password";
                }
            }
        }
    }
} 
```

但是，如果用户登录不正确，则不会显示任何错误消息，只是一个空白页，我认为这是我的大括号，但无论我更改多少次，我要么让它变得更糟，要么根本没有。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:00:58.913

查看：

```
if (empty ($username) === true|| empty($password) === true) {
                echo "Please enter a username and password";
                    } else if ($username!=$dbusername){
                        echo "That user does not exist! Have you registered?";
                    } else if ($username=$dbusername&&$password!=$dbpassword) {
                            echo "Incorrect password";
                    }

            } 
```

此部分包含登录错误，可在“管理员登录”部分中找到，因此当非管理员用户登录失败时不会出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:08:50.987

```
$query = mysql_query("SELECT * FROM member WHERE Email ='$username' AND Password='$password'");

    if(mysql_num_rows($query) == 0){
     echo 'You have entered wrong username/password'; }else {

      // you can continue with your query below. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:23:06.740

您的 select 语句已经确保提供的用户名和密码与数据库中的内容匹配。无需在 PHP 中进行第二次比较。您的代码可能只是以下内容：

```
if (isset($_POST['Email']) && isset($_POST['Password']))
{
    $username = $_POST['Email'];
    $password = md5($_POST['Password']);

    $query = mysql_query("SELECT * FROM member WHERE Email ='$username' AND Password='$password'");

    if(mysql_num_rows($query) == 1)
    {
        $_SESSION['Email'] = $username;
        header('location: member.php?username='.$username);
    }
    else 
    {
        // try admin login
        $query2 = mysql_query("SELECT * FROM admin WHERE Email ='$username' AND Password ='$password'");
        if(mysql_num_rows($query2) == 1)
        {
            $_SESSION['Email'] = $username;
            header("location: admin.php");
        }
        else
        {
            echo "Failed Login Attempt";
        }
    }
} 
```

由于您的查询仅返回用户名和密码匹配的记录，因此您永远不会在用户名匹配但密码不匹配的地方得到结果，因此您在管理员登录结束时进行的条件检查将永远不会发生。

作为旁注，通知用户用户名正确但密码不正确是一种不好的形式，反之亦然。这是一个安全问题，可能使恶意用户更容易获得访问权限。不过，这不是重点，因此请仅将此建议视为个人建议，而不是针对您的问题。

# angularjs - AngularJS ng-keydown 指令仅适用于语境？

> ID：15704771
> 
> 赞同：40
> 
> 时间：2013-03-29T13:58:22.740
> 
> 标签：angularjs, hotkeys

我对 AngularJS 很陌生，但到目前为止我很喜欢它。对于我当前的项目，我需要热键功能，并且很高兴看到它从 1.1.2 版本开始就受到支持。

ng-keydown 指令（[http://code.angularjs.org/1.1.3/docs/api/ng.directive:ngKeydown](http://code.angularjs.org/1.1.3/docs/api/ng.directive:ngKeydown)）对输入类型按预期工作，但对于 div 等任何其他上下文都失败了，这似乎很奇怪鉴于文档另有说明。

这是一个最小的例子（[http://jsfiddle.net/TdXWW/12/](http://jsfiddle.net/TdXWW/12/)），分别是不工作的：

```
<input ng-keydown="keypress($event)">
<div ng-keydown="keypress($event)"> 
```

注意：我知道这可以用普通的 jQuery ( [http://www.mkyong.com/jquery/how-to-check-if-an-enter-key-is-pressed-with-jquery/](http://www.mkyong.com/jquery/how-to-check-if-an-enter-key-is-pressed-with-jquery/) ) 来处理，但我很更喜欢了解如何在 AngularJS 中处理它。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-08-16T15:52:33.330

我遇到了同样的问题，并且能够通过遵循此评论中提供的这个简单提示来解决它：[https ://stackoverflow.com/a/1718035/80264](https://stackoverflow.com/a/1718035/80264)

> 您需要给 div 一个 tabindex 以便它可以接收焦点。

```
<div id="testdiv" tabindex="0"></div> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-06-12T09:09:25.087

谢谢！为了结束这个，我通过将 $document 注入到我的指令中来完成这个工作，然后：

```
MyApp.directive('myDirective', function($document) {
return {
...
 $document.keydown(function(e){
   console.log(e)
 })
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-03-07T09:23:11.290

这就是我最终让它工作的方式。

添加`ng-app`到`html`元素和和`ng-keyup`元素：`ng-keydown``body`

```
<html ng-app="myApp" ng-controller="MainCtrl">
.....
<body ng-keydown="keyPress($event);" ng-keyup="keyRelease($event);"> 
```

然后我的控制器中的函数处理事件调用 event.which 以获取关键代码（在我的实现中，我将 var 设置为 rootScope 但您也可以广播到其他控制器）

```
$scope.keyPress = function(eve) {
    if (eve.which === 16) { // shift
        // $rootScope.$broadcast('doShift');
        $rootScope.shiftOn = true;
    };
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-29T18:04:39.523

[charlietfl](https://stackoverflow.com/users/1175966/charlietfl)的评论清除了一切，并将事件绑定到 $(document) 按预期工作！带走信息：AngularJS 文档并不详尽，即需要背景知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-24T07:55:14.140

```
angular.module('app').directive('executeOnEnter', function () {
    return {
        restrict: 'A',
        link: function (scope, el, attrs, $rootScope) {                      
            $('body').on('keypress', function (evt) {
                if (evt.keyCode === 13) {
                    el.trigger('click', function () {
                    });
                }            
            })

        },
        controller: function ($rootScope) {
            function removeEvent() {
                $("body").unbind("keypress");
            }
            $rootScope.$on('$stateChangeStart', removeEvent);
        }
    }
}) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-27T09:46:28.670

它对我来说很好，只需添加 tabindex 属性。确保 ng-keydown 包含正确的 angularjs 表达式

```
 <div ng-keydown="keypress($event)" tabindex="0">

    $scope.keypress = function(ev) {
        console.log('keyprez', ev);
    } 
```

# c# - 构建通用搜索表达式 - InvalidOperationException：Coalesce 与不能为空的类型一起使用

> ID：15704773
> 
> 赞同：0
> 
> 时间：2013-03-29T13:58:32.600
> 
> 标签：c#, reflection, expression

我在构建适用于多种不同类型对象的通用搜索表达式时遇到问题。我遇到的问题是某些属性将包含空值。

该函数将做的是对每个属性调用 ToString 方法，并查看它是否包含该特定属性的搜索值。问题是，如果是Null的话。如果我尝试合并它会引发`InvalidOperationException: Coalesce used with type that cannot be null`异常。

这是一个简单的类：

```
public class SomeObject
{
  public int IntValue { get; set; }
  public string StringValue { get; set; }
} 
```

示例程序：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;

class Program
{
  static void Main(string[] args)
  {
    //Generate data
    var list = (new List<SomeObject>
    {
      new SomeObject { IntValue = 5, StringValue = "abc" },
      new SomeObject { IntValue = 10, StringValue = "abc" },
      new SomeObject { IntValue = 10 },
      new SomeObject { StringValue = "xyz" },
      new SomeObject()
    }).AsQueryable<SomeObject>();

    var searchValues = new List<KeyValuePair<string, string>>
    {
      new KeyValuePair<string, string>("IntValue", "5"),
      new KeyValuePair<string, string>("StringValue", "abc")
    };

    var whereExp = GenerateSearchExpression<SomeObject>(searchValues);
    var asdf = list.Where(whereExp).ToList();

    System.Diagnostics.Debugger.Break();
  }

  static Expression<Func<SomeObject, bool>> GenerateSearchExpression<dataType>(List<KeyValuePair<string, string>> values)
  {      
    //Get the properties of the data type
    var objectType = typeof(dataType);
    var objProps = objectType.GetProperties();

    Expression whereExpr = Expression.Constant(true);
    var paramExpr = Expression.Parameter(typeof(SomeObject), "val");

    //Cycle through each property
    foreach (var searchValue in values)
    {
      var propExpr = Expression.Property(paramExpr, searchValue.Key);
      var emptyString = Expression.Constant("");

      //InvalidOperationException: Coalesce used with type that cannot be null
      var coalesceExpr = Expression.Coalesce(propExpr, emptyString);

      var toStringExpr = Expression.Call(coalesceExpr, "ToString", new Type[0]);
      var toLowerExpr = Expression.Call(toStringExpr, "ToLower", new Type[0]);
      var containExpr = Expression.Call(toLowerExpr, typeof(string).GetMethod("Contains"), Expression.Constant(searchValue.Value));

      //Add this to the exisiting where expression.
      whereExpr = Expression.And(whereExpr, containExpr);
    }

    var foobar = Expression.Lambda<Func<SomeObject, bool>>(whereExpr, paramExpr);

    return foobar;
  }
} 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:52:18.570

我需要使用该`propExpr.Type.IsValueType`属性：

这是最终的功能：

```
 static Expression<Func<SomeObject, bool>> GenerateSearchExpression<dataType>(List<KeyValuePair<string, string>> values)
  {      
    //Get the properties of the data type
    var objectType = typeof(dataType);
    var objProps = objectType.GetProperties();

    Expression whereExpr = Expression.Constant(true);
    var paramExpr = Expression.Parameter(typeof(SomeObject), "val");

    MethodCallExpression toStringExpr;
    foreach (var searchValue in values)
    {
      var propExpr = Expression.Property(paramExpr, searchValue.Key);

      if (propExpr.Type.IsValueType == true)
      {
        toStringExpr = Expression.Call(propExpr, "ToString", new Type[0]);
      }
      else
      {
        var emptyString = Expression.Constant("");
        var coalesceExpr = Expression.Coalesce(propExpr, emptyString);
        toStringExpr = Expression.Call(coalesceExpr, "ToString", new Type[0]);            
      }

      var toLowerExpr = Expression.Call(toStringExpr, "ToLower", new Type[0]);
      var containExpr = Expression.Call(toLowerExpr, typeof(string).GetMethod("Contains"), Expression.Constant(searchValue.Value));         

      //Add this to the exisiting where expression.
      whereExpr = Expression.And(whereExpr, containExpr);
    }

    var foobar = Expression.Lambda<Func<SomeObject, bool>>(whereExpr, paramExpr);

    return foobar;
  } 
```

# linux - 互斥锁在任何时候都会阻塞所有线程吗？

> ID：15704777
> 
> 赞同：1
> 
> 时间：2013-03-29T13:59:05.663
> 
> 标签：linux, multithreading, concurrency

在 Linux 中，假设我有 100 个线程的代码。其中 5 个线程争夺受互斥锁保护的共享资源。我知道，当关键部分实际运行时，只有 5 个线程在尝试获取锁时会停止执行，而其他 95 个线程将毫无问题地运行。

我的问题是，其他 95 个线程的执行是否会暂停或受到影响，即当互斥锁/内核/任何东西确定哪些线程在互斥锁上被阻塞，哪些线程应该获得锁，哪些线程应该能够运行，因为他们不要求锁等

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T14:03:10.613

不，其他线程不受影响。

内核不会*询问*哪些线程受到锁的影响。每个线程在尝试获取锁时都会*告诉内核。*

当线程这样做时，它们会进入睡眠状态并进入与锁相关的特殊唤醒队列。

不使用锁的线程不会与使用锁的线程进入同一个队列，因此它们的阻塞行为是不相关的。

# c# - 更改时间并转换为日期时间

> ID：15704780
> 
> 赞同：1
> 
> 时间：2013-03-29T13:59:13.077
> 
> 标签：c#, .net, perforce

我必须`changelists`从 perforce 中进行选择，问题是当我提取信息时，但问题是日期和时间看起来并不重要，所以我怎样才能将此字符串更改为有意义的日期和时间

结果示例 1361898522

编码：

```
P4Command cm1 = new P4Command(ps, "changes", true, String.Format("{0}", deppath1));
Options opchanges = new Options();
opchanges.Add(op1,op2);
P4CommandResult results1 = cm1.Run(opchanges);
TaggedObjectList listfiledown1 = new TaggedObjectList();
listfiledown1 = (results1.TaggedOutput);

foreach (TaggedObject obj in listfiledown1)
{      
     foreach (String s in obj.Keys)
     {
         String value = "n/a";
         obj.TryGetValue(s, out value);
         var changeList = value.Split ('@');       
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:10:08.773

*如果*值 1361898522 是 2013 年 2 月 26 日星期二 17:08:42 UTC，那么看起来这是一个 Unix 时间戳 - 自 Unix 纪元以来的秒数。这在 C# 中很容易做到：

```
private static readonly DateTime UnixEpoch = new DateTime(1970, 1, 1, 0, 0, 0,
                                                          DateTimeKind.Utc);

...

public static DateTime FromUnixTimestamp(long seconds)
{
    return UnixEpoch + TimeSpan.FromSeconds(seconds);
} 
```

请注意 UTC `DateTimeKind`，以便时代是适当的 UTC，而不是系统本地时区。

Using my [Noda Time](http://noda-time.googlecode.com) project it's even easier, as of version 1.1:

```
Instant timestamp = Instant.FromSecondsSinceUnixEpoch(seconds); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:10:07.050

我怀疑日期时间值以 Unix 时间表示：自 1970 年 1 月 1 日以来的秒数。

例如，如果你写：

```
 var epoc = new DateTime(1970, 01, 01);
        dt = epoc + TimeSpan.FromSeconds(1361898522);
        Console.WriteLine(dt); 
```

结果是：

```
2013/02/26 17:08:42 
```

# node.js - 坚持让猫鼬，节点和快递一起玩

> ID：15704783
> 
> 赞同：0
> 
> 时间：2013-03-29T13:59:29.797
> 
> 标签：node.js, mongodb, express, mongoose

我正在关注**[DailyJS](http://dailyjs.com/2010/11/08/node-tutorial-2/)**的 node.js 和 express 教程，并且已经碰壁了。

在教程中它说要这样做：

```
 mongoose = require('mongoose').Mongoose
 db = mongoose.connect('mongodb://localhost/nodepad') 
```

但之前他在谈论`app.js`文件中的代码，所以我认为他的意思是让上面的代码进入，`app.js`但我不知道。此时我从github下载了nodepad，看看他实际把mongoose代码放在哪里了，在整个应用程序的任何地方都找不到上面的代码！

所以我很茫然。事情已经令人困惑了，因为 express 制作的默认骨架站点在许多方面与教程不同，因为 express 在编写教程后的 2 年中发生了很大变化。

所以我试图跟随，但我真的被困在他说写一些代码的地方，但没有说明这段代码应该去哪里。

之后教程说要添加一个`models.js`文件，我想知道它在哪里，可能在目录中？

（我也明白上面的代码已经过时了，正确的代码可以在**[这里](http://mongoosejs.com/)**找到，问题不在于代码，而在于表达它的意思）

请给我一些指导。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T16:23:16.843

两个都进去了`app.js`。我可以给你更多的细节。我一直使用猫鼬和快递。我不使用`var mongoose = require('mongoose').Mongoose`所有我使用的是`var mongoose = require('mongoose')`

如果您需要任何进一步的帮助，请告诉我。

# c++ - 算法：合并 std::unordered_maps

> ID：15704787
> 
> 赞同：2
> 
> 时间：2013-03-29T13:59:34.820
> 
> 标签：c++, algorithm, boost

我有以下问题：

我有 n 个从 std::string 映射到 boost::variant 的哈希图（我们称它们为 A.1、A.2、...、An），我想将它们合并为一个哈希图（我们称其为 B ） 如下：

1.  如果 A.1, A.2, ... An 包含与键 K 相同的值，则 B 应包含与键 K 相同的值。
2.  如果存在映射 A.1、A.2、... An 之一中不存在的某个键 K，则 B 应包含从键 K 到值 boost::blank 的映射。
3.  如果 A.1、A.2、...An 中的键 K 存在某个与其他值不同的值，则 B 应包含从键 K 到值 boost::blank 的映射。

我必须这样做很多，我知道这将成为一个瓶颈。实现这一目标的最有效方法是什么？任何库支持像这样合并哈希图？

编辑：如果另一个数据结构更合适，请告诉我。但是，我确实需要 O(1) 查找

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:12:39.950

如果我阅读正确，您正在寻找`O(N log N)`解决方案。如果没有 C++ 经验来编写正确的实现，您想要做的事情是这样的：

```
1) Push all of the elements from every map into a `Set`   `O(N) + overhead of checking existence O(1)`  
   A)  define the elements of the set by a hash value generated by `Key + Value`   
      a)  that is `A:hello`  creates a different value than `B:hello`  
2) Perform a merge sort `O(N log N)` based on the values  
3) Start at the beginning of your `sorted set` and iterate over the values.  
   A) If a value is found multiple times this satisfies your `3` step  
   B) Your `2` step can be satisifed in `O(1)` time by looking up the key 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T15:34:33.800

这是我的算法（只是迭代所有元素）：

1.  `std::unordered_map<string, variant> result`
2.  选择其中包含大多数条目的地图 O(n)。
3.  遍历最大地图的每个元素 -> O(m)
    1.  `result[current_key] = current_value`
    2.  对于彼此的地图 -> O(n-1)
        1.  查找键 -> O(1)
        2.  如果键不存在 -> `result[current_key] = blank`。进入最大地图中的下一个项目。
        3.  [关键存在] 如果`current_value != map[key]`-> `result[current_key] = blank`。进入最大地图中的下一个项目。
        4.  [key present] 到最大地图中的下一个项目。

就这样。你得到了 O(n) + O(m*n)，它等于 O(m*n)。这似乎不如@Woot4Moo 的算法，因为@Woot4Moo 的算法的步骤（2）需要 O(m*n)*log(m*n)。

我不确定是否有可能以直接的方式使其比 O(m*n) 更快。我想您需要一些即时处理才能更快地完成此操作。但！！！这些缓存不是很安全。所以，首先考虑简单的算法。也许它不会成为您的应用程序的瓶颈。

# css - 使用 box-sizing: "border-box" 并保持图像尺寸

> ID：15704789
> 
> 赞同：3
> 
> 时间：2013-03-29T13:59:49.753
> 
> 标签：css

如果我使用`box-sizing: "border-box"`图像图像会变小，就像悬停一样：[示例 JsFiddle](http://jsfiddle.net/BPRyZ/)

是否可以在不裁剪图像的情况下达到相同的效果？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T14:02:39.933

**解决方案 #1**大纲属性。尝试使用等于轮廓宽度的负[轮廓偏移](https://developer.mozilla.org/en-US/docs/CSS/outline-offset)`outline`值代替边框：

```
img:hover {
    box-sizing:border-box;
    outline: solid 10px #f80;
    outline-offset: -10px;
} 
```

[http://jsfiddle.net/dfsq/BPRyZ/2/](http://jsfiddle.net/dfsq/BPRyZ/2/)

此外，由于 IE 不理解此属性，您可以留给`box-sizing`IE8+ 使用。

**解决方案#2**使用 div 作为包装器 + `:after`：

```
<div class="img-wrap">
    <img src="http://upload.wikimedia.org/wikipedia/commons/a/af/Bonsai_IMG_6426.jpg" class="img1" />
</div> 
```

CSS：

```
.img-wrap:after {
    border: 0;
}
.img-wrap:hover:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    border: solid 10px #f80;
} 
```

[http://jsfiddle.net/dfsq/BPRyZ/7/](http://jsfiddle.net/dfsq/BPRyZ/7/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T14:02:17.383

您需要回答的问题是，您希望图像本身为 200px，还是整个框为 200px。根据您对上一个问题的回答，有 4 种不同的编码方式...

**如果您希望整个框为 200px 宽，那么您可以使用带有以下代码的边框框...**

[http://jsfiddle.net/BPRyZ/8/](http://jsfiddle.net/BPRyZ/8/)

```
img {
    width:200px;
    border: transparent 10px solid;
    box-sizing:border-box;
}

img:hover{
    box-sizing:border-box;
    border:solid 10px #f80;
} 
```

**如果您希望整个框为 200px 宽，那么您也可以使用此代码...**

```
img {
    width:180px;
    border: transparent 10px solid;
}

img:hover{
    border:solid 10px #f80;
} 
```

**如果您希望图像本身为 200 像素，那么您需要此代码...（这意味着您的总框宽度实际上是 220 像素）**

```
img {
    width:220px;
    border: transparent 10px solid;
    box-sizing:border-box;
}

img:hover{
    box-sizing:border-box;
    border:solid 10px #f80;
} 
```

**对于上述内容，您还可以使用...**

```
img {
    width:200px;
    border: transparent 10px solid;
}

img:hover{
    border:solid 10px #f80;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T14:04:27.500

我更新了你的[**jsfiddle**](http://jsfiddle.net/BPRyZ/3/)

CSS：

```
img {
    width:200px;
    border: transparent 10px solid;
}

img:hover{
    box-sizing:border-box;
    border:solid 10px #f80;
    width:220px;
} 
```

# c# - asp.net 自定义控件属性作为对另一个控件的引用

> ID：15704797
> 
> 赞同：0
> 
> 时间：2013-03-29T14:00:20.940
> 
> 标签：c#, asp.net, class, properties

我希望设置一个具有 2 个公共字符串属性的用户控件。该字符串应该是带有用户控件的页面控件的 ID。

在使用控件验证类作为一个示例以及标签的关联控件 ID 之后，我无法

1.  将此控件添加到另一个页面时，将属性显示为属性面板中页面上的控件列表的下拉列表。（这是验证工作的控件的方式，试图找出我错过了什么。）
2.  在我能够获得所有列表之后，我希望将其中一些限制为特定的控件类型（下拉列表或类似的东西）。根据我已经完成的一些额外阅读，我猜这需要使用自定义[类型转换器](https://stackoverflow.com/questions/5171037/display-list-of-custom-objects-as-a-drop-down-in-the-propertiesgrid)来完成。

    ```
    [
        Category("Behavior"),
        DefaultValue(""),
        Description("The State Tex Box"),
        TypeConverterAttribute(typeof(AssociatedControlConverter))
    ]
    public string StateControlToAutoFill
    {
        get
        {
            object o = ViewState["StateControlToAutoFill"];
            return ((o == null) ? String.Empty : (string)o);
        }
        set
        {
            ViewState["StateControlToAutoFill"] = value;
        }
    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T18:38:33.493

使用验证控件作为起点（验证道具的控件在很大程度上完成了我想要的操作）我能够通过以下方式解决这个问题。

1.  看看[ValidateControlConverter.cs](http://www.dotnetframework.org/default.aspx/Dotnetfx_Win7_3@5@1/Dotnetfx_Win7_3@5@1/3@5@1/DEVDIV/depot/DevDiv/releases/whidbey/NetFXspW7/ndp/fx/src/xsp/System/Web/UI/WebControls/ValidatedControlConverter@cs/1/ValidatedControlConverter@cs)
2.  创建了我自己的 LabelOrTextBoxTypeConverter，并用我自己的逻辑覆盖了与 ValidateControlConverter (FilterControl) 相同的方法。

    ```
    class LabelOrTextBoxTypeConverter : ControlIDConverter
    {
    //public ControlByTypeIDConverter(List<Type> WantedControlTypes)
    //{
    //    this.ControlTypes = WantedControlTypes;
    //}
    /// <summary>
    /// 
    /// </summary>
    /// <param name="control"></param>
    /// <returns></returns>
    protected override bool FilterControl(Control control)
    {
        bool isWanted = false;
        foreach (var atype in this.ControlTypes)
        {
            isWanted |= control.GetType() == atype;
        }

        return isWanted;
    }

    public List<Type> ControlTypes { get { return new List<Type>() { typeof(TextBox), typeof(Label) }; } } 
    ```

    }

3.  最后一步是在控件属性上

    ```
    [
    Category("Target Controls")
    , DefaultValue("")
    , Bindable(true)
    , Description("The State Text Box To Auto Fill.")
    , TypeConverterAttribute(typeof(LabelOrTextBoxTypeConverter))
    ]
    public string StateControlToAutoFill 
    ```

as you can see i didn't get 100% what i wanted here. i was hoping to set this up to just be a Control Filter class and have a list of the types of controls i was interested in passed in. I need to do a little more digging here to complete this but for the time being this is working as expected. anyone who knows the answer to this off the top of their head would be much appreciated.

All said and done this is working. Won't really get to use it to much as you have to be in design mode using the prop panel to take advantage of the generated list.

# javascript - 在 Chrome 中的打印窗口关闭事件中，有可能吗？

> ID：15704798
> 
> 赞同：3
> 
> 时间：2013-03-29T14:00:23.440
> 
> 标签：javascript, jquery, google-chrome, printing

我有那个 Chrome 打印对话框窗口，这还不错，但是当该窗口被取消或关闭时我需要事件以触发其他功能。有没有可能做这样的事情。

# javascript - 聊天使用什么协议？webRTC 或 Websockets

> ID：15704803
> 
> 赞同：5
> 
> 时间：2013-03-29T14:00:49.470
> 
> 标签：javascript, websocket, webrtc

我正在创建一个可以进行视频、音频和文本聊天的聊天网站。我目前正在使用 Websockets 进行文本聊天。我需要知道什么最擅长视频、音频和文本聊天。哪个更有效。我应该为所有这些使用 Websockets，还是为视频和音频使用 webRTC，为文本聊天使用 Websockets。我可以两者都做，并且不想为 webRTC 重新编写我的文本聊天，但如果它是一个更好的选择，那么我会的。
**编辑：**我刚刚发现了 binaryJS，这是不是 webRTC 更好更简单的替代方案？
谢谢，
@_C1D

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T14:03:22.830

通过将视频和音频流嵌入 websocket，您将拥有一个更简单的系统，但所有内容都必须通过您的服务器。

WebRTC 允许对之间直接连接，因此使用它可以获得更好的结果。

另请注意，但您可能已经知道，webRTC 的一切都刚刚出现。

关于编辑中的问题，关于 binaryJS ：我从未尝试过，但它看起来不像交易改变者，只是使用 websockets 的工具。

# linux - 为 -- libwebsocket warmcat 安装新版本的 libtool

> ID：15704808
> 
> 赞同：0
> 
> 时间：2013-03-29T14:01:14.807
> 
> 标签：linux, websocket, embedded-linux, libtool

我正在安装 libwebsocket 它给了我错误：---
[http://git.warmcat.com/cgi-bin/cgit/libwebsockets/snapshot/libwebsockets-1.0-chrome25-firefox17.tar.gz](http://git.warmcat.com/cgi-bin/cgit/libwebsockets/snapshot/libwebsockets-1.0-chrome25-firefox17.tar.gz)

```
/pi/libwebsockets-1.0-chrome25-firefox17$ ./autogen.sh 
Preparing the libwebsockets build system...please wait

Found GNU Autoconf version 2.69
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
    LANGUAGE = "en_US:",
    LC_ALL = (unset),
    LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
    LANGUAGE = "en_US:",
    LC_ALL = (unset),
    LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
Found GNU Automake version 1.13
Found GNU Libtool version 1.5.26

Automatically preparing build ... Warning: autoreconf failed
Attempting to run the preparation steps individually

Preparing build ... ERROR: aclocal failed 
```

目前当我运行 libtool --version:---

```
/home/pi$ libtool --version
ltmain.sh (GNU libtool) 1.5.26 (1.1220.2.492 2008/01/30 06:40:56)

Copyright (C) 2008  Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

如果我运行 whereis 命令，我会得到以下输出：----

```
/pi/libtool-2.4.2$ whereis libtool
libtool: 
```

我必须安装 libtool 版本 2.4.2，以摆脱上述错误。
现在我已经为 libtool 安装了 2.4.2 版本：---
[ftp://ftp.gnu.org/gnu/libtool/libtool-2.4.2.tar.gz](ftp://ftp.gnu.org/gnu/libtool/libtool-2.4.2.tar.gz)

安装 2.4.2 版本的 libtool 后，如果我运行 whereis 命令，我会得到以下输出：----

```
/pi/libtool-2.4.2$ whereis libtool
libtool: /usr/local/bin/libtool 
```

但是如果我运行 libtool --version:---

```
/home/pi$ libtool --version
ltmain.sh (GNU libtool) 1.5.26 (1.1220.2.492 2008/01/30 06:40:56) 
```

为什么 libtool --version 命令没有显示最新安装的 libtool 2.4.2 版本？

当我运行 ./autogen.sh 时，我也遇到了同样的 libwebsocket 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T14:08:04.097

您是否尝试过使用 CMake 的最新版本（1.22）？构建起来很简单。

```
$ git clone git://git.libwebsockets.org/libwebsockets
$ cd libwebsockets/ 
```

阅读 README.build。不知道旧版本的 libwebsockets，但我想它现在更倾向于使用 CMake 而不是 autotools。

```
$ mkdir build && cd build
$ cmake ..  -DCMAKE_INSTALL_PREFIX:PATH=/usr/local 
```

最后一行类似于：

```
$ ./configure --prefix=/usr/local 
```

整个事情构建得非常快，没有任何问题。

# php - 试图从加载 ajax 的 div 中获取元素

> ID：15704809
> 
> 赞同：0
> 
> 时间：2013-03-29T14:01:18.347
> 
> 标签：php, javascript, jquery, html, ajax

我正在尝试从加载 ajax 的 div 中获取元素，但我不能。让我们解释一下：

在'example.php'我有这个js代码：

```
<script type= "text/javascript">

var page=document.getElementById("table_page").value;

$(document).ready(function() {
    function update() {
      $.ajax({
       type: 'GET',
       url: "show_class_entrys.php?q="+page,
       timeout: 1000,
       success: function(data) {
          $("#show_class_entrys_js").html(data); 
          window.setTimeout(update, 3000);
       },
      });
     }
     update();
});

</script> 
```

但是使用 ajax 文件“loaded.php”加载 id='table_page' 的输入。文件“loaded.php”包含以下内容：

```
<?php echo " <input type='hidden' id='table_page' value='7' /> "; ?> 
```

这打印在我的“example.php”中的某个地方。问题是我无法在我的 js 代码中从此 div 获取值。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:12:26.710

试试这个：

```
$(document).ready(function () {

    var page = '';
    $('#divLoadedID').load('loaded.php', function () {
        page = $("#table_page").val();
        update();
    });

    function update() {
        $.ajax({
            type: 'GET',
            url: "show_class_entrys.php?q=" + page,
            timeout: 1000,
            success: function (data) {
                $("#show_class_entrys_js").html(data);
                window.setTimeout(update, 3000);
            },
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:07:08.750

这是一个简单的修复。您需要做的就是覆盖`page`您的成功函数，因为它将获得新值。

```
$(document).ready(function() {

    var page=$("#table_page").val();

    function update() {
      $.ajax({
       type: 'GET',
       url: "show_class_entrys.php?q="+page,
       timeout: 1000,
       success: function(data) {
          $("#show_class_entrys_js").html(data); 
          window.setTimeout(update, 3000);
          page=$("#table_page").val();
       },
      });
     }
     update();
}); 
```

问题是`page`在 DOM 更改之前设置，ajax 调用的成功部分发生在 DOM 更改之后，因此它可以解释新元素/数据

# python - get_internal_error() 返回 CharField 而不是 EmailField 和 URLField

> ID：15704812
> 
> 赞同：0
> 
> 时间：2013-03-29T14:01:31.470
> 
> 标签：python, django

我的字段`models.py`是`EmailField`和`URLField`。当我调用`get_internal_type()`这些方法时，方法返回`CharField`而不是`EmailField`and `URLField`。

我希望它成为`EmailField`并`URLField`进行进一步处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:06:52.427

如果您需要对这些类型进行特殊处理，请改用类的名称：

```
type(field).__name__  # get name of the field class, instead of field.get_internal_type() 
```

两者`EmailField`和`URLField` *都是* `Charfield`子类，仅具有预设的最大长度和专用的验证器。

# java - Google App Engine 使用 Blobkey

> ID：15704816
> 
> 赞同：1
> 
> 时间：2013-03-29T14:01:43.747
> 
> 标签：java, eclipse, google-app-engine, cloud, blobstore

嗨，我正在尝试制作一个 servlet，允许管理员上传图像和任何谷歌用户查看这些图像，到目前为止，我正在处理[https://developers.google.com/appengine/docs/java/blobstore上提供的程序/概述](https://developers.google.com/appengine/docs/java/blobstore/overview)

当我上传图片时，它会使用很长的 blobKey 立即提供它吗？并将自身的副本存储在 local_db.bin

我不知道是否有任何方法可以缩短 blobkeys 以供使用？例如，我想要一个画廊来显示用户上传的所有图像，但是到目前为止，我可以从数据库中获取图像的唯一方法是调用这样的东西

res.sendRedirect("/serve?blob-key=" + blobKey.getKeyString())

但这仅适用于一张图片，我需要对每个新的 blobKey 进行硬编码以便将其显示在单独的页面上，这也意味着当用户上传新图片时，我将不得不编辑代码并为新的图片添加新链接图片？

基本上我想知道的是是否有任何方法可以轻松定义存储在 local_db.bin 中的每个 blob。

任何帮助将不胜感激，请不要犹豫，询问更多细节。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T08:24:07.097

我认为你正在以一种有点尴尬的方式处理你的问题。

它不是 Blobstore 问题，它为您提供了此 blob 密钥。你可以做的是：

*   创建上传 servlet 以捕获文件上传
*   使用 AppEngine File API 获取字节并存储它

在这里，让我向您展示（我的项目中的工作代码块）：

```
@POST
@Consumes("multipart/form-data")
@Path("/databases/{dbName}/collections/{collName}/binary")
@Override
public Response createBinaryDocument(@PathParam("dbName") String dbName,
        @PathParam("collName") String collName,
        @Context HttpServletRequest request, @Context HttpHeaders headers,
        @Context UriInfo uriInfo, @Context SecurityContext securityContext) {

    try {
        ServletFileUpload upload = new ServletFileUpload();
        FileItemIterator fileIterator = upload.getItemIterator(request);
        while (fileIterator.hasNext()) {
            FileItemStream item = fileIterator.next();
            if ("file".equals(item.getFieldName())){
                byte[] content = IOUtils.toByteArray(item.openStream());

                logger.log(Level.INFO, "Binary file size: " + content.length);
                logger.log(Level.INFO, "Mime-type: " + item.getContentType());

                String mimeType = item.getContentType();

                FileService fileService = FileServiceFactory.getFileService();
                AppEngineFile file = fileService.createNewBlobFile(mimeType);
                String path = file.getFullPath();
                file = new AppEngineFile(path);
                boolean lock = true;
                FileWriteChannel writeChannel = fileService.openWriteChannel(file, lock);
                writeChannel.write(ByteBuffer.wrap(content)); // This time we write to the channel directly
                writeChannel.closeFinally();
                BlobKey blobKey = fileService.getBlobKey(file);
            } else if ("name".equals(item.getFieldName())){
                String name=IOUtils.toString(item.openStream());
                // TODO Add implementation
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
} 
```

正如您所看到的，Blobstore 只是提供“图像”的一部分，您必须自己创建一个 API 或其他东西，以便将这些图像或任何二进制数据获取到 Blobstore，包括将其文件名保存到 Datastore。

您必须做的另一件事是您的 API 或接口，以便将其从 Blobstore 导出到客户端：

*   像`@GET`具有查询参数的资源一样`?filename=whatever`
*   然后，您将从数据存储中获取与此文件名关联的 blobkey

这只是一个简化的示例，您必须确保保存 Filename 和 Blobkey，也就是说，如果需要，保存在正确的容器和用户中。

您可以直接使用 Blobstore API 和 Image API，但如果需要进一步控制，则必须设计自己的 API。无论如何，它并不难，Apache Jersey 和 JBoss Resteasy 与 GAE 完美配合。

# javascript - Javascript / jQuery - 如何随着时间的推移保持同一个变量的两种状态

> ID：15704817
> 
> 赞同：0
> 
> 时间：2013-03-29T14:01:48.503
> 
> 标签：javascript, jquery, variables, time, cycle

我的问题既合乎逻辑又与javascript相关。

我的目标是**随着时间的推移为**[**jquery 计数器**](http://sophilabs.github.com/jquery-counter/)提供相同变量的两个状态，以便每 x 秒从开始状态增加到结束状态。

 **在循环结束时，我想让结束状态成为下一个开始状态，依此类推......

请注意，我从 php 文件中检索变量值。（编辑）变量在函数外声明：

```
var $publishersCurvalue,
    $minTime,
    ... 
```

这是我的柜台。它每 5 秒刷新一次。结果，因为我只使用一个变量状态（**$publishersCurvalue**），它从前一个状态跳转到新状态。

如何在每个周期中同时获得前一个值和新值？我已经尝试了几种技术，但到目前为止没有运气。

我的意图是触发计数器读取两个不同值时发生的增量动画。

```
var $i = 0;
function publisherCounter() {
    $.getJSON("counter.php?t=p", function(result) {
        // defalut values
        $minTime                      = result[0].minTime;
        $max                          = result[0].max;
        $curTime                      = result[0].curTime;

        // current value
        $publishersCurvalue           = result[0].curValue;

        // Publishers values
        $publisherMinResult           = result[0].min;
        $publisherIncPerDay           = result[0].incPerDay;

        // frequency
        $publisherIncPerDayResultTemp = parseInt((($curTime - $minTime)/86400) * $publisherIncPerDay);
        $publisherIncPerDayResult     = parseInt(86400/$publisherIncPerDayResultTemp);

        $('#counter_publishers').addClass('counter-analog').counter({
            initial: $publishersCurvalue,
            direction: 'up',
            interval: 1,
            format: '9999999',
            stop: $publishersCurvalue
        });

    });
    $i++;
};
setInterval(publisherCounter, 5000);
publisherCounter(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:09:32.670

从`$publishersCurvalue`一个简单的变量变成一个具有两个属性的对象：

```
// wherever you declare it...
var $publishersCurvalue = {
    prev: 0,
    cur: 0
};

...

// current value
$publishersCurvalue.cur = result[0].curValue;

...

$('#counter_publishers').addClass('counter-analog').counter({
    initial: $publishersCurvalue.prev,
    direction: 'up',
    interval: 1,
    format: '9999999',
    stop: $publishersCurvalue.cur
}); 
```

我不太了解您的意图，因此您可能需要更改对`prev`and的使用`cur`。**

# c++ - 如何删除里面有文件的文件夹

> ID：15704819
> 
> 赞同：-6
> 
> 时间：2013-03-29T14:01:55.020
> 
> 标签：c++

我需要删除一个文件夹，里面有文件..

我需要永久删除文件，所以它们不会进入回收站......

我已经寻找了很多方法，例如 rmdir，虽然它没有识别“rmdir”，即使包含（我试图包含很多我在示例中找到的东西）..

谢谢！

编辑：

我正在使用 Windows 7

我发现了这个：

```
 system("rmdir D:\\temps /s /q"); 
```

尽管我想使用一个包含路径的变量，但它会正确删除文件夹。例如：

```
path = "D:\\temps";
delete(path); 
```

或这种风格的东西..

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-29T14:35:38.800

我用过这个：

```
system(path.c_str()); 
```

path 是一个包含路径的字符串...

在我添加`rmdir`到开始的路径中......

# c++ - C++循环展开编译时间常数小值

> ID：15704824
> 
> 赞同：3
> 
> 时间：2013-03-29T14:02:10.200
> 
> 标签：c++, optimization

我有这两个功能：

```
template<int N>
void fun()
{
    for(int i = 0; i < N; ++i)
    {
        std::cout<<i<<" ";
    }
}

void gun(int N)
{
    for(int i = 0; i < N; ++i)
    {
        std::cout<<i<<" ";
    }
} 
```

我可以假设在第一个版本中，编译器将为每个小的 N（我的意思是 N = {1, 2, 3, 4}）优化循环吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:03:49.290

> 我可以假设在第一个版本中，编译器将为每个小 N 优化循环

这是一个典型的优化，虽然“假设”是一个强词。如果*必须*进行优化，您最终会对任何潜在的优化感到失望。

如果编译器能够内联函数，您的*第二个版本可能会经历相同的优化。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T14:06:43.613

您永远无法保证优化会做什么，但如果有合适的优化级别，您通常可以依靠它做出比手动优化更好的选择。

如果您真的想知道生成了什么代码，您可以随时查看生成的程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T14:06:59.287

这取决于您的优化级别和标志。`-O0 -g`（无优化，启用调试）、`-O3`（积极优化速度）和`-Os`（优化空间）之间存在很大差异。

如今，循环展开不一定是胜利，即使在优化速度时也是如此。太多的代码会导致指令缓存未命中，这将大大超过内联简单循环的加速。像这样的循环中条件分支的成本几乎可以忽略不计，因为分支预测将正确预测除最后一次迭代之外的所有迭代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-29T14:13:08.500

如果编译器可以内联任何一个函数，它也会展开循环，如果它认为这是正确的做法。编译器何时以及如何决定展开循环有好处是一个相当复杂的问题，并且高度取决于其他因素，例如可用寄存器的数量，循环内部发生的情况（我怀疑上面给出的示例，例如, 将从减少循环中涉及的 5 条左右指令中获得很多时间，因为这`cout ...`可能会消耗数千倍的时间 - 编译器是否能解决这个问题是另一回事，但这并不是完全未知让编译器对函数是否小有一定的了解。

另一方面，如果代码看起来像这样：

```
int arr[N];  // Global array. 

template<int N>
int fun()
{
    int sum = 0;
    for(int i = 0; i < N; ++i)
    {
        sum += arr[i];
    }
} 
```

然后我希望编译器展开循环是这样的：

```
 int *tmp = arr;
    sum += *tmp++;
    sum += *tmp++;
    sum += *tmp++;
    sum += *tmp++;
    sum += *tmp++; 
```

假设 N = 5。

这适用于任何对编译器“可见”且 N 在编译时已知的函数。所以，假设`gun`不在不同的源文件中，那么我希望它被内联和展开完全相同`fun`（作为模板函数，必须在这个编译单元中可见）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T14:13:15.447

如果你想更明确一点，你可以使用[Duff 的设备](http://en.wikipedia.org/wiki/Duff%27s_device)，它使用 switch case fallthrough 来展开循环。不过，我不能说它在实践中的效果如何。但是，我想，如果您可以提示编译器将其展开，那会更快。

编译器也非常聪明，虽然它们并非万无一失，但它们的优化选择通常比我们自己的直觉要好。

# javascript - Dojo 增强网格嵌套排序无法排序

> ID：15704833
> 
> 赞同：1
> 
> 时间：2013-03-29T14:02:37.227
> 
> 标签：javascript, sorting, dojo, grid

我正在使用带有分页和嵌套排序插件的 Dojo 增强网格。在网格中，当我单击列标题上的向下箭头时，元素没有正确排序。假设我有：xhar amar Memid1 Memid2 1 2

所以当我对它们进行排序时，它们变成：1 2 Memid1 Memid2 amar xhar

我希望订单是：1 2 amar Memid1 Memid2 xhar 为什么会这样？可以做些什么来避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-02T09:14:29.943

就像 Lucian 说的，你可以编写自己的排序方法。正如您在[文档](http://dojotoolkit.org/reference-guide/1.6/dojox/grid/EnhancedGrid.html)`NestedSorting`中所读到的，您可以通过添加插件来启用自定义排序。您可以通过添加以下内容来做到这一点：

```
dojo.require("dojox.grid.enhanced.plugins.NestedSorting"); 
```

然后你只需要`nestedSorting: true`在你的网格对象上设置属性。

排序本身并不依赖于网格，而是依赖于商店。您可以[在](http://dojotoolkit.org/reference-guide/1.6/dojo/data/ItemFileReadStore.html#custom-sorting). `ItemFileReadStore`你想要做的是这样的：

```
grid.store.comparatorMap = new Object();
grid.store.comparatorMap["col1"] = function(a, b) {
    if (a.toLowerCase() < b.toLowerCase()) {
         return -1;   
    } else if (a.toLowerCase() == b.toLowerCase()) {
        return 0;
    } else {
        return 1;
    }
}; 
```

如您所见，我修改了比较器映射`col1`，您需要将其修改为您需要的列。该函数本身是纯 JavaScript，并且在许多语言中都可以进行比较。如果在排序时字符串 a 应该在字符串 b 之前，则返回一个负数 (-1)，当两个字符串相等时，您需要返回 0，如果字符串 b 应该在字符串 a 之前，则它应该是 1。要启用不区分大小写，您需要比较两个字符串的小写变体。

我用新增的内容更新了我之前的 JSFiddle（上一个问题），并在 Dojo 1.6 下对其进行了测试。结果可以在[这里](http://jsfiddle.net/KDTcC/6/)看到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T22:31:40.300

创建一个只有小写值的列并使用此列进行排序，但不要在网格中显示此列。隐藏此列。小写字母似乎排在大写字母之后，因此您需要将所有内容都设为小写。

另一种可能性是编写您自己的排序方法并将其连接到您的网格。

# wcf - 从 Visual Studio 调用 azure 中托管的 wcf 方法时出现 ProcessGetResponseWebException

> ID：15704835
> 
> 赞同：0
> 
> 时间：2013-03-29T14:02:39.340
> 
> 标签：wcf, azure, visual-studio-2012

我有一个`wcf`托管在 azure 中的 Web 角色，它具有添加、删除更新等的方法。当我单步执行代码`vs2012`并调用 add 方法时，我收到一个 ProcessGetResponseWebException。

add 方法将作业对象作为参数。这是导致问题的唯一方法。任何没有作业对象作为参数的方法都可以正常工作。

该服务使用带有自定义用户名的消息安全性。这不是问题，因为我已经删除了它并且仍然有同样的问题，并且当安全性到位时其他方法也可以工作。

奇怪的是，如果我将客户端安装为服务并启动它，它一切正常，并且没有问题，只有在从 Visual Studio 运行时才会发生。我已经在另一台使用 Visual Studio 2010 的机器上尝试过这个，但它也不起作用。

当我从 vs 调用 add 方法然后登录到 azure 虚拟机时，我可以看到 IIS 正在使用 100% 的 cpu。

绑定是正确的，因为我已经完成了它们，所有消息大小都设置为最大值，超时设置为 10 分钟。我什至从正在运行的服务中复制了配置以防万一，但它仍然无法正常工作。

我更改了 add 方法以将字符串作为参数并且它可以工作，因此它与传递的作业对象有关，但无法弄清楚它是什么并且混淆了为什么它在作为服务安装时工作。

我启用了智能跟踪，但没有显示任何异常。

有人对我下一步可以尝试什么有任何建议吗？

```
Server stack trace: 
   at System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
   at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
   at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Channels.ClientReliableChannelBinder`1.RequestClientReliableChannelBinder`1.OnRequest(TRequestChannel channel, Message message, TimeSpan timeout, MaskingMode maskingMode)
   at System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout, MaskingMode maskingMode)
   at System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Security.SecuritySessionClientSettings`1.SecurityRequestSessionChannel.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at MobileJobs.CloudService.IJobService.AddJob(Job newJob)
   at MobileJobs.CloudService.JobServiceClient.AddJob(Job newJob) in 
```

# jquery - 当 div 高度大于 1051px 时显示 scoll 图像

> ID：15704838
> 
> 赞同：0
> 
> 时间：2013-03-29T14:02:56.297
> 
> 标签：jquery, image, html, height

我有一个包含动态内容的 div。某些页面的内容比另一个页面多...

我想做一个功能，当我的窗口（div）有一个滚动条（更多内容）时，你会在屏幕上看到一个显示箭头的图像......这样用户就知道他可以滚动......

我已经有了这个功能：

```
<script type="text/javascript">
$(window).load(function(){alert($('#scroller').height());})

if ( $('#scroller').height() < 1051) {

}
else {
   document.write('<div class="scroll"><p><img src="http://www.website.nl/showroom/pijl.gif" alt=""/></p></div>');
}

</script> 
```

有了这个CSS：

```
#scroller
{
    height:auto;
} 
```

应该可以工作，但它不起作用......警报确实显示了 div 的高度，但是当 de div 高度超过 1051px 时，它没有做任何事情......

有人可以帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:09:04.027

页面呈现后，您无法 document.write。您将需要使用 jquery 的 dom 操作方法来创建元素。

将您的 document.write 替换为：

`$('body').append('<div class="scroll"><p><img src="http://www.website.nl/showroom/pijl.gif" alt=""/></p></div>');`

# sql - 如何在另一个过程中使用存储过程中的参数

> ID：15704840
> 
> 赞同：0
> 
> 时间：2013-03-29T14:02:59.343
> 
> 标签：sql, stored-procedures

我创建了一个在线员工名单应用程序。我对一周中的每一天都有一个存储过程，其中包含`Rota`表的自动增量主键。所选周内的每一天都将具有与外键相同`rota ID`的外键。

我对选定的第一天没有任何问题，但接下来的几天为外键返回 NULL，`RotaID`因为我不知道如何将其传递`RotaID`到其他存储过程中以确保`RotaID`每周 7 天的值保持不变`Rota`。

```
CREATE PROCEDURE [usp_RotaDay1]

@Week_Begin datetime, 
@Week_End datetime,

@1ShiftDate datetime,
@1Day nchar (10),

AS
BEGIN
SET NOCOUNT ON;

DECLARE @RotaID int
IF NOT EXISTS 
(
SELECT * FROM Rota 
WHERE Week_Begin = @Week_Begin
AND
Week_End = @Week_End
)
BEGIN

INSERT INTO Rota
 (
 [Week_Begin], 
 [Week_End]
 )

VALUES
 (
 @Week_Begin,
 @Week_End
 )
END

SELECT @RotaID = SCOPE_IDENTITY()
IF NOT EXISTS 
(
SELECT * FROM DayShift
WHERE ShiftDate = @1ShiftDate
)
BEGIN

INSERT INTO DayShift

 (
 [RotaID],
 [ShiftDate],
 [Day]
 )

 VALUES
 (
 @RotaID,
 @1ShiftDate,
 @1Day
 )
END

SET NOCOUNT OFF;
END 
```

如您所见，我`RotaID`在表中声明，`Rota`然后作为表中的外键传递`DayShift`。

我想知道是否可以将其传递给与此类似的其他存储过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:08:12.807

我不确定您到底要做什么，但是如果您想将`@RotaID`参数值返回给调用程序以在将来的过程调用中使用，您可以将参数指定为`OUTPUT`：

```
CREATE PROCEDURE [usp_RotaDay1]
(
    @Week_Begin datetime, 
    @Week_End datetime,

    @1ShiftDate datetime,
    @1Day nchar (10),
    @RotaID int OUTPUT
)
AS
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:09:24.510

在每个辅助存储过程中，您需要使用 select 语句检索主键 ID。您知道所有辅助程序的周开始和周末，对吗？所以你知道要提取哪一行来检索 id。希望我说得通。

# ruby - 如何编写一个紧凑的卡片组生成器？

> ID：15704846
> 
> 赞同：-1
> 
> 时间：2013-03-29T14:03:27.793
> 
> 标签：ruby

我正在写一个卡片组生成器，这是我想出的解决方案，但我发现它跨越了多行并且看起来不太好，还有其他方法可以构建这张卡片吗？

```
deck = []
'23456789TJQKA'.each_char do |rank|
  'SHDC'.each_char do |suit|
    deck << rank + suit
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T14:11:12.320

您可以使用`Array#product`从两个数组生成笛卡尔积。

```
# ruby 2.0
deck = '23456789TJQKA'.chars.product('SHDC'.chars).map{|a| a.join}

# ruby 1.9
deck = '23456789TJQKA'.split(//).product('SHDC'.split(//)).map{|a| a.join} 
```

正如**DNNX**评论的那样，您可以使用`.map(&:join)`来获得更短的。

但是，我认为编写清晰的程序比编写紧凑的程序要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:25:01.993

作为使用块变体的示例`product(other_ary, ...) { |p| block }`

```
deck = []
'23456789TJQKA'.split('').product('SHDC'.split('')){|el| deck << el.join} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:29:55.047

正如 Arie 建议的那样，编写一个清晰的程序比编写一个更短的程序要好。我认为这个很简单：

```
deck = %w(2S 2H 2D 2C
          3S 3H 3D 3C
          4S 4H 4D 4C
          5S 5H 5D 5C
          6S 6H 6D 6C
          7S 7H 7D 7C
          8S 8H 8D 8C
          9S 9H 9D 9C
          TS TH TD TC
          JS JH JD JC
          QS QH QD QC
          KS KH KD KC
          AS AH AD AC) 
```

*只是在开玩笑。*

# jquery - 如何动态设置滚动高度？

> ID：15704854
> 
> 赞同：2
> 
> 时间：2013-03-29T14:04:02.750
> 
> 标签：jquery, css, scroll

我有一个高度为 1200px 和浏览器窗口宽度的 div。就在该 div 下方，我有另一个高度为 1000px 的 div。现在向下滚动时，您将能够滚动到第二个 div 的末尾。我想要的是设置滚动高度，所以例如我想说你应该只能滚动 1200px。这样我的第二个 div 就不会对访问者可见。有什么方法可以用 JQuery 实现这一点吗？

**我上传了一张强调我的问题的图片：**

![在此处输入图像描述](../Images/ad9560d2dc47b766502e2e060059425f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:29:21.547

如果用户滚动得太远，您可以处理`window.onscroll`，防止事件传播并将它们发送回他们要查看的位置：

[jsFiddle](http://jsfiddle.net/wYng7/)

```
window.onscroll = function (e) {
    var maxViewableHeight = 1400;
    if (document.body.scrollTop + window.innerHeight > maxViewableHeight) {
    console.log(document.body.scrollTop + window.innerHeight);
        e.preventDefault;
        document.body.scrollTop = maxViewableHeight - window.innerHeight;
        return false;
    }
} 
```

## 更新

这是一个对跨浏览器更友好的版本，在 Chrome 25、Firefox 19、IE10/IE9、Safari 5、Opera 12 中进行了测试。在 IE、Safari 和 Opera 中它有点反弹。尤其是 Opera，因为它华丽的平滑滚动，让我更加欣赏 Firefox，因为它具有平滑的滚动并且非常完美。

```
window.onscroll = function (e) {
    var maxViewableHeight = 1400,
        scrollTop = getScrollTop();
    if (scrollTop + window.innerHeight > maxViewableHeight) {
        e.preventDefault();
        window.scrollTo(0, maxViewableHeight - window.innerHeight);
        return false;
    }
}

function getScrollTop() {
    if (typeof window.pageYOffset !== 'undefined') {
        return window.pageYOffset;
    }
    var body = document.body,
        docElement = document.documentElement;
    docElement = (docElement.clientHeight) ? docElement : body;
    return docElement.scrollTop;
} 
```

# java - 从Java中的不同类检索变量

> ID：15704856
> 
> 赞同：0
> 
> 时间：2013-03-29T14:04:23.267
> 
> 标签：java, class

所以我试图在一个类中创建一个变量，然后在另一个类中检索它......

一类是产品，另一类是数量，我需要从文本框中获取值，然后将项目的成本乘以数量。

无论如何，我都不是 Java 专家，我似乎无法让它发挥作用。

没有进一步的工作，这是我正在使用的代码：

超市类：

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;
import java.text.DecimalFormat;

public class SuperMarket extends JFrame
{
   private ProductPanel routine;       // A panel for routine charge check boxes
   private QuantityPanel nonRoutine;   // A panel for non-routine charges
   private JPanel buttonPanel;         // A panel for the buttons
   private JButton calcButton;         // Calculates everything
   private JButton exitButton;         // Exits the application

   public SuperMarket()
   {
      // Display a title.
      setTitle("Supermarket");

      // Specify what happens when the close button is clicked.
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

      // Create a RoutinePanel object.
      routine = new ProductPanel();

      // Create a NonRoutinePanel object.
      nonRoutine = new QuantityPanel();

      // Build the panel that contains the buttons.
      buildButtonPanel();

      // Add the panels to the content pane.
      add(routine, BorderLayout.WEST);
      add(nonRoutine, BorderLayout.EAST);
      add(buttonPanel, BorderLayout.SOUTH);

      // Pack and display the window.
      pack();
      setVisible(true);
   }

   private void buildButtonPanel()
   {
      // Create a button to calculate the charges.
      calcButton = new JButton("Calculate Charges");

      // Add an action listener to the button.
      calcButton.addActionListener(new CalcButtonListener());

      // Create a button to exit the application.
      exitButton = new JButton("Exit");

      // Add an action listener to the button.
      exitButton.addActionListener(new ExitButtonListener());

      // Put the buttons in their own panel.
      buttonPanel = new JPanel();
      buttonPanel.add(calcButton);
      buttonPanel.add(exitButton);
   }

   private class CalcButtonListener implements ActionListener
   {

      public void actionPerformed(ActionEvent e)
      {
         double totalCharges; // Total charges

         // Create a DecimalFormat object to format output.
         DecimalFormat dollar = new DecimalFormat("#,##0.00");

         // Calculate the total charges
         totalCharges = routine.getCharges();

         // Display the message.
         JOptionPane.showMessageDialog(null, "Total Charges: $" + 
                                             dollar.format(totalCharges));
      }
   }

   private class ExitButtonListener implements ActionListener
   {
      public void actionPerformed(ActionEvent e)
      {
         System.exit(0);
      }
   }

   public static void main(String[] args)
   {
      SuperMarket ja = new SuperMarket();
   }
} 
```

ProductPanel 类

```
import java.awt.*;
import javax.swing.*;
import java.text.DecimalFormat;

public class ProductPanel extends JPanel
{
   // Named constants for charges
    private QuantityPanel nonRoutine;

   private final double BAKED_BEAN_CHARGE = 0.35;
   private final double CORNFLAKE_CHARGE = 1.75;
   private final double SUGAR_CHARGE = 0.75;
   private final double TEA_BAGS_CHARGE = 1.15;
   private final double INSTANT_COFFEE_CHARGE = 2.50;
   private final double BREAD_CHARGE = 1.25;
   private final double SAUSAGES_CHARGE = 1.30;
   private final double EGGS_CHARGE = 1.30;
   private final double MILK_CHARGE = 1.30;
   private final double POTATOES_CHARGE = 1.30;

   private JCheckBox bakedBean;     // Check box for oil change
   private JCheckBox cornFlake;       // Check box for lube job
   private JCheckBox sugar; // Check box for radiator flush
   private JCheckBox teaBags;    // Check box for transmission flush
   private JCheckBox instantCoffee;    // Check box for inspection
   private JCheckBox bread;       // Check box for muffler replacement
   private JCheckBox sausages;  // Check box for tire rotation
   private JCheckBox eggs;  // Check box for tire rotation
   private JCheckBox milk;  // Check box for tire rotation
   private JCheckBox potatoes;  // Check box for tire rotation

   /**
      Constructor
   */

   public ProductPanel()
   {
      // Create a DecimalFormat object.
      DecimalFormat dollar = new DecimalFormat("#,##0.00");

      // Create the check boxes.
      bakedBean = new JCheckBox("Baked Beans ($" +
                                dollar.format(BAKED_BEAN_CHARGE) + ")");
      cornFlake = new JCheckBox("Cornflakes ($" +
                              dollar.format(CORNFLAKE_CHARGE) + ")");
      sugar = new JCheckBox("Sugar ($" + 
                                    dollar.format(SUGAR_CHARGE) + ")");
      teaBags = new JCheckBox("Tea Bags ($" + 
                                 dollar.format(TEA_BAGS_CHARGE) + ")");
      instantCoffee = new JCheckBox("Instant Coffee ($" + 
                                 dollar.format(INSTANT_COFFEE_CHARGE) + ")");
      bread = new JCheckBox("Bread ($" + 
                              dollar.format(BREAD_CHARGE) + ")");
      sausages = new JCheckBox("Sausages ($" + 
              dollar.format(SAUSAGES_CHARGE) + ")");

      eggs = new JCheckBox("Eggs ($" + 
              dollar.format(EGGS_CHARGE) + ")");

      milk = new JCheckBox("Milk ($" + 
              dollar.format(MILK_CHARGE) + ")");

      potatoes = new JCheckBox("Potatoes ($" + 
              dollar.format(POTATOES_CHARGE) + ")");

      // Create a GridLayout manager.
      setLayout(new GridLayout(10, 1));

      // Create a border.
      setBorder(BorderFactory.createTitledBorder("Food Product"));

      // Add the check boxes to this panel.
      add(bakedBean);
      add(cornFlake);
      add(sugar);
      add(teaBags);
      add(instantCoffee);
      add(bread);
      add(sausages);
      add(eggs);
      add(milk);
      add(potatoes);
   }

   /**
      The getCharges method calculates the routine charges.
      @return The amount of routine charges.
   */

   public double getCharges()
   {
      double charges = 0;

      if (bakedBean.isSelected())
          charges += BAKED_BEAN_CHARGE * 1;
      if (cornFlake.isSelected())
         charges += CORNFLAKE_CHARGE;
      if (sugar.isSelected())
         charges += SUGAR_CHARGE;
      if (teaBags.isSelected())
         charges += TEA_BAGS_CHARGE;
      if (instantCoffee.isSelected())
         charges += INSTANT_COFFEE_CHARGE;
      if (bread.isSelected())
         charges += BREAD_CHARGE;
      if (sausages.isSelected())
          charges += SAUSAGES_CHARGE;
      if (eggs.isSelected())
          charges += EGGS_CHARGE;
      if (milk.isSelected())
          charges += MILK_CHARGE;
      if (potatoes.isSelected())
          charges += POTATOES_CHARGE;

      return charges;
   }
} 
```

数量面板类

```
import java.awt.*;
import javax.swing.*;

public class QuantityPanel extends JPanel
{   
   public JTextField beans;  // Parts charges
   private JTextField cornFlakes;  // Hours of labor
   private JTextField sugar;  // Hours of labor
   private JTextField teaBags;  // Hours of labor
   private JTextField instantCoffee;  // Hours of labor
   private JTextField bread;  // Hours of labor
   private JTextField sausages;  // Hours of labor
   private JTextField eggs;  // Hours of labor
   private JTextField milk;  // Hours of labor
   private JTextField potatoes;  // Hours of labor

   public QuantityPanel()
   {
      beans = new JTextField("0", 4);
      double beanQuantity = Double.parseDouble(beans.getText());
      cornFlakes = new JTextField("0", 4);
      sugar = new JTextField("0", 4);
      teaBags = new JTextField("0", 4);
      instantCoffee = new JTextField("0", 4);
      bread = new JTextField("0", 4);
      sausages = new JTextField("0", 4);
      eggs = new JTextField("0", 4);
      milk = new JTextField("0", 4);
      potatoes = new JTextField("0", 4);

      // Create a GridLayout manager.
      setLayout(new GridLayout(10, 1));

      // Create a border.
      setBorder(BorderFactory.createTitledBorder("Quantity"));

      // Add the labels and text fields to this panel.
      add(beans);
      add(cornFlakes);
      add(sugar);
      add(teaBags);
      add(instantCoffee);
      add(bread);
      add(sausages);
      add(eggs);
      add(milk);
      add(potatoes);
   }
} 
```

正如您在 Quantity 类上看到的那样，我尝试创建一个从文本字段获取值的双精度数，并且我尝试在可以看到 BAKED_BEAN_CHARGE * 1 的地方检索它，但是我需要的是 * 1 而不是用户文本字段输入。

任何帮助表示赞赏，欢呼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:15:02.757

这里的问题是范围：您正在构造函数中创建一个新变量。

在构造函数之外获取双 beanQuantity 声明，然后使用文本字段输入对其进行初始化。

将您的 beanQuantity 作为类变量，您可以创建一个方法来在需要时随时返回它（getter）。

您可以`private double beanQuantity;`在最后一个 JTextField 正下方调用它，然后创建一个方法`public double getBeanQuantity() { return beanQuantity; }` ，只需确保在您的构造函数中删除双关键字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:16:58.970

首先，您需要将您的 QuantityPanel 传递到您的 ProductPanel 构造函数中，以便您可以设置您拥有存根的成员变量。为此，请更改您的 SuperMarket 构造函数：

```
 // Create a NonRoutinePanel object.
  nonRoutine = new QuantityPanel();

  // Create a RoutinePanel object.
  routine = new ProductPanel( nonRoutine ); 
```

然后像这样修改 ProductPanel 中的构造函数：

```
public ProductPanel( QuantityPanel nonRoutine ) {
    this.nonRoutine = nonRoutine;
    ... 
```

您需要移动此行：

```
double beanQuantity = Double.parseDouble(beans.getText()); 
```

到一个方法：

```
public double getBeanQuantity() {
    return Double.parseDouble( beans.getText() );
} 
```

然后在您的产品面板中，您可以这样使用它：

```
...
if (bakedBean.isSelected())
    charges += BAKED_BEAN_CHARGE * nonRoutine.getBeanQuantity();
... 
```

# javascript - 基于纯 Javascript 的 jabber 客户端

> ID：15704861
> 
> 赞同：3
> 
> 时间：2013-03-29T14:04:40.827
> 
> 标签：javascript, xmpp, strophe

我们正在开发一个与&一起使用的`HTML5`聊天客户端。后面的 js 文件在运行时会在 DOM 中注入一个 swf 文件。它通过这个闪存试图克服 JavaScript 的同源策略问题。`strophe.js``flxhr.js``strophe.flxhr.js`

我们还打算通过触摸设备、iOS 和 Android 以及台式机访问这个聊天客户端。很明显，现代设备没有可用的闪存，如果桌面浏览器禁用了闪存播放器，那么这种方法将不起作用。

任何人都可以建议一种替代方法来开发纯 JavaScript Jabber 客户端，或者是否有其他方法可以使用 strophe.js 或其变体来实现这一目标。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T16:05:48.913

我在大多数安装中使用 Apache 和 mod_proxy 来克服 XHR 限制。Candy 开发人员在这里有很好的配置示例：http: [//candy-chat.github.com/candy/](http://candy-chat.github.com/candy/)

如果您的站点上没有运行 Apache，大多数其他网络服务器也有代理模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:16:56.363

我不是 jabber 专家，但是几分钟的谷歌搜索让我找到了 XMPP 客户列表。我建议使用或从其中之一开始：http: [//xmpp.org/xmpp-software/clients/](http://xmpp.org/xmpp-software/clients/)

注意：列表中有几个基于Web的客户端，例如：[http ://candy-chat.github.com/candy/](http://candy-chat.github.com/candy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:22:11.723

flXHR 和其他用于跨浏览器 ajax 的 flash 产品可以正常工作，并且仍然可以为不受您控制的 3rd 方服务器发挥作用。

但是，在这种情况下，服务器听起来像是在您的控制之下，因此您现在可以采用“跨域资源共享”（CORS）方法。

我不会尝试描述 CORS，但这里有一个链接：

[https://www.bionicspirit.com/blog/2011/03/24/cross-domain-requests.html](https://www.bionicspirit.com/blog/2011/03/24/cross-domain-requests.html)

网上有很多关于 CORS 的内容。上面的文章是一个特别好的起点，因为它专门讨论了 CORS 作为 flXHR 的替代方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:13:03.670

您对 XMPP 以外的选项持开放态度吗？

我们一直在自己玩 www.pubnub.com 以获得类似的东西。它不是免费的，但会给你一个可以在桌面和移动设备上运行的纯 JavaScript。

[http://blog.pubnub.com/build-real-time-chat-10-lines-code/](http://blog.pubnub.com/build-real-time-chat-10-lines-code/)可能特别感兴趣，或者[http://blog.pubnub.com/html5-websockets-beautiful-real-time -chat-on-mobile-using-pubnubs-channel-presence/](http://blog.pubnub.com/html5-websockets-beautiful-real-time-chat-on-mobile-using-pubnubs-channel-presence/)再举一个例子。

# bash - 文本文件中给出的 vimdiff 文件

> ID：15704864
> 
> 赞同：1
> 
> 时间：2013-03-29T14:04:53.283
> 
> 标签：bash, diff

我有一个`files.txt`包含以下条目的文本文件

```
"/home/dilawar/a.txt","/home/dilawar/b.txt"
"/home/dilawar/aa.txt","/home/dilawar/bb.txt" 
```

现在我希望看到第`diff`1 行的文件。我尝试了以下

```
head -n 1 files.txt | cut -d, -f 2,3 | sed "s/,/\t/g" | xargs -I files vimdiff files 
```

它不工作。我用 diff 替换了 vimdiff，它也不起作用。然而这有效

```
head -n 1 files.txt | cut -d, -f 1 | xargs -I file vim file 
```

如何`file`作为参数传递给 diff 作为两个单独的文件路径而不是单个字符串？

PS：更糟糕的是，我在一些文件路径中有空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:32:54.270

首先取第一行，然后用空格替换符号，并`vimdiff`通过子外壳将其输入。

```
 vimdiff $(head -1 files.txt | tr '",' ' ') 
```

上述优雅的方法不适用于带有空格的名称。下面肮脏的会。

```
awk -F, 'NR==1{print "vimdiff",$1,$2}' files.txt | bash 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T15:00:37.280

我还转义了文件路径中的空格（第一个 sed 命令）

```
 head -n 1 files.txt | sed "s/ /\\\\ /g" | sed "s/[\",]/ /g" |xargs vimdiff 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:27:29.773

试试这个，看看有没有帮助

```
sed '1{s/,/ /; s/^/diff /;q}' files.txt|sh 
```

# ruby-on-rails - Rake db:migrate 和生成的 HTML 没有改变

> ID：15704865
> 
> 赞同：0
> 
> 时间：2013-03-29T14:04:58.497
> 
> 标签：ruby-on-rails

我对 RoR 和构建我的第一个应用程序非常陌生。我`rails generate scaffold`在数据库中使用并创建了一个表。当然我做错了，想对表进行更改，通过重写生成的迁移文件来做到这一点。我认为`rake db:migrate`工作正常，因为它正在更新我的架构，但网站上没有可见的更改。表格的视图没有改变，虽然机制不同，但我现在无法添加任何内容，因为我更改它们后找不到合适的列。我不知道如何在不自己重写视图文件的情况下修复它。有可能吗，我想我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:10:07.087

您有两个选择，要么销毁您创建的脚手架，要么`rails destroy scaffold ModelName`手动更改视图。当您运行时`rake db:migrate`，它不会在视图中执行任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:24:05.913

您可以撤消/销毁脚手架`rails destroy scaffold scaffold_name`，然后使用您在迁移文件中添加的列重新生成脚手架。仅供参考，编辑迁移文件不是一个好习惯。

# python - python线程立即退出

> ID：15704871
> 
> 赞同：0
> 
> 时间：2013-03-29T14:05:20.097
> 
> 标签：python

我是 python 新手。

我正在尝试`Hbase thrift client using thrift`。我在网上得到了一些代码，我只是修改它以使用最新版本，`thrift`但是当我运行代码时，它只是退出，没有启动线程。

这是代码。

```
import json, traceback, sys, datetime, time, logging, threading, random
import logging.handlers

import thrift
sys.path.append('gen-py')

from thrift.transport.TSocket import TSocket
from thrift.transport.TTransport import TBufferedTransport
from thrift.protocol import TBinaryProtocol
from hbase import THBaseService

gWritenItems = 0
gStartT = 0
gEndT = 0

recordsPerBatch = 300 #reports per client per day
columns = 3

#config
concurrent = 10
records = 60000#6000000 #6 million
bytesPerRecord = 1024

mylock = threading.RLock()
class writeThread(threading.Thread):
    def __init__(self, threadname, RecordsThreadwillwrite):
        threading.Thread.__init__(self, name = threadname)
        bytesPerColumn = int(bytesPerRecord/columns) - 11 #suppose 3 columns

        self.columnvalue = "value_" + "x"*bytesPerColumn + "_endv"
        self.tbwBatch = int (RecordsThreadwillwrite / recordsPerBatch)

        self.transport = TBufferedTransport(TSocket('pnq-adongrevm1', 5151), 40960)
        self.transport.open()
        protocol = TBinaryProtocol.TBinaryProtocol(self.transport)

        self.client = THBaseService.Client(protocol)
        self.table = "example"

    def run(self):
        print "+%s start" % (self.getName())
        global gEndT
        global gWritenItems           

        threadWritenItem = 0
        for loopidx in xrange(0, self.tbwBatch):            
            self.write_hbase() #write                                           
            threadWritenItem += recordsPerBatch   

        mylock.acquire()
        gEndT = time.time()  
        gWritenItems += threadWritenItem
        print "%s done, %s seconds past, %d reocrds saved" % (self.getName(), gEndT-gStartT, gWritenItems)
        mylock.release()
        self.transport.close()                   

    def write_hbase(self): #write 50 rowkyes, and  3 column families in each rowkey
        print self.getName(), "Start write"
        batchmutations = []
        for i in xrange(0, recordsPerBatch): # write to db, 300 items together
            mutations = []
            rowkey = "RK_%s_%s" % (random.random(), time.time())       
            for ii in xrange(0, columns):
                mutations.append(THBaseService.TPut(row=rowkey, columnValues=[TColumnValue(family="f1", qualifier="%s"%ii, value=self.columnvalue)]))
        self.client.putMultiple(self.table,mutations)        

itemsPerThread = int(records / concurrent)
for threadid in xrange(0, concurrent):    
    gStartT = time.time()
    t = writeThread("Thread_%s" % threadid, itemsPerThread)
    t.start();
print "%d thread created, each thread will write %d records" % (concurrent, itemsPerThread) 
```

我只是收到一条消息`10 thread created, each thread will write 6000 records`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T14:20:58.117

是的，这是因为你没有等待线程完成它们的工作，所以主线程就退出了。尝试这个：

```
itemsPerThread = int(records / concurrent)
threads = []
for threadid in xrange(0, concurrent):    
    gStartT = time.time()
    t = writeThread("Thread_%s" % threadid, itemsPerThread)
    t.start();
    threads.append(t)

# wait until all finish the job
for t in threads:
    t.join() 
```

**编辑**哈，我不认为我在这里，因为你没有将你的线程标记为守护进程。即使没有加入它也应该工作。但是看看这段代码：

```
class CustomThread(threading.Thread):
    def run(self):
        print "test"

for x in xrange(0, 10):
    t = CustomThread()
    t.start() 
```

`print "test"`无论如何，它总是会达到线。`print "+%s start" % (self.getName())`因此，在您的代码中，无论如何它都应该始终达到。你确定它不起作用？:)

如果没有，那么只有两种可能：

1.  您的方法中存在阻塞操作和/或异常`__init__`。但后来它无法达到最终印刷；
2.  `concurrent`变量是`0`出于某种原因（这与最终打印不一致）。

# javascript - 测试用户是否可以在 html 页面上看到元素

> ID：15704872
> 
> 赞同：9
> 
> 时间：2013-03-29T14:05:20.980
> 
> 标签：javascript, jquery, browser

有什么方法可以知道某个元素在 html 页面上是否可见？

像这样：

![在此处输入图像描述](../Images/ed84343a28dc974f2f0756a910bbc8b1.png)

考虑到水平/垂直滚动位置、浏览器窗口的宽度/高度以及页面上元素的位置/大小，可能可以做到这一点，但我对 jQuery 的经验很少，所以我不知道该怎么做. 并且可能有一个可以调用的简单函数，我不知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T14:06:33.610

您可以使用`.is(':visible')`选择器来检查元素当前是否在 DOM 中可见。

**编辑：**

但是，正如@BenM 所提到的，这不会检查您页面上的元素是否实际上超出了您的可滚动范围 - 在这种情况下您可以使用的一个很棒的小插件是[Viewport Selectors for jQuery](http://www.appelsiini.net/projects/viewport)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:09:52.977

这是我用来执行此操作的一些代码。它已经过测试，效果很好。

```
function isVisible($obj) {
    var top = $(window).scrollTop();
    var bottom = top + $(window).height();
    var objTop = $obj.offset().top;
    var objBottom = objTop + $obj.height();

    if(objTop < bottom && objBottom > top) {
        //some part of $obj is visible on the screen.
        //does not consider left/right, only vertical.
    }
} 
```

# python - 关于上传和安全的菜鸟问题

> ID：15704873
> 
> 赞同：0
> 
> 时间：2013-03-29T14:05:35.477
> 
> 标签：python, google-app-engine

我的 Windows C:\myap 目录中有 myapp.py 和 app.yaml。文档说要使用：appcfg.py update myapp/

上传应用程序。

我已经下载/安装了 Python 和 Google python 工具包。

抱歉，对于这些无聊的问题，但是：

1.  上面列出的 myapp/ 是指我的 Windows 机器上的 c:\myapp 吗？或者它是我在谷歌方面的应用程序的名称？
2.  如何/在哪里键入 appcfg.py 来上传我的目录？
3.  使用我的 gmail 帐户和电子邮件地址是否存在任何安全问题？
4.  我希望《第二人生》中的任何人都能够在现实世界中调用它。每周大约会有十几个电话。他们是否必须使用我的电子邮件/密码进行身份验证才能使用它？

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T23:30:22.907

1.  由于您在 C:\myap 中有应用程序，因此您需要运行`appcfg.py update C:\myap`. 这只是您机器上的应用程序的路径。
2.  在 Windows 命令行中。例如，`"C:\Program Files (x86)\Google\google_appengine\appcfg.py" update C:\myap`
3.  不，appcfg 在上传时使用 SSL。它是安全的。
4.  如果您的意思是调用应用程序上传 - 这并不安全。我不知道你为什么需要这个。您可以在 App Engine 管理控制台中添加应用程序开发人员，以便他们能够从他们的帐户部署应用程序。

# r - 查找模式中的最后一个数据点

> ID：15704875
> 
> 赞同：1
> 
> 时间：2013-03-29T14:05:52.760
> 
> 标签：r, time-series

给定以下数据集和代码，我可以找到模式中的第一个数据点，但是如何找到模式中的最后一个数据点？

```
d<-read.table(text='Date.Time Aerial
794  "2012-10-01 08:18:00"      1
795  "2012-10-01 08:34:00"      1
796  "2012-10-01 08:39:00"      1
797  "2012-10-01 08:42:00"      1
798  "2012-10-01 08:48:00"      1
799  "2012-10-01 08:54:00"      1
800  "2012-10-01 08:58:00"      1
801  "2012-10-01 09:04:00"      1
802  "2012-10-01 09:05:00"      1
803  "2012-10-01 09:11:00"      1
1576 "2012-10-01 09:17:00"      2
1577 "2012-10-01 09:18:00"      2
804  "2012-10-01 09:19:00"      1
805  "2012-10-01 09:20:00"      1
1580 "2012-10-01 09:21:00"      2
1581 "2012-10-01 09:23:00"      2
806  "2012-10-01 09:25:00"      1
807  "2012-10-01 09:32:00"      1
808  "2012-10-01 09:37:00"      1
809  "2012-10-01 09:43:00"      1', header=TRUE, stringsAsFactors=FALSE, row.names=1) 
```

我能够找到一个模式并识别该模式中的第一个数据点：

```
require(zoo)
##Pattern
pat <- c(1,1,2,2)
##Find pattern    
count<- function(fish,pat){x <- rollapply(fish$Aerial, length(pat), FUN=function(x)     all(x == pat))

                       fish[which(x),]
}                   
##call function
count(d,pat) 
```

这将打印找到模式的第一个数据点：

```
 count(d,pat)
          Date.Time Aerial
802 2012-10-01 09:05:00      1
804 2012-10-01 09:19:00      1 
```

如何打印模式中的最后一个数据点？

调整后的函数将打印：

```
 Date.Time Aerial
802 2012-10-01 09:18:00      2
804 2012-10-01 09:23:00      2 
```

对于给定的数据。

我以各种方式尝试了tail（）但无济于事

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:09:41.000

将函数中的行更改为：

```
fish[which(x),] 
```

到

```
fish[which(x) + length(pat) - 1,] 
```

# sql - 为什么我的 SELECT 查询在 Web 服务器上运行的时间比在数据库本身上运行的时间长得多？

> ID：15704878
> 
> 赞同：1
> 
> 时间：2013-03-29T14:06:16.870
> 
> 标签：sql, select, coldfusion, ibm-midrange

我正在运行以下设置：

物理服务器 Windows 2003 Standard Edition R2 SP2 IIS 6 ColdFusion 8 使用 JT400 驱动程序到 iSeries AS400 的 JDBC 连接

我正在对数据库中的文件运行一个简单的 SQL 查询：

```
SELECT
    column1,
    column2,
    column3,
    ....
FROM    LIB/MYFILE 
```

没有条件。

该文件有 81 列 - aplhanumeric 和 numeric - 以及大约 16,000 条记录。

当我使用 STRSQL 命令在模拟器中运行查询时，查询会立即返回。

当我在我的 Web 服务器上运行查询时，大约需要 30 秒。

为什么会发生这种情况，有什么办法可以减少这个时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T17:29:31.203

虽然我无法解决您的 Web 服务器可能涉及的任何开销，但我可以说还有几个其他因素需要考虑：

这可能主要是因为两个系统接口工作方式的不同。

您的交互式 STRSQL 会话将在收到前几页数据后立即开始显示结果。您可以向下翻页浏览该初始数据，但通常在某些时候您会在屏幕底部看到一条状态消息，指示它现在正在获取更多数据。

我假设您的 Web 服务器正在等待，直到它接收到整个结果集。它希望在构建 HTML 页面之前获取所有数据，然后再发送页面。因此，您自然会等待更长的时间。

如果这不是您的 Web 服务器应用程序的工作方式，那么很可能是[JT400 JDBC 属性](http://pic.dhe.ibm.com/infocenter/iseries/v7r1m0/index.jsp?topic=%2Frzahh%2Fjdbcproperties.htm)问题。

如果您覆盖了任何默认设置，请确保这些设置是适当的。

在某些情况下，OPTIMIZATION_GOAL 设置可能是一个因素。但是，如果您直接按物理顺序读取表（又名物理文件或 PF），没有任何索引或键，那么这可能不适用于这里。

您的交互式 STRSQL 会话将默认设置为 *FIRSTIO，这意味着查询已针对快速返回第一页数据进行了优化，这与其工作方式相对应。

您的 JDBC 连接将默认为“0”的“查询优化目标”，这将转换为 *ALLIO 的 OPTIMIZATION_GOAL 设置，除非您使用扩展的动态包。*ALLIO 意味着优化器将尽量减少返回整个结果集所需的时间，而不仅仅是第一页。

或者，也许首先尝试简单地添加`FOR READ ONLY`到 SELECT 语句的末尾。

## 更新：更高级的解决方案

作为构建网页的一部分，您可以绕过等待整个结果集发送的延迟。

向浏览器发送一个没有任何记录或有限记录的网页，但使用**AJAX**代码在后台加载其余数据。

尽可能使用大块提取，以在一个剪辑中抓取大量行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:49:35.103

您需要记住一件事，i 保存它在作业中创建的访问路径，以防再次需要它们。这意味着如果您注销并重新登录然后运行您的查询，它应该需要更长的时间来运行，然后您第二次运行查询它会更快。在 Web 应用程序中运行查询时，您可能会或可能不会重用作业，这意味着必须重建访问路径。

如果速度很重要。我会：

1.  [研究优化](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=%2Frzajq%2Fqodm.htm)查询。我知道有更好的资源，但我现在找不到它们。
2.  创建一个存储过程。存储过程保存创建的访问路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:53:58.957

只有 16000 行，没有 WHERE 或 ORDER BY 这个东西应该尖叫。分解问题以帮助诊断瓶颈所在。回到 IBM i，在 SQL 命令行中运行查询，然后使用 B、BOT 或 BOTTOM 命令告诉数据库显示最后一行。这将迫使数据库咳出整个 16k 结果集，并让您更好地了解 IBM 方面的原始性能。如果效果不佳，请让 IBM 管理员运行 Navigator 并为您监控性能。这可能是出乎意料的，例如“表”实际上是一个视图，而您选择的列可能是用户定义的函数。

如果 IBM 方面的性能还可以，那么看看 Cold Fusion 对结果集做了什么。不是 CF 程序员，我对此无能为力。但一般来说，当我负责解决多平台性能问题时，客户端倾向于使用整个结果集，然后使用程序逻辑来选择要显示/使用的行。服务器比客户端快得多，并且给出正确的提示，数据库优化器可以就如何获取这些行做出一些非常好的决定。

# jquery - Google Play 不接受 apk

> ID：15704879
> 
> 赞同：0
> 
> 时间：2013-03-29T14:06:25.307
> 
> 标签：jquery, cordova, google-play, android-manifest, dreamweaver

我正在将 jQuery mobile 和 Phonegap 与 Dreamweaver CS5.5 一起使用。我在我的电脑上创建了一些应用程序。现在我尝试在 Google Play 上发布它们，但我得到了同样的错误。我不是核心开发人员，我只知道 HTML、jQuery 和 PHP。我到处搜索，但找不到答案。

上传apk时出现此错误。

![在此处输入图像描述](../Images/23df6bf8b38348f1591f140a48d6a05d.png)

检查我的 HTML 代码 [http://pastebin.com/X29B5ARv](http://pastebin.com/X29B5ARv)

如何为 Dreamweaver 应用程序创建 AndroidManifest.xml？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:28:32.647

以下是发布到 Google Play 的初始步骤：

*   注册 Google Play 发布商帐户
*   如果您要销售应用程序，请设置 Google Checkout 商家帐户
*   探索 Google Play 开发者控制台并了解发布工具

在这里查看更多信息：http: [//developer.android.com/distribute/googleplay/publish/register.html](http://developer.android.com/distribute/googleplay/publish/register.html)

我实际上还没有为 Android/Google Play 发布任何内容，但我认为 99% 的某些 Google Play 应用程序需要为 Android 开发，这意味着您需要使用 Java 或诸如[MonoDroid 之](http://xamarin.com/monoforandroid)类的包装器。

如果您收到 AndroidManifest.xml 错误，听起来您的 PhoneGap 项目未正确编译，因为它是 Android 上的应用程序的强制性文件（有根据的推测）。我以前没有使用过它，但请确保您编译它，或者在为 Android 构建 RC/Release 版本时在 PhoneGap 中执行的任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T19:02:59.883

我看过你的 Html 文件，你只是做了一个简单的 Html 页面，没有使用 Corodova/PhoneGap deviceReady 函数。请查看[Phonegap 文档](http://docs.phonegap.com/en/2.5.0/index.html)以编译适用于 Android 的应用程序。

# java - 无法使用身份验证从 Morningstar.com 下载 csv 文件

> ID：15704880
> 
> 赞同：0
> 
> 时间：2013-03-29T14:06:27.403
> 
> 标签：java, apache, authentication

我在 Morningstar 有一个高级帐户，我尝试从高级内容区域下载一些 csv 文件。出于某种原因，我无法获得那些优质内容。例如，使用高级帐户我可以获得 10 年的财务报表数据，但我已经尝试了来自 apache httpcomponents-client 的所有示例身份验证 java 代码。所有这些都只能让我获得不需要身份验证的内容。我怎样才能知道 Morningtar 正在使用什么身份验证协议并成功进行身份验证？我尝试了来自 org.apache.http.examples.client 的示例代码，包括 clientAuthentication.java、clientKerberosAuthentication.java、clientInteractiveAuthentication.java。如果我在 Chrome 中登录 Morningstar 帐户并粘贴此 URL，我可以获得 10 年数据 csv，但如果我通过 java 访问，我只能获得 5 年数据。以下是我尝试过的示例代码之一。我没有得到异常或错误，但我只得到了 5 年的数据而不是 10 年。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.auth.AuthScope;
import org.apache.http.auth.UsernamePasswordCredentials;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

public class ClientAuthentication {

    public static void main(String[] args) throws Exception {
        DefaultHttpClient httpclient = new DefaultHttpClient();
        try {
            httpclient.getCredentialsProvider().setCredentials(
                    new AuthScope("morningstar.com", 443),
                    new UsernamePasswordCredentials("xxx@gmail.com", "xxxx")); //anonymized this before posting to stackoverflow

            HttpGet httpget = new HttpGet("http://financials.morningstar.com/ajax/ReportProcess4CSV.html?t=aapl&region=usa&culture=en_US&reportType=is&period=12&dataType=A&order=asc&columnYear=10&rounding=3&view=raw&productCode=USA&r=199209&denominatorView=raw&number=3");

            System.out.println("executing request" + httpget.getRequestLine());
            HttpResponse response = httpclient.execute(httpget);
            HttpEntity entity = response.getEntity();
            BufferedReader in;
            in = new BufferedReader(new InputStreamReader(entity.getContent()));

            System.out.println("----------------------------------------");
            System.out.println(response.getStatusLine());
            if (entity != null) {
                System.out.println("Response content length: " + entity.getContentLength());
                int linenum = 0;
                while (true){
                    String line = in.readLine();
                    if (line == null) break;
                    linenum++;  
                    if (linenum>1)
                    System.out.println(line);

                }
            }
            EntityUtils.consume(entity);
        } finally {
            // When HttpClient instance is no longer needed,
            // shut down the connection manager to ensure
            // immediate deallocation of all system resources
            httpclient.getConnectionManager().shutdown();
        }
    }
} 
```

# android - 如何从db显示html页面

> ID：15704881
> 
> 赞同：1
> 
> 时间：2013-03-29T14:06:30.087
> 
> 标签：android, database, sqlite

> 我尝试将 htmlpage 作为字符串存储在 db 中。然后我需要在 webview 中显示该页面。在这里我粘贴我的代码请帮助我.......你如何在android的sqlite数据库中存储一个html页面？我试图将 html 页面转换为字节数组以存储在数据库中。请帮助我如何将插入存储到数据库中，然后在 webview 中打开该负载...

```
public class AndroidOpenDbHelper extends SQLiteOpenHelper  {
    public static final String DB_NAME = "html_db";
    public static final int DB_VERSION = 1;
    public static final String TABLE_NAME = "html_table";
    public static final String COLUMN_NAME_ID = "html_id_column";
    public static final String COLUMN_NAME_PAGE = "page_column";

    public AndroidOpenDbHelper(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        //"create table if not exists TABLE_NAME ( BaseColumns._ID integer primary key autoincrement, FIRST_COLUMN_NAME text not null, SECOND_COLUMN_NAME integer not null);"
                String sqlQueryToCreateTable = "create table if not exists " + TABLE_NAME + " ( " + BaseColumns._ID + " integer primary key autoincrement, " 
                                                                        + COLUMN_NAME_PAGE + " HTML STRING, "
                                                                        ;

                // Execute a single SQL statement that is NOT a SELECT or any other SQL statement that returns data.
                db.execSQL(sqlQueryToCreateTable);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        if(oldVersion == 1 && newVersion == 2){
            // Upgrade the database
        }       
    }

    } 
```

> 这是我显示页面的代码。

```
 public class MainActivity extends Activity {
     WebView browser;
    private static String inp;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

         browser=(WebView)findViewById(R.id.w1);

    }

     private void loadTime(SQLiteDatabase db) {
        // TODO Auto-generated method stub

         browser.getSettings().setJavaScriptEnabled(true);

                   browser.loadDataWithBaseURL("x-data://base",inp,"text/html", "UTF-8",null);

        // browser.loadUrl(inp);

    }
    public static String main(String args[]) throws FileNotFoundException {
         FileInputStream fis = new FileInputStream("D:/mo.html");
          inp = new Scanner(fis,"UTF-8").useDelimiter("\\A").next();
    return inp;
     }
    public void insertUndergraduate(){
        AndroidOpenDbHelper androidOpenDbHelperObj = new AndroidOpenDbHelper(this);
        SQLiteDatabase sqliteDatabase = androidOpenDbHelperObj.getWritableDatabase();
        ContentValues contentValues = new ContentValues();
        contentValues.put(AndroidOpenDbHelper.COLUMN_NAME_PAGE,inp);

    } 
```

> 请帮助我.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:49:20.310

你试过这个例子吗：

[http://mobile.tutsplus.com/tutorials/android/android-sdk-embed-a-webview-with-the-webkit-engine/](http://mobile.tutsplus.com/tutorials/android/android-sdk-embed-a-webview-with-the-webkit-engine/)

**这看起来不错：**

```
WebView engine = (WebView) findViewById(R.id.web_engine); 

String data = "<html>"  +  
          "<body><h1>Yay, Mobiletuts+!</h1></body>"  +  
          "</html>";  

engine.loadData(data, "text/html", "UTF-8"); 
```

现在，如果可行，我只需将 html 从数据库中的普通文本字段中选择到字符串中。

请让我知道这是否有效并且是答案。

# jquery - AJax 调用不适用于锚标记链接按钮

> ID：15704887
> 
> 赞同：0
> 
> 时间：2013-03-29T14:06:51.753
> 
> 标签：jquery, asp.net-mvc

我在 MVC 中使用 Jquery 我在锚标记的 onclick 事件中遇到了一些问题。这正在调用一个 Javascript 函数，该函数又向控制器发出 AJAX 调用

```
 <a id="LoginLink_@Model.DomainLibraries[i].Id" href=""  onclick="LoginLibrary(this);" domainLibId="130" HasRole="false" style="text-decoration:underline;">Login</a>

    function LoginLibrary(obj) {
        var selectedLibraryId = obj.getAttribute('domainLibId');
        var hasUserRole = obj.getAttribute('HasRole');
        $.ajax({
            type: "POST",
            url: "/Account/LoginLibrary",
            data: { domainLibraryId: selectedLibraryId, hasUserRole: hasUserRole },
            success: function (arg) {
                alert(arg);
                $("#divExAuthLibSetting").html(arg);
            },
            error: function (xhr, ajaxOptions, thrownError) {
            }
        });
    } 
```

发生的事情是，当我单击登录链接时，在调用控制器方法之前，它会给出一个带有空值的警报，可能是因为“alert(arg);”。然后呼叫转到控制器。但是在控制器响应后，我无法在 arg 中得到任何东西。

如果我在 document.Ready() 中调用函数 LoginLibrary()，我们的事情就可以正常工作。我能够得到响应“arg”并在 div 中显示它。

这是否意味着ajax调用不适用于点击时的锚标记..

# css - 如何对齐margin-top；用CSS

> ID：15704896
> 
> 赞同：0
> 
> 时间：2013-03-29T14:07:13.223
> 
> 标签：css, vertical-alignment, margins

我有一个看起来像这样的网站： [https ://dl.dropbox.com/u/94786808/Example1.png](https://dl.dropbox.com/u/94786808/Example1.png)

您会注意到标题“后期制作”正确地水平对齐，但不是垂直对齐。当我尝试使用css中的“margin top”命令垂直对齐它时，会发生这种情况：[https ://dl.dropbox.com/u/94786808/example2.png](https://dl.dropbox.com/u/94786808/example2.png)

您可以看到标题现在位于正确的位置，但包含它的“框”也已移动。这是涉及的css：

容器（将其固定到位）

```
.container {
     margin-left: auto;
     margin-right: auto;
     background-color:#FFF;
     width: 960px;
     height: 609px;
} 
```

* * *

后期制作（渐变框）

```
.postproduction {
     width: 960px;
     height: 203px;
     background-image:url(../image/departments/bg.png);
     opacity: 0.5;
     -o-transition:.2s;
     -ms-transition:.2s;
     -moz-transition:.2s;
     -webkit-transition:.2s;
} 
```

* * *

最后，Titlepost（实体文本）

```
 .TitlePost {
          margin-top: 101px;
          margin-left: 35px;
          font-family: 'NeouBold';
          font-size: 30px; 
```

}

* * *

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:23:23.743

您的代码可能会像这样更好地构造：

## html

```
<div class="container">
    <div class="postproduction">
        <p>Post Production</p>
    </div>
</div> 
```

## CSS

```
.container {
     margin-left: auto;
     margin-right: auto;
     background-color:#FFF;
     width: 960px;
     height: 609px;
}
.postproduction {
     width: 960px;
     height: 203px;
     background-image:url(../image/departments/bg.png);
     opacity: 0.5;
     -o-transition:.2s;
     -ms-transition:.2s;
     -moz-transition:.2s;
     -webkit-transition:.2s;
}
.postproduction p{
          padding-top: 101px;
          padding-left: 35px;
          font-family: 'NeouBold';
          font-size: 30px;
} 
```

# java - 单击下一个按钮时如何清除按钮的颜色？

> ID：15704898
> 
> 赞同：0
> 
> 时间：2013-03-29T14:07:20.820
> 
> 标签：java, android

单击下一个按钮后如何将按钮的颜色更改为默认值？我有这段代码为 onclicklistener 中的按钮设置颜色：

```
Button button = (Button) v;
button.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x003333)); 
```

我的所有按钮都有一键式监听器。单击下一个按钮时如何清除此按钮的背景颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:09:05.560

或者，将对上一个按钮的引用存储在您的活动范围内，并在 onclick 中使用它来重置它。或者设置所有按钮的背景，除了被点击的那个。

```
Button previousButton = null;

@Override
public void onClick(View v) {
    //reset old button
    if (previousButton != null) {
        previousButton.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x000000));
    }

    //prettify new button
    Button button = (Button) v;
    button.getBackground().setColorFilter(new LightingColorFilter(0xFFFFFFFF, 0x003333));

    previousButton = button;
} 
```

# java - 列表中的 Bean 在 JSF 中未更新

> ID：15704900
> 
> 赞同：0
> 
> 时间：2013-03-29T14:07:35.647
> 
> 标签：java, ajax, jsf, primefaces

我现在挣扎了整整一个星期，但没有得到它的工作。用户对象没有得到更新......这是重要的 xhtml 部分：

```
<p:dataTable id="usersTable" var="user" value="#{userBean.allUsers}">  
<p:ajax event="rowToggle" listener="#{userBean.onRowToggle}" update=":form_user_management:tabView_viewUsers:messages" />  
<f:facet name="header">  
    User
</f:facet>  

<p:rowExpansion>  
    <h:panelGrid id="display" columns="2" cellpadding="10" style="width:300px;"  
                 styleClass=" ui-widget-content grid">  

        <p:panel id="panel" header="Benutzer bearbeiten">

            <p:messages id="msgs"/>

            <h:panelGrid columns="3" >
                <h:outputLabel for="firstname" value="Firstname: *" />
                <p:inputText id="firstname" value="#{user.userFirstName}" required="true" label="Firstname">
                    <f:validateLength minimum="2" />
                </p:inputText>
                <p:message for="firstname" display="icon"/>

                <h:outputLabel for="surname" value="Surname: *" />
                <p:inputText id="surname" value="#{user.userLastName}" label="Surname" required="true">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgSurname" event="keyup" />
                </p:inputText>
                <p:message for="surname" id="msgSurname" display="icon"/>

                <p:commandLink id="changepw" value="Passwort ändern" onclick="dlg.show()" title="Passwort ändern">
                    <f:setPropertyActionListener value="#{user}" target="#{userBean.currentUser}" />
                </p:commandLink>

                <p:commandButton ajax="true" id="btnUpdateUser" value="Update" update=":form_user_management @all" actionListener="#{userBean.updateUser(user)}"/>
                <p:commandButton ajax="true" id="btnDeleteUser" value="Delete" update=":form_user_management" actionListener="#{userBean.deleteUser(user)}"/>  

            </h:panelGrid> 
        </p:panel>  
    </h:panelGrid>
</p:rowExpansion> 
```

当我单击“保存”时，展开的行消失了，但没有显示新值，Java 方法“userBean.updateUser(user)”只获取用户对象的旧值。

UserBean 的头部是：

```
@Named
@SessionScoped
public class UserBean implements Serializable { 
```

SessionScoped 来自 javax.enterprise.context

我也尝试使用旧的 @ManagedBean 东西，但这也没有帮助。我认为问题出在 xhtml 文件和 ajax 文件中......哦，我使用了其他模板文件。

使用 Primefaces 3.4 和 Glassfish 3+

Full UserBean: [http://pastebin.com/yQCgiM4E](http://pastebin.com/yQCgiM4E) Full Xhtml: [http://pastebin.com/19TWt3Dv](http://pastebin.com/19TWt3Dv) (line 110 is the interesting thing)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:36:04.443

Ok my mate solved the problem himself by adding `return action.getActionEvent()+"?faces-redirect=true";`

in the action attribute, like so`<h:commandButton action="page1?faces-redirect=true" value="Page1" />`

this solved the ajax-delay-shit

# javascript - JavaScript：在构造函数中定义函数而不是使用原型 - 有什么区别？

> ID：15704904
> 
> 赞同：0
> 
> 时间：2013-03-29T14:07:48.783
> 
> 标签：javascript, typescript

因此，我不是 JavaScript 专家，只是想了解以下两个代码片段之间的区别。我有一个想要转换为 TypeScript 的项目，我需要了解生成的两个代码片段之间的区别。

```
var Pony = (function () {
    function Pony() { }
    Pony.prototype.bite = function () {
        alert("Chomp!");
    };
    return Pony;
})();

var Pony2 = (function () {
    function Pony2() {
        var self = this;
        self.bite = function () {
            alert("Chomp!");
        };
    }
    return Pony2;
})(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:40:47.383

上面的答案很好地概述了放置原型和放置实例之间的区别。至于您关于转换为 TypeScript 的问题，以下是您将如何编写它们：

```
class Pony {
    bite(){
        alert('chomp');
    }
}

class Pony2 {
    bite:  () => void;
    constructor(){
        this.bite = () => alert('chomp');
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:26:09.547

两者之间的区别在于，您可以通过存储在 var Pony 中的对象的属性获取第一个 Pony 的原型，并且可以在其他地方扩展或使用该原型的相关位，因为 Pony2 仅被视为一个函数。因此，如果您以后不打算使用任何类型的原型继承，它们是等价的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:31:43.663

至于你如何使用它们，没有区别。但是，从性能的角度来看，前一种方法会更可取。让我们稍微扩展一下您的示例：

```
var prototypePony1 = new Pony();
var prototypePony2 = new Pony();
var thisPony1 = new Pony2();
var thisPony2 = new Pony2();

prototypePony1.hasOwnProperty('bite'); //returns false
prototypePony2.hasOwnProperty('bite'); //returns false
thisPony1.hasOwnProperty('bite'); //returns true
thisPony2.hasOwnProperty('bite'); //returns true

Pony.prototype.bite = function() { alert('Nomnomnom!'); };
Pony2.prototype.bite = function() { alert('Nomnomnom!'); };

prototypePony1.bite(); //alerts 'Nomnomnom!'   
prototypePony2.bite(); //alerts 'Nomnomnom!'

thisPony1.bite(); //alerts 'Chomp!', instance property is accessed first   
delete thisPony2.bite;
thisPony2.hasOwnProperty('bite'); //returns false
thisPony2.bite(); //alerts 'Nomnomnom!' 
```

在上面的示例中，`thisPony1`两者`thisPony2`都获得了自己的`bite`函数副本，因为它是使用`this`但是定义的，`prototypePony1`并且都共享from的构造函数`prototypePony2`的相同副本。 一旦我们在 Pony2 上定义了原型，实例属性仍然会首先在. 直到我们删除实例属性，我们才看到新定义的原型属性。 有关定义对象方法的更多详细信息，请查看[此处](http://www.phpied.com/3-ways-to-define-a-javascript-class/)。`bite``Pony`

`bite``thisPony1``thisPony2`

# java - 从耶拿 QuerySolution 到模型 tdb rdf

> ID：15704905
> 
> 赞同：2
> 
> 时间：2013-03-29T14:07:50.640
> 
> 标签：java, rdf, jena, dbpedia

我`dbpedia`用来获取一些特定的结果，我想将它们存储在本地`tdb`. 但我找不到将结果添加到本地的方法`tdb`。

```
package festifolk.tdb;

import com.hp.hpl.jena.query.*;
import com.hp.hpl.jena.rdf.model.Model;
import com.hp.hpl.jena.tdb.TDBFactory;
import com.hp.hpl.jena.update.*;
import org.apache.jena.atlas.lib.StrUtils;

public class Remote {

    public static ResultSet[] Query() {
        /* Remote location of the Data set used in building our tdb */
        String service = "http://dbpedia.org/sparql";

        /* Declaration of the SPARQL prefixes used */
        String owl = "PREFIX owl: <http://www.w3.org/2002/07/owl#>";
        String xsd = "PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>";
        String rdfs = "PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>";
        String rdf = "PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>";
        String foaf = "PREFIX foaf: <http://xmlns.com/foaf/0.1/>";
        String dc = "PREFIX dc: <http://purl.org/dc/elements/1.1/>";
        String res = "PREFIX res: <http://dbpedia.org/resource/>";
        String ont = "PREFIX ont: <http://dbpedia.org/ontology/>";
        String dbpedia2 = "PREFIX dbpedia2: <http://dbpedia.org/property/>";
        String dbpedia = "PREFIX dbpedia: <http://dbpedia.org/>";
        String skos = "PREFIX skos: <http://www.w3.org/2004/02/skos/core#>";

        String prefixes = owl + xsd + rdfs + rdf + foaf + dc + res + ont + dbpedia2
                + dbpedia + skos;

        String[] URI = {
            "<http://dbpedia.org/class/yago/MusicFestivalsInTheNetherlands>",
            "<http://dbpedia.org/class/yago/MusicFestivalsInBelgium>",
            "<http://dbpedia.org/class/yago/MusicFestivalsInFrance>",
            "<http://dbpedia.org/class/yago/MusicFestivalsInGermany>",
            "<http://dbpedia.org/class/yago/MusicFestivalsInEngland>"
        };

        String query;
        QueryExecution queryExec;
        ResultSet[] results = new ResultSet[URI.length];

        for (int i = 0; i < URI.length; i++) {
            query = prefixes
                    + "SELECT * WHERE { "
                    + "?festival rdf:type " + URI[i] + ". "
                    + "?festival rdfs:label ?label. "
                    + "?festival ont:abstract ?abstract. "
                    + "OPTIONAL{?festival foaf:homepage ?homepage}. "
                    + "} ";

            /* execute the query and save the result */
            queryExec = QueryExecutionFactory.sparqlService(service, query);
            try {
                results[i] = queryExec.execSelect();
            } catch (Exception e) {
                System.out.println(e);
            } finally {
                queryExec.close();
            }
        }

        return results;
    }

    public static void storeLocally(ResultSet[] results, Dataset dataset) {
        /* Open the provided dataset and begin the writing procedure */
        dataset.begin(ReadWrite.WRITE);

        try {

            /* API Calls to a model in the dataset */
            Model model = dataset.getDefaultModel();

            /* ADD all the results to the database */
            for (ResultSet resultSet: results) {
                while (resultSet.hasNext()) {
                    model.add(resultSet.nextSolution())
                }
            }

            /* ... perform a SPARQL Update */
            GraphStore graphStore = GraphStoreFactory.create(dataset);
            String sparqlUpdateString = StrUtils.strjoinNL(
                    "PREFIX . <http://example/>",
                    "INSERT { :s :p ?now } WHERE { BIND(now() AS ?now) }");

            UpdateRequest request = UpdateFactory.create(sparqlUpdateString);
            UpdateProcessor proc = UpdateExecutionFactory.create(request, graphStore);
            proc.execute();

            /* Finally, commit the transaction */
            dataset.commit();
        } catch (Exception ex) {
            System.out.println(ex);
        } finally {
            dataset.end();
        }
    }

    public static void main(String[] args)
    {
        /* Direct way: Make a TDB-backed dataset */
        String directory = "tdb";
        Dataset dataset = TDBFactory.createDataset(directory);
        storeLocally(Query(), dataset);
    }
} 
```

上面的代码显示了我想做的事情，但显然它不起作用，因为无法将 a 添加`QuerySolution`到模型中。

任何人都可以帮助我吗？

编辑：添加了完整的课程。问题是关于 storeLocally void 部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:07:46.567

`SELECT`与其使用查询，不如使用[CONSTRUCT](http://www.w3.org/TR/2013/REC-sparql11-query-20130321/#construct)查询，`CONSTRUCT`查询返回 RDF 图，因此在 Jena 中是`Model`

然后要将其存储在本地，您可以简单地调用`dataset.setDefaultModel()`或`dataset.addNamedModel()`根据需要将返回的模型添加到本地 TDB 数据集。

# sql - 在 where 子句中使用 sql

> ID：15704908
> 
> 赞同：0
> 
> 时间：2013-03-29T14:08:07.837
> 
> 标签：sql, sql-server, subquery, where-clause, with-clause

我如何在这样的查询中使用 with？有没有办法在 TableList 中使用 tableIds？我可以将它们视为子查询吗？

```
select * from TestTable where tableId in 

(WITH TableList (tableId)
AS
(
SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
UNION ALL
SELECT t.tableId From OldTable as t
INNER JOIN TableList as p
ON t.ParenTableId = p.TableId
WHERE t.IsDeleted = 0
)
SELECT tableId FROM TableList
) 
```

编辑：为了说明为什么我不能在 sql 的第一条语句中使用 with。

```
select TableId, IsDeleted,
( 
  select count(OtherId) OtherTable
  where otherTableId in 
  (WITH TableList (tableId)
  AS
  (
  SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
  UNION ALL
  SELECT t.tableId From OldTable as t
  INNER JOIN TableList as p
  ON t.ParenTableId = p.TableId
  WHERE t.IsDeleted = 0
  )
  SELECT tableId FROM TableList
  )
  ) as Ex1
from TestTable where tableId in (1,2,3) 
```

我认为这说明了为什么我试图在 sql 查询中间使用 with 子句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:10:13.570

我更喜欢在 中这样做`JOIN`，所以它看起来像这样。`WITH`语句始终是 sql 查询语句中的第一个。

如果有记录在公共表表达式上有多个匹配项，则`DISTINCT`在子句上应用关键字`SELECT`以使结果*唯一。*`TestTable`

```
WITH TableList (tableId)
AS
(
    SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
    UNION ALL
    SELECT t.tableId From OldTable as t
    INNER JOIN TableList as p
    ON t.ParenTableId = p.TableId
    WHERE t.IsDeleted = 0
)
SELECT  DISTINCT a.*
FROM    TestTable a
        INNER JOIN TableList b
            ON a.tableId = b.tableId 
```

* * *

**更新 1**

```
WITH TableList (tableId)
AS
(
    SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
    UNION ALL
    SELECT t.tableId From OldTable as t
    INNER JOIN TableList as p
    ON t.ParenTableId = p.TableId
    WHERE t.IsDeleted = 0
)
SELECT  DISTINCT t.TableId, t.IsDeleted, f.totalCount
FROM    TestTable t
        INNER JOIN
        (
            SELECT  a.otherTableId, COUNT(DISTINCT a.OtherId) totalCount
            FROM    OtherTable a
                    INNER JOIN TableList b
                        ON b.tableId = a.otherTableId
            GROUP   BY otherTableId
        ) f ON t.tableId = f.otherTableId
WHERE   t.tableId in (1,2,3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:10:49.333

您需要在调用 SQL 之前定义您的 WITH CTE：

```
WITH TableList (tableId)
AS
(
    SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
    UNION ALL
    SELECT t.tableId From OldTable as t
        INNER JOIN TableList as p
            ON t.ParenTableId = p.TableId
    WHERE t.IsDeleted = 0
)
SELECT * 
FROM TestTable 
WHERE tableId in 
(
    SELECT tableId FROM TableList
) 
```

*编辑——根据您的评论，您可以在 VIEW 中定义递归 CTE，然后根据需要使用：*

```
CREATE VIEW YourView AS 
WITH TableList (tableId)
AS
(
    SELECT tableId FROM OldTable WHERE tableId=5 and IsDeleted = 0
    UNION ALL
    SELECT t.tableId From OldTable as t
        INNER JOIN TableList as p
            ON t.ParenTableId = p.TableId
    WHERE t.IsDeleted = 0
)
SELECT * 
FROM TableList; 
```

# regex - 解析来自远程 STAF 命令的数据输出

> ID：15704909
> 
> 赞同：1
> 
> 时间：2013-03-29T14:08:08.790
> 
> 标签：regex, bash, automation

`Data`从这个 STAF 命令解析部分的最简单方法是什么？
找不到可以传递给命令以自动执行此操作的 STAF 参数，
因此看起来解析/正则表达式可能是最佳选择？
**注意**：我不想使用任何外部库。

```
[root@source ~]# STAF target PROCESS START SHELL COMMAND "ls" WAIT RETURNSTDOUT
Response
--------
{
    Return Code: 0
    Key        : <None>
    Files      : [
        {
            Return Code: 0
            Data       : myFile.txt
myFile2.txt
myFile3.txt

        }
    ]
} 
```

相反，我希望输出/结果的格式类似于 ..

```
[root@source ~]# STAF target PROCESS START SHELL COMMAND "ls" WAIT RETURNSTDOUT
myFile.txt
myFile2.txt
myFile3.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T11:47:25.680

```
 Best way to this is Create a XML file and use python script  to access the data part of STAFResult since STAF Return data in Marshalled form as "CONTENT" and python can be use to grab that.

    I will try to explain it with simple example, Its an HTTP request to server. 

 <stafcmd>
    <location>'%s'%machineName</location>
    <service>'http'</service>                   
    <request>'DOGET URL %s?phno=%s&amp;shortCode=%s&amp;query=%s' % (url, phno, shortCode, escapeQuery)</request>
    </stafcmd>
    <if expr="RC == 0">
                <sequence>                      
                    <call function="'func_Script'"></call>
                    <if expr="rc == 0">     <!-- Pass At First Query -->                
                        <sequence>                                                  
                            <message>'PASS@Fisrt HTTPRequest: Keyword = %s,\nRequired Response = %s,\ncontent=%s' %(query, response, content)</message>
                            <tcstatus result="'pass'">'Pass:' </tcstatus>   
                        </sequence>
                    <else>  <!-- Check For MORE -->     
                        <call function="'Validate_QueryMore'"> </call>
                    </else>
                    </if>
                </sequence> 
            <else>
                <message>'ERROR: HTTPRequest QUERY : RC = %s  Result= %s' %(rc,STAFResult)</message>
            </else>                 
            </if>   

<function name="func_Script">
    <script>
        import re
        content = STAFResult['content'].lower() 
        response = response.lower()
        test = content.find(response)
        if test != -1:
            rc = 0 
        else:
            rc = 1 
    </script>
</function>

Hope It will give you some Help. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T15:58:38.760

您可以通过 sed 脚本通过管道输出命令的输出，该脚本将只为您过滤掉文件名。这是第一个剪辑：

```
sed -ne '/^[a-z]/p;/Data/s/[^:]*: \(.*\)/\1/p' 
```

这个想法是：如果一行以小写字母开头，那就是一个文件名（表达式直到第一个分号）。如果字符串“Data”在该行中，则取该行中第一个冒号之后的所有内容（分号之后的表达式）。其他一切都被忽略。

您可能希望更具体，而不仅仅是在开头期望一个小写字母（这会过滤掉开头的“响应”行，但如果您的文件名可能以大写字母开头，那将不起作用）。此外，仅查找字符串“Data”可能有点过于笼统——该字符串也可能出现在文件名中。但希望你能明白。要使用它，请像这样运行您的命令：

```
STAF ... | sed -ne ... 
```

# c# - 是否可以在运行时将类注入到正在执行的程序集中？

> ID：15704915
> 
> 赞同：0
> 
> 时间：2013-03-29T14:08:23.643
> 
> 标签：c#, .net, codedom, runtime-compilation

我正在试验 CSharpCodeProvider .NET Code DOM 类，我能够编译程序集并创建在程序集中定义的实例，但我很想知道是否可以“注入”代码或更确切地说是一个类正在执行的程序集中的命名空间。

我可以通过将代码编译成程序集文件来解决这个问题，但是如果可能的话，我想在内存中执行此操作。

# powershell - 有人可以用一个简单的 -ldapfilter 提供建议吗

> ID：15704917
> 
> 赞同：1
> 
> 时间：2013-03-29T14:08:42.893
> 
> 标签：powershell

大家好，有人可以帮我理解为什么生成的导出文件不包含任何信息。对于导入的 .csv 文件中的每个 ISID（我的设置登录名的缩写），我想找到相应的 samAccountName 并导出列出的属性...

```
Add-PSSnapin Quest.ActiveRoles.ADManagement
connect-qadservice US2.k.com -proxy
$groupName = Import-csv c:\ExportDL\LockedAccounts.csv
write-host "This window will close when done"_ADmembers.csv" will be created" -ForegroundColor Green
ForEach ($ISID in $groupName) {
get-qaduser -ldapfilter "(&(objectCategory=person)(objectClass=user)(samaccountname=$ISID))" 
    -includedproperties samAccountName,accountExpires,edsvaParentCanonicalName,edsaAccountIsDisabled,passwordLastset,department,manager,distinguishedName,displayName | 
    select edsvaParentCanonicalName,displayName,samAccountName,name,edsaAccountIsDisabled,logonName,
    lastName,firstName,manager,accountExpires,passwordLastset | 
        export-csv C:\ExportDL\LockedAccounts_ADmembers.csv
} 
```

我为糟糕的缩进道歉。我想不出四个空格的代码块:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:25:35.470

这应该可以，但是知道文件的内容会很有趣`LockedAccounts.csv`：

```
Add-PSSnapin Quest.ActiveRoles.ADManagement
connect-qadservice US2.k.com -proxy
$groupName = Import-csv c:\ExportDL\LockedAccounts.csv 
write-host "This window will close when done"_ADmembers.csv" will be created" -Fore Green

( $groupName | select -expa ISID | get-qaduser -includedproperties samAccountName,accountExpires,ParentCanonicalName,
AccountIsDisabled,passwordLastset, department,manager,distinguishedName,displayName | 
select ParentCanonicalName,displayName,samAccountName,name,AccountIsDisabled,logonName,
       lastName,firstName,manager,accountExpires,passwordLastset ) |
export-csv C:\ExportDL\LockedAccounts_ADmembers.csv -NoTypeInformation 
```

如果该`ISID`列包含`sAMAccountName`不需要 a `ldap query`，则该命令通过或参数`QADs`接受它作为输入`pipe``-identity`

# android - Android 2.2 版本没有显示选项按钮？

> ID：15704918
> 
> 赞同：0
> 
> 时间：2013-03-29T14:08:47.233
> 
> 标签：android, android-layout

到目前为止，我使用 SDK for Android 2.1 编译了我的应用程序。选项/首选项按钮自动出现在那里，我只需要通过提供方法 onPrepareOptionsMenu() 和 onMenuItemSelected() 来激活它。

现在我切换到 SDK for 2.2，我的整个布局是……嗯……损坏了。最明显的问题：选项按钮不见了。

那么我该怎么做才能为 2.2 重新启用它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:21:11.117

> 选项/首选项按钮自动出现

Android中从来没有“自动出现”的“选项/首选项按钮”。我猜你的意思是 Android 3.0 设备系统栏/导航栏中的旧菜单可供性，适用于`android:minSdkVersion`设置太低的应用程序。

> 那么我该怎么做才能为 2.2 重新启用它？

遗留菜单可供性与您的构建目标无关。它与您的`android:minSdkVersion`. 更重要的是，你的目标应该是摆脱这种负担，因为它向用户表明你的应用已经过时了。

如果您正在使用`onPrepareOptionsMenu()`，则应该使用操作栏，在这种情况下，您以前的菜单项将直接作为工具栏样式按钮出现在操作栏中，或者在操作栏的溢出菜单（“...”按钮）中，或通过用户按下设备的 MENU 按钮时出现的弹出菜单。

如果您不想要操作栏，请不要使用`onPrepareOptionsMenu()`. 相反，使用您自己的小部件作为您自己的活动 UI 的一部分创建您自己的菜单结构。

You can read more about [the action bar](http://developer.android.com/guide/topics/ui/actionbar.html) and [the vanishing menu affordance](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html) in the documentation.

# nginx - 重用 nginx.conf 中域的配置语句

> ID：15704919
> 
> 赞同：12
> 
> 时间：2013-03-29T14:08:50.517
> 
> 标签：nginx

假设我为这样的域设置了 nginx 配置：

```
server {

  root /path/to/one;
  server_name one.example.org;

  location ~ \.php$ {
    try_files       $uri =404;
    fastcgi_pass    127.0.0.1:9000;
    fastcgi_index   index.php;
    fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include         fastcgi_params;
  }

} 
```

现在，如果我想添加另一个具有不同内容的域，有没有办法可以重复使用前一个域中的等效语句，或者我是否必须为我想要支持的每个新域复制所有内容？

```
server {

  root /path/to/two; # different
  server_name two.example.org; # different

  location ~ \.php$ {
    try_files       $uri =404;
    fastcgi_pass    127.0.0.1:9000;
    fastcgi_index   index.php;
    fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include         fastcgi_params;
  }

} 
```

我尝试将`location`指令移到`server`闭包之外，但显然事情不会那样工作，因为在重新启动 nginx 时出现错误“此处不允许位置指令”。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-29T20:57:17.577

这是使用 nginx Map 模块的一个很好的例子。[http://wiki.nginx.org/HttpMapModule](http://wiki.nginx.org/HttpMapModule)

以下是我尝试过的。它适用于我的开发箱。笔记

1.  map 指令只能放在 http 块中。
2.  声明 map 指令的性能损失可以忽略不计（见上面的链接）
3.  您可以自由拥有不同的根文件夹或端口号等。

    ```
    map $subdomain $root_folder {
      one  /path/to/one;
      two  /path/to/two;
    }

    map $subdomain $port_number {
      one 9000;
      two 9100;
    }

    server {
      listen  80;
      server_name  ~^(?P<subdomain>.+?)\.mydomain\.com$;
      root  $root_folder;

       location ~ \.php$ {
        try_files       $uri =404;
        fastcgi_pass    127.0.0.1:$port_number;
        fastcgi_index   index.php;
        fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include         fastcgi_params;
      }
    } 
    ```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-29T19:16:21.753

你可以做：

```
 server_name one.example.org two.example.org; 
```

如果除了域名之外两者完全相同

如果您只有类似的位置块，您可以将这些位置移动到单独的文件中，然后执行

```
include /etc/nginx/your-filename; 
```

在每个服务器块中轻松使用它

# php - Mysql，如何在选择数据时自定义时间

> ID：15704923
> 
> 赞同：1
> 
> 时间：2013-03-29T14:08:53.463
> 
> 标签：php, mysql, sql, timestamp

请给我一个字段`date`类型的时间戳（格式 2013-03-29 14:32:34）。

我想从表中选择数据并按字段对它们进行分组，`date`但没有时间，我的意思是仅按格式**Ymd**。

所以我试过：

```
SELECT date (Y-m-d) FROM table GROUP BY date (Y-m-d) 
```

这返回错误。请问我该怎么办？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:09:51.230

要提取日期时间的日期部分，请使用[`DATE()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date)

```
SELECT DATE(date) FROM ...
GROUP BY DATE(date) 
```

# c++ - c++进入无限循环

> ID：15704925
> 
> 赞同：1
> 
> 时间：2013-03-29T14:08:58.947
> 
> 标签：c++, visual-c++

下面是我的代码：

```
char name;
bool isValid = true;
int mode;

cout << "Enter name:" << endl;
cin >> name;

do
{
cout << "Choose a mode" << endl;
cin >> mode;

switch (mode)
{
case 1:
    iniCharacter (name, 110, 100, 100);
    break;
case 2:
    iniCharacter (name, 100, 110, 100);
    break;
case 3:
    iniCharacter (name, 100, 100, 110);
    break;
default:
    isValid = false;
    cout << "Invalid mode, ";
    break;
}
}while (!isValid); 
```

但是当我运行上面的代码时，输​​出如下：

```
[output]Please enter name:

[input] test

[output] Invalid mode

[output] Invalid mode

[output] Invalid mode

[output] Invalid mode

[output] Invalid mode

... 
```

为什么即使我没有开始向模式输入值，代码也会导致循环？

程序不应该等待用户输入“模式”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:11:04.247

您可能需要`isValid`在循环顶部设置为 true 以说明在尝试失败后输入有效输入时的情况：

```
isValid = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:11:16.993

将“名称”的类型更改为“字符串”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:20:22.827

非常简单

只需将名称声明更改为

```
char name[10]  // assuming your name would be 10 characters long. 
```

整个程序将运行得很好。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:24:26.300

它留`\n`在缓冲区中循环`while(cin.get()!='\n');` 前尝试`do`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T15:47:38.557

使用下面的代码将起作用-

```
char name[100] = {0};
bool isValid = true;
int mode;

cout << "Enter name:" << endl;
cin >> name;

do
{
cout << "Choose a mode" << endl;
cin >> mode;

switch (mode)
{
case 1:
    iniCharacter (name, 110, 100, 100);
    break;
case 2:
    iniCharacter (name, 100, 110, 100);
    break;
case 3:
    iniCharacter (name, 100, 100, 110);
    break;
default:
    isValid = false;
    cout << "Invalid mode, ";
    break;
}
}while (!isValid); 
```

原因：

*   Since you declared the name as single char and user enter more than single character i.e. "test", first char is assigned to name and rest are placed in the buffer as it is and because those are not integers cin doesn't care to ask you at console. Hence that int i.e. mode will have its initial garbage value only.

*   Also second output was however displayed i.e."Choose a mode" but your console buffer was flooded with that error and hence you were not able to see even that too.

# r - 从 ggplot2 中删除某些图例变量和图例值？

> ID：15704934
> 
> 赞同：15
> 
> 时间：2013-03-29T14:09:28.263
> 
> 标签：r, ggplot2

假设我正在 ggplot2 中绘制一个数据框，例如：

```
ggplot(iris) + geom_point(aes(x=Sepal.Width, y=Sepal.Length, color=Species, size=Sepal.Length)) 
```

两个相关问题：

1.  如何从图例中完全删除变量？例如，仍然按比例调整点大小，`Sepal.Length`但`Sepal.Length`完全从图例中删除？

2.  如何从图例中删除某个值或一组值？例如，仍然按上面的 Species 对点进行着色，但在图例中只显示值 for`setosa`和 exclude `versicolor, virginica`?

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-29T15:09:13.283

1.  正如 joran 所说，使用`scale_size(guide = "none")`.

2.  `scale_color_discrete(breaks="setosa")`

# ruby-on-rails - 我怎样才能获得用户的排名？

> ID：15704935
> 
> 赞同：0
> 
> 时间：2013-03-29T14:09:29.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有这些作为模型和列。

*   用户（表）
*   用户配置文件（表）
    *   总点（列）

我想在数组中显示用户的排名，当它按关联的表列排序时，称为`total_point`

所以我尝试了这个，但它返回了错误。

我该如何解决这个问题？

**application_helper**（将用户作为参数传递）

```
def user_rank(user)   
    "<i><b>#{user.user_profile.total_point}#{User.confirmed.joins(:user_profile).order('user_profiles.total_point DESC').index(user)}</b></i>".html_safe
end 
```

**模型/用户.rb**

```
scope :confirmed, where("confirmation_token" => nil)
has_one: user_profile 
```

更新：

**模型/user_profile.rb**

```
belongs_to: user 
```

**错误**

```
ActionView::Template::Error (wrong number of arguments (1 for 0)):
29:  <td class="border"> <%= user_rank(@user) %></td> 
```

# java - 何时使用 EntityManager 的 createQuery() 和 find() 方法？

> ID：15704938
> 
> 赞同：9
> 
> 时间：2013-03-29T14:09:44.283
> 
> 标签：java, jpa, entitymanager

我想知道这些方法之间的区别。

什么时候使用EntityManager的`createQuery()`and方法？`find()`

他们每个人的优点是什么？

谢谢你回答我。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-29T14:14:04.590

[`find`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#find%28java.lang.Class,%20java.lang.Object%29)当您想通过主键查找实体时使用。这意味着你确切地知道你在寻找什么，你只是想把它从数据库中提取出来。

当您想使用[`createQuery`](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#createQuery%28javax.persistence.criteria.CriteriaQuery%29)标准查找实体或者如果您想使用 JPQL 语句来定义您返回的内容时，您可以使用它。因此，当您想要获取与某些条件匹配的实体或实体集合时，您将使用查询。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-29T14:17:24.363

该`createQuery`方法允许您创建将要执行的 JPQL 语句。允许的 JPQL 语句比`find`. 例如给出下表：

```
create table CAT(
   cat_id integer,
   cat_name varchar(40)
) 
```

您可以执行查询以按名称查找猫。

```
entityManager.createQuery("select c from Cat c where c.name = :name"); 
```

该`find`方法仅允许您使用其主键检索对象。所以要使用`find`上表的方法：

```
entityManager.find(Cat.class, new Integer(1)); 
```

简而言之，`createQuery`允许您以更动态的方式检索实体，同时`find`限制您搜索具有已知 ID 的实体。

# jquery - Struts2 jquery 插件网格：选择行时，调用动作并隐藏网格中的行

> ID：15704939
> 
> 赞同：0
> 
> 时间：2013-03-29T14:09:47.777
> 
> 标签：jquery, jquery-plugins, jqgrid, struts2-jquery

我有以下情况：在 jsp 中，我使用`<sjg:grid`
我使用的其他参数显示了一个网格

*   `hidegrid=true`允许隐藏/显示网格中的所有行，以及
*   `id=gridInfo`
*   `onSelectRowTopics="rowGetInfo"`调用脚本。

当点击一行时，`rowGetInfo`被激活并调用一个动作，该动作最终必须调用一个新的jsp并在网格下方显示数据（我没有编码这部分，例如可能是另一个网格）。
所有这部分工作正常，也感谢在此处阅读的建议。
我现在要做的是：
在脚本`rowGetInfo`中，我希望能够隐藏网格行，类似于`hidegrid`单击按钮时发生的情况。这是我写的脚本：

```
$.subscribe('rowGetInfo', function(event, data) {
    $("#variabile").val(event.originalEvent.id);
    var grid = event.originalEvent.grid;
    var sel_id = grid.jqGrid('getGridParam', 'selrow');
    var variabile = grid.jqGrid('getCell', sel_id, 'variabile');  
    $("#resultSelect").show().fadeIn("slow");
    $("#gridInfo").jqGrid('setGridParam',{gridstate:'hidden'});
    $("#resultSelect").load("myaction"+"?variabile="+variabile);
}); 
```

使用`gridstate:hidden`没有效果。我也试过`$("#gridInfo").hide`了，它有效，但在单击按钮时不允许我再次显示行`hidegrid`任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T15:47:30.277

调用以下命令应该以与 hidegrid 按钮相同的方式隐藏网格。

```
$('#gridName').jqGrid('setGridState', 'hidden') 
```

# python - 将 Lastname, Firstname 切换为 List 中的 Firstname Lastname

> ID：15704943
> 
> 赞同：4
> 
> 时间：2013-03-29T14:09:53.097
> 
> 标签：python, python-2.7

我有两个运动员名单。一个结构简单：

```
['Lastname, Firstname', 'Lastname2, Firstname2'..] 
```

第二个是结构化的列表列表：

```
[['Firstname Lastname', 'Team', 'Position', 'Ranking']...] 
```

我最终想搜索第二个列表的内容，并在第一个列表中有匹配的名称时提取信息。

我需要将 'Lastname, Firstname' 交换为 'Firstname Lastname' 以匹配列表 2 的格式以进行简化。

任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T14:12:02.933

您可以将名称列表中的顺序交换为：

```
[" ".join(n.split(", ")[::-1]) for n in namelist] 
```

* * *

一个解释：这是一个列表推导，它对每个项目做一些事情。以下是一些中间版本以及它们将返回的内容：

```
namelist = ["Robinson, David", "Roberts, Tim"]
# split each item into a list, around the commas:
[n.split(", ") for n in namelist]
# [['Robinson', 'David'], ['Roberts', 'Tim']]

# reverse the split up list:
[n.split(", ")[::-1] for n in namelist]
# [['David', 'Robinson'], ['Tim', 'Roberts']]

# join it back together with a space:
[" ".join(n.split(", ")[::-1]) for n in namelist]
# ['David Robinson', 'Tim Roberts'] 
```

# cvs - 如何使用 CVS 恢复修改后的文件？

> ID：15704945
> 
> 赞同：51
> 
> 时间：2013-03-29T14:09:58.367
> 
> 标签：cvs, revert

我已从 CVS 存储库中检出一个文件并对其进行了更改。

`cvs up`命令说文件被修改`M`。

我需要删除我的更改。什么 cvs 命令可以为我做呢？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-04-18T07:51:15.497

你用

```
cvs update -C filename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-29T21:30:52.907

这是一个令人惊讶的复杂操作。我们最终使用了这个脚本“cvsunedit”。我承认这看起来有点矫枉过正，但在 cvs 中有些事情比他们应该做的更难。

```
#!/bin/bash
# cvsunedit - revert a file's modifications while preserving its current version
set -e
if [ "$1" = "" ]
then
    exit 0
fi
for f in $*
do
    echo "$f"
    base="$(basename "$f")"
    dir="$(dirname "$f")"
    rev="$(perl -e "while(<>){m#/$base/([^/]+)/# && print \$1 . \"\n\";}" < "$dir/CVS/Entries")"
    if [ "$rev" = "" ]
    then
        echo "Cannot find revision for $f in $dir/CVS/Entries"
        exit 1
    fi

    executable=0
    [ -x "$f" ] && executable=1

    mv "$f" "$f.$$.rev$rev.bak" || rm -f "$f"

    set -x
    cvs up -p -r "$rev" "$f" > "$f"
    set +x
    chmod -w "$f"
    [ $executable -ne 0 ] && chmod aog+x "$f"
done
exit 0 
```

# java - Linux 上的 Java 窗口半透明动画闪烁

> ID：15704947
> 
> 赞同：2
> 
> 时间：2013-03-29T14:10:03.993
> 
> 标签：java, linux, swing, translucency

我正在尝试使用半透明的 JFrame 在 Java 中制作动画。我在[此处](http://docs.oracle.com/javase/tutorial/uiswing/misc/trans_shaped_windows.html)修改了 Oracle Java 教程中的演示代码。特别是 GradientTranslucentWindowDemo。

以下代码在 Windows XP SP3 最高 8 和 Mac OS X Mountain Lion 中运行良好，甚至在*大多数*情况下在 Linux 中运行良好。 **Linux 中的问题，我需要帮助的是动画闪烁。**

我正在运行带有 nVidia 驱动程序、Metacity 和 Compiz 的 Ubuntu Linux 12.04 LTS 64 位。PERPIXEL_TRANSLUCENT 报告真实并且运行良好。

以下代码中是否缺少某些内容，或者在 Linux 方面是否需要更改某些内容？我在 JPanel 上尝试了 setDoubleBuffered(true)，但它没有消除闪烁。

请参考我对下面演示的代码更改：

```
import static java.awt.GraphicsDevice.WindowTranslucency.PERPIXEL_TRANSLUCENT;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.GridBagLayout;
import java.awt.Paint;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class GradientTranslucentWindowDemo extends JFrame implements ActionListener {
    private Timer timer = new Timer(100, this);

    private double percentage = 0.0;

    private JPanel surface = new JPanel() {
        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            if (g instanceof Graphics2D) {

                final int R = 0;
                final int G = 240;
                final int B = 240;

                Paint p =
                    new GradientPaint(0.0f, 0.0f, new Color(R, G, B, 0),
                        0.0f, getHeight(), new Color(R, G, B, 255), false);
                Graphics2D g2d = (Graphics2D)g;
                // CHANGE 1
                // Clear the previous graphics using a completely transparent fill
                g2d.setBackground(new Color(0, 0, 0, 0));
                g2d.clearRect(0, 0, getWidth(), getHeight());
                g2d.setPaint(p);
                // CHANGE 2
                // Only do a gradient fill for the current percentage of the width
                g2d.fillRect(0, 0, (int)Math.ceil(getWidth() * percentage), getHeight());
            }
        }
    };

    public GradientTranslucentWindowDemo() {
        super("GradientTranslucentWindow");

        setBackground(new Color(0,0,0,0));
        setSize(new Dimension(300,200));
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // CHANGE 3
        // I thought this might remove the flicker, nope
        this.surface.setDoubleBuffered(true);

        // CHANGE 4
        // This seems to be required or the g2d.clearRect doesn't do anything
        this.surface.setOpaque(false);
        setContentPane(this.surface);
        setLayout(new GridBagLayout());
        add(new JButton("I am a Button"));
    }

    // CHANGE 5
    // On each tick of the timer increment the percentage until its
    // more than one and always repaint
    @Override
    public void actionPerformed(ActionEvent event) {
        this.percentage += 0.05;
        if (this.percentage > 1.0) {
            this.percentage = 0.0;
        }
        this.surface.repaint();
    }

    public static void main(String[] args) {
        // Determine what the GraphicsDevice can support.
        GraphicsEnvironment ge = 
            GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice gd = ge.getDefaultScreenDevice();
        boolean isPerPixelTranslucencySupported = 
            gd.isWindowTranslucencySupported(PERPIXEL_TRANSLUCENT);

        //If translucent windows aren't supported, exit.
        if (!isPerPixelTranslucencySupported) {
            System.out.println(
                "Per-pixel translucency is not supported");
                System.exit(0);
        }

        JFrame.setDefaultLookAndFeelDecorated(true);

        // Create the GUI on the event-dispatching thread
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                GradientTranslucentWindowDemo gtw = new GradientTranslucentWindowDemo();

                // Display the window.
                gtw.setVisible(true);

                // CHANGE 6
                // Wait until the window is visible to start the timer
                gtw.timer.start();
            }
        });
    }
} 
```

**更新 1：** 去除半透明并选择黑色背景修复了闪烁问题。闪烁肯定与具有半透明窗口有关。我还注意到，随着窗口的扩大，闪烁变得更糟。

**更新2：** 该行`this.surface.setOpaque(false);`是导致问题的原因。如果将其注释掉，则动画不会闪烁并且具有半透明性。 *但是，在动画的每次迭代中，它都会与前一次绘制混合*（在重新绘制之前不会清除内容）。除非设置，`g2d.setBackground(new Color(0, 0, 0, 0));`否则什么`g2d.clearRect(0, 0, getWidth(), getHeight());`都不做。`this.surface.setOpaque(false);`这几乎就像这条线在 linux 上禁用了双缓冲。

*有一个半透明的窗口**是**必需的。*

# css - 是否可以在 :first-child:after 上使用 :hover ？

> ID：15704955
> 
> 赞同：2
> 
> 时间：2013-03-29T14:10:19.207
> 
> 标签：css, pseudo-class

**HTML**

```
<div>
    <div></div>
</div> 
```

**CSS**

```
div > :first-child:after {
    background-color: orange;
    color: #fff;
    font-family: sans-serif;
    font-size: 50px;
    line-height: 50px;
    text-align: center;
    vertical-align: middle;
    -webkit-font-smoothing: antialiased;
    content: "hello world";
    display: block;
    font-size: 50px;
    height: 160px;   
    line-height: 160px;
    margin-top: 14px;
    font-weight: normal;
}
div > :first-child:after:hover {
    background-color: #44b800;
} 
```

**小提琴**

[http://jsfiddle.net/VSBr6/](http://jsfiddle.net/VSBr6/)

基本上，我想做的就是改变悬停时的背景颜色，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T14:13:20.233

你可以这样做：

```
div:first-child:hover::after {
    background-color: #44b800;
} 
```

# javascript - 如何访问我的 MVC 控制器中的 JavaScript 数组？

> ID：15704957
> 
> 赞同：0
> 
> 时间：2013-03-29T14:10:39.600
> 
> 标签：javascript, asp.net-mvc-3

我在 javascript 中创建了一个数组。现在我想使用数组控制器。目前我正在使用`FormCollection`从表单访问数据。有没有办法访问我的javascript数组`FormCollection`或作为参数`Html.BeginForm()`？

我尝试使用我在论坛上找到的一些示例来发布 JSON 帖子，但控制器中的数组为空。您能否提供在控制器中访问我的 javascript 数组的最佳方法？

```
<script type="text/javascript">

  var $checkboxes = $('input[type="checkbox"]');

  $(document).ready(function () {
      $('#saveBtn').click(function () {
          var checkList = new Array();
          $.each($checkboxes, function () {
              if ($(this).is(':checked')) {

                  checkList.push('checked');
              }
              else
                  checkList.push('unchecked');
          });
          alert(checkList);

      });

  });             
</script> 
```

更新 1

```
 $(document).ready(function () {
            $('#saveBtn').click(function () {
               var options= [];
 $.each($checkboxes, function () {
 if ($(this).is(':checked')) {
  var item={ "UserChoice" : "checked", "OptionID": "YouCanSetIDHere"};
   }
  else
 {
  var item={ "UserChoice" : "unchecked", "OptionID": "YouCanSetIDHere"};
}
 options.push(item);
}
   $.ajax({ type: "POST", url: '@Url.Action("Edit","Attendance")',
            contentType: "application/json",
            data: JSON.stringify(options)
  }).done(function (html) {
           //do something with the response.
         });

        });

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:23:44.113

您可以创建类似于您的视图模型的项目并将其推送到您的数组并使用 jQuery post 发布。在您的控制器操作中，您可以使用视图模型的集合来接受它。MVC 模型绑定将负责其余的工作。

假设你有一个像这样的 ViewModel

```
public class UserOptionVM
{
  public string OptionID{ set;get;}
  public string UserChoice { set;get;}
} 
```

在你的 Action 方法中，你接受这个集合

```
[HttpPost]
public ActionResult Save(List<UserOptionVM> model)
{
  // loop through collection and read and save 

} 
```

现在更改您的 Js 文件以发送与我们的视图模型匹配的内容。

```
var options= [];
$.each($checkboxes, function () {
   if ($(this).is(':checked')) {
      var item={ "UserChoice" : "checked", "OptionID": "YouCanSetIDHere"};
   }
   else
   {
      var item={ "UserChoice" : "unchecked", "OptionID": "YouCanSetIDHere"};
   }
   options.push(item);
});

$.ajax({ type: "POST",
         url: "@Url.Action("Save","User")",
         contentType: "application/json",
         data: JSON.stringify(options)
      }).done(function (html) {
               //do something with the response.
             }); 
```

# java - JSF2.0 @ManagedProperty - 无法到达的目标返回 null

> ID：15704958
> 
> 赞同：0
> 
> 时间：2013-03-29T14:10:43.360
> 
> 标签：java, jsf, jsf-2

我在 JSF 2.0 中使用@ManagedProperty，但我遇到了以下问题。

**实体类**

```
@Entity(name="UserDetail")
@Table(name="in_user")
@SessionScoped
public class UserDetail implements Serializable{

    private static final long serialVersionUID = 1L;

    @Id
    private Integer no;
    private String userName;
    private String password;

    public Integer getNo() {
        return no;
    }
    public void setNo(Integer no) {
        this.no = no;
    }
    public String getUserName() {
        return userName;
    }
    public void setUserName(String userName) {
        this.userName = userName;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }

} 
```

**控制器**

```
@ManagedBean(name="authenticator")
@RequestScoped
public class Authenticator implements Serializable {

    private static final long serialVersionUID = 1L;

    @ManagedProperty(value = "#{userDetail}")
    private UserDetail userDetail;

        // Some Code......
} 
```

**.XHTML**

```
<p:panel header="Application Login" toggleable="true" toggleOrientation="horizontal" style="width:400px">
                <p:panelGrid columns="2" columnClasses="0">
                    <h:outputLabel value="User Name " />
                    <h:inputText value="#{authenticator.userDetail.userName}" />

                    <h:outputLabel value="Password " />
                    <h:inputSecret value="#{authenticator.userDetail.password}" />

                    <p:commandButton value="Login" action="#{authenticator.authenticate}"></p:commandButton>
                    <p:commandButton value="Log Out" action="#{authenticator.logOut}" />
                </p:panelGrid>
            </p:panel> 
```

当我执行应用程序时，我面临以下问题..

```
Mar 29, 2013 7:26:56 PM com.sun.faces.lifecycle.ProcessValidationsPhase execute
WARNING: /login.xhtml @21,66 value="#{authenticator.userDetail.userName}": Target Unreachable, 'userDetail' returned null
javax.el.PropertyNotFoundException: /login.xhtml @21,66 value="#{authenticator.userDetail.userName}": Target Unreachable, 'userDetail' returned null
    at com.sun.faces.facelets.el.TagValueExpression.getType(TagValueExpression.java:100)
    at com.sun.faces.renderkit.html_basic.HtmlBasicInputRenderer.getConvertedValue(HtmlBasicInputRenderer.java:95)
    at javax.faces.component.UIInput.getConvertedValue(UIInput.java:1030)
    at javax.faces.component.UIInput.validate(UIInput.java:960)
    at javax.faces.component.UIInput.executeValidate(UIInput.java:1233)
    at javax.faces.component.UIInput.processValidators(UIInput.java:698)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at org.primefaces.component.panel.Panel.processValidators(Panel.java:297)
    at javax.faces.component.UIForm.processValidators(UIForm.java:253)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIViewRoot.processValidators(UIViewRoot.java:1172)
    at com.sun.faces.lifecycle.ProcessValidationsPhase.execute(ProcessValidationsPhase.java:76)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:395)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:250)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

我不知道问题出在哪里。

如果我更换。

```
@ManagedProperty(value = "#{userDetail}")
    private UserDetail userDetail; 
```

和

```
private UserDetail userDetail = new UserDetail(); 
```

然后它工作正常。但我想使用@ManagedProperty。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T20:39:57.757

因为我只能根据我的个人经验来回答，如果你在尝试了你在这篇文章中得到的所有答案后仍然没有解决你的问题，我建议你去 Project--->clean 如果你使用的是 Eclipse（我不知道其他IDE）。实际上，我遇到了完全相同的问题，只能通过这个解决方案解决它，但仍然不知道它发生的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T17:57:46.403

`@SessionScoped`不添加 @ManagedBean 无效。这也没有意义，因为 JSF 将创建一个空的 UserDetails bean。

似乎您需要在那里添加一个从 UserDetails 实体中提取详细信息的服务。

```
@RequestScoped
public class Authenticator implements Serializable {

    private static final long serialVersionUID = 1L;

    @ManagedProperty(value = "#{userService}")
    private UserService userService;

    public UserDetail getUser(long id){
        return  userService.getUser(id);
    }
} 
```

如果您不使用 Spring，那么您可以将您的服务应用程序设置为范围，

```
@ManagedBean
@ApplicationScoped
public  class UserService {

          public UserDetail getUser(long id){
                    return  em.createQuery("Select UserDetail .... where id ...");
          }    
} 
```

**如果您使用 Spring** ，您的服务可能如下所示，

```
 @Service
     public class UserService {            
          public UserDetail getUser(long id){
                    return  em.createQuery("Select UserDetail .... where id ...");
          }    
} 
```

**如果您使用的是 spring**，那么您需要添加 Spring EL 解析器来解析您的 spring 服务

```
<faces-config>
  <application>
    <el-resolver>org.springframework.web.jsf.el.SpringBeanFacesELResolver</el-resolver>
  </application>
</faces-config> 
```

# javascript - 返回 false 在表单提交中不起作用

> ID：15704959
> 
> 赞同：0
> 
> 时间：2013-03-29T14:10:46.270
> 
> 标签：javascript, jquery, ajax, forms, submit

这就是我所拥有的，表格仍然进入页面？我从凌晨 1 点起就一直在努力解决它！帮助！

```
function del_entry() {
    $('.delete_deal').submit(function() {
        var $g = $(this);                             
        $.ajax({
            url: $g.attr('action'),
            type: $g.attr('method'),
            data: $g.serializeArray(),
            cache: false,
        });
    }); 
    return false;
}; //end del_entry 
```

并以我的形式：

```
<form name="delete_deal" action="inactivate_deal.php" class="delete_deal" method="post">
<a href="#" class="button" onClick="$('#deal_div_id').fadeOut(); del_entry();">Delete</a></form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:42:54.577

由于您是`del_entry()`从 HTML 调用该函数，因此您可以简单地执行以下操作：

```
function del_entry() 
{
    var $g = $('.delete_deal');

    $.ajax({
        url: $g.attr('action'),
        type: $g.attr('method'),
        ta: $g.serializeArray(),
        cache: false
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:12:26.620

您需要`false`从`submit()`函数返回：

```
function del_entry(){
    $('.delete_deal').submit(function(){
        var $g = $(this);                             
                 $.ajax({
                 url: $g.attr('action'),
     type: $g.attr('method'),
             ta: $g.serializeArray(),
    cache: false,
           });
    return false;
    }); 
}; //end del_entry 
```

您还需要防止浏览器的默认行为启动锚元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T14:12:36.183

只需将`return false;`上面的一行...`;)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T14:13:35.293

```
function del_entry(){
$('.delete_deal').submit(function(){
    var $g = $(this);                             
             $.ajax({
             url: $g.attr('action'),
     type: $g.attr('method'),
             ta: $g.serializeArray(),
    cache: false,
           });

         return false; // <----------------- ADD HERE

}); 

}; //end del_entry 
```

# php - php/javascript/json/ajax 的互通

> ID：15704962
> 
> 赞同：-1
> 
> 时间：2013-03-29T14:10:58.857
> 
> 标签：php, javascript, ajax, json

这个问题可能是概念性的（不是面向编程的），但我觉得我需要了解这些如何协同工作才能正确编程。

我所知道的：
1）php 是一种可以与 html 一起使用的编程语言
2）从 html 调用 javascript
3）json 用于将 php 数组转换为 javascript 数组
4）ajax 是一种调用 json 的方法

所以我的问题是......
1）哪个优先？即是在php 之前调用javascript 代码吗？
2）当你在javascript中有ajax请求json时......什么时候调用？是在php之后吗？

我很困惑事情是如何相互合作的，就像首先和最后的步骤一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T14:21:28.717

我将纠正你所说的所有不准确之处。看起来你是自学成才（顺便说一句，这不是一件坏事）。

*   HTML 是一种标记语言。
*   PHP 是一种服务器端处理语言，可以（如果需要）输出 HTML
*   JavaScript 是一种客户端处理语言，可以（如果需要）修改文档对象模型（HTML 文档，如果您愿意，但不完全准确）
*   JSON 是一种标记语言。通常用于传输数据。
*   AJAX 是一种 JavaScript 技术，通常用于在不刷新页面的情况下从客户端触发服务器端进程。

因此，PHP “构建”了您的 HTML，而 JavaScript 允许您丰富它。AJAX 是 JS 函数 (xmlHTTPRequest & co) 的子集，它允许您 ping PHP 页面（或其他页面！）以从它们获取数据。如果他们输出 JSON，您可以解析此 JSON 对象以取回一个对象。

典型例子：

**测试页.html**

```
<!doctype html>
<head>
<title>Test page</title>
</head>
<body>
<textarea id="test""></textarea><button id="mybtn">Test</button>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">
 $(function() {
  $("#mybtn").click(function() {
   $.ajax({
       url: "page.php",
       type: "GET",
       dataType: "json",
       success: function(d) {
          $("#test").text(d.randomNumber);
       } 
    });
    return false;
   });
  });
  </script>
 </body>
</html> 
```

**页面.php**

```
<?php echo json_encode(array("randomNumber" => rand(1,10))); ?> 
```

如果你运行它（我已经在[http://www.sebrenauld.co.uk/testpage.html](http://www.sebrenauld.co.uk/testpage.html)上自由地托管它），当你点击按钮时，你会在 textarea 中看到一个随机数。

**当您单击该按钮时实际发生了什么？**

当您单击该按钮时，您的浏览器会通过 GET 向 /page.php 发出请求。此请求返回一个 JSON 对象，jQuery 自动将其解释为该`d`对象。jQuery 然后触发`success`回调，更新表单。瞧！

有任何问题，请不要犹豫。我是来帮忙的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T14:19:04.263

*   PHP 是一种可以生成 HTML 的动态编程语言 - 它在服务器上运行
*   JavaScript 是一种在客户端（浏览器）上运行的动态编程语言
*   JSON 是[JavaScript 对象表示法](http://en.wikipedia.org/wiki/JSON)，并非特定于 PHP，尽管它可用于使用 PHP 将 PHP 数组打印到 JavaScript 数组中。
*   AJAX 是一种在 JavaScript 中发出异步请求和接收响应的方法。
*   PHP 必须生成包含调用 JavaScript 所需标记的 HTML，所以它是第一位的。
*   PHP 在生成页面时在开始时被调用。AJAX 请求可以调用 PHP 代码所在的 URL。原始页面上的 JavaScript 可以在 PHP 生成响应时运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T14:41:10.633

以下是这些部分如何组合在一起的广泛概述：

### 服务器与客户端

要理解所有部分，您需要了解服务器和客户端之间的区别。

当您通过在浏览器的地址栏中输入地址、单击链接等方式打开网页时，您的网络浏览器会向另一台计算机发送请求，该计算机位于存储您想要的网页的其他位置。它本质上是向那台计算机询问网页，然后那台计算机决定你得到什么。我们将这台计算机称为“服务器”，因为它正在为您“服务”网页。

一旦服务器完成了它需要做的任何处理，它就会将页面发送回您的浏览器。然后，您的浏览器会解释您返回的数据并以漂亮的方式显示给您（假设网页设计师做得很漂亮）。我们将您的浏览器称为“客户端”。

现在对于您询问的特定技术：

### PHP

PHP 被称为“服务器端”语言。这意味着它在服务器上运行以帮助生成将发送回浏览器的网页。它在您的浏览器看到它之前运行。

### JavaScript

JavaScript 被称为“客户端”语言。它在您的浏览器中运行，改变事物，加载新信息，使页面具有交互性。它在页面加载之前永远不会运行（有时*在*页面加载时，但在您的浏览器开始解释页面之前永远不会运行）。需要记住的重要一点是，PHP 可以在它生成的 HTML 中生成 JavaScript，因为无论如何，这就是 JavaScript 所在的地方。

### JSON

JSON 是代表“JavaScript Object Notation”的首字母缩写词。JSON 不是一种语言；它是 JavaScript 的一个元素。JSON 什么都不*做*；它是一种以有组织、有用的方式表示数据的方法。

PHP 可以在 JavaScript 块中“打印”一个 JSON 对象，作为一种以有用的格式将数据直接传递给客户端的方式。可以使用诸如 之类的函数将 PHP 对象“转储”为 JSON `json_encode()`，一般来说，该函数返回复杂数组或对象的 JSON 表示。

请注意，JSON 不仅仅是一个数组。请进一步调查。

### AJAX

AJAX 是代表“异步 JavaScript 和 XML”的另一个首字母缩写词。（这是一个有点误导性的名称，因为 XML 不一定是该过程的一部分，而且现在变得越来越少见，所以不要担心名称的那一部分。）

简而言之，AJAX 本身也不是一门语言。它更像是 JavaScript 中的一种*技术*，可以从服务器请求更多信息/数据，而无需重新加载整个网页。

正如您所说，AJAX 更常见的用途之一是从服务器请求 JSON 对象。这绝不是 AJAX 的*唯一*用途，但它是一种常见的用途，尤其是在交互式应用程序中。

### 优先事项

简短的回答：PHP 出现在 JavaScript 之前，因为它存在于服务器上；JSON 和 AJAX 是 JavaScript 语言的元素，因此它们发生在 JavaScript 中，在浏览器中。

每当您的 JavaScript 进行 AJAX 调用以从服务器请求一些 JSON 时，PHP 将成为用于解释请求并将 JSON 发送回浏览器的语言，这是一个很好的变化。

--

希望这会有所帮助。您应该查看[Zend](http://devzone.zend.com/)和[Mozilla Developer Network](https://developer.mozilla.org/en-US/)等资源。以下是一些不错的起点：

*   [PHP](http://devzone.zend.com/6/php-101-php-for-the-absolute-beginner/)
*   [JavaScript](https://developer.mozilla.org/en-US/docs/JavaScript)
*   [JSON](https://developer.mozilla.org/en-US/docs/JSON)
*   [AJAX](https://developer.mozilla.org/en-US/docs/Ajax)

# asp.net - ASP.Net ListItem 值属性最大长度

> ID：15704963
> 
> 赞同：0
> 
> 时间：2013-03-29T14:10:59.447
> 
> 标签：asp.net, properties, listitem

似乎是一个非常简单的问题，但我在任何地方都找不到。有谁知道 ListItem 的值可以是最大长度吗？

我确信这比我所做的事情所需要的要多，但只是想确定一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:31:54.447

我认为理论上是无限的。因此，它仅受您的内存或浏览器功能的限制。

*   [HTML 属性的长度有限制吗？](https://stackoverflow.com/questions/1496096/is-there-a-limit-to-the-length-of-html-attributes?lq=1)
*   [最大页面长度的浏览器限制](https://stackoverflow.com/questions/1076622/browser-limitation-with-maximum-page-length/12629931#12629931)

在服务器端，它通常可以和字符串一样长。那是`int.MaxValue`字符。但是你会更早地在客户端遇到问题。

*   [.NET 字符串的最大可能长度是多少？](https://stackoverflow.com/questions/140468/what-is-the-maximum-possible-length-of-a-net-string)

# c++ - 在循环向量时可以使用 int 而不是 size_t 吗？

> ID：15704966
> 
> 赞同：0
> 
> 时间：2013-03-29T14:11:12.133
> 
> 标签：c++, warnings, unsigned, signed

如果我有一个整数向量

```
vector<int> vec; 
```

我按以下方式循环

```
for(int i=0; i<vec.size(); i++)
{
   // do something
} 
```

我收到有符号/无符号不匹配警告。

当然我可以声明`i`类型`size_t`来解决问题。但是如果我保持不变`i`，`int`我会在运行时遇到一些问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T14:25:47.623

请改用向量`iterator`。

```
vector<int>::iterator it;
for (it = vec.begin(); it!= vec.end(); ++it)
{
   //do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T14:13:24.863

当然，如果`vec.size()`大于有符号整数的最大值。

`limits.h`您可以在此[表](http://www.cplusplus.com/reference/climits/)中找到最大值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-29T14:14:35.540

是的。对于超过 a`signed`可以存储的值的大数字，这将是未定义的行为。

但是，对于可以存储在 a 中的少量数字，`signed`没关系。

# php - 从数据库中提取 5 个条目，修改条目，将这 5 个条目放入一个数组中，这样我就可以找到平均值

> ID：15704971
> 
> 赞同：0
> 
> 时间：2013-03-29T14:11:21.437
> 
> 标签：php, arrays

我正在从数据库中提取 5 个条目，它工作正常。然后我为每个条目做一些数学运算以获得不同的数字。这 5 个数字将彼此相邻显示。我需要将这 5 个条目放入一个数组中，然后选择这 5 个条目的平均值，所以我只有一个实数。

从 mysql_fetch_array 中，我提取了最新的 5 个条目的 $last_score、$blue_rating 和 $blue_slope。现在这是我所在的位置：

```
$query_p1 = "SELECT * FROM scorecards WHERE player_id='$player_id' LIMIT 5";
        $result_p1 = mysql_query($query_p1);
        while ($row_p1 = mysql_fetch_array($result_p1)) {
            $blue_rating = $row_p1["blue_rating"];
            $blue_slope = $row_p1["blue_slope"];
            $last_score = $row_p1["total_score"];

$handicap = (((($last_score - $blue_rating) * 113) / $blue_slope) * .96);

echo "$handicap <br>";

} 
```

这 5 个回声是我在单个数组中需要的，平均为 5 个。任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:14:14.850

代替

```
echo "$handicap <br>"; 
```

放

```
$handicaps[]= $handicap; 
```

然后在循环之外你可以做

```
echo array_sum($handicaps)/5; 
```

# gtkmm - 覆盖 gtkmm 中的信号处理程序

> ID：15704977
> 
> 赞同：1
> 
> 时间：2013-03-29T14:11:48.557
> 
> 标签：gtkmm

我在下面的代码中挣扎。我的信号处理程序 on_button_press_event() 从未被调用，但我不知道为什么。有人可以看看吗？也许有人能够通过调试信息运行 gtkmm 库。我只有预装的 gtkmm 包，这些包不能用于调试到库本身。

```
 #include <iostream>

    using namespace std;

    #include <gtkmm.h>
    #include <goocanvasmm.h>

    bool MyExternalHandler( const Glib::RefPtr<Goocanvas::Item>& item, GdkEventButton* ev )
    {
        cout << "External Handler" << endl;
        return false; 
    }

    class MyRect : public Goocanvas::Rect
    {
        public:
            MyRect( double x, double y, double w, double h)
                //: Goocanvas::Rect( x,y,w,h)
        {
            property_x()=x;
            property_y()=y;
            property_width()=w;
            property_height()=h;
        }

        public:
            virtual void nonsens() {}

            bool on_button_press_event(const Glib::RefPtr<Item>& target, GdkEventButton* event) override
            {
                cout << "override handler" << endl;
                return false;
            }

            bool Handler( const Glib::RefPtr<Goocanvas::Item>& item, GdkEventButton* ev )
            {
                cout << "via mem_fun" << endl;
                return false;
            }

            bool on_enter_notify_event(const Glib::RefPtr<Item>& target, GdkEventCrossing* event) override
            {
                cout << "override enter notify" << endl;
                return false;
            }
    };

    int main(int argc, char* argv[])
    {
        Gtk::Main app(&argc, &argv);
        Goocanvas::init("example", "0.1", argc, argv);
        Gtk::Window win;
        Goocanvas::Canvas m_canvas;
        m_canvas.set_size_request(640, 480);
        m_canvas.set_bounds(0, 0, 1000, 1000);

        MyRect* ptr;
        Glib::RefPtr<MyRect> m_rect_own(ptr=new MyRect(225, 225, 150, 150));
        m_rect_own->property_line_width() = 1.0;
        m_rect_own->property_stroke_color() = "black";
        m_rect_own->property_fill_color_rgba() = 0x555555ff;     

        Glib::RefPtr<Goocanvas::Item> root = m_canvas.get_root_item();
        root->add_child( m_rect_own);

        ((Glib::RefPtr<Goocanvas::Item>&)m_rect_own)->signal_button_press_event().connect(sigc::ptr_fun(&MyExternalHandler));
        ((Glib::RefPtr<Goocanvas::Item>&)m_rect_own)->signal_button_press_event().connect(sigc::mem_fun(*ptr, &MyRect::Handler));

        win.add(m_canvas);

        win.show_all_children();

        Gtk::Main::run(win);
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-12T07:38:56.083

您的 on_button_press_event() 方法不是覆盖，因为它的参数错误： [https ://developer.gnome.org/gtkmm/unstable/classGtk_1_1Widget.html#aba72b7f8655d1a0eb1273a26894584e3](https://developer.gnome.org/gtkmm/unstable/classGtk_1_1Widget.html#aba72b7f8655d1a0eb1273a26894584e3)

# sharepoint - 周和月的 CAML 查询不起作用

> ID：15704978
> 
> 赞同：1
> 
> 时间：2013-03-29T14:11:50.797
> 
> 标签：sharepoint, sharepoint-2010, caml

我关注 CAML 查询不起作用：

```
<Where><DateRangesOverlap><FieldRef Name=\"EventDate\" /><FieldRef Name=\"RecurrenceID\" /><Value Type=\"DateTime\"><Week /></Value></DateRangesOverlap></Where> 
```

**和**

```
<Where><DateRangesOverlap><FieldRef Name=\"EventDate\" /><FieldRef Name=\"RecurrenceID\" /><Value Type=\"DateTime\"><Month/></Value></DateRangesOverlap></Where> 
```

但这一个有效：

```
<Where><DateRangesOverlap><FieldRef Name=\"EventDate\" /><FieldRef Name=\"RecurrenceID\" /><Value Type=\"DateTime\"><Yearly /></Value></DateRangesOverlap></Where> 
```

唯一的区别是工作查询具有`<Yearly />`日期时间，而非工作查询具有`<Week />`和`<Month />`。

这对我来说是一个大问题，因为它对性能有很大的影响。有人可以就这里可能发生的事情提供一些指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T01:58:39.597

DateRangesOverlap 有很多问题，您所面临的问题可能会在此处进行解释：[问题](http://pholpar.wordpress.com/2008/03/04/using-month-element-in-daterangesoverlap-can-return-items-not-in-the-specified-month/)。同一作者提供了解决[方案](http://pholpar.wordpress.com/2011/11/11/how-to-find-overlapping-items-for-a-date-range/)

# image-processing - jpg的插件质量中的typo3调整大小

> ID：15704979
> 
> 赞同：0
> 
> 时间：2013-03-29T14:11:54.760
> 
> 标签：image-processing, typo3

我在我的typo3插件中成功调整了miages的大小，但我对调整大小的图像质量有疑问。我尝试了许多不同的东西，但图像质量保持不变。

我的代码：

```
$imgConfig['file'] = 'GIFBUILDER';
$imgConfig['file.']['quality']  = 99;
$imgConfig['file.']['jpg_quality']  = 99;
$imgConfig['file.']['backColor'] = '#ffffff'; 
$imgConfig['file.']['transparentColor'] = '#ffffff';
$imgConfig['file.']['10'] = 'IMAGE';
$imgConfig['file.']['XY'] = '[100.w],[100.h]';
$imgConfig['file'] = $entry['image_small'];
$origImg = $this->cObj->IMAGE($imgConfig);
$resizedImageInfo = $GLOBALS['TSFE']->lastImageInfo; 
```

我还在安装工具中设置了值： [GFX][jpg_quality] = 99 [GFX][png_truecolor] = 1

我使用扩展 JB GD Resize (jb_gd_resize)，但我不认为这是问题所在。我还能尝试什么？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T09:44:47.617

> ...我使用扩展 JB GD Resize (jb_gd_resize)，但我不认为这是问题所在。

你错了。这**就是**问题所在。看看它刚刚使用的 jb_gd_resize (1.1.5) 的来源

```
imagejpeg($newIm,$output); 
```

[imagejpeg()](http://php.net/manual/en/function.imagejpeg.php)的第三个参数是“质量”，根本没有使用。因此使用默认值，您可以获得 75 左右的质量，独立于任何其他设置。

# javascript - 物体在滑过它们时消失，而它们淡入

> ID：15704984
> 
> 赞同：0
> 
> 时间：2013-03-29T14:12:04.130
> 
> 标签：javascript, jquery, animation, fadein

我对一些 jQuery fadeIn 效果有疑问。这实际上是在这个网站上：[website here](http://tucado.com/index.html)。当您从主菜单中选择任何选项并在页面加载期间（菜单淡入）滑过菜单按钮时，就会出现问题。然后它们中的一些（你正在淡出的那个）不会出现，或者会出现轻微的褪色。我已将此代码用于按钮：

HTML：

```
 <nav>
                <a id="b1" href="index.html"><span>01\. <strong>ABOUT US</strong></span><div></div></a>
                <a id="b2" href="webdesign.html"><span>02\. <strong>WEBSITE DESIGN</strong></span><div></div></a>
                <a id="b3" href="mobile-websites.html"><span>03\. <strong>MOBILE WEBSITES</strong></span><div></div></a>
                <a id="b4" href="captive-portals.html"><span>04\. <strong>CAPTIVE PORTALS</strong></span><div></div></a>
                <a id="b5" href="portfolio.html"><span>05\. <strong>PORTFOLIO</strong></span><div></div></a>
                <a id="b6" href="contact-us.html"><span>06\. <strong>CONTACT US</strong></span><div></div></a>
            </nav> 
```

查询：

```
$(document).ready(function(){
$("nav a").mouseenter(function () {
    $('div', this).stop(true, false).animate({
        'height': '65px'
    }, 100);
    $(this).stop(true, false).animate({
        'padding-top': '5px'
    }, 300);
}).mouseleave(function () {
    $('div', this).stop(true, false).animate({
        'height': '0px'
    }, 300);

    $(this).stop(true, false).animate({
        'padding-top': '25px'
    }, 500);
});

$('#b1, #b2, #b3, #b4, #b5, #b6, #b7').hide();

for (var i=1; i<99; i++) {
  (function(i){
    setTimeout(function() {
       $('#b'+i).fadeIn(500);
     }, 300+100*i);
  })(i);
}
 }); 
```

JS 小提琴在这里：http: [//jsfiddle.net/tucado/9hhZW/](http://jsfiddle.net/tucado/9hhZW/)

（在淡入时将鼠标滑过按钮，您就会明白我的意思）。基本上我希望按钮正常显示，这样在它们上方的滑动鼠标就不会中断它们褪色到 100%。

提前感谢您对此问题的任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:18:18.303

如果元素正在动画，只需从 mouseenter 和 mouseleave 处理程序返回，您可以使用`.is(':animated')`.

见工作[小提琴](http://jsfiddle.net/gnel/9hhZW/1/)

**更新：**我上面的解决方案将在元素动画时退出，但这也包括mouseenter，mouseleave处理程序自己的动画，我们只想在它是淡入淡出动画时退出，所以为了区分我设置了一个`fading`在开始时调用的属性淡化一个元素并在它结束淡化效果时将其移除，因此我们可以在 mouseenter mouseleave 处理程序中检查此属性。

查看[新的工作小提琴](http://jsfiddle.net/gnel/9hhZW/4/)

我在这里粘贴代码：

```
$(document).ready(function(){
    $("nav a").mouseenter(function () {
        if ($(this).data('fading'))  //EXIT IF WE ARE FADING
            return;
        $('div', this).stop(true, false).animate({
            'height': '65px'
        }, 100);
        $(this).stop(true, false).animate({
            'padding-top': '5px'
        }, 300);
    }).mouseleave(function () {
        if ($(this).data('fading'))  //EXIT IF WE ARE FADING
            return;
        $('div', this).stop(true, false).animate({
            'height': '0px'
        }, 300);

        $(this).stop(true, false).animate({
            'padding-top': '25px'
        }, 500);
    });

    $('#b1, #b2, #b3, #b4, #b5, #b6, #b7').hide();

    for (var i=1; i<99; i++) {
      (function(i){
        setTimeout(function() {
            $('#b'+i).data('fading', true).fadeIn(500, function() {
               $(this).data('fading', false);
            });
         }, 300+100*i);
      })(i);
    }   
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:19:43.737

我认为问题是，在元素初始化之前停止元素动画（第一个fadeIn（）；）

我已经为您创建了一个小提琴，使用fadeIn() 回调在第一次显示后附加悬停：

```
$(document).ready(function(){

var appendHover = function () {    
    $("nav a").mouseenter(function () {
        $('div', this).stop(true, false).animate({
            'height': '65px'
        }, 100);
        $(this).stop(true, false).animate({
            'padding-top': '5px'
        }, 300);
    }).mouseleave(function () {
        $('div', this).stop(true, false).animate({
            'height': '0px'
        }, 300);

        $(this).stop(true, false).animate({
            'padding-top': '25px'
        }, 500);
    });
}

    $('#b1, #b2, #b3, #b4, #b5, #b6, #b7').hide();

    for (var i=1; i<99; i++) {
      (function(i){
        setTimeout(function() {
            $('#b'+i).fadeIn(500, function() {appendHover();});
         }, 300+100*i);
      })(i);
    }   
 }); 
```

[http://jsfiddle.net/9hhZW/2/](http://jsfiddle.net/9hhZW/2/)

# google-maps - 我们如何使用 google geocode api 找到距离持续时间（时间）？

> ID：15704992
> 
> 赞同：0
> 
> 时间：2013-03-29T14:12:34.610
> 
> 标签：google-maps, geocoding, google-geocoder

我们如何使用google geocode api找到世界上两个城市之间的距离持续时间（时间）和距离？

如果我想找到 2 个地理编码之间的距离持续时间（行驶时间），那么我如何通过地理编码 api 找到？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:53:39.040

[Geocoding API](https://developers.google.com/maps/documentation/geocoding/)不会这样做，它会查找地址的地理坐标。[Directions API](https://developers.google.com/maps/documentation/directions/)或[Distance Matrix API](https://developers.google.com/maps/documentation/distancematrix/)将为您提供两个（或更多在距离矩阵的情况下）位置之间的行驶时间和距离。

# deployment - 使用 Github 轻松部署？

> ID：15704999
> 
> 赞同：1
> 
> 时间：2013-03-29T14:13:06.017
> 
> 标签：deployment, version-control, github, push, amazon-elastic-beanstalk

我现在在网上搜索了几个小时，但无法解决这个问题：

是否有一种简单的方法可以在每次推送时（或至少手动）将私有存储库从 Github 部署到登台/开发服务器？（最好只需要开发服务器的 FTP 数据）。

我发现了这个：[如何在 git push（GitHub 和 node.js）之后自动部署我的应用程序？](https://stackoverflow.com/questions/9132144/how-can-i-automatically-deploy-my-app-after-a-git-push-github-and-node-js)但是最佳答案中的这种“教程”停留在确切插入build.sh的地方。开发服务器上需要哪些模块？SSH、GIT、Ruby？也许这对您来说听起来很愚蠢，或者是我的错误想法，因为我在网上找不到任何答案。

问题是，大多数时候，应该部署主分支内容的服务器位于共享托管服务器上，在该服务器上，大多数解决方案并不总是有 SSH、GIT、Python、Ruby 等。从 github 部署似乎依赖于...：/

[http://beanstalkapp.com/](http://beanstalkapp.com/)在这方面真的很棒，您只需输入 FTP-Data 并自动或手动部署所选的存储库和分支。所以我想知道为什么我找不到类似的从 Github 部署的简单方法？

非常感谢您！

乔纳斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T16:25:59.433

目前尚不清楚您拥有哪种类型的项目，但这里有一些想法。

如果您的代码是用编译语言编写的，那么您可以：

1.  拥有另一条评论中提到的 Jenkins 服务器
2.  在 bash 中编写一个简单的脚本，执行 git pull 并编译并向其添加 cron 作业。
3.  使用像[Chef](http://www.opscode.com/chef/)或[Puppet](https://puppetlabs.com)这样的自动化框架，它会自动使编译的二进制文件保持最新。

如果您的代码是一种解释性语言（如 HTML 和 JavaScript），那么您可以：

1.  使用[vagrant](http://www.vagrantup.com)进行本地测试。最大的原因是更改在您的本地系统上进行。只需在您的机器上执行 git push 并在生产服务器上执行 git pull 即可使您的更改在全球范围内生效。

你最好的选择可能是#2。