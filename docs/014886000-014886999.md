# StackOverflow 问答 14886000-14886999

# drupal - 如何使用 hook_block_view 输出 HTML（由 PHP 创建）？

> ID：14886001
> 
> 赞同：0
> 
> 时间：2013-02-14T23:33:27.840
> 
> 标签：drupal

对于我正在创建的 Drupal 7 模块，我想从 hook_block_view 函数输出如下内容：

```
$block['subject'] = NULL;
$block['content'] = array(
  'list' => array(
    '#theme' => 'item_list',
    '#type' => 'ol',
    '#items' => $topics
   )
 ); 
```

...但我不想只输出一个简单的有序列表，例如：

```
<ol>
  <li>Topic 1</li>
  <li>Topic 2</li>
</ol> 
```

...我希望列表在其上方和下方有更多的 HTML 标记，并且我希望此 HTML 标记由某些 PHP 生成。

如何在 hook_block_view 函数中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:39:16.327

定义一个自定义主题并将您的 $topic 变量作为参数传递给它：

```
$block['content'] = theme('my_custom_theme', $topic); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:56:45.900

您也可以简单地将 html 字符串数据放入 $block['content']

# linux - 如何在不为每个架构设置环境的情况下为多种架构构建和测试 C linux 程序？

> ID：14886002
> 
> 赞同：2
> 
> 时间：2013-02-14T23:33:26.783
> 
> 标签：linux, architecture

假设我用 C 语言编写了一个简单的程序。它在我的主架构上成功构建并运行。

现在我想了解该程序可以构建和工作的架构；还为各种平台提供预构建的可执行文件供下载。然而，我只有几个。

最明显的方法似乎是为不同架构设置最大数量的交叉编译工具链和最大数量的可执行映像。但这似乎很不方便（特别是如果您只希望它用于一个小程序）。

如何以简单的方式做到这一点？我应该使用一些已经为各种架构的开发系统提供设置的在线服务吗？

期待这样的事情：

```
user$ ssh i386.buildhere.example
guest@i386 $ echo 'int main(){}' > hello.c
guest@i386 $ gcc hello.c -o hello
guest@i386 $ ./hello
guest@i386 $ file hello
hello: ELF 32-bit LSB executable, Intel 8038.... 
```

```
user$ ssh armel.buildhere.example
guest@armel $ .... 
```

...

如果还有各种过时的系统可用于测试“我的程序在那个遗留发行版上的表现如何？”，那么额外的好处应该是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:22:01.867

There is one thing that is ALMOST certain in programming: Whatever you do to test something will probably work, but whatever you haven't tested will fail when you give it to a customer.

Use of virtual machines will help to some degree to avoid having to buy unusual hardware, as does things like QEMU.

Unless your program is either REALLY trivial, or you want to use your customers [1] as guinea-pigs, you are best off testing on every platform-type that you want to release for. If you don't, it WILL come back and bite you at some point.

If you don't, you run the risk of some of your customers gets an "unhappy experience". An unhappy customer tells ten people, a happy customer tells maybe one person.

If you wish to support architectures/stuff that you don't have access to, maybe just having a "help yourself" option of source-code is a better choice than downloadable binaries.

Of course, you can rent time/space on servers of various kinds - I looked into writing an iPhone app, and there are places that run Mac's as virtual machines on the net that you can rent for around US$ 15 per month, for example.

[1] Throughout this answer, by customer, I mean anyone that downloads your software, regardless of whether they actually give some money to anyone, they will have spent some effort to get your software on their machine. If it doesn't work, then they will be unhappy to some degree. How unhappy depends on a number of things, including how clear you made it that "this may not work" if you were to publish "untested" software.

# sql - 将具有外键的第三个表中的记录复制到另一个表

> ID：14886005
> 
> 赞同：4
> 
> 时间：2013-02-14T23:33:42.943
> 
> 标签：sql, database, firebird

我有三个表：表 1 作为主表，表 2 作为表 1 的详细信息，表 3 作为表 2 的详细信息。

```
TABLE1
PK1 INTEGER, 
FD1 VARCHAR(100)

TABLE2
PK2 INTEGER,
FK1 INTEGER,
FD2 VARCHAR(100)

TABLE3
PK3 INTEGER,
FK2 INTEGER,
FD3 VARCHAR(100) 
```

PK1、PK2、PK3 分别是 table1、table2 和 table3 的自动递增主键，而 FK1 是 PK1 的外键，FK2 是 PK2 的外键。

我需要将 Table1 中的一条记录复制到同一个表中，其中包含 Table2 和 Table3 中的所有详细记录。

我已经使用了 Table1 和 Table2 的副本`Insert Into...Select...Returning`，我正在考虑将 Table2 和 Table3 记录复制到里面`FOR Select`。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T08:21:01.290

我不认为你真的有自动递增的主键。您更有可能使用生成器。如果是这样，那么您可以使用这种插入数据的方式：

```
insert into table1(pk1, fd1)
select gen_id(g_pk1,1), fd1
from table2 
```

如果需要，您可以在选择查询中使用连接或联合表。

请记住，要正确输出查询以适合插入语句。

# javascript - HTML5 Canvas Drawing 函数如果没有声明为 first 会阻塞其他 JS 函数

> ID：14886007
> 
> 赞同：1
> 
> 时间：2013-02-14T23:33:47.247
> 
> 标签：javascript, html, canvas, path, drawing

所以我有这个函数，我用它来画一个三角形来制作一个“漫画云”。无论如何，这是代码：

```
function drawTriangle(param)
{
var context = document.getElementById("triangle" + param).getContext("2d");

context.shadowColor   = '#111111';
context.shadowBlur    = 1;
context.shadowOffsetX = 3;
context.shadowOffsetY = 3;
context.fillStyle     = '#FFFFFF';
context.lineWidth     = 1;

context.beginPath();
    context.lineTo(16, 0);
    context.lineTo(8, 10);
    context.lineTo(0, 0);
context.closePath();
context.fill();
} 
```

我将此声明保留在部分中包含的 functions.js 中然后，在 HTML 文件的末尾，我包含我调用此函数的 script.js 文件：

```
for(i=1; i<=3; i++)
{
drawTriangle(i);
}; 
```

问题是，调用此函数后编写的每个代码都没有被执行。当然，作为最后一个 JS 函数调用它不是问题，但是感觉我做错了什么让我很烦。

那么有什么想法吗？尖端？谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:32:32.780

这里没有任何问题，但是如果`document.getElementById("triangle" + param)`返回`null`（如果 ID 不存在），那么您就有问题了。

因为没有`null.getContext("2d");`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T03:44:33.330

确保在 jquery ( [http://api.jquery.com/ready/](http://api.jquery.com/ready/) ) 的 .ready 中运行您的代码，或者在调用 getElementById() 之前让您的 DOM 加载。

在我将这个标准添加到我的实现之前，我浪费了好几个小时。

# logging - 系统范围的 machine.config log4net 设置与 Web 应用程序级别的配置设置

> ID：14886008
> 
> 赞同：2
> 
> 时间：2013-02-14T23:33:50.873
> 
> 标签：logging, error-handling, log4net

我正在尝试让 log4net 与 machine.config 设置和 web.config 设置（甚至自定义配置文件）一起使用，但它运行得不是很好。

我的目标是为所有 Web 应用程序设置系统范围的设置（即附加程序、级别），然后允许每个项目通过项目级别的配置设置添加额外的日志记录配置。

这可能吗？我开始不这么想，并且在想也许我将不得不依靠为系统范围的设置完全编程创建附加程序。在读取配置文件（即应用程序名称等）后，我确实需要修改系统范围的设置

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T10:09:02.563

据我所知，您的配置只能有一个来源。如果 log4net 允许更多，它将如何解决冲突的配置等等。在内部，它用于`XmlConfigurator`读取配置文件。如果您阅读更多配置文件，它只会记住您阅读的最后一个配置。

查找所有配置的最佳位置是：

[log4net 手动配置](http://logging.apache.org/log4net/release/manual/configuration.html)

# php - 基于表单中的Change事件动态构建AJAX请求

> ID：14886014
> 
> 赞同：0
> 
> 时间：2013-02-14T23:35:19.950
> 
> 标签：php, jquery, mysql

所以我有几个表单元素目前充当过滤器 - 我计划将其用作我网站上搜索功能的基础。

我正在考虑将一组更改事件链接到动态构建一个从一组表中选择字段的 AJAX 查询，但我不太确定如何去做。

在页面加载时，我有以下内容：[http://jsfiddle.net/uVhzZ/](http://jsfiddle.net/uVhzZ/)。此设置的伪 SQL 将是：（`SELECT * from ts_rooms WHERE capacity >= 50`任何表示未设置**WHERE**条件）

但是，当用户开始进行更改时，我希望将这些添加动态添加到 SQL 查询中 - 例如，如果 Lecture Style 设置为 Lab 并且容量更改为 75，那么伪 SQL 将更改为`SELECT * from ts_rooms WHERE capacity >= 75 AND lectureStyle="Lab"`;

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:15:29.560

首先你必须准备好你的 AJAX 请求，它可以通过创建一个包含你想要使用的所有选择的数组来完成（你可以查看 .val() 并且如果它有任何值，你可以使用选择 id 将此值添加到该数组中数组键）然后将其转换为 JSON。

PHP 将接收此 JSON 字符串并将其转换为数组。然后你可以查看这个数组，并为每个元素构建你的 where 语句。

然后只需获取查询结果集并从中构建另一个数组，转换为 JSON 并响应 JS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T11:28:50.810

将所有元素放在一个表单中，将其发布到您的 php 搜索文件中。创建了一个带有相关约束的 sql 查询，并以 json 格式返回数据并显示它。

# asp.net - 使用 iOS 发布到 ASP.NET Web 服务

> ID：14886020
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:35:59.233
> 
> 标签：asp.net, ios

我已经通过自动生成的服务网页设置了我在服务器上测试过的 ASP.NET Web 服务。

但我无法通过 iOS 应用程序正确地向其发布数据。**我没有收到任何错误，但它也没有触发 Web 服务的方法。

请帮忙..

```
NSURL *siteURL = [NSURL URLWithString:@"http://server/.../IOSDataWebService/Service1.asmx?op=testMethod"];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:siteURL];
[request setHTTPMethod:@"POST"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"content-type"];
NSString *postString = @"fieldToAdd=TestString";
[request setHTTPBody:[postString dataUsingEncoding:NSUTF8StringEncoding]];
[request setValue:postString forHTTPHeaderField:@"Content-Length"];
[NSURLConnection connectionWithRequest:request delegate:self]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:52:24.297

尝试设置`postString.length`，而不是`postString`本身，作为`Content-Length`标题的值。

哦，等等，你不能在那里只设置一个裸整数。让我们尝试将其包装为 a`NSNumber`而不是`@(postString.length)`.

# recursion - 以 c>2 方式拆分数组的合并算法

> ID：14886021
> 
> 赞同：1
> 
> 时间：2013-02-14T23:35:59.330
> 
> 标签：recursion, asymptotic-complexity

作为一个示例问题，我们被要求创建一个合并排序的变体，它将数组拆分为`c>2`大小大致相等的数组（当`c = 2`它将使用常规合并时）

这是解决方案：

```
 cmerge(a1, a2, .... ac)
    if c = 2 return Merge(a1, a2)
     else 
     b1 = cmerge(a1, a2,...a(c/2), floor(c/2))
     b2 = cmerge(a(roof(c/2)),... ac, roof(c/2))
     return merge(b1,b2) 
```

我知道他们从哪里得到这个解决方案，但是当它要求重复关系时会有点困惑。在他们声明的问题中，可以合并 c 个排序数组，`O(n log c)` 这使得第一种情况清楚

```
T(n) = c(T(n/c)) + nlogc if n>= c
T(n) = theta(n^2) for n<c   <----------- can someone explain where they are getting this? 
```

我只是真的不明白`n^2`是从哪里来的。在第二种情况下，不是只有一个对 MERGE 的调用吗？`theta(n)`如果我记得的话，合并就是。

# python - gtk MessageDialog 在封闭方法完成之前不会关闭

> ID：14886023
> 
> 赞同：0
> 
> 时间：2013-02-14T23:36:11.213
> 
> 标签：python, dialog, gtk, pygtk, messagedialog

这是我在 GUI 中尝试做的模拟版本。我有一个在执行回调方法期间在某处创建的 MessageDialog。我的问题是 MessageDialog 在回调方法完成执行之前不会关闭。

我有一个“dialog.destroy()”，我希望它会破坏对话框。我单击“是/否”并按下按钮，但在“_go”完成之前对话框不会消失。

在我的 MessageDialog 交互结束后，“time.sleep(4)”在那里模拟我的“_go”方法中发生的其他事情。

```
from gi.repository import Gtk, GObject
import time

class Gui(Gtk.Window):
    def __init__(self):
        Gtk.Window.__init__(self)
        self.connect("delete_event", Gtk.main_quit)
        self.set_size_request(700, 600)
        notebook = Gtk.Notebook()
        notebook.set_tab_pos(Gtk.PositionType.TOP)
        notebook.append_page(MyTab(), Gtk.Label("A tab"))
        self.add(notebook)
        notebook.show_all()
        self.show()

class MyTab(Gtk.VBox):
    def __init__(self):
        super(MyTab, self).__init__()
        self.go_button = Gtk.Button()
        self.go_button.add(Gtk.Image().new_from_stock(Gtk.STOCK_APPLY,
                                                 Gtk.IconSize.BUTTON))
        top_box = Gtk.HBox()
        top_box.pack_start(self.go_button, False, True, 5)
        self.pack_start(top_box, False, True, 5)

        # setup callbacks
        self.go_button.connect("clicked", self._go)

    def _go(self, _):
        dialog = Gtk.MessageDialog(Gtk.Window(), 
                                   Gtk.DialogFlags.MODAL,
                                   Gtk.MessageType.QUESTION,
                                   Gtk.ButtonsType.YES_NO,
                                   "RESPONSE REQUIRED")
        dialog.format_secondary_text("are you having fun?")
        response = dialog.run()
        dialog.destroy()
        print "your response is: " + str(response)
        time.sleep(4)
        print "left _go"

def main():
    """
    Main entry point.
    """
    Gui()
    Gtk.main()

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T08:02:29.600

此问题并非特定于对话框。在您返回主循环并让系统有机会处理通过修改小部件累积的事件之前，*任何GUI 更改都是不可见的。*

如果您真的想在回调中立即更新 GUI，您可以在调用后手动旋转累积的事件，如下所示`dialog.destroy()`：

```
while Gtk.events_pending():
    Gtk.main_iteration() 
```

但是，请注意，这不仅会更新屏幕，还会运行其他累积事件，包括空闲和超时处理程序以及按钮单击回调（如果有的话）。这可能会产生意想不到的后果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T11:40:45.640

这是正确的行为。只有当控制权交还给 Gtk 的主循环时，窗口才会消失，这只会在你的 _go 回调结束时发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T00:37:19.297

根据对 [user4815162342 的回答](https://stackoverflow.com/questions/14886023/gtk-messagedialog-not-closing-until-enclosing-method-finishes/14908283#14908283 "用户4815162342")的评论，我想出了一个使用嵌套主循环的解决方案。此类接受一个对话框并提供一个运行方法。

```
class NestedDialog(object):
    def __init__(self, dialog):
        self.dialog = dialog
        self.response_var = None

    def run(self):
        self._run()
        return self.response_var

    def _run(self):
        self.dialog.show()
        self.dialog.connect("response", self._response)
        Gtk.main()

    def _response(self, dialog, response):
        self.response_var = response
        self.dialog.destroy()
        Gtk.main_quit() 
```

然后该对话框按如下方式运行：

```
def _go(self, _):
    dialog = Gtk.MessageDialog(Gtk.Window(), 
               Gtk.DialogFlags.MODAL,
               Gtk.MessageType.QUESTION,
               Gtk.ButtonsType.YES_NO,
               "RESPONSE REQUIRED")
    dialog.format_secondary_text("are you having fun?")
    nested_dialog = NestedDialog(dialog)
    response = nested_dialog.run()
    print "your response is: " + str(response)
    time.sleep(4)
    print "left _go" 
```

# java - 在 Maven 测试中生成数据库模式（Hibernate）

> ID：14886025
> 
> 赞同：1
> 
> 时间：2013-02-14T23:36:26.797
> 
> 标签：java, hibernate, maven, hbm2ddl

我（一段时间没有接触 JPA）开始了一个使用 Hibernate 4.1、JPA2 和 Spring 的项目。这是一个具有共同生命周期的 Maven 项目。

运行 mvn test 后，我​​得到了未找到所需数据库对象的预期结果（连接按预期成功）。然而，我所有的研究和实验都证明不足以做出似乎很普遍的事情。

*   我希望能够在执行单元测试时让 Maven 删除/创建本地开发数据库的模式；我想 hibernate3-maven-plugin （理想情况下是 3.0 版）应该处理这个问题，但我没有设法让它工作。我不希望自动插入任何数据（为此我可以使用 DBUnit，甚至更好地让每个测试生成自己的测试数据，但这在这里不起作用）但我确实希望在测试数据库上刷新模式，反映了我带注释的模型类的当前状态。我想这将绑定到 process-test-resources 阶段。

*   我希望使用（当前）模式定义生成一个（或一组）sql文件，但我得到的最佳结果反映了这里描述的问题：[Maven + Spring + Hibernate：hibernate3-maven-plugin hbm2ddl failed for reason "Caused by ：java.lang.NullPointerException”](https://stackoverflow.com/questions/13113115/maven-spring-hibernate-hibernate3-maven-plugin-hbm2ddl-fails-for-reason-ca)（目前没有解决方案）。

我是否错过了一些愚蠢的事情，或者此时真的不可能？如果有人可以为我提供任何

*   关于如何实现这一点的适当文件

*   使用休眠 4 的工作示例

*   通过其他策略实现我的目标的任何实用方法指南。

如果它有任何相关性，数据库是 Postgres 9.1。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T08:48:04.820

一种方法是使用[Arquillian](http://arquillian.org/)。您可以为每个测试或一组测试创建一个单独的部署包，并使用它自己的`persistence.xml`数据源。使用 中的`hbm2dll`设置`persistence.xml`来创建-删除或更新架构：

```
<property name="hibernate.hbm2ddl.auto" value="create-drop" /> 
```

如果你想预填充数据库，你可以添加一个`import.sql`到你的部署中，它会在应用程序启动时由 hibernate 执行，或者使用[Arquillian Persistence 扩展](http://arquillian.org/modules/persistence-extension/)。

这是一个完整的 arquillian 测试设置作为示例：

```
@RunWith(Arquillian.class)
public class MyTest {

    @Deployment
    public static Archive<?> createTestArchive() {

        return ShrinkWrap.create(WebArchive.class, "myTest.war")
                .addPackages(true, "com.example")
                .addAsResource("testSeeds/seed.sql", "import.sql")
                .addAsResource("in-mem-persistence.xml", "META-INF/persistence.xml")
                .addAsWebInfResource("in-mem-datasource.xml");
    } 
```

一个缺点是容器内测试会比简单的单元测试慢。

我不确定 Arquillian 与 Spring 的配合如何，我只将它用于 Java EE 应用程序，所以请告诉它是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T21:27:01.797

再次回答我自己的问题。

为了达到我想要的结果，我必须在 maven 中将 hibernate3-maven-plugin 的 hbm2ddl 在 process-classes 阶段的执行与另一个 sql-maven-plugin 在 process-test-resources 阶段的执行联系起来。第一个为 Hibernate 的模型生成 sql，第二个将其应用于数据库。

事后看来，这似乎是一个体面和干净的解决方案。

我仍然有兴趣了解最佳实践（如果它们与我的解决方案不同），以实现设置数据库以使用 Hibernate 模型中的 maven 进行测试的目标。

# iphone - 使媒体查询兼容 iPhone 4 和 iPhone 5

> ID：14886028
> 
> 赞同：1
> 
> 时间：2013-02-14T23:36:47.497
> 
> 标签：iphone, media-queries

我在实现基于设备宽度调整元素大小所需的媒体查询方面取得了一些有限的成功 - 但是，我遇到了 iDevices 的障碍。

感谢这里的好人，我已经能够让我的媒体查询在 iPhone 5 的横向模式下顺利运行。不幸的是，这也切断了 iPhone 4 在横向模式下的媒体。我已经尝试了几种不同的修复程序来针对不同的媒体（甚至发现@media 的顺序很重要），但没有这样的运气。一个或另一个被覆盖。这是我最新的 iPhone 4 代码：

```
@media only screen and (min-device-width : 320px) and (max-device-width : 480px) and (orientation : landscape) { 
```

这是我用于 iPhone 5 的代码：

```
@media only screen and (min-device-width : 320px) and (max-device-width : 568px) and (orientation : landscape) { 
```

我确定我错过了一些简单的东西，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T11:38:38.110

你可能会调查这个。几个小时前，我在修复媒体查询时发现了它。基本上是为了iPones的超高分辨率。如果我理解正确的话，新手机基本上是用 2 像素代替一个。因此超清晰的分辨率。

这个元标记将其设置回较低的分辨率（如果我理解正确的话）希望它有所帮助

# php - 如何让 PHP 函数在返回后继续？

> ID：14886030
> 
> 赞同：5
> 
> 时间：2013-02-14T23:37:13.153
> 
> 标签：php, function, recursion

我有一个问题，我在页面加载时调用 PHP 函数 - 该函数检查文件是否存在，它返回文件名，如果不存在，它运行一个相当足智多谋且需要时间的脚本 - 转换波形图像从音频文件。问题是音频文件很大，因此创建文件可能需要一些时间，因此如果音频文件没有与之关联的图像文件，则页面加载所需的时间与该过程一样长。

我所追求的是这个函数返回一个占位符图像（如果不存在），但在页面加载后继续该过程 - 或在后台。所以理论上，当页面在以后重新加载时，正确的图像就会在那里。

我目前可以获得占位符图像的返回，但随后该过程停止并且图像不会生成。这是我到目前为止所拥有的：

```
function example($file_path, $file_name) {if ($file_path) {

if (file_exists("/path/to/folder/{$file_name}.png")) {
  return "/path/to/folder/{$file_name}.png";
}
if (!file_exists("/path/to/folder/{$audio_file_name}.png")) {

  return "/path/to/folder/processing.png";      

Some stuff in here

 return $new image

} return FALSE 
```

正如你所看到的，当文件不存在时，这只是停止，但我希望这里的东西在后台继续。有可能还是我需要不同的方法？像 cron 工作之类的？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:46:00.513

您可以尝试像 resque [https://github.com/chrisboulton/php-resque这样的排队系统](https://github.com/chrisboulton/php-resque)

然后，您可以生成一个作业，处理信息并使用“处理”图像快速返回。使用这种方法，您将不知道它何时完成。

以我的经验，这仍然比与操作人员争论使用多线程支持编译 php 更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:58:44.617

如果您在 FastCGI / FPM 上运行，您可以考虑执行以下操作：

1.  您放置了一个常规`<img>`标签，其`src`属性指向您的脚本。

2.  如果您的脚本需要重新生成，您可以让浏览器重定向到正在处理的图像。

3.  如果图像准备好，您将重定向到创建的图像（您也可以在页面上进行 AJAX 轮询）

**第2步怎么做？**

通常，浏览器在执行渲染或重定向之前必须等待您的脚本结束；但是 FastCGI (PHP-FPM) 对此有一个特殊的功能：[`fastcgi_finish_request`](http://php-fpm.org/wiki/Features#fastcgi_finish_request.28.29). 它在很大程度上没有记录，但它的使用很简单：

```
if ($need_to_process) {
    header('Location: /path/to/processing.png');
    fastcgi_finish_request();
    // do processing here
} else {
    header('Location: /path/to/final_image.png');
} 
```

**选择**

如果您有一个可以在执行之前立即渲染的模板，您也可以将它应用到您现有的流程中`fastcgi_finish_request()`。

**还有另一种选择**

使用像 Gearman 这样的任务调度程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:07:02.943

我会用 AJAX 来做。如果找到图像，只需将其放在那里。

否则，放置占位符，并添加带有数据的JS标志以加载波形图像。

在生成 HTML 文档的 PHP 代码中，不会发生转换。你有另一个请求处理程序来处理来自 JS 的请求，它使用提供的数据进行转换。

最初在 HTML 文档生成代码上创建的数据将被传递给 JS，JS 将使用它来发送转换请求。当 JS 等待响应时，您处理加载时间，当响应到来时，您将其放在占位符上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-16T08:35:57.720

我无法发表评论，因为我的声誉低于 50，但我想在 mohammadhasan 的回答中指出一些内容。它似乎有效，但在 try 和 finally 块中都避免了“return”语句

```
try {
    return "hello world";
} finally {
    //do not put return here
} 
```

例子：

```
function runner() {
    try {
        return "I am the trial runner";
    } finally {
        return "I am the default runner";
    }
}

echo runner(); 
```

只会显示`I am the default runner`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-28T11:34:13.053

你可以使用“try”和“finally”

```
try {
    return "hello world";
} finally {
    //do something
} 
```

# javascript - 使用 jquery 获取滚动位置

> ID：14886038
> 
> 赞同：66
> 
> 时间：2013-02-14T23:37:36.257
> 
> 标签：javascript, jquery

奇怪的请求，但我需要将当前浏览器滚动位置作为变量。我应该使用什么 js 或 jquery 函数？我需要它来确定要在侧面显示哪些元素。我在网上找到了一些东西，但没有适合我的 div 的东西，只有整页。

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2013-08-02T11:05:14.017

跨浏览器变体

```
$(document).scrollTop(); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-02-14T23:39:05.467

较旧的 IE 和 Firefox 浏览器将滚动条附加到`documentElement`, 或`<html>`HTML 中的标记。

所有其他浏览器都将滚动条附加到`document.body`，或者`<body>`HTML 中的标记。

正确的解决方案是检查使用哪一个，具体取决于浏览器

```
var doc = document.documentElement.clientHeight ? document.documentElement : document.body;
var s   = $(doc).scrollTop(); 
```

jQuery 确实让这变得更容易了，当传入任何一个时，`window`或者`document`jQuery`scrollTop`会进行类似的检查并计算出来，所以这些中的任何一个都应该跨浏览器工作

```
var s = $(document).scrollTop(); 
```

或者

```
var s = $(window).scrollTop(); 
```

[**jQuery scrollTop() 文档**](http://api.jquery.com/scrollTop/)

> 描述：获取匹配元素集合中第一个元素的滚动条当前垂直位置，或者为每个匹配元素设置滚动条的垂直位置。

* * *

> ...没有什么对我的 div 有用，只有整页

如果是用于 DIV，则必须以附加滚动条的元素为目标，以获取滚动量

```
$('div').scrollTop(); 
```

如果您需要获取元素与文档顶部的距离，您也可以这样做

```
$('div').offset().top 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-14T23:41:00.760

我相信使用 jQuery 的最佳方法是使用[`.scrollTop()`](http://api.jquery.com/scrollTop/)：

```
var pos = $('body').scrollTop(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T23:39:39.787

使用[scrollTop()](http://api.jquery.com/scrollTop/)获取或设置滚动位置。

# c++ - Win8如何将一个进程归类为“后台进程”？我的应用程序在 Win7 中运行，但在 Win8 中没有显示 UI

> ID：14886040
> 
> 赞同：1
> 
> 时间：2013-02-14T23:37:56.150
> 
> 标签：c++, windows-8

我相当普通的基于 MFC 的 Windows 应用程序在 Windows 7 上运行良好。但是当我在 Windows 8 中运行它时，没有出现 UI。起初我以为它没有正常启动，但最终意识到如果我打开任务管理器，它显示我的应用程序*正在*运行，但它列在“后台进程”部分下。

Windows 8 在进程上运行以确定它是“后台进程”的启发式方法是什么？或者我可以做些什么——也许在应用程序清单中——明确地将我的应用程序标记为*前台*进程？

我试过在Win7和XP兼容模式下运行，但无济于事。我尝试了几台Win8机器，都给出了相同的结果。

值得一提的是，这个应用程序是用 Visual Studio 2003 编译的，我没有选择使用更新的编译器。

我搜索了诸如“win8 后台进程”之类的东西，但我得到的只是*想要*创建后台进程的人。一些答案表明必须使用应用程序清单注册后台进程，但我仔细检查了我的清单，它绝对没有关于作为后台进程的任何内容。

这是我的清单，以防你能从中看到一些东西：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
<assemblyIdentity 
    version="1.0.0.0" 
    processorArchitecture="X86" 
    name="MyProductName"
    type="win32" 
/> 
    <description>My Product Description</description> 
    <dependency> 
        <dependentAssembly> 
            <assemblyIdentity 
                type="win32" 
                name="Microsoft.Windows.Common-Controls" 
                version="6.0.0.0" 
                processorArchitecture="X86" 
                publicKeyToken="6595b64144ccf1df" 
                language="*" 
            /> 
        </dependentAssembly> 
    </dependency> 
    <asmv3:trustInfo xmlns:asmv3="urn:schemas-microsoft-com:asm.v3">
        <asmv3:security>
            <asmv3:requestedPrivileges>
                <asmv3:requestedExecutionLevel level="asInvoker" uiAccess="false" />
            </asmv3:requestedPrivileges>
        </asmv3:security>
    </asmv3:trustInfo>
</assembly> 
```

如果我在此处找不到答案，我将与 Microsoft 一起发起支持事件以获得他们的帮助。如果达到这一点，我肯定会用我发现的内容更新这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T12:06:41.030

我正在开发 Windows 8 应用程序，但对 MFC 开发知之甚少。所以根据我的知识，MFC 开发更类似于 Silverlight 开发，但 Windows 8 开发与 MFC 开发平台更不同。

顺便说一下《**Win 8中后台进程的分类**》：

**处于挂起模式的应用程序进程，这意味着应用程序正在运行但由于桌面模式而没有显示任何 UI。** 为了澄清这一点，我再次通过 XAML 和 C# 在 win 8 中创建一个线程进行检查，并使该线程处于挂起模式，仅在那时该进程在任务管理器中显示为后台进程。

此外，**“仅适用于 Windows 8”**：

当应用程序提供的资源将减少或将分配这些资源但应用程序仍在加载并运行时，任何应用程序的进程都显示为后台进程......

Windows 8 的此功能称为“自动资源分配”...

抱歉，如果您在这里找不到答案，但我认为这可以帮助您了解**“在 Win 8 中哪个进程被归类为后台进程”**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:52:24.747

这纯粹是我的猜测，因为我找不到任何关于此的文档，但我怀疑 MFC 中的某些东西失败了，并且缺少工作 UI 是任务管理器将您的应用程序分类为后台进程的原因，因为用户无法与之交互。

# sql-server - 为什么不推荐混合模式认证？

> ID：14886042
> 
> 赞同：0
> 
> 时间：2013-02-14T23:38:33.057
> 
> 标签：sql-server

我有一门叫做信息系统规划和审计的课程，我遇到了一个这样的考试问题：

为什么不建议使用“SQL Server 和 Windows 身份验证模式”对 Microsoft SQL 数据库进行身份验证？

我搜索了我所拥有的文献并用谷歌搜索了它，但我无法找到这个问题的明确答案。有谁知道这个问题的目的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:25:15.920

当使用混合身份验证启动 SQL Server 实例时，“sa”登录会以完整的系统管理员权限启用，并会获得一个密码（希望是一个非常强大的密码）。“sa”帐户是一个常见的攻击点。

有权访问实例的“sa”帐户的黑客不仅拥有受感染实例和任何链接服务器上的所有数据，他还通过使用 xp_cmdshell 调用 PowerShell 脚本等来利用运行实例的服务帐户的权力事物。许多组织没有遵循服务帐户的最佳实践，他们将整个生产环境运行在一个或两个服务帐户下。这使得“sa”帐户成为黑客非常有吸引力的攻击点。

在 Windows 身份验证下，“sa”登录被禁用。这可能是您的考试问题正在寻找的内容。

迈克沃尔斯顿的观点也非常正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:57:53.340

当然，这只是我的意见，但不推荐这样做的原因是您最终会拥有两组不同的用户，必须始终对其进行维护和监控。在现实世界中，这通常会导致这两个组中的一个被忽略或没有得到适当的维护，通常是因为系统管理员维护 Windows Auth 用户，而 DBA 维护 SQL Server 用户。这种不一致可能会导致安全问题，或者导致用户最终同时使用 Windows Auth 用户名/密码和 SQL Server 用户名/密码的问题。停用用户时，有时只有两个帐户中的一个会被停用，这可能会导致安全问题。

# php - 我将如何处理占位符 div，然后用 PHP “覆盖”？

> ID：14886044
> 
> 赞同：0
> 
> 时间：2013-02-14T23:38:57.603
> 
> 标签：php, html, css

一些澄清：

我想在游戏中有 6 个用于罢工的占位符 div，可以这么说。

所以喜欢`[ ] [ ] [ ] [ ] [ ] [ ]`。

这将是带有黑色边框的白色方块。

在他们做出错误的猜测之后，我希望第一个 div 被一个包含猜测的红色框覆盖。基本上是上面的，但全是红色的，中间有一个数字。前任：`[9]`

我将如何使用 PHP/CSS/HTML 执行此操作？我完全习惯于回应陈述，所以我正在考虑回应每一个陈述。但是，如果我一开始就有 div，它只会跟随它们，而不是覆盖。

我在想一些与背景图像有关的东西，至少在概念上（不是实际图像），新的猜测只是超越了旧的猜测。那会是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:49:39.230

PHP 在 DOM 完成时完成所有数据。要实时更新 DOM，您可以使用 Ajax 或您自己的 JS 块、node.js 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T11:49:41.623

虽然您已经标记了 CSS 和 PHP，但最好还是使用 jQuery。

CSS 堆栈只会很快变得混乱和混乱，并且 PHP 会在加载时呈现，除非您使用 AJAX，否则很快就会变得混乱。

对于上面的示例，您可以使用：

```
function badguess() {
    $('#box2').css("color","red");
 } 
```

如果您想在框中添加文本，您还可以使用：

```
 function badguess(){
    $('#box2').css("color","red");            
    $('#box2').append('<p>WRONG</p>');
  } 
```

链接：

.Append() - [http://api.jquery.com/append/](http://api.jquery.com/append/)

.CSS() - [http://api.jquery.com/css/](http://api.jquery.com/css/)

# java - Riak-Java 无法从 Scala 中的 MapReduce 查询反序列化域对象？

> ID：14886046
> 
> 赞同：1
> 
> 时间：2013-02-14T23:39:00.717
> 
> 标签：java, scala, riak, domain-object

对简单存储桶执行 MapReduce 查询。出于某种原因，我从杰克逊那里得到了一个例外：

```
Caused by: org.codehaus.jackson.map.JsonMappingException: Can not deserialize instance of com.threetierlogic.AccountService.models.User out of START_ARRAY token
 at [Source: java.io.StringReader@39494ff0; line: 1, column: 2]
        at org.codehaus.jackson.map.JsonMappingException.from(JsonMappingException.java:163)
        at org.codehaus.jackson.map.deser.StdDeserializationContext.mappingException(StdDeserializationContext.java:219)
        at org.codehaus.jackson.map.deser.StdDeserializationContext.mappingException(StdDeserializationContext.java:212)
        ... 179 more 
```

这是我正在执行的 MapReduce 查询：

```
DB.client.mapReduce(bucketName)
    .addReducePhase(NamedErlangFunction.REDUCE_IDENTITY)
    .execute().getResult(classOf[User]) 
```

现在，如果我使用它调用 JSON，`getResultRaw()`它会返回一个 JSON 字符串，其中不包含任何值，只包含键：

```
[["accounts-user","8f0bb6e41592690d701225e263807a5e"],["accounts-user","2687cf9444013c45ba2637e9f6d3d3ad"],["accounts-user","3507e2e1f3d2818fdd276214d594c8e"],["accounts-user","fd186b0293ab7eb737f8b66e353fe4a6"],["accounts-user","bf6ce6bca0f642abfe74f2e2281e676c"],["accounts-user","b58d356551a8df6d3bbaf65e577f4b12"],["accounts-user","8126d599d259fd43f701c90787096049"],["accounts-user","33b9ae3befb23b7030b609158bb762d"],["accounts-user","770a897d5ce8c8e118ae121fc01f4c80"],["accounts-user","edae605390c35256b5df055f5574734d"],["accounts-user","ef19ad34a2be4ab8de111d1590a8768b"],["accounts-user","89a9f29ac937595038d37169f9ba7c8"],["accounts-user","85be26f43f7bb74eefa7683dcc74c555"]] 
```

那么我在这里俯瞰什么？我需要调用某种域转换器还是 MapReduce 查询本身的问题？

## 编辑

如果有帮助，这就是我`IRiakObjects`在 Riak 中的存储方式：

```
def store(o: User) = bucket.store(o).withConverter(new UserConverter(bucketName)).execute() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:21:46.787

评论中提到的第一个问题是`REDUCE_IDENTITY`返回的存储桶/密钥对列表不是您想要的。第二个问题是......如果您存储的不是 JSON，那么您不能直接从 mapreduce 转到您的 POJO。第三个（排序）问题是...... Riak mapreduce 真的不是为二进制值制作的。

下面使用说明如何在自定义转换器中使用 Kryo的[示例中](https://github.com/basho/riak-java-client/wiki/Using-a-custom-Converter)`KryoPersonConverter`的和`Person`类。

我将打破代码示例并内联我的评论：

```
public class App 
{
    public static void main( String[] args ) throws RiakException
    {
        List<Person> personList = new ArrayList<Person>();

        Person p = new Person("Bob","111 Elm Street","555-1212");
        personList.add(p);
        p = new Person("Jenny","122 Spruce Lane","867-5309");
        personList.add(p);
        p = new Person("Steve","333 Oak place","555-1111");
        personList.add(p);

        IRiakClient client = RiakFactory.pbcClient();
        Bucket b = client.fetchBucket("people").execute();
        KryoPersonConverter converter = new KryoPersonConverter("people");

        for (Person p2 : personList)
        {
            b.store(p2).withConverter(converter).execute();
        }

        p = new Person();
        p.setName("Jenny");
        p = b.fetch(p).withConverter(converter).execute();
        assert(p.getPhone().equals("867-5309")); // I got your number 
```

到现在为止的一切？一个OK！在使用 Kryo 序列化并检索它之后，我们在 Riak 中存储了一个 POJO。

```
 MapReduceResult result = client.mapReduce("people")
                                       .addMapPhase(NamedErlangFunction.MAP_OBJECT_VALUE)
                                       .execute();

        System.out.println(result.getResultRaw()); 
```

在这里我们看到了问题，因为它的输出`println()`是：

```
["\u0001\u0001\u000e111 Elm Street\u0001\u0003Bob\u0001\b555-1212","\u0001\u0001\r333 Oak place\u0001\u0005Steve\u0001\b555-1111","\u0001\u0001\u000f122 Spruce Lane\u0001\u0005Jenny\u0001\b867-5309"] 
```

不幸的是，在讨论存储数据时，Riak 中的 mapreduce 真的是要与 JSON 数据（或纯字符串）一起使用。我们有一个 JSON 数组，其中包含我们存储的字节的 JSON 字符串。

要使用它，您必须将`String`s 作为 a `Collection`，然后使用 Kryo 转换字节。

```
 Collection<String> objects = result.getResult(String.class);

        Kryo kryo = new Kryo();
        kryo.register(Person.class);
        ObjectBuffer buffer = new ObjectBuffer(kryo);

        for (String s : objects)
        {
            Person p3 = buffer.readObject(s.getBytes(), Person.class);
            System.out.println(p3.getName() + " " + p3.getPhone());
        }

        client.shutdown();     
    }
} 
```

你会得到输出：

> 鲍勃 555-1212
> 史蒂夫 555-1111
> 珍妮 867-5309

# postgresql - 检索当前（在运行查询时）序列值的选项

> ID：14886048
> 
> 赞同：58
> 
> 时间：2013-02-14T23:39:13.237
> 
> 标签：postgresql, postgresql-8.4

如何在 postgresql 8.4 中获取当前序列值？

注意：我需要某种统计数据的值，只需检索和存储。在手动递增的情况下，与并发和竞争条件无关，与问题无关。

注 2：该序列在多个表中共享

注意3：`currval`由于以下原因无法使用：

*   返回当前会话中此序列的 nextval 最近获得的值
*   `ERROR: currval of sequence "<sequence name>" is not yet defined in this session`

我目前的想法：是解析DDL，这很奇怪

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2013-02-15T00:11:25.363

您可以使用：

```
SELECT last_value FROM sequence_name; 
```

**更新**：这记录在[CREATE SEQUENCE](http://www.postgresql.org/docs/current/static/sql-createsequence.html)语句中：

> 虽然您不能直接更新序列，但您可以使用如下查询：
> 
> 选择 * FROM 名称；
> 
> 检查序列的参数和当前状态。特别是，序列的**last_value**字段显示了任何会话分配的最后一个值。（当然，如果其他会话正在积极进行 nextval 调用，则该值在打印时可能已过时。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:42:49.813

如果该序列用于表中的唯一 ID，您可以简单地执行以下操作：

```
select max(id) from mytable; 
```

最有效的方法，虽然 postgres 特定，是：

```
select currval('mysequence'); 
```

尽管从技术上讲，这会返回调用生成的最后一个值，调用者`nextval('mysequence')`不一定会*使用*该值（如果未使用，则会在自动增量 id 列中留下空白）。

# r - 将递归函数的输出保存为列表

> ID：14886050
> 
> 赞同：-3
> 
> 时间：2013-02-14T23:39:25.687
> 
> 标签：r, recursion

我想将递归函数的输出保存为列表。

```
> (getNames(74, foo))
[1] "Excavata"
[1] "Excavata"
[1] "Excavata"
[1] "Excavata"
[1] "Stramenopiles"
[1] "Stramenopiles"
[1] "Stramenopiles"
[1] "Excavata"
[1] "Excavata"
[1] "Metazoa" 
```

我该怎么做呢？也许这比我想象的要简单，但我已经被困了几天！

我不认为这里的代码很重要：我的问题的总体思路是将递归函数（例如 Hanoi 塔）的输出保存为数据类型，例如列表或 data.frame。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:46:32.247

如果您真的认为确切的代码无关紧要：

```
recursive_add <- function(x, res_list=NULL) {
  if (is.null(res_list)) {
    res_list <- list()
  }
  if (x == 26) {
    return(res_list)
  }
  res_list[[x]] <- letters[x]
  res_list <- recursive_add(x + 1, res_list)
  return(res_list)
}
recursive_add(1) 
```

默认`NULL`参数允许您第一次创建一个新列表，然后将现有列表传递给递归调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:09:40.367

如果没有代码可以查看，我不确定它是否有用，但是您是否考虑过使用 rapply？[rapply 帮助页面](http://stat.ethz.ch/R-manual/R-patched/library/base/html/rapply.html)它是 lapply 的递归版本，并且 lapply 返回列表作为输出。

# python - 选择要激活的文本过滤器

> ID：14886053
> 
> 赞同：0
> 
> 时间：2013-02-14T23:39:53.860
> 
> 标签：python, algorithm, filter

我们正在办公室开发一个小型自动分类系统。

我们有很多过滤器。它们被编写为 python 函数，它们要么匹配文件 - 要么不匹配。

对于每个文件，我们运行所有过滤器。它从上到下扫描文件，如果匹配过滤器 - 文件将被分类，日志文件将包含文件的路径和类别的名称。

每个文件必须只属于一个类别。

对于每个文件，我们运行所有过滤器并生成一个大的 excel 文件，其中包含每个文件，所有过滤器都适用于该文件。

文件名 | 过滤器的名称，例如，文件如下所示：

*   测试.docx | 财务报告
*   测试.docx | 普通文件
*   通过.txt | 密码文件

等等等等。如您所见，一个文件可以匹配多个过滤器。

我们需要基于这个文件工作（因为我们无法访问过滤器本身），并生成一个过滤器列表，以便每个过滤器不会匹配超过 100 个文件 - 即使这意味着某些文件不会分类。当然，我们希望每个过滤器只匹配少量文件。

行日志文件的顺序很重要。在示例日志文件中，如果“财务报告”和“普通文档”过滤器都打开，它将始终被归类为第一个匹配项 - “财务报告”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:51:33.890

您可以尝试保持对过滤器的命中计数，并为每个评估的文件，将其标记为具有最低命中计数的过滤器。这种策略倾向于将命中分布在过滤器周围。

您还可以进行多次传递，以便在第一次传递中计算出每个文件匹配的过滤器数量，然后根据过滤器命中数对它们进行排序。然后，您可以丢弃针对更常见过滤器的匹配项，并为那些过滤器匹配计数高的文件保留不常见的过滤器。

你还应该研究图论算法；您也许可以将此问题转换为类似的图论问题。

话虽如此，您可能想首先检查为什么要使用此策略进行自动分类，因为 100 次匹配似乎有点随意。最后，我怀疑您不会为这项任务找到确定性算法。我觉得它是 NP 完全的，或者至少是 NP 难的。

# c# - 是什么导致我的间歇性 System.Net.WebException 错误？

> ID：14886059
> 
> 赞同：1
> 
> 时间：2013-02-14T23:40:22.767
> 
> 标签：c#, dynamics-crm-2011

我有一个应用程序，它使用 Microsoft Dynamics CRM 的 API 来插入和更新记录。每当我连续处理少量记录时，在尝试进行其中一个更新时都会遇到以下错误：

```
2013-02-14 10:25:56,382 - Updating lead in dynamics with leadid [3cdaa9d4-c276-e211-99b6-005056ab0822]
2013-02-14 10:25:58,737 - GetProperty
System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send. ---> System.IO.IOException: Authentication failed because the remote party has closed the transport stream.
   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ForceAuthentication(Boolean receiveFirst, Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result)
   at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.PooledStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.ConnectStream.WriteHeaders(Boolean async)
   --- End of inner exception stack trace ---
   at System.Web.Services.Protocols.WebClientProtocol.GetWebResponse(WebRequest request)
   at System.Web.Services.Protocols.HttpWebClientProtocol.GetWebResponse(WebRequest request)
   at System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters)
   at Microsoft.Crm.SdkTypeProxy.Metadata.MetadataService.Execute(MetadataServiceRequest Request)
   at Integration.Crm.Services.Dynamics.LeadService.GetPickListvalue(String pickListlable, String logicalAttributeName) in C:\code\DynamicsIntegration\Services\LeadService.cs:line 1256 
```

谷歌搜索，我发现了可能发生此特定错误 ( ) 的几个原因`System.IO.IOException: Authentication failed because the remote party has closed the transport stream.`，但在所有情况下，由于配置错误或证书损坏，它**每次都会发生。**

世界上有什么可能会**间歇性地**触发这个错误？

它与网络请求的内容无关，因为我可以在 5 分钟后处理相同的请求并且它会起作用。对此服务器的所有请求大约 10% 的折扣会导致此错误。

**编辑：**这里有人在使用 SharePoint 时遇到[类似问题](http://james-brennan.co.uk/2011/10/18/the-underlying-connection-was-closed-an-unexpected-error-occurred-on-a-send/)，但每次都会发生错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:22:53.530

使用 CRM 诊断工具打开跟踪日志记录：[http](http://crmdiagtool2011.codeplex.com) ://crmdiagtool2011.codeplex.com查看您是否获得任何其他错误信息（假设您使用的是 On Premise）。我猜您从 CRM 服务器到 SQL 数据库的 SQL 连接有些不太对劲。

# php - 使用 AJAX 将表单输入发布到 PHP 以实现多个自动完成查询条件

> ID：14886060
> 
> 赞同：0
> 
> 时间：2013-02-14T23:40:23.233
> 
> 标签：php, jquery, ajax, autocomplete

我在输入表单“城市”上使用 jquery 自动完成功能，但我希望我的“autocity.php”文件中的查询仅建议预先选择的国家/地区的城市，即`WHERE City LIKE '%$term%'" AND CountryID = '%$country%'`。表单操作提交使用单独的 PHP 文件 (create-business.php) 将表单数据插入数据库，因此通常的 $_POST['Countries_CountryId'] 在 autocity.php 中不起作用。这就是为什么我现在使用 AJAX 将“国家”发布到 autocity.php。此外，如果有一种方法可以从 autocity.php 文件中回显/警报/print_r，那就太好了，这样我就可以确认 ajax 帖子中的 $_POST['$country'] 到达 autocity.php 文件。

我在表单中有两个输入框

```
<pre>`
<form id="input" action="php/create-business.php" method="post">
<select name="Countries_CountryId" id="country">
<input type="text" id="city" name="City">`
</pre> 
```

这是表单中的脚本

```
<script>
$(function () {
var country = $("#country").val();
$.ajax({
type:"POST", url:"autocomplete/autocity.php", data:"country",         
beforeSend:function () {
// alert(country);
}, complete:function () {  // is there any need for this?
}, success:function (html) {  // is there any need for this too?
}
});

$("#city").autocomplete(
             {
             source:'autocomplete/autocity.php'
             })
    });
</script> 
```

这是autocity.php

```
`
//数据库连接工作正常并自动完成
//建议在没有 AND CountryID = '%$country%' 部分的情况下有效。  

    $国家 = "";
    if (isset($_POST['country'])) {
    $country = trim($_POST['country']);}
    echo "window.alert($country);"; //这什么也没做没有警报

    $term = $_REQUEST['term'];
    $req = "选择城市
            来自城市
            WHERE City LIKE '%$term%' AND CountryID = '%$country%'";

    $query = mysql_query($req);
    而 ($row = mysql_fetch_array($query)) {
        $results[] = array('label' => $row['City']);
    }
    回声 json_encode($results);
    ?>`

```

所以问题基本上是：

1 - 我如何在 .php 文件中使用 AJAX 表单中的文本输入，该文件查询不是提交表单操作 .php 文件的 MySQL db

2 - 当使用 ajax 显示 php 文件收到我的 ajax 帖子时，我如何从 PHP 文件中提醒 post 变量。在我的简短经验中， echo 和 print_r 仅在网页更改显示我的表单提交到表单操作的结果时才对表单提交起作用。

3-我的语法怎么样？

非常感谢您提前帮助这个新手：D

* * *

好的，这是我尝试过的事情的更新。我想我很接近了。我正在使用 Jquery UI - //ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js

这是脚本方法1：

```
 $(document).ready(function () {
    var country = $('#country').value();
    alert(country + " complete");
    $("#city").autocomplete(
          {
            source:'autocomplete/autocity.php?country='+country,
            minLength:1
           });
        }); 
```

这是脚本方法2：

```
 $(document).ready(function () {

    $('#city').autocomplete({
        // source: function() { return "GetState.php?country=" + $('#Country').val();},
        source:function (request, response) {
            $.ajax({
                url:"autocomplete/autocity.php",
                //dataType:"json",
                data:{
                    term:request.term,
                    country:$('#country').val()
                },
                success:function (data) {
                    response(data);
                }
            });
        },
        minLength:2
    });
  }); 
```

我更喜欢方法 2，因为它允许我添加多个参数。

最后这是我最新的 autocity.php 代码

```
 <?php
    $term = $_REQUEST['term'];
    $country = $_REQUEST['country'];
    $req = "SELECT City
    FROM cities
    WHERE City LIKE '%$term%' AND CountryID = '%$country%' ";

    $query = mysql_query($req);

    while ($row = mysql_fetch_array($query)) {
    $results[] = array('label' => $row['City']);
    }

    echo json_encode($results);
     ?> 
```

我仍然完全被困住了。任何人都可以看到代码的问题吗？我在网上到处寻找正确的语法。再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:46:54.463

对于第一个问题，您的方法基本上是正确的。您可以绑定到特定字段的模糊事件，并使用您的函数来获取该字段的值并以您正在执行的方式提交给 php 脚本。$.blur() 是你要找的。

对于第二个问题，error_log 函数会将内容写入 php 的错误日志。如果您使用 print_r 将变量转储到此日志，请确保将 print_r 的第二个参数设置为 true 以将结果作为返回值输出。

# api - Zend Engine API 的过时版本

> ID：14886064
> 
> 赞同：0
> 
> 时间：2013-02-14T23:40:40.730
> 
> 标签：api, symfony, mamp

我在我的 Mac 上的 MAMP 服务器上使用 Symfony 框架托管一个网站，我试图在终端的帮助下自动生成捆绑包。

如果它以任何方式相关，这是我尝试在终端中输入的内容：

> php -c /Applications/MAMP/bin/php/php5.4.10/conf/php.ini php app/console generate:bundle

这是我得到的错误：

> XCache 需要 Zend Engine API 版本 220100525。安装的 Zend Engine API 版本 220090626 已过时。
> 
> 无法打开输入文件：php

你们中是否有人知道我可以如何更新 Zend Engine API 或以其他方式解决我的问题？那将有很大的帮助！

**编辑：**

感谢 whistlergreg 的帮助，我已经摆脱了看起来的问题之一，但我仍然得到以下回复：

```
Could not open input file: php 
```

**编辑：**

有人告诉我，我的命令中的第二个 php 不应该在那里。相反，我应该写：

> php -c /Applications/MAMP/bin/php/php5.4.10/conf/php.ini app/console generate:bundle

似乎第二个错误是由我的一个愚蠢的错字引起的，现在一切正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-20T15:47:05.777

**注意**：在 Xcache 3.0 中，xcache.so 不再是 Zend 扩展，而是 PHP 扩展

*   删除 zend_extension = */xcache.so
*   使用 extension = xcache.so 加载它

这可能是引发错误的原因：

> 该错误的主要原因是由于 XCache 的**过时构建**（尽管与其实际版本无关），这主要发生在用户升级 PHP 版本时。在编译和构建 XCache 时，它​​与当时系统上存在的 Zend Engine API 版本相关联。
> 
> 当 PHP 更新或升级时，Zend Engine API 也会更新，导致 XCache 模块因版本不再匹配而失败。
> 
> Zend Engine API 版本的**解决方案**是较新的错误非常简单。只需再次下载、编译和安装 XCache 即可永久修复和解决问题（直到新的 PHP 主要版本更新）。1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:04:51.810

从 MAMP 首选项菜单切换 MAMP 以使用 APC，这对我有用！确保在进行更改后重新启动 apache。

# sql - 2008 链接服务器上带句点的列名

> ID：14886070
> 
> 赞同：2
> 
> 时间：2013-02-14T23:41:16.840
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005, linked-server

我正在使用 SQL Server 2005 并尝试从 SQL Server 2008 链接服务器中选择包含句点的列。

我检查了这篇文章：

[选择列名称中带有句点的列 SQL Server](https://stackoverflow.com/questions/3284929/selecting-a-column-with-period-in-the-column-name-sql-server)

但我没有得到同样的错误。

这是代码

```
 INSERT INTO [Linked_Server].Database.dbo.Table
           ([Column_Name], [Column.Name])
    SELECT 
           [Column_Name], [Column.Name] FROM local_table 
```

我可以从本地表中选择，但是当我尝试从链接服务器上的同一个表中选择相同的列时，我收到此错误：

```
 Msg 207, Level 16, State 1, Line 3
    Invalid column name 'Column.Name'. 
```

编辑：修正了“[Column_Name)”的错字。然而，这只是在 stackoverflow 中的一个错字。 **错字不是问题**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:54:20.553

在 Column_Name 之后替换 ) on ] 并再次尝试

```
INSERT INTO [Linked_Server].Database.dbo.Table
       ([Column_Name], [Column.Name])
SELECT [Column_Name], [Column.Name] FROM local_table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:05:54.660

看起来这是 SQL Server 2008 中链接服务器的一个已知问题。我在研究时看到了这个页面，但我没有看到底部的解决方法部分。

我最终将查询更改为使用 OPENQUERY，现在它可以工作了。

[http://support.microsoft.com/kb/972856](http://support.microsoft.com/kb/972856)

# blackberry-simulator - BlackBerry 10 Cascades - 在模拟器上运行应用程序

> ID：14886073
> 
> 赞同：0
> 
> 时间：2013-02-14T23:41:26.600
> 
> 标签：blackberry-simulator, blackberry-10

我是黑莓开发的新手，多次遇到这个问题，找不到解决方案。

当我尝试仅使用简单的 HelloWorld 标签运行空的级联项目时，出现以下错误

```
Deployment Failed: Info: Sending request: Install and Launch
Info: Action: Install and Launch
Info: Debug native: on
Info: File size: 190910
Info: Installing com.example.HelloWorld.testDev__HelloWorld7d1bfe91...
Info: Processing 190910 bytes 
```

我正在使用 Momentics、运行 BB10 Dev Alpha Sim 的 VMware 并按照此处的所有说明进行操作。[http://developer.blackberry.com/cascades/documentation/getting_started/setting_up.html](http://developer.blackberry.com/cascades/documentation/getting_started/setting_up.html)

我确保我的构建配置设置为 Simulator-Debug，甚至示例项目都无法在模拟器上运行。

编辑：我不确定这些信息是否有帮助，但是当我尝试运行应用程序时，在错误对话框出现之前，进度会挂在 91%。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:36:49.140

可能是您没有设置开发模式（如当前的开发模式模拟器或设备）。我也遇到了项目编译但无法在虚拟机上运行的问题，今天我对问题进行了排序。查看链接[http://supportforums.blackberry.com/t5/Native-Development/BB10-Native-Cascades-SDK-not-connecting-to-Alpha-BB10-simulator/td-p/1719865/page/5](http://supportforums.blackberry.com/t5/Native-Development/BB10-Native-Cascades-SDK-not-connecting-to-Alpha-BB10-simulator/td-p/1719865/page/5)

# sql - 为什么这个 oracle 查询说“单行子查询返回多行”

> ID：14886074
> 
> 赞同：0
> 
> 时间：2013-02-14T23:41:37.943
> 
> 标签：sql, oracle, oracle11g

我正在用 oracle 编写 sql 查询。我的要求是我想用大小写有条件地更新数据库列。下面是我在三个表中使用的示例数据。

```
create table z_product(uuid int, variationvalue varchar(10));
create table z_listprice(productid int, price int);
create table z_variation(masterproductid int, productid int);

insert into z_product values(1,null);
insert into z_product values(2,null);
insert into z_product values(3,null);
insert into z_product values(4,null);
insert into z_product values(5,null);
insert into z_product values(6,null);

insert into z_listprice values(1,10);
insert into z_listprice values(3,20);
insert into z_listprice values(5,10);
insert into z_listprice values(6,19);

insert into z_variation values(2, 1);
insert into z_variation values(2, 3);
insert into z_variation values(4, 5);
insert into z_variation values(4, 6); 
```

如果“masterproductid”和“eqaul”的所有价格值都相等，如果价格与“notequal”消息不同，我想更新“variationvalue”列。

我试过的查询是

```
UPDATE z_product pr SET pr.variationvalue =
        CASE WHEN ( SELECT numberofrows FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid)) = '1'
                    AND 
                    ( SELECT pricecount FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid)) >1
        THEN 'equal'
        ELSE 'notequal' END
WHERE pr.uuid = (SELECT prv.masterproductid
                    FROM z_variation prv, z_listprice prl
                    WHERE prv.productid = prl.productid 
                    AND pr.uuid = prv.masterproductid GROUP BY prv.masterproductid) 
```

这个查询有什么问题。我在哪里做错了。任何建议将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:52:28.757

进行更多调查，看起来您要返回多个 PRODUCTMASTERID，从而返回 2 个结果——请参阅此小提琴：[http ://sqlfiddle.com/#!4/da309/8](http://sqlfiddle.com/#!4/da309/8)

结果如下所示：

```
NUMBEROFROWS PRICECOUNT PRODUCTMASTERID
2            1           4
2            1           2 
```

这些子查询应该只返回一行以与 CASE 语句一起使用。而且由于您只检查第一列，因此添加 DISTINCT 有效。但是，如果 NUMBEROFROWS 是不同的值，那么 DISTINCT 将无法单独工作。

```
UPDATE z_product pr SET pr.variationvalue =
        CASE WHEN ( SELECT DISTINCT numberofrows FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid)) = '1'
                    AND 
                    ( SELECT DISTINCT pricecount FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid)) >1
        THEN 'equal'
        ELSE 'notequal' END
WHERE pr.uuid = (SELECT prv.masterproductid
                    FROM z_variation prv, z_listprice prl
                    WHERE prv.productid = prl.productid 
                    AND pr.uuid = prv.masterproductid GROUP BY prv.masterproductid) 
```

**- 编辑 -**

如果我正确理解了您的要求 - 也就是说，对于任何给定的 masterproductid，如果 listprice 表中的任何价格不同，那么您希望将variationvalue 更新为 notequal，但如果价格相同，那么您想要将列更新为相等，然后试试这个：

```
MERGE
INTO    z_product
USING   (
        SELECT COUNT(DISTINCT l.price) cnt,
          v.masterproductid
        FROM z_variation v
          JOIN z_listprice l on v.productid = l.productid
        GROUP BY v.masterproductid
        )
ON      (uuid = masterproductid)
WHEN MATCHED THEN
UPDATE
SET     variationvalue = CASE WHEN cnt = 1 THEN 'Equal' ELSE 'Not Equal' END 
```

[http://sqlfiddle.com/#!4/098ad/1](http://sqlfiddle.com/#!4/098ad/1)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:05:25.800

回答：

```
UPDATE z_product pr SET pr.variationvalue =
        CASE WHEN ( SELECT numberofrows FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid) WHERE pr.uuid = productmasterid) = '1'
                    AND 
                    ( SELECT pricecount FROM (SELECT COUNT(*)  AS numberofrows, pricecount , productmasterid
                              FROM ( SELECT COUNT(prl.price) AS pricecount , prl.price AS price, prv.masterproductid AS productmasterid
                                        FROM  z_variation prv, z_listprice prl
                                        WHERE prv.masterproductid = (SELECT prv.masterproductid
                                                                        FROM z_variation prv
                                                                        WHERE prv.productid = prl.productid GROUP BY prv.masterproductid)
                                        AND prl.productid = prv.productid
                                        GROUP BY prl.price, prv.masterproductid)
                    GROUP BY pricecount , productmasterid) WHERE pr.uuid = productmasterid) >1
        THEN 'equal'
        ELSE 'notequal' END
WHERE pr.uuid = (SELECT prv.masterproductid
                    FROM z_variation prv, z_listprice prl
                    WHERE prv.productid = prl.productid 
                    AND pr.uuid = prv.masterproductid GROUP BY prv.masterproductid) 
```

# jquery - 模型和列表框

> ID：14886077
> 
> 赞同：2
> 
> 时间：2013-02-14T23:42:15.637
> 
> 标签：jquery, asp.net-mvc-4, model, html.listboxfor

好的，所以我正在尝试使用带有列表框的视图模型，这样当我将项目添加到列表框然后发布表单时，这些项目将通过视图模型传递到操作中。

视图模型：

```
public virtual ICollection<Sku> Skus { get; set; }  //This is this items sku's
public virtual ICollection<Sku> AllSkus { get; set; } //This is all sku's 
```

我的列表框如下所示：

```
@Html.ListBoxFor(m=>m.Skus, new MultiSelectList(Model.Skus, "Id", "Name"), new { id = "skuList", style="width: 200px; height: 100px" }) 
```

我有一个充满所有 skus 的表，当我选择一个时，它会使用 jquery 添加到列表框中。（我将在下面发布所有代码）

我的接收操作（skus 为空）：

```
 [HttpPost]
    public ActionResult AddProductOffering(ProductOfferingModel model)
    {

        return View(model);
    } 
```

项目添加到列表框就好了，但是发布后模型仍然为空。

显然我只是在更新列表框而不是模型，我不知道如何以这种方式将两者联系在一起。

任何帮助将不胜感激，谢谢！

（更新）完整的 .cshtml 文件：

```
@using Web.ControlPanel.Helpers
@model Web.ControlPanel.ViewModels.Offering.ProductOfferingModel

@using (Html.BeginForm())
{

<h2>Product Offering</h2>
<br />

@Html.LabelFor(m => m.Name)
@Html.EditorFor(m => m.Name)

<br />
<br />

<label>Offerings Skus</label><br/>

@Html.ListBoxFor(m=>m.Skus, new MultiSelectList(Model.Skus, "Id", "Name"), new { id = "skuList", style="width: 200px; height: 100px" })

<br/><br/>

<button class="button" type="submit" value="Save">Save</button>

<br/><br/><br/>

<h3>All Skus</h3>

<p>
    Search: @Html.TextBox("skuFilter")
    <input type="submit" value="Search Skus" name="search" />
</p>

<table class="onepx" style="width: 80%">
    <tr>
        <td colspan="4" style="text-align: right;">
            @Html.Pager("List", Model.SkuPager, 3, (string)ViewBag.SkuFilter)
        </td>
    </tr>
    <thead>
        <tr style="font-weight: bold;">
            <td>Product</td>
            <td>Sku</td>
            <td>List Price</td>
            <td>MSRP</td>
            <td>Action</td>
        </tr>
    </thead>
    <tbody>

        @if (Model.Skus != null)
        {
            foreach (var sku in Model.AllSkus)
            {

                <tr>
                    <td>
                        @Html.DisplayFor(m => sku.Product.Name)
                    </td>
                    <td>
                        <label id="skuName@(sku.Id)">@sku.Name</label>
                    </td>
                    <td>$@Html.DisplayFor(m => sku.ListPrice)
                    </td>
                    <td>$@Html.DisplayFor(m => sku.Msrp)
                    </td>
                    <td>
                        <a href="#" class="AddSku" id="addSku@(sku.Id)">Add To Offering</a>
                    </td>
                </tr>

            }
        }
    </tbody>
    <tfoot>
    <tr>
        <td colspan="4" style="text-align: right;">
            @Html.Pager("List", Model.SkuPager, 3, (string)ViewBag.SkuFilter)
        </td>
    </tr>
</tfoot>
</table>
}

@section Scripts {
<script>
    $(document).ready(function() {

        //Array of skus
        var skus = new Array();

        $('.AddSku').click(function(e) {
            e.preventDefault();
            var id = e.target.id.replace("addSku", "");

            var exists = false;

            for (var i = 0; i < skus.length; i++) {
                if (skus[i] == id) {
                    exists = true;
                }
            }

            if (!exists) {
                var name = $("#skuName" + id).text();
                $('#skuList').append('<option value=' + id + '>' + name + '</option>');
                skus.push(id);
            }

        });

    });
</script>

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T02:21:28.630

MVC 在技术上不能绑定到类型（或对象）的接口 - `ICollection`- 将你的更改`ICollection<T>`为`List<T>`. 然后，您需要查看 List 在您的 ListBox（选择）中是如何呈现的。它应该以数组表示法呈现，即类似`Sku[0] ... Sku[n]`. 您的 jQuery 需要以相同的数组表示法附加到选择。阅读 Phil Haack 的[模型绑定到列表文章](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)了解更多信息。

# javascript - javascript将参数值传递给同名的外部范围变量

> ID：14886081
> 
> 赞同：1
> 
> 时间：2013-02-14T23:42:46.027
> 
> 标签：javascript, scope

```
var a,b,c;

function abc(a,b,c){
   console.log("a is"+ a + ", b is"+ b + ", c is"+ c);
}

a; // undefined
b; // undefined
c; // undefined 
```

我将通过字符串`a`, `b`, `c`，但希望在它们通过函数后也能够访问它们。

因此，如果我调用`abc("d","e","f")`，我希望该函数使用这三个字符串运行，但之后，在它自己的范围之外，我还希望能够使用`a="d"`、`b="e"`和`f="f"`.

有人可以解释这是如何完成的吗？我认为即使它们是在函数之外声明的，但它的同名这一事实让我失望。

我记得在 PHP 中关于`&`在参数之前添加的一些内容......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:47:05.050

我不确定你在这里问什么，但它就像你想要的那样开箱即用。

由于 ECMAscript 具有*函数作用域*，因此变量`a`，`b`并将`c`在`abc()`. *这些变量名称*的*外部*声明 （我们称它们为*自由变量*）永远不会被访问，因为*查找过程将首先在它**自己的*上下文中找到这些名称，解析它们并停在那里。

 ***如果您只想设置那些属于*父上下文的**自由变量*，您可能应该为方便起见重命名*形式参数*，然后传递值

 **```
function abc(some, other, name) {
    a = some;
    b = other;
    c = name;
} 
```

希望声明的*父*`a`范围不是*全局*`b`范围。出于几个原因，这仍然被认为是不好的做法和业力，这是非常正确的。`c`

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:48:48.923

最佳做法是为内部变量赋予不同的名称，例如在它们前面加上“inner”或函数名称的首字母。然后，您不仅可以使用 simple 将值简单地分配给外部变量`a = innerA`，而且还可以使您的代码更具可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:46:50.857

如果它们被同名的函数参数屏蔽，则不能使用外部范围内的变量。

如果它们被命名为外部范围内的变量的*属性，则可以。*在浏览器中，全局变量实际上只是变量的属性`window`：

```
var myobj = {};

function abc(a, b, c) {
    myobj.a = a;
    myobj.b = b;
    myobj.c = c;
}

// you can now use those values 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T23:49:33.050

首先，我认为你的意思是：

```
var a, b, c;

function abc(_a, _b, _c) {
    a = _a;
    b = _b;
    c = _c;
}

abc(1, 2, 3);
console.log("a is"+ a + ", b is"+ b + ", c is"+ c); // 1, 2, 3 
```

鉴于此，我认为这种方法不是一个好的做法。请在闭包或命名空间中组织它们。例如，这是一个可接受的设计模式：

```
(function(g) {

    var _SomeClass = function(a, b, c) {
        this.a = a;
        this.b = b;
        this.c = c;
    }

    _SomeClass.prototype = {
        printValues: function() {
            console.log(this.a, this.b, this.c);
        },
        doSomething: function() {
            // do something here
        },
        _privateMethod: function() {
            // should not be called from outside the closure
        }
    }

    g.SomeClass = _SomeClass;

})(window);

var myClass = new SomeClass(1, 2, 3);
myClass.printValues(); 
```******

# objective-c - 自unix时间戳以来是否有一种流行的显示时间的方法？

> ID：14886091
> 
> 赞同：0
> 
> 时间：2013-02-14T23:43:29.487
> 
> 标签：objective-c, cocoa-touch, timestamp

我已经用 PHP 完成了数百次，但现在我正在学习 xcode，但我无法弄清楚。我正在尝试在这样的 tableView 单元格上显示 Unix 时间戳->“10 分钟 24 秒前”、“4 小时、2 分钟前”或“2 天 4 小时前”。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-09T00:56:06.920

我遇到了同样的事情，这是我为 unix 时间戳想出的：

```
-(NSString *)timeSinceNow:(float)timestamp{
NSMutableString *time = [[NSMutableString alloc]init];
NSTimeInterval ti = [[NSDate date] timeIntervalSince1970];
float diff = ti - timestamp;
//days
if (diff<60*60*24*365) {
    [time appendString:[NSString stringWithFormat:@"%d day", (int)floor(diff/(60*60*24))]];
}
//hours
if (diff<60*60*24) {
    [time appendString:[NSString stringWithFormat:@"%d hour", (int)floor(diff/(60*60))]];
}
//minutes
if (diff<60*60) {
    [time appendString:[NSString stringWithFormat:@"%d minute", (int)floor(diff/(60))]];
}
//seconds
if (diff<60) {
    [time appendString:[NSString stringWithFormat:@"%d second", (int)floor(diff)]];
}
//years
if (diff>=60*60*24*365) {
    [time appendString:[NSString stringWithFormat:@"%d year", (int)floor(diff/(60*60*24*365))]];
}
//check if its not singular (plural) - add 's' if so
if (![[time substringToIndex:2] isEqualToString:@"1 "]) {
    [time appendString:@"s"];
}
return time;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:01:29.797

[https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDateFormatter/setDoesRelativeDateFormatting](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDateFormatter/setDoesRelativeDateFormatting)：

这个有一个简单的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:46:24.907

试试这个第三方库：[https ://github.com/billgarrison/SORelativeDateTransformer](https://github.com/billgarrison/SORelativeDateTransformer)

您可以通过 CocoaPods 或使用 README 中的说明安装它。

如果您想推出自己的解决方案，您可以使用 获取自当前时间以来的秒数`+[NSDate dateWithTimeIntervalSinceReferenceDate:]`，传入当前时间的参考日期，`+[NSDate date]`. 通过使用适当的单位划分结果，您应该能够获得所需的粒度级别。

[SORelativeDateTransformer](https://github.com/billgarrison/SORelativeDateTransformer)通过巧妙地使用`-[NSBundle localizedStringForKey:value:table:]`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T23:50:27.997

NSDate *now = [NSDate 日期]；

应该确实建立差异，然后将其绑定到单元格

# excel-2010 - 将 Excel 电子表格从一种格式转换为另一种格式

> ID：14886096
> 
> 赞同：0
> 
> 时间：2013-02-14T23:44:38.923
> 
> 标签：excel-2010

我有一个数据列表，它来自可导出到 excel 的数据库。但是数据出来看起来像这样..

```
Room Name   Model_Number   Type
  Name_A      3243234      Projector
  Name_B      3233566      Projector
  Name_C      1232322      Projector
  Name_C      9299393      Camera
  Name_A      9383888      Camera
  Name_B      773984       Camera
  Name_A      875649       Projector
  Name_B      38292A3      Camera 
```

我需要的是看起来像这样的数据

```
 Room Name  Projector1 Projector2  Camera1   Camera2 
 Name_A     3243234    875649      9383888
 Name_B     3233566                773984    38292A3
 Name_C     1232322                9299393 
```

有谁知道如何做到这一点.. 我想我将不得不编写一些 VB 代码来获取每个类型列，删除重复项，然后将行转换为列到第二个电子表格中，然后遍历名称找到值如果存在，则从第一个电子表格匹配，然后填充第二个。只是好奇我是否在写轨道上。（除了基本的东西，我没有在VB或Excel中做过任何编码，但总是愿意学习）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T12:25:45.343

您可以非常轻松地使用数据透视表来执行此操作 - 创建一个新的数据透视表，选择 Room_Name 作为行标签，选择类型作为列标签，并选择 Model_Number 作为值。

# android - 相同的 xml 但不同的对话框导致 Gingerbrad 和 ICS

> ID：14886102
> 
> 赞同：1
> 
> 时间：2013-02-14T23:45:05.913
> 
> 标签：android, android-layout, android-dialog

这是我的问题：我有一个 xml 文件，它描述了我的应用程序中自定义对话框的布局。在带有 Gingerbread 2.3.3 和 ICS 4.0.3 的两个 AVD 上运行它，对话框在 GB 上似乎“正常”，在 ICS 上似乎“太小”。！！我不明白为什么会这样。 [链接到图片](http://img688.imageshack.us/img688/2296/immagineoun.png) 我的 xml 代码是：`

```
 <TextView
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:gravity="center"
    android:text="Aggiungi una nuova Spesa!"
    android:paddingBottom="5dip"
    android:textStyle="bold"
 />
 <ImageView
    android:src="@android:drawable/divider_horizontal_dim_dark"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
    android:paddingBottom="10dip"/>

 <EditText
     android:id="@+id/edittOggetto" 
     android:layout_width="fill_parent" 
 android:layout_height="wrap_content"
     android:hint="Inserisci l'oggetto..."
     android:paddingTop="5dip"/>         

 <EditText 
     android:id="@+id/edittPrezzo" 
     android:layout_width="fill_parent" 
 android:layout_height="wrap_content"
     android:inputType="numberDecimal"
     android:hint="Inserisci il prezzo..."/> 

 <LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content">
    <LinearLayout
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"> 
        <TextView
           android:id="@+id/textvSelezionaCategoria"
           android:layout_width="wrap_content" 
           android:layout_height="wrap_content"
           android:textSize="16dip"
           android:paddingLeft="5dip"
           android:paddingBottom="4.0dip"
           android:textStyle="bold"
           android:text="Categoria"/>
        <Spinner 
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"                
           android:id="@+id/spinner_categoria"/>
    </LinearLayout>

    <LinearLayout
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
        <TextView
           android:id="@+id/textvFontePagamento"
           android:layout_width="wrap_content" 
           android:layout_height="wrap_content"
           android:textSize="16dip"
           android:paddingLeft="5dip"
           android:paddingBottom="4.0dip"
           android:textStyle="bold"
           android:text="Pagamento "/>
        <Spinner 
           android:layout_width="fill_parent"
           android:layout_height="wrap_content"                
           android:id="@+id/spinner_aggsp"/> 
    </LinearLayout>
 </LinearLayout>
 <TextView 
    android:id="@+id/textvDataOraAggiungiSpesa"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:textSize="20dip"
    android:paddingLeft="5dip"
    android:paddingBottom="4dip"
    android:textStyle="bold"
    android:text="Data: "/>    
 <LinearLayout
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:paddingLeft="5dip"
    android:paddingBottom="10dip">
     <Button
        android:id="@+id/calendarioSmall"
        android:layout_width="20dip" 
        android:layout_height="20dip"
        android:background="@drawable/calendario_small"
        android:clickable="false"/>
     <TextView 
        android:id="@+id/textvCambiaData"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:textSize="15dip"       
        android:textStyle="bold"
        android:text="Modifica\n Data"
        android:layout_marginLeft="2dip"/>       
     <Button
        android:id="@+id/timeSmall"
        android:layout_width="20dip" 
        android:layout_height="20dip"
        android:background="@drawable/time_small"
        android:clickable="false"
        android:layout_marginLeft="10dip"/>
     <TextView 
        android:id="@+id/textvCambiaOra"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:textSize="15dip"        
        android:textStyle="bold"
        android:layout_marginLeft="2dip"
        android:text="Modifica\n Ora"/>   
 </LinearLayout> 
 <LinearLayout 
        android:orientation="vertical"
        android:background="@android:drawable/bottom_bar" 
        android:padding="5dip"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:weightSum="1">      
        <Button 
               android:id="@+id/btnAggiungiOggetto"
               android:layout_width="fill_parent"
               android:layout_height="wrap_content"
               android:text="Aggiungi"
               android:layout_weight="0.5"/>
        <Button 
              android:id="@+id/btnAnnullaOggetto"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"
              android:text="Annulla"
              android:layout_weight="0.5"/>
 </LinearLayout> 
```

`

在我的活动中，我以这种方式调用对话框：

```
final Dialog dialog = new Dialog(this);        
 dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
 dialog.setContentView(R.layout.dialogaggiungispesa); 
 ...
 dialog.show(); 
```

我该如何解决这个问题？我想在每个版本的 android 上都有相同的对话框布局。感谢您的任何回答！

# mercurial - Temporarily disable a hook?

> ID：14886103
> 
> 赞同：4
> 
> 时间：2013-02-14T23:45:08.167
> 
> 标签：mercurial, mercurial-hook

Is it possible to temporarily disable a hook when running a mercurial command? e.g., something like:

```
hg push --no-hook 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-01-22T19:09:41.980

According to [this](http://www.selenic.com/pipermail/mercurial-devel/2011-December/036480.html) ~~bug~~feature, the following skips local hooks:

```
hg --config alias._pull=pull _pull 
```

Obviously this is a hack, but it has worked since 2011, and is the only way to skip local hooks given the lack of a '--no-hooks' option.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T12:45:45.523

You can't disable a remote repository's hook. But you could enable or disable a local hook via `--config` option:

```
$ hg commit -m test --config 'hooks.commit.info=set | grep "^HG_"' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:53:49.533

If this is an `outgoing` or `preoutgoing` hook that is locally configured, you can disable it by commenting out its entry under `[hooks]` in `.hg/hgrc`. If this is a hook configured on the repository that you are pushing to (`changegroup`, `incoming`, `prechangegroup`, `pretxnchangegroup`), you will have to comment out its entry under `[hooks]` in the target repository's `.hg/hgrc` (if you have access to it).

# c++ - 为什么 VC++ 2012 不支持在其定义中指定类成员的默认值？

> ID：14886104
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:45:16.210
> 
> 标签：c++, class, struct, initialization, default

```
struct A
{
    int a = 8; // VC++ 2012 rejects this.
}; 
```

我认为上面的代码比下面的合法代码更方便，更有表现力：

```
struct A
{
    A();

    int a;
};

A::A()
    : a(8)
{} 
```

我相信在 C++ 语言中添加新特性的最强烈动机之一是让 C++ 更具表现力。

我只是想知道为什么 VC++ 2012 不支持这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:45:53.030

**编辑**这个回答了原来的问题，“为什么 C++ 不支持......”

实际上，从 C++11 开始，支持在声明点初始化非静态数据成员：

```
struct A
{
    int a = 8; // perfectly legal C++
};

#include <iostream>
int main()
{
  A a1;
  std::cout << a1.a << "\n";
} 
```

输出：8。

这将数据成员初始化`A::a`为 8，并暗示`A`不再是聚合，但它也不会与用户提供的构造函数为一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:56:27.890

C++11 支持`Default Member Initialization`.

**§ 12.6.2**

> 9 如果给定的非静态数据成员同时具有大括号或等式初始化器和内存初始化器，则执行内存初始化器指定的初始化，并且非静态数据成员的大括号或等式初始化器被忽略。[示例：给定

```
struct A {
  int i = /* some integer expression with side effects */ ;
  A(int arg) : i(arg) { }
  // ...
}; 
```

> A(int) 构造函数将简单地将 i 初始化为 arg 的值，并且 i 的大括号或相等初始化器中的副作用不会发生。—结束示例]

您可以通过以下方式初始化成员：

```
struct A
{
    int a = 8; 
    int b{3}; // OR
}; 
```

如果将构造函数定义为 initialize `a,b`，则构造函数初始化列表会覆盖默认值。

`I just wonder why VC++ 2012 not support this?`

VS2012 还没有实现。

# c#-4.0 - Parallel For 对 ushorts 数组求和（大数组 18M）

> ID：14886105
> 
> 赞同：2
> 
> 时间：2013-02-14T23:45:18.767
> 
> 标签：c#-4.0, parallel-processing

我想使用并行处理来获取大型无符号短（16 位）值数组的数组统计信息。

ushort[] 数组 = 新 ushort[2560 * 3072]; // x = 行(2560) y = 列(3072)

double avg = Parallel.For（0，array.Length，这里发生了什么）；

行均值的标准差和标准差相同。

我有这些函数的正常 for 循环版本，当与中值滤波器方法结合使用时，它们花费的时间太长。

最终产品是尝试为阵列获取中值滤波器。但第一步也很重要。因此，如果您拥有很棒的整个解决方案，但如果您也想在第一部分提供帮助，那么我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T21:46:12.567

你试过 PLINQ 吗？

```
double average = array.AsParallel().Average(n => n); 
```

我不确定它对大量`ushort`值的性能如何，但值得测试它是否满足您的需求。

# java - Java 布尔 if 语句搞砸了

> ID：14886109
> 
> 赞同：0
> 
> 时间：2013-02-14T23:45:59.007
> 
> 标签：java, if-statement, calendar, hashmap, boolean

我有这个 if 语句，当我使用 JOptionPane.showMessageDialog（如代码顶部所示）检查时返回 false，但该块仍被执行。我看不出我应该做些什么不同的事情。

变量：

*   c = 公历
*   s = 字符串
*   h = HashMap-array - 字符串、日期
*   oldGoods1、2 和 3 = HashMaps - 字符串、日期

代码：

```
JOptionPane.showMessageDialog(null, c.after((Date) h[counter].get(s)));
if(c.after((Date) h[counter].get(s))); //this line
{
  Calendar today = Calendar.getInstance();
  if(today.after((Date) h[counter].get(s)))
  {
    GoodsList.removeDate(s, (Date) h[counter].get(s));
  }
  if(!oldGoods1.containsKey(s)) 
  {
    oldGoods1.put(s, (Date) h[counter].get(s));
  }
  else if(!oldGoods2.containsKey(s))
  {
    oldGoods2.put(s, (Date) h[counter].get(s));
  }
  else if(!oldGoods3.containsKey(s))
  {
    oldGoods3.put(s, (Date) h[counter].get(s));
  }
} 
```

预先感谢 Highace2

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T23:47:49.213

```
if(c.after((Date) h[counter].get(s)));  // The `;` is the culprit. Remove it. 
```

的末尾有一个分号`if statement`，它仅终止`if statement`那里，并且后面的块只是一个本地块，无论条件评估为什么，总是会执行。

# javascript - 在 CSS 动态加载和渲染后运行 javascript

> ID：14886111
> 
> 赞同：5
> 
> 时间：2013-02-14T23:46:01.360
> 
> 标签：javascript, jquery

我想动态加载css文件，并在文档上*呈现css后运行js脚本。*我想使用由加载的css设置的元素的新宽度和高度。所以在渲染后运行js很重要。是否可以？我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:52:41.017

听起来像是[SidJS](http://www.diveintojavascript.com/projects/sidjs-load-javascript-and-stylesheets-on-demand)的工作：

> SidJS 是一个轻量级的 JavaScript 库，它允许按需包含 JavaScript 脚本和 CSS 样式表。它支持与加载过程相关的回调，以保证您正在加载的资源在您需要时可用。

换句话说，您请求一个样式表并提供一个回调函数。加载样式表时执行回调函数。例子：

```
Sid.css("my-sheet.css", function() {
    // Perform your width/height logic here.
}); 
```

我不完全确定在执行回调时文档是否有时间重绘，但您应该尝试一下。在最坏的情况下，您只需使用`setTimeout`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:33:08.423

我了解您的需求，但我强烈建议您仅在所有替代方案都失败后才这样做。

你有多少个 CSS 文件？他们有什么不同？

在 JS 中设置样式甚至比使用它来加载 CSS 文件更好。

此外，如果您需要让 JS 知道从 CSS 文件加载的样式，那么 JS 需要知道这些文件在哪里，对吧？提供这些信息而不是文件 URL 不是更容易吗？

如果不知道为什么您只会在页面加载后才知道要加载哪个文件，就很难考虑替代方案。如果它基于一些用户输入，您可以只为一组类创建一个具有不同样式的 CSS 文件，并使用 JS 更改元素类，从而删除一个类样式并为其应用新的类样式。

始终尝试将所有样式保存在一个独特的文件中，尝试保持其组织和紧凑，并始终可以重复使用。然后根据需要使用 JS 更改样式、类和元素。

# php - PHP Require 没有按我预期的那样工作

> ID：14886112
> 
> 赞同：0
> 
> 时间：2013-02-14T23:46:04.367
> 
> 标签：php

请查看下面的代码，并在使用 require 时告知它有什么问题。

首先是有效的代码（不使用 require ）：

```
<?php
//require("_start.inc");
session_start();

if(!isset($_SESSION['user']))
{
    echo "<h1 style='color:red'>Please <a href='../index.php'>login</a> first!</h1>";
}
else
{
?>

<!DOCTYPE html>
<html>
<head>
<title>Main window</title>
</head>

<body>
<h1>Admin panel</h1>
<?php
require("header.inc");
?>
</body>

</html> 
<?php
//require("_end.inc");
}
?> 
```

这是不起作用的版本，_start.inc 和 _end.inc 正是上面代码中写的内容，但下面的代码给了我一个错误： Parse error: syntax error, unexpected end of file in C: \xampp\htdocs\admin_start.inc 在第 9 行

```
<?php
require("_start.inc");
/*session_start();

if(!isset($_SESSION['user']))
{
    echo "<h1 style='color:red'>Please <a href='../index.php'>login</a> first!</h1>";
}
else
{
*/
?>

<!DOCTYPE html>
<html>
<head>
<title>Main window</title>
</head>

<body>
<h1>Admin panel</h1>
<?php
require("header.inc");
?>
</body>

</html> 
<?php
require("_end.inc");
//}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:03:23.630

一个文件中不能有左大括号，另一个文件中不能有相应的右大括号。包括不像复制和粘贴那样工作。文件必须始终有效。

顺便说一句：使用 IDE。它会告诉你这些错误。

# javascript - 编译成 JavaScript 而不是 CSS 的 CSS 预处理器语言可行吗？

> ID：14886113
> 
> 赞同：3
> 
> 时间：2013-02-14T23:46:07.910
> 
> 标签：javascript, css

我总是使用 CSS 预处理器来处理与 Web 相关的项目。CSS 预处理器几乎可以让你做 CSS 让你做的所有事情，但支持 DRY 编码原则和更清晰的语法。不过我想知道 - 为什么不完全放弃样式表？为什么不制作一种可以编译为 JavaScript 的样式语言呢？JavaScript 显然无论如何都可以完全控制 CSS 样式，所以它应该是可能的。这种语言也将比 vanilla CSS 强大得多，因为它可以启用逻辑，例如基于元素大小和位置的选择器、浏览器窗口大小等。一个人为的可能性示例：

```
div#test {
    if windowWidth > 800px {
        width: (windowWidth / 3 + 10)px;
        height: 200px;
    }
    else {
        width: 100px;
        height: 50px;
    }
} 
```

或者一个绝对定位的 div，但是当它向下滚动太远时应该跟随窗口：

```
div#side_panel {
    position: absolute;
    top: 100px;
    right: 25px;

    if windowScrollY > 90px {
        position: fixed;
        top: 10px;
    }
} 
```

我已经尽我所能在谷歌上搜索了这个主题，但没有任何成功。**是否有任何样式语言允许动态样式（例如我的示例中的样式）并编译为 JavaScript？**如果不是，为什么不呢？这在性能方面不可行吗？或者可能存在浏览器支持问题？

* * *

我知道一些浏览器，包括 Chrome，公开了一个名为的对象`document.styleSheets`，它使 JavaScript 可以完全控制文档的样式，这对于这类项目来说是完美的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:31:27.720

几年前我也想过。

在我的结论中，第一点是 CSS 是为*网页设计师*而不是为网页开发者设计的。设计师在一次又一次地制作相同的艺术作品方面非常有创意，但在编程逻辑和编程语言方面也非常愚蠢。那些简单的 if-else 就足以让他们发疯。

另一个，是性能。CSS 旨在为整个页面布局设置样式。即使使用 AJAX，JavaScript 也只能做很少的更改并处理较小的用户交互。简单也近在咫尺，想象一下如果我们只使用 JavaScript 从 HTML 文档构建整个布局。

还有稳定性问题。CSS 的解析和处理是由浏览器的引擎来处理的，这个引擎经过了很好的测试，比我们自己的 JS 代码要好得多。如果我们使用 Unobstructive JavaScript，当应用 CSS 并加载图像时，我们的网站将完全正常工作，因此如果 JS 出现错误，它仍然可以工作。想象一下，如果布局页面的 JavaScript 代码崩溃了。为此，我们只需要一个无限循环，它肯定是可用的。

最后，我们必须将 content-HTML、look-CSS 和 feel/behavior-JavaScript 分开。因此，只需提供 HTML 文档中的所有内容，即使它会保持隐藏状态。使用 CSS 以有效的方式为所有内容设置样式，并尽可能提供最佳的静态页面。然后使用 JS 只是对布局进行更改，并在需要更改时使用 if-else。

# php - PHP可以在没有正则表达式的情况下处理每个标签具有双命名空间的“XML”吗？

> ID：14886115
> 
> 赞同：0
> 
> 时间：2013-02-14T23:46:12.940
> 
> 标签：php, xml

我有一个充满类似 XML 标记的文件，包括`<is:namespace:tag ...>`以类似 HTML/XML 的方式排列。这些用于通过 smarty 库的创造性使用来生成和呈现 HTML。我们的模板文件不再有任何聪明之处，我想编写一个渲染引擎，使用 PHP 内置的 XML/DOM 库来解析类似 XML 的内容。遗憾的是，我拥有的类 XML 语言与 PHP 的 XML 解析库不兼容。

所有示例都使用相同的变量：

```
$template = '<is:namespace:tag attr="value">foo<is:namespace:tag attr="value" /></is:namespace:tag>'; 
```

示例（确保打开 PHP 警告！）：

```
$parser = simplexml_load_string($template);
$parser = XMLReader::xml($template);
while($parser->read()) { echo $parser->name; }
$parser = DOMDocument::loadXML($template);
$parser = new SimpleXMLElement($template); 
```

尝试的每种方法都会引发警告 - 请注意，由于违反了 XML 标准，因此`QName`( `is:namespace:tag`bit) 是不可解析的，而这些工具旨在遵守该标准。

我也试过：

```
$parser = DOMDocument::loadHTML($template); 
```

它还抱怨名称空间缺少声明和标记名称无效。

我认识到，如果我的 XML 的内容没有我可以使用的值`str_replace`或正则表达式来去除`:`'s，但我强烈希望避免数据修改。

如何使用 PHP 内置的 XML 或 DOM 库来解析这种“改进”的格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:40:52.080

如果 - 除了那个冒号 - XML 的其余部分是“有效的”，那么您很有可能可以简单地使用基于正则表达式的搜索和替换来解决这个问题。

以下行确实将`is:namespace`部分替换为命名空间前缀`ns1`：

```
$fixed = preg_replace('((</?)is:namespace(:[a-z]+))', '$1ns1$2', $template); 
```

在将其加载为 XML 文档之前，需要在 XML 文档根（也称为文档）元素中定义前缀：

```
$fixed = "<root xmlns:ns1='is:namespace'>$fixed</root>"; 
```

然后它可以安全地作为 XML 文档加载到任何基于 libxml 的解析器中，例如 SimpleXML：

```
$parser = simplexml_load_string($fixed);

echo $parser->asXML(); 
```

那么输出是：

```
<?xml version="1.0"?>
<root xmlns:ns1="is:namespace">
  <ns1:tag attr="value">
    foo
    <ns1:tag attr="value"/>
  </ns1:tag>
</root> 
```

另请参阅[在线演示](http://eval.in/10046)。如果您的数据使用 CDATA 并且字符串`is:namespace:`在其中重复，则存在一种更改，即这将无法安全工作。

# c# - LINQ to XML 查询中的 NullReferenceException

> ID：14886117
> 
> 赞同：1
> 
> 时间：2013-02-14T23:46:18.173
> 
> 标签：c#, xml, linq, .net-4.0, linq-to-xml

我有类似这样的 xml 代码：文件名为：player.xml

```
<root>
  <person>
    <fname>Dwight</fname>
    <lname>Howard</lname>
    <vertLeap>
      <try1>32.33</try1>
      <try2>33.33</try2>
      <try3>34.33</try3> 
    </vertLeap>
  </person>
  <person>
    <fname></fname>
    <lname>Jordan</lname>
    <vertLeap>
      <try1>40.33</try1> 
    </vertLeap>
  </person>
</root> 
```

这不是我真正的 xml，但应该适用于该示例。现在我想使用 linq to xml 来读取数据。我正在尝试这样。

班级：

```
public class Player
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int Leap1 { get; set; }
    public int Leap2 { get; set; }
    public int Leap3 { get; set; }

    public WritePlayertoDatabase()
    {
        //do stuff to write
    }
} 
```

询问：

```
XDocument xDoc = XDocument.Load("player.xml");
var player_query = from p xDoc.Desendants("person")
                   select new Player
                   {
                       FirstName = p.Element("fname"),
                       LastName = p.Element("lname"),
                       Leap1 = p.Element("try1"),
                       Leap2 = p.Element("try2"),
                       Leap3 = p.Element("try3")
                   }; 
```

我收到 NullReferenceException。在我尝试使用该值之前，有没有办法测试元素是否存在？或者有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:32:05.783

因此，您的 linq 查询有一些问题。

1)`p.Element("fname")`将返回 fname XML 元素，而不是字符串。所以你仍然需要获取元素的值。类似地，Leap1-3 的属性是 int，但你会得到元素值作为搅拌，需要转换它。但是，try1-3 不是 xml 中的整数，因此您可能希望在 Player 类中将类型更改为其他类型。

2) try1 - tryx 元素都是 'vertleap' 的子元素。您不能直接从“人”中获取元素“try1”。它将为空。

那么更像这样的东西怎么样：

```
 var player_query = from p in xDoc.Descendants("person")
                       select new Player
                       {
                           FirstName =  p.Element("fname") != null ? p.Element("fname").Value : "",
                           LastName = p.Element("lname") != null ? p.Element("lname").Value : "",
                           Leap1 = p.Element("vertLeap") != null ? (p.Element("vertLeap").Element("try1") != null ? Decimal.Parse(p.Element("vertLeap").Element("try1").Value) : 0) : 0,

                           Leap2 = p.Element("vertLeap") != null ? (p.Element("vertLeap").Element("try2") != null ? Decimal.Parse(p.Element("vertLeap").Element("try2").Value) : 0) : 0,
                           Leap3 = p.Element("vertLeap") != null ? (p.Element("vertLeap").Element("try3") != null ? Decimal.Parse(p.Element("vertLeap").Element("try3").Value) : 0) : 0,
                       }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:52:37.017

使用您发布的 XML，`p.Element("try<X>")`调用将始终返回 nulll ......正如我看到的 @SimonC 刚刚指出的那样。您需要沿着 XML 树向下隧道以获取值，或用于`Descendants("try<x>").FirstOrDefault()`获取具有匹配名称的第一个后代。这可能仍然为空，这使我们回到问题的真正重点。

问题实际上是您正在尝试对可能不存在的对象执行操作。除了@SimonC 建议的条件序列之外，您还可以使用辅助方法或扩展来检测缺失的元素并提供有意义的默认值。

```
public static string AsString(this XElement self)
{
    if (self == null)
        return null;
    return self.Value;
}

public static double AsDouble(this XElement self, double defValue = default(double))
{
    if (self == null)
        return defValue;
    double res = defValue;
    try { res = (double)self; }
    catch { }
    return res;
}

public static int AsInt(this XElement self, int defValue = default(int))
{
    if (self == null)
        return defValue;
    double res = defValue;
    try { res = (double)self; }
    catch { }
    return (int)res;
} 
```

然后您的 Linq 查询变为：

```
var player_query = from p in xDoc.Descendants("person")
    select new Player
    {
        FirstName = p.Element("fname").AsString(),
        LastName = p.Element("lname").AsString()
        Leap1 = p.Descendants("try1").FirstOrDefault().AsInt(),
        Leap2 = p.Descendants("try2").FirstOrDefault().AsInt(),
        Leap3 = p.Descendants("try3").FirstOrDefault().AsInt()
    }; 
```

如果'player'节点的后代中没有'try1'节点，该`FirstOrDefault()`方法将返回null。然后`AsInt()`使用空引用调用扩展方法`this`，它会检测并返回该空引用，`default(int)`而不是抛出异常。

您也可以编写一堆`ConvertElementToXXX(elem, defValue)`方法，但我认为这是对扩展的合理有效使用。`XElement`没有实现只是一种耻辱`IConvertible`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:18:22.587

我知道我对这个问题太过分了，但是在摆弄它之后，我决定用 XmlSerialization 重写你的示例。根据您的需要，我强烈建议您将数据序列化为对象，然后传递它们。

您将需要 using`using System.Xml.Serialization;`命名空间，但如果您想使用其中任何一个，我编写了以下完整程序。

```
public class Program
{
    [XmlRoot("root")]
    public class Team
    {
        private List<Player> players = new List<Player>();

        [XmlElement("player")]
        public List<Player> Players { get { return this.players; } set { this.players = value; } }

        // serializer requires a parameterless constructor class
        public Team() { }
    }

    public class Player
    {
        private List<int> verticalLeaps = new List<int>();

        [XmlElement]
        public string FirstName { get; set; }
        [XmlElement]
        public string LastName { get; set; }
        [XmlElement]
        public List<int> vertLeap { get { return this.verticalLeaps; } set { this.verticalLeaps = value; } }

        // serializer requires a parameterless constructor class
        public Player() { }
    }

    static public void Main(string[] args)
    {
        Program myProgram = new Program();
        myProgram.WritePlayertoDatabase();
        myProgram.ReadPlayerDatabase();
    }

    public void WritePlayertoDatabase()
    {
        Player p1 = new Player() { FirstName = "dwight", LastName = "howard", vertLeap = new List<int>() { 1, 2, 3 } };
        Player p2 = new Player() { FirstName = "dwight", LastName = "howard", vertLeap = new List<int>() { 1 } };

        Team players = new Team();
        players.Players.Add(p1);
        players.Players.Add(p2);
        XmlSerializer serializer = new XmlSerializer(typeof(Team));
        using (TextWriter textWriter = new StreamWriter(@"C:\temp\temp.txt"))
        {
            serializer.Serialize(textWriter, players);
            textWriter.Close();
        }
    }

    public void ReadPlayerDatabase()
    {
        Team myTeamData = new Team();
        XmlSerializer deserializer = new XmlSerializer(typeof(Team));
        using (TextReader textReader = new StreamReader(@"C:\temp\temp.txt"))
        {
            myTeamData = (Team)deserializer.Deserialize(textReader);
            textReader.Close();
        }
    }
} 
```

# c# - 使用实体框架的 Oracle 查询速度非常慢

> ID：14886120
> 
> 赞同：7
> 
> 时间：2013-02-14T23:46:30.670
> 
> 标签：c#, linq, oracle, entity-framework

这是我的设置：

*   在 .NET 4.0 上编译（我不能比这更高）
*   针对 Oracle 11gR2 数据库使用 EntityFramework
*   使用 ODP.NET 11.2.0.3.20
*   使用 Visual Studio 2012 Ultimate 和[Oracle Developer Tools for Visual Studio](http://www.oracle.com/technetwork/developer-tools/visual-studio/overview/index.html) 11.2.0.3.20
*   使用 LINQ to Entity 执行查询

所以这是我的问题：我有一些使用 Oracle Developer Tools for Visual Studio (11.2.0.3.20) 创建的实体。一些实体相当快地返回结果。但是，对于查询包含超过 2000 万条记录的视图/表的其他人来说，对于这个简单的查询**，返回结果始终需要 10 分钟**（这次我已经通过单元测试验证了）：

```
var member = (from m in context.Members
              where m.MemberID.Equals(memberId, StringComparison.OrdinalIgnoreCase)
              select m).FirstOrDefault(); 
```

我曾经使用[Devart dotConnect for Oracle](http://www.devart.com/dotconnect/oracle/)，它工作得非常好……但我的公司没有更新他们对这个产品的许可，并告诉我使用新的 Oracle Developer Tools for Visual Studio 来完成任务。

作为一种解决方法，我使用`OracleCommand`ODP.NET (Oracle.DataAccess.dll) 提供的直接连接到数据库，并在不到一秒的时间内得到结果。与使用管理客户端直接对数据库执行其他查询相同。

关于为什么会发生这种情况，我最好的猜测是，也许 Entity 正在将整个数据库加载到内存中，然后在其上运行我的查询......这将是可怕的，但我真的不相信这是正在发生的事情。

**有人可以解释为什么会发生这种情况以及如何使用 Entity 修复它，这样我就不必手动重写所有数据库查询？**

**更新：**
所以我找到了我的查询需要 10 分钟才能完成的原因。我（我对数据库的经验很少）把它放在我的 EDMX 文件中：

```
...
<EntityContainer Name="MyStoreContainer">
  <EntitySet Name="MY_TABLE" EntityType="MyDB.Store.MY_TABLE" store:Type="Views" store:Schema="MYUSERNAME" store:Name="MY_TABLE">
    <DefiningQuery>
      SELECT
      "MY_TABLE"."COL1" AS "COL1",
      "MY_TABLE"."COL2" AS "COL2",
      "MY_TABLE"."COL3" AS "COL3",
      "MY_TABLE"."COL4" AS "COL4",
      "MY_TABLE"."COL5" AS "COL5",
      "MY_TABLE"."COL6" AS "COL6",
      "MY_TABLE"."MEMBERSHIP_ID" AS "MEMBERSHIP_ID",
      "MEMBERS"."EXTRA_INFO1" AS "EXTRA_INFO1",
      "MEMBERS"."EXTRA_INFO2" AS "EXTRA_INFO2"
      FROM "MYUSERNAME"."MY_TABLE" "MY_TABLE"
      LEFT JOIN "MYUSERNAME"."MEMBERS" ON "MY_TABLE"."MEMBERSHIP_ID" = "MEMBERS"."MEMBER_ID"
    </DefiningQuery>
  </EntitySet>
... 
```

事实证明，`LEFT JOIN`直接使用管理客户端查询也需要大约 10 分钟。所以我拿出`LEFT JOIN`了……现在我看到速度提高了。这是一个问题，当我得到非常慢的响应时，这个 EntitySet 不是我正在查询的 EntitySet。如果我手动使用`OracleCommand`.
**任何人都可以解释为什么 Entity 让事情变慢了这么多，当我什至没有访问这个左连接查询时？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-18T20:56:42.873

用 . 包装您的输入参数`EntityFunctions.AsNonUnicode(memberId)`。

```
var member = (from m in context.Members
          where m.MemberID.Equals(EntityFunctions.AsNonUnicode(memberId), StringComparison.OrdinalIgnoreCase)
          select m).FirstOrDefault(); 
```

请参阅[https://community.oracle.com/message/10725648](https://community.oracle.com/message/10725648)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-01T19:28:40.900

我们遇到了类似的性能问题。感谢@CameronP 建议使用 EntityFunctions.AsNonUnicode，它解决了性能问题。我们的项目使用 EF6 和 Oracle 12.1* 托管数据访问。我们没有对每个 EF 查询参数进行更改，而是在实体模型上使用了 TypeName 属性，它起作用了！

```
Public Class Table1
    <Column("COLUMN_1", TypeName:="VARCHAR2")>
    Public Property Column1 As String
End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-08T13:18:21.623

另一个解决方案是更新您的预言机提供商！Odac 12c 修复了这个问题：[https ://community.oracle.com/message/11065799#11065799](https://community.oracle.com/message/11065799#11065799)

它将阻止您使用 EntityFunctions.AsNonUnicode() 更改所有查询

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-04-19T19:07:07.050

另一个技巧是禁用延迟加载。

如果可以禁用，请执行此操作。

无法禁用延迟加载的示例：

当您有一个名为“客户”的表时。然后，当你调用这样的东西时：

```
var obj = myCustomerList.FirstOrDefault().ORDERS.ToList() 
```

如果您有访问儿童的代码，则无法禁用延迟加载

# r - 使用循环查找向量的最小值，而不使用 min() 或 sort() 函数

> ID：14886122
> 
> 赞同：0
> 
> 时间：2013-02-14T23:46:32.030
> 
> 标签：r, function, loops

这就是我所拥有的，但显然我错了，因为它不起作用：-\

```
set.seed(1)    
x <- runif(25)

sort<-function(x) {
   for(last in length(x):2) {
      for (first in 1: (last-1)) {
         save<-x[first]
         x[first]<-x[first + 1]
         x[first+1]<-save
      }
   }
   return(x)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:28:30.733

想想算法。一种选择是从向量的第一个元素作为目标开始，然后将其与第二个元素进行比较。如果第二个小于目标，则将目标设置为第二个元素。对元素 3 到 n 重复与目标的比较，其中 n 是向量的长度。

```
findMin <- function(x) {
  minX <- x[1] ## set target to first element of `x`
  for (i in (seq_along(x[-1]) + 1)) { ## i take values 2, 3, ..., length(x)
    if(x[i] < minX) ## do comparison with current target
      minX <- x[i]  ## if element i is smaller than target, update target
  }
  minX
}

> set.seed(1)
> vec <- runif(20)
> min(vec)
[1] 0.06178627
> findMin(vec)
[1] 0.06178627 
```

你*为什么*要这样做超出了我的理解，结果是愚蠢、低效的 R 代码。但是（我认为）这可以满足您的要求，至少是您 Q 的标题所要求的。

# c# - 如何部署通过 IronPython 调用 numpy 的 C# 应用程序

> ID：14886138
> 
> 赞同：5
> 
> 时间：2013-02-14T23:48:11.603
> 
> 标签：c#, python, numpy, ironpython

我正在编写一个 C# GUI 应用程序，我想在其中使用 numpy，我在 Python 2.7 下广泛使用过它，它非常快速且易于编程。（我仍然发现 C# 中的 GUI 工作比 PyQt 更容易使用。）

numpy 和 scipy 的 IronPython 端口现在存在，我想学习如何使用它。

在开始之前，我想知道我将拥有什么样的部署选项？我可以完全包装 python 和 numpy 还是必须在客户的机器上安装 python、Ironpython、numpy？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-03T14:43:49.147

您可以将 Ironpython 代码作为 DLL 或 exe 包装到 .net 程序集中。如果您需要从其他 .NET 代码加载代码，请使用 IronPython 脚本创建一个 DLL

```
import clr
clr.CompileModules(dllname, module1.py, module2.py,...) 
```

然后加载该程序集

```
Assembly dpma = Assembly.LoadFile(Path.GetFullPath("CompiledIronPythonModule.dll"));
pyEngine.Runtime.LoadAssembly(dpma); 
```

（C# 示例）。在 VisualStudio 中，您需要引用 IronPython 和项目中的 dll。

我刚刚成功地使用 IronPython 2.7.5、Visual Studio 2012 .NET 4.0 和 Intel Fortran Composer XE 2013 从头开始​​编译 numpy 和 scipy-refactored（使用后者需要对 scipy iron_setup.py 文件进行一些更改）。输出是一组 DLL。此时我可以在 IronPython 命令行上导入模块。还没有工作的是如何使用 numpy/scipy 导入到 .net 程序集中来烹饪 IronPython 代码。为此，我将检查[ironpycompiler](https://pypi.python.org/pypi/ironpycompiler/ "Ironpy编译器")。

# reporting - openerp 6.1 制作新的 rml 报告

> ID：14886139
> 
> 赞同：0
> 
> 时间：2013-02-14T23:48:18.263
> 
> 标签：reporting, openerp

我想在自定义 rml 报告中制作特定的页眉和页脚（与其他报告不同），因此我无法将页眉/页脚部分更改为该公司如何为该报告制作新的页脚，该页脚将出现在所有报告页面中

我已将页眉作为重复行，`<blockTable>`但我没有找到页脚的任何解决方案

我的 rml 报告的这个样本

```
 <?xml version="1.0" encoding="UTF-8"?>
<document filename="test.pdf">
  <template pageSize="(842.0,595.0)" title="Test" author="Martin Simon" allowSplitting="20">
    <pageTemplate id="main">
      <pageGraphics>
            <image file="addons/sim/report/org.jpg" x="0" y="0" width="842" height="595"/>
      </pageGraphics>
      <frame id="first" x1="72.0" y1="122.0" width="707" height="404"/>
    </pageTemplate>
  </template>
  <story>
    <blockTable repeatRows="1">
     <tr>
        <td>
            Test Header
        </td>
     </tr>
      <tr>[[ repeatIn(objects,'o') ]]
        <td>
          <para style="Table_20_Contents">

          </para>
        </td>
      </tr>
    </blockTable>
   <para name="footer">
        Test footer
    </para>
  </story>
</document> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:33:48.940

您可以像这样在页面上添加自己的页眉页脚。它重复报告的所有页面。

```
<template title="TEST" author="Hello" allowSplitting="20">
    <pageTemplate id="first">
      <frame id="first" x1="15.0" y1="42.0" width="539" height="758"/>
      <pageGraphics>
           <!-- Header -->
            <image x="14cm" y="25.6cm" height="40.0">[[ company.logo or removeParentNode('image') ]]</image>
                <setFont name="Helvetica" size="10.0"/>
                <drawString x="1cm" y="27.2cm">Main Header</drawString>
                <!-- Order Details -->
                <place x="33" y="18cm" width="530.0" height="205.0">
                    <blockTable colWidths="265,265" style="Table1">
                        <tr>
                            <td>Header Value 1</td>
                            <td><para style="normal2-center">Header Value 2</para></td>
                        </tr>
                    </blockTable>
        </place>

                    <!-- footer -->
        <place x="33" y="55cm" width="530.0" height="205.0">
                <blockTable colWidths="265" style="Table1">
                            <tr><td><para style="normal2-center">Footer Value</para></td></tr>
                        </blockTable>
                    </place>
        </pageGraphics>
    </pageTemplate>
  </template> 
```

# git - 恢复被 git pull 覆盖的更改

> ID：14886140
> 
> 赞同：3
> 
> 时间：2013-02-14T23:48:26.937
> 
> 标签：git, git-reflog

我遇到了 git 问题，我无法检索被`git pull`.

我开始了一个没有 GitHub 存储库的项目，后来我做了这个项目。我在创建存储库时分叉了存储库，其中包含一个`README`文件。

我在本地添加了我想使用 推送存储库的文件`git add`，但后来意识到我应该`README`从 GitHub 存储库中提取第一个文件。

拉动后，我尝试推送我的更改，但收到了消息`Everything up-to-date`。

我使用`ls`命令发现添加的文件`git add`被删除并替换为`README.md`.

这些是我执行的命令：
![命令](../Images/3c5c02776db1a899b32a1b6f07b4477f.png)

使用`git log`只是显示了其他人在`README`. 考虑到我没有做出任何承诺，我想这是意料之中的。

Using`git reflog`表明我做了一次拉动，（`HEAD@{0}`）但 using`git reset --hard HEAD@{0}`似乎没有做任何事情。我也尝试`git reset --hard HEAD@{"20 minutes ago"}`过，但只收到警告说日志只回到了我的第一次拉取。

**有没有办法恢复被拉取覆盖的未提交更改？**

**编辑**：

我很抱歉没有做功课，我注意到侧边栏上有一个问题，这个问题是重复的：[Git pull deleted uncommitted changes](https://stackoverflow.com/questions/10268940/git-pull-deleted-uncommitted-changes?rq=1)

我将使用失物招领 ( `cd .git/lost-found/other`) 来尝试恢复我的更改。

**有没有比 lost-found 更简单的方法来恢复更改**，我想这是新问题。如果没有，我会用我正在使用的方法来回答自己。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T04:25:11.633

如问题中所述，我用来恢复更改的解决方案是使用 git 的失物招领。

我过去常常`cd .git/lost-found/other/`把自己带到失物招领处，找到文件所在的地方。

我打开目录中的每个文件以查看其名称，然后将其移动到具有正确名称的正确目录中。

我曾经`git add`添加更改并提交它们，所以现在我不会再丢失它们了。

# python - 如何从同级文件夹中导入 Python 模块？

> ID：14886143
> 
> 赞同：57
> 
> 时间：2013-02-14T23:48:39.907
> 
> 标签：python, import, module, relative-path

我经历了许多与 Python 相关的导入问题，但我无法理解这个问题/让它发挥作用。

我的目录结构是：

```
Driver.py

A/
      Account.py
      __init__.py

B/
      Test.py
      __init__.py 
```

`Driver.py`

```
from B import Test 
```

`Account.py`

```
class Account:
def __init__(self):
    self.money = 0 
```

`Test.py`

```
from ..A import Account 
```

当我尝试运行时：

```
python Driver.py 
```

我得到错误

```
Traceback (most recent call last):

from B import Test

File "B/Test.py", line 1, in <module> from ..A import Account

ValueError: Attempted relative import beyond toplevel package 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-14T23:53:04.857

发生这种情况是因为就 Python 而言，它们是独立的、不相关的包`A`。`B`

`__init__.py`在同一目录中创建一个`Driver.py`，一切都应该按预期工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-05-27T16:27:26.067

在我的情况下，添加`__init__.py`是不够的。如果您收到模块未找到错误，您还必须附加父目录的路径。

```
root :
 |
 |__SiblingA:
 |    \__A.py
 |     
 |__SiblingB:
 |      \_ __init__.py
 |      \__B.py
 | 
```

要从 A.py 导入 B.py，您必须执行以下操作

```
import sys

# append the path of the parent directory
sys.path.append("..")

from SiblingB import B
print("B is successfully imported!") 
```

# android - 在蓝牙传输的数据之间添加延迟

> ID：14886145
> 
> 赞同：0
> 
> 时间：2013-02-14T23:48:48.253
> 
> 标签：android, bluetooth, delay, pic

我正在尝试在我的 Android 智能手机和 PIC 微控制器之间传输一些简单的数据。一切都在使用此代码发送：

```
try { 
    mBluetoothOut.write(new byte[] { 
            StartByte,                  // Start byte
            //(byte)(x1Distance & 0xFF),            // x1 -> LSB
            //(byte)((x1Distance >> 8) & 0xFF), // x1 -> MSB
            (byte)(y1Distance & 0xFF),          // y1 -> LSB
            (byte)((y1Distance >> 8) & 0xFF),   // y1 -> MSB
            (pad1.isYNegative()) ? (byte)1 : (byte)0,
            //(byte)(x2Distance & 0xFF),            // x2 -> LSB
            //(byte)((x2Distance >> 8) & 0xFF), // x2 -> MSB
            (byte)(y2Distance & 0xFF),          // y2 -> LSB
            (byte)((y2Distance >> 8) & 0xFF),   // y2 -> MSB
            (pad2.isYNegative()) ? (byte)1 : (byte)0,
            (byte)(servo1Angle & 0xFF),     // servo 1 -> LSB
            (byte)(servo2Angle & 0xFF)          // servo 2 -> LSB
    });
 } catch (IOException e) { 
    e.printStackTrace(); 
 } 
```

问题是我的 Android 设备发送数据太快，我的微控制器搞砸了。有没有办法在发送的每个字节之间延迟大约 2-3 毫秒？或者我必须逐字节发送并使用`postExecute()`with Handlers 或类似的东西？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:55:20.203

假设您使用像 SPP 这样的标准蓝牙配置文件来发送数据，在接收端，您应该能够以您想要的速率接收（一次一个字节，延迟后的下一个字节）蓝牙内部缓冲或应用流量控制如果发件人太快，则停止发件人。如果使用适当的蓝牙堆栈，我看不出数据会如何混乱

# php - 将字符串（数字）更改为在php中浮动

> ID：14886147
> 
> 赞同：0
> 
> 时间：2013-02-14T23:48:54.120
> 
> 标签：php

我已经从 xml 提要中获得数据，我从这个提要中使用的属性是写的`Decimal="1.14"`，`Decimal="2.00"`我想做的是在函数中使用这些属性并能够比较它们。

像这样

```
if($provider1 > $provider2){
        return $provider1;
    }
    else {
        return $provider2;
    } 
```

如何将这些数字转换为要在函数中使用的浮点数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:52:44.780

试试这个功能：`floatval`

文档在这里： http: [//php.net/manual/en/function.floatval.php](http://php.net/manual/en/function.floatval.php)

然后，您可以执行以下操作：

```
if (floatval($provider1) > floatval($provider2)) {
    return $provider1;
} else {
    return $provider2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:57:18.757

您可以使用`floatval($value)`或`(float) $value`。请参阅此处的类型转换：http: [//php.net/manual/en/language.types.type-juggling.php](http://php.net/manual/en/language.types.type-juggling.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:54:53.737

您可以使用 floatval() 将字符串转换为浮点数。要获取字符串，请使用任何 xml 库。

# c++ - 在 Gtkmm 中如何从组合框中检索数据

> ID：14886150
> 
> 赞同：0
> 
> 时间：2013-02-14T23:49:19.990
> 
> 标签：c++, user-interface, gtkmm

我目前正在编写一个应用程序，其中我有 3 个组合框用于日/年/月，我想知道如何检索当前从组合框中选择的数据并在按下按钮时保存它。这里的问题只是查看组合框中的当前内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-02T14:29:51.697

答案是**get_active_row_number()**方法，它返回所选项目的基于 0 的索引。

在这里您可以看到有关该方法的帮助： [https ://developer.gnome.org/gtkmm/3.7/classGtk_1_1ComboBox.html#a53531bc041b5a460826babb8496c363b](https://developer.gnome.org/gtkmm/3.7/classGtk_1_1ComboBox.html#a53531bc041b5a460826babb8496c363b)

我将它与控件**ComboBoxText**一起使用。

# c++ - 在 C++ 中，使用终端窗口读取文件后，如何使用标准输入？

> ID：14886152
> 
> 赞同：0
> 
> 时间：2013-02-14T23:49:33.177
> 
> 标签：c++, input

我有一个程序，我在其中读取数据文件以填充信息列表

( `./myProgram < dataFile.dat`)

读取文件后，我无法在该终端窗口中使标准输入（cin）工作，它永远不会有机会输入输入，而只是跳过它很可能会抓取一些要存储的随机值。是读取上面列出的文件后，有什么方法可以利用 cin 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:06:33.813

根据您的 shell 环境，您可以将文件输入到另一个 fd，而不是 stdin：

```
$ cat fd_in.c 
int main()
{
    unsigned char buf[1024];
    int bytesread;

    bytesread = read(3,buf,sizeof(buf));
    printf("file is %d bytes\n",bytesread);

    bytesread = read(1,buf,sizeof(buf));
    printf("you entered %d bytes\n",bytesread);
}
$ gcc fd_in.c
$ ./a.out 3< fd_in.c 
file is 220 bytes
my input!
you entered 10 bytes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:07:35.893

`./myProgram < dataFile.dat`意味着标准输入将来自`dataFile.dat`，而不是来自键盘。因此，如果您像这样运行程序，您将无法从标准输入中读取键盘数据。虽然标准输入/输出易于使用并使程序适合管道等。当您的程序具有单个输入和/或单个输出时，它们最自然地工作。如果您的输入来自两个不同的来源，就像您的情况一样，那么您应该让您的程序显式打开文件并从中读取，使用`ifstream`. 这样，键盘输入仍然可以从`cin`.

另外，最好检查一下您的读取是否成功。如果您这样做了，您会看到`cin`文件完成后的所有读取都由于到达文件末尾而失败。

# ruby-on-rails - Rails - 使用表格选项生成脚手架

> ID：14886156
> 
> 赞同：6
> 
> 时间：2013-02-14T23:49:51.263
> 
> 标签：ruby-on-rails, ruby

我上周开始学习 Ruby，今天开始学习 Rails，所以请耐心等待。我看到 Rails 带有生成器，允许您生成模型/控制器甚至模型+控制器+视图捆绑作为“脚手架”。这是我感兴趣的。

但是，我有一个问题。如何设置列的数据库选项？

例如。要生成用户表，我会这样做：

```
rails g scaffold users uuid:binary name:string email:string password:binary registered_on:date number:integer default:string 
```

现在，如果我是个正直的人，并且对仅在模型/控制器中进行验证不满意，但又想做数据库级别的限制，该怎么办。如果我想`email`最多 50 个字符，并且`number`要自动递增，并且所有字段都不允许为 NULL，并且`default`字段必须具有默认值“foo”，该怎么办。有没有办法将这些要求传递给生成器命令？

我知道可以在 rake db:migrate 中使用的 .rb 文件中设置这些选项，但是使用 1 个命令传递值会更容易。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-14T23:58:40.533

至少有些东西是可用的，比如字符串长度，但不确定其他东西。

```
rails g scaffold users email:string{50} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-05T16:17:07.197

1.  在花括号之间使用**类型修饰符，例如：**

    ```
    rails generate migration AddDetailsToProducts price:decimal{5,2} 
    ```

    更多信息：[迁移](http://edgeguides.rubyonrails.org/migrations.html)

2.  使用脚手架并获取通用迁移文件。而且，正如您所提到的，在那里进行自定义。此文件位于`db/migrate`.

完成自定义字段后，不要忘记执行`rake db:migrate`.

# c# - 如何缩短嵌套if语句

> ID：14886158
> 
> 赞同：2
> 
> 时间：2013-02-14T23:49:58.137
> 
> 标签：c#

如何缩短这个嵌套的 if 语句？

```
if(x > 0){
  if(grid[x-pixelOffset,y] == true){
    middleLeft = 1;
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:51:17.700

您可以使用`&&`运算符：

```
if ((x > 0) && grid[x-pixelOffset,y]) 
    ... 
```

`== true`检查`bool`变量值时不需要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T19:55:17.807

只是为了获取更多信息，如果不需要短路，您可以使用 &。如果你写 if( (x>0) & grid[x,y]) {...}，第二部分也将被评估。

# javascript - Nodejs：如何返回具有相同响应（文本和图像）的不同内容类型？

> ID：14886161
> 
> 赞同：9
> 
> 时间：2013-02-14T23:50:12.373
> 
> 标签：javascript, node.js

我正在尝试学习 nodejs，我认为最好的方法是尝试在不使用 express 或任何其他非核心模块的情况下做一些事情。我一直在尝试同时发送一些文本和图像。我正在尝试的代码是：

```
var http = require('http');
var fs = require('fs');

var server = http.createServer(function(request,response) {

    fs.readFile('my_pic.jpg', function(error, file) {
        response.writeHead(200, {'content-type':'text/html'});
        response.write('<p>hi there!</p>');

        response.writeHead(200, {'content-type':'image/jpg'});
        response.write(file, 'image');

        response.end();
    });

});

var port = process.env.PORT || 8080;

server.listen(port, function() {
    console.log('Listening on port ' + port);
}); 
```

所以理想情况下应该交付的是：

```
<html>
<body>
<p>hi there</p>
<img src='my_pic.jpg'/>
</body>
</html> 
```

但相反，什么都没有出现。

我尝试在写“你好”之后放置一个 response.end()，它显示文本，然后我尝试交换文本和图片的位置（包括标题），它显示了图片，但我不知道了解如何让两者同时显示，就像在真实的网页上一样。

你能解释一下如何将不同类型的内容放到同一个网页上——它们是否需要在不同的响应中？我在另一个问题上遇到的事情：

[nodejs - 如何读取和输出 jpg 图像？](https://stackoverflow.com/questions/9540978/nodejs-how-to-read-and-output-jpg-image)

类似的东西看起来像解决方案，但我不知道如何将它应用到我的情况（我在服务器端没有很多经验。）

非常感谢

编辑：从 user568109 的回复中得到它的工作：

```
var http = require('http');
var fs = require('fs');

var server = http.createServer(function(request,response) {
fs.readFile('my_pic.jpg', function(error, file) {

    var imagedata = new Buffer(file).toString('base64');

    response.writeHead(200, {'content-type':'text/html'});
    response.write("hi there!<img src='data:my_pic.jpg;base64,"+imagedata+"'/>");
    response.end();

    });

});

var port = process.env.PORT || 8080;

server.listen(port, function() {
    console.log('Listening on port' + port);
}); 
```

不过，这似乎在嵌入图像方面需要做很多工作——如果我想放入多个图像，我就必须继续嵌套那些文件流回调？

我也尝试过这种方式，但它不起作用：

```
var http = require('http');
var fs = require('fs');

var server = http.createServer(function(request,response) {

    response.writeHead(200, {'content-type':'text/html'});
    response.write("hi there!<img src='my_pic.jpg'/>");
    response.end();

});

var port = process.env.PORT || 8080;

server.listen(port, function() {
    console.log('Listening on port' + port);
}); 
```

我不确定这是否是人们所说的意思

```
response.write('<img src="my_pic.jpg"/>') 
```

，因为服务器似乎没有代表我发出另一个请求来获取图像？它只是显示一个损坏的图标图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T12:20:26.363

如果您`response.write('<img src="my_pic.jpg"/>');`按照上述方法进行操作，则仅当浏览器为图像发送 GET 时才会发送图像文件。它将成为多部分请求。

或者你可以这样做。可以在 HTML 中以二进制形式发送您的图像。采用 ：

```
<img src="data:image/gif;base64,imagedata"> 
```

其中 imagedata 是 gif 图像的 base64 编码。所以在 node.js 中这样做：

```
//Write text in response.
content = get-image-file-contents;     //store image into content
imagedata = new Buffer(content).toString('base64');    //encode to base64
response.write('<img src="data:image/gif;base64,'+imagedata+'">');//send image
response.end(); 
```

在此处检查正确的图像转换[NodeJS base64 图像编码/解码不太工作](https://stackoverflow.com/questions/8110294/nodejs-base64-image-encoding-decoding-not-quite-working)

这会发送一个同时发送文本和图像的响应。响应只需要一个标头`response.writeHead(200, {'content-type':'text/html'});`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:57:11.620

您只能将一个值写入给定的标头，因此第二个标头将覆盖第一个标头。两种解决方案是

1.  在 html 中写出图像的 url - 对用户来说会稍微慢一些（需要额外的 http 请求来获取图像），但根据用例，这通常是可以接受的并且实现起来非常简单
2.  将图像转换为 data-uri 字符串，并将其作为图像源包含在 html 中。实现起来比第一种方法更复杂（我不知道有任何库可以在节点中进行转换）并且好处可以忽略不计。

# python - Python：如何声明多个具有给定名称的变量？

> ID：14886165
> 
> 赞同：0
> 
> 时间：2013-02-14T23:50:42.653
> 
> 标签：python, list

例如，假设我有一个具有 5 个属性的对象。我将如何创建 5 个列表，每个列表对应于对象的一个​​属性，并且列表的名称必须与这些属性匹配。我尝试了以下方法，但它给了我一个语法错误：

```
for x in A.attributes
    str(x) = []; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:52:29.287

您需要使用 aa 字典：

```
d = {}

for x in A.attributes
    d[x] = []; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:55:16.570

像这样：

```
class A(object):
    pass

A.a1=[] 
```

这增加了一个类属性。

对于实例属性：

```
class A(object):
    pass

t=A()
t.a1=[] 
```

或者，如果属性已经存在于您的对象实例中：

```
for attr, value in [(a,v) for a,v in t.__dict__.iteritems()]:
   t.attr=[] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:12:16.273

回答OP的原始问题可以做...

```
for x in A.attributes
    globals()[x] = [] 
```

但正如 Rohit 建议的那样，你想要，不是`dict`更好，或者 OP 可能想要一个`namedtuple`.

# xml - XSLT 对 xml 使用 doc 函数

> ID：14886168
> 
> 赞同：0
> 
> 时间：2013-02-14T23:50:55.993
> 
> 标签：xml, xslt, xsd

我正在学习 xml 和 XSLT。

我想创建 XSLT 文件，它可以显示 family.xml 文件中的所有名称

我有...

> doc("family.xml")//名称

但是，我不确定在 XSLT 文件上使用 doc 函数的语法。

有人可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:22:25.520

假设您的 filename.xml 就像：

```
<?xml version="1.0"?>
<bookstore>
  <book category="COOKING">
    <title lang="en">Everyday Italian</title>
    <author>Giada De Laurentiis</author>
    <year>2005</year>
    <price>30.00</price>
  </book>
  <book category="CHILDREN">
    <title lang="en">Harry Potter</title>
    <author>J K. Rowling</author>
    <year>2005</year>
    <price>29.99</price>
  </book>
  <book category="WEB">
    <title lang="en">Learning XML</title>
    <author>Erik T. Ray</author>
    <year>2003</year>
    <price>39.95</price>
  </book>
</bookstore> 
```

获取所有标题：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema" version="2.0">

<!-- match root documents tag -->
<xsl:template match="/">
<xsl:apply-templates select="document('filename.xml')/bookstore//title/node()" mode="document"/>
</xsl:template>

  <xsl:template match="/" mode="document">
    <xsl:copy-of select="."/>
  </xsl:template>

</xsl:stylesheet> 
```

# c# - 用 C# 读取 Excel 电子表格，不相等的列/值

> ID：14886170
> 
> 赞同：1
> 
> 时间：2013-02-14T23:51:04.720
> 
> 标签：c#, xml, excel, xml-parsing

我有一个作为 XML 的 Excel 电子表格输出，其列定义如下：

```
 <Row ss:AutoFitHeight="0">
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">#</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">prefix</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">name</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">label</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">totalLabel</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">base schema</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">systemid</ss:Data>
        </Cell>
        <Cell ss:StyleID="ColumnHead">
          <ss:Data ss:Type="String">prohibit</ss:Data>
        </Cell>
      </Row> 
```

这是一个示例行：

```
<Row ss:AutoFitHeight="0">
        <Cell ss:StyleID="NoBorderNumberCell">
          <ss:Data ss:Type="Number">1</ss:Data>
        </Cell>
        <Cell ss:StyleID="NoBorderCell">
          <ss:Data ss:Type="String">ifrs</ss:Data>
        </Cell>
        <Cell ss:StyleID="NoBorderCell">
          <ss:Data ss:Type="String">AccountingProfit</ss:Data>
        </Cell>
        <Cell ss:StyleID="NoBorderCell">
          <ss:Data ss:Type="String">Accounting profit</ss:Data>
        </Cell>
        <Cell ss:StyleID="NoBorderCell"/>
        <Cell ss:StyleID="NoBorderCell">
          <ss:Data ss:Type="String">full_entry_point</ss:Data>
        </Cell>
      </Row> 
```

问题是，如何检测哪些单元格缺少哪些列？是否要求源对所有空单元格都有一个空白的自闭合标签，以便我每次都能将每列与每个值配对？

我将如何在 C# 中处理这种情况？我拥有最低限度的权利，不知道如何将其分开以解决缺失的列。

```
 if (reader.Name == "ss:Data")
      {                                       

          while (reader.Read())
               Response.Write(reader.Value);
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:48:10.580

您可以使用 LinqToExcel 读取数据，它应该更快，因为它不必加载整个文件。但是，LinqToExcel 使用 OLEDB 而不是 Open XML SDK 来读取文件。

```
var excel = new ExcelQueryFactory("excelFileName");
var firstRow = (from c in excel.Worksheet()
                select c).First(); 
```

[请参阅LinqToExcel](https://github.com/paulyoder/LinqToExcel#welcome-to-the-linqtoexcel-project)的其余文档。

否则，您可以使用 LINQ 执行此操作：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;
using System.Xml.Linq;

namespace UnitTest
{
    [TestFixture]
    public class TestCode
    {
        [Test]
        public void ReadExcelCellTest()
        {
            XDocument document = XDocument.Load(@"C:\TheFile.xml");
            XNamespace workbookNameSpace = @"urn:schemas-microsoft-com:office:spreadsheet";

            // Get worksheet
            var query = from w in document.Elements(workbookNameSpace + "Workbook").Elements(workbookNameSpace + "Worksheet")
                        where w.Attribute(workbookNameSpace + "Name").Value.Equals("Settings")
                        select w;
            List<XElement> foundWoksheets = query.ToList<XElement>();
            if (foundWoksheets.Count() <= 0) { throw new ApplicationException("Worksheet Settings could not be found"); }
            XElement worksheet = query.ToList<XElement>()[0];

            // Get the row for "Seat"
            query = from d in worksheet.Elements(workbookNameSpace + "Table").Elements(workbookNameSpace + "Row").Elements(workbookNameSpace + "Cell").Elements(workbookNameSpace + "Data")
                    where d.Value.Equals("Seat")
                    select d;
            List<XElement> foundData = query.ToList<XElement>();
            if (foundData.Count() <= 0) { throw new ApplicationException("Row 'Seat' could not be found"); }
            XElement row = query.ToList<XElement>()[0].Parent.Parent;

            // Get value cell of Etl_SPIImportLocation_ImportPath setting
            XElement cell = row.Elements().ToList<XElement>()[1];

            // Get the value "Leon"
            string cellValue = cell.Elements(workbookNameSpace + "Data").ToList<XElement>()[0].Value;

            Console.WriteLine(cellValue);
        }
    }
} 
```

# d - 测试关联数组是否包含 D 中的键

> ID：14886171
> 
> 赞同：7
> 
> 时间：2013-02-14T23:51:06.757
> 
> 标签：d, associative-array

这个问题不言自明。我希望能够在实际插入之前检查关联数组是否包含我将要（可能）插入的值。有没有一种简单的方法可以在不搜索的情况下做到这一点`dict.keys`？也许像`if (dict.contains(val)) ...`什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T00:17:28.193

要测试**键**是否在关联数组中，请使用`in`运算符：

```
string[int] aa;

string* ps = 100 in aa;

if(ps)
{
    // 100 is a key in aa, ps is a pointer to the corresponding value
}
else
{
    // 100 is not a key in aa
} 
```

要测试**值**是否存在，您必须搜索`aa.values`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T19:49:50.100

```
if (!dict.get(key, null))
     dict[key] = val; 
```

# angularjs - Angular：自定义属性的 ng:class 等价物？

> ID：14886174
> 
> 赞同：3
> 
> 时间：2013-02-14T23:51:13.370
> 
> 标签：angularjs

在 Angular 中，想象一下这样的情况：

```
<a href="foo" data-bubble="{{unread_badge_counts.bcal}}">bCal</a> 
```

如果 unread_badge_counts.bcal = 0，我根本不希望数据气泡属性出现在 DOM 中。

我期待找到一个类似于 ng:class 的指令，它可以让我在其中坚持一些条件。但我在文档中没有看到任何关于此的内容。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:27:13.660

您可以为此目的创建一个简单的指令：

```
app.directive('bubble', function() {
    return function(scope, element, attrs) {
        // Whatever the data-bubble attr is set to will
        // be the expression we watch.
        var expr = attrs.bubble;

        scope.$watch(expr, function(val) {
            if (val > 0) {
                element.attr('data-bubble', val);
            } else {
                element.removeAttr('data-bubble');
            }
        });

    };
}); 
```

[这是一个小提琴](http://jsfiddle.net/m8tGK/)。如果上面有`data-bubble`属性，“Inspect me”将是灰色的，否则没有背景。

# java - Google Guava 中复杂的时限缓存键

> ID：14886180
> 
> 赞同：1
> 
> 时间：2013-02-14T23:51:40.507
> 
> 标签：java, caching, guava

抱歉标题不好，但我不知道如何表达我的用例。

我正在尝试使用 Guava 缓存来加载由其 ID 键入的用户配置文件对象。问题是配置文件可能会随着时间而改变，所以我还需要在日期之前键入请求。此外，我只想为单个用户缓存一个配置文件（而不是为单个用户在一周中的每一天缓存 7 个不同的配置文件）。

只有当日期发生变化时，有没有办法用新加载的缓存条目替换现有的缓存条目，而不是为新的唯一键添加新的缓存条目？

为了清楚起见：

示例密钥看起来像`<user id, date>`

如果我有一个由 键控的缓存条目`<123, "2013-02-13">`，并且请求进入`<123, "2013-02-14">`，则在加载新配置文件后，用户 123 的缓存中应该只有一个条目。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:57:17.797

听起来您应该做的是拥有一个`Cache<UserId, DateAndProfile>`，然后检查自己是否`DateAndProfile`需要覆盖。Guava 缓存 API 不会让您以任何花哨的方式将不同的键视为“相同的”。

# c# - 从 WCF 服务发送带有嵌入图像的邮件

> ID：14886181
> 
> 赞同：0
> 
> 时间：2013-02-14T23:51:52.467
> 
> 标签：c#, wcf, email, c#-4.0, html-email

我有一个向我的客户发送电子邮件的 WCF 服务。该电子邮件正文是html。所以它有 CSS 样式和嵌入的图像。但现在的问题是图像 src 必须作为完整地址给出。那么是否有任何选项可以将图像也作为 wcf 服务的一部分公开并使用该完整地址。

我不想使用 likeResource 选项，因为我使用的是开源电子邮件模板引擎

Town Crier – .NET 的开源电子邮件模板引擎 [http://thecodedecanter.wordpress.com/2010/07/19/town-crier-an-open-source-e-mail-templating-engine-for -网/](http://thecodedecanter.wordpress.com/2010/07/19/town-crier-an-open-source-e-mail-templating-engine-for-net/)

该引擎需要将图像作为完整地址提供。

任何更好的解决方案将不胜感激。

谢谢，阿拉格桑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:28:35.070

如果图像是静态的并且不是太大，您可以使用消息中的`LinkedResources`属性将它们包含在消息本身中`AlternateView`。

```
AlternateView html = message.AlternateViews.FirstOrDefault(v => v.ContentType.Name == "text/html");
if (html != null)
{
    LinkeResource img = new LinkedResource(imgFileName, imgMimeType);
    img.ContentId = imgContentName;
    html.AddLinkedResources.Add(img);
} 
```

然后使用URL 语法`img.ContentId`在消息中引用。`"cid:ContentId"`因此，如果您为图像提供了 ContentId，`"header.jpg"`则可以使用以下方法在 HTML 电子邮件中引用它：`<img src="cid:header.jpg" />`

方便插入小徽标等。

# asp-classic - 批处理文件执行asp经典

> ID：14886183
> 
> 赞同：1
> 
> 时间：2013-02-14T23:52:04.887
> 
> 标签：asp-classic

我需要帮助从客户端执行批处理文件（通过使用 ASP Classic 执行的 HTTP 内部网访问）。

使用的操作系统：

*   客户端 (Windows XP) - 用户将在此处访问 HTML 页面。
*   服务器 (Windows server 2003) - 这是创建文件夹的位置，包括批处理文件。这也是 ASP 页面和 HTML 页面存储并通过 IIS 运行的地方

设想：

用户将访问链接到 asp 页面的 HTML 页面......

HTML 代码：

```
<html>
<body>
<form method="GET" action="default.asp">
Name<input type="text" name="firstname"/>
Uname<input type="text" name="username"/>
Fulname<input type="text" name="fullname"/>
Pass<input type="text" name="password"/>
Qwarning<input type="text" name="qwarning"/>
Qlimit<input type="text" name="qlimit"/>
<input id="submit" type="submit" value= "submit" />
</form>
</body>
</html> 
```

填写表格后，将执行以下 asp 代码。
-以下代码将创建一个文件夹并创建一个批处理文件，该文件将创建一个用户帐户并设置其帐户权限

ASP 代码：

```
<%
'Folder Creation
dim fs
Dim name,uname,fulname,pass,qlimit,qwarning

name = Request.QueryString("firstname")
uname = Request.QueryString("username")
fulname = Request.QueryString("fullname")
pass = Request.QueryString("password")
qlimit = Request.QueryString("qlimit")
qwarning = Request.QueryString("qwarning")

'Batch File Creation
set fs=Server.CreateObject("Scripting.FileSystemObject")
if NOT fs.FolderExists("c:\dept\" & name ) Then 
fs.Createfolder("c:\dept\" & name)
response.write name &" successfully created"
else
response.write name &" is already exist!"

end if
set fs=nothing

dim fsc,cfile
set fsc=Server.CreateObject("Scripting.FileSystemObject")
set cfile=fsc.CreateTextFile("c:\dept\" & name & ".bat")

'User Creation
cfile.writeline("echo off")
cfile.writeline("cd\")
cfile.writeline("Net User " & uname & " " & pass & " /add /comment:""Created by Mystic System"" /expires:never /fullname:""" & fulname & """ /passwordchg:no")
cfile.writeline("WMIC USERACCOUNT WHERE ""Name='" & uname & "'"" SET PasswordExpires=False")

'USER QUOTA
cfile.writeline("fsutil quota modify c: 104857600 209715200 WINDOWS-GDKLDNY\" & uname)

'Creation OF Permision to folder
cfile.WriteLine("cacls c:\dept\" & name & " /e /P Administrator:F")
cfile.WriteLine("cacls c:\dept\" & name & " /e /P " & uname & ":R")
cfile.WriteLine("cacls c:\dept\" & name & " /e /G " & uname & ":W")
cfile.WriteLine("del /a " & "c:\dept\" & name & ".bat")

cfile.close

set cfile=nothing
set fsc=nothing
set perm=nothing

set wshell = CreateObject("WScript.Shell") 
wshell.run "c:\dept\" & name & ".bat" 
set wshell = nothing

%> 
```

错误：

> “没有显示任何错误。”

- 由于绝望，我已经授予 IUSR、IWAM、IIS_WPG 包括 NETWORK SERVICE 对根文件夹的完全权限.. :(

问题：
批处理文件没有执行或者可能没有被读取（就像批处理文件没有打开来执行它的内容一样）。如果我手动运行它或在批处理文件上按 Enter 键，它会完美运行。似乎是什么问题？它在我的 ASP 上吗？

-我已经使用“Filemon”应用程序监视了客户端正在访问的进程或文件，结果都是来自 w3wp.exe 和 cmd.exe 的成功。-我尝试创建一个 vbscript 来执行该批处理，并且该 vbscript 正在由 asp 调用。
仍然没有运气。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-04T19:21:56.413

另一种选择 - 特别是如果您需要在与 IIS 不同的安全上下文下运行这些脚本以进行文件夹/共享访问、运行管理员特权命令等 - 是设置 Windows 计划任务来运行脚本（无需任何关联的计划（如果不需要），然后从 ASP 页面调用该任务。

[从 ASP/IIS 页面运行计划任务](http://tallitguy.blogspot.ca/2014/09/allowing-iis-web-page-to-execute.html)

它确实需要授予对计划任务文件的 IUSR 帐户的文件系统访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T07:14:49.703

根据我的经验，WScript.Shell 仅适用于 IIS 5，我是否可以建议另一种执行批处理文件的方法：

如果您有权访问 SQL：

[如何从 ASP 页运行 sqlcmd.exe？](https://stackoverflow.com/questions/587189/how-can-i-run-sqlcmd-exe-from-an-asp-page)

如果可以注册 COM：

[http://www.shotdev.com/asp/asp-run-execute-exe/asp-execute-exe-wscript-shell/](http://www.shotdev.com/asp/asp-run-execute-exe/asp-execute-exe-wscript-shell/)

资料来源： [尝试使用脚本启动 Photoshop](https://stackoverflow.com/questions/14532048/trying-to-launch-photoshop-with-scripting/14555053#14555053)

# android - 无法找到已安装 Android 的 Google Maps API 密钥

> ID：14886187
> 
> 赞同：0
> 
> 时间：2013-02-14T23:52:23.140
> 
> 标签：android, google-maps

我已经为我的 Android 应用程序完成了 Google Maps API 密钥的申请表，成功提供了包名称和 SHA1 密钥（来自我的 debug.keystore）（它接受了数据并返回到打开页面），但我可以'看不到 API 密钥。我可以看到一个“当您不需要访问用户数据时，使用 API 密钥来识别您的项目的简单 API 访问”。但当然，这在应用程序中不起作用。

我不认为我在随附的屏幕截图中透露了任何机密数据：

![截屏](../Images/b94c9140f23c9bfb7feac8ecc4680268.png)

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:21:10.347

我走错了路！就像单击“创建新的 Android 密钥”按钮一样简单——我按下了 OAuth 按钮。

# python - 解析带前缀的xml

> ID：14886191
> 
> 赞同：0
> 
> 时间：2013-02-14T23:52:29.710
> 
> 标签：python, xml, lxml, xml-namespaces

我将如何使用解析以下区域值`lxml`？

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<mstns:NewDataSet xmlns:mstns="AscentMetadataReport" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <mstns:Report>
        <mstns:Metadata>
            <mstns:Detail_Collection>
                <mstns:Detail>
                    <mstns:Territory>ARGENTINA</mstns:Territory> 
```

这是我尝试过的：

```
node=etree.fromstring(contents)
territory = node.find('NewDataSet/Report/Metadata/Detail_collection/Detail/Territory') 
```

尽管上述方法不起作用。我将如何解析这里的领土？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:56:15.210

在此处使用命名空间：

[http://lxml.de/tutorial.html#namespaces](http://lxml.de/tutorial.html#namespaces)

```
territory = node.find('mstns:ISOCountry',namespaces={'mstns':'AscentMetadataReport'}).text 
```

# rest - 如何使用带有 RESTful api 的骨干网实现国际象棋？

> ID：14886195
> 
> 赞同：2
> 
> 时间：2013-02-14T23:52:46.207
> 
> 标签：rest, backbone.js, websocket, chess

当一个玩家做出一个移动到服务器时。并且该动作由服务器推送给第二个玩家。据我所知，将移动推送给第二个玩家的服务器不符合 RESTful api。

根据我对backbone.js 的了解，它确实适用于RESTful 设置。有没有办法将backbone.js 与websockets 一起使用，以允许服务器随时将数据推送到客户端？

甚至有没有一种惯用的方式来使用骨干网和 websockets 实现国际象棋？如果不是，那么实施国际象棋的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:18:18.560

你绝对可以做到。而不是获取您的集合/模型，您只需将来自 websocket 的 json 数据`set`或`update`/数据放入正确的模型或集合中。`reset`

有点伪代码示例：

```
var board = new Backbone.Collection(); // this would probably be your own extended Collection instead.

function boardChange(jsonFromServer){
   // Take the json array from server,
   // and update the collection with it.
   // This would trigger 'change' events in each model in the collection (if changed).
   board.update(jsonFromServer);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:39:02.923

实现一个国际象棋应用程序并不需要`Backbone`架构。只要您的服务器支持`Asynchronous API`, `WebSockets`, 甚至`long-polling`（任何实时的），它都是可能的。`API`网上已经有大量的s 可以做到这一点（即[FireBase](https://www.firebase.com/)）以及框架（即[Meteor](http://meteor.com/)）。

如果您在服务器端使用[Node JS](http://nodejs.org/) ，还请查看[Socket IO 。](http://socket.io/)GitHub 上有大量的开源项目已经利用了其中一些 Web 技术，尤其是 Backbone。[带 Socket IO 的骨干网](https://github.com/scttnlsn/backbone.io)。[Backbone.ioBind](http://alogicalparadox.com/backbone.iobind/)看起来也是一个很有前途的项目，其中包含您可以查看的代码示例。

为了让它工作`Backbone`，数据 API 只需要通知任何客户端侦听器服务器上已经进行了更新，这反过来会触发`change`Backbone 上的事件`Model`。

您甚至可以设置一个计时器，每`n`隔一段时间就向服务器执行一次请求，以测试您的代码原型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:04:50.417

您可以重载 Backbone.sync 方法以使用 websockets。事实上的 To-Do 示例 ( [http://addyosmani.github.com/todomvc/](http://addyosmani.github.com/todomvc/) ) 这样做是为了使用本地存储而不是 RESTful 数据存储，您可以对 Web 套接字执行相同的操作。事实上，如果你环顾一下 Github/Google，你可能会找到已经做过的人。

# series - Maple中的这个命令“series(diff(f(z), z), z = 1, 2)”有什么问题？

> ID：14886196
> 
> 赞同：0
> 
> 时间：2013-02-14T23:52:47.163
> 
> 标签：series, maple

假设`f(z)`是 的任意函数`z`。在 Maple 中，如果我们想得到`diff(f(z),z)`at的级数展开`z=0`，我们可以使用

```
series(diff(f(z), z), z = 0, 2) 
```

输出为“(D(f))(0)+...”。但是，我们不能得到`diff(f(z),z)`at`z=1`的级数展开式

```
series(diff(f(z), z), z = 1, 2) 
```

输出为“错误，（在 PDEtools/useD/diff_to_D 中）无效输入：diff 收到 z+1，它的第二个参数无效。” 出了什么问题，以及如何获得包含函数导数的表达式的级数展开，例如`diff(f(z),z)`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:24:20.277

It looks like a bug.

Workarounds might include,

```
series(D(f)(z), z = 1, 2);
                                         /       2\
     D(f)(1) + @@(D, 2)(f)(1) (z - 1) + O\(z - 1) / 
```

or (with a different expansion order option),

```
MultiSeries:-series(diff(f(z), z), z = 1, 3);
                                         /       2\
     D(f)(1) + @@(D, 2)(f)(1) (z - 1) + O\(z - 1) / 
```

# scala - scala - def 有和没有 =

> ID：14886197
> 
> 赞同：1
> 
> 时间：2013-02-14T23:52:53.733
> 
> 标签：scala, function

下面这两个有区别吗。。

```
scala> def foo() = {}
foo: ()Unit

scala> def foo() {}
foo: ()Unit 
```

他们似乎是一样的。
两者都支持有什么原因吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T00:03:36.730

```
def foo() {} 
```

等同于（并强制执行）

```
def foo(): Unit = {} 
```

尽管

```
def foo() = {} 
```

将应用类型推断来确定方法体的结果类型。

因此，对于前两个选项，`Unit`是唯一允许的返回类型，而在第三个选项中，返回类型取决于实现。

# android - phonegap 项目中的多个 webview

> ID：14886198
> 
> 赞同：0
> 
> 时间：2013-02-14T23:52:57.383
> 
> 标签：android, ios, cordova, mobile

我是 phonegap 平台的新手。有一些疑问请帮助我。

首先我的问题是“究竟什么是科尔多瓦切肉刀”？请用外行语言回答。

其次，如果有人说“每个模块都通过一个主 webview 对象运行”，那么这是否意味着该应用程序只有一个 webview。

谢谢，维沙尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:37:13.510

使用切割器，您可以更改本机视图以显示 html

如果要使用 cleaver，则必须将 cordova 作为框架包含在内。

在 .dmg 中，您有一个 pdf，解释了将 cordova 包含为框架以及如何使用它的步骤。我想你需要安装cordova，因为如果你不安装它，你就不能得到cordova.framework

# sql - 可怕的访问数据库问题

> ID：14886202
> 
> 赞同：0
> 
> 时间：2013-02-14T23:53:28.657
> 
> 标签：sql, ms-access

我有一个来自客户端的糟糕数据库，我需要计算查询结果的数量，如下所示：

```
SELECT
  Offices.OfficeID
, ContractsBooksCommodities.CommodityID
  FROM ((((Offices
INNER JOIN tbl_Sales
        ON Offices.CompanyID = tbl_Sales.CompanyID)
INNER JOIN ContractBooks
        ON tbl_Sales.CompanyID = ContractBooks.CompanyID)
INNER JOIN ContractsBooksAds
        ON ContractBooks.ContractNum = ContractsBooksAds.ContractNum)
INNER JOIN ContractsBooksBrands
        ON ContractsBooksAds.ContractNum = ContractsBooksBrands.ContractNum)
INNER JOIN ContractsBooksCommodities
        ON ContractsBooksBrands.ContractNum = ContractsBooksCommodities.ContractNum; 
```

我怎样才能使这个计数返回的记录数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:59:10.527

一般来说，

```
select count(*)
from (
  your-select-query
) 
```

将为您提供查询返回的记录数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:56:22.103

COUNT 和 GROUP BY 是我的猜测：

```
SELECT Offices.OfficeID, ContractsBooksCommodities.CommodityID, COUNT(*) AS COUNT
FROM ((((Offices INNER JOIN tbl_Sales ON Offices.CompanyID = tbl_Sales.CompanyID) INNER JOIN ContractBooks ON tbl_Sales.CompanyID = ContractBooks.CompanyID) INNER JOIN ContractsBooksAds ON ContractBooks.ContractNum = ContractsBooksAds.ContractNum) INNER JOIN ContractsBooksBrands ON ContractsBooksAds.ContractNum = ContractsBooksBrands.ContractNum) INNER JOIN ContractsBooksCommodities ON ContractsBooksBrands.ContractNum = ContractsBooksCommodities.ContractNum
GROUP BY Offices.OfficeID, ContractsBooksCommodities.CommodityID
ORDER BY Offices.OfficeID, ContractsBooksCommodities.CommodityID 
```

# ios - Monotouch - 单击按钮时无法关闭当前视图

> ID：14886209
> 
> 赞同：0
> 
> 时间：2013-02-14T23:54:09.377
> 
> 标签：ios, uinavigationcontroller, xamarin.ios

我有一个视图让用户编辑`EntryElement`. 我通过“完成”按钮的委托很好地注册了单击事件，但是，我无法让它关闭当前视图以转到上一个视图。这是我现在正在尝试的：

```
AppDelegate.navigation.PresentedViewController.DismissViewController(true, null); 
```

我也试过：

```
AppDelegate.navigation.PresentedViewController.RemoveFromParentViewController(); 
```

`navigation`只是一个`UINavigationController`

编辑：

我正在使用`Monotouch.Dialog`构建所有视图。这个视图是通过一个方法创建的。一旦他们单击完成按钮，我希望它返回到上一个视图。下面是方法的内容：

```
public static void EditClientTypeView (string typeName, string typeId)
        {
            DialogViewController editClientTypeVC;
            UIBarButtonItem doneButton = new UIBarButtonItem (UIBarButtonSystemItem.Done);

            EntryElement element = new EntryElement("Type Name", "Name of client type", typeName, false);

            var root = new RootElement ("Edit Type") {
                new Section () {
                    element
                }
            };

            editClientTypeVC = new DialogViewController (root, true);
            editClientTypeVC.NavigationItem.RightBarButtonItem = doneButton;

            doneButton.Clicked += (sender, e) => {
                // Need to save the edited client type to the database
                Console.WriteLine("Done button clicked signifying the user is finished editing");
                AppDelegate.navigation.PresentedViewController.RemoveFromParentViewController();
                //AppDelegate.navigation.DismissViewController(true, null);
            };

            AppDelegate.navigation.PushViewController(editClientTypeVC, true);
        } 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:43:19.013

由于您将视图控制器推送到导航堆栈上，因此您可以通过将其从堆栈中弹出来将其关闭。 [UINavigationController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)具有三个 POP 方法

*   PopToRootViewController - goes all the way back to the root view of your navigation controller
*   PopToViewController - pops back to a specific view controller
*   PopViewController - pops back to the "previous" view controller

# c++ - C++ 中没有数据成员的类

> ID：14886214
> 
> 赞同：10
> 
> 时间：2013-02-14T23:55:04.800
> 
> 标签：c++, oop, class, interface, static

这可能不是 C++ 特有的问题，更多的是与面向对象编程有关。我是新手，我怀疑我的设计。我有一个*Parser*类 ，它基本上实现了许多处理解析表达式的函数，从中缀到后缀的转换等。我在主函数中使用这些*Parser*函数。我意识到我不需要这个类的任何数据成员。因此，我真的不需要这个类的对象。因此，我最终使类中的每个函数都是静态的。这个设计有什么奇怪的吗？我应该把它作为一个接口吗？有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T00:06:18.833

1.  您需要一个解析器，并且知道您希望它为您做什么——这实际上就是您的“接口”。

2.  您*当前*的解析器实现不需要任何成员变量 - 因此，要实现您的接口，您不需要类。所以是的，取消你的静态方法。就像 Kevin 所说，使用带有普通旧函数（非静态）的命名空间是一个好主意。

3.  如果你觉得你需要添加一个需要维护内部状态的新解析器，那么你可能想在 (1) 中定义一个接口 - 一个普通的旧的公开可见的头文件，在你选择的命名空间内带有函数声明就足够了.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T23:57:46.057

一个只有静态函数的类在我看来与命名空间没有什么区别。那么，为什么不直接使用命名空间呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:26:59.513

决定这个问题的方法是如何使用这些功能？

1）如果所有函数都在一个文件中使用，不需要导出到任何地方，那么一定要使用静态函数。为什么？因为您可以直接将它们键入到 .cpp 文件中的类主体中，而不必担心维护声明和保持参数对齐。因为在解析 C++ 类时，会跳过类主体中定义的每个函数内的所有代码，然后在声明所有类成员后进行解析，因此函数都可以相互看到并且处于更好的名称情况。编译器如果您像这样直接在类中声明它们，还将内联许多较小的函数。

2) 如果需要从当前.cpp 文件之外使用函数，则使用普通函数。因为以后可以从其他任何地方使用它们，并且按名称导出它们更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T23:59:53.757

将实用程序函数设为静态是很常见的，因此，如果您的 Parser 类的函数不相互依赖，您完全可以将它们设为静态。如果它们相互依赖，并且可能以另一种方式完成相同的功能，则应考虑使用接口

# c# - C# 静态类和 is 运算符

> ID：14886220
> 
> 赞同：15
> 
> 时间：2013-02-14T23:55:32.423
> 
> 标签：c#

在最近重构了一些代码之后，其中涉及一些类重命名，我的一些代码以一种令人惊讶的方式破坏了。原因是失败的“is”运算符测试，我很惊讶不是编译器错误或警告。

这个完整的程序显示了这种情况：

```
static class ExtensionMethods {}

class Program {

    static void Main() {
        Test("Test");
    }

    public static bool Test(object obj)
    {
        return obj is ExtensionMethods;
    }
} 
```

鉴于 ExtensionMethods 是一个静态类，我本来希望“obj is ExtensionMethods”会发出某种警告。

例如，当被测对象永远不能是提供的类型时，编译器将为“is”运算符发出警告`((string)obj) is System.Uri`。

我是否忘记了这实际上是一个有意义的测试的场景？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T01:58:19.587

> 我很惊讶不是编译器错误或警告。

应该是的。这是一个疏忽。

有许多类似涉及静态类的错误。如果我没记错的话，Vladimir Reshetnikov 甚至发现了一些奇怪的场景，可以在其中进行类型推断，将静态类型推断为类型参数的绑定。

显然，我以前见过的这个，从来没有得到修复。为疏忽道歉。

> 我是否忘记了这实际上是一个有意义的测试的场景？

不。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T00:19:52.600

从 C# 3.0 规范，第 10.1.1.3 节：

> 静态类可能不包括基于类的规范（第 10.1.4 节），并且不能显式指定基类或已实现接口的列表。**静态类隐式继承自类型对象。**

因此，编译器显然不会发出警告，因为它不知道`is`将始终返回 false。（静态类“是” an `object`，因此编译器在编译时不知道`object`“is”或“is”不是静态类。）实际上它可能*确实*知道，或者至少*可以找出*，但显然它不专门研究这种情况并检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:19:43.783

我对此进行了破解，虽然我在 MSDN 参考中找不到它，但似乎 is 操作符依赖于实例化一个能够检查的类型。由于静态类不能被实例化（因为静态类是在编译时在程序堆栈上创建的对象）......

例如，如果您执行以下操作，则会收到以下错误：*“无法声明静态类型的变量”*

```
ExtensionMethods ex; 
```

如果您执行以下操作，您也不会收到以下错误：*“无法创建静态类的实例”*

```
ExtensionMethods ex2 = new ExtensionMethods(); 
```

为了演示这个问题，这里有一个完整的程序，显示了 is 运算符。

```
static class ExtensionMethods { }

// notice non-static
class AnotherNonStaticExtensionMethod { }

class Program
{
    static void Main(string[] args)
    {
        Debug.WriteLine(Test(new AnotherNonStaticExtensionMethod()).ToString());
        Debug.WriteLine(Test("Test").ToString());
        Debug.WriteLine(Test(4).ToString());
    }

    public static bool Test(object obj)
    {
        if (obj is ExtensionMethods)
        {
            return true;
        }
        else if (obj is AnotherNonStaticExtensionMethod)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

这是以下输出：

```
True
False
False 
```

is 对象能够使用第一条语句检查可实例化的类——因此让我相信 is 运算符依赖于它。我希望有人可以证实这一点？

> 由 NominSim 提供::
> 
> 从 C# 3.0 规范，第 10.1.1.3 节：
> 
> 静态类可能不包括基于类的规范（第 10.1.4 节），并且不能显式指定基类或已实现接口的列表。静态类隐式继承自类型对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-04T14:18:39.520

Eric Lippert 2013 年的回答解释说这是 Visual C# 5.0 编译器（以及一些早期版本）中的一个错误。`as`例如，操作员也存在问题`object bad = obj as ExtensionMethods;`。

在 C# 6.0（从 2015 年开始）及更高版本中，您确实会收到编译时错误（不仅仅是警告）：

> 错误 CS7023：“is”或“as”运算符的第二个操作数可能不是静态类型“Xxxx”

但是，仅当您指定功能 Strict 时才适用，[有关如何执行此操作的详细信息，请参阅另一个线程](https://stackoverflow.com/questions/37299549/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T00:46:44.917

根据 C# 语言规范：

> is 运算符用于动态检查对象的运行时类型是否与给定类型兼容。操作 E 的结果是 T，其中 E 是表达式，T 是类型，是一个布尔值，指示 E 是否可以通过引用转换、装箱转换或拆箱转换成功地转换为 T 类型。

和

> 静态类可能不包括基于类的规范（第 10.1.4 节），并且不能显式指定基类或已实现接口的列表。静态类隐式继承自类型对象。

由于它隐式继承自`System.Object`，因此编译器没有发出警告是有道理的。

确认：

```
var staticBaseType = typeof(B).BaseType; 
```

您将获得 a`System.Object`作为基本类型。

# javascript - 无需预加载的简单 JavaScript 幻灯片

> ID：14886222
> 
> 赞同：0
> 
> 时间：2013-02-14T23:55:48.117
> 
> 标签：javascript, html

我认为这是一个非常简单的问题，如果在其他地方得到回答，请原谅我。我看了看，但找不到我要找的东西。我对 JavaScript 的经验很少。

我在一个页面上包含了许多简单的 JavaScript 幻灯片，这些幻灯片通过鼠标单击前进。有关我正在使用的代码，请参见下面的代码，该代码是从介绍性 JS 站点之一中提取的。当用户访问页面时，这会预加载每个幻灯片中的每个图像。我希望脚本不预加载每个图像，而是仅在用户单击以推进幻灯片时才加载下一个图像。这是为了减少加载时间，因为大多数用户不会遇到大多数图像。有没有一种简单的方法可以将其转换为不预加载每个图像的东西？

```
<SCRIPT LANGUAGE="JavaScript">
var i=0
var imgs=["/a.jpeg","/b.jpeg","/c.jpeg","/d.jpeg","/e.jpeg"]
function slide(){ {i=i+1} {if (i==5) {i=0}} {document.img.src=imgs[i]} }
</SCRIPT> 
```

以及调用幻灯片时的代码：

```
<A HREF="JavaScript:slide()"><IMG SRC="/a.jpeg" NAME="img"></a> 
```

谢谢！- 帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:24:01.613

Using you images array,

```
var imgs = ["/a.jpeg","/b.jpeg","/c.jpeg","/d.jpeg","/e.jpeg"] 
```

You can do this:

```
function preloadImages(){
    for(var i=0 ; i<imgs.lenght ; i++) {
        img = new Image();
        img.src = "img/" + imglist[i];
    }
} 
```

This function will **preload** all those images, so when you do the `slide()` the images are in browser cache.

This method doesn't work in all browsers, so when I need to do this trick, I also use a `div` with the size of 1x1 pixel (positioned outside the view) with all the images, like this:

```
<div>
    <img src="/a.jpeg" />
    <img src="/b.jpeg" />
    ...
</div> 
```

This will also load all the images as soon as possible...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:01:08.840

图像一旦`src`设置了属性就会开始加载，除非（非官方）元素的 css`display`属性设置为`none`.

因此，只要您不设置`img`元素或 JS`Image`对象的来源，就像您发布的代码中的情况一样，图像将不会开始加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:59:43.240

啊，谢谢大家的回复。他们把我引向了我的答案，这只是我犯了一个非常愚蠢的错误。我误解了我网站分析测试的结果，这似乎表明所有图像都被下载到缓存中。这只是对结果的愚蠢误读，导致我陷入了疯狂的追逐，这是由于我缺乏对 JavaScript 的理解。回到测试这里回复后才意识到。这一切都按照我的预期进行，只需稍作调整。谢谢！

# sql - 在行数之间提取

> ID：14886223
> 
> 赞同：0
> 
> 时间：2013-02-14T23:55:50.980
> 
> 标签：sql, ms-access

如何使以下语句将第 100 行提取到第 200 行：

```
SELECT Offices.OfficeID, ContractsBooksCommodities.CommodityID
  FROM ((((Offices 
    INNER JOIN tbl_Sales ON Offices.CompanyID = tbl_Sales.CompanyID) 
    INNER JOIN ContractBooks ON tbl_Sales.CompanyID = ContractBooks.CompanyID)      
    INNER JOIN ContractsBooksAds ON ContractBooks.ContractNum = ContractsBooksAds.ContractNum) 
    INNER JOIN ContractsBooksBrands ON ContractsBooksAds.ContractNum = ContractsBooksBrands.ContractNum) 
    INNER JOIN ContractsBooksCommodities ON ContractsBooksBrands.ContractNum = ContractsBooksCommodities.ContractNum; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:12:05.273

这可能很慢：

```
SELECT Top 101 Offices.OfficeID, ContractsBooksCommodities.CommodityID
  FROM ((((Offices 
    INNER JOIN tbl_Sales ON Offices.CompanyID = tbl_Sales.CompanyID) 
    INNER JOIN ContractBooks ON tbl_Sales.CompanyID = ContractBooks.CompanyID)      
    INNER JOIN ContractsBooksAds ON ContractBooks.ContractNum = ContractsBooksAds.ContractNum) 
    INNER JOIN ContractsBooksBrands ON ContractsBooksAds.ContractNum = ContractsBooksBrands.ContractNum) 
    INNER JOIN ContractsBooksCommodities ON ContractsBooksBrands.ContractNum = ContractsBooksCommodities.ContractNum
WHERE Offices.OfficeID NOT IN (SELECT Top 99 Offices.OfficeID
  FROM ((((Offices 
    INNER JOIN tbl_Sales ON Offices.CompanyID = tbl_Sales.CompanyID) 
    INNER JOIN ContractBooks ON tbl_Sales.CompanyID = ContractBooks.CompanyID)      
    INNER JOIN ContractsBooksAds ON ContractBooks.ContractNum = ContractsBooksAds.ContractNum) 
    INNER JOIN ContractsBooksBrands ON ContractsBooksAds.ContractNum = ContractsBooksBrands.ContractNum) 
    INNER JOIN ContractsBooksCommodities ON ContractsBooksBrands.ContractNum = ContractsBooksCommodities.ContractNum
ORDER BY Offices.OfficeID, ContractsBooksCommodities.CommodityID) 
ORDER BY Offices.OfficeID, ContractsBooksCommodities.CommodityID 
```

我不知道哪些字段使您的排序独一无二，但这正是您所需要的，因为 MS Access 将返回匹配项。

# ruby-on-rails - 如何在 Bootstrap 手风琴之外调整 div

> ID：14886230
> 
> 赞同：0
> 
> 时间：2013-02-14T23:56:43.337
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在使用 Bootstrap 手风琴，我喜欢它在[这个例子](http://twitter.github.com/bootstrap/javascript.html#collapse)中的工作方式。但是，我希望能够在该手风琴之外切换一个附加部分。

有什么快速的技巧还是我应该尝试开发自己的小部件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:19:04.213

不确定引导手风琴，但您可以添加一些简单的 jQuery：

```
$(".accordion-toggle").on(click, function() {
  $(".other-section").toggle();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T01:25:24.657

诀窍是引导事件挂钩

“Bootstrap 的折叠类公开了一些用于挂钩折叠功能的事件。”

```
$('#myCollapsible').on('hidden', function () {
  // do something…
}) 
```

在此处查看文档： [twitter bootstrap collapse](http://twitter.github.com/bootstrap/javascript.html#collapse)

# java - 摇摆动画运行极慢

> ID：14886232
> 
> 赞同：4
> 
> 时间：2013-02-14T23:56:59.160
> 
> 标签：java, multithreading, performance, swing, optimization

我当前使用 Java Swing 运行的动画存在问题。这是一个离散事件模拟，基于文本的模拟工作正常，我只是在将模拟连接到 GUI 输出时遇到问题。

在本例中，我将模拟 10 辆汽车。`JPanels`我将在稍后详细说明这些汽车。

因此，考虑事件 process_car_arrival。每次计划执行此事件时，我都会在我的类中添加一个`Car`对象。该类具有以下相关属性：`ArrayList``cars``Model``Car`

```
Point currentPos; // The current position, initialized in another method when knowing route.
double speed; // giving the speed any value still causes the same problem but I have 5 atm.
RouteType route; // for this example I only consider one simple route 
```

此外，它还有以下方法`move()`：

```
switch (this.route) {
    case EAST:
        this.currentPos.x -= speed; 
        return this.currentPos;
.
.
.
//only above is relevant in this example 
```

这一切都很好。所以理论上汽车沿着一条从东到西的笔直的道路行驶，因为我只是`move()`为每辆要移动的汽车调用该方法。

返回到 process_car_arrival 事件。添加 Car 对象后，它会调用类`addCarToEast()`中的方法`View`。这在从东到西的道路起点处添加了一个 JPanel。

现在去`View`上课，我有一个**单独的**线程，它执行以下操作（run() 方法）：

```
@Override
    public void run() {
        while (true) {
            try {
                Thread.sleep(30);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            if (!cars.isEmpty()) {

                cars.get(i).setLocation(
                        new Point(getModel.getCars().get(i).move()));

                if (i == cars.size() - 1) {
                    i = 0;
                } else {
                    i++;
                }
            }
        }
    } 
```

上面确实首先将汽车从东向西平稳地移动。但是在有 3-4 辆车移动后，它最终变得非常缓慢，而当我有 10 辆汽车移动时，它最终移动得很少。

澄清一下，目前`Model`类中有一个`ArrayList`对象`Car`，并且`View`类中还有一个表示汽车`ArrayList`的对象。`JPanel`我正在尝试将`Car`对象与匹配`JPanels`，但我显然在做一项疯狂的工作。

我怀疑我在做一些非常低效的事情，但我不知道是什么。我最初认为它可能正在访问`ArrayList`这么多，我想这会使它变得非常慢。

任何指向我可以更改以使其顺利运行的指针？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T02:22:13.147

基于这个先前的[答案](https://stackoverflow.com/a/5617957/230513)，下面的例子模拟了一个由三辆出租车组成的车队在一个矩形网格上随机移动。A`javax.swing.Timer`以 5 Hz 的频率驱动动画。模型和视图在 中紧密耦合`CabPanel`，但动画可能会提供一些有用的见解。特别是，您可能会增加出租车数量或降低计时器延迟。

![图片](../Images/c2f96646818b3025174083b31f738363.png)

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.Point;
import java.awt.RenderingHints;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.Timer;

/**
 * @see https://stackoverflow.com/a/14887457/230513
 * @see https://stackoverflow.com/questions/5617027
 */

public class FleetPanel extends JPanel {

    private static final Random random = new Random();
    private final MapPanel map = new MapPanel();
    private final JPanel control = new JPanel();
    private final List<CabPanel> fleet = new ArrayList<CabPanel>();
    private final Timer timer = new Timer(200, null);

    public FleetPanel() {
        super(new BorderLayout());
        fleet.add(new CabPanel("Cab #1", Hue.Cyan));
        fleet.add(new CabPanel("Cab #2", Hue.Magenta));
        fleet.add(new CabPanel("Cab #3", Hue.Yellow));
        control.setLayout(new GridLayout(0, 1));
        for (CabPanel cp : fleet) {
            control.add(cp);
            timer.addActionListener(cp.listener);
        }
        this.add(map, BorderLayout.CENTER);
        this.add(control, BorderLayout.SOUTH);
    }

    public void start() {
        timer.start();
    }

    private class CabPanel extends JPanel {

        private static final String format = "000000";
        private final DecimalFormat df = new DecimalFormat(format);
        private JLabel name = new JLabel("", JLabel.CENTER);
        private Point point = new Point();
        private JLabel position = new JLabel(toString(point), JLabel.CENTER);
        private int blocks;
        private JLabel odometer = new JLabel(df.format(0), JLabel.CENTER);
        private final JComboBox colorBox = new JComboBox();
        private final JButton reset = new JButton("Reset");
        private final ActionListener listener = new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                int ds = random.nextInt(3) - 1;
                if (random.nextBoolean()) {
                    point.x += ds;
                } else {
                    point.y += ds;
                }
                blocks += Math.abs(ds);
                update();
            }
        };

        public CabPanel(String s, Hue hue) {
            super(new GridLayout(1, 0));
            name.setText(s);
            this.setBackground(hue.getColor());
            this.add(map, BorderLayout.CENTER);
            for (Hue h : Hue.values()) {
                colorBox.addItem(h);
            }
            colorBox.setSelectedIndex(hue.ordinal());
            colorBox.addActionListener(new ActionListener() {

                @Override
                public void actionPerformed(ActionEvent e) {
                    Hue h = (Hue) colorBox.getSelectedItem();
                    CabPanel.this.setBackground(h.getColor());
                    update();
                }
            });
            reset.addActionListener(new ActionListener() {

                @Override
                public void actionPerformed(ActionEvent e) {
                    point.setLocation(0, 0);
                    blocks = 0;
                    update();
                }
            });
            this.add(name);
            this.add(odometer);
            this.add(position);
            this.add(colorBox);
            this.add(reset);
        }

        private void update() {
            position.setText(CabPanel.this.toString(point));
            odometer.setText(df.format(blocks));
            map.repaint();
        }

        private String toString(Point p) {
            StringBuilder sb = new StringBuilder();
            sb.append(Math.abs(p.x));
            sb.append(p.x < 0 ? " W" : " E");
            sb.append(", ");
            sb.append(Math.abs(p.y));
            sb.append(p.y < 0 ? " N" : " S");
            return sb.toString();
        }
    }

    private class MapPanel extends JPanel {

        private static final int SIZE = 16;

        public MapPanel() {
            this.setPreferredSize(new Dimension(32 * SIZE, 32 * SIZE));
            this.setBackground(Color.lightGray);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g;
            g2d.setRenderingHint(
                RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
            int w = this.getWidth();
            int h = this.getHeight();
            g2d.setColor(Color.gray);
            for (int col = SIZE; col <= w; col += SIZE) {
                g2d.drawLine(col, 0, col, h);
            }
            for (int row = SIZE; row <= h; row += SIZE) {
                g2d.drawLine(0, row, w, row);
            }

            for (CabPanel cp : fleet) {
                Point p = cp.point;
                int x = SIZE * (p.x + w / 2 / SIZE) - SIZE / 2;
                int y = SIZE * (p.y + h / 2 / SIZE) - SIZE / 2;
                g2d.setColor(cp.getBackground());
                g2d.fillOval(x, y, SIZE, SIZE);
            }
        }
    }

    public enum Hue {

        Cyan(Color.cyan), Magenta(Color.magenta), Yellow(Color.yellow),
        Red(Color.red), Green(Color.green), Blue(Color.blue),
        Orange(Color.orange), Pink(Color.pink);
        private final Color color;

        private Hue(Color color) {
            this.color = color;
        }

        public Color getColor() {
            return color;
        }
    }

    private static void display() {
        JFrame f = new JFrame("Dispatch");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        FleetPanel fp = new FleetPanel();
        f.add(fp);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
        fp.start();
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                display();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T19:45:11.530

我无法抗拒...

![在此处输入图像描述](../Images/c6b1ac9cc1a37a2e2abce14dc7f8553a.png)

我在屏幕上运行了 500 辆汽车，几乎没有减速（这不是最快的……大约 200-300 还不错……

这使用面板来表示每辆车。如果您想获得更好的性能，您可能需要考虑使用某种后备缓冲区。

```
public class TestAnimation10 {

    public static void main(String[] args) {
        new TestAnimation10();
    }

    public TestAnimation10() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                final TrackPane trackPane = new TrackPane();
                JSlider slider = new JSlider(1, 500);
                slider.addChangeListener(new ChangeListener() {
                    @Override
                    public void stateChanged(ChangeEvent e) {
                        trackPane.setCongestion(((JSlider)e.getSource()).getValue());
                    }
                });
                slider.setValue(5);

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(trackPane);
                frame.add(slider, BorderLayout.SOUTH);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class TrackPane extends JPanel {

        private List<Car> cars;
        private int maxCars = 1;

        private List<Point2D[]> points;

        private Ellipse2D areaOfEffect;

        public TrackPane() {

            points = new ArrayList<>(25);

            cars = new ArrayList<>(25);
            setLayout(null);

            Timer timer = new Timer(40, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {

                    Rectangle bounds = areaOfEffect.getBounds();
                    List<Car> tmp = new ArrayList<>(cars);
                    for (Car car : tmp) {
                        car.move();
                        if (!bounds.intersects(car.getBounds())) {
                            remove(car);
                            cars.remove(car);
                        }
                    }
                    updatePool();
                    repaint();
                }
            });

            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();

            updateAreaOfEffect();
        }

        protected void updateAreaOfEffect() {
            double radius = Math.max(getWidth(), getHeight()) * 1.5d;
            double x = (getWidth() - radius) / 2d;
            double y = (getHeight() - radius) / 2d;
            areaOfEffect = new Ellipse2D.Double(x, y, radius, radius);
        }

        @Override
        public void invalidate() {
            super.invalidate();
            updateAreaOfEffect();
        }

        protected void updatePool() {
            while (cars.size() < maxCars) {
//            if (cars.size() < maxCars) {
                Car car = new Car();
                double direction = car.getDirection();
                double startAngle = direction - 180;

                double radius = areaOfEffect.getWidth();
                Point2D startPoint = getPointAt(radius, startAngle);

                int cx = getWidth() / 2;
                int cy = getHeight() / 2;

                double x = cx + (startPoint.getX() - car.getWidth() / 2);
                double y = cy + (startPoint.getY() - car.getHeight() / 2);
                car.setLocation((int)x, (int)y);

                Point2D targetPoint = getPointAt(radius, direction);

                points.add(new Point2D[]{startPoint, targetPoint});

                add(car);

                cars.add(car);
            }
        }

        @Override
        public void paint(Graphics g) {
            super.paint(g);
            Font font = g.getFont();
            font = font.deriveFont(Font.BOLD, 48f);
            FontMetrics fm = g.getFontMetrics(font);
            g.setFont(font);
            g.setColor(Color.RED);
            String text = Integer.toString(maxCars);
            int x = getWidth() - fm.stringWidth(text);
            int y = getHeight() - fm.getHeight() + fm.getAscent();
            g.drawString(text, x, y);
            text = Integer.toString(getComponentCount());
            x = getWidth() - fm.stringWidth(text);
            y -= fm.getHeight();
            g.drawString(text, x, y);
            text = Integer.toString(cars.size());
            x = getWidth() - fm.stringWidth(text);
            y -= fm.getHeight();
            g.drawString(text, x, y);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        public void setCongestion(int value) {
            maxCars = value;
        }
    }

    protected static Point2D getPointAt(double radius, double angle) {

        double x = Math.round(radius / 2d);
        double y = Math.round(radius / 2d);

        double rads = Math.toRadians(-angle);

        double fullLength = Math.round((radius / 2d));

        double xPosy = (Math.cos(rads) * fullLength);
        double yPosy = (Math.sin(rads) * fullLength);

        return new Point2D.Double(xPosy, yPosy);

    }

    public class Car extends JPanel {

        private double direction;
        private double speed;
        private BufferedImage background;

        public Car() {
            setOpaque(false);
            direction = Math.random() * 360;
            speed = 5 + (Math.random() * 10);
            int image = 1 + (int) Math.round(Math.random() * 5);
            try {
                String name = "/Car0" + image + ".png";
                background = ImageIO.read(getClass().getResource(name));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            setSize(getPreferredSize());
//            setBorder(new LineBorder(Color.RED));
        }

        public void setDirection(double direction) {
            this.direction = direction;
            revalidate();
            repaint();
        }

        public double getDirection() {
            return direction;
        }

        public void move() {
            Point at = getLocation();
            at.x += (int)(speed * Math.cos(Math.toRadians(-direction)));
            at.y += (int)(speed * Math.sin(Math.toRadians(-direction)));
            setLocation(at);
        }

        @Override
        public Dimension getPreferredSize() {
            Dimension size = super.getPreferredSize();
            if (background != null) {
                double radian = Math.toRadians(direction);
                double sin = Math.abs(Math.sin(radian)), cos = Math.abs(Math.cos(radian));
                int w = background.getWidth(), h = background.getHeight();
                int neww = (int) Math.floor(w * cos + h * sin);
                int newh = (int) Math.floor(h * cos + w * sin);
                size = new Dimension(neww, newh);
            }
            return size;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            int x = (getWidth() - background.getWidth()) / 2;
            int y = (getHeight() - background.getHeight()) / 2;
            g2d.rotate(Math.toRadians(-(direction + 180)), getWidth() / 2, getHeight() / 2);
            g2d.drawImage(background, x, y, this);
            g2d.dispose();

//            Debug graphics...
//            int cx = getWidth() / 2;
//            int cy = getHeight() / 2;
//
//            g2d = (Graphics2D) g.create();
//            g2d.setColor(Color.BLUE);
//            double radius = Math.min(getWidth(), getHeight());
//            Point2D pointAt = getPointAt(radius, direction);
//            g2d.draw(new Ellipse2D.Double(cx - (radius / 2d), cy - (radius / 2d), radius, radius));
//            
//            double xo = cx;
//            double yo = cy;
//            double xPos = cx + pointAt.getX();
//            double yPos = cy + pointAt.getY();
//            
//            g2d.draw(new Line2D.Double(xo, yo, xPos, yPos));
//            g2d.draw(new Ellipse2D.Double(xPos - 2, yPos - 2, 4, 4));
//            g2d.dispose();
        }
    }
} 
```

**更新了优化版本**

我对汽车对象的创建进行了一些代码优化（仍有改进的空间）并增强了图形输出（使它看起来更好）。

基本上，现在，当汽车离开屏幕时，它会被放置在池中。当需要另一辆车时，如果可能，将其从池中拉出，否则将制造一辆新车。这减少了创建和销毁这么多（相对）短期对象的开销，这使得内存使用更加稳定。

在我的 2560x1600 分辨率屏幕（最大化运行）上，我能够让 4500 辆汽车同时运行。一旦减少了对象创建，它就会相对平稳地运行（它永远不会像 10 一样运行，但它并没有受到速度显着降低的影响）。

```
public class TestAnimation10 {

    public static void main(String[] args) {
        new TestAnimation10();
    }

    public TestAnimation10() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                final TrackPane trackPane = new TrackPane();
                JSlider slider = new JSlider(1, 5000);
                slider.addChangeListener(new ChangeListener() {
                    @Override
                    public void stateChanged(ChangeEvent e) {
                        trackPane.setCongestion(((JSlider) e.getSource()).getValue());
                    }
                });
                slider.setValue(5);

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(trackPane);
                frame.add(slider, BorderLayout.SOUTH);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class TrackPane extends JPanel {

        private List<Car> activeCarList;
        private List<Car> carPool;
        private int maxCars = 1;
        private List<Point2D[]> points;
        private Ellipse2D areaOfEffect;

        public TrackPane() {

            points = new ArrayList<>(25);

            activeCarList = new ArrayList<>(25);
            carPool = new ArrayList<>(25);
            setLayout(null);

            Timer timer = new Timer(40, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {

                    Rectangle bounds = areaOfEffect.getBounds();
                    List<Car> tmp = new ArrayList<>(activeCarList);
                    for (Car car : tmp) {
                        car.move();
                        if (!bounds.intersects(car.getBounds())) {
                            remove(car);
                            activeCarList.remove(car);
                            carPool.add(car);
                        }
                    }
                    updatePool();
                    repaint();
                }
            });

            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();

            updateAreaOfEffect();
        }

        protected void updateAreaOfEffect() {
            double radius = Math.max(getWidth(), getHeight()) * 1.5d;
            double x = (getWidth() - radius) / 2d;
            double y = (getHeight() - radius) / 2d;
            areaOfEffect = new Ellipse2D.Double(x, y, radius, radius);
        }

        @Override
        public void invalidate() {
//            super.invalidate();
            updateAreaOfEffect();
        }

        protected void updatePool() {
            if (activeCarList.size() < maxCars) {
                int count = Math.min(maxCars - activeCarList.size(), 10);
                for (int index = 0; index < count; index++) {
                    Car car = null;

                    if (carPool.isEmpty()) {
                        car = new Car();
                    } else {
                        car = carPool.remove(0);
                    }

                    double direction = car.getDirection();
                    double startAngle = direction - 180;

                    double radius = areaOfEffect.getWidth();
                    Point2D startPoint = getPointAt(radius, startAngle);

                    int cx = getWidth() / 2;
                    int cy = getHeight() / 2;

                    double x = cx + (startPoint.getX() - car.getWidth() / 2);
                    double y = cy + (startPoint.getY() - car.getHeight() / 2);
                    car.setLocation((int) x, (int) y);

                    Point2D targetPoint = getPointAt(radius, direction);

                    points.add(new Point2D[]{startPoint, targetPoint});

                    add(car);

                    activeCarList.add(car);
                }
            }
        }

        @Override
        public void paint(Graphics g) {
            super.paint(g);
            Font font = g.getFont();
            font = font.deriveFont(Font.BOLD, 48f);
            FontMetrics fm = g.getFontMetrics(font);
            g.setFont(font);
            g.setColor(Color.RED);
            String text = Integer.toString(maxCars);
            int x = getWidth() - fm.stringWidth(text);
            int y = getHeight() - fm.getHeight() + fm.getAscent();
            g.drawString(text, x, y);
            text = Integer.toString(getComponentCount());
            x = getWidth() - fm.stringWidth(text);
            y -= fm.getHeight();
            g.drawString(text, x, y);
            text = Integer.toString(activeCarList.size());
            x = getWidth() - fm.stringWidth(text);
            y -= fm.getHeight();
            g.drawString(text, x, y);
            text = Integer.toString(carPool.size());
            x = getWidth() - fm.stringWidth(text);
            y -= fm.getHeight();
            g.drawString(text, x, y);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        public void setCongestion(int value) {
            maxCars = value;
        }

        @Override
        public void validate() {
        }

        @Override
        public void revalidate() {
        }

//        @Override
//        public void repaint(long tm, int x, int y, int width, int height) {
//        }
//
//        @Override
//        public void repaint(Rectangle r) {
//        }
//        public void repaint() {
//        }
        @Override
        protected void firePropertyChange(String propertyName, Object oldValue, Object newValue) {
            System.out.println(propertyName);
//            // Strings get interned...
//            if (propertyName == "text"
//                            || propertyName == "labelFor"
//                            || propertyName == "displayedMnemonic"
//                            || ((propertyName == "font" || propertyName == "foreground")
//                            && oldValue != newValue
//                            && getClientProperty(javax.swing.plaf.basic.BasicHTML.propertyKey) != null)) {
//
//                super.firePropertyChange(propertyName, oldValue, newValue);
//            }
        }

        @Override
        public void firePropertyChange(String propertyName, boolean oldValue, boolean newValue) {
        }
    }

    protected static Point2D getPointAt(double radius, double angle) {

        double x = Math.round(radius / 2d);
        double y = Math.round(radius / 2d);

        double rads = Math.toRadians(-angle);

        double fullLength = Math.round((radius / 2d));

        double xPosy = (Math.cos(rads) * fullLength);
        double yPosy = (Math.sin(rads) * fullLength);

        return new Point2D.Double(xPosy, yPosy);

    }

    public class Car extends JPanel {

        private double direction;
        private double speed;
        private BufferedImage background;

        public Car() {
            setOpaque(false);
            direction = Math.random() * 360;
            speed = 5 + (Math.random() * 10);
            int image = 1 + (int) Math.round(Math.random() * 5);
            try {
                String name = "/Car0" + image + ".png";
                background = ImageIO.read(getClass().getResource(name));
            } catch (IOException ex) {
                ex.printStackTrace();
            }
            setSize(getPreferredSize());
//            setBorder(new LineBorder(Color.RED));
        }

        public void setDirection(double direction) {
            this.direction = direction;
            revalidate();
            repaint();
        }

        public double getDirection() {
            return direction;
        }

        public void move() {
            Point at = getLocation();
            at.x += (int) (speed * Math.cos(Math.toRadians(-direction)));
            at.y += (int) (speed * Math.sin(Math.toRadians(-direction)));
            setLocation(at);
        }

        @Override
        public Dimension getPreferredSize() {
            Dimension size = super.getPreferredSize();
            if (background != null) {
                double radian = Math.toRadians(direction);
                double sin = Math.abs(Math.sin(radian)), cos = Math.abs(Math.cos(radian));
                int w = background.getWidth(), h = background.getHeight();
                int neww = (int) Math.floor(w * cos + h * sin);
                int newh = (int) Math.floor(h * cos + w * sin);
                size = new Dimension(neww, newh);
            }
            return size;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_ALPHA_INTERPOLATION, RenderingHints.VALUE_ALPHA_INTERPOLATION_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_COLOR_RENDERING, RenderingHints.VALUE_COLOR_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE);
            g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
            g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL, RenderingHints.VALUE_STROKE_PURE);
            int x = (getWidth() - background.getWidth()) / 2;
            int y = (getHeight() - background.getHeight()) / 2;
            g2d.rotate(Math.toRadians(-(direction + 180)), getWidth() / 2, getHeight() / 2);
            g2d.drawImage(background, x, y, this);
            g2d.dispose();

//            Debug graphics...
//            int cx = getWidth() / 2;
//            int cy = getHeight() / 2;
//
//            g2d = (Graphics2D) g.create();
//            g2d.setColor(Color.BLUE);
//            double radius = Math.min(getWidth(), getHeight());
//            Point2D pointAt = getPointAt(radius, direction);
//            g2d.draw(new Ellipse2D.Double(cx - (radius / 2d), cy - (radius / 2d), radius, radius));
//            
//            double xo = cx;
//            double yo = cy;
//            double xPos = cx + pointAt.getX();
//            double yPos = cy + pointAt.getY();
//            
//            g2d.draw(new Line2D.Double(xo, yo, xPos, yPos));
//            g2d.draw(new Ellipse2D.Double(xPos - 2, yPos - 2, 4, 4));
//            g2d.dispose();
        }

        @Override
        public void invalidate() {
        }

        @Override
        public void validate() {
        }

        @Override
        public void revalidate() {
        }

        @Override
        public void repaint(long tm, int x, int y, int width, int height) {
        }

        @Override
        public void repaint(Rectangle r) {
        }

        @Override
        public void repaint() {
        }

        @Override
        protected void firePropertyChange(String propertyName, Object oldValue, Object newValue) {
//            System.out.println(propertyName);
//            // Strings get interned...
//            if (propertyName == "text"
//                            || propertyName == "labelFor"
//                            || propertyName == "displayedMnemonic"
//                            || ((propertyName == "font" || propertyName == "foreground")
//                            && oldValue != newValue
//                            && getClientProperty(javax.swing.plaf.basic.BasicHTML.propertyKey) != null)) {
//
//                super.firePropertyChange(propertyName, oldValue, newValue);
//            }
        }

        @Override
        public void firePropertyChange(String propertyName, boolean oldValue, boolean newValue) {
        }
    }
} 
```

ps - 我应该添加 1- 我 10 个月大的孩子喜欢它 2- 它让我想起了奔跑的工作：P

# javascript - 利用引导轮播“幻灯片”事件和 .next 类

> ID：14886233
> 
> 赞同：9
> 
> 时间：2013-02-14T23:57:04.650
> 
> 标签：javascript, jquery, html, twitter-bootstrap, carousel

所以我遇到了一个小问题（类似于我前几天发布的这个：http: [//bit.ly/11JpbdY](http://bit.ly/11JpbdY)），在加载时隐藏的一段内容上使用 SlabText。这一次，我试图让slabText 更新滑块中某些内容的显示（使用Twitter Bootstrap 的Carousel 插件）。

根据 Bootstrap 的 Carousel 插件的 Twitter 文档（[http://twitter.github.com/bootstrap/javascript.html#carousel](http://twitter.github.com/bootstrap/javascript.html#carousel)），我正在尝试使用`slide`事件，以便我重新调用 SlabText 以使其正确显示。

使用开发人员工具，我可以看到 Carousel在处理一个元素到下一个元素`.next`的幻灯片时添加了一个类。`.item`然后在`.active`转移类之前将其删除。

我可以毫无问题地访问“幻灯片”事件，但试图抓住`.next`元素被证明很麻烦。**到目前为止，这是我的代码的 JSFiddle：http: [//jsfiddle.net/peHDQ/](http://jsfiddle.net/peHDQ/)**

**简单地说我的问题；我应该如何正确使用`slide`事件来触发功能？**

请让我知道是否有任何其他信息有用。

* * *

**进一步说明：**

由于我一直无法掌握`.next`课程，因此我正在尝试使用一些 jQuery 来做到这一点。到目前为止，这是我的代码：

```
$('.carousel').carousel({
    interval: 5000
}).on('slide', function (e) {
    $(this).find('.active').next().find('.slab').slabText();
}); 
```

据我了解，这应该是抓取每个`.slab`元素并触发 SlabText 插件......唉，我收到一个错误：

*“未捕获的类型错误：对象 [对象对象] 没有方法 'slabtext'”*

**谁能告诉我在这里做错了什么......？**我使用完全相同的过程来添加一个类，它工作正常（根据这个 JSFiddle：http: [//jsfiddle.net/peHDQ/2/](http://jsfiddle.net/peHDQ/2/)）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-20T18:39:06.237

我发现了问题。问题是在下一张幻灯片可见之前调用了事件“幻灯片”。我添加了一点延迟，现在它工作正常。试试这个：

```
 $('.carousel').carousel({
       interval: 5000
   }).on('slide', function (e) {
       var xx = $(this);
       setTimeout(function() {
           xx.find('.active').next().find('.slab').slabText();
       } , 0);
   }); 
```

# zip - 在 Marklogic (5.x) 中，如何在压缩文档中包含 doctype 声明？

> ID：14886242
> 
> 赞同：1
> 
> 时间：2013-02-14T23:57:42.247
> 
> 标签：zip, doctype, output, marklogic

我有一个文档，我遍历一个`xslt`然后捕获到一个变量中，例如 $doc。

设置了必要的`xslt`输出选项，以便我可以`docytpe`在文档中获取我的声明序言，并且当我`xdmp:save`使用 $doc 进行操作时，在保存选项节点中重复输出设置（但这是必要的吗？），我很高兴得到我的`doctype`声明，如我的`<xsl:output/>`选项中指定的那样。

但是，我想将与其他二进制文档放在一起的文档压缩并保存。

但压缩文件中不包含我的`doctype`声明。

我通过一个模块中的函数创建了 zip，该模块中的 xdmp:output 选项设置为`xslt`, 但是`MarkLogic/Xquery-style`. 我的 zip 函数是这样的：

```
`declare function p2n:bundle-document($basename as xs:string, $doc as document-node()) as binary()
{
  let $manifest := <parts xmlns="xdmp:zip">
                    {
                      <part>{$basename}</part>
                    }
                   </parts>
 let $zip       := xdmp:zip-create($manifest, $doc)
 return $zip  
};` 
```

无济于事，唉。当我终于打开拉链时，并没有`DOCTYPE`声明。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T07:42:57.923

您需要应用 xdmp:quote，并将结果包装在文本节点中以执行此操作，例如：

```
let $basename := "test.xml"
let $xsl :=
    <xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

        <xsl:output doctype-public="test" doctype-system="test"/>

        <xsl:template match="@*|node()">
            <xsl:copy-of select="."/>
        </xsl:template> 
    </xsl:stylesheet>

let $xml := <test/>
let $doc := text { xdmp:quote(xdmp:xslt-eval($xsl, $xml))}
let $manifest :=
    <parts xmlns="xdmp:zip">{
        <part>{$basename}</part>
    }</parts>
let $zip := xdmp:zip-create($manifest, $doc)
return
    xdmp:save("d:\tmp\test.zip", $zip) 
```

！

# c++ - 使用指针数组时程序“已停止工作”

> ID：14886245
> 
> 赞同：0
> 
> 时间：2013-02-14T23:57:48.707
> 
> 标签：c++, arrays, string, pointers

我正在尝试制作一个字符串数组，并将它们与链表连接起来。问题是我们只能使用数组。讲师说我们不能使用模板、矢量等。这些是我发现能够做到这一点的唯一方法。我认为这甚至不是一个链表，他希望我们的数组并行处理，而不是指向行中的下一个元素。

```
#include <iostream>
#include <string>

using namespace std;

int main ()
{
    string names [4] = {"Dick", "Harry", "Sam", "Tom"};
    string *nameptr[4];

    for(int x = 0; x < 4; x++)
    {
        *nameptr[x] = names[x];
        cout << nameptr[x] << "  ";
        cout << &nameptr[x] << endl;
    }
} 
```

这段代码有什么问题？我错过了什么？

我迷路了，如果有人能对此有所了解，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:01:46.140

您的问题不清楚，但要让您的代码运行。

尝试更新

```
*nameptr[x] = names[x]; 
```

至

```
nameptr[x] = &names[x]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T00:02:28.803

`string names[4] = {"Dick", "Harry", "Sam", "Tom"};`是一个`std::string`对象数组。是一个指向对象`string *nameptr[4];`的指针数组。`std::string`

要初始化指针，您需要分配它将指向它的地址：`nameptr[x] = &names[x];`

`*`当您想要访问指针指向的内存时，使用[取消引用运算符](http://en.wikipedia.org/wiki/Dereference_operator)( )。例如打印`nameptr[x]`指向的字符串：`std::cout << *nameptr[x];`

* * *

为什么你的程序“停止工作”的解释：你已经声明`string *nameptr[4];`了，即指针数组，但你没有初始化它。然后在你的循环中你试图做`*nameptr[x] = names[x];`，这意味着“获取对象并用它替换指向`names[x]`的对象”。`nameptr[x]`您正在取消引用尚未初始化的指针，这会导致**未定义的行为**

# python - 将嵌套循环中的字符串转换为浮点数

> ID：14886247
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:58:15.363
> 
> 标签：python, nested

这是我的代码我只需要将数字字符串转换为浮点数我有 aList= 列表列表

```
 def convertData(aList):
       for items in aList:
          for x in items:
             try:
               float(x)
             except ValueError:
               pass
       print (aList) 
```

这就是我的清单

```
 aList = [['Date', 'Assembly', 'Heat-treat', 'Painting', 'Inspection'], ['Monday',    '0.352', '0.92', '0.182', '0.255'], ['Tuesday', '0.438', '0.809', '0.155', '0.225'], ['Wednesday', '0.323', '0.9', '0.169', '0.236'], ['Thursday', '0.383', '0.841', '0.172', '0.238'], ['Friday', '0.355', '0.352', '0.177', '0.227']] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:04:09.417

```
def convertData(aList):
   for items in aList:
      for i,j in enumerate(items):
         try:
           items[i] = float(j)
         except ValueError:
           continue
   print (aList) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:04:17.747

```
def convertData(aList):
   lout = []
   for items in aList:
      itemsout = []
      for x in items:
         try:
           itemsout.append(float(x))
         except ValueError:
           itemsout.append(x)
      lout.append(itemsout)
   return lout 
```

# java - AES密文不同

> ID：14886250
> 
> 赞同：2
> 
> 时间：2013-02-14T23:58:19.113
> 
> 标签：java, android, cryptography, aes, bouncycastle

我在 Android 和 Java servlet 环境中使用 AES 加密和充气城堡实现。加密部分在这两种情况下都可以。但是，一旦我用相同的密钥加密相同的文本，我会在这两个平台上得到不同的结果。

我的意图是在 Android 中进行加密并在 Web 环境中进行解密。

这是我为 Android AES 实现所做的唯一更改。

```
 KeyGenerator kgen = KeyGenerator.getInstance("AES");
    SecureRandom sr = null;
    if (android.os.Build.VERSION.SDK_INT >= JELLY_BEAN_4_2) {
        sr = SecureRandom.getInstance("SHA1PRNG", "Crypto");
    } else {
        sr = SecureRandom.getInstance("SHA1PRNG");
    }
    sr.setSeed(key);
    kgen.init(128, sr);
    SecretKey skey = kgen.generateKey();
    byte[] raw = skey.getEncoded(); 
```

上面我只是将 Crypto 添加到 get 实例中。

我也使用了 spongy castle 实现来看看我是否可以做到这一点。它仍然给了我与 Android 相同的结果。不确定我是否已正确加载它。我在 API 级别 14 和 17 上对此进行了测试。

这会导致 javax.crypto.BadPaddingException: pad block损坏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T08:10:41.270

对于引用此线程的任何人，这是我对代码所做的更改。现在它在 Android 和服务器环境中运行良好。

答案来自，

[Android 4.2 破解了我的加密/解密代码并且提供的解决方案不起作用](https://stackoverflow.com/questions/13433529/android-4-2-broke-my-encrypt-decrypt-code-and-the-provided-solutions-dont-work/13438590#13438590)

谢谢@kroot

```
 /* Store these things on disk used to derive key later: */
    int iterationCount = 1000;
    int saltLength = 32; // bytes; should be the same size as the output
                            // (256 / 8 = 32)
    int keyLength = 256; // 256-bits for AES-256, 128-bits for AES-128, etc
    byte[] salt = new byte[saltLength]; // Should be of saltLength

    /* When first creating the key, obtain a salt with this: */
    SecureRandom random = new SecureRandom();
    random.nextBytes(salt);

    /* Use this to derive the key from the password: */
    KeySpec keySpec = new PBEKeySpec(new String(key,
            Constants.CHAR_ENCODING).toCharArray(), key, iterationCount,
            keyLength);
    SecretKeyFactory keyFactory = SecretKeyFactory
            .getInstance("PBEWithSHA256And256BitAES-CBC-BC");
    byte[] keyBytes = keyFactory.generateSecret(keySpec).getEncoded();
    SecretKey secretKey = new SecretKeySpec(keyBytes, "AES");

    return secretKey.getEncoded(); 
```

# javascript - 为什么这个 javascript 这么慢？仅仅是因为滞后吗？

> ID：14886254
> 
> 赞同：2
> 
> 时间：2013-02-14T23:58:46.203
> 
> 标签：javascript, jquery, client-side

好心看看[http://www.jhurleydesign.com/uniquerandom/](http://www.jhurleydesign.com/uniquerandom/)

基本上，我创建的是一个随机将那些白色星星变成绿色的脚本。它的工作原理是生成*唯一的*随机数，并使用每个数字作为 eq 选择器来应用“绿色”类。

在我运行这段代码之前，我假设星星变绿的速度会*增加*，因为潜在的 eq 选择器的数量越来越少。（还记得我说过它们是生成的唯一数字吗？”

然而，相反的情况发生了。正如您在访问该链接时所看到的，星星相对较快地变为绿色，但接近尾声时，脚本开始变得如此、如此、如此缓慢。在我的机器上，最后一颗星需要大约 3 分钟才能变为绿色！

这是落后的原因吗？如果是这样，我怎么能绕过它？这个脚本做了一些非常非常简单的事情，所以我怀疑延迟在这里是一个游戏停止器。我想我刚刚犯了一个愚蠢的错误！

[您可以从http://www.jhurleydesign.com/uniquerandom/](http://www.jhurleydesign.com/uniquerandom/)复制并粘贴源代码（全部在一个页面上），但它也在下面发布：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Greenstars</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function () {
    var limit = $('span'),
        unr = [];
    setInterval(function () {
        {
            var random_number = Math.round(Math.random() * limit.length);
            if (unr.indexOf(random_number) == -1) {
                unr.push(random_number);
                limit.eq(random_number).addClass('green');
                if (limit.length < unr.length) {
                    alert('Finished!');
                };
            }
        }
    }, 0);
});
</script>
<style>
.green {
    color: #0F0;
}
#container {
    background-color: #000;
    color: #FFF;
}
</style>
<div id="container">
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
<span>*</span>
</div> 
```

谢谢你的时间！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T00:02:53.710

它会变得越来越慢，因为您正在为整个对象集生成一个随机数，但要测试已经完成的对象。所以，一旦只剩下几个，就需要大量的随机数才能找到一个还没有转过的。此外，搜索越来越长的已翻转项目数组也变得越来越慢，尽管随机数未命中可能是更大的问题。

最初创建一个包含所有星星的数组会好得多，当您转动一颗时，将其从该数组中删除。然后在缩短的数组上创建您的随机数。您不必检查它是否已经转动，并且您的星星会从头到尾以均匀的速度转动。

这是代码可以这样编写的一种方式：

```
// get array of DOM elements to operate on
var items = $('span').get();

var interval = setInterval(function() {
    var random_number = Math.floor(Math.random() * items.length);
    // add the class to the selected random item
    $(items[random_number]).addClass('green');

    // remove element we just processed from the array
    // so our random generator no longer includes it
    items.splice(random_number, 1);

    // if there are no more to do, stop the interval
    if (items.length === 0) {
        clearInterval(interval);
    }
}, 50); 
```

* * *

仅供参考，我还将计时器间隔更改为 50 毫秒，因为您可能想要一个可测量的动画效果，而不是尽可能快地翻转它们。您可以将该时间值调整为您想要的任何值。如果你想尽可能快地翻转它们，你会这样做：

```
$('span').addClass('green'); 
```

但是，我假设您实际上想要某种动画，它应该在间隔上设置更具体的测量时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-15T00:12:09.080

问题是您的功能正在执行此操作

```
do this over and over again forever {
  Generate a random number
  if (random number has not been checked before) {
    mark random number as checked
    make the span at this random index green
    if (all spans are green) {
      show a message "finished"
    }
  }
} 
```

因此，随着时间的推移，您的随机生成的数字以前找不到的可能性越来越小 - 因此它可以在找到一个之前多次运行该函数。

当它下降到 2 或 3 个剩余数字时，循环可能会运行很长时间，然后它会随机落在 2 个剩余数字之一上。

您需要重新制定您的算法 - 最好只是随机打乱您想要的每个数字的数组，然后按该顺序使星星变为绿色，但间隔固定的时间。

另一种可能的算法是从数组中删除您制作为绿色的星星，然后生成介于 1 之间的随机数 - 新长度（之前的长度减去 1）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T00:17:03.940

不要忽视所有关于如何提高效率的好建议，但为什么最后需要这么长时间只是一个概率问题。

我不知道屏幕上有多少*。假设是 1000，因为这是一个很简单的数字。在您的第一种情况下，您有 1000 分之 1000 的机会变成一个绿色。在你的第 500 次成功中，每次你想出一个数字时，你只有 1000 分之 500。在您第 900 次成功时，您只有千分之一的机会找到新的匹配项。在你的最后一个，你一直选择随机数，直到你的 1 千分之一的机会发生。

本质上，将值存储在数组中目前是没有用的，因为它不会影响您选择的下一个数字 - 它只会影响您是否将值变为绿色。在概率方面，这是“有替换的平局”，*而不是*“没有替换的平局”，正如你所期望的那样。你可以完全移除你的阵列，你只会将绿色的东西变回绿色，并且仍然等待很长时间，因为找到非绿色的几率正在减少。jfriend00 的答案是让您“无需更换即可绘图”-一旦您这样做，是的，它会加速到最后。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T00:02:17.710

问题是您将唯一的随机数存储在一个数组中并在该数组中进行线性搜索。

此外，您正在不断地执行您的功能`setInterval(..., 0)`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T00:05:28.073

试试这个方法。

1.  您所有的跨度最初都有“加载”类。<span **class="loading"** >*</span>
2.  每次运行时删除类
3.  选择随机项目和 removeClass 加载，并做任何你想做的事
4.  计算“加载”类还有多少剩余
5.  不要忘记 clearInterval 以防止它再次运行。

演示[http://jsfiddle.net/fedmich/QTy7G/](http://jsfiddle.net/fedmich/QTy7G/)

```
var objCont;
$(document).ready(function () {
    objCont = $('#container');

    function asteriks(){
        var items = objCont.find('.loading');
        if(items.length==0){
            //FINISHED
            alert('Finished!');

            clearInterval(interval_id);
            return false;
        }

       //pick random element, remove loading then addClass green
        var random = Math.round(Math.random()* items.length );
        items.eq(random).removeClass('loading').addClass('green');

    }
    var interval_id = setInterval( asteriks, 500);  
}); 
```

还有一些需要注意的事项：

1.  我将 $('#container') 存储到变量 objCont 中，以便 JQ 查询一次
2.  ClearInterval 所以函数完成
3.  我正在使用 500 毫秒，所以半秒。你真的需要它是 0 （从你的例子？）
4.  这里还有另一个可能的改进，它只使用removeClass **('loading')**而没有**AddClass('green')**技术，但这是另一个故事/案例

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T00:01:11.363

您已将间隔计时器设置为**0 毫秒之间的调用**。这意味着浏览器基本上将花费所有时间运行您的功能。你在期待什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-15T00:19:18.623

您已经从其中几篇文章中看到了您的方法似乎变慢的原因。这是一个相当线性的示例：**[jsFiddle example](http://jsfiddle.net/j08691/Gztup/1/)**。

它的工作原理是构建一个跨度元素的数组，然后随机选择一个并将其从数组中删除，本质上是缩小池（数组长度）以从每次中选择，直到长度为零。

```
var limit = $('span'),
    ary = [];
for (var i = 0; i <= limit.length; i++) ary.push(i);
function foo() {
    var random_number = Math.round(Math.random() * ary.length);
    limit.eq(ary[random_number]).addClass('green');
    ary.splice(random_number, 1);
    if (ary.length < 1) {
        alert('Finished!');
    } else {
        setTimeout(foo,5);   
    }
}
foo(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-15T00:33:46.337

我个人喜欢这种方法 - [http://jsfiddle.net/Y6xZG/2/](http://jsfiddle.net/Y6xZG/2/)

```
$(document).ready(function () {
    var limit = $('span').toArray();
    limit.sort( function() { return Math.random() > 0.5 } );

    var intv = setInterval(function () {
        if(!limit.length) {
            alert('Finished!');
            clearInterval(intv);
            return;
        }
        var $star = $(limit.pop());
        $star.addClass('green');
    }, 0);
}); 
```

# mysql - 如何按不同值的总和对查询进行排序？

> ID：14886255
> 
> 赞同：1
> 
> 时间：2013-02-14T23:58:48.907
> 
> 标签：mysql, sql

例如，如果我有一个名为 sales 的表，其中包含以下值：

```
╔════════╦═══════╗
║  ITEM  ║ SALES ║
╠════════╬═══════╣
║ record ║     4 ║
║ cd     ║     2 ║
║ cd     ║     5 ║
║ record ║     1 ║
╚════════╩═══════╝ 
```

我将如何编写查询以按不同项目的总和进行排序，以便我的输出为：

```
╔════════╦════════════╗
║  ITEM  ║ TOTALSALES ║
╠════════╬════════════╣
║ cd     ║          7 ║
║ record ║          5 ║
╚════════╩════════════╝ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T23:59:37.200

使用`GROUP BY`和`SUM()`

```
SELECT  item, SUM(sales) totalSales
FROM    sales
GROUP   BY item 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/d953c/1)

输出：

```
╔════════╦════════════╗
║  ITEM  ║ TOTALSALES ║
╠════════╬════════════╣
║ cd     ║          7 ║
║ record ║          5 ║
╚════════╩════════════╝ 
```

# c++ - 创建链接列表的问题

> ID：14886258
> 
> 赞同：0
> 
> 时间：2013-02-14T23:59:03.930
> 
> 标签：c++, class, pointers

首先，这是我的代码：

头文件的一部分：

```
struct polynomial
{ 
    polynomial();
    polynomial(string newCoefficient, string newPower, polynomial *nextPtr);
    string coefficient;
    string power;
    polynomial *next; 
};

class linkedList
{
public:
    void makeList();
private:
    polynomial *head;
}; 
```

.cpp 文件：

```
polynomial:: polynomial ( string newCoefficient, string newPower, polynomial *nextPtr )
    :
coefficient(newCoefficient),
    power(newPower), 
    next(nextPtr) 

{}

void linkedList::makeList()
{
    polynomial poly; 

    string input1, input2; 
    cin >> input1; 
    cin >> input2;

    while (input1 != "-999" && input2 != "-999") 
    { 
        poly *newNode = new polynomial (input1, input2, next); 
        next = newNode; 
        cin >> input1;
        cin >> input2;
    }

} 
```

但是，问题在于这两行代码：

```
poly *newNode = new polynomial (input1, input2, next); 
next = newNode; 
```

在第一行，它说 newNode 是一个未声明的标识符。它还说：

Polynomial::polynomial(std::string,std::string,polynomial *)' : 无法将参数 3 从 ' *InIt (* _cdecl *)(_InIt,iterator_traits<_Iter>::difference_type)' 转换为 'polynomial *' 1>上下文不允许消除重载函数的歧义

在第二行，它说 newNode 再次未声明。

这里有什么问题？:( 我正在尝试将值放在链表中的结构中。在编码更多之后，我想在输入两个值时创建一个新的链表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:02:09.457

您从未声明`next`, and`poly`是一个变量，而不是一个类型。应该`polynomial *poly`的话`poly = new polynomial(input1, input2, next);`。

# perl - Perl Tie::IxHash - 是否有“每个”方法？

> ID：14886259
> 
> 赞同：2
> 
> 时间：2013-02-14T23:59:15.160
> 
> 标签：perl, hash, each, tie

Tie::IxHash 生成一个对象，该对象具有一组几乎完整的行为，既是数组又是哈希。但我没有找到`each`函数的等价物，它返回 (key,value) 对。

我只是忽略了它吗？

如果我必须自己动手，我会认为这样的事情会起作用：

```
use Tie::IxHash;
$t = Tie::IxHash->new( a,1,b,2,c,3 );
while (($x1, $x2) =  map { $_ => $t->Values($_) } $t->Keys ) { say "$x1 => $x2"; } 
```

但输出是一个无限的系列

```
a => 1 
```

...原因我还不清楚。

任何人都可以建议如何`each`使用绑定哈希来实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T01:17:49.880

`Tie::IxHash`没有方法，但您可以在绑定哈希上`Each`使用 Perl 的函数：`each`

```
use Tie::IxHash;
my $t = tie my %hash, 'Tie::IxHash';
@hash{qw/a b c d e/} = (1, 2, 3, 4, 5);

# using the tied hash
while (my ($key, $val) = each %hash) {
    print "$key => $val\n";
}

# using the OO interface (interchangeably)
foreach my $key ($t->Keys) {
    my $val = $t->FETCH($key);
    print "$key => $val\n";
} 
```

请注意，这是`$t->Values($key)`行不通的。此方法需要索引而不是键。这将起作用：

```
foreach (0 .. $t->Length - 1) {
    my ($key, $val) = ($t->Keys($_), $t->Values($_));
    ...
} 
```

# java - 为 DAG 构建全路径算法

> ID：14886260
> 
> 赞同：2
> 
> 时间：2013-02-14T23:59:28.833
> 
> 标签：java, algorithm, directed-acyclic-graphs

一直在尝试构建一种通过 DAG 获取所有可能的唯一路径的方法。使用递归，因为它似乎最容易理解。结束了这个：

```
public class Brutus {
    //the previous nodes visited
    public ArrayList<Node> resultHistory = new ArrayList<Node>();
    //Directed Graph class, contains a HashMap [adjacencies]
    // that has keys for all nodes that contains all edges
    public AdjacencyList paths;
    //A list of all the pathways between nodes represented as a list of nodes
    public ArrayList<ArrayList<Node>> allPaths = new ArrayList<ArrayList<Node>>();

public Brutus(AdjacencyList paths) {
    this.paths = paths;
}

public ArrayList<ArrayList<Node>> findAll() {
    int counter = 1;
    for (Node key : paths.adjacencies.keySet()) {
        System.out.println("[" + counter + "]: " + key.toString());
        StringTokenizer st = new StringTokenizer(
            paths.getAdjacentString(key), ",");
        while (st.hasMoreTokens()) {
            String child = st.nextToken();
            if (paths.getNodeFromGraph(child) != null) {
                resultHistory = new ArrayList<Node>();
                resultHistory.add(key);
                findPath(child, resultHistory);
            }
        }
        counter++;
    }
    return allPaths;
}

public void findPath(String child, ArrayList<Node> resultHistory) {
    if (resultHistory.contains(paths.getNodeFromGraph(child))) {
        return;
    }
    resultHistory.add(paths.getNodeFromGraph(child));
    if(!(inList(resultHistory, allPaths))) {
        allPaths.add(resultHistory);
    }
    StringTokenizer st = new StringTokenizer(
        paths.getAdjacentString(paths.getNodeFromGraph(child)), ",");
    while (st.hasMoreTokens()) {
        child = st.nextToken();
        if (paths.getNodeFromGraph(child) != null) {
            findPath(child, resultHistory);
        }

    }
}

public boolean inList(ArrayList<Node> resultHistory,
    ArrayList<ArrayList<Node>> allPaths) {
    for (int i = 0; i < allPaths.size();i++) {
        if (allPaths.get(i).equals(resultHistory)) {
            return true;
        }
    }
    return false;
} 
```

问题是，我不认为它适用于所有路径，因为我无法在其中找到某些路径。虽然数据集是 900 个节点，但我找不到模式！Stack 上的其他问题似乎更专业一些，因此我尝试构建自己的算法！

谁能建议一种更好的方法来执行此操作，或者告诉我我做错了什么？如果算法正确，那么撤销两个节点之间所有路径的最佳方法是什么？

编辑：我现在意识到新路径不是从原始的子节点创建的，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T03:27:48.003

这是一个简单的递归算法，用伪代码表示，以避免使用大量 Java 列表操作来混淆问题：

```
AllPaths(currentNode):
  result = EmptyList()
  foreach child in children(node):
    subpaths = AllPaths(child)
    foreach subpath in subpaths:
      Append(result, currentNode + subpath)
  return result 
```

调用`AllPaths`根节点将为您提供所需的内容，并且您可以通过`AllPaths`在每个节点上缓存结果来提高非平凡 DAG 的运行时间，因此您只需计算一次，而不是每个包含它的不同路径计算一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T14:05:05.003

这里有一个基于[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)算法的实现。我将路径表示为一系列顶点`l = (v, v', v'', ...)`，我将对其执行以下两个操作：

*   `extend(l, v)`：将顶点`v`放在列表的末尾`l`；
*   `v = back(l)`：获取列表中的最后一个顶点`l`。

* * *

```
FindPaths(G, v) {
  // The first path is, simply, the starting node.
  // It should be the first vertex in topological order.
  pending_paths = {(v)};
  while (pending_paths is not empty) {
    l = pending_paths.remove_first(); // pop the first pending path
    output(l); // output it (or save it in a list to be returned, if you prefer)
    v = back(l); // Get the last vertex of the path
    foreach(edge (v, v') in G) { // For each edge outgoing from v'...
      // extend l with v' and put into the list of paths to be examined.
      pending_paths.push_back(extend(l, v'));
    } 
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T23:48:36.940

因此，虽然@akappa 的 Pseudo 是一个好的开始，但我花了一段时间才了解如何让它发挥作用，如果其他人看到这篇文章，我就是这样做的：

```
public ArrayList<ArrayList<Node>> searchAll() {
    try {
        BufferedWriter out = new BufferedWriter(new FileWriter("output.txt"));
        //Gets Nodes from Hashmap and puts them into Queue
        for (Node key : paths.adjacencies.keySet()) {
            queue.addToQueue(new QueueItem(key.chemName, new ArrayList<Node>()));
        }
        while (queue.getSize() > 0) {
            QueueItem queueItem = queue.getFromQueue();
            Node node = paths.getNodeFromGraph(queueItem.getNodeId());
            if (node != null) {
                findRelationAll(node, queueItem, out);
            }
        }
        System.out.println("Cycle complete: Number of Edges: [" + resultHistoryAll.size() + "]");
        out.close();
    } catch (IOException e) {
    }
    return resultHistoryAll;

}

public void findRelationAll(Node node, QueueItem queueItem, BufferedWriter out) {
    if (!foundRelation) {
        StringTokenizer st = new StringTokenizer(paths.getAdjacentString(node), ",");
        while (st.hasMoreTokens()) {
            String child = st.nextToken();
            ArrayList<Node> history = new ArrayList<Node>();
            //Gets previous Nodes
            history.addAll(queueItem.getHistoryPath());
            //Makes sure path is unique
            if (history.contains(node)) {
                System.out.println("[" + counter2 + "]: Cyclic");
                counter2++;
                continue;
            }
            history.add(node);
            resultHistory = history;
            queue.addToQueue(new QueueItem(child, history));
            if (!(inList(resultHistory, resultHistoryAll))) {
                resultHistoryAll.add(resultHistory);
                try {
                    out.write("[" + counter + "]: " + resultHistory.toString());
                    out.newLine();
                    out.newLine();
                } catch (IOException e) {
                }
                System.out.println("[" + counter + "]: " + resultHistory.toString());
                counter++;
            } else {
                System.out.println("[" + counter3 + "]: InList");
                counter3++;
            }

        }
    }
}
//This checks path isn't in List already
public boolean inList(ArrayList<Node> resultHistory, ArrayList<ArrayList<Node>> allPaths) {
    for (int i = 0; i < allPaths.size(); i++) {
        if (allPaths.get(i).equals(resultHistory)) {
            return true;
        }
    }
    return false;
} 
```

}

上面的代码做了一些你可能不想要的额外事情：

*   它将路径写入文本文件作为节点列表+它的计数器值。
*   确保路径不会两次穿过同一个节点
*   确保最终列表中没有两条路径相同（在正常情况下，这是不必要的工作）

QueueItem 对象只是存储以前访问过的节点的一种方式。它是[nemanja](http://blog.konem.net/java///index.php/breadth_first_search_algorithm_in_java_w?blog=1)代码的一部分，这是我的代码所基于的。

向他致敬，akappa（最有效的答案）和 jacobm（寻找像我的原始代码这样的解决方案，并解释它的局限性）。

以防有人真正对这项工作感兴趣；我目前正在处理超过 500 万条通路，其中 60,000 条是 900 种化学品之间的独特通路。这只是 1、2、3 或 4 种化学途径……生物学很复杂。

编辑和警告：如果有人像我一样处理大量数据，Windows 7 - 或者至少我的机器 - 会在 ArrayList > 63,000 个对象后抛出一个糟糕的配合并关闭程序，无论你如何安排指针。我开始的解决方案是在 60,000 个对象之后，重新启动列表，同时将所有内容添加到 CSV。这导致了列表迭代之间的一些重复，并且最终应该被我明天转向 linux 所超越！

# java - GXT 字段值更新 onblur

> ID：14886267
> 
> 赞同：0
> 
> 时间：2013-02-15T00:00:37.483
> 
> 标签：java, gwt, gxt, onblur

让我们谈谈 GXT v3 字段。

有两个框架 A 和 B。

框架 A 有一组字段和一个提交按钮 SA。提交按钮读取帧 A 中的字段。帧 B 只有一个提交按钮 SB，它读取帧 A 中的字段。

执行以下步骤。

1.  将数据输入到帧 A 的字段 F1 中。
2.  单击 Frame A 中的某个区域或单击 Frame A 的提交按钮。
3.  F1 getCell() 上的调试将显示它有一个值。

执行以下替代步骤。

1.  将数据输入到帧 A 的字段 F1 中。
2.  单击框架 B 中的按钮。
3.  F1 getCell() 上的调试将显示它没有值。

这对我来说是个问题。因此，我想知道单击按钮 SA 和按钮 SB 之间帧 A 中字段的 onblur 操作的区别。

在点击 Frame A 时 Field F1 的 onblur 会执行哪些操作，而 Field F1 的 onblur 在点击 Frame B 时不会执行？

如果我知道这种差异，那么我将能够执行这种差异。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:20:14.573

解决方案很简单。

只需选择帧 A 中的任意两个字段。

```
public void focusA(){
  frameA.getField1().focus();
  frameA.getField2().focus();
  frameA.focus();
} 
```

帧 B 中的按钮单击处理程序应在刷新字段值之前调用 focusA()。

focusA() 所做的是

*   关注任何其他字段都会触发从 DOM 到字段编辑器值的更新，除了被关注的字段。
*   在这种情况下，触发另一个随机字段以触发第一个字段的更新。
*   然后通过关注容器来防止焦点粘在最后一个被关注的字段上（以防止用户无意中编辑字段）。

# android - 从 BroadcastReceiver:onReceive 获取新安装的应用程序

> ID：14886269
> 
> 赞同：2
> 
> 时间：2013-02-15T00:00:55.303
> 
> 标签：android

有没有办法从 BroadcastReceiver onReceive 方法获取新安装的应用程序。

```
public class PackageAddedReceiver extends BroadcastReceiver {

public void onReceive(Context context, Intent intent) {

    Toast.makeText(context, "Package Installed: ", Toast.LENGTH_LONG).show();

}
} 
```

我将过滤器设置为：

```
<receiver android:name=".receiver.PackageAddedReceiver" android:label="Package added Receiver">
    <intent-filter>
        <action android:name="android.intent.action.PACKAGE_ADDED" />
        <action android:name="android.intent.action.PACKAGE_REMOVED"/>
        <data android:scheme="package"/>
    </intent-filter>
</receiver> 
```

那么获取新安装的包信息的最佳方法是什么？

谢谢。

# javascript - HTML。如何制作一个空白页

> ID：14886276
> 
> 赞同：0
> 
> 时间：2013-02-15T00:01:19.430
> 
> 标签：javascript, html, css

可以说我有一个正常的网站页面。它与上面的内容无关。我如何使用 javascript 和 html 使页面完全空白（白色）。我已经试过了：

```
<body style='z-index:9999;position:absolute;background:#ffffff url('http://removed/bg.jpg') repeat right top;width:1000%;height:1000%;'></body> 
```

但它不包括任何东西。我怎样才能做到这一点？当我单击一个按钮时，我只想让整个页面变为空白。

我不知道为什么它说这不符合标准。但我想我需要写更多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:05:22.993

```
<script>
var eventListener = window.addEventListener ? "addEventListener" : "attachEvent";
var clickEvent = eventListener == "attachEvent" ? "onclick" : "click";

document.getElementById('buttonId')[eventListener](clickEvent, function(){
  document.body.style.display = "none";
});
<script>

<button id="buttonId">click me</button 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:04:09.947

因为身体的背景总是在元素的后面。将样式放入`<div>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:05:34.097

把它放在页面的头部

```
<style>
body {
   background: #fff; 
   color: #fff;
}

body > * {
   display: none;
}
</style> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T00:16:01.723

要在单击按钮时使页面变为空白（使用 jQuery）：

在您的 HTML 中：

```
<button id="blankit">Begone!</button> 
```

你的 JS：

```
$(function() {
    $('#blankit').click(function(){
        $('body').hide();
    });
}); 
```

# html - 试图让 div 覆盖整个网站，以便在视频播放时使页面变暗

> ID：14886279
> 
> 赞同：0
> 
> 时间：2013-02-15T00:01:37.800
> 
> 标签：html, css

我的网站上有一个视频播放器，当视频播放时，我试图让整个网站变暗。我放置了一个 div 来包装所有内容，并确保视频和视频容器的 z-index 高于 div。但是它并没有像我希望的那样工作。

它还搞砸了我的包装器的对齐方式。这是我的网站：[http](http://www3.carleton.ca/clubs/sissa/html5/video.html) ://www3.carleton.ca/clubs/sissa/html5/video.html 当我将所有内容都包装在 Shadow div 中时。一切都向左移动： ![在此处输入图像描述](../Images/6e6a507848fcef9dd316981914f046c2.png)

HTML：

```
<body>
<div id="shadow">
<div id="wrapper">

    <a href="index.html">
        <header id="top_header">
            <h1>MacroPlay Games</h1>
        </header>
    </a>

    <nav id="topnav">
        <ul>
            <a href="index.html"><li>Home</li></a>
            <a href="about.html"><li>About</li></a>
            <a href="video.html"><li>Trailers</li></a>
            <button type="button" data-state="0" style="float:right">Cinema Mode</button>
        </ul>
    </nav>

    <div id="body_div">

        <div id="video_container">
            <video id="trailers" poster="poster.jpg">
                <source src="vLast.mp4" type="video/mp4">
                <source src="vLast.webm" type="video/webm">
            </video>
            <nav>
               <div id="controls" class="cAnimated cFadeInRight">
                    <div id="defaultBar">
                        <div id="progressBar"></div>
                    </div>
                    <button id="playButton">Play</button>
                    <button id="vol" onclick="showSlider()">Vol</button>      
                    <button id="containSlider"> 
                                <input type="range" id="vSlider" min="0" max="1" step="0.1" value="0.5"/></button>
                    <div id='containTime'><span id='timeDisplay'>0:00</span><span>/</span><span id='duration'>0:00</span></div>
                    <button id="full">Full</button>
                    <button id="mute">Mute</button>

               </div> 
               <div id="playlist" class="animated fadeInRight">
                    <div class="thumb" id="tb1"><img src="TbGow.jpg" onClick="changeTrailer('vGow')"/></div>
                    <div class="thumb" id="tb2"><img src="TbLast.jpg" onClick="changeTrailer('vLast')"/></div>
                    <div class="thumb" id="tb3"><img src="TbTwo.jpg" onClick="changeTrailer('vTwo')"/></div>
               </div>
            </nav>
        </div>

        <aside id="sidebar">
        <div id="side_events">
            <h1>News</h1>
            <ul id="events">
                <li>Half-Life 3 Release: <time>04/01/13</time></li>
                <li>Borderlands 3 Release: <time>05/29/13</time></li>
                <li>E3 2013 Starting: <time>08/11/13</time></li>
                <li>Playstation 4 Release: <time>08/31/13</time></li>
                <li>Xbox 720 Release: <time>09/01/13</time></li>
            </ul>
        </div>

            <div id="side_trailer">
                <a href="video.html"><img src="TbGow.jpg" /></a>
            </div>

        <div id="side_advert">
            <img src="http://i.imgur.com/W65o9R2.jpg" alt="Blackberry's Z10" title="Blackberry's Z10" id="advert">
        </div>                     
    </aside>

    </div>

    <footer id="footer">
        &copy; Copyright  by SimKessy
    </footer>
</div>
</div>
</body>
</html> 
```

与 div (Shadow) 相关的规则：

```
#shadow{
    position:fixed;
    width:100%;
    height: 100%;
    top:0;
    left:0;
    opacity:0.5;
    background-color: red; 
    z-index: 81;

}
#video_container{
    -webkit-box-flex: 1; 
    -moz-box-flex: 1;
    border:5px solid black;
    margin: 20px;
    padding: 5px;
    height: 100%;
    position: relative;
    background-color:black;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px; 
    z-index:0;
}
#video_container video{
    width: 100%;
    /*height: auto;*/
    display: block;
    z-index: 0;
} 
```

我的代码：http: [//jsfiddle.net/eXJ5q/](http://jsfiddle.net/eXJ5q/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:25:06.550

尝试这个

`<div class="dim"></div>`在此之前添加此`<div id="video_container">`

然后添加这个css

```
.dim {
    background: none repeat scroll 0 0 rgba(0, 0, 0, 0.8);
    bottom: 0;
    left: 0;
    position: fixed;
    right: 0;
    top: 0;
    z-index: 1;
}

#video_container{
       z-index: 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:39:49.413

您可以将阴影 div 作为兄弟而不是视频容器的父级，并且一切都应该按预期工作。您也不需要如此高值的 z-index。它可以只是 1，只要它比您要隐藏的值更大。

# java - 在我手动强制退出应用程序并重新启动后，异步任务不会调用 OnPostExecute 或 onProgressUpdate

> ID：14886280
> 
> 赞同：0
> 
> 时间：2013-02-15T00:01:46.607
> 
> 标签：java, android, android-asynctask

我有一个`AsyncTask`下载文件的`doInBackground()`方法。我在发布它之前测试我的应用程序。当我手动强制退出应用程序并重新启动它时，`doInBackground()`似乎调用了 ，但没有调用`onProgressUpdate()`and `onPostExecute()`。我的`onPostExecute()`调用方法会导致 UI 更改。

如何确保`onPostExecute`and`onProgressUpdate()`被调用？我还看到以下警告：

`Activity`停止超时`ActivityRecord`或`Activity`销毁超时`ActivityRecord`或`Activity`空闲超时`ActivityRecord`

代码：

```
public void OnCreate(){

    new RefreshMyDashboardTask().execute();
}

private class RefreshMyDashboardTask extends AsyncTask<Void, Void, Long> {

    @Override
    protected void onPreExecute() {
    }

    @Override
    protected void onProgressUpdate(Void... params) {
        super.onProgressUpdate(params);
    }

    @Override
    protected Long doInBackground(Void... params) { 
        // my server calls are called here.
    }

    @Override
    protected void onPostExecute(Long result) {
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:23:19.017

If you kill your app, or if the system kills it, then AsyncTask threads for your app get killed. They're all part of your app's process; threads can't survive outside the process that started them.

Even an IntentService might not survive a force quit. That's why task killers are such a bad idea.

In short, what you're seeing is expected behavior.

# c# - 文本框验证为空或 11 位

> ID：14886283
> 
> 赞同：0
> 
> 时间：2013-02-15T00:02:01.523
> 
> 标签：c#, jquery

我的表单中有一个文本框，只有当它为空或包含 11 位数字时才必须进行验证。我尝试了在互联网上找到的所有解决方案，但没有任何反应。

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#ctl00_CPH1_tax_id').attr("placeholder", "1234567890");
        $('#ctl00_CPH1_citizen_id').attr("placeholder", "12345678901");
        $('#ctl00_CPH1_e_posta').attr("placeholder", "ahmet.mehmet@sirket.com.tr");

        //var isbp = $('#ctl00_CPH1_IsBP');
        var name = $('#ctl00_CPH1_name').val();
        var code = $('#ctl00_CPH1_code').val();
        var dropdownlist2 = $('select:first');
        var tax_id = $('#ctl00_CPH1_tax_id').val();
        var citizen_id = $('#ctl00_CPH1_citizen_id').val();
        var email1 = $('#ctl00_CPH1_e_posta').val();
        var isbp = $('input[type=checkbox]:first');
        var dropdownlist1 = $('select:last');
        var isactive = $('input[type=checkbox]:last');
        //var dropdownlist1 = $('#ct100_CPH1_DropDownList1');
        var tax_id_check = /^\d{10}$/.test(tax_id);
        var citizen_id_check = /^$|^\d{11}$/.test(citizen_id);

        var email1_check = /^[a-zA-Z0-9._]+@([a-zA-Z0-9.]|[a-zA-Z0-9]+\-[a-zA-Z0-9.])+\.[a-zA-Z]{2,6}$/.test(email1);
        dropdownlist1.attr("disabled", "disabled");
        isactive.attr("disabled", "disabled");

        $(isbp).click(function(e) {
            if (isbp.is(':checked')) {
                dropdownlist1.removeAttr("disabled");
                isactive.removeAttr("disabled");
            }
            else {
                isactive.attr("disabled", "disabled");
                dropdownlist1.attr("disabled", "disabled");
            }
        });

        $("#ctl00_CPH1_Button1").click(function(e) {
            //console.log(drop2);
            //var name_status = /^[a-zA-Z][a-zA-Z]*$/.test(name);
            //var code_status = /^[a-zA-Z][a-zA-Z]*$/.test(code);
            //var IsBP = $('#ctl00_CPH1_IsBP');
            //if (name.length < 3 || name_status == false) {
            //    e.preventDefault();
            //    alert('İsim sadece karakterlerden oluşmalı ve en az iki karakter olmalı!');
            //}
            //if (code.length < 3 || code_status == false) {
            //    e.preventDefault();
            //    alert('Soyisim sadece karakterlerden oluşmalı ve en az iki karakter olmalı!');
            //}
            if (name.length == 0) {
                e.preventDefault();
                alert("İsim girilmedi!");
            }
            if (code.length == 0) {
                e.preventDefault();
                alert("Şirket Kodu girilmedi!");
            }
            if (dropdownlist2.val() == 0) {
                e.preventDefault();
                alert("Ülke seçilmedi!");
            }
            if (citizen_id.length != 0) {
                e.preventDefault();
                alert("Vatandaşlık numarası onbir haneli olmalı!");
            }
            if (tax_id.length == 0) {
                e.preventDefault();
                alert("Vergi numarası girilmedi!");
            }
            else if (!tax_id_check) {
                e.preventDefault();
                alert("Vergi numarası on haneli olmalı!");
            }

            if (email1 != "" && !email1_check) {
                e.preventDefault();
                alert("E-Posta geçerli değil!");
            }
            if (isbp.is(':checked') && dropdownlist1.val() == 0) {
                e.preventDefault();
                alert("İş ortağı tipi seçilmedi!");
            }
        });
    }); 
```

这是我的脚本，aspx 如下：

```
 <form id="form1" runat="server">
<div>
<center>
    <table>
        <tr>
            <td colspan="3" align="center">
                Şirket Giriş Ekranı</td>
        </tr>
        <tr>
            <td colspan="3">&nbsp;</td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label1" runat="server" Text="İsim"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="name" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label2" runat="server" Text="Şirket Kodu"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="code" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label3" runat="server" Text="Ülke"></asp:Label>
            </td>
            <td class="style4" colspan="2">
                <asp:DropDownList ID="DropDownList2" runat="server" 
                    onselectedindexchanged="DropDownList2_SelectedIndexChanged">
                </asp:DropDownList>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label4" runat="server" Text="Vergi No"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="tax_id" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label5" runat="server" Text="Vergi Dairesi"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="tax_office" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label6" runat="server" Text="Vatandaşlık No"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="citizen_id" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label7" runat="server" Text="Adres"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="address" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label14" runat="server" Text="E-posta"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="e_posta" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label15" runat="server" Text="Telefon"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="telefon" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label16" runat="server" Text="Fax"></asp:Label>
            </td>
            <td colspan="2">
                <asp:TextBox ID="faks" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label10" runat="server" Text="İş Ortağım"></asp:Label>
            </td>
            <td colspan="2">
                <asp:CheckBox ID="IsBP" runat="server" oncheckedchanged="IsBP_CheckedChanged"/> <!--AutoPostBack="true"--> 

                <asp:Label ID="Label11" runat="server" Text="Evet"></asp:Label>
            </td>
        </tr>
        <tr>
            <td align="left">
                <asp:Label ID="Label12" runat="server" Text="İş Ortağı Tipi"></asp:Label>
            </td>
            <td>
                <asp:DropDownList ID="DropDownList1" runat="server" 
                    onselectedindexchanged="DropDownList1_SelectedIndexChanged">
                </asp:DropDownList>
            </td>
            <td>
                <asp:CheckBox ID="IsActive" runat="server" 
                    oncheckedchanged="IsActive_CheckedChanged" />
                <asp:Label ID="Label13" runat="server" Text="Aktif"></asp:Label>
            </td>
        </tr>
        <tr>
            <td colspan="3">&nbsp;</td>
        </tr>
        <tr>
            <td>
                <asp:Button ID="Button2" runat="server" onclick="Button2_Click" Text="Geri" />
            </td>
            <td colspan="2" align="center">
                <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Kaydet" />
            </td>
        </tr>
    </table>
    <br />
</center>
</div>
</form> 
```

我尝试了 jquery 旧版本，例如 1.8.3，它是稳定的而不是 1.9.1 还有 jquery.validate。当我在 chrome 上运行代码并在控制台上检查元素时，一切运行正常。但是我的代码没有显示任何警报。"==" 有效，但 "!=" 或 ">" 无效。提前致谢！不工作的文本框是电子邮件和citizen_id。其他文本框正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T04:30:57.030

使用带有正则表达式的 ASP.NET 验证器，类似于

```
"(\d{11})?"

<asp:RegularExpressionValidator ControlToValidate="citizen_id" 
    ValidationExpression="(\d{11})?" runat="server" 
    Text="Must be 11 digits or empty" /> 
```

如果文本框“citizen_id”不是“”或 11 位数字，这将防止回发。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.regularexpressionvalidator.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.regularexpressionvalidator.aspx)

# jquery - 为 jQuery ajax 请求发送数据的正确格式是什么？

> ID：14886288
> 
> 赞同：0
> 
> 时间：2013-02-15T00:02:41.063
> 
> 标签：jquery, .net

使用 jQuery 执行 ajax 请求时，我不确定如何将变量添加到发送到服务器的数据中。使用静态字符串发送请求可以正常工作：

```
$("#btnSubmit").click(function () {

                var inputtext = $("#txtInput").val();

                $.ajax({
                    type: "POST",
                    url: "Webform1.aspx/Function",
                    data: "{'ans':'hello'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        alert(msg.d);
                    }

                });
            }); 
```

上面调用 .net 函数，然后生成一个带有响应字符串的 msgbox。

如何用上面的 inputtext 变量等变量替换硬编码字符串 'hello'。

以下不起作用并导致与 json 解析相关的 500 错误：

```
{'ans':inputtext} 
```

~~{ans：输入文本}~~

```
{"ans":inputtext} 
```

（ans 是函数参数的名称）

**编辑：**

为了处理请求服务器端，我只使用函数的 .net WebMethod 属性，它与上面示例中的硬编码字符串请求一起使用，但在使用数据传递变量时仅返回整个 html 页面：{ans:inputtext} ：

```
 [System.Web.Services.WebMethod]
    public static string Function(string ans)
    {

        return ans;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:05:00.023

这应该工作：

```
$("#btnSubmit").click(function () {
    var inputtext = $("#txtInput").val();

    $.ajax({
        type: "POST",
        url: "Webform1.aspx/Function",
        data: {ans: inputtext},
        dataType: "json",
        success: function (msg) {
            alert(msg.d);
        }
    });
}); 
```

只要`#btnSubmit`不是表单中的实际提交按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:05:13.807

您的数据选项的值看起来很奇怪。我通常通过以下方式进行操作：

```
 $.ajax({
                    type: "POST",
                    url: "Webform1.aspx/Function",
                    data: {'ans':'hello'},
                    contentType: "application/json; charset=utf-8",

                    success: function (msg) {
                        alert(msg);
                    }

                }); 
```

我删除了 dataType：“json”，我认为 json 无论如何都是默认的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:08:11.113

如果您使用提交事件而不是按钮单击，那么获取对表单的引用会更容易，然后在表单上调用 .serialize ，这将包括所有表单字段。只要输入的 [name] 属性是“ans”，那么它将以具有该名称的 json 结尾。我的示例假设您将“answerForm”类添加到您想要此行为的表单中。

```
.on('submit', '.answerFornm', function (e) {
  $.ajax({
  ...
    data: $(this).serialize(),
    contentType: "application/json; charset=utf-8",
  ... 
```

# ruby - 如何将映射应用于 Puppet/Ruby ERB 模板中的值？

> ID：14886289
> 
> 赞同：2
> 
> 时间：2013-02-15T00:02:50.300
> 
> 标签：ruby, erb, puppet

我正在编写一个 ERB 模板（用于 Puppet 模块），它通过这样的哈希传递：

```
{"stuff" => {"foo"=>"aaa", "bar"=>"ccc"},
 "other" => {"foo"=>"bbb", "bar"=>"ddd"}} 
```

我在生成文本行的模板中对其进行迭代：

```
<% @my_data.each_pair do |k, v| -%>
<%= k %> <%= v["foo"] %>:<%= v["bar"] %>
<% end -%> 
```

现在我想将一些映射应用到“foo”数据，并带有第二个哈希值，我将传递给模板。在伪代码中：

```
mappings = {"aaa" => "something", "bbb" => "somethingelse"}
<% @my_data.each_pair do |k, v| -%>
<%= k %> <%= TRANSLATE_SOMEHOW(v["foo"], mappings) %>:<%= v["bar"] %>
<% end -%> 
```

...为了在值为“aaa”时获得“某物”，依此类推。如果“映射”中没有相应的键，我希望得到原始值。

用 Puppet 的语言做那种事情可能是可能的（通过用一些 Ruby 代码扩展它）我认为它可能更适合在 ERB 模板中，但我不知道该怎么做，不知道 Ruby 没有帮助我 - 尝试谷歌但没有多大成功。

我正在寻找代码以在 ERB 函数中实现这一点，或者为我的 RTFM 乐趣寻找一些指向相关文档的指针。

编辑：对于未来的读者，这里是 DigitalRoss 的答案，翻译成我上面的 ERB 示例：

```
<% @my_data.each_pair do |k, v| -%>
<%= k %> <%= mappings[v["foo"]] || v["foo"] %>:<%= v["bar"] %>
<% end -%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T02:04:56.383

为了清楚起见，删除了 erb 的东西，这就是你想要做的。（这个`p()`函数只是打印它的参数。你可以在 irb 中试试这个。）

```
@my_data.each do |k, v|
  f, b = v['foo'], v['bar']
  p(mappings[f] || f)
  p(mappings[b] || b)
end 
```

# android - Android编程中的imageButton

> ID：14886291
> 
> 赞同：-3
> 
> 时间：2013-02-15T00:02:56.447
> 
> 标签：android, imagebutton

我在android编程中有一个ImageButton的问题，我放了logcat，如果有人可以帮我解决它：

java.lang.RuntimeException：无法启动活动 ComponentInfo{com.app/com.app.MainActivity}：java.lang.ClassCastException：android.widget.ImageButton 无法转换为 android.widget.Button ... 原因：java .lang.ClassCastException: android.widget.ImageButton 不能转换为 android.widget.Button

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:05:58.983

```
ImageButton b = (ImageButton) findViewById(R.id.myImageButton); 
```

[http://developer.android.com/reference/android/widget/ImageButton.html](http://developer.android.com/reference/android/widget/ImageButton.html)

从日志中，您将其转换为`Button`，而不是`ImageButton`. 两个截然不同的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T00:06:02.757

这意味着您不能将 ImageButton 转换为 Button。相反，您需要以不同的方式处理您的铸造情况。

不能铸造它们的原因是：

## 遵循 ImageButton 的流程：

> java.lang.Object ↳ android.view.View ↳ android.widget.ImageView ↳ android.widget.ImageButton

## 结论

由于它不扩展 Button，因此您不能将其转换为该类型。虽然这个名字用词不当，因为它叫做 ImageButton..

# css - 在相对内部、固定内部、绝对内部定位绝对 - 在 IE7 中已损坏

> ID：14886292
> 
> 赞同：0
> 
> 时间：2013-02-15T00:03:04.060
> 
> 标签：css, css-position

我正在开发一个现有的网络应用程序，我的任务是让它在 IE7 上运行。它在 IE8、FF 等中运行良好。

结构示例：

```
<div id="page">    ------------- absolute position
 <div id="shell">  -------------  static position
   <div id="outer">   ------------  fixed position
      <div id="inner">  ------------  relative position
          <h1>My Title</h1>  ------------ absolute position
      </div>
   </div>
  </div>
</div> 
```

IE 7 中的问题是屏幕上没有 H1。如果我将其更改为相对，它会显示出接近它需要的位置。我怀疑这个问题与固定 rel 中的 abs 等有关，但我不想在知道规则之前开始尝试组合。

因此，如果这里有任何违反 IE 7 的明显规则，请告诉我。谢谢。

# java - JTree 中自定义节点上的鼠标操作：jre6 和 jre7 之间的区别

> ID：14886300
> 
> 赞同：2
> 
> 时间：2013-02-15T00:04:03.947
> 
> 标签：java, swing, jbutton, jtree, treecellrenderer

JTree 使用 TreeCellRenderer 和 TreeCellEditor 显示三个自定义节点：

*   单个 JCheckBox
*   单个 JButton
*   由任何操作组件组成的 JPanel（这里是 North 上的 JCheckBox 和 South 上的 JButton）

截图：http: [//i.imgur.com/9j6B2ji.png](http://i.imgur.com/9j6B2ji.png)

如果使用 Java Runtime Environment 6，这样的树没有问题。

除了使用 Java Runtime Environment 7，当我单击 JPanel 节点内的 JButton 时，也会出现问题。JButton 的“单击”动画不会在您第一次单击 JPanel 时呈现（以及每次停止编辑具有 JPanel 的节点之后）。第一个节点 JCheckBox 和第二个节点 JButton 也可以与 jre6 和 jre7 完美配合。

我想让它在 jre6 中完全像以前一样工作，有解决方法吗？

*注意：让按钮执行代码不是问题。*

```
import java.awt.BorderLayout;
import java.awt.Component;
import javax.swing.AbstractCellEditor;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTree;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeCellRenderer;
import javax.swing.tree.DefaultTreeModel;
import javax.swing.tree.TreeCellEditor;
import javax.swing.tree.TreeCellRenderer;

class TreeNodeModel{
    public boolean isJCheckBox = false;
    public boolean isJButton = false;
    public boolean isJPanel = false;
    public Component userObject = null;
    public TreeNodeModel(String name){
        if( name.equals("JCheckBox") ){
            isJCheckBox = true;
        }else if( name.equals("JButton") ){
            isJButton = true;
        }else if( name.equals("JPanel") ){
            isJPanel = true;
        }
    }
}

class CustomTreeCellRenderer implements TreeCellRenderer{
    @Override
    public Component getTreeCellRendererComponent(JTree tree, Object value, boolean selected, boolean expanded, boolean leaf, int row, boolean hasFocus) {
        Component returnValue = null;
        if ((value != null) && (value instanceof DefaultMutableTreeNode)) {
            Object userObject = ((DefaultMutableTreeNode) value).getUserObject();
            if (userObject instanceof TreeNodeModel) {
                TreeNodeModel node = (TreeNodeModel) userObject;
                if(node.isJButton){
                    returnValue = new JButton("Ok");
                }else if(node.isJCheckBox){
                    returnValue = new JCheckBox("Ok");
                }else{
                    JPanel panel = new JPanel(new BorderLayout());
                    panel.add(new JButton("Problem"), BorderLayout.SOUTH);
                    panel.add(new JCheckBox("Problem"), BorderLayout.NORTH);
                    returnValue = panel;
                }
            }
        }
        if(returnValue == null)
            returnValue = new DefaultTreeCellRenderer().getTreeCellRendererComponent(tree, value, selected, expanded, leaf, row, hasFocus);
        return returnValue;
    }
}

class CustomTreeCellEditor extends AbstractCellEditor implements TreeCellEditor {
    public Component getTreeCellEditorComponent(JTree tree, Object value, boolean selected, boolean expanded, boolean leaf, int row) {
        Component returnValue = null;
        if ((value != null) && (value instanceof DefaultMutableTreeNode)) {
            Object userObject = ((DefaultMutableTreeNode) value).getUserObject();
            if (userObject instanceof TreeNodeModel) {
                TreeNodeModel node = (TreeNodeModel) userObject;
                if(node.isJButton){
                    returnValue = new JButton("Ok");
                }else if(node.isJCheckBox){
                    returnValue = new JCheckBox("Ok");
                }else{
                    JPanel panel = new JPanel(new BorderLayout());
                    panel.add(new JButton("Problem"), BorderLayout.SOUTH);
                    panel.add(new JCheckBox("Problem"), BorderLayout.NORTH);
                    returnValue = panel;
                }
            }
        }
        return returnValue;
    }
    @Override
    public Object getCellEditorValue() { return null; }
}

public class MyTestRendererEditor extends JFrame {
    public MyTestRendererEditor() { 
        DefaultMutableTreeNode node = new DefaultMutableTreeNode("root");
        node.add(new DefaultMutableTreeNode(new TreeNodeModel("JCheckBox")));
        node.add(new DefaultMutableTreeNode(new TreeNodeModel("JButton")));
        node.add(new DefaultMutableTreeNode(new TreeNodeModel("JPanel")));

        final JTree tree = new JTree(new DefaultTreeModel(node));
        tree.setCellRenderer(new CustomTreeCellRenderer());
        tree.setCellEditor(new CustomTreeCellEditor());
        tree.setEditable(true);

        getContentPane().add(new JScrollPane(tree));
        pack();
        setVisible(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
    public static void main(String[] args) { 
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new MyTestRendererEditor();
            }
        });     
    }
} 
```

# delphi - 升级记录文件和向后兼容性

> ID：14886301
> 
> 赞同：3
> 
> 时间：2013-02-15T00:04:04.767
> 
> 标签：delphi, record, backwards-compatibility, delphi-5

我有这样的文件：

```
file of record
  Str: string[250];
  RecType: Cardinal;
end; 
```

但在使用此文件一段时间后，我的客户发现，Str 永远不会大于 100 个字符，而且他还需要额外的字段。

在新版本中，我们有这样的文件：

```
file of packed record
  Str: string[200];
  Reserved: array[1..47] of Byte;
  NewFiled: Cardinal;
  RecType: Cardinal;
end; 
```

这条记录的大小相同，在之前的记录中，Str 和 RecType 之间的记录在对齐到 8 个字节时是一个未使用的字节。

问题：发生了什么，当这个新文件将从旧代码中读取时？他需要向后兼容。

旧代码阅读示例：

```
var
  FS: TFileStream;
  Rec: record
         Str: string[250];
         RecType: Cardinal;
       end;
...
// reading record by record from file:
FS.Read(Rec, SizeOf(Rec)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:07:39.267

old school pascal 字符串使用字符串的第一个字节（索引 0）来存储字符串的长度。

我们来看看这条记录的内存：

```
byte    0  1  2  3  4  5  6  7  8  9 10 11  12  13 ........ 243..246 247..250
value  10 65 66 67 68 69 70 71 72 73 74  0 200 130          NewField RecType 
```

从字节 11 到 242，内存可以包含垃圾，它会被程序简单地忽略（从未显示），因为这将字节 0 处的值 10 作为字符串的长度，因此字符串变为`'ABCDEFGHIJ'`

这确保了读取使用最新版本创建的文件的旧程序永远不会在字符串末尾看到*垃圾，因为字符串的**视图*将被限制为字符串的实际大小，并且内存位置将被忽略。

您必须仔细检查旧程序是否不会更改存储的值，以防将记录写回文件。我认为它也是安全的，但我只是不确定并且手头没有 Delphi 可以测试。

# javascript - 解码base64图片并上传

> ID：14886308
> 
> 赞同：1
> 
> 时间：2013-02-15T00:04:21.073
> 
> 标签：javascript, base64

我有一个 web 应用程序在本地保存图像，直到它们准备好发送到服务器。当我在本地保存图像时，我对它们进行 base64 编码。现在我想用这些图像进行多部分文件上传。

所以我需要将图像转换回二进制形式。我试过使用 FileReader 像这样将它转换回来，

```
var fr = new FileReader();
fr.onloadend = function(binaryImage){
    debugger;
    binaryImage;
};
var base64Str = item.base64Image.substr(item.base64Image.indexOf("base64") + 7);
//var base64Str = item.base64Image;
fr.readAsBinaryString(base64Str); 
```

但是永远不会触发 onloadend 事件并且没有错误。一旦我得到图像，我将不会有上传它的问题。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:02:44.023

不熟悉 FileReader，但我相信 readAsBinaryString 需要一个 Blob 或 File 对象。将字符串传递给我会导致错误。试试这个：

```
var fr = new FileReader();
fr.onloadend = function(binaryImage){
    debugger;
    binaryImage;
};
var blob = new Blob([item.base64Image.
                          substr(item.base64Image.indexOf("base64") + 7)]);
fr.readAsBinaryString(blob); 
```

我不认为这会给你想要的。查看这篇文章，了解编码/解码 Base64 的方法： [如何使用 Javascript 编码为 Base64？](https://stackoverflow.com/questions/246801/how-can-you-encode-to-base64-using-javascript/247261#247261)

看起来您可以将 btoa() 和 atob() 用于 Web 工具包浏览器。

# typescript - 打字稿项目项目模板文件在哪里

> ID：14886309
> 
> 赞同：1
> 
> 时间：2013-02-15T00:04:22.170
> 
> 标签：typescript

我想通过 t4 模板使用 VS 自动化以编程方式将打字稿文件添加到我的项目中。但是我似乎在我的机器上找不到打字稿项目项目模板文件。有谁知道它安装在哪里？我说的是使用 VS 的“添加新项目”对话框时选择的打字稿文件。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:30:46.480

那个在`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions\enn4wcm5.z2b\IT\CSharp\1033\f.zip`

每次安装的`enn4wcm5.z2b`部件都会有所不同。我不知道在 t4 中如何处理（或是否必须）。

# solr - 如何在 Solr 中查找包含数字和美元符号的文档？

> ID：14886310
> 
> 赞同：2
> 
> 时间：2013-02-15T00:04:25.080
> 
> 标签：solr

在 Solr 中，我有包含 $30 和 30 的文本。

我想搜索 $30 并且只找到包含 $30 的文档。

但如果有人搜索 30，他们应该会找到包含 $30 的文档和包含 30 的文档。

这是我目前用来索引我的文本字段的字段类型：

```
<!-- Just like text_en_splitting, but with the addition of reversed tokens for leading wildcard matches -->
<fieldType name="text_en_splitting_reversed" class="solr.TextField" positionIncrementGap="100" autoGeneratePhraseQueries="true">
  <analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <!-- in this example, we will only use synonyms at query time
    <filter class="solr.SynonymFilterFactory" synonyms="index_synonyms.txt" ignoreCase="true" expand="false"/>
    -->
    <!-- Case insensitive stop word removal.
      add enablePositionIncrements=true in both the index and query
      analyzers to leave a 'gap' for more accurate phrase queries.
    -->
    <filter class="solr.StopFilterFactory"
            ignoreCase="true"
            words="lang/stopwords_en.txt"
            enablePositionIncrements="true"
            />
    <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1" types="word-delim-types.txt" />
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
    <filter class="solr.PorterStemFilterFactory"/>
    <filter class="solr.ReversedWildcardFilterFactory" withOriginal="true"
       maxPosAsterisk="3" maxPosQuestion="2" maxFractionAsterisk="0.33"/>
 </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
    <filter class="solr.StopFilterFactory"
            ignoreCase="true"
            words="lang/stopwords_en.txt"
            enablePositionIncrements="true"
            />
    <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="1"  types="word-delim-types.txt" />
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
    <filter class="solr.PorterStemFilterFactory"/>
  </analyzer>
</fieldType> 
```

我已经定义 word-delim-types.txt 包含：

```
$ => DIGIT
% => DIGIT
. => DIGIT 
```

因此，当我搜索 $30 时，它会正确定位包含“$30”的文档，而不是仅包含“30”的文档。那挺好的。但是当我搜索“30”时，它没有找到包含“$30”的文档，只有包含“30”的文档。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T20:37:24.137

我找到了我的问题的解决方案。而不是定义 $ % 和 . 作为 DIGIT，我现在在作为属性传递给 WordDelimiterFilterFactory 的“类型”文件中将它们定义为 ALPHA。

```
$ => ALPHA
% => ALPHA
. => ALPHA 
```

由于我的 WordDelimiterFilterFactory 设置的其余部分，事物被分解并以达到预期效果的方式连接：

搜索 $30 只会产生包含 $30 的文档。搜索 30 会产生包含 30 美元和 30 美元的文档。

# java - 使用非常规方案获取重定向请求的最终 URL

> ID：14886313
> 
> 赞同：4
> 
> 时间：2013-02-15T00:04:59.093
> 
> 标签：java, http, apache-commons-httpclient

我的代码（如下）试图获取从进行一些重定向的服务器返回的最终 URL。只要 URL 具有 http 方案，它就可以正常工作。当我想用不同的方案返回一个 URL 时，我的问题就出现了。最终，在某些情况下，我希望返回一个 market:// url 或其他应用程序启动方案，因为这是针对 Android 的，我想用它们启动 Intents。

所以这让我可以检索最终的 http url，但是当最终的 url 是 market:// 时，它会抛出异常（java.lang.IllegalStateException：Scheme 'market' 未注册），然后 getURI 不提供那个，它将提供之前的一切。

```
 DefaultHttpClient client = new DefaultHttpClient();
    HttpContext httpContext = new BasicHttpContext();
    HttpGet httpGet = new HttpGet(mInitialUrl);

    try {
        client.execute(httpGet, httpContext);
    } catch (IllegalStateException e) {
        e.printStackTrace();
    }

    // Parse out the final uri. 
    HttpHost currentHost = (HttpHost) httpContext.getAttribute(ExecutionContext.HTTP_TARGET_HOST);
    HttpUriRequest req = (HttpUriRequest) httpContext.getAttribute(ExecutionContext.HTTP_REQUEST);

    return (req.getURI().isAbsolute()) ? req.getURI().toString() : (currentHost.toURI() + req.getURI()); 
```

现在，我可以将 market:// 注册为一个方案，但我不想事先硬编码有效方案是什么，我只想让它接受它们并返回它们。

有任何想法吗？也许我什至没有采取正确的方法。（在这种情况下，更改服务器行为不是一种选择……我必须处理重定向。）

我希望有人可以告诉我如何让 HttpClient 忽略该方案，或者至少保留它尝试访问的最终 URI。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:25:47.723

用于`HttpURLConnection`工作对我有用。当目标资源不是 HTTP 资源时，以下重定向无一例外地停止。

```
HttpURLConnection connection = (HttpURLConnection) new URL(mInitialUrl).openConnection();
connection.setInstanceFollowRedirects(true);
String location = connection.getHeaderField("location"); 
```

# wpf - 在绑定的 ListBox 之外绑定一个 Button

> ID：14886314
> 
> 赞同：1
> 
> 时间：2013-02-15T00:04:59.353
> 
> 标签：wpf, xaml, data-binding, wpf-controls, mvvm-light

如何在绑定的 ListBox 之外绑定我的按钮？

这个列表框包含我的搜索结果，每个搜索结果都有一个“X”按钮，应该删除搜索历史项目。

![在此处输入图像描述](../Images/2f4bec54b0e04be9e29415933ba9e6e8.png)
这是我的列表框“X”按钮的预览， 仅当我将鼠标悬停在某个项目上时才会出现

这是我的 XAML

```
<ListBox x:Name="listHistory" ItemsSource={Binding SearchHistory.SearchHistory} BorderThickness="0" Margin="0" Padding="0" HorizontalContentAlignment="Stretch">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <!-- this binds to a string in ObservableCollection<string> -->
                <TextBlock Text="{Binding }" />

                <!-- this should bind to SearchHistory.Command_DeleteHistoryItem -->
                <!-- currently, this Command="{Binding SearchHistory.Command_DeleteHistoryItem}" doesn't work
                     System.Windows.Data Error: 40 : BindingExpression path error: 'SearchHistory' 
                     property not found on 'object' ''String' (HashCode=-1127982548)'. 
                     BindingExpression:Path=SearchHistory.Command_DeleteHistoryItem; 
                     DataItem='String' HashCode=-1127982548); 
                     target element is 'Button' (Name=''); 
                     target property is 'Command' (type 'ICommand')
                -->
                <Button Command="{Binding SearchHistory.Command_DeleteHistoryItem}" Grid.Column="1" HorizontalAlignment="Right" x:Name="btnDeleteHistoryItem" Content="r" FontFamily="Marlett" Style="{DynamicResource ButtonStyle}" Visibility="Hidden" Opacity="0.75" />
            </Grid>

            <DataTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Visibility" TargetName="btnDeleteHistoryItem" Value="Visible" />
                </Trigger>
            </DataTemplate.Triggers>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

这是我的 ViewModel

```
public class ViewModel_SearchHistory : ViewModelBase
{
    ObservableCollection<string> _SearchHistory = new ObservableCollection<string>();
    public ObservableCollection<string> SearchHistory
    {
        get { return this._SearchHistory; }
        set
        {
            if (this._SearchHistory != value)
            {
                this._SearchHistory = value;
                base.RaisePropertyChanged("SearchHistory");
            }
        }
    }

    public ViewModel_SearchHistory()
    {
        this.Command_DeleteHistoryItem = new RelayCommand(DeleteHistoryItem);
    }

    public ICommand Command_DeleteHistoryItem
    {
        get;
        internal set;
    }

    public void DeleteHistoryItem()
    {
        Debug.WriteLine("blah");
    }
} 
```

问题有这个错误

> “System.Windows.Data 错误：40：BindingExpression 路径错误：在 'object' ''String' (HashCode=-1127982548) 上找不到 'SearchHistory' 属性。BindingExpression:Path=SearchHistory.Command_DeleteHistoryItem; DataItem='String' ( HashCode=-1127982548); 目标元素是 'Button' (Name=''); 目标属性是 'Command' (类型 'ICommand')"

这告诉我，WPF 正在寻找**SearchHistory.Command_DeleteHistoryItem**在**ObservableCollection<string> SearchHistory** .. 但是不，我必须在我的**ViewModel**中绑定命令，而不是在**ObservableCollection<string> SearchHistory**

我在想有一个像这样的新模型

```
public class Model_HistoryItemDetail
{
    public string Item { get; set; }
    public ICommand Delete { get; internal set; }

    public Model_HistoryItemDetail()
    {
        this.Delete = new RelayCommand(DeleteItem);
    }

    public void DeleteItem()
    {
    }
} 
```

在我的 SearchHistory ObservableCollection 中像这样

```
ObservableCollection<Model_HistoryItemDetail> _SearchHistory = new ObservableCollection<Model_HistoryItemDetail>();
public ObservableCollection<Model_HistoryItemDetail> SearchHistory
{
    get { return this._SearchHistory; }
    set
    {
        if (this._SearchHistory != value)
        {
            this._SearchHistory = value;
            base.RaisePropertyChanged("SearchHistory");
        }
    }
} 
```

现在的问题是，如果我这样做了，我该如何删除该项目？

* * *

那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:18:20.393

```
<Button Command="{Binding DataContext.Search.Command_DeleteHistoryItem,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBox}}}"/> 
```

您需要使用[RelativeSource](http://msdn.microsoft.com/es-ar/library/ms743599.aspx)来爬上 Visual Tree 并获取对 ListBox 本身的引用，然后您可以获得它的`DataContext`，这应该是您的 ViewModel。

# python - 在 for 循环中可以理解 python 列表吗？

> ID：14886324
> 
> 赞同：0
> 
> 时间：2013-02-15T00:05:49.867
> 
> 标签：python, list-comprehension, rhino3d

考虑下面 Rhino v.5 中的这个 python 列表理解代码：

```
for j in range(1,3):
    globals()["objlist" + str(j)] = [rs.OrientObject(obj, [rs.PointCoordinates(x) for x in objlist[1:4]], [rs.PointCoordinates(x) for x in objlist[1+ j*3:4+ j*3]], 1) for obj in objlist] 
```

因为你们中的很多人都不知道我在这里调用的 rhinoscriptsyntax 命令：

```
rs.OrientObject  and rs.PointCoordinates 
```

我希望你能阅读其余的语法，因为问题在于列表理解而不是 rhinoscriptsyntax。

我没有开始工作的是列表切片代码中的第二个“j”：

```
objlist[1+ j*3:4+ j*3] 
```

我只得到 j=1 的结果，而不是 j=2 的结果，尽管我在 range(1,3) 的循环中使用 aj

在这种情况下，'for j in range(1,3)' 是否根本不起作用，它是否仅适用于 '=' 的左侧，我将它用于 'objlist + str(j)'或者它根本不应该与列表理解一起使用，我应该找到一种方法来用列表理解重写所有内容？

ps 即使我用字典解决了 globals() 问题，我仍然需要 j 以便在每次迭代时对不同范围的列表进行切片。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:17:08.757

好吧，那部分工作正常：

```
>>> objlist = range(10)
>>> for j in range(1,3):
...   print objlist[1+ j*3:4+ j*3]
... 
[4, 5, 6]
[7, 8, 9] 
```

请注意，由于您编写循环的方式，`j`等于的情况`1`将仅适用于您的变量`objlist1`，而`j`等于的情况`2`将仅适用于您的变量`objlist2`。这就是让你困惑的地方吗？

我认为您还应该重构它，如果理解将是这么长的一行，那么最好使用显式循环而不是一直尝试巧妙地使用列表理解。而且，是的，你应该在这里使用字典而不是乱用，`globals()`但我想你已经知道了。

# compilation - 为什么代码块不使用我的项目选项？

> ID：14886328
> 
> 赞同：1
> 
> 时间：2013-02-15T00:06:13.570
> 
> 标签：compilation, codeblocks

我做了所需要的，右键单击项目名称，单击构建选项...选择将目标选项附加到项目选项（我也尝试过仅使用项目选项）。

问题是，我有一个定义和一些编译器标志集，但是当它编译时它不会在命令行上显示它们。

```
mingw32-g++.exe -L"C:\Documents and Settings\Zirgon\Bureau\GSERVER\projects\miniupnpc" -o ..\..\bin\gserver2.exe obj\Release\adler32.o obj\Release\blocksort.o obj\Release\bz2compress.o obj\Release\bzlib.o obj\Release\CEncryption.o obj\Release\CFileQueue.o obj\Release\CFileSystem.o obj\Release\CLog.o obj\Release\compress.o obj\Release\CPluginManager.o obj\Release\crc32.o obj\Release\crctable.o obj\Release\CSettings.o obj\Release\CSocket.o obj\Release\CString.o obj\Release\CTranslationManager.o obj\Release\CUPNP.o obj\Release\CWordFilter.o obj\Release\decompress.o obj\Release\deflate.o obj\Release\gzclose.o obj\Release\gzlib.o obj\Release\gzread.o obj\Release\gzwrite.o obj\Release\huffman.o obj\Release\infback.o obj\Release\inffast.o obj\Release\inflate.o obj\Release\inftrees.o obj\Release\IUtil.o obj\Release\main.o obj\Release\md5.o obj\Release\randtable.o obj\Release\TAccount.o obj\Release\TLevel.o obj\Release\TLevelBaddy.o obj\Release\TLevelBoardChange.o obj\Release\TLevelChest.o obj\Release\TLevelHorse.o obj\Release\TLevelItem.o obj\Release\TLevelLink.o obj\Release\TLevelSign.o obj\Release\TMap.o obj\Release\TNPC.o obj\Release\TPlayer.o obj\Release\TPlayerLogin.o obj\Release\TPlayerNC.o obj\Release\TPlayerProps.o obj\Release\TPlayerRC.o obj\Release\trees.o obj\Release\TServer.o obj\Release\TServerList.o obj\Release\TWeapon.o obj\Release\uncompr.o obj\Release\zutil.o    -lws2_32 -lIphlpapi 
```

里面应该有 -O3、-g 和 -DNO_BOOST。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:15:15.527

你很可能搞砸了你的项目设置。尝试重新创建项目文件，但这次不要调整选项的处理方式。如果它仍然混乱，那么重新安装代码块！

默认情况下，您会获得发布和调试。确保您正在检查的命令行是正确的。您是否在发布时设置选项，然后进行调试构建？

# matlab - 在 Matlab 中运行时获取用户输入

> ID：14886333
> 
> 赞同：4
> 
> 时间：2013-02-15T00:06:38.120
> 
> 标签：matlab, input

我有一个我想输入的功能，但只有在用户想要的时候。例如，如果我有这个代码：

```
figure
amplitude = 10;
tic
i = 1;
while(1) 
    time = toc;
    values(i) = amplitude*sin(time);
    times(i) = time;
    plot(times, values)
    drawnow
    i = i+1;
end 
```

你会得到一个不断绘制的正弦波（就像一部蹩脚的电影）。我想要做的是允许用户随时改变波的幅度。那就是程序将继续运行，但如果用户输入`20`然后`Enter`可以更改幅度变量，并且正弦波将改变电影中的幅度。关于如何实现这一目标的任何指示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:58:16.930

您无法通过在控制台中输入数字来执行此操作，但您可以使用简单的 GUI 来执行此操作。谷歌搜索 Matlab 回调以查找示例。当 GUI 事件发生时，它会触发一个函数，您可以使用该函数来修改循环中的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T12:34:25.250

最好使用前面提到的 GUI 来完成，但如果你只想要控制台中的某些内容，我可以提供：

定期要求用户输入幅度然后以该幅度继续“电影”的脚本。它可以很容易地扩展以允许用户决定何时要求他输入下一个幅度变化。

```
clear
amplitude = 10;
i=1;
while(1) 
    time = i/1000;
    values(i) = amplitude*sin(time);
    times(i) = time;
    plot(times, values)
    drawnow
    i = i+1;
    if mod(i,3141) == 0
        keyboard
    end
end 
```

现在这将运行一段时间，然后要求您输入下一个幅度。请注意，您实际上可以一次发出多个命令。

```
amplitude = 20; return
amplitude = 1; return 
```

这将使下一个幅度为 20，之后的幅度为 1。请注意，向上箭头键是您的朋友。

# javascript - 重复凹凸贴图

> ID：14886337
> 
> 赞同：3
> 
> 时间：2013-02-15T00:07:02.070
> 
> 标签：javascript, three.js, webgl, bump-mapping

我正在尝试将凹凸贴图应用于平面，以使用 Three.js r55 创建一个模糊的感觉表面。

这是我的代码：

```
var mapHeight = THREE.ImageUtils.loadTexture("images/felt.png");
mapHeight.repeat.set(2, 2);
mapHeight.wrapS = mapHeight.wrapT = THREE.RepeatWrapping;
mapHeight.format = THREE.RGBFormat;

var groundMaterial = new THREE.MeshPhongMaterial({
    ambient: 0x008800, color: 0x008800, specular: 0x888888,
    shininess: 25, bumpMap: mapHeight, bumpScale: 10, metal: false
} );

scene.add(new THREE.Mesh(new THREE.PlaneGeometry(0.3, 0.3), groundMaterial)); 
```

请注意我如何将纹理设置为沿 x/y 轴重复两次。但是，我所看到的仅将纹理应用于一个象限：

![](../Images/12ac0569cf61c9091001327794d19451.png)

我希望使用夹子/重复包装（或任何名称）来实现这一点，但我在`RepeatWrapping`这里提出了要求。

如何让凹凸贴图在飞机上正确重复任意次数。

* * *

## 编辑 - 完整代码

我着手制作一个简单的复制案例。这是非常小的，并且再现了下面的图像（从稍微不同的相机角度）。输出具有相同的问题。

```
<!DOCTYPE html>
<html>
<head>
    <script src="scripts/libs/three.min.js" type="text/javascript"></script>
</head>
<body>
<div id="scene-container"></div>

<script>

    init();

    function init() {
        var camera, scene, renderer;

        scene = new THREE.Scene();
        scene.add( new THREE.AmbientLight( 0x555555 ) );

        var light = new THREE.DirectionalLight( 0x555555 );
        light.position.set( 0, 0, 10 );
        scene.add( light );

        var bumpMapTexture = THREE.ImageUtils.loadTexture( "images/felt.png", undefined, function () {
            requestAnimationFrame( function () {
                // render once texture has loaded
                renderer.render( scene, camera );
            } );
        } );
        bumpMapTexture.repeat.set( 2, 2 );
        bumpMapTexture.wrapS = bumpMapTexture.wrapT = THREE.RepeatWrapping;

        var groundMaterial = new THREE.MeshPhongMaterial( {
            ambient: 0x00AA00,
            color: 0x00AA00,
            bumpMap: bumpMapTexture
        } );

        scene.add( new THREE.Mesh( new THREE.PlaneGeometry( 3, 3 ), groundMaterial ) );

        camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.01, 100000 );
        camera.position.set( 0, 0, 3 );
        camera.lookAt( new THREE.Vector3( 0, 0, 0 ) );

        renderer = new THREE.WebGLRenderer( { antialias: true } );
        renderer.setSize( window.innerWidth, window.innerHeight );//        renderer.render(scene, camera);

        document.getElementById( 'scene-container' ).appendChild( renderer.domElement );
    }

</script>

</body>
</html> 
```

这链接到 Three.js r55（缩小版）。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T01:32:55.430

如果要重复纹理，则每个维度中的像素大小必须是 2 的幂（例如 512 x 256 ）。

如果你有一个diffuse`map`和a `bumpMap`，它们必须有相同的`offset/repeat`设置。例如，请参阅[此](https://stackoverflow.com/questions/14371385/can-a-three-js-material-have-separate-repeat-values-for-a-bump-map-and-a-texture/14372235#14372235)答案。

三.js r.55

# comparator - collections.binarySearch() 不适用于可比较的

> ID：14886342
> 
> 赞同：0
> 
> 时间：2013-02-15T00:07:56.740
> 
> 标签：comparator, comparable

按升序和降序对列表进行排序后，我想调用 binarySearch 方法。但它不起作用，因为我已经实现了可比性。

```
 class Student implements Comparable<Student>{
private int id;
private String name;

public Student(int id, String name){
    this.id = id;
    this.name = name;
}

public int getId(){
    return id;
}
public String getName(){
    return name;
}

@Override
public int compareTo(Student o) {

    int j = o.getId();
    int result = this.id - j;
    return result;
}

}
public class CollectionSearchDemo {

public static void main(String[] args) {

    List<Student> list = new ArrayList<Student>();
    list.add(new Student(3, "ouier"));
    list.add(new Student(2, "fdgds"));
    list.add(new Student(7, "kiluf"));
    list.add(new Student(1, "6trfd"));
    list.add(new Student(8, "hjgas"));
    list.add(new Student(5, "ewwew"));

    Collections.sort(list, new Comparator<Student>() {

        @Override
        public int compare(Student arg0, Student arg1) {

            return arg0.getId() - arg1.getId();
        }
    });

    Iterator iterator = list.iterator();
    while(iterator.hasNext()){
        Student student = (Student) iterator.next();
        System.out.print(student.getId()+":"+student.getName()+" ");
    }

    System.out.println("\nSorting in reverse order:");

//  Collections.reverse(list);
    Comparator<Student> collections = Collections.reverseOrder();
    Collections.sort(list, collections);

    Iterator iterator1 = list.iterator();
    while(iterator1.hasNext()){
        Student student = (Student) iterator1.next();
        System.out.print(student.getId()+":"+student.getName()+" ");
    }

    System.out.println("I want to do searching ");
    System.out.println("\n2 is at:"+Collections.binarySearch(list, 2, new Student()));
            // facing exception at this line.I don't know what to use as argument of                           binarySearch() method. 
}

} 
```

我可以通过实施比较器来做到这一点，但我的项目中有这样的要求请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:33:18.143

来自 Collections.binarySearch 的文档：

> 在进行此调用之前，列表必须根据其元素的自然顺序（如 sort(List) 方法）按**升序排序。**如果未排序，则结果未定义。

# cookies - 创建 cookie 后的 gwan 重定向

> ID：14886351
> 
> 赞同：1
> 
> 时间：2013-02-15T00:08:29.127
> 
> 标签：cookies, g-wan, url-redirection

对于我的表单验证页面，我想创建一个 cookie 并被重定向到另一个页面，但这不起作用。重定向可防止创建 cookie。你有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:05:15.250

一种方法是在登录页面上添加一个标志（查询参数），告诉它创建 cookie。

```
http://domain/page?create_cookie=true 
```

如果 create_cookie 存在，登陆页面将创建 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T17:10:19.427

一种方法是从 G-WAN 处理程序创建 cookie，绕过 servlet 或自动生成的重定向，但您也可以使用此方法：

```
#include "gwan.h" // G-WAN exported functions

int main(int argc, char *argv[])
{
   char redir[] = "Cookie: blah\r\n" // add a cookie in the response
                  "Location: 100.html\r\n\r\n";
   http_header(HEAD_ADD, redir, sizeof(redir) - 1, argv);

   return 301; // return an HTTP code (301:'Moved')
} 
```

# python - 每个类中的局部变量 - python 定时循环

> ID：14886352
> 
> 赞同：0
> 
> 时间：2013-02-15T00:08:34.840
> 
> 标签：python

我有一个从外部文件连续循环读取的python文件，我有很多不同的数据点正在读取，并且有一个类（fb），我正在调用它来提供每个点的位置（m1.x , m2.x 等....）文件每 30 秒循环一次。

我需要循环中的一个变量，它不会为我正在使用的每个实例重置。如果我在循环中定义它，它会被重置，如果我使用全局变量，我不能将它用于多个变量。

因此，在下面的示例中，'test' 将所有实例作为全局变量计数，并且 self.X 在每次循环后重置。两者都不能满足我的需要。我试图使用线程，但这会导致我正在使用的模块出现更多问题。因此，如果有人对如何创建一个不会在循环的类中重置的局部变量有任何想法，那就太好了。谢谢。

```
test = 0  
s = sched.scheduler(time.time, time.sleep)

def loop1(sc): 
    class fb:
        def link(self):
            global test
            test = test + 1
            print test

            self.X = self.X + 1
            print self.X

    m1 = fb()

    m1.X = 1
    m1.link()

    m2 =fb()
    m2.X = 0
    m2.link()

    # Update loop every 10 second    
    sc.enter(10, 10, loop1, (sc,))

# end loop
s.enter(1, 1, loop1, (s,))
s.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:27:13.367

您不能创建每次都不会重置的局部变量。局部变量的全部意义在于它是局部的。因此，它不能是局部变量。

但它也不能是全局变量，因为您希望能够有两个不同的预定`loop1`函数，它们不会争夺同一个变量。

所以，你需要做的是重新组织事物，使循环实例本身就是一个事物，一个可以绑定变量的事物。有两种基本方法可以做到这一点。

首先，有传统的 OO 解决方案，即创建一个类，并使您的函数成为实例方法，然后可以访问实例变量。像这样的东西：

```
class Looper(object):
    def __init__(self):
        self.test = 0
    def loop1(self, sc):
        # same code as before, but with self.test instead of test

looper1 = Looper()
looper2 = Looper()
s.enter(1, 1, looper1.loop1, (s,))
s.enter(1, 1, looper2.loop1, (s,)) 
```

或者，还有创建闭包的传统 FP 解决方案：

```
def make_loop1():
    test = 0
    def loop1(sc):
        nonlocal test
        # same code as before, unchanged
    return loop1
looper1 = make_loop1()
looper2 = make_loop1()
s.enter(1, 1, looper1, (s,))
s.enter(1, 1, looper2, (s,)) 
```

然后有各种混合解决方案，您可以将函数本身视为 OO 对象（例如，`test`作为函数的属性进行赋值），或者通过将可变值作为参数传递来伪造闭包等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T02:03:02.973

我认为您想要一个对象**y**来计算循环的轮数，而不是每轮创建的实例数（= self.X），也不是自程序启动以来创建的实例的累积数（= test）

我有以下程序来获取仅在循环的每一圈递增一的对象**y 。**它需要在回合开始时创建一个全新的类。该指令

```
fb = type('fb',(object,),{'__init__':initer,
                              'link':linker,
                              'CLASSIES':0}) 
```

是否创建了一个全新的类。所创建的类的显示证明了这一点：`print 'id(fb) == %d' % id(fb)`
对象的身份是它在内存中的位置。如果不是同一个id，就不是同一个对象：

```
import sched,time

test = 0  
s = sched.scheduler(time.time, time.sleep)

Y = 2000

def initer(self):
    global test,Y
    if self.__class__.CLASSIES == 0:
        Y += 1
        self.__class__.CLASSIES += 1

def linker(self):
    global test,Y
    test = test + 1
    self.X = self.X + 1
    print 'Y == %d' % Y
    print 'test == %d     self.X == %d' % (test,self.X)

def loop1(sc):
    fb = type('fb',(object,),{'__init__':initer,
                              'link':linker,
                              'CLASSIES':0})
    print '--------'
    print 'id(fb) == %d' % id(fb)
    m1 = fb()
    m1.X = 0
    m1.link()
    print 
    m2 =fb()
    m2.X = 1
    m2.link()
    print 
    m3 =fb()
    m3.X = 2
    m3.link()
    print '--------'

    # Update loop every 10 second
    sc.enter(10, 10, loop1, (sc,))

# end loop
s.enter(1, 1, loop1, (s,))
s.run() 
```

显示

```
--------
id(fb) == 18976648
Y == 2001
test == 1     self.X == 1

Y == 2001
test == 2     self.X == 2

Y == 2001
test == 3     self.X == 3
--------
--------
id(fb) == 13818640
Y == 2002
test == 4     self.X == 1

Y == 2002
test == 5     self.X == 2

Y == 2002
test == 6     self.X == 3
--------
--------
id(fb) == 18970384
Y == 2003
test == 7     self.X == 1

Y == 2003
test == 8     self.X == 2

Y == 2003
test == 9     self.X == 3
--------
--------
id(fb) == 18970864
Y == 2004
test == 10     self.X == 1

Y == 2004
test == 11     self.X == 2

Y == 2004
test == 12     self.X == 3
--------
--------
id(fb) == 18971736
Y == 2005
test == 13     self.X == 1

Y == 2005
test == 14     self.X == 2

Y == 2005
test == 15     self.X == 3
--------
--------
id(fb) == 18957224
Y == 2006
test == 16     self.X == 1

Y == 2006
test == 17     self.X == 2

Y == 2006
test == 18     self.X == 3
--------
.
.
.
etc 
```

我只能通过上述方式获得这个结果。
在每回合结束时删除`fb`是不够的，因为您将看到是否运行以下代码。它是您的代码，带有更多指令，具有`Y`和显示`id(fb)`. 你会看到``` an`id(fb)`` 从一个回合到另一个回合保持不变。

```
import sched,time

test = 0  
s = sched.scheduler(time.time, time.sleep)

Y = 2000

def loop1(sc):
    class fb:
        def link(self):
            global test,Y
            test = test + 1
            self.X = self.X + 1
            print 'Y == %d' % Y
            print 'test == %d     self.X == %d' % (test,self.X)
    print 'id(fb) == %d' % id(fb)
    print '--------'
    m1 = fb()
    m1.X = 0
    m1.link()
    print 
    m2 =fb()
    m2.X = 1
    m2.link()
    print 
    m3 =fb()
    m3.X = 0
    m3.link()
    print '--------'
    del fb

    # Update loop every 10 second
    sc.enter(10, 10, loop1, (sc,))

# end loop
s.enter(1, 1, loop1, (s,))
s.run() 
```

据我所知，您的代码无法按您的意愿工作的原因是定义类的脚本部分称为“类的定义”（难以置信，不是吗？ ) 并且当解释器第一次传递这个类块时，它会**执行**它。
“类定义”的执行创建了一个类对象。创建类后，如果解释器再次通过类的代码块（= 类定义），则不会重新执行“定义”。
这里又出现了一个模棱两可的词：“定义”可以理解为“脚本中定义类的文本块”或“
我用于“类定义”的含义是文档中使用的含义：

> 类定义，如函数定义（def 语句）必须在它们生效之前执行。（您可以想象将类定义放在 if 语句的分支或函数内。）
> 
> [http://docs.python.org/2/tutorial/classes.html#class-definition-syntax](http://docs.python.org/2/tutorial/classes.html#class-definition-syntax)

所以，最后，我想说的是，在你的代码中，“fb 类的定义”只执行一次，然后总是同一个类是建模类，一个接一个地循环。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-15T00:31:30.080

我以前做过这个......制作一个模块，或者如果你觉得舒服的话，也许只是使用 __ init__.py

在 __init__.py 或 where.py

```
from somepackage.some_module import my_function
my_obj = my_function() 
```

在 your_awesome_module.py 你可以使用你的对象

```
from path.to.wherever import my_obj
# Do stuff with my_obj 
```

# hadoop - 哪个版本的 Sqoop 可与 Hadoop 0.20.2 配合使用？

> ID：14886353
> 
> 赞同：0
> 
> 时间：2013-02-15T00:08:37.793
> 
> 标签：hadoop, version, sqoop

Sqoop 2 是否适用于 Hadoop 0.20.2？

什么版本的sqoop最好下载？

1.4.2 还是 1.99.1 ？

谢谢！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:43:06.580

Sqoop 目前有两个主要分支。Sqoop 1 是支持 Hadoop 0.20、1.x、0.23 和 2.0.x 的较老的功能齐全且成熟的项目。您可以从[此处](http://www.apache.org/dist/sqoop/1.4.4/)下载这些位。请确保您下载以“_hadoop-0.20”结尾的文件，否则您会遇到奇怪的异常。

第二个分支是 Sqoop2，它是项目的重新设计。版本 1.99.3 提供了第一次剪辑。这个分支只支持 Hadoop 1.x 和 2.x，可以从[这里](http://www.apache.org/dist/sqoop/1.99.3/)下载。同样，您需要确保下载与您的 hadoop 发行版相匹配的版本。Hadoop 1.x 的构建有可能在 0.20.2 上运行，并且这些版本没有那么不同，但是没有人证实这一点。

# html - HTML 中的换行符如何影响结果页面的间距？

> ID：14886354
> 
> 赞同：0
> 
> 时间：2013-02-15T00:08:55.967
> 
> 标签：html, css

如果我这样做，我会在我的 index.php 文件中注意到：

```
<a href=""></a>
<a href=""></a> 
```

相对

`<a href=""></a><a href=""></a>`

当我使用换行符时，两者之间有更多的空间。我在哪里可以阅读更多关于此的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:14:07.260

在 HTML 规范中，任何数量的空白在显示时都会变成一个空白。

正在做：

```
<a href=""></a> <a href=""></a> 
```

等同于

```
<a href=""></a>
<a href=""></a> 
```

或者任意数量的回车或中间的空格。

如果你没有空白，那么两者就会相互碰撞。这允许在单词中间加粗等内容。

**编辑**

感谢 insertusernamehere，HTML 4.01 规范中的确切位置位于：

[http://www.w3.org/TR/html401/struct/text.html#h-9.1](http://www.w3.org/TR/html401/struct/text.html#h-9.1)

特别是，说：

> 请注意，源文档中单词之间的一系列空格可能会导致呈现完全不同的单词间距（PRE 元素的情况除外）。特别是，用户代理在产生输出字间距时应该折叠输入的空白​​序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:23:36.283

This doesn't *technically* have anything to do with HTML, which itself is just a way of marking up the page. It's actually the CSS styling that collapses white-space via the `white-space` property. That property gives you the following options:

> **normal** - This value directs user agents to collapse sequences of white space, and break lines as necessary to fill line boxes.
> 
> **pre** - This value prevents user agents from collapsing sequences of white space. Lines are only broken at preserved newline characters.
> 
> **nowrap** - This value collapses white space as for 'normal', but suppresses line breaks within text.
> 
> **pre-wrap** - This value prevents user agents from collapsing sequences of white space. Lines are broken at preserved newline characters, and as necessary to fill line boxes.
> 
> **pre-line** - This value directs user agents to collapse sequences of white space. Lines are broken at preserved newline characters, and as necessary to fill line boxes.

By default, it is set to normal. This will cause a browser to collapse any sequence of white-space into a single visible space when rendering the HTML structure. Since line breaks are a form of white-space, they also get collapsed.

See [16.6 White space: the 'white-space' property](http://www.w3.org/TR/CSS21/text.html#white-space-prop)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:18:22.720

在 PHP 中，就像 HTML 一样，换行符/回车符通常只是用来使您的文本更清晰。这样可以使将来的代码编辑变得简单易行。

不确定这是否完全相关，但我发现了另一篇与 PHP 格式相关的帖子：[PHP 编码风格 - 最佳实践](https://stackoverflow.com/questions/3350560/php-coding-style-best-practices)

# mplayer - 在 MPlayer slave 模式下获取当前正在播放的文件

> ID：14886358
> 
> 赞同：3
> 
> 时间：2013-02-15T00:09:05.187
> 
> 标签：mplayer, slave, ash

问题：我找不到任何方法来可靠地获取 MPlayer 播放列表中的当前播放文件。

这是我已经走了多远。这个工作的 ash 脚本监视一个带有当前播放列表路径的文本文件。当我更新文件时，脚本会关闭 MPlayer 的旧实例并使用新播放列表打开一个新实例：

```
# POLL PLAYLIST FILE FOR CHANGES
CURRENTPLAYLISTPATH=/home/tc/currentplaylist
INFIFO=/tmp/mplayer-in

CURRENTPLAYLIST="NEVERMATCHAPLAYLIST"
FIRSTRUN=1

while [ 1 ];
do
    # CHECK FOR NEW PLAYLIST
    NEWPLAYLIST=$(head -n 1 $CURRENTPLAYLISTPATH)
    if [[ "$NEWPLAYLIST" != "$CURRENTPLAYLIST" ]]; then
        if [ "$FIRSTRUN" == 0 ]; then
            echo "quit" > "$INFIFO"
        fi

        # CREATE NAMED PIPE, IF NEEDED
        trap "rm -f $INFIFO" EXIT
        if [ ! -p $INFIFO ]; then
            mkfifo $INFIFO
        fi

        # START MPLAYER
        mplayer -fixed-vo -nolirc -vc ffmpeg12vdpau,ffh264vdpau, -playlist $NEWPLAYLIST -loop 0 -geometry 1696x954 -slave -idle -input file=$INFIFO -quiet -msglevel all=0 -identify | tee -a /home/tc/mplayer.log &

        CURRENTPLAYLIST=$NEWPLAYLIST
        FIRSTRUN=0
    fi

    sleep 5;
done 
```

我最初的计划只是使用“-identify”标志并解析日志文件。这实际上非常有效，直到我需要截断日志文件以防止它变得太大。一旦我的截断脚本运行，MPlayer 就会停止写入日志文件：

```
FILENAME=/home/tc/mplayer.log
MAXCOUNT=100
if [ -f "$FILENAME" ]; then
    LINECOUNT=`wc -l "$FILENAME" | awk '{print $1}'`

    if [ "$LINECOUNT" -gt "$MAXCOUNT" ]; then
        REMOVECOUNT=`expr $LINECOUNT - $MAXCOUNT`
        sed -i 1,"$REMOVECOUNT"d "$FILENAME"
    fi
fi 
```

我已经搜索和搜索，但无法找到任何其他方式来获取当前正在播放的文件。

我尝试将输出通过管道传输到另一个命名管道，然后对其进行监视，但只能工作几秒钟，然后 MPlayer 完全冻结。

我也尝试过使用 bash（而不是 ash）并将输出传递到如下函数，但遇到了同样的冻结问题：

```
function parseOutput()
{
    while read LINE
    do
        echo "get_file_name" > /tmp/mplayer-in
        if [[ "$LINE" == *ANS_FILENAME* ]]
        then
          echo ${LINE##ANS_FILENAME=} > "$CURRENTFILEPATH"
        fi
        sleep 1
    done

}

# START MPLAYER
mplayer -fixed-vo -nolirc -vc ffmpeg12vdpau,ffh264vdpau, -playlist $NEWPLAYLIST -loop 0 -geometry 1696x954 -slave -idle -input file=/tmp/mplayer-in -quiet | parseOutput & 
```

我怀疑我在这里遗漏了一些非常明显的东西，所以任何帮助、想法、正确方向的观点都将不胜感激。

饲料

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-08T22:17:30.133

好吧，那我也发一下我的。

试试这个（假设只有一个实例在运行，比如在 fodder 的机器上）：

```
basename "$(readlink /proc/$(pidof mplayer)/fd/* | grep -v '\(/dev/\|pipe:\|socket:\)')" 
```

这可能是更安全的方法，因为文件描述符在所有系统上的顺序可能并不总是相同。但是，这*可以*缩短，但有一点风险：

```
basename "$(readlink /proc/$(pidof mplayer)/fd/*)" | head -1 
```

你可能也想安装这个：http: [//mplayer-tools.sourceforge.net/](http://mplayer-tools.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T20:51:31.603

好吧，我放弃了从 MPlayer 本身获取曲目。

我的“解决方案”可能太老套了，但可以满足我的需要，因为我知道我的机器只会运行一个 MPlayer 实例：

```
lsof -p $(pidof mplayer) | grep -o "/path/to/my/assets/.*" 
```

如果有人有更好的选择，我当然仍然有兴趣以正确的方式做到这一点，我只是无法让任何方法发挥作用。

饲料

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-05T12:46:03.997

您可以使用该`run`命令。

把这个放在`~/.mplayer/input.conf`：

```
DEL run "echo ${filename} ${stream_pos} >> /home/knarf/out" 
```

现在，如果您在播放文件时按下删除键，它将执行您所期望的操作，即将播放的当前文件和流中的位置附加到`~/out`文件中。您可以替换`echo`为您的程序。

有关更多信息，请参阅[slave mod 文档](http://www.mplayerhq.hu/DOCS/tech/slave.txt)（Ctrl-F somevar）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T23:25:07.493

关于从 MPlayer 获取属性

我使用了一个非优雅的解决方案，但它对我有用。

```
stdbuf -oL mplayer --slave --input=file=$FIFO awesome_awesome.mp3 |
{
while IFS= read -r line 
    do
    if [[ "${line}" == ANS_* ]]; then
        echo "${line#*=}" > ${line%=*}  # echo property_value > property_name
    fi
    done
} & 
mplayer_pid=&!

read filename < ./ANS_FILENAME
read timeLength < ./ANS_LENGTH

echo ($timeLength) $filename 
```

等等..

它在另一个过程中，这就是为什么我使用文件来带来属性

'stdbuf' 是为了不错过任何东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-19T08:12:09.963

我开始组建一个 bash 库来处理这样的任务。基本上，您可以通过将 mplayer 输出转储到文件来完成此操作。然后，您将该转储 grep 为“正在播放”，并使用尾部获取最后一个结果。这应该为您提供当前正在播放或上次完成播放的文件的名称。

看看我的 bash 代码。您需要根据需要修改该`playMediaFile`功能，但该`getMediaFileName`功能应该完全按照您的要求进行。你会在[我的 github](https://github.com/nbros652/mplayer-status)上找到代码。

# javascript - Jquery：触发超大功能之前的延迟？

> ID：14886359
> 
> 赞同：1
> 
> 时间：2013-02-15T00:09:06.467
> 
> 标签：javascript, jquery, function, delay, supersized

我有一个页面，上面有很多动画，还有 Supersized 插件 9large 背景图片轮播）。似乎为 Supersized 函数加载背景图像会稍微扰乱我的动画，使它们变得生涩。

我想知道是否有人知道延迟触发功能的方法？例如：

```
jQuery(function($).delay('1000'){

    $.supersized({

//Functionality
slideshow:1,        //Slideshow on/off
autoplay:1,     //Slideshow starts playing automatically
etc... 
```

我试过以上的组合没有效果。

我的目标是在触发插件之前完成所有其他动画。

有人对如何实现这一目标有任何建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:48:48.663

您可以使用 setTimeout 延迟函数的执行。

```
setTimeout( function() {
    $.supersized({});
}, 1000); 
```

不确定如何为页面设置动画，但如果您使用任何 jQuery 动画方法，您也可以尝试从回调中调用超大函数。例如：

```
$('selector').animate({
    left: '+=50'
    }, 2000, function() {
        $.supersized({});
}); 
```

这将在动画完成后调用您的超大函数。

# jquery - 刷新时的 HTML5 pushState 错误

> ID：14886360
> 
> 赞同：0
> 
> 时间：2013-02-15T00:09:11.450
> 
> 标签：jquery, html

我的网页中有以下代码：

```
$("#expertise").click(function(){ 
   $("#content").load('expertise.php'); 
   window.history.pushState('','Expertise','expertise.php'); 
}); 
```

（我对其他 jQuery 选择器有类似的代码。）

当我刷新页面时，它只是加载“expertise.php”页面，而网页的其他部分都丢失了。知道如何解决这个问题吗？
我看到“history.js”解决了这个问题，但我想自己修复这个代码。

# c - Visual Studio 2010 C和Ubuntu C的结构声明区别

> ID：14886365
> 
> 赞同：2
> 
> 时间：2013-02-15T00:09:50.850
> 
> 标签：c, visual-studio-2010

我一直在努力学习 Zed Shaw 的“Learn C the Hard Way”在线课程。我在尝试使用 Visual Studio 2010 中的 c 编译器编译 ex17 时遇到了一个问题。我总是从代码的第 100 行左右得到一个错误。但是，当我尝试在使用 Ubuntu 虚拟机时编译完全相同的文件时，代码编译得很好。错误在以下代码中的“{.id”处生成，其中编译器在“.”处生成错误。有人可以解释为什么这个错误发生在一个编译器而不是另一个编译器中吗？既然发生在windows环境下，以后怎么避免呢？

```
void Database_create(struct Connection *conn)
{
int i = 0;

for( i = 0; i < MAX_ROWS; i++) {
    // Make Prototype to initialize
    struct Address addr = {.id = i, .set = 0}; //Syntax error generated here
    // then assign it
    conn->db->rows[i] = addr;
        }
 } 
```

注意：无论是否激活了 C 编译器开关，这都会在 Visual Studio 命令提示符下发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:17:45.990

`struct Address addr = {.id = i, .set = 0};`是 C99 构造 - 具体来说，`{.id = i, .set = 0}`初始化程序是“指定初始化程序”。

MS VC++ 通常不支持 C99 结构。在某些情况下，您可以通过编译为 C++ 来解决此问题，因为 C++ 支持几个常见的 C99 功能（例如允许在块中的语句后声明）。但是，指定的初始化器也不是 C++ 的一部分。

您要么需要在 Windows 上使用支持 C99 的编译器（例如 MinGW 的 GCC），要么修改代码以与 C90 兼容。如果没有太多 C99 特定的东西，那可能不会太难：

```
struct Address addr = {0};
addr.id = i; 
```

# java - 如何从struts url标签中检索值并将其传递给servlet

> ID：14886369
> 
> 赞同：1
> 
> 时间：2013-02-15T00:11:15.217
> 
> 标签：java

嗨，我有一个带有以下代码的 jsp。该文件有struts标签库

```
<s:iterator value="TpData.vhp.actvh" var= "veh" status = "hellostatus">
        <tr>
           <s:url var = "ShowInfoAction" value="%{urlInfo.actionurl}" >
              <s:param name = "hereInfo" value="#someclass.method"/>
              <s:param name ="pincode" value="againsomeclass.pincode"/>
            </s:url>
         </tr>
</s:iterator> 
```

参数名称 ="hereInfo" 具有唯一值。由于这是在迭代器中，因此构造的 url 将具有不同的参数。由于这个 url 是在 jsp 中构造的，我希望它被传递给动作类。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:27:09.713

如果您希望将一组名称相似的属性添加到映射中，请使用映射参数名称，但索引是类型化的（例如，整数、字符串等）

例如（来自记忆，但很接近）：

```
<s:param name="hereInfo[%{hellostatus.index}]" value="#someclass.method"/> 
```

或者更常见的商业模式 ID 等。

# php - 我的控制器不工作

> ID：14886370
> 
> 赞同：1
> 
> 时间：2013-02-15T00:11:23.690
> 
> 标签：php, zend-framework

我在 my.phpcloud.com 上运行 Zend Framework 应用程序（所以服务器配置应该没问题...）

索引页面工作正常，我修改了 application/controllers/IndexController.php 如下：

```
class IndexController extends Zend_Controller_Action
{
    public function indexAction()
    {
        $this->view->assign('hello', 'hello world!');
    }
} 
```

在 application/views/scripts/index/index.phtml 我打印 $this->hello 一切正常。

但是如果我创建一个新的控制器，比如 application/controllers/UserController.php

```
class UserController extends Zend_Controller_Action
{
    public function indexAction()
    {
        $this->view->assign('name', 'Albert');
    }
} 
```

我在 application/views/scripts/user/index.phtml 中创建了视图，并像在索引视图中一样打印 $this->name。

但是当我访问时，`http://myapp/user`我得到一个 Not Found 错误......有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:33:50.953

1) 检查用户控制器的文件名是否包含第一个大写字母 UserController.php（不是 userController.php）

2) 检查 .htaccess 文件是否有正确的重写规则

3）尝试`http://myapp/User`（用户大写首字母）

4) 检查是否启用了默认路由。

5）您是否创建并启用了错误控制器？

我认为配置中存在一些问题，可能在您的引导程序或 config.ini 中

# c# - 始终将 data[0] 作为最新数据访问

> ID：14886372
> 
> 赞同：0
> 
> 时间：2013-02-15T00:11:30.683
> 
> 标签：c#

我有一个包含一百万个元素的数组，我将通过将当前索引设置为“现在”并将其递增以模拟新数据的输入，将其模拟为实时数据。

我将对现在的数据和过去的数据 X 条进行大量计算。

我想知道是否有一种方便的方法可以将其抽象为在 someDataType[0] 和 1 bar 之前访问今天的数据，如 someDataType[1] 等等？

我是编程新手，所以我不确定什么是可能的，什么是不可能的。理想情况下，这种数据类型不必将数据从数组复制到数据类型，而是可以存储所有数据本身并跳过数组或以某种方式指向数组。它肯定必须能够以与数组相同的方式访问数据，而不必像列表那样遍历自身以达到某个点。

我真的不知道这是否可能以任何方式、形状或形式出现。所以我问。感谢您的任何意见！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:46:18.210

首先，如果您想添加新项目，那么直接使用数组可能不是最佳选择（除非最新项目应该覆盖最旧项目）。更好的选择是`List<T>`.

现在，您要创建的是一个“反转”集合：它将包含一个`List<T>`和：

*   它的索引器将访问后备列表中的反向索引
*   它的 add 方法（可能被调用`AddFirst()`）将添加到列表的末尾
*   它的`GetEnumerator()`方法将返回反向枚举

随着所有这些要求的充实，代码几乎可以自己编写：

```
class AddFirstList<T> : IEnumerable<T>, IReadOnlyList<T>
{
    private readonly List<T> m_list = new List<T>();

    public void AddFirst(T item)
    {
        m_list.Add(item);
    }

    public IEnumerator<T> GetEnumerator()
    {
        return Enumerable.Reverse(m_list).GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public int Count
    {
        get { return m_list.Count; }
    }

    public T this[int index]
    {
        get { return m_list[Count - index - 1]; }
    }
} 
```

（如果您不在 .Net 4.5 上，请删除该`IReadOnlyList<T>`接口。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:45:40.557

听起来您需要对结构进行动态调整大小，因此可以[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)在 System.Collections.Generic 命名空间中找到一个不错的选择。

```
var list = new List<int>();
list.Add(1); // keep adding 
```

它像数组一样提供索引访问，但您可以根据需要继续添加元素。如果您想要做的只是快速检索最后一个元素（除了通过索引进行正常随机访问之外），您可以使用针对接口[优化](https://stackoverflow.com/questions/5595777/enumerable-lastt-and-c-sharp-arrays)`Last()`的扩展方法（并且是实现的）直接返回最后一个元素元素，而无需枚举整个序列。`IList<T>``List<T>`

但是，听起来您想要更类似于完全反向索引访问的东西。为此，您可能必须对其进行编码。为了可重用性，您可以将其作为项目中的扩展方法，并在您需要的任何地方使用它。像这样的东西应该适合你的需要。

```
public static class ListExtensions
{
    public static T FromEnd<T>(this IList<T> list, int position)
    {
        if (list == null || list.Count == 0)
        {
            throw new ArgumentException("list cannot be null or empty");
        }

        return list[(list.Count - 1) - position];
    }
} 
```

而且使用起来很简单。

```
var myList = new List<int>() { 1, 2, 3, 4, 5 };
int item = myList.FromEnd(1);
Debug.Assert(item == 4); 
```

当然，这里的问题是，如果你想在 a 中循环它，这并不适合`foreach`（你仍然可以使用标准`for`）。如果使用 foreach，您可以简单地循环使用`foreach (var item in myList.Reverse()) { }`，或者您可以使用 svick 的答案中编码的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:55:36.433

听起来您希望索引 0 是“当前数据”，而索引 1 是以前的数据。

您可以通过编写自己的封装百万元​​素数组的类来实现这一点。然后您可以指定索引`right now`并将其添加到每个索引中。例如：

```
public class DataArray
{
    readonly Object[] data;

    int rightNow;
    public int RightNow
    {
        get { return this.rightNow; }
        set { this.rightNow = value; }
    }

    public DataArrat(Object[] data)
    {
        // TODO: Check that data is not null.
        this.data = data;
    }

    // This is called an 'indexer':
    public Object this[int index]
    {
        get
        {
            // TODO: Check whether (index + this.rightNow) is in the valid range.
            return this.data[index + this.rightNow];
        }
    }
} 
```

现在您可以像这样使用它，例如：

```
// Initialize the DataArray:
Object[] millionElementArray /* = from somewhere, e.g. */ = new []
{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
var data = new DataArray(millionElementArray);

// Start at bar 8:
data.RightNow = 8;

// Use the data:
Object currentData = data[0];
Object futureData = data[-1];
Object pastData = data[1];

// Go to the next bar:
data.RightNow--;

// Use the data:
Object currentData = data[0];
Object futureData = data[-1];
Object pastData = data[1];

// Rinse and repeat... 
```

请注意，您应该替换`Object`为您正在使用的数据类型，或者使类通用。

# .htaccess - .htaccess 重定向 301 问题

> ID：14886374
> 
> 赞同：0
> 
> 时间：2013-02-15T00:12:00.807
> 
> 标签：.htaccess

我遇到了一个我似乎无法弄清楚的 htaccess 问题。

在我的网站上，我有几个页面在 url 中有 /wiget/。

.com/wiget/.com/wigeta/.com/wigeb/.com/wigetc/.com/shop/wigeta/.com/shop/wigetb/

在我的 htaccess 文件中，我使用以下内容：

*   重定向 301 /wiget/ [http://www.site.com/content/wiget/](http://www.site.com/content/wiget/)
*   重定向 301 /wigeta/ [http://www.site.com/content/wigeta/](http://www.site.com/content/wigeta/)
*   重定向 301 /wigetb/ [http://www.site.com/content/wigetb/](http://www.site.com/content/wigetb/)
*   等等。

正在发生的事情是，每个带有 /wiget/ /wigeta/ /wigetb/ 的 URL 都被错误地重定向。例如，这些网址：

*   .com/shop/wiget/ 正在发送到 .com/shop/content/wiget/
*   .com/shop/wigeta/ 正在发送到 .com/shop/content/wigeta/
*   .com/shop/wigetb/ 正在发送到 .com/shop/content/wigetb/

我想要的只是将 .com/wiget/ 或 .com/wigeta/ 或 .com/wigetb/ 重定向到其 .com/content/wiget{x}/ 页面的页面

我是 htaccess 的新手，我无法提出解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:32:11.067

所以基本上你想指定你的网址必须以`/wiget/`

```
RewriteRule ^/wiget/ /content/wiget/ [L,R=301] 
```

# gwt-maven-plugin - 使用 gwt-maven-plugin 生成的项目：eclipse

> ID：14886380
> 
> 赞同：2
> 
> 时间：2013-02-15T00:12:11.587
> 
> 标签：gwt-maven-plugin

我用 mvn archetype:generate -DarchetypeGroupId=org.codehaus.mojo -DarchetypeArtifactId=gwt-maven-plugin -DarchetypeVersion=2.5.0 创建了一个 GWT 项目

在 eclipse juno 中导入项目。

我得到的第一个错误是：生命周期配置未涵盖插件执行：org.codehaus.mojo:gwt-maven-plugin:2.5.0:i18n（执行：默认，阶段：生成源）

在 pom 文件中。

```
<plugin>
<groupId>org.codehaus.mojo</groupId>
<artifactId>gwt-maven-plugin</artifactId>
<version>2.5.0</version>
<executions>
  <execution>
    <goals>
      <goal>compile</goal>
      <goal>test</goal>
      <goal>i18n</goal>
      <goal>generateAsync</goal>
    </goals>
  </execution>
</executions>
<!-- Plugin configuration. There are many available options, see 
  gwt-maven-plugin documentation at codehaus.org -->
<configuration>
  <runTarget>dashboard.html</runTarget>
  <hostedWebapp>${webappDirectory}</hostedWebapp>
  <i18nMessagesBundle>com.farheap.jsi.dashboard.client.Messages</i18nMessagesBundle>
</configuration> 
```

该代码还包含一个无法找到的 GreetingServiceAsync。

```
private final GreetingServiceAsync greetingService = GWT.create(GreetingService.class); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-01T01:35:40.433

你有两个选择：

1.  您可以将特殊的（非平凡的）org.eclipse.m2e:lifecycle-mapping 插件配置添加到您的 POM。请参阅此处：[为什么我会收到“使用 GWT 的生命周期配置未涵盖插件执行”错误？](https://stackoverflow.com/questions/8523737/why-am-i-receiving-a-plugin-execution-not-covered-by-lifecycle-configuration-wi)

2.  或者在 Eclipse POM 编辑器中将此问题标记为忽略，然后调用`mvn gwt:i18n`. 您可以为它创建一个方便的快捷方式启动器。Eclipse 会记住您决定忽略哪些内容，并将其永久存储到项目的 .settings 目录中。

在典型的开发过程中，本地化消息不会经常更改，因此第二个选项通常更方便并加快构建速度。

这适用于大多数 GWT 插件目标！即使是 GWT 编译也很少需要，因为 DevMode 直接使用 Java 代码而不是生成的 JavaScrips。所以在实践中，你必须在开始时至少调用一次所有目标，然后在没有它们的情况下存活数周；基本的 Eclipse JDT 编译就足够了。

如果您后来决定不在您的真实应用程序中使用 GWT 本地化框架，那么您可以从 POM 中完全删除目标 i18n。调用目标 i18n 生成`{project}/target/generated-sources/gwt/my/code/client/Messages.java`(vanilla) 所需的文件`Sample.java`。

> 该代码还包含一个无法找到的 GreetingServiceAsync。

`mvn install`从命令行或`Eclipse Run as -> Maven install`菜单运行构建。在命令行的情况下`mvn gwt:generateAsync`应该足够了。这个目标产生`{project}\target\generated-sources\gwt\my\code\client\GreetingServiceAsync.java`了，这就是你所缺少的。Eclipse 没有自动为您执行此操作，因为它被先前的*i18n 问题所阻止，而生命周期配置未涵盖该*问题。所以是的，你提到的问题是相关的。

# python - 用于编辑特定用户的管理员

> ID：14886385
> 
> 赞同：0
> 
> 时间：2013-02-15T00:12:26.090
> 
> 标签：python, django

我有用户注册到我的网站。我希望能够编辑他们的“出价”。基本上，我希望能够转到 admin/user/user-bid/73 ，其中 73 是特定用户的 ID，并且能够编辑他们的出价信息。我怎样才能做到这一点？

我在 admin.py 中有以下内容：

```
class UserBidAdmin(admin.ModelAdmin):
    def queryset(self, request):
        return self.model.objects.filter(user = request.user)

create_modeladmin(UserBidAdmin, name='user-bid', model=Bid)

def create_modeladmin(modeladmin, model, name = None):
    class  Meta:
        proxy = True
        app_label = model._meta.app_label

    attrs = {'__module__': '', 'Meta': Meta}

    newmodel = type(name, (model,), attrs)

    admin.site.register(newmodel, modeladmin)
    return modeladmin 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:46:57.380

```
class BidInline(admin.TabularInline):
    model = Bid

class UserWithProfileAdmin(UserAdmin):
    ..........

    inlines = [BidInline]

admin.site.unregister(User)
admin.site.register(User, UserWithProfileAdmin) 
```

# html - 有没有将jade转换为html的代码编辑器插件？

> ID：14886390
> 
> 赞同：2
> 
> 时间：2013-02-15T00:12:47.543
> 
> 标签：html, pug

我是 *jade* 的新手，所以我很难用它来设计网页。我需要测试代码并不断查看结果。

我想知道有没有办法在代码编辑器中将jade转换为html，反之亦然？有没有插件？不管是什么代码编辑器，但如果有 sublime 插件对我来说更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T15:03:02.060

您可以尝试使用单个视图创建一个专用的[Node](http://nodejs.org) + [Express应用程序，然后粘贴到您的](http://expressjs.com)[玉](https://github.com/visionmedia/jade)中，然后在浏览器中进行检查。

带有交互式示例的 Jade 语法文档：

[http://naltatis.github.com/jade-syntax-docs/](http://naltatis.github.com/jade-syntax-docs/)

使用包控制可以使用[Sublime Text 2](http://www.sublimetext.com/2)的“Jade”包。当与体面的配色方案结合使用时，语法错误非常明显。

ST2 封装控制：

[http://wbond.net/sublime_packages/package_control](http://wbond.net/sublime_packages/package_control)

当前的“翡翠”捆绑包/包：

[https://github.com/davidrios/jade-tmbundle](https://github.com/davidrios/jade-tmbundle)

包控制的已知存储库：

[https://github.com/wbond/package_control_channel/blob/master/repositories.json](https://github.com/wbond/package_control_channel/blob/master/repositories.json)

在线 html 到玉转换器：

[http://html2jade.aaron-powell.com/](http://html2jade.aaron-powell.com/)

[http://www.htmltojade.com/](http://www.htmltojade.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:00:28.127

玉本身会自动将玉文件转换为 html。但请记住，jade 是一种带有解释命令的模板语言，因此不是从 jam 到 html 的一对一转换。

顺便说一句，这里有一个工具可以将 html 转换为翡翠：[https ://github.com/donpark/html2jade](https://github.com/donpark/html2jade)

可能你可以从 SublimeText 运行它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-12T11:18:45.673

从 alphapixels检查[prepros](http://alphapixels.com/prepros/)。它编译了jade、haml、sass/scss、less和coffee。它实时监视您的文件的更改和编译，因此**您可以使用您选择的代码编辑器**。这对我来说可以。

# c# - 通过 Web 服务上传文件：不支持给定的文件路径格式

> ID：14886392
> 
> 赞同：1
> 
> 时间：2013-02-15T00:12:51.500
> 
> 标签：c#, file, upload, asmx

我正在尝试使用网络服务将文件上传到网络服务器。问题是我每次尝试使用引用的 Web 方法时都会收到“不支持给定文件格式”的异常。

这是我的应用程序中的代码：

```
Service1 upload = new Service1();
FileStream fs = new FileStream("ciao.txt", FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
BinaryReader br = new BinaryReader(fs);
int length = new FileInfo("ciao.txt").Length;
byte[] buffer = br.ReadBytes((Int32)length);            
upload.WriteFile(buffer, "ciao.txt"); // <-- Exception
br.Close();
fs.Close(); 
```

这是[http://MySite.somee.com/WebServices/WebService1/upload.asmx.cs](http://MySite.somee.com/WebServices/WebService1/upload.asmx.cs)中的代码（我的网站实际上并不称为 MySite）

```
[WebService(Namespace = "http://MySite.somee.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
public class Service1 : System.Web.Services.WebService
{
[WebMethod]
public void WriteFile(byte[] buffer, string FileName)
{            
StreamWriter sw = new StreamWriter(FileName, false);
sw.Write(buffer.ToString());
sw.Close();
}
} 
```

我究竟做错了什么？

编辑：我将我的网络服务代码更改为如下所示

```
 [WebMethod]
    public void UploadFile(byte[] f, string fileName)
    {
            MemoryStream ms = new MemoryStream(f);
            FileStream fs = new FileStream(Path.Combine(System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath, "/ciao.txt");, FileMode.Create)
            ms.WriteTo(fs);
            ms.Close();
            fs.Close();
            fs.Dispose();
    } 
```

并相应地更新了我的客户

```
 FileInfo fInfo = new FileInfo("ciao.txt");
                FileStream fStream = new FileStream("ciao.txt", FileMode.Open, FileAccess.Read);
                BinaryReader br = new BinaryReader(fStream);
                long numBytes = fInfo.Length;
                byte[] data = br.ReadBytes((int)numBytes);
                br.Close();
                MyService.UploadFile(data, "ciao.txt");
                fStream.Close();
                fStream.Dispose(); 
```

这样我不会得到任何异常，但文件仍然没有创建，我在我的网站上寻找“ciao.txt”但找不到它。

有什么帮助吗？

编辑2：解决了！我的网站设置在框架 4.0 - 4.5 上，而我的程序是在框架 3.5 下编译的，只要我切换它工作的框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:21:38.447

Here is an article I found to be helpful in loading files into a database from a website:

[http://www.codeproject.com/Articles/48619/Reading-and-Writing-BLOB-Data-to-Microsoft-SQL-or](http://www.codeproject.com/Articles/48619/Reading-and-Writing-BLOB-Data-to-Microsoft-SQL-or)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:57:55.547

您的问题可能与此类似，并且已经回答：

[“不支持给定路径的格式。”](https://stackoverflow.com/questions/7348768/the-given-paths-format-is-not-supported-c-sharp)

# javascript - 使用jQuery测试具有属性的对象是否存在于数组中

> ID：14886398
> 
> 赞同：3
> 
> 时间：2013-02-15T00:13:40.760
> 
> 标签：javascript, jquery, arrays

有人可以告诉我检查对象数组中的对象是否具有的最佳方法`type`吗`11`？

下面是我所拥有的，但它会对数组中的每个对象发出警报，我可以检查整个数组并让它在最后只发出一次警报吗？

我见过像 grep 这样的方法，但我一直在尝试，但无法让它发挥作用。我正在使用 jQuery。

```
var x;
for (x = 0; x < objects.length; x++) {

    if (objects[x].type == 11) {
        alert("exists");
    } else {
        alert("doesnt exist");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:36:56.193

最好的方法是使用[Array.some](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)：

```
var exists = objects.some(function(el) { return el.type === 11 }); 
```

在链接中，还有一个不支持它的浏览器的垫片。

否则你可以迭代：

```
var exists = false;
for (var i = 0, el; !exists && (el = objects[i++]);)
    exists = el.type === 11; 
```

设置变量后，您`exists`可以执行以下操作：

```
if (exists) {
    // do something
} 
```

在循环之外，在这两种情况下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T00:16:32.840

您的代码实际上应该这样做。如果您担心*循环*将无用地继续，您可以通过调用来中止它`break;`

```
if(objects[x].type == 11){
    alert("exists");
    break;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:16:30.097

使它成为一个函数：

```
function hasObjWithType11(arr) {
    var x;
    for (x = 0; x < arr.length; x++) {
        if(arr[x].type == 11){
            return true;
        }
    }
    return false;
}

alert(hasObjWithType11([{type:1}, {type:11}]); // alerts true 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T00:18:16.460

这会做到的

```
var exists = false;
for (var x = 0; x < objects.length; x++) {
     if(objects[x].type == 11){
       exists = true;
       break;
     }
}
if(exists){
    alert("exists");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T00:20:36.797

您可以通过将搜索代码包装到单独的函数中来使搜索代码更具可重用性。这样，您可以将条件外部化以便于阅读：

```
function array_contains(a, fn)
{
    for (i = 0, len = a.length; i < len; ++i) {
        if (fn(a[i])) {
            return true;
        }
    }
    return false;
}

if (array_contains(objects, function(item) { return item.type == 11; })) {
    alert('found');
} 
```

你也可以使用[`Array.some()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)：

```
if (objects.some(function(item) {
  return item.type == 11;
})) {
    alert('exists');
} 
```

对于 IE < 9，请参阅 MDN 文档以获取模拟版本。

# jakarta-ee - 两个 EAR 和第三方 jar 库之间的 EJB 类依赖关系

> ID：14886399
> 
> 赞同：0
> 
> 时间：2013-02-15T00:13:42.743
> 
> 标签：jakarta-ee

我对整个 Java EE EJB 概念相当陌生。我已经对 EJB 进行了研究，但还没有找到解决问题的方法。

案例场景：

我在 EAR 1 上有远程 EJB 1，在 EAR 2 上有远程 EJB 2，其中 EJB 2 引用了第三方库 (XXX.jar)。EJB1 中的方法将通过其 bean 接口调用 EJB2 中的方法，该 bean 接口将输入发送到第三方库中的方法进行进一步处理。结果将通过 EJB1 远程方法反向返回给 EJB1。

我的问题是当我将包含 EJB2 远程接口的类库（EJB2.jar）添加到 EJB2 项目的类路径中时。EJB1 项目也将包含第三方 jar，因为它位于 EJB2.jar 中。我怎样才能避免这种情况？第三方 jar 应该只添加到 EJB2 项目类路径中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:09:36.407

我不确定你是如何打包所有东西的，但你不应该用 EJB 2 客户端 jar 打包第三方库/类。因此，从很少的信息中，我假设您有：

```
耳朵 1
|_lib
| |_EJB2Client.jar
|
|_EJB1.jar

耳朵 2
|_lib
| |_Thirdparty.jar
| |_EJB1Client.jar
|
|_EJB2.jar

```

所以我不认为你有问题 EAR1/EJB1 将引用第三方 jar。如果我正确理解了你的问题。听起来可疑的可能是你如何包装所有东西。如果您需要远程 EJB，您应该将所有客户端类放在一个 EJB-Client jar 中。另外请记住，如果您在同一个 JVM 中运行，则不需要使用远程 EJB。

# python - 检查用户是否使用 Flask 断开连接

> ID：14886400
> 
> 赞同：1
> 
> 时间：2013-02-15T00:13:55.647
> 
> 标签：python, flask

我正在尝试检查用户是否与我的网站断开连接，我将如何执行此操作？

我这样做是为了检查用户是否“在线”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T21:30:46.410

基本上，您无法判断用户已将您的站点留在服务器端。执行您想要实现的目标的常用方法是使用最后一个已知请求之后的时间限制作为在线/离线状态之间的截止点。

为了使这一点更准确，您可以在客户端设置一个执行常规 AJAX 轮询的脚本，如果您必须考虑到用户在他们最后一次请求之后很久才在线，而您的网站仍然在选项卡中打开。如果您必须检查用户是否激活了选项卡，请将该请求作为最近的鼠标或键盘事件的条件。

# php - PDO 语句的问题 - 一般错误

> ID：14886404
> 
> 赞同：0
> 
> 时间：2013-02-15T00:14:14.187
> 
> 标签：php, pdo

嘿伙计们，我有以下几点：

```
$newStatus = "Non-Active - Driver Chose Non-Compliance";

    $sql = "SELECT username,ATF FROM members WHERE username = 'test'";
    $getcsvuser = $DBH->prepare($sql);
    $getcsvuser->execute();
    while($row = $getcsvuser->fetch(PDO::FETCH_ASSOC)){

        $memusername = $row['username'];
        $memATF = $row['ATF'];
        if ($memATF != 0 || $memATF != "0")
        {
        $tsql = "SELECT username,status,memberview ,statuschangedate FROM csvdata WHERE memberview =:user";
        $tgetcsvuser = $DBH->prepare($tsql);
        $tgetcsvuser->execute(array(':user' => $memusername));
        while($trow = $tgetcsvuser->fetch(PDO::FETCH_ASSOC)){

            $csvstatus = $trow['status'];
            $csvusername = $trow['username'];
            $csvdate = $trow['statuschangedate'];
            echo $csvstatus;
            if($csvstatus == "Open" || $csvstatus == "Enrolled - Policyholder Follow-Up Required" || $csvstatus == "Enrolled - Employee Follow-Up Required" || $csvstatus == "Non-Active - Insurance Cancelled" || $csvstatus == "Non-Active, Unable to Monitor - Incidental Business use Exclusion" || $csvstatus == "Non-Active - Employee Not Covered Under Listed Policy" || $csvstatus == "Non-Active - PolicyHolder Cancelled Additional Interest")
            {
                try {
                $newsql = "update csvdata set status =:newstatus where statuschangedate < NOW() - INTERVAL :atf DAY AND username =:mem";
                $newgetcsvuser = $DBH->prepare($newsql);
                $newgetcsvuser->execute(array(':newstatus' => $newStatus, ':atf' => $memATF, ':mem' => $csvusername));
                while($qrow = $newgetcsvuser->fetch(PDO::FETCH_ASSOC)){
                    echo "working";
                }
                 } catch (PDOException $e) {
        print "Error!: " . $e->getMessage() . "<br/>";
        die();
    }
            }

        }
        }

    } 
```

一切都很好，除非我进入 try {} ..我收到一条错误消息说 SQLSTATE[HY000]：一般错误。

我要做的是让语句检查 statuschangedate，它的数据类型为 yy-mm-dd。看看他们的成员是否超过了他们设置的日期，如果是，则更改并更新该员工的状态。问题是这不起作用，我无法弄清楚原因。

我可以用手，非常感谢！

大卫

# objective-c - NSThread 内存泄漏

> ID：14886410
> 
> 赞同：0
> 
> 时间：2013-02-15T00:15:03.560
> 
> 标签：objective-c, cocoa, nsthread

我正在使用 NSThread 如下

```
NSThread * thread = [[NSThread alloc] initWithTarget:object selector:@selector(bg) object:nil];
[thread start]; 
```

稍后我想停止线程并释放对象，如下所示：

```
[thread cancel];
[object release]; 
```

这似乎工作正常。但是，当我查看泄漏工具时，我看到一些神秘的泄漏不是来自我的代码的任何地方（一个空的 NSArray）。当我查看 malloc 历史记录时，我看到 NSArray 是在“willChangeValueForKey”方法中分配的，该方法最终从我的 [object dealloc] 调用。它恰好将委托设置为零。该委托正在被观察（因此 willChangeValueForKey？）。[object dealloc] 从 [NSThread exit] 调用。

我的猜测是，这是因为 [thread cancel] 没有立即停止线程（毕竟它在不同的线程中）。然后我们在主线程上释放对象。这使得它的 retainCount 为 1。然后 NSThread 将在它真正减速时释放对象。看来这会导致泄漏。我尝试了这个快速更改来验证我的假设：

```
[thread cancel];

[NSThread sleepForTimeInterval:1];
// This makes it wait until the thread releases [object]

[object release]; 
```

问题：为什么让 NSThread 释放我的对象是不安全的？它是否与观察者代码在 dealloc 中不安全有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:49:02.920

您的主线程应该能够`[object release]`立即执行，您不必等到取消线程，甚至直到您启动它。 `initWithTarget:`隐式保留`object`和`cancel`隐式释放它。

为了分离线程的缘故，您不必保留`object`在主线程上以使其保持活动状态。

# image - 需要 Facebook 解决方案来为数千个页面刷新缓存的开放图形图像路径

> ID：14886418
> 
> 赞同：1
> 
> 时间：2013-02-15T00:15:55.587
> 
> 标签：image, debugging, caching, facebook-like, facebook-opengraph

我们已经用新的图像路径更新了我们的开放图形图像 (og:image) 元标记，但 Facebook 仍然显示我们网站的默认徽标图像——似乎是从我们最初的 Like 按钮实现中缓存的。我们指的是当用户单击“赞”按钮时在 Facebook 赞/分享对话框中显示的图像。

我们已经运行了一项自动化作业，让 Facebook 的调试工具（例如：[https](https://developers.facebook.com/tools/debug/og/object?format=json&q=http://www.domain.com) ://developers.facebook.com/tools/debug/og/object?format=json&q=http://www.domain.com ）抓取所有我们的页面具有更新的图像路径，但 Facebook 的调试工具（或站点）通过返回重定向到[http://www.facebook.com/unsupportedbrowser](http://www.facebook.com/unsupportedbrowser)来阻止我们的自动化工作。请注意，我们需要抓取大约 62,500 个页面，以便使用最新的图像路径刷新 og:image 元标记内容属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:19:04.763

我们的问题的解决方案实际上是通过将代理值传递给 Facebook 的调试器，以使 Facebook 不会将我们重定向到他们的“不支持的浏览器”页面，这反过来又导致请求不成功。

**cURL 用户代理解决方案**

`curl_setopt($ch,CURLOPT_USERAGENT,'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13');`

见：[http ://davidwalsh.name/set-user-agent-php-curl-spoof](http://davidwalsh.name/set-user-agent-php-curl-spoof)

# jquery-ui - 如何确保拖动元素克隆保留原始宽度

> ID：14886424
> 
> 赞同：7
> 
> 时间：2013-02-15T00:16:18.363
> 
> 标签：jquery-ui, jquery-ui-draggable

我正在使用 jQuery UI Draggable 来拖动一个`<div>`其宽度被计算为布局（`margin:auto;`）的一部分。

使用 拖动该元素时`helper:clone`，克隆也会获得`margin:auto;`样式，但不再受原始容器的约束。

结果：克隆`<div>`的宽度可能与原始宽度不同。

小提琴：http: [//jsfiddle.net/ericjohannsen/ajpVS/1/](http://jsfiddle.net/ericjohannsen/ajpVS/1/)

如何使克隆保持原件的宽度？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-10T10:00:26.047

乔恩的回答真的很好，但是当您在可拖动中有子元素时它不能正常工作。在这种情况下，`event.target`可以代表您的可拖动对象的孩子，并且您希望修改可拖动对象的`helper()`方法，例如：

```
$(".objectDrag").draggable({
  helper: function(e) {
    var original = $(e.target).hasClass("ui-draggable") ? $(e.target) :  $(e.target).closest(".ui-draggable");
    return original.clone().css({
      width: original.width() // or outerWidth*
    });                
  },
  ...
}); 
```

[如果没有这个](http://jsfiddle.net/0qksz70t/1/)，助手将表示在可拖动对象中单击的任何子元素（例如，单击“拖动 1”框中的浅蓝色区域内的 ）。[添加上面的附加逻辑](http://jsfiddle.net/0qksz70t/)可确保将可拖动元素用于帮助程序。希望对遇到类似情况的人有所帮助！

* * *

**注意*[`outerWidth`](http://jsfiddle.net/0qksz70t/2/)：如果原始元素已应用，您将需要使用`box-sizing: border-box`（感谢@jave.web 提出）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-15T01:05:21.393

您只需要在拖放时根据可拖动对象设置克隆元素的宽度和边距，使用`$(ui.draggable).clone().css({ ... });`

这是一个更新的小提琴，应该是你要找的。它还将保持辅助对象的宽度。[http://jsfiddle.net/ajpVS/2/](http://jsfiddle.net/ajpVS/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:30:50.710

我想我知道问题出在哪里......你在哪里：

```
<div style="width:50px"> 
```

它还需要包含在 objectDrag 类中：

```
<div class="objectDrag" style="width:50px;margin:auto; color:white;border:black 1px solid; background-color:#00A">Drag me</div> 
```

我希望这就是你的意思！

编辑：

嗨又快速浏览了一下 [http://jsfiddle.net/He2KZ/1/](http://jsfiddle.net/He2KZ/1/)

我使用 width:inherit 属性继承父宽度，无论它是什么大小。我还注意到删除边框解决了这个问题。可拖动的克隆是 2px 出来的，你有一个 1px 的边框。这有点像 Jquery-ui IMO 的错误，他们至少应该考虑边界。

如果您真的想要边框，请尝试使用“轮廓”而不是“边框”。这不会增加 div 的宽度。

# mysql - MySQL 数据导出更改时间

> ID：14886427
> 
> 赞同：13
> 
> 时间：2013-02-15T00:16:24.873
> 
> 标签：mysql, timezone, mysqldump, mysqlimport

我有一些用于数据库的备份和恢复脚本。该表有一个时间戳字段。备份脚本如下所示：

```
mysqldump -u user -ppass database --tab="../" --fields-terminated-by="|" --skip-comments table 
```

它创建了两个文件，table.sql 和 table.txt。恢复脚本如下所示：

```
mysql -u user -ppass database < "../table.sql"
mysqlimport -u user -ppass --local --fields-terminated-by="|" database "../table.txt" 
```

然而，备份脚本输出的时间错误——比数据库中的时间晚了一个小时——但在导入时它没有更正它。

例如，一行的时间是**15:10:25**，但是当运行备份脚本时，**table.txt**中列出了 14:10:25。当我运行恢复脚本时，同一行现在有**14:10:25**作为数据库中的时间。如果我再次备份，它会**显示 13:10:25**！等等...

我不明白为什么会这样。时区似乎设置为“系统”（我在格林威治标准时间）。table.sql 文件有几行提到时区，也许那里有问题？这是有问题的完整文件：

```
/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
DROP TABLE IF EXISTS `news_article`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `news_article` (
  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(100) NOT NULL,
  `alias` varchar(65) NOT NULL,
  `author` tinyint(3) unsigned NOT NULL,
  `category` tinyint(3) unsigned NOT NULL,
  `posted` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `opening` text NOT NULL,
  `content` text NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `alias` (`alias`)
) ENGINE=MyISAM AUTO_INCREMENT=93 DEFAULT CHARSET=utf8;
/*!40101 SET character_set_client = @saved_cs_client */;

/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-24T17:11:20.767

最终找到了解决方案：`--skip-tz-utc`在导出脚本中添加选项。

这只是确保您导出的确切日期是在第二个数据库中导入的日期。它对我有用，因为数据库是相同的时区，但对于数据库不同时区的其他人来说可能并不理想。

# ruby-on-rails - 在 Rails 应用程序中上传/解析 Excel 文档

> ID：14886432
> 
> 赞同：1
> 
> 时间：2013-02-15T00:16:38.813
> 
> 标签：ruby-on-rails, ruby, excel, actioncontroller, rubyxl

我正在创建一个应用程序，该应用程序可以选择将单个条目添加到数据库模型以及从 Excel 文档上传多个条目。我正在遵循[关于上传的 Rails 指南，](http://guides.rubyonrails.org/form_helpers.html#uploading-files)并希望有一种方法可以利用 RubyXL gem 上传 Excel 文档。以下是相关文档：

收入模型/upload.html.erb

```
You are in the Upload view...
<%= form_for(@uploaded_doc, :url => {:action => parse_upload_revenue_models_path}, :html => {:method => "put"}) do |f| %>
    <%= f.file_field(:workbook) %>
    <%= f.submit("Upload File") %>                                                   
<% end %> 
```

路线.rb

```
Dataway::Application.routes.draw do
    devise_for :users
    resources :revenue_models do
        get 'upload', :on => :collection         
    end
    match 'revenue_models/upload' => 'revenue_models#parse_upload', :via => :post
    root :to => "home#index"
end 
```

收入模型控制器.rb

```
...
def upload
    @uploaded_doc = { :workbook => RubyXL::Parser.new }
end
def parse_upload
    @worksheet = (params[:uploaded_doc])
    @worksheet_name = @worksheet.original_filename
end 
```

收入模型模型是最终将使用来自 excel 文档的解析数据进行修改的数据库。该模型不包含已上传文档的列。我在 upload.html.erb 视图中将表单路由到 parse_upload 操作。但是，我收到以下错误：

```
NoMethodError in Revenue_models#upload
    undefined method `model_name' for NilClass:Class 
```

该错误与upload.html.erb 视图中的form_for 有关。请帮忙。

# regex - unicode 上的 Word 捕获失败，如何修复 5.10

> ID：14886434
> 
> 赞同：2
> 
> 时间：2013-02-15T00:16:52.300
> 
> 标签：regex, perl, unicode

我有这个正则表达式。

```
my ( $word ) = $_ =~ /(\w{2,})/xms; 
```

它无法正确捕获具有 unicode 的单词。我能够修复它

```
my ( $word ) = $_ =~ /(\w{2,})/uxms; 
```

但该`/u`功能仅在 5.14 中可用。无论如何我可以使单词在 5.10 中匹配吗？

完整代码在这里：[Dist::Zilla::Plugin::Test::PodSpelling](https://metacpan.org/source/XENO/Dist-Zilla-Plugin-Test-PodSpelling-2.002006/lib/Dist/Zilla/Plugin/Test/PodSpelling.pm#L51)

添加一些鲤鱼（正则表达式之前和之后）

```
Simões at /home/ccushing/perl5/perlbrew/perls/perl-5.16.2/lib/site_perl/5.16.2/x86_64-linux/Class/MOP/Method/Wrapped.pm line 162.
Sim at /home/ccushing/perl5/perlbrew/perls/perl-5.16.2/lib/site_perl/5.16.2/x86_64-linux/Class/MOP/Method/Wrapped.pm line 162. 
```

还注意到只需添加`use 5.014`到文件顶部即可解决问题。在正则表达式之前添加`utf8::upgrade( $_ )`并不能解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T02:02:45.813

使用`\p{Word}`而不是`\w`. `\w`可能有也可能没有 unicode 语义（取决于一些复杂的规则），但`\p`总是有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T06:44:44.513

`use feature qw( unicode_strings );`将在某些版本中发挥作用。`utf8::upgrade($_);`在比赛之前将在所有版本中发挥作用。

测试：

```
use open ':std', ':utf8';
$_ = "Sim\xF5es";
print $_ =~ /(\w{2,})/xms, "\n";
utf8::upgrade($_);
print $_ =~ /(\w{2,})/xms, "\n"; 
```

输出：

```
Sim
Simões 
```

# sql - 每天查找单个 MAX 值

> ID：14886435
> 
> 赞同：3
> 
> 时间：2013-02-15T00:17:02.860
> 
> 标签：sql, aggregate-functions

我已经厌倦了使用我之前类似问题的部分内容，但是我作为我正在查询的表有多行，我似乎无法获得一天的单个最大值。然后我需要将它与上一个问题合并，但这是我需要玩的另一件事......

表格很简单，2列

```
Date       |        Peak Power

1/1/2012 10:00:00 | 150.00

1/1/2012 10:12:00 | 120.00

1/1/2012 05:01:00 | 190.00

1/1/2012 01:35:00 | 500.00

1/1/2012 04:54:00 | 250.00 
```

结果

```
Date | Peak Power each day

1/1/2012 10:00:00 | 500.00

2/1/2012 04:00:00 | 150.00 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:23:51.337

You dont tell us what SQL product your using, so here is Sql Server 2008R2:

```
SELECT
CAST(t.DateColumn as DATE), MAX(t.PowerUsage) as 'Peak Power Each Day'
FROM [MyTable] t
GROUP BY CAST(t.DateColumn AS DATE) 
```

here is MySql

```
SELECT
DATE(t.DateColumn), MAX(t.PowerUsage) as 'Peak Power Each Day'
FROM [MyTable] t
GROUP BY DATE(t.DateColumn) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:20:37.497

所以你想合并日期中的日期时间记录？有很多方法可以做到这一点，但我会使用这个：

```
 SELECT CONVERT(CHAR(10), Date, 120) AS "Date", MAX("Peak Power")
 FROM MyTable
 GROUP BY CONVERT(CHAR(10), Date, 120) 
```

您没有指定您的 RDMS，但这将在 MS SQL 中工作。

# java - char 编码集相关的 XML 解析错误

> ID：14886439
> 
> 赞同：1
> 
> 时间：2013-02-15T00:17:12.617
> 
> 标签：java, character-encoding, xml-parsing, jdom-2

我有一个有效的 XML 文件（有效原因浏览器可以解析它），我尝试使用 JDOM2 解析它。该代码对其他 xml 文件运行良好，但对于这个特定的 xml 文件，它在 builder.build() 行上给了我以下异常：“com.sun.org.apache.xerces.internal.impl.io.MalformedByteSequenceException: Invalid byte 3 个 3 字节的 UTF-8 序列。"

我的代码如下

```
 import java.io.*;
    import java.util.*;
    import java.net.*;
    import org.jdom2.*;
    import org.jdom2.input.*;
    import org.jdom2.output.*;
    import org.jdom2.adapters.*;

    public class Test
    {
        public static void main(String st[])
        {
            String results="N.A.";
            SAXBuilder builder = new SAXBuilder();
            Document doc;
            results = scrapeSite().trim();

                    try
                    {
                        doc = builder.build(new ByteArrayInputStream(results.getBytes()));
                    }
                    catch(JDOMException e)
                    {
                        System.out.println(e.toString());
                    }
                    catch(IOException e)
                    {
                        System.out.println(e.toString());
                    }
        }

        public static String scrapeSite()
        {
            String temp="";
            try
            {
                URL url = new URL("http://msu-footprints.org/2011/Aditya/search_5.xml");
                URLConnection conn = url.openConnection();
                conn.setAllowUserInteraction(false);
                InputStream urlStream = url.openStream();
                BufferedReader br = new BufferedReader(new InputStreamReader(urlStream));

                String t = br.readLine();
                while(t!=null)
                {
                    temp = temp + t;
                    t = br.readLine();
                }
            }
            catch(IOException e)
            {
                System.out.println(e.toString());
            }

            return temp;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:44:47.077

你为什么用阅读器将 xml 读入字符串？在解析它之前，您正在破坏 xml。将 xml 视为字节，而不是字符。

为什么你阅读整个 URL InputStream 只是为了将它转换成另一个 ByteArrayInputStream？通过将 URL InputStream 直接传递给构建器，您可以将其减少到大约 2 行代码。（更不用说避免将整个流读入内存引起的额外内存问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T13:26:46.713

正如 jtahlborn 所指出的，您应该始终将 XML 视为字节，让解析器进行编码。

但更重要的是，你永远不应该使用 String.getBytes() 来获取字符串的字节：你不会得到你认为的那样。

在这种情况下，您可以只获取站点的字节，但即使您在字符串中构造 XML，然后将其作为字节序列传递给解析器（或者更有可能将字节写入文件），您也会想要指定编码，使其与 XML 所说的编码相匹配，默认情况下为 UTF-8：

```
byte[] bytes = myString.getBytes("UTF-8"); 
```

同样，如果出于某种原因需要使用 Writer 或 Reader，则必须指定要写入或读取的编码。

如果需要构造 XML，一个好方法是使用 XMLStreamWriter 类：

```
ByteArrayOutputStream outStream = new ByteArrayOutputStream();
XMLStreamWriter writer = 
   XMLOutputFactory.newInstance().createXMLStreamWriter(outStream); 
```

# mysql - sql在某些列上“显示”数组

> ID：14886441
> 
> 赞同：0
> 
> 时间：2013-02-15T00:17:24.653
> 
> 标签：mysql, sql, arrays, post

我有一些基本代码，它从表单中收集 chkbox 和单选按钮是/否答案等并存储在 mysql 中，但一些 mysql 提交工作（即在 sql 列中放置是或否）但有些只是在 sql 列中显示为'array' - 这是代码示例。$repeat 显示为“数组”，其中 $inter 显示为是或否。mysql 中的列在结构上是相同的，表单 HTML 是相同的语法，$_POST 数组是逗号分隔的，因为我也通过电子邮件发送值并且电子邮件正确显示答案 - 这很奇怪

```
<?php
$repeat = "";
foreach ($_POST['repeat'] as $key => $value) {
$repeat.= ",$value ";
}
$repeat = substr($repeat,1);

$inter = "";
foreach ($_POST['intermitant'] as $key => $value) {
$inter.= ",$value ";
}
$inter = substr($inter,1);

//other posts all looped though etc
//then the sql - log on etc

$sql="INSERT INTO faults (repeat_visit,intermitant) VALUES ('$repeat','$inter')"; 
```

这是 HTML - 我可以看到它没有什么奇怪的，我得到了你上面描述的内容 - 但是为什么一个工作而另一个不使用相同的代码，相同的方法应用于复选框和一些其他的 wiork 很好的 put 'array ' 在 sql 中

```
<label>Repeat Visit:</label>
<input type="radio" name="repeat[]" value="Yes" />Yes
<input type="radio" name="repeat[]" value="No" />No

<label>Intermitant Fault:</label>
<input type="radio" name="intermitant[]" value="Yes" />Yes
<input type="radio" name="intermitant[]" value="No" />No 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T04:59:45.533

As popnoodles stated, seeing the form's HTML would help, but this looks as if each element in $_POST['repeat'] & $_POST['intermitant'] is actually an array, and so the $value of the foreach() is returning "Array"

Check that the checkbox array is only 1 dimensional, and if it is not, does it have to be multi-dimensional?

If so, perhaps a recursive function or nested loop to implode the values is required

```
$repeat = "";
foreach ($_POST['repeat'] as $k => $v)
{
    foreach ($v as $kInner => $vInner)
    {
         $repeat .= ",$vInner ";
    }
} 
```

# php - 多次深入了解 xml 提要的有效方法

> ID：14886446
> 
> 赞同：1
> 
> 时间：2013-02-15T00:17:54.627
> 
> 标签：php, xml, function

我发现自己深入研究了 xml 提要，除了几个数组名称之外，它们几乎是相同的提要。

理想情况下，我想制作一种我可以调用的函数，但我不知道如何处理这种数据

```
//DRILLING DOWN TO THE PRICE ATTRIBUTE FOR EACH FEED & MAKING IT A WORKING VAR
  $wh_odds = $wh_xml->response->will->class->type->market->participant;
  $wh_odds_attrib = $wh_odds->attributes();
  $wh_odds_attrib['odds'];

  $lad_odds = $lad_xml->response->lad->class->type->market->participant;
  $lad_odds_attrib = $lad_odds->attributes();
  $lad_odds_attrib['odds']; 
```

如您所见，它们本质上非常相似，但我不太确定如何简化设置工作变量的过程，而无需每次编写 3 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:25:50.863

你可以这样做：

```
 function getAttrib ($xmlObj, $attrName) {
      $wh_odds = $xmlObj->response->$attrName->class->type->market->participant;
      $wh_odds_attrib = $wh_odds->attributes();
      return $wh_odds_attrib['odds'];
}

getAttrib ($wh_xml, "will"); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T14:23:31.453

您可能正在寻找的功能称为[`SimpleXMLElement::xpath()`](http://php.net/SimpleXMLElement.xpath).

[XPath 是](http://c2.com/cgi/wiki?XpathLanguage)它自己的一种语言，旨在从 XML 文件中挑选内容。在您的情况下，获取`odds`所有这些元素的属性的 xpath 表达式是：

```
response/*/class/type/market/participant/@odds 
```

您还可以将 替换`*`为具体的元素名称*，或者*允许有多个名称，等等。

```
$odds = $lad_xml->xpath('response/*/class/type/market/participant/@odds'); 
```

与您的代码不同，这具有数组内的所有*属性*元素（变量内有属性的父元素）。一个示例结果（考虑两个这样的元素）将是：

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [@attributes] => Array
                (
                    [odds] => a
                )

        )

    [1] => SimpleXMLElement Object
        (
            [@attributes] => Array
                (
                    [odds] => a
                )

        )

) 
```

您也可以轻松地将其转换为字符串：

```
$odds_strings = array_map('strval', $odds);

print_r($odds_strings);

Array
(
    [0] => a
    [1] => a
) 
```

如果您说要获取所有`participant`元素的`odds`属性，Xpath 特别有用：

```
//participant/@odds 
```

您不需要显式指定每个父元素名称。

我希望这是有帮助的。

# windows-store-apps - Windows 应用商店应用按钮响应单击但未成功触发事件

> ID：14886448
> 
> 赞同：0
> 
> 时间：2013-02-15T00:18:05.100
> 
> 标签：windows-store-apps

我在认证报告中回复：

> 该应用程序似乎不完全支持触摸输入。主屏幕上的各种图块响应触摸/点击，但不启动操作。此应用中的触控支持似乎不适用于我们的审阅者。请参阅： http: [//msdn.microsoft.com/en-us/library/windows/apps/Hh761498.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/Hh761498.aspx)了解键盘、鼠标和触摸的一些常见交互。

在多台台式计算机和 Surface RT 上进行开发和测试时，这从来都不是问题。关于可能是什么原因或我如何重现它的任何想法？提到的操作与代码后面的事件处理程序相关联，并使用带有视图模型的导航模型作为参数。如果需要，我可以发布一个示例，但该代码没有什么特别之处。在某些环境中，什么可能导致事件绑定按钮看起来被按下但没有调用处理程序？

摘自测试人员提到的非功能性主要功能之一：

看法：

```
<GridView ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
ItemClick="ItemView_ItemClick".. 
```

后面的代码：

> void ItemView_ItemClick(object sender, ItemClickEventArgs e) { var foodItem = (FoodItemViewModel)e.ClickedItem; var mainViewModel = (MainViewModel)this.DefaultViewModel["MainViewModel"]; mainViewModel.CurrentItem = foodItem;
> 
> ```
>  this.Frame.Navigate(typeof(ItemDetailPageReadOnly), (MainViewModel)mainViewModel);
>     } 
> ```

来自 ItemDetailPageReadOnly：

> protected override void LoadState(Object navigationParameter, Dictionary pageState) { if (pageState != null && pageState.ContainsKey("SelectedItem")) { navigationParameter = pageState["SelectedItem"]; }
> 
> ```
>  var mainVm = (MainViewModel)navigationParameter;
>         this.DefaultViewModel["MainViewModel"] = mainVm;
>         this.DefaultViewModel["Item"] = mainVm.CurrentItem;
>     } 
> ```

如果任何参数为空，而不是测试人员描述的行为，我会期望 NullPointerException。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T13:59:23.963

您应该使用更高级别的事件之一，除非您需要响应手势的特定部分。[http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh994936.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh994936.aspx)

# php - PHP Facebook SDK，获取相册

> ID：14886449
> 
> 赞同：0
> 
> 时间：2013-02-15T00:18:06.397
> 
> 标签：php, facebook, sdk, facebook-javascript-sdk

我知道有很多关于 facebook 和 php sdk 的问题，抓取并获取一些信息。但我有不同的问题。

想象我已经做了一切。

由 fb javascript sdk + php 和 ajax 授权的用户，将基本信息存储在数据库中并忘记了 facebook。现在我的用户可以使用我的数据库登录 Facebook 信息。

在我的数据库中，我有：

```
id  user_fb     say_smth    access  register    mail    limitTime   count 
```

注意有 user_fb，这是 facebook id。

当用户登录时，我创建会话并使用 jquery/ajax/json 解析获取它

```
// Cache hit
// $start   = microtime(true);
$res = $mysqli->query("/*" . MYSQLND_QC_ENABLE_SWITCH . "*/" . "SELECT fb_id, email, password FROM sp_signup WHERE email = '{$email}' AND password = '{$passw}' LIMIT 1");

$check_row      = $res->num_rows;
$check_array    = $res->fetch_assoc();

$res->free();

if ($check_row == 0)
{

print json_encode( array("status" => "user does not exists", "code" => 10) );

} else {
if ( ! isset($_SESSION) )
{
    session_start();
    $_SESSION[ "dh_user_fb" ] = $check_array["fb_id"];

    print json_encode( array("status" => "", "code" => 4, "session" => $_SESSION[ "dh_user_fb" ]) );
} else {
    print json_encode( array("status" => "", "code" => 4, "session" => null) );
} 
```

} // 结束码

和jquery ajax成功方法

```
var gotJson = jQuery.parseJSON(jsonR);

var code = gotJson['code'];
var status = gotJson['status'];
var session = gotJson['session'];

if ( session == null ){

if ( code == 11 ){

    $("#email_try").html(status).fadeIn(600);
                                                $("#email_try").html(status).fadeOut(2200);

    } else if ( code == 12 || code == 10 ) {

$("#passw_try").html(status).fadeIn(600);
                                                $("#passw_try").html(status).fadeOut(2200);

    } else {
                                                // 
    } 
```

}

所以当用户进入时，有 $_SESSION["fb_id"];

我需要通过 php 登录用户相册并将其复制到我的本地 ftp 或从 facebook 获取 src。这不是必需品。

我只感兴趣，如果有任何机会在没有访问令牌和登录等的情况下执行此操作，**我只想通过 fb_id 执行此操作**；

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:01:19.863

不调用 api 是无法直接获取的。

获得用户访问他的照片的权限

```
$loginLink = $facebook->getLoginUrl(array(
    'scope' => 'user_photos,user_photo_video_tags'
)); 
```

然后使用此 api 获取用户照片：

```
$photos = $facebook->api('/me/photos?access_token=' . $token); 
```

# javascript - 使用 DOM 遍历表的问题

> ID：14886456
> 
> 赞同：1
> 
> 时间：2013-02-15T00:18:23.977
> 
> 标签：javascript

我设法解决了仅使用 JavaScript 使用 DOM 遍历表行时遇到的一些问题，但遇到了 2 个障碍。我正在尝试创建一个表格，其中每一行都有一组按钮来向上、向下或删除该特定行。我能够成功使用 .replaceChild 方法，但它替换了行而不是仅仅交换它们。当我尝试 .moveRow 时，我不断收到错误消息，提示 HTML 表格部分没有该方法。尝试将当前行与下面的行交换时遇到了同样的问题。有什么建议么？

```
function up(x){

        // var tableBody = document.getElementsByTagName("tbody")[0]; // tried it with tableBody and it still didn't work
        var table = x.parentNode.parentNode.parentNode;
        var tableRow = x.parentNode.parentNode.cloneNode(true);
        var previousRow = x.parentNode.parentNode.previousSibling.cloneNode(true);
        table.replaceChild(tableRow,x.parentNode.parentNode.previousSibling);

    }

    function down(x){
        var table = x.parentNode.parentNode.parentNode;
        var tableRow = x.parentNote.parentNode.cloneNode(true);
        var belowRow = x.parentNode.parentNode.nextSibling.cloneNode(true);
        table.moveRow(tableRow,x.parentNode.parentNode.nextSibling);
    } 
```

我的按钮：

```
<table id="table1" border="1">
        <tbody>
            <tr>
                <th>Column 1</th> <th>Column 2</th> <th>Column 3</th> <th>Column 4</th> 
            </tr>   
            <tr id="enterData">
                <td id="buttons">
                    <input type="button" value="Up" onclick="up(this)" />
                    <input type="button" value="Down" onclick="down(this)" /> 
                </td>
            </tr>
        </tbody>
        </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:10:19.710

您可以使用`insertBefore`向上或向下移动行和`appendChild`最后一行，我也使用 *ElementSibling 来避免文本节点问题，但这可能会导致兼容性问题。

```
function up(x){
    var row = x.parentNode.parentNode;
    var table = row.parentNode;
    //Don't move up over the header
    if (row.previousElementSibling && row.previousElementSibling.previousElementSibling){
        table.insertBefore(row,row.previousElementSibling);
    }
}
function down(x){
    var row = x.parentNode.parentNode;
    var table = row.parentNode;
    //can't use insertBefore for last row.
    if (row.nextElementSibling && row.nextElementSibling.nextElementSibling){
        table.insertBefore(row,row.nextElementSibling.nextElementSibling);
    }
    else{
        table.appendChild(row);
    }
} 
```

[**演示**](http://jsfiddle.net/ZyaBQ/1)

# macos - 每次提交命令后自动清除终端

> ID：14886457
> 
> 赞同：2
> 
> 时间：2013-02-15T00:18:56.770
> 
> 标签：macos, terminal

我正在寻找一种在每次运行命令时自动清除终端的方法。理想情况下，我只想看到我刚刚运行的最后一个命令的结果。有没有办法为 OSX 做到这一点？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-08-13T15:20:51.633

在每个命令之后将命令清除。

# php - 使用 Gedmo 树时的 Symfony/Doctrine 批处理

> ID：14886459
> 
> 赞同：1
> 
> 时间：2013-02-15T00:19:18.167
> 
> 标签：php, linux, postgresql, symfony

我在使用 Symfony2 命令运行批处理脚本并按照[本指南](http://www.doctrine-project.org/blog/doctrine2-batch-processing.html)使用 Doctrine2 时遇到内存泄漏问题。我坚持并以 50 个批次刷新并在`$em->clear()`之后调用，但是当我测量 php 使用了多少内存时，每 50 行迭代都会留下一个`5MB`足迹，在 clear 调用后不会被释放。我一直在做一些挖掘，它似乎发生在`$em->flush()`onFlush 事件被触发之后，更具体地说是在触发事件时发生。

我已经删除了实现 Gedmo 树的实体，并且内存占用减少到`1MB`仍然很多。根据教程，它应该几乎为零。

这几天我一直在摸不着头脑，想向社区寻求帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:37:50.830

我用参数运行了脚本，`--env=prod`它似乎解决了我的问题。

```
app/console --env=prod my:command:name 
```

# android - OpenGL ES 2.0。图像适合屏幕在横向和纵向 Android

> ID：14886461
> 
> 赞同：1
> 
> 时间：2013-02-15T00:19:18.700
> 
> 标签：android, opengl-es, android-image

我开始学习 openGL ES 2.0。现在我可以为对象添加纹理并创建基本图形（球体、三角形、立方体等）。但现在我有一些问题。我有带纹理的矩形。这是我的目标图像。现在我想让这个图像适合横向和纵向的绘图区域。基本上图像是横向的。例如： ![用于纵向定位](../Images/eb02823df6cb0154444ea2fced00a172.png) ![横向](../Images/a00b0ec852ce3805e0fa2d6df144d765.png)

屏幕必须在屏幕边缘附近没有黑线。当屏幕改变它们的方向时 - 图像必须改变大小并再次适合屏幕。我不知道如何在 Android 上的 OpenGL 上实现它。我应该改变什么？视口参数还是其他参数？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T01:51:44.383

您需要一个将屏幕尺寸和方向考虑在内的投影。例如：

```
float aspectRatio = width / (float) height;
orthoM(projectionMatrix, 0, -aspectRatio, aspectRatio, -1f, 1f, -1f, 1f); 
```

# java - Java客户端到服务器与原始数据通信的可能技术？

> ID：14886463
> 
> 赞同：3
> 
> 时间：2013-02-15T00:19:28.703
> 
> 标签：java, jakarta-ee

让客户端 java 应用程序与应用程序服务器 java 应用程序通信的最常见技术是什么，它们的优缺点是什么？

请告诉我用来搜索网络的神奇词汇。我听说过' `Enterprise Java Bean`'，' `RMI`'，' `Web Services`'和' `JSON`'。

简单地说，我从哪里开始寻找，以便我可以将我的`JavaSE`客户端连接到`JavaEE`服务器应用程序处理。

现在我只想传输原始数据：`numbers`，，`dates`等`Strings`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T05:29:11.250

You can have a look at [finagle](https://github.com/twitter/finagle), which "is an asynchronous network stack for the JVM that you can use to build asynchronous Remote Procedure Call (RPC) clients and servers in Java, Scala, or any JVM-hosted language. Finagle provides a rich set of tools that are protocol independent."

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:56:55.157

您的问题非常广泛，您似乎很难知道从哪里开始。为此，有很多解决方案。这里的关键是让事情尽可能简单。

如果我是你，我会查看[http://dropwizard.codahale.com](http://dropwizard.codahale.com)。

如果您花时间浏览示例并阅读一些文档，您最终会理解所有基本概念，即使您认为它不是您的应用程序的最佳解决方案。

仅供参考 - Dropwizard 在 Apache License v2 下获得许可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T02:38:45.080

一些好的考虑：

*   [http://code.google.com/p/kryonet/](http://code.google.com/p/kryonet/) - Kryonet：快速、高效的二进制序列化
*   [http://code.google.com/p/protobuf/](http://code.google.com/p/protobuf/) - Protocol Buffers，谷歌自己的数据传输库
*   [http://hessian.caucho.com/](http://hessian.caucho.com/) - Hessian，又一个二进制交换库。对不同语言的大量支持

您还可以使用 JSON / XML 交换格式。但是它们可能很笨拙，我认为如果您同时控制客户端和服务器（主要是出于速度和网络效率的原因），二进制格式会更好。

此外，如果您对更多低级别的东西感兴趣，我强烈建议您看看 Netty——我认为它现在几乎是 Java 网络 IO 的黄金标准。

*   [https://netty.io/](https://netty.io/)

# ios - 如何在 iOS 的 UIWebView 上禁用长按手势

> ID：14886472
> 
> 赞同：3
> 
> 时间：2013-02-15T00:20:13.243
> 
> 标签：ios, uiwebview

我只是想知道如何在 iOS 的 webview 上禁用长按手势。我只需要禁用长按手势而不是其他手势。应该可以在 iOS 5.0 上运行 + 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-09-24T14:09:27.983

我要感谢所有人的帮助。经过深入的stackoverflow研究，我终于找到了解决方案。其他帮助：

在 javascript/html 中，您可以避免处理 longpress 事件。

很久以前就给出了解决方案：[在移动 Safari (iPad / iPhone) 中阻止 longpress / longclick 上的默认上下文菜单](https://stackoverflow.com/questions/12304012/preventing-default-context-menu-on-longpress-longclick-in-mobile-safari-ipad)

我做到了，而且非常完美。感谢并再次感谢。

杰米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:24:48.593

您可以将 UIWebView 作为自定义类之一的超类，扩展它.. 并覆盖 UIView 类中的 touchesBegan.. 方法。

# ruby-on-rails - JSON gem 无法在 Mac OS X 10.8.2 上编译

> ID：14886473
> 
> 赞同：1
> 
> 时间：2013-02-15T00:20:34.273
> 
> 标签：ruby-on-rails, json, macos

操作系统：Mac OS X 10.8.2 XCode：最新安装了命令行工具（版本 4.6） Rails：版本 3.2.3

我正在尝试为我正在处理的项目生成路由（定期这样做），当我收到一条错误消息时，建议我执行捆绑安装和捆绑执行。我做到了，这一次，在编译 JSON Gem（版本 1.7.7）时，这个过程中断了。

对 StackOverflow 进行了一些研究，建议更新 XCode 的命令行工具，我也这样做了，但这并没有解决问题。

我尝试单独安装 JSON 版本 1.7.7，但失败了，告诉我查找错误日志：

```
~/.rvm/gems/ruby-1.9.3-p125/gems/json-1.7.7/ext/json/ext/generator/gem_make.out 
```

内容如下：

```
/Users/mine/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb
creating Makefile

make
compiling generator.c
make: /usr/bin/gcc-4.2: No such file or directory
make: *** [generator.o] Error 1 
```

我寻找 /usr/bin/gcc-4.2，确实，它不存在。但是，当我这样做时：

```
ls -l /usr/bin/gcc 
```

这是我得到的：

```
lrwxr-xr-x  1 root  wheel  12 Feb 14 15:49 /usr/bin/gcc -> llvm-gcc-4.2 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:41:39.623

我认为问题在于，当您安装 Xcode 命令行工具时，gcc 与 llvm 进行了符号链接，而 llvm 无法始终正确编译 Ruby 和 gems。

如果您直接安装`autoconf`、`automake`和`gcc`（或通过[Homebrew](http://mxcl.github.com/homebrew/)之类的工具），您应该能够修复编译器错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:46:37.037

问题是你用来编译你安装的 ruby​​ 版本的 gcc 作为 xcode 升级的一部分被删除了。使用 RVM 重建您的 ruby​​（您可能还想升级到最新版本）。一旦你这样做了，你应该没有问题构建带有本机扩展的 gem。

# core-data - 按核心数据分组给出错误

> ID：14886475
> 
> 赞同：2
> 
> 时间：2013-02-15T00:20:37.167
> 
> 标签：core-data, nsfetchedresultscontroller, nsfetchrequest

我正在尝试获取一个请求，我想按“高级帐户”分组并获取卡号、持卡人姓名和类似的东西。我收到一个奇怪的错误 -

***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“使用 GROUP BY 组件的查询中的 SELECT 子句只能包含在 GROUP BY 或聚合函数中命名的属性 (()、名称 gCardHolderName、isOptional 1、isTransient 0、实体商家、 renamingIdentifier gCardHolderName, 验证谓词 (), 警告 (), versionHashModifier (null) userInfo { }, attributeType 700, attributeValueClassName NSString, defaultValue (null) 不在 GROUP BY)'

我假设这是 SQL 查询 - SELECT CARDHOLDERNAME, PREMIUM ACCOUNT NAME FROM "MERCHANT" GROUP BY PREMIUM ACCOUNT NAME。

高级帐户名称可以相同（对于帐户 1，我可以有不同的持卡人姓名）。

我不知道这个错误。如果有人可以帮助我，这是我的代码 -

# 杂注标记 - FetchRequest 方法

```
- (void)fetchRequest
{
   NSError * anyError = nil;

   AppDelegate * applicationDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate];
   NSManagedObjectContext * context = [applicationDelegate managedObjectContext];

   NSFetchRequest *request = [[NSFetchRequest alloc] init];
// Edit the entity name as appropriate.
   NSEntityDescription *entity = [NSEntityDescription entityForName:@"Merchant" inManagedObjectContext:context];
   [request setEntity:entity];

   [request setFetchBatchSize:15];

   NSSortDescriptor *sortDescriptor1 = [[NSSortDescriptor alloc] initWithKey:@"premiumActName" ascending:NO];

   NSArray *descriptors = [NSArray arrayWithObjects:sortDescriptor1, nil];

   [request setSortDescriptors:descriptors];

   NSPropertyDescription *accountDesc = [[entity propertiesByName] objectForKey:@"premiumActName"];
   NSPropertyDescription *cardHolderDesc = [[entity propertiesByName] objectForKey:@"gCardHolderName"];

   NSExpression *keyPathExpression = [NSExpression expressionForKeyPath: @"premiumActName"];
   NSExpression *countExpression = [NSExpression expressionForFunction: @"count:"
                                                          arguments: [NSArray arrayWithObject:keyPathExpression]];
    NSExpressionDescription *expressionDescription = [[NSExpressionDescription alloc] init];
    [expressionDescription setName: @"count"];
    [expressionDescription setExpression: countExpression];
    [expressionDescription setExpressionResultType: NSInteger32AttributeType];

    NSArray *propertiesToFetch= @[accountDesc,cardHolderDesc, expressionDescription];

    [request setPropertiesToFetch:propertiesToFetch];
    [request setPropertiesToGroupBy:[NSArray arrayWithObject:@"premiumActName"]];
    [request setResultType:NSDictionaryResultType];
    [request setReturnsDistinctResults:YES];

    [context save:&anyError];

    NSArray * distinctResults = [context executeFetchRequest:request error:&anyError];

   [distinctResults enumerateObjectsUsingBlock:^(NSDictionary *dict, NSUInteger idx, BOOL *stop) {

      NSLog(@" objects=%@", [dict objectForKey:@"gCardHolderName"]);

   }];

   if(_fetchedResultsController)
   {
      _fetchedResultsController = nil;
   }

   _fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:context sectionNameKeyPath:nil cacheName:nil];

   if(![_fetchedResultsController performFetch:&anyError])
  {
      NSLog(@"error fetching:%@", anyError);
  }
  [self.membersTblView reloadData];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T18:50:38.957

[请求 setPropertiesToGroupBy:propertiesToFetch]

# java - Java servlet annotations

> ID：14886484
> 
> 赞同：4
> 
> 时间：2013-02-15T00:21:38.460
> 
> 标签：java, servlets

Is there any way to use pure Java servlets not spring mvc request mapping to map a URL to a method?

something like:

```
@GET(/path/of/{id}) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T00:26:14.120

“plain vanilla” servlet 也可以实现（见鬼，Spring MVC 和 JAX-RS 也构建在 servlet API 之上），它只需要更多样板。

```
@WebServlet("/path/of/*")
public class PathOfServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String id = request.getPathInfo().substring(1);
        // ...
    }

} 
```

就这样。感谢新的 Servlet 3.0`@WebServlet`注释，您不需要任何`web.xml`条目。

### 也可以看看：

*   [我们的 Servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)

# c# - Why is this an invalid cast?

> ID：14886491
> 
> 赞同：4
> 
> 时间：2013-02-15T00:22:18.637
> 
> 标签：c#, casting, combobox, enums, selecteditem

I'm populating a combo box with custom enum vals:

```
 private enum AlignOptions
    {
        Left,
        Center,
        Right
    }

. . .

    comboBoxAlign1.DataSource = Enum.GetNames(typeof(AlignOptions)); 
```

When I try to assign the selected item to a var of that enum type, though:

```
 AlignOptions alignOption;
. . .
    alignOption = (AlignOptions)comboBoxAlign1.SelectedItem; 
```

...it blows up with: "*System.InvalidCastException was unhandled Message=Specified cast is not valid.*"

Isn't the item an AlignOptions type?

## UPDATE

Dang, I thought I was being clever. Ginosaji is right, and I had to change it to:

```
 alignOptionStr = comboBoxAlign1.SelectedItem.ToString();
    if (alignOptionStr.Equals(AlignOptions.Center.ToString()))
    {
        lblBarcode.TextAlign = ContentAlignment.MiddleCenter;
    }
    else if (alignOptionStr.Equals(AlignOptions.Left.ToString()))
    {
        . . . 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T00:27:04.253

这是一个无效的转换，因为你没有枚举，你有枚举的字符串名称表示。要取回该枚举，您需要对其进行解析。

```
alignOption = (AlignOptions)Enum.Parse(typeof(AlignOptions), (string)comboBoxAlign1.SelectedItem); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T00:39:09.297

您应该使用[Enum.GetValues 方法](http://msdn.microsoft.com/en-us/library/system.enum.getvalues.aspx#United%20States%20%28English%29)来初始化您的组合框：

```
comboBoxAlign1.DataSource = Enum.GetValues(typeof(AlignOptions)); 
```

现在组合框包含枚举的元素和

```
AlignOptions alignOption = (AlignOptions)comboBoxAlign1.SelectedItem; 
```

是正确的演员表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:27:17.060

`Enum.GetNames()`返回`string[]`，所以每个项目都是 a `string`，而不是`AlignOptions`。

您可以通过以下方式获取枚举值：

```
 alignOption = (AlignOptions) Enum.Parse(typeof(AlignOption), 
                                              (string) comboBoxAlign1.SelectedItem); 
```

**参考：**

*   [枚举.GetNames()](http://msdn.microsoft.com/en-us/library/system.enum.getnames.aspx)
*   [枚举.Parse()](http://msdn.microsoft.com/en-us/library/essfb559.aspx)

# vb.net - 每年、每月分组 Visual Basic

> ID：14886494
> 
> 赞同：0
> 
> 时间：2013-02-15T00:22:49.280
> 
> 标签：vb.net, vba, grouping

我有这个论文项目，我应该将我的数据库分组为每年和每月

这是一个字段和数据示例

表名是：tblsell

```
Date_Saved | Total Price

2-5-2013        5
2-5-2013        10
2-5-2013        5
2-6-2013        6
2-7-2013        3
2-8-2013        2
3-1-2013        6
3-2-2013        11
3-3-2013        2
3-5-2014        5
3-6-2014        4 
```

现在，我打算创建 2 个按钮，这样当我单击每月按钮时，它应该会显示在 datagridview 上

```
Date_saved | Total_Earnings

2-2013 or february 2013       31
3-2013 or march 2013          19
3-2014 or march 2014          9 
```

然后，如果我单击年度按钮，这应该显示在 datagridview

```
Date_saved | Total_earnings

2013        50
2014        9 
```

我不确定我是否在说明正确的输出，但至少在该输出附近应该这样做。

date_saved 的数据类型是文本，total_earnings 是访问时的数字。我通过使用日期字符串获得了 date_saved。喜欢`.add... = datestring`。我不知道它是否正确，所以我可以得到日期。

我正在 reportviewer 上尝试它们，但我不知道在 reportviewer 上做什么，所以我放弃了，只是认为在 datagridview 和按钮上更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:59:57.643

如果您希望将此作为数据网格，那么这些是您的两个查询选项

`Table1`像这样设置您的基表

![在此处输入图像描述](../Images/70eb6780c04cba5299763573a6415971.png)

你可以像这样创建一个新查询 ![在此处输入图像描述](../Images/3b6f1bf77e9eb932368d481f84a04227.png)

生成此代码。

```
SELECT MonthName(Month([Date_Saved])) & ' ' & Year([Date_Saved]) AS [Year], Sum(Table1.[Total Price]) AS [SumOfTotal Price]
FROM Table1
GROUP BY MonthName(Month([Date_Saved])) & ' ' & Year([Date_Saved]); 
```

并产生这些结果。

![在此处输入图像描述](../Images/26d6fe1cd3a4a94f8e3fe8fb25e9c94f.png)

分组是这里的关键。有几种分组方法，我在那里做的方式使您的数据网格看起来“格式化”，但比诸如

```
SELECT  DATEADD('m', DATEDIFF('m',0,date_saved), 0) as [Month], sum([total price]) as [Month's Total Price]
FROM Table1
group by DATEADD('m', DATEDIFF('m',0,date_saved), 0) 
```

这在功能上是等效的，但是因为它不进行任何数据类型转换，所以它运行得更快。此外，它还有一个额外的好处，即您现在可以在报告的文本框中格式化您的日期，但您可以根据自己的感觉而不是决定查询时间。缺点是`dateadd`/方法与使用, ,函数`datediff`相比有点迟钝。`month``monthname``year`

# php - Regex not quite right

> ID：14886495
> 
> 赞同：0
> 
> 时间：2013-02-15T00:22:50.527
> 
> 标签：php, regex

I have a site crawler which displays a list of urls, but the problem is I cannot for the life of me get the last regex quite right. all urls end up listed as:

```
http://www.website.org/page1.html&--EFTTIUGJ4ITCyh0Frzb_LFXe_eHw
http://website.net/page2/&--EyqBLeFeCkSfmvA7p0cLrsy1Zm1g
http://foobar.website.com/page3.php&--E5WRBxuTOQikDIyBczaVXveOdRFg 
```

The Urls can all be different and the only thing which seems static is the & symbol. How would go abouts getting rid of the & symbol and everything beyond it to the right?

Here is what I have tried with the above results:

```
function getresults($sterm) {
$html = file_get_html($sterm);
$result = "";
// find all span tags with class=gb1
foreach($html->find('h3[class="r"]') as $ef)
{   
$result .=  $ef->outertext . '<br>';
}
return $result;
}

function geturl($url) {
  $var = $url;
  $result = "";

preg_match_all ("/a[\s]+[^>]*?href[\s]?=[\s\"\/url?q=\']+".
               "(.*?)[\"\']+.*?>"."([^<]+|.*?)?<\/a>/",              

               $var, $matches);

$matches = $matches[1];

foreach($matches as $var)
{    
    $result .= $var."<br>";
}

echo preg_replace('/sa=U.*?usg=.*?AFQjCN/', "--" , $result);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:32:59.353

如果 url 始终采用相同的格式，请使用 explode ：

```
<?php
$tmp = explode("&", "http://foobar.website.com/page3.php&--E5WRBxuTOQikDIyBczaVXveOdRFg");
?> 
```

$tmp[0] 应该内容“ [http://foobar.website.com/page3.php](http://foobar.website.com/page3.php) ”并且 $tmp[1] 应该内容“--E5WRBxuTOQikDIyBczaVXveOdRFg”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:20:03.867

删除 & 字符后所有内容的简单方法：

```
$result = substr($result, 0, strpos($result, '&')); 
```

# android - Write URL to NFC?

> ID：14886496
> 
> 赞同：-1
> 
> 时间：2013-02-15T00:22:55.487
> 
> 标签：android, nfc

How can I write a URL to a NFC tag so that the link automatically opens on read?

Currently, I am using the following intent:

```
 <activity
        android:name="com.myapp.ReadTagActivity"
        android:screenOrientation="portrait"
        android:label="@string/title_activity_readtag"
        android:parentActivityName=".MainActivity">

        <intent-filter>
            <action android:name="android.nfc.action.NDEF_DISCOVERED" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="application/com.myapp" />
        </intent-filter>          
  </activity> 
```

If the write operation enters the URL www.google.com, the read will only display the string. I would like the URL to open in a browser instead. How can I fix this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:23:15.443

您是否使用 NDEF 消息中的 URL 编写了正确的 NDEF 记录？

比如使用helper方法：http: [//developer.android.com/reference/android/nfc/NdefRecord.html#createUri%28android.net.Uri%29](http://developer.android.com/reference/android/nfc/NdefRecord.html#createUri%28android.net.Uri%29)

如果您的 NDEF 记录只是纯文本，它将被读取为纯文本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-13T12:35:27.627

```
NfcAdapter mNfcAdapter = NfcAdapter.getDefaultAdapter(this);
Intent intent = getIntent();       
Tag mytag = intent.getParcelableExtra(NfcAdapter.EXTRA_TAG);
Uri uri =Uri.parse("Your Url");
NdefRecord recordNFC =NdefRecord.createUri(uri);
NdefMessage message = new NdefMessage(recordNFC ); 
Ndef ndef = Ndef.get(tag);
ndef.connect();
ndef.writeNdefMessage(message);
ndef.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-04T12:32:38.360

这是在 NFC 标签中写入 Link 的代码。

```
ndef.connect();
NdefRecord mimeRecord = NdefRecord.createUri(linkPrefix + pageLink);
ndef.writeNdefMessage(new NdefMessage(mimeRecord));
ndef.close(); 
```

您可以将`below`链接前缀写入**linkPrefix**字段

```
"http://www."
"https://www."
"ftps://"
"sftp://"
"smb://"
"nfs://"
"ftp://"
"dav://"
"file://" 
```

并将页面链接写入**pageLink**字段

*   google.com
*   stackoverflow.com 等

# java - Using x509 cert public key in a Java servlet

> ID：14886497
> 
> 赞同：0
> 
> 时间：2013-02-15T00:23:02.370
> 
> 标签：java, servlets, x509certificate, saml, x509

I can use some help.

I've got some very sketchy requirements to build Single Sign On to 3rd party website.

The documentation I have says that I need to :

Create an X509 Certificate Public Key Send a SAML post with some basic info to a specific URL

Use plain ( ASCII/UTF8 ) text

In the sample SAML assertion, the X509 certificate is supposed to look like this :

```
 .....
 <ds:KeyInfo>
    <ds:X509Data>
        <ds:X509Certificate>xxxxxxxxxxxxxxxx</ds:X509Certificate>
     </ds:X509Data>
     <ds:KeyValue>
        <ds:RSAKeyValue>
           <ds:Modulus>xxxxxxxxxxxxxxxx</ds:Modulus>
           <ds:Exponent>xxxx</ds:Exponent>
        </ds:RSAKeyValue>
      </ds:KeyValue>
 ... 
```

So I've created my self-signed certificate, and if I use the command

> openssl x509 -noout -text -in ca.crt

I see the public key, but it's got 8 line breaks in it and looks something like this :

```
 Subject Public Key Info:
      Public Key Algorithm: rsaEncryption
           RSA Public Key: (1024 bit)
             Modulus (1024 bit):
                01:a6:26:44:13:cb:ab:5d:37:83:b4:9f:25:a4:8f:
                73:b8:e3:8c:a6:8a:58:13:a8:4f:af:43:8f:13:4a:
                96:75:63:ba:8d:6a:43:9c:31:... etc 
```

How can I use the public key in my Java servlet, running on tomcat, on RedHat linux. And how is it going to work inside and XML document ?

Or have I taken a wrong turn somewhere ?

Thanks for your help

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T21:28:41.230

我通常使用类似的东西：

```
<KeyDescriptor use="signing">
            <ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
                <ds:X509Data>
                    <ds:X509Certificate>    ...hRWRV+DyfQc9nO
                    </ds:X509Certificate>
                </ds:X509Data>
            </ds:KeyInfo>
        </KeyDescriptor> 
```

换句话说，将 "01:a6:26:44:13:" 转换为 "01a6264413" 而没有换行符。

# android - How can I create a trigger between normal table and fts3 table?

> ID：14886499
> 
> 赞同：5
> 
> 时间：2013-02-15T00:23:04.827
> 
> 标签：android, database, triggers, fts3

I have been having issues switching between FTS3 tables and normal database tables. My application is very simple and allows the user to add contacts to a database and they can search for contacts that match the search query (why i used a fts table) and the result is then displayed on a list with an onItemclicklistener. But when I click the item, i get an error. I have traced this error back to the database (if I use normal database it works, but if I use fts it doesn't). So I have decided to use both types of databases and was wondering if someone could show me how a trigger is created to sync databases.

My first database is CONTACT (database name) and the table is called CONTACTS. The second database table is CONTACTS_FTS. All I am searching for is the COL_NAME, so is that all I need in my CONTACTS_FTS table? I was wondering if someone could check to see if my trigger is valid?

```
public static final String DATABASE_NAME = "CONTACT";
public static final String DATABASE_TABLE = "CONTACTS";
private static final String DATABASE_TABLE_FTS = "CONTACTS_FTS";
private static final int DATABASE_VERSION = 20;
private Context ourContext;
private DbHelper DBHelper;
private static SQLiteDatabase db;
private static final String DATABASE_CREATE = 
    "CREATE TABLE " + DATABASE_TABLE + " (" +
     COL_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
     COL_NAME + " TEXT NOT NULL, " + 
     COL_EMAIL + " TEXT NOT NULL, " +
     COL_CELL + " TEXT NOT NULL, " + 
     COL_ARRIVAL + " TEXT NOT NULL, " +
     COL_DEPARTURE + " TEXT NOT NULL, " + 
     COL_FLIGHT_NUMBER + " TEXT NOT NULL, " +
     COL_HOTEL_ROOM_NUMBER + " TEXT NOT NULL, " + 
     COL_EVENT1 + " TEXT NOT NULL, " +
     COL_EVENT2 + " TEXT NOT NULL, " + 
     COL_EVENT1_ROOM + " TEXT NOT NULL, " +
     COL_EVENT2_ROOM + " TEXT NOT NULL);";

private static final String DATABASE_CREATE_FTS = 
    "CREATE VIRTUAL TABLE " + DATABASE_TABLE_FTS + " USING fts3(" +
    "content=" + "\"CONTACTS\", " + 
    COL_NAME + ");";

private static final String Trigger = 
    "CREATE TRIGGER contacts_Trigger " + 
    "AFTER INSERT "+ "ON " + DATABASE_TABLE +
    " BEGIN " +
    "INSERT " + DATABASE_TABLE_FTS + " SET " + COL_NAME + " = new.COL_NAME WHERE " + COL_ID + " = old.COL_ID;" +
    " END;"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-04T14:54:25.870

我认为“外部内容”表的选项仅适用于 FTS4，不适用于 FTS3。

[外部内容 FTS4 表](http://www.sqlite.org/fts3.html#section_6_2_2)

尝试使用 FTS4 表而不是 FTS3。

# java - How do I get java applets to connect to a MySQL server? (Error resolution)

> ID：14886503
> 
> 赞同：0
> 
> 时间：2013-02-15T00:23:42.147
> 
> 标签：java, mysql, tomcat, applet

I'm losing my mind. I've been trying to get a Java Applet working with MySQL, and can't seem to figure out this one problem:

Code:

```
final String dbClassName = "com.mysql.jdbc.Driver";

final String CONNECTION = "jdbc:mysql://127.0.0.1/db";

Class.forName(dbClassName);

Properties p = new Properties();

p.put("user","<me>");

p.put("password","<pw>");

Connection c = DriverManager.getConnection(CONNECTION,p); 
```

The MySQL database works. I can connect and do things on it with php. I can even run the above code without an applet on the command line, and it works. However, when I try to run it as an applet, things break, and I get the following error:

![Stupid error](../Images/7408f752bf6064abed37ede2ce5b41d1.png)

The applet is served through a php file, and the part that loads the applet is below. I added the "archive=mysql.jar" part after some googling. The jar file is the mysql-connector-for-java-5.08\. I'm not entirely sure my context is right, but without this, it gives another error, that jdbc can't be found:

```
echo("<applet archive=mysql.jar code=Display.class width=2600 height=1600>");
echo("</applet>"); 
```

After searching the internet, I found a lot of comments (such as: [https://forums.oracle.com/forums/thread.jspa?threadID=1453871](https://forums.oracle.com/forums/thread.jspa?threadID=1453871)) which talked about adding stuff like:

```
grant codeBase "file:${catalina.base}/webapps/TestServlet/-" {
permission java.net.SocketPermission "127.0.0.1:3306", "connect";
}; 
```

I've tried to put variations of this into various places, but nothing has really worked. I'm guessing part of the reason, is I have no idea how to implement the above. For example, what is /webapps/?. I'm currently using AWS EC2, and I'm new to this whole thing. I am also using Tomcat 6.

If anyone has any suggestions I'd really appreciate some help. Even work-around solutions... like if I can call php files from my applet to connect for me, and have the php files return info, that'd also be acceptable. Please try to be detailed in solutions - once again, I'm new to linux-related things.

Thank you!

# javascript - 调整窗口大小时如何分析jQuery是否打印了文本？

> ID：14886512
> 
> 赞同：0
> 
> 时间：2013-02-15T00:24:21.320
> 
> 标签：javascript, jquery, resize, jquery-events, window-resize

当时我在我的网站上使用**jQuery**显示一些文本时遇到问题。

我有下一个代码：

**HTML**

```
<div id="one">something</div> 
```

**jQuery**

```
$(window).resize( function() {
    if($(document).width() <= 480) {
        $('#one').css('display','none');
        if( !$('#two').legth ) {
            $('#one').after('<div id="two">something else</div>');
        };
    }
    else {
        $('#one').css('display','inline');
        $('#two').delete();
    };
}); 
```

调整窗口大小时，会重复打印**div#two**，如果停止然后再次调整大小，则会一次又一次地打印。

我不知道代码中有什么问题。拜托，欢迎所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:26:52.917

不知道我明白了，但如果你只想让它工作一次：

```
$(window).one('resize', function() {
    $('#one').hide();
    if( !$('#two').length )
        $('#one').after('<div id="two">something else</div>');
}); 
```

它是`length`，不是`legth`，这可能是`if`失败的原因，如果是这样，只需替换`one()`为`on()`?

# ckeditor - play framework 1.x to render rich text

> ID：14886513
> 
> 赞同：0
> 
> 时间：2013-02-15T00:24:43.073
> 
> 标签：ckeditor, playframework-1.x

I am using Play framework 1.x and in one case, we are saving rich text data (I am currently using using ckeditor-JS on client side but am open to other suggestions e.g. markdown etc). The data gets saved in the DB correctly i.e. with the HTML tags (unless I am misinterpreting how it ought to be saved). I need to be able to render this content as HTML in my view - should I be looking to use the same library for handling the conversion or is there something in play framework (1.x) itself that I could possibly use. Hope I explained the question properly and thanks in advance to any useful suggestions.

# ios - iOS 环境中的 2d 动态光照参考。

> ID：14886515
> 
> 赞同：1
> 
> 时间：2013-02-15T00:24:53.933
> 
> 标签：ios, objective-c, opengl-es, 2d, lighting

我希望在我的 Cocos2d 游戏项目中实现 2d 动态照明，类似于下面的视频链接。

[https://www.youtube.com/watch?v=mVlYsGOkkyM](https://www.youtube.com/watch?v=mVlYsGOkkyM)

我相信我需要研究 OpenGL，但我能找到的唯一参考资料是 3d 编程。为了在给定的半径和 theta 上操纵 alpha 值，我应该研究什么。谢谢你。

# boost-python - 我如何让 boost-bjam 在构建时正确识别我的库？

> ID：14886517
> 
> 赞同：1
> 
> 时间：2013-02-15T00:25:44.037
> 
> 标签：boost-python, bjam

在 /usr/lib 中的 Debian/squeeze 上，我有：

```
/usr/lib/libboost_python-py25.so         /usr/lib/libboost_python-py26.so 
```

我正在尝试构建

```
/usr/lib/libboost_python-py27.so 
```

通过指定`--buildID=py27`. 但是 bjam 一直只生成

```
libboost_python.so.1.42.0 
```

然后是一个链接

```
libboost_python.so 
```

如何让 bjam 和 boost 的 Jamroot 给我一个适当命名的 .so？我猜包维护者设法做到了......

我尝试过的命令行是：

```
bjam --layout=tagged --buildID=py27 --with-python
bjam --buildID=py27 --with-python 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T06:25:19.607

至少使用最新的 Boost 版本，您应该能够：

```
b2 --python-buildid=py27 --with-python 
```

但如果您必须使用 1.42，则语法为：

```
bjam --buildid=py27 --with-python 
```

换句话说..选项是小写的并且区分*大小写*。

# ios - 来自标签栏控制器的导航栏隐藏了孩子的导航栏

> ID：14886519
> 
> 赞同：0
> 
> 时间：2013-02-15T00:25:55.903
> 
> 标签：ios, ios6

我对行为感到困惑，我有标签栏控制器（我从嵌入在导航控制器中的简单视图控制器进入此控制器）。我很困惑为什么选项卡中的导航栏被子导航栏覆盖。![在此处输入图像描述](../Images/e0cde2bb1aa9133158b92ee742f4920d.png)

当我启动应用程序并在浏览控制器中输入时，我看不到浏览标题，也看不到我以编程方式添加的导航栏项目。有人可以告诉我有什么问题吗（我是新手，我通过标签页的推送连接连接到浏览）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:47:40.667

您的问题似乎与我在这里解决的问题相同：
[Push segue from a view controller control by UITabBarController](https://stackoverflow.com/questions/14694208/push-segue-from-a-view-controller-controlled-by-uitabbarcontroller/14695231#14695231)

发生的事情是您的第一个 NavigationController 正在创建一个 Navigation 堆栈。然后你 push-segue 一个 TabViewController。它与每个包含的视图控制器一起添加到 Nav 堆栈中。但是，当您将 SEGUE 从其中一个视图控制器推送到其他视图控制器时，原始导航控制器的堆栈就是您要推送的堆栈。这不包含在选项卡视图控制器中，因此推送的视图控制器与该选项卡视图控制器没有关系，只是原始导航控制器堆栈。因此选项卡不存在。

答案是将每个选项卡控制器的视图控制器嵌入到一个新的导航控制器中，然后从这些控制器中推进。原来的导航控制器只是把事情搞砸了......

# java - 来自 JSON 响应的属性的特定名称

> ID：14886520
> 
> 赞同：4
> 
> 时间：2013-02-15T00:25:57.393
> 
> 标签：java, spring, rest

我正在使用 Spring 和 Java 1.7 的 REST

我有以下模型类：

```
private String name;
public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
} 
```

我的控制器被映射到 GET /person/info API。因此，控制器获取名称并将其显示为 JSON 响应。

这是控制器：

```
 import org.springframework.web.bind.annotation.RequestBody;
 import org.springframework.web.bind.annotation.RequestHeader;
 import org.springframework.web.bind.annotation.RequestMapping;
 import org.springframework.web.bind.annotation.RequestMethod;

@RequestMapping(value = "persons/info", method = RequestMethod.POST, consumes="application/json", produces="application/json")
public ResponseEntity<String> getPersonInfo(@RequestBody String body) throws Exception {    
    String personInfo = null;

    MyServiceJson myServiceJson = MyServiceJsonFactory.getMyServiceObject(body);

    personInfo = myService.getPersonInfo(myServiceJson);

    HttpHeaders responseHeader = new HttpHeaders();
    return Util.getResponse(personInfo, responseHeader, HttpStatus.OK);
} 
```

我收到如下所示的 JSON 响应：

```
{"name":"Jack"} 
```

这里的问题是这个名称字符串必须是 personName ，如下所示：

```
{"PersonName":"Jack"} 
```

我相信它正在从模型中获取变量名并按原样发送。谁能告诉我是否可以在 REST 服务中通过一些注释更改将不同的属性名称设置为“PersonName”？

如果有人可以在这里阐明一下，我将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:28:42.243

如果您使用的是 Jackson 库，我想您可以这样指定：

```
@JsonProperty("PersonName")
public String getName() {
    return name;
} 
```

# php - 为每个用户获取价值并加一

> ID：14886521
> 
> 赞同：0
> 
> 时间：2013-02-15T00:26:02.883
> 
> 标签：php, mysql

我将此脚本设置为每 5 分钟运行一次的 cron 作业，问题是它不会像我认为的那样增加能量水平。如果有人能告诉我我在这里做错了什么，那就太好了。请记住，这不会返回任何错误，只是不起作用，数据库连接信息也是正确的，只是在帖子之外。

```
{

    $energy = mysql_query("SELECT energy FROM members WHERE  id=$id");
    //get current users energy level
    $energy_max = mysql_query("SELECT energy-Max FROM members WHERE  id=$id");
    //get current users Maximum energy level

        if ($energy < $energy_max)
        // do -if current energy level is less than maximum
            {
                $energy = $energy ++;
                //increment energy by 1
                mysql_query("UPDATE members SET energy= $energy");
                //set the new energy level
            }
                $id++;
                //increment to the next user
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:29:06.280

您可以在单个语句中解决所有问题

```
UPDATE `members` SET `energy` = `energy` + 1 WHERE `energy-Max` > `energy`; 
```

这样你就有一个而不是 3 * 成员数查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:30:28.167

`mysql_query`不返回值，只返回所谓的*查询 id*。您必须获取实际数据：

```
$query = mysql_query("SELECT energy FROM members WHERE  id=$id");
$val = mysql_fetch_assoc($query); // Now the data is in $val['energy'] 
```

当然，您可以通过这个（如其他答案中所指出的）更快地做到这一点：

```
UPDATE members SET energy = energy + 1 WHERE energy < energy-Max; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:30:55.507

您忘记了`id = $id`更新语句中的 WHERE。

```
 mysql_query("UPDATE members SET energy= $energy WHERE id = $id"); 
```

但是 KingCrunch 的答案更好..

# c++ - Arduino：指针子类的继承和数组

> ID：14886524
> 
> 赞同：0
> 
> 时间：2013-02-15T00:26:25.127
> 
> 标签：c++, inheritance, arduino

这是上一个问题中的问题 #2：

[Arduino 代码中的继承](https://stackoverflow.com/questions/14883128/inheritance-in-arduino-code)

根据史蒂文的回答，我确实需要保存指针的数组在其范围之外持续存在，这会导致一些奇怪的行为。

这是我到目前为止的“Board”类，它包含多个子元素：

板.h：

```
#ifndef Board_h
#define Board_h

#include <StandardCplusplus.h>
#include <serstream>
#include <string>
#include <vector>
#include <iterator>

#include "Arduino.h"
#include "Marble.h"
#include "Wall.h"

class Board
{
  public:
    Board();
    void draw(double* matrix);
  private:
    Marble marble;
    //std::vector<Actor> children;
    Actor* children[2];

};
#endif 
```

板子.cpp：

```
#include "Arduino.h"
#include "Board.h"
#include <math.h>

#include <iterator>
#include <vector>

Board::Board()
{

}

void Board::create(double* _matrix, int _cols, int _rows) {

  Marble *marble = new Marble();
  Wall wall;
  children[0] = marble; 

  //children.push_back(marble);
  //children.push_back(wall);

}

void Board::draw(double* matrix) {
  Serial.println("board draw");
  children[0]->speak();  
} 
```

在我的“循环”函数中，我正在调用

```
board.draw(matrix); 
```

这导致一些疯狂的串行代码被写出。

显然，我不了解此处类中数组中指针的来龙去脉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:43:03.657

您需要使`Actor::speak`虚拟，编译器对虚拟方法使用动态绑定。

```
class Actor
{
  public:
    Actor();
    virtual void speak();  // virtual
  private:
}; 
```

# java - 在 Java 中计算两个 HashMap 的 keySet 的并集

> ID：14886525
> 
> 赞同：3
> 
> 时间：2013-02-15T00:26:30.000
> 
> 标签：java, hashmap, set

我想计算两个哈希图的键的并集。我写了以下代码（下面是MWE），但我

得到 UnsupportedOperationException。做到这一点有什么好处？

```
import java.util.HashMap;
import java.util.Map;
import java.util.Set;

public class AddAll {

    public static void main(String args[]){

        Map<String, Integer> first = new HashMap<String, Integer>();
        Map<String, Integer> second = new HashMap<String, Integer>();

        first.put("First", 1);
        second.put("Second", 2);

        Set<String> one = first.keySet();
        Set<String> two = second.keySet();

        Set<String> union = one;
        union.addAll(two);

        System.out.println(union);

    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T00:29:42.517

所以，`union`不是*副本*，`one`是*。* `one`它*是* `first.keySet()`。并且`first.keySet()`不是 的键的副本`first`，[它是一个*视图*，并且不支持添加](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#keySet%28%29)，如`Map.keySet()`.

所以你需要实际做一个副本。最简单的方法可能是写

```
 one = new HashSet<String>(first); 
```

它使用“复制构造函数”`HashSet`来进行实际复制，而不是仅仅引用同一个对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:31:32.447

请记住，这`keySet`是地图的实际数据，而不是副本。如果它让你打电话`addAll`到那里，你会将所有这些键转储到第一个没有值的地图中！HashMap 故意只允许您使用`put`实际映射的类型方法添加新映射。

您`union`可能想成为一个实际的新集合，而不是第一个 hashmapL 的支持数据

```
 Set<String> one = first.keySet();
    Set<String> two = second.keySet();

    Set<String> union = new HashSet<String>(one);
    union.addAll(two); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:31:23.673

改用下面的代码

```
import java.util.HashMap;
import java.util.Map;
import java.util.Set;

public class AddAll {

    public static void main(String args[]){

        Map<String, Integer> first = new HashMap<String, Integer>();
        Map<String, Integer> second = new HashMap<String, Integer>();
        Map<String, Integer> union = new HashMap<String, Integer>();
        first.put("First", 1);
        second.put("Second", 2);
        union.putAll(first);
        union.putAll(second);

        System.out.println(union);
        System.out.println(union.keySet());

    }

} 
```

# oop - “静态类”是否有通用定义？

> ID：14886526
> 
> 赞同：0
> 
> 时间：2013-02-15T00:26:36.737
> 
> 标签：oop, class, object, static

我以为我知道关于静态类的所有知识，直到我切换到 Java 并了解到几乎所有 C# 中的静态类无法完成的事情，都可以在 Java 中完成。

因此，如果我要说“静态类是一个不能被实例化并且不能有实例成员并且是密封的并且不能从 Object 以外的任何类派生的类”，我会假设什么是真实的一种编程语言适用于所有编程语言。

“静态类”是否有一个通用的定义，或者它只是实现该语言的人想要的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:36:47.433

许多 OO 概念或语言如何实现这些概念没有标准

Java 没有静态类，只有嵌套的静态类。它们是不同的东西。

# android - 在Android中，给定一个PID，如何知道它当前正在运行的活动和服务？

> ID：14886535
> 
> 赞同：1
> 
> 时间：2013-02-15T00:27:12.567
> 
> 标签：android, process

从`getRunningAppProcesses()`中，可以得到当前运行进程的所有 PID。

但是给定一个PID，它的进程当前可能携带一个activity（在任务栈的顶部）或者多个service，如何知道这些activity或者service的名字呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:51:42.390

[`getRunningServices`](http://developer.android.com/reference/android/app/ActivityManager.html#getRunningServices%28int%29)对于服务，您可以通过 pid调用和过滤。对于活动，您可以使用[`getRunningTasks`](http://developer.android.com/reference/android/app/ActivityManager.html#getRunningTasks%28int%29)，然后检索[`topActivity`](http://developer.android.com/reference/android/app/ActivityManager.RunningTaskInfo.html#topActivity)每个活动。您必须执行诸如按包过滤之类的操作，这很容易获得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-02T07:22:16.617

```
 button.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
        final Handler   handler = new Handler(); 

            final Runnable r = new Runnable() {
                public void run() { 
                    Log.e("start", "stsrt");

                    ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
                    List<RunningTaskInfo> tasks = activityManager.getRunningTasks(Integer.MAX_VALUE);
                    List<RunningAppProcessInfo> procInfos = activityManager.getRunningAppProcesses();

                    for (int i = 0; i < procInfos.size(); i++) {
                        Log.e("Running task", "Running task: " + procInfos.get(i).processName);
                    } 
                    handler.postDelayed(this, 1000);
                } 
            }; 

            handler.postDelayed(r, 1000);

        }
    }); 
```

# c# - WPF 插件无法识别

> ID：14886539
> 
> 赞同：1
> 
> 时间：2013-02-15T00:27:23.287
> 
> 标签：c#, wpf, plugins, expression-blend

我正在写一个与插件一起使用的应用程序。在主程序中，我通过在程序集中查找插件接口来加载所有插件。

我所有基于 WPF 的插件（VB.NET v4.0 和 C# v4.0）都会被识别，除了一个。该插件使用 ResourceDictionaries、大量模板和子目录。这个插件是在 Visual Studio 2010 和 Expression Blend 4 中基于 WPF 4.0 用 C# 编写的。

这很奇怪，因为插件在主程序中被识别。但经过几次测试和构建后，主程序停止识别插件。

我备份了工作插件和插件，不再识别。csproj 文件和设置几乎相同。

我找不到解决方案，谷歌也不太了解这个问题。

如果找到一些信息，XAML 代码会影响程序集，因此其他程序无法识别它。但是没有关于此的具体信息，也没有解决方案。

有没有人知道这个问题并且更好 - 有没有人知道解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:38:41.830

关于您的附加评论（XamlParseException）：

您是否在主项目（正在加载插件）和插件项目中引用了 System.Windows.Interactivity.dll？

# c++ - 从 C++ 代码与 C 交互的资源有哪些？

> ID：14886540
> 
> 赞同：1
> 
> 时间：2013-02-15T00:27:35.910
> 
> 标签：c++, c, interaction

我目前正在为我们的 C++ 产品开发 SDK。但是，我们的一些客户有一个用 C 语言编写的代码库，需要与我们的 SDK 交互。我需要提供 C 接口，并且正在寻找一些关于如何最好地解决这个问题的参考资料。

我正在使用 GNU 编译器（版本 4.6.3）。

我知道 extern "C" {} 构造并且很少使用它，但我并不是这方面的专家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:32:33.977

以下是我的建议：

1.  提供一些使用静态 C++ 对象来调用功能的 C 语言接口或函数。
2.  将静态函数添加到您的类以与 C 语言一起使用。
3.  更改您的设计，以便有接受结构和类的独立功能。
4.  此外，不要超载独立功能。

# facebook - 如何在阻止 www.facebook.com 的同时允许 webapp 对 facebook 进行身份验证？

> ID：14886546
> 
> 赞同：1
> 
> 时间：2013-02-15T00:28:45.937
> 
> 标签：facebook, authentication, web-applications

如何在阻止 www.facebook.com 的同时允许 webapp 对 facebook 进行身份验证？

公司正在使用一个使用 facebook 进行身份验证的 SAAS webapp。但我们不允许访问 www.facebook.com

# c++ - 与 *this 级联，返回对类常量的引用

> ID：14886549
> 
> 赞同：1
> 
> 时间：2013-02-15T00:29:18.467
> 
> 标签：c++

我有一个关于使用`return *this`C++ 中的语句进行级联的问题。我正在阅读一本教科书，并且遇到了我不完全理解的级联用法。

以下代码是我自己的构造：

```
#include <iostream>
using namespace std;

class Time
  {
  public:
     Time( int = 0, int = 0 ); 
     Time & setHour( int );                 
     void print( void );
     Time & operator+=( int ); // Line in Question 

  private:
     int hour; 
     int minute; 
  };

  Time::Time(int hr, int mn)
  {
     hour = hr;
     minute = mn;
  }

  Time & Time::operator+=(int increment) // Line in Question
  {
    hour += increment;
    return *this;
  }

  Time & Time::setHour(int h)
  {
    hour = h;
    return *this;
  }

  void Time::print( void )
  {
     cout << "hour = " << hour << endl;
     cout << "minute = " << minute << endl;
  }

int main()
{
   cout << "Hello, world!" << endl;
   Time t;
   (t+=3)+=4;
   t.print();
   int x = 4;
   (x+=4)+=5;
   cout << x << endl;
} 
```

请注意，`+=`运算符可以“级联”，就像我使用整数变量“级联”一样`x`。我正在阅读的文本似乎表明有问题的两行标有注释`// Line in Question`应该`const`在时间前面有关键字。也就是说，函数返回对 Time 对象常量的引用。我不明白为什么这是真的（或者这是有意义的情况），因为我们正在修改 Date 的数据成员。

`const`在行首标记关键字的目的是`// Line in Question`什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:35:10.503

> 在标记为 // Line in Question 的行开头使用关键字 const 的目的是什么？

从返回的`const`引用`operator +=`将具有**防止**您在函数中使用的那种级联的效果`main()`，例如：

```
(t+=3)+=4; 
```

这将被阻止，因为`t+=3`将返回对`Time`对象的常量引用，并且由于`operator +=`它本身没有限定为，因此在尝试应用于由返回的引用时`const`会出现编译错误目的）。`+= 4``const``t+=3``const``const`

我希望这本书的作者能够评论防止这种情况发生的原因。我个人不明白为什么它在这里有害。

# cuda - 正确理解 cuda 版本控制和兼容性

> ID：14886550
> 
> 赞同：0
> 
> 时间：2013-02-15T00:29:21.100
> 
> 标签：cuda

CUDA 编程指南指出：

```
the driver API is backward compatible, meaning that applications, plug-ins, and libraries (including the C runtime) compiled against a particular version of the driver API will continue to work on subsequent device driver releases 
```

我的理解是，如果我的代码是在 CUDA4 上编译的，那么二进制文件将在 CUDA5 上运行。然而，事实证明，在 CUDA5 上运行 CUDA5 编译的二进制文件会导致：

```
error while loading shared libraries: libcudart.so.4: cannot open shared object file: No such file or directory 
```

请注意，我使用 Linux 中的“模块”工具在不同的 cuda 版本之间切换，即

```
module load cuda4
compile
module unload cuda4
module load cuda5
run 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:07:08.770

将 libcudart.so.4 与应用程序打包是开发人员的责任。module 命令可能会更改您的 LD_LIBRARY_PATH 或 PATH 变量，因此 LDD 找不到 libcudart.so.4。我建议您添加一个后期构建步骤以将所需的 .so 复制到您的应用程序目录中。

CUDA Toolkit 目录根目录的 EULA.txt 中的附件 A 列出了可再发行软件。这包括 libcudart.so（以及在文件名中嵌入了版本号信息的变体）。这还包括 libcufft、libcublas、...

# javascript - IE8 中使用 Backbone.js w/Require.js 的站点出现错误

> ID：14886553
> 
> 赞同：2
> 
> 时间：2013-02-15T00:29:51.193
> 
> 标签：javascript, jquery, backbone.js, internet-explorer-8, requirejs

我在 IE8 中返回以下错误：

> 消息：预期对象行：27 字符：1 代码：0 URI： [http ://cdn.example.com/images/example4/js/libs/jquery.backgroundSize.js](http://cdn.example.com/images/example4/js/libs/jquery.backgroundSize.js)
> 
> 消息：'$.fn' 为空或不是对象行：8 字符：1 代码：0 URI： [http ://cdn.example.com/images/example4/js/libs/jquery.waitUntilExists.js](http://cdn.example.com/images/example4/js/libs/jquery.waitUntilExists.js)
> 
> 消息：'fn' 为空或不是对象行：62 字符：73 代码：0 URI： [http ://cdn.example.com/images/example4/js/libs/jquery.nicescroll.js](http://cdn.example.com/images/example4/js/libs/jquery.nicescroll.js)
> 
> 消息：对象预期行：34 字符：231 代码：0 URI： [http ://cdn.example.com/images/example4/js/libs/backbone.js](http://cdn.example.com/images/example4/js/libs/backbone.js)
> 
> 消息：'Vent' 为空或不是对象行：19 字符：3 代码：0 URI：[http ://cdn.example.com/images/example4/js/models/auth.js](http://cdn.example.com/images/example4/js/models/auth.js)

我们的网站是一个使用 Backbone.js 和 Require.js 构建的 SPA，用于依赖管理。这个问题只出现在 IE8（可能还有更早的版本）上。这些文件中的每一个，除了最后一个是因为 'Vent' 扩展 Backbone.Event 引起的，都在我们的 Require.js 配置文件中创建为 Backbone.js 的垫片。

Require.js 配置：

```
requirejs.config({
    baseUrl: 'http://cdn.staging.example.com/images/example4/js',
    paths: {
        underscore: './libs/underscore',
        jquery: './libs/jquery',
        backbone: './libs/backbone',
        example: './libs/example',
        blockui: './libs/jquery.blockUI',
        backgroundsize: './libs/jquery.backgroundSize',
        nicescroll: './libs/jquery.nicescroll',
        waituntilexists: './libs/jquery.waitUntilExists',
        swfobject: './libs/swfobject',
        spinner: './libs/jquery.spinner'
    },
    //Create shims for Backbone
    shim: {
        'backgroundsize': {
            deps: [ 'jquery'],
            exports: 'backgroundsize'
        },
        'nicescroll': {
            deps: ['jquery'],
            exports: 'nicescroll'
        },
        'waituntilexists': {
            deps: ['jquery'],
            exports: 'waituntilexists'
        },
        'spinner': {
            deps: ['jquery'],
            exports: 'spinner'
        },
        'backbone': {
            deps: [ 'underscore', 'jquery','blockui','backgroundsize','nicescroll', 'waituntilexists', 'swfobject', 'spinner'],
            exports: 'Backbone'
        }
    }
});

requirejs(['app'],
    function(App){
        App.initialize();
    }); 
```

任何会导致此问题的建议，我们都在使用 Backbone.js 0.9.2 和 Require.js 2.0.6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T11:37:11.207

尝试像这样将主干添加到您的主要需求中：

```
 requirejs(['app', 'backbone'], function(App){ App.initialize(); }); 
```

另外，尝试使用 r.js 生成一个连接文件（确保关闭优化），您可以看到 require 加载脚本的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T08:46:01.683

IE 的垫片存在一些问题，您可以在此处阅读[http://requirejs.org/docs/errors.html#nodefine](http://requirejs.org/docs/errors.html#nodefine)

据我了解[http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)

> 仅使用其他“填充”模块作为填充脚本的依赖项，或没有依赖项的 AMD 库，并在它们也创建全局（如 jQuery 或 lodash）后调用 define()。否则，如果您使用 AMD 模块作为 shim 配置模块的依赖项，则在构建之后，该 AMD 模块可能直到构建中的 shimed 代码执行后才被评估，并且将发生错误。最终的解决方法是升级所有填充代码以具有可选的 AMD define() 调用。

将 jquery 作为 shim 的依赖项可能存在问题，或者未加载 jquery，因此无法将其设置为全局。

# asp.net-mvc - 如何使用jquery mobile asp.net mvc 4 下载并显示pdf内存流数据

> ID：14886555
> 
> 赞同：0
> 
> 时间：2013-02-15T00:30:09.163
> 
> 标签：asp.net-mvc, jquery-mobile, pdf-generation

我有一个桌面/移动网络应用程序，需要在目标设备上显示 pdf 流。我现在使用 jquery 对话框在桌面上工作。对于移动端...我的 html 查看页面有以下链接：

```
 <a href="@Url.Action("PdfView", new { id = @paystub.PayStub_ID})">View PDF</a> 
```

这正确地将我带入了控制器操作：

```
 public ActionResult PdfView(string id = "")
    {
        PayStubDataEntity ps = PayStubAccess.GetPayStubByID(new Guid(id), new Guid(Session["Session_Application_UserID"].ToString()));
        WebHelper.SetHeadersForDownload(System.Web.HttpContext.Current.Response, "application/pdf", "PayStub.pdf", false);
        MemoryStream pdfMemoryStream = SendPayStubToBrowserAsPdf(ps);
        //WebHelper.SendFile(System.Web.HttpContext.Current.Response, "application/pdf", "PayStub.pdf", false, pdfMemoryStream);
        return File(pdfMemoryStream, "application/pdf");
    } 
```

但是我的 iphone 模拟器（电梅）上什么也没有出现。没有错误信息。我不确定输出 s/b 去哪里或如何查看它？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T18:19:23.883

我们在安卓手机上也有同样的问题，可能有两个问题正在发生。如果网站使用 ssl 并且您所在的手机不接受它作为有效的 ssl，它会在管理器中显示正在下载 pdf，但它永远不会完成下载。第二个问题是您发送到手机的文件需要命名才能正确下载到手机。

例如：return File(pdfMemoryStream, "application/pdf", fileDownloadName:"PayStub.pdf");

我建议使用谷歌浏览器进行手机模拟。当您更改设置时，它的行为将与手机相似，您可以轻松调试。例如，当我将 Google Chrome 设置为手机用户代理 Android 4.0.2 时，它将下载 pdf，而不是在网络浏览器中显示。当它这样做时，我知道它在本地工作。它还具有 iPhone 仿真。

# ruby-on-rails - 标记在acts_as_taggable_on中保存在哪里

> ID：14886558
> 
> 赞同：0
> 
> 时间：2013-02-15T00:30:36.203
> 
> 标签：ruby-on-rails

好的，我试图在这里保持简单并在 rails 控制台中进行测试。但是，我似乎无法弄清楚如何保存标签并再次读取它们。正如您从下面的粘贴中看到的那样，我无法保存@consumer 对象（带有标签）然后读出标签..

[http://pastebin.com/txpuf09g](http://pastebin.com/txpuf09g)

```
1.9.3p286 :001 > @consumer = Consumer.first
Creating scope :page. Overwriting existing method Consumer.page.
  Consumer Load (1.3ms)  SELECT "consumers".* FROM "consumers" LIMIT 1
 => #<Consumer id: 29, hl: nil, created_at: "2012-10-27 23:27:15", updated_at: "2012-10-27 23:27:15", user_id: 33, display_name: nil, tagline: nil, desc: nil>
1.9.3p286 :002 > @consumer.tags
  ActsAsTaggableOn::Tag Load (2.3ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 29 AND "taggings"."taggable_type" = 'Consumer' AND (taggings.context = 'tags')
 => []

1.9.3p286 :003 > @consumer.tag_list
  ActsAsTaggableOn::Tag Load (1.4ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 29 AND "taggings"."taggable_type" = 'Consumer' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)
 => []
1.9.3p286 :004 > @consumer.tag_list = "hi, ho"
 => "hi, ho"
1.9.3p286 :005 > @consumer
 => #<Consumer id: 29, hl: nil, created_at: "2012-10-27 23:27:15", updated_at: "2012-10-27 23:27:15", user_id: 33, display_name: nil, tagline: nil, desc: nil>
1.9.3p286 :006 > @consumer.save
   (0.4ms)  BEGIN
   (0.7ms)  UPDATE "consumers" SET "updated_at" = '2013-02-15 00:25:05.187733' WHERE "consumers"."id" = 29
  ActsAsTaggableOn::Tag Load (0.8ms)  SELECT "tags".* FROM "tags" WHERE (lower(name) = 'hi' OR lower(name) = 'ho')
  ActsAsTaggableOn::Tag Exists (0.6ms)  SELECT 1 AS one FROM "tags" WHERE "tags"."name" = 'hi' LIMIT 1
  SQL (1.3ms)  INSERT INTO "tags" ("name") VALUES ($1) RETURNING "id"  [["name", "hi"]]
  ActsAsTaggableOn::Tag Exists (0.5ms)  SELECT 1 AS one FROM "tags" WHERE "tags"."name" = 'ho' LIMIT 1
  SQL (0.4ms)  INSERT INTO "tags" ("name") VALUES ($1) RETURNING "id"  [["name", "ho"]]
  ActsAsTaggableOn::Tag Load (0.7ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 29 AND "taggings"."taggable_type" = 'Consumer' AND (taggings.context = 'tags' AND taggings.tagger_id IS NULL)
  ActsAsTaggableOn::Tagging Exists (0.7ms)  SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 5 AND "taggings"."taggable_type" = 'Consumer' AND "taggings"."taggable_id" = 29 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL) LIMIT 1
  SQL (1.5ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["context", "tags"], ["created_at", Fri, 15 Feb 2013 00:25:05 UTC +00:00], ["tag_id", 5], ["taggable_id", 29], ["taggable_type", "Consumer"], ["tagger_id", nil], ["tagger_type", nil]]
  ActsAsTaggableOn::Tagging Exists (0.7ms)  SELECT 1 AS one FROM "taggings" WHERE ("taggings"."tag_id" = 6 AND "taggings"."taggable_type" = 'Consumer' AND "taggings"."taggable_id" = 29 AND "taggings"."context" = 'tags' AND "taggings"."tagger_id" IS NULL AND "taggings"."tagger_type" IS NULL) LIMIT 1
  SQL (0.5ms)  INSERT INTO "taggings" ("context", "created_at", "tag_id", "taggable_id", "taggable_type", "tagger_id", "tagger_type") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["context", "tags"], ["created_at", Fri, 15 Feb 2013 00:25:05 UTC +00:00], ["tag_id", 6], ["taggable_id", 29], ["taggable_type", "Consumer"], ["tagger_id", nil], ["tagger_type", nil]]
   (11.9ms)  COMMIT
 => true
1.9.3p286 :007 > Consumer.first.tags
  Consumer Load (0.9ms)  SELECT "consumers".* FROM "consumers" LIMIT 1
  ActsAsTaggableOn::Tag Load (1.0ms)  SELECT "tags".* FROM "tags" INNER JOIN "taggings" ON "tags"."id" = "taggings"."tag_id" WHERE "taggings"."taggable_id" = 30 AND "taggings"."taggable_type" = 'Consumer' AND (taggings.context = 'tags')
 => [] 
```

此外，我在我的数据库中找不到标签或标记作为表。感谢您帮助我理解这一点。

编辑：

我想我看到了问题.. 在标记表中，我看到了 id、tag_id、taggable_id、taggable_type、tagger_id、tagger_type、上下文列.. 除了 tagger_id 和 tagger_type 之外，这些行似乎是完整的。您认为这与未与消费者 ID 关联的标签有关吗？我想问题是，Consumer.id 实际上应该出现在标记表中的哪个位置。目前 Consumer.first.id 不在标记的任何列中！Consumer.first.id == 30

![在此处输入图像描述](../Images/6d2818c175d70145162022c070bad59e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:45:34.677

尝试通过附加到 tags_list 的数组

```
@consumer.tag_list << "foo"
@consumber.save 
```

然后保存

在您的情况下，acts_as_taggable_on 也会创建一个名为标签的表格。如果您没有看到它，您可能想要运行迁移。

# facebook - 我的用户应该如何邀请他们的 Facebook 朋友使用我的网络应用程序？

> ID：14886567
> 
> 赞同：7
> 
> 时间：2013-02-15T00:31:11.527
> 
> 标签：facebook, facebook-graph-api

我们有一个应用程序，用户可以在其中以小型私人群组进行交互。我们希望允许我们的用户邀请他们的 Facebook 朋友加入一个群组。我们之前在朋友的时间线上发布了一个私人链接，但 Facebook 上周禁用了该链接：[https ://developers.facebook.com/roadmap/#february-2013](https://developers.facebook.com/roadmap/#february-2013)

apprequest 对话框将不起作用，因为它仅限于画布和移动应用程序：

> 请求仅适用于 Desktop Canvas、iOS 和 Android 应用程序。在 Canvas 上接受请求会将用户定向到发送请求的应用程序的 Canvas 页面 URL。对于本机移动应用程序，接受请求将引导用户访问其设备上的应用程序（如果已安装）或适当的位置（Apple App Store 或 Google Play）以下载应用程序。

来自：http: [//developers.facebook.com/docs/reference/dialogs/requests/](http://developers.facebook.com/docs/reference/dialogs/requests/)

我正在考虑使用 Facebook Open Graph 并创建一个动作和提及标签，但这似乎是一个 hack，我认为参与度不会那么高。

你认为最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T17:41:52.020

使用发送在私人消息中邀请他们。

[https://developers.facebook.com/docs/sharing/reference/send-dialog](https://developers.facebook.com/docs/sharing/reference/send-dialog)

# android - 如何将图像移动到屏幕上我想要的位置？

> ID：14886574
> 
> 赞同：0
> 
> 时间：2013-02-15T00:31:36.853
> 
> 标签：android, image, drawable

如何将 eclipse 中的图像（已经在 drawables 文件中）移动到屏幕上的特定位置？这是我尝试过的代码，不要认为它甚至接近......

这看起来怎么样？

```
SurfaceHolder surfaceHolder;
SurfaceView surface = new SurfaceView(this);

Rect rect = new Rect(0,0,100,100); 
```

这是在 onCreate

```
 LinearLayout layout = (LinearLayout) findViewById(R.layout.activity_test2);
    surfaceHolder = surface.getHolder();
    layout.addView(surface); 
```

（公众视野在我的主要活动中）

```
 public void onDraw(Canvas canvas) {

    canvas = surfaceHolder.lockCanvas();

    Bitmap image1 = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);
    canvas.drawBitmap(image1, null, rect, null);

    surfaceHolder.unlockCanvasAndPost(canvas);
} 
```

LOGCAT

```
02-15 01:42:16.824: W/Trace(2782): Unexpected value from nativeGetEnabledTags: 0
02-15 01:42:16.824: W/Trace(2782): Unexpected value from nativeGetEnabledTags: 0
02-15 01:42:49.993: W/Trace(2782): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.026: W/Trace(2992): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.026: W/Trace(2992): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.026: W/Trace(2992): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.474: W/Trace(2992): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.505: W/Trace(2992): Unexpected value from nativeGetEnabledTags: 0
02-15 01:43:03.544: D/AndroidRuntime(2992): Shutting down VM
02-15 01:43:03.544: W/dalvikvm(2992): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
02-15 01:43:03.733: E/AndroidRuntime(2992): FATAL EXCEPTION: main
02-15 01:43:03.733: E/AndroidRuntime(2992): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.test2/com.example.test2.Test2}: java.lang.NullPointerException
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.os.Looper.loop(Looper.java:137)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at java.lang.reflect.Method.invokeNative(Native Method)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at java.lang.reflect.Method.invoke(Method.java:511)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at dalvik.system.NativeStart.main(Native Method)
02-15 01:43:03.733: E/AndroidRuntime(2992): Caused by: java.lang.NullPointerException
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.content.ContextWrapper.getResources(ContextWrapper.java:89)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.view.ContextThemeWrapper.getResources(ContextThemeWrapper.java:78)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.view.View.<init>(View.java:3224)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.view.SurfaceView.<init>(SurfaceView.java:181)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at com.example.test2.Test2.<init>(Test2.java:44)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at java.lang.Class.newInstanceImpl(Native Method)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at java.lang.Class.newInstance(Class.java:1319)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
02-15 01:43:03.733: E/AndroidRuntime(2992):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
02-15 01:43:03.733: E/AndroidRuntime(2992):     ... 11 more
02-15 01:43:11.183: I/Process(2992): Sending signal. PID: 2992 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:07:49.983

你需要一个 SurfaceView 来保存你的画布。就像您可以设置 LayoutParams 的任何其他视图一样。

## activity_main.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" >
    <LinearLayout
        android:id="@+id/myLayout"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >
    </LinearLayout>
</LinearLayout> 
```

## MainActivity.java

```
package com.sample.androidcrashtest;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.os.Bundle;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.widget.LinearLayout;
import android.widget.FrameLayout.LayoutParams;

public class MainActivity extends Activity{

    Canvas canvas; //Your canvas to draw on
    LinearLayout myLayout; //The layout that holds the surfaceview
    SurfaceView surface;
    SurfaceHolder surfaceHolder;

    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.activity_main);
        myLayout = (LinearLayout) findViewById(R.id.myLayout);

        LinearLayout.LayoutParams params_surfaceCanvas = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);

        surface = new SurfaceView(this);
        surface.setLayoutParams(params_surfaceCanvas);

        //Assign a surfaceholder to the surface
        surfaceHolder = surface.getHolder();

        myLayout.addView(surface);
        canvas = new Canvas();

        //Call on draw method
        onDraw();
    }

    public void onDraw() {
        //Starts a thread
        new Thread(new Runnable() {
            public void run() {
                while(true) {
                    //Loops until surfaceHolder is valid to use
                    if (surfaceHolder.getSurface().isValid()) {
                        Log.i("Drawing","Drawing"); 
                        //Always lock the canvas if you want to draw in surfaceview
                        canvas = surfaceHolder.lockCanvas();

                        Bitmap image1 = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);
                        canvas.drawColor(Color.WHITE); //The background color of the canvas
                        canvas.drawBitmap(image1, 100, 100, null);

                        //Don't forget to unlock it after you draw in the surfaceview
                        surfaceHolder.unlockCanvasAndPost(canvas);

                        //breaks the while and end the thread.
                        break;
                    }
                }
            }
        }).start();
    }
} 
```

# java - 与声纳插件关联...空组 ID

> ID：14886575
> 
> 赞同：0
> 
> 时间：2013-02-15T00:31:45.680
> 
> 标签：java, eclipse-plugin, sonarqube

我正在尝试使用打鼾插件来分析我的代码。1- 我确实安装了插件。 2- 我确实安装了服务器并且它已连接

作为文档中的说明..我做了关联，但它没有链接到声纳服务器。

我不知道为什么..旁边没有在关联的过滤器中显示组 ID..

[http://docs.codehaus.org/display/SONAR/Configuring+Sonar+in+Eclipse](http://docs.codehaus.org/display/SONAR/Configuring+Sonar+in+Eclipse)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T08:19:57.347

如果您仔细阅读该文档，您必须首先对您的项目运行 Sonar 分析，以便它显示在 Sonar Web 应用程序中。然后只有您才能在 Eclipse 中关联它。

总结一下：

1.  首先你在 shell 中运行“mvn clean install”和“mvn sonar:sonar”
2.  然后检查是否可以在浏览器中浏览项目
3.  最后你可以尝试在 Eclipse 中关联它

# java - Struts2，OPENJPA DAO。这是 DAO-CRUD 的好设计吗？

> ID：14886579
> 
> 赞同：1
> 
> 时间：2013-02-15T00:32:08.477
> 
> 标签：java, struts2, dao, crud, openjpa

你觉得这个粗鲁的设计怎么样。我正在使用 openjpa 2.2，struts2。我也在使用接口进行插入删除更新。我有一个名为 Product 的实体。我是一个初学者，我想知道你们是如何创建或设计这种功能的。如果您想了解更多信息，请说出来。谢谢

我的界面。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package lotmovement.business.crud.crudinterface;

/**
 *
 * @author god-gavedmework
 */
public interface CrudInterface {

    public void Insert();
    public void Delete();
    public void Update();

} 
```

我的主要 CRUD 类。

```
*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package lotmovement.business.crud;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import lotmovement.business.crud.crudinterface.CrudInterface;
import lotmovement.business.entity.Product;

/**
 *
 * @author god-gavedmework
 */
public class ProductCrud implements CrudInterface {

    private Date today;
    EntityStart entityStart;
    Product product;

    public Date getToday() {
        return today;
    }

    public void setToday(Date today) {
        this.today = today;
    }

    public EntityStart getEntityStart() {
        return entityStart;
    }

    public void setEntityStart(EntityStart entityStart) {
        this.entityStart = entityStart;
    }

    public Product getProduct() {
        return product;
    }

    public void setProduct(Product product) {
        this.product = product;
    }

    public void Insert() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    public void Insert(Product product) 
            {
        entityStart.StartDbaseConnection();

        DateFormat dateFormat = new SimpleDateFormat("dd-MM-yyyy");
        DateFormat timeFormat = new SimpleDateFormat("hh:mm:ss a");

        setToday(new Date());
        String dateToday = dateFormat.format(getToday());
        String timeToday = timeFormat.format(getToday());
       // product.setProduct_Id(product_Id);
      //  product.setSerial_Number(serial_Number);
      //  product.setDate_Assembled(date_Assembled);
      //  product.setModel(model);
      ///  product.setBatch_Id(batch_Id);
     //   product.setProcess_Code(process_Code);
     //   product.setDc_Power_PCB_Serial(dc_Power_PCB_Serial);
      //  product.setControl_Power_PCB_Serial(control_Power_PCB_Serial);
      //  product.setMains_Power_PCB_Serial(mains_Power_PCB_Serial);
      //  product.setBlower_Serial(blower_Serial);
      //  product.setHeaterPlate_Serial(heaterPlate_Serial);
     //   product.setLast_Process(last_Process);

        product.setTime_Assembled(timeToday);
        product.setDate_Assembled(dateToday);

        entityStart.StartPopulateTransaction(product);

        entityStart.CloseDbaseConnection();

    }

    @Override
    public void Delete() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    public void Update() {
        throw new UnsupportedOperationException("Not supported yet.");
    }
} 
```

我的openjpa工厂类

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package lotmovement.business.crud;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;

public class EntityStart {
    public EntityManagerFactory factory;
    public EntityManager em;

    public void StartDbaseConnection()
    {

        factory = Persistence.createEntityManagerFactory("LotMovementPU");
        em = factory.createEntityManager();

    }

    public void Begintransaction(){

        EntityTransaction userTransaction = em.getTransaction();
        userTransaction.begin();

    }

    public void StartPopulateTransaction(Object entity){

        EntityTransaction userTransaction = em.getTransaction();

        userTransaction.begin();

        em.merge(entity);
        userTransaction.commit();
        em.close();
    }

    public void CloseDbaseConnection(){
        factory.close();
    }

} 
```

# java - 将二进制数据添加到 html 表单以进行上传

> ID：14886582
> 
> 赞同：1
> 
> 时间：2013-02-15T00:32:35.000
> 
> 标签：java, javascript, html

背景：我必须支持IE7-9中的多个文件上传。我发现uploadify 和FileReader 都是基于flash 的。我们当前的文件上传允许用户选择文件、输入描述并选中一些复选框。这些数据同时发送到上传 servlet，servlet 获取文件数据、描述和复选框值，并将文件存储在服务器上，并在数据库中添加一个条目。

问题：uploadify 和 FileReader 都想将文件直接发送到服务器，我没有机会添加描述或设置任何标志。我现在已经使用过一些 FileReader 并且可以拦截文件而不是将其发送到服务器。我想做的是获取二进制数据并将其放入表单中，让用户添加描述，然后使用二进制文件数据提交表单。我已经准备好尝试在表单中添加一个隐藏字段，但数据似乎没有通过。

如果情况变得更糟，我想我可以上传文件，然后在提交表单时更新数据库，我不想这样做，但我认为这会奏效。有谁知道无论如何要将文件数据添加到表单中，然后让 servlet 将该数据识别为表单的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:38:21.257

您可以在 Uploadify 中将数据与上传一起传递，只需使用这样的`formData`属性（[在此处找到](http://www.uploadify.com/documentation/uploadifive/customizing-the-server-side-upload-script-2/)）：

```
<input name='someKey' type='text' value='Some Value'/>
<input type="file" name="file_upload" id="file_upload" />
<script>
$('#file_upload').uploadify({
    // Some options
    'method'   : 'post',
    'formData' : { 'someKey' : $('input[name=someKey]').val() }
});
</script> 
```

# css - 我正在使用瓷砖，但 baselayout 的 css 文件不会应用于所有页面

> ID：14886588
> 
> 赞同：0
> 
> 时间：2013-02-15T00:33:33.947
> 
> 标签：css, jsp, struts2, tiles

问题是我有一个从我的 baselayout.jsp 文件指向的 css 文件，如下所示，当我在 index.php 中时，它应用 css，但当我移动到 Profile/view.jsp 时它没有。

当我查看源代码时，我注意到它正在查看 Profile/stylesheets/Base.css 中的 css 文件，而不是 myproject/stylesheets/Base.css，如何以适用于所有页面的方式指向它。

```
 <link href="<s:url value="/stylesheets/mycss.css"/>" rel="stylesheet"
type="text/css" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:48:02.737

轻而易举，只需将地址更改为固定地址，如下所示

```
 http://www.example.com/myPreoject/stylesheets/Base.css 
```

# vba - IMAP 文件夹上的 Outlook ItemAdd 事件仅在选择文件夹时触发

> ID：14886589
> 
> 赞同：4
> 
> 时间：2013-02-15T00:33:38.387
> 
> 标签：vba, outlook

我在 Outlook VBA 编程方面遇到了一个小问题，想知道是否有解决方案，或者这只是另一个“已知问题”。

* * *

**上下文**：

我已配置 Outlook 电子邮件帐户以通过 IMAP 访问我的网络电子邮件提供商。在 Outlook 中，我可以正确查看我的网络电子邮件文件夹。我的提供商的垃圾邮件过滤器将垃圾邮件移入垃圾邮件文件夹。

我想自动将放入垃圾邮件文件夹的邮件移动到我本地 pst 文件中的另一个文件夹中。

我让它工作了 99%（通过下面提供的代码供参考）。

* * *

**问题**：

我可以看到垃圾邮件文件夹中有邮件（文件夹名称旁边有一个粗体的未读邮件计数），但 ItemAdd 甚至只会在我单击文件夹时触发。那时，我看到了垃圾邮件文件夹的内容，然后看到所有新的垃圾邮件都被移到了我的本地文件夹中。

除了 ItemAdd 之外，是否还有另一个触发源可以用来运行我的代码而无需单击文件夹？当文件夹的未读计数发生变化时是否会触发事件？

* * *

**技术细节**：

*   视窗 8 操作系统
*   使用 Outlook 2002（是的，我知道...）
*   我是一位经验丰富的 C/C++ 开发人员，但在 VBA 方面的经验很少，而且在 Outlook 方面没有经验。

VBA代码：

```
Public WithEvents myItems As Outlook.Items

Public Sub Application_Startup()

    Dim myNameSpace As Outlook.NameSpace
    Const mailboxName As String = "Mail.com"
    Const subfolderName As String = "Spam"

    ' Reference the items in the MAPI spam folder
    ' Because myOlItems is declared "WithEvents" the ItemAdd event will fire below.
    Set myNameSpace = Application.GetNamespace("MAPI")

    On Error GoTo noSpamFolder
    Set myItems = myNameSpace.Folders(mailboxName).Folders(subfolderName).Items
    On Error GoTo 0

    Exit Sub

noSpamFolder:
    MsgBox "Unable to find folder <" & mailboxName & "/" & subfolderName & ">"

End Sub

Private Sub myItems_ItemAdd(ByVal Item As Object)

    Dim suspectFolder As Outlook.MAPIFolder

    ' Check to make sure it is an Outlook mail message, otherwise
    ' subsequent code will probably fail depending on what type
    ' of item it is.
    If TypeName(Item) = "MailItem" Then

       ' Move message to the 'suspect' folder
       On Error GoTo noSuspectFolder
       Set suspectFolder = Outlook.Session.GetDefaultFolder(olFolderInbox).Folders("suspect")
       On Error GoTo 0

       Item.Move suspectFolder

    End If

    Exit Sub

noSuspectFolder:
    MsgBox "Unable to find folder <suspect> as a sub-folder of default inbox folder"
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-14T23:31:49.613

在发送邮件并使用您的代码执行此任务后，我正在努力解决类似的问题来移动邮件（谢谢！）。有几个问题仍然需要解决。

首先，这些项目被移动了，但在它们被放入垃圾文件夹之后。这似乎是 IMAP 问题（Gmail），可以通过将邮箱帐户的 Internet 电子邮件设置从“将已删除的项目移动到服务器上的以下文件夹”更改为“标记要删除的项目但不移动它们”来解决自动地”。

The second challenge was, like yours, trigger the code to do its work. In the account configuration the save sent emails option is disabled (since this is automatically performed by the Gmail server). I needed to sync the Sent items (MAPI) folder with the Send items (IMAP) folder. **I achieved this by configuring the "send/receive" groups for this email account (in the group All account) and selecting the Sent items folder**.

Now this folder is synced without the necessity to open the folder for syncing. I hope that this will also resolve your issue.

Peter

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:40:26.077

这是有道理的 - Outlook 中的 IMAP 提供程序仅在通过 Outlook 对象模型选择或访问该文件夹时才同步该文件夹。
我认为除了每隔一段时间轮询一次文件夹（并在两次点击之间释放 MAPIFolder 对象）之外，您无能为力

# java - 只有静态方法的类应该是抽象的吗？

> ID：14886591
> 
> 赞同：9
> 
> 时间：2013-02-15T00:34:02.923
> 
> 标签：java

我有一个提供静态实用程序类型方法集合的类。

一方面，我不希望类能够被实例化。另一方面，我不想发送应该继承类的信号（不是我认为它可能）。

这个类应该是抽象的还是不抽象的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T00:35:25.323

制作类`final`并制作默认构造函数`private`，并且不提供任何`public`构造函数。这样，没有人可以继承它或创建它的实例。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-15T00:35:23.950

不要声明它`abstract`；声明一个`private`构造函数，所以没有人，甚至是子类，都不能实例化你的实用程序类的实例。

你可以声明你的类`final`，尽管如果所有的构造函数都是`private`，那么无论如何都没有人能够继承它。

要从另一个答案中的 Pshemo 评论中借用这个想法，请在构造函数中抛出 RuntimeException 以防止[AccessibleObject](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/AccessibleObject.html)`setAccessible`中的反射方法允许实例化：

```
public class MyUtility
{
   private MyUtility()
   {
      throw new RuntimeException("Instantiation of MyUtility is not allowed!");
   }

   public static void utilityMethod()
   {
      // Your utility method here.
   }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T00:36:27.363

尽管无法声明顶级类`static`，但您可以通过声明默认构造函数使该类对其他类不可实例化（实际上是“静态”），该构造函数`private`禁止实例化，因为没有构造函数可见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T01:08:23.623

[@mre](https://stackoverflow.com/users/584862/mre) [答案](https://stackoverflow.com/a/14886603/1393766)的另一个版本

```
enum MyClass{
    ;//this semicolon indicates that this enum will have no instances

    //now you can put your methods
    public static void myMethod(){
        //...
    }
} 
```

默认情况下，枚举是最终的，其构造函数是私有的。你也不能用反射创建它的实例，因为如果你试图实例化 Enum 对象，它会检查[Constructor#newInstance 。](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/lang/reflect/Constructor.java?av=f#519)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T00:49:43.373

说真的，你不必做*任何事情*。不会发生任何不好的事情，没有人会实例化/子类您的类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-15T00:35:49.130

一个类中包含的内容与它是否应该是抽象的无关。关键是：一个抽象类*必须*有另一个类扩展它（一个“具体”类）；只有那个具体的类可以被实例化。

为防止它被扩展，请使用`final`.

为了防止它被实例化，请创建构造函数`private`。

请注意，在 Java 中，这些是离散的概念。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-15T00:35:59.127

不，它是一个实用程序类。
它应该`final`使用`private`默认构造函数，以避免实例化。如果您启用了 checkstyle，如果您不这样做，您会收到警告。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-15T00:38:35.893

除了为类提供私有构造函数的所有其他调用之外，您还应该将其设为 final，以便清楚地知道没有任何东西可以子类化它。

```
public final class Utils
{
    // prevent accidental construction.
    private Utils() 
    {  
    } 

    public static void foo()
    { 
        //util code here
    }
} 
```

# php - php回显不起作用

> ID：14886592
> 
> 赞同：0
> 
> 时间：2013-02-15T00:34:12.233
> 
> 标签：php, mysql, forms, echo

我的代码似乎不起作用..单选按钮出现但它们旁边没有..似乎mysql_fetch_array由于某种原因无法正常工作，因为我已经玩过代码并反复测试它以找到代码似乎遇到的地方出现问题并停止工作..有人可以告诉我出了什么问题吗？干杯 ps。我是新手，最近几天才完成了 w3schools 上的 php 教程的学习。

```
<body>

<?php

include 'dbyear2.php';

          $qnumber = $_REQUEST['uqn']; // obtain question number from URL

         $find = mysql_query("SELECT * FROM Renal WHERE UQN='$qnumber'");

              while($retrieve=mysql_fetch_array($find));
        {

$retrieve['question'] = $question;
$retrieve['MCQ_A'] = $a;
$retrieve['MCQ_B'] = $b;
$retrieve['MCQ_C'] = $c;
$retrieve['MCQ_D'] = $d;
$retrieve['MCQ_E'] = $e;
$retrieve['answer'] = $answer;
$retrieve['MCQ_correct'] = $correct;

   }

  ?>

             <form action='check.php' method='POST'>  

         <table> 

<tr><td></td><td></td></tr>
<tr></tr>
<tr><td><input type='radio' name='group1' value='A' /></td><td> <?php echo $a; ?></td></tr>
<tr><td><input type='radio' name='group1' value='B' /></td><td> <?php echo $b; ?></td></tr>
<tr><td><input type='radio' name='group1' value='C' /></td><td> <?php echo $c; ?></td></tr>
<tr><td><input type='radio' name='group1' value='D' /></td><td> <?php echo $d; ?></td></tr>
<tr><td><input type='radio' name='group1' value='E' /></td><td> <?php echo $e; ?></td></tr> 
<tr>

<?php 

// sending the retrieved information from MYSQL via POST for use in check.php file

$qnumber;
$a;
    $b;
   $c;
      $d;
     $e;
      $answer;
 $correct;

  ?></tr>
       <tr><td><input type="submit" value="Submit"></td></tr>

     </table>

        </form>

      </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T00:35:59.370

这部分是倒退的：

```
$retrieve['question'] = $question;
$retrieve['MCQ_A'] = $a;
$retrieve['MCQ_B'] = $b;
$retrieve['MCQ_C'] = $c;
$retrieve['MCQ_D'] = $d;
$retrieve['MCQ_E'] = $e;
$retrieve['answer'] = $answer;
$retrieve['MCQ_correct'] = $correct; 
```

应该

```
$question = $retrieve['question' ;
$a = $retrieve['MCQ_A'];
$b = $retrieve['MCQ_B'];
$c = $retrieve['MCQ_C'];
$d = $retrieve['MCQ_D'];
$e = $retrieve['MCQ_E'];
$answer = $retrieve['answer'];
$correct $retrieve['MCQ_correct']; 
```

[请不要`mysql_*`在新代码中使用函数](https://stackoverflow.com/questions/12859942)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[红框](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

**您也对[SQL 注入持开放态度](https://stackoverflow.com/q/60174)**

你不应该使用[w3schools](http://www.w3fools.com)。它不是可靠的信息来源，我们不想鼓励使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:35:44.137

您在分配时使用了错误的方向。用这个：

```
$e = $retrieve['MCQ_E']; 
```

# windows-8 - 该应用程序无法从快照视图中正确恢复

> ID：14886594
> 
> 赞同：0
> 
> 时间：2013-02-15T00:34:43.670
> 
> 标签：windows-8

当我的 Windows 8 应用程序从快照视图返回时，它会将用户发送到应用程序的第一页。我收到一条失败通知，说我的应用程序无法正常恢复，但是，Windows 之前通过了它。当用户从快照模式恢复时，将用户发送到第一页是否违法？如何告诉应用程序用户所在的页面并恢复它？

当我的应用程序进入退出捕捉模式时，此代码运行：

```
void ShowCurrentViewState()
    {
        //this.UpdateUnsnapButtonState();

        // Query for the current view state
        ApplicationViewState currentState = Windows.UI.ViewManagement.ApplicationView.Value;

        if (currentState != ApplicationViewState.Snapped)
        {
            App.DataMode = Mode.Featured;
            this.Frame.Navigate(typeof(RestaurantSearchDetails));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T06:27:21.403

[读取和写入数据示例](http://code.msdn.microsoft.com/windowsapps/Reading-and-writing-data-75ea10a3)展示了如何在两个不同的屏幕之间导航，并根据视图状态更改每个屏幕的布局，对齐与填充。

# excel - CSV 值应作为字符串而不是时间读取到 Excel 中

> ID：14886597
> 
> 赞同：0
> 
> 时间：2013-02-15T00:35:03.803
> 
> 标签：excel, csv

我有一个 PHP 脚本，可以将数据写入逗号分隔 (CSV) 文件。其中一列包含恒星的坐标 - 例如 19:07:14.03。将 CSV 文件读入 Excel 时，Excel 会假定这是一个时间并将值转换为 07:14.0。有没有办法在 CSV 文件中嵌入一些信息，告诉 Excel 该值应该作为字符串而不是时间读取？我尝试在值周围加上双引号，但这不起作用。或者，Excel中是否有一个设置可以强制它不自动格式化值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T05:43:03.690

将文件扩展名重命名为`TXT`，然后打开它并通过导入文本向导。在其中一个步骤中，您将能够为列定义数据类型 - 选择`Text`您的时间值。这应该会有所帮助。

# redirect - 我应该如何临时将网站重定向到不同的域？

> ID：14886602
> 
> 赞同：0
> 
> 时间：2013-02-15T00:35:25.677
> 
> 标签：redirect, web, dns

在基础设施审计期间，我们将关闭数据中心 12-18 小时。我们需要在受此中断影响的网站上发布“暂时不可用”消息。

过去，我已将网站域名的 A-Record 更改为指向第三方托管的站点。DNS 更改似乎是即时的，但我担心潜在的 48 小时传播延迟。

有没有更好的方法在中断期间临时重定向站点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:51:57.047

由于现有 ip 上不会有任何服务器，因此您没有任何其他选择。

为了最大限度地减少传播问题，在您需要切换的前几天，您应该将 A 记录的 TTL 减少到非常短的时间（比如几分钟），这应该会迫使客户端和 dns 服务器更多地查询您的 dns经常。

# java - DBUtils QueryRunner 实例化

> ID：14886606
> 
> 赞同：5
> 
> 时间：2013-02-15T00:35:40.460
> 
> 标签：java, object, servlets, instantiation, apache-commons-dbutils

我有一个 web 服务，它在初始化时使用数据源实例化单个[QueryRunner 。](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/QueryRunner.html)它通过将这个`QueryRunner`对象作为 servlet 上下文属性传递给来自 webapp 使用的多个不同 servlet 的所有 servlet 请求。IE：

```
// in servlet context listener (on app initialization)
QueryRunner myQueryRunner = new QueryRunner(myDataSource);
myServletContext.setAttribute("queryRunner", myQueryRunner);

// in the servlets
QueryRunner myQueryRunner = (QueryRunner) myServletContext.getAttribute("queryRunner");
myQueryRunner.query(myStoredProcedure, handler, params) 
```

我试图弄清楚这是否是一个瓶颈。servlet 是否应该为`QueryRunner`每个请求都实例化一个新的？

在四处寻找答案时，我还发现了这个[AsyncQueryRunner](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/AsyncQueryRunner.html)。但我只是变得更加困惑，因为[QueryRunner](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/QueryRunner.html)和[AsyncQueryRunner](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/AsyncQueryRunner.html)的 API 文档中的解释说的完全一样。

我查看了[这里](http://commons.apache.org/dbutils/examples.html)的示例，似乎应该用每个请求实例化它，但我不确定这是否仅仅是因为它是示例代码。

换句话说，在使用 DBUtils 时，`QueryRunner`我应该：

1.  `QueryRunner`为每个请求使用单个实例？（我现在在做什么）
2.  `QueryRunner`用每个 servlet 请求实例化一个新的？
3.  `AsyncQueryRunner`为每个请求使用单个实例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-19T19:22:48.040

QueryRunner 是一个线程安全类，因为它是无状态的，因此您可以在多线程环境中使用单个实例而不会出现任何问题。

所有方法都是自包含的，因此无需同步方法访问，因此您也可以排除瓶颈。

我在生产环境中使用它没有问题，但我的实现遵循“用每条语句实例化一个新的 QueryRunner”的模式，因为它是一个没有状态的委托类，所以没有繁重的初始化和堆消耗，我避免使用单例或其他共享实例存储此类类型。

AsyncQueryRunner 也是线程安全的，但它的用途和用法完全不同（参见[http://commons.apache.org/proper/commons-dbutils/examples.html](http://commons.apache.org/proper/commons-dbutils/examples.html)）。它用于为长时间运行的语句创建非阻塞调用。如果您的业务层需要异步，它可能会很有用。

综上所述：

*   使用来自多个线程的单个 QueryRunner 实例（每个请求一个线程？）没有反指示，但也没有优势，但是在某处需要一些代码来管理这个实例
*   为每个线程甚至是要通过它委托的每个语句使用新的 QueryRunner 实例有两个主要优点：简单和本地化的使用，如果不需要它们，内存中没有实例。
*   AsyncQueryRunner 需要对查询响应进行繁琐的管理，因此只有在业务代码中需要异步行为时才使用它。

# lucene - Alfresco Lucene 和 CMIS

> ID：14886608
> 
> 赞同：0
> 
> 时间：2013-02-15T00:35:47.163
> 
> 标签：lucene, alfresco, cmis

我们有这个问题：

昨天我们在 Alfresco 中有一个自定义的 xmlModel，它有一个自定义类型、带有属性的内容扩展和一些强制性方面。

```
<type name="custom:myType">
     <title>Object</title>
     <parent>cm:content</parent>
     <properties>
        <property name="custom:myProperty">
           <type>d:text</type>
        </property>
     </properties>
     <mandatory-aspects>
        <aspect>custom:myAspect1</aspect>
     </mandatory-aspects>
  </type> 
```

现在我们迫切需要将自定义的 my Property 移动到一个新的方面，如下所示：

```
 <aspect name="custom:myAspect2">
     <title>new aspect</title>
     <properties>
        <property name="custom:myProperty">
           <type>d:text</type>
           <mandatory enforced='true'>true</mandatory>
        </property>
     </properties>
  </aspect> 
```

现在的类型是：

```
<type name="custom:myType">
 <title>Object</title>
 <parent>cm:content</parent>
 <mandatory-aspects>
    <aspect>custom:myAspect1</aspect>
    <aspect>custom:myAspect2</aspect>
 </mandatory-aspects> 
```

在完全重建索​​引之后，Lucene 似乎并没有考虑这些变化。因此，在 Alfresco 的新文档中，一切都很好，在旧文档上，使用旧模型上传并重新索引，我们仍然拥有该属性，但缺少该方面。这是正常的行为吗？或一些问题/错误。所有这一切都是由于我们需要对方面进行 CMIS 查询造成的，但是我们在对不属于 Alfresco 方面的类型的本机属性进行查询时遇到了一些问题。似乎只能提取方面的属性而不是内容类型的属性。真的吗？谢谢

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:28:27.880

关于问题的第一部分，您可能需要运行脚本将方面添加到旧对象。实际上，我很惊讶 repo 能够启动，因为那些旧对象应该抱怨它们的类型需要一个尚未添加到对象的强制方面。

如果我要进行您所做的更改，我会首先将方面声明为空方面，然后运行脚本将方面添加到有意义的所有节点，然后更新模型以从类型中移动属性到方面并重新启动。

关于您关于 CMIS 和查询的第二个问题，您应该能够毫无问题地通过 CMIS 查询定义为类型的一部分的属性。问题是当您的属性移动到方面时。然后您的查询必须像这样进行连接：

```
queryString = "select d.*, w.* from cmis:document as d join sc:webable as w on d.cmis:objectId = w.cmis:objectId where w.sc:isActive = True"; 
```

在此示例中，sc:webable 是一个方面，并且在该方面上定义了 sc:isActive 属性。

因此，如果您说您在查询方面定义的属性时遇到问题，那比查询类型上定义的属性时遇到问题更有意义（因为连接要求）。

此外，请注意向对象添加和删除方面、询问对象是否具有方面以及设置或更新在方面上定义的属性都需要您使用扩展，因为 CMIS 1.0 不支持方面。盒子。[OpenCMIS](http://code.google.com/a/apache-extras.org/p/alfresco-opencmis-extension/)有一个[扩展， cmislib](http://code.google.com/p/cmislib-alfresco-extension/)有另一个扩展。

# matlab - 在matlab中的不同操作之间创建一个循环切换器？

> ID：14886611
> 
> 赞同：2
> 
> 时间：2013-02-15T00:35:56.203
> 
> 标签：matlab, loops, for-loop, nested-loops

我有三个循环操作`O1 O2 O3`，每个操作都有一个**IF**语句，并且具有最大值的操作`flag=[F1 F2 F3]`具有更高的运行优先级。

如何根据 that 的值在操作之间切换`flag`？每个操作的标志值随时间变化。

为简单起见，操作 1 将首先运行，并且在其循环结束时标志值将是最低的，因此操作 2 或 3 应该接下来运行。所以对于这个例子，在`t=0 : F1=5 F2=3 and F3=1.`

我试图实现的过度简化的伪代码：

```
while 1
  find largest flag value using [v index]=max(flag)
  Run operation with highest flag value
   ..loop back..
end 
```

我不确定如何在操作之间比较 flag 的值，因此我希望有人在这里阐明这个问题。

**编辑**

目前，所有操作都写在一个matlab文件中，每个操作都由一个IF语句触发。这些操作一个接一个地系统地运行（取决于哪个是首先在 matlab 中编写的）。`flag`我想避免这种情况，而是根据值触发它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:49:25.260

如果您的操作是函数（从问题中很难分辨），则制作一个函数句柄单元数组，其中有`fun1`一个实际函数的名称。

```
handles = {@fun1, @fun2, @fun3} 
```

然后，您可以使用从您的`max`术语返回的索引从数组中获取正确的函数。您可以使用以下语法将任何参数传递给函数。

```
handles{index}(args) 
```

使用上述样式使解决方案具有可扩展性，因此`if`当操作数量增加时，您不需要一堆需要维护的语句。如果函数真的很简单，你总是可以使用 lambdas（或 Matlab 中的匿名函数）。

但是，如果您有有限数量的不太可能扩展的简单操作，您可以选择在您的 while 循环中使用 switch 语句。它比一堆`if`陈述更能传达你的意图。

```
while 1
  [~, index]=max(flag);
  switch index
      case 1
          operation1
          flag = [x y z]
      case 2
          operation2
          flag = [x y z]
      otherwise
          operation3
          flag = [x y z]
    end
end 
```

# nuget - 在 MyGet 源上创建 NuGet 包依赖项

> ID：14886625
> 
> 赞同：1
> 
> 时间：2013-02-15T00:37:13.630
> 
> 标签：nuget, myget

我有一个公共 nuget 包，它有一个预发布版本，它依赖于 myget 上的 aspnetwebstacknightly 提要。有谁知道是否有办法在我的包中创建对该提要的依赖项？我找不到任何有用的东西。我猜没有办法做到这一点，但只是想尝试 SO 作为最后的手段。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T07:19:09.040

您可以在包中定义依赖项。唯一的问题是，当您将您的推送到 nuget.org 而不存在该依赖项时，您的包使用者还必须配置 MyGet 提要，以便在安装期间解决该依赖项。

更准确地说，应将 MyGet 提要放在 NuGet.org 提要下方，并且应使用“全部”聚合包源安装您的包。

您可以在包 readme.txt 或包元数据中传达此信息，以使其在 NuGet.org 包详细信息页面上可见。您也可以尝试添加一些 PowerShell 脚本并尝试找到解决方法，但您要解决的问题是设计使然。但是，我不建议这样做。

基本上，只要您的依赖项尚未推送到 NuGet.org，您就会遇到此问题。为什么不在 MyGet 上公开您的预发布包并将 aspnetwebstacknightly MyGet 提要配置为提要中的上游包源？确保为此包源启用“代理”复选框，这样您的依赖关系也将得到解决，而消费者无需配置两个提要（从提要安装包也会从提要中获取您的依赖*项*- 然后在幕后查询 aspnetwebstacknightly 提要）。

希望有帮助！

# javascript - 只刷新 JavaScript 部分？

> ID：14886626
> 
> 赞同：-2
> 
> 时间：2013-02-15T00:37:17.827
> 
> 标签：javascript

我有一段 JavaScript 显示当前温度，但它不会随着温度的变化而更新。有没有办法在计时器上更新 JavaScript 的那部分？

编辑：对不起，这是代码（不是我创建的）。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript">
// javascript will go here
$(function(){

// Specify the ZIP/location code and units (f or c)
var loc = '10001'; // or e.g. SPXX0050
var u = 'f';

var query = "SELECT item.condition FROM weather.forecast WHERE location='" + loc + "' AND u='" + u + "'";
var cacheBuster = Math.floor((new Date().getTime()) / 1200 / 1000);
var url = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(query) + '&format=json&_nocache=' + cacheBuster;

window['wxCallback'] = function(data) {
    var info = data.query.results.channel.item.condition;
    $('#wxIcon').css({
        backgroundPosition: '-' + (61 * info.code) + 'px 0'
    }).attr({
        title: info.text
    });
    $('#wxIcon2').append('<img src="http://l.yimg.com/a/i/us/we/52/' + info.code + '.gif" width="40" height="40" title="' + info.text + '" />');
    $('#wxTemp').html(info.temp + '&deg;' + (u.toUpperCase()));
};

$.ajax({
    url: url,
    dataType: 'jsonp',
    cache: true,
    jsonpCallback: 'wxCallback'
});
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:52:56.520

命名你的函数（而不是使用`$(function(){...`）像 GetWeather

然后在外面的某个地方......

```
setInterval(GetWeather,10000) 
```

试试看：http : [//codepen.io/anon/pen/bvyDh](http://codepen.io/anon/pen/bvyDh)

# ruby-on-rails - 在子类中继承 Rails i18n 验证错误消息

> ID：14886629
> 
> 赞同：5
> 
> 时间：2013-02-15T00:37:41.297
> 
> 标签：ruby-on-rails, validation, inheritance, i18n-gem, rails-i18n

## 我的理解

假设我有一个带有方便验证的类，例如：

```
User < ActiveRecord::Base
    validates :username, :format => {/regex/}, :message => :name_format
end 
```

在这种情况下，我可以`i18n`通过在我的 中包含以下内容来使错误消息可翻译`/config/locals/en.yml`：

```
en:
    activerecord:
        errors:
            models:
                user:
                    attributes:
                        username:
                            name_format: 'has the way-wrong format, bro!' 
```

这很好，通常非常方便。

## 我想知道的：

我的问题是：当我有从 User 继承的子类时会发生什么：

```
UserSubclassOne < User
    # extra stuff
end
UserSubclassTwo < User
    # extra stuff
end
...
UserSubclassEnn < User
    # extra stuff
end 
```

现在的问题是 Rails 找不到翻译`user_subclass_one.attributes.username.name_format`。

它抱怨：

```
translation missing:
en.activerecord.errors.models.user_subclass_one.attributes.username.name_format 
```

我希望 Rails在搜索字符串时查找`UserSubclassOne`to的层次结构，然后注意它何时被“命中”，但是（除非我做错了什么）显然这不会发生。`User``en.yml`

一个明显的解决方案是复制`en.yml.en.errors.models`for `user`、`user_subclass_one`、`user_subclass_two`等中的数据，但我的 Rails 感觉告诉我这是大错特错。

有什么想法吗，伙计们？

## 潜在并发症：

`User``MyGem`在包含在 Rails 引擎中的 gem 中定义，该引擎包含在定义, ...,`MyEngine`的完整 Rails 应用程序中。不过，我认为这并不重要，因为验证正在运行，这是文件所在的位置——只是想让人们知道，以防万一。`MyApp``UserSubclassOne``UserSubclassEnn``MyGem::User``en.yml`

# 终极问题/解决方案：

所以事实证明问题出在命名空间上。回想一下`MyApp`（定义`UserSubclassOne`）使用`MyGem`（定义`User`）。原来`User`实际上是在命名空间中`MyGem`（不一定总是这样），所以开头的完整声明行`User`不是：

```
User < ActiveRecord::Base 
```

反而

```
MyGem::User < ActiveRecord::Base 
```

.

当 i18n gem 查找类层次结构时，它会注意到这个命名空间并搜索`my_gem/user`，而不是简单地`user`、`my_gem.user`、`my_gem: user`等。

因此我不得不将我的`en.yml`文件更改为 `/config/locals/en.yml`：

```
en:
    activerecord:
        errors:
            models:
                my_gem/user:
                    attributes:
                        username:
                            name_format: 'has the way-wrong format, bro!' 
```

和宾果游戏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T19:17:06.723

所以事实证明问题出在命名空间上。回想一下`MyApp`（定义`UserSubclassOne`）使用`MyGem`（定义`User`）。原来`User`实际上是在命名空间中`MyGem`（不一定总是这样），所以开头的完整声明行`User`不是：

```
User < ActiveRecord::Base 
```

反而

```
MyGem::User < ActiveRecord::Base 
```

.

当 i18n gem 查找类层次结构时，它会注意到这个命名空间并搜索`my_gem/user`，而不是简单地`user`、`my_gem.user`、`my_gem: user`等。

因此我不得不将我的`en.yml`文件更改为 `/config/locals/en.yml`：

```
en:
    activerecord:
        errors:
            models:
                my_gem/user:
                    attributes:
                        username:
                            name_format: 'has the way-wrong format, bro!' 
```

和宾果游戏！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T04:05:50.917

根据关于 Active Record 验证错误消息的[错误消息范围 (5.1.1)](http://guides.rubyonrails.org/i18n.html#translations-for-active-record-models)的 i18n Rails 指南，您尝试执行的操作应该有效：

> 考虑一个对 name 属性进行验证的 User 模型，如下所示：
> 
> ```
> class User < ActiveRecord::Base
>   validates :name, :presence => true
> end 
> ```
> 
> *<...剪辑...>*
> 
> 当您的模型另外使用继承时，则会在继承链中查找消息。
> 
> 例如，您可能有一个继承自 User 的 Admin 模型：
> 
> ```
> class Admin < User
>   validates :name, :presence => true
> end 
> ```
> 
> 然后 Active Record 将按以下顺序查找消息：
> 
> ```
> activerecord.errors.models.admin.attributes.name.blank
> activerecord.errors.models.admin.blank
> activerecord.errors.models.user.attributes.name.blank
> activerecord.errors.models.user.blank
> activerecord.errors.messages.blank
> errors.attributes.name.blank
> errors.messages.blank 
> ```
> 
> 通过这种方式，您可以在模型继承链以及属性、模型或默认范围的不同点为各种错误消息提供特殊翻译。

所以，在你的情况下，假设你的类看起来像这样：

**应用程序/模型/user.rb**

```
User < ActiveRecord::Base
  validates :username, :format => {/regex/}, :message => :name_format
end 
```

**应用程序/模型/user_subclass.rb**

```
UserSubclass < User
  validates :username, :format => {/regex/}, :message => :name_format
end 
```

你的**config/locales/en.yml**看起来像：

```
en:
  activerecord:
    errors:
      models:
        user:
          attributes:
            username:
              name_format: 'has the way-wrong format, bro!' 
```

那么搜索验证的消息`UserSubClass`应该去：

```
activerecord.errors.models.user_sublcass.attributes.username.name_format # fail
activerecord.errors.models.user_sublcass.name_format                     # fail
activerecord.errors.models.user.attributes.username.name_format          # success
activerecord.errors.models.user.name_format
# ... 
```

假设您的模型文件和 yaml 文件看起来与上面的相似，那么您提到的潜在并发症可能是问题所在，但显然我不能确定。

# html - 流体布局定位div

> ID：14886630
> 
> 赞同：1
> 
> 时间：2013-02-15T00:37:45.477
> 
> 标签：html, css, fluid-layout

这可能是一个非常基本的 css 问题，但我尝试按照书中的说明创建流畅的布局，到目前为止，我的标题和导航栏似乎在适当的位置，但内容 div 不在，我也想做我的内容高度灵活，因为它适用于动态网络应用程序，因此页脚应相应地位于其下方。好的，这是 id 想要实现的模型 ![在此处输入图像描述](../Images/e1edea98983a802a69132aad2008513a.png)

```
<body>

<div id="header">
<h1>LOGO</h1>
<ul>
<li><a href= ""> Home </a></li>
<li><a href= ""> Logout </a></li>
</ul>
</div>

<div id="navigation">
<ul>
    <li><a href="">Home</a></li> 
    <li><a href="">My account</a></li> 
    <li><a href="">Help</a></li> 
    <li><a href="">Contact Us</a> </li> 
    </ul>

</div>
<div id="personalised">
<p>Hey there</p>
</div>
<div id="content">

</div>
<div id="footer">
<p>&copy; TEST</p>
</div>
</body>
</html> 
```

这是我的CSS代码：

```
body{
width: 90%;
margin: 0 auto;}

#content {
overflow: auto;
height: 29em;}

#header{
height: 60px;
overflow: hidden;
}
#header h1 {
    float: left;
}
#header ul {

    float: right;
}
#header li {
    display: inline;
    padding: 0.5em;
}

#personalised p {
float: left;
width: 20%;
margin-top:5%;}

#navigation{
margin: 1%;}

#navigation ul {
font-family: Arial, Verdana;
font-size: 14px;
padding: 0px;
list-style: none;
}

div#navigation {
float:right;
position: absolute;
top: 10%;
right: 5%;
}
#navigation ul li {
display: block;
position: relative;
float: left;
}
#navigation li ul { display: none; }

#header, #footer, #navigation, #personalised {
margin: 1%;
}
#footer {
padding: 0.5em 0;
font-family: Arial, Verdana;
font-size: 10px;
text-align: center;} 
```

我知道这很长，但我非常感谢您的帮助。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:56:45.727

首先尝试处理您的格式。（这还不错，但可以使用改进。）对您来说最大的好处之一就是您可以阅读的代码。你可以看看我在这里做了什么，玩你喜欢的。[http://jsfiddle.net/mPH8X/](http://jsfiddle.net/mPH8X/)

```
<head>
<style>
div {
 border: 1px dashed #FF0000;
}
body {
    margin: 0px;
    padding: 0px;
}

.clear {
    clear: both;
}

#header {
    min-height: 60px;
    overflow: hidden;
    margin: 1%;
}
#header h1 {
    float: left;
}
#header ul {

    float: right;
}
#header li {
    display: inline;
    padding: 0.5em;
}

#navigation{
    margin: 1%;
    float: right;
}

#navigation ul {
    font-family: Arial, Verdana;
    font-size: 14px;
    padding: 0px;
    margin: 0px;
    list-style: none;
}

#navigation ul li {
    margin: 0px;
    padding: 0px;
    display: block;
    position: relative;
    float: left;
}

#navigation li ul { 
    display: none; 
}

.body {
    clear: both;
}

#personalised {
    margin: 1%;
    float: left;
    width: 20%;
}

#content {
    margin: 1%;
    float; right;
    min-height: 29em;
}

#personalised p {
    margin: 0px;
    padding: 0px;
}

#header, #footer, #navigation, #personalised {

}

#footer {
    padding: 0.5em 0;
    font-family: Arial, Verdana;
    font-size: 10px;
    text-align: center;
}
</style>
<body>

<div id="header">
    <h1>LOGO</h1>
    <ul>
        <li><a href= ""> Home </a></li>
        <li><a href= ""> Logout </a></li>
    </ul>
    <div class="clear"></div>
</div>

<div id="navigation">
    <ul>
        <li><a href="">Home</a></li> 
        <li><a href="">My account</a></li> 
        <li><a href="">Help</a></li> 
        <li><a href="">Contact Us</a> </li> 
    </ul>

    <div class="clear"></div>
</div>

<div class="body">
    <div id="personalised">
        <p>Hey there</p>
        <div class="clear"></div>
    </div>

    <div id="content">

    </div>
</div>

<div id="footer">
    <p>&copy; TEST</p>
</div>
</body>
</html> 
```

编辑：查看您的内容声明，您正在寻找 CSS 的最小高度。min-height 将其设置为最小高度并在必要时增长。溢出：自动；表示如果您的内容超出最大高度，请添加滚动条。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:55:57.850

我认为罪魁祸首是这样的：

```
#content {
overflow: auto;
height: 29em;} 
```

您正在明确设置内容 div 的高度。尝试将其设置为继承。

这是一个小提琴，容器根据其中的元素数量增长：

[http://jsfiddle.net/pUb6q/2/](http://jsfiddle.net/pUb6q/2/)

使用您的布局。变化是

```
#content {
    border:1px solid black;
    float: right;
    overflow: auto;
    height: inherit;
} 
```

# c# - C# (Windows Phone) Facebook 获取信息

> ID：14886633
> 
> 赞同：0
> 
> 时间：2013-02-15T00:37:47.893
> 
> 标签：c#, facebook, windows-phone-7, sdk

如何从用户那里获取其他信息，例如位置、生日或性别？我使用这段代码作为我正在做的项目的指南。[http://windowsphoneaalto.org/2012/01/facebook-get-information-about-the-user/](http://windowsphoneaalto.org/2012/01/facebook-get-information-about-the-user/)

我能够获取用户的 ID 和姓名，但无法获取其他信息。我尝试通过添加字符串 location = result["location"].ToString(); 来获取用户的位置

我最终得到了一个空值和一个 keynotfoundexception。这是我遇到问题的一段代码。

```
void _fbClient_GetCompleted(object sender, FacebookApiEventArgs e)
    {
        //Turn the data into Dictionary.
        //If you want to see what the Facebook is returning you can check it
        //with this tool provided by Facebook
        //http://developers.facebook.com/tools/explorer/?method=GET&path=me
        var result = (IDictionary<string, object>)e.GetResultData();
        //Get the ID value
        string id = result["id"].ToString();
        //Get the name value
        string name = result["name"].ToString();
        //Currently the thread running this code
        //is not the UI thread and only UI thread can update
        //UI. So we are calling the UI thread here.
        _page.Dispatcher.BeginInvoke(() => {
            MessageBox.Show(name + " (" + id + ")");
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:26:28.147

据我记得，您需要将其添加到 facebook 应用程序扩展权限，然后要求用户授予您共享这些详细信息的权利。

在 facebook 上寻找更多的扩展权限将解决您的问题

# winapi - 关闭句柄的 I/O 完成端口导致读取完成

> ID：14886634
> 
> 赞同：1
> 
> 时间：2013-02-15T00:38:06.763
> 
> 标签：winapi, readfile, iocp

我有 iocp 正在运行和工作（大部分）——但是应该在句柄上调用 CloseHandle() 导致它完成吗？

例如，我调用了 ReadFile()，它现在正在等待输入读取。在另一点上，我从用于服务 iocp 完成数据包的池中的另一个线程调用 CloseHandle()。我希望在前面的 ReadFile() 调用中使用 ERROR_INVALID_HANDLE 完成，但我没有看到。相反，它似乎永远不会回来。这可能是其他东西持有对句柄的引用的迹象吗？如果是这样，你会如何建议弄清楚/调试它？

有什么建议么？

谢谢！

# python - Ubuntu 加密主目录 | Errno 36 文件名太长

> ID：14886640
> 
> 赞同：2
> 
> 时间：2013-02-15T00:39:19.687
> 
> 标签：python, python-2.7, ubuntu-12.04

在 python scraper/spider 上工作，遇到了一个超过字符限制的 URL，标题为 IOError。使用 httplib2 并且当我尝试检索 URL 时，我收到一个文件名太长的错误。因为我使用的是 Dropbox，所以我更喜欢将我的所有项目都放在主目录中。无论如何围绕这个问题，还是我应该在家外设置我的工作目录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-08T19:16:50.980

您可能遇到了加密文件系统的限制，它允许文件名中最多包含 143 个字符。

这是错误： [https ://bugs.launchpad.net/ecryptfs/+bug/344878](https://bugs.launchpad.net/ecryptfs/+bug/344878)

目前的解决方案是使用加密主目录之外的任何其他目录。要仔细检查：

```
mount | grep ecryptfs 
```

并查看是否列出了您的主目录。如果是这种情况，请使用 home 上方的其他目录，或者在不使用加密的情况下创建一个新的主目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T00:57:44.697

文件名开头太长的事实`'.cache/www.example.com'`解释了这个问题。

`httplib2`可选择缓存您发出的请求。您已启用缓存，并将其`.cache`作为缓存目录。

简单的解决方案是将缓存目录放在其他地方。

如果没有看到您的代码，就不可能告诉您如何修复它。但这应该是微不足道的。的文档[`FileCache`](http://httplib2.googlecode.com/hg/doc/html/libhttplib2.html#httplib2.FileCache)显示它以 a`dir_name`作为第一个参数。

或者，您可以传递一个`safe`函数，让您从 URI 生成文件名，覆盖默认值。这将允许您生成适合 Ubuntu 加密 fs 的 144 个字符限制的文件名。

或者，或者，您可以创建自己的具有相同接口的对象，`FileCache`并将其传递给`Http`对象以用作缓存。例如，您可以使用`tempfile`创建随机文件名，并将 URL 到文件名的映射存储在`anydbm`或`sqlite3`数据库中。

当然，最后一种选择是关闭缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T00:58:19.373

由于您显然已传递`'.cache'`给`httplib.Http`构造函数，因此您应该将其更改为更合适的内容或禁用缓存。

# c++ - 如何从 C++ 中的友元函数访问私有函数？

> ID：14886645
> 
> 赞同：0
> 
> 时间：2013-02-15T00:39:59.313
> 
> 标签：c++, oop

谁能告诉我如何从该类的朋友函数中调用该类的私有函数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:42:21.567

就像您将成为私人数据成员一样。只需访问它：

```
class A
{
  void foo() {}     // private member function
  friend void bar();
};

void bar() {
    A a;
    a.foo(); // access A's privates
} 
```

# facebook - 使用 koala 和 fb api 获取好友列表

> ID：14886652
> 
> 赞同：4
> 
> 时间：2013-02-15T00:41:21.010
> 
> 标签：facebook, facebook-graph-api, koala

我试图用经过身份验证的用户的 uid 返回好友列表。但是我只得到了部分返回值，部分朋友被遗漏了：

```
graph = Koala::Facebook::API.new(fb_token)
friends = graph.get_connections("me", "friends")
#some friend action 
```

当我输入

```
friends.paging["next"] 
```

在浏览器中它还返回一个空的 json 数组

```
 "data": [    ] 
```

我怎么做错了，正确的做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-22T16:24:31.400

您需要**获得“user_friends”权限**才能获取好友列表，否则您将收到空数据：

> 只有在用户授予 'user_friends' 权限后，才能在 User 对象上访问字段 'friends'。

自己试试： [https ://developers.facebook.com/tools/explorer?method=GET&path=me%2Ffriends&version=v2.5](https://developers.facebook.com/tools/explorer?method=GET&path=me%2Ffriends&version=v2.5)

因此，在正确的许可下，您可以执行以下操作：

```
graph = Koala::Facebook::API.new(fb_token)
result = graph.get_connections('me', 'friends') 
```

分页：

```
next_page = result.next_page 
```

***最后但并非最不重要的：***

> API v2.0 及更高版本仅返回安装此应用的朋友。total_count 表示好友总数，包括未安装应用的好友。了解详情

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-12-05T07:17:22.013

你试试这个..

这很简单，您可以在一行中获取所有朋友数:)

```
@graph = Koala::Facebook::API.new(facebook_token)
@friends = @graph.get_connection("me", "friends",api_version:"v2.0").raw_response["summary"]["total_count"] 
```

# iphone - Json 解析问题，但当我在 txt 文件中复制响应时工作正常

> ID：14886653
> 
> 赞同：0
> 
> 时间：2013-02-15T00:41:26.320
> 
> 标签：iphone, ios, objective-c, nsjsonserialization

这是我解析 json 服务的代码。但是我在 json 字典中得到了 nil 值。但是当我复制 json 响应并制作一个 .txt 文件并解析它时。它运作良好。奇怪的问题。

```
-(void)viewDidLoad
{
    [super viewDidLoad];

    dispatch_async(kBgQueue, ^{
        NSData* data = [NSData dataWithContentsOfURL:@"http://www.checker.co.il/testing/c_pda-load_reports_list.php?app=1"];
        [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:YES];
    });
}

- (void)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData //1
                                                         options:kNilOptions 
                                                           error:&error];
} 
```

这种类型的反应，我得到了。

```
{"204281":{"rpID":"204281","ReportTitle":"Main Performance 
Analysis","ReportOrder":"2","URL":"report-network-status.php?ClientID=106&BranchID=&SetID=&
PropID=&props=&reportDateArng=3&hdrf_chosenCycleExtent=7&rangeStartd=0&rangeStartm=0&
rangeStarty=0&rangeEndd=0&rangeEndm=0&rangeEndy=0&pastDateCyclesNumber=2&selectedCycleExtent=&
showClientColorGroup=1&displayType=3&DyChartType=Bar2D&DycX=400&DycY=350&isPopup=0&
callingReportPageName=report-network-status.php&ReportTitle=\"%20
\"","ReportCategory":"Performance","CategoryRow":"0","CategoryCol":"4"},"204282":
{"rpID":"204282","ReportTitle":"Performance According to 
Ownership","ReportOrder":"5","URL":"report-property.php?ClientID=106&SetID=&PropID=78&
PropForFiltering=&props=&WorkerID=0&watchedReviews=&reportDateArng=1&hdrf_chosenCycleExtent=&
rangeStartd=0&rangeStartm=0&rangeStarty=0&rangeEndd=0&rangeEndm=0&rangeEndy=0&
pastDateCyclesNumber=2&selectedCycleExtent=&displayType=3&DyChartType=Column2D&DycX=400&DycY=250&
callingReportPageName=report-property.php&js_refresh=0&js_submit=0&
isPopup=0","ReportCategory":"Performance","CategoryRow":"0","CategoryCol":"4"}} 
```

提前致谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:28:27.767

1.  dthien 是对的，您需要使用`NSURL`.

2.  danh 是对的，您应该查看错误。您可以查看`error.localizedDescription`，但这并不总是有帮助。您可能会得到`error.code`3840，如果您查看`error.userInfo`字典，您可能会看到类似“JSON 文本未以数组或对象开头以及允许未设置片段的选项”之类的描述。

3.  每当您对 的响应出现错误时`JSONObjectWithData`，您都应该查看数据。因此，在 之前`JSONObjectWithData`，请执行以下操作：

    ```
    NSLog(@"%@", [[NSString alloc] initWithData:responseData
                                       encoding:NSUTF8StringEncoding]); 
    ```

4.  当您这样做时，您可能会注意到数据不包含 JSON 字符串。您可能遇到身份验证问题，并且您可能想要使用 a`NSURLConnection`而不仅仅是`dataWithContentsOfURL`，因为前者可以让您更详细地控制连接。正确的后续步骤取决于身份验证问题的性质。有两种基本的身份验证类型：

    *   质询-响应身份验证：如果您进行了此类身份验证，并且在 Web 浏览器中提取了 JSON URL，您会看到一些弹出窗口，要求您提供用户凭据。以编程方式，如果你写了一个[`didReceiveAuthenticationChallenge`](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSURLConnectionDelegate/connection%3adidReceiveAuthenticationChallenge%3a)，你会看到它会被调用。无论如何，如果这是您的身份验证类型，请参阅*URL 加载系统编程指南*中的[身份验证挑战。](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/AuthenticationChallenges.html#//apple_ref/doc/uid/TP40009507-SW1)

    **   基于 HTML 的身份验证：如果 (a) 您的响应是 HTML 登录页面，您可以判断是否是这种情况；或 (b) 如果您的[`willSendRequest`](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLConnectionDataDelegate_protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSURLConnectionDataDelegate/connection%3awillSendRequest%3aredirectResponse%3a)方法在您的请求被重定向到登录页面时被调用。如果是这种情况，正确的处理方式在一定程度上取决于服务器程序员如何处理身份验证问题，以及您希望如何处理它（例如，您想向用户显示身份验证页面吗？您想使用一些以前建立的凭据？等）。*  *如果你看那个的内容，`responseData`问题就会不言而喻。如果你得到一个看起来像 HTML 登录页面的东西，那么你可能正在处理后者。*

# entity-framework - EF Code First 多重继承是独占的？

> ID：14886656
> 
> 赞同：0
> 
> 时间：2013-02-15T00:41:50.770
> 
> 标签：entity-framework, inheritance, ef-code-first

假设我有一个模型，其中有带有一般信息（姓名、出生日期等）的 Person 实体，以及从 Person 继承的两个附加实体（客户、工人）。如您所见，可以选择让客户也可以在模型中扮演工人的角色。有一种方法可以在 EF 中进行设计（我看到了一些关于 TPH、TPT 和 TPC 的内容），但我看到使用了鉴别器，它不允许 Person 表“同时”包含 Worker 和 Customer 的值。

我不知道我是否对继承的一般 OOP 概念有误：S。

提前感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:10:27.677

您不能在 .net 中进行多重继承，它不受支持（这同样适用于实体框架）。您可以实现多个接口，但这是一个稍微不同的概念 - 即“工人”可能是由某些对象（例如客户）实现的接口

在实体框架中，我相信只有在使用 Table-per-hierarchy 时才实现鉴别器。这是两个子实体存储在同一个表中的位置，鉴别器识别哪个是哪个。

Table-per-type 本质上是实体（person、customer、worker）存储在不同的表中，但可以作为代码中的单个实体访问（即继承自 person 的客户）

可能你需要创建一个接口（可能是IWorker），并创建一个类（可能是WorkerCustomer？？）继承自Customer，并实现IWorker。

编辑：2013 年 2 月 15 日 19:00

好的，下面可能是您在表示单个表中的数据方面正在寻找的内容：

```
public class MyDbContext : DbContext
{
    public MyDbContext() : base("TestDB")
    {

    }

    public DbSet<Person> People { get; set; }
    public DbSet<Customer> Customers { get; set; }
    public DbSet<Worker> Workers { get; set; }
    public DbSet<WorkerCustomer> WorkerCustomers { get; set; }
}

public class Person
{
    public int ID { get; set; }
    public string Name { get; set; }
}

public class Customer : Person
{
    public string CustomerNumber { get; set; } 
}

public interface IWorker
{
    string WorkerNumber { get; set; }
}

public class Worker : Person, IWorker
{
    public string WorkerNumber { get; set; }
}

public class WorkerCustomer : Customer
{
    public string WorkerNumber { get; set; }
} 
```

# javascript - 删除按钮在 IE 中损坏的列表（不是 LI 元素）样式

> ID：14886657
> 
> 赞同：0
> 
> 时间：2013-02-15T00:42:05.653
> 
> 标签：javascript, jquery, html, css, styles

我有一种我喜欢的风格，并且像往常一样在 Firefox 18 中看起来不错，但在 IE 9 的版本上（我知道它不是完全最新的）它看起来很糟糕（并且损坏了）。

所以我决定放弃这种风格并尝试找到一个在线工作的例子。但是我发现不可能找到类似的东西，更不用说与 IE 兼容了！

这里有没有人知道如何修复我的示例并可能使其更加向后兼容或者是否有人知道我可以从中获得一些指示的这种风格的任何示例？

HTML

```
<div class="DateStyle"><span class="DateStyle_Date">21/01/2013</span><span class="DateStyle_Cross">x</span></div>

<div class="DateStyle"><span class="DateStyle_Date">11/02/2012</span><span class="DateStyle_Cross">x</span></div>

<div class="DateStyle"><span class="DateStyle_Date">08/05/2012</span><span class="DateStyle_Cross">x</span></div> 
```

CSS

```
.DateStyle {
    display: inline-block;
    background-color: #4A4F54;
    color: #A4A7AA;
    font-weight: bolder;
    -moz-border-radius: 8px;
    border-radius: 8px;
    padding: 2px 6px 2px 8px;
    line-height: 1.2em;
}
.DateStyle_Date {
    padding-right: 5px;
    border-right: #A4A7AA dashed 1px;
}
.DateStyle_Cross{
    padding-left: 4px;
    height: 15px;
}

.DateStyle:hover {
    background-color: #5C6165;
} 
```

jQuery

```
$(document).ready(function() {
    $('.DateStyle_Cross').hover(function(){
        $(this).parent().css('background','#751919 ');
    }, function(){
        $(this).parent().css('background','#4A4F54');
    })
    $('.DateStyle').hover.css( 'cursor', 'crosshair' );
    $('.DateStyle_Cross').hover.css( 'cursor', 'crosshair' );
}); 
```

[http://jsfiddle.net/pUb6q/](http://jsfiddle.net/pUb6q/)

谢谢

# vba - 在 VBA 中识别 For Each 循环的迭代？

> ID：14886658
> 
> 赞同：5
> 
> 时间：2013-02-15T00:42:07.147
> 
> 标签：vba, excel, foreach, iteration

如果我有一个开始的循环：

```
For each c in Range("A1:C8") 
```

占位符是否有一个属性`c (c.count, c.value, c.something,...)`来标识循环到目前为止的迭代次数？我宁愿使用这样的东西，也不愿包含另一个变量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T04:10:33.843

您可以执行以下操作，而不是使用“for each c in range”：

```
Dim c as Long 'presumably you did this as a Range, just change it to Long.
Dim myRange as Range 'Use a range variable which will be easier to call on later
Set myRange = Range("A1:C8")

For c = 1 to myRange.Cells.Count
    'Do something to the cell, identify it as myRange.Cells(c), for example:
    myRange.Cells(c).Font.Bold = True   '<--- replace with your code that affects the cell
Next 
```

这允许您执行完全相同的 For/Next 循环，而无需包含不必要的计数器变量。在这种情况下，`c`是一个计数器，但也用于识别受代码影响的单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T04:03:22.703

你需要像这样自己数

```
Dim i as integer
i = 0    
For each c in Range("A1:C8")
    i = i + 1 
```

或者

```
Dim i as integer
Dim c as Range
For i = 0 to Range("A1:C8").Count - 1
    Set c = Range("A1:C8").Cells(i) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-07T04:23:05.243

（修改）

使用 Column 或 Row 属性，根据您正在迭代的方向，您可以即时计算序数。因此

```
For Each c1 in myRange
    myOrdinal = c1.row - myRange.row + 1       ' down contiguous cells in one column
    myOrdinal = c1.Column - myRange.Column + 1 ' contiguous columns, L2R
Next 
```

# cordova - Phonegap/Cordova 应用程序更新没有应用程序商店通过 LocalStorage 中的脚本

> ID：14886659
> 
> 赞同：2
> 
> 时间：2013-02-15T00:42:20.240
> 
> 标签：cordova, app-store

我正在考虑如何为我的 Phonegap / Cordova 应用程序实现“在线更新”系统，至少就 Javascript 而言，我能想到的最简单的方法是将主脚本存储在 LocalStorage 中，通过检查更新版本号，然后只是`eval`ing 脚本。

也就是说，当应用程序启动时，它会评估存储在 LocalStorage 条目中的脚本版本。然后在登录时，除了身份验证信息之外，它还会从服务器收到一个版本号，它将对照当前的版本号进行检查。如果它们不匹配，它将从服务器中提取新版本的脚本，将其存储在 LocalStorage 中，然后重新启动。

这样做的主要好处是 (a) 简单且 (b) 独立于平台。主要缺点是只能更新脚本，而 HTML / CSS 保持静态（但可以在紧要关头被 JS 覆盖）。有什么明显的原因导致这行不通吗？这似乎是一种合理的解决方法，还是有更好/更可接受的方式来推送更新而无需访问应用商店？

# asp.net - 从复选框列表中选择一个复选框后，我需要填充我的网格视图

> ID：14886661
> 
> 赞同：0
> 
> 时间：2013-02-15T00:42:23.440
> 
> 标签：asp.net, sql, vb.net, gridview, checkboxlist

从复选框列表中选择一个复选框后，我需要填充我的网格视图。我正在尝试使用循环，如果用户取消选中该复选框，我还需要隐藏网格视图。我使用 sql 语句来提取数据。sql 应该提取与复选框“显示来自选定类别受保护子 chkbListControl_SelectedIndexChanged(sender As Object, e As System.EventArgs) Handles chkListControl.SelectedIndexChanged 的​​书籍相关联的任何数据

```
 Dim sqlChecked As String = "select * " _
                              & "from Books, Categories " _
                              & "where Categories.CategoryCode=Books.CategoryCode " _
                              & "order by Title;"

    Dim sqlUnChecked As String = "select * from Books where Categories.CategoryCode=Books.CategoryCode;"

    Dim selectedIndex As Integer = chkListControl.SelectedIndex
    Dim i As Integer

    If (selectedIndex <> -1) Then

        For i = 0 To chkListControl.Items.Count - 1

            If chkListControl.Items(i).Selected Then

                gvwBookList.DataSource = ReturnTable(sqlChecked)
                gvwBookList.DataBind()

            Else

                gvwBookList.DataSource = ReturnTable(sqlUnChecked)
                gvwBookList.DataBind()
                gvwBookList.Visible = False

            End If
        Next
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:15:00.023

你需要像这样修改你的 sqlchecked

```
 dim selectedcategories as string=""
  If (selectedIndex <> -1) Then

    For i = 0 To chkListControl.Items.Count - 1

        If chkListControl.Items(i).Selected Then

         if selectedcategories="" then
            selectedcategories=chkListControl.Items(i).value
         else
            selectedcategories &="," & chkListControl.Items(i).value
         end if

        End If
    Next
End If

 dim strSQL as string=""
             if selectedcategories.trim<>"" then
                    strSQL = "select * " _
                          & "from Books, Categories " _
                          & "where Categories.CategoryCode=Books.CategoryCode and                     Categories.CategoryCode in (" & selectedcategories &  ")" _
                          & "order by Title;"
   else
strSQL="select * from Books where Categories.CategoryCode=Books.CategoryCode;"

   end if

            gvwBookList.DataSource = ReturnTable(strSQL)
            gvwBookList.DataBind() 
```

您可以根据需要修改上述代码。

# android - 默认/系统 Android 进程

> ID：14886662
> 
> 赞同：1
> 
> 时间：2013-02-15T00:42:29.227
> 
> 标签：android, process

我目前正在开发一个 Android 项目，该项目监控用户正在运行的应用程序，并使用设备内部存储的白名单交叉检查相应的进程。

为了完成这项工作，我需要知道设备的默认或系统进程是什么，以便将它们添加到白名单中。话虽如此，我有几个问题希望你能回答：

1.  有没有办法区分必须运行的默认/系统进程和属于设备上的应用程序的进程？

2.  是否有不同的默认/系统进程取决于用户正在运行的手机/android 版本？

3.  如果是这样，这些进程名称是否可以在某个地方供开发人员使用？或者有没有其他方法可以获取它们？

如果我需要详细说明，请告诉我，感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:31:05.133

假设您尝试`ActivityManager`和`getRunningAppProcesses()`. 遍历该`RunningAppProcessInfo`对象数组并找到具有`importance`of的对象`IMPORTANCE_FOREGROUND`。如果文档是正确的（还没有尝试过），那么应该只有一个进程`IMPORTANCE_FOREGROUND`——真正位于 UI 前台的进程。

（服务可以调用一个`startForeground()`方法来获得前台优先级，但我猜他们有`IMPORTANCE_PERCEPTIBLE`）

然后，您可以检查该`pkgList`前台进程并将其与您的白名单进行比较。

但是，如果：

*   异步弹出某些内容（闹钟应用程序、来电等）

*   逻辑上在您的白名单中的应用程序具有影响其包名称的更改（例如，开发人员发布了一个学生付费的“专业”应用程序，而白名单只有免费应用程序）

*   如果设备有多个可见项目（例如，三星的多窗口功能），如果不是所有可见应用`IMPORTANCE_FOREGROUND`

这至少摆脱了学生无法控制的纯背景内容的问题，包括您的“默认/系统进程”。

但是，它需要您不断轮询，这将严重损害电池寿命。加上对隐私的影响，对我来说，这意味着这个应用程序最多只能用于考试，并且应该是学生可以在考试前不久安装并在考试后不久删除的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T20:25:56.217

好吧，我认为我和我的团队已经提出了迄今为止最好的解决方案。在阅读了Android Docs之后，我们发现通过使用`ActivityManager.getRunningServices()`我们可以使用常量`FLAG_SYSTEM_PROCESS`来确定哪些进程是核心系统进程。然后我们要做的就是与正在运行的进程的总列表进行交叉检查以区分它们。

# api - 缓存 Github API 调用

> ID：14886664
> 
> 赞同：12
> 
> 时间：2013-02-15T00:42:42.700
> 
> 标签：api, caching, github, github-api

我有一个关于 API 调用缓存的一般性问题，在这种情况下调用 Github API。

假设我的应用中有一个页面，其中显示了 repo 的文件名和 README 的内容。这意味着我必须进行一些 API 调用才能检索它。

现在，假设我想在两者之间添加类似 memcached 的东西，所以我不会一遍又一遍地进行这些调用，如果我不需要的话。

你通常会如何处理这件事？如果我不在 Github 上启用 webhook，我无法知道缓存是否应该过期。我总是可以进行一次调用来获取 HEAD 的当前 sha，如果它没有更改，请改用缓存。但这是在回购级别，而不是在文件级别。

我可以想象我可以用 object-sha 做类似的事情，但如果我需要调用 API 来获取这些，它就违背了缓存的目的。

你会怎么做？我知道像 prose.io 这样的服务现在没有缓存，但如果应该的话，方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-15T08:40:13.353

仅使用 HTTP 缓存是否足以满足您的用例？HTTP 缓存的目的不仅仅是提供一种在您已经有新响应时不发出请求的方法，而是 - 它还使您能够快速验证缓存中已有的响应是否有效（无需服务器发送完整的如果它是新鲜的，请再次回复）。

查看 GitHub API 响应，我可以看到 GitHub 正确设置了相关的 HTTP 标头（ETag、Last-modified、Cache-control）。

因此，您只需执行 GET，例如：

```
GET https://api.github.com/users/izuzak/repos 
```

这会返回：

```
200 OK
...
ETag:"df739f00c5053d12ef3c625ad6b0fd08"
Last-Modified:Thu, 14 Feb 2013 22:31:14 GMT
... 
```

下一次 - 您对同一资源执行 GET，但还提供相关的 HTTP 缓存标头，以便它实际上是一个条件 GET：

```
GET https://api.github.com/users/izuzak/repos
...
If-Modified-Since:Thu, 14 Feb 2013 22:31:14 GMT
If-None-Match:"df739f00c5053d12ef3c625ad6b0fd08"
... 
```

你瞧——服务器返回一个 304 Not modified 响应，你的 HTTP 客户端将从其缓存中提取响应：

```
304 Not Modified 
```

因此，GitHub API 正确地进行了 HTTP 缓存，您应该使用它。当然，您还必须使用支持 HTTP 缓存的 HTTP 客户端。最好的是，如果您收到 304 Not modified 响应 - GitHub 不会减少您剩余的 API 调用配额。请参阅：[https ://docs.github.com/en/rest/overview/resources-in-the-rest-api#conditional-requests](https://docs.github.com/en/rest/overview/resources-in-the-rest-api#conditional-requests)

GitHub API 还设置了`Cache-Control: private, max-age=60`标头，因此您有 60 秒的新鲜度——这意味着对相同资源的请求间隔不到 60 秒甚至不会发送到服务器。

您关于对资源使用单个条件 GET 请求的推理，如果 repo 中的任何内容发生更改，肯定会更改（例如，显示 HEAD sha 的资源）听起来很合理 - 因为如果该资源没有更改，那么您不会不必检查单个文件，因为它们肯定没有改变。

# mysql - 在表格中插入多行

> ID：14886665
> 
> 赞同：0
> 
> 时间：2013-02-15T00:42:42.050
> 
> 标签：mysql, stored-procedures

我想要做的是创建一个存储过程，它将从另一个表插入到一个表中，但是插入的行数将根据“篮子”表中 c_id 实例的数量而有所不同。

```
CREATE PROCEDURE `proc_Transaction` ()
BEGIN

INSERT INTO transactions 
    (t_id, p_id, u_id, price, qty, total)  status, when_sold) 
VALUES 
    (@t_id, @p_id, @c_id, @Price, @Qty, @total, );
    SELECT p_id, c_id, qty FROM basket;

END 
```

对于等于指定值的每个 c_id 实例，我想从我的“篮子”表中插入上述“事务”表。所以可能只插入一行或多行。t_id 对于插入的每一行都将保持不变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:45:26.467

这是你想要的吗？

```
INSERT INTO transactions (t_id, p_id, u_id, price, qty, total)
    SELECT @t_id, p_id, c_id, qty, @total FROM basket; 
```

# neo4j - 如何使用 Cypher 在 Neo4j 中查询带有破折号的属性

> ID：14886667
> 
> 赞同：8
> 
> 时间：2013-02-15T00:43:03.993
> 
> 标签：neo4j, cypher

我正在尝试使用 Cypher Query API 查询 Neo4j 中的属性。我正在尝试的查询如下：

```
String query = "start n=node(*) where (n.property-id = 'someid') return ID(n)" 
```

执行时出现错误，如下所示： Exception in thread "main" Unknown identifier `id`。

因此，这意味着 Neo4j 将 property-id 中的破折号视为关键字。如何在节点/关系属性中使用破折号来制定查询？

谢谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-15T05:07:06.943

用反引号转义属性：

```
String query = "start n=node(*) where (n.`property-id` = 'someid') return ID(n)" 
```

# mercurial - 从 Mercurial 中提取代码

> ID：14886670
> 
> 赞同：0
> 
> 时间：2013-02-15T00:43:12.427
> 
> 标签：mercurial, repository

我刚刚开始使用 Mercurial，我看到有人在使用该命令

```
hg pull - - update -vvv 
```

-vvv 是什么意思？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:22:05.267

不是 100% 确定的（`-vvv`不是 Mercurial 中的标准开关），但`-v`它本身会使输出变得冗长。当执行详细的 pull-with-update ( `hg pull --update -v`) 时，这会输出更多信息，主要是正在更新哪些文件等。

运行命令（使用`-vvv`）与 具有相同的效果`-v`，因此 Mercurial 将其视为详细开关。输出肯定不会*更*冗长。

我的猜测是有问题的人有一把卡住的钥匙:)

# java - Java 使用字符串值作为变量

> ID：14886673
> 
> 赞同：0
> 
> 时间：2013-02-15T00:43:19.017
> 
> 标签：java

我有一个带有参数国家的方法。该参数仅包含国家的缩写。在该方法中，我想打印国家/地区的全名，而不使用 switch case 或其他东西，但使用预定义的字符串

```
final String VA="Vatikan";
String country="VA";
system.out.println(country);
//Is it possible that it Prints Vatikan now?
//I know not with that code but is there a possibillity to do that. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T00:46:13.557

不，但您可以使用地图来获得您想要的结果。具体来说，要返回缩写国名的全名：

```
String va="Vatikan";
String country="VA";
Map<String, String> abbreviationMap = new HashMap<String, String>();
abbreviationMap.put(country, va);
System.out.println(abbreviationMap.get(country)); //prints "Vatikan" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:45:14.593

这将正确分配它：

```
final String VA="Vatikan";
String country=VA;
System.out.println(country); 
```

String 变量`country`将指向该变量`VA`所指向的任何内容；因为`VA`不能改变（它是`final`），国家将指向“梵蒂冈”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:52:44.567

您正在做的是将 a 分配`string "VA"`给国家，但您想将其视为 a `variable`，因此删除`quotes("")`.

```
final String VA="Vatikan";
String country=VA;
System.out.println(country); 
```

# entity-framework - 在 Azure 上使用 Light Switch 保存修改的记录时出错

> ID：14886676
> 
> 赞同：0
> 
> 时间：2013-02-15T00:43:40.930
> 
> 标签：entity-framework, azure, save, record, visual-studio-lightswitch

我在 Azure 上使用灯光开关。

当我单击“保存”按钮修改记录中的列后，我得到了

“存储更新、插入或删除语句影响了意外数量的行 (0)。自加载实体后，实体可能已被修改或删除，请刷新 ObjectStateManager 条目。

我在我的开发机器上使用 VS 2012 调试这个电灯开关应用程序。当我修改相同记录上的保存列然后保存它时，它工作正常并且没有错误。

这个论坛里有人知道是什么原因造成的吗？我应该如何解决它？

我怀疑天蓝色机器与我的开发机器没有相同版本的 EF。但在 Light switch 项目中，客户端和服务器引用我都找不到 EF 在那里引用。所以我不知道如何将我机器上的 EF dll 带到 Azure 机器上。

有人可以给我一些建议吗？

谢谢

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T05:13:25.227

通常这是乐观并发的副作用。这篇文章可以给你在 Lightswitch 中的想法： [LightSwitch 2012 Concurrency Enhancements](http://blogs.msdn.com/b/lightswitch/archive/2012/07/10/concurrency-enhancements-in-visual-studio-lightswitch-2012-eric-erhardt.aspx)

当它在开发机器上运行而在 Azure 上不起作用时，我猜你的生产数据库中有些地方不对劲。

您还可以查看[实体框架：影响了意外的行数（0）](https://stackoverflow.com/questions/1836173/entity-framework-store-update-insert-or-delete-statement-affected-an-unexpec)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T00:42:57.597

除了插入/更新触发器之外，有时 SQL 服务器不会为每个新插入/更新的行报告一个 IdentityScope。因此 EF 无法实现受影响的行数。通常，对带有标识列的表的任何插入/更新都会立即选择 scope_identity() 以填充实体框架中的关联值。而不是触发器会导致错过第二步，从而导致插入 0 行错误。

您可以将触发器更改为插入之前或之后，或者通过在其末尾添加以下行来调整触发器：

```
select [Id] from [dbo].[TableXXX] where @@ROWCOUNT > 0 and [Id] = scope_identity() 
```

[在此](https://stackoverflow.com/questions/5820992/error-when-inserting-into-table-having-instead-of-trigger-from-entity-data-frame/6298870#6298870)或[此](https://stackoverflow.com/questions/1806828/optimisticconcurrencyexception-sql-2008-r2-instead-of-insert-trigger-with-ent)线程中查找更多详细信息。

# jquery - 在 Magento 客户帐户导航上使用 jQuery Block UI。链接

> ID：14886680
> 
> 赞同：0
> 
> 时间：2013-02-15T00:44:21.920
> 
> 标签：jquery, magento, jquery-blockui

我有一个关于 Magento、jQuery 和 jQuery Block UI 的非常令人困惑的问题。您知道客户访问客户帐户时为他们显示的导航链接吗？通过 XML 创建的那些？

好吧，我正在尝试专门针对其中两个，以便在数据库度过美好时光的同时创建一个 jQuery Block UI 加载动画。我已经启动并运行了 jQuery 和 jQuery Block UI，现在需要以某种方式在屏幕上显示此消息/动画/块/ajaxloader，从用户单击这些特定链接之一到一切都已完全加载的那一刻。或者我可以将代码放在我试图加载的页面上，这样我就不必担心它们来自哪里。但是，我不确定如何通过 jQuery 实现这一点。我目前没有进行 ajax 调用来加载数据（我知道如果我使用 ajax 可能会更简单）。

有任何想法吗？

更新：

谢谢@JaredKipe，但它似乎没有实现我的目标。这是我在 head.phtml 中放置 jQuery 和 Block UI 以及您描述的代码。

```
 <script type="text/javascript"   src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="<?php echo $this->getJsUrl('jqueryBlockUI/jquery.blockUI.js') ?>"></script>
<script type="text/javascript">
    //<![CDATA[
    var $j = jQuery.noConflict();
    //]]>
</script>
<script>
    $j(function () {
            $j('.block-account li:not(.current)').click(function () {
            $j.blockUI();
        });
    });
</script>
<?php echo $this->getCssJsHtml() ?> 
```

这就是控制器加载页面的样子。

```
 public function orderhistoryAction()
{
    if ($this->_getCustomerSession()->isLoggedIn()) {
        $this->loadLayout();
        $this->renderLayout();
    } else {
        $this->_redirect('customer/account/login');
    }
} 
```

显然，块是从布局 xml 文件加载的，但是我不确定在加载/创建块时如何显示 jQuery Block UI（或其他类型的加载消息）。

同样，我对 Magento 框架非常陌生。感谢任何人都可以提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T05:39:09.087

我从来没有听说过 jQuery BlockUI，但文档似乎让它直截了当。

```
jQuery('.block-account li:not(.current)').click(function () {jQuery.blockUI();}); 
```

应该做的伎俩。这会为所有不会阻止实际页面加载的“帐户”链接（当前链接除外）添加一个点击事件，但会激活任何会阻止用户与页面，直到服务器发布响应。这里不需要 AJAX，尽管它可能是需要的......

# php - Yii 使用 CDbCriteria 和 CActiveDataProvider 加入

> ID：14886682
> 
> 赞同：4
> 
> 时间：2013-02-15T00:44:42.040
> 
> 标签：php, yii

这个问题似乎弹出了很多，但是没有一个答案能帮助我解决我的问题。

# 概括

*   我正在使用 Yii 创建一个应用程序；
*   我有三个表，我正在尝试对其中两个进行联接和过滤；
*   我正在尝试使用 CDbCriteria 和 CActiveDataProvider 进行连接和过滤；
*   我有所有表的模型，但是当我尝试加入它们时，我得到一个 SQL 错误。

# 表

![数据库 UML](../Images/bb96f87b8038fe908829bc09f714189b.png)

我为要加入和过滤的表创建了一个模型。

**记录**

```
class Record extends CActiveRecord {
    public $owner;
    ...
    public function rules() {
        return array(
            array('given_name, family_name, dob, gender', 'required'),
            array('qr_id, site_id', 'numerical', 'integerOnly' => true),
            array('given_name, family_name, madin_name', 'length', 'max' => 100),
            array('country_of_birth, country_of_death, title', 'length', 'max' => 45),
            array('gender', 'length', 'max' => 5),
            array('dod, profile, epitaph', 'safe'),
            array('id, qr_id, given_name, family_name, madin_name, dob, dod, country_of_birth, country_of_death, gender, owner', 'safe', 'on' => 'search'),
    );
}

    ...
    public function relations() {
        return array(
            'families_left'  => array(self::HAS_MANY, 'Family', 'record_left_id'),
            'families_right' => array(self::HAS_MANY, 'Family', 'record_right_id'),
            'headstones'     => array(self::HAS_MANY, 'Headstone', 'record_id'),
            'other_names'     => array(self::HAS_MANY, 'OtherName', 'record_id'),
            'users'          => array(self::MANY_MANY, 'Users', 'record_owner(record_id, user_id)'),
            'record_owner'   => array(self::HAS_MANY, 'RecordOwner', 'record_id'),
        );
    }
    ...
} 
```

**记录所有者**

```
class RecordOwner extends CActiveRecord {
    ...
    public function relations() {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array();
    }
    ...
} 
```

# 问题

我更新了搜索，在 CDbCriteria 中添加了关于 record_owner 的条件，我在 record_owner.user_id 上添加了比较，但现在出现 SQL 错误。

**搜索（）**

```
public function search() {
    // Warning: Please modify the following code to remove attributes that
    // should not be searched.

    $criteria = new CDbCriteria;

    $criteria->compare('id', $this->id);
    $criteria->compare('qr_id', $this->qr_id);
    $criteria->compare('given_name', $this->given_name, true);
    $criteria->compare('family_name', $this->family_name, true);
    $criteria->compare('madin_name', $this->madin_name, true);
    $criteria->compare('dob', $this->dob, true);
    $criteria->compare('dod', $this->dod, true);
    $criteria->compare('country_of_birth', $this->country_of_birth, true);
    $criteria->compare('country_of_death', $this->country_of_death, true);
    $criteria->compare('gender', $this->gender, true);
    $criteria->compare('title', $this->title, true);

    $criteria->with = array('record_owner');
    $criteria->compare( 'record_owner.user_id', $this->owner, true );

    return new CActiveDataProvider(
        $this,
        array(
             'criteria'   => $criteria,
             'pagination' => array(
                 'pageSize' => Yii::app()->params['pageSize'],
             )
        )
    );
} 
```

**SQL 错误**

```
CDbCommand failed to execute the SQL statement: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'record_owner.user_id' in 'where clause'. The SQL statement executed was: SELECT `t`.`id` AS `t0_c0`, `t`.`qr_id` AS `t0_c1`, `t`.`given_name` AS `t0_c2`, `t`.`family_name` AS `t0_c3`, `t`.`madin_name` AS `t0_c4`, `t`.`dob` AS `t0_c5`, `t`.`dod` AS `t0_c6`, `t`.`country_of_birth` AS `t0_c7`, `t`.`country_of_death` AS `t0_c8`, `t`.`gender` AS `t0_c9`, `t`.`profile` AS `t0_c10`, `t`.`epitaph` AS `t0_c11`, `t`.`site_id` AS `t0_c12`, `t`.`title` AS `t0_c13` FROM `record` `t` WHERE (record_owner.user_id LIKE :ycp0) ORDER BY `t`.`given_name` LIMIT 25 
```

# 问题

我应该如何做这个加入和过滤？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T03:42:42.517

添加`$criteria->together = true;`到`search`方法中。

看看这个以获得解释：

[http://www.yiiframework.com/doc/api/1.1/CDbCriteria#together-detail](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#together-detail)

尤其是，

> 当不设置该属性时，如果主表被限制或分页，则会为每个 HAS_MANY 关系执行一条 SQL 语句。否则，将为所有人执行一条 SQL 语句。

由于您没有设置此值，并且正在使用分页，因此`record_owner`将通过对到达结果的单独查询来获得 s。当然，假设查询实际上完成了。

通过设置`$criteria->together = true;`，您可以强制将查询设为单个查询，这是通过执行表连接来完成的，这是您想要通过相关表中的列之一过滤查询的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T02:29:48.947

威廉建议的解决方案。是一个单行修复。

添加 $criteria->together = true; 到 search() 方法。

```
public function search() {
    // Warning: Please modify the following code to remove attributes that
    // should not be searched.

    $criteria = new CDbCriteria;

    $criteria->compare('id', $this->id);
    $criteria->compare('qr_id', $this->qr_id);
    $criteria->compare('given_name', $this->given_name, true);
    $criteria->compare('family_name', $this->family_name, true);
    $criteria->compare('madin_name', $this->madin_name, true);
    $criteria->compare('dob', $this->dob, true);
    $criteria->compare('dod', $this->dod, true);
    $criteria->compare('country_of_birth', $this->country_of_birth, true);
    $criteria->compare('country_of_death', $this->country_of_death, true);
    $criteria->compare('gender', $this->gender, true);
    $criteria->compare('title', $this->title, true);

    $criteria->with = array('record_owner');
    $criteria->compare( 'record_owner.user_id', $this->owner, true );
    $criteria->together = true;

    return new CActiveDataProvider(
        $this,
        array(
             'criteria'   => $criteria,
             'pagination' => array(
                 'pageSize' => Yii::app()->params['pageSize'],
             )
        )
    );
} 
```

# r - 使用 for 循环创建多个不同名称的列表？

> ID：14886683
> 
> 赞同：0
> 
> 时间：2013-02-15T00:44:44.370
> 
> 标签：r, list

我有以下向量

```
years <- c(1996,1997,1998,1999,2000,
           2001,2002,2003,2004,2005,2006,2007,2008,2009,2010) 
```

我希望使用 for 循环为向量中的每个数字创建一个列表，列表的名称应该与数字相同。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T00:57:31.333

```
yearlist <- setNames(vector(length(years), mode="list"), years) 
```

# powershell - 在PowerShell中的If条件中使用带点的对象属性

> ID：14886685
> 
> 赞同：0
> 
> 时间：2013-02-15T00:45:04.800
> 
> 标签：powershell

我是 .Net 世界的 PowerShell 新手。我正在尝试写一些 if 语句，例如打击

**#1**

```
if (((Get-Item $pf).Exist))
{
     $password = [xml]( Get-Content $pf)
} 
```

**#2**

```
if (((Get-Item $pf) | Select-Object Exist))
{
     $password = [xml]( Get-Content $pf)
} 
```

**#3**

```
$result=(Get-Item $pf).Exist
if($result)
{
     $password = [xml]( Get-Content $pf)
} 
```

**问题：****#2**和**#3** 都将按预期工作，但是，我也希望**#1**像在 .Net 中一样工作，但它似乎总是评估为假，因此该语句永远不会被执行。我在这里有点困惑，有人能解释一下为什么**#1**没有按我的预期工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T01:24:45.993

他们都错了。它**[存在](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.exists.aspx)**，而不是存在。

另外，当您在文件不存在时测试代码时，我认为您会感到失望。

我想你正在寻找的是

```
Test-Path $pf 
```

# math - 当前日期到数字代码算法反转

> ID：14886687
> 
> 赞同：0
> 
> 时间：2013-02-15T00:45:24.787
> 
> 标签：math

我需要在我们的办公室定期为我们的文档管理系统使用一个软件安装程序，它需要安装程序的代码才能继续。该代码似乎特定于日期。

我想知道是否有任何擅长数学的人对如何计算出用于生成代码的方法有所了解，这样我就不必致电他们的帮助台并等待 2-3 小时来获得 6 位数的字符串。

今天的代码 (15/02/2013) 是 836959。另一天的代码 (06/02/2013) 是 450001。

这里有什么关系还是可以逆向工程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:29:55.883

这不是一个严格的数学问题，它是一个密码学问题，该函数可能是一个[密码哈希函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)......从数学的角度来看，如果密钥的位数是固定的，那么这可能是一个[满射函数](http://en.wikipedia.org/wiki/Surjective_function)，意思是一种将日期映射到键的函数，可能有多个日期映射到同一个键。对于两个数据点，甚至很难猜测该函数可能是什么，除非它是微不足道的......你拥有的点越多，你就越有信心找到他们使用的“那个”函数，但你永远不会确定。唯一可以确定的方法是反汇编二进制文件，许可协议可能禁止您这样做。

# ruby-on-rails - 导轨：评论

> ID：14886690
> 
> 赞同：-1
> 
> 时间：2013-02-15T00:45:33.567
> 
> 标签：ruby-on-rails, comments

我想在 application.html.erb 中注释掉一些东西

```
 <!--
    <div id="user_nav">
 <% if user_signed_in? %>
   Signed in as <%= current_user.email %>. Not you?
   <%= link_to "Sign out", destroy_user_session_path %>
 <% else %>
   <%= link_to "Sign up", new_user_registration_path %> or
   <%= link_to "Sign in", new_user_session_path %>
<% end %>
</div>

//--> 
```

这是不可能的。该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:48:07.090

那是一个 HTML 注释；ERB 处理发生在服务器端。

```
<%#

%> 
```

可以跨块工作，它肯定会逐行工作。

也就是说，我不确定是否会通过注释掉整个部分来删除功能。

而是考虑 (a) 使用源代码控制，或 (b) 呈现部分内容并将其注释掉*，*而不是大块 ERB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T04:06:49.217

对于`.html.erb`文件，您可以使用以下代码进行评论。

```
<!-- Your Comment here --> 
```

# python - 通过表达式查找python dict值

> ID：14886694
> 
> 赞同：0
> 
> 时间：2013-02-15T00:45:54.150
> 
> 标签：python, optimization

我有一个字典，其中包含键的 unix 纪元时间戳，如下所示：

```
lookup_dict = {
    1357899: {} #some dict of data
    1357910: {} #some other dict of data
} 
```

除了，你知道，数以百万计的条目。我想一遍又一遍地对这个字典进行子集化。理想情况下，我希望能够在 R 中写出我能写的东西，比如：

```
lookup_value = 1357900
dict_subset = lookup_dict[key >= lookup_value]
# dict_subset now contains {1357910: {}} 
```

但我承认，我找不到任何实际证据证明 Python 可以做到这一点，而无需以一种或另一种方式遍历每一行。如果我正确理解 Python（我可能不会），表单的键查找`key in dict`使用二进制搜索，因此非常快；有什么方法可以在字典键上进行二进制搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:27:40.510

要在不迭代的情况下执行此操作，您将需要按排序顺序排列的键。然后你只需要对第一个进行二分搜索`>= lookup_value`，而不是检查每个`>= lookup_value`.

如果您愿意使用第三方库，那里有很多。首先想到的两个是[`bintrees`](http://pypi.python.org/pypi/bintrees/1.0.0)（使用红黑树，如 C++、Java 等）和[`blist`](http://pypi.python.org/pypi/blist/)（使用 B+Tree）。例如，使用`bintrees`，它就像这样简单：

```
dict_subset = lookup_dict[lookup_value:] 
```

这将与您希望的一样高效——基本上，它`O(log N)`在使用该子集的任何成本之上添加了一个搜索。（当然通常你想要对那个子集做的是迭代整个事情，无论如何最终都是 O(N) ......但也许你正在做一些不同的事情，或者这个子集可能只是 1000000 个中的 10 个键。）

当然有一个权衡。对基于树的映射的随机访问是 O(log N) 而不是“通常是 O(1)”。此外，您的密钥显然需要完全排序，而不是可散列（而且自动检测和引发漂亮的错误消息要困难得多）。

如果你想自己构建它，你可以。你甚至不一定需要一棵树。只是一个排序`list`旁边的键`dict`。正如 JonClements 建议的那样，您可以使用 stdlib 中`list`的模块来维护。`bisect`您可能想要完成`bisect`一个排序列表对象——或者，更好的是，获取 ActiveState 或 PyPI 上的一个食谱来为您完成。然后，您可以将排序列表和`dict`一起包装到一个对象中，这样您就不会在不更新另一个的情况下意外更新一个。`bintrees`然后，如果您愿意，您可以将界面扩展为与 一样好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:54:55.020

使用以下代码将解决

```
some_time_to_filter_for = # blah unix time
# Create a new sub-dictionary
sub_dict = {key: val for key, val in lookup_dict.items() 
            if key >= some_time_to_filter_for} 
```

基本上我们只是遍历字典中的所有键并给定时间过滤掉，因为我们将所有大于或等于该值的键放入我们的新字典中

# ruby-on-rails - 将 Redis 用作 Rails 的数据存储时应用哪种设计模式

> ID：14886702
> 
> 赞同：0
> 
> 时间：2013-02-15T00:46:33.450
> 
> 标签：ruby-on-rails, redis

我正在考虑使用 Redis 来存储我不想从数据库中提取的内容、用户数、关注者 ID、Rails 必须吐出的长 url ......等等，我正在想办法设计我的应用程序来做到这一点。

我想知道是否采用 redis 是我必须在运行应用程序之前加载的持久数据存储的方法。

所以像

```
Post < ActiveRecord::Base
   def thumbnail_url
      #get redis value
   end
end 
```

或者我是否应该将 Redis 视为一种更短暂的存储，我会在其中做同样的事情

```
Post < ActiveRecord::Base
   def thumbnail_url
      if redis value exists
         get it
      else
         do some ruby stuff and return string #hit Active record
      end
   end
end 
```

还是我应该考虑另一种方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:05:07.747

你见过这颗宝石吗？[https://github.com/nateware/redis-objects](https://github.com/nateware/redis-objects)，这将有助于活动记录。

# java - 可以将抽象类作为子类添加到 HashMap

> ID：14886707
> 
> 赞同：0
> 
> 时间：2013-02-15T00:46:54.253
> 
> 标签：java, hashmap, abstract-class

我有一个方法需要

```
 exampleMethod(Map<String, Number> exMap). 
```

我可以用 Integer 或 Long 等 Number 的子类调用此方法吗？所以方法类将是

```
 A a = new A();
    a.exampleMethod(Map<"String, Integer"> intMap); 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T00:49:35.123

不，为了做到这一点，您需要方法签名

```
exampleMethod(Map<String, ? extends Number> exMap) 
```

当然，那么您将无法向地图添加任何值，只需阅读它们即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T05:28:58.460

I agree with jtahlborn's version, alternatively, you can do it as

```
<T extends Number> void exampleMethod(Map<String, T> exMap) {
} 
```

# java - 为什么在调试 android google maps 示例时没有调用我的 onLocationChanged() 方法？

> ID：14886710
> 
> 赞同：1
> 
> 时间：2013-02-15T00:47:24.343
> 
> 标签：java, android, google-maps, google-maps-android-api-2

一切似乎都运行良好。它可以找到我的位置，但不会调用 onLocationChanged() 方法并为我创建标记。有任何想法吗？

```
public class MainActivity extends FragmentActivity implements LocationListener
{
Context context = this;
GoogleMap googlemap;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    initMap();

    LocationManager lm = (LocationManager) getSystemService(LOCATION_SERVICE);
    String provider = lm.getBestProvider(new Criteria(), true);
    lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 100, 0, this);
}

public void onLocationChanged(Location location) {
    LatLng current = new LatLng(location.getLatitude(), location.getLatitude());
    Date date = new Date();

    googlemap.addMarker(new MarkerOptions()
            .title("Current Pos")
            .snippet(new Timestamp(date.getTime()).toString())
            .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_BLUE))
            .position(current)
            );
}

public void onStatusChanged(String provider, int status, Bundle extras) {
}

public void onProviderEnabled(String provider) {
}

private void initMap(){
    SupportMapFragment mf = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
    googlemap = mf.getMap();

    googlemap.setMyLocationEnabled(true);
    googlemap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T00:14:27.337

您的 Activity 需要实现 LocationSource 接口，并且您需要注册 GoogleMap 以使用 MainActivity 类作为其位置源：

将您的类声明更改为：

```
public class MainActivity extends FragmentActivity implements LocationListener, LocationSource 
```

并设置 GoogleMap 的 LocationSource

```
//This is how you register the LocationSource for the map
googleMap.setLocationSource(this); 
```

有关更多完整示例，请参[见此答案](https://stackoverflow.com/a/13753518/1103584)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:35:24.010

你有打开wifi吗？一切似乎都定义明确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T02:07:13.140

也许您的 wifi 信号很弱并且您遇到了连接问题？尝试通过 GPS 提供商获取位置更新：

```
lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 100, 0, this); 
```

事实上，我总是将两者都包含在内，以便用户可以从任一提供商处获取他的位置。此外，请尝试在 onLocationChanged 回调中包含一条日志语句。如果事实证明实际上正在调用该方法，那么您就知道您的问题在于添加标记，而不是您的位置检索。

# asp.net - 使用最新的 .NET 框架组件，应如何在 ASP.NET 站点中实现客户端计时器？

> ID：14886711
> 
> 赞同：0
> 
> 时间：2013-02-15T00:47:27.840
> 
> 标签：asp.net, .net

我是一个非常新的 ASP.NET 开发人员（和 Web 开发人员） ，当按下时，将配置发布到服务器（设置计时器的时间。）并在客户端启动计时器，到期时，它也会向服务器发布已完成的操作。

如果这很容易，请向我解释如何去做这样的事情，如果这不容易，或者更是如此，如果这“不是解决这个问题的好方法”，请向我解释一个更好的架构或设计这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:06:48.117

由于这是客户端的事情，我不会使用 ASP.NET :) 显然它仍然代表服务器端，无论如何：

1.  具有单个控制器、两个视图和两个相应视图模型的新 ASP.NET MVC 项目。
2.  View 有一个`<form>`带有计时器`<select>`或文本框之类的东西。
3.  控制器有一个动作，它接收 POSTed 表单数据并保存它或其他东西，然后向视图返回 303 响应，该视图具有指定计时器何时结束的隐藏字段，该值应保存在服务器上`Session`，以防万一用户刷新页面。该值应保存为绝对 UTC 日期时间值。
4.  客户端有一个简单的客户端脚本，在页面加载时，它会检查这个隐藏字段并使用`setTimeout`.
5.  该脚本还包含一个回调函数，该函数将在计时器结束时调用。此回调函数将创建并填充一个隐藏的动态`<form>`元素，该元素已提交，从而向服务器发出 POST 请求，其中包含一些标识客户端和计时器已过期的标签。然后服务器执行另一个 303 重定向回到原始视图，可能包含给用户的消息或其他内容。

这可能是使用现代技术并避免使用 AJAX 或外部框架（如 jQuery 或 Mootools）所固有的复杂性的最简单方法。请注意我使用 303 重定向而不是将 HTML 响应返回到 POST 请求 - 这是为了用户的利益，因此他们永远不会让浏览器“重新提交表单？” 对话框，还可以防止计时器被重置。

更新：

### 为什么 3xx 响应良好：

当客户端提交 POST 请求时，网络服务器可以通过直接返回响应或通过 3xx 重定向到另一个页面来响应。直接提供响应的问题在于，就 HTTP 而言，响应的内容（即网页）不是“可访问的”：您无法使用 GET 请求检索相同的内容。这就是为什么当用户按下 F5 或点击刷新以获取已发布的页面时，他们会收到一个消息框，提示他们（用神秘的语言）重新提交表单，但通常如果用户重新提交表单，他们最终会破坏申请，因为他们的数据将被处理两次。这就是严重依赖“回发”的 ASP.NET WebForms 被逐步淘汰的原因。

### Javascript

代码看起来像这样：

```
// bind to this event rather than executing directly because the onload event is only fired after the entire DOM is available. If you run the code immediately then you won't be able to traverse the DOM tree.
window.onload = setUpCallback;

function setUpCallback() {
    var hiddenField = document.getElementByID("someHiddenFieldId");
    var timeStampEnd = parseInt( hiddenField.value ); // this is the number of miliseconds since 1970-Jan-01 00:00
    var timeStampNow = new Date().getTime(); // this also returns a miliseconds-since-1970 value

    var timeToEnd = timeStampEnd - timeStampNow;
    if( timeToEnd > 0 ) {
        window.setTimeout( onTimerEnd, timeToEnd ); // set-up the callback
    }
}

function onTimerEnd() {
    var form = document.createElement("form");
    form.action = "http://mywebsite/uriToSubmitPostTo";
    form.method = "post";
    document.documentElement.appendChild( form );

    var clientField = document.createElement("input");
    clientField.type = "hidden";
    clientField.name = "someFieldName";
    clientField.value = "someValueToIdentifyTheClientOrJustUseSession?";

    form.appendChild( clientField );

    form.submit();
} 
```

# python - 错误的路径导致python程序使用crontab运行

> ID：14886715
> 
> 赞同：4
> 
> 时间：2013-02-15T00:47:45.670
> 
> 标签：python, linux, python-2.7, cron, crontab

我在Linux下的python中有一个脚本，需要确定当前的工作目录。执行此操作的程序部分是：

```
import os
cwd = os.getcwd()
print cwd 
```

当我运行程序时，它给了我正确的答案：

```
/home/johny/LST/CT 
```

但是当我使用 crontab 运行它时，它给了我这个：

```
/home/johny 
```

即使我将它放在更深的文件夹中，也会产生相同的路径。有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:57:05.570

在您的 crontab 文件中执行以下操作：

```
1 0 * * * cd /home/johny/LST/CT; python your_script.py 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T01:00:38.220

cron 可能只是将自己设置为您的主目录。如果您需要脚本在特定目录中运行，请考虑使用类似

```
import os
os.chdir(os.path.dirname(os.path.abspath(__file__))) 
```

在你的脚本的顶部，虽然你的脚本不应该关心它从哪里运行。脚本中的所有文件路径都应该相对于脚本，使用类似：

```
scriptdir = os.path.dirname(os.path.abspath(__file__))

mypath = os.path.join(scriptdir, 'data', 'mfile.dat')

... etc ... 
```

# sql - SQL 在同一个表的子查询中使用多个值

> ID：14886720
> 
> 赞同：0
> 
> 时间：2013-02-15T00:48:15.110
> 
> 标签：sql, subquery

我有一个表，其中包含多个事件类型的多行。

每个开始事件都有一个结束事件。由于设计选择，开始事件在列中具有结束事件的 ID，但反之则不然。同样，开始原因与结束原因不同。

我的专栏是：

```
eventTYPE - the type of event (start, end, terminate etc)
eventID - unique ID
eventDate - date the event will happen
endEvent - ID of end event (if event type <> start - this will be NULL)
reason - Reason for the event 
```

我需要在用户指定的日期返回所有比较 eventType=START 的 eventType=END 的原因不是出于某种原因。

我知道我需要使用以下三个语句，但我不确定如何组合它们。

```
SELECT eventId 
FROM Events
WHERE eventType='END' and eventDate='<USER SPECIFIED>'

SELECT endEvent    
FROM Events
WHERE eventType='START' and reason <> 'mgp' and endEvent='<ID FROM ABOVE>'

SELECT * 
FROM dbo.Events 
WHERE eventType='END' and eventId='<END EVENT FROM ABOVE>' 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:13:33.727

查询是这样的：

```
select *
from events se left outer join
     events ee
     on se.endevent = ee.eventid and se.eventtype = 'start' and ee.eventtype = 'end'
where ee.eventdate = '<USER SPECIFIED>' and
       se.reason <> 'mgp' 
```

这只是将事件连接在一起，匹配开始和结束记录，然后将逻辑应用于该结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:13:09.700

怎么样，

```
SELECT * 
FROM dbo.Events 
WHERE eventType='END' and eventId IN (

   SELECT endEvent    
   FROM Events
   WHERE eventType='START' and reason <> 'mgp' and endEvent IN (

      SELECT eventId 
      FROM Events
      WHERE eventType='END' and eventDate='<USER SPECIFIED>'

   )
) 
```

# mongodb - 如何实现自定义 mongodb 驱动程序

> ID：14886721
> 
> 赞同：0
> 
> 时间：2013-02-15T00:48:21.280
> 
> 标签：mongodb

我在我的项目中使用 mongodb 并且有趣的是如何实现简单的 mongodb 驱动程序，这将允许像 shell 形式一样运行 mongodb 命令。只需在 javascript 中编写命令并将其推送到 mongodb，然后获取结果并反序列化即可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:39:31.050

在下面的代码中替换您的连接字符串。

虽然提供这个一般来说是非常危险的（因为它允许执行任何命令），但只需`eval`在返回的数据库实例上调用该函数。

此代码使用 JavaScript/NodeJS 驱动程序：

```
var
    mongodb = require('mongodb'),
    MongoClient = mongodb.MongoClient
;

MongoClient.connect("mongodb://localhost:27017/default?w=1",
    function (err, db) {
        db.eval("db.version()", null, {noLock: true}, function(err, results) {
            console.log(results);                       
    });
}); 
```

# c# - 获取特定 linq 到 sql 表的名称

> ID：14886725
> 
> 赞同：8
> 
> 时间：2013-02-15T00:49:01.843
> 
> 标签：c#, vb.net, entity-framework, linq-to-sql

我正在使用 Linq to SQL 来操作和 MS Access 数据库。

为了加快批量修改，我发现使用数据上下文直接执行查询更有效，就像这样`context.ExecutCommand("DELETE FROM [MyTable];")`。为了提高效率，我想将此作为扩展方法，但我不知道如何从上下文中检索表名......

我知道我可以将表名作为硬编码字符串传递，例如：

```
public static void DeleteAll(this Table<TEntity> MyTable)
{
    string tableName = // retrieve MyTable's name

    MyTable.Context.ExecuteCommand(string.Format("DELETE FROM [{0}];", tableName));
} 
```

我有一些方法可以获取表名，但需要一些帮助才能使 thsi 正常工作。到目前为止，我有：

```
var tableName = dc.MyTables.Context.GetTable(typeof(MyTable)).ElementType.Name; 
```

但是无法弄清楚如何检索实体的类型，`MyTables`以便不必对参数进行硬编码`.GetTable()`并使它可用于我传入的任何表。

C# 或 VB 中的任何答案都可以。谢谢。

编辑

总结一下我正在寻找的是一种从表本身获取表的实体类型的方法。像`Context.MyTable.GetEntityType()`......如果它那么容易。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T01:06:12.773

我不确定这是否适用于 EF，但我在 Linq to Sql 中使用了这种方法。

您必须使用`System.Data.Linq.Mapping`命名空间中的属性。如果您打开`*.designer.cs`包含任何 Linq to Sql 实体定义的文件，您会在类的声明上方找到这样的一行：

```
[global::System.Data.Linq.Mapping.TableAttribute(Name="YourTableName")] 
```

因此，Linq to Sql 中的每个实体类都标有`TableAttribute`属性，并且它的`Name`属性包含您需要的名称。我们可以使用这个：

```
public static string GetTableName<TEntity>(this Table<TEntity> MyTable) 
                            where TEntity : class
{
    Type type = typeof(TEntity);
    object[] temp = type.GetCustomAttributes(
                           typeof(System.Data.Linq.Mapping.TableAttribute), 
                           true);
    if (temp.Length == 0)
        return null;
    else
        return (temp[0] as System.Data.Linq.Mapping.TableAttribute).Name;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-30T14:17:32.170

这也应该有效：

```
MyTable.Context.Mapping.GetTable(typeof(TEntity)).TableName 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:39:15.340

由于我的表上没有属性，因此我需要获取实体名称，这是 Linq to SQL 在这种情况下将使用的名称，因此根据 Konstantin Vasilicov 的回答，扩展方法变为：

```
 public static string GetTableName<TEntity>(this Table<TEntity> MyTable) where TEntity : class
    {
        string name = string.Empty;
        Type type;
        object[] attributes;

        type = typeof(TEntity);
        attributes = type.GetCustomAttributes(typeof(TableAttribute), true);

        if (attributes.Length > 0)
            name = ((TableAttribute)attributes[0]).Name;
            if (!string.IsNullOrEmpty(name))
                return name;

         return type.Name;
    } 
```

# joomla - Rockettheme：Kinetic - 使横幅全宽

> ID：14886726
> 
> 赞同：0
> 
> 时间：2013-02-15T00:49:03.033
> 
> 标签：joomla

我不知道我会从这篇文章中获得什么样的成功，但目前正在努力在火箭主题论坛上获得回复。

我已经从 Rockettheme.com 下载了这个模板（Kinetic）（下面的演示；） [http://demo.rockettheme.com/?template=kinetic](http://demo.rockettheme.com/?template=kinetic)

我已将其更改为看起来像下面的链接；

[http://evolve.gen.nz/](http://evolve.gen.nz/)

然而，我真的很难将页脚与网站的其他部分区分开来。我正在考虑将其更改为浅灰色，但是由于页脚位于容器中并停在容器的任一边缘，因此我无法使其横跨整个网站。

有没有让页脚颜色直接穿过页面？

（和下面的网站一样，如果你到页面底部，你会看到深灰色，木炭色）

[http://www.colmanweb.co.nz/websites/refuge/](http://www.colmanweb.co.nz/websites/refuge/)

关于如何实现这一目标的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T06:09:08.367

`templates/kinetic/index.php`你只需要编辑模板的index.php文件，大致应该在。如果你走到底部，你会发现一个带有`rt-footer`. 您将需要拉出整个 div 语句并将其粘贴到带有 id 的 div 之外`rt-surround`。你最好的选择是在`rt-debug`上面找到并粘贴它。

我在 Rocket Theme 的基本龙门模板上运行了很多网站，并且经常做这种事情，所以它应该可以工作。

您可能会遇到两个问题。如果你没有得到正确的结束 div 标签，如果 div 没有正确关闭，你会得到一些奇怪的输出。所以要小心并使用缩进来帮助你。

其次，可能有一些特定于旧层次结构的 CSS 样式。在这种情况下，我对此表示怀疑，但它可能会发生。您可能需要修复一些 CSS 样式。

# mysql - Moodle加入查询慢

> ID：14886738
> 
> 赞同：0
> 
> 时间：2013-02-15T00:50:54.250
> 
> 标签：mysql, join, moodle

我已经在这件事上待了几个小时。有人对如何加快此查询有任何想法吗？

```
SELECT SQL_CALC_FOUND_ROWS
mdl_course.fullname as course_name,
mdl_course.idnumber as course_length,
mdl_user.firstname as firstname,
mdl_user.lastname as lastname,

case when mdl_course_completions.timecompleted IS NOT NULL
then FROM_UNIXTIME(mdl_course_completions.timecompleted,'%m/%d/%Y') else 'N/A' end AS date_completed,

mdl_cohort.name AS group_name,
mdl_course_categories.name as category_name,

case when mdl_course_completions.timecompleted IS NOT NULL then 'Completed' else
'Incomplete' end AS completion_status
FROM mdl_enrol
JOIN mdl_user_enrolments    ON mdl_user_enrolments.enrolid  = mdl_enrol.id
JOIN mdl_course             ON mdl_course.id                = mdl_enrol.courseid        
JOIN mdl_user               ON mdl_user.id                  = mdl_user_enrolments.userid AND mdl_user.deleted = 0
JOIN mdl_cohort_members     ON mdl_cohort_members.userid    = mdl_user.id
JOIN mdl_cohort             ON mdl_cohort.id                = mdl_cohort_members.cohortid
JOIN mdl_course_categories  ON mdl_course_categories.id     = mdl_course.category

JOIN mdl_course_completions ON mdl_course_completions.course = mdl_course.id
AND mdl_course_completions.userid = mdl_user.id
AND mdl_course_completions.deleted IS NULL

GROUP BY mdl_course_completions.id
ORDER BY mdl_course.fullname ASC 
```

mdl_course_completions 中有超过 100,000 行，并且正在减慢所有速度。

# javascript - 嵌入式视频显示在照片库顶部

> ID：14886739
> 
> 赞同：0
> 
> 时间：2013-02-15T00:50:58.443
> 
> 标签：javascript, html, css, embed, photo-gallery

因此，我有一个正在处理的网页，并且在单击代表该画廊的图像后，“灯箱”效果显示覆盖在网站顶部的图片库时遇到问题。

[http://themeanseasonband.com/media](http://themeanseasonband.com/media)

它在我的 Mac 计算机（Safari、Chrome 和 Firefox）和我测试过的另一台 Mac 上的所有浏览器中都能正常工作。但由于某种原因，在任何使用相同浏览器的 Windows 计算机上（也在 IE 8 和 9 中），屏幕底部的视频位于灯箱顶部。

我已经尝试了 z-index 并包含在嵌入式视频对象中：

```
<param name="wmode" value="opaque" /> 
```

我已经看到其他时间建议纠正嵌入式视频的 z-index 问题，但它不起作用。

我不确定我在这里缺少什么以及为什么它可以在 Mac 上运行，而不是在 Windows 上运行。

下面是一些相关的代码。上面的链接转到该特定页面，以便您查看。抱歉，我尽量保持简短。

HTML

```
 <div id="med_photos">
        <h4 class="col_header">Photo Albums</h4>
        <ul>
            <li>
                <img src="img/photo/dec_07_11_blackcat.jpg" alt="Photos" />
                <div class="image_title">
                    <h5 class="img_title">12/7/2011 @ Black Cat</h5>
                </div>
            </li>
        </ul>
    </div>

    <div id="med_videos">
        <h4 class="col_header">Videos</h4> 
        <object class="video" width="300" height="169">
            <param name="movie" value="http://www.youtube.com/v/TCN1vYMfEls?hl=en_US&amp;version=3" />
            <param name="allowFullScreen" value="true" />
            <param name="allowscriptaccess" value="always" />
            <param name="wmode" value="opaque" />
            <embed src="http://www.youtube.com/v/TCN1vYMfEls?hl=en_US&amp;version=3" type="application/x-shockwave-flash" width="300" height="169" allowscriptaccess="always" allowfullscreen="true"></embed>
        </object>
    </div> 
```

CSS

```
#med_photos {
width: 1000px;
margin: 0 0 20px 0;
padding: 0;
overflow: hidden;
border-top: 1px solid #fff;
}
#med_videos {
width: 1000px;
margin: 0 0 20px 0;
padding: 0;
border-top: 1px solid #fff;
overflow: hidden;
}
#med_photos ul {
overflow: hidden;
}
#med_photos ul li {
float: left;
list-style-type: none;
position: relative;
cursor: pointer;
display: inline;
padding: 10px;
margin: 0 25px 25px 0;
}

/*Lightbox*/

.lb_backdrop {
background: rgba(0, 0, 0, 0.9);
position: fixed;
top: 0; left: 0; right: 0; bottom: 0;
}
.lb_dimmer {
background: rgba(50, 50, 50, 0.7);
position: fixed;
top: 0; left: 0; bottom: 0; right: 0;/*Will be centered later by Jquery*/
}
.lb_canvas {
background: rgba(0, 0, 0, 0.9);
width: 50px; height: 50px;
position: fixed;
top: 0; left: 0; /*Will be centered later by Jquery*/
box-shadow: 0 0 20px 5px black;
z-index: 1;
padding: 25px;
}

/*Lightbox Controls*/

.lb_controls {
width: 400px; 
background: rgba(0, 0, 0, 0.75);
position: fixed;
bottom: 10px;
color: #fff;
z-index: 5;
left: 0; right: 0; margin: 0 auto; 
}
.lb_credit {
width: 280px; 
background: rgba(0, 0, 0, 0.75);
position: fixed;
bottom: 50px;
color: #fff;
z-index: 5;
left: 0; right: 0; margin: 0 auto; 
}
.lb_credit span {
line-height: 20px;
height: 20px;
}
.lb_controls span {
line-height: 30px;
height: 30px;
}
.lb_controls span.inactive {
opacity: 0.25;
}
.lb_previous, .lb_next {
position: absolute;
top: 0;
padding: 5px 12px;
font-family: websymbols;
font-size: 14px;
background: black;
cursor: pointer;
z-index: 5;
}
.lb_previous {
left: 0;
border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.lb_next {
right: 0;
border-left: 1px solid rgba(255, 255, 255, 0.1);
}
.lb_title {
text-align: center;
display: block;
font-size: 14px;
text-transform: uppercase;
padding: 5px 0;
font-weight: bold;
} 
```

加载灯箱的 Javascript 部分

```
function loadphoto(photonum)
{
    if(lb_loading) return false;
    lb_loading= true;
    //The large image
    large_img = new Image();
    //Use data-large or the src itself if large image url is not available
    large_img.src = (gallery_dir+photonum+'.jpg');

    //Adding additional HTML - only if it hasn't been added before
    if($(".lb_backdrop").length < 1)
    {
        var lb_backdrop = '<div class="lb_backdrop"></div>';
        var lb_dimmer = '<div class="lb_dimmer"></div>';
        var lb_canvas = '<div class="lb_canvas"></div>';
        var lb_previous = '<span class="lb_previous"><</span>';
        var lb_title = '<span class="lb_title"></span>';
        var lb_next = '<span class="lb_next">></span>';
        var lb_controls = '<div class="lb_controls">'+lb_previous+lb_title+lb_next+'</div>';
        var total_html = lb_backdrop+lb_dimmer+lb_canvas+lb_controls;

        $(total_html).appendTo("body");
    }
    //Fade in lightbox elements if they are hidden due to a previous exit
    if($(".lb_backdrop:visible").length == 0)
    {
        $(".lb_backdrop, .lb_dimmer, .lb_canvas, .lb_controls, .lb_credit").fadeIn("slow");
    }

    //Display preloader till the large image loads and make the previous image translucent so that the loader in the BG is visible
    if(!large_img.complete) 
        $(".lb_canvas").addClass("loading").children().css("opacity", "0.5")

    //Disabling left/right controls on first/last items
    if(currPhoto == 1)
        $(".lb_previous").addClass("inactive");
    else
        $(".lb_previous").removeClass("inactive");
    if(currPhoto == gallery_size)
        $(".lb_next").addClass("inactive");
    else
        $(".lb_next").removeClass("inactive");

    //Centering .lb_canvas
    CW = $(".lb_canvas").outerWidth();
    CH = $(".lb_canvas").outerHeight();
    //top and left coordinates
    CL = ($(window).width() - CW)/2;
    CT = ($(window).height() - CH)/2;
    $(".lb_canvas").css({top: CT, left: CL});

    //Inserting the large image into .lb_canvas once it's loaded
    $(large_img).load(function(){
        //Recentering .lb_canvas with new dimensions
        CW = large_img.width;
        CH = large_img.height;
        //.lb_canvas padding to be added to image width/height to get the total dimensions
        hpadding = parseInt($(".lb_canvas").css("paddingLeft")) + parseInt($(".lb_canvas").css("paddingRight"));
        vpadding = parseInt($(".lb_canvas").css("paddingTop")) + parseInt($(".lb_canvas").css("paddingBottom"));
        CL = ($(window).width() - CW - hpadding)/2;
        CT = ($(window).height() - CH - vpadding)/2;

        //Animating .lb_canvas to new dimentions and position
        $(".lb_canvas").html("").animate({width: CW, height: CH, top: CT, left: CL}, 500, function(){
            //Inserting the image but keeping it hidden
            imgtag = '<img src="'+large_img.src+'" style="opacity: 0;" />';
            $(".lb_canvas").html(imgtag);
            $(".lb_canvas img").fadeTo("slow", 1);
            //Displaying the image title
            title = gallery_title+" - "+currPhoto+" of "+gallery_size
            $(".lb_title").html(title);
            lb_loading= false;
            $(".lb_canvas").removeClass("loading");
        })
    })
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T12:02:09.360

所以事实证明，我真正需要做的就是使用 iframe。由于这不适用于移动网站，因此我认为这对我有用。

```
 <div id="med_videos">
        <h4 class="col_header">Videos</h4> 
        <iframe class ="video" width="300" height="169" src="http://www.youtube.com/embed/TCN1vYMfEls?wmode=transparent" frameborder="0" allowfullscreen></iframe>
        <iframe class ="video" width="300" height="169" src="http://www.youtube.com/embed/U9Rpf8vYAlc?wmode=transparent" frameborder="0" allowfullscreen></iframe>
        <iframe class ="video" width="300" height="169" src="http://www.youtube.com/embed/zVaWFOjwLjc?wmode=transparent" frameborder="0" allowfullscreen></iframe>
    </div> 
```

# html - 我可以将整个页面包装在一个 div 中以将其向下移动几个像素而不破坏其复杂的布局吗？

> ID：14886740
> 
> 赞同：-1
> 
> 时间：2013-02-15T00:50:59.540
> 
> 标签：html, css, position

我必须在页面顶部添加一个小横幅，并且无法将现有内容向下推 40 像素，以便我可以放入上面的横幅中。

当前布局有很多被扼杀的定位元素，如果我将整个主体区域包装在具有上边距的相对块 div 中，它们都会不断移动。

除了像这样包装在 div 中之外，还有什么技术可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:55:52.023

为什么不把 a 放在页面顶部，然后将该 div 设置为 clear:both 。这应该将页面的其余部分向下移动 40 像素，或者您将该 div 的高度设置为任何值。当然，我只是在这里猜测，没有查看代码和/或示例站点。由于我假设奇怪的位置是指位置的奇怪用法：绝对，这应该允许您当前的设置保持一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:57:32.327

如果你这样做，那么你必须小心你要移动的 div 上的 CSS 定位不是绝对的。因为如果是这样，那么他们将留在原地。但是，如果您添加一个包含所有内容的 div 并使用 CSS 在顶部放置几个像素的填充，它应该可以工作。

# jquery - 幻灯片 DOM 操作

> ID：14886741
> 
> 赞同：0
> 
> 时间：2013-02-15T00:51:03.783
> 
> 标签：jquery, css, performance, browser, dom-manipulation

我一直在研究各种基于 jQuery 的幻灯片脚本，对使用的不同方法以及它们如何处理基于 CSS3 的过渡和 DOM 操作感兴趣。我有一个基于 jQuery 的幻灯片 WordPress 插件，但它有点过时了，所以我正在重新编码它。

我对 jQuery 非常熟悉，多年来一直在使用它，并且编写了一个公开可用的插件，我已经看到了一些极端的用例，其中 50 多张图像已用于 1920x1200 以上的图像（主要是摄影师）。

在对解决此类情况的最佳方法进行一些研究时，我已经看到了两种流行趋势，我想知道哪个更好。

第一个是简单地将“幻灯片”放置在一个容器内，然后动画。通常，容器绝对定位于将其从文档流中取出并加快处理速度（尤其是在使用 CSS3 时）。

接下来是在 DOM 中保留 4 到 8 个“幻灯片”，并在用户导航时附加/删除它们。

这些方法中哪一种是更好的方法？从 DOM 中添加/删除被认为是最昂贵的更改，但在这种情况下，它是否比在文档流之外操作包含 50 多个非常大图像的容器更便宜？尤其是在移动设备上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T05:00:49.873

我会在两者之间做点什么……除了在 dom 中显示的图像之外，我还会保留一些额外的图像……所以每当用户向左或向右滑动时……我会简单地显示一个已经下载的图像并附加到dom（非常便宜的操作）..

同时，我会删除远离 dom 的图像并将它们缓存到 javascript 数组中。

这样我就不会用太多的图像给 DOM 带来负担（你事先不知道滑块将包含多少张图像），同时我不会通过尝试在 DOM 明智地操作太多图像来损害用户体验

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:57:30.697

如果您想在使用大量幻灯片时最有效地使用内存，那么您可能希望一次只加载几张幻灯片图像（接下来的几张幻灯片），而不是整个集合。

同时，您需要预先加载一些即将发布的图像，以便在您想要显示它们时准备好它们，因为最耗时的任务是在显示之前通过互联网将图像下载到本地浏览器。

如果您只预加载一些即将发布的图像，那么您可以：

1.  将它们预加载到`img`您在 javascript 中保存的对象中，然后在需要时将其插入 DOM。

2.  将它们预加载到`img`已经在 DOM 中但隐藏的对象中，然后当您想要显示它时，可以使其可见。

只要您只预先加载几个图像并删除以前显示的图像，以便在不再需要时不会将它们保存在内存中，这两种方法之间应该没有显着差异。如果您真的想知道它们之间是否有任何可测量的差异（在内存消耗方面），您必须尝试设计一个性能测试以便进行测量。

* * *

过去我制作了可以显示大量图像的幻灯片，最重要的是确保幻灯片运行时不会累积内存使用量和使用越来越多的内存。当幻灯片最初运行时，内存使用量应该会增加，然后应该会变平并停止增加，因为您达到了一个稳定状态，即在加载新图像时释放旧图像。这在浏览器中有点难以衡量，因为它们还有内存缓存和惰性垃圾收集，这会掩盖幻灯片实际使用的内存，但是如果你让它运行足够长的时间处理大量图像并且它会继续永远向上，然后你知道你有一个问题需要解决。如果它停滞不前并且停止上升，那么你可能很好。

# visual-studio-2010 - OpenGL 程序适用于 GL 3.x 但不适用于 4.x

> ID：14886745
> 
> 赞同：0
> 
> 时间：2013-02-15T00:51:34.167
> 
> 标签：visual-studio-2010, opengl, hardware

作为这个问题的序言，我是 openGL 和 Visual Studio 的新手，所以我可能会遗漏一些相当明显的东西。我正在关注一个 openGL 教程，该教程应该设置一个基本窗口，显示有关您正在使用的 openGL 版本的信息。

[教程](http://openglbook.com/the-book/chapter-1-getting-started/)| [设置](http://openglbook.com/setting-up-opengl-glew-and-freeglut-in-visual-c/)

作为参考，我在 NVidia GTX670m 上的 64 位 Windows 7 上运行 VS2010。当我指定样板程序在 openGL v3.x 中运行时。它运行得很好。当我指定它在 v4.x 中运行时。它崩溃并显示以下输出（之后要继续的问题）：

```
'Engine.exe': Loaded 'D:\Engine\Engine\Release\Engine.exe', Symbols loaded.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ntdll.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\kernel32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\KernelBase.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\freeglut.dll', Binary was not built with debug information.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\user32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\gdi32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\lpk.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\usp10.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msvcrt.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\advapi32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\sechost.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\rpcrt4.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\sspicli.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\cryptbase.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\opengl32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\glu32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ddraw.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\dciman32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\setupapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\cfgmgr32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\oleaut32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ole32.dll', Symbols loaded.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\devobj.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\dwmapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\winmm.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msvcr100.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\imm32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msctf.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\nvinit.dll', Cannot find or open the PDB file
'Engine.exe': Loaded 'C:\Windows\SysWOW64\uxtheme.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Program Files (x86)\Common Files\Spigot\Search Settings\wth159.dll', Cannot find or open the PDB file
'Engine.exe': Loaded 'C:\Windows\SysWOW64\psapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ig7icd32.dll', Cannot find or open the PDB file
'Engine.exe': Loaded 'C:\Windows\SysWOW64\version.dll', Symbols loaded (source information stripped).
'Engine.exe': Unloaded 'C:\Windows\SysWOW64\version.dll'
The program '[7332] Engine.exe: Native' has exited with code 1 (0x1). 
```

在谷歌搜索这个问题时，我看到一些人建议在调试菜单中从 MS 服务器中提取符号并关闭将警告视为错误的选项。我都尝试了，但程序仍然崩溃。即使没有，我觉得我还是应该调查原因。

**假设：** NVidia 将 GTX 670 列为支持 openGL 4.x。它没有明确说支持 670m，但我假设如果常规 670 是 - 那个移动版本是。

**问：**如果程序在 openGL v3.x 上运行良好，并且我的硬件应该支持 openGL v4.x，是什么导致我的程序崩溃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:01:25.707

你的程序没有崩溃。某些逻辑中的条件可能没有得到满足，导致另一个分支运行，但它确实运行到完成。

除了最后一行，您发布的所有输出都与您的“问题”没有任何关系，这表明代码进入了一个以`ExitProcess(1)`or结尾的分支`return EXIT_FAILURE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T19:36:27.993

感谢大家的帮助。我最终在另一台机器上运行它并且没有遇到问题。要么是我的笔记本电脑规格有问题，要么是 freeglut 有问题

# php - 是否仍然可以访问提交的表单数据？

> ID：14886747
> 
> 赞同：0
> 
> 时间：2013-02-14T21:32:31.113
> 
> 标签：php, forms

我的主要目标是将用户提交的表单数据保存到我们的 MSSQL 数据库和电子邮件服务提供商 (iContact)

我限制使用 iContact 的页面作为操作属性。这是示例：

> <form **action="icontact.php"** id="" >

iContact.PHP 运行后，它会将页面重定向到我的确认页面。

那么是否仍然可以访问提交的表单数据？那么我可以运行自己的代码将其保存在我的数据库中吗？

谢谢！

**旁注：** iContact 是我使用的电子邮件营销服务。我联系了 iContact 的开发人员并说我需要使用他们的**icontact.php**页面才能将我的数据存储到他们的电子邮件联系人数据库中。

当前结构：

1.  用户以 HTML 格式填写表单，用户提交
2.  转到 iContact php 页面（我无法控制）
3.  在#2 过程之后，将页面重定向到我的确认页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:57:08.660

您可以为此使用会话。

简单地包括

```
session_start(); 
```

在 icontact.php 和 nextpage.php 的顶部；

然后在 icontact.php 中，您从 post 变量中设置会话变量，例如

```
$_SESSION['data1'] = $_POST['data1'];
//etc. 
```

并在 nextpage.php 中将它们存储为

```
$data1 = $_SESSION['data1'];
mysql_query("INSERT INTO mytable(field,etc) VALUES ('$data1','$etc');" , $connection); 
```

# ios - paymentQueueRestoreCompletedTransactionsFinished: 是在调用了 finishTransaction 之后调用的吗？

> ID：14886749
> 
> 赞同：4
> 
> 时间：2013-02-15T00:52:01.517
> 
> 标签：ios, app-store, in-app-purchase

我班观察`SKPaymentQueue`。我打电话：

```
[[SKPaymentQueue defaultQueue] restoreCompletedTransactions]; 
```

状态的文档`paymentQueueRestoreCompletedTransactionsFinished:`：

> “在支付队列处理完所有可恢复的交易后调用此方法。”

只是为了过于清楚，这意味着它在以下情况下被调用：

*   没有要恢复的项目（或者这是否会导致调用`paymentQueue:restoreCompletedTransactionsFailedWithError:`？）
*   `finishTransaction`已在 restore 调用返回的每个事务上调用。

如果不正确，什么是正确的？

# python - AttributeError：addinfourl 实例没有属性“get_type”

> ID：14886750
> 
> 赞同：2
> 
> 时间：2013-02-15T00:52:15.473
> 
> 标签：python, python-2.7, beautifulsoup, urllib

好的，我正在尝试使用带有漂亮汤的开瓶器从页面中提取一些信息，我认为这就是问题所在。我需要使用 opener，因为我需要通过 Tor 路由它，因为我认为他们已经阻止了多个请求。

（如果这都是未格式化的，我会立即编辑，因为通常会发生一些奇怪的事情。）

这是代码：

```
def getsite():
    proxy = urllib2.ProxyHandler({"http" : "127.0.0.1:8118"})
    opener = urllib2.build_opener(proxy)
    opener.addheaders = [('User-agent', 'Mozilla/5.0')]
    url = opener.open('https://www.website.com')
    try:
        page = BeautifulSoup(urllib2.urlopen(url).read())
    except Exception as Err:
        errorlist.append('Unexpected Error ' + str(Err))
        time.sleep(60)
        page = BeautifulSoup(urllib2.urlopen(url).read())
    values = page.findAll("strong")
    high = values[2]
    low = values[1]
    last = values[0]
    vol = values[3]

    high = str(high)
    low = str(low)
    last = str(last)
    vol = str(vol)
    high = high[8:-13]
    low = low[8:-13]
    last = last[8:-13]
    vol = vol[8:-24]

    print high, low, last, vol

while True:
    getsite()
    time.sleep(3200) 
```

它抛出了这个错误。

```
page = BeautifulSoup(urllib2.urlopen(url).read())   File "C:\Python27\lib\urllib2.py", line 126, in urlopen
return _opener.open(url, data, timeout)   File "C:\Python27\lib\urllib2.py", line 392, in open
protocol = req.get_type() AttributeError: addinfourl instance has no attribute 'get_type' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T00:57:19.880

看起来您正在使用 opener 对象，就好像它是一个 URL：

```
page = BeautifulSoup(urllib2.urlopen(url).read()) 
```

`url`打开的开瓶器在哪里...相反，请执行以下操作：

```
page = BeautifulSoup(url.read()) 
```

# scipy - 在 EPD Free 中使用 SciPy 函数

> ID：14886752
> 
> 赞同：2
> 
> 时间：2013-02-15T00:52:21.157
> 
> 标签：scipy, linear-algebra, enthought

我对 Enthought 和 SciPy 完全陌生，EPD 免费支持建议我来这里寻求帮助。

我刚开始通过麻省理工学院的开放课程网站学习线性代数课程。在寻找免费的 Matlab 替代品时，我被指示使用 SciPy/NumPy 和 matplotlib 作为最佳替代品。SciPy 网站本身推荐 Enthought 作为 Windows 的最简单安装。

所以现在我在我的系统上安装了 EPD Free，但是当我尝试做一些简单的事情时，比如 sp.sqrt(-1) （这是[http://docs.scipy.org/doc/上作为示例给出的第一个函数scipy/reference/tutorial/basic.html](http://docs.scipy.org/doc/scipy/reference/tutorial/basic.html)）我收到错误“sp未定义”。

那么如何访问 SciPy 函数呢？我很难为初学者找到 EPD 指南，也许我为介绍性线性代数选择了错误的工具？

提前谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:27:15.757

使用前需要导入 scipy。在脚本或交互式会话的开头添加以下内容：

```
import scipy as sp 
```

# android - 谷歌地图 API v2 不工作

> ID：14886758
> 
> 赞同：8
> 
> 时间：2013-02-15T00:52:43.517
> 
> 标签：android, google-maps, google-maps-api-2, google-maps-android-api-2

我正在尝试使用 Google Maps API v2 构建一个应用程序，但问题是，尽管我遵循了所有必需的说明，但该应用程序不断给我强制关闭。

这是安卓部分

```
import android.support.v4.app.FragmentActivity;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;

public class GPSonMap extends FragmentActivity{

 MapView map;
 MapController controller;
 LocationManager locationManager;
 LocationListener listener;
 PendingIntent pendingIntent ;
 Criteria criteria;
 MapOverlay overlay;

@Override
public void onCreate(Bundle onsaved)
{
    super.onCreate(onsaved);
    setContentView(R.layout.map);
    Log.d("", "entered");

    map = (MapView)findViewById(R.id.mapView);
    } 
```

这是XML

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MapsActivity" >

<fragment

    class="com.google.android.gms.maps.SupportMapFragment"
    android:id="@+id/mapView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
/>

</RelativeLayout> 
```

这是我的清单

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.bachelor.bond"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-sdk
            android:minSdkVersion="14"
            android:targetSdkVersion="17" />
      <!--   <permission
              android:name="com.example.example.permission.MAPS_RECEIVE"
              android:protectionLevel="signature"/>
            <uses-permission android:name="com.bachelor.bond.permission.MAPS_RECEIVE"/>. -->

           <uses-permission android:name="android.permission.INTERNET" />
         <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
        <permission android:name="com.example.example.permission.C2D_MESSAGE" android:protectionLevel="signature" />
    <uses-permission android:name="com.example.example.permission.C2D_MESSAGE" /> 

    <!-- App receives GCM messages. -->
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <!-- GCM connects to Google Services. -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
        <uses-permission android:name="android.permission.READ_PHONE_STATE"/> 
    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK"
         />
    <uses-permission android:name="com.example.example.permission.MAPS_RECEIVE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
      <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />  
    <!-- Permission to vibrate -->
        <uses-permission android:name="android.permission.VIBRATE"/>
        <uses-permission android:name = "android.permission.ACCESS_FINE_LOCATION"/>

        <permission 
        android:name="com.example.example.permission.MAPS_RECEIVE" 
        android:protectionLevel="signature"></permission>

        <uses-feature 
        android:glEsVersion="0x00020000" 
        android:required="true"/>
        <application
            android:allowBackup="true"
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name">
            <uses-library android:name="com.google.android.maps" />
             <activity
                android:name=".GPSonMap"
                android:label="@string/app_name"
                 > <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>

            </activity>

             <uses-library android:name="com.google.android.maps" />
             <intent-filter>
        <action android:name="com.google.android.c2dm.intent.RECEIVE" />
        <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
        <category android:name="com.example.example" />
      </intent-filter>
              <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" 
                 android:permission="com.google.android.c2dm.permission.SEND" >

    </receiver>
     <service android:name=".GCMIntentService" />
     <activity android:name="Login"></activity>

     <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="****"/>

        </application>

    </manifest> 
```

和 Log Cat 输出

```
02-15 00:42:35.257: E/AndroidRuntime(2693): FATAL EXCEPTION: main
02-15 00:42:35.257: E/AndroidRuntime(2693): java.lang.RuntimeException: Unable to start         activity ComponentInfo{com.bachelor.bond/com.dxample.example.GPSonMap}:     android.view.InflateException: Binary XML file line #7: Error inflating class fragment
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.os.Looper.loop(Looper.java:137)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at java.lang.reflect.Method.invokeNative(Native Method)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at java.lang.reflect.Method.invoke(Method.java:511)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at dalvik.system.NativeStart.main(Native Method)
02-15 00:42:35.257: E/AndroidRuntime(2693): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class fragment
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:704)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.Activity.setContentView(Activity.java:1881)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at com.bachelor.bond.GPSonMap.onCreate(GPSonMap.java:54)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.Activity.performCreate(Activity.java:5104)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
02-15 00:42:35.257: E/AndroidRuntime(2693):     ... 11 more
02-15 00:42:35.257: E/AndroidRuntime(2693): Caused by:         android.support.v4.app.Fragment$InstantiationException: Unable to instantiate fragment     com.google.android.gms.maps.SupportMapFragment: make sure class name exists, is public, and     has an empty constructor that is public
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.support.v4.app.Fragment.instantiate(Fragment.java:401)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.support.v4.app.Fragment.instantiate(Fragment.java:369)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:272)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:676)
02-15 00:42:35.257: E/AndroidRuntime(2693):     ... 21 more
02-15 00:42:35.257: E/AndroidRuntime(2693): Caused by: java.lang.ClassNotFoundException:     Didn't find class "com.google.android.gms.maps.SupportMapFragment" on path:     /system/framework/com.google.android.maps.jar:/data/app/com.bachelor.bond-1.apk
02-15 00:42:35.257: E/AndroidRuntime(2693):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
02-15 00:42:35.257: E/AndroidRuntime(2693):     at android.support.v4.app.Fragment.instantiate(Fragment.java:391)
02-15 00:42:35.257: E/AndroidRuntime(2693):     ... 24 more 
```

我面临的另一个问题是，当我尝试
`import com.google.android.gms.maps.MapFragment;` 它时，它会给出一个错误，它无法识别包名称，`com.google.android.gms`所以我什至不能使用`GoogleMap`or`MapFragment`例如。

那么有人对这两个问题有任何解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T09:47:27.283

**如何在 Android 上通过 Google Maps API v2 显示 GOOGLE MAP。**

**请注意，**设置 Google Play 服务和清单文件（包括多个权限和 API 密钥）都需要这两种情况。

**1.在（支持）Fragment中显示谷歌地图。**

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>

<!-- This can go anywhere in your layout (see other demos for some examples). -->
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  class="com.google.android.gms.maps.SupportMapFragment"/> 
```

**MainActivity.java**

```
/**
 * This shows how to create a simple activity with a map and a marker on the map.
 * <p>
 * Notice how we deal with the possibility that the Google Play services APK is not
 * installed/enabled/updated on a user's device.
 */
public class BasicMapActivity extends android.support.v4.app.FragmentActivity {
    /**
     * Note that this may be null if the Google Play services APK is not available.
     */
    private GoogleMap mMap;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        setUpMapIfNeeded();
    }

    @Override
    protected void onResume() {
        super.onResume();
        setUpMapIfNeeded();
    }

    /**
     * Sets up the map if it is possible to do so (i.e., the Google Play services APK is correctly
     * installed) and the map has not already been instantiated.. This will ensure that we only ever
     * call {@link #setUpMap()} once when {@link #mMap} is not null.
     * <p>
     * If it isn't installed {@link SupportMapFragment} (and
     * {@link com.google.android.gms.maps.MapView
     * MapView}) will show a prompt for the user to install/update the Google Play services APK on
     * their device.
     * <p>
     * A user can return to this Activity after following the prompt and correctly
     * installing/updating/enabling the Google Play services. Since the Activity may not have been
     * completely destroyed during this process (it is likely that it would only be stopped or
     * paused), {@link #onCreate(Bundle)} may not be called again so we should call this method in
     * {@link #onResume()} to guarantee that it will be called.
     */
    private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the map.
        if (mMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map))
                    .getMap();
            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                setUpMap();
            }
        }
    }

    /**
     * This is where we can add markers or lines, add listeners or move the camera. In this case, we
     * just add a marker near Africa.
     * <p>
     * This should only be called once and when we are sure that {@link #mMap} is not null.
     */
    private void setUpMap() {
        mMap.addMarker(new MarkerOptions().position(new LatLng(0, 0)).title("Marker"));
    }
} 
```

**2.在（支持）Fragment中显示MapView。**

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>

<!-- This can go anywhere in your layout. -->
<com.google.android.gms.maps.MapView xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"/> 
```

**MainActivity.java**

```
/**
 * This shows how to create a simple activity with a raw MapView and add a marker to it. This
 * requires forwarding all the important lifecycle methods onto MapView.
 */
public class RawMapViewDemoActivity extends android.support.v4.app.FragmentActivity {
    private MapView mMapView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mMapView = (MapView) findViewById(R.id.map);
        mMapView.onCreate(savedInstanceState);

    }

    @Override
    protected void onResume() {
        super.onResume();
        mMapView.onResume();

    }

    @Override
    protected void onPause() {
        mMapView.onPause();
        super.onPause();
    }

    @Override
    protected void onDestroy() {
        mMapView.onDestroy();
        super.onDestroy();
    }

    @Override
    public void onLowMemory() {
        super.onLowMemory();
        mMapView.onLowMemory();
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T00:57:46.490

想必您还没有将 Google Play Services 库项目的引用添加到您的应用项目中。请参阅[Google Play 服务 SDK 文档](http://developer.android.com/google/play-services/setup.html)，特别是标题为“设置项目以使用 Google Play 服务 SDK”的部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T14:33:03.013

我发现您在代码中遗漏了几件事。

**答案 1：**您的 GPSonMAP.java 必须进行如下修改；

```
public class GPSonMap extends android.support.v4.app.FragmentActivity{
 GoogleMap googlemap;  // "MapView map;" is wrong
 //MapController controller;  ==> it was depreciated.
 LocationManager locationManager;
 LocationListener listener;
 PendingIntent pendingIntent ;
 Criteria criteria;
 //MapOverlay overlay; ==> it was depreciated.
 SupportMapFragment fm; // add this

@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);
        Log.d("", "entered");

    //map = (MapView)findViewById(R.id.mapView); ==> delete it.

     fm = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.mapView);
     googleMap = fm.getMap();
    }

} 
```

以上修改后，**按“Ctrl + Shft +（字母）O”**，会导入一些需要的类。

**答案 2：**您的布局中的 xml 文件必须修改如下；

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".GPSonMap" > 
```

您的 MainActivity 不是 MapsActivity，而是 GPSonMap。

**答案 3**：您的 Manifest 文件与您的包名称与清单文件中描述的包名称不匹配。请将包名称与相同的名称匹配。

将“com.example.example”修改为你的包名。

复制粘贴一些代码后，您**必须**至少检查包名和类名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-10T20:54:04.310

我遇到了这个问题并且在浪费时间（超过 1.5 天的头发拉挫）。然后，我观看了一段 youtube 视频，该视频对将 Google Play 服务添加到应用程序的说明进行了无聊的演练。好吧，在从 sdk 管理器添加 SDK 后的视频中，他们使用了 Eclipse“检查更新”。那个小魔法就出来了，下载了一个 SDK 管理器不做的 jar 文件！他们确实需要将此添加到说明中，以免人们感到沮丧。我很想从我的应用程序中删除谷歌地图。我使用了 1.0，我需要更新到 2.0 或沟渠地图。

# asp.net-mvc - 终止导致网站不再执行

> ID：14886762
> 
> 赞同：0
> 
> 时间：2013-02-15T00:53:44.390
> 
> 标签：asp.net-mvc, iis-7, visual-studio-2012, signalr, terminate

我有一个运行良好的 asp.net mvc 应用程序，我正在调试通过 SignalRand 发送的消息，我决定停止调试并去编辑一些代码。但是，有一个关于 IIS 终止以及我是否想要这样做的错误，因为某些东西（我假设 - 应用程序）无法停止。（我真的很抱歉，但我当时没有阅读它）。所以现在我尝试重新启动我的程序，它就是无法打开。该网站正在尝试打开，但 chrome 中的加载圈一直在旋转。

我试图做的是： 1\. 重新启动 VS - 没有帮助 2\. 重新启动 PC - 没有帮助 3\. 创建一个新项目，将所有文件带到它并启动它并且它工作！

所以它工作了大约 10 分钟左右，然后又停止了（这次没有错误消息或任何东西）。我尝试在项目的设置中更改端口。没用。尝试改回并成功启动。一分钟左右... :(

所以最后，我试着在

```
public class MvcApplication : System.Web.HttpApplication
{
    protected void Application_Start()
 -> { 
```

断点被击中，成功通过下一行

```
RouteTable.Routes.MapHubs(); 
```

然后就消失在

```
AreaRegistration.RegisterAllAreas(); 
```

我试过很多次，它总是消失在同一个位置。更深入不是一种选择，因为这是系统方法。我怀疑这可能会出现问题，但我对asp.net的配置没有太多经验。

PS很多时候VS表现得很奇怪，即使我在上面标记的位置设置断点，它也会显示断点并显示一条消息，因为源代码与当前代码不同（但我没有改变在第一次崩溃之前发生的事情！我修改了几个符号的唯一地方是 MyHub.cs，这是 SignalR 集线器的扩展类）

最后，我尝试从 bin 文件夹中删除所有内容，以便完全重建它，但没有成功恢复我的应用程序。

可能是什么问题，也许有人至少有类似的东西？或者也许有人会在谷歌搜索时帮助我选择更好的关键字，因为“IIS 终止”和“AreaRegistration.RegisterAllAreas(); 不工作”并没有给我带来太多:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T04:53:18.610

这是一个已知的错误：[https](https://github.com/SignalR/SignalR/issues/1335) ://github.com/SignalR/SignalR/issues/1335 。

我们无法在我们的服务器上成功重现此问题。我们已经看到使用不同的 Web 服务器可以解决问题。如果您能够将复制项目发布到链接的问题，它很可能会立即得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T00:33:18.517

显然，我标记的解决方案并不是对我有帮助的确切方法。[这个链接](http://forums.asp.net/post/5291645.aspx)奇迹般地帮助了我，我终于能够重新开始工作。但是，由于 N. Taylor Mullen，我找到了获胜链接，所以他应该得到充分的信任 :) 但是让其他人知道是否有人提出这个问题 :)

# sql - 删除一列包含重复项的位置

> ID：14886770
> 
> 赞同：4
> 
> 时间：2013-02-15T00:55:04.777
> 
> 标签：sql, sql-server, tsql, sql-delete

考虑以下：

```
ProductID  Supplier
---------  --------
111        Microsoft
112        Microsoft
222        Apple Mac
222        Apple
223        Apple 
```

在此示例中，产品 222 被重复，因为供应商在所提供的数据中被称为两个名称。

我有成千上万种产品的此类数据。如何删除重复的产品或选择单个结果 - 例如使用 SELECT TOP 1 进行自我加入或类似的东西？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T00:57:58.243

```
DELETE  a
FROM    tableName a
        LEFT JOIN
        (
            SELECT  Supplier, MIN(ProductID) min_ID
            FROM    tableName
            GROUP   BY Supplier
        ) b ON  a.supplier = b.supplier AND
                a.ProductID = b.min_ID
WHERE   b.Supplier IS NULL 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/a14af/1)

或者如果你想删除`productID`比 onbe 产品更多的产品

```
WITH cte 
AS
(
    SELECT  ProductID, Supplier,
            ROW_NUMBER() OVER (PARTITION BY ProductID ORDER BY Supplier) rn
    FROM    tableName
)
DELETE FROM cte WHERE rn > 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/456b6/1)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T01:02:15.267

我认为您想要执行以下操作：

```
select t.*
from (select t.*,
             row_number() over (partition by product_id order by (select NULL)) as seqnum
      from t
     ) t
where seqnum = 1 
```

这将为每个产品选择任意行。

要删除除一个以外的所有行，您可以使用相同的想法：

```
with todelete (
      (select t.*,
               row_number() over (partition by product_id order by (select NULL)) as seqnum
        from t
      )
delete from to_delete where seqnum > 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T01:01:14.987

```
;WITH Products_CTE AS
    (
    SELECT ProductID, Supplier,
        ROW_NUMBER() OVER (PARTITION BY ProductID ORDER BY <some value>) as rn
    FROM PRODUCTS
    )

SELECT *
FROM Products_CTE
WHERE rn = 1 
```

这`some value`将是决定您保留哪个供应商版本的关键。如果您想要供应商的第一个实例，您可以使用 DateAdded 列（如果存在）。

# ruby-on-rails - 蒙古族。使用聚合框架功能时未定义的方法异常

> ID：14886777
> 
> 赞同：4
> 
> 时间：2013-02-15T00:55:38.147
> 
> 标签：ruby-on-rails, mongodb, mongoid, aggregation-framework

我有一个运行良好的 MongoDB shell 命令。命令是：

```
db.sessions.aggregate({$unwind: "$Sessions List"}, 
{$match: { "Sessions List.Parent Session":"My Session"}}, 
{$group:{_id:"$Sessions List.Parent Session", avg_val:{$avg:"$Sessions List.Length"}}}) 
```

结果是：“结果”：

```
[{
   "_id" : "My Session",
   "avg_val" : 8.846666666666666
}],
"ok" : 1 
```

但是当尝试通过 Mongoid 运行它（使用最新的可用 Mongoid、Origin、Moped）时，它会因 NoMethodError `(undefined method`__ bson_load__' for nil:NilClass)` 异常而失败。

Ruby代码如下：

```
Session.collection.aggregate({
'$unwind' => '$Sessions List',
'$match' => { 'Sessions List.Parent Session' => 'My Session'},
'$group' => {
'_id' => '$Sessions List.Parent Session',
'avg_val' => {
'$avg' => '$Sessions List.Length'
}}}); 
```

# javascript - jqPlot显示按钮

> ID：14886781
> 
> 赞同：0
> 
> 时间：2013-02-15T00:56:04.300
> 
> 标签：javascript, html, button, jqplot, save-image

我正在使用 jqPlot 创建和显示图表。

能否请我帮忙在与图表相同的页面上显示一个按钮，以便创建图表的图像，以便将图像保存到文件中。

这是我的代码：

```
<script class="code" type="text/javascript">
$(document).ready(function(){
var cosPoints = []; 
for (var i=0; i<2*Math.PI; i+=0.1){ 
 cosPoints.push([i, Math.cos(i)]); 
} 
  var plot1 = $.jqplot('chart1', [cosPoints], {  
  series:[{showMarker:false}],
  axes:{
    xaxis:{
      label:'Angle (radians)'
    },
    yaxis:{
      label:'Cosine'
    }
  }
});

var c = $(document.createElement("button"));
c.text("View Plot Image test");
c.addClass("jqplot-image-button");
c.bind("click", {
    chart: $(this)
}, function (h) {
    var j = h.data.chart.jqplotToImageElem();
    var i = $(this).nextAll("div.jqplot-image-container").first();
    i.children("div.jqplot-image-container-content").empty();
    i.children("div.jqplot-image-container-content").append(j);
    i.show(500);
    i = null
    });

var c = $("<button type='button'></button>")
.text('View Plot Image test')
.addClass('jqplot-image-button')
.insertAfter($('#chart1'));

}); 
```

显示图形和按钮。但是，如果我单击该按钮，则不会显示要保存的图形。我可以帮忙解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T11:10:10.957

您的问题是您实际上并没有将按钮添加到 DOM 中。试试这个：

```
var c = $("<button type='button'></button>")
    .text('View Plot Image test')
    .addClass('jqplot-image-button')
    .insertAfter($('#chart1')); 
```

这将做的是添加一个按钮作为`chart1`div 的兄弟元素，以便它出现在绘图下方。

**编辑：**

看看这个问题，实际上还有更多的问题。以下代码改编自[此处](http://www.jqplot.com/deploy/dist/examples/example.js)：

```
if (!$.jqplot.use_excanvas) {
    var outerDiv = $(document.createElement('div'));
    var header = $(document.createElement('div'));
    var div = $(document.createElement('div'));

    outerDiv.append(header);
    outerDiv.append(div);

    outerDiv.addClass('jqplot-image-container');
    header.addClass('jqplot-image-container-header');
    div.addClass('jqplot-image-container-content');

    header.html('Right Click to Save Image As...');

    var close = $(document.createElement('a'));
    close.addClass('jqplot-image-container-close');
    close.html('Close');
    close.attr('href', '#');
    close.click(function() {
        $(this).parents('div.jqplot-image-container').hide(500);
    })
    header.append(close);

    $('#chart1').after(outerDiv);
    outerDiv.hide();

    outerDiv = header = div = close = null;

    var btn = $(document.createElement('button'));
    btn.text('View Plot Image');
    btn.addClass('jqplot-image-button');
    btn.bind('click', {chart: $('#chart1')}, function(evt) {
        var imgelem = evt.data.chart.jqplotToImageElem();
        var div = $(this).nextAll('div.jqplot-image-container').first();
        div.children('div.jqplot-image-container-content').empty();
        div.children('div.jqplot-image-container-content').append(imgelem);
        div.show(500);
        div = null;
    });

    $('#chart1').after(btn);
    btn.after('<br />');
    btn = null;
} 
```

使用它，我能够显示按钮并让它生成可下载的图像。

另请注意，您当前的代码创建了两次按钮 - 只需用上面的代码替换该代码即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T12:20:26.557

试试这个。

添加此功能：

```
function addButton() {
    $('div.jqplot-target').each(function () {
        var outerDiv = $(document.createElement('div'));
        var header = $(document.createElement('div'));
        var div = $(document.createElement('div'));

        outerDiv.append(header);
        outerDiv.append(div);

        outerDiv.addClass('jqplot-image-container');
        header.addClass('jqplot-image-container-header');
        div.addClass('jqplot-image-container-content');

        header.html('<div class="header">Right Click to Save Image As...');

        var close = $(document.createElement('a'));
        close.addClass('jqplot-image-container-close');
        close.html('Close</div>');
        close.attr('href', '#');
        close.click(function () {
            $(this).parents('div.jqplot-image-container').hide(500);
        })
        header.append(close);

        $(this).after(outerDiv);
        outerDiv.hide();

        outerDiv = header = div = close = null;
        var btn = $(document.createElement('button'));
        btn.text('View Plot Image');
        btn.addClass('jqplot-image-button');
        btn.bind('click', { chart: $(this) }, function (evt) {
            var imgelem = evt.data.chart.jqplotToImageElem();
            var div = $(this).nextAll('div.jqplot-image-container').first();
            div.children('div.jqplot-image-container-content').empty();
            div.children('div.jqplot-image-container-content').append(imgelem);
            div.show(500);
            div = null;
        });

        $(this).after(btn);
        btn.after('<br />');
        btn = null;
    });
}; 
```

然后在“$(document).ready(...”脚本的末尾添加一个调用，该脚本绘制你的图表/图形，就在最后一个'});'之前

我从 jqPlot 下载中包含的 example.js 中获取代码，并将其设为函数。

它不太正确，标题可以使用一些 CSS 来美化它，但它可以工作。

**CSS 编辑。**

纠正“另存为..”图所需的 css 如下。

```
 .jqplot-image-button {
        margin-bottom: 15px;
        margin-top: 15px;
    }

   div.jqplot-image-container {
        position: relative;
        z-index: 11;
        margin: auto;
        display: none;
        background-color: #ffffff;
        border: 1px solid #999;
        display: inline-block;
        margin-top: 25px;
   }

   div.jqplot-image-container-header {
       font-size: 1.0em;
       font-weight: bold;
       padding: 5px 15px;
       background-color: #eee;
    }

    div.jqplot-image-container-content {
        padding: 15px;
        background-color: #ffffff;
    }

    a.jqplot-image-container-close {
        float: right;
    } 
```

# google-drive-api - 如何使用所有者 -> 图片 -> url 图片？

> ID：14886783
> 
> 赞同：1
> 
> 时间：2013-02-15T00:56:39.927
> 
> 标签：google-drive-api

我在所有者图片的驱动器列表的返回输出中看到了这些图像链接。如何使用这些图像？

具体来说：a) 完整路径是什么 b) 访问图像是否需要访问令牌和某个最小范围？

```
"owners": [
 {
  "kind": "drive#user",
  "displayName": "[DELETED]",
  "picture": {
   "url": "/c/u/[DELETED]/photos/private/AIbEiAIAAABDCK6F3MOr74uHQiILdmNhcmRfcGhvdG8qKDA1OTRiNmYyYmYzNWFmMTk1OTQyODllZDY0MWE5MTBkZDdiZTBjYTgwAdQeDClRWHKobzHkSZ7WSUDjSh3q"
  },
  "isAuthenticatedUser": false,
  "permissionId": "10165133368294800816"
 }
], 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T03:37:20.247

这些照片都是公开的个人资料照片，并尊重所有个人资料隐私选项，因此通常不需要授权。

完整的 url 是通过添加`https://google.com`. 我认为如果返回实际的 URL 会更好。希望谷歌能解决这个问题。

# c++ - getline 的文件指针移动

> ID：14886785
> 
> 赞同：0
> 
> 时间：2013-02-15T00:56:46.530
> 
> 标签：c++, getline

我有一个包含以下数据的输入文件

```
2
100
2
10 90
150
3
70 10 80 
```

现在，我可以读取到第 4 行（10 90），但是在读取第 5 行（150）时，文件指针似乎卡在第 4 行。我已经尝试过 infile.clear() 以防万一。如何确保文件指针正确移动或将其定位在下一行？感谢您的反馈。

-阿米特

```
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>

using namespace std;

int main(void) {

int cases;
int total_credit=0;
int list_size=0;
string list_price;

//Read file "filename".

ifstream infile;
infile.open("A-large-practice.in",ifstream::in);
if(!infile.is_open()) {
    cout << "\n The file cannot be opened" << endl;
    return 1;
}

else {
    cout<<"Reading from the file"<<endl;
    infile >> cases;       
    cout << "Total Cases = " << cases << endl;
    int j=0;

    while (infile.good() && j < cases) {

        total_credit=0;
        list_size=0;

        infile >> total_credit;
        infile >> list_size;

        cout << "Total Credit = " << total_credit << endl;
        cout << "List Size = " << list_size << endl;
        //cout << "Sum of total_credit and list_size" << sum_test << endl; 

        int array[list_size];
        int i =0;
        while(i < list_size) {
            istringstream stream1;  
            string s;
            getline(infile,s,' ');
            stream1.str(s);
            stream1 >> array[i];
            //cout << "Here's what in file = " << s <<endl;
            //array[i]=s;
            i++;
        }

        cout << "List Price = " << array[0] << " Next = " << array[1] << endl;          
        int sum = array[0] + array[1];
        cout << "Sum Total = " << sum << endl;
        cout <<"Testing" << endl;   
        j++;    
    }       
}   
return 0;   

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:05:25.640

问题是您使用`' '`(space) 作为 getline 的“行终止符”。因此，当您将第 4 行的数字读入 string`s`时，第一个将是`"10"`，第二个将是`"90\n150\n3\n70"`——也就是说，直到下一个空格。这几乎肯定不是您想要的，并且会导致您对文件中的位置感到困惑。你读到的下一个数字将是 10，让你以为你在第 4 行，而实际上你在第 7 行。

**编辑**

解决这个问题的最简单方法可能是根本不使用`getline`，直接从输入中读取整数：

```
while (i < list_size)
    infile >> array[i++]; 
```

这完全忽略了换行符，因此输入也可能全部在一行上或在多行之间随机拆分，但是由于您有一个初始数字来告诉您要读取多少个数字，这很好。

# fortran - 未定义长度的 Fortran 字符输入

> ID：14886787
> 
> 赞同：0
> 
> 时间：2013-02-15T00:56:55.960
> 
> 标签：fortran, fortran95

```
program Test

implicit none
character (LEN=100) :: input
character (LEN=100) :: output
print *,"Please input your message: "
read *, input 
```

对于每一个字符，我都用凯瑟密码加密它

*计算*

```
print *,"This is the output: "
write (*,"(2a)") "Message = ", out

end program Test 
```

这并不完全有效。

对于输入中的每个字符，我使用 modulo(iachar()) 函数对其进行转换。它一直工作到打印，我跟着调试，加密很好。但是输出的问题在于 LEN=100。do 循环将经历 100 次将不存在的字符转换为垃圾的过程，从而在输出处使用 UNDEFINED TYPE 破坏程序。

因此，如果我输入“test”，它将加密 CBNC*GARBAGE-TO-100* 而不会输出。如果我将长度定义为 4，并执行它，它就可以工作。但我希望能够在不定义长度的情况下做到这一点。有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:09:52.603

read 语句应该`input`用空格填充到变量的全长（100 个字符），而不是添加“垃圾”。LEN_TRIM 内在函数将给出变量值的显着长度——即不包括尾随空格的长度。当您打印输出字符串时，您可能需要记住输入字符串的这一重要长度。

（注意列表定向输入的规则（由 read 语句中的 * 表示）可能有点令人惊讶 - “(A)”的格式可能更健壮，具体取决于您想要的行为。）

就在读取输入的上下文中避免固定长度的字符串而言 - Fortran 2003 引入了延迟长度字符，这在这里有很大帮助。否则，请参阅[读取长度未知的字符串以](https://stackoverflow.com/q/14765382/1234550)了解 Fortran 95 的可能性。一个复杂的问题是您正在从控制台读取，因此退格语句可能不起作用。解决此问题的方法与链接方法类似，但需要在确定输入记录长度的同时将输入字符串分段构建为可分配的字符数组。然后使用序列关联将该数组转换为正确长度的标量。评论或再次询问您是否需要更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-04T00:17:28.327

以下代码读取未指定长度的用户输入字符串。请注意，它需要一个支持延迟长度字符串的编译器：`character(len = :)`. Fortran 2003 中引入了延迟长度字符串。

```
program test

  use iso_fortran_env, only : IOSTAT_EOR
  implicit none

  integer :: io_number
  character(len = 1) :: buffer
  character(len = :), allocatable :: input, output

  input = ""
  print *, "Please input your message."

  do
    read(unit = *, fmt = '(a)', advance = "no", iostat = io_number) buffer
    select case (io_number)
    case(0)                       
      input = input // buffer     
    case(IOSTAT_EOR)
      exit
    end select
  end do

  allocate(character(len=(len(input))) :: output)

  ! Now use "input" and "output" with the ciphering subroutine/function.

end program test 
```

## 解释

这个想法是在寻找记录结束（eor）条件的同时一次读取一个字符。eor 条件是由用户按下“return”键引起的。“iostat”选项可用于查找 eor。“iostat”返回的值等于位于模块“iso_fortran_env”中的整数常量“IOSTAT_EOR”：

```
use iso_fortran_env, only : IOSTAT_EOR 
```

我们声明一个延迟长度的字符串来获取未知长度的用户输入：

```
character(len = :), allocatable :: input 
```

在“read”语句中，“advance = 'no'”允许一次读入几个字符。“缓冲区”的大小决定了要读取的字符数（在我们的例子中为 1）。

```
read(unit = *, fmt = '(a)', advance = "no", iostat = io_number) buffer 
```

如果“iostat”返回“0”，则没有错误，也没有 eor。在这种情况下，应将“缓冲区”字符添加到“输入”字符串中。最终，这一步分配了一个“新”输入，其大小等于“旧”输入 + 缓冲区字符的大小。新分配的输入包含来自旧输入的字符 + 缓冲区字符。

```
select case (io_number)
case(0)                       
  input = input // buffer 
```

如果“iostat”返回一个 eor 值，则退出 do 循环。

```
case(IOSTAT_EOR)
  exit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:49:30.943

标准的 Fortran 字符串是固定长度的，右侧用空格填充。如果您的输入字符串永远不会有尾随空格，则解决方案很简单：使用 Fortran 内部函数`len_trim`查找字符串的非空格长度并仅处理这些字符。另一种方法是使用一个新功能，可分配字符串......这提供了可变长度的字符串。如果字符串末尾不允许有空格是可以接受的，您可能会发现使用`len_trim`起来更容易。

# c# - 将 JObject 转换为字典 . 是否可以？

> ID：14886800
> 
> 赞同：98
> 
> 时间：2013-02-15T00:58:15.343
> 
> 标签：c#, .net, json, json.net

我有一个 Web API 方法，可以将任意 json 有效负载接受到`JObject`属性中。因此，我不知道会发生什么，但我仍然需要将其转换为 .NET 类型。我想要一个`Dictionary<string,object>`，这样我就可以以任何我想要的方式处理它。

我进行了很多搜索，但找不到任何东西，最终开始了一种混乱的方法来进行这种转换，一个键一个键，一个值一个值。有没有简单的方法来做到这一点？

输入->

```
JObject person = new JObject(
    new JProperty("Name", "John Smith"),
    new JProperty("BirthDate", new DateTime(1983, 3, 20)),
    new JProperty("Hobbies", new JArray("Play football", "Programming")),
    new JProperty("Extra", new JObject(
        new JProperty("Foo", 1),
        new JProperty("Bar", new JArray(1, 2, 3))
    )
) 
```

谢谢！

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2013-02-15T01:12:02.730

如果您有`JObject`对象，以下可能会起作用：

```
JObject person;
var values = person.ToObject<Dictionary<string, object>>(); 
```

如果您没有，您可以使用扩展方法`JObject`创建一个：`Newtonsoft.Json.Linq`

```
using Newtonsoft.Json.Linq;

var values = JObject.FromObject(person).ToObject<Dictionary<string, object>>(); 
```

否则，[此答案](https://stackoverflow.com/a/1212115/146622)可能会为您指明正确的方向，因为它将 JSON 字符串反序列化为字典。

```
var values = JsonConvert.DeserializeObject<Dictionary<string, object>>(json); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-02-15T21:22:09.413

我最终混合使用了这两个答案，因为没有一个真正能做到这一点。

ToObject() 可以做 JSON 对象的第一级属性，但嵌套对象不会转换为 Dictionary()。

也无需手动执行所有操作，因为 ToObject() 对于一级属性非常好。

这是代码：

```
public static class JObjectExtensions
{
    public static IDictionary<string, object> ToDictionary(this JObject @object)
    {
        var result = @object.ToObject<Dictionary<string, object>>();

        var JObjectKeys = (from r in result
                           let key = r.Key
                           let value = r.Value
                           where value.GetType() == typeof(JObject)
                           select key).ToList();

        var JArrayKeys = (from r in result
                          let key = r.Key
                          let value = r.Value
                          where value.GetType() == typeof(JArray)
                          select key).ToList();

        JArrayKeys.ForEach(key => result[key] = ((JArray)result[key]).Values().Select(x => ((JValue)x).Value).ToArray());
        JObjectKeys.ForEach(key => result[key] = ToDictionary(result[key] as JObject));

        return result;
    }
} 
```

它可能存在无法工作的边缘情况，并且性能不是它的最强质量。

多谢你们！

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-09-22T20:03:30.047

这是初始版本：我已经修改了代码以**递归 JArrays*嵌套在*JArrays/JObjects**中的 JObjects ，正如@Nawaz 指出的那样，接受的答案没有。

```
using System.Collections.Generic;
using System.Linq;
using Newtonsoft.Json.Linq;

public static class JsonConversionExtensions
{
    public static IDictionary<string, object> ToDictionary(this JObject json)
    {
        var propertyValuePairs = json.ToObject<Dictionary<string, object>>();
        ProcessJObjectProperties(propertyValuePairs);
        ProcessJArrayProperties(propertyValuePairs);
        return propertyValuePairs;
    }

    private static void ProcessJObjectProperties(IDictionary<string, object> propertyValuePairs)
    {
        var objectPropertyNames = (from property in propertyValuePairs
            let propertyName = property.Key
            let value = property.Value
            where value is JObject
            select propertyName).ToList();

        objectPropertyNames.ForEach(propertyName => propertyValuePairs[propertyName] = ToDictionary((JObject) propertyValuePairs[propertyName]));
    }

    private static void ProcessJArrayProperties(IDictionary<string, object> propertyValuePairs)
    {
        var arrayPropertyNames = (from property in propertyValuePairs
            let propertyName = property.Key
            let value = property.Value
            where value is JArray
            select propertyName).ToList();

        arrayPropertyNames.ForEach(propertyName => propertyValuePairs[propertyName] = ToArray((JArray) propertyValuePairs[propertyName]));
    }

    public static object[] ToArray(this JArray array)
    {
        return array.ToObject<object[]>().Select(ProcessArrayEntry).ToArray();
    }

    private static object ProcessArrayEntry(object value)
    {
        if (value is JObject)
        {
            return ToDictionary((JObject) value);
        }
        if (value is JArray)
        {
            return ToArray((JArray) value);
        }
        return value;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-07-19T06:18:16.673

这是一个更简单的版本：

```
 public static object ToCollections(object o)
    {
        var jo = o as JObject;
        if (jo != null) return jo.ToObject<IDictionary<string, object>>().ToDictionary(k => k.Key, v => ToCollections(v.Value));
        var ja = o as JArray;
        if (ja != null) return ja.ToObject<List<object>>().Select(ToCollections).ToList();
        return o;
    } 
```

如果使用 C# 7，我们可以使用模式匹配，它看起来像这样：

```
 public static object ToCollections(object o)
    {
        if (o is JObject jo) return jo.ToObject<IDictionary<string, object>>().ToDictionary(k => k.Key, v => ToCollections(v.Value));
        if (o is JArray ja) return ja.ToObject<List<object>>().Select(ToCollections).ToList();
        return o;
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-15T05:53:40.027

听起来像是扩展方法的一个很好的用例——我有一些东西很容易转换为 Json.NET（感谢 NuGet！）：

当然，这很快就被破解了——你想清理它，等等。

```
public static class JTokenExt
{
    public static Dictionary<string, object> 
         Bagify(this JToken obj, string name = null)
    {
        name = name ?? "obj";
        if(obj is JObject)
        {
            var asBag =
                from prop in (obj as JObject).Properties()
                let propName = prop.Name
                let propValue = prop.Value is JValue 
                    ? new Dictionary<string,object>()
                        {
                            {prop.Name, prop.Value}
                        } 
                    :  prop.Value.Bagify(prop.Name)
                select new KeyValuePair<string, object>(propName, propValue);
            return asBag.ToDictionary(kvp => kvp.Key, kvp => kvp.Value);
        }
        if(obj is JArray)
        {
            var vals = (obj as JArray).Values();
            var alldicts = vals
                .SelectMany(val => val.Bagify(name))
                .Select(x => x.Value)
                .ToArray();
            return new Dictionary<string,object>()
            { 
                {name, (object)alldicts}
            };
        }
        if(obj is JValue)
        {
            return new Dictionary<string,object>()
            { 
                {name, (obj as JValue)}
            };
        }
        return new Dictionary<string,object>()
        { 
            {name, null}
        };
    }
} 
```

# java - Android - 试图先创建一个“保存文件？”对话框

> ID：14886813
> 
> 赞同：0
> 
> 时间：2013-02-15T00:59:19.827
> 
> 标签：java, android, dialog

我的应用程序包含一个文本文件列表。单击文件会将其加载到 EditText 中。我创建了一个选项菜单来保存打开的文件，或者像处理新文件一样保存。我想要做的是显示“先保存？” 如果用户尝试打开新文件而不先保存打开的文件，则确认对话框。

正如您在下面的代码中看到的那样，我创建了一个名为 changed 的​​布尔变量，最初初始化为 false。我正在尝试使用 TextChangedListener 将更改更改为 true，然后使用列表文件打开代码中的 if/else 语句处理它。我遇到的问题是，一旦我打开一个文件，然后尝试打开另一个文件，它会显示“首先保存”对话框，但无论文件是否更改或单击确定或取消它都不会打开任何其他文件。

```
public class MainActivity extends ListActivity {

private List<String> items = null;
public File currentDir = null;
public File currentFile = null;
public EditTextLineNumbers et; // My EditText
public boolean changed = false;

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);

        checkExternalStorage();
        File dir = new File(Environment.getExternalStorageDirectory() + "/My Webs");
        currentDir = dir;
        et = (EditTextLineNumbers) findViewById(R.id.ide);
        et.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                changed = true;
            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
                changed=false;

            }

            @Override
            public void afterTextChanged(Editable s) {
                // TODO Auto-generated method stub

            }
        });
        if(dir.isDirectory()) {
            getFiles(new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/My Webs").listFiles());
        }else{
            dir.mkdir();
        }
    }

    @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            MenuInflater inflater = getMenuInflater();
            inflater.inflate(R.menu.menu, menu);
            return true;
        }

    @Override
        public boolean onOptionsItemSelected(MenuItem item) {
            if(item.getItemId()== R.id.newsite){
                Log.d("New Site","New Site was clicked");
            }else if(item.getItemId()== R.id.newfile){
                Log.d("New File","New File was clicked");
            }else if(item.getItemId()== R.id.savefile){
                String temptxt = et.getText().toString();

                if(currentFile!=null){
                    Log.d(currentFile.getAbsolutePath(),currentFile.getAbsolutePath());
                    String tempfname = currentFile.toString();
                    saveFile(tempfname, temptxt);
                }else{
                    saveFile(null, temptxt);
                }

            }
            return super.onOptionsItemSelected(item);
        }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id){
        int selectedRow = (int)id;
        if(selectedRow == 0){
            getFiles(new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/My Webs").listFiles());
        }else{
            File file = new File(items.get(selectedRow));
            if(file.isDirectory()){
                currentDir = file;
                getFiles(file.listFiles());
            }else{
                currentFile = file;
            if(changed==false){
                try {
                    et.setText(new Scanner(file).useDelimiter("\\Z").next());
                    } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                    }   
                }else{
                    AlertDialog.Builder alert = new AlertDialog.Builder(this);

                    alert.setTitle("Save first");
                    alert.setMessage("(Will be saved in the current working directory)");

                    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                      String tmpText = et.getText().toString();

                      try {
                        File tempfile = new File(currentDir, currentFile.toString());
                        FileWriter writer = new FileWriter(tempfile);
                          writer.write(tmpText);
                          writer.flush();
                          writer.close();

                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                      }
                    });

                    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                      public void onClick(DialogInterface dialog, int whichButton) {
                        // Canceled.
                      }
                    });

                    alert.show();

                }
            }
            }
        }

    private void saveFile(String sFileName, String sBody){

        if (currentFile!=null) {
            try {
                File saveDir = new File("/");

                File tempfile = new File(saveDir, sFileName);
                FileWriter writer = new FileWriter(tempfile);
                writer.append(sBody);
                writer.flush();
                writer.close();

                Toast.makeText(this, "Saved", Toast.LENGTH_SHORT).show();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }else{
            saveAs();
        }

    }

    private void saveAs(){
        AlertDialog.Builder alert = new AlertDialog.Builder(this);

        alert.setTitle("Save as");
        alert.setMessage("(Will be saved in the current working directory)");

        // Set an EditText view to get user input 
        final EditText input = new EditText(this);
        alert.setView(input);

        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int whichButton) {
          String value = input.getText().toString();
          String tmpText = et.getText().toString();

          try {
            File tempfile = new File(currentDir, value);
            FileWriter writer = new FileWriter(tempfile);
              writer.write(tmpText);
              writer.flush();
              writer.close();

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
          }
        });

        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int whichButton) {
            // Canceled.
          }
        });

        alert.show();
    }
        private void getFiles(File[] files){
            items = new ArrayList<String>();
            items.add(getString(R.string.goto_root));
            for(File file : files){
                String filename = file.getName().toString();
                String filenameArray[] = filename.split("\\.");
                String extension = filenameArray[filenameArray.length-1];
                Log.d("Extension", extension);
                items.add(file.getPath());
            }
            ArrayAdapter<String> fileList = new ArrayAdapter<String>(this,R.layout.row_item, items);
            setListAdapter(fileList);
        } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:12:45.930

如果文本更改，您的变量`change`将始终是`true`，因为该事件`beforeTextChanged`将首先被调用，然后`onTextChanged`将被触发。

> **beforeTextChanged(CharSequence s, int start, int count, int after)** 调用该方法是为了通知您，在 s 内，从 start 开始的 count 个字符将被替换为长度为 after 的新文本。
> 
> **onTextChanged(CharSequence s, int start, int before, int count)** 调用此方法是为了通知您，在 s 内，从 start 开始的 count 个字符刚刚替换了之前有长度的旧文本。

保存文件后，您应该将变量**重置**`change`为 false

```
if(!changed){
    // open the file
 }else{
    changed = false;
    // show the alert and save the file
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T20:39:31.810

在这里`et.setText(new Scanner(file).useDelimiter("\\Z").next());`更改文本。此时，changed 变为`true`。

`false`在 EditText 中加载测试后，您需要将其设置回。

# solr - SOLR 可以执行 UPSERT 吗？

> ID：14886814
> 
> 赞同：4
> 
> 时间：2013-02-15T00:59:57.697
> 
> 标签：solr, indexing, upsert

我一直在尝试在 solr 中做相当于 UPSERT（如果已经存在则插入或更新）的操作。我只知道什么不起作用，并且我阅读的 solr/lucene 文档没有帮助。这是我尝试过的：

```
curl 'localhost:8983/solr/update?commit=true' -H 'Content-type:application/json' -d '[{"id":"1","name":{"set":"steve"}}]'
{"responseHeader":{"status":409,"QTime":2},"error":{"msg":"Document not found for update.  id=1","code":409}} 
```

我在一个请求中最多进行 50 次更新，并且请求可能包含具有专有字段（例如 title_en 和 title_es）的相同 ID。如果有一种方法可以查询是否存在 id 列表，我可以拆分数据并执行单独的插入和更新命令……这将是一个可接受的替代方案，但是否已经有一个处理程序可以做到这一点？在这一点上，我想避免做任何内部例程。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T04:07:38.840

使用 Solr 4.0，您可以[对所有这些文档进行部分更新，](http://solr.pl/en/2012/07/09/solr-4-0-partial-documents-update/)仅使用已更改的字段将保持完整文档相同。id 应该匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:12:03.400

Solr 不支持开箱即用的 UPSERT 机制。您可以创建记录，也可以更新记录，但语法不同。

如果您更新记录，您必须确保所有*其他*预先插入的字段都已存储（不仅仅是索引）。在幕后，更新会创建一个全新的记录，该记录只是预先填充了以前存储的值。但是如果功能非常深入（可能在 Lucene 本身中）。

你看过[DataImportHandler](https://wiki.apache.org/solr/DataImportHandler)吗？您反转控制流（从 Solr 开始），但它确实支持检查哪些记录需要更新以及哪些记录需要创建。

或者您可以只运行一个 solr 查询，例如**[http://solr.example.com:8983/solr/select?q=id%3A(ID1+ID2+ID3)&fl=id&wt=csv](http://solr.example.com:8983/solr/select?q=id%3A(ID1+ID2+ID3)&fl=id&wt=csv)**您要求 Solr 查找您的ID 记录并仅返回它找到的记录的 ID。然后，您可以对其进行后期处理以分割您的更新和插入。

# mongoid - 使用 RABL 和 Mongoid/Moped 进行多个数据库查询

> ID：14886817
> 
> 赞同：0
> 
> 时间：2013-02-15T01:00:07.563
> 
> 标签：mongoid, rabl, moped

我有一个使用 rabl 和 mongoid 3.1.0 的简单应用程序，执行以下操作：

```
# index
@products = current_shop.products 
```

rabl 代码如下所示：

```
# index.json.rabl
collection @products
extends 'api/products/show'

# show.json.rabl
object @product
attributes :id 
```

当我点击它时，日志显示与@products 相关的 4 个请求：

```
MOPED: 127.0.0.1:27017 QUERY        database=bamboo_development collection=products selector={"$query"=>{"shop_id"=>"511c7866fd896b1908000002"}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=-1 skip=0 batch_size=nil fields=nil (0.5682ms)
MOPED: 127.0.0.1:27017 QUERY        database=bamboo_development collection=products selector={"$query"=>{"shop_id"=>"511c7866fd896b1908000002"}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=-1 skip=0 batch_size=nil fields=nil (1.1139ms)
MOPED: 127.0.0.1:27017 QUERY        database=bamboo_development collection=products selector={"$query"=>{"shop_id"=>"511c7866fd896b1908000002"}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=0 skip=0 batch_size=nil fields=nil (0.4492ms)
MOPED: 127.0.0.1:27017 QUERY        database=bamboo_development collection=products selector={"$query"=>{"shop_id"=>"511c7866fd896b1908000002"}, "$orderby"=>{:_id=>1}} flags=[:slave_ok] limit=0 skip=0 batch_size=nil fields=nil (0.4332ms) 
```

当我这样做时：

```
@products = current_shop.products.search(params[:query])
render text: @products.map(&:name).join(",") 
```

我只收到一个与@products 相关的请求：

```
MOPED: 127.0.0.1:27017 QUERY        database=bamboo_development collection=products selector={"shop_id"=>"511c7866fd896b1908000002"} flags=[:slave_ok] limit=0 skip=0 batch_size=nil fields=nil (0.4611ms) 
```

重复的查询看起来很奇怪，有人知道为什么会这样吗？它不调用子对象，只是与我所看到的有所不同的集合查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T10:12:33.767

很多人遇到同样的问题。很可能是因为 rabl 配置问题。按照上面 Aymeric 的建议，只需执行以下操作：@products = current_shop.products.to_a

# ios6 - 增加 TableView 部分之间的差距？

> ID：14886819
> 
> 赞同：0
> 
> 时间：2013-02-15T01:00:09.883
> 
> 标签：ios6, uitableview, height

是否可以增加 TableView 部分之间的差距？

我有两个分组的部分，我想在两个部分之间添加一个段控制器。我在我想要的区域有段控制器，但我需要第二部分从更远的地方开始，可以这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:33:35.327

要么在表格中放置一个额外的部分来保存该段，要么将一个部分标题视图添加到该段下方的部分。只需为标题提供一个空视图。实现该`heightForSectionHeader...`方法，以便根据需要显示高度。

# c++ - C++ - 从函数返回向量

> ID：14886821
> 
> 赞同：2
> 
> 时间：2013-02-15T01:00:22.353
> 
> 标签：c++, pointers, vector

来自 Java 背景，我试图理解 C++ 中的指针/引用。我正在尝试从函数返回一个向量。写作：

```
vector<char*> f(){
    vector<char*> vec;
    return vec;
} 
```

会返回向量的**副本**，对吗？更好的方法是返回指向向量的指针，如下所示：

```
vector<char*>* f(){
    vector<char*>* vec = new vector<char*>;
    return vec;
} 
```

我是正确的，还是完全错误的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:17:09.937

在 C++03 中，按值返回最有可能导致 RVO（返回值优化），这将省略不必要的副本。在 C++11 中，移动语义将负责复制。

那么，为什么首先按值返回？因为它可以防止具有动态生命周期的不必要的对象。您的示例代码也不尊重您的函数用户可能想要使用的任何分配策略。

一般来说，即使在 C++11 中，返回一个容器仍然是一个坏主意：它将用户限制在该特定容器中，因为不可能跨容器移动，只能复制。标准库用`OutputIteratorS`. 您的算法很可能会写成：

```
template<typename OutputIterator>
OutputIterator f(OutputIterator o); 
```

这样你就可以从容器中抽象出来，也可以规避最初的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:04:15.360

你错了，你不想在 C++ 中这样做。几乎每个 C++ 编译器都有所谓的命名返回值优化，这将（有效地）`vec`通过为堆栈上的返回值分配空间来移动而不是复制，然后基本上“就地”构造。这消除了开销。

维基[百科](http://en.wikipedia.org/wiki/Return_value_optimization)关于此的文章给出了合理的概述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:04:24.940

> 我是正确的，还是完全错误的？

这是完全错误的，至少在存在**移动语义**的 C++11 中，只要您不需要创建返回值的*别名*（这似乎不是您的情况，即使是这样，也会可能需要使用智能指针而不是原始指针）。

现在可以按值返回向量了。大多数时候，即使在 C++98 中，编译器也会忽略对复制构造函数的调用（以及 C++11 中的移动构造函数）。这称为[（命名的）返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)。

在 C++11 中，标准库的所有容器都支持移动构造函数，因此即使没有省略复制或移动，按值返回容器也不昂贵。

# sql - 可以在 oracle 中使用这个“INSERT INTO”语句吗？

> ID：14886826
> 
> 赞同：0
> 
> 时间：2013-02-15T01:00:47.563
> 
> 标签：sql, oracle

```
INSERT INTO PHOENIX_AUDITTRAIL SET
audit_module = 'Location Master',
audit_message = 'Delete location',
datecreated = NOW(),
author = '".$_SESSION['username']."',
status = '".ADT_NOTICE."'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:08:00.407

不，标准的表达方式是：

```
INSERT INTO PHOENIX_AUDITTRAIL(audit_module, audit_message, datecreated, author, status)
    select 'Location Master', 'Delete location', NOW(), '".$_SESSION['username']."', '".ADT_NOTICE."'
    from dual 
```

但是，在 Oracle 中，我认为您会使用`sysdate`而不是`now()`：

```
INSERT INTO PHOENIX_AUDITTRAIL(audit_module, audit_message, datecreated, author, status)
    select 'Location Master', 'Delete location', sysdate, '".$_SESSION['username']."', '".ADT_NOTICE."'
    from dual 
```

除了日期变量和 之外`from dual`，这是标准 SQL 语法。

# actionscript-3 - mxmlc（flex 编译器）忽略 xml 配置中的“定义”

> ID：14886834
> 
> 赞同：1
> 
> 时间：2013-02-15T01:01:56.623
> 
> 标签：actionscript-3, conditional-compilation, mxmlc

来自 Adob​​e 的[文档](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7abd.html)：

> 要在 flex-config.xml 文件中而不是在命令行中设置这些常量的值，请按以下示例所示编写：

```
<compiler> 
    <define append="true"> 
        <name>CONFIG::debugging</name> 
        <value>true</value> 
    </define> 
    <define append="true"> 
        <name>CONFIG::release</name> 
        <value>false</value> 
    </define> 
</compiler> 
```

问题是编译器实际上并没有考虑到它们并给我编译错误，例如“错误：未定义属性调试的访问”。因为我的 ActionScript 代码中有它。

如果我通过参数（“-define+=CONFIG::debugging,true”）定义它们，一切正常。

我想也许我的配置根本没有被使用，所以我把它弄错了——mxmlc 指出了这一点。所以配置实际上被加载到编译器中。

有什么提示吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T07:21:40.080

我使用相同的方法通过加载自定义配置来传递 DEFINE 参数并且一切正常。我在您提供的配置部分中没有看到错误。

这是[我](https://www.dropbox.com/s/ba4qcw3y2ntd59v/config-local.xml?dl=0)的 config 和 mxmlc 参数的变体：

```
-load-config 工具/config-local.xml -dump-config=local-dumped-config.xml。 

```

还要检查转储配置以确保包含定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T10:33:53.280

所以这是 XML 问题——因为我在配置中实际上有字符串，而不是布尔值——你不应该忘记编写正确的 XML（奇怪的是编译器没有回复我任何东西）。

```
<value>&quot;MyStringValue&quot;</value> 
```

或者更简单：

```
<value>'MyStringValue'</value> 
```

双引号 ('"MyStringValue"') 是在您使用参数时。

# actionscript-3 - AS3 帧率变化问题

> ID：14886839
> 
> 赞同：0
> 
> 时间：2013-02-15T01:02:24.797
> 
> 标签：actionscript-3

我有一个切换布尔值的 KeyboardEvent，如果为 true，则 FR var 将 -2/帧降至 10 的底部，如果为 false，则将 +2/帧升至 60 的顶部。它上下工作正常，但每当我添加“ stage.frameRate = FR；" 到 ENTER_FRAME 函数并播放它，它会冻结对窗口的控制。动画仍在播放，但我无法将其关闭，除非通过 Ctrl-Alt-Del。

1.为什么会这样？

2.是否可以每帧更改frameRate？

3.如果是，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:53:12.550

嗯，我不确定即时播放帧速率是否是一件好事。你想做什么？也许有更好的方法...

这是一个完全的猜测，但也许当您将帧速率设置为阶段时，它会在后台初始化“某些东西”。然后，由于您在每一帧都发生了它，它会尝试在每一帧上进行初始化，导致它被锁定。

* * *

更新答案以包含使用 Timer 对象的示例：

```
import flash.utils.Timer;
import flash.events.TimerEvent;

// the timer takes in milliseconds, so for 30 frames/second, you would have a frame tick at every 1000 / 30, or 33.333ms
var tickSpeed:int = 1000 / 30;
var frameTick:Timer = new Timer(tickSpeed, 0);

function enterFrameListener(inputEvent:Timer):void {
    // this method will run on every timer tick
}
frameTick.addEventListener(TimerEvent.TIMER, enterFrameListener);

// can change the tick speed of the timer like so (setting it to 1000 means 1 frame tick every second)
frameTick.delay = 1000;

// according to the api doc however, a tickspeed of less then 20ms is not recommended
// 20ms would be equal to 60 fps 
```

通过将其卸载到计时器，您不需要弄乱整体帧速率，其他对象的另一个优点可以同时受到不同计时器的影响。Timer 类本身也有一些有用的方法：http: [//help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Timer.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/Timer.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T06:32:56.737

我认为您的应用程序正在冻结，因为您试图在每一帧上设置帧速率，我建议您应该在您的`ENTER_FRAME`部分中检查您的帧速率。如果您的帧速率从您想要的帧速率上升/下降，那么您应该将帧速率设置为 FR。

试试这个可以帮助你。

# perl - 重新打开 STDERR/STDOUT 以写入带有时间戳的组合日志文件

> ID：14886842
> 
> 赞同：1
> 
> 时间：2013-02-15T01:02:44.343
> 
> 标签：perl

我基本上想重新打开 STDERR/STDOUT，以便他们写入一个日志文件，其中每行都包含流和时间戳。所以`print STDERR "Hello World"`打印`STDERR: 20130215123456: Hello World`。我不想将所有打印语句重写为函数调用，而且一些输出将通过`system()`调用来自外部进程，无论如何我将无法重写。

我还需要将输出放置在“live”文件中，即不仅在进程完成时写入。

*（ps我不是特别询问如何生成时间戳的详细信息，只是如何重定向到文件并添加字符串）*

我已经制定了以下代码，但它很混乱：

```
my $mode = ">>";
my $file = "outerr.txt";
open(STDOUT, "|-", qq(perl -e 'open(FILE, "$mode", "$file"); while (<>) { print FILE "STDOUT: \$\_"; }'));
open(STDERR, "|-", qq(perl -e 'open(FILE, "$mode", "$file"); while (<>) { print FILE "STDERR: \$\_"; }')); 
```

*（上面没有添加日期，但这应该是微不足道的）*

我正在寻找一种更简洁的解决方案，一种不需要引用 perl 代码并在命令行上传递它的解决方案，或者至少是隐藏一些复杂性的模块。查看[Capture::Tiny](http://search.cpan.org/~dagolden/Capture-Tiny-0.21/lib/Capture/Tiny.pm)的代码，它看起来不能处理输出的一部分，尽管我不确定。`annotate-output`遗憾的是，只能在外部命令上工作，我需要它来处理外部命令和普通的 perl 打印。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T02:30:15.030

via 启动的子进程`system`不会写入，`STDOUT`因为它无权访问程序中的变量。因此，意味着让代码在 Perl 文件句柄写入（例如`tie`）上运行是行不通的。

编写另一个脚本来运行您的脚本，并将 STDOUT 和 STDERR 替换为管道。从这些管道中读取并打印出修改后的输出。我建议使用 IPC::Run 来执行此操作，因为它会让您免于使用`select`. 如果您将 STDOUT 和 STDERR 组合在一个流中，则可以不使用它。

# javascript - 自动下载启动

> ID：14886843
> 
> 赞同：0
> 
> 时间：2013-02-15T01:03:15.510
> 
> 标签：javascript, download

有没有其他方法可以启动自动下载。目前我们是这样做的。

```
If download does not start click here: 
            <a href="http://www.example.com/file.zip">Filename (121 MB)</a> 
```

在页面的稍后部分，我们有这段代码。

```
<script type="text/javascript">
    window.onload=function(){
          setTimeout(function(){
                window.location.href='http://www.example.com/file.zip';},2000);
          };
</script> 
```

问题是它有时会启动同一个文件以多次下载给最终用户。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:08:48.687

一种选择是`IFrame`隐藏页面，`src`指向要下载的 zip 文件。

```
<div style="display:none;">
    <iframe id="frmDld" src="http://www.example.com/file.zip"></iframe>
</div> 
```

另一种选择是在发回页面时将文件写入响应流（不知道您在服务器端使用什么。如果是 asp.net/mvc 那么我可以提供帮助。）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:09:32.263

如果

```
<a href="http://www.example.com/file.zip">Filename (121 MB)</a> 
```

工作那么这也应该工作：

```
<?php
echo "<META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL= http://www.example.com/file.zip \">";
?> 
```

# ios - 如何反转 UISlider 的最小值-最大值？

> ID：14886844
> 
> 赞同：7
> 
> 时间：2013-02-15T01:03:32.383
> 
> 标签：ios, uislider

有没有反转 UISlider 值的好方法？默认值是左侧的最小值和右侧的最大值。我希望它以相反的方式工作。

将其旋转 180 度似乎有点傻。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T01:07:35.760

只需从最大值中减去从滑块中获得的值，即可反转值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-04T09:54:27.640

然后我需要和你完全相同的东西……所以再将它旋转 90 度，使其处于倒置位置。滑块是对称的，所以它在两个位置看起来完全一样。但是最小值和最大值现在相反。

命令是...

```
mySlider.transform = CGAffineTransformRotate(mySlider.transform, 180.0/180*M_PI); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-19T00:28:39.377

子类 NSSlider/UISlider。因此覆盖这两种方法 -

```
//Assumes minValue not necessarily 0.0

-(double)doubleValue
{

    double minVal = [self minValue];
    double maxVal = [self maxValue];

    double curValue = [super doubleValue];
    double reverseVal = maxVal - curValue + minVal;
    return reverseVal;
}

-(void)setDoubleValue:(double)aDouble
{

    double minVal = [self minValue];
    double maxVal = [self maxValue];

    double reverseVal = maxVal - aDouble + minVal;

    [super setDoubleValue:reverseVal];
} 
```

这将反转允许右/上显示为最小值和左/下显示为最大值的值

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-05-31T17:14:35.597

接受的答案不正确，因为它假定滑块的最小值为 0。

就我而言，我的最小值是 1.1，最大值是 8.0

您需要从 Min+Max 值中减去滑块的值以反转该值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-03T11:18:49.740

您可以使用以下公式：

```
let sliderValue = yourSlider.minimumValue + yourSlider.maximumValue - yourSlider.value 
```

会颠倒你的价值观。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-17T16:53:54.590

试试这条美丽的线 -

```
yourSlider.semanticContentAttribute = .forceRightToLeft 
```

这会更改最小-最大轨道颜色+反转值+您不会像转换答案中那样丢失帧。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-20T13:06:07.007

只需从最大值中减去滑块当前值。

```
label.text = [NSString stringWithFormat:@" %.f%% ", 100 - self.slider.value]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-12T02:04:55.580

您可以使用 transform (Swift 5.0) 简单地水平翻转滑块：

```
slider.transform = CGAffineTransform(scaleX: -1, y: 1); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-17T04:49:34.647

这个怎么样：

```
slider.maximumValue = -minimumValue;
slider.minimumValue = -maximumValue;

-(void) sliderChanged:(UISlider *) slider {

      float value =  -slider.value;

      // do something with value

} 
```

然后只需使用 -slider.value。

# c# - 在 UI 线程上对多个异步操作进行分组

> ID：14886845
> 
> 赞同：1
> 
> 时间：2013-02-15T01:03:53.000
> 
> 标签：c#, .net, wpf, task-parallel-library, c#-5.0

我有这个：

```
BusyState.SetBusy("Updating Calendar Data");

Dispatcher.CurrentDispatcher.Invoke(new Action(async () =>
{
    // calling "update" will hit servers outside my control and may take time
    await PublicCalendars.Update();
    await PrivateCalendars.Update();

    // clearing the busy state should only happen when both update tasks are finished
    BusyState.ClearBusy();
})); 
```

变量 PublicCalendars 和 PrivateCalendars 都在扩展 ObservableCollection 并在调用更新期间填充。集合绑定到某些 WPF GUI，因此必须从 UI 线程添加项目。

我想删除等待并让两个调用同时运行。当两个任务都完成时，我怎样才能做到这一点并且仍然清楚我的忙碌状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:46:46.533

s的优势`Task`在于它们可以很容易地组合。所以，如果你想得到一个`Task`代表两个`Task`s都完成的a，你可以使用一个方法来做到这一点[`Task.WhenAll()`](http://msdn.microsoft.com/en-us/library/hh160374.aspx)：

```
await Task.WhenAny(PublicCalendars.Update(), PrivateCalendars.Update());

BusyState.ClearBusy(); 
```

`Task`您也可以通过保存返回的 s*然后* `await`ing自己获得非常相似的行为：

```
var publicTask = PublicCalendars.Update();
var privateTask = PrivateCalendars.Update();

await publicTask;
await privateTask;

BusyState.ClearBusy(); 
```

# mysql - 从表中选择值，因为不满足两个条件

> ID：14886846
> 
> 赞同：0
> 
> 时间：2013-02-15T01:03:58.633
> 
> 标签：mysql, pdo

我的数据库上有三个表：

**ts_room**

领域：

```
id (PK)
capacity    
img 
notes   
building_id 
roomstructure_id    
lecturestyle_id 
```

**ts_request**

字段

```
id (PK)
day_id
period_id
roompref_id (FK > ts_roompref.id) 
```

**ts_roompref**

```
id (PK)      
request_id (FK > ts_request.id)      
room_id (FK > ts_room.id) 
```

我想编写一个 MySQL PDO 查询，从**ts_room**中选择行，前提是在运行**ts_roompref**上的行（检查 ts_roompref.room_id 与 ts_room.id）并找到匹配项之后 - 我们将在**ts_request**中查找值并查看是否**day_id**和**period_id**都匹配 1。它将返回总计数。

我希望上面的解释是有道理的。

本质上 - 房间请求是通过这个系统发出的，**ts_roompref**存储每个请求的房间偏好。我试图找出是否在某一**天和某一****时段**（在**ts_request**表中由**day_id**和**period_id**表示）预订了特定房间，在本例中为星期一（1）和时段（1）。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:09:17.103

这个怎么样？

```
SELECT  COUNT(*) totalCOUnt
FROM    ts_room a
        INNER JOIN ts_roompref b
            ON a.id = b.room_ID
        INNER JOIN ts_request c
            ON b.request_ID = c.roompref_ID
WHERE   c.day_ID = 1 AND c.period_ID = 1 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)**

# java - 使用 JFrame 和 KeyAdapter 的键盘输入

> ID：14886848
> 
> 赞同：0
> 
> 时间：2013-02-15T01:04:12.863
> 
> 标签：java, keyboard

大家好，我正在使用 netbeans 7.2.1，并且正在关注键盘输入教程

此代码应在 JFrame 中绘制一个圆圈，它会这样做，但随后应使用箭头键输入来移动它，但它不会

谢谢您的帮助 ：）

```
package gamefirstclass;

import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import javax.swing.JFrame;

public class GameFirstClass extends JFrame {
//Variables

    int y, x;
//Double Buffer
    private Image dbImage;
    private Graphics dbg;

//Window Basics
    public GameFirstClass() {
        addKeyListener(new AL());
        setTitle("Add window title");
        setSize(800, 700);
        setResizable(false);
        setVisible(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        x = 150;
        y = 150;

    }
// main

    public static void main(String[] args) {
        new GameFirstClass();
    }
    //Controls
    public class AL extends KeyAdapter {

        @Override
        public void keyPressed(KeyEvent event) {
            int keyCode = event.getKeyCode();
            if (keyCode == event.VK_LEFT)
            {
                x--;
            }
            if (keyCode == event.VK_RIGHT)
            {
                x++;
            }
            if (keyCode == event.VK_UP)
            {
                y--;
            }
            if (keyCode == event.VK_DOWN)
            {
                y++;
            }
        }

        @Override
        public void keyReleased(KeyEvent event) {
        }
    }
//Double Buffer

    @Override
    public void paint(Graphics g) {
        dbImage = createImage(getWidth(), getHeight());
        dbg = dbImage.getGraphics();
        paintComponent(dbg);
        g.drawImage(dbImage, 0, 0, this);
    }

    public void paintComponent(Graphics g) {
        g.fillOval(x, y, 15, 15);
        repaint();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T02:33:25.580

好的，所以有一个问题：您的`if statements!`.
基本上，在您的 中，由于在他们之后`keyListener`，所以`if statements`不要执行`semicolon`。
块是剩下的，修改`x`是相同的。只需删除它们`semicolons`，我相信它会起作用。
另外，不要调用`repaint()`from ，因为你每次都会`paintComponent()`产生很多。`repaints`我不知道这是否重要，但你应该打电话`setFocusable(true)`给你`JFrame`以确保`KeyListener`工作正常。

祝你好运！

# jsp - 如何使用tiles和struts2更改我的代码以正确实现url重写

> ID：14886855
> 
> 赞同：1
> 
> 时间：2013-02-15T01:04:56.937
> 
> 标签：jsp, url-rewriting, struts2

我正在使用以下代码重写我的 URL。每次我点击个人资料链接时，它都会起作用，但会在地址末尾添加额外的个人资料/视图。

```
http://www.example.com/myProject/Profile/view.action 
```

我第一次点击查看它改变它

```
 http://www.example.com/myProject/Profile/Profile/view.action 
```

之后，如果我再次单击该视图，它将是（每次我单击它都会在地址中添加一个 /Profile）

```
 http://localhost:8080/myProject/Profile/Profile/Profile/view.action 
```

关联

```
 <a href="<s:url action="Profile/view"/>" >Profile</a> 
```

struts.xml

```
 <package name="default" extends="struts-default">
    <result-types>
        <result-type name="tiles" class="org.apache.struts2.views.tiles.TilesResult"/>
    </result-types>

      <action name="index">
        <result type="tiles">content</result>
    </action>

 </package>

  <package name="Profile" extends="default" namespace="/Profile">
  <action name = "*" method="{1}" class="com.myproject.Profile">
    <result name="View" type="tiles">Profile</result>
            <result name="Edit" type="tiles">Edit</result>
</action>
    </package> 
```

**问题是每次我点击查看它都不会删除地址并将配置文件/视图添加到它的末尾。它只是将地址从 www.example.com/myproject/profile/view 更改为 www.example.com/myproject/profile/profile/view**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:09:09.770

没有包声明很难说，但看起来您在操作中获得了一个额外的命名空间，因为您在`<s:url>`标记中将其指定为操作的一部分，而不是使用`namespace`属性。

如果当前操作是 Profile 命名空间的一部分，则不会添加它。如果不是，它会的。使用`namespace`属性会自动处理它，因此您不必考虑它。

* * *

编辑以反映完全不相关的问题。

您正在扩展`struts-default`包，它不知道`tiles`结果类型。你需要扩展*你的*默认值，它*确实*包括`tiles`结果类型，或者`tiles-default`（或者它叫什么，我不记得了）。

# gwt - 是否可以在非元素应用程序中使用 GWT Elemental 集合？

> ID：14886856
> 
> 赞同：1
> 
> 时间：2013-02-15T01:05:08.557
> 
> 标签：gwt, gwt-elemental

是否可以在非元素 GWT 应用程序中使用元素集合（elemental.util.Collections、elemental.util.ArrayOfInt、elemental.util.MapFromStringTo 等）。我已经在使用这些模块：

```
<!-- Inherit the core Web Toolkit stuff.                        -->
<inherits name='com.google.gwt.user.User' />

<!-- Inherit the RequestBuilder stuff.                        -->
<inherits name="com.google.gwt.http.HTTP" />

<!--  Inherit GQuery -->
<inherits name='com.google.gwt.query.Query' /> 
```

但我想开始使用轻量级元素集合而不是 Java ArrayList 和 HashMap。那可能吗？为此目的，从 Elemental 移植到它自己的模块会相当容易吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T02:55:17.680

当然，您所要做的就是在模块描述符 ( `*.gwt.xml`) 中包含以下声明：

```
<inherits name="elemental.Elemental"/> 
```

请参阅GWT 主干上的[基本示例。](http://code.google.com/p/google-web-toolkit/source/browse/trunk/elemental/examples/simple/src/elemental/?r=11039#elemental%2Fexample)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T11:32:59.500

我无法在 FireFox 中获得 GWT Elemental 项目 silvercomet 或简单执行。

然而，下面的简单元素测试代码与 gwt 用户和 http 模块一起在 FireFox 和 Chrome 中执行。

模块文件。

```
<module rename-to="HelloElemental">
    <inherits name="elemental.Elemental" />
    <!-- Inherit the core Web Toolkit stuff. -->
    <inherits name='com.google.gwt.user.User' />
    <!-- Inherit the RequestBuilder stuff. -->
    <inherits name="com.google.gwt.http.HTTP" />
    <add-linker name="xsiframe" />
    <set-configuration-property name="devModeRedirectEnabled" value="true" />
    <entry-point class="com.google.silvercomet.client.Main" />
</module> 
```

入口点类 -

```
import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.user.client.Window;

import elemental.util.ArrayOf;
import elemental.util.Collections;

public class Main implements EntryPoint
{
    public void onModuleLoad()
    {
        ArrayOf<String> items = Collections.arrayOf();
        items.insert( 0, "First" );
        Window.alert( items.get( 0 ) );
    }
} 
```

# unit-testing - 如何在 ServiceStack 中编写单元/集成测试

> ID：14886857
> 
> 赞同：10
> 
> 时间：2013-02-15T01:05:14.770
> 
> 标签：unit-testing, servicestack

我对 ServiceStack 很陌生。到目前为止，我很幸运能够启动并运行基本 API（Northwind 示例对我特别有帮助）。但是，我在尝试构建单元和集成测试时遇到了困难。

我从另一个 ServiceStack 用户那里找到了一个最近的要点，他说明了一些（可能不正确的）单元和集成测试示例，但我无法让它们正常工作。

这是我一直在使用的参考： [https ://github.com/ServiceStack/ServiceStack/issues/435](https://github.com/ServiceStack/ServiceStack/issues/435)

这是我对基本单元测试的尝试，主要使用从其他用户的要点借来的代码： [https ://gist.github.com/anonymous/4957788](https://gist.github.com/anonymous/4957788)

当我尝试在 HelloWorldTest 中运行测试用例时，会引发 System.NotImplementedException，指出“无法解析服务‘HelloWorldName’”。

这让我很困惑，因为我向它传递了一个请求 DTO，而不是一个服务，这似乎与我正在调用的 ExecuteService() 方法一致。但异常表明 ServiceStack 将我的 DTO 视为服务。

有人可以给我发送一个关于如何正确为 ServiceStack 编写单元和集成测试的典型示例吗？我应该提一下，总的来说，我对 .NET 开发也是新手，所以也许我的无知正在发光。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T19:58:11.477

查看[测试文档](http://docs.servicestack.net/testing)和[前面的问题](https://stackoverflow.com/q/14790695/85785)和答案，了解[有关如何创建单元和集成测试的简单示例](https://stackoverflow.com/questions/14790695/unit-test-httprequest-headers-with-servicestack/14791657#14791657)。

此外，[ServiceStack.WebHost.Endpoints.Tests](https://github.com/ServiceStack/ServiceStack/tree/master/tests/ServiceStack.WebHost.Endpoints.Tests)中的大多数测试都是独立的集成测试，仅使用自托管的 HttpListener AppHost。一些例子：

*   [缓冲请求测试](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.WebHost.Endpoints.Tests/BufferedRequestTests.cs)
*   [验证测试](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.WebHost.Endpoints.Tests/AuthTests.cs)

# vba - 打开 MS Access 子表单以编辑特定记录

> ID：14886866
> 
> 赞同：1
> 
> 时间：2013-02-15T01:06:30.820
> 
> 标签：vba, ms-access

我在数据表视图中有一个带有子表单“ActivitiesSubform”的访问表单“DailyItemsTracked”。当我双击“ActivitiesSubform”中的记录时，它应该打开一个名为“ActivityEntry”的表单来编辑记录。

当我双击时，我有我想要编辑的记录的正确 ID。但是，新表单始终打开以添加新记录，而不是编辑现有记录。（所有现有记录都被过滤掉）。我在谷歌上搜索了一个多小时，但没有解决方案。

弹出表单上的 id 字段名称和 id 控制源都是“id”。

这是我尝试打开表单的方式：

```
MsgBox (Me![id]) 'It is getting the correct id for the selected record

DoCmd.OpenForm "ActivityEntry", , , "ID=" & Me.id

DoCmd.OpenForm "ActivityEntry", , , "[id]=" & Me![id]

DoCmd.OpenForm "ActivityEntry", , , "[id]=" & Form_ActivitiesSubform.id

Dim stDocName As String
Dim stLinkCriteria As String
stDocName = "ActivityEntry"
stLinkCriteria = "[id]=" & Me![id]

Dim stDocName As String
Dim stLinkCriteria As String
stDocName = "ActivityEntry"
stLinkCriteria = "ActivityEntryEdit.[id]= " & Me![id] 
```

即使我明确地拼出 id ，它仍然会打开新记录：

```
Dim stDocName As String
Dim stLinkCriteria As String
stDocName = "ActivityEntry"
stLinkCriteria = "ActivityEntry.[id]= " & 69 
```

打开后也不能选择记录

```
Dim stDocName As String
Dim stLinkCriteria As String
stDocName = "ActivityEntry"
stLinkCriteria = "ActivityEntryEdit.[id]= " & Me![id]
DoCmd.OpenForm stDocName, , , stLinkCriteria
Forms(stDocName).Recordset.FindFirst "id = " & Me!id 
```

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T04:00:03.283

您需要了解`DoCmd.OpenForm`语句的语法。你可以在[这里](http://msdn.microsoft.com/en-us/library/office/ff820845.aspx)阅读。简短的回答，您需要将`DataMode`参数设置为`acFormEdit`.

# javascript - 如何使用 jQPlot 在 yaxis = 0 处绘制一条线？

> ID：14886870
> 
> 赞同：1
> 
> 时间：2013-02-15T01:07:04.793
> 
> 标签：javascript, charts, jqplot

我正在使用 jQPlot 并禁用图表上的网格线（drawGridlines：false）。但是，我想在 yaxis = 0 处有一条线，并且我还想确保 0 也出现。这很容易实现吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T10:37:45.987

您可以在 canvasOverlay 中添加一个对象：

```
var options={ //jqplot options
   canvasOverlay: {
     show: true,
     objects: [
       {
         horizontalLine: {
           name: "y=0",
           y: 0,
           yaxis: "yaxis",
           lineWidth: 1,
           color: "rgb(0,0,0)",
           shadow: false
         }
       }
     ]
   }
} 
```

不要忘记包含`jqplot.canvasOverlay.min.js`插件。

# maven - 自定义 Maven 插件开发归档文件

> ID：14886872
> 
> 赞同：0
> 
> 时间：2013-02-15T01:07:16.653
> 
> 标签：maven, maven-plugin, maven-plugin-development

我正在开发自己的自定义 Maven 插件，我想存档文件。我遵循了这个例子： http: [//www.sonatype.com/books/mvnref-book/reference/writing-plugins-sect-mojo-params.html](http://www.sonatype.com/books/mvnref-book/reference/writing-plugins-sect-mojo-params.html)并且可以用 zip 格式归档元素。但是我也想使用其他格式（用户会指出它）。如何设置存档类型？

ZipArchiver 是这样工作的：

```
/**
* The Zip archiver.
* @parameter \
expression="${component.org.codehaus.plexus.archiver.Archiver#zip}"
*/
private ZipArchiver zipArchiver;
...
zipArchiver.addDirectory( buildDirectory, includes, excludes );
zipArchiver.setDestFile( new File( baseDirectory, "output.zip" ) );
zipArchiver.createArchive(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T10:44:38.207

您需要向插件添加格式属性并根据您的格式使用相关的存档器：

```
Archiver archiver = null;
if("zip".equals(format)){
    archiver = new ZipArchiver(...);
}
else if("tar".equals(format)){
    archiver = new TarArchiver(...);
}
else (...){
    ...
} 
```

# python - “不可排序的类型：int() < str()”

> ID：14886881
> 
> 赞同：17
> 
> 时间：2013-02-15T01:08:18.643
> 
> 标签：python, calculator

我现在正在尝试在 Python 上制作退休计算器。语法没有问题，但是当我运行以下程序时：

```
def main():
    print("Let me Retire Financial Calculator")
    deposit = input("Please input annual deposit in dollars: $")
    rate = input ("Please input annual rate in percentage: %")
    time = input("How many years until retirement?")
    x = 0
    value = 0
    while (x < time):
        x = x + 1
        value = (value * rate) + deposit
        print("The value of your account after" +str(time) + "years will be $" + str(value)) 
```

它告诉我：

```
Traceback (most recent call last):
  File "/Users/myname/Documents/Let Me Retire.py", line 8, in <module>
    while (x < time):
TypeError: unorderable types: int() < str() 
```

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-15T01:09:28.823

这里的问题是`input()`在 Python 3.x 中返回一个字符串，所以当你进行比较时，你是在比较一个字符串和一个定义不明确的整数（如果字符串是一个单词，如何比较一个字符串和数字？） - 在这种情况下，Python 不会猜测，它会引发错误。

要解决此问题，只需调用[`int()`](http://docs.python.org/3.3/library/functions.html#int)将您的字符串转换为整数：

```
int(input(...)) 
```

请注意，如果您想处理十进制数字，您将需要使用[`float()`](http://docs.python.org/3.3/library/functions.html#float)or之一[`decimal.Decimal()`](http://docs.python.org/3/library/decimal.html#decimal-objects)（取决于您的准确性和速度需求）。

请注意，循环一系列数字（与`while`循环和计数相反）的更 Pythonic 方式是使用`range()`. 例如：

```
def main():
    print("Let me Retire Financial Calculator")
    deposit = float(input("Please input annual deposit in dollars: $"))
    rate = int(input ("Please input annual rate in percentage: %")) / 100
    time = int(input("How many years until retirement?"))
    value = 0
    for x in range(1, time+1):
        value = (value * rate) + deposit
        print("The value of your account after" + str(x) + "years will be $" + str(value)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-26T21:29:02.643

顺便说一句，在 Python 2.0 中，您可以将任何东西与任何东西（int 到 string）进行比较。由于这不是明确的，因此在 3.0 中进行了更改，这是一件好事，因为您不会遇到相互比较无意义的值或忘记转换类型的麻烦。

# android - 在我自己的应用程序中使用 ContentResolver 从 ContentProvider 获取数据

> ID：14886896
> 
> 赞同：0
> 
> 时间：2013-02-15T01:09:36.053
> 
> 标签：android, android-contentprovider

我有一个应用程序`ContentProvider`：

```
 <provider android:name="ExampleProvider" 
              android:readPermission="example.contentprovider.READ"
              android:label="Example Content Provider"
              android:authorities="example.contentprovider.provider"
    /> 
```

另一个应用程序请求访问提供程序的权限：

```
<uses-permission android:name="example.contentprovider.READ" /> 
```

但是当我运行第二个应用程序时，我得到了

```
E/AndroidRuntime(  818): java.lang.RuntimeException: Unable to start activity
ComponentInfo{example.contentresolver/example.contentresolver.ContentResolverActivity}:
java.lang.SecurityException: Permission Denial: reading example.contentprovider.ExampleProvider
uri content://example.contentprovider.provider/words from pid=818, uid=10045
requires example.contentprovider.READ, or grantUriPermission() 
```

为什么我会收到此错误？

[在此处查看完整的 SSCCE。](https://github.com/codeguru42/android-examples/tree/master/ContentProviderExample)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:16:31.903

您应该首先在创建 ContentProvider 的应用程序中定义权限，然后使用它。

```
<permission android:name="example.contentprovider.READ"
    android:permissionGroup="..."
    android:label="@string/perm_read"
    android:description="@string/perm_read_summary"
    android:protectionLevel="dangerous" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-04T10:23:46.400

确保 android:exported = true;

# javascript - BB 代码列表 Javascript

> ID：14886899
> 
> 赞同：1
> 
> 时间：2013-02-15T01:10:03.983
> 
> 标签：javascript, jquery, bbcode

我目前正在实施一个易于编辑的 BB 代码脚本，它是用 Jquery / Javascript 编写的。唯一的问题是它不像我想的那么容易，所以我需要一些帮助。

该脚本工作正常（将内容添加到 textarea 中）。但是，我正在尝试使演示文稿更好一些。

如果有人能告诉我如何取消列出项目或至少隐藏对接点（可能使用 css 执行此操作），我将不胜感激，否则我可以编辑 javascript/jquery。

此外，当我滚动一个选项（对于粗体按钮）时，它会显示按钮的代码（作为标题）我想删除它，但我看不到代码上我要编辑它的位置。

![list/bb 选项截图](../Images/43ff80709e429e0082403f7c1f1a4b40.png)

**这是我的javascript代码：**

```
 // ----------------------------------------------------------------------------
// markItUp!
// ----------------------------------------------------------------------------
// Copyright (C) 2008 Jay Salvat
// http://markitup.jaysalvat.com/
// ----------------------------------------------------------------------------
myBbcodeSettings = {
  nameSpace:          "bbcode", // Useful to prevent multi-instances CSS conflict
  previewParserPath:  "~/sets/bbcode/preview.php",
  markupSet: [
      {name:"<img src='_img/bold_icon.gif'>", key:'B', openWith:'[b]', closeWith:'[/b]'}, 
      {name:'Italic', key:'I', openWith:'[i]', closeWith:'[/i]'}, 
      {name:'Underline', key:'U', openWith:'[u]', closeWith:'[/u]'}, 
      {separator:'---------------' },
      {name:'Picture', key:'P', replaceWith:'[img][![Url]!][/img]'}, 
      {name:'Link', key:'L', openWith:'[url=[![Url]!]]', closeWith:'[/url]', placeHolder:'Your text to link here...'},
      {separator:'---------------' },
      {name:'Colors', openWith:'[color=[![Color]!]]', closeWith:'[/color]', dropMenu: [
          {name:'Yellow', openWith:'[color=yellow]', closeWith:'[/color]', className:"col1-1" },
          {name:'Orange', openWith:'[color=orange]', closeWith:'[/color]', className:"col1-2" },
          {name:'Red', openWith:'[color=red]', closeWith:'[/color]', className:"col1-3" },
          {name:'Blue', openWith:'[color=blue]', closeWith:'[/color]', className:"col2-1" },
          {name:'Purple', openWith:'[color=purple]', closeWith:'[/color]', className:"col2-2" },
          {name:'Green', openWith:'[color=green]', closeWith:'[/color]', className:"col2-3" },
          {name:'White', openWith:'[color=white]', closeWith:'[/color]', className:"col3-1" },
          {name:'Gray', openWith:'[color=gray]', closeWith:'[/color]', className:"col3-2" },
          {name:'Black', openWith:'[color=black]', closeWith:'[/color]', className:"col3-3" }
      ]},
      {name:'Size', key:'S', openWith:'[size=[![Text size]!]]', closeWith:'[/size]', dropMenu :[
          {name:'Big', openWith:'[size=200]', closeWith:'[/size]' },
          {name:'Normal', openWith:'[size=100]', closeWith:'[/size]' },
          {name:'Small', openWith:'[size=50]', closeWith:'[/size]' }
      ]},
      {separator:'---------------' },
      {name:'Bulleted list', openWith:'[list]\n', closeWith:'\n[/list]'}, 
      {name:'Numeric list', openWith:'[list=[![Starting number]!]]\n', closeWith:'\n[/list]'}, 
      {name:'List item', openWith:'[*] '}, 
      {separator:'---------------' },
      {name:'Quotes', openWith:'[quote]', closeWith:'[/quote]'}, 
      {name:'Code', openWith:'[code]', closeWith:'[/code]'}, 
      {separator:'---------------' },
      {name:'Clean', className:"clean", replaceWith:function(h) { return h.selection.replace(/\[(.*?)\]/g, "") } },
      {name:'Preview', className:"preview", call:'preview' }
   ]
} 
```

谢谢你能给我的任何帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:29:48.553

使用 PHP 解析和一个简单的脚本来添加文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-28T08:34:48.643

也许您可以尝试使用 composer packagist BB 代码。见：[https ://packagist.org/?q=bbcode&idx=packagist&p=0](https://packagist.org/?q=bbcode&idx=packagist&p=0)

# ruby-on-rails-3 - Rails 使用 Carrierwave 上传，雾到 S3 - HTTP 与 HTTPS

> ID：14886901
> 
> 赞同：2
> 
> 时间：2013-02-15T01:10:15.133
> 
> 标签：ruby-on-rails-3, amazon-s3, carrierwave, fog

我一直在关注 Ryan Bates 关于将文件上传到 S3 的出色 Rails Cast（第 383 集）。一切正常 - 但是......

我想使用图像的 HTTP URL 而不是 HTTPS。

尝试查看 Carrierwave 文档，但找不到这是否是一个选项。试图查看这是否是 S3 设置，但默认情况下它似乎支持 HTTP 和 HTTPS。

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-24T16:42:52.093

您可以通过设置`asset_host`配置参数来做到这一点：

```
CarrierWave.configure do |config|
  ...
  config.fog_directory  = 'yourbucket'

  # Forcing use of HTTP
  config.asset_host = "http://#{config.fog_directory}.s3.amazonaws.com"
  ...
end 
```

如果您的存储桶位于美国标准以外的区域，您可能还需要将该部分添加到主机中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-29T09:39:55.217

CarrierWave 0.9.0[添加了一个配置参数`fog_use_ssl_for_aws`](https://github.com/carrierwaveuploader/carrierwave/commit/4f46d2a9751821afba43c9c0eb603e795fa53580)来禁用 public_url 的 SSL。

```
CarrierWave.configure do |config|
  ...
  config.fog_use_ssl_for_aws = false
  ...
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T06:33:47.967

不确定这是否是您要查找的内容，但如果您希望允许用户从您的 S3 存储桶下载文件，则需要为每个人创建列出和下载文件的权限。

这可以在“权限”选项卡下的 S3 存储桶配置面板中完成。默认情况下，S3 文件将是私有的，因此您需要经过身份验证的 url 才能访问它们。

# php - 灯箱上的表格

> ID：14886904
> 
> 赞同：0
> 
> 时间：2013-02-15T01:10:42.940
> 
> 标签：php, css, forms, modal-dialog

我做了一个简单的自制灯箱。灯箱包含允许用户提交数据的表单。我在我的 SIMPLE 灯箱上放置了一个 SIMPLE 表单，我注意到当我提交表单时，灯箱会自动关闭。为什么要这样做，我怎样才能防止这种情况发生？我想在灯箱上提交表单并保持灯箱不受影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:47:24.997

如果您使用 php 提交表单，这是不可能的，它将提交到另一个页面，因此如果您想留在页面上，它将刷新，您将不得不考虑使用 AJAX 提交表单并获取服务器响应

有一些很好的技术可以做到这一点，比如 jquery AJAX

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# html - 为什么节/div 内的 HTML标记会在节/div 之外产生重复项？

> ID：14886906
> 
> 赞同：1
> 
> 时间：2013-02-15T01:01:47.177
> 
> 标签：html, anchor, markup

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T01:13:06.327

# git - Git，如何在版本 X 之后查找文件上的所有提交

> ID：14886908
> 
> 赞同：0
> 
> 时间：2013-02-15T01:11:36.943
> 
> 标签：git, commit

我可以在 v4.0 之后的给定文件中找到提交列表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:15:28.197

`git log v4.0.. -- file`假设`v4.0`是一个标签。

# javascript - 在 Google Maps API v3 上添加多个自定义控件按钮

> ID：14886917
> 
> 赞同：1
> 
> 时间：2013-02-15T01:12:38.707
> 
> 标签：javascript, api, google-maps, button, controls

我在同一页面上有 2 个 Google 地图，我希望将相同的按钮添加到已经有一个的地图上。这个按钮是关闭谷歌地图启动的覆盖，基本上是一个退出按钮。

按钮在第一张地图上工作正常，但我无法让第二张地图工作 D:! 我知道我必须更改变量，因为我必须这样做才能在一页上获得 2 个地图。此外，如果其他人在 Google Maps API v3 中表现出色，你能告诉我为什么我需要`function HomeControl(controlDiv, map) {`在行中使用“map”变量吗？这是我的代码：

```
function HomeControl(controlDiv, map) {

      // Set CSS styles for the DIV containing the control
      // Setting padding to 5 px will offset the control
      // from the edge of the map.
      controlDiv.style.padding = '5px';

      // Set CSS for the control border.
      var controlUI = document.createElement('div');
      controlUI.style.backgroundColor = 'white';
      controlUI.style.borderStyle = 'solid';
      controlUI.style.borderWidth = '2px';
      controlUI.style.cursor = 'pointer';
      controlUI.style.textAlign = 'center';
      controlUI.title = 'Click to set the map to Home';
      controlDiv.appendChild(controlUI);

      // Set CSS for the control interior.
      var controlText = document.createElement('div');
      controlText.style.fontFamily = 'Arial,sans-serif';
      controlText.style.fontSize = '12px';
      controlText.style.paddingLeft = '4px';
      controlText.style.paddingRight = '4px';
      controlText.innerHTML = '<strong>Home</strong>';
      controlUI.appendChild(controlText);

      // Setup the click event listeners: simply set the map to Chicago.
      google.maps.event.addDomListener(controlUI, 'click', function() {
        document.getElementById('light').style.display='none';
        document.getElementById('fade').style.display='none';
      });
    }

        function detectBrowser() {
        var useragent = navigator.userAgent;
        var mapdivMap = document.getElementById("light");

        if (useragent.indexOf('iPhone') != -1 || useragent.indexOf('Android') != -1 ) {
            mapdivMap.style.width = '100%';
            mapdivMap.style.height = '100%';
            initialize();
        } else {
            mapdivMap.style.width = '600px';
            mapdivMap.style.height = '100%';
            initialize();
            }
        };

        function initialize() {
            var mapOptions = {
            zoom: 8,
            center: new google.maps.LatLng(43.464258,-80.52041),
            mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById('light'),
                mapOptions);

            var marker = new google.maps.Marker({
                position: map.getCenter(),
                map: map,
                title: 'Waterloo'
            });

      // Create the DIV to hold the control and call the HomeControl() constructor
      // passing in this DIV.
      var homeControlDiv = document.createElement('div');
      var homeControl = new HomeControl(homeControlDiv, map);

      homeControlDiv.index = 1;
      map.controls[google.maps.ControlPosition.TOP_RIGHT].push(homeControlDiv);

        }

        //*******************************************************
        //************ Conestoga Map Page JavaScript ************ 
        //*******************************************************

        function Map2(Map2Div, map2) {

      // Set CSS styles for the DIV containing the control
      // Setting padding to 5 px will offset the control
      // from the edge of the map.
      Map2Div.style.padding = '5px';

      // Set CSS for the control border.
      var Map2UI = document.createElement('div');
      Map2UI.style.backgroundColor = 'white';
      Map2UI.style.borderStyle = 'solid';
      Map2UI.style.borderWidth = '2px';
      Map2lUI.style.cursor = 'pointer';
      Map2UI.style.textAlign = 'center';
      Map2UI.title = 'Click to set the map to Home';
      Map2Div.appendChild(Map2UI);

      // Set CSS for the control interior.
      var Map2Text = document.createElement('div');
      Map2Text.style.fontFamily = 'Arial,sans-serif';
      Map2Text.style.fontSize = '12px';
      Map2Text.style.paddingLeft = '4px';
      Map2Text.style.paddingRight = '4px';
      Map2Text.innerHTML = '<strong>Home</strong>';
      Map2UI.appendChild(Map2Text);

      // Setup the click event listeners: simply set the map to Chicago.
      google.maps.event.addDomListener(MapUI2, 'click', function() {
        document.getElementById('light').style.display='none';
        document.getElementById('fade').style.display='none';
      });
    }

        function detectBrowser2() {
        var useragent2 = navigator.userAgent;
        var mapdivMap2 = document.getElementById("light");

        if (useragent2.indexOf('iPhone') != -1 || useragent2.indexOf('Android') != -1 ) {
            mapdivMap2.style.width = '100%';
            mapdivMap2.style.height = '100%';
            initialize2();
        } else {
            mapdivMap2.style.width = '600px';
            mapdivMap2.style.height = '100%';
            initialize2();
            }
        };

        function initialize2() {
            var mapOptions2 = {
            zoom: 8,
            center: new google.maps.LatLng(43.464258,-80.52041),
            mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map2 = new google.maps.Map(document.getElementById('light'),
                mapOptions2);

            var marker2 = new google.maps.Marker({
                position: map.getCenter(),
                map: map2,
                title: 'Waterloo'
            });

      // Create the DIV to hold the control and call the HomeControl() constructor
      // passing in this DIV.
       var Map2Div = document.createElement('div');
       var Map2 = new Map2(Map2Div, map2);

      Map2Div.index = 1;
      map.controls[google.maps.ControlPosition.TOP_RIGHT].push(Map2Div);
        } 
```

# ruby-on-rails - 检查活动记录是否锁定在“更新”状态

> ID：14886919
> 
> 赞同：5
> 
> 时间：2013-02-15T01:13:05.397
> 
> 标签：ruby-on-rails, multithreading, locking, rails-activerecord, rails-postgresql

假设我有以下实体和关系：

```
A<-B<-C<-D<-E 
```

对于同一个 A，我有很多 E（E 通过 D、C 和 B 属于 A）

我有一个看起来像这样的代码片段：

```
eList=E.all
varA=eList.first.D.C.B.A

E.transaction do
  ...Operations that take some time...

  varA.update_attributes(::last_update=>Time.now)
end 
```

现在认为此代码段与线程一起运行。每个 E 实体一个线程。这意味着如果一个 A 有 10 个 E，那么这个代码段将同时运行 10 个线程。

我的问题与线路有关

```
varA.update_attributes(:last_update=>Time.now) 
```

当我查看我的代码时，我发现我有这个：

```
[DEBUG] 2013/02/13 13:09:51 [66222] - abstract_adapter.rb:198 -   A Update (3107.1ms)   UPDATE "A" SET "updated_at" = '2013-02-13 13:09:47.932899', "last_update" = '2013-02-13 13:09:47.932209' WHERE "id" = 144
[DEBUG] 2013/02/13 13:09:54 [48600] - abstract_adapter.rb:198 -   A Update (6812.2ms)   UPDATE "A" SET "updated_at" = '2013-02-13 13:09:47.218032', "last_update" = '2013-02-13 13:09:47.217421' WHERE "id" = 144
[DEBUG] 2013/02/13 13:09:56 [66190] - abstract_adapter.rb:198 -   A Update (6717.5ms)   UPDATE "A" SET "updated_at" = '2013-02-13 13:09:49.328496', "last_update" = '2013-02-13 13:09:49.327777' WHERE "id" = 144
[DEBUG] 2013/02/13 13:09:59 [66219] - abstract_adapter.rb:198 -   A Update (10816.2ms)   UPDATE "A" SET "updated_at" = '2013-02-13 13:09:48.236539', "last_update" = '2013-02-13 13:09:48.235895' WHERE "id" = 144
[DEBUG] 2013/02/13 13:10:01 [66200] - abstract_adapter.rb:198 -   A Update (13450.9ms)   UPDATE "A" SET "updated_at" = '2013-02-13 13:09:47.584182', "last_update" = '2013-02-13 13:09:47.583467' WHERE "id" = 144 
```

如您所见，每个线程运行每个查询的时间都会增加。第一个需要 3 秒，而最后一个需要 13 秒。我认为这是因为我正在更新同一条记录 (A.id=144)，因此该记录被锁定，其他线程需要等待。

我的问题是，Rails 2.3 中是否有一种方法可以检测记录是否因为正在更新而被锁定，这样我就可以让其他线程跳过更新？

就像是：

```
if not varA.locked then varA.update_attributes(:last_update=>Time.now) end 
```

对我来说只更新一次就足够了，所以我希望其他线程检查它是否已经在更新并继续前进。

FWIW，我的数据库是 postgres 9.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T15:45:04.023

检查一行是否被锁定以进行更新是 PostgreSQL 中一个相对复杂的过程，据我所知，只有在可以捕获 sql 异常的过程语言中才可行。如果 ActiveRecord 可以做到这一点，我会感到非常惊讶。

如果你需要这样做，你可能需要编写存储过程来捕获这些异常并放到 SQL 中。

# php - Internet Explorer 回显重复的 mysql 结果？

> ID：14886922
> 
> 赞同：0
> 
> 时间：2013-02-15T01:13:19.923
> 
> 标签：php, mysql, internet-explorer

嗨，有点令人困惑，我把它归结为 mysql 查询，因为我看不出它还能是什么。基本上，我在页面顶部的网站上回显了 7 个用户。并且在除 IE 之外的所有浏览器中只显示 7 个用户。我在一个带有边框和框阴影等的 div 中显示我的用户，然后我将该 div 包装在指向他们个人资料的链接中，现在在 ie 中，我得到了一个包含七个用户的列表，但在每个结果旁边（每个用户）我得到带有指向用户个人资料的链接但没有图像的重复结果？

我不知道这个重复的结果是从哪里来的，为什么它只发生在 ie 中（所有版本）

继承人我的代码有人可以解释我能做什么谢谢。

图像在 ie 中显示如下：

ni = 没有图片，只有链接

```
 box1    |    box 1 (ni)    |  box 2   |   box 2 (ni)    |   box 3    |    box3 (ni)   etc 
```

这是我的功能

```
function get_platinum_users() {
        global $connection;
        $query = "SELECT *
                    FROM ptb_users, ptb_profiles
                    WHERE ptb_users.account_type = \"User\"
                    AND ptb_users.account_status = \"Active\"
                    AND ptb_profiles.user_id = ptb_users.id
                    AND ptb_users.subscription = \"Platinum\"
                    LIMIT 0 , 7";
        $platinum_set = mysql_query($query, $connection);
        confirm_query($platinum_set);
        return $platinum_set;
    } 
```

和我的php代码：

```
<?
 $platinum_set = get_platinum_users();
 $platinum_count = mysql_num_rows($platinum_set);
        while ($platinum = mysql_fetch_array($platinum_set)) {
?>

<? echo"<div class=\"image_case\"><a href=\"profile.php?id={$platinum['id']}\"><img width=80px height= 80px src=\"data/photos/{$platinum['id']}/_default.jpg\"></div>";

}

    // if there were less than 60 users we need some default profiles to fill the spaces
    if($platinum_count < 7){
        // how many default spaces do we need?
        $default_profiles_needed = 7 - $platinum_count;        
        for($i = 1; $i <= $default_profiles_needed; $i++){
            echo "<div class=\"image_case\">
                    <a href=\"default.php\">
                        <img width=80px height= 80px src=\"data/photos/0/no_add.jpg\"/>
                </div>";
        }
    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:17:04.967

您所有的超链接都没有关闭。你错过了你的闭幕词`</a>`。IE 对坏代码（甚至经常是好代码）不太宽容。

当您遇到奇怪的错误时，请始终[验证您的代码。](http://validator.w3.org/check)它可能非常有启发性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T01:21:12.667

你没有关闭你的锚标签。替换下面的行

```
<? echo"<div class=\"image_case\"><a href=\"profile.php?id={$platinum['id']}\"><img   width=80px height= 80px src=\"data/photos/{$platinum['id']}/_default.jpg\"></div>"; 
```

和

```
<? echo"<div class=\"image_case\"><a href=\"profile.php?id={$platinum['id']}\"><img width=80px height= 80px src=\"data/photos/{$platinum['id']}/_default.jpg\"></a></div>"; 
```

# javascript - 跨度中的文本未出现

> ID：14886925
> 
> 赞同：1
> 
> 时间：2013-02-15T01:13:52.163
> 
> 标签：javascript, if-statement, html

我有这个函数可以从数组中生成随机名称，然后删除它们，这样就没有重复了。我想添加一个 if 语句，以便我可以根据生成的名称更新另一个具有位置名称的变量。当我添加 if 语句时，名称永远不会加载到跨度中，没有它，它工作正常。我究竟做错了什么？感谢任何帮助。

```
<h1> <span id="questionnum"></span>. Where was <span id="namequestion"></span> born?</h1>

<script type="text/javascript">

filenames = [ "Isaak Newton", "Johannes Gutenberg", "Christopher Columbus"];

generateName();
function generateName(){
filename = filenames.splice(Math.floor(Math.random()*filenames.length), 1);
document.getElementById('namequestion').textContent = filename;

 if (filename == "Isaak Newton"){
     placeofbirth = "United Kingdom"; 
 }
 else if (filename == "Johannes Gutenberg"){
     placeofbirth = "Germany"; 
 }
 else  (filename == "Christopher Columbus"){
     placeofbirth = "Italy"; 
 }

</script> 
```

# jquery - 初学者关于 Web 应用程序的问题（MS 技术）

> ID：14886926
> 
> 赞同：0
> 
> 时间：2013-02-15T01:14:14.597
> 
> 标签：jquery, asp.net, vb.net, sql-server-2008

我即将推出网络应用程序（启动），我自己既不是编码员也不是技术友好型。该应用程序正在使用 asp.net 4.0 (VB.net)、jQuery、json、xml、SQL Server 2008 开发。它目前由我聘请的开发人员编写。我的问题是..

1.  从编码到在服务器上部署的过程是什么？（解释上述每种技术的作用）？简短、简单的解释将帮助我理解流程。

2.  稍后在应用程序上线后，我还需要使用最初使用的相同 IDE 吗？

3.  我听说微软技术的运行成本很高（尽管有些人不同意..）。运行使用 MS 技术构建的平台的预期成本和费用是多少？

这些是非常基本的问题，很抱歉打扰您，但我们将非常感谢您的帮助...我发现书籍没有多大帮助..

最后，有没有像我这样的人的书或资料？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:30:10.980

> 问：我即将推出网络应用程序（启动），我自己既不是编码人员，也不是技术友好型......目前它是由我聘请的开发人员编写的。

答：友好的建议：您*不必关心*它是用 XML、Json、C++、Java 还是梵文编写的。您不在乎使用了什么（如果有的话！）IDE，或者在交付后您是否仍会使用它。

您*只*关心开发人员是否会为您提供所需的产品，以及他们是否会在预算范围内按时完成。

任何成功的软件项目的关键是 1) 捕获，以及 2) 管理一组好的“软件需求”。有很多“方法”可以做到这一点（“敏捷开发”、“Scrum”、“极限编程”等）。你也*不在乎*这些。

专注于“我在建造什么”？知道*你*知道你想要什么。然后确保你的*团队*知道你想要什么。

然后*，您*可以专注于您需要做的所有*其他事情，以使您的创业成功。*

推荐阅读：

*   [http://www.cio.com/article/29903/Five_Things_IT_Managers_Should_Know_About_Software_Requirements](http://www.cio.com/article/29903/Five_Things_IT_Managers_Should_Know_About_Software_Requirements)

*   [http://pragprog.com/book/prj/ship-it](http://pragprog.com/book/prj/ship-it)

*   [http://online.wsj.com/article/SB10001424052748703467004575463460389523660.html](http://online.wsj.com/article/SB10001424052748703467004575463460389523660.html)

# ios - Xcode 中的链接器命令失败

> ID：14886928
> 
> 赞同：0
> 
> 时间：2013-02-15T01:14:24.617
> 
> 标签：ios, objective-c, xcode

我正在构建一个应用程序，但后来我很快改变了一些东西（char 变量中的一个值）并尝试再次加载，现在我收到了这个错误

```
ld: 9 duplicate symbols for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我已经撤消了我所做的事情，但我仍然收到此错误。我试图删除构建文件夹，它没有工作......我也执行了清理和构建，但它仍然无法构建......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:39:14.207

您必须检查构建中包含的文件。很可能包含一些重复的实现（或者可能是头文件？）文件。

1.  导航到`{Project}`> `{Target}`> `Build Phases`。
2.  检查`Compile Sources`构建阶段是否有重复项。
3.  删除所有重复文件。

还要确保项目中不包含重复的库。您可以在`Link Binary With Library`阶段检查这一点。与上面的故事基本相同，但用于图书馆。

最后确保在构建之前清理项目（`Product`> `Clean`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T15:35:35.693

我的错误消息有点不同 - *ClassImplmentationFile 中有重复的符号。*米

如上所述，我没有任何重复项，但我注意到错误消息中列出的 .m 文件位于 Build Phases/Compile Sources 中。

我从那里删除了它们，事情运行良好。

我没有把它们放在那里。我猜 Xcode 在某个时候自动搞砸了我的项目。: - )

# java - 使 URL 与字符串的所有可能组合

> ID：14886935
> 
> 赞同：0
> 
> 时间：2013-02-15T01:15:21.527
> 
> 标签：java, string

我正在尝试从用逗号分隔的不同字符串组合创建一个 url，以便我可以使用这些 url 来执行它们并取回数据。

我已经简化了这样的事情，我有一个`HashSet`将包含我所有的字符串，`not A,B,C in real`. 我只是在这里对其进行了修改以使其简单。

```
Set<String> data = new HashSet<String>();
h.add("A");
h.add("B");
h.add("C");    

for (int i = 1; i < 1000; i++) {

String pattern = generateString(data);

String url = "http://localhost:8080/service/USERID=101556000/"+pattern;

System.out.println(url);

}

/**
 * Below is the method to generate Strings.
 /
private String generateString(HashSet<String> data) {

//not sure what logic I am supposed to use here?

} 
```

所以输出应该是这样的 -

```
http://localhost:8080/service/USERID=101556000/A
http://localhost:8080/service/USERID=101556000/B
http://localhost:8080/service/USERID=101556000/C
http://localhost:8080/service/USERID=101556000/A,B,C
http://localhost:8080/service/USERID=101556000/B,C
http://localhost:8080/service/USERID=101556000/C,A

--
And other combinations 
```

上述输出也可以是任何随机顺序。但它应该是所有可能的组合。如果所有可能的组合都完成了，那么重新开始。

任何建议如何实现上述问题定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:39:45.657

你问的不是小事。

让我们看一下 2 个字符串，A 和 B。

这里是所有的排列。

```
A
B
AB
BA 
```

好的，让我们看看 3 个字符串，A、B 和 C。

这里是所有的排列。

```
A
B
C
AB
AC
BA
BC
CA
CB
ABC
ACB
BAC
BCA
CAB
CBA 
```

你看到模式了吗？

首先，您必须找到所有单个字符串排列。然后是两个字符串排列。然后是三个字符串排列。依此类推，直到字符串的数量。

然后，在一组排列（如两个字符串集）中，您必须找到所有可能的排列。

你可以用java循环来做到这一点。您也可以使用递归。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T09:30:43.943

鉴于什么是 k 排列（[http://en.wikibooks.org/wiki/Probability/Combinatorics](http://en.wikibooks.org/wiki/Probability/Combinatorics)），您正在寻找 k 从 1 到 D 变化的 k 排列，其中 D 是数据集合的大小。

这意味着要计算 - 我的第一篇文章我无法发布图片，所以请查看位于的等式：

![](../Images/49984d869aa4afc8aefb1875b54b0c05.png)

为了做到这一点，您可以使 k 变化，并且对于每个 k 可能 n 变化（即仅处理子数组或数据以枚举 k 排列）。这些 k 排列可以通过使用递归将数组向右和向左移动来找到。

这是一个快速引导程序，可以证明需要枚举什么：

```
public class EnumUrl {

private Set<String> enumeration = null;
private List<String> data = null;
private final String baseUrl = "http://localhost:8080/service/USERID=101556000/";

public EnumUrl(List<String> d) {
    data = d;
    enumeration = new HashSet<String>(); // choose HashSet : handle duplicates in the enumeration process
}

public Set<String> getEnumeration() {
    return enumeration;
}

public static void main(String[] args) {

    List<String> data = new ArrayList<String>();
    data.add("A");
    data.add("B");
    data.add("C");

    EnumUrl enumerator = new EnumUrl(data);

    for (int k = 0; k < data.size(); k++) {

        // start from any letter in the set
        for (int i = 0; i < data.size(); i++) {
            // enumerate possible url combining what's on the right of indice i
            enumerator.enumeratePossibleUrlsToRight(data.get(i), i);

            // enumerate possible url combining what's on the left of indice i
            enumerator.enumeratePossibleUrlsToLeft(data.get(i), i);
        }

        // make a circular permutation of -1 before the new iteration over the newly combined data
        enumerator.circularPermutationOfData();
    }

    // display to syso
    displayUrlEnumeration(enumerator);
}

private void circularPermutationOfData() {
    String datum = data.get(0);
    for (int i = 1; i < data.size(); i++) {
        data.set(i - 1, data.get(i));
    }
    data.set(data.size() - 1, datum);
}

private static void displayUrlEnumeration(EnumUrl enumerator) {
    for (String url : enumerator.getEnumeration()) {
        System.out.println(url);
    }
}

private void enumeratePossibleUrlsToRight(String prefix, int startAt) {
    enumeration.add(baseUrl + prefix);
    if (startAt < data.size() - 1) {
        startAt++;
        for (int i = startAt; i < data.size(); i++) {
            int x = i;
            enumeratePossibleUrlsToRight(prefix + "," + data.get(x), x);
        }
    }
}

private void enumeratePossibleUrlsToLeft(String prefix, int startAt) {
    enumeration.add(baseUrl + prefix);
    if (startAt > 0) {
        startAt--;
        for (int i = startAt; i >= 0; i--) {
            int x = i;
            enumeratePossibleUrlsToLeft(prefix + "," + data.get(x), x);
        }
    }
}
} 
```

{A,B,C} 的程序输出：

```
http://localhost:8080/service/USERID=101556000/B,C
http://localhost:8080/service/USERID=101556000/B,A,C
http://localhost:8080/service/USERID=101556000/B,C,A
http://localhost:8080/service/USERID=101556000/B,A
http://localhost:8080/service/USERID=101556000/C
http://localhost:8080/service/USERID=101556000/B
http://localhost:8080/service/USERID=101556000/C,B,A
http://localhost:8080/service/USERID=101556000/A,C,B
http://localhost:8080/service/USERID=101556000/A,C
http://localhost:8080/service/USERID=101556000/A,B
http://localhost:8080/service/USERID=101556000/A,B,C
http://localhost:8080/service/USERID=101556000/A
http://localhost:8080/service/USERID=101556000/C,B
http://localhost:8080/service/USERID=101556000/C,A
http://localhost:8080/service/USERID=101556000/C,A,B 
```

对于 {A,B,C,D} ：

```
http://localhost:8080/service/USERID=101556000/B,A,D,C
http://localhost:8080/service/USERID=101556000/C,D
http://localhost:8080/service/USERID=101556000/A,D,C,B
http://localhost:8080/service/USERID=101556000/A,C,D
http://localhost:8080/service/USERID=101556000/D
http://localhost:8080/service/USERID=101556000/C
http://localhost:8080/service/USERID=101556000/A,C,B
http://localhost:8080/service/USERID=101556000/B
http://localhost:8080/service/USERID=101556000/A,B,C,D
http://localhost:8080/service/USERID=101556000/A,B,C
http://localhost:8080/service/USERID=101556000/D,C,B,A
http://localhost:8080/service/USERID=101556000/C,B,A,D
http://localhost:8080/service/USERID=101556000/A,B,D
http://localhost:8080/service/USERID=101556000/D,B
http://localhost:8080/service/USERID=101556000/D,C
http://localhost:8080/service/USERID=101556000/A
http://localhost:8080/service/USERID=101556000/D,C,A
http://localhost:8080/service/USERID=101556000/D,C,B
http://localhost:8080/service/USERID=101556000/C,D,A
http://localhost:8080/service/USERID=101556000/C,D,B
http://localhost:8080/service/USERID=101556000/D,A
http://localhost:8080/service/USERID=101556000/A,D,C
http://localhost:8080/service/USERID=101556000/A,D,B
http://localhost:8080/service/USERID=101556000/C,B,D
http://localhost:8080/service/USERID=101556000/B,A,D
http://localhost:8080/service/USERID=101556000/B,C
http://localhost:8080/service/USERID=101556000/B,A,C
http://localhost:8080/service/USERID=101556000/B,C,A
http://localhost:8080/service/USERID=101556000/B,A
http://localhost:8080/service/USERID=101556000/B,C,D
http://localhost:8080/service/USERID=101556000/C,B,A
http://localhost:8080/service/USERID=101556000/A,D
http://localhost:8080/service/USERID=101556000/D,A,B
http://localhost:8080/service/USERID=101556000/A,C
http://localhost:8080/service/USERID=101556000/D,A,C
http://localhost:8080/service/USERID=101556000/B,C,D,A
http://localhost:8080/service/USERID=101556000/A,B
http://localhost:8080/service/USERID=101556000/B,D
http://localhost:8080/service/USERID=101556000/C,D,A,B
http://localhost:8080/service/USERID=101556000/D,A,B,C
http://localhost:8080/service/USERID=101556000/D,B,A
http://localhost:8080/service/USERID=101556000/D,B,C
http://localhost:8080/service/USERID=101556000/B,D,A
http://localhost:8080/service/USERID=101556000/C,B
http://localhost:8080/service/USERID=101556000/C,A,D
http://localhost:8080/service/USERID=101556000/C,A
http://localhost:8080/service/USERID=101556000/B,D,C
http://localhost:8080/service/USERID=101556000/C,A,B 
```

这不是详尽的枚举。基本上我们应该有：

（我的第一篇文章我无法发布图片来查看我回复中的方程式，我没有发布 2 个链接的声誉……#omg）

这产生了 64 个组合，分布如下：

*   1 个元素的 4 个组合 (k=1)
*   12 个元素的 12 个组合 (k=2)
*   24 个元素的 24 个组合 (k=3)
*   24 个元素的 24 个组合 (k=4)

您可以看到我的程序对于 k=1、k=2 和 k=3 是可以的。但是对于 k=4，没有 24 个组合。为了完成该程序，您还需要迭代除循环排列之外的其他类型的数据混洗。实际上，当 k=4 时，循环置换不会生成例如 ADBC 作为输入数据（因此例如我的实现不能生成 DBCA）。在这种情况下，您将希望以所有可能的顺序枚举所有可能的包含 n 个元素的数据输入数组。这是 k 排列的一种特殊情况，其中 k=n，因此会导致找到`n!`排列。`n!`我们可以通过为每个可能的排列调用 EnumUrl 方法来实现这一点。

为此，您应该`EnumUrl enumerator = new EnumUrl(data);`相应地更新，但我想我会让您做一些工作:-)

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T12:31:47.197

一个适用于任意集合大小的简短版本，使用泛型，使用[guava](http://code.google.com/p/guava-libraries/)以及[此处给出](https://stackoverflow.com/questions/2920315/permutation-of-array)的排列方法。

基本上这个想法如下：

1.  生成幂集，丢弃空集
2.  对于每组幂集，生成所有排列

    公共类 QuickEnumeration {

    ```
    Set<T> objects;

    public QuickEnumeration(Set<T> objects) {
        this.objects = objects;
    }

    public List<List<T>> generateEnumeration() {
        List<List<T>> result = new ArrayList<List<T>>();
        // Compute the powerset
        Set<Set<T>> powerset = Sets.powerSet(objects);
        for (Set<T> set : powerset) {
            // Discard empty set
            if (set.size() > 0) {
                // Arraylist faster for swapping
                ArrayList<T> start = new ArrayList<T>(set);
                permute(start, 0, result);
            }
        }
        return result;
    }

    private void permute(ArrayList<T> arr, int k, List<List<T>> result) {
        for (int i = k; i < arr.size(); i++) {
            java.util.Collections.swap(arr, i, k);
            permute(arr, k + 1, result);
            java.util.Collections.swap(arr, k, i);
        }
        if (k == arr.size() - 1) {
            result.add((List<T>) arr.clone());
        }
    }

    public static void main(String[] args) {
        Set<String> testSet = new HashSet<>();
        testSet.add("A");
        testSet.add("B");
        testSet.add("C");
        QuickEnumeration<String> enumerate = new QuickEnumeration<>(testSet);
        System.out.println(enumerate.generateEnumeration());
    } 
    ```

    }

用 "A","B","C" 测试给出：

```
[[A], [B], [A, B], [B, A], [C], [A, C], [C, A], [B, C], [C, B], [A, B, C], [A, C, B], [B, A, C], [B, C, A], [C, B, A], [C, A, B]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T02:25:13.257

我不完全确定您真正想要什么，所以我最终为您编写了这段代码。希望它能让你开始！

```
public static void doThis() {

    String url1="http://www.example.com";
    String string1="A";
    String url2="http://www.foo.com";
    String string2="B";
    String url3="http://www.bar.com";
    String string3="C";

    Map<String, String> abbrMap = new HashMap<String, String>();
    abbrMap.put(string1, url1);
    abbrMap.put(string2, url2);
    abbrMap.put(string3, url3);
    String string = string1+string2+string3;
    for(Map.Entry<String, String> m : abbrMap.entrySet()) {
        arrange(string, m.getValue());
    }

}

private static void arrange(String str, String url) {
    if (str.length()==0) return;
    StringBuffer sbuf = new StringBuffer();
    for (int j=0; j<str.length(); j++) {

        for(int i=j; i<str.length(); i++) {
            char c = str.charAt(i);
            sbuf.append(c);
            System.out.println(url+"/"+sbuf.toString());
            sbuf.append(",");
        }
        sbuf.setLength(0);
    }
} 
```

输出：

```
http://www.example.com/A
http://www.example.com/A,B
http://www.example.com/A,B,C
http://www.example.com/B
http://www.example.com/B,C
http://www.example.com/C
http://www.foo.com/A
http://www.foo.com/A,B
http://www.foo.com/A,B,C
http://www.foo.com/B
http://www.foo.com/B,C
http://www.foo.com/C
http://www.bar.com/A
http://www.bar.com/A,B
http://www.bar.com/A,B,C
http://www.bar.com/B
http://www.bar.com/B,C
http://www.bar.com/C 
```

# postgresql - Ruby rails 的错误

> ID：14886937
> 
> 赞同：0
> 
> 时间：2013-02-15T01:15:40.820
> 
> 标签：postgresql, ruby-on-rails-3.1, runtime-error, forem

当我尝试运行时`rails s`，我遇到了这个巨大的错误，我刚刚重新安装了 ruby​​ 和 PostgreSQL。感谢帮助。这也是在我跑步之后`rails s`，我已经就类似问题发表了另一篇文章，如果这对[Rails Forem 安装帮助](https://stackoverflow.com/questions/14885241/rails-forem-installation-assistance?answertab=votes#tab-top)有任何帮助的话，我仍然是 Ruby 的新手，只是为了记住这一点。再次感谢。

错误：

```
=> Booting WEBrick
=> Rails 3.2.11 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
Exiting
/usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `initialize': could not connect to server: No such file or directory (PG::Error)
        Is the server running locally and accepting
        connections on Unix domain socket "/tmp/.s.PGSQL.5432"?
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `new'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `connect'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:326:in `initialize'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:315:in `new_connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:325:in `checkout_new_connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:247:in `block (2 levels) in checkout'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `loop'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `block in checkout'
        from /usr/local/rvm/rubies/ruby-1.9.3-p385/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:239:in `checkout'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:102:in `block in connection'
        from /usr/local/rvm/rubies/ruby-1.9.3-p385/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:101:in `connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_specification.rb:145:in `connection'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/model_schema.rb:308:in `clear_cache!'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activerecord-3.2.11/lib/active_record/railtie.rb:97:in `block (2 levels) in <class:Railtie>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:418:in `_run__1442159158261981509__prepare__1376751637034186401__callbacks'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:405:in `__run_callback'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:81:in `run_callbacks'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/actionpack-3.2.11/lib/action_dispa

tch/middleware/reloader.rb:74:in `prepare!'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/actionpack-3.2.11/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/application/finisher.rb:47:in `block in <module:Finisher>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `block in run_initializers'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
        from /home/forem/config/environment.rb:5:in `<top (required)>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `block in require'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
        from /home/forem/config.ru:3:in `block in <main>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/builder.rb:51:in `instance_eval'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/builder.rb:51:in `initialize'
        from /home/forem/config.ru:in `new'
        from /home/forem/config.ru:in `<main>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/builder.rb:40:in `eval'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/builder.rb:40:in `parse_file'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/server.rb:200:in `app'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/commands/server.rb:46:in `app'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/server.rb:304:in `wrapped_app'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/rack-1.4.4/lib/rack/server.rb:254:in `start'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/commands/server.rb:70:in `start'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/commands.rb:55:in `block in <top (required)>'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/commands.rb:50:in `tap'
        from /usr/local/rvm/gems/ruby-1.9.3-p385/gems/railties-3.2.11/lib/rails/commands.rb:50:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T08:39:12.373

您的 postgres 服务是否正在运行？服务 postgresql 启动

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:33:03.653

这是因为您的 postgresql 连接失败。确保您的 config/database.rb 设置正确。

如果您认为是，那么接下来查看您的端口设置。“/tmp/.s.PGSQL.5432”？

# php - 当用户中止连接时回滚事务

> ID：14886938
> 
> 赞同：5
> 
> 时间：2013-02-15T01:15:54.807
> 
> 标签：php, mysql, ajax, rollback, abort

首先，对不起我的英语，我在谷歌翻译的帮助下写了这个。

我正在尝试使用 PHP 和 Ajax 制作像 Google Wave 这样的应用程序。我有一个 textarea，当用户输入内容时，页面上的 javascript 检测到`oninput`并将 textarea 的内容发送到服务器，服务器将内容存储到数据库中。

我正在做的是，每次我通过 XHR 发送内容时`XHR.abort()`，总是会中断之前的 XHR 请求。数据库中的数据很好，但是，有时它存储的是以前的版本。

我知道会发生这种情况，因为即使客户端已中止，PHP 也没有停止执行，有时前一个请求比上一个请求花费了更多时间并且在最后一个请求之后完成，所以我阅读了“ignore_user_abort”函数手册和“connection_aborted”，但问题仍然存在。

我创建了这个脚本来模拟这种情况，我希望当我中止连接时（按“停止”，关闭选项卡/窗口），数据库上没有任何新数据，但 5 秒后，我仍然有新数据，所以当用户中止连接时，我需要帮助来回滚事务。

这是要模拟的脚本（定义了 PDO_DSN、PDO_USER、PDO_PASS）：

```
<?php
ignore_user_abort(true);

ob_start('ob_gzhandler');

$PDO = new PDO(PDO_DSN, PDO_USER, PDO_PASS, array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8'));

$PDO->beginTransaction();
$query = $PDO->query('INSERT INTO `table` (`content`) VALUES (' . $PDO->quote('test') . ')');
sleep(5);
echo ' ';
ob_flush();
flush();
if (connection_aborted()) {
  $PDO->rollBack();
  exit;
}
$PDO->commit();

ob_end_flush(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T01:22:41.410

如果您发现`XHR.abort()`并且`connection_aborted()`不可靠，请考虑使用其他方式发送带外信号以通知正在运行的 PHP 请求它不应提交事务。

您是否正在运行[APC](http://php.net/manual/en/book.apc.php)（或者您可以）？

`XHR.abort()`您可以发送另一个 XHR 请求以发出中止信号，而不是调用。此请求的目的是在 APC 用户缓存中记录一个特殊键。该键的存在将向正在运行的 PHP 请求表明它应该回滚。

为了完成这项工作，每个 XHR 请求都需要携带一个（相对）唯一的事务标识符，例如作为表单变量。该标识符将随机生成，或根据当前时间生成，并将在初始 XHR 以及“中止”XHR 中发送，并允许中止请求与正在运行的请求相关联。在下面的示例中，事务标识符的形式为 variable `t`。

示例“中止”XHR 处理程序：

```
<?php
$uniqueTransactionId = $_REQUEST['t'];
$abortApcKey = 'abortTrans_' . $uniqueTransactionId;

apc_store($uniqueTransactionId, 1, 15); 
```

修改数据库写入 XHR 处理程序示例：

```
<?php
$PDO = new PDO(PDO_DSN, PDO_USER, PDO_PASS,
               array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8'));

$PDO->beginTransaction();
$query = $PDO->query('INSERT INTO `table` (`content`) VALUES (' . $PDO->quote('test') . ')');

$uniqueTransactionId = $_REQUEST['t'];
$abortApcKey = 'abortTrans_' . $uniqueTransactionId;
if (apc_exists($abortApcKey)) {
  $PDO->rollBack();
  exit;
}

$PDO->commit(); 
```

您可能仍然有时间问题。中止可能仍然来得太晚而无法停止提交。为了优雅地处理这个问题，您可以修改数据库写入处理程序以记录一个 APC 键，指示事务已提交。然后，中止处理程序可以检查此密钥的存在，并返回一个有意义的 XHR 中止结果以通知客户端，“对不起，我来得太晚了。”

请记住，如果您的应用程序托管在多个实时服务器上，您将需要使用共享缓存，例如`memcached`or `redis`，因为 APC 的缓存仅在单个机器上的进程之间共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T01:33:45.940

让浏览器发回您也存储在数据库中的时间戳或运行编号怎么样。并且您的更新可以检查，以便它仅在新时间戳较新时写入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:19:04.220

我用 Javascript 和 Ajax 多次看到这个问题。如果您在实现 UI 时不是很小心，那么用户可以单击两次和/或浏览器可以触发两次 ajax 调用，从而导致同一条记录两次访问您的数据库。这可能是来自您的 UI 的两个完全不同的 http 请求，因此您需要确保您的服务器端代码可以在将重复项插入数据库之前过滤掉它们。我的解决方法通常是查询同一用户最近输入的记录，并检查这是否真的是一个新条目。如果这个新记录还没有在数据库中，则插入它，否则忽略。在 Oracle 中，您可以使用 PL/SQL 来执行 MERGE IF MATCH THEN INSERT 命令，因此您可以在一个查询中处理此问题，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T18:04:25.180

As Marc B pointed, PHP can't detect if the browser is disconnected without sending some output to the browser. The problem is, you have enabled output buffering at the line `ob_start('ob_gzhandler');` and that prevents PHP from sending output to the browser.

You either have to remove that line or add a ob_end_* (for example: `ob_end_flush()`) along with the echo/flush calls.

# javascript - 如何将用户发起的操作传递到 iframe？

> ID：14886939
> 
> 赞同：3
> 
> 时间：2013-02-15T01:16:27.393
> 
> 标签：javascript, iframe, html5-audio, postmessage, chrome-for-android

我在页面上有一个音频元素，该元素当前正在加载到高度和宽度为零的 iframe 中。我正在使用来自父页面的 postMessage 来告诉子页面播放一些音频。

这在桌面浏览器上运行良好，但是我在移动浏览器上遇到了一些问题。（我在 Chrome for Android 上进行测试，但我认为 iOS 也会有同样的问题）。

移动浏览器要求 media play() 命令由用户发起的操作触发。在我的情况下，用户正在单击父页面上的按钮来启动播放，但似乎在执行 postMessage 时，浏览器会失去对它的跟踪。

有什么方法可以让我在 iframe 内播放音频而不使 iframe 内的页面对用户可见？

# php - 在 while 循环中显示数组结果时遇到问题

> ID：14886942
> 
> 赞同：0
> 
> 时间：2013-02-15T01:16:41.557
> 
> 标签：php, html, arrays, loops

我是 php 新手，在回显数据库结果时遇到问题。div 标签上方的所有内容都可以正常执行并正确显示在我的表格中。但我遇到的问题是在 div 标签内。

```
while($row = mysql_fetch_array($result))
    {
    if ($row['status']==0){
    $row['status']="Inactive";
    $lablestatus="label";
    }
    elseif ($row['status']==1){
    $row['status']="Pending";
    $lablestatus="label label-warning";
    }
    elseif ($row['status']==2){
    $row['status']="Banned";
    $lablestatus="label label-important";
    }
    elseif ($row['status']==3){
    $row['status']="Active";
    $lablestatus="label label-success";
    }                
           echo "<tr>
                 <td>{$row['id']}</td>
                 <td class='center'>{$row['username']}</td>
                 <td class='center'>17</td>
                 <td class='center'>36</td>
                 <td class='center'>17</td>
                 <td class='center'>$458.66</td>
                 <td class='center'>Yes</td>
                 <td class='center'>{$row['register_date']}</td>
                 <td class='center'>2013-02-13 24:06:13</td>
                 <td class='center'>Yes</td>
                 <td class='center'><span class='$lablestatus'>{$row['status']}</span></td>
                 <td class='center'>
                    <a class='btn btn-success' href='view_user.php?id={$row['id']}'>
                    <i class='icon-zoom-in icon-white'></i>View</a>
                    <a class='btn btn-info' href='edit_user.php?id={$row['id']}'>
                    <i class='icon-edit icon-white'></i>Edit</a>
                    <a class='btn btn-danger btn-setting'>
                    <i class='icon-trash icon-white'></i>Delete</a>
                 </td>
                 </tr> 
```

这是问题发生的地方。当我为某个用户单击删除时，会显示一个弹出窗口。它询问“您确定要删除用户 exampleuser 吗？” 我的表中的每个用户都显示相同的用户名。因此，如果我单击删除 exampleuser2，它会询问我是否要删除 exampleuser。知道如何解决这个问题吗？

```
<div class='modal hide fade' id='myModal'>
                 <div class='modal-header'>
                 <button type='button' class='close' data-dismiss='modal'>×</button>
         <h3>Delete member</h3>
                 </div>
                 <div class='modal-body'>
         <p>Are you sure you want to delete the user {$row['username']}?</p>
                 </div>
         <div class='modal-footer'>
                 <a href='#' class='btn' data-dismiss='modal'>No</a>
                 <a href='delete_user.php?id={$row['id']}' class='btn btn-primary'>Yes</a>
                 </div>
                 </div>";
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:33:10.953

因为您的弹出代码是 inisde while 循环

```
<div class='modal hide fade' id='myModal'>
                 <div class='modal-header'>
                 <button type='button' class='close' data-dismiss='modal'>×</button>
         <h3>Delete member</h3>
                 </div>
                 <div class='modal-body'>
         <p>Are you sure you want to delete the user {$row['username']}?</p>
                 </div>
         <div class='modal-footer'>
                 <a href='#' class='btn' data-dismiss='modal'>No</a>
                 <a href='delete_user.php?id={$row['id']}' class='btn btn-primary'>Yes</a>
                 </div>
                 </div>"; 
```

您的 div id 不是唯一的`id='myModal'`，我想第一个/最后一个 div 所花费的所有时间。**一个页面不能有多个id**

使它`<div class='modal hide fade' id='myModal_{$row['id']}'>`像这样动态并更改您的 js 弹出代码并尝试（我猜您在单击删除链接时指定此 id 也使其动态以匹配正确的弹出窗口）。

# javascript - 缺少滚动条的下半部分

> ID：14886943
> 
> 赞同：0
> 
> 时间：2013-02-15T01:16:42.930
> 
> 标签：javascript, jquery, html, css

一旦垂直滚动条出现在我的网站上，它的下半部分似乎就不见了。[您可以在此处](http://scmweb.infj.ulst.ac.uk/~B00518833/COM601/assignment_1/index.html#)查看实时站点（转到“进一步阅读”选项卡）。

HTML：

```
<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script>
    <title>History of Le Mans</title>   
    <link rel="stylesheet" type="text/css" href="CSS/common.css">
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
    <script src="JS/common.js"></script>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  </head>
  <body>
    <nav>
      <ul id="tabs">
        <li><a href="#" id="tab1" name="#tabContent1" class="activeTab">Home</a></li>
        <li><a href="#" id="tab2" name="#tabContent2">History</a></li>
        <li><a href="#" id="tab3" name="#tabContent3">The Circuit</a></li>
        <li><a href="#" id="tab4" name="#tabContent4">Gallery</a></li> 
        <li><a href="#" id="tab5" name="#tabContent5">Further Reading</a></li>    
      </ul>
    </nav>
    <div id="content">
      <div id="tabContent1"></div>
      <div id="tabContent2">
        <div id="accordion">
          <div class="group">
            <h3>Section 1</h3>
            <div>
              <p>Mauris mauris ante, blandit et, ultrices a, suscipit eget, quam. Integer ut neque. Vivamus nisi metus, molestie vel, gravida in, condimentum sit amet, nunc. Nam a nibh. Donec suscipit eros. Nam mi. Proin viverra leo ut odio. Curabitur malesuada. Vestibulum a velit eu ante scelerisque vulputate.</p>
            </div>
          </div>
          <div class="group">
            <h3>Section 2</h3>
            <div>
              <p>Sed non urna. Donec et ante. Phasellus eu ligula. Vestibulum sit amet purus. Vivamus hendrerit, dolor at aliquet laoreet, mauris turpis porttitor velit, faucibus interdum tellus libero ac justo. Vivamus non quam. In suscipit faucibus urna. </p>
            </div>
          </div>
          <div class="group">
            <h3>Section 3</h3>
            <div>
              <p>Nam enim risus, molestie et, porta ac, aliquam ac, risus. Quisque lobortis. Phasellus pellentesque purus in massa. Aenean in pede. Phasellus ac libero ac tellus pellentesque semper. Sed ac felis. Sed commodo, magna quis lacinia ornare, quam ante aliquam nisi, eu iaculis leo purus venenatis dui. </p>
              <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
              </ul>
            </div>
          </div>
          <div class="group">
            <h3>Section 4</h3>
            <div>
              <p>Cras dictum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aenean lacinia mauris vel est. </p><p>Suspendisse eu nisl. Nullam ut libero. Integer dignissim consequat lectus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. </p>
            </div>
          </div>
        </div>
      </div>
      <div id="tabContent3"></div>
      <div id="tabContent4"></div>
      <div id="tabContent5"></div>
    </div>
  </body>
</html> 
```

CSS：

```
body {
  background-color: #EEEEEE;
  font-family: Arial,Helvetica;
  font-size: small;
  height: 100%;
  margin: 100px auto 0;
  width: 100%;
}

#tabs {
  list-style: none outside none;
  margin: 0;
  overflow: auto;
  padding: 0;
  position: relative;
  top: -98px;
  width: 100%;
}

#tabs li {
  float: left;
  margin: 0 -15px 0 0;

}
#tabs a {
  border-bottom: 30px solid #3D3D3D;
  border-right: 30px solid transparent;
  color: #FFFFFF;
  float: left;
  height: 0;
  line-height: 30px;
  opacity: 0.3;
  padding: 0 40px;
  position: relative;
  text-decoration: none;
  text-transform: uppercase;
}

.hover {
  border-bottom-color: #2AC7E1 !important;
  opacity: 1 !important;
}

#content {
  background: none repeat scroll 0 0 #FFFFFF;
  border-top: 2px solid #3D3D3D;
  height: 100%;
  padding: 2em 0 0 2em;
  position: absolute;
  top: 30px;
  width: 98%;
}

.activeTab {
  border-bottom-color: #3D3D3D !important;
  opacity: 1 !important;
}

.title {
  position: relative;
  font-weight: bold;
  font-size: 1.25em;
  float: right;
  top: -450px;
  right: 300px;
}

.bookPara {
  position: relative;
  left: 400px;
  top: -400px;
}

#accordion {
  position: relative;
  width: 350px;
  float: right;
} 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:27:11.200

我很确定您的问题涉及 和 的组合（在内容 ID上`height:100%`）。`position: fixed``top: 30px`

你的高度填满了窗口，固定在适当的位置，然后向下推 30px。

我真的不明白为什么您按照自己的方式构建布局，但您需要删除上述约束之一，以防止页面超出窗口底部。

# javascript - JavaScript：匿名 vs 辅助函数

> ID：14886950
> 
> 赞同：3
> 
> 时间：2013-02-15T01:17:23.673
> 
> 标签：javascript, functional-programming, anonymous-function

我正在尝试从 Eloquent Javascript 一书中理解这种功能样式代码：

[http://eloquentjavascript.net/chapter6.html#exercise1](http://eloquentjavascript.net/chapter6.html#exercise1)

当 count() 函数将匿名函数传递给 reduce() 时，代码会起作用。但是，如果我将函数分解为辅助函数，则会出现参考错误。

谁能解释为什么 count() 有效但 countHelper() 无效？

```
var numbers = [1,2,3,0,1,2,3,0]

function forEach(array, action) {
  for (var i = 0; i < array.length; i++)
    action(array[i]);
}

function reduce(combine, base, array) {
  forEach(array, function (element) {
    base = combine(base, element);
  });
  return base;
}

function equals(x) {
  return function(element) { return x === element;};
}

function count(test, array) {  
  return reduce(function(base, element) {
    return base + (test(element)?1:0);
  }, 0, array);
}

function countHelper(test, array) {
  function helper(base, element) {
    return base + (test(element)?1:0);
  }
  return reduce(helper(base, element), 0, array);
}

function countZeroes(array) {
  return count(equals(0), array);
}

print(countZeroes(numbers)) // 2

function countZeroesHelper(array) {
  return countHelper(equals(0), array);
}

print(countZeroesHelper(numbers)) // ReferenceError: base is not defined 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T01:23:50.813

在中，当您将参数传递给并将其返回值传递给 reduce（这不是您想要的）`countHelper()`时，您实际上是在立即调用辅助函数，而不是传递对函数的引用，以便可以在需要时调用函数。你有这个：`reduce()``reduce()`

```
function countHelper(test, array) {
  function helper(base, element) {
    return base + (test(element)?1:0);
  }
  return reduce(helper(base, element), 0, array);
} 
```

应该是这样的：

```
function countHelper(test, array) {
  function helper(base, element) {
    return base + (test(element)?1:0);
  }
  return reduce(helper, 0, array);
} 
```

注意`reduce()`函数参数的不同。

当您想将函数作为参数传递时，不要在其后包含括号，因为这只会导致它立即执行并传递执行它的返回值，而不是仅传递对函数本身的引用。

这是像 Javascript 这样的无类型语言中的一个常见错误，它允许您在任何参数中传递任何内容。即使是经验丰富的程序员也偶尔会犯这个错误（包括我自己）。要理解的重要区别是执行函数与传递对函数的引用之间的区别。

# .htaccess - 有人可以查看我的私人 Soundcloud 嵌入并告诉我哪里出错了吗？

> ID：14886951
> 
> 赞同：0
> 
> 时间：2013-02-15T01:17:28.707
> 
> 标签：.htaccess, iframe, soundcloud, sharing

我尝试遵循 SoundCloud 的建议，并将私有 soundcloud 播放器（简单的 HTML iframe）与简单的 .htaccess 身份验证脚本相关联。那里没问题。

显然，已发送链接的几个人并不高兴。我已经查看了脚本并尝试复制问题，但遗漏了一些东西。这是相关的代码区域。iframe 是一个非常基本的表格的一部分：

```
"<iframe width="500" height="500" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Fplaylists%123456789%3Fsecret_token%3Ds-GggGG&color=F9DAE8&auto_play=true&show_artwork=false" ></iframe>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:25:05.953

您的嵌入代码不正确。您示例中的 iframe src 如下（为便于阅读而格式化）：

```
https://w.soundcloud.com/player/
?url=http%3A%2F%2Fapi.soundcloud.com%2Fplaylists%123456789 <- missing `%2F`
%3Fsecret_token%3Ds-GggGG <- url-encoded delimiters `?` and `=`
&color=F9DAE8
&auto_play=true
&show_artwork=false 
```

几个问题：

1.  我确定您在编辑播放列表 ID 以在此处发布时错过了它，但在`playlist`其 ID 之间（`123456789`在您的示例中），应该有`%2F`，这是 url 编码的`/`字符。
2.  传递参数时，分隔符 (`?`和`=`)`&`不应该是 url 编码的（只有参数的值应该是）
3.  您应该`&`在第一个 URL 参数之后使用作为分隔符而不是`?`，因此秘密令牌应该用`&`

所以，最后应该是（当然没有换行符）：

```
https://w.soundcloud.com/player/
?url=http%3A%2F%2Fapi.soundcloud.com%2Fplaylists%2F123456789
&secret_token=s-GggGG
&color=F9DAE8
&auto_play=true
&show_artwork=false 
```

# web-applications - Visual 2012 实时模板 - 是否可以定义自己的？

> ID：14886955
> 
> 赞同：1
> 
> 时间：2013-02-15T01:18:14.873
> 
> 标签：web-applications, ide, visual-studio-2012, live-templates

就像有问题的一样。是否可以在中定义自己的`'live templates'`示例`WebStorm`，在定义该模板后，我可以稍后通过按 Tab 使用它。下面的屏幕来自`Webstorm`： ![Webstorm 中的实时示例](../Images/031309772778c2af5dcf6866028dc8f2.png)

如果存在，你能告诉我那个选项在哪里吗？我在谷歌搜索，找不到任何信息，所以我在这里添加问题。

*PS如果以其他方式调用，请纠正我。我从`WebStorm`*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:21:38.433

您在寻找[代码片段](http://msdn.microsoft.com/en-gb/library/ms165392%28v=vs.110%29.aspx)吗？( `Tools`->`Code Snippets Manager`或`Ctrl`+ `K`, `Ctrl`+ `B`)

# assembly - 从例程返回失败

> ID：14886959
> 
> 赞同：1
> 
> 时间：2013-02-15T01:18:27.093
> 
> 标签：assembly, x86

我有一个汇编语言例程，可以将字符串转换为整数。但是我怎么能返回失败呢？（例如，在字符串中看到非数字）它将整数值返回为`eax`非零值，因为我通常这样做不是一个好主意，为什么我不能从错误`"0"`转换为不同。`0`也许`stc`在失败的情况下？你如何实施它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T06:12:32.853

如果这是在汇编中，被汇编调用，你有各种各样的选择。

您可以在 %eax 以外的寄存器中返回错误代码（0 表示没有错误，1 表示错误，或者发生错误的字符串中的偏移量）（%ebx，%ecx，随便什么——只要确保调用者保存在调用你的函数之前注册）。

您可以在 %eflags 中设置一个标志，例如奇偶校验 (PF)。RET 指令不修改任何标志，因此在进入时清除标志并在退出时设置它意味着当您的例程返回时标志仍然设置。确保选择在清除和设置之间不会被修改的标志！

您可以触发异常（例如溢出）并让调用者捕获它——但这对于字符串转换之类的东西来说有点笨拙。如果未正确捕获异常，您可能会导致调用应用程序崩溃。

如果您希望您的汇编语言例程像库函数一样被调用（即，通过未指定的编程语言中的既定调用约定调用），那么您确实有两个选择之一：使用全局，或者让调用者传入一个指针，您的例程可以用来向其写入错误代码。看看 strtoul(3) 是如何做到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T02:07:41.777

简单地说，您返回一个额外的值。

选项一（在 C 中），使用全局变量：

```
#include <stdio.h>

int error = 0;

int String2Int(const char* s)
{
  ...
  if (some_error_condition)
    error = 1;
  ...
}

int main(void)
{
  int value;
  error = 0;
  value = String2Int("12g");
  if (error != 0)
    printf("error!\n");
  return 0;
} 
```

选项二，传递一个指向错误变量的指针：

```
#include <stdio.h>

int String2Int(const char* s, int* error)
{
  ...
  if (some_error_condition)
    *error = 1;
  ...
}

int main(void)
{
  int error = 0;
  int value = String2Int("12g", &error);
  if (error != 0)
    printf("error!\n");
  return 0;
} 
```

选项树，返回一个结构：

```
#include <stdio.h>

struct valerr
{
  int value;
  int error;
};

struct valerr String2Int(const char* s)
{
  struct valerr ve;
  ...
  if (some_error_condition)
    ve.error = 1;
  ...
  return ve;
}

int main(void)
{
  struct valerr ve = String2Int("12g");
  if (ve.error != 0)
    printf("error!\n");
  return 0;
} 
```

在后一种情况下，编译器可能会在 中插入一个隐式参数`String2Int()`，指向`ve`，以便`return ve;`知道在哪里存储返回的结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T02:00:51.717

这取决于您的函数是否需要遵循传统的调用约定。如果它可以被你没有汇编级控制的函数调用，例如 C 函数，那么你不能使用进位位来指示错误，因为没有办法告诉编译器检查它。如果您的代码将在许多地方使用，那么最好遵循调用约定，因为它们都需要知道它如何返回值。

如果您的函数仅由您可以控制的汇编代码使用，那么您可以根据需要返回错误。设置进位标志 ( `stc`) 是一种常见的选择。比如BIOS功能用的，我个人以前也用过。只要确保在成功时清除进位标志 ( `clc`)。

另一种可能性是使用两个寄存器作为返回值，一个用于实际结果，一个用于错误代码。如果使用`edx`，这实际上与某些编译器兼容，例如 gcc，它`edx:eax`用作 64 位整数或适合 64 位的结构的结果位置。

最后，如果你需要确保与所有编译器的兼容性，你应该让你的函数接受一个额外的参数，它是一个指向实际结果的指针，并简单地返回一个错误代码。在 C 中，这看起来像这样：

```
int myFunction(int otherArguments, int *resultPointer) {
    int errorCode, result;
    ...
    *resultPointer = result;
    return errorCode;
} 
```

# webserver - 使用 Raspberry Pi 本地服务器控制伺服系统

> ID：14886960
> 
> 赞同：1
> 
> 时间：2013-02-15T01:18:26.783
> 
> 标签：webserver, embedded, raspberry-pi, dma, pwm

我们正在研究在 Pi 上运行服务器，并通过 webapp（通过本地网络）与它通信以控制 2-3 个伺服器。Rpi 似乎只有一个硬件配置的 PWM 引脚，但这可以通过servoblaster 解决。然而，由于 Servoblaster 使用了 Rpi 的 DMA，它会干扰 Pi 操作 Web 服务器的能力吗？如果这个问题不清楚，我很抱歉我对所涉及的软件/网络概念有些不熟悉。此外，是否有进一步了解 DMA 功能的好资源？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:50:08.810

您可以使用 来控制伺服系统`Software PWM`，这不需要任何其他硬件或使用`DMA`

如果您关心性能并想要更强大的硬件，请考虑[ODROID-X](http://www.hardkernel.com/renewal_2011/products/prdt_info.php?g_code=g133999328931)，它具有 1.4GHz 处理器和 1GB 内存，售价 130 美元，这是物超所值的价格。

对于其他替代品，请检查[小型低成本 linux pc](https://raymii.org/s/articles/Small_Linux_PCs.html)

# jquery - 给定 $(' 富 Bar ') 编写 jquery 来选择跨度

> ID：14886962
> 
> 赞同：0
> 
> 时间：2013-02-15T01:18:53.810
> 
> 标签：jquery

给定`$('<div><span>Foo</span></div><span>Bar</span>')`写 jquery 来选择跨度

这可以只用一个选择器来表达吗？

`$('<div><span>Foo</span></div><span>Bar</span>').filter('span')`会给你酒吧跨度

`$('<div><span>Foo</span></div><span>Bar</span>').find('span')`会给你 Foo 跨度

我两个都想要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:31:37.160

```
$('<div><span>Foo</span></div><span>Bar</span>')
    .children().addBack().filter('span') 
```

## 更新：

如果您仍在使用 1.8 之前的 jQuery 版本，您应该使用`andSelf`而不是`addBack`

# php - 如何在缩略图的框架中显示用户头像图片？

> ID：14886964
> 
> 赞同：1
> 
> 时间：2013-02-15T01:18:59.457
> 
> 标签：php, html, css

我网站上所有上传的图像在缩略图周围都有一个框架。我进行了设置，以便有空间在框架中显示用户的姓名和头像图片，以及他们上传的图片。希望这两张图片能更好地理解我要完成的工作 [链接到 imgur](http://imgur.com/a/myu3r)

我将其用于用户名和个人资料图片：

```
<?php if( $ib->user['id'] ) {?>
div class="userInfo">
<img class="avatar" width="40" height="40" src="<?php echo Config::$absolutePath.$ib->user['avatar']; ?>"/>
<div class="name">
    <strong>
        <a href="<?php echo Config::$absolutePath.'user/'.$ib->user['name']; ?>"><?php echo $ib->user['name']; ?></a>
    </strong>
</div> 
```

这对于上传周围的框架

```
#imageGrid div {
        position: absolute;
        overflow: hidden;
        border-radius: 0px;
  border: 1px solid #FFFFFF;
 padding: 60px 10px 10px 10px;
 moz-box-shadow:    3px 3px 5px 6px #ccc;
-webkit-box-shadow: 3px 3px 5px 6px #ccc;
 box-shadow:         3px 3px 5px 6px #a1a1a1;
 background-color: #dddddd; 
```

我不知道接下来应该尝试什么，所以我想看看我是否可以添加/组合 div，但这不起作用。

如果您需要更多信息、更好的描述或更多代码，请告诉我。在此先感谢，我对此很陌生，这是我坚持的一件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:32:44.427

您需要将它们放在控制其中内容布局的容器元素中，您可以使用 userInfo

```
<div class="userInfo">
<img class="avatar" width="40" height="40" src="<?php echo Config::$absolutePath.$ib-      >user['avatar']; ?>"/>
<div class="name">
<strong>
    <a href="<?php echo Config::$absolutePath.'user/'.$ib->user['name']; ?>"><?php echo $ib->user['name']; ?></a>
</strong>
</div>
</div>

.userInfo {
width:50px;
 }

.avatar {
width:40px;
}

.name {
width:40px;
 } 
```

至于#imageGrid div，我将删除其中的大部分内容并将其应用于我在上面添加的特定CSS类。

# magento - 如何在主题文件中回显 Magento 元标记

> ID：14886965
> 
> 赞同：0
> 
> 时间：2013-02-15T01:19:28.740
> 
> 标签：magento, magento-1.4

我有一个客户端请求独立的 H1 标签，这些标签可能与 Magento 中自动生成的页面标题不同，即通常这些是类别名称、页面标题、产品标题等。

由于在 Magento 后端没有此字段，我认为最好的替代方法是如果用户将自定义 H1 放在元标记字段中，然后如果存在，我将这些数据拉到主题文件中，如果不存在则显示标准标题.

例如在：/app/design/frontend/base/default/template/catalog/category/view.phtml

我们有：

```
<h1><?php echo $_helper->categoryAttribute($_category, $_category->getName(), 'name') ?></h1> 
```

我的想法是使用默认的元关键字头标签，并有这样的东西：

如果这不是空的，请显示它

```
<?php echo htmlspecialchars($this->getKeywords()) ?> 
```

否则显示默认标题

```
<?php echo $_helper->categoryAttribute($_category, $_category->getName(), 'name') ?> 
```

问题是`<?php echo htmlspecialchars($this->getKeywords()) ?>`放置在其默认的 head.phtml 模板之外时不显示任何内容。

任何人都知道如何在 Magneto 的任何主题文件中获取元关键字？

Magento 版本。1.4.1.1

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T16:46:53.150

尝试使用以下内容：

```
$keyWords = Mage::getStoreConfig('design/head/default_keywords') 
```

这将确保加载关键字。如果您查看`app/code/core/Mage/Page/Block/Html/Head.php`，您会发现该函数`getKeywords()`呈现相同的结果（无论是缓存关键字）。

# python - 如何使 u1-publish-folder (Ubuntu One) 递归到每个文件夹

> ID：14886969
> 
> 赞同：0
> 
> 时间：2013-02-15T01:20:14.510
> 
> 标签：python

如何将此扩展到目标文件夹中的每个文件夹？你知道递归到所有子文件夹中的每个文件。

[http://bazaar.launchpad.net/~sil/+junk/utility-programs/view/head:/u1-publish-folder](http://bazaar.launchpad.net/~sil/+junk/utility-programs/view/head:/u1-publish-folder)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T14:15:25.867

如果我正确理解了脚本和您的问题，您可以使用这样的 bash 行：

```
find /path/to/target-folder -type d -exec u1-publish-folder '{}' ';' 
```

这将递归地找到目标文件夹下的所有文件夹并为它们调用 u1-publish-folder。
（但不包括目标文件夹，您必须为该文件夹调用一次）
如果您明确不希望脚本自行执行递归，请编辑您的问题 - 好吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T14:38:11.877

如果您真的想修改脚本，则可以选择像这样编辑底部：（
是的，很抱歉重复发布，但这可以让它更干净）

```
if __name__ == '__main__':
    if len(sys.argv) > 1:
        folder = sys.argv[1]
    else:
        print "Syntax: %s folder" % sys.argv[0]
        sys.exit(1)
    folder = os.path.realpath(folder)
    if not os.path.isdir(folder):
        print "%s is not a folder. Terminating." % (folder,)
        sys.exit(1)
    # walk all directories inside `folder`
    for (dirname, subdirs, files) in os.walk(folder):
        subdir = os.path.realpath(dirname)
        if not os.path.isdir(subdir):
            continue
        reactor.callWhenRunning(process_folder, subdir)
        reactor.run() 
```

This should do the same as my bash-based answer but with a simple call of *u1-publish-folder target-folder*.

# javascript - 除以 1 javascript 的目的

> ID：14886970
> 
> 赞同：7
> 
> 时间：2013-02-15T01:20:17.140
> 
> 标签：javascript, html, math

我正在做老师给我们的一个简单的编程练习，我多次注意到在 Javascript 中，我必须将一个数字除以 1，否则它会返回一个荒谬的值。有什么解释吗？我有一个 jsfiddle [http://jsfiddle.net/TpNay/1/](http://jsfiddle.net/TpNay/1/)

`var widthrand=Math.floor(Math.random()*widthRange); width=widthrand + document.getElementById('width').value/1;`

如果您查看第 22 行，然后除以 1，然后单击生成，它将返回荒谬的长度谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T01:21:22.920

它使 JavaScript 类型杂耍迫使 的值`document.getElementById('width').value`变为数字。

更好的方法是`parseInt(document.getElementById('width').value, 10)`

# c++ - 函数声明中模板关键字的含义

> ID：14886971
> 
> 赞同：-2
> 
> 时间：2013-02-15T01:20:20.130
> 
> 标签：c++, templates, function-declaration, template-function

“在函数声明中使用模板关键字”是什么意思？

在此示例中，编译器错误并出现错误：“func”不是模板函数。

```
template<typename T>
struct Window {
  T value;
};

template void func(Window<int>, int);

template<typename T>
void func(Window<T>, T) {
}

int main(void) {
} 
```

但下面的例子是好的。

```
template<typename T>
struct Window {
  T value;
};

template<typename T>
void func(Window<T>, T) {
}

template void func(Window<int>, int);

int main(void) {
} 
```

在上述情况下，“模板”是什么意思？它只是表明这个函数是模板函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:50:38.917

这只是因为在您的第一个示例中，您有模板的定义

```
template<typename T>
 void func(Window<T>, T) {
} 
```

在此行表示的强制实例化之后：

```
template void func(Window<int>, int); 
```

而在第二个示例中，它们是正确的方法。

但是对您的问题的评论是公平的，您问的是一个基本问题（“模板是什么意思”），最好通过对该主题的彻底研究来回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T03:12:13.143

以关键字开头`template`并且后面没有`<`尖括号`>`的声明称为显式实例化。这意味着查找模板定义并插入指定的模板参数以获得特定的函数特化或类特化。所以在第一个例子中，编译器抱怨它无法实例化`func(Window<int>, int)`，因为它还不知道关于名为`func`.

通常不需要显式实例化，因为模板可以通过尝试使用它们来隐式实例化。但是显式实例化可以控制相关链接器符号出现的位置和方式，并且在某些情况下可用于将模板定义从头文件移到源文件中。

# javascript - Pathjs 路由问题

> ID：14886973
> 
> 赞同：1
> 
> 时间：2013-02-15T01:20:53.963
> 
> 标签：javascript, jquery, html, html5-history, path.js

我有这条路线：

```
Path.map("/(:page_1)(/:page_2)/").to(funct); 
```

它不匹配

```
/projects/index2/ 
```

它匹配`/anything`但不匹配`/anything/anything`

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T13:55:07.360

尝试仅将第二个可选值包含在括号中。所以，而不是这样做：

```
Path.map("#/(:page_1)(/:page_2)/").to(funct); 
```

尝试：

```
Path.map("#/:page_1(/:page_2)").to(funct); 
```

看看这个 jsfiddle：http: [//jsfiddle.net/Jkeq9/1/](http://jsfiddle.net/Jkeq9/1/)

# c++ - 使用 VJSON 解析 C++ 中的 FB 好友列表，遇到内存问题，我该如何解决？

> ID：14886974
> 
> 赞同：0
> 
> 时间：2013-02-15T01:20:54.607
> 
> 标签：c++, parsing, pointers, malloc, xcode4.5

我正在开发一个项目，该项目以 JSON 格式获取您的 Facebook 好友列表，对其进行解析，并将其加载到某些数据结构中。

在这种情况下，我将其放入 arrayList 中。我正在使用我们的教授在网上找到并建议我们使用的库，称为[VJSON](http://code.google.com/p/vjson/)。我只是计算机工程专业的二年级学生，所以那些图书馆里的大部分东西都在我头上，和班上的其他人一样。然而，他建议我们无论如何都要使用它。

VJSON 类解析 JSON 文本文件并将其存储在 javascript 对象中。您可以从“根”开始访问这些对象，然后以链表样式格式访问每个下一个对象。

我已将用于收集变量的方法放在下面。我们的教授还为我们提供了直到 for 循环的所有内容。如您所见，在 for 循环的底部，我创建了一个人并将其放入我的 arrayList 中，它工作正常。然而，在成功创建、存储和打印大约 14 个人之后，它突然遇到了运行时错误。

我在 xCode 中运行了该项目，这是它给我的错误：

```
Project2(4244) malloc: *** error for object 0x100103c18: incorrect checksum for freed object - object was probably modified after being freed.
 *** set a breakpoint in malloc_error_break to debug 
```

显然，我可以说这是某种内存管理问题，但除此之外没有太多。我不知道为什么要释放任何对象；如果它以某种方式被释放，为什么其他任何一个都没有被释放？此外，我尝试使用朋友的朋友列表，使用备用文本文件运行我的项目。在遇到同样的错误之前，它设法通过了大约 30 人；为什么他的朋友比我的朋友多？

任何帮助将不胜感激！这个 VJSON 的东西真的超出了我的想象。谢谢！

```
arrayList createArrayList(string filename){
    arrayList people;

    ifstream fileInput(filename);

    //turn input stream into string

    // Black magic to turn input stream into string.  Remember to include streambuf header
    // This string constructor accepts an iterator to the start of the file input stream
    // and another one that represents the end of input character (which is supplied by calling the default constructor of the iterator).
    string inputStr((istreambuf_iterator<char>(fileInput)), istreambuf_iterator<char>());

    //parse file content into json object
    char *errorPos = 0;
    char *errorDesc = 0;
    int errorLine = 0;
    block_allocator allocator(1 << 10);

    json_value *root = json_parse(const_cast<char*>(inputStr.c_str()), &errorPos, &errorDesc, &errorLine, &allocator);

    //get the first element, data, this value is an array of JSON objects (people)
    json_value *list = root->first_child;

    //This outer loop addresses each person's JSON object
    for(json_value *it = list->first_child; it; it = it->next_sibling){
        //This inner loop looks at each key/value pair within each person object
        string first_name, last_name, birthday, hometownID, hometown, personIDstr;
        for(json_value *personKeys = it->first_child; personKeys; personKeys = personKeys->next_sibling){
            //If the key/value pair has a key of "first_name" collect value associated
            if(!string(personKeys->name).compare("first_name")){
                first_name = personKeys->string_value;

            }
            //collect last name
            else if(!string(personKeys->name).compare("last_name")){
                last_name = personKeys->string_value;
            }
            //collect birthday
            else if(!string(personKeys->name).compare("birthday")){
                birthday = personKeys->string_value;
                //trim bday to first five characters
                birthday = birthday.substr(0,5);
            }
            //collect hometown
            else if(!string(personKeys->name).compare("hometown")){
                for(json_value *homeKeys = personKeys->first_child; homeKeys; homeKeys = homeKeys->next_sibling){

                    if(!string(homeKeys->name).compare("id")){
                        hometownID = homeKeys->string_value;
                    }

                    if(!string(homeKeys->name).compare("name")){
                        hometown = homeKeys->string_value;
                    }
                }
            }
            else if(!string(personKeys->name).compare("id")){
                personIDstr = personKeys->string_value;
            }
            //create person object based on which values are included

        }

        Person person(birthday, first_name, last_name, hometown, 0);
        cout << person << endl;
        people.insert(people.size(), person);
        cout << people.get(people.size()-1) << endl;
    }
    return people;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T16:44:17.307

来自[https://code.google.com/p/vjson/](https://code.google.com/p/vjson/)

> 警告：vjson 是破坏性解析器，即您的源缓冲区将被修改。

我认为这可能会在释放时导致错误`inputStr`。

# c++ - 修改 .ui 文件需要 `make clean`

> ID：14886987
> 
> 赞同：6
> 
> 时间：2013-02-15T01:22:11.590
> 
> 标签：c++, qt

**问题**：当 QMainWindow 或 QDialog 的相应 .ui 文件在 Qt Designer 中被更改时，必须清理并重建整个项目才能使这些更改生效：`make clean`然后`make`. 如果没有先清理项目，则更改不会反映在可执行文件中。

**项目结构**：

```
./
    project.pro
./include/
    MainWindow.h
    Main.h
./src/
    MainWindow.cpp
    Main.cpp
./ui/
    MainWindow.ui 
```

**来源**：

主窗口.h：

```
#include <QMainWindow>
#include "ui_MainWindow.h"

class MainWindow : public QMainWindow, private Ui::MainWindow
{
    Q_OBJECT
    public:

    MainWindow();
}; 
```

主窗口.cpp：

```
#include "MainWindow.h"

MainWindow::MainWindow()
{
    Ui::MainWindow::setupUi(this);
} 
```

项目.pro：

```
TEMPLATE = app
CONFIG -= debug release
CONFIG += qt debug_and_release warn_on incremental flat link_prl embed_manifest_dll embed_manifest_exe
QT += xml xmlpatterns

INCLUDEPATH += include/
UI_DIR = include/

FORMS += ui/MainWindow.ui
HEADERS += include/MainWindow.h include/Main.h
SOURCES += src/MainWindow.cpp src/Main.cpp 
```

注意：为简洁起见，包括警卫和班级成员已被删除。

**更新**：

假设我们在 Designer 中编辑 MainWindow.ui，保存它并运行 a `make`，将执行以下 shell 命令（在 Windows 平台上；同样的命令也在 'nix 框上执行）：

```
QTDIR\bin\uic.exe ui\MainWindow.ui -o include\ui_MainWindow.h
QTDIR\bin\moc.exe ... include\MainWindow.h -o build\moc\moc_MainWindow.cpp
MSVS\bin\cl.exe /c ... -Fobuild\obj\ moc_MainWindow.cpp 
MSVS\bin\link.exe ... /OUT:bin\target.exe 
```

标`uic`头生成器已运行，并且窗口已被移动。尽管如此，该窗口在可执行文件中保持不变。

**更新#2**：

我在 Makefile 中找到了这些行：

```
####### Compile

build\obj\MainWindow.obj: src\MainWindow.cpp

build\obj\main.obj: src\main.cpp

build\obj\moc_MainWindow.obj: build\moc\moc_MainWindow.cpp 
```

答对了。`MainWindow.obj`理所当然地依赖于`MainWindow.cpp`，但不依赖于`moc_MainWindow.cpp`。更改第一行以`build\obj\MainWindow.obj: src\MainWindow.cpp build\moc\moc_MainWindow.cpp`纠正整个问题。

**但是**：下次我运行`qmake`它会阻止我。我可以在 qmake 中输入什么来永久修复此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:08:59.600

我相信您的 UI_DIR 应该设置为 ui，而不是包含。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T15:12:48.637

有趣的是，您从配置中删除了“release”和“debug”，然后将“debug_and_release”添加到配置中。运行 debug_and_release 会添加这两个配置，但会在 CONFIG 中交换它们的顺序。

听起来这不会触发您看到的依赖问题，但就我而言，值得一试。

顺便说一句，您可以随时尝试 qmake，而不会破坏您的 Makefile。只需运行“qmake -o Makefile.foo”，它就会将其保存到另一个文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-29T13:56:01.997

我一直在努力解决这样的问题并发现，`DEPENDPATH`需要用生成的文件/项目头指向所有目录。否则 qmake 可能会在 Makefile 中生成依赖项时跳过一些头文件。尝试添加`DEPENDPATH += include`您的 .pro 文件

# iphone - 使用自定义动画推送视图控制器

> ID：14886990
> 
> 赞同：3
> 
> 时间：2013-02-15T01:22:42.057
> 
> 标签：iphone, objective-c, pushviewcontroller

是否可以制作像图像一样的自定义推送视图控制器动画？基本思想是正常推送视图，但不移动当前视图（调用`pushViewController...`）。

![前任](../Images/831ea79faabacb1568d193d61ed27cdd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:11:44.947

当然，这是可以做到的。我做了一个项目，我这样做是这样的：

```
-(void)slideInController:(RDSlideController *) next {
    next.presentingVC = self;
    next.view.frame = CGRectMake(self.view.frame.origin.x + 320, self.view.frame.origin.y, self.view.frame.size.width, self.view.frame.size.height);
    [self.view.window addSubview:next.view];
    [UIView animateWithDuration:slideTime animations:^{
        next.view.frame = self.view.frame;
    } completion:^(BOOL finished) {
        self.view.window.rootViewController = next;
    }];
} 
```

我滑入的视图控制器是 RDSlideController 的子类（因此我可以拥有 presentingVC 属性和其他一些东西），但这并不是必需的。基本上，您只需实例化新控制器，将其视图的框架设置为右侧的屏幕外，将该视图添加到窗口，然后将框架动画到当前视图的框架。最后，切换视图控制器，使新的视图控制器成为窗口的根视图控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T05:56:34.133

我们可以通过添加我们想要添加的子视图和动画视图来实现这一点。当我们添加动画以将下一个视图从左边缘移动到右边缘时。反之亦然，删除视图。

# jquery - .on() 绑定在 trigger('create') 后不起作用

> ID：14886992
> 
> 赞同：2
> 
> 时间：2013-02-15T01:22:59.103
> 
> 标签：jquery, jquery-mobile

在我正在构建的 JQM (1.3.0) 应用程序中，我使用“on”将所有提交按钮绑定到单击事件，目的是现在和将来的所有提交按钮都将绑定此事件。我在 $(document).ready() 中进行这些绑定，因为我认为它只需要被调用一次......永远。

我用一些内容更新了一个 JQM[面板](http://jquerymobile.com/demos/1.3.0-rc.1/docs/panels/index.html)，并在该内容上调用 .trigger('create')。应该发生的是，新创建的提交按钮在单击时*应该*触发绑定的单击事件，但事实并非如此。

这是一个[小提琴](http://jsfiddle.net/C2y7P/)，展示了我正在努力实现的目标。在演示中，每当您单击提交按钮时，消息框都应显示“已单击”......不幸的是，它只发生在第一个元素上。

```
$(function(){
    $('input[type="submit"]').on('click', function(e){
        $('#msg').append('<div>Clicked</div>');
        $('#panel').html('<input type="submit" value="New Button">').trigger('create');
    });
}); 
```

我在这里错误地使用了 .on() 吗？我想我可以将我所有的绑定填充到一个函数中，然后在调用 .trigger('create') 时调用该函数......但这似乎效率低下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:26:32.667

你需要

```
$('#someParentElement').on('click', 'input[type="submit"]', function(e){
   //handler
}); 
```

你拥有它的方式相当于旧的

```
$('input[type="submit"]').bind('click', function(e){
   //handler
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T01:29:40.453

[使用.on](http://api.jquery.com/on/)方法绑定事件有两种方法。一种是使用事件委托，它将事件绑定到*更高*级别的元素（一直到`document`必要时，但*越接近*越好），然后当事件冒泡时，它会监听它，如果它匹配传入的选择器它着火了。第二种使用方式`.on`是将其直接绑定到元素而不使用委托。

您正在使用第二种版本的`.on`方式，但您想要的是使用第一种（委托版本）。

例如，代替您当前的代码，您将执行以下操作

```
$(function(){
    $('#someParentElement').on('click','input[type="submit"]', function(e){
        $('#msg').append('<div>Clicked</div>');
        $('#panel').html('<input type="submit" value="New Button">').trigger('create');
    });
}); 
```

# java - ListView onClick 出现问题

> ID：14886995
> 
> 赞同：0
> 
> 时间：2013-02-15T01:23:07.510
> 
> 标签：java, android, listview, onclick, adapter

我有一个包含在片段中的 ListView。当在列表视图上单击一个项目时，我希望它执行一些代码，但执行的代码取决于单击列表上的哪个项目。这是包含 ListView 的片段的代码：

```
public class ListViewer extends Fragment {
private ListView list;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInsanceState) {
    View v = inflater.inflate(R.layout.activity_list_view, container, false);

    Player player_data[] = new Player[] {
        new Player(R.drawable.bschenn1, "Brayden Schenn", "Age: 21, Drafted 5th overall by LA King in 2009",  "Center - #10"),  
        new Player(R.drawable.giroux, "Claude Giroux", "Age: 25, Drafted 22nd overall by Philadelphia Flyers in 2006", "Center - #28"),
        new Player(R.drawable.hartnell, "Scott Hartnell", "Age: 30, Drafted 6th overall by Nashville Predators in 2000", "Left Wing - #19")
    };

    PlayerAdapter adapter = new PlayerAdapter(getActivity(), R.layout.list_row, player_data);

    list = (ListView)v.findViewById(R.id.list);

    View header = (View)inflater.inflate(R.layout.listview_header_row, null);

    list.addHeaderView(header);
    list.setAdapter(adapter);

    return v;
}
} 
```

这是适配器的代码：

```
public class PlayerAdapter extends ArrayAdapter<Player> {
Context context;
int layoutResourceId;
Player data[] = null;

public PlayerAdapter(Context context, int layoutResourceId, Player[] data) {
    super(context, layoutResourceId, data);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = data;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    PlayerHolder holder = null;

    if (row == null) {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new PlayerHolder();
        holder.imageIcon = (ImageView)row.findViewById(R.id.list_image);
        holder.txtplayerName = (TextView)row.findViewById(R.id.title);
        holder.txtageDraft = (TextView)row.findViewById(R.id.artist);
        holder.txtpositionSNum = (TextView)row.findViewById(R.id.duration);

        row.setTag(holder);
    } else {
        holder = (PlayerHolder)row.getTag();
    }
     Player player = data[position];
     holder.imageIcon.setImageResource(player.image);
     holder.txtplayerName.setText(player.playerName);
     holder.txtageDraft.setText(player.ageDraft);
     holder.txtpositionSNum.setText(player.positionSweaterNum);

     return row;
}

static class PlayerHolder {
    ImageView imageIcon;
    TextView txtplayerName;
    TextView txtageDraft;
    TextView txtpositionSNum;
}

} 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T01:30:34.573

您应该向列表视图添加一个侦听器以检测触摸事件。

```
list.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() 
{
 public void onItemSelected(AdapterView parentView, View childView, int position, long id) 
 {
    //here you have the position so you can do whatever you want with this item

 }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:29:54.183

您需要将 OnItemClickListener 添加到列表对象：

```
list.setOnItemClickListener( new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        // TODO Auto-generated method stub  
        }
    });
} 
```

# c++ - GetDiskFreeSpaceEx 与 NULL 目录名称失败

> ID：14886996
> 
> 赞同：2
> 
> 时间：2013-02-15T01:23:09.890
> 
> 标签：c++, windows, winapi

我试图在我的 C++ win32 应用程序中使用 GetDiskFreeSpaceEx 来获取“当前”驱动器上的总可用字节数。我在 Windows 7 上。

我正在使用这个示例代码：http: [//support.microsoft.com/kb/231497](http://support.microsoft.com/kb/231497)

它有效！嗯，差不多。如果我提供驱动器，它会起作用，例如：

```
...

szDrive[0] = 'C'; // <-- specifying drive
szDrive[1] = ':';
szDrive[2] = '\\';
szDrive[3] = '\0';

pszDrive = szDrive;

...

fResult = pGetDiskFreeSpaceEx ((LPCTSTR)pszDrive,
        　　　                  (PULARGE_INTEGER)&i64FreeBytesToCaller,
        　　　                  (PULARGE_INTEGER)&i64TotalBytes,
                               (PULARGE_INTEGER)&i64FreeBytes); 
```

fResult 变为`true`，我可以继续准确计算可用的空闲字节数。

然而，问题是我希望不必指定驱动器，而只需使用“当前”驱动器。我在网上找到的文档（[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364937%28v=vs.85%29.aspx)）状态：

> *lpDirectoryName [输入，可选]*
> 
> 磁盘上的目录。如果此参数为**NULL**，则该函数使用当前磁盘的根。

但是，如果我为目录名称传入 NULL，则 GetDiskFreeSpaceEx 最终会返回`false`，并且数据仍然是垃圾。

```
fResult = pGetDiskFreeSpaceEx (NULL,
        　　　                  (PULARGE_INTEGER)&i64FreeBytesToCaller,
        　　　                  (PULARGE_INTEGER)&i64TotalBytes,
                               (PULARGE_INTEGER)&i64FreeBytes);

//fResult == false 
```

这很奇怪吗？我肯定错过了什么吗？任何帮助表示赞赏！

**编辑**

根据 JosephH 的评论，我进行了 GetLastError() 调用。它返回了 DWORD：

> **ERROR_INVALID_NAME 123 (0x7B)**
> 
> ```
>  The filename, directory name, or volume label syntax is incorrect. 
> ```

**第二次编辑**

埋在我提到的评论中：

> 我尝试了 GetCurrentDirectory 并返回正确的绝对路径，除了它的前缀`\\?\`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T10:03:57.550

> 它返回正确的绝对路径，除了它的前缀`\\?\`

这就是解开这个谜团的关键。你得到的是带有*原生 api*路径名的目录名。Windows 是一个操作系统，其内部看起来与您熟悉的 winapi 编程*非常不同。*Windows 内核有一个完全不同的 api，它与 DEC VMS 操作系统非常相似。并非巧合，大卫卡特勒曾经为 DEC 工作。在原生操作系统之上最初是三个 api 层，Win32、POSIX 和 OS/2。它们使将程序从其他操作系统移植到 Windows NT 变得容易。没有人关心 POSIX 和 OS/2 层，它们在 XP 时代被丢弃了。

Win32 中一个臭名昭著的限制是 MAX_PATH 的值，260。它设置存储文件路径名的 C 字符串的最大允许大小。本机 api 允许更大的名称，32000 个字符。您可以通过使用原生 api 格式的路径名绕过 Win32 限制。这与您熟悉的路径名称相同，但前缀为`\\?\`.

因此，您从 GetCurrentDirectory() 返回这样一个字符串的原因肯定是因为您当前的目录名称超过 259 个字符。进一步推断，GetDiskFreeSpaceEx() 失败是因为它有一个错误，它*拒绝*在您传递 NULL 时看到的长名称。可以理解的是，通常不会要求它处理长名称。每个人都只是传递驱动器名称。

当您创建具有如此长名称的目录时，这是相当典型的。东西只是开始随机掉落。一般来说，周围有*很多*使用 MAX_PATH 的 C 代码，当它必须处理比这更长的路径名时，该代码将失败。这也是一个非常可利用的问题，因为它能够在 C 程序中创建堆栈缓冲区溢出，从技术上讲，精心设计的文件名可用于操纵程序和注入恶意软件。

这个问题没有真正的解决方法，GetDiskFreeSpaceEx() 中的错误不会很快得到修复。删除那个目录，它会造成更多的麻烦，把它写下来作为学习经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:39:04.387

我很确定您必须检索当前驱动器和目录并将其传递给函数。我记得尝试`GetDiskFreeSpaceEx()`将目录名称用作`"."`，但这不起作用。

# spring - 子文档中的 SD MongoDB 多态性

> ID：14886999
> 
> 赞同：3
> 
> 时间：2013-02-15T01:23:30.227
> 
> 标签：spring, mongodb, polymorphism, spring-data-mongodb

我刚开始使用 spring-data-mongodb 用 Ja​​va 开发一些应用程序，遇到了一些我无法解决的问题：

有几个像这样的文档 bean：

```
@Document(collection="myBeanBar")
public class BarImpl implements Bar {
   String id;
   Foo foo;
   // More fields and methods ...
}

@Docuemnt
public class FooImpl implements Foo {
   String id;
   String someField;
   // some more fields and methods ...
} 
```

我有一个存储库类，它的方法简单地调用类似于这样的查找：

```
public List<? extends Bar> findByFooField(final String fieldValue) {
    Query query = Query.query(Criteria.where("foo.someField").is(fieldValue));
    return getMongoOperations().find(query, BarImpl.class);
} 
```

保存 Bar 效果很好，它会将它与 Foo 和 Bar 的“_class”属性一起保存在 mongo 中。但是，通过 Foo 中的某些属性查找会引发如下异常：

```
Exception in thread "main" java.lang.IllegalArgumentException: No property someField found on test.Foo!
    at org.springframework.data.mapping.context.AbstractMappingContext.getPersistentPropertyPath(AbstractMappingContext.java:225)
    at org.springframework.data.mongodb.core.convert.QueryMapper.getPath(QueryMapper.java:202)
    at org.springframework.data.mongodb.core.convert.QueryMapper.getTargetProperty(QueryMapper.java:190)
    at org.springframework.data.mongodb.core.convert.QueryMapper.getMappedObject(QueryMapper.java:86)
    at org.springframework.data.mongodb.core.MongoTemplate.doFind(MongoTemplate.java:1336)
    at org.springframework.data.mongodb.core.MongoTemplate.doFind(MongoTemplate.java:1322)
    at org.springframework.data.mongodb.core.MongoTemplate.find(MongoTemplate.java:495)
    at org.springframework.data.mongodb.core.MongoTemplate.find(MongoTemplate.java:486) 
```

经过一番挖掘，这是有道理的，因为查询中没有指定子文档的具体类型，并且 Bar 的实体信息说 foo 的类型是 Foo（不是 FooImpl），而后者又不能具有属性因为它是一个接口。

我的问题是：有没有办法在不将子文档类型声明为具体类型的情况下指定它或解决这个问题？

我已经在谷歌上搜索了几天，查看了文档和 API 以及源代码，但我找不到明确的方法。我真的很感谢你的帮助。

非常感谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T13:35:30.730

我有一个类似的问题，我有一个实现接口的类，当我使用时`findAll`出现错误：

> org.springframework.data.mapping.model.MappingInstantiationException：无法实例化bean类[test.MetaClasse]：指定的类是一个接口。

调试`SpringData`代码后，我意识到 Mapper`@TypeAlias`用来发现它必须实例化的类型，所以我只是把`@TypeAlias("FullClassName")`我的实现放到了`test.MetaClasse`它的工作上！

我测试了你的情况，它会起作用的！