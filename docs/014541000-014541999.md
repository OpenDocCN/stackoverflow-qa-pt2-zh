# StackOverflow 问答 14541000-14541999

# css - 两个 CSS 列 - 当宽度缩小时，右侧列进入左侧列的底部

> ID：14541002
> 
> 赞同：1
> 
> 时间：2013-01-26T19:58:21.657
> 
> 标签：css, css-float

在左侧，我们有一个上下文相关的导航/信息栏。有时其中的信息很少，有时它会占据页面的整个高度。我在其他帖子上看到了很多关于浮动等的建议，但我没有尝试过任何工作。

```
.tablebox {float:left;position:relative;z-index:1;border-right:1px solid #000000;}
.groupbox {float:left;position:relative;z-index:-1;border-right:1px solid #000000;} 
```

所以侧边栏有两个 div - 一个用于创建背景层，它将占据页面的整个高度，然后是带有实际内容的表格框 - 它可以根据需要具有不同的背景颜色。

```
<div class="tablebox" style="margin-top:5px;width:247px;">Sidebar</div>
<div class="groupbox" style="width:247px;background-color:#FFFFFF;top:120px;bottom:0;left:0px;"></div> 
```

然后我们有右侧的主要内容......再次的想法是tablebox将有不同的背景颜色并且看起来漂浮在页面顶部。

```
<div class="tablebox" style="margin-top:5px;width:777px;">Main content</div>
<div class="groupbox" style="width:777px;top:120px;bottom:0;left:247px;"></div> 
```

现在，如果浏览器宽度变得太小，右侧的 div 会低于侧边栏。不管那里有没有空间。

**解决方案：** 问题是两组 div 的父级没有定义的大小。随着浏览器窗口大小的调整，孩子们被洗牌以适应新的大小。通过定义一个具有固定宽度的父 div 并添加一个 overflow:auto ，即使浏览器窗口是，父级也不会改变。

注意：这显然不是解决此问题的最佳方法 - 这意味着内容不会动态格式化自身。它现在有一个固定的宽度。就我而言，我别无选择。这是一种创可贴解决方案，但如果您处于设计阶段，请考虑使用手机查看您页面的人或使用低分辨率屏幕和大文本的老年人。

对于那些容易混淆的人来说清楚：

```
<div style="width:1053px;overflow:auto">
<div class="tablebox" style="margin-top:5px;width:247px;">Sidebar</div>
<div class="groupbox" style="width:247px;background-color:#FFFFFF;top:120px;bottom:0;left:0px;"></div>
<div class="tablebox" style="margin-top:5px;width:777px;">Main content</div>
<div class="groupbox" style="width:777px;top:120px;bottom:0;left:247px;"></div>
</div> 
```

但同样 - 如果您有选择，请不要这样做！固定宽度不会使您的网站在某些设备上非常漂亮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:11:30.603

```
<head>
    <style>
        body {
            padding:0;
            margin:0;
        }
        div {
            width:25%;
            height:25%;
        }
        div.left {
            background-color:red;
            float:left;
        }
        div.right {
            background-color:yellow;
            float:right;
        }
    </style>
</head>
<body>
    <div class="left"></div>
    <div class="right"></div>
</body> 
```

[http://jsfiddle.net/8gNDU/2/](http://jsfiddle.net/8gNDU/2/)

# python - Python 的函数 readlines(n) 行为

> ID：14541010
> 
> 赞同：15
> 
> 时间：2013-01-26T19:58:51.980
> 
> 标签：python, python-2.7

我已经阅读[**了文档**](http://docs.python.org/2/tutorial/inputoutput.html#methods-of-file-objects)，但是 readlines(n) 是做什么的？通过 readlines(n)，我的意思是 readlines(3) 或任何其他数字。

当我运行 readlines(3) 时，它返回与 readlines() 相同的内容。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-26T20:00:54.083

可选参数应该表示从文件中读取了多少（大约）字节。该文件将被进一步读取，直到当前行结束：

```
readlines([size]) -> list of strings, each a line from the file.

Call readline() repeatedly and return a list of the lines so read.
The optional size argument, if given, is an approximate bound on the
total number of bytes in the lines returned. 
```

另一个引用：

> 如果给定一个可选参数*sizehint*，它会从文件中读取那么多字节以及足够多的字节来完成一行，并从中返回这些行。

没错，它似乎对小文件没有多大作用，这很有趣：

```
In [1]: open('hello').readlines()
Out[1]: ['Hello\n', 'there\n', '!\n']

In [2]: open('hello').readlines(2)
Out[2]: ['Hello\n', 'there\n', '!\n'] 
```

有人可能会认为它是由文档中的以下短语解释的：

> 使用 readline() 读取直到 EOF 并返回包含如此读取的行的列表。如果存在可选的 sizehint 参数，而不是读取到 EOF，而是读取总计大约 sizehint 字节的整行**（可能在四舍五入到内部缓冲区大小之后）**。如果 sizehint 无法实现或无法有效实现，则实现类文件接口的对象可能会选择忽略它。

但是，即使我尝试在没有缓冲的情况下读取文件，它似乎也没有改变任何东西，这意味着其他类型的内部缓冲区是指：

```
In [4]: open('hello', 'r', 0).readlines(2)
Out[4]: ['Hello\n', 'there\n', '!\n'] 
```

在我的系统上，这个内部缓冲区大小似乎约为 5k 字节/1.7k 行：

```
In [1]: len(open('hello', 'r', 0).readlines(5))
Out[1]: 1756

In [2]: len(open('hello', 'r', 0).readlines())
Out[2]: 28080 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-19T01:06:24.907

> 它列出了**行**，给定字符大小“n”从当前行开始跨越这些行。

例如：在一个*`text`*文件中，内容为

```
one
two
three
four 
```

`open('text').readlines(0)`返回`['one\n', 'two\n', 'three\n', 'four\n']`

`open('text').readlines(1)`返回`['one\n']`

`open('text').readlines(3)`返回`['one\n']`

`open('text').readlines(4)`返回`['one\n', 'two\n']`

`open('text').readlines(7)`返回`['one\n', 'two\n']`

`open('text').readlines(8)`返回`['one\n', 'two\n', 'three\n']`

`open('text').readlines(100)`返回`['one\n', 'two\n', 'three\n', 'four\n']`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:02:38.600

根据文件的大小， readlines(hint) 应该返回一组较小的行。从文档中：

```
f.readlines() returns a list containing all the lines of data in the file. 
If given an optional parameter sizehint, it reads that many bytes from the file 
and enough more to complete a line, and returns the lines from that. 
This is often used to allow efficient reading of a large file by lines, 
but without having to load the entire file in memory. Only complete lines 
will be returned. 
```

因此，如果您的文件有 1000 行，您可以传入说... 65536，它一次只能读取那么多字节 + 足以完成下一行，返回所有已完全读取的行。

# c++ - 输出冗余

> ID：14541014
> 
> 赞同：0
> 
> 时间：2013-01-26T19:59:11.850
> 
> 标签：c++, cin

以下是一个实现 DFA（确定性有限自动机）的简单程序。但是，我的问题不涉及 DFA。

```
#include<iostream>
using namespace std;

int main()
{
    char c;
    int state=1;
    while((c=cin.get())!='4')
    {
        switch(state)
        {
            case 1:
            if(c=='0')
            state=2;
            if(c=='1')
            state=1;
            if(c=='2')
            state=2;

            break;

            case 2:
            if(c=='0')
            state=5;
            if(c=='1')
            state=1;
            if(c=='2')
            state=3;

            break;

            case 3:
            if(c=='0')
            state=1;
            if(c=='1')
            state=5;
            if(c=='2')
            state=4;

            break;

            case 4:
            if(c=='0')
            state=3;
            if(c=='1')
            state=4;
            if(c=='2')
            state=5;

            break;

            case 5:
            if(c=='0')
            state=5;
            if(c=='1')
            state=4;
            if(c=='2')
            state=1;

            break;

            default:
            cout<<"Input will not be accepted"<<endl;

        } //switch
        cout<<"Current state is "<<state<<endl; 
    } //while

    return 0;
} 
```

当我运行代码时，我发现每一行都被输出了两次。例如，当我输入 0 1 0 0 4 时，DFA 从状态 1->2->1->2->5 进入，因此输出应该是：

```
Current state is 2
Current state is 1
Current state is 2
Current state is 5 
```

但输出是：

```
Current state is 2
Current state is 2
Current state is 1
Current state is 1
Current state is 2
Current state is 2
Current state is 5
Current state is 5 
```

谁能指出原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T20:04:46.290

`cin.get()`读取一个字符，因此您也在读取空格。然后在每个空格之后，您的程序只会输出先前的状态，因为空格不匹配任何内容。你想`cin >> c`改用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T01:45:47.047

由于您显然不打算将代码发布到 CodeReview，所以让我发布一个替代方案，而不是我认为我会如何编写代码：

```
#include<iostream>
using namespace std;

static const int states[][3] = {
    { 2, 1, 2 },
    { 5, 1, 3 },
    { 1, 5, 4 },
    { 3, 4, 5 },
    { 5, 4, 1 }
};

int main()
{
    char c;
    int state=1;
    while(cin >> c && c != '4') {
        if (c >= '0' && c <= '2')
            state = states[state-1][c-'0'];
        else
            std::cout << "Input will not be accepted.\n";
        cout<<"Current state is "<<state<<"\n"; 
    }
    return 0;
} 
```

至少对我来说，这似乎更容易阅读和理解，更不用说将状态机本身与读取字符并根据输入遍历状态的代码分开。

# spring - 春季自动装配 byName

> ID：14541019
> 
> 赞同：0
> 
> 时间：2013-01-26T20:00:07.650
> 
> 标签：spring

我刚刚开始使用 Spring 并尝试按名称自动装配这是我的代码

地址类：

```
package org.springinaction;

public class Address {
    private String addressline;

    public String getAddressline() {
        return addressline;
    }

    public void setAddressline(String addressline) {
        this.addressline = addressline;
    }

} 
```

客户等级：

```
package org.springinaction;

public class Customer {
    private Address address;
    public Address getN() {
        return address;
    }

    public void setN(Address n) {
        this.address = n;
    }
} 
```

弹簧配置：

```
<beans>
  <bean id="customer" class="org.springinaction.Customer" autowire="byName" />

  <bean id="address" class="org.springinaction.Address">
    <property name="addressline" value="bangalore" />
  </bean>
</beans> 
```

客户测试.java

```
package org.springinaction;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class CustomerTest {
    public static void main(String[] args) {
        ApplicationContext context =new ClassPathXmlApplicationContext("SpringInAction.xml");
        Customer cust=(Customer)context.getBean("customer");
        System.out.println(cust.getN());
    }
} 
```

当我尝试按名称进行自动装配时，这表明如果属性名称与名称名称匹配，它将自动装配。但是在我的情况下它没有发生。它给了我null这个...任何人都可以帮我这个，以便正确地自动连接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:23:28.440

自动布线查找的“名称”是从 setter 方法的名称派生的 JavaBean 属性的名称，因此您的 Customer 类有一个名为`n`（来自`setN`方法）的属性，私有字段被命名的事实`address`是无关紧要的.

您需要使用 id 定义一个合适的 bean，`n`或者将 Customer 中的 getter 和 setter 更改为`getAddress`并`setAddress`匹配现有`address`bean 的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:20:01.667

将您的 getter 和 setter 更改为：

```
public Address getAddress() {
    return address;
}

public void setAddress(Address n) {
    this.address = n;
} 
```

根据[Java bean 约定](http://docs.oracle.com/javase/tutorial/javabeans/index.html)，您的 getter 和 setter 必须具有名称**get（或 set）+ 首字母大写的属性名称**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T16:30:08.140

如果您只想将您的 Customer bean 注入您的 Address bean，那么只需使用 @Autowired 注释，然后不需要 setter/getter：

```
<context:annotation-config /> // EDIT - think this required for autowiring

<bean id="customer" class="org.springinaction.Customer"/>

<bean id="address" class="org.springinaction.Address">
    <property name="addressline" value="bangalore" />
</bean>

public class Customer {
    @Autowired
    Address address;
.... 
```

有超过 1 个地址 bean？然后也使用@Qualifier：

```
<bean id="customer" class="org.springinaction.Customer"/>

<bean id="work-address" class="org.springinaction.Address">
    <property name="addressline" value="bangalore" />
</bean>

<bean id="home-address" class="org.springinaction.Address">
    <property name="addressline" value="bangalore" />
</bean>

public class Customer {
    @Autowired
    @Qualifier ( value = "work-address" )
    Address workAddress;

    @Autowired
    @Qualifier ( value = "home-address" )
    Address homeAddress;
.... 
```

# javascript - HTML5 地理定位精度 Android 与 iOS 非常不同

> ID：14541027
> 
> 赞同：2
> 
> 时间：2013-01-26T20:00:45.887
> 
> 标签：javascript, android, ios, html, geolocation

我注意到 HTC android 和 iPhone 4S 之间的区别。我用 watchLocation 测试了相同的 html5 脚本，HTC 上的准确度保持在 3 米，而 iPhone 从 5 米开始，1 分钟左右后爬升到 100 到 1000 米，再也没有靠近。

我在应用程序的 webView 中使用 html5 代码。

有人知道为什么吗？

编码：

```
trackId = navigator.geolocation.watchPosition(successCallback, null, {maximumAge:0, timeout:60000, enableHighAccuracy:true}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T12:41:05.283

好吧，花了几个小时，几乎几天后，我发现了这个：

[https://discussions.apple.com/thread/4313850?start=0&tstart=0](https://discussions.apple.com/thread/4313850?start=0&tstart=0)

[iOS 6 破坏了 webapps 中的 GeoLocation (apple-mobile-web-app-capable)](https://stackoverflow.com/questions/12503815/ios-6-breaks-geolocation-in-webapps-apple-mobile-web-app-capable/14410106#14410106)

所以，感谢苹果！

# visual-studio - 无法调试 Visual Studio 插件

> ID：14541031
> 
> 赞同：10
> 
> 时间：2013-01-26T20:01:10.653
> 
> 标签：visual-studio, visual-studio-2012, add-in, visual-studio-addins

问题说明了一切。我正在尝试编写一个 Visual Studio 插件（2012 年），并且实验实例总是启动而不在插件中运行任何东西。主实例中没有断点，实验实例也没有加载插件。

我应该指出：它曾经在某个时间工作过一次或两次，然后我删除了该项目，因为我认为它是错误的项目，但最终以相同的名称重新创建它。

再多的摆弄[“允许加载插件”](https://stackoverflow.com/questions/14000662/enabling-and-disabling-addin-components-to-load-while-debugging-visual-studio-20)或[重置实验实例](https://stackoverflow.com/questions/7294995/developing-multiple-visual-studio-2010-extensions)或[手动清理注册表](http://blogs.clariusconsulting.net/kzu/resetting-visual-studio-experimental-instance-to-its-super-clean-initial-state/)都无法解决问题。我也尝试[寻找我的插件 dll](https://stackoverflow.com/questions/2155930/fixing-the-breakpoint-will-not-currently-be-hit-no-symbols-have-been-loaded-fo)，但它不在列表中。我完全没有想法和可能的搜索词。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T14:09:05.360

我遇到了和你一样的问题，刚刚为我找到了修复，它与提供的加载项项目中的新“文件属性”条目有关。

如果你打开这个在我的例子中名为“[App Name] - For Testing.AddIn”的文件，你会看到包含诸如 AddIn 友好名称、描述等内容的 XML 标记

对我来说，我发现我立即重命名了我的项目的输出程序集，这不再匹配在此属性文件中找到的内容：

```
<Extensibility xmlns="http://schemas.microsoft.com/AutomationExtensibility">
<HostApplication>
    <Name>Microsoft Visual Studio</Name>
    <Version>11.0</Version>
</HostApplication>
<Addin>
    <FriendlyName>My Addin</FriendlyName>
    <Description>My Addin description.</Description>
    **<Assembly>E:\Workspaces\Scratch\MyApp\bin\MyApp.VisualStudio.Addin.dll</Assembly>
    <FullClassName>MyApp.VisualStudio.Addin.Connect</FullClassName>**
    <LoadBehavior>1</LoadBehavior>
    <CommandPreload>1</CommandPreload>
    <CommandLineSafe>0</CommandLineSafe>
</Addin> 
```

我检查了程序集的名称和类名，修复了它们，保存文件并点击调试，一切又开始工作了！希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T04:42:02.413

I had a similar problem... fought with it for quite a while, and eventually, absolutely randomly experimented with adding other configurations to the project (Configuration Manager) and also changing the framework.

One of the two magically helped. (I think it may have been the framework... though it makes no sense).

I am not saying that the same thing will work for you.

The random experiment was not really random: I got hold of a "debuggable" add-in off the web, and compared every single item in the project, solution and all other files, to find what could be different. This is my true suggestion.

If all else fails, you can also try to manually attach the debugger, see if you can make headway this way. [ that did not work for me, but it may provide valuable information, and... not all bugs are created the same. ]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-08T04:06:52.250

我有同样的问题。调试一直有效，直到我关闭了 Visual Studio 的所有实例。然后我再次打开 Visual Studio，它说我一直在调试的加载项已经停止工作。当 Visual Studio 询问是否要删除它时，我说是的。

显然，删除此射线中的加载项会将“[AppName] - For Testing.AddIn”文件重命名为附加下划线。

要解决此问题，请进入加载项解决方案并查看“[AppName] - For Testing.AddIn”文件中的属性。转到文件所在的文件夹。在文件系统中重命名此文件以匹配 Visual Studio 中的文件名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-06T00:01:26.120

似乎这个问题有不同的解决方案，但这最终帮助了我：

1.  在 AddIn 文件中更改`<LoadBehavior>1</LoadBehavior>`为`<LoadBehavior>0</LoadBehavior>`并手动将其放入*C:\Users[UserName]\Documents\Visual Studio 2012\Addins*
2.  重新启动 Visual Studio（我使用 2012）

完整的插件文件：

```
<?xml version="1.0" encoding="UTF-16" standalone="no"?>
<Extensibility xmlns="http://schemas.microsoft.com/AutomationExtensibility">
    <HostApplication>
        <Name>Microsoft Visual Studio</Name>
        <Version>11.0</Version>
    </HostApplication>
    <Addin>
        <FriendlyName>[Friendly Assembly Name]</FriendlyName>
        <Description>[Description of the Addin]</Description>
        <AboutBoxDetails>[About details]</AboutBoxDetails>
        <Assembly>[Full path to the binary e.g. C:\Test\debug\test.dll]</Assembly>
        <FullClassName>Test.Connect</FullClassName>
        <LoadBehavior>0</LoadBehavior>
        <CommandPreload>1</CommandPreload>
        <CommandLineSafe>0</CommandLineSafe>
    </Addin>
</Extensibility> 
```

在我的情况下，我转移到另一台开发人员机器上，它以前在旧机器上工作，但在新机器上我没有任何“[Assembly Name] - For Testing.AddIn”，因为我没有费心检查它在。我认为 LoadBehavior 是*For Testing*和常规 AddIn之间的区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-19T16:15:17.827

就我而言，Resharper 是原因。禁用 Resharper 后一切恢复正常。

# python - Python交替输入输出

> ID：14541033
> 
> 赞同：0
> 
> 时间：2013-01-26T20:01:16.833
> 
> 标签：python, command-line-arguments, sys

我正在尝试编写一个“游戏”，用户输入一个动作，“cpu 播放器”输出它的响应，之后用户输入另一个动作，依此类推。例如

> $ 输入一个移动 #cpu 提示
> 
> 5 #用户输入
> 
> 7 #cpu 输出
> 
> 10 #用户输入
> 
> 16 #cpu 输出
> 
> 20 #用户输入
> 
> 你赢了！#cpu的输出
> 
> $

我知道 sys.argv 如何在命令行上提供参数列表，但是我将使用什么来让我的程序读取每个输入行并输出用户输入另一个参数的值？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:13:52.133

看看Python 中内置的[raw_input()函数。](http://docs.python.org/2/library/functions.html?highlight=raw_input#raw_input)那应该完全符合您的喜好。

```
playermove=raw_input() 
```

# c# - 代码后面的拼写检查类

> ID：14541038
> 
> 赞同：3
> 
> 时间：2013-01-26T20:01:36.030
> 
> 标签：c#, .net, spell-checking

有没有办法检查代码后面的拼写？

我只能找到如何将它与 UI 控件一起使用

```
<TextBox SpellCheck.IsEnabled="True" Height="20" Width="100"/> 
```

我想要的是`boolean CheckSpell(string word)`

我什至不需要建议的拼写。

这将用于确定文本文件中正确拼写单词的百分比。
具有真正低数字的文本文件可能不适合人类消费。

该应用程序具有 SQL 后端，因此可以选择加载英语词典中的单词列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:48:51.787

要解决您的问题，您可以使用[NHunspell](http://nhunspell.sourceforge.net)库。

在这种情况下，您的检查方法非常简单，如下所示：

```
bool CheckSpell(string word)
{         
    using (Hunspell hunspell = new Hunspell("en_GB.aff", "en_GB.dic"))
    {
        return hunspell.Spell(word);               
    }
} 
```

[你可以在这个网站](http://wiki.openoffice.org/wiki/Dictionaries)上找到字典。

你也可以使用[`SpellCheck`](http://msdn.microsoft.com/en-us/library/system.windows.controls.spellcheck.aspx)类：

```
bool CheckSpell(string word)
{
    TextBox tb = new TextBox();
    tb.Text = word;
    tb.SpellCheck.IsEnabled = true;

    int index = tb.GetNextSpellingErrorCharacterIndex(0, LogicalDirection.Forward);
    if (index == -1)
        return true;
    else
        return false;
} 
```

# c# - 带有 2 个表的最新记录并采取/跳过

> ID：14541039
> 
> 赞同：3
> 
> 时间：2013-01-26T20:01:52.437
> 
> 标签：c#, sql, linq, sql-server-2008, join

我想做的基本上是这个问题提供的内容：[SQL Server - 如何根据两个表中的日期显示最近的记录](https://stackoverflow.com/questions/7988800/sql-server-how-to-display-most-recent-records-based-on-dates-in-two-tables?rq=1)..唯一的区别是：我使用的是 Linq to sql。

我必须表：

*   作业
*   论坛帖子

这些不是很相似，但它们都有一个“LastUpdated”字段。我想获取最近加入的记录。但是，我还需要用于分页的获取/跳过功能（不，我没有 SQL 2012）。

我不想用我的所有记录创建一个新列表（带有 ToList 和 AddRange），所以我知道整个记录集，然后订购.. 这似乎非常低效。

**我的尝试：**

请不要嘲笑我效率低下的代码.. 好吧，一点点（既是因为它效率低又......当 skip 大于 0 时它不会做我想要的）。

```
 public List<TempContentPlaceholder> LatestReplies(int take, int skip)
    {
        using (GKDBDataContext db = new GKDBDataContext())
        {
            var forumPosts = db.dbForumPosts.OrderBy(c => c.LastUpdated).Skip(skip).Take(take).ToList();
            var assignMents = db.dbUploadedAssignments.OrderBy(c => c.LastUpdated).Skip(skip).Take(take).ToList();

            List<TempContentPlaceholder> fps =
                forumPosts.Select(
                    c =>
                    new TempContentPlaceholder()
                    {
                        Id = c.PostId,
                        LastUpdated = c.LastUpdated,
                        Type = ContentShowingType.ForumPost
                    }).ToList();

            List<TempContentPlaceholder> asm =
                                assignMents.Select(
                                    c =>
                                    new TempContentPlaceholder()
                                    {
                                        Id = c.UploadAssignmentId,
                                        LastUpdated = c.LastUpdated,
                                        Type = ContentShowingType.ForumPost
                                    }).ToList();

            fps.AddRange(asm);

            return fps.OrderBy(c=>c.LastUpdated).ToList();

        }
    } 
```

任何很棒的 Linq to SQl 人，谁能给我一个提示？我相信有人可以加入他们的出路！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:08:20.507

首先，您应该使用`OrderByDescending`，因为较晚的日期比较早的日期具有更大的值，以便获得最新的更新。其次，我认为您正在做的事情对于第一页是有效的，但您也只需`take`要从加入列表中获取最高值。也就是说，如果您希望合并两个表中的最后 20 个条目，则从每个表中获取最后 20 个条目，合并它们，然后从合并列表中获取最后 20 个条目。当您尝试使用分页时，问题就出现了，因为您需要做的是知道每个列表中有多少元素组成了前一页。我认为，您最好的选择可能是先合并它们，然后使用跳过/获取。我知道你不想听到这个，但其他解决方案可能更复杂。或者，您可以登上顶部`skip+take`每个表中的值，然后合并，跳过这些`skip`值并应用`take`。

```
using (GKDBDataContext db = new GKDBDataContext())
{
     var fps = db.dbForumPosts.Select(c => new TempContentPlaceholder()
                {
                    Id = c.PostId,
                    LastUpdated = c.LastUpdated,
                    Type = ContentShowingType.ForumPost
                })
                .Concat( db.dbUploadedAssignments.Select(c => new TempContentPlaceholder()
                {
                    Id = c.PostId,
                    LastUpdated = c.LastUpdated,
                    Type = ContentShowingType.ForumPost
                }))
                .OrderByDescending( c => c.LastUpdated )
                .Skip(skip)
                .Take(take)
                .ToList();

    return fps;
} 
```

# c++ - 如何检查 Phonon 声音是否已经在播放？

> ID：14541049
> 
> 赞同：-2
> 
> 时间：2013-01-26T20:02:57.690
> 
> 标签：c++, qt, qt4, phonon

我对 Qt 比较陌生，所以我将解释这个问题以及我希望尽可能清楚地实现的目标。

目前，我有一些按钮，单击时会播放位于应用程序目录中的声音文件。我做了一些研究，发现很多用户说使用 Phonon 比 QSound 更好。此应用程序仅适用于 Windows 平台，因此无需特别注意。

这是我在 mainwindow.cpp 中的代码：

```
void MainWindow::on_obj_button_gandalf_clicked()
{
        Phonon::MediaObject *music =
        Phonon::createPlayer(Phonon::MusicCategory,Phonon::MediaSource("sound_file.mp3"));
        music->play();
} 
```

声音播放完美。但是，如果用户必须在第一次单击时仍在播放声音时再次单击该按钮，则它会一个接一个地播放。

是否有某种 isplaying() 函数或其他东西来确定是否确实已经在播放相同的声音？如果是这样，则不应再次播放，如果不是，则应按要求播放歌曲。

我正在使用 Qt 4.7.0 32bit

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:06:59.657

阅读[文档](http://doc.qt.digia.com/qt/phonon-mediaobject.html#state)，它看起来就像调用`music->state()`和...检查状态一样简单。

```
if (music->state() == Phonon::PlayingState) {
    ... 
```

您还会注意到有许多信号可以让您在应用程序中管理它，特别是[stateChanged](http://doc.qt.digia.com/qt/phonon-mediaobject.html#stateChanged)信号。

# android - 长按 EditText 会导致崩溃

> ID：14541051
> 
> 赞同：0
> 
> 时间：2013-01-26T20:03:04.887
> 
> 标签：android, nullpointerexception, android-edittext, contextmenu

`EditText`出于某种原因，当我长按一个框（例如粘贴数据） 时，它试图调出一个上下文菜单。

这是LogCat：

```
01-26 12:00:22.243: E/AndroidRuntime(22300): FATAL EXCEPTION: main
01-26 12:00:22.243: E/AndroidRuntime(22300): java.lang.NullPointerException
01-26 12:00:22.243: E/AndroidRuntime(22300):    at com.---.---.Comments.onCreateContextMenu(Comments.java:352)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View.createContextMenu(View.java:7781)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View.createContextMenu(View.java:7789)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View.createContextMenu(View.java:7789)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at com.android.internal.view.menu.ContextMenuBuilder.show(ContextMenuBuilder.java:81)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at com.android.internal.policy.impl.PhoneWindow$DecorView.showContextMenuForChild(PhoneWindow.java:2201)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:2969)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.ViewGroup.showContextMenuForChild(ViewGroup.java:612)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View.showContextMenu(View.java:4154)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View.performLongClick(View.java:4123)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.widget.TextView.performLongClick(TextView.java:7875)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.view.View$CheckForLongPress.run(View.java:16945)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.os.Handler.handleCallback(Handler.java:615)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.os.Looper.loop(Looper.java:137)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at android.app.ActivityThread.main(ActivityThread.java:4745)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at java.lang.reflect.Method.invokeNative(Native Method)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at java.lang.reflect.Method.invoke(Method.java:511)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-26 12:00:22.243: E/AndroidRuntime(22300):    at dalvik.system.NativeStart.main(Native Method)
01-26 12:00:22.250: W/ActivityManager(291):   Force finishing activity com.---.rat---/.Comments 
```

我的 ContextMenu 的代码带有导致 NullPointer 的行：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    android.view.MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.comments_context, menu);
    menu.setHeaderTitle("Available Actions");

    android.view.MenuItem Edit = menu.findItem(R.id.editComment);
    android.view.MenuItem Delete = menu.findItem(R.id.deleteComment);

    AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;
    int position = info.position;
    ListView lv = (ListView) v;
    int firstVisible = lv.getFirstVisiblePosition();
    View rowView = lv.getChildAt(position - firstVisible);

  // this is the line where there is a null pointer.  (Obviousness in an `EditText` box,  this `TextView` doesn't exist!

    ReviewUser = ((TextView) rowView.findViewById(R.id.labelReviewCommentUser)).getText().toString();
    ReviewComment = ((TextView) rowView.findViewById(R.id.labelReviewComment)).getText().toString();

    // Other Stuff Edited Out

} 
```

EditText 框是在我的`onCreate`：

```
EtComment = (EditText) findViewById(R.id.etTweetComment); 
```

最后`onCreate`是这样的：

registerForContextMenu(getListView());

此外，在我声明 EditText 的上方，我设置了列表视图：

```
LayoutInflater inflater = this.getLayoutInflater();
        ViewGroup header = (ViewGroup) inflater.inflate(
                R.layout.comment_header, listView, false);

        listView = getListView();
        listView.addHeaderView(header, null, false);
        listView.setClickable(false);
        listView.setTextFilterEnabled(true); 
```

`EditText`Box 位于标题`ListView`( `comment_header`) 中。不确定这是否重要。

主要问题： **为什么它试图通过长按 EditText 来注册 ContextMenu？**

***编辑/更新***：

我相信 CommonsWare 回答了这个问题，现在我正在为它的代码苦苦挣扎：

> 请比较 v 和 getListView() 以查看它们是否是同一个对象。如果不是，只需链接到超类。

你如何做到这一点？当我调用这个时，`registerForContextMenu(getListView());`我相信，它总是会根据该代码打开`ContextMenu`，`ListView`所以我如何进行比较是否长按一个`ListView`与一个`EditText`框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T20:16:13.720

它可以弹出一个 ContextMenu 对话框来处理`EditText`小部件上的长按。通常，此菜单将包含以下内容：

*   切
*   复制
*   粘贴
*   全选
*   选择文本

长按 EditText 时采取的操作取决于您正在运行的设备，因为平台版本和 OEM ui 存在各种差异，这些差异在设备范围内实现。因此，在不了解您使用的设备的更多信息的情况下，我只能大致了解操作系统为何*会*弹出上下文菜单。

# bash - 在 bash 中 if [ "$VAR" ] 是什么意思

> ID：14541056
> 
> 赞同：1
> 
> 时间：2013-01-26T20:04:12.077
> 
> 标签：bash

我了解 if 函数在 bash 中的工作原理，但问题是如果你不将它与某些东西进行比较，我不明白它的含义。我知道有很多开关，比如 -e 或 -c 或 -f，但是下面的代码什么时候会被评估为 true？

```
if [ "$VAR" ]; then
  echo "TRUE"
else
  echo "FALSE"
fi 
```

我正在尝试解释某人为我编写的脚本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:05:45.630

来自`help test`：

```
 STRING      True if string is not empty. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T20:05:58.423

我认为是这样的：

```
-n STRING
       the length of STRING is nonzero
STRING equivalent to -n STRING 
```

只是测试非空值。

# java - SOAP 消息和 WSDL 之间的区别？

> ID：14541066
> 
> 赞同：104
> 
> 时间：2013-01-26T20:05:13.120
> 
> 标签：java, web-services, soap, wsdl

我对 SOAP 消息和 WSDL 如何组合在一起感到困惑？我已经开始研究 SOAP 消息，例如：

```
 POST /InStock HTTP/1.1
Host: www.example.org
Content-Type: application/soap+xml; charset=utf-8
Content-Length: nnn

<?xml version="1.0"?>
<soap:Envelope
xmlns:soap="http://www.w3.org/2001/12/soap-envelope"
soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding">

<soap:Body xmlns:m="http://www.example.org/stock">
  <m:GetStockPrice>
    <m:StockName>IBM</m:StockName>
  </m:GetStockPrice>
</soap:Body>

</soap:Envelope> 
```

所有 SOAP 消息都是 WSDL 的吗？SOAP 是接受自己的“SOAP 消息”或“WSDL”的协议吗？如果它们不同，那么什么时候应该使用 SOAP 消息，什么时候应该使用 WSDL？

对此进行一些澄清会很棒。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2013-11-12T09:39:23.687

每个请求都会发送一个 SOAP 文档。假设我们是一家书店，并且有一个我们查询的远程服务器以了解特定书籍的当前价格。假设我们需要将图书的标题、页数和 ISBN 号传递给服务器。

每当我们想知道价格时，我们都会发送一个唯一的 SOAP 消息。它看起来像这样；

```
<SOAP-ENV:Envelope
  xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
  SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
  <SOAP-ENV:Body>
    <m:GetBookPrice xmlns:m="http://namespaces.my-example-book-info.com">
      <ISBN>978-0451524935</ISBN>
      <Title>1984</Title>
      <NumPages>328</NumPages>
    </m:GetBookPrice>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

我们期望得到一个 SOAP 响应消息，例如；

```
<SOAP-ENV:Envelope
  xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"
  SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
  <SOAP-ENV:Body>
    <m:GetBookPriceResponse xmlns:m="http://namespaces.my-example-book-info.com">
      <CurrentPrice>8.99</CurrentPrice>
      <Currency>USD</Currency>
    </m:GetBookPriceResponse>
  </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

然后，WSDL 描述了当服务器接收到该消息时如何处理/处理该消息。在我们的例子中，它描述了 Title、NumPages 和 ISBN 的类型，我们是否应该期待 GetBookPrice 消息的响应以及该响应应该是什么样子。

类型看起来像这样；

```
<wsdl:types>

  <!-- all type declarations are in a chunk of xsd -->
  <xsd:schema targetNamespace="http://namespaces.my-example-book-info.com"
    xmlns:xsd="http://www.w3.org/1999/XMLSchema">

    <xsd:element name="GetBookPrice">
      <xsd:complexType>
        <xsd:sequence>
          <xsd:element name="ISBN" type="string"/>
          <xsd:element name="Title" type="string"/>
          <xsd:element name="NumPages" type="integer"/>
        </xsd:sequence>
      </xsd:complexType>
    </xsd:element>

    <xsd:element name="GetBookPriceResponse">
      <xsd:complexType>
        <xsd:sequence>
          <xsd:element name="CurrentPrice" type="decimal" />
          <xsd:element name="Currency" type="string" />
        </xsd:sequence>
      </xsd:complexType>
    </xsd:element>

  </xsd:schema>
</wsdl:types> 
```

但 WSDL 还包含更多信息，包括哪些功能链接在一起进行操作、服务中可用的操作以及您可以访问服务/操作的网络位置。

另请参阅[W3 带注释的 WSDL 示例](http://www.w3.org/2001/03/14-annotated-WSDL-examples.html)

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2013-01-26T20:09:38.910

SOAP 消息是用于传输数据的 XML 文档。WSDL 是一个 XML 文档，它描述了如何连接 Web 服务并向其发出请求。

基本上 SOAP 消息是您传输的数据，WSDL 告诉您可以做什么以及如何进行调用。

在谷歌中快速搜索将产生许多额外阅读的资源（以前的书链接现在已经死了，为了解决这个问题，任何新的建议都会放在评论中）

只需注意您的具体问题：

**所有 SOAP 消息都是 WSDL 的吗？**不，它们根本不是一回事。

**SOAP 是接受自己的“SOAP 消息”或“WSDL”的协议吗？**不 - 需要阅读，因为这很遥远。

**如果它们不同，那么什么时候应该使用 SOAP 消息，什么时候应该使用 WSDL？**Soap 是您应用于消息/数据以进行传输的结构。WSDL 仅用于首先确定如何调用服务。当您第一次添加代码以调用特定的 Web 服务时，这通常是一次性的事情。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-10-31T14:12:32.700

在说明 SOAP 和 WSDL 之间有什么区别之前，我们需要定义什么是 Web 服务，其中两者（SOAP 和 WSDL）是 Web 服务的组件

大多数应用程序都是为了与用户交互而开发的，用户通过界面输入或搜索数据，然后应用程序响应用户的输入。

除了 Web 服务应用程序仅在机器与机器之间或应用程序与应用程序之间进行通信之外，Web 服务或多或少地做同样的事情。通常没有直接的用户交互。

Web 服务基本上是一组开放协议，用于在应用程序之间交换数据。开放协议的使用使 Web 服务能够独立于平台。用不同编程语言编写并在不同平台上运行的软件可以使用 Web 服务通过计算机网络（如 Internet）交换数据。换句话说，Windows 应用程序可以与 PHP、Java 和 Perl 应用程序以及许多其他应用程序通信，这在正常情况下是不可能的。

> Web 服务如何工作？

因为不同的应用程序是用不同的编程语言编写的，所以它们经常无法相互通信。Web 服务通过使用开放协议和标准（主要是 XML、SOAP 和 WSDL）的组合来实现这种通信。Web 服务使用 XML 标记数据，使用 SOAP 传输消息，最后使用 WSDL 来描述服务的可用性。让我们看一下 Web 服务应用程序的这三个主要组件。

## 简单对象访问协议 (SOAP)

简单对象访问协议或 SOAP 是一种用于在应用程序之间发送和接收消息而不会遇到互操作性问题的协议（互操作性意味着运行 Web 服务的平台变得无关紧要）。另一个具有类似功能的协议是 HTTP。它用于访问网页或上网。HTTP 确保您不必担心哪种 Web 服务器（Apache 或 IIS 或任何其他）为您提供正在查看的页面，或者您查看的页面是用 ASP.NET 还是 HTML 创建的。

### 因为 SOAP 既用于请求又用于响应，因此其内容会根据其用途而略有不同。

下面是一个 SOAP 请求和响应消息的示例

**SOAP 请求：**

```
POST /InStock HTTP/1.1 
Host: www.bookshop.org 
Content-Type: application/soap+xml; charset=utf-8 
Content-Length: nnn 
<?xml version="1.0"?> 
<soap:Envelope 
xmlns:soap="http://www.w3.org/2001/12/soap-envelope" 
soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding"> 
<soap:Body xmlns:m="http://www.bookshop.org/prices"> 
    <m:GetBookPrice> 
    <m:BookName>The Fleamarket</m:BookName> 
    </m:GetBookPrice> 
</soap:Body> 
</soap:Envelope> 
```

**肥皂响应：**

```
POST /InStock HTTP/1.1 
Host: www.bookshop.org 
Content-Type: application/soap+xml; charset=utf-8 
Content-Length: nnn 
<?xml version="1.0"?> 
<soap:Envelope 
xmlns:soap="http://www.w3.org/2001/12/soap-envelope" 
soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding"> 
<soap:Body xmlns:m="http://www.bookshop.org/prices"> 
    <m:GetBookPriceResponse> 
    <m: Price>10.95</m: Price> 
    </m:GetBookPriceResponse> 
</soap:Body> 
</soap:Envelope> 
```

尽管两条消息看起来相同，但它们执行的方法不同。例如查看上面的示例，您可以看到请求消息使用该`GetBookPrice`方法获取图书价格。响应由`GetBookPriceResponse`方法执行，这将是您作为“请求者”将看到的消息。您还可以看到消息是使用 XML 编写的。

## Web 服务描述语言或 WSDL

WSDL 是描述 Web 服务的文档，还告诉您如何访问和使用其方法。

### WSDL 负责您如何知道您在 Internet 上偶然发现的 Web 服务中可用的方法。

查看一个示例 WSDL 文件：

```
<?xml version="1.0" encoding="UTF-8"?> 
<definitions  name ="DayOfWeek"  
  targetNamespace="http://www.roguewave.com/soapworx/examples/DayOfWeek.wsdl" 
  xmlns:tns="http://www.roguewave.com/soapworx/examples/DayOfWeek.wsdl" 
  xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"  
  xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
  xmlns="http://schemas.xmlsoap.org/wsdl/">  
  <message name="DayOfWeekInput"> 
    <part name="date" type="xsd:date"/> 
  </message> 
  <message name="DayOfWeekResponse"> 
    <part name="dayOfWeek" type="xsd:string"/> 
  </message> 
  <portType name="DayOfWeekPortType"> 
    <operation name="GetDayOfWeek"> 
      <input message="tns:DayOfWeekInput"/> 
      <output message="tns:DayOfWeekResponse"/> 
    </operation> 
  </portType> 
  <binding name="DayOfWeekBinding" type="tns:DayOfWeekPortType"> 
    <soap:binding style="document"  
      transport="http://schemas.xmlsoap.org/soap/http"/> 
    <operation name="GetDayOfWeek"> 
      <soap:operation soapAction="getdayofweek"/> 
      <input> 
        <soap:body use="encoded"  
          namespace="http://www.roguewave.com/soapworx/examples"  
          encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/> 
      </input> 
      <output> 
        <soap:body use="encoded"  
          namespace="http://www.roguewave.com/soapworx/examples"   
            encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/> 
      </output> 
    </operation> 
  </binding> 
  <service name="DayOfWeekService" > 
    <documentation> 
      Returns the day-of-week name for a given date 
    </documentation> 
    <port name="DayOfWeekPort" binding="tns:DayOfWeekBinding"> 
      <soap:address location="http://localhost:8090/dayofweek/DayOfWeek"/> 
    </port> 
  </service> 
</definitions> 
```

关于 WSDL 文件要记住的主要事项是它为您提供：

*   Web 服务的描述*   Web 服务使用的方法和它采用的参数*   一种定位 Web 服务的方法

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-01-26T20:08:10.913

WSDL（Web 服务定义语言）是描述 Web 服务的元数据文件。

操作名称、参数等。

肥皂消息是实际的有效载荷

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-04-24T20:58:42.323

比电话更好的类比：通过邮购服务通过邮政邮件订购产品。WSDL 文档就像说明如何创建服务提供商将接受的订单类型的说明。SOAP 消息就像一个具有标准设计（大小、形状、构造）的信封，全世界的每个邮局都知道如何处理。你把你的订单放在这样一个信封里。网络（例如互联网）是邮政服务。你把信封放进邮件里。邮政服务的员工不看信封里面。有效负载 XML 是您附在信封中的订单。邮局交付信封后，Web 服务提供商打开信封并处理订单。如果您已正确创建并填写表格，

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-07-05T13:21:12.690

简单来说，如果您有计算器的网络服务。WSDL 讲述了您可以实现或向客户端公开的功能。例如：加、删、减等。在使用 SOAP 时，您实际上执行了 doDelete()、doSubtract()、doAdd() 等操作。所以 SOAP 和 WSDL 是苹果和橘子。我们不应该比较它们。它们都有自己不同的功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-15T11:46:50.650

SOAP ：它是一种基于 XML 的开放标准通信协议，用于将信息从用户交换到 Web 服务，反之亦然。肥皂只是以某种方式组织数据的文档。对于每个请求和响应，可能存在单独的肥皂。

WSDL：在soap中，数据以某种方式组织，这种组织在WSDL中指定，必须使用的数据类型也在此处指定。对于请求和响应，将存在单个 WSDL

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-02-05T20:38:03.730

WSDL 充当发送者和接收者之间的接口。
SOAP 消息是 xml 格式的请求和响应。

**与java RMI比较**

WSDL 是
SOAP 消息的接口类，是编组的请求和响应消息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-07T09:09:43.807

WSDL 是 API 提供者和客户端之间的一种契约，它描述了 Web 服务：公共功能、可选/必填字段...

但是肥皂消息是客户端和提供者之间传输的数据（有效负载）

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-05-08T07:26:54.313

我们可以考虑一个电话，其中号码是wsdl，信息交换是soap。

WSDL 是描述如何与通信服务器连接。SOAP 是有通信消息的。

# django - 空标签ChoiceField Django

> ID：14541074
> 
> 赞同：46
> 
> 时间：2013-01-26T20:06:35.173
> 
> 标签：django, forms, label

你如何使`ChoiceField`'s label 表现得像`ModelChoiceField`？有没有办法设置一个`empty_label`，或者至少显示一个空白字段？

表格.py：

```
 thing = forms.ModelChoiceField(queryset=Thing.objects.all(), empty_label='Label')
    color = forms.ChoiceField(choices=COLORS)
    year = forms.ChoiceField(choices=YEAR_CHOICES) 
```

* * *

我已经尝试过这里建议的解决方案：

[Stack Overflow Q](https://stackoverflow.com/questions/1765757/choicefield-doesnt-display-an-empty-label-when-using-a-tuple-am-i-doing-somet) - 设置`CHOICES = [('','All')] + CHOICES`导致内部服务器错误。

[Stack Overflow Q2](https://stackoverflow.com/questions/5289491/blank-option-in-required-choicefield) -`('', '---------'),`在我的选择中定义后，仍然默认为列表中的第一项，而不是`('', '---------'),`选择。

[要点](https://gist.github.com/651080)- 尝试使用`EmptyChoiceField`这里定义的，但没有使用 Django 1.4。

但这些都不适合我。你会如何解决这个问题？谢谢你的想法！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-26T23:58:34.483

[请参阅关于ChoiceField](https://docs.djangoproject.com/en/1.11/ref/forms/fields/#choicefield)的 Django 1.11 文档。ChoiceField 的“空值”定义为空字符串`''`，因此您的元组列表应包含`''`映射到您要为空值显示的任何值的键。

```
### forms.py
from django.forms import Form, ChoiceField

CHOICE_LIST = [
    ('', '----'), # replace the value '----' with whatever you want, it won't matter
    (1, 'Rock'),
    (2, 'Hard Place')
]

class SomeForm (Form):

    some_choice = ChoiceField(choices=CHOICE_LIST, required=False) 
```

请注意，如果您希望表单字段是可选的，则可以通过使用来避免表单错误`required=False`

此外，如果您已经有一个没有空值的 CHOICE_LIST，您可以插入一个，以便它首先显示在表单下拉菜单中：

```
CHOICE_LIST.insert(0, ('', '----')) 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-08T22:10:02.060

这是我使用的解决方案：

```
from myapp.models import COLORS

COLORS_EMPTY = [('','---------')] + COLORS

class ColorBrowseForm(forms.Form):
    color = forms.ChoiceField(choices=COLORS_EMPTY, required=False, widget=forms.Select(attrs={'onchange': 'this.form.submit();'})) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-26T22:48:08.777

你可以试试这个（假设你的选择是元组）：

```
blank_choice = (('', '---------'),)
...
color = forms.ChoiceField(choices=blank_choice + COLORS)
year = forms.ChoiceField(choices=blank_choice + YEAR_CHOICES) 
```

另外，我无法从你的代码中判断这是表单还是ModelForm，但它是后者，无需在此处重新定义表单字段（您可以直接在模型字段中包含choices=COLORS和choices=YEAR_CHOICES .

希望这可以帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-04T18:23:06.470

我知道你已经接受了一个答案，但我只想发布这个，以防有人遇到我遇到的问题，即接受的解决方案不适用于 ValueListQuerySet。您链接到的[EmptyChoiceField](https://gist.github.com/davidbgk/651080)非常适合我（尽管我使用的是 django 1.7）。

```
class EmptyChoiceField(forms.ChoiceField):
    def __init__(self, choices=(), empty_label=None, required=True, widget=None, label=None, initial=None, help_text=None, *args, **kwargs):

        # prepend an empty label if it exists (and field is not required!)
        if not required and empty_label is not None:
            choices = tuple([(u'', empty_label)] + list(choices))

        super(EmptyChoiceField, self).__init__(choices=choices, required=required, widget=widget, label=label, initial=initial, help_text=help_text, *args, **kwargs) 

class FilterForm(forms.ModelForm):
    #place your other fields here 
    state = EmptyChoiceField(choices=People.objects.all().values_list("state", "state").distinct(), required=False, empty_label="Show All") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-09-07T11:52:37.523

*派对有点晚了。。*

根本不修改选择并仅使用小部件处理它怎么样？

```
from django.db.models import BLANK_CHOICE_DASH

class EmptySelect(Select):
    empty_value = BLANK_CHOICE_DASH[0]
    empty_label = BLANK_CHOICE_DASH[1]

    @property
    def choices(self):
        yield (self.empty_value, self.empty_label,)
        for choice in self._choices:
            yield choice

    @choices.setter
    def choices(self, val):
        self._choices = val 
```

然后调用它：

```
class SomeForm(forms.Form):
    # thing = forms.ModelChoiceField(queryset=Thing.objects.all(), empty_label='Label')
    color = forms.ChoiceField(choices=COLORS, widget=EmptySelect)
    year = forms.ChoiceField(choices=YEAR_CHOICES, widget=EmptySelect) 
```

自然地，`EmptySelect`将被放置在某种`common/widgets.py`代码中，然后当你需要它时，只需引用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-08T17:46:36.863

由于模型中的整数字段，不得不使用 0 而不是 u''。（错误是 int() 以 10 为底的无效文字：'）

```
# prepend an empty label if it exists (and field is not required!)
if not required and empty_label is not None:
    choices = tuple([(0, empty_label)] + list(choices)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-23T13:05:42.977

它不是同一种形式，但我受 EmptyChoiceField 方法的启发采用以下方式：

```
from django import forms
from ..models import Operator

def parent_operators():
    choices = Operator.objects.get_parent_operators().values_list('pk', 'name')
    choices = tuple([(u'', 'Is main Operator')] + list(choices))
    return choices

class OperatorForm(forms.ModelForm):
    class Meta:
        model = Operator
        # fields = '__all__'
        fields = ('name', 'abbr', 'parent', 'om_customer_id', 'om_customer_name', 'email', 'status')

    def __init__(self, *args, **kwargs):
        super(OperatorForm, self).__init__(*args, **kwargs)
        self.fields['name'].widget.attrs.update({'class': 'form-control m-input form-control-sm'})
        self.fields['abbr'].widget.attrs.update({'class': 'form-control m-input form-control-sm'})
        self.fields['parent'].widget.attrs.update({'class': 'form-control m-input form-control-sm'})
        self.fields['parent'].choices = parent_operators()
        self.fields['parent'].required = False
        self.fields['om_customer_id'].widget.attrs.update({'class': 'form-control m-input form-control-sm'})
        self.fields['om_customer_name'].widget.attrs.update({'class': 'form-control m-input form-control-sm'})
        self.fields['email'].widget.attrs.update({'class': 'form-control m-input form-control-sm', 'type': 'email'})enter code here 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-08T23:45:59.340

实现此目的的另一种方法是将选择小部件与其余小部件分开定义，并更改保存内容的方法。

**表格.py**

```
class CardAddForm(forms.ModelForm):
    category = forms.ModelChoiceField(empty_label='Choose category',
                                      queryset=Categories.objects.all(),
                                      widget=forms.Select(attrs={'class':'select-css'}))

    class Meta:
        **other model field** 
```

而在**views.py**你应该`obj.create(**form.cleaned_data)`使用`form.save()`

# ios - 在mac IOS桌面上测试网站的模拟器

> ID：14541075
> 
> 赞同：-1
> 
> 时间：2013-01-26T20:06:40.640
> 
> 标签：ios, testing

> **可能重复：**
> [模拟器在mac IOS上测试网站](https://stackoverflow.com/questions/14540780/simulator-to-test-website-on-mac-ios)

我需要在 mac ios（桌面而非移动设备）上测试我的网站是否有在线模拟器可以执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:10:53.730

您可以使用 iOS 模拟器来执行此操作。您需要在 Safari 上启用“开发者模式”（首选项 -> 高级）。

然后在iOS模拟器中打开你要调试的网站。回到 safari，在开发下，您将看到模拟器和 safari 上打开的选项卡。

如果你想测试一个实际的设备，那么只需将它插入你的计算机，它也应该在那里显示。

我就是这样做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:15:16.857

在 Window 的 Safari 浏览器上测试和在 Mac OS Safari 浏览器上测试都是一样的。

仍然[在这里](http://www.sitepoint.com/testing-in-safari-without-a-mac/)是一个很好的链接，可以帮助你。

希望这些信息对你有帮助..

# http - 为什么在请求标头（客户端到服务器）中发送 Cache-Control 属性？

> ID：14541077
> 
> 赞同：181
> 
> 时间：2013-01-26T20:06:50.717
> 
> 标签：http, http-headers

在阅读`Cache-Control`了 HTTP 标头的字段之后，

我了解`Cache-Control`HTTP 响应标头（服务器到客户端）中的字段指定了中间代理服务器/客户端浏览器如何处理响应的指令，方法是为`Cache-Control`字段发送不同的值：、、、`private`或在响应标头中。`public``no-cache``no-store`

但我不明白为什么我们需要`Cache-Control`作为请求标头（客户端到服务器）发送？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2013-01-27T05:17:14.823

`Cache-Control: no-cache`通常用于请求标头（从 Web 浏览器发送到服务器）以强制验证中间代理中的资源。如果客户端没有向服务器发送这个请求，中间代理将返回一个内容的副本，如果它是新鲜的（根据`Expire`or`max-age`字段没有过期）。`Cache-Control`指示这些代理重新验证副本，即使它是新鲜的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-26T20:10:53.670

客户端可以在请求中发送`Cache-Control`标头，以便从源服务器和请求路径上的任何中间代理服务器请求特定的缓存行为，例如重新验证。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-06-18T11:37:04.873

除了上述答案之外，
可能还有一个实现缓存链接的设置。在这种情况下，如果请求到达第一个不满足的缓存，它可能会转到进一步的链式缓存。

因此，为了始终从服务器获取响应，我们在请求标头中包含缓存控制。这将确保响应始终来自服务器。

# android - 通知打开 Android 电子市场

> ID：14541078
> 
> 赞同：7
> 
> 时间：2013-01-26T20:06:51.023
> 
> 标签：android, google-play, android-notifications

我想创建一个[通知](http://developer.android.com/reference/android/app/Notification.html)，单击该通知会在 Android 市场上打开我的应用程序。

我尝试了几件事，如下所示：

```
NotificationCompat.Builder builder = new NotificationCompat.Builder(application);
builder.setAutoCancel(true);
// (set titles, icon, ...)

Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(Uri.parse("market://details?id=com.android.example"));

builder.setContentIntent(PendingIntent.getActivity(application, 0, intent, 0));
Notification notification = builder.build();

NotificationManager manager = (NotificationManager) application.getSystemService(Context.NOTIFICATION_SERVICE);
manager.notify(0, notification); 
```

但是，单击时，没有任何反应。有谁知道如何让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T08:23:30.790

发布的代码有效。我可能对市场链接的 HTTP 版本有问题。喜欢`http://play.google.com/store/apps/details?id=<package_name>`。

# mysql - 在 MySQL 中按条件过滤产品记录

> ID：14541083
> 
> 赞同：1
> 
> 时间：2013-01-26T20:07:46.200
> 
> 标签：mysql, relational-database

我有一个数据库，其中包含特定的产品和床。每张床的详细信息都存储在一个`products`表中，但是我有一个单独的表，`product_bedding_sizes`其中包含一张床可以放入的每种尺寸的记录。因此，一张床可能在此表中有五个条目（这是一对多的关系） .

那一点就完成了。但是，在公共网站上，访问者可以搜索产品并将搜索限制在特定的床尺寸。所以我的问题是，我怎样才能获取一系列尺寸并选择所有可能有一个或多个指定尺寸条目的床产品？

一个简化的模式：

```
CREATE TABLE `products` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB;

CREATE TABLE `product_bedding_sizes` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `product_id` int(10) unsigned NOT NULL,
  `size` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `product_id` (`product_id`)
) ENGINE=InnoDB;

ALTER TABLE `product_bedding_sizes`
  ADD CONSTRAINT `product_bedding_sizes_ibfk_1`
    FOREIGN KEY (`product_id`)
    REFERENCES `products` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE; 
```

如果用户选择 90cm 和 120cm，查询的简单英文解释将是：

> 从`products`表格中选择所有可能有90 厘米或 120 厘米`size`的`product_bedding_sizes`表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:18:46.897

我认为您的要求是，如果产品尺寸为 90 或尺寸为 120，或两者兼有，则应返回一行。（查询会略有不同，以返回产品大小为 90 和大小为 120 的行。）

这些查询中的任何一个都返回指定的结果：

```
SELECT p.id
     , p.name
  FROM products p
  JOIN product_bedding_sizes s
    ON s.product_id = p.id
   AND s.size IN (90,120)
 GROUP
    BY p.id
     , p.name 
```

- 或者 -

```
SELECT p.id
     , p.name
  FROM products p
  JOIN ( SELECT s.product_id
           FROM product_bedding_sizes s
          WHERE s.size IN (90,120)
          GROUP BY s.product_id
       ) t
    ON t.product_id = p.id
 ORDER
    BY p.id
     , p.name 
```

- 或者 -

```
SELECT p.id
     , p.name
  FROM products p
 WHERE EXISTS
       ( SELECT 1
           FROM product_beddings_sizes s
          WHERE s.product_id = p.id
            AND s.size IN (90,120)
       )
 ORDER
    BY p.id
     , p.name 
```

- 或者 -

```
SELECT p.id
     , p.name
  FROM products p 
 WHERE p.id IN
       ( SELECT s.product_id
           FROM product_bedding_sizes s
          WHERE s.size IN (90,120)
       )
 ORDER
    BY p.id
     , p.name 
```

# php - 获取当前用户并保存到mysql

> ID：14541086
> 
> 赞同：0
> 
> 时间：2013-01-26T20:08:01.200
> 
> 标签：php, mysql, .htaccess, post

**基于建议和对我需要什么的更好理解，我改变了我的问题：**

我的网站受**.htaccess**保护。我试图获取当前用户和其他一些变量并将它们保存到**MySQL**数据库中。**除当前用户**部分外，一切正常。

这是我的代码：

```
<?php

            $_SERVER["PHP_AUTH_USER"] = "rep";
            $hostname = "hostname";
            $username = "username";
            $dbname = "dbname";

        $password = "password";
            $usertable = "usageStats";
            $yourfield = "your_field";

$con = mysql_connect($hostname, $username, $password);
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db($dbname, $con);

$sql="INSERT INTO usageStats (Bid, PRid, User)
VALUES
('$_POST[BID]','$_POST[branding]','$_POST[rep]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

mysql_close($con);
?> 
```

我知道以下都是错误的。应该如何传递当前用户而不是 $_POST[rep]？

**黄：**

```
$_SERVER["PHP_AUTH_USER"] = "rep"; 
```

和

```
'$_POST[rep]' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:11:29.210

如果您正在使用`Basic Authentication`，则不需要显式发送用户名。浏览器将发送它，您可以使用`PHP_AUTH_USER`服务器变量访问它：

```
$_SERVER['PHP_AUTH_USER'] 
```

另请查看[`HTTP Authentication`](http://bg2.php.net/features.http-auth)文档中的文章。

# javascript - 使用 ScrollTo jQuery 插件提交表单后滚动到错误和成功消息

> ID：14541090
> 
> 赞同：2
> 
> 时间：2013-01-26T20:08:20.260
> 
> 标签：javascript, jquery, forms, error-handling, scrollto

到目前为止，我只为错误消息正常工作。但是，我希望这也适用于成功消息。这应该在联系表单中按下提交按钮时发生。单击页面右上角的联系人以滚动到它。

你可以[在这里](http://new.syntheticmedia.net)测试它。

这是我用于错误消息的 jQuery：

```
 $(document).ready(function() {
     $(".error:first").attr("id","errors");
    $("#errors").each(function (){
        $("html,body").animate({scrollTop:$('#errors').offset().top-175}, 1000);
    });
  }); 
```

有什么方法可以修改它以使用相同的 offset().top-175 滚动到 #success 和 #errors ？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T20:47:01.733

你可以这样做：

```
 $(document).ready(function() {
     var pos = null;
     if($("#contact-form #errors.visible").length > 0)
        pos = $('#errors').offset().top;

     if($("#contact-form #success.visible").length > 0)
        pos = $('#success').offset().top;

     if(pos != null)
         $("html,body").animate({scrollTop:pos-175}, 1000);
  }); 
```

**并修复您的脚本“js/contact_script.js”必须在 JQuery lib 之后声明的事实**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-10-24T17:33:48.453

此解决方案对 Contact Form 7（WordPress 的流行表单插件）进行同样的工作。我在谷歌搜索我的问题时发现了这个页面，所以我添加了下面的解决方案来帮助其他也在这个页面结束的人。

```
jQuery(function ($) {
    $(document).ready(function ()
    {
        var wpcf7Elm = document.querySelector( '.wpcf7' );
        wpcf7Elm.addEventListener( 'wpcf7submit', function( event ) {
            setTimeout(function() {
                $([document.documentElement, document.body]).animate({
                    scrollTop: $(".wpcf7-response-output").offset().top - 100
                }, 500);
            }, 500);
            //console.log("Submited");
        }, false );
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T20:42:49.347

```
$(document).ready(function () {
    var $elementToScrollTo;
    var $firstError = $(".error:first");
    if ($firstError.length > 0) {
        $firstError.attr("id", "errors");
        $elementToScrollTo = $firstError;
    }
    else {
        $elementToScrollTo = $("#success");
    }
    $("html,body").animate({
        scrollTop: $elementToScrollTo.offset().top - 175
    }, 1000);
}); 
```

# android - 从 sqlite 数据库中获取总数

> ID：14541095
> 
> 赞同：2
> 
> 时间：2013-01-26T20:08:50.740
> 
> 标签：android, database, sqlite

我有一个包含几列的数据库（Android 上的 sqlite）：_id、datum、hour、note

数据库是这样创建的：

```
 private static final String DATABASE_CREATE =
    "create table worked (_id integer primary key autoincrement, "
    + "datum text not null, hour text not null, " 
    + "note text);"; 
```

最后，我想从我的数据库中取出总小时数和分钟数，并将其返回给我的 mainActivity。

我试图这样做：

```
public int getTotalHours(){
    Cursor c = db.rawQuery("select hour from " + DATABASE_TABLE, null);
    int total = 0;
    Date hours = new Date();
    SimpleDateFormat hourFormat = new SimpleDateFormat("HH:mm");
    c.moveToFirst();
    for(int i = 0; i<c.getCount(); i++){
        String uur = c.getString(i);
        try {
            hours = hourFormat.parse(uur);
        } catch (ParseException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        total += hours.getHours();
    }
    return total;
} 
```

但是我的查询中已经出现错误。我也不知道如何以正确的方式提取数据，由于查询错误，我无法测试...

我得到的错误：

> 无法从具有 5 行 1 列的 cursorWindow 读取第 0 行第 1 列。

我希望我是在正确的方式，并且有人可以帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:15:40.737

正确循环您的记录，检索正确的列索引，然后关闭光标：

```
public int getTotalHours(){
    Cursor c = db.rawQuery("select hour from " + DATABASE_TABLE, null);
    if (c == null)
        return 0;

    try{
        int total = 0;
        Date hours = new Date();
        SimpleDateFormat hourFormat = new SimpleDateFormat("HH:mm");
        while(c.moveToNext())
        {
            String uur = c.getString(0);
            try {
                hours = hourFormat.parse(uur);
                total += hours.getHours();
            } catch (ParseException e) {
                e.printStackTrace();
            }           
        }

        return hours;
    }finally{
        c.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:11:07.573

采用

字符串 uur = c.getString(1);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:13:41.313

在你的 for 循环中，从 1 而不是 0 开始你的 int i

```
for(int i = 1; i<c.getCount(); i++){
    String uur = c.getString(i);
    try {
        hours = hourFormat.parse(uur);
    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T20:13:58.610

首先，它是您正在创建的数据库中的一个表，因此我建议您改用`CREATE_TABLE`变量名。其次，您可以这样做：

```
Cursor c = db.rawQuery("select sum(hour) from " + DATABASE_TABLE, null); 
```

在你的表中定义`hour`为整数。

如果您定义正确的列并使用正确的操作 sqlite 可以做到：

```
sqlite> .schema t1
CREATE TABLE t1 (hours time not null);
sqlite> select * from t1;
05:30:00
06:30:00
01:30:00
02:15:00
sqlite> select strftime('%H:%M', 946684800 + sum(strftime('%s', hours) - 946684800), 'unixepoch') from t1;
15:45
sqlite> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T20:15:10.377

在循环结束时调用 c.moveToNext() 会有所帮助。c.getString(i) 也应该是 c.getString(0)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-26T20:15:49.647

请确保小时行是 db 表中的第一个。如果您不确定此修改后的代码是否可以正常工作

```
enter code here
public int getTotalHours(){
Cursor c = db.rawQuery("select hour from " + DATABASE_TABLE, null);
int total = 0;
Date hours = new Date();
SimpleDateFormat hourFormat = new SimpleDateFormat("HH:mm");
c.moveToFirst();
int column = c.getColumnIndex("id")
for(int i = 0; i<c.getCount(); i++){
    String uur = c.getString(c);
    try {
        hours = hourFormat.parse(uur);
    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    total += hours.getHours();
}
return total; 
```

}

# objective-c - 在 Objective-C 中为 minMax 添加 Alpha-Beta 修剪

> ID：14541098
> 
> 赞同：2
> 
> 时间：2013-01-26T20:09:02.737
> 
> 标签：objective-c, algorithm, artificial-intelligence

嗨，我在为 connect 4 游戏的 minMax 算法中添加[alpha beta 修剪](http://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning)时遇到问题，你能帮我吗？这是我的 minMax 过程的代码，在我看来，我需要做的只是一点点：S scoreBoard() 是我的启发式函数，我返回一个包含 2 个值的数组，第一个是位置的在桌子上，另一个是这个位置的分数。

```
-(NSArray*) miniMaxWihtAlphaBetaPrunning:(BOOL)maxOrMin withAlpha:(NSInteger)alpha
 withBeta:(NSInteger)beta withPlayer:(enum playerColor)player andTreeDepth:
(NSInteger)depth
{
if (depth == 0)
{
    return [NSArray arrayWithObjects:[NSNumber numberWithInt:-1],
[NSNumber  numberWithInt:scoreBoard()],nil];
}
else
{
    NSInteger bestScore = maxOrMin ? redWins: blueWins;
    NSInteger bestMove = -1;

    for (NSInteger column = 0; column < 10; column++)
    {
        if (discPlacedMatrix[0][column] != 0)
        {
            continue;
        }

        NSInteger rowFilled = dropDiscAtPoint(column, player);

        if (rowFilled == -1)
        {
            continue;
        }

        NSInteger s = scoreBoard();

        if (s == (maxOrMin? blueWins : redWins))
        {
            bestMove = column;
            bestScore = s;
            discPlacedMatrix[rowFilled][column] = 0;

            break;
        }

        NSArray* result =  [NSArray arrayWithArray:[self miniMaxWihtAlphaBetaPrunning:!maxOrMin withAlpha:alpha withBeta:beta withPlayer:(player == 1 ? RED : BLUE) andTreeDepth:depth - 1]];

        NSInteger scoreInner = [[result objectAtIndex:1] intValue];

        discPlacedMatrix[rowFilled][column] = 0;

        if (scoreInner == blueWins || scoreInner == redWins)
        {
            scoreInner -= depth * player;
        }
        if (maxOrMin)
        {
            if (scoreInner >= bestScore)
            {
                bestScore = scoreInner;
                bestMove = column;
            }
        }
        else
        {
            if (scoreInner <= bestScore)
            {
                bestScore = scoreInner;
                bestMove = column;
            }
        }
    }

    return [NSArray arrayWithObjects:[NSNumber numberWithInt:bestMove],[NSNumber numberWithInt:bestScore],nil];
} 
```

}

我尝试了一些场景，但艾开始

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T21:01:22.047

听起来您正在寻找类似**jamboree algorithm**的东西。该算法的基本思想是递归地遍历你的树，并在每个级别上，对该级别的部分节点运行 alpha beta 算法，然后在其余节点上运行 mini-max 算法。我现在正在工作，但我会在我回家时详细说明。

一个实现：
[http ://chessprogramming.wikispaces.com/Jamboree](http://chessprogramming.wikispaces.com/Jamboree)

# python - 如何使用python进行shell导航

> ID：14541105
> 
> 赞同：-1
> 
> 时间：2013-01-26T20:10:48.217
> 
> 标签：python, linux, shell, navigation, popen

我想用 python cd 到另一个目录，我想在它运行的 shell 上执行这个命令以导航到该目录。

```
command = 'cd ../../../'  
os.popen(command) 
```

这应该将我的外壳导航到新目录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:15:30.960

```
import os
os.chdir('/path/to/dir') 
```

os.chdir 的文档在[这里](http://docs.python.org/2/library/os.html#os-file-dir)。

# php - 使用给定参数从控制器加载 PHP 视图文件

> ID：14541108
> 
> 赞同：0
> 
> 时间：2013-01-26T20:10:57.037
> 
> 标签：php, codeigniter, templates

我有一个简单的控制器文件**StudentController.php**

```
<?php

$data = array();
$data["firstName"] = $_GET["firstName"];

loadView("StudentView.php", $data);

?> 
```

我有一个更简单的视图文件**StudentView.php**

```
<?php

echo $firstName;

?> 
```

我完全不知道如何实现`loadView($view, $data)`功能。我希望控制器中的变量`$data`在视图中可用（`$data["foo"]`从控制器`$foo`中变为视图）

[我想实现在CodeIgniter](http://ellislab.com/codeigniter/user-guide/general/views.html)中很容易做到的事情，但我不知道它是如何实现的。我试图在源文件中查看 Controller.php 和 Loader.php，但它太混乱了，我无法理解。

我不想使用 CodeIgniter 或任何其他框架，我想在 PHP 中本地做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:14:14.393

如果您要构建一个供公众使用的大型网站，出于多种原因，框架通常是一个好主意：

*   适当的单元测试 - 一般来说，您可以确信您的网站的核心正在按预期运行
*   社区支持 - 有问题，您可以轻松获得答案；通常这些框架是开源的，通常由 PHP 社区积极开发
*   安全 - 框架开发人员是框架开发人员；他们接受过培训，可以编写以安全为重中之重的代码

但是，这个问题与框架无关，所以我将用一个非常简单的函数回答您提出的问题：

```
function loadView($view, $data) {
    extract($data);
    ob_start();
    require_once $view;
    $contents = ob_get_contents();
    ob_end_clean();
    return $contents;
} 
```

您可以选择返回内容或直接打印它们，但该功能应该满足您的需求。我不保证这段代码的安全性，而且我显然没有进行错误检查。但它应该作为一个很好的基础让你开始。

# javascript - 将数据发送到本地服务 jQuery 在 IE 中失败

> ID：14541109
> 
> 赞同：0
> 
> 时间：2013-01-26T20:10:58.453
> 
> 标签：javascript, jquery, internet-explorer

对于我正在处理的项目，我需要将一些字符数据从网页发送到本地服务。这在 Firefox 和 Chrome 中运行良好，但在 IE8 中不行。

我的代码：

```
var longstring = 'a very, very, very long string of 7726 characters';

alert('String size is '+longstring.length);

jQuery.ajax({
    type: 'POST',
    url: 'http://localhost:9001/MyService/ReceiveString?callback=?',
    data: { mystring: longstring },
    success: function (result) { alert('Success: ' + result); },
    error: function (result) { alert ('Error: '+result); },
    dataType: 'json',
    async: false
});

alert('Post done!'); 
```

我在 IE 和 Chrome 中对此进行了测试，效果很好。所有数据都发送到本地服务。但是，当我在 IE 中运行它时，发送到服务的数据被截断为 2880 个字符。

我在 IE 中记录了字符串长度，在发送到服务之前看起来还可以。我不认为这是 IE 字符串大小的限制。

我使用的是 jQuery 1.8.2，我在文档中找不到用于发布数据的方法的大小限制。

这曾经是一个异步调用，我将其更改为同步，只是为了看看 IE 是否会在执行过程中切断 Javascript，但似乎并非如此。

我得到了“帖子完成！” 所有浏览器中的警报。

如何在 IE 中将所有字符串数据发送到我的服务

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:19:16.713

我看到你有*两个*'？您的网址中的字符，不确定这是否会导致任何问题？

此外，Internet Explorer 的最大 URL 长度为 2083 个字符 [http://support.microsoft.com/kb/208427]。这不适用于“发布”数据，因为这*应该*作为标头发送，而不是作为 URL 的一部分。

您可以尝试在 Internet Explorer 中跟踪请求，以查看数据是否作为 POST 数据而不是 URL 的一部分正确发送

# ruby-on-rails - 测试redis key过期

> ID：14541111
> 
> 赞同：7
> 
> 时间：2013-01-26T20:11:10.657
> 
> 标签：ruby-on-rails, rspec, redis

我想知道是否有人有一个聪明的方法来测试 redis 密钥过期后的行为。我实际上是在为我的应用程序构建一个小的 redis 支持缓存，并想测试在 redis 键设置为过期后会发生什么。

我使用 rspec 作为我的测试框架。我尝试在测试期间使用 Timecop 更改时间，但意识到它只会影响测试框架的工作，而不影响外部 redis 服务器。

我可以将 TTL 设置为 1，然后使用 sleep(1)，但我不想在我的测试中引入 sleep。

有没有人有一个很好的方法来测试这个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T01:43:48.860

为什么不使用[http://redis.io/commands/expire](http://redis.io/commands/expire)立即使密钥过期？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-10T16:40:32.527

为测试环境解决此问题的正确方法是模拟 redis 客户端并让它返回预期值。我有信心 redis 会做正确的事情并正确实施，因此模拟这种交互可能比让测试实际命中 redis 更好。

```
redis_client.should_receive(:ttl).with(key).then_return(-1) 
```

或者只是模拟对密钥的请求

```
redis_client.should_receive(:get).with(key).then_return(nil) 
```

使用较新的 RSpecs 版本，

```
expect(redis_client).to receive(:get).with(key).and_return(value) 
```

# java - 派生类中的继承字段 - 两种解决方案都显得蹩脚

> ID：14541112
> 
> 赞同：3
> 
> 时间：2013-01-26T20:11:14.343
> 
> 标签：java, oop, inheritance

我有一些课程，里面`X`有这个领域`A`。它是一个最终字段，在构造函数中初始化。现在我有一个派生类`Y`，其中该字段必须始终是 的一个实例`B`，一个派生自 的类`A`。问题是，该类`Y`需要调用一些特定方法，这些方法仅在 B 类上可用，但在其祖先上不可用`A`。

我看到了几个解决方案：

1.  重用类型的字段`A`，继承自`X`，并在类内部`Y`强制`A`转换为`B`。这使我的代码充满了讨厌的类型转换。
2.  添加另一个类型的字段`B`。现在没有类型转换，但我们有两个类型略有不同的字段，它们必须始终保持相同的值——也感觉不好。
3.  将所有`B`提供的方法添加到`A`throw `NotImplementedException`。这增加了一些奇怪的方法，这些方法在该类中故意没有意义。

处理这个领域的最正确方法是什么？或者也许还有其他更好的存在？我不认为这是非常特定于语言的，但在我使用的 Java 中必须是可行的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T20:21:25.910

X 类型应该是泛型类型：

```
public class X<T extends A> {

    protected T a;

    public X(T a) {
        this.a = a;
    }
}

public clas Y extends X<B> {

    public Y(B b) {
        super(b);
    }

    public void foo() {
        // here, this.a is of type B, without any type cast.
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T20:16:20.610

我能想到的唯一合理的解决方案是 #1 的变体：向类添加`Y`一个 getter 方法，该方法将字段转换为 type `B`，并仅通过此 getter 访问该字段。这只需要一次强制转换，并且作为一个有益的副作用，它还将记录代码的哪些部分要求该字段实际上是`B`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T20:21:12.697

在我看来，解决方案#1 是最正确的方法。如果您*知道*一个对象属于特定类，那么将其强制转换为该类没有任何问题。如果您在执行此操作时做出假设，那将是错误的，但这不是假设，根据您所说的。也许制作一个简单地将基础字段转换为正确类型并完成它的getter方法？这样，您只需转换一次（每个子类）。

如果字段以某种方式停止彼此正确更新，则解决方案 #2 将导致难以捉摸的运行时错误。这听起来像是最糟糕的解决方案。

解决方案#3 仍然感觉像是糟糕的软件设计。如果一个方法存在并且它不在抽象类中并且您没有处于原型设计阶段，那么应该实现该方法。否则，您可能只是通过给用户（类）一个误导性的界面来为用户（类）植入不必要的陷阱。

# php - 用换行符写入 XHR 数据

> ID：14541113
> 
> 赞同：0
> 
> 时间：2013-01-26T20:11:24.400
> 
> 标签：php, jquery, newline, fwrite

我从变量中获取一些数据，并通过 XHR 将其发送到 PHP 文件，该文件将其写入文件。每次写入文件后如何在文件中换行？

```
var e='Hello world!'
$.getJSON('http://example.com/write.php?callback=&data='+e); 
```

**写.php：**

```
$data = $_GET['data'];
if(!$op=fopen('my file name','ab')){
  $res='b';
  exit;
}
if(fwrite($op,$data)===FALSE){
  $res='b';
  exit;
}
fclose($op); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:30:05.160

写入数据后，尝试将 a 写入或附加[`PHP_EOL`](http://us3.php.net/manual/en/reserved.constants.php)到文件中。

```
fwrite($op, PHP_EOL); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:26:11.063

尝试：

```
$data = $_GET['data'];

if(!$op=fopen('my file name','ab')){
  $res='b';
  exit;
}
if(fwrite($op,$data . PHP_EOL)===FALSE){
  $res='b';
  exit;
}
fclose($op); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:26:48.320

AFAIK， fwrite() 将自动为每次写入附加一个换行符。

您是否在 Windows 服务器上运行 PHP？您可能会尝试以“at”模式（追加、翻译行尾）而不是“二进制”模式（ab）打开要写入的文件；

$op = fopen('我的文件名','at');

[http://php.net/manual/en/function.fopen.php](http://php.net/manual/en/function.fopen.php)

# iphone - 如何让多个 UIButtons 连接到同一个 IBAction？

> ID：14541125
> 
> 赞同：0
> 
> 时间：2013-01-26T20:12:19.950
> 
> 标签：iphone, xcode, uibutton

我需要几个 UIButtons 都连接到同一个 IBAction，这样按钮都可以做同样的事情，而无需复制和粘贴代码。请告诉我是否有办法做到这一点！它可能就在我的眼皮底下，但我找不到。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T16:03:49.257

为此，如果您使用 Outlet，则需要为每个按钮使用 set IBOutlet 或为每个按钮设置标签，然后使用此代码 .h

```
@interface RootViewController_Phone : UIViewController 
{
IBOutlet UIButton *btn1;
IBOutlet UIButton *btn2;
}
- (IBAction)buttonPressed:(id)sender;
-(void)CallButtonsMethod;
@end 
```

现在在 .m 文件中

```
- (IBAction)buttonPressed:(id)sender{
if([sender isEqual:btn1])
{
    [self CallButtonsMethod];
}
if([sender isEqual:btn2])
{
   [self CallButtonsMethod];
}
}

-(void)CallButtonsMethod
{
 //your Code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:14:43.337

只需将相同的目标和选择器添加到每个按钮：

```
[button1 addTarget:self
            action:@selector(buttonClicked:)
  forControlEvents:UIControlEventTouchUpInside];

[button2 addTarget:self
            action:@selector(buttonClicked:)
  forControlEvents:UIControlEventTouchUpInside];

 // etc. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:23:07.347

使用`IBOutletCollections`.

这是教程： http: [//useyourloaf.com/blog/2011/03/28/interface-builder-outlet-collections.html](http://useyourloaf.com/blog/2011/03/28/interface-builder-outlet-collections.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-01T16:35:47.610

我发现我通常无法将 IB 中*的多个按钮（甚至单个按钮）连接到代码中已经存在的*IBAction，方法是从按钮拖动到 m文件。Xcode 尝试在拖到的文件中创建新动作，但不会连接到现有动作。[这适用于 Xcode 4.6.1 和几个以前的（可能是所有）版本。]

如果 IBAction 位于视图控制器中，即包含按钮的视图的“文件所有者”，则以下链接中接受的答案中的方法有效：

[将 .xib 中的对象连接到现有的 IBAction](https://stackoverflow.com/questions/9554121/connect-object-in-xib-to-existing-ibaction)

但是，如果您希望 IBAction 位于视图自己的类中，而不是视图控制器的类中，则以下方法有效：

*   首先在 IB 中只将*一个*按钮拖到画布上。按住 Control 从按钮拖动到视图的 .m 文件。

*   将拖动的线放在代码实现部分的任何空白处。在弹出的小对话框中定义一个新的 IBAction。所以现在你有一个连接到 IBAction 的按钮。

*   现在不再从对象库中拖出更多按钮，而是*按住 Option 键并从原来的按钮中拖出一个新按钮*。这个新按钮将连接到与原始按钮相同的 IBAction。（如果您需要创建大量按钮并且这看起来很乏味，您可以同时选择一堆已经创建的按钮，然后按住 Option 键一次创建更多按钮。）

# ios - 视频不播放 ios 应用

> ID：14541129
> 
> 赞同：0
> 
> 时间：2013-01-26T20:13:11.747
> 
> 标签：ios

单击 UITabBar 项目时，我正在尝试播放视频。我遵循了本教程：[http ://www.techotopia.com/index.php/Video_Playback_from_within_an_iOS_5_iPhone_Application](http://www.techotopia.com/index.php/Video_Playback_from_within_an_iOS_5_iPhone_Application)

每当我单击 UITabBar 项目时，它只会显示普通视图，不会添加电影视图。这是我的代码：

```
- (void)viewDidLoad {
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:@"video" ofType:@"m4v"]];
MPMoviePlayerController *moviePlayer =  [[MPMoviePlayerController alloc]
                initWithContentURL:url];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(moviePlayBackDidFinish:)
                                             name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayer];

moviePlayer.controlStyle = MPMovieControlStyleDefault;
moviePlayer.shouldAutoplay = YES;
[self.view addSubview:moviePlayer.view];
[moviePlayer setFullscreen:YES animated:YES];
} 
```

我也收到以下错误：

```
2013-01-26 15:21:08.243 Smart Mower[61339:c07] [MPAVController] Autoplay: Disabling        autoplay for pause
2013-01-26 15:21:08.244 Smart Mower[61339:c07] [MPAVController] Autoplay: Disabling autoplay
2013-01-26 15:21:08.260 Smart Mower[61339:c07] [MPAVController] Autoplay: Skipping   autoplay, disabled (for current item: 1, on player: 0) 
```

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:22:20.733

你好尝试添加一些这些东西。

1) 确保在运行时将您的电影添加到构建阶段下的复制包资源中。

2）尝试为您的声明添加代码，如下所示：

```
 NSString *path = [[NSBundle mainBundle] pathForResource:@"movie" ofType:@"mp4"];
            NSURL *url = [NSURL fileURLWithPath:path];
            moviePlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:url];
            moviePlayer.view.frame = self.view.frame;
            moviePlayer.moviePlayer.shouldAutoplay=YES;
            moviePlayer.moviePlayer.controlStyle = MPMovieControlStyleNone;
           [moviePlayer.moviePlayer setFullscreen:YES animated:YES];
           [self.view addSubview:moviePlayer.view];
           [[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(movieFinishedCallback:)
                                           name:MPMoviePlayerPlaybackDidFinishNotification
                                           object:moviePlayer.moviePlayer];

            [moviePlayer.moviePlayer play]; 
```

让我知道你是怎么出来的。

# javascript - 重用ajax函数

> ID：14541133
> 
> 赞同：0
> 
> 时间：2013-01-26T20:13:51.527
> 
> 标签：javascript, html, ajax

我想重用这个功能，但我想每次都更改 id（在这种情况下是品牌），我是否必须每次都重新制作这个功能，还是有其他方法？

这是功能：

```
 function showUser(str)
    {
    if (str=="")
      {
      document.getElementById("brand").innerHTML="";
      return;
      } 
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
        document.getElementById("brand").innerHTML=xmlhttp.responseText;
        }
      }
    xmlhttp.open("GET","inc/form_rest.php?q="+str,true);
    xmlhttp.send();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:17:21.627

传入id作为函数的参数？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:26:42.997

您可以将 id 作为参数传递...

```
function showUser(str, id) {
    if (str=="") {
      document.getElementById(id).innerHTML="";
      return;
    }
    if (window.XMLHttpRequest) {
      xmlhttp=new XMLHttpRequest();
    } else {
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function() {
      if (xmlhttp.readyState==4 && xmlhttp.status==200) {
        document.getElementById(id).innerHTML=xmlhttp.responseText;
      }
    }
    xmlhttp.open("GET","inc/form_rest.php?q="+str,true);
    xmlhttp.send();
} 
```

# javascript - 使用 Javascript / jQuery 将调整大小事件绑定到自定义对象

> ID：14541138
> 
> 赞同：0
> 
> 时间：2013-01-26T20:14:00.870
> 
> 标签：javascript, jquery, object, jquery-events

我正在尝试在 JS 中编写一个对象。每当浏览器窗口调整大小时，该对象都需要重新计算一些值。我试图通过将函数绑定到事件（“resize”）来做到这一点。我正在使用 JQuery 框架。

我已经尝试了几种方法，但都没有奏效，所以一个例子没有多大用处。这个想法是这样的：

```
function grid_constructor(options) {
  this.numOfdivisions = $(target).width() / division_size;

  $(this).on ("resize", function () {
       this.numOfdivisions = $(target).width() / division_size;
  })
} 
```

到目前为止，我认为问题在于我应该将事件绑定到文档，而不是对象，但是当我尝试像这样将事件绑定到文档时`$(window).resize (this.recalculate_divisions())`，它会立即触发，不再触发（所以我想我'我做错了）。

由于这个函数是对象固有的，我不能通过名称来引用实例化的对象（我不知道，在编写代码时，它将具有哪个名称），所以我不能简单地做一个`$(document).ready(function(){$(window).resize($(object_name).function))`.

只是为了澄清。我不想创建自定义事件，我需要我的对象在构建后的任何时间对事件做出反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:25:57.640

我不确定 $(target) 指的是什么，但你是对的，'resize' 事件需要绑定到窗口：

```
function grid_constructor(options) {
    var self = this,
        win = $(window);

    self.numOfdivisions = win.width() / division_size;

    win.on("resize", function () {
        self.numOfdivisions = win.width() / division_size;
    });
} 
```

# date - 在 erlang 函数的保护语句中使用日期

> ID：14541139
> 
> 赞同：2
> 
> 时间：2013-01-26T20:14:07.560
> 
> 标签：date, erlang, guard

我已经定义了一个函数如下

```
bc_link_for(Date) when Date < {2010, 1, 4} orelse Date > erlang:date()
    -> "";
bc_link_for(_)
    -> "something". 
```

第二个守卫声明是针对未来日期的。当我编译这个程序时，我得到了错误`illegal guard expression`。关于在警戒语句中使用日期类型的在线帮助并不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:56:55.520

Guard Expressions 在它们允许的范围内是有限的。这是为了帮助优化器，等等。它们记录在这里：

[http://www.erlang.org/doc/reference_manual/expressions.html#id79673](http://www.erlang.org/doc/reference_manual/expressions.html#id79673)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:33:06.723

守卫中通常不允许使用功能，除了特定的守卫功能，如`is_integer`, `is_float`, `is_list`,`length`等。

但在你的情况下，`erlang:date()`是什么引发了错误。

您只需要在函数内部进行比较：

```
bc_link_for(Date) ->
    case Date < {2010, 1, 4} orelse Date > erlang:date() of
        true -> "";
        false -> "something"
    end. 
```

在守卫中使用元组进行比较是完全可以接受的。

# c - 如何将字符串传递给这个 MD5 程序。？

> ID：14541142
> 
> 赞同：0
> 
> 时间：2013-01-26T20:14:22.807
> 
> 标签：c, md5, argument-passing, cryptoapi

我正在尝试实现一个在下面使用 MD5 哈希的应用程序，我从互联网上获取了 MD5 哈希程序，但我不知道如何将字符串从我的程序（我用 C 编写的程序）传递给计算的程序MD5 哈希。

这是计算 MD5 哈希的程序的主要部分..

```
//
// MD5 Hashing Example - Using Windows Crypto API
//
// by Napalm @ NetCore2K
//
#include <stdio.h>
#include <string.h>
#include "winmd5.h"
HCRYPTPROV hCryptProv;

int main(int argc, char *argv[])
{
    int i;
    CryptStartup();
    if(argc > 1){
        MD5Context ctx;
        MD5Init(&ctx);
        MD5Update(&ctx, (unsigned char *)argv[1], strlen(argv[1]));
        MD5Final(&ctx);
        for(i = 0; i < 16; i++)
            printf("%02x", ctx.digest[i]);
        printf("\n");
    }else
        printf("Usage: %s <string>\n", argv[0]);
    CryptCleanup();
    return 0;
} 
```

这是头文件内容..

```
//
// MD5 Hashing Example - Using Windows Crypto API
//
// by Napalm @ NetCore2K
//
#include <windows.h>
#include <wincrypt.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
extern HCRYPTPROV hCryptProv;

void PrintMD5(const char *);

typedef struct {

unsigned char digest[16];
unsigned long hHash;
} MD5Context;
BOOL CryptStartup()
{

if(CryptAcquireContext(&hCryptProv, NULL, MS_ENHANCED_PROV, PROV_RSA_FULL, CRYPT_NEWKEYSET) == 0){
    if(GetLastError() == NTE_EXISTS){
    if(CryptAcquireContext(&hCryptProv, NULL, MS_ENHANCED_PROV, PROV_RSA_FULL, 0) == 0){
            return FALSE;
        }   
    }
    else return FALSE;
}
return TRUE;
}
void CryptCleanup()
{
if(hCryptProv) CryptReleaseContext(hCryptProv, 0);
hCryptProv = NULL;
}
void inline MD5Init(MD5Context *ctx)
{ 
CryptCreateHash(hCryptProv, CALG_MD5, 0, 0, &ctx->hHash);
}
void inline MD5Update(MD5Context *ctx, unsigned char const *buf, unsigned len)
{
CryptHashData(ctx->hHash, buf, len, 0);
}
void inline MD5Final(MD5Context *ctx)
{
DWORD dwCount = 16;
CryptGetHashParam(ctx->hHash, HP_HASHVAL, ctx->digest, &dwCount, 0);
if(ctx->hHash) CryptDestroyHash(ctx->hHash);
ctx->hHash = 0;
}
void PrintMD5(const char *s)
{
MD5Context ctx;
MD5Init(&ctx);
MD5Update(&ctx, (const unsigned char *)s, strlen(s));
MD5Final(&ctx);

int i;
for (i = 0; i < 16; i++) {
    printf("%02x", ctx.hHash[i]);
}

printf("\n");
 } 
```

我应该如何调用这个 Main()，以及如何将 String 传递给它并获得结果。？提前致谢。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:17:36.153

你不要再打电话`main()`了。你宁愿以这个程序为例来编写一个单独的函数，如下所示：

```
void PrintMD5(const char *s)
{
    MD5Context ctx;
    MD5Init(&ctx);
    MD5Update(&ctx, (const unsigned char *)s, strlen(s));
    MD5Final(&ctx);

    int i;
    for (i = 0; i < 16; i++) {
        printf("%02x", ctx.digest[i]);
    }

    printf("\n");
} 
```

然后你可以从你自己的程序中调用它，比如：

```
PrintMD5("FooBarHelloWorld42"); 
```

# pinvoke - 如何在 Silverlight OOB 中使用 Shell32.dll

> ID：14541151
> 
> 赞同：1
> 
> 时间：2013-01-26T20:15:23.200
> 
> 标签：pinvoke, silverlight-oob, desktop-shortcut, lnk, shell32.dll

我想使用我的 silverlight OOB 应用程序从快捷方式文件中获取目标信息，因此我将编写以下代码以在我的 silverlight OOB 中工作。看来我必须使用 P/Invoke 才能使用 Shell32.dll，但我不确定如何使用 Folder、FolderItem 和 ShellLinkObject？大多数参考资料都解释了我如何使用 P/invoke 使用 .dll 中的函数：（请给我任何评论或示例代码/链接：）

```
public string GetShortcutTargetFile(string shortcutFilename)
{
  string pathOnly = Path.GetDirectoryName(shortcutFilename);
  string filenameOnly = Path.GetFileName(shortcutFilename);

  Shell32.Shell shell = new Shell32.ShellClass();
  Shell32.Folder folder = shell.NameSpace(pathOnly);
  Shell32.FolderItem folderItem = folder.ParseName(filenameOnly);
  if (folderItem != null)
  {
    Shell32.ShellLinkObject link = (Shell32.ShellLinkObject)folderItem.GetLink;
    MessageBox.Show(link.Path);
    return link.Path;
  }

  return String.Empty; // Not found
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T19:37:33.637

我找到了解决方案。

```
public string GetShortcutTargetFile(string shortcutFilename)
{
    string pathOnly = System.IO.Path.GetDirectoryName(shortcutFile);
    string filenameOnly = System.IO.Path.GetFileName(shortcutFile);

    dynamic shell = AutomationFactory.CreateObject("Shell.Application");
    dynamic folder = shell.NameSpace(pathOnly);
    dynamic folderItem = folder.ParseName(filenameOnly);
    if (folderItem != null)
    {
        dynamic link = folderItem.GetLink;
        return "\""+link.Path +"\"" + " " + link.Arguments;
    }

    return String.Empty; // Not found
} 
```

# bash - 如何在bash中搜索空行

> ID：14541152
> 
> 赞同：1
> 
> 时间：2013-01-26T20:15:24.720
> 
> 标签：bash

我正在尝试创建一个 if 语句，该语句在读取空行时执行操作。我会假设它会是这样的： if ($line=='\n');then where line 是它从文本文件中读取的行。但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:23:44.723

尝试这个：

```
if [[ "x$line" == "x" ]]; then... 
```

或者

```
if [[ "$line" =~ "^$" ]]; ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:17:59.587

```
while read line; do
    if [ "$line" = "" ]; then
         echo BLANK
    fi
done < filename.txt 
```

或轻微的变化：

```
while read line; do
    if [ "$line" ]; then
         echo NOT BLANK
    else
         echo BLANK
    fi
done < filename.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T21:45:43.250

或者还有：

```
grep -q '.' <<< $line 
```

如果为空则返回 1 `line`，如果非空则返回 0

# mercurial - 在 repo post-rebase 上拉取提交

> ID：14541155
> 
> 赞同：2
> 
> 时间：2013-01-26T20:15:41.947
> 
> 标签：mercurial, rebase

我正在寻找一种简单的方法来在变基后引入额外的提交，*或者*寻找一个很好的理由告诉某人不要变基。

本质上，我们有一个项目，`crons`. 我经常对此进行更改，并且项目的维护者在我请求时会引入更改并*每次都*重新设置基准。

这通常没问题，但在两种情况下可能会导致问题：

*   同时从两个分支释放
*   之后必须发布额外的提交。

例如，我提交 revision `1000`。维护者拉动和变基以创建修订版`1000'`，但大约在同一时间，我意识到一个可怕的错误并创建修订版`1001`（的子级`1000`）。由于`1000`目标分支中不存在，这会创建一个不可用的合并，维护者通常会嘲笑我并告诉我再试一次（这需要我重新检查主分支`1000'`并手动创建和导入补丁另一个结帐）。我相信您可以看到我尝试同时从两个单独的分支释放时会发生同样的问题。

无论如何，一旦主分支有了`1000'`，有什么办法可以拉进来`1001`而不必再次合并相同的更改？或者变基会破坏这个？不管我能说什么让维护者停止变基？他是不是用错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:59:58.127

告诉你的维护者不要再做傻瓜**。

变基只能由您完成，即创建您要变基的变更集的人，而**不是**对以下变更集执行的操作：

*   已经与其他人共享
*   从别人那里得到

您的维护者可能想要一个非分布式版本控制系统，例如 Subversion，其中变更集遵循一条直线，而不是 DVCS 的分支性质。在这方面，Mercurial 的选择是错误的，或者 Mercurial 的使用是错误的。

另请注意，变基是*更改历史*的一种方式，并且由于 Mercurial 不鼓励这样做（更改历史），因此变基仅可作为扩展使用，而不是“开箱即用”的香草 Mercurial 配置。

所以回答你的问题：不，因为你的维护者坚持要打破 DVCS 的本质，这些工具会与你（和他）对抗，你将很难让工具与你合作。

告诉您的维护人员接受 DVCS 的真正工作原理。现在，他可能仍然坚持不接受*他的*存储库中的新分支或头，并坚持在将单个头推回他的存储库之前拉取和合并，但这没关系。

然而，重新设置共享变更集不是。

如果你真的想使用变基，正确的做法是这样的：

1.  您从某个源存储库中提取最新更改
2.  你在本地提交了很多变更集，修复错误，添加新功能，诸如此类
3.  然后您尝试推送，被告知这将在目标存储库中创建新的头。这告诉您目标存储库中有新的变更集，您上次拉取时没有得到，因为在那之后添加了它们
4.  相反，您拉动，这将在您的本地存储库中添加一个新头。现在您有了从新变更集创建的头，以及从其他人创建的源存储库中检索到的头。
5.  然后，您在从源存储库获得的变更集之上重新设置变更集，实质上是在历史记录中*移动*您的变更集，以显示您从当前源存储库中的最新变更集开始工作
6.  然后你尝试新的推动，成功

最终结果是目标存储库和您自己的存储库将具有*更*线性的变更集历史记录，而不是一个分支然后一个合并。

但是，由于DVCS 中的多个分支*非常好，因此您**不必经历所有这些*。您可以合并，然后继续工作。这就是 DVCS 应该如何工作的。*如果你真的想的话，*变基只是一个额外的工具。

# c# - 如何仅将大型 xml 文件的一部分反序列化为 c# 类？

> ID：14541158
> 
> 赞同：3
> 
> 时间：2013-01-26T20:16:08.597
> 
> 标签：c#, xml, deserialization, xml-deserialization

我已经阅读了一些关于如何反序列化 xml 的帖子和文章，但仍然没有弄清楚我应该编写代码以满足我的需求的方式，所以.. 我为另一个关于反序列化 xml 的问题道歉））

我有一个需要反序列化的大 (50 MB) xml 文件。我使用 xsd.exe 获取文档的 xsd 架构，然后自动生成我放入项目中的 c# 类文件。我想从这个 xml 文件中获取一些（不是全部）数据并将其放入我的 sql 数据库中。

这是文件的层次结构（简化，xsd很大）：

```
public class yml_catalog 
{
    public yml_catalogShop[] shop { /*realization*/ }
}

public class yml_catalogShop
{
    public yml_catalogShopOffersOffer[][] offers { /*realization*/ }
}

public class yml_catalogShopOffersOffer
{
    // here goes all the data (properties) I want to obtain ))
} 
```

这是我的代码：

**第一种方法：**

```
yml_catalogShopOffersOffer catalog;
var serializer = new XmlSerializer(typeof(yml_catalogShopOffersOffer));
var reader = new StreamReader(@"C:\div_kid.xml");
catalog = (yml_catalogShopOffersOffer) serializer.Deserialize(reader);//exception occures
reader.Close(); 
```

我收到 InvalidOperationException：XML(3,2) 文档中存在错误

**第二种方法：**

```
XmlSerializer ser = new XmlSerializer(typeof(yml_catalogShopOffersOffer));
yml_catalogShopOffersOffer result;
using (XmlReader reader = XmlReader.Create(@"C:\div_kid.xml"))          
{
    result = (yml_catalogShopOffersOffer)ser.Deserialize(reader); // exception occures
} 
```

InvalidOperationException：XML(0,0) 文档中存在错误

**第三：**我试图反序列化整个文件：

```
 XmlSerializer ser = new XmlSerializer(typeof(yml_catalog)); // exception occures
 yml_catalog result;
 using (XmlReader reader = XmlReader.Create(@"C:\div_kid.xml"))          
 {
     result = (yml_catalog)ser.Deserialize(reader);
 } 
```

我得到以下信息：

```
error CS0030: The convertion of type "yml_catalogShopOffersOffer[]" into "yml_catalogShopOffersOffer" is not possible.

error CS0029: The implicit convertion of type "yml_catalogShopOffersOffer" into "yml_catalogShopOffersOffer[]" is not possible. 
```

那么，如何修复（或覆盖）代码以免出现异常？

**编辑：**当我写的时候：

```
XDocument doc = XDocument.Parse(@"C:\div_kid.xml"); 
```

发生 XmlException：根级别的未经许可的数据，字符串 1，位置 1。

这是 xml 文件的第一个字符串：

```
<?xml version="1.0" encoding="windows-1251"?> 
```

**编辑 2：** xml 文件简短示例：

```
<?xml version="1.0" encoding="windows-1251"?>
<!DOCTYPE yml_catalog SYSTEM "shops.dtd">
<yml_catalog date="2012-11-01 23:29">
<shop>
   <name>OZON.ru</name>
   <company>?????? "???????????????? ??????????????"</company>
   <url>http://www.ozon.ru/</url>
   <currencies>
     <currency id="RUR" rate="1" />
   </currencies>
   <categories>
      <category id=""1126233>base category</category>
      <category id="1127479" parentId="1126233">bla bla bla</category>
      // here goes all the categories
   </categories>
   <offers>
      <offer>
         <price></price>
         <picture></picture>
      </offer>
      // other offers
   </offers>
</shop>
</yml_catalog> 
```

**PS** 我已经接受了答案（很完美）。但现在我需要使用 categoryId 为每个 Offer 找到“基本类别”。数据是分层的，基本类别是没有“parentId”属性的类别。所以，我写了一个递归方法来找到“基本类别”，但它永远不会完成。似乎算法不是很快））
这是我的代码：（在 main() 方法中）

```
var doc = XDocument.Load(@"C:\div_kid.xml");
var offers = doc.Descendants("shop").Elements("offers").Elements("offer");
foreach (var offer in offers.Take(2))
        {
            var category = GetCategory(categoryId, doc);
            // here goes other code
        } 
```

辅助方法：

```
public static string GetCategory(int categoryId, XDocument document)
    {
        var tempId = categoryId;
            var categories = document.Descendants("shop").Elements("categories").Elements("category");
            foreach (var category in categories)
            {
                if (category.Attribute("id").ToString() == categoryId.ToString())
                {
                    if (category.Attributes().Count() == 1)
                    {
                        return category.ToString();
                    }
                    tempId = Convert.ToInt32(category.Attribute("parentId"));
                }
            }
        return GetCategory(tempId, document);
    } 
```

我可以在这种情况下使用递归吗？如果没有，我还能如何找到“基本类别”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T21:18:13.297

试试 LINQ to XML。`XElement result = XElement.Load(@"C:\div_kid.xml");`

LINQ 中的查询非常棒，但一开始确实有点奇怪。您可以使用类似 SQL 的语法或使用 lambda 表达式从 Document 中选择节点。然后创建包含您感兴趣的数据的匿名对象（或使用现有类）。

最好是在行动中看到它。

*   [LINQ to XML 的杂项示例](http://code.msdn.microsoft.com/vstudio/LINQ-to-XML-Miscellaneous-9e881847/sourcecode?fileId=23920&pathId=2055777278)
*   [使用 xquery 和 lambdas 的简单示例](http://code.msdn.microsoft.com/vstudio/LINQ-LINQ-to-XML-using-6f2d2218/sourcecode?fileId=24066&pathId=912880959)
*   [表示命名空间的示例](http://code.msdn.microsoft.com/vstudio/LINQ-to-XML-XName-Samples-6ce5f9c3)
*   msdn 上还有更多内容。搜索 LINQ to XML。

根据您的示例 XML 和代码，以下是一个具体示例：

```
var element = XElement.Load(@"C:\div_kid.xml");
var shopsQuery =
    from shop in element.Descendants("shop")
    select new
    {
        Name = (string) shop.Descendants("name").FirstOrDefault(),
        Company = (string) shop.Descendants("company").FirstOrDefault(),
        Categories = 
            from category in shop.Descendants("category")
            select new {
                Id = category.Attribute("id").Value,
                Parent = category.Attribute("parentId").Value,
                Name = category.Value
            },
        Offers =
            from offer in shop.Descendants("offer")
            select new { 
                Price = (string) offer.Descendants("price").FirstOrDefault(),
                Picture = (string) offer.Descendants("picture").FirstOrDefault()
            }

    };

foreach (var shop in shopsQuery){
    Console.WriteLine(shop.Name);
    Console.WriteLine(shop.Company);
    foreach (var category in shop.Categories)
    {
        Console.WriteLine(category.Name);
        Console.WriteLine(category.Id);
    }
    foreach (var offer in shop.Offers)
    {
        Console.WriteLine(offer.Price);
        Console.WriteLine(offer.Picture);
    }
} 
```

另外：这是从平面`category`元素反序列化类别树的方法。您需要一个适当的类来容纳它们，因为 Children 列表必须有一个类型：

```
class Category
{
    public int Id { get; set; }
    public int? ParentId { get; set; }
    public List<Category> Children { get; set; }
    public IEnumerable<Category> Descendants {
        get
        {
            return (from child in Children
                    select child.Descendants).SelectMany(x => x).
                    Concat(new Category[] { this });
        }
    }
} 
```

要创建包含文档中所有不同类别的列表：

```
var categories = (from category in element.Descendants("category")
                    orderby int.Parse( category.Attribute("id").Value )
                    select new Category()
                    {
                        Id = int.Parse(category.Attribute("id").Value),
                        ParentId = category.Attribute("parentId") == null ?
                            null as int? : int.Parse(category.Attribute("parentId").Value),
                        Children = new List<Category>()
                    }).Distinct().ToList(); 
```

[然后将它们组织成一棵树（从平面列表大量](https://stackoverflow.com/questions/4694227/flat-list-to-hierarchy)借用到层次结构）：

```
var lookup = categories.ToLookup(cat => cat.ParentId);
foreach (var category in categories)
{
    category.Children = lookup[category.Id].ToList();
}
var rootCategories = lookup[null].ToList(); 
```

查找包含以下内容的根`theCategory`：

```
var root = (from cat in rootCategories
            where cat.Descendants.Contains(theCategory)
            select cat).FirstOrDefault(); 
```

# css - 背景大小：覆盖 div 而不是背景

> ID：14541161
> 
> 赞同：0
> 
> 时间：2013-01-26T20:16:24.233
> 
> 标签：css, html, background-image, inline

我有一些特定的 div，知道大小。我想用作背景的图片大小不同，所以我想使用 background-size:cover 来确保里面的图片看起来不错，而不是被拉伸或只显示其中的一部分。

但我找不到实现这一目标的方法。这不起作用的另一个原因是我只*需要*内联分配 background-image 属性。

有没有人知道如何在实际上不是整个视口而只是一个 div 的东西上使用 background-size:cover ？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:27:37.390

试试这些风格：

```
background-size:contain;
background-repeat:no-repeat;
background-position:50% 50%; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:23:36.817

添加具有以下属性的类，将此类与该 div 一起使用，并确保为了保持纵横比，您在另一个相对定位的 div 中将宽度和高度设置为 100%

```
background: url(images/bg.jpg) no-repeat center center fixed; 
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:33:46.110

**编辑：**

调整 jsfiddle 中的框架大小，您会观察到图像不会缩小到最小宽度（以百分比设置）以下，而它可以根据可用空间进行扩展

[http://jsfiddle.net/UQP78/12/](http://jsfiddle.net/UQP78/12/)

[http://jsfiddle.net/UQP78/10/](http://jsfiddle.net/UQP78/10/)

```
<div id="bg">
    <img src="http://www.faber04blog.com/wp-content/uploads/2012/08/jquery" alt="">
</div>

#bg {
    position:fixed; 
    top:-50%; 
    left:-50%; 
    width:150%; 
    height:150%;
}
#bg img {
    position:absolute; 
    top:0; 
    left:0; 
    right:0; 
    bottom:0; 
    margin:auto; 
    min-width:25%;
    min-height:25%;
} 
```

[http://jsfiddle.net/UQP78/7/](http://jsfiddle.net/UQP78/7/)

# prolog - 知道何时在 prolog 中使用 cut

> ID：14541164
> 
> 赞同：44
> 
> 时间：2013-01-26T20:16:59.367
> 
> 标签：prolog, prolog-cut

我参加了一门课程，其中我学到了一些序言。我不知道如何/何时使用削减。即使我了解削减的一般概念，但我似乎无法正确使用它们。任何人都可以简要解释一下，或者就他们可以推荐的“削减”提供一个很好的教程（不是 learnprolognow.org）吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-28T05:34:41.437

**TL; DR：**不要。

剪切修剪 Prolog 的搜索树。也就是说，给定一个没有切割的纯 Prolog 程序和有切割的相同程序，唯一的区别是有切割的程序可能在无结果的分支上花费的时间更少，因此效率更高；可能有更少的答案；它也可能会终止，而原始程序不会。

听起来很无害……甚至有用，不是吗？嗯，大多数时候事情都比较复杂。

## 红色切割

剪辑的使用方式常常使得没有剪辑的程序根本没有任何有意义的意义。这种切割称为红色切割。在更好的情况下，它用于实现非单调否定的粗略形式。而在其他一些情况下，它一半是否定，一半是非常难以理解的程序意义。不仅适用于程序的读者，也适用于其作者。事实上，这样的使用往往在无意中缺乏*坚定性*。无论如何：这些削减不会*放入*现有程序中。他们应该从一开始就参与该计划。

对于此类红色切割的更结构化用途，最好使用`once/1`,`(\+)/1`或`(;)/2`– if-then-else like`( If -> Then ; Else )`代替。更好的是，尝试通过发出`instantiation_error`s 来防止此类构造被意外使用。或使用[`iwhen/2`](https://stackoverflow.com/a/40449516/772868)会产生实例化错误或`when/2`（在 SWI、YAP、SICStus 中提供）会延迟目标。

## 绿色削减

删除无用选择点（以及冗余答案）的切割称为绿色切割。但请注意：您不能简单地将它们放入您的程序中`!`，然后按一些`#00ff00`. 大多数情况下，您需要一个干净的只读保护程序，以确保不会出现这种情况`#ff0000`。还有一种简单的方法可以安全地删除一些剩余的选择点：[`call_semidet/1`](https://stackoverflow.com/a/12942551/772868). 以下是一些相关案例：

*   [这个查询的 SLD 树是什么？](https://stackoverflow.com/questions/13162803/whats-the-sld-tree-for-this-query/13165981)

*   [Prolog 附加切割运算符](https://stackoverflow.com/questions/11360026/prolog-append-with-cut-operator/12710995#12710995)

*   [后继算术和的最佳绿色削减是什么？](https://stackoverflow.com/questions/13300231/what-are-the-optimal-green-cuts-for-successor-arithmetics-sum/13311382#13311382)

*   [在 Prolog 中实现“last”](https://stackoverflow.com/questions/11734986/implementing-last-in-prolog/11736042#11736042)

## 剪切不是提交

最后，让我指出 cut 不是提交操作符。它有时有点像它，但需要很多限制才能成为一个。提交运算符不能（ab）用于实现`(\+)/1`. 提交要求每个子句彼此独立地尝试。因此，每个子句都需要一个完整的保护；它不能依赖于仅在先尝试了其他一些条款之后才进行尝试。此外，必须在谓词的每个子句中发生提交。切割可以发生在任何地方。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-27T00:53:47.933

削减*承诺*将 Prolog 目标证明为已完成的选择。

当程序员*知道*不能尝试任何可用的替代方案时，*必须使用它。*

最突出的用途是*通过失败实现否定*。

```
fact(a).
fact(b).

/* 1 */ neg(X) :- call(X), !, fail.
/* 2 */ neg(_). 
```

在这里，我（重新）定义了标准的否定运算符，通常是 ( [\+](http://www.swi-prolog.org/pldoc/doc_for?object=%28%5C%2b%29/1) )/1

```
?- neg(fact(c)).
true. 
```

`call(fact(c))`无法证明规则 1，则替代规则 2 成功。

```
?- neg(fact(a)).
false. 
```

因为`fact(a)` *可以*证明，cut 在失败之前放弃了替代方案。

```
?- neg(fact(X)).
false. 
```

至少存在一个未知的 X 使得 fact(X) 成功。

```
?- neg(neg(fact(X))).
true. 
```

双重否定的效果是变量*不受约束*。这在进行元编程时很有用，可以在不改变其“结构”的情况下获取子句。从操作的角度来看，很清楚（？）发生了什么，但程序确实失去了它的*声明*性属性。

另一个只在初级解释器中有用的用途是指示系统执行*最后一次调用优化*，在递归调用前面加上一个cut。然后系统可以避免分配通常需要跟踪替代点的堆栈空间。一个虚拟的例子：

```
print_list([E|Es]) :- print_element(E), !, print_list(Es).
print_list([]). 
```

*关于教程的编辑*：我发现 William Clocksin 的“Clause and Effect”包含与 cut 相关的详细调查：第 4 章“Choice and Commitment”完全致力于 cut 的利弊。归根结底，主要是缺点...

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-01-28T16:16:49.597

在使用切割之前，我要求我的谓词满足以下两个条件：

*   它给出了正确的答案，没有删减
*   如果重新排序子句，它会给出正确的答案

一旦我的谓词表现得那样，我有时会添加一个剪切来修剪不需要的不确定性。

例如，用于测试数字是正数、负数还是零的谓词。

```
sign(N, positive) :-
    N > 0.
sign(N, negative) :-
    N < 0.
sign(N, zero) :-
    N =:= 0. 
```

每个条款完全独立于其他条款。我可以对这些子句重新排序或删除一个子句，而其余子句仍然给出预期的答案。`positive`在这种情况下，我可能会在and子句的末尾删减，`negative`只是为了告诉 Prolog 系统它不会通过检查其他子句来找到更多解决方案。

可以使用 using 编写类似的谓词而不使用 cut `-> ;`，但有些人不喜欢它的外观：

```
sign(N, Sign) :-
    (   N > 0 -> Sign=positive
    ;   N < 0 -> Sign=negative
    ;            Sign=zero
    ). 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-14T04:16:12.183

剪切谓词可防止回溯。剪切谓词被指定为感叹号 (!)。Cut 修剪搜索树并通过 prolog 解释器缩短路径轨迹。从语义上讲，它总是成功的。

```
read(a).
read(b).
color(p, red) :- red(p).
color(p,black) :- black(p),!.
color(p,unknown).

?-color(X,Y).
  X = a,
  Y = red;
  X = b,
  Y = black; 
```

如果没有切入，则在 Y=black 之后，Y=unknown 会显示 Y=unknown。

**有两种类型的切割谓词：**

**绿切：**绿切是一种对陈述意义没有影响的切分。它仅用于提高效率并避免不必要的计算。从程序中删除绿色剪辑不会改变程序的含义。

**红切：**红切是对陈述意义有影响的一种。从程序中删除红色剪切改变了程序的含义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-27T21:53:27.570

`once`找到谓词后，所有内容都从我的代码中消失了。在内部它的行为就像

```
once(X) :- X, !. 
```

我发现它对于在我做某事之前就如何做某事做出坚定的决定非常有用。

例如，这是我的标准元解释器。该`maybe1/1`子句在其参数中具有独特的函子，因此一旦它们知道，就`maybe1/1`可以完美地选择正确的。

找到该独特功能的工作交给了`maybe0/2`预处理器，该预处理器设置`Y`了关于`X`.

如果没有`once`，这将不得不充满削减。例如`maybe1`，有三/两种不同的解释`X/Y`，`or`我们需要以自上而下的方式检查。但检查一下 - 没有削减。

```
maybe(X) :- 
    once(maybe0(X,Y)), maybe1(Y).

maybe0(true,       true).
maybe0((X,Y),      (X,Y)).
maybe0((X;Y),      or(L))          :- o2l((X;Y),L).
maybe0(X,          calls(X))       :- calls(X).
maybe0(X/Y,        fact(X/Y))      :- clause(X/_, true).
maybe0(X/Y,        rule(X/Y))      :- clause(X/_,_).
maybe0(X/Y,        abducible(X/Y)).
maybe0(or([H|T]),  or([H|T])).
maybe0(or([]),     true).

maybe1(true).
maybe1((X,Y))        :- maybe(X),maybe(Y).
maybe1((X;Y))        :- maybe(X);maybe(Y).
maybe1(abducible(X)) :- assume(X,0).
maybe1(fact(X))      :- assume(X,1), one(X).
maybe1(rule(X))      :- assume(X,2), one(clause(X,Y)), maybe(Y).
maybe1(calls(X))     :- one(clause(X,Y)), maybe(Y).
maybe1(or([H|T]))    :- any(One,Rest,[H|T]), ignore(maybe(One)), maybe(or(Rest)). 
```

# c# - 使用转换器时的 Json MissingMemberHandling

> ID：14541165
> 
> 赞同：1
> 
> 时间：2013-01-26T20:16:59.457
> 
> 标签：c#, serialization, json.net

使用 Json.NET 反序列化保存的接口对象而不定义其实现类型会引发错误（当然），所以我编写了一个可重用的类：

```
public class MakeJsonConverter<TParent, TChild> : JsonConverter where TChild:TParent
{
    private readonly Type _parent;
    private Type _child;

    public MakeJsonConverter()
    {
        _parent = typeof(TParent);
        _child = typeof(TChild);
    }

    public override bool CanConvert(Type objectType)
    {
        return (objectType == _parent);
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        return serializer.Deserialize<TChild>(reader);
    }

    //This should never be called. Only reading from saved interface data was an issue without using a converter.
    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        throw new NotImplementedException();
    }
} 
```

它工作正常，除了我传递给它的设置似乎没有被使用。实际上我不确定，我所知道的是 MissingMemberHandling.Error 不起作用。

```
public virtual string SerializeWithConverter<TParent, TChild>(TParent obj) where TChild : TParent
{
    var settings = new JsonSerializerSettings
    {
        ReferenceLoopHandling = ReferenceLoopHandling.Ignore,
        ContractResolver = new DefaultContractResolver
        {
            DefaultMembersSearchFlags =
                BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance
        },
        TypeNameAssemblyFormat = FormatterAssemblyStyle.Simple,
        ConstructorHandling = ConstructorHandling.AllowNonPublicDefaultConstructor,

        //Settings important to this situation
        MissingMemberHandling = MissingMemberHandling.Error,
        Converters = new List<JsonConverter> { new MakeJsonConverter<TParent, TChild>() }
    };

    return JsonConvert.SerializeObject(obj, Formatting.Indented, settings);
} 
```

我似乎无法弄清楚为什么会这样工作..谁能解释一下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T13:01:26.037

序列化和反序列化时尝试添加 TypeNameHandling = TypeNameHandling.All

如果您有要反序列化的嵌套对象结构，这可能有助于反序列化器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-15T16:26:43.690

当您说 MissingMemberHandling.Error 不起作用时，您到底是什么意思？我假设这是因为当用户超过/低于发布与您的对象不匹配的对象时，您期望出现错误？无论哪种方式，我相信当您设置自己的自定义 ContractResolver 时，MissingMemberHandling.Error 不会抛出。相反，创建您自己的继承自 DefaultContractResolver 的类并覆盖 JsonObjectContract。这将提供类似于您所期望的结果。

```
 public class CustomContractResolver : DefaultContractResolver
    {
        protected override JsonObjectContract CreateObjectContract(Type objectType)
        {
            var contract = base.CreateObjectContract(objectType);
            contract.ItemRequired = Required.Always;
            return contract;
        }
    } 
```

然后将其用作您的合同解析器

```
ContractResolver = new CustomContractResolver(), 
```

为我测试和工作

# macos - 想写一个可以切换网络的程序（无线）

> ID：14541172
> 
> 赞同：1
> 
> 时间：2013-01-26T20:17:44.797
> 
> 标签：macos, networking, network-programming

我的财产上有两个单元，一个住宅，另一个现在是办公室。我在每个地方都有一个 Airport Extreme，它们是桥接的。可悲的是，设备（iPad、手机、笔记本电脑）中的基本软件在决定何时更换网络方面做得非常糟糕。真正糟糕的是我有时会打一些电话，即使另一个网络在那里并且信号很好，电话也会掉线。

我在 Apple Discussion Forums 上发帖，一位老兄给了我一个很好的答案，但听起来他们的推理仍然不会产生好的结果。

我想编写一个执行此操作的程序：

1.  它一看到信号下降，就会寻找另一个网络。
2.  然后它开始监测两者之间的信号*比*。
3.  一旦它对另一个的偏爱超过了边际量，它就会改变。

我希望这不会被视为管理员问题。这是一道编程题。有没有人对 Apple 的开发人员工具为此提供的框架有任何经验？

谢谢。

# math - 如何证明 3n + 2log n = O(n)

> ID：14541178
> 
> 赞同：-2
> 
> 时间：2013-01-26T20:18:20.003
> 
> 标签：math, big-o

如何使用 big-O 的定义证明 3n + 2log n = O(n)？

C 应该是 6，而 k 是 1，但我不知道它是如何找到的。很多帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T20:22:48.800

为了正式证明这个结果，你需要找到一个 n [0]和 c 的选择，使得

> 对于任何 n ≥ n [0] : 3n + 2log n ≤ cn

首先，请注意，如果您有任何 n ≥ 1，则 log n < n。因此，如果你考虑任何 n ≥ 1，你有

> 3n + 2log n < 3n + 2n = 5n

因此，如果你选择 n [0] = 1 和 c = 5，你有

> 对于任意 n ≥ n0：3n + 2log n < 3n + 2n = 5n ≤ cn

因此 3n + 2 log n = O(n)。

更一般地说，当给定这样的问题时，尝试识别主导项（这里是 n 项）并尝试找到一些 n [0]的选择，以使非主导项被主导项压倒。完成此操作后，剩下要做的就是选择正确的常数 c。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:20:29.440

疯狂的猜测（你的问题很不清楚）：任务是证明

```
O(3n + 2log n) = O(n) 
```

现在结果是这样的：`n -> n`增长速度比 快`n -> log n`，并且由于复杂性是**渐近的，**所以只有增长最快的项才重要，`n`在这种情况下就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:23:25.830

如果我没记错的话，你可以证明以下几点：如果 f1(n)=O(g1(n)), f2(n)=O(g2(n)) 那么 f1(n)+f2(n)=O(max {g1(n),g2(n)})。从那里开始很简单。

# python - Python中的递归函数中的多线程

> ID：14541179
> 
> 赞同：1
> 
> 时间：2013-01-26T20:18:22.747
> 
> 标签：python, multithreading, recursion

我有一个递归调用自身的函数。这是一个例子：

```
def f(a,b=0):
    if b < 5:
        for i in range(10):
            a += f(a+i,b+1)
    return a+b

print f(3) 
```

现在我想在函数内部同时运行 10 个函数调用，每个调用都在一个单独的线程中，但同时从一个变量中获取所有返回。

有人能引导我走向正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:08:02.617

尝试更准确地考虑您希望多线程如何工作。

您提出问题的方式表明您希望为每个递归函数调用生成 10 个线程。这意味着在单级递归之后，您将拥有 100 个线程，在 2 级之后，您将拥有 1000 个线程，依此类推。除非您尝试冻结操作系统，否则这可能不是您想要的。

两种选择包括：

1.  仅在第一次调用时产生线程，而不是在递归调用时产生线程，或者
2.  创建线程池并使用[工作队列](http://docs.python.org/2/library/multiprocessing.html#exchanging-objects-between-processes)。

另一种方法是考虑函数正在完成的数学运算并对其进行分析简化以避免循环和/或递归。

# python - Python Daemon 定期调用子进程

> ID：14541182
> 
> 赞同：-1
> 
> 时间：2013-01-26T20:18:43.200
> 
> 标签：python, subprocess, python-daemon

我正在基于[Sander Marechal 的](http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/)代码构建一个简单的 pyhon 守护进程。Daemon 的全部目的是每秒运行一个 php 文件（php 文件循环通过数据库检查值和更新数据库）。部分出现问题

> subprocess.call(['php','test.php'])

我可以在 shell 上运行“php test.php”，它会做它应该做的事情，但是当它从守护进程定期调用时，它似乎没有被执行。我也知道守护进程通过检查正在运行的进程 ps aux | 在后台工作 grep "daemon-example" 我还包括一个 do_something 函数，它记录每次函数执行的时间并将时间附加到文本文件中。

```
#!/usr/bin/env python
import sys, time,subprocess
from daemon import Daemon

def runphp():
    #subprocess.call(['php ~/pydaemon/test.php'], shell=True)
    subprocess.call(['python', 'test.py'])
def do_something():
    with open("/tmp/current_time.txt",'a') as f:
        f.write("The time is now\n" + time.ctime())

class MyDaemon(Daemon):
    def run(self):
        while True:
            time.sleep(1)
            do_something()
            subprocess.call(['php','test.php'])
            #runphp()
if __name__ == "__main__":
    daemon = MyDaemon('/tmp/daemon-example.pid')
    if len(sys.argv) == 2:
        if 'start' == sys.argv[1]:
            daemon.start()
        elif 'stop' == sys.argv[1]:
            daemon.stop()
        elif 'restart' == sys.argv[1]:
            daemon.restart()
        else:
            print "Unknown command"
            sys.exit(2)
        sys.exit(0)
    else:
        print "usage: %s start|stop|restart" % sys.argv[0]
        sys.exit(2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:07:31.480

您尝试运行的脚本未执行，因为工作目录是根目录`('/')`，这是因为这段代码：

```
# decouple from parent environment
os.chdir("/") 
```

所以实际上你的代码试图执行: `python /test.py`(它不存在) 而不是`'your_current_directory/test.py'`.
要修复它，请删除`os.chdir("/")`或提供文件的完整路径，如下所示：

```
subprocess.call(['python','my_full_path_to_working_directory/test.py']) 
```

# css - 如何在 LESS 中使用 SVG

> ID：14541184
> 
> 赞同：1
> 
> 时间：2013-01-26T20:18:52.250
> 
> 标签：css, svg, less

我正在尝试使用内联 SVG（内联对于这个项目非常重要，因为它需要在单个 css 文件中轻松移植）并且我决定使用 LESS。我找到了这个页面[http://blog.philipbrown.id.au/2012/09/base64-encoded-svg-gradient-backgrounds-in-less/](http://blog.philipbrown.id.au/2012/09/base64-encoded-svg-gradient-backgrounds-in-less/)它谈到了一种方法来做到这一点。但是我似乎无法让它工作。我正在使用带有 LESS 编译器插件的 PHPStorm，它会引发语法错误...

```
3:13:14 PM LESS CSS Compiler Error: filters.less: Syntax Error: JavaScript evaluation error: `(function(a,b,c){function e(a){a=a.replace(/\r\n/g,'\n');var b='';for(var c=0;c127&&d>6|192);b+=String.fromCharCode(d&63|128)}else{b+=String.fromCharCode(d>>12|224);b+=String.fromCharCode(d>>6&63|128);b+=String.fromCharCode(d&63|128)}}return b}function f(a){var b='';var c,f,g,h,i,j,l;var m=0;a=e(a);while(m>2;i=(c&3)>4;j=(f&15)>6;l=g&63;if(isNaN(f)){j=l=64}else if(isNaN(g)){l=64}b=b+d.charAt(h)+d.charAt(i)+d.charAt(j)+d.charAt(l)}return b}var d='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';return a+f(b)+c})('url(data:image/svg+xml;base64,','#grayscale',')')` (line 30, column 2) near
.blurToClear {
  .blur();
} (show balloon) 
```

这是我的CSS：

```
.blur (@level: 3px) {
  @svg: ~"<svg xmlns='http://www.w3.org/2000/svg'><filter id='blur'><feGaussianBlur stdDeviation='@level' /></filter></svg>#grayscale";

  /* To change level of blur, adjust all "3" to a different number */
  filter: blur(@level);
  -webkit-filter: blur(@level);
  -moz-filter: blur(@level);
  -o-filter: blur(@level);
  -ms-filter: blur(@level);
  .base64DataUriBackground(@svg);
}

.clearToBlur:hover,
.blurToClear {
  .blur();
}

//encode SVG xml as base 64
//http://blog.philipbrown.id.au/2012/09/base64-encoded-svg-gradient-backgrounds-in-less/
.base64DataUriBackground (@encode, @property: ~"filter", @type: ~"image/svg+xml") {
  @dataUriPrefix: ~"url(data:@{type};base64,";
  @dataUriSuffix: ~")";

  // with btoa()
  //@b64DataUri: ~`(function(a,b,c){return a+btoa(b)+c})('@{dataUriPrefix}','@{encode}','@{dataUriSuffix}')`;

  // without
  @b64DataUri: ~`(function(a,b,c){function e(a){a=a.replace(/\r\n/g,'\n');var b='';for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);if(d<128){b+=String.fromCharCode(d)}else if(d>127&&d<2048){b+=String.fromCharCode(d>>6|192);b+=String.fromCharCode(d&63|128)}else{b+=String.fromCharCode(d>>12|224);b+=String.fromCharCode(d>>6&63|128);b+=String.fromCharCode(d&63|128)}}return b}function f(a){var b='';var c,f,g,h,i,j,l;var m=0;a=e(a);while(m<a.length){c=a.charCodeAt(m++);f=a.charCodeAt(m++);g=a.charCodeAt(m++);h=c>>2;i=(c&3)<<4|f>>4;j=(f&15)<<2|g>>6;l=g&63;if(isNaN(f)){j=l=64}else if(isNaN(g)){l=64}b=b+d.charAt(h)+d.charAt(i)+d.charAt(j)+d.charAt(l)}return b}var d='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';return a+f(b)+c})('@{dataUriPrefix}','@{encode}','@{dataUriSuffix}')`;

  @property: @b64DataUri;
} 
```

关于如何将 SVG 与 LESS 集成的任何建议？可能吗？我也试过这个`with btoa()`方法，它抛出了同样的错误。

**更新 - - - - - - - - - - - - - - - - - - - - - - - - - ---------** 我试过直接把SVG放进去。当我这样做...

```
.blur (@level: 3px) {
  //@svg: ~"<svg xmlns='http://www.w3.org/2000/svg'><filter id='blur'><feGaussianBlur stdDeviation='@level' /></filter></svg>#grayscale";

  /* To change level of blur, adjust all "3" to a different number */
  filter: blur(@level);
  -webkit-filter: blur(@level);
  -moz-filter: blur(@level);
  -o-filter: blur(@level);
  -ms-filter: blur(@level);
  filter: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='blur'><feGaussianBlur stdDeviation='3' /></filter></svg>#grayscale");
} 
```

我明白这个...

```
.clearToBlur:hover,
.blurToClear {
  /* To change level of blur, adjust all "3" to a different number */

  filter: blur(3px);
  -webkit-filter: blur(3px);
  -moz-filter: blur(3px);
  -o-filter: blur(3px);
  -ms-filter: blur(3px);
  filter: url("data:image/svg+xml");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T11:51:16.083

您的代码与您引用的网站的代码有两个很大的不同：

首先，当站点中的解决方案将其设置为 IE9 的基本属性并保持IE8 及以下版本的默认值时，您尝试设置`svg`on属性。`filter``background``filter`

其次，与第一个相关，这与其说是 SVG 和 LESS 的问题，不如说是 SVG 在`filter`. 我不相信 Microsoft 的`filter`财产以`svg`你试图做的方式工作。您想要模糊元素，而不是更改背景。我不知道在纯 css 中使用 SVG 的方法。但是，“为什么”你需要？不能为 IE 设置[模糊滤镜](http://msdn.microsoft.com/en-us/library/ms532979%28v=VS.85%29.aspx)吗？

# git - 如何在 Git 中保持分支层次结构？

> ID：14541185
> 
> 赞同：4
> 
> 时间：2013-01-26T20:19:05.980
> 
> 标签：git

简单地说，我创建了一个像这样的 git 分支结构：

![在此处输入图像描述](../Images/42bb8825f53e8b398e738b7e6bde62c9.png)

生成自：

```
git init
echo "Hello World" > file1.txt
git add file1.txt
git commit -m "Hello world"
git checkout -b A
echo "This is from A branch" > file2.txt
git add file2.txt
git commit -m "from A branch"
git checkout -b B
echo "This is from B branch" >> file2.txt
git commit -a -m "from B branch" 
```

现在我克隆这个结构并同步`master`和分支：`A``B`

```
git clone /path-to-source/
git checkout -b master remotes/origin/master
git checkout -b A remotes/origin/A 
```

克隆的存储库反映了源层次结构：

![在此处输入图像描述](../Images/904555355e70215c5c9bcb15d9174177.png)

现在我返回到源文件夹并添加一些东西到 master 和 rebase A 和 B：

```
cd /path-to-source/
git checkout master
echo "more files" > file3.txt
git add file3.txt
git commit -m "Improved master"
git checkout A
git rebase master
git checkout B
git rebase A 
```

![在此处输入图像描述](../Images/d844e8557c1842b01a7c8514c5b51587.png)

当我返回克隆的存储库并尝试保留此结构时，问题就出现了。如果我只是分支，我会得到这个`pull`：`master`

![在此处输入图像描述](../Images/b38b0038a50497fe969b943ab40e9c82.png)

我可以去每个分支并更新：

```
git checkout A
git pull 
```

但我得到这样的分支树：

![在此处输入图像描述](../Images/f4171372ff24d4019ca301e6a4414deb.png)

问题是，如何保持存储库的干净克隆？是的，我想在克隆的存储库中获得这个（操纵的图形）：

![在此处输入图像描述](../Images/699ad2f09db1aa5ae2092e5b85e3b9c1.png)

**奖励**：如果可能的话，我想找到一种方法来保持在`A`or`B`分支中的提交，如下所示：

![在此处输入图像描述](../Images/1d12cd39c7441f3f8b7ee18e81ee02a9.png)

从源存储库中的这些命令生成：

```
git checkout A
echo "something" > other.txt
git add other.txt
git commit -m "Other A commit"
git checkout B
git rebase A 
```

**注意 1**：如果有帮助，克隆的存储库永远不会提交 **注意 2**：您可以假设只有 1 个用户提交到源存储库

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T20:23:50.917

变基意味着更改 SHA1，因此克隆中的分支 A 不再有效。

您可以按照“[在有人将变基或重置推送到已发布的分支后如何恢复/重新同步？](https://stackoverflow.com/questions/4084868/how-do-i-recover-resynchronise-after-someone-pushes-a-rebase-or-a-reset-to-a-pub) ”来恢复克隆的分支 A（灵感来自“[从上游](http://git-scm.com/docs/git-rebase#_recovering_from_upstream_rebase)变基中恢复”部分）。

但如果：

*   这些变基是经常发生的，
*   您在分支 A 和分支 B 的克隆上没有任何新提交

您可能只想根据它们的`origin/A`和重置这些分支（在克隆上） `origin/B`：您将分支`A`HEAD 重置为`origin/A`.

```
git branch -f origin/A 
```

# php - 文件路径必须是英文吗

> ID：14541191
> 
> 赞同：4
> 
> 时间：2013-01-26T20:19:48.517
> 
> 标签：php

我正在尝试使用 PHP 验证目录是否存在：

```
is_dir('C:\Users\Администратор\Desktop\Среда чтения') 
```

但结果总是错误的。我是否必须用英文命名一个目录才能让 PHP 正确使用它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:21:32.897

尝试在你的脚本中使用 utf-8 也检查斜杠

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T20:30:35.113

## 在窗户上

文件系统始终是 UCS-2，不幸的是 PHP 不是那么聪明。我不确定是否`is_dir()`简化为 ANSI API 调用或 WideString，但使用 ANSI 是有意义的。在这种情况下，您将受制于“非 Unicode 程序语言”操作系统设置。您将无法访问错误语言的文件名。

## 在 Linux 上

这不是那么简单。文件系统本身并没有真正的文本编码，这让事情变得很尴尬。西里尔文文件名可以存储在 UTF-8 或 Windows-1252（或其他任何格式）中，这取决于创建/读取文件的软件来识别编码是什么。文件系统只是将一堆字节存储为“文件名”。PHP 也不关心文本编码，所以你真的需要事先知道文件名的编码是什么，这样你才能将正确的字符串传递给`is_dir()`.

## 总之

我强烈建议在使用 PHP 时避免使用文件名中的非英文字符。很难做到正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T00:56:19.010

举个具体的例子，你可以反过来看问题：

## 存在哪些目录

```
$dirs = scandir('C:\Users');
print_r($dirs); 
```

由于您知道有一个名为“Администратор”的文件夹 - 看看 php 如何显示它。通过获取 php 收到的结果，您有望确定特定文件夹的正确编码。如果编码是一致的（根据[Vilx-](https://stackoverflow.com/a/14541281/761202)它是一致的），则应该可以处理任何带有西里尔字符的文件夹/文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T20:24:02.650

您可以检查是否`file_exists()`：

```
if(file_exists('C:\Users\Administrator\Desktop\Wednesday read'))
{
    // Do your thing...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T21:17:21.433

这个问题可能是因为你没有“转义”反斜杠，因此，PHP 尝试这样做：

```
is_dir('C:UsersАдминистраторDesktopСреда чтения') 
```

这是行不通的。

尝试转义反斜杠；

```
is_dir('C:\\Users\\Администратор\\Desktop\\Среда чтения') 
```

尽管使用“斜线”也适用于 Windows 上的 PHP；

```
is_dir('C:/Users/Администратор/Desktop/Среда чтения') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-26T20:25:16.397

不要使用管理员权限！

使用 UTF-8。

使用 linux，至少在 VM 中。它将为您节省大量时间。

你永远不应该依赖非 ASCII 路径！

使用 file_exists() 函数测试文件/目录是否存在： http: [//php.net/manual/en/function.file-exists.php](http://php.net/manual/en/function.file-exists.php)

# c++ - Visual Studio 中的错误 C2061

> ID：14541193
> 
> 赞同：4
> 
> 时间：2013-01-26T20:20:01.803
> 
> 标签：c++

我尝试在我的代码中引用另一个类的结构，它给了我一个错误，说我有语法问题。

```
#pragma once

#include "Definitions.h"

#include "GV.h"
#include "UI.h"
#include "Tile.h"
#include "Item.h"

class Figure {
public:
    //Figure index
    struct FIGURE_TYPE {
        //Where to crop the image from
        SDL_Rect crop;
        int x;
        int y;
    };

    //The game figure
    FIGURE_TYPE figure_index[FIGURE_COUNT];

    //The figure array
    int figure_array[MAP_HEIGHT / 64][MAP_WIDTH / 64];

    //Functions
    Figure ( void );
    bool draw_figures ( SDL_Surface* screen, SDL_Surface* figures, SDL_Rect camera, Figure::FIGURE_TYPE figure_spec[FIGURE_COUNT] );
}; 
```

这就是Figure.h中的结构，

```
#pragma once

#include "Definitions.h"

#include "GV.h"
#include "Tile.h"
#include "Item.h"
#include "Figure.h"

class UI {
public:
    UI ( void );
    void set_camera ( SDL_Rect& camera, Figure::FIGURE_TYPE figure_spec[FIGURE_COUNT] );
    bool draw_map ( SDL_Surface* screen, SDL_Rect& camera, SDL_Surface* tiles, SDL_Surface* figures, Figure::FIGURE_TYPE figure_spec[FIGURE_COUNT] );
    bool draw_status ( void );
}; 
```

这就是我从另一个名为 UI.h 的头文件中引用它的地方。我知道引用结构存在问题，我只是不知道如何解决它。很简单的问题，有大神帮忙吗？

问题**不**在于 Figure 类型是在 Figure.h 之外声明的，或者它是私有的而不是公共的。

# 错误报告

> 错误 1 ​​error C2653: 'Figure' : is not a class or namespace name c:\users\jim\documents\c++\roguelike\roguelike\ui.h 13 1 roguelike
> 
> 错误 3 error C2653: 'Figure' : is not a class or namespace name c:\users\jim\documents\c++\roguelike\roguelike\ui.h 14 1 roguelike
> 
> 错误 2 错误 C2061：语法错误：标识符 'FIGURE_TYPE' c:\users\jim\documents\c++\roguelike\roguelike\ui.h 13 1 roguelike
> 
> 错误 4 错误 C2061：语法错误：标识符 'FIGURE_TYPE' c:\users\jim\documents\c++\roguelike\roguelike\ui.h 14 1 roguelike

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-26T20:35:53.963

你有一个循环依赖：UI.h 依赖于 Figure.h，Figure.h 依赖于 UI.h。您需要通过删除`#include`另一个文件中的一个文件来打破循环依赖关系。在这种情况下，由于我在 Figure.h 中没有看到使用 UI.h 中的任何内容的任何内容，因此您应该`#include "UI.h"`从 Figure.h 中删除并进行所有设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:36:02.107

你的语法很好。

不好的是您的标头之间存在循环依赖关系，这会破坏您`#include`的 s.

在这种情况下，它会导致`Figure`在“UI.h”中不可见；即使您的语法是正确的，这也会导致您看到的错误，因为“UI.h”不*知道*您的语法是否正确，因为它不知道是什么`Figure`。

没有循环依赖。尽可能使用[前向声明](http://en.wikipedia.org/wiki/Forward_declaration)来帮助您。

# caching - 如何保持分布式缓存清洁？

> ID：14541194
> 
> 赞同：0
> 
> 时间：2013-01-26T20:20:02.733
> 
> 标签：caching, redis, appfabric

在 N 层架构中，最好使用什么模式来保持缓存清洁？

我知道设置一个绝对/滑动超时很容易，但是有没有更好的机制可以让您在更新底层持久性后将缓存标记为脏。

我试图解决的困难是缓存通常存储为 KVP。但是查询通常比这复杂一点。那么网关服务如何告诉缓存存储对于这样那样的查询，它需要从持久性中重新获取。

我也不能为每个查询手动编码缓存更新。我正在寻找一种更系统的方法。

这只是一个白日梦，还是有什么方法可以优雅地做到这一点？

链接/指南/帖子表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T03:26:16.327

我曾与 AppFabric 合作过，我认为尝试做你所要求的。我在一个拍卖网站上工作，我想主动使缓存中的物品无效。

例如，我们有列表（待售物品），它们将出现在整个缓存 (AppFabric) 中。代表列表的数据位于 10 个不同的位置。我最初想要的是一种表达方式，“好吧，我的列表已经改变了。让我去缓存中找到它存在的任何地方，然后更新。” （我认为您在问题中说“标记为脏”）

我发现这样做非常困难。我尝试使用 AppFabric 中的标签，因此我会用标签标记给定对象（或对象集合），这样我就可以查询缓存并删除项目。换句话说，如果一个对象有一个 LISTING 标签，我会找到它并使其无效。

最终，我选择了双管齐下的进攻。

1.  对于 95% 的数据，我让它过期。当我决定这样做时，那是快乐的一天，因为一切都变得更容易开发。我不得不在 UI 等方面做出一些让步，但这是非常值得的。

2.  对于最后 5% 的数据，我决定只存储一次。例如，对列表的出价。每当有新的出价出现时，我们都会主动使该对象无效，然后需要该信息的所有内容也会更新。

# android - mini6410 spi编程使用android

> ID：14541201
> 
> 赞同：1
> 
> 时间：2013-01-26T20:20:53.227
> 
> 标签：android, header, include, spi

我正在使用 android 使用 spi_s3c.c 读取 spi
这个文件及其标题： spi_s3c.h 包括一些我在公司提供的包含文件夹中找不到的标题（友好的 arm dvd）

例如 spi_s3c.h 包含这些行：

```
#include <mach/s3c-dma.h>
#include <mach/map.h>
#include <mach/gpio.h>
#include <plat/regs-gpio.h>
#include <plat/gpio-cfg.h>
#include <plat/spi.h> 
```

s3c-dma.h 存在于：D​​VD\android-kernel-2.6.28.20100724\linux-2.6.28.6-ansroid\arch\plat-s3c\include\ mach\s3c-dma.h

但是该路径上不存在 map.h 和 gpio.h 文件
我不想重新定位这些路径（因为几个包含的文件）
，现在我可以在哪里获得一致的包含文件夹？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T13:55:59.240

spi_s3c.c 等驱动文件不能单独编译。相反，我们应该将它们（驱动程序）编译为 android 内核的一部分。在内核编译期间，所有需要的头文件都可用（使用 cross_compile）。确保您使用正确的 Linux 版本来编译内核（例如，fedora 有一个完整的头文件列表，我们需要编译我们的 android 内核）。那么我们需要在这台 Linux 机器上安装一个 gcc 编译器。最后进行编译。

# c# - 正则表达式替换每个换行符

> ID：14541202
> 
> 赞同：3
> 
> 时间：2013-01-26T20:20:55.973
> 
> 标签：c#, regex, replace, newline

我需要用另一个字符（比如'X'）替换字符串中的每个换行符。我**不**希望用一个换行符折叠多个换行符！

PS：这个正则表达式用一个换行符替换所有连续的换行符，但这不是我需要的。

```
Regex regex_newline = new Regex("(\r\n|\r|\n)+"); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-26T20:24:56.937

这将用一些东西替换一个或多个换行符，不一定用一个换行符 - 这是由 regex_newline.Replace(...) 调用确定的，您没有显示。

所以基本上，答案是

```
 Regex regex_newline = new Regex("(\r\n|\r|\n)");   // remove the '+'
 // :
 regex_newline.replace(somestring, "X"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-26T20:23:11.567

只需使用该`String.Replace`方法并替换`Environment.NewLine`字符串中的。不需要正则表达式。

[http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)

# gwt - 一次只显示一个面板

> ID：14541207
> 
> 赞同：2
> 
> 时间：2013-01-26T20:21:33.210
> 
> 标签：gwt, panel, gwt-designer

我希望在给定时间在屏幕上的同一位置显示两个面板之一的效果。也许我可以使用 DeckPanel 但在设计器中我将无法编辑隐藏的面板。也许你可以推荐一种技术？

我找到了一个可行的解决方案，但恕我直言。IE。在代码中，我插入了我想要显示的面板并删除了我不想显示的面板（从包含面板）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T09:54:36.317

如果您想以“正确”的方式执行此操作，我建议您研究 GWT 团队[建议用于维护大型 GWT 应用程序](https://developers.google.com/web-toolkit/articles/mvp-architecture)的 MVP 模式。

看看可能的实现：[mvp4g](http://code.google.com/p/mvp4g/)或[gwt-platform](http://code.google.com/p/gwt-platform/)。他们会照顾您切换视图，以及维护历史记录（后退/前进按钮将正常工作）等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T13:26:25.640

您可以选择`Tablayoutpanel`无需维护自己的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:49:01.207

只需将两个面板放在另一个面板中，然后设置它们的可见性。

```
Panel mainPanel = new Panel();
Panel subPanel1 = new Panel();
Panel subPanel2 = new Panel();

mainPanel.add(subPanel1);
mainPanel.add(subPanel2);

subPanel1.setVisible(true);
subPanel2.setVisible(false); 
```

然后，当您想查看面板 2 时，您只需执行以下操作：

```
subPanel1.setVisible(false);
subPanel2.setVisible(true); 
```

# sprite - Corona sprite.timeScale 重置动画开始

> ID：14541209
> 
> 赞同：1
> 
> 时间：2013-01-26T20:21:52.930
> 
> 标签：sprite, coronasdk

如何提高 Corona 中的动画速度？更改`sprite.timeScale`属性会使动画重新开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T20:11:07.687

我没有第一个问题的答案，但对于第二个问题，我们知道论坛搜索很糟糕，我们正在修复它，但与此同时，您的最佳搜索结果来自 Google。做你的谷歌搜索：

```
site:coronalabs.com magic formula 
```

这将为您提供最佳搜索结果，直到问题得到解决。

# iphone - 尝试改变不可变对象错误

> ID：14541212
> 
> 赞同：0
> 
> 时间：2013-01-26T20:22:27.860
> 
> 标签：iphone, ios, objective-c, nsstring, mutable

我的代码在这一行崩溃：

```
[(NSMutableString *)string replaceCharactersInRange:range withString:@""]; 
```

错误尝试改变不可变对象。

这是怎么发生的，我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T20:23:42.417

字符串不是可变的，强制转换不是魔术，它不会把它变成可变字符串。您应该在可变副本上执行此操作：

```
NSMutableString* mutableString= [string mutableCopy];
[mutableString replaceCharactersInRange:range withString:@""]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T20:24:16.980

您正在对不可变字符串进行类型转换，然后对其进行变异，实际上这并没有发生。

您需要创建一个新的 NSMutableString 然后使用`replaceCharactersInRange`...

```
NSMutableString *mutableString=[NSMutableString stringWithString:string];
[mutableString replaceCharactersInRange:range withString:@""]; 
```

如果您希望同一对象中的结果将其设置为字符串。

```
string=mutableString; 
```

# javascript - setAttributes 条件格式

> ID：14541213
> 
> 赞同：0
> 
> 时间：2013-01-26T20:22:34.087
> 
> 标签：javascript, google-apps-script, google-sheets, gs-conditional-formatting

我有一个用于搜索电子表格的搜索脚本。返回值之一是日期。在电子表格上它看起来像`mm/dd/yyyy`，但在文本框中它显示一个完整的日期，如`Fri May 10 2013 03:00:00 GMT`代码行看起来像：

`txt1.setText(data[nn][14]);`

如何让它看起来像 mm/dd/yyyy 01/26/2013？我试过了

`var date = (Date(data[nn][14]), "EST", "MM/dd/yyyy")`但它从字面上显示 MM/dd/yyyy

我也有`txt1.setText(data[nn][0]).setStyleAttribute("background", "cyan");`那个颜色重要的盒子。就像视觉辅助一样。在电子表格上，日期具有条件格式，将其变为红色，日期在当前日期之前。（已过期）有没有办法让脚本查找该格式或执行相同的条件格式？

这是我能想到的，

`if(data[nn][14] < Date(), .setStyleAttribute("background", "red"));`

但它不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:05:02.330

[尝试使用getTime()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTime)将您的日期对象转换为“从纪元开始的毫秒数” 。

```
var dateSerial = data[nn][14].getTime();
var nowSerial = (new Date()).getTime();
var formatColour = (dateSerial < nowSerial)?'red':'cyan'; 
```

对于您问题的另一部分（指定您希望日期的显示方式），请查看[Utilities.formatDate()](https://developers.google.com/apps-script/class_utilities#formatDate)。

# c# - C# 计算器 - 文本框到列表框

> ID：14541220
> 
> 赞同：-2
> 
> 时间：2013-01-26T20:23:21.313
> 
> 标签：c#, button, textbox, listbox, calculator

这个计算器非常基础，所以我一次只使用两个值来计算。

我只计算两个值`val1`和`val2`。这些值可以是任何大小，包括小数点。我有数字 0-9、小数点、加、减、除、乘和等于的按钮。

我希望 val1、val2 和`operator(ex. +,-,/,*)`我选择计算这些值`listBox`在我点击`=`按钮后出现在我的列表中。我进行的每个计算都希望将其添加到上一个计算下方的列表框中。当 listBox 增长到一定数量的计算（10-15ish）时，我希望从底部删除最旧的计算，并将最新的计算添加到列表的顶部。

```
public partial class Form1 : Form
{
    // global variables
    bool plus = false;
    bool minus = false;
    bool multiply = false;
    bool divide = false;
    bool equal = false;

    public Form1()
    {
        InitializeComponent();
    } // **MUST HAVE**

    private void button0_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "0";
    } // makes number click usable

    private void CheckIfEqual()
    {
        if (equal) // checks if equal is true
        {
            textBox1.Text = ""; // clear textBox
            equal = false; // tells program there is new calculation
        }
    } 

    private void button1_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "1";
    } // makes number click usable

    private void button2_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "2";
    } // makes number click usable

    private void button3_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "3";
    } // makes number click usable

    private void button4_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "4";
    } // makes number click usable

    private void button5_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "5";
    } // makes number click usable

    private void button6_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "6";
    } // makes number click usable

    private void button7_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "7";
    } // makes number click usable

    private void button8_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "8";
    } // makes number click usable

    private void button9_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "9";
    } // makes number click usable

    private void buttonDecimal_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        if (textBox1.Text.Contains("."))
        {
            return;
        } // if it contains a decimal execute 
        else
        {
            textBox1.Text = textBox1.Text + ".";
        } // adds decimal
      } // end decimal

    private void buttonPlusMinus_Click(object sender, EventArgs e)
    {
        if (textBox1.Text.Contains("-"))
        {
            textBox1.Text = textBox1.Text.Remove(0, 1);
        } // if it contains the - character remove it
        else
        {
            textBox1.Text = "-" + textBox1.Text;
        } //
    } // adds/removes -

    private void buttonPlus_Click(object sender, EventArgs e)
    {
        if (textBox1.Text == "")
        {
            return;
        } // if textbox is empty return
        else
        {
            plus = true;
            textBox1.Tag = textBox1.Text; // stores number 
            textBox1.Text = ""; // clears textbox
        } // tells program we are adding
    } // end plus

    private void buttonMinus_Click(object sender, EventArgs e)
    {
        if (textBox1.Text == "")
        {
            return;
        } // if textbox is empty return
        else
        {
            minus = true;
            textBox1.Tag = textBox1.Text; // stores number 
            textBox1.Text = ""; // clears textbox
        } // tells program we are subtracting

    }

    private void buttonMultiply_Click(object sender, EventArgs e)
    {
        if (textBox1.Text == "")
        {
            return;
        } // if textbox is empty return
        else
        {
            multiply = true;
            textBox1.Tag = textBox1.Text; // stores number 
            textBox1.Text = ""; // clears textbox
        } // tells program we are multiplying
    }

    private void buttonDivide_Click(object sender, EventArgs e)
    {
        if (textBox1.Text == "")
        {
            return;
        } // if textbox is empty return
        else
        {
            divide = true;
            textBox1.Tag = textBox1.Text; // stores number 
            textBox1.Text = ""; // clears textbox
        } // tells program we are dividing
    }

    private void buttonEquals_Click(object sender, EventArgs e)
    {
        equal = true; // tells program it made a calculation
        if (plus) // if true execute
        {
            decimal dec = Convert.ToDecimal(textBox1.Tag) + Convert.ToDecimal(textBox1.Text);
            textBox1.Text = dec.ToString(); // display value once add is finished
            plus = false;
        } // end if plus

        if (minus) // if true execute
        {
            decimal dec = Convert.ToDecimal(textBox1.Tag) - Convert.ToDecimal(textBox1.Text);
            textBox1.Text = dec.ToString(); // display value once add is finished
            minus = false;
        } // end if minus

        if (multiply) // if true execute
        {
            decimal dec = Convert.ToDecimal(textBox1.Tag) * Convert.ToDecimal(textBox1.Text);
            textBox1.Text = dec.ToString(); // display value once add is finished
            multiply = false;
        } // end if multiply

        try
        {
            if (divide) // if true execute
            {
                decimal dec = Convert.ToDecimal(textBox1.Tag) / Convert.ToDecimal(textBox1.Text);
                textBox1.Text = dec.ToString(); // display value once add is finished
                divide = false;
            } // end if divide
        } // try
        catch (DivideByZeroException ex)
        {
            MessageBox.Show(ex.Message, "ERROR", MessageBoxButtons.OK);
        } // catch
     } // end buttonEquals

    private void buttonClear_Click(object sender, EventArgs e)
    {
        plus = minus = multiply = divide = false; // makes all false regardless
        textBox1.Text = ""; // clear
        textBox1.Tag = ""; // clears
    }

    } // end partial class Form1
}// end namespace 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:27:03.037

重构会很好...

例如，您可以对所有“数字按钮单击”事件使用相同的方法。

代替

```
private void button1_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "1";
    } // makes number click usable

...
private void button9_Click(object sender, EventArgs e)
    {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + "9";
    } // makes number click usable 
```

只使用一种方法。

```
button1.Click += NumericButtonClick;
...
button9.Click +=NumericButtonClick;

private void NumericButtonClick(object sender, EventArgs e) {
        CheckIfEqual();
        textBox1.Text = textBox1.Text + ((Button)sender).Text;
} 
```

反正。

假设你有一个 ListBox historyListBox;

然后只需添加一个方法

```
private void PopulateListBox(string left, string right, string operator) {
  var newContent = string.Format("{0} {1} {2}", left, operator, right);
  if (historyListBox.Items.Count == 15)
    historyListBox.Items.RemoveAt(14);//

  historyListBox.Items.Insert(0, newContent);

} 
```

然后您可以更改“equal_click 事件”（也应该对其进行重构，但这是另一个问题）

```
private void buttonEquals_Click(object sender, EventArgs e)
    {
        var left = textBox1.Tag;
        var right = textBox1.Text;
        var operator = string.Empty;
        equal = true; // tells program it made a calculation
        if (plus) // if true execute
        {
            operator = "+";
            decimal dec = Convert.ToDecimal(left) + Convert.ToDecimal(right);
            textBox1.Text = dec.ToString(); // display value once add is finished
            plus = false;
        } // end if plus

        if (minus) // if true execute
        {
            operator = "-";
            decimal dec = Convert.ToDecimal(left) - Convert.ToDecimal(right);
            textBox1.Text = dec.ToString(); // display value once add is finished
            minus = false;
        } // end if minus

        //...etc

       PopulateListBox(left, right, operator);
   } 
```

# heroku - Heroku 格式错误的 Procfile（使用他们自己的示例）

> ID：14541226
> 
> 赞同：2
> 
> 时间：2013-01-26T20:23:40.840
> 
> 标签：heroku

我正在阅读 Django 入门系列，但遇到了 Heroku 的问题。

我一次又一次地完成了这些步骤，在设置了 Virtualenv 的提供的 VM 中运行。当我做 a`git push heroku master`时，我得到以下输出：

```
(blog-venv)vagrant@precise64:/vagrant/projects/microblog$ git push heroku master
Counting objects: 11, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (8/8), done.
Writing objects: 100% (11/11), 3.61 KiB, done.
Total 11 (delta 0), reused 0 (delta 0)
-----> Python app detected
-----> No runtime.txt provided; assuming python-2.7.3.
-----> Preparing Python runtime (python-2.7.3)
-----> Installing Distribute (0.6.34)
-----> Installing Pip (1.2.1)
-----> Installing dependencies using Pip (1.2.1)
       Downloading/unpacking Django==1.4.3 (from -r requirements.txt (line 1))
         Running setup.py egg_info for package Django

       Downloading/unpacking argparse==1.2.1 (from -r requirements.txt (line 2))
         Running setup.py egg_info for package argparse

           no previously-included directories found matching 'doc/_build'
           no previously-included directories found matching 'env24'
           no previously-included directories found matching 'env25'
           no previously-included directories found matching 'env26'
           no previously-included directories found matching 'env27'
       Installing collected packages: Django, argparse
         Running setup.py install for Django
           changing mode of build/scripts-2.7/django-admin.py from 600 to 755

           changing mode of /app/.heroku/python/bin/django-admin.py to 755
         Running setup.py install for argparse

           no previously-included directories found matching 'doc/_build'
           no previously-included directories found matching 'env24'
           no previously-included directories found matching 'env25'
           no previously-included directories found matching 'env26'
           no previously-included directories found matching 'env27'
       Successfully installed Django argparse
       Cleaning up...
-----> Collecting static files
       0 static files copied.

-----> Discovering process types

 !     This format of Procfile is unsupported
 !     Use a colon to separate the process name from the command
 !     e.g.   python:  manage.py runserver 0.0.0.0:$PORT .noreload

 !     Heroku push rejected, malformed Procfile

To git@heroku.com:quiet-lowlands-3777.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:quiet-lowlands-3777.git'
(blog-venv)vagrant@precise64:/vagrant/projects/microblog$ cat Procfile
python: manage.py runserver 0.0.0.0:$PORT --noreload 
```

我有点绝望，有人能解释一下吗？谷歌等已经完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:31:07.590

现在想通了，http://gettingstartedwithdjango.com上的教程[在](http://gettingstartedwithdjango.com)这个问题上还不清楚。Procfile 的内容应该是：

网页：python manage.py runserver 0.0.0.0:$PORT --noreload

不是

python manage.py runserver 0.0.0.0:$PORT --noreload

留下这个问题以供其他人将来参考。

# ruby-on-rails - 没有路线匹配 [GET] "/static_pages/home.html.erb"

> ID：14541233
> 
> 赞同：3
> 
> 时间：2013-01-26T20:24:04.367
> 
> 标签：ruby-on-rails, ruby, routes

我正在关注 Michale Hartl 的教程，我目前正处于这一步：

*清单 5.23。为根路由添加映射。配置/路由.rb*

```
SampleApp::Application.routes.draw do
root to: 'static_pages#home'
match '/help', to: 'static_pages#help'
match '/about', to: 'static_pages#about'
match '/contact', to: 'static_pages#contact'
end 
```

我已将他的确切编码复制到我的 config/routes.rb 并继续收到路由错误：

## 路由错误

没有路线匹配 [GET] "/static_pages/home.html"。

--

不确定此时该怎么做才能将我的主页路由为索引，并能够使用 root_path 链接回“主页”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-01T16:35:49.690

`../static_pages/..`从您在浏览器中输入的 URL 中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-03T17:24:53.053

这段代码是正确的

SampleApp::Application.routes.draw 做

```
root :to => 'static_pages#home'

get '/help' => 'static_pages#help'

get '/about' => 'static_pages#about'

get '/contact' => 'static_pages#contact' 
```

结尾

不用删除索引页，教程中的rspec测试没有错，这是当前可用方法的更新代码

描述“主页”做

```
it "should have the content 'Sample App'" do

  visit '/'

  page.should have_content('Sample App')

end 
```

结尾

这是使用 ruby​​ -v ruby​​ 2.0.0p47 和 rails -v Rails 4.0.3

如果您在 { visit help_path } 之前使用，使用 Rails 控制台并检查路径 app.help_path 确认 'before { visit help_path} 是正确的，但如果此代码不在 spec/rspec_helpers.rb 中，则您也可能会失败将失败，因为它找不到路径

如果将以下内容放入 rspec_helper.rb 中，命名路由应该可以工作：

Rspec.configure 做 |config| config.include Rails.application.routes.url_helpers ...结束

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T04:19:52.133

```
SampleApp::Application.routes.draw do
root :to => 'static_pages#home'
get '/help' => 'static_pages#help'
get '/about' => 'static_pages#about'
get '/contact' => 'static_pages#contact'
end 
```

这段代码是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T15:21:23.693

您需要删除或重命名 public/index.html ，然后它才能工作。

# excel - 比较两列并从第三列返回值

> ID：14541237
> 
> 赞同：3
> 
> 时间：2013-01-26T20:24:52.613
> 
> 标签：excel, vlookup

`Column 1`是我的源数据列，`Column 2`也是`3`我的参考列表。我想要的是索引或匹配规则`Column 2 + Column 3`并进行比较并将`Column 1`匹配的规则值返回到同一行中的结果列。

![在此处输入图像描述](../Images/866150de3a29bccdd4b37d218eb07b04.png)

请注意，所有值都是字符串（文本），不涉及数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T23:32:07.087

我可能误解了您的问题，但是按照 user1917229 的建议，您是否可以简单地检查您的源列是否为空，如果不是，则返回第一列中的第一个值和第二列中的第 3 列值（根据您的更新）？例如，在单元格中`D2`（并向下拖动）：

```
=IF(A2="", "", A2) 
```

并且`E2`：

```
=IF(A2="", "", VLOOKUP(A2,$B$2:$C$14,2,FALSE)) 
```

请注意，我不确定您想要什么`+`，所以这只是字面上返回它 - 如果这不是您想要的，希望这个概念是有意义的并且可以调整。

![在此处输入图像描述](../Images/ab3d322e51b24cfdce96c474178d87f9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T22:17:02.740

[VLookUp](http://office.microsoft.com/en-001/excel-help/vlookup-HP005209335.aspx)可能是您想要的。

```
 =VLOOKUP(A3,$B$3:$C$12,2,TRUE) 
```

# php - PHP 类返回 JSON 但不适用于 AJAX 调用

> ID：14541238
> 
> 赞同：0
> 
> 时间：2013-01-26T20:24:53.540
> 
> 标签：php, ajax, json, oop, class

我有一个ajax调用...

```
 $(function(){
        $('#registerUser').submit(function() {

           $.ajax({
                  url: 'http://www.mysite.co.uk/path/register/add_user.php',
                  type: 'post',
                  data: form.serialize(),
                  dataType: 'json',
                  crossDomain : true,
                  timeout: 5000,

                  success: function(msg){
                    alert(msg.name);
                  },

                  error: function(){
                    alert('There was an error loading the data.');
                  }
                  });
          });
      }); 
```

当我在 PHP 文件中回显一个 json 对象时，这一切都很好。然而，当使用我的类回显它时，它会在页面上回显，但在与 ajax 函数一起使用时不起作用 - 没有返回任何内容。

值得一提的是，我是 OOP 的菜鸟。我试图返回的对象只是一个与函数无关的简单对象，仅用于测试目的。

```
<?php

include('../config/.db.php');
include('../config/headers.php');

$firstName = $_POST['name'];
$surname = $_POST['surname'];
$email = $_POST['email'];
$password = $_POST['password'];
$password2 = $_POST['password2'];

class user{
    public $returnArray;
    public function addUser($firstName, $surname, $email, $password, $mysqli){

    $stmt = $mysqli -> prepare("INSERT INTO users(name, surname, email, password) VALUES (?,?,?,?)");   
    $stmt -> bind_param("ssss", $firstName, $surname, $email, $password);   
    $stmt -> execute();
    $stmt -> bind_result($result);
    $stmt -> fetch();
    $stmt -> close();

    $array = array('name'=>'andre');
    $this->returnArray = json_encode($array);  
    }
}

$user = new user;
$user->addUser($firstName, $surname, $email, $password, $mysqli);
echo $user->returnArray;
?> 
```

请求/响应

```
POST /intheloop/register/add_user.php HTTP/1.1
Host: www.mysite.co.uk
Connection: keep-alive
Content-Length: 47
Accept: application/json, text/javascript, */*; q=0.01
Origin: null
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Safari/537.17
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Form Dataview sourceview URL encoded
name:a
surname:a
email:a
password:a
password2:a
Response Headersview parsed
HTTP/1.1 200 OK
Date: Sat, 26 Jan 2013 20:51:36 GMT
Server: Apache
X-Powered-By: PHP/5.3.15
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET,PUT,POST,OPTIONS,DELETE
Keep-Alive: timeout=5, max=75
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: application/json 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:34:15.443

您似乎违反了[`same origin policy`](http://en.wikipedia.org/wiki/Same_origin_policy)浏览器内置的限制，阻止您发送跨域 AJAX 请求。

您只能将 AJAX 请求发送到托管在与托管 AJAX 脚本的域相同的域中的脚本。在这种情况下，您似乎正在尝试向其发送 AJAX 请求，`http://www.mysite.co.uk/path/register/add_user.php`但要使其正常工作，您的 javascript 文件必须托管在`http://www.mysite.co.uk/`.

有[`some workarounds`](http://usejquery.com/posts/the-jquery-cross-domain-ajax-guide)你可以考虑的。它们涉及在您的域上使用[`JSONP`](http://en.wikipedia.org/wiki/JSONP)或[`CORS`](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)服务器端桥接脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:35:04.673

如果您的 AJAX 调用没有从同一个域请求数据，那么它将无法工作，这就是浏览器防止滥用 AJAX 的安全措施。因此，为了使其跨域工作，您可以做的一件事是从您的 PHP 脚本中发出 CORS 标头。

您可以将其添加到您的 PHP 文件中

```
header('Access-Control-Allow-Origin: *'); 
```

然后这将指示浏览器他们可以接受此 ajax 调用和数据传输，然后您的脚本将工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:41:25.343

您可能还想添加它以使输出具有正确的 mime 类型，将其放在“echo”上方的 1 行：

```
header('Content-type: application/json'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T21:28:25.117

所以错误是这条线

```
 $stmt -> bind_result($result); 
```

弄乱了查询结果中预期的绑定变量。因为我没有通过查询检索任何内容，所以没有任何东西可以将变量 $result 分配给。

这反过来又给了一个 PHP 错误，弄​​乱了返回的 json。

# c#-4.0 - 在 WinRT 上保存带有背景图像的画布

> ID：14541240
> 
> 赞同：5
> 
> 时间：2013-01-26T20:25:00.473
> 
> 标签：c#-4.0, windows-8, windows-runtime, winrt-xaml

我想用 C# for WinRT 为儿童制作一个简单的绘图应用程序。用户可以选择一张图片并画一点点。但是如何保存图像（连同背景）？没有使用背景保存图像的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T14:05:46.050

我尝试使用您的库将 Canvas 渲染到图像文件中，但运行时出现此错误：“找不到组件。（来自 HRESULT 的异常：0x88982F50）”。代码如下所示：

```
//SAVE
    private async void saveButton_Click(object sender, RoutedEventArgs e)
    {
        await SaveToFile();
    }

    public async Task SaveToFile()
    {
        var wb = new WriteableBitmap(1, 1);
        await wb.Render(canvas);

        Windows.Storage.Pickers.FileSavePicker save = new Windows.Storage.Pickers.FileSavePicker();
        save.SuggestedStartLocation = Windows.Storage.Pickers.PickerLocationId.Desktop;
        save.DefaultFileExtension = ".jpg";
        save.FileTypeChoices.Add("JPG", new string[] { ".jpg" });
        StorageFile filesave = await save.PickSaveFileAsync();
        await wb.SaveToFile(filesave, Guid.NewGuid());
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:45:39.803

如果您将图像绘制到`WriteableBitmap`WinRT XAML 工具包中，您可以使用一些扩展方法来保存图像：

```
using System;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices.WindowsRuntime;
using System.Threading.Tasks;
using Windows.Graphics.Imaging;
using Windows.Storage;
using Windows.UI.Xaml.Media.Imaging;

namespace WinRTXamlToolkit.Imaging
{
    /// <summary>
    /// Extension methods used for saving a WriteableBitmap to a file.
    /// </summary>
    public static class WriteableBitmapSaveExtensions
    {
        /// <summary>
        /// Saves the WriteableBitmap to a png file with a unique file name.
        /// </summary>
        /// <param name="writeableBitmap">The writeable bitmap.</param>
        /// <returns>The file the bitmap was saved to.</returns>
        public static async Task<StorageFile> SaveToFile(
            this WriteableBitmap writeableBitmap)
        {
            return await writeableBitmap.SaveToFile(
                KnownFolders.PicturesLibrary,
                string.Format(
                    "{0}_{1}.png",
                    DateTime.Now.ToString("yyyyMMdd_HHmmss_fff"),
                    Guid.NewGuid()),
                CreationCollisionOption.GenerateUniqueName);
        }

        /// <summary>
        /// Saves the WriteableBitmap to a png file in the given folder with a unique file name.
        /// </summary>
        /// <param name="writeableBitmap">The writeable bitmap.</param>
        /// <param name="storageFolder">The storage folder.</param>
        /// <returns>The file the bitmap was saved to.</returns>
        public static async Task<StorageFile> SaveToFile(
            this WriteableBitmap writeableBitmap,
            StorageFolder storageFolder)
        {
            return await writeableBitmap.SaveToFile(
                storageFolder,
                string.Format(
                    "{0}_{1}.png",
                    DateTime.Now.ToString("yyyyMMdd_HHmmss_fff"),
                    Guid.NewGuid()),
                CreationCollisionOption.GenerateUniqueName);
        }

        /// <summary>
        /// Saves the WriteableBitmap to a file in the given folder with the given file name.
        /// </summary>
        /// <param name="writeableBitmap">The writeable bitmap.</param>
        /// <param name="storageFolder">The storage folder.</param>
        /// <param name="fileName">Name of the file.</param>
        /// <param name="options">
        /// The enum value that determines how responds if the fileName is the same
        /// as the name of an existing file in the current folder. Defaults to ReplaceExisting.
        /// </param>
        /// <returns></returns>
        public static async Task<StorageFile> SaveToFile(
            this WriteableBitmap writeableBitmap,
            StorageFolder storageFolder,
            string fileName,
            CreationCollisionOption options = CreationCollisionOption.ReplaceExisting)
        {
            StorageFile outputFile =
                await storageFolder.CreateFileAsync(
                    fileName,
                    options);

            Guid encoderId;

            var ext = Path.GetExtension(fileName);

            if (new[] { ".bmp", ".dib" }.Contains(ext))
            {
                encoderId = BitmapEncoder.BmpEncoderId;
            }
            else if (new[] { ".tiff", ".tif" }.Contains(ext))
            {
                encoderId = BitmapEncoder.TiffEncoderId;
            }
            else if (new[] { ".gif" }.Contains(ext))
            {
                encoderId = BitmapEncoder.TiffEncoderId;
            }
            else if (new[] { ".jpg", ".jpeg", ".jpe", ".jfif", ".jif" }.Contains(ext))
            {
                encoderId = BitmapEncoder.TiffEncoderId;
            }
            else if (new[] { ".hdp", ".jxr", ".wdp" }.Contains(ext))
            {
                encoderId = BitmapEncoder.JpegXREncoderId;
            }
            else //if (new [] {".png"}.Contains(ext))
            {
                encoderId = BitmapEncoder.PngEncoderId;
            }

            await writeableBitmap.SaveToFile(outputFile, encoderId);

            return outputFile;
        }

        /// <summary>
        /// Saves the WriteableBitmap to the given file with the specified BitmapEncoder ID.
        /// </summary>
        /// <param name="writeableBitmap">The writeable bitmap.</param>
        /// <param name="outputFile">The output file.</param>
        /// <param name="encoderId">The encoder id.</param>
        /// <returns></returns>
        public static async Task SaveToFile(
            this WriteableBitmap writeableBitmap,
            StorageFile outputFile,
            Guid encoderId)
        {
            Stream stream = writeableBitmap.PixelBuffer.AsStream();
            byte[] pixels = new byte[(uint)stream.Length];
            await stream.ReadAsync(pixels, 0, pixels.Length);

            using (var writeStream = await outputFile.OpenAsync(FileAccessMode.ReadWrite))
            {
                var encoder = await BitmapEncoder.CreateAsync(encoderId, writeStream);
                encoder.SetPixelData(
                    BitmapPixelFormat.Bgra8,
                    BitmapAlphaMode.Premultiplied,
                    (uint)writeableBitmap.PixelWidth,
                    (uint)writeableBitmap.PixelHeight,
                    96,
                    96,
                    pixels);
                await encoder.FlushAsync();

                using (var outputStream = writeStream.GetOutputStreamAt(0))
                {
                    await outputStream.FlushAsync();
                }
            }
        }
    }
} 
```

该工具包在库中还有一些方法`WinRTXamlToolkit.Composition`可以使用 Direct2D 将 XAML UI 布局的文本和形状呈现到图像中，但它仍处于早期开发阶段，还不支持呈现图像控件或背景。

# python - 返回一个包含 Python 中每个重复值的列表？

> ID：14541243
> 
> 赞同：-2
> 
> 时间：2013-01-26T20:25:50.107
> 
> 标签：python, list, duplicates

编写一个方法`rem()`，将一个可能包含重复值的列表作为输入，并返回列表的副本，其中删除了每个重复值的一个副本。

```
> rem([4])
[]

> rem([4, 4])
[4]

> rem([4, 1, 3, 2])
[]

> rem([2, 4, 2, 4, 4])
[2, 4, 4] 
```

我该怎么做呢？我是否制作一个包含重复项的新列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:37:33.773

[`collections.Counter`](http://docs.python.org/2/library/collections.html#counter-objects)是个好主意，试试这个：

```
import collections
def rem(l):
    newlist = []
    for k, v in collections.Counter(l).iteritems():
        newlist += [k] * (v - 1)
    return newlist 
```

* * *

```
print rem([4])
print rem([4, 4])
print rem([4, 1, 3, 2])
print rem([2, 4, 2, 4, 4]) 
```

```
[]
[4]
[]
[2, 4, 4]

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:36:30.247

```
def rem(a):
    copy = a[:]
    for value in set(copy):
        copy.remove(value)
    return copy 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-26T20:34:03.210

您可以为此使用[collections.Counter ：](http://docs.python.org/2/library/collections.html#collections.Counter)

```
import collections
def rem(a):
   new_list = []
   for key, count in collections.Counter(a).iteritems():
      if count > 1:
         new_list.extend([key] * (count-1))
   return new_list 
```

用你的例子：

```
>>> rem([4])
[]
>>> rem([4, 4]) 
[4]
>>> rem([4, 1, 3, 2])
[]
>>> rem([2, 4, 2, 4, 4])
[2, 4, 4] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-26T20:36:41.853

```
l = [1,2,2,3,4]
for item in set(l):
    l.remove(item) 
```

# jquery - 将元素集合附加到 jQuery 中的另一个集合

> ID：14541246
> 
> 赞同：1
> 
> 时间：2013-01-26T20:26:10.730
> 
> 标签：jquery, jquery-selectors, jquery-append

我想[附加外循环](http://stage.learn.jquery.com/performance/append-outside-loop/)。我有2个收藏。我要附加的元素之一，以及我要附加的元素之一。即，我有一个包含 3 个 div 的集合和一个包含 3 个段落的集合。

我想附加，以便将第 1 段附加到 div 1，将第 2 段附加到 div 2，将第 3 段附加到 div 3。

不使用循环有可能吗？

现在我正在这样做：

```
var divs = $('<div>'), paragraphs = $(), arr = [['class1','text1'],['class2','text2'],['class3','text3']];
for (i = 0; i < 3;i++)
{
    paragraphs = $('<p class="' + arr[i][0] + '">' + arr[i][1] + '</p>').appendTo(divs.eq(i));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:47:53.313

**已编辑**，由于原始示例的更改，改进的答案是在内部它无论如何都会使用循环，但我认为你要求的是

```
divs = $('div'), paragraphs = $(), arr = [['class1','text1'],['class2','text2'],['class3','text3']];
divs.append(function(i, h){
    paragraphs = $('<p class="' + arr[i][0] + '">' + arr[i][1] + '</p>').appendTo(divs.eq(i));
    return paragraphs;
}); 
```

希望这可以帮助

注意：在您写的问题中

```
divs = $('<div>'); 
```

它应该是

```
divs = $('div'); 
```

# ruby-on-rails - rails has_many 经理

> ID：14541248
> 
> 赞同：1
> 
> 时间：2013-01-26T20:26:32.843
> 
> 标签：ruby-on-rails, ruby, polymorphic-associations, polymorphism

我正在尝试创建一个多态成像系统，该系统将允许各种对象具有封面图像和附加图像。我在创建`Image`模型时是否正确`belongs_to :imageable`？或者，我是否应该分离出我的逻辑，以便为每个继承图像功能的模型提供一个单独的多态关联，用于封面图像和附加图像？

那么，一旦我设置了 has_many 关系，我该如何管理它？在一个完美的世界中，我希望能够调用`@object.images.cover?`和`@object.images.additionals`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T20:36:08.520

`images`为具有布尔字段的多态关联创建一个表`cover`，指示记录中的图像是否为封面图像：

```
create_table :images do |t|
  t.boolean :cover, :default => false
  t.references :imageable, :polymorphic => true
  t.timestamps
end 
```

然后包括`has_many :images, :as => :imageable`在你的对象上。现在要拥有你想要的`@object.cover`，`@object.additionals`你有两个选择。首先是创建一个 Concern 模块以混入您的 Object 类。二是子类化。我将在这里讨论 Concern 方法，因为它是 Rails 4 中推送的一种方法，并且大多数程序员已经熟悉子类化。

在里面创建一个模块`app/models/concerns`：

```
module Imageable
  extend ActiveSupport::Concern

  included do
    has_many :images, :as => :imageable # remove this from your model file
  end

  def cover
    images.where(:cover => true).first
  end

  def additionals
    images.where(:cover => false).all
  end
end 
```

您现在可以将此关注点混入您的对象类中。例如：

```
class Object1 < ActiveRecord::Base
  include Imageable

  ...
end 
```

您还必须包含您的关注点`app/models/concerns`，因为它们不会自动加载（在 Rails 4 中，该目录中的任何文件都将默认包含在内）。

# iphone - 如何在我的应用程序屏幕上显示整数的当前值？

> ID：14541249
> 
> 赞同：-1
> 
> 时间：2013-01-26T20:26:34.140
> 
> 标签：iphone, ios

我的 AppDelegate.mm 文件中有一个整数 y，我想在我的 iphone 应用程序（xib 文件）的屏幕上显示它。y 值的范围从 0 到 1024，并且不断变化，因为它反映了进入手机麦克风端口的频率。有没有一种简单的方法可以像显示器一样在应用程序屏幕上显示 y 的当前值？非常感谢你的时间，蒂莫西洛瑞

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:29:38.280

您可以使用 NSTimer。

计时器使用定期调用该方法，您的更新值将在 uilabel 中反映/更改。

编辑：正如 h2co3 所建议的那样

如果应用程序使用音频数据，几乎可以肯定它有一个为此指定的回调函数 - 应该真正使用该回调而不是计时器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:31:49.107

您可以声明一个 UILabel 并将其添加到您的视图中，并使用转换为 NSString 的整数。不过，您将需要一个视图控制器来执行此操作。

```
 int yourInt;
       NSString *num = [NSString strinWithFormat:@"%d", youInt];
       UILabel *lab = [UILabel alloc] initWhithFrame:CGRectMake(200, 200, 100, 30)];
       lab.text = num;
       [self.view addSubView:lab]; 
```

代码未经测试，我只是将其直接写入解决方案框中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T20:31:59.897

您想在 xib 中显示 Appdelegate 整数 y 的值

```
AppDelegate *appDelegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];
lbl.text = [NSString strinWithFormat:@"%d",appDelegate.y]; 
```

确保您的 y 整数设置为 AppDelegate 中的属性

希望这可以帮助你..

# git - 提交空文件夹结构（使用 git）

> ID：14541253
> 
> 赞同：87
> 
> 时间：2013-01-26T20:27:01.683
> 
> 标签：git, gitignore

我在项目的根目录中有数据目录。它有图像目录和一些文件。这是示例：

```
data
├── images
│   ├── image1.jpg
│   ├── image2.jpg
│   └── image3.jpg 
├── results.csv
└── r.txt 
```

在 gitignore 中写什么，忽略 data/ 目录中的文件（即 results.csv 和 r.txt）和 images/ 目录中的文件（image.jpg、image2.jpg、image3.jpg）？

当我提交它时，存储库中的文件夹结构应该是：

```
data/
└── images/ 
```

所以，我只想提交空文件夹结构。

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-11-11T20:08:11.173

Just add a file `.gitkeep` in every folder you want committed.

On windows do so by right clicking when in the folder and select: Git bash from here. Then type: `touch .gitkeep`

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2013-01-26T20:28:40.690

在 Git 中，您不能提交空文件夹，因为 Git 实际上并不保存文件夹，只保存文件。如果您实际上希望它们为“空”（即您没有可提交的内容），则必须在这些目录中创建一些占位符文件。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2013-01-26T23:50:04.523

这很简单。

告诉`.gitignore`忽略除`.gitignore`要保留的文件夹之外的所有内容。放入`.gitignore`要保留在存储库中的文件夹中。

最上面的内容`.gitignore`：

```
# ignore everything except .gitignore and folders that I care about:
*
!images*
!.gitignore 
```

在嵌套`images`文件夹中，这是您的`.gitignore`：

```
# ignore everything except .gitignore
*
!.gitignore 
```

请注意，您必须在 .gitignore 中拼出您不想在 .gitignore 所在的文件夹中被忽略的文件夹的名称。否则，它们显然会被忽略。

显然，您在存储库中的文件夹不会是空的，因为每个文件夹中都会有`.gitignore`，但是可以忽略该部分，对吧。:)

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2015-07-06T15:38:08.557

Recursively create .gitkeep files

```
find . -type d -empty -not -path "./.git/*" -exec touch {}/.gitkeep \; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-01-26T23:55:01.250

Traditionally whenever I've wanted to commit and empty directory structure, I create the structure and then in the leaf directories place an empty file called `empty.txt`.

Then when I put stuff in that's ready to commit, I can simply remove the `empty.txt` file and commit the real files.

i.e.

*   data/
    *   images/
        *   empty.txt

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-01-26T20:42:49.770

您可以使用 进行空提​​交`git commit --allow-empty`，但这将不允许您提交空文件夹结构，因为 git 不知道或不关心文件夹作为对象本身 - 只是它们包含的文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-01-27T06:56:41.720

Consider also just doing `mkdir -p data/images` in your Makefile, if the directory needs to be there during build.

If that's not good enough, just create an empty file in data/images and ignore data.

```
touch data/images/.gitignore
git add data/images/.gitignore
git commit -m "Add empty .gitignore to keep data/images around"
echo data >> .gitignore
git add .gitignore
git commit -m "Add data to .gitignore" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-14T21:59:51.477

According to their FAQ, GIT doesn't track empty directories.

[Git FAQ](https://git.wiki.kernel.org/index.php/GitFaq#Can_I_add_empty_directories.3F)

However, there are workarounds based on your needs and your project requirements.

Basically if you want to track an empty directory you can place a `.gitkeep` file in there. The file can be blank and it will just work. This is Gits way of tracking an empty directory.

Another option is to provide documentation for the directory. You can just add a readme file in it describing its expected usage. Git will track the folder because it has a file in it and you have now provided documentation to you and/or whoever else might be using the source code.

If you are building a web app you may find it useful to just add an index.html file which may contain a permission denied message if the folder is only accessible through the app. Codeigniter does this with all their directories.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-10-06T06:40:14.553

Simply add file named as .keep in images folder.you can now stage and commit and also able to add folder to version control.

Create a empty file in images folder `$ touch .keep`

`$ git status`

```
On branch master
Your branch is up-to-date with 'origin/master'.

Untracked files:
  (use "git add ..." to include in what will be committed)

    images/

nothing added to commit but untracked files present (use "git add" to track)

```

`$ git add .`

`$ git commit -m "adding empty folder"`

# selenium - selenium 节点集线器配置

> ID：14541255
> 
> 赞同：0
> 
> 时间：2013-01-26T20:27:15.260
> 
> 标签：selenium, selenium-rc, selenium-webdriver, selenium-grid

我的 /etc/rc.local 文件中有以下配置

```
Xvfb :99 -screen 0 1024x768x24 -ac 2>&1 >/dev/null &
export DISPLAY=:99
java -jar /home/ubuntu/selenium-server-standalone-2.29.0.jar -role hub   -maxSession 50 -Dwebdriver.chrome.driver=/usr/local/bin/chromedriver > /home/ubuntu/selenium.log&

Xvfb :98 -screen 0 1024x768x24 -ac 2>&1 >/dev/null &
export DISPLAY=:98
java -jar /home/ubuntu/selenium-server-standalone-2.29.0.jar -role node -hub http://IP:4444/grid/register url http://IP:4444/grid/register -remoteHost http://IP:4444/grid/register -host http://IP -Dwebdriver.chrome.driver=/usr/local/bin/chromedriver > /home/ubuntu/selenium-node.log& 
```

要在同一台机器上运行集线器和节点，当我连接到 5555 端口（作为节点）时，我可以成功运行它，但是当询问集线器（端口 4444）时，我得到

```
Session [None] not available and is not among the last 1000 terminated sessions.\nActive sessions are[]' 
```

我的代码如下：

```
 driver = webdriver.Remote("http://IP:4444/wd/hub", webdriver.DesiredCapabilities.CHROME)
driver.get("http://www.google.com")
print "Page Title: " + driver.title
driver.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T14:29:56.863

您的 selenium 节点似乎是一个工作的 webdriver，因为它在使用 RemoteWebdriver 连接到端口 5555 时工作。但它不是您的 selenium 网格中的合格 selenium 节点。

请在启动包含 chrome webdriver 的 selenium 节点时指定此参数：

```
-browser browserName=chrome 
```

然后你应该能够在端口 4444 上对集线器使用 RemoteWebdriver。

# java - 使用 do while 循环时出现 NoSuchElementException

> ID：14541261
> 
> 赞同：0
> 
> 时间：2013-01-26T20:28:14.787
> 
> 标签：java, algorithm, exception

我正在从事我的大学项目，当我尝试使所有代码循环时，我不断收到此异常。当不在循环中时，它工作得很好，它包括创建文本文件和附加文本文件（如果有帮助的话）。我的假设是我的扫描仪导致了这些问题，但我不知道问题是什么或如何解决它。

```
Exception in thread "main" java.util.NoSuchElementException
at java.util.Scanner.throwFor(Scanner.java:855)
at java.util.Scanner.next(Scanner.java:1478)
at java.util.Scanner.nextInt(Scanner.java:2108)
at java.util.Scanner.nextInt(Scanner.java:2067)
at PDispenser_V1.main(PDispenser_V1.java:51) 
```

我不能发布我的代码，因为抄袭软件会检查 stackoverflow，如果我这样做，我的整个项目将被抄袭。我知道这是一个巨大的失败，但如果你能告诉我一般要寻找什么以及如何解决它（只要我给了你足够的继续）那就太好了！编译器给我的唯一存在的行号是 51，它上面有这个代码。

```
selection = input.nextInt(); 
```

这一行后面是一个 switch 语句，每种情况下都有一堆方法。如果有什么我可以在不显示任何代码的情况下回答的问题，请询问。任何帮助表示赞赏。

编辑：我还应该说，它符合要求，但是当我再次选择其中一个选项时，它就会引发异常。

EDIT2：我还应该提到，选择是从用户那里获取一行而不是一个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:36:34.197

您可能正在使用 nextInt 而不检查流上是否有可读取的内容，正如[nextInt 的 javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#nextInt%28%29)所说：

> 抛出：
> 
> NoSuchElementException - 如果输入已用尽

在尝试从流中读取一个 int 之前，尝试使用[hasNextInt()检查是否有一个 int。](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html#hasNextInt%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:39:33.157

抛出异常是因为没有返回`token`的下一个。`input`

为了避免这种情况，最好先检查下一个using`exceptions`的存在。如果它返回 true，则使用 提取下一个标记。例子。`token``input.hasNextInt()``input.nextInt()`

```
if (input.hasNextInt())
{
   int i = input.nextInt();
} 
```

**编辑**

此错误可以通过以下方式产生：

```
public class Scanned
{
    public static void main(String st[])
    {
        Scanner input = null;
        try
        {
            InputStream in = System.in;
            input = new Scanner (in);
            while (true)
            {
                System.out.println(input.nextInt());
                in.close();
            }
        }
        catch (Exception ex)
        {
            System.out.println(ex);
        }
    }
} 
```

确保 InputStream 在循环内没有关闭。

# r - 动物园情节中奇怪的虚线

> ID：14541266
> 
> 赞同：1
> 
> 时间：2013-01-26T20:28:53.353
> 
> 标签：r, plot, statistics, time-series, zoo

我有以下非常简单的 R 脚本，它使用 zoo 在时间线上可视化每日数字：

```
# Small script to plot daily number of added users to database
library(zoo)

data <- read.csv("search_history.csv", header=FALSE)
# last line will be cut because it might be incomplete
zoodata <- data[1:(length(data$V2)-1), ]
series <- zoo(zoodata$V2, zoodata$V1)

par(mar=c(7, 6, 4, 2), 
    lab=c(5, 6, 5), 
    mgp = c(4, 1, 0))

plot(series,
     main="Number of users added to database over time", 
     xlab="Date", 
     ylab="Number of users",
     las=2,
     lwd=2,
     col="red",
     cex.axis=0.7) 
```

search_history.csv 的内容：

```
"2012-12-27","458","4728"
"2012-12-28","239","6766"
"2012-12-29","193","8189"
"2012-12-30","148","7698"
"2012-12-31","137","7370"
"2013-01-01","119","6324"
"2013-01-02","122","7016"
"2013-01-03","115","7986"
"2013-01-04","112","8222"
"2013-01-05","112","6828"
"2013-01-06","124","7318"
"2013-01-07","121","8228"
"2013-01-08","120","8158"
... 
```

我想可视化第一列（V1）和第二列（V2）。我基本上有两个问题：第***一个***也是显而易见的问题是 y-Position ~50 和 ~450 处的虚线。我怎样才能删除它们，为什么它们甚至包括在内？

第二***个***问题是将 2013-01-26 包含在 x 轴中。如您所见，我删除了包含此数据的数据集的最后一行（就像业余爱好者一样，也许有更好的方法来做到这一点）。所以情节不应该包括最后日期。我不明白为什么它甚至知道这个日期，因为它需要`zoodata`作为输入，而不是`data`. ![我的阴谋](../Images/b6622aca925dd774ff03cac46cd070c3.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T20:55:01.943

您可以使用`read.zoo`

```
## double quotes were removed but they could have been left in
series <- read.zoo(text = '
2012-12-27,458,4728
2012-12-28,239,6766
2012-12-29,193,8189
2012-12-30,148,7698
2012-12-31,137,7370
2013-01-01,119,6324
2013-01-02,122,7016
2013-01-03,115,7986
2013-01-04,112,8222
2013-01-05,112,6828
2013-01-06,124,7318
2013-01-07,121,8228
2013-01-08,120,8158', sep =',') 
```

然后使用你的情节指令，

```
plot(series,
     main="Number of users added to database over time", 
     xlab="Date", 
     ylab="Number of users",
     las=2,
     lwd=2,
     col="red",
     cex.axis=0.7) 
```

您可以直观地比较 2 Times 系列... ![在此处输入图像描述](../Images/5e79b2e1548e4959ca47a479e6cb772f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T20:52:56.207

两件事：您的字符串被视为因素，并且您`zoo`通过字符向量而不是日期来索引您的对象。

如果你`stringsAsFactors=FALSE`在你的`read.csv`调用中包含并给你的`zoo`对象一个`Date`索引，它看起来更像你所期望的。

```
library(zoo)    
data <- read.csv(text='"2012-12-27","458","4728"
                 "2012-12-28","239","6766"
                 "2012-12-29","193","8189"
                 "2012-12-30","148","7698"
                 "2012-12-31","137","7370"
                 "2013-01-01","119","6324"
                 "2013-01-02","122","7016"
                 "2013-01-03","115","7986"
                 "2013-01-04","112","8222"
                 "2013-01-05","112","6828"
                 "2013-01-06","124","7318"
                 "2013-01-07","121","8228"
                 "2013-01-08","120","8158"', header=FALSE, 
                 stringsAsFactors=FALSE)

zoodata <- data[1:(length(data$V2)-1), ]
series <- zoo(zoodata$V2, as.Date(zoodata$V1))

par(mar=c(7, 6, 4, 2), 
    lab=c(5, 6, 5), 
    mgp = c(4, 1, 0))

plot(series,
     main="Number of users added to database over time", 
     xlab="Date", 
     ylab="Number of users",
     las=2,
     lwd=2,
     col="red",
     cex.axis=0.7) 
```

产生：

![在此处输入图像描述](../Images/dd8719905c818656640d49f6f7b93ae5.png)

# php - ajax 发布问题

> ID：14541267
> 
> 赞同：0
> 
> 时间：2013-01-26T20:29:02.973
> 
> 标签：php, jquery, ajax, post, youtube

我在使用 ajax 将数据发布到我的 php 脚本时遇到问题。

萤火虫 说：

```
SyntaxError: missing ) after argument list
[Break On This Error]   

com&enquiry=http%3A%2F%2Fwww.youtube.com.au%0A%0AIt%20doesn't%20work..it's')

v2.js (line 1, col 60) 
```

我的 JavaScript 是：

```
var g="name="+q.val()+"&phone="+k.val()+"&email="+l.val()+"&enquiry="+encodeURIComponent(i.val())

jQuery.ajax({type:"POST",url:"mail.php",data:g,cache:false,success:function(b){}}) 
```

查询来自文本区域，发布的消息是：

[http://www.youtube.com.au](http://www.youtube.com.au)

没用。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:32:10.763

试试这样：

```
jQuery.ajax({
    type: "POST",
    url: "mail.php",
    data: { 
        name: q.val(),
        phone: k.val(),
        email: l.val(),
        enquiry: i.val()
    },
    cache: false,
    success:function(b) {

    }
}); 
```

这样 jQuery 将负责正确地对所有参数进行 url 编码。

# php - php检测旧链接并将其重定向到新链接

> ID：14541268
> 
> 赞同：2
> 
> 时间：2013-01-26T20:29:12.447
> 
> 标签：php, redirect, http-redirect

最近我改变了网站softare，我对旧链接有一个很大的问题。我的网站在谷歌上有超过 15.000 个索引页面，我不想丢失这个链接。

我的旧个人资料链接看起来像这样[http://website.com/username](http://website.com/username)

新链接如下所示：[http ://website.com/profile/view/?uid=123469](http://website.com/profile/view/?uid=123469)

所以，问题是我的新系统使用 Kohana，并且所有 301 等都被重定向到 404 页面，在 htcacces 上我无法重写，我尝试了所有方法但没有，任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T13:01:04.400

生成一个**平面文件字典**，并在任何代码启动之前，通过字典运行当前请求查询`header 301`并对相应的新地址进行请求。

```
$url_rewrites = array(
    '/profile/view/?uid=123469' => '/username',
    '/profile/view/?uid=1234692' => '/username2',
    '/profile/view/?uid=1234693' => '/username3',
);

if (($key = array_search($_SERVER['REQUEST_URI']), $url_rewrites)){
    header('Location: ' . $key, true, 301);
} 
```

大约两三个月后，放下字典。

# java - 围绕一个点的精灵旋转 Andengine/Java

> ID：14541269
> 
> 赞同：4
> 
> 时间：2013-01-26T20:29:18.793
> 
> 标签：java, android, andengine

有谁知道我怎样才能让精灵/位图旋转某个角度，其中一侧的点将始终保持在同一位置。

![在此处输入图像描述](../Images/b9558b4a694afb655e02a7b281a4f580.png)

我在图像中有一条蓝线，我需要其中一侧始终保持在同一位置。如果有人能告诉我如何做到这一点，那将是很大的帮助。我试图在 Andengine/Java 中做到这一点。因此，任何一种解决方案都将是最有帮助的。

谢谢

问候， 雅罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T17:04:42.180

AndEngine 有一个很好的方法叫做 setRotationCenter。:) 默认旋转中心设置为精灵的中心（宽度的一半，高度的一半）。您可以轻松更改这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:41:27.640

AndEngine 在旋转和定位方面非常有限，我自己也遇到过类似的问题，解决它的唯一方法是覆盖方法和扩展类。

我建议你植入一个新的方法来设置旋转轴，并覆盖 setRotation() 方法，使用这个轴，我想你可以通过改变它的位置来弄清楚如何在不同的轴上旋转精灵改变它的旋转

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-24T03:23:10.380

我只是找到了在任何中心点旋转精灵的解决方案。首先，您创建一个虚拟实体并将您的精灵附加到该实体中（注意：精灵的位置与您的实体相关），然后您移动精灵的旋转中心（默认在图像中心）以与实体的旋转中心重叠。最后，您为实体而不是精灵设置旋转。希望这有帮助^^

# iphone - 更改选定索引时重新加载 UITabbarController

> ID：14541275
> 
> 赞同：0
> 
> 时间：2013-01-26T20:30:01.540
> 
> 标签：iphone, uitabbarcontroller, custom-controls

我有一个带有 2 个选项卡的 UITabBarController。我想要当我单击选项卡 2（viewController B）然后单击带有导航控制器（viewController C）的下一步按钮。然后，我单击返回按钮（自定义按钮）返回选项卡 1（视图控制器 A），我希望当我再次返回选项卡 2 时，视图控制器应该是显示视图控制器 B。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T07:45:00.737

在自定义按钮（后退按钮）操作上，您应该调用 popViewController，然后跳转到 Tab 1。或者当按下 Tab 2 时，您可以检查您是否在 navigationcontroller 的根视图控制器中，如果没有将 ViewController B 作为根.

# linux - 快速删除多个文件之间的重复行

> ID：14541282
> 
> 赞同：1
> 
> 时间：2013-01-26T20:31:03.740
> 
> 标签：linux, performance, duplicate-removal

我有 10k 个文件，每个文件有 80k 行，需要比较，并且 - 删除重复的行或将它们替换为“0”。超快，因为我必须做 +1000 次。

对于少于 100 行的文件，以下脚本足够快。现在 tcsh

```
import csv
foreach file ( `ls -1 *` )
split -l 1 ${file} ${file}.
end
find *.* -type f -print0 | xargs -0 sha512sum | awk '($1 in aa){print $2}(!($1 in  aa)){aa[$1]=$2}' | xargs -I {} cp rowzero {} 
cat ${file}.* > ${file}.filtered 
```

其中“rowzero”只是一个带有...零的文件。我已经尝试过python，但还没有找到快速的方法。我尝试粘贴它们并做所有快速的事情（awk、sed、上面的命令等），但是当文件超过例如 1000 列时，i/o 会减慢到令人难以置信的水平。我需要帮助，谢谢一百万小时！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T17:55:54.447

好的，这是迄今为止我可以制作的最快的代码，它适用于转置和“猫”输入。如前所述，“cat”-ed 输入“>>”可以正常工作，但是“paste”或“pr”代码会让人做噩梦，比如在 +1GB 文件中粘贴另一列，这就是我们需要转置的原因。例如每个原始文件看起来像

```
1
2
3
4

```

...如果我们将第一个文件与其他文件一起转置和 cat ，则代码的输入将如下所示：

```
1 2 3 4 ..
1 1 2 4 ..
1 1 1 4 ..

```

代码将返回原始的“aka retransposed paste”格式，其中包含洗牌行的次要细节

```
1
1 2
1 2 3
2 3 4
..

```

重复的行被有效地删除。在代码下方，

但是代码不通用！它仅适用于 1 位整数，因为 awk 数组索引未排序。有人可以帮忙概括一下吗？谢谢！

`{for(ii=1;ii<=NF;ii++){aa[ii,$ii]=$ii}}END{mm=1; for (n in aa) {split(n, bb, SUBSEP); if (bb[1]==mm){cc=bb[2]; printf ( "%2s", cc)}else{if (mm!=bb[1]){printf "\n%2s", bb[2] }; mm=bb[1]}}}`

# jasmine - Jasmine toEqual 用于复杂对象（与函数混合）

> ID：14541287
> 
> 赞同：19
> 
> 时间：2013-01-26T20:32:07.153
> 
> 标签：jasmine, matcher

目前，我有一个函数有时会返回一个内部包含一些函数的对象。使用`expect(...).toEqual({...})`时它似乎与那些复杂的对象不匹配。具有函数或`File`类的对象（来自输入类型文件），它就是不能。如何克服这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-26T20:38:25.873

试试[下划线 _.isEqual()](http://underscorejs.org/#isEqual)函数：

```
expect(_.isEqual(obj1, obj2)).toEqual(true); 
```

如果可行，您可以创建一个[自定义匹配器](https://github.com/pivotal/jasmine/wiki/Matchers)：

```
this.addMatchers({
    toDeepEqual: function(expected) {
        return _.isEqual(this.actual, expected);
    };
}); 
```

然后，您可以编写如下规范：

```
expect(some_obj).toDeepEqual(expected_obj); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-27T02:35:21.177

正如 Vlad Magdalin 在评论中指出的那样，将对象制作成 JSON 字符串，它可以和函数一样深，以及 File/FileList 类。当然，不是`toString()`在函数上，它可以被称为“函数”

```
function replacer(k, v) {
    if (typeof v === 'function') {
        v = v.toString();
    } else if (window['File'] && v instanceof File) {
        v = '[File]';
    } else if (window['FileList'] && v instanceof FileList) {
        v = '[FileList]';
    }
    return v;
}

beforeEach(function(){
    this.addMatchers({
        toBeJsonEqual: function(expected){
            var one = JSON.stringify(this.actual, replacer).replace(/(\\t|\\n)/g,''),
                two = JSON.stringify(expected, replacer).replace(/(\\t|\\n)/g,'');

                return one === two;
            }
    });
});

expect(obj).toBeJsonEqual(obj2); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-02-25T22:48:33.573

如果有人像我一样使用 node.js，当我只关心比较简单属性而忽略所有功能时，我在 Jasmine 测试中使用以下方法。此方法需要[json-stable-stringify](https://www.npmjs.com/package/json-stable-stringify)用于在序列化之前对对象属性进行排序。

**用法：**

```
 var stringify = require('json-stable-stringify');

  var obj1 = {
    func: function() {
    },
    str1: 'str1 value',
    str2: 'str2 value',
    nest1: {
    nest2: {
        val1:'value 1',
        val2:'value 2',
        someOtherFunc: function() {
        }
      }
    }
  };

  var obj2 = {
    str2: 'str2 value',
    str1: 'str1 value',
    func: function() {
    },
    nest1: {
      nest2: {
        otherFunc: function() {
        },
        val2:'value 2',
        val1:'value 1'
      }
    }
  };

  it('should compare object properties', function () {
    expect(stringify(obj1)).toEqual(stringify(obj2));
  }); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-06T03:19:38.177

扩展@Vlad Magdalin 的答案，这在 Jasmine 2 中有效：

[http://jasmine.github.io/2.0/custom_matcher.html](http://jasmine.github.io/2.0/custom_matcher.html)

```
beforeEach(function() {
  jasmine.addMatchers({
    toDeepEqual: function(util, customEqualityTesters) {
      return {
        compare: function(actual, expected) {
          var result = {};
          result.pass = _.isEqual(actual, expected);
          return result;
        }
      }
    }
  });
}); 
```

如果您使用的是 Karma，请将其放在启动回调中：

```
callback: function() {
  // Add custom Jasmine matchers.
  beforeEach(function() {
    jasmine.addMatchers({
      toDeepEqual: function(util, customEqualityTesters) {
        return {
          compare: function(actual, expected) {
            var result = {};
            result.pass = _.isEqual(actual, expected);
            return result;
          }
        }
      }
    });
  });

  window.__karma__.start();
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-11-12T23:14:32.700

这是我使用`Jasmine 2`语法的方法。

`../support/customMatchers.js`我在（我喜欢制作模块）中创建了一个 customMatchers 模块。

```
"use strict";

/**
 *  Custom Jasmine matchers to make unit testing easier.
 */
module.exports = {
  // compare two functions.
  toBeTheSameFunctionAs: function(util, customEqualityTesters) {
    let preProcess = function(func) {
      return JSON.stringify(func.toString()).replace(/(\\t|\\n)/g,'');
    };

    return {
      compare: function(actual, expected) {
        return {
          pass: (preProcess(actual) === preProcess(expected)),
          message: 'The functions were not the same'
        };
      }
    };
  }
} 
```

然后在我的测试中使用如下：

```
"use strict";

let someExternalFunction = require('../../lib/someExternalFunction');
let thingBeingTested = require('../../lib/thingBeingTested');

let customMatchers = require('../support/customMatchers');

describe('myTests', function() {

  beforeEach(function() {
    jasmine.addMatchers(customMatchers);

    let app = {
      use: function() {}
    };

    spyOn(app, 'use');
    thingBeingTested(app);
  });

  it('calls app.use with the correct function', function() {
    expect(app.use.calls.count()).toBe(1);
    expect(app.use.calls.argsFor(0)).toBeTheSameFunctionAs(someExternalFunction);
  });

}); 
```

# java - Java：我如何知道组件位于哪个容器上

> ID：14541289
> 
> 赞同：1
> 
> 时间：2013-01-26T20:32:25.487
> 
> 标签：java, swing

标题有点模棱两可，我会用代码解释。假设我有

```
Class A extends JFrame implements ActionListener{
     B b;
     Class B extends JPanel{
         public JButton button;
         public B(A a){
               button = new JButton();
               button.addActionListener(a);// I want to process all actionEvents in A
               this.add(button);
         }
     }
     public A(){
         b = new B(this);
         //irrelevant codes omitted for brevity  
     }

     public void actionPerformed(ActionEvent e){
         //Here's the question: 
         //Suppose I have a lot of Bs in A, 
         //how can I determine which B the button 
         //that triggers this callback belongs to?
     }
} 
```

那么有什么办法吗？还是我的想法错了？欢迎任何想法。

编辑：我最后要做的是向 B 添加一个函数`has(JComponent component)`，以与每个可点击的 B 进行比较。当您拥有多层 JPanel 时，这`getParent()`会变得很尴尬，因为很难弄清楚它指的是哪一层面板，而且这与封装的想法背道而驰。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:34:14.913

用于`e.getSource()`获取对触发事件的确切组件的引用。在您的情况下，它将是一个`JButton`. 要获取它所在的面板，请使用`e.getSource().getParent()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:05:35.120

说你有`B[] bs = new B[n];`

然后您可以`action command`为每个按钮设置，例如：

```
for (B b : bs) {
    b.setActionCommand("some identifiable command");    // use different command for different buttons
} 
```

然后在`actionPerformed`方法中，打开命令：

```
public void actionPerformed (ActionEvent e) {
    switch (e.getActionCommand()) {
        case "cmd1":
            // do something
            break;
        case "cmd2":
            // do something
            break;
        default:
    }
} 
```

您还可以使用`Action`对象，它更灵活但更复杂一些。有关更多信息，请阅读 Java 教程：

*   [如何使用按钮、复选框和单选按钮](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)
*   [如何使用动作](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)

# kendo-ui - kendo ui：子网格中没有数据

> ID：14541291
> 
> 赞同：0
> 
> 时间：2013-01-26T20:32:40.993
> 
> 标签：kendo-ui, kendo-grid

我正在使用 kendo ui 创建丰富的用户界面，但我坚持以下几点：我想要一个带有子网格的网格，第一个显示客户信息，如姓名等，第二个显示可用的送货地址，客户得救了。现在我的问题是，子网格中不是数据，尽管萤火虫显示，数据已返回。这是我的来源：

```
$(function() {
var main = $("#customer-grid").kendoGrid({
    dataSource: {
        transport:{
            read      :"data/users.php",
            update    :{
                url :"data/users.php?action=update",
                type:"POST",
                data: function (data) {
                    data.birthday = kendo.toString(data.birthday, "yyyy-MM-dd");
                    return data;
                    }
            },
            destroy:{
                url :"data/users.php?action=destroy",
                type:"POST"
            }
        },
        schema: {
            data: "data",
            model: {
                id: "id",
                fields: {
                    id: {editable: false},
                    activated: { type: "boolean" },
                    birthday: {type: "date"},
                    gender: {defaultValue: "W"}
                }
            }
        }
    },
    height: 250,
    filterable: true,
    sortable: true,
    pageable: true,
    detailInit: detailInit,
    dataBound: function() {
        this.expandRow(this.tbody.find("tr.k-master-row").first());
    },
    columns: [{ 
                field: "id",
                title: "ID",
                width: "50px"
            }, { 
                field: "gender",
                title: "Geschlecht",
                width: "100px",
                values: data
            }, {
                field: "firstname",
                title: "Vorname"
            }, {
                field: "lastname",
                title: "Nachname"
            }, {
                field: "birthday",
                title: "Geburtstag",
                width: "100px",
                format: "{0:dd.MM.yyyy}"
            },{
                field: "mail",
                title: "E-Mail"
            },{
                field: "activated",
                title: "Aktiviert",
                width: "100px",
                values: actval                  
            }, { 
                command: ["edit", "destroy"], 
                title: "&nbsp;", 
                width: "210px" 
            }],
            editable:{
                mode: "popup"
            }
});
});

function detailInit(e) {
    $("<div/>").appendTo(e.detailCell).kendoGrid({
        dataSource: {
            transport: {
                read: "data/adress.php?uid="+e.data.id
            },
            serverPaging: true,
            serverSorting: true,
            serverFiltering: true,
            pageSize:6
        },
        scrollable: false,
        sortable: true,
        pageable: true,
        columns: [
            { field: "id", width: 70 },
            { field: "zipcode", title:"Ship Country", width: 100 },
            { field: "city", title:"Ship Address" },
            { field: "street", title: "Ship Name", width: 200 }
        ]
    });
} 
```

该函数从 php 页面获取数据，该页面执行 mysql-query，然后将数据作为 application/json 返回。但什么都没有显示。

希望你们能帮助我。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T23:57:00.543

我测试了你的代码，它工作正常。

查看：

1.  `e`参数格式。我用过：`detailInit({ detailCell : $("#grid"), data : { id : 1}});`
2.  JSON 返回的`data/adress.php`. 我回来了：

> ```
> [
>     {"city":"Madrid", "id":"1", "zipcode":"31000", "street":"my street 1", "number":5},
>     {"city":"Sofia", "id":"2", "zipcode":"32000", "street":"my street 2", "number":4},
>     {"city":"London", "id":"3", "zipcode":"33000", "street":"my street 3", "number":3},
>     {"city":"San Francisco", "id":"4", "zipcode":"34000", "street":"my street 4", "number":2},
>     {"city":"Berlin", "id":"5", "zipcode":"35000", "street":"my street 5", "number":1}
> ] 
> ```

使用以下（硬编码）php响应：

```
<?php
header('Content-type: application/json');
$named_array = array(
    array("city" => "Madrid", "id" => "1", "zipcode" => "31000", "street" => "my street 1", "number" => 5),
    array("city" => "Sofia", "id" => "2", "zipcode" => "32000", "street" => "my street 2", "number" => 4),
    array("city" => "London", "id" => "3", "zipcode" => "33000", "street" => "my street 3", "number" => 3),
    array("city" => "San Francisco", "id" => "4", "zipcode" => "34000", "street" => "my street 4", "number" => 2),
    array("city" => "Berlin", "id" => "5", "zipcode" => "35000", "street" => "my street 5", "number" => 1)
);
echo json_encode($named_array);
?> 
```

**编辑**：这是包含子网格的网格的定义。

```
var outer = $("#outer").kendoGrid({
    dataSource:{
        type:"json",
        transport:{
            read:"names.php"
        },
        pageSize:5
    },
    sortable:true,
    columns:[
        { field:"id", width:70 },
        { field:"name", title:"Name", width:100 },
        { field:"lastname", title:"LastName", width:100 },
        { title:"Address", width:300, attributes:{ class:"ob-address"}}
    ]
}).data("kendoGrid"); 
```

然后单击按钮，我运行：

```
$(".ob-address", outer.tbody).each(function (idx, elem) {
    detailInit({ detailCell:elem, data:{ id:1}});
}); 
```

正如你所看到的，我在`outer`网格中标记了一个名为 CSS 类的列，`ob-address`该函数选择`outer`表格主体中的所有单元格以插入内部表格（子网格）。

# html - ListItems 在浮动块元素周围流动的左边距问题

> ID：14541292
> 
> 赞同：3
> 
> 时间：2013-01-26T20:32:48.490
> 
> 标签：html, css, html-lists, margin, floating

我有一个浮动块元素和一个围绕它流动的项目的无序列表。listItems 的边距似乎与浮动元素重叠。

这是一个简化的示例：

```
<p>some text</p>
<div class="leftcaption">image with caption</div>
<p>some more text, now comes a list</p>
<ul>
    <li>Item (bad left margin)</li>
    <li>Item</li>
    <li>Item</li>
    <li>Item</li>
    <li>Item</li>
    <li>Item</li>
    <li>Item (correct left margin after the caption div)</li>
</ul> 
```

CSS：

```
* { margin:5px; }
ul {
    list-style-type:disc;
    margin-left:30px;
}
.leftcaption {
    float:left;
    margin: 5px 5px 5px 0;
    /* just to make it look like a real caption: */
    background-color: #DDD;
    width:100px;
    height:100px;
} 
```

这是它的样子：

![错误列表项边距的示例](../Images/12955ea4b824c9fd4f784769d0e21fa8.png)

一种解决方法是使无序列表成为块级元素，但随后它将不再流动，此外，如果还有一个块浮动到右侧，它将被下推。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:34:55.803

将`list-style-position:inside;`规则添加到您的 CSS。

**[jsFiddle 示例](http://jsfiddle.net/j08691/UQP78/3/)**

```
ul {
    list-style-type:disc;
    margin-left:30px;
    list-style-position:inside;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:20:59.453

另一种方法也可以让您添加边距：

```
ul {
    margin-left:0; list-style-type:none;
}
ul li:before{
    content:"\00A0\25cf\00A0\00A0\00A0";
} 
```

@j08691 提供的解决方案可能仍然是最好的选择，但必须将左边距和填充设置为 0 以保持间距一致。

使用此解决方法，可以在光盘之前和之后输入不间断空格。

# html - 兄弟选择器（波浪号）问题

> ID：14541293
> 
> 赞同：0
> 
> 时间：2013-01-26T20:33:06.033
> 
> 标签：html, css, css-selectors

我正在尝试修改设计中的命名元素。正如你在这个小提琴中看到的那样，我已经简化了这种情况：http: [//jsfiddle.net/6THpF/](http://jsfiddle.net/6THpF/)

简单地说，当我尝试从另一个命名元素修改一个命名元素时，它可以工作，但是当我尝试从相反方向（其他元素）进行相同的修改时，它不起作用。

这是示例代码：

```
body{
    background-color:lightgrey;
}

#div_one, #div_two{
    background-color:darkred;
    display:block;
    width:300px;
    text-align:center;
    padding:30px;
    margin:10px;
    color:white;
    -webkit-transition: 0.3s ease;
  -moz-transition: 0.3s ease;
  -ms-transition: 0.3s ease;
  -o-transition: 0.3s ease;
  transition: 0.3s ease;

}
#div_one:hover ~ #div_two{
    background-color:red;
}
#div_two:hover ~ #div_one{
    background-color:red;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:37:24.960

来自[MDN](https://developer.mozilla.org/en-US/docs/CSS/General_sibling_selectors)：

> ~ 组合符分隔两个选择器，并且仅当第二个元素在第一个元素之前时才匹配第二个元素，并且两者共享一个共同的父元素。

因此，因为没有在第二条规则`div_one`之前是`div_two`行不通的。换句话说，没有“前一个兄弟”选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:08:03.290

试试这个。我回答：
HTML：

```
<div id="div_one">This is div 1</div>
<div id="div_two">This is div 2</div> 
```

CSS：

```
body{
    background-color:lightgrey;
}

#div_one, #div_two{
    background-color:darkred;
    display:block;
    width:300px;
    text-align:center;
    padding:30px;
    margin:10px;
    color:white;
    -webkit-transition: 0.3s ease;
  -moz-transition: 0.3s ease;
  -ms-transition: 0.3s ease;
  -o-transition: 0.3s ease;
  transition: 0.3s ease;

} 
```

JAVASCRIPT：

```
$(document).ready(function(){
    $("#div_one").mouseover(function(){
    $("#div_two").css("backgroundColor","blue");
    });
    $("#div_one").mouseout(function(){
    $("#div_two").css("backgroundColor","darkred");
    });
    $("#div_two").mouseover(function(){
    $("#div_one").css("backgroundColor","blue");
    });
    $("#div_two").mouseout(function(){
    $("#div_one").css("backgroundColor","darkred");
    });
    }); 
```

请记住使用并将`jquery.js`核心嵌入到您的网页中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-27T09:14:03.647

我没有解决兄弟选择器问题（我认为无法解决），而是预期的效果。您需要将两个 div 组合为一个：

```
<div>
    <div id="div_one">This is div 1</div>
    <div id="div_two">This is div 2</div>
</div> 
```

现在针对组 div 的悬停状态：

```
div:hover #div_two{
background-color:red;
}
div:hover #div_one{
background-color:red;
} 
```

当然后者可以写得更好，（或更短）我只是想在你的例子中尽可能少地改变

这有一些你可能需要解决的缺点。

如果您希望 div 在它们之间有空间（并且该空间不响应悬停），那么我认为您需要将它们更改为绝对定位。

看[小提琴](http://jsfiddle.net/hgsZm/3/)

**已编辑**

我错过了关于不悬停悬停 div 的要求。将 CSS 更改为

```
div:hover #div_two:not(:hover){
background-color:red;
}
div:hover #div_one:not(:hover){
background-color:red;
} 
```

现在我认为这是你想要的[编辑小提琴](http://jsfiddle.net/vals/hgsZm/5/)

# ios - 未调用数据控制器中的 iOS 方法

> ID：14541295
> 
> 赞同：0
> 
> 时间：2013-01-26T20:33:22.087
> 
> 标签：ios, methods, error-handling

我试图在我的数据控制器对象中调用一个方法来为我的应用程序加载数据，但由于某种原因它没有被调用。下面是我为初始化它所做的事情。任何帮助将不胜感激。

视图控制器：

头文件：

```
#import <UIKit/UIKit.h>

@class DetailViewController;
@class DataController;

#import <CoreData/CoreData.h>
#import "JointCAD.h"

@interface TableViewController : UITableViewController {

}

@property (nonatomic, assign) DataController *dataController;

@end 
```

实现文件：

```
#import "TableViewController.h"
#import "DataController.h"

@implementation TableViewController

@synthesize dataController;

- (void)viewDidLoad {

[dataController refreshData];

}

@end 
```

数据控制器：

头文件：

```
#import <Foundation/Foundation.h>
#import "JointCAD.h"
#import "JointCADXMLParser.h"
#import "TFHpple.h"

@interface DataController : NSObject {

    TFHpple *xpathParser;
}

- (void)refreshData;

- (void)initXMLParser;

- (void)noCallsMessage;

- (void)noInternetMessage;

@end 
```

实现文件：

```
#import "DataController.h"

@implementation DataController

XMLParser *xmlParser;

- (void)refreshData {

NSLog("Some Method");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:37:09.727

'dataController' 对象是否由其他类设置？- 我相信这就是您将其设置为属性的原因？正确的？

如果否，则删除属性，@synthesize 'dataController' 并尝试简单分配您的 'dataController' 对象，然后尝试调用您的方法。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:11:01.287

您要么需要在实际调用其中一个方法之前初始化“DataController”，要么需要通过将“-”更改为“+”来使方法“refreshData”成为一个类。

如果您需要实例回调。您需要像这样重写“viewDidLoad”：

```
- (void)viewDidLoad {

DataController *dataController = [[DataController alloc] init];
[dataController refreshData];

} 
```

并且去掉 dataController 的属性声明，因为你还没有初始化它。如果您更喜欢属性声明，只需在调用视图控制器之前分配视图控制器。

```
- (void)viewDidLoad {
dataController = [[DataController alloc] init];
[dataController refreshData];

} 
```

最后要注意的一件事是，我（可能还有 Ray）假设您正在使用情节提要配置。如果您使用的是 xib 配置，则需要添加`initWithNibName:`到视图控制器的每个初始化中。

我希望这会有所帮助！

# javascript - 如何在 html/javascript 上获取 unicode 输入？

> ID：14541296
> 
> 赞同：0
> 
> 时间：2013-01-26T20:33:31.300
> 
> 标签：javascript, jquery, html, unicode

您可以使用 jQuery 轻松获取 ASCII 输入：

```
$('body').keypress(function(e){
    console.log('input: ',String.fromCharCode(e.keyCode));
}); 
```

测试输入特殊字符（例如 á é í ó ú）的此代码段不会给出预期的输入。如何在 HTML 上获得正确的 unicode 输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T23:13:30.480

这对我有用：

```
String.fromCharCode(225); 
```

返回

```
"á" 
```

这是一个涵盖 UTF-16 代码单元的解决方案，尽管它说您不应该有问题，因为您的字符都是“通常的 2 字节字符”：

[developer.mozilla.org：String.fromCodePoint](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/fromCharCode)

# python - 计算单词中的音节数

> ID：14541303
> 
> 赞同：8
> 
> 时间：2013-01-26T20:33:57.960
> 
> 标签：python, python-3.x

我是初学者，我有一个需要帮助的问题。这是家庭作业，因此不胜感激。我看过一些类似的话题，但答案超出了我的所知范围......

作为更大程序的一部分，我需要计算文本文件中的音节数。除了音节，我什么都有。我尝试了几种不同的方法，但并不总是能捕捉到特殊情况。我应该“计算相邻元音组，不包括单词末尾的“e”。我明白这意味着什么，但我无法在我的程序中正确理解它。这是我所拥有的:::

```
def syllables(word):
    syl = 0
    vowels = 'aeiouy'
    starts = ['ou','ei','ae','ea','eu','oi']
    endings = ['es','ed','e']
    word = word.lower().strip(".:;?!")
    for vowel in vowels:
        syl +=word.count(vowel)
    for ending in endings:
        if word.endswith(ending):
            syl -=1
    for start in starts:
        if word.startswith(start):
            syl -=1
    if word.endswith('le'):
        syl +=1
    if syl == 0:
        syl+=1
    return syl 
```

编辑：新代码

```
def syllables(word):
    count = 0
    vowels = 'aeiouy'
    word = word.lower().strip(".:;?!")
    if word[0] in vowels:
        count +=1
    for index in range(1,len(word)):
        if word[index] in vowels and word[index-1] not in vowels:
            count +=1
    if word.endswith('e'):
        count -= 1
    if word.endswith('le'):
        count+=1
    if count == 0:
        count +=1
    return count 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T20:43:12.360

只是一个建议，但不是“寻找”相邻的元音，每次遇到出现在单词开头或辅音之后的初始元音时，您是否可以不增加“计数”，除了“e” ' 在单词的末尾（除非您对该单词的计数为零）。澄清一下，任何时候你遇到相邻的元音，只有第一个元音会增加你的计数。

不肯定它会起作用，但我认为它适用于我刚刚写的所有单词。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-27T22:00:20.547

该主题已在[如何获取单词中的音节数？](https://datascience.stackexchange.com/questions/23376/how-to-get-the-number-of-syllables-in-a-word)

他们得出的结论是，CMU 发音词典中没有出现的单词应该像这里讨论的那样用一个简短的函数来处理。

另一个建议的解决方案是使用[pyphen](https://pyphen.org/)。

更简单：维基百科的文章[https://en.wikipedia.org/wiki/Hyphenation_algorithm](https://en.wikipedia.org/wiki/Hyphenation_algorithm)链接到[Francis Mark Liang 的连字算法](https://nedbatchelder.com/code/modules/hyphenate.py)的 Python 实现。该算法相当古老，但仍在 TeX 中使用。

```
>>> import hyphenate
>>> hyphenate.hyphenate_word("computer")
['com', 'put', 'er'] 
```

# c# - 当发布数据长度超过 8K 时，php 无法接收来自 C# webrequest 的请求

> ID：14541304
> 
> 赞同：0
> 
> 时间：2013-01-26T20:33:58.683
> 
> 标签：c#, php

我正在尝试通过 C# 将 base64 编码数据发送`WebRequest`到 php 脚本。然后我收到发送的数据`file_get_contents("php://input")`，当数据长度低于8 KBs时执行php代码，否则无法执行。另一方面php没有收到请求。

代码 C#：

```
 WebRequest request = WebRequest.Create(url);
            request.Method = "POST";
            // postData is Base64_encoded
            byte[] byteArray = Encoding.UTF8.GetBytes(postData); 

            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = byteArray.Length;

            Stream dataStream = request.GetRequestStream();
            dataStream.Write(byteArray, 0, byteArray.Length);
            dataStream.Close();

            WebResponse response = request.GetResponse();
            dataStream = response.GetResponseStream();
            StreamReader reader = new StreamReader(dataStream);
            string responseData = reader.ReadToEnd();
            responseData = SecurityUtils.DecryptUrlData(responseData);
            reader.Close();
            dataStream.Close();
            response.Close();
            return responseData; 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T01:16:16.097

1.  更改请求的内容类型

    request.ContentType = "文本/纯文本";

2.  在服务器端查看 php.ini的[post_max_size](http://php.net/post-max-size)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:53:24.197

以下是不正确的（mea culpa）。您不能将 enctype=multipart/form-data 与 php://input 一起使用。[看这里](http://php.net/manual/en/wrappers.php.php)

也许您也可以将您的 PHP 代码发布到您的问题中？

* * *

确保当您从 c# 应用程序 POST 到您的 PHP 应用程序时，您将 enctype 设置为 multipart/form-data。

**说明**

您使用的是 application/x-www-form-urlencoded 还是 multipart/form-data？这里有一个很好的解释：[application/x-www-form-urlencoded 或 multipart/form-data?](https://stackoverflow.com/questions/4007969/application-x-www-form-urlencoded-or-multipart-form-data)

根据上面的链接，以 application/x-form-urlencoded 格式发布数据会将正文放入 URL。当 URL 大于 8K 时，许多服务器和语言（PHP、Apache）会中断或抛出错误。请参阅 SO 问题：[URL 的最大长度是多少？](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)

# php - SQL 语句选择出现超过 2 次的重复记录

> ID：14541307
> 
> 赞同：4
> 
> 时间：2013-01-26T20:34:12.233
> 
> 标签：php, mysql, sql

我需要帮助来解决这种情况。我有一个包含记录的表，有一个字段 sku，在这个记录中我有 sku 多次出现。表结构是这样的 rid|id|sku|name

rid 是 auto_increment，其中 id 是 varchar，如果任何 sku 在表上多次可用，则记录看起来像这样

```
rid  id  sku     name
---  --  ------  --------------
1    3   rs-123  test product
2    3   rs-123  test product
3    4   rs-125  test product 2
4    4   rs-125  test product 2
5    4   rs-125  test product 2
6    6   rs-126  test product 3 
```

我使用这个 sql 语句来获取只出现一次的记录

```
SELECT *
FROM test
GROUP BY id
HAVING ( COUNT(id) = 1 ) 
```

这带来了只添加一次的记录，所以根据上面给出的记录，只有 rid 6 是输出

我尝试将上面的代码修改为此以获得添加2次的记录的结果

```
 SELECT * FROM test 
GROUP BY id 
HAVING ( COUNT(id) = 2 ) 
```

我得到的结果是那些添加了 2 次的记录，但问题是输出只出现了 1 条这样的记录；

```
rid  id  sku     name
---  --  ------  ------------
1    3   rs-123  test product 
```

我需要获取在数据库中添加 2 次的所有记录行。请帮忙

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T20:51:29.580

```
SELECT t.rid
     , t.id
     , t.sku
     , t.name
  FROM test t
  JOIN ( SELECT s.sku 
           FROM test s 
          GROUP BY s.sku
         HAVING COUNT(1) > 1
       ) d
    ON d.sku = t.sku 
```

别名为 as 的内联视图`d`返回在表中出现多次的 sku 值。我们可以将该查询的结果连接到表中，以获取具有匹配的 sku 的所有行。

是`id`和`sku`可互换的吗？我不清楚。（如果`id`isdependent on`sku`并且`sku`isdependent on `id`，那么您可以在该查询中将引用替换为`sku`对的引用。`id`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T20:56:55.573

测试驱动的查询设计——TDQD——脱颖而出。

### 查找出现多次的 SKU

```
SELECT sku
  FROM test
 GROUP BY sku
HAVING COUNT(*) > 1 
```

### 查找 SKU 出现多次的所有行的详细信息

```
SELECT t.*
  FROM test AS t
  JOIN (SELECT sku
          FROM test
         GROUP BY sku
        HAVING COUNT(*) > 1
       ) AS s
    ON t.sku = s.sku 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-26T20:43:03.967

```
CREATE TABLE test
(rid INT NOT NULL AUTO_INCREMENT PRIMARY KEY
,id INT NOT NULL
,sku VARCHAR(12) NOT NULL
,name VARCHAR(20) NOT NULL
);

INSERT INTO test VALUES 
(1,3,'rs-123','test product'),
(2,3,'rs-123','test product'),
(3,4,'rs-125','test product 2'),
(4,4,'rs-125','test product 2'),
(5,4,'rs-125','test product 2'),
(6,6,'rs-126','test product 3');

SELECT x.* FROM test x JOIN test y ON y.id = x.id GROUP BY x.rid HAVING COUNT(*) > 1;
+-----+----+--------+----------------+
| rid | id | sku    | name           |
+-----+----+--------+----------------+
|   1 |  3 | rs-123 | test product   |
|   2 |  3 | rs-123 | test product   |
|   3 |  4 | rs-125 | test product 2 |
|   4 |  4 | rs-125 | test product 2 |
|   5 |  4 | rs-125 | test product 2 |
+-----+----+--------+----------------+
5 rows in set (0.01 sec) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T20:36:59.837

此查询应该适合您：

```
SELECT * FROM test WHERE 
   id IN(SELECT id FROM test group by id HAVING count(id) > 1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T20:43:10.940

当您分组时，`Id`您不能在组中获得多个 ID，因此`COUNT(Id)`始终为 1。请改用此ID

```
SELECT * FROM test 
GROUP BY id 
HAVING ( COUNT(sku) = 2 ) 
```

如果您想获取具有多个重复项的所有记录，请`sku`使用以下命令：

```
SELECT * FROM test 
GROUP BY id 
HAVING ( COUNT(sku) > 1 ) 
```

# jquery - 显示特定 URL 路径的 div

> ID：14541316
> 
> 赞同：0
> 
> 时间：2013-01-26T20:35:07.497
> 
> 标签：jquery

我有一个网站，我需要为网站中的每个唯一页面（大约 25 页）显示特定的标题 div。我创建了一组变量和一个很长的 if else 语句（下面简化了 - 但运行了大约 25 个 if 语句深度）来运行该函数。该功能运行良好，但我遇到了大约 8 个页面无法运行的问题。

**问题：有没有比运行 if else 语句更好的方法来实现这一点？**

基本代码：

```
<div style="background: url(/image1.jpg)" class="landing hide"></div>
<div style="background: url(/image2.jpg)" class="information hide"></div>
<div style="background: url(/image3.jpg)" class="bell hide"></div>

var landing = "/home";
var information = "/information";
var bell = "/information/bell";

$(function(){
    if (location.pathname.search(landing)!=-1){
        $('.landing').show();
    } else {
       if (location.pathname.search(information)!=-1){
           $('.information').show();
       } else {
       if (location.pathname.search(bell)!=-1){
           $('.bell').show();
           } else {
               $('.landing').show();
           }
       }
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:40:53.330

您可以创建一个数组`routes`。

```
var routes = {
  "landing": {
    "classname": ".landing",
    "pathname": /^\/home/
  },
  "information": {
    "classname": ".information",
    "pathname": /^\/information/
  },
  ...
}; 
```

```
$(function(){
  for(route in routes){
    if(routes.hasOwnProperty(route)){
      if(window.location.pathname.match(routes[route].pathname) != -1) {
        $(routes[route].classname).show();
      }
    }
  }
}); 
```

注意`route.pathname`是正则表达式。前缀`^`字符意味着路径名需要以给定的字符串开头。

# ios - 隐藏/隐藏/加密存储在应用程序中的服务器 URL 的方法

> ID：14541318
> 
> 赞同：0
> 
> 时间：2013-01-26T20:35:24.050
> 
> 标签：ios, security, url, obfuscation

> **可能重复：**
> [Objective-C，如何混淆或加密 NSString？](https://stackoverflow.com/questions/10974946/objective-c-how-to-obfuscate-or-encrypt-nsstring)

我的应用程序使用 SSL 与服务器通信，但我想隐藏、隐藏或加密应用程序内的 URL，因此具有调试器/十六进制编辑器的黑客不会（容易地）看到它。

我想要一些不费时的东西。

大家有什么推荐的？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-26T20:39:08.337

使用 RESTful API 设计。您只需要存储基本 URL，其他所有内容都由服务器提供。

# javascript - 格式化输出文本 - 错误：“未定义为空或不是对象” - Javascript

> ID：14541319
> 
> 赞同：0
> 
> 时间：2013-01-26T20:35:33.567
> 
> 标签：javascript, html, parsing, textarea, string-formatting

我正在编写一个程序，它将获取文本区域的内容，提取重要信息，格式化然后输出。

我已经成功地让我的程序将所有信息传递到一个数组中。

目前我正在努力让程序识别客户姓名的位置（如果“详细信息”不在数组中的正确位置，它将始终位于“名称”和“详细信息”或“客户”之间。

```
// Parse the input box into an array
var inputArr = document.getElementById("inputBox").value.split(/[\s]/);

// Instantiate variables
var custDet, contactName, phone, companyName, email;

// Pull out all strings between "Name" and "Email" ("Card" should always be after "Email" or else it's the wrong string
if(inputArr[inputArr.indexOf("Email") + 1] == "Card") {
    custDet = inputArr.slice(inputArr.indexOf("Name") + 1, inputArr.indexOf("Email"));  

    // Pass the customer's name into the string contactName
    for(i = 0; custDet[i] != "Details" || custDet[i] != "Customer" || i < custDet.length; i++) {
        if(custDet[i].search(",") != -1) {
            var temp = custDet[i].split(/[,]/);
            temp.reverse();
            contactName = contactName + temp.join(" ");
        }
    }
    contactName = contactName + custDet.join(" ");
} else {
    contactName = prompt("Error: Could not locate a valid Contact Name. Please input Contact Name.");
    phone = prompt("Error: Could not locate a valid Contact Phone Number. Please input Contact Phone Number.");
    companyName = prompt("Error: Could not locate a valid Company Name. Please input Company Name.");
    email = prompt("Error: Could not locate a valid Email Address. Please input Email Address.");
} 
```

错误被抛出...

```
if(custDet[i].search(",") != -1) { 
```

我不明白为什么。对我的逻辑的任何帮助也将不胜感激。

谢谢你们。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:37:59.977

该错误可能意味着您尝试引用 的项目`i`，`custDet`但`custDet`其中没有那么多元素。

您的 for 循环是“非标准”的：

```
for(i = 0; custDet[i] != "Details" || custDet[i] != "Customer" || i < custDet.length; i++) 
```

我怀疑这是问题的根源。 `i`变得高于`custDet.length`，所以这意味着`custDet[i]`返回未定义。因为`undefined != "Details"`是真的，所以循环不断过去`custDet.length`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:50:13.153

你可能想要`&&`，不是`||`。否则，条件*永远*不会满足，循环也不会结束。

简单的解释：对于第一个为假的，`custDet[i]`必须等于`"Details"`。但如果是这样的话，那`custDet[i] != "Customer"`将是真的，循环将继续。对于 的所有其他值`custDet[i]`，`custDet[i] != "Details"`将为真，循环将继续。

# tridion - 重命名类别和关键字以及其他 GUI 标签

> ID：14541321
> 
> 赞同：6
> 
> 时间：2013-01-26T20:35:47.877
> 
> 标签：tridion

我们能否扩展/替换 SDL Tridion 2011 Content Manager Explorer 中显示的标签？

我对更改出版物下的根项目特别感兴趣。

## 背景

*SDL Tridion 具有组织项目，可对项目或构建块*进行分组或“存储” （不要与特定项目模板构建块混淆）。

例如：

*   文件夹存储组件、模式和模板。
*   结构组存储页面。
*   类别存储关键字。

在默认发布下，我们获得三个选项：根文件夹、根结构组和类别和关键字标签（包含类别）。

![仪表板树](../Images/f9201a19cb4850cb259e0550813a08fd.png)

`Categories & Keywords`标签本身与文件`Building Blocks`夹不同。Dominic Cronin 暗示[了这个 SO 答案中的差异](https://stackoverflow.com/a/11100238/395495)。

## 问题

1.  我可以重命名和本地化 Building Blocks 和 Root。**但是我可以/在哪里扩展/更改类别和关键字标签吗？** 我认为它是 Tridion.Web.UI.Strings 的一部分。它必须是翻译/可翻译的。
2.  替代方案建议？

更改这些的用例包括：

*   更改文件夹、SG 以及可能的类别和关键字名称，以使作者更容易了解他们在蓝图中的位置（当出版物名称不可见时，我有时会忘记上下文）
*   当“类别和关键字”或其他 Tridion 术语使作者感到困惑时，减少混淆。这应该谨慎使用，但也许“Tridion 类别”可以帮助区分组织已经使用的“类别”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T21:00:33.040

好问题。可以使用 DataExtender 修改 Tridion 响应，包括树。我知道之前已经编写了一个扩展来隐藏基于组成员身份的出站电子邮件分发列表树的某些部分。

但是，我认为我不会为此推荐 GUI 扩展。相反，我建议通过客户支持提交增强请求，因为它应该是产品的一部分，并且您有一个适用于许多客户的良好用例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T15:36:12.790

您可以创建一个 DataExtender，它将覆盖此特定节点的 Title 属性。您将通过其 ID 识别“类别和关键字”节点 - 它将以“catman-”前缀开头。

# jquery - 表单 OnSubmit 等待 jQuery Ajax 返回？

> ID：14541325
> 
> 赞同：2
> 
> 时间：2013-01-26T20:36:07.300
> 
> 标签：jquery, ajax, asynchronous, return, onsubmit

我想`$.ajax`在表单上触发，`onsubmit`并且`return true`只有在 Ajax 返回之后才有效。

例如：

```
<form id="myForm" onsubmit="return ajaxValidation();">
    <input id="myString" name="myString" type="text" />
    <input type="submit" value="Submit" />
</form> 
```

在 Javascript 中：

```
function ajaxValidation() {
    $.ajax({
        async: false,
        type: "POST",
        url: "ajax.php",
        data: { myString: $("#myString").val() }
    }).success(function( response ) {
        alert(response); //Got 'ok'
        if (response=="ok") {
            return true; //mark-1
        } else {
            alert("Oh, string is wrong. Form Submit is cancelled.");
        }
    });
    return false; //mark-2
} 
```

当我提交时，我得到了警报`ok`，但它返回了“假”，因为它跳到了最后`return false`一行。

为什么？我无法理解。实际上，它应该打到`return true`线。（而且，即使在 之后`return true`，该功能也应该停在那里并从中出来）

所以它现在的意思是，`does NOT wait`Ajax 返回的父函数。相反，它不断地运行到最后。知道为什么，请。如何让父函数等待Ajax？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:59:16.500

由于 AJAX 是异步的，因此在提交按钮上使用单击处理程序会更好地进行验证。

以下是基于删除内联`onSubmit`

```
$(function() {

    var $form = $('#myForm');

    $form.find('input[type="submit"]').click(function() {
        $.ajax({
           /* async: false,  this is deprecated*/
            type: "POST",
            url: "ajax.php",
            data: {
                myString: $("#myString").val()
            }
        }).success(function(response) {
            alert(response); //Got 'ok'
            if(response == "ok") {
             /*  submit the form*/
                $form.submit();
            } else {
                alert("Oh, string is wrong. Form Submit is cancelled.");
            }
        }); /* prevent default when submit button clicked*/
        return false;

    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:38:42.257

标记 1 处的返回值是针对您的 ajax 请求的成功功能，而不是针对您的验证功能。因此，即使它返回，它也只从那里返回，而不是从标记 2 的验证函数返回

# memory-management - Nothrow 与 CUDA 新

> ID：14541332
> 
> 赞同：3
> 
> 时间：2013-01-26T20:36:37.560
> 
> 标签：memory-management, cuda

`new`在使用CUDA 进行内核调用时，检查内存是否成功分配的最佳方法是什么？即使在内存分配失败的情况下，是否有类似`(nothrow)`的方法可以继续执行内核？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T20:43:47.540

我不认为这`new`在设备端得到正式支持。此外-据我所知-设备端不支持异常，因此注释之类`nothrow`的无效。

你*可以*在内核中做的是调用`malloc`. 失败后，该功能将返回`NULL`，您可以正常检查。

请注意

*   设备端`malloc`仅在设备 2.0 (Fermi) 及更高版本上受支持。
*   默认情况下，您只有 8MB 的堆内存。如果你想拥有更多，你需要通过设置更高的限制`cudaDeviceSetLimit`。

进一步阅读：CUDA C 编程指南，v.5.0，第 B.17 章 - 动态全局内存分配

* * *

更新：测试表明`new`似乎支持并且似乎以相同的方式工作，即`NULL`在失败时返回。

# php - 用户登录时更改内容，即会话开始时

> ID：14541339
> 
> 赞同：0
> 
> 时间：2013-01-26T20:37:30.727
> 
> 标签：php, codeigniter, session, login, codeigniter-2

用户登录时如何更改其内容？我的意思是启用投票，将“登录”更改为“注销”等。我认为要做的是在用户登录时启动会话（我更喜欢仅在用户登录时启动会话，而不是一直）。然后将数据添加到会话的 cookie 中，例如 -

```
//controller 
$moredata = array(
    'username'  => $this->username,
    'login' => TRUE
);
 $this->session->set_userdata($modedata);
//redirect 
```

然后在另一个控制器中，他已被重定向，我检查以下内容 -

```
$login = $this->session->userdata('login');
     if ($login==TRUE) 
```

根据“if”条件，我将向视图传递一个变量，在该变量的帮助下，我将只转发应该显示给登录用户的 div/sections。问题是，在执行上述比较时，Codeigniter 显示以下错误（记住我还没有在自动加载数组中添加“会话”）

```
Message: Undefined property: NameOfController::$session 
```

如果我在自动加载文件中设置以下

```
$autoload['libraries'] = array('session'); 
```

那么“if ($login==TRUE)”比较总是显示为 FALSE。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:46:33.313

如果我是你，我会把你所有的会话检查放在一个基本控制器中，你的所有其他主控制器都扩展了它。这使您可以[保持干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)：

```
class BaseController extends CI_Controller {

   public function __construct()
   {
      parent::__construct();
   }

   public function isLoggedIn()
   {
      // Will return true or false
      return $this->session->userdata('login');
   }

} 
```

在您的一个功能控制器中（下面的示例处理用户）：

```
class UserController extends BaseController {

   public function __construct()
   {
      parent::__construct();
   }

   public function profile()
   {
      // Redirect if not logged in
      if (!$this->isLoggedIn()) {
         $this->redirect('some/other/page')
      }
   }

   public function register()
   {
      // Show different HTML if not logged in
      $data = array(
         'isLoggedIn' => $this->isLoggedIn()
      );
      $this->load->view('register', $data);
   }

} 
```

UserController 中的第二种方法允许您在视图中呈现不同的内容：

```
<? if ($isLoggedIn): ?>
   <p>You're logged in!</p>
<? else: ?>
   <p>Not logged in</p>
<? endif; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T01:30:10.637

在我的上一个项目中，我们创建了一个简单的权限助手，它具有检查登录状态和权限级别的功能。然后，我们只需根据需要从系统中的任何位置调用辅助函数。如果用户已登录并拥有该内容的权限，那么他们将获得该内容 - 否则我们会将他们重定向到注册页面或其他错误页面。由于所有这些逻辑都在辅助函数中，我们可以将任何需要权限的代码包装在快速权限调用中，例如`if(is_logged_in()){code requiring login to access}`.

# javascript - 如何在临时图像上使用 jCrop？

> ID：14541344
> 
> 赞同：0
> 
> 时间：2013-01-26T20:38:01.697
> 
> 标签：javascript, jquery, jcrop

我有一个表格，您可以在其中从硬盘中选择一张图片，当您选择图片时，它会立即显示在同一页面上。

我想在缩略图演示中使用这张图片： [http](http://deepliquid.com/projects/Jcrop/demos.php?demo=thumbnail) ://deepliquid.com/projects/Jcrop/demos.php?demo=thumbnail 我还希望在更改输入文件时更改 jCrop 图像。

到目前为止，这是我的 PHP 文件：

```
 <html lang="en" xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <script class="jsbin"   src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script>
    function readURL(input) {
    if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(this.width)
                    .height(this.heigt);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    </script>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    </head>
    <body>          
    <input type="file" name="image" id="image" onchange="readURL(this)" /><br />
    <label for="image">Image:</label>
    <img id="blah" src="#" alt="your image" />      
    </body>
    </html> 
```

这可以按我的意愿工作，但是我无法解决如何将这张图片与 jCrop 一起使用，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:30:47.720

您必须将图像保存在一个临时文件夹中，因为 JCrop 的工作原理是获取原始图像并将其克隆到发生魔法的自定义容器中。

因此，您使用 php 将发布的图像保存在 tmp 文件夹中，然后将其输出到 a`<img>`中`<div id = 'cropbox'>`（每个示例），然后`$('#cropbox').Jcrop()`.

# matlab - 如何在 MATLAB 中自动校准坐标轴？

> ID：14541349
> 
> 赞同：0
> 
> 时间：2013-01-26T20:38:46.717
> 
> 标签：matlab, calibration, axis-labels

因此，我在 MATLAB 中进行了一些心电图分析，到目前为止，我已经检测到了如下图所示的关键特征：

![输出](../Images/5eb93ebc21101ab970565f4aa31255d3.png)

这是基本事实： ![在此处输入图像描述](../Images/182e40f1916505ca07b7e0543163cf35.png)

那么我如何重新绘制第一个图，使 x 轴的范围从 0 到 10（如第二张图所示）

我想这样做，以便我可以测量 Q（红十字）和 S（用圆圈标记的最小值处的峰值）之间的持续时间。

所以基本上我想 1) 将 3600 个样本校准到 10 秒内 2) 使用上述比例因子，能够自动将任意数量的样本校准到相关秒内。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:20:33.700

你是如何绘制第一个图形的？如果您没有提供任何 x 轴，如 中`plot(ecg)`，则 x-tick 标签将以 1 的间隔连续枚举。如果知道对应的时间点`t`，`ecg`就可以使用`plot(t, egg);`。

由于您知道采样率并假设每个数据点之间的间隔一致，因此您可以`t`自己生成`t = 10.0 / 3600 * (0 : length(ecg)-1)`. 这将创建一个数组，其`length(ecg)`元素从 0 开始，每 3600 个数据点有 10.0 个，长度为`ecg`.

为了比第一个图更好地对齐水平轴限制，您还可以使用`xlim([0, t(end)])`.

# screen - 使按钮上的文本全屏并检测按钮按下

> ID：14541350
> 
> 赞同：0
> 
> 时间：2013-01-26T20:39:04.220
> 
> 标签：screen, imagebutton

我在 Catch the CowsCode Bits 和 Bits of Thoughts on Coding for Android 中找到了 Scott Lund 编写的一些代码。请参阅： [http](http://catchthecows.com/?p=72) ://catchthecows.com/?p=72此代码创建一个按钮并放大文本以填充整个按钮大小。

我试图在没有运气的情况下检测新按钮类 BigTextButton 上的按钮按下

```
package com.sample;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Rect;
import android.text.TextPaint;
import android.util.AttributeSet;
import android.widget.ImageButton;

public class BigTextButton extends ImageButton {
    String mText = "";
    Paint mTextPaint;

    int mViewWidth;
    int mViewHeight;
    int mTextBaseline;

    public BigTextButton(Context context) {
        super(context);
        init();
    }

    public BigTextButton(Context context, AttributeSet attrs) {
        super(context, attrs);
        parseAttrs(attrs);
        init();
    }

    public BigTextButton(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        parseAttrs(attrs);
        init();
    }

    /**
     * Dig out Attributes to find text setting
     * 
     * This could be expanded to pull out settings for textColor, etc if desired
     * 
     * @param attrs
     */

    private void parseAttrs(AttributeSet attrs) {
        for (int i = 0; i < attrs.getAttributeCount(); i++) {
            String s = attrs.getAttributeName(i);
            if (s.equalsIgnoreCase("text")) {
                mText = attrs.getAttributeValue(i);
            }
        }
    }

    public void setText(CharSequence text) {
        mText = text.toString();
        onSizeChanged(getWidth(), getHeight(), getWidth(), getHeight());
    }

    /**
     * initialize Paint for text, it will be modified when the view size is set
     */
    private void init() {
        mTextPaint = new TextPaint();
        mTextPaint.setTextAlign(Paint.Align.CENTER);
        mTextPaint.setAntiAlias(true);
    }

    /**
     * set the scale of the text Paint objects so that the text will draw and
     * take up the full screen width
     */
    void adjustTextScale() {
        // do calculation with scale of 1.0 (no scale)
        mTextPaint.setTextScaleX(1.0f);
        Rect bounds = new Rect();
        // ask the paint for the bounding rect if it were to draw this
        // text.
        mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

        // determine the width
        int w = bounds.right - bounds.left;

        // calculate the baseline to use so that the
        // entire text is visible including the descenders
        int text_h = bounds.bottom - bounds.top;
        mTextBaseline = bounds.bottom + ((mViewHeight - text_h) / 2);

        // determine how much to scale the width to fit the view
        float xscale = ((float) (mViewWidth - getPaddingLeft() - getPaddingRight()))
                / w;

        // set the scale for the text paint
        mTextPaint.setTextScaleX(xscale);
    }

    /**
     * determine the proper text size to use to fill the full height
     */
    void adjustTextSize() {
        if (mText.isEmpty()) {
            return;
        }
        mTextPaint.setTextSize(100);
        mTextPaint.setTextScaleX(1.0f);
        Rect bounds = new Rect();
        // ask the paint for the bounding rect if it were to draw this
        // text
        mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

        // get the height that would have been produced
        int h = bounds.bottom - bounds.top;

        // make the text text up 70% of the height
        float target = (float) mViewHeight * .7f;

        // figure out what textSize setting would create that height
        // of text
        float size = ((target / h) * 100f);

        // and set it into the paint
        mTextPaint.setTextSize(size);
    }

    /**
     * When the view size is changed, recalculate the paint settings to have the
     * text on the fill the view area
     */
    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);

        // save view size
        mViewWidth = w;
        mViewHeight = h;

        // first determine font point size
        adjustTextSize();
        // then determine width scaling
        // this is done in two steps in case the
        // point size change affects the width boundary
        adjustTextScale();
    }

    @Override
    protected void onDraw(Canvas canvas) {
        // let the ImageButton paint background as normal
        super.onDraw(canvas);

        // draw the text
        // position is centered on width
        // and the baseline is calculated to be positioned from the
        // view bottom
        canvas.drawText(mText, mViewWidth / 2, mViewHeight - mTextBaseline,
                mTextPaint);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T17:37:53.430

我自己解决了，下面的代码检测到按下并打开编辑 screen2.xml

```
 // open the editor screen2.xml if you click the bigTextButton1 eg line 1 of screen
    BigTextButton progress = (BigTextButton) findViewById(R.id.bigTextButton1);        
    progress.setOnClickListener(new View.OnClickListener() 
    {
        public void onClick(View v) 
        {                

            // Do something when clicked
            // Starting a new Intent to switch screens
            Intent Config = new Intent(getApplicationContext(), Configuration.class);

            // starting new activity
            startActivity(Config);
        }
    }); 
```

# javascript - 数组未正确填充

> ID：14541356
> 
> 赞同：0
> 
> 时间：2013-01-26T20:39:42.987
> 
> 标签：javascript, node.js

我有这些 JavaScript 实体：Item 和 Items。

```
var exports = {};
exports.Item = function(item) {
    if (item) {
        for (var attr in this.attributes) {
            var value = item[attr];
            if (value !== undefined) {
                this.attributes[attr] = value;
            }
        }
    }
    return this;
};

exports.Item.prototype.attributes = {
    _id: "",
    title: ""
};

exports.Items = function(items) {
    if (items && items.length > 0) {
        for (var i = 0; i < items.length; i++) {
            this.add(items[i]);
        }
    }
};

exports.Items.prototype.arr = [];
exports.Items.prototype.add = function(item) {
    if (item) {
        item = new exports.Item(item);
        this.arr.push(item.attributes);
    }
};
exports.Items.prototype.toJSON = function() {
    var json = [];
    for (var i = 0; i < this.arr.length; i++) {
        json.push(this.arr[i]);
    }
    return json;
};

var i1 = new exports.Item({
    _id: "1",
    title: "1"
});

var i2 = new exports.Item({
    _id: "2",
    title: "2"
});

var i3 = new exports.Item({
    _id: "3",
    title: "3"
});

var items = new exports.Items([i1,i2,i3]);
console.log(items.toJSON()); 
```

有一个我找不到的问题。当我执行以下代码时，我得到最后一个项目 3 次而不是所有项目。
我确信这个错误是我看不到的小东西。也许你能帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:45:22.507

不应在原型中初始化成员变量。原型变量将在所有实例之间共享。相反，在构造函数中定义成员。所以，而不是这个：

```
exports.Items.prototype.arr = []; 
```

做这个：

```
exports.Items = function(items) {
    this.arr = []; // instance variable

    if (items && items.length > 0) {
        for (var i = 0; i < items.length; i++) {
            this.add(items[i]);
        }
    }
}; 
```

# android - LayoutTransition 不适用于添加视图 onActivityResult() 方法

> ID：14541363
> 
> 赞同：4
> 
> 时间：2013-01-26T20:40:22.830
> 
> 标签：android, android-animation

我想在添加新视图时实现向右移动视图的动画。

我正在使用 LayoutTransition.APPEARING 的 LayoutTransition 动画。我在线性布局的第 0 个位置添加新视图。

除了从 onActivityResult() 添加视图的一种情况外，它工作正常。

当我为结果启动 Activity 并尝试在 onActivityResult() 方法中添加视图时，会添加视图，但是 LayoutTransition 动画确实有效。

场景 1：活动 A 启动活动 B 以获得结果。Activity B setResult() 和 finish() 不做任何事情。在这种情况下，LayoutTransition 动画效果很好。

场景 2：活动 A 启动活动 B 以获得结果。活动 B 有按钮。单击按钮 Activity B setResult() 和 finish()。在这种情况下 LayoutTransition 动画不起作用。

需要输入我出错的地方或实现动画的任何解决方法。

活动一

```
private LinearLayout ll;
private Button b, addbutton, setResultButton;
private LayoutTransition transitioner;
private Animator defaultAppearingAnim;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.test);

ll = (LinearLayout) findViewById(R.id.ll);

    transitioner = new LayoutTransition();
    defaultAppearingAnim = transitioner
            .getAnimator(LayoutTransition.APPEARING);
    transitioner.setAnimator(LayoutTransition.APPEARING,
            defaultAppearingAnim);
    ll.setLayoutTransition(transitioner);

/*Adds Buttons to Linear Layout*/
    addbutton = (Button) findViewById(R.id.button1);
    addbutton.setOnClickListener(this);

/*Adds Buttons to Linear Layout on onActivityResult method*/
    setResultButton = (Button) findViewById(R.id.button2);
    setResultButton.setOnClickListener(this);

   /*Dummy Button Added here*/
    for (int i = 0; i < 2; i++) {
        Button b = new Button(this);
        b.setText("B " + i);
        ll.addView(b);
    }
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // Result from Activity B we are adding Button to LinearLayout
    super.onActivityResult(requestCode, resultCode, data);
    Button b = new Button(this);
    b.setText("RT");
    ll.addView(b, 0);
}

@Override
public void onClick(View v) {
    if (v == setResultButton) {
        Intent intent = new Intent(this, ResultActivity.class);
        startActivityForResult(intent, 0);
    } else if (v == addbutton) {
        Button b = new Button(this);
        b.setText("T");
        ll.addView(b, 0);
    }
} 
```

活动 B

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.result);

  /*   SCENARIO 1: LayoutTransition works if the activity setResult and finish
 setResult(0);  
 finish();  
   */

/* SCENARIO 2: Here the LayoutTransition animation doesnt work*/

    Button setResultButton = (Button) findViewById(R.id.button11);
    setResultButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            setResult(0);
            finish();
        }
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T07:52:56.633

得到它的工作

方案二的解决方案：

在这种情况下，我使用 post() 方法添加了视图

```
ll.post(new Runnable() {
  @Override
  public void run() {
    // TODO Auto-generated method stub
    Button b = new Button(ActivityA.this);
    b.setText("RT");
    ll.addView(b, 0);
 }
}); 
```

# c# - 我如何才能从目录字符串中获取最后的文件名？

> ID：14541366
> 
> 赞同：1
> 
> 时间：2013-01-26T20:40:49.473
> 
> 标签：c#

我有一个`List<string>`包含 5 个文件的文件，例如在 index[0] 我看到：

```
D:\New folder (45)\converted.avi_Automatic\Lightning 2 Length 4 [276 - 280]\000276.bmp 
```

该行是：

```
label22.Text = files[_indx].ToString(); 
```

我想改为在 label22 中查看： D:\New folder (45)\converted.avi_Automatic\Lightning 2 Length 4 [276 - 280]\000276.bmp 仅查看：000276.bmp

在文件是 _files 之前`List<FileInfo>`，我可以制作`_files[_indx].FullName`或`.Name`

但现在名单是`List<string>`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T20:44:06.307

您可以使用[Path.GetFileName](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)方法

```
label22.Text = Path.GetFileName(files[_indx]); 
```

# c# - 设计 c# - 想要以另一种方法显示

> ID：14541369
> 
> 赞同：0
> 
> 时间：2013-01-26T20:40:59.923
> 
> 标签：c#

```
public void ShowOther(String input)
{
    char [] holder = input.ToCharArray();

    for (int i = 0; i < holder.Length; i++)
    {
        if (other.Contains(holder[i]))
        {
            holder.SetValue('^', i);
        }
        if (goodChars.Contains(holder[i]))
        {
            holder.SetValue(' ', i);
        }
        Console.Write(holder.GetValue(i));
    }
} 
```

所以，现在我有这种方法。我想要做的是从这种方法中删除我的打印，同时保留`char[]`持有人的内容。

将返回类型更改为 a`char[]`然后将我的返回放在 for 循环之后工作吗？还是我偏离了轨道，可以做一些更简单的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:46:28.477

是的，那会奏效。

```
public void ShowOther(string input)
{
    Console.Write(GetOther(input));
}

public char[] GetOther(String input)
{
    char [] holder = input.ToCharArray();

    for (int i = 0; i < holder.Length; i++)
    {
        if (other.Contains(holder[i]))
        {
            holder.SetValue('^', i);
        }
        if (goodChars.Contains(holder[i]))
        {
            holder.SetValue(' ', i);
        }
    }

    return holder;
} 
```

我不确定你如何`GetOther`在不打印的情况下以有意义的方式使用，所以我不知道这种重构是否真的对你有用，但你可能比我更能判断这一点。

# iphone - 如何在 iphone 中退出和重新进入选项卡时保持滚动视图位置

> ID：14541373
> 
> 赞同：0
> 
> 时间：2013-01-26T20:41:23.237
> 
> 标签：iphone, ios, uiscrollview, tabbar

我有一个简单的 iPhone 标签栏应用程序，两者都有滚动视图。当我在两个选项卡之间切换时，滚动视图位置被重置回其顶部位置。如何在切换选项卡并返回时保持滚动视图位置，以使滚动视图处于我离开它的确切位置？

我用`viewDidAppear`and尝试了不同的东西`viewWillAppear`，但无济于事。似乎我错过了一些简单的东西。这显然并不复杂。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:43:19.017

您可以将状态保存在变量中，然后返回时可以使用该值进行初始化。

如果您希望即使在启动应用程序后也保持相同的状态，请将状态保存在 plist 中，userdefaults。

# jquery - 如何用jquery设置绝对顶级样式？

> ID：14541379
> 
> 赞同：0
> 
> 时间：2013-01-26T20:42:12.937
> 
> 标签：jquery

搜索后，我正在尝试这段代码，我很确定它应该可以工作：

```
$("#someLinkID").click(
    function () {
        var divToRender = "<div>" + "some message" + "</div>";
        $(divToRender).css({ top: 0, left: 0, position: 'absolute' });
        $(this).append(divToRender);
    }
); 
```

我错过了什么，这看起来很合乎逻辑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T20:48:50.470

我终于看到了错误（没有应用 CSS），以确保它*被*应用（虽然我不能说为什么它最初没有被应用）我建议：

```
$("#someLinkID").click(
    function () {
        $('<div />', {'text' : 'some message'})
        .css({top: 0, left: 0, position : 'absolute'})
        .appendTo($(this));
    }
); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/e5zJ2/3/)。

# c# - 通过 Ajax jquery 发送和接收 Xml 格式的数据

> ID：14541381
> 
> 赞同：0
> 
> 时间：2013-01-26T20:42:34.080
> 
> 标签：c#, .net, database

我不会使用 Ajax 以 XML 格式从 textarea 发送数据，并以 XML 格式接收数据。我也不知道如何在服务器端（PHP）捕获数据以及如何向客户端发送数据。

客户端代码：

'str' 是一个变量，其值来自 textarea

```
function sendValue(str){
// Fire off AJAX request.       
$.ajax(
    {
        // Define AJAX properties.
        url: "transliterate.php",
        type: "post",               
        data: { sendValue: str },
        dataType: "json",

        // Define the success method.
        success: function(data){
            data.returnValue = data.returnValue.replace(/\n/g,'<br/>');
            $('#result_box').html(data.returnValue);
            if(data.returnValue.length <= 50) {
                $('#result_box').addClass('short_text');
            }else{
                $('#result_box').removeClass('short_text');
            }
        },

        // Define the error method.
        error: function( objAJAXRequest, strError ){
            $( "#response" ).text(
                "Error! Type: " +
                strError
                );
        }
}); 
```

};

这是服务器端代码：

```
<?php 

//Get Post Variables. The name is the same as 
//what was in the object that was sent in the jQuery
if (isset($_POST['sendValue'])){
    $value = $_POST['sendValue'];   
}else{
    $value = "";
}

//Because we want to use json, we have to place things in an array and encode it for json.
//This will give us a nice javascript object on the front side.
echo json_encode(array("returnValue"=>$value));

?> 
```

当数据类型为 json 时，这对我有用，但是我如何使用 XML 做同样的事情呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:46:23.483

您可以在 AJAX 请求中指定响应为 XML：

```
dataType: "xml" 
```

然后传递给您的`success`回调的参数将代表您可以直接操作的此 XML 的 DOM。顺便说一句，在您的服务器上指定 HTTP Content-Type 响应标头被认为是一种很好的做法。因此，例如，如果您打算从脚本中重新运行 XML，请确保您设置了正确的标头：

```
header('Content-Type: text/xml'); 
```

在这种情况下，您甚至不需要`dataType`AJAX 请求的参数。jQuery 会自动从 Content-Type 响应头中推导出它，并相应地解析传递给`success`回调的结果。

# php - 我应该如何添加嵌入文档？

> ID：14541386
> 
> 赞同：0
> 
> 时间：2013-01-26T20:43:03.873
> 
> 标签：php, mongodb, symfony, doctrine

我的游戏文档得到了这个结构

游戏文档。

```
{ "_id" : ObjectId( "51043d468ead0e0757000006" ),
  "active" : true,
  "created" : 1359232326,
  "difficulty" : 0,
  "map" : { "$ref" : "Map",
    "$id" : ObjectId( "5103c0228ead0e3764000000" ),
    "$db" : "mydb" },
  "mode" : "coop",
  "players" : [ 
    { "$ref" : "User",
      "$id" : ObjectId( "50d83abf038054b560000000" ),
      "$db" : "mydb" } ],
  "title" : "testgame" } 
```

现在我想在这个游戏中添加另一个玩家，这就是我尝试过的

```
 $user = $this->get('doctrine_mongodb')
    ->getRepository('FantasytdUserBundle:User')
    ->findById($userId);

  $db->createQueryBuilder()
    ->update()
    ->field('id')->equals($gameId)
    ->field('players')->push($user)
    ->getQuery()
    ->execute(); 
```

还

```
$user = array_pop($user->toArray()); 
```

没有运气，我得到的只是

“不允许使用零长度的键，您是否使用了带双引号的 $？”

在我的原则文档中，Players 被定义为对 User 的引用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:48:38.930

AFAIK 学说 2 无法推送文件。你应该准备数组：尝试这样的事情：

```
$user = $this->get('doctrine_mongodb')
  ->getRepository('FantasytdUserBundle:User')
  ->findById($userId);

$user_data = array("$ref" => "User",
  "$id" : $user->getId(), // Or new \MongoId($userId)
  "$db" : "mydb");

$db->createQueryBuilder()
  ->update()
  ->field('id')->equals($gameId)
  ->field('players')->push($user_data)
  ->getQuery()
  ->execute(); 
```

# php - PHP OOP 从数据库中检索数据，初始化并回显它

> ID：14541393
> 
> 赞同：-2
> 
> 时间：2013-01-26T20:43:25.073
> 
> 标签：php, oop, initialization, echo, data-retrieval

大家好，我需要您就以下编码方式是否可以接受以及在 3 件事方面更好的编码方式（检索数据、初始化变量和回显它）提出建议。

```
class Product {

private $product_name = array();
private $num_rows;

public function __construct() {
    include 'connect.php';
    $query = "SELECT * FROM product where product_status= 'open' ";
    $result = mysql_query($query);
    $this->num_rows = mysql_num_rows($result);
    while ($record = mysql_fetch_array($result)) {

        $this->product_name[] = $record['product_name'];
    }
}

public function get_rows() {
    return $this->num_rows;
}

public function get_name($count) {
    return $this->product_name[$count];
} 
```

}

```
$product = new Product();
$rows = $product->get_rows();

for ($i = 0; $i < $rows; $i++) {

    echo $product->get_name($i);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:50:15.350

您唯一需要担心的是数据库处理。尝试 PDO 而不是 mysql_* 函数。按照本[教程](https://stackoverflow.com/questions/1943069/are-there-good-tutorials-on-how-to-use-pdo)。就这样。除此之外，其他一切对我来说似乎都很好。

每次创建`$product = new Product();`数据库查询时都会运行最后一件事。我的问题是强制性的吗？你能把它放在一个单独的函数中吗？这样当您需要它时，您可以调用它并获取数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:33:42.880

我不太喜欢你的班级命名。你称它为 Product 但它实际上是 ProductCollection 或类似的。事实上，如果您愿意，它会与特定类型的 ProductCollection、OpenProductCollection 或 OpenProducts 相关联。

如果您想要 ClosedProducts 或数据库中可能已在 product_status 中设置的其他状态怎么办？

```
$pc = new ProductsCollection('open'); 
```

当您只需要时使用“SELECT * FROM product ...”`name`似乎也很浪费，或者如果每个产品有 100 个字段......我们不知道您有多少个字段。

所以你可能想做相当于：

```
$pc = new ProductsCollection;
$pc->set_fields(array('id', 'name'));
$pc->get_status_open();  // return your array 
```

您可以考虑使用魔术 __get 和 __set 作为解决此问题的另一种方法，否则您可以使用 get_name、get_price、get_manufacturer 等将您的类与您的表紧密联系起来。

关于 mysql_* 函数的备注，如果您移至 mysqli 或 PDO，您还可以选择 OBJECT，因此您的结果集可以是预填充的 Product 对象数组。（即您编写的代表单个产品的产品类）。

高温高压

# python - 在多个 Python 进程之间共享字典的最佳方法是什么？

> ID：14541394
> 
> 赞同：1
> 
> 时间：2013-01-26T20:43:37.757
> 
> 标签：python, concurrency, multiprocessing, data-sharing

所有进程都会读取和写入这个字典。我希望对共享字典的操作尽可能快（大约在 50 微秒以下）。

使用 multiprocessing.Manager 共享字典对我来说不够快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:03:39.980

50μs 相当宽松。

您可以将字典键视为在 memcached 数据存储中吗？

这个 2009 年的基准测试比较显示 python-memcache 足够快 - [http://amix.dk/blog/post/19471](http://amix.dk/blog/post/19471)

还有 dogpile.cache - [http://pypi.python.org/pypi/dogpile.cache](http://pypi.python.org/pypi/dogpile.cache) - 可以用 memcached 支持。

不确定从字符串转换为 python 对象的速度会是多少。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-26T20:47:34.080

只是使用我认为通常的互斥锁和锁，不是吗？“线程”库中的 lock.acquire()、lock.release() API 应该有所帮助，[http ://docs.python.org/3.3/library/threading.html](http://docs.python.org/3.3/library/threading.html)

但我不认为你会赢得更快的速度，因为你的设计似乎受到 Python 全局解释器锁 (GIL) 的限制，这可能是这里的障碍。

我可能错了-

# javascript - 使用history.state 来保存scrollTop？

> ID：14541398
> 
> 赞同：0
> 
> 时间：2013-01-26T20:44:10.893
> 
> 标签：javascript, browser-history

我过度设计的网络应用程序：

*   使用`history.pushState`和`popState`事件，以动画化 URL 之间的移动，而不必在`#`URL 中使用 a。
*   使用外部 div 来处理滚动条，并且 html 和 body 具有`overflow:hidden`. 这样当用户单击返回时，它不会在向左设置动画之前跳转到顶部。

现在我的问题是，如果用户再次单击前进按钮，我怎样才能保留他们滚动的位置/将它们向下滚动到原来的位置。

*   我的第一个想法是使用`history.state`对象作为保存滚动位置的地方，然后在用户单击前进时将其加载。（我必须`replaceState`在没有`history.state`对象的第一页上。）这个想法的问题是，一旦用户点击返回，我就无法再将 scrollTop 添加到当前状态。

*   我的下一个想法是使用一个单独的数组，所以我通过索引拉出滚动位置，但问题是如果用户关闭选项卡然后重新打开它，或者如果他们导航到另一个站点并返回稍后我的，他们的前后历史被保存，但我单独的`scrollTop`s 数组会丢失。

你的建议是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:04:03.757

[Jörn Zaefferer](https://github.com/jzaefferer)为这个问题写了一个方法：[https ://github.com/jzaefferer/pitfalls-examples/blob/master/app/gallery/gallery.js#L29-37](https://github.com/jzaefferer/pitfalls-examples/blob/master/app/gallery/gallery.js#L29-37)

（如果您的母语是德语，请查看他的演讲：[http](http://www.youtube.com/watch?v=RGdbfKgPKI8) ://www.youtube.com/watch?v=RGdbfKgPKI8 ）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-19T19:56:14.880

如前所述，可以使用历史 API 的状态对象来跟踪页面的当前状态（例如滚动位置或表单字段条目）。

当然，在某些时候，必须将页面状态存储到历史状态对象中。然而，当浏览器触发了一个 popstate 事件时，已经为时已晚，因为之前的历史状态已经被弹出的状态所取代。

因此，必须在 popstate 事件之前存储页面状态。然而，由于没有 beforepopstate 事件，唯一可能的方法是不断地监听页面状态的变化（例如滚动或输入事件）并不断地用 replaceState 更新当前的历史状态对象。

然而，在基于 Chromium 的浏览器中，每次调用 replaceState 都会向用户简要显示加载指示器。如果您不想这样做，只需在 popstate 事件后调用一次 replaceState 即可。在这个调用中，在历史状态对象中存储一个唯一的 id。使用这个唯一的 id 作为键来在浏览器的会话存储中存储更多的状态。（您必须为缓存建模，因为条目可能会变成状态。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T21:33:07.067

使用 pushState 您可以将数据添加到历史状态，如下所示：

```
var stateObj = { scrollTop: "500px" };
history.pushState(stateObj, "page 2", "page.html"); 
```

当 window.onpopstate 的事件被触发时，它会返回 stateObj (event.state)，并且有你的 scrollTop 位置。

有一个很好的插件来控制 Windows 历史记录：

jQuery 动态 URL：[https ://github.com/promatik/jQuery-Dynamic-URL](https://github.com/promatik/jQuery-Dynamic-URL)

看这个例子： http: [//promatik.no.sapo.pt/github/dynamic-url/](http://promatik.no.sapo.pt/github/dynamic-url/)

# android - 在 Android 中使用闹钟启动设备

> ID：14541399
> 
> 赞同：0
> 
> 时间：2013-01-26T20:44:14.887
> 
> 标签：android, alarmmanager, android-alarms

如果发生警报，​​是否有任何方法可以“打开”设备？当您设置闹钟时，这在旧诺基亚手机中可用，如果设备关闭，设备会在闹钟时间继续，然后再次关闭。我们可以在 Android 中使用它吗？. 我不是在谈论在睡眠时唤醒设备，如果他关闭并且有电池电量，我需要打开它。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:24:50.577

这对于 android 是不可能的，因为一旦您的设备关闭，操作系统就不会运行，直到手动打开设备。

但是，通过 root 访问，您可以安排系统关闭并发出警报，但您需要一个 root 设备，这可能会使您的保修失效。

# c++ - 如何在 C++ 中使用 windows.h 头文件？

> ID：14541401
> 
> 赞同：1
> 
> 时间：2013-01-26T20:44:30.847
> 
> 标签：c++, header

我需要有关在 C++ 中使用 windows.h 头文件的帮助。我看到人们在他们的程序中使用 windows.h 来（显然）与 windows 交互，但我不知道如何使用它。具体来说，有没有网站列出并描述了windows.h头文件中的方法和功能。我尝试打开 windows.g 头文件并查看自己的方法，但我只看到一堆其他 #include 并且不知道下一步该做什么。我是 C++ 新手，所以如果我的问题不是一个好问题，我深表歉意！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T20:47:15.113

嗯，有[http://msdn.microsoft.com/en-US/](http://msdn.microsoft.com/en-US/)上的 Microsoft 开发人员网络，它有参考，我认为，初学者教程，但你可能会更好的书。Charles Petzold 的“Programming Windows”曾经使用 C++（尽管我相信最近的版本使用 C#）

# grid - 简单的网格绘制不起作用

> ID：14541402
> 
> 赞同：0
> 
> 时间：2013-01-26T20:44:36.907
> 
> 标签：grid, draw

我正在尝试在画布上绘制一个简单的网格。首先我做了这个

```
function start()
{   
   var x = 0;
   var y = 0;

    for (x = 0; x < 500; x += 50)
    {
        line(0 + x, 50 + y, 50 + x, 50 + y, 1, "#111");
        line(50 + x, 0 + y, 50 + x, 50 + y, 1, "#111");

        if (x == 450)
        {
            x = -50;
            y += 50;
        }
        if (y == 500)
        {
            x = 500;
        }
    }
} 
```

它工作正常。但我希望能够轻松更改网格和画布的大小。所以我这样做了：

```
function start()
{   
    var x = 0;
    var y = 0;
    var cW = canvas.width;
    var cH = canvas.hight;
    var gS = 50; //gS = gridSpace

    for (x = 0; x < cW; x += gS)
    {
        line(0 + x, gS + y, gS + x, gS + y, 1, "#111");
        line(gS + x, 0 + y, gS + x, gS + y, 1, "#111");

        if (x == cW - gS)
        {
            x = -gS;
            y += gS;
        }
        if (y == cH)
        {
            x = cW;
        }
    }
} 
```

这没用！请帮我。

PS。我正在使用图书馆。`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:19:57.353

您可能希望以不同的方式处理此问题。我不完全确定您要在这里完成什么，但这里有一些指针/问题可以指导您完成您正在尝试做的事情：

*   绘制网格时，您正在绘制一系列水平线和一系列垂直线。使用两个循环来简化该过程。
*   对于水平线，y 值会有所不同，但线端点的 x 坐标保持不变（例如 0 和 cW）。反之亦然适用于垂直线。
*   你真正想要达到什么样的间距？通常，您正在查看将空间划分为一定数量的区域（例如 6 行和 4 列），或者不适应您正在绘制的特定画布的间距（这就是您的代码似乎正在尝试做）。因此，第一个将适应画布的大小，而后者将随着画布大小的变化而显示更多/更少的行/列。

我希望能帮助您解决问题，如果您需要更多帮助，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:47:15.517

一种可能是您`height`拼写错误。我相信 javascript，如果这是 javascript，不会抱怨错误命名的变量。（我可能错了）。

```
var cH = canvas.hight; 
```

应该

```
var cH = canvas.height; 
```

# android - Android net.sip：manager.makeAudioCall(..) 引发 sip 会话错误

> ID：14541404
> 
> 赞同：8
> 
> 时间：2013-01-26T20:44:52.600
> 
> 标签：android, sip

我正在尝试在 Android 上使用 sip 建立呼叫。我的清单中的权限是：

```
<uses-permission android:name="android.permission.CALL_PHONE"/>
<uses-permission android:name="android.permission.USE_SIP"/>
<uses-permission android:name="android.permission.INTERNET"/> 
```

CALL_PHONE 权限在那里，因为我的应用程序也呼叫常规号码。
这是活动代码：

```
package x.x.x;

import java.text.ParseException;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.Intent;
import android.net.sip.SipAudioCall;
import android.net.sip.SipException;
import android.net.sip.SipManager;
import android.net.sip.SipProfile;
import android.os.Bundle;
import android.util.Log;

public class CallScreen extends Activity{
public SipManager manager = null;
public SipProfile me = null;
public SipAudioCall call = null;
//IncomingCallReceiver callReceiver;
String domain = "myserver.net";
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.callscreen);

    initManager();
    Log.d("Z:","Done initManger()");
    Thread waiter = new Thread(){
        @Override
        public void run() {
            // TODO Auto-generated method stub
            try {
                sleep(10000);
                Log.d("Z:","Done waiting");
                initCall();
                Log.d("Z:","Done initCall");
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    };
    waiter.start();

    //initCall();

}
public void initManager()
{
    manager = SipManager.newInstance(this);
    initLocalProfile();
}
public void initLocalProfile()
{
    String username = "user";
    String password = "12345";
    String domain = "myserver.net";
    try {
        SipProfile.Builder builder = new SipProfile.Builder(username,domain);
        builder.setPassword(password);
        me = builder.build();
        //Intent intent = new Intent(); 
        //PendingIntent pi = PendingIntent.getBroadcast(this, 0, intent, Intent.FILL_IN_DATA);
        //manager.open(me,pi,null);
        manager.open(me);
    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SipException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}
public void initCall()
{
    SipAudioCall.Listener listener = new SipAudioCall.Listener(){
        @Override
        public void onCallEstablished(SipAudioCall call) {
            // TODO Auto-generated method stub
            //super.onCallEstablished(call);
            call.startAudio();
            call.setSpeakerMode(true);
            call.toggleMute();
        }
        @Override
        public void onCallEnded(SipAudioCall call) {
            // TODO Auto-generated method stub
            super.onCallEnded(call);
        }
    };
    try {
        call = manager.makeAudioCall(me.getUriString(), "12345678910", listener, 30);
    } catch (SipException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

} 
```

logcat 上显示的错误：

```
01-26 22:20:25.710: D/SipAudioCall(31060): sip session error: CLIENT_ERROR: libcore.io.ErrnoException: getaddrinfo failed: ENOENT (No such file or directory) 
```

我试图让这个小例子工作，然后我组织这个代码有点不同（例如，用户名和密码不是硬编码的）。我对sip也不是很熟悉。真的appriciate任何建议。
有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-10T14:04:29.563

问题出在以下行：

```
call = manager.makeAudioCall(me.getUriString(), "12345678910", listener, 30); 
```

`makeAudioCall`方法的第二个参数[必须是](http://developer.android.com/reference/android/net/sip/SipManager.html#makeAudioCall%28java.lang.String,%20java.lang.String,%20android.net.sip.SipAudioCall.Listener,%20int%29) `the URI of the SIP profile to make the call to`，但您只提供了它的用户名（即：“12345678910”）。将其更改为：

```
call = manager.makeAudioCall(me.getUriString(), "sip:12345678910@myserver.net", listener, 30); 
```

# gerrit - 无法连接到 Gerrit SSHD

> ID：14541408
> 
> 赞同：0
> 
> 时间：2013-01-26T20:45:21.887
> 
> 标签：gerrit

我正在尝试设置`gerrit`，但我想我缺少一些配置，因为我无法连接到`gerrit sshd`。 [本指南](http://gerrit-documentation.googlecode.com/svn/Documentation/2.5.1/install-quick.html)是我想要遵循的。网络界面正在打开，我可以注册。但是，当我尝试时，`ssh user@my.example.net -p 29418`我得到了一个`Connection refused`. 我已经验证 gerrit 确实在运行。

Gerrit 落后了`nginx`，这些是我到目前为止的配置：
Nginx 配置：

```
server {
server_name my.example.net;

 location / {
    proxy_pass  http://127.0.0.1:8090;
    proxy_set_header  X-Forwarded-For $remote_addr;
    include conf/proxy.conf;
    auth_basic "Admin";
    include conf/auth.conf;
 }
} 
```

gerrit.config 的一部分：

```
[auth]
    type = HTTP
[sshd]
    listenAddress = 127.0.0.1:29418
[httpd]
    listenUrl = proxy-http://127.0.0.1:8090/ 
```

确实允许防火墙接受端口上的连接`29418`

```
# iptables -L -n | grep 29418
  ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:29418 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T13:41:04.253

Nginx 对 Gerrit 的 SSHd 没有影响，你不能（AFAIK）通过它代理它们。

您已将 Gerrit 配置为侦听 localhost ( `sshd.listenAddress = 127.0.0.1:29418`)，因此您无法从远程连接。只需删除该行，默认情况下它会监听所有接口，我想这就是你想要的。

您可以通过`netstat -ntlp | grep 29418`. 它必须显示`0.0.0.0:29418`为监听地址，而不是`127.0.0.1:29418`.

# javascript - Javascript警报报告两个不同的窗口高度

> ID：14541411
> 
> 赞同：0
> 
> 时间：2013-01-26T20:45:39.957
> 
> 标签：javascript, jquery

这是我试图解决的一件非常奇怪的事情。

目前，我正在页面末尾加载所有这些内容，当我第一次加载页面时，它会发出警报 571，刷新时会发出警报 627。而如果我将所有这些都移到`<head>`标签上，它每次都会发出警报 627，这是正确的价值。

谁能明白为什么在页面末尾加载它会导致错误的较小窗口高度？

```
 <script src="js/jquery.min.js"></script>

<script> 
$(document).ready(function() {

var Height = $(window).height()-40;
$("#section1").css('min-height',Height);
$("#section2").css('min-height',Height);
alert(Height);

});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:30:36.413

说真的，我不知道为什么会这样。要找出答案，我肯定需要整个页面的代码或一个工作实例。

但在你的情况下，我只会使用`$(window).load`而不是准备好。

```
<script> 
$(window).load(function() {

var Height = $(window).height()-40;
$("#section1").css('min-height',Height);
$("#section2").css('min-height',Height);
alert(Height);

});
</script> 
```

# perl - 用于规模测试的 Perl SNMP 陷阱生成器？

> ID：14541414
> 
> 赞同：0
> 
> 时间：2013-01-26T20:46:11.330
> 
> 标签：perl, snmp

我已经一起破解了下面的脚本，让我生成到测试服务器的陷阱。我真正需要的是能够大规模生成陷阱的东西，以便我可以在接收端检查我的工具以找出瓶颈所在，例如 UDP、Net::SNMP、Perl 等。

我曾希望这个脚本能让我每秒生成 10k 个事件，但我很遗憾错了。

有谁知道我是否可以在 Perl 中做到这一点，或者有另一种方法的建议？

```
#! /usr/bin/perl

use strict;
use warnings;
use Log::Fast;
use FindBin;
use Getopt::Long;
use File::Basename;
use Cwd qw(abs_path);
my $ROOT_DIR = abs_path("$FindBin::Bin/..");
use POSIX qw/strftime/;
use Net::SNMP qw(:ALL); 
use Time::HiRes qw( time sleep );

#FIXME - I had to add below for Perl 5.10 users.
# on Perl 5.10, I would get the following when running:
# perl -e"autoflush STDOUT, 1;"
# Can't locate object method "autoflush" via package "IO::Handle" at -e line 1.
use FileHandle;

# Create default logger, will reconfigure it as soon as we read configuration from database
my $log = Log::Fast->global();

my $myname = $0;
$myname =~ s{.*/}{};    # leave just program name without path

# Command line options
my $options = {
    debug    => 0,
    verbose  => 0,
    logfile => "./$myname.log",    
    help        => 0,
    community        => "public",
    trapsource        => "127.0.0.1",
    timelimit        => 1,
};

sub usage_and_exit {
    my ($exit_code) = @_;
    print STDERR qq{
    This program is used to generate SNMP traps to a specified host at a specified rate
    Usage: $myname [-o --option] 
    -h        : this (help) message
    -d        : debug level (0-5) (0 = disabled [default])
    -v        : Also print results to STDERR
    -l        : log file (defaults to local dir
    -r        : Rate (events/sec)
    -ts       : host to generate messages FROM
    -td       : host to generate messages TO
    -tl       : Run for this many seconds (default 1)
    -c        : community
    Example: $myname  -td 192.168.28.29 -r 1 -tl 5 -v
    };
    exit($exit_code);
}

GetOptions(
    'debug|d=i'       => \$options->{debug},
    'help|h!'         => \$options->{help},
    'verbose|v!'      => \$options->{verbose},
    'logfile|l=s'    => \$options->{logfile},
    'rate|r=i' => \$options->{rate},
    'trapsource|ts=s'     => \$options->{trapsource},
    'trapdest|td=s'     => \$options->{trapdest},
    'community|c=s'     => \$options->{community},
    'timelimit|tl=i' => \$options->{timelimit},
) or usage_and_exit(1);    # got some invalid options

if ( $options->{help} ) {
    usage_and_exit(0);
}

# Reconfigure log to use logfile (as we finally got it from $settings), also
# set proper level and output based on $options{verbose} and $options{debug}
setup_log();

# Finally we are initialized, announce this to the world :-)
$log->INFO("Program initialized successfully");

my $date = strftime "%Y-%m-%d %H:%M:%S", localtime;

# start func
my $period = 1 / $options->{rate};
my $start = time();
my $limit = time() + $options->{timelimit};
my $total = $options->{rate} * $options->{timelimit};
$log->INFO("Generating $options->{rate} trap(s) every second for $options->{timelimit} seconds (1 every $period seconds, $total total events)");
while($start < $limit) {
    my $elapsed = time() - $start;
    if ($elapsed < $period) { 
        sleep($period - $elapsed);
        my ($session, $error) = Net::SNMP->session(
            -hostname  => $options->{trapdest},
            -community => $options->{community},
            -port      => SNMP_TRAP_PORT,      # Need to use port 162
            -version   => 'snmpv2c'
        );
        if (!defined($session)) {
            $log->INFO("ERROR: %s.", $error);
            exit 1;
        }
        my $result = $session->snmpv2_trap(
            -varbindlist => [
            '1.3.6.1.2.1.1.3.0', TIMETICKS, 600,
            '1.3.6.1.6.3.1.1.4.1.0', OBJECT_IDENTIFIER, '1.3.6.1.4.1.326',
            '1.3.6.1.6.3.18.1.3.0', IPADDRESS, $options->{trapsource}
            ]
        );
        if (!defined($result)) {
            $log->INFO("ERROR: %s.", $session->error());
        } else {
            $log->INFO("SNMPv2-Trap-PDU sent from $options->{trapsource} to $options->{trapdest}.");
        }
    } else {
        $start = time();
    }
}

#-------------------------------------------
# There should only be subs from here down
#-------------------------------------------

# =================================================================================================
# Helper functions
# =================================================================================================

# commify not used yet
sub commify {
    my $text = reverse $_[0];
    $text =~ s/(\d\d\d)(?=\d)(?!\d*\.)/$1,/g;
    return scalar reverse $text;
}

sub setup_log {
    my $log_dir = dirname($options->{logfile});

    # Create log dir, and build log path if not provided by command line option
    if ( !-d $log_dir ) {
        mkdir( $log_dir, 0755 ) or die("mkdir $log_dir: $!");
    }
    if ( !$options->{logfile} ) {
        $options->{logfile} = $log_dir . "/" . basename( $0, '.pl' ) . '.log';
    }

    my $log_options = {};

    # Set up output to file or both file and stderr
    if ( $options->{verbose} ) {

        # make multiplexer FH sending data both to file and STDERR
        open( my $fh, '>>:tee', $options->{logfile}, \*STDERR )
            or die("$options->{logfile}: $!");
        $fh->autoflush(1);
        $log_options->{fh} = $fh;
    }
    else {
        open( my $fh, '>>', $options->{logfile} ) or die("$options->{logfile}: $!");
        $log_options->{fh} = $fh;
    }

    # Setup extra information to put in every log line, depending on debug level
    if ( $options->{debug} > 1 ) {
        $log_options->{prefix} = "%D %T %S [%L] ";
    }
    else {
        $log_options->{prefix} = "%D %T [%L] ";
    }

    $log_options->{level} = $options->{debug} > 0 ? 'DEBUG' : 'INFO';

    $log->config($log_options);

    $SIG{__WARN__} = sub {
        my $msg = shift;
        $msg =~ s/\n//;
        $log->WARN($msg);
    };

    $log->INFO("Starting logging to $options->{logfile} with pid $$");
}

sub DEBUG {
    my ( $level, @log_args ) = @_;
    if ( $options->{debug} >= $level ) {
        $log->DEBUG(@log_args);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T02:58:09.880

也许使用类似[Parallel::ForkManager 的](http://search.cpan.org/~szabgab/Parallel-ForkManager-1.02/lib/Parallel/ForkManager.pm)东西？此外，关于测试 SNMP 收集器的可扩展性，您可能会对从多个主机接收陷阱的用例感兴趣，而不仅仅是单个主机以高速率发送陷阱。为此，您可能想看看使用 pssh。

一个问题可能是纯 perl 中的 Net::SNMP 速度慢 - 也许通过 shell 执行 snmptest 或 snmptrap 可能更快？值得一试。

# jquery - 调整屏幕/窗口大小时使用 jquery 删除 html div 内容

> ID：14541425
> 
> 赞同：0
> 
> 时间：2013-01-26T20:47:31.070
> 
> 标签：jquery, html

`{menu}`使用 jQuery ，当浏览器或窗口调整为较小的屏幕尺寸以进行响应式网页设计时，我需要删除此 html 代码和其中的标签。

```
<div id="menu">{menu}</div> 
```

我是 jQuery 新手，因此我们将不胜感激任何帮助或建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:53:08.003

您不一定需要使用 jQuery，只需在样式表中添加媒体查询：

```
@media screen and (max-width:480px)
{
    #menu { display: none; }
} 
```

这样，如果屏幕发生变化（例如变成横向，或者浏览器可能被调整大小），菜单将再次出现。

# arduino - Arduino：想做只打印一次的东西

> ID：14541428
> 
> 赞同：0
> 
> 时间：2013-01-26T20:47:42.410
> 
> 标签：arduino

我正在为 ardunio 编写一个脚本，以便它可以打印出某物有多远，并且我正在尝试使它等于默认长度（当脚本首次启动时）它不起作用，如果两个数字之间的距离大于 3 英寸重新打印。不知道为什么它不起作用。起初我试图让它不打印，如果它与上次打印的长度相同，那么如果有人能弄清楚这一点，那就太棒了。另外，对不起，如果我听起来很紧张，我已经在这个可能超级简单的脚本上工作了至少 3 个小时。

```
#include <Ping.h>
Ping ping = Ping(13,0,0);
int defaultlength = 0;
int length = 0;
int afterlength = 0;
void setup(){
  Serial.begin(9600);
  ping.fire();
  defaultlength = ping.inches();
}

void loop(){
  ping.fire();
  length = ping.inches();
  delay(100);
  afterlength = length - defaultlength;
  sqrt(afterlength^2);
  if (afterlength >= 3) {
    Serial.print(afterlength);
    ping.fire();
    Serial.print("Inches: ");
    Serial.print(ping.inches());
    Serial.print(" | Centimeters: ");
    Serial.print(ping.centimeters());
    Serial.print(" | Light: ");
    if (analogRead(A0) >= 1000) {
      Serial.print("ON");
      Serial.println();
    }
    else {
      Serial.print("OFF");
      Serial.println();
    }

  }

  delay(1000);

} 
```

此外，它根本没有打印任何东西。我不确定它是否没有通过循环或什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:52:38.360

你的线`sqrt(afterlength^2);`没有做任何有用的事情。你的意思是通过写来取绝对值吗

```
afterlength = sqrt(afterlength*afterlength); 
```

^ 运算符是[按位异或](http://arduino.cc/en/Reference/BitwiseAnd)- 根本不是您想要做的。

这会让它变得更好吗？

至于你的另一个问题：“起初我试图让它不会打印，如果它与最后打印的长度相同，那么如果有人能弄清楚这一点，那就太棒了。” - 这是你可以做的：

1) 在脚本的头部定义另一个变量 - 调用它`lastlength`并将其初始化为 defaultlength (在你第一次 ping 之后`setup()`)

2）在循环中，将if语句更改为

```
if ((afterlength >= 3) && (abs(length - lastlength) > 0.1)) { 
```

3) 最后，在 if{} 语句的末尾，添加：

```
lastlength = length; 
```

将其放入`if{}`块中的原因是确保仅在事情发生充分变化时才对其进行更新 - 否则，您将保持相同的“不要再告诉我，直到它与您之前告诉我的数字不同”的价值。当然，该`> 0.1`值可以替换为您想要的任何容差。还要注意 abs() 的使用——比平方的平方根更紧凑一点。

# ios - 为什么在添加 facebook sdk iOS 时取消选择“复制到项目的文件夹”。框架

> ID：14541429
> 
> 赞同：1
> 
> 时间：2013-01-26T20:47:46.103
> 
> 标签：ios, facebook

我正在尝试将 facebook sdk for ios 集成到我的应用程序中，我正在关注本教程：

[教程](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/) [教程_2](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)

将框架添加到我的项目时，它说取消选择“复制到项目文件”，这是我在添加文件时总是选择的。

为什么要这样做？如果我在 App Store 中导出和发布我的应用程序时取消选择它，它会播放吗？如果我选择它有什么缺点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T20:54:53.937

“复制到项目文件”只是意味着它将您所有的 Facebook 类复制到您的项目文件夹并参考该类文件是否来自您的项目复制文件。如果您取消选中该选项，则引用将来自您拖动该文件的位置。

因此，在将应用程序导出和发布到 Apple App Store 时，这根本不会影响。

实际上，您不应该像 Facebook 所说的那样选择此选项，因为它会创建 Facebook 类的多个副本，这不是必需的。

希望这些信息对你有帮助..

# json - Coldfusion - 在 SerializeJSon 之前修改输出？

> ID：14541431
> 
> 赞同：1
> 
> 时间：2013-01-26T20:47:53.450
> 
> 标签：json, coldfusion

首先，为问题中的措辞道歉 - 我想不出更好的，抱歉！

这是场景 - 我正在使用一个我几乎无法控制的 JS 前端，以及一个我可以控制的 Coldfusion 后端。

一切工作正常，只有一个小例外——我希望这很容易解决！数据库当前仅存储图像的文件名，但是前端需要完整的 url。因此，我需要在 SerializeJson 之前以某种方式附加域（始终相同）。到目前为止，我已经尝试了一些没有成功的事情，并且找不到任何语法示例。

我现有的代码如下；

```
<cfquery name="qryNames">
    SELECT ID, imgthumb, imgfull 
    FROM   images 
    ORDER BY ID DESC
</cfquery>

<cfset data = [] />

<cfoutput query="qryNames">
    <cfset obj = {
                   "thumb" = ImgThumb,
                   "image" = Imgfull
                 } />
    <cfset arrayAppend(data, obj) />
</cfoutput>

<cfprocessingdirective suppresswhitespace="Yes">
<cfoutput>
    #serializeJSON(data)#
</cfoutput>
</cfprocessingdirective>

<cfsetting enablecfoutputonly="No" showdebugoutput="No"> 
```

为了清楚起见，这就是我正在寻找的...

```
<cfset obj = {
                "thumb" = http://mydomain/ImgThumb,
                "image" = http://mydomain/Imgfull
    } /> 
```

非常感谢指点！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T20:58:25.643

您可以将内容附加到如下变量：

```
<cfset newThumb = "http://mydomain/"&ImgThumb>
<cfset newImage = "http://mydomain/"&Imgfull> 
```

希望这对你有用。

# c# - XNA 窗口边框将全屏主题更改为窗口转换

> ID：14541433
> 
> 赞同：1
> 
> 时间：2013-01-26T20:48:10.070
> 
> 标签：c#, xna

当我在 XNA 中从全屏模式切换到窗口模式时，窗口不使用默认的 windows 主题，而是使用旧的“非航空”风格。我使用的是 Windows 8，不知道不同主题的新术语。

我尝试了这个解决方案：[XNA lost title bar theme on fullscreen->windowed transition](https://stackoverflow.com/questions/6885363/xna-losing-title-bar-theme-on-fullscreen-windowed-transition)，但它似乎不起作用，至少在 Windows 8 上不起作用。

如何确保始终使用默认主题？不必是 XNA 特定的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:11:44.797

用这个：

> System.Windows.Forms.Application.VisualStyleState = System.Windows.Forms.VisualStyles.VisualStyleState.ClientAndNonClientAreasEnabled;

# c++ - g++ 选择性地忽略成员声明

> ID：14541438
> 
> 赞同：1
> 
> 时间：2013-01-26T20:48:44.030
> 
> 标签：c++, g++

g++ 似乎选择性地忽略了在类 Player 中声明的成员变量。它似乎也相信我的成员函数之一（void Player::update()）被声明为虚拟的。我正在使用的库 (libtcod.hpp) 中声明的常量也没有通过，尽管在我所有其他类中都可以正常工作。这里有什么问题？

以下是 Player.cpp 附带的头文件：

```
#include "Map.h"
#include "Graphic.h"
#include "Dood.h"
#include "Villager.h"
#include "libtcod.hpp"

class Player: public Dood{
protected:
Graphic* rageGraphic;
TCODPath* myPath;
bool controlled;
void init(Graphic* _rage);
bool up, down, left, right;
static Player* myGuy;

public:
static Player* get();
Player(Graphic* _p);
Player(Graphic* _p, Graphic* _rage);
~Player();

void update();
void draw();
TCODPath* los(int x, int y);
}; 
```

这是我的错误代码：

```
Player.cpp:4: error: 'Player* Player::myGuy' is not a static member of 'class Player'
Player.cpp: In member function 'virtual void Player::update()':
Player.cpp:8: error: 'TCODConsole' has not been declared
Player.cpp:8: error: 'TCODK_UP' was not declared in this scope
Player.cpp:12: error: 'TCODConsole' has not been declared
Player.cpp:12: error: 'TCODK_DOWN' was not declared in this scope
Player.cpp:16: error: 'TCODConsole' has not been declared
Player.cpp:16: error: 'TCODK_LEFT' was not declared in this scope
Player.cpp:20: error: 'TCODConsole' has not been declared
Player.cpp:20: error: 'TCODK_RIGHT' was not declared in this scope
Player.cpp:30: error: 'myPath' was not declared in this scope
Player.cpp:69: error: 'class Map' has no member named 'getRealMap'
Player.cpp: In member function 'void Player::init(Graphic*)':
Player.cpp:103: error: 'myPath' was not declared in this scope
Player.cpp:103: error: expected type-specifier before 'TCODPath'
Player.cpp:103: error: expected ';' before 'TCODPath'
Player.cpp: In destructor 'Player::~Player()':
Player.cpp:119: error: 'myPath' was not declared in this scope
Player.cpp: At global scope:
Player.cpp:124: error: no 'Player* Player::get()' member function declared in class 'Player'` 
```

编辑：这是 Player.cpp 的开头，大部分错误都在其中。

```
#include "Player.h"
#include <stdio.h>

Player* Player::myGuy = NULL;

void Player::update()
{
if(TCODConsole::isKeyPressed(TCODK_UP)){
    up = true;
}

if(TCODConsole::isKeyPressed(TCODK_DOWN)){
    down = true;
}

if(TCODConsole::isKeyPressed(TCODK_LEFT)){
    left = true;
}

if(TCODConsole::isKeyPressed(TCODK_RIGHT)){
    right = true;
}

if(++counter == max)
{
    counter = 0;

    if(controlled){
        if(myPath->isEmpty())
        {
            posn* temp = Map::get()->getRandomDestination();
            myPath->compute(x, y, temp->x, temp->y);
            printf("Destination set to (%d, %d)\n", temp->x, temp->y);
        }else{
            myPath->walk(&x, &y, false);
            printf("Proceeding to (%d, %d)\n", x, y);
        }
    }else{
        int tempY = 0;
        int tempX = 0;

        if(up){
            tempY -= 1;
        }

        if(down){
            tempY += 1;
        }

        if(left){
            tempX -= 1;
        }

        if(right){
            tempX += 1;
        }

        up = false;
        down = false;
        left = false;
        right = false;

        printf("Projected movement is (%d, %d)\n", tempX, tempY);

        tempX += x;
        tempY += y;

        if(Map::get()->getRealMap()->isWalkable(tempX, tempY)){
            x = tempX;
            y = tempY;
            printf("walking\n");
        }
    }
}

VillagerManager::get()->collide(x, y);
} 
```

# c++ - 当我使用带分隔符的 getline() 时，cin.get() 会跳过

> ID：14541442
> 
> 赞同：0
> 
> 时间：2013-01-26T20:48:59.770
> 
> 标签：c++, cin

我试图让这个非常简单的程序工作。程序运行它会打印出 'Please, enter your full name: ' 。我用空格'john johnny'输入我的名字（忽略''仅供参考）然后我输入分隔符$并按回车键。程序应该在 cin.get() 处停止；这样我就可以读取输出但对关闭进行编程。帮帮我，我很新手

这是代码

```
#include <iostream>
#include <string>

using namespace std ;

void main ()
{
  string name;

  cout << "Please, enter your full name: ";
  getline (cin,name,'$');
  cout << "Hello, " << name ;

  cin.get(); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:54:11.577

用户在 之后输入的换行符`$`将保留在输入流中，因为它不会被`getline()`: 这是`get()`读取的字符。

只需使用`getline`, 使用新行作为分隔符（默认）。

# ios - video.js 在 iPad 上破坏 popcorn.js

> ID：14541449
> 
> 赞同：0
> 
> 时间：2013-01-26T20:50:16.040
> 
> 标签：ios, ipad, video.js, popcornjs

所以这是挑战。制作一个可点击的爆米花链接覆盖视频。在桌面上很简单，但 iOS 被证明是一个挑战。如果 video 元素具有`controls`iOS 劫持视频窗口内所有点击的属性，则使链接覆盖不可点击。但是，如果`controls`视频元素上不存在该属性，则爆米花链接是可点击的并且运行良好。

问题是，现在没有视频控件。我需要那些。所以我认为一些手写的基于 javascript 的视频控件应该可以正常工作。视频标签上没有`controls`属性，所以爆米花覆盖是可点击的，加上工作控件！我的尝试是使用 video.js。

所以现在我在桌面上有了 video.js 视频控件和爆米花。但在 iPad 上，video.js 部分有效，但爆米花部分不再有效。我得到了 video.js 控件，但没有触发爆米花事件。但是没有错误，并且脚本完全执行。

有谁知道这里发生了什么？为什么 video.js 只会在 iOS 上停止爆米花？有解决办法吗？

[**问题演示**](http://popcorn-poc.radiantdev.com/jm-popcorn-poc/demo/index)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T16:40:54.330

我在 Firefox 中遇到了同样的问题。爆米花不适用于 videoJS。

我这样解决了我的问题：

```
jQuery(function(){

    _V_('videoid').ready(function() { // videoJS ready ?
        console.info('videoJS ready : player ID = '+$(this).attr('id'));
        console.info('videoJS ready : videoObj ID = '+$('#videoid video').attr('id'));

        var pop = Popcorn( "#"+$('#videoid video').attr('id') );
        // etc...

    });

}); 
```

就像说的 brianchirls 一样，videoJS 使一个 div id = "videoid" 包含一个视频 id = "videoid_html5_api"，因此对象 id="videoid" 不再是一个视频对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T22:29:46.443

VideoJS 必须对您的网页进行更改以插入其所有控件并正确定位它们，其中包括移动视频元素。Mobile Safari 是出了名的敏感并且对这些东西有点奇怪。看起来 VideoJS 正在删除您的原始视频元素并用新元素替换它，这是在Popcorn 将其自身附加到原始元素*之后发生的。*

[在 Mobile Safari 上调试](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/DebuggingSafarioniPhoneContent/DebuggingSafarioniPhoneContent.html)缩小的 Javascript 并不是一件轻松的事，所以我无法确切说明为什么 VideoJS 在 iPad 而不是其他浏览器上这样做。但是使用控制台，可以大致了解发生了什么：

```
document.getElementsByTagName('video')[0] ===
    window.Popcorn.instances[0].media
//false! 
```

这意味着 Popcorn 正在收听的视频元素与您在网页中看到和播放的视频元素不同。从这个命令...

```
window.Popcorn.instances[0].media.parentNode //null! 
```

...您可以看到原始标签存在于内存中，但未附加到 DOM。因此，在播放新视频时，原始视频会在 0:00 处暂停。

解决方案是在VideoJS 完成业务*后*设置您的 Popcorn 实例。然后确保正确引用视频元素，因为现在'#popacorn' 引用 a `<div>`，并且新的视频元素称为“popacorn_html5_api”。这应该涵盖您的 iOS 和桌面浏览器。

# regex - 使用正则表达式查找包含特定方法或变量的函数

> ID：14541450
> 
> 赞同：1
> 
> 时间：2013-01-26T20:50:28.270
> 
> 标签：regex, perl, sublimetext2

这是我在stackoverflow上的第一篇文章，所以请对我温柔...

我仍在学习正则表达式——主要是因为我终于发现了它们的用处，这部分是通过使用 Sublime Text 2。所以这是 Perl 正则表达式（我相信）

我已经在这个网站和其他网站上搜索过了，但我现在真的被困住了。也许我正在尝试做一些无法做到的事情

我想找到一个正则表达式（模式），它可以让我找到包含给定变量或方法调用的函数、方法或过程等。

我已经尝试了许多表达方式，它们似乎得到了一部分但不是全部。特别是在 Javascript 中搜索时，我选择了多个函数声明，而不是最接近我正在寻找的调用/变量的声明。

例如：我正在寻找调用我学到的方法 save data() 的函数，从这个我可以使用 (?s) 切换的优秀网站。包括换行符

```
function.*(?=(?s).*?savedata\(\)) 
```

但是，这将找到 word 函数的第一个实例，然后是包含 savedata() 在内的所有文本

如果有多个过程，那么它将从下一个函数开始并重复，直到再次到达 savedata()

```
function(?s).*?savedata\(\) does something similar 
```

我曾尝试通过使用以下方法要求它忽略第二个功能（我相信）：

```
function(?s).*?(?:(?!function).*?)*savedata\(\) 
```

但这不起作用。

我已经进行了一些向前看和向后看的调查，但要么我做错了（很有可能），要么他们不是正确的事情。

总而言之（我猜），我如何从给定的单词倒退到最近出现的不同单词。

目前我正在使用它来搜索一些 javascript 文件以尝试理解结构/调用等，但最终我希望在 c# 文件和一些 vb.net 文件上使用

提前谢谢了

感谢您的快速响应，很抱歉没有添加示例代码块 - 我现在将执行此操作（已修改但仍足以显示问题）

如果我有一个简单的 javascript 块，如下所示：

```
 function a_CellClickHandler(gridName, cellId, button){
        var stuffhappenshere;
        var and here;
        if(something or other){
            if (anothertest) {

                event.returnValue=false;
                event.cancelBubble=true;
                return true; 
            }
            else{
                event.returnValue=false;
                event.cancelBubble=true;
                return true;
            }
        } 
    }

    function a_DblClickHandler(gridName, cellId){
        var userRow = rowfromsomewhere;
        var userCell = cellfromsomewhereelse;
        //this will need to save the local data before allowing any inserts to ensure that they are inserted in the correct place
        if (checkforarangeofthings){
            if (differenttest) {
                InsSeqNum = insertnumbervalue;
                InsRowID = arow.getValue()
                blnWasInsert = true;
                blnWasDoubleClick = true;
                SaveData();      
            }
        }
    } 
```

对此运行正则表达式 - 包括被识别为应该工作的第二个，Sublime Text 2 将选择从第一个函数到 SaveData() 的所有内容

在这种情况下，我希望能够只访问 dblClickHandler - 而不是两者兼而有之。

希望这个代码片段会增加一些清晰度，并且很抱歉最初没有发布，因为我希望标准代码文件就足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T01:15:52.240

此正则表达式将查找包含 SaveData 方法的每个 Javascript 函数：

`(?<=[\r\n])([\t ]*+)function[^\r\n]*+[\r\n]++(?:(?!\1\})[^\r\n]*+[\r\n]++)*?[^\r\n]*?\bSaveData\(\)`

它将匹配函数中的所有行，包括包含 SaveData 方法的第一行。

**警告：**

*   源代码必须具有格式良好的缩进才能工作，因为正则表达式使用匹配的缩进来检测函数的结尾。
*   如果函数从文件的第一行开始，它将不匹配。

**解释：**

```
(?<=[\r\n])                      Start at the beginning of a line
([\t ]*+)                        Capture the indentation of that line in Capture Group 1
function[^\r\n]*+[\r\n]++        Match the rest of the declaration line of the function
(?:(?!\1\})[^\r\n]*+[\r\n]++)*?  Match more lines (lazily) which are not the last line of the function, until: 
[^\r\n]*?\bSaveData\(\)          Match the first line of the function containing the SaveData method call 
```

**注意：** and`*+`是`++`所有格量词，仅用于加快执行速度。

**编辑：** 修复了正则表达式的两个小问题。
**编辑：** 修复了正则表达式的另一个小问题。

# html - 如何更改html5中自动日期选择器的显示格式

> ID：14541456
> 
> 赞同：12
> 
> 时间：2013-01-26T20:51:34.103
> 
> 标签：html, google-chrome, input, datepicker

当使用 <input **type=date** > (chrome V20+) 时，Google Chrome 会显示一个日期选择器。字段中显示的日期采用 dd-mm-yy 格式。但是，对于这个网页，我需要 dd-mm-yyyy 格式。

4 位数的年份格式对于在此页面上输入数据的用户至关重要（例如，1745 和 1945 都显示为“45”，这对于某些用途来说非常危险）。

有没有办法强制 Chrome（和其他浏览器）显示网站开发者选择的格式，而不是语言环境？谢谢，迈克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T01:56:01.907

HTML5 规范没有提供解决此问题的方法。你最好的选择是使用 jQuery/jQueryUI （它给你更多的控制） - [http://api.jqueryui.com/datepicker/#entry-examples](http://api.jqueryui.com/datepicker/#entry-examples)

另请参阅[是否有任何方法可以更改输入类型 =“日期”格式？](https://stackoverflow.com/questions/7372038/is-there-any-way-to-change-input-type-date-format)

# python - 如何根据 QcomboBox 索引切换小部件的启用状态

> ID：14541457
> 
> 赞同：2
> 
> 时间：2013-01-26T20:52:01.857
> 
> 标签：python, pyqt, pyqt4

我正在使用 pyQT 4.8.3 为 QGIS 插件创建适当的 GUI

表单中有三个小部件

```
my_comboBox , my_lineEdit , my_spinBox 
```

假设 comboBox 有三个条目

```
'combo_first_item' , 'combo_second_item' , 'combo_third_item' 
```

我到底想要什么；

```
if 'combo_second_item' is selected, then my_lineEdit toggles state to disabled
if 'combo_third_item' selected, then my_spinBox toggles state to disabled 
```

那么，如何根据从组合框中选择的字符串（或索引值）来切换表单中小部件的启用状态？

什么应该是正确的信号-> 插槽分配？与 QbuttonBox 不同，QcomboBox 不会触发 SetDisabled 插槽

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T22:45:53.410

制作一个将字符串映射到小部件的字典：

```
widgets = {'combo_first_item': my_comboBox,
           'combo_second_item': my_lineEdit,
           'combo_third_item': my_spinBox} 
```

还有一个插槽：

```
def disableWidget(currentIndex):
     widget = widgets[currentIndex]
     widget.setEnabled(False)
     # or anything else you want to do on the widget 
```

然后你可以将`currentIndexChanged[QString]`信号连接到这个：

```
comboBox.currentIndexChanged['QString'].connect(disableWidget) 
```

或者，您可以使用`currentIndexChanged[int]`和列表而不是字典。

PS：如果这是在类实例中，请`self`相应放置。

# ios - 如何按降序对日期数组进行排序

> ID：14541458
> 
> 赞同：15
> 
> 时间：2013-01-26T20:52:06.020
> 
> 标签：ios, objective-c, uitableview, nsdate, nsdictionary

我有一个解析为数组的 NSDictionary，其中一个元素是日期，我尝试使用`[startimeArray sortUsingSelector:@selector(compare:)];`(starttimeArray) 是我的日期，但它只排列升序。我怎样才能按降序排序。谢谢

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-26T20:53:43.473

**通过输入NO**是升序参数对数组进行排序：

```
NSSortDescriptor *descriptor=[[NSSortDescriptor alloc] initWithKey:@"self" ascending:NO];
NSArray *descriptors=[NSArray arrayWithObject: descriptor];
NSArray *reverseOrder=[dateArray sortedArrayUsingDescriptors:descriptors]; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-26T21:10:44.077

您可以使用比较器块

```
NSArray *sortedArray = [array sortedArrayUsingComparator: ^(NSDate *d1, NSDate *d2) {
    return [d1 compare:d2];
}]; 
```

要颠倒顺序，只需交换日期

```
NSArray *sortedArray = [array sortedArrayUsingComparator: ^(NSDate *d1, NSDate *d2) {
    return [d2 compare:d1];
}]; 
```

或者 — 作为`compare:`返回一个 NSComparisonResult，它实际上是 typedef 为整数，[见下文]— 只需乘以 -1

```
NSArray *sortedArray = [array sortedArrayUsingComparator: ^(NSDate *d1, NSDate *d2) {
    return -1* [d1 compare:d2];
}]; 
```

* * *

```
enum {
   NSOrderedAscending = -1,
   NSOrderedSame,
   NSOrderedDescending
};
typedef NSInteger NSComparisonResult; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-19T11:36:46.497

我会使用内置`reverseObjectEnumerator`方法`NSArray`

```
startimeArray = [startimeArray sortUsingSelector:@selector(compare:)];
startimeArray = [[startimeArray reverseObjectEnumerator] allObjects]; 
```

当您需要按升序和降序对数组进行排序时，它很有用，因此您可以轻松地返回到先前的排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-08T16:01:27.003

检查解决方案有快速解决方案：

```
let sortedArray = randomArray.sortedArrayUsingComparator { (d1, d2) -> NSComparisonResult in
    return (d1 as! NSDate).compare(d2 as! NSDate)
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-17T14:29:01.977

**斯威夫特 3.0**

对于任何使用 swift 3.0 的人来说，这个[DateHelper](https://github.com/melvitax/DateHelper)会让你头疼。

```
 filteredLogs.sort(by: {
        let firstElement = $0.timeStamp! as Date
        let secondElement = $1.timeStamp! as Date
        return firstElement.compare(.isEarlier(than: secondElement))
    }) 
```

上面的代码是我的一个项目的片段。它使用辅助类将我的日志与数组左侧的最新日期进行排序。$ 符号是一个[位置参数](https://stackoverflow.com/questions/29258603/what-do-0-1-2-mean-in-shell-script)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-12T02:20:39.920

在初始化数组元素的类中。

```
-(NSComparisonResult) compareArray: (id) element {
    Return [ArrayElement compare: [element ArrayElement]];
}

-(NSComparisonResult) compareArrayReverse: (id) element {
    Return [[element ArrayElement] compare: ArrayElement];
} 
```

然后在初始化 starttimeArray 的类中：

```
@synthesize ArrayName;

-(void) sort: (BOOL) sel {
    if (sel) {
        [ArrayName sortUsingSelector: @selector(compareArray:)];
    } else {
        [ArrayName sortUsingSelector: @selector(compareArrayReverse:)];
    }    
} 
```

然后在 main() 中：

```
// Sort the array. sort = TRUE - ascending order, sort = FALSE - descending order.

[startimeArray sort: FALSE]; 
```

# c# - windows store app Listview 绑定

> ID：14541463
> 
> 赞同：2
> 
> 时间：2013-01-26T20:52:32.123
> 
> 标签：c#, xaml, listview, data-binding, windows-8

我有一个数据类：

```
public class routedata : INotifyPropertyChanged

{

    private List<double> distances;
    public List<double> Distances
    {
        get { return this.distances; }
        set
        {
            if (this.distances != value)
            {
                this.distances = value;
                this.onPropertyChanged("Distances");
            }
        }
    }

    private List<string> instructions;
    public List<string> Instructions
    {
        get { return this.instructions; }
        set
        {
            if (this.instructions != value)
            {
                this.instructions = value;
                this.onPropertyChanged("Instructions");
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void onPropertyChanged(string property)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }        
} 
```

我正在尝试将其绑定到这样的列表视图：

```
 <GridView Name="routeView" HorizontalAlignment="Left" Height="310" Margin="1025,318,0,0" Grid.Row="1"      
           VerticalAlignment="Top" Width="340" >
            <ListView Name="routeList" Height="300" Width="330" ItemsSource="{Binding routeData}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Instructions}"
                                                      TextWrapping="Wrap" Width="200"/>
                            <TextBlock Text="{Binding Distances}"
                                                      Margin="10,0,0,0" />
                            <TextBlock Text="km"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </GridView> 
```

我在我的 C# 代码后面： routeList.datacontext = this;

但它仍然没有绑定，列表视图中只填充了一个空行。我检查了数据，它都存在。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:06:43.443

ListView 将单个集合作为 ItemsSource，因此如果您想为每个项目显示多个 TextBlock - 您需要一个具有多个文本属性的对象集合来绑定到您的 DataTemplate。在您的情况下， routeData 不是集合。相反，您需要定义您的项目视图模型，例如

```
public class RoutePoint
{
    public double Distance { get; set; }
    public string Instruction { get; set; }
} 
```

然后你会将你的 ListView.ItemSource 绑定到一个 List 并在你的 DataTemplate 中像这样绑定它：

```
<TextBlock Text="{Binding Distance}"/>
<TextBlock Text="{Binding Instruction}"/> 
```

如果您的集合在首次绑定到 ListView 后从未更改（SelectedItem 不构成更改），则您不需要使用 ObservableCollection。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T20:59:09.843

如果您的视图被调用`routeView`，不应该将您`DataContext`设置为的新实例`routedata`吗？另外，我建议您将[`ObservableCollection<T>`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)用于可绑定集合，而不是`List<T>`.

# wpf - WPF 覆盖所有默认鼠标光标

> ID：14541466
> 
> 赞同：1
> 
> 时间：2013-01-26T20:53:05.660
> 
> 标签：wpf, styles, mouse-cursor

是否可以将所有默认光标（由 .NET 定义）更改为单个皮肤样式的其他光标？我的意思是，如果鼠标触摸当前窗口，则应使用定义样式中的**所有默认光标。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:34:18.633

您可以使用该`Mouse.OverrideCursor`属性全局更改`Cursor`整个`WPF`应用程序

例子：

```
 Mouse.OverrideCursor = Cursors.Hand; 
```

# prolog - 如何将信息放入prolog

> ID：14541472
> 
> 赞同：0
> 
> 时间：2013-01-26T20:53:39.017
> 
> 标签：prolog, logic, weblogic-10.x

```
> The father sat to the right of the person who had corn, 
> who sat to the right of the person who ate pork, who sat to the right of the
> person who had baked potato, who sat to the right of the person who
> had peas. 
```

如何将其转换为 Prolog 谓词？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:17:10.473

我首先将其改写为“吃玉米的人的权利就是父亲。吃猪肉的人的权利就是吃玉米的人。” 等等。然后使用谓词 right(x, y) 表示“对 x 的权利是 y”。最终结果是：

```
right(corn, father).
right(pork, corn).
right(potato, pork).
right(peas, potato).
```

# c++ - QObject::connect: 不能对类型为“QVector”的参数进行排队 '

> ID：14541477
> 
> 赞同：11
> 
> 时间：2013-01-26T20:54:33.877
> 
> 标签：c++, multithreading, qt, user-interface, connect

我对 Qt 有一些问题。我有一个带有信号的类，其参数是字符串和一个插槽。我将信号连接到类构造函数中的插槽。另外，我正在类构造函数中创建一个线程。线程从服务器读取数据并更新 UI（发出 UpdateMe 信号）。这就是我将信号连接到插槽的方式：

```
 QObject::connect(this, SIGNAL(UpdateMe(string, string)), this, SLOT(ModifyUI(string, string))); 
```

我有一个带有一些文件名的 QTreeWidget。当我重命名文件时，我通知服务器，服务器通知其他客户端。当我连接单个客户端时没有问题，但是当我连接多个客户端时出现问题：当我从第二个客户端通知服务器时（当我写入套接字时）出现以下错误：

```
 QObject::connect: Cannot queue arguments of type 'QVector<int>' 
```

我尝试使用 qRegisterMetaType 注册 QVector，但是当我修改 QTreeWidgetItem（例如，当我重命名项目时）时也会发出一个信号，并且当我想更改项目的文本时需要断开此信号。如果我注册 QVector，我无法断开此信号并发出信号。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-26T21:39:03.910

当你注册 QVector 时，你的调用是这样的吗？

```
qRegisterMetaType<QVector<int> >("QVector<int>"); 
```

进行此调用后，您应该能够通过排队连接发出 QVector 类型。

> 如果我注册 QVector，我无法断开此信号并发出信号。

注册元类型不应阻止您断开信号。它只允许您对尚未在元系统中注册的类型进行排队。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-29T16:42:55.067

大多数时候，看起来像这样的错误似乎是混合线程的结果，特别是对于这个错误，在我的（有限）经验中，尝试使用命令操作 GUI 线程中“持有”的 GUI 元素的结果运行一个工人`QThread`。

我说“保留”是因为您经常会收到投诉/错误/崩溃，例如“QObject：无法为处于不同线程中的父级创建子级”。（即 GUI 线程）。

解决方案：从非 GUI`QThread`始终使用信号和插槽与 GUI 元素通信。

# r - 将最近邻距离表转换为矩阵

> ID：14541481
> 
> 赞同：2
> 
> 时间：2013-01-26T20:54:51.170
> 
> 标签：r, matrix, nearest-neighbor

我有一个使用 RANN 包计算最近邻（K=2）生成的数据框。我想将此数据转换为每个单元格的值为 0、1、2 的矩阵，其中 0 = 非邻居，1 = 最近邻居，2 = 第二最近邻居。

数据框有两列，第一列是第一个NN的ID，第二列是第二个NN的ID。这些行对应于计算 NN 的点的 ID。

是否有现有的例程可以轻松进行这种转换？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:20:26.477

根据您给出的有限想法，*我认为*这是一个*不太好的*解决方案：

```
 NNdf <- data.frame(NN1=c(1,2,4),NN2=c(2,3,1)) # make up some data
 NNdf$origin <- rownames(NNdf)

 NNdf
#  NN1 NN2 origin
#1   1   2      1
#2   2   3      2
#3   4   1      3

 library(reshape2)
 hold <- melt(NNdf, id = "origin")
 hold
#  origin variable value
#1      1      NN1     1
#2      2      NN1     2
#3      3      NN1     4
#4      1      NN2     2
#5      2      NN2     3
#6      3      NN2     1

 hold2 <- dcast(hold, origin~value, value.var="variable")

 hold2[hold2 == "NN1"]  <- 1
 hold2[hold2 == "NN2"]  <- 2
 hold2[is.na(hold2) ]   <- 0

 hold2
#  origin 1 2 3 4
#1      1 1 2 0 0
#2      2 0 1 2 0
#3      3 2 0 0 1 
```

（这可能依赖于`apply(hold2,1,as.numeric)`之后）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:57:48.833

另一种可能性，但不是特别漂亮。感谢@user1317221_G 提供示例数据！

```
NNdf <- data.frame(NN1=c(1,2,4,3),NN2=c(2,3,1,2))
NNdf$origin <- as.numeric(rownames(NNdf))
NNdf

  NN1 NN2 origin
1   1   2      1
2   2   3      2
3   4   1      3
4   3   2      4

res <- matrix(0,nrow(NNdf),nrow(NNdf))
res[as.matrix(NNdf[,c("origin","NN1")])] <- 1
res[as.matrix(NNdf[,c("origin","NN2")])] <- 2
res

     [,1] [,2] [,3] [,4]
[1,]    1    2    0    0
[2,]    0    1    2    0
[3,]    2    0    0    1
[4,]    0    2    1    0 
```

# php - PHP：解析静态文件和php数组文件的区别

> ID：14541483
> 
> 赞同：0
> 
> 时间：2013-01-26T20:54:55.457
> 
> 标签：php, arrays, parsing, translation

我想找到制作翻译框架的最佳方法（gettext 有一些缺陷）。

所以我做了两个测试 - 一，**解析**文件包含下面代码的静态文本

```
function parseLine($line) {
    if($line[0] == '#' || !strlen($line)) 
        return array();

    $eq = strpos($line, '=');
    $key = trim(substr($line, 0, $eq));

    $value = trim(substr($line, $eq+1));
    $value = trim($value, '"');

    return array($key => $value);
}

$table = array();
$fp = fopen('lang.lng', 'r');
while(!feof($fp)) {
    $table += parseLine(fgets($fp, 4096));
}
fclose($fp); 
```

其次**包括数组**

```
$table = include('lang.php'); 
```

当然，每个 lang.lng 和 lang.php 都有相同的数据（1000 条记录），但以不同的方式表示。

当我看到结果时我感到很惊讶...... **第一种方法**：~0.01 s **第二个**：~0.001 s

在测试之前，我确信包含数组将占用更多内存和时间，然后解析文件。有人可以解释一下错误在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T20:59:39.933

我会认为这是一个明智的选择。哪个更快，读入一个包含数组的文件，或者读入一个文件，逐行处理它，并为每一行查找各种标记和组件，并将它们拼凑成一个复杂的问题，以产生与包含方法相同的数组？

# c++ - glutWarpPointer 崩溃

> ID：14541485
> 
> 赞同：0
> 
> 时间：2013-01-26T20:55:11.647
> 
> 标签：c++, opengl, glut

我正在关注[这些](http://ogldev.atspace.co.uk/index.html)关于现代 OpenGL 的教程。我已经完成了 15 号“相机控制 - 第 2 部分”。本教程建议使用 glutWarpPointer()。问题是，我的程序在那次调用中崩溃了。这是我的代码：

```
c_camera::c_camera(int width, int height, const c_vector3f& Pos, const c_vector3f& Target, const c_vector3f& Up){
    m_windowWidth = width;
    m_windowHeight = height;
    m_pos = Pos;

    m_target = Target;
    m_target.Normalize();

    m_up = Up;
    m_up.Normalize();
    Init();
}

void c_camera::Init(){
    c_vector3f HTarget(m_target.x, 0.0, m_target.z);
    HTarget.Normalize();

    if (HTarget.z >= 0.0f){
        if (HTarget.x >= 0.0f){
            m_AngleH = 360.0f - (asin(HTarget.z) TO_DEG);
        } else {
            m_AngleH = 180.0f + (asin(HTarget.z) TO_DEG);
        }
    } else {
        if (HTarget.x >= 0.0f){
            m_AngleH = (asin(-HTarget.z) TO_DEG);
        } else {
            m_AngleH = 90.0f + (asin(-HTarget.z) TO_DEG);
        }
    }

    m_AngleV = -(asin(m_target.y) TO_DEG);

    m_OnUpperEdge = false;
    m_OnLowerEdge = false;
    m_OnLeftEdge = false;
    m_OnRightEdge = false;
    m_mousePos.x = m_windowWidth / 2;
    m_mousePos.y = m_windowHeight / 2;

    cout << "this gets printed just fine" << endl;

    glutWarpPointer(500,400); //program crashes

    cout << "this doesn't get printed" << endl;
} 
```

我不确定我是否在这里做了一些奇怪的事情，或者我只是有一个糟糕的 glut 版本（对我来说似乎不太可能）或者教程是否是错误的......我是否需要在我之前设置一些 glut 特定的东西可以调用 glutWarpPointer() 吗？我是 glut 的新手，也是现代 OpenGL 的新手（我首先学习了即时模式）。快速的谷歌搜索对我没有多大帮助。任何帮助，将不胜感激。

编辑：我在 Windows 上，我正在使用 mingw 4.5

Edit2：这些是窗口给我的有关崩溃的详细信息：
问题事件名称：APPCRASH
应用程序名称：modern_opengl.exe
应用程序版本：0.0.0.0
应用程序时间戳：51044575
故障模块名称： glut32.dll 故障
模块版本：0.0.0.0
故障模块时间戳：3BEA4FF3
异常代码： C0000005
异常偏移量：0000A879
OS版本：6.2.9200.2.0.0.256.48
区域设置：1043
附加信息1：5861
附加信息2：58618222C64908B2
附加信息3：F3D5
附加信息4：F3D5BE0CAD2787555264647DC02181C3

Edit3：这是我的调用堆栈：
0 1000A879 glutWarpPointer() (C:\Windows\system\glut32.dll:??)
1 004033FB c_camera::Init(this=0x4aa0e0) (C:\CodeBlocks\projects\modern_opengl\c_camera .cpp:50)
2 00403164 c_camera::c_camera(this=0x4aa0e0, width=800, height=600, Pos=..., Target=..., Up=...) (C:\CodeBlocks\projects\ modern_opengl\c_camera.cpp:18)
3 00402F4B __static_initialization_and_destruction_0(__initialize_p=1, __priority=65535) (C:\CodeBlocks\projects\modern_opengl\main.cpp:55)
4 00403004 *GLOBAL* _sub_I_vertices() (C:\CodeBlocks\projects\现代_opengl\main.cpp:177)
5 0043595B __do_global_ctors() (../mingw/gccmain.c:59)
6 00401098 __mingw_CRTStartup() (../mingw/crt1.c:236)
7 00401284 mainCRTStartup() (../mingw/crt1.c:264)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T00:47:26.410

您的函数似乎在 c_camera::Init 中，它似乎在之前被调用过，`main`可能是因为它被实例化为全局对象（全局变量是在`main`输入之前构造的）。您应该延迟 glut 呼叫，直到您进入`main`并被呼叫之后`glutInit`。

# java - 有没有办法在 java 代码运行时更改 TextView 中的文本？

> ID：14541486
> 
> 赞同：3
> 
> 时间：2013-01-26T20:55:11.380
> 
> 标签：java, android, string

我在 XML 布局中有一个 TextView（在 Android 应用程序中）。此 TextView 显示 strings.xml 中字符串的值。但是，当我的 java 代码运行时，我希望该字符串的值在连续 4 秒内每秒更改一次，并且我希望 XML 布局显示该更改。

有没有办法在java代码运行时更改strings.xml中字符串的值？如果没有，是否有另一种方法可以在 java 代码运行时更改布局中 textView 显示的文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:34:29.730

我建议使用[Timer](http://developer.android.com/reference/java/util/Timer.html)。

```
private Timer timer = new Timer();
private TimerTask timerTask;
timerTask = new TimerTask() {
  @Override
  public void run() {
    //refresh your textview
  }
};
timer.schedule(timerTask, 0, 10000); 
```

您可以使用以下方法取消它：

```
timer.cancel(); 
```

# linux - 在 Linux 中从网络摄像头获取视频流

> ID：14541487
> 
> 赞同：0
> 
> 时间：2013-01-26T20:55:16.947
> 
> 标签：linux, video, video-capture

我正在寻找一些通用方法来从 Linux 中的网络摄像头获取视频流，然后处理并在窗口中显示它。第二部分看起来很简单，但我不知道如何处理第一部分。

是否有一些 API、库、文档等？.. 从哪里开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:02:16.250

我以前做过一点，你是对的，第二部分是简单的部分。你应该看看这篇文章，了解一些常用的库。

[Linux 上的视频捕获？](https://stackoverflow.com/questions/83899/video-capture-on-linux?rq=1)

我还将 OpenCV 放在该列表中，因为它有助于获取和处理视频流：

[http://sourceforge.net/projects/opencvlibrary/](http://sourceforge.net/projects/opencvlibrary/)

[http://www.willowgarage.com/pages/software/opencv](http://www.willowgarage.com/pages/software/opencv)

祝你好运！

# php - 导入谷歌联系人时出错

> ID：14541489
> 
> 赞同：0
> 
> 时间：2013-01-26T20:55:43.463
> 
> 标签：php, oauth, oauth-2.0, contacts, import-contacts

我正在使用它从我的 id something@xyz.com 获取所有 gmail 联系人：

[在 PHP 中使用 Google Contacts Data API 和 OAuth 2.0 导入 Gmail 或 Google 联系人](http://25labs.com/import-gmail-or-google-contacts-using-google-contacts-data-api-3-0-and-oauth-2-0-in-php/)

但是，我只显示了 30-40/300 个联系人。当我将 max_results 设置为非常高的值时，我得到一个错误：

```
Fatal error: Uncaught exception 'Exception' with message 'String could not be parsed as     
XML' in C:\xampp\htdocs\oauth\oauth.php:80 Stack trace: #0   
C:\xampp\htdocs\oauth\oauth.php(80): SimpleXMLElement->__construct('') #1 {main} thrown  
in C:\xampp\htdocs\oauth\oauth.php on line 80 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T09:58:23.167

您可以获得的最大金额`feed`为 100。如果您超过此金额，则会发生坏事。您可以`startIndex`与 结合使用`max-results`来指定要从哪里获取以及一次获取多少。

```
 # max-results - max is 100 entries
 # startIndex - Used for paging so you can get the next bunch of results 
```

查看[Google Contacts API](https://developers.google.com/google-apps/contacts/v3/#retrieving_all_contacts)以获取有关 XML 布局的更多信息、您可以使用的其他一些方法以及特定于语言的方法的信息。尝试查看**使用查询参数检索联系人**和**检索所有联系人**部分，了解您在此处需要的内容。

# javascript - MarionetteJS 复合视图的奇怪行为

> ID：14541491
> 
> 赞同：2
> 
> 时间：2013-01-26T20:56:07.067
> 
> 标签：javascript, backbone.js, marionette

我正在使用 MarionetteJS 复合视图。

出于某种原因，我得到了递归模板行为。

通常 itemView 的模板是在 itemViewContainer 中呈现的，但由于某种原因，它没有采用 itemView 的模板，而是采用了它自己的复合视图模板。

这不是英语，但可以在这里直观地看到行为：

[http://www.codeforum.me/admin.html](http://www.codeforum.me/admin.html)

另一件事是，我让它在我的本地主机上完美运行，但是当我上传它并尝试从我的托管服务器运行它时，它显示出这种奇怪的行为。

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T23:02:17.583

当木偶找不到您的 itemView 时会发生这种情况。例如，如果您在实际定义 itemView 之前指定它，则不会找到它。当您不指定 itemView（或未找到它）时，默认行为会启动，即使用与 itemView 相同的复合视图来创建递归树结构。

要解决此问题，请在 CompositeView 声明中使用 itemView 之前定义它。

```
 IV = Marionette.ItemView.extend({ /* ... */ });

CV = Marionette.CompositeView.extend({
  itemView: IV,
  // ...
}); 
```

# c++ - 使用 gtkmm 编译 Hello world 程序的问题

> ID：14541492
> 
> 赞同：3
> 
> 时间：2013-01-26T20:56:37.910
> 
> 标签：c++, ubuntu-12.04, gtkmm

我是 C++ 和 gtkmm 的新手。我目前正在尝试使用窗口和按钮编译我在网上找到的教程。我正在 Ubuntu 12.04 中编译。我可以很好地编译一个文件，但是当我尝试使用 Makefile 编译多个文件时，我收到一个我不明白的错误：

```
sarah@superawesome:~/gtkexample$ make
g++ -c main.cc
In file included from HelloSarah.h:4:0,
                 from main.cc:1:
/usr/include/gtkmm-3.0/gtkmm/button.h:7:28: fatal error: glibmm/ustring.h: No such file or directory
compilation terminated.
make: *** [main.o] Error 1 
```

我真的不明白这个错误，我一直在寻找几个小时。我真的很感激任何帮助或洞察我的问题。

这些是我的 3 个文件和 Makefile：

```
#ifndef GTKMM_HELLOSARAH_H
#define GTKMM_HELLOSARAH_H

#include <gtkmm-3.0/gtkmm/button.h>
#include <gtkmm/window.h>

class HelloSarah : public Gtk::Window
{

public:
  HelloSarah();
  virtual ~HelloSarah();

protected:
  //Signal handlers:
  void on_button_clicked();

  //Member widgets:
  Gtk::Button m_button;
};

#endif 
```

和

主文件

```
#include "HelloSarah.h"
#include <gtkmm/application.h>

int main (int argc, char *argv[])
{
  Glib::RefPtr<Gtk::Application> app = Gtk::Application::create(argc, argv,     "org.gtkmm.example");

  HelloSarah hellosarah;

  //Shows the window and returns when it is closed.
  return app->run(hellosarah);
} 
```

和 HelloSarah.cc

```
#include "helloSarah.h"
#include <iostream>

HelloSarah::HelloSarah()
: m_button("Hello Sarah")   // creates a new button with label "HelloSarah".
{
  // Sets the border width of the window.
  set_border_width(10);

  // When the button receives the "clicked" signal, it will call the
  // on_button_clicked() method defined below.
  m_button.signal_clicked().connect(sigc::mem_fun(*this,
          &HelloSarah::on_button_clicked));

  // This packs the button into the Window (a container).
  add(m_button);

  // The final step is to display this newly created widget...
  m_button.show();
}

HelloSarah::~HelloSarah()
{
}

void HelloSarah::on_button_clicked()
{
  std::cout << "Hello Sarah" << std::endl;
} 
```

最后是我的 Makefile：

```
app:            main.o HelloSarah.o
                g++ -o app main.o HelloSarah.o

main.o:         main.cc HelloSarah.h
            g++ -c main.cc

HelloSarah.o:   HelloSarah.cc HelloSarah.h
            g++ -c HelloSarah.cc

clean:      
            rm -f *.o app 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T00:10:01.267

您的示例中的以下包含语句不正确。它之所以有效，只是因为文件路径是相对于标准的*/usr/include/*目录的，但*button.h*中的 include 语句不相关，因此您会收到一条错误消息。

```
#include <gtkmm-3.0/gtkmm/button.h> 
```

您必须告诉*g++*在哪里可以找到必要的包含文件和共享对象。您可以使用*pkg-config*的输出来完成这项工作。

```
pkg-config --cflags --libs gtkmm-3.0 
```

整个*g++*命令应该是这样的。

```
g++ `pkg-config --cflags --libs gtkmm-3.0` -c HelloSarah.cc 
```

[之后，您可以简单地使用 gtkmm Hello World](http://developer.gnome.org/gtkmm-tutorial/3.0/sec-helloworld.html.en)中的 include 行。

```
#include <gtkmm/button.h> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-01T06:10:32.813

我也有这个问题`Ubuntu`。

解决方案：

```
sudo apt-get install libgtkmm-3.0-dev 
```

您可以根据需要使用任何版本。

# c# - 如何获取 XNA 游戏屏幕上的窗口位置？

> ID：14541496
> 
> 赞同：3
> 
> 时间：2013-01-26T20:57:12.930
> 
> 标签：c#, winforms, xna, window, location

我正在 Visual Studio C# 2010 Express 中制作 XNA 4.0 游戏。在游戏中，我将 winForm 用于用户可以更改的某些属性。我希望 winForm 窗口恰好出现在 xna 主游戏窗口的右侧（为了清晰和更好的界面）。我的问题是，我怎样才能得到 xna 游戏窗口的坐标？如何更改 winForm 窗口的坐标，使该窗口恰好出现在主游戏窗口的右侧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:04:27.530

用这个：

```
using wf = System.Windows.Forms;

wf.Form MyGameForm = (wf.Form)wf.Form.FromHandle(Window.Handle);
var bounds = MyGameForm.Bounds; 
```

`bounds`将是一个`System.Drawing.Rectangle`，您可以访问它的 X、Y、宽度和高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T14:44:38.763

在设置新位置之前，您需要将 StartPosition 属性设置为 FormStartPosition.Manual...

这是一个详细的示例：

```
 var sc = System.Windows.Forms.Screen.AllScreens;

  var xnaForm = (Form) Forms.Control.FromHandle( Editor.Game.Window.Handle );

// Set the xnaForm position at the desired screen (for multimonitor systems)
  xnaForm.StartPosition = Forms.FormStartPosition.Manual;
  xnaForm.Location = new Point(
        sc[pref.AdapterIndex].Bounds.Left, 
        sc[pref.AdapterIndex].Bounds.Top);

  int W = sc[pref.AdapterIndex].WorkingArea.Width;
  int H = sc[pref.AdapterIndex].WorkingArea.Height;

  W -= Editor.Game.Window.ClientBounds.Width;

// Set the editor form position to the right of xnaForm
  MapForm.StartPosition = Forms.FormStartPosition.Manual;
  MapForm.DesktopLocation = new System.Drawing.Point(
        xnaForm.DesktopBounds.Right, 
        xnaForm.DesktopBounds.Top);
  MapForm.Width = W; 
```

# ios - 无法在 didFinishLaunchingWithOptions 中将 UIImageView 添加到 self.window

> ID：14541497
> 
> 赞同：0
> 
> 时间：2013-01-26T20:57:13.807
> 
> 标签：ios, uiimageview, addsubview, appdelegate

我正在尝试添加 UIImageView 作为我的 Default.png 消失后显示的第一个视图。这应该非常容易，但由于某种原因，我遇到了黑屏。

```
// AppDelegate.m

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions { 

UIImageView *newimageview = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
[newimageview setImage:[UIImage imageNamed:@"myimage.png"]];

[_window addSubview:newimageview];
[_window bringSubviewToFront:newimageview]; 

} 
```

我还尝试设置 newimageview 的背景颜色，以查看我是否没有正确加载图像文件，但屏幕仍然显示为黑色。

任何帮助将不胜感激，我现在​​觉得很愚蠢。

我刚刚创建了一个新项目，只修改了 didFinishLaunchingWithOptions 方法。这正是我正在使用的代码。我在项目中没有改变任何其他内容：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UIImageView *newimageview = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"bg-basketball"]];

    [self.window addSubview:newimageview];
    [self.window bringSubviewToFront:newimageview];

    // Override point for customization after application launch.
    //self.window.backgroundColor = [UIColor whiteColor];
    //[self.window makeKeyAndVisible];
    return YES;
} 
```

而且我仍然得到相同的黑屏结果。

我已将 bg-basketball.png 和 bg-basketball@2x.png 添加到我的项目中，并且可以在 XCode 中看到这两个图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-28T09:53:44.717

```
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];//Add this line 
```

这对我有用。

# linux - 意外标记“if”附近的语法错误

> ID：14541501
> 
> 赞同：4
> 
> 时间：2013-01-26T20:57:46.200
> 
> 标签：linux, bash, ubuntu, if-statement, scripting

我目前正在尝试编写一个 bash 脚本，它可以帮助我逐步浏览目录并检查文件上的 .jpeg 或 .jpg 扩展名。我想出了以下几点：

```
#declare $PICPATH, etc...

for file in $PICPATH
    if [ ${file -5} == ".jpeg" -o ${file -4} == ".jpg" ];
    then
        #do some exif related stuff here.
    else
        #throw some errors
    fi
done 
```

执行时，bash 不断在 if 行上抛出一个错误：“意外标记 `if' 附近的语法错误。

我对脚本完全陌生；我的 if 语句有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T21:01:15.953

我认为您只是缺少`for`循环的 do 子句：

```
#declare $PICPATH, etc...

for file in $PICPATH; do
    if [ ${file -5} == ".jpeg" -o ${file -4} == ".jpg" ];
    then
        #do some exif related stuff here.
    else
        #throw some errors
    fi
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:07:02.007

```
${file -5} 
```

是语法错误。也许你的意思是

```
${file#*.} 
```

?

无论如何，最好这样做：

```
for file in $PICPATH; do
    image_type="$(file -i "$file" | awk '{print gensub(";", "", $2)}')"
    case $image_type in
        image/jpeg)
            # do something with jpg "$file"
        ;;
        image/png)
            # do something with png "$file"
        ;;
        *)
            echo >&2 "not implemented $image_type type "
            exit 1
        ;;
    esac
done 
```

如果您只想处理`jpg`文件，请执行以下操作：

```
for file in $PICPATH; do
    image_type="$(file -i "$file" | awk '{print gensub(";", "", $2)}')"
    if [[ $image_type == image/jpeg ]]; then
            # do something with jpg "$file"
    fi
done 
```

# c# - 为什么我的 const 声明未能分配十六进制值？

> ID：14541515
> 
> 赞同：0
> 
> 时间：2013-01-26T20:59:41.010
> 
> 标签：c#

我正在尝试为十六进制值声明一个常量值，但似乎我无法在 C# 中实现这一点。

```
const PROCESSES = &H1F0FFF; 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:00:23.837

```
const int PROCESSES = 0x1F0FFF; 
```

# javascript - INVALID_STATE_ERROR 仅适用于 iOS，但不适用于 Android、OSX 或 Windows

> ID：14541516
> 
> 赞同：1
> 
> 时间：2013-01-26T20:59:44.223
> 
> 标签：javascript, ios, mobile-safari, html5-audio

我有一个通过 JavaScript 使用音频的 HTML5 网页。我有一个基本版本，可以加载正确的音频文件（例如，ogg vs mp3 等），然后正确播放该文件中的精灵。这个基本版本只有 1 个 javascript 文件，它适用于我尝试过的所有操作系统/浏览器组合，包括：OSX (Safari, Chrome, Firefox), iOS 5 and 6 (Safari), Windows 7 (Firefox, Chrome),和安卓 4.2 (火狐)。

我现在将代码插入到生产版本中。现在，HTML 页面加载了许多其他 JavaScript 文件（例如，jquery、jquery ui、flot）。但是，所有音频代码都在一个文件中，该文件通过

```
<script src="/foo/bar/sound.js"></script>. 
```

在这两种情况下，sound.js 中的代码都是由用户单击按钮调用的。在上述所有平台/浏览器组合上，组合代码在 iOS 上除外（在 iPad2 和 iPad3 上的 iOS 5 和 6 上测试）。我得到的错误是

```
INVALID_STATE_ERR: DOM Exception 11: An attempt was made to use an object that is not, or is no longer, usable. 
```

这发生在尝试根据所需的特定精灵设置 mySound.currentTime 的行上：

```
mySound.currentTime = spriteData[currentSound].start; 
```

mySound 是我的声音对象，并且 spriteData 是正确的。奇怪的是，在真实 iPad 上失败的相同代码在 iOSSimulator 中运行良好，无论我模拟 iOS 5 还是 iOS 6。

我该如何调试这种情况？我不知道在哪里寻找和尝试什么。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T22:06:31.853

Mobile Safari 有一个开发者模式，允许您从 Mac 上的 Safari 进行附加；请参阅[Safari Web 内容指南：在 iOS 上调试 Web 内容](http://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariWebContent/DebuggingSafarioniPhoneContent/DebuggingSafarioniPhoneContent.html)。

我也会尝试分解表达式以查看导致错误的位，例如

```
var t = spriteData[currentSound].start;
mySound.currentTime = t; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T17:29:26.550

我终于找到了解决方案。在所有平台上，以下代码都适用于独立代码，但与生产页面的其余部分结合使用时，在 iOS（甚至是 iOS 6.1）上会失败：

```
audioSprite = document.createElement('audio');
audioSprite.setAttribute("src","/foo/bar/file.xxx"); 
```

其中 xxx 是 mp4、ogg、wav 或 mp3，具体取决于浏览器可以处理的内容。

将这两行更改为 - 并保持其他所有内容相同 - 在生产页面上的 iOS 上进行以下工作：

```
audioSprite = new Audio('http://example.com/foo/bar/file.xxx'); 
```

我仍然不知道为什么第二个版本有效而​​第一个版本无效。

# javascript - enquire.js 在 IE9 中没有响应

> ID：14541518
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:00:10.403
> 
> 标签：javascript, responsive-design, enquire.js

我正在按照附件运行一个非常简单的 enquire.js 测试，发现它没有得到 IE9 的响应。其他几个浏览器响应良好（FF、Chrome、Safari）。我已经在 IE9 中测试了来自 GITHUB 的测试套件，它运行良好——所以我一定遗漏了一些东西。任何帮助表示赞赏！

```
<!doctype html>
<html>
 <head>
  <meta charset="utf-8">
  <title>enquire.js test</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
</head>
<body>
 <div id="frame">hello</div>
 <script src="js/libs/jquery.1.7.1.js"></script>
 <script src="../dist/enquire.js"></script>
 <script>
  $(document).ready(function(){
enquire.listen(50);
enquire.register("screen and (max-width: 1000px)",
      {
       match : function(){
  $("#frame").css("background-color","#f00");
       },     
       unmatch : function(){
  $("#frame").css("background-color","#0f0");
 },    
     });
   });
 </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T20:34:03.230

IE9 does not support the [`matchMedia` API](http://caniuse.com/#search=matchmedia) so you have to include a [polyfill](http://wicky.nillia.ms/enquire.js/#legacy-browsers) to get it to work. You can add the polyfill to the page however you like, providing it's loaded before enquire. Personally I use Modernizr to conditionally load polyfills, but that's personal preference.

Hope that helps

# c++ - 是否可以编写c ++模板/宏来检查两个函数是否具有相同的签名

> ID：14541519
> 
> 赞同：4
> 
> 时间：2013-01-26T21:00:16.113
> 
> 标签：c++, templates, c-preprocessor, sfinae

是否可以编写 c++ 模板/宏来检查两个函数是否具有相同的签名（返回类型和参数列表）？

这是我想如何使用它的一个简单示例：

```
int foo(const std::string& s) {...}
int bar(const std::string& s) {...}

if (SAME_SIGNATURES(foo, bar))
{
    // do something useful... make Qt signal-slot connection for example...
}
else
{
    // signatures mismatch.. report a problem or something...
} 
```

那么它有可能以某种方式还是只是一个白日梦？

PS 其实我对 c++ 2003 标准很感兴趣。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-26T21:02:43.520

### C++11 解决方案

无需自己编写任何模板。

您可以`decltype`使用[`std::is_same`](http://en.cppreference.com/w/cpp/types/is_same)：

```
if (std::is_same<decltype(foo),decltype(bar)>::value )
{
    std::cout << "foo and bar has same signature" << std::endl;
} 
```

这里`decltype`返回在这种情况下为函数的表达式的*类型*[`std::is_same`](http://en.cppreference.com/w/cpp/types/is_same)，并比较两种*类型*，`true`如果两者相同则返回，否则返回`false`。

* * *

### C++03 解决方案

在 C++03 中，您没有`decltype`，因此您可以将重载函数模板实现为：

```
template<typename T>
bool is_same(T,T) { return true; }

template<typename T, typename U>
bool is_same(T,U) { return false; } 
```

现在您可以将其用作：

```
if (is_same(foo, bar))
{
    std::cout << "foo and bar has same signature" << std::endl;
} 
```

现在在这种情况下`is_same`是一个函数模板，而不是类模板。所以它是在**运行**时而不是编译时评估的。所以这会给出错误：

```
int a[is_same(foo,bar) ? 10 : 20]; //error (in Standard C++03)
                                   //the size must be known at compile-time! 
```

但是，如果您需要在编译时了解它，那么您必须做更多的工作，并将功能实现为：

```
typedef char same[1];
typedef char different[2];

template<typename T>
same& is_same_helper(T,T);  //no need to define it now!

template<typename T, typename U>
different& is_same_helper(T,U); //no definition needed!

#define is_same(x,y)   (sizeof(is_same_helper(x,y)) == sizeof(same)) 
```

现在将其用作：

```
if (is_same(foo, bar))
{
    std::cout << "foo and bar has same signature" << std::endl;
} 
```

您也可以在编译时使用它。所以你可以写它：

```
int a[is_same(foo,bar) ? 10 : 20]; //okay 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T21:25:59.007

像这样的东西怎么样：

```
#include <iostream>

void a(int)
{ }

void a2(int)
{ }

void b(float)
{ }

struct true_type
{ enum { value = 1 }; };

struct false_type
{ enum { value = 0 }; };

template <typename T, typename U>
false_type
is_same_sig (T, U)
{ return false_type (); }

template <typename T>
true_type
is_same_sig (T, T)
{ return true_type (); }

int
main ()
{
  std::cout << is_same_sig (a, a2).value
            << is_same_sig (a, b).value
            << "\n";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T21:14:45.123

这是另一个适用于 C++03 的替代解决方案：

```
#include <iostream>

using namespace std;

template<typename F1, typename F2>
bool same_signature(F1 const&, F2 const&)
{
    return false;
}

template<typename F>
bool same_signature(F const&, F const&)
{
    return true;
}

void test1(std::string, int) { }
void test2(std::string, int) { }
void test3(std::string, double) { }

int main()
{
    cout << same_signature(test1, test2);
    cout << same_signature(test1, test3);
} 
```

# javascript - 如何连续删除 Firefox 中的 DOM 节点？

> ID：14541523
> 
> 赞同：0
> 
> 时间：2013-01-26T21:00:27.233
> 
> 标签：javascript, firefox, removechild

我正在尝试从 Firefox 中的 DOM 中删除除法元素（模式窗口）。

我第一次删除模态窗口；一切正常。当我第二次打开窗口并尝试将其移除时；这没用。

具体来说，我收到一条错误消息，指出找不到模态窗口的父元素。

父元素是 document.body，我尝试使用 parentNode.removeChild() 和 parentNode.replaceChild()。但是，我在 Chrome 或 Internet Explorer 8 中没有任何问题。

从 DOM 中删除节点的正确/防弹方法是什么？

的HTML：

```
<body>

<!--The modal window:!-->

<div id="modalwin"></div>

<!--An overlay division stacked behind the
 modal window using CSS z-index: !-->

<div id="uiOverlay"></div>

<!--The listener:!-->

<a href="#" onClick='Delete(modalwin); Delete(uiOverlay); return false;' />

</body> 
```

* * *

Javascript

```
Delete: function (elem) {

        if (!elem) {

            return false;
        }
        var blank = document.createTextNode(' ');

        try {

            var ref = elem.parentNode.replaceChild(blank, elem); 

        } catch (err) {

           elem.style.display = "none";
        }

      //  return true;
    }, 
```

* * *

萤火虫错误

NotFound Error: Node was not found（未找到的节点是document.body/模态窗口划分的父节点）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:03:08.293

删除元素后，它仍然存在，但没有父节点。它可以附加到其他地方，或者只是丢弃并留给垃圾收集器进行清理。

因此，一旦您调用`Delete`该元素一次，再次调用它将尝试删除已删除的节点，但会失败。

# ruby-on-rails - 排序结果 - 太阳黑子轨道

> ID：14541528
> 
> 赞同：1
> 
> 时间：2013-01-26T21:00:51.870
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sunspot, sunspot-rails

我有两个模型，`School`模型和`Price`模型。每个学校都有价格。现在我得到了我想要的结果，但我喜欢实现一个排序功能，对学校的最高价格和最低价格进行排序。

**学校控制器：**

```
class SchoolsController < ApplicationController
def index
 @query = params[:search]
 @search = School.search(:include => [:price] do 
   fulltext params[:search]
     paginate :page => params[:page], :per_page => 7
   end
 @results = @search.results
end
end 
```

**学校模式：**

```
class School < ActiveRecord::Base
 has_one :price
 # sunspot search
  searchable do
   text :name, :locality
  end
end 
```

**索引 - 视图**

```
<ul>
   # Cheapest price
   <li><span class="label label-ord">Show cheapest price <%= @query %></span></li>
   # Highest price
   <li><span class="label label-ord">Show highest price <%= @query %></span></li>
</ul>
<% for result in @results %>
   <tr>
    # School name, from the school-model
    <td><h3><%= link_to result.name, result %></h3></td>
    # School price, from the price-model
    <td><h3><%= result.prices.min %> kr</h3></td>
   </tr>
<% end %> 
```

如何排序最高价和最低价；我应该使用方面还是方法？我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T22:32:37.333

我不太了解太阳黑子，所以我在这里有点猜测......请考虑以下内容作为线索或建议，因为我绝对不确定这是否会奏效。

第一步是索引每所学校的价格：

```
class School < ActiveRecord::Base
  has_many :prices

  searchable do
    text :name, :locality
    double :price do
      # 'value' is just an example, use the relevant field on the price object
      price.value if price.present? 
    end
  end
end 
```

然后重新索引。现在您可以订购您的搜索：

```
 @search = School.search( include: [:prices] ) do 
   fulltext params[:search]
   paginate page: params[:page], per_page: 7
   order_by :price, :asc # or use any param of your choice, 
                         # returned by a select tag for example
 end 
```

**更新**

您可以将此逻辑粘贴在类方法中。

```
class School < ActiveRecord::Base
  def self.custom_search( text, page, order = :asc )
    search( include: [:prices] ) do 
      fulltext text
      paginate page: page, per_page: 7
      order_by :price, order
    end
  end
end 
```

然后调用：

```
School.custom_search params[:search], params[:page]
# or :
School.custom_search params[:search], params[:page], :desc 
```

# linux - 使用 在用户程序中，或 在驱动程序模块代码中...有关系吗？

> ID：14541536
> 
> 赞同：13
> 
> 时间：2013-01-26T21:02:00.510
> 
> 标签：linux, linux-kernel, linux-device-driver

我正在开发一个设备驱动程序模块和相关的用户库来处理`ioctl()`调用。该库获取相关信息并将其放入一个结构中，该结构被传递到驱动程序模块并在那里解包然后处理（我省略了很多步骤，但这是总体思路）。

`ioctl()`通过is`uint32_t`类型通过结构传递的一些数据。我发现该类型是在`<stdint.h>`AND中定义的`<linux/types.h>`。到目前为止，我一直在使用`<linux/types.h>`它来定义该值，包括在用户库中。但是我知道`<linux/*.h>`在用户空间中使用库是一种不好的形式，所以如果我删除它们并`<stdint.h>`改用，那么当我的驱动程序模块包含结构定义时，它也必须包含在内`<stdint.h>`。

在我看来，重点`<linux/types.h>`是在内核文件中定义类型，所以我不确定这是否意味着`<stdint.h>`在那里使用是个坏主意。我还发现，当尝试使用 编译我的驱动程序模块时`<stdint.h>`，我会收到关于不会消失的重新定义的编译错误，即使我替换了`<linux/types.h>`with的所有实例`<stdint.h>`（并将其放在包含顺序的顶部）。

1.  在用户空间代码中使用 linux/*.h 包含是一个坏主意吗？
2.  `<stdint.h>`在内核空间代码中使用是一个坏主意吗？
3.  如果这两个问题的答案都是肯定的，那么我该如何处理包含的结构`uint32_t`由用户库和驱动程序模块共享的情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T11:27:01.473

> 1.  在用户空间代码中使用 linux/*.h 包含是一个坏主意吗？

是的，通常。典型的情况是您应该使用 C 库头文件（在这种情况下，`stdint.h`和朋友），并通过这些用户空间类型与 C 库接口，并让库通过内核类型处理与内核的对话。

不过，您的情况并不典型。在您的情况下，您正在*编写驱动程序库*。因此，您应该使用 . 向用户空间提供接口`stdint.h`，但在`linux/*.h`与内核驱动程序接口时使用标头。

所以在你的情况下，答案是否定的。

> 1.  在内核空间代码中使用 stdint.h 是个坏主意吗？

绝对是的。

另见： http: [//lwn.net/Articles/113349/](http://lwn.net/Articles/113349/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-13T07:29:44.877

**Linux 内核中的固定长度整数**

Linux 内核已经有您可能感兴趣的固定长度整数。在 v4.9 下`include/asm-generic/int-ll64.h`：

```
typedef signed char s8;
typedef unsigned char u8;

typedef signed short s16;
typedef unsigned short u16;

typedef signed int s32;
typedef unsigned int u32;

typedef signed long long s64;
typedef unsigned long long u64; 
```

LDD3 也有一章关于数据大小：[https ://static.lwn.net/images/pdf/LDD3/ch11.pdf](https://static.lwn.net/images/pdf/LDD3/ch11.pdf)

LDD3 在那里提到，最好的`printk`策略是强制转换为具有正确符号的可能的最大整数：`%lld`或`%llu`. 在格式化核心`%ju`下显示为不可用。`printk``lib/linux/vsprintf.c`

# html - 选择选项打开新的文本框

> ID：14541541
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:02:37.860
> 
> 标签：html, forms, select, textbox

我想要一个打开相应文本框的选择选项。

假设这些是我的选择：

```
<select id="contact">
  <option value="email">Email</option>
  <option value="phone">Phone</option>
</select> 
```

当您选择电子邮件选项时，我希望它在其下方显示一个文本框（以前不存在），上面写着请输入您的电子邮件。

或者

当您选择电话选项时，我希望它在其下方显示一个文本框（以前不存在），上面写着请输入您的电话号码。

我不希望同时显示“输入电子邮件”和“输入电话号码”文本框。我希望他们选择打开哪一个并输入他们的联系信息。

我目前有这个，但不知道里面还有什么......请帮忙！

```
$('#contact').change(function() {
       if ($(this).val() === 'email') {
           //show email
           //hide phone

        } else {
            //hide email
           //show phone
        }
}); 
```

谢谢，乍得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T18:05:01.527

我有类似的要求，解决方案是：

```
<HTML>
<BODY>
<form name="myform">
<table>
<tr>
<td>
<select name="one" onchange="if (this.value=='other')   {this.form['other'].style.visibility='visible'}else     {this.form['other'].style.visibility='hidden'};">
<option value="" selected="selected">Select...</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="other">Other</option>
</select>
<input type="textbox" name="other" style="visibility:hidden;"/>
</td>
</tr>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T17:33:41.897

想通了，为此使用了以下javascript：

```
<script type="text/javascript">
function CheckContact(val){
 var element=document.getElementById('email');
 if(val=='email')
   element.style.display='block';
 else
   element.style.display='none';

 var element=document.getElementById('sms');
 if(val=='sms')
   element.style.display='block';
 else
   element.style.display='none';
}
</script> 
```

然后有这个形式：

```
<select name="contactinfo" id="contactinfo" onchange="CheckContact(this.value);">
  <option>Select Contact Option</option>
  <option value="email">Email</option>
  <option value="sms">Text (SMS)</option>
</select><br />
<div id="email" style="display: none;">Enter Email: <input type="text" name="email" /><br /></div>
<div id="sms" style="display: none;">Enter Cell Number: <input type="text" name="sms" /><br /></div> 
```

# python - TypeError：“类型”对象没有属性“__getitem__”

> ID：14541542
> 
> 赞同：3
> 
> 时间：2013-01-26T21:02:39.057
> 
> 标签：python, python-2.7, root-framework

尝试运行`rmakeprofile`命令时，我不断收到错误消息。我收到一条错误消息，说“类型”对象没有属性“__getitem__”。

```
from array import array
from ROOT import gROOT, TCanvas, TProfile, TGraph

class Data(object):
    def __init__(self, s):
        self.p = TProfile()
        self.data = []
        for line in s:
            if not line.startswith("#"):    #Removes Commented lines
                columns = line.split(',')   #Splits into Columns
                if columns:
                    datum = {
                          "threshold" : float(columns[1]),
                          "count" : float(columns[2]),
                          "rate" : float(columns[2]) /float(columns[0]),
                          "scantime" : float(columns[0])
                          }
                    self.data.append(datum)
                    print columns[1], float(columns[2])/float(columns[0])

    def rmakeprofile(self, data, xval, yval, noBins):
        self.a = array('d')
        for datum in data:
            self.a.append(float(datum[xval]))
        self.p = TProfile('p','',noBins,min(self.a),max(self.a))
        for datum in  data:
            self.p.Fill(datum[xval],datum[yval])
        return self.p 
```

这是回溯：

```
p = d.rmakeprofile(data,"threshold","rate",13)

Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "ray.py", line 27, in rmakeprofile
self.a = array('d')
TypeError: 'type' object has no attribute '__getitem__' 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-02-22T10:18:06.140

尝试使用以下替换。

```
 import numpy as np
    self.a = np.asarray(['d']) 
```

甚至这也有效

```
 import numpy as np
    self.a = np.asarray('d') 
```

# eclipse - 无法用 Eclipse 编译 Lucene 项目

> ID：14541545
> 
> 赞同：0
> 
> 时间：2013-01-26T21:02:51.273
> 
> 标签：eclipse, path, lucene, indexing

这是我的代码：

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import org.apache.lucene.index.CorruptIndexException;

public class Main 
{
    public static void main()
    {
        //Index index = new Index();
        String[] titleAndContent = parseFile("files/methode.txt");
        Index index = new Index("files",null);
        try 
        {
            index.openIndex(true);
            index.addDocument(titleAndContent[0], titleAndContent[1], "files/methode.txt");
        } 
        catch (CorruptIndexException e) 
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
        catch (IOException e) 
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    public static String[] parseFile(String path)
    {
        String[] titleAndContent = new String[2];
        File file = new File(path);
        try 
        {
            FileReader fr = new FileReader(file); 
            BufferedReader br = new BufferedReader(fr); 
            String line = new String();
            String content = new String();
            try 
            {
                while((line = br.readLine()) != null) 
                { 
                     if (line.substring(0,min(6,line.length())).equals("title:"))
                     {
                         titleAndContent[0] = line.substring(6,line.length());
                     }
                     else
                     {
                         if (line.substring(0,min(8,line.length())).equals("content:"))
                         {
                             content += line.substring(8,line.length())+"\n";
                         }
                         else
                         {
                             content += line+"\n";
                         }
                     }
                }
            } 
            catch (IOException e1) 
            {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            titleAndContent[1] = content;
            try 
            {
                fr.close();
            } 
            catch (IOException e) 
            {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        } 
        catch (FileNotFoundException e) 
        {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return titleAndContent;
    }

    public static int max (int a, int b)
    {
        if (a<b)
        {
            return b;
        }
        return a;
    }

    public static int min (int a, int b)
    {
        if (a<b)
        {
            return a;
        }
        return b;
    }
} 
```

问题是，我无法在 Eclipse 下编译我的 Lucene 项目。它不断告诉我：

```
ERROR: index path not specified

Usage: java org.apache.lucene.index.CheckIndex pathToIndex [-fix] [-segment X] [-segment Y]

  -fix: actually write a new segments_N file, removing any problematic segments
  -segment X: only check the specified segments.  This can be specified multiple
              times, to check more than one segment, eg '-segment _2 -segment _a'.
              You can't use this with the -fix option

**WARNING**: -fix should only be used on an emergency basis as it will cause
documents (perhaps many) to be permanently removed from the index.  Always make
a backup copy of your index before running this!  Do not run this tool on an index
that is actively being written to.  You have been warned!

Run without -fix, this tool will open the index, report version information
and report any exceptions it hits and what action it would take if -fix were
specified.  With -fix, this tool will remove any segments that have issues and
write a new segments_N file.  This means all documents contained in the affected
segments will be removed.

This tool exits with exit code 1 if the index cannot be opened or has any
corruption, else 0. 
```

我**尽一切**努力让它工作，正如整个网络所说，我用

```
-ea:org.apache.lucene... pathToIndex -fix 
```

作为编译的参数。但是无论我放什么而不是 pathToIndex，它一直在告诉我

```
Unexpected argument pathToIndex (or whatever instead) 
```

我怎样才能得到这个f...项目的工作？先感谢您。

编辑：当然我已经导入了所有的 Lucene JAR。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:44:47.937

实际上，我通过在其中创建一个简单的 Main 类和一个 main 方法来重新启动项目，并尝试立即编译它。这次它工作得很好。请注意，在 Eclipse 中编译之前，您应该在屏幕选项卡上显示 Main 类。

# ruby - if/else 再次启动函数

> ID：14541549
> 
> 赞同：0
> 
> 时间：2013-01-26T21:03:16.340
> 
> 标签：ruby, if-statement

在`else`用户没有输入`1`或`2`的地方，脚本应该在显示错误消息后重新开始。我怎样才能做到这一点？

```
 puts "Do you want to calculate celcius to fahrenheit (1) or fahrenheit to celcius(2)"
input = gets

if input == 1
    puts "Please enter degrees in Celcius."
    celcius = gets
    fahrenheit = (celcius.to_i * 9 / 5) + 32
    print "The result is "
    print fahrenheit
    puts "."
elseif input == 2
    puts "Please enter degrees in Fahrenheit."
    fahrenheit = gets
    celcius = (fahrenheit.to_i / 9 * 5) - 32
    print "The result is:"
    print celcius
    puts "."
else
    puts "Please enter option 1 or 2"
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:17:27.430

您需要将整个事物包装[在一个`while`循环](http://www.techotopia.com/index.php/Ruby_While_and_Until_Loops)中并将变量初始化`input`为一个值，例如`nil`.

循环的`while`条件应该检查​​值是 1 还是 2，并且可能需要将其转换为整数，`.to_i`因为`gets`将返回一个字符串。

```
# initialize to nil
input = nil

# Check if the current value (integer) is 1 or 2
while !([1,2].include?(input))
  puts "Do you want to calculate celcius to fahrenheit (1) or fahrenheit to celcius(2)"

  # Convert the string to an int after getting it as input
  input = gets.to_i

  if input == 1
    puts "Please enter degrees in Celcius."
    celcius = gets
    fahrenheit = (celcius.to_i * 9 / 5) + 32
    print "The result is "
    print fahrenheit
    puts "."
  # elsif here, not elseif!!
  elsif input == 2
      puts "Please enter degrees in Fahrenheit."
      fahrenheit = gets
      celcius = (fahrenheit.to_i / 9 * 5) - 32
      print "The result is:"
      print celcius
      puts "."
  else
      puts "Please enter option 1 or 2"
  end
end 
```

事实上，在测试否定条件时`while`，使用`until`循环（Ruby 与许多其他语言不同）比使用循环更具可读性：

```
until [1,2].include?(input)
  ...
end 
```

这`[1,2].include?(input)`是一种更流畅的写作方式

```
 if input == 1 || input == 2 
```

...这很容易扩展为数组中的其他值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T02:33:22.533

这就是它使用一个函数。

```
puts "Do you want to calculate celcius to fahrenheit (1) or fahrenheit to celcius(2)"
def convert
    input = gets
    if input == 1
        puts "Please enter degrees in Celcius."
        celcius = gets
        fahrenheit = (celcius.to_i * 9 / 5) + 32
        print "The result is "
        print fahrenheit
        puts "."
    elseif input == 2
        puts "Please enter degrees in Fahrenheit."
        fahrenheit = gets
        celcius = (fahrenheit.to_i / 9 * 5) - 32
        print "The result is:"
        print celcius
        puts "."
    else
        puts "Please enter option 1 or 2"
        convert()
    end
end 
```

如果 input != (2 || 1) 也可以工作。

# android - 如何在 android 中使用 X,Y 坐标

> ID：14541552
> 
> 赞同：1
> 
> 时间：2013-01-26T21:04:02.213
> 
> 标签：android

我是 android 新手，我正在尝试使用触摸屏将我的绘图定位在正确的坐标上。当我触摸屏幕时，我获得坐标（x，y），但是当我按下按钮绘制圆圈时，它会在我触摸的点下方的位置绘制圆圈。我使用 relativeLyout 作为我的布局，我给了它一个 ID 作为“布局”，我用它在我的 java 类中引用它。我认为这是因为我正在使用 addView 在相同的布局上绘制。我尽我所能纠正它但不能。（点击按钮后画出圆圈，但不在我想要的位置，它低于我触摸的点）有人可以帮助我吗？这是我的代码。

```
public class MyView extends View{

        float x ;
    float y ;
    int radius = 20;

    public MyView(Context context, float x, float y){

        super(context);
        this.x = x;
        this.y = y;

    }   //end constructor

    public void onDraw(Canvas canvas){
        Paint paint = new Paint();
        paint.setColor(Color.BLUE);
        paint.setAntiAlias(true);

        canvas.drawCircle(x, y, radius, paint);

    }   //end onDraw

}   //end class MyView 
```

这是我的主要课程：

```
public class ButtonClickActivity extends Activity implements OnClickListener{

    RelativeLayout laying;
    Button button;
    MyView myView;

    private static float x=100;
    private static float y=100;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_button_click);

        laying = (RelativeLayout) findViewById(R.id.layout);
        button = (Button) findViewById(R.id.circle);

        //set listeners
        button.setOnClickListener(this);

    }   //end onCreate

    public void onClick(View view){
        switch(view.getId()){
        case R.id.circle:

        myView = new MyView(this, x, y);
        laying.addView(myView);} 
```

这是触摸事件

```
public boolean onTouchEvent(MotionEvent event){

        int action = event.getAction();

        //get the type of action
        switch(action){

        case MotionEvent.ACTION_DOWN:   //you have touch the screen
            x =  event.getX();
            y =  event.getY();
                       break
                 }
} 
```

这是布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="center"
    android:id="@+id/layout" >

    <Button 
        android:id="@+id/circle" 
        android:layout_alignParentBottom="true"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight = "1"
        android:text="Circle"/>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:16:03.233

你错过的是视图的大小。你的自定义视图不知道圆圈需要多少空间，默认是换行内容，那么最小尺寸是多少呢？没错：0。

这就是为什么你什么都看不到的原因。要么从视图外部设置大小，要么在视图内以某种方式自己测量它并告诉父视图视图需要什么大小（然后检查父视图给你的大小并使用它）。

阅读[此处](http://developer.android.com/training/custom-views/index.html)了解有关自定义视图的更多信息。

顺便说一句，不建议在 onDraw 中创建绘画，至少不要以每次调用时都重新创建它的方式。

# c - 继续 while 循环，直到 char == EOF

> ID：14541559
> 
> 赞同：3
> 
> 时间：2013-01-26T21:04:37.193
> 
> 标签：c, string

```
while( (c = fgetc(stdin)) != EOF ){
    count++;
    if (count == lineLen - 1){
        moreChars = (char*) realloc(line, lineLen *=2);

        if(moreChars == NULL){
            puts("Error allocating for moreChars.");
            free(moreChars);
            exit(-69);
        }
        else
            line = moreChars;
    }
    line[count - 1] = c;
} 
```

那是我的代码。我的问题是，当用户输入 (ctrl + d) 结束循环时，他们必须输入两次，即结束循环用户类型 (ctrl+d)(ctrl+d)。

样本输入：

> 嗨，你们好 (ctrl+d) (ctrl+d)

理想输入：

> 嗨，你好（ctrl+d）

为了更清楚：

我希望用户只需输入 (ctrl+d) 一次即可结束循环，并且无法弄清楚为什么用户必须输入 (ctrl+d)(ctrl+d) 才能结束循环。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:09:02.743

如何`c`定义？fgetc() 返回一个 int，EOF 是一个 int。如果 c 是一个字符，它们将不匹配。

# javascript - Javascript - 访问不同文件中的命名空间

> ID：14541561
> 
> 赞同：-2
> 
> 时间：2013-01-26T21:05:00.073
> 
> 标签：javascript, performance, node.js, namespaces

我可以在 node.js 中做到这一点

```
var module = require('../path/module')
module.functionname() 
```

所以我想我想在客户端 Javascript 中做这件事来稍微组织一些事情。所以我的每个文件现在都有一个命名空间。所以说 login.js 有一个命名空间登录。

我的问题是，ECMAScript 5 中实现这些方面的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:10:19.150

您想要实现的目标可以通过 AMD（异步模块定义）来完成。查看 RequireJS：[http ://requirejs.org/](http://requirejs.org/)

使用 Require.js，您基本上可以定义一组依赖项，让它们异步加载并在所有内容加载好后执行代码：

```
require(['dependency1.js', 'dependency2.js'], function(dep1, dep2) {
  console.log(dep1.functionname())
}) 
```

然后依赖项将使用 require 的 define 方法声明它的功能：

```
define(['a/possible/dependency.js'], function() {
   return {
     functionname: function() { return 1 }
   }
}) 
```

# python - 是否可以检查当前 request.path 的所有子路径是否具有可调用的视图关联？

> ID：14541563
> 
> 赞同：1
> 
> 时间：2013-01-26T21:05:05.717
> 
> 标签：python, pyramid

我正在研究面包屑生成器。它使用 request.path，然后为每个子路径构建一个面包屑。

例子：

```
/blog/articles/view/12345 
```

然后对于每个子路径：

```
/blog/articles/view
/blog/articles
/blog 
```

如果此 URL 后面有可调用的视图（允许不带参数的 GET 方法），则返回 True，否则返回 False

这样我就可以使面包屑中的子路径可点击，以显示那里提供了一些东西。

任何不会调用任何子路径并生成无用代码执行的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T20:53:23.437

不，您必须测试所有路径前缀；路由允许许多任意 URL 成为可能。此外，在混合使用路径谓词的情况下，多个路由可以匹配同一个 URL，并且在它们之间进行选择取决于请求中的其他信息。

要准备面包屑，请在子路径上循环*一次*，并确定每个子路径是否有匹配的视图；最简单的方法是重用`pviews`命令底层的代码；此代码需要当前请求：

```
from pyramid.scripts.pviews import PViewsCommand

pvcomm = PViewsCommand()

urlpath = request.environ['PATH_INFO']
parts = urlpath.split('/')
existing_views = {}

for i in range(1, len(parts)):
    path = '/'.join(parts[:i])
    view = pvcomm._find_view(path, request.registry)
    if view is not None:
        existing_views[path] = view 
```

`existing_views`您现在可以在字典中查找路径前缀。

# php - 向控制器发送 Google API OAuth2 响应

> ID：14541567
> 
> 赞同：-3
> 
> 时间：2013-01-26T21:05:37.117
> 
> 标签：php, codeigniter, google-api, codeigniter-2

我是 CodeIgniter 和 PHP 的新手。Google API 控制台中给出的重定向 URL：

```
Redirect URIs:  http://localhost/testsaav/index.php/main/gmail_invite 
```

以下代码向我显示了请求权限页面。当我点击`Allow Access`它带我去

```
http://localhost/testsaav/index.php/main/gmail_invite?code=4/CXD462cen-oEBe1GaHIH90hjqb2X.QpVsg7mG4AUXaDn_6y0ZQNgaCVLxeAI 
```

我想将它重定向到另一个页面并在那里显示响应。控制器方法

```
function gmail_invites($data)
{
   $this->load->view('socialInvites2',$data);

} 
```

查看实施

```
<?php 
            require_once APPPATH.'libraries/Google_Client.php';
            session_start();
            $client = new Google_Client();
            $client->setApplicationName('Google Contacts PHP Sample');
            $client->setScopes("http://www.google.com/m8/feeds/");
            $client->setClientId('xxx.apps.googleusercontent.com');
            $client->setClientSecret('xxx-xxx');
            $client->setRedirectUri('http://localhost/testsaav/index.php/main/gmail_invite');

            if (isset($_GET['code'])) {
              $client->authenticate();
              $_SESSION['token'] = $client->getAccessToken();
              $redirect = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['PHP_SELF'];
              header('Location: ' . filter_var($redirect, FILTER_SANITIZE_URL));
            }

            if (isset($_SESSION['token'])) {
             $client->setAccessToken($_SESSION['token']);
            }

            if (isset($_REQUEST['logout'])) {
              unset($_SESSION['token']);
              $client->revokeToken();
            }

            if ($client->getAccessToken()) {
              $req = new Google_HttpRequest("https://www.google.com/m8/feeds/contacts/default/full");
              $val = $client->getIo()->authenticatedRequest($req);
              //$xml = simplexml_load_string($val->getResponseBody());
              //$result = $xml->xpath('//gd:email');

              /*foreach ($result as $title) {
                echo $title->attributes()->address . "<br>";
              }*/
              // The contacts api only returns XML responses.
              $response = json_encode(simplexml_load_string($val->getResponseBody()));
              //print "<pre>" . print_r(json_decode($response, true), true) . "</pre>";

              // The access token may have been updated lazily.
              $_SESSION['token'] = $client->getAccessToken();
            } else {
              $auth = $client->createAuthUrl();
            }

            print "<a class='facebook-button' id='facebookbutton' href='$auth'>
            <span class='fb-button-left'></span>
            <span class='fb-button-center'>Invite GMail Friends</span>
            <span class='fb-button-right'></span></a>"; ?>
            <br/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:02:05.403

为什么你的视图中有所有的 php 代码？这不是 MVC 的工作方式。

逻辑代码应该保存在您的控制器中，而不是您的视图中。我建议您使用 Codeiginter OAuth2 库，因为来自 Google 的 OAuth2 库的原始代码并不意味着与 Codeiginter 或任何其他特定的 MVC 框架兼容。例如你可以使用这个：[https ://github.com/philsturgeon/codeigniter-oauth2](https://github.com/philsturgeon/codeigniter-oauth2)

您将被重定向到正确的控制器，因为此处设置了 url：

```
$client->setRedirectUri('http://localhost/testsaav/index.php/main/gmail_invite'); 
```

还要看看 Codeigniter 的重定向方法： `redirect('somecontroller/some_method')`

# git - 如何查看 git 中的差异是否是二进制文件的添加/删除？

> ID：14541568
> 
> 赞同：3
> 
> 时间：2013-01-26T21:05:40.027
> 
> 标签：git, text-parsing

我的差异看起来像：

```
--- a/binarytest copy.png
+++ /dev/null
@@ -1,863 +0,0 @@\n-8950 4e47 0d0a 1a0a 0000 000d 4948 4452
-0000 00c8 0000 00c8 0803 0000 009a 865e
-ac00 0000 0970 4859 7300 000b 1300 000b
-1301 009a 9c18 0000 0a4f 6943 4350 5068
-6f74 6f73 686f 7020 4943 4320 7072 6f66
-696c 6500 0078 da9d 5367 5453 e916 3df7
-def4 424b 8880 944b 6f52 1508 2052 428b
-8014 9126 2a21 0910.... 
```

这基本上是删除二进制文件。我如何解析它以始终知道二进制文件已被删除？

我正在尝试查看它是否是已删除的二进制文件而不是文本文件。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T23:13:39.103

我只是做了一些简单的检查。

当我添加一个删除的二进制文件，然后`git diff HEAD^`我得到如下结果：

```
diff --git a/junk.bin b/junk.bin
deleted file mode 100644
index 0a3970d..0000000
Binary files a/junk.bin and /dev/null differ 
```

然后，当我删除一个非二进制文件并执行相同操作`git diff HEAD^`时，我得到以下结果：

```
diff --git a/text.txt b/text.txt
deleted file mode 100644
index a496efe..0000000
--- a/text.txt
+++ /dev/null
@@ -1 +0,0 @@
-This is a text file 
```

我的建议是使用`git diff`命令 VS straight `diff`。Git 会告诉你它是二进制文件还是它的差异不直接（即没有“删除”文本......只是一个删除的文件）。

# javascript - 如何获得路线的长度？

> ID：14541570
> 
> 赞同：0
> 
> 时间：2013-01-26T21:06:09.877
> 
> 标签：javascript, here-api

我怎样才能得到路线的长度？我一直在查看从 a 到 b 的路线的基本代码：

```
// Get the DOM node to which we will append the map
var mapContainer = document.getElementById("mapContainer");
// Create a map inside the map container DOM node
var map = new nokia.maps.map.Display(mapContainer, {
// Initial center and zoom level of the map
center: [52.51, 13.4],
zoomLevel: 7,
// We add the behavior component to allow panning / zooming of the map
components:[new nokia.maps.map.component.Behavior()]
}),
router = new nokia.maps.routing.Manager(); // create a route manager;

// The function onRouteCalculated will be called when a route was calculated
var onRouteCalculated = function (observedRouter, key, value) {
if (value == "finished") {
var routes = observedRouter.getRoutes();

//create the default map representation of a route
var mapRoute = new nokia.maps.routing.component.RouteResultSet(routes[0]).container;
map.objects.add(mapRoute);

//Zoom to the bounding box of the route
map.zoomTo(mapRoute.getBoundingBox(), false, "default");
} else if (value == "failed") {
alert("The routing request failed.");
}
};

/* We create on observer on router's "state" property so the above created
* onRouteCalculated we be called once the route is calculated
*/
router.addObserver("state", onRouteCalculated);

 // Create waypoints
 var waypoints = new nokia.maps.routing.WaypointParameterList();
 waypoints.addCoordinate(new nokia.maps.geo.Coordinate(52.51652540955727,     13.380154923889933));
 waypoints.addCoordinate(new nokia.maps.geo.Coordinate(52.52114106145058,13.40921934080231));

/* Properties such as type, transportModes, options, trafficMode can be
* specified as second parameter in performing the routing request.

* See for the mode options the "nokia.maps.routing.Mode" section in the developer's guide
*/
var modes = [{
type: "shortest", 
transportModes: ["car"],
options: "avoidTollroad",
trafficMode: "default"
}];

// Calculate the route (and call onRouteCalculated afterwards)
router.calculateRoute(waypoints, modes);shortest 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T08:18:17.280

当路由计算成功时，回调函数会保存一个或多个路由的数组。代码：

```
var routes = observedRouter.getRoutes(); 
```

每个都包含一个路线摘要，您可以在其中获得有关路线的有用信息。

代码：

```
alert ("Route Length = " + routes[0].totalLength  + " m.");
alert ("As the crow flies = " + routes[0].waypoints[0].mappedPosition.distance(routes[0].waypoints[1].mappedPosition)  + " m."); 
```

（显然，您需要使用**waypoints.length -1**进行中途停留的计算）

这是您的代码示例，添加了额外的两行，您需要使用自己的[应用程序 ID 和令牌](http://www.developer.nokia.com/Community/Wiki/How_to_Obtain_Your_Own_Nokia_appID_and_Token)才能使其工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- 
    Example from Nokia Maps API Playground, for more information visit http://api.maps.nokia.com
 -->
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7; IE=EmulateIE9"/>
        <base href="http://developer.here.net/apiexplorer/examples/api-for-js/routing/map-with-route-from-a-to-b.html" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <title>Nokia Maps API Example: Add route from A to B</title>
        <meta name="description" content="Routing Manager offers the ability to request a route with various modes between two points"/>
        <meta name="keywords" content="routing, services, a to b, route, direction, navigation"/>
        <!-- For scaling content for mobile devices, setting the viewport to the width of the device-->
        <meta name=viewport content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <!-- Styling for example container (NoteContainer & Logger)  -->
        <link rel="stylesheet" type="text/css" href="http://developer.here.net/apiexplorer/examples/templates/js/exampleHelpers.css"/>
        <!-- By default we add ?with=all to load every package available, it's better to change this parameter to your use case. Options ?with=maps|positioning|places|placesdata|directions|datarendering|all -->
        <script type="text/javascript" charset="UTF-8" src="http://api.maps.nokia.com/2.2.3/jsl.js?with=all"></script>

        <style type="text/css">
            html {
                overflow:hidden;
            }

            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
                width: 100%;
                height: 100%;
                position: absolute;
            }

            #mapContainer {
                width: 100%;
                height: 100%;
                left: 0;
                top: 0;
                position: absolute;
            }
        </style>
    </head>
    <body>
        <div id="mapContainer"></div>

        <script type="text/javascript" id="exampleJsSource">
/*  Set authentication token and appid 
*   WARNING: this is a demo-only key
*   please register on http://api.developer.nokia.com/ 
*   and obtain your own developer's API key 
*/
nokia.Settings.set("appId", "YOUR APP ID"); 
nokia.Settings.set("authenticationToken", "YOUR TOKEN");

// Get the DOM node to which we will append the map

var mapContainer = document.getElementById("mapContainer");
// Create a map inside the map container DOM node
var map = new nokia.maps.map.Display(mapContainer, {
        // Initial center and zoom level of the map
        center: [52.51, 13.4],
        zoomLevel: 7,
        // We add the behavior component to allow panning / zooming of the map
        components:[new nokia.maps.map.component.Behavior()]
    }),
    router = new nokia.maps.routing.Manager(); // create a route manager;

// The function onRouteCalculated  will be called when a route was calculated
var onRouteCalculated = function (observedRouter, key, value) {
        if (value == "finished") {
            var routes = observedRouter.getRoutes();
            //create the default map representation of a route
            var mapRoute = new nokia.maps.routing.component.RouteResultSet(routes[0]).container;
            map.objects.add(mapRoute);

            //Zoom to the bounding box of the route
            map.zoomTo(mapRoute.getBoundingBox(), false, "default");
            alert ("Route Length = " + routes[0].totalLength  + " m.");
            alert ("As the crow flies = "   
                       routes[0].waypoints[0].mappedPosition.distance(
                       routes[0].waypoints[1].mappedPosition)  + " m.");
        } else if (value == "failed") {
            alert("The routing request failed.");
        }
    };

/* We create on observer on router's "state" property so the above created
 * onRouteCalculated we be called once the route is calculated
 */
router.addObserver("state", onRouteCalculated);

// Create waypoints
var waypoints = new nokia.maps.routing.WaypointParameterList();
waypoints.addCoordinate(new nokia.maps.geo.Coordinate(52.51652540955727, 13.380154923889933));
waypoints.addCoordinate(new nokia.maps.geo.Coordinate(52.52114106145058, 13.40921934080231));

/* Properties such as type, transportModes, options, trafficMode can be
 * specified as second parameter in performing the routing request.
 * 
 * See for the mode options the "nokia.maps.routing.Mode" section in the developer's guide
 */
var modes = [{
    type: "shortest", 
    transportModes: ["car"],
    options: "avoidTollroad",
    trafficMode: "default"
}];

// Calculate the route (and call onRouteCalculated afterwards)
router.calculateRoute(waypoints, modes);

        </script>
    </body>
</html> 
```

# eclipse - 无法启动日食

> ID：14541571
> 
> 赞同：-2
> 
> 时间：2013-01-26T21:06:12.263
> 
> 标签：eclipse

启动 Eclipse 时出现以下错误

```
!SESSION 2013-01-26 16:03:57.125 -----------------------------------------------
eclipse.buildId=M20120208-0800
java.fullversion=JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr9-20110726_87724 (JIT enabled, AOT enabled)
J9VM - 20110726_087724
JIT  - r9_20101028_17488ifx17
GC   - 20101027_AA
BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_US
Framework arguments:  -product com.ibm.rational.rsa4ws.product.v80.ide
Command-line arguments:  -os win32 -ws win32 -arch x86 -product com.ibm.rational.rsa4ws.product.v80.ide -clean -consoleLog

!ENTRY org.eclipse.osgi 4 0 2013-01-26 16:04:17.812
!MESSAGE Application error
!STACK 1
java.lang.IllegalStateException: Unable to acquire application service. Ensure that the org.eclipse.core.runtime bundle is resolved and started (see config.ini).
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Unknown Source)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Unknown Source)
    at org.eclipse.equinox.launcher.Main.basicRun(Unknown Source)
    at org.eclipse.equinox.launcher.Main.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:09:55.903

您需要将以下代码添加到 eclipse.ini 的底部：

```
 Dosgi.bundles=org.eclipse.equinox.common@2:start,org.eclipse.update.configurator@3:start,org.e.  clipse.core.runtime@ 
```

如果它仍然不起作用，那么看起来你将不得不重新安装 eclipse。我假设你知道怎么做。一个常见的错误是下载了错误的“位”包。假设您的 PC 是 32 位，但您下载的是 64 位软件包。

# c# - 如何使用VS2012使用的文件夹浏览器

> ID：14541572
> 
> 赞同：-3
> 
> 时间：2013-01-26T21:06:21.293
> 
> 标签：c#, visual-studio-2012, folderbrowserdialog

> **可能重复：**
> [如何配置 OpenFileDialog 来选择文件夹？](https://stackoverflow.com/questions/31059/how-do-you-configure-an-openfiledialog-to-select-folders)

我的应用程序使用 Windows.Forms 中的 FolderBrowserDialog。当您决定将新项目放在哪里时，我更喜欢使用 VS2012 使用的文件夹浏览器。有人可以指出我正确的班级吗？

更具体地说，当你在 VS2012 或 VS2010 中创建一个新项目时，你会得到一个新项目对话框。在该框中，您可以单击浏览按钮来设置项目的位置。打开一个非常漂亮的对话框，让您选择您的文件夹。这是Win 7系统上的图像。

![文件夹浏览器](../Images/15b88291fcb29c1218e3771c78f7e3b0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:52:45.510

您是否在问如何为打开对话框创建默认路径？

在 openFileDialog1 属性中找到一个名为初始目录的字段并放入 C:\\Program Files\\MyFolder。

下次您将使用 Open Dialog 时，它将从 C 盘中的 MyFolder 文件夹开始。

# architecture - 64 位架构与 32 位架构

> ID：14541573
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:06:23.680
> 
> 标签：architecture

为什么有些人认为 64 位架构并不比 32 位架构好，除非计算机的 RAM 超过 4 GB？4 GB有什么特别之处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:16:19.013

这是因为他们不了解 x86 64 位操作系统的其他优势，例如有效的无限虚拟内存和额外的通用寄存器。

4GB 之所以是“神奇数字”，是因为没有 PAE，32 位 x86 操作系统无法处理超过 4GB 的物理内存。即使使用 PAE，在 32 位 x86 操作系统上运行的进程一次也不能处理超过 4GB 的虚拟内存（通常只有 2GB 或 3GB），如果您有那么多物理内存，这将是一个更大的问题。

此外，在可比较的条件下，运行 64 位应用程序的 64 位操作系统将需要比运行 32 位应用程序的 32 位操作系统更多的内存。对于 2GB 或更少，这可能是 64 位操作系统的一个显着缺点。3GB-4GB，可以抵消64位操作系统的优势。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-26T21:09:33.987

32 位不能访问超过 4GB 的内存。所以上面的任何 ram 都是无用的，具有 32 位架构。

# ruby-on-rails - ActiveRecord::JDBCError: 错误: 无法打开扩展控制文件

> ID：14541576
> 
> 赞同：0
> 
> 时间：2013-01-26T21:06:54.073
> 
> 标签：ruby-on-rails, postgresql, jruby

这可能是谷歌界面问题的一个椅子，但我还不能发现任何东西。任何指针都会有所帮助。

JRuby 1.6.8 Rails 3.2.11 Postgres 9.1 Ubuntu 12.04

我有一个 RAILS 迁移：

```
class AddDblinkToEnrollmentsShards < ActiveRecord::Migration
  db_magic :connections => [:enrollments_shard_one, :enrollments_shard_two, :enrollments_shard_three, :enrollments_shard_four]

  def change
    execute "CREATE EXTENSION IF NOT EXISTS dblink WITH SCHEMA public;"
  end
end 
```

我不断收到这个错误：

```
-- execute("CREATE EXTENSION IF NOT EXISTS dblink WITH SCHEMA public;")
  [enrollments_shard_one]   (16.0ms)  CREATE EXTENSION IF NOT EXISTS dblink WITH SCHEMA public;
ActiveRecord::JDBCError: ERROR: could not open extension control file "/usr/share/postgresql/9.1/extension/dblink.control": No such file or directory: CREATE EXTENSION IF NOT EXISTS dblink WITH SCHEMA public;
==  AddDblinkToEnrollmentsShards: Switching connection back ===================
rake aborted!
An error has occurred, this and all later migrations canceled:

ActiveRecord::JDBCError: ERROR: could not open extension control file "/usr/share/postgresql/9.1/extension/dblink.control": No such file or directory: CREATE EXTENSION IF NOT EXISTS dblink WITH SCHEMA public;
arjdbc/jdbc/RubyJdbcConnection.java:195:in `execute'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-jdbc-adapter-1.2.5/lib/arjdbc/jdbc/adapter.rb:217:in `_execute'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-jdbc-adapter-1.2.5/lib/arjdbc/jdbc/adapter.rb:209:in `execute'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `log'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activesupport-3.2.11/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/rails3/abstract_adapter/connection_name.rb:14:in `instrument'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/instrumentation/active_record.rb:32:in `log_with_newrelic_instrumentation'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/method_tracer.rb:240:in `trace_execution_scoped'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/instrumentation/active_record.rb:29:in `log_with_newrelic_instrumentation'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-jdbc-adapter-1.2.5/lib/arjdbc/jdbc/adapter.rb:209:in `execute'
org/jruby/RubyBasicObject.java:1704:in `__send__'
org/jruby/RubyKernel.java:2130:in `send'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:466:in `method_missing'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:438:in `say_with_time'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:438:in `say_with_time'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:458:in `method_missing'
/home/scott/source/unicon/unicon-ttm-sandbox/db/migrate/20130103134257_add_dblink_to_enrollments_shards.rb:5:in `change'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:407:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:407:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in `with_connection'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:389:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/active_record/migration/multi_db_migrations.rb:86:in `migrate_with_db_wrapper'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/active_record/migration/multi_db_migrations.rb:125:in `on_db'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in `with_connection'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/active_record/migration/multi_db_migrations.rb:123:in `on_db'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/active_record/migration/multi_db_migrations.rb:85:in `migrate_with_db_wrapper'
org/jruby/RubyArray.java:1620:in `each'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bundler/gems/db-charmer-f12baa3d23aa/lib/db_charmer/active_record/migration/multi_db_migrations.rb:84:in `migrate_with_db_wrapper'
org/jruby/RubyBasicObject.java:1704:in `__send__'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:528:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:720:in `migrate'
org/jruby/RubyProc.java:258:in `call'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:775:in `ddl_transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/transactions.rb:208:in `transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/method_tracer.rb:491:in `transaction_with_trace_ActiveRecord_self_name_transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/method_tracer.rb:240:in `trace_execution_scoped'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/newrelic_rpm-3.5.6.46/lib/new_relic/agent/method_tracer.rb:486:in `transaction_with_trace_ActiveRecord_self_name_transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:775:in `ddl_transaction'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:719:in `migrate'
org/jruby/RubyArray.java:1620:in `each'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:700:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:570:in `up'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/migration.rb:557:in `migrate'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/gems/activerecord-3.2.11/lib/active_record/railties/databases.rake:179:in `(root)'
org/jruby/RubyProc.java:258:in `call'
org/jruby/RubyArray.java:1620:in `each'
org/jruby/RubyArray.java:1620:in `each'
org/jruby/RubyKernel.java:1097:in `load'
org/jruby/RubyKernel.java:1117:in `eval'
/home/scott/.rvm/gems/jruby-1.6.8@jruby168-unicon/bin/ruby_noexec_wrapper:14:in `(root)' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T04:40:24.190

该`dblink`扩展未与该系统上的主 PostgreSQL 软件包一起安装，因此用户必须单独安装。看评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-14T21:24:30.543

在 CentOS 上：

```
sudo yum install postgres*contrib 
```

登录数据库，运行：

```
CREATE EXTENSION dblink; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-17T20:46:11.943

对于安装了多个 pg 版本的情况，用户还需要通过指定版本来安装 contrib 包：

```
sudo apt-get install postgresql-contrib-9.1 
```

# python - Python：哪个更快：匹配列表或匹配字典？

> ID：14541578
> 
> 赞同：0
> 
> 时间：2013-01-26T21:07:03.307
> 
> 标签：python, list, dictionary, match

我有两个大清单。它们中的每一个都由列表组成：

```
list_1 = [[1, "BMW", "Boston", "01Jan2013"], [37, "Chevrolet", "Denver", "05Jan2013"],
[854, "BMW", "Boston", "01Jan2013"],...]

list_2 = [[1, "Mercedes", "Boston", "01Jan2013"], [37, "Chevrolet", "Denver", "05Jan2013"],
[854, "Toyota", "Boston", "01Jan2013"],...] 
```

内部列表始终具有相同的项目类型。

现在我想使用内部列表的第 1 项、第 3 项和第 4 项将每个内部 in`list_1`与一个 in匹配`list_2`。即：序列号、城市起源和日期。这些键始终与 list_2 相同。中的内部列表`list_1`只能有 0 或 1 个匹配项`list_2`。

最pythonic和最快的方法是什么？我应该将列表转换为字典吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:45:31.580

假设`list_1`不能包含重复项（根据您的评论），您可以将其转换为 a `set`of `tuple`s 而不是列表列表。这样，您可以使用`in`运算符有效地检查某个项目是否在集合中。

您需要使用元组而不是列表，因为列表是可变的（因此不可散列），因此不能将它们放入`set`. 如果您使用 a ，这同样适用`dict`，但 a`set`似乎更适合您的用例（不清楚您将使用什么作为 的键`dict`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:33:18.000

在速度方面，您可能想要使用字典。似乎以一种或另一种方式，您将需要遍历一个列表。字典当然比遍历一个列表要快，所以你可以将至少一个列表变成一个字典。（我在两个单独的列表中测试了以下解决方案，其中包含 200,000 个条目，就像你的一样，我的速度平均为 0.109999 秒。列表远远超出了这个标记。）如果你只是尝试使用列表，你可能不会接近那个或元组，除非您的条目顺序允许您使用 zip 之类的东西。您的序列号似乎是唯一的，因此以下方法可行（通过迭代一个列表，然后将项目 1、3 和 4 [在位置 0、2 和 3] 与字典中的值进行比较）：

```
list_1 = [[1, "BMW", "Boston", "01Jan2013"], [37, "Chevrolet", "Denver", "05Jan2013"],
[854, "BMW", "Boston", "01Jan2013"]]

list_2 = [[1, "Mercedes", "Boston", "01Jan2013"], [37, "Chevrolet", "Denver", "05Jan2013"],
[854, "Toyota", "Boston", "01Jan2013"]]

dict_2 = dict()

for elem in list_2:
    dict_2[elem[0]] = elem[1:]

for item in list_1:
    if dict_2[item[0]][1:] == item[2:]:    # Have to offset the index since dict list only has three elements
        print item

[1, 'BMW', 'Boston', '01Jan2013']
[37, 'Chevrolet', 'Denver', '05Jan2013']
[854, 'BMW', 'Boston', '01Jan2013'] 
```

将第二个列表转换为字典后，您只需遍历一个列表即可获得结果。此解决方案将从您似乎想要的 list_1 返回每个匹配项的整个子列表。如果您想要两个列表中的完整匹配子列表，这将起作用：

```
for item in list_1:
    if dict_2[item[0]][1:] == item[2:]:
        print item, [item[0]] + dict_2[item[0]]

[1, 'BMW', 'Boston', '01Jan2013'] [1, 'Mercedes', 'Boston', '01Jan2013']
[37, 'Chevrolet', 'Denver', '05Jan2013'] [37, 'Chevrolet', 'Denver', '05Jan2013']
[854, 'BMW', 'Boston', '01Jan2013'] [854, 'Toyota', 'Boston', '01Jan2013'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T22:00:56.863

类似于@omz 的解决方案是将列表转换为字典。dict 键是元组`(serial,city,date)`（项目 1、3 和 4），值是另一个字段“make”（项目 2）。然后要匹配它们，只需遍历`list_1`(now `dict_1`) 的键，尝试检索 的相应成员`dict_2`：

```
dict_1 = {(1, "Boston", "01Jan2013"):"BMW", (37, "Denver", "05Jan2013"):"Chevrolet", (854, "Boston", "01Jan2013"):"BMW",...}

dict_2 = {(1, "Boston", "01Jan2013"):"Mercedes", (37, "Denver", "05Jan2013"):"Chevrolet", (854, "Boston", "01Jan2013"):"Toyota",...}

for k in dict_1:
    match = dict_2.get (k, None)
    if match is not None:
        print "Match found:", match
    else:
        print "No match" 
```

自然，当你找到匹配项时你会做什么不会是我写的，但这应该有助于展示你如何找到匹配项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T21:27:49.473

您可以定义一个键函数，指定要比较的字段：

```
def item_key(item):
    return tuple(item[i] for i in [0, 2, 3]) 
```

它应该是可散列的，以便您可以将其用作 dict 键。您可以创建从项目键到项目本身的映射，或者如果不同项目可以共享相同的键，则创建项目列表。

```
key_to_item2 = dict((item_key(item), item) for item in list2) 
```

现在您可以根据字典测试*list1中的每个项目。*

```
for item1 in list1:
    item2 = key_to_item2.get(item_key(item1))
    if item2 is None:
        # no match found
    else:
        # item2 in list2 matches item1 in list1 
```

这种方法可以很容易地调整为使用其他字段进行匹配和支持多个匹配。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-26T21:44:03.527

什么是“最佳”解决方案取决于您想要什么。如果是关于速度，那么根据您输入的大小，字典可能是最好的主意。

如果它是关于清晰和简洁，我认为保留列表并执行以下操作是非常pythonic：

```
result = []
for l1 in list1:
    result.append([l2 for l2 in list2
                   if l1[0] == l2[0] and l1[2] == l2[2] and l1[3] == l2[3]])
    assert(len(result[-1]) in [0,1]) 
```

# xml - VBScript 修改一个元素（许多元素名称相同但属性不同）？

> ID：14541579
> 
> 赞同：0
> 
> 时间：2013-01-26T21:07:14.080
> 
> 标签：xml, xpath, vbscript, filter

我需要编写一个简单的 VBScript 来修改现有的 XML 文件。我能够编写一个 VBScript 来修改一个元素，但我目前遇到的问题是我有多个元素具有相同的元素/标签名称但不同的属性，如下面的 XML 文档示例所示：

```
<MyDoc>
   <Section name="First">
      <....../>
  </Section>
  <Section name ="Second">
     <......>
     <Parameter name="Service" value="MsrNdp.dll"/>
   </Section>
 </MyDoc> 
```

假设我只想将参数“Service”的“值”更改为“LdrXMP.dll”（然后保存）：由于有多个名为“Section”的元素，我将如何指定我要引用属性值=“第二”的元素“部分”？？

到目前为止，我有以下简单的 VBScript 代码：如何调整下面的代码以获得我想要的？谢谢你的帮助。

```
Set xmlDoc = _
  CreateObject("Microsoft.XMLDOM")
xmlDoc.Async = "False"
xmlDoc.Load("C:\Users\Frank\Desktop\MyDoc.xml")
Set colNodes=xmlDoc.selectNodes _
("/MyDoc/Section ")
For Each objNode in colNodes
   objNode.Text = "LdrXMP.dll"
Next
xmlDoc.Save "C:\Users\Frank\Desktop\MyDoc.xml" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:08:55.173

使用引用名称属性、selectSingleNode() 和 getAttributeNode() 的 XPath 搜索表达式，如下所示：

```
 Dim oFS      : Set oFS      = CreateObject("Scripting.FileSystemObject")
  Dim sFSpec   : sFSpec       = goFS.GetAbsolutePathName("..\testdata\xml\so14541579.xml")
  Dim objMSXML : Set objMSXML = CreateObject("Msxml2.DOMDocument.6.0")
  objMSXML.setProperty "SelectionLanguage", "XPath"
  objMSXML.async = False

  objMSXML.load sFSpec

  If 0 = objMSXML.parseError Then
     Dim sXPath : sXPath    = "/MyDoc/Section[@name=""Second""]/Parameter"
     Dim ndFnd  : Set ndFnd = objMSXML.selectSingleNode(sXPath)
     If ndFnd Is Nothing Then
        WScript.Echo sXPath, "not found"
     Else
        WScript.Echo ndFnd.getAttributeNode("value").value
        ndFnd.getAttributeNode("value").value = "abracadabra.dll"
        WScript.Echo objMSXML.xml
     End If
  Else
     WScript.Echo objMSXML.parseError.reason
  End If 
```

输出：

```
MsrNdp.dll
<MyDoc>
        <Section name="First">
                <Parameter name="Service" value="MsrNdp.dll"/>
        </Section>
        <Section name="Second">
                <Parameter name="Service" value="abracadabra.dll"/>
        </Section>
</MyDoc> 
```

# html - 相对于父母的最大高度不起作用

> ID：14541581
> 
> 赞同：4
> 
> 时间：2013-01-26T21:07:18.733
> 
> 标签：html, css, thickbox

我正在尝试将大量内容放入“Thickbox”（Javascript 弹出窗口）中，它几乎可以正常工作，但我无法制作`max-height: 100%;`（相对于父级）和`overflow-y: scroll;`工作。

有两种结果：

1.  它应该尽可能长，没有垂直滚动并且它超出了盒子（太多了）。
2.  它应该是尽可能长的，带有垂直滚动并且它超出了盒子（一点点）。

我只想把它放在盒子里，垂直滚动，我不想让它走出盒子。一旦你看一下 JSFiddle，你就会明白我的意思：http: [//jsfiddle.net/m4aKk/](http://jsfiddle.net/m4aKk/)（最好在大屏幕上观看 - 1600px+）。任何建议都会很棒！

![在此处输入图像描述](../Images/7e2468105032f5f3e1690036b099329d.png)

为什么`height: 100%;`或`max-height: 100%;`不是相对于它的父母？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T21:24:28.497

一种解决方法是制作内盒位置`absolute`。像这样的东西：

```
#TB_ajaxContent {
    width: 440px;
    overflow-x: hidden;
    position: absolute;
    top: 30px;
    bottom: 10px;
} 
```

这应该使内部 div 以您喜欢的方式定位。这是更新的 [小提琴](http://jsfiddle.net/m4aKk/5/)- 注意我已从`height:auto; height:100%`内联样式中删除。

这是让内部 div “与父级一样高”的一个很常见的技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:26:22.253

替换代码中的这一行：

```
<div id="TB_window" style="width: 470px; height: 100%; margin-left: -335px; top: 48px; margin-top: 0px; visibility: visible;"> 
```

只需更改 `height: 314px;`为`height: 100%;`！

# android - ABS 在 4.1 上运行良好，但在 2.2 上运行时抛出异常

> ID：14541597
> 
> 赞同：2
> 
> 时间：2013-01-26T21:09:48.090
> 
> 标签：android, actionbarsherlock

我正在学习如何使用 ABS。该代码在 4.1 上运行良好，但是当我在 2.2 上运行相同的代码时，它抛出异常

这是 MainActivity.java

```
import android.os.Bundle;
import android.support.v4.app.FragmentTransaction;
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.ActionBar.TabListener;
import com.actionbarsherlock.app.SherlockFragmentActivity;

public class MainActivity extends SherlockFragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ActionBar ab = getSupportActionBar();
        ab.setDisplayHomeAsUpEnabled(true);
        ab.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        ab.addTab(ab.newTab().setText("Beauty").setTabListener(new Listner()));
        ab.addTab(ab.newTab().setText("Cookery").setTabListener(new Listner()));
        ab.addTab(ab.newTab().setText("Health").setTabListener(new Listner()));
        ab.addTab(ab.newTab().setText("Relationship").setTabListener(new Listner()));
        ab.addTab(ab.newTab().setText("Yoga Spirituality").setTabListener(new Listner()));
    }

    class Listner implements TabListener {

        public void onTabReselected(Tab tab, FragmentTransaction ft) { }

        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            ft = getSupportFragmentManager().beginTransaction();

            switch (tab.getPosition()) {
                case 0:
                    ft.add(android.R.id.content, new BEAUTYFragment());
                    ft.commit();
                    break;

                case 1:
                    ft.add(android.R.id.content, new COOKERYFragment());
                    ft.commit();
                    break;

                case 2:
                    ft.add(android.R.id.content, new HEALTHFragment());
                    ft.commit();
                    break;

                case 3:
                    ft.add(android.R.id.content, new RELATIONSHIPFragment());
                    ft.commit();
                    break;

                case 4:
                    ft.add(android.R.id.content, new YOGAFragment());
                    ft.commit();
                    break;

                default:
                    break;
            }
        }

        public void onTabUnselected(Tab tab, FragmentTransaction ft) { }
    }
} 
```

这很明显：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.sher"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
            <activity
                android:name=".MainActivity"
                android:label="@string/title_activity_main" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />
                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
    </application>

</manifest> 
```

LogCat 中的错误：

> java.lang.NoClassDefFoundError: com.actionbarsherlock.R$styleable

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:15:36.870

您需要设置 ABS 主题或让您的主题从 ABS 主题扩展。需要处理 ActionBar 的向后兼容性（3.0 之前的设备）

例如

```
<application
  android:icon="@drawable/ic_launcher"
  android:label="@string/app_name"
  android:theme="@style/Theme.Sherlock.Light.DarkActionBar"> 
```

以下是有关[ABS 主题的一些信息](http://actionbarsherlock.com/theming.html)

# javascript - jQuery 和 Ajax - 无法发布

> ID：14541605
> 
> 赞同：0
> 
> 时间：2013-01-26T21:10:54.487
> 
> 标签：javascript, jquery, ajax, post, get

我正在尝试使用已知的用户名和密码登录网站，并从该网站获取该网站上特定用户帐户的一些数据。为此，我正在使用 jQuery 和 Ajax。这是我的代码：

```
$.ajax({
async: false,
cache: false,
type: 'POST',
dataType: 'json',  // json...just for example sake
data: ({
    'login_username': username,
    'secretkey': password
}),
url: 'https://mail.someserver.com/src/redirect.php',
success: function (data) {
    alert("SUCCESS!")
    if (data === '1') {  // server returns a "1" for success
        // success!
        // do whatever you need to do
    } else {
        // fail!
    }
},
error: function (XMLHttpRequest, textStatus, errorThrown) {
    // something went wrong with the request
    alert("Failed!");
} 
```

});

我已经在网络上进行了搜索，并且我知道浏览器不允许跨服务器 ajax 调用以防止安全问题，但我已经尝试使用“jsonp”作为 dataType 无济于事:(

那么，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:14:46.690

确保您`url`没有违反[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)- 也就是说，来自客户端的请求不能从不同域的服务器请求数据（此规则有例外，命名为[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，但这需要您进行更改到您正在与之交谈的服务器/应用程序）。

您的问题的解决方案是从某个服务器端脚本发出请求，然后让您的客户端应用程序根据为 Web 提供应用程序的同一台机器查询该脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T20:38:15.470

我的错不在上面的代码上，我的错是在我的清单文件中（我正在构建一个 Google Chrome 扩展程序）我没有设置适当的权限（https://*）。

对挫折感到抱歉！

# c# - GC 工作正常吗？

> ID：14541607
> 
> 赞同：-4
> 
> 时间：2013-01-26T21:11:07.543
> 
> 标签：c#, .net, memory-management, garbage-collection

> **可能重复：**
> [.NET 垃圾收集在这里无法正常工作？](https://stackoverflow.com/questions/6354671/net-garbage-collection-not-working-properly-here)

我已经测试了以下代码。单击按钮时，将创建对象并将它们添加到列表中。单击另一个按钮时，列表将被清除

GC 正在销毁对象，但内存使用量并没有减少。为什么？有什么不对？

```
public partial class MainWindow : Window
{
    public List<MyModel> MyList;
    public MainWindow()
    {
        MyList = new List<MyModel>();
        InitializeComponent();
    }

    private void button1_Click_1(object sender, RoutedEventArgs e)
    {
        MyList = new List<MyModel>();
        for (int i = 0; i < 1000000; i++)
        {
            MyList.Add(new MyModel { ID = i, Description = "Model Id : " + i.ToString() });
        }
        MessageBox.Show("Complate!");
    }

    private void button1_Click_2(object sender, RoutedEventArgs e)
    {
        MyList.Clear();
        MyList = null;
    }
}

public class MyModel
{
    ~MyModel()
    {
        Console.WriteLine(Description);
    }
    public int ID { get; set; }
    public string Description { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-26T21:52:10.647

假设您拥有一个仓库。您将箱子存放在仓库中。有些盒子是垃圾，所以你会定期把它们扔掉。**仓库的面积并没有变小。**

如果你测量的是提交给进程的内存页总数，那么你测量的不是仓库中的盒子数量，而是仓库的平方英尺。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:15:08.097

.Net 垃圾收集器仅在存在内存压力时运行。在许多程序的正常操作中，内存使用量将不断增加，直到您退出程序，前提是您有足够的 RAM。您可以明确要求它执行 GC，但这仍然只是一个建议。

# multithreading - 方案中的线程暂停/线程恢复

> ID：14541611
> 
> 赞同：1
> 
> 时间：2013-01-26T21:11:33.830
> 
> 标签：multithreading, scheme, racket

我正在编写一个分配方案程序，当用户单击时创建“行星”，并在单击复选框时启动/停止行星相互绕行。我们应该用一个线程来实现它。但是，当我单击复选框时，线程挂起似乎不起作用，但恢复却起作用。

谢谢你的尽心帮助！这是代码：

```
#lang racket

(require racket/gui)
(require racket/block)

;; Small 2d vector library for the Newtonian physics
(define (x v) (vector-ref v 0))
(define (y v) (vector-ref v 1))
(define (x! v value) (vector-set! v 0 value))
(define (y! v value) (vector-set! v 1 value))
(define (v* v value) (vector-map (lambda (x) (* x value)) v))
(define (v+ v w) (vector-map + v w))
(define (v- v w) (vector-map - v w))
(define (v-zero! v) (vector-map! (lambda (x) 0) v))
(define (v-dot v w) (let ((vw (vector-map * v w))) (+ (x vw) (y vw))))
(define (v-mag v) (sqrt (v-dot v v)))
(define sem (make-semaphore))

;; Planet object
(define planet%
  (class object%
(public m p v calculate-force move draw)
(init-field (mass 1)
            (position (vector 0 0 ))
            (velocity (vector 0 0 ))
            (force (vector 0 0 )))
(define (m) mass)
(define (p) position)
(define (v) velocity)
;; Use Newton's law of gravitation.
;; I assume the gravitational constant is one
(define (calculate-force planet-list)
  (v-zero! force)
  (for-each (lambda (other-planet)
              (when (not (equal? this other-planet))
                (let* ((direction (v- (send other-planet p) position))
                       (dist (max 1 (v-mag direction)))
                       (other-mass (send other-planet m))
                       (new-force (v* direction (/ (* mass other-mass) (* dist dist))))
                      )
                  (vector-map! + force new-force))))
            planet-list)
  )
;; Simple Euler integration of acceleration and velocity
(define (move) 
  (let ((acc (v* force (/ 1.0 mass))))
    (vector-map! + velocity acc)
    (vector-map! + position velocity)))
;; Draw a circle 
(define (draw dc) 
  (send dc set-brush brush)
  (send dc set-pen pen)
  (send dc draw-ellipse (x position) (y position) radius radius ))
;; Initialize to random velocity, mass, and color
(x! velocity (random))
(y! velocity (random))
(set! mass (+ 1 (* 10 (random))))
(define radius (* 5 (sqrt mass)))
(define color 
  (let* ((r (random))
         (b (real->floating-point-bytes r 4)))
    (make-object color% (bytes-ref b 0) (bytes-ref b 1) (bytes-ref b 2) )))
(define brush (make-object brush% color))
(define pen (make-object pen% color))
;; Don't forget the super-new!
(super-new)
))
;; Abstract the list-handling for a list of planets
(define planet-list%
  (class object%
(public add-planet calculate-force move draw)
(init-field (planets '()))
(define (add-planet planet)
  (set! planets (cons planet planets)))
(define (calculate-force)
  (for-each (lambda (planet)
              (send planet calculate-force planets))
            planets))
(define (move)
  (for-each (lambda (planet)
              (send planet move))
            planets))
(define (draw dc)
  (for-each (lambda (planet)
              (send planet draw dc))
            planets))
(super-new)
)
  )
(define planet-list (new planet-list%))

;; The GUI
(define frame (new frame% 
               (label "Planets")
               (min-width 120)
               (min-height 80)
               ))
(send frame create-status-line)
(send frame show #t)

(define h-panel
  (new horizontal-panel%
   (parent frame)
   (stretchable-height #f)
   (style '(border))
   (border 2)))

(define run-checkbox
  (new check-box%
   (parent h-panel)
   (label "Run animation")
   (callback
    (lambda (button event)
      (cond [(send run-checkbox get-value)(thread-resume (thread-a))]
            [(not (send run-checkbox get-value)) (thread-suspend (thread-a))]
   )))
    ))

(define my-canvas%
  (class canvas%
(override on-paint on-event)

(define (on-paint)
  (let ((dc (send this get-dc))
        (w (send this get-width))
        (h (send this get-height)))
    (send dc clear)
    (send planet-list draw dc)
    ))
(define (on-event event)
  (when (send event button-down?)
    (let ((x (send event get-x))
          (y (send event get-y)))
      (send frame set-status-text (format "Mouse at ~a ~a" x y))
      (send planet-list add-planet (new planet% (position (vector x y))))

      (send this refresh)))
  )
(super-new)
(send (send this get-dc) set-background (make-object color% 8 8 64))
))

(define canvas
  (new my-canvas%
   (parent frame)
   (style '(border))
   (min-width 640)
   (min-height 480)))

;; planet animator
(define thread-a (lambda ()
(let loop ()
  (sleep/yield .1)
(send planet-list calculate-force)
(send planet-list move)
(send canvas refresh)
  (loop))))

; this creates the thread-a and starts the program

(thread-suspend (thread thread-a)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T22:34:28.173

你能像现在这样工作真是太神奇了。

问题是那`thread-a`不是线程。它不是产生线程的函数。这是一个永远运行的函数，可以移动行星并更新画布。

`(thread-suspend (thread-a))`因此，例如，当您的复选框的回调确实发生时，`thread-suspend`从未真正发生过。调用`thread-a`刚刚开始运行并且永远不会返回。

GUI 没有锁定的原因（如果事件回调没有返回通常会锁定）是`thread-a`定期调用`sleep/yield`，这允许 GUI 事件循环处理更多事件。（这就是为什么我说代码很神奇。）

修复方法是定义`thread-a`为线程本身：

```
(define thread-a
  (thread
    (lambda ()
      (let loop () ....))))
(thread-suspend thread-a) 
```

并将其他引用从更改`(thread-a)`为 just `thread-a`。

# java - 当焦点离开我的 JTable 时，结合“类似 Excel”的行为并更新模型

> ID：14541614
> 
> 赞同：2
> 
> 时间：2013-01-26T21:12:04.417
> 
> 标签：java, swing, focus, jtable, tablecelleditor

我有一个 JTable 功能的请求，它允许数据输入更像是在 Excel 中。如果用户在单元格中键入，则先前的值将被新值替换，并且可以使用箭头键在行和列之间导航。

我找到了几个解决这个问题的方法并实施了一个。

然后给了我一个额外的要求——如果用户在表格外点击，输入数据的单元格就会更新（编辑停止）。

我怀疑我只是遗漏了一些东西，但是我实现这两个要求的尝试都失败了。

1.  我有一个自定义单元格编辑器，可以监听 focusLost 并停止单元格编辑。如果我双击表格然后单击表格外部，这将起作用。但是，如果我只是在单元格中输入了一个数字，则此方法不会运行。

2.  tableMe.setSurrendersFocusOnKeystroke(true); 这 a) 导致我失去了第一次击键 b) 将我置于编辑器中，所以我不能使用左右箭头键移出单元格。

3.  我在桌子上添加了一个 FocusListener。然后，我可以在一个单元格中输入一个数字并导航到另一个单元格，但我永远无法进入编辑器。双击立即停止编辑。我想我可以在“真正”编辑（在编辑器窗口中有光标）和刚刚在单元格中输入数字时发现一些区别。到目前为止我所尝试的（isEditing() 总是出现 true，hasFocus() 总是出现 false）不起作用。

谁能指出我的解决方案？我的尝试如下。我注释掉了错误的开始，但它们在那里，所以你可以看到我尝试了什么。

```
import java.io.*;
import java.util.*;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.table.*;
import java.text.NumberFormat;
import javax.swing.text.JTextComponent;
import javax.swing.border.*;
import javax.swing.BorderFactory;
import javax.swing.border.Border;

class ExcelTableTest extends JFrame
{
    public static final Color activeDark  = new Color(230, 185, 184);
    public static final Color activeLight = new Color(244, 233, 233);

    private MyJTable      tableMe;
    private MyTableModel  modelMe;
    private JTextField    textMe;
    private JScrollPane   scrollTable;

    private String[]   tableHeaders = { "Column 1", "Column 2" };
    private Object[][] tableData    = new Object[ tableHeaders.length ][ 4 ];

    ExcelTableTest()
    {
        setLayout( new BorderLayout() );
        modelMe  = new MyTableModel(tableData, tableHeaders );
        tableMe  = new MyJTable(modelMe);
        tableMe.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        TableColumn column = null;
        for (int i = 0; i < tableHeaders.length; i++)
        {
           column = tableMe.getColumnModel().getColumn(i);
           column.setCellRenderer( new MyCellRenderer()   );
           column.setCellEditor(   new NumberCellEditor() );
        }
        tableMe.setRowSelectionAllowed(false);
//      tableMe.addFocusListener( new MyFocusListener() );
//      tableMe.setSurrendersFocusOnKeystroke(true);

//      modelMe.addTableModelListener(new MyTableModelListener());
        scrollTable = new JScrollPane(tableMe);
        scrollTable.setVerticalScrollBarPolicy(
            ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        scrollTable.setHorizontalScrollBarPolicy(
            ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        scrollTable.setPreferredSize(new Dimension(500,150));

        textMe = new JTextField( 6 );

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        setSize(500,210);
        add(BorderLayout.CENTER, scrollTable );
        add(BorderLayout.SOUTH,  textMe );
        setVisible(true);
    }

    class MyJTable extends JTable
    {
       MyJTable( TableModel model)
       {
          super(model);
       }
//
// Trying to get cells selected when editing starts
       @Override
       public Component prepareEditor(TableCellEditor editor,
                                         int row, int column)
       {
          Component editComponent = super.prepareEditor(editor, row, column);
          if (editComponent instanceof JTextComponent)
          {
             System.out.println( "In prepare editor" );
             ((JTextComponent) editComponent).selectAll();
//           System.out.println( "Requesting Focus" );
//           System.out.println( 
//              ((JTextComponent) editComponent).isFocusable());
//           System.out.println( 
//              ((JTextComponent) editComponent).requestFocusInWindow());
          }
          return editComponent;
       }    
//
// This also works, but end result is the same- when using this, the editor
// does not have focus, so I cannot update the cell just by switching focus
// to another part of the GUI.
//     @Override
//     public boolean editCellAt( int row, int col, EventObject e )
//     {
//        boolean result = super.editCellAt( row, col, e );
//
//        Component editComponent = getEditorComponent();
//        if (  editComponent == null || 
//            !(editComponent instanceof JTextComponent) )
//           return result;
//        if (e instanceof KeyEvent)
//           ((JTextComponent) editComponent).selectAll();
//
//        return result;
//     }
//
    }

    class MyFocusListener implements FocusListener
    {
       @Override
       public void focusGained(FocusEvent e)
       {
          System.out.println("Table has focus");
       }

       @Override
       public void focusLost(FocusEvent e)
       {
          System.out.println("Table lost focus");
          MyJTable        table       = (MyJTable) e.getSource();
          int[]           columns     = table.getSelectedColumns();
//
// I will not be allowing multiple column selection
//
// This is still a problem, as the table IS editing, even though the editor
// does not seem to have focus. This is true whether I am in the case where
// I really have the editor going (in which case the lostFocus of the editor
// nicely cleans things up) or the editor is not really going, and then the
// lostFocus of the editor never triggers.
//        if ( columns.length > 0 && ! table.isEditing() )
          if ( columns.length > 0 )
          {
             TableColumn       tableColumn = table.getColumnModel()
                                                  .getColumn(columns[0]);
             DefaultCellEditor cellEditor  = (DefaultCellEditor)
                                              tableColumn.getCellEditor();
// Does not have focus even when I double click to edit the cell
             if (cellEditor != null && ! cellEditor.getComponent().hasFocus() );
             {
                System.out.println( "Editor focus: " + 
                                     cellEditor.getComponent().hasFocus() );
                if (!cellEditor.stopCellEditing())
                {
                   cellEditor.cancelCellEditing();
                }
             }
          }
       }
    }

    class MyTableModel extends DefaultTableModel
    {

       public MyTableModel(Object rowData[][], Object columnNames[]) {
           super(rowData, columnNames);
       }

       @Override
       public Class getColumnClass(int col) {
          return Double.class;
       }

       @Override
       public boolean isCellEditable(int row, int col)
       {
          return true;
       }
    }

    class MyCellRenderer extends DefaultTableCellRenderer
    {
        public Component getTableCellRendererComponent(
          JTable table, Object value, boolean selected, boolean focus,
          int row, int col) {

          Component renderComponent = super.getTableCellRendererComponent(
             table, value, selected, focus, row, col);
//
// This is called constantly 
//        System.out.println( "In renderer" );

          if ((row % 2) == 0) {
             renderComponent.setBackground(activeDark);
          } else {
             renderComponent.setBackground(activeLight);
          }

          NumberFormat nf = NumberFormat.getInstance();
          nf.setMinimumFractionDigits(0);

          if (value != null)
             System.out.println( "Value: " + value + "; " + value.getClass() );
          super.setText((value == null) ? "" : nf.format(value));
          super.setHorizontalAlignment( SwingConstants.RIGHT );

          return renderComponent;
       }
    }

    class NumberCellEditor extends DefaultCellEditor
    {
       private Double minimum = 0.0;
       private Double value   = null;
       private final  JTextField textField;
       private final  NumberFormat nf = NumberFormat.getInstance();

       public NumberCellEditor()
       {
          super(new JTextField());
          textField = (JTextField) getComponent();
          nf.setMinimumFractionDigits(0);
          textField.setHorizontalAlignment(JTextField.RIGHT);
          textField.addFocusListener(new FocusListener()
          {
             @Override
             public void focusGained(FocusEvent e)
             {
                System.out.println( "In editor" );
                if (value != null)
                   textField.setText(nf.format(value.doubleValue()));
                else
                   textField.setText("");
                textField.setCaretPosition(0);
             }

             @Override
             public void focusLost(FocusEvent e)
             {
                System.out.println( "Lost focus editing cell" );
                if (!stopCellEditing()) cancelCellEditing();
             }
           });
        }

        public boolean stopCellEditing()
        {
          String s = (String)super.getCellEditorValue();
          System.out.println( "Stop Cell editing: " + value );
          if ("".equals(s))
          {
             value = null;
             super.stopCellEditing();
          }
          try
          {
              value = nf.parse(s).doubleValue();
          }
          catch (Exception e)
          {
             textField.setBorder(new LineBorder(Color.red));
             return false;
          }
          return super.stopCellEditing();
       }

       public Component getTableCellEditorComponent(JTable table, Object value,
                                                    boolean isSelected,
                                                    int row, int col)
       {
          this.value = (Double) value;
          textField.setBorder(new LineBorder(Color.black));
          return super.getTableCellEditorComponent(
                          table, value, isSelected, row, col);
       }

       public Object getCellEditorValue()
       {
          value = (Double) value;
          return value;
       }
    }

    public static void main( String[] args )
    {
        ExcelTableTest excelTest = new ExcelTableTest();
    }
} 
```

这是下面描述的简单解决方案。它只需要一行-

```
 tableMe.putClientProperty("terminateEditOnFocusLost", Boolean.TRUE); 
```

如果我开始在单元格中输入，然后在单元格中单击鼠标，我会进入编辑器并丢失正在输入的内容。如果我点击其他任何地方，正在输入的内容会被保存并且编辑器会停止。

我尝试的是定义一个标志-

```
 private boolean       reallyInEditor = true; 
```

然后覆盖 editCellAt 而不是准备编辑器

```
 @Override
       public boolean editCellAt( int row, int col, EventObject e )
       {
          boolean result = super.editCellAt( row, col, e );

          Component editComponent = getEditorComponent();
          if (  editComponent == null || 
              !(editComponent instanceof JTextComponent) )
             return result;
          if (e instanceof KeyEvent)
          {
             ((JTextComponent) editComponent).selectAll();
             reallyInEditor = false;
         }

          return result;
       }
    } 
```

设置我的标志以指示用户通过键入而不是双击进入编辑器

并将 FocusListener 放在桌子上

```
 tableMe.addFocusListener( new MyFocusListener() );

    class MyFocusListener implements FocusListener
    {
       @Override
       public void focusGained(FocusEvent e)
       {
          System.out.println("Table has focus");
       }

       @Override
       public void focusLost(FocusEvent e)
       {
          System.out.println("Table lost focus");
          MyJTable        table       = (MyJTable) e.getSource();
          int[]           columns     = table.getSelectedColumns();
//
// I will not be allowing multiple column selection
          if ( columns.length > 0 )
          {
             TableColumn       tableColumn = table.getColumnModel()
                                                  .getColumn(columns[0]);
             DefaultCellEditor cellEditor  = (DefaultCellEditor)
                                              tableColumn.getCellEditor();
             if (cellEditor != null && !reallyInEditor)
             {
                System.out.println( "Editor focus: " + 
                                     cellEditor.getComponent().hasFocus() );
                if (!cellEditor.stopCellEditing())
                {
                   cellEditor.cancelCellEditing();
                }
                reallyInEditor = true;
             }
          }
       }
    } 
```

所有这些额外工作的不同之处在于，如果我开始输入一个单元格，然后单击该单元格，该单元格将使用我输入的值进行更新，并且编辑器会停止。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:22:54.957

使用以下代码行来实现您正在寻找的内容：

```
tableMe.putClientProperty("terminateEditOnFocusLost",Boolean.TRUE); 
```

# ios - IOS - 应用内购买可下载媒体存储指南

> ID：14541615
> 
> 赞同：1
> 
> 时间：2013-01-26T21:12:22.143
> 
> 标签：ios, storage, in-app-purchase

我有一个应用程序，它在应用程序中购买可下载的视频。我第一次提交到应用商店时它被拒绝了，因为我正在将它写入`<Application_Home>/Documents`目录。被拒绝的理由是

> 特别是，我们发现在启动和/或内容下载时，您的应用程序存储 20MB。

我阅读了指南，它告诉我

> 可以再次下载或重新生成的数据应存储在`<Application_Home>`/Library/Caches 目录中。您应该放在 Caches 目录中的文件示例包括数据库缓存文件和可下载内容，例如杂志、报纸和地图应用程序使用的内容。

我检查了模拟器的缓存目录，发现Caches文件夹中有一个默认文件夹，名称为应用的Bundle Id。所以我把它改成了下面的路径

```
<Application_Home>/Library/Caches/<Bundle ID>/ 
```

在 sim 中运行这个，看起来很好。但是，当我上传它时，它被拒绝了。问题似乎来自写入数据。

问题：这个目录有问题吗？我应该将它存储在 Caches 根文件夹中吗？

谢谢。

# android - 如何在后台每天触发通知

> ID：14541616
> 
> 赞同：1
> 
> 时间：2013-01-26T21:12:43.327
> 
> 标签：android, service, triggers, notifications, alarmmanager

我正在努力使通知在我的应用程序中工作。我能够设置一个按钮 onclicklistener 来触发通知，但现在我想在每天下午 3 点设置自动通知。问题是我应该把通知代码和警报管理器代码放在哪里？因为我不再使用按钮触发器了。另外，有没有一种简单的方法让它像服务一样在后台运行，所以即使应用程序没有打开，它也会通过每天在特定时间触发通知来自动提醒用户？谢谢

**通知**

```
 Intent intent = new Intent(this, GFXSurface.class);
    PendingIntent pi2 = PendingIntent.getActivity(this, 0, intent, 0);
    String body = "This is a message from the Health Effect";
    String title = "The Health Effect";
    Notification n = new Notification(R.drawable.notification, body,
            System.currentTimeMillis());
    n.setLatestEventInfo(this, title, body, pi2);
    n.defaults = Notification.DEFAULT_ALL;
    nm.notify(uniqueID, n);
    finish(); 
```

**报警器**

```
 calendar.set(Calendar.HOUR_OF_DAY, 15);
    calendar.set(Calendar.MINUTE,0);
    calendar.set(Calendar.SECOND, 0);
    AlarmManager am = (AlarmManager) this
            .getSystemService(this.ALARM_SERVICE);
    PendingIntent pi = PendingIntent.getService(this, 0, new Intent(this,
            StatusBar.class), PendingIntent.FLAG_UPDATE_CURRENT);
    am.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(),
            AlarmManager.INTERVAL_DAY, pi); 
```

# git - jenkins 下游作业如何通过 email-ext 向上游 git 提交者发送电子邮件通知

> ID：14541617
> 
> 赞同：7
> 
> 时间：2013-01-26T21:12:45.463
> 
> 标签：git, jenkins, continuous-integration, email-notifications, email-ext

这个问题是关于如何向在 jenkins 的下游作业中破坏集成测试的 git 提交者发送电子邮件，并查看下游作业中的更改列表。

我没有尝试过我在这里写的所有东西，所以我可能是错的，这些是我遇到的代码的印象。

显然有很多尝试来回答这个问题，但似乎没有一个令人满意，所以我会详细说明。详情如下：

我们曾经使用 svn。我们的作业层次结构是一项检查和编译的作业，并触发其他作业，这些作业获取编译工件并对其执行杂项集成测试。

电子邮件需要发送给破坏构建的上游 svn 提交者。

我们喜欢通过 email-ext 插件 (https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin) 发送电子邮件，因为它非常可定制，我们大量使用此功能。

email ext 插件使用当前作业的 changelog.xml 来发现谁破坏了构建。由于 changelog.xml 是由 checkout 操作创建的，因此它存在于上游作业中。因此，email-ext 似乎不知道它应该向谁发送电子邮件。

如果您决定包括罪魁祸首，您可以使用 -Dhudson.upstreamCulprits=true 开始您的詹金斯，这会改变电子邮件分机的行为，但如果您不想包括罪魁祸首，那将无济于事。此外，下游作业中似乎没有可用的变更集。

还有一个责备上游提交者插件，但它似乎不能很好地与电子邮件分机配合使用。

upstreamCulprits 和 blame-upstream 似乎都需要指纹识别，我们宁愿不要，因为我们有很多文件和很多工作......这有严重的性能问题。

我们使用 BlameSubversion 插件 (https://wiki.jenkins-ci.org/display/JENKINS/BlameSubversion) 解决了我们的问题。它显然从触发该作业的上游项目中复制了 changelog.xml，因此当该作业失败并在更改日志中查找破坏构建的用户时，它可以找到它们，并且它们也出现在更改日志中。

所以我们很高兴，关于svn。现在，我们迁移到了 git。没有责备 Git 插件。我们不介意写一个。我们只需要了解我们是否应该这样做。人们一起使用 git 和 jenkins 已经有一段时间了。我们不可能是第一个遇到这个困难的人……

谢谢，内森。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T00:01:03.127

这就是我使用 Clearcase 的方式，在 svn 上应该非常相似。在您输入接收电子邮件地址列表的区域中，添加以下内容：

, ${SCRIPT, script="committers.groovy"}

在 $JENKINS_HOME/email-templates 中创建一个新脚本 committers.groovy，内容如下：

```
// the goal is to find the top level job which should contain the changelist
def upstreamBuild = null
def cause = build.causes.find {
    if(it instanceof hudson.model.Cause.UpstreamCause) {
        return true 
    }
    return false
}

try {
    while(cause != null) {
        upstreamBuild = hudson.model.Hudson.instance.getItem(cause.upstreamProject).getBuildByNumber(cause.upstreamBuild)
        if(upstreamBuild == null) {
            break;
        }
        cause = upstreamBuild.causes.find {
            if(it instanceof hudson.model.Cause.UpstreamCause) {
                return true 
            }
            return false
        }
    }   
} catch(e) {
    // do nothing
}

// now we loop through the changeset and add all the users to a list
committers = []

if(upstreamBuild != null && upstreamBuild.changeSet != null) {
    upstreamBuild.changeSet.each() { cs ->
        if(cs.user != null) {
            committers.add(cs.user)
        }
    }
}

committers.unique().join(',') 
```

这将生成一个字符串，它将 ${SCRIPT} 内容标记替换为上游作业的提交者列表。

# servicestack - 使用 ServiceStack FacebookAuthProvider 获取 AccessTokenFailed

> ID：14541618
> 
> 赞同：2
> 
> 时间：2013-01-26T21:12:46.247
> 
> 标签：servicestack

尝试将 facebook 的 oauth 与 servicestack 一起使用，我正在点击 url
localhost:60782/api/auth/facebook

被带到 facebook 的身份验证对话框，但在单击允许后，我被重定向回我的重定向 URL，#f=AccessTokenFailed
localhost:60782/api/users#f=AccessTokenFailed

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T10:46:34.790

在设置 facebook 身份验证时我遇到了类似的问题。我发现很难查明问题，因为 servicestack 会捕获 Web 异常并有效地丢弃它。为了弄清楚发生了什么，我下载并编译了服务堆栈代码。然后，我能够更改我的项目以引用我的本地服务交互 DLL，这使我能够在 facebook auth 提供程序中设置调试点。

就我而言，我遇到了代理身份验证错误，这是由于服务器尝试在没有任何凭据的情况下联系 facebook 引起的。我通过重新配置我的开发电脑和生产电脑来克服这个问题，这样它们就不会通过代理。

# objective-c - 将 NSTextField 的文本重置为空字符串 -- setText: 不起作用

> ID：14541619
> 
> 赞同：1
> 
> 时间：2013-01-26T21:12:55.623
> 
> 标签：objective-c, cocoa, nstextfield

我有一个`NSTextField`，我需要一个按钮来重置字段的文本。我该怎么做？我一直在尝试这个：

```
[textBox setText:@""];
textbox.text = @""; 
```

那是行不通的，但是我已经研究过了，没有发现如何设置文本，只有如何获取文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:17:20.303

如果是 OSX 和 NSTextField 则使用：

```
[textBox setStringValue:@""]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:17:09.380

试试这个代码：

```
theLabel.text = @"this is some text";
[self.view addSubView:theLabel]; 
```

在这里，标签是文本字段。

# java - 程序意外退出时 VRAM 会发生什么

> ID：14541623
> 
> 赞同：2
> 
> 时间：2013-01-26T21:13:36.370
> 
> 标签：java, opengl, lwjgl

假设我已经加载了一个或两个纹理，可能还有一些着色器、一个 VAO、一个 VBO，然后我运行程序。

假设程序遇到某种运行时错误并在所有这些缓冲区对象和纹理被删除之前终止。

在我重新启动计算机之前，它们是否会卡在视频内存中？

我知道 java 会自己进行清理，但我认为 opengl 不会，所以我很好奇会发生什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T01:10:56.913

> 在我重新启动计算机之前，它们是否会卡在视频内存中？

不会。图形卡由图形驱动程序管理，该图形驱动程序通知或通知处理它的进程已终止。与一个进程相关联且未被其他进程使用的所有资源都将被释放。

在某些操作系统上，可以在进程之间共享 OpenGL 上下文。如果其中一个进程终止，这些当然会保留下来。

* * *

顺便说一句：OpenGL 不使用术语“视频内存”。内存有*快*有*慢*之分，但根据实现的不同，它们可能是相同的。此外，当您上传纹理时，它的副本也会保存在系统内存中，因为 OpenGL 不会对纹理和缓冲区对象施加内存限制。如有必要，它将交换数据以为所需资源腾出空间。

# qt - Qt 或 boost 的人脸检测程序？

> ID：14541627
> 
> 赞同：-2
> 
> 时间：2013-01-26T21:14:17.900
> 
> 标签：qt, boost

我想编写一个真实、快速和彻底的人脸检测应用程序，但不知道哪个最适合它。

Qt 还是 Boost？

我知道 Qt 有很棒的文档，但哪个更强大？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T22:23:45.647

对于高级图像分析的东西，试试[OpenCV](http://opencv.org/)。Qt 或 Boost 与您尝试做的事情无关，但如果需要，您可以将两者与 OpenCV 一起使用。

# canvas - 使用 xui.js 设置画布 - 动态宽度和高度

> ID：14541630
> 
> 赞同：0
> 
> 时间：2013-01-26T21:14:44.477
> 
> 标签：canvas, xui

我想计算画布的比例，但我有问题如何直接使用 xui.js 编写它 - 我的尝试：

```
xui.extend (
{
 canvasSetup:function(scale)
 {              
var canvas = document.getElementById(x$(this));
var context = canvas.getContext('2d');

context.save();
context.translate(0, 0);

context.scale(scale, scale);
draw(context);
context.restore();
}

}); 
```

并像这样调用函数

```
 x$("#canvas")
    .attr('width', cont_w + 'px')
    .attr('height', cont_h + 'px')
    ;
    x$('#canvas').canvasSetup('2'); 
```

我是初学者，我对正确的代码编写有疑问。（还有英语），非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T10:57:36.233

这行得通-也许有用

```
xui.extend ({
    canvasSetup: function(id, scale){   
    var canvas = document.getElementById(id);
    var context = canvas.getContext('2d');

    context.save();
    context.scale(scale, scale);
    draw(context);
    context.restore();
    }       
    });

x$('#canvas_logo').canvasSetup('canvas_logo', 'scale_num'); 
```

# windows-phone-7 - IronRuby / C# Windows Phone 应用程序的几个错误和警告

> ID：14541631
> 
> 赞同：2
> 
> 时间：2013-01-26T21:14:46.307
> 
> 标签：windows-phone-7, visual-studio-2012, ironruby

我正在尝试从 C# Windows Phone 应用程序调用 IronRuby 代码，但是当我尝试构建项目时，我遇到了几个错误。

所有的教程都过时了，所以我正在尽力而为。我安装了 Windows Phone SDK，然后安装了 IronRuby，然后为 Windows Phone 创建了一个 C# 应用程序（没有 IronRuby 模板）。

Visual Studio 不知道在哪里可以找到 IronRuby DLL，所以我手动浏览并添加了它们。所有教程都说要使用 Silverlight，但不再有适用于 Windows Phone Visual Studio 2012 的 Silverlight 模板，而且 Silverlight DLL 会生成自己的虚假错误。

**代码**

[https://github.com/mcandre/ios7crypt/tree/master/WindowsPhone](https://github.com/mcandre/ios7crypt/tree/master/WindowsPhone)

**痕迹**

```
Warning 1   Reference to type 'System.Dynamic.IDynamicMetaObjectProvider' claims it is defined in 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\Silverlight\v4.0\Profile\WindowsPhone71\System.Core.dll', but it could not be found  c:\Program Files (x86)\IronRuby 1.1\Silverlight\bin\Microsoft.Scripting.dll IOS7Crypt
Warning 2   Reference to type 'System.Dynamic.IDynamicMetaObjectProvider' claims it is defined in 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\Silverlight\v4.0\Profile\WindowsPhone71\System.Core.dll', but it could not be found  c:\Program Files (x86)\IronRuby 1.1\Silverlight\bin\Microsoft.Scripting.dll IOS7Crypt
Warning 3   Reference to type 'System.Dynamic.IDynamicMetaObjectProvider' claims it is defined in 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\Silverlight\v4.0\Profile\WindowsPhone71\System.Core.dll', but it could not be found  c:\Program Files (x86)\IronRuby 1.1\Silverlight\bin\Microsoft.Scripting.dll IOS7Crypt
Warning 4   Reference to type 'System.Dynamic.IDynamicMetaObjectProvider' claims it is defined in 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\Silverlight\v4.0\Profile\WindowsPhone71\System.Core.dll', but it could not be found  c:\Program Files (x86)\IronRuby 1.1\Silverlight\bin\Microsoft.Scripting.dll IOS7Crypt
Warning 5   Reference to type 'System.Dynamic.IDynamicMetaObjectProvider' claims it is defined in 'c:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\Silverlight\v4.0\Profile\WindowsPhone71\System.Core.dll', but it could not be found  c:\Program Files (x86)\IronRuby 1.1\Silverlight\bin\Microsoft.Scripting.dll IOS7Crypt
Error   6   Predefined type 'Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported  C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\CSC    IOS7Crypt
Error   7   Predefined type 'Microsoft.CSharp.RuntimeBinder.Binder' is not defined or imported  C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\CSC    IOS7Crypt
Error   8   Cannot define a class or member that utilizes 'dynamic' because the compiler required type 'System.Runtime.CompilerServices.DynamicAttribute' cannot be found. Are you missing a reference? C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\MainPage.xaml.cs   22  25  IOS7Crypt
Error   9   Cannot implicitly convert type 'Microsoft.Scripting.Hosting.ScriptRuntime' to 'Microsoft.Scripting.Hosting.ScriptEngine'    C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\MainPage.xaml.cs   27  22  IOS7Crypt
Error   10  One or more types required to compile a dynamic expression cannot be found. Are you missing a reference?    C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\MainPage.xaml.cs   33  27  IOS7Crypt
Error   11  One or more types required to compile a dynamic expression cannot be found. Are you missing a reference?    C:\Users\andrew\Desktop\src\ios7crypt\WindowsPhone\IOS7Crypt\MainPage.xaml.cs   39  31  IOS7Crypt 
```

**眼镜**

*   铁红宝石 1.1
*   视窗电话 Visual Studio 2012
*   Windows 8 专业版 x64
*   MacBook Pro 2009 年中

# c# - Lambda 表达式中的“@”是什么意思

> ID：14541633
> 
> 赞同：3
> 
> 时间：2013-01-26T21:15:07.743
> 
> 标签：c#, lambda

> **可能重复：**
> [在 C# 变量名前放置 @ 有什么作用？](https://stackoverflow.com/questions/254669/what-does-placing-a-in-front-of-a-c-sharp-variable-name-do)

我正在尝试学习 C# lambda 表达式。当我搜索示例时，我看到以下代码

```
Where(@t => string.Compare(@t.Code, argument.Code, StringComparison.CurrentCultureIgnoreCase) == 0) 
```

我想知道 t 之前的“@”符号是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T21:19:46.710

没有什么不寻常的。如果变量是关键字，则可以在变量名称前加上 @ 作为一种转义。

例如，您也可以执行 'var @class = 5' 。通常你不能编译，因为 class 是一个关键字，但前缀 @ 允许你将它用作一个变量。

# java - Java - 带有try-catch的while循环导致程序似乎没有做任何事情

> ID：14541635
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:15:15.037
> 
> 标签：java

当我运行以下代码时，它会清除控制台但似乎没有做任何事情。

```
int x = 0; //exception catching loop
while (x == 0);

            ArrayList<Integer> values = new ArrayList<Integer>();
            Scanner Scores = new Scanner(System.in);//creates a scanner for the golfer's last 5 scores
            System.out.println("Please enter the scores from your last five rounds of eighteen-hole golf, in order."); 
            try
            { 
            for(int i = 0; i < 5; i++)
                {
                System.out.println("Please enter one score.");
                int scorecard = Scores.nextInt();
                values.add(scorecard); 
                }

        }catch(InputMismatchException ex){

            System.out.println("There has been an error. Please enter your last five scores again."); 
            x = 1; //if successful, will allow for continuation of the program. 
        } 
```

但是，当我取出 while 循环和 try-catch 行时，程序运行良好，我只是不确定如何正确执行此段。它没有显示错误，但无法运行。困扰我的部分是我似乎无法正确编码异常捕获系统。（我是 Java 新手。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:18:03.187

```
while (x == 0); 
```

这将无限运行空语句`x`，因为循环中永远不会更改。除非您想在这里无限循环，否则请删除分号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:21:26.337

你的while循环：

```
while (x == 0); 
```

是一个永不结束的不定式循环。如果你想让它做任何明智的事情，你应该在 while 之后使用删除冒号，并将 while 循环下面的所有代码包含在括号中`{}`。

# image - 深度图像压缩到最大允许误差

> ID：14541637
> 
> 赞同：10
> 
> 时间：2013-01-26T21:15:29.140
> 
> 标签：image, algorithm, data-structures, compression

有关图像压缩的文章通常侧重于在给定固定压缩比的情况下生成最佳图像质量 (PSNR)。我很好奇在给定最大允许的每像素误差的情况下获得最佳压缩比。我的直觉是贪婪地删除转换后的数据中的最小系数，跟踪我造成的错误，直到在不超过最大错误的情况下无法再删除。但我找不到任何文件来证实这一点。谁能指出我关于这个问题的参考？

* * *

## 编辑

让我提供更多细节。我正在尝试压缩来自 3D 扫描仪的深度图像，而不是常规图像。颜色不是一个因素。深度图像往往具有大的平滑块，但准确的不连续性很重要。一些像素将是空的 - 超出扫描仪的范围或低置信水平 - 并且不需要压缩。

![在此处输入图像描述](../Images/9f56d4a7464d39538b98a28d005d484a.png)

该算法需要快速运行——最好像 Microsoft Kinect 那样以 30 fps 的速度运行，或者至少在 100 毫秒范围内的某个地方。该算法将包含在我分发的库中。我更喜欢最小化依赖关系，因此我可以在相当少量的代码中实现自己的压缩方案是更可取的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:48:46.153

“贪婪地删除最小的系数”让我想起了 SVD 压缩，您使用与前 k 个最大特征值相关的数据来近似数据。其余较小的特征值不包含重要信息，可以丢弃。
大 k -> 高质量，低压缩
小 k -> 低质量，高压缩

（免责声明：我不知道我在说什么，但它可能会有所帮助）

编辑：
[这](http://www.uwlax.edu/faculty/will/svd/compression/index.html)是 SVD 压缩的更好说明

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T11:07:54.770

如果您提出的问题，我不知道有任何参考资料。

但是，我能想到的一个方向是使用优化技术来选择最佳系数。在这方面可以使用遗传算法、爬山、模拟歼灭等技术。

鉴于我在遗传算法方面有经验，我可以建议以下过程。如果您不了解遗传算法，我建议您阅读有关遗传算法的 wiki 页面。

你的问题可以被认为是选择了一个系数子集，它给出了最小的重建误差。假设有 N 个系数。很容易确定有 2^N 个子集。每个子集可以用 N 个二进制数上的字符串表示。例如，对于 N=5，字符串 11101 表示所选子集包含除 coeff4 之外的所有 coeff。使用遗传算法，可以找到最佳的钻头。目标函数可以选择为重建信号和原始信号之间的绝对误差。但是，我知道当所有的系数都被取走时，你可能会得到一个零错误。

为了解决这个问题，您可以选择使用适当的函数来调制目标函数，该函数不鼓励目标函数值接近零，并且是阈值后的单调递增函数。像 | 这样的函数 日志（\epsion + f）| 可能就足够了。

如果你觉得我的建议很有趣，请告诉我。我有一个遗传算法的实现。但它是根据我的需要量身定制的，你可能无法适应这个问题。我愿意与您一起解决这个问题，因为这个问题似乎很有趣。

请让我知道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T11:37:19.430

我认为您非常接近解决方案，但是我认为您应该注意一个问题。因为不同的小波系数对应不同尺度（和位移）的函数，所以消除特定系数引入的误差不仅取决于它的值，还取决于它的位置（尤其是尺度），所以系数的权重应该是类似于`w(c) = amp(c) * F(scale, shift)`其中 amp(c) 是系数的幅度，而 F 是取决于压缩数据的函数。当您确定将问题简化为背包问题的权重时，可以通过多种方式解决（例如重新排序系数并消除最小的系数，直到您在受相应函数影响的像素上获得阈值误差）。困难的部分是确定`F(scale,shift)`. 您可以通过以下方式进行操作。如果您正在压缩的数据相对稳定（例如监控视频），您可以将 F 估计为接收到不可接受的错误的中间概率，以消除具有给定比例的分量并从小波分解中偏移。因此，您可以对历史数据执行 SVD（或 PCA）分解，并将“F(scale, shift)”计算为具有给定比例的组件的标量积的加权（权重等于特征值）总和，并转移到 `F(scale,shift) = summ eValue(i) * (w(scale,shift) * eVector(i))`eValue 所在的特征向量是对应于特征向量的特征值 - eVector(i)，w(scale,shift) 是具有给定比例和位移的小波函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T16:05:28.570

迭代地评估不同的系数集不会帮助您实现在生成帧时尽快压缩帧的目标，也不会帮助您保持较低的复杂性。

深度图与强度图的不同之处在于可以帮助您的多种方式。

1.  游程编码可以非常有效地处理大面积的“无数据”。
2.  减去固定噪声后，强度图像中的测量误差在整个图像中是恒定的，但来自 Kinect 和立体视觉系统的深度图的误差会随着深度的反函数而增加。如果这些是您的目标扫描仪，那么您可以使用有损压缩来获得更接近的像素 - 因为您的有损函数引入的误差与传感器误差无关，所以在您的有损函数的误差大于传感器误差之前，总误差不会增加.
3.  微软的一个团队在一个非常低损失的算法上取得了很大的成功，该算法严重依赖运行长度编码（[请参阅此处的论文](http://research.microsoft.com/pubs/153971/depthcode-final.pdf)），以更好的压缩和卓越的性能击败了 JPEG 2000；然而，他们的部分成功似乎源于他们的传感器产生的相对粗糙的深度图。如果您的目标是 Kinect，您可能会发现很难改进他们的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-07T08:56:47.603

我认为您正在寻找类似[JPEG-LS](http://www.jpeg.org/jpeg/jpegls.html)算法的东西，它试图限制最大数量的像素错误。尽管它主要是为压缩自然或医学图像而设计的，而不是为深度图像（更平滑）而设计的。

*   术语“近无损压缩”是指一种有损算法，其中每个重建图像样本与对应的原始图像样本的差异不超过预先指定的值，即（通常很小的）“损失”。无损压缩对应loss=0。[链接到原始参考](http://www.hpl.hp.com/loco/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T15:25:25.460

此答案无法满足您对参考的要求，但作为评论发布太长了。

首先，计算机生成图像的深度缓冲区压缩可能适用于您的情况。通常这种压缩是在硬件级别使用透明接口完成的，因此它通常被设计为简单快速。鉴于此，[搜索深度缓冲区压缩](https://www.google.com/search?q=depth%20buffer%20compression%20delta&oq=depth%20buffer%20compression%20delta&sourceid=chrome&ie=UTF-8#hl=en&safe=active&tbo=d&sclient=psy-ab&q=depth%20buffer%20compression&oq=depth%20buffer%20compression&gs_l=serp.3..0i30j0i5i30.211266.213358.1.213468.24.16.0.4.4.0.179.1471.9j6.15.0.les;..0.0...1c.1.2.serp.WEUyUmuHKAQ&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42261806,d.b2I&fp=cecfd734039d8d45&biw=1050&bih=1591)可能是值得的。

对于基于变换的压缩器（DCT、小波等），您将遇到的主要问题之一是没有简单的方法来找到满足您的硬最大误差标准的紧凑系数。（你最终遇到的问题看起来很像[线性规划](http://en.wikipedia.org/wiki/Linear_programming)。小波可以在它们的大多数基向量中具有局部行为，这可能会有所帮助，但它仍然相当不方便。）为了达到你想要的精度，你可能需要添加另一个细化步骤，但这也会增加更多的计算时间和复杂性，并且会引入另一层不完美的[熵编码](http://en.wikipedia.org/wiki/Entropy_encoding)，从而导致压缩效率的损失。

你想要的更像是无损压缩而不是有损压缩。在这种情况下，一种方法是简单地丢弃错误阈值以下的位：如果您的最大允许错误为 X 并且您的深度表示为整数，则将您的深度整数除以 X，然后应用无损压缩。

您面临的另一个问题是深度的表示——根据您的情况，它可能是浮点数、整数、可能在投影坐标系中，甚至更奇怪。

鉴于这些限制，我推荐像 [BTPC](http://www.intuac.com/userport/john/btpc5/BTPC_VIE_final.pdf)这样的方案，因为它允许更容易适应的类小波方案，其中错误更清晰地定位，更容易理解和解释。此外，BTPC 对多种类型的图像表现出很强的抵抗力，并且能够以低保真度损失处理连续渐变和锐利边缘——这正是您正在寻找的那种特征。

由于 BTPC 是预测性的，因此深度格式的存储方式并不重要——您只需修改预测器以将坐标系和数字类型（整数与浮点数）考虑在内。

由于 BTPC 不做太多的数学运算，它也可以在通用 CPU 上运行得非常快，尽管它可能不像您希望的那样容易矢量化。（听起来你可能正在做低级优化游戏编程，所以这对你来说可能是一个认真的考虑。）

如果您正在寻找更容易实现的东西，我建议您使用带有[Golomb-Rice](http://urchin.earth.li/~twic/Golomb-Rice_Coding.html)编码器的“过滤器”类型的方法（类似于[PNG ）。](http://www.w3.org/TR/PNG-Filters.html)您可以编码到“足够好”的程度，而不是完美地编码增量以结束无损压缩。与量化然后无损编码风格的压缩器相比，这样做的好处是您可以潜在地保持更多的连续性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-09T23:01:06.690

我会尝试预处理图像，然后使用通用方法（例如 PNG）进行压缩。

PNG的预处理（首先阅读[此](http://en.wikipedia.org/wiki/Portable_Network_Graphics#Filtering)）

```
for y in 1..height
  for x in 1..width
    if(abs(A[y][x-1] - A[y][x]) < threshold)
       A[y][x] = A[y][x-1]
    elsif (abs(A[y-1][x] - A[y][x]) < threshold)
       A[y][x] = A[y-1][x] 
```

# cakephp - CakePHP 2.2.4：使用组件时重定向不起作用

> ID：14541643
> 
> 赞同：0
> 
> 时间：2013-01-26T21:15:52.203
> 
> 标签：cakephp, redirect, controller

我注意到重定向控制器方法部分时间不起作用。当我设置 debug > 0 时不会出现任何消​​息。在调用重定向方法之前我不会回显任何代码，所以它不应该是因为“标头已发送”。

让我们看一下我的 ArticlesController 添加操作，其中重定向在一个实例中起作用，但在另一个实例中不起作用。

```
public function add($page = null) {
    // Custom component to get if user has required access level
    // of page to write an article. If not, setflash to an error message
    // specific to user's access level and redirect.

    $access_message = $this->CustomPage->AccessMessage(4, $this->viewVars['access']);

    if($access_message){

        // Flash works but redirect does not
        $this->Session->setFlash(__($access_message));
        $this->redirect(array('action' => 'index', 'page' => $page));
        // Also tried
        // $this->redirect(array('controller'=>'articles', 'action' => 'index', 'page' => $page), null, true);
    } else
    {

    if ($this->request->is('post')) {

        $this->Article->create();
                if ($this->Article->save($this->request->data)) {

                    // BLAH BLAH save post, do other stuff
                    // BLAH BLAH save post, do other stuff

                    // This flash and redirect works
                    $this->Session->setFlash(__('The article has been saved'));
                    $this->redirect(array('action' => 'view', 'id' => $article_id, 'page' => $page));

                    } else {
                    $this->Session->setFlash(__('The article could not be saved. Please, try again.'));
                    } // end else if article cannot be saved
        } // if method is post
    } // end if user has access
} // end add action 
```

它肯定与组件有关，但我不确定是什么。也许由于在使用组件后立即调用了重定向，因此“$this”试图在组件而不是控制器上执行重定向方法。我尝试了 $this->Article->redirect 并在重定向之前重新加载了 Article 模型，但这些都不起作用。

我的组件代码是：

```
public function AccessMessage($required_level, $user_level) {

    if(!$user_level && $this->_View->viewVars['access']){
        $user_level = $this->_View->viewVars['access'];
    }

    if(!$required_level || !$user_level || $user_level != $required_level){
        $accessModel = ClassRegistry::init('Access');
        $access_message = $accessModel->field('access_message', array('Access.id' => $required_level));
     }

      return $access_message;
} 
```

**编辑1：**好的，所以我进行了一些挖掘，以找出问题出在哪里。组件的使用不是我之前认为的问题。如果我的组件中只有

```
public function AccessMessage($required_level, $user_level) {

    if(!$user_level && $this->_View->viewVars['access']){
        $user_level = $this->_View->viewVars['access'];
    }

    if(!$required_level || !$user_level || $user_level != $required_level){
        $access_message = 1;
     }

      return $access_message;
} 
```

然后它工作。问题在于正确实现的这两行，因为它们返回了我期望的 $access_message 的值，但是它们干扰了重定向的能力。也许标头已经发出？

```
 $accessModel = ClassRegistry::init('Access');
        $access_message = $accessModel->field('access_message', array('Access.id' => $required_level)); 
```

请注意，我也尝试过：

```
 $access_message = ClassRegistry::init('Access')->field('access_message', array('Access.id' => $required_level)); 
```

和

```
 $this->loadModel('Access');
        $access_message = $this->Access->field('access_message', array('Access.id' => $required_level)); 
```

**要点：**

> 组件要点：[https ://gist.github.com/970a951715205c222348](https://gist.github.com/970a951715205c222348)
> 
> 控制器要点：[https ://gist.github.com/2b90e5af2518a81672fb](https://gist.github.com/2b90e5af2518a81672fb)
> 
> 访问模型要点：[https ://gist.github.com/bhndbrweyes/f333a93f0a21302d832f](https://gist.github.com/bhndbrwneyes/f333a93f0a21302d832f)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T05:19:09.520

你可能有空间`before/after php Opening/Closing tags in controller and models`。在打开标签之前从所有控制器和模型中删除所有结束标签以及任何空格。然后检查结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T14:11:01.887

还没有答案，但至少您的代码中有一些变量可能未定义，或者可能发生错误：

```
public function AccessMessage($required_level, $user_level) {

    if(!$user_level && $this->_View->viewVars['access']){
        $user_level = $this->_View->viewVars['access'];
    }

    if(!$required_level || !$user_level || $user_level != $required_level){
        $access_message = 1;
    }

    return $access_message;
} 
```

*   ~~*只有*在不允许用户访问页面时才会定义变量 $access_message~~
*   如果根本没有设置 'access' viewVar 可能会发生错误

将其更改为：

```
public function AccessMessage($required_level, $user_level) {
    $access_message = 0;

    if(!$user_level && $this->_View->get('access')){
        $user_level = $this->_View->get('access');
    }

    if(!$required_level || !$user_level || $user_level != $required_level){
        $access_message = 1;
    }

    return $access_message;
} 
```

[更新] 看到你*确实*在你的要点上定义了 $access_message ( [https://gist.github.com/970a951715205c222348](https://gist.github.com/970a951715205c222348) )

但是：这*行不通*

```
App::uses('Component', 'Controller', 'ClassRegistry', 'Utility'); 
```

App::uses() 接受两个参数；您想使用的“类”以及可以找到的位置。上面的行应该写成：

```
App::uses('Component',     'Controller/Component');
App::uses('Controller',    'Controller');
App::uses('ClassRegistry', 'Utility'); 
```

但我想知道 ClassRegistry 是否需要手动加载

[更新 2] 你的应用程序中确实发生了很多“奇怪”的事情，所以我想知道我们是否能够解决这个问题：

```
public function add($page = null) {
    $access = $this->viewVars['access'];

    if($this->CustomPage->AccessMessage(4, $access)){
        $this->Session->setFlash(__($this->CustomPage->AccessMessage(4, $access)));
        $this->redirect(array('action' => 'index', 'page' => $page));
    }

    // ......
} 
```

*   'viewVars['access']' 设置在哪里？
*   您将 'viewVars['access']' 作为第二个参数 ($user_level) 传递给 AccessMessage()，但*在*AccessMessage() 内部，如果未设置参数 '$user_level'，您将尝试再次使用相同的 viewVar ?
*   $this->CustomPage->AccessMessage() 被调用*两次*以检查它是否返回任何内容，然后*使用*它。效率不是很高

.

```
public function add($page = null) {
    // Where does is $this->viewVars['access'] come from? Where is it set?
    $access  = empty($this->viewVars['access'])? null : $this->viewVars['access'];
    $message = $this->CustomPage->AccessMessage(4, $access);

    if ($message) {
        $this->Session->setFlash(__($message));
        $this->redirect(array('action' => 'index', 'page' => $page));
    }

    // ......
} 
```

进一步说明。**仅当找到“消息”且不为空时才重定向用户，而不是基于当前用户权限**，您可以考虑将两者分开；

在您的组件中：

```
public function HasAccessLevel($required_level, $user_level) {
    if(!$user_level || $user_level != $required_level){
        return false;
    }

    return true;
}

public function AccessMessage($required_level) {
    return ClassRegistry::init('Access')->field('access_message', array('Access.id' => $required_level));
} 
```

在您的控制器中：

```
public function add($page = null) {
    // Where does is $this->viewVars['access'] come from? Where is it set?
    $access  = empty($this->viewVars['access'])? null : $this->viewVars['access'];

    if($this->CustomPage->HasAccessLevel(4, $access)){
        $this->Session->setFlash(__($this->CustomPage->AccessMessage(4)));
        $this->redirect(array('action' => 'index', 'page' => $page));
    }

    // ......
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-14T18:06:59.597

Cake 2：在组件顶部：添加

```
 public function initialize(Controller $controller) {
        $this->Controller = $controller;
    } 
```

在函数内部，您可以像这样重定向：

```
$this->Controller->redirect(array('plugin' => false, 'controller' => 'users', 'action' => 'index')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-27T10:52:13.610

如果调用了重定向，但您没有被重定向，我猜您在您的`index()`操作中进行了一些权限检查，以阻止访问。你能确认或发布整个控制器代码吗？

# codeigniter - Codeigniter：从一个视图重定向到另一个视图而不通过控制器类

> ID：14541644
> 
> 赞同：0
> 
> 时间：2013-01-26T21:16:00.480
> 
> 标签：codeigniter, codeigniter-2

我正在向 Google Contact API 发出 OAuth 请求，并希望将响应重定向到另一个页面。

*   不通过Controller可以吗？（我知道这将违反 MVC 模型）
*   如果是，那么我对`View`文件夹中另一个页面的完整重定向 url 将是什么。因为我必须在 Google API 控制台上预先提供它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T23:55:19.493

你试过什么代码？视图上将显示哪些数据。如果没有数据就很容易了。

# java - 保持登录状态 cookie 不起作用

> ID：14541646
> 
> 赞同：0
> 
> 时间：2013-01-26T21:16:12.260
> 
> 标签：java, jsf, cookies, servlet-filters, stay-logged-in

我尝试做...[保持登录状态](https://stackoverflow.com/questions/5082846/java-ee-6-how-to-implement-stay-logged-in-when-user-login-in-to-the-web-appli)

这是我添加cookie的方法...

```
public static void addCookie(HttpServletResponse response, String name, String value, int maxAge) {
        Cookie cookie = new Cookie(name, value);
        cookie.setMaxAge(maxAge);
        response.addCookie(cookie);
    } 
```

这个方法的调用在这里...（其他代码省略）

```
@Stateless
public class CuentaUsuarioEJB implements Serializable{

    public boolean loginUsuario(CuentaUsuario cuentaUsuario, HttpSession httpSession, boolean remember, HttpServletResponse response) throws TraeloException{
            Map<String, Object> parametros = new HashMap<String, Object>();
            parametros.put("email", cuentaUsuario.getEmail());
            parametros.put("password", Encryption.encrypt(cuentaUsuario.getPassword()));
            List<CuentaUsuario> cuentasUsuarios = crudeServiceBean.findWithNamedQuery(NamedQueries.CONSULTA_LOGIN_CUENTA, parametros, 1);
            if(!Utils.isEmpty(cuentasUsuarios)){
                httpSession.setAttribute(Constantes.USER, cuentasUsuarios.get(0));

                if(remember){
                    String uuid = Encryption.encrypt(cuentasUsuarios.get(0).getEmail());
                    Utils.addCookie(response, Constantes.COOKIE_LOGIN, uuid, Constantes.COOKIE_AGE);
                }else{
                    Utils.removeCookie(response, Constantes.COOKIE_LOGIN);
                }
                return true;
            }

            return false;
        }
} 
```

过滤器...

```
@WebFilter(filterName="FiltroSeguridad")
public class FiltroSeguridad implements Filter{

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpSession session = httpRequest.getSession(true);
        CuentaUsuario cuentaUsuario = (CuentaUsuario)session.getAttribute(Constantes.USER);

        //Si el usuario no ha iniciado sesión
        if(Utils.isEmpty(cuentaUsuario)){
            //Se obtiene valor de la cookie
            String uuid = Utils.getCookieValue(httpRequest, Constantes.COOKIE_LOGIN);

            if(!Utils.isEmpty(uuid)){
                Map<String, Object> parametros = new HashMap<String, Object>();
                parametros.put("email", Encryption.decrypt(uuid));

                //Existe un usuario con el valor guardado en la cookie
                List<CuentaUsuario> cuentasUsuarios = crudeServiceBean.findWithNamedQuery(NamedQueries.CONSULTA_LOGIN_CUENTA_COOKIE, parametros, 1);
                if(!Utils.isEmpty(cuentasUsuarios)){
                    session.setAttribute(Constantes.USER, cuentasUsuarios.get(0));
                    Utils.addCookie(httpResponse, Constantes.COOKIE_LOGIN, uuid, Constantes.COOKIE_AGE);
                    cuentaUsuario = cuentasUsuarios.get(0);
                }else{
                    Utils.removeCookie(httpResponse, Constantes.COOKIE_LOGIN);
                }
            }
        }

        //No existe cookie y el usuario no está logueado
        if(Utils.isEmpty(cuentaUsuario)){
            session.setAttribute(Constantes.RUTA,httpRequest.getRequestURI());
            httpResponse.sendRedirect(httpRequest.getContextPath()+"/generales/login.xhtml");
        }else{
            chain.doFilter(request, response);
        }
    }

} 
```

然后...

```
public static String getCookieValue(HttpServletRequest request, String name) {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (name.equals(cookie.getName())) {
                    return cookie.getValue();
                }
            }
        }
        return null;
    } 
```

登录过程正常。但是我关闭浏览器并打开，此时方法 getCookieValue 不返回我的 cookie。我不知道，因为发生了。

谢谢。

PS：对不起我的英语

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:37:52.930

要详细说明@eis 所说的内容，请尝试以下操作：

```
public static void addCookie(HttpServletResponse response, String name, String value, int maxAge) {
        Cookie cookie = new Cookie(name, value);
        cookie.setPath( "/" );
        cookie.setMaxAge(maxAge);
        response.addCookie(cookie);
    } 
```

# java - PDFbox 设置打印时可见

> ID：14541647
> 
> 赞同：1
> 
> 时间：2013-01-26T21:16:14.040
> 
> 标签：java, pdfbox

我正在使用 PDFBOX，它的文档似乎很少，所以我来这里寻求帮助。我正在尝试打印出我创建的 pdf 表单，其中的字段由 eclipse 动态填充。我可以让它导入和打印，但是当我打印时，我设置的字段不显示（尽管当我将它保存到 HDD 时它们会显示）。有人可以指出我在打印时设置为可见的设置吗？我看到 itext 有类似的东西，我希望 PDFBox 也有。

这是我当前的代码。

```
PDDocument doc = null;

   try{
        doc = PDDocument.load("resources/orderForm.pdf");
        PDDocumentCatalog docCatalog = doc.getDocumentCatalog();
        PDAcroForm acroForm = docCatalog.getAcroForm();
        PDField field = acroForm.getField("Orderer");
        field.setValue("JohnTest");

} catch (IOException ie){
    System.out.println(ie);
}
//doc.addPage(new PDPage());
try{

    //doc.save("Empty PDF.pdf");
    doc.silentPrint();
    //doc.print();
    doc.close();
} catch (Exception io){
    System.out.println(io);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T20:29:30.207

找到了我的答案，虽然替代方法同样简单，但不能使用 pdfbox 来做到这一点。使用桌面打印文件！示例代码如下

```
 public void printOrder(){
    try {
        File myFile = new File(finished);
        //Desktop.getDesktop().open(myFile);
        Desktop.getDesktop().print(myFile);
        doc.close();
    } catch (IOException ex) {
        // no application registered for PDFs
    }
} 
```

# c# - 对象未更新/未在新位置绘制

> ID：14541657
> 
> 赞同：0
> 
> 时间：2013-01-26T21:17:03.363
> 
> 标签：c#, xna

我有 3 个类： - Game1（主类） - 实体（基础实体类） - 玩家（玩家类，扩展实体类）

我绘制了播放器类，但之后我似乎无法更改播放器对象的位置。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;

    //Create a list with all the entities
    List<Entity> entityList = new List<Entity>();

    //Player
    Player player;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }

    protected override void Initialize()
    {
        // TODO: Add your initialization logic here

        base.Initialize();
    }

    protected override void LoadContent()
    {
        // Create a new SpriteBatch, which can be used to draw textures.
        spriteBatch = new SpriteBatch(GraphicsDevice);

        //Create player
        Texture2D playertexture = Content.Load<Texture2D>("player/player");
        Rectangle playerrectangle = new Rectangle(10, 10, playertexture.Width, playertexture.Height);

        player = new Player(playertexture, playerrectangle);

        entityList.Add(player);

    }

    protected override void UnloadContent()
    {
        // TODO: Unload any non ContentManager content here
    }

    protected override void Update(GameTime gameTime)
    {
        // Allows the game to exit
        if (Keyboard.GetState().IsKeyDown(Keys.Escape))
            this.Exit();

        //Update players and entities
        player.Update(graphics.GraphicsDevice);

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin();

        //Draw player
        player.Draw(spriteBatch);

        spriteBatch.End();

        base.Draw(gameTime);
    }
}

class Entity
{

    //Standard variables
    int health;
    int armor;
    float speed;
    float friction;

    //Get graphic and bounding box
    Texture2D texture;
    Rectangle rectangle;

    public Entity(Texture2D newTexture, Rectangle newRectangle){

        texture = newTexture;
        rectangle = newRectangle;

    }

    public void Update(GraphicsDevice graphics) {

    }

    public void Draw(SpriteBatch spriteBatch) {

    }

    /*
     * Modifiers for the variables
     */
    public void modifyHealth(int amount) { health = health + amount; }
    public void modifyArmor(int amount){ armor = armor + amount; }
    public void modifySpeed(float amount) { speed = speed + amount; }

    /*
     * Getters for variables
     */
    public int getHealth() { return health;  }
    public int getArmor() { return armor; }
    public float getSpeed() { return speed; }
    public float getFriction() { return friction; }

    /*
     * Setters for variables
     */
    public void setHealth(int amount) { health = amount; }
    public void setArmor(int amount) { armor = amount; }
    public void setSpeed(float amount) { speed = amount; }
    public void setFriction(float amount) { friction = amount; }

    /*
     * Functions
     */
    public void damage(int damage) {

        /*
         * Calculate health
         * 
         * Armor takes half the damage, if possible
         */
        if (damage / 2 >= armor) {
            damage = damage / 2;
            armor -= damage;
        } else if (armor > 0) {
            damage -= armor;
            armor = 0;
        }

        health -= damage;

        if(health <= 0){
            health = 0;
            //TODO Death
        }
    }
}

class Player : Entity
{

    //Create player
    Entity player;

    //Position and velocity
    Vector2 position;
    Vector2 velocity;

    //Texture and rectangle
    Texture2D texture;
    Rectangle rectangle;

    public Player(Texture2D newtexture, Rectangle newrectangle) : base(newtexture, newrectangle) {

        texture = newtexture;
        rectangle = newrectangle;

        //Set basic variables
        this.setHealth(100);
        this.setArmor(0);
        this.setSpeed(10);
        this.setFriction(1);

    }

    public void Update() {

        //Movement
        if(Keyboard.GetState().IsKeyDown(Keys.Right)){
            rectangle.X += 1;
        }

        rectangle.Y += 4;

    }

    public void Draw(SpriteBatch spriteBatch) {

        spriteBatch.Draw(texture, rectangle, Color.White);

    }
} 
```

如果我也犯了一般性错误，请指出它们，我想尽我所能做好一切，因为我还在学习。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:34:19.637

你的呼唤 `public void Update(GraphicsDevice graphics)`

但运动代码在`public void Update()`

我建议你这样做，使用[virtual 和 override](http://www.dotnetperls.com/override)关键字。

在您的实体类中，它应该如下所示：

```
 public virtual void Update(GraphicsDevice graphics) {

    } 
```

在你的球员班

```
public override void Update(GraphicsDevice graphics) {
//ADD MOVEMENT CODE HERE
    } 
```

# curl - 我应该在 cURL Google API 上使用什么 sed 语法

> ID：14541662
> 
> 赞同：0
> 
> 时间：2013-01-26T21:17:22.850
> 
> 标签：curl, sed

我想获得以下数据：AAPL

在以下 cURL 上使用 sed：`curl -s "http://www.google.com/ig/api?stock=AAPL"`

Google API 给了我一个 XML 答案，包含 APPL 的标签是`<symbol data=""/>`ie`<symbol data="AAPL"/>`

是否可以使用一个 sed 给我来自 2 个 XML 标签的数据？

我正在运行 MAC OS X 10.8.2，而且我对 Unix bash/shell 命令还是很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T02:48:32.940

这有点冗长——你可以使用 GNU sed 来减少它——但这应该可以解决问题：

```
curl -s "http://www.google.com/ig/api?stock=AAPL" |
  grep -Eo '<(symbol|last) [^>]*>' |
  sed -e 's/.*data="//' -e 's/".*//' 
```

或者纯粹`sed`的（虽然有点野蛮）：

```
curl -s "http://www.google.com/ig/api?stock=AAPL" |
  sed -e 's/.*<symbol data="\([^>]*\)"\/>.*<last data="\([^>]*\)"\/>.*/\1 \2/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:36:54.907

最好使用[`xmllint`](http://xmlsoft.org/xmllint.html)shell 命令（由 libxml 安装）和[Xpath](http://en.wikipedia.org/wiki/Xpath)表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T22:25:19.720

不是`sed`。这是`perl`一个分成几行并使用 XML 解析器的单行代码`XML::Twig`：

```
perl-5.14.2 -MXML::Twig -e '
    BEGIN { 
        sub process { printf qq|%s\n|, $_[1]->print } 
    } 
    XML::Twig->new( 
        twig_handlers => { 
            symbol => \&process, 
            last => \&process 
        } 
    )->parse( qx{curl -s "http://www.google.com/ig/api?stock=AAPL"} )
' 
```

它产生：

```
<symbol data="AAPL"/>
<last data="439.88"/> 
```

# matlab - 在二维笛卡尔坐标系中绘制一个 1 xn 向量

> ID：14541665
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:17:41.673
> 
> 标签：matlab, vector, plot

我有一个 1 x 10 向量，如下所示：

```
V = [0.500 -5.433 0.543 0.321 1.432 0.543 -0.576 -0.145 -1.322 -0.222] 
```

并想在 MATLAB 上使用`plot`.

我用过`plot(v,0,'kx,'marker',10)`，但对我来说似乎不合理。关于如何进行此操作的任何想法？

* * *

有没有人有非常好的 ISOMAP 资源？需要一个非常全面的关于 Isomap 的逐步简单教程。如果我能有好的视频，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:53:26.460

你几乎明白了，只需写：

```
plot(v,'kx','MarkerSize',10); 
```

请注意，我写`plot`的不是`Plot`，Matlab 是区分大小写的......当你只有一个向量时，绘图函数假定对于 x 轴它需要向量的元素数，即`plot(1:numel(v),v,...)`。我建议你使用[Matlab 文档](http://www.mathworks.com/help/matlab/ref/plot.html)，如果你读过它，你会看到一个例子，可以告诉你你做错了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-21T15:20:36.243

`bla`的解决方案没问题，并产生散点图。

但是，您可以制作线图等。

不过，请注意它 is`V`和 not `v`，因为他指出 MATLAB 是区分大小写的。

**以下是如何生成线图：**

```
x=0:length(V)
plot(x,V,'r--o',x,V,'r*') 
```

**输出：**

![在此处输入图像描述](../Images/b9fa8b678ccc2f881fa056ca0de917e1.png)

# vb.net - 控制台 VB.NET：文件处理 - 搜索特定编号的文件并输出记录

> ID：14541666
> 
> 赞同：1
> 
> 时间：2013-01-26T21:17:42.280
> 
> 标签：vb.net, visual-studio-2010, console, procedural-programming, file-processing

您好，我正在 VB.NET 中构建一个控制台应用程序，它读取记录文件并将其输出给用户。我已经让程序将所有记录输出到控制台，但我似乎无法让搜索功能正常工作。

我希望用户输入记录号并让程序在文本文件中搜索该特定记录，然后将其输出到控制台。

我将把读取记录功能留在这里以供参考。

读取记录功能：

```
Public Function Read_Records()

    File_Name = "drecords.txt"
    File_num = FreeFile()
    Record_Counter = 0
    record_no = 999

    If File_Name <> "" Then
        Try
            FileOpen(File_num, File_Name, OpenMode.Input)
            Do Until EOF(File_num)
                Record_Counter = Record_Counter + 1
                record_no = record_no + 1
                records(Record_Counter, 0) = record_no
                records(Record_Counter, 1) = LineInput(File_num)
                records(Record_Counter, 2) = LineInput(File_num)
                records(Record_Counter, 3) = LineInput(File_num)
                records(Record_Counter, 4) = LineInput(File_num)
                records(Record_Counter, 5) = LineInput(File_num)

            Loop
            record_ID = Record_Counter

        Catch ex As Exception
            MsgBox("ERROR OPENING FILE")
        Finally
            FileClose(File_num)
        End Try
    End If
    Last_Record = Record_Counter

    Return records

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T23:56:40.123

我不确定你到底想要什么，但这里有几个例子。

要从控制台读取记录编号并输出该记录，请执行以下操作：

```
dim i, k as integer
k = val(console.readline())
for i = 1 to 5
  console.writeline(records(k, i))
next i 
```

我不确定您将如何识别记录，但是，例如，您可以在记录中搜索第一个字段中的“abc”值，如下所示：

```
For i = 1 to Last_Record
  if records(i, 1) = "abc" then
    ' output the record to the user
  end if  
next i 
```

替换`records(i, 1)`为`records(i, 0)`以搜索记录号。

如果要搜索每个字段，可以添加嵌套循环：

```
For i = 1 to Last_Record
  for k = 1 to 5
    if records(i, k) = "abc" then
      ' output the record to the user
    end if  
  next k
next i 
```

# c# - 为什么在另一个枚举声明中允许不同枚举类型之间的操作，但在其他地方不允许？

> ID：14541668
> 
> 赞同：21
> 
> 时间：2013-01-26T21:18:02.093
> 
> 标签：c#, .net, enums

C# 编译器允许在另一个枚举类型声明中的不同枚举类型之间进行操作，如下所示：

```
public enum VerticalAnchors
{
    Top=1,
    Mid=2,
    Bot=4
}

public enum HorizontalAnchors
{
    Lef=8,
    Mid=16,
    Rig=32
}

public enum VisualAnchors
{
    TopLef = VerticalAnchors.Top | HorizontalAnchors.Lef,
    TopMid = VerticalAnchors.Top | HorizontalAnchors.Mid,
    TopRig = VerticalAnchors.Top | HorizontalAnchors.Rig,
    MidLef = VerticalAnchors.Mid | HorizontalAnchors.Lef,
    MidMid = VerticalAnchors.Mid | HorizontalAnchors.Mid,
    MidRig = VerticalAnchors.Mid | HorizontalAnchors.Rig,
    BotLef = VerticalAnchors.Bot | HorizontalAnchors.Lef,
    BotMid = VerticalAnchors.Bot | HorizontalAnchors.Mid,
    BotRig = VerticalAnchors.Bot | HorizontalAnchors.Rig
} 
```

但在方法代码中禁止它们，即操作：

```
VerticalAnchors.Top | HorizontalAnchors.Lef; 
```

标记有此错误：

> 运算符“|” 不能应用于“VerticalAnchors”和“Horizo​​ntalAnchors”类型的操作数。

当然，有一个解决方法：

```
(int)VerticalAnchors.Top | (int)HorizontalAnchors.Lef 
```

我对这种编译器行为很好奇。为什么在另一个枚举声明中允许不同枚举类型之间的操作，但在其他地方不允许？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T23:25:45.727

由于您没有在问题中提出问题，因此我将假装您提出了一些有趣的问题并回答：

> 在枚举声明中，您是否可以在初始化程序中使用其他枚举的值？

是的。你可以说

```
enum Fruit { Apple }
enum Animal { Giraffe = Fruit.Apple } 
```

即使在没有强制转换的情况下分配`Fruit.Apple`给类型变量是不合法`Animal`的。

这个事实有时令人惊讶。事实上，我自己也很惊讶。当我第一次尝试这样做时，为了测试编译器的一部分，我认为这可能是一个错误。

> 规范中的哪里说这是合法的？

14.3 节说初始化器必须是一个常量，并且该常量将被转换为枚举的底层类型。枚举成员是常量。

> 啊，但是这个案子呢？

```
enum Fruit { Apple = 1 }
enum Shape { Square = 2 }
enum Animal { Giraffe = Fruit.Apple | Shape.Square } 
```

> 该表达式首先不是合法的常量表达式，那是怎么回事？

好的，你让我到了那里。第 14.3 节也确实说初始化器中使用的 enum 成员不需要强制转换，但不清楚这是否意味着*正在初始化的 enum 的*成员或*任何 enum*的成员。要么是一个合理的解释，但没有具体的语言，很容易认为前者的意思是预期的意思。

因此，这是一个已知的缺陷；几年前我向 Mads 指出了它，但它从未得到解决。一方面，规范并没有明确允许它。另一方面，该行为既有用又符合规范的精神，如果不是完全在字面上的话。

基本上，实现所做的是在处理枚举初始化程序时，它将所有枚举成员视为其基础类型的常量表达式。（当然，它确实需要确保枚举定义是非循环的，但这可能最好留给另一个问题。）因此它没有“看到”它`Fruit`，`Shape`也没有定义“或”运算符。

尽管不幸的是规范措辞尚不清楚，但这是一个理想的功能。事实上，我在 Roslyn 团队中经常使用它：

```
[Flags] enum UnaryOperatorKind { 
  Integer = 0x0001, 
  ... 
  UnaryMinus = 0x0100,
  ... 
  IntegerMinus = Integer | UnaryMinus
  ... }

[Flags] enum BinaryOperatorKind { 
  ...
  IntegerAddition = UnaryOperatorKind.Integer | Addition
  ... } 
```

能够混合从各种枚举中提取的标志非常方便。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-26T23:11:37.800

据我所知，它实际上不在[规范中。](http://msdn.microsoft.com/en-us/library/aa664599%28v=vs.71%29.aspx)有一些相关的：

> 如果枚举成员的声明具有常量表达式初始值设定项，则该常量表达式的值（**隐式** 转换为枚举的基础类型）是枚举成员的关联值。

虽然`VerticalAnchors.Top & HorizontalAnchors.Lef`有类型`VerticalAnchors`，但它可以隐式转换为`VisualAnchors`. 但这并不能解释为什么常量表达式本身在任何地方都支持隐式转换。

实际上，它似乎明确**违反**规范：

> 常量表达式的编译时求值**使用与非常量表达式的运行时求值相同的规则**，除了在运行时求值会引发异常的情况下，编译时求值会导致发生编译时错误。

如果我没有错过任何东西，规范不仅明确地不允许这样做，而且不允许这样做。在这种假设下，这将是一个编译器错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T21:53:41.947

C# 允许枚举值的定义包含常量值表达式，因此枚举值可以是枚举的组合，例如`[Flags]`. 编译器将表达式中的每个枚举值评估为`int`（通常），因此您可以对枚举值进行按位和算术运算。

在枚举定义之外，您必须先将枚举转换为原始类型，然后再对其执行操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T22:53:12.580

有趣的。您还可以询问为什么允许这样做：

```
enum MyType
{
  Member = DayOfWeek.Thursday | StringComparison.CurrentCultureIgnoreCase,
} 
```

当不允许这样做*时*：

```
var local = DayOfWeek.Thursday | StringComparison.CurrentCultureIgnoreCase; 
```

原因似乎是在枚举的声明中，在枚举成员初始化程序中，任何枚举值，甚至是不相关枚举的值，都被认为是转换为其基础类型。因此编译器将上面的示例视为：

```
enum MyType
{
  Member = (int)(DayOfWeek.Thursday) | (int)(StringComparison.CurrentCultureIgnoreCase),
} 
```

我觉得这很奇怪。我知道您可以直接使用*相同*枚举的值（无需说明转换为基础类型），如最后一行：

```
enum SomeType
{
  Read = 1,
  Write = 2,
  ReadWrite = Read | Write,
} 
```

但我发现*其他*枚举成员也被强制转换为它们的底层整数类型非常令人惊讶。

# php - 使用 jquery 保持旧状态

> ID：14541670
> 
> 赞同：1
> 
> 时间：2013-01-26T21:18:05.013
> 
> 标签：php, javascript, jquery, jqxhr

我从这里下载了 1 个上传进度条：http: [//www.malsup.com/jquery/form/progress3.html](http://www.malsup.com/jquery/form/progress3.html)

这是完美的; 无论如何，就在文件上传时，它会给出有关文件的状态，例如：

> [在http://mysite.com/1.jpg](http://mysite.com/1.jpg)上传的文件

但是，当上传新文件时，状态会消失，并且会出现有关刚刚上传的新文件的详细信息。

我只想拥有旧状态，当上传新文件时，新状态就会出现在旧状态下。我怎么能这样做？

这是代码：

```
(function() {

var bar = $('.bar');
var percent = $('.percent');
var status = $('#status');
$('form').ajaxForm({
beforeSend: function() {
    status.empty();
    var percentVal = '0%';
    bar.width(percentVal)
    percent.html(percentVal);
},
uploadProgress: function(event, position, total, percentComplete) {
    var percentVal = percentComplete + '%';
    bar.width(percentVal)
    percent.html(percentVal);
    //console.log(percentVal, position, total);
},
complete: function(xhr) {
    status.html(xhr.responseText);
}
}); 

})();       
</script> 
```

如果您在链接中看到[演示](http://www.malsup.com/jquery/form/progress3.html)并很好地理解它，则状态显示在 HTML 中，如下所示：

```
 <div id="status"></div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:20:21.223

您的`complete`回调正在重置，`status.html()`并且您`beforeSend`正在清空`status`. `status.empty();`删除那条线！

然后尝试在一些标记中添加最新消息，而不是覆盖以下内容的全部[内容](http://api.jquery.com/prepend/)`status`：

```
complete: function(xhr) {
    var message = '<div class="new">' + xhr.responseText + '</div>';
    status.prepend(message);
} 
```

# ruby - 如何从 application.html.erb 中访问模型和控制器属性？

> ID：14541671
> 
> 赞同：1
> 
> 时间：2013-01-26T21:18:05.073
> 
> 标签：ruby, ruby-on-rails-3.2, scope

我有一个页面资源的模型和控制器。我需要能够从 Application.html.erb 中访问页面和页面的名称以及 link_to

我尝试渲染导航部分。但是您不能从部分访问控制器。我需要能够呈现一个可以访问@pages 变量的导航栏，这样我就可以遍历它们。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:24:39.593

在您的 ApplicationController 内部，`app/controllers/application_controller.rb`

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :get_pages

  protected

  def get_pages
    @pages ||= Page.all
  end

end 
```

这样您就可以`@pages`在任何视图中使用实例变量。

通过`||=`操作符使用 memoization，您只需在第一次需要时分配变量，因此无需担心每次都调用该方法。

# c# - 我可以在 C# 中为 Sum 创建一个通用方法吗

> ID：14541676
> 
> 赞同：7
> 
> 时间：2013-01-26T21:18:17.693
> 
> 标签：c#, generics

> **可能重复：**
> [泛型 - 其中 T 是一个数字？](https://stackoverflow.com/questions/1267902/generics-where-t-is-a-number)

我已经为最大值创建了一个通用方法，并且我使用了`IComparable`接口

有人知道如何为 Sum 创建通用方法吗？该方法中哪个接口有用？

这是我的 GetMax 代码：

```
public static T GetMax<T>(T[] array) where T : IComparable
    {
        T min = array[0];

        foreach (T item in array)
        {
            if (min.CompareTo(item) < 0)
            {
                min = item;
            }
        }
        return min;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T21:24:08.313

此操作已存在`Linq.Sum()`

```
var sum = new List<int>{1,2,3}.Sum(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T21:30:01.403

不，您不能为所有类型创建一种通用方法。但是您可以对某些类型使用`LINQ`扩展方法： , , , , ... 在此处查看更多类型：[Enumerable.Sum](http://msdn.microsoft.com/en-gb/library/bb345537.aspx)。`Sum``decimal``double``int``long`

```
int[] array1 = { 1, 3, 5, 7 };
int sum1 = array1.Sum(); 
```

对于您自己的类型，您可以创建和实现接口`ISummable`：

```
interface ISummable<T>
{
   T Add(T a, T b);
} 
```

然后你的通用方法将类似于这个：

```
T Sum<T>(T a, T b) where T:ISummable<T>
{
    return a.Add(a,b);
} 
```

在此处查看更多信息：[使泛型相加](http://www.developerfusion.com/article/84413/making-generics-add-up/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T21:24:56.280

我假设您想编写这样的通用方法`Sum`：

```
static T Sum<T>(this IEnumerable<T> values) where T : ??
{
    T result = 0;
    foreach (var value in values)
    {
        result = result + value;
    }
    return result;
} 
```

不幸的是，没有任何约束可以代替`??`来完成这项工作。

.NET 中内置的数据类型实现了某些接口。例如，[**int**](http://msdn.microsoft.com/en-us/library/system.int32.aspx)实现 IComparable、IFormattable、IConvertible、IComparable<int> 和 IEquatable<int>。这些都没有提供允许您实现方法的`Add`方法（或运算符） 。而且您不能将接口实现添加到现有类型。`+``Sum`

您可以做的是将一个对象传递给`Sum`知道如何添加两个泛型类型值的方法：

```
static T Sum<T>(this IEnumerable<T> values, IAdder<T> adder)
{
    T result = adder.Zero;
    foreach (var value in values)
    {
        result = adder.Add(result, value);
    }
    return result;
} 
```

和

```
interface IAdder<T>
{
    T Zero { get; }

    T Add(T a, T b);
} 
```

和

```
class Int32Adder : IAdder<Int32>
{
    public static readonly Instance = new Int32Adder();

    public int Zero { get { return 0; } }

    public int Add(int a, int b) { return a + b; }
} 
```

# couchdb - CouchDB 是这个应用程序的正确解决方案吗？

> ID：14541677
> 
> 赞同：0
> 
> 时间：2013-01-26T21:18:33.873
> 
> 标签：couchdb

我目前正在评估以下应用程序的正确解决方案：

*   主要目标是通过多台平板电脑（不超过 5 台）跟踪体育赛事
*   为了独立于互联网访问，我将在比赛室设置一个本地服务器，该服务器将为平板电脑提供 webapp，并为大电视屏幕或投影仪显示的一些实时统计数据提供 webapp
*   为了提供在线代码，我想将本地数据库复制到数据中心中的服务器，该服务器将使用 liveticker 托管网站并使用复制的数据库
*   本地服务器将具有动态 IP，连接到可能无法配置端口转发的普通路由器，我想为互联网连接问题做好准备。所以我想将数据从本地推送到公共服务器是一个好主意，而不是像mysql主从复制那样反之亦然

经过一些研究，我偶然发现了 couchdb，因为它提供了复制功能，现在我已经了解了 couchdb 为整个应用程序提供服务的可能性。那么 couchdb 是否适合我的需求，还是有更好的解决方案？我可以从一个复制的 couchdb 数据库中处理不同的 web 应用程序（用于输入的平板电脑应用程序、本地实时统计数据和在线实时报价单）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T01:25:27.443

在过去的一年里，我一直在使用 CouchDB、BigCouch 和 Couchbase 做很多工作，希望我的一些观点能有所帮助。

1.  复制功能非常有效。这很容易启动，我一直对它的出色表现感到惊讶。过去，我对 SQL Server 中的复制感到头疼，所以我对它在 CouchDB 中的运行情况感到惊喜。

2.  但是，如果复制是您唯一需要的，还有很多其他选择。CouchDB 工作在文档模型上，这与关系数据库非常不同。由于 CouchDB 不执行“连接”，因此您必须以非规范化的方式考虑您的应用程序。

3.  由于 CouchDB 通过 HTTP 进行通信并从磁盘大量读取（[为什么从 CouchDB 读取这么慢？（1.5MB/s 左右）](https://stackoverflow.com/questions/9807200/why-are-reads-from-couchdb-so-slow-1-5mb-s-or-thereabouts)）。因此，如果速度是一个主要因素，我不确定我是否会选择 CouchDB。我要注意的一件事...我发现您可以使用 CouchDB 在 Erlang 中编写您的过滤器/视图，并且您会获得重大的性能改进。（我看到阅读量增加了大约 50%）。

4.  使用 BigCouch 和 Couchbase 使用动态 IP 可能具有挑战性。当我第一次重新启动每种技术的集群时，它们都出现了故障。如果可能，您可以通过使用主机名而不是 IP 来解决此问题，并使用 /etc/hosts 文件编写一些内容。CouchDB 的一个优点是它将所有配置信息存储在数据库中，因此我一直能够通过 Futon 查找它并进行所需的更改。

5.  查看 TouchDB。他们有 iOS 和 Android 版本，旨在在移动/平板设备上运行并支持复制。它现在还没有为 Android 做好生产准备，但对于 iOS 来说还不错。

总的来说，如果您想以 JSON 格式存储内容、需要文档数据库并希望按需复制，那么 Couch 非常适合。

# javascript - 将 jQuery 选择器设置为 javascript 函数的参数

> ID：14541679
> 
> 赞同：0
> 
> 时间：2013-01-26T21:19:09.957
> 
> 标签：javascript, jquery, jquery-selectors

> **可能重复：**
> [如何在 jquery 中使用变量代替 ID](https://stackoverflow.com/questions/3599140/how-to-use-a-variable-in-place-of-id-in-jquery)

我调用了该函数`makeinvisible`，其中一个参数应该是*带有*`id=testimage`. *JavaScript*无法识别它，因此图像不会被隐藏。

```
function makeinvisible (imageid){
    $("#imageid").css("visibility","hidden")
}

$(document).ready(
    makeinvisible("testimage")
) 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:22:31.293

编写的代码正在寻找一个 id=imageid 的元素。

尝试：

```
function makeinvisible (imageid){

    $("#" + imageid).css("visibility","hidden")
 }

$(document).ready(
  makeinvisible("testimage")
) 
```

编辑：您的 document.ready 调用也不正确。您编写 makeinvisible 的方式是立即执行，而不是在文档准备好时执行。它需要是：

```
$(document).ready(function(){ makeinvisible("testimage"); }); 
```

# php - 按自定义字段对 Wordpress foreach 结果进行排序

> ID：14541680
> 
> 赞同：0
> 
> 时间：2013-01-26T21:19:21.093
> 
> 标签：php, wordpress, loops, foreach

我整天都被这个问题所困扰，而且我一直无处可去，希望有人能提供帮助！

我正在为一家餐厅建立一个网站，该餐厅有多个位置，需要列出每个特定位置存在的每种饮料。然后需要按类别（棕色、白色、番茄、啤酒、葡萄酒）对这些饮料进行分类。我觉得我非常接近解决方案，但最近一段时间我一直在努力。

这是我的代码：

```
$drinks = get_posts('post_type=drinks&numberposts=-1');
        $show_brown_title   = false;
        $show_white_title   = false;
        $show_tomato_title  = false;
        $show_wine_title    = false;
        $show_beer_title    = false;

        if ( $drinks ) {
            foreach( $drinks as $drink ) {

                $id             = $drink->ID;
                $drink_location = $drink->drink_location;

                if($drink->drink_category == 'Brown' && $drink_location && in_array($site_slug, $drink_location)) {
                    if($show_brown_title == false) {
                        echo '<h4><span>Brown</span> Cocktails</h4>';
                        echo '<ul>';

                        $show_brown_title = true;
                    }

                    echo '<li>';
                    echo '<span class="drink_title">'.$drink->post_title.'</span>';
                    echo '<span class="drink_ingredients">'.$drink->drink_ingredients.'</span>';
                    echo '<span class="drink_price">'.$drink->price_oz.'</span>';
                    echo '</li>';
                }

                if($drink->drink_category == 'White' && $drink_location && in_array($site_slug, $drink_location)) {
                    if($show_white_title == false) {
                        echo '<h4><span>White</span> Cocktails</h4>';
                        echo '<ul>';

                        $show_white_title = true;
                    }

                    echo '<li>';
                    echo '<span class="drink_title">'.$drink->post_title.'</span>';
                    echo '<span class="drink_ingredients">'.$drink->drink_ingredients.'</span>';
                    echo '<span class="drink_price">'.$drink->price_oz.'</span>';
                    echo '</li>';
                }
           }
} 
```

在大多数情况下，这是可行的。但是，我遇到了两个问题。

1.  完成每个类别后，我无法弄清楚如何关闭无序列表。
2.  这在很大程度上是按类别分组的，但是，如果我以后有一杯饮料，它实际上不会将其归入正确的类别，它只会归入底部的任何类别。我不确定这是因为我没有关闭无序列表，还是因为从 WP 中拉出帖子的顺序。

如果我解释得很好，请告诉我，我非常感谢你们提供的任何帮助！

Z

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:37:35.467

您应该使用 WP_Query 而不是 get_posts。信息：[https ://wordpress.stackexchange.com/questions/50761/when-to-use-wp-query-query-posts-and-pre-get-posts/50762#50762](https://wordpress.stackexchange.com/questions/50761/when-to-use-wp-query-query-posts-and-pre-get-posts/50762#50762)

```
$show_brown_title   = false;
$show_white_title   = false;
$show_tomato_title  = false;
$show_wine_title    = false;
$show_beer_title    = false;
$args = array(
    'post_type'     => 'drinks',
    'numberposts'   => '-1'
);
$query = new WP_Query( $args );
if( $query->have_posts() ):
    while( $query->have_posts() ): $query->the_post();
        echo '<pre>';
        print_r( $query );
        echo '<pre>';
    endwhile;
endif;
wp_reset_postdata(); 
```

在循环中，您将再次构建您的列表，逐步使用 print_r，巧妙地使用您的对象元素。

* * *

方法#2：

```
$show_brown_title   = false;
$show_white_title   = false;
$show_tomato_title  = false;
$show_wine_title    = false;
$show_beer_title    = false;
foreach((get_the_category()) as $cat) {
    $args = array(
        'post_type'     => 'drinks',
        'numberposts'   => '-1',
        'cat'           => $cat->cat_ID
    );
    $query = new WP_Query( $args );
    if( $query->have_posts() ):
        echo '<ul>';
        while( $query->have_posts() ): $query->the_post();
            echo '<h4><span>'. $query->category_name .'</span> Cocktails</h4>';
            echo '<li>';
            echo '<span class="drink_title">'.$query->post_title.'</span>';
            echo '<span class="drink_ingredients">'.$query->drink_ingredients.'</span>';
            echo '<span class="drink_price">'.$query->price_oz.'</span>';
            echo '</li>';
        endwhile;
        echo '</ul>';
    endif;
    wp_reset_postdata();
} 
```

使用 $query->category_name 的规范可能应该以其他方式编写。使用 print_r 查看对象的正确字段名称/元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T23:59:43.363

贝娄是我的解决方案。

注意：get_posts 使用 orderby 参数按饮料类别对帖子进行排序。

代码被简化为仅`<ul>`在 drink_category 更改时开始并`</ul>`在类别更改时结束。代码还检查要输出的 html 是否已分配一个值，并在其上附加一个 final`</ul>`以防尚未附加。

```
$drinks = get_posts('post_type=drinks&numberposts=-1&orderby=drink_category');

$current_category = '';
$html = '';
if ( $drinks ) {
    foreach( $drinks as $drink ) {
        $id             = $drink->ID;
        $drink_location = $drink->drink_location;

        if ($current_category != $drink->drink_category) {
            if ($current_category != '') {
                $html .= '</ul>';           
            }
            $current_category = $drink->drink_category;
            $html .= '<h4><span>' . $current_category . '</span> Cocktails</h4>';
            $html .= '<ul>';
        }

        if($drink_location && in_array($site_slug, $drink_location)) {
            $html .= '<li>';
            $html .= '<span class="drink_title">'.$drink->post_title.'</span>';
            $html .= '<span class="drink_ingredients">'.$drink->drink_ingredients.'</span>';
            $html .= '<span class="drink_price">'.$drink->price_oz.'</span>';
            $html .= '</li>';
        }
    }
}

if (strlen($html) > 0 && !endsWith($html, '</ul>')) {
    $html .= '</ul>';
}

function endsWith($haystack, $needle)
{
    $length = strlen($needle);
    if ($length == 0) {
        return true;
    }
    return (substr($haystack, -$length) === $needle);
} 
```

# codeigniter - Codeigniter 压缩包密码

> ID：14541681
> 
> 赞同：0
> 
> 时间：2013-01-26T21:19:21.003
> 
> 标签：codeigniter, zip

我正在使用 CodeIgniter 的 Zip 助手来创建存档。一切正常，我想为这个 zip 添加密码，有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T19:02:02.320

不幸的是，您不能在 Codeigniter 或本机 PHP 中执行此操作，您需要使用该`system()`函数并在主机上处理 Zip。

有关更完整的答案，请参阅[https://stackoverflow.com/a/646221/1734864 ，有关函数参考，请参阅](https://stackoverflow.com/a/646221/1734864)[http://php.net/manual/en/function.system.php](http://php.net/manual/en/function.system.php)。

# scala - Scala 中的强制转换类异常：java.lang.Object 到 Scala CaseClass

> ID：14541682
> 
> 赞同：0
> 
> 时间：2013-01-26T21:19:26.667
> 
> 标签：scala, playframework-2.0, securesocial

这让我发疯 - 我正在玩 scala、社会安全等，当我尝试制作案例课程时，我不断收到这个错误。

编辑：与此类似的问题：[Scala and Play2: ClassCastException: java.lang.Object cannot be cast to play.api.libs.json.JsValue](https://stackoverflow.com/questions/14971744/scala-and-play2-classcastexception-java-lang-object-cannot-be-cast-to-play-api)

编辑：将方法 createIdentityFromUser 移动到静态伴随类似乎可以解决这个问题。不知道为什么。

```
[ClassCastException: java.lang.Object cannot be cast to securesocial.core.SocialUser] 
In /Users/tripled153/Development/src/Foundation/playApp/app/service/SecureSocialUserService.scala     at line 58.
54//    }
55
56    println("here2")
57    //val ret = user.map(_.createIdentityFromUser)
58    user.foreach(x => x.createIdentityFromUser)
59    user match{
60      case Some(x) => Some(x.createIdentityFromUser)
61      case None => None 
```

第 42 行错误。地图、foreach 和 match 所有的炸弹都带有 classcastexception，我不明白为什么。

下面是为了便于阅读而对代码进行了一些清理（注意 SocialUser 扩展了 Identity trait）：

```
 def find(id: UserId): Option[Identity] = {
   if ( Logger.isDebugEnabled ) {
     Logger.debug("find users = %s".format(users))
   }

   //Option[GraphedUser]
   val user = GraphedUser.getUser(id.id)

   //ret should be Option[SocialUser]
   val ret = user.map(_.createIdentityFromUser) //errors!

   return ret

 } 
```

以及被调用以产生似乎是问题的对象的方法。它具有扩展 tinkerpop 框架 VertexFrame 接口的特征。我猜这与它有关。

```
 def createIdentityFromUser: SocialUser = {

    return new SocialUser(new UserId(getUserId, getProviderId), getFirstName, getLastName, getName, Some(getEmail),
      None, new AuthenticationMethod("userPassword"), None, None, Some(new PasswordInfo(getPasswordInfoHash, getPasswordInfoSalt)))

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T00:24:24.337

我将方法设为静态，并采用参数并且它可以工作......不知道为什么，但它解决了问题。在java中这不会出现。

# linux - bc 命令对 obase=10 的行为很奇怪

> ID：14541683
> 
> 赞同：2
> 
> 时间：2013-01-26T21:19:31.393
> 
> 标签：linux, bc

今天我发现了 'bc' linux 命令，并在使用 outputbase 10 进行计算时发现了一个奇怪的行为。

```
echo "ibase=16;obase=9;AFBE" | bc
67638

echo "ibase=16;obase=11;AFBE" | bc
09 02 11 08

echo "ibase=16;obase=10;AFBE" | bc
AFBE 
```

好吧，命令 1 和 2 是正确的，但第三个命令只是打印输入值。

```
echo "ibase=16;AFBE" | bc
44990 
```

给出正确的结果。

这种行为有什么原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:35:41.483

你不是[第一个被这个抓住的人](https://stackoverflow.com/questions/9889839/bc-and-its-ibase-obase-options)。显然你需要在`obase` **之前** `ibase`设置：

```
echo "obase=10;ibase=16;AFBE" | bc
44990 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:35:42.600

显然，当它读取时`bc`使用你的：这就是为什么总是意味着“与”相同。`ibase``obase``obase=10``ibase`

在最新的示例中，您没有给出`obase=10`（这会将值设置为十进制 16），这就是为什么`obase`保留默认值（十进制 10）。

# css - 背景不适用于 div，因为它应该

> ID：14541687
> 
> 赞同：3
> 
> 时间：2013-01-26T21:20:00.693
> 
> 标签：css, url, html, background

我对路径有一个奇怪的问题，这个有效（在 Windows 上）：

```
<div style="background:url('folder1/image.gif')... 
```

但是这个不起作用（没有图像显示）：

```
<div style="background:url('/folder1/image.gif')... 
```

仍然这个页面说完全相反（不是第一个版本，但第二个版本应该可以工作）：[Background not working for a div](https://stackoverflow.com/questions/6062336/background-not-working-for-a-div)

有人知道可能是什么原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:24:48.437

第一个 url 相对于服务器中的文件夹，您的 HTML 用于呈现页面。

例如，如果你得到：

```
www.mywebsite.com/index.html 
```

它将调查：（*示例 2）*

```
www.mywebsite.com/folder1/image.gif 
```

但是如果您在另一个文件夹中，例如：

```
www.mywebsite.com/subfolder/index.html 
```

它将查看：

```
www.mywebsite.com/subfolder/folder1/image.gif 
```

如果您在开头使用“/”，则路径不是相对的，它总是在根网站中查找，就像示例 2 一样，无论您的 html 位于何处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:22:45.870

第一个是相对路径，第二个是绝对路径

相对路径显示来自调用上下文的文件路径。因此，如果您的 html 文件是 /source/website/test.html，则 的相对路径`css/test.css`将指向`/source/website/css/test.css`

绝对路径显示与整个路径有关，因此`/css/test.css`尝试在该位置查找文件`/css/test.css`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T21:23:51.103

取决于您的图像和 html 文件所在的位置。

`'folder1/image.gif'`将搜索与您的 html 文件（相对路径）位于同一路径的文件夹 1。

`'/folder1/image.gif'`将从服务器的基本位置（绝对路径）开始搜索文件夹 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T21:32:00.310

大多数现代浏览器都允许您检查网页上的元素。在 chrome（或其他现代浏览器）上打开控制台并查找错误，如果图像 url 错误，控制台将指示它为错误，此外，如果您指定了错误的 url，您将得到损坏的图像图标

![图像-1](../Images/4d45e447b9454bcb86db26d6ef73759f.png)

# asp.net-web-api - 在 Asp.Net WebAPI 中使用 Oauth2 令牌进行授权

> ID：14541702
> 
> 赞同：1
> 
> 时间：2013-01-26T21:21:23.530
> 
> 标签：asp.net-web-api, authorization, oauth-2.0, thinktecture-ident-model, thinktecture-ident-server

您好，我正在构建一个 ASP.Net WebApi。首先，我使用基本身份验证 .net 会员提供程序和**Thinktecture Identitymodel**授权了 WebApi 。

```
var authConfig = new AuthenticationConfiguration();

authConfig.AddBasicAuthentication((username, password) => Membership.ValidateUser(username, password));

config.MessageHandlers.Add(new AuthenticationHandler(authConfig)); 
```

我想这再简单不过了。

为了更进一步，我设置了 Thinktecture **IdentityServer**，它为我提供了**oauth2 令牌**。我的问题是**如何使用身份服务器验证客户端发送给我的访问令牌（WebApi）**？

我一直在研究 IdentityModel 提供的**AddJsonWebToken**方法，但我无法真正弄清楚我应该调用身份服务器中的哪个 uri（端点）来验证令牌。可能我只是完全迷失在这里并且错过了重点，任何帮助都会非常感激！

**总结一下：**

如何验证我在 WebApi 中收到的 access_tokens 以及如何将其连接到 [Authorize] 属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T13:31:44.807

只需在 Web api 配置中调用 AddJsonWebToken - 并添加颁发者名称、签名密钥和领域 uri。

无需调用 idsrv 进行验证。

这是一个示例： http: [//leastprivilege.com/2012/05/26/thinktecture-identitymodel-and-asp-net-web-api/](http://leastprivilege.com/2012/05/26/thinktecture-identitymodel-and-asp-net-web-api/)

# c# - PostMessage 意外行为

> ID：14541705
> 
> 赞同：0
> 
> 时间：2013-01-26T21:21:35.290
> 
> 标签：c#, postmessage

我在 PostMessage 度过了一段有趣的时光，想知道是否有人可以启发我。

下面的方法处理第一次左键单击而不是第二次左键单击，我做了一些混乱，发现使用 MessageBox 并点击 OK 甚至可以立即提供延迟/释放或进行第二次左键单击过程所需的任何内容。

```
public void MouseClick(IntPtr handle)
{
    PostMessage(handle, (uint)WMessages.WM_LBUTTONDOWN, 0, MAKELPARAM(521, 147));
    PostMessage(handle, (uint)WMessages.WM_LBUTTONUP, 0, MAKELPARAM(521, 147));
    //MessageBox.Show("WAITING...");
    PostMessage(handle, (uint)WMessages.WM_LBUTTONDOWN, 0, MAKELPARAM(675, 527));
    PostMessage(handle, (uint)WMessages.WM_LBUTTONUP, 0, MAKELPARAM(675, 527));
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-26T21:27:05.397

那是因为当您在 MouseClick 函数中时，主线程消息泵被挂起。消息框调用重新启用消息泵。您可以做的是调用 Application.DoEvents 或在另一个线程中执行此操作。

# c++ - 无法控制相机 FPS 风格

> ID：14541710
> 
> 赞同：0
> 
> 时间：2013-01-26T21:22:20.300
> 
> 标签：c++, opengl, camera, frame-rate

我最近用 C++ 开始了 openGL。我在 C++ 方面没有太多经验，但在其他语言方面有很好的经验。

我目前正在控制一个相机FPS风格来开始一个小游戏，并在我学习的同时一个接一个地添加东西。我知道这个问题经常被问到，我阅读了很多教程/论坛。

我用 gluLookAt() 做得很好；但我发现这不是控制 FPS 相机的最佳方式。我最近一直在使用矩阵堆栈，我有点迷茫。

我有一个代码工作，但我的旋转似乎是围绕中心轴或类似的东西。我还得到了一些可能与万向节锁定有关的奇怪控制。我对它们很有经验，一旦我有足够好的东西就会使用它们。

*   为什么我围绕中心轴而不是相机轴旋转？
*   关于如何在我的代码上下文中使用 glPopMatrix() 和 glPushMatrix() 的任何见解？我了解这些功能，但在控制相机时无法理解如何使用它们。

我试图保留最重要的代码，剩下的，渲染和主代码。鼠标和键盘控件按预期工作：

```
void renderScene(void) {

if(init==1){
    glTranslatef(0.0f,-1.0f,-5.0f);
    init = 0;
}
// Clear Color and Depth BuffersWDW
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

// Reset transformations
    //glLoadIdentity();

// Set the camera

glTranslatef(-deltaStrafe,0,-deltaMove);
glRotatef(Pitch,1.0f,0.0f,0.0f);
glRotatef(Yaw,0.0f,1.0f,0.0f);

// Draw ground

glColor3f(0.9f, 0.9f, 0.9f);
glBegin(GL_QUADS);
    glVertex3f(-50.0f, 0.0f, -50.0f);
    glVertex3f(-50.0f, 0.0f,  50.0f);
    glVertex3f( 50.0f, 0.0f,  50.0f); 
    glVertex3f( 50.0f, 0.0f, -50.0f);
glEnd();

// Draw 36 SnowMan
for(int i = -3; i < 3; i++)
    for(int j=-3; j < 3; j++) {
                 glPushMatrix();
                 glTranslatef(i*10.0,0,j * 10.0);
                 if(i==j){
                     drawSnowMan();
                 }
                 else{
                     drawTree();
                 }
                 glPopMatrix();
           }

glutSwapBuffers();
printConsole();
} 
```

和主要功能：

```
int main(int argc, char **argv) {

// init GLUT and create window
glutInit(&argc, argv);
glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);
glutInitWindowPosition(780,0);
glutInitWindowSize(800,800);
glutCreateWindow("Physic Engine");

// register callbacks
glutDisplayFunc(renderScene);
glutReshapeFunc(changeSize);
glutIdleFunc(renderScene);

// OpenGL init
glEnable(GL_DEPTH_TEST);

// enter GLUT event processing cycle
glutMainLoop();

return 1;
} 
```

谢谢！

编辑：按照建议将旋转/翻译顺序更改为：

```
glRotatef(Yaw,0.0f,1.0f,0.0f);
glRotatef(Pitch,1.0f,0.0f,0.0f);
glTranslatef(-deltaStrafe,0,-deltaMove); 
```

但是我的相机不是在自己的轴上旋转。它们似乎围绕中心轴旋转，如果我不移动，我将指向 (0,0,0)。如何作为标准 FPS 围绕相机轴旋转？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T23:39:27.193

你所做的是先翻译然后旋转。

旋转相机，平移相机，然后绘制场景。旋转始终围绕原点应用，因此如果先旋转然后平移，则应用旋转，然后平移旋转的参考系。

出于类似的原因，您还应该颠倒俯仰和偏航的顺序。

你还应该限制俯仰，这样你向上或向下旋转的角度不会超过 90 度，否则可能会迷失方向。

此外，除非您在任意轴上应用旋转，否则四元数不是必需的。

# ios - UIImageView 在加载更大的图像后调整大小

> ID：14541718
> 
> 赞同：2
> 
> 时间：2013-01-26T21:23:28.643
> 
> 标签：ios, objective-c, uiimageview, uiimage

我有一个`UIImageView`IB。我设置了框架和图像。关键是我的图像是 300x193，但后来我想更新一个更大的图像并`contentMode`在这个视图上使用一些。

所以一开始我有：

![在此处输入图像描述](../Images/3050a1d11b8975f90b635f451346fe90.png)![在此处输入图像描述](../Images/0a762da29ed67d6361be57d47de8d717.png)

所以我很清楚框架应该保持不变`310 116 300 193`，我想保持这种状态（这就是我使用`Scale To Fill` `ContentMode`.

所以我在这里有图像选择器，当我使用这段代码时：

```
-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    [self.imView setImage:[info objectForKey:UIImagePickerControllerOriginalImage]];

    [self dismissModalViewControllerAnimated:YES];

} 
```

我的 UIImageView 框架更改为：

```
(UIImageView *) $0 = 0x1c5c1ae0 <UIImageView: 0x1c5c1ae0; frame = (-160 20; 640 1136); opaque = NO; autoresize = RM+BM; layer = <CALayer: 0x1c5c1b40>> - (null) 
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T00:58:57.407

只需将宽度和高度约束添加到您的图像视图。我不知道你为什么没有自动得到那些，当我在图像视图中拖动时我得到了它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T22:01:34.693

我相信这是由自动布局引起的。布局允许视图增长以适应不同大小的图像，它确实如此。您是否有一个带有 >= 登录的蓝色“用户”约束？

在 IB 中的“显示文件检查器”下，您可以取消选中“使用自动布局”，您将看到行为更改以匹配您想要的内容。要使 Autolayout 生效并获得所需的行为，您可能需要查看每个约束以及它如何影响该视图的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T23:07:35.497

尝试将您的视图模式从 更改`Scale to Fill`为`Aspect to Fit`。

# php - 带有 hah 标签 (#) 的 URL 的 Kohana 路由

> ID：14541720
> 
> 赞同：0
> 
> 时间：2013-01-26T21:23:40.627
> 
> 标签：php, url-routing, kohana-3.2

我正在一个摄影网站上工作，我不希望每次用户通过单击缩略图进入新页面（即照片）时都刷新页面。同时，用户应该能够为 URL 添加书签并通过电子邮件/聊天发送链接。

因此，我在 URL 中使用哈希标签，并且 URL 将具有以下格式：

```
http://site.com/photo/#<photo_id>-<SEO> 
```

示例 - [http://site.com/photo/#12-blue-butterflies](http://site.com/photo/#12-blue-butterflies)

我花了很多时间写路线，我终于有一个，但不起作用，是：

```
Route::set('photo','photo(/#<id>(-<seo>))',
    array(
        'id' => '\d+',
        'seo' => '.*',
    ))
    ->defaults(array(
        'controller' => 'photo',
        'action'     => 'index',
    )); 
```

问题是，如果我从 URL 中删除哈希并 tweek 路由，我可以完成这项工作。使用哈希，似乎是不可能的。我想知道这是否可能。我们不能在 URL 中使用 # 是 kohana 设计的吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:25:06.257

和小荷没有关系。# 不在服务器端的 url 中使用，句号。它永远不会由浏览器发送。

哈希标签仅在客户端可用。例如，它可以被客户端 javascript 使用。

# css - IE8 / IE9 不加载 CSS

> ID：14541724
> 
> 赞同：2
> 
> 时间：2013-01-26T21:23:54.710
> 
> 标签：css, internet-explorer, stylesheet

在此站点[http://gaeilge2013.ie/](http://gaeilge2013.ie/)上，某些样式表未在 IE9 中加载。在 Chrome / Firefox / Opera / Safari 中一切都很好。很奇怪。

这是不适用的css：

`<link rel='stylesheet' id='dzs.timelineslider-css' href='http://gaeilge2013.ie/wp-content/plugins/dzs-timelineslider/timelineslider/timelineslider.css?ver=3.5.1' type='text/css' media='all' />`

链接很好。...

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T22:21:14.223

您遇到的问题是由于 IE 对样式表数量施加的限制。IE 最多只能在一个页面中加载 31 个单独的 CSS 文件。

网上有很多关于这个的参考资料，但[这里有一个来自 MSDN](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/ad1b6e88-bbfa-4cc4-9e95-3889b82a7c1d/)

这是 IE 中的硬限制。可以加载比使用特定技术更多的 CSS 文件：如果您使用`@import`从其他内部加载 CSS 文件，则可以为 31 个主要 CSS 文件中的每一个导入多达 31 个文件。但这不是一个理想的解决方案。

一般来说，如果可能的话，最好减少文件的数量——每个加载的文件都是一个单独的 HTTP 请求，并且拥有大量请求会对页面加载性能产生重大影响。

我的建议是尝试将您拥有的大量 CSS 文件合并到更少的文件中。这应该不是一项艰巨的任务，但是如果有必要，您可能会使用一些 WP 插件来自动为您执行此操作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-27T17:50:08.103

您可以使用 Modernizr 来解决此问题。它是一个强大的跨浏览器 javascript 插件，可以修复所有这些特殊情况，如多个 IE 版本和其他浏览器。

我把链接留在这里，你可以看看：

[http://modernizr.com/docs/#installing](http://modernizr.com/docs/#installing)

# python - Python - 使用列表而不是字符串？

> ID：14541725
> 
> 赞同：0
> 
> 时间：2013-01-26T21:23:58.660
> 
> 标签：python

[从一个 SO 答案](https://stackoverflow.com/questions/1228299/change-one-character-in-a-string-in-python)：

“不要修改字符串。

将它们作为列表使用；仅在需要时将它们转换为字符串。

...代码示例...

Python 字符串是不可变的（即它们不能被修改）。这有很多原因。使用列表直到你别无选择，然后才将它们变成字符串。”

这被认为是最佳实践吗？

我觉得 Python 有返回新修改字符串的方法（例如 upper()、title()、replace() 等）但没有返回新字符串的插入方法有点奇怪。我错过了这样的方法吗？

编辑：我试图通过插入一个字符来重命名文件：

```
import os
for i in os.listdir('.'):
    i.insert(3, '_') 
```

由于不可变性，这不起作用。添加到字符串的开头可以正常工作：

```
for i in os.listdir('.'):
    os.rename(i, 'some_random_string' + i) 
```

编辑2：解决方案：

```
>>> for i in os.listdir('.'):                                                │··
...  os.rename(i, i[:4] + '_' + i[4:]) 
```

切片当然很好并且解决了我的问题，但是有一个合乎逻辑的解释为什么没有返回新字符串的 insert() 方法吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:31:57.893

如果要在特定位置插入，可以使用切片和 +。例如：

```
a = "hello"
b = a[:2] + '_S1M0N_' + a[2:] 
```

那么 b 将等于 he_S1M0N_llo。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T21:32:03.867

*如果您对 string 进行大量修改，*这至少可以说是最佳实践。这*不是*通用的最佳实践。在进行繁重的字符串操作时，它只是一种解决性能问题的有用技术。

我的建议是，在性能成为问题之前不要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T21:59:04.410

[您可以使用切片](http://docs.python.org/2/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)语法定义适用于任何序列（字符串、列表、元组等）的通用函数：

```
def insert(s, c, p):
    return s[:p] + c + s[p:]

insert('FILE1', '_', 4)
> 'FILE_1' 
```

# android - 如何在画布上绘制大尺寸文本？

> ID：14541727
> 
> 赞同：5
> 
> 时间：2013-01-26T21:24:16.477
> 
> 标签：android, android-canvas, drawtext

我想沿着屏幕高度垂直绘制画布月的文本。

油漆初始化：

```
 this.paint = new Paint();
   this.paint.setAntiAlias(true);
   this.paint.setDither(true);
   this.paint.setSubpixelText(true);
   this.paint.setColor(color_text_dark);
   this.paint.setTextAlign(Align.RIGHT); 
```

绘画：

```
 // Set the scale to the widest month
   float scale = getHeight() / this.max_month_width;
   String month_string = FULL_MONTH_NAME_FORMATTER.
                         format(active_month_calendar.getTime());
   canvas.save();
   canvas.translate(getWidth(), 0);
   canvas.rotate(-90);
   canvas.scale(scale, scale);
   canvas.drawText(month_string, 0, 0, this.paint);
   canvas.restore(); 
```

~~*结果在hdpi*屏幕上看起来不错，但在*xhdpi*屏幕上非常丑陋和像素化。~~

我在各种设备上做了更多的测试，明白什么结果取决于安卓版本，而不是屏幕密度和分辨率。

代码在 2.x 平台上运行良好，但在 4.0.3+ 上无法运行。假设，Android draw 实现在这里被改变了。你可以[在这里](https://github.com/openintents/openintents/blob/master/calendarpicker/CalendarPicker/src/org/openintents/calendarpicker/view/FlingableMonthView.java)看到完整的代码。

~~**hdpi**~~ **2.3.5**版（也测试**了2.2**）

![hdpi](../Images/9273cf3858f644c4666c8754d33cc917.png)

~~**xhdpi**~~ **4.2**版（也测试**4.1**， **4.0.3**）

![xhdpi](../Images/109b60a58917f95db0e6f7b09b885f08.png)

尝试绘制抗锯齿的不同变体，亚像素文本没有效果。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T00:18:16.227

问题是您正在以一种尺寸绘制文本并将结果放大。一旦确定了文本的宽度，就应该调用 Paint.measureText()，通过 Paint.setTextSize() 相应地调整大小。一旦测量正确，您就可以调用 Canvas.drawText()。

另一种方法是根本不测量文本并立即调用：

```
paint.setTextSize(paint.getSize() * scale) 
```

但是，不能保证文本适合这种情况。

您的其他转换调用都不应该导致插值，因此它应该给您非常清晰的线条。

*编辑*

这是一个代码示例和比较屏幕截图：

```
canvas.save();
canvas.scale(10, 10);
canvas.drawText("Hello", 0, 10, mTextPaint);
canvas.restore();
float textSize = mTextPaint.getTextSize();
mTextPaint.setTextSize(textSize * 10);
canvas.drawText("Hello", 0, 300, mTextPaint);
mTextPaint.setTextSize(textSize); 
```

![你的渲染方法在上面，我的在下面](../Images/f07cbf59b9d604f39ec908ee6bbcfb57.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-21T06:41:09.523

我没有足够的声誉来评论 Krylez 的出色答案，但我想回复 mcfly soft 关于路径的评论/问题。

路径与文本的想法相同。与其缩放和平移绘制路径的画布，不如将相同的缩放和平移放入矩阵并将其传递给 Path.transform：

```
// instead of this:
canvas.scale(sX, sY);
canvas.translate(trX, trY);
canvas.drawPath(path);

// do this:
matrix.postScale(sX, sY);
matrix.postTranslate(trX, trY);
path.transform(matrix);
canvas.drawPath(path); 
```

# jpa-2.0 - 如何用 JPA 映射实体？

> ID：14541728
> 
> 赞同：0
> 
> 时间：2013-01-26T21:24:20.650
> 
> 标签：jpa-2.0, eclipselink

我无法为此类中的字段树获得正确的映射：

```
@Entity
@Table(name = "SushiMapTree")
public class SushiMapTree<K, V> extends Persistable implements Map<K,V> {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name="SushiMapID")
protected int ID;

@OneToOne(cascade = CascadeType.ALL)
@JoinTable(name="SushiMapTree_SushiTree")
private SushiTree<SushiMapElement<K, V>> tree = new SushiTree<SushiMapElement<K,V>>(); 
```

这是其他类及其映射：

```
@Entity
@Table(name = "SushiTree")
public class SushiTree<T> extends Persistable implements Collection<T> {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name="SushiTreeID")
protected int ID;

@Column(name="Test")
private String test = "Test";

@OneToMany(cascade = CascadeType.PERSIST)
@JoinTable(name="SushiTree_SushiTreeElements")
private List<SushiTreeElement<T>> treeElements = new ArrayList<SushiTreeElement<T>>();

@OneToMany(cascade = CascadeType.PERSIST)
@JoinTable(name="SushiTree_SushiTreeRootElements")
private List<SushiTreeElement<T>> treeRootElements = new ArrayList<SushiTreeElement<T>>(); 
```

}

```
@Entity
@Table(name = "SushiMapElement")
public class SushiMapElement<K, V> extends Persistable {

@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
private int ID;

@ManyToOne(cascade = CascadeType.PERSIST)
private SushiMapElement<K, V> parent;

@OneToMany(cascade = CascadeType.PERSIST)
private List<SushiMapElement<K, V>> children = new ArrayList<SushiMapElement<K, V>>();

@Column(name = "MapKey")
K key;

@Column(name = "MapValue")
V value; 
```

其他类运行良好，但我无法获得正确的映射。我用 Column、JoinColumn、JoinTable 等尝试了几个小时的不同映射。Eclipse Link 不会创建数据库并说要使用 ValueHolderInterface：

```
The attribute [tree] is not declared as type ValueHolderInterface, but its mapping uses indirection. 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:36:26.180

我用以下注释解决了这个问题：

```
 @ManyToOne(cascade=CascadeType.PERSIST)
   @JoinColumn(name="TreeID") 
```

但我不知道，为什么它会这样工作。

# java - Servlet 3：异步 - 无法推送部分响应

> ID：14541733
> 
> 赞同：4
> 
> 时间：2013-01-26T21:24:48.193
> 
> 标签：java, servlets, jakarta-ee, push, servlet-3.0

我正在使用 Tomcat 7。当我的异步 servlet 尝试以不同的时间间隔向客户端*推送*部分响应时，它不起作用。只有在整个响应准备好后才会刷新响应。

如何推送部分响应？

这是我的代码

```
@WebServlet(urlPatterns={"/home"} , name="asynch", asyncSupported=true)
public class CometServlet extends HttpServlet {

    public void doGet(final HttpServletRequest request, final HttpServletResponse response) throws IOException, ServletException
    {
        final  AsyncContext ac = request.startAsync();
        new MyThread(ac).start();
    }
} 
```

MyThread所做的是它会**定期**将 1 到 10 的数字写入响应对象。

```
class MyThread extends Thread
{
    AsyncContext ac;
    public MyThread( AsyncContext ac ) {
        this.ac = ac;
    }

    public void run()
    {
        int i =2 ; 
        while( i < 10 )
        {
            try
            {
            ac.getResponse().getWriter().print(i + "\n" );
            ac.getResponse().getWriter().flush();
            ac.getResponse().flushBuffer();
            Thread.sleep(1000);
            }
            catch (Exception e) {
                System.out.println("ccttt " + e);
            }
            i++;
        }
        ac.complete();
    }
} 
```

以及请求 servlet 的页面

```
<script type="text/javascript">
function show()
{
var xml = new XMLHttpRequest();
xml.open("GET", "http://localhost:8080/Comet/home", true );
xml.onreadystatechange=function()
{
    if (xml.readyState== 3|| xml.readyState == 4 ) {
    document.getElementById("dynamicContent").innerHTML=xml.responseText;
    }
}
xml.send(null);
}
</script>

<input type="button" value="show" onclick="show()"/> 
<div id="dynamicContent"> </div> 
```

大约 10 秒后，我在浏览器上看到了完整的响应。但我想每秒看到部分输出。

我想学习的是如何使用 Servlet 3 API 推送部分响应。

有人可以回答这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T22:35:02.160

请参阅[我](https://stackoverflow.com/questions/16788371/java-servlet-3-0-server-push-sending-data-multiple-times-using-same-asynccontex/16928314#16928314)对另一个问题中提到的完全相同的问题的回答。如果您在按照该答案中的说明操作后仍然遇到此问题，请告诉我。

# sql - 使用两个表中的条件从单行中选择重复项

> ID：14541735
> 
> 赞同：0
> 
> 时间：2013-01-26T21:24:55.647
> 
> 标签：sql, sqlite

我有两张桌子：

```
+---------+-----------------+----------+----------+----------+---------+
| TrackId |       URI       | ArtistID |  Title   | AlbumID  | BitRate |
+---------+-----------------+----------+----------+----------+---------+
|  1      | /home/music/... |   234    | atune    |  8958223 |   192   |
|  2      | /music/uri1/... |   427    | goodsong |  222     |   192   |
|  3      | /music/uri2/... |   427    | goodsong |  222     |   128   |
|  4      | /music/uri3/... |   427    | goodsong |  222     |   160   |
|  5      | /home/music/... |   427    | goodsong |  333     |   128   |
|  6      | /home/music/... |   522    | another  |  3458859 |   128   |
+---------+-----------------+----------+----------+----------+---------+ 
```

和

```
+----------+------------+
| AlbumID  | AlbumTitle |
+----------+------------+
|  8958223 |   titleA   |
|  222     |   titleB   |
|  333     |   titleC   |
|  3458859 |   titleD   |
+----------+------------+ 
```

简单地说，我想要的是这样的：

```
+---------+-----------------+----------+----------+----------+------------+---------+
| TrackId |       URI       | ArtistID |  Title   | AlbumId  | AlbumTitle | BitRate |
+---------+-----------------+----------+----------+----------+------------+---------+
|  3      | /music/uri2/... |   427    | goodsong |  222     |   titleB   |   128   |
|  4      | /music/uri3/... |   427    | goodsong |  222     |   titleB   |   160   |
+---------+-----------------+----------+----------+----------+------------+---------+ 
```

这是尝试删除具有以下内容的重复项：

*   同名
*   相同的艺术家 ID
*   不同的轨道ID
*   非最高比特率重复
*   专辑表中的相同专辑名称

同时不返回具有最高比特率副本的条目

我在这里问了一个非常相似的问题：[从单行中选择重复项？](https://stackoverflow.com/questions/9881855/select-duplicates-from-a-single-row)

解决方案是：

```
SELECT c1.*
  FROM CoreTracks c1
      ,(SELECT Title, ArtistID, MAX(FileSize) AS maxFileSize, MAX(BitRate) maxBitRate
          FROM CoreTracks
          GROUP BY Title, ArtistID) c2
  WHERE c1.Title = c2.Title
    AND c1.ArtistID = c2.ArtistID
    AND (c1.FileSize != c2.maxFileSize AND c1.BitRate != c2.maxBitRate) 
```

...但这次我似乎无法专心处理另一张桌子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:42:47.467

第二个表与您的用例无关，因为您在第一个表中有对 AlbumId 的 FK 引用

```
select t.*, a.AlbumTitle
from Track t
inner join (
    select max(BitRate) as BitRate, ArtistId, Title, AlbumId
    from Track
    group by ArtistId, Title, AlbumId ) b
  on t.ArtistId = b.ArtistId and t.Title = b.Title and t.AlbumId = b.AlbumId and t.BitRate < b.BitRate
inner join Album a
      on t.AlbumId = a.AlbumId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:47:29.263

试试这个：

```
SELECT c1.*
FROM CoreTracks c1
LEFT JOIN 
     (SELECT Title, ArtistID, AlbumID, MAX(BitRate) maxBitRate
      FROM CoreTracks
      GROUP BY Title, ArtistID, AlbumID) c2
    ON c1.Title = c2.Title
    AND c1.ArtistID = c2.ArtistID
    AND c1.AlbumID = c2.AlbumID
    AND c1.BitRate = c2.maxBitRate
WHERE c2.Title IS NULL 
```

这是[SQL 小提琴](http://sqlfiddle.com/#!2/fb5f8/6)。

- 编辑

添加专辑标题：

```
SELECT c1.*, a.AlbumTitle
FROM CoreTracks c1 
JOIN Albums a on c1.AlbumId = a.AlbumId
LEFT JOIN 
     (SELECT c.Title, c.ArtistID, c.AlbumID, MAX(c.BitRate) maxBitRate
      FROM CoreTracks c JOIN Albums A ON c.AlbumId = a.AlbumId
      GROUP BY Title, ArtistID, AlbumID) c2
    ON c1.Title = c2.Title
    AND c1.ArtistID = c2.ArtistID
    AND c1.AlbumID = c2.AlbumID
    AND c1.BitRate = c2.maxBitRate
WHERE c2.Title IS NULL 
```

和更新的[小提琴](http://sqlfiddle.com/#!2/6dc4e/8)。

祝你好运。

# nginx - php5-fpm 崩溃

> ID：14541737
> 
> 赞同：2
> 
> 时间：2013-01-26T21:25:01.397
> 
> 标签：nginx, crash, webserver, debian, php

我有一个运行 debian 和 php5-fpm 的网络服务器（nginx）随机似乎崩溃，如果我调用 php 文件，它会回复 504 bad gateway。

当它处于崩溃状态并且我执行 sudo /etc/init.d/php5-fpm 它说它正在运行，但它仍然会给出 504 bad gateway 直到我执行 sudo /etc/init.d/php5- fpm

我在想这可能与我的一个 php 文件有关，该文件处于无限循环中，直到某个事件发生（mysql 数据库中的更改）或直到它超时。我不知道这通常是否是一件好事，或者我是否应该在超时发生之前让循环自行退出。

谢谢指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-23T08:31:20.430

首先查看 nginx error.log 中的实际错误。我不认为 PHP 崩溃了，只是你的循环正在使用所有可用的 php-fpm 进程，所以没有免费的可以为你的下一个来自 nginx 的请求提供服务。这应该会在日志中产生超时错误（nginx 将等待一段时间以获得可用的 php-fpm 进程）。

关于你的第二个问题。您不应该为此使用无限循环。如果这样做，请`sleep()`在循环内插入命令 - 否则您将使用该循环使 CPU 过载，并且还会使用查询使数据库过载。

此外，我想在该循环中有一个 PHP 进程等待事件就足够了。在这种情况下，使用某种类型的信号量（数据库中的文件或信息）让其他进程知道一个已经在等待该事件。否则你总是会吃光所有可用的 PHP 进程。

# c# - EF 入门 (SqlServerCe)

> ID：14541739
> 
> 赞同：-2
> 
> 时间：2013-01-26T21:25:13.620
> 
> 标签：c#, entity-framework, sql-server-ce-4

我正在 WPF 中创建一个应用程序，我想使用 SQL Server Compact 4.0 连接到数据库。

我将数据库添加到项目中。并使用我添加的 NuGet

*   `System.Data.SqlServerCe`
*   `System.Data.SqlServerCe.Entity`

在我`app.config`的连接字符串中添加了：

```
 <connectionStrings>
    <add name="Biblionerzy.Properties.Settings.Database1ConnectionString"
      connectionString="Data Source=|DataDirectory|\Database1.sdf"
      providerName="Microsoft.SqlServerCe.Client.4.0" />
  </connectionStrings>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="System.Data.SqlServerCe.4.0" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework> 
```

我创建了一个简单的类：

```
namespace Biblionerzy
{
   public class model
    {
        [Key] 
        public int Id { get; set; }
        public string Pytanie { get; set; }
        public string A { get; set; }
        public string B { get; set; }
        public string C { get; set; }
        public string D { get; set; }
        public string Prawidlowa_odp { get; set; }
        public int Stawka { get; set; } 
    }

   public class PytaniaModel : DbContext
   {
       public DbSet<model> Modele { get; set; }
   }
} 
```

现在，我怎样才能将任何东西添加到数据库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:09:08.703

我认为您只是想先开始使用 EF 代码（如果没有，我将删除答案）。

从您的问题的外观来看，您已经完成了所有设置。

您可能需要添加一个 [Key] 属性，我无法理解下面的内容，所以我只是添加了一个属性 Id，我给了 [Key] 属性。

```
 public class model
    {
        [Key]
        public int Id {get;set;}
        public string Pytanie { get; set; }
        public string A { get; set; }
        public string B { get; set; }
        public string C { get; set; }
        public string D { get; set; }
        public string Prawidlowa_odp { get; set; }
        public int Stawka { get; set; } 
    }

   public class PytaniaModel : DbContext
   {
       public DbSet<model> Modele { get; set; }
   } 
```

只需实例化一个类的对象并使用它......

```
 var dbContext = new PytaniaModel();
   dbContext.Modele.Add(new Model());
   dbContext.SaveChanges(); 
```

就是这样，检查您的数据库并验证数据库是否已创建并且您将第一行存储在表中。

# java - 用于从网站下载图像并显示文件大小的 Java 程序

> ID：14541740
> 
> 赞同：3
> 
> 时间：2013-01-26T21:25:24.650
> 
> 标签：java, html, html-parsing, image, htmlunit

我正在创建一个 java 程序，它将从 URL 读取 html 文档并在代码中显示图像的大小。我不确定如何实现这一目标。

我不需要实际下载和保存图像，我只需要它们在网页上出现的大小和顺序。

例如：一个网页有 3 张图片

```
<img src="dog.jpg" /> //which is 54kb
<img src="cat.jpg" /> //which is 75kb
<img src="horse.jpg"/> //which is 80kb 
```

我需要我的 java 程序的输出来显示

```
54kb
75kb
80kb 
```

任何想法我应该从哪里开始？

ps 我是一个java新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:31:54.680

你应该把你的问题分成3个子问题

1.  [下载](https://stackoverflow.com/questions/5882005/how-to-download-image-from-any-web-page-in-java)HTML 文档
2.  [解析 HTML](https://stackoverflow.com/questions/238036/java-html-parsing)文档并找到图像
3.  [下载图像](https://stackoverflow.com/questions/5882005/how-to-download-image-from-any-web-page-in-java)并[确定其大小](https://stackoverflow.com/questions/116574/java-get-file-size-efficiently)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-26T22:22:31.010

如果您是 Java 新手，您可能希望利用现有库使事情变得更容易一些。 [Jsoup](http://jsoup.org)允许您使用 CSS 样式的选择器获取 HTML 页面并提取元素。

这只是一个快速且*非常*肮脏的示例，但我认为它将展示 Jsoup 可以轻松完成这样的任务。请注意，省略了错误处理和响应代码处理，我只是想传递大致的想法：

```
Document doc = Jsoup.connect("http://stackoverflow.com/questions/14541740/java-program-to-download-images-from-a-website-and-display-the-file-sizes").get();

Elements imgElements = doc.select("img[src]");
Map<String, String> fileSizeMap = new HashMap<String, String>();

for(Element imgElement : imgElements){
    String imgUrlString = imgElement.attr("abs:src");
    URL imgURL = new URL(imgUrlString);
    HttpURLConnection httpConnection = (HttpURLConnection) imgURL.openConnection();
    String contentLengthString = httpConnection.getHeaderField("Content-Length");
    if(contentLengthString == null)
        contentLengthString = "Unknown";

    fileSizeMap.put(imgUrlString, contentLengthString);
}

for(Map.Entry<String, String> mapEntry : fileSizeMap.entrySet()){
    String imgFileName = mapEntry.getKey();
    System.out.println(imgFileName + " ---> " + mapEntry.getValue() + " bytes");
} 
```

您也可以考虑查看[Apache HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)。我发现它通常比原始的 URLConnection/HttpURLConnection 方法更可取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T21:29:30.907

您可以使用正则表达式来查找标签并获取图像 URL。之后，您将需要 HttpUrlConnection 类来获取图像数据并测量其大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-26T21:30:05.443

你可以这样做：

```
try {
    URL urlConn = new URL("http://yoururl.com/cat.jpg");
    URLConnection urlC = urlConn.openConnection();
    System.out.println(urlC.getContentLength());
} catch (MalformedURLException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

# php - 在 PHP 中 exec(sleep NUMBER; anotherCommand) 时如何继续执行？

> ID：14541741
> 
> 赞同：2
> 
> 时间：2013-01-26T21:25:40.320
> 
> 标签：php, html, linux

我有这个代码：

```
<?php
    exec("sleep 15m; ls -l");
    echo "Done";
?> 
```

但它卡住了，直到 15 分钟后才会停止加载，无论如何不等待 exec 执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T22:48:29.843

从[PHP - 执行](http://php.net/manual/en/function.exec.php)

> **执行**
> ...
> **注意**：
> 
> 如果使用此函数启动程序，为了使其继续在后台运行，程序的输出必须重定向到文件或另一个输出流。否则将导致 PHP 挂起，直到程序执行结束。

所以你必须重定向输出*并*在后台启动它

```
exec("(sleep 15m; ls -l) >/dev/null 2>&1 &"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:30:10.370

如果我理解正确，您想在后台执行您的命令：

```
exec("(sleep 15m ; ls -l) &") 
```

# asp.net - 是否可以流式传输 html5 视频？

> ID：14541742
> 
> 赞同：2
> 
> 时间：2013-01-26T21:25:47.607
> 
> 标签：asp.net, html, video-streaming, html5-video

我有一个显示视频的网站。它似乎适用于 HTML5 视频标签引用的 5 分钟“webm”和“mp4”视频。但如果我使用长视频，我担心网站会不堪重负。该网站使用 ASP.net，我确实找到了一篇关于使用 asp.net 渐进式下载大文件的文章。但是，我不知道获取小文件包是否会干扰用户进行“搜索”（例如，将控制栏位置拖动到他感兴趣的点）。我也不知道它是否会流式传输不需要流式传输的页面。
有什么办法可以解决一次通过 Internet 发送的视频数据过多，使我的服务器或用户的 PC 不堪重负的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-12T15:00:48.723

这应该可以帮助您：[通过 .NET HTML5 流式传输 MP4 视频](https://stackoverflow.com/questions/16421255/streaming-mp4-video-through-net-html5)

搜索和缓冲由播放器自己处理，是的，当您搜索视频中的新点时，它会自动请求视频的这些部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T22:49:43.250

没有办法对 HTML5 视频进行自适应流式传输，但您不必担心在长视频中寻找。现代网络服务器允许浏览器请求文件块，因此如果用户正在观看一个很长的视频并直接跳到中间，浏览器将从头开始停止下载并开始从他们跳过的位置检索视频文件。与早期的 Flash 视频形成对比，当您必须等待视频文件的整个开头按顺序下载才能到达要观看的中间部分时。

但是，您可以采取一些措施来节省带宽并让您的服务器满意。

首先，如果用户已经开始观看视频并且已经看完了，您可以确保浏览器不会继续下载该大文件的其余部分。例如，如果您在单个页面上切换多个视频，或者如果您使用 Ember.js 或 Backbone 之类的框架在多个“页面”中导航而实际上没有将浏览器指向新 URL，则可能会发生这种情况。

如果您暂停视频并将其从 DOM 中删除，浏览器可能仍在下载它。但是你可以用这样的代码来阻止它：

```
video.src = "";
video.load(); 
```

另外，考虑将您的视频文件存储在[CDN](http://en.wikipedia.org/wiki/Content_delivery_network)上。这样，运行 ASP 脚本、与数据库通信和处理其他相关逻辑的服务器也不负责提供这些大文件。还有[其他好处](http://developer.yahoo.com/performance/rules.html#cdn)，例如拥有单独且更高效的标头以及在地理上更接近用户的多个位置拥有服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T23:08:55.597

HTML5 引入了[MediaStream API](http://www.w3.org/TR/mediacapture-streams/)，它旨在捕获和流式传输视频和音频数据，主要用于访问本地媒体设备，例如网络摄像头。但是使用与 XHR 连接的 MediaStream 对象，您应该能够在没有其他插件的情况下提供视频流。浏览器支持现在还没有普及，并且在非最新版本的 Firefox 和 Chromium 中，您必须通过某种设置（例如`about:flags`在 Chromium 中）启用它。

我不知道从服务器流式传输视频的任何工作实现，我最近只是在玩网络摄像头数据。我认为这是可能的（有时甚至有广泛的浏览器支持;-)。请注意，HTML5 由许多不同的 API 组成，其中大部分您通常会通过 JS 使用。

另请参阅：[http ://www.html5rocks.com/en/tutorials/webrtc/basics/?redirect_from_locale=de#toc-mediastream](http://www.html5rocks.com/en/tutorials/webrtc/basics/?redirect_from_locale=de#toc-mediastream)

# hadoop - 如何在 hadoop 中处理大量小文件？

> ID：14541759
> 
> 赞同：8
> 
> 时间：2013-01-26T21:28:09.250
> 
> 标签：hadoop

我是 hadoop 新手，我正在处理 wordcount 示例中的大量小文件。它需要大量的地图任务并导致我的执行速度变慢。

如何减少地图任务的数量？

如果我的问题的最佳解决方案是将小文件转换为更大的文件，我该如何对它们进行分类？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T22:01:21.313

如果您使用类似`TextInputFormat`的东西，问题是每个文件至少有 1 个拆分，因此地图数量的上限是文件的数量，在您有很多非常小的文件的情况下，您最终会得到许多映射器处理每个非常少的数据。

为了解决这个问题，您应该使用`CombineFileInputFormat`which 将多个文件打包到同一个拆分中（我认为达到块大小限制），因此使用这种格式，映射器的数量将独立于文件的数量，它只取决于数据量。

您必须通过扩展来创建自己的输入格式，您可以[在此处](https://stackoverflow.com/a/14284330/1332690)`CombineFileInputFormt`找到实现。一旦你定义好了，让我们像在链接中那样调用它，你可以告诉你的工作使用它：`InputFormat``CombinedInputFormat`

```
job.setInputFormatClass(CombinedInputFormat.class); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T02:22:27.923

Cloudera 在某个时候发布了[一篇](http://blog.cloudera.com/blog/2009/02/the-small-files-problem/)关于小文件问题的博客。这是一个旧条目，但建议的方法仍然适用。

# javascript - 链接到自动展开的树形菜单文本禁用文本中的链接

> ID：14541760
> 
> 赞同：1
> 
> 时间：2013-01-26T21:28:14.017
> 
> 标签：javascript, jquery, hyperlink

我发现了这个主题：[如何直接链接到常见问题解答选项](https://stackoverflow.com/questions/8188833/how-to-link-directly-to-an-faq-option-expanded)，并在我的网站中使用了这个脚本：

```
$(window).load(function(){
   $('.expand_text').each(function() {
      $(this).css("display", "none");
   });
   $('.treenode').click(function() {
      $(this).next('.expand_text').slideToggle("fast")
      return false;
   });
   (function(hash){
      if (hash !== undefined && hash.substring(0,1) === "#") {
         $(hash).slideToggle("fast");
      }
   })(window.location.hash);
}); 
```

所以现在我可以提供一个特定页面的链接，该页面打开时会自动展开其中一个菜单项。例如：[http](http://drgiannopoulos.com/estheticdentistry.html#bleach) ://drgiannopoulos.com/estheticdentistry.html#bleach它是希腊语，但很明显，您可以在第一个菜单项展开的情况下登陆页面。但是，如果您向下滚动一点，您会注意到两个带下划线的三个字母的单词（再次抱歉，它是希腊语！）。这些是链接，它们不起作用！您可以右键单击并选择“在新选项卡/窗口中打开”，这将正常工作，但简单的左键单击已变为非活动状态。我认为这与上面提到的脚本有关，因为我对这一切完全陌生，所以我需要你的帮助。谢谢

# lambda - Lambda 表达式仅在非 null 和 count() 时按 3 个不同字段分组

> ID：14541768
> 
> 赞同：0
> 
> 时间：2013-01-26T21:29:40.157
> 
> 标签：lambda, linq-to-entities, grouping

这是我的模型。

```
public class Notification
{
    public int NotificationID { get; set; }
    public bool ReadStatus { get; set; }
    public DateTime DateCreated { get; set; }
    [ForeignKey("User"), Column(Order=0)]
    public int UserID { get; set; }
    [ForeignKey("Actor"), Column(Order = 1)]
    public int ActorID { get; set; }

    [ForeignKey("NotificationType")]
    public int NotificationTypeID { get; set; }
    //public int ObjectID { get; set; }
    [ForeignKey("Comment")]
    public int? CommentID { get; set; }
    [ForeignKey("Project")]
    public int? ProjectID { get; set; }
    [ForeignKey("Book")]
    public int? BookID { get; set; }

    public Comment Comment { get; set; }
    public Book Book { get; set; }
    public Project Project { get; set; }
    public NotificationType NotificationType { get; set; }
    public User User { get; set; }
    public User Actor { get; set; }
} 
```

任何给定的行将只有以下之一：`BookID`，， 我想获得总通知的计数，但我必须按这三个 ID 之一对它们进行分组`ProjectID`，其他两个 ID 为空。可能有 10 条评论通知，但其中 5 条用于回复，5 条用于其他操作 - 不过应该只有两条通知，而不是 10 条。`CommentID``NotificationType`

我将如何编写一个 lambda 表达式来获得这些计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:31:50.933

以下将起作用。

```
 var notificationCount = db.Notifications
      .GroupBy(x => new { x.CommentID, x.ProjectID, x.BookID, x.NotificationTypeID })
      .Count(); 
```

基于[这个答案](https://stackoverflow.com/questions/6935264/group-by-with-multiple-columns-using-lambda)

# php - 在虚拟主机上发布后 php 会话不起作用

> ID：14541771
> 
> 赞同：2
> 
> 时间：2013-01-26T21:30:04.557
> 
> 标签：php, session, session-variables

我的网站在 localhost 上运行良好，但是一旦我将它部署到我的托管服务，会话就会停止工作。

```
<?php 

session_start();
session_save_path('log/session.txt');
ini_set('session.gc_probability', 1);
error_reporting(E_ALL ^ E_NOTICE);
date_default_timezone_set("Asia/Jakarta");
require_once 'jadwal/calendar/tc_calendar.php';

include "../metode/data.php"; 
include "../metode/jalan.php";
include "../metode/perintah.php";
include "../metode/gambar.php";

//session
$queryadmin = mysql_query("select * from root");
$dataadmin = mysql_fetch_row($queryadmin);
$id = $dataadmin[0];
$key1 = $dataadmin[1];

if (isset($_POST['admin'])) {
    $_SESSION['id'] = $_POST['x'];
    $_SESSION['key1'] = $_POST['xx'];
}
if (isset($_POST['root'])) {
    $_SESSION['user'] = $_POST['xxx'];
    $_SESSION['key2'] = $_POST['xxxx'];
}
if (isset($_POST['clear'])) {
    $_SESSION['id'] = "";
    $_SESSION['key1'] = "";
    $_SESSION['user'] = "";
    $_SESSION['key2'] = ""; 
}
if (isset($_POST['exit'])) {
    $_SESSION['id'] = "";
    $_SESSION['key1'] = "";
}

//access
if ($_SESSION['id'] == $id && $_SESSION['key1'] == $key1) {
    $user = $dataadmin[3];
    $key2 = $dataadmin[2];
    if ($_SESSION['user'] == $user && $_SESSION['key2'] == $key2) {
        mysql_query("insert into root history values('','".$_POST['day']."','".$_POST['time']."')");
    print "<br><br><br>";
    include_once "jembatan.php";
    } else {
        include "root.php";
    }
}
else {
    include "admin.php";
}

?> 
```

如果您需要我显示任何其他文件，请询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:32:44.740

可能是您的主机设置 PHP 的方式。尝试在主机上打印 phpinfo() 并检查它们的设置。

要运行 phpinfo 函数，只需运行如下所示的脚本：

```
<?php
    phpinfo();
?> 
```

输出将包括一个巨大的设置列表，但你正在寻找这个部分：

![在此处输入图像描述](../Images/4c2a8b6d9e5c7fb22de10bd97f7ca133.png)

请注意我的设置如何显示**Session Support = enabled**。这表明我的主机（在我的例子中是本地主机）支持会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:31:50.153

确保在标记之前没有空格或新行`<?php`，因为您在此处的代码在它之前包含 3 个空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-06T12:10:07.190

直到这个答案可能会出现，我最近遇到了同样的问题，经过多次试验和错误。我发现会话上方有最轻微的 HTML 标记可能会阻止会话不注册。所以确保你在顶部的第一件事是

```
<?php
session_start();
?>
```

# javascript - HTML5 拖放 - Firefox 被重定向

> ID：14541775
> 
> 赞同：19
> 
> 时间：2013-01-26T21:30:13.600
> 
> 标签：javascript, html, firefox, drag-and-drop

我正在尝试在我的应用程序中实现 html5 的拖放，但 Firefox 总是被重定向到拖放图像的源。我正在使用`e.stopPropagation()`. 在 Chromium 中，一切都按预期工作。奇怪...这是代码：

```
<html>
 <head>
  <meta charset="utf-8" />
  <title>DuOS 0.0.0</title>
  <meta name="author" content="Jan Durrer, Michal Grňo" />
  <link rel="stylesheet" href="./default.css" />
 </head>
 <body>
  <script src="./boot.js"></script>
  <script src="./window.js"></script>
  <script src="./omnibox.js"></script>
  <section class="desktop">
   <img class="icon" id="computer" style="left: 0px; top: 340px;" src="./image/icon/system/computer.png" />
   <img class="icon" id="folder" style="left: 0px; top: 170px;" src="./image/icon/system/documents.png" />
   <img class="icon" id="bin" style="left: 0px; top: 0px;" src="./image/icon/system/bin.png" />
  </section>
  <script>
   window.clickedIcons = Array();
   window.draggedIcon = {};
   window.draggedIcon.offset = Array();
   window.draggedIcon.element = null;

   //Pohybování
   function drag_start(e) {
    window.draggedIcon.element = e.target;
    event.dataTransfer.effectAllowed = 'copyMove';
    event.dataTransfer.setData('text/plain', 'hola'); //hack

    var style = window.getComputedStyle(event.target, null);
    window.draggedIcon.offset[0] = parseInt(style.getPropertyValue("left"),10) - event.clientX; console.log(window.draggedIcon.offset[0]);
    window.draggedIcon.offset[1] = parseInt(style.getPropertyValue("top" ),10) - event.clientY; console.log(window.draggedIcon.offset[1]);
    window.draggedIcon.element = event.target;
   }

   function drag_over(e) {
    e.preventDefault();
    return false;
   }

   function drop(e) {
    window.draggedIcon.element.style.left = (event.clientX + window.draggedIcon.offset[0]) + 'px';
    window.draggedIcon.element.style.top  = (event.clientY + window.draggedIcon.offset[1]) + 'px';
    window.draggedIcon.element.style.visibility = 'visible';
    window.draggedIcon.element = null;
    if(e.stopPropagation) {e.stopPropagation();}
    return false;
   }
   var xresult = document.evaluate('//body/*[@class="desktop"]/*[@class="icon"]', document, null, XPathResult.ANY_TYPE, null);
   var dm = xresult.iterateNext();
   while (dm) {
    dm.addEventListener('dragstart',drag_start,false);
    dm.addEventListener('click',click,false);
    dm = xresult.iterateNext();
   }

   document.body.addEventListener('dragover',drag_over,true);
   document.body.addEventListener('drop',drop,true);
  </script>
 </body>
</html> 
```

谢谢你的帮助，m93a。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-26T22:29:39.170

您需要[阻止默认操作](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)：

```
function drop(e) {
    if(e.preventDefault) { e.preventDefault(); }
    if(e.stopPropagation) { e.stopPropagation(); }
    window.draggedIcon.element.style.left = (event.clientX + window.draggedIcon.offset[0]) + 'px';
    window.draggedIcon.element.style.top  = (event.clientY + window.draggedIcon.offset[1]) + 'px';
    window.draggedIcon.element.style.visibility = 'visible';
    window.draggedIcon.element = null;
    return false;
} 
```

# sql - 出现错误 ORA-00936: 缺少表达式

> ID：14541780
> 
> 赞同：3
> 
> 时间：2013-01-26T21:31:06.193
> 
> 标签：sql, oracle, oracle10g, ora-00936

当我尝试以下 SQL 时，我收到错误 ORA-00936：缺少表达式。请帮助我，我希望在 Oracle SQL 中的列上有所不同

```
SELECT rr.RPT_QUE_I, 
       DISTINCT (rr.ed_sbmt_m, rr.RPT_RUN_STAT_C),
       rr.rpt_cstm_x,
       rr.rpt_cmplt_m,
       CASE 
         WHEN rr.rpt_run_stat_c = 25453 THEN 'PENDING' 
         WHEN rr.rpt_run_stat_c = 25454 THEN 'ACTIVE' 
         WHEN rr.rpt_run_stat_c = 25455 THEN 'FINISHED' 
         WHEN rr.rpt_run_stat_c = 25458 THEN 'ERROR' 
         WHEN rr.rpt_run_stat_c = 25460 THEN 'SCHEDULED' 
       END,
       cc.pro_sym_I,
       rr.usr_wad_ownr_i 
  FROM audit_REPORT_RUN rr, 
       CLIENT_COMPANY cc
 WHERE rr.ED_SBMT_M > TO_DATE('06/01/2012','mm/dd/yyyy') 
   AND rr.ED_SBMT_M < TO_DATE('07/01/2012','mm/dd/yyyy') 
   AND rr.ORG_I = cc.ORG_I
ORDER BY rr.RPT_QUE_I 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T02:13:06.237

你应该`DISTINCT`在关键字之后首先使用`SELECT`关键字，并删除括号，或者如果你需要对其中的一些进行分类，使用`GROUP BY`函数。希望你得到想要的结果。

# android - 显示超时消息不会强制关闭应用程序

> ID：14541787
> 
> 赞同：1
> 
> 时间：2013-01-26T21:31:56.250
> 
> 标签：android

我想向用户显示超时消息，而不是强制关闭应用程序

这是我的代码

```
String xml = null;

BasicHttpParams params = new BasicHttpParams();
ConnManagerParams.setTimeout(params, 1000);
HttpConnectionParams.setConnectionTimeout(params, 5000);
HttpConnectionParams.setSoTimeout(params, 5000);

// defaultHttpClient
DefaultHttpClient httpClient = new DefaultHttpClient(params);
HttpPost httpPost = new HttpPost(url);

try {
    HttpResponse httpResponse = httpClient.execute(httpPost);
    HttpEntity httpEntity = httpResponse.getEntity();
    xml = EntityUtils.toString(httpEntity);
} catch (UnsupportedEncodingException e) {
    //e.printStackTrace();
} catch (ClientProtocolException e) {
    //e.printStackTrace();
} catch (IOException e) {
    //e.printStackTrace();
}finally{
    httpClient.getConnectionManager().shutdown();
}
return xml; 
```

如果连接超时应用程序强制关闭并给我这个错误：

```
 org.apache.http.conn.ConnectTimeoutException: Connect to /xx.xx.xx.xx:xx timed out 
```

# ruby-on-rails - rails mongoid url 更短

> ID：14541793
> 
> 赞同：1
> 
> 时间：2013-01-26T21:32:08.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid, url-shortener, mongoid3

我已经开始创建一个基于模型的解决方案来创建短 URL，但我想知道在它自己的集合（使用 mongoid）中为模型之间的标记构建索引然后搜索是否会更好？或者，如果存在宝石而不是滚动我自己的解决方案。

现在我正在使用 Mongoid::Token 为特定集合生成唯一令牌（即 cUaIxBu），然后使用附加字母（->（c）UaIxBu）来确定如何将特定请求路由到哪个控制器。

任何想法或指示？

在此示例中，alternatedoma.in/cUaIxBu 将指向 realdomain.com/cities/1234

# 路线

```
 get '/:id' => 'home#tiny_url', :constraints => { :domain => 'alternatedoma.in' } 
```

# 控制器

```
 def tiny_url
    case params[:id].slice!(0)
    when 'f'
      @article = Article.find_by_token(params[:id])
      redirect_to feature_url(@article)
    when 'c'
      @city = City.find_by_token(params[:id])
      redirect_to city_url(@city)
    when 'p'
      @place = Place.find_by_token(params[:id])
      redirect_to feature_url(@place)
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T13:29:31.660

我们在我目前正在开发的应用程序中使用了几乎相同的系统——而且它似乎运行良好（到目前为止！）。我唯一能想到的是，您可以简化您的 LoC，并在将来轻松添加对其他模型的支持（如果需要）：

```
supported_models = {:a => Article, :c => City, :p => Place}
prefix = params[:id].slice!(0).to_sym
if supported_models.has_key?(prefix)
  @obj = supported_models[prefix].find_by_token(params[:id])
  redirect_to send(:"#{supported_models[prefix].name.underscore}_url", @obj)
end 
```

显然，这将要求您的路由助手遵循与您的模型相同的命名。即：`Article`> `article_url`，`City`>`city_url`等。

# java - 在 libgdx 中翻转多边形

> ID：14541812
> 
> 赞同：0
> 
> 时间：2013-01-26T21:34:38.617
> 
> 标签：java, scala, geometry, libgdx

我有在 libgdx 中工作的平铺地图，现在我正试图与这些地图发生碰撞。我认为在 Tiled 中绘制多边形并将它们用于 libgdx 中的碰撞会非常有用。实际上，我更喜欢这种方式，而不是进行每个瓷砖碰撞，因为它会给我游戏所需的碰撞灵活性。

我已经成功解析了每个对象的 xml 并抓取了多边形点。我已经能够用这些制作一个 box2d PolygonShape，它会出现在游戏中！但它是颠倒的镜像...

我认为 tiled 必须位于与 libgdx 不同的坐标系上，所以我只是创建了一个函数，它找到最大 y 点并以正确的 y 翻转方式从中减去其余的 y 点。但现在我收到了这个错误：

```
java: /var/lib/hudson/jobs/libgdx-git/workspace/gdx/jni/Box2D/Collision/Shapes/b2PolygonShape.cpp:115: b2Vec2 ComputeCentroid(const b2Vec2*, int32): Assertion `area > 1.19209289550781250000e-7F' failed. 
```

从 libgdx 的本机端来看，这看起来像是一个错误。**有没有人可以帮我解决这个问题？**

这是我的 tmx 文件中的相关部分。

```
<objectgroup height="20" name="Object Layer 1" width="20">
 <object x="100" y="320">
   <polygon points="0,0 244,1 300,50 300,95 -12,88 -29,19"/>
 </object>
 <object height="104" width="116" x="437" y="175"/>
</objectgroup> 
```

这是一段代码，它在 Scala 中，用于翻转多边形。它需要一个 Border 对象，该对象具有一个多边形字段，该字段只是一个 Vector2s 数组。_type 字段是一个符号，看起来它与 stackoverflow 的语法突出显示混淆了。

```
def flipPolygonY(border: Border){
    if(border._type == 'polygon){
        //find the highest y point
        var max = border.polygon(0).y
        for(vect <- border.polygon){
            max = max.max(vect.y)
        }
        //flip it, take max - y
        for(vect <- border.polygon){
            vect.set(vect.x, max - vect.y)
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T02:43:06.797

好的，我想通了，做了一些搜索，我读到必须按顺时针顺序定义多边形。所以凭直觉，我颠倒了我的数组或 Vector2 的顺序。有用。因此，如果其他人想在 libgdx 中使用 Tiled 中的多边形，请在 Y 轴上翻转它们并颠倒顺序。

# php - Python 扭曲渲染 PHP

> ID：14541813
> 
> 赞同：3
> 
> 时间：2013-01-26T21:34:42.173
> 
> 标签：php, python, get, cgi, twisted

在使用 python twisted 生成的 Web 服务器上可以运行 php 页面吗？

查看文档似乎是可能的： http: [//twistedmatrix.com/documents/current/api/twisted.web.twcgi.CGIScript.html](http://twistedmatrix.com/documents/current/api/twisted.web.twcgi.CGIScript.html)

我被困在这一点上，我该如何渲染文件？

```
 class service(resource.Resource):
def getChild(self, name, request):
    self._path = request.prepath[:]
                # Is this an php
    elif request.prepath[0] == 'php':
        return _ShowPHP

    elif (len(self._path) != 1):
        _ServiceError.SetErrorMsg('Invalid path in URL: %s' % self._path)
        return _ServiceError 
```

显示PHP：

```
class ShowPHP(resource.Resource):

isLeaf = True   # This is a resource end point.
def render(self, request):
  #return "Hello, world! I am located at %r." % (request.prepath,)

  class PythScript(twcgi.FilteredScript):
    filter="/usr/bin/php"
    resource = static.File("php") # Points to the perl website
    resource.processors = {".php": ShowPHP} # Files that end with .php
    resource.indexNames = ['index.php']

############################################################
_ShowPHP = ShowPHP() 
```

但是当将浏览器指向 php 页面时得到这个：请求没有返回字符串

要求：

```
 <GET /php/index.php HTTP/1.1> 
```

资源：

```
 <service.ShowPHP instance at 0x2943878> 
```

价值：

没有任何

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T01:59:07.727

至少在我的机器上，有必要使用`php-cgi`而不是普通`php`的可执行文件。不同之处在于`php-cgi`，解释器确保它发出正确的标题集以成为正确的 cgi 响应：

```
from twisted.internet import reactor
from twisted.web.server import Site

from twisted.web.twcgi import FilteredScript

class PhpPage(FilteredScript):
    filter = "/usr/bin/php-cgi"
    #                  ^^^^^^^

    # deal with cgi.force_redirect parameter by setting it to nothing.
    # you could change your php.ini, too.
    def runProcess(self, env, request, qargs=[]):
        env['REDIRECT_STATUS'] = ''
        return FilteredScript.runProcess(self, env, request, qargs)

resource = PhpPage('./hello.php')
factory = Site(resource)

reactor.listenTCP(8880, factory)
reactor.run() 
```

# css - 图标字体在 Firefox 中不可见

> ID：14541818
> 
> 赞同：0
> 
> 时间：2013-01-26T21:35:59.660
> 
> 标签：css, wordpress, firefox, browser, icon-fonts

我用@fontface 添加了一个iconfont。唯一的问题是，它在 Firefox 下是不可见的。我有最新版本的火狐。Safari 和 Chrome 运行良好。

```
@font-face {
    font-family: 'iconFont';
    src: url('../fonts/iconFont.eot');
    src: url('../fonts/iconFont.eot?#iefix') format('embedded-opentype'), url('../fonts/iconFont.svg#iconFont') format('svg'), url('../fonts/iconFont.woff') format('woff'), url('/fonts/iconFont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:46:41.433

```
@font-face {
    font-family: 'iconFont';
    src: url('../fonts/iconFont.eot');
    src: url('../fonts/iconFont.eot?#iefix') format('embedded-opentype'),
        url('../fonts/iconFont.woff') format('woff'),
        url('../fonts/iconFont.ttf') format('truetype'),
        url('../fonts/iconFont.svg#iconFont') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

对于字体套件生成，您可以使用：

*   [http://www.fontsquirrel.com/fontface/generator](http://www.fontsquirrel.com/fontface/generator)
*   [http://fontface.codeandmore.com/index.php](http://fontface.codeandmore.com/index.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:38:22.023

试试这个：

```
@font-face {
    font-family: 'iconFont';
    src: url('../fonts/iconFont.eot');
    src: url('../fonts/iconFont.eot') format('embedded-opentype'), url('../fonts/iconFont.svg') format('svg'), url('../fonts/iconFont.woff') format('woff'), url('/fonts/iconFont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

* * *

避免使用速记字体格式

```
@font-face
{
font-family: myFirstFont;
src: url('Sansation_Light.ttf'),
     url('Sansation_Light.eot'); /* IE9 */
} 
```

# javascript - 与 KineticJS 的跨域

> ID：14541819
> 
> 赞同：2
> 
> 时间：2013-01-26T21:36:00.887
> 
> 标签：javascript, html, canvas, cors, kineticjs

我将图像托管在服务器上，而 KineticJS 应用程序在另一台服务器上运行。

**问题：**尝试时`stage.toDataURL()`，我收到 CORS 错误：

```
Uncaught Error: SECURITY_ERR: DOM Exception 18 
```

![在此处输入图像描述](../Images/19194d27e2b9c3929c80258c1ef2cd93.png)

我已调整 Apache 以允许 CORS

```
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept"
Header set Access-Control-Allow-Methods "GET, PUT, POST, DELETE" 
```

当图像卷曲时，我得到

```
HTTP/1.1 200 OK
Date: Sat, 26 Jan 2013 21:29:35 GMT
Server: Apache
Last-Modified: Sat, 26 Jan 2013 21:27:19 GMT
Accept-Ranges: bytes
Content-Length: 166812
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept
Access-Control-Allow-Methods: GET, PUT, POST, DELETE
Content-Type: image/jpeg 
```

但是`SECURITY_ERR`错误仍然发生！

是否需要执行另一个步骤来`.toDataURL()`处理来自另一个域的图像，可能使用跨域标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T08:32:56.953

看看[这个问题](https://github.com/ericdrowell/KineticJS/issues/151)。

> (eduardo-martos) 您是否尝试从具有来自不同域的图像的画布生成 dataUrl？如果这是您的情况，那么您在前端无能为力。您后端的代理可能是解决方案。

引用[链接教程](http://www.html5canvastutorials.com/kineticjs/html5-canvas-stage-data-url-with-kineticjs/)：

> 注意： toDataURL() 方法要求在画布上绘制的任何图像都托管在与执行它的代码具有相同域的 Web 服务器上。如果不满足此条件，则会引发 SECURITY_ERR 异常。

# ruby-on-rails - 如何在 Rails 4 中使用关注点

> ID：14541823
> 
> 赞同：638
> 
> 时间：2013-01-26T21:36:27.560
> 
> 标签：ruby-on-rails, ruby-on-rails-4, dci

默认的 Rails 4 项目生成器现在在控制器和模型下创建目录“关注”。我找到了一些关于如何使用路由问题的解释，但没有找到关于控制器或模型的解释。

我很确定这与社区当前的“DCI趋势”有关，并想尝试一下。

问题是，我应该如何使用此功能，是否有关于如何定义命名/类层次结构以使其工作的约定？如何在模型或控制器中包含关注点？

* * *

## 回答 #1

> 赞同：627
> 
> 时间：2013-02-25T22:50:30.447

所以我自己发现了。它实际上是一个非常简单但功能强大的概念。它与代码重用有关，如下例所示。基本上，这个想法是提取常见和/或特定于上下文的代码块，以清理模型并避免它们变得过于臃肿和混乱。

作为示例，我将放置一个众所周知的模式，可标记模式：

```
# app/models/product.rb
class Product
  include Taggable

  ...
end

# app/models/concerns/taggable.rb
# notice that the file name has to match the module name 
# (applying Rails conventions for autoloading)
module Taggable
  extend ActiveSupport::Concern

  included do
    has_many :taggings, as: :taggable
    has_many :tags, through: :taggings

    class_attribute :tag_limit
  end

  def tags_string
    tags.map(&:name).join(', ')
  end

  def tags_string=(tag_string)
    tag_names = tag_string.to_s.split(', ')

    tag_names.each do |tag_name|
      tags.build(name: tag_name)
    end
  end

  # methods defined here are going to extend the class, not the instance of it
  module ClassMethods

    def tag_limit(value)
      self.tag_limit_value = value
    end

  end

end 
```

因此，按照产品示例，您可以将 Taggable 添加到您想要的任何类并共享其功能。

[DHH](http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns)很好地解释了这一点：

> 在 Rails 4 中，我们将邀请程序员使用默认的 app/models/concerns 和 app/controllers/concerns 目录，这些目录自动成为加载路径的一部分。与 ActiveSupport::Concern 包装器一起，它足以使这种轻量级分解机制大放异彩。

* * *

## 回答 #2

> 赞同：387
> 
> 时间：2014-09-15T22:50:58.713

我一直在阅读有关使用**模型问题**对脂肪模型进行皮肤化以及干燥模型代码的文章。以下是带有示例的解释：

## 1) 干燥型号代码

考虑一个文章模型、一个事件模型和一个评论模型。一篇文章或一个事件有很多评论。评论属于文章或事件。

传统上，模型可能如下所示：

评论型号：

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, polymorphic: true
end 
```

文章型号：

```
class Article < ActiveRecord::Base
  has_many :comments, as: :commentable 

  def find_first_comment
    comments.first(created_at DESC)
  end

  def self.least_commented
   #return the article with least number of comments
  end
end 
```

事件模型

```
class Event < ActiveRecord::Base
  has_many :comments, as: :commentable 

  def find_first_comment
    comments.first(created_at DESC)
  end

  def self.least_commented
   #returns the event with least number of comments
  end
end 
```

我们可以注意到，Event 和 Article 都有一段重要的代码。使用关注点，我们可以在单独的可注释模块中提取此公共代码。

为此，在 app/models/concerns 中创建一个 commentable.rb 文件。

```
module Commentable
  extend ActiveSupport::Concern

  included do
    has_many :comments, as: :commentable
  end

  # for the given article/event returns the first comment
  def find_first_comment
    comments.first(created_at DESC)
  end

  module ClassMethods
    def least_commented
      #returns the article/event which has the least number of comments
    end
  end
end 
```

现在你的模型看起来像这样：

评论型号：

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, polymorphic: true
end 
```

文章型号：

```
class Article < ActiveRecord::Base
  include Commentable
end 
```

事件模型：

```
class Event < ActiveRecord::Base
  include Commentable
end 
```

## 2) 皮肤化脂肪模型。

考虑一个事件模型。一个活动有很多参加者和评论。

通常，事件模型可能如下所示

```
class Event < ActiveRecord::Base   
  has_many :comments
  has_many :attenders

  def find_first_comment
    # for the given article/event returns the first comment
  end

  def find_comments_with_word(word)
    # for the given event returns an array of comments which contain the given word
  end 

  def self.least_commented
    # finds the event which has the least number of comments
  end

  def self.most_attended
    # returns the event with most number of attendes
  end

  def has_attendee(attendee_id)
    # returns true if the event has the mentioned attendee
  end
end 
```

具有许多关联的模型倾向于积累越来越多的代码并变得难以管理。关注点提供了一种对脂肪模块进行皮肤化的方法，使它们更加模块化和易于理解。

可以使用以下关注点重构上述模型：在 app/models/concerns/event 文件夹中创建一个`attendable.rb`和文件`commentable.rb`

可参加的.rb

```
module Attendable
  extend ActiveSupport::Concern

  included do 
    has_many :attenders
  end

  def has_attender(attender_id)
    # returns true if the event has the mentioned attendee
  end

  module ClassMethods
    def most_attended
      # returns the event with most number of attendes
    end
  end
end 
```

可评论的.rb

```
module Commentable
  extend ActiveSupport::Concern

  included do 
    has_many :comments
  end

  def find_first_comment
    # for the given article/event returns the first comment
  end

  def find_comments_with_word(word)
    # for the given event returns an array of comments which contain the given word
  end

  module ClassMethods
    def least_commented
      # finds the event which has the least number of comments
    end
  end
end 
```

现在使用关注点，您的事件模型减少到

```
class Event < ActiveRecord::Base
  include Commentable
  include Attendable
end 
```

*** 在使用关注点时，建议使用基于“域”的分组而不是“技术”分组。基于域的分组就像“可评论”、“可拍照”、“可参加”。技术分组将意味着“ValidationMethods”、“FinderMethods”等**

* * *

## 回答 #3

> 赞同：102
> 
> 时间：2015-03-23T14:11:17.293

值得一提的是，许多人认为使用关注点是个坏主意。

1.  [喜欢这个人](http://blog.coreyhaines.com/2012/12/why-i-dont-use-activesupportconcern.html)
2.  [和这个](http://mcdowall.info/the-great-satan-rails-concerns/)

一些原因：

1.  幕后发生了一些黑暗的魔法 - 关注的是修补`include`方法，有一个完整的依赖处理系统 - 对于琐碎的旧 Ruby 混合模式来说太复杂了。
2.  你的课也同样枯燥。如果你在不同的模块中填充 50 个公共方法并包含它们，你的类仍然有 50 个公共方法，只是你隐藏了代码气味，有点把你的垃圾放在抽屉里。
3.  代码库实际上更难处理所有这些问题。
4.  你确定你的团队的所有成员都对真正应该用什么来代替关注有相同的理解吗？

担忧很容易让自己在腿上开枪，小心它们。

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2013-03-17T19:20:20.663

[这篇文章](https://web.archive.org/web/20130712014326/http://blog.andywaite.com/2012/12/23/exploring-concerns-for-rails-4/)帮助我理解了担忧。

```
# app/models/trader.rb
class Trader
  include Shared::Schedule
end

# app/models/concerns/shared/schedule.rb
module Shared::Schedule
  extend ActiveSupport::Concern
  ...
end 
```

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2015-12-03T09:11:42.950

我觉得这里的大多数示例都`module`展示`ActiveSupport::Concern`了`module`.

**示例 1：**更具可读性的模块。

所以不用担心这`module`将是一个典型的。

```
module M
  def self.included(base)
    base.extend ClassMethods
    base.class_eval do
      scope :disabled, -> { where(disabled: true) }
    end
  end

  def instance_method
    ...
  end

  module ClassMethods
    ...
  end
end 
```

用 重构后`ActiveSupport::Concern`。

```
require 'active_support/concern'

module M
  extend ActiveSupport::Concern

  included do
    scope :disabled, -> { where(disabled: true) }
  end

  class_methods do
    ...
  end

  def instance_method
    ...
  end
end 
```

您会看到实例方法、类方法和包含的块不那么混乱。担忧会为您适当地注入它们。这是使用`ActiveSupport::Concern`.

* * *

**示例 2：**优雅地处理模块依赖关系。

```
module Foo
  def self.included(base)
    base.class_eval do
      def self.method_injected_by_foo_to_host_klass
        ...
      end
    end
  end
end

module Bar
  def self.included(base)
    base.method_injected_by_foo_to_host_klass
  end
end

class Host
  include Foo # We need to include this dependency for Bar
  include Bar # Bar is the module that Host really needs
end 
```

在这个例子`Bar`中是`Host`真正需要的模块。但是由于与类有`Bar`依赖关系（但是等等为什么想知道？可以避免吗？）。`Foo``Host``include Foo``Host``Foo`

所以`Bar`到处都增加了依赖。包含顺序在这里**也很重要。**这给庞大的代码库增加了很多复杂性/依赖性。

重构后`ActiveSupport::Concern`

```
require 'active_support/concern'

module Foo
  extend ActiveSupport::Concern
  included do
    def self.method_injected_by_foo_to_host_klass
      ...
    end
  end
end

module Bar
  extend ActiveSupport::Concern
  include Foo

  included do
    self.method_injected_by_foo_to_host_klass
  end
end

class Host
  include Bar # It works, now Bar takes care of its dependencies
end 
```

现在看起来很简单。

如果你在想为什么我们不能在模块本身中添加`Foo`依赖？`Bar`这是行不通的，因为`method_injected_by_foo_to_host_klass`必须注入一个`Bar`不包括`Bar`模块本身的类。

**资料来源：** [Rails ActiveSupport::Concern](http://api.rubyonrails.org/classes/ActiveSupport/Concern.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-01-15T08:45:04.500

在关注制作文件filename.rb

例如，我想在我的应用程序中存在属性 create_by 将值更新为 1，更新为 0 为 updated_by

```
module TestConcern 
  extend ActiveSupport::Concern

  def checkattributes   
    if self.has_attribute?(:created_by)
      self.update_attributes(created_by: 1)
    end
    if self.has_attribute?(:updated_by)
      self.update_attributes(updated_by: 0)
    end
  end

end 
```

如果你想在行动中传递参数

```
included do
   before_action only: [:create] do
     blaablaa(options)
   end
end 
```

之后像这样包含在您的模型中：

```
class Role < ActiveRecord::Base
  include TestConcern
end 
```

# javascript - 渲染后如何执行指令代码？

> ID：14541829
> 
> 赞同：3
> 
> 时间：2013-01-26T21:37:07.453
> 
> 标签：javascript, angularjs, angularjs-ng-repeat

我正在尝试构建一个在嵌套`ng-repeat`完成渲染后运行的指令。这是我尝试过的[（小提琴）](http://jsfiddle.net/lolson/ZTMex/)：

的HTML：

```
<div ng-app="MyApp" ng-controller="MyCtrl">
    <ul my-directive>
        <li ng-repeat="animal in animals">{{animal}}</li>
    </ul>
</div> 
```

和 JavaScript：

```
angular.module("MyApp", [])
    .directive("myDirective", function () {
        return function(scope, element, attrs) {
            alert(element.find("li").length); // 0
        };
    });

function MyCtrl($scope) {
    $scope.animals = ["Dog", "Cat", "Elephant"];
} 
```

我的自定义指令中的链接功能在所有`<li>`元素都被渲染（并被`0`警告）之前运行。`ng-repeat`渲染完成后如何运行代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T23:10:15.050

您可以在 ng-repeat 中移动指令，[http://jsfiddle.net/ZTMex/3/](http://jsfiddle.net/ZTMex/3/)

```
<div ng-app="MyApp" ng-controller="MyCtrl">
    <ul>
        <li ng-repeat="animal in animals" my-directive>{{animal}}</li>
    </ul>
</div> 
```

或查看与您的问题相关的[https://stackoverflow.com/a/13472605/1986890 。](https://stackoverflow.com/a/13472605/1986890)

# django - 找不到与平台无关的库 考虑将 $PYTHONHOME 设置为 [： ]

> ID：14541830
> 
> 赞同：3
> 
> 时间：2013-01-26T21:37:09.597
> 
> 标签：django, macos, python-2.7, pip

我对 Python 和 Django 真的很陌生......我想做的是：

1.  在 Mac OS 10.6.8 上安装 Python 2.7

2.  安装 pip 安装 Django

3.  安装 virtualenvwrapper

4.  创建虚拟环境

5.  安装 Django-Cms

我想，从安装 virtualenvwrapper 到 Django-Cms 安装我会没问题，因为我已经完成了，但在第一步我遇到了一些麻烦。

我`Python 2.z`从 python.org下载**Python 2.7.3 Mac OS X 64-bit/32-bit x86-64/i386 安装程序**（适用于 Mac OS X 10.6 及更高版本 [2]），通过向导安装。`/System/Library/Frameworks/Python.framework/Versions`在我的文件夹中创建一个目录`2.7`。

我的目录`/System/Library/Python`是空的

我确定我已经安装了 Python，因为：

```
python --version
Python 2.7.3 
```

但是当我尝试时`easy_install pip`，它给了我：

```
Could not find platform independent libraries <prefix>
Consider setting $PYTHONHOME to <prefix>[:<exec_prefix>]
'import site' failed; use -v for traceback
Traceback (most recent call last):
  File "/usr/bin/easy_install-2.6", line 7, in <module>
    from pkg_resources import load_entry_point
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/pkg_resources.py", line 16, in <module>
    import sys, os, zipimport, time, re, imp, new
ImportError: No module named os** 
```

现在不知道这意味着什么......所以如果有人可以帮助我并将我放在可以安装我的 virtualenvwrapper 的方向上，我可以从那里拿走它。

我是初级前端开发人员，从不接触后端，所以请具体说明一下，当你和孩子说话时，我需要做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:53:57.033

你似乎有转机。Virtualenv 创建了一个封装了 python 安装的 python 环境。因此，您想要执行以下操作：

1.  安装蟒蛇
2.  *使用该*版本的 python创建一个 virtualenv （例如 virtualenv --python="path to python in 1" *virt*）
3.  切换到那个 virtualenv (workon *virt* )
4.  *现在在 virtualenv virt*中安装 Django 等

 *[这是](http://www.tlswebsolutions.com/mac-os-x-lion-setting-up-django-pip-virtualenv-and-homebrew/)我用来设置和运行环境的方法。

你在用[自制软件](http://mxcl.github.com/homebrew/)吗？我发现这是在 mac 上获取内容的最可靠方法。*

# python - 如何在 Moutain Lion 上安装 Numpy & Scipy for Python 3.3

> ID：14541833
> 
> 赞同：1
> 
> 时间：2013-01-26T21:37:20.050
> 
> 标签：python, macos, numpy, scipy

目前还没有找到可行的解决方案。我的系统上有三个不同版本的 Python，默认与 OSX (2.7.2) 捆绑在一起，通过 homebrew 安装的 2.7.3 和通过 homebrew 安装的 3.3.0。运行`pip install numpy`或`pip install scipy`将为 2.7.3 版本安装它。

如何在 Moutain Lion 上为 Python 3.3.0 安装 numpy 和 scipy？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T21:26:58.703

你需要调用**pip3**而不是 pip。Homebrew 使用 python3 安装 pip3。

我刚刚在我的 OSX 10.7.5 python 3.3.0 机器上尝试过`pip3 install numpy`，但失败了。看起来 numpy v1.6 不兼容，但 numpy v1.7（测试版，不能通过 pip3 获得）是兼容的。

链接：关于 SO 的帖子： [为什么直接构建时使用 pip 安装 numpy 会失败](https://stackoverflow.com/questions/13184826/why-does-installing-numpy-using-pip-fail-while-building-directly-does-not)

# php - PHP Send-Mail 表单到多个电子邮件地址

> ID：14541839
> 
> 赞同：2
> 
> 时间：2013-01-26T21:38:22.630
> 
> 标签：php, html, forms

我对 PHP 非常陌生，并且在联系页面上使用基本模板“发送邮件”表单。单击“提交”按钮时，要求我将电子邮件发送到多个电子邮件地址。我已经四处寻找，但还没有找到我需要的东西。我需要在下面的表格中添加什么代码才能将其发送到多个电子邮件地址？

```
<?php     

$mail_to = 'daniel30293@gmail.com'; // specify your email here

// Assigning data from the $_POST array to variables

$name = $_POST['sender_name'];

$mail_from = $_POST['sender_email'];

$phone = $_POST['sender_phone'];

$web = $_POST['sender_web'];

$company = $_POST['sender_company'];

$addy = $_POST['sender_addy'];

$message = $_POST['sender_message'];

// Construct email subject

$subject = 'Web Prayer Request from ' . $name;

// Construct email body

$body_message = 'From: ' . $name . "\r\n";

$body_message .= 'E-mail: ' . $mail_from . "\r\n";

$body_message .= 'Phone: ' . $phone . "\r\n";

$body_message .= 'Prayer Request: ' . $message;

// Construct email headers

$headers = 'From: ' . $name . "\r\n";

$headers .= 'Reply-To: ' . $mail_from . "\r\n";

$mail_sent = mail($mail_to, $subject, $body_message, $headers);

if ($mail_sent == true){ ?>

<script language="javascript" type="text/javascript">
alert('Your prayer request has been submitted - thank you.');

window.location = 'prayer-request.php';

</script>

<?php } else { ?>

<script language="javascript" type="text/javascript">
alert('Message not sent. Please, notify the site administrator admin@bondofperfection.com');

window.location = 'prayer-request.php';
</script>

<?php

    }

?> 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-26T21:40:46.700

您内爆了一组收件人：

```
$recipients = array('jack@gmail.com', 'jill@gmail.com');

mail(implode(',', $recipients), $submit, $message, $headers); 
```

请参阅 PHP：邮件函数参考 - [http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

收件人，或邮件的接收者。

此字符串的格式必须符合 » RFC 2822。一些示例如下：

*   `user@example.com`
*   `user@example.com`,`anotheruser@example.com`
*   用户`<user@example.com>`
*   用户`<user@example.com>`, 另一个用户 < `anotheruser@example.com`>

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-26T21:42:43.843

`$mail_to`只需在变量中添加多个以逗号分隔的收件人，如下所示：

```
$mail_to = 'nobody@example.com,anotheruser@example.com,yetanotheruser@example.com'; 
```

参见 PHP 中的**[mail()函数](http://php.net/manual/de/function.mail.php)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T22:30:31.033

这是一个简单的例子：

```
<?php

// Has the form been submitted?
// formSubmit: <input type="submit" name="formSubmit">
if (isset($_POST['formSubmit'])) {
    // Set some variables
    $required_fields = array('name', 'email');
    $errors = array();

    $success_message = "Congrats! Your message has been sent successfully!";
    $sendmail_error_message = "Oops! Something has gone wrong, please try later.";

    // Cool the form has been submitted! Let's loop through the required fields and check
    // if they meet our condition(s)
    foreach ($required_fields as $fieldName) {
        // If the current field in the loop is NOT part of the form submission -OR-
        // if the current field in the loop is empty, then...
        if (!isset($_POST[$fieldName]) || empty($_POST[$fieldName])) {

            // add a reference to the errors array, indicating that these conditions have failed
            $errors[$fieldName] = "The {$fieldName} is required!";
        }
    }

    // Proceed if there aren't any errors
    if (empty($errors)) {
        $name = htmlspecialchars(trim($_POST['name']), ENT_QUOTES, 'UTF-8' );
        $email = htmlspecialchars(trim($_POST['email']), ENT_QUOTES, 'UTF-8' );

        // Email Sender Settings
        $to_emails = "anonymous1@example.com, anonymous2@example.com";

        $subject = 'Web Prayer Request from ' . $name;
        $message = "From: {$name}";
        $message .= "Email: {$email}";

        $headers = "From: {$name}\r\n";
        $headers .= "Reply-To: {$email}\r\n";
        $headers .= 'X-Mailer: PHP/' . phpversion();

        if (mail($to_emails, $subject, $message, $headers)) {
            echo $success_message;
        } else {
            echo $sendmail_error_message;
        }
    } else {

        foreach($errors as $invalid_field_msg) {
            echo "<p>{$invalid_field_msg}</p>";
        }
    }
} 
```

# algorithm - Floyd-Warshall 算法

> ID：14541841
> 
> 赞同：1
> 
> 时间：2013-01-26T21:38:59.400
> 
> 标签：algorithm, floyd-warshall

是否有一个简单的解释来解释为什么这个片段找到两个顶点之间的最短距离

```
for (k = 0; k < n; ++k)
  for (i = 0; i < n; ++i)
    for (j = 0; j < n; ++j)
      if (d[i][k] + d[k][j] < d[i][j])
        d[i][j] = d[i][k] + d[k][j] 
```

而这并没有

```
for (i = 0; i < n; ++i)
  for (j = 0; j < n; ++j)
    for (k = 0; k < n; ++k)
      if (d[i][k] + d[k][j] < d[i][j])
        d[i][j] = d[i][k] + d[k][j] 
```

（因为 k 是第二个片段中最里面的一个）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T22:03:40.747

`k`因为这个想法是通过在每一步尝试通过节点来尝试使路径更好，以改进每条`i - j`路径。

符号无关紧要，您可以根据需要`i, j, k`用作循环变量`k, i, j`，但您必须牢记上述逻辑。在这种情况下，您将需要尝试`j - k`通过`i`每一步来改进路径：

```
for i = 0, n
  for j = 0, n
    for k = 0, n
      if d[j, i] + d[i, k] < d[j, k]
        d[j, k] = d[j, i] + d[i, k] 
```

你不能只对 for 循环重新排序而不改变条件，因为这样你会得到一个不同的算法——谁知道它做了什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T23:57:26.550

在

```
for (k = 0; k < n; ++k)
  for (i = 0; i < n; ++i)
    for (j = 0; j < n; ++j)
      if (d[i][k] + d[k][j] < d[i][j])
        d[i][j] = d[i][k] + d[k][j] 
```

最外面的循环`k`是指可能在`Vi`和之间的路径上的顶点`Vj`。因此`k=1`，例如，当您正在考虑顶点之间的所有路径`Vi`并且`Vj`包括顶点`V1`时

```
Vi .... V1 .... Vj 
```

更重要的是，从这些路径中，您选择了最好的放松方式

```
if (d[i][k] + d[k][j] < d[i][j])
        d[i][j] = d[i][k] + d[k][j] 
```

同样，每次迭代都集中在两个顶点上`Vi`，`Vj`并选择它们之间的最佳路径。

在另一个失败的例子中，您没有在两个固定顶点之间的路径中选择最佳路径`Vi`，`Vj`而是在整个地方放松，从不等待足够长的时间来找出两个集合顶点之间的路径是最好的。

[在 Geekviewpoint，一个我非常依赖的网站](http://www.geekviewpoint.com/java/graph/warshall_floyd_all_pairs_shortest_path)，他们独特地使用`x`和`v`作为顶点和`t`最外层循环，这很容易记住它`t`是临时的，因此不是端点之一。（我希望他们实际上已经解释过了，因为这对每个人来说都不是显而易见的。）

```
//dynamically find the shortest distance between each pair.
    for (int t = 0; t < n; t++) {
      for (int v = 0; v < n; v++) {
        for (int u = 0; u < n; u++) {
          if (dist[v][u] > (long) dist[v][t] + dist[t][u]) {
            dist[v][u] = dist[v][t] + dist[t][u];
            pred[v][u] = pred[t][u];
          }
        }
      }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T22:22:50.380

我为第二个有缺陷的算法找到了一个反例。
当 i=0, j=1 时，它会尝试寻找中介，但没有。
然后，当 i=0、j=1 的中介可用时，不再检查它。 ![在此处输入图像描述](../Images/4db335a73994aef63bbabba793e1ea97.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-09T13:26:24.970

基本上，当您具有`K`价值时，`loop k`这意味着您将要添加另一条边，并且所有可能的方式都`(i->j)`使用 edge 进行更新`(1->K-1)`。然后你插入另一个边缘`K`，你再次检查是否有任何方法可以`(i->j)`使用这个边缘以更便宜的方式进行。所以你写`d[i][j]=min(d[i][j],d[i][k]+d[k][j])`。

所以如果你想写

```
 for(int i=0;i<n;i++)
   for(int j=0;j<n;j++)
     for(int k=0;k<n;k++) 
```

您的更新应该是`d[j][k] = min(d[j][k],d[j][i]+d[i][k])`

# drawing - 如何创建合成指纹图

> ID：14541843
> 
> 赞同：1
> 
> 时间：2013-01-26T21:39:04.070
> 
> 标签：drawing, fingerprinting

我想编写一个程序，输出与人类指纹无法区分的合成指纹图。我知道指纹的理论以及是什么让它们与众不同。我不知道程序应该如何进行实际绘图。我想到的一个想法是让程序从一个类似于指纹的向量方程开始，并通过使用常量来随机化它。稍后它可以使用 pySVG [http://codeboje.de/pysvg/](http://codeboje.de/pysvg/)进行实际绘图。我还能如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:48:18.483

您也可以考虑[使用 pycairo](http://cairographics.org/pycairo/)进行绘图。

# java - Android ActionBarSherlock

> ID：14541844
> 
> 赞同：1
> 
> 时间：2013-01-26T21:39:22.157
> 
> 标签：java, android, android-actionbar

我正在使用操作栏 sherlock，并且三个选项卡显示非常好。我遇到的问题是我似乎根本无法显示标题，它实际上在顶部显示了三个选项卡。在同一个项目上使用本机操作栏时，它在一行显示标题，然后是下面的选项卡（拆分操作栏）。这一次，只有标签。我确实在清单中有所需的元素，例如：

```
uiOptions="splitActionBarWhenNarrow" 
```

我正在使用主题`@style/Theme.Sherlock.Light`

# c++ - 点绕一圈，但地址改变了

> ID：14541845
> 
> 赞同：-1
> 
> 时间：2013-01-26T21:39:23.770
> 
> 标签：c++, pointers, queue, memory-address

我自己实现了一个队列。在测试时，我希望通过测试尾指针是否指向头节点来在队列为空时重新出队。但是，当指针确实指向头时，头节点的地址和一个指针点的地址是不同的，因此即使队列中没有任何内容，队列也不会停止出队。这让我很困惑。对此有何建议？多谢。

```
//header
#ifndef QUEUE_H
#define QUEUE_H

struct node
{
int val;
struct node* next;

};

class queue
{
private:
    node head;
    node* tail;
public:
    queue();
    void enqueue(int val);
    void dequeue(int& holder, bool& v);
};

#endif
// queue.cpp
#include "queue.h"

using namespace std;
queue::queue()
{
    tail = &head;

}
void queue::enqueue(int val)
{
    node* tmp = new node;
    tmp->val = val;
    if(tail == &head)
    {
            tail = tmp;
            tmp->next = &head;
            head.next = tmp;
    }
    else
    {
            node* holder = head.next;
            head.next = tmp;
            tmp->next = &head;
            holder->next = tmp;
    }
}

void queue::dequeue(int& holder,bool& v)
{

    if(tail == &head)
   {
            v = false;
   }
    else
    {
            node* cur = tail;
            tail = tail->next;
            holder = cur->val;
            v = true;
            delete cur;

    }

}
//test.cpp
#include <iostream>
#include "queue.h"
using std::cout;
using std::endl;
int main()
{
int ary[] = {1,2,3,4,5};

queue myq;
for(int i = 0;i< sizeof(ary);i++)
{
    myq.enqueue(ary[i]);
}
int tmp;
bool flag;
for(int i = 0;i<=7;i++)
{
    myq.dequeue(tmp,flag);
    if(flag)
            cout<<"number is "<<tmp<<endl;
    else
            cout<<"queue empty"<<endl;
}
return 0 ;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:50:11.427

我可以为您提供确切的解决方案，但这绝对不会教您任何东西，您只需将其复制并粘贴到您的代码中，然后去做其他事情。因此，我将帮助您添加一行代码以显示 &head 的当前值是什么，从而帮助确定实际问题是什么......

将此行添加到入队（在函数顶部）和出队：

```
 std::cout << __FUNCTION__ << ": " << &head << std::endl; 
```

它将打印函数的名称和地址。（您可能还需要包括 iostream）

请特别注意您获得了多少打印输出！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T22:57:22.390

下面的工作代码：（学习使用调试器）

```
#include <iostream>
using namespace std;
//header
#ifndef QUEUE_H
#define QUEUE_H

struct node {
    int val;
    struct node* next;

};

class queue {
private:
    struct node* head;
    struct node* tail;
public:
    queue();
    void enqueue(int val);
    void dequeue(int& holder, bool& v);
};

#endif

using namespace std;
queue::queue() {
    tail = NULL;
    head = NULL;

}
void queue::enqueue(int val) {
    node* tmp = new node;

    tmp->val = val;

    if (head == NULL && NULL == tail) {//No nodes Empty
        head = tail = tmp;
        tmp->next = NULL;

    }else if (tail == head) { //Single node
        tail = tmp;
        tmp->next = head;
        head->next = tmp;
    } else {
        tail->next = tmp;
        tmp->next = head;
        tail = tmp;
    }
}

void queue::dequeue(int& holder, bool& v) {
    if (NULL == tail || NULL == head) {
        v = false;
        return;
    } else if (tail == head) {// single node
        holder = head->val;
        delete head;
        head = NULL;
        tail = NULL;
        v = true;
    } else { //more than one node
        //Go to the last but one node and chop the tail
        node* cur = head;
        while (cur->next != tail)
            cur = cur->next;

        cur->next = head;
        holder = tail->val;
        delete tail;
        tail = cur;
        v = true;
    }
    return;
}

using std::cout;
using std::endl;
int main() {
    int ary[] = { 1, 2, 3, 4, 5 };

    queue myq;

    for (int i = 0; i < 5; i++) {
        myq.enqueue(ary[i]);
    }

    int tmp;
    bool flag;

    for (int i = 0; i <= 7; i++) {
        myq.dequeue(tmp, flag);
        if (flag) {
            cout << "number is " << tmp << endl;
        }
        else {
            cout << "queue empty" << endl;
        }
    }
    return 0;
} 
```

# matlab - fread() 优化 matlab

> ID：14541846
> 
> 赞同：2
> 
> 时间：2013-01-26T21:39:32.353
> 
> 标签：matlab, optimization, fread

我正在用三种不同的方式读取一个 40 MB 的文件。但是第一个比其他两个快得多。你们知道为什么吗？我宁愿在循环或whiles中实现条件来分离数据，而不是用第一个快速方法加载所有内容然后将它们分开 - 节省内存 -

```
LL=10000000;

fseek(fid,startbytes, 'bof');

%% Read all at once %%%%%%%%%%%%%%%%%%%%%%
tic
AA(:,1)=int32(fread(fid,LL,'int32'));
toc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fseek(fid,startbytes,'bof');

%% Read all using WHILE loop %%%%%%%%%%%%%
tic
i=0;
AA2=int32(zeros(LL,1));
while i<LL
    i=i+1;
    AA2(i,1)=fread(fid,1,'int32');      
end
toc 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

fseek(fid,startbytes,'bof');

%% Read all using FOR loop %%%%%%%%%%%%%%%
tic
AA3=int32(zeros(LL,1));
for i=1:LL
    AA3(i,1)=fread(fid,1,'int32');      
end
toc 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
```

经过的时间是 0.312916 秒。

经过的时间是 138.811520 秒。

经过的时间是 116.799286 秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T12:32:26.847

这是我的两分钱：

### 是否启用了 JIT 加速器？

由于 MATLAB 是一种解释型语言，`for`因此循环可能会非常慢。`while`循环可能会更慢，因为在每次迭代中都会重新评估终止条件（与`for`迭代预定次数的循环不同）。[然而， JIT 加速](http://www.mathworks.com/company/newsletters/news_notes/may03/profiler.html)并非如此，这可以显着提高它们的性能。

我现在不在 MATLAB 附近，所以我自己无法重现这种情况，但是您可以通过在命令窗口中键入以下内容来检查自己是否打开了 JIT 加速：

```
feature accel 
```

如果结果是`0`它意味着它被禁用，这可能是性能大幅下降的原因。

### 系统调用太多？

我不熟悉 的内部结构`fread`，但我只能假设一次`fread`读取整个文件的调用调用的[系统调用](http://en.wikipedia.org/wiki/System_call)少于多次`fread`调用。系统调用通常很昂贵，因此这在某种程度上可以解释速度放缓。

# forms - 使用 JDBC 将数据通过方法插入 MySQL 数据库

> ID：14541849
> 
> 赞同：0
> 
> 时间：2013-01-26T21:40:23.280
> 
> 标签：forms, servlets, jdbc

我有一个表格，我想将数据发送到数据库。如何通过方法参数传递请求数据并将其发送到数据库？

```
int status = InsertCustomer(fName, mName, lName , iage, issn, city, state, country); 
```

//方法 // 此方法应返回一个 int，executeUpdate // 方法返回。注意：驱动程序名称和 URL // 已经在 init() 方法中可用。

```
 private int InsertCustomer(String firstName, String midName, String lastName, int age, int ssn, String city, String state, String country) {

    // JDBC logic

    try {
        Class.forName(driverName);
        Connection conn = DriverManager.getConnection(databaseURL);
        java.sql.Statement st = conn.createStatement();

        st.executeUpdate("INSERT INTO Customer(firstName, midName, lastName, age, ssn, city, state, country)" + 
                   "VALUES ('?', '?', '?', ?, ?, '?', '?', '?')";

    } catch (Exception e) {
        // TODO: handle exception
        e.printStackTrace();
    }

    return 1;
} 
```

我有点失落，一点点将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:49:51.033

要么您使用简单的（即未准备好的语句），并且您不能传递任何参数：

```
String sql = "insert into sometable (a, b, c) values (7, 8, 9)";
Statement st = conn.createStatement();
return st.executeUpdate(sql); 
```

或者（在您的情况下，这就是您应该做的），您使用准备好的状态并传递参数：

```
String sql = "insert into sometable (a, b, c) values (?, ?, ?)";
PreparedStatement st = conn.prepareStatement(sql);
st.setInt(1, 7);
st.setInt(2, 8);
st.setInt(3, 9);
return st.executeUpdate(); 
```

在您的代码中，您正在使用一个简单的语句并尝试执行一个需要参数的 SQL 查询。那是不可能的。你需要一个准备好的声明来做到这一点。

[JDBC 教程](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)中的更多信息。

# jquery - Jquery，使用each（）从同一级别的div中获取文本值

> ID：14541851
> 
> 赞同：0
> 
> 时间：2013-01-26T21:40:32.083
> 
> 标签：jquery

鉴于下面的 div 结构，我试图获取每个 div.class 内容中的文本。

我一直在使用 next() ，它只适用于前 2 个元素并且有点笨拙。有没有办法可以使用选择器获取内容值（会更优雅）？

因为页面上有很多持有人 div，所以我需要使用相对于每个持有人 div 的选择器。

谢谢，

```
$(".holder").each(function() {
var image = $(this).next().text();  //get value   
var title = $(this).next().next().text(); //gets value
} 

<div class="holder">
    <div class="field-image">
        <div class="content">content</div>  
    </div>
    <div class="field-title">
        <div class="content">content</div>  
    </div>
    <div class="field-location">
         <div class="content">content</div>  
    </div> 
   <div class="field-sector">
         <div class="content">content</div> 
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:57:21.220

看来您只需要获取每个孩子（或每个孩子的`.content`元素）的文本内容：

```
$('.holder').each(function() {
    var texts = {};
    $(this).children().each(function() {
        // Assuming each child has only one class
        texts[this.className.replace(/^field-/, '')] = 
            $(this).find('.content').text();
    });

    // now do something with e.g. texts.image, texts.title, etc.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:57:24.133

```
$(".holder").each(function() {
  $(this).find('div[class*=field]').each(function() {
    var $image = $(this);
    var $content = $image.find('div.content');
    var text = $content.text();
  });
}); 
```

# ruby-on-rails-3 - simple_form 和 Twitter 引导和输入附加代码

> ID：14541852
> 
> 赞同：2
> 
> 时间：2013-01-26T21:40:33.427
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, simple-form

我正在尝试使用`input-append`Twitter Bootstrap 的功能。但是，我想尝试使用`simple_form`.

```
<div class="control-group string required">
 <label class="string required control-label" for="video_company_id"><abbr title="required">*</abbr> Company</label>
  <div class="controls">
    <div class="input-append">
      <%= f.text_field  :company_id, :class => "span2" %>
        <span class="add-on"><%= link_to image_tag('/assets/button/magnifier.png'), "#select_company", :"data-toggle" => "modal" %></span>
    </div>
  </div>
</div> 
```

产量

![在此处输入图像描述](../Images/35d11167e9f8145063e6b043b3974840.png)

`simple_form`用using写这个更好的方法是什么`f.input`？

**编辑到 mdepolli**

谢谢mdepolli。这确实让我更接近我需要去的地方。但是，它只是将查找嵌入到表单中，而不是“附加组件”。

```
 <%= f.input  :company_id, :as => :string, :class => "span2", :wrapper_html => { :class => "input-append"} %>
  <%= link_to image_tag('/assets/button/magnifier.png'), "#select_company", :"data-toggle" => "modal", :class => "add-on", :wrapper_html => { :class => "input-append"} %> 
```

![在此处输入图像描述](../Images/696359c0837500a8a3402ca9b9dd19fb.png)

**用**再次编辑**`content_tag`，它将它带到单独的行 ![在此处输入图像描述](../Images/814f8eb4c724712d2e1e4bcd8f2ad06a.png)**

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:46:14.430

首先，让我们在 SimpleForm 初始化程序中创建一个自定义包装器。

在`config/initializers/simple_form.rb`：

```
config.wrappers :append, :tag => 'div', :class => "control-group", :error_class => 'error' do |b|
  b.use :html5
  b.use :placeholder
  b.use :label
  b.wrapper :tag => 'div', :class => 'controls' do |input|
    input.wrapper :tag => 'div', :class => 'input-append' do |append|
      append.use :input
    end
    input.use :hint,  :wrap_with => { :tag => 'span', :class => 'help-block' }
    input.use :error, :wrap_with => { :tag => 'span', :class => 'help-inline' }
  end
end 
```

现在让我们回到你的表格。请务必替换`@model`为附加到您正在使用的 ActiveRecord 模型的实际实例变量。

```
<%= simple_form_for @model do |f| %>
  <%= f.input :company_id, :wrapper => :append do %>
    <%= f.input_field :company_id %>
    <%= content_tag :span, link_to(image_tag('/assets/button/magnifier.png'), "#select_company", :"data-toggle" => "modal"), :class => 'add-on' %>
  <% end %>
  <%= f.button :submit %>
<% end %> 
```

编辑：对不起，我花了一点时间，最后不得不制作一个自定义包装器。**

# php - 如何从函数中获取真假

> ID：14541853
> 
> 赞同：1
> 
> 时间：2013-01-26T21:40:35.230
> 
> 标签：php, pdo, user-registration

我目前正在编写一个 isRegistered 函数。这个函数写在一个叫做 User 的类中。这是代码：

```
public function isRegistered($email){
        $ir =   $this->db->prepare('select * from users where email=?');
        $ir->bindParam(1, $email);
        $ir->execute();
        if ($ir->rowCount()==1){
            return true;
        }
        else { return false;}
}//end of function isRegistered 
```

我在注册页面上实例化类和这个函数，我正在尝试这样做：

```
 if(!empty($_POST['email'])){
        $email  =   $_POST['email'];
        $fp =   new User();
        $fp->isRegistered($email);
        if($fp==1){
        echo "email exists";    
        }
        else {echo "email doesn't exist.";}
    }
    else echo "Please enter an email address."; 
```

显然这是行不通的。我如何让它工作？正确的方法是什么？我知道我从方法中返回 true 或 false `isRegistered`。当我实例化它时，我只是不知道如何选择该响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:41:51.460

我想你想要：

```
if($fp->isRegistered($email)){
   ... 
```

或者将函数的返回值分配给`$fp`...

# seo - 使用 Javascript 代替真实链接是否存在任何 SEO 风险？

> ID：14541858
> 
> 赞同：3
> 
> 时间：2013-01-26T21:41:01.057
> 
> 标签：seo

本质上，我有一个客户想要更改一些链接，例如：

```
<a href="http://www.google.com/" rel="nofollow">Click me</a> 
```

类似于：

```
<span style="color:blue;cursor:pointer;" id="faux-link">Click me</span>
<script type="text/javascript">
    $("#faux-link").click(function() {
        document.location = "http://www.google.com/";
    });
</script> 
```

本质上，这将使“单击我”文本以相同的方式减去一些高级链接功能（Mouse3 在新选项卡中打开链接，右键单击以查看“在新窗口中打开”和其他选项等），它显然也不起作用对于禁用 Javascript 的任何内容（或者页面上的 Javascript 有任何致命错误）

是否有任何人经历过的任何 SEO 缺点或 Google 或其他人对此类行为的任何评论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T18:14:52.780

在第一个示例 ( `<a href="http://www.google.com/" rel="nofollow">Click me</a>`) 中，您使用标准`<a>`标签。但即使它使用`rel="nofollow"`属性，一些网络蜘蛛可能仍会跟随链接。更多关于Google、Yahoo 和 MSN文章中的[Nofollow 的内容。](http://www.seo-blog.com/rel-nofollow.php)

在第二个示例中，您使用不同的方式构建链接（使用 JavaScript 和不同于`<a>`HTML 标记，如`<span>`）。Googlebot 可以执行一些 JavaScript，但我不相信它会执行像 jQuery 这样的大型库。

请查看对 Matt Cutts 的采访了解更多详情。那次采访的引述：

> **Matt Cutts**：有一段时间，我们在 JavaScript 中进行扫描，并寻找链接。Google 在 JavaScript 方面变得更加聪明，可以执行一些 JavaScript。我不会说我们执行所有 JavaScript，所以在某些情况下我们不执行 JavaScript。当然，有一些常见的、众所周知的 JavaScript 功能，例如 Google Analytics，您甚至不想执行它们，因为您不想尝试从 Googlebot 生成幻像访问到您的 Google Analytics 中。

据我了解，在这两个示例中，它旨在阻止网络蜘蛛抓取或索引这些链接。我认为（没有证据或文章支持）使用后一种方法不会显着影响 SEO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T08:45:34.617

使用普通链接（如果不是，这些网站将不会在 google 中被编入索引！）并对您将指定的链接使用防止默认 (javascript)。阅读[preventdefault()](http://api.jquery.com/event.preventDefault/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-26T21:55:53.200

您想在点击事件中提供的链接在页面的源代码中可见，因此任何想要查看它们的人都可以轻松完成。因此，正如您所说，遗留链接的某些功能将被禁用，因此您可以使用普通链接而不是 jQuery。

# ruby-on-rails-3 - 设计邀请节目邀请人姓名或电子邮件

> ID：14541859
> 
> 赞同：6
> 
> 时间：2013-01-26T21:41:05.093
> 
> 标签：ruby-on-rails-3, email, devise, invitation

我希望能够在发送设计邀请时显示发送邀请的用户，而不仅仅是我的域，但无法找到任何相关文档。

我需要显示这个名字的两个地方是在邀请电子邮件中-

（代替“某人”）

```
<p>Hello <%= @resource.email %>!</p>

<p>Someone has invited you to <%= root_url %>, you can accept it through the link below.</p>

<p><%= link_to 'Accept invitation', accept_invitation_url(@resource, :invitation_token => @resource.invitation_token) %></p>

<p>If you don't want to accept the invitation, please ignore this email.<br />
Your account won't be created until you access the link above and set your password.</p> 
```

和设置密码页面。

```
<h4>You're seeing this page because someone has invited you to the site</h4>
<%= simple_form_for resource, :as => resource_name, :url => invitation_path(resource_name), :html => { :method => :put } do |f| %>
  <%= devise_error_messages! %>
  <%= f.hidden_field :invitation_token %>
<div class="row">  
  <div class="signup_well span3 offset1">
    <legend><%= t 'devise.invitations.edit.header' %></legend>
    <%= f.input :password %>
    <%= f.input :password_confirmation %>
    <%= hidden_field_tag :token_key, resource.invitation_token %>
    <%= f.submit t("devise.invitations.edit.submit_button") %>
  <% end %>
</div> 
```

我可能会查看有关执行此操作的最佳方法的任何文档。您的帮助可以省去很多挫败感。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T13:34:35.493

这应该有效：<%= @resource.invited_by.first_name %>。

# iphone - iOS 上的原始 H264 NALU 硬件解码

> ID：14541861
> 
> 赞同：9
> 
> 时间：2013-01-26T21:41:12.240
> 
> 标签：iphone, ios, ipad, h.264

我从 IP 摄像头（通过 Live555）接收原始 H.264 NALU，我想使用硬件对其进行解码，因为 FFmpeg 很棒，但速度太慢（摄像头传感器很大）。

我看到的唯一解决方案是将 NALU 写入某些电影容器文件（例如 MPEG-4），然后使用`AVAssetReader`.

我在杂草丛中吗？是否有人成功从流中解码 H.264 NALU？有没有人有任何将 NALU 写入 MPEG-4 文件的提示？其他想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T04:50:51.020

就像 Matt 提到的那样，没有直接访问 Apple 的 H264 解码器的权限。

但是，我在 ffmpeg 和 h264 解码方面取得了成功。就像你提到的，我已经用 LGPL 构建了 ffmpeg，我能够将 H264 流一直解码为实时高清流，在 ipad 和 iphone 上都没有延迟。ffmpeg 不需要什么花哨的东西，你可以找到一堆标准的解码 c++ 代码，它们在 iOS 上运行得很好。此外，在我的例子中，H264 NALU 是通过 RTP/RTSP 实时交付的。

另外，如果我是你，我会通过 xcode 工具运行你的应用程序，以真正看到你的瓶颈在哪里，但我会非常惊讶它在 ffmpeg 解码步骤中。希望这些信息有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T11:15:32.917

不幸的是，您目前无法执行此操作。随意向 Apple 提交有关希望这种对硬件解码器的访问权限的雷达。它肯定会被解决为重复的:-)。我认为这是出于许可原因，他们无法授予对硬件编解码器的这种访问权限。

因此，您将不得不使用软件解码器。请注意，如果您要发布到 App Store，那么您需要具有非 GPL 许可证的东西（除非您也想开源您的应用程序）。

# java - IMAP 和标志.SEEN

> ID：14541862
> 
> 赞同：1
> 
> 时间：2013-01-26T21:41:19.337
> 
> 标签：java, imap

确保 IMAP 客户端与其服务器同步的一种方法是利用 SEEN 标志（例如，[用于 IMAP IDLE 的库](https://stackoverflow.com/questions/11362542/library-for-imap-idle)）。

我自己还没有使用过这个，但我想知道设置 SEEN 标志是否基本上将消息设置为在服务器上“读取”。

如果是这样，当涉及多个阅读器或用户直接登录服务器（例如，登录到他们的 Gmail 帐户）并在那里阅读邮件（因此它被“标记为已读”时，这显然是一个问题，并且 - 因此- 标记为已看到）。

或者，我可能完全误解了这一点，而 SEEN 在特定客户端和服务器之间是独一无二的。但是，不清楚在这种情况下如何保持状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T22:11:34.050

“利用 SEEN 标志”听起来像是一种与服务器同步的糟糕方法。正如您所猜测的，设置 SEEN 标志基本上会将消息设置为在服务器上“读取”。所有其他 IMAP 客户端将看到该消息已被读取。该标志在服务器和每个客户端之间不是“私有的”。除非用户已经看到，否则您的客户端不应将消息标记为“已看到”。

要进行同步，您需要跟踪客户端已经看到的消息的 UID，并在轮询文件夹时将列表与服务器上可用的列表进行比较。然后，您在本地丢弃不再在服务器上的那些（它们是已从其他客户端删除的消息）并下载您在本地列表中没有的那些（它们是新消息）。

如果您想要健壮并处理服务器忘记所有消息的 UID 并使用新 UID 重建文件夹的情况，它会变得更加复杂（如果索引损坏并在服务器上重建，服务器软件已更改，则可能会发生这种情况，服务器已成为不同的托管服务提供商等...）但这是基本思想。

# python - 从txt文件中提取字符串

> ID：14541864
> 
> 赞同：0
> 
> 时间：2013-01-26T21:41:22.270
> 
> 标签：python, string, python-2.7, extract

所以我只是在尝试，尝试使用 python 解析网络，我想我会尝试制作一个脚本来搜索我最喜欢的链接以在线观看节目。我现在正试图通过 sidereel.com 搜索我的节目，以找到我想要的节目的良好链接，并将链接返回给我。我知道该网站以以下格式保存链接：

watch-freeseries.mu'then 一些我需要忽略的长字符串，然后是 '14792088'

所以我需要做的是在网站的 txt 文件中找到这个字符串，然后只返回字符串末尾的 8 个数字。我不确定如何获得这些号码，我需要它们，因为它们是链接号码。任何帮助将非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:49:49.817

您可以使用[正则表达式](http://docs.python.org/2/library/re.html)相当容易地做到这一点。

```
>>> import re
>>> text = "watch-freeseries.mu=lklsflamflkasfmsaldfasmf14792088"
>>> expr = re.compile("watch\-freeseries\.mu.*?(\d{8})")
>>> expr.findall(text)
['14792088'] 
```

表达式分解：

`watch\-freeseries\.mu`- 匹配预期表达式的开头。转义任何可能的特殊字符，方法是在它们前面加上`\`.

`.*?`- 匹配任何字符。`.`表示任何字符，并`*`表示一个接一个地出现无数次。这`?`是执行非贪婪匹配，以便如果两个或多个 url 出现在同一字符串中，则匹配不会重叠。

`(\d{8})`- 匹配并保存最后 8 位数字

**注意**：如果您尝试从网页中解析链接，则有更简单的方法。我在 StackOverflow 上看到了很多关于 BeautifulSoup 包的建议。我自己从来没有用过它，所以YMMV。

# ios - 在块内，__block 变量和静态变量之间的实际区别是什么？

> ID：14541865
> 
> 赞同：5
> 
> 时间：2013-01-26T21:41:24.520
> 
> 标签：ios, objective-c, cocoa-touch, cocoa

我想在单个块的多次调用中重用对象引用，我很好奇：以下两种方法之间的实际区别是什么？

**使用`__block`变量：**

```
__block Widget *widget = [self buildNewWidget];

for(Gadget *gadget in self.gadgets) {
    [self useGadget:gadget withCallback:^{
        if([widget isBroken]) {
            widget = [self buildNewWidget];
        }

        gadget.widget = widget;
    }];
} 
```

**使用`static`变量：**

```
for(Gadget *gadget in self.gadgets) {
    [self useGadget:gadget withCallback:^{
        static Widget *widget;

        if(!widget || [widget isBroken]) {
            widget = [self buildNewWidget];
        }

        gadget.widget = widget;
    }];
} 
```

显然，这两个代码块从语义角度来看是不同的，但是（实际上）我相信它们做的是相同的基本工作。我的猜测是，从内存管理角度、性能角度或其他角度来看是有区别的。任何说明这些差异（或解释为什么它们没有不同）的见解都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T01:46:01.770

一个例子值一千字：

（是的，这是一个非常简单的例子，但它基本上相当于你在做什么......）

```
for (int i = 0; i < 3; i++)
{
    // Your example encompasses this scope,
    // not taking into account that we may execute this code multiple times:

    // Call the block
    (^{
        // Every instance/execution of this block will have the same object.
        static Obj *o;

        // Initialize static object
        static dispatch_once_t once;
        dispatch_once(&once, ^{
            o = [Obj new];
        });

        NSLog(@"Object is: %@", o);
    })();
}
// Output:
//   Object is: <Obj: 0x100109fd0>
//   Object is: <Obj: 0x100109fd0>
//   Object is: <Obj: 0x100109fd0>

for (int i = 0; i < 3; i++)
{
    __block Obj *o = [Obj new];

    // Call the block
    (^{
        // This block uses the object from its enclosing scope, which may be different.
        NSLog(@"Object is: %@", o);
    })();
}
// Output:
//   Object is: <Obj: 0x105100420>
//   Object is: <Obj: 0x1003004f0>
//   Object is: <Obj: 0x105300000> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T23:15:32.423

正如所写，这两个代码片段的工作方式不同，并且它们具有不同的最终结果。

第二组代码是等待发生的故障。如果由于使用了静态变量，此代码同时在两个不同的线程上运行，它将失败。此代码也将失败，因为您从未初始化静态变量。第一次到达该`if`语句时，应用程序可能会崩溃。

由于循环的每次迭代似乎都取决于 的当前值`widget`，因此您需要有一个在循环之前初始化的局部变量。由于需要在块内修改此变量，因此您需要将变量设为`__block`变量。这意味着您的第一组代码是正确的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-27T02:21:59.867

出于此答案的目的，假设两个示例都包含在`-(void)useGadgetsOnWidgets { ... }`.

假设 ARC，您的应用程序是单线程的并且代码是不可重入的（即`useGadgetsOnWidgets`不调用自身），并且在方法返回后不使用该块，有一个主要区别：

有一个`static`变量，`widget`永远存在。这意味着小部件可以在调用之间重用`-useGadgetsOnWidgets`（这可能是好的也可能是坏的），但也意味着小部件会被永久保留。您可以通过将小部件从循环/块中拉出来更改它（我也在开始时将其初始化为更类似于`__block`版本：

```
-(void)useGadgetsOnWidgets {
  static Widget *widget;
  widget = [self buildNewWidget];
  for(Gadget *gadget in self.gadgets) {
    [self useGadget:gadget withCallback:^{
      if([widget isBroken]) {
        widget = [self buildNewWidget];
      }
      gadget.widget = widget;
    }];
  }
  widget = nil;
} 
```

还有第三种变体，它在某种程度上是线程安全的，并假定在方法返回后不使用该块：

```
-(void)useGadgetsOnWidgets {
  Widget *widget = [self buildNewWidget];
  Widget ** pWidget = &widget;
  for(Gadget *gadget in self.gadgets) {
    [self useGadget:gadget withCallback:^{
      if([*pWidget  isBroken]) {
        *pWidget = [self buildNewWidget];
      }
      gadget.widget = *pWidget ;
    }];
  }
} 
```

这似乎比使用`static`变量（实际上只是一个全局变量）要好一些，但它仍然很棘手。我也不想教给新手程序员的技术（但话又说回来，任何类型的多线程也不是）。

**编辑：**对于您描述的问题，比其中任何一个更好的解决方案是将小部件缓存在 ivar/property 上`self`：

```
-(Widget*)workingWidget {
  // Assuming _cachedWidget is an ivar
  if ([_cachedWidget isBroken]) {
    _cachedWidget = [self buildWidget];
  }
  return _cachedWidget;
}

-(void)useGadgetsOnWidgets {
  for(Gadget *gadget in self.gadgets) {
    [self useGadget:gadget withCallback:^{
      gadget.widget = [self workingWidget];
    }];
  }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-26T23:20:26.310

__block 使变量在块内可用，就像它是全局的一样。如果你在块内使用它，它不会被复制，而是被引用，因为它就像全局一样，它仍然是活动的。但是下次你调用该代码块时，另一个变量将被压入堆栈。

static 使变量仅在范围内可见，并且它在程序的整个执行过程中仍然存在。但是，如果您再次调用该代码块，变量将是相同的。

# javascript - 如何检测是否有更多数据异步提取到 DOM 中？

> ID：14541868
> 
> 赞同：0
> 
> 时间：2013-01-26T21:42:05.840
> 
> 标签：javascript, html, google-chrome, javascript-events

具体来说，我想在 facebook 页面加载时调用此函数：

```
window.addEventListener('load', myFunc); 
```

但是，该函数似乎只被调用一次（在构造 DOM 之后）。我还希望当我向下滚动页面底部并获取更多数据时动态调用该函数。我应该设置什么样的事件监听器？有哪些替代解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:55:29.563

没有很好的跨浏览器方法来检测对 DOM 的一般更改。以下是您的一些选择：

1.  DOM 变异观察者（仅在某些浏览器中支持）：[较新的变异观察者](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver?redirectlocale=en-US&redirectslug=DOM/DOM_Mutation_Observers) 和[不推荐使用的变异事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)。

2.  定期轮询内容以查看是否添加了新内容的计时器。

3.  监视滚动事件并在滚动条到达底部时触发一些轮询（＃2 的潜在更有效版本）。

# python - 如何在 virtualenv 中的 python 2.7.3 中升级 sqlite3？

> ID：14541869
> 
> 赞同：4
> 
> 时间：2013-01-26T21:42:16.200
> 
> 标签：python, sqlite, virtualenv

python 2.7.3 附带了一个 sqlite3 库，但它几乎不是最新版本。

我想在 virtualenv 环境中升级它。换句话说，升级只适用于这个 virtualenv 中安装的 python 版本。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T17:38:56.063

以下对我有用，但如果有任何改进的余地，请发表评论：

1.  激活要安装最新版本的 virtualenv`sqlite3`

2.  `pysqlite`从谷歌代码获取最新的包源：`wget http://pysqlite.googlecode.com/files/pysqlite-2.6.3.tar.gz`

3.  从源代码编译`pysqlite`并与*最新* `sqlite`的数据库一起编译：`python setup.py build_static`

4.  将其安装到virtualenv的**site-packages目录：**`python setup.py install`

5.  以上将实际安装`pysqlite`into `path-to-virtualenv/lib/python2.7/site-packages`，这是所有其他 pip 安装的库所在的位置。

现在，我在 virtualenv 中安装了最新版本的`sqlite`（编译成），所以我可以这样做：`pysqlite``from pysqlite2 import dbapi2 as sqlite`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-24T18:58:51.283

我检查了这样的设置，有效：

```
export export LD_LIBRARY_PATH=$HOME/<your-sqlite-install-dir>/sqlite3/lib 
```

我已将其添加到文件中的行`export PATH`旁边`activate`：

```
PATH="$VIRTUAL_ENV/bin:$PATH"
export PATH
export LD_LIBRARY_PATH=$HOME/…/sqlite3/lib  # <- Here 
```

可以通过以下两种方式之一进行检查。

在*virtualenv*中的 Python 中，首先执行以下操作：

```
>>> import _sqlite3
>>> _sqlite3.__file__
'/usr/lib/…/_sqlite3.cpython-35m-i386-linux-gnu.so' 
```

然后退出 Python 并`ldd`在返回的字符串上运行：

```
$ ldd /usr/lib/…/_sqlite3.cpython-35m-i386-linux-gnu.so
> …
> libsqlite3.so.0 => /home/…/sqlite3/lib/libsqlite3.so.0
> … 
```

或者，再次使用来自*virtualenv*的 Python ：

```
>>> import sqlite3
>>> sqlite3.sqlite_version
'3.21.0'  # Was 3.11.8 before 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-02T05:08:46.967

我曾经陷入同样的​​问题。这为我解决了它：

1.  下载并解压所需的python版本
2.  mkdir 本地
3.  下载软件包后解压 sqlite
4.  ./configure --prefix=/home/aanuj/local
5.  制作
6.  进行安装
7.  ./configure --prefix=/home/anauj/local LD​​FLAGS='-L/home/aaanuj/local/lib' CPPFLAGS='-I/home/aanuj/local/include'
8.  制作
9.  找到 sqlite3.so 并复制到 home/desired loc
10.  提取海狸
11.  使用所需的 python 版本设置虚拟环境
12.  激活环境
13.  unalias python
14.  导出 PYTHONPATH=/home/aanuj(_sqlite3.so 的位置)
15.  享受

# macos - 在 Mac 上通过 MATLAB 运行时出现令人讨厌的 cat/sed 行为

> ID：14541871
> 
> 赞同：0
> 
> 时间：2013-01-26T21:42:42.520
> 
> 标签：macos, matlab, sed

我正在运行一个脚本来解析可以由 MATLAB 调用或从命令行运行的文本电子邮件文件。脚本如下所示：

```
#!/bin/bash

MYSED=/opt/local/bin/gsed

"$MYSED" -n "/X-FileName/,/*/p" | "$MYSED" "/X-FileName/d" | "$MYSED" "/\-Original Message\-/q" 
```

如果我`cat message_file | ./parser.sh`在终端窗口中运行，我会得到一个解析的文本文件。如果我`system`在 MATLAB 中使用命令执行相同操作，我偶尔会得到相同的解析文本，然后是错误消息

```
cat: stdout: Broken pipe 
```

当我使用`sed`命令而不是`cat`命令时，我收到了相同的错误消息。这可能发生在我正在解析的 1% 的文件上，几乎总是`Original Message`在行后删除很多文件的大文件。当我不包含最后一个管道时，我没有收到错误消息，即删除“原始消息”之后的所有内容的管道。

如果可能，我想禁止来自 cat 的错误消息。理想情况下，我想了解为什么通过 MATLAB 运行脚本会给我一个错误，而在终端中运行它却不会？由于它往往发生在较大的文件上，我猜它与内存限制有关，但“断管”是一个模糊的错误消息，我无法确定。任何关于这两个问题的提示将不胜感激。

我可能可以在 MATLAB 之外运行脚本并保存处理过的文件，但由于某些文件很大，我现在宁愿不复制它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:33:24.630

由于最终的 gsed 命令`"$MYSED" "/\-Original Message\-/q"`. 这（显然）一看到匹配就退出，如果 gsed 喂它试图在之后写任何东西，它将接收 SIGPIPE 并退出，如果有足够的数据，第一个 gsed 也会发生同样的情况，如果有SIGPIPE 之后的足够数据将被发送到`cat`报告错误的原始命令。错误是否返回`cat`将取决于时间、缓冲、数据量、月相等。

我的第一个建议是将`"$MYSED" "/\-Original Message\-/q"`命令放在管道的开头，并让它从文件中读取（而不是从 cat 中读取）。这意味着更改脚本以接受要从中读取的文件作为参数：

```
#!/bin/bash

MYSED=/opt/local/bin/gsed

"$MYSED" "/\-Original Message\-/q" "$@" | "$MYSED" -n "/X-FileName/,/*/p" | "$MYSED" "/X-FileName/d" 
```

...然后使用`./parser.sh message_file`. 如果我对消息文件格式的假设是正确的，那么以这种方式更改 gsed 命令的顺序应该不会造成麻烦。消息文件是否有任何理由需要通过管道传输到标准输入，而不是作为参数传递并直接读取？

# windows-phone-7 - 更改 Pivot 的 ItemsSource 时如何防止 System.ArgumentOutOfRangeException

> ID：14541878
> 
> 赞同：2
> 
> 时间：2013-01-26T21:43:18.667
> 
> 标签：windows-phone-7, windows-phone-8

当我重新设置 Pivot 的 ItemsSource 属性时，我得到 System.ArgumentOutOfRangeException。

```
<phone:Pivot x:Name="Pivot" ItemsSource="{Binding Items}" /> 
```

例如

```
Items = {collection of 5 elements}
Pivot.SelectedIndex = 4;
Items = {collection of 5 elements} //no exception, item count matches previous
Items= {collection of 3 elements}  //throws System.ArgumentOutOfRangeException 
```

似乎如果 Pivot 的 SelectedIndex 高于新分配的集合中的项目计数，则会引发异常。我试图通过`Pivot.SelectedIndex = 0`在分配新值之前进行设置来防止它，`Items`但它没有帮助。

在设置 SelectedIndex 时，我也会遇到非常奇怪的行为，我通过延迟来缓解这种行为，例如：

```
//Setting a new value to Items 
Items = {collection of 5 elements}
await Task.Delay(50) //Pivot won't update SelectedIndex unless I pause a little, odd...
Pivot.SelectedIndex = 3; 
```

我想提一下，从一开始我就希望简单地使用 ObservableCollection，将其绑定到 Pivot 的 ItemSource 并根据需要进行修改，而不是每次我有新项目时都为 ItemsSource 分配一个新集合。但是，它根本无法工作并使应用程序崩溃。

# special-characters - FPDF 将撇号转换为奇怪的字符

> ID：14541881
> 
> 赞同：1
> 
> 时间：2013-01-26T21:43:43.483
> 
> 标签：special-characters, decode, fpdf, apostrophe

我从 JavaScript 表单传递了这个字符串：4 H/M's

它被发布到一个名为“$out”的数组中，并由“blurb”键控。

我使用 FPDF 使用 MultiCell 输出它，如下所示：

```
$pdf->MultiCell(190,4,$out["blurb"]); 
```

然而，FPDF 输出这个字符串：

```
4 H/Mâ€™s 
```

我试过了

```
html_entity_decode($out["blurb"], ENT_QUOTES, "UTF-8") 
```

但它似乎没有工作。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T13:40:48.433

像这样使用 iconv ：

```
// put $str your sting to encode for FPDF
// put $myencoding value as you current encoding
//

function fpdf_encode($str,$myencoding='latin1'){
return iconv($myencodig, 'windows-1252', trim(utf8_decode($str)));
} 
```

我希望这对其他人有帮助。

# php - 文件夹的正则表达式

> ID：14541883
> 
> 赞同：0
> 
> 时间：2013-01-26T21:43:54.263
> 
> 标签：php, regex

我想要一个正则表达式来测试满足以下要求的字符串：

*   它可能包含`a-z` `A-Z`和`0-9`
*   它可能包含`-`但`_`不能以这些字符开头或结尾
*   它也可能包含一个空格，但不能以它开头或结尾

它应该匹配以下字符串：

*   带有一些内容的文件夹
*   有内容的文件夹
*   folder_with_content
*   包含内容的文件夹

有人可以帮我吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:47:12.300

你有你的作品，所以把它们放在一起：

```
/^[a-z0-9](?:[a-z0-9_ -]*[a-z0-9])?$/i 
```

这正是您正在寻找的。唯一复杂的部分是允许单个字符。

# html - 语言切换导航的正确语义是什么？

> ID：14541886
> 
> 赞同：8
> 
> 时间：2013-01-26T21:44:36.587
> 
> 标签：html, semantic-web, semantic-markup, nav, microdata

我正在编写一个多语言网站，我有以下导航：

```
 <nav id="language">
    <ul>
      <li><a href="/en/" hreflang="en">en</a></li>
      <li><a href="/de/" hreflang="de">de</a></li>
      <li>fr</li>
    </ul>
    </nav> 
```

**我可以改进语义吗？**带有微数据或标签属性，例如

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-27T15:06:36.253

### `abbr`元素

您应该添加`abbr`，并给出相应语言的完整语言名称：

```
<nav id="language">
  <ul>
    <li><a href="/en/" hreflang="en"><abbr lang="en" title="English">en</abbr></a></li>
    <li><a href="/de/" hreflang="de"><abbr lang="de" title="Deutsch">de</abbr></a></li>
    <li><abbr lang="fr" title="Français">fr</abbr></li>
  </ul>
</nav> 
```

### `title`属性为`a`

您可以添加一个`title`属性，`a`其内容如下：“切换到此页面的英文翻译”

### 往...去`nav`

你可以给这个`nav`部分一个标题，比如“这个页面的翻译”（对于英文页面）。

如果您不希望它在页面上可见，请将其隐藏，以便屏幕阅读器用户仍然可以读取它（例如，使用`clip`方法）。

（如果您提供这样的标题，您可能不再需要该`title`属性`a`。）

### 另外：`link`元素（在`head`）

对于机器人，您可以将翻译与页面`link`中的元素`head`链接：

```
<link rel="alternate" href="/de/" hreflang="de" />
<link rel="alternate" href="/en/" hreflang="en" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T07:29:58.383

您应该在链接上添加一个`lang`and`hreflang`属性，并使用[IETF 语言标签](http://tools.ietf.org/html/bcp47)(bcp47) 作为目标值，参见例如维基百科关于*水*的文章中的链接到其他语言的相同项目：

```
<a lang="de" hreflang="de" title="Wasser" href="//de.wikipedia.org/wiki/Wasser">Deutsch</a> 
```

注意：该`lang`属性不是链接特定的。它指定标签内容的语言（维基百科也将它放在`<html>`- 标签和`<h1>`标题标签中。），同时`hreflang`指定您链接到的页面的语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T21:49:12.737

我认为也许改成`en`会`Change site language to English`改善语义。就目前而言，`en`没有上下文就非常神秘。

# php - 将日期+时间插入电子邮件主题

> ID：14541887
> 
> 赞同：0
> 
> 时间：2013-01-26T21:44:49.080
> 
> 标签：php, email, sendmail

如何在主题的开头插入日期和时间，例如

代码中的 date('dmY h:m:s') 不起作用并返回此错误：解析错误：语法错误，意外的 T_STRING

```
<?php
    mail('joe@example.com', '"date('d-m-Y h:m:s')" Daily Backup: example.com', 'Download your daily backup from this link: http://example.com/backups/backup.zip');
?> 
```

此代码有效：（没有日期和时间）

```
<?php
    mail('joe@example.com', 'Daily Backup: example.com', 'Download your daily backup from this link: http://example.com/backups/backup.zip');
?> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T21:47:40.143

您错过了将 php 代码封装在字符串中：

```
mail('joe@example.com', '"'.date('d-m-Y h:m:s').'" Daily Backup: example.com', 'Download your daily backup from this link: http://example.com/backups/backup.zip'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:48:35.170

它看起来像一个语法错误。尝试在开始字符串之前放置日期函数，使其变为

```
<?php
    mail('joe@example.com', date('d-m-Y h:m:s').' Daily Backup: example.com', 'Download your daily backup from this link: http://example.com/backups/backup.zip');
?> 
```

# php - 删除仅包含特殊字符的数组

> ID：14541889
> 
> 赞同：-2
> 
> 时间：2013-01-26T21:45:14.687
> 
> 标签：php

如何从仅包含特殊字符（如 .、* 等）的数组中删除所有元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T22:04:17.657

```
function only_specialchars($string) {
    if (preg_match("/[a-z0-9]/i", $string)) {
        return false;
    } else {
        return true;
    }
}

$filtered = array_filter($array, "only_specialchars")); 
```

像这样的东西？这将过滤所有**不**包含字符或数字的单词。

# tridion - 避免在 Tridion 相关代码中硬编码 TCM URI

> ID：14541895
> 
> 赞同：7
> 
> 时间：2013-01-26T21:46:11.290
> 
> 标签：tridion

我们经常需要 Tridion 相关代码中的特定项目（模式、模板或组件）。模板、内容交付、工作流或业务连接器（核心服务）经常需要对[Tridion Content Manager URI](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_D4A9A9C3DAC042308DF557CD287A325B)的引用。我们可以链接到组件，但我通常会看到硬编码的值或其他所有内容的 WebDAV URL。

# 硬编码值

我了解硬编码 Tridion Content Manager (Native) URI 是一种不好的做法，除了以下几种情况：

*   简化示例代码并明确变量是什么
*   生成用于内容交付 (CD) API 逻辑时

只要有可能，我们就使用给定的 API 或 WebDAV URL 来引用项目，否则我们必须避免在任何引用 TCM URI 的东西上使用 Content Porter（或者以某种方式使这些引用在 Tridion 之外“可配置”）。

## WebDAV URL

[WebDAV URL](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_11BA56D2F9064F19BEFDCFEEC5C49220)似乎更好，原因如下：

*   设计模板构建块 (TBB) 或其他模板格式中的硬编码值在 SDL Content Porter 中保持不变（在 CMS 环境中移动时会破坏关系，下面描述的例外情况）
*   引用特定项目的“配置”组件在使用 SDL Content Porter 时也做得更好，尽管不同名称的路径可能会“破坏”关系

## 用例

除了拥有与 Content Porter 配合良好的模板外，我还想在较低的出版物中本地化文件夹和/或结构组。这可以帮助：

*   阅读不同语言的 CMS 作者
*   将项目名称和路径翻译成适当的语言
*   也许可以帮助用户更好地导航（例如，我怀疑不同名称的文件夹可能会减少作者在蓝图中的位置的混淆）

## 一种方法

至少对于模板构建块而言，要使引用“内容搬运器友好”，我知道我们可以在*组件*中使用 WebDAV Urls，以确保将每个路径本地化到子出版物中的正确位置。例如：

1.  代码检查发布元数据
2.  发布元数据指向“配置组件”
3.  Config 组件的路径为 WebDAV URL

只要我们设置发布元数据并将字段本地化到每个发布的正确路径，这将适用于大多数情况。

## 问题

*   **我做对了吗？是否有更简单或更易于维护的设置？**

我相信我们可以选择在模板代码中使用**包含**或[映射非托管 URI](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_ContentPorter_2009_SP1/task_903D6DCFA2C94827B294E1F0ABF7E2D4)。

*   **有人有这种`#include`方法的例子吗？**我是否在 TBB 和/或 DWT 的顶部使用它，并且无论模板中介者如何，引用都会被替换（例如，这将与 XSLT 中介者、Razor 中介者等一起使用吗？）

*   **包含的参考资料是否适用于较低的出版物，还是仅适用于 Content Porter？**换句话说，如果我引用“tcm:5-123”，模板会在出版物 17 中正确引用“tcm:17-123”吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T12:42:05.010

我倾向于遵循一些简单的规则...

1.  没有单一的正当理由在任何东西（模板代码、配置组件、配置文件）中使用 TCM ID。
2.  如果我需要配置 webdav URL，我会尝试始终使它们“相对”，通常从“/Building%20Blocks”而不是发布名称开始。在运行时，我可以使用`Publication.WebDavUrl`或`PublicationData.LocationInfo.WebDavUrl`获取 URL 的其余部分
3.  Tridion 知道如何处理托管链接，因此尽可能使用它们。（托管链接是`xlink:href`您在 Tridion XML 上看到的东西）。

我还倾向于使用“配置页面”进行内容交付，并使用模板输出我可能需要从内容交付应用程序“了解”的 TCM ID。然后在运行时将其作为一组配置变量或作为字典或作为一组常量加载（我想这取决于我那天的感受）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T07:26:03.033

尽管我们通常将模板类型实现称为模板中介，但这并不是故事的全部。模板类型实现由模板中介和[模板内容处理](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_3CB7EF18747E414BB046176199BCA20B)程序组成，尽管后者是可选的。给定的实现是否会正确处理“包含”不取决于中介，而是处理程序。

可以通过搜索找到文档中的一个很好的起点`AbstractTemplateContentHandler`。

SDL Tridion 自己的 Dreamweaver 模板实现具有这样的处理程序。我刚刚查看了[Razor 实现](http://code.google.com/p/razor-mediator-4-tridion/)，它目前使用 Dreamweaver 内容处理程序。显然，[YMMV](http://en.wiktionary.org/wiki/your_mileage_may_vary)用于存在的各种 XSLT 模板类型实现。

由于这是 SDL Tridion 的一个可扩展点，因此包含的引用是否会在较低的出版物中“正确”工作取决于实施者对这意味着什么的看法。

一种有趣的可能性是实现您自己的行为如您所愿的自定义处理程序。模板类型配置（在 Tridion Content Manager 配置文件中）允许独立指定给定模板类型的中介和内容处理程序，这意味着您可以潜在地为现有模板类型自定义内容处理行为。

# android - 如何使用我自己的数据库 - android

> ID：14541898
> 
> 赞同：3
> 
> 时间：2013-01-26T21:46:28.280
> 
> 标签：android, sqlite

> **可能重复：**
> [如何将现有数据库与 Android 应用程序一起使用](https://stackoverflow.com/questions/9109438/how-to-use-an-existing-database-with-an-android-application)

我有一个 sqlite 数据库文件，我想在我的应用程序中使用它。

我该怎么做 ？

如何将我的 db 文件推送到模拟器，然后在我的代码中使用它？

欢迎任何解决方案。提前谢谢，汤姆。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T22:10:54.660

```
public class AssetDatabaseHelper extends SQLiteOpenHelper {

    private String dbName;
    private String db_path;
    private Context context;

    /**
     * A helper class to import db files.
     * 
     * @param base
     *            /app context
     * @param dbName
     *            The name of the db in asset folder .
     */
    public AssetDatabaseHelper(Context context, String dbName) {
        super(context, dbName, null, 1);
        this.dbName = dbName;
        this.context = context;
        db_path = "/data/data/" + context.getPackageName() + "/databases/";
    }

    /**
     * Check if the database already exist to avoid re-copying the file each
     * time you open the application.
     * 
     * @return true if it exists, false if it doesn't
     */
    public boolean checkExist() {

        SQLiteDatabase checkDB = null;

        try {
            String myPath = db_path + dbName;
            checkDB = SQLiteDatabase.openDatabase(myPath, null,
                    SQLiteDatabase.OPEN_READONLY);

        } catch (SQLiteException e) {
            e.printStackTrace();
            // database does't exist yet.

        } catch (Exception ep) {
            ep.printStackTrace();
        }

        if (checkDB != null) {

            checkDB.close();

        }

        return checkDB != null ? true : false;
    }

    /**
     * Creates a empty database on the system and rewrites it with your own
     * database.
     * */
    public void importIfNotExist() throws IOException {

        boolean dbExist = checkExist();

        if (dbExist) {
            // do nothing - database already exist
        } else {

            // By calling this method and empty database will be created into
            // the default system path
            // of your application so we are gonna be able to overwrite that
            // database with our database.
            this.getReadableDatabase();

            try {

                copyDatabase();

            } catch (IOException e) {

                throw new Error("Error copying database");

            }
        }

    }

    private void copyDatabase() throws IOException {
        InputStream is = context.getAssets().open(dbName);

        OutputStream os = new FileOutputStream(db_path + dbName);

        byte[] buffer = new byte[4096];
        int length;
        while ((length = is.read(buffer)) > 0) {
            os.write(buffer, 0, length);
        }
        os.flush();
        os.close();
        is.close();
        this.close();
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    }

} 
```

基于本[教程](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)。你把你的 sqlite 数据库文件放在你的资产文件夹中，当你运行代码时它会被复制。我的版本允许多个数据库文件，因为它选择了路径。要使用它：

```
AssetDatabaseHelper dbHelper = new AssetDatabaseHelper(
                getBaseContext(), SomeDataBase.SOME_DATABASE_NAME);
        try {
            dbHelper.importIfNotExist();
        } catch (IOException e) {
            e.printStackTrace();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T22:01:51.793

您需要扩展`SQLiteOpenHelper`以匹配您的数据库表。这将允许您的应用程序与数据库进行交互。检查这个：http: [//developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)

要使用数据库，请`/data/data/your.package/databases/`在模拟器运行时使用 Eclipse 中的 Android->File Explorer 视图。

# haskell - 在 Haskell quasiquoter 中拼接任意表达式

> ID：14541899
> 
> 赞同：6
> 
> 时间：2013-01-26T21:46:28.500
> 
> 标签：haskell, template-haskell

通读[Why It's Nice to be Quoted](http://www.eecs.harvard.edu/~mainland/publications/mainland07quasiquoting.pdf)，在第 3 节中，有一个在 quasiquote 中拼接变量标识符的示例。

```
subst [:lam | $exp:e1 $exp:e2 |] x y =
    let e1' = subst e1 x y
        e2' = subst e2 x y
    in
        [:lam | $exp:e1' $exp:e2' |] 
```

我明白为什么递归调用`subst`是在外部完成的`[:lam| ... |]`，这是因为第 3.2 节中的函数从变量名中`antiVarE`构建了`TH.varE`

我的问题是需要多少工作才能支持除了变量名之外的任意表达式拼接？

例如：

```
subst [:lam | $exp:e1 $exp:e2 |] x y =
      [:lam | $exp:(subst e1 x y) $exp:(subst e2 x y) |] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T04:00:35.573

为后代回答我自己的问题。

原来这很简单。使用[haskell-src-meta](http://hackage.haskell.org/package/haskell-src-meta)`parseExp`包中的函数，我能够轻松地将字符串转换为 AST 片段。

在原始论文中，除了捕获括号之间的表达式字符串所需的解析器更改之外，该`antiExpE`函数可以这样重写。

```
antiExpE :: Exp -> Maybe TH.ExpQ
antiExpE (AE v) =
    case parseExp v of
        Right exp -> Just . return $ exp
        Left _    -> Nothing
antiExpE = Nothing 
```

# java - 线程停止问题android

> ID：14541907
> 
> 赞同：2
> 
> 时间：2013-01-26T21:47:12.597
> 
> 标签：java, android, multithreading, splash-screen

我想在点击启动画面时停止正在运行的线程，如果我不点击屏幕，在线程执行后，它将启动另一个活动。但是得到`UnSupportedException`，我该如何解决呢？

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_splash);
    iImage = (ImageView) findViewById(R.id.iIcon);
    splashImage = (ImageView) findViewById(R.id.splash_image);

    iImage.setOnClickListener(this);
    splashImage.setOnClickListener(this);
}

@Override
protected void onStart() {
    super.onStart();
    splashTimer = new Thread(new Runnable() {
        @Override
        public void run() {
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            startActivity(new Intent(SplashActivity.this, LoginAuthenticationActivity.class));
            finish();
        }
    });
    splashTimer.start();
}

@Override
public void onClick(View view) {
    if(splashTimer.isAlive())
        splashTimer.stop();
    switch (view.getId()) {
        case R.id.iIcon:
            startActivity(new Intent(this, AboutUsActivity.class));
            break;
        case R.id.splash_image:
            startActivity(new Intent(this, LoginAuthenticationActivity.class));
            break;
        default:
            break;
    }
    finish();
} 
```

日志：

```
01-27 03:27:01.189: W/dalvikvm(1080): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
01-27 03:27:01.209: E/AndroidRuntime(1080): FATAL EXCEPTION: main
01-27 03:27:01.209: E/AndroidRuntime(1080): java.lang.UnsupportedOperationException
01-27 03:27:01.209: E/AndroidRuntime(1080):     at java.lang.Thread.stop(Thread.java:1076)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at java.lang.Thread.stop(Thread.java:1063)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at com.app.wooqer.SplashActivity.onClick(SplashActivity.java:48)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.view.View.performClick(View.java:3511)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.view.View$PerformClick.run(View.java:14105)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.os.Handler.handleCallback(Handler.java:605)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.os.Looper.loop(Looper.java:137)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at android.app.ActivityThread.main(ActivityThread.java:4424)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at java.lang.reflect.Method.invokeNative(Native Method)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at java.lang.reflect.Method.invoke(Method.java:511)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-27 03:27:01.209: E/AndroidRuntime(1080):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:02:59.233

您正在做的事情非常浪费（任何启动画面都是浪费，但使用这样的线程更是如此），但要解决您的问题：

使用`interrrupt();`而不是`stop();`

正如[文档](http://developer.android.com/reference/java/lang/Thread.html#stop%28%29)所说`stop()`

```
Throws UnsupportedOperationException. 
```

要解决重复问题，请移动`startActivity()`内部，`try`使其看起来像这样：

```
public void run() {
  try {
    Thread.sleep(5000);
    startActivity(new Intent(SplashActivity.this, LoginAuthenticationActivity.class));
  } catch (InterruptedException e) {
    e.printStackTrace();
  }
  finish();
} 
```

这样，当您调用`interrupt()`所有 Activity时，不会调用`finish()`副本`startActivity()`。

进一步说明：

第一个问题：`stop()`默认情况下抛出异常，因为它是您不应该使用的不安全方法。

然后，当您使用 时`interrupt()`，您已经在catch 块**之后**`startActivity()`的 run 方法中。当你打断时，被调用一次和一次。通过在块内移动到 之后，当中断时，块的其余部分不会被执行。这意味着您现在只有一个电话，而不是两个。有关更多信息，请阅读[异常](http://docs.oracle.com/javase/tutorial/essential/exceptions/)。**`startActivity()``run()``onClick()``startActivity()``try``Thread.sleep()``interrupt()``Thread``try``startActivity()`**

# c++ - 如何从字节流中提取数据包？

> ID：14541908
> 
> 赞同：2
> 
> 时间：2013-01-26T21:47:13.983
> 
> 标签：c++, boost, serial-port, buffer, boost-asio

我想编写一个从串行端口读取数据包的应用程序。 [我在 Stack Overflow 上探讨了不同的问题，看起来使用 boost::asio 是要走的路](https://stackoverflow.com/questions/2807055/reading-from-serial-port-with-boost-asio)。

但是，我以前从未真正使用过串行端口或 boost::asio，我正在寻找一些关于如何在字节流中“查找”数据包的高级指导。

串行端口发出的每个数据包由 13 个字节组成。不幸的是，数据包不包含任何类型的标头标志，但最后一个字节包含前 12 个字节的校验和。

我假设如果我开始读取串行端口，我得到的第一个字节不一定是数据包的第一个字节。事实上，我读取的第一个字节可能在数据包中间的某个地方。

*   我打算让主线程定期从串行端口读取一堆数据包并将它们存储到缓冲区中。

*   第二个线程定期扫描缓冲区并寻找有效的校验和。假设它找到一个有效的校验和，这意味着校验和字节加上前面的 12 个字节形成一个有效的数据包。

这是一种有效的方法吗？

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T21:50:11.130

现实世界的串行协议通过使用引入序列来允许同步（明确识别边界的字节或字节序列）来解决这个问题。你必须阅读直到你看到一个，丢弃之前的东西。我想，只要寻找具有有效校验和的 12+1 就可以了。

# multithreading - 这个 Haskell 聊天代码中的同步缺陷是什么，修复方法是什么？

> ID：14541910
> 
> 赞同：7
> 
> 时间：2013-01-26T21:47:17.057
> 
> 标签：multithreading, haskell, concurrency, chat

[Simon Marlow](https://stackoverflow.com/users/353875/simon-marlow)在 Haskell eXchange 2012 上做了一个[高性能并发](http://skillsmatter.com/podcast/home/high-performance-concurrency/te-6536)演讲。由于时间限制，他跳过了关于简单并发聊天服务器的部分。对省略的内容感到好奇，通过网络搜索在服务器应用程序和[GitHub 上的实现中发现了类似的](https://github.com/simonmar/par-tutorial/blob/master/code/chat/Main.hs)[幻灯片](http://community.haskell.org/~simonmar/slides/cadarache2012/5%20-%20server%20apps.pdf)。

[幻灯片 33](http://community.haskell.org/~simonmar/slides/cadarache2012/5%20-%20server%20apps.pdf#page=33)读取

> 回话……
> 
> ```
> talk :: Server -> Handle -> IO ()
> talk server@Server{..} handle = do
>     hSetNewlineMode handle universalNewlineMode
>     hSetBuffering handle LineBuffering
>     readName
>   where
>     readName = do
>       hPutStrLn handle "What is your name?"
>       name <- hGetLine handle
>       m <- checkAddClient server name handle
>       case m of
>          Nothing -> do
>            hPrintf handle "The name %s is in use" name
>            readName
>          Just client -> do
>            runClient server client
>               `finally` removeClient server name 
> ```
> 
> 严格来说，我们应该堵住和之间的洞`checkAddClient`（`finally`见注释……）

早些时候，[幻灯片 3](http://community.haskell.org/~simonmar/slides/cadarache2012/5%20-%20server%20apps.pdf#page=3)提到了“笔记​​中的第 14 章”，我认为这是指他[即将出版的书](http://www.haskell.org/pipermail/haskell/2012-May/023328.html)。`checkAddClient`和之间的同步裂缝是什么`finally`，我们如何堵塞它？

上述实现使用[`mask`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html#v:mask)来自 Control.Exception。如果这是解决方法，那么不合时宜的异常会破坏聚会的情况是什么？

> ```
> ...
> readName = do
>   hPutStrLn handle "What is your name?"
>   name <- hGetLine handle
>   if null name
>      then readName
>      else mask $ \restore -> do
>             ok <- checkAddClient server name handle
>             case ok of
>               Nothing -> restore $ do
>                  hPrintf handle
>                     "The name %s is in use, please choose another\n" name
>                  readName
>               Just client ->
>                  restore (runClient server client)
>                    `finally` removeClient server name 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T01:53:25.967

您要确保每个成功`checkAddClient`都与`removeClient`. `finally`底部的语句仅保证`removeClient`在`runClient`动作开始时运行。

但是，在代码可以接收异步异常的结束`checkAddClient`和开始之间有一个简短的窗口。`runClient`如果是这样，`finally`将没有机会注册该`removeClient`命令。这就是西蒙所说的同步破解。

解决方案是默认屏蔽异步异常，只允许它们出现在某些地方（即由 包裹的动作`restore`）。这封住了上述裂缝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T04:27:15.817

如果`checkAddClient`这样做会怎样：

```
checkAddClient server name handle = do
  addClient server name handle
  return undefined 
```

在案例评估其参数之前不会触发异常，并且`removeClient`永远不会被调用。

但是，老实说，我不了解异步异常，所以这是对示例的疯狂猜测。

# c - OpenSSL 库的体系结构 i386 的未定义符号

> ID：14541916
> 
> 赞同：4
> 
> 时间：2013-01-26T21:48:05.923
> 
> 标签：c, openssl

我正在阅读这本书`Network Security with OpenSSL`，`Pravir Chandra, Matt Messier and John Viega`并尝试在书中使用 OpenSSL 的示例之后创建 SSL 客户端/服务器连接，但我收到此错误，我不知道为什么。

这是我的服务器：

```
#include <openssl/bio.h>
#include <openssl/err.h>
#include <openssl/rand.h>
#include <openssl/ssl.h>
#include <openssl/x509v3.h>

#include <pthread.h>

#define PORT            "6001"
#define SERVER          "splat.zork.org"
#define CLIENT          "shell.zork.org"

void handle_error(const char *file, int lineno, const char *msg)
{
    fprintf(stderr, "** %s:%i %s\n", file, lineno, msg);
    ERR_print_errors_fp(stderr);
    exit(-1);
}

void init_OpenSSL(void)
{
    if (!THREAD_setup() || !SSL_library_init())
    {
        fprintf(stderr, "** OpenSSL initialization failed!\n");
        exit(-1);
    }
    SSL_load_error_strings();
}

void do_server_loop(BIO *conn)
{
    int  done, err, nread;
    char buf[80];

    do
    {
        for (nread = 0;  nread < sizeof(buf);  nread += err)
        {
             err = BIO_read(conn, buf + nread, sizeof(buf) - nread);
             if (err <= 0)
                 break;
        }
        fwrite(buf, 1, nread, stdout);
    }
    while (err > 0);
}

void *server_thread(void *arg)
{
    BIO *client = (BIO *)arg;

    pthread_detach(pthread_self(  ));

    fprintf(stderr, "Connection opened.\n");
    do_server_loop(client);
    fprintf(stderr, "Connection closed.\n");

    BIO_free(client);
    ERR_remove_state(0);
}

int main(int argc, char *argv[])
{
    BIO *acc, *client;

    pthread_t tid;

    init_OpenSSL();

    acc = BIO_new_accept(PORT);
    if (!acc)
        handle_error(__FILE__, __LINE__, "Error creating server socket");

    if (BIO_do_accept(acc) <= 0)
        handle_error(__FILE__, __LINE__, "Error binding server socket");

    for (;;)
    {
        if (BIO_do_accept(acc) <= 0)
            handle_error(__FILE__, __LINE__, "Error accepting connection");

        client = BIO_pop(acc);
        pthread_create(&tid, NULL, server_thread, client);
    }

    BIO_free(acc);
    return 0;
} 
```

我正在使用 gcc 编译源代码：

```
$ gcc -o server server.c -lssl -crypto -lpthread -lm
Undefined symbols for architecture i386:
  "_ERR_print_errors_fp", referenced from:
      _handle_error in ccgAll3d.o
  "_THREAD_setup", referenced from:
      _init_OpenSSL in ccgAll3d.o
  "_BIO_read", referenced from:
      _do_server_loop in ccgAll3d.o
  "_BIO_free", referenced from:
      _server_thread in ccgAll3d.o
  "_ERR_remove_state", referenced from:
      _server_thread in ccgAll3d.o
  "_BIO_new_accept", referenced from:
      _main in ccgAll3d.o
  "_BIO_ctrl", referenced from:
      _main in ccgAll3d.o
  "_BIO_pop", referenced from:
      _main in ccgAll3d.o
ld: symbol(s) not found for architecture i386
collect2: ld returned 1 exit status 
```

谁能告诉我为什么会这样？

前段时间我得到了类似的东西，并通过定义有问题的函数来解决它，但这不再起作用了。

我正在 Mac OS X 10.6.8 上编译源代码。是因为我使用的是 32 位系统吗？

这是我正在编译的命令`gcc -Wall -lssl -crypto -lpthread -lm -o server server.c`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T21:57:22.357

你会更接近一点`gcc -o server sslserver.c -pthread -lssl`。

[本书的勘误表](http://oreilly.com/catalog/openssl/errata/openssl.confirmed)也告诉我们`SSL_init_library`应该是`SSL_library_init`.

剩下的唯一未定义的参考是“THREAD_setup”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:53:09.277

您似乎没有与 openssl 库链接。尝试添加

```
[..] -lssl [..] 
```

除了链接时的其他库。

您的 gcc 行似乎也不完整：

```
 gcc -o -lpthread -lm server.c 
```

`-o`参数后面应该跟一个输出文件名（在这种情况下，它将使用“-lpthread”作为文件名。

# javascript - 使用 google chrome 扩展在 facebook 帖子中添加一个额外的按钮

> ID：14541921
> 
> 赞同：0
> 
> 时间：2013-01-26T21:48:50.257
> 
> 标签：javascript, google-chrome-extension

我成功地跟踪了所有包含与每个 facebook 帖子（状态、图像等）相关联的链接的“uiStreamSource”，以便在日期旁边添加一个额外的按钮，以使用 google chrome 扩展程序执行一些其他任务。此按钮执行预定义的工作，在此上下文中不重要提及。

我写了这个内容脚本：

> 内容脚本.js

```
var nodeslist=document.getElementsByClassName("uiStreamSource");
alert(nodeslist.length); 
```

每次加载 facebook 页面时，警报都会显示 10 个检测到的类（即 10 个帖子）。但是当我向下滚动时，会出现新帖子，并且此代码无法检测到它们。由于我需要更新所有帖子中的所有 uiStreamSource 节点，我该如何解决这个问题？

**更新**

我在 contentscript.js 中尝试了这段代码：

```
load();
document.addEventListener("DOMNodeInsertedIntoDocument", load, false);

function load(){
    var nodeslist=document.getElementsByClassName("uiStreamSource");
    alert(nodeslist.length);
} 
```

第一次运行时，我得到了正确数量的当前节点（当前 facebook 帖子），但是一旦我向下滚动并获取更多帖子，就会显示警报，表明调用了加载函数，但打印的节点数为 0。这是为什么？

提前感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T04:56:22.933

您可以添加一个`DOMNodeInserted`事件并通过检查其类来检查要插入的元素是否是帖子。

或者一个简单的解决方案是使用[jcade](https://github.com/snesin/jcade)插件。当插入具有指定选择器的元素时，它可以调用回调函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T22:38:41.523

收听滚动事件并将任何新帖子添加到`nodeslist`. 您也可以使用 setInterval 来捕捉用户不滚动时添加的任何帖子。

# xcode4.5 - 腐败的故事板

> ID：14541922
> 
> 赞同：0
> 
> 时间：2013-01-26T21:48:59.243
> 
> 标签：xcode4.5, uistoryboard

在修改情节提要时，在 Xcode 4.5.2 中快乐地工作（尽可能多地快乐），Xcode 崩溃了。

好的，不用担心，Xcode 总是崩溃。重新启动它，我们被卡住了。我在 Xcode 中间找到了一个小微调器，它试图打开我打开的三个选项卡。但最终停止响应。

强制退出后，我注意到一个仍在运行的进程：

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/Library/Xcode/Overlays/Interface Builder Cocoa Touch Tool --socketFD 30 
```

我可以`sudo kill -9`随心所欲地处理这个过程，但是每次我在 Xcode 中打开这个项目时，都会重复执行。

使用`alt+shift+click`Dock 中的 Xcode 技巧，我可以打开一个空白实例并打开一个不同的项目。加载故事板视图或任何东西都没有问题。

我将问题追溯到我正在处理的一个 iPad 故事板。在进行谷歌研究后，我在另一个编辑器中打开了故事板并更改`useAutolayout="YES"`为`useAutolayout="NO"`，我能够在 Xcode 中很好地打开故事板......但我的对象都不在那里。

我可以继续夸夸其谈……但我真的希望你们中的一个人以前见过这个。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:11:25.143

这不是答案，但我有类似的经历。我注意到的一件事是，如果我手动编辑 Storyboard 以禁用 AutoLayout，UI 对象仍然在 Storyboard 中，只是高度/宽度为 0。不是很有帮助，因为您仍然几乎必须从头开始重新创建所有内容（或至少自上次保存的工作版本以来）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T14:23:48.940

由于一个讨厌的小错位表格单元，Xcode 在加载时崩溃了。我根本无法加载程序或导入情节提要，我在网上看到的每个解决方案都失败了。我所做的是删除故事板，打开项目，然后恢复最近的快照（总是拍摄快照！）。它导入了以前的故事板，我几乎没有丢失任何工作。

# django - Django 保存模型成语

> ID：14541932
> 
> 赞同：0
> 
> 时间：2013-01-26T21:50:18.367
> 
> 标签：django, django-models, idioms

假设您有一个 ActiveDirectoryUser 模型：

```
class ActiveDirectoryUser(models.Model):
    object_guid = models.CharField(max_length=200, unique=True)
    mail = models.EmailField(unique=True)
    name = models.CharField(max_length=200) 
```

此模型由 Active Directory 查询填充。每天，我都会重新运行一个查询 Active Directory 的作业，获取结果，并检查此人是否已经在 AD 中。如果是，则检查是否有任何更改，如果没有，则将它们添加到数据库中。我发现自己在写：

```
try:
    ad_user = ActiveDirectoryUser.objects.get(object_guid=object_guid)
    ad_user.object_guid = object_guid
    ad_user.mail = mail
    ad_user.name = name
    ad_user.save()

except ActiveDirectoryUser.DoesNotExist:
    ActiveDirectoryUser(
    object_guid=object_guid,
    mail=mail, 
    name=name).save() 
```

基本上，我尝试获取具有属性的对象，如果这引发了 DoesNotExist 异常，我知道它还不存在，所以我创建了一个新的。这是将新对象更新或保存到数据库中的正确/最佳/惯用方式吗？我知道它有效，但不知何故它看起来不对。不雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:03:34.813

不，django 有一个[内置的](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.get_or_create)方法来做到这一点。

```
entry, created = ActiveDirectory.objects.get_or_create(
    object_guid = 'your_value',
    name =  = 'your_value',
    mail = 'your_value'
) 
```

# webview - 来自 Javascript 的 WebView 回调

> ID：14541933
> 
> 赞同：6
> 
> 时间：2013-01-26T21:50:41.113
> 
> 标签：webview, javafx, javafx-2

我尝试创建一个简单的从 Javascript 到 Java 的回调示例，基于[WebEngine 的 javadoc 中的最后一个示例](http://docs.oracle.com/javafx/2/api/javafx/scene/web/WebEngine.html)（*Calling back to Java from JavaScript*）。但是当我点击WebView中的链接时，没有调用Java方法，页面消失了。

```
public class TestOnClick extends Application {

    @Override
    public void start(Stage stage) throws Exception {
        try {
            final WebView webView = new WebView();
            final WebEngine webEngine = webView.getEngine();

            Scene scene = new Scene(webView);

            stage.setScene(scene);
            stage.setWidth(1200);
            stage.setHeight(600);
            stage.show();

            String webPage = "<html>\n"
                    + "    <body>\n"
                    + "        <a href=\"\" onclick=\"app.onClick()\">Click here</a>\n"
                    + "    </body>\n"
                    + "</html>";

            System.out.println(webPage);

            webView.getEngine().loadContent(webPage);

            JSObject window = (JSObject) webEngine.executeScript("window");
            window.setMember("app", new JavaApp());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        launch(args);
    }

    public static class JavaApp {

        public void onClick() {
            System.out.println("Clicked");
        }
    }
} 
```

注意：在使用 `webView.getEngine().getLoadWorker().exceptionProperty().addListener(...)`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T01:15:47.320

您正在尝试在创建 webview DOM 模型之前访问它。

将您的相关代码包装`JavaApp`到页面加载侦听器以实现您的目标：

```
webEngine.getLoadWorker().stateProperty().addListener(new ChangeListener<Worker.State>() {
    @Override
    public void changed(ObservableValue<? extends State> ov, State t, State t1) {
        if (t1 == Worker.State.SUCCEEDED) {
            JSObject window = (JSObject) webEngine.executeScript("window");
            window.setMember("app", new JavaApp());
        }
    }
}); 
```

# ios - 检测按下哪个按钮来打开此视图

> ID：14541937
> 
> 赞同：0
> 
> 时间：2013-01-26T21:51:34.587
> 
> 标签：ios, cocoa

> **可能重复：**
> [在视图控制器之间传递变量](https://stackoverflow.com/questions/11577484/passing-variables-between-view-controllers)

假设我有 3 个按钮`ViewController(FirstController)`与 1-3 的标签相同。所有三个按钮都打开了一个新的`ViewController(SecondController)`. 但是我如何才能在 中`SecondController`检查按下了什么按钮才能到达这里，或者使用了什么 segue？因此，`SecondController`根据按下哪个按钮打开它，可以执行不同的操作。我可能在考虑开关和外壳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:37:32.010

有两种可能的方法来做到这一点。

一种方法是为每个按钮分配一个唯一的 segue。在`prepareForSegue:`您识别按钮并将该信息提供给的方法上`destinationViewController`：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Button1Segue"]) {
        [segue.destinationViewController setButton:1];
    }

    if ([segue.identifier isEqualToString:@"Button2Segue"]) {
    ...
} 
```

* * *

另一种方法是创建一个`property`存储最后按下按钮的位置。

```
- (IBAction)buttonTap:(id)sender {

    self.lastPressedButton = sender.tag;
} 
```

你会这样做`prepareForSegue:`：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"SecondControllerSegue"]) {
        [segue.destinationViewController setButton: self.lastPressedButton];
    }
} 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T21:57:20.470

```
if (button.tag == 0) {
   NSLog(@"Button one.");
} else if (button.tag == 1) {
   NSLog(@"Button two.");
} 
```

您可以在三个按钮操作之前发生的方法中放入类似的内容。这可能是 viewWillDisappear、prepareForSegue 等。

祝你好运！

# java - 将点击功能添加到所有应用程序li stview android

> ID：14541938
> 
> 赞同：1
> 
> 时间：2013-01-26T21:51:39.100
> 
> 标签：java, android, listview, android-listview

我制作了一个应用程序，我可以在列表视图中查看我的所有应用程序，效果非常好。但是，我无法单击它，因为我还没有为其添加功能，如何将单击功能添加到列表视图？这是我的代码：

Java代码：

```
public class AllAppsActivity extends ListActivity {
LinearLayout appsLinearLayout;
ListView list;
Intent intent;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.allapps_screen);

    //Import views
    appsLinearLayout = (LinearLayout)findViewById(R.id.appsLinearLayout);

    //Set wallpaper
    appsLinearLayout.setBackgroundResource(R.drawable.images);

    //Load all apps
    final PackageManager pm = this.getPackageManager();

    intent = new Intent(Intent.ACTION_MAIN, null);
    intent.addCategory(Intent.CATEGORY_LAUNCHER);

    final ArrayList<ResolveInfo> list =
            (ArrayList<ResolveInfo>) pm.queryIntentActivities(intent, 
                    PackageManager.PERMISSION_GRANTED);
    for (ResolveInfo rInfo : list)
    {

        Log.i("TAG", ": Installed Applications " + rInfo.activityInfo.
                applicationInfo.loadLabel(pm).toString());
    }

    final ArrayAdapter<ResolveInfo> adapter = 
        new ArrayAdapter<ResolveInfo>(this, android.R.layout.simple_list_item_1, list)
        {
            @Override
            public View getView(int position, View convertView, ViewGroup parent)
            {
                convertView = super.getView(position, convertView, parent);
                final String text = list.get(position).activityInfo.
                    applicationInfo.loadLabel(pm).toString();
                ((TextView)convertView).setText(text);
                return convertView;
            }
        };
    setListAdapter(adapter);
}
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T22:21:36.230

将您的`ArrayList<ResolveInfo> list`（不要与您的另一个变量混淆`ListView list`）作为字段并在`onListItemClick`-method 中使用它：

```
private ArrayList<ResolveInfo> mApplicationList;

@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    mApplicationList = (ArrayList<ResolveInfo>) pm.queryIntentActivities(intent, PackageManager.PERMISSION_GRANTED);
    ...
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    final Intent intent = new Intent(Intent.ACTION_MAIN);
    final ActivityInfo info = mApplicationList.get(position).activityInfo;
    intent.setClassName(info.packageName, info.name);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
    startActivity(intent);
} 
```

# c - fread() 是否在完成读取文件后推进指针？

> ID：14541940
> 
> 赞同：2
> 
> 时间：2013-01-26T21:51:51.597
> 
> 标签：c, file-handling

我正在尝试从 C 中的文件中读取，并且在我完成阅读后想要写入同一个文件。我正在尝试为此使用 fread() 。有谁知道 fread 在遇到“\0”后是否推进指针？我的意思是在我完成阅读后，我需要推进指针还是需要立即开始使用 fwrite 写入文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T23:14:47.873

`fread`将推进文件位置（而不是指针），直到它击中`EOF`.

但是，它不会仅仅因为遇到`'\0'`. 事实上， even`fgets`只会在遇到`\n`. 我所知道的没有标准库函数会停止在`'\0'`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T23:11:01.417

是的，它确实会推进指针，除非您遇到 EOF 或遇到错误：

> 返回值
> fread() 和 fwrite() 函数将流的文件位置指示符提前读取或写入的字节数。它们返回读取或写入的对象数。如果发生错误或到达文件结尾，则返回值是一个短对象计数（或零）。

# c++ - C++中函数调用后花括号的含义

> ID：14541942
> 
> 赞同：3
> 
> 时间：2013-01-26T21:52:03.357
> 
> 标签：c++, syntax

我正在阅读一篇关于 Doom 3 源代码代码质量的博客文章，但我被困在一段我无法理解的 C++ 代码上。我应该说我不是 C++ 程序员。

有问题的代码如下所示：

```
Sys_StartAsyncThread(){                          // The next look runs is a separate thread.
    while ( 1 ){
        usleep( 16666 );                         // Run at 60Hz
        common->Async();                         // Do the job
        Sys_TriggerEvent( TRIGGER_EVENT_ONE );   // Unlock other thread waiting for inputs
        pthread_testcancel();                    // Check if we have been cancelled by the main thread (on shutdown).
    }
} 
```

（取自[http://fabiensanglard.net/doom3/index.php](http://fabiensanglard.net/doom3/index.php)，在“展开循环”主题下）

这在我看来是一个作为参数传递给返回值的闭包`Sys_StartAsyncThread()`- 但据我所知，这在 C++ 中是不可能的，而且也是`Sys_StartAsyncThread()`void 类型，所以这里发生了什么？

的定义`Sys_StartAsyncThread()`可以在[这里](https://dev.visucore.com/doom3/doxygen/win__main_8cpp_source.html#l00912)找到。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T21:55:27.590

它看起来像一个错字。按照[这里](http://fabiensanglard.net/doom3/doom3_unrolled.php)，后面应该有分号`Sys_StartAsyncThread();`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T04:49:47.557

正如人们所提到的，这只是我用来为每个方法的内容排序的符号：展开循环和方法。

在示例中，您提供的大括号之间的块实际上是方法的内容

> Sys_StartAsyncThread

跳

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-26T21:56:24.753

这只是一个错字。正确的代码是

```
Sys_StartAsyncThread();
    {
        // Create a thread that will block on hTimer in order to run at 60Hz (every 16 milliseconds).
        // The Thread calls common->Async over and over for Sound mixing and input generation.

        while ( 1 )
        {
            usleep( 16666 );
            common->Async();
            Sys_TriggerEvent( TRIGGER_EVENT_ONE );
            pthread_testcancel();
        }
    } 
```

您可以在此处查看[http://fabiensanglard.net/doom3/doom3_unrolled.php](http://fabiensanglard.net/doom3/doom3_unrolled.php)，如您所引用的页面中所述。

> 有关更多详细信息，这里是我在阅读代码时用作地图的完全展开的循环。

# android - 在 FriendPicker（Android 版 Facebook SDK）中将所选用户标记为已选中

> ID：14541945
> 
> 赞同：6
> 
> 时间：2013-01-26T21:52:24.887
> 
> 标签：android, facebook, sdk, picker

我已经完成了[Android 版 Facebook SDK](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)的教程（尤其是[“Show Friends”-tutorial](http://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/show-friends/)）。

当我再次单击“显示朋友”按钮时，如何标记我之前在 PickerActivity 中选择的选定用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T20:46:22.383

我查看了 Facebook SDK 的源代码，在我看来，`PickerFragment`您似乎无法重新选择以前选择的项目。由于 Facebook SDK 是在 Apache License 2.0 下发布的，并且您可以访问完整的源代码，我想您可以尝试以`PickerFragment`具有必要方法的方式进行修改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T05:57:10.087

您必须将包中带有选定 facebook 用户 ID 的逗号分隔字符串传递给 FriendPickerFragment。

```
Bundle args = new Bundle();
args.putString("com.facebook.android.PickerFragment.Selection", "11111, 2222, 333, already selected facebook ids....");
friendPickerFragment = new FriendPickerFragment(args); 
```

在 PickerFragment 的 onActivityCreated() 中，它将解析所选 id 显示为在列表中选择。您可以在 FacebookSDK 的 PickerFragment 中看到以下代码。

```
selectionStrategy.readSelectionFromBundle(savedInstanceState, SELECTION_BUNDLE_KEY); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-06T01:06:04.407

这是一个对我有用的解决方案。我扩展了一个标准的 FriendPickerFragment。

```
public class FriendPickerFragment2 extends FriendPickerFragment {

SelectionStrategy selectionStrategy;
String mPreSelectedIDs;

public FriendPickerFragment2(Bundle args)
{
    super(args);
}

@Override
SelectionStrategy createSelectionStrategy() {
    selectionStrategy = getMultiSelect() ? new MultiSelectionStrategy() : new SingleSelectionStrategy();
    return selectionStrategy;
}

public void showInitialSelection()
{
    Bundle bundle = new Bundle();
    bundle.putString(this.MULTI_SELECT_BUNDLE_KEY, mPreSelectedIDs);
    selectionStrategy.readSelectionFromBundle(bundle, this.MULTI_SELECT_BUNDLE_KEY);
    adapter.notifyDataSetChanged();
}

public void setInitialSelection(String IDs)
{
    mPreSelectedIDs = IDs;
} 
```

}

我将 FriendPickerFragment2 用作普通的 FriendPickerFragment。在 OnCreate 我执行以下操作：

```
 FragmentManager fm = getSupportFragmentManager();

    if (savedInstanceState == null) {
        final Bundle args = getIntent().getExtras();
        friendPickerFragment = new FriendPickerFragment2(args);
        friendPickerFragment.setInitialSelection(pickedUsersString());

        fm.beginTransaction()
                .add(R.id.friend_picker_fragment, friendPickerFragment)
                .commit();
    } else {
        friendPickerFragment = (FriendPickerFragment2) fm.findFragmentById(R.id.friend_picker_fragment);
    } 
```

这里pickUsersString 是一个逗号分隔的ID 字符串。

最后一点是在 OnStart 中添加一行：

```
protected void onStart() {
    super.onStart();
    try {

        friendPickerFragment.loadData(false);
        friendPickerFragment.showInitialSelection();
    } catch (Exception ex) {
        onError(ex);
    }
} 
```

这个解决方案对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-04T09:21:41.830

好消息。在当前的 SDK 版本 (3.6) 中，添加了以下功能：

> *   在 FriendPickerFragment 上添加了 setSelection 方法以允许预选朋友。
> *   在 Friend Picker Sample 中添加了 setSelection API 的使用示例

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-29T17:50:08.810

FriendPickerFragment 有这个方法：

```
/**
 * Sets the list of friends for pre selection. These friends will be selected by default.
 * @param userIds list of friends as ids
 */
public void setSelectionByIds(List<String> userIds) {
    preSelectedFriendIds.addAll(userIds);
} 
```

而这个方法：

```
public void setSelection(List<GraphUser> graphUsers) {
    List<String> userIds = new ArrayList<String>();
    for(GraphUser graphUser: graphUsers) {
        userIds.add(graphUser.getId());
    }
    setSelectionByIds(userIds);
} 
```

您应该在片段实例化后立即调用这些方法之一：

```
 friendPickerFragment = new FriendPickerFragment(args);
    friendPickerFragment.setSelectionByIds(fbIDs); 
```

# jquery - 如何禁用由 jquery 的另一个链接创建的链接（包括 jsfiddle）

> ID：14541946
> 
> 赞同：0
> 
> 时间：2013-01-26T21:52:38.363
> 
> 标签：jquery, hyperlink

单击它时我有一个链接，它会在其中创建一个带有另一个链接的 div 我想禁用新链接尝试了许多解决方案，例如 preventDefault 并返回 false 但没有用，这是示例[http://jsfiddle.net/2RSJj/1 /](http://jsfiddle.net/2RSJj/1/) :

```
$(document).ready(function(){
$("a[title='go']").click(function(e){
    $(".cities").append("<div class='city'><a href='http://www.google.com' class='mylink'>google</aiv>"); 
    e.preventDefault();
});

$(".cities .city a").click(function(e){
    e.preventDefault();
    alert($(this).attr("class"));
});

}); 
```

主要的html：

```
<a href="#" title="go">go</a><p>
<div class="cities">

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:59:25.367

由于链接是动态添加的，您应该使用该`on()`方法（假设 jQuery >= 1.7; jQuery < 1.7 应该使用`delegate()`）来防止所述链接的默认操作：

```
$('.cities').on('click', 'a.mylink', function(e){
    e.preventDefault();
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2RSJj/3/)。

您遇到的问题是发生事件绑定时链接不存在，因此该`click()`方法不会将`click`事件绑定到相关`a`元素。使用`on()`，`click`附加到父/祖先元素（存在于事件绑定点），然后侦听该事件（`'click'`第一个参数中的字符串）在与选择器匹配的元素上触发（作为传递第二个论点）。

假设事件和选择器都匹配（`a.mylink`元素是`click`-ed），则执行该函数，在这种情况下，这只是防止触发默认操作。但是，重要的是要注意，对于委托事件，您*不能*简单地`return false`，因为根据定义，事件在传播/冒泡到事件绑定到的祖先元素时已经被触发。

此外，如果两个元素之间的元素具有显式实现的事件处理程序，`return false`则事件委托将不会经过该元素（因为`click`将传播/冒泡到具有处理程序的元素，该处理程序将响应`return false`（组合`event.stopPropagation()`和`event.preventDefault()`）。

例如，在以下代码中，我使用的是`html`：

```
<a href="#" title="go">go</a><p>
<div class="cities">
    <div class="demo">
    </div>
</div> 
```

在这种情况下，该`on()`方法仍然附加到`.cities`元素，但`.demo`元素有一个点击处理程序，正如您可能想象的那样，它简单地返回`false`：

```
$("a[title='go']").click(function(e){
    $(".demo").append("<div class='city'><a href='http://www.google.com' class='mylink'>google</a></div>"); 
    e.preventDefault();
});

$('.cities').on('click', 'a.mylink', function(e){
    e.preventDefault();
    // using an alert because a simple 'e.preventDefault()` wouldn't
    // be visibly different to the 'return false'
    alert(e.type + ' event reached the ".cities" element!');
});

$('.demo').click(function(e){
    return false;
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2RSJj/5/)。

在上面的注释中，单击`a.mylink`元素时不会触发警报，而如果没有`click`-handler 拦截（和否定）`click`事件，`alert()` *则会*触发：

```
$("a[title='go']").click(function(e){
    $(".demo").append("<div class='city'><a href='http://www.google.com' class='mylink'>google</a></div>"); 
    e.preventDefault();
});

$('.cities').on('click', 'a.mylink', function(e){
    e.preventDefault();
    alert(e.type + ' event reached the ".cities" element!');
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/2RSJj/6/)。

因此，在使用委托时，请注意那些绑定到您的元素的事件。*开始时可能*会很棘手（ish）。

参考：

*   [`delegate()`](http://api.jquery.com/delegate/).
*   [`on()`](http://api.jquery.com/on/).

# java - Java中的ArrayList添加/删除回调

> ID：14541948
> 
> 赞同：0
> 
> 时间：2013-01-26T21:52:58.630
> 
> 标签：java, arraylist, callback

是否可以创建回调函数 ArrayList 添加/删除方法。

ArrayList 将包含图像 url，我想在添加/删除新元素后立即运行我的代码（更新 UI）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T21:58:36.540

将列表封装在您自己的对象中，并在将元素添加到列表之前或之后做任何您想做的事情：

```
public class UrlContainer {

    private List<String> urls = new ArrayList<String>();

    public void add(String url) {
        doSomething();
        urls.add(url);
        doSomethingElse();
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T21:59:25.173

你想要的是一个装饰器。你扩展了 ArrayList 但你也实现了接口，所以你基本上是伪装成一个实例，你是在增强核心行为，或者装饰它。

[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T22:07:58.283

看看[Glazed Lists](http://www.glazedlists.com/)。您可以创建一个 EventList 并监听添加/删除事件。

（是的，他们在内部使用代表......）

# c# - 无法在 mvc4 项目中添加“公共”区域

> ID：14541952
> 
> 赞同：2
> 
> 时间：2013-01-26T21:53:25.370
> 
> 标签：c#, asp.net-mvc-4, area

我的问题很简单。当我尝试`Public`在我的 MVC4 项目中添加一个区域时，该区域的名称被替换为`_Public`. 有人知道为什么吗？我在 MVC4 发行说明中没有找到任何关于此的内容。

它适用于 MVC3 项目。

编辑：截图

![在此处输入图像描述](../Images/b2d4b6aafcc26b11049248b2776fa485.png) ![在此处输入图像描述](../Images/6bd18f650a673278175df3e40d89dd1d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T15:28:23.620

我只能想象它与`public`保留字有关。我不怀疑它在 MVC3 中运行良好，但是可能在某个地方有一些错误报告，它们最终保护了你免受自己的伤害。

# string - 使用特定分隔符解析文档中的单词

> ID：14541958
> 
> 赞同：0
> 
> 时间：2013-01-26T21:54:08.220
> 
> 标签：string, delimiter, text-parsing

我有一个要从中解析单词的文档，但我想将除 az、AZ、0-9 或撇号之外的任何内容视为空白。如果我之前使用以下代码，我该怎么做：

```
ifstream file;
file.open(filePath);

while(file >> word){
    listOfWords.push_back(word); // I want to make sure only words with the stated 
                                 // range of characters exist in my list.
} 
```

因此，例如，单词 hor.se 将是我列表中的两个元素，“hor”和“se”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T03:05:46.233

创建一个“空白字符”列表，然后每次遇到一个字符时，检查该字符是否在列表中，如果是，则您已经开始了一个新单词。这个例子是用python写的，但是概念是一样的。

```
def get_words(whitespace_chars, string):
    words = []
    current_word = ""
    for x in range(0, len(string)):
        #check to see if we hit the end of a word.                                                                                                                                                                                           
        if(string[x] in whitespace_chars and current_word != ""):
            words.append(current_word)
            current_word = ""
        #add current letter to current word.                                                                                     
        else:
            current_word += string[x]
    #if the last letter isnt whitespace then the last word wont be added, so add here.                                                                                                                                                       
    if(current_word != ""):
        words.append(current_word)
    return words 
```

回话

# r - data.table := 在 R 中的表达式语法

> ID：14541959
> 
> 赞同：4
> 
> 时间：2013-01-26T21:54:09.967
> 
> 标签：r, expression, eval, data.table

`eval`我在`data.table`R 中使用表达式时遇到了一些麻烦。这是一些代码：

```
dtb = data.table(a=1:100, b=100:1, id=1:10)
dtb[,`:=`(c=a+b, d=a/b),by=id] #this works fine
expr = expression({`:=`(c=a+b, d=a/b)}) #try to couch everything in an expression
dtb[,eval(expr),by=id] #this does not work
Error in `:=`(c = a + b, d = a/b) : 
   unused argument(s) (c = a + b, d = a/b)

expr = expression(`:=`(c=a+b, d=a/b)) #this works fine
dtb[,eval(expr),by=id] 
```

为什么包括`{}`打破这个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T22:50:48.743

参见 的定义`:=`：

```
function (LHS, RHS) 
stop(":= is defined for use in j only, and (currently) only once; i.e., DT[i,col:=1L] and DT[,newcol:=sum(colB),by=colA] are ok, but not DT[i,col]:=1L, not DT[i]$col:=1L and not DT[,{newcol1:=1L;newcol2:=2L}]. Please see help(\":=\"). Check is.data.table(DT) is TRUE.") 
```

列的分配不会发生在调用`:=`-- 函数本身除了产生错误之外不做任何事情。当`[.data.table`检测`j`是表单的表达式时，分配发生``:=`(...)`，然后设置所有内容以调用 C 代码。当你`expr`用括号括起来时，你正在制作表达式的第一部分`{`而不是`:=`，它通过上述检测并最终导致对`:=`with arguments`c`和的评估`d`。

我想这导致了一个问题，为什么你需要把它附在里面`{ }`？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-08T14:26:29.910

在 v1.8.11 中已经实现了[问题 #376](https://github.com/Rdatatable/data.table/issues/376)以捕获`{`周围。`:=`来自[新闻](https://github.com/Rdatatable/data.table/blob/master/NEWS.md)：

> o 现在实施 FR #2496 以捕获和移除`{`周围`:=`以`j`获得所需的结果。现在，`DT[,{`:=`(...)}]`两者`DT[, {`:=`(...)}, by=(...)]`都按预期工作，但带有警告。感谢 Alex 报告 SO：[R 中 data.table := 的表达式语法](https://stackoverflow.com/questions/14541959/expression-syntax-for-data-table-in-r)

# php - 在 PHP 中解析亚马逊详细信息页面

> ID：14541960
> 
> 赞同：0
> 
> 时间：2013-01-26T21:54:09.703
> 
> 标签：php, curl, html-parsing, amazon

因此，我正在寻找一种解决方案来解析详细信息页面，例如[http://www.amazon.com/Code-Cloud-Pragmatic-Programmers-Chu-Carroll/dp/1934356638/ref=sr_1_1?ie=UTF8&qid= 1359231803&sr=8-1&keywords=code+in+the+cloud](https://rads.stackoverflow.com/amzn/click/com/1934356638)但我无法从页面中获取正确的内容。

我已经检查了元素并通过“btAsinTitle”的名称找到并标识了该名称应该从该 Amazon.com 产品详细信息页面中获取标题，但显然，PHP 中没有出现任何内容。除此之外，我还发现它不是通过外部资源加载的，比如从 Amazon.com 端的外部资源拉入的 JavaScript（不过，我并不完全 100% 确定）。我所做的是查看已加载的文档，并且似乎已在我上面提供的确切 URL 上加载了一个文档，其中包含我正在寻找的正确“btAsinTitle”ID。

这真的是我解析细节的小任务的第一步。我还需要一些其他标准，包括作者、价格、可用性（产品是否有库存）。下面是我目前正在尝试运行的代码段。

另外，对于这个问题还有一个额外的好奇，有哪些技术可以用来防止抓取，亚马逊是否有可能阻止他们的产品页面被抓取？除此之外，我也知道我可以使用 API，但我试图在不使用 API 的情况下遵守分配规则，并且还为分配注册了 API 密钥。提前致谢！

```
class AmazonBook {
protected $doc;

public $url;
public $title;
public $author;
public $price;
public $availability;

public function __construct($url) {
    $this->url = $url;

    $this->set_dom();
    // $this->set_availability();
    // $this->set_price();
    // $this->set_author();
    $this->set_title();
}

// Sets the title
protected function set_title() {
    var_dump($this->doc->getElementById('btAsinTitle'));
    die();

    // foreach ($this->doc->getElementsByTagName('span') as $span) {
    //  var_dump($span->nodeValue);
    // }
    // die();
}

// Sets the DOM
protected function set_dom() {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $this->url);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/6.0 (Windows NT 6.2; WOW64; rv:16.0.1) Gecko/20121011 Firefox/16.0.1');

    $this->doc = new DOMDocument();
    @$this->doc->loadHTML(curl_exec($ch));
}
}

// Test code
$url = 'http://www.amazon.com/s/ref=nb_sb_noss?url=search-alias%3Daps&field-keywords=code%20in%20the%20cloud';
$code_in_cloud = new AmazonBook($url); 
```

# java - 未来和承诺有什么区别？

> ID：14541975
> 
> 赞同：331
> 
> 时间：2013-01-26T21:56:22.403
> 
> 标签：java, concurrency, future, promise

`Future`和有什么区别`Promise`？
它们都充当未来结果的占位符，但主要区别在哪里？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2015-03-02T23:01:02.920

（到目前为止，我对答案并不完全满意，所以这是我的尝试......）

我认为 [凯文赖特的评论](https://stackoverflow.com/questions/14541975/whats-the-difference-between-a-future-and-a-promise#comment32511183_14541975)

> 你可以做出一个承诺，并由你来遵守它。当别人给你一个承诺时，你必须等待，看看他们是否在未来兑现它

总结得很好，但一些解释可能很有用。

[Futures 和 Promise](http://en.wikipedia.org/wiki/Futures_and_promises)是非常相似的概念，不同之处在于 Future 是一个只读容器，用于存储尚不存在的结果，而 Promise 可以写入（通常只写一次）。Java 8 [CompletableFuture](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)和 Guava [SettableFuture](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/util/concurrent/SettableFuture.html)可以被认为是 Promise，因为它们的值可以设置（“完成”），但它们也实现了 Future 接口，因此对于客户端没有区别。

未来的结果将由“其他人”设置 - 由异步计算的结果。注意[FutureTask](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html) - 一个经典的未来 -*必须*使用 Callable 或 Runnable 进行初始化，没有无参数的构造函数，Future 和 FutureTask 从外部都是只读的（FutureTask 的 set 方法受到保护）。该值将设置为从内部计算的结果。

另一方面，promise 的结果可以由“你”（或者实际上任何人）随时设置，因为它有一个公共的 setter 方法。CompletableFuture 和 SettableFuture 都可以在没有任何任务的情况下创建，并且可以随时设置它们的值。您向客户端代码发送一个承诺，并在以后如您所愿地履行它。

注意 CompletableFuture 不是一个“纯粹的”promise，它可以像 FutureTask 一样用任务初始化，它最有用的特性是处理步骤的不相关链接。

另请注意，promise 不必是 future 的子类型，也不必是同一个对象。在 Scala 中，Future 对象由异步计算或*不同*的Promise 对象创建。在 C++ 中情况类似：promise 对象由生产者使用，future 对象由消费者使用。这种分离的好处是客户端无法设置未来的价值。

[Spring](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/scheduling/annotation/AsyncResult.html)和[EJB 3.1](http://docs.oracle.com/javaee/7/api/javax/ejb/AsyncResult.html?is-external=true)都有一个 AsyncResult 类，它类似于 Scala/C++ 承诺。AsyncResult 确实实现了 Future 但这不是真正的未来：Spring/EJB 中的异步方法通过一些背景魔法返回一个不同的只读 Future 对象，客户端可以使用第二个“真实”未来来访问结果。

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2013-01-26T22:07:05.373

根据[这个讨论](http://cs.oswego.edu/pipermail/concurrency-interest/2012-December/010423.html)，`Promise`终于被要求`CompletableFuture`包含在 Java 8 中，[它的 javadoc](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)解释说：

> 可以显式完成的 Future（设置其值和状态），并且可以用作 CompletionStage，支持在其完成时触发的相关函数和操作。

列表中还给出了一个示例：

```
f.then((s -> aStringFunction(s)).thenAsync(s -> ...); 
```

请注意，最终的 API 略有不同，但允许类似的异步执行：

```
CompletableFuture<String> f = ...;
f.thenApply(this::modifyString).thenAccept(System.out::println); 
```

* * *

## 回答 #3

> 赞同：145
> 
> 时间：2015-01-06T07:17:09.553

我知道已经有一个可以接受的答案，但还是想加两分钱：

TLDR：Future 和 Promise 是异步操作的两个方面：**消费者/调用者**与**生产者/实现**者。

作为异步 API 方法的**调用者**，您将获得 a**`Future`**作为计算结果的句柄。例如，您可以调用`get()`它来等待计算完成并检索结果。

现在想想这个 API 方法是如何实际实现的：**实现**者必须立即返回 a `Future`。他们负责在计算完成后立即完成那个未来（他们会知道，因为它正在实现调度逻辑;-)）。他们将使用**`Promise`**/**`CompletableFuture`**来做到这一点：构造并立即返回，并在计算完成后`CompletableFuture`调用。`complete(T result)`

* * *

## 回答 #4

> 赞同：109
> 
> 时间：2017-02-01T05:55:24.970

我将举例说明什么是 Promise 以及如何在任何时候设置它的值，与 Future 相反，它的值是只读的。

假设你有一个妈妈，你向她要钱。

```
// Now , you trick your mom into creating you a promise of eventual
// donation, she gives you that promise object, but she is not really
// in rush to fulfill it yet:
Supplier<Integer> momsPurse = ()-> {

        try {
            Thread.sleep(1000);//mom is busy
        } catch (InterruptedException e) {
            ;
        }

        return 100;

    };

ExecutorService ex = Executors.newFixedThreadPool(10);

CompletableFuture<Integer> promise =  
CompletableFuture.supplyAsync(momsPurse, ex);

// You are happy, you run to thank you your mom:
promise.thenAccept(u->System.out.println("Thank you mom for $" + u ));

// But your father interferes and generally aborts mom's plans and 
// completes the promise (sets its value!) with far lesser contribution,
// as fathers do, very resolutely, while mom is slowly opening her purse 
// (remember the Thread.sleep(...)) :
promise.complete(10); 
```

的输出是：

```
Thank you mom for $10 
```

妈妈的承诺已创建，但等待一些“完成”事件。

```
CompletableFuture<Integer> promise... 
```

您创建了这样的活动，接受了她的承诺并宣布了您感谢妈妈的计划：

```
promise.thenAccept... 
```

这时妈妈开始打开她的钱包……但是很慢……

父亲干预得更快，代替你妈妈完成了承诺：

```
promise.complete(10); 
```

你有没有注意到我明确写的一个执行者？

有趣的是，如果您使用默认的隐式执行程序 (commonPool) 并且父亲不在家，而只有妈妈带着她的“慢钱包”，那么她的承诺只会完成，如果程序的寿命超过妈妈需要从钱包。

默认执行器的行为有点像“守护进程”，不会等待所有承诺都被履行。我还没有找到一个很好的描述这个事实......

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-05-27T07:37:52.920

不确定这是否可以成为答案，但正如我看到其他人对某人所说的那样，您可能需要对这两个概念进行两个单独的抽象，以便其中一个（`Future`）只是另一个的只读视图（`Promise`) ...但实际上这不是必需的。

例如看一下如何在 javascript 中定义 Promise：

[https://promisesaplus.com/](https://promisesaplus.com/)

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)

重点是使用以下`then`方法的可组合性：

```
asyncOp1()
.then(function(op1Result){
  // do something
  return asyncOp2();
})
.then(function(op2Result){
  // do something more
  return asyncOp3();
})
.then(function(op3Result){
  // do something even more
  return syncOp4(op3Result);
})
...
.then(function(result){
  console.log(result);
})
.catch(function(error){
  console.log(error);
}) 
```

这使得异步计算看起来像同步：

```
try {
  op1Result = syncOp1();
  // do something
  op1Result = syncOp2();
  // do something more
  op3Result = syncOp3();
  // do something even more
  syncOp4(op3Result);
  ...
  console.log(result);
} catch(error) {
  console.log(error);
} 
```

这很酷。（不像*async-await*那样酷，但*async-await*只是删除了样板文件*....then(function(result) {....* )。

实际上，它们的抽象作为 promise 构造函数非常好

```
new Promise( function(resolve, reject) { /* do it */ } ); 
```

允许您提供两个回调，可用于`Promise`成功完成或出错。这样只有构造 的代码`Promise`才能完成它并且接收已经构造的`Promise`对象的代码具有只读视图。

*如果resolve*和*reject*是受保护的方法，则可以通过继承实现上述目标。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-11-25T18:10:38.113

对于客户端代码，Promise 用于在结果可用时观察或附加回调，而 Future 是等待结果然后继续。理论上任何可以用期货做的事情都可以用 Promise 做，但是由于风格的不同，不同语言的 Promise 的 API 使得链接更容易。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-06T17:33:43.893

Future接口中没有set方法，只有get方法，所以是只读的。关于 CompletableFuture，这篇文章可能会有所帮助。 [可完成的未来](http://www.deadcoderising.com/java8-writing-asynchronous-code-with-completablefuture/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-02-06T21:58:53.500

`Future`并且`Promise`是未知结果的代理对象

`Promise`完成一个`Future`

*   `Promise`- 未知结果的编写/生产者。
*   `Future`- 读取/使用未知结果。它有下一个状态：待处理、已完成、已取消

```
//Future has a reference to Promise
Future -> Promise 
```

作为`producer`我的`promise`某事并为此负责

作为一个`consumer`检索到 a`promise`我希望在`future`. 在`future`我可以使用`promise`或拒绝它

至于Java `CompletableFutures`，它是`Promise`因为你可以设置结果并且它也实现了`Future`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-02T12:51:37.493

在[这个示例](https://activej.io/promise)中，您可以了解如何在 Java 中使用 Promises 来创建异步调用序列：

```
doSomeProcess()
    .whenResult(result -> System.out.println(String.format("Result of some process is '%s'", result)))
    .whenException(e -> System.out.println(String.format("Exception after some process is '%s'", e.getMessage())))
    .map(String::toLowerCase)
    .mapEx((result, e) -> e == null ? String.format("The mapped result is '%s'", result) : e.getMessage())
    .whenResult(s -> System.out.println(s)); 
```

# powershell - Powershell 更换周期

> ID：14541980
> 
> 赞同：2
> 
> 时间：2013-01-26T21:57:06.543
> 
> 标签：powershell, powershell-2.0

谁能告诉我他们是否认为这个 Powershell 脚本有问题。

```
Dir | 
where {$_.extension -eq ".txt"} | 
Rename-Item –NewName { $_.name –replace “.“,”-” } 
```

对于当前目录中的每个文本文件，我试图用连字符替换文件名中的所有句点。提前谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T22:43:53.097

正如其他人所说，`-replace`使用正则表达式（并且“。”是正则表达式中的特殊字符）。但是，他们的解决方案忘记了文件扩展名，并且正在将其删除。前任。“test.txt”变成“test-txt”（无扩展名）。更好的解决方案是：

```
dir -Filter *.txt | Rename-Item -NewName { $_.BaseName.replace(".","-") + $_.Extension } 
```

这也使用 -Filter 仅挑选以“.txt”结尾的文件，这比 where 更快。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-26T22:02:16.923

-replace 对正则表达式进行操作，您需要转义“。”：

```
rename-item -NewName { $_.Name -replace '\.', '-' } 
```

否则你最终会得到'----'名字......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T22:09:40.110

powershell 中文件对象的 name 属性是字符串类型。
这意味着，您也可以使用`replace`如下静态字符串方法，而不关心正则表达式的保留字符：

```
dir | ? { $_.extension -eq ".txt" } | rename-item -newname { $_.name.replace(".","-") } 
```

# java - Java - 当它与播放器碰撞时从数组中删除对象

> ID：14541984
> 
> 赞同：0
> 
> 时间：2013-01-26T21:57:21.670
> 
> 标签：java

我正在用java开发一个落块游戏，你必须在屏幕上移动玩家来躲避块。每当你被一个方块击中时，根据方块的类型，它会减少或增加玩家类中的 int。我遇到的问题是，当玩家被方块击中时，int 会不断下降，直到现在不可见的方块离开屏幕。基本上我只需要一种方法来检查对象数组，当对象满足指定条件（例如（delete == true））时，它将将该块在数组中的当前位置设置为空。

块位置更新方法：

```
public void dropFoods(int speed) {
    for (int x = 699 - speed; x >= 0; x--) {
        for (int y = 0; y < 7; y++) {
            if(x > (699 - GUI.HEIGHT) - 10) {
                food[y][x] = null;
                continue;
            }
            food[y][x + speed] = food[y][x];
            food[y][x] = null;

        }
    }
} 
```

积木的绘制方法（食物是不同类型的积木）：

```
for(int x = 0; x < food.length; x++) {
            for(int y = 0; y < food[x].length; y ++) {
                Object o = food[x][y];
                if(o instanceof Apple) {
                    new Apple(x * 100, y - Apple.HEIGHT, g);            
                }
                if(o instanceof Burger) {
                    new Burger(x * 100, y - Burger.HEIGHT, g);          
                }
            }
} 
```

检测与玩家碰撞的方法：

```
if(Food.getHitBox().intersects(Player.hitBox())) {
        willDraw = false;
        Player.weight -= 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T22:20:26.063

您应该首先提供更多代码和调试结果。

```
if(Food.getHitBox().intersects(Player.hitBox())) {
        willDraw = false;
        Player.weight -= 1;
} 
```

所以当玩家击中某物时，你会从地图上移除 Food 对象吗？因为根据这段代码，你不是。

# javascript - JavaScript 中的 GEDCOM 解析器

> ID：14541988
> 
> 赞同：8
> 
> 时间：2013-01-26T21:57:35.237
> 
> 标签：javascript, parsing, genealogy, gedcom

我一直在寻找 JavaScript 中的 GEDCOM 解析器。目前存在吗？我已经在许多语言中找到了它们，但在 JavaScript 中还没有。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:23:31.340

*   [阅读-gedcom](https://github.com/arbre-app/read-gedcom)
*   [tmcw/解析-gedcom](https://github.com/tmcw/parse-gedcom)
*   [jswale/gedcom-js-viewer](https://github.com/jswale/gedcom-js-viewer)
*   [gedcom树](https://github.com/Vanuan/gedcom-tree)
*   [gedbrowser](http://sourceforge.net/projects/gedbrowser/) (HTML 和 javascript)
*   [gedcom.js](https://github.com/dcapwell/gedcom.js)

# wordpress - 如何调试 WordPress 插件？

> ID：14541989
> 
> 赞同：36
> 
> 时间：2013-01-26T21:57:39.457
> 
> 标签：wordpress, debugging

我最近继承了一个 WordPress 插件，其中有一些错误。我的问题是我也是 WordPress 的新手，我不知道如何记录调试消息，以便弄清楚发生了什么。

我真的只需要一种方法来创建弹出窗口或登录到控制台。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-27T01:22:58.870

在 WordPress Stack Exchange 上有一个很好的问答，很多知识渊博的人解释了他们的调试技术：[你如何调试插件？](https://wordpress.stackexchange.com/q/145/12615)

在**Javascript**领域你基本上需要`<script>console.log('the value is' + variable);</script>`. 并使用[Google Chrome 检查器](http://developer.chrome.com/extensions/tut_debugging.html)和/或[Firebug](http://getfirebug.com/)。

在**PHP**中，这取决于事情发生的位置或您想要输出的位置。

* * *

### [在 WordPress 中调试](http://codex.wordpress.org/Debugging_in_WordPress)

法典中的官方文档。

`wp-config.php`调试示例

```
// Enable WP_DEBUG mode
define( 'WP_DEBUG', true );

// Enable Debug logging to the /wp-content/debug.log file
define( 'WP_DEBUG_LOG', true );

// Disable display of errors and warnings 
define( 'WP_DEBUG_DISPLAY', false );
@ini_set( 'display_errors', 0 );

// Use dev versions of core JS and CSS files (only needed if you are modifying these core files)
define( 'SCRIPT_DEBUG', true ); 
```

* * *

### 将信息打印到日志文件

以下使用 OSX/Unix/Linux 系统路径，针对 Windows 进行调整。

```
/* Log to File
 * Description: Log into system php error log, usefull for Ajax and stuff that FirePHP doesn't catch
 */
function my_log_file( $msg, $name = '' )
{
    // Print the name of the calling function if $name is left empty
    $trace=debug_backtrace();
    $name = ( '' == $name ) ? $trace[1]['function'] : $name;

    $error_dir = '/Applications/MAMP/logs/php_error.log';
    $msg = print_r( $msg, true );
    $log = $name . "  |  " . $msg . "\n";
    error_log( $log, 3, $error_dir );
} 
```

然后，在您的代码中调用该函数`my_log_file( $post, 'The post contents are:' );`

* * *

### 直接在渲染的 Html 中打印

```
/* Echo variable
 * Description: Uses <pre> and print_r to display a variable in formated fashion
 */
function echo_log( $what )
{
    echo '<pre>'.print_r( $what, true ).'</pre>';
} 
```

并在需要的地方使用它，例如：`echo_log( $post );`.

* * *

### [FirePHP](https://stackoverflow.com/search?q=firephp%20is:question)

此扩展程序将直接在浏览器控制台中记录信息。请参阅 WordPress Answers 中的以下问答：[如何使用 WP-FirePHP 扩展？](https://wordpress.stackexchange.com/q/71569/12615).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-26T22:01:37.223

1.  不调试就不要开发！
2.  请阅读：[http ://wp.smashingmagazine.com/2011/03/08/ten-things-every-wordpress-plugin-developer-should-know/](http://wp.smashingmagazine.com/2011/03/08/ten-things-every-wordpress-plugin-developer-should-know/)

祝你好运，你可以让我们更新。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-26T22:01:54.397

一般的 PHP 调试策略是使用`print_r( $var )`语句和刷新页面。简单易行。如果你想进入代码[Xdebug](http://xdebug.org/docs/install)就是你想要安装的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-27T03:54:50.477

根据[您的评论](https://stackoverflow.com/questions/14541989/how-do-i-debug-a-wordpress-plugin#comment20283220_14541989)，您在哪里`Much rather use a system where debug messages can be turned off and on in one place`：

它可以在 WordPress 中完成。有一个常量[`WP_DEBUG`](http://codex.wordpress.org/WP_DEBUG)，您可以在 WordPress 文件夹（添加数据库参数的文件）中设置`true`或设置该常量。`false``wp-config.php`

因此，您可以使用：

```
if( WP_DEBUG ){
echo "<script> alert('Hello World!'); </script>"; 
} 
```

仅当您将 WP_DEBUG 设置为`true`（例如在网站的开发版本上，例如在您的本地主机上）时，警报才会显示，而不会显示在您的网站的生产版本上（您只需在`WP_DEBUG`此处设置为 false）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-03T21:58:38.130

通过使用 Visual Studio 和开发工具 php 调试器扩展，您实际上可以逐步调试它，而不是记录它们并尝试在运行时找出变量值。可能还有其他选择。

PS：它不是免费的:(

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2018-03-24T07:19:03.683

我知道我的答案是在最初的问题之后几年出现的，但是由于我最近遇到了同样的问题并且仍然找不到令人满意的解决方案，所以我为此编写了一个插件。

它专门解决了 OP 的需求：

> 我真的只需要一种方法来创建弹出窗口或登录到控制台。

希望它可以帮助所有插件/主题开发人员，他们正在寻找一种快速简便的方法来调试他们的代码[https://wordpress.org/plugins/bugfu-console-debugger](https://wordpress.org/plugins/bugfu-console-debugger)

只需安装它并从您的 PHP 代码中调用 logging 方法即可直接登录到浏览器 JavaScript 控制台。

```
BugFu::log($your_string-array-object); 
```

# android - 在 Android 的设置中选择一张图片

> ID：14541993
> 
> 赞同：2
> 
> 时间：2013-01-26T21:57:49.917
> 
> 标签：android, settings

我目前正在开发一个 Android 应用程序，我想让用户选择一个图像作为背景。然后我想知道是否有一种简单的方法可以`Intent`使用首选项启动相应的，或者我是否必须基于创建自己的自定义类`Preference`？

谢谢。

# javascript - Meteor 应用程序 - 没有调用主干路由器

> ID：14541994
> 
> 赞同：13
> 
> 时间：2013-01-26T21:58:06.693
> 
> 标签：javascript, backbone.js, meteor, router

在我的 Meteor 应用程序中，Backbone 路由器仅在用户登录时工作（通过 accounts-base 包）。真奇怪。该路由器本身工作正常。`showSaying()`当用户未登录时，根本不会调用该函数。

以下是`client.js`客户端文件夹中的代码。我需要对会话或自动发布做些什么吗？

```
AphorismView = Backbone.View.extend({
el: "#aphorism-item",
initialize: function(){
    _.bindAll(this, "render");
    this.render();
},
render: function() {
    this.$el.append("<p style='height:600px; background-color:blue;'>hi</p>");
}
});

// Creates a route to view the selected aphorism
var Aphorism = Backbone.Router.extend({
    routes: {       
        "saying/:id": "showSaying"
    },
    showSaying: function (id) {
        var aphorism_view = new AphorismView();
        alert('Saying id ' + id + '.');
  }
});

//establishes the router
appRouter = new Aphorism;

//Sets up backbone
Meteor.startup(function () {
    filepicker.setKey("AerIOvsmAQRGaNdEv0judz");
    filepicker.constructWidget(document.getElementById('attachment'));
    Backbone.history.start({pushState: true});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:05:04.687

您的问题似乎根本不像 Backbone.js 问题。

您是否尝试过在回调中放置一个 console.log 语句`startup()`来验证它是否在所有情况下都被实际调用？如果不是，那是你和 Meteor 之间的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:05:21.867

您是否尝试过等待 DOM 准备就绪？例如：`$( Backbone.history.start )`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T08:32:52.047

尝试将主干历史声明拉到`Meteor.start`. 它没有理由在那里。另外，我相信`showSaying`只有当您转到具有参数的路线时才会调用它`id`（即，您不能只转到`http://app/saying/`）。

此外，`approuter.navigate`如果您尝试以编程方式导航，您可能需要手动调用以使路由器工作。（我不知道你是不是，但这可能是问题所在）。

除此之外，我找不到这段特定代码的任何问题。如果我的建议没有解决问题，问题可能出在其他地方。

有关工作路由器实现的示例，您可以查看[https://github.com/Benaiah/Athenaeum/blob/master/client/router.coffee](https://github.com/Benaiah/Athenaeum/blob/master/client/router.coffee)（免责声明：它来自我正在编写的应用程序）并尝试查找任何其他差异。

希望有帮助。

# php - PHP - UTF8 字符的字节数？

> ID：14541995
> 
> 赞同：1
> 
> 时间：2013-01-26T21:58:29.723
> 
> 标签：php, email, unicode, utf-8, utf

我需要处理一些电子邮件，其中包含字符短语，例如：

```
=E2=82=AC 
```

这显然是欧元符号的字节。

我也得到诸如：

```
VALIGN=3D"top" 
```

我不确定这意味着什么（3D 部分）。

和其他如：

```
FirstName=C2=A0LastName 
```

有谁知道如何通过 PHP 将其转换为正确的字符？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T22:05:19.577

正如 Gumbo 指出的那样，这些字符被编码为带引号的可打印字符串。要解码，请使用[这个恰当命名的函数](http://php.net/manual/en/function.quoted-printable-decode.php)：

```
$string = '=E2=82=AC';
echo quoted_printable_decode($string);
// echoes out € 
```

但正如 MarkReed 所指出的，如果您的邮件逻辑有缺陷，这并不是真正的解决方案。如果此功能构成您的应用程序的很大一部分，请查看强大的电子邮件框架或库。