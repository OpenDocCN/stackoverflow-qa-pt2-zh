# StackOverflow 问答 14416000-14416999

# android - Android 两个横向布局

> ID：14416002
> 
> 赞同：0
> 
> 时间：2013-01-19T15:48:55.707
> 
> 标签：android, android-layout

我想水平放置两个布局，右边的小布局和左边的大布局我试过这样

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:background="#000000" >
    </LinearLayout>

    <LinearLayout
        android:layout_width="10dip"
        android:layout_height="fill_parent"
        android:background="#ffffff" >
    </LinearLayout>

</LinearLayout> 
```

但是还是把右边的那个小了，怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:56:24.763

LinearLayout 按照添加它们的顺序显示其子级：从上到下 = 从左到右，水平视图和从上到下垂直视图。更改 XML 中视图的顺序，它们将在屏幕上更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:18:26.593

很抱歉最近看到你的评论。但是试试这个：

**伪代码（未经测试）：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:weightsum = "10"
    >

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="7"
        android:background="#ffffff" 
         >
    </LinearLayout>

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="3"
        android:background="#000000"
        >
    </LinearLayout>

</LinearLayout> 
```

您不需要将方向水平放置，因为它默认支持。即使像其他回答者所说的那样保留它也没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T15:57:03.183

试试这个 ：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:background="#000000" >
    </LinearLayout>

    <LinearLayout
        android:layout_width="20dip"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:background="#ffffff" >
    </LinearLayout>

</LinearLayout> 
```

**参考 ：**

[将 layout_weight 与 Android 布局一起使用](http://www.chess-ix.com/2012/01/17/the-use-of-layout_weight-with-android-layouts/)

谢谢。

# node.js - Mongoose + CoffeeScript 'default' 属性 - 让它工作？

> ID：14416004
> 
> 赞同：0
> 
> 时间：2013-01-19T15:48:59.983
> 
> 标签：node.js, coffeescript, mongoose

如您所知，MongooseJS 有一个可用的“默认”属性。例如，如果我想要我的对象上的 Date 属性，并且我希望该日期自动默认为创建记录的时间，我将在架构中将其定义为：

```
var myObject = mongoose.Schema({
  date: {type: Date, default: Date.now}
}); 
```

现在，在 CoffeeScript 中这样做的问题是它`default`是 JavaScript 中的保留关键字，所以 CoffeeScript 编译器会自动`default`用双引号括起来，所以这段 CoffeeScript 代码：

```
myObject = mongoose.Schema
    date:
        type: Date
        default: Date.now 
```

编译为：

```
var myObject;
myObject = mongoose.Schema({
    date: {type: Date, "default": Date.now}
}); 
```

这会导致`default`参数无法按预期工作。也许我错过了一些东西，但我尝试过的一切都不起作用。保存记录时我不需要手动设置日期，因为`default`关键字已经提供了此功能。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:51:20.397

我不得不承认我讨厌 CoffeeScript 之类的东西，但你可能会通过这样做来解决这个问题：

```
var schema = {
   type: Date
};

schema["default"] = Date.now;

myObject = mongoose.Schema(schema); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:40:59.090

因此，我的问题的解决方案相当简单，而且是一个菜鸟错误：我忘记在 myObject.find() 中指定要返回的 Date 属性...

# spring - Spring环境属性源配置

> ID：14416005
> 
> 赞同：15
> 
> 时间：2013-01-19T15:49:09.470
> 
> 标签：spring

我正在开发一个应用程序库，其中包含一个名为“ `Config`”的实用程序类，它由 Spring`Environment`对象支持，并为所有应用程序配置值提供强类型的 getter。

配置的属性源可以根据环境（DEV/PROD）和使用（独立/测试/webapp）而变化，并且可以从默认的（系统和环境属性）到自定义数据库和 JNDI 源。

我正在努力解决的是如何让使用此库的应用程序轻松配置 使用的属性源`Environment`，以便这些属性可用于我们的`Config`类和通过`PropertySourcesPlaceholderConfigurer`.

我们仍在使用 XML 配置，因此理想情况下，这可以在 XML 中进行配置。

```
<bean id="propertySources" class="...">
    <property name="sources">
        <list>
            <ref local="jndiPropertySource"/>
            <ref local="databasePropertySource"/>
        </list>
    </property>
</bean> 
```

...然后以某种方式注入到环境的属性源集合中。

我已经读到由于应用上下文生命周期的时间安排，这样的事情可能是不可能的，并且这可能需要使用应用程序初始化程序类来完成。

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T17:18:07.547

这取决于您要如何使用属性，如果要使用`${propertyname}`语法注入属性，那么是的，只需使用 PropertySourcesPlaceHolderConfigurer 即可，它在内部可以访问在环境中注册的 PropertySource。

如果您打算直接使用 Environment ，使用 say `env.getProperty()`，那么您是对的 - 使用 PropertySourcesPlaceHolderConfigurer 的属性在此处不可见。唯一的方法是使用 Java 代码注入它，我知道有两种方法：

一种。使用 Java 配置：

```
@Configuration
@PropertySource("classpath:/app.properties")
public class SpringConfig{

} 
```

湾。使用自定义[ApplicationContextInitializer](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/context/ApplicationContextInitializer.html)，[这里描述的方式](http://blog.springsource.com/2011/02/15/spring-3-1-m1-unified-property-management/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-21T00:42:35.250

我想出了以下似乎可行的方法，但我对 Spring 还很陌生，所以我不太确定它在不同的用例下如何保持。

基本上，该方法是扩展`PropertySourcesPlaceholderConfigurer`和添加一个设置器以允许用户轻松配置`PropertySource`XML 中的对象列表。创建后，属性源将复制到当前的`Environment`.

这基本上允许在一个地方配置属性源，但同时被占位符配置和 Environment.getProperty 场景使用。

**扩展`PropertySourcesPlaceholderConfigurer`**

```
public class ConfigSourcesConfigurer 
        extends PropertySourcesPlaceholderConfigurer
        implements EnvironmentAware, InitializingBean {

    private Environment environment;
    private List<PropertySource> sourceList;

    // Allow setting property sources as a List for easier XML configuration
    public void setPropertySources(List<PropertySource> propertySources) {

        this.sourceList = propertySources;
        MutablePropertySources sources = new MutablePropertySources();
        copyListToPropertySources(this.sourceList, sources);        
        super.setPropertySources(sources);
    }

    @Override
    public void setEnvironment(Environment environment) {
        // save off Environment for later use
        this.environment = environment;
        super.setEnvironment(environment);
    }

    @Override
    public void afterPropertiesSet() throws Exception {

        // Copy property sources to Environment
        MutablePropertySources envPropSources = ((ConfigurableEnvironment)environment).getPropertySources();
        copyListToPropertySources(this.sourceList, envPropSources);
    }

    private void copyListToPropertySources(List<PropertySource> list, MutablePropertySources sources) {

        // iterate in reverse order to insure ordering in property sources object
        for(int i = list.size() - 1; i >= 0; i--) {
            sources.addFirst(list.get(i));
        }
    }
} 
```

**显示基本配置的 beans.xml 文件**

```
<beans>
    <context:annotation-config/>
    <context:component-scan base-package="com.mycompany" />

    <bean class="com.mycompany.ConfigSourcesConfigurer">
        <property name="propertySources">
            <list>
                <bean class="org.mycompany.CustomPropertySource" />
                <bean class="org.springframework.core.io.support.ResourcePropertySource">
                    <constructor-arg value="classpath:default-config.properties" />
                </bean>
            </list>
        </property>
    </bean>
    <bean class="com.mycompany.TestBean">
        <property name="stringValue" value="${placeholder}" />
    </bean>
</beans> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-09T07:58:19.183

以下内容适用于 Spring 3.2.4 。

`PropertySourcesPlaceholderConfigurer`必须静态注册才能处理占位符。

自定义属性源在`init`方法中注册，并且由于默认属性源已经注册，它本身可以使用占位符进行参数化。

JavaConfig 类：

```
@Configuration
@PropertySource("classpath:propertiesTest2.properties")
public class TestConfig {

    @Autowired
    private ConfigurableEnvironment env;

    @Value("${param:NOVALUE}")
    private String param;

    @PostConstruct
    public void init() {
        env.getPropertySources().addFirst(new CustomPropertySource(param));
    }

    @Bean
    public static PropertySourcesPlaceholderConfigurer placeHolderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }

    @Bean
    public TestBean1 testBean1() {
        return new TestBean1();
    }
 } 
```

自定义属性来源：

```
 public class CustomPropertySource extends PropertySource<Object> {

    public CustomPropertySource(String param) {
        super("custom");
        System.out.println("Custom property source initialized with param " + param + ".");
    }

    @Override
    public Object getProperty(String name) {
        return "IT WORKS";
    }

} 
```

测试bean（`getValue()`将输出`"IT WORKS"`）：

```
public class TestBean1 {

   @Value("${value:NOVALUE}")
   private String value;

   public String getValue() {
      return value;
   }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-08-27T02:16:09.887

我遇到了类似的问题，在我的情况下，我`Spring`在独立应用程序中使用，加载默认配置后，我可能需要应用配置目录中存在的另一个属性文件（延迟加载配置）。我的解决方案受到了这个[`Spring Boot`文档](http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html)的启发，但不依赖于`Spring Boot`. 见下面的源代码：

```
@PropertySources(@PropertySource(value = "classpath:myapp-default.properties"))
public class PersistenceConfiguration {

    private final Logger log = LoggerFactory.getLogger(getClass());

    private ConfigurableEnvironment env;

    @Bean
    public static PropertySourcesPlaceholderConfigurer placeholderConfigurerDev(ConfigurableEnvironment env) {
        return new PropertySourcesPlaceholderConfigurer();
    }

    @Autowired
    public void setConfigurableEnvironment(ConfigurableEnvironment env) {
        for(String profile: env.getActiveProfiles()) {
            final String fileName = "myapp-" + profile + ".properties";
            final Resource resource = new ClassPathResource(fileName);
            if (resource.exists()) {
                try {
                    MutablePropertySources sources = env.getPropertySources();
                    sources.addFirst(new PropertiesPropertySource(fileName,PropertiesLoaderUtils.loadProperties(resource)));
                } catch (Exception ex) {
                    log.error(ex.getMessage(), ex);
                    throw new RuntimeException(ex.getMessage(), ex);
                }
            }
        }
        this.env = env;
    }

    ...

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-18T19:20:44.900

我最近遇到了如何在环境中注册自定义属性源的问题。我的具体问题是我有一个带有 Spring 配置的库，我想将它导入到 Spring 应用程序上下文中，并且它需要自定义属性源。但是，我不一定可以控制创建应用程序上下文的所有位置。因此，我不想使用推荐的 ApplicationContextInitializer 或 register-before-refresh 机制来注册自定义属性源。

我发现真正令人沮丧的是，使用旧的 PropertyPlaceholderConfigurer，很容易在 Spring 配置中完全子类化和自定义配置器。相反，要自定义属性源，我们被告知我们必须在 Spring 配置本身中而不是在初始化应用程序上下文之前进行。

经过一些研究和反复试验，我发现*可以*从 Spring 配置内部注册自定义属性源，但是您必须小心如何操作。在上下文中执行任何 PropertySourcesPlaceholderConfigurers 之前，需要注册源。您可以通过将源注册设置为具有 PriorityOrdered 的 BeanFactoryPostProcessor 和比使用源的 PropertySourcesPlaceholderConfigurer 更高优先级的顺序来做到这一点。

我写了这个类，它完成了这项工作：

```
package example;

import java.io.IOException;
import java.util.Properties;

import org.springframework.beans.BeansException;
import org.springframework.beans.factory.BeanInitializationException;
import org.springframework.beans.factory.config.BeanFactoryPostProcessor;
import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.core.Ordered;
import org.springframework.core.PriorityOrdered;
import org.springframework.core.env.ConfigurableEnvironment;
import org.springframework.core.env.Environment;
import org.springframework.core.env.MutablePropertySources;
import org.springframework.core.env.PropertiesPropertySource;
import org.springframework.core.env.PropertySource;
import org.springframework.core.io.support.PropertiesLoaderSupport;

/**
 * This is an abstract base class that can be extended by any class that wishes
 * to become a custom property source in the Spring context.
 * <p>
 * This extends from the standard Spring class PropertiesLoaderSupport, which
 * contains properties that specify property resource locations, plus methods
 * for loading properties from specified resources. These are all available to
 * be used from the Spring configuration, and by subclasses of this class.
 * <p>
 * This also implements a number of Spring flag interfaces, all of which are
 * required to maneuver instances of this class into a position where they can
 * register their property sources BEFORE PropertySourcesPlaceholderConfigurer
 * executes to substitute variables in the Spring configuration:
 * <ul>
 * <li>BeanFactoryPostProcessor - Guarantees that this bean will be instantiated
 * before other beans in the context. It also puts it in the same phase as
 * PropertySourcesPlaceholderConfigurer, which is also a BFPP. The
 * postProcessBeanFactory method is used to register the property source.</li>
 * <li>PriorityOrdered - Allows the bean priority to be specified relative to
 * PropertySourcesPlaceholderConfigurer so that this bean can be executed first.
 * </li>
 * <li>ApplicationContextAware - Provides access to the application context and
 * its environment so that the created property source can be registered.</li>
 * </ul>
 * <p>
 * The Spring configuration for subclasses should contain the following
 * properties:
 * <ul>
 * <li>propertySourceName - The name of the property source this will register.</li>
 * <li>location(s) - The location from which properties will be loaded.</li>
 * <li>addBeforeSourceName (optional) - If specified, the resulting property
 * source will be added before the given property source name, and will
 * therefore take precedence.</li>
 * <li>order (optional) - The order in which this source should be executed
 * relative to other BeanFactoryPostProcessors. This should be used in
 * conjunction with addBeforeName so that if property source factory "psfa"
 * needs to register its property source before the one from "psfb", "psfa"
 * executes AFTER "psfb".
 * </ul>
 * 
 * @author rjsmith2
 *
 */
public abstract class AbstractPropertySourceFactory extends
        PropertiesLoaderSupport implements ApplicationContextAware,
        PriorityOrdered, BeanFactoryPostProcessor {

    // Default order will be barely higher than the default for
    // PropertySourcesPlaceholderConfigurer.
    private int order = Ordered.LOWEST_PRECEDENCE - 1;

    private String propertySourceName;

    private String addBeforeSourceName;

    private ApplicationContext applicationContext;

    private MutablePropertySources getPropertySources() {
        final Environment env = applicationContext.getEnvironment();
        if (!(env instanceof ConfigurableEnvironment)) {
            throw new IllegalStateException(
                    "Cannot get environment for Spring application context");
        }
        return ((ConfigurableEnvironment) env).getPropertySources();
    }

    public int getOrder() {
        return order;
    }

    public void setOrder(int order) {
        this.order = order;
    }

    public String getPropertySourceName() {
        return propertySourceName;
    }

    public void setPropertySourceName(String propertySourceName) {
        this.propertySourceName = propertySourceName;
    }

    public String getAddBeforeSourceName() {
        return addBeforeSourceName;
    }

    public void setAddBeforeSourceName(String addBeforeSourceName) {
        this.addBeforeSourceName = addBeforeSourceName;
    }

    public void setApplicationContext(ApplicationContext applicationContext) {
        this.applicationContext = applicationContext;
    }

    /**
     * Subclasses can override this method to perform adjustments on the
     * properties after they are read.
     * <p>
     * This should be done by getting, adding, removing, and updating properties
     * as needed.
     * 
     * @param props
     *            properties to adjust
     */
    protected void convertProperties(Properties props) {
        // Override in subclass to perform conversions.
    }

    /**
     * Creates a property source from the specified locations.
     * 
     * @return PropertiesPropertySource instance containing the read properties
     * @throws IOException
     *             if properties cannot be read
     */
    protected PropertySource<?> createPropertySource() throws IOException {
        if (propertySourceName == null) {
            throw new IllegalStateException("No property source name specified");
        }

        // Load the properties file (or files) from specified locations.
        final Properties props = new Properties();
        loadProperties(props);

        // Convert properties as required.
        convertProperties(props);

        // Convert to property source.
        final PropertiesPropertySource source = new PropertiesPropertySource(
                propertySourceName, props);

        return source;
    }

    @Override
    public void postProcessBeanFactory(
            ConfigurableListableBeanFactory beanFactory) throws BeansException {
        try {
            // Create the property source, and get its desired position in
            // the list of sources.
            if (logger.isDebugEnabled()) {
                logger.debug("Creating property source [" + propertySourceName
                        + "]");
            }
            final PropertySource<?> source = createPropertySource();

            // Register the property source.
            final MutablePropertySources sources = getPropertySources();
            if (addBeforeSourceName != null) {
                if (sources.contains(addBeforeSourceName)) {
                    if (logger.isDebugEnabled()) {
                        logger.debug("Adding property source ["
                                + propertySourceName + "] before ["
                                + addBeforeSourceName + "]");
                    }
                    sources.addBefore(addBeforeSourceName, source);
                } else {
                    logger.warn("Property source [" + propertySourceName
                            + "] cannot be added before non-existent source ["
                            + addBeforeSourceName + "] - adding at the end");
                    sources.addLast(source);
                }
            } else {
                if (logger.isDebugEnabled()) {
                    logger.debug("Adding property source ["
                            + propertySourceName + "] at the end");
                }
                sources.addLast(source);
            }
        } catch (Exception e) {
            throw new BeanInitializationException(
                    "Failed to register property source", e);
        }
    }

} 
```

这里需要注意的是，这个属性源工厂类的默认顺序比 PropertySourcesPlaceholderConfigurer 的默认顺序高。

此外，属性源的注册发生在 postProcessBeanFactory 中，这意味着它将以相对于 PropertySourcesPlaceholderConfigurer 的正确顺序执行。我发现 InitializingBean 和 afterPropertiesSet 不尊重 order 参数的困难方式，我放弃了这种方法，因为它是错误的和多余的。

最后，因为这是一个 BeanFactoryPostProcessor，所以尝试以依赖关系的方式连接很多东西是个坏主意。因此，该类直接通过它使用 ApplicationContextAware 获得的应用程序上下文访问环境。

就我而言，我需要属性源来解密密码属性，我使用以下子类实现了它：

```
package example;

import java.util.Properties;

/**
 * This is a property source factory that creates a property source that can
 * process properties for substituting into a Spring configuration.
 * <p>
 * The only thing that distinguishes this from a normal Spring property source
 * is that it decrypts encrypted passwords.
 * 
 * @author rjsmith2
 *
 */
public class PasswordPropertySourceFactory extends
        AbstractPropertySourceFactory {

    private static final PasswordHelper passwordHelper = new PasswordHelper();

    private String[] passwordProperties;

    public String[] getPasswordProperties() {
        return passwordProperties;
    }

    public void setPasswordProperties(String[] passwordProperties) {
        this.passwordProperties = passwordProperties;
    }

    public void setPasswordProperty(String passwordProperty) {
        this.passwordProperties = new String[] { passwordProperty };
    }

    @Override
    protected void convertProperties(Properties props) {
        // Adjust password fields by decrypting them.
        if (passwordProperties != null) {
            for (String propName : passwordProperties) {
                final String propValue = props.getProperty(propName);
                if (propValue != null) {
                    final String plaintext = passwordHelper
                            .decryptString(propValue);
                    props.setProperty(propName, plaintext);
                }
            }
        }
    }

} 
```

最后，我在我的 Spring 配置中指定了属性源工厂：

```
<!-- Enable property resolution via PropertySourcesPlaceholderConfigurer. 
    The order has to be larger than the ones used by custom property sources 
    so that those property sources are registered before any placeholders
    are substituted. -->
<context:property-placeholder order="1000" ignore-unresolvable="true" />

<!-- Register a custom property source that reads DB properties, and
     decrypts the database password. -->
<bean class="example.PasswordPropertySourceFactory">
    <property name="propertySourceName" value="DBPropertySource" />
    <property name="location" value="classpath:db.properties" />
    <property name="passwordProperty" value="db.password" />
    <property name="ignoreResourceNotFound" value="true" />

    <!-- Order must be lower than on property-placeholder element. -->
    <property name="order" value="100" />
</bean> 
```

老实说，使用 PropertySourcesPlaceholderConfigurer 和 AbstractPropertySourceFactory 中的默认顺序，可能甚至不需要在 Spring 配置中指定顺序。

尽管如此，这是可行的，并且*不需要*对应用程序上下文初始化进行任何摆弄。

# javascript - 如何找到具有最大 z-Index 的元素？

> ID：14416012
> 
> 赞同：2
> 
> 时间：2013-01-19T15:49:34.613
> 
> 标签：javascript, css, z-index

我有很多动态创建的元素，只要它得到 z-Index++，所以最新的元素随时都在上面。当其中一个被点击时，他得到他的 z-Index max+1。所以我需要获取元素，即在顶部，我该怎么做？

仅限本机 JS。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:52:13.397

不要试图找到它——你需要迭代所有的 DOM。当您动态创建它们时，只需保存对它的引用并每次更新它。或者只是将当前的`z-index`最大值存储在一个`max`变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T19:18:33.533

## [http://jsfiddle.net/h4ets/](http://jsfiddle.net/h4ets/)

假设您只在 style 属性中应用 z-index

```
var elems = document.body.getElementsByTagName("*");
var largest;
var check = 0;
for(i=0;i<elems.length;i++){
    if(elems[i].style.zIndex > check){
        check = elems[i].style.zIndex;
        largest = elems[i];
    }
}
// largest is the element
// check is the z-index value of the element with largest z-index 
```

在 chrome 和 safari 等 webkit 浏览器中，获取元素的计算样式似乎是一个问题，因为它返回 auto，这是一个主要问题，因为 chrome 尤其是现在是一种流行且广泛使用的浏览器。所以现在我建议如果你想这样做，在样式属性中应用 z-index，直到错误被修复

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-25T13:18:03.077

**这是一个最好的解决方案**

```
$(function(){
    var maxZ = Math.max.apply(null,$.map($('body > *'), function(e,n){
           if($(e).css('position')=='absolute')
                return parseInt($(e).css('z-index'))||1 ;
           })
    );
    alert(maxZ);
}); 
```

# android - 生成带有循环的 TextViews 并为每一个启用点击

> ID：14416013
> 
> 赞同：0
> 
> 时间：2013-01-19T15:49:38.203
> 
> 标签：android, onclick, onclicklistener

我正在制作一个 Android 应用程序，在接下来的活动中，我对数据库执行查询并获取结果。我获取结果并将 TextViews 制作到 Activity 中。当我单击 TextView 时，我希望将我单击的餐厅的名称传递给下一个 Activity。我的代码的问题在于，对于所有 TextView，它都保存了最后一家餐厅的名称。有任何想法吗？谢谢！

```
public class ViewRestaurants extends Activity{
String name;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.row_restaurant);

DBAdapter db = new DBAdapter(this);
db.open();

Cursor c = db.getSpRestaurants(getIntent().getStringExtra("city"), getIntent().getStringExtra("area"), getIntent().getStringExtra("cuisine"));

View layout =  findViewById(R.id.items);

if(c.moveToFirst())
{
    do{
        name = c.getString(0);
        TextView resname = new TextView(this);
        TextView res = new TextView(this);
        View line = new View(this);

        resname.setText(c.getString(0));
        resname.setTextColor(Color.RED);
        resname.setTextSize(30);
        resname.setTypeface(null,Typeface.BOLD);

        res.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));
        res.setText(c.getString(1)+","+c.getString(2)+","+c.getString(3)+"\n"+c.getString(4));
        res.setTextSize(20);
        res.setTextColor(Color.WHITE);
        res.setClickable(true);
        res.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                Intent i = new Intent();
                i.setClassName("com.mdl.cyrestaurants.guide", "com.mdl.cyrestaurants.guide.RestaurantDetails");
                i.putExtra("name",name);
                startActivity(i);
            }
        });

        line.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,2));
        line.setBackgroundColor(Color.RED);

        ((LinearLayout) layout).addView(resname);
        ((LinearLayout) layout).addView(res);
        ((LinearLayout) layout).addView(line);
    }while (c.moveToNext());

}

    db.close();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:59:04.473

您需要`name`在循环中创建最终结果并将其作为类字段删除，以便以`OnClickListener`您的方式使用它。

```
if(c.moveToFirst())
{
    do{
        final String name = c.getString(0);

        //other code ...

        res.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                Intent i = new Intent();
                i.setClassName("com.mdl.cyrestaurants.guide", "com.mdl.cyrestaurants.guide.RestaurantDetails");
                i.putExtra("name",name);
                startActivity(i);
            }
        });

        //more code...

    }while (c.moveToNext());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:06:32.840

尝试进行这些更改

```
String name = c.getString(0);
resname.setText(name); 
```

The reason why it is setting to the last restaurant name is because string is being passed by reference rather than by value as it is an object. Creating a unique string within the scope of the do while loop should solve this.

# ruby-on-rails - Rails 中后台作业的集成测试

> ID：14416015
> 
> 赞同：1
> 
> 时间：2013-01-19T15:50:14.110
> 
> 标签：ruby-on-rails, testing, cucumber

我正在构建一个包含两个部分的应用程序。
第一个是定期从外部资源获取数据并填充数据库。
第二个是根据用户请求显示它。

用集成测试覆盖第二部分很容易。问题是，我如何为第一部分编写集成测试，即 Cucumber 测试？我需要为此编写集成测试吗？还是单元测试就足够了？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T12:00:54.307

我在书中看到了类似的示例。

[黄瓜书](http://pragprog.com/book/hwcuc/the-cucumber-book)

您可以深入了解提供的源代码

第 9 章处理消息队列和异步组件

# css - 如何为 IE 重写这个 CSS

> ID：14416017
> 
> 赞同：1
> 
> 时间：2013-01-19T15:50:34.503
> 
> 标签：css

我有这个仅在 Firefox 中受支持的 css 代码。

```
/* Green header */
.container {
    background: linear-gradient(#5FA309, #3B8018);
    position: relative;
    display: inline-block;
    padding: 0 20px 0 10px;
    width: 270px;
    line-height: 20px;
    font-size: 12px;
    font-family: sans-serif;
    text-shadow: 0 1px 0 #264400;
    font-weight: bold;
    color: #fff;
}

.container:after {
    content: '';
    background: linear-gradient(top left, #5FA309, #3B8018);
    background: -webkit-gradient(linear, left top, left bottom, from(#5FA309), to(#3B8018));
    background: -moz-linear-gradient(top left,  #5FA309,  #3B8018);
    position: absolute;
    top: 3px; right: -7px;
    width: 15px;
    height: 15px;
    transform: rotate(45deg);
} 
```

如何使 IE 也支持此代码？我只想使用没有图像的css。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:59:34.643

请注意供应商前缀的使用以及`-ms-`供应商前缀的设置顺序：

```
.container{
    background:-webkit-gradient(linear, left top, left bottom, color-stop(0, #5fa309), color-stop(1, #3b8018));
    background:-webkit-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-moz-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-o-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-ms-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:linear-gradient(top, #5fa309 0%, #3b8018 100%);
    position:relative;
    display:inline-block;
    padding:0 20px 0 10px;
    width:270px;
    line-height:20px;
    font-size:12px;
    font-family:sans-serif;
    text-shadow:0 1px 0 #264400;
    font-weight:bold;
    color:#fff
}
.container:after{
    content:'';
    background:-webkit-gradient(linear, left top, right bottom, color-stop(0, #5fa309), color-stop(1, #3b8018));
    background:-webkit-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-moz-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-o-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-ms-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    position:absolute;
    top:3px;
    right:-7px;
    width:15px;
    height:15px;
    -webkit-transform:rotate(45deg);
    -moz-transform:rotate(45deg);
    -o-transform:rotate(45deg);
    -ms-transform:rotate(45deg);
    transform:rotate(45deg)
} 
```

# objective-c - 错误：索引 1 超出范围 [0 .. 0]

> ID：14416028
> 
> 赞同：1
> 
> 时间：2013-01-19T15:52:32.553
> 
> 标签：objective-c, xcode, uitableview, nsarray

我是 Xcode 的新手，我一直在使用显示此错误的 UITableViewController。

**这是错误消息：** ***由于未捕获的异常 'NSRangeException' 导致应用程序终止，原因：' *** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0]' *** First throw call stack: (0x1c91012 0x10cee7e 0x1c330b4 0x36d0 0xc58d5 0xc5b3d 0xacce83 0x1c50376 0x1c4fe06 0x1c37a82 0x1c36f44 0x1c36e1b 0x1beb7e3 0x1beb668 0x1665c 0x2132 0x2065）libc++abi.dylib：终止调用异常）

**这是我的代码：**

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{

 if (indexPath.row == 0) {

    NSString *strURL = [NSString stringWithFormat:@"http://localhost:8888/GetDetail.php?choice=row0"];
    NSArray *arrayImagesNames = [[NSMutableArray alloc] initWithContentsOfURL:[NSURL URLWithString:strURL]];

    arrayDataFromServer2 = [[NSMutableArray alloc]init];

    NSEnumerator *enumForNames = [arrayImagesNames objectEnumerator];

    id objName;

    while ( objName = [enumForNames nextObject]) {
        [arrayDataFromServer2 addObject:[NSDictionary dictionaryWithObjectsAndKeys:objName, @"name", nil]];
    }

    NSString *nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];

    row1 = [nn intValue];
    NSLog(@"%d", row1);

    CompanyProfileViewController *profile = [self.storyboard instantiateViewControllerWithIdentifier:@"Profile"];
    [self.navigationController pushViewController:profile animated:YES];

    profile.profileid = row1;
    NSLog(@"%d", profile.profileid);
}

if (indexPath.row == 1) {

    NSString *strURL = [NSString stringWithFormat:@"http://localhost:8888/GetDetail.php?choice=row1"];
    NSArray *arrayImagesNames = [[NSMutableArray alloc] initWithContentsOfURL:[NSURL URLWithString:strURL]];

    arrayDataFromServer2 = [[NSMutableArray alloc]init];

    NSEnumerator *enumForNames = [arrayImagesNames objectEnumerator];

    id objName;

    while (objName = [enumForNames nextObject]) {
        [arrayDataFromServer2 addObject:[NSDictionary dictionaryWithObjectsAndKeys:objName, @"name", nil]];
    }

    NSString *nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];

    row1 = [nn intValue];
    NSLog(@"%d", row1);

    CompanyProfileViewController *profile = [self.storyboard instantiateViewControllerWithIdentifier:@"Profile"];
    [self.navigationController pushViewController:profile animated:YES];

    profile.profileid = row1;
    NSLog(@"%d", profile.profileid);
}

if (indexPath.row == 2) {

    NSString *strURL = [NSString stringWithFormat:@"http://localhost:8888/GetDetail.php?choice=row2"];
    NSArray *arrayImagesNames = [[NSMutableArray alloc] initWithContentsOfURL:[NSURL URLWithString:strURL]];

    arrayDataFromServer2 = [[NSMutableArray alloc]init];

    NSEnumerator *enumForNames = [arrayImagesNames objectEnumerator];

    id objName;

    while ( objName = [enumForNames nextObject]) {
        [arrayDataFromServer2 addObject:[NSDictionary dictionaryWithObjectsAndKeys:objName, @"name", nil]];
    }

    NSString *nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];

    row1 = [nn intValue];
    NSLog(@"%d", row1);

    CompanyProfileViewController *profile = [self.storyboard instantiateViewControllerWithIdentifier:@"Profile"];
    [self.navigationController pushViewController:profile animated:YES];

    profile.profileid = row1;
    NSLog(@"%d", profile.profileid);
}

if (indexPath.row == 3) {

    NSString *strURL = [NSString stringWithFormat:@"http://localhost:8888/GetDetail.php?choice=row3"];
    NSArray *arrayImagesNames = [[NSMutableArray alloc] initWithContentsOfURL:[NSURL URLWithString:strURL]];

    arrayDataFromServer2 = [[NSMutableArray alloc]init];

    NSEnumerator *enumForNames = [arrayImagesNames objectEnumerator];

    id objName;

    while ( objName = [enumForNames nextObject]) {
        [arrayDataFromServer2 addObject:[NSDictionary dictionaryWithObjectsAndKeys:objName, @"name", nil]];
    }

    NSString *nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];

    row1 = [nn intValue];
    NSLog(@"%d", row1);

    CompanyProfileViewController *profile = [self.storyboard instantiateViewControllerWithIdentifier:@"Profile"];
    [self.navigationController pushViewController:profile animated:YES];

    profile.profileid = row1;
    NSLog(@"%d", profile.profileid);
 }
} 
```

当我单击第二个单元格（index.row == 1）时，会发生此错误。我使用了断点，错误就在这条线上："NSString *nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];"

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-11-23T12:57:49.513

# 斯威夫特 4

更多时间后，当您使用情节提要中的 tableView 并在代码中实现时，我爱上了这个错误：提示并比较：在节数和 numberOfRowsInSection == 情节提要和代码之间

```
 override func numberOfSections(in tableView: UITableView) -> Int {
        // #warning Incomplete implementation, return the number of sections
        return 3
    }

    override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        // #warning Incomplete implementation, return the number of rows
        return 1
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:55:41.240

您有一个数组，其中包含 0 个或 1 个元素。现在您尝试从中提取第二个元素，[0] 是第一个，[1] 是第二个。

编辑：

因为您不确定数组何时将包含 1 个或多个对象。因此，您可以用作：

```
NSString *nn=nil;
if([arrayDataFromServer2 count]>1){    
    nn = [[arrayDataFromServer2 objectAtIndex:indexPath.row] objectForKey:@"name"];
} 
```

# php - 将服务器字符集从 iso-8859-1 更改为 utf-8

> ID：14416031
> 
> 赞同：2
> 
> 时间：2013-01-19T15:52:55.050
> 
> 标签：php, mysql, apache, nginx

我有 apache 和 nginx 作为代理的服务器，在 htaccess 文件中我清楚地提到了这段代码，以便它可以将服务器默认字符集定义为`utf-8`

```
 AddDefaultCharset UTF-8 
```

但是当我尝试上传英文字符以外的文件时，我收到错误`filezilla`消息

```
 Failed to convert command to 8 bit charset 
```

我检查了`filezilla`网站和几个论坛都说这是因为服务器标头设置为其他字符集，然后我检查了标头，标头是 iso-8859-1，但我已明确将标头设置为文件`utf-8`中的标头`htacess`。我已经[检查](http://gtmetrix.com/compare/rfOsXZty/K7B9HFxY)过，那里也说

内容类型

`text/html; charset=iso-8859-1`

如何为`utf-8`包括 mysql 在内的整个服务器设置默认字符集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:00:48.067

Apache/nginx 中的字符集设置对使用 Filezilla 的 FTP/SFTP 上传没有影响。如果您使用 FTP 上传文件，请检查 FTP 服务器设置。如果您使用的是 SFTP，那么您可能需要检查用户配置文件设置，甚至是服务器本身的设置。

# linux - OpenGL - 渲染时间抖动使动画生涩

> ID：14416033
> 
> 赞同：2
> 
> 时间：2013-01-19T15:52:57.963
> 
> 标签：linux, opengl, timing

一个小的测试程序（见下文）显示了不稳定的输出，我认为这是由 OpenGL glutSwapBuffer() 期间奇怪的时序抖动引起的。与平均水平相比，测试程序经常显示单个帧的渲染时间非常长（~330 微秒与我机器上的~5.8 毫秒）程序的输出显示：

```
[...]
render time:   330us
render time:   372us
render time:   330us
render time:   331us
render time:  5820us
render time:   335us
render time:   332us
render time:   324us
render time:   346us
[...] 
```

设置：快速 PC（Intel i7 CPU @3.2GHz）、Ubuntu 12.04、NVIDIA GTS450 板、最新的 GL 驱动程序：OpenGL 渲染器字符串：GeForce GTS 450/PCIe/SSE2 OpenGL 版本字符串：4.3.0 NVIDIA 310.19 Samsung Display (23" @我假设是 60Hz，因为所有这些都有 60Hz）

在上面的测试用例中，我通过以下方式明确否决了 vblank 同步：__GL_SYNC_TO_VBLANK=0

启用 vblank 后，我的时间也很不稳定：

__GL_SYNC_TO_VBLANK=1

```
[...]
render time:  9169us
render time: 14548us
render time: 14613us
render time: 16057us
render time: 18075us
[...] 
```

我还使用了其他参数，例如将 X 服务器置于高优先级（sudo schedtool -p 0 -n -20 -N `pgrep X`）或将程序本身置于高优先级（chrt -p -a --fifo 99 ... )

仍然生涩的动画仍然存在 - 这（这是我的假设）是由奇怪的时间引起的。

没有 `glutSwapBuffers();' 的计时 在代码中显示了非常稳定的输出：

```
[...]
render time:     2us
render time:     2us
render time:     2us
render time:     1us
render time:     2us
[...] 
```

因此可以排除外部（其他过程）影响。

谁能解释这种行为？

知道如何改进吗？

## 该程序：

```
#include <stdio.h>
#include <GL/gl.h>
#include <GL/glut.h>
#include <time.h>

GLfloat gfPosX = 0.0;
GLfloat gfDeltaX = .01;

#define TS_TOUSEC(x) (x.tv_sec * 1000000L + (x.tv_nsec / 1000))
struct timespec t1, t2;

void Draw() {
    int x = 0;

    glClear(GL_COLOR_BUFFER_BIT);
    glColor3f(1.0, 1.0, 1.0);

    clock_gettime(CLOCK_REALTIME, &t1);
    glBegin(GL_LINES);
        glVertex3f(gfPosX, 0.25, 0.0);
        glVertex3f(gfPosX, 0.75,0.0);
    glEnd();
    clock_gettime(CLOCK_REALTIME, &t2);
    glutSwapBuffers();
    printf("render time: %5uus\n", TS_TOUSEC(t2) - TS_TOUSEC(t1));

    gfPosX += gfDeltaX;
    if (gfPosX >= 1.0 || gfPosX <= 0.0) {
        gfDeltaX = -gfDeltaX;
    }
}

void Timer(int iUnused)
{
    glutPostRedisplay();
    glutTimerFunc(5, Timer, 0);
}

void Initialize() {
    glClearColor(0.0, 0.0, 0.0, 0.0);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0.0, 1.0, 0.0, 1.0, -1.0, 1.0);
}

int main(int iArgc, char** cppArgv) {
    glutInit(&iArgc, cppArgv);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);
    glutInitWindowSize(250, 250);
    glutInitWindowPosition(200, 200);
    glutCreateWindow("XoaX.net");
    Initialize();
    glutDisplayFunc(Draw);
    Timer(0);
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T14:29:47.787

我不会使用这个：

> ```
> clock_gettime(CLOCK_REALTIME, &t1); 
> ```

CLOCK_REALTIME 显示墙上时间（即挂在墙上的时钟显示的时间），即不保证是单调的。它可能会稍微向前或向后，因为时间守护程序会对其进行调整。

要测量帧渲染时间，您需要 CLOCK_MONOTONIC_RAW。

在没有 SwapBuffers 的情况下，您只是在测量发出渲染调用所需的时间。不是渲染时间本身。您必须添加一个 glFinish 来获得它，以便实际执行命令队列。

出于所有实际目的，您不应该花费时间来渲染一帧，而是各个帧之间的时间，即调用显示函数之间的时间间隔。这提供了更准确的动画。

为了解决输入滞后问题，我会使用卡尔曼滤波器来预测渲染完成时的输入状态（因为您需要帧渲染时间，只需收集统计信息）并使用预测的输入状态进行帧推进。

# javascript - 内部函数内存泄漏

> ID：14416034
> 
> 赞同：0
> 
> 时间：2013-01-19T15:53:01.410
> 
> 标签：javascript

```
(function(){
  var a;

  function inner1(arg){
    a = arg;
  }

  function inner2(){
    alert(a);
  }

})(); 
```

这会导致我的应用程序中的内存泄漏，因为我在我的其他两个内部函数之外声明变量 a。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:55:31.667

不，因为您已经在匿名函数闭包中声明了该变量。

您可以通过执行以下操作来证明这一点。

```
(function(){
  var a;

  function inner1(arg){
    a = arg;
  }

  function inner2(){
    alert(a);
  }

})();

alert(a) 
```

# objective-c - 从 NSArray 中分离组件时出错

> ID：14416035
> 
> 赞同：1
> 
> 时间：2013-01-19T15:53:08.560
> 
> 标签：objective-c, nsarray, components

我从网站导入了一些股票市场数据，但在分离它们时遇到了问题。在部分代码中它工作正常，但最后却不是。这是代码：

```
NSURL *url = [NSURL URLWithString:@"http://www.bloomberg.com/quote/USIM5:BZ"];

NSData *webData = [NSData dataWithContentsOfURL:url];

//NSString *xPathQuery = @"//h3[@class=''] |//span[@class=' price'] | //span[@class=' trending_up up'] | //span[@class=' trending_up up']/span | //table[@class='snapshot_table']/tr/th | //table[@class='snapshot_table']/tr/td";

NSString *xPathQuery = @"//span[@class=' price'] | //span[@class=' trending_up up'] | //span[@class=' trending_up up']/span | //table[@class='snapshot_table']/tr/td";

TFHpple *parser = [TFHpple hppleWithData:webData isXML:NO];

NSArray *array = [parser searchWithXPathQuery:xPathQuery];

valores = [[NSMutableArray alloc]init];
for (TFHppleElement *element in array) {
    [valores addObject:[[element firstChild] content]];
}

novosValores = [[NSMutableArray alloc]init];
for (NSString *valuesDatum in valores) {
    NSString *removeNewLine = [[valuesDatum componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]] componentsJoinedByString:@" "];
    NSString *removeSpace = [removeNewLine stringByReplacingOccurrencesOfString:@"         " withString:@""];
    NSString *removeSpaceOne = [removeSpace stringByReplacingOccurrencesOfString:@"    " withString:@""];
    [novosValores addObject:removeSpaceOne];
}

NSLog(@"%@",novosValores);

valoresFinais = [[NSMutableArray alloc]init];
for (NSString *valuesDatum in novosValores) {
    NSArray *val = [valuesDatum componentsSeparatedByString:@" - "];
    [valoresFinais addObject:val];
}

NSLog(@"%@",valoresFinais);

infos = [[NSMutableArray alloc]init];
for (NSString *dados in valoresFinais) {
    NSArray *arrayDados = [dados componentsSeparatedByString:@","];
    [infos addObject:arrayDados];
}
NSLog(@"%@", infos);
} 
```

日志向我展示了这一点：

```
2013-01-19 12:45:17.526 BloombergQuotes[1720:c07] (
"12.300",
"12.580",
"12.270 - 12.590",
"4,572,600",
"12.460",
"5.570 - 13.770",
"+7.82%"
)
2013-01-19 12:45:17.528 BloombergQuotes[1720:c07] (
    (
    "12.300"
),
    (
    "12.580"
),
    (
    "12.270",
    "12.590"
),
    (
    "4,572,600"
),
    (
    "12.460"
),
    (
    "5.570",
    "13.770"
),
    (
    "+7.82%"
)
)
2013-01-19 12:45:17.528 BloombergQuotes[1720:c07] -[__NSArrayI    componentsSeparatedByString:]: unrecognized selector sent to instance 0x7434eb0
2013-01-19 12:45:17.529 BloombergQuotes[1720:c07] *** Terminating app due to uncaught  exception 'NSInvalidArgumentException', reason: '-[__NSArrayI componentsSeparatedByString:]:  unrecognized selector sent to instance 0x7434eb0'
*** First throw call stack:
(0x2101012 0x11fae7e 0x218c4bd 0x20f0bbc 0x20f094e 0x2fbe 0x223817 0x223882 0x172a25   0x172dbf 0x172f55 0x17bf67 0x13ffcc 0x140fab 0x152315 0x15324b 0x144cf8 0x205cdf9 0x205cad0   0x2076bf5 0x2076962 0x20a7bb6 0x20a6f44 0x20a6e1b 0x1407da 0x14265c 0x215d 0x2085)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

所以第一块数据几乎可以满足我的需要，除了我需要用“-”分隔的第 3 行和第 5 行。我这样做了，结果是第二块数据，但它返回了我在第 3 行和第 5 行用“，”连接的值。所以我再次用“，”分隔，这就是错误出现的地方。

所以，我需要的是第一块数据的内容全部分开。

任何帮助，将不胜感激..

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:17:08.637

一个方便的技巧是设置一个断点，以捕获发生的任何异常。在 XCode 中，打开 Breakpoints 'tap'，单击窗口底部的加号并选择“Add Exception Breakpoint...”。保留默认选项并点击“完成”。

接下来，异常告诉你它不喜欢什么：

原因：'-[ **__NSArrayI** componentsSeparatedByString:]： **无法识别的选择器**发送到实例 0x7434eb0'

您正在将 componentsSeparatedByString 发送到 NSArray。（当然，您尝试将其称为 NSString，但事实并非如此。我很好奇在代码上运行“分析”是否会捕获此问题，我敢打赌它可能会。）

该`componentsSeparatedByString`方法返回一个数组，您将其填充到另一个数组`valoresFinais`中。但是，您将项目从该数组中拉出并将它们称为`NSString`. 哎呀！将它们作为数组拉出，并迭代*该*字符串数组，我怀疑您的代码将开始工作。

这只是对您的示例的快速阅读，但我认为这就是问题所在。祝你好运。

# r - 将数据框的每一列提取到一个对象中

> ID：14416040
> 
> 赞同：2
> 
> 时间：2013-01-19T15:53:29.900
> 
> 标签：r

我有一个包含许多列的数据框，名为`foo`,`bar`等。

**我想提取数据框的每一列以分隔名为 的对象`foo`，`bar`依此类推。在 R 中是否有自动化的方法来做到这一点？**

工作示例：

```
mock <- structure(list(
x = structure(1:3, .Label = c("1", "2", "3"), class = "factor"), 
y = structure(1:3, .Label = c("A", "B", "C"), class = "factor"), 
z = structure(c(1L, 1L, 2L), .Label = c("0", "1"), class = "factor")), 
.Names = c("x", "y", "z"), row.names = c(NA, -3L), class = "data.frame") 
```

输出：

```
> mock
  x y z
1 1 A 0
2 2 B 0
3 3 C 1 
```

如何编写一个创建 objects 的循环`x`，`y`并`z`从此数据框的三列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:59:08.810

```
> for (i in 1:ncol(mock)) {
+   assign(names(mock)[i],mock[,i])
+ }
> x
[1] 1 2 3
Levels: 1 2 3
> y
[1] A B C
Levels: A B C
> z
[1] 0 0 1
Levels: 0 1 
```

但是，您应该小心使用`assign`。使用 可以实现几乎相同的结果`attach(mock)`，它是可逆的 ( `detach()`) 并且不会无意中覆盖现有变量（它只是掩盖它们）。

# android - Android：如何向标准软键栏添加菜单软键？

> ID：14416043
> 
> 赞同：2
> 
> 时间：2013-01-19T15:54:16.523
> 
> 标签：android, menu, softkeys

我正在开发一个应用程序，但无法在没有菜单硬键的设备上访问我的菜单。

我发现推荐的解决方案是使用 ActionBbar。但是我很久以前就开始开发这个应用程序，将我的 TabActivity 更改为 ActionBar 会导致一系列其他问题显然是无穷无尽的。

我找到了一个应用程序，它添加了第四个软键作为菜单软键，我的问题是如何实现这一点？

以下是软键栏的正常外观：

[https://docs.google.com/file/d/0B_dSVLmzXlwiaUhSelFVOXBvQWs/edit](https://docs.google.com/file/d/0B_dSVLmzXlwiaUhSelFVOXBvQWs/edit)

这是我想要实现的目标：

[https://docs.google.com/file/d/0B_dSVLmzXlwiajdacW56cFdOb0E/edit](https://docs.google.com/file/d/0B_dSVLmzXlwiajdacW56cFdOb0E/edit)

（因为我是新会员，所以还不能上传图片）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:19:30.903

该功能仅可用于保持向后兼容，您确实应该尝试在 ActionBar 中实现此功能。但是，如果您不使用 ActionBar 并且 minSdkVersion 设置为 10 或更低并且 targetSdkVersion 低于 14，您应该获得那个额外的按钮。来自安卓开发者博客：[http ://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html)

# content-management-system - Jahia CMS 模块，提供 body html 标签

> ID：14416044
> 
> 赞同：0
> 
> 时间：2013-01-19T15:54:28.700
> 
> 标签：content-management-system

我读到 Jahia CMS 使用 960gs 框架作为页面布局的默认值，我还读到所有定义行的 div 都应该嵌套到一个“特殊”的 div 中，该 div 的类等于 container_16。所以我决定找到一个模块，它在它的视图中为那个特殊的 div 呈现 html。我尝试搜索“container_16”的文件内容，发现一堆 css 文件，仅此而已，没有显示任何模块的视图。这让我很困惑，我有点想找到一个提供基本 html 标签的模块，比如“body”标签。

有人知道 jahia 模块的名称吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T12:35:48.233

您正在寻找的模块称为“网格”，源代码可在此处获得：[http ://subversion.jahia.org/svn/jahia/trunk/modules/grid/](http://subversion.jahia.org/svn/jahia/trunk/modules/grid/)

在 row.jsp 文件中，您将找到以下 div ：

<div class="container_16">

# lambda - 将 Lambda 转换为 Guid 列表

> ID：14416045
> 
> 赞同：0
> 
> 时间：2013-01-19T15:54:34.497
> 
> 标签：lambda, entity-framework-5

我在 ASP.NET MVC 4 中使用实体框架 5，我是新手。我想将实体主键作为列表。主键是类型`Guid`。当我编写以下代码时，出现错误：

```
List<Guid> list = DB.Complex.Where(d => d.IsActive == true)
.Select(d => d.PKComplexRoomID).ToList<Guid>(); 
```

错误：

`'System.Linq.IQueryable<System.Guid?>' does not contain a definition for 'ToList' and the best extension method overload 'System.Linq.Enumerable.ToList<TSource>(System.Collections.Generic.IEnumerable<TSource>)' has some invalid arguments`

我用谷歌搜索但找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:06:26.157

它看起来可以`PKComplexRoomID`为空，因为您的选择结果是 type `System.Linq.IQueryable<System.Guid?>`。

这取决于您的情况，但假设活动实体的房间 ID 不会为空，您可以尝试：

`List<Guid> list = DB.Complex.Where(d => d.IsActive == true && d.PKComplexRoomID.HasValue).Select(d => d.PKComplexRoomID.Value).ToList();`

# jquery - 用皇家滑块和砖石初始化 javascript

> ID：14416046
> 
> 赞同：1
> 
> 时间：2013-01-19T15:54:43.310
> 
> 标签：jquery, jquery-plugins, slider, initialization, jquery-masonry

对不起，菜鸟类型的问题。下面我的JS有问题。以下这些元素与 RoyalSlider 相关：[http](http://dimsemenov.com/plugins/royal-slider/documentation/) ://dimsemenov.com/plugins/royal-slider/documentation/和 Masonry。

当我将砌体调用放在 JS 的底部时，它不会加载。如果我将它放在顶部，它会加载，但会取消所有滑块调用。

即使我将脚本分开并将它们放在单独的调用中：

```
jQuery(document).ready(function($) { 
```

...问题仍然存在（将一个呼叫置于另一个之上，取消另一个呼叫）。

这是我的初始化脚本：

```
jQuery(document).ready(function($) { 

var rsi = $('#slideshow').royalSlider({
    startSlideId: 1,
    transitionSpeed: 300,
    slidesSpacing: 0,
    loop: true,
    autoHeight: false,
    arrowsNav: false,
    fadeinLoadedSlide: true,
    controlNavigationSpacing: 0,
    controlNavigation: 'tabs',
    imageAlignCenter:true,
    loopRewind: false,
    numImagesToPreload: 3,
    usePreloader: true,
    keyboardNavEnabled: false,
    sliderDrag: false,
    autoScaleSlider: true,  
    autoScaleSliderWidth: 980,     
    autoScaleSliderHeight: 653,
    allowCSS3: true,
    autoPlay: {
      enabled: true,
      pauseOnHover: true,
      delay: 4500,
      stopAtAction: false
    },
    thumbs: {
      firstMargin: false,
      spacing: 0,
      fitInViewport: true
    }

    }).data('royalSlider');
        $('#next').click(function() {
        rsi.next();
    });
        $('#prev').click(function() {
        rsi.prev();
    });

var slider = $('#wrp_hero');
    slider.after(slider.find('.rsNav'));

var rsi2 = $('#slider').royalSlider({
    transitionType: 'slide',
    arrowsNav: false,
    fadeinLoadedSlide: false,
    controlNavigationSpacing: 0,
    controlNavigation: 'bullets',
    loop: false,
    loopRewind: false,
    keyboardNavEnabled: true,
    autoScaleSlider: false,
    sliderDrag: false,
    autoHeight: true
});

var $container = $('#portfolio');
    $container.imagesLoaded( function(){
    $container.masonry({
    itemSelector : '.box'
    });
});

//end doc ready function    
}); 
```

这是在我的 HTML 文档底部的 body 标记上方。s.js 是我的初始化脚本（如上）：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/j/l/jquery-1.8.3.min.js"><\/script>')</script>
<script src="/assets/j/l/masonry.2.1.07.min.js"></script>
<script src="/assets/j/l/royalslider.min.js"></script>
<script src="/assets/j/p.js"></script>
<script src="/assets/j/s.js"></script>
<script>
  var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script> 
```

谁能指出我正确的方向？

# flash - 从 Flash Player 接收的参数的字符编码

> ID：14416051
> 
> 赞同：0
> 
> 时间：2013-01-19T15:55:20.817
> 
> 标签：flash, apache-flex, tomcat, servlets, character-encoding

我在解码由 Flash Player HttpService（来自 Spark 表单的数据）发送并在 Java Servlet 中接收的参数时遇到问题。这是HttpService和Form的客户端代码：

```
<mx:HTTPService id="submitForm" result="onResultSend(event)" method="POST" url="{EVMServerConnection.SERVER_ADDRESS}/UserSubmitionServlet" useProxy="false" resultFormat="text">
        <mx:request xmlns="">
            <login>{login.text}</login>
            <password>{password.text}</password>
            <email>{email.text}</email>
            <userName>{userName.text}</userName>
            <secondName>{secondName.text}</secondName>
            <gender>{String(gender.selectedItem)}</gender>
            <countryKey>{String(country.selectedItem)}</countryKey>
            <city>{city.text}</city>
            <dateOfBirth>{String(dayOfBirth.selectedItem) + String(monthOfBirth.selectedItem) + String(yearOfBirth.selectedItem)}</dateOfBirth>
        </mx:request> 
    </mx:HTTPService> 
```

小服务程序方法：

```
private void registerUser(HttpServletRequest request, HttpServletResponse response) throws UnsupportedEncodingException {
    //request.setCharacterEncoding("UTF-16LE");
    System.out.println(request.getCharacterEncoding());
    String login = request.getParameter("login");
    String password = request.getParameter("password");
    String email = request.getParameter("email");
    //String userName = DataUtils.getUTF8FromUTF16String( request.getParameter("userName") );
    //String userName = request.getParameter("userName");
    byte[] bytes = request.getParameter("userName").getBytes();
    String userName = new String(bytes , "Unicode" );
    System.out.println("UserName: " + userName);
    String secondName = request.getParameter("secondName");
    String gender = request.getParameter("gender");
    boolean isMale = false;
    if (gender != null)
        isMale = !gender.equals("1");
    //String countryKey = request.getParameter("countryKey");
    String city = request.getParameter("city");
    String dateOfBirth = request.getParameter("dateOfBirth");
    Date dateDateOfBirth = null; 
```

当我尝试在控制台上显示用户名时，我得到了中文标志，虽然它应该是波兰字母。我尝试在 new String() 中使用 UTF-16、UTF-16LE、UTF-16BE 而不是 Unicode 参数，但结果相似。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T22:48:07.340

有用的是我正在使用的 Apache Tomcat 7 提供的课程。我在 web.xml 中添加了 SetCharacterEncodingFilter，现在一切正常，我可以以普通方式读取参数（通过 String name = request.getParameter("name") ）

```
...
<filter>
    <filter-name>SetCharacterEncoding</filter-name>
    <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
</filter>
<filter-mapping>
    <filter-name>SetCharacterEncoding</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
... 
```

# android - Android：UPnP 设备扫描仪示例

> ID：14416065
> 
> 赞同：1
> 
> 时间：2013-01-19T15:57:55.963
> 
> 标签：android, upnp

我想知道是否有人有我可以导入到 Eclipse 的 UPnP 设备扫描仪的示例。我想要这个，因为当我看到它在模拟器中的作用时，我可以更容易地理解它是如何工作的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T13:38:26.497

我假设“设备扫描仪”是指“媒体控制器”，即 DMC。如果您坚持在 Android 模拟器中使用 DMC，那么您可能可以使用[Cling UPnPBrowser](http://4thline.org/projects/download/misc/)，这基本上是如何在 Android 中使用 Cling 的一个工作示例。

在模拟器中进行观察和调试也不必要地乏味——如果你想学习 UPnP，那么 Android 就不是那么回事了。从 UPnP 的角度来看，平台没有任何区别。[相应的桌面应用程序](http://4thline.org/projects/cling/workbench/)是完全平等的（关于 UPnP 内部）并且玩起来更舒服。

另外，我建议不要深入研究代码，而是从[一些基本文档](http://upnp.org/specs/av/UPnP-av-AVArchitecture-v1-20020625.pdf)开始，这样即使 DMC 不要求任何内容，您也可以知道 DMC 发送到网络的内容和网络上的其他嗡嗡声。

# autotools - Autoconf 附加到输出变量和程序特定的 LIBS

> ID：14416072
> 
> 赞同：1
> 
> 时间：2013-01-19T15:58:39.060
> 
> 标签：autotools, autoconf, automake

在 configure.ac 中使用 autoconf 我需要附加到输出变量。

具体来说，我想为我的每个程序（Makefile.am 中的 myprogram1 和 myprogram2）以不同的方式附加到 LIBS 变量。让我们想象一下 myprogram1 需要 -lboost_python 而 myprogram2 需要 -losg。

本质上，有些程序需要某些库，而有些则不需要。这是我正在做的一个例子。当然，AC_SUBST 根据我的理解做了一个分配（= vs +=），所以这是行不通的。

```
AC_CHECK_LIB([boost_python], [main], [AC_SUBST([myprogram1_LIBS], ["-lboost_python"])                      
  AC_DEFINE([HAVE_LIBBOOST_PYTHON], [1], [Define if you have libboost_python])],                  
  [AC_MSG_FAILURE([boost_python library not found])])  
AC_CHECK_LIB([osg], [main], [AC_SUBST([myprogram2_LIBS], ["-losg"])                      
  AC_DEFINE([HAVE_LIBOSG], [1], [Define if you have libosg])],                  
  [AC_MSG_FAILURE([osg library not found])]) 
```

我需要的是用第一个库构建 myprogram1_SOURCES，用第二个库构建 myprogram2_SOURCES。

我可以使用 AC_APPEND_SUBST 类型的宏吗？和/或有没有更好的方法让我做我需要做的事情来构建不同的程序并链接不同的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:10:13.453

一旦添加了依赖于两者的 myprogram3，`osg`您`boost`可能会发现将库的检查与它们的使用分开会更方便。

例如`configure`，仅用于确定存在什么，并用于`Makefile`构造正确的编译命令。

例如（配置.ac）：

```
AC_CHECK_LIB([boost_python], [main], [AC_SUBST([BOOST_LIBS], ["-lboost_python"])                      
  AC_DEFINE([HAVE_LIBBOOST_PYTHON], [1], [Define if you have libboost_python])],                  
  [AC_MSG_FAILURE([boost_python library not found])])  
AC_CHECK_LIB([osg], [main], [AC_SUBST([OSG_LIBS], ["-losg"])                      
  AC_DEFINE([HAVE_LIBOSG], [1], [Define if you have libosg])],                  
  [AC_MSG_FAILURE([osg library not found])]) 
```

和（Makefile.am）

```
myprogram1_LDADD = @BOOST_LIBS@
myprogram2_LDADD = @OSG_LIBS@
myprogram3_LDADD = @BOOST_LIBS@ @OSG_LIBS@ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T22:49:36.747

我假设你的`AC_CHECK_LIB`电话和这样的事情是正确的（如果他们没有，你是否尝试过使用[autoconf 存档](http://www.gnu.org/software/autoconf-archive/)中的宏（特别是[`AX_BOOST_PYTHON`](http://www.gnu.org/software/autoconf-archive/ax_boost_python.html#ax_boost_python)））？我不敢相信 boost python 和 osg 都提供`main`.

无论如何，要按要求回答问题，您不必`AC_SUBST`一次提供 'd 变量的内容，因此您可以执行以下操作：

```
myprogram1_LIBS=""
AX_BOOST_PYTHON
myprogram1_LIBS="$myprogram1_LIBS $BOOST_PYTHON_LIB"
# ...
AC_SUBST([myprogram1_LIBS]) 
```

PS 将库添加到程序的变量是[`LDADD`或`myprogram1_LDADD`](http://www.gnu.org/software/automake/manual/html_node/Linking.html)。

# c++ - C ++（VS2012）stdio：如果该字节为09h，则无法读取该字节文件

> ID：14416073
> 
> 赞同：0
> 
> 时间：2013-01-19T15:58:39.047
> 
> 标签：c++, stdio

代码非常简单。

```
unsigned char a_byte;
ifstream a_file("C:/file.bin", ios_base::binary);
if (a_file.is_open() && a_file.good())
{
    a_file.seekg(0);
    a_file >> a_byte;
    a_file.close();
} 
```

问题是它不会从单字节文件中读取 09h - 我只是在 a_byte var 中得到零。它确实适用于不同的值。什么原因？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T16:04:10.240

流类`operator>>`在读入目标变量之前会跳过空格。这里char值`09h`是TAB，算作空格，跳过。

如果您想读取每个字符，请尝试该`get`功能。

# php - PHP类如何输出这个方法

> ID：14416074
> 
> 赞同：-3
> 
> 时间：2013-01-19T15:58:39.620
> 
> 标签：php, class, methods

嗨，正如我在上一个问题中提到的，我正在学习 php 中的类和方法，所以我还有另一个问题要了解如何使用此查询方法在主题中输出结果。

我目前正在尝试使用 WordPress，所以请考虑一下。然而，它对于 WordPress 而不是太通用，而是逻辑。

```
<?php

class get_user_widget
{

    // other mentods are here which is not related to below method

    public static function get_users() {
        global $wpdb;        

        $query = "SELECT id, user_login FROM $wpdb->users ORDER BY user_registered DESC";
        $users = $wpdb->get_results($query);

        // here I am using foreach so is it okay or while loop is right to use?
        foreach ($users as $users)
            $rs[] = $users;

        return count($rs) ? $rs : array();

    }

}

?> 
```

那么如何在主题中使用它来按注册日期呈现用户的输出列表呢？我已经检查了 print_r() 和连接，一切都很好，并且在数组中得到输出，但需要使用 html。

非常感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:22:18.213

该类可以这样使用：

```
$array = get_user_widget::get_users();
echo "<ul>";
foreach($array as $user) {
echo "<li>".$user->user_login."</li>";
}
echo "</ul>"; 
```

编辑：

```
class get_user_widget
{

    public static function get_users() {
        global $wpdb;        

        $query = "SELECT id, user_login FROM $wpdb->users ORDER BY user_registered DESC";
        $users = $wpdb->get_results($query);

        if(!empty($users)) {
             return $users;
        }
        else {
             $fakeuser = new stdClass();
             $fakeuser->user_login = "No users in database";
             return array($fakeuser);
        }
    }

} 
```

# google-maps - 对于开发基于位置的提醒移动应用程序，哪个好......谷歌地图或诺基亚地图

> ID：14416075
> 
> 赞同：0
> 
> 时间：2013-01-19T15:58:43.113
> 
> 标签：google-maps, java-me, gps, here-api

我正在 j2me 中开发基于 GPS 的位置提醒。我对我使用的地图有点困惑？？.....谷歌地图和诺基亚地图。哪一个可以让我很好地工作......我的应用程序的工作如下： -

- 用户将向应用程序提供一个字符串以搜索他/她想要的地方。

- 然后根据给定的字符串应用程序将通过在地图上指向标记在地图上显示一个地方。

-用户可以保存那个地方，或者他/她可以通过点击地图或任何其他方式选择一个附近的地方而不是搜索的地方。

- 应用程序将保存搜索到的地点坐标并在到达该地点附近时提醒。

- 当应用程序提醒用户已经存储的地方......那个地方应该通过指向一个标记以及他离目的地的距离来显示在地图上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:22:14.057

The real choice here lies in whether to use a RESTful API like the Google Static Maps (or Nokia's [RESTful Maps](http://developer.here.net/map_image)) or to use a native Java ME mapping library plugin such as the [Nokia Maps API for Java ME](http://developer.here.net/java). The latter has several major advantages:

*   Static mapping services such as the Google Static Maps API or Nokia's RESTful Map API do not cache or tile the images when requested, therefore each request involves a round trip to the server. If the map on a mobile application needs to be refreshed at any time, using a caching library will result in a reduction in network traffic after around three maps have been displayed. An explanation of this can be found [here](http://www.developer.nokia.com/Community/Wiki/Using_the_RESTful_Map_API_with_Java_ME#Comparision_of_Network_traffic_generated_by_the_RESTful_Map_API_and_Maps_API_for_Java_ME)
*   As the name implies, Google's Static Maps API can only retrieve over http static images for a requested coordinate point, image size, image type and zoom level. Newer libraries offer additional functionality out of the box offering dynamic Map content and touch support, where the user can move around his/her current position, zoom in, zoom out, modify the view mode to satellite or translate an address to a coordinate point and show that on the map, among others. This abstraction of the underlying functionality is hidden from the developer so much less coding is needed in order to achieve the same result .
*   Terms and Conditions for Nokia Maps are easier to fulfil than Google - No legal restrictions of using the API outside a web browser application or need to provide a link to the native Google Maps App (if there is one), or to Google Maps (if there isn't one).
*   Nokia currently offer higher free daily request limits. Nokia Maps API for Java ME supports up to 50,000 render requests per day and per unique IP address (as of January 2012), for Nokia Developer registered users (free of charge) while the limit for Google's Static Maps API is currently 1000 unique (different) image requests per viewer per day.

A couple of years ago there wouldn't be a choice, only RESTful solutions existed, but these days I would say a static http solution should only be used if you want a simple single image

As an abstraction of the underlying services, there are already a full set of examples to cover most of your use cases:

> -User will provide a string to app to search a place of his/her desire. -Then according to given string app will show a place on map by pointing marker on map.

*   [http://www.developer.nokia.com/Commu...PI_for_Java_ME](http://www.developer.nokia.com/Community/Wiki/Geocoding_an_address_with_Maps_API_for_Java_ME)

> -User can save that place or he/she can select a near by place rather than searched place by clicking on map or any other way.

Maybe you need to use a draggable marker:

*   [http://www.developer.nokia.com/Devel...ples/#standard](http://www.developer.nokia.com/Develop/Maps/Maps_API_for_Java_ME/Code_examples/#standard)

Or react to the touch and find a Geocoordinate:

*   [http://www.developer.nokia.com/Commu...PI_for_Java_ME](http://www.developer.nokia.com/Community/Wiki/Handling_map_events_with_Maps_API_for_Java_ME)

> -app will save that searched place coordinates & remind when it reached to near that place.

This is known as geofencing and is covered by the Location API: - [http://www.developer.nokia.com/Resou...ty-events.html](http://www.developer.nokia.com/Resources/Library/Java/#!developers-guides/location-services/example-listening-to-proximity-events.html)

> -When app remind to user about already stored place... that place should show on map by pointing an marker along with the how far he is from his destination.

Showing a Map with a Marker

*   [http://www.developer.nokia.com/Devel...ples/#standard](http://www.developer.nokia.com/Develop/Maps/Maps_API_for_Java_ME/Code_examples/#standard)

For distance calculations, I guess you'd be after the ROUTING example

*   [http://www.developer.nokia.com/Devel...mples/#routing](http://www.developer.nokia.com/Develop/Maps/Maps_API_for_Java_ME/Code_examples/#routing)
*   [http://www.developer.nokia.com/Commu...g_with_Java_ME](http://www.developer.nokia.com/Community/Wiki/Advanced_Routing_with_Java_ME)

Now you *could* re-write and all these services from scratch using RESTful APIs (and then go about debugging your code) , but I'm sure you'll agree it would be much easier to use an existing, working and tested framework for the low level plumbing and then just write your code on top using the services.

It is possible to encapsulate RESTful service in Java ME. As an example, added below is a screenshot from an app encapsulating the [suggestion service](http://developer.here.net/docs/places/topics/resource-suggest.html)

![Places Search](../Images/9eb866dfbd5dcddeed9d86d1aba30254.png)

It is just a lot easier when someone else has already done this work for you and placed it in a library.

# json - Spring 3.2 中带有 AJAX 的 PUT 方法不起作用

> ID：14416078
> 
> 赞同：5
> 
> 时间：2013-01-19T15:59:03.497
> 
> 标签：json, spring, jquery, jackson, put

我正在尝试使用以下 jQuery **1.6通过 AJAX 在 Spring (** **3.2.0** ) 中调用一个方法。

 **```
function updateRoleEnabled(id)
{
    $.ajax({
            datatype:"json",                        
            type: "PUT",
            url: "/wagafashion/ajax/UpdateUserRole.htm",
            data: "id="+id+"&t="+new Date().getTime(),
            success: function(response)
            {
            },
            error: function(e)
            {
                alert('Error: ' + e);
            }
    });
} 
```

它尝试在 Spring 中调用以下方法。

```
@RequestMapping(value=("ajax/UpdateUserRole"), method=RequestMethod.PUT)
public @ResponseBody void updateUserRole(@RequestParam(value=("id")) String id)
{
    System.out.println("id = "+id);
} 
```

FireFox 响应以下错误。

> HTTP 状态 405 - 不支持请求方法“GET”
> 
> 类型状态报告
> 
> 不支持消息请求方法“GET”
> 
> 描述 请求的资源不允许指定的 HTTP 方法（不支持请求方法“GET”）。
> 
> Apache Tomcat/6.0.26

它与`GET`and`POST`方法一起使用，JSON（**与 Jackson-2.1.1 一起**）在应用程序的其他部分也可以正常工作。

* * *

如需查看`dispatcher-servlet.xml`文件，完整内容如下。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"

       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd">

    <context:component-scan base-package="controller" />
    <context:component-scan base-package="validatorbeans" />

    <mvc:annotation-driven content-negotiation-manager="contentNegotiationManager" >
        <mvc:message-converters register-defaults="false">
        <bean id="jacksonMessageConverter" p:supportedMediaTypes="application/json" class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"/>
    </mvc:message-converters>
    </mvc:annotation-driven>

    <bean id="contentNegotiationManager" class="org.springframework.web.accept.ContentNegotiationManagerFactoryBean">
        <property name="favorPathExtension" value="false" />
        <property name="favorParameter" value="false" />
        <property name="ignoreAcceptHeader" value="false" />
        <property name="mediaTypes" >
            <value>
                atom=application/atom+xml
                html=text/html
                json=application/json
                *=*/*
            </value>
        </property>
    </bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>
    <bean class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
        <property name="exceptionMappings">
            <props>
                <prop key="org.springframework.web.multipart.MaxUploadSizeExceededException">
                    fileUploadingFailure
                </prop>
            </props>
        </property>
    </bean>
    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="index.htm">indexController</prop>
            </props>
        </property>
    </bean>

    <bean id="viewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver"
          p:prefix="/WEB-INF/jsp/"
          p:suffix=".jsp" />

    <bean name="indexController"
          class="org.springframework.web.servlet.mvc.ParameterizableViewController"
          p:viewName="index" />
</beans> 
```

如何制作除 Spring 3.2 之外的 HTTP 方法`GET`并`POST`在 Spring 3.2 中工作？

* * *

**编辑：**

根据下面的评论，以下是我的整个`web.xml`文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/applicationContext.xml
            /WEB-INF/spring-security.xml
        </param-value>
    </context-param>
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>NoCacheFilter</filter-name>
        <filter-class>filter.NoCacheFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>NoCacheFilter</filter-name>
        <url-pattern>/admin_side/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>FileUploadFilter</filter-name>
        <filter-class>com.ckfinder.connector.FileUploadFilter</filter-class>
        <init-param>
            <param-name>sessionCookieName</param-name>
            <param-value>JSESSIONID</param-value>
        </init-param>
        <init-param>
            <param-name>sessionParameterName</param-name>
            <param-value>jsessionid</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>FileUploadFilter</filter-name>
        <url-pattern>
                    /ckfinder/core/connector/java/connector.java
     </url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>multipartFilter</filter-name>
        <filter-class>org.springframework.web.multipart.support.MultipartFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>multipartFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>httpMethodFilter</filter-name>
        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>httpMethodFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>openSessionInViewFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
        <init-param>
            <param-name>singleSession</param-name>
            <param-value>false</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>openSessionInViewFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <listener>
        <description>ServletContextListener</description>
        <listener-class>listener.UnregisterDatabaseDrivers</listener-class>
    </listener>
    <servlet>
        <servlet-name>ConnectorServlet</servlet-name>
        <servlet-class>com.ckfinder.connector.ConnectorServlet</servlet-class>
        <init-param>
            <param-name>XMLConfig</param-name>
            <param-value>/WEB-INF/config.xml</param-value>
        </init-param>
        <init-param>
            <param-name>debug</param-name>
            <param-value>false</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>ConnectorServlet</servlet-name>
        <url-pattern>
                    /ckfinder/core/connector/java/connector.java
            </url-pattern>
    </servlet-mapping>

     <listener>
        <listener-class>
          org.springframework.security.web.session.HttpSessionEventPublisher
        </listener-class>
      </listener>

    <error-page>
        <description>Missing login</description>
        <error-code>401</error-code>
        <location>/WEB-INF/jsp/admin_side/ErrorPage.jsp</location>
    </error-page>

    <error-page>
        <description>Forbidden directory listing</description>
        <error-code>403</error-code>
        <location>/WEB-INF/jsp/admin_side/ErrorPage.jsp</location>
    </error-page>

    <error-page>
        <description>Missing page</description>
        <error-code>404</error-code>
        <location>/WEB-INF/jsp/admin_side/ErrorPage.jsp</location>
    </error-page>

    <error-page>
        <description>Uncaught exception</description>
        <error-code>500</error-code>
        <location>/WEB-INF/jsp/admin_side/ErrorPage.jsp</location>
    </error-page>

    <error-page>
        <description>Unsupported servlet method</description>
        <error-code>503</error-code>
        <location>/WEB-INF/jsp/admin_side/ErrorPage.jsp</location>
    </error-page>

    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T19:10:50.483

除非只使用路径参数，否则处理常规 HTTP PUT 需要更多工作。

[从](https://jira.springsource.org/browse/SPR-5628)Spring 3.1 开始，[`HttpPutFormContentFilter`](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/filter/HttpPutFormContentFilter.html)可用于`@RequestParam`为`application/x-www-form-urlencoded`数据工作：

> `ServletRequest.getParameter*()`在 HTTP PUT 请求期间通过一系列方法使表单编码数据可用的过滤器。
> 
> Servlet 规范要求表单数据可用于 HTTP POST，但不能用于 HTTP PUT 请求。此过滤器拦截内容类型为“ `application/x-www-form-urlencoded`”的 HTTP PUT 请求，从请求正文中读取表单编码的内容，并包装 ServletRequest 以使表单数据可用作请求参数，就像它用于 HTTP POST 请求一样。

然而：这个过滤器[消耗](https://fisheye.springsource.org/browse/spring-framework/spring-web/src/main/java/org/springframework/web/filter/HttpPutFormContentFilter.java?hb=true)了请求的输入流，使得它对转换器不可用，比如[`FormHttpMessageConverter`](https://fisheye.springsource.org/browse/spring-framework/spring-web/src/main/java/org/springframework/http/converter/FormHttpMessageConverter.java?hb=true), like used for `@RequestBody MultiValueMap<String, String>`or `HttpEntity<MultiValueMap<String, String>>`。因此，一旦您在应用程序中[配置](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-form-urlencoded-data)了上述过滤器，当调用使用其他转换器的方法时，您将收到“IOException：流已关闭”，这些转换器也需要原始`application/x-www-form-urlencoded`PUT 数据。

或者，可以使用or手动完成*所有*操作：`@RequestBody``HttpEntity<?>`

```
@RequestMapping(value="ajax/UpdateUserRole", method=RequestMethod.PUT,
    produces = MediaType.TEXT_PLAIN_VALUE)
public @ResponseBody String updateUserRole(
    @RequestBody final MultiValueMap<String, String> data,
    final HttpServletResponse response) {
  Map<String, String> params = data.toSingleValueMap();
  String id = params.get("id");
  String a = params.get("a");
  String b = params.get("b");
  if(id == null || a == null || b == null) {
    response.setStatus(HttpServletResponse.SC_BAD_REQUEST);
    return null;
  }
  return "id = " + id;
} 
```

另请参阅使用或使用[的示例：`WebDataBinder`](https://jira.springsource.org/browse/SPR-7030?focusedCommentId=52425&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-52425)

```
public ResponseEntity<String> updateUserRole(
    final HttpEntity<MultiValueMap<String, String>> entity) {
  Map<String, String> params = entity.getBody().toSingleValueMap();
  String id = params.get("id");
  ... 
```

请注意，对于测试，使用[MockMvc](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/testing.html#spring-mvc-test-framework) `mockMvc.perform(put(url).param(name, value))`实际上也可以处理问题中的代码，即使它在 servlet 容器中会失败。但是 MockMvc 并没有在这样的 servlet 容器中运行，因此有点愚弄你。

MockMvc`.param(name, value)`也可以很好地与`HttpPutFormContentFilter`. 但是在使用 MockMvc 测试`@RequestBody`or时`HttpEntity<?>`，还需要`application/x-www-form-urlencoded`手动创建任何 PUT 内容。喜欢：

```
mockMvc.perform(put(url).content("id=" + URLEncoder.encode(id, "UTF-8")
  + "&a=" + URLEncoder.encode(a, "UTF-8") + "&b=" + ...) 
```

为了能够简单地使用`.param(name, value)`，就像 GET 和 POST 一样，可以定义：

```
public static RequestPostProcessor convertParameters() {
  return new RequestPostProcessor() {
    @Override
    public MockHttpServletRequest postProcessRequest(
        final MockHttpServletRequest request) {
      if ("PUT".equalsIgnoreCase(request.getMethod()) {
        Map<String, String[]> params = request.getParameterMap();
        if (params != null) {
          StringBuilder content = new StringBuilder();
          for (Entry<String, String[]> es : params.entrySet()) {
            for (String value : es.getValue()) {
              try {
                content.append(URLEncoder.encode(es.getKey(), "UTF-8"))
                  .append("=")
                  .append(URLEncoder.encode(value, "UTF-8"))
                  .append("&");
              }
              catch (UnsupportedEncodingException e) {
                throw new IllegalArgumentException("UTF-8 not supported");
              }
            }
          }
          request.setParameters(new HashMap<String, String[]>());
          request.setContent(content.toString().getBytes());
          request.setContentType(MediaType.APPLICATION_FORM_URLENCODED_VALUE);
        }
      }
      return request;
    }
  };
} 
```

...然后`.with(convertParameters())`在旁边使用`.param(name, value)`：

```
mockMvc.perform(put(url)
    .with(convertParameters())
    .param("id", id).param("a", a).param("b", b) ...) 
```

综上所述，简单地使用`HttpPutFormContentFilter`数据`application/x-www-form-urlencoded`确实让生活更轻松。

当浏览器发送的不是`application/x-www-form-urlencoded`数据，而是 JSON 等数据时，尝试映射到`MultiValueMap`将产生 415 Unsupported Media Type。相反，使用类似`@RequestBody MyDTO data`或`HttpEntity<MyDTO> entity`如[Parsing JSON in Spring MVC using Jackson JSON](https://stackoverflow.com/questions/6019562/parsing-json-in-spring-mvc-using-jackson-json/6019761#6019761)中所述的内容。**

# python - Python字典 - 是否可以引用键值？

> ID：14416084
> 
> 赞同：3
> 
> 时间：2013-01-19T15:59:18.327
> 
> 标签：python, dictionary

我想定义字典如下：

```
dict = {
    Player: $key.Name + " takes some action"
} 
```

有没有一种语法可以让我这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:03:37.523

**字典理解**可能会有所帮助。

```
>> players = ["Mark", "Jack", "John"]
>> player_dict = {k: k + " takes some action" for k in players}
>> player_dict
{'John': 'John takes some action', 'Jack': 'Jack takes some action', 'Mark': 'Mark takes some action'} 
```

它们采用`{`*键值*`:`*变量*`for`*生成*`in`*器的形式*`}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:03:09.133

```
class Player(object): 
    def __init__(self, name):
        self.name = name

p1 = Player("bernard")
p2 = Player("hoagie")

t = (p1, p2, ...)
d = {p: p.name + " something something" for p in t} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:03:24.900

听起来您想在分配给该键的值中使用您正在创建的键。是的，这是可能的：

```
playerDict = {Player: Player + " takes some action"} 
```

# java - 如何为 Google Guice 中的特定类型分配默认的“后备”提供程序

> ID：14416085
> 
> 赞同：3
> 
> 时间：2013-01-19T15:59:19.090
> 
> 标签：java, guice

我的用例是这样的：

对象请求特定类型的未绑定@Named 注入。我希望 Guice 告诉我的“后备”提供者名称值是什么（或给我整个注释），以便我的提供者仍然可以提供基于名称值的实现。

因此，@Named 值用作在运行时查找正确实现的键。如果基于@Named 找到了实现，*则*不应咨询提供者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T07:37:08.290

Guice 基本上是从 (annotation, type) 元组到`Provider<T>`. 没有办法将默认绑定绑定到所有未绑定的`@Named`实例，就像将整个双精度范围绑定到 a 中的单个字符串一样`Map<Double, String>`。

如果你有一个方便的数组或`@Named`你想要的所有值的集合，你可以循环它们并将它们全部绑定到某种默认提供程序，然后你可以使用`Modules.override()`或`if`循环中的一个块来破解：

```
public class DefaultNameModule extends AbstractModule() {
  @Override public void configure() {
    for (String name : YOUR_LIST_OF_NAMES) {
      if (properties.contains(name)) {
        bindConstant(properties.get(name)).annotatedWith(Names.named(name));
      } else {
        bind(Foo.class)
            .annotatedWith(Names.named(name))
            .toProvider(new MyProvider(name));
      }
    }
  }

  private static class MyProvider extends Provider<Foo> {
    final String name;

    MyProvider(String name) {
      this.name = name;
    }

    @Override public Foo get() {
      return someValueBasedOn(name);
    }
  }
} 
```

如果这对您的口味来说太复杂了，请记住，您始终可以注入一个单一方法对象的实例，该实例`Properties`为您包装访问权限，并在需要时计算默认值。

# android - 将密钥库添加到 Ksoap2

> ID：14416087
> 
> 赞同：0
> 
> 时间：2013-01-19T15:59:32.847
> 
> 标签：android, ksoap2, android-keystore

我正在尝试使用 Android 2.3.4 使用 SSL 连接到 WDSL Web 服务。它使用不受信任的解冻证书。

我创建了一个带有中间证书和根证书的密钥库，但不知道如何将密钥库添加到 ksoap2。

有谁知道这是否可能或解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:34:14.663

我找到了这个答案。它向您展示了如何创建自己的 TrustManager 并启动它。

[http://randomizedsort.blogspot.co.uk/2010/09/step-to-step-guide-to-programming.html](http://randomizedsort.blogspot.co.uk/2010/09/step-to-step-guide-to-programming.html)

# ios - iOS 的 OpenCV 错误/检测霍夫圆

> ID：14416089
> 
> 赞同：2
> 
> 时间：2013-01-19T15:59:53.053
> 
> 标签：ios, opencv, cmake

我已经尝试了几个小时用 openCV 运行一个 xcode 项目。我已经构建了源代码，将其导入到项目中，并将 #ifdef __cplusplus #import opencv2/opencv.hpp> #endif 包含在 .pch 文件中。

我按照[http://docs.opencv.org/trunk/doc/tutorials/introduction/ios_install/ios_install.html的说明进行操作](http://docs.opencv.org/trunk/doc/tutorials/introduction/ios_install/ios_install.html)

编译时我仍然收到许多 Apple Mach-O 链接器错误。

```
Undefined symbols for architecture i386:
 "std::__1::__vector_base_common<true>::__throw_length_error() const", referenced from: 
```

请帮助我，我真的迷路了..

更新：

错误全部修复，现在我正在尝试检测圆圈..

```
Mat src, src_gray;

cvtColor( image, src_gray, CV_BGR2GRAY );

vector<Vec3f> circles;

/// Apply the Hough Transform to find the circles
HoughCircles( src_gray, circles, CV_HOUGH_GRADIENT, 1, image.rows/8, 200, 100, 0, 0 );

/// Draw the circles detected
for( size_t i = 0; i < circles.size(); i++ )
{
    Point center(cvRound(circles[i][0]), cvRound(circles[i][1]));
    int radius = cvRound(circles[i][2]);
    // circle center
    circle( src, center, 3, Scalar(0,255,0), -1, 8, 0 );
    // circle outline
    circle( src, center, radius, Scalar(0,0,255), 3, 8, 0 );

} 
```

我正在使用上面的代码，但是图像上没有画圆圈..有什么明显的我做错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T16:32:41.130

在我对这个问题的回答中尝试解决方案......

[如何使用 OpenCV 解决 iOS 链接错误](https://stackoverflow.com/questions/14185716/how-to-resolve-ios-link-errors-with-opencv/14186883#14186883)

同样在 github 上，我有[几个](https://github.com/foundry/OpenCVStitch)简单的[工作示例](https://github.com/foundry/OpenCVSquares)- 带有最近构建的 openCV 框架。

NB - OpenCVSquares 比 OpenCVSquaresSL 更简单。后者适用于 Snow Leopard 向后兼容——它包含两个构建的 openCV 框架和 3 个目标，因此如果它可以在您的系统上运行，您最好使用更简单的 OpenCVSquares。

为了调整 OpenCVSquares 以检测圆圈，我建议您从 openCV 发行版中的[Hough Circles c++ 示例](https://github.com/Itseez/opencv/blob/master/samples/cpp/houghcircles.cpp)开始，并使用它来适应/替换`CVSquares.cpp`，`CVSquares.h`例如`CVCircles.cpp``CVCicles.h`

原理是完全一样的：

*   从 c++ 中移除 UI 代码，UI 是在 obj-C 端提供的
*   将 main() 函数转换为头文件中声明的类的静态成员函数。这应该以 Objective-C 消息的形式反映到包装器（它将 obj-c 方法转换为 c++ 函数调用）。

从 Objective-C 端，您将 UIImage 传递给包装器对象，其中：

*   将 UIImage 转换为 cv::Mat 图像
*   将 Mat 传递给 c++ 类进行处理
*   将结果从 Mat 转换回 UIImage
*   将处理后的 UIImage 返回给 Objective-C 调用对象

**更新**

改编后的 houghcircles.cpp 最基本的应该是这样的（我已经用 CVCircles 类替换了 CVSquares 类）：

```
cv::Mat CVCircles::detectedCirclesInImage (cv::Mat img)
{   
    //expects a grayscale image on input
    //returns a colour image on ouput
    Mat cimg;
    medianBlur(img, img, 5);
    cvtColor(img, cimg, CV_GRAY2RGB);
    vector<Vec3f> circles;
    HoughCircles(img, circles, CV_HOUGH_GRADIENT, 1, 10,
                 100, 30, 1, 60 // change the last two parameters
                 // (min_radius & max_radius) to detect larger circles
                 );
    for( size_t i = 0; i < circles.size(); i++ )
        {
        Vec3i c = circles[i];
        circle( cimg, Point(c[0], c[1]), c[2], Scalar(255,0,0), 3, CV_AA);
        circle( cimg, Point(c[0], c[1]), 2, Scalar(0,255,0), 3, CV_AA);
        }
    return cimg;
    } 
```

请注意，为简单起见，输入参数被简化为一个 - 输入图像。不久我将在 github 上发布一个示例，其中将包含一些与 iOS UI 中的滑块控件相关的参数，但您应该先让这个版本工作。

由于函数签名已更改，您应该沿着链跟踪它......

更改 houghcircles.h 类定义：

```
 static cv::Mat detectedCirclesInImage (const cv::Mat image); 
```

修改 CVWrapper 类以接受一个类似结构的方法，该方法调用`detectedCirclesInImage`

```
 + (UIImage*) detectedCirclesInImage:(UIImage*) image
    {
        UIImage* result = nil;
        cv::Mat matImage = [image CVGrayscaleMat];
        matImage = CVCircles::detectedCirclesInImage (matImage);
        result = [UIImage imageWithCVMat:matImage];
        return result;
    } 
```

请注意，我们将输入 UIImage 转换为灰度，因为 houghcircles 函数需要输入灰度图像。*注意拉取我的 github 项目的最新版本，我在 CVGrayscaleMat 类别中发现了一个错误，该类别现已修复*。输出图像是彩色的（颜色应用于灰度输入图像以挑选出找到的圆圈）。

如果您希望输入*和*输出图像是彩色的，您只需要确保对输入图像进行灰度转换以发送到 Houghcircles() - 例如`cvtColor(input_image, gray_image, CV_RGB2GRAY)`；并将您找到的圆圈应用于颜色输入图像（成为您的返回图像）。

最后在您的 CVViewController 中，将您的消息更改为 CVWrapper 以符合这个新签名：

```
 UIImage* image = [CVWrapper detectedCirclesInImage:self.image]; 
```

如果您遵循所有这些细节，您的项目将产生圆形检测结果。

 **[现在在 Github 上](https://github.com/foundry/OpenCVCircles)**更新 2**
OpenCVCircles 使用滑块调整 HoughCircles() 参数**

# asp.net-mvc-3 - 使用 AjaxExtensions.RouteLink

> ID：14416093
> 
> 赞同：0
> 
> 时间：2013-01-19T16:00:27.370
> 
> 标签：asp.net-mvc-3

为了解决 ASP.net MC3 中的特定要求，我想使用 AjaxExtensions.RouteLink 但我想知道如何在视图中使用它。例如：

```
@AjaxExtensions.RouteLink(ajaxHelper, link.Text, new { controller="Home",action="List",
                                                            category = id }, 
                                                            new AjaxOptions { UpdateTargetId = "itemList",InsertionMode=InsertionMode.Replace },
                                                            new { @class = "item" }) 
```

但是在运行它时会抛出错误“当前上下文中不存在名称'ajaxHelper'”。由于我是这种用法的新手，它阻止了我。任何人都可以分享一些使用这个的细节吗？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:03:53.327

改用下面的东西：

```
@foreach (var link in Model)
{
    if (link.SubCat.Count == 0)
    {    

    @Ajax.RouteLink(link.Text, new
                                    {
                                       controller = "Home",
                                       action = "List",
                                       pId = link.Id,
                                       parentCatId=link.ParentCatId
                                   },

                                    new AjaxOptions
                                    {
                                        UpdateTargetId = "itemList", //div name
                                        InsertionMode = InsertionMode.Replace
                                    },
                                    new { @class = "menuitem" }
                      )

    } 
```

上面的代码在 PartialView 中。但现在的问题是，它不会将结果更新为提供的目标。相反，它将结果替换为整个页面。希望现在有人可以给我一个线索来摆脱这个。

# apache - Tomcat 在 Http 状态 500 错误的错误报告中未显示完整的堆栈跟踪

> ID：14416096
> 
> 赞同：1
> 
> 时间：2013-01-19T16:00:59.323
> 
> 标签：apache, tomcat, safari

Tomcat 在某些客户端的 Http 状态 500 错误的错误报告中未显示完整的堆栈跟踪。当我从不同的客户端（机器）尝试时，它会显示堆栈跟踪。

我的问题是，

Browser/Apache Config 中是否有任何设置可以在错误报告中获取完整的堆栈跟踪？

# prolog - 使用 prolog 脚本时如何打印统一结果？

> ID：14416099
> 
> 赞同：3
> 
> 时间：2013-01-19T16:01:15.383
> 
> 标签：prolog, gnu-prolog, unification

我正在使用 prolog 脚本来执行所有查询，代码如下：

```
:- initialization(run).

writeln(T) :- write(T), nl.

queryAll :-
    forall(query(Q), (Q ->
        writeln('yes':Q) ;
        writeln('no ':Q))).

run :-
    queryAll,
    halt.

query( (1,2,3) = (X,Y,Z) ). 
```

问题是，`queryAll`当我想看到统一结果时，只会打印“是”或“否”：

```
X = 1
Y = 2
Z = 3 
```

如何在序言中做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T09:16:57.063

在 GNU Prolog 中，您可以在将`end_of_term(eof)`选项传递给`read_term_from_atom`. 例如，：

```
| ?- read_term_from_atom('X+Y = 1+2', T, [variable_names(L),end_of_term(eof)]).

L = ['X'=A,'Y'=B]
T = (A+B=1+2)`` 
```

这意味着当遇到 EOF（文件结尾）时，它被视为正在读取的术语的结尾。从原子读取时，EOF 对应于原子的字符串表示形式的 then。

这可以在某些情况下简化事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:12:25.290

这里有一个 gprolog 内置示例，可能有助于为您的客户构建更好的体验：

```
| ?- read_term_from_atom('X+Y = 1+2.', T, [variable_names(L)]).

L = ['X'=A,'Y'=B]
T = A+B=1+2

yes
| ?- read_term_from_atom('X+Y = 1+2.', T, [variable_names(L)]),call(T).

L = ['X'=1,'Y'=2]
T = 1+2=1+2 
```

请注意，您应该更改 query/1 内容：而不是

```
query( (1,2,3) = (X,Y,Z) ). 
```

应该

```
query( '(1,2,3) = (X,Y,Z).' ). % note the dot terminated atom 
```

然后循环可能是，例如

```
queryAll :-
    forall(query(Q), 
        ( read_term_from_atom(Q, T, [variable_names(L)]),
          ( T -> writeln('yes':L) ; writeln('no ':Q) )
        )). 
```

我从[这个](https://stackoverflow.com/a/7948525/874024)答案中得到了提示。

# facebook - Facebook 注册和登录应用，需要指导

> ID：14416100
> 
> 赞同：0
> 
> 时间：2013-01-19T16:01:18.847
> 
> 标签：facebook, registration

我已经使用 Facebook 应用程序注册和登录我的网站（在 PHP 中）。对于各位专家来说，问题很简单。当我尝试使用我用于 Facebook 开发人员登录的电子邮件 ID 通过 Facebook 登录时，我成功了，但如果我提供任何其他电子邮件 ID，我将无法登录。前任。x123@yahoo.com 是我用于 Facebook 开发人员帐户的 id，a123@gmail.com 是普通的 Facebook 用户帐户。现在，如果使用 x123@yahoo.com 登录我的网站，我会成功并重定向到个人资料页面）但是如果我使用 a123@gmail.com 登录我的网站，我会失败，我会从我尝试过的同一页面返回登录 任何指导都将帮助我前进 我被困在这里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:57:13.103

通过阅读您的问题，我认为您的应用程序处于沙盒模式。如果您想在其他配置文件上进行测试，您应该考虑创建[Test Users](https://developers.facebook.com/docs/test_users/ "测试用户")。

根据您的目的，您可以创建另一个应用程序来进行测试（因此不需要处于沙盒模式）。

# forms - 如何使脚本适用于具有多个表单的页面上的特定表单

> ID：14416106
> 
> 赞同：0
> 
> 时间：2013-01-19T16:02:18.677
> 
> 标签：forms

我正在使用禁用提交按钮的脚本，除非用户单击并浏览要上传的文件。

```
 $(document).ready(function() {
                    $('input:submit').attr('disabled',true);
                    $('input:file').change(
                        function(){
                            if ($(this).val()){
                                $('input:submit').removeAttr('disabled'); 
                            }
                            else {
                                $('input:submit').attr('disabled',true);
                            }
                        });
                }); 
```

我在同一页面上有 2 个表单，我希望这与特定表单相关联。

第一种形式：

```
<form action="" method="post" name="name1" id="id1"> 
```

第二种形式：

```
<form action="" method="post" name="name2" id="id2"> 
```

javascript中有没有办法将它专门附加到#id1而不是id2？

我会这样放置吗？ `$('#id1.input:submit')`- 将 id 添加到脚本中的符号或语法是什么？抱歉，我仍在学习您可以组合哪些部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:30:44.630

替换`$('input:submit').attr('disabled',true);`为
`$('form#id1 input:submit').attr('disabled',true);`

# java - int 数组到 BufferedImage

> ID：14416107
> 
> 赞同：5
> 
> 时间：2013-01-19T16:02:21.140
> 
> 标签：java, bufferedimage, pixels

我正在使用`Robot`该类制作一个打印屏幕，并将 BufferedImage 转换为一个 int 数组。然后我想将 int 数组转换回 bufferedimage 但这会出错。这是我的代码：

```
Dimension screen = Toolkit.getDefaultToolkit().getScreenSize();
BufferedImage printscreen = robot.createScreenCapture(new Rectangle(screen));
int[] pixels = ((DataBufferInt) printscreen.getRaster().getDataBuffer()).getData();

BufferedImage image = new BufferedImage(screen.width, screen.height, BufferedImage.TYPE_INT_RGB);
WritableRaster raster = (WritableRaster) image.getRaster();
raster.setPixels(0, 0, screen.width, screen.height, pixels); 
```

但我得到了错误：`ArrayIndexOutOfBoundsException: 2073600`但为什么？

我在这条线上遇到了异常：

```
raster.setPixels(0, 0, screen.width, screen.height, pixels); 
```

编辑：如果我将第二个缓冲图像类型更改为 TYPE_BYTE_GRAY，它将起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-21T12:05:12.420

```
int[] bitMasks = new int[]{0xFF0000, 0xFF00, 0xFF, 0xFF000000};
SinglePixelPackedSampleModel sm = new SinglePixelPackedSampleModel(
        DataBuffer.TYPE_INT, width, height, bitMasks);
DataBufferInt db = new DataBufferInt(pixels, pixels.length);
WritableRaster wr = Raster.createWritableRaster(sm, db, new Point());
BufferedImage image = new BufferedImage(ColorModel.getRGBdefault(), wr, false, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T13:21:56.810

变成：

```
getRaster().getPixels(0, 0, screen.width, screen.height, pixels) 
```

它有效！无论如何感谢您的帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:10:22.387

当`ArrayIndexOutOfBounds`您尝试访问超出数组大小的索引处的元素时，会发生异常。在这种情况下，您将数组传递给[setPixels](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/image/WritableRaster.html#setPixels%28int,%20int,%20int,%20int,%20int%5B%5D%29)方法，根据其 javadocs，该方法不会显式检查数组的边界或大小。因此，您应该在调用该方法之前明确地执行此操作。例如

```
 if(x >= 0 && x < arr.length) {
        // some code
    } 
```

这是`SampleModel`WritableRaster 使用的类的相关代码。

```
 public int[] getPixels(int x, int y, int w, int h,
                           int iArray[], DataBuffer data) {

        int pixels[];
        int Offset=0;

        if (iArray != null)
            pixels = iArray;
        else
            pixels = new int[numBands * w * h];

        for (int i=y; i<(h+y); i++) {
            for (int j=x; j<(w+x); j++) {
                for(int k=0; k<numBands; k++) {
                    pixels[Offset++] = getSample(j, i, k, data);
                }
            }
        }

    return pixels;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-16T08:54:59.423

`pixels`in的大小`raster.setPixels(0, 0, screen.width, screen.height, pixels);`应该是`width*height*3`你设置的时候`BufferedImage.TYPE_INT_RGB`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-08T10:17:12.370

```
BufferedImage image = new BufferedImage(screen.width*3, screen.height,BufferedImage.TYPE_INT_RGB);
WritableRaster raster = (WritableRaster) image.getRaster();

raster.setPixels(0, 0, screen.width*3, screen.height, pixels); 
```

# android - Android SQLiteOpenHelper: 错误代码 = 1, msg = near "create": 语法错误

> ID：14416112
> 
> 赞同：0
> 
> 时间：2013-01-19T16:02:40.940
> 
> 标签：android, database, sqliteopenhelper

这是我创建数据库表的代码：

```
public void onCreate(SQLiteDatabase db) {
        Log.i(TAG, "Inizio creazione database MessagesDB");
        String CREATE_TABLE = "CREATE TABLE " + TABLE2 + " (" + Key_key + " TEXT PRIMARY KEY, " + Key_ID + " INTEGER NOT NULL, " + Key_author + " TEXT NOT NULL, " 
+ Key_date_create + " TEXT NOT NULL, " + Key_sender + " TEXT, " 
+ Key_date_sent + " TEXT, " + Key_recipient + " TEXT, " 
+ Key_date_received + " TEXT, " + Key_message + " TEXT, " 
+ Key_message_path + " TEXT, " + Key_size + " INTEGER" + ");";  
        try {
            db.execSQL(CREATE_TABLE); 
            Log.i(TAG, "Creazione database MessagesDB avvenuta con successo");
        }
        catch (Exception e){
            Log.e(TAG, "Errore nella create table messages", e);
        }   
} 
```

但我在 logcat 中有一个错误：

```
:Errore nella create table messages
:android.database.sqlite.SQLiteException: near "create": syntax error: CREATE TABLE messagesDB (_key TEXT PRIMARY KEY, _id INTEGER NOT NULL, author TEXT NOT NULL, date create TEXT NOT NULL, sender TEXT, date_sent TEXT, recipient TEXT, date_received TEXT, message TEXT, message_path TEXT, size INTEGER); 
```

我不明白为什么会出现这个错误。有人可以帮我理解吗？（对不起，我的英语不好）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:07:50.327

`create`从中删除`date create TEXT NOT NULL`。您似乎是错误地添加了它。

看起来`Key_date_create`有价值`date create`，也许你的意思是`date_create`？

# javascript - 如何用 Dojo 组织异步代码？

> ID：14416119
> 
> 赞同：0
> 
> 时间：2013-01-19T16:03:33.230
> 
> 标签：javascript, design-patterns, asynchronous, dojo, restful-url

我正在创建一个带有动态 TAB（来自 RESTful 的数据）的 webapp，每个 TAB 都有一个 dgrid，我从 RESTful 中获取列，从 RESTful 中获取行。我用 XHR 和 MemoryStore 让一切都很好，但我现在需要从 XHR 更改为 JsonRest，因为我需要向服务器传递一个 HTTP Range。

我很难在 Dojo 中使用异步调用来组织我的代码。我给你举个例子：

```
method1() - Sync 
method2() - Async (JsonRest) 
method3() - Sync 
```

只有在 method2() 准备好之后，才执行 method3() 的最佳方式是什么？

我找到了一个名为 WHEN 的类。看起来不错。但是您如何在 dojo 中使用异步应用程序？

我现在最大的问题：我不能按方法分离我的代码，我需要把我所有的代码放在 JsonRest 的 promise 函数中（THEN）。因为在 THEN 里面我不能访问另一个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T21:04:44.817

我同意使用 Dojo 的 promise 实现的建议。

如果您不习惯承诺，这可能会帮助您更快地理解它：http: [//jsfiddle.net/27jyf/9/](http://jsfiddle.net/27jyf/9/)。另一个不错的功能是错误处理，我鼓励您在完成基本排序后阅读此内容。

```
require(["dojo/Deferred", "dojo/when"], function(Deferred, when) {
    var sayHello = function() { return 'hello' };
    var sayWorld = function() {
        var deferred = new Deferred();        
        window.setTimeout(function() {
            deferred.resolve('world');
        }, 1000);        
        return deferred.promise;
    };
    var sayBang = function() { return '!' };

    //This will echo 'hello world !'
    //That's probably how you want to sequence your methods here
    var message = [];
    message.push(sayHello());
    sayWorld().then(function(part) {
        message.push(part);
        message.push(sayBang());
        console.debug(message.join(' '));
    });    

    //This will also echo 'hello world !'
    //This probably not the syntax that you want here, 
    //but it shows how to sequence promises and what 'when' actually does
    var message2 = [];
    when(sayHello())
    .then(function(part) {
        message2.push(part);
        return sayWorld();
    })
    .then(function(part) {
        message2.push(part);
        return when(sayBang());
    })
    .then(function(part) {
        message2.push(part);
        console.debug(message2.join(' '));
    }); 

    //Provided the behavior observed above, this will echo 'hello !'
    //dojo/when allows you to use the same syntax for sync and async... 
    //but it does not let you magically write async operations in a sync syntax
    //'world' will be pushed into the array a second later, after the message has already been echoed
    var message3 = [];
    message3.push(sayHello());
    when(sayWorld(), function(part) {
        message3.push(part);
    });
    message3.push(sayBang());
    console.debug(message3.join(' '));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:40:32.300

您可以使用[promise api](http://dojotoolkit.org/reference-guide/1.8/dojo/promise.html)以指定的顺序运行 async/sync 方法。

# python - ValueError: Key() 必须有偶数个位置参数。Python 应用引擎 NDB

> ID：14416124
> 
> 赞同：1
> 
> 时间：2013-01-19T16:03:45.150
> 
> 标签：python, google-app-engine, app-engine-ndb

ValueError: Key() 必须有偶数个位置参数。

当我尝试：

```
class MyStorage(ndb.Model):
 my_attr = ndb.StringProperty()

 my = MyStorage(parent=ndb.Key('mylist'), key_name='myattr', my_attr = 'hello') 
```

我究竟做错了什么？

我的目标是将一些 MyStorage 实体存储在具有键“mylist”的父实体下。我不想将任何东西附加到父级本身，也没有实例化它，但是从文档中我没有得到必要的印象。

如何以我上面正确描述的方式持久保存 MyStorage 实体？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T16:07:31.003

构造[`ndb.Key()`函数](https://developers.google.com/appengine/docs/python/ndb/keyclass#Constructors)需要一对`kind`和`id`值，而不是一个字符串：

```
ndb.Key(model1, id1, model2, id2, ..) 
```

可以以不同的方式指定这些对，或者您需要提供一个`urlsafe`参数（这是一个 websafe-base64 编码的序列化引用）。

# algorithm - 如何用常数值填充二维数组，效率比 n^2 更好？

> ID：14416128
> 
> 赞同：4
> 
> 时间：2013-01-19T16:03:53.700
> 
> 标签：algorithm, language-agnostic, matrix

这是一个普遍的问题，它可能适用于任何给定的语言，如 C、C++、Java 等。
我想你实现它的任何方式，你都不能比使用 2 个循环更有效，它的效率为 n^2 .

```
for(i=0;i<n;i++)
 for(j=0;j<n;j++)
  a[i][j]=1; 
```

我最近在一次采访中被问到这个问题，并且想不出更有效的方法。我从面试官那里得到的只是我可以使用递归或将二维数组转换为链表以使其比 n^2 更有效。任何人都知道这是否可能，如果可以，如何？至少在理论上，如果不是在实践中。

**编辑：**实际问题给了我两个单元格的坐标，我必须用 1 填充所有可能的最短路径所采用的路径。例如，如果我有一个 5x5 矩阵，我的两个坐标是 (2,0) 和 ( 3,3)，我必须填写：
(2,0)(2,1)(2,2)(2,3) (3,0)(3,1)(3,2)(3, 3）
同时让其余的细胞保持原样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T16:23:57.480

这取决于你的意思。如果问题是关于普通数组的，这意味着一系列连续的内存位置，并且对于初始化，您的意思是在这个“矩阵”的每个内存位置放置一个值，那么答案是**否定**的，比 O(n*m) 更好是不可能的并且我们可以证明：

让我们假设算法`fill(A[n][m], init_val)`是正确的（即填充 的所有内存位置）具有小于（意味着不是 的一部分）的`A`复杂度，然后足够大，我们将拥有= 内存位置的数量。由于填充内存位置需要一个操作，因此算法可以填充大多数位置[实际上是一半，因为它还必须至少执行一个操作来“选择”不同的内存位置，除非硬件提供组合操作]，这严格小于，这意味着算法不正确。`g(n,m)``O(n*m)``g(n,m)``Ω(n*m)``n``m``g(n,m) < n*m``fill``g(n,m)``n*m``fill`

如果填充内存位置需要恒定时间，这同样适用`k`，您只需选择更大`n`的`m`值。

正如其他已经建议的那样，您可以使用其他数据结构来避免`O(n^2)`初始化时间。amit 建议使用某种惰性求值，它允许您根本不初始化数组，而仅在访问元素时才这样做。

请注意，这`Ω(n^2)`在开始时消除了成本，但需要更复杂的操作来访问数组的元素，并且还需要更多的内存。

目前尚不清楚面试官的意思：将数组转换为链表需要`Ω(L)`时间（其中 L 是数组的长度），因此简单地将整个矩阵转换为链表需要`Ω(n^2)`时间加上真正的初始化。使用递归根本没有帮助，您最终只会出现重复，例如`T(n) = 2T(n/2) + O(1)`这将再次导致渐近复杂性没有任何好处。

作为一般规则，所有算法都必须至少扫描所有输入，除非它们事先具有某种形式的知识（例如，元素已排序）。在您的情况下，要扫描的空间是`Θ(n^2)`，因此每个想要填充它的算法必须至少是`Ω(n^2)`. 任何低于这个复杂度的东西要么做出一些假设（例如内存默认包含初始化值 -> `O(1)`），要么解决不同的问题（例如使用惰性数组或其他数据结构）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T16:06:27.307

您可以在 中初始化一个数组`O(1)`，但它会消耗三倍的空间量，并为矩阵中的每个元素访问额外的“工作”。
因为在实践中，矩阵是内存中的一维数组，所以同样的原理仍然成立。

[该页面](http://eli.thegreenplace.net/2008/08/23/initializing-an-array-in-constant-time/)详细描述了如何完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:32:08.917

当你用相同的元素填充二维数组时，如果你真的要**填充每个元素** ，至少应该进行 n^2 操作。（给定二维数组是 n*n）。

降低复杂性的唯一方法是使用并行编程方法。例如，给定 n 个处理器，将第一个输入分配给数组的第一行。这是 n 个操作。然后每个处理器 Pi 将第 k 行的数组[i] 分配给第 k+1 行的数组[i]，其中 k=0 到 n-1。这将再次是 O(n)，因为我们有 n 个处理器并行工作。

如果你真的想实现这种方法，你可以寻找免费的并行编程环境，如[OpenMPI](http://www.open-mpi.org/)和[mpich](http://www.mpich.org/)

# python - 使用python多处理动态创建共享数组列表

> ID：14416130
> 
> 赞同：8
> 
> 时间：2013-01-19T16:04:15.367
> 
> 标签：python, numpy, ipc, multiprocessing, shared-memory

我想使用 python 的多处理模块在不同的子进程之间共享几个 numpy 数组。我希望这些数组可以单独锁定，并且我希望在运行时动态确定数组的数量。这可能吗？

在[这个答案](https://stackoverflow.com/a/7908612/513688)中，JF Sebastian 提出了一种在多处理时在共享内存中使用 python 的 numpy 数组的好方法。该阵列是可锁定的，这就是我想要的。我想做一些非常相似的事情，除了可变数量的共享数组。数组的数量将在运行时确定。他的示例代码非常清晰，几乎完全符合我的要求，但我不清楚如何声明可变数量的此类数组，而不给每个数组一个硬编码名称，如`shared_arr_1`,`shared_arr_2`等。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T22:20:04.180

事实证明这比我想象的要容易！在 JF Sebastian 的鼓励下，这是我的答案：

```
import time
import ctypes
import logging
import Queue
import multiprocessing as mp
import numpy as np

info = mp.get_logger().info

def main():
    logger = mp.log_to_stderr()
    logger.setLevel(logging.INFO)

    data_pipeline = Image_Data_Pipeline(
        num_data_buffers=5,
        buffer_shape=(60, 256, 512))
    start = time.clock()
    data_pipeline.load_buffers(data_pipeline.num_data_buffers)
    end = time.clock()
    data_pipeline.close()
    print "Elapsed time:", end-start

class Image_Data_Pipeline:
    def __init__(self, num_data_buffers, buffer_shape):
        """
        Allocate a bunch of 16-bit buffers for image data
        """
        self.num_data_buffers = num_data_buffers
        self.buffer_shape = buffer_shape
        pix_per_buf = np.prod(buffer_shape)
        self.data_buffers = [mp.Array(ctypes.c_uint16, pix_per_buf)
                             for b in range(num_data_buffers)]
        self.idle_data_buffers = range(num_data_buffers)

        """
        Launch the child processes that make up the pipeline
        """
        self.camera = Data_Pipeline_Process(
            target=child_process, name='Camera',
            data_buffers=self.data_buffers, buffer_shape=buffer_shape)
        self.display_prep = Data_Pipeline_Process(
            target=child_process, name='Display Prep',
            data_buffers=self.data_buffers, buffer_shape=buffer_shape,
            input_queue=self.camera.output_queue)
        self.file_saving = Data_Pipeline_Process(
            target=child_process, name='File Saving',
            data_buffers=self.data_buffers, buffer_shape=buffer_shape,
            input_queue=self.display_prep.output_queue)
        return None

    def load_buffers(self, N, timeout=0):
        """
        Feed the pipe!
        """
        for i in range(N):
            self.camera.input_queue.put(self.idle_data_buffers.pop())

        """
        Wait for the buffers to idle. Here would be a fine place to
        feed them back to the pipeline, too.
        """
        while True:
            try:
                self.idle_data_buffers.append(
                    self.file_saving.output_queue.get_nowait())
                info("Buffer %i idle"%(self.idle_data_buffers[-1]))
            except Queue.Empty:
                time.sleep(0.01)
            if len(self.idle_data_buffers) >= self.num_data_buffers:
                break
        return None

    def close(self):
        self.camera.input_queue.put(None)
        self.display_prep.input_queue.put(None)
        self.file_saving.input_queue.put(None)
        self.camera.child.join()
        self.display_prep.child.join()
        self.file_saving.child.join()

class Data_Pipeline_Process:
    def __init__(
        self,
        target,
        name,
        data_buffers,
        buffer_shape,
        input_queue=None,
        output_queue=None,
        ):
        if input_queue is None:
            self.input_queue = mp.Queue()
        else:
            self.input_queue = input_queue

        if output_queue is None:
            self.output_queue = mp.Queue()
        else:
            self.output_queue = output_queue

        self.command_pipe = mp.Pipe() #For later, we'll send instrument commands

        self.child = mp.Process(
            target=target,
            args=(name, data_buffers, buffer_shape,
                  self.input_queue, self.output_queue, self.command_pipe),
            name=name)
        self.child.start()
        return None

def child_process(
    name,
    data_buffers,
    buffer_shape,
    input_queue,
    output_queue,
    command_pipe):
    if name == 'Display Prep':
        display_buffer = np.empty(buffer_shape, dtype=np.uint16)
    while True:
        try:
            process_me = input_queue.get_nowait()
        except Queue.Empty:
            time.sleep(0.01)
            continue
        if process_me is None:
            break #We're done
        else:
            info("start buffer %i"%(process_me))
            with data_buffers[process_me].get_lock():
                a = np.frombuffer(data_buffers[process_me].get_obj(),
                                  dtype=np.uint16)
                if name == 'Camera':
                    """
                    Fill the buffer with data (eventually, from the
                    camera, dummy data for now)
                    """
                    a.fill(1)
                elif name == 'Display Prep':
                    """
                    Process the 16-bit image into a display-ready
                    8-bit image. Fow now, just copy the data to a
                    similar buffer.
                    """
                    display_buffer[:] = a.reshape(buffer_shape)
                elif name == 'File Saving':
                    """
                    Save the data to disk.
                    """
                    a.tofile('out.raw')
            info("end buffer %i"%(process_me))
            output_queue.put(process_me)
    return None

if __name__ == '__main__':
    main() 
```

背景：这是数据采集管道的骨架。我想以非常高的速率获取数据，对其进行处理以在屏幕上显示，然后将其保存到磁盘。我不希望显示速率或磁盘速率限制获取，这就是为什么我认为在单独的处理循环中使用单独的子进程是合适的。

这是虚拟程序的典型输出：

```
C:\code\instrument_control>c:\Python27\python.exe test.py
[INFO/MainProcess] allocating a new mmap of length 15728640
[INFO/MainProcess] allocating a new mmap of length 15728640
[INFO/MainProcess] allocating a new mmap of length 15728640
[INFO/MainProcess] allocating a new mmap of length 15728640
[INFO/MainProcess] allocating a new mmap of length 15728640
[[INFO/Camera] child process calling self.run()
INFO/Display Prep] child process calling self.run()
[INFO/Camera] start buffer 4
[INFO/File Saving] child process calling self.run()
[INFO/Camera] end buffer 4
[INFO/Camera] start buffer 3
[INFO/Camera] end buffer 3
[INFO/Camera] start buffer 2
[INFO/Display Prep] start buffer 4
[INFO/Camera] end buffer 2
[INFO/Camera] start buffer 1
[INFO/Camera] end buffer 1
[INFO/Camera] start buffer 0
[INFO/Camera] end buffer 0
[INFO/Display Prep] end buffer 4
[INFO/Display Prep] start buffer 3
[INFO/File Saving] start buffer 4
[INFO/Display Prep] end buffer 3
[INFO/Display Prep] start buffer 2
[INFO/File Saving] end buffer 4
[INFO/File Saving] start buffer 3
[INFO/MainProcess] Buffer 4 idle
[INFO/Display Prep] end buffer 2
[INFO/Display Prep] start buffer 1
[INFO/File Saving] end buffer 3
[INFO/File Saving] start buffer 2
[INFO/MainProcess] Buffer 3 idle
[INFO/Display Prep] end buffer 1
[INFO/Display Prep] start buffer 0
[INFO/File Saving] end buffer 2
[INFO/File Saving] start buffer 1
[[INFO/MainProcess] Buffer 2 idle
INFO/Display Prep] end buffer 0
[INFO/File Saving] end buffer 1
[INFO/File Saving] start buffer 0
[INFO/MainProcess] Buffer 1 idle
[INFO/File Saving] end buffer 0
[INFO/MainProcess] Buffer 0 idle
[INFO/Camera] process shutting down
[INFO/Camera] process exiting with exitcode 0
[INFO/Display Prep] process shutting down
[INFO/File Saving] process shutting down
[INFO/Display Prep] process exiting with exitcode 0
[INFO/File Saving] process exiting with exitcode 0
Elapsed time: 0.263240348548
[INFO/MainProcess] process shutting down

C:\code\instrument_control> 
```

它似乎在做我想做的事：处理数据以供显示并保存到磁盘，而不会干扰采集速率。

# python - 动态更新 wxPython wx.TimeCtrl 小部件

> ID：14416137
> 
> 赞同：0
> 
> 时间：2013-01-19T16:05:51.390
> 
> 标签：python, dynamic, wxpython

我正在尝试获取一个 wxPython`TimeCtrl`小部件，通过单击按钮将其值 12 小时（上午/下午）格式切换为 24 小时格式。

现在我知道`TimeCtrl`小部件 12/24 小时格式是在初始化时通过设置属性*fmt24hr = False/True*设置的， 具体取决于您是否要显示 24 小时格式。

这是 TimeCtrl 的 API::

```
from wx.lib.masked import TimeCtrl

TimeCtrl(
     parent, id = -1,
     value = '00:00:00',
     pos = wx.DefaultPosition,
     size = wx.DefaultSize,
     style = wxTE_PROCESS_TAB,
     validator = wx.DefaultValidator,
     name = "time",
     format = 'HHMMSS',
     fmt24hr = False,
     displaySeconds = True,
     spinButton = None,
     min = None,
     max = None,
     limited = None,
     oob_color = "Yellow"
    ) 
```

现在我想在单击按钮时将**fmt24hr**从 True 切换为 False 但我找不到方法！据我在文档中看到的，它没有设置器。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T14:45:18.113

我猜这是创建小部件后无法更改的属性。你有两个选择：

1.  创建两个控件并隐藏一个，当您切换时隐藏第一个并显示第二个
2.  创建第一个控件，然后在“切换”它时将其销毁，并在其位置创建另一个版本。

无论哪种方式，您几乎肯定会希望使用 Sizer 方法使其在正确的位置出现和消失。如果您要销毁它，那么您将需要 Sizer.Remove 和 Sizer.Insert。如果您只是显示和隐藏，那么您可以使用 Sizer 的 Show 和 Hide 方法。您可能还想查看面板的 Freeze 和 Thaw 方法以减少闪烁量。

# javascript - 使用 split 过滤掉第一个逗号和它之前的所有内容

> ID：14416143
> 
> 赞同：3
> 
> 时间：2013-01-19T16:06:22.517
> 
> 标签：javascript, split

我正在尝试过滤掉第一个逗号及其之前的所有内容。我应该只使用正则表达式还是拆分工作？

```
// notice multiple commas, I'm trying to grab everything after the first comma.
str = 'jibberish, text cat dog milk, chocolate, rainbow, snow',

// this gets the text from the first comma but I want everything after it. =(
result = str.split(',')[0]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:08:14.377

您可以简单地使用子字符串来提取所需的字符串。

**[现场演示](http://jsfiddle.net/rajaadil/bxkVM/1/)**

```
result = str.substring(str.indexOf(',')+1); //add 2 if you want to remove leading space 
```

*如果您出于任何原因想使用 split*

**[现场演示](http://jsfiddle.net/rajaadil/bxkVM/)**

```
result = str.split(',')[0];    
result = str.split(result+",")[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:08:15.137

```
// Convert to array
var arr = str.split(',');

// Remove first element of array
arr.splice(0, 1);

// Convert back to string
var newString = arr.join(', '); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T16:10:46.367

如何使用[`substring`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring)and [`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)：

```
str = str.substring(str.indexOf(",") + 2); 
```

**示例：http:** [//jsfiddle.net/ymuJc/1/](http://jsfiddle.net/ymuJc/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T16:11:54.320

而不是拆分，试试这个 - 它不会与第一个逗号以外的任何其他逗号混淆

```
var result = str.substring(str.indexOf(",")+1) 
```

如果要跳过前导空格，请使用 +2

如果您不确定是否总是有逗号，则进行修剪更安全

```
var result = str.substring(str.indexOf(",")+1).trim(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T16:11:37.987

你可以使用`substr`和`indexOf`

```
str = 'jibberish, text cat dog milk, chocolate, rainbow, snow'

result = str.substr(str.indexOf(',')+1, str.length) 
```

# java - 导入 JPA 接口

> ID：14416147
> 
> 赞同：1
> 
> 时间：2013-01-19T16:06:47.920
> 
> 标签：java, jpa

是否可以在不链接提供者库的情况下导入 JPA 的接口？
我正在尝试构建我的系统的持久性接口和适配器以允许模块化持久层，但为了做到这一点，我必须链接 Hibernate（或其他一些 JPA 提供程序）的 jar。
据我了解，JDK 未提供 JPA 接口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:10:35.177

您包括要编译的**persistence-api.jar 。**遗憾的是，JPA 背后的人决定不费心将该 jar 的 v2.0 发布到 Maven 存储库中，因此您必须依赖提供此功能的各种版本的 jar。例如，EclipseLink 有一个 persistence-api.jar，Hibernate 也有，还有一个 Apache 许可的“Geronimo Specs JPA 2.0 jar”，提供相同的*“javax.persistence”*类。

# android - Android SQLite 中的动态表

> ID：14416151
> 
> 赞同：0
> 
> 时间：2013-01-19T16:07:38.350
> 
> 标签：android, database, sqlite

我的问题涉及数据库 - 场景是这样的：

我有一个应用程序可以跟踪人们何时借用物品。我有一个现有的表，可以跟踪他们是谁，他们借了什么等等。我想做的是创建一个单独的表来跟踪这个人借了什么，他们的联系信息，如果他们归还了，等等。

我这样做的想法是在 SQL 中创建一个动态表，该表将保存 1 个人的记录，即

约翰史密斯 DVD；2012 年 7 月 12 日；以良好的状态返回；ETC

由于我仍在学习，我想知道：

这是可能的，可行的，或者如果有更聪明的方法来解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:24:46.513

他们的联系信息可以链接到跟踪他们是谁的表格中。

如果您还没有为退货创建表，那么我建议您参考借用表的 ID 并在借用表中设置一个标志，表示该项目已被归还。

我不太确定您为什么要创建一个新表来整理所有信息。如果您想将所有信息放在一起，那么我建议`JOIN`在准备语句时使用 SQL 关键字。如果您真的想稍后将信息存储在表中，您可以，但它只会在您的数据库中重复。

关于您可以执行的不同类型连接的教程：http: [//www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:33:48.257

绝对可以按照您的描述进行。不过，这确实不是一个很好的策略。您的新表完全等同于现有表中的一个附加列，该列将该行标记为属于特定个人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T23:29:37.307

您的答案取决于您的情况；

如果您只对“谁”借用“什么”（当前）而不是“何时”感兴趣，除了最后一次出现，并且您假设一个项目始终只有 1 个副本，那么您可以使用**一对一**关系：

```
CREATE TABLE Person
(
    PersonId        int IDENTITY(1,1)   NOT NULL,
    Name            nvarchar(30)        NOT NULL,
    Surname         nvarchar(30)        NOT NULL,
    BorrowItemId    int                 NULL FOREIGN KEY REFERENCES Item UNIQUE,
    BorrowDate      datetime            NULL,
    ReturnDate      datetime            NULL,
    ReturnCondition nvarchar(50)        NULL,
    CONSTRAINT PK_Person PRIMARY KEY CLUSTERED (PersonId ASC),
)
CREATE TABLE Item
(
    ItemId          int IDENTITY(1,1)   NOT NULL,
    ItemDescription nvarchar(50)        NOT NULL,
    CONSTRAINT [PK_Item] PRIMARY KEY CLUSTERED (ItemId ASC)
) 
```

如果您有每个项目的多个副本，则应删除*BorrowItemId上的**UNIQUE*键，将关系更改为**one to many**。如果;

 ***要查看借用和归还的物品以及个人信息：

```
SELECT PersonId, Name, Surname, ItemDescription, ReturnDate, ReturnCondition
FROM Person INNER JOIN Item
    ON BorrowItemId = ItemId
WHERE BorrowItemId IS NOT NULL 
    AND ReturnDate IS NOT NULL 
```

您可以在 WHERE 子句中添加 PersonId 过滤器以查询特定人员

这不是一个好的设计，因为您可以插入没有日期信息的记录，或者您甚至可以插入有日期信息但没有相关 BorrowItemId 的记录。我建议使用**多对多**并保留历史数据（可能很方便）或在每次借用新项目时使用更新覆盖***

# java - Java线程内部线程之间的通信

> ID：14416152
> 
> 赞同：1
> 
> 时间：2013-01-19T16:07:41.400
> 
> 标签：java, multithreading, communication

我不知道如何解决这个问题，希望你能帮助我。

在服务器端我有这个：

```
class Baza0 implements Runnable{  

     anotherclass arraylist_handle = new anotherclass();

public method1(string s1){uses methods figured in arraylist_handle)

public run(){
  while(true){
   Socket s = s.accept();
   if(s==NULL) continue;

   //there I'm starting another thread that handles client  connection
  }   
}
 public static void main(){
   Baza0 baza0 = new Baza0();
   Thread t = new Thread(baza0); 
 }
} 
```

连接的客户端通过 socketserver 功能将字符串发送到客户端处理程序。如何将此字符串从客户端处理程序发送到 method1 作为参数？它必须使用唯一的一个 Baza0 对象，因为 ArrayList 必须对所有客户端通用。

## 编辑

有人能告诉我为什么像 Baza0.baza0.method1() 这样的东西不起作用吗？

## 编辑2

看看我做了什么！

我在 Class Baza0 中创建了一个静态变量：

```
static Baza0 baza1; 
```

在 main 方法中，我启动了一个 Baza0 对象：

```
Baza0 baza0 = new Baza0(); 
```

在此之后运行使 baza1 = baza0 的方法。

现在从客户端处理程序我可以访问方法，通过：

```
Baza0.baza1.method1(param); 
```

它确实有效！:D ...不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:14:16.407

1.  如果您仅将 arraylist 用于**读取**，则所有子线程都可以自由地同时访问它；
2.  如果线程想要**修改**列表，那么列表必须是线程安全的；
3.  如果修改涉及**许多步骤**（读取和写入），那么您必须使用`synchronized`与列表发生“事务”的块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:15:49.323

您的客户端线程必须`ArrayList`直接或（更好）间接地引用它。最简单的方法是将`Baza0`实例 ( `this`) 传递给客户端线程：

```
public class Client implements Runnable {

    private final Baza0 baza;

    public Client(Baza0 baza) {
        this.baza = baza;
    }

    public void run() {
        //...
        baza.method1("Some string");
    }

} 
```

当您创建`Client`线程时，只需传递`this`：

```
new Thread(new Client(this)).start(); 
```

重要的线程安全问题：`method1()`必须同步或您`ArrayList`必须是线程安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T16:17:20.623

传递`Baza0`对可用于调用的客户端处理程序线程的引用`method1`。

```
public method1(string s1){
    synchonized(arrayList){
        //list operation 
    }
}
...
while(true){
   Socket s = s.accept();
   if(s==NULL) continue;
   new Thread(
            new WorkerRunnable(
                clientSocket, this).start();

  } 
```

……

```
public class WorkerRunnable implements Runnable{
  public WorkerRunnable(Socket socket,Baza0 ba){
     this.socket = socket;
     this.baza =ba;
  }
  public void run(){
     ...
     this.ba.method1(...);
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T17:18:06.730

我会说@Marko Topolnik 所说的。我还有一本书[Java Concurrency In Practice](http://www.javaconcurrencyinpractice.com/)（现在没有回复我:-() 或一个链接让我找到这本书，在博客[The Java Specialists](http://www.javaspecialists.eu/archive/Issue125.html) for processing thread issues 中。这本书有所有队列的例子，并发，同步列表，实现代码以做几件事的方法等，所有这些都非常简单，每个主题的示例和几段。

# php - 如何将 mysql 数据库中的值检索到谷歌地图的信息窗口中？

> ID：14416155
> 
> 赞同：-1
> 
> 时间：2013-01-19T16:07:50.640
> 
> 标签：php, javascript, database, google-maps

如何从 mysql 数据库中检索值并根据标记在 infowindow 中显示？

示例第一个标记，信息窗口应显示“A”..现在，它显示了所有内容。我该怎么做呢？请指导我完成。谢谢！

```
<script>
        var map;
        var marker;
        var infowindow;

        var info = <?php echo json_encode($infoWindow); ?>;
        var placeX= <?php echo json_encode($getX); ?>;
        var placeY= <?php echo json_encode($getY); ?>;

        function initialize()
        {
            var mapProp = {
              center:new google.maps.LatLng(1.35208,103.81984),
              zoom:11,
              mapTypeId:google.maps.MapTypeId.ROADMAP
              };

            map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

            for(var x=0; x<placeX.length; x++)
            {
                retrieve(placeX[x],placeY[x],info[x])
            }   

        }

        function retrieve(x,y,i)
        {
            var marker=new google.maps.Marker({
              position:new google.maps.LatLng(y,x),
              });

            marker.setMap(map);

            marker.setIcon('http://maps.google.com/mapfiles/ms/icons/green-dot.png')

            marker.info = new google.maps.InfoWindow ({content: '<b>No. of people who choose this location:</b> '+ info});
            google.maps.event.addListener(marker, 'click',function(){
                marker.info.open(map,marker);
                });

        }

        function addInfoWindow(x,y,h) 
        {
           var infowindow = new google.maps.InfoWindow({
              content:"Hello World!"
              });

            google.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map,marker);
            });
        }

        google.maps.event.addDomListener(window, 'load', initialize);

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:17:25.527

`retrieve`包含信息的论点`i`不是`info`

```
marker.info = new google.maps
.InfoWindow ({content: '<b>No. of people who choose this location:</b> '+ i});
//------------------------------------------------------------------------^ 
```

* * *

**与评论相关：（**对最高值应用不同的标记）

把这个放在后面 `var info = <?php echo json_encode($infoWindow); ?>;`

* * *

```
max=Math.max.apply(null,info); 
```

它将定义一个变量 max ，其中最高的信息项作为值。

现在您可以将此值用于条件标记：

```
marker.setIcon('http://maps.google.com/mapfiles/ms/icons/'+
                  ((i==max)?'red':'‌​green')+'-dot.png'); 
```

# android - 如何创建一个将数据提供给我的 android 应用程序的 xml api

> ID：14416159
> 
> 赞同：0
> 
> 时间：2013-01-19T16:08:21.820
> 
> 标签：android, xml, parsing

好吧，我有一个需要用数据更新的 android 应用程序...我知道在 android-end 上要做什么来进行 xml 解析...但是当我尝试使用 stringbuilder 通过以下 xml 文件（a）解析数据时（ b）我没有在我的应用程序中获取数据......

(a)data.xml

```
<?xml version="1.0" encoding="utf-8"?>
<document version="first">
<stuff code="firststuff">
<item1 build="first">This is first item.</item1>
<item2 build="second">This is second item.</item2>
<item3 build="third">This is third item.</item3>
</stuff>
<stuff code="secondtstuff">
<item1 build="first">This is first item.</item1>
<item2 build="second">This is second item.</item2>
<item3 build="third">This is third item.</item3>
</stuff>
<stuff code="thirdstuff">
<item1 build="first">This is first item.</item1>
<item2 build="second">This is second item.</item2>
<item3 build="third">This is third item.</item3>
</stuff>
</document> 
```

(b) 我在我的 android 应用程序中使用的字符串...

```
http://www.xyz.com/data.xml?build=second 
```

以下 3 个文件中的 java 代码 (c)Main (d)HandlingXMLStuff (e)XMLDataCollected

(c)主要

```
package com.xyz.xmlpar1;

import java.net.URL;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.InputSource;
import org.xml.sax.XMLReader;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class Main extends Activity implements OnClickListener {
    static final String BaseURL="http://www.xyz.com/data.xml?code=";
    Button b;
    TextView tv;
    EditText et1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        et1=(EditText) findViewById(R.id.editText1);
        b=(Button) findViewById(R.id.button1);
        tv=(TextView) findViewById(R.id.textView1);
        b.setOnClickListener(this);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    @Override
    public void onClick(View v) {

        // TODO Auto-generated method stub
        String item=et1.getText().toString();
        StringBuilder URL=new StringBuilder(BaseURL);
        URL.append(item);
        String fullURL=URL.toString();
        try{
            URL website=new URL(fullURL);
            SAXParserFactory spf=SAXParserFactory.newInstance();
            SAXParser sp=spf.newSAXParser();
            XMLReader xr=sp.getXMLReader();
            HandlingXMLStuff doingWork=new HandlingXMLStuff();
            xr.setContentHandler(doingWork);
            xr.parse(new InputSource(website.openStream()));
            String information=doingWork.getInformation();
            tv.setText(information);

        }catch(Exception e){
            tv.setText("error");
        }

    }

} 
```

(d)处理XMLStuff

```
package com.xyz.xmlpar1;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class HandlingXMLStuff extends DefaultHandler {

    XMLDataCollected info=new XMLDataCollected();

    public String getInformation(){
        return info.datatoString();
    }

    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {
        // TODO Auto-generated method stub
        if(localName.equals("code")){
            String element=attributes.getValue("build");
            info.setData(element);
        }
    }

} 
```

(e)XMLDataCollected

```
package com.xyz.xmlpar1;

public class XMLDataCollected {

    String datac=null;

    public void setData(String c){
        datac=c;
    }

    public String datatoString(){
        return datac;
    }

} 
```

获取“第二个”数据项..

我哪里错了？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T17:45:44.237

您应该按照我在此问题的副本上发布的教程进行操作：[Parsed XML data not retrieving in android](https://stackoverflow.com/questions/14417475/parsed-xml-data-not-retrieving-in-android/14418003#14418003)

尽管该教程没有显示获取属性。

简而言之，您`startElement`应该看起来像这样：

```
@Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {

          if(localName.equals("stuff")){
            String element=attributes.getValue("code");
            info.setData(element); //element will hold "firststuff" on the first execution

        }
    } 
```

您将需要`if`为您尝试匹配的每个名称单独设置一个。

Xml 文件通常是这样引用的（使用您的命名约定）：

`<localName attributeName="attributeValue">textValue</localName>`所以`if`上面的语句将处理行`<stuff code="firststuff">` `<..."secondstuff">`等，但你必须添加更多来处理*每个不同的*行。

我强烈建议您按照教程完成此操作，尽管通过反复试验，您肯定会学到很多东西。

# php - 使用`时Mysql查询不起作用

> ID：14416162
> 
> 赞同：-2
> 
> 时间：2013-01-19T16:08:26.137
> 
> 标签：php, mysql, quotes

> **可能重复：**
> [警告：mysql_num_rows() 期望参数 1 是资源，布尔值在](https://stackoverflow.com/questions/12124750/warning-mysql-num-rows-expects-parameter-1-to-be-resource-boolean-given-in)

也许你也注意到了这一点……

当我使用这种查询时：

```
$r = mysql_query("SELECT * FROM users WHERE username='$this->username'");
if(mysql_num_rows($r) >0)
 .... code .... 
```

一切正常。除非我使用这种查询：

```
$r = mysql_query("SELECT * FROM users WHERE username='$this->username' AND password='$this->password'");
if(mysql_num_rows($r) >0)
 .... code .... 
```

然后我得到这个错误：

> 警告：mysql_num_rows() 期望参数 1 是资源，给定的布尔值

我注意到当我使用这些引号时

```
`table` 
```

一切正常，如下所示：

```
$r = mysql_query("SELECT * FROM `users` WHERE `username`='$this->username' AND `password`='$this->password'");
if(mysql_num_rows($r) >0)
 .... code .... 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:09:24.517

因为`TABLE`是保留关键字。

*   [MySQL 保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

如果您有权更改 tableName，请将其更改为不在关键字列表中的名称。至少，它将使您摆脱未来的问题。

# c# - 如何从 MySQL 数据库的内容中即时创建 Access DB 并在本地保存

> ID：14416165
> 
> 赞同：1
> 
> 时间：2013-01-19T16:08:47.100
> 
> 标签：c#, mysql, ms-access

我有一个用于我公司库存的远程 MySQL 数据库。库存数据库是我们分包设备的所有地点的主数据库。每个物业都有自己的库存，对于季度库存，每个位置都需要带一台笔记本电脑和一台扫描仪，扫描他们的库存，然后将其同步到主数据库。

问题是并非所有位置都可以轻松访问 Internet，因此我需要将数据库复制到本地文件。并发不是问题，因为只有一个客户端会同时连接到数据库，并且每个位置的数据库都相对较小，基本上由 <1000 行 7 列组成。

我已经在 HD 上创建了一个 Access 文件，但我无法从 MSDN 中真正了解如何创建具有特定架构的文件或如何将我的 SELECT 语句中的相关数据插入到所述数据库中。我一直在寻找动态创建表适配器并使用 .NET 的内置方法进行数据传输，但我仍然找不到如何以编程方式创建具有特定模式的 MS Access 文件。如果有人以前遇到过这样的问题，我将不胜感激任何可以提供的见解。我基本上需要将 SELECT 语句的结果复制到我将在本地存储的 MS Access 数据库中。我已经准备好所有其他代码。

我目前正在使用一个相当笨拙的查询和 foreach 循环来完成我的脏活，但我希望有一个更优雅的解决方案，也许使用动态创建的数据源。

```
ADOX.Catalog cat = new ADOX.Catalog();

        cat.Create("Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source="+ fileName + ";" + "Jet OLEDB:Engine Type=5");

        string conString = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + fileName + ";" + "User Id=admin;Password=;";

        OleDbConnection con = new OleDbConnection(conString);

        con.Open();

        //create command to generate database schema
        OleDbCommand command = new OleDbCommand();
        command.CommandText = @"CREATE TABLE items (
            [category] VARCHAR(16) NOT NULL,
            [manufacturer] VARCHAR(32) NOT NULL,
            [model] VARCHAR(32),
            [description] TEXT NOT NULL,
            [serial_number] VARCHAR(64),
            [barcode] VARCHAR(8) NOT NULL PRIMARY KEY,
            [property] VARCHAR(4) NOT NULL,
            [present] TINYINT
        )";

        command.Connection = con;
        command.ExecuteNonQuery();

        OleDbCommand cmdInsert = new OleDbCommand();
        cmdInsert.CommandText = "INSERT INTO items([category],[manufacturer],[model],[description],[serial_number],[barcode],[property],[present]) VALUES (@cat,@man,@mod,@desc,@ser,@bar,@prop,@pres)";
        cmdInsert.Connection = con;

        foreach (DataRow row in itemsTableAdapter1.GetData())
        {
            cmdInsert.Parameters.AddWithValue("@cat",row.ItemArray[0].ToString());
            cmdInsert.Parameters.AddWithValue("@man", row.ItemArray[1].ToString());
            cmdInsert.Parameters.AddWithValue("@mod", row.ItemArray[2].ToString());
            cmdInsert.Parameters.AddWithValue("@desc", row.ItemArray[3].ToString());
            cmdInsert.Parameters.AddWithValue("@ser", row.ItemArray[4].ToString());
            cmdInsert.Parameters.AddWithValue("@bar", row.ItemArray[5].ToString());
            cmdInsert.Parameters.AddWithValue("@prop", row.ItemArray[6].ToString());
            cmdInsert.Parameters.AddWithValue("@pres", row.ItemArray[7]);
            cmdInsert.ExecuteNonQuery();
            cmdInsert.Parameters.Clear();
        }
        con.Close();
        cat = null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:57:56.710

我之前尝试过这样做，但发现为了创建一个新的 AccessDB，我实际上必须复制一个现有数据库以及我需要的所有表等。

你能用[sqlite吗？](http://www.sqlite.org/) 它很小，很稳定，并且库可用于大多数语言。您将能够在客户端计算机上创建您喜欢的任何结构。

# c# - 同时发送http请求的最佳方式

> ID：14416166
> 
> 赞同：1
> 
> 时间：2013-01-19T16:08:59.753
> 
> 标签：c#, java

应该是一个简单的问题 - 我想同时发送两个 http 请求，而不用太在意返回的内容。我的目标是让数据包 A 和数据包 B 在准确的时间到达目的地，而忽略延迟。

我熟悉 Python 和 C#，但不是专家。有谁知道可以做到这一点的软件（irc、nettools 等），或者是否可以在 C 语言中轻松完成？我问过用 Python 做这件事，但一切似乎都是异步的。感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:12:56.643

你必须在Java / C中这样做吗？如果有任何原因您不能使用简单的 shell 脚本和 wget 一个接一个地发送两个 HTTP 请求？

您将无法在完全相同的时间发送请求，但您可以一个接一个地直接发送它们，而无需任何等待/额外代码。

如果您想了解更多关于 wget 的信息，可以在这里找到：[http ://unixhelp.ed.ac.uk/CGI/man-cgi?wget](http://unixhelp.ed.ac.uk/CGI/man-cgi?wget)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:46:51.200

我知道[OpenSTA](http://opensta.org/)会这样做，[本](http://www.testingfaqs.org/t-load.html)网站上的许多其他工具也会这样做。[然后，您可以使用Wireshark](http://www.wireshark.org/)或 Fiddler跟踪这些请求，然后您将准确了解请求到达的时间。

不过 Elliot 是对的，如果你有技能，shell 脚本是最简单的方法。

# android - 从 ExpandableListView 编辑 textView 子项（删除线）

> ID：14416170
> 
> 赞同：0
> 
> 时间：2013-01-19T16:09:27.830
> 
> 标签：android, expandablelistview

我有一个`ExpandableListView`，`OnChildClickListener`但是如何`TextView`在单击时添加删除线？

mExpandableList.setOnChildClickListener(new OnChildClickListener() {

```
 @Override
        public boolean onChildClick(ExpandableListView parent, View v,
                int groupPosition, int childPosition, long id) {

            Toast.makeText(getApplicationContext(), 
                    "Group: " + groupPosition + " Child: " + childPosition, Toast.LENGTH_SHORT).show();

            //Do something (i.e. add strikethourgh) to the TextView clicked..

            return false;
        }
    }); 
```

我的活动布局文件是

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    >

    <TextView
        android:id="@+id/calc_text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello_world" />

    <ExpandableListView
        android:id="@+id/calc_expandable_list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:cacheColorHint="#00000000"
        android:listSelector="@android:color/transparent"
        android:transcriptMode="alwaysScroll" />

</LinearLayout> 
```

而 ExpandableList 的孩子是

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/list_item_child"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center_vertical"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/list_item_text_child"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="5dp"
        android:padding="10dp"
        android:textSize="20sp" />
</LinearLayout> 
```

LogCat 的错误是：

```
W/dalvikvm(28424): threadid=1: thread exiting with uncaught exception (group=0x4001d5a0) E/AndroidRuntime(28424): FATAL EXCEPTION: main
E/AndroidRuntime(28424): java.lang.ClassCastException: android.widget.LinearLayout E/AndroidRuntime(28424):     at com.test.skylderhverandre.Calc$1.onChildClick(Calc.java:185)
E/AndroidRuntime(28424):    at
android.widget.ExpandableListView.handleItemClick(ExpandableListView.java:588)
E/AndroidRuntime(28424):    at
android.widget.ExpandableListView.performItemClick(ExpandableListView.java:527)
E/AndroidRuntime(28424):    at
android.widget.AbsListView$PerformClick.run(AbsListView.java:1831)
E/AndroidRuntime(28424):    at
android.os.Handler.handleCallback(Handler.java:587)
E/AndroidRuntime(28424):    at
android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime(28424):    at android.os.Looper.loop(Looper.java:150)
E/AndroidRuntime(28424):    at
android.app.ActivityThread.main(ActivityThread.java:4385)
E/AndroidRuntime(28424):    at
java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(28424):    at
java.lang.reflect.Method.invoke(Method.java:507)
E/AndroidRuntime(28424):    at
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
E/AndroidRuntime(28424):    at
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
E/AndroidRuntime(28424):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:14:12.073

您必须像这样使用[SpannableString](http://developer.android.com/reference/android/text/SpannableString.html)：

```
CharSequence value = ((TextView)((LinearLayout)v).getChildAt(0)).getText();
if(value!=null){
    SpannableString spannableString = new SpannableString(value);
    spannableString.setSpan(new StrikethroughSpan(), 0, value.length(), 0);
    ((TextView)((LinearLayout)v).getChildAt(0)).setText(spannableString);
} 
```

# css - 减少输入占位符 CSS

> ID：14416172
> 
> 赞同：2
> 
> 时间：2013-01-19T16:09:58.040
> 
> 标签：css

这是我的 CSS：

```
#login-box ::-webkit-input-placeholder {
    color: #666;
}

#login-box :-moz-placeholder {
    color: #666;
}

#login-box ::-moz-placeholder {
    color: #666;
}

#login-box :-ms-input-placeholder {
    color: #666;
} 
```

我试图将其减少如下：

```
#login-box ::-webkit-input-placeholder,
#login-box :-moz-placeholder,
#login-box ::-moz-placeholder,
#login-box :-ms-input-placeholder {
    color: #666;
} 
```

但这打破了它。

我怎样才能减少上面的CSS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:22:29.430

你基本上不能减少它。由于 CSS 的一项功能，您的尝试没有成功。当浏览器不理解选择器的一部分时，它会完全忽略整个规则。例如，Firefox（显然）不理解 ::-webkit-input-placeholder，因此它会跳过所有内容。

如果认为，让重复代码远离您的眼睛的唯一方法是使用像 LESS 这样的工具和一些像这样的 mixin：[http ://robandlauren.com/2012/04/10/less-mixin-for-styling -html5-placeholders/](http://robandlauren.com/2012/04/10/less-mixin-for-styling-html5-placeholders/)但如果您只需要使用一次，那么抱歉，我看不到在不限制浏览器支持的情况下减少代码的方法。

# python - 通过cron执行时Django自定义管理命令错误

> ID：14416173
> 
> 赞同：1
> 
> 时间：2013-01-19T16:10:05.323
> 
> 标签：python, django, postgresql, crontab

我有一个自定义命令，可以检查电子邮件帐户并下载和解析电子邮件。有关它的详细信息与此问题无关。

当我从 shell 运行此命令时，例如：

```
cd /project_dir
./manage.py check_mail 
```

每次都运行良好。当通过 crontab 执行相同的命令时，它会返回一个奇怪的 DB 错误：

```
django.db.utils.DatabaseError: SSL error: sslv3 alert bad record mac 
```

它从代码的不同点返回该异常。总是来自（非常简单的）选择查询。

crontab 条目很简单：

```
*/5 * * * * cd /project_dir && ./manage.py check_mail 
```

它由我为上述测试登录的同一用户运行。

在从子进程运行查询时，我确实在使用 PostgreSQL 和 Django 之前发现了这个“SSL 错误”，然后我通过关闭连接以强制创建一个新的连接来解决它，例如：

```
from django.db import connection
connection.close() 
```

但这在这种情况下无济于事。postgresql 日志并没有添加太多信息：

```
2013-01-19 16:03:09 GMT LOG:  SSL error: decryption failed or bad record mac
2013-01-19 16:03:09 GMT LOG:  could not receive data from client: Connection reset by peer
2013-01-19 16:03:09 GMT LOG:  unexpected EOF on client connection 
```

我正在使用 python 2.6 和 Django 1.4。这是其中一个错误的（几乎）完整回溯，但正如我所说，它并不总是从同一个查询中引发：

```
File "/project_dir/appname/checkmail.py", line 527, in get_message
    message = object.message_set.all().order_by('-time')[0]

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/models/query.py", line 207, in __getitem__
    return list(qs)[0]   

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/models/query.py", line 87, in __len__
    self._result_cache.extend(self._iter)   

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/models/query.py", line 291, in iterator
    for row in compiler.results_iter():   

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/models/sql/compiler.py", line 763, in results_iter
    for rows in self.execute_sql(MULTI):   

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/models/sql/compiler.py", line 818, in execute_sql
    cursor.execute(sql, params)   

File "/usr/local/lib/python2.6/dist-packages/Django-1.4-py2.6.egg/django/db/backends/postgresql_psycopg2/base.py", line 52, in execute
    return self.cursor.execute(query, args) 

django.db.utils.DatabaseError: SSL error: sslv3 alert bad record mac 
```

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:26:09.883

检查 crontab 是否运行相同版本的 python。我的 crontab 条目实际上如下所示：

```
*/10 * * * * cd /projectdir ; PYTHONPATH=/home/myhome/python/south:/home/myhome/python /usr/local/bin/python2.6 manage.py notify 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-25T01:30:09.987

crontab 使用的默认 shell 可能是 'sh' 而不是 bash。这意味着它运行的环境与您通常在命令行中的环境不同。

不要直接从 cron 发出命令，而是尝试在 shell 脚本中运行您的管理命令，然后从 cron 调用该脚本。一个工作示例看起来与此类似：

```
#!/bin/bash

. /etc/profile

cd /projectdir
./manage.py check_mail 
```

如果您使用的是 virtualenv，请在脚本中添加一行来获取您的 virtualenv`activate`命令。

# ruby-on-rails - 扩展 Rails 中查询返回的数组 - 重构

> ID：14416174
> 
> 赞同：0
> 
> 时间：2013-01-19T16:10:08.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-activerecord

我想扩展从查询返回的数组以添加新方法。

假设我有一个模型查询，它有一些计算属性 size_x, size_y ...

在我的控制器中，我检索了一些查询

```
@queries = Query.limit(10).all 
```

现在@queries 变成了一个数组。我想用 2 种方法扩展数组

```
@queries.average_size_x 
```

和

```
@queries.average_size_y 
```

我正在寻找一种简洁的解决方案，可以增强使用这两种方法返回的 Array 而无需将其添加到全局 Array 类中。有什么办法吗？

以下是我尝试过的一些事情：

*   重新定义 self.find 方法

这仅在我将查询更改为旧语法时才有效

```
Query.find(:all, :limit => 5) 
```

*   扩展关系

    `Query.limit(10).extending(QueryAggregator)`

如果我不调用该`all`方法，因为该对象是 ActiveRecord 关系，但一旦`all`被调用，则该方法`average_size_x`不可用。

我看到的唯一选择是扩展 Array 类并在那里添加方法，但它可能与其他模型无关......

有什么建议么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:23:55.400

这应该有效。您有一个代理实例并按模块扩展。

```
query = Query.limit(10).all

module SomeModule
  def average_size_x
  end

  def average_size_y
  end
end

query.extend(SomeModule)

query.average_size_y
query.average_size_y 
```

# git - 拉取和更改 .gitignore 文件后 Git 签出失败

> ID：14416175
> 
> 赞同：1
> 
> 时间：2013-01-19T16:10:10.543
> 
> 标签：git, gitignore, git-pull, git-checkout

假设我在本地仓库中有两个分支“master”和“new”，在 master 中，我决定在 .gitignore 中放置一个文件夹“folder/”，然后我从仓库中提取到 master，添加一个新文件夹“temp/”现在，当我想结帐到“新”时，我有这个

```
error: The following untracked working tree files would be overwritten by checkout:
.folder/subfolder/somefile
.folder/subfolder/somefile
tmp/somefiles(1),tmp/somefiles(2)... 
```

（我在签出之前提交）我尝试运行 git rm --cached 到“temp/”和“folder/”文件夹，但我不明白为什么会收到此消息（而且我认为签出过程并不是真的对我来说清楚）。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:18:26.677

该消息基本上意味着列出的文件现在未跟踪，但您正在签出的分支已跟踪它们。结果，这将删除这些文件的本地（未跟踪）版本，并将它们替换为您正在检出的分支中存储的任何内容。

原因是您从存储库中删除了该文件夹，但文件仍然存在；`git rm --cached`只会从索引中删除文件，但不会物理删除文件。因此，当您签出仍然跟踪这些文件的不同版本时，您会遇到冲突。

如果您仍然想删除这些文件，您可以直接删除它们 ( `rm <file>`)。然后在签出不同的分支之后，当然该分支仍会将这些文件带过来，因此您可能也希望在该分支上删除它们（或稍后将删除合并到该分支中）。

# c++ - libconfig++ -stdlib=libc++ 未定义符号

> ID：14416176
> 
> 赞同：0
> 
> 时间：2013-01-19T16:10:14.227
> 
> 标签：c++, c++11, config, libc++, clang++

试图获得一个非常简单的 libconfig++ 工作示例。但是，由于编译器选项“-stdlib=libc++”和“-std=c++11”，我遇到了以下链接错误。

**环境**

达尔文 iMac.local 12.2.0

达尔文内核版本 12.2.0

xnu-2050.18.24~1/RELEASE_X86_64 x86_64

**资源**

```
 Config cfg;

  cfg.readFile( "example.cfg" );

  string value = "";

  const string& key = "application.base";

  cfg.lookupValue( key, value ); 
```

**建造**

clang++ -o main main.cpp -lconfig++ -stdlib=libc++ -std=c++11

**错误**

```
Undefined symbols for architecture x86_64:   "libconfig::Config::lookupValue(char   const*, std::__1::basic_string<char, std::__1::char_traits<char>,   std::__1::allocator<char> >&) const", referenced from:  
      libconfig::Config::lookupValue(std::__1::basic_string<char,   std::__1::char_traits<char>, std::__1::allocator<char> > const&,   std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&)   const in main-mFa01w.o ld: symbol(s) not found for architecture x86_64 clang:   error:   linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:41:51.487

错误消息表明此成员函数：

```
libconfig::Config::lookupValue(const std::string& path, std::string& value) const; 
```

被编译`-stdlib=libc++`（可能作为内联，但我猜）。并且它反过来调用这个成员函数：

```
libconfig::Config::lookupValue(char const* path, std::string& value) const 
```

然而，后一个函数不是用`-stdlib=libc++`.

最可能的解决方法是使用`-stdlib=libc++`.

# javascript - 此代码中的循环引用在哪里？

> ID：14416185
> 
> 赞同：1
> 
> 时间：2013-01-19T16:11:05.210
> 
> 标签：javascript, circular-reference

我有一张桌子，我可以在其中添加图片 onclick。该表是从表单动态创建的。我试图将表保存到本地存储，但我遇到了循环引用问题。我已经阅读[了 Javascript 中的循环引用示例？](https://stackoverflow.com/questions/1493453/example-of-a-circular-reference-in-javascript)但我是一个完全的新手，很难理解。你能给我指出来吗？

```
function makeChart() {
        var table = document.createElement('table'),
        taskName = document.getElementById('taskname').value,
        header = document.createElement('th'),
        numDays = document.getElementById('days').value, //columns
        howOften = document.getElementById('times').value, //rows
        row,
        r,
        col,
        c;

    var cel = null;
    var myImages = new Array();
    myImages[0] = "http://www.olsug.org/wiki/images/9/95/Tux-small.png";
    myImages[1] = "http://a2.twimg.com/profile_images/1139237954/just-logo_normal.png";
    var my_div = document.createElement("div");
    my_div.id = "showPics";
    document.body.appendChild(my_div);
    var newList = document.createElement("ul");
    my_div.appendChild(newList);

    if (taskName == '' || numDays == '') {
        alert('Please enter task name and number of days');
    }
    if (howOften == '') {
        howOften = 1;
    }
    if (taskName != '' && numDays != '') {

        for (var i = 0; i < myImages.length; i++) {
            var allImages = new Image();
            allImages.src = myImages[i];
            allImages.onclick = function (e) {
                if (sel !== null) {
                    sel.src = e.target.src;

                    my_div.style.display = 'none';
                    sel.onclick = null;
                    sel = null;
                }
            };

            var li = document.createElement('ul');
            li.appendChild(allImages);
            newList.appendChild(li);
        }
        my_div.style.display = 'none';

        header.innerHTML = taskName;
        table.appendChild(header);

        function addImage(col) {
            var img = new Image();
            img.src = "http://cdn.sstatic.net/stackoverflow/img/tag-adobe.png";
            col.appendChild(img);
            img.onclick = function () {
                my_div.style.display = 'block';
                sel = img;
            };
        }
        for (r = 0; r < howOften; r++) {
            row = table.insertRow(-1);
            for (c = 0; c < numDays; c++) {
                col = row.insertCell(-1);
                addImage(col);
            }
        }
        document.getElementById('holdTable').appendChild(table);
        document.getElementById('createChart').onclick = null;
        console.log(table);
        localStorage.setItem(name, JSON.stringify(table));
        console.log( JSON.parse( localStorage.getItem( table ) ) );
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:12:50.963

任何 DOM 元素都包含对`parentNode`和的引用`document`，您无法对其进行字符串化。事实上，每个元素都拥有一个指向它的父元素的链接，该父元素拥有指向其子元素的链接。

您不能应用于`JSON.stringify`DOM 元素。

如果你真的想保存你的表格，你可以使用`table.innerHTML`. 我们可以提出其他解决方案（甚至有特定的 stringify 实现能够从循环元素或 DOM 节点生成 JSON）。但是我们需要知道您**为什么**尝试将表格保存在`localStorage`.

# swing - JTable：如何获取选定的单元格？

> ID：14416188
> 
> 赞同：9
> 
> 时间：2013-01-19T16:11:24.587
> 
> 标签：swing, jtable, cell, selected

我有一个 JTable 及其 TableModel，它运行良好，但我现在要做的是获取它的选定单元格。我想过做类似的事情：

```
int rows = this.getTable().getRowCount();
int columns = this.getTable().getColumnCount();
for(int i = 0 ; i < rows ; i++)
{
    for(int j = 0 ; j < columns ; j++)
    {
         if(table.getCell(i,j).isSelected() //...
    }
} 
```

当然，这样的事情是不存在的。我应该怎么做？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-19T16:30:59.590

在 JTable 中，您有

```
JTable.getSelectedRow() 
```

和

```
JTable.getSelectedColumn() 
```

您可以尝试将这两种方法与 MouseListener 和 KeyListener 结合使用。使用 KeyListener 检查用户是否按下了 CTRL 键，这意味着用户正在选择单元格，然后使用鼠标侦听器，对于您在 Vector 或 ArrayList 中存储的每次单击，选择的单元格：

```
//global variables
JTable theTable = new JTable();//your table
boolean pressingCTRL=false;//flag, if pressing CTRL it is true, otherwise it is false.
Vector selectedCells = new Vector<int[]>();//int[]because every entry will store {cellX,cellY}

public void something(){
   KeyListener tableKeyListener = new KeyAdapter() {

      @Override
      public void keyPressed(KeyEvent e) {
         if(e.getKeyCode()==KeyEvent.VK_CTRL){//check if user is pressing CTRL key
            pressingCTRL=true;
         }
      }

      @Override
      public void keyReleased(KeyEvent e) {
         if(e.getKeyCode()==KeyEvent.VK_CTRL){//check if user released CTRL key
            pressingCTRL=false;
         }
      }
   };

   MouseListener tableMouseListener = new MouseAdapter() {

      @Override
      public void mouseClicked(MouseEvent e) {
         if(pressingCTRL){//check if user is pressing CTRL key
            int row = theTable.rowAtPoint(e.getPoint());//get mouse-selected row
            int col = theTable.columnAtPoint(e.getPoint());//get mouse-selected col
            int[] newEntry = new int[]{row,col};//{row,col}=selected cell
            if(selectedCells.contains(newEntry)){
               //cell was already selected, deselect it
               selectedCells.remove(newEntry);
            }else{
               //cell was not selected
               selectedCells.add(newEntry);
            }
         }
      }
   };
   theTable.addKeyListener(tableKeyListener);
   theTable.addMouseListener(tableMouseListener);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-19T16:31:45.860

[table.getSelectedRow()](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTable.html#getSelectedRow%28%29)将获得选定的行。

[table.getSelectedColumns()](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTable.html#getSelectedColumns%28%29)将获取选定的列。

[getValueAt(rowIndex, columnIndex)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTable.html#getValueAt%28int,%20int%29)将给出每列的选定行的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T16:29:02.970

JTable 具有[获取选定行](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTable.html#getSelectedRows%28%29)和[选定列的](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTable.html#getSelectedColumns%28%29)方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-13T17:14:41.513

您可以使用：

```
int row = table.rowAtPoint(e.getPoint());
int col = table.columnAtPoint(e.getPoint()); 
```

`table.getSelectedRow()`您可以使用 (和)获取行和列，`table.getSelectedColumn()`但如果您选择了多个单元格，则该方法`table.getSelectedRow()`并`table.getSelectedColumn()`返回单击的第一个单元格的单元格位置。

另一方面，`table.rowAtPoint(e.getPoint())`返回`table.columnAtPoint(e.getPoint())`最后一次单击的确切单元格的表格。

# selection - UICollectionView 点击选择多个单元格

> ID：14416189
> 
> 赞同：3
> 
> 时间：2013-01-19T16:11:36.330
> 
> 标签：selection, uicollectionview, uitapgesturerecognizer, uicollectionviewcell

在 UICollectionView 中点击单个 UICell 然后在 UICollectionView 中向下或向上滚动时，我遇到了一个奇怪的问题，我看到选择了多个单元格。其他未被点击的单元格似乎是在整个 UICollectionView 布局中随机选择的。我在 UICollectionView 中有 3 列单元格和许多行。

在我的代码中，我有以下内容：

```
- (void)collectionView:(UICollectionView *)myCV didSelectItemAtIndexPath:(NSIndexPath *)indexPath
{
    LogInfo(@"Item Selected");
    // highlight the cell user tapped on
    UICollectionViewCell  *cell = [myCV cellForItemAtIndexPath:indexPath];
    [cell.layer setBorderWidth:10.0f];
    cell.layer.borderColor = [UIColor colorWithRed: 108/255\. green: 166/255\. blue: 16/255\. alpha:1.0].CGColor;
    cell.layer.CornerRadius = 10;

} 
```

高亮代码只是在点击的单元格上放置一个边框。

有没有办法确保只选择被点击的单元格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T19:10:34.950

是因为细胞可以重复使用吗？这就是你得到这个结果的原因。

解决方案是

1.  将选定的索引路径保存在某处。

2.  从 UICollectionViewCell 子类化您的单元格，然后覆盖 UICollectionViewCell 的**prepareForReuse**方法，您必须从您所做的所有格式设置（在 didSelectItemAtIndexPath 方法中）重置为其默认值，并使单元格准备好再次使用。更多关于**prepareForReuse**的[信息在这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/UICollectionReusableView_class/Reference/Reference.html)

3.  在 cellForRowItemAtIndexPath 中再次将相同的格式应用于您首先保存的索引路径的选定单元格。就是这样！

**但最后，我建议不要直接在这里做任何单元格格式的事情。尝试理解 UICollectionViewLayoutAttributes 并用它来做这些事情。**

# c++ - C++ 编译器问题 (?)：无法将参数传递给单独的类文件中的函数

> ID：14416195
> 
> 赞同：0
> 
> 时间：2013-01-19T16:12:04.397
> 
> 标签：c++, arguments

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我最近开始在 C++ 中开发一个解释器，但我很恼火，无论我尝试什么，向量或数组都无法传递给外部类方法，所以我删除了我所做的所有工作。事实证明，我什至不能将*int*传递给另一个类。在求助于 C 或 Java 之前，我决定再给 C++ 一次机会，但编译器仍然不能像我预期的那样工作。也许我忘记了关于 C++ 的一些简单的东西，因为我有一段时间没有使用它了，但这似乎很简单。我的问题是：当它们没有在同一个文件中定义时，我不能将参数传递给其他类中的方法。这是我正在尝试做的事情：

**主要：main.cpp**

```
#include "myclass.h"

int main() {
    MyClass test;
    int n = test.add(25, 30);
    return n;
} 
```

**头文件：myclass.h**

```
class MyClass {
public:
    int add(int a, int b);
}; 
```

**类实现：myclass.cpp**

```
#include "myclass.h"

int MyClass::add(int a, int b) {
    return a + b;
} 
```

`g++ main.cpp`用产量编译它

> /tmp/ccAZr6EY.o：在函数`main': main.cpp:(.text+0x1a): undefined reference to`MyClass::add(int, int)' collect2：错误：ld 返回 1 退出状态

我到底做错了什么？此外，即使我的函数没有参数化，编译器也会因为同样的事情对我大喊大叫，所以它一定是标题的问题。

非常感谢任何帮助 - 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:13:35.007

您需要编译这两个文件

```
g++ main.cpp myclass.cpp 
```

如果您只编译 main.cpp，编译器会`MyClass::add`在您的头文件中找到声明，但链接器稍后找不到`MyClass::add`要跳转到的实现。

# java - 如何从 JFrame 调用主框架？

> ID：14416196
> 
> 赞同：-1
> 
> 时间：2013-01-19T16:12:12.997
> 
> 标签：java, swing, jframe

我的主框架已设置为隐藏使用`setVisible(false)`.

现在，我正在尝试在另一个`JFrame`.

我尝试了这些，但没有一个有效。

```
FunTripView newWindow = new FunTripView();
newWindow.show();

FunTripView.setVisible(true);
FunTripView().run(); 
```

还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:23:13.433

`FunTripView newWindow = new FunTripView();` `newWindow.setVisible(false);`

这将隐藏新窗口。但是，如果您在其他地方实例化了 JFrame（主窗口），则需要将该实例传递给新的 JFrame 以便能够调用`.setVisible`它。

# jquery - 用于下拉菜单的 JQuery mouseleave 函数

> ID：14416203
> 
> 赞同：0
> 
> 时间：2013-01-19T16:12:56.707
> 
> 标签：jquery, animation, menu

我正在尝试使用 Jquery/CSS 创建一个动画下拉菜单并让它看起来很好，但我需要它来隐藏下拉菜单 onmouseout，但是当我使用 onmouseout 时，我无法使用 ul将鼠标悬停在 li 上会触发它。阅读了其他帖子后，我虽然可以使用 JQuery mouseleave 功能但无法正常工作，谁能帮忙！？

菜单：

```
<ul id="navList">
        <li><a href="/">Home</a></li>
        <li id="about" onmouseover="dropDown();" ><a href="#">About me</a>
            <ul id="drop">
                <li>What I do</li>
                <li>CV</li>
                <li>Photo Gallery</li>
            </ul>
        </li>
    </ul> 
```

显示下拉菜单的函数：

```
<script type="text/javascript">
function dropDown () 
{

            $("#drop").animate({height:'100px'},300);
            $("#drop").animate({opacity:'100'},300);

};
</script> 
```

我试图用来隐藏它的功能：

```
<script type="text/javascript">
$('#about').mouseleave(function(){
$("#drop").animate({height:'0px'},300);
$("#drop").animate({opacity:'0'},300);  
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:31:54.717

***只需尝试以下内容：***

**脚本部分：**

```
<script type="text/javascript">
function dropDown () 
{
$("#drop").show().animate({height:'100px'},300).animate({opacity:'100'},300);
}
function mouseOut()
{
$("#drop").animate({height:'0px'},300).animate({opacity:'0'},300);
}
$(function() {
$("#drop").hide();
$("#about a").hover(dropDown,mouseOut);
});
</script> 
```

**HTML部分：**

```
<ul id="navList">
        <li><a href="/">Home</a></li>
        <li id="about"><a href="#">About me</a>
            <ul id="drop">
                <li>What I do</li>
                <li>CV</li>
                <li>Photo Gallery</li>
            </ul>
        </li>
</ul> 
```

我认为这可以帮助您解决问题。

# php - 在 Zend Framework 2 中访问 MySQL 存储过程输出

> ID：14416204
> 
> 赞同：4
> 
> 时间：2013-01-19T16:13:05.130
> 
> 标签：php, mysql, stored-procedures, zend-framework2

我有一个简单的 MySQL 存储过程，它接受两个参数并将一行插入到表中。我可以像这样从 Zend Framework 2 执行它：

```
$result = $this->dbAdapter->query('CALL sp_register_user(?, ?)', array('username', 'password')); 
```

我还可以访问从我的存储过程返回的任何结果集。

我现在想要的是从我的存储过程中获得一个输出值作为第三个参数，所以是这样的：

```
DELIMITER //
CREATE PROCEDURE sp_register_user(IN username VARCHAR(50), IN password VARCHAR(128), OUT code INTEGER)
NOT DETERMINISTIC
COMMENT 'Registers a user'
  BEGIN
    INSERT INTO user VALUES (username, password);
    SET code = 123;
  END // 
```

问题是我如何从 PHP (ZF2) 访问这个输出变量。我只能通过我正在使用的 PDO 找到如何直接执行此操作的示例。[此页面上的示例 4](http://php.net/manual/en/pdo.prepared-statements.php)显示了如何直接通过 PDO 执行此操作。我担心的是，如果我直接使用 PDO 对象，我会失去一些抽象，因此我假设我将始终使用 PDO。

尽管如此，我还是试图让它直接与 PDO 一起工作，如下所示：

```
$username = 'my_username';
$password = 'my_password';
$code = 0;

$stmt = $this->dbAdapter->createStatement();
$stmt->prepare('CALL sp_register_user(?, ?, ?)');
$stmt->getResource()->bindParam(1, $username);
$stmt->getResource()->bindParam(2, $password);
$stmt->getResource()->bindParam(3, $code, \PDO::PARAM_INT, 3);
$stmt->execute(); 
```

但是，我收到一条错误消息，指出无法执行该语句。

理想的解决方案是我可以利用 ZF2 的抽象层，但欢迎和赞赏有关如何访问输出参数的任何想法。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-28T12:10:04.200

*这必须有效，因为我正在使用它*：

```
 $str = "DECLARE @Msgvar   varchar(100);DECLARE @last_id int;

    exec CallEntry_Ins $CallLoginId,".$this->usrId .",@Msg = @Msgvar OUTPUT,@LAST_ID = @last_id OUTPUT;

    SELECT  @Msgvar AS N'@Msg',@last_id AS '@LAST_ID'; ";

    $stmt = $db->prepare($str);
    $stmt->execute();
    $rtStatus = $stmt->fetchAll();

     $rtStatus[0]["@LAST_ID"] //accessing Op para 
```

# c++ - Asm CALL 指令 - 它是如何工作的？

> ID：14416205
> 
> 赞同：5
> 
> 时间：2013-01-19T16:13:10.810
> 
> 标签：c++, c, windows, assembly, x86

我很想清楚地解释一下，在 Windows 环境（PE 可执行文件）中，CALL XXXXXXXXXXXXXXX 指令是如何工作的。我一直在研究 PE 格式，但我对 CALL ADDRESS 指令、从 dll 中导入函数以及 CALL ADDRESS 如何访问 DLL 中的代码之间的关系感到非常困惑。除了 ASLR 和其他安全功能可能会在 DLL 中移动，可执行文件如何应对呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T16:41:24.887

它（即直接通过正常的相对调用调用导入）不起作用，这就是为什么它不是这样做的原因。

要调用导入的函数，您需要通过称为导入地址表 (IAT) 的东西。简而言之，IAT 中的条目首先指向函数名称（即，它从导入名称表的副本开始），然后这些指针被加载程序更改为指向实际函数。

IAT 位于固定地址，但如果图像已重新定位，则可以重新定位，因此通过它调用仅涉及单个间接 - 因此`call r/m`与内存操作数（只是一个简单的常量）一起使用以调用导入的函数，例如例子`call [0x40206C]`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T17:54:31.150

2013 年 1 月 22 日：**添加了**更多更简单的具体示例和讨论，因为 (A) 选择了一个不正确的答案作为解决方案，并且 (B) 包括 OP 在内的一些读者显然不理解我的原始答案。对不起，我的罪过。我只是匆忙发布了一个答案，添加了一个我手头已经有的代码示例。

* * *

## 我如何解释这个问题。

你问，

> “我一直在研究 PE 格式，但我对 CALL ADDRESS 指令、从 dll 中导入函数以及 CALL ADDRESS 如何访问 DLL 中的代码之间的关系感到非常困惑。”

CALL ADDRESS 一词在 C++ 级别没有多大意义，所以我假设您的意思是汇编语言或机器代码级别的 CALL ADDRESS。

那么问题是，当一个 DLL 被加载到某个地址而不是首选地址时，`call`指令是如何连接到 DLL 函数的？

* * *

## 它的短处。

*   在机器代码级别，`call`具有指定地址的 a 通过调用由单个`jmp`指令组成的最小转发例程来工作。该`jmp`指令通过查表调用 DLL 函数。通常，DLL 的导入库会导出带有名称前缀的 DLL 函数本身和**`__imp__`**不带名称前缀的包装例程，例如`__imp__MessageBoxA@16`和`_MessageBoxA@16`。

即，除了我发明了以下名称外，汇编程序通常会翻译

    `call MessageBox`

进入

    `call MessageBox_forwarder`
     `;` *不管在这里*
    `MessageBox_forwarder: jmp ds:[MessageBox_tableEntry]`

加载 DLL 时，加载程序将相关地址放入表中。

*   在汇编语言级别`call`，将例程指定为标识符的 a 可以映射到 a`call`到转发器，或`call`通过表查找直接映射到 DLL 函数，具体取决于为标识符声明的类型。

*   可以有多个 DLL 函数地址表，即使是从同一个 DLL 导入。但总的来说，它们被认为是一张大表，然后称为“*导入地址表*” ，或简称**IAT**。IAT 表（或更准确地说是表）每个都位于图像中的固定位置，即当代码加载到不喜欢的地方而不是固定地址时，它们会随代码一起移动。

当前[选择的解决方案答案](https://stackoverflow.com/a/14416449/464581)在以下方面不**正确**：

*   答案是“它不起作用，这就是为什么它不是这样做的。”，其中“它”可能是指一个呼叫地址。但是在汇编或机器代码级别使用 CALL ADDRESS 可以很好地调用 DLL 函数。前提是正确完成。

*   答案认为 IAT 位于固定地址。但事实并非如此。

* * *

## 呼叫地址工作得很好。

让我们考虑一个*具体*的CALL ADDRESS 指令，其中地址是一个众所周知的 DLL 函数，即`MessageBoxA`从 [user32.dll] DLL 调用 Windows API 函数：

```
call MessageBoxA 
```

使用这个指令没有问题。

正如您将在下面看到的，在机器代码级别，该`call`指令本身仅包含一个偏移量，该偏移量导致调用执行一条`jmp`指令，该指令在函数指针的导入地址表中查找 DLL 例程地址，该表通常由加载程序在加载有问题的 DLL 时。

为了能够检查机器代码，这里有一个使用该具体示例指令的完整 32 位 x86 汇编语言程序：

```
.model flat, stdcall
option casemap :none        ; Case sensitive identifiers, please.
_as32bit        textequ <DWord ptr>

public  start

ExitProcess                     proto stdcall :DWord

MessageBoxA_t                   typedef proto stdcall :DWord, :DWord, :DWord, :DWord
extern MessageBoxA              : MessageBoxA_t
extern _imp__MessageBoxA@16     : ptr MessageBoxA_t

MB_ICONINFORMATION      equ     0040h
MB_SETFOREGROUND        equ     00010000h
infoBoxOptions          equ     MB_ICONINFORMATION or MB_SETFOREGROUND

    .const
boxtitle_1  db  "Just FYI 1 (of 3):", 0
boxtitle_2  db  "Just FYI 2 (of 3):", 0
boxtitle_3  db  "Just FYI 3 (of 3):", 0
boxtext     db  "There’s intelligence somewhere in the universe", 0

    .code
start:
    push infoBoxOptions
    push offset boxtitle_1
    push offset boxtext
    push 0
    call MessageBoxA                    ; Call #1 - to jmp to DLL-func.

    push infoBoxOptions
    push offset boxtitle_2
    push offset boxtext
    push 0
    call ds:[_imp__MessageBoxA@16]      ; Call #2 - directly to DLL-func.

    push infoBoxOptions
    push offset boxtitle_3
    push offset boxtext
    push 0
    call _imp__MessageBoxA@16           ; Call #3 - same as #2, due to type of identifier.

    push 0  ; Exit code, 0 indicates success.
    call ExitProcess
end 
```

使用 Microsoft 的工具链进行组装和链接，其中`/debug`链接器选项要求链接器生成 PDB 调试信息文件以与 Visual Studio 调试器一起使用：

```
[d:\dev\test\call]
> *ml /nologo /c asm_call.asm*
 组装：asm_call.asm

[d:\dev\test\call]
>*链接 /nologo asm_call.obj kernel32.lib user32.lib /entry:start /subsystem:windows /debug*

[d:\dev\test\call]
>*目录 asm* /b*
asm_call.asm
asm_call.exe
asm_call.ilk
asm_call.obj
asm_call.pdb

[d:\dev\test\call]
> _

```

现在，一种简单的调试方法是启动 Visual Studio（[devenv.exe] 程序）并在 Visual Studio 中单击 [*调试*→*步入*]，或者直接按 F11：

```
[d:\dev\test\call]
> *devenv asm_call.exe*

[d:\dev\test\call]
> _

```

![在此处输入图像描述](../Images/5c7c9223a061a92e912f0cbbf84ec52e.png)

在上图中，显示了运行中的 Visual Studio 2012 调试器，最左边的大红色箭头显示了机器代码指令中的地址信息，即**`0000004E`**十六进制（注意：最低有效字节位于最低地址，在内存中首先），以及另一个大红色箭头向您显示，尽管看起来令人难以置信，但这个相当小的幻数以某种方式指定了`_MessageBoxA@16`就调试器所知，驻留在地址**`01161064h`**十六进制的函数。

*   CALL ADDRESS 指令中的地址数据是一个*偏移量*，它是相对于下一条指令的地址的，因此它不需要对更改的 DLL 位置进行任何修复。

*   调用的地址只包含一个`jmp ds:[IAT_entry_for_MessageBoxA]`.

*   此转发器代码来自导入库，而不是来自 DLL，因此它也不需要修复（但显然它确实得到了一些特殊处理，DLL 函数地址也是如此）。

第二条调用指令直接`jmp`执行第一条的操作，即在 IAT 表中查找 DLL 函数地址。

现在可以看到第三条调用指令在机器代码级别与第二条相同。`declspec( dllimport )`显然，如何在汇编中模拟 Visual C++ 并不为人所知。上述声明是一种方式，可能与文本 equ 结合使用。

* * *

## IAT 不在固定地址。

下面的 C++ 程序报告它被加载的地址、它从哪些模块导入的 DLL 函数以及各种 IAT 表所在的位置。

当它使用现代版本的 Microsoft 工具链构建时，仅使用默认值，它通常在每次运行时加载到不同的地址。

您可以使用链接器选项来防止这种行为`/dynamicbase:no`。

```
#include <assert.h>         // assert
#include <stddef.h>         // ptrdiff_t
#include <sstream>
using std::ostringstream;

#undef UNICODE
#define UNICODE
#include <windows.h>

template< class Result, class SomeType >
Result as( SomeType const p ) { return reinterpret_cast<Result>( p ); }

template< class Type >
class OffsetTo
{
private:
    ptrdiff_t offset_;
public:
    ptrdiff_t asInteger() const { return offset_; }
    explicit OffsetTo( ptrdiff_t const offset ): offset_( offset ) {}
};

template< class ResultPointee, class SourcePointee >
ResultPointee* operator+(
    SourcePointee* const            p,
    OffsetTo<ResultPointee> const   offset
    )
{
    return as<ResultPointee*>( as<char const*>( p ) + offset.asInteger() );
}

int main()
{
    auto const pImage =
        as<IMAGE_DOS_HEADER const*>( ::GetModuleHandle( nullptr ) );
    assert( pImage->e_magic == IMAGE_DOS_SIGNATURE );

    auto const pNTHeaders =
        pImage + OffsetTo<IMAGE_NT_HEADERS const>( pImage->e_lfanew );
    assert( pNTHeaders->Signature == IMAGE_NT_SIGNATURE );

    auto const& importDir =
        pNTHeaders->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_IMPORT];

    auto const pImportDescriptors = pImage + OffsetTo<IMAGE_IMPORT_DESCRIPTOR const>(
        importDir.VirtualAddress //+ importSectionHeader.PointerToRawData
        );

    ostringstream stream;
    stream << "I'm loaded at " << pImage << ", and I'm using...\n";
    for( int i = 0;  pImportDescriptors[i].Name != 0;  ++i )
    {
        auto const pModuleName = pImage + OffsetTo<char const>( pImportDescriptors[i].Name );

        DWORD const offsetNameTable = pImportDescriptors[i].OriginalFirstThunk;
        DWORD const offsetAddressTable = pImportDescriptors[i].FirstThunk;  // The module "IAT"

        auto const pNameTable = pImage + OffsetTo<IMAGE_THUNK_DATA const>( offsetNameTable );
        auto const pAddressTable = pImage + OffsetTo<IMAGE_THUNK_DATA const>( offsetAddressTable );

        stream << "\n* '" << pModuleName << "'";
        stream << " with IAT at " << pAddressTable << "\n";
        stream << "\t";
        for( int j = 0; pNameTable[j].u1.AddressOfData != 0; ++j )
        {
            auto const pFuncName =
                pImage + OffsetTo<char const>( 2 + pNameTable[j].u1.AddressOfData );
            stream << pFuncName << " ";
        }
        stream << "\n";
    }

    MessageBoxA(
        0,
        stream.str().c_str(),
        "FYI:",
        MB_ICONINFORMATION | MB_SETFOREGROUND
        );
} 
```

![在此处输入图像描述](../Images/848c2b87297ea651477bbd135057c109.png)

* * *

## 一个自我复制的 Windows 机器代码程序。

最后，根据我的原始答案，这是我为另一个目的制作的 Microsoft 汇编程序 (MASM) 程序，它说明了一些问题，因为就其性质而言（它作为输出源代码生成，在组装和运行时会生成相同的源代码，并且依此类推）它必须是完全可重定位的代码，并且只需要普通程序加载器的最少量帮助：

```
.model flat, stdcall
option casemap :none        ; Case sensitive identifiers, please.
dword_aligned textequ <4>   ; Just for readability.

    ; Windows API functions:
    extern  ExitProcess@4: proc         ; from [kernel32.dll]
    extern  GetStdHandle@4: proc        ; from [kernel32.dll]
    extern  WriteFile@20: proc          ; from [kernel32.dll]
    extern  wsprintfA: proc             ; from [user32.dll]

    STD_OUTPUT_HANDLE       equ     -11

        ; The main code.
GlobalsStruct   struct  dword_aligned
    codeStart               dword   ?
    outputStreamHandle      dword   ?
GlobalsStruct   ends
globals         textequ     <(GlobalsStruct ptr [edi])>

    .code
startup:
    jmp     code_start

    ; Trampolines to add references to these functions.
myExitProcess:    jmp ExitProcess@4
myGetStdHandle:   jmp GetStdHandle@4     
myWriteFile:      jmp WriteFile@20
mywsprintfA:      jmp wsprintfA

;------------------------------------------------------------------
;
;               The code below is reproduced, so it's all relative.

code_start:
    jmp     main

prologue:
byte    ".model flat, stdcall", 13, 10
byte    "option casemap :none", 13, 10
byte    13, 10
byte    "    extern  ExitProcess@4: proc", 13, 10
byte    "    extern  GetStdHandle@4: proc", 13, 10
byte    "    extern  WriteFile@20: proc", 13, 10
byte    "    extern  wsprintfA: proc", 13, 10
byte    13, 10
byte    "    .code", 13, 10
byte    "startup:", 13, 10
byte    "    jmp     code_start", 13, 10
byte    13, 10
byte    "jmp ExitProcess@4", 13, 10
byte    "jmp GetStdHandle@4", 13, 10
byte    "jmp WriteFile@20", 13, 10
byte    "jmp wsprintfA", 13, 10
byte    13, 10
byte    "code_start:", 13, 10
prologue_nBytes         equ     $ - prologue

epilogue:
byte    "code_end:", 13, 10
byte    "    end startup", 13, 10
epilogue_nBytes         equ     $ - epilogue

dbDirective             byte    4 dup( ' ' ), "byte       "
dbDirective_nBytes      equ     $ - dbDirective

numberFormat            byte    " 0%02Xh", 0
numberFormat_nBytes     equ     $ - numberFormat

comma                   byte    ","
windowsNewline          byte    13, 10

write:
    push    0           ; space for nBytesWritten
    mov     ecx, esp    ; &nBytesWritten

    push    0           ; lpOverlapped
    push    ecx         ; &nBytesWritten
    push    ebx         ; nBytes
    push    eax         ; &s[0]
    push    globals.outputStreamHandle
    call    myWriteFile

    pop     eax         ; nBytesWritten
    ret

displayMachineCode:
    dmc_LocalsStruct    struct  dword_aligned
        numberStringLen     dword   ?
        numberString        byte    16*4 DUP( ? )
        fileHandle          dword   ?
        nBytesWritten       dword   ?
        byteIndex           dword   ?
    dmc_LocalsStruct    ends
    dmc_locals          textequ     <[ebp - sizeof dmc_LocalsStruct].dmc_LocalsStruct>

    mov     ebp, esp
    sub     esp, sizeof dmc_LocalsStruct

    ; Output prologue that makes MASM happy (placing machine code data in context):
    ; lea     eax, prologue
        mov     eax, globals.codeStart
        add     eax, prologue - code_start
    mov     ebx, prologue_nBytes
    call    write

    ; Output the machine code bytes.
    mov     dmc_locals.byteIndex, 0

dmc_lineLoop:
    ; loop start
            ; Output a db directive
        ;lea     eax, dbDirective
            mov     eax, globals.codeStart
            add     eax, dbDirective - code_start
        mov     ebx, dbDirective_nBytes
        call    write

    dmc_byteIndexingLoop:
        ; loop start
                ; Create string representation of a number
            mov     ecx, dmc_locals.byteIndex
            mov     eax, 0
            ;mov     al, byte ptr [code_start + ecx]
                mov     ebx, globals.codeStart
                mov     al, [ebx + ecx]
            push    eax
            ;push    offset numberFormat
                mov     eax, globals.codeStart
                add     eax, numberFormat - code_start
                push    eax
            lea     eax, dmc_locals.numberString
            push    eax
            call    mywsprintfA
            add     esp, 3*(sizeof dword)
            mov     dmc_locals.numberStringLen, eax

                ; Output string representation of number
            lea     eax, dmc_locals.numberString
            mov     ebx, dmc_locals.numberStringLen
            call    write

                ; Are we finished looping yet?
            inc     dmc_locals.byteIndex
            mov     ecx, dmc_locals.byteIndex
            cmp     ecx, code_end - code_start
            je      dmc_finalNewline
            and     ecx, 07h
            jz      dmc_after_byteIndexingLoop

                ; Output a comma
            ; lea     eax, comma
                mov     eax, globals.codeStart
                add     eax, comma - code_start
            mov     ebx, 1
            call    write
            jmp dmc_byteIndexingLoop
        ; loop end

    dmc_after_byteIndexingLoop:
            ; New line
        ; lea     eax, windowsNewline
            mov     eax, globals.codeStart
            add     eax, windowsNewline - code_start
        mov     ebx, 2
        call    write
        jmp     dmc_lineLoop;
    ; loop end

dmc_finalNewline:
        ; New line
    ; lea     eax, windowsNewline
        mov     eax, globals.codeStart
        add     eax, windowsNewline - code_start
    mov     ebx, 2
    call    write

    ; Output epilogue that makes MASM happy:
    ; lea     eax, epilogue
        mov     eax, globals.codeStart
        add     eax, epilogue - code_start
    mov     ebx, epilogue_nBytes
    call    write

    mov     esp, ebp
    ret

main:
    sub esp, sizeof GlobalsStruct
    mov edi, esp

    call    main_knownAddress
main_knownAddress:
    pop     eax
    sub     eax, main_knownAddress - code_start
    mov     globals.codeStart, eax

    push    STD_OUTPUT_HANDLE
    call    myGetStdHandle
    mov     globals.outputStreamHandle, eax

    call displayMachineCode

    ; Well behaved process exit:
    push 0                          ; Process exit code, 0 indicates success.
    call myExitProcess

code_end:
    end startup 
```

这是自我复制的输出：

```
.model flat, stdcall
option casemap :none

    extern  ExitProcess@4: proc
    extern  GetStdHandle@4: proc
    extern  WriteFile@20: proc
    extern  wsprintfA: proc

    .code
startup:
    jmp     code_start

jmp ExitProcess@4
jmp GetStdHandle@4
jmp WriteFile@20
jmp wsprintfA

code_start:
    byte        0E9h, 03Bh, 002h, 000h, 000h, 02Eh, 06Dh, 06Fh
    byte        064h, 065h, 06Ch, 020h, 066h, 06Ch, 061h, 074h
    byte        02Ch, 020h, 073h, 074h, 064h, 063h, 061h, 06Ch
    byte        06Ch, 00Dh, 00Ah, 06Fh, 070h, 074h, 069h, 06Fh
    byte        06Eh, 020h, 063h, 061h, 073h, 065h, 06Dh, 061h
    byte        070h, 020h, 03Ah, 06Eh, 06Fh, 06Eh, 065h, 00Dh
    byte        00Ah, 00Dh, 00Ah, 020h, 020h, 020h, 020h, 065h
    byte        078h, 074h, 065h, 072h, 06Eh, 020h, 020h, 045h
    byte        078h, 069h, 074h, 050h, 072h, 06Fh, 063h, 065h
    byte        073h, 073h, 040h, 034h, 03Ah, 020h, 070h, 072h
    byte        06Fh, 063h, 00Dh, 00Ah, 020h, 020h, 020h, 020h
    byte        065h, 078h, 074h, 065h, 072h, 06Eh, 020h, 020h
    byte        047h, 065h, 074h, 053h, 074h, 064h, 048h, 061h
    byte        06Eh, 064h, 06Ch, 065h, 040h, 034h, 03Ah, 020h
    byte        070h, 072h, 06Fh, 063h, 00Dh, 00Ah, 020h, 020h
    byte        020h, 020h, 065h, 078h, 074h, 065h, 072h, 06Eh
    byte        020h, 020h, 057h, 072h, 069h, 074h, 065h, 046h
    byte        069h, 06Ch, 065h, 040h, 032h, 030h, 03Ah, 020h
    byte        070h, 072h, 06Fh, 063h, 00Dh, 00Ah, 020h, 020h
    byte        020h, 020h, 065h, 078h, 074h, 065h, 072h, 06Eh
    byte        020h, 020h, 077h, 073h, 070h, 072h, 069h, 06Eh
    byte        074h, 066h, 041h, 03Ah, 020h, 070h, 072h, 06Fh
    byte        063h, 00Dh, 00Ah, 00Dh, 00Ah, 020h, 020h, 020h
    byte        020h, 02Eh, 063h, 06Fh, 064h, 065h, 00Dh, 00Ah
    byte        073h, 074h, 061h, 072h, 074h, 075h, 070h, 03Ah
    byte        00Dh, 00Ah, 020h, 020h, 020h, 020h, 06Ah, 06Dh
    byte        070h, 020h, 020h, 020h, 020h, 020h, 063h, 06Fh
    byte        064h, 065h, 05Fh, 073h, 074h, 061h, 072h, 074h
    byte        00Dh, 00Ah, 00Dh, 00Ah, 06Ah, 06Dh, 070h, 020h
    byte        045h, 078h, 069h, 074h, 050h, 072h, 06Fh, 063h
    byte        065h, 073h, 073h, 040h, 034h, 00Dh, 00Ah, 06Ah
    byte        06Dh, 070h, 020h, 047h, 065h, 074h, 053h, 074h
    byte        064h, 048h, 061h, 06Eh, 064h, 06Ch, 065h, 040h
    byte        034h, 00Dh, 00Ah, 06Ah, 06Dh, 070h, 020h, 057h
    byte        072h, 069h, 074h, 065h, 046h, 069h, 06Ch, 065h
    byte        040h, 032h, 030h, 00Dh, 00Ah, 06Ah, 06Dh, 070h
    byte        020h, 077h, 073h, 070h, 072h, 069h, 06Eh, 074h
    byte        066h, 041h, 00Dh, 00Ah, 00Dh, 00Ah, 063h, 06Fh
    byte        064h, 065h, 05Fh, 073h, 074h, 061h, 072h, 074h
    byte        03Ah, 00Dh, 00Ah, 063h, 06Fh, 064h, 065h, 05Fh
    byte        065h, 06Eh, 064h, 03Ah, 00Dh, 00Ah, 020h, 020h
    byte        020h, 020h, 065h, 06Eh, 064h, 020h, 073h, 074h
    byte        061h, 072h, 074h, 075h, 070h, 00Dh, 00Ah, 020h
    byte        020h, 020h, 020h, 062h, 079h, 074h, 065h, 020h
    byte        020h, 020h, 020h, 020h, 020h, 020h, 020h, 030h
    byte        025h, 030h, 032h, 058h, 068h, 000h, 02Ch, 00Dh
    byte        00Ah, 06Ah, 000h, 08Bh, 0CCh, 06Ah, 000h, 051h
    byte        053h, 050h, 0FFh, 077h, 004h, 0E8h, 074h, 0FEh
    byte        0FFh, 0FFh, 058h, 0C3h, 08Bh, 0ECh, 083h, 0ECh
    byte        050h, 08Bh, 007h, 005h, 005h, 000h, 000h, 000h
    byte        0BBh, 036h, 001h, 000h, 000h, 0E8h, 0D7h, 0FFh
    byte        0FFh, 0FFh, 0C7h, 045h, 0FCh, 000h, 000h, 000h
    byte        000h, 08Bh, 007h, 005h, 057h, 001h, 000h, 000h
    byte        0BBh, 00Fh, 000h, 000h, 000h, 0E8h, 0BFh, 0FFh
    byte        0FFh, 0FFh, 08Bh, 04Dh, 0FCh, 0B8h, 000h, 000h
    byte        000h, 000h, 08Bh, 01Fh, 08Ah, 004h, 019h, 050h
    byte        08Bh, 007h, 005h, 066h, 001h, 000h, 000h, 050h
    byte        08Dh, 045h, 0B4h, 050h, 0E8h, 02Ah, 0FEh, 0FFh
    byte        0FFh, 083h, 0C4h, 00Ch, 089h, 045h, 0B0h, 08Dh
    byte        045h, 0B4h, 08Bh, 05Dh, 0B0h, 0E8h, 08Fh, 0FFh
    byte        0FFh, 0FFh, 0FFh, 045h, 0FCh, 08Bh, 04Dh, 0FCh
    byte        081h, 0F9h, 068h, 002h, 000h, 000h, 074h, 02Bh
    byte        083h, 0E1h, 007h, 074h, 013h, 08Bh, 007h, 005h
    byte        06Eh, 001h, 000h, 000h, 0BBh, 001h, 000h, 000h
    byte        000h, 0E8h, 06Bh, 0FFh, 0FFh, 0FFh, 0EBh, 0AAh
    byte        08Bh, 007h, 005h, 06Fh, 001h, 000h, 000h, 0BBh
    byte        002h, 000h, 000h, 000h, 0E8h, 058h, 0FFh, 0FFh
    byte        0FFh, 0EBh, 086h, 08Bh, 007h, 005h, 06Fh, 001h
    byte        000h, 000h, 0BBh, 002h, 000h, 000h, 000h, 0E8h
    byte        045h, 0FFh, 0FFh, 0FFh, 08Bh, 007h, 005h, 03Bh
    byte        001h, 000h, 000h, 0BBh, 01Ch, 000h, 000h, 000h
    byte        0E8h, 034h, 0FFh, 0FFh, 0FFh, 08Bh, 0E5h, 0C3h
    byte        083h, 0ECh, 008h, 08Bh, 0FCh, 0E8h, 000h, 000h
    byte        000h, 000h, 058h, 02Dh, 04Ah, 002h, 000h, 000h
    byte        089h, 007h, 06Ah, 0F5h, 0E8h, 098h, 0FDh, 0FFh
    byte        0FFh, 089h, 047h, 004h, 0E8h, 023h, 0FFh, 0FFh
    byte        0FFh, 06Ah, 000h, 0E8h, 084h, 0FDh, 0FFh, 0FFh
code_end:
    end startup 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:22:28.790

链接器。当您的可执行文件被链接时，链接器将替换所有 DLL 地址并将其作为基础。由于虚拟内存，所有进程都加载到相同的基地址，从而使寻址更容易。因为 DLL 是 PIL（位置无关代码），加载程序可以为应用程序重新设置 DLL。因为代码引用了liker 可以重定位的符号，所以它永远不需要关心它的位置。

编辑：刚刚意识到其中一些是关闭的——Linux 动态库是 PIL，Windows 不是（这就是我们必须重新设置基准的原因）。

# c# - 如何在 WP8 中更新我的应用程序的动态磁贴徽章？

> ID：14416206
> 
> 赞同：0
> 
> 时间：2013-01-19T16:13:14.897
> 
> 标签：c#, xml, windows-phone-8, windows-store-apps, badge

我希望 Nathan 的“带有 XAML 和 C# 的 Windows 8 应用程序”第 549 页的代码：

```
 //string xmlString = @"<badge value='2'/>";
    string xmlString = string.Format(@"<badge value={0}/>", 42);
    XmlDocument document = new XmlDocument(); 
    document.LoadXml(xmlString); 
    BadgeNotification notification = new BadgeNotification(document);
    BadgeUpdateManager.CreateBadgeUpdaterForApplication().Update(notification); 
```

...也适用于 WP8，但许多类在我的 WP8 ScheduledTaskAgent 中无法识别，即 XmlDocument、BadgeNotification 和 BadgeUpdateManager。

我怎样才能从我的 ScheduledTaskAgent 在 WP8 中完成同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:15:29.797

WP8 上用于更新徽章的 API 与 Windows 8 上的不同。可以使用对象[`Count`](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.shell.standardtiledata.count%28v=vs.105%29.aspx)上的属性设置徽章值[`StandardTileData`](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh203149%28v=vs.105%29.aspx)。

MSDN 上的[WP8 Tile 示例](http://code.msdn.microsoft.com/wpapps/Tile-Sample-ef741c45/sourcecode?fileId=62821&pathId=110379512)显示了更详细的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-15T08:44:35.377

```
XmlDocument badgeDOM = new XmlDocument();
badgeDOM.LoadXml(string.Format("<badge value='{0}'/>", 42));
BadgeNotification badge = new BadgeNotification(badgeDOM);
BadgeUpdateManager.CreateBadgeUpdaterForApplication().Update(badge); 
```

# haskell - GHCi 调试器中的自由变量

> ID：14416211
> 
> 赞同：4
> 
> 时间：2013-01-19T16:13:36.610
> 
> 标签：haskell, functional-programming

在 GHC 用户手册[GHCI 调试器](http://www.haskell.org/ghc/docs/7.6.1/html/users_guide/ghci-debugger.html#breakpoints)部分中，声明：

> GHCi 为放置断点的表达式的自由变量（**a、left、right**）提供了绑定，另外还为表达式的结果提供了绑定（**_result**）。

因此，这里的自由变量是**a, left, right**。

为什么变量**as**不是*自由*变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T16:23:38.623

断点位于第二行，内容为

```
qsort (a:as) = qsort left ++ [a] ++ qsort right 
```

但断点将在右边的表达式上`=`，如它所说：

```
Breakpoint 0 activated at qsort.hs:2:15-46 
```

所以这是字符 15-46 - 右侧。`as`没有出现在右手边，所以这就是为什么它不是那个表达式的自由变量。

# javascript - 使用 JavaScript 解析 textarea 时没有输出

> ID：14416212
> 
> 赞同：-1
> 
> 时间：2013-01-19T16:13:56.617
> 
> 标签：javascript, html, parsing, textarea

我有一个文本框，其中将粘贴一大块文本。

然后我将文本解析为一个数组，删除空格。我需要从某些数组元素中提取数据并将它们放入单独的变量中，以便生成更清晰、格式化的输出。

问题是注意似乎是从数组传递到我的变量中的。我玩弄了一点，数组被正确填充，但元素没有将字符串传递给变量。

HTML：

```
<p>Contact Name: <b id='contactNameOutput'></b></p> 
```

JavaScript：

```
function generateOutputfvoc() {
    var inputArr = document.getElementById('inputBox').value.split(/[\s]/);
    document.getElementById('contactNameOutput').innerHTML = inputArr[0];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:28:58.710

这里发生了很多事情，很难理解您为什么要这样做。我的假设`inputBox`是用户在其中写入内容的文本区域或输入字段。

好的，所以你在空格上分割那个字符串，例如字符串

> 敏捷的棕色狐狸

将产生一个如下所示的数组：

```
inputArr = ["The", "quick", "brown", "fox"] 
```

现在在您的 for 循环中，您正在迭代这个数组，从 0 开始并递增直到到达数组的末尾，这没什么奇怪的。

但是在第一次迭代中，在您拥有的 if 子句中，您尝试使用负值访问数组，记住`i`is `0`，这会导致未定义的值，也在您尝试的 if 子句的最后部分访问`i+1`好当`i`它的最后一个值时会发生什么？！你猜对了另一个未定义！稍后循环将访问您已经经历过的旧值，老实说，我无法弄清楚您要完成什么。

你所有的 if 语句真的是一团糟，特别是如果你要在那个循环中执行它们。我的猜测是你认为你需要一个 for 循环，而实际上你不需要。

你所拥有的是一个包含文本区域中单词的数组，如果你知道你期望的顺序，（你真的知道用户会在那个文本区域中输入什么吗？），那么你可以直接访问这些单词，因为您将知道数组中每个项目的索引。否则，将其重写为更简单的东西，始终尽量保持简单。

另外，为什么不抬头看`refactoring`呢？！

**编辑**

我认为您现在遇到的问题是数组中的第一个元素是一个空字符串，如果输入的开头有空格，就会发生这种情况。

# .net - 对象错误的实例？

> ID：14416216
> 
> 赞同：0
> 
> 时间：2013-01-19T16:14:26.410
> 
> 标签：.net, c#-4.0, gridview, devexpress, gridcontrol

我有一个 GridControl 插入其中，直接修改到数据库中。

我有几个字段直接连接到一个表`Patient`，我的 gridcontrol 字段之一`id`是`especielistas 1` `Table`Specialist `which has a 1:1 Relationship`Esp-> MuchosPacientes `and this field shows you all`ID 专家`and lets me do the main functions. But to eliminate me says no sender == null`，但实现了相同的代码，但针对 1 个事件`KeyDown`并且它是否完全删除`sender != null`，可以是：

```
private void gridControl1_EmbeddedNavigator_ButtonClick(
        object sender,
         NavigatorButtonClickEventArgs e)
{           
    if (e.Button.ButtonType == NavigatorButtonType.Edit 
        || e.Button.ButtonType == NavigatorButtonType.EndEdit)
    {
        ColumnView view = gridControl1.FocusedView as ColumnView;
        view.CloseEditor();

        if (view.UpdateCurrentRow())
        {
            pacienteTableAdapter.Update(dBDataSet);
        }
    }
    else if (e.Button.ButtonType == NavigatorButtonType.Remove)
    {

        if (MessageBox.Show("Desea eliminar?", "Confirmación", MessageBoxButtons.YesNo) != DialogResult.Yes)
            return;

        GridView view = sender as GridView;   //AQUI ES EL ERROR
        view.DeleteRow(view.FocusedRowHandle);
        pacienteTableAdapter.Update(dBDataSet);

    }           
}

private void gridView1_KeyDown(object sender, KeyEventArgs e) 
{
    if (e.KeyCode == Keys.Delete)
    {
        if (MessageBox.Show("Desea eliminar?", "Confirmación", MessageBoxButtons.YesNo) != DialogResult.Yes)
            return;

        GridView view = sender as GridView;
        view.DeleteRow(view.FocusedRowHandle);
        pacienteTableAdapter.Update(dBDataSet);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T10:05:48.250

原因是，`gridView1_KeyDown`如果发送者是`gridView1`这样，当您投射到 GridView 时 - 一切都很好。

因此，如果`gridControl1_EmbeddedNavigator_ButtonClick`您的发件人是`gridControl1`，当您从发件人投射时，您会得到`null`。

尝试转换为 GridControl 然后获取 Views 或重命名`gridView1`为更具解释性的名称并直接引用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:39:42.437

您是否尝试过使用“gridView1”而不是“view”（来自“sender”）？

# javascript - 无法刷新 jQuery 周历

> ID：14416220
> 
> 赞同：0
> 
> 时间：2013-01-19T16:14:53.957
> 
> 标签：javascript, jquery, calendar, refresh

我正在使用 jQuery weekcalendar 创建一个带有约会的基于网络的日历。根据[文档](https://github.com/themouette/jquery-week-calendar/wiki/Public-methods)，刷新日历应该很容易：

```
$(“#calendar”).weekCalendar(“refresh”); // Refreshes the currently rendered week – if the events are based on a remote data source they will be refetched. 
```

这是我的html：

```
<div id="calendar"></div> 
```

当我尝试调用此代码时，日历不会刷新。我究竟做错了什么？

```
$('#calendar').weekCalendar('refresh'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:04:33.397

我使用数据库中的 JSON 获取我的事件和用户。`events`我将所需的步骤导出到一个获取`users`并刷新`eventData1`.

在这一步之后，正常的刷新命令完成了这项工作：

```
 getEvents();
 $("#calendar").weekCalendar("refresh"); 
```

# python - 捕获所有异常然后关闭 Com 端口

> ID：14416221
> 
> 赞同：0
> 
> 时间：2013-01-19T16:14:58.093
> 
> 标签：python, windows, python-2.7

我正在修改一个通过串行连接发送和接收数据的重要程序（有 2 个线程）。很多时候，由于意外错误（或我的编码错误:)）程序终止并且COM端口保持打开状态。在下一次后续运行中，尝试打开 COM 端口时出现错误。我想尝试完全缓解这种情况的发生，并确保无论在哪里发生错误 - 都会运行一段故障安全代码并尝试关闭 COM 端口。

我可以将整个程序包装在一个 try/except/finally 块中，还是必须对每个线程/类进行微观管理？问候西蒙

如果有帮助，请编辑代码

```
#usual python imports etc
...
board = pyfirmata.Arduino("COM26", baudrate=57600) # Replace COM26 with your Arduino port
...
#vairable initilistation

class MyError(Exception):
    def __init__(self, value):
        self.value = value

    def __str__(self):
        return repr(self.value)

class ScratchSender(threading.Thread):
    #one of the threads

class ScratchListener(threading.Thread):
    #the other thread

#bit of code

def cleanup_threads(threads):
    for thread in threads:
        thread.stop()

    for thread in threads:
        thread.join()

if __name__ == '__main__':
    if len(sys.argv) > 1:
        host = sys.argv[1]
    else:
        host = DEFAULT_HOST

cycle_trace = 'start'
while True:

    if (cycle_trace == 'disconnected'):
        cleanup_threads((listener, sender))
        time.sleep(1)
        cycle_trace = 'start'

    if (cycle_trace == 'start'):
        listener = ScratchListener(the_socket)
        sender = ScratchSender(the_socket)
        cycle_trace = 'running'
        listener.start()
        sender.start()

    # wait for ctrl+c
    try:
        #bit of code
        #print "motorA val:" , motorA

        if ((motorA > 0) or (motorB > 0)):
            #do something
        else:
            #just let the threads do their stuff in the background
            time.sleep(0.1)
    except KeyboardInterrupt:
        cleanup_threads((listener,sender))
        board.exit()
        sys.exit() 
```

# php - 如何从 HTML 多选组合框中查询存储为逗号分隔值的值

> ID：14416223
> 
> 赞同：0
> 
> 时间：2013-01-19T16:15:02.883
> 
> 标签：php, mysql, combobox, multiple-select-query

我在 html 页面上有一个多选组合框。国家的实际清单大约是 60 项。

```
<select name="country[]" multiple="multiple">
  <option value="UK">United Kingdom</option>
  <option value="FR">France</option>
  <option value="DE">Germany</option>
  <option value="JP">Japan</option>
</select> 
```

在数据库中，国家列表以逗号分隔的字符串形式存储在行中，例如项目一可能是 uk、de 或 fr、de、jp 等。

我希望能够在组合框中选择多个项目并拉出项目，以便显示与该国家/地区一起选择的任何国家/地区的项目。一个问题是 country 列存储了一个逗号分隔的字符串值。

```
SELECT * FROM projects WHERE FIND_IN_SET("country","DE, UK")' 
```

我的问题是 FIND_IN_SET 只会匹配整个字符串。上面的代码可能会找到一个国家/地区只有 DE 或 UK 的项目，但不会找到例如“FR,UK”的项目。

如何解析列 country 并创建 SQL 查询以显示我在组合框中选择的国家/地区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:19:56.847

如果您想在一个字段中存储多个值（集合的一种形式），您需要以一种允许您稍后更轻松地解析它的方式来执行此操作。

一种常见的方法是在每一边都有分隔符，包括第一个和最后一个元素：

```
,de,us,en, 
```

`,`允许您通过将其包装在分隔符内（此处）来搜索该集合中的单个值。

在您的示例中，您不会使用 Mysql btw 执行此操作（这在技术上也应该是可能的），但是您需要在输出`<SELECT>`输入元素时检查这一点，以便您可以将这些元素标记为已选择，哪个值在集合内。

# c# - Orchard CMS：Vandelay Industries 的 RemoteRss

> ID：14416225
> 
> 赞同：2
> 
> 时间：2013-01-19T16:15:15.803
> 
> 标签：c#, asp.net, asp.net-mvc, orchardcms, orchardcms-1.6

我在 Orchard CMS 上磕磕绊绊，想覆盖 Vandelay Industries 的 RemoteRSS 小部件的默认模板。当前模板位于：

```
~/Modules/Vandelay.Industries/Views/Parts/RemoteRss.cshtml 
```

所以，

*   是否可以覆盖此模板
*   如果是这样，我应该在哪里放置我的新模板，以免“损坏”原始模板

我尝试将其保存为：

```
C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\RemoteRss.cshtml

C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\Parts.RemoteRss.cshtml

C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\Parts\RemoteRss.cshtml 
```

但这些似乎没有生效，甚至导致错误。

提前致谢。

* * *

***附加信息***

```
C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\RemoteRss.cs‌​html 
```

似乎没有任何效果。

```
~/Modules/Vandelay.Industries/Views/Parts/RemoteRss.cshtml 
```

但是，这里的相同代码可以正常工作。

```
C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\Parts.Remote‌​‌​Rss.cshtml 
```

导致运行时错误：编译器错误消息：CS0012：类型“System.Xml.IXmlLineInfo”在未引用的程序集中定义。您必须添加对程序集“System.Xml，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

```
C:\inetpub\wwwroot\cc_orchard_live_2012\Themes\FlexoPurchased\Views\Parts\Remote‌​‌​Rss.cshtml 
```

引发运行时错误：编译器错误消息：CS0012：类型“System.Xml.IXmlLineInfo”在未引用的程序集中定义。您必须添加对程序集“System.Xml，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T00:33:10.320

您需要从主题项目中引用 System.Xml 才能覆盖该模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T07:32:52.957

您可以通过将 System.Xml.dll 复制到站点的 /bin 文件夹中来解决此问题。无需进一步配置。

如果您不知道在哪里可以找到此文件，请创建一个新的 Web 项目，将 System.Xml 的引用添加到您的项目中，右键单击引用列表中的新引用，转到 Copy Local 属性并将其更改为真的。构建项目时，System.Xml.dll 将被复制到项目的 /bin 目录中。你可以从那里得到它。

# ember.js - 为什么 application.hbs 不在 emberjs 中呈现

> ID：14416231
> 
> 赞同：1
> 
> 时间：2013-01-19T16:15:51.530
> 
> 标签：ember.js

使用 ember 1.0.0-pre3

我有一个包含以下代码的小应用程序：

```
window.App = Ember.Application.create()

App.ApplicationController = Ember.Controller.extend({})

App.Router.reopen
  location: 'history'

App.Router.map ->
  @resource 'users', ->
    @route 'new'

App.IndexRoute = Ember.Route.extend
  renderTemplate: ->
    @render('index') 
```

这是模板目录中的 application.hbs：

```
<div class='navbar navbar-inverse navbar-fixed-top'>
  <div class='navbar-inner'>
    <div class='container'>
      <div class='nav-collapse collapse'>
        <ul class='nav'>
          <li>{{#linkTo 'index'}}Home{{/linkTo}}</li>
          <li>{{#linkTo 'users.index'}}Users{{/linkTo}}</li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div class='container' id='main'>
  <div class='content'>
    <div class='row'>
      <div class='span12'>
        <div class='page-header'></div>
        {{outlet}}
      </div>
    </div>
  </div>
</div> 
```

问题是它不呈现这个模板。在基本 URL“http://127.0.0.1:3000/”处加载应用程序时不会引发错误。如果我尝试未定义的路由，它将引发错误，因此我知道 Ember 已加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:39:04.253

您的 ember 代码似乎没有任何问题。我在 jsbin 上做了一个副本，它工作正常：http: [//jsbin.com/ipivoz/1/edit](http://jsbin.com/ipivoz/1/edit)

很确定这意味着您的模板没有被编译。可以肯定的是，尝试将以下内容添加到您的应用程序就绪挂钩中：

```
window.App = Ember.Application.create({
  ready: function() {
    console.log("Ember.TEMPLATES: ", Ember.TEMPLATES);
  }
}); 
```

Ember 期望已编译的车把模板位于此数组中。如果您在打开 js 控制台的情况下运行上述 jsbin，您会看到数组中有一个模板“应用程序”。我的猜测是，如果您在您的环境中尝试相同的操作，该数组将为空。

有很多方法可以做到这一点，这取决于您的环境。由于您在端口 3000 上运行，我猜那是导轨。在这种情况下，请查看 ember-rails gem。到目前为止，最简单的短期方法是使用`script`HTML 页面中的标签定义模板，就像我在 jsbin 中所做的那样。

# php - 从 Android 向本地服务器发出请求时出现连接错误

> ID：14416232
> 
> 赞同：0
> 
> 时间：2013-01-19T16:15:56.063
> 
> 标签：php, android, json

我正在构建一个将 json 从数据库解析为列表视图的应用程序。我已使用 PHP 脚本将数据库中的数据编码为以下 JSON 格式：

```
[
 {"id":"1","artistname":"Rihanna"},
 {"id":"2","artistname":"Katy Perry"},
 {"id":"3","artistname":"DJ Dibs"},
 {"id":"4","artistname":"Jamie Foxx"},
 {"id":"5","artistname":"Disclosure"}

] 
```

这是解析器类，它以字符串形式返回上述数据：

```
 package com.example.jsontester;

     public class JsonParser {
     static InputStream is = null;
     static JSONObject jsonObject = null;
     static String data = "";

     public JsonParser() {

     }

     public String getJSONFromUrl(String url) {

     // Making HTTP request
     try {
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();            

     } 
     catch (UnsupportedEncodingException exception) {
        exception.printStackTrace();
     } catch (ClientProtocolException exception) {
        exception.printStackTrace();
     } catch (IOException exception) {
        exception.printStackTrace();
     }

     //Gets the JSON String
     try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);

        StringBuilder sBuilder = new StringBuilder();
        String line = null;

        //Appends the string to the line
        while ((line = reader.readLine()) != null) {
            sBuilder.append(line + "\n");
        }

        is.close();
        data = sBuilder.toString();

      } 

      catch (Exception exception) {
        exception.printStackTrace();
      }

     return data;

    }
   } 
```

这是使用图表项创建列表视图的活动

```
package com.example.jsontester;

 public class JsonActivity extends ListActivity{

 private ProgressDialog progressDialog;

    // JSON Node names
    private static final String TAG_ITEM = "item";
    private static final String TAG_ID = "id";
    private static final String TAG_ARTISTNAME = "artistname";

 // chartItemList is the array list that holds the chart items 
    ArrayList<HashMap<String, Integer>> chartItemList = 
         new ArrayList<HashMap<String, Integer>>();
    JsonParser Parser = new JsonParser();
 // JSONArray
    JSONArray chartItems = null;

/** Called when the activity is first created. */    
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.progressdialog);

    //url from where the JSON has to be retrieved
    String url = <<http://127.0.0.1/mmcv/>>;

    //Check if the user has a connection

    ConnectivityManager cm = 
        (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo info = cm.getActiveNetworkInfo();
    if (info != null) {
        if (!info.isConnected()) {
            Toast.makeText(this, 
           "Please check your connection and try again.", Toast.LENGTH_SHORT).show();
        }

        //if positive, fetch the articles in background
        else new getChartItems().execute(url);
    }

    //else show toast
    else {
        Toast.makeText(this, "Please check your connection and try again.", 
             Toast.LENGTH_SHORT).show();
    }

}

class getChartItems extends AsyncTask<String, String, String> {

    // Shows a progress dialog while executing background task
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        progressDialog = new ProgressDialog(JsonActivity.this);
        progressDialog.setMessage("Loading chart...");
        progressDialog.setIndeterminate(false);
        progressDialog.setCancelable(false);
        progressDialog.show();
    }

    //Gets the json data for chart items data and presents it in a list view
    @Override
    protected String doInBackground(String... args) {
        String url = <<http://127.0.0.1/mmcv>>;
        String json = Parser.getJSONFromUrl(url);
        System.out.println("Json should be below me");
        System.out.println(json);
        int id;

        String artistname;

        try{

        chartItems = new JSONArray(json);

        JSONObject json_data=null;

         for(int i=0;i<chartItems.length();i++){

            json_data = chartItems.getJSONObject(i);

            artistname=json_data.getString("TAG_ARTISTNAME");
            id=json_data.getInt("TAG_ID");

             HashMap<String, Integer> hashMap = new HashMap<String, Integer>();
             // adding each child node to HashMap key => value
                hashMap.put(artistname,id);

             // adding HashMap to ArrayList
                chartItemList.add(hashMap);

         }
        }

        catch (JSONException e) {
            e.printStackTrace();
        }

        runOnUiThread(new Runnable() {
            public void run() {

             //updating list view with the parsed items
                ListAdapter adapter = new SimpleAdapter(JsonActivity.this, chartItemList,
                R.layout.listview,
                new String[] { TAG_ID, TAG_ARTISTNAME }, new int[] {R.id.id, 
                    R.id.artistname });
                setListAdapter(adapter);
            }
        });
        return null;
    }

    //Removes the progress dialog when the data has been fetched
    protected void onPostExecute(String args) {
        progressDialog.dismiss();
    }
}

 } 
```

这是日志猫：

```
01-19 15:45:49.816: D/libEGL(29490): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
01-19 15:45:49.867: W/System.err(29490): org.apache.http.conn.HttpHostConnectException: Connection to     

   (http://127.0.0.1) refused
01-19 15:45:49.898: D/libEGL(29490): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
01-19 15:45:49.902: D/libEGL(29490): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
01-19 15:45:49.914: W/System.err(29490):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:183)
01-19 15:45:49.918: W/System.err(29490):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
01-19 15:45:49.925: W/System.err(29490):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
01-19 15:45:49.925: W/System.err(29490):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
01-19 15:45:49.925: W/System.err(29490):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
01-19 15:45:49.925: W/System.err(29490):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
01-19 15:45:49.929: W/System.err(29490):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
01-19 15:45:49.929: W/System.err(29490):    at com.example.jsontester.JsonParser.getJSONFromUrl(JsonParser.java:36)
01-19 15:45:49.929: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:83)
01-19 15:45:49.929: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:1)
01-19 15:45:49.933: W/System.err(29490):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-19 15:45:49.933: W/System.err(29490):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
01-19 15:45:49.933: W/System.err(29490):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-19 15:45:49.933: W/System.err(29490):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-19 15:45:49.933: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-19 15:45:49.937: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-19 15:45:49.937: W/System.err(29490):    at java.lang.Thread.run(Thread.java:856)
01-19 15:45:49.937: W/System.err(29490): Caused by: java.net.ConnectException: failed to connect to /<<127.0.0.1>> (port 80): connect failed: ECONNREFUSED (Connection refused)
01-19 15:45:49.941: W/System.err(29490):    at libcore.io.IoBridge.connect(IoBridge.java:114)
01-19 15:45:49.941: W/System.err(29490):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
01-19 15:45:49.945: W/System.err(29490):    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
01-19 15:45:49.945: W/System.err(29490):    at java.net.Socket.connect(Socket.java:842)
01-19 15:45:49.945: W/System.err(29490):    at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
01-19 15:45:49.957: W/System.err(29490):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
01-19 15:45:49.957: D/OpenGLRenderer(29490): Enabling debug mode 0
01-19 15:45:49.957: W/System.err(29490):    ... 16 more
01-19 15:45:49.961: W/System.err(29490): Caused by: libcore.io.ErrnoException: connect failed: ECONNREFUSED (Connection refused)
01-19 15:45:49.972: W/System.err(29490):    at libcore.io.Posix.connect(Native Method)
01-19 15:45:49.992: W/System.err(29490):    at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
01-19 15:45:49.992: W/System.err(29490):    at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
01-19 15:45:49.992: W/System.err(29490):    at libcore.io.IoBridge.connect(IoBridge.java:112)
01-19 15:45:49.992: W/System.err(29490):    ... 21 more
01-19 15:45:49.992: W/System.err(29490): java.lang.NullPointerException
01-19 15:45:49.996: W/System.err(29490):    at java.io.Reader.<init>(Reader.java:64)
01-19 15:45:49.996: W/System.err(29490):    at java.io.InputStreamReader.<init>(InputStreamReader.java:79)
01-19 15:45:50.000: W/System.err(29490):    at com.example.jsontester.JsonParser.getJSONFromUrl(JsonParser.java:51)
01-19 15:45:50.000: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:83)
01-19 15:45:50.007: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:1)
01-19 15:45:50.011: W/System.err(29490):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-19 15:45:50.011: W/System.err(29490):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
01-19 15:45:50.023: W/System.err(29490):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-19 15:45:50.031: W/System.err(29490):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-19 15:45:50.031: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-19 15:45:50.035: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-19 15:45:50.035: W/System.err(29490):    at java.lang.Thread.run(Thread.java:856)
01-19 15:45:50.039: I/System.out(29490): Json should be below me
01-19 15:45:50.050: W/System.err(29490): org.json.JSONException: End of input at character 0 of 
01-19 15:45:50.125: W/System.err(29490):    at org.json.JSONTokener.syntaxError(JSONTokener.java:450)
01-19 15:45:50.152: W/System.err(29490):    at org.json.JSONTokener.nextValue(JSONTokener.java:97)
01-19 15:45:50.152: W/System.err(29490):    at org.json.JSONArray.<init>(JSONArray.java:87)
01-19 15:45:50.152: W/System.err(29490):    at org.json.JSONArray.<init>(JSONArray.java:103)
01-19 15:45:50.152: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:92)
01-19 15:45:50.152: W/System.err(29490):    at com.example.jsontester.JsonActivity$getChartItems.doInBackground(JsonActivity.java:1)
01-19 15:45:50.156: W/System.err(29490):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
01-19 15:45:50.156: W/System.err(29490):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
01-19 15:45:50.156: W/System.err(29490):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-19 15:45:50.156: W/System.err(29490):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
01-19 15:45:50.156: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-19 15:45:50.156: W/System.err(29490):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-19 15:45:50.156: W/System.err(29490):    at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:25:24.657

域 127.0.0.1 使设备在设备本身上查找 Web 服务器。请改用 10.0.2.2。

这是有关如何在模拟器中使用网络的链接

[http://developer.android.com/tools/devices/emulator.html#emulatornetworking](http://developer.android.com/tools/devices/emulator.html#emulatornetworking)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:30:19.980

您犯了使用“localhost”或其数字形式“127.0.0.1”作为通用地址的典型错误。它不是，而是一个别名，用于循环回运行程序的同一台机器。

当您从服务器上运行的程序测试服务器时，127.0.0.1 有效。但是，当您通过手机尝试时，它会尝试联系手机本身上运行的服务器进程。

正如 AndroidGuy 所指出的，当你在 Android 模拟器上运行时，有一个特殊的别名地址可以用来联系宿主开发机器。但这不适用于物理 Android 设备。

您有几个选择，但都不是很好：

*   您可以将 android 设备与服务器放在同一个 wifi 网络上，并通过子网上的真实 IP 地址（通常为 192.168.0.something）联系它。

*   您可以使用设备上的移动网络连接（或 wifi 连接）在可公开路由的 Internet 上针对真实服务器进行测试。

*   您可以尝试“向后”使用设备上的网络共享功能在设备和测试服务器之间建立子网，但要非常小心，不要意外通过移动网络发送服务器的所有其他流量。

*   您可以在有根设备上玩其他游戏来实现自定义流量路由/代理

*   你可以在安卓设备上运行服务器进行测试

# ruby-on-rails - 设计 - 如果已登录，则自动从根 url 重定向

> ID：14416234
> 
> 赞同：9
> 
> 时间：2013-01-19T16:16:04.220
> 
> 标签：ruby-on-rails, url, redirect, devise, root

名为 Carly 的用户未注册并到达索引页面。她注册并自动重定向到主仪表板页面。现在名为 CarlyCoolness123 的用户 Carly 关闭了她的浏览器并去吃晚饭。她再次打开她的 PC，但这一次她只记得实际的索引页面名为：coolness.com，而不是 coolness.com/index-dashboard。如果用户登录，我希望此用户自动重定向到仪表板页面。这意味着如果用户登录，用户将无法访问索引页面。我该怎么做？我已经尝试了几件事，但是由于我认为你们这里的人对此比我有更好的理解，所以我认为我的错误不需要在这里包括在内。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-19T16:57:19.197

这假设您已经正确设置了设计，并且您有一个负责呈现仪表板视图的仪表板控制器。在您的 app/controllers/dashboard_controller.rb 中执行以下操作：

```
class DashboardController < ApplicationController
  before_filter :authenticate_user!

...
end 
```

然后在您的 config/routes.rb 文件中添加以下内容：

```
resources :dashboard

authenticated :user do
  root :to => "dashboard#index"
end

root :to => redirect("/users/sign_in") 
```

如果您有仪表板的索引视图，则访问应用程序的根目录应该会自动呈现它（如果用户已登录）。如果用户未登录，它将重定向到设计默认登录视图（如果您尚未重新定义它）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-19T00:22:03.253

我更喜欢使用下面的方法，因为拥有多个根路径对我来说似乎违反直觉[阅读：“当我尝试其他提到的方法时出现错误，所以我尝试了其他方法。”]。

我认为这效果更好，实际上是@MFCS 最初要求的，因为它不会有条件地在其他地方提出根点。而是在登录用户访问时重定向到不同的路径`root_path`：

配置/路由.rb：

```
root to: 'welcome#index' 
```

应用程序/控制器/welcome_controller.rb：

```
class WelcomeController < ApplicationController
  def index
    if user_signed_in?
      redirect_to dashboard_path
    end
  end
end 
```

我更喜欢这个，因为仪表板仍然会在浏览器中显示仪表板 url（而不是根 url），尽管这可能不是其他人的偏好，并且还取决于您首选的用户体验。

编辑：我在代码中犯了一个错误，引用了 DashboardController 而不是根资源的控制器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-28T23:32:19.347

虽然这是一篇旧帖子，但我遇到了类似的问题，因为我没有使用设计并使用 bcrypt，所以这就是解决方案。`current_user`我在我的应用程序控制器中定义了 a和`authorize`.

```
def current_user
    @current_user ||= User.find(session[:user_id]) if session[:user_id]
  end
  helper_method :current_user

  def authorize
    redirect_to 'home/index' unless current_user
  end 
```

然后我将所有人路由到他们的安全仪表板并在过滤所有安全控制器之前运行`before_filter :authorize`，然后如果他们失败，他们将被路由到主页。希望这对将来的人有所帮助！

# php - openssl_random_pseudo_bytes() 应该使用什么长度？

> ID：14416238
> 
> 赞同：2
> 
> 时间：2013-01-19T16:16:53.360
> 
> 标签：php, cookies, openssl

我需要生成一个将放入 cookie 中的值，以便我可以唯一地识别用户，并且经过大量阅读后，它似乎`openssl_random_pseudo_bytes()`可能符合要求。

但是，我不确定`length`应该为函数使用什么参数才能使值唯一。即：我应该使用 10、25、50、100 等的长度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T11:25:17.100

今天一个合理的（强加密）[安全级别](http://www.cryptopp.com/wiki/Security_Level)是 128 位。这与使用 128 位密码（例如 AES-128）的对称加密获得的安全级别相同。假设冲突对您的应用程序来说是个问题，因为您希望值是唯一的，我们需要考虑[生日悖论](https://en.wikipedia.org/wiki/Birthday_problem)，因此您的 cookie 值中需要 256 位随机数据​​。那是 32 个字节`length`。以 256 位安装[生日攻击](https://en.wikipedia.org/wiki/Birthday_attack)大约需要 2 ^(256/2) = 2 ^(128)次尝试找到冲突，这相当于 128 位安全级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:55:25.973

我认为有一个更好的功能可以满足您的需求：`uniqid()`，它生成一个（尽可能）随机值，基于`microtime()`. 当然，这不是加密安全的，但您没有指定它必须是。

用法：`uniqid()`返回一个 13 个字符长的字符串，`uniqid("", TRUE)`23 个字符，`uniqid($var)`产生`strlen($var)+13`字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-30T13:24:29.927

来自 uniqid 的 PHP 文档：

## 警告

此函数不会生成加密安全令牌，事实上，在没有传递任何其他参数的情况下，返回值与 microtime() 几乎没有什么不同。如果您需要生成加密安全令牌，请使用 openssl_random_pseudo_bytes()。

# object - 方法 MyClass::__get() 必须恰好采用 1 个参数

> ID：14416239
> 
> 赞同：0
> 
> 时间：2013-01-19T16:17:02.757
> 
> 标签：object, php

当我尝试创建我的班级的新实例时，我遇到了错误。

```
class MyClass
{    
    public $link;

    public function __construct()
    {
        $this->Connect();
    }

    private function Connect()
    {
        $db_host = DB_HOST; // defined in included file
        $db_name = DB_NAME; // defined in included file

        $this->link = new PDO("mysql:host=$db_host;dbname=$db_name;charset=UTF-8", DB_USER, DB_PASSWORD);

        $this->link->setAttribute(PDO::ATTR_AUTOCOMMIT,FALSE);

    }

    // other methods here
    // there is no custom __get() method
} 
```

我试图创建新实例并使用其中一种方法：

```
include "inc/myclass.php";
$db = new MyClass();
$db->InsertPost("2012-01-01 10:00", "Test content", "Test title"); 
```

我收到错误：

> 方法 MyClass::__get() 必须恰好采用 1 个参数

我尝试添加不带任何参数的访问器：

```
public function __get() 
{
    return $this;
} 
```

但我仍然收到这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:27:09.100

我不得不像这样覆盖默认访问器（get）：

```
public function __get($name) 
{
    return $this;
} 
```

我不明白为什么我需要`$name`那里，但它完美无缺。

# sql - ORACLE 将 XML 字符串解析为单独的记录

> ID：14416241
> 
> 赞同：0
> 
> 时间：2013-01-19T16:17:14.207
> 
> 标签：sql, xml, oracle

我试图找到几个组的成员。组成员身份作为 XML 存储在 ORACLE 数据库中。我需要一个 SQL 查询将每个成员拆分为单独的行。

我看过一些关于使用 xmlsequence 的帖子，但由于缺乏理解而没有成功。

示例字符串是

```
<D:href xmlns:D='DAV:'>/users/admin@Native Directory</D:href>
<D:href xmlns:D='DAV:'>/users/oracle@Native Directory</D:href>
<D:href xmlns:D='DAV:'>/users/user1@DomainProd</D:href> 
```

我目前的结果是

```
Group       User
-------------------------------------------------------------------------
group1      <D:href xmlns:D='DAV:'>/users/admin@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/oracle@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/user1@DomainProd</D:href>
group2      <D:href xmlns:D='DAV:'>/users/admin@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/oracle@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/user1@DomainProd</D:href>
group3      <D:href xmlns:D='DAV:'>/users/admin@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/oracle@Native Directory</D:href>
            <D:href xmlns:D='DAV:'>/users/user1@DomainProd</D:href> 
```

我希望我的结果集是

```
Group       User
-------------------
group1      admin
group1      oracle
group1      user1
group2      admin
group2      oracle
group2      user1
group3      admin
group3      oracle
group3      user1 
```

任何帮助，将不胜感激...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:54:10.477

您可以使用 XMLTABLE。由于您的 XML 文档似乎是行中的一个片段，因此我将其包装在一个`<root>`元素中。

```
select grp, substr(name, 
              instr(name, '/', -1) + 1,
              instr(name, '@') - instr(name, '/', -1) - 1
             ) name
  from mytab m, 
       xmltable(xmlnamespaces('DAV:' as "D"), 
                '/root/D:href' passing xmltype('<root>'||usr||'</root>')
                columns
                name varchar2(200) path './text()'); 
```

我假设您的 xml 列存储为名为 (usr) 的 clob/varchar2 的表。

group1 的示例输出：

```
SQL> select grp, substr(name,
  2                instr(name, '/', -1) + 1,
  3                instr(name, '@') - instr(name, '/', -1) - 1
  4               ) name
  5    from mytab m,
  6         xmltable(xmlnamespaces('DAV:' as "D"),
  7                  '/root/D:href' passing xmltype('<root>'||usr||'</root>')
  8                  COLUMNS
  9                  name VARCHAR2(200) path './text()');

GRP    NAME
------ ----------
group1 admin
group1 oracle
group1 user1 
```

[http://sqlfiddle.com/#!4/435cd/1](http://sqlfiddle.com/#!4/435cd/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T20:29:33.597

[@DazzaL 的答案](https://stackoverflow.com/a/14416569/1083652)很好（在大多数情况下可能更快），
但您也可以这样做：

```
with tt as 
(select ggroup, regexp_replace(uuser, '([[:print:]]*)(/users/)([[:alnum:]]*)(@)([[:print:]]*)','\3,') user_csv
from t)
select distinct ggroup, regexp_substr(user_csv,'[^,]+',1,level)
from tt
connect by regexp_substr(user_csv,'[^,]+',1,level) is not null
order by ggroup 
```

`t`在我的查询中是表的名称

[**这是一个 sqlfiddle 演示**](http://www.sqlfiddle.com/#!4/40c8c/1)

# php - Zend 框架中的 500 内部服务器错误

> ID：14416246
> 
> 赞同：11
> 
> 时间：2013-01-19T16:17:27.883
> 
> 标签：php, zend-framework

我正在学习 zend 框架，我已经按照为 zend 框架提供的教程设置了它的所有要求，但我仍然收到错误这个错误：

> 内部服务器错误
> 
> 服务器遇到内部错误或配置错误，无法完成您的请求。
> 
> 请通过 admin@example.com 联系服务器管理员，告知他们此错误发生的时间，以及您在此错误之前执行的操作。
> 
> 服务器错误日志中可能提供有关此错误的更多信息。

我该如何解决？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T16:50:15.903

使用 Zend 应用程序，您可能会看到有关将这些行放入的错误的更多信息`application.ini`：

```
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1 
```

500 错误主要是被捕获的异常。您可以通过查看`ErrorController.php`.

此外，最常见的 Apache 问题：

*   `mod_rewrite`Apache 中未启用模块
*   .htaccess 中的必需`RewriteBase /`规则（在共享主机上）
*   `AllowOverride All`虚拟主机配置中缺少

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T16:20:02.697

就像消息所暗示的那样，您需要检查服务器错误日志以查看实际问题。如果您使用的是 Apache，则需要检查 Apache 错误日志。在 Linux 系统上，这将位于类似`/var/log/apache2/error.log`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-18T20:52:21.407

如果你使用 NGINX：

改变：

```
 location / {
    try_files $uri $uri/ /index.html;
 } 
```

至：

```
 location / {
    try_files $uri $uri/ /index.php?q=$uri&$args;
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-30T19:13:07.810

你没有`mod_rewrite`加载。

找到您的`httpd.conf`文件并找到该行：

```
#LoadModule rewrite_module modules/mod_rewrite.so 
```

删除行首的`#`符号以取消注释并激活它。

接下来，向 httpd.conf 添加一个新部分，如下所示：

```
<Directory "C:/wamp/www/CRUD_ZEND/public">
    Options FollowSymLinks
    AllowOverride All
</Directory>

 The `AllowOverride` directive is important. By default, `.htaccess` files are not processed unless allowed. This line allows `.htaccess` files in that named directory. 
```

进行这些更改后，重新启动 Apache，然后再次尝试加载您的 ZF2 页面。
[试试这个链接](https://jimitupadhyay.wordpress.com/2015/05/28/zend-framework-500-internal-server-error/)

试试这个链接，它会帮助你。你肯定会得到一个可行的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T16:36:58.397

你需要两件事：

1.  SSH/SFTP 访问
2.  了解 Apache 配置文件夹的位置

Apache 的日志文件通常存储在 /etc/httpd/logs 中——但这取决于您的 Linux 设置。

# c++ - 使用 Visual Studio 测量 RTT

> ID：14416248
> 
> 赞同：2
> 
> 时间：2013-01-19T16:17:48.170
> 
> 标签：c++, c, visual-studio, tcp, roundtrip

我正在尝试用 Visual Studio 测量 RTT。现在，当我调用该函数时：

```
GetTcpRow(554, clientPort, MIB_TCP_STATE_ESTAB,(PMIB_TCPROW) serverConnectRow);
if (winStatus != ERROR_SUCCESS) {
    wprintf
        (L"\nGetTcpRow failed on the server established connection with %d",
         winStatus);
    goto bail; 
```

它将值 1168 返回给变量`winStatus` ，然后打印消息`nGetTcpRow failed on the server established connection with 1168`并停止运行。

有谁知道问题是什么？函数有什么作用`GetTcpRow`？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:58:10.653

谷歌在这里找到了 GetTcpRow() 的代码

```
http://msdn.microsoft.com/en-us/library/windows/desktop/bb485735(v=vs.85).aspx 
```

代码中有多个错误分支。您需要查找各种返回代码的值以查看发生了哪个错误分支。

# php - 在 meta 标签、php header 和 htaccess 中，哪一个是更好的缓存系统？

> ID：14416251
> 
> 赞同：0
> 
> 时间：2013-01-19T16:17:54.227
> 
> 标签：php, html, .htaccess

用于缓存控制、mod 重写和 php 标头标记的 html 元标记

```
<filesMatch ".(ico|gif|jpg|jpeg|png|flv|pdf)$">
  Header set Cache-Control "max-age=29030400"
</filesMatch>

<meta http-equiv="Cache-control" content="public">

header('Expires: Thu, 01-Jan-70 00:00:01 GMT');
header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');
header('Cache-Control: no-store, no-cache, must-revalidate');
header('Cache-Control: post-check=0, pre-check=0', false);
header('Pragma: no-cache'); 
```

哪个缓存系统更好，为什么？php、htaccess 还是元标记？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:20:28.687

他们都不是。

只有您的第一个选项实际上会告诉浏览器缓存图像（尽管它与 mod_rewrite 无关）。

但是，无论如何我都不会打扰 max-age 。浏览器缓存图像已经足够好了，无需手动强制

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:31:27.393

除了您的示例在每种情况下设置不同的标题和值之外，浏览器中的结果将与您使用的任何方法相同。主要区别在于每个文件可以应用于的文件类型：

*   `<meta>`标签只能出现在 HTML 文档中；因此，您不能使用它来控制非 HTML 文件（例如图像）的缓存有效性，并且有可能在不处理 HTML 和发现标记的情况下下载文件。
*   PHP`header()`函数可以影响您使用 PHP 动态提供的任何文件。例如，这可能包括纯文本或 XML 文件，但可能不包括您上传到服务器的完整格式的 HTML 文件。您可以通过 PHP 传递静态文件，包括图像，但这是一种低效的服务方式。
*   Apache`Header`指令（不是 的一部分`mod_rewrite`）可以应用于Apache 正在服务的**任何**文件，无论它是否是动态生成的。这可以包括图像、静态 HTML、CSS 和 JS，以及您使用 PHP 生成的任何内容。

Apache 指令的唯一缺点是，根据您的设置以及您对 Apache 配置规则的经验，为不同的数据位维护更复杂的规则可能会更复杂。`header()`因此，对于已经用 PHP 处理的数据，如果您想要更细粒度的控制，您可能希望使用该函数构建一些东西。

# r - 棘手的多步子集选择

> ID：14416256
> 
> 赞同：0
> 
> 时间：2013-01-19T16:18:52.303
> 
> 标签：r, matrix

我有一个矩阵：

```
1 3  NA
1 2  0
1 7  2
1 5  NA
1 9 5
1 6  3
2 5  2
2 6  1
3 NA  4
4 2  9
... 
```

我想为第一列中的每个数字选择那些元素，第二列中的对应值在其自己的第二列中具有 NA。

所以搜索将按照以下方式进行：

1.  在第一列中查找数字：1。
2.  检查第二列中的相应值：3,2,7,5,9,6...
3.  在第一列中查找 3,2,7,5,9,6 并查看它们在第二列中是否有 NA

上述情况的结果将是：

```
>3 NA  4< 
```

因为这是唯一在其第二行具有 NA 的值。

这就是我想要用文字做的事情：

1.  查看第一列中的数字，我找到“1”。

2.  1 在第二列中有什么数字：3,2,7,5,9,6

3.  这些数字在它们自己的第二列中有 NA 吗？是的，3 有一个 NA

4.  我希望它返回那些数字而不是行号。

5.  结果将是原始矩阵的子集，其中包含满足条件的行。

这将是 matlab 等效项，其中 i 是第 1 列中的数字：

```
isnan(matrix(matrix(:,1)==i,2))==1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:53:54.847

使用`by`, 按列 1 组获取结果，假设`dat`是您的数据框

```
by(dat,dat$V1,FUN=function(x){
                  y <- dat[which(dat$V1 %in% x$V2),]
                  y[is.na(y$V2),]
})

dat$V1: 1
  V1 V2 V3
9  3 NA  4
-------------------------------------------------------------------------------- 
dat$V1: 2
[1] V1 V2 V3
<0 rows> (or 0-length row.names)
-------------------------------------------------------------------------------- 
dat$V1: 3
[1] V1 V2 V3
<0 rows> (or 0-length row.names)
-------------------------------------------------------------------------------- 
dat$V1: 4
[1] V1 V2 V3
<0 rows> (or 0-length row.names) 
```

**编辑**

在这里，我尝试执行与 matlab 命令相同的功能：

这里 R 等价于 matlab

```
 isnan(matrix(matrix(:,1)==i,2))==1)   ## what is i here 

  is.na(dat[dat[dat[,1]==1,2],])        ## R equivalent , I set i =1

     V1    V2    V3
3 FALSE FALSE FALSE
2 FALSE FALSE FALSE
7 FALSE FALSE FALSE
5 FALSE FALSE FALSE
9 FALSE  TRUE FALSE
6 FALSE FALSE FALSE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:42:07.610

希望这很容易阅读，因为它遵循您描述的步骤：

```
idx1 <- m[, 1L] == 1L
idx2 <- m[, 1L] %in% m[idx1, 2L]
idx3 <- idx2 & is.na(m[, 2L])
m[idx3, ]
# V1 V2 V3 
#  3 NA  4 
```

它都是矢量化的并使用整数比较，所以它不应该*非常*慢。但是，如果它对您的需要来说太慢，您应该使用 a`data.table`并使用您的第一列作为键。

请注意，您不需要任何作业，因此如果您正在寻找单线：

```
m[is.na(m[, 2L]) & m[, 1L] %in% m[m[, 1L] == 1L, 2L], ]
# [1]  3 NA  4 
```

（但肯定更难阅读和维护。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:47:07.873

我仍然不完全清楚你想要什么，但也许这会奏效？

```
m<-read.table(
textConnection("1 3  NA
1 2  0
1 7  2
1 5  NA
1 9 5
1 6  3
2 5  2
2 6  1
3 NA  4
4 2  9"))

do.call(rbind,lapply(split(m[,2],m[,1]),function(x) m[x[!is.na(x)][is.na(m[x[!is.na(x)],2])],]))

#   V1 V2 V3
# 1  3 NA  4 
```

如果您提供了一个您想要多行的示例，那就更好了。

# stack - 替代 ZigBee 堆栈

> ID：14416260
> 
> 赞同：2
> 
> 时间：2013-01-19T16:19:08.963
> 
> 标签：stack, pic, pic18, zigbee

是否有任何堆栈可以替代 Microchip ZigBee 堆栈？我有一个 PIC18F27J53 微控制器和 MRF24J40MB 收发器。我试图阅读和理解 Microchip ZigBee 堆栈中包含的示例，但我没有运气。我认为这些例子对于像我这样的初学者来说太复杂了。我只打算向传感器节点发送数据和从传感器节点接收数据。此外， PIC18F27J53 不包含在 Zena 配置工具器件列表中。

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:29:31.860

1.你可以试试cc2500 rf pro。它比 ZigBee 更容易、更清洁且相当便宜。
2\. 或者更好的是，您可以尝试将 ZigBee 与 arduino 一起使用。你有内置的库，如果你说你是一个初学者，那么发送数据就像写入 UART 端口一样简单，顺便说一句，这是一条命令。
3\. 或者，如果您不介意较低的频率，您可以选择标准射频模块（或者这样称呼）。您可以在此处找到有关它的更多信息以及如何使用它。[http://extremeelectronics.co.in/rf/rf-communication-between-microcontrollers-part-i/](http://extremeelectronics.co.in/rf/rf-communication-between-microcontrollers-part-i/)
我会先选择选项 2，然后选择 3，然后选择 1。（因为你说你是初学者）。

# c# - 如何根据 C# 中传递的时间计算价格？

> ID：14416267
> 
> 赞同：0
> 
> 时间：2013-01-19T16:19:54.053
> 
> 标签：c#, windows-phone-7.1, windows-phone-7.1.1

我目前正在开发一个应用程序，该应用程序根据用户使用该服务的时间来计算用户必须为服务支付的价格。第一小时收费 3.30 美元，之后每半小时收费 1.15 美元。我的计时器看起来像这样：

```
 private void timer()
    {
        DispatcherTimer timer = new DispatcherTimer();

        timer.Tick +=
            delegate(object s, EventArgs args)
            {
                TimeSpan time = (DateTime.Now - StartTime);

                this.Time.Text = string.Format("{0:D2}:{1:D2}:{2:D2}", time.Hours, time.Minutes, time.Seconds);
            };
        timer.Interval = new TimeSpan(0, 0, 1); // one second
        timer.Start();
    } 
```

关键是计时器和支付的价格应该显示在屏幕上，并随着时间的推移自动更新（计时器已经这样做了。）

至于价格本身，我想过使用 if/else 和 foreach 的组合，但到目前为止，我什么也没做......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:25:45.537

像这样的东西。（您忽略了部分时间的处理方式，所以我忽略了它们。）

```
double span = (DateTime.Now - StartTime).TotalHours;
decimal cost = 0.0;
if (span > 0)
    cost = 3.30 + ((span - 1) * 1.15); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:39:33.603

如果该方案是这样的，即在一个段开始时立即添加成本，那么您可以计算在初始小时之后已经开始的半小时数，如下所示：

```
Math.Round((hours - 1) / 0.5 + 0.5) 
```

然后成本计算为：

```
double hours = (DateTime.UtcNow - StartTime).TotalHours;
double cost;
if (hours < 1)
    cost = 3.30;
else
    cost = 3.30 + Math.Round((hours - 1) / 0.5 + 0.5) * 1.15; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T11:35:47.727

几点注意事项：

1.  使用 UTC 时间，而不是当地时间（参见 Eric Lippert 的评论）
2.  使用`decimal`而不是`double`代表金钱
3.  计算开始的时间间隔，`Math.Ceiling`很棒。无需跳过箍`Math.Round`来做你想做的事。
4.  将您的定价逻辑封装到一个不与外部服务（例如时钟）交互的简单无副作用方法中。

    这使得单独测试该方法变得容易。

5.  对所有定期 UI 更新使用单个计时器（除非它们需要不同的时间间隔）

我会这样写：

```
public decimal CostByTime(TimeSpan t)
{
  if(t < TimeSpan.Zero)
      throw new ArgumentOutOfRangeExeception("t", "Requires t>=0");
  if(t ==  TimeSpan.Zero)
      return 0;
  double hours = t.TotalHours;
  if(hours <= 1)
      return 3.30m;
  else
      return 3.30m + (int)Math.Ceiling((hours-1)*2) * 1.15m
} 
```

然后在您看来，您可以使用：

```
TimeSpan billableTime = DateTime.UtcNow - StartTime;
decimal cost = CostByTime(billableTime);

Time.Text = billableTime.ToString(...);
Cost.Text = cost.ToString(); 
```

# ios - 如何在此表格视图中搜索结果？

> ID：14416270
> 
> 赞同：0
> 
> 时间：2013-01-19T16:20:02.800
> 
> 标签：ios, tableview, uisearchbar

我希望能够将搜索功能添加到我的表格视图中。该表列出了各种商店位置。我希望用户能够按城市过滤。我一直在考虑以某种方式添加一个下拉列表，也许在 tableviewcell 中创建过滤器。有没有人这样做可以帮助我？

我已经在表格视图中有一个搜索栏控件，但它只搜索记录的一个字段。如何决定或选择搜索栏在我的数据中实际查找的字段？这是我的代码：

```
#pragma mark Content Filtering

-(void)filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope {

    // Update the filtered array based on the search text and scope.

    // Remove all objects from the filtered search array

    [self.filteredResultsArray removeAllObjects];

    // Filter the array using NSPredicate

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.name contains[c] %@",searchText];

    [self.filteredResultsArray = [NSMutableArray arrayWithArray:[self.dates filteredArrayUsingPredicate:predicate]] retain];

}

#pragma mark - UISearchDisplayController Delegate Methods

-(BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString {

    // Tells the table data source to reload when text changes

    [self filterContentForSearchText:searchString scope:

     [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];

    // Return YES to cause the search result table view to be reloaded.

    return YES;

}

-(BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchScope:(NSInteger)searchOption {

    // Tells the table data source to reload when scope bar selection changes

    [self filterContentForSearchText:self.searchDisplayController.searchBar.text scope:

     [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:searchOption]];

    // Return YES to cause the search result table view to be reloaded.

    return YES;

} 
```

我的 self.dates 数组填充如下：

```
- (void)loadRecordsFromCoreData {

    [self.managedObjectContext performBlockAndWait:^{

        [self.managedObjectContext reset];

        NSError *error = nil;

        NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:self.entityName];

        [request setSortDescriptors:[NSArray arrayWithObject:

                                     [NSSortDescriptor sortDescriptorWithKey:@"date" ascending:YES]]];

        self.dates = [self.managedObjectContext executeFetchRequest:request error:&error];

    }];

} 
```

它与 initWithEntityName 是否有关系...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:14:23.773

`NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF.name contains[c] %@",searchText];`

该谓词确定在您的数据中搜索哪个字段 - 在本例中为名称字段。如果您想搜索不同的字段，只需将 SELF.name 更改为 SELF.city 或其他字段。如果您想搜索多个字段或在过滤器中使用其他逻辑，请查看[Apple 的 NSPredicate 编程指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795-SW1)。

# macos - 如何抑制（或自定义）Mac 终端 shell 提示

> ID：14416274
> 
> 赞同：42
> 
> 时间：2013-01-19T16:21:09.247
> 
> 标签：macos, terminal, command-prompt

目前在我的终端中，每个 shell 提示看起来像`ComputerName: FooDir UserName$`. 这`UserName`部分只是浪费了我宝贵的 80 列中的太多空间。有没有办法压制它？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-01-19T16:52:45.657

`PS1`提示由您可以在 中定义的环境变量定义`.bash_profile`。

要对其进行编辑，请打开或创建（隐藏）文件`.bash_profile`：

`nano .bash_profile`

并添加一行说

`export PS1=""`

在引号之间，您可以插入您想要的终端提示符。您还可以在那里使用变量：

*   `\d`- 日期
*   `\t`- 时间
*   `\h`- 主机名
*   `\#`– 命令号
*   `\u`- 用户名
*   `\W`– 当前目录（例如：桌面）
*   `\w`– 当前目录路径（例如：/Users/Admin/Desktop）

常见 Linux 发行版的默认提示是，它在您的主目录或其他地方`\w $`进行评估。还有一些网站（比如[这个](http://ezprompt.net)）可以帮助你建立你的提示。`~ $``/Users $`

如果您想删除该`UserName`部分，您的选择是`\h: \w$`.

进行更改后，使用`Control`+ `o`、`Return`、`Control`+保存文件`x`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-04-18T00:00:46.543

**这是一篇很棒的文章，其中包含变量和颜色的完整列表：**

**[自定义您的 Shell 命令提示符](http://blog.taylormcgann.com/2012/06/13/customize-your-shell-command-prompt/)**

对于一个简单、简约的提示，你可以试试这个。将以下行添加到您的`.bash_profile`或通过在终端中运行它首先对其进行测试：

```
export PS1="\[\033[0m\]\w\$ " 
```

它看起来像这样：

![简单的终端提示](../Images/3f673ecba624a75007b9a0eb178e0568.png)

这是我的提示（[source](https://github.com/sheharyarn/dotfiles/blob/bash/Bash/_bash_styles.sh)），也很简单：

```
export PS1="\[\033[1;97m\]\u: \[\033[1;94m\]\w \[\033[1;97m\]\$\[\033[0m\] " 
```

![在此处输入图像描述](../Images/358910623d49b6734d3776d064aebc13.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-08T22:47:40.273

您可以在这里找到答案：[http](http://www.hypexr.org/bash_tutorial.php#vi) ://www.hypexr.org/bash_tutorial.php#vi ，位于页面中间。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-22T03:42:39.167

2019 年起，MacOS 默认外壳为[Z Shell](http://zsh.sourceforge.net/)。要自定义命令提示符，请添加一个名为`.zshrc`user home 的文件，并输入以下行以设置`PS1`具有所需提示格式的环境变量：

```
export PS1="[%n]%~> " 
```

**打开新终端** [![命令提示符快照](../Images/08dfb2bb9a92ec74b49239224a0c4dc4.png)](https://i.stack.imgur.com/YDnko.png)

这是以下格式扩展的结果：

*   `%n`用户名
*   `%~`当前目录

[在此处](http://web.mit.edu/jhawk/mnt/ss.b/zsh-3.1.5/Doc/zsh_13.html)查看可用扩展的完整列表。

# go - 错误“无法加载包：包 my_prog：找到包 my_prog 和 main”

> ID：14416275
> 
> 赞同：76
> 
> 时间：2013-01-19T16:21:10.680
> 
> 标签：go

在我的 GOPATH 中，我有这样的东西：

```
/bin/
/pkg/
/src/
/src/my_prog/
/src/my_prog/main.go
/src/my_prog/d_interface.go
/src/my_prog/d_struct_that_implements_the_interface.go 
```

在`main.go`我有`package main`，在我`d_interface.go`有。`d_struct_that_implements_the_interface.go``package my_prog`

当我尝试时，`go build my_prog`我收到以下错误：

```
can't load package: package my_prog: found packages my_prog (d_interface.go) and main (main.go) in C:\dev\Code\Go\src\my_prog 
```

这是否意味着任何属于的文件都`package main`应该放在自己的文件夹中？如果是这样，这是什么原因？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-19T16:27:24.827

是的，每个包都必须在自己的目录中定义。

源结构在[如何编写 Go 代码](http://golang.org/doc/code.html)中定义。

包是可以在多个程序中使用的组件，可以发布、导入、从 URL 获取等。因此，它拥有自己的目录，就像程序可以拥有目录一样。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-01-11T19:12:08.750

此外，如果您要做的只是将 main.go 文件分解为多个文件，那么只需将其他文件命名为“package main”，只要您仅在其中一个文件中定义 main 函数，您就可以去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-19T19:08:16.833

确保您的包已安装在您的`$GOPATH`目录中或已经安装在您的工作区/包中。

例如：如果你的`$GOPATH = "c:\go"`，确保里面的包`C:\Go\src\pkgName`

# iphone - NSArray 出现 NSRangeException 错误 - 在另一个 ViewController 中设置图像视图时

> ID：14416276
> 
> 赞同：0
> 
> 时间：2013-01-19T16:21:16.030
> 
> 标签：iphone, objective-c, xcode

我从 AppDelegate 获取图像，然后将其设置为 ViewController 的 table.imageView 属性。它向我抛出了一个 NSRangeException：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '-[__NSCFArray     objectAtIndex:]: index (2) beyond bounds (2)' 
```

我确保我的数组和行按 [数组计数] 计数。很困惑。这是代码：

```
#pragma mark - viewWillAppear
- (void)viewWillAppear:(BOOL)animated {

PBAppDelegate *dataObject = (PBAppDelegate *)[[UIApplication sharedApplication] delegate];
NSString *titleRead = dataObject.title;
NSString *descRead = dataObject.desc;
UIImage *imageRead = dataObject.image;

if ([titleRead isEqualToString:@"" ] || [descRead isEqualToString:@""]) {
    // it's nil
} else {
    if (titleRead) {
        [data addObject:[NSArray arrayWithObjects:titleRead, descRead, imageRead, nil]];
        dataObject.title = @"";
        dataObject.desc = @"";
        [tableView reloadData];
    }

    NSUserDefaults *dataDefaults = [NSUserDefaults standardUserDefaults];
    [dataDefaults setObject:[NSArray arrayWithArray:data] forKey:@"dataArrayKey"];
    [dataDefaults synchronize];
}

}

#pragma mark - viewDidLoad
- (void)viewDidLoad
{
[super viewDidLoad];
data = [[NSMutableArray alloc] init];

self.data = [[NSUserDefaults standardUserDefaults] objectForKey:@"dataArrayKey"];
[tableView reloadData];
}

#pragma mark - Table Datasource
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     *)indexPath {

static NSString *cellIdentifier = @"MyCell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

if (!cell) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellIdentifier];
}

cell.textLabel.text = [[data objectAtIndex:indexPath.row] objectAtIndex:0];
cell.detailTextLabel.text = [[data objectAtIndex:indexPath.row] objectAtIndex:1];
cell.imageView.image = [UIImage imageNamed:[[data objectAtIndex:indexPath.row] objectAtIndex:2]];
cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:26:04.610

大概就是这一行：

```
cell.imageView.image = [UIImage imageNamed:[[data objectAtIndex:indexPath.row] objectAtIndex:2]]; 
```

控制台输出显示数组中有 2 个元素。元素从 0 开始；因此您可以访问 objectAtIndex:0 和 objectAtIndex:1。两个将是数组的第三个元素，并且超出范围。

对不起，如果这一切都很明显，只是快速刺伤......享受。:)

**编辑**`imageRead`实际上，当您将它添加到数组时 ，问题可能是 nil 。这将导致数组中只有 2 个元素。如果您没有图像，您可以检查，和/或使用 [NSNull null] ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:44:33.570

通过执行以下操作确保数组实际上有 3 个元素：

```
NSArray *array = [data objectAtIndex:indexPath.row];
if ([array count] > 2)
{
 cell.imageView.image = [UIImage imageNamed:[array objectAtIndex:2]];
} 
```

# php - 在 php 搜索结果中显示固定的最低价格

> ID：14416277
> 
> 赞同：-2
> 
> 时间：2013-01-19T16:21:17.657
> 
> 标签：php, formatting, currency

我们正在使用 API 在搜索结果中显示房产列表，并且我们需要对房产的短期住宿应用 300 英镑的固定最低价格。

目前，可以输入 1 晚或 2 晚的住宿，并且显示特定物业的价格低于 300 英镑。

在这些情况下，我们需要（我假设）一个 if 语句来显示 300 英镑。

以下是我们设置价格的地方...

```
<?php echo money_format('£%i', $property_price / ( $nights )) ?> 
```

变量基于 API 中的属性。

请任何人建议我们如何将其转换为包含类似于“如果退回的价格低于此金额，则显示 300 英镑”的内容？

建议的标题编辑不正确。我不想显示正确的价格 (?) - 这就是我没有这么说的原因……我想显示 300 英镑的固定价格，即使 API 的结果返回的价格低于此金额。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:01:04.860

答案来自与作者的长时间交谈以及对他试图做的事情的仔细阅读。

**回答** 我发现您的代码有问题。这是正确的：

```
<?php if ($property_price < 300) $property_price = 300; ?>
<?php echo money_format('£%i', $property_price / ( $nights )) ?> 
```

（这当然相当于一个最大值......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:24:17.430

只需使用 max 函数：

```
<?php echo money_format('£%i', max(300, $property_price / ( $nights ))) ?> 
```

# javascript - 将值从 cookie 存储到 JavaScript 变量

> ID：14416282
> 
> 赞同：0
> 
> 时间：2013-01-19T16:22:29.557
> 
> 标签：javascript, jquery

我刚刚开始使用 JavaScript 和 jQuery，并且正在解决问题，如果这是一个基本问题，我深表歉意。我有一些简单的代码写入：

*   从表单中获取值
*   将其存储到 cookie
*   从 cookie 中调用值并将其存储在 JS 变量中
*   打印 JS 变量

...但我无法让它工作。我可以看到 cookie 设置正确，但由于某种原因，我无法检索它并将其写入变量。这是我的代码，任何帮助将不胜感激！

```
<!-- CAPTURE A VALUE IN A SIMPLE FORM... -->
  <input id="txt" type="text" value="foo" />
  <input id="btn" type="button" value="1 - write cookie" />
  <input id="btntwo" type="button" value="2 - set cookie to variable" />
  <input id="btnthree" type="button" value="3 - print the cookie" />

<!-- WRITE THE VALUE TO THE COOKIE WHEN A USER CLICKS THE BTN... -->
  <script type="text/javascript">                                         
   $(document).ready(function () {
    $("#btn").on("click", function () {
      $.cookie('myCookie', $("#txt").val(), { expires: 365 });
      });
    });                              
  </script> 

<!-- SET THE COOKIE VALUE TO A VARIABLE WHEN A USER CLICKS THE BTNTWO... -->
<script type="text/javascript">   
$(document).ready(function() {
  $("#btntwo").on("click", function () {
    var cookVal = $.cookie('myCookie')
  });
});
</script>     

<!-- PRINT THE COOKIE VALUE ON THE SCREEN WHEN A USER CLICKS THE BTNTHREE... -->
<script type="text/javascript">   
$(document).ready(function() {
  $("#btnthree").on("click", function () {
    document.write(cookVal);     
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:30:51.120

您的`cookVal`变量是 click-handler 函数的本地变量，外部的任何东西都无法访问它。

此外，不要`document.write`在事件处理程序中使用。如果 HTML 已完全解析（并且 DOM 已准备好），则文档将关闭。之后调用`document.write`将清除它并重写它。

顺便说一句，您可以将单独的脚本合并到一个单独的脚本中，这可能会使代码更具可读性。

```
<input id="txtin" type="text" value="foo" />
<button id="btn">write cookie</button>
<button id="btntwo">2 - set cookie to variable</button>
<button id="btnthree">3 - print the cookie</button>
<output id="txtout" />

<script type="text/javascript">                                         
$(document).ready(function () {
  <!-- WRITE THE VALUE TO THE COOKIE WHEN A USER CLICKS THE BTN... -->
  $("#btn").on("click", function () {
    $.cookie('myCookie', $("#txtin").val(), { expires: 365 });
  });
  <!-- SET THE COOKIE VALUE TO A VARIABLE WHEN A USER CLICKS THE BTNTWO... -->
  var cookVal; // declared local to the whole onready function
  $("#btntwo").on("click", function () {
    cookVal = $.cookie('myCookie');
  });
  <!-- PRINT THE COOKIE VALUE ON THE SCREEN WHEN A USER CLICKS THE BTNTHREE... -->
  $("#btnthree").on("click", function () {
    $("#txtout").val(cookVal);     
  });
});
</script> 
```

[jsfiddle.net 上的演示](http://jsfiddle.net/2L7Zb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:29:04.550

首先，您不需要多种`$(document).ready`方法。

尝试时会输出什么：

```
$(document).ready(function () {

    $("#btn").on("click", function () {
       $.cookie('myCookie', $("#txt").val(), { expires: 365 });
    });                              

    var cookVal = 'NOT SET';

    $("#btntwo").on("click", function () {
       cookVal = $.cookie('myCookie')
    });

    $("#btnthree").on("click", function () {
       document.write(cookVal);     
    });

}); 
```

如果您查看 JavaScript 的`#btn`onclick，则保存 cookie 的语法是错误的。您正在添加一个额外的`})`内容，这会破坏脚本。如果您不确定，请使用 Chrome 中的开发者工具或 Firefox 中的 Firebug，然后查看您的控制台。JavaScript 错误在那里输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:29:33.707

您不必将它们中的每一个放在一个单独的位置`$(document).ready(function()`，您可以将它们全部放在一个中。此外，它的简写是：

```
$(function(){
............
}); 
```

# android - 如何显示可扩展和单一列表视图

> ID：14416286
> 
> 赞同：0
> 
> 时间：2013-01-19T16:23:07.830
> 
> 标签：android

有没有办法在同一个列表视图中显示可扩展和不可扩展列表？我想要实现的是拥有可扩展的列表视图，但对于没有子项目的项目，我不想显示箭头展开箭头图标我该怎么做？请帮忙谢谢

编辑：我想要的是能够在组为空时隐藏指示箭头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:28:10.937

是的。你可以。

使用[BaseExpandableListAdapter](http://developer.android.com/reference/android/widget/BaseExpandableListAdapter.html)

这个类有下一个方法：getGroupTypeCount() 和 getGroupType(int groupPosition)

你应该覆盖它。

以简单的方式，您有两种类型的项目。例如可扩展（类型 1）和不可扩展（类型 2）。

getGroupTypeCount() 应该返回 2；

在此方法中覆盖 getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) 按项目的位置检查项目的类型。如果项目不可扩展，您应该生成其外观不依赖于是否扩展的视图。

我认为这很简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:30:30.910

1）基本上，当组没有孩子时，你必须隐藏“展开箭头”。您可以通过将`GroupIndicator`属性设置为 null 来实现此目的。

例如： `getExpandableListView().setGroupIndicator(null);`

**或者**

2）通过检查孩子的数量，您可以像下面的代码一样设置指标，

```
 if ( getChildrenCount( groupPosition ) == 0 ) {
       indicator.setVisibility( View.INVISIBLE );
    } else {
       indicator.setVisibility( View.VISIBLE );
       indicator.setImageResource( isExpanded ? R.drawable.list_group_expanded : R.drawable.list_group_closed );
    } 
```

有关隐藏组指示器的更多信息，您可以参考[此链接](http://mylifewithandroid.blogspot.in/2011/06/hiding-group-indicator-for-empty-groups.html)。

**或者**

3）在drawable文件夹中创建一个group_indicator.xml文件

```
<item android:state_empty="true" android:drawable="@android:color/transparent"></item>
<item android:state_expanded="true" android:drawable="@drawable/arrowdown"></item>
<item android:drawable="@drawable/arrowright"></item> 
```

然后，像下面的代码定义可扩展的列表视图，

```
 <ExpandableListView
        android:id="@+id/android:list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:groupIndicator="@drawable/group_indicator"
        android:layout_weight="1" >
    </ExpandableListView> 
```

希望这能解决您的问题。

# php - 如何在 social-sdk 中获取 SessionedUser 的 YahooID？

> ID：14416287
> 
> 赞同：1
> 
> 时间：2013-01-19T16:23:16.813
> 
> 标签：php, oauth, yql, yahoo-api

我已经下载了[雅虎！社交 SDK - PHP](https://github.com/yahoo/yos-social-php)，从 developer.yahoo.com 获得密钥并制作了一个获取用户联系人的网络应用程序。

```
$session=YahooSession::requireSession(API_KEY, SHARED_SECRET); 
```

我的应用程序可以获取所有用户的联系人及其姓名、昵称等以及他们的 YahooID
，我现在需要的是访问我的应用程序的用户的 YahooID。

我做了什么 ：

```
$session->getSessionedUser()->getProfile() 
```

正如[这里](https://stackoverflow.com/questions/5066030/get-logged-in-users-email-id-yahoo-oauth-php)建议的那样。但这只给了我用户的 GUID 和昵称。我添加`Social Directory -> Read Public`到我的应用所需的权限列表中。

关于如何从电子邮件/YahooID 获取 GUID 以从 YahooID 获取用户的 GUID 存在很多问题 O 可以在 YQL 中使用此查询：

```
select * from yahoo.identity where yid='YahooID here' 
```

但它不能以其他方式工作（来自guid的yahoo id）。

# sencha-touch - 列表项披露未在控制器内触发

> ID：14416289
> 
> 赞同：0
> 
> 时间：2013-01-19T16:23:21.573
> 
> 标签：sencha-touch, sencha-touch-2

我正在尝试使用控制器参考使项目披露在 Sencha Touch 的列表项中工作。但是该事件似乎永远不会在控制器内部触发/接收。我见过的所有示例都有使用侦听器的列表项，但我认为这不是非常 MVC，所以我试图这样做（他们有什么理由使用侦听器而不是控制器吗？）

在我看来，该列表是 EnquiryIndex 视图中的一个项目。

当我在控制台窗口中执行此操作时，它会正确返回列表，因此我知道 ref 工作正常：

```
Ext.ComponentQuery.query("enquiryindexview list")[0] 
```

请参见下面的示例：

```
Ext.define('MyApp.controller.EnquiryIndex', {
    extend: 'Ext.app.Controller',

    requires: [

    ],

    config: {
        refs: {           
           enquiryIndexViewRef: 'enquiryindexview list'
        },

    control: {
        'enquiryIndexViewRef': {
            disclose: 'onDiscloseEnquiryIndex'
        }            
    }
},

onDiscloseEnquiryIndex: function (rec) {

   // never gets here!
} 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T16:10:58.603

试试这个

```
config: {
  control: {
    'enquiryindexview list': {
      disclose: 'onDiscloseEnquiryIndex'
  }            
} 
```

或这个

```
config: {
  refs: {           
     enquiryIndexViewRef: 'enquiryindexview list'
  },

  control: {
    enquiryIndexViewRef: {
      disclose: 'onDiscloseEnquiryIndex'
  }            
} 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T10:56:13.057

您可能错过的是在 app.js 中添加这一行

`controllers: ['EnquiryIndex']`,

试试这个，它现在应该可以工作了。

# java - 使用 JPA/Hibernate 持久化大型对象图时出现异常

> ID：14416290
> 
> 赞同：0
> 
> 时间：2013-01-19T16:23:32.783
> 
> 标签：java, hibernate, jpa, spring-orm

我们正在创建一个由 JPA 支持的新 Web 应用程序来替换旧的 Web 应用程序。作为迁移的一部分，我们将旧应用程序的数据库转换为一个新的、更复杂的、JPA 管理的数据库。

因此，我编写了一个“脚本”，将旧数据库转换为一组 JPA 实体，然后保存它们。它是这样工作的：

1.  根据领域模型的依赖关系创建转换顺序
2.  对于每个实体
    1.  对遗留数据库执行数据库查询
    2.  将每个获得的表行的新对象存储在内存中的列表中
3.  以与转换相同的顺序迭代生成的列表，并持久化每个实体。

现在，前两个步骤运行良好。坚持，但是我得到一个例外。当一个实体与另一个实体有关系时会发生异常。例如，如果我们的一个实体是 a `Book`，而另一个实体将`Chapter`定义与 的`@ManyToOne(optional=false)`关系`Book`。在持久化章节后，它会抛出异常`java.lang.IllegalStateException: org.hibernate.TransientPropertyValueException: Not-null property references a transient value - transient instance must be saved before current operation: models.Chapter.book -> models.Book`。

当然，这表明这本书的状态有问题：它似乎要么没有设置，要么还没有被持久化。但是，我可以验证`Book`在 的转换中是否正确设置了`Chapter`，并且我还可以验证在类型实体`Book`被持久化`EntityManager` *之前*，所有类型的实体都`Chapter`被持久化了。显然，我的 JPA 提供程序没有按预期运行，并且由于某种原因并没有真正持久化我的`Book`对象。

什么解决方案可以让我保存已转换到数据库的整个对象图？我使用 Hibernate 作为我的 JPA 提供程序，我还使用 Spring 3.1 来注入依赖项和`EntityManager`s。

编辑 1：一些附加信息：我再次验证 entityManager.persist() 在每个书籍对象上调用 entityManager.persist()*之前*在章节上调用。但是，book 对象的 id 仍然为 null，这意味着它没有正确持久化。尽管没有使用事务，但数据库也仍然是空的。

编辑2：因为我认为从上面的文字中看不清楚：书和章节的故事*只是一个例子*。*任何*引用另一个实体的实体都会发生这种情况。这看起来好像我没有正确使用 JPA/Hibernate，而不是没有正确设置我的实体的值。

编辑 3：核心问题似乎是，*尽管*正确地坚持 Book，拥有所有正确的注释， book.getId() 仍然为空。基本上，Hibernate 并没有在我的实体上设置 ids 在持久化它们之后，当我以后需要使用这些实体时会导致问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T18:32:21.817

我曾经与 hibernate 自己的这样一个错误作斗争。原来是对象图中的一个圆圈和导致问题的级联设置的组合。

已经有一段时间了，因此捕鸟可能不是 100% 准确，但也许它足以跟踪您的问题：

1.  Hibernate 想要插入*章节*。意识到它需要先插入*书*。
2.  想插*书*。意识到它需要先插入另一个实体（例如*publisher*）
3.  插入发布者并执行发布者定义的级联（例如*作者*）
4.  作者有例如参考他的*lastestBook*。因为休眠在内部已经将该书标记为已处理（在步骤 2 中），所以您不会收到异常说明 author.book 引用了一个瞬态实例。

要确定这是否是您的问题，您可以启用完整的休眠调试并遵循休眠通过您的对象图所采用的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T21:42:37.317

感谢与 user1888440 的讨论，我找到了答案。

这个答案的解决方案是 Spring`@Transactional`注释在我的应用程序中不起作用。这意味着 Hibernate 所做的一切都不会发生在事务的上下文中。这意味着 Hibernate 在持久化后不会设置 id，这意味着所有转换都会中断。

不起作用的原因`@Transactional`可能是因为我没有提到一个事实：这个脚本是 Play 2.0（实际上是 2.1）应用程序的一部分，因此是使用 SBT 构建的。SBT 不使用普通的 Java 设置来构建应用程序，而是使用 Scala 编译器来编译 Java。我的猜测是 Scala 编译不能很好地与 Spring 需要的 AspectJ 一起`@Transactional`工作。

[相反，我在以编程方式定义的 Spring 事务](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/transaction.html)（第 11.6 节）中执行了此转换所涉及的所有数据库工作。现在一切都按预期运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-08T19:48:08.920

检查 hbm 文件中您的主键/对象 ID 的未保存值。如果您通过休眠框架自动创建 ID，并且您在某处设置 ID，它会抛出此错误。默认情况下，未保存值是 0 ，所以如果您将 ID 设置为 0 你会看到这个错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-19T16:47:16.497

听起来您忘记在持久化之前为每个章节分配一本书。即使您已将 Book 持久化，也需要将其分配给 Chapter 实例的 #book 属性，然后才能持久化 Chapter。这是因为您已将关系指定为非可选的。#book 永远不能为空。

# android - 在包“android”中找不到属性“layout_weightSum”的资源标识符

> ID：14416292
> 
> 赞同：3
> 
> 时间：2013-01-19T16:23:33.283
> 
> 标签：android

我有这个简单的线性布局，它在图形布局中显示得很好，但是当我构建项目时，我得到了这个控制台错误（我在这里错过了什么？）：

在包“android”中找不到属性“layout_weightSum”的资源标识符

这是布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weightSum="3"
    android:baselineAligned="false"
    android:orientation="horizontal" >

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/tvSpine"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Spine"/>
    </LinearLayout>

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/tvPage"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Page"/>
    </LinearLayout>

    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/tvThick"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Thick"/>
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T16:25:05.687

改变：

```
android:layout_weightSum="3" 
```

到：

```
android:weightSum="3" 
```

此参数没有`layout`前缀。

# ios - Cordova 2.3 Phonegap InAppBrowser URL 白名单错误

> ID：14416294
> 
> 赞同：3
> 
> 时间：2013-01-19T16:23:40.863
> 
> 标签：ios, cordova, user-agent, whitelist

Cordova 2.3.0 中的 InAppBrowser 未正确加载 URL。我知道这与白名单 URL 的新方法以及它们如何仅适用于主 Cordova WebView 而不是插件有关。

我读过[一篇](https://github.com/apache/cordova-ios/blob/master/guides/Cordova%20Plugin%20Upgrade%20Guide.md)关于如何将白名单 URL 用于插件的文章，但它非常模糊，我不确定在哪里添加他们建议的代码。

上述链接中第 3 步的说明建议：

> 步骤 3)。白名单不再检查插件的网络连接。要将白名单用于插件网络连接，您必须将连接的“User-Agent”标头设置为 viewController 的用户代理。

```
`CDVViewController* vc = ((CDVViewController*)self.viewController);
NSString* userAgent = vc.userAgent;
// then set the User-Agent header of your network connection...` 
```

文章没有说明在哪里添加此代码。我假设它在 MainViewController.m 中，但我不确定。我已经尝试将它放在该文件的 init 函数中，但它不起作用。我也不知道“然后设置网络连接的 User-Agent 标头...”是什么意思我在哪里设置这个？

有没有人在这方面取得任何成功？如果是这样，我希望得到一些帮助。我真的被困在这里了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T14:11:36.383

我不断收到 webView:didFailLoadWithError 的原因是由于 URL 被传入而没有被编码。像 google.com 这样的常规 URL 可以正常工作，但是带有参数的更复杂的 URL 会导致加载错误。解决此问题的方法是在调用 window.open 之前对 URL 进行编码：

`var URL = encodeURI(e.data.url); var ref = window.open(URL, '_blank', 'location=yes');`

这解决了使用 Cordova 2.5 的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T20:37:52.167

我在这里发布了这个：[Phonegap/Cordova 2.3.0 iOS Whitelist Ignored](https://stackoverflow.com/questions/14269126/phonegap-cordova-2-3-0-ios-whitelist-ignored/14529942#14529942)

如果你使用故事板。将此添加到您的 MainViewController 或您的控制器：CDVViewController

```
- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self) {
        self = [self init];
    }
    return self;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T04:04:40.887

这在您的 phonegap 项目的 config.xml 中。在标签之间添加以下`<cordova>`标签

```
 <access origin="https://example.com" /> 
```

此标签允许对 example.com 的任何安全请求

访问元素控制 Android 白名单。除非另有设置，否则假定域被阻止

# objective-c - 包含函数在 while 循环内时未调用完成处理程序

> ID：14416298
> 
> 赞同：2
> 
> 时间：2013-01-19T16:24:12.127
> 
> 标签：objective-c

我有以下代码：

```
while ( /* Some condition that will not be met in this example */ ) {
    if( shouldSendRequest ) {
        [launchpad getRequestToken];
    } 
    else {
        // Next step
    }
}

- (void)getRequestToken {

    [NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] 
         completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {

         [self requestForRequestTokenDidComplete:data withResponse:response withError:error];
     }];
}

-(void)requestForRequestTokenDidComplete:(NSData *)data 
       withResponse:(NSURLResponse *)response withError:(NSError *)error {
    // Deal with the returned token
} 
```

`getRequestToken`我遇到的问题是，只要`getRequestToken`在 while 循环内，就永远不会调用完成处理程序。一旦我注释掉 while 循环，一切正常。

这里发生了什么，是否有可能阻止它？我计划使用 while 循环来防止在这个（和其他）完成处理程序完成他们的事情之前继续执行流程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T16:34:26.617

它不起作用的原因是`NSURLConnection`与运行循环一起执行异步请求。因此，如果您通过在语句中*停止*流来停止运行循环，`while`您将阻止请求完成。

您将需要人为地抽取 runloop 或使用后台线程。

看：

*   [从后台线程到服务器的异步请求](https://stackoverflow.com/questions/1728631/asynchronous-request-to-the-server-from-background-thread)
*   [NSURLConnection sendAsynchronousRequest：queue：completionHandler：连续发出多个请求？](https://stackoverflow.com/questions/9409211/nsurlconnection-sendasynchronousrequestqueuecompletionhandler-making-multiple)
*   [GCD 和异步 NSURLConnection](https://stackoverflow.com/questions/8918501/gcd-and-async-nsurlconnection)

还有很多其他...

# java - 未在 AJAX (JSON) 请求上调用 PropertyEditor

> ID：14416300
> 
> 赞同：3
> 
> 时间：2013-01-19T16:24:28.293
> 
> 标签：java, ajax, json, spring, spring-mvc

我在提交表单时遇到 Ajax 请求问题。该表单包含这些字符串化 JSON 数据：

```
{"articleContent":"<p>aaa</p>","title":"Po vyplnění titulku aktuality budete","header":"aa","enabled":false,"timestamp":"1358610697521","publishedSince":"03.01.2013 00:00","publishedUntil":"","id":"10"} 
```

当 json 包含**“03.01.2013 00:00”**值时，服务器响应为**400 Bad Request**

问题是，没有调用自定义的 DateTimePropertyEditor（使用@InitBinder 注册），并且没有调用 String 格式的 DateTime。你知道如何解决这个问题吗？

**控制器映射方法，即处理请求**

```
@RequestMapping( value = "/admin/article/edit/{articleId}", method = RequestMethod.POST, headers = {"content-type=application/json"})
public @ResponseBody JsonResponse  processAjaxUpdate(@RequestBody Article article, @PathVariable Long articleId){
    JsonResponse response = new JsonResponse();
    Article persistedArticle = articleService.getArticleById(articleId);
    if(persistedArticle == null){
        return response;
    }
    List<String> errors = articleValidator.validate(article, persistedArticle);

    if(errors.size() == 0){
        updateArticle(article, persistedArticle);
        response.setStatus(JsonStatus.SUCCESS);
        response.setResult(persistedArticle.getChanged().getMillis());
    }else{
        response.setResult(errors);
    }

    return response;
} 
```

**初始化绑定器**

```
 @InitBinder
        public void initBinder(WebDataBinder binder) {
            binder.registerCustomEditor(DateTime.class, this.dateTimeEditor);
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T15:10:54.783

我使用**@JsonDeserialize解决了这个问题**

```
@JsonDeserialize(using=DateTimeDeserializer.class)
public DateTime getPublishedUntil() {
    return publishedUntil;
} 
```

我必须实现自定义反序列化器。

```
 public class DateTimeDeserializer extends StdDeserializer<DateTime> {

    private DateTimeFormatter formatter = DateTimeFormat.forPattern(Constants.DATE_TIME_FORMAT);

    public DateTimeDeserializer(){
        super(DateTime.class);
    }

    @Override
    public DateTime deserialize(JsonParser json, DeserializationContext context) throws IOException, JsonProcessingException {
            try {
                if(StringUtils.isBlank(json.getText())){
                    return null;
                }
                return formatter.parseDateTime(json.getText());
            } catch (ParseException e) {
                return null;
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T16:54:02.257

这不是由属性编辑器处理的 - 它作用于表单字段而不是 json 主体。要处理 json 中的非标准日期格式，您必须自定义底层[ObjectMapper](http://fasterxml.github.com/jackson-databind/javadoc/2.1.1/com/fasterxml/jackson/databind/ObjectMapper.html)。假设您使用的是 jackson 2.0+，您可以执行以下操作：

一个。使用注释标记 publishedSince 字段，该注释告诉对象映射器日期格式 - 基于[此处](http://wiki.fasterxml.com/JacksonFAQDateHandling)的说明：

```
public class Article{
    ...
    @JsonFormat(shape=JsonFormat.Shape.STRING, pattern="MM.dd.yyyy HH:mm")
    private Date publishedSince;
} 
```

湾。或者第二个选项是修改 ObjectMapper 本身，这可能是全局的，所以可能不适合你：

```
public class CustomObjectMapper extends ObjectMapper {
    public CustomObjectMapper(){
        super.setDateFormat(new SimpleDateFormat("MM.dd.yyyy hh:mm"));
    }   
} 
```

并使用 Spring MVC 进行配置：

```
<mvc:annotation-driven> 
   <mvc:message-converters register-defaults="true">
       <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
           <property name="objectMapper">
               <bean class="..CustomObjectMapper"/>
           </property>
       </bean>
   </mvc:message-converters>
</mvc:annotation-driven> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T03:10:44.070

使用 Spring MVC 4.2.1.RELEASE，您需要使用新的 Jackson2 依赖项，如下所示，Deserializer 才能工作。

不要使用这个

```
<dependency>  
            <groupId>org.codehaus.jackson</groupId>  
            <artifactId>jackson-mapper-asl</artifactId>  
            <version>1.9.12</version>  
        </dependency> 
```

改用这个。

```
<dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-annotations</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-core</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.2.2</version>
        </dependency> 
```

还使用 com.fasterxml.jackson.databind.JsonDeserializer 和 com.fasterxml.jackson.databind.annotation.JsonDeserialize 进行反序列化，而不是来自 org.codehaus.jackson 的类

# php - 在 DELETE 语句中指定“早于”

> ID：14416311
> 
> 赞同：0
> 
> 时间：2013-01-19T16:25:24.213
> 
> 标签：php, mysql, sql

我有一个查询，我想用它来删除“已查看”列日期时间值超过 24 小时的数据行。我怎样才能用一个查询来做到这一点？可能吗？

这是我到目前为止所拥有的：

```
$delete_expired_notifications_query= "DELETE FROM notifications WHERE user_id= 
'".$u_id."' AND viewed (some code that says older than 24hrs)";
    mysqli_query($connect, $delete_expired_notifications_query); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:26:24.073

假设这`viewed`是一个 MySQL 时间类型（它*应该*是）：

```
... AND viewed < NOW() - INTERVAL 24 HOUR 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T16:27:22.967

使用[date_Add](http://www.w3schools.com/sql/func_date_add.asp)和间隔，您可以尝试从现在开始超过 24 小时的记录。

```
DELETE FROM notifications WHERE user_id= 
'".$u_id."' AND viewed < date_Add(now(), interval - 24 hour) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T17:03:28.907

```
DELETE FROM notifications WHERE user_id = '".$u_id."' 
      AND viewed < DATE_ADD(NOW(), INTERVAL -1 DAY)"; 
```

或者

```
DELETE FROM notifications WHERE user_id = '".$u_id."' 
      AND viewed < DATE_ADD(NOW(), INTERVAL -24 HOUR)"; 
```

# php - Ajax & PHP，responseText 返回空

> ID：14416316
> 
> 赞同：0
> 
> 时间：2013-01-19T16:26:02.580
> 
> 标签：php, ajax, responsetext

我已经在 PHP 上完成了用户注册和登录系统。它工作正常，但现在我尝试使用 Ajax 发送 POST 请求以保持在同一页面中，并且 responseText 返回空。我尝试了一些我在类似问题中看到的解决方案，但没有一个对我有用。

这是我用来登录用户的php函数：

```
if(!empty($_POST)) { 
    $query = " 
        SELECT 
            id, 
            username, 
            password, 
            salt, 
            email 
        FROM users 
        WHERE 
            username = ? 
    "; 

    try {  
        $stmt = $db->prepare($query); 
        $stmt->bind_param("s", $_POST['username']);
        $result = $stmt->execute(); 
    } 
    catch(Exception $ex) { 
        die("Failed to execute the query"); 
    } 

    // Is logged in? 
    $login_ok = false; 

    $res = $stmt->get_result();
    $row = $res->fetch_assoc();

    if($row) { 
        // Hash the submitted password and compare it whit the hashed version that is stored in the database
        $check_password = hash('sha256', $_POST['password'] . $row['salt']); 

        for($n = 0; $n < 65536; $n++) { 
            $check_password = hash('sha256', $check_password . $row['salt']); 
        } 

        if($check_password === $row['password']) { 
            $login_ok = true; 
        } else {
            echo "Incorrect password";
        } 
    } 

    if($login_ok) { 
        unset($row['salt']); 
        unset($row['password']); 

        $_SESSION['user'] = $row; 

        echo "Logged in";
    } else { 
        echo "Login failed";
    } 
} 
```

这是我的表单和 Ajax 函数：

```
<form action="" method="post">
    <fieldset>
        <legend>Login</legend>
        <input type="text" name="username" placeholder="user" value="" />
        <input type="password" name="password" placeholder="pass" value="" />
        <input type="button" id="log" value="Login" onclick="log()"/>
    </fieldset>
</form>

<script type="text/javascript">
    function log(){
        if (!window.XMLHttpRequest) return;
        var url = "php/login.php",
            req = new XMLHttpRequest();

        req.open("POST", url);
        req.send(null);

        req.onreadystatechange = function(){
            if(req.readyState == 4 && req.status == 200){
                var response = req.responseText;
                alert(response);
            }
        } 
    }
</script> 
```

有任何想法吗？

编辑：我试图不使用 jQuery 顺便说一句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T09:28:35.213

在此处添加了答案，以便可以接受它，并且其他 SO 用户不会认为这是一个未回答的问题而点击此页面。

您的示例代码中的问题是 AJAX 请求没有发送任何 POST 数据。

因此，您的第一个条件：`if (!empty($_POST))`等于`FALSE`，因此条件内的任何代码都不会运行。

# javascript - Jquery没有为缓存附加时间戳

> ID：14416319
> 
> 赞同：0
> 
> 时间：2013-01-19T16:26:09.850
> 
> 标签：javascript, jquery, jquery-ui

我想使用 jquery-ui 中的可排序来发送 ajax 请求。当我重新排序列表时，出于某种原因，ajax 调用不会将时间戳附加到查询字符串以避免缓存。为什么这段代码不起作用？

```
 $('#categorylist').sortable({
                placeholder: "ui-state-highlight",
                update:function(e, ui){

                    var categorylist = $('#categorylist').sortable('serialize', {attribute:'data-id'});

                    $.ajax({
                        url:'actions_category.php?action=rank',
                        method:'post',
                        data:categorylist,
                        cache:false
                    });

                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:31:19.880

它只会为 GET 和 HEAD 请求附加时间戳。其他类型的请求不需要它，除了 IE8 中您已经针对 URL 发出 GET 请求的 POST 请求。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:28:19.367

注意支持的 HTTP 方法

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

缓存（默认值：true，对于 dataType 'script' 和 'jsonp' 为 false） 类型：Boolean 如果设置为 false，它将强制浏览器不缓存请求的页面。注意：将缓存设置为 false 仅适用于**HEAD**和**GET**请求。它通过将“_={timestamp}”附加到 GET 参数来工作。其他类型的请求不需要该参数，除非在 IE8 中对已由 GET 请求的 URL 进行 POST。

# java - LibVlc 是跨平台的吗？

> ID：14416326
> 
> 赞同：2
> 
> 时间：2013-01-19T16:27:01.690
> 
> 标签：java, libvlc, vlcj

我对使用媒体编解码器很陌生，我试图使用 Java 播放媒体文件并在那里进行一些研究，我发现 vlcj 绑定符合我的需要。我希望将 libvlc 本机库与我的应用程序中的插件模块捆绑在一起。我的问题是 libvlc 是跨平台的吗？还是更具体到操作系统/架构。我知道每个模块都是针对特定架构编译的，但是核心 libvlc 本身呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:17:44.080

不，它不是跨平台的——它是一个本地库，特定于操作系统。如果您希望将生成的应用程序作为一个多平台二进制文件分发，则必须为您希望支持的每个平台包含 VLC，它会很快变大。我建议不要使用这种方法。

就个人而言，我采用了构建单独的特定于平台的安装程序的方法（所有这些仍然是自动化的并通过 ant 进行处理），然后只是捆绑所需的本机库。这还有一个好处，在一些具有良好依赖支持的系统上，库根本不需要捆绑（例如在 Debian / Ubuntu 上，我只需将 VLC 作为依赖项添加到包的控制文件中。

# c++ - 在 C++ 中，如何访问多维数组中的值？

> ID：14416331
> 
> 赞同：1
> 
> 时间：2013-01-19T16:27:25.697
> 
> 标签：c++, arrays, multidimensional-array, arduino

感谢您的关注！

# 背景

我正在构建一个四轴飞行器，每个手臂上都放置了一条 RGB 可寻址 LED。我正在使用 Arduino 来驱动灯，而 Arduino 代码是 C++，一种我不太了解的语言。

[这是我发布的第一个 StackOverflow 问题](https://stackoverflow.com/questions/14411808/in-c-how-do-i-write-a-3-dimensional-array)，涉及我之前使用此代码时遇到的问题。它为您提供了有关我到底想要做什么的更多背景信息（如果您有兴趣）。

# 问题

[由于我的第一个问题](https://stackoverflow.com/questions/14411808/in-c-how-do-i-write-a-3-dimensional-array)的答案，我现在已经正确地编写了数组“gpsHoldArr” ，但是我无法访问它的值。

在下面的代码中，我调用`toggleLights(gpsHoldArr[x][y])`并传入`gpsHoldArr`. 子阵列应该是指向给定 LED 灯条 ( `[x]`) 和给定步骤 ( `[y]`) 的结果。

`toggleLights`然后应该迭代它传递的数组并将每个 LED 的值（从 1 到 6 的某个数字）和 LED 的红色、绿色和蓝色值发送到控制台。

不幸的是，当我运行下面的代码时，我收到了这个错误： `cannot convert int(*)[3] to int* for argument 1 to 'void toggleLights(int*)'`

任何帮助将不胜感激。

# 这是当前代码：

```
//4 arms, 6 steps, 6 leds
int gpsHoldArr[4][6][6][3] = {
  {
    {{255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}}
},
  {
    {{255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}}
},
  {
    {{255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}}
},
  {
    {{255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {0,0,0}},
    {{255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}, {255,0,0}}
}
};

toggleLights(gpsHoldArr[0][0]); //Toggles lights on strip #1, step #1
toggleLights(gpsHoldArr[1][0]); //Toggles lights on strip #2, step #1
toggleLights(gpsHoldArr[2][0]); //Toggles lights on strip #3, step #1
toggleLights(gpsHoldArr[3][0]); //Toggles lights on strip #4, step #1 

void toggleLights(int lights[]){
  for(int i = 0; i <= 6; ++i)
  {
    set_color_led(i, lights[i], lights[i], lights[i]);
  } 
}

void set_color_led(int led, int r, int g, int b){
   Serial.println(led); //Which LED (or "pixel") is it?
   Serial.println(r); //What is the red value?
   Serial.println(g); //What is the green value?
   Serial.println(b); //What is the blue value? 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:59:35.797

我可能会这样做，沿途删除一些重复。
（宏诡计只是因为 Arduino - 在桌面上我会使用类而不是数组。）

```
struct LED { int r, g, b; };

#define BLACK  {0, 0, 0}
#define RED    {255, 0, 0}

#define DEFAULT_LEDS \
  { {RED, BLACK, BLACK, BLACK, BLACK, BLACK},\
    {RED, RED,   BLACK, BLACK, BLACK, BLACK},\
    {RED, RED,   RED,   BLACK, BLACK, BLACK},\
    {RED, RED,   RED,   RED,   BLACK, BLACK},\
    {RED, RED,   RED,   RED,   RED,   BLACK},\
    {RED, RED,   RED,   RED,   RED,   RED}}

LED gpsHoldArr[4][6][6] = {
   DEFAULT_LEDS,
   DEFAULT_LEDS,
   DEFAULT_LEDS,
   DEFAULT_LEDS
};

void set_color_led(int index, const LED& led){
   Serial.println(index); //Which LED (or "pixel") is it?
   Serial.println(led.r); //What is the red value?
   Serial.println(led.g); //What is the green value?
   Serial.println(led.b); //What is the blue value? 
}

void toggleLights(LED (&leds)[6]){
  for(int i = 0; i < 6; ++i)  // You had a '<=' bug here.
  {
    set_color_led(i, leds[i]);
  } 
}

toggleLights(gpsHoldArr[0][0]); //Toggles lights on strip #1, step #1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:17:43.963

我不认为那`toggleLights()`正在做你认为它正在做的事情。它的输入是一个一维数组，但您传递给它的是一个大小为 [6][3] 的二维数组。调用时`toggleLights(gpsHoldArr[0][0]);`，函数看到的一维内存数组是`{255,0,0,0,0,0}`，即数组中的前六个值。然后，对于这些值中的每一个，您正在调用`set_color_led();`并为多个参数传递相同的值。在 中展开循环`toggleLights()`，这将转换为

```
// set_color_led(i, lights[i], lights[i], lights[i]) for i = {0, ..., 6}
set_color_led(0, 255, 255, 255);
set_color_led(1, 0, 0, 0);
set_color_led(2, 0, 0, 0);
set_color_led(3, 0, 0, 0);
set_color_led(4, 0, 0, 0);
set_color_led(5, 0, 0, 0);
set_color_led(6, 0, 0, 0); // bug here as noted by molbdnilo 
```

这可能不是你想要的。我会将定义更改为`toggleLights()`以下内容：

```
void toggleLights(int lights[][3]){
  for(int i = 0; i < 6; ++i)
  {
    set_color_led(i, lights[i][0], lights[i][1], lights[i][2]);
  } 
} 
```

在这种情况下，当调用 时`toggleLights(gpsHoldArr[0][0]);`，该函数看到的二维数组是

```
{{255,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}, {0,0,0}} 
```

并展开循环`toggleLights()`，这将转换为以下一系列函数调用：

```
// set_color_led(i, lights[i][0], lights[i][1], lights[i][2]) for i = {0, ..., 5}
set_color_led(0, 255, 0, 0);
set_color_led(1, 0, 0, 0);
set_color_led(2, 0, 0, 0);
set_color_led(3, 0, 0, 0);
set_color_led(4, 0, 0, 0);
set_color_led(5, 0, 0, 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T16:29:48.337

当您的函数存在一维数组（衰减为指针）时，您将传入一个二维数组。

我可以建议通过制作结构/类来消除数组维度，它会使事情变得更加清晰。

例如

```
struct Led{
    int r,g,b;
};

void toggleLights(Led lights[]){

Led gpsHoldArr[4][6][6] = 

set_color_led(i, lights[i].r, lights[i].g, lights[i].b); 
```

这应该是您需要进行的所有更改，其余的*应该*按原样工作。

你可以走得更远，也可以做一个手臂`struct`和一个台阶`struct`。

# facebook - 从 Amazon S3（或通用 URL）上传照片到 facebook

> ID：14416336
> 
> 赞同：0
> 
> 时间：2013-01-19T16:27:53.977
> 
> 标签：facebook

我想创建一个应用程序，将照片从在线位置上传到我的 facebook 页面，但无需下载和重新上传它们（facebook 应该直接从 S3 公共 URL 下载它们）。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:44:59.000

# php - MySQL 不工作没有提取信息？

> ID：14416341
> 
> 赞同：0
> 
> 时间：2013-01-19T16:28:37.440
> 
> 标签：php, html, mysql, phpmyadmin, while-loop

我正在做一个学校项目，但我在处理这段代码时遇到了问题。虽然我不能让你们访问我的数据库，但请你们试着找出任何语法错误或我做错了什么。我得到的只是一个空格和循环中的任何回显文本。

```
<?php
$app= mysql_query("SELECT View FROM Stat");
echo "<table><tr>";

while($app_loop = mysql_fetch_array($app)){
    $db_item = $app_loop['Item'];

        $apps= mysql_query("SELECT * FROM Products WHERE Title='$db_item'");}
            while($apps_loop = mysql_fetch_array($apps)){
                $db_icon = $apps_loop['Icon'];
                $db_title = $apps_loop['Title'];

echo"<td>
    <form method='post' action='AppCatPage.php'>
    <input type='image' src='$db_icon' width='50px' height='50px' id='sb'>
    <input type='hidden' value='$db_title' name='apptitleu'>
    </form> 
    </td>"; 
}
echo"</tr></table>";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:38:14.560

> $app= mysql_query("从统计中选择视图");

您仅从表 stat 中选择了查看列

```
$db_item = $app_loop['Item']; 
```

但您正在尝试阅读“项目”列的内容，
将第一行更改为：

```
$app= mysql_query("SELECT * FROM Stat"); 
```

我认为这是问题所在...

# javascript - 滚动事件背景变化

> ID：14416344
> 
> 赞同：0
> 
> 时间：2013-01-19T16:28:58.383
> 
> 标签：javascript, jquery, scroll

我正在尝试添加一个滚动事件，该事件将更改 div 的背景，该 div 也充当窗口背景（它具有 100% 的宽度和高度）。这是据我所知。我不太擅长 jquery。我看过有关单击事件侦听器的教程。但是应用相同的概念，例如将滚动事件返回为 false，让我无处可去。我还看到了一个关于 SO 的教程，该人建议使用数组。但我对使用数组感到很困惑（主要是由于语法）。

我知道插件之类的`waypoints.js`和`skrollr.js`可以使用的，但我需要更改 50-60 左右（因为滚动时播放视频的错觉）......但这不可行。

这是我使用的代码：-

```
*
{
    border: 2px solid black;
}

#frame
{
    background: url('1.jpg') no-repeat;
    height: 1000px;
    width: 100%;
}

</style> 
```

```
<script>

$(function(){

for ( i=0; i = $.scrolltop; i++)
{
    $("#frame").attr('src', ''+i+'.jpg');
}

});

</script>

<body>

<div id="frame"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:52:55.210

在您的 for 循环中，您正在设置`src`属性 of`#frame`但它`div`不是`img`.

所以，而不是这个：

```
$("#frame").attr('src', ''+i+'.jpg'); 
```

尝试这个：

```
$("#frame").css('background-image', 'url(' + i + '.jpg)'); 
```

**`element`**使用 jQuery将滚动事件绑定到目标：

```
$('#target').scroll(function() {
    //do stuff here
}); 
```

**`window`**使用 jQuery将滚动事件绑定到：

```
$(window).scroll(function () {
    //do stuff here
}); 
```

这是jQuery的[文档](http://api.jquery.com/scroll/)`.scroll()`。

**更新：**

如果我理解正确，这里有一个**[关于 jsFiddle](http://jsfiddle.net/onury/ckHuF/)**的工作演示，说明您想要实现的目标。

**CSS：**

```
html, body {
    min-height: 1200px; /* for testing the scroll bar */
}

div#frame {
    display: block;
    position: fixed; /* Set this to fixed to lock that element on the position */
    width: 300px;
    height: 300px;
    z-index: -1; /* Keep the bg frame at the bottom of other elements. */
} 
```

**Javascript：**

```
$(document).ready(function() {
    switchImage();
});

$(window).scroll(function () {
    switchImage();
});

//using images from dummyimages.com for demonstration (300px by 300px)
var images = ["http://dummyimage.com/300x300/000000/fff", 
              "http://dummyimage.com/300x300/ffcc00/000",
              "http://dummyimage.com/300x300/ff0000/000",
              "http://dummyimage.com/300x300/ff00cc/000",
              "http://dummyimage.com/300x300/ccff00/000"
             ];

//Gets a valid index from the image array using the scroll-y value as a factor.
function switchImage()
{
    var sTop = $(window).scrollTop();
    var index = sTop > 0 ? $(document).height() / sTop : 0;
    index = Math.round(index) % images.length;
    //console.log(index);
    $("#frame").css('background-image', 'url(' + images[index] + ')');
} 
```

**HTML：**

```
<div id="frame"></div> 
```

**进一步的建议：**

我建议你改变`background-image`body **，**而不是 div 。但是，如果您**必须为此**使用 a `div`；那么你最好添加一个**调整大小**事件监听器，`window`并在每次调整大小时设置/更新该 div 的高度。原因是; `height:100%`在任何浏览器中都无法按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:08:08.643

我自己之前已经这样做了，如果我是你，我不会使用图像作为背景，而是使用普通的“img”标签将其添加到页面顶部使用一些 css 以确保它保持在后面所有其他元素。这样，您可以操纵图像的大小以更好地适应屏幕宽度。我遇到了很多问题，试图让背景的大小正确。

html标记：

```
<body>
<img src="1.jpg" id="img" />
</body> 
```

脚本代码：

```
$(function(){

    var topPage = 0, count = 0;

    $(window).scroll( function() {
        topPage = $(document).scrollTop();

        if(topPage > 200) {
           // function goes here
           $('img').attr('src', ++count +'.jpg');
        } 
    });
}); 
```

我不完全确定这是否是您想要做的，但基本上，当窗口滚动时，您将距离值分配到页面顶部，然后您可以运行 if 语句来查看您是否是某个点。之后只需更改运行您想要运行的功能。

如果你想提供一个你希望图像改变的范围做这样的事情，那么将会发生的是这将允许你只在 200 和 400 之间的指定范围之间运行一个函数，即到顶部的距离页。

```
$(function(){

    var topPage = 0, count = 0;

    $(window).scroll( function() {
        topPage = $(document).scrollTop();

        if(topPage > 200 && topPage < 400) {
           // function goes here
           $('#img').attr('src', ++count +'.jpg');
        } 
    });
}); 
```

# c# - 如何使用事件将方法从 UserControl 调用到另一个 UserControl 或另一个 aspx.Page？

> ID：14416350
> 
> 赞同：0
> 
> 时间：2013-01-19T16:29:27.213
> 
> 标签：c#, asp.net, events, user-controls

我在 Default.aspx 中有两个用户控件。

我想做以下事情：

如果我按下按钮（SetButton），那么我想检查 CheckBox1（在 UCCheckBox 中）是否被选中。如果它被选中，那么我从 UCTextBox 调用该方法。该方法称为 HideTextBox。

我如何使用公共事件来做到这一点？

我想从 Default.aspx 调用 UserControls 的方法。

我有这个源代码，例如：

**默认.aspx：**

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="NewControls.Default" %>

<%@ Register Src="~/uc/UCCheckBox.ascx" TagPrefix="uc1" TagName="UCCheckBox" %>
<%@ Register Src="~/uc/UCTextBox.ascx" TagPrefix="uc1" TagName="UCTextBox" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>UserControls</title>
</head>
<body>
    <form id="form1" runat="server">

        <%--UserControl with Checkbox--%>
        <uc1:UCCheckBox runat="server" ID="UCCheckBox" />
        <%--UserControl with Textboxes--%>
        <uc1:UCTextBox runat="server" ID="UCTextBox" />
        <%--Label for result--%>
        <asp:Label ID="ResultLabel" runat="server"></asp:Label>

        <asp:Button ID="SetButton" OnClick="SetButton_Click" runat="server" Text="Button" />

    </form>
</body>
</html> 
```

**默认.aspx.cs：**

```
public partial class Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void SetButton_Click(object sender, EventArgs e)
        {
           //If I press this button then I want to check if the CheckBox1 (in UCCheckBox) is selected. If it´s checked then i call the method from UCTextBox. The method is called HideTextBox.
        }
    } 
```

**UCCheckbox.ascx**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="UCCheckBox.ascx.cs" Inherits="NewControls.uc.UCCheckBox" %>

<asp:CheckBox ID="CheckBox" Text="Checkbox" runat="server" /> 
```

**UCCheckBoxes.ascx.cs**

```
public partial class UCCheckBox : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        public bool isChecked()
        {
            if (CheckBox.Checked)
            {
                return true;
            }
            else
            {
                return false;
            }
        }

    } 
```

**UCTextBox.ascx**

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="UCTextBox.ascx.cs" Inherits="NewControls.uc.UCTextBox" %>
<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>

<asp:TextBox ID="TextBox2" runat="server"></asp:TextBox> 
```

**UCTextBox.ascx.cs**

```
public partial class UCTextBox : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        public void hideTextboxes() 
        {
            TextBox1.Visible = false;
            TextBox2.Visible = false;
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:38:27.847

该按钮是页面的一部分，因此它具有页面中所有控件的可见性，所以为什么您不能访问这样的控件实例，假设您的控件实例名称是 UCCheckBox1 和 UCTextBox1：

```
 protected void SetButton_Click(object sender, EventArgs e)
        {
           if (UCCheckBox1.IsChecked) {
               UCTextBox1.hideTextboxes();
           }
        } 
```

# php - if 语句和时间 php

> ID：14416353
> 
> 赞同：0
> 
> 时间：2013-01-19T16:29:35.283
> 
> 标签：php

用户输入租用公共汽车的时间和小时数。然后我从 mysql 数据库中查询这些信息。我找到了租用的结束时间，并计算出在午夜之后的租用时间（如果有的话）。我很确定我有这个工作，但现在它只是不工作，我不明白为什么它不会。找到结束时间是正确的，但我的 if 语句似乎不起作用。例如，当结束时间是“02:00:00”所以凌晨 2 点时，它遵循 if 语句的路径，使得午夜之后的时间是 3 小时，而应该是 2 小时。关于为什么的任何帮助？谢谢。（$hireid = 数据库中最新的雇用 ID）

```
//GET LATEST TIME AND LENGTH OF HIRE

$result = mysql_query("SELECT time, length FROM hire WHERE hireid='$hireid'") or   die ('Error: '.mysql_error ());

while ($row = mysql_fetch_assoc($result)){

$time = $row['time'];
$length = $row['length'];

}
//FIND AMOUNT OF HOURS BEFORE AND AFTER MIDNIGHT  

echo "Time: " . $time . "</br>";
echo "Length: " . $length . "</br>";
echo "Hours: " . $hours . "</br>";

echo "End time: " . $endtime = date('H:i:s', strtotime($time . '+ ' . $length .  'hours')) . "</br>";

$hoursafter = 0;

if ($endtime = "01:00:00") {
$hoursafter = 1;
}

if ($endtime = "02:00:00") {
$hoursafter = 2;
}

if ($endtime = "03:00:00") {
$hoursafter = 3;
}

echo "Hours after midnight: " . $hoursafter . "</br>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:32:19.930

你应该做：

```
if ($endtime == '02:00:00'){
$hoursafter = 2;
} 
```

您只是在 if 语句中错过了一个 = 。如果您通过脚本中的所有语句更改它，它将起作用:)

# scala - 使用 net.liftweb.record 提升基本示例注册错误。{ MetaMegaProtoUser, MegaProtoUser }

> ID：14416355
> 
> 赞同：0
> 
> 时间：2013-01-19T16:29:45.040
> 
> 标签：scala, lift

我正在使用 2.5-M3 的 Lift 基本示例项目，并希望将其改编为 Record 和 Mongo。

一切正常，除非我尝试注册生成的表单只有一个密码字段且没有重复字段。填写该字段时，我收到一条错误消息“密码不匹配”。

# wpf - 实现控制模板后按钮内容不显示

> ID：14416363
> 
> 赞同：2
> 
> 时间：2013-01-19T16:30:24.397
> 
> 标签：wpf

由于我有一个Button的资源样式控件模板，另外我在按钮本身中定义了一个控件模板。但是Button的内容没有显示。我该如何解决这个问题？

```
<Grid>
        <Grid.Resources>
        <Style TargetType="Button">
            <!--Set to true to not get any properties from the themes.-->
            <Setter Property="OverridesDefaultStyle" Value="true"/>
                <Setter Property="Background" Value="Yellow"/>
                <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                                <Border TextBlock.Foreground="{TemplateBinding Foreground}"
                x:Name="Border"
                CornerRadius="10"
                BorderThickness="1"/>
                                    <ContentPresenter HorizontalAlignment="Center"
                            VerticalAlignment="Center"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        </Grid.Resources>
        <Button Name="test" Width="50" Height="60" Content="myvalue">
            <Button.Template>
                <ControlTemplate>
                    <Grid>
                        <Ellipse Fill="{TemplateBinding Background}"/>
                        <ContentPresenter HorizontalAlignment="Center"
                            VerticalAlignment="Center"/>                       
                    </Grid>
                </ControlTemplate>
            </Button.Template>
        </Button>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:39:41.023

您应该设置`TargetType`为.`ControlTemplate``Button`

```
<ControlTemplate TargetType="Button">
    <Grid>
        <Ellipse Fill="{TemplateBinding Background}"/>
        <ContentPresenter HorizontalAlignment="Center"
                             VerticalAlignment="Center"/>                       
    </Grid>
</ControlTemplate> 
```

说明（来源[msdn](http://msdn.microsoft.com/en-us/library/system.windows.controls.controltemplate.targettype.aspx)）：

> 如果资源部分中有一个独立的 ControlTemplate，且 TargetType 属性设置为某个类型，则 ControlTemplate 不会自动应用于该类型。相反，您需要指定一个 x:Key 并显式应用模板。
> 
> 另请注意，如果模板定义包含 ContentPresenter，则 ControlTemplate 需要 TargetType 属性。

# c# - 使用 C#.net 中的 mvc 结构一次将 datagridview 的所有数据插入数据库

> ID：14416364
> 
> 赞同：-3
> 
> 时间：2013-01-19T16:30:28.670
> 
> 标签：c#

我想通过使用 MVC 结构将数据从 datagrid 插入 sql server

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:43:02.620

到目前为止，当您付出零努力来解决问题时，就不可能回答您的问题。因此，我建议您通读 MVC 4 教程以了解其工作原理。

[http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)

# ruby-on-rails-3 - 通过 data-erb-id 删除元素

> ID：14416365
> 
> 赞同：1
> 
> 时间：2013-01-19T16:30:39.670
> 
> 标签：ruby-on-rails-3, spree, deface

我无法通过 data-erb-id 删除元素。

这是来自[http://deface.heroku.com/](http://deface.heroku.com/)的代码：

```
 <p class="field" data-erb-id='&lt;%="#{address_id}address1" %&gt;'>
    <code erb-loud> form.label :address1, t(:street_address) </code><span class="required">*</span><br><code erb-loud> form.text_field :address1, :class => 'required' </code>
  </p>
  <p class="field" data-erb-id='&lt;%="#{address_id}address2" %&gt;'>
    <code erb-loud> form.label :address2, t(:street_address_2) </code><br><code erb-loud> form.text_field :address2 </code>
  </p> 
```

这是我的选择器：

```
p[data-erb-id='<%="#{address_id}address2" %>'] 
```

它匹配一次，正是我需要的

这是我的关闭选择器：

```
p[class='field'] 
```

结果是：

```
<p class="field" id='<%="#{address_id}address1" %>'>
    <%= form.label :address1, t(:street_address) %><span class="required">*</span><br><%= form.text_field :address1, :class => 'required' %>
  </p>

  <p class="field" id='<%="#{address_id}country" %>'>
    <%= form.label :country_id, t(:country) %><span class="required">*</span><br><span id='<%="#{address_id}country-selection" %>'>
      <%= form.collection_select :country_id, available_countries, :id, :name, {}, {:class => 'required'} %>
    </span>
  </p> 
```

所以我需要的块已被删除。

我的应用程序中的这一声明不会删除任何内容：

```
Deface::Override.new(:virtual_path  => "spree/address/_form",
                     :remove => "p[data-erb-id='<%=\"\#{address_id}address2\" %>']",
                     :name          => "checkout_address") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:47:18.303

```
Deface::Override.new(:virtual_path  => "spree/address/_form",
                     :remove => "p[data-erb-id='<%=\"\#{address_id}address2\" %>']",
                     :name          => "checkout_address") 
```

这是解决方案。

# javascript - Android 2.x 和 3.x WebKit 乱七八糟

> ID：14416366
> 
> 赞同：2
> 
> 时间：2013-01-19T16:30:43.783
> 
> 标签：javascript, android, jquery, html, css

我正在开发一个 Android 应用程序，我的目的是至少能够为 Android 2.2+ 发布它。目前，由于 WebView 控件一团糟，我仅限于 Android 4.0+。
该应用程序主要基于 HTML+CSS+JS+jQuery。

`div.appList`显示应用程序列表，单击时应用程序应启动。只是这有一些麻烦；为了使列表可滚动，我必须添加`overflow: scroll;`到其父级。这在 Android 3.0+ 中运行良好。在 Android 2.x 中，列表仍然不可滚动。
我说它在 Android 3.0 中运行良好？好吧，滚动确实如此。现在的问题是它没有注册点击。如果用户点击列表中的一个项目，click 事件根本不会被触发，因为，我猜，它被注册为用户滚动列表。再次使列表不可滚动使项目可点击，但同样，该列表是无用的，因为您只能访问前几个项目。

在 Android 4.0+ 中一切正常

**任何帮助将不胜感激。**

## HTML

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link type="text/css" rel="stylesheet" href="stylesheet.css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="script.js"></script>
</head>
<body>
    <div id="loadingScreen">
    </div>
    <div id="desktop">
        <div class="unity panel">
        </div>
        <div class="unity launcher">
            <div class="launcherIcon bfb">
                <img src="img/unity/launcher.bfb.png" alt="Dash Home" />
            </div>
            <div class="launcherApps iScroll" id="launcherApps">
            </div>
            <div class="launcherIcon launchTrash">
                <img src="img/apps/trash.icon.png" alt="Rubbish Bin" />
            </div>
        </div>
        <div class="window">
            <div class="windowClose">
            </div>
            <div class="windowContent">
                <div class="windowPreferences">
                    <p>Nothing to be seen here, yet</p>
                </div>
            </div>
        </div>
        <div class="unity dash">
            <div class="dashContent">
                <div class="dashApps dashPage iScroll" id="dashApps">
                    <div class="appList"></div>
                </div>
                <div class="dashFiles dashPage iScroll" id="dashFiles">
                    <div class="fileList"></div>
                </div>
            </div>
            <div class="dashRibbon">
                <img src="img/unity/apps.png" alt="Applications" class="activeRibbonItem ribbonApps" />
                <!--<img src="img/unity/files.png" alt="Files" class="ribbonFiles" />-->
            </div>
        </div>
    </div>
</body>
</html> 
```

## CSS

```
html, body
{
    font-family: 'Ubuntu', 'Droid Sans';
    margin: 0px;
    padding: 0px;
    overflow: hidden;
    background: rgb(43,0,30);
}

/*# Loading screen #*/
div#loadingScreen
{
    position: fixed;
    left: 0px;
    top: 0px;
    right: 0px;
    bottom: 0px;
    text-align: center;
    background: rgb(43,0,30) url(img/ubuntuLogo.png) center center no-repeat;
    color: white;
    z-index: 49;
}

/*# Desktop #*/
div#desktop
{
    display: none;
    position: fixed;
    left: 0px;
    top: 0px;
    bottom: 0px;
    right: 0px;
    background: rgb(43,0,30) url(img/wallpaper/wartyFinal.jpg);
    background-position: center center;
    background-size: cover;
}
div.unity.panel
{
    display: none;
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    height: 24px;
    background: rgb(69,68,64) url(img/unity/panel.background.jpg);
    background-repeat: repeat-x;
}
    div.unity.panel.dashOpened
    {
        background: transparent url(img/unity/dashOpened.png);
        border-bottom: 1px solid #504E4F;
    }
div.unity.launcher
{
    display: none;
    position: absolute;
    top: 24px;
    left: 0px;
    bottom: 0px;
    width: 0px; /* Animates to 64px */
    background: transparent url(img/unity/launcher.background.png);
    border-right: 1px solid #504E4F;
    padding: 3px 0px 55px 0px;
}
    div.unity.launcher.dashOpened
    {
        background: transparent url(img/unity/dashOpened.png);
    }
    div.launcherIcon
    {
        display: none;
        width: 52px;
        height: 52px;
        margin: 4px 6px 4px 6px;
        border-radius: 5px;
        background: transparent url(img/unity/launcher.iconbg.png);
        background-position: center;
        background-size: cover;
    }
        div.unity.launcherIcon.dashOpened
        {
            background: grey !important;
            opacity: 0.8;
        }
        div.launcherIcon.bfb
        {
            background-image: none;
            border-radius: 0px;
        }
            div.launcherIcon.bfb img
            {
                width: 52px;
                height: 52px;
                margin: 0px;
            }
        div.launcherIcon img
        {
            width: 46px;
            height: 46px;
            margin: 3px;
        }
        div.launcherIcon.launchFirefox
        {
            background-color: rgb(247,192,48);
        }
        div.launcherIcon.launchTrash
        {
            position: absolute;
            bottom: 3px;
            background-color: #303030;
        }
    div.window
    {
        display: none;
        position: absolute;
        top: 24px;
        left: 64px;
        right: 0px;
        bottom: 0px;
        background: rgb(242,241,239);
        color: black;
    }
        div.windowClose
        {
            position: fixed;
            left: 0px;
            top: 0px;
            width: 64px;
            height: 24px;
            text-align: center;
            background: url(img/window/close.png) center center no-repeat;
        }
div.dash
{
    display: none;
    position: absolute;
    left: 64px;
    top: 24px;
    bottom: 0px;
    right: 0px;
    background: transparent url(img/unity/dashOpened.png);
    padding: 0px 12px 48px 12px;
    color: white;
    overflow: scroll;
}
    div.dash.dashOpened
    {
        display: block;
    }
    div.dash *:link
    {
        color: white;
        text-decoration: none;
        text-shadow: 0px 0px 2px white;
    }
    div.dash ul li
    {
        padding: 5px;
    }

/*# Applications #*/
div.appWindow
{
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    bottom: 0px;
} 
```

## JavaScript

```
var bootscreenDelay = 500; // 2500 //
var appOpened = false;
var dashOpened = false;

$(document).ready
(
    function ()
    {
        $('div#loadingScreen').delay (bootscreenDelay).fadeOut (800);
        $('div#desktop').delay (bootscreenDelay + 300).fadeIn (600,
            function ()
            {
                $('div.unity.panel').slideDown (400,
                    function ()
                    {
                        $('div.unity.launcher').css ('display', 'block').animate ( { width: 64 }, 600,
                            function ()
                            {
                                $('div.launcherIcon').each
                                (
                                    function (i)
                                    {
                                        $(this).delay (i * 200).slideDown (400);
                                    }
                                );
                            }
                        );
                    }
                );
            }
        );

        $('div.windowClose').click
        (
            function ()
            {
                $('div.appFirefox .appFirefoxBrowser').fadeOut (400,
                    function ()
                    {
                        appFirefoxNavigate ('http://start.ubuntu.com/');
                    }
                );
                $('div.appWindow.appFirefox').fadeOut (800);
                $('div.window').delay (200).fadeOut (800);
                appOpened = false;
            }
        );

        /*# Dash #*/
        $('div.launcherIcon.bfb').click
        (
            function ()
            {
                if (! dashOpened)
                    openDash ();
                else
                    closeDash ();
            }
        );

        /*# Trash #*/
        $('div.launcherIcon.launchTrash').click
        (
            function ()
            {
                closeEverything ();

                android.openInBrowser ('http://www.dafk.net/what/');
            }
        );
    }
);

function closeEverything ()
{
    $('div.windowClose').trigger ('click');
    closeDash ();
}

function openDash ()
{
    $('*').addClass ('dashOpened');
    dashOpened = true;

    var appList = android.getApplicationList ();
    var pkgMan = android.getPackageManager ();
    var strAppList = '<ul>';
    for (var i = 0; i < appList.size (); i++)
    {
        var appLabel = android.getApplicationLabel (appList.get (i));
        strAppList += '<li onclick="launchApp (' + i + ')">' + appLabel + '</li>';
    }
    strAppList += '</ul>';
    $('div.appList').html (strAppList);
}

function closeDash ()
{
    $('*').removeClass ('dashOpened');
    dashOpened = false;
}

function launchApp (i)
{
    android.launchAppFromList (i);
} 
```

* * *

任何可以帮助我让它在旧版本上工作的东西都值得赞赏。目标是 Android 2.x，但如果你能帮我让它在 3.2+ 上运行，我已经很高兴了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T17:57:34.067

`overflow:scroll|auto`在 Android 2.X 设备上无法正常工作。这个css规则等于`overflow:hidden`:)

您无法修复它，但您可以使用插件来避免这种行为，例如[http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4)

# mysql - Errcode 13，SELECT INTO OUTFILE 问题

> ID：14416379
> 
> 赞同：8
> 
> 时间：2013-01-19T16:31:49.067
> 
> 标签：mysql

我试图了解在使用 INTO OUTFILE 命令时不断遇到问题的原因。

我总是得到这个错误：

```
ERROR 1 (HY000): Can't create/write to file '/var/www/p1.txt' (Errcode: 13)

SELECT password FROM mysql.user WHERE user='root' INTO OUTFILE '/var/www/p1.txt'; 
```

有用的细节：

*   网络应用程序：DVWA（本地主机）（用于学习目的）

*   服务器：Apache/2.2.14 (Ubuntu) - PHP/5.3.2

*   MySQL 版本 5.1.63

*   操作系统 Linux Backtrack 5r3。

我以 root 身份运行该命令。另外，我可以在 /var/www/ 中自由创建文件夹或文件

Errcode 13 我知道这意味着权限被拒绝，但我应该怎么做才能解决这个问题？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T16:37:26.473

即使您以 root 身份登录 MySQL，文件写入也将以运行实际 MySQL 守护程序的用户身份执行。

换句话说，您应该检查哪个用户运行 mysqld，并为该用户授予对目录的写入权限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-30T16:54:27.157

您必须更改 user 的权限`mysqld`。首先运行以下命令`sudo aa-status`来检查您的用户状态和授权目录。如果要更改权限，请编辑`/etc/apparmor.d/usr.sbin.mysqld`并插入所需的目录。

然后您必须重新启动 apparmor`sudo /etc/init.d/apparmor restart`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T16:38:17.880

chown /var/www 给试图写入文件的用户，或 chmod 777 /var/www

这可能不是一种安全的方法，您可能想考虑将文件放在其他地方

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-13T11:21:43.737

虽然这个帖子很老了，但在 2018 年这个问题仍然存在。我花了几个小时在这个迷宫中敲打我的头。

服务器版本：在 Ubuntu 14.04 上运行的 5.7.24 MySQL 社区服务器 (GPL)

1.  要允许 MySql 选择 INTO OUTFILE，需要`secure-file-priv`在配置中设置 MySQL 的选项。将以下 2 行附加到`/etc/mysql/mysql.conf`：

    ```
    [mysqld]
    # allow INTO OUTFILE file and LOAD DATA INFILE to this directory
    secure_file_priv=/usr/share/mysql-files 
    ```

2.  `/usr/share/mysql-files`是存储我的文件的目录。我创建它是这样做的：

    ```
    sudo su
    cd /usr/share
    mkdir mysql-files
    chown mysql:mysql mysql-files
    chmod a+rw mysql-files 
    ```

更改`/usr/share/mysql-files`为您喜欢的任何内容，但避免使用该`/tmp`目录！

*为什么？* 因为，下次您将重新启动时，该`/tmp`目录将被愉快地删除，包括您宝贵的 mysql-files 子目录。mysql 服务然后阻塞并且它不会启动，从而导致神秘消息出现奇怪的错误。

3.  重启mysql并检查：

    ```
    sudo su
    service mysql restart
    mysql
    mysql> SHOW VARIABLES LIKE "%secure%";
    +--------------------------+-------------------------+
    | Variable_name            | Value                   |
    +--------------------------+-------------------------+
    | require_secure_transport | OFF                     |
    | secure_auth              | ON                      |
    | secure_file_priv         | /usr/share/mysql-files/ |
    +--------------------------+-------------------------+
    3 rows in set (0.07 sec)
    mysql> quit
    Bye 
    ```

4.  你还**没有完成**！

有一个名为`apparmor`谁会破坏你的项目的巨魔。编辑文件`/etc/apparmor/local/usr/sbin/mysqld`并附加以下 2 行——不要忘记结尾的逗号：

```
 /usr/share/mysql-files rw,
    /usr/share/mysql-files/** rw, 
```

保存它，然后重新解析：

`sudo apparmor_parser -r /etc/apparmor.d/usr.sbin.mysqld`

那应该可以。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-28T22:06:06.653

在 centos 上，selinux 的表现并不好。

```
$ getenforce
Enforcing

$ setenforce 0
Permissive 
```

现在这很粗糙，但对我有用（直到重新启动，然后重新打开）。如果这个临时措施有效，您需要谷歌了解如何正确配置 selinux。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-09T11:36:56.473

检查 mysqld 的用户，

```
ps -aef | grep mysql
mysql     9355  9102  0 Aug24 ?        21:53:25 /usr/libexec/mysqld 
```

检查wiich group mysql属于with，

```
groups mysql
mysql : mysql www 
```

然后将文件写入属于mysql或对组www和mysql具有写权限的路径下。例如，test under 拥有对 www 组的写权限。

```
ll /data/
drwxrwxr-x 2 www    www 4096 Dec  9 19:31 test 
```

然后执行mysql`mysql -u root -p -e 'use sc_test; select file_path from sc_files INTO OUTFILE "/data/test/paths.txt";'`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-14T22:42:58.717

我也与这个神秘的错误斗争了几个小时，尝试了我能找到的一切，但无济于事，最后我记得几年前我已经遇到过同样的问题，当时无论我搜索了多长时间都找不到解决方案，并且尝试了所有这些聪明的建议。

`secure_file_priv`对我来说是新的，但我没有尝试这个，因为我不想重建我的 docker 容器只是为了让它工作。

### 解决方案

查看我的`docker-compose`文件，我找到了解决此问题的方法：我没有到目标目录的映射，因此对于`mysql`容器，该目录不存在。

### 解决方法

那时我为我的`cron`工作开发了一个解决方法：

1.  首先转储到 tmp（我的容器有一个映射）
2.  mv 到它应该放在首位的位置

好吧，它工作得很好，所以为什么要打扰。

# html - 单击清单 (IE - HTML)。为什么不工作？

> ID：14416381
> 
> 赞同：0
> 
> 时间：2013-01-19T16:32:00.373
> 
> 标签：html, vba

早上好！我正在开发一个宏来单击页面上的几个按钮，但有些按钮不起作用。有谁知道为什么？

我将我的工作表发布在：[http ://www.sendspace.com/file/3if8c6](http://www.sendspace.com/file/3if8c6)

提前感谢您的帮助。

西尔玛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T02:06:24.700

在电子表格中，我发布了一张带有无法点击的 02 按钮的图片。无论如何，我会在这里发布代码。

谢谢！

```
Sub test()
Dim ie
Dim obj
Dim obj2
Dim linkCollection2
Dim elemCollection
Dim t As Integer
Dim r As Integer, c As Integer

Set ie = CreateObject("internetexplorer.application")
ie.Navigate2 "http://www.infomoney.com.br/mercados/agendas"
 ie.Visible = True

Do While ie.Busy
Loop
Do Until ie.Document.ReadyState = "complete"
Loop

Dim LinkFound As Boolean
Dim linkCollection

Set linkCollection = ie.Document.getElementsByTagName("A")
For Each link In linkCollection
If link.InnerText = "Resultados" Then
LinkFound = True
link.Click
Exit For
End If

Next

If Not LinkFound Then
MsgBox "Link Not Found!"
Exit Sub
End If

Do While ie.Busy
Loop
Do Until ie.Document.ReadyState = "complete"
Loop

    For Each obj In ie.Document.All.Item("ctl00$cphContent$ctl02$ddlReferencePage").Options
        If obj.InnerText = "3T12" Then
            obj.Selected = True
          '  ie.Document.forms(0).submit
            Exit For
        End If
    Next obj

    Set linkCollection2 = ie.Document.getElementsByTagName("A")
For Each link In linkCollection2
If link.InnerText = "Resultados" Then
LinkFound = True
link.Click
Exit For
End If

Next
        Set elemCollection = ie.Document.getElementsByTagName("TABLE")
        For t = 0 To elemCollection.Length - 1
        For r = 0 To elemCollection(t).Rows.Length - 1
            For c = 0 To elemCollection(t).Rows(r).Cells.Length - 1
                ThisWorkbook.Worksheets(1).Cells(r + 1, c + 1) = elemCollection(t).Rows(r).Cells(c).InnerText
            Next c
        Next r
    Next t

    ' The error happens here
' TO FROM HERE DOES NOT WORK. WHY?

    For Each obj2 In ie.Document.All.Item("tblCInvestorData_length").Options
        If obj.InnerText = "100" Then
            obj2.Selected = True
          '  ie.Document.forms(0).submit
            Exit For
        End If
    Next obj2

End Sub 
```

# basic4android - Basic4Android sql1更新

> ID：14416385
> 
> 赞同：0
> 
> 时间：2013-01-19T16:32:13.423
> 
> 标签：basic4android

关于更新 sql db (Lover.db) 中的记录，我一直使用 basic4android。这有效：

```
 SQLLover.ExecNonQuery("UPDATE Profiles SET Mobile ='Nos', " & _
   "Name = 'Nme', Sunday = 'SundayX', Monday = 'MondayX', " & _
   "Tuesday = 'TuesdayX', Wednesday = 'WednesdayX', Thursday = 'ThursdayX', " & _
   " Friday = 'FridayX', Saturday = 'SaturdayX', " & _
   "StartTime = 'lblTimeFrom.text', EndTime = 'lblTimeTo.Text' " & _
   "WHERE Mobile='07xxxxxxxxx' AND Name='Sam'") 
```

但当然只是用单引号中的数据更新。我想使用一些变量，并尝试过这个；

```
SQLLover.ExecNonQuery2("Update Profiles SET(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)", & _
    Array As Object(Nos, Nme, SundayX, MondayX, TuesdayX, WednesdayX, & _
    ThursdayX, FridayX, SaturdayX, lblTimeFrom.Text, lblTimeTo.Text)) 
```

这是正确的语法吗？当然，, `Nos`,`Nme`等`SundayX`是我的变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:09:18.003

你的`UPDATE`语法完全错误。正确的语法是`UPDATE table SET column = value, column2 = value2`等等。您的代码甚至没有做任何与您的代码相近的事情。我不会费心把整件事都打出来，但我会做的足够让你开始：

```
SQLLover.ExecNonQuery2("Update Profiles " & _
  "SET Mobile = ?, Name = ?, Sunday = ?, Monday = ?", & _
  Array As Object(Nos, Nme, SundayX, MondayX)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-12T15:18:53.517

使用您的代码，即工作代码，为了能够在查询中使用变量，您必须转义查询并连接变量。看看这个简短的例子

```
SQLLover.ExecNonQuery("UPDATE Profiles SET Mobile = ' " & NOs & " ', Name = ' "&NMe & " ' WHERE Name = ' " & OldNameVariable & " ' ") 
```

SO TO USE VARIABLE 插入 **“&** *VARIABLENAME* **&”** ，如示例（Mobile = '“& Nos &”'）

提示：最后一个查询应如下所示： AND Name=' " & SamOldVariableName & **" ' "** )

# jquery - Jquery JSON 多个请求

> ID：14416393
> 
> 赞同：0
> 
> 时间：2013-01-19T16:34:19.453
> 
> 标签：jquery, json, api

我需要调整以下代码以对 3 个单独的页面发出多个请求（调整 &page=1、&page=2、&page=3），除了重复 3 次之外，我该如何组合呢？

```
$.getJSON("http://www.behance.net/v2/users/" + user + "/projects?api_key=" + api + "&callback=?&page=1", function (data) {
    var project_str = "";
    for (i = 0; i < data.projects.length; i++) {
        obj = {};
        obj = data.projects[i];
        project_str += '<a class="link" href="#' + obj.id + '"><img src="' + obj.covers['404'] + '" /></a>';
    }
    $('#behance_container div').append(project_str);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:43:21.500

```
$.each([1,2,3], function(i, numb) {
    $.getJSON("http://www.behance.net/v2/users/"+user+"/projects?api_key="+api+"&callback=?&page="+numb, function (data) {
        var project_str = "";
        $.each(data.projects, function(i, obj) {
            project_str += '<a class="link" href="#' + obj.id + '"><img src="' + obj.covers['404'] + '" /></a>';
        });
        $('#behance_container div').append(project_str);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:44:48.060

由于`$.getJSON`调用是异步的，您可能希望先收集所有数据，然后再将其显示给用户。否则，每次将数据检索/附加到 DOM 时，您都会得到一点“闪光”。以下内容未经测试，但应该可以工作（如果没有，我希望你能帮助你朝着正确的方向发展）。

```
var nrOfPages = 3,
    projects = [];

for(var i = 1; i <= nrOfPages; i++) {
    retrieveData(i);
}

// Retrieve the data by the pageNr
function retrieveData(pageNr) {
    $.getJSON("http://www.behance.net/v2/users/" + user + "/projects?api_key=" + api + "&callback=?&page=" + pageNr, function (data) {
        for (i = 0; i < data.projects.length; i++) {
            projects.push(data.projects[i]);
        };

        if(pageNr == nrOfPages) { // Check if all the pages are retrieved
            processData();
        }
    });
};

// Process the retrieved data
function processData() {
    var project_str = "";
    for (i = 0; i < data.projects.length; i++) {
        obj = {};
        obj = data.projects[i];
        project_str += '<a class="link" href="#' + obj.id + '"><img src="' + obj.covers['404'] + '" /></a>';
    }
    $('#behance_container div').append(project_str);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:41:25.367

就像是：

```
for(var i=1;i<=3;i++)
{
    $.getJSON("http://www.behance.net/v2/users/" + user + "/projects?api_key=" + api + "&callback=?&page=" + i, function (data) {
        var project_str = "";
        for (i = 0; i < data.projects.length; i++) {
            obj = {};
            obj = data.projects[i];
            project_str += '<a class="link" href="#' + obj.id + '"><img src="' + obj.covers['404'] + '" /></a>';
        }
        $('#behance_container div').append(project_str);
    });
} 
```

# c# - 回调和 onthreadfinish

> ID：14416397
> 
> 赞同：0
> 
> 时间：2013-01-19T16:35:06.380
> 
> 标签：c#, winforms, multithreading, delegates

我只是要求最干净的方法来在线程运行时进行回调以更新 GUI，以及在线程完成时调用的方法。

所以在我的示例中，我有一个**Counter**类（这是任务）和 2 个委托，1 个用于回调，1 个用于完成线程。

这一切都很好，但我觉得这不是最好/最干净/..的方式。

任何建议将不胜感激，我很难理解委托和线程线程的概念，因为我很久以前还没有开始编程。

**计数器类**

```
class Counter
{
    private PrintCallback cb;
    private OnActionFinish oaf;

    public void SetCallback(PrintCallback c)
    {
        this.cb = c;
    }

    public void SetOnFinished(OnActionFinish f)
    {
        this.oaf = f;
    }

    public void Count()
    {
        for (int i = 0; i < 1000; i++)
        {
            cb(i);
        }
        oaf();
    }

} 
```

**我的主要形式**

```
public delegate void PrintCallback(int i);
public delegate void OnActionFinish();

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        PrintCallback cb = new PrintCallback(Print);
        OnActionFinish otf = new OnActionFinish(Finished);
        Counter c = new Counter();
        c.SetCallback(cb);
        c.SetOnFinished(otf);
        Thread t = new Thread(c.Count);
        t.Start();
        label1.Text = "Thread started";
    }

    private void Print(int i)
    {
        if (textBox1.InvokeRequired)
        {
            textBox1.Invoke((MethodInvoker)delegate { 
                textBox1.Text += i + "\r\n";
            });
        }
        else
        {
            textBox1.Text += i + "\n";
        }
    }

    private void Finished()
    {
        if (label1.InvokeRequired)
        {
            label1.Invoke((MethodInvoker)delegate { 
                label1.Text = "Thread finished";
                textBox1.SelectionStart = textBox1.Text.Length;
                textBox1.ScrollToCaret();
            });
        }
        else
        {
            label1.Text = "Thread finished";
        } 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T17:27:15.630

重构你的代码，使用你自己的技术，它可能变成这样：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        label1.Text = "Thread started";
        Counter c = new Counter(Print, Finished);
        new Thread(new ThreadStart(c.Count)).Start();
    }

    private void Print(int i)
    {
        if (InvokeRequired)
            Invoke(new Action<int>(Print), i);
        else
            textBox1.Text += i + "\r\n";
    }

    private void Finished()
    {
        if (InvokeRequired)
        {
            Invoke(new Action(Finished));
        }
        else
        {
            label1.Text = "Thread finished";
            textBox1.SelectionStart = textBox1.Text.Length;
            textBox1.ScrollToCaret();
        }
    }
}

class Counter
{
    private readonly Action<int> _output;
    private readonly Action _finished;

    public Counter(Action<int> output, Action finished)
    {
        _output = output;
        _finished = finished;
    }

    public void Count()
    {
        for (int i = 0; i < 1000; i++)
            _output(i);
        _finished();
    }
} 
```

# svn - 我做对了吗（SVN合并和发布）

> ID：14416399
> 
> 赞同：1
> 
> 时间：2013-01-19T16:35:17.627
> 
> 标签：svn

我应该将我的更改发布到主干。我正在使用分支 X。我是 SVN 的初学者。我想这样做：

*   结帐整个行李箱
*   与我的分支中的更改合并（从分支存储库我会在他的日志中标记我的更改）
*   在主干中提交合并

可以吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:45:27.633

警告：我有一段时间没有使用 SVN 了！

如果您为合并指定相关的修订范围，我认为您的建议会起作用，但我总是发现在分支上进行合并和重新集成更容易。

您应该定期将主干合并到您的分支中，然后在分支完成后使用重新集成选项使主干与分支代码保持同步。

通过这种方式，您可以定期处理分支中的冲突，因此通常更容易处理冲突。

# sql - 格式化日期sql

> ID：14416400
> 
> 赞同：1
> 
> 时间：2013-01-19T16:35:24.370
> 
> 标签：sql, database, oracle

我想在`mydate`名为`empl`. 但是，我不会去任何地方。我试过了

```
SELECT CONVERT(VARCHAR(10), mydate,103) from empl 
```

但得到一个`missing expression error`.

我想更改格式列中的当前格式

`dd-mm-yy`到`mm/dd/yy`

编辑：我使用甲骨文

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:41:16.057

您能否将列类型更改为最新？然后你可以使用 date_format

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:48:08.007

如果列的数据类型是`DATE`，可以使用**[`TO_CHAR()`](http://www.techonthenet.com/oracle/functions/to_char.php)**函数：

```
SELECT to_char(mydate, 'mm/dd/yy')
FROM empl ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:51:30.013

您显示的 Convert 语句适用于 MS-SQL，您需要代码 3 而不是 103，100 系列给出 4 位数的年份。尝试： `select to_char(mydate,'MM/DD/YY') from empl`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T16:51:44.470

假设 mydate 以日期数据类型存储，并使用 oracle，简单的方法是： select to_char(mydate, 'dd/mm/yy') from empl

在 Oracle 中，convert 用于更改带参数的字符集（char、destination_char_set、source_char_set）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T17:02:08.617

```
select TO_CHAR(sysdate, 'MM/DD/YYYY') CHRDATE from dual; 
```

# java - 通知点击事件而不显示活动？

> ID：14416402
> 
> 赞同：0
> 
> 时间：2013-01-19T16:35:28.477
> 
> 标签：java, android, android-notifications

我想分配一个在点击通知时将触发的事件，而不显示活动（如此[处](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#DirectEntry)所述）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:40:47.713

您可以通过注册广播接收器来做到这一点。这样，您可以在单击通知时在接收器中运行代码，而无需显示任何 UI。

基本接收器代码：

```
public class Provider extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        super.onReceive(context, intent);
        //Your code here

    }
} 
```

在清单中：

```
<receiver android:name="Provider" /> 
```

通知的示例代码：

```
public static void showNotification(Context context) {
    CharSequence title = "title";
    CharSequence message = "text";

    NotificationManager notificationManager = (NotificationManager) context
            .getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notification = new Notification(<image>, title, System.currentTimeMillis());
    notification.flags = Notification.FLAG_ONGOING_EVENT;

    Intent notificationIntent = new Intent(context, Provider.class);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, notificationIntent, 0);

    notification.setLatestEventInfo(context, title, message, pendingIntent);
    notificationManager.notify(<notification id>, notification);
} 
```

# python - Python中的多元求根

> ID：14416404
> 
> 赞同：5
> 
> 时间：2013-01-19T16:35:32.633
> 
> 标签：python, scipy, solver

使用 excel 求解器，很容易找到这个方程的解（x 和 y 的最优值）：

> (x*14.80461) + (y * -4.9233) + (10*0.4803) ≈ 0

但是，我无法弄清楚如何在 Python 中执行此操作。现有的 scipy 优化库函数，如 fsolve() 或 leastsq() 似乎只适用于一个变量......（我可能只是不知道如何使用它们）......

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T16:45:46.347

```
>>> def f(x):
...     return x[0]*14.80461 + x[1]*(-4.9233) + x[2]*(10*0.4803) 
>>> def vf(x):
...    return [f(x), 0, 0]
>> xx = fsolve(vf, x0=[0,0,1])
>>> 
>>> f(xx)
8.8817841970012523e-16 
```

由于解不是唯一的，未知的不同初始值会导致不同的（有效）解。

编辑：为什么这有效。嗯，这是一个肮脏的黑客。就是这样`fsolve`，它的亲戚处理*方程*组。我在这里所做的，我为三个变量（具有三个元素）定义了一个由三个方程组成的系统（`f(x)`返回一个三元素列表）。`x`现在`fsolve`使用牛顿型算法收敛到一个解。

显然，系统是欠定义的：您可以指定两个变量的任意值，例如，`x[1]`并`x[2]`找到`x[0]`满足您拥有的唯一非平凡方程。您可以通过指定几个初始猜测来明确地看到这一点，`x0`并查看不同的输出，所有这些都满足`f(x)=0`一定的容差。

# c# - 未在 XAML 绑定上调用 ConvertBack

> ID：14416408
> 
> 赞同：0
> 
> 时间：2013-01-19T16:35:52.683
> 
> 标签：c#, wpf, xaml, binding, converter

我正在使用 DataGrid 来显示一些商店库存信息。每个项目都可以属于一种类型的库存。

相关实体 ('StockEntity') 具有以下属性：
'ItemId'、'ItemType'、'Grocery'、'Reading'、'Bathroom'。

此表中的几个示例行是：
27, 'Grocery', 'Apple', null, null, null
127, 'Reading', null, 'Reading lamp', null, null

我无法控制数据库/实体结构。

DataGrid 列是一个自定义列，其中包含（除其他外）一个文本框。DataGrid 绑定到 StockEntity 对象的 ObservableCollection。我想将 TextBox 的值绑定到相关属性。例如，如果 'ItemType' = 'Grocery'，则 TextBox 将显示 'Grocery' 属性。如果我更改文本框中的值，它应该被写回“Grocery”属性。

这是我到目前为止所拥有的：

XAML：

```
<TextBox Grid.Column="0" Padding="5" VerticalAlignment="Center" Width="155">
    <TextBox.Text>
        <Binding Path="."
            Converter="{StaticResource StockDataToTextConverter}"
            Mode="TwoWay"
            UpdateSourceTrigger="LostFocus">
        </Binding>
    </TextBox.Text>    
</TextBox> 
```

转换器很简单：

```
private StockEntity stock;

public object Convert(object value, Type targetType, object parameter, 
    CultureInfo culture)
{
    this.stock = value as StockEntity;
    string text="";

    if(this.stock!=null){
        text = StockModel.GetStockData(this.stock);
    }

    return text;
}

public object ConvertBack(object value, Type targetType, object parameter, 
    CultureInfo culture)
{           
    string info = value as string;

    if(info!=null && this.stock!=null){
        StockModel.SetStockData(ref this.stock, info);
    }

    return stock;
} 
```

StockModel.Get/SetStockData() 方法只需使用反射来获取/将信息放回正确的属性中。Convert() 方法工作正常：TextBox 显示正确的数据。如果我编辑 TextBox 中的值，它只会恢复为旧值。未调用 ConvertBack()。

我认为由于 Binding Path="." 而没有调用 ConvertBack() 方法，但我想不出另一种解决方法。我也不知道我是否可以按照我的方式在转换器中“保存”绑定对象。将 TextBox 的值写回同一实体对象至关重要，以保留实体的数据库连接属性！

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:53:41.330

我真正想要的是：

```
<Binding Path={Binding Path="ItemType"} /> 
```

这是不可能的！

解决方案是将 StockEntity 对象包装在我自己的类中，并公开一个“绑定属性”，它决定了要获取/设置的股票属性。我现在有一个 WrapperClass 对象的 ObservableCollection 来将 DataGrid 绑定到，而不是拥有 StockEntity 对象的集合。包装器看起来像：

```
public class WrapperClass{

    public WrapperClass(StockEntity se)
    {
        this._stock = se;
    }

    private StockEntity _stock;
    public stock {
        get { return _stock; }
        set { _stock = value; }
    }

    public string BindingProperty {
        get
        {
            // use reflection to return value
            return StockModel.GetStockData(this._stock);
        }

        set
        {
            // use reflection to set value
            StockModel.SetStockData(ref this._stock);
        }
    }
} 
```

XAML 很简单：

```
<Binding Path="StockWrapper.BindingProperty" /> 
```

# wordpress - 带有 AJAX 的 Wordpress 自定义元框输入值

> ID：14416409
> 
> 赞同：5
> 
> 时间：2013-01-19T16:36:06.223
> 
> 标签：wordpress, jquery, custom-post-type

我正在使用 Wordpress 3.5，我有一个带有元框和一些输入字段的自定义帖子 (sp_product)。这些输入之一（sp_title）。

我想通过在我的输入（sp_title）字段中输入自定义帖子标题名称进行搜索，当我按下添加按钮（也在我的自定义元框中）时，它将通过该标题名称找到该帖子并带来一些帖子元数据进入此元框并显示到其他字段中。

![在此处输入图像描述](../Images/58cb33880003da744cdd0c7cccc945b4.png)

在这张图片中（示例）

1.  搜索
2.  点击按钮
3.  通过 AJAX 从自定义帖子中获取一些价值。

请给我一个示例代码（很简单）

1.  我将搜索一个简单的自定义帖子标题，
2.  单击一个按钮
3.  通过 AJAX (jQuery-AJAX) 使用任何其他帖子元值获取该帖子的标题（我搜索或匹配）。

请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T20:31:07.360

我能够找到线索是因为我的一个插件使用了类似于重新附加图像的东西。
所以，相关的 Javascript 函数是`findPosts.open('action','find_posts')`.

它似乎没有很好的记录，我只能找到两篇关于它的文章：

*   [查找帖子对话框](http://shibashake.com/wordpress-theme/find-posts-dialog-box)
*   [在插件中使用内置的帖子查找器](http://kucrut.org/blog/2012/01/20/using-built-in-post-finder-in-plugins/)

尝试实现这两个代码示例，模式窗口打开但转储`-1`错误。那是因为 Ajax 调用没有传递`check_ajax_referer`函数中的[`wp_ajax_find_posts`](http://core.trac.wordpress.org/browser/tags/3.5/wp-admin/includes/ajax-actions.php#L1419)。

所以，下面的作品是基于第二篇文章的。但它有一个必须解决的安全漏洞，即`wp_nonce_field` **-->** `check_ajax_referer`。它在代码注释中指出。
要打开帖子选择器，请双击文本字段。
jQuery`Select`需要解决。

### 插件文件

```
add_action( 'load-post.php', 'enqueue_scripts_so_14416409' );
add_action( 'add_meta_boxes', 'add_custom_box_so_14416409' );
add_action( 'wp_ajax_find_posts', 'replace_default_ajax_so_14416409', 1 );

/* Scripts */
function enqueue_scripts_so_14416409() {
  # Enqueue scripts
  wp_enqueue_script( 'open-posts-scripts', plugins_url('open-posts.js', __FILE__), array('media', 'wp-ajax-response'), '0.1', true );

  # Add the finder dialog box
  add_action( 'admin_footer', 'find_posts_div', 99 );
}

/* Meta box create */
function add_custom_box_so_14416409() 
{
    add_meta_box( 
        'sectionid_so_14416409',
        __( 'Select a Post' ),
        'inner_custom_box_so_14416409',
        'post' 
    );
}

/* Meta box content */
function inner_custom_box_so_14416409( $post ) 
{
    ?>
    <form id="emc2pdc_form" method="post" action="">
        <?php wp_nonce_field( 'find-posts', '_ajax_nonce', false); ?> 
        <input type="text" name="kc-find-post" id="kc-find-post" class="kc-find-post">
    </form>
    <?php
}

/* Ajax replacement - Verbatim copy from wp_ajax_find_posts() */
function replace_default_ajax_so_14416409()
{
    global $wpdb;

    // SECURITY BREACH
    // check_ajax_referer( '_ajax_nonce' );

    $post_types = get_post_types( array( 'public' => true ), 'objects' );
    unset( $post_types['attachment'] );

    $s = stripslashes( $_POST['ps'] );
    $searchand = $search = '';
    $args = array(
        'post_type' => array_keys( $post_types ),
        'post_status' => 'any',
        'posts_per_page' => 50,
    );
    if ( '' !== $s )
        $args['s'] = $s;

    $posts = get_posts( $args );

    if ( ! $posts )
        wp_die( __('No items found.') );

    $html = '<table class="widefat" cellspacing="0"><thead><tr><th class="found-radio"><br /></th><th>'.__('Title').'</th><th class="no-break">'.__('Type').'</th><th class="no-break">'.__('Date').'</th><th class="no-break">'.__('Status').'</th></tr></thead><tbody>';
    foreach ( $posts as $post ) {
        $title = trim( $post->post_title ) ? $post->post_title : __( '(no title)' );

        switch ( $post->post_status ) {
            case 'publish' :
            case 'private' :
                $stat = __('Published');
                break;
            case 'future' :
                $stat = __('Scheduled');
                break;
            case 'pending' :
                $stat = __('Pending Review');
                break;
            case 'draft' :
                $stat = __('Draft');
                break;
        }

        if ( '0000-00-00 00:00:00' == $post->post_date ) {
            $time = '';
        } else {
            /* translators: date format in table columns, see http://php.net/date */
            $time = mysql2date(__('Y/m/d'), $post->post_date);
        }

        $html .= '<tr class="found-posts"><td class="found-radio"><input type="radio" id="found-'.$post->ID.'" name="found_post_id" value="' . esc_attr($post->ID) . '"></td>';
        $html .= '<td><label for="found-'.$post->ID.'">' . esc_html( $title ) . '</label></td><td class="no-break">' . esc_html( $post_types[$post->post_type]->labels->singular_name ) . '</td><td class="no-break">'.esc_html( $time ) . '</td><td class="no-break">' . esc_html( $stat ). ' </td></tr>' . "\n\n";
    }

    $html .= '</tbody></table>';

    $x = new WP_Ajax_Response();
    $x->add( array(
        'data' => $html
    ));
    $x->send();
} 
```

### Javascript 文件^(open-posts.js)

```
jQuery(document).ready(function($) {
  // Find posts
  var $findBox = $('#find-posts'),
      $found   = $('#find-posts-response'),
      $findBoxSubmit = $('#find-posts-submit');

  // Open
  $('input.kc-find-post').live('dblclick', function() {
    $findBox.data('kcTarget', $(this));
    findPosts.open();
  });

  // Insert
  $findBoxSubmit.click(function(e) {
    e.preventDefault();

    // Be nice!
    if ( !$findBox.data('kcTarget') )
      return;

    var $selected = $found.find('input:checked');
    if ( !$selected.length )
      return false;

    var $target = $findBox.data('kcTarget'),
        current = $target.val(),
        current = current === '' ? [] : current.split(','),
        newID   = $selected.val();

    if ( $.inArray(newID, current) < 0 ) {
      current.push(newID);
      $target.val( current.join(',') );
    }
  });

  // Double click on the radios
  $('input[name="found_post_id"]', $findBox).live('dblclick', function() {
    $findBoxSubmit.trigger('click');
  });

  // Close
  $( '#find-posts-close' ).click(function() {
    $findBox.removeData('kcTarget');
  });
}); 
```

# ios - 如何构建图形多维数组

> ID：14416412
> 
> 赞同：0
> 
> 时间：2013-01-19T16:36:17.083
> 
> 标签：ios, objective-c, xcode, multidimensional-array, uicollectionview

我想创建一个像这样的图形多维数组：

[涂鸦形象](http://imageshack.us/photo/my-images/843/img0837u.png/)

我看到了collection-view，但我从不使用它，所以我不知道它是否能有效地满足我的需求。也许图书馆存在？

创建这个的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:58:40.017

`UICollectionView`适合以类似网格的方式显示数据，所以我认为它很适合您的目的。唯一需要注意的是，它是在最新版本的 iOS（iOS 6）中引入的类。如果您希望您的应用程序也可以在早期版本的 iOS 上运行，您可能需要查看一些开源克隆`UICollectionView`，例如：[https ://github.com/steipete/PSTCollectionView](https://github.com/steipete/PSTCollectionView)

# c++ - 从 C++ 中的 HDF5 读取复合数据类型的字符串

> ID：14416416
> 
> 赞同：2
> 
> 时间：2013-01-19T16:36:26.543
> 
> 标签：c++, hdf5

我有一个 hdf5 复合数据集，它是用 Python 构建的，我试图从中读取。我有四列，其中一列是长度为 1 的字符串。我设法读取了除字符串列之外的所有内容。下面是我尝试仅读取字符串列的示例代码：

```
#include <string>
#include <iostream>
#include "H5Cpp.h"

typedef struct data_type {
    char string_column[1];
} data_type;

int main ( void )
{
    int NBR_OF_ROWS = 28884;
    H5::H5File file = H5::H5File(MY_FILE, H5F_ACC_RDONLY);
    H5::DataSet dataset = H5::DataSet(file.openDataSet(MY_DATASET));

    H5::CompType mtype(sizeof(data_type));
    mtype.insertMember("member", HOFFSET(data_type, string_column),
            H5::PredType::C_S1);
    data_type *data = new data_type[NBR_OF_ROWS];
    dataset.read(data, mtype);

    std::cout << "string column " << data[0].string_column << std::endl;

    return 0;
} 
```

这编译但什么也不打印:(我试图在堆上分配数据数组但无济于事。我在ubuntu上使用g++。

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T02:39:50.250

我认为您的问题来自您使用的字符串数据类型。你没有指定大小，你只是*说它是一个字符串*。

尝试制作[`H5::StrType`](http://www.hdfgroup.org/HDF5/doc/cpplus_RM/classH5_1_1StrType.html#502e6a4895bf51314204179e3f093a7f)长度为 1 的 a：

```
H5::StrType string_type(H5::PredType::C_S1, 1); 
```

然后在复合数据类型中使用它：

```
mtype.insertMember("member", HOFFSET(data_type, string_column), string_type); 
```

# perl - Perl Rar 一个完整的文件夹

> ID：14416436
> 
> 赞同：0
> 
> 时间：2013-01-19T16:39:58.350
> 
> 标签：perl, directory, rar

我想用 Perl 和[`Archive::Rar`](https://metacpan.org/module/Archive%3a%3aRar). 例如文件夹`/root/pictures`。

我只找到了一种 rar 单个文件的方法。

我试图找到文件夹中的所有文件并将它们 rar，但是我总是`/root/pictures`在 rar 存档中将整个路径粘贴到它们 ( ) 上。

我只想要`/pictures`文件夹及其内容。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T15:39:32.217

存档中存储的文件的文件夹结构将与您传递给该`Add`方法的文件名相同。（尽管您可以使用该`-excludepaths`选项在没有任何包含文件夹的情况下添加它们。）

如果您在将文件添加到存档之前`chdir`进入目录，并将所有文件指定为etc.，那么结果应该是您想要的。`\root``pictures\file1.jpg`

像这样的东西

```
use strict;
use warnings;

use Archive::Rar;

use autodie;

chdir '\root';

my $rar = Archive::Rar->new(-archive => 'pictures.rar');

$rar->Add(-files => [ glob 'pictures\*' ]); 
```

显然，如果您希望存档存储在其他位置，您可以添加 rar 文件名的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T18:12:35.057

首先，您必须从定义的目录中获取文件列表：

```
use File::Find;

my @content;
find( \&wanted, '/some/path');

sub wanted {
  push @content, $File::Find::name;
  return;
} 
```

之后你可以使用 Archive::Rar 来打包它。

```
use Archive::Rar;
my $rar = Archive::Rar->new();
$rar->Add(
       -size => $size_of_parts,
       -archive => $archive_filename,
       -files => \@content,
); 
```

# ios - 是否可以“链接”现有的 iPhone 和 iPad 应用程序版本以创建通用版本？AS3

> ID：14416437
> 
> 赞同：0
> 
> 时间：2013-01-19T16:40:03.557
> 
> 标签：ios, flash, actionscript

我已经使用 Flash 在 AS3 中创建并发布了一个应用程序。我现在想让它成为一个通用应用程序。我有两个 .fla 文件，其中包含完整的应用程序。我想知道的是，是否有一种方法可以简单地将两者联系在一起，而不是经历更长的过程。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:39:42.560

一种方法是将所有帧从 iPad 版本（加上帧上的代码和库文件）复制到 iPhone 版本，然后在项目的第一帧，获取设备信息（如屏幕高度、宽度 -我真的不知道有什么可能性），然后如果设备看起来是 iPad，则跳到 iPad 框架，或者如果它看起来是 iPhone，则直接转到 iPhone 框架。

* * *

一张小图说明清楚：

（框架：）

|1||2||3||4||5||6||7||8||9||10

```
^      
checking device(frame 1) 
```

|1||2||3||4||5||6||7||8||9||10

```
 ^      
  iPhone version(frame 2 till 6) 
```

|1||2||3||4||5||6||7||8||9||10

```
 ^      
          iPad version(frame 7 till 10) 
```

* * *

# ruby - 为什么我的方法会返回我所有的数组？

> ID：14416438
> 
> 赞同：0
> 
> 时间：2013-01-19T16:40:04.297
> 
> 标签：ruby, hash, methods, multidimensional-array

我正在编写一个选择你自己的冒险风格的程序。我正在创建三个问题数组`q1`——`q3`每个都有一个数组、另一个数组和一个散列。目标是用我的`question_charge`方法遍历数组，然后根据用户的回答返回下一个问题数组应该是什么。

```
puts "Please choose an answer to the following questions"

q1 = [["What is your answer to this very first question?"],["A - Option 1","B - Option 2","C - Option 3"],{"A" => q2,"B" => q3, "C" => q3}]
q2 = [["This is the second question, can I have an answer?"],["A - Option 2-1","B - Option 2-2","C - Option 2-3"],{"A" => q3,"B" => q3,"C" => q4}]
q3 = [["Question #3! What is your answer?"],["A - Option 3-1","B - Option 3-2","C - Option 3-3"]]

current_question = q1
def question_charge(current_question)
  x = 0
  puts current_question[x]
  x += 1
  puts current_question[x]
  answer = gets.chomp
  puts "You answered " + answer
  x += 1
  current_question = current_question[x][answer]
end

question_charge(current_question) 
```

有时当我运行它时，我会收到以下错误：

```
(eval):2: undefined local variable or method `q2' for main:Object (NameError) 
```

当它起作用时，`q3`数组中没有最后一个问题中的哈希值。当我回答`'A'`第一个问题时，它会多次返回我的所有数组。如果我回答`'C'`，`q3`它返回就好了。谁能告诉我如何返回我想要的唯一数组而不会收到错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:47:20.563

当您定义第一个问题时，您的哈希值如下：

```
{"A" => q2,"B" => q3, "C" => q3} 
```

但在这一点上，既没有`q2`或也没有`q3`被定义。您需要在引用它们之前定义`q2`和。`q3`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:48:55.737

我会尝试重写你的方法以使其更有意义

```
def ask_question(current_question)
  question, options, next_question_hash = current_question

  puts question # "What is your answer to this very first question?"
  puts options  # "A - Option 1", ...

  answer = gets.chomp

  puts "You answer #{answer}"

  next_question = next_question_hash[answer]
end 
```

这会提出一个问题，然后返回下一个要回答的问题。

# mysql - 优化连接的 MySQL 查询

> ID：14416441
> 
> 赞同：0
> 
> 时间：2013-01-19T16:40:15.560
> 
> 标签：mysql, query-optimization

有一个查询这两天一直在困扰我，它曾经工作得很好，但现在它减慢了整个集群环境，查询如下所示：

```
SELECT  userUploads.*,
        users_avatar.avatar AS avatar
FROM    userUploads
        LEFT JOIN users_avatar
            ON userUploads.udid = users_avatar.udid
        INNER JOIN user_subscription
            ON (
                    user_subscription.sub_1 = 'G:123456789'
                    AND user_subscription.sub_2 = userUploads.udid
                )
WHERE   userUploads.platform = 'Private'
        AND userUploads.STATUS IN  ( 'featured', 'approved' )
ORDER   BY userUploads.id DESC 
LIMIT 50 OFFSET 0 
```

如果有人可以帮助解决此查询，我将不胜感激。

以下是查询的解释：

```
+----+-------------+-------------------+--------+----------------------+----------+---------+------------------------+------+-----------------------------+
| id | select_type | table             | type   | possible_keys        | key      | key_len | ref                    | rows | Extra                       |
+----+-------------+-------------------+--------+----------------------+----------+---------+------------------------+------+-----------------------------+
|  1 | SIMPLE      | userUploads       | range  | platform,udid,status | platform | 154     | NULL                   |   12 | Using where; Using filesort |
|  1 | SIMPLE      | users_avatar      | eq_ref | PRIMARY              | PRIMARY  | 182     | Seeds.userUploads.udid |    1 |                             |
|  1 | SIMPLE      | user_subscription | ref    | sub_1,sub_2          | sub_1    | 93      | const                  |    7 | Using where                 |
+----+-------------+-------------------+--------+----------------------+----------+---------+------------------------+------+-----------------------------+ 
```

提前致谢

编辑**显示创建表可以在下面看到

下面是表格的展示创建表格，希望您对 dancrumb 有任何想法。

```
| users_avatar | CREATE TABLE `users_avatar` (
`udid` varchar(60) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
`avatar` varchar(448) COLLATE utf8_unicode_ci DEFAULT NULL,
PRIMARY KEY (`udid`)
) ENGINE=ndbcluster DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci |

| userUploads | CREATE TABLE `userUploads` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`bdaha` varchar(100) COLLATE utf8_unicode_ci DEFAULT NULL,
`user` varchar(60) COLLATE utf8_unicode_ci DEFAULT NULL,
`direktoren` text COLLATE utf8_unicode_ci,
`filnamnet` varchar(180) COLLATE utf8_unicode_ci DEFAULT NULL,
`karhes` varchar(150) COLLATE utf8_unicode_ci DEFAULT NULL,
`version` char(10) COLLATE utf8_unicode_ci DEFAULT NULL,
`rostat` int(10) DEFAULT NULL,
`stars` int(11) DEFAULT NULL,
`statyn` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`platform` char(30) COLLATE utf8_unicode_ci DEFAULT NULL,
`images` int(2) DEFAULT NULL,
`date` char(10) COLLATE utf8_unicode_ci DEFAULT NULL,
`udid` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL,
`favorirepris` int(8) DEFAULT NULL,
`hikes` char(4) COLLATE utf8_unicode_ci DEFAULT 'no',
`dbn` char(6) COLLATE utf8_unicode_ci DEFAULT NULL,
`timestamp` char(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`comments` int(5) DEFAULT NULL,
`klistret` enum('no','yes') COLLATE utf8_unicode_ci NOT NULL DEFAULT 'no',
PRIMARY KEY (`id`),
KEY `platform` (`platform`,`status`),
KEY `udid` (`udid`),
KEY `hikes` (`hikes`),
KEY `bdaha` (`bdaha`),
KEY `statyn` (`statyn`),
KEY `version` (`version`)
) ENGINE=ndbcluster AUTO_INCREMENT=118831 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci |

| user_subscription | CREATE TABLE `user_subscription` (
`id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`sub_1` varchar(30) COLLATE utf8_unicode_ci DEFAULT NULL,
`sub_2` varchar(30) COLLATE utf8_unicode_ci DEFAULT NULL,
PRIMARY KEY (`id`),
KEY `sub_1` (`sub_1`),
KEY `sub_2` (`sub_2`)
) ENGINE=ndbcluster AUTO_INCREMENT=155184 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:51:42.510

好吧，您在 userUploads 上有一个文件排序，它总是很慢。您可能想使用索引来删除它。例如，您可能希望从 udid、平台和状态的索引开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:05:59.843

通常，在查询时，您希望首先返回的数据执行最有限的操作，以便仅对实际在结果中的数据执行其他操作。

在这种情况下，尝试将内连接重新排序到 user_subscription，将左连接重新排序到 users_avatar。这样，如果用户实际上在结果集中，它只会尝试获取用户的头像，而不是首先查找所有头像，然后根据连接和 where 子句进行过滤。

```
SELECT  userUploads.*,
    users_avatar.avatar AS avatar
FROM    userUploads
INNER JOIN user_subscription
            ON (
                    user_subscription.sub_1 = 'G:123456789'
                    AND user_subscription.sub_2 = userUploads.udid
                )
LEFT JOIN users_avatar
            ON userUploads.udid = users_avatar.udid

WHERE   userUploads.platform = 'Private'
        AND userUploads.STATUS IN  ( 'featured', 'approved' )
ORDER   BY userUploads.id DESC 
LIMIT 50 OFFSET 0 
```

# php - 在 AJAX 请求之前使用 JavaScript 获取日期

> ID：14416443
> 
> 赞同：-2
> 
> 时间：2013-01-19T16:40:31.267
> 
> 标签：php, javascript, jquery, ajax

我有这个 AJAX 请求：

```
function request(str){
    <script>      
    var aircraft = $("#div");
        aircraft.load("./file.php?icao="+str, function(){
        });
    }
<script>
<div id="div"><div> 
```

当我执行此选项时。对file.php的请求

```
<script>
    $(function() {
        $("#submit")
            .button()
            .click(function form() {
        });
    });

    function form(){

        var id = document.getElementById('id').value;
                $("div2").text(id);
    }
</script>
<div id="div2"><div>
<tr><td class="forms">ID:</td><td><input maxlength="4" type="text" id="id" name="icao" size="30"/></td></tr>

<tr><td><input id="submit" type="submit" value="Submit"></td></tr> 
```

当我按下按钮时，没有结果。var id 的值未定义。问题出在函数请求中。因为如果我直接不使用该功能，一切正常。我认为是 AJAX 和 Javascript 之后的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:43:16.990

尝试这个：

```
function form() {
    var id = document.getElementById('id').value;
    $("div2").text(id);
}

$(function() {
    $("#submit").click(function() {
      form();
    });
}); 
```

在 jQuery 事件中嵌入函数调用的语法不正确。如果要在 jQuery 函数中执行另一个函数，则必须执行上述操作，而不是`.click(function form() {});`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:53:44.843

我认为这段代码被破坏了：

```
<script>
    $(function() {
        $("#submit")
            .button()
            .click(function form() {
        });
    });

    function form(){

        var id = document.getElementById('id').value;
                $("div2").text(id);
    }
</script> 
```

不确定这是否会完全解决它，但我认为这是正确的语法：

```
<script>
    $(function() {
        $("#submit")
            .button()
            .click(function() {
                 form();
        });
    });

    function form(){

        var id = document.getElementById('id').value;
                $("div2").text(id);
    }
</script> 
```

我认为这不会解决您的问题，但是您使用的语法格式不正确。我认为不要像这样调用函数：

```
form(); 
```

您可能还对查看 .trigger() 或 .call() 感兴趣，我还查看了 jquery 文档，但从未见过 .button()，那是为了什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:42:55.130

我可能错了，但`<script>`标签不应该在函数之前吗？

```
<script>    
function request(str){    
    var aircraft = $("#div");
        aircraft.load("./file.php?icao="+str, function(){
        });
}
<script> 
```

# c++ - lua不做字符串

> ID：14416448
> 
> 赞同：0
> 
> 时间：2013-01-19T16:41:20.483
> 
> 标签：c++, lua

我试图让 lua 5.1 执行一行，这只是对我的一个 c++ 函数的调用`"Assail"`我不明白为什么它不起作用，有人能指出错误吗？

这是攻击功能：

```
static int Assail(lua_State *L)
{
    cout << "test" << endl;
    return 1;
} 
```

我试图这样打电话`do_string`：

```
L = lua_open();
luaL_openlibs(L);
lua_register(L, "Assail", Assail);
luaL_dostring(L, "s = Assail()");   
lua_close(L); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:48:31.740

由于您是用 C++ 编写的，因此对函数应用了名称修饰，因此它在最终的可执行文件/库中将具有与 Lua 期望的不同的特殊名称。`extern`您可以通过使用关键字更改其与 C 的链接来解决此问题：

```
extern "C" int Assail(lua_State *L);

extern "C" int Assail(lua_State *L)
{
    // code here
} 
```

# php - Symfony 自动加载结构

> ID：14416452
> 
> 赞同：0
> 
> 时间：2013-01-19T16:41:55.807
> 
> 标签：php, symfony

晚上好！

我在使用自动加载器访问 symfony2.1.6 中的自定义类时遇到了一点问题。我需要做的是从 DefaultController 中访问 Mangress/src/Qkprod/Classes/api/APIEntry.php 类。显然我太愚蠢了，无法找到一种方法来扩展 autoload.php 来做到这一点。现在，我已经阅读了如此多的博客文章和解决方案，以至于我不再知道该做什么了……

我的文件结构如下所示：

```
芒果
 -应用程序
 -src
    -Qkprod
      -MangressBundle
      -控制器、实体、资源、测试
      -课程
         -api
            -APIEntry.php
         -D b
         -安全
    -QkprodMangressBundle.php
 -小贩
 -网络

```

Classes 文件夹包含我迄今为止编写的所有类。

到目前为止我读到的是我需要注册类的命名空间以加载到**Mangress/app/autoload.php**
[在 Symfony 2.1 中自动加载一个类](https://stackoverflow.com/questions/12045554/autoloading-a-class-in-symfony-2-1)

> $loader->add('Qkprod\MangressBundle\api', **DIR** .'/../src/Qkprod/MangressBundle/Classes/api/'); 虽然这似乎是错误的..

我对 symfony 的命名或理解有问题吗？我将命名空间**“Qkprod\MangressBundle\api”**注册到自动加载器，这样 symfony 就知道什么时候该去哪里看

> 使用 Qkprod\MangressBundle\api\APIEntry；

所以它必须查看我的**Mangress/src/Qkprod/MangressBundle/Classes/api** 文件夹我错了吗？

我真的很感激一些指导:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:10:39.157

为什么不使用symfony 开发者推荐的[目录结构？](http://symfony.com/doc/2.0/cookbook/bundles/best_practices.html)

甚至不仅仅是 symfony 开发人员，这种结构称为[PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)，并且被许多 PHP 框架采用。

如果您遵守约定，默认的自动加载器将很好地加载您的类，其他开发人员将更容易理解您的代码。

只需删除您的“类”目录，并将其中的所有内容向上移动：

```
Mangress
 -app
 -src
    -Qkprod
      -MangressBundle
        -Controller, Entity, Resources, Tests
        -Api
          -APIEntry.php
        -Db
         -security
        -QkprodMangressBundle.php
 -vendor
 -web 
```

这样写的时候

```
use Qkprod\MangressBundle\Api\APIEntry 
```

它会知道去哪里看。

# android - 可点击的折线 Google Maps API Android

> ID：14416457
> 
> 赞同：6
> 
> 时间：2013-01-19T16:42:13.757
> 
> 标签：android, google-maps

我想点击谷歌地图 v2 安卓地图上的一个点。如果单击的点与折线路径上的某个点相交，则显示该折线。我没有看到任何记录在案的 android 中折线的可点击事件。我试图扩展当前的折线对象（标记为最终）

我还有什么其他选择？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-11-26T23:00:19.873

您可以使用库： [https ://github.com/googlemaps/android-maps-utils](https://github.com/googlemaps/android-maps-utils)

并使用下一个方法（在 OnMapClickListener 中）检测对折线的点击：

```
 PolyUtil.isLocationOnPath(point, polyline.getPoints(), isGeodesic, tolerance); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-01-27T10:59:33.303

随着**地图 API 的最新更新，v8.4 引入了可点击** `Polyline`

如[文档](https://developers.google.com/maps/documentation/android-api/shapes#polyline_events)中所述：

> 使用`OnPolylineClickListener`监听可点击折线上的点击事件。要在地图上设置此侦听器，请调用 `googleMap.setOnPolylineClickListener(...)`。当用户点击折线时，您将收到 `onPolylineClick(Polyline)`回调。

**梯度依赖：**

```
compile 'com.google.android.gms:play-services-maps:8.4.0' 
```

**实现回调**：`GoogleMap.OnPolylineClickListener`

**初始化折线：**

```
Polyline polyline = googleMap.addPolyline(options);
polyline.setClickable(true);
... 
```

**接收事件**

```
@Override
public void onPolylineClick(Polyline polyline) {
     ....
} 
```

快乐编码:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T16:44:42.933

注册[一个`OnMapClickListener`](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/GoogleMap.OnMapClickListener). 自己确定给定的点击是否在您的线路上。如果是，请在这种情况下做任何你想做的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-04T14:41:20.063

我有一个类似的问题，我无法处理折线上的点击事件。我使用的是 Xamarin for Android，它是 C#，但在这种情况下，功能与 Android Java 库基本相同。

最后，我最终做了似乎是唯一的选择。

这涉及处理我的折线的所有中点（其中大约有 1300 个）。每一次`OnMapClick`，我都采用`LatLng`了点击事件，并在它与静态中所有折线的中点之间执行了一个距离公式`List<PolylineOptions>`。然后我将地图标记附加到最近的折线。

从多段线上点击，它会在大约四分之一秒内弹出一个标记。

我想 Google Maps API 中实现的标记点击事件以类似的方式工作。

这是处理查找最接近点击点的 for 循环。

```
int i = 0;//create an indexer for the loop
double shortestDist = 100;//set an initial very large dist just to be safe
int myIndex = 0;//set variable that will store the running index of the closest point
foreach (PolylineOptions po in myPolylines) {
    var thisDist = Distance (point, midPoint (po.Points [0].Latitude, po.Points [0].Longitude, po.Points [1].Latitude, po.Points [1].Longitude));//calculate distance between point and midpoint of polyline
    if (thisDist < shortestDist) {
        shortestDist = thisDist;//remember current shortest distance
        myIndex = i;//set closest polyline index to current loop iteration
    }
    i++;
} 
```

我知道这不是最漂亮的代码，但它可以完成工作。我在互联网上的任何地方都没有看到真正的答案，所以就在这里。通过预先计算中点并将它们存储在一个大小相等的列表中，然后不必在每次地图点击时调用每条折线的中点公式，它可能会变得更高效，但它已经非常快速地工作了。

编辑

顺便说一句，我在 Galaxy s3 上进行了测试，所以我认为它并不太低效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-21T09:30:38.317

如果您正在使用，`com.google.android.gms:play-services-maps:8.4.0`则它包括折线单击侦听器

```
googleMap.setOnPolylineClickListener(new GoogleMap.OnPolylineClickListener() 
{
         @Override
         public void onPolylineClick(Polyline polyline)
         {
                  //do your work selected polyline
         }
});

PolylineOptions line = new PolylineOptions();
Polyline polyline = googleMap.addPolyline(line);
polyline.setClickable(true); 
```

# 2d - three.js 带有渐变的天穹

> ID：14416458
> 
> 赞同：2
> 
> 时间：2013-01-19T16:42:19.047
> 
> 标签：2d, three.js, gradient

我想添加一个具有 2d 渐变的球体作为纹理来创建天穹。我读到在openGL中，这通常通过在附加通道中渲染没有深度测试的天空盒来解决。我在我的球体上禁用了 depthTest ，所以其他所有东西都绘制在它前面，这有点给了我不想要的效果，但取决于它穿过场景中其他对象的相机角度。

我正在查看几个使用 THREE.EffectComposer 和第二个场景的示例，我可能完全是在寻找错误的东西，但我认为这可以解决这个问题。问题是我从未接触过 effectComposer 并且完全不知道如何使用它以及我究竟需要哪些东西。

我会对此提出任何意见，也许我根本就在追求错误的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T17:36:53.370

下面是两个 three.js 示例，其中创建了带有渐变的天穹。它们不涉及`EffectComposer`或禁用深度测试。

[http://mrdoob.github.com/three.js/examples/webgl_lights_hemisphere.html](http://mrdoob.github.com/three.js/examples/webgl_lights_hemisphere.html)

[http://mrdoob.github.com/three.js/examples/webgl_materials_lightmap.html](http://mrdoob.github.com/three.js/examples/webgl_materials_lightmap.html)

三.js r.55

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T03:44:16.047

您不必使用圆锥或其他 3D 几何图形来模拟渐变天空。我使用画布（具有 3 个渐变点，浅蓝色 -> 白色（水平） -> 深蓝色）解决了它，并将其绘制为我的相机前的精灵，与它的距离合适（雾距离）。您只需在移动/旋转凸轮时管理距离。提示：使用 mesh.scale.set (xx,xx,1) 将画布纹理缩放到所需大小。

# dynamic - 在 LUA（LÖVE 引擎）中使用变量命名表？

> ID：14416464
> 
> 赞同：1
> 
> 时间：2013-01-19T16:43:12.030
> 
> 标签：dynamic, lua, naming, lua-table

基本上：

*   我正在 LÖVE 引擎中制作游戏，您可以在其中单击以创建块
*   每次单击时，鼠标 X 和鼠标 Y 上都会创建一个块
*   但是，我只能让一个块出现，因为我必须将该块（或表）命名为“object1”

有什么方法可以创建一个又一个表并增加值？（如 object1{}、object2{}、object3{} 等……但在主表中，'created_objects'）

但只有当点击时，我想排除循环部分（但如果不是请告诉我）

到目前为止，这是我的代码，但无法编译。

```
function object_create(x, y, id) **--Agruments telling the function where the box should spawn and what the ID of the box is (variable 'obj_count' which increases every time a box is spawned)**

currobj = "obj" .. id **--Gives my currently created object a name**

crob.[currobj] = {} **--Is supposed to create a table for the current object, which holds all of its properties. **

crob.[currobj].body = love.physics.newBody(world, x, y, "dynamic")
crob.[currobj].shape = love.physics.newRectangleShape(30, 30) 
crob.[currobj].fixture = love.physics.newFixture(crob.[currobj].body, crob.[currobj].shape, 1)     **--The properties**
crob.[currobj].fixture:setRestitution(0.3) 
```

但是我应该用什么替换 [currobj]？

* * *

### 解决了

找到了我要找的东西。如果人们想知道，这是代码：

function block_create(x, y, id) --（鼠标x和y，以及增加的变量）

```
blocks[id] = {}
blocks[id][1] = love.physics.newBody(world, x, y, "dynamic")
blocks[id][2] = love.physics.newRectangleShape(45, 45)
blocks[id][3] = love.physics.newFixture(blocks[id][1], blocks[id][2])
blocks[id][3]:setRestitution(0.2)
blocks[id][4] = math.random(0, 255) --The Color
blocks[id][5] = math.random(0, 255)
blocks[id][6] = math.random(0, 255)

blockcount = blockcount + 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:05:29.210

我可能会做这样的事情。

```
local blocks = {} -- equivalent of your crob table

function create_block(x, y)
    local block = funcToCreateBlock() -- whatever code to create the block
    table.insert(blocks, block)
    return block
end 
```

如果您想获得对刚刚使用该函数创建的块的引用，只需捕获它即可。

```
-- gives you the new block, automatically adds it to the list of created blocks
local new_block = create_block(0, 10) 
```

将块对象粘贴到块表中，并自动为每个对象在表中分配一个数字索引。因此，如果您为 3 次不同的鼠标点击调用了 3 次 create_block()，`blocks`表格将如下所示：

```
blocks = {
    [1] = blockobj1,
    [2] = blockobj2,
    [3] = blockobj3
} 
```

您可以通过执行从块表中获取第二个块 obj

```
local block2 = blocks[2] 
```

`pairs`或者您可以使用或循环遍历表中的所有块`ipairs`

```
for idx, block in pairs(blocks) do
     -- do something with each block
end 
```

抱歉，如果这不能完全回答您的问题。但是从您所写的内容来看，您似乎没有真正的理由需要将块命名为 crob 表中的任何特定内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T15:29:19.393

如果您希望这些表是全局的，那么您可以执行以下操作：

```
sNameOfTable = "NAME"
_G[sNameOfTable] = {1,2} 
```

然后您将有一个表变量，如此[处](http://codepad.org/GMNDeM3S)`NAME`所示（键盘）。

否则，如果您希望它成为其他桌子的孩子，那么这样的事情也可以：

```
tTbl = {}
for i = 1, 20 do
  local sName = string.format( "NAME%02d", i )
  tTbl[sName] = {1,2}
end
for i, v in pairs(tTbl) do
  print( i, v )
end 
```

不要担心[这里的未排序输出](http://codepad.org/YL4QzKN1)（键盘）。带有索引的 Lua 表无需排序即可使用。

# javascript - 如何在 Adob e Acrobat 中使用 JavaScript 保存文档？

> ID：14416465
> 
> 赞同：0
> 
> 时间：2013-01-19T16:43:16.347
> 
> 标签：javascript, adobe, acrobat

基本上我想要完成的是当文档被打印时，它将保存在特定位置，文本字段中的文本。

我怎样才能做到这一点？我所看到的基本上会替换文档，而不是每次打印时都创建一个新文档。

# php - 如何记录使用 ssh 完成的活动

> ID：14416471
> 
> 赞同：0
> 
> 时间：2013-01-19T16:44:04.443
> 
> 标签：php, linux, bash, shell

> **可能重复：**
> [在 linux 中监视文件系统更改的最佳方法](https://stackoverflow.com/questions/8381566/best-way-to-monitor-file-system-changes-in-linux)

我需要你的帮助。如何在 linux 服务器上记录使用 SSH 完成的活动 - 诸如创建文件或目录、删除文件或目录、重命名特定路径的文件或目录等活动。我需要任何 bash、python 或 php 脚本的解决方案，或者如果 linux 中有任何选项，我可以使用它来查看在特定路径或文件夹上完成的所有活动。我需要使用这些日志进行同步。

好的，让我向您解释整个场景。我正在开发同步工具，我们使用 Samba 共享所有文件和文件夹，我需要通过网络同步这些文件。我使用 grep samba 日志来观察客户端完成的活动，例如创建文件或文件夹、删除文件和文件夹以及重命名文件或文件夹我将这些日志用于我的同步工具及其工作正常。但是我只在使用 samba 完成更改时才获取日志 - 如果更改是使用 SSH 完成的，那么这些活动不会被记录并且不会被同步。所以我需要 grep 记录使用 SSH 对特定路径所做的更改（例如：/mnt/test） - 在测试文件夹中所做的更改，如创建删除和重命名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:45:47.550

据我了解，这里发生的事情是这样的。

有一个 Samba 服务器可以导出具有多个用户的文件系统和一组可以直接访问文件系统的用户（他们通过 SSH 登录）。并且这个文件系统需要被复制到另一个位置。

TS 正在开发一种工具来执行复制。

这里至少有两个选项。

1.  更传统的方法是`rsync`定期在两个位置之间运行。因此，副本并不总是一致的，但它很容易并且系统是分区容错且可用的。也就是这个方法从“CAP”定理中选择“A”和“P”。

2.  受类似 Dropbox 的云存储和即时复制的流行启发的另一种方法是观察文件系统。这可以用`inotify`or来完成`fam`。

    的接口`inotify`可用于大多数脚本语言，包括 Perl、Python 和 PHP。这以一致性换取可用性。也就是说，在复制一个大文件之前，它在另一端将无法访问。

    的接口以`FAM`PHP 和可能的其他语言提供。有关不同文件系统监控 API 的讨论，请参阅[链接问题](https://stackoverflow.com/q/8381566/1328439)。

第一个选项本质上是单线。第二个选项也不应该太难（以 Dropbox 守护程序源为例）。

**注意：**复制是 Serverfault.com 上反复出现的主题。

# assembly - 在 x86 机器上减去“x”和添加“-x”有什么区别？

> ID：14416472
> 
> 赞同：9
> 
> 时间：2013-01-19T16:44:13.010
> 
> 标签：assembly, compiler-construction, x86

有任何语义差异吗？在特定情况下，其中之一可能会更快吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-19T16:56:12.863

如果您已经`-x`预先计算，那么`sub smth, x`将`add smth, -x`同样快速地执行。

从语义上讲，船旗状态会有所不同。

考虑做 8 位加减法：

```
0x01 - 0x01 = 0x00, CF = 0
0x01 + 0xFF = 0x00, CF = 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T17:10:17.250

除了标志不同之外，如果`x`是一个常数，选择一个或另一个可能会导致更短的编码（很少）。

加法和减法都有一种`op r/m32, imm8`形式，其中立即操作数是一个字节，但该字节是符号扩展的。所以`add edx, 128`必须用 dword 立即`sub edx, -128`数编码，但可以用符号扩展字节编码（节省 3 个字节）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T17:02:44.243

正如 Alexey Frunze 所指出的，船旗国有所不同。此外，可能的可表示值的数量存在差异。在[二进制补](http://en.wikipedia.org/wiki/Two%27s_complement)码系统中，负值比正值多一个。添加一个负数可以让您利用这一点，减去一个正数则不会。

编辑：

根本问题是我们通常认为的“整数”实际上并不是整数。在数学术语中，它们是商环的成员，[商环](http://en.wikipedia.org/wiki/Quotient_ring)是抽象代数中的一个概念。这意味着对于每个 32 位“整数” `a`，还有另一个 32 位“整数” `b`，例如`a + b = 0`. 这些数字被视为“正面”还是“负面”只是一种解释。这意味着我的观点既正确又不正确。就商环而言，它是不正确的，但就我们通常的解释而言，它是正确的。一定有一些数字我们可以减去并得到与添加 -2147483248 相同的结果。然而，这个数字不是 2147483248，这似乎违反直觉。

# magento-1.7 - Magento 更改产品页面布局（catalog.xml 不起作用）

> ID：14416473
> 
> 赞同：1
> 
> 时间：2013-01-19T16:44:16.927
> 
> 标签：magento-1.7

据我所知，我们只能手动完成，必须编辑“`“catalog.xml” file here: app > design > frontend > default > myskin > layout > catalog.xml.`搜索产品视图”并更改代码：

```
<reference name="root">
<action method="setTemplate"><template>page/2columns-right.phtml</template></action>
</reference> 
```

我已经在那里设置了 2columns-right.phtml ，但它仍然在使用 2columns-left.phtml ！

谁知道我怎么能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T06:09:23.603

可能你需要在这里更改catalog.xml，

```
Open up app > design > frontend > default > deault > layout > catalog.xml 
```

检查那里分配了哪个模板？如果不是“2columns-right.phtml”，请更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T08:13:31.287

我得到了~

我忘记为 Apply To Products 设置 NO ~

![在此处输入图像描述](../Images/d8cd16753798461c38a6e34944d5ac16.png)

# python - 如何获取谷歌文档资源的父文件夹？

> ID：14416475
> 
> 赞同：0
> 
> 时间：2013-01-19T16:44:30.230
> 
> 标签：python, gdata, google-docs-api, gdata-api

在我的 Goggle App Engine 应用程序中使用 Python gdata 我试图复制一个谷歌文档资源并将副本放在与源文件相同的文件夹中。我使用的`CopyResource`方法将副本放在根级别。

您知道如何查询 Google Docs 以获取文件所在的文件夹/集合列表吗？

```
import gdata.docs.service
import gdata.docs.client
...

doc_service = gdata.docs.client.DocsClient() 
doc_service.ClientLogin('username', 'abc123', 'my app name')

try:
   doc = doc_service.GetResourceById(resourceId)
   newdoc = doc_service.CopyResource(doc, filename)

   # newdoc is copied at the root level of Google Drive
   # need to move it where the source file is located. 

   newdocid = newdoc.id.text.decode('utf-8').split('%3A')[1]

   # would like here to have my newly copied document
   # moved to the same directory as the source one.
   # assuming the source is only in one folder.

except gdata.client.RequestError, inst:
   logging.info('Copy Error: %s', inst.body) 
```

# qt - qt 序列化 qlist 的指针

> ID：14416476
> 
> 赞同：1
> 
> 时间：2013-01-19T16:44:33.350
> 
> 标签：qt, pointers, serialization, qlist

我正在实施一个游戏。我有一张地图，分为描述地形图的单元格。每个单元都应该是类地形的一个实例。我需要序列化这张地图，并且文件必须尽可能小，因为它将通过互联网在玩家之间同步（如果可能的话，几 Mb）。但是，如果我以这种方式创建地图（大小为 4500x3000 单元格），则文件为数百 Mb。所以我必须使用指针，因为大部分地形都是一样的；可能我会有大约 30 种不同的地形。我有这个poitners Qlist，问题是出来的文件和我创建所有元素一样大，我不明白为什么。这是我的代码，可能有一些大错误。

```

`map.hpp

 #ifndef MAP_HPP
 #define MAP_HPP

 #include "include.hpp"
 #include "terrain.hpp"

class map
{
public:
    map();
    map(unsigned int width, unsigned int height);
    QList<terrain*> get_grid();
    void let_snow(unsigned int x, unsigned int y);
    void display_snow_map();
    void save();
    void load();

private:
    QList<terrain*> grid_;
    unsigned int width_;
    unsigned int height_;
};

----------------------------------
map.cpp

 #include "map.hpp"

map::map() {}

map::map(unsigned int width, unsigned int height) {
    width_=width;
    height_=height;
    for(unsigned int i=0; i<height; i++) {
        for(unsigned int j=0; j<width; j++) {
            grid_.append(new terrain(1,0,j,i));
        } 
    }
}

void map::save() {
    QFile save_file("map.brt");
    save_file.open(QIODevice::WriteOnly);
    QDataStream out(&save_file);
    out << grid_ << width_ << height_;
    save_file.close();
}

void map::load() {
    QFile load_file("map.brt");
    load_file.open(QIODevice::ReadOnly);
    QDataStream in(&load_file);
    in >> grid_ >> width_ >> height_;
    load_file.close();
}

----------------------------
terrain.hpp

 #ifndef TERRAIN_HPP
 #define TERRAIN_HPP

 #include "include.hpp"

class terrain
{
public:
    terrain();
    terrain(qint8 type, qint8 snow, qint16 x, qint16 y);
    qint8 get_type();
    qint8 get_snow();
    qint16 get_xcoord();
    qint16 get_ycoord();
    void set_snow(qint8 snow);
    void set_xcoord(qint16 x);
    void set_ycoord(qint16 y);
    void save(QDataStream &out);
    void load();
    friend QDataStream &operator <<(QDataStream &out, const terrain &ter);
    friend QDataStream &operator >>(QDataStream &in, terrain &ter);
    friend QDataStream &operator <<(QDataStream &out, const terrain *ter);
    friend QDataStream &operator >>(QDataStream &in, terrain *ter);

private:
    qint8 type_;
    qint8 snow_;
    qint16 xcoord_;
    qint16 ycoord_;

};

 #endif // TERRAIN_HPP

-----------------------------------------
terrain.cpp

    QDataStream &operator <<(QDataStream &out, const terrain &ter) {
    out << ter.xcoord_ << ter.ycoord_ << ter.type_ << ter.snow_;
    return out;
}

QDataStream &operator >>(QDataStream &in, terrain &ter) {
    in >> ter.xcoord_ >> ter.ycoord_ >> ter.type_ >> ter.snow_;
    return in;
}

QDataStream &operator <<(QDataStream &out, const terrain *ter) {
    out << ter->xcoord_ << ter->ycoord_ << ter->type_ << ter->snow_;
    return out;
}

QDataStream &operator >>(QDataStream &in, terrain *ter) {
    in >> ter->xcoord_ >> ter->ycoord_ >> ter->type_ >> ter->snow_;
    return in;
}` 

谢谢

            回答 #1

赞同：0

时间：2013-03-02T20:17:56.383

你的程序完全按照**你说**的做，但**不是你想要**的。您必须了解什么是 C++ 中的指针（在这里您可以阅读[指针 - C++ 文档](http://www.cplusplus.com/doc/tutorial/pointers/)）。

在您的代码中，您确实将所有单元格转储到文件中。

如果要最小化文件大小，则必须考虑网格的结构。如果您说在平均地图中您将拥有近 30 个地形，那么可能是，没有必要保存大量数据，而是使用一些命名系统（为您的地形使用名称），使用另一种数据结构（例如例子[`QMap`](http://qt-project.org/doc/qt-4.8/qmap.html)）。

希望，你会明白我的想法！祝你好运！

```

# javascript - 更改元素的属性值后jquery函数不起作用

> ID：14416479
> 
> 赞同：0
> 
> 时间：2013-01-19T16:45:06.417
> 
> 标签：javascript, jquery

我有`<a>`按动态 ID 排列的元素（标签中的图像）列表。可以只选择其中之一。假设我选择任何元素。这一次，我更改了它的样式并将“SelectedItem”值设置为它的名称属性，以便将来找到选定的项目。我希望当鼠标悬停在选定项目上时更改其 src 值，但 jquery 函数不起作用，因为我使用 javascript 设置了 name="SelectedItem" 属性，在运行时，它在重新加载页面后起作用。当我在代码中设置 name="SelectedItem" 时（默认，在运行时之前）它工作。但我想在不重新加载页面的情况下做到这一点。

![在此处输入图像描述](../Images/2bb7df92df54fea695070a4ded0da3c8.png)

不久，当我进行选择操作时，我将 name="SelectedItem" 设置为所选图像：

```
function SelectItem(id) {
var imgId = 'productImage_' + id;
var imgId_element = document.getElementById(imgId.toString());

//my some operations

imgId_element.name = "SelectedItem";
} 
```

并在取消选择时获取名称的值。

```
function UnSelectItem(id) {
var imgId = 'productImage_' + id;
var imgId_element = document.getElementById(imgId.toString());

//my some operations

imgId_element.name = "";
} 
```

我想将取消选择图像设置为仅选定图像的背景。当我有以下`Select/Unselect` 任何项目不起作用时。`SelectItem()/UnSelectItem()``mouseover()/mouseout()`

```
$("img[name='SelectedItem']").mouseover(function () {
            $(this).attr("src", "/Content/images/select.png");
        }).mouseout(function () {
            $(this).attr("src", "/Content/images/unselect.png");
}); 
```

HTML是：

```
<img src="@Url.Content("~/Content/images/select.png")" id='productImage_@(Model.Id)'  data-id='@Model.Id'  @{if (Model.IsSelected) { <text>name="SelectedItem"</text>} }  alt="" /> 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:48:34.450

尝试：

```
$('body').on('mouseover', 'img[name=SelectedItem]', function() {
  this.src = "/Content/images/select.png";
}).on('mouseout', 'img[name=SelectedItem]', function() {
  this.src = "/Content/images/unselect.png";
}); 
```

通过使用 的 3 参数变体，您可以在元素上`.on()`设置**委托**处理程序。`<body>`当鼠标事件冒泡时，处理程序将根据选择器检查目标元素。

现在，也就是说，对`<img>`元素使用“名称”属性/属性没有多大意义；这不是一个有效的属性。你最好添加/删除一个**类**值：

```
function SelectItem(id) {
  $('#productImage' + id).addClass('SelectedItem');
} 
```

接着：

```
$('body').on('mouseover', '.SelectedItem', function() { ... }) 
```

等等。最后，你最好使用合成的“mouseenter”和“mouseleave”事件，因为它们克服了一些浏览器的奇怪问题。

# algorithm - 通过多边形的随机线

> ID：14416480
> 
> 赞同：1
> 
> 时间：2013-01-19T16:45:13.897
> 
> 标签：algorithm, geometry

问题：

我无法生成一条穿过多边形（不一定是凸面）的随机线。这些线应该与完全随机的线（随机位置，随机角度）具有相同的分布，忽略那些完全错过多边形的线。

到目前为止我的想法：

在多边形内选择一个随机点（我已经有那个算法）并选择一个随机角度是行不通的，因为锤形物体会更频繁地穿过头部（它的面积比手柄大），其中一个完全随机的线更有可能穿过手柄。此外，角度肯定不会均匀分布。

出于同样的原因，不可能在表面内部或表面上选取两个点并生成一条穿过这两个点的线或任何类似方法。

编辑：我有两种方法可以使用，但我对其中任何一种都不完全满意。

1.  找到一个包含多边形的圆。通过圆圈选择随机线，直到找到一条也穿过多边形的线。这基本上是我上面写的定义，只有更高的机会击中多边形。

2.  在 n 个方向（例如 0°、10°、20° 等）上投影多边形。投影的大小与从该方向受到打击的可能性成正比。然后我选择一个方向（使用投影大小作为加权概率）。最后，我可以在角度上添加 360/n° 抖动。这应该足够近似分布，但我想知道是否有更好的方法。

**Edit2** : -deleted-
我写了很多，但是在考虑了更多并发现了一些错误之后，我意识到这已经超出了我的想象。这个想法是在几个特定的​​方向上投影多边形的凸包，并找到一个函数，通过混合已知的投影来为我们提供所有其他投影。但事实证明，细节非常复杂，对我来说太多了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T15:30:57.423

*与图形相交*的随机线的概念难以严格定义：请参阅[Bertrand 悖论](http://en.wikipedia.org/wiki/Bertrand_paradox_(probability))，了解此类概念中的歧义的一个著名示例。即使是*平面*中的随机线也不容易定义：您可能会尝试类似“一条以随机角度通过随机点的线”，但是如何选择随机点？平面上的点没有均匀分布。

这是一种精确定义*与图形 F 相交的随机线*的方法。令*w* (θ) 为垂直于角度 θ的图形*F*的宽度：

![](../Images/c7d19531249ab56298f54b4eac2c90e1.png)

当*F*是一个多边形时，*w* (θ) 由分段正弦函数组成，具有与多边形的[凸包具有](http://en.wikipedia.org/wiki/Convex_hull)[对映顶点对的](http://en.wikipedia.org/wiki/Antipodal_point#Antipodal_pair_of_points_on_a_convex_polygon)一样多的片段。

*现在，使用p* (θ) 作为概率密度函数选择一个角度 θ ，其中

> *p* (θ) = *w* (θ) / ∫ *w* (θ) dθ

然后在区间[0, *w* (θ)]上均匀地选择直线的位置。

（您的方法 #2 尝试通过对少量 θ 值进行采样并构建分段常数分布来逼近*p (θ)。但我们可以在没有太多额外困难的情况下获得准确的结果。）*

要计算积分 ∫ <em>w(θ) dθ（以及因此*p* (θ)），首先找到多边形的[凸包](http://en.wikipedia.org/wiki/Convex_hull)，然后使用[旋转卡尺](http://en.wikipedia.org/wiki/Rotating_calipers)方法找到对[映顶点对](http://en.wikipedia.org/wiki/Antipodal_point#Antipodal_pair_of_points_on_a_convex_polygon)。在相邻的对映对之间，卡尺从 θ [0]移动到 θ [1]，比如说，在这个范围内*w* (θ) 由下式给出

> *w* (θ) = *d* sin(θ − φ)

其中 φ 是对映顶点之间的连线的夹角*d*是它的长度，如下两图所示：

![](../Images/112954d6657640c60cf360161a6ccc45.png)

![](../Images/376f852ef4fd1f1c0405dbbd2ffaa196.png)

现在在 θ [0]到 θ [1]的范围内，不定积分为：

> ∫ *w* (θ) dθ = ∫ *d* sin(θ - φ) dθ = - *d* cos(θ - φ)

因此*w* (θ) 对于范围 [θ [0] , θ [1] ] 的定积分是

> *d* (cos(θ [0] - φ) - cos(θ [1] - φ))

将所有对映点对相加，就可以计算出整个积分。

# c - gcc /usr/bin/ld: 错误: 找不到 -lncurses

> ID：14416487
> 
> 赞同：33
> 
> 时间：2013-01-19T16:46:11.760
> 
> 标签：c, linux, gcc, ubuntu, ncurses

我正在运行 Ubuntu 12.04，我目前正在从事一个涉及 C、OpenGL、茶壶和输入法的项目。

当我决定将箭头键作为输入时，问题就开始了。我检查了箭头键的键码，但所有箭头都返回 0。我查找了如何使它工作，我找到了 conio.h。不幸的是，它是一个旧的 DOS 头文件，不适用于 Linux。然后我找到了一个叫做 ncurses 的替代品。

安装必要的库后，通过密切遵循构建说明，我在 main.c 源代码中添加了 #included curses.h。当我第一次尝试使用 gcc 进行编译时，出现以下错误：

```
main.o:main.c:function _Key: error: undefined reference to 'stdscr'
main.o:main.c:function _Key: error: undefined reference to 'wgetch'
main.o:main.c:function _Key: error: undefined reference to 'stdscr'
main.o:main.c:function _Key: error: undefined reference to 'wgetch' 
```

我通过将 -lncurses 添加到 makefile 中找到了解决方法，如下所示：

```
SOURCES=main.c

main: main.o
    gcc -lm -lGL -lGLU -lglut -lncurses main.o -o main

main.o: main.c
    gcc -lm -lGL -lGLU -lglut -c main.c 
```

但是我遇到了另一个错误：

```
/usr/bin/ld: error: cannot find -lncurses 
```

以及之前的错误。

在过去的 2 天里，我一直在搜索 Ubuntu 论坛和 StackOverFlow。任何帮助，将不胜感激。

PS 我不知道这是否重要，但是当我尝试运行 /usr/bin/ld 时出现此错误：

```
ld: fatal error: no input files 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2015-01-07T17:10:13.480

对于任何有同样问题的人：我错过了 32 位库；我在缺少 lib32ncurses5-dev 包的 64 位服务器上编译 32 位。

在 Ubuntu 上，我只是运行：

```
sudo apt-get install lib32ncurses5-dev 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T16:50:04.683

首先，链接时应该将库放在目标文件*之后。*并且在源文件的编译中根本没有它们。

之后，如果 ncurses 未安装在标准搜索文件夹中，您需要指出它所在的链接器，这是通过`-L`命令行选项完成的：

```
gcc main.o -o main -L/location/of/ncurses -lm -lGL -lGLU -lglut -lncurses 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T17:00:48.153

`ncurses-static`如果您`ncurses-devel`的 Ubuntu 操作系统中只安装了该软件包，请尝试安装该软件包。

如果这解决了您的问题，再加上您添加了@Joachim 的编译说明，那么您将有了一个良好的开端。

```
gcc main.o -o main -L/location/of/ncurses -lm -lGL -lGLU -lglut -lncurses 
```

链接器在其搜索路径中找不到您的共享库。如果您将共享库所在的目录添加到`LD_LIBRARY_PATH`环境变量中，链接器应该会找到它并能够链接到它。在这种情况下，您可以省略`-L`gcc 的选项：

```
gcc main.o -o main -lm -lGL -lGLU -lglut -lncurses 
```

它应该编译得很好。

编辑：很高兴知道这可以`apt-get install libncurses5-dev`解决您的问题。

供参考。`LD_LIBRARY_PATH`环境变量包含一个冒号分隔的路径列表，链接器用于在运行时解析库依赖关系。这些路径将优先于标准库路径`/lib`和`/usr/lib`. 标准路径仍将被搜索，但只有在路径列表`LD_LIBRARY_PATH`已用尽之后。

最好的使用方法`LD_LIBRARY_PATH`是在执行程序之前立即在命令行或脚本上设置它。通过这种方式，您可以保持新`LD_LIBRARY_PATH`的与系统的其余部分隔离，即本地到当前正在运行的 shell 实例。

```
$ export LD_LIBRARY_PATH="/path/to/libncurses/library/directory/:$LD_LIBRARY_PATH"
$ gcc main.o -o main -lm -lGL -lGLU -lglut -lncurses 
```

# mysql - MySQL - 如何从 rss 提要中投射日期时间

> ID：14416489
> 
> 赞同：1
> 
> 时间：2013-01-19T16:46:37.047
> 
> 标签：mysql, sql, datetime, casting

我正在通过 wget 和 LOAD DATA INFILE 将 rss 提要导入 MySQL 5.1。

这一切都很好，但是，我在将 rss 提要中的日期和时间转换为 mysql 中的 datetime col 时遇到问题。

提要中的示例日期是：

2013 年 1 月 19 日星期六 11:10:19 GMT

有什么想法可以转换或转换它吗？

谢谢

J。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:49:13.377

这个怎么样？使用[`str_to_Date`](http://www.w3resource.com/mysql/date-and-time-functions/mysql-str_to_date-function.php)：

```
STR_TO_DATE('rss_date', '%y-%m-%d') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:50:34.557

采用`STR_TO_DATE`

```
SELECT STR_TO_DATE(DATE_STRING,'%a, %d %b %Y %h:%i:%s') 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/cd656/1)

其他来源

*   [STR_TO_DATE](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)
*   [日期格式](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

# c# - 如何从访问数据库中读取是/否数据类型

> ID：14416491
> 
> 赞同：0
> 
> 时间：2013-01-19T16:46:41.003
> 
> 标签：c#, asp.net, boolean, ms-access-2007

下面的代码来自`res.aspx.cs` 我无法从该代码行导致我的错误的字段中读取任何内容：

```
 strStatus = rdr["rStatus"].ToString(); 
```

```
protected void Page_Load(object sender, EventArgs e)
        {

                OleDbConnection mDB = new OleDbConnection();
                mDB.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data source="
                + Server.MapPath("~/App_Data/Database.accdb");
                OleDbCommand cmd; OleDbDataReader rdr;
                string strUserId = (string)Session["sUserId"];
                string strStatus;
                string strSql = "SELECT rStatus FROM Reservation WHERE rUserId =" + strUserId
               + " ORDER BY rStatus DESC;";
                cmd = new OleDbCommand(strSql, mDB);
                cmd.Parameters.Add("@UserId", OleDbType.Char).Value = strUserId;
                mDB.Open();
                rdr = cmd.ExecuteReader();
                strStatus = rdr["rStatus"].ToString();
            while (rdr.Read() == true)

                //  string strRStatus = (string)Session["srStatus"];
                //   while (rdr.Read() == true) 

                if (strStatus == "-1")
                {

                    DetailsView1.Visible = false;
                    Label2.Visible = false;
                    btnBuy.Visible = false;
                    DropDownList1.Visible = false;
                    btnCancel.Visible = false;
                    lblReserve.Text = "There is no resevation for user " + Session["sUserId"];

                }
                else
                {
                    lblReserve.Visible = false;
                    Label1.Visible = true;
                    Label2.Visible = true;
                    DetailsView1.Visible = true;
                    btnBuy.Visible = true;
                    DropDownList1.Visible = true;
                    btnCancel.Visible = true;

                }
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:50:42.613

尝试移动

```
strStatus = rdr["rStatus"].ToString(); 
```

在你打电话后

```
rdr.Read() 
```

编辑：如果要读取 SQL 位值，可以使用`GetBoolean`阅读器上的方法：

```
bool myBoolean;
if (!rdr.IsDBNull(columnIndex))
    myBoolean = rdr.GetBoolean(columnIndex); 
```

# asp.net - Asp.net MVC 3 视图设计

> ID：14416493
> 
> 赞同：0
> 
> 时间：2013-01-19T16:46:51.973
> 
> 标签：asp.net, asp.net-mvc

我有一个表，它的属性对于将要插入的所有行都不是通用的，这意味着我的示意图将允许某些列为空，这取决于所选的类型。

桌子

```
Item table

ItemId
Name
Location
Typeid

Type table

Typeid
Desc 
```

在表单中（从下拉列表中）选择某种类型后，项目中的某些属性将显示给用户，并且必须输入它们。我该如何处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T16:01:16.190

您也可以使用 Javascript 和 AJAX 来实现。您可以拥有一个隐藏的 div，称为“item-form”。在选择其中一个下拉选项时，javascript 函数可以使用所选项目类型的 html 填充项目表单（具有必要的属性）并使 div 可见。

就像是 -

```
$("#dropdown").change(function(){
    if($(this).val()==1)
        $("#item-form").html(); //form with the attributes for type 1
    else if ($(this).val()==2)
        $("#item-form").hmtl(); //form with the attributes for type 2

}); 
```

您可以使用对特定于所选类型的控制器操作的调用来填充 div，这些操作将返回部分视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:01:08.063

每个表您可能会有一个控制器操作（可能是一个控制器），因此您可以获得单独的 SEO 网址。您还需要每个表的视图以及这些值并没有真正共享。您可以创建一个象牙城堡，在给定通用列表或数据表的情况下呈现表格，但如果您倾向于这条路线，只需使用控件即可。

# regex - MVC - 从 rss 提要中去除不需要的文本

> ID：14416494
> 
> 赞同：1
> 
> 时间：2013-01-19T16:46:58.367
> 
> 标签：regex, asp.net-mvc, rss, orchardcms

在我的 Orchard CMS 实现中，我的 RSS 消费者（Vandelay Industries RemoteRSS）中有以下代码：

```
@using System.Xml.Linq
@{
  var feed = Model.Feed as XElement;
 }
<ul>
@foreach(var item in feed
.Element("channel")
.Elements("item")
.Take((int)Model.ItemsToDisplay)) 
{
 <li>@T(item.Element("description").Value)</li>
}
</ul> 
```

我使用的 rss 提要来自 Pinterest，这将图像、链接和简短描述捆绑在提要的“描述”元素中。

```
<description>&lt;a href="/pin/215609900882251703/"&gt;&lt;img src="http://media-cache-ec2.pinterest.com/upload/88664686384961121_UIyVRN8A_b.jpg"&gt;&lt;/a&gt;How to install Orchard CMS on IIS Server</description> 
```

我的问题是我不想要文本位，我还需要在“href=”链接前加上“http://www.pinterest.com”。

我已经设法用我的新手技能编辑了原始代码，它基本上将图像显示为链接，这些链接只是相对的，因此在本地指向我的服务器。这些图像后面还有简短的描述。

总而言之，我需要一种方法为所有链接添加前缀“http://pinterest.com”，然后删除图片/链接之后的费用文本。

任何指针将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T21:07:02.153

您可能应该使用类似[http://htmlagilitypack.codeplex.com/](http://htmlagilitypack.codeplex.com/)的内容来解析描述，然后对其进行调整以添加前缀。或者您可以学习正则表达式而无需库。然而，可能有点棘手且容易出错。

# php - 通过 PHP 的 iCloud CalDAV

> ID：14416501
> 
> 赞同：4
> 
> 时间：2013-01-19T16:47:28.030
> 
> 标签：php, curl, calendar, icloud, caldav

我正在尝试编写一个基本的 CalDAV 交互脚本，以便与给定帐户的 Apple iCloud 日历一起使用。目前，我收到如下所示的回复：

```
Precondition Failed
Requested resource has a matching ETag. 
```

我使用的代码最初取自[http://trentrichardson.com/2012/06/22/put-caldav-events-to-calendar-in-php/](http://trentrichardson.com/2012/06/22/put-caldav-events-to-calendar-in-php/)并适用于以下内容：

```
<?php

$account = array(
    'server'=> 'p05',
    'id'    => '######',
    'user'  => 'a****z@me.com',
    'pass'  => '*****'
);

$url = 'https://'.$account['server'].'-caldav.icloud.com/'.$account['id'].'/calendars/work/';
$userpwd = $account['user'] .":". $account['pass'];
$description = 'Test event description';
$summary = 'Test event';
$tstart = gmdate("Ymd\THis\Z", strtotime("-2 days"));
$tend = gmdate("Ymd\THis\Z", strtotime("-2 days"));
$tstamp = gmdate("Ymd\THis\Z");

$body = <<<__EOD
BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTAMP:$tstamp
DTSTART:$tstart
DTEND:$tend
UID:$uid
DESCRIPTION:$description
LOCATION:Office
SUMMARY:$summary
END:VEVENT
END:VCALENDAR
__EOD;

$headers = array(
    'Content-Type: text/calendar; charset=utf-8',
    'If-None-Match: *', //Possibly this line causing a problem - unsure of what it does?
    'Content-Length: '.strlen($body),
);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($ch, CURLOPT_USERPWD, $userpwd);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
curl_setopt($ch, CURLOPT_POSTFIELDS, $body);
$res = curl_exec($ch);
curl_close($ch);

print_r($res);

?> 
```

您可以从此脚本中获取您的用户 ID：[https ://github.com/muhlba91/icloud/blob/master/PHP/icloud.php](https://github.com/muhlba91/icloud/blob/master/PHP/icloud.php)

有谁知道响应意味着什么，或者如何解决它？我意识到脚本非常基本，但我想在将它整理到课堂之前先让一些东西工作。

提前感谢您的*任何*建议/帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:59:17.777

当然，在一个问题上花费数小时并诉诸 SO 之后，你的大脑就会开始工作。

我错过了 $uid var，需要设置为唯一的（或现有的要更新的）事件 ID。以下内容应该适用于其他试图实现相同目标的人：

```
<?php

$account = array(
    'server'=> 'p05',
    'id'    => '######',
    'user'  => 'a****z@me.com',
    'pass'  => '*****'
);

$uid = 'event-12345';
$url = 'https://'.$account['server'].'-caldav.icloud.com/'.$account['id'].'/calendars/work/' . $uid . '.ics';
$userpwd = $account['user'] .":". $account['pass'];
$description = 'Test event description';
$summary = 'Test event';
$tstart = gmdate("Ymd\THis\Z", strtotime("-2 days"));
$tend = gmdate("Ymd\THis\Z", strtotime("-2 days"));
$tstamp = gmdate("Ymd\THis\Z");

$body = <<<__EOD
BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTAMP:$tstamp
DTSTART:$tstart
DTEND:$tend
UID:$uid
DESCRIPTION:$description
LOCATION:Office
SUMMARY:$summary
END:VEVENT
END:VCALENDAR
__EOD;

$headers = array(
    'Content-Type: text/calendar; charset=utf-8',
    'If-None-Match: *',
    'Expect: ',
    'Content-Length: '.strlen($body),
);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($ch, CURLOPT_USERPWD, $userpwd);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
curl_setopt($ch, CURLOPT_POSTFIELDS, $body);
curl_exec($ch);
curl_close($ch);

?> 
```

我的错。

# c - SSE 有双打，不值得吗？

> ID：14416502
> 
> 赞同：8
> 
> 时间：2013-01-19T16:47:29.180
> 
> 标签：c, performance, double, sse, quaternions

我读了一些关于使用 SSE 内在函数的文章，并尝试用双打实现四元数旋转。下面是我写的普通函数和 SSE 函数，

```
 void quat_rot(quat_t a, REAL* restrict b){
    ///////////////////////////////////////////
    // Multiply vector b by quaternion a     //
    ///////////////////////////////////////////
    REAL cross_temp[3],result[3];

    cross_temp[0]=a.el[2]*b[2]-a.el[3]*b[1]+a.el[0]*b[0];
    cross_temp[1]=a.el[3]*b[0]-a.el[1]*b[2]+a.el[0]*b[1];
    cross_temp[2]=a.el[1]*b[1]-a.el[2]*b[0]+a.el[0]*b[2];

    result[0]=b[0]+2.0*(a.el[2]*cross_temp[2]-a.el[3]*cross_temp[1]);
    result[1]=b[1]+2.0*(a.el[3]*cross_temp[0]-a.el[1]*cross_temp[2]);
    result[2]=b[2]+2.0*(a.el[1]*cross_temp[1]-a.el[2]*cross_temp[0]);

    b[0]=result[0];
    b[1]=result[1];
    b[2]=result[2];
} 

```

**与上交所**

```
 inline void cross_p(__m128d *a, __m128d *b, __m128d *c){
    const __m128d SIGN_NP = _mm_set_pd(0.0, -0.0);

    __m128d l1 = _mm_mul_pd( _mm_unpacklo_pd(a[1], a[1]), b[0] );

    __m128d l2 = _mm_mul_pd( _mm_unpacklo_pd(b[1], b[1]), a[0] );
    __m128d m1 = _mm_sub_pd(l1, l2);
            m1 = _mm_shuffle_pd(m1, m1, 1);
            m1 = _mm_xor_pd(m1, SIGN_NP);

            l1 = _mm_mul_pd( a[0], _mm_shuffle_pd(b[0], b[0], 1) );

    __m128d m2 = _mm_sub_sd(l1, _mm_unpackhi_pd(l1, l1));

    c[0] = m1;
    c[1] = m2;
}

void quat_rotSSE(quat_t a, REAL* restrict b){
    ///////////////////////////////////////////
    // Multiply vector b by quaternion a     //
    ///////////////////////////////////////////

    __m128d axb[2];
    __m128d aa[2];
            aa[0] = _mm_load_pd(a.el+1);
            aa[1] = _mm_load_sd(a.el+3);
    __m128d bb[2];
            bb[0] = _mm_load_pd(b);
            bb[1] = _mm_load_sd(b+2);

    cross_p(aa, bb, axb);

    __m128d w = _mm_set1_pd(a.el[0]);

    axb[0] = _mm_add_pd(axb[0], _mm_mul_pd(w, bb[0]));
    axb[1] = _mm_add_sd(axb[1], _mm_mul_sd(w, bb[1]));

    cross_p(aa, axb, axb);

    _mm_store_pd(b, _mm_add_pd(bb[0], _mm_add_pd(axb[0], axb[0])));
    _mm_store_sd(b+2, _mm_add_pd(bb[1], _mm_add_sd(axb[1], axb[1])));
} 

```

旋转基本上是使用函数完成的，

![在此处输入图像描述](../Images/04d6b36fb40b64fd446dec8adb421283.png)

然后我运行以下测试来检查每个函数执行一组旋转所需的时间，

```
 int main(int argc, char *argv[]){

    REAL a[] __attribute__ ((aligned(16))) = {0.2, 1.3, 2.6};
    quat_t q = {{0.1, 0.7, -0.3, -3.2}};

    REAL sum = 0.0;
    for(int i = 0; i < 4; i++) sum += q.el[i] * q.el[i];
    sum = sqrt(sum);
    for(int i = 0; i < 4; i++) q.el[i] /= sum;

    int N = 1000000000;

    for(int i = 0; i < N; i++){
        quat_rotSSE(q, a);
    }

    printf("rot = ");
    for(int i = 0; i < 3; i++) printf("%f, ", a[i]);
    printf("\n");

    return 0;
} 

```

我使用 gcc 4.6.3 和 -O3 -std=c99 -msse3 编译。

使用 unix 的正常功能的时间`time`是 18.841s 和 SSE 的 21.689s。

我是否遗漏了什么，为什么 SSE 实施比正常实施慢 15%？在哪些情况下，双精度的 SSE 实现会更快？

* * *

**编辑**：从评论中得到建议，我尝试了几件事，

*   -O1 选项给出非常相似的结果。
*   尝试使用`restrict`函数`cross_p`并添加一个 __m128d 来保存第二个叉积。这在生产的组件中没有区别。
*   据我了解，为正常功能生成的程序集仅包含标量指令，除了一些`movapd`.

为 SSE 函数生成的汇编代码仅比普通代码少 4 行。

* * *

**编辑**：添加到生成的程序集的链接，

[quat_rot](http://pastebin.com/REcykLbr)

[quat_rotSSE](http://pastebin.com/rYZMc0V6)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T20:58:10.800

当您对大量元素执行相同的操作时，SSE（以及一般的 SIMD）工作得非常好，其中操作之间没有依赖关系。例如，如果您有一个 double 数组并且需要`array[i] = (array[i] * K + L)/M + N;`为每个元素执行，那么 SSE/SIMD 会有所帮助。

如果您没有对大量元素执行相同的操作，那么 SSE 将无济于事。例如，如果您有一个 double 并且需要这样做，`foo = (foo * K + L)/M + N;`那么 SSE/SIMD 将无济于事。

基本上，SSE 是不适合这项工作的工具。您需要将工作更改为 SSE 是正确工具的工作。例如，不是将一个向量乘以一个四元数；尝试将 1000 个向量的数组乘以一个四元数，或者将 1000 个向量的数组乘以 1000 个四元数的数组。

**编辑：在下面添加了所有内容！**

请注意，这通常意味着修改数据结构以适应。例如，与其拥有一个结构数组，不如拥有一个数组结构。

举个更好的例子，假设您的代码使用四元数数组，如下所示：

```
for(i = 0; i < quaternionCount; i++) {
   cross_temp[i][0] = a[i][2] * b[i][2] - a[i][3] * b[i][1] + a[i][0] * b[i][0];
   cross_temp[i][1] = a[i][3] * b[i][0] - a[i][1] * b[i][2] + a[i][0] * b[i][1];
   cross_temp[i][2] = a[i][1] * b[i][1] - a[i][2] * b[i][0] + a[i][0] * b[i][2];

   b[i][0] = b[i][0] + 2.0 * (a[i][2] * cross_temp[i][2] - a[i][3] * cross_temp[i][1]);
   b[i][1] = b[i][1] + 2.0 * (a[i][3] * cross_temp[i][0] - a[i][1] * cross_temp[i][2]);
   b[i][2] = b[i][2] + 2.0 * (a[i][1] * cross_temp[i][1] - a[i][2] * cross_temp[i][0]);
} 
```

第一步是将其转换为数组的四元数，然后执行以下操作：

```
for(i = 0; i < quaternionCount; i++) {
   cross_temp[0][i] = a[2][i] * b[2][i] - a[3][i] * b[1][i] + a[0][i] * b[0][i];
   cross_temp[1][i] = a[3][i] * b[0][i] - a[1][i] * b[2][i] + a[0][i] * b[1][i];
   cross_temp[2][i] = a[1][i] * b[1][i] - a[2][i] * b[0][i] + a[0][i] * b[2][i];

   b[0][i] = b[0][i] + 2.0 * (a[2][i] * cross_temp[2][i] - a[3][i] * cross_temp[1][i]);
   b[1][i] = b[1][i] + 2.0 * (a[3][i] * cross_temp[0][i] - a[1][i] * cross_temp[2][i]);
   b[2][i] = b[2][i] + 2.0 * (a[1][i] * cross_temp[1][i] - a[2][i] * cross_temp[0][i]);
} 
```

然后，因为 2 个**相邻**的双精度数适合单个 SSE 寄存器，所以您希望将循环展开 2：

```
for(i = 0; i < quaternionCount; i += 2) {
   cross_temp[0][i] = a[2][i] * b[2][i] - a[3][i] * b[1][i] + a[0][i] * b[0][i];
   cross_temp[0][i+1] = a[2][i+1] * b[2][i+1] - a[3][i+1] * b[1][i+1] + a[0][i+1] * b[0][i+1];
   cross_temp[1][i] = a[3][i] * b[0][i] - a[1][i] * b[2][i] + a[0][i] * b[1][i];
   cross_temp[1][i+1] = a[3][i+1] * b[0][i+1] - a[1][i+1] * b[2][i+1] + a[0][i+1] * b[1][i+1];
   cross_temp[2][i] = a[1][i] * b[1][i] - a[2][i] * b[0][i] + a[0][i] * b[2][i];
   cross_temp[2][i+1] = a[1][i+1] * b[1][i+1] - a[2][i+1] * b[0][i+1] + a[0][i+1] * b[2][i+1];

   b[0][i] = b[0][i] + 2.0 * (a[2][i] * cross_temp[2][i] - a[3][i] * cross_temp[1][i]);
   b[0][i+1] = b[0][i+1] + 2.0 * (a[2][i+1] * cross_temp[2][i+1] - a[3][i+1] * cross_temp[1][i+1]);
   b[1][i] = b[1][i] + 2.0 * (a[3][i] * cross_temp[0][i] - a[1][i] * cross_temp[2][i]);
   b[1][i+1] = b[1][i+1] + 2.0 * (a[3][i+1] * cross_temp[0][i+1] - a[1][i+1] * cross_temp[2][i+1]);
   b[2][i] = b[2][i] + 2.0 * (a[1][i] * cross_temp[1][i] - a[2][i] * cross_temp[0][i]);
   b[2][i+1] = b[2][i+1] + 2.0 * (a[1][i+1] * cross_temp[1][i+1] - a[2][i+1] * cross_temp[0][i+1]);
} 
```

现在，您想将其分解为单独的操作。例如，内部循环的前 2 行将变为：

```
 cross_temp[0][i] = a[2][i] * b[2][i];
   cross_temp[0][i] -= a[3][i] * b[1][i];
   cross_temp[0][i] += a[0][i] * b[0][i];
   cross_temp[0][i+1] = a[2][i+1] * b[2][i+1];
   cross_temp[0][i+1] -= a[3][i+1] * b[1][i+1];
   cross_temp[0][i+1] += a[0][i+1] * b[0][i+1]; 
```

现在重新订购：

```
 cross_temp[0][i] = a[2][i] * b[2][i];
   cross_temp[0][i+1] = a[2][i+1] * b[2][i+1];

   cross_temp[0][i] -= a[3][i] * b[1][i];
   cross_temp[0][i+1] -= a[3][i+1] * b[1][i+1];

   cross_temp[0][i] += a[0][i] * b[0][i];
   cross_temp[0][i+1] += a[0][i+1] * b[0][i+1]; 
```

完成所有这些后，请考虑转换为 SSE。前 2 行代码是一次加载（同时加载`a[2][i]`并加载`a[2][i+1]`到 SSE 寄存器中），然后是一次乘法（而不是 2 次单独的加载和 2 次单独的乘法）。这 6 行可能会变成（伪代码）：

```
 load SSE_register1 with both a[2][i] and a[2][i+1]
   multiply SSE_register1 with both b[2][i] and b[2][i+1]

   load SSE_register2 with both a[3][i] and a[3][i+1]
   multiply SSE_register2 with both b[1][i] and b[1][i+1]

   load SSE_register2 with both a[0][i] and a[0][i+1]
   multiply SSE_register2 with both b[0][i] and b[0][i+1]

   SE_register1 = SE_register1 - SE_register2
   SE_register1 = SE_register1 + SE_register3 
```

这里的每一行伪代码都是一条 SSE 指令/内在函数；并且**每条 SSE 指令/内在函数都在并行执行 2 个操作**。

如果每条指令并行执行 2 次操作，那么（理论上）它的速度可能是原始“每条指令一个操作”代码的两倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:12:40.707

一些想法可能会使您的代码完全优化。

*   你的函数应该是内联的
*   您应该添加`restrict`规范以`cross_p`避免编译器多次重新加载参数
*   如果你这样做，你必须引入第四个`__m128d`变量，它将接收第二次调用的结果`cross_p`

然后查看汇编程序（gcc 选项 -S）以查看所有这些生成的内容。

# java - 自定义 HashMap-Key (Java) 会极大地降低性能

> ID：14416504
> 
> 赞同：1
> 
> 时间：2013-01-19T16:48:02.160
> 
> 标签：java, performance, hashmap, key

这是我在这里的第一个问题，但我希望我能提供所有需要的信息。
如果不是，请告诉我！

我的问题：
我试图通过添加一个 HashMap 来存储已经处理的结果来改进我的回溯算法。为此，我为该 HashMap 的键创建了一个自己的类。在那里我覆盖了 .equals()- 和 .hashCode()- 方法。
但是，如果我尝试将这个键和它的值放入映射中，这将花费很多时间，因此算法变得比没有映射的回溯算法效率更低。
为了解决这个问题，我将 HashMap-Key 更改为 String 并将 .toString() 方法添加到我的键类中。这工作得很好，而且速度很快。（奇怪的事情： .toString().hashCode() 产生很多负值，但似乎有效）

现在我的问题：
如果您创建自己的密钥，它是否总是减慢那么多？
我试图自己找到这个问题的答案，而我发现的唯一问题是更改 .hashCode() 或使用 HashMap-Constructor 的参数。
我尝试了这两种方法，并为我的测试环境导出了生成的 HashCodes，但我没有找到任何重复项，尽管我知道，这不是哈希码的“好”方法！

这是我的 HashKey-Class 的副本（变量和方法的名称已更改）：

```
public class HashKey {
    private final int int0, int1, int2;

    public HashKey(int int0, int int1, int int2) {
        this.int0 = int0;
        this.int1 = int1;
        this.int2 = int2;
    }

    public int getInt0() {
        return this.int0;
    }

    public int getInt1() {
        return this.int1;
    }

    public int getInt2() {
        return this.int2;
    }

    @Override
    public int hashCode() {
        final int prime1 = 107;
        final int prime2 = 227;
        final int prime3 = 499;
        int result = 1;
        result = prime1 * result + this.int2;
        result = prime2 * result + this.int1;
        result = prime3 * result + this.int0;
        return result;
     }

    @Override
    public String toString() {
        return "Int0: " + this.int0 + " Int1: " + int1 + " Int2: " + int2;
    }

    @Override
    public boolean equals(Object obj) {
        if (obj instanceof HashKey) {
            boolean eq0, eq1, eq2;
            eq0 = this.int0 == ((HashKey) obj).getInt0();
            eq1 = this.int1 == ((HashKey) obj).getInt1();
            eq2 = this.int2 == ((HashKey) obj).getInt2();
            if (eq0 && eq1 && eq2) {
                return true;
            }
        }
        return false;
    }
} 
```

在我的主类中，我使用这个：

```
HashMap<HashKey, List<Object>> storedResults = new HashMap<HashKey, List<Object>>();  

int x1,x2,x3;  
Object obj;  

// later in a method:

storedResults.put(new HashKey(x1,x2,x3), obj); 
```

如果我将键的类型更改为字符串并将该字符串放入地图中，它工作正常！因此 HashKey.hashCode() 方法和算法的其余部分工作正常并且速度非常快。

有谁知道，我能做些什么来使用这个 HashKey？对于这个算法，它并不那么重要，但我想知道它以用于未来的算法！

如果有任何问题或批评：非常欢迎他们！

提前致谢！

克伦贝

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:53:55.860

你的类几乎是不可变的：你所有的实例成员都是最终的，只是类本身也需要是。

但由于您的所有实例成员都是最终成员，您也可以在构建时计算哈希码：

```
// Add as member:
private final int hashCode;

public HashKey(int int0, int int1, int int2) {
    this.int0 = int0;
    this.int1 = int1;
    this.int2 = int2;
    hashCode = // calculate hash code here
}

public int hashCode()
{
    return hashCode;
} 
```

顺便说一句，负哈希码没什么好担心的。`.hashCode()`毕竟返回一个int。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:03:55.027

试试这个：简单化你的`equals(..)`方法，不要计算`hashCode`不止一次。

```
public final class HashKey {
    private final int int0, int1, int2;
    private final int hashCode;

    public HashKey(int int0, int int1, int int2) {
        this.int0 = int0;
        this.int1 = int1;
        this.int2 = int2;
        hashCode=107*int0+227*int1+499*int2;
    }

    @Override
    public final int hashCode() {
        return hashCode;
    }

    @Override
    public final boolean equals( finalObject obj) {
        if (!obj instanceof HashKey)
            retun false;
        HashKey other = (HashKey)obj;
        return int0 == other.int0 && int1 == other.int1 &&  int2 == other.int2;
    }
} 
```

参考*fge*的评论，我更改了代码。

# arrays - R在for循环中使用条件滞后计算填充矩阵或数组

> ID：14416506
> 
> 赞同：0
> 
> 时间：2013-01-19T16:48:14.247
> 
> 标签：arrays, r, lag

我翻遍了列表档案，要么我不知道问这个问题的正确词，要么以前没有出现过——

我有一个模拟功能，我可以在其中跟踪一段时间内的点列表，并希望根据分配引入额外的滞后计算。我创建了一段非常简单的代码来了解 R 如何填充矩阵：

```
t<-21    #time step
N<-10    #points to track
#creating a matrix where it's easy for me to see how the calculation is done
NEE<-rep(NA, (t+1)*N);dim(NEE)<-c(N,(t+1))
for(i in 1:t){
    NEE[,1]<-1
    NEE[,i+1]<-NEE[,i]+5
}

#the thing to calculate
gt<-rep(0, (t+1)*N);dim(gt)<-c(N,(t+1))
#assigned states
veg<-c(rep(0,5), rep(1,5))
veg.com<-rep(veg, t);dim(veg.com)<-c(N,t)

for (i in 1:t){
    gt[,i+1]<-ifelse(veg.com[,i]==0, NEE[,i]/5, NEE[,i-3]/5)
}
#to have a view of what happens
veg1<-gt[1,]*5      #assignment for veg.com==0
veg2<-gt[10,]*5     #assignment for veg.com==1
what<-cbind(NEE[1,], veg1,veg2)
what 
```

当然它可以工作，除了它如何在 veg.com==1 时延迟生效之前填充第一位（此处显示为 veg2 中的前 4 个值）。我确定有解决方法，但我首先只是想了解 R 在最初的几个循环中做了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:14:36.607

通过第二个 for 循环的前两次，您将使用带有表达式的负索引

```
NEE[ , i-3] 
```

这将返回一个 10 列矩阵，并删除第二列。下一次迭代将返回另一个 10 列矩阵，并删除第一列。负索引删除 R 中矩阵或数据帧的部分

# ruby-on-rails - 资源限制匹配 monit ruby on rails 3

> ID：14416507
> 
> 赞同：0
> 
> 时间：2013-01-19T16:48:22.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, monit

我在一个 512 mb 的小型 linode 上有一个小型 rails 3 应用程序，我使用 monit 我的 rails 应用程序进行监控。

我可以在监视器上看到消息`Resource limit matched`。你可以看到下一张图片：

[http://overpic.net/viewer.php?file=x5d6ybfukwgz6a5845bu8.jpg](http://overpic.net/viewer.php?file=x5d6ybfukwgz6a5845bu8.jpg)

我是monit的新手。

**这是否意味着我应该增加我的内存？还是我的CPU？或升级到 linode 1GB？**

**我在哪里可以找到一本好的 monit 电子书？**

谢谢！

# c++ - 使用 opencv 生长的种子区域

> ID：14416511
> 
> 赞同：3
> 
> 时间：2013-01-19T16:48:54.817
> 
> 标签：c++, image-processing, opencv

我需要选择一个像素值并应用根据种子像素增长的区域。尝试编写代码后，无论我使用什么种子点，结果始终是黑色图像。整个问题都与`GrowColor`函数有关。我的猜测是 ifs 的逻辑错误。

```
#include <cv.h>
#include <highgui.h>

using namespace std;

int xDim, yDim, zDim;
float ThreshHold = 45.0;
unsigned long total[3];
int coont, tt;
IplImage *Image1;
IplImage *Image2;

CvScalar s = cvScalar(0, 0, 0, 0);
CvScalar s11 = cvScalar(0, 0, 0, 0);

int Diff, mean[3], temp[3];

void GrowColor(int x, int y);

int main(int argc, char *argv[]) {

    char value[4];

    int pixType, dimCut;
    int Dbug = false;
    int Xseed = 40, Yseed = 234;
    int i = 0, x, y;
    Image1 = cvLoadImage("lenah.jpg");
    yDim = Image1->height;
    xDim = Image1->width;
    // int step= Image1->widthStep;
    //uchar* data = (uchar *)Image1->imageData;

//New image
    Image2 = cvCreateImage(cvSize(Image1->width, Image1->height), IPL_DEPTH_8U,
            1);
    cvZero(Image2);
    total[0] = total[1] = total[2] = coont = 0;

//Process

    for (y = Yseed - 5; y <= Yseed + 5; y++)
        for (x = Xseed - 5; x <= Xseed + 5; x++)
            if ((x > 0) && (y > 0) && (x < xDim) && (y < yDim)) {

                coont++;
                s = cvGet2D(Image1, x, y);
                total[0] += abs(s.val[0]);
                total[1] += abs(s.val[1]);
                total[2] += abs(s.val[2]);

            }

    GrowColor(Xseed, Yseed);
    cvNamedWindow("wndname", 1);
    cvShowImage("original", Image1);

    cvShowImage("wndname", Image2);
    cvWaitKey(0);
    return 0;

}

void GrowColor(int x, int y) {
//Check to see if point already part of region

    s.val[0] = 0;
    s.val[1] = 0;
    s.val[2] = 0;
    s.val[3] = 0;
    if ((x < 1) && (y < 1))
        s = cvGet2D(Image2, x, y);

    if (s.val[0] == 0) {
        int k;
        if ((x == 1) && (y == 1))
            s11 = cvGet2D(Image1, x, y);
        mean[0] = total[0] / coont;
        mean[1] = total[1] / coont;
        mean[2] = total[2] / coont;

        temp[0] = abs(s11.val[0]) - mean[0];
        temp[1] = abs(s11.val[1]) - mean[1];
        temp[2] = abs(s11.val[2]) - mean[2];

        Diff =
                (int) (sqrt(
                        (temp[0] * temp[0] + temp[1] * temp[1]
                                + temp[2] * temp[2]) / 3));

        if (Diff < ThreshHold) {

            total[0] += abs(s11.val[0]);
            total[1] += abs(s11.val[1]);
            total[2] += abs(s11.val[2]);
            coont++;
            s.val[0] = 120;
            if ((x > 0) && (y > 0))
                cvSet2D(Image2, x, y, s);
            if (x > 2)
                GrowColor(x - 1, y);
            if (y > 2)
                GrowColor(x, y - 1);
            if (x < xDim - 2)
                GrowColor(x + 1, y);
            if (y < yDim - 2)
                GrowColor(x, y + 1);

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-16T05:13:21.110

制作`GrowColor`递归函数可能会导致无限循环。检查该函数中的代码一次。

# asp.net - VS 2012 中的解析器错误

> ID：14416513
> 
> 赞同：0
> 
> 时间：2013-01-19T16:49:09.767
> 
> 标签：asp.net, css

我在我的母版页中使用以下代码。

```
<link rel='stylesheet' id='layer-styles-css'  
     href='css/layerslider.css?ver=3.4.1' type='text/css' media='all' /> 
```

它在 MS Visual Studio 2012 中调试时给了我错误。

```
Parser Error
Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately.

Parser Error Message: 'layer-styles-css' is not a valid identifier. 
```

请帮我修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:16:10.077

当控件标记为`runat="server"`时，它的`id`和`id`of 及其所有包含的元素需要遵循与 C# 属性相同的命名约定。

我看不到您的 HTML 结构，但如果您将破折号更改`-`为下划线`_`，它很可能会解决您的问题。

# android - Android 活动：ClassNotFoundException

> ID：14416516
> 
> 赞同：3
> 
> 时间：2013-01-19T16:49:22.590
> 
> 标签：android, android-activity, android-emulator, classnotfoundexception

在我添加一些类并编辑清单文件之前，我的 android 应用程序运行良好。

现在，当我尝试在我的 android 模拟器上使用 android 2.2 运行或调试应用程序时，应用程序崩溃并且我得到一个 ClassNotFoundException，如下所示：

```
D/AndroidRuntime(  275): >>>>>>>>>>>>>> AndroidRuntime START <<<<<<<<<<<<<<
D/AndroidRuntime(  275): CheckJNI is ON
D/AndroidRuntime(  275): --- registering native functions ---
I/ActivityManager(   59): Starting activity: Intent { act=android.intent.action.MAIN     cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=de.bastian.gpstracker/.MainActivity }
I/ActivityManager(   59): Start proc de.bastian.gpstracker for activity de.bastian.gpstracker/.MainActivity: pid=281 uid=10036 gids={}
D/AndroidRuntime(  275): Shutting down VM
D/jdwp    (  275): adbd disconnected
D/AndroidRuntime(  281): Shutting down VM
W/dalvikvm(  281): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
E/AndroidRuntime(  281): FATAL EXCEPTION: main
E/AndroidRuntime(  281): java.lang.RuntimeException: Unable to instantiate application de.bastian.gpstracker: java.lang.ClassNotFoundException: de.bastian.gpstracker in loader dalvik.system.PathClassLoader[/data/app/de.bastian.gpstracker-1.apk]
E/AndroidRuntime(  281):        at android.app.ActivityThread$PackageInfo.makeApplication(ActivityThread.java:649)
E/AndroidRuntime(  281):        at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4232)
E/AndroidRuntime(  281):        at android.app.ActivityThread.access$3000(ActivityThread.java:125)
E/AndroidRuntime(  281):        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2071)
E/AndroidRuntime(  281):        at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(  281):        at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime(  281):        at android.app.ActivityThread.main(ActivityThread.java:4627)
E/AndroidRuntime(  281):        at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(  281):        at java.lang.reflect.Method.invoke(Method.java:521)
E/AndroidRuntime(  281):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
E/AndroidRuntime(  281):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
E/AndroidRuntime(  281):        at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(  281): Caused by: java.lang.ClassNotFoundException: de.bastian.gpstracker in loader dalvik.system.PathClassLoader[/data/app/de.bastian.gpstracker-1.apk]
E/AndroidRuntime(  281):        at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
E/AndroidRuntime(  281):        at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
E/AndroidRuntime(  281):        at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
E/AndroidRuntime(  281):        at android.app.Instrumentation.newApplication(Instrumentation.java:942)
E/AndroidRuntime(  281):        at android.app.ActivityThread$PackageInfo.makeApplication(ActivityThread.java:644)
E/AndroidRuntime(  281):        ... 11 more
W/ActivityManager(   59):   Force finishing activity de.bastian.gpstracker/.MainActivity
D/dalvikvm(  149): GC_FOR_MALLOC freed 4092 objects / 248904 bytes in 134ms
W/ActivityManager(   59): Activity pause timeout for HistoryRecord{43fa91d0 de.bastian.gpstracker/.MainActivity}
I/ActivityManager(   59): Displayed activity com.android.launcher/com.android.launcher2.Launcher: 12561 ms (total 12561 ms)
W/ActivityManager(   59): Activity destroy timeout for HistoryRecord{43fa91d0 de.bastian.gpstracker/.MainActivity}
D/KeyguardViewMediator(   59): pokeWakelock(5000)
D/KeyguardViewMediator(   59): pokeWakelock(5000)
I/ARMAssembler(   59): generated scanline__00000177:03515104_00001001_00000000 [ 91 ipp] (114 ins) at [0x325a10:0x325bd8] in 590637 ns
I/ARMAssembler(   59): generated scanline__00000077:03515104_00000000_00000000 [ 33 ipp] (47 ins) at [0x3261f0:0x3262ac] in 261841 ns
W/WindowManager(   59): No window to dispatch pointer action 1
I/Process (  281): Sending signal. PID: 281 SIG: 9
I/ActivityManager(   59): Process de.bastian.gpstracker (pid 281) has died. 
```

我想我的项目配置有问题。这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="de.bastian.gpstracker"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="10" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme"
        android:name="de.bastian.gpstracker" >
        <activity
            android:name="de.bastian.gpstracker.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

老实说，我不记得我对这个文件所做的最后更改，但是，对我来说，这里一切似乎都很好。

在寻找解决方案时，我还找到了链接[Android Activity ClassNotFoundException - 尝试了所有内容](https://stackoverflow.com/questions/10866431/android-activity-classnotfoundexception-tried-everything)，它描述了同样的问题，但由于我只处理一个项目，因此有一个不适用于我的案例的解决方案。

在上面的错误日志中，我注意到创建的 apk 的文件名以“-1”结尾。也许这是一个错误，也许这就是 eclipse/adt 处理事情的方式。另外，我注意到，当我尝试运行/调试项目时，会创建多个名为 MainActivity.class、MainActivity$1.class、MainActivity$2.class 的类文件，尽管我只有一个 MainActivity.java 文件（并且没有MainActivity$2.file 或类似的东西）。

如果有人知道这里出了什么问题，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:52:35.223

您正在将应用程序节点设置为引用不存在的类

```
de.bastian.gpstracker 
```

指的是包名，没有任何类。由于`gpstracker`是该字符串中的最后一件事，因此类加载器假定它`gpstracker`是一个类，并尝试加载它并失败。

所以写下 Application 类的名字（extends `Application`）。

例如

```
<application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme"
        android:name="de.bastian.gpstracker.MyApplicationClass" > 
```

如果您**没有**扩展类`Application`，则取出`android:name`该节点的属性，使其看起来像：

```
<application
            android:allowBackup="true"
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" > 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:54:52.520

将清单中的应用程序标记更改为：

```
<application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="de.bastian.gpstracker.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application> 
```

从应用程序标记中删除名称属性。令人误解的是，它与您的应用程序的名称没有任何关系，实际上是在加载您的应用程序之前要加载的额外类的名称。这就是您收到 ClassNotFoundException 的原因。删除它，它应该可以工作：

# jquery - jQuery keyup 函数未执行

> ID：14416517
> 
> 赞同：20
> 
> 时间：2013-01-19T16:49:36.803
> 
> 标签：jquery, html, input

我有这个代码：

```
<script>
     $('#searchInput').keyup(function() {
               alert('Handler for .keyup() called.');
     });
</script> 
```

这个输入：

```
<input id='searchInput' type='text' placeholder='Search other alumni users' /> 
```

但是当我按下一个键时，警报不会出现......我已经包含了 jQuery 脚本。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-19T16:50:25.877

将您的代码更改为

```
$(function(){ // this will be called when the DOM is ready
  $('#searchInput').keyup(function() {
    alert('Handler for .keyup() called.');
  });
}); 
```

以确保在构建 jQuery 集时存在 DOM 元素。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-19T17:05:15.460

```
$(document).ready(function() {
  $('#searchInput').keyup(function() {
    alert('Handler for .keyup() called.');
  });
}); 
```

或者

```
$(function() { 
  $('#searchInput').keyup(function() {
    alert('Handler for .keyup() called.');
  });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-03T21:34:18.703

`keyup`/`keydown`似乎只适用于`document.ready`.

如果您从页面加载后更改或注入的元素触发事件，这些事件将不会触发。

查找或创建在加载时存在的要监视的元素的父元素，然后将事件设置为从该父元素触发可以绕过这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-14T20:56:12.193

这对我有用：

```
 jQuery(".divForinput1 > input").keyup(function() {
    var value = $( this ).val();
    jQuery( ".divForinput2 > input" ).val( value );
    }).keyup();

//the .keyup on the end maybe what many are missing 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-09T15:30:45.217

就我而言，我在`$(document).ready(function () {});`

By changing the order of my Keyup functions i.e. placing them at the top... within document ready seemed to do the trick. My guess is that one of the other functions was breaking they keyup function for what ever reason?

# python - 从文件python 2.7中计算字符和行

> ID：14416522
> 
> 赞同：1
> 
> 时间：2013-01-19T16:50:19.707
> 
> 标签：python, python-2.7, batch-file, count, words

我正在编写一个程序，它计算作为输入的文件中的所有行、单词和字符。

```
import string

def main():
    print "Program determines the number of lines, words and chars in a file."
    file_name = raw_input("What is the file name to analyze? ")

    in_file = open(file_name, 'r')
    data = in_file.read()

    words = string.split(data)

    chars = 0
    lines = 0
    for i in words:
        chars = chars + len(i)

    print chars, len(words)

main() 
```

在某种程度上，代码是可以的。

但是我不知道如何计算文件中的“空格”。我的字符计数器只计算字母，不包括空格。
另外，在计算行数时，我是在画一个空白。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-19T16:52:07.760

您可以只使用`len(data)`字符长度。

您可以`data`使用该[`.splitlines()`](http://docs.python.org/2/library/stdtypes.html#str.splitlines)方法按行拆分，该结果的长度是行数。

但是，更好的方法是逐行读取文件：

```
chars = words = lines = 0
with open(file_name, 'r') as in_file:
    for line in in_file:
        lines += 1
        words += len(line.split())
        chars += len(line) 
```

现在，即使文件很大，程序也可以运行；它在内存中一次不会保存超过一行（加上一个小缓冲区，python 保留以使`for line in in_file:`循环更快一点）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-15T20:38:42.807

非常简单：如果要打印文件中的字符数、单词数和行数。包括空格..我觉得最短的答案是我的..

```
import string
data = open('diamond.txt', 'r').read()
print len(data.splitlines()), len(string.split(data)), len(data) 
```

继续编码伙伴...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-31T07:12:10.297

读取文件——

```
d=fp.readlines() 
```

人物-

```
sum([len(i)-1 for i in d]) 
```

线-

```
len(d) 
```

字-

```
sum([len(i.split()) for i in d]) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-02-06T16:29:33.273

这是在不使用任何关键字的情况下计算单词的一种粗略方法：

```
#count number of words in file
fp=open("hello1.txt","r+");
data=fp.read();
word_count=1;
for i in data:
    if i==" ":
        word_count=word_count+1;
    # end if
# end for
print ("number of words are:", word_count); 
```

# javascript - 使用 Rangy 从 db 恢复多个选择

> ID：14416524
> 
> 赞同：1
> 
> 时间：2013-01-19T16:50:22.153
> 
> 标签：javascript, jquery, ajax, rangy

**我想做的事 ：**

-> 向用户显示纯 HTML 页面 -> 用户能够突出显示该页面上的**文本**-> 当用户下次登录时，我应该能够检索并在页面上显示他之前的（多个）突出显示。

**我做了什么 ：**

我使用了[库/API：Rangy。](http://code.google.com/p/rangy/)有了这个我可以选择文本并用用户喜欢的颜色突出显示它。

**问题 ：**

我尝试了序列化和反序列化功能，但是当我尝试反序列化（重新加载页面后）它给我一个错误说

> 序列化范围根节点 (ec0c8cf0) 和目标根节点 (d4997863) 的校验和不匹配

每次我重新加载页面时，都会有一个新的根节点，在这种情况下我该如何修复反序列化？

**创建了一个 JS-Fiddle**：[demo](http://jsfiddle.net/janinishant10/wH9Ec/6/embedded/result/) / [js-fiddle](http://jsfiddle.net/janinishant10/wH9Ec/6/)

这是什么 - 如果你查看我的演示，我选择描述的第一个词，即“请”，我得到突出显示的文本，我也得到序列为：

> 0/3/1/3/0/1/1/2:9,0/3/1/3/0/1/1/2:9{b3002d92}

所以我所做的是，我对这个序列进行了硬编码，并将其放入页面 onLoad 函数中的 deserializeSelection 函数中，如下所示：-

```
rangy.deserializeSelection('0/3/1/3/0/1/1/2:9,0/3/1/3/0/1/1/2:9{b3002d92}'); 
```

所以从技术上讲，它应该在描述中突出显示“请”，无论何时加载页面，但它没有，而是在块中给我上述错误。你能帮我解决这个问题吗？请。谢谢

**额外的：**

1.我真的不明白rangy的序列化和反序列化方法。

2.我从这里开始的非常抽象的路线图是，在页面加载时执行 AJAX 调用，并从我的数据库中获取此页面的所有（序列化）用户选择，然后遍历它们并进行反序列化。

任何帮助将非常感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T04:14:13.500

我认为你应该试试这个：

```
var selObj = rangy.getSelection();
var se = rangy.serializeSelection(selObj, true); //true to avoid DOM checksum 
```

# windows - Windows批处理编程：将某些命令的数据获取到某个变量中

> ID：14416534
> 
> 赞同：0
> 
> 时间：2013-01-19T16:50:59.780
> 
> 标签：windows, batch-file, cmd

您好，我想将以下命令的输出收集到某个变量中。我该怎么做？

```
type somefile.txt | find /v "irritating string" 
```

实际上，我想将上述命令的输出写入其他文件夹中的其他文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:13:31.147

您的命令可能会产生多行输出。Windows 批处理没有方便的方法将多行命令输出捕获到单个变量中。FOR /F 命令可用于单独处理每一行，此时您可以将每一行连接成一个变量（最多为 ~8191 字节值长度限制），或者您可以创建一个变量数组。

键入`FOR /?`或`HELP FOR`从命令提示符获取有关 FOR 命令的更多信息。

但是由于您想真正捕获文件中的输出，因此解决方案非常简单。

如果你想创建一个新文件

```
type somefile.txt | find /v "irritating string" >"c:\somePath\newFile.txt" 
```

如果要将输出附加到现有文件

```
type somefile.txt | find /v "irritating string" >>"c:\somePath\existingFile.txt" 
```

如果该文件尚不存在，则会创建该文件。

# ruby-on-rails-3 - breadcrumbs_on_rails 渲染两次

> ID：14416535
> 
> 赞同：0
> 
> 时间：2013-01-19T16:51:06.283
> 
> 标签：ruby-on-rails-3, breadcrumbs

我试图让我的面包屑通过不同的控制器跟踪我的导航历史

应用控制器

```
add_breadcrumb 'Home', root_path 
```

在我的 public_pages 控制器中

```
class PublicPagesController < ApplicationController

def index

end

def news
 add_breadcrumb "News", news_path
 add_breadcrumb "Contact us", contact_path
end

def contact_us
add_breadcrumb "News", news_path
add_breadcrumb "Contact us", contact_path
end 
```

所以我有另一个名为 private_pages 的控制器，它只有在用户登录时才能访问，它有自己的 root_path，

在不同控制器中访问不同操作时如何显示面包屑

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:28:37.283

首先，将`home`面包屑添加到您的`ApplicationController`，因为它应该为*每个*请求注册。如果您的应用程序在这方面不可公开访问，请忽略这一点，并在方法之前保留`home`面包屑`PublicPagesController`。

然后，更新您的`PublicPagesController`：

```
class PublicPagesController < ApplicationController

  def index
  end

  def news
    # to show Home / Contact Us / News
    add_breadcrumb "Contact Us", news_path
    add_breadcrumb "News", news_path
  end

  def contact_us
    add_breadcrumb "Contact Us", news_path
  end

end 
```

以上假设`add_breadcrumb "Home", news_path`在您的`ApplicationController`.

关于`bootstrap`冲突或集成，请参见以下两个：

[https://github.com/weppos/breadcrumbs_on_rails/issues/24](https://github.com/weppos/breadcrumbs_on_rails/issues/24)
[https://gist.github.com/2400302](https://gist.github.com/2400302)

如果您想`home`根据用户是否登录来修改面包屑导航，`before_filter`请在您的`ApplicationController`:

```
before_filter :set_home_breadcrumb

def set_home_breadcrumb
  if user_signed_in?
    add_breadcrumb "Home", :user_home_path
  else
    add_breadcrumb "Home", :root_path
  end
end 
```

# function - 创建产生函数方案/DrRacket 的函数

> ID：14416536
> 
> 赞同：1
> 
> 时间：2013-01-19T16:51:19.603
> 
> 标签：function, scheme, structure, racket

我正在研究一个接收结构列表的函数，然后使用该结构列表生成一个将符号列表处理为数字的函数。每个结构都由一个符号和一个数字组成，该符号将在第二个使用的列表中。产生的这个函数必须通过根据先前的结构为每个符号分配一个值来将符号列表转换为一个数字。顺便说一句，使用抽象列表函数。

```
 Example: ((function (list (make-value 'value1 10) (make-value 'value2 20)))
              (list 'value1 'value2 'nothing 'value1)) would produced 40. 
```

这是我的代码，但它仅适用于特定情况。

```
 (define (function lst)
   (lambda (x) (foldr + 0 (map (lambda (x) 
                           (cond
                             [(equal? x (value-name(first lst)))(value-value (first  lst))]
                             [else (value-value (second lst))]))

                             (filter (lambda (x) (member? x (map value-name lst)))x))))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:30:57.297

看起来像家庭作业。您的解决方案的基本形状是可以的。我认为您在这里遇到问题的原因是您的代码中没有分解，因此很容易迷失在括号中。

让我们从您的想法开始，将`fold`整数`+`列表作为计算的最后一步。

对于此子任务，您有：

1) (name, value) 对的列表 2) 名称的列表

你需要得到一个值列表。编写一个单独的函数来执行此操作并使用它。像这样

```
(define (function lst)
   (lambda (x) (foldr + 
                      0 
                      (to-values x lst)))

(define (to-values names names-to-values)
   (map (lambda (name) 
            (to-value name names-to-values))))

(define (to-value n ns-to-vs)
     ...) 
```

在这里，我们`map`结束了`names`另一个小功能。它将在其中查找`n`值`ns-to-vs`并返回它，如果没有则返回 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:42:06.207

解决问题的方法有两种`foldr`，研究和理解这两种方法会很有趣。在问题中尝试的第一个是首先生成一个包含所有值的列表，然后让我们`foldr`负责添加它们。它可以以更简单的方式实现，如下所示：

```
(define (function lst)
  (lambda (x)
    (foldr +
           0
           (map (lambda (e)
                  (cond ((assoc e lst) => value-value)
                        (else 0)))
                x)))) 
```

或者：也许使用`foldr`是矫枉过正，应用`+`更简单：

```
(define (function lst)
  (lambda (x)
    (apply +
           (map (lambda (e)
                  (cond ((assoc e lst) => value-value)
                        (else 0)))
                x)))) 
```

在第二种方法中，我们“按原样”获取输入列表并让我们`foldr`执行`lambda`加法逻辑。这比使用的第一种方法更有效`foldr`，因为不需要创建中间列表 -`map`在第一个版本中生成的列表：

```
(define (function lst)
  (lambda (x)
    (foldr (lambda (e a)
             (cond ((assoc e lst) => (lambda (p) (+ a (value-value p))))
                   (else a)))
           0
           x))) 
```

在这两种方法中，我都[`assoc`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._assoc%29%29)用于在列表中查找元素；如果您不允许使用它或者如果它不适用于使用 : 创建的值，它很容易实现为辅助函数`make-value`：`assoc`获取名称-值对列表并返回具有给定名称的第一对。的`=>`语法`cond`将返回的对传递`assoc`给 a`lambda`的参数并执行它。

而且因为您使用的是 Racket，所以有一些语法糖可用于从另一个函数返回一个函数，为了简单起见，试试这个等效代码：

```
(define ((function lst) x)
  (foldr +
         0
         (map (lambda (e)
                (cond ((assoc e lst) => value-value)
                      (else 0)))
              x))) 
```

或这个：

```
(define ((function lst) x)
  (foldr (lambda (e a)
           (cond ((assoc e lst) => (lambda (p) (+ a (value-value p))))
                 (else a)))
         0
         x)) 
```

无论如何，结果如预期：

```
((function (list (make-value 'value1 10) (make-value 'value2 20)))
 (list 'value1 'value2 'nothing 'value1))
=> 40 
```

# android-ndk - Android NDK, JNI code not working及相关疑问

> ID：14416543
> 
> 赞同：1
> 
> 时间：2013-01-19T16:52:08.747
> 
> 标签：android-ndk, java-native-interface

抱歉，对象可能看起来有点通用，但我对 Android NDK 开发没有经验，我正在尝试将 java 方法转换为本机代码，但遇到了一些问题。

原始 Java 代码不是我的，取自开源库。

我觉得我做错了与记忆和处理对象的方式有关的事情。

**i_out**是从 Java 传入的对象，我在本机方法内部设置了一些值。

这是 Android Java 代码中定义的方法签名：

```
private native int nativeXLineToRle(int i_x, int i_y, int i_len, int i_th, NyARLabeling_Rle.RleElement[] i_out, byte[] buffer, int width); 
```

这是使用 ndk-build 精细编译的代码：

```
#include <jni.h>

JNIEXPORT jint JNICALL Java_jp_androidgroup_nyartoolkit_utils_NyARRlePixelDriverYUV420Reader_nativeXLineToRle(JNIEnv * env, jint i_x, jint i_y, jint i_len, jint i_th, jobjectArray i_out, jbyteArray buffer, jint width)
{   
        int                         current = 0;
        int                         r = -1;

        int                         st = i_x + width*i_y;
        int                         x = st;
        int                         right_edge = st + i_len - 1;

        jobject                     anRleElement = (*env)->GetObjectArrayElement(env, i_out, 0);
        jclass                      rleElementClass = (*env)->GetObjectClass(env, anRleElement);

        jfieldID                    lFid = (*env)->GetFieldID(env, rleElementClass, "l", "I");
        jfieldID                    rFid = (*env)->GetFieldID(env, rleElementClass, "r", "I");

        jobject                     currentRleElement;

        jbyte*                      buf = buffer;

        while (x < right_edge) {
            if (buf[x] > i_th) {
                x++;
                continue;
            }

            r = (x - st);

            currentRleElement = (*env)->GetObjectArrayElement(env, i_out, current);

            (*env)->SetIntField(env, currentRleElement, lFid, r);

            r++;
            x++;
            while (x < right_edge) {
                if (buf[x] > i_th) {
                    (*env)->SetIntField(env, currentRleElement, rFid, r);

                    current++;
                    x++;
                    r = -1;
                    break;
                } else {
                    r++;
                    x++;
                }
            }
        }

        currentRleElement = (*env)->GetObjectArrayElement(env, i_out, current);

        if (buf[x] > i_th) {
            if (r >= 0) {
                (*env)->SetIntField(env, currentRleElement, rFid, r);
                current++;
                currentRleElement = (*env)->GetObjectArrayElement(env, i_out, current);
            }
        } else {
            if (r >= 0) {
                (*env)->SetIntField(env, currentRleElement, rFid, r+1);
            } else {
                (*env)->SetIntField(env, currentRleElement, lFid, i_len-1);
                (*env)->SetIntField(env, currentRleElement, rFid, i_len);
            }
            current++;
        }
        return current;
} 
```

**在Android 2.3.3**设备 logcat上运行代码显示如下：

```
"Signal Catcher" daemon prio=5 tid=4 RUNNABLE
  | group="system" sCount=0 dsCount=0 obj=0x4050d430 self=0x119b78
  | sysTid=2343 nice=0 sched=0/0 cgrp=default handle=2511112
  at dalvik.system.NativeStart.run(Native Method)
"GLThread" prio=5 tid=12 RUNNABLE
  | group="main" sCount=1 dsCount=0 obj=0x40532180 self=0x2b7c20
  | sysTid=2356 nice=0 sched=0/0 cgrp=default handle=2850136
  at jp.androidgroup.nyartoolkit.utils.NyARRlePixelDriverYUV420Reader.nativeXLineToRle(Native Method)
  at jp.androidgroup.nyartoolkit.utils.NyARRlePixelDriverYUV420Reader.xLineToRle(NyARAndYUV420GsRaster.java:268)
  ..............
  at com.badlogic.gdx.backends.android.surfaceview.GLSurfaceViewCupcake$GLThread.run(GLSurfaceViewCupcake.java:646) 
```

在**Android 4.1.2**设备上，我得到以下信息：

```
E/dalvikvm(3443): JNI ERROR (app bug): accessed stale weak global reference 0x7f (index 31 in a table of size 0)
E/dalvikvm(3443): VM aborting
A/libc(3443): Fatal signal 11 (SIGSEGV) at 0xdeadd00d (code=1), thread 3544 (Thread-36107) 
```

现在我很困惑所以任何帮助都会非常感激。提前致谢

弗朗切斯科

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T15:52:12.750

第 21 行是错误的。**jbyteArray**是一个对象，不能*将*其转换为**jbyte***。您应该为此使用 JNI 函数：

```
jbyte* buf = (*env)->GetByteArrayElements(env, buffer, NULL); 
```

数组应该在**return**之前被释放：

```
(*env)->ReleaseByteArrayElements(env, buffer, buf, JNI_ABORT); 
```

# audio - 在 Python 3 上播放音频文件（mp3、wav 等）的跨平台方式？

> ID：14416544
> 
> 赞同：3
> 
> 时间：2013-01-19T16:52:12.227
> 
> 标签：audio, python-3.x

我正在寻找一个库（最好是跨平台的），它可以让我在 Python 3（当前使用 3.3.0）上播放各种音频文件。

我尝试了几个选项，例如 Pyglet，但它不能在 Py3 上运行（我尝试了 alpha，它应该支持 Py3）。

有没有移植到 Python 3 的库？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-11T03:33:25.390

您可以将 PyQt4 与 Python 3 一起使用。Qt 提供了强大的跨平台多媒体框架。

[http://www.riverbankcomputing.co.uk/software/pyqt/intro](http://www.riverbankcomputing.co.uk/software/pyqt/intro)

[这](http://www.diotavelli.net/PyQtWiki/Playing%20a%20sound%20with%20QtMultimedia)是使用为 python 2 编写的 QtMultimedia 示例播放声音，但将其应用于 python 3 并不难。只需确定您的系统上安装了 pyqt4-python3 或类似文件。

[这](http://pyqt.sourceforge.net/Docs/PyQt4/qaudiooutput.html)是一个 QAudioOutput 类，可以解决您的问题。

# twitter-bootstrap - 引导日期选择器的 Knokcout 事件处理程序

> ID：14416553
> 
> 赞同：0
> 
> 时间：2013-01-19T16:52:38.310
> 
> 标签：twitter-bootstrap, knockout.js

我有一个使用淘汰赛创建的页面，似乎找不到引导日期选择器的任何事件处理程序，我查看了一些可用的流行工具，例如[eyecon](http://www.eyecon.ro/bootstrap-datepicker/)，但似乎找不到合适的将 Date 值数据绑定到我的 ViewModel 的事件处理程序。然而，我找到了一个适用于 jQueryUi 的：

```
ko.bindingHandlers.datepicker = {
        init: function (element, valueAccessor, allBindingsAccessor) {
            //initialize datepicker with some optional options
            var options = allBindingsAccessor().datepickerOptions || {};
            $(element).datepicker(options);

            //handle the field changing
            ko.utils.registerEventHandler(element, "change", function () {
                var observable = valueAccessor();
                observable($(element).datepicker("getDate"));
            });

            //handle disposal (if KO removes by the template binding)
            ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
                $(element).datepicker("destroy");
            });

        },
        update: function (element, valueAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor()),
                current = $(element).datepicker("getDate");

            if (value - current !== 0) {
                $(element).datepicker("setDate", value);
            }
        }
    }; 
```

但没有用于引导程序。我已经用我的 Viewmodel 创建了我的 WebForm 的这个[小提琴。](http://jsfiddle.net/Fumunchu/HLVfA/)任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:01:53.800

这是一个使用[bootstrap-datepicker.js](http://www.eyecon.ro/bootstrap-datepicker/)的工作（最小）版本。它应该给你一个起点：

```
 ko.bindingHandlers.datepicker = {
            init: function (element, valueAccessor, allBindingsAccessor) {
                //initialize datepicker with some optional options
                var options = allBindingsAccessor().datepickerOptions || {};
                $(element).datepicker(options).on("changeDate", function (ev) {
                    var observable = valueAccessor();
                    observable(ev.date);
                });
            },
            update: function (element, valueAccessor) {
                var value = ko.utils.unwrapObservable(valueAccessor());
                $(element).datepicker("setValue", value);
            }
        }; 
```

[http://jsfiddle.net/jearles/HLVfA/6/](http://jsfiddle.net/jearles/HLVfA/6/)

# c - 在 C 中解析 HTML 文件 - libxml2 的替代品

> ID：14416555
> 
> 赞同：1
> 
> 时间：2013-01-19T16:52:42.100
> 
> 标签：c, web-crawler, libxml2

所以我想用 C 创建一个网络爬虫。几乎没有任何库支持这个。
我可以使用**libtidy**将 HTML 转换为 XHTML，并使用**libcurl**获取 HTML 文件（它有不错的文档）。

我的问题是解析 HTML 文件并获取其中存在的所有链接。我知道有**libxml2** ，但它非常难以理解，因为它的 API 没有好的文档。

我什至应该用 C 来做这件事，还是用另一种语言，比如 Java？**或者libxml2**有什么好的替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:12:54.117

解析 HTML 基本上只需要字符串操作。

但是如果没有 HTML 或 XML（如果是 XHTML）解析器，就很难做到。

至于问题的第二部分，我不会为此类任务选择 C，因为即使是基本的字符串操作也比许多其他原生支持它们的语言复杂得多。

我会选择一种脚本语言，例如 Python、JavaScript、PHP ......

您将调用 curl 作为命令行工具，而不是使用 libcurl。

顺便说一句：libcurl 文档非常好（在我看来）。

# android - 获取偏好屏幕（）

> ID：14416561
> 
> 赞同：2
> 
> 时间：2013-01-19T16:53:41.193
> 
> 标签：android

我需要检查一个值并以编程方式启用或禁用“复选框首选项”。我使用此代码，但 getPreferenceScreen() 想要一个方法，但我不知道使用哪种方法。（我在 android 2.1 上使用它）。

```
 <CheckBoxPreference
                        android:enabled="true"
                        android:title="Now"
                        android:defaultValue="false"
                        android:key="keep" />

protected void check(){

        // read values

        if (values){
getPreferenceScreen().findPreference("checkbox-preference-key").setEnabled(true);
        }
        else {
getPreferenceScreen().findPreference("checkbox-preference-key").setEnabled(false); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T17:09:47.407

改为使用`getPreferenceManager()`。

所以你的代码现在看起来像：

```
getPreferenceManager().findPreference("keep").setEnabled(values); 
```

这相当于

```
if (values){
  getPreferenceManager().findPreference("keep").setEnabled(true);
}
else {
  getPreferenceManager().findPreference("keep").setEnabled(false);
} 
```

# html - Bootstrap：使用 .pull-right 无需硬编码负边距顶部

> ID：14416563
> 
> 赞同：28
> 
> 时间：2013-01-19T16:53:54.813
> 
> 标签：html, css, twitter-bootstrap

这是我的代码（请[在此处](http://jsfiddle.net/SyjjW/)查看小提琴）：

```
<div class='container'>
    <div class='hero-unit'>
        <h2>Welcome</h2>

        <p>Please log in</p>
        <div id='login-box' class='pull-right control-group'>
            <div class='clearfix'>
                <input type='text' placeholder='Username' />
            </div>
            <div class='clearfix'>
                <input type='password' placeholder='Password' />
            </div>
            <button type='button' class='btn btn-primary'>Log in</button>
        </div>
    </div>
</div> 
```

我想`#login-box`拥有`.pull-right`并处于与`p`. 我可以使用`margin-top: -100px`，但感觉不对。

如果没有硬编码负片，我怎么能有`#login-box`相同的高度？`p``margin-top`

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-01-19T16:58:40.037

浮动元素将在它们通常在布局中的行处呈现。要解决此问题，您有两种选择：

将标题和登录框后的 p 移动：

```
<div class='container'>
    <div class='hero-unit'>

        <div id='login-box' class='pull-right control-group'>
            <div class='clearfix'>
                <input type='text' placeholder='Username' />
            </div>
            <div class='clearfix'>
                <input type='password' placeholder='Password' />
            </div>
            <button type='button' class='btn btn-primary'>Log in</button>
        </div>

        <h2>Welcome</h2>

        <p>Please log in</p>

    </div>
</div> 
```

或者将左块包含在一个拉左 div 中，并在底部添加一个 clearfix

```
<div class='container'>
    <div class='hero-unit'>

        <div class="pull-left">

          <h2>Welcome</h2>

          <p>Please log in</p>

        </div>

        <div id='login-box' class='pull-right control-group'>
            <div class='clearfix'>
                <input type='text' placeholder='Username' />
            </div>
            <div class='clearfix'>
                <input type='password' placeholder='Password' />
            </div>
            <button type='button' class='btn btn-primary'>Log in</button>
        </div>

        <div class="clearfix"></div>

    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T16:58:19.503

只要放在`#login-box`前面`<h2>Welcome</h2>`就可以了。

```
<div class='container'>
    <div class='hero-unit'>
        <div id='login-box' class='pull-right control-group'>
            <div class='clearfix'>
                <input type='text' placeholder='Username' />
            </div>
            <div class='clearfix'>
                <input type='password' placeholder='Password' />
            </div>
            <button type='button' class='btn btn-primary'>Log in</button>
        </div>
        <h2>Welcome</h2>

        <p>Please log in</p>

    </div>
</div> 
```

这里是 jsfiddle [http://jsfiddle.net/SyjjW/4/](http://jsfiddle.net/SyjjW/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:11:35.827

将 h2 保持在顶部，然后在 p 上向左拉，在登录框上向右拉

```
<div class='container'>
  <div class='hero-unit'>

    <h2>Welcome</h2>

    <div class="pull-left">
      <p>Please log in</p>
    </div>

    <div id='login-box' class='pull-right control-group'>
        <div class='clearfix'>
            <input type='text' placeholder='Username' />
        </div>
        <div class='clearfix'>
            <input type='password' placeholder='Password' />
        </div>
        <button type='button' class='btn btn-primary'>Log in</button>
    </div>

    <div class="clearfix"></div>

  </div>
</div> 
```

浮动框的默认垂直对齐是基线，因此“请登录”与“用户名”完全一致（通过将右拉更改为左拉来检查）。

# windows - 运行 SML 文件但不处于交互模式

> ID：14416571
> 
> 赞同：10
> 
> 时间：2013-01-19T16:54:23.117
> 
> 标签：windows, sml

我在 Windows 上使用新泽西 SML。如果`test.sml`是 SML 文件，我可以通过在 Windows 命令提示符下运行它来执行它：

```
C:\> sml test.sml 
```

然后我得到通常的 SML 输出和一个新的 SML 命令提示符。

```
Standard ML of New Jersey v110.75 [built: Sat Sep 29 12:51:13 2012]
[opening hw1.sml]
val d2 = (1,1) : int * int
val d3 = (1,1) : int * int
val d4 = (2,1) : int * int
val d5 = (1,2) : int * int
val x7 = true : bool
- 
```

我想要的是退出回到 Windows 命令提示符，而不是留在 SML 交互模式。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-19T17:17:28.810

你试过了吗：

```
sml <test.sml 
```

除此之外，使用它的编译管理器 (CM) SML/NJ 实际上允许您将程序编译成二进制文件并单独运行它们。该[手册](http://smlnj.org/doc/CM/new.pdf)应该能够告诉您更多信息（尤其参见第 15 节描述 ml-build 命令）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T17:21:47.233

以这种方式运行 SML/NJ，它将打开 REPL（读取-评估-打印-循环）。因此它会等待新的声明来解释，直到你告诉它退出。

根据 SML/NJ 关于[使用](http://www.smlnj.org/doc/FAQ/usage.html)的常见问题解答，然后

> OS.Process.exit 函数是从程序中退出 sml 的正确方法。

它需要`OS.Process.success`或`OS.Process.failure`作为参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-10T02:59:11.480

您也可以从命令行：

`Ctrl`-`C`中断（如果循环不会退出等......）

`Ctrl`-`Z`退出 REPL

# c++ - 如何在 Visual C++ 2012 年 11 月 CTP 中使用 C++11 功能，例如委托构造函数？

> ID：14416574
> 
> 赞同：-1
> 
> 时间：2013-01-19T16:54:29.680
> 
> 标签：c++, visual-c++, c++11, constructor, visual-studio-2012

我在 2012 年 11 月安装了 Visual c++ CTP，但似乎我做错了什么，因为我仍然无法使用*委托构造函数*

1.  我将平台工具集设置为：Microsoft Visual C++ Compiler Nov 2012 CTP (v120_CTP_Nov2012)

2.  这是我的代码：

    ```
    #pragma once

    #include<string>

    class Hero
    {
    private:
        long id;
        std::string name;
        int level;
        static long currentId;
        Hero(const Hero &hero); //disable copy constructor
        Hero& operator =(const Hero &hero); //disable assign operator
    public:
        Hero();
        Hero(std::string name, int level);
        long GetId() const { return this->id; }
        std::string GetName() const { return this->name; }
        int GetLevel() const { return this->level; }
        void SetName(std::string name);
        void SetLevel(int level);
    }; 
    ```

PS：任何关于 c++11 和 Visual Studio 2012 的提示都非常受欢迎。谢谢。

LE：这是实现文件：

```
#include"Hero.h"

long Hero::currentId = 0;

Hero::Hero(std::string name, int level):name(name), level(level), id(++currentId) 
{

}

Hero::Hero():Hero("", 0)
{

}

void Hero::SetName(const std::string &name) 
{
    this->name = name; 
}

void Hero::SetLevel(const int &level) 
{
    this->level = level; 
} 
```

我在无参数构造函数上收到以下错误消息：“Hero”不是类“Hero”的非静态数据成员或基类

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T02:44:03.627

您引用的错误消息是由 IntelliSense 报告的，它还不支持新的 C++11 语言功能。请注意，错误消息的全文如下（强调我的）：

> **IntelliSense**：“Hero”不是“Hero”类的非静态数据成员或基类

[11 月 CTP 的公告](http://blogs.msdn.com/b/vcblog/archive/2012/11/02/visual-c-c-11-and-the-future-of-c.aspx)指出（重点是我的）：

> 虽然提供了一个新的平台工具集以方便将编译器集成为 Visual Studio 2012 构建环境的一部分，**但 VS 2012 IDE、Intellisense、调试器、静态分析和其他工具基本保持不变，尚未提供对这些新的支持C++11 特性。**

*11 月 CTP 更新的*编译器拒绝代码并出现以下错误：

```
error C2511: 'void Hero::SetName(const std::string &)' : overloaded member function not found in 'Hero'
    c:\jm\scratch\test.cpp(6) : see declaration of 'Hero'
error C2511: 'void Hero::SetLevel(const int &)' : overloaded member function not found in 'Hero'
    c:\jm\scratch\test.cpp(6) : see declaration of 'Hero' 
```

这些错误是意料之中的，因为您的代码格式错误（`SetLevel`和的参数`SetName`在其内联声明中按值传递，并在其定义中按引用传递）。修复这些错误后，编译器将接受您的代码。

# c++ - 停止相机中的Y轴反转

> ID：14416577
> 
> 赞同：0
> 
> 时间：2013-01-19T16:55:06.003
> 
> 标签：c++, algorithm, opengl, matrix, openframeworks

我有一个程序，我在屏幕上绘制了一个简单的矩形。当我将矩形放在诸如 a 之类的相机内时`ofEasyCam`，它会将矩形的位置转换为屏幕的中心。此外，它垂直翻转图形并给我一个矩形的倒置图。

屏幕上有很多对象，所有对象都出现倒置。如何防止相机旋转 Y 轴以使我的对象按原样显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T14:52:25.523

发现此[链接](http://dev.openframeworks.cc/pipermail/of-dev-openframeworks.cc/2011-May/003207.html)表明可能存在错误，建议的解决方案是执行以下操作：

```
cam.setScale(1, -1, 1); 
```

它还提到当他们尝试“ofEasyCam - 在 ofFbo 内”时发生这种情况

# php - 仅在使用 CI 活动记录的 DATE 数据类型列中选择月份部分？

> ID：14416579
> 
> 赞同：1
> 
> 时间：2013-01-19T16:55:24.857
> 
> 标签：php, mysql, codeigniter, activerecord

如何使用 CodeIgniter 的活动记录类仅在 DATE 数据类型列中选择月份部分？我的查询是什么？

我也很困惑我需要使用什么，.. LIKE 或 WHERE 子句？

请给我例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:59:15.477

试试这个片段，

```
$where = "MONTH(dateColumn) = 4"; // comparing on April
$this->db->where($where); 
```

*   [月](http://dev.mysql.com/doc/en/date-and-time-functions.html#function_month)

根据`Active Record`Doc，`WHERE`方法的用途。

*   简单的键/值方法
*   自定义键/值方法
*   关联数组法
*   自定义字符串（*即上面的示例*）

来源

*   [活动记录类](http://ellislab.com/codeigniter/user-guide/database/active_record.html#select)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:00:18.563

您可以使用[`month`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month)：

```
MONTH(urdate) = 4 
```

# c# - 如何创建和调用操作 当我只知道 T 在运行时？

> ID：14416581
> 
> 赞同：0
> 
> 时间：2013-01-19T16:55:50.290
> 
> 标签：c#, .net, c#-4.0, delegates

`Action<T>`当我在运行时将委托作为对象接收并且我只在运行时知道类型时，如何创建和调用委托？

例如，在 Foo 中，我定义了我的委托，并希望将它传递给一个方法，该方法接收一个`Action<int>`作为对象的对象，以及要传递给委托的数据。我知道这是人为的，但这是为了证明我的问题。

```
public void Foo()
{
    Action<int> handler = i => Console.WriteLine(i + 1);
    Process(handler,4)
}

public void Process(object myDelegate, object data)
{

} 
```

我想打电话

```
myDelegate(data) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:03:01.953

所以也许是这样：

```
 public void processAction<T>(Action<T> action, T item) {
        action(item);            
    }

        Action<int> customAction = (i) => Console.WriteLine(i);
        processAction(customAction, 123);

        Action<string> customAction2 = (s) => Console.WriteLine(s);
        processAction(customAction2, "Frank Borland"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T17:35:27.540

所有委托类型（例如`Action<string>`）实际上都是具有`Invoke(...)`方法的类型。

您应该寻找带有反射的调用方法并调用它，它相对较慢 - 所以要小心。

这应该这样做：

```
Action<string> action = s => Console.WriteLine("Hello " + s);
object obj = action;
// Invoking
obj.GetType ().GetMethod ("Invoke").Invoke (obj, new object[] {"World"}); 
```

这也有效，我不知道什么更快，你应该检查一下：

```
Action<string> action = s => Console.WriteLine("Hello " + s);
Delegate obj = action;
obj.DynamicInvoke(new [] { "World" }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T18:04:23.457

这应该工作

```
Action<int> handler = i => Console.WriteLine(i + 1);
Process(handler, 4);

public void Process(object myDelegate, object data)
{
    ((Delegate)myDelegate).DynamicInvoke(data);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T17:18:54.450

您在这里没有给出很多上下文，但是您不能将`Process`方法重写为：

```
public void Process<T>(Action<T> myDelegate, T data)
{
    myDelegate(data);
} 
```

# matlab - 在循环中更改变量名

> ID：14416582
> 
> 赞同：3
> 
> 时间：2013-01-19T16:55:56.967
> 
> 标签：matlab, for-loop, matrix

这是我的问题 [从现有矩阵中提取矩阵](https://stackoverflow.com/questions/14379451/extract-matrix-from-existing-matrix)的延续 现在我通过代码将这些矩阵分开***（不正确！）***

```
for i = 3:-1:0
    mat = m((sum((m == 0), 2)==i),:)
end 
```

**以上部分是对我原来的问题的更新，**
我想相应地命名它，比如

```
mat1
mat2
mat3
mat4 
```

有人可以建议一个简单的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T20:29:29.123

根据@Jonas 和@Clement-J. 的建议，以下是玩具如何使用`cell`s 和`struct`s：

```
N = 10; % number of matrices
cell_mat = cell(1, N); % pre allocate (good practice)
for ii = 1 : 10
    cell_mat{ii} = rand( ii ); % generate some matrix for "mat"
    struct_mat.( sprintf( 'mat%d', ii ) ) = rand( ii );
end 
```

结构（[带有变量字段名称](http://blogs.mathworks.com/loren/2005/12/13/use-dynamic-field-references/)）的好处是你`save`可以

保存（'myMatFile.mat'，'struct_mat'，'-struct'）；

并且您将在-file中有变量`mat1`，... ！凉爽的！`mat10``mat`

**一些好的编码实践：**

1.  在 Matlab 中预分配矩阵和数组。在循环内更改变量大小确实会减慢 Matlab 的速度。

2.  不要将`i`and用作循环变量（或根本用作变量），因为它们被Matlab`j`用作。`sqrt(-1)`

3.  为什么要使用带有变量名的变量？你需要有一个**非常好的**理由这样做！请描述你想要达到的目标，我相信你会在这里得到更好、更优雅的解决方案......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T17:02:35.627

这是一种使用`eval`and`sprintf`函数的方法。请参阅两者的文档以了解有关它们的更多信息。

```
for count = 1:10
    eval(sprintf('mat%d = zeros(count);',count));
end 
```

# php - 加载新视图不会更改 URL，并且用户可以在 CodeIgniter 下重新发送数据

> ID：14416585
> 
> 赞同：0
> 
> 时间：2013-01-19T16:56:21.707
> 
> 标签：php, codeigniter, http-post, codeigniter-2

> **可能重复：**
> [阻止浏览器重新发送帖子变量](https://stackoverflow.com/questions/9958590/keep-browser-from-resending-post-variables)

当我在某些处理完成后尝试加载视图时，URL 不会改变，如果用户不小心刷新了页面，他将重新发送请求，并将再次处理所有请求。

我加载一个视图并将一些数据传递给它。所以我不能使用重定向。我怎么解决这个问题？

```
 $data['message'] = 'value1';
    $data['another_message'] = 'value2';
    $this->load->view('my_view', $data); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:58:06.753

为此，您需要使用[POST/REDIRECT/GET 模式](http://community.developer.authorize.net/t5/The-Authorize-Net-Developer-Blog/Handling-Online-Payments-Part-6-Preventing-Duplicate-Submissions/ba-p/11168)。

# google-chrome - 如何将灯箱添加到 Chrome 扩展程序中的上下文菜单

> ID：14416591
> 
> 赞同：1
> 
> 时间：2013-01-19T16:57:07.967
> 
> 标签：google-chrome, google-chrome-extension, contextmenu, lightbox, slimbox

我正在构建一个基于上下文菜单的 Chrome 扩展。当用户选择链接或突出显示文本时，将出现扩展名（“contexts”：[“selection”，“link”] ...）。

一旦用户单击所需的选项，我怎么知道要调出灯箱或超薄箱效果以使 iframe 具有基于传递的参数的搜索结果？

示例：在 Chrome 中浏览时在任何页面中选择文本“hello world” >> 右键单击​​以显示我的上下文菜单扩展 >> 已选择选项 1 >> 灯箱或 slimbox 将出现，并且 iframe 显示所选的谷歌搜索结果之前的文字（你好世界）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-27T06:30:11.850

以下是如何执行此操作的摘要：

1.  请求必要的权限，例如内容脚本权限
2.  添加上下文菜单项。
3.  在上下文菜单项的 onclick 处理程序中，向内容脚本发送消息，如下所示：

    ```
    chrome.tabs.query({active: true, currentWindow: true}, function(tabs) {
        chrome.tabs.sendMessage(tabs[0].id, {"action": "startLightbox"});
     }); 
    ```

4.  让内容脚本向页面添加一个灯箱。

    ```
    chrome.runtime.onMessage.addListener(
       function(request, sender, sendResponse) {
          if ( request.action == "startLightbox" ) {
             //code for lightbox here
          }
        }) 
    ```

当我试图自己弄清楚时，我遇到了你的问题。一旦我想通了，我想我会分享它。[这是我的教程，里面有详细的说明](http://bryangentry.us/make-google-chrome-extension-launch-lightbox-user-clicks-context-menu/)。

# twitter-bootstrap - 将 bootstrap datepicker 与 knockoutjs 绑定

> ID：14416592
> 
> 赞同：10
> 
> 时间：2013-01-19T16:57:12.143
> 
> 标签：twitter-bootstrap, knockout.js

我想使用引导日期选择器并将所选日期与 knockoutjs 绑定。

使用日期选择器的函数：

```
$(function() {

    // create the departure date
    $('#depart-date').datepicker({
        autoclose: true,
        format: 'yyyy/mm/dd',
    }).on('changeDate', function(ev) {
        ConfigureReturnDate();
    });

    $('#return-date').datepicker({
        autoclose: true,
        format: 'yyyy/mm/dd',
        startDate: $('#depart-date').val()
    });

    // Set the min date on page load
    ConfigureReturnDate();

    // Resets the min date of the return date
    function ConfigureReturnDate() {
        $('#return-date').datepicker('setStartDate', $('#depart-date').val());
    }

}); 
```

这是我想使用的小提琴，但不知道如何去做。 [http://jsfiddle.net/zNbUT/276/](http://jsfiddle.net/zNbUT/276/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T20:08:52.973

我找到了一个可以帮助我的小提琴 [http://jsfiddle.net/jearles/HLVfA/6/](http://jsfiddle.net/jearles/HLVfA/6/)

小提琴的功能：

```
 ko.bindingHandlers.datepicker = {
        init: function (element, valueAccessor, allBindingsAccessor) {
            //initialize datepicker with some optional options
            var options = allBindingsAccessor().datepickerOptions || {};
            $(element).datepicker(options).on("changeDate", function (ev) {
                var observable = valueAccessor();
                observable(ev.date);
            });
        },
        update: function (element, valueAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor());
            $(element).datepicker("setValue", value);
        }
    }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-26T14:41:39.177

我也使用了[bootstrap-datepicker.js](http://www.eyecon.ro/bootstrap-datepicker/)，但方式不同：

我的视图模型：

```
 var MyDataViewModel = {
     //Set Todays Date
     StartDate: ko.observable(new Date())
 } 
```

我的 HTML：

```
<div id="dtpDate" class="input-append">
    <input required="required" id="txtdtpDate" data-format="yyyy-MM-dd" type="text" style="width: 75%;" />
    <span class="add-on"><i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
    </span>
</div> 
```

以及使它起作用的JS：

```
$(function () {
    $('#dtpDate').datetimepicker({
        pickTime: false
        })
        .on('changeDate', function (ev) {
            //Date.Subtring(1,10) for formatting purposes
            MyDataViewModel.StartDate(ko.toJSON(ev.date).substr(1, 10));
        });
    });
}); 
```

这对我来说非常有用

# sql-server - 非平凡查询

> ID：14416593
> 
> 赞同：0
> 
> 时间：2013-01-19T16:57:14.127
> 
> 标签：sql-server, sql-order-by

我需要写一个查询。有 3 个表，一个主表和两个关联表，例如：

```
main_table
id   name
--   -------------
1    example
2    example2

join_table1
id   main_table_id
--   -------------
 1     1

join_table2
id   main_table_id
--   -------------
1      2 
```

如果 main_table_id 包含在 join_table1 中，
我需要按 join_table1.id 排序，否则如果 main_table_id 包含在 join_table2 中，
我需要按 join_table2.id 排序

如何进行此类查询
main_table_id 的任何想法都可以在表 join_table1 或 join_table2
数据库中 - SQL Server

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:59:50.913

您应该结合[合并](http://msdn.microsoft.com/en-us/library/ms190349.aspx)和左连接。查询将如下所示：

```
select ...
from main_table
left outer join join_table1 j1 on ...
left outer join join_table2 j2 on ...
order by coalesce( j1.id, j2.id ) 
```

# python - 多变量列表理解

> ID：14416596
> 
> 赞同：10
> 
> 时间：2013-01-19T16:57:28.923
> 
> 标签：python, list, list-comprehension

我正在研究[Project Euler #35](http://projecteuler.net/problem=35)，我需要找到一个数字的循环排列。使用`itertools`，我可以很容易地得到一个数字的排列。但是，我想用列表推导来做到这一点（因为它看起来更像 Pythonic；我也在尝试熟悉列表推导）。

我发现所有的圆形素数只能包含数字 1、3、7 和 9（这不包括 2 和 5，它们根据定义是圆形素数）。如果任何其他数字在数字（0、2、4、5、6 或 8）中，则其中一个排列将不是质数（因为该数字将在至少一个排列中的最后一个）。

因此，我尝试这样做：

```
from itertools import permutations
l = [x for x in list(permutations('1397', y)) for y in range(7)] 
```

我需要使用`y for y in range(7)`，以便获得不同长度的排列。

然而，这给了我一个`TypeError`：

```
Traceback (most recent call last):
  File "<pyshell#23>", line 1, in <module>
    l = [x for x in list(permutations('1397', y)) for y in range(7)]
TypeError: an integer is required 
```

这可行，但它没有在一个列表理解中使用两个变量：

```
l = []
for y in range(7):
    l.append([x for x in list(permutations('1379', y))]) 
```

如何进行双变量列表理解？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-19T17:00:01.683

该`for y in range(7)`部分应位于排列循环之前。：

```
l = [x for y in range(7) for x in list(permutations('1397', y))] 
```

上面的列表理解等价于：

```
In [93]: l = []

In [94]: for y in range(7):
    ...:     l.extend(list(permutations('1397', y))) 
```

例如：

```
In [76]: l = [x for y in range(3) for x in list(permutations('1397', y))]

In [77]: l
Out[77]: 
[(),
 ('1',),
 ('3',),
 ('9',),
 ('7',),
 ('1', '3'),
 ('1', '9'),
 ('1', '7'),
 ('3', '1'),
 ('3', '9'),
 ('3', '7'),
 ('9', '1'),
 ('9', '3'),
 ('9', '7'),
 ('7', '1'),
 ('7', '3'),
 ('7', '9')] 
```

`list-comprehension`以及您的工作示例的版本，

```
l = []
for y in range(7):
    l.append(list(permutations('1397', y))) 
```

是：

```
In [85]: l = [list(permutations('1397', y)) for y in range(3)]

In [86]: l
Out[86]: 
[[()],
 [('1',), ('3',), ('9',), ('7',)],
 [('1', '3'),
  ('1', '9'),
  ('1', '7'),
  ('3', '1'),
  ('3', '9'),
  ('3', '7'),
  ('9', '1'),
  ('9', '3'),
  ('9', '7'),
  ('7', '1'),
  ('7', '3'),
  ('7', '9')]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:01:35.497

```
[list(permutations('1397',x)) for x in range(7)] 
```

# objective-c - 从 -(IBAction) 调用 +(void) 方法

> ID：14416597
> 
> 赞同：-1
> 
> 时间：2013-01-19T16:57:35.757
> 
> 标签：objective-c, cocoa

首先，如果标题有误导性，请见谅。这实际上是我第一次使用 Xcode 进行创作，所以我可能有点不理解所有东西的名称等等。

所以，我有一堂课，有几个`IBAction`，像这样：

```
// AppController.h

#import <Foundation/Foundation.h>

@interface AppController : NSObject {

}

+ (void)addItem;

- (IBAction)addButton:(id)sender;

@end 
```

和：

```
// AppController.m

#import "AppController.h"

@implementation AppController

+ (void)addItem {
    NSLog("Action");
}

- (IBAction)addButton:(id)sender {
    [[self class] addItem];
} 
```

当我运行应用程序并单击触发 的按钮时`IBAction`，应用程序挂起并且 Xcode 窗口被选中，行上有一个绿色的“断点” `NSLog(...)`。

我不知道这种反应叫什么，也不知道我应该怎么做。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:01:31.430

```
NSLog("Action"); 
```

的第一个参数`NSLog()`必须是`NSString`，而不是 C 字符串 ( `char *`)。你错过了这个`@`角色：

```
NSLog(@"Action"); 
```

是正确的做法。

编辑：如果它只是一个错字，并且在修复它之后，问题仍然存在：那么你很可能在该特定行上设置了一个断点。删除或禁用断点以使程序能够继续。

# jquery-mobile - jQuery Navbar“持久工具栏”即使是简单的例子也不起作用 - 我做错了什么？

> ID：14416598
> 
> 赞同：1
> 
> 时间：2013-01-19T16:57:43.097
> 
> 标签：jquery-mobile, navbar

我正在尝试实现 `navbar`“持久工具栏”，因此我需要定义一次导航栏。

参考：http: [//jquerymobile.com/demos/1.2.0/docs/toolbars/footer-persist-a.html](http://jquerymobile.com/demos/1.2.0/docs/toolbars/footer-persist-a.html)

（您需要`data-id="the same"`在每个页面上定义）

首先我直接投入到我的开发中，没有任何工作，而且我看到它似乎也不适用于简单的案例，我尝试了各种组合。

以下代码的宽度可能是什么错误？Navivagtion 导致第二页，但不是那里的工具栏。

代码：

```
<body>
<div data-role="page" id="page" data-id="stHedaer>
    <div data-role="header">
        <h1>Page One</h1>
        <div data-role="navbar"  data-position="fixed">
            <ul>
                <li><a href="#p2">page2</a></li>
                <li><a href="#p3">page3</a></li>
            </ul>
        </div>
    </div>
    <div data-role="content"> Page one </div>
    <div data-role="footer">
        <h4>Page Footer</h4>
    </div>
</div>
<div data-role="page" id="p2"  data-id="stHedaer">
    <div data-role="header" >
        <h1>Page Two</h1>
    </div>
    <div data-role="content"> Content </div>
    <div data-role="footer">
        <h4>Page Footer</h4>
    </div>
</div>
<div data-role="page" id="p3"  data-id="stHedaer" >
    <div data-role="header">
        <h1>Page Three</h1>
    </div>
    <div data-role="content"> Content </div>
    <div data-role="footer">
        <h4>Page Footer</h4>
    </div>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:15:30.250

必须仔细阅读 jQM 文档。如果你想在每一页上都有导航栏，你需要把它放在每一页上。和：

```
...data-position="fixed" data-id="footer"... 
```

在页眉和页脚一个like。

这是一个工作示例：http: [//jsfiddle.net/Gajotres/Beq4H/](http://jsfiddle.net/Gajotres/Beq4H/)

```
<!DOCTYPE html>
<html>
<head>
  <title>Share QR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>       
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
  <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>

  <div data-role="page" id="home">
    <div data-role="header" data-theme="b" data-position="fixed" data-id="footer">
      <a href="#home" data-icon="home" data-iconpos="notext">Home</a>
      <h1>Share QR</h1>
    </div>
    <div data-role="content">
      <p>Hello world!</p>
    </div>
    <div data-role="footer" data-theme="b" data-position="fixed" data-id="footer">
        <div data-role="navbar">
            <ul>
                <li><a href="#about" data-transition="slide">page2</a></li>
                <li><a href="#about" data-transition="slide">page3</a></li>
            </ul>
        </div>
    </div>
  </div>

  <div data-role="page" id="about">
    <div data-role="header" data-theme="b" data-position="fixed" data-id="footer">
      <a href="#home" data-icon="home" data-iconpos="notext">Home</a>
      <h1>About</h1>
      <a href="#home" data-icon="arrow-l" data-rel="back">Back</a> 
    </div>
    <div data-role="content">
      <p>Share your favorite URLs with other mobile phone users through QR codes.</p>
    </div>
    <div data-role="footer" data-theme="b" data-position="fixed" data-id="footer">
        <div data-role="navbar">
            <ul>
                <li><a href="#home" data-transition="slide">page2</a></li>
                <li><a href="#home" data-transition="slide">page3</a></li>
            </ul>
        </div>
    </div>
  </div>

</body>
</html> 
```

# php - PDO PHP bindValue 不起作用

> ID：14416601
> 
> 赞同：7
> 
> 时间：2013-01-19T16:57:58.867
> 
> 标签：php, mysql, pdo, bindvalue

我知道这已经被问了 1000 次，但由于某种原因，我继续用头撞墙。

这有效：

```
$sql = 'SELECT a.eventCode, a.eventTime, a.teamCode, a.playerCode, b.lastName, b.firstName, b.number, a.xCoord, a.yCoord, a.id ';
$sql = $sql . 'FROM events a, players b ';
$sql = $sql . 'WHERE a.regGUID in ( ' . $regGUID . ' ) and ';
$sql = $sql . 'a.playerCode=b.playerCode and a.gameCode = "' . $game . '" order by a.eventTime desc, a.actionCode asc'; 
$stmt = $db->prepare($sql);
$results = $stmt->execute(); 
```

这不会：

```
$sql = 'SELECT a.eventCode, a.eventTime, a.teamCode, a.playerCode, b.lastName, b.firstName, b.number, a.xCoord, a.yCoord, a.id ';
$sql = $sql . 'FROM events a, players b ';
$sql = $sql . 'WHERE a.regGUID in ( :regGUID ) and ';
$sql = $sql . 'a.playerCode=b.playerCode and a.gameCode = :game order by a.eventTime desc, a.actionCode asc'; 
$stmt = $db->prepare($sql);
$stmt->bindValue(':regGUID', $regGUID, PDO::PARAM_STR);
$stmt->bindValue(':game', $game, PDO::PARAM_STR);
$results = $stmt->execute(); 
```

我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:18:49.163

问题在这里：

```
$sql = $sql . 'WHERE a.regGUID in ( :regGUID ) and ';
$stmt->bindValue(':regGUID', $regGUID, PDO::PARAM_STR); 
```

我假设 $regGUID 是逗号分隔的引号字符串列表。

**每个查询参数只接受一个标量值。不是值*列表*。**

所以你有两个选择：

1.  继续插入 $regGUID 字符串，即使您将参数用于其他标量值。但是您仍然要小心避免 SQL 注入，因此您必须正确形成 $regGUID 字符串。您不能只对整个字符串调用 PDO::quote() ，这会使它成为包含 UUID 和逗号的单引号字符串。您必须确保每个 UUID 字符串都被单独转义和引用，然后将列表内爆在一起并将其插入到 IN 子句中。

    ```
    $regGUIDs = explode(',', $regGUID);
    $regGUIDs = array_map(function ($g) { return $db->quote($g); }, $regGUIDs);
    $regGUID = implode(',', $regGUIDs);
    $sql = $sql . 'WHERE a.regGUID in (' . $regGUID . ') and '; 
    ```

2.  `explode()`将 $regGUID 放入一个数组中，并为数组中的每个元素添加一个查询参数。插入查询参数占位符的动态列表。

    ```
    $regGUIDs = explode(',', $regGUID);
    $params = array_fill(1, count($regGUIDs), '?');
    $sql = $sql . ' WHERE a.regGUID in ( ' . implode(',', $params) . ' ) and '; 
    ```

您可以在数组的循环中使用 bindValue()，但请记住，其他参数也应按位置绑定，而不是按名称绑定。当您尝试在同一个查询中混合使用两种不同样式的参数时，PDO 有一些错误会导致它不高兴。

我只是将一组参数值传递给 PDOStatement::execute()，而不是使用 bindValue()，这要容易得多。

```
$paramValues = $regGUIDs;
$paramValues[] = $game;
$results = $stmt->execute($paramValues); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:04:50.390

这确实被问了 1000 次。

准备好的语句只能接受**标量值**，不能接受 SQL 查询的任意部分。

您必须使用尽可能多的占位符形成 IN() 语句，您必须放入尽可能多的项目，然后将它们一一绑定。

为了简化这项任务，可以使用一些辅助功能。

比如说，使用[SafeMysql 库](https://github.com/colshrapnel/safemysql/blob/master/safemysql.class.php)，这段代码可以写成

```
$sql  = 'SELECT * FROM events a, players b WHERE regGUID in (?a) and';
$sql .= ' a.playerCode=b.playerCode and a.gameCode = ?s';
$sql .= ' order by a.eventTime desc, a.actionCode asc'; 
$results = $db->getAll($sql,$regGUID,$game); 
```

请注意，它`$regGUID`应该是一个数组，而不是字符串，并且`$results`已经包含所有请求的数据，无需任何进一步处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T17:06:06.600

内容是`$regGUID`什么？由于您使用的是`in`子句，我怀疑是逗号分隔的列表。

将变量绑定到参数与将字符串替换到查询中不同；这就像告诉 MySQL 如何使用您的实际 PHP 变量。因此，如果您将类似字符串绑定`'1,2,3'`到查询参数，它会保留为一个字符串，并且不会重新解释为数字列表。

因此，如果`$regGUID`是类似的东西`"'AAA1', 'BBB2'"`，你的第一个查询变成

```
... WHERE a.regGUID in ( 'AAA1', 'BBB2' ) ... 
```

但你的第二个查询更像

```
... WHERE a.regGUID in ( '\'AAA1\', \'BBB2\'' ) ... 
```

这和说的一样

```
... WHERE a.regGUID = '\'AAA1\', \'BBB2\'' ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T17:18:43.353

由于其他人有状态，您只能将单个标量值绑定到占位符。因此，这意味着您实际上需要为`IN`语句中的每个值设置一个占位符。我通常会执行以下操作。应该注意的是，虽然我从不使用`bindValue`，所以如果它有关于必须像 Mysqli 这样的引用的规则，那么可能需要修改以下内容：

```
$regGUIDPlaceholders = array();

// prepare the placeholders
// assume regGUID is an array - if its a string then explode on whatever to make it an array
foreach($regGUID as $k => $v) {
   $placeholder = ':regGUID' . $k;
   $regGUIDPlaceholders[$key] = $value;
}

// prepare the IN statememnt
$in = sprintf('IN (%s)', implode(',', array_keys($regGUIDPlaceholders)));

$sql = 'SELECT a.eventCode, a.eventTime, a.teamCode, a.playerCode, b.lastName, b.firstName, b.number, a.xCoord, a.yCoord, a.id ';
$sql = $sql . 'FROM events a, players b ';

// USE the IN statement dynamically prepared above
$sql = $sql . 'WHERE a.regGUID '. $in . ' and ';

$sql = $sql . 'a.playerCode=b.playerCode and a.gameCode = :game order by a.eventTime desc, a.actionCode asc'; 

$stmt = $db->prepare($sql);

// bind each GUID to its placeholder
foreach($regGUIDPlaceholders as $placeholder => $value) {
   $stmt->bindValue($placeholder, $value, PDO::PARAM_STR);
}

$stmt->bindValue(':game', $game, PDO::PARAM_STR);
$results = $stmt->execute(); 
```

# php - Laravel 4 中的包控制器

> ID：14416608
> 
> 赞同：5
> 
> 时间：2013-01-19T16:58:47.707
> 
> 标签：php, laravel, laravel-4

我想在我的 Laravel 4 包中包含控制器，但我无法让路由正常工作。

我遵循 Laravel 4 文档中的包说明，并让 routes.php 文件使用非控制器路由。

有人可以给我一些关于如何让包控制器在 Laravel 4 中工作的说明，我们将不胜感激。

提前致谢。

拉斯

```
// EDIT:

// routes.php

   Route::get('admin', 'Package::AdminController@index'); // Does not work

   Route::get('admin', function(){  // Works fine
       return 'Dashboard';
   }) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T23:44:41.977

我不知道您的具体情况，也不知道这是否是解决此问题的“正确”方法，但由于我遇到了同样的问题，我想我会分享我是如何解决它的。

我将包控制器放在控制器子目录中，这样我的目录结构如下所示：

```
/src
    /Vendor
        /Package
            PackageServiceProvider.php
    /config
    /controllers
    /lang
    /migrations
    /views
/tests
/public 
```

然后，我将控制器文件夹添加到我的包的 composer.json 自动加载类映射中。

```
{
    "name": "kevin-s-perrine/my-first-packge",
    "description": "",
    "authors": [
        {
            "name": "Kevin S. Perrine",
            "email": "removed@somewhere.com"
        }
    ],
    "require": {
        "php": ">=5.3.0",
        "illuminate/support": "4.0.x"
    },
    "autoload": {
        "classmap": [
            "src/migrations",
            "src/controllers"
        ],
        "psr-0": {
            "KevinSPerrine\\MyFirstPackage": "src/"
        }
    },
    "minimum-stability": "dev"
} 
```

最后，我`composer dump-autoload`在包的根目录下运行，然后在路由文件中按名称引用控制器。

```
Route::get('myfirstpackage', 'MyFirstPackageHomeController@getIndex'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T01:35:32.277

在您的包裹的服务提供商中，您是否包含了您的路线文件？我不相信 L4 会自动加载路由文件。你可以在任何地方做，但我怀疑这将是最合适的地方。

```
public function register()
{
    $this->package('vendor/pkgname');
    require __DIR__.'/../routes.php';
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-03T16:31:41.037

您还需要使用控制器的命名空间来引用控制器

```
Route::get('/admin', 'PackageNS\Package\Controllers\AdminController@getIndex'); 
```

甚至

```
Route::controller('PackageNS\Package\Controllers\AdminController', 'admin'); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-30T21:27:06.020

你做了这个了吗：

```
composer dump-autoload 
```

自动加载器需要被告知那些闪亮的新类。我还建议您检查网络服务器日志是否有错误。

# c# - 在 linq 中使用 let 关键字来组合查询

> ID：14416613
> 
> 赞同：4
> 
> 时间：2013-01-19T16:59:18.030
> 
> 标签：c#, linq

我正在编写一个查询，该查询返回需要来自两个表的数据的模型列表，我希望该`let`关键字可以帮助我。我是这样开始的：

```
var TheListOfModels = 
                let Data1 = (from a in MyDC.Table1
                              where ....
                              select new ObjectThatContainsData1()
                              {

                              }).ToList()

                let Data2  = (from b in MyDC.Table2
                              where ....
                              select new ObjectThatContainsData2()
                              {

                              }).Tolist()                 

                select new ObjectThatContainsBothData()
                { 
                     SomeProp1 = from p in Data1
                                 select everything

                     SomeProp2 = from a in Data2
                                 select everything

                }).ToList() 
```

我不太确定如何继续并编写从 2 个子句的结果中选择而不是直接从表`select`中选择的最终语句。`let`我正在编写的查询结构是一个好的起点还是应该以另一种方式编写？

谢谢。

根据评论编辑：表定义

表 1 看起来有点像这样：

```
PeachID | UserID | HarvestDateTime | SomeOtherColumn 
```

表 2 看起来像这样：

```
AppleID | UserID | HarvestDateTime | SomeOtherColumn 
```

我希望将所有桃子和苹果提取到一个列表中，`ObjectThatContainsBothData`并且 where 子句基本上是用来过滤`HarvestDateTime`和`UserID`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:59:36.427

看起来您正在尝试将 Linq 查询语法应用于序号 C# 代码。只需创建您的对象并执行两个查询即可从两个属性中获取数据：

```
var result = new ObjectThatContainsBothData() 
             {
                 SomeProp1 = db.Peaches.Where(...).Select(...).ToList(),
                 SomeProp2 = db.Apples.Where(...).Select(...).ToList()  
             }; 
```

# java - 顺序密钥生成器 (java)

> ID：14416620
> 
> 赞同：0
> 
> 时间：2013-01-19T17:00:22.230
> 
> 标签：java, key, generator, sequential

我正在尝试（按顺序）从字母 az 和 AZ、数字 0-9、其他字符（如 (){}[]~!@#$%^&*()_+`-=|\;:' "<,>.?/ 或这些集合的任何组合。但是，我真正的问题是，在找到我的基本案例之前，密钥需要增加长度。如果有人有建议或解决方案，请提供任何帮助和/或解释将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:32:46.717

如果我理解正确，您想创建一个递归单词表生成器函数，以便用您的基本情况单词检查每个单词。[这个](http://iexploit.org/index.php?p=/discussion/2965/beginner-programming-how-to-make-a-wordlist-generator/p1)网站可能会帮助你。您唯一需要做的就是编写比较这两个词的代码。

# jquery - 悬停时带有过渡的Jquery文本更改

> ID：14416631
> 
> 赞同：1
> 
> 时间：2013-01-19T17:01:47.143
> 
> 标签：jquery, fadein, fadeout

对于这个 HTML 片段：

```
<header>
<h1>Title</h1>
<h2>my first sentence</h2>
</header> 
```

我运行这个 Jquery 脚本：

```
$('header h2').hover(function(){
    $(this).text("my second sentence");
}, function() {
    $(this).text("my first sentence");
}); 
```

我想在两种状态之间添加淡入/淡出过渡。

我尝试在 $(this) 之后添加 .fadeIn("slow") 和 .fadeOut("slow") 但它不起作用。你能给我一些帮助吗？

PS：我使用 JQuery 而不是 CSS :hover 因为 CSS :before(content) 技巧不适用于过渡：cf。[悬停时更改文本，然后返回上一个文本](https://stackoverflow.com/questions/9913293/change-text-on-hover-then-return-to-the-previous-text)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:04:24.107

```
$( function() {
var fs = $('h2').text();
var ss = 'my second sentence';
$('h2').hover(function(){
    $(this).hide().text(ss).fadeIn("slow");
}, function() {
    $(this).hide().text(fs).fadeIn("slow");
});
}); 
```

对于 fadeIn() 你需要先 hide() 那个元素。我声明了两个不必要的变量，但会对您有所帮助。`var fs`（第一句）和`var ss`（第二句）。

[***小提琴***](http://jsfiddle.net/ssFpH/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T05:01:56.207

我建议：

```
// find the relevant element(s)
// assign the current text to a custom data-* attribute (for later)
$('header h2').attr('data-originalText', function () {
    // using this not $(this), since a jQuery object requires more 'work'
    return (this.textContent || this.innerText).trim();
}).hover(function () {
    // fading out the current element, replacing the text and then fading back in
    $(this).fadeOut(600, function () {
        $(this).text('my new sentence!').fadeIn();
    });
},
function () {
    // fading out the current element, replacing the text (from the data-* attribute)
    // and fading back in
    $(this).fadeOut(600, function () {
        $(this).text($(this).attr('data-originalText')).fadeIn();
    });
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/VnDDB/)。

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [`fadeIn()`](http://api.jquery.com/fadeIn/).
*   [`fadeOut()`](http://api.jquery.com/fadeOut/).
*   [`hover()`](http://api.jquery.com/hover/).
*   [`jQuery.trim()`](http://api.jquery.com/jQuery.trim/).
*   [`text()`](http://api.jquery.com/text/).

# php - 格式化 JSON 数据，以便将其正确传递给 Google 图表引擎

> ID：14416634
> 
> 赞同：0
> 
> 时间：2013-01-19T17:02:17.230
> 
> 标签：php, json, google-visualization

我试图建立一个非常简单的表：

```
Sex  %
M    40
F    60 
```

使用 php 对数组进行编码，但假设输入数据错误，则不绘制图形。你能说出问题出在哪里吗？

```
$table = array();
$table['cols'] = array(
array('label' => 'Sesso', 'type' => 'string'),
array('label' => 'Quantita', 'type' => 'number'));

$rows = array();
$temp = array();
$temp[] = array('v' => 'M'); 
$temp[] = array('v' => 60); 
$rows[] = array('c' => $temp);
$temp = array();
$temp[] = array('v' => 'F'); 
$temp[] = array('v' => 40); 
$rows[] = array('c' => $temp);

$table['rows'] = $rows;
$jsonTable = json_encode($table); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:13:42.560

如果您尝试：

```
$table = array(
   'cols' => array(
      array(
         'id' => '1',
         'label' => 'Sesso',
         'type' => 'string'
      ),
      array(
         'id' => '2',
         'label' => 'Quantita',
         'type' => 'number'
      )
   ),
   'rows' => array(
      array(
         'c' => array(
            array(
               'v' => 'M',
               'f' => 60
            )
         )
      ),
      array(
         'c' => array(
            array(
               'v' => 'F',
               'f' => 40
            )
         )
      )
   )
);

$json = json_encode($table); 
```

在他们的文档中查看 Google 的[示例。](https://developers.google.com/chart/interactive/docs/php_example)您应该针对的 JSON 结构是：

```
{
  "cols": [
        {"id":"","label":"Topping","pattern":"","type":"string"},
        {"id":"","label":"Slices","pattern":"","type":"number"}
      ],
  "rows": [
        {"c":[{"v":"Mushrooms","f":null},{"v":3,"f":null}]},
        {"c":[{"v":"Onions","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Olives","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Zucchini","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Pepperoni","f":null},{"v":2,"f":null}]}
      ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:12:55.340

这就是我所做的：

```
 $table = array(
        'cols' => array(
            array( 'id' => '', 'label' => 'Sesso', 'pattern' => '', 'type' => 'string' ),
            array( 'id' => '', 'label' => '#', 'pattern' => '', 'type' => 'number' )
        ),
        'rows' => array(
            array( 'c' => array( array( 'v' => 'Uomini', 'f' => null ), array('v' => 60, 'f' => null) ) ),
            array( 'c' => array( array( 'v' => 'Donne', 'f' => null ), array('v' => 40, 'f' => null) ) )
        )
    ); 
```

# java - 比较 Java 和 GPar

> ID：14416641
> 
> 赞同：1
> 
> 时间：2013-01-19T17:02:37.430
> 
> 标签：java, multithreading, groovy, gpars

我正在尝试为 Java 和 GPars 找到一个可比较的代码片段来可视化，GPars 是多么容易。
以下代码在这两种情况下是否相同？我不仅指输出，还指“内部”发生的事情。或者有没有办法进一步缩短它？

爪哇：

```
package java;

public class Main extends Thread {

    public void run() {
        for (int i = 1; i <= 100; i++) {
            System.out.println(i);
        }
    }

    public static void main(String args[]) {
        (new Main()).start();
    }

} 
```

时髦的：

```
import static groovyx.gpars.GParsPool.withPool

withPool{
    for(int i=1; i<=100; i++) {
        println (i)
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T23:13:12.623

第一个示例创建一个新线程，并在其中运行一个 for 循环（循环一直通过，因为该线程不是守护线程，因此 VM 在线程完成之前不会退出）

第二个示例调用`withPool`，然后对该池不执行任何操作，只是在当前线程中运行 for 循环。您没有使用任何 GPars 并发方法，因此`withPool`可以省略 以获得完全相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T18:02:58.610

您无法比较 Java（语言）和 GPars（库）。您可以比较语言和语言，或库和库。顺便说一下，GPar 可以直接从 Java 中使用。您可能的意思是将标准 java 库与 GPars 进行比较。

# java - java中的任意数组长度

> ID：14416649
> 
> 赞同：4
> 
> 时间：2013-01-19T17:03:36.040
> 
> 标签：java, arrays, biginteger

有没有办法在java中获得一个比整数数据类型支持的长度更长的数组？

我正在寻找可以在 Java 中使用大整数进行索引的东西，因为本机支持的数组长度远没有我正在实现的算法所需的那么大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:08:17.797

这个库应该对你有用：http: [//fastutil.dsi.unimi.it/](http://fastutil.dsi.unimi.it/)

它说：

> “...还提供大型（64 位）数组...”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T17:08:15.353

Int32 为您提供~~17~~ 8 GB 的存储空间。你有这么大的记忆力吗？

我认为您应该使用稀疏数组，即通过哈希索引元素。例如，仅使用`HashMap<BigInteger,YourValueType>`或使用 BigMemory 等一些库和替代品[http://terracotta.org/products/bigmemory](http://terracotta.org/products/bigmemory)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T17:07:39.090

您确定不必更改算法吗？`Integer.MAX`等于`2^31-1`，即 2147483647，每个`int`有 4 个字节给我们：8589934588 字节的内存（8GB ！！！）。

# css - 包括宽度和高度的边距

> ID：14416651
> 
> 赞同：48
> 
> 时间：2013-01-19T17:03:40.863
> 
> 标签：css

我希望框的宽度和高度默认包含所有内容、填充、边框宽度和边距。有没有办法做到这一点？特别是，我希望能够指定一些东西，比如`width: 100%`包括所有内容。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-11-12T21:33:56.953

这是一个模糊的问题，但我会尽力回答。

边距，顾名思义，就是盒子外面的区域；这意味着没有办法在你的 div 中包含边距。

如果你想在你的盒子内部有更多的填充，但你不希望盒子调整大小，那么使用：`box-sizing:content-box;`
或者如果你想包括填充**和**边框，使用：`box-sizing:border-box;`

保留 div 大小并消除溢出的可行解决方案如下所示：

```
#parent{
    box-sizing:border-box;
    width:100%;
    height:200px;
    padding:2em;
}
#child{
    box-sizing:border-box;
    width:100%;
    height:100%;
    padding:1em;
} 
```

* * *

```
<div id="parent">
   <div id="child"></div>
</div> 
```

只需将要设置边距的 div 放在另一个具有填充的 div 内。从而产生虚假的边距。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-05-27T19:02:26.873

如果您的边距是例如**10px**，您可以使用

```
width: calc(100% - 20px);
box-sizing: border-box; 
```

[浏览器支持](https://caniuse.com/#search=calc)

[w3schools.com 参考](https://www.w3schools.com/cssref/func_calc.asp)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-11-12T22:32:38.043

将 CSS`box-sizing`属性设置为`border-box`生成`width`并`height`包含内容、边框和内边距。这允许您设置`width: 100%`并仍然添加`padding`or `border`。换句话说`box-sizing: border-box`，makes`width`包括边距内边缘之间的所有内容。没有办法以这种方式包含边距本身。

```
.example { box-sizing: border-box; width: 100%; padding: 10px } 
```

### 有用的参考资料

*   [CSS 盒子模型可视化](http://ryanve.com/css/box-model/)
*   [CSS3 UI：`box-sizing`属性](http://www.w3.org/TR/css3-ui/#box-sizing)
*   [`* { box-sizing: border-box }`FTW](http://www.paulirish.com/2012/box-sizing-border-box-ftw/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-17T01:57:17.130

也许在它周围包裹另一个 div 并指定该 div 的宽度？

```
<div style="width: 100px; border: 1px solid blue;">
<div style="width: 100px; background:yellow; margin: 10px; border: 1px solid blue">
inner width 100px not including it's margin.
</div>
</div>

<div style="width: 100px; border: 1px solid blue">
<div style="background:yellow; margin: 10px; border: 1px solid blue">
  inner width's 100px including it's margin.
</div>
</div>
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-13T15:29:44.183

用于`display: flex;`父标签。

例如：

```
<!DOCTYPE html>
<html>
<head>
<style>
.center {
  border: 1px solid black;
  width: 100%;
  overflow: auto;
  box-sizing: border-box;
  display: flex;   /* it can put children in one line */
}

.left {
  border: 1px solid black;
  width: 20%;
  float: left;
  box-sizing: border-box
}

.right {
  border: 1px solid black;
  width: 80%;
  margin: 0 10px;
  float: left;
  box-sizing: border-box;
}
</style>
</head>
<body>
<div class="center">
  <div class="left">left</div>
  <div class="right">right</div>
</div>
</body>
</html>
```

# python - 如何在python中进行子排序？

> ID：14416652
> 
> 赞同：1
> 
> 时间：2013-01-19T17:03:42.160
> 
> 标签：python, list, sorting, dna-sequence

非常感谢 SO 社区帮助我解决了我之前遇到的问题。喜欢这里的帮助！

我现在还有另一个问题。我有一个与“构造编号”和“部件编号”相关联的 DNA 序列的平面列表。就目前的情况而言，从我之前的代码中，我将它作为一个 csv 文件打开，读取并导入为字典对象列表。所有内容都已按“构造编号”排序，但我需要按“零件编号”排序。（这有点像在 Excel 中，他们说“首先按**然后排序*****_**。”***

 ***有人知道如何完成这项工作吗？到目前为止，我写的都是这样的：

```
primers_list = open('primers-list.csv', 'rU')
primers_unsorted = csv.DictReader(primers_list)
for row in primers_unsorted:
    print(row) 
```

到目前为止，输出的一个子集如下，用于可视化我正在使用的数据：

```
{' Direction': 'fw primer', ' Construct Number': '1', ' Part Number': '2', 'Primer Sequence': 'AAGCGGCCGCTCGAGTCTAAgctcactcaaaggcggtaatcagataaaaaaaatccttag'}
{' Direction': 're primer', ' Construct Number': '1', ' Part Number': '1', 'Primer Sequence': 'attaccgcctttgagtgagcTTAGACTCGAGCGGCCGCTTTTTGACACCAGACCAACTGG'}
{' Direction': 'fw primer', ' Construct Number': '1', ' Part Number': '1', 'Primer Sequence': 'TTTAATTACTAACTTTATCTATGATAGATCCCGTCGTTTTACAACGTCGTGACTGGGAAA'}
{' Direction': 're primer', ' Construct Number': '1', ' Part Number': '2', 'Primer Sequence': 'AAAACGACGGGATCTATCATAGATAAAGTTAGTAATTAAACTTAAAAGTTGTTTAATGTC'}
{' Direction': 'fw primer', ' Construct Number': '2', ' Part Number': '2', 'Primer Sequence': 'gtaaatccaagttgtaataatactagagTAGCATAACCCCTTGGGGCCTCTAAACGGGTC'}
{' Direction': 're primer', ' Construct Number': '2', ' Part Number': '1', 'Primer Sequence': 'GGGGTTATGCTActctagtattattacaacttggatttaccacctttcttcgccttgatc'}
{' Direction': 'fw primer', ' Construct Number': '2', ' Part Number': '1', 'Primer Sequence': 'TACGACTCACTATAGGGAGAtactagagttaaggaggtaaaaaaaatgggtccggtcgtt'}
{' Direction': 're primer', ' Construct Number': '2', ' Part Number': '2', 'Primer Sequence': 'ttacctccttaactctagtaTCTCCCTATAGTGAGTCGTATTACTCTAGAAGCGGCCGCg'}
{' Direction': 'fw primer', ' Construct Number': '3', ' Part Number': '2', 'Primer Sequence': 'gtaaatccaagttgtaataatactagagTAGCATAACCCCTTGGGGCCTCTAAACGGGTC'}
{' Direction': 're primer', ' Construct Number': '3', ' Part Number': '1', 'Primer Sequence': 'GGGGTTATGCTActctagtattattacaacttggatttaccacctttcttcgccttgatc'}
{' Direction': 'fw primer', ' Construct Number': '3', ' Part Number': '1', 'Primer Sequence': 'TAACTATCACTATAGGGAGAtactagagttaaggaggtaaaaaaaatgggtccggtcgtt'}
{' Direction': 're primer', ' Construct Number': '3', ' Part Number': '2', 'Primer Sequence': 'ttacctccttaactctagtaTCTCCCTATAGTGATAGTTATTACTCTAGAAGCGGCCGCg'} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:16:00.693

其他方式：

```
import operator
primers_unsorted.sort(key=operator.itemgetter(' Construct Number', ' Part Number'))

for row in primers_unsorted:
    print(row) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:23:33.800

如果您想逐块执行此操作，可以执行以下操作：

```
a=0
while a<len(primers_list):
    b=a
    current_construct=primers_list['Construct Number']
    while primers_list[b]['Construct Number']==current_construct:
         b=b+1
    primers_list[a:b]=sorted( primers_list[a:b] , key = lambda e: (e[' Construct Number'],e[' Part Number']))
    a=b 
```

如果列表很长，这可能很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T16:46:51.137

我的最终代码是这样的，而且效果很好：

```
primers_list = open('primers-list.csv', 'rU')
primers_unsorted = csv.DictReader(primers_list)
primers_sorted = sorted(primers_unsorted, key=operator.itemgetter('Construct Number', 'Part Number'))
for row in primers_sorted:
    print(row) 
```

关键（请原谅双关语）是使用 operator.itemgetter(...)，它可以根据需要接受尽可能多的参数。它被传递到 sorted(...) 中的 'key' 参数中。

非常感谢[Eric](https://stackoverflow.com/users/102441/eric)回答我的问题！***

# c# - 将多个元素添加到网格

> ID：14416655
> 
> 赞同：0
> 
> 时间：2013-01-19T17:03:48.223
> 
> 标签：c#, winforms, listbox, grid

实际上问题是我不能在网格中添加我的 ListBoxItem 多个元素。

```
ListBoxItem _ListBoxItem = null;

   _ListBoxItem = LoginThread as ListBoxItem;
   LoginThread.Name = "LoginThread1";
   OkChild.Children.Insert(0, _ListBoxItem);

   _ListBoxItem = LoginThread as ListBoxItem;
   LoginThread.Name = "LoginThread2";
   OkChild.Children.Insert(1, _ListBoxItem); 
```

这是一个获取错误代码：指定的视觉对象已经是另一个视觉对象的子对象或 CompositionTarget 的根。如果要添加一个空的ListBoxItem，那么工作正常，但它是定义和添加自己的ListBoxItem 失败。这类似于以下内容：

1) 该方法只能在 Grid 中添加一项

```
ListBoxItem obj = new ListBoxItem ();
obj = MyListBoxItem; 
```

2）像这样在这里工作

```
ListBoxItem obj = new ListBoxItem ();
for (int i = 0; i <100 500; i + +)
MyGrid.Children.Add (obj); 
```

实际上有什么问题，请解释我错在哪里，因为之前非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:18:47.810

视觉元素的单个实例只能添加到视觉树一次。在您的第一个代码段中，您要添加`LoginThread`两次`OkChild`。而不是创建一个新的`ListBoxItem`，你只需分配`LoginThread`给`_ListBoxItem`每次。代码的正确版本如下：

```
ListBoxItem _ListBoxItem = null;

// Create a new ListBoxItem
_ListBoxItem = new ListBoxItem();
LoginThread.Name = "LoginThread1";
OkChild.Children.Insert(0, _ListBoxItem);

// Again, create a new ListBoxItem. We can reuse the same variable, _ListBoxItem, to refer
// to the new ListBoxItem, but it is very important that we actually create a new one.
_ListBoxItem = new ListBoxItem();
LoginThread.Name = "LoginThread2";
OkChild.Children.Insert(1, _ListBoxItem); 
```

在您的第二个代码段中，您编写：

```
ListBoxItem obj = new ListBoxItem ();
obj = MyListBoxItem; 
```

这首先创建一个新`ListBoxItem`的并使变量`obj`引用它。但是下一行然后将变量重定向`obj`到引用变量`MyListBoxItem`所引用的任何内容。您现在完全失去了对`ListBoxItem`您刚刚创建的任何引用。你可能是想写吗？：

```
ListBoxItem obj = new ListBoxItem ();
MyListBoxItem = obj; 
```

在第三个代码段中，您创建一个`ListBoxItem`，然后在循环`MyGrid`中一遍又一遍地添加相同的项目`for`。你可能打算写：

```
for (int i = 0; i < 100; i++)
{
    ListBoxItem obj = new ListBoxItem();
    MyGrid.Child.Add(obj);
} 
```

看，现在`ListBoxItem`在循环的每次迭代中都会创建一个新的，然后添加到`MyGrid`.

我建议您花更多时间了解`C#`.

# asp.net - 获取 ORA-12154: TNS:could not resolve the connect identifier specified 连接时错误

> ID：14416658
> 
> 赞同：0
> 
> 时间：2013-01-19T17:03:57.133
> 
> 标签：asp.net, .net, c#-4.0

我正在使用oracle 10g。我的操作系统是 64 位的。当我将我的 c# 控制台应用程序与 oracle 连接时，它连接成功。但是当我尝试将 oracle 与我的 asp.net 项目连接时，它显示无法解决连接标识符指定的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T05:07:42.767

您的 asp.net 项目的连接字符串可能需要修改。检查数据源、用户名和密码，并确保它们在 asp.net 系统上是正确的。

# python - 熊猫数据框行更改类型

> ID：14416660
> 
> 赞同：2
> 
> 时间：2013-01-19T17:04:02.783
> 
> 标签：python, parsing, pandas, floating-accuracy

我正在处理一个已解析为 pandas 的资产负债表：

```
 table = xls_file.parse('Consolidated_Balance_Sheet')
    table.ix[:, 1]

    0         None
    1         None
    2      $ 3,029
    3         1989
    5         None
    6     $ 34,479 
```

我正在尝试使用 unicode 识别行并去掉 $ 符号和逗号，转换为浮点数。

```
 for row in table.ix[:, 1]:
        if isinstance(row, unicode):
            print type(row), row
            num = float(row.lstrip('$').replace(',',''))
            print num
            row = num
            print type(row), row 
```

这会产生以下输出：

```
 <type 'unicode'> $ 3,029
    3029.0
    <type 'float'> 3029.0
    <type 'unicode'> $ 34,479
    34479.0
    <type 'float'> 34479.0 
```

但是，当我检查表格时，该值没有变化

```
 table.ix[2, 1]
    u'$ 3,029' 
```

如何正确地将值更改为浮点数？

**编辑**：感谢您的两个回复，我可以毫无问题地重现那些回复。但是，当我对我的案例使用 apply 函数时，我得到一个“不可散列类型”错误。

```
In [167]: thead = table.head()
In [168]: thead

Out[168]:
         Consolidated Balance Sheet (USD $)  Sep. 30, 2012  Dec. 31, 2011
    0    In Millions, unless otherwise specified     None    None
    1    Current assets                              None    None
    2    Cash and cash equivalents                   $ 3,029 $ 2,219
    3    Marketable securities - current             1989    1461
    4    Accounts receivable - net                   4409    3867

In [170]: def no_comma_or_dollar(num):
              if isinstance(num, unicode):
                  return float(num.lstrip('$').replace(',',''))
              else:
                  return num

          thead[:, 1] = thead[:, 1].apply(no_comma_or_dollar) 
```

产生以下内容：

```
 TypeError: unhashable type 
```

我不明白为什么，因为我没有改变键，只是改变了值。还有其他方法可以更改数据框中的值吗？

**编辑2**：

```
In [171]: thead.to_dict()
Out[171]: {u'Consolidated Balance Sheet (USD $)': {0: u'In Millions, unless otherwise specified',
  1: u'Current assets',
  2: u'Cash and cash equivalents',
  3: u'Marketable securities - current',
  4: u'Accounts receivable - net'},
 u'Dec. 31, 2011': {0: None, 1: None, 2: u'$ 2,219', 3: 1461.0, 4: 3867.0},
 u'Sep. 30, 2012': {0: None, 1: None, 2: u'$ 3,029', 3: 1989.0, 4: 4409.0}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:46:39.677

您只是打印这些而不是[`apply`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.apply.html)将它们添加到 DataFrame，这是一种方法：

创建一个函数来进行条带化（如果是 unicode），或者如果已经是一个数字则保留它：

```
def no_comma_or_dollar(num):
    if isinstance(num, unicode):
        return float(num.lstrip('$').replace(',',''))
    else:
        return num

table[col_name] = table[col_name].apply(no_comma_or_dollar) 
```

例如：

```
df = pd.DataFrame([[u'$1,000'], [200.]])

In [3]: df[0].apply(no_comma_or_dollar)
Out[3]: 
0    1000
1     200
Name: 0 
```

更新：

有了`thread`你给出的，我很想给出一个稍微懒一点的`no_comma_or_dollar`and版本[`applymap`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.applymap.html)：

```
def no_comma_or_dollar2(num):
    try:
        return float(num.lstrip('$').replace(',',''))
    except: # if you can't strip/replace/convert just leave it
        return num

In [5]: thread.applymap(no_comma_or_dollar2)
Out[5]: 
        Consolidated Balance Sheet (USD $)  Dec. 31, 2011  Sep. 30, 2012
0  In Millions, unless otherwise specified            NaN            NaN
1                           Current assets            NaN            NaN
2                Cash and cash equivalents           2219           3029
3          Marketable securities - current           1461           1989
4                Accounts receivable - net           3867           4409 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T17:46:54.587

如果我理解正确，您正在寻找`apply`方法：

```
In [33]: import pandas as pd

In [34]: table = pd.Series([None, u'$ 3,12', u'$ 4,5'])

In [35]: table
Out[35]: 
0      None
1    $ 3,12
2     $ 4,5

In [36]: def f(cell):
   ....:     if isinstance(cell, unicode):
   ....:         return float(cell.lstrip('$').replace(',',''))
   ....:     else:
   ....:         return cell
   ....:     

In [37]: table.apply(f)
Out[37]: 
0    NaN
1    312
2     45 
```

这确实创建了一个新对象。为了存储新对象而不是旧对象，请执行以下操作：

```
In [42]: table = table.apply(f)

In [43]: table
Out[43]: 
0    NaN
1    312
2     45 
```

# jquery - timePicker，如何抑制范围内的小时数？

> ID：14416663
> 
> 赞同：0
> 
> 时间：2013-01-19T17:04:13.907
> 
> 标签：jquery, time

我正在使用[Time datePicker](https://github.com/jonthornton/jquery-timepicker#timepicker-plugin-for-jquery)，这很棒！

```
$(function() {
    $("#appointment_atime").timepicker({
        'minTime': '9:00pm',
        'maxTime': '6:00pm',

    }); 
```

有没有办法在这个范围内压制或隐藏几个小时？

我不希望上午 12 点和下午 1 点显示为选项。

那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:58:15.743

由于此插件似乎没有回调来表示时间的生成，因此您需要创建一个贯穿列表的函数，以在单击列表时删除不需要的条目。

试试这个删除 12a​​m 和 1pm 的**[jsFiddle 示例](http://jsfiddle.net/j08691/t6DXm/)**。

```
$('#basicExample').timepicker({
    'minTime': '9:00pm',
    'maxTime': '6:00pm',
    'step': 60
});
$('#basicExample').on('showTimepicker', function () {
  $('.ui-timepicker-list li').filter(function (index) {
      return ($(this).text() == '12:00am' || $(this).text() == '1:00pm');
  }).remove();
}); 
```

# mysql - 如果条件在 mysql 查询

> ID：14416664
> 
> 赞同：0
> 
> 时间：2013-01-19T17:04:15.073
> 
> 标签：mysql, sql, if-statement

我已经通过谷歌和这里搜索但没有找到我的问题的答案。

我正在尝试以这种方式在查询（而不是存储过程）中使用 IF：

```
IF EXISTS (SELECT *  FROM TABLE WHERE COLUMN=VALUE) THEN
DO SOMETHING
END IF; 
```

我在 MySql Workbench 中尝试过但没有用（语法错误）。

有人知道是否可以以这种方式使用 IF 吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:21:33.677

这取决于什么是某事

如果是 UPDATE、DELETE 或 SELECT，则可以在 where 子句中指定条件。

```
WHERE IF( (SELECT COUNT(*) FROM TABLE WHERE COLUMN=VALUE) > 0, 1, 2) = 1 
```

对于其他语句（INSERT、CREATE 等），我认为这是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T18:22:53.323

在您的评论中，您说“某事”是一项`INSERT`操作。然后，您可以，而不是：

```
INSERT INTO tableName
  (colA, colB, ...)
VALUES
  (a, b, ...) ; 
```

利用：

```
INSERT INTO tableName
  (colA, colB, ...)
SELECT
  a, b, ... 
FROM 
  dual
WHERE
  EXISTS (SELECT * FROM TABLE WHERE COLUMN=VALUE) ; 
```

# sql-server - SQL Server 身份主键与无身份性能 - 在主键中使用公式

> ID：14416671
> 
> 赞同：4
> 
> 时间：2013-01-19T17:05:19.457
> 
> 标签：sql-server, performance, primary-key, identity, uniqueidentifier

`Identity`主键和普通主键在性能上有什么区别吗？

实际上，我想创建一个可能包含超过 500 万行的表。该表应在不到半秒的时间内返回具有超过 4 列的过滤条件的查询。

由于这 4 列（都是来自其他表的主键）都是数字并且它们的范围是有限的，所以我决定在主键中混合所有 4 列。

`col1=500 | col2=500 | col3=900,000 | col4=9,000,000`例如，列范围可以`bigint`是 9,223,372,036,854,775,807，所以如果我想在一个`bigint`主键中混合所有 4 列，它可以提供。

这个解决方案有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T20:45:43.863

将我的脚趾浸入一些深水中：

约束（例如主键和外键）对有效性的影响大于性能；底层索引的布局和结构通常会对给定查询的执行效果产生更大的影响。当然，将 PRIMARY KEY 约束应用于表将在该表上构造一个 UNIQUE 索引，但该索引可能会或可能不会聚集（取决于它的创建方式和时间）。

如果 PRIMARY KEY 构建为 IDENTITY 列上的聚集索引（根据定义单调递增），那么您的聚集键将具有由标准 INSERT 操作产生的最小碎片；如果您在其他四列上构建它，并且数据以非单调方式插入，那么您可能会随着时间的推移看到大量碎片，这可能是由性能问题导致的。但是，如果您的数据总是要按顺序插入，这可能不是问题。

您提到了过滤，但是联接呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:40:10.790

您的两个解决方案都是相同的：

`PK`1) 一个有 4 列的复合体

2）一`BIGINT`列（无论身份与否）是`PK`

用于索引的 Sql Server 机制对于两者都是相同的：数据将排序并保存在一个地方。您可以使用以下方式测试两者`Statistics`：

```
SET STATISTICS IO ON
SET STATISTICS TIME ON 
```

我测试了它，那些都是一样的。

# javascript - 如何使用 jQuery 克隆表格行？

> ID：14416674
> 
> 赞同：0
> 
> 时间：2013-01-19T17:05:34.720
> 
> 标签：javascript, jquery

我想克隆我的 tr 类行。因此，当用户单击按钮时，该行将克隆并设置在最后一行下方。

我目前使用以下代码，只是它不能正常工作。我可能不正确。

JS：

```
var row = jQuery('.ui-sortable').closest('.ui-sortable').find('tbody tr.row.ui-sortable:last-child');
var clone = row.clone(); 
```

克隆的字段如下所示：

HTML 标记：

```
echo '<tbody class="ui-sortable">';
echo '<tr class="row">';
echo '<td class="order">1</td>';

// Do some stuff inside the row.

echo '<td class="remove"><a class="repeatable-remove button" href="#">-</a></td>';
echo '</tr>'; // End .row
echo '</tbody>'; 
```

我认为 javascript 的第一段代码不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:29:03.870

如果按钮在您要克隆的行*内，那么类似下面的内容应该可以工作。*（它可能不完全正确，但可能很接近）。

```
$('#your-table').on('click', '.copy-row-button', function() {
  var 
    $table = $(this).closest('table'),
    $row = $(this).closest('tr'),
    $newRow = $row.clone();

  $table.append($('<tbody/').append($newRow));
}); 
```

我附加了包含在新元素中的行，`<tbody>`因为 Internet Explorer 在将 a 附加`<tr>`到现有表体时可能会遇到问题。

该代码还为表格和按钮使用了组成的选择器；你可以用你需要的任何 id/class 值来制作你的页面。

# c++ - C++ - 为什么在删除后将对象设置为空？

> ID：14416676
> 
> 赞同：6
> 
> 时间：2013-01-19T17:05:36.510
> 
> 标签：c++

我正在查看我在网上找到的以下链表代码：

```
void DeleteAfter(Node **head){
      if(*head==NULL){
            return;
      }else{
            Node *temp = NULL;
            temp = (*head)->next;
            (*head)->next = (*head)->next->next;
            delete temp;
            temp=NULL;
      }
} 
```

我对 C++ 不是很熟练，所以这可能是一个不好的问题，但是为什么 temp 被删除后被设置为 NULL 呢？这是必要的步骤吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T17:07:50.750

这是不必要的。有些人养成了这样做的习惯，即使没有结果。积极的编译器优化器将消除此代码，因此它实际上不会造成任何伤害。但我会写：

```
void DeleteAfter(Node *head) {
  if (head) {
    Node *next = head->next;
    if (next) {
      head->next = next->next;
      delete next;
    }
  }
} 
```

注意我消除了一个无用的间接级别并添加了一个检查以确保有一个“节点之后”要删除。

该习惯的基本原理是，如果指针*始终*引用有效对象或为空，则可以依赖空检查等同于有效性检查。

出于这个原因，Ada（一种经常用于安全关键系统的语言）初始化指向 null 的指针并定义其`delete`等效运算符以自动将其参数设置为 null。您的 C++ 正在模拟这种行为。

在实践中，这门学科的价值并不是你所希望的。在很长一段时间内，它可以防止一个愚蠢的错误。然而，一件好事是指针内容的调试器显示是有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T22:21:25.973

如果该变量`temp`以后可能会在代码中再次使用，那么最好将其设置为 NULL。

释放指针后通常将指针设置为 NULL 有两个原因。

1.) 一旦你释放了一个指针，指向的地址的内存就不再对你的程序可用。从理论上讲，该内存现在可以被任何其他程序使用，包括操作系统本身！试图释放一个已经被释放的指针，从而指向谁知道什么会导致一个巨大的问题。幸运的是，现代操作系统可以防止这种情况发生，但程序仍然会因非法访问错误而崩溃。释放一个空指针 OTOH 绝对不会做任何事情。

2.) 在使用运算符取消引用它之前，您应该始终检查指针是否为 NULL `*`。取消引用 NULL 指针将导致运行时错误。取消引用指向任意内存的已释放指针甚至更糟。释放的指针应始终设置为，`NULL`以便后面的代码可以假定非空指针指向有效数据。否则无法知道指针是否仍然有效。

至于原始问题，指针变量`temp`在一个不再使用的短函数中声明为局部变量。在这种情况下，没有必要将其设置为 NULL，因为一旦函数返回，它就会超出范围。

然而，线...

```
(*head)->next = (*head)->next->next; 
```

在尝试取消引用之前无法确保`(*head)->next`它不为空，这是不行的。

更好的版本应该是...

```
int DeleteAfter(Node **head){
  Node *node_after = NULL;

  if(*head==NULL)
    return -1;

  node_after = (*head)->next;

  if(node_after == NULL)
    return -1;

  (*head)->next = node_after->next;
  delete node_after;

  return 0;
  } 
```

现在使用该函数的人可以通过返回值检查节点删除是否成功，并且没有尝试删除不存在的节点的风险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T17:48:45.493

如果 temp 是全局变量或成员变量，那么设置为 NULL 并不是一个坏主意。

在使用带有 C 代码的保守垃圾收集器后，我养成了将指针设置为 NULL 的习惯。没有指向未使用内存的指针是它找到要收集的垃圾的方式。但在这种情况下，你也应该这样做

```
temp->next = NULL; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T17:14:05.583

删除本地指针变量后不必将其设置为NULL。如果要重用指针，应将指针设置为NULL，在检查NULL后，您可以安全地为其分配一个新地址。通常我们为指针成员这样做变量和全局指针变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T16:39:05.483

在您的代码示例中，没有明显的直接好处，但是可以说是长期维护成本收益。这个想法是，在您删除 temp 后，有人最终可能会添加代码来尝试取消对 temp 的引用。这可能只是因为没有注意到删除，或者在删除后移动访问 temp 的较早行。

这是一个例子：

```
int * i = new int(12);
std::cout << *i << std::endl; // output is 12.
delete i;
// i = 0; // This would cause the program to fail on the next line.
std::cout << *i << std::endl; // output is random for me. 
```

请注意，这不会隐藏缺陷，实际上不将指针设置为 null 会在这种情况下隐藏缺陷，因为 *i 返回一个随机值。

大多数人会说 i = 0 可能由编译器优化，无论哪种方式，对指针的赋值都是无害的。对我来说，在专业发展时，我总是谨慎行事。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-19T17:07:25.680

这没有必要，有些人（包括我）认为这是不好的做法。

将其设置为的动机`NULL`是您可以事后检查它是否已被删除，如果没有则访问它。此外，这将防止双重删除，因为`delete`NULL 指针是无操作的。

另一方面，它可以隐藏错误。如果对象被删除了，那么使用它就没有意义了，对吧？您**应该**知道该对象已被删除，而不是依靠检查。

例如

```
if (p != NULL) //or just if (p)
   p->doStuff() 
```

为什么？你不知道它是否被删除了吗？清理不是逻辑的一部分吗？

# jquery - 无法隐藏 jQuery 验证插件的错误标签

> ID：14416677
> 
> 赞同：0
> 
> 时间：2013-01-19T17:05:39.273
> 
> 标签：jquery, css, hover, hide

我正在为我的表单使用 jQuery 验证插件。我在表单中的一个元素是这样的：

```
<form name="registrationForm" id="registrationForm" action="" method="POST">
    <span class="component-wrapper">
        <input type="text" name="textStreetName" size="50" value="<?php echo $field['textStreetName'];?>"/>
    </span>
</form> 
```

这是对上述表单的验证：

```
$("#registrationForm").validate({
    rules:{
        textStreetName: {required: true}
    }
}); 
```

验证效果很好。弹出一个带有“错误”类的标签，说明该字段是必需的。但是当我将鼠标悬停在错误标签上时，它不会消失。这是我的CSS：

```
.component-wrapper {position: relative;}

label.error {
    position: absolute;
    top: 20%;
    left: 20%;
    z-index: 100;
    background: #FFF;
    border: 1px solid #FF0000;
    font-size: 10pt;
    width: 280px;
    padding: 2px;
}

label.error:hover {
    display: none;
} 
```

我的 CSS 有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:18:50.473

如评论中所述：

`display: none`删除元素，它不再占用空间，因此它不再悬停，所以它显示。

您可以将不透明度设置为 0 ：

```
label.error:hover {
     opacity: 0;
} 
```

如小提琴所示：

[http://jsfiddle.net/6gBSL/](http://jsfiddle.net/6gBSL/)

# php - PHP 到 MYSQL，问题

> ID：14416678
> 
> 赞同：0
> 
> 时间：2013-01-19T17:05:54.980
> 
> 标签：php, html, mysql

我已经创建了 php、form 和 mysql 数据库。密码可以使用表单很好地写入数据库，但用户名不会。我已经为此困扰了好几个小时（这可能是一个非常简单的解决方法，有人可以提供见解吗？谢谢！

```
<?php

    echo "connected ";
    //get form data

    if( !isset( $user ) ) {
       $user = strtolower( mysql_real_escape_string( $_POST['user'] ) );
    }

    if( !isset( $user ) ) {
       $pass = md5( mysql_real_escape_string( $_POST['password'] ) );
    }

    //connect to MySQL
    $connect = mysql_connect( $dbhost, $dbuser, $dbpass )
    or die ("connection error");
    echo "connected ";

    //select databse
    mysql_select_db( $dbdb ) or die ("database selection error");

    //insert data
    $insert = mysql_query("INSERT INTO androidlogin (user, pass) VALUES           ('$user','$pass')");
    if( $insert ) {
       $arr2 = array("user" => $user, "pass" => $pass);
       echo json_encode( $arr2 );
    }

 ?> 

<html>
    <head>
    </head>
    <body>
     <title>PHP Register</title>
       <form action="registerBBD.php" method="POST">
        User: <input type="text" name="user" id="user" /><br /> 
        Pass: <input type="text" name="pass" id="pass" /><br /> 
              <input type="submit" name="submit" value="submit" />
       </form>
    </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:12:21.847

您只需为`$pass`if `$user`is not set 分配一个值……但您在将值设置为*后*`$user`立即执行此操作。

当您`if(!isset($user)){`第二次写信时，您的意思可能是`if(!isset($pass)){`.

我不明白你为什么要检查是否`$user`在任何一种情况下都设置了。测试*表单数据*是否已提交并使用它来确定是否应处理数据或是否应显示表单是正常的。

# php - 使用 Facebook 登录跟踪会话？

> ID：14416680
> 
> 赞同：1
> 
> 时间：2013-01-19T17:06:05.773
> 
> 标签：php, facebook, zend-framework, session, facebook-php-sdk

所以每次用户登录时，我都想为用户创建一个会话。我也在使用 Facebook API 登录。顺便说一句，我对 PHP 和一切都是全新的，如果我被打乱了，请道歉！

目前，我在登录控制器中拥有的是这个。

```
 if ($user) {
        try {
            // Proceed knowing you have a logged in user who's
            // authenticated.
            $user_profile = $facebook->api('/me');
        } catch (FacebookApiException $e) {
            error_log($e);
            $user = null;
        }

        if (! empty($user_profile)) {
            // Get the relevant information from the user's profile.
            $firstname = $user_profile['first_name'];
            $lastname = $user_profile['last_name'];
            $userid = $user_profile['id'];
            $model = new Enligne_Model_Users();
            $model->createUser($firstname, $lastname);
            $session = new Zend_Session_Namespace('session'); //Creates a new Zend namespace equivalent to session start.
            $session['uid'] = $userid; //sets the user id of the session to uid.
            Zend_Registry::set('usersession', $session); //sets the user session in the zend registry.

        }
    } 
```

这是创建会话的正确位置吗？我希望用户在登录后“登录”，但是是的。我是否还需要编辑我的用户文件以反映我正在使用会话的事实？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T12:05:19.593

你可以这样做：

```
<?php
$user = $facebook->getUser();
//Create Zend_Session_Namespace
$session = new Zend_Session_Namespace('usersession');
if ($user) {
    try {
        // Proceed knowing you have a logged in user who's
        // authenticated.
        $user_profile = $facebook->api('/me');
        if (!empty($user_profile)) {
            // Get the relevant information from the user's profile.
            $firstname = $user_profile['first_name'];
            $lastname = $user_profile['last_name'];
            $userid = $user_profile['id'];
            $email = $user_profile['email'];

            $model = new Enligne_Model_Users();
            $result = $model->createUser($firstname, $lastname, $email);
            //gets the data from database and stored it into the session
            if ($result) {
                $session->userId = $result['id'];
                $session->fb_email = $result['emailId'];
                $session->fb_id = $result['socialId'];
                $session->fb_image = "http://graph.facebook.com/" . $userid . "/picture";
                $session->fb_firstName = $result['firstName'];
                $session->fb_lastName = $result['lastName'];
                //redirect to the controller or action
                $this->_redirect('your_controller_name');
            } else {
                //Redirect code                
            }
        }
    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
}
?> 
```

希望它会帮助你。

# c - 将元素插入到双向链表的末尾

> ID：14416683
> 
> 赞同：0
> 
> 时间：2013-01-19T17:06:20.407
> 
> 标签：c, list

我正在编写一个程序，它可以将元素插入到列表的末尾，然后显示其中一个。它插入正确，但我可以显示指定的。

```
typedef struct Node
{
        int data;
        struct Node *next;
        struct Node *prev;
} node;

void insert(node *head, int data)
{
        node *newNode = (node*) malloc(sizeof(node));
        newNode->data = data;
        newNode->next = NULL;

        if(head == NULL)
        {
            head = newNode;
        }
        else
        {
            while(head != NULL)
                head = head->next;

            head->next = newNode;
            (head->next)->prev = head;
        }
}

void print(node *head, int element)
{
    node *temp = head;
    int count = 0, i = 1;
    while(i < element)
    {
        temp = temp->next;
        i++;
    }
    printf("%d", temp->data);
}

int main()
{
        node *start = (node*) malloc(sizeof(node));
        start = NULL;

        int data1 = 4, data2 = 5;
        insert(start,data1);
        insert(start,data2);

        print(start, 1);
} 
```

为什么它不起作用？另外，你能告诉我我这样做是否正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:08:55.037

这是因为您通过*value*`start`传递指针。这意味着一旦函数返回，函数内部对其进行的任何更改都将丢失。*`insert`*

 *您可以通过引用传递指针：

```
void insert(node **head, int data)
{
    /* ... */
    if (*head == NULL)
        *head = newNode;
    else
    {
        /* ... */
    }
}

int main(void)
{
    node *start = NULL;
    insert(&start, 1);
    /* ... */
} 
```

或者从函数返回指针：

```
node *insert(node *head, int data)
{
    /* ... */
    return head;
}

int main(void)
{
    node *start = NULL;
    start = insert(start, 1);
    insert(start, 2);  /* Do not get the returned pointer, as the returned pointer no longer points to the start of the list */
    /* ... */
} 
```

这两种解决方案的问题在于，`head`如果不是`NULL`，则更改为指向最后一个节点之前的节点。在里面的循环中，`insert`您应该使用临时指针。

* * *

作为安全预防措施，您应该检查在函数`NULL`的循环中没有节点。`print`考虑一下如果传递的数字大于列表中的节点数会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:15:55.347

编辑：我跳过了几行。

请在您的代码片段中查看我修改后的评论`main()`：

```
node *start = (node*) malloc(sizeof(node));//You allocate memory here. Good.
start = NULL;//Memory leak. 

//Instead of the above two lines use this
node* start=NULL;

int data1 = 4, data2 = 5;
start=insert(start,data1);//If you want to do it statically, why not write insert(start,4)?
insert(start,data2);
.... 
```

我建议在`print()`函数中添加一个 NULL 检查。

```
void print(node *head, int element)
{
    //Null check for the start pointer.
    //If you would have had this here, you'd have never faced such problem.
    if(head == NULL)
    {
      //Handle null
    }
    node *temp = head;
    int count = 0, i = 1;
  ....
} 
```

加上你的`insert()`我建议：

```
node* insert(node *head, int data)
{
        node *newNode = (node*) malloc(sizeof(node));
        newNode->data = data;
        newNode->next = NULL;

        if(head == NULL)
        {
            head = newNode;
            return head;
        }
        else
        {
            while(head != NULL)
                head = head->next;

            head->next = newNode;
            (head->next)->prev = head;
            return NULL;
        }
} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T18:38:33.077

有一个技巧可以让事情变得更容易，也让你的代码更有效率！

诀窍是使用循环列表，并让“头”节点成为哨兵值。一个空列表由一个节点表示，该节点既具有`prev`又`next`指向自身。你永远不需要 NULL，这种风格大大减少了你需要的特殊情况。它还使您可以 O(1) 访问列表的头部和尾部。头部`data`区域从未使用过。它在 Knuth 的“计算机编程艺术”中有所描述。

在这种风格中，你会得到这样的东西：[未经测试]

```
#include <stdio.h>
#include <stdlib.h>

typedef struct Node {
   int data;
   struct Node *next, *prev;
} node;

void insert_list(node *head, int data) {
  node d = {data, head, head->prev};
  node *new_node = malloc(sizeof(node));
  /* TODO: handle malloc failure */
  *new_node = d;
  head->prev->next = new_node;
  head->prev = new_node;
}

node *get_list(node *head, int n) {
  node *node = head;
  int i;
  for (i = 0; i <= n; i++) {
    node = node->next;
    if (node == head) {
      /* TODO: handle out-of-bounds index */
    }
  }
  return node;
}

void print_list(node *head, int i) {
   printf("%d\n", get_list(head, i)->data);
}

node *new_list(void) {
  node *head = malloc(sizeof(node));
  /* TODO: handle malloc failure */
  head->next = head->prev = head;
  return head;
}

int main(int argc, char**argv) {
  node *list = new_list();
  insert_list(list, 10);
  insert_list(list, 20);
  print_list(list, 0);
  print_list(list, 1);
  return 0;
} 
```*

# c# - 按条目获取条目

> ID：14416684
> 
> 赞同：2
> 
> 时间：2013-01-19T17:06:26.113
> 
> 标签：c#, .net, sql, sql-server-ce

我有以下情况：

文章表

```
id | description | supplierID
_____________________________
1  | Testarticle | 1 
```

供应商表

```
id | description 
_______________________
1  | Example Industries 
```

例如，在阅读文章时 `SELECT * FROM articles WHERE ID=1`，我还需要结果中的供应商描述。

什么是实现这一目标的合适方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:08:59.753

```
select a.id as ArticleID, a.description as ArticleDescription, a.SupplierID,
s.description as SupplierDescription
from articles a
inner join supplier s on a.supplierID = s.supplierID
where a.id = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:08:49.133

尝试加入这两个表

```
SELECT  a.*, b.*
FROM    articles a
INNER JOIN Supplier b
ON a.SupplierID = b.id
WHERE   a.id = 1 
```

看看是如何[`INNER JOIN`](http://www.w3schools.com/sql/sql_join_inner.asp)工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T17:07:50.530

你需要加入两个表，

```
SELECT  a.*, b.*
FROM    articles a
        INNER JOIN Supplier b
            ON a.SupplierID = b.ID
WHERE   a.ID = 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/0e9dd/3)

要了解有关联接的更多信息，这里有一个很好的参考

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

# asp.net-mvc-4 - RavenDb 初始化不起作用

> ID：14416694
> 
> 赞同：1
> 
> 时间：2013-01-19T17:07:37.183
> 
> 标签：asp.net-mvc-4, ravendb

这是我的环境：
* Windows 7
* 安装了 RavenDb.Embedded 与 NuGet 最终拉取版本 2.0.2230
* IIS 7
* VS2012 Express
* MVC 4 * 在调试模式下运行。

Web.config 部分...

```
<connectionStrings>  
  <add name="RavenDb" connectionString="DataDir = ~\RavenData" />  
</connectionStrings>  
<appSettings>  
  <add key="webpages:Version" value="2.0.0.0" />  
  <add key="webpages:Enabled" value="false" />     
  <add key="PreserveLoginUrl" value="true" />   
  <add key="ClientValidationEnabled" value="true" />  
  <add key="UnobtrusiveJavaScriptEnabled" value="true" />  
  <add key="RavenDb/Port" value="8081" />  
  <add key="RavenDb/DataDir" value="~\RavenData" />  
  <add key="RavenDb/AnonymosAccess" value="Get" />  
</appSettings> 
```

应用程序启动中的代码是....

```
// Test getting create connection to new ravenDB
IDocumentStore test = new EmbeddableDocumentStore
{
    ConnectionStringName = "RavenDb",
    UseEmbeddedHttpServer = true
};
test.Initialize();

//never get to this line
int x = 12; 
```

乌鸦文件确实被创建了。然而，代码永远不会达到 x = 12。它看起来陷入了无限循环。我从来没有收到错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:03:40.590

我能够让它与您的配置一起使用。如果您想查看代码，请点击此处。

[https://github.com/khalidabuhakmeh/MvcRavenDbEmbedded](https://github.com/khalidabuhakmeh/MvcRavenDbEmbedded)

我会发布最重要的部分。

```
namespace EmbeddedRavenSite
{
    public class MvcApplication : System.Web.HttpApplication
    {
        public IDocumentStore DocumentStore;

        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            WebApiConfig.Register(GlobalConfiguration.Configuration);
            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            DocumentStore = RavenConfig.Init();
        }
    }
} 
```

和 RavenConfig 类：

```
namespace EmbeddedRavenSite.App_Start
{
    public static class RavenConfig
    {
        public static IDocumentStore Init()
        {
            return new EmbeddableDocumentStore
            {
                ConnectionStringName = "RavenDb",
                UseEmbeddedHttpServer = true
            }.Initialize();

        }
    }
} 
```

希望有帮助。我包含的代码具有 NuGet 包还原功能，因此您应该能够立即构建并开始工作。祝你好运 ：）

# list - Common LISP 在列表上应用逻辑运算符

> ID：14416699
> 
> 赞同：0
> 
> 时间：2013-01-19T17:08:00.323
> 
> 标签：list, lisp, common-lisp

> **可能重复：**
> [如何减少 Common Lisp 中的布尔值列表？](https://stackoverflow.com/questions/4535236/how-does-one-reduce-a-list-of-boolean-values-in-common-lisp)

我有一个列表如下：'（T Nil TT）

我想在该列表上应用 and-operator。这样它只在列表中的所有条目都是 T 时才给出 T

我试图应用#'，但它会引发错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:14:16.040

你不能申请[`and`](http://www.lispworks.com/documentation/HyperSpec/Body/m_and.htm)，因为它不是一个函数：它是一个宏。

你要

```
(every #'identity list) 
```

或者

```
(loop for x in list always x) 
```

# java - 将 PHP 源代码转换为 Java 源代码？

> ID：14416700
> 
> 赞同：0
> 
> 时间：2013-01-19T17:08:02.413
> 
> 标签：java, php, converter

我有一个用 PHP 编写的类，用于与我的网站数据库进行通信。我也在编写一个 Java 应用程序，它也将与数据库通信。我想知道是否可以使用相同的结构，但将其转换为 java，如果我这样做，是否有任何问题需要考虑。这是我的php类...

```
<?php

class Database {

    private static $instance = null;
    private $connection;
    private $selected_database;
    private $last_query;

    public static function getInstance() {
        if (self::$instance != null) {
            return self::$instance;
        } else {
            return new self;
        }
    }

    function __construct() {
        $this->open_connection();
    }

    private function open_connection() {
        $this->connection = mysql_connect(DB_HOST, DB_USER, DB_PASS);
        if (!$this->connection) {
            die('Database connection failed: ' . mysql_error());
        } else {
            $this->selected_database = mysql_select_db(DB_NAME, $this->connection);
            if (!$this->selected_database) {
                die('Database selection failed: ' . mysql_error());
            }
        }
    }

    private function close_connection() {
        if (isset($this->connection)) {
            mysql_close($this->connection);
            unset($this->connection);
        }
    }

    public function query($sql) {
        $this->last_query = $sql;
        $result = mysql_query($sql, $this->connection);
        $this->confirm_query($result);
        return $result;
    }

    private function confirm_query($result) {
        if (!$result) {
            die('Database query failed: ' . mysql_error() . '<br>Last SQL query: ' . $this->last_query);
        }
    }

    public function escape_value($string) {
        return mysql_real_escape_string($string);
    }

    public function fetch_array($result) {
        return mysql_fetch_array($result);
    }

    public function fetch_assoc($result) {
        return mysql_fetch_assoc($result);
    }

    public function num_rows($result) {
        return mysql_num_rows($result);
    }

    public function insert_id() {
        return mysql_insert_id($this->connection);
    }

    public function affected_rows() {
        return mysql_affected_rows($this->connection);
    }

    public function get_fields_from($table_name) {
        $result = $this->query("SHOW COLUMNS FROM `{$this->escape_value($table_name)}`");
        $fields = array();
        while ($row = $this->fetch_assoc($result)) {
            $fields[] = $row['Field'];
        }
        return $fields;
    }

}

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:52:03.323

不，你可以在 Java 中创建一个类，它的结构与上面的差不多。

`or die()`就像扔一个`Exception`. 您应该知道，在 Java 和 PHP 中有不同的方法可以从数据库中返回数据。PHP 经常使用数组或关联数组。在 Java 中，您将获得一个指向结果的“指针”。由于内存消耗，您必须决定是否要将数据传输到数组。

# php - 如何安装 dBase 扩展（Windows 上的 php 5.4.7）？

> ID：14416701
> 
> 赞同：1
> 
> 时间：2013-01-19T17:08:02.310
> 
> 标签：php, installation, dbase

我正在尝试为 php 安装 dBase 扩展，但到目前为止没有成功。搜索该站点，我找到了这个链接[http://downloads.php.net/pierre/](http://downloads.php.net/pierre/)，并从那里下载了 php_dbase.dll。然后我在 php.ini 中添加了“extension=php_dbase.dll”行（并重新启动了 apache），但它不起作用。我发现的其他建议/解决方案与使用 --enable-dbase 选项编译 php 或安装 PECL 扩展有关。由于我不熟悉这种方法，我搜索了一些说明，但我无法遵循它们。PECL 扩展没有我可以复制到 \php\ext\ 文件夹的 .dll。

有什么建议么？

提前致谢。

# python - 使用 wtforms 在 ajax 中上传文件

> ID：14416706
> 
> 赞同：2
> 
> 时间：2013-01-19T17:08:30.210
> 
> 标签：python, flask, wtforms, ajax-upload, flask-wtforms

我使用 wtforms 来处理表单。所以我创建这样的表格：

```
class ProfileForm(Form):
    firstName = TextField(_('firstName'), [validators.Required(), validators.Length(min=3, max=45)])
    lastName = TextField(_('lastName'), [validators.Required(), validators.Length(min=3, max=45)])
    avatar = FileField(_('avatar'), [check_file]) 
```

这种形式在简单的上传中工作得很好……但是 ajax 呢？

是否有任何插件来创建 iFrame 或通过 ajax 上传文件的东西？或者我必须以其他方式处理此表格？

ps：IE支持很重要

ps2：我将 wtform 用于另一个没有 ajax 文件的文件。只需序列化表单并提交...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T19:58:37.733

您应该尝试安装和使用 Flask-Sijax。它使用 JQuery 和 AJAX。

[http://packages.python.org/Flask-Sijax/](http://packages.python.org/Flask-Sijax/)

它还有一个通过 AJAX 上传的示例。

# php - 如何将 Regex 与 php/sql 脚本集成？

> ID：14416707
> 
> 赞同：0
> 
> 时间：2013-01-19T17:08:31.657
> 
> 标签：php, regex

再次专家，

我很感激能得到 Jason Sperske 的帮助，使用下面的正则表达式：

```
$pattern = "/(\d{2})([ND]?)(\d*)(GG[\d]*)?/";

function format($matches) {
  return $matches[1][0].(strlen($matches[2][0])>0?$matches[2][0]:" ").$matches[3][0].(strlen($matches[4][0])>0?"  ".$matches[4][0]:"");
} 
```

正则表达式有助于格式化为 ID 字段输入的值。

例如，如果用户输入，正则表达式将在**GG**`12343GG90494`之前插入 2 个空格，从而产生以下输出。**`12343 GG90494`**

 **这只是正则表达式如何格式化用户输入的一个示例。

这很重要，因为我们的应用程序的用户通常不会放置 2 个额外的空格，因此他们的搜索不会产生任何结果。

上面的正则表达式为我们解决了这个问题。

我现在的问题是将正则表达式与以下示例查询一起使用：

```
$tid = $_GET["tid"];

// Connect to SQL Server database
include("../connections/TDConnect.php");

 $tsql = "SELECT * FROM TC(dtops.dbo.tSearch, Name, '\"$tid*\"')"; 
```

如何将它与名为 $tid 的输入参数一起使用？

一如既往，我们非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:06:55.183

如果无法访问 TDConnect.php，很难确切地知道您需要什么，所以这个建议是通用的（我猜是 MySql 特定的，但不是那么多）。使用[准备好的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)！专门针对这个问题：

```
$mysqli = new mysqli("example.com", "user", "password", "database");
if ($mysqli->connect_errno) {
  echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}
/* Prepared statement, stage 1: prepare */
if (!($stmt = $mysqli->prepare("SELECT * FROM Table WHERE Col LIKE (?)"))) {
  echo "Prepare failed: (" . $mysqli->errno . ") " . $mysqli->error;
}
if (!$stmt->bind_param("s", $tid)) {
  echo "Binding parameters failed: (" . $stmt->errno . ") " . $stmt->error;
}

if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
} 
```**

# java - 获取服务运行的时间

> ID：14416708
> 
> 赞同：-2
> 
> 时间：2013-01-19T17:08:40.313
> 
> 标签：java, android, service

是否可以获得服务运行的时间量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:14:07.350

如果“运行”是指“存在于内存中”：

步骤#1：将开始时间存储在服务的数据成员中`onCreate()`。

步骤#2：当你需要它时，从当前时间中减去开始时间，以确定服务在内存中的时间。

# fancybox - 父页面中的 Fancybox iframe 库

> ID：14416713
> 
> 赞同：1
> 
> 时间：2013-01-19T17:08:58.900
> 
> 标签：fancybox

> **可能重复：**
> [从 iframe 调用父级中的 Fancybox](https://stackoverflow.com/questions/8853727/call-fancybox-in-parent-from-iframe)

嗨，我`iframe`在我的主页上有。里面是一个画廊，当我点击图片时，我想在我的父页面中打开图片`fancybox`。我尝试了任何方法，但它只打开一张图片，没有带有下一个和上一个按钮的完整图库。

我的例子：

`index.html`

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="imagetoolbar" content="no" />
    <title>FancyBox 1.3.4 | Demonstration</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script>
        !window.jQuery && document.write('<script src="jquery-1.4.3.min.js"><\/script>');
    </script>
    <script type="text/javascript" src="./fancybox/jquery.mousewheel-3.0.4.pack.js"></script>
    <script type="text/javascript" src="./fancybox/jquery.fancybox-1.3.4.pack.js"></script>
    <link rel="stylesheet" type="text/css" href="./fancybox/jquery.fancybox-1.3.4.css" media="screen" />
    <link rel="stylesheet" href="style.css" />

    <script type="text/javascript">
        function readyFancy(){
            $("a#sample").trigger("click");
        }
        function callMe(site){ 
            $("#sample").fancybox({
                'transitionIn'      : 'none',
                'transitionOut'     : 'none',
                'href'              : ''+site+'',
                'autoScale'          : true,
                'onStart'           : function(){$("body").css({'overflow':'hidden'});},
                'onClosed'          : function(){$("body").css({"overflow":"visible"});}
            });
        readyFancy();
        }
    </script>

</head>
<body style="padding: 20px;">
<a href="#" id="sample"></a> <!-- here we set a decoy link for the frame to be triggered-->
<p>Below is an iframe</p>
<iframe src="sample.html" width="300" height="200"> <!--the link of the iframe-->
</body>
</html> 
```

`sample.html`

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
</head>
<body >
<div>
<a onClick="parent.callMe('http://localhost/fan/1_b.jpg');" href="#" ><img src="1_s.jpg"></a>
<a onClick="parent.callMe('http://localhost/fan/2_b.jpg');" href="#" ><img src="2_s.jpg"></a>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:27:13.820

如果您使用`ID`作为选择器`$("#selector").fancybox();`然后切换到类 -`$(".selector").fancybox();`

# c++ - 有人能解释一下这个 C 代码是如何计算 2^n 的吗？

> ID：14416717
> 
> 赞同：0
> 
> 时间：2013-01-19T17:09:43.460
> 
> 标签：c++, algorithm, math

这是解决问题的代码。我确实知道如何在 O(logn) 时间内计算 m^n 的概念，我认为它是相关的，但是如何？

```
for(long long int i = 2; N; N /= 2, i *= i){
    if(N & 1){
        ans *= i;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T17:14:28.610

这就是[平方和乘法算法](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)。

N /= 2 具有移除最低位的效果（当剩余的所有位都为零时，算法完成）。

N & 1 检查最低位是奇数还是偶数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:17:18.403

它的工作方式基本上与 log N time m power n 算法的工作方式相同。只需跟踪这两组输入的代码：

PS：ans 应设置为 1。

1.  n=2
2.  n=3

我相信你会得到它。

# iphone - 应用选择了错误的数据库路径

> ID：14416719
> 
> 赞同：0
> 
> 时间：2013-01-19T17:10:03.650
> 
> 标签：iphone, database, sqlite, connection

我为我的 iPhone 应用程序使用了一个名为 db.sqlite 的数据库。为了找到正确的路径，我使用以下代码：

```
- (NSString *) filePath {
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
return [[paths objectAtIndex:0] stringByAppendingPathComponent:@"db.sqlite"]; 
```

}

这将返回以下路径：

```
/Users/*******/Library/Application Support/iPhone Simulator/6.0/Applications/E1D5F78D-7FD2-45D7-A3DE-B53BCBB9BDC5/Documents/db.sqlite 
```

但是这个路径的数据库是新创建的并且是空的。将正确的路径作为字符串返回时效果很好，但我认为这不适用于 iPhone。

```
return @"/Users/*******/workspace/xcode/MyApp/MyApp/db.sqlite"; 
```

我做错了什么或忘了做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:32:49.197

您发布的代码用于从应用程序的 Documents 沙箱目录中获取文件。根据您想要的路径，您需要从应用程序的资源包中获取文件。

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"db" ofType:@"sqlite"]; 
```

请记住，您的 db.sqlite 文件在应用程序包中是只读的。不要尝试写入此数据库文件。

如果需要写入数据库，必须先将文件复制到可写位置（如 Documents 目录）。然后使用该文件的副本进行所有读取和写入。

# iphone - iOS - heightForFooterInSection 的动画变化

> ID：14416725
> 
> 赞同：0
> 
> 时间：2013-01-19T17:10:47.637
> 
> 标签：iphone, objective-c, xcode, uitableview, animation

我有一个包含 3 个部分的应用程序，每个部分都有一个页脚。我已经通过 viewForFooterInSection 建立了这一点，并使用 heightForFooterInSection 为每个设置了高度。

这些页脚不是固定大小的，因为它们会根据某些事情改变高度。当高度变化时，这是一个非常不稳定的动画。而不是显示高度变化，它只是从旧高度跳到新高度。

```
if (condition == YES) {
    return 45;
}

else {
    return 70;
} 
```

有没有办法为这种高度变化设置动画以提供更流畅的体验？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:12:07.640

创建一个自定义页脚视图并保留它的本地变量...

```
- (UIView*)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section {
    return self.footerView;
} 
```

然后你应该可以打电话

```
[self.footerView updateHeightForCondition:YES]; //or NO 
```

如所须。

这将是......

```
[UIView animateWithDuration:0.5f animations:^{
    self.frame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, condition ? 45 : 70);
}]; 
```

如果您覆盖 viewForFooter，则不再需要覆盖 heightForFooterInSection 或 titleForFooterInSection。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T19:21:09.103

这适用于对单元格高度进行动画更改，我看不出它为什么不适用于页眉和页脚高度。我目前无法自己测试它，如果它不起作用，请道歉 - 让我知道，我会删除它。

对模型或控制器属性进行任何更改（这样下次调用 heightForFooter.. 时，将返回新值）。然后，只需调用：

```
[self.tableView beginUpdates];
[self.tableView endUpdates]; 
```

调用这两个方法之间没有任何内容似乎很不寻常，但这会导致表重新查询其委托和数据源以获得新大小，并动画到该新大小。通常您会添加或删除行，但也包括更改大小。

# android - SMSObserver：从 moveToNext 更改为 move(int offset) 或 moveToPosition(int position) 以达到特定索引

> ID：14416726
> 
> 赞同：0
> 
> 时间：2013-01-19T17:11:06.280
> 
> 标签：android

```
 public void onChange(boolean selfChange) {
        Log.e("Info","Notification on SMS observer");
        Cursor sms_sent_cursor = mContext.getContentResolver().query(SMS_STATUS_URI, null, null, null, null);
           if(sms_sent_cursor.moveToNext()){ //This is the line I would like to change.
                 String protocol = sms_sent_cursor.getString(sms_sent_cursor.getColumnIndex("protocol"));

           }

  } 
```

问题是，当我的应用程序正在运行一些其他活动时，ContentObserver 保持活动状态，观察 SMS 活动，但是如果在我的应用程序执行一些其他活动时发送了 5 条 SMS，则观察者等待活动完成（因为它可能使用一个线程）所以它可以被调用。但问题是当它被调用时，方法调用`sms_sent_cursor.moveToNext()`将调用最后一条短信，而其他四个将被忽略。

这就是为什么我正在考虑从`moveToNext()`to`move(int offset)`或`moveToPosition(int position)`

但我不知道将什么作为这些方法的参数以转到特定消息，即调用它的消息而不是最后一个消息。

任何人有任何想法或知道任何其他方式来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:44:25.710

你可以试试 -

```
 Cursor sms_sent_cursor = mContext.getContentResolver().query(SMS_STATUS_URI, null, "date > "+sLastSeenSmsDate, null, null);
  if(sms_sent_cursor.moveToFirst()){ 
      do {
           String protocol = sms_sent_cursor.getString(sms_sent_cursor.getColumnIndex("protocol"));
         } while (query.moveToNext());
  }
  query.close(); 
```

# c# - SimpleMemberShipProvider，将多个 PropertyValues 与自定义数据库表一起使用

> ID：14416728
> 
> 赞同：2
> 
> 时间：2013-01-19T17:11:16.980
> 
> 标签：c#, asp.net-mvc-4, simplemembership

我正在使用`SimpleMembershipProvider`MVC4 创建登录方案。我想要比开箱即用的更多控制`AccountControl`。所以我修改了连接以使用我的数据库和表，但是我希望像名字、姓氏和电子邮件这样的字段是必需的。

```
WebSecurity.CreateUserAndRole(username, password); 
```

由于必需的字段类型而失败。我发现我可以用它`PropertyValues`来解决这个问题，但是我不知道如何使`PropertyValues`等于多个值。

```
WebSecurity.CreateUserAndAccount(user.Username, user.password, propertyValues: new {firstName = user.firstName}); 
```

我该如何使用多个`PropertyValues`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:18:37.013

我不确定，但您是否可以尝试向`new {}`您正在创建的对象添加另一个条目。就像是：

```
WebSecurity.CreateUserAndAccount(user.Username, user.password,
                                 propertyValues: new {firstName = user.firstName,
                                                      lastName = user.lastName}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T13:15:18.123

您必须将列 (firstName & lastName) 添加到 aspnet DB 中的表 dbo.UserProfile（在文件夹 app_data 中）才能使用：

```
WebSecurity.CreateUserAndAccount(model.UserName, model.Password, new {firstName = user.firstName, lastName = user.lastName}); 
```

# sql - 返回多行的列值作为链接项的列

> ID：14416733
> 
> 赞同：0
> 
> 时间：2013-01-19T17:11:44.480
> 
> 标签：sql, tsql, sybase

我有一个（简化的）表，其结构如下：

```
Table: ItemData

PK | ScanCode | StoreFK | Retail | ReceiptAlias
1  | 100101   | 1       | 4.99   | Milk
4  | 100101   | 2       | 4.99   | Milk
7  | 100101   | 3       | 0.99   | Milk
2  | 100102   | 1       | 6.99   | Eggs
5  | 100102   | 2       | 6.99   | Eggs
8  | 100102   | 3       | 6.99   | Eggs
3  | 100103   | 1       | 7.99   | Bread
6  | 100103   | 2       | 8.99   | Bread
9  | 100103   | 3       | 9.99   | Bread 
```

我可以使用以下 SQL 查询来获取以下返回结果，其中显示了在一个或多个商店具有不同零售的所有商品：[请参阅此先前提出的问题](https://stackoverflow.com/questions/14287188/comparing-similar-columns-for-equality)

**SQL查询：**

```
SELECT   im.INV_ScanCode     AS ScanCode,
         name.ItemData AS im
GROUP BY ScanCode, Receipt_Alias
HAVING   COUNT(DISTINCT im.Retail) > 1
ORDER BY ScanCode 
```

**当前回报结果：**

```
ScanCode | Receipt_Alias 
100101   | Milk
100103   | Bread 
```

我想退回在一个或多个商店具有不同零售的所有商品以及每个商店位置的零售**：**

**期望的回报结果：**

```
ScanCode | Receipt_Alias | Str_1 | Str_2 | Str_3
100101   | Milk          | 4.99  | 4.99  | 0.99
100103   | Bread         | 7.99  | 8.99  | 9.99 
```

如何更改我的 SQL 查询以包括每个商店位置的零售？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:14:42.480

```
SELECT  ScanCode as ItemID,
        ReceiptAlias,
        MAX(CASE WHEN StoreFK = 1 THEN Retail ELSE NULL END) Store_1,
        MAX(CASE WHEN StoreFK = 2 THEN Retail ELSE NULL END) Store_2,
        MAX(CASE WHEN StoreFK = 3 THEN Retail ELSE NULL END) Store_3
FROM    ItemData
GROUP   BY ScanCode, ReceiptAlias
HAVING  COUNT(DISTINCT Retail) > 1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/0e98a/4)

# floating-point - Lua - 打包 IEEE754 单精度浮点数

> ID：14416734
> 
> 赞同：10
> 
> 时间：2013-01-19T17:11:45.357
> 
> 标签：floating-point, lua, ieee-754, pack

我想在纯 Lua 中创建一个函数，它从一个数字中生成一个**分数**（23 位）、一个**指数**（8 位）和一个**符号**（1 位），使该数字大约等于`math.ldexp(fraction, exponent - 127) * (sign == 1 and -1 or 1)`，然后将生成的值转换为 32 位。

数学库中的某个函数引起了我的注意：

> frexp 函数将浮点值 (v) 分解为尾数 (m) 和指数 (n)，使得 m 的绝对值大于等于 0.5 且小于 1.0，且 v = m * 2^n。
> 
> 注意 math.ldexp 是逆运算。

但是，我想不出任何方法来正确打包非整数。由于此函数返回的尾数不是整数，我不确定是否可以使用它。

有没有任何有效的方法来做类似于`math.frexp()`返回整数作为尾数的事情？或者是否有更好的方法在 Lua 中以 IEEE754 单精度浮点格式打包数字？

先感谢您。

**编辑**

我在此展示我制作的函数的（希望是）最终版本：

```
function PackIEEE754(number)
    if number == 0 then
        return string.char(0x00, 0x00, 0x00, 0x00)
    elseif number ~= number then
        return string.char(0xFF, 0xFF, 0xFF, 0xFF)
    else
        local sign = 0x00
        if number < 0 then
            sign = 0x80
            number = -number
        end
        local mantissa, exponent = math.frexp(number)
        exponent = exponent + 0x7F
        if exponent <= 0 then
            mantissa = math.ldexp(mantissa, exponent - 1)
            exponent = 0
        elseif exponent > 0 then
            if exponent >= 0xFF then
                return string.char(sign + 0x7F, 0x80, 0x00, 0x00)
            elseif exponent == 1 then
                exponent = 0
            else
                mantissa = mantissa * 2 - 1
                exponent = exponent - 1
            end
        end
        mantissa = math.floor(math.ldexp(mantissa, 23) + 0.5)
        return string.char(
                sign + math.floor(exponent / 2),
                (exponent % 2) * 0x80 + math.floor(mantissa / 0x10000),
                math.floor(mantissa / 0x100) % 0x100,
                mantissa % 0x100)
    end
end
function UnpackIEEE754(packed)
    local b1, b2, b3, b4 = string.byte(packed, 1, 4)
    local exponent = (b1 % 0x80) * 0x02 + math.floor(b2 / 0x80)
    local mantissa = math.ldexp(((b2 % 0x80) * 0x100 + b3) * 0x100 + b4, -23)
    if exponent == 0xFF then
        if mantissa > 0 then
            return 0 / 0
        else
            mantissa = math.huge
            exponent = 0x7F
        end
    elseif exponent > 0 then
        mantissa = mantissa + 1
    else
        exponent = exponent + 1
    end
    if b1 >= 0x80 then
        mantissa = -mantissa
    end
    return math.ldexp(mantissa, exponent - 0x7F)
end 
```

我改进了使用隐式位的方法，并添加了对特殊值（例如 NaN 和无穷大）的适当支持。我的格式基于 catwell 链接到的脚本的格式。

我感谢你们两位的伟大建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T17:14:26.570

将得到的有效数乘以`math.frexp()`2^24，然后从指数中减去 24 以进行补偿。现在有效数字是一个整数。请注意，有效位是**24**位，而不是 23 位（您需要考虑 IEEE-754 编码中的隐式位）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T09:48:14.243

你见过[这个](https://github.com/fperrad/lua-MessagePack/blob/master/src/MessagePack.lua#L320)吗？

我认为它以稍微简单的方式完成了您想要的工作。

# linux - 微控制器、触摸屏 QVGA 和 Web 客户端？

> ID：14416735
> 
> 赞同：0
> 
> 时间：2013-01-19T17:11:46.167
> 
> 标签：linux, embedded, som

我已经在一个小小的 ATmega 上工作了一年，并且有一个非常好的 GUI 和事件系统。除了，完成无线驱动后，我想知道，还有其他方法吗？

我想知道是否有人遇到过任何具有 GPIO、uC、QVGA 显示器和触摸屏的设备，但重要的是 - 可以支持 Web 客户端。这个想法是，我可以有一个小型嵌入式 Web 服务器，为自己提供一个显示在 QVGA 屏幕上的网页。外部客户端可以通过无线连接，并查看同一屏幕。

我在嵌入式应用程序中看到了很多 Web 服务器，但没有看到 Web 客户端。因此，我使用了一个小型 Linux 嵌入式设备，并尝试将一些 Web 客户端和驱动程序加载到 QVGA/触摸屏。我也看到了这些；[http://www.netmf.com/gadgeteer/get-started.aspx](http://www.netmf.com/gadgeteer/get-started.aspx) - 使用 .NET 的“模块系统”设备。不确定您是否可以轻松地将网络客户端放在上面。

我能得到一些方向吗？

# java - 带振动的简单加减法

> ID：14416737
> 
> 赞同：1
> 
> 时间：2013-01-19T17:12:08.537
> 
> 标签：java, android

这是我的加减法程序代码，但问题是在手机上加入振动的最佳方法是什么，例如文本布局显示数字为-1。所以手机然后以某种方式振动-1 ..我知道我需要做一个if语句，但我似乎遇到了麻烦..这是程序的java代码..谢谢你的帮助！

```
package com.example.untitled3;

import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MyActivity extends Activity {

    int counter;
    Button add , sub;
    TextView display;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        counter = 0;
        add = (Button) findViewById(R.id.bAdd);
        sub = (Button) findViewById(R.id.bSub);
        display = (TextView) findViewById(R.id.tvDisplay);

        add.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // Adds 1 to the counter
                counter = counter + 1;
                display.setText(" Your total is :" + counter);
            }
        });

        sub.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // Subtract 1 from counter
                counter = counter - 1;
                display.setText(" Your total is :" + counter);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:18:04.567

您可以使用以下代码使手机振动：

```
Vibrator vibe = (Vibrator) context.getSystemService(Context.VIBRATOR_SERVICE) ; 
```

在某些情况下（在您的情况下，当文本显示-1时）调用此：

```
vibe.vibrate(200); // 200 is time in ms 
```

并且不要忘记您需要将权限添加到清单（在`</application>`标记之后）：

```
<uses-permission android:name="android.permission.VIBRATE" /> 
```

**编辑：**

创建一个初始化为零的整数变量。单击添加按钮时增加变量，单击减法按钮时减少变量。每次点击后检查 count 变量的值，如果为零则调用`vibe.vibrate(200);`.

# mapping - 本体映射和对齐

> ID：14416740
> 
> 赞同：0
> 
> 时间：2013-01-19T17:12:39.673
> 
> 标签：mapping, alignment, ontology

本体映射和对齐仍然是一个新鲜的研究领域。它用于将两个或多个本体（如 owl 或 owl2）组合到一个称为对齐的文件中。任何人有任何想法或算法来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:37:43.420

如果您负担得起，或者您的工作场所可以购买，请购买 Jérôme Euzenat 和 Pavel Shvaiko 所著的《本体匹配》一书。它包含对技术、算法、工具和参考的描述。顺便说一句，作者正在制作一个新的更新版本，所以如果你能等一下，购买更新的版本。

如果您想深入了解该主题并且您非常有动力，您可以查看网站 www.ontologymatching.org 上[约 700 多篇关于本体匹配主题的学术出版物的参考列表。](http://www.ontologymatching.org/publications.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T22:53:48.837

你已经知道了什么？你调查了什么？

你见过吗 - [http://wifo5-03.informatik.uni-mannheim.de/bizer/silk/](http://wifo5-03.informatik.uni-mannheim.de/bizer/silk/) - 专门用于在本体之间生成链接的完整框架。

另见 - [http://oaei.ontologymatching.org/](http://oaei.ontologymatching.org/)

术语语义相似度的概念 - [http://en.wikipedia.org/wiki/Normalized_Google_distance](http://en.wikipedia.org/wiki/Normalized_Google_distance)，wordnet 相似度。

您还可以研究使用叙词表的方法，例如。umls（在医学领域），维基百科页面重定向更普遍。

# ios - 放大核心图时更改majorIntervalScale

> ID：14416745
> 
> 赞同：0
> 
> 时间：2013-01-19T17:13:05.547
> 
> 标签：ios, core-plot

我正在尝试在缩放时更改为核心情节的majorIntervalScale，以便缩小时轴上出现的项目较少，放大时出现的项目更多。我无法让它工作，任何人都可以帮忙吗？这是我到目前为止得到的代码。谢谢

```
-(BOOL)plotSpace:(CPTPlotSpace *)space shouldScaleBy:(CGFloat)interactionScale aboutPoint:(CGPoint)interactionPoint
{
    return YES;
}

-(CPTPlotRange *)plotSpace:(CPTPlotSpace *)space willChangePlotRangeTo:(CPTPlotRange *)newRange forCoordinate:(CPTCoordinate)coordinate
{
    self.graphScaleX = self.graphScaleX*newRange.lengthDouble;
    self.graphScaleY = self.graphScaleY*newRange.lengthDouble;

    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)self.graph.axisSet;
    CPTXYAxis *x          = axisSet.xAxis;

    CPTXYAxis *y          = axisSet.yAxis;

    x.majorIntervalLength=CPTDecimalFromFloat(self.graphScaleX);
    y.majorIntervalLength=CPTDecimalFromFloat(self.graphScaleY);

    return newRange;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:20:36.783

无论绘图范围的长度如何，您似乎总是希望拥有相同数量的刻度线。如果是这样，请使用不同的轴标签策略而不是委托。该`CPTAxisLabelingPolicyAutomatic`策略将在“好”数字上找到刻度线，但不一定在绘图范围的末端。将从绘图范围的`CPTAxisLabelingPolicyEqualDivisions`一端开始放置等间距的刻度并继续到另一端。这两个标签策略都使用`preferredNumberOfMajorTicks`来控制要绘制多少个刻度线。

# node.js - 尝试通过 npm 在 NodeJS 中安装 websocket 模块时出错

> ID：14416750
> 
> 赞同：3
> 
> 时间：2013-01-19T17:13:58.843
> 
> 标签：node.js, websocket, npm

当我尝试`websocket`在 NodeJS 中安装模块时出现以下错误。我正在尝试使用 Ubuntu 12.04 机器。

```
ubuntu@domU-12-31-39-14-1A-A1:/var/www$ npm install websocket
npm http GET https://registry.npmjs.org/websocket
npm http 304 https://registry.npmjs.org/websocket

> websocket@1.0.8 install /var/www/node_modules/websocket
> node install.js

[websocket v1.0.8] Attempting to compile native extensions.
[websocket v1.0.8]
Native code compile failed!!
Please note that this module DOES NOT REQUIRE the native components
and will still work without them, though not quite as efficiently.

On Windows, native extensions require Visual Studio and Python.
On Unix, native extensions require Python, make and a C++ compiler.
Start npm with --websocket:verbose to show compilation output (if any).
websocket@1.0.8 node_modules/websocket 
```

我用来安装`websocket`模块的命令是`npm install websocket`. 有人可以建议出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T19:59:43.160

检查是否安装了 python 和 make。我没有在 Ubuntu 上这样做，但在 Windows7 上出现了同样的错误。这篇[文章](https://github.com/Worlize/WebSocket-Node/issues/28)很有帮助。我尝试使用 npm install websocket@1.0.3 并且它有效。

# java - 使用 getImage 加载图像

> ID：14416751
> 
> 赞同：1
> 
> 时间：2013-01-19T17:14:01.937
> 
> 标签：java, image, graphics

这是一个尝试加载图像的简单小程序，但它显示一个空白窗口

```
import java.applet.*;
import java.awt.*;

public class Mama extends Applet {

int width, height;
Image img;

@Override
public void init(){
    img = getImage(getCodeBase(), "C:\\Users\\......\\Backgound.png");
}

@Override 
public void paint(Graphics g){
    g.drawImage(img, 0, 0, this);
  }
} 
```

我从目录中复制了图像的路径，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:22:10.843

除非它们被签名，否则小程序只能从加载它们的相同位置读取文件。将图像移动到相对于类（或文档）路径可访问的位置并使用：

```
img = getImage(getCodeBase(), "Backgound.png"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-13T03:15:27.990

你可以写在这里

```
import java.applet.Applet;
import java.awt.*;
import java.net.URL;

public class SimpleImageLoad extends Applet {
    Image img;

    @Override
    public void init() {
        super.init();
        img=getImage(getCodeBase(),"file:\\D:\\pic.PNG");
        System.out.println(getCodeBase());
    }

    @Override
    public void paint(Graphics g) {
        super.paint(g);
        g.drawImage(img,0,0,this);
    }
} 
```

# sqlite - Windows Phone 8 中的 SQLite

> ID：14416758
> 
> 赞同：1
> 
> 时间：2013-01-19T17:14:32.933
> 
> 标签：sqlite, windows-phone-7, windows-phone-7.1, windows-phone-8, windows-phone

我正在尝试将我的 WP 7.1 应用程序转换为 WP8。目标仍然是 WP 7.1，但我正在尝试在 WP8 设备上进行调试。我正在使用[CSharp-SQLite](http://code.google.com/p/csharp-sqlite/)，但是当我尝试访问数据库并调用`.Open`连接时，出现错误：`A first chance exception of type 'System.IO.IsolatedStorage.IsolatedStorageException' occurred in mscorlib.ni.dll`

我记得由于这些例外，为 WP7.1 开发是一场噩梦。有没有可靠的方法在 WP8 中使用 SQLite？

**编辑：**我在桌面应用程序、WP 应用程序和 iOS 应用程序之间共享这个数据库，所以我需要访问表。我不能只让 ORM 包装器为我创建表。有没有办法只访问 tp DbDataReader？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:03:19.830

经过几周尝试使用[Vici CoolStorage DLLs](http://viciproject.com/wiki/projects/coolstorage/home)的各种建议后，我终于解决了这个问题。

# c - 从函数返回 char[]/string

> ID：14416759
> 
> 赞同：47
> 
> 时间：2013-01-19T17:14:35.233
> 
> 标签：c, arrays, string, char, return

我对 C 语言编码相当陌生，目前我正在尝试创建一个返回 ac 字符串/字符数组并分配给变量的函数。

到目前为止，我观察到返回一个 char * 是最常见的解决方案。所以我尝试了：

```
char* createStr() {
    char char1= 'm';
    char char2= 'y';
    char str[3];
    str[0] = char1;
    str[1] = char2;
    str[2] = '\0';
    char* cp = str;
    return cp;
} 
```

我的问题是如何使用这个返回`char*`并将它指向的 char 数组分配给 char[] 变量？

我试过（都导致菜鸟溺水错误）：

1.  `char* charP = createStr();`
2.  `char myStr[3] = &createStr();`
3.  `char* charP = *createStr();`

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-19T17:18:33.227

请注意，您不是动态分配变量，这几乎意味着函数中的数据`str`将在函数结束时丢失。

你应该有：

```
char * createStr() {

    char char1= 'm';
    char char2= 'y';

    char *str = malloc(3);
    str[0] = char1;
    str[1] = char2;
    str[2] = '\0';

    return str;

} 
```

然后，当您调用该函数时，将接收数据的变量的类型必须与函数返回的类型相匹配。所以，你应该有：

```
char *returned_str = createStr(); 
```

值得一提的是，必须释放返回值以防止内存泄漏。

```
char *returned_str = createStr();

//doSomething
...

free(returned_str); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-19T17:17:12.973

如果你想`char*`从一个函数中返回一个，请确保`malloc()`它。堆栈初始化的字符数组在返回时没有意义，因为从该函数返回后访问它们是未定义的行为。

将其更改为

```
char* createStr() {
    char char1= 'm';
    char char2= 'y';
    char *str = malloc(3 * sizeof(char));
    if(str == NULL) return NULL;
    str[0] = char1;
    str[1] = char2;
    str[2] = '\0';
    return str;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-07-29T13:44:46.270

您可以在方法中使用静态数组，以避免在函数结束时丢失数组：

```
char * createStr() 
{
    char char1= 'm';
    char char2= 'y';

    static char str[3];  
    str[0] = char1;
    str[1] = char2;
    str[2] = '\0';

    return str;
} 
```

编辑：正如 Toby Speight 提到的，这种方法不是线程安全的，并且调用该函数会导致某些应用程序中不需要的数据覆盖。因此，您必须在从函数返回后立即将数据保存在缓冲区中。（但是因为它不是线程安全的方法，在某些情况下并发调用仍然会出现问题，为了防止这种情况你必须使用锁。进入函数时捕获它并在复制完成后释放它，我不喜欢使用这个方法，因为它混乱且容易出错。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-19T17:18:12.447

```
char* charP = createStr(); 
```

如果您的功能正确，那将是正确的。不幸的是，您正在返回指向函数中局部变量的指针，这意味着一旦函数返回，它就是指向未定义数据的指针。您需要对函数中的字符串使用诸如 malloc 之类的堆分配，以使您返回的指针具有任何意义。然后你需要记住以后释放它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-11T11:16:55.153

包含“string.h”会使事情变得更容易。解决问题的更简单方法是：

```
#include <string.h>
    char* createStr(){
    static char str[20] = "my";
    return str;
}
int main(){
    char a[20];
    strcpy(a,createStr()); //this will copy the returned value of createStr() into a[]
    printf("%s",a);
    return 0;
} 
```

# javascript - 访问动态加载的 html 元素

> ID：14416769
> 
> 赞同：0
> 
> 时间：2013-01-19T17:15:47.613
> 
> 标签：javascript, jquery, html, ajax

我正在尝试使用 ajax 在我的文档中加载一些 html。加载只是文件，我无法做的是使用 jquery 选择器访问加载的 html。

这是脚本：

```
$(document).ready(function(){
    $.ajax({
          url: 'header.html',
          dataType: 'html',
          success: function(data) {
            $("#header").html(data);
    });
}); 
```

网页：

```
 <body>
    <div id="wrapper">
      <div id="header">
      </div><!--header end-->
    </div>
   </body> 
```

我正在尝试访问这样的 html 元素：

```
$('#bigmenu').hide();
$('#mydiv').mouseenter(function(e){
    $('#bigmenu').fadeIn(100);
}); 
```

`#bigmenu`并且`#mydiv`是动态加载的 html 的元素

但是，如果我尝试在 ajax`success`函数中访问它们，它会起作用。

我的问题是 - 我如何在成功功能之外访问它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:19:24.827

Ajax 被`async`调用，成功事件将在您的函数完成执行后首先出现。如果您在调用成功函数之前访问该元素，那么它将不可用。这就是为什么在成功“#bigmenu”上动态添加元素在成功之前无法隐藏的原因。并且隐藏没有被渲染的元素会失败，所以在成功添加到dom之后执行隐藏功能。类似地，您需要使用`on`来为动态添加的元素注册事件。

```
$(document).mouseenter('mouseenter','#mydiv', function(e){
    $('#bigmenu').hide();
    $('#bigmenu').fadeIn(100);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:17:51.583

```
$(document).on('mouseenter', '#mydiv', function(e){
    $('#bigmenu').hide().fadeIn(100);
}); 
```

您必须将该事件委托给动态加载的 HTML 元素。您必须将 div 隐藏（）才能在其上播放动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:18:02.730

对于已更改 DOM 的动态加载元素，您需要使用以下[`on()`](http://api.jquery.com/on/)方法：

```
$('#bigmenu').hide();

$('#mydiv').on('mouseenter', function() {
    $('#bigmenu').fadeIn(100);
}); 
```

您不必这样做`hide()`——您只需使用`on()`以[JavaScript 事件](http://www.w3schools.com/js/js_htmldom_events.asp)为中心的功能。

# ios - 核心数据 - 删除持久存储时出现死锁

> ID：14416770
> 
> 赞同：7
> 
> 时间：2013-01-19T17:15:52.090
> 
> 标签：ios, core-data

有没有一种安全的方法来删除应用程序中的持久存储（并创建一个新的），其中其他线程正在使用与被删除的存储关联的 NSManagedObjectContext？我曾尝试锁定 NSPersistentStoreCoordinator 并在操作结束后解锁它，但它没有帮助 - 我所有的尝试都导致了死锁。它总是发生在这一行（在主线程上执行）：

```
[self.persistentStoreCoordinator removePersistentStore: store error: &error]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-05T17:22:59.670

我还没有尝试过，但是从[moc 上的文档中](https://developer.apple.com/library/ios/documentation/cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html) `setPersistentStoreCoordinator:`...

> 协调器提供托管对象模型并处理持久性。请注意，多个上下文可以共享一个协调器。
> 
> 如果 coordinator 为 nil，则此方法引发异常。如果你想从它的持久存储协调器“断开”一个上下文，你应该简单地将所有对上下文的强引用设置为 nil 并允许它被正常释放。

这表明删除 psc 的安全方法是首先让每个带有 moc 的线程释放它（在 ARC 中对它的 nil-out 引用），然后执行`removePersistentStore:`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-05T20:57:44.167

> 有没有一种安全的方法来删除应用程序中的持久存储（并创建一个新的），其中其他线程正在使用与被删除的存储关联的 NSManagedObjectContext？

*如果您可以保证没有实时托管对象将尝试访问持久存储，那么*它应该是安全的。这部分至关重要：您必须确保没有任何类型的活动对象已从旧持久存储加载或以其他方式与旧持久存储相关联。

您可以通过重置每个托管对象上下文来做到这一点：

```
[managedObjectContext performBlockAndWait:^{
    [managedObjectContext reset];
}]; 
```

*为每个*托管对象上下文完成此操作后，您可以删除持久存储。

请注意，如果您有任何从这些上下文中获取的托管对象，则必须立即处置它们，而不读取或写入属性值或以任何方式使用它们。这些对象可能出于各种原因需要使用上下文，但在调用`reset`上下文之后，它们就不再了解它们了。立即摆脱它们（最好是在调用 reset 之前），因为它们是定时炸弹，等着你一碰就炸毁你的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-05T17:23:52.473

我会尝试使用此处描述的方法（*Parent/Child Contexts*部分）： [Multi-Context CoreData](http://www.cocoanetics.com/2012/07/multi-context-coredata/)

基本上，您的 PSC 只有一个与之关联的 MOC（父 MOC）。其他线程有自己的 MOC，它们`parentContext`设置为主 MOC（与 PSC 关联的 MOC）。

然后你可以尝试这样的事情：

```
// Save each child MOC
for (NSManagedObjectContext *moc in self.someChildMOCs)
{
   [moc performBlockAndWait:^{

       // push to parent
       NSError *error;
       NSAssert([moc save:&error]);
       moc.parentContext = nil;
   }];
}

// Save parent MOC to disk
[self.mainMOC performBlockAndWait:^{
   NSError *error;
   NSAssert([mainMOC save:&error]);
}];

[self.persistentStoreCoordinator removePersistentStore:store error:&error];
mainMOC.persistentStoreCoordinator = nil; 
```

# ruby - 与 string#concat(integer) 方法的输出混淆

> ID：14416772
> 
> 赞同：0
> 
> 时间：2013-01-19T17:15:55.860
> 
> 标签：ruby

我正在四处测试该`String#concat(integer)`方法。代码如下：

```
irb(main):006:0> a="hello"
=> "hello"
irb(main):008:0> a<< "world"
=> "helloworld"
irb(main):009:0> a.concat(33)
=> "helloworld!"
irb(main):010:0> a.concat(32)
=> "helloworld! "
irb(main):011:0> a.concat(31)
=> "helloworld! \x1F"
irb(main):012:0> a.concat(34)
=> "helloworld! \x1F\""
irb(main):013:0> a.concat(3)
=> "helloworld! \x1F\"\x03"
irb(main):014:0> 
```

但无法理解——为什么`33`value 给出`helloworld!`输出（正确，但不是其他整数）？

为什么/如何 32 给出输出`"helloworld! "`？

以什么方式`a << "world"`在内部制作字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:23:54.317

它给你`helloworld!`是因为`!`标记的 ASCII 码是 33. [Link](http://pic.dhe.ibm.com/infocenter/tivihelp/v2r1/index.jsp?topic=/com.ibm.IBMDS.doc_6.1/install29.htm)。

# scala - 意外的 Scala 映射类型

> ID：14416775
> 
> 赞同：5
> 
> 时间：2013-01-19T17:16:46.440
> 
> 标签：scala, type-inference

在 Scala (2.10) 中，如果我要求 a`List(1.0, 2)`那么我得到 a `List[Double]`，正如预期的那样。

但...

如果我要求 a`Map(1.0 -> 'A', 2 -> 'B')`我得到一个`Map[AnyVal, Char]`. 我希望钥匙是 type `Double`。要求`Map[Double, Char](1.0 -> 'A', 2 -> 'B)`在“2”上给出类型不匹配。

这是我最困惑的！不矛盾吗？

**旁白：** `List[(Double, Char)]((1.0, 'A'), (2, 'B')).toMap`虽然给了我一个 Map[Double, Char] 。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T17:50:31.223

如果您查看 Scala 的[类型层次结构](http://www.scala-lang.org/node/128)，您会发现原始类型不在子类型/超类型关系中。`Double`但是，有一种称为数字扩展的机制，例如，它允许您通过传入 say来调用带有参数的方法`Int`。然后`Int`自动“扩大”到`Double`.

这就是`List(1.0, 2)`给你的原因`List[Double]`。

但是`Map`构造函数需要`Tuple[A, B]`参数。数值扩展不适用于高阶类型，因此如果混合数值类型，目标类型推断对您不起作用。

```
case class Test[A](tup: (A, Char)*)
Test(1.0 -> 'A', 2 -> 'B') // AnyVal 
```

此外，箭头运算符`->`会妨碍您：

```
Test[Double](2 -> 'B') // found: (Int, Char)  required: (Double, Char) 
```

这是我认为类型推断的另一个限制。编写元组`a -> b`是 的语法糖`(a, b)`，由 on 的隐式方法`any2ArrowAssoc`提供[`Predef`](http://www.scala-lang.org/api/current/index.html#scala.Predef%24)。如果没有这种间接，如果你`Tuple2`直接构造，它可以工作：

```
Test[Double]((2, 'B')) 
```

所以数字扩大仍然不起作用，但至少你可以强制类型：

```
Map[Double, Char]((1.0, 'A'), (2, 'B')) 
```

* * *

最后一个例子展示了数值扩展的工作：

```
def map[A, B](keys: A*)(values: B*) = Map((keys zip values): _*)
map(1.0, 2)('A', 'B') // Map[Double, Char] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T17:46:50.217

在 List 的情况下，没有类型声明，Scala 会查看所有元素并尝试找到公共类型。在您的情况下，由于 Int 可以转换为 Double，它将您的混合 List 转换为 List[Double] 提升您的一个 Int。

Map 构造函数采用一系列 2 元组。如果您只是构建了一个元组列表，您将得到相同的行为：

```
scala> List((1, "one"), (2.0, "two.oh"))
res0: List[(AnyVal, String)] = List((1,one), (2.0,two.oh)) 
```

Tuple2[Int, String] 不能自动提升为 Tuple2[Double, String]。在这种情况下，您需要通过类型声明帮助编译器：

```
scala> val x: List[(Double, String)] = List((1, "one"), (2.0, "two.oh"))
x: List[(Double, String)] = List((1.0,one), (2.0,two.oh)) 
```

或者

```
scala> val x = List[(Double, String)]((1, "one"), (2.0, "two.oh"))
x: List[(Double, String)] = List((1.0,one), (2.0,two.oh)) 
```

或者在你的情况下：

```
scala> val x = List[(Double, String)]((1, "one"), (2.0, "two.oh")).toMap
x: scala.collection.immutable.Map[Double,String] = Map(1.0 -> one, 2.0 -> two.oh) 
```

由于某种原因，在 Map 上使用类型声明不起作用。不知道为什么：

```
scala> val x = Map[Double, String](1 -> "one", 2.0 -> "two.oh")
<console>:7: error: type mismatch;
found   : (Int, String)
required: (Double, String)
   val x = Map[Double, String](1 -> "one", 2.0 -> "two.oh") 
```

# ruby-on-rails - 在 Rails 应用程序中遍历用户的文件系统

> ID：14416777
> 
> 赞同：-1
> 
> 时间：2013-01-19T17:16:52.583
> 
> 标签：ruby-on-rails, ruby, ssh

我目前正在构建一个 Rails Web 应用程序，它可以扫描用户的文件系统，但需要首先清除我的知识库中的空白。在过去的几个月里，我一直在脑海中解决这个问题，但对于在用户点击“立即扫描我的系统！！”之间需要发生的事情有点模糊。按钮和我的应用程序实际扫描他们的文件系统并报告结果。

编辑：重新考虑安全隐患后，我选择将其作为桌面应用程序，然后允许用户将他们的结果上传到 Rails 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:48:00.793

除非用户将文件拖入应用程序 ( `<input type="file">`)，否则 Web 应用程序无法读取本地文件系统。你不能只细读本地文件系统——那将是一个巨大的安全风险。甚至网络插件都不允许这样做（除非你破解 Java 或 Flash——不应该太难:)）。您需要用户安装软件，如 SSH 服务器（太复杂）或您制作的软件（大量工作）。

无论如何，任何网络应用程序都不应该需要读取文件系统的整个部分。

这不能是一个网络应用程序。它需要是一个桌面应用程序。时期。对文件系统的 Web 访问就像给黑客一张纸，上面列出了他们需要的一切，这很痛苦，或者更糟。就是不行。

# jquery - JQuery slideUp/Down循环？

> ID：14416778
> 
> 赞同：0
> 
> 时间：2013-01-19T17:16:53.970
> 
> 标签：jquery, loops, html, slidedown, slideup

我哪里错了？ [http://jsfiddle.net/j5yTU/](http://jsfiddle.net/j5yTU/)

只希望 .ex 在鼠标离开该区域时向上滑动。但它似乎循环然后向上滑动。

```
 $("div.case").mouseover(function () {
var id = $(this).attr("id");
$(this).css("opacity", "1").css("filter", "alpha(opacity=100)");
$(".ex"+id).slideDown(500);
});

$("div.case").mouseout(function () {
var id = $(this).attr("id");
$(this).css("opacity", "0.4").css("filter", "alpha(opacity=40)");
$(".ex"+id).slideUp(500);
}); 
```

任何人都知道问题可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:22:11.780

尝试使用`mouseenter`and`mouseleave`代替。

如果您从每个子元素移动到具有绑定事件的元素中的另一个元素，也会触发这些事件`mouseover`。`mouseout`

您还可以使用`hover`which 是`mouseenter`and的别名`mouseleave`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:23:25.707

这可能是您执行此功能的更好方法：

```
$('.case').hover(function(){
    var id = $(this).attr('id');
    $(this).css('opacity':'1','filter':'alpha(opacity=100)');
    $('.ex'+id).slideDown(500);
},
function(){
    var id = $(this).attr('id');
    $(this).css('opacity':'0.4','filter':'alpha(opacity=40)');
    $('.ex'+id).slideUp(500);
}); 
```

hover 方法使用两个功能。第一个是初始悬停函数，第二个是悬停回调函数。`.ex`我猜的元素是以这种方式生成的？`.ex0,.ex1,.ex2`. 如果是这样，您的功能应该可以工作。如果`.ex`元素在`.case`其中并且有多个，`.case`则可以使用此选择器：

```
$('.ex',this) 
```

如果您有这些元素的列表，则可以使用您的方法来检索 id 并使用`:eq()`索引选择器：

```
$('.ex:eq('+id+')') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:23:29.107

[http://jsfiddle.net/j5yTU/1/](http://jsfiddle.net/j5yTU/1/)

```
 $("div.case img").mouseover(function () {
   ....
 }

  $("div.case img").mouseout(function () {
   ....
 } 
```

# html - 向左浮动被阻止且未与左侧对齐

> ID：14416782
> 
> 赞同：0
> 
> 时间：2013-01-19T17:17:24.547
> 
> 标签：html, css, css-float, dhtml

考虑下面的代码

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet">  
  <style>
     #block0 {
      width:400px
     }

     #block1, #block2, #block3 {
       float: left;
       display:inline;
     }

     #block1 {
        background-color:red;
        width:48%;
        height:200px;
      }

      #block2 {
        background-color:blue;
        width:48%;
        height:120px;
      }

      #block3 {
        background-color:green;
        width:48%;
        height:140px;
      }

  </style>

  </head>
  <body>

      <div id="block0">
          <div id="block1"></div>

          <div id="block2"></div>

          <div id="block3"></div>
      </div>

  </body>
</html> 
```

如何使`block3(green)`块向左对齐并使其位于`block1(red)`块下方，并具有以下限制：

1.  无需添加额外的 HTML 标记
2.  如果需要应用新的 css，需要应用到所有块

示例：http: [//jsfiddle.net/L4VWq/](http://jsfiddle.net/L4VWq/)

**更新：限制**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:42:06.740

```
 #block1, #block2, #block3 {
   display:inline-block;
   vertical-align: top;
 } 
```

（没有`float`）

为了消除标记留下的空间，您还可以添加一个负的右边距，如下所述：http: [//css-tricks.com/fighting-the-space-between-inline-block-elements/](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:19:36.963

添加 clear: left 到 css for block3

```
 #block3 {
    background-color:green;
    width:48%;
    height:140px;
    clear: left;
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:57:56.110

只需添加 clear:both; 到#block3

请参阅修改后的小提琴。

(http://jsfiddle.net/tech0925/L4VWq/1/)

# qt - 网页仅在从 Qt 连接时返回 HTTP 406 错误

> ID：14416786
> 
> 赞同：6
> 
> 时间：2013-01-19T17:17:49.897
> 
> 标签：qt, mod-security, qtnetwork

我在[http://mlecturedownload.com/test-qt.php](http://mlecturedownload.com/test-qt.php)有一个测试页面设置，其中包含以下代码：

```
<?php

$foo = $_GET['foo'];
if ($foo == "0" || $foo == "1") {
  echo $foo;
} else {
  echo "Invalid foo";
} 
```

在网络浏览器中访问此页面并修改 foo 的值可以正常工作，使用 curl 也可以正常工作。但是当我从 Qt 发送请求时，我得到一个 HTTP 406 错误代码，这意味着“不可接受”。这是我提出请求的方式：

```
void MainWindow::on_send_clicked()
{
    QString url = "http://mlecturedownload.com/test-qt.php?foo=1";

    QNetworkRequest request;
    request.setUrl(QUrl(url));
    nam->get(request); // nam is a QNetworkAccessManager
} 
```

这是从 Wireshark 获得的整个 HTTP 请求和响应

```
GET /test-qt.php?foo=1 HTTP/1.1
Connection: Keep-Alive
Accept-Encoding: gzip, deflate
Accept-Language: en-CA,*
User-Agent: Mozilla/5.0
Host: mlecturedownload.com

HTTP/1.1 406 Not Acceptable
Date: Sat, 19 Jan 2013 17:14:37 GMT
Server: Apache
Content-Length: 275
Keep-Alive: timeout=5, max=75
Connection: Keep-Alive
Content-Type: text/html; charset=iso-8859-1

<head><title>Not Acceptable!</title><script src='/google_analytics_auto.js'></script></head><body><h1>Not Acceptable!</h1><p>An appropriate representation of the requested resource could not be found on this server. This error was generated by Mod_Security.</p></body></html> 
```

看起来服务器上名为 mod_security 的 Apache 模块导致了问题。有一些方法可以通过 .htaccess 禁用它，但没有一个对我有用。但我宁愿解决问题而不是禁用模块。有谁知道发生了什么？

编辑：我发布的网站链接托管在 HostGator 上。我在我的 EC2 服务器上创建了一个测试页面，它运行良好，可能是因为我没有启用该安全模块。我仍然需要让它在 HostGator 服务器上运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T08:44:27.503

我遇到了同样的问题 - 尝试下载文件时出现“不可接受”错误。我做了一些谷歌搜索和实验，我发现添加：

```
request.setRawHeader( "User-Agent" , "Mozilla Firefox" ); 
```

在 get(request) 改变结果之前。:)

**我猜QNetworkRequest**的用户代理服务器无法识别，这导致了 406 错误消息。我需要做更多的测试，但我认为我应该分享我的突破。我希望它有帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-05T14:12:01.070

以下解决方案对我来说很划算：

```
 request.setRawHeader( "Accept" , "*/*" ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-13T15:03:58.257

它更像是一个被阻止的用户代理。将用户代理标头设置为其他任何内容，它应该可以正常工作。

```
request.setHeader(QNetworkRequest::UserAgentHeader, "Whatever you like"); 
```

[http://amin-ahmadi.com/2016/06/13/fix-modsecurity-issues-in-qt-network-module-download-functionality/](http://amin-ahmadi.com/2016/06/13/fix-modsecurity-issues-in-qt-network-module-download-functionality/)

# php - MYSQL查询检查用户是否喜欢

> ID：14416789
> 
> 赞同：0
> 
> 时间：2013-01-19T17:18:03.633
> 
> 标签：php, mysql

我要求查询语句我有两个表第一个表'posts'：

```
post_id     title    Userid
1           test     1 
```

另一张桌子是“喜欢”

```
userid  post_id
1       1 
```

我需要单个查询来检查用户是否喜欢这张照片 批量选择我的解决方案很差：

```
SELECT * FROM `table` WHERE x = x LIMIT 100; 
```

并给它 foreach 并对每一行进行查询：

```
foreach($results as $v)
{
   $data[1] = $v;
   $data[1]['is_like'] = SELECT COUNT(*) FROM likes WHERE userid = 1;
} 
```

1 是已经登录的用户 id

我需要单个查询来返回 post_id，.. 等并像 is_like 一样归档

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:22:26.317

假设`likes`只能有 1 行具有相同 (user_id,post_id) ：

```
SELECT p.* , 
CASE WHEN 
l.id IS NULL THEN 0
ELSE 1
END as is_liked
FROM posts p
LEFT JOIN likes l ON l.user_id = p.user_id and l.post_id =p.post_id 
```

如果不是（`likes`给定的 (user_id,post_id) 中的多行）：

```
SELECT p.* , 
CASE WHEN 
l.user_id IS NULL THEN 0
ELSE 1
END as is_liked
FROM posts p
LEFT JOIN 
(
   SELECT DISTINCT user_id,post_id FROM likes 
) l ON l.user_id = p.user_id and l.post_id =p.post_id; 
```

或者

```
SELECT p.* , 
CASE 
WHEN  EXISTS (SELECT NULL FROM likes l 
  WHERE l.user_id = p.user_id and l.post_id =p.post_id) THEN 1
ELSE 0
END as is_liked
FROM posts p 
```

**更新** 我希望我现在对这个问题有更好的理解。我的假设：`posts.user_id`是创建帖子的用户的 ID；`like`表存储有关谁喜欢该帖子的信息。因此，要检查所有帖子以及您是否需要特定的帖子（`$login_user_id`应该正确转义）

```
SELECT p.* , 
CASE 
WHEN  EXISTS (SELECT NULL FROM likes l 
  WHERE l.user_id = $login_user_id and l.post_id =p.post_id) THEN 1
ELSE 0
END as is_liked
FROM posts p 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T18:13:25.093

```
SELECT 
    p.post_id,
    p.title,
    IF(l.post_id IS NOT NULL,1,0) as like
FROM posts as p
LEFT JOIN likes as l ON l.post_id = p.post_id AND l.userid = p.userid
WHERE p.Userid = 1 
```

如果 likes 表中的 post_id 可用，它将返回 1，否则返回 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T18:04:30.413

像这样的东西应该作为单个查询工作（当然，未经测试 - 您没有提供太多用于测试的数据）：

```
select 
  p.title, count(l.post_id) 
from 
  `posts` p
inner join 
  `likes` l
on 
  l.userid = p.userid and l.post_id = p.post_id
where 
  p.userid = loggedinuserID
group by 
  p.userid 
```

这将为您提供指定用户喜欢的帖子总数的计数。

# ios - 用新的 UIImage 更新 UIImageView

> ID：14416793
> 
> 赞同：1
> 
> 时间：2013-01-19T17:18:08.663
> 
> 标签：ios, mono, xamarin.ios

*****更新*******

 **我的第一个描述（现已删除）不是真实情况。这是问题的简化版本。

**完整情况：**

我想用从 iphone 照片库中选择的图片更改 UIImageView 中的 UIImage。为此，我使用了 MediaPicker（Xamarin 库的一部分）。

当我单击一个按钮时，将创建 Mediapicker。然后我调用一个函数从照片库中拍照。此方法需要 2 个参数。Mediapicker 和一个回调函数。--> PictureFromGallery(mediaPicker, CallbackPhotoMade); 该回调函数会在用户选择图片库中的图片上传后触发。

在这个回调函数中，我想更改 UIImageView 的 UIImage。

```
void CallbackPhotoMade(MediaFile obj)
{
    imageviewPhoto1.Image = UIImage.FromFile("Images/image2.PNG");
    //To test I just use a file from a folder in my project
} 
```

当我对上述函数（CallbackPhotoMade）进行断点并将鼠标放在文本“.Image =”上时，会出现以下消息： **MonoTouch.UIKit.UIKitThreadAccessException：UIKit 一致性错误：您正在调用只能从以下位置调用的 UIKit 方法UI线程**

我认为这就是为什么 UIImageView 中的 UIImage 不会改变的问题。

有谁知道如何解决这个问题？

*****UPDATE2***** 我在另一个主题中读到，这可以通过将 CheckForIllegalCrossThreadCalls 设置为 false 来解决，例如：**

 **```
public override bool FinishedLaunching(UIApplication app, NSDictionary options)
{
    UIApplication.CheckForIllegalCrossThreadCalls = false;
} 
```

不幸的是，图像仍然没有改变。虽然，具体的错误消失了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T19:11:27.923

试试这个：

```
void CallbackPhotoMade(MediaFile obj)
{
    InvokeOnMainThread(() => { 
        imageviewPhoto1.Image = UIImage.FromFile("Images/image2.PNG"); 
    });
    //To test I just use a file from a folder in my project
} 
```

您所做的设置只是禁用检查，但不会阻止异常。

回调在另一个线程（异步）上完成。而且**您可以/应该只在主线程上/从主线程更新用户界面**。`InvokeOnMainThread()`使您的代码在主线程上执行，这正是您所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:38:26.850

理想情况下，代码应该运行。在 changeImage 方法中检查 imageviewPhoto1 是否为空。如果为 nill，那么您的对象可能已被释放。

如果不是 nill，那么尝试编写 [self.view setNeedsDisplay]; 设置图像后，只看重绘视图是否可以更新。或者通过将 imageviewPhoto1 的背景颜色设置为其他颜色来尝试是否存在视图。****

# android - Android 如何从 ListView 和 SimpleMenuAdapter 创建可点击菜单

> ID：14416796
> 
> 赞同：0
> 
> 时间：2013-01-19T17:18:16.747
> 
> 标签：android, android-listview, simplecursoradapter

我对 SimpleCursorAdapter 和 ListView 有疑问。当我想通过从数据库中查询来创建动态列表菜单时。问题是列表视图无法设置 onClickListener 在用户单击时执行某些操作。这些是我的代码。

**在文件“menu_header.xml”中**

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/menu_bar"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:paddingLeft="5dip"
        android:paddingRight="5dip"
        android:background="@drawable/menu_background">

        <Button
                android:id="@+id/bt_back"
                android:layout_width="70dip"
                android:layout_height="40dip"
                android:layout_centerVertical="true"
                android:text="@string/menu_back" />

        <ImageButton
                android:id="@+id/bt_search"
                android:layout_width="50dip"
                android:layout_height="50dip"
                android:background="@null"
                android:src="@android:drawable/ic_menu_search"
                android:layout_alignParentRight="true"
                android:paddingLeft="5dip"
                android:paddingRight="5dip" />

</RelativeLayout> 
```

**文件“menu_wrapper.xml”**

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"
              android:orientation="vertical">

    <include layout="@layout/menu_header" />

    <RelativeLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

            <ListView
                    android:id="@android:id/list"
                    android:layout_below="@id/menu_bar"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content" />

    </RelativeLayout>

</LinearLayout> 
```

**在文件“menu_choice.xml”中**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/menu_selector"
        android:clickable="true"
        android:padding="10dip">

        <LinearLayout
                android:id="@+id/thumbnail"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:padding="3dip"
                android:layout_alignParentLeft="true"
                android:background="@drawable/image_bg"
                android:layout_marginRight="10dip">

                <ImageView
                        android:id="@+id/list_image"
                        android:layout_width="60dip"
                        android:layout_height="60dip"
                        android:src="@drawable/building" />

        </LinearLayout>

        <TextView
                android:id="@+id/eng_name"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignTop="@+id/thumbnail"
                android:layout_toRightOf="@+id/thumbnail"
                android:text="Building"
                android:textColor="#040404"
                android:typeface="sans"
                android:paddingTop="5dip"
                android:textSize="20dip"
                android:textStyle="bold" />

        <TextView
                android:id="@+id/thai_name"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_below="@id/eng_name"
                android:textColor="#343434"
                android:textSize="15dip"
                android:layout_marginTop="3dip"
                android:layout_toRightOf="@+id/thumbnail"
                android:text="Test" />

        <ImageView android:layout_width="15dip"
                   android:layout_height="15dip"
                   android:src="@drawable/next_arrow"
                   android:layout_alignParentRight="true"
                   android:layout_centerVertical="true" />

</RelativeLayout> 
```

**最后一个是我用来创建菜单的文件**

```
public class Menu extends ListActivity {

    private ListView listView;
    private ImageButton imageButtonSearch;
    private Button buttonBack;

    private Constants constants = Constants.getInstance();
    private Database database = new Database(this);
    private Beans beans = Beans.getInstance();
    private Context context = this;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.menu_wrapper);

        buttonBack = (Button)findViewById(R.id.bt_back);
        imageButtonSearch = (ImageButton)findViewById(R.id.bt_search);

        buttonBack.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                finish();
            }
        });

        imageButtonSearch.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent i = new Intent();
                i.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_NEW_TASK);
                startActivityForResult(new Intent(context, Search.class), beans.REQUEST_CODE);
            }
        });

        listView = this.getListView();
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> adapterView, View view, int position, long id) {
                Log.d("Item Click","item click");
            }
        });

        database.open();
        Cursor cursorPlaceType = database.getPlaceType();
        startManagingCursor(cursorPlaceType);

        if(cursorPlaceType != null){

            String[] columns = new String[]{ constants.PLACE_TYPE_IMAGE, constants.PLACE_TYPE_ENAME, constants.PLACE_TYPE_TNAME };
            int[] to = new int[]{ R.id.list_image, R.id.eng_name, R.id.thai_name };

            SimpleCursorAdapter menuAdapter = new SimpleCursorAdapter(this, R.layout.menu_choice, cursorPlaceType, columns, to);
            menuAdapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                @Override
                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                    if(view.getId() == R.id.list_image){

                        try {

                            String imageFile = constants.IMAGE_ASSETS + cursor.getString(columnIndex) + ".png";
                            Bitmap bitmap = BitmapFactory.decodeStream(getAssets().open(imageFile));
                            ((ImageView)view).setImageBitmap(bitmap);

                        } catch (IOException e) { e.printStackTrace(); }
                        return true;
                    }//end if

                    return false;
                }//end setViewValue
            });
            this.setListAdapter(menuAdapter);

        }else{
            new AlertDialog.Builder(this)
                    .setMessage("Try again")
                    .setNeutralButton("OK", new DialogInterface.OnClickListener() {
                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
                            finish();
                        }
                    }).show();
        }

    }//end onCreate() 
```

**确实感谢您的帮助。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T08:00:49.093

使用`protected void onListItemClick(ListView l, View v, int position, long id)`此方法`ListActivity`代替您的`listView.setOnItemClickListener`方法。

# c++ - UBUNTU C++ 编译器找不到头文件

> ID：14416808
> 
> 赞同：3
> 
> 时间：2013-01-19T17:19:25.077
> 
> 标签：c++, ubuntu, ubuntu-12.04

我正在尝试用 3 个文件编译一个基本的 c++ 程序：*main.cpp*、*file.h*和*file.cpp*。

当我把 `c++ -pthread *.cpp` 它给我一个错误说;

```
fatal error: file.h: No such file or directory
compilation terminated. 
```

*main.cpp*和*file.cpp*都有`#include "file.h"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:43:54.967

```
g++ -I. *.cpp 
```

这告诉编译器在当前目录中查找头文件，而不仅仅是在默认目录（/usr/include 和 /include）中。

我建议你编译这个简单的例子来使用 GNU Make。标准规则对您有用。

```
make file.cpp main.cpp 
```

也许，如果你有同样的问题（file.h not found）你可以设置 CXXFLAGS=-I。

# parsing - 如何将 Scala 代码嵌入到特殊定义的语法中？

> ID：14416809
> 
> 赞同：0
> 
> 时间：2013-01-19T17:19:35.160
> 
> 标签：parsing, scala, functional-programming, parser-combinators

我不知道此信息是否与问题相关，但我正在学习 Scala 解析器组合器。使用一些示例（在本[硕士论文](http://labun.com/fh/ma.pdf "论文")中），我能够编写一种简单的函数式（在某种意义上它是非命令式的）编程语言。

有没有办法改进我的解析器/评估器，以便它可以允许/评估这样的输入：

```
<%
import scala.<some package / classes>
import weka.<some package / classes>
%>

some DSL code (lambda calculus)

<%
System.out.println("asdasd");
J48 j48 = new J48();
%> 
```

作为用访客语言 (DSL) 编写的输入？

我应该使用**反射**或类似的东西*来评估这样的输入吗？是否有一些源代码推荐可供研究（可能是 groovy 源？）？

也许这是类似的东西：[运行时编译](https://stackoverflow.com/questions/7477589/compile-and-execute-scala-code-at-runtime)，但我不确定这是最好的选择。

编辑

下面用“{”和“}”给出完整答案。也许“{{”会更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:45:37.197

问题在于此类导入语句的含义应该是什么。

也许您首先允许在您的语言中引用 java 方法（我猜是 Lambda 演算？）。

例如：

```
java.lang.System.out.println "foo" 
```

如果有，则可以添加不合格名称的解析，例如

```
println "foo" 
```

但是第一个问题来了：println存在于System.out和System.err中，或者更准确的说：它是PrintStream的一个方法，而System.err和System.out都是PrintStreams。

因此，您需要一些有关对象、类、类型等的概念才能正确执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:02:31.967

我管理了如何**运行嵌入在我解释的 DSL 中的 Scala 代码。**

*将 DSL 变量插入 Scala 代码并恢复返回值是一个好处。*:)

从解析和解释到执行嵌入式 Scala 代码运行时执行（**Main Parser AST 和 Interpreter**）的最少相关代码：

```
object Main extends App {
     val ast = Parser1 parse "some dsl code here"
     Interpreter eval ast
}

object Parser1 extends RegexParsers with ImplicitConversions {
  import AST._
  val separator = ";"
  def parse(input: String): Expr = parseAll(program, input).get
  type P[+T] = Parser[T]
  def program = rep1sep(expr, separator) <~ separator ^^ Sequence
  def expr: Parser[Expr] = (assign /*more calls here*/)
  def scalacode: P[Expr] = "{" ~> rep(scala_text) <~ "}" ^^ {case l => Scalacode(l.flatten)}
  def scala_text = text_no_braces ~ "$" ~ ident ~ text_no_braces ^^ {case a ~ b ~ c ~ d => List(a, b + c, d)}
  //more rules here
  def assign = ident ~ ("=" ~> atomic_expr) ^^ Assign
  //more rules here
  def atomic_expr = (
     ident ^^ Var
        //more calls here 
        | "(" ~> expr <~ ")"
        | scalacode
        | failure("expression expected")
     )
  def text_no_braces = """[a-zA-Z0-9\"\'\+\-\_!@#%\&\(\)\[\]\/\?\:;\.\>\<\,\|= \*\\\n]*""".r //| fail("Scala code expected")
  def ident = """[a-zA-Z]+[a-zA-Z0-9]*""".r
}

object AST {
   sealed abstract class Expr
   // more classes here
   case class Scalacode(items: List[String]) extends Expr
   case class Literal(v: Any) extends Expr
   case class Var(name: String) extends Expr
}

object Interpreter {
  import AST._
  val env = collection.immutable.Map[VarName, VarValue]()
  def run(code: String) = {
     val code2 = "val res_1 = (" + code + ")"
     interpret.interpret(code2)
     val res = interpret.valueOfTerm("res_1")
     if (res == None) Literal() else Literal(res.get)
  }

  class Context(private var env: Environment = initEnv) {
    def eval(e: Expr): Any = e match {
       case Scalacode(l: List[String]) => {
          val r = l map {
             x =>
                if (x.startsWith("$")) {
                   eval(Var(x.drop(1)))
                } else {
                   x
                }
          }
          eval(run(r.mkString))
       }
       case Assign(id, expr) => env += (id -> eval(expr))
       //more pattern matching here
       case Literal(v) => v
       case Var(id) => {
          env getOrElse(id, sys.error("Undefined " + id))
       }
     }
    }  
  } 
```

# asp.net-mvc - 锚标记重复控制器名称 asp.net MVC 4

> ID：14416812
> 
> 赞同：0
> 
> 时间：2013-01-19T17:20:04.723
> 
> 标签：asp.net-mvc, asp.net-mvc-4, url-redirection

我有以下**标记：**

```
<a href="controllerName/ActionMethodName?Pid=@Model.Collection[i].Pid">Know more</a> 
```

**我使用以下javascript**将用户重定向到此页面：

 **```
<input type="button" id="btnGoTo" value="ButtonCaption" onclick="window.location.href = '../Product/Index';" /> 
```

问题是当用户被重定向时，重定向发生在：

> 控制器名称/控制器名称/操作方法名称...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:49:30.447

您不应该为此使用任何 javascript。您将自动重定向到指定的 URL `href`。如果您正在使用`RAZOR View Engine`then ，您的电话应该是这样的：

```
@Html.ActionLink(
    "some text", 
    "MyAction", 
    "MyController", 
    new { myParams = "Hello" }, 
    null
) 
```

这将生成正确的锚标记：

```
 <a href="/MyController/MyAction?myParams=Hello">some text</a> 
```

您可以使用其中任何一个。在您的情况下，您可以通过`/`在控制器名称之前放置来跳过使用 Javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:23:10.737

您应该使用以下路线：

```
onclick="window.location.href = '@(Url.Action("Index","Product")'" 
```

不要在 MVC 中对 URL 进行硬编码，始终使用 URL 助手。**

# cakephp - 我的 cakephp 项目在 wampserver 中不起作用

> ID：14416813
> 
> 赞同：-1
> 
> 时间：2013-01-19T17:20:07.303
> 
> 标签：cakephp

我有在 xampp 上运行的 cakephp 项目。过了一会儿我安装了 wamppserver，它显示所有链接都是 404 not found....

wampp`.htaccess`文件中有什么要更改的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:53:54.480

## 模组重写

几乎可以肯定你缺少 mod rewrite。检查[文档](http://book.cakephp.org/2.0/en/installation/advanced-installation.html#apache-and-mod-rewrite-and-htaccess)以获取更多信息，但总结如下：

*   AllowOverride 需要在 apache.conf 文件的相关部分中为“All”
*   .htaccess 文件需要存在于您的 CakePHP 应用程序根目录、app 和 app/webroot 文件夹中。

如果 .htaccess 文件丢失，您可以从[github](https://github.com/cakephp/cakephp/blob/master/.htaccess) [repo](https://github.com/cakephp/cakephp/blob/master/app/.htaccess) [复制它们](https://github.com/cakephp/cakephp/blob/master/app/webroot/.htaccess)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T13:11:48.797

您可能没有在本地主机上启用**mod_rewrite 。**解决方案：

1.  在apache的**httpd.conf**
    文件中，将“AllowOverride None”行更改为“<strong>AllowOverride All”。
2.  此外，在 httpd.conf 文件中搜索带有单词“<strong>mod_rewrite”的行，并从行的开头删除井号 (#)。
3.  完成此操作并保存文件后，**重新启动您的 wampserver**，然后重试！

[资源](http://tricksbycinger.blogspot.com/2011/05/cakephp-url-not-found-404-error-message.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T18:49:35.763

也许你的 php 版本是 5.4？

搜索

```
'level' => E_ALL & ~E_DEPRECATED, 
```

在 app/core.php 并将其更改为

```
'level' => E_ALL & ~E_DEPRECATED & ~E_STRICT, 
```

# c# - 结合单例模式和存储库模式

> ID：14416814
> 
> 赞同：2
> 
> 时间：2013-01-19T17:20:16.300
> 
> 标签：c#, repository-pattern

[在本文](http://bizvise.com/2012/11/28/how-to-create-a-simple-data-access-layer-unit-of-work-pattern-with-entity-framework/)的帮助下，我在我的软件中实现了存储库模式。一个问题让我大吃一惊。`"var ourDatabase = new Database();"`我认为数据库类应该实现单例模式，因为用户不应该使用语句创建多个数据库上下文。我是对的还是这种情况对于使用实施来说不是一个关键问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T22:09:39.553

您不应该将数据库上下文作为实体框架的单例。对于初学者，每个上下文实例都会跟踪对其所做的所有更改，并且“保存更改”会保存所有更改。因此，如果您有一个 Web 应用程序并且您将上下文设置为单例，那么所有用户都将更新相同的上下文，并且当一个调用“保存更改”时，它会为每个人保存更改。在单用户 Windows 应用程序中，这不是什么问题，除非应用程序的不同部分并行工作。

另请注意，上下文会缓存已加载的数据并默认跟踪更改。简而言之，这可能意味着随着越来越多的对象被跟踪，内存膨胀和性能下降——尽管在实践中这种影响会有所不同。

从性能的角度来看，Entity Framework 在底层实现了连接池，因此不必担心创建和处理数据库上下文对象 - 它非常便宜。

# php - 在php中删除任何字符，但不删除符号和字母

> ID：14416815
> 
> 赞同：1
> 
> 时间：2013-01-19T17:20:19.183
> 
> 标签：php, html, replace

我如何使用 str_ireplace 或其他函数来删除任何字符，但不能删除 HTML 中常用的字母、数字或符号`: " ' ; : . - + =`等。我还想删除 /n、空格、制表符等。

我需要那个文本，来自做（“textContent”）。IE10和Chrome中的innerHTML，无论哪个浏览器执行它，php变量的大小都相同。因此，我需要在文本和字符中删除罕见或不同的相同编码。

我试试这个，但它对我不起作用：

```
 $textForMatch=iconv(mb_detect_encoding($text, mb_detect_order(), true), "UTF-8", $text);
        $textoForMatc = str_replace(array('\s', "\n", "\t", "\r"), '', $textoForMatch); 
```

$text 包含函数的结果（“textContent”）。innerHTML，我想删除字符为 Ã©³..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:26:54.267

最简单的选择是简单地将 preg_replace 与白名单一起使用。即使用列出您想要保留的内容的模式，并替换不在该列表中的任何内容：

```
$input = 'The quick brown 123 fox said "�Ã©³". Man was I surprised';
$stripped = preg_replace('/[^-\w:";:+=\.\']/', '', $input);
$output = 'Thequickbrownfoxsaid"".ManwasIsurprised'; 
```

## 正则表达式解释

```
/       - start regex
[^      - Begin inverted character class, match NON-matching characters
-       - litteral character
\w      - Match word characters. Equivalent to A-Za-z0-9_
:";:+=  - litteral characters
\.      - escaped period (because a dot has meaning in a regex)
\'      - escaped quote (because the string is in single quotes)
]       - end character class
/       - end of regex 
```

因此，这将删除任何不是单词、数字或正则表达式中列出的特定字符的内容。

# java - Java transferFrom 不会传输超过16mb？

> ID：14416818
> 
> 赞同：0
> 
> 时间：2013-01-19T17:21:09.283
> 
> 标签：java, file-io, java-io

我的 java 代码不会传输我的 25mb 文件 - 它会在 16mb 处停止。我试图改变一切`transferFrom` `1 << 24`，`48 & 31 & 8`只是让情况变得更糟。任何的想法？

```
ReadableByteChannel rbc = Channels.newChannel(fileURL.openStream());
FileOutputStream fos = new FileOutputStream(path + fileName);
fos.getChannel().transferFrom(rbc, 0, 1 << 24);
fos.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T22:51:36.927

如果您使用`Java7`，您可以使用花哨的`java.nio.file.Files`工具来复制。

```
 URL url = new URL("http://www.stackoverflow.com");
 try (InputStream is = url.openStream()) {
    Files.copy(is, Paths.get("/tmp/output.tmp"));
 } 
```

如果你没有，你可以使用开源工具——例如来自 Apache（`FileUtils`在 Commons IO 中搜索）。

如果你想坚持使用当前的解决方案，你可以这样写：

```
BufferedInputStream bis = new BufferedInputStream(url.openStream());
BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(
    "/tmp/output2.tmp"));

byte[] buffer = new byte[1024 * 1024];
int read = 0;
while ((read = bis.read(buffer)) != -1) {
  bos.write(buffer, 0, read);
}
bos.close();
bis.close(); 
```

目的是您必须阅读直到到达流的末尾。这就是为什么您`transferFrom`只下载有限数量的数据，因为不能保证所有数据都将在一个块中传输。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:44:49.423

transferFrom 不能保证在一次调用中完成，尤其是在使用 URL 时。您需要循环调用它。

# html - 全宽标题和图像 CSS

> ID：14416821
> 
> 赞同：0
> 
> 时间：2013-01-19T17:21:50.137
> 
> 标签：html, css

我试图了解如何获得全宽标题。问题是它在标题周围有一个薄的白色边框并且不是全宽的。如果这很重要，我不会使用任何网格系统。

HTML

```
<!DOCTYPE html>
   <html>

     <head>
  <link rel="stylesheet" href="css/style.css" type="text/css" display="screen" > 

 <title>
    test app
 </title>

</head>

<body>
<div id="header"/>
</div>

</body>

</html> 
```

CSS

```
#header {

    float:left;
    padding:15px 0;
    min-width:100%;
    background: #5FBEED;

} 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T00:09:45.143

```
html, body{
padding: 0;
margin 0; 
```

}

```
#header {
padding: 15px 0;
border: 10px solid #5FBEED;
background: #5FBEED; 
```

}

在这种情况下，您的边框将与您的标题背景颜色相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:26:40.710

我想问题在于它周围有白色边框。A`div`自动填充整个窗口的宽度，因此请删除该`min-width`样式：**[Example fiddle](http://jsfiddle.net/3nWfD/)**。

CSS：

```
#header {
    padding: 15px 0;
    border: 10px solid white;
    background: #5FBEED;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:30:24.547

将此添加到您的CSS

```
body{ margin: 0; padding: 0; } 
```

浏览器将自己的 css 添加到 html 元素中，这因浏览器而异。边距和填充也适用于 UL 和其他一些元素......

您可以在此处阅读有关此内容的更多信息... [http://clagnut.com/blog/1287/](http://clagnut.com/blog/1287/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T17:30:39.230

白色边框很可能是由`BODY`标签固有的`margin`. 尝试添加以下 CSS：

```
body {
    margin: 0;
} 
```

# tomcat7 - 在tomcat7中部署

> ID：14416823
> 
> 赞同：2
> 
> 时间：2013-01-19T17:22:01.950
> 
> 标签：tomcat7

这是我的 sample.xml 的内容（在 conf/Catalina/localhost/ 中）：

`<Context path="/sample" reloadable="true" docBase="D:\apache-tomcat-7.0.14\test"/>`

而我把sample.war文件放在这个目录D:\apache-tomcat-7.0.14\test下。但是tomcat没有部署war文件。

我在tomcat控制台中看到了以下消息

“信息：从 D:\apache-tomcat-7.0.14 \conf\Catalina\localhost 部署配置描述符 sample.xml”

unpackWars 是真的。

有什么建议吗？提前致谢。

# jquery - $.ajax 中的响应类型

> ID：14416830
> 
> 赞同：4
> 
> 时间：2013-01-19T17:22:40.783
> 
> 标签：jquery, xml, ajax, jqxhr

```
$.ajax({
   type: "POST",
   url: "bla",
   xhrFields: { responseType: "document" },
   data: {},
   success: function(arg,arg2,request){
      console.log(request.responseXML)
   }
}) 
```

为什么打印“未定义”？我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:26:48.967

您期待 JSON 返回吗？当您尝试时会发生什么：

```
$.ajax({
  type: "POST",
  url: "bla",
  dataType: 'xml',
}).done(function (response) {
   console.log(response);
}); 
```

如果您查看[jQuery 的文档](http://api.jquery.com/jQuery.ajax/)，它们会概述如何：

> 从 jQuery 1.5 开始，$.ajax() 返回的 jQuery XMLHttpRequest (jqXHR) 对象是浏览器原生 XMLHttpRequest 对象的超集。例如，它包含 responseText 和 responseXML 属性，以及 getResponseHeader() 方法。

因此，响应变量包含您需要的内容。要查看其结构，请执行 a`console.log()`并转到开发人员工具 (Chrome) 或 Firebug (Firefox) 中的“控制台”选项卡。

# c# - 获取具有相同名称值列的所有记录 - LINQ

> ID：14416833
> 
> 赞同：0
> 
> 时间：2013-01-19T17:22:49.580
> 
> 标签：c#, .net, winforms, linq

我有一个**WindowsForms**应用程序。在这种形式中，我需要向用户展示该表取决于他的数据输入。我有一个**Children**表和一个按钮.. 当用户单击该按钮时，我向他显示一个弹出窗口，让他输入孩子的名字.. 现在在我的表中我有一些具有相同孩子名字的记录.. 当用户输入例如“约翰”作为孩子的名字，我想向他展示所有同名的孩子记录..

我试过这段代码：

```
var query = db.ChildrenTbl.Where(c => c.ChildName.ToLower().Contains(childName)); 
```

这个代码：

```
 var query = from child in db.ChildrenTbl
                where child.ChildName.ToLower().Contains(childName)
                select child; 
```

但是两个主题都只给出一个记录，而不是所有具有相同孩子名字的记录..有什么问题？

# mysql - 在什么情况下外键不能为空？

> ID：14416845
> 
> 赞同：0
> 
> 时间：2013-01-19T17:23:59.487
> 
> 标签：mysql, sql, database, rdbms

> **可能重复：**
> [可空外键坏习惯？](https://stackoverflow.com/questions/1723808/nullable-foreign-key-bad-practice)

我知道外键用于关联或链接不同的表，但我的任务是要求主题的特定条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:26:32.017

当外键是子表中复合主键的一部分时，它不能为空。

```
表A
id (int) PK

表B
id (int) PK

表AB
aId（整数）
出价（整数）
(aId, bId) PK
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:27:04.703

FOREIGN KEY 约束可以包含空值；但是，如果复合 FOREIGN KEY 约束的任何列包含空值，则会跳过对构成 FOREIGN KEY 约束的所有值的验证。要确保验证复合 FOREIGN KEY 约束的所有值，请在所有参与列上指定 NOT NULL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:26:07.060

一些 ORM 需要 FK 可以为空，因为它们链接实体和管理依赖项的方式。

# macos - 忘记了我在 Mac OSX 上留下自动关机脚本的位置

> ID：14416847
> 
> 赞同：-1
> 
> 时间：2013-01-19T17:24:12.287
> 
> 标签：macos, applescript, parallels

我让运行 Windows XP 的 Parallels Desktop 在 mac 登录期间自动启动。并在启动时启动 Windows，让我爸爸只需按下电源按钮即可使用他的 WinXP，完全绕过 Mac 登录窗口和桌面。当他关闭 Windows 时，Parallels 也会关闭。

我似乎记得我有一个触发器可以在 Parallels 关闭后立即关闭 mac。但我不记得在哪里......我有一个 AppleScript 告诉 Finder 关闭。我明白那个。但现在的问题是 Mac 每次启动后都会立即关闭！我不知道是什么触发了关闭...而且我已经没有地方可以查看了。

这似乎是一个正常的关闭，而不是一个致命的错误。似乎有人在 Mac 启动后立即选择了“关闭”命令。因此，mac 大师们能否建议我应该看的地方——可能是什么触发了这个——我很确定它与 Parallels 相关。也许包内容中有一些东西链接到关闭脚本？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-19T18:24:00.870

您将 Applescript（关闭 Mac）添加到登录项

# javascript - HTML5 画布放置计数器

> ID：14416850
> 
> 赞同：2
> 
> 时间：2013-01-19T17:24:29.203
> 
> 标签：javascript, canvas, kineticjs

嗨，我有一个球落在 html5 画布中，我想要一个计数器来显示球落下的距离。

```
 var ball = new Kinetic.Shape(function(){
        var context = this.getContext();
        context.beginPath();
        context.arc(0, 0, radius, 0, 2 * Math.PI, false);
        context.fillStyle = "black";
        context.fill();
    }); 
```

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T19:59:59.523

你的形状在画布上有一个位置，你应该清楚地定义它以确保它。

但是，如果您想计算对象在屏幕上的移动方式，您可以这样做：

```
 ball.getPosition(); 
```

这将以以下形式返回一个点

```
 {x: number, y: number} 
```

您可以像这样保存单个 x,y 值：

```
 var xPosition = ball.getPosition().x;
   var yPosition = ball.getPosition().y; 
```

您可以在动画中保存这些位置并计算球移动了多少。

# multithreading - c 带有套接字多路复用的 tcp 服务器：使用选择时锁定读取器/写入器集？

> ID：14416851
> 
> 赞同：0
> 
> 时间：2013-01-19T17:24:48.723
> 
> 标签：multithreading, select, tcp

我的服务器使用非阻塞套接字多路复用。我想使用一个线程来接收传入的连接并处理输入，并使用另一个线程来通过套接字发送数据。它看起来像这样：

```
reader_worker(...)
{
    ...
    select(fd_max+1, &read_set, NULL, NULL, NULL);
    ...
}

writer_worker(...)
{
    ...
    select(fd_max+1, NULL, &write_set, NULL, NULL);
    ...
} 
```

由于我不想错过传入的连接，我可以想象在单独的线程中接收和发送会更好。我是否必须锁定可能在 read_set 和 write_set 中的套接字？这是正确的方法还是这种方法没有任何性能改进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T22:28:52.457

如果您在一个线程中执行此操作，您将不会错过任何传入连接。即使您有大量数据要发送或接收，send() 或 recv() 调用的延迟也取决于网络堆栈中本地缓冲区的大小，因此您将很快回来接受传入的连接。

不过有两件事，我不确定您的代码示例：

*   将用于接受连接的套接字放入与接受的连接相同的数组中，以便在单个 select() 调用中使用。除非您绑定到不同的网络接口，否则使用多个线程不会让您的程序运行得更快。
*   如果您正在处理传入的数据，这就是第二个线程变得有用的地方。通常，您拥有网络接口卡、CPU、硬盘等资源。每个资源有一个线程很有用，即一个处理网络 IO（接收请求，发送响应），另一个处理实际请求。如果您有多个内核，您还可以使用多个线程来处理请求，前提是这是一个 CPU 密集型任务。如果这些请求所做的只是从单个硬盘提供图片，那么使用多个线程处理请求不会给您带来任何额外的性能。

# c# - 多线程锁/监控

> ID：14416853
> 
> 赞同：1
> 
> 时间：2013-01-19T17:25:12.563
> 
> 标签：c#, .net, multithreading, locking, monitor

在 .NET 中，假设`thread A`锁定了一个对象。同时，`thread B`和`thread C`被阻止并等待对象被 解锁`thread A`。

现在，`thread A`解锁对象。接下来将选择哪个线程（B 或 C）？它是如何确定的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:37:04.730

简短的回答是它是不确定的——即你永远不知道。

中等答案是等待获取锁的线程被放入“就绪队列”，即 FIFO，但您不能依赖它。

[`Asynchronous Procedure Calls`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms681951%28v=vs.85%29.aspx)长答案是就绪队列中的线程可以“借用”来运行称为 APC（排队 - 但在最后。

所以，回到简短的回答：你永远不知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:29:23.830

它应该是第一个尝试获取锁的（如队列），[在此处查看更多信息](http://www.c-sharpcorner.com/UploadFile/1d42da/threading-with-monitor-in-C-Sharp/)

# readonly - 在 AvalonEdit 中使（并保持）行只读

> ID：14416854
> 
> 赞同：1
> 
> 时间：2013-01-19T17:25:23.407
> 
> 标签：readonly, avalonedit

在 AvalonEdit 控件中使某些行只读的可靠方法是什么？用户可以更改 C# 或 VB 模板文件中的某些方法主体，但不能更改其他内容。当用户添加或删除行时，每行的只读状态需要保持不变，即编辑内容下方的只读块需要相应地上下移动。

我在 winforms 上的 WPFHost 中使用 AvalonEdit。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-20T15:34:57.977

您可以设置`textEditor.TextArea.ReadOnlySectionProvider`为`IReadOnlySectionProvider`.

AvalonEdit 包含`TextSegmentReadOnlySectionProvider`允许将段标记为只读的实现。当用户添加/插入文本时，这些只读段将四处移动。 `TextSegmentReadOnlySectionProvider`不允许您在文档的开头和结尾阻止插入（因为这些位置永远不会在任何段内），但您可以从类继承并覆盖`CanInsert()`以修复这种特殊情况。

# javascript - 使用 jquery 从数组中更改目标元素的类

> ID：14416859
> 
> 赞同：1
> 
> 时间：2013-01-19T17:25:36.623
> 
> 标签：javascript, jquery, arrays, attr

我有一个`li`我使用的元素列表`.toArray()`。我现在需要遍历它们以找到所需的元素并更改其样式类。

我不确定我做错了什么，但我似乎无法获得索引项的类，但我可以检索`innerHTML`没问题。

```
var viewsIndex = $('#viewsList li').toArray()
        for(i=0; i < viewsIndex.length; i++) {
            if(viewsIndex[i].innerHTML == selectedTab) {

                console.log(viewsIndex[i].attr('style')); //This does NOT work
                console.log(viewsIndex[i].innerHTML); //This does work
            }
            else
            {

            }
        } 
```

一旦我以元素为目标，我就想使用`.removeClass`并`.addClass`更改样式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:28:33.843

这是没有 jQuery 函数的 DOM 对象：

```
viewsIndex[i] 
```

这是具有以下`attr`功能的 jQuery 对象：

```
$(viewsIndex[i]).attr('style') 
```

无论如何，您的代码可能会简单得多：

```
$('#viewsList li').filter(function(){
    return this.innerHTML == selectedTab;
}).removeClass('foo').addClass('bar'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T17:26:49.930

您正在尝试在`DOM`对象上调用 jQuery 函数，首先将其转换为`jQuery`对象。

改变

```
viewsIndex[i].attr('style') 
```

至

```
$(viewsIndex[i]).attr('style') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T17:34:33.217

你不能用`.each()`吗？

```
$('#viewLists li').each(function(i){
    if($(this).html == selectedTab){
       $(this).removeClass('foo').addClass('bar');
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T17:32:41.900

使用 jQuery 循环遍历元素`each`，然后以`$(this)`. 这样您就可以访问每个项目的 jQuery 方法。

```
$('#viewsList li').each(function(){

    var element = $(this);

    if(element.html() == selectedTab){
        console.log(element.attr('style')
    } else {

    }
} 
```

# ruby-on-rails - Rails 3 + 设计 - 在特定子域登录

> ID：14416863
> 
> 赞同：1
> 
> 时间：2013-01-19T17:26:12.377
> 
> 标签：ruby-on-rails, ruby, devise, ruby-on-rails-3.2, subdomain

我有带有 Devise gem 和 i18n 的 Rails 3.2 应用程序。但我想改进一点我的应用程序并允许用户登录这样的子域：`login.my-address.com`. 但我不知道该怎么做。我知道我应该以某种方式指出`devise/sessions#new`并且我尝试了一些对我没有帮助的事情。有没有人创造过这样的解决方案？

我的路线：

```
 scope ":locale", locale: /#{I18n.available_locales.join("|")}/ do    
    resources :articles
    resources :photos
    ...

    root :to => 'articles#index'
  end

  match '*path', to: redirect("/#{I18n.default_locale}/%{path}"), constraints: lambda { |req| !req.path.starts_with? "/#{I18n.default_locale}/" } # i18n.
  match '', to: redirect("/#{I18n.default_locale}/articles")                              # Redirect by default to articles. 
```

# unit-testing - Windows 8 商店应用程序单元测试在 VS 2012 中失败

> ID：14416866
> 
> 赞同：1
> 
> 时间：2013-01-19T17:26:30.627
> 
> 标签：unit-testing, windows-8

我正在开发一个 Windows 8 商店应用程序。我通过选择**Solution** >> **Add** >> **new project** >> **Unit Test Library (Windows Store apps)**添加了单元测试。然后我就可以正常运行测试了。

但是，然后我添加了对原始 Windows 8 商店应用程序项目的引用（[按照此处的说明](http://msdn.microsoft.com/en-us/library/vstudio/jj159318.aspx)），当我尝试再次运行测试时，出现以下错误：

```
------ Discover test started ------
WriteTestCaseStarted
WriteTestCase Took Time = 3.0004
========== Discover test finished: 1 found (0:00:00.1350024) ==========
------ Run test started ------
Updating the layout...

Copying files: Total <1 mb to layout...

Registering the application to run from layout...

Deployment complete. Full package name: "c078c431-2a0d-4494-8dd9-47ae01ac938d_1.0.0.0_neutral__chny7cy2kxrnj"

Exception has been thrown by the target of an invocation.
========== Run test finished: 0 run (0:00:01.8770198) ========== 
```

我究竟做错了什么？

**更新：从****App.xaml**中注释掉以下行解决了这个问题：

```
<ResourceDictionary Source="Common/StandardStyles.xaml"/> 
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:48:28.480

多种因素可能导致这种情况。这是我发现的一对：

*   app.xaml 中的应用程序标记设置任何属性（如 RequestedTheme）
*   App.xaml 引用使用自定义附加属性的 ResourceDictionary。

尝试注释掉 App.xaml 的内容，看看是否有帮助。

# php - 使用 MySQL DELETE 子句

> ID：14416868
> 
> 赞同：0
> 
> 时间：2013-01-19T17:26:37.367
> 
> 标签：php, mysql, sql

我有一个删除子句，它从我的数据库中删除“已查看”列日期时间值超过 24 小时的行。我的代码运行良好，除了查看列的默认值为 0000-00-00 00:00:00。在这种情况下，具有默认值的每一行数据也会被删除。如何更改我的查询以防止这种情况发生？

我的代码：

```
$delete_expired_notifications_query= "DELETE FROM notifications WHERE user_id= '".$u_id."' 
AND viewed < NOW() - INTERVAL 24 HOUR"; 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T17:27:46.137

只需添加另一个条件，使用`=!`

```
DELETE 
FROM notifications 
WHERE user_id= '".$u_id."' 
      AND viewed < NOW() - INTERVAL 24 HOUR
      AND viewed != '0000-00-00 00:00:00' 
```

作为旁注，`SQL Injection`如果值（*s*）来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用 PreparedStatements，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:27:44.590

明确排除：

```
$delete_expired_notifications_query= "DELETE FROM notifications WHERE user_id= '".$u_id."' 
AND viewed < NOW() - INTERVAL 24 HOUR" AND viewed != '0000-00-00 00:00:00'; 
```

# ruby-on-rails - 如何在 HABTM Rails Association 中创建记录 如何做到这一点？

> ID：14416872
> 
> 赞同：4
> 
> 时间：2013-01-19T17:26:47.543
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

我在我的`has_and_belongs_to_many`模型中创建新关系时遇到了一些麻烦。我这样定义模型：

```
journals model

  has_and_belongs_to_many :posts

post model

  has_and_belongs_to_many :journal 
```

我不知道如何创建关联，我做了一个按钮，但我不知道它是如何工作的。我创建了动作`add_post`

```
 def add_post
    @journal_post = JournalsPosts.new
  end 
```

我创建此链接以创建关联，但我不知道我现在必须做什么：

```
<%= link_to "Add to Journal",:controller => "journals",:action => "add_post" %> 
```

重定向工作正常，但我不知道现在如何进行？你知道一些关于HABTM协会的指南吗？我已经尝试过[这个](http://guides.rubyonrails.org/association_basics.html#choosing-between-has_many-through-and-has_and_belongs_to_many)，但它没有帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-08-26T06:00:40.660

在我自己研究之后，你应该能够做到

```
def add_post
    j = Journal.first # or find_by, etc
    p = Post.first # or find_by, etc
    j.posts << p # creates a record in journals_posts table
    j.save!
end 
```

(1) 接受的答案听起来好像只能直接进行关联。此外，如果您使用 habtm 关联，则不会有“JournalsPosts”类，因为它特别避免使用中间表的模型。

(2) 注意这个关联不是唯一的。如果您多次调用它，您将在 journals_posts 表中获得多个具有相同两个整数对的条目。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-19T17:59:04.197

您应该高度考虑使用`has_many, :through`，因为这是现在在 Rails 中处理此类关系的首选方式。

也就是说，如果您想继续`has_and_belongs_to_many`，您需要以某种方式获取要关联的期刊和帖子 ID，以便正确创建关联。

在您的路线中：

```
resources :journals do
  member do
    put :add_post
  end
end 
```

`@journal`在您看来（确保您在`@post`某处设置）：

`<%= link_to "Add to Journal", add_post_journal_path(@journal, :post_id => @post.id), :method => :put %>`

在您的控制器中：

```
def add_post
  @journals_posts = JournalsPosts.new(:journal_id => params[:id], :post_id => params[:post_id])

  if @journals_posts.save
    ...
  else
    ...
  end
end 
```

# joomla - joomla 2.5 中的数据库查询

> ID：14416877
> 
> 赞同：0
> 
> 时间：2013-01-19T17:26:56.753
> 
> 标签：joomla, joomla2.5, virtuemart

我编写了以下代码以从数据库中获取名称为“app”的美德玛特类别 ID。但它没有显示任何东西。请帮助。我使用 joomla 2.5 和最新版本的 meadowmart

```
$db =&  JFactory::getDBO();
$query = $db->getQuery(true);
$query->select('virtuemart_category_id');
$query->from('#__virtuemart_categories_en_gb'); 
$query->where('category_name = "app" ');   //put your condition here    
$db->setQuery($query);
$o= $db->loadObjectList();
echo $o[0]->virtuemart_category_id; 
```

我的数据库表前缀是 nyhar_ 。我在类别视图页面中编写了上面的代码，它没有显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:29:47.967

试试这个：

```
$db = JFactory::getDBO();
$query = $db->getQuery(true);
$query->select('*');
$query->from('#__virtuemart_categories_en_gb'); 
$query->where('category_name = "app" ');   
$db->setQuery($query);
$o= $db->loadResult();
echo $o; 
```

要选择一个**id**值，您可以使用`$query->select('virtuemart_category_id');`

# c# - 多个表格不显示

> ID：14416878
> 
> 赞同：2
> 
> 时间：2013-01-19T17:26:59.697
> 
> 标签：c#, winforms

我正在尝试制作一个`multiWindowsForm`.

为了尝试它是如何工作的，我从一个添加了按钮的简单表单开始。单击它时，应该会弹出另一个窗口。但我无法让它工作。它因错误而崩溃：

```
Object reference not set to an instance of an object! 
```

我用`Project`→ `Add`→`Windows form`并命名它`Mupp.cs`

这是我的代码`Form1.cs`：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace MultiForm
{
    public partial class tryout : Form
    {
        public tryout()
        {
            InitializeComponent();
        }

        Mupp theMupp;

        private void Form1_Load(object sender, EventArgs e)
        {
            theMupp = new Mupp();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            theMupp.Show();
        }
    }
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:31:28.730

看起来加载事件没有触发，因此没有初始化您的对象。确保加载事件已连接。

或者，在单击事件中进行初始化。

```
 private void button1_Click(object sender, EventArgs e)
 {
     using (Mupp theMupp = new Mupp())
     {
         theMupp.ShowDialog();
     }
 } 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:33:52.987

```
public tryout()
{
      InitializeComponent();
      this.Load += new EventHandler(Form1_Load);
} 
```

# pycharm - 如何在 PyCharm 中更改作者变量

> ID：14416887
> 
> 赞同：35
> 
> 时间：2013-01-19T17:27:59.700
> 
> 标签：pycharm

这个问题与 PyCharm 有关。

如何更改变量中的值

```
__author__ = 'my login name' 
```

它需要我的 shell 用户变量。我可以在任何地方根据自己的喜好更改它吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-19T18:06:38.913

打开设置 | 文件模板并更改“文件标题”模板的文本以使用您的全名而不是 ${USER}。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-03-09T12:04:16.247

我刚遇到和你一样的问题，在这里找到了最好的答案：

[http://www.jetbrains.com/pycharm/webhelp/creating-and-editing-file-templates.html#d600783e347](http://www.jetbrains.com/pycharm/webhelp/creating-and-editing-file-templates.html#d600783e347)

您不能只更改现有变量，还可以创建自己的变量。我鼓励您使用此解决方案，而不是用您的全名替换变量。迟早您会遇到这样的情况，即您需要在多个文件模板中使用它，并且在那一刻，在每个模板中重新更改您的名称将成为一个有趣的杀手。

TL;DR 转到`Settings | File Templates`选项`Includes`卡，创建一个新文件并键入例如`#set( $MyName = "John Smith" )`. 然后转到`Templates`选项卡中的模板并添加到顶部的模板`#parse ("your-include-name.your-extension")`现在您可以`$MyName`在此模板中使用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-08-30T02:55:01.673

假设这是在 Windows 环境中并且 Pycharm 安装在路径下：

`X:\Program Files (x86)\JetBrains\PyCharm x.x.x\`

编辑

`X:\Program Files (x86)\JetBrains\PyCharm x.x.x\bin\pycharm.exe.vmoptions`

添加行：

```
-Duser.name=MyName<myemail@mycompany.com> 
```

重启 PyCharm

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-06-09T21:21:39.097

设置（或默认设置）>>编辑器>>文件和代码模板>>文件类型（例如：Python脚本）

![在此处输入图像描述](../Images/dd7170e30c9f45c5a257a6929e598011.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-10T12:20:24.743

在 Mac 上的 PyCharm 4.0 中 - PyCharm | 偏好 | | 编辑 | 文件和代码模板

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-29T08:28:51.010

[我从JetBrains 的帮助网站上](https://www.jetbrains.com/help/pycharm/file-template-variables.html?keymap=primary_default_for_windows)找到了一个可能的解决方案。

> 除了预定义的模板变量外，还可以指定自定义变量。`#set`如有必要，您可以使用指令在模板中定义自定义变量的值。
> 
> 例如，如果您想使用您的全名而不是通过预定义变量定义的登录名`${USER}`，请使用以下构造：
> 
> ```
> #set( $MyName = "John Smith" ) 
> ```
> 
> 如果模板中没有定义变量的值，PyCharm 会在应用模板时要求您指定它。

**这是我的演示：** `(PyCharm Community Edition 2019.3.1 x64)`

1.  去`Settings -> Editor -> File and Code Templates -> Includes`

    *   按`+`以创建新模板。
    *   对我来说，我将其命名`Name:`为 'Header'、`Extension:`'py'
    *   我将我的名字设置为`$USER`并将其放在我要显示的文本之前。[`<screenshot>`](https://i.stack.imgur.com/hCQjc.png)

        ```
        #set($USER = "Roy WAN")
        # Created by $USER at ${TIME} ${DATE} using ${PRODUCT_NAME} 
        ```

2.  去`Settings -> Editor -> File and Code Templates -> Files`

    *   现在我们可以将以下代码复制到我们需要的文件模板中。 [`<screenshot>`](https://i.stack.imgur.com/xsRIT.png) [`<screenshot>`](https://i.stack.imgur.com/gaaDm.png)

        ```
        #parse ("Header.py") 
        ```

        输出是这样的。[`<screenshot>`](https://i.stack.imgur.com/dS0YH.png)

        ```
        # Created by Roy WAN at 16:36 29/12/2019 using PyCharm 
        ```

Ps 注意不要放在正文后面。[`<screenshot>`](https://i.stack.imgur.com/7EiuG.png)

```
 # Created by $USER at ${TIME} ${DATE} using ${PRODUCT_NAME}
    #set($USER = "Roy WAN") 
```

否则，它仍然会打印出 default `${USER}`。[`<screenshot>`](https://i.stack.imgur.com/CQIpt.png)

```
 # Created by 11848 at 16:46 29/12/2019 using PyCharm 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-11T09:27:44.243

转到设置 -> 编辑器 -> 文件和代码模板 在其中选择要更改名称的语言 写下你的名字而不是 ${USER}

# python - 我在 python 中的代码不起作用

> ID：14416889
> 
> 赞同：0
> 
> 时间：2013-01-19T17:28:21.517
> 
> 标签：python

> **可能重复：**
> [或python中的行为：](https://stackoverflow.com/questions/10460963/or-behaviour-in-python)

我是编程的初学者，并选择 python 作为我的第一语言..

```
print "start the conversation"
conversation = raw_input()

if conversation == "Hi" or "hi" or "Hello" or "hello":
    print "Hey there!"

elif conversation == "How are you?" or "how are you?":
    print "I'm good and you?"
else:
    print "No one starts a conversation like this." 
```

但是当我运行程序时它运行良好我输入“嗨”它回复“嘿那里！” 但每当我输入以下内容作为输入“你好吗？” 它仍然打印出“嘿！” 我想让它打印出“我很好，你呢？” 而不是“嘿！” 再次。请让它容易，因为我是一个初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:30:24.600

这

```
if conversation == "Hi" or "hi" or "Hello" or "hello": 
```

应该读

```
if conversation in ("Hi", "hi", "Hello", "hello"): 
```

对于`elif`.

您现在拥有的代码在语法上是有效的，但并没有按照您的想法执行（它基本上总是评估为`True`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:32:37.010

您的第一个条件始终为 True。你应该使用：

```
if conversation == "Hi" or conversation == "hi" or conversation == "Hello" or conversation == "hello": 
```

或者

```
if conversation in ("Hi", "hi", "Hello", "hello"): 
```

# angularjs - 有人可以为 AngularJS 中的范围提供 $destroy 事件的示例吗？

> ID：14416894
> 
> 赞同：68
> 
> 时间：2013-01-19T17:29:18.633
> 
> 标签：angularjs

有人可以提供范围的 $destroy 事件的示例吗？[这是来自http://docs.angularjs.org/api/ng.$ro​​otScope.Scope#$destroy](http://docs.angularjs.org/api/ng.$rootScope.Scope#$destroy)的参考文档

> **$销毁()**
> 
> 从父作用域中移除当前作用域（及其所有子作用域）。移除意味着对 $digest() 的调用将不再传播到当前作用域及其子作用域。删除还意味着当前范围有资格进行垃圾收集。
> 
> $destroy() 通常由诸如 ngRepeat 之类的指令用于管理循环的展开。
> 
> 就在作用域被销毁之前，会在该作用域上广播 $destroy 事件。应用程序代码可以注册一个 $destroy 事件处理程序，这将使它有机会执行任何必要的清理。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-01-19T17:30:42.970

演示：http: [//jsfiddle.net/sunnycpp/u4vjR/2/](http://jsfiddle.net/sunnycpp/u4vjR/2/)

在这里，我创建了**句柄销毁**指令。

```
ctrl.directive('handleDestroy', function() {
    return function(scope, tElement, attributes) {        
        scope.$on('$destroy', function() {
            alert("In destroy of:" + scope.todo.text);
        });
    };
}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-09-30T18:04:14.543

`$destroy`可以参考两件事：方法和事件

# 1\. 方法 - $scope.$destroy

```
.directive("colorTag", function(){
  return {
    restrict: "A",
    scope: {
      value: "=colorTag"
    },
    link: function (scope, element, attrs) {
      var colors = new App.Colors();
      element.css("background-color", stringToColor(scope.value));
      element.css("color", contrastColor(scope.value));

      // Destroy scope, because it's no longer needed.
      scope.$destroy();
    }
  };
}) 
```

# 2\. 事件 - $scope.$on("$destroy")

请参阅[@SunnyShah 的回答](https://stackoverflow.com/a/14416913/111438)。

# java - 创建定时器计数器

> ID：14416899
> 
> 赞同：-5
> 
> 时间：2013-01-19T17:29:40.240
> 
> 标签：java

我想创建一个时间计数器（计算秒/毫秒或任何时间），它将返回我想要计算的时间量。我不想使用这个计数器执行任何类型的任务，我只想知道计算的时间量。

有可能吗？怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:35:44.073

```
long t0 = System.nanoTime();
// do something
long t1 = System.nanoTime();
long elapsedNanoseconds = t1 - t0; 
```

Guava 有一个[Stopwatch 类](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Stopwatch.html)来封装它。

编辑：

如果您需要的是调度程序，请使用[ScheduledExecutorService](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ScheduledExecutorService.html)。

# tuples - 通过索引变量访问 SML 元组

> ID：14416900
> 
> 赞同：10
> 
> 时间：2013-01-19T17:29:43.870
> 
> 标签：tuples, sml

问题很简单。

如何在 SML 中使用 Index 变量访问元组？

```
val index = 5;
val tuple1 = (1,2,3,4,5,6,7,8,9,10);

val correctValue = #index tuple1 ?? 
```

我希望有人能帮忙。提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T17:50:48.863

不存在接受整数值和元组并从元组中提取该元素的函数。当然还有`#1`, `#2`, ... 函数，但这些函数不接受整数参数。也就是说，“函数”的名称是`#5`，它不是`#`应用于 value的函数`5`。因此，您不能用名称`index`代替`5`.

如果您事先不知道您想要的元素将位于元组中的哪个位置，那么您可能正在以不打算使用它们的方式使用它们。

您可能需要一个`'a list`类型更自然的值列表。然后，您可以使用 访问第`n`th 元素`List.nth`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-19T18:07:50.147

为了澄清一点，为什么您不能这样做，您需要更多地了解 SML 中的元组是什么。

元组实际上表示为 SML 中的记录。请记住，记录具有`{id = expr, id = expr, ..., id = expr}`每个标识符都是标签的形式。

元组和记录的区别在于您对元组中的元素进行索引的方式：#1, #2, ...`(1, "foo", 42.0)`是 (equivalent with) 的派生形式`{1 = 1, 2 = "foo", 3 = 42.0}`。从 SML/NJ 给出的记录类型可以更好地看出这一点

```
- {1 = 1, 2 = "foo", 3 = 42.0};
val it = (1,"foo",42.0) : int * string * real 
```

请注意，该类型未显示为记录类型，例如`{1: int, 2: string, 3: real}`. 元组类型又是记录类型的派生形式。

实际上`#id`不是函数，因此不能用变量作为“参数”来调用它。它实际上是一种派生形式（注意通配符模式行，在记录模式匹配中）

```
fn {id=var, ...} => var 
```

所以总而言之，您将无法做您不想做的事情，因为这些派生形式（或语法糖，如果您愿意的话）在任何方面都不是动态的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-27T15:31:45.157

一种方法是 Sebastian Paaske 所说的使用列表。缺点是您需要 O(n) 计算才能访问列表的第 n 个元素。如果您需要在 O(1) 时间内访问一个元素，您可以使用基本 sml 库中的数组。您可以在以下位置找到有关数组的矿石： [http ://sml-family.org/Basis/array.html](http://sml-family.org/Basis/array.html)

# ruby-on-rails - 创建动作中的几个模型

> ID：14416904
> 
> 赞同：0
> 
> 时间：2013-01-19T17:30:07.200
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有三个模型：

*   `User (first_name, last_name, mail)`
*   `Article (name, info)`
*   `Article_Author (user_id and article_id)`

在`Article_controller`中，`create`动作如下所示：

```
def create
    @article = article.new(params[:article])

    @article_author = @article.article_authors.build(params[:article_authors])
    @article_authors.user_id = current_user.id

    respond_to do |format|
      if @article.save
        format.html { redirect_to @article, :flash=>{:notice=>'Article was successfully created.'} }
      else
        format.html { render action: "new" }
      end
    end
end 
```

看起来没问题，因为在`Article_Author`表中我可以看到它`user_id`等于当前用户 ID，而`article_id`是当前文章 ID。在视图中，当我编写 时`<%= @article.article_authors %>`，它给了我整个用户数组：`[#<ArticleAuthors id: 1, user_id: 2, article_id: 10, created_at: "2013-01-15 18:46:39", updated_at: "2013-01-15 18:46:39">]`.

我怎样才能得到名字和姓氏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:57:37.710

然后在您的模型中创建一个仅获取文章作者的名字和姓氏的方法：

```
# somewhere in models/article.rb
def article_authors_names
  article_authors.select('first_name, last_name')
end 
```

您可以重命名为`authors_names`并简单地调用`@article.authors_names`.

# ios - 修复了所有 viewController 中的 UIImageView？

> ID：14416906
> 
> 赞同：0
> 
> 时间：2013-01-19T17:30:21.987
> 
> 标签：ios, objective-c, cocoa-touch, cocoa

我想在我的所有视图控制器上都有一个固定的图像。当视图发生变化时，图像将保持静止并位于所有内容之上（类似于`UINavigationBar`）。我想避免使用`UINavigationBar`，因为它的局限性。那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:04:18.807

我认为您必须使用自定义容器控制器或容器视图来执行此操作。最简单的方法是在故事板中使用容器视图。从单个视图控制器开始，拖入 2 个容器视图，然后根据需要调整它们的大小（顶部的视图位于视图顶部，并根据需要调整图像的大小）。您将获得两个连接到这些容器视图的视图控制器——如果您要进行导航，您可能应该删除底部的一个，拖入一个导航控制器，然后从容器中按住 control-drag 将其连接起来（如果您打算像导航栏一样使用顶部控制器，则可以隐藏导航栏）。您在该底部控制器中执行的任何导航都将被限制在该底部视图中，并且您的顶部图像栏将保持在原位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:41:35.123

是的，您可能需要将视图放在视图控制器视图上方的窗口中，如下所示：

```
[self.window insertSubview:self.logoButton
              aboveSubview:self.navigationController.navigationBar]; 
```

这段代码在导航栏上放置了一个 UIButton，当导航栏动画时，按钮没有。

我已将该代码放入：

```
- (BOOL)application:(UIApplication *)application 
didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

这不完全是您想要的，但您应该能够根据需要对其进行修改。

# bash - Bash Shell 当前日期减去天数

> ID：14416914
> 
> 赞同：11
> 
> 时间：2013-01-19T17:30:43.177
> 
> 标签：bash, shell, datetime, debian

我是 bash 和 shell 的新手，但我正在运行 debian 安装，并且我正在尝试制作一个脚本，该脚本可以找到过去的日期，而无需安装任何其他软件包。从教程我已经到了这个阶段：

```
#!/bin/sh
#
# BACKUP DB TO S3
#

# VARIABLES
TYPE="DATABASE"
DAYS="30"

# GET CURRENT DATETIME
CURRENTDATE="$(date +%Y%m%d%H%M%S)"

# GENERATE PAST DATE FROM DAYS CONTSTANT
OLDERDATE=`expr $CURRENTDATE - $DAYS'

# CALL PYTHON SCRIPT WITH OLDERDATE ARGUMENT
python script.py $OLDERDATE 
```

我遇到困难的地方是我的“天数”只是数字 30 并且没有格式化日期时间，所以当我从 currentdate 变量中减去它时，它显然不兼容。

有人会善意地帮助我找到一种方法来让它正常工作吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-19T17:33:48.007

尝试

```
date -d '30 days ago' 
```

应该在debian上做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-19T17:33:52.050

尝试这样做：

```
#!/bin/sh
#
# BACKUP DB TO S3
#

# VARIABLES
TYPE="DATABASE"
DAYS="30"

# GET CURRENT DATETIME
CURRENTDATE="$(date +%Y%m%d%H%M%S)"

# GENERATE PAST DATE FROM DAYS CONSTANT
OLDERDATE="$(date "+%Y%m%d%H%M%S" -d "$DAYS days ago")"

# CALL PYTHON SCRIPT WITH OLDERDATE ARGUMENT
python script.py "$OLDERDATE" 
```

看`info coreutils 'date invocation' | less +/28.7\ Relative\ items\ in\ date\ strings`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-12T06:39:06.570

您可以使用以下脚本：

```
#!/bin/bash
days=73
while [ ${days} -ge 0 ]; do
    date -d "${days} days ago" +'%F'
    days=$((days-1))
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T17:38:04.237

您可以改为修改 python 脚本 - 这样您就不会依赖于特定的实现`date`

# android - Android：知道 android 何时停止在 ListView 上执行 getView()

> ID：14416918
> 
> 赞同：0
> 
> 时间：2013-01-19T17:31:33.057
> 
> 标签：android, listview

我知道 Android 执行 2 次（有时甚至更多）`getView()`适配器的方法才能正确绘制 ListView。我想知道（或得到通知）它何时停止执行该方法。

为什么？当用户在其中一个上滑动时，我的列表行会被动画化。如果用户在 Android 完成 execute 之前滑动`getView()`，则动画将在第一行而不是用户触摸的行上执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:41:57.887

您可以在后台 AsyncTask 加载**ListView**。在此期间，您可以`progress dialog`在屏幕上显示，因此用户无法在您的屏幕上执行任何操作。

检查此**参考**：

[在后台 AsyncTask 中加载 ListView](http://android-er.blogspot.in/2010/07/load-listview-in-background-asynctask.html)

希望这对您有所帮助。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:42:19.380

没有最后一个 getView()

当您在列表中滚动时，对于将变为可见的每个项目，都会调用 getView()。即使它已经出现在屏幕上。我相信您没有正确检测到列表视图项目单击。

# rest - 如何在 ETrade 交易历史中指定 startDate 和 endDate

> ID：14416919
> 
> 赞同：0
> 
> 时间：2013-01-19T17:31:32.737
> 
> 标签：rest

[https://content.etrade.com/etrade/estation/pdf/API_Technical_Documentation.pdf](https://content.etrade.com/etrade/estation/pdf/API_Technical_Documentation.pdf)上的 Etrade API 文档包含以下用于获取账户存款历史记录的片段：

account/rest/xxxxxxxx/transactions/DEPOSITS?startDate=01012012&endDate=12312012&count=25

但即使指定了开始日期和结束日期，结果实际上也只是过去 30 天的结果。

有人用这个 API 成功了吗？startDate 和 endDate 应该如何指定？

# ruby-on-rails - 如何一次发布所有数据数组？

> ID：14416926
> 
> 赞同：0
> 
> 时间：2013-01-19T17:32:49.257
> 
> 标签：ruby-on-rails, ruby

我有一个 Rails 3 应用程序，它试图一次发布一组用户。我正在尝试通过 Postman REST 客户端发帖。如果我尝试一次发布一个用户，效果很好，但一次发布多个用户是不可能的。

这是我的用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :name,age,email,mobile,gender
end 
```

我的用户控制器：

```
respond_to :html , :json

def create
  @user = User.new(params[:user])
  if @user.save
    render :json => { :status => :ok, :message => "User Created Successfully"}.to_json
  end
end 
```

用户以 JSON 格式为多个用户发布数据：

```
{
  user:[
    {
      "name":"abc",
      "age": 23,
      "email": "abc@gmail.com",
      "mobile": 9876543210,
      "gender":"M"
    },
    {
      "name":"def",
      "age": 26,
      "email": "def@gmail.com",
      "mobile": 9876543210,
      "gender":"F"
    }
  ]
} 
```

在 Rails 中可以做到这一点吗？

我试过了：

```
def create
  @userlist = User.new(params[:user])
  @userlist.each do |u|
    u.save
  end
  render :json => { :status => :ok, :message => "User Created Successfully"}.to_json
end 
```

但数据没有保存。

有什么解决办法吗？

在用户下保存的嵌套属性：

```
{
    "users" :[
    {
        "name":"abc",
            "age": 23,
            "email": "abc@gmail.com",
            "mobile": 9876543210,
            "gender":"M",
            "projects":
                [
                {
                    "projectname":"abc",
                    "type":"abc"
                },
                {
                    "projectname":"def",
                    "type":"abc"
                },
                {
                    "projectname":"ghi",
                    "type":"abc"
                }
        ]
    },
    {
        "name":"def",
        "age": 26,
        "email": "def@gmail.com",
        "mobile": 9876543210,
        "gender":"F",
        "projects":
            [
            {
                "projectname":"abc",
                "type":"abc"
            },
            {
                "projectname":"def",
                "type":"abc"
            },
            {
                "projectname":"ghi",
                "type":"abc"
            }
        ]
    }
    ]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T18:09:04.537

[如此处](https://stackoverflow.com/questions/8505263/how-to-implement-bulk-insert-in-rails-3)所示，我建议您使用[此 gem](https://github.com/zdennis/activerecord-import)批量插入（取决于一次可能通过的用户数量）：

```
def create
    users = []
    @userlist = params[:users]

    @userlist.each do |u|
       user = User.new(u)
       users << user
    end

    User.import(users)

    render :json => { :status => :ok, :message => "User(s) Created Successfully"}
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:44:01.467

好的，我看到您对已发布参数的编辑。所以在你的控制器中这样做：

```
def create
    @userlist = params[:users]
    @userlist.each do |u|
       user = User.new(u)
       user.save!
    end
    render :json => { :status => :ok, :message => "User Created Successfully"}.to_json
end 
```

# debian - 验证码不会随 GWAN 的新版本而改变

> ID：14416927
> 
> 赞同：0
> 
> 时间：2013-01-19T17:32:58.623
> 
> 标签：debian, g-wan

为什么这个页面`captcha.c`没有随着新版本的变化`gwan`？（图片没有变化）

此示例在旧版本中运行良好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T10:44:18.530

这是正确的。

但是该`httpdate.c`示例按预期工作（每次调用它时都会更改），因此这不是缓存问题。

我已经给 G-WAN 的团队打了个电话，也许你可以自己做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T10:59:10.170

Marek 是对的，其他图像生成器也可以工作（`data_uri.c`、`fractal.c`、`charts.c`等）。

`captcha.c`servlet 是唯一使用 PRNG 的，在本例中初始化保持不变（因此结果不变）。您可以通过添加以下代码在代码中看到`printf()`：

```
 u32 seed = (u32)getns();
   prnd_t rnd; // pseudo-random generator (period: 1 << 158)
   sw_init(&rnd, seed); // EPOCH time in nano-seconds

   printf("seed:%u, sw_rnd:%u getns():%lu\n", seed, sw_rand(&rnd), getns()); 
```

种子始终为空，因为结果`getns()`是恒定的（这显然是一个错误）：

```
seed:0, sw_rnd:4048109956 getns():1358679437704429568
seed:0, sw_rnd:4048109956 getns():1358679437704429568
seed:0, sw_rnd:4048109956 getns():1358679437704429568
... 
```

顺便说一句，这是程序员应该自己找到的一个很好的例子（并向程序作者报告）。

# javascript - 如何在 HTML5 画布上点击坐标？

> ID：14416930
> 
> 赞同：2
> 
> 时间：2013-01-19T17:33:19.040
> 
> 标签：javascript, jquery, html, canvas

我需要获取单击 HTML5 画布元素的位置的 x 和 y 坐标。我对 y 坐标做了以下操作：

```
 $("#my_canvas").click(function(event) {
        alert(Math.floor(event.clientY-$(this).offset().top));
 }); 
```

这给了我看起来正确的 y 坐标。问题是如果你向下滚动，`clientY`它会变小，因为它似乎在测量屏幕上的 y 坐标，而忽略了滚动。所以上面给出了一个负数。

获取 x 和 y 坐标的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:35:24.327

使用[pageY](http://api.jquery.com/event.pageY/)而不是`clientY`，以便您比较的两个坐标都相对于文档：

```
event.pageY-$(this).offset().top 
```

# json - 使用渲染的jsp用控制器编写json对象

> ID：14416931
> 
> 赞同：0
> 
> 时间：2013-01-19T17:33:22.440
> 
> 标签：json, jsp, model-view-controller, spring-mvc

我使用 Spring MVC。我想通过转发来呈现一些jsp。然后我想将结果写入json。

例如，我想渲染我的复杂 jsp 并在退出时获得： {"result":"ok","html":"......."}

我怎样才能做到这一点？我试图查看 request.getRequestDispatcher("tutorMini").forward(request, response) 但如果我不能将响应传递给它，那么它应该将所有输出写入它。

而且我尝试在jsp中使用一些json标签，但它在层次结构方面存在一些问题： [HTML output with jsp:include and json-taglib](https://stackoverflow.com/questions/1476508/html-output-with-jspinclude-and-json-taglib)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:57:25.687

由于在将 HTML 插入 JSON（转义`'`和`"`）时需要应用额外的转换，因此您不能将 JSP 的输出直接写入响应。

因此，您需要创建一个实例[`ServletResponseWrapper`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponseWrapper.html)来保存输出（通过覆盖`getWriter()`和/或`getOutputStream()`）并将其传递给`RequestDispatcher.include()`（它看起来比`forward()`这种情况更合适）：

```
MyServletResponseWrapper wrapper = new MyServletResponseWrapper(response);
request.getRequestDispatcher("tutorMini").include(request, wrapper);
String html = wrapper.getSavedOutput(); 
```

然后你可以将保存的内容插入到 JSON 中，并适当地转义它。

# oracle - 杀死shell进程和子oracle进程

> ID：14416932
> 
> 赞同：1
> 
> 时间：2013-01-19T17:33:30.037
> 
> 标签：oracle, shell, process, background, kill

从我的 shell 脚本中，我正在使用 kill 命令杀死我的后台函数进程。该函数使用 sqlplus 调用 SQL 过程：

```
func_foo(){
retval=`sqlplus -s $USER_NAME/$PWD <<EOF
        set pages 0 lines 120 trimout on trimspool on tab off echo off verify off feed off serverout on
        exec pkg_xyz.proc_abc();
        exit;
        EOF`
}

func_foo&
pid_func_foo=$!

sleep 5

kill $pid_func_foo 2>/dev/null
wait $pid_func_foo 2>/dev/null 
```

该方法的问题是，即使我的函数进程被杀死，Oracle 进程也会继续运行。Oracle 进程没有被杀死。我是 Oracle 新手，我不确定如何处理这种情况。请向我提供有关如何处理这种情况的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T07:36:38.270

杀死 Oracle 进程是个坏主意。尝试以另一种方式解决您的问题。

1.  使用 dbms_scheduler 将您的过程作为作业运行。您可以在需要时通过调用 dbms_scheduler.stop_job('job name') 简单地停止作业。

2.  构建您的过程，以便它可以以编程方式停止。我已经建立了几个运行很长时间的程序。该过程不时地检查一个名为“Status”的表，该表仅包含一行。如果状态为“ok”，则继续运行。如果我将行更改为其他内容，则程序会看到这一点并停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T15:15:13.397

在交互式`control-c`SQL*Plus 会话中点击会终止正在运行的命令，生成一条信息性 ORA-01013 消息，并将您留在 SQL*Plus 提示符处——Oracle 进程仍然处于活动状态但处于空闲状态（可能有些过于简单化了）。

您可以通过发送中断信号而不是默认终止信号来获得等效的效果。这可能会根据您的操作系统和 shell 略有不同，但通常类似于：

```
kill -int $pid_func_foo 2>/dev/null 
```

这仍应生成 ORA-01013，并且该`sqlplus`过程将继续。但是，正如您的“此处文档”中的下一条语句一样，`exit`它仍然会停止并且会比终止信号更自然地停止，并且 Oracle 会话将正常清除，从而删除 Oracle 进程。（如果您的过程正在执行任何插入或更新，则事务回滚时可能仍有延迟）。

我不确定这是管理执行时间限制的特别好方法；作业控制或资源管理可能是更好的方法。

# wcf - DuplexChannelFactory (Silverlight) 在运行时工作但不在设计时工作

> ID：14416933
> 
> 赞同：0
> 
> 时间：2013-01-19T17:33:37.133
> 
> 标签：wcf, silverlight, datacontext, design-time, duplex

我有以下代码：

```
 var bind = new PollingDuplexHttpBinding();
            bind.MaxReceivedMessageSize = 2147483647;

            EndpointAddress myEndpoint = new EndpointAddress(address);

            try
            {
                var instContext = new InstanceContext(this);
                var fact = new DuplexChannelFactory<IVisuWcfService>(instContext, bind);
               var channel = fact.CreateChannel(myEndpoint);
                this.visuServices.Add(visuService.Name, channel);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message+ex.StackTrace);
            } 
```

try/catch 在那里可以得到设计器中的错误。

所以现在如下：我的数据上下文中有一个带有此代码的类的实例。这意味着在设计时将创建该对象的一个​​实例。但随后我收到以下错误：无法将类型为“proxy_xx”的对象转换为类型 IVisuWcfService，其中 xx 是一个递增的数字。但是当我在运行时有这段代码时，一切都运行良好。错误发生在以下行： fact.CreateChannel(myEndpoint);

# c# - 从 C# 方法返回方法

> ID：14416936
> 
> 赞同：2
> 
> 时间：2013-01-19T17:33:47.623
> 
> 标签：c#, methods, return-value, return-type

我发现[这篇文章](https://stackoverflow.com/questions/2082615/pass-method-as-parameter-using-c-sharp)解释了如何在 C# 中将方法作为参数传递。

我需要知道的是如何返回一个方法作为另一个方法调用的结果。

```
method = DoSomething()
result = method() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:35:52.827

你需要使用[**`Action<T>`**](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)或者[**`Func<T>`**](http://msdn.microsoft.com/en-us/library/bb549151.aspx)

像这样：

```
private Action<string> Returns(string user)
{
    return () => 
    {
        Console.WriteLine("Hey {0}", user);
    };
} 
```

或这个：

```
private Func<bool> TestsIsThirty(int value)
{
    return () => value == 30;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T17:35:43.420

很可能您希望您的返回类型为`Delegate`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T17:36:10.303

查看[Action](http://msdn.microsoft.com/en-us/library/system.action.aspx)和[Func](http://msdn.microsoft.com/en-us/library/bb534960.aspx)代表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-19T17:37:29.457

```
var method =()=> DoSomething();
result = method(); 
```

# signalr.client - SignalR：Connection.Start().Wait() 无限期挂起浏览器

> ID：14416943
> 
> 赞同：0
> 
> 时间：2013-01-19T17:34:10.710
> 
> 标签：signalr.client

我在 silverlight 应用程序中使用了 0.5.3 版的 SignalR 程序集。我使用 connection.Start().wait() 来启动连接：我的一些观察结果很奇怪：

1.  我通过 Visual Studio 运行应用程序（浏览器内）模式，并且能够建立与 SignalR 集线器的连接
2.  如果我在 IIS 中部署应用程序，然后尝试使用机器的 IP 地址访问应用程序，则对 connection.start().wait() 的调用永远不会返回。我检查了 Fiddler 并发现呼叫永远不会转到 SignalR 集线器
3.  如果我在 OOB 模式（浏览器外模式）下使用应用程序，应用程序可以正常工作。

我的要求是它应该在浏览器模式下工作。有人可以阐明一下，可能是什么问题？

谢谢， 阿尔皮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T20:54:57.933

在我看来，您在浏览器中运行时遇到了Silverlight 的[跨域请求限制。](http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx)您可以在运行 SignalR 的同一域上托管 silverlight 应用程序，也可以按照上面链接中的建议将 clientaccesspolicy.xml 或 crossdomain.xml 文件添加到运行 SignalR 的域的根目录中。

# android - 自定义 EditTextPreference。如何以及何时获取文本以进行保存

> ID：14416949
> 
> 赞同：0
> 
> 时间：2013-01-19T17:35:16.857
> 
> 标签：android, android-preferences

我正在编写自定义 EditTextPreference。

在我的 CustomEditTextPreference 中使用此代码：

```
@Override
protected void onDialogClosed(boolean shouldSave) {
    if (shouldSave) {
        String sValue = getText();          
        value = Float.parseFloat(sValue);           
        peristValue();
    }
} 
```

sValue 为空。那么我如何从编辑中获取价值呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:39:15.257

你可能应该使用

```
getEditText().getText().toString(); 
```

因为[`getText()`](http://developer.android.com/reference/android/preference/EditTextPreference.html#getEditText%28%29)它本身会获取当前的 SharedPreference 值，该值可能存在也可能不存在。

# c# - 如何将任何文件读入字符串

> ID：14416957
> 
> 赞同：1
> 
> 时间：2013-01-19T17:36:02.613
> 
> 标签：c#, string, streamreader

我希望能够将任何文件读入字符串，例如记事本打开 word 文件的方式。使用以下代码：

```
StreamReader sr = new StreamReader(filePath);
text += sr.ReadToEnd();
sr.Close(); 
```

在基本文本文件上工作正常，但是在说单词文件时使用它时，我只会得到一些奇怪的字符，而在记事本中打开同一个文件会显示整个文件、文本、特殊字符等。我将其用作一个文件放到一个文本框中。基本上，我希望获得与在记事本中打开任何文件时相同的输出。我应该改用什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:58:03.180

使用原始问题中的代码并打开文件，*确实会*显示整个流（在调试器中查看时） - 问题是这些二进制文件中的大多数都有空终止符（`\0`char），这将导致大多数查看者停止阅读内容的流。

如果您删除/转义，`'\0'`您将看到整个流，就像在记事本中一样。

例如：

```
string filePath = @"c:\windows\system32\calc.exe";
StreamReader sr = new StreamReader(filePath);
string text = sr.ReadToEnd();
sr.Close();

textBox1.Text = text.Replace('\0', ' '); 
```

将 textbox1 添加到表单并亲自查看...您将看到整个流...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:57:15.407

这应该为您提供所需的功能。首先使用 byte[] 读取文件

```
byte[] data = File.ReadAllBytes(fileName); 
```

然后只需用 ascii 或其他方式对其进行编码。

```
string s = Encoding.ASCII.GetString(data); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-19T17:50:11.970

我假设您指的是写字板，它也包含在 Windows 中，而不是记事本。写字板除了显示基本的文本文件外，还知道解析和编辑 Word 文件（.DOCX，但奇怪的是不是旧的 .DOC 文件）、富文本格式文件 (.RTF) 和 OpenOffice 文档 (*.ODT) . 这并不是仅仅通过打开 Word 文件并显示其内容就可以随意实现的 - 写字板中有很多代码可以解析这些二进制数据并正确显示，更不用说编辑和再次保存它的代码了。

如果您需要从 Word 文件中检索数据，有几个编程选项，首先是使用[Word API](http://msdn.microsoft.com/en-us/library/office/ee861527%28v=office.14%29)自动化 Word 应用程序本身。但是，此解决方案对于在服务器上运行，或者如果您需要在没有安装 Word 的地方打开它们是有问题的。

在这种情况下，您还有多种选择。对于扩展名为 .DOCX 的 2007 年后文档，您可以使用[System.IO.Packaging](http://msdn.microsoft.com/en-us/library/system.io.packaging.aspx)命名空间来打开 DOCX 并提取其相关部分，但您需要了解其中的 XML 文件的语法。或者，你可以购买一个第三方库来为你做这件事，比如[Aspose](http://www.aspose.com/.net/word-component.aspx)，我已经使用过并且很好。还有其他人在那里。

# java - 在单击事件上从 JSP 页面的按钮调用 java 函数

> ID：14416961
> 
> 赞同：0
> 
> 时间：2013-01-19T17:36:18.410
> 
> 标签：java, function, jsp, button, call

有一个以 oracle db（oracle 多媒体格式）存储照片的应用程序。有一个处理连接和 SQL 的 JAVA servlet 页面......，还有一个 JSP 页面在浏览器中显示图像。

JAVA 页面中有一个删除功能，当我单击一个缩略图时，它会导航到另一个 JSP 并显示完整大小的图像。这里我想调用 `public void deleteRowById( String selectId )`JAVA servlet 页面中的函数。我想使用一个按钮，但我真的不知道调用这个函数的正确方法是什么。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:07:51.923

与此同时，我解决了这个问题。有一个包含 SQL 语句的 java 类-taht 是我想用表单按钮调用的。

第一个 JSP 页面显示像删除这样的按钮，它通过使用 post 方法传递一个参数导航到另一个 JSP 页面，在这个第二个 JSP 页面中，我调用执行删除语句的主要 java 类方法，然后从第二个 JSP 页面我导航回来和`<jsp:forward page="1st_page.jsp"/>`

也许不是最先进的解决方案，但就像魅力一样:)

# ruby-on-rails-3 - Rspec 测试：为嵌套资源创建方法

> ID：14416964
> 
> 赞同：0
> 
> 时间：2013-01-19T17:36:32.380
> 
> 标签：ruby-on-rails-3, rspec, integration-testing

我正在尝试设置规范以正确运行我的嵌套资源。

这是我正在尝试正确设置的测试代码

```
it "redirects to the created unit" do
    post :create, {:course_id => @course.id , :unit => valid_attributes}
    response.should redirect_to(course_unit_path(@course, Unit.last))
end 
```

这本质上应该尝试为“课程”创建一个嵌套资源“单元”。不幸的是，我在所有 POST DELETE 和 PUT 测试中都收到以下错误

```
Failure/Error: post :create, {:course_id => @course.id , :unit => valid_attributes}
 NoMethodError:
   undefined method `unit_url' for #<UnitsController:0x000000059f1000> 
```

这是有道理的，因为 unit_url 应该是 course_unit_url 但它是 RSpec 调用它...

如何让 RSpec 选择正确的命名路径？对于所有 GET 测试，我手动通过了 :course_id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:10:33.700

这就是我所做的：

```
it "redirects to the created unit" do
  unit_id = "barry"
  Unit.any_instance.should_receive(:save).and_return(true)
  Unit.any_instance.stub(:id).and_return(unit_id)
  post :create, {:course_id => @course.to_param , :unit => valid_attributes}
  response.should redirect_to(course_unit_path(@course, unit_id))
end 
```

我认为这个测试的重点不是它创建一个新模型并重定向它，而只是它重定向。我有另一个规范来确保它创建一个新模型。这种方法的另一个好处是它不接触数据库，因此它应该运行得更快一些。

我希望这会有所帮助。

**编辑：**

我也刚刚注意到我的`before :each`部分中有这个可能是相关的：

```
Course.stub!(:find).and_return(@course) 
```

**再次编辑：**

在这种情况下，控制器中有代码正在执行违规调用。根据下面的评论。

# php - 在处理初始表单 POST 后将 HTML 块发送到远程服务器

> ID：14416972
> 
> 赞同：0
> 
> 时间：2013-01-19T17:37:37.197
> 
> 标签：php, html, post, curl

// 编辑 //

本质上，问题是在处理表单后如何最好地将动态生成的 HTML 块（可能很大）发送到远程服务器？

// 结束编辑

客户有一个注册表单，该表单包含在许多域中，这些域会发回母站点。到目前为止，我们一直使用母网站的感谢页面来处理所有请求。

客户现在希望允许附属公司在表单字段中填充`$thankyou_url`并使用重定向到附属网站的指定感谢页面。

由于我们对这些注册的响应不断变化，因此我们希望构建一些 HTML 并将其发布到提供的感谢页面以进行显示。

我原以为我会在 cURL 中构建帖子，但我发现我在那里所做的就是取回他们填充的响应页面及其相对路径。

有没有办法使用不同的 cURL 标头向用户发送我们构建的帖子，或者我应该使用其他一些方法？

当前代码：

```
<?php
$url = $remote_thanks_url;
$fields = array(
            'html' => $our_response
        );
foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }
rtrim($fields_string, '&');
$ch = curl_init();
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);
$result = curl_exec($ch);
curl_close($ch);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:46:12.867

你可能想看看这个例子中的`header()`函数（[http://www.php.net/header ）：](http://www.php.net/header)

[如何使用 PHP header() 函数发布到页面？](https://stackoverflow.com/questions/653090/how-do-you-post-to-a-page-using-the-php-header-function)

# android - 在 Flex Mobile Framework 和 Android 中使用 Camera 类

> ID：14416973
> 
> 赞同：1
> 
> 时间：2013-01-19T17:37:47.840
> 
> 标签：android, actionscript-3, apache-flex, actionscript, air

我喜欢很多其他人正在尝试使用 zxing actionscript 库为我的 Flex Mobile 应用程序实现条形码扫描仪。我的问题是，让相机在实际设备上正确显示我有一段时间了。使用网络摄像头在桌面上运行应用程序可以很好地显示视频源。以下是我在 Galaxy Nexus 和 Nexus 7 上获得的类似信息。

![在银河系上](../Images/30e04690b9dc0c36ededf3cb34275266.png)

我一直主要研究这个例子，但也从其他网站获得了建议： [http ://www.remotesynthesis.com/post.cfm/adding-a-qr-code-reader-in-flex-on-安卓](http://www.remotesynthesis.com/post.cfm/adding-a-qr-code-reader-in-flex-on-android)

一切都会为视频对象产生相同的古怪提要。有人知道我能做些什么来纠正这个吗？

这是我当前形式的代码，此时只是试图获得清晰的图像（还没有条形码垃圾）：

扫描仪2.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:bs="com.expologic.barcodescanner"
    title="Scanner" creationComplete="init(event)">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<fx:Script>
    <![CDATA[
        import mx.core.UIComponent;

        import com.expologic.barcodescanner.BarcodeScanner;

        private var bs:BarcodeScanner;

        private function init(e:Event):void {

            bs = new BarcodeScanner();
            bs.horizontalCenter = 0;
            bs.verticalCenter = 0;
            bs.height = 480;
            bs.width = 640;

            addElement(bs);

            //To add a target to the center of the screen
            var uic:UIComponent = new UIComponent();
            this.addElement(uic);

            uic.width = uic.height = 275;
            uic.graphics.lineStyle(3,0xFF0000);
            uic.graphics.drawRect(0,0,275,275);

            uic.horizontalCenter = uic.verticalCenter = 0;

        }

    ]]>
</fx:Script>

</s:View> 
```

条码扫描仪.as

```
package com.expologic.barcodescanner
    {

        import flash.events.Event;
        import flash.media.Camera;
        import flash.media.Video;

        import spark.core.SpriteVisualElement;

        public class BarcodeScanner extends SpriteVisualElement
        {

            private var _video:Video;

            public function BarcodeScanner()
            {

                this.height = 480;
                this.width = 640;

                addEventListener(Event.ADDED_TO_STAGE, _addToStage);

            }

            private function _addToStage(e:Event):void {
                _setupCamera();
            }

            private function _setupCamera():void
            {

                if(!_video)
                {
                    _video = new Video(640, 480);
                    addChild(_video);
                }

                if(Camera.isSupported)
                {
                    var cam:Camera = Camera.getCamera();
                    cam.setQuality(0, 100);
                    cam.setMode(640, 480, 30, false);

                    _video.attachCamera(cam);
                }
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T20:30:14.133

尝试`<renderMode>direct</renderMode>`在您的 app.xml 中进行设置，这为我解决了问题，而且我也在使用 Galaxy Nexus。问候乔科

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T10:04:43.380

我不明白确切的问题，但尝试添加以下链接中列出的权限：

> [zxing 条码扫描仪读取第二个二维码时自动对焦问题](https://stackoverflow.com/questions/14126045/zxing-barcode-scanner-autofocus-issue-on-reading-second-qr-code/14455824#14455824)

# php - 表单上的上传和提交按钮

> ID：14416975
> 
> 赞同：1
> 
> 时间：2013-01-19T17:38:20.897
> 
> 标签：php, jquery, file-upload, form-submit

在 PHP 中，我如何创建一个具有上传按钮的表单，但它也有提交按钮，我从文件和其他一些数据（来自其他输入输出）提交该文本？我可以在一个表单中有两个按钮元素，还是应该将我的表单分成两个表单，一个表单有上传按钮，另一个有提交按钮？我应该使用 jQuery 上传文件，但之后如何访问动作 php 文件中的这些数据？请帮忙。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T17:48:29.760

不需要多种形式。要上传文件，请使用`<input type="file" name="MyFile">`并向`form`元素添加以下属性：`enctype="multipart/form-data"`

将表单提交到服务器后，您将获得一个`$_FILES`超级全局数组（除了包含其余字段的 $_POST 数组），您将在其中找到上传文件的所有详细信息。当您提交表单时，文件会上传到一个临时位置，您需要使用该[`move_uploaded_file()`](http://php.net/manual/en/function.move-uploaded-file.php)功能将其移动到其固定位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T18:09:03.510

是的你可以。您可以执行通过上传按钮触发的上传脚本。在表单的开头包含该脚本。这些方面的东西：

```
<?php

if(isset($_POST['upload'])) {

    //In your upload script you could store all the upload data in $_SESSION
    include('yourUploadScript.php');

}

if(isset($_POST['submit'])) {

    //Trim and escape post data here
    //Send the post data and file upload data via your own submit function/script or whatever

}

?>
<html>
    <body>
        <form method="post" name="myForm" action="thisphp.php" enctype="multipart/form-data">

        Choose a file to upload: <input name="uploadedfile" type="file" /><br />

        <input type="submit" name="upload" value="upload" />

        First name: <input type="text" name="fname"><br />
        Last name: <input type="text" name="lname"><br />

        <input type="submit" name="submit" value="submit" />

        </form>
    </body>
</html> 
```

请记住，动作应该是这个表单/php 文件。另请注意，根据您的文档类型，此 html 可能无效。这只是为了演示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:50:18.567

看看这些链接

[http://php.net/manual/en/features.file-upload.php](http://php.net/manual/en/features.file-upload.php)

[一个表单中的两个提交按钮](https://stackoverflow.com/questions/547821/two-submit-buttons-in-one-form)

[http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)

# c# - 在 WPF 应用程序中，如何覆盖控制台关闭命令？

> ID：14416982
> 
> 赞同：3
> 
> 时间：2013-01-19T17:39:22.663
> 
> 标签：c#, wpf, console

在我的 WPF 应用程序中，我使用控制台窗口作为调试/消息窗口 - 我有选项设置来根据用户的需要显示和隐藏窗口，所有这些都很好。唯一的问题是当用户关闭控制台窗口时，它会退出整个程序。如何覆盖它，以便当用户单击 X 时它只是隐藏控制台而不是退出应用程序？

这就是我到目前为止所拥有的：

```
const int SW_HIDE = 0;
const int SW_SHOW = 5;
public static bool ConsoleVisible { get; private set; }

[DllImport("kernel32.dll")]
static extern IntPtr GetConsoleWindow();

[DllImport("user32.dll")]
static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

public static void HideConsole()
{
    var handle = GetConsoleWindow();
    ShowWindow(handle, SW_HIDE);
    ConsoleVisible = false;

}
public static void ShowConsole()
{
    var handle = GetConsoleWindow();
    ShowWindow(handle, SW_SHOW);
    ConsoleVisible = true;
} 
```

** 对于想要使用此功能的人，您需要：`using System.Runtime.InteropServices;`

此代码源自此答案：[https ://stackoverflow.com/a/3571628/649382](https://stackoverflow.com/a/3571628/649382)

** 编辑 **

环顾四周，似乎这是不可能的。我在这里看到了一个答案：[https](https://stackoverflow.com/a/12015131/649382) ://stackoverflow.com/a/12015131/649382 谈到删除退出按钮也是可以接受的，但它看起来像代码在 C++ 中，我无法弄清楚它是 C#选择。

** 编辑 2 **

我能够弄清楚到 C# 的转换并将其写为下面的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T19:34:59.260

如前所述，没有办法阻止控制台窗口关闭 WPF/应用程序窗口。在 Windows Vista 之前有一些解决方法，但从那时起它们已被删除（可能出于安全原因）。我能够想出的解决方法是禁用控制台窗口上的退出按钮并将显示/隐藏选项放入我的应用程序中。应用程序启动类如下所示：

```
using System;
using System.Windows;
using System.Runtime.InteropServices;

namespace MyApp
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
        public App()
        {
            ConsoleVisible = true;
            DisableConsoleExit();
        }

        #region Console Window Commands

        // Show/Hide
        [DllImport("kernel32.dll")]
        static extern IntPtr GetConsoleWindow();
        [DllImport("user32.dll")]
        static extern bool ShowWindow(IntPtr hWnd, uint nCmdShow);

        const uint SW_HIDE = 0;
        const uint SW_SHOWNORMAL = 1;
        const uint SW_SHOWNOACTIVATE = 4; // Show without activating
        public static bool ConsoleVisible { get; private set; }

        public static void HideConsole()
        {
            IntPtr handle = GetConsoleWindow();
            ShowWindow(handle, SW_HIDE);
            ConsoleVisible = false;

        }
        public static void ShowConsole(bool active = true)
        {
            IntPtr handle = GetConsoleWindow();
            if (active) { ShowWindow(handle, SW_SHOWNORMAL); }
            else { ShowWindow(handle, SW_SHOWNOACTIVATE); }
            ConsoleVisible = true;
        }

        // Disable Console Exit Button
        [DllImport("user32.dll")]
        static extern IntPtr GetSystemMenu(IntPtr hWnd, bool bRevert);
        [DllImport("user32.dll")]
        static extern IntPtr DeleteMenu(IntPtr hMenu, uint uPosition, uint uFlags);

        const uint SC_CLOSE = 0xF060;
        const uint MF_BYCOMMAND = (uint)0x00000000L;

        public static void DisableConsoleExit()
        {
            IntPtr handle = GetConsoleWindow();
            IntPtr exitButton = GetSystemMenu(handle, false);
            if (exitButton != null) DeleteMenu(exitButton, SC_CLOSE, MF_BYCOMMAND);
        }

        #endregion
    }
} 
```

希望这可以帮助每个可能有类似问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T18:04:39.850

我认为您应该考虑使用[AllocConsole创建控制台并使用](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944%28v=vs.85%29.aspx)[FreeConsole](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683150%28v=vs.85%29.aspx)发布它。这样，您就可以让用户能够在保持 WPF 应用程序运行的同时关闭控制台窗口。

# php - PHP 模式搜索

> ID：14416984
> 
> 赞同：0
> 
> 时间：2013-01-19T17:39:52.520
> 
> 标签：php

我试图在文件中搜索 nn/nnnnnn/nn..

我有这个

```
if (preg_match_all("([0-9]{6})", $file, $out)) {
echo "Match was found <br />";
print_r($out); 
```

它处理中心 6 个数字，但我如何让它搜索整个模式？当我必须将搜索字符串添加在一起时，我有点困惑。我知道我必须执行以下操作

([0-9]{2}) 和 / 和 ([0-9]{6}) 和 / 和 ([0-9]{2})

如何将搜索字符串添加为一个？在此先感谢干杯垫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:44:54.040

你也可以用`\d`一个数字代替：

```
preg_match_all("#(\d{2})/(\d{6})/(\d{2})#", $string, $matches);
print_r($matches); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:42:33.857

你有没有尝试过：

```
preg_match_all("/([0-9]{2})\/([0-9]{6})\/([0-9]{2})/") 
```

例如，如果搜索`12/123456/12`，它将输出：

```
Array
(
    [0] => Array
        (
            [0] => 12/123456/12
        )

    [1] => Array
        (
            [0] => 12
        )

    [2] => Array
        (
            [0] => 123456
        )

    [3] => Array
        (
            [0] => 12
        )

) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:44:49.593

试试这个`#(\d{2})/(\d{6})/(\d{2})#`：

```
$file = '23/334324/23';
if (preg_match_all("#(\d{2})/(\d{6})/(\d{2})#", $file, $out)) {
    echo "Match was found <br />";
    print_r($out);
} 
```

回报：

```
Array
(
    [0] => Array
        (
            [0] => 23/334324/23
        )

    [1] => Array
        (
            [0] => 23
        )

    [2] => Array
        (
            [0] => 334324
        )

    [3] => Array
        (
            [0] => 23
        )

) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T17:45:09.457

如何使用`#([0-9]{2})/([0-9]{6})/([0-9]{2})#`：

```
if(preg_match_all("#([0-9]{2})/([0-9]{6})/([0-9]{2})#", $file, $out)) 
{
    echo "Match was found <br />";
    print_r($out);
} 
```

# xslt - 将模板参数命名为模板匹配的 XPath

> ID：14416985
> 
> 赞同：1
> 
> 时间：2013-01-19T17:40:09.160
> 
> 标签：xslt, xpath, xslt-1.0

是否可以将命名模板的参数指定为另一个模板中的匹配模式？

在这里，如果我尝试调用“excerpt”模板并将 XPath 作为“path”参数传递，我会收到错误消息：

```
<xsl:template name="excerpt">
    <xsl:param name="path" select="''" />
    <xsl:apply-templates select="$path" />
</xsl:template>

<xsl:template match="$path">
    <article class="newsarticle">
        <h2><a href="{$root}/news/view/{title/@handle}"><xsl:value-of select="title" /></a></h2>
        <xsl:copy-of select="excerpt/node()" />
    </article>
</xsl:template> 
```

我可以用 来完成它`<xsl:for-each>`，但我想知道是否有一个使用类似于上述方法的好的解决方案。

**编辑：**这是我想要完成的工作，使用`<xsl:for-each>`：

```
<xsl:template name="excerpt">
    <xsl:param name="path" select="''" />
    <xsl:for-each select="$path">
        <article class="newsarticle">
            <h2><a href="{$root}/news/view/{title/@handle}"><xsl:value-of select="title" /></a></h2>
            <xsl:copy-of select="excerpt/node()" />
        </article>
    </xsl:for-each>
</xsl:template> 
```

**编辑：**调用模板的示例：

```
<xsl:call-template name="excerpt">
    <xsl:with-param name="path" select="path/to/nodeset" />
</xsl:call-template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:00:35.863

感谢您的附加信息。这里要澄清的是，在`call-template`那里，您传递的是节点集，而不是路径。如果没有复杂的解析逻辑或扩展函数，路径的字符串值在 XSLT 1.0 中几乎毫无价值。

有一种方法可以做你想做的事，只是方式与你的设想略有不同。您只需要使用具有通用`match`值和`mode`值的模板，就像这样。

```
<xsl:template name="excerpt">
    <xsl:param name="items" select="''" />
    <xsl:apply-templates select="$items" mode="excerptItem" />
</xsl:template>

<xsl:template match="node() | @*" mode="excerptItem">
    <article class="newsarticle">
        <h2>
          <a href="{$root}/news/view/{title/@handle}">
             <xsl:value-of select="title" />
          </a>
        </h2>
        <xsl:copy-of select="excerpt/node()" />
    </article>
</xsl:template> 
```

但是，如果命名模板仅用于调用匹配模板，那么您根本不需要命名模板。您可以直接使用匹配模板：

```
<xsl:apply-templates select="path/to/nodeset" mode="excerptItem" /> 
```

该`mode`属性的目的是当您在 中指定`mode`时`apply-templates`，XSLT 将只考虑也具有相同`mode`值的模板。因此，您可以定义两个不同的模板，以不同的方式处理相同的元素：

```
<xsl:template match="Item" mode="header">
     Item in header: <xsl:value-of select="." />
</xsl:template>
<xsl:template match="Item" mode="body">
     Item in body: <xsl:value-of select="." />
</xsl:template> 
```

然后，您可以指定要在不同时间使用哪一个：

```
<div id="header">
    <xsl:apply-templates match="/root/Items/Item" mode="header" />
</div>
<div id="body">
    <xsl:apply-templates match="/root/Items/Item" mode="body" />
</div> 
```

并且在每种情况下都将使用适当的。[您可以在此处](http://www.w3.org/TR/xslt#modes)阅读有关模式的更多信息。

`node() | @*`是匹配任何节点或属性的通用 XPath，因此如果您在`match`模板的属性中使用它，您可以创建一个几乎匹配您`apply-templates`在）。将其与 a 结合使用，`mode`您可以创建一个模板，您可以在任何节点上调用，并且仅在您想要的特定时间调用。在您的示例中，您将与此模板一起使用的元素看起来总是相同的，因此明确指定它可能是更好的做法：

```
<xsl:template match="ExportItem" mode="excerptItem"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T18:04:49.370

> 是否可以获取命名模板的参数以充当另一个模板中的匹配路径？

**不，在 XSLT 2.0 中，模板的匹配模式只能包含变量引用作为`id()`函数**的参数。

有关模式的完整语法，请参阅 XSLT 2.0 W3C 规范

[http://www.w3.org/TR/xslt20/#pattern-syntax](http://www.w3.org/TR/xslt20/#pattern-syntax)

**在 XSLT 1.0 中，在匹配模式中的任何位置都有变量引用是错误的**。

# regex - 用perl用空格分隔的2个邮寄地址解析行的最佳方法

> ID：14416987
> 
> 赞同：0
> 
> 时间：2013-01-19T17:40:13.880
> 
> 标签：regex, perl

我正在解析 PDF 文件并且有 2 个地址左对齐。除了城市下方的线外，州和邮政编码也分开。

右边的地址总是从索引 > 150 开始（从行首开始）。我可以从索引 > 150 触发任何文本的匹配并在 \n 换行处停止，但这种方法似乎内存密集且速度慢。我在 pdf 中有大约 200 行文本。我也知道地址行（总共 7 行）总是出现在第 40 行和第 48 行之间。寻找一些简单的替代方法来解析这些数据。

```
1011 VALLEY BELT RD                4569 EAST TWINSBURG ROAD\n

open (FILE, "pdftotext -layout file.pdf - |");
while(<FILE>) {
  $i++;
  my($line) = $_;
  $line=~s/\n$/ | [NL]/; # just to visualize the newline on screen
  print "\n<div class=\"line\"><div>$i</div>$line</div>";
  }
close FILE; 
```

pdf由应用程序生成，因此它们是受控的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:02:05.363

如果您确定您正在处理固定宽度的数据，您可以使用`unpack`来提取字段：

```
use strict;
use warnings;
use Data::Dumper;

# creating your input string
my $str = sprintf "%-150s%s\n", "1011 VALLEY BELT RD",
                                "4569 EAST TWINSBURG ROAD";

# unpack 150 ascii chars, space padded (A150) and same to end of string (A*)
my ($first, $second) = unpack "A150A*", $str;

print Dumper $first, $second; 
```

**输出：**

```
$VAR1 = '1011 VALLEY BELT RD';
$VAR2 = '4569 EAST TWINSBURG ROAD'; 
```

如果您知道此数据所在的行号，则可以使用行号变量[`$.`](http://perldoc.perl.org/perlvar.html#%24.)找到正确的位置。例如：

```
while (<FILE>) {
    next unless $. >= 40;
    # do stuff here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T18:45:58.410

您可以使用 match 和 regrex 从行中获取项目。使用分组，您可以进行匹配，然后保存地址。

通过提供的数据样本，我得出以下结论：

```
while ( <DATA> ) {
  chomp;
  m/(\d+\s+.*)\s+(\d+\s+.*)/;
  print "$1\n";
  print "$2\n";
}

__DATA__
1011 VALLEY BELT RD                4569 EAST TWINSBURG ROAD 
```

$1 将包含第一个地址，$2 将包含第二个地址。

这确实假设地址之间有一个空格，并且地址将至少以一位数字开头。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-20T17:50:20.330

@TLP 基于 Dumper 的完整解决方案

** 地址

```
1011 VALLEY BELT RD                4569 EAST TWINSBURG ROAD\n
Philadelphia, PA                   Kansas City, MO\n
18659                              69869\n 
```

** 代码

```
use strict;
use warnings;
use Data::Dumper;

my $i=0;
my $lAddr;
my $rAddr;
open (FILE, "pdftotext -layout file.pdf - |");
while(<FILE>) {
  $i++;
  my($line) = $_;
  if ($i>40 && $i<=48) {
    # unpack 150 ascii chars, space padded (A150) and same to end of string (A*)
    my ($VAR1, $VAR2) = unpack "A150A*", $line;
    $lAddr.=$VAR1;
    $rAddr.=$VAR2;
    }
  }
close FILE; 
```

**输出：**

```
$lAddr = '1011 VALLEY BELT RD Philadelphia, PA 18659';
$rAddr = '4569 EAST TWINSBURG ROAD Kansas City, MO 69869'; 
```

# javascript - firefox 是否会阻止来自本地文件的 ajax 请求甚至被发送出去

> ID：14416990
> 
> 赞同：0
> 
> 时间：2013-01-19T17:40:43.360
> 
> 标签：javascript, firefox, xmlhttprequest, cross-domain, same-origin-policy

我熟悉同源策略，但我想知道的是 firefox 是否真的会阻止来自本地文件的 Ajax POST 请求。我一直在做一些自动化的 javascript 测试，并且在我的服务器上启用了 CORS，但实际上我什至没有看到 xhr 请求使它成为 firebug，这让我相信 firefox 完全阻止了它。

当我在 chrome 中运行相同的请求并允许跨域请求时，它运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:41:57.037

所有现代浏览器都这样做：他们认为所有使用该`file://`协议的请求都是跨域的。

# objective-c - 将 NSArray objectAtIndex 显示到 UILabel 时出错

> ID：14416991
> 
> 赞同：0
> 
> 时间：2013-01-19T17:40:47.230
> 
> 标签：objective-c, object, nsarray, uilabel

尽管我已经做了很多尝试..我无法将 NSArray 中的项目正确显示到 UILabel 中..

当我 NSLog 数组时，控制台会返回这个：

```
2013-01-19 14:34:32.799 bloom[2766:c07] (
"0.877"
) 
```

这是我从网站获取并解析等的值。

问题是，当我在 UILabel 中显示它时，它显示的内容完全相同，我只需要显示不带引号的值。这是它的显示方式：

![显示问题](../Images/28a09aaffca3e76f7f43b356dbfbea28.png)

编辑：

这是我的代码：

```
- (void)configureView
{
// Update the user interface for the detail item.

if (self.detailItem) {

    for (NSDictionary *valuesDatum in _detailItem) {
        NSDictionary *itemAtIndex = (NSDictionary *)_detailItem;
        self.title = [itemAtIndex objectForKey:@"SYMBOL"];
        NSString *strUrl = @"http://www.bloomberg.com/quote/";
        NSString *ativo = [itemAtIndex objectForKey:@"SYMBOL"];
        NSString *consulta = [strUrl stringByAppendingString:ativo];

        NSURL *url = [NSURL URLWithString:consulta];

        NSData *webData = [NSData dataWithContentsOfURL:url];

        NSString *xPathQuery = @"//span[@class=' price'] | //span[@class=' trending_up  up'] | //span[@class=' trending_up up']/span | //table[@class='snapshot_table']/tr/td";

        TFHpple *parser = [TFHpple hppleWithData:webData isXML:NO];

        NSArray *array = [parser searchWithXPathQuery:xPathQuery];

        valores = [[NSMutableArray alloc]init];
        for (TFHppleElement *element in array) {
            [valores addObject:[[element firstChild] content]];
        }

        novosValores = [[NSMutableArray alloc]init];
        for (NSString *valuesDatum in valores) {
            NSString *removeNewLine = [[valuesDatum componentsSeparatedByCharactersInSet: [NSCharacterSet newlineCharacterSet]] componentsJoinedByString:@" "];
            NSString *removeSpace = [removeNewLine stringByReplacingOccurrencesOfString:@"         " withString:@""];
            NSString *removeSpaceOne = [removeSpace  stringByReplacingOccurrencesOfString:@"    " withString:@""];
            NSString *trocaVirgulaPonto = [removeSpaceOne stringByReplacingOccurrencesOfString:@"," withString:@"."];
            [novosValores addObject:trocaVirgulaPonto];
        }

        valoresFinais = [[NSMutableArray alloc]init];
        for (NSString *valuesDatum in novosValores) {
            NSArray *val = [valuesDatum componentsSeparatedByString:@" - "];
            [valoresFinais addObject:val];
        }

        infos = [[NSMutableArray alloc]init];
        for (NSArray *dados in valoresFinais) {
            NSArray *arrayDados = [[NSArray alloc]initWithArray:dados];

            for (NSString *teste in arrayDados) {
                NSArray *arrayTeste = [teste componentsSeparatedByString:@","];
                [infos addObject:arrayTeste];
            }
        }
        NSLog(@"%@",[infos objectAtIndex:0]);

        NSString *fff = [[NSString alloc] initWithFormat:@"%@", [infos objectAtIndex:0]];
        [_detailDescriptionLabel setText:fff];
    }

    }
} 
```

新编辑：

我有这个数组：

```
2013-01-19 15:43:05.055 bloom[3564:c07] (
"7.730",
"0.020",
"0.26%",
"7.750",
"7.650-7.800",
"2.333.100",
"7.710",
"3.730-8.810",
"+4.04%" 
```

)

我只需要一个新数组，其中第 5 行和第 8 行的数据用“-”分隔。

所以有人有灯吗？？

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:19:16.480

我在 Anoop 的帮助下解决了这个问题。我改变了一点他的代码，最后我的代码是这样的：

```
for (NSDictionary *valuesDatum in _detailItem) {
        NSDictionary *itemAtIndex = (NSDictionary *)_detailItem;
        self.title = [itemAtIndex objectForKey:@"SYMBOL"];
        NSString *strUrl = @"http://www.bloomberg.com/quote/";
        NSString *ativo = [itemAtIndex objectForKey:@"SYMBOL"];
        NSString *consulta = [strUrl stringByAppendingString:ativo];

        NSURL *url = [NSURL URLWithString:consulta];

        NSData *webData = [NSData dataWithContentsOfURL:url];

        NSString *xPathQuery = @"//span[@class=' price'] | //span[@class=' trending_up up'] | //span[@class=' trending_up up']/span | //table[@class='snapshot_table']/tr/td";

        TFHpple *parser = [TFHpple hppleWithData:webData isXML:NO];

        NSArray *array = [parser searchWithXPathQuery:xPathQuery];

        valores = [[NSMutableArray alloc]init];
        for (TFHppleElement *element in array) {
            [valores addObject:[[element firstChild] content]];
        }

        novosValores = [[NSMutableArray alloc]init];
        for (NSString *valuesDatum in valores) {
            NSString *removeNewLine = [[valuesDatum componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]] componentsJoinedByString:@" "];
            NSString *removeSpace = [removeNewLine stringByReplacingOccurrencesOfString:@"         " withString:@""];
            NSString *removeSpaceOne = [removeSpace stringByReplacingOccurrencesOfString:@"    " withString:@""];
            NSString *removeSpaceTwo = [removeSpaceOne stringByReplacingOccurrencesOfString:@" " withString:@""];
            NSString *removeDash = [removeSpaceTwo stringByReplacingOccurrencesOfString:@" - " withString:@" "];
            NSString *trocaVirgulaPonto = [removeDash stringByReplacingOccurrencesOfString:@"," withString:@"."];

            [novosValores addObject:trocaVirgulaPonto];
        }

        NSString *fullString=[novosValores componentsJoinedByString:@"_"];
        NSString *changeDash = [fullString stringByReplacingOccurrencesOfString:@"-" withString:@"_"];
        finalArray=[changeDash componentsSeparatedByString:@"_"];
        //NSLog(@"%@", finalArray);

    }
    NSString *str = [[NSString alloc]initWithFormat:@"%@",[finalArray objectAtIndex:10]];
    [_detailDescriptionLabel setText:str]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:43:09.567

```
 (
   "0.877"
) 
```

以上是一个数组，您将该数组放在标签上。

你必须使用`someLabel.text=[thatArray objectAtIndex:0];`

编辑：

根据您的要求尝试这个：（未检查编译器）

```
NSString *fullString=[array componentsJoinedByString:@"+"];
NSArray *brokenString=[fullString componentsSeparatedByString:@"-"];
NSString *mainString=brokenString[1];
NSArray *finalArray=[mainString componentsSepartedByString:@"+"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T17:43:49.627

你确定你是这样的：

```
label.text = [array objectAtIndex:0]; 
```

代替：

```
label.text = array; 
```

# silverlight - 从 ListBox 升级到 CollectionViewSource 不起作用

> ID：14416995
> 
> 赞同：1
> 
> 时间：2013-01-19T17:41:02.893
> 
> 标签：silverlight, windows-phone-7, listbox, collectionviewsource

我已经有一个工作列表框，其中包含本地数据库中的项目。现在我想将其升级为 CollectionViewSource 进行过滤。升级后，带有 CollectionViewSource 的新 ListBox 什么也没有显示。

**主页代码背后：**

```
 // Data context for the local database
    private BuildingDataContext toDoDB;

    // Define an observable collection property that controls can bind to.
    private ObservableCollection<Building> _buildings;
    public ObservableCollection<Building> BuildingTable
    {
        get
        {
            return _buildings;
        }
        set
        {
            if (_buildings != value)
            {
                _buildings = value;
                NotifyPropertyChanged("BuildingTable");
            }
        }
    }

    public CollectionViewSource Source { get; set; }

    // Konstruktor
    public MainPage()
    {
        InitializeComponent();
        // Connect to the database and instantiate data context.
        toDoDB = new BuildingDataContext(BuildingDataContext.DBConnectionString);

        // Data context and observable collection are children of the main page.
        this.DataContext = this;
    }

    protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        // Define the query to gather all of the to-do items.
        var toDoItemsInDB = from Building todo in toDoDB.BuildingTable
        select todo;

        // Execute the query and place the results into a collection.
        BuildingTable = new ObservableCollection<Building>(toDoItemsInDB);

        Source = new CollectionViewSource();
        Source.Source = BuildingTable;

        // Call the base method.base.OnNavigatedTo(e);
    } 
```

为此，我添加了以下几行：

```
public CollectionViewSource Source { get; set; }
Source = new CollectionViewSource();
Source.Source = BuildingTable; 
```

我也试着把

```
Source = new CollectionViewSource();
Source.Source = BuildingTable; 
```

在我的 MainPage 构造函数中。它也不起作用。

**我的 Mainpage.xaml：**

```
 <!--<ListBox x:Name="toDoItemsListBox" ItemsSource="{Binding BuildingTable}" Grid.Row="0" Margin="12, 0, 12, 0" Width="440" SelectionChanged="goToNavigation">-->
        <ListBox x:Name="toDoItemsListBox" ItemsSource="{Binding Source.View}" Grid.Row="0" Margin="12, 0, 12, 0" Width="440" SelectionChanged="goToNavigation">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid HorizontalAlignment="Stretch" Width="440">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Name="textBlockShortcut" Text="{Binding Shortcut}" Width="Auto" HorizontalAlignment="Left" Grid.Column="0" Margin="0,0,0,5" FontSize="36" />
                        <TextBlock Name="textBlockName" Text="{Binding BuildingName}" Width="Auto" HorizontalAlignment="Left" Grid.Column="1" Margin="0,0,0,5" FontSize="36" />
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox> 
```

第一个注释行显示了旧的工作列表框，没有`CollectionViewSource`. 那么我错过了什么？

编辑：

```
 private void goToNavigation(object sender, RoutedEventArgs e)
    {
        // If selected index is -1 (no selection) do nothing
        if (toDoItemsListBox.SelectedIndex == -1)
            return;

        // Navigate to the new page
        PhoneApplicationService.Current.State["SelectedItem"] = toDoItemsListBox.SelectedItem;
        NavigationService.Navigate(new Uri("/NavigationPage.xaml", UriKind.Relative));

        // Reset selected index to -1 (no selection)
        toDoItemsListBox.SelectedIndex = -1;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T19:26:31.883

您通常会在 XAML 中创建并绑定到 CollectionViewSource：

```
<UserControl.Resources>
    <CollectionViewSource x:Key="cvs"/>
</UserControl.Resources>
<Grid>
    <ListBox ItemsSource="{Binding Source={StaticResource cvs}}" ...>
        ...
    </ListBox>
</Grid> 
```

并在代码隐藏中像这样访问 CollectionViewSource：

```
protected override void OnNavigatedTo(NavigationEventArgs e)
{
    ... 
    var cvs = Resources["cvs"] as CollectionViewSource;
    cvs.Source = BuildingTable;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T18:33:40.353

您不直接使用 CollectionViewSource 类，而是使用适当类型的 CollectionView。

```
View = CollectionViewSource.GetDefaultView( myCollection ); 
```

然后你将它直接绑定到你的源。

```
ItemsSource="{Binding View}" 
```

您可以而且只能使用 xaml 中的 CollectionViewSource，因为这是它的主要目的。从代码中，您应该直接创建一个 CollectionView 或使用 GetDefaultView 方法。

# javascript - 使用 Google Earth API 限制缩放/可视区域

> ID：14416996
> 
> 赞同：0
> 
> 时间：2013-01-19T17:41:24.447
> 
> 标签：javascript, zooming, google-earth, google-earth-plugin

我知道这不像 Maps API v3 那样简单，但是使用 Earth API 有效限制缩放或可视区域（如果后者甚至可能的话）的最佳方法是什么？我们正在努力防止人们在导航我们地图的小焦点区域时无意中缩小得太远。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T05:36:05.877

未经测试，但我的第一次尝试可能是监听 viewchanged 事件，并检查当前视图是否符合您的条件。如果没有，你可以飞到你视野中的某个地方，希望效果会有点平滑（但我不太确定它会完全平滑）。

有关检查 viewchanged 事件的示例，请参阅[http://code.google.com/apis/ajax/playground/#viewchange_event_(and_viewchangebegin,_viewchangeend )。](http://code.google.com/apis/ajax/playground/#viewchange_event_(and_viewchangebegin,_viewchangeend)

# ruby-on-rails - “在我附近找到”的 Rails 地理编码/地理定位选项

> ID：14416999
> 
> 赞同：0
> 
> 时间：2013-01-19T17:41:37.663
> 
> 标签：ruby-on-rails, postgresql, geolocation, geocoding

我正在创建一个应用程序，宠物救援中心可以在其中添加需要家的宠物，但我想为该网站的访问者添加一个排序选项，该网站按离他们最近的位置订购宠物（通过 IP 地理位置或他们输入邮政编码或城市）。

*   我有哪些选择？
*   我需要担心任何成本问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:52:10.593

我认为 activerecord-postgis-adapter 是您所需要的。检查一下[https://github.com/dazuma/activerecord-postgis-adapter](https://github.com/dazuma/activerecord-postgis-adapter)。