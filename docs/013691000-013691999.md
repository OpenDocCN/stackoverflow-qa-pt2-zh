# StackOverflow 问答 13691000-13691999

# mysql - 使用 mysqladmin flush-host 解除对网站的阻止

> ID：13691000
> 
> 赞同：0
> 
> 时间：2012-12-03T20:19:52.340
> 
> 标签：mysql, flush

我正在使用Klipfolio访问托管在[InmotionHosting上](http://www.klipfolio.com)[的](http://www.inmotionhosting.com)MySQL 数据库。但是现在，当我尝试连接时，它给了我错误：

```
Unable to connect to database jdbc:mysql://www.website.com:3306/database: null, message from server: "Host '204.232.200.157' is blocked because of many connection errors; unblock with 'mysqladmin flush-hosts'" 
```

我如何解锁它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T16:56:27.970

解决此问题的唯一方法是联系 Inmotion 支持并要求他们清除 IP

# c++ - 如何将 typename 传递给我不想模板化的类？

> ID：13691001
> 
> 赞同：2
> 
> 时间：2012-12-03T20:20:00.450
> 
> 标签：c++, templates, inheritance

我有以下问题（简化版）：

```
Interface X;
class Y : public X { ... }
class Z : public X { ... }

class A
{
    map<int, X> m;
    init() { X bla = new Y or Z; map.insert(...) }
} 
```

我想在创建 A 时指定 Y 或 Z，从而根据指定的类型获得不同的功能。目前我可以“模板化”A，但这意味着我为 A 定义的每个函数都必须指定模板，即使我只需要在一种方法中使用它。另外，我使用的是 g++ 4.2.4，这意味着我无法将函数的实现与头文件分开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:25:23.127

听起来模板确实是大材小用，某种形式的依赖注入更合适。您可以将 in 的特定实例传递`X`给`A::init`，例如：

```
init(X &bla) { map.insert(...); } 
```

或者传入一个工厂函数：

```
init(X (*factory)()) { X bla = factory(); map.insert(...); } 
```

或者执行其中任何一项，但将实例或工厂函数传递给`A`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:33:57.373

> ...即使我只需要以一种方法使用它...

在这种情况下，通常所做的是将未模板化的通用功能移至基类，并定义一个`A`继承基本功能的模板化。IE：

```
class A_base {
    // common things go here, they can be implemented in a .cpp file.
};

// This is the part that depends on T
template<class T>
class A : public A_base
{
    map<int, T> m;
    void init() { T *bla = new T; map.insert(...) }
}; 
```

这是减少代码膨胀的常用技术。万一`A_base`需要调用的方法`A`，可以make `virtual`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T20:24:59.330

如果从使用中看起来`new`，它实际上是`map<int, X*> m`and `X* bla=...`，你可以“模板化”just `init()`，创建一个`Y`or`Z`取决于它的模板参数。

或者，您可以为`X`派生对象提供工厂方法，该方法返回`Y *`或`Z *`取决于`enum`; 或者让调用者`init`指定一个返回适当`X`派生类型的工厂函数。

# jquery - 从一组 `id` 中创建一组元素

> ID：13691002
> 
> 赞同：3
> 
> 时间：2012-12-03T20:20:05.880
> 
> 标签：jquery

我想从 s 数组中创建一组元素，`id`以便它可以用作 jquery 接收器。例如，如果我有 ids: `id1`, `id2`, `id3`，我怎样才能把它变成一个 jquery 选择器，以便相应的元素按这个顺序出现？假设我想要的是`theJquerySelector`，然后我想应用这样的 jquery 操作：

```
theJquerySelector.appendTo($(...)) 
```

`$(...)`另一个与问题无关的 jquery 选择器在哪里。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:21:48.907

您可以这样使用`Array`s[`join()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)方法；

```
$('#' + yourArrayOfIds.join(', #')).appendTo($(/* */)); 
```

一种更 jQuery 风格的方法是在 jQuery 对象上编写一个实用函数来为您执行此操作*（然后将其称为“插件”）*，或者将类添加到相关元素并通过它进行选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:22:44.417

您可以使用`^`选择以字符串开头的属性。

```
$("[id^=id]").appendTo($(..)); 
```

首先对它们进行排序

```
$($("[id^=id]").toArray().sort(function(a, b) { a.id - b.id } )).appendTo() 
```

看来您必须重新包装排序结果才能获得一个 jQuery 对象，但不知道为什么。

# r - 重新排列矩阵中的列

> ID：13691003
> 
> 赞同：5
> 
> 时间：2012-12-03T20:20:14.523
> 
> 标签：r

假设我有`n`一行，`m`列矩阵`A`，我想`m`根据某些特定行的排序对每一列重新排序。

例如，如果我取`order(A[,k])`，这会给我 column 中元素的数字或字母顺序`k`。我现在想`A`根据这些排名对矩阵中的每一列进行排序，以便`1...n`每一行中的元素被排序以对应`1...n`于 column 中的元素（按排名）`k`。有没有一种简单的方法可以在不遍历所有列的情况下做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:49:35.257

只需使用：

```
A[order(A[,k]),] 
```

例如：

```
set.seed(21)
A <- matrix(rnorm(50),10,5)
A[order(A[,1]),] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-03T21:19:23.017

详细说明@joshua 的回答：我认为混淆可能是由于您在***列***上排序但随后将该排序作为索引传递给***rows***。

这可能就是为什么你尝试`A[, order(A[,k])]` 而不是 `A[order(A[,k]),]`

`order(x)`与名称相反，实际上并没有***order*** `x`，而
只是提供了一个***ordering to*** `x`。

* * *

**例如：**

```
set.seed(1)
A <- matrix(sample(LETTERS[2:8], 24, T), ncol=6)
print(A, quote=F)
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] C    C    F    F    G    H   
[2,] D    H    B    D    H    C   
[3,] F    H    C    G    D    F   
[4,] H    F    C    E    G    B    

order(A[, 2])
[1] 1 4 2 3 
```

***注意输出只有 4 个元素长，这是 A 的*行*数，而不是列数。***

输出本质上说在 A 的第 2 列中，

*   第一个元素先出现，
*   第 4 个元素排在第二位，
*   第二个元素进入第三个，
*   ETC..

但是 A 列的每个元素都附加到一行。我们需要重新排序行而不是列。

要将排序应用于整个矩阵（或数据框），我们使用排序作为行索引：

```
rowIndex <- order(A[, 2])

# Note that these are all equivalent
A[rowIndex,  ]
A[order(A[, 2]),  ]
A[c(1, 4, 1, 3),  ] 
```

最后，我们可以传递`order()`多个向量，它将使用后续向量来打破平局。然而，不管我们给它 A 的列数，`order`仍然会给我们一个向量，大小等于 A 的行数：

```
# Order according to column 2; ties are left according to their original order
order(A[, 2])
[1] 1 4 2 3

# Order according to column 2; ties are ordered according to column 5
order(A[, 2], A[, 5])
[1] 1 4 3 2 
```

# r - 具有自定义格式数据的频率分布

> ID：13691006
> 
> 赞同：5
> 
> 时间：2012-12-03T20:20:31.013
> 
> 标签：r

我需要关于 R 绘图的帮助，使用我以前没有使用过的数据格式。知道的请帮忙。

```
NUMBER   FREQUENCY
10          1  
11          1  
12          3  
10          45   
11          2  
12          3 
```

我需要一个条形图，其中 X 轴上的数字（连续，而不是直方图中的 bin）和 Y 上的频率，但结合起来。喜欢

```
10     46  
11     3  
12     6 
```

它看起来很简单，但我有 10,000 行和大量的真实数据，所以我正在寻找 R 中的一个好的解决方案，而不需要手动完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:28:40.750

What about:

```
##tapply splits dd$FREQ by dd$NUM and "sums" them
barplot(tapply(dd$FREQUENCY, dd$NUMBER, sum)) 
```

to get:

![enter image description here](../Images/23fb976fab0f2e280c8ba13fd0a54968.png)

* * *

Read in your data:

```
dd = read.table(textConnection("NUMBER   FREQUENCY
10          1  
11          1  
12          3  
10          45   
11          2  
12          3"), header=TRUE) 
```

# java - JPA 关系可能性

> ID：13691010
> 
> 赞同：0
> 
> 时间：2012-12-03T20:20:52.073
> 
> 标签：java, jpa

我有以下 JPA 实体

具有以下属性的模块类

*   标识符
*   字符串名称
*   字符串代码
*   人事经理

具有以下属性的人员类

*   标识符
*   字符串名称
*   字符串标题
*   人事主管
*   模块模块

现在我需要为 Person 创建以下关系

*   与其监督人的多对一关系
*   与其模块的多对一关系

我不知道如何在它自己的类（Person -> Person）中创建关系。

欢迎大家提出意见。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:40:28.870

你这样做就像你有两个不同类的实体一样：

```
@Entity
public class Person {
    @ManyToOne
    Person supervisor;
    ...
} 
```

如果你想要它是双向的，那么你也可以完全按照你有两个不同类的实体来做：

```
@Entity
public class Person {
    @ManyToOne
    Person supervisor;

    @OneToMany(mappedBy = "supervisor")
    Set<Person> supervised;
} 
```

# java - Eclipse 中的重复大小写错误

> ID：13691011
> 
> 赞同：2
> 
> 时间：2012-12-03T20:20:52.807
> 
> 标签：java, eclipse, duplicates, case

```
public LabelsFactoryImpl() {
        super();
    }

    /**
     * <!-- begin-user-doc -->
     * <!-- end-user-doc -->
     * @generated
     */
    @Override
    public EObject create(EClass eClass) {
        switch (eClass.getClassifierID()) {
            case LabelsPackage.AREA_LABEL: return createAreaLabel();
            case LabelsPackage.AREA_LABEL_VALUE: return createAreaLabelValue();
            case LabelsPackage.COMMON_BORDER_RELATIONSHIP_LABEL: return createCommonBorderRelationshipLabel();
            case LabelsPackage.COMMON_BORDER_RELATIONSHIP_LABEL_VALUE: return createCommonBorderRelationshipLabelValue();
            case LabelsPackage.POPULATION_LABEL: return createPopulationLabel();
            case LabelsPackage.POPULATION_LABEL_VALUE: return createPopulationLabelValue();
            case LabelsPackage.RELATIVE_PHYSICAL_RELATIONSHIP_LABEL: return createRelativePhysicalRelationshipLabel();
            case LabelsPackage.RELATIVE_PHYSICAL_RELATIONSHIP_LABEL_VALUE: return createRelativePhysicalRelationshipLabelValue();
            case LabelsPackage.TRANSPORT_RELATIONSHIP_LABEL: return createTransportRelationshipLabel();
            case LabelsPackage.TRANSPORT_RELATIONSHIP_LABEL_VALUE: return createTransportRelationshipLabelValue();
            case LabelsPackage.PHYSICAL_RELATIONSHIP_LABEL_VALUE: return createPhysicalRelationshipLabelValue();
            case LabelsPackage.ROAD_TRANSPORT_RELATIONSHIP_LABEL: return createRoadTransportRelationshipLabel();
            case LabelsPackage.ROAD_TRANSPORT_RELATIONSHIP_LABEL_VALUE: return createRoadTransportRelationshipLabelValue();
            case LabelsPackage.EARTH_SCIENCE_LABEL: return createEarthScienceLabel();
            case LabelsPackage.EARTH_SCIENCE_LABEL_VALUE: return createEarthScienceLabelValue();
            case LabelsPackage.PARENT_LABEL: return createParentLabel();
            case LabelsPackage.PARENT_LABEL_VALUE: return createParentLabelValue();
            default:
                throw new IllegalArgumentException("The class '" + eClass.getName() + "' is not a valid classifier"); //$NON-NLS-1$ //$NON-NLS-2$
        }
    } 
```

我在 Eclipse 中收到上述代码的“重复大小写错误”。Eclipse 将“AREA_LABEL”行、“PARENT_LABEL”行和“PARENT_LABEL_VALUE”行强调为重复，即使它们看起来不同。我认为这是一个语法错误，但我不确定。如果您需要任何其他代码/类，请告诉我。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:23:15.740

这一切都取决于这些标签的实际*值*，它们可能具有不同的名称但具有相同的值。检查它们的定义，仅从您发布的代码中很难分辨出它们的实际类型和值。

要修复此错误，请确保每个常量*确实*具有不同的值。或者按照@djjeck 的建议使用枚举。

# deployment - 指向Jetty 9中外部目录的上下文

> ID：13691014
> 
> 赞同：4
> 
> 时间：2012-12-03T20:21:11.543
> 
> 标签：deployment, jetty

我想通过设置指向我的外部 .war （外部 webapps 文件夹）的上下文来将 .war 文件部署到 Jetty。我知道如何在 Tomcat 中执行此操作，但我不知道如何为 Jetty 9 执行此操作。

在 Tomcat 中，我放置了一个 .xml 文件以在 $CATALINA_HOME/conf/Catalina/localhost 中配置我的上下文：

```
 <?xml version='1.0' encoding='utf-8'?>
  <!--  Context fragment for deploying ServletExample.war  -->
  <Context path="/CurrencyServlet" docBase="/Users/macbook/Desktop/School/Java/Temp/CurrencyServlet.war" debug="0" privileged="true"/> 
```

任何人都可以为 Jetty 9 提供一个简单的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T10:04:33.773

查看提供的 $jetty_home/webapps/test.xml 文件。在 jetty9 中，您可以通过在 $jetty_home/webapps 中放置一个 ContextProvider 配置文件来配置您的 webapps 等。

看看文档： http: [//www.eclipse.org/jetty/documentation/current/configuring-contexts.html](http://www.eclipse.org/jetty/documentation/current/configuring-contexts.html)

这是您配置 Web 应用程序路径的方式：

```
<Set name="war"><SystemProperty name="jetty.home" default="."/>/webapps/test</Set> 
```

# linux - 从 semop 获取无效参数

> ID：13691016
> 
> 赞同：0
> 
> 时间：2012-12-03T20:21:20.910
> 
> 标签：linux, process, semaphore

我在进程 A 中设置了（semget + init 为 1）一个信号量。分叉了 A，得到了 B。

分叉 B 并得到 C（进程 B、C 的代码位于另一个 .c 文件中，因此我将 semid 作为全局整数与 extern int semid 一起传递）。

在进程 C 代码中，我尝试应用 down(semid) 并得到“无效参数”错误。
我在 down 函数的代码中所做的是：

```
struct sembuf sem_d;
sem_d.sem_num = 0;
sem_d.sem_op = -1;
sem_d.sem_flg = 0;
if ( semop(semid, &sem_d, 1) == -1 )
{
    perror("error with down function");
    return -1;
} 
```

我究竟做错了什么？

我也确信信号量初始化时的半自动在 semop 之前是相同的。
此外，在进程 A 中，BI 正在使用等待（-1）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:21:25.223

我不确定你是否被允许`semget()`在分叉上使用——毕竟这是一个不同的进程空间。

`semget()`无论如何，它是旧 System V 信号量的一部分。

我建议切换到[POSIX 信号量](http://linux.die.net/man/7/sem_overview)-`sem_open()`和`sem_wait()`朋友并使用命名信号量。然后在每个进程中打开相同的信号量名称。

# java - 始终在目标之前运行生命周期阶段（例如包）（例如 exec:exec）

> ID：13691019
> 
> 赞同：4
> 
> 时间：2012-12-03T20:21:29.563
> 
> 标签：java, maven, exec-maven-plugin

我正在尝试进入 Maven 并开始编写一个小型库。作为库代码的一部分，我想要一个小型演示 java 应用程序，可以用来查看库在做什么以及如何使用它。现在真正让我烦恼的一件事是，为了执行该演示，我必须执行两个命令：`mvn package`and `mvn exec:exec`or `mvn package exec:exec`。

有什么方法可以配置 maven 在“exec:exec”之前自动运行“package”？这样我就可以`mvn exec:exec`在新的结帐时运行并且编译会在执行之前隐式发生吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:24:02.993

`mvn package exec:exec`

您可以为 Maven 指定多个目标以作为同一命令的一部分执行。

此外，当您配置`exec`插件时，您可以将执行绑定到`package`阶段：[Lifecycle Intro](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Built-in_Lifecycle_Bindings)

# android - 如何设计类似于 ICS GTalk 或消息应用程序的带有联系人头像的列表视图？

> ID：13691020
> 
> 赞同：0
> 
> 时间：2012-12-03T20:21:30.003
> 
> 标签：android, android-listview, android-imageview

我有一个列表视图，其项目包含左侧联系人的头像。在剩余的空间中，有两行文本，第一行包含人名，第二行包含电子邮件地址（或其他任何文本）。

我想对列表项的布局进行样式设置，以便：

*   头像图像位于视图的最左侧。**左侧没有**填充。

*   列表项的高度仅由**两行文本**的高度决定。无论图像是**大还是小**，图像视图都必须**匹配这个高度**。

***   imageview**的顶部或底部**不能有填充。

    *   imageview 必须**始终是 square**，即使图像本身是矩形的。在这种情况下，图像应该被“缩放”以填充整个正方形，因为它可以**垂直或水平裁剪**，但纵横比必须保持不变。** 

 **这是 ICS Messaging 应用程序的屏幕截图，它符合所有这些标准：

![在此处输入图像描述](../Images/164562930e2eed18c8161e3cea616e3d.png)

我已经阅读了几个涉及 的 SO 线程`android:scaleType`，尝试了许多`scaleType`,`adjustViewBounds`和`wrapContent`/`match_parent`设置的组合，但我从来没有做对。有人可以帮忙吗？

下面是一些可以作为起点的简化 XML 布局：

```
<!-- The avatar -->
<ImageView
    android:id="@+id/contactImageView"
    android:layout_width="???"
    android:layout_height="???"
    android:layout_alignParentLeft="true" />

<!-- The 2-row textual layout -->
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/contactImageView"
    android:orientation="vertical" >

    <!-- First row -->
    <TextView
        android:id="@+id/nameTextView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

    <!-- Second row -->
    <TextView
        android:id="@+id/emailTextView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:34:35.513

如果您修复 ImageView 的宽度和高度并将 ScaleType 设置为 centerCrop，您应该拥有您想要的。

```
<ImageView
    android:id="@+id/contactImageView"
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:layout_alignParentLeft="true"
    android:scaleType="centerCrop" /> 
```**

# qgis - qgis（从 shapefile 中提取的段（链接）起始节点和结束节点 id）

> ID：13691021
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:21:36.387
> 
> 标签：qgis

上个月我一直在处理很多形状文件编辑工具。我试图从形状文件（一个用于节点，一个用于链接）中以适当的格式（node_id，x，y 用于节点和 link_id， start_node_id,end_node_id,...对于链接）以创建预言机空间网络。我得到了节点的 dbf。我现在想从包含折线（道路）的加载形状文件中获取属性表，并且我想将每条折线拆分为其包含它们的开始和结束节点 ID 的线段，除了它们的几何形状。每一个帮助公认..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T11:06:09.987

您可能想稍微澄清一下您的问题，但听起来您想从 shapefile 中获取折线中每个点的详细信息，以便您可以定义线段。

我在这里写了一个示例，说明如何使用 Python 执行此操作：

[https://gis.stackexchange.com/questions/40798/how-to-split-shapefile-per-feature-in-python-using-gdal](https://gis.stackexchange.com/questions/40798/how-to-split-shapefile-per-feature-in-python-using-gdal)

具体来说，注意以下几行：

```
line = geom.asPolyline()
        # all points in the line
        for point in line: 
```

您应该能够使用这个基本示例的变体来实现您的目标。

担

# ios - iOS：键盘在设备上冻结但在模拟器中工作

> ID：13691023
> 
> 赞同：0
> 
> 时间：2012-12-03T20:21:39.630
> 
> 标签：ios, keyboard, uitextfield

每当我在设备上的子类 UITextfield 中输入文本时，我都会输入两个或三个字符，然后应用程序就会冻结。无法关闭键盘或触摸任何选项卡。这是 UITextField 子类：

```
@implementation OAI_TextField

@synthesize elementID;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

        colorManager = [[OAI_ColorManager alloc] init];
        fileManager = [[OAI_FileManager alloc] init];

        self.font = [UIFont fontWithName:@"Helvetica" size:20.0];
        self.textColor = [colorManager setColor:66.0 :66.0 :66.0];
        self.borderStyle = UITextBorderStyleRoundedRect;
        self.backgroundColor = [UIColor whiteColor];
        self.returnKeyType = UIReturnKeyDone;
        self.delegate = self;

    }
    return self;
}

#pragma mark Text Field Delegate Methods
- (BOOL)textFieldShouldReturn:(UITextField *)textField {

    [self resignFirstResponder];

    //if project number text field we're going to check and see if the "Project" directory contains the file, if not we'll create it

    //get super view
    UIView* myParent = self.superview;

    //get the subviews
    NSArray* mySiblings = myParent.subviews;

    //get the label
    UILabel* myLabel = [mySiblings objectAtIndex:0];

    //get the label text
    NSString* myLabelText = myLabel.text;

    //check it!
    if ([myLabelText isEqualToString:@"Project Number:"]) {

        NSString* projectNumberPlist = [NSString stringWithFormat:@"%@.plist", self.text];
        NSString* projectNumberPlistPath = [NSString stringWithFormat:@"Projects/%@", projectNumberPlist];

        [fileManager createFile:projectNumberPlist:projectNumberPlistPath];

    }

    return YES;
}

- (void)textFieldDidBeginEditing:(UITextField *)textField {
    NSLog(@"ok");
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end 
```

我将在 - (void)textFieldDidBeginEditing: 中获得 NSLog 调用。我在控制台中没有收到任何错误消息。不太确定从哪里开始调试。有人可以轻推我一下吗？

谢谢

# android - Google Play Services V2 库中的 NoClassDefFoundError

> ID：13691028
> 
> 赞同：46
> 
> 时间：2012-12-03T20:22:21.670
> 
> 标签：android, google-maps, google-play-services

[遵循官方教程](https://developers.google.com/maps/documentation/android/start)后尝试使用 Google Play Services V2 库时出现以下异常。

```
java.lang.NoClassDefFoundError: com.google.android.gms.R$string
at com.google.android.gms.common.GooglePlayServicesUtil.b(Unknown Source)
at com.google.android.gms.common.GooglePlayServicesUtil.a(Unknown Source)
at com.google.android.gms.common.GooglePlayServicesUtil.getErrorDialog(Unknown Source) 
```

我哪里做错了？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-04T12:30:40.730

我也遇到过同样的问题，我正确地按照步骤操作并能够解决这个问题

**首先（从 Google Developer 控制台设置您的项目）** 转到[API 控制台 - Google 代码](https://code.google.com/apis/console/)

创建一个项目 如图所示 ![在此处输入图像描述](../Images/e175820492bd571b3bc05a3a1835fbc4.png)

单击创建，然后您将要求添加项目名称，如图所示

![在此处输入图像描述](../Images/af0133bdaaa6b3efb80b46936fede152.png)

创建项目后，是时候选择我们需要使用的服务了，在这种情况下，我们需要 android v2 地图，因此从 Service 中选择**Google Maps Android API v2如图所示，**![在此处输入图像描述](../Images/3d6826adcf24601011c212998f9e0d95.png)

现在转到 Api Access 并创建您的 OAuth 2.0 。通过在相应字段中提供您的包名称和 SHA1 指纹。 ![在此处输入图像描述](../Images/a46da9592703c004b996915f4dfbc0eb.png)

完成 OAuth 2.0 后，我们就可以使用您的 API 密钥了 ![在此处输入图像描述](../Images/e5fdceea36511dd1b3dfb2c21b609bc4.png)

现在创建一个与创建 OAuth 2.0 时使用的包名称相同的 Android 项目。并检查您是否在 Android SDK Manager 中 有**google play 服务，否则请安装 google play 服务。**![在此处输入图像描述](../Images/226017b2ab7c75ed4b5e8b3096724bc7.png)

安装 Google playservice 后，您会在您的 Android ***YourSdkpath\extras\google\google_play_services***中找到一个 Google play 库。将该项目导入您的工作区，并将其作为您项目的参考库 ![在此处输入图像描述](../Images/eb22f96bdac3ad9a4958f5891ed19be8.png)

![在此处输入图像描述](../Images/7304dd279421b7a07cfc375b8b8799cc.png)

![在此处输入图像描述](../Images/840e4f64a4d0013f8ebf542f7414737d.png)

之后将相应的 java 和 xml 文件放入您的项目中。

**MainActivity.java**

```
package yourpackage;//Package name used while creating the Api key

import com.google.android.gms.common.ConnectionResult;
 import com.google.android.gms.common.GooglePlayServicesUtil;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;

import android.os.Bundle;
import android.app.Activity;
import android.app.Dialog;
import android.support.v4.app.FragmentActivity;
import android.view.Menu;

public class MainActivity extends FragmentActivity {
GoogleMap googleMap;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Getting status
    int status = GooglePlayServicesUtil.isGooglePlayServicesAvailable(getBaseContext());

    // Showing status
    if(status==ConnectionResult.SUCCESS)
    {
        SupportMapFragment supportMapFragment = (SupportMapFragment) 
                getSupportFragmentManager().findFragmentById(R.id.map);

        // Getting a reference to the map
        googleMap = supportMapFragment.getMap();
    }
    else{

        int requestCode = 10;
        Dialog dialog = GooglePlayServicesUtil.getErrorDialog(status, this, requestCode);
        dialog.show();
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

**activity_main.xml**

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
   android:name="com.google.android.gms.maps.SupportMapFragment"
   android:layout_width="wrap_content"
   android:layout_height="match_parent" /> 
```

**AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="yourpackage"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />
   <permission
    android:name="yourpackage.permission.MAPS_RECEIVE"
    android:protectionLevel="signature"/>

<uses-permission android:name="yourpackage.permission.MAPS_RECEIVE"/>

<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="yourpackage.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
      <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="YourAPIkey"/> 
```

希望对你有帮助

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-12-03T20:29:28.417

版本 2 包括资源，必须作为库项目导入。请参阅[http://developer.android.com/google/play-services/setup.html](http://developer.android.com/google/play-services/setup.html)上的说明，了解如何在各种 IDE 中执行此操作。

这些资源用于 GooglePlayServicesUtil.getErrorDialog()，它指导用户安装、更新、启用等 Google Play 服务（如果设备上不可用）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-06-17T18:02:44.690

对于 Android 工作室：

1) 打开模块设置：

2) 从 SDK 添加（导入）模块 google_play_service_lib

![图片](../Images/841f75da63c73e5eb100b9dc560c8222.png)

3) 模块 google_play_service_lib 检查为库

4) 从 SDK 添加库 google_play_service.jar

5) 完成

![图片](../Images/98f179aa6aa222cae3c561beb39939e1.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-09T19:19:39.227

如果您已经升级 SDK 并收到此类错误，请记住：

*   如果您在 Eclipse 项目中复制了此文件，请使用新版本的 google-play-services.jar
*   *在project.properties*中设置 target=android-19
**   对于较新的 API（我使用 API 19），您可能需要添加以下代码*

 ***AndroidManifest.xml**

```
<application
<meta-data
android:name="com.google.android.gms.version"
android:value="@integer/google_play_services_version" />
</application> 
```

我还使用**ourSdkpath\extras\google\google_play_services**作为如上所述导入的 Eclipse 库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-19T17:57:35.243

我通过在导入 google play 服务库时选中“将项目复制到工作区”解决了这个错误。
更多信息在这里：http: [//developer.android.com/google/play-services/setup.html](http://developer.android.com/google/play-services/setup.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-26T16:40:35.407

如果你正在使用

```
compile 'com.google.android.gms:play-services:9.0.2' 
```

将其更改为单个的，例如

```
compile 'com.google.android.gms:play-services-location:9.0.2' 
```

`compile 'com.android.support:multidex:1.0.1'`如果你有也加 `multiDexEnabled=true`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-12T08:07:48.077

在没有 Gradle 的情况下构建项目时，我对 Android Studio 也有同样的问题。GooglePlayService 项目中 AndroidManifest.xml 中的包名可能有问题。它应该是**package="com.google.android.gms"**。

当我将库项目添加为**"New Module"**而不是**"Import Module"**时出现问题。

![在此处输入图像描述](../Images/e5ea1f5ade6393be31b548b9b4ad5884.png)

当您选择 New Module 时，Android Studio 会显示对话框来指定“Module name”和“Package name”，默认情况下“Package name”看起来像“com.example.MODULE_NAME_YOU_SPECIFED”，这是**错误**的。很容易错过它，因为项目构建成功。

![在此处输入图像描述](../Images/c6e74f82868baeafd6df5049344dc117.png)

当您通过**“导入模块”**添加库项目时，一切都应该没问题，因为 Android Studio 只是添加项目而不对库项目的源代码进行任何更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-24T12:46:09.293

我也面临同样的问题。如果您在模拟器中运行您的应用程序，则可能会遇到此错误，因为在大多数模拟器中没有安装 google playService（Play 商店应用程序）。

因此，尝试在安装了 playService 应用程序的 android 设备中运行您的应用程序。

解决方案： - 添加错误部分代码`try...catch`，然后尝试它也可以在模拟器中工作。

注意：- 谷歌消息服务需要 palyservice。否则抛出错误`SERVICE_NOT_AVAILABLE`*

# r - 如何使 randomForest 模型尺寸更小？

> ID：13691029
> 
> 赞同：5
> 
> 时间：2012-12-03T20:22:32.010
> 
> 标签：r, artificial-intelligence, data-mining, random-forest

我一直在用 R 中的 700 万行数据（41 个特征）训练 randomForest 模型。这是一个示例调用：

myModel <- randomForest(响应~., data=mydata, ntree=50, maxnodes=30)

我确实认为只有 50 棵树和 30 个终端节点，“myModel”的内存占用会很小。但它在转储文件中是 65 兆。该对象似乎持有来自训练过程的各种预测、实际和投票数据。

如果我只想要森林怎么办？我想要一个很小的转储文件，稍后我可以加载它以快速做出预测。我觉得森林本身不应该那么大......

任何人都知道如何将这个傻瓜分解成我可以预测未来的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:50:25.210

试图摆脱将答案作为评论发布的习惯......

`?randomForest`建议不要使用具有大量变量的公式界面...如果您不使用公式界面，结果会有所不同吗？的*Value*部分`?randomForest`还告诉你如何关闭一些输出（重要性矩阵、整个森林、邻近矩阵等）。

例如：

```
myModel <- randomForest(mydata[,!grepl("RESPONSE",names(mydata))],
  mydata$RESPONSE, ntree=50, maxnodes=30, importance=FALSE,
  localImp=FALSE, keep.forest=FALSE, proximity=FALSE, keep.inbag=FALSE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-01T05:46:00.557

您可以利用`tuneRF`R 中的函数来了解树的数量并缩小大小。

```
tuneRF(data_train, data_train$Response, stepFactor = 1.2, improve = 0.01, plot = T, trace = T) 
```

用于`?tuneRF`了解更多关于内部变量的信息。

# c# - 防止使用过期密码打开 ODP.net 连接

> ID：13691030
> 
> 赞同：4
> 
> 时间：2012-12-03T20:22:32.593
> 
> 标签：c#, .net, wcf, silverlight, oracle

我正在开发一个使用 oracle 安全性对用户进行身份验证的 Silverlight 应用程序。（这是业务需求，因此无法更改）。

为此，我调用了一个 WCF Web 服务，该服务尝试使用提供的用户名和密码打开与数据库的连接。如果连接失败，我会捕获异常并向用户返回一条消息，这是登录代码：

```
[OperationContract]
public LoginResult LogIn(string username, string password, DateTime preventCache)
{
    var result = new List<string>();

    try
    {
       connectionString = ConfigurationManager.ConnectionStrings["SecurityBD"].ToString();
        connectionString = connectionString.Replace("[username]", username);
        connectionString = connectionString.Replace("[password]",passowrd)
        using (var connection = new Oracle.DataAccess.Client.OracleConnection())
        {

            connection.ConnectionString = connectionString;                    
            connection.Open();
            if (connection.State == System.Data.ConnectionState.Open)
            {                        
                connection.Close();
                return new LoginResult(true, GetPermisos(username), preventCache);
            }
            else
            {
                return new LoginResult(false, null, preventCache);
            }
        }

    }
    catch (Oracle.DataAccess.Client.OracleException ex)
    {
        if (ex.Number == 1017)
        {
            return new LoginResult(new SecurityError("Wrong credentials.", ErrorType.InvalidCredentials));
        }
        //Password expired.
        if (ex.Number == 28001)
        {
            return new LoginResult(new SecurityError("Password expired.", ErrorType.PasswordExpired));
        }
        //Acount is locked.
        if (ex.Number == 28000)
        {
            return new LoginResult(new SecurityError("Account is locked.", ErrorType.AccountLocked));
        }
        else
        {
            return new LoginResult(new SecurityError("An error occurred while attempting to connect." + Environment.NewLine + "Error: " + ex.ToString(), ErrorType.UndefinedError));
        }
    }
    catch (Exception exg)
    {
        return new LoginResult(new SecurityError("An error occurred while attempting to connect." + Environment.NewLine + "Error: " + exg.ToString(), ErrorType.UndefinedError));
    }
} 
```

如果连接因密码过期而失败，我会向用户显示相应的消息，然后提示他输入旧密码和新密码，然后将新凭据发送到我的 Web 服务上的 ChangePassword 方法。

```
[OperationContract]      
public ChangePasswordResult ChangePassword(string username, string oldPasswrod, string newPassword)
{
    string connectionString = string.Empty;
    try
    {
                       connectionString = ConfigurationManager.ConnectionStrings["SecurityBD"].ToString();
        connectionString = connectionString.Replace("[username]", username);
        connectionString = connectionString.Replace("[password]",passowrd)
        using (var connection = new OracleConnection(connectionString))
        {                    
            connection.Open();
            if (connection.State == System.Data.ConnectionState.Open)
            {                        
                connection.Close();
                using (var newConnection = new Oracle.DataAccess.Client.OracleConnection(connectionString))
                {
                    newConnection.OpenWithNewPassword(Cryptography.TransportDecrypt(newPassword));
                    if (newConnection.State == System.Data.ConnectionState.Open)
                    {

                        return new ChangePasswordResult(null);
                    }
                }
            }
            return new ChangePasswordResult(new SecurityError("Couldn't connect to the database.", ErrorType.UndefinedError));
        }
    }
    catch (OracleException ex)
    {
        if (ex.Number == 1017)
        {
            return new ChangePasswordResult(new SecurityError("Wrong password", ErrorType.InvalidCredentials));
        }
        //Password expired.
        if (ex.Number == 28001)
        {
            using (var newConnection = new Oracle.DataAccess.Client.OracleConnection(connectionString))
            {
                try
                {
                    newConnection.OpenWithNewPassword(Cryptography.TransportDecrypt(newPassword));                            
                    if (newConnection.State == System.Data.ConnectionState.Open)
                    {
                        return new ChangePasswordResult(null);
                    }
                    else
                    {
                        return new ChangePasswordResult(new SecurityError("No se pudo establecer una conexión con la base de datos", ErrorType.UndefinedError));
                    }
                }
                catch (Oracle.DataAccess.Client.OracleException oex)
                {
                    if (oex.Number == 28003)
                        return new ChangePasswordResult(new SecurityError("You'r new password does not match the security requeriments.." + Environment.NewLine + oex.Message, ErrorType.PasswordNotChanged));
                    else
                        return new ChangePasswordResult(new SecurityError(oex.Message, ErrorType.UndefinedError));
                }
            }
        }
        //Acount is locked.
        if (ex.Number == 28000)
        {
            return new ChangePasswordResult(new SecurityError("Account is locked.", ErrorType.AccountLocked));
        }
        else
        {
            return new ChangePasswordResult(new SecurityError("Couldn't establish a connection." + Environment.NewLine + "Error: " + ex.Message, ErrorType.UndefinedError));
        }
    }
    catch
    {
        throw;
    }
} 
```

我执行修改密码操作后，用户仍然可以使用旧密码连接，而无法使用新密码连接。只有在我重新启动应用程序后，更改才会生效。

我正在使用 oracle 的 ODP.net 驱动程序。使用 Microsoft 的 oracle 客户端，用户可以在更改密码后同时使用新密码和旧密码进行连接。

该`preventCache`参数仅用于验证没有类型的客户端缓存。我从客户端发送当前日期，然后从 Web 服务返回相同的值，以查看它是否随着后续请求实际发生变化，并且它按预期进行。

我已经尝试监听`InfoMessage`连接事件，看看是否有任何警告，但这样做可以防止密码过期异常出现，并且代码永远不会到达`eventHandler`.

我完全迷失了，这种行为对我来说似乎很奇怪，我仍然没有找出问题的根本原因。

我尝试在桌面（WPF）应用程序上复制`LogIn`和`ChangePassword`方法，它的行为完全相同。所以我想问题不在于silverlight客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T17:17:20.897

好的，我已经想通了。`Connection.Close()`即使在执行该方法后，使用 Toad 检查连接也会提醒打开。这种行为似乎是 oracle 的连接池机制的一部分。

包括`Pooling=false`在连接字符串上解决了这个问题。

# sharepoint - SharePoint 用户组的位置和可见性

> ID：13691035
> 
> 赞同：0
> 
> 时间：2012-12-03T20:22:49.363
> 
> 标签：sharepoint, sharepoint-2010

我在 SharePoint 子网站中创建了一组用户，即按下`Create Group`了此特定子网站`Permissions`页面功能区上的按钮。尽管如此，我还是在我的父站点的组列表中看到了这个组。

这是否意味着所有 SharePoint 组都存储在网站集级别？这意味着所有组都与集合中的任何站点相关？

如果是这样，这种设计的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T05:08:51.413

是的，您可以从主站点和集合中的**任何**网站访问所有组。我想原因是让您能够使用您收藏的任何网站中的任何组。

# sql - 当我添加 LEFT OUTER JOIN 时，查询只返回几行

> ID：13691036
> 
> 赞同：4
> 
> 时间：2012-12-03T20:22:51.110
> 
> 标签：sql, sql-server, tsql, left-join

原始查询返回 160k 行。当我添加左外连接时：

```
LEFT OUTER JOIN Table_Z Z WITH (NOLOCK) ON A.Id = Z.Id 
```

该查询仅返回 150 行。我不确定我做错了什么。

我需要做的就是在查询中添加一列，这将从不同的表中带回一个代码。代码可以是数字或 NULL。我仍然必须显示 NULL，因此是 LEFT 连接的原因。他们应该加入“id”列。

```
SELECT <lots of stuff> + the new column that I need (called "code").
FROM 
    dbo.Table_A A WITH (NOLOCK)
INNER JOIN 
    dbo.Table_B B WITH (NOLOCK) ON A.Id = B.Id AND A.version = B.version

--this is where I added the LEFT OUTER JOIN. with it, the query returns 150 rows, without it, 160k rows.    
LEFT OUTER JOIN 
    Table_Z Z WITH (NOLOCK) ON A.Id = Z.Id
LEFT OUTER JOIN 
    Table_E E WITH (NOLOCK) ON A.agent = E.agent
LEFT OUTER JOIN 
    Table_D D WITH (NOLOCK) ON E.location = D.location
                            AND E.type = 'Organization'
                            AND D.af_type = 'agent_location'
INNER JOIN 
    (SELECT X , MAX(Version) AS MaxVersion 
     FROM LocalTable WITH (NOLOCK) 
     GROUP BY agemt) P ON E.agent = P.location AND E.Version = P.MaxVersion 
```

有谁知道可能导致问题的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:41:31.223

当您`LEFT OUTER JOIN`在表`A`和之间执行时`E`，您正在维护您的原始数据集`A`。也就是说，表中没有数据或缺少数据`E`可以减少查询中的行数。

`E`但是，当您随后在底部之间和底部执行 INNER JOIN`P`时，您确实可以减少返回的行数。这会将您的后续`LEFT OUTER JOIN`s视为`INNER JOIN`s。

现在，如果没有您的确切架构和一组数据进行测试，这可能是也可能不是您遇到的确切问题。尽管如此，作为一般规则，始终将您的 s 放在您`INNER JOIN`的 s 之前`OUTER JOIN`。它可以使编写这样的查询变得更加容易。您最严格的连接首先出现，然后您不必担心以后会破坏任何外部连接。

作为快速修复，尝试将您的最后一个连接更改`P`为 a `LEFT OUTER JOIN`，以查看`Z`连接是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-21T13:50:35.563

一旦开始使用 LEFT JOIN，就必须非常小心。假设这个模型：您有表**Products**、**Orders**和**Customers**。并非所有产品都必须已订购，但每个订单都必须有客户输入。

**任务：**显示所有产品，如果产品已订购，列出订购客户；即，没有订单的产品将显示为一行，有 10 个订单的产品将在结果集中显示 10 行。这需要围绕`FROM Products LEFT JOIN Orders`.

现在有人可能会想“好吧，客户总是输入订单，所以我可以做`inner join from orders to customers`”。**错了**。由于表 Customers 是通过左连接表 Orders 连接的，因此它必须自身进行左连接...否则内部连接将传播到上一个级别，结果，您将丢失所有没有订单。

也就是说，一旦您使用 LEFT JOIN 连接任何表，通过该表连接的任何**后续表**都需要保留 LEFT JOIN。但这并不意味着一旦你使用了 LEFT JOIN，所有的连接都必须是那种类型......只有那些依赖于第一次执行的 LEFT JOIN 的连接。例如，如果您只想查看具有类别集的产品，那么将表**Products**与另一个表**Category**进行INNER JOIN 是完全可以的。

*（答案基于此答案：[http](http://www.sqlservercentral.com/Forums/Topic247971-8-1.aspx) ://www.sqlservercentral.com/Forums/Topic247971-8-1.aspx -> 最后一个条目）*

# macos - PS1 中的什么导致我的 Terminal.app 命令卡在屏幕上？

> ID：13691038
> 
> 赞同：3
> 
> 时间：2012-12-03T20:22:53.757
> 
> 标签：macos, bash, terminal

当循环输入到控制台的语句时，我偶尔会发现我输入的文本没有刷新，提示向右移动。

我最初的预期提示：[http](http://cl.ly/image/04080N260L1V) ://cl.ly/image/04080N260L1V 。

点击向上和向下箭头大约十几次后会发生什么：http: [//cl.ly/image/1n3S2K31340R](http://cl.ly/image/1n3S2K31340R)。

如果屏幕截图不清楚，带下划线的文本（在本例中为“ `vim ~/.bas`”）将被“添加”到提示中。我删不掉 但是，如果我尽可能多地删除，清除提示*后*的所有文本，然后按 Enter，我会再次看到我干净的原始提示：[http](http://cl.ly/image/2O1h1Z2y0n2I) ://cl.ly/image/2O1h1Z2y0n2I 。

以下是`~/.bash_profile`包含的内容：

```
# Simpler bash prompt in Terminal.app
promptColor="\e[1;34m"
endColor="\e[m"
#export PS1='\e[0;36m\w$ \e[0m'
export PS1="$promptColor\w$ $endColor"

# Syntax highlighting for commands like `ls` and such
alias ls="ls -G"

# PATH ammendment to put Homebrew-installed apps in front of system-provided ones
homebrew=/usr/local/bin:/usr/local/sbin:/usr/local/share/npm/bin
export PATH=$homebrew:$PATH 
```

我已将罪魁祸首缩小到 PS1 变量。（您可以看到我已经尝试了几种不同的方法。）根据我所阅读的内容，我正确使用了颜色代码。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:33:37.750

这是[一个常见问题解答](http://tldp.org/HOWTO/Bash-Prompt-HOWTO/nonprintingchars.html)。为了让 Bash 能够正确计算提示的显示长度，任何非打印序列（例如颜色代码）都需要在`\[...\]`序列内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:27:24.567

我想你想要：

```
promptColor='\e[1;34m'
endColor='\e[m'
export PS1="$promptColor"'\w$ '"$endColor" 
```

（注意从双引号到单引号的所有细微变化）

问题是当需要明确解释时，bash 正在对以下内容进行扩展：

*   `\e[1;34m`
*   `\w$`
*   `\e[m`

单引号和双引号在 shell 中表示不同的含义：[强引用与弱引用](http://www.grymoire.com/Unix/Quote.html#uh-1)。

我也会复制并粘贴带有转义字符的行并修改它们（注意它们与文字表示不同）

# sql - 如何在 shell 脚本中运行的 db2 sql 查询中转义撇号？

> ID：13691042
> 
> 赞同：0
> 
> 时间：2012-12-03T20:23:13.997
> 
> 标签：sql, shell, db2

我正在尝试运行一个查询，该查询将在其输出中包含静态列。select 语句在我通过 CLP 运行时有效，但在我在 shell 脚本中执行时无效：

```
su - myid -c 'db2 connect to mydb;db2 -x -v "select COL1,'','',COL2,'','',COL3L from MYTABLE fetch first 10 rows only"; db2 connect reset;' 
```

当我运行它时，我得到的输出错误是：

```
SQL0104N  An unexpected token "," was found following "select COL1,".
Expected tokens may include:  "<select_sublist>".  SQLSTATE=42601

SQL1024N  A database connection does not exist.  SQLSTATE=08003 
```

我什至尝试将 select 语句放在一个变量中并将其插入到语句中，但仍然是同样的错误。任何帮助将不胜感激。-谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:11:20.150

您应该将单引号转义为反冲，如下所示：

```
su - myid -c 'db2 connect to mydb;db2 -x -v "select COL1,\'\',\'\',COL2,\'\',\'\',COL3L from MYTABLE fetch first 10 rows only"; db2 connect reset;' 
```

当心，我没有测试它......刚刚手头没有外壳。

**更新：**

最后我得到了一个 DB2 实例。经过一些测试后，我得到了它的工作。事实证明，以前的语法是错误的。引用单引号的正确方法是（在这种情况下）'\''，如：

```
su - myid -c 'db2 connect to mydb;db2 -x -v "select COL1,'\'','\'',COL2,'\'','\'',COL3L  from MYTABLE fetch first 10 rows only"; db2 connect reset;' 
```

这是因为必须关闭整个命令周围的单引号 (') 以便为 db2 查询 (\') 中的单引号提供转义，然后重新打开以恢复命令引用 (')。虽然看起来很奇怪，但它确实有效......

这是我用来测试它的命令：

```
bash -c 'db2 connect to mydb;db2 -x -v "select 1,'\'','\'',2,'\'','\'',3  from SYSIBM.SYSDUMMY1 fetch first 10 rows only"; db2 connect reset;' 
```

# c# - 通用方法 - 我可以避免在此代码中使用反射吗？

> ID：13691050
> 
> 赞同：1
> 
> 时间：2012-12-03T20:23:54.620
> 
> 标签：c#, generics

说我有以下方法：

```
private static void SetLastModifiedTimeUser<TEntity>(TEntity entity) where TEntity : class
{
    PropertyInfo propertyInfo;

    propertyInfo = entity.GetType().GetProperty("LastModifiedUser");
    if (propertyInfo != null)
        propertyInfo.SetValue(entity, IdentityHelper.UserName, null);
} 
```

如您所见，该方法接受泛型类型。传递给此方法的每个类都将包含一个名为“LastModifiedUser”的属性。有没有一种方法可以在不使用反射的情况下访问此属性？我不认为有，但我想我会问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:25:30.187

是的，如果您的所有实体都具有`LastModifiedUser`属性，那么您可以使所有实体都从基类继承，或者实现一些接口，例如

```
public interface IModifyable
{
    string LastModifiedUser { get; set; }
} 
```

然后只需添加此约束（或使您的方法非泛型，接受`IModifyable`）

```
where TEntity : class, IModifyable 
```

您的代码将如下所示：

```
private static void SetLastModifiedTimeUser<TEntity>(TEntity entity) 
   where TEntity : class, IModifyable
{
   entity.LastModifiedUser = IdentityHelper.UserName;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:26:06.643

让您的类从定义`LastModifiedUser`属性的接口继承。

```
public interface ILastModifiedUser
{
    public string LastModifiedUser { get; set; }
} 
```

将您的方法声明更改为

```
private static void SetLastModifiedTimeUser(ILastModifiedUser entity) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:27:25.237

如果你不能修改所有的类来实现一个通用的接口，你可以使用`dynamic`

```
private static void SetLastModifiedTimeUser<TEntity>(TEntity entity) where TEntity : class
{
    dynamic d = entity;
    d.LastModifiedUser = IdentityHelper.UserName;
} 
```

[否则它就像Robert Harvey](https://stackoverflow.com/questions/13691050/generic-method-can-i-avoid-using-reflection-in-this-code/13691096#13691096)所示的那样简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T21:27:07.887

如果您无法向对象添加接口，请考虑这种方法。

第一次遇到每个类型（TEntity）时，它会查找属性并获取属性的 SetMethod。然后，在每次使用时，它都会创建调用该方法。

```
var one = new EntityOne();
LastModifiedTimeUserSetter.Set(one);
Console.WriteLine(one.LastModifiedUser);

public static class LastModifiedTimeUserSetter
{
  public static void Set<TEntity>(TEntity entity)
  {
     var method = Properties.GetOrAdd(typeof (TEntity), GetSetMethod);
     var action = (Action<string>) Delegate.CreateDelegate(typeof (Action<string>), entity, method);
     action(IdentityHelper.UserName);
  }
  static MethodInfo GetSetMethod(Type type)
  {
     var prop = type.GetProperty("LastModifiedUser");
     if (prop == null)
        return null;
     return prop.GetSetMethod();
  }

  static readonly ConcurrentDictionary<Type, MethodInfo> Properties = new ConcurrentDictionary<Type, MethodInfo>();
} 
```

### 走得更远

有一种方法可以通过使用[System.Reflection.Emit.MethodBuilder](http://msdn.microsoft.com/en-us/library/system.reflection.emit.methodbuilder.aspx)来进一步提高性能。并构建一个采用 Entity 并设置属性的方法。

```
public static class LastModifiedTimeUserSetter
{
  public static void Set<TEntity>(TEntity entity)
  {
     var action = (Action<TEntity>) Properties.GetOrAdd(typeof(TEntity), CreateDynamicSetMethodDelegate);
     if(action != null)
        action(entity);
  }

  static Delegate CreateDynamicSetMethodDelegate(Type type)
  {
     return CreateDynamicSetMethod(type).CreateDelegate(GetActionType(type));
  }

  static DynamicMethod CreateDynamicSetMethod(Type typeWithProperty)
  {
     var methodBuilder = new DynamicMethod(
        "Dynamic_" + typeWithProperty.FullName + "_SetLastModifiedUser",
        typeof (void),
        new[] {typeWithProperty});
     EmitSimpleAssignmentMethod(methodBuilder,
                                GetIdentityHelperUserNameGetMethod(),
                                GetPropertySetMethod(typeWithProperty));
     return methodBuilder;
  }

  static MethodInfo GetIdentityHelperUserNameGetMethod()
  {
     return typeof(IdentityHelper).GetProperty("UserName").GetGetMethod();
  }

  static MethodInfo GetPropertySetMethod(Type type)
  {
     var prop = type.GetProperty("LastModifiedUser");
     if (prop == null)
        return null;
     return prop.GetSetMethod();
  }

  static void EmitSimpleAssignmentMethod(DynamicMethod methodBuilder, MethodInfo getMethod, MethodInfo setMethod)
  {
     var il = methodBuilder.GetILGenerator();
     il.Emit(OpCodes.Ldarg_0);
     il.EmitCall(OpCodes.Call, getMethod, null);
     il.EmitCall(OpCodes.Call, setMethod, null);
     il.Emit(OpCodes.Ret);
  }

  static Type GetActionType(Type type)
  {
     return typeof (Action<string>).GetGenericTypeDefinition().MakeGenericType(type);
  }

  static readonly ConcurrentDictionary<Type, Delegate> Properties = new ConcurrentDictionary<Type, Delegate>();
} 
```

请参阅[MSDN 杂志上有关 XBOX Live 的文章](http://msdn.microsoft.com/en-us/magazine/cc163960.aspx)。

# javascript - 使用 JQuery 从 html5 视频播放器触发事件

> ID：13691054
> 
> 赞同：4
> 
> 时间：2012-12-03T20:24:11.703
> 
> 标签：javascript, jquery, html, html5-video

当我的 html5 视频播放器达到某个时间时，我想显示（）一个 div。我能够在视频末尾显示一个 div，但我不确定如何在视频处于特定时间（例如 0:06）时显示 div。

```
<div id = "showdiv" style="display:none" align="center">
        this is the message that will pop up.
</div>

<video id='myVideo' align="center" margin-top="100px" class='video-js 
       vjs-default-skin' preload='auto' data-setup='{}' width='800' height='446'>
<source src='myVideo.mp4' type='video/mp4'l></source>
<script>
document.getElementById('myVideo').addEventListener('ended',myHandler,false);  
function myHandler(e) {
    if(!e) { e = window.event; }
    $("#showdiv").toggle("slow");
}
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:34:31.113

看看`timeupdate`事件。 [https://developer.mozilla.org/en-US/docs/Mozilla_event_reference/timeupdate](https://developer.mozilla.org/en-US/docs/Mozilla_event_reference/timeupdate)

```
var runAtTime = function(handler, time) {
 var wrapped = function() {
     if(this.currentTime >= time) {
         $(this).off('timeupdate', wrapped);
         return handler.apply(this, arguments);
    }
 }
 return wrapped;
};

$('#myVideo').on('timeupdate', runAtTime(myHandler, 3)); 
```

[http://jsfiddle.net/tarabyte/XTEWW/1/](http://jsfiddle.net/tarabyte/XTEWW/1/)

# java - 检查文件是否可作为 BufferedImage 读取

> ID：13691058
> 
> 赞同：0
> 
> 时间：2012-12-03T20:24:21.313
> 
> 标签：java, image, bufferedimage, javax.imageio

有没有办法检查文件是否可以作为 BufferedImage 读取，而无需使用 ImageIO.read(File) 进行尝试？

我最终可以提取文件的 mime 类型，但是是否有 BufferedImage 或类似的默认支持的 mime 类型列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:36:09.657

我不知道默认情况，但`ImageIO.getReaderMIMETypes()`会给你*当前*支持的读者列表。

正确的做法可能是尝试`ImageIO.createImageInputStream(file)`- 如果它不抛出 IOException，但返回 null，则图像不可读。

请注意，对于不受支持的 MIME 格式，它`ImageIO.read(file)`也*不会*抛出异常，它将返回 null。只会对无法解码的受支持文件（即文件已损坏）或 IO 错误（显然）引发异常。

# java - 测验完成后琐事游戏未显示正确结果 - 文本视图和按钮问题 - Java (android)

> ID：13691062
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:24:25.410
> 
> 标签：java, android, button, textview

Results.java 类中的 showResults() 方法的输出无法正常工作。琐事游戏循环遍历所有 10 个问题并显示供用户选择答案。第 10 题之后，会显示一个结果页面，其中包含正确和错误答案的结果。正确的问题将显示为绿色，不正确的问题将显示为红色。问题的颜色没有以正确的颜色显示。此外，变量“correctAnswers”和“wrongAnswers”不会在 QuestionView 类中递增。这可以从 Results.java 中的 showResults() 的输出中看出。

我已经在很多地方进行了调试，但似乎无法找到我搞砸的地方。

对此问题的帮助以及代码结构建议表示赞赏！先感谢您！

结果.java

```
public class Results extends Activity {

    QuestionView qv = new QuestionView();
    ArrayList<Question> queryList = qv.getQueries();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.resultsmain);

        Button homeBtn = (Button)findViewById(R.id.homeBtn);
        Button highscoresBtn = (Button)findViewById(R.id.highscoresBtn);

        homeBtn.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                Intent intent1 = new Intent(Results.this, MainMenu.class);
                startActivity(intent1);
            }
        });

        highscoresBtn.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                Intent intent2 = new Intent(Results.this, Highscores.class);
                startActivity(intent2);
            }
        });

        showResults();
    }

    public void showResults() {

        ArrayList<TextView> tList = new ArrayList<TextView>(10);

        TextView header = (TextView)findViewById(R.id.header);
        TextView q1 = (TextView)findViewById(R.id.q1);
        TextView q2 = (TextView)findViewById(R.id.q2);
        TextView q3 = (TextView)findViewById(R.id.q3);
        TextView q4 = (TextView)findViewById(R.id.q4);
        TextView q5 = (TextView)findViewById(R.id.q5);
        TextView q6 = (TextView)findViewById(R.id.q6);
        TextView q7 = (TextView)findViewById(R.id.q7);
        TextView q8 = (TextView)findViewById(R.id.q8);
        TextView q9 = (TextView)findViewById(R.id.q9);
        TextView q10 = (TextView)findViewById(R.id.q10);

        tList.add(q1);
        tList.add(q2);
        tList.add(q3);
        tList.add(q4);
        tList.add(q5);
        tList.add(q6);
        tList.add(q7);
        tList.add(q8);
        tList.add(q9);
        tList.add(q10);

        tList.get(0).setText(queryList.get(0).getQuery());

        if(queryList.get(0).getCorrectness() == true) {
            tList.get(1).setText("Changed to true");
        } else {
            tList.get(1).setText("DID NOT Change to true");
        }

        tList.get(2).setText(Integer.toString(qv.getCorrectAnswers()));
        tList.get(3).setText(Integer.toString(qv.getWrongAnswers()));

/*      for(int i = 0; i < 10; i++) {
            tList.get(i).setText(queryList.get(i).getQuery());
            if(queryList.get(i).getCorrectness() == true) {
                tList.get(i).setTextColor(Color.GREEN);
            } else {
                tList.get(i).setTextColor(Color.RED);
            }
        }*/
    }
} 
```

QuestionView.java

```
public class QuestionView extends Activity {

    Quiz quiz = new Quiz();
    ArrayList<Question> queries = quiz.getRandom10();

    int correctAnswers = 3;
    int wrongAnswers = 3;

    int answer = 0;

    int i = 0;

    Button answer1;
    Button answer2;
    Button answer3;
    Button answer4;
    TextView question;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.questionviewmain);

        answer1 = (Button)findViewById(R.id.answer1);
        answer2 = (Button)findViewById(R.id.answer2);
        answer3 = (Button)findViewById(R.id.answer3);
        answer4 = (Button)findViewById(R.id.answer4);

        question = (TextView)findViewById(R.id.question);

        loadQuestion();
    }

    public void loadQuestion() {

        if(i == 9) {

            endQuiz();

        } else {

            answer = queries.get(i).getCorrectAnswer();

            question.setText(queries.get(i).getQuery());

            answer1.setText(queries.get(i).getA1());
            answer2.setText(queries.get(i).getA2());
            answer3.setText(queries.get(i).getA3());
            answer4.setText(queries.get(i).getA4());

            answer1.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    if(answer == 0) {
                        correctAnswers++;
                        queries.get(i).setSelectedAnswer(0);
                        queries.get(i).setCorrectness(true);
                        nextQuestion();
                    } else {
                        wrongAnswers++;
                        queries.get(i).setCorrectness(false);
                        nextQuestion();
                    }
                }
            });

            answer2.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    if(answer == 1) {
                        correctAnswers++;
                        queries.get(i).setSelectedAnswer(1);
                        queries.get(i).setCorrectness(true);
                        nextQuestion();
                    } else {
                        wrongAnswers++;
                        queries.get(i).setCorrectness(false);
                        nextQuestion();
                    }
                }
            });

            answer3.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    if(answer == 2) {
                        correctAnswers++;
                        queries.get(i).setSelectedAnswer(2);
                        queries.get(i).setCorrectness(true);
                        nextQuestion();
                    } else {
                        wrongAnswers++;
                        queries.get(i).setCorrectness(false);
                        nextQuestion();
                    }
                }
            });

            answer4.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    if(answer == 3) {
                        correctAnswers++;
                        queries.get(i).setSelectedAnswer(3);
                        queries.get(i).setCorrectness(true);
                        nextQuestion();
                    } else {
                        wrongAnswers++;
                        queries.get(i).setCorrectness(false);
                        nextQuestion();
                    }
                }
            });
        } 
    }

    public int getCorrectAnswers() { return correctAnswers; }
    public int getWrongAnswers() { return wrongAnswers; }

    public ArrayList<Question> getQueries() {
        return queries;
    }

    public void nextQuestion() {
        i++;
        loadQuestion();
    }

    public void endQuiz() {
        Intent intent = new Intent(QuestionView.this, Results.class);
        startActivity(intent);
    }
} 
```

测验.java

```
public class Quiz {

    ArrayList<Question> qList = new ArrayList<Question>(100);
    ArrayList<Question> tenQs = new ArrayList<Question>(10);

    public Quiz() {

        qList.add(new Question("A", "B", "C", "D", 3, "Question 1?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 2?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 3?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 4?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 5?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 6?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 7?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 8?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 9?", 0, false));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 10?", 0, true));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 11?", 0, true));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 12?", 0, true));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 13?", 0, true));
        qList.add(new Question("A", "B", "C", "D", 3, "Question 14?", 0, true));
    }

    public ArrayList<Question> getRandom10() {
        Random r = new Random();
        for(int i = 0; i < 10; i++) {
            Question x = qList.get(r.nextInt(qList.size()));
            tenQs.add(x);
        }
        return tenQs;
    }
} 
```

问题.java

```
public class Question {
    String a1;
    String a2;
    String a3;
    String a4;
    int correctAnswer;
    String query;
    int selectedAnswer;
    boolean correctness;

    public Question() {
    }

    public Question(String a1, String a2, String a3, String a4, int correctAnswer, String query, int selectedAnswer, boolean correctness) {
        this.a1 = a1;
        this.a2 = a2;
        this.a3 = a3;
        this.a4 = a4;
        this.correctAnswer = correctAnswer;
        this.query = query;
        this.selectedAnswer = selectedAnswer;
        this.correctness = correctness;
    }

    public String getA1() { return a1; }
    public String getA2() { return a2; }
    public String getA3() { return a3; }
    public String getA4() { return a4; }
    public String getQuery() { return query; }
    public int getCorrectAnswer() { return correctAnswer; }
    public boolean getCorrectness() { return correctness; }

    public void setSelectedAnswer(int newAnswer) {
        selectedAnswer = newAnswer;
    }

    public void setCorrectness(boolean newAnswer) {
        correctness = newAnswer;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:33:16.607

> QuestionView 类中的变量“correctAnswers”和“wrongAnswers”没有递增。这可以从 Results.java 中的 showResults() 的输出中看出。

一旦将 Activity 置于后台，就无法保证它不会在没有警告的情况下被销毁。您需要在 Intent 中传递答案计数：

```
public void endQuiz() {
    Intent intent = new Intent(QuestionView.this, Results.class);
    intent.putExtras("correct", correctAnswers);
    intent.putExtras("wrong", wrongAnswers);
    intent.putExtras("queries", queries); // You will need to make Question implement Parcelable 
    startActivity(intent);
} 
```

然后在结果活动中读取这些值。否则，您将面临丢失此信息并获得默认值 3 的风险。（简而言之，没有任何问题`correctAnswers++`。）

* * *

你也有很多非常相似/重复的代码。例如，您可以在答案中使用一个 OnClickListener 并进行一些小的更改：

```
OnClickListener answerClick = new OnClickListener() {
    public void onClick(View v) {
        int index = (Integer) v.getTag();
        if(answer == index) {
            correctAnswers++;
            queries.get(i).setSelectedAnswer(index);
            queries.get(i).setCorrectness(true);
        } else {
            wrongAnswers++;
            queries.get(i).setCorrectness(false);
        }
        nextQuestion();
    }
};

answer1 = (Button)findViewById(R.id.answer1);
answer1.setOnClickListener(answerClick);
answer1.setTag(0);

answer2 = (Button)findViewById(R.id.answer2);
answer2.setOnClickListener(answerClick);
answer2.setTag(1);

//etc 
```

# php - 一种整理此 PHP 代码的方法

> ID：13691063
> 
> 赞同：2
> 
> 时间：2012-12-03T20:24:27.050
> 
> 标签：php, if-statement

我有以下 PHP 代码：

```
<?php

//code above    
$pic_1 = $afil['image_1'];  
$pic_2 = $afil['image_2'];
$pic_3 = $afil['image_3'];
$pic_4 = $afil['image_4'];
$pic_5 = $afil['image_5'];
$pic_6 = $afil['image_6'];
$pic_7= $afil['image_7'];
$pic_8 = $afil['image_8'];
$pic_9 = $afil['image_9'];
$pic_10 = $afil['image_10'];

if ($pic_1 = "")
{
$pic_1 = //defaultpic - to be defined, same as below
}

if ($pic_2 = "")
{
$pic_2 = //defaultpic
}
?> 
```

与其对每张图片重复这些“if”语句（直到 $pic 10），我只是想知道是否有人可以指出一种更优雅、更有效的方法。我对php很陌生，这是我遇到的新情况。提前非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:28:46.780

只需 1条语句就可以使用`arrays`和循环它们，就像这样，`if`

```
 foreach($afil as $k => $v) {
  if(empty($v))
    $afil[$k] = ...//default pic
 } 
```

或者，如果您渴望拥有一个额外的阵列`$pics`（可能供将来使用），

```
foreach($afil as $k => $v) {
  $pics[$k] = $v;
  if(empty($v))
    $pics[$k] = ...//default pic
 } 
```

此外，`=`是一个赋值运算符。对于比较（或条件检查），您需要使用`==`或`===`（类型安全）。

**编辑：**

```
 $afil = mysql_query(...);
 while($row = mysql_fetch_array($afil)) {
  //In here, say you create an array $result_rows with all the rows
  $result_rows[] = $row;
 } 
```

然后，`$result_rows`在 foreach 中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:29:46.133

[Arrays](http://php.net/manual/en/language.types.array.php)是您的黄金解决方案：

```
$pic = array('image_1', 'image_2', 'image_3'....);

for ($i = 0; $i < count($pic); $i++){
if ($pic[$i] == ""){
$pic[$i] = //defaultpic - 
}

} 
```

# arrays - 在新数组中划分 2 个数组时出错

> ID：13691067
> 
> 赞同：1
> 
> 时间：2012-12-03T20:24:35.037
> 
> 标签：arrays, divide

```
public double[] deel(int[] rij1, int[] rij2)
    {
        final int RIJ_LENGTH = 5;
        double rij[] = new double [RIJ_LENGTH];

        for (int i = 0; i < rij.length; i++)
            rij[i] = (double) (rij1[i]/rij2[i]);

return rij;
} 
```

这是一种创建名为“rij”的新数组的方法。这个新数组具有元素 (rij1 / rij2)。所以 rij[0] = rij1[0]/rij2[0]

但是当我尝试运行此代码时，它显示错误：“/ by zero”

请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:31:16.287

您的数组是整数，整数除以零是未定义的。您需要在除以元素之前检查数组元素是否非零，并决定在分母为零的情况下您的结果应该采用什么值。另请注意，您的输出数组是一个`double`数组，但您的数据会丢失精度，因为参数是`int`数组，整数除法与浮点除法的工作方式非常不同 - 整数除以整数的结果是另一个整数，而不是双精度. 要获得您想要的行为，您应该将分子或分母转换为双精度数，**而不是**结果，因为这只是在整数除法发生**后转换整数结果。**如果您是编程新手，请 google**整数除法**或搜索一些处理整数除法的stackoverflow问题。

编辑：根据您的评论，这一行

```
rij[i] = (double) (rij1[i]/rij2[i]); 
```

应该

```
rij[i] = ((double)rij1[i]) / rij2[i]; 
```

（或者您可以将分母转换为双精度 - 甚至两者兼而有之）以防止整数除法错误。您的错误是告诉您您正在除以零，这表明`rij2[i]`对于`i`. 您需要在代码中检测到这一点。如果您确定所有元素都严格大于零，那么我建议您可能在其他一些代码覆盖这些值的其他地方遇到错误。无论哪种方式，您都可以逐步调试调试器或添加一些错误捕获代码以绝对确定。如果您实际上是除以零，我不能“只编辑”您的代码以避免除以零！

# ruby-on-rails - 是否有常见的原因导致 Cucumber 测试在其他通过功能代码的情况下失败 60% 的时间？

> ID：13691068
> 
> 赞同：0
> 
> 时间：2012-12-03T20:24:40.313
> 
> 标签：ruby-on-rails, testing, cucumber

我最近开始研究一个所有通过黄瓜测试的项目。但我会说 60% 的时间他们因超时而失败，或者只是随机间歇性错误。所以大约有 1/4 倍的时间一切都会过去并变成绿色。

这种间歇性有常见的原因吗？我应该担心吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T17:05:56.043

大多数时候，验收测试可能是一件棘手的事情。您必须检查代码的异步部分（长数据库事务、Ajax、MessageQueues）。为测试和构建时间设置一些对您有意义的超时（长时间的构建时间不是很好。我认为 10 分钟是*可以接受*的，除此之外，您可以查看您的测试，如果它们足够好的话）。

另一个问题是浏览器（如果您正在使用它），*预热*和开始所有测试可能需要很长时间。

# javascript - 脚本 src javascript

> ID：13691069
> 
> 赞同：3
> 
> 时间：2012-12-03T20:24:41.510
> 
> 标签：javascript

这段代码有什么区别

```
 var head=document.getElementsByTagName('head')[0]
      var script=document.createElement('script')
       script.setAttribute('type', 'text/javascript')
       script.setAttribute('src', "http://your-script.com/address-here.js")
       head.appendChild(script) 
```

和这段代码

```
 <script type="text/javascript" src="http://your-script.com/address-here.js">  

      </script> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:28:42.573

顶部的 javascript 将向文档的第一个 head 标签附加一个新元素，该标签应该等于`<script type="text/javascript" src="http://your-script.com/address-here"></script>`（或接近）。唯一的区别是浏览器会在遇到 HTML 版本时立即加载它，而 JS 在元素完成添加之前不会被加载。

正如@lostsource 提到的，这通常用于加载依赖脚本或用于引入 polyfill，例如`if(!someJSFeatureIWant) {//import the script here}`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:29:17.297

第一个通常用作包含脚本所需的其他 Javascript 文件的一种方式。（它只是`<script>`像第二个代码示例一样动态创建标签）

例如，您可能会在 main.js 文件中包含核心功能，然后根据用户交互性决定包含其他脚本。（例如 graphics.js、forms.js 等）

同样的方法也用于通过动态包含返回 JSON“填充”响应的 url来发出[JSON-P请求。](http://en.wikipedia.org/wiki/JSONP)`iframes`与常规`XHR`请求相比的主要优点是`<script>`标签不受同源策略的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:27:56.973

一种是 JavaScript，它会在创建 DOM 后向 DOM 添加一个脚本。另一种是 HTML，将在创建 DOM 时向其添加脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:33:00.387

本质上，两者都加载一个 js 文件，但第一个示例有效地按需创建另一个。

```
var head=document.getElementsByTagName('head')[0]
var script=document.createElement('script')
script.setAttribute('type', 'text/javascript')
script.setAttribute('src', "http://your-script.com/address-here.js")
head.appendChild(script) 
```

您通常会使用它在运行时（在创建之后）将外部代码加载到页面中。示例中使用的这种特定语法也会污染全局范围，不应按原样使用。

```
<script type="text/javascript" src="http://your-script.com/address-here.js">  
</script> 
```

这是加载脚本文件的自然 HTML 语法。如果页面代码在您的控制之下，那么您没有理由使用除此之外的任何东西，除非在特殊情况下需要它或出于优化目的。

# jquery - jquery DropKick在ajax上重新加载内容

> ID：13691074
> 
> 赞同：1
> 
> 时间：2012-12-03T20:25:05.647
> 
> 标签：jquery, ajax, plugins, reload, jquery-dropkick

无论如何要在加载后重新加载或同步 DropKick 下拉列表...我指的是这个漂亮的 jquery 插件

[http://jamielottering.github.com/DropKick/](http://jamielottering.github.com/DropKick/)

我所拥有的是一个需要动态的州、城市 ajax 加载下拉列表......

我试过了

```
$('#select').removeData("dropkick");  
then 
$('#select').dropkick(); 
```

有人做过吗？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:22:07.173

我认为您应该在调用 dropkick() 之前删除 dk_container div。

尝试：

```
$('#select').removeData("dropkick");   
$('div.dk_container').remove();   
$('#select').dropkick(); 
```

它适用于 DropKick v.1.0.0。

hth

# bash - Shell 相当于 Perl 的骰子

> ID：13691076
> 
> 赞同：3
> 
> 时间：2012-12-03T20:25:15.500
> 
> 标签：bash, zsh, exit-code

`die`Perl 的函数是否有等效的 shell（在 bash 或 zsh 中） ？

我想设置退出代码并在一行中打印一条消息。我知道我可以制作自己的简单功能，但我有点希望内置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:26:37.540

不，你需要两者 `echo`和`exit`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:52:05.887

只需制作这样的`shell`功能：

```
die() {
    [[ $1 ]] || {
        printf >&2 -- 'Usage:\n\tdie <message> [return code]\n'
        [[ $- == *i* ]] && return 1 || exit 1
    }

    printf >&2 -- '%s' "$1"
    exit ${2:-1}
} 
```

**例子**

```
die "Oops, there's something wrong!\n" 255 
```

**解释**

*   第一个参数是需要的消息，第二个可选参数是返回码：
*   `${2:-1}`是一个 bash[参数扩展](http://wiki.bash-hackers.org/syntax/pe)：`exit 1`如果缺少第二个参数
*   在[shell](/questions/tagged/shell "显示标记为“外壳”的问题")中，`1`与`FALSE`(1 => 255)相同
*   在现代[bash](/questions/tagged/bash "显示标记为“bash”的问题")中，`die() { }`首选旧的`function die {}`
*   **像 Maxwell 一样将STDERR**重定向到**STDOUT**不是最佳做法，相反，我直接重定向到**STDERR**（就像这样`perl`做）
*   如果你想在*交互式 shell*中使用它，把它放进去`~/.bashrc`然后`source ~/.bashrc`
*   如果你想在脚本中使用它，你可以`source ~/.bashrc`在你的脚本中或者手动放置。
*   `[[ $- == *i* ]]`测试您是否在交互式外壳中

# jquery-mobile - JQM 下拉菜单标题和每个选项的事件处理

> ID：13691080
> 
> 赞同：0
> 
> 时间：2012-12-03T20:25:23.293
> 
> 标签：jquery-mobile

您好，我正在尝试在菜单栏中制作一个带有 2 个下拉菜单的 JQM Webapp，例如 -

菜单 1 页面标题 SubMenu 1

* * *

Menu1 有 5 个主选项，Menu2 有 5 个子选项，

就像如果用户从 [First Menu] 中选择一个选项 5 个选项将显示在 Submenu1 中，并且每个子菜单都会有一个 HTML 页面。[所以总共将有 25 页] 喜欢

Menu1 --Submenu1 --新页面 [menu1-submenu1.html]

Menu1 --Submenu2 --新页面 [menu1-submenu2.html]

Menu1 --Submenu3 --新页面 [menu1-submenu3.html]

Menu1 --Submenu4 --新页面 [menu1-submenu4.html]

Menu1 --Submenu5 ---新页面[menu1-submenu5.html]

Menu2 --Submenu1 - --一个新页面 [menu2-submenu1.html]

Menu2 --Submenu2 - --一个新页面 [menu2-submenu2.html]

Menu2 --Submenu3 - --一个新页面 [menu2-submenu3.html]

.....................................

我该如何为此进行事件处理？

以下代码为我的任务提供了一个基本的 GUI-http://jsfiddle.net/aVkgp/198/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:12:50.803

如果为第二个菜单设置一组值，则可以在每次更改第一个菜单时动态“重置”第二个菜单：

```
var secondMenu = [
        '<option value="1-1">1</option><option value="1-2">3</option><option value="1-3">3</option>',
        '<option value="2-1">1</option><option value="2-2">3</option><option value="2-3">3</option>',
        '<option value="3-1">1</option><option value="3-2">3</option><option value="3-3">3</option>'
    ];
$('#select-choice-1').on("change", function(e){
    $("#select-choice-2").html(secondMenu[$(this).val()]).selectmenu('refresh');
}).trigger('change');//initialize for first-load​ 
```

这将第一个菜单中所选选项的值与第二个菜单中的内容相关联。

这是一个演示：http: [//jsfiddle.net/aVkgp/199/](http://jsfiddle.net/aVkgp/199/)

# javascript - jQuery .each 在 .tpl 中带有 Smarty 变量

> ID：13691082
> 
> 赞同：0
> 
> 时间：2012-12-03T20:25:25.540
> 
> 标签：javascript, jquery, smarty

我有一个带有以下 html 的页面，该页面使用不同的电话号码多次出现：

```
<div class="crm-content crm-contact_phone primary">
    <span>5555551212</span>
</div> 
```

电话号码本身使用 {$phone.i.phone} 形式的 smarty 变量显示，其中 i 是电话号码数组中的数组键。

我希望能够使用 js 更改这些电话号码的格式。

因此，对于一个电话号码，我在我的 smarty .tpl 文件中使用了以下内容：

```
{literal}
cj(function($){

  var phoneNumber = {/literal}{$phone.1.phone}{literal};

  var phoneNumberFormatted = '(' + phoneNumber.substr(0,3) + ') ' + phoneNumber.substr(3,3) + '-' + phoneNumber.substr(6);

  $(".crm-contact_phone span").text(phoneNumberFormatted);

});
{/literal} 
```

所以我想，我需要做一些事情：

```
$('.crm-contact_phone span').each(function(i, obj) {
    var phoneNumber = '' + {/literal}{$phone.1.phone}{literal};   
} 
```

但我不知道如何用 javascript 索引 i 替换 smarty 变量中的 1。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:26:59.703

尝试这个

```
$('.crm-contact_phone span').each(function(i, obj) {
      var phoneNumber = '' + {/literal}{$phone[i].phone}{literal}; 
} 
```

使用**括号 Notation**并将其替换为**i**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:25:01.187

最后我采取了不同的方法，使用以下方法将整个 smarty 数组保存到 js 数组中：

```
var phoneNumbers = {/literal}{$phone|@json_encode}{literal}; 
```

然后我可以使用纯js访问电话号码：

```
 var phoneNumber = phoneNumbers[i]['phone']; 
```

# ruby - QGraphicsScene 上的 qt-ruby 和自定义小部件

> ID：13691085
> 
> 赞同：3
> 
> 时间：2012-12-03T20:25:36.587
> 
> 标签：ruby, qt, qtruby

我正在使用 qt-ruby，我想使用 addWidget() 向 QGraphicsScene 添加一个小部件。作为回报，我得到一个 QGraphicsProxyWidget。

稍后，当用户单击 GraphicsScene 时，使用 itemAt() 查找被单击的 Widget。但是 itemAt() 返回一个 QGraphicsItem。

如何将 QGraphicsProxyWidget 与 QGraphicsItem 匹配？

我使用 qgraphicsitem_cast 在 C++ 中解决了这个问题，但这在 qt-ruby 中似乎不可用。

请帮忙！

# java - java正则表达式url解析

> ID：13691087
> 
> 赞同：0
> 
> 时间：2012-12-03T20:25:44.740
> 
> 标签：java, regex, parsing, url

> **可能重复：**
> [如何从给定的 url 中提取参数](https://stackoverflow.com/questions/5902090/how-to-extract-parameters-from-a-given-url)

我试图从这个 url 中的参数中检索数字：

`htt://tesing12/testds/fdsa?communityUuid=45352-32452-52`

我试过这个没有运气：

`^.*communityUuid=`

你能帮忙的话，我会很高兴。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:52:31.657

我建议不要使用简单的字符串操作路线。它更冗长，更容易出错。您不妨从内置类中获得一些帮助，然后利用您正在使用 URL（以“&”分隔的参数）的知识来指导您的实现：

```
String queryString = new URL("http://tesing12/testds/fdsa?communityUuid=45352-32452-52").getQuery();

String[] params = queryString.split("&");

String communityUuid = null;
for (String param : params) {
    if (param.startsWith("communityUuid=")) {
        communityUuid = param.substring(param.indexOf('=') + 1);
    }
}

if (communityUuid != null) {
    // do what you gotta do
} 
```

这使您可以检查 URL 的格式是否正确，并避免类似命名参数可能引起的问题（字符串操作路由将报告“abc_communityUuid”和“communityUuid”的值）。

此代码的一个有用扩展是在您迭代“参数”时构建一个映射，然后在映射中查询您想要的任何参数名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:28:30.763

我看不出有任何理由使用正则表达式。

我会这样做：

```
String token = "communityUuid=";
String url = "htt://tesing12/testds/fdsa?communityUuid=45352-32452-52";
int index = url.indexOf(token) + token.length();
String theNumbers = url.substring(index); 
```

笔记：

您可能还需要寻找下一个参数：

```
String token = "communityUuid=";
String url = "htt://tesing12/testds/fdsa?communityUuid=45352-32452-52";
int startIndex = url.indexOf(token) + token.length();
// here's where you might want to use a regex
String theNumbers = url.substring(startIndex).replaceAll("&.*$", ""); 
```

# c# - 实体框架绑定到 DataGrid wpf 麻烦

> ID：13691089
> 
> 赞同：0
> 
> 时间：2012-12-03T20:25:50.117
> 
> 标签：c#, wpf, entity-framework, wpfdatagrid

我使用实体连接到数据库： `Entity db = new Entity();` ...然后我将 DataGrid 添加到表单并尝试从我的数据库中接收表

```
var pp = from asd in db.ABONENT select asd;

MyDataGrid.ItemsSource = pp.ToList(); 
```

结果在这里： [截图](https://www.dropbox.com/s/bzkqe1ezkefcf05/Screen.jpg)

它显示其他链接表中的其他字段，为什么？如何仅显示 ABONENT 表中的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:35:09.447

我的猜测是您正在使用 DataGrid 来显示所有表格的内容。你的列定义是静态的还是动态加载的？

如果是动态的，我建议删除每个数据绑定之间的所有列。

如果它是静态的，请隐藏您不想显示的列（可见 = false）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:40:18.737

在实体框架中，您有`Entities`，而不是`Tables`. 实体框架将表的关系概念抽象为您在应用程序中使用的对象。这就是 ORM 的作用。

因此，表之间的关系在实体中表示为所谓的 a `Navigation Property`，它基本上是实体类中表示关联实体的属性。

我的观点是.. 如果您打算将表直接公开到 UI 中，为什么要使用 ORM？为此，请使用普通的旧 ADO.Net，或者以不直接向用户公开整个表的方式定义您的 UI。用户对表格一无所知。用户了解他们的业务。因此，您的应用程序应该对表一无所知。

从用户体验的角度来看，我认为这是一种不好的做法，例如，为什么用户应该在他们的 UI 中看到诸如 abonentID 和 RegionID 之类的 Id 列？他们不关心这一点，也不理解这一点。行 ID 是 RDBMS 概念，而不是业务概念。

我的建议：重新考虑您的方法：要么回退到使用普通的旧 ADO.Net，要么`AutoGenerateColumns`在 DataGrid 中将 设置为 false 并仅公开用户关心的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T22:43:38.973

您可以使用以下语法选择实体的公开属性：

```
var pp = from asd in db.Products
            select new
            {
                asd.Id,
                asd.Name,
                ProductCategory = asd.ProductCategory.Name,
            };
MyDataGrid.ItemsSource = pp.ToList(); 
```

# haskell - 修复性能与列表

> ID：13691091
> 
> 赞同：4
> 
> 时间：2012-12-03T20:25:52.847
> 
> 标签：haskell, ghc, repa

在 Numeric Haskell Repa Tutorial [Wiki](http://www.haskell.org/haskellwiki/Numeric_Haskell:_A_Repa_Tutorial)中，有一段内容如下（上下文）：

> 10.1 Fusion，以及为什么需要它
> 
> Repa 严重依赖数组融合来实现快速代码。Fusion 是 GHC 在编译程序时执行的内联和代码转换组合的一个奇特名称。融合过程将 Repa 库中定义的数组填充循环与您在自己的模块中编写的“worker”函数合并。如果融合过程失败，那么生成的程序将比它需要的慢得多，通常比使用普通 Haskell 列表的等效程序慢 10 倍。另一方面，如果融合工作正常，生成的代码将与等效的干净编写的 C 程序一样快地运行。一旦你了解了发生了什么，使融合工作并不难。

我不明白的部分是这样的：

> “如果融合过程失败，那么生成的程序将比它需要的慢得多，通常比使用普通 Haskell 列表的等效程序慢 10 倍。”

我明白为什么如果流融合失败它会运行得更慢，但为什么它的运行速度比列表慢得多？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-03T20:39:20.373

通常，因为列表是惰性的，而 Repa 数组是严格的。

如果您未能融合惰性列表遍历，例如

```
map f . map g 
```

您为将中间（惰性）cons 单元留在那里而支付每个值的*O(1)成本。*

如果您未能在严格序列上融合相同的遍历，则您为分配严格的中间数组每个值至少支付*O(n) 。*

此外，由于 fusion 将您的代码破坏为无法识别的`Stream`数据类型，为了改进分析，您可能会留下具有太多构造函数和其他开销的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:39:59.337

编辑：这是不正确的——请参阅 Don Nelson 的评论（以及他的回答——他对图书馆的了解比我多得多）。

不可变数组不能共享组件；不考虑融合，对不可变数组的任何修改都必须重新分配整个数组。相比之下，虽然列表操作是非破坏性的，但它们可以共享部分：`f i (h:t) = i:t`例如，通过创建一个新列表以恒定时间替换列表的头部，其中第一个单元格指向原始列表的第二个单元格。此外，由于列表可以增量构建，因此通过重复调用函数来构建列表的生成器等函数仍然可以在 O(n) 时间内运行，而在没有融合的不可变数组上的等效函数需要重新分配数组每次调用函数，花费 O(n^2) 时间。

# java - SQLGrammarException: 没有为带有条件的参数 1 指定值

> ID：13691094
> 
> 赞同：0
> 
> 时间：2012-12-03T20:26:01.600
> 
> 标签：java, hibernate, hql

1-1关联：

```
@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL, mappedBy = "messageDetails")
public MessageEntry getMessageEntry() {
    return messageEntry;
}

@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
public MessageDetails getMessageDetails() {
    return messageDetails;
} 
```

想要在无状态会话中加载依赖项：

```
 MessageDetails messageDetails =
            (MessageDetails) sess.createCriteria(MessageDetails.class)
                    .add(Restrictions.eq("messageEntry", messageEntry))
            .uniqueResult(); 
```

我明白了

```
Exception in thread "main" org.hibernate.exception.SQLGrammarException: No value specified for parameter 1
    at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:122)
    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49) 
```

SQL 不是我想要的。可能是我不明白什么？

```
03:21:13,274 DEBUG SQL:104 - /* criteria query */ select this_.id as id11_0_, this_.date as date11_0_, this_.messageId as messageId11_0_, this_.replyTo as replyTo11_0_, this_.subject as subject11_0_ from MessageDetails this_ where this_.id=? 
```

我想通过其属性 messageEntry 选择 MessageDetails，这不可能吗？谢谢。

# c++ - 将结构数组传递给c ++中的函数

> ID：13691095
> 
> 赞同：-2
> 
> 时间：2012-12-03T20:26:03.963
> 
> 标签：c++, arrays, visual-studio-2010, struct

我已经编写了一个运行正常的程序。我需要把它分解成函数。我有 3 个结构数组。我想做一个从文件中读取信息并将其回显的函数。我只需要一个关于如何通过它的例子。我会发布我的代码，但我不希望其他学生接受它。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:30:49.280

If you are using C arrays:

```
struct A { int v; }
A data[10];

void func(A *array, size_t n) {
}

func(data, 10); 
```

Or if you are using a vector:

```
std::vector<A> vec;

void func(std::vector<A>& array) {
}

func(vec); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:32:09.840

由于您将其标记为“C++”，因此我假设您使用的是向量（:-)）

```
void f1 ( yourVector& yourVector )
{
  // do something with the vector as read-write (for example fill the vector with somthing).
}

void f2 ( const yourVector& yourVector )
{
  // do something with the vector as read-only.
}

int main()
{
  std::vector <yourStruct> yourVector;
  f1( yourVector );
  f2( yourVector );
  return 0;
} 
```

# php - 注意：未定义的偏移量：0 in...（本地主机和 PHP）

> ID：13691099
> 
> 赞同：0
> 
> 时间：2012-12-03T20:26:14.550
> 
> 标签：php, localhost

我在 localhost 中的代码有问题，我使用 wampserver。

我没有找到错误和解决方案。

错误如下：

> 注意：未定义的偏移量：第 74 行 C:\wamp\www\Test.php 中的 0

```
$html = curl_exec($ch);
[...]
preg_match_all("(<title>(.*)<\/title>)siU", $html, $title);
$metas = get_meta_tags($url, 1);
/* Line 74 */ $title = $title[1][0];
$titulo = html_entity_decode("$title", ENT_QUOTES, 'UTF-8');
$descripcion = isset($metas["description"])?$metas["description"] : '';
$keywords = isset($metas["keywords"])?$metas["keywords"] : ''; 
```

他们怎么能解决？

问候和感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T03:50:25.570

我知道这不是你的问题，但据我所知，我认为这是最好的解决方案：

```
<?php

//If yout allow_url_fopen is off, use CURL
$html = file_get_contents("http://example.com/"); 

//Parse html to object
$doc = new DOMDocument();
@$doc->loadHTML($html); //To prevent some html errors

//Page title
$titles = $doc->getElementsByTagName('title');
$title = $titles->item(0)->nodeValue;

//Meta tags
$metas = $doc->getElementsByTagName('meta');

//For each meta tag
for ($i = 0; $i < $metas->length; $i++) {

    $meta = $metas->item($i);

    //Check if description or keywords
    if($meta->getAttribute('name') == 'description')
        $description = $meta->getAttribute('content');
    else if($meta->getAttribute('name') == 'keywords')
        $keywords = $meta->getAttribute('content');
}

echo 'Title: '.$title;
echo 'Description: '.$description ;
echo 'Keywords: '.$keywords;

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T03:23:19.587

`$title = $title[0][1][0];`就是你要找的。

# php - PHP中的Mysql Union没有返回正确的结果

> ID：13691105
> 
> 赞同：0
> 
> 时间：2012-12-03T20:26:39.400
> 
> 标签：php, mysql, union

我目前有一个 mysql Union 查询，当通过命令行、PHP MyAdmin 直接放入 mysql 或在 Mysql 编辑器（如 Mysql Workbench）中运行时，它可以工作。当我通过我的 PHP 类运行查询时，它返回两个重复的行。

查询：

```
SELECT `n`.`draftrd`, `n`.`draftteam`, `n`.`nflteam`, `nt`.`logo`, 
    `nt`.`name`, `nt`.`nflcity`,
    `p`.`class`, `p`.`first_name`, `p`.`last_name`
FROM `players` as `p` 
LEFT JOIN `nfl` as `n` ON `p`.`playerid` = `n`.`playerid`
LEFT JOIN `nflteams` as `nt` ON `n`.`nflteam` = `nt`.`nflid` 
WHERE `n`.`playerid` = 2007000001
UNION
SELECT `n`.`draftrd` as `draftRd`, `n`.`draftteam` as `draftTm`, `n`.`nflteam`, 
    `nt`.`logo`, 
    `nt`.`name` as `draftName`, `nt`.`nflcity` as `draftCity`, `p`.`class`, 
    `p`.`first_name`, `p`.`last_name`
FROM `players` as `p` 
LEFT JOIN `nfl` as `n` ON `p`.`playerid` = `n`.`playerid`
LEFT JOIN `nflteams` as `nt` ON `n`.`draftteam` = `nt`.`nflid` 
WHERE `n`.`playerid` = 2007000001 
```

在编辑器中它返回：

```
+---------+-----------+---------+-------------+---------+----------+-------+------------+-----------+---------+
| draftrd | draftteam | nflteam | logo        | name    | nflcity  | class | first_name | last_name | tableid |
+---------+-----------+---------+-------------+---------+----------+-------+------------+-----------+---------+
| 2       | 2         | 12      | giants.png  | Giants  | New York | 2007  | Martellus  | Bennett   |       1 |
| 2       | 2         | 12      | cowboys.png | Cowboys | Dallas   | 2007  | Martellus  | Bennett   |       1 |
+---------+-----------+---------+-------------+---------+----------+-------+------------+-----------+---------+
2 rows in set (0.00 sec) 
```

PHP 返回是：（var_dump 版本）

```
array(18) { 
    [0]=> string(1) "2" 
    ["draftrd"]=> string(1) "2" 
    [1]=> string(1) "2" 
    ["draftteam"]=> string(1) "2"
    [2]=> string(2) "12" 
    ["nflteam"]=> string(2) "12" 
    [3]=> string(10) "giants.png" 
    ["logo"]=> string(10) "giants.png" 
    [4]=> string(6) "Giants" 
    ["name"]=> string(6) "Giants" 
    [5]=> string(8) "New York" 
    ["nflcity"]=> string(8) "New York" 
    [6]=> string(4) "2007" 
    ["class"]=> string(4) "2007"
    [7]=> string(9) "Martellus"
    ["first_name"]=> string(9) "Martellus"
    [8]=> string(7) "Bennett" 
    ["last_name"]=> string(7) "Bennett" 
} 
```

我不确定问题是什么以及为什么它不能正常工作。我尝试创建一个临时表并将查询存储在其中，但它仍然给了我重复的行。有没有更简单的方法来做到这一点或解释为什么会发生这种情况？我已经在 PHP 中转储了查询，以查看问题是否与它的构造有关，但是转储的查询在命令行上运行时返回了我正在寻找的行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:01:01.943

PHP 中的 MySQL 句柄允许您以不同的方式遍历结果数组。例如，您可以选择按键遍历关联数组（例如`echo $result['draftteam'];`：），或者您可以按索引遍历普通数组（例如：）`echo $result[2];`。

当您使用该`fetch_array()`命令时，默认情况下，您会同时获取两种类型。这将产生您提供的数组。

如果您尝试根据查询创建一个动态表（即：在将每个列名写入 a中，然后`<th>`将其内容清空到下面的`<td>`s 中），那么您应该使用`fetch_assoc()`命令，而不是`fetch_array()`命令。这只会返回数组中的文本键。

```
while($arr = mysqli_fetch_assoc($sql)) {
    foreach($arr as $key => $value){
        echo $key .' => '. $value .'<br />'."\n";
    }
} 
```

[http://php.net/manual/en/mysqli-result.fetch-assoc.php](http://php.net/manual/en/mysqli-result.fetch-assoc.php)

[http://php.net/manual/en/mysqli-result.fetch-array.php](http://php.net/manual/en/mysqli-result.fetch-array.php)

# ruby-on-rails - Rails：简单的单元测试不在终端中执行

> ID：13691106
> 
> 赞同：1
> 
> 时间：2012-12-03T20:26:41.513
> 
> 标签：ruby-on-rails

嗨，我正在尝试学习测试，但我的单元测试不起作用。所以我有一个用户模型（以及其他模型，但还没有开始测试它们）：

```
class Users < ActiveRecord::Base
  attr_accessible :age, :gender, :name

  has_many :sent_messages, :class => "Messages", :foreign_key => 'sender_id'
  has_many :received_messages, :class => "Messages", :foreign_key => 'receiver_id'

  belongs_to :location
  belongs_to :language

  before_save { |user| if user.new_record? then create_remember_token end }

    private

        def create_remember_token
            self.remember_token = SecureRandom.urlsafe_base64
        end

end 
```

和一个 test/unit/users_test.rb

```
require 'test_helper'

class UsersTest < ActiveSupport::TestCase
  test "user is created" do
    user = User.create!(:name => "Edmund")
    assert_equal user, User.first
  end
end 
```

但是当我跑步时，`rake test:units`我得到：

```
Edmunds-MacBook-Pro:langexchange edmundmai$ rake test:units
NOTICE:  CREATE TABLE will create implicit sequence "languages_id_seq" for serial column "languages.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "languages_pkey" for table "languages"
NOTICE:  CREATE TABLE will create implicit sequence "locations_id_seq" for serial column "locations.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "locations_pkey" for table "locations"
NOTICE:  CREATE TABLE will create implicit sequence "messages_id_seq" for serial column "messages.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "messages_pkey" for table "messages"
NOTICE:  CREATE TABLE will create implicit sequence "users_id_seq" for serial column "users.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "users_pkey" for table "users"
/Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/core_ext/hash/keys.rb:51:in `block in assert_valid_keys': Unknown key: class (ArgumentError)
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/core_ext/hash/keys.rb:50:in `each_key'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/core_ext/hash/keys.rb:50:in `assert_valid_keys'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/associations/builder/association.rb:33:in `validate_options'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/associations/builder/association.rb:24:in `build'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/autosave_association.rb:139:in `build'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/associations/builder/belongs_to.rb:14:in `build'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/associations/builder/association.rb:12:in `build'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activerecord-3.2.8/lib/active_record/associations.rb:1428:in `belongs_to'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/app/models/messages.rb:4:in `<class:Messages>'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/app/models/messages.rb:1:in `<top (required)>'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in <module:Finisher>'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/config/environment.rb:5:in `<top (required)>'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/test/test_helper.rb:2:in `require'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/test/test_helper.rb:2:in `<top (required)>'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/test/unit/helpers/home_helper_test.rb:1:in `require'
    from /Users/edmundmai/Desktop/Class/Ruby/langexchange/test/unit/helpers/home_helper_test.rb:1:in `<top (required)>'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:10:in `require'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:10:in `block (2 levels) in <main>'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:9:in `each'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:9:in `block in <main>'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:4:in `select'
    from /Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb:4:in `<main>'
rake aborted!
Command failed with status (1): [ruby -I"lib:test" -I"/Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib" "/Users/edmundmai/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/rake-10.0.2/lib/rake/rake_test_loader.rb" "test/unit/**/*_test.rb" ]
Tasks: TOP => test:units
(See full trace by running task with --trace) 
```

这怎么可能？？有人可以帮忙吗？我还没有写任何其他测试，所以我不知道它是如何发疯的

更新消息模型：

```
class Messages < ActiveRecord::Base
  attr_accessible :content, :read

  belongs_to :sender, :class => "User", :foreign_key => 'sender_id'
  belongs_to :receiver, :class => "User", :foreign_key => 'receiver_id'
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:47:56.913

在您使用的用户模型中

```
has_many :sent_messages, :class => "Messages", :foreign_key => 'sender_id'
has_many :received_messages, :class => "Messages", :foreign_key => 'receiver_id' 
```

你应该使用：

```
has_many :sent_messages, :class_name => "Messages", :foreign_key => 'sender_id'
has_many :received_messages, :class_name => "Messages", :foreign_key => 'receiver_id' 
```

（切换`:class`到`:class_name`）

* * *

在关联中，没有`:class`选项之类的东西。你想要的是`:class_name`选项。（您将不得不更改使用此功能的任何模型。）

[http://guides.rubyonrails.org/association_basics.html#has_many-association-reference](http://guides.rubyonrails.org/association_basics.html#has_many-association-reference)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:35:59.493

从该堆栈跟踪中，您的`Messages`模型中似乎有错误。如果您更正了该错误，则它应该可以正确运行。

# c - C - 同时使用 open() 和 fdopen() 时关闭文件的正确方法

> ID：13691107
> 
> 赞同：8
> 
> 时间：2012-12-03T20:26:57.600
> 
> 标签：c, unix, file-io, memory-leaks

所以我正在用 C 构建一个 Unix minishell，并正在实现输入、输出和错误重定向，并且遇到了文件问题。我在找到重定向运算符的循环中打开我的文件，并使用 open()，它返回一个 fd。然后我相应地分配孩子的 fd，并调用执行函数。

当我的 shell 只是出去寻找程序并使用 execvp() 执行它们时，我没有太多问题。唯一的问题是在提示输入下一个命令行之前，我是否需要在文件描述符上调用 close()。我担心 fd 泄漏，但不完全了解它是如何工作的。

使用内置命令时出现了我真正的问题。我有一个名为“read”的内置命令，它接受一个参数，一个环境变量名称（可能是一个尚不存在的）。Read 然后提示输入一个值，并将该值分配给变量。这是一个例子：

```
% read TESTVAR
test value test value test value
% echo  ${TESTVAR}
test value test value test value 
```

好吧，可以说我尝试这样的事情：

```
% echo here's another test value > f1
% read TESTVAR < f1
% echo  ${TESTVAR}
here's another test value 
```

这很好用，请记住 read 在父进程内执行，我不使用 execvp 调用 read，因为它是内置的。读取使用gets，它需要一个流变量，而不是fd。因此，在 irc 论坛上闲逛了一下之后，我被告知使用 fdopen，从文件描述符中获取流。所以在调用 get 之前，我调用：

```
rdStream = fdopen(inFD, "r"); 
```

然后打电话

```
if(fgets(buffer, envValLen, rdStream) != buffer) 
{
    if(inFD) fclose(rdStream);
    return -1;
}
if(inFD) fclose(rdStream); 
```

如您所见，目前我正在使用 fclose() 关闭流，除非它等于标准输入（即 0）。这是必要的吗？我需要关闭流吗？还是只是文件描述符？或两者？我很困惑我应该关闭哪个，因为它们都以不同的方式引用同一个文件。目前我没有关闭 fd，但我认为我绝对应该。我只是希望有人帮助确保我的 shell 没有泄漏任何文件，因为我希望它能够在单个会话中执行数千个命令而不会泄漏内存。

谢谢，如果你们想让我发布更多代码，请询问。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-03T20:30:04.133

The [standard](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fclose.html) says:

> The fclose() function **shall perform the equivalent of a `close()`** on the file descriptor that is associated with the stream pointed to by stream.

So calling `fclose` is enough; it will also close the descriptor.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:41:37.400

`FILE`是标准 C 库中的缓冲对象。当你这样做时`fclose`（标准 C 函数），它最终会调用`close`（Unix 系统函数），但只有在确保 C 库缓冲区被刷新之后。所以，我想说，如果你使用`fopen`然后`fwrite`你应该使用`fclose`，而不仅仅是`close`，否则你可能会丢失一些数据。

# validation - 淘汰赛验证在加载时立即评估

> ID：13691109
> 
> 赞同：21
> 
> 时间：2012-12-03T20:27:04.170
> 
> 标签：validation, knockout.js, knockout-validation

我正在使用 MVC、Knockout 和 Knockout Validation 来验证我的视图模型。

我遇到了一个问题，即视图模型属性的验证在加载时立即触发。换句话说，在用户尝试更改其值之前，我的输入旁边会显示“此字段是必需的”。

这个问题特别发生在下拉（选择）控件上。

我猜这是我通过在我的 javascript 代码的另一部分中以某种方式无意更改/访问/变异 observable 造成的问题。但是，我不知道如何追踪这一点。

有没有一种方法可以让我以某种方式订阅或跟踪导致 Knockout Validation 中验证的触发事件？我只需要知道为什么会这样。我非常有信心 isValid() 函数的值始终是错误的。

这是我的 HTML 在页面加载时如何设置的示例，不受干扰：

```
<select class="highlightable validationElement" name="obsstate" data-bind="value: standardAnswers.ans106_1.value" required="true">
    <option value="">-- Select -- </option>
        <option value="AK">AK</option>
        <option value="AL">AL</option>
        etc...

</select> 
```

![显示在我的本地机器上](../Images/a7f7b34e7dfbe47867a79b64c2dea912.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-11-06T09:42:42.660

在为视图模型应用绑定之后。然后为该视图模型制作`showAllMessages`为`false`

**例子**

```
YourViewmodelname.errors.showAllMessages(false); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-22T12:39:04.513

引用 KO 页面.... ( [http://knockoutjs.com/documentation/options-binding.html](http://knockoutjs.com/documentation/options-binding.html) )

KO 将在项目列表前面加上一个显示文本“选择一个项目...”并且其值未定义的项目。因此，如果 myChosenValue 的值是 undefined（默认情况下 observables 会这样做），那么将选择 dummy 选项。如果 optionsCaption 参数是一个 observable，那么初始项的文本将随着 observable 值的变化而更新。

因此，我通过在定义属性时设置“未定义”来解决它，请参见下面的示例：

```
self.myProperty = ko.observable(undefined).extend({
    required :  {"Field Required"}
}); 
```

希望这可以帮助...

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-04T00:42:41.387

我自己想出了这个问题。

剃刀引擎模板化选择选项，然后将选定元素的值绑定到 Knockout 之间存在问题。

尽管选择框中没有用户输入的值，但默认值“--select--”实际上包含一个值。就我而言，它是一个空字符串。因此，当我应用淘汰绑定时，我的 viewmodel 属性被“更新”为空字符串值，因此触发了验证。

为了解决这个问题，我将模型的默认值设置为空字符串。因此，当应用绑定时，不会在 Knockout observable 上触发 valueHasMutated 事件，因此不会进行验证。

# javascript - JQuery POST 到 Spring MVC 控制器并解析结果成功功能

> ID：13691112
> 
> 赞同：0
> 
> 时间：2012-12-03T20:27:11.823
> 
> 标签：javascript, jquery, ajax, spring, spring-mvc

我已将 jQuery 集成到 Spring MVC 应用程序中。我的 JSP 页面上有一个表单，我正在执行 ajax POST 以将表单发送到控制器：

```
$("#myform").submit(function() {
                    $.ajax({
                        type : 'POST',
                        url : '/MyApp/search/searchResults',
                        data : $(this).serialize(),
                        dataType: 'html',
                        success : function(data) {
                            $("#tabs-4").append(data);
                        }
                    });
                    return false;
                }); 
```

成功函数会将数据加载到新选项卡中。我发现`data`返回的是我的原始页面的 HTML（我从中提交）。相反，我希望能够解析从控制器返回的 ModelAndView 对象。例如：

```
${searchResults.searchStr} 
```

`data`返回页面HTML是否正常？无论如何，我可以在成功函数中解析 ModelAndView 对象，然后将其传递给我的新选项卡 div 吗？

这是我的控制器代码：

```
@RequestMapping(value = "/searchResults", method = RequestMethod.POST)
public ModelAndView searchResults(
        @ModelAttribute(value = "search") SearchVO search,
        BindingResult result) {

    // Set the view and search object
    ModelAndView mv = new ModelAndView("newSearch");
    mv.addObject("searchResults", searchResults);

    return mv;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T05:47:14.960

是的，您可以将 html 内容从控制器返回到您的 ajax 函数。如果您有兴趣在 jsp 中使用该实例，则必须将其序列化为 json 并发送。使用 jquery 你可以在 jsp 上渲染它。例如，

```
//Controller
public @ResponseBody<Class_name> search(...){
     return searchResults;
}

//jsp

function renderResult(){
   $.ajax({
    url:'url',
    dataType:'json',
    ...
    ..
    success: function(data, status, xhr){
       $.each(data, function(k, v){
       $('#my_div').append(...k,v...);
}
}
});
} 
```

查看您的要求，我建议您使用返回 html 本身的第一种方法，并且您返回的 jsp 页面可以使用 searchResults 呈现。

# javascript - Chrome 打包的应用程序 UDP 套接字不起作用

> ID：13691119
> 
> 赞同：1
> 
> 时间：2012-12-03T20:27:22.450
> 
> 标签：javascript, sockets, google-chrome, google-chrome-extension, google-chrome-app

我正在尝试使用 Chrome Canary（当前版本 25）让 UDP 套接字适用于打包的应用程序。我对此处的[UDP 示例与此处的](http://developer.chrome.com/apps/app_network.html)[参考文档](http://developer.chrome.com/apps/socket.html)冲突这一事实感到非常困惑。

官方示例使用这一行：

```
chrome.socket.create('udp', '127.0.0.1', 1337, { onEvent: handleDataEvent }, ... 
```

在 Canary 中使用此行会导致错误：

> 未捕获的错误：调用表单 socket.create(string, string, integer, object, function) 与定义 socket.create(string type, optional object options, function callback) 不匹配

这并不奇怪，因为这与函数的文档形式相匹配。（我猜这个例子已经过时了？）好的，所以我试试这个......

```
chrome.socket.create('udp', { onEvent: handleDataEvent }, ... 
```

金丝雀抱怨：

> 未捕获的错误：参数 2 的值无效。属性“onEvent”：意外属性。

现在我很困惑，特别是因为这个参数[在参考文献](http://developer.chrome.com/apps/socket.html#type-CreateOptions)中没有记录。所以我只是这样做：

```
chrome.socket.create('udp', {}, ... 
```

现在它创建好了，但是下面的调用`connect`...

```
chrome.socket.connect(socketId, function(result) ... 
```

...失败了：

> 未捕获的错误：调用表单 socket.connect(integer, function) 与定义 socket.connect(integer socketId, string hostname, integer port, function callback) 不匹配

...这并不奇怪，因为现在我的代码没有在任何地方提到主机或端口，所以我想它需要在`connect`. 所以我将其更改为以下形式：

```
chrome.socket.connect(socketId, address, port, function (result) ... 
```

最后我可以连接并写入套接字了。但这不包括阅读。

*   有人可以向我展示一个可以发送和接收的基于 UDP 的工作示例，以便我可以使用它吗？
*   由于示例的 onEvent 处理程序不起作用，我如何接收数据？我如何确保在数据到达后立即按需接收数据而不会阻塞？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-04T04:57:02.667

The Network Communications doc is not up-to-date. See the latest API doc: [https://developer.chrome.com/trunk/apps/socket.html](https://developer.chrome.com/trunk/apps/socket.html). But the doc doesn't state everything clearly. I looked into Chromium source code and found some useful comments here: [https://code.google.com/searchframe#OAMlx_jo-ck/src/net/udp/udp_socket.h&q=file:(%5E%7C/)net/udp/udp_socket%5C.h$&exact_package=chromium](https://code.google.com/searchframe#OAMlx_jo-ck/src/net/udp/udp_socket.h&q=file%3a%28%5E%7C/%29net/udp/udp_socket%5C.h%24&exact_package=chromium)

```
// Client form:
// In this case, we're connecting to a specific server, so the client will
// usually use:
//       Connect(address)    // Connect to a UDP server
//       Read/Write          // Reads/Writes all go to a single destination
//
// Server form:
// In this case, we want to read/write to many clients which are connecting
// to this server.  First the server 'binds' to an addres, then we read from
// clients and write responses to them.
// Example:
//       Bind(address/port)  // Binds to port for reading from clients
//       RecvFrom/SendTo     // Each read can come from a different client
//                           // Writes need to be directed to a specific
//                           // address. 
```

For the server UDP socket, call `chrome.socket.bind` and `chrome.socket.recvFrom`/`chrome.socket.sendTo` to interact with clients. For the client UDP socket, call `chrome.socket.connect` and `chrome.socket.read`/`chrome.socket.write` to interact with the server.

Here's an example:

```
var serverSocket;
var clientSocket;

// From https://developer.chrome.com/trunk/apps/app_hardware.html
var str2ab=function(str) {
  var buf=new ArrayBuffer(str.length);
  var bufView=new Uint8Array(buf);
  for (var i=0; i<str.length; i++) {
    bufView[i]=str.charCodeAt(i);
  }
  return buf;
}

// From https://developer.chrome.com/trunk/apps/app_hardware.html
var ab2str=function(buf) {
  return String.fromCharCode.apply(null, new Uint8Array(buf));
};

// Server
chrome.socket.create('udp', null, function(createInfo){
    serverSocket = createInfo.socketId;

    chrome.socket.bind(serverSocket, '127.0.0.1', 1345, function(result){
        console.log('chrome.socket.bind: result = ' + result.toString());
    });

    function read()
    {
        chrome.socket.recvFrom(serverSocket, 1024, function(recvFromInfo){
            console.log('Server: recvFromInfo: ', recvFromInfo, 'Message: ', 
                ab2str(recvFromInfo.data));
            if(recvFromInfo.resultCode >= 0)
            {
                chrome.socket.sendTo(serverSocket, 
                    str2ab('Received message from client ' + recvFromInfo.address + 
                    ':' + recvFromInfo.port.toString() + ': ' + 
                    ab2str(recvFromInfo.data)), 
                    recvFromInfo.address, recvFromInfo.port, function(){});
                read();
            }
            else
                console.error('Server read error!');
        });
    }

    read();
});

// A client
chrome.socket.create('udp', null, function(createInfo){
    clientSocket = createInfo.socketId;

    chrome.socket.connect(clientSocket, '127.0.0.1', 1345, function(result){
        console.log('chrome.socket.connect: result = ' + result.toString());
    });

    chrome.socket.write(clientSocket, str2ab('Hello server!'), function(writeInfo){
        console.log('writeInfo: ' + writeInfo.bytesWritten + 
            'byte(s) written.');
    });

    chrome.socket.read(clientSocket, 1024, function(readInfo){
        console.log('Client: received response: ' + ab2str(readInfo.data), readInfo);
    });
}); 
```

# limit - Piglatin 限制和展平会产生错误的结果

> ID：13691123
> 
> 赞同：0
> 
> 时间：2012-12-03T20:27:28.067
> 
> 标签：limit, apache-pig, flatten

```
B = GROUP A BY state;
C = FOREACH B {                          
   DA = ORDER A BY population DESC;                
   DB = LIMIT DA 5;                         
   GENERATE FLATTEN(group), FLATTEN(DB.name), FLATTEN(DB.population);
} 
```

问题是我得到了 5 次而不是 1 次城市的名称。我得到如下信息：

```
(ALASKA,M,27257)
(ALASKA,M,23696)
(ALASKA,M,19949)
(ALASKA,M,19926)
(ALASKA,M,19833)
(ALASKA,H,27257)
(ALASKA,H,23696)
(ALASKA,H,19949)
(ALASKA,H,19926)
(ALASKA,H,19833) 
```

我需要的输出是：

```
(ALASKA,M,27257)
(ALASKA,H,23696) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:21:06.020

2个展平：展平（DB.name），展平（DB.population）；在 2 个袋子之间造成 Cartezian 产品，用一个替换它

```
B = GROUP A BY state;
C = FOREACH B {                          
   DA = ORDER A BY population DESC;                
   DB = LIMIT DA 5;                         
   GENERATE FLATTEN(group), FLATTEN(DB.(name, population));
} 
```

或者当 GROUP BY 创建的包携带所有原始元组和所有列时，您可以这样做：

```
B = GROUP A BY state;
C = FOREACH B {                          
   DA = ORDER A BY population DESC;                
   DB = LIMIT DA 5;                         
   GENERATE FLATTEN(DB);
} 
```

# html - 如何使用带有 OR 文本的垂直条分割两个文本框？

> ID：13691126
> 
> 赞同：1
> 
> 时间：2012-12-03T20:27:33.293
> 
> 标签：html, css

我有两个文本框：

```
<label class="q">A<input maxlength="9" /></label> 
```

和

```
<label class="q">B<input maxlength="9" /></label> 
```

我想用一条垂直线分割这两个框，在这条线的中心，有一个“OR”文本。

这个想法是为了让用户清楚地知道在任何一个文本框中输入都可以。

我尝试使用`float:left`and`float:right`分隔两个区域并`border-left: 1px solid gray`用作分隔符，但是如何在垂直线的中间显示文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:40:09.410

如果没有某种图像，很难说出你在追求什么，但你可以试试这个：

```
/* Target the pseudo-element :before on any label that follows another label */
label + label:before {
    content: "OR";
    color: red;
    padding: 0 10px;
    background-size: 1px 100%;
    background-repeat: no-repeat;
    background-position: center center;
    background-image: -webkit-linear-gradient(0, #000, #000);
    background-image: -moz-linear-gradient(0, #000, #000);
    background-image: -ms-linear-gradient(0, #000, #000);
    background-image: -o-linear-gradient(0, #000, #000);
    background-image: linear-gradient(0, #000, #000);
} 
```

小提琴：http: [//jsfiddle.net/5WrJu/](http://jsfiddle.net/5WrJu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:42:25.090

一种方法是在它们之间插入一个元素，并在其中放置 OR 和垂直线。

演示在[http://jsfiddle.net/gaby/4hCUq/1/](http://jsfiddle.net/gaby/4hCUq/1/)

* * *

另一种方法是仅使用 CSS（*通过使用伪元素，例如`:before`并`:after`插入行和文本*）

**HTML**

```
<label class="q">A<input maxlength="9" /></label>
<label class="q or">B<input maxlength="9" /></label> 
```

**CSS**

```
.q{
    float:left;
    margin-left:50px;
    width:150px;
    position:relative;
}
.or:before{
    content:' ';
    width:1px;
    height:150%;
    top:-25%;
    background-color:black;
    left:-25px;
    position:absolute;
    z-index:100;

}
.or:after{
    content:'OR';
    left:-50px;
    position:absolute;
    z-index:101;
    background-color:white;
    font-size:smaller;
    top:2px;
    text-align:center;
    width:50px;
} 
```

**CSS 演示在** [http://jsfiddle.net/gaby/4hCUq/](http://jsfiddle.net/gaby/4hCUq/)

# php - 遇到 PHP 类和 MySQL 插入/更新问题

> ID：13691133
> 
> 赞同：0
> 
> 时间：2012-12-03T20:28:16.697
> 
> 标签：php, mysql

我在通过 PHP 类更新 MySQL 数据库时遇到了一些麻烦（这是我第一次真正涉足 PHP 类，所以我可能会遗漏一些非常基本的元素）。我已经包含了与我遇到的问题相关的代码（即没有正确更新 MySQL 表）。

为了快速解释我的代码，我在构造对象时从数据库中提取用户信息。然后，我调用该函数`modify_column()`从我提取的数据中增加或减少一个数值。最后，我运行`save()`更新 MySQL 表。

我有两个问题：（1）`$this->info`没有被修改函数正确更新（例如，如果 I `modify_column('age', '1')`，一个 var_dump 显示`age int(3)`而不是`age string(2) = 10`（假设原始年龄是​​ 9 岁）。和（2），更新查询不起作用.我假设这是因为我有一个源自第一个问题的大小不正确的变量。

代码片段（我的数据库函数基于 PDO 包装器，它们一直工作得很好）：

```
class user {

    public $id;

    public function __construct($id) {

        global $db;

        /* pull the user's information from the database */
        $bind = array(':id' => $id);
        $result = $db->select('user', 'id = :id', $bind, '*', SQL_SINGLE_ROW);

        $this->id = $result['id'];
        $this->info = $result;
    }

    /*
     * Update the user's MySQL table, thereby saving the data.
     */
    public function save() {

        global $db;

        $bind = array($this->id);
        $db->update('users', $this->info, 'id = ?', $bind);

    }

    public function modify_column($column, $amount) {
        $this->info[$column] += $amount;
    }
} 
```

另外，请让我知道是否有一种更简洁的方法来完成我想要完成的工作（即使用类函数快速修改表中的数值。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:48:32.887

您似乎没有任何输入变量的规定。当您将数据添加到`$this->info`所有值时，将被设置为字符串。您不想对字符串进行增量数学（即`+=`等`-=`）。您需要将这些值转换为整数。我建议添加一个具有类属性及其类型数组的类属性。然后，您将能够在设置`$info`数组时根据它们的类型转换所有值。

所以像这样

```
protected $fields = array(
    'age' => 'integer',
    'name' => 'string',
    // etc.
} 
```

然后你可以添加这样的功能

```
protected function type_cast(&$value, $key) {
    // field type to use
    $type = $this->fields[$key];
    if ($type === 'integer') {
        $value = (integer)$value;
    } else if ($type === 'string') {
        $value =  (string)$value;
    } // etc.
} 
```

在您的构造函数中，只需遍历`$result`函数`type_cast`：

```
array_walk(&$result, array($this, 'type_cast'));
$this->info = $result; 
```

如果您在数据库中使用整数，您可能还需要确保将您的 id 值转换为整数。

我不确定你的数据库抽象是如何工作的，所以很难说出发生了什么。我建议回显查询本身并针对数据库进行尝试，或者查看返回的 MySQL 错误以了解那里出了什么问题。

# android - mediaplayer start() on button click issue

> ID：13691135
> 
> 赞同：0
> 
> 时间：2012-12-03T20:28:21.950
> 
> 标签：android, arrays, random, media-player

I have created an array of sounds that is randomly accessed to play via MediaPlayer when a button is pressed - this works fine my only issue is that when testing it and pressing the button rapidly the sound would stop and not play anymore - is there some way I can implement a start stop thing? I tried beginning my onClick method with a butPress.stop() but my android emulator didn't like it. the code follows :

```
public void onClick(View arg0) {

try{
    display.setText(pp.getText());
    int x = r.nextInt(sfx.length);
    butPress = MediaPlayer.create(PitchMaker.this, sfx[x]);
    butPress.start();
}catch(Exception e){
    display.setText("Whoops we had a problem. Please try again");
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T09:48:40.317

请在 catch 块中使用这行代码，以便我们可以得到准确的错误报告。

```
Toast.makeText(getApplicationContext(),e.toString(),Toast.LENGTH_SHORT).show(); 
```

# batch-file - 批处理文件在目录中执行所有操作

> ID：13691141
> 
> 赞同：0
> 
> 时间：2012-12-03T20:28:40.907
> 
> 标签：batch-file

所以我正在寻找一个 jar 来获取“jar”类型目录中的所有内容，然后让它列出它的目录名和文件名：

所以是这样的：

```
Listing of files in Directory c:\abc\123

myJar1.jar
myJar2.jar
...
myJar10.jar 
```

我希望我的输出如何出现是这样的：

```
<jar href="123/myJar1.jar"/>
<jar href="123/myJar2.jar"/>
...
<jar href="123/myJar10.jar"/> 
```

我在使用这个脚本时遇到了很多问题，我似乎无法接受我正在设置的变量并让它们按照我通常的方式附加到文本中。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:50:47.917

事实证明，我的 batch-fu 非常强大：

```
@echo off
dir /b /A *.jar > myJars.txt
for %%* in (.) do set CurrDirName=%%~n*
for /F "tokens=*" %%A in (myJars.txt) do echo ^<jar href^="%CurrDirName%/%%A" /^> >> myJars2.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:33:03.243

不需要中间文件，也不需要环境变量。

```
@echo off
>myJars.txt (for %%D in (.) do for %%F in (*.jar) do echo ^<jar href="%%~nD/%%F"/^>) 
```

如果您确实必须包含隐藏文件和系统文件，那么以下更长的版本可以使用

```
@echo off
>myJars.txt (for %%D in (.) do for /f "eol=: delims=" %%F in ('dir /b /a-d *.jar') do echo ^<jar href="%%~nD/%%F"/^>) 
```

上述两个都可以重新格式化以更具可读性：

```
:: excludes hidden and system files
@echo off
>myJars.txt (
  for %%D in (.) do (
    for %%F in (*.jar) do (echo ^<jar href="%%~nD/%%F"/^>)
  )
)

:: includes hidden and system files
@echo off
>myJars.txt (
  for %%D in (.) do (
    for /f "eol=: delims=" %%F in (
      'dir /b /a-d *.jar'
    ) do (echo ^<jar href="%%~nD/%%F"/^>)
  )
) 
```

# wordpress - 如何修改子主题中的主题捆绑小部件？

> ID：13691148
> 
> 赞同：5
> 
> 时间：2012-12-03T20:28:58.657
> 
> 标签：wordpress, wordpress-theming

我想从侧边栏中显示的最新帖子中删除 nofollow 代码。我发现将 rel=nofollow 标签添加到最新帖子的代码位于此处

主题文件夹/示例主题/lib/activity/plugin.php。

这是确切的代码：

```
private function get_latest_posts( $post_count ) {

    // Get the latest posts
    $latest_posts = get_posts(
        array(
            'numberposts'   => $post_count,
            'order'         => 'desc',
            'orderby'       => 'date'
        )
    );

    // Create the markup for the listing
    $html = '<div class="tab-pane" id="recent">';
        $html .= '<ul class="latest-posts">';

        if( count( $latest_posts ) > 0 ) {

            foreach( $latest_posts as $post ) {

                $html .= '<li class="clearfix">';

                    // Add the small featured image
                    if( has_post_thumbnail( $post->ID ) ) {
                        $html .= '<a class="latest-post-tn fademe" href="' . get_permalink( $post->ID ) . '" rel="nofollow">';
                            $html .= get_the_post_thumbnail( $post->ID, array( 50, 50 ) );
                        $html .= '</a>';
                    } // end if

                    $html .='<div class="latest-meta">';    

                        // Add the title
                        $html .= '<a href="' . get_permalink( $post->ID ) . '" rel="nofollow">';
                            $html .= get_the_title( $post->ID );
                        $html .= '</a>';

                        // Add date posted
                        // If there's no title, then we need to turn the date into the link
                        if( strlen( get_the_title( $post->ID ) ) == 0 ) {
                            $html .= '<a href="' . get_permalink( $post->ID ) . '" rel="nofollow">';
                        } // end if

                        $html .= '<span class="latest-date">';
                            $html .= get_the_time( get_option( 'date_format' ), $post->ID );
                        $html .= '</span>';

                        // Close the anchor 
                        if(strlen( get_the_title( $post->ID ) ) == 0 ) {
                            $html .= '</a>';
                        } // end if

                    $html .='</div>';

                $html .= '</li>';
            } // end foreach

        } else {

            $html .= '<li>';
                $html .= '<p class="no-posts">' . __( "You have no recent posts.", 'standard' ) . '</p>';
            $html .= '</li>';

        } // end if/else

        $html .= '</ul>';
    $html .= '</div>';

    return $html;

} // end get_latest_posts 
```

现在请告诉我如何使用子主题从该代码中删除 nofollow 标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:03:55.027

由于您可以控制子主题，因此您可以包装调用以显示该小部件的小部件区域，其中包含获取输出、对其执行正则表达式搜索/替换并输出结果的内容。我最近写了一篇关于这个的博客文章：

[过滤 WordPress 小部件的输出](http://snippets.webaware.com.au/snippets/filtering-the-output-of-wordpress-widgets/)

基础是你有一个用你自己的函数替换 dynamic_sidebar() 的函数，如下所示：

```
function theme_dynamic_sidebar($index = 1) {
    // capture output from the widgets
    ob_start();
    $result = dynamic_sidebar($index);
    $out = ob_get_clean();
    // do regex search/replace on $out
    echo $out;
    return $result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:51:36.613

看来你运气不好。

这是一个[私有函数](http://docs.php.net/language.oop5.visibility)，主题作者没有提供[过滤器钩子。](http://codex.wordpress.org/Plugin_API/Filter_Reference)

您可以尝试覆盖`include('path/to/plugin.php');`并包含您自己的修改版本。

# javascript - Random color for circle

> ID：13691150
> 
> 赞同：0
> 
> 时间：2012-12-03T20:29:00.970
> 
> 标签：javascript, jquery, random, colors, draw

I'm using svg to draw a circle and I would like to make the stroke color and fill color the same, but still random. Is there some way to randomize the color?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:31:13.353

Paul Irish有[一篇关于这个问题的文章。](http://paulirish.com/2009/random-hex-color-code-snippets/)

```
'#' + Math.floor(Math.random() * 16777215).toString(16); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:33:00.933

```
function getColor(){
    return '#'+Math.floor(Math.random() * 16777215).toString(16);
}

var myColor = getColor(); 
```

然后只是`myColor`用来设置你的笔触和填充。
这将产生柔和的颜色。

示例：http: [//jsfiddle.net/29rkd/](http://jsfiddle.net/29rkd/)

# twitter-bootstrap - How to keep contents scrolling under both a navbar and logo image in bootstrap?

> ID：13691151
> 
> 赞同：1
> 
> 时间：2012-12-03T20:29:06.637
> 
> 标签：twitter-bootstrap

I have a logo image for my site in the upper left, and the navbar right below it. The rest of the contents on my page will scroll under those items, but in the area to the right of my image I can see everything scrolling up... so my question is, is there a way to make that area above the navbar opaque in some way? So as everything below will scroll under it?

My code right now looks like this:

```
<body>
    <div class="container-fluid" style="padding-top: 146px;">    
        <div class="navbar navbar-fixed-top navbar-inverse">
            <div id="top">
                <div class="row-fluid">
                    <div class="span8">
                        <a id="logo" href="/"><img src="img/logo.jpg"/></a>
                    </div>
                    <div class="span4">
                        </br>Some text to the right of logo, above navbar</br>More text
                    </div>
                </div>
            </div>
            <div class="navbar-inner">
                <ul class="nav"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T04:24:25.090

您似乎遗漏了一些代码，但请尝试`background-color: #FFF;`使用您的`#top`div。

# xpath - xpath - 如何查找信息

> ID：13691156
> 
> 赞同：2
> 
> 时间：2012-12-03T20:29:16.907
> 
> 标签：xpath, selenium, webdriver, automated-tests

鉴于此 HTML：

```
<tr class="even" id="district_22">
    <td class="name">Virginia Beach City Public Schools</td>
    <td class=""><a href="/admin/districts/22" class="member_link delete_link" data-confirm="Sure?" data-method="delete" rel="nofollow">Delete</a></td>
</tr>
<tr class="even" id="district_23">
    <td class="name">Virginia City City Public Schools</td>
    <td class=""><a href="/admin/districts/23" class="member_link delete_link" data-confirm="Sure?" data-method="delete" rel="nofollow">Delete</a></td>
</tr>
<tr class="even" id="district_24">
    <td class="name">Virginia Town City Public Schools</td>
    <td class=""><a href="/admin/districts/24" class="member_link delete_link" data-confirm="Sure?" data-method="delete" rel="nofollow">Delete</a></td>
</tr> 
```

我正在尝试使用 Selenium 和 xpath。我在尝试选择属于“Virginia Beach City Public Sc​​hools”的“删除”链接时遇到问题。我是 xpath 的新手。

我在尝试：

```
xpath=(//td[text()='Beach')]/@class.contains('delete')) 
```

但它没有找到元素。

注意：我不能使用 ID，因为这些是重复测试，并且 ID 每次都会更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:31:17.157

试试这个：

```
//td[contains(text(),'Beach')]/../td/a[contains(@class,'delete_link')] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T14:57:02.700

`tr[@id="district_22"]//a[contains(@class,'delete_link')]` 会好很多。
看文字不好。毕竟它可能会以其他方式进行本地化和编辑。然而，ID 必须保持不变且不重复。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-06T14:57:45.450

我认为您想在循环中执行自动化脚本，如果是这种情况，那么您可以尝试以下代码：

```
 for(i=1,dist=22; i<-count; i++,dist++)
 {
    ....
    ....
    driver..findElement(By.xpath("//*[@id=District_"+dist+"]/..."))
 } 
```

# php - 检查数组中是否至少一个键以字符开头

> ID：13691162
> 
> 赞同：-3
> 
> 时间：2012-12-03T20:29:44.197
> 
> 标签：php

我有一个包含术语和定义的数组>

```
$myArray = array("apple" => "Fruit that grows ...", "car" => "Vehicle on four..."); 
```

如何确定我是否有以特定字母开头的单词？说“c”代表汽车？

如果可能的话，我需要用 JS 做这个检查，而不需要重新加载页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:39:33.917

您必须迭代并检查自己：

```
foreach( $myArray as $key=>$val ) {
   if( $key[0] == 'c' ) {
     // bingo
   }
} 
```

# mysql - Child table status

> ID：13691170
> 
> 赞同：1
> 
> 时间：2012-12-03T20:30:05.853
> 
> 标签：mysql, sql, database

I have a table A with `ID`, `houseId` and `Task`. I have another table B with `ID`, `TbleAId`, `Description` and `Status`.

![Table Structure](../Images/1f82c02511e9b2b88d511cc6fe81752a.png)

I want to get count of all the tasks, completed tasks (where the status for all is set to 'Completed') and incomplete tasks (where the status for all is not set to 'Completed')

Check out the image for a sample:

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:31:22.130

```
SELECT
  HouseID,
  count(*) as Total_Tasks,
  Sum(Total_SubTask=Completed_SubTask) as Completed_Tasks,
  Sum(Total_SubTask<>Completed_SubTask) as Incomplete_Tasks
FROM
  TableA inner join (
    SELECT
      TbleAID,
      Count(*) as Total_SubTask,
      Sum(Status='Completed') as Completed_SubTask
    FROM TableB
    GROUP BY TbleAID) s on tablea.ID = s.TbleAID
GROUP BY HouseID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T21:09:35.640

这是另一个双重分组解决方案，它使用了稍微不同的方法：

```
SELECT
  a.HouseID,
  COUNT(*)                        AS TotalTasks,
  COUNT(b.TaskStatus = 1 OR NULL) AS CompletedTasks,
  COUNT(b.TaskStatus < 1 OR NULL) AS InCompleteTasks
FROM TableA a
  INNER JOIN (
    SELECT
      TbleAID,
      AVG(CASE Status WHEN 'Completed' THEN 1 ELSE 0 END) AS TaskStatus
    FROM TableB
    GROUP BY TbleAID
  ) b ON a.ID = b.TbleAID
GROUP BY a.HouseID
; 
```

基本上，它将文本状态替换为数字状态：1 表示其他状态`Completed`，0 表示其他状态。对于每个任务，都会计算平均状态。如果结果为1，则表示所有子任务也为1，即完成，所以任务也完成了。

如果至少有一个子任务没有完成，则平均值将小于 1，从而表明整个任务是不完整的。

[您可以在 SQL Fiddle](http://sqlfiddle.com/#!2/5ae05/1)尝试此解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:56:27.177

我似乎完全误读了这个问题。感谢@poncha 澄清它。您想在按房屋汇总之前按任务进行汇总：

```
select HouseId,
       count(*) as NumTasks,
       sum(case when NotCompletedSubTask = 0 then 1 else 0 end) as Completed,
       sum(case when NotCompletedSubtask > 0 then 1 else 0 end) as NotCompleted
from (select b.TbleAId, a.HouseId
             sum(case when status = 'Completed' then 1 else 0 end) as CompletedSubTask,
             sum(case when status <> 'Completed' then 1 else 0 end) as NotCompletedSubTask
      from TableB b join
           TableA a
           on b.TbleAID = a.ID
      group by b.TbleAId, a.HouseId
     ) t
group by HouseId 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:06:01.233

我*理解*这个问题的方式：`A.ID`是*任务*的 id ，`B.ID`是*子任务*的 id ，`B.TableAID`是从子任务到其父任务的引用。

如果这个假设是正确的，那么我认为问题是关于计算所有**完成**所有**子任务的任务**......

有点复杂，但或多或​​少应该是这样的，除非您要使用临时表或 SQL 之外的代码：

```
SELECT
A.HouseID,
COUNT(DISTINCT A.ID) as `Total Task`,
SUM(IF(C.TableAID IS NOT NULL AND C.total=C.completed,1,0)) AS `Completed Tasks`,
SUM(IF(C.TableAID IS NOT NULL AND C.total=C.completed,0,1)) AS `Incomplete Tasks`
FROM A
LEFT JOIN (
  SELECT TableAID,COUNT(*) AS total, SUM(IF(status='Completed',1,0)) AS completed
  FROM B
  GROUP BY TableAID
  ) AS C ON A.ID=C.TableAID
GROUP BY A.HouseID 
```

# php - phpunit and autoloader not working even with spl_autoload_register

> ID：13691173
> 
> 赞同：0
> 
> 时间：2012-12-03T20:30:15.787
> 
> 标签：php, web-applications, phpunit, autoload, spl-autoload-register

I'm trying to get PHPunit working with an existing custom framework. I've gotten some basic tests to work but when I try to hook a test up to my bootstrap code, none of my classes will autoload! I've looked into the issue and changed my original __autoload to:

```
spl_autoload_register(function ($class) {
    require_once APP_MODELS . "/$class_name.php";
}); 
```

This still works for standard web calls, but when I try to run code via PHPunit, I still get a class not found error. Am I still doing something wrong?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-03T20:58:24.537

没关系，我编辑错人了。问题解决了！

# node.js - 使用 Node.js facebook-node-sdk 的 Open Graph 不接受 Facebook 访问令牌

> ID：13691175
> 
> 赞同：3
> 
> 时间：2012-12-03T20:30:31.260
> 
> 标签：node.js, facebook-graph-api, facebook-node-sdk

使用 Node.js[`facebook-node-sdk`](https://github.com/Thuzi/facebook-node-sdk/)模块发布 Open Graph 操作给了我`{"error": "An active access token must be used to query information about the current user."}`.

```
var FB = require( 'fb' )
var path = '/me?' + namespace + ':' + action_type_name
var body = {
     access_token: myAccessToken,
     myAction : myCustomObjectURL
}
FB.api( path, 'post', body, function( res )
{
    if( res.error ) {
        console.log( 'the call to open graph failed: ' + res.error.message );
    }
    else {
        console.log( 'success' )
    }
}) 
```

如果我打印此访问令牌并将其与 cURL ( `curl https://graph.facebook.com/me?access_token=myAccessToken`) 一起使用，它将正确返回，没有错误。Facebook 还显示该应用有权以该用户身份发帖。那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:35:49.747

哦，愚蠢的问题。事实证明，我需要在 URL 路径中使用斜杠而不是问号：`path = '/me/' + ...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-05T14:56:38.930

实际上这是节点 facebook api 的错误。当您使用“？”时 在您的 api 调用中，accesstoken 会附加另一个“？” [https://github.com/Thuzi/facebook-node-sdk/blob/master/fb.js#L268](https://github.com/Thuzi/facebook-node-sdk/blob/master/fb.js#L268)

这会导致像这样的 api 调用：[https](https://graph.facebook.com/me/friends?limit=10?access_token=vSAEFfionhaWFwai) ://graph.facebook.com/me/friends?limit=10?access_token=vSAEFfionhaWFwai ...

你看到多重'？因此，在请求中，Facebook 无法再找到访问令牌。

# java - how to use method of one class in another class

> ID：13691177
> 
> 赞同：0
> 
> 时间：2012-12-03T20:30:35.660
> 
> 标签：java

here is first class

```
 // extending class from JPanel
    public class MyPanel extends JPanel {
// variables used to draw oval at different locations
    int mX = 200;
    int mY = 0;

// overriding paintComponent method
    public void paintComponent(Graphics g) {
// erasing behaviour – this will clear all the
// previous painting
        super.paintComponent(g);
// Down casting Graphics object to Graphics2D
        Graphics2D g2 = (Graphics2D) g;
// changing the color to blue
        g2.setColor(Color.blue);

// drawing filled oval with blue color
// using instance variables
        g2.fillOval(mX, mY, 40, 40); 
```

now i want to use the method g2.setColot(Colot.blue) in the following where the question marks are.

```
// event handler method

public void actionPerformed(ActionEvent ae) {

// if ball reached to maximum width of frame minus 40 since diameter of ball is 40 then change the X-direction of ball

    if (f.getWidth() - 40 == p.mX) {
        x = -5;
?????  set the color as red ????????

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:38:04.600

将`Color`成员添加到您的班级。当您想更改颜色时，更改为成员的值并调用`repaint()`：

```
 public class MyPanel extends JPanel {
        int mX = 200;
        int mY = 0;
        Color myColor = Color.blue; //Default color is blue,
                                    //but make it whatever you want

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        g2.setColor(myColor);

        g2.fillOval(mX, mY, 40, 40);
    }

public void actionPerformed(ActionEvent ae) {

    if (f.getWidth() - 40 == p.mX) {
        x = -5;
        myColor = Color.red;
        repaint();    
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:34:18.577

如果我了解您需要的是创建`Graphics2D g2`一个类属性。这样，您类中的所有方法都可以访问该“全局”变量：

```
public class MyPanel extends JPanel {
    Graphics2D g2;

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g2 = (Graphics2D) g;
        ...
    }

    public void actionPerformed(ActionEvent ae) {
        g2.setColor(...);
    }
} 
```

# perl - How to quote a perl $symbol in a makefile

> ID：13691180
> 
> 赞同：4
> 
> 时间：2012-12-03T20:30:47.243
> 
> 标签：perl, makefile, quoting

In a Makefile, I have a rule to make a figure list from a LaTeX paper by piping the output from a script to a perl expression that increments figure numbers $f++ and prepends Figure $f: to the lines.

From a command line, it works fine, as follows:

```
% texdepend -format=1 -print=f MilestonesProject | perl -pe 'unless (/^#/){$f++; s/^/Figure $f: /}' > FIGLIST 
```

generating FIGLIST:

```
# texdepend, v0.96 (Michael Friendly (friendly@yorku.ca))
# commandline: texdepend -format=1 -print=f MilestonesProject
# FIGS =
Figure 1: fig/langren-google-overlay2.pdf
Figure 2: fig/mileyears4.png
Figure 3: fig/datavis-schema-3.pdf
Figure 4: fig/datavis-timeline2.png
... 
```

I can't figure out how to make this work in a Makefile, because the $f stuff in the perl expression gets interpreted by make and I can't figure out how to quote it or otherwise make it invisible to make.

My most recent attempt in my Makefile:

```
## Generate FIGLIST; doesnt work due to Make quoting
FIGLIST:
    $(TEXDEPEND) -format=1 -print=f $(MAIN)  | perl -pe 'unless (/^#/){\$f++; s/^/Figure \$f: /}' > FIGLIST 
```

Can someone help?

-Michael

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:42:14.750

双倍的美元符号。

```
## Generate FIGLIST
FIGLIST:
    $(TEXDEPEND) -format=1 -print=f $(MAIN) \
    | perl -pe 'unless (/^\#/){$$f++; s/^/Figure $$f: /}' > $@ 
```

您可能还需要对注释符号进行反斜杠转义。我这样做是为了以防万一。

另请参阅[http://www.gnu.org/software/make/manual/html_node/Variables-in-Recipes.html#Variables-in-Recipes](http://www.gnu.org/software/make/manual/html_node/Variables-in-Recipes.html#Variables-in-Recipes)

# linux - Google Chrome/Chromium 在 Ubuntu 12.10 上存在问题

> ID：13691183
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:31:08.190
> 
> 标签：linux, flash, google-chrome, ubuntu, chromium

出于某种原因，自从我安装了 Ubuntu 12.10 后，我的 Chromium 就不能正常工作，它对 Flash 和其他随机的东西有问题。我尝试安装 Google Chrome ( `google-chrome-stable`) 而不是 Chromium，也是因为该版本比 Chromium 更新。与 Chromium 相比，有些东西效果更好，比如 Flash，但现在 Facebook 到处都是错误且无法使用（当我滚动时，该网站实际上已经分崩离析）。

有没有办法让我在 Ubuntu 12.10 上安装 Google Chrome 而不会出现问题？有人遇到类似的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:31:08.190

`google-chrome-beta`从 Synaptic 包管理器安装对我有用。

# boolean - 布尔结果 C 编程

> ID：13691184
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:31:08.897
> 
> 标签：boolean

我需要一个返回 0 或 1 的函数，每个输入一个值。
输入应来自键盘，每行 1 个。
预期的输入是空格、1 和 0。
1 - 输入：应该产生 1
0 - 输入：应该产生 0
空格 - 输入：应该产生 0
输入：应该产生 0
制表符 - 输入：应该产生 0

除了单独输入之外，我现在所拥有的一切都可以正常工作，我正在使用 getchar() 和一堆 if 语句，但我似乎无法让它工作。
getchar() 似乎很难操纵只提供输入 - 或缺少输入 -
而不是换行符。

感谢您可能拥有的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:59:40.763

请更具体。你可以这样做

```
#include <stdio.h>
// only if you dont want to wait for enter each get
#include <termios.h>
#include <unistd.h>

int main ()
{
   char c = 0;

   // only if you dont want to wait for enter each get
   struct termios newtty;
   tcgetattr (0, &newtty);
   newtty.c_lflag &= (~ICANON);
   tcsetattr (0, TCSANOW, &newtty);

   puts ("start\n");
   do {
      if(c == 0)
         c=getchar();
      switch(c)
      {
         case '1':
            c=getchar();
            if(c == '\n')
               putchar ('1');
            else
               continue;
            c = 0;
            break;
         case '0':
         case '\t':
            c=getchar();
            if(c == '\n')
               putchar ('0');
            else
               continue;
            c = 0;
            break;
         case '\n':
            putchar ('0');
            c = 0;
            break;
         default:
            c = 0;
            continue;
     }
  } while (1);
  return 0;
} 
```

# python - 酸洗不可腌制的物体

> ID：13691185
> 
> 赞同：6
> 
> 时间：2012-12-03T20:31:09.987
> 
> 标签：python, pygame, pickle, save, savestate

我正在使用 pygame 制作一个绘图程序，我想在其中为用户提供一个选项，即保存程序的确切状态，然后在以后重新加载它。在这一点上，我保存了我的 globals dict 的副本，然后遍历，腌制每个对象。pygame 中有一些对象不能被腌制，但可以转换成字符串并以这种方式腌制。我的代码设置为执行此操作，但其中一些不可提取的对象是通过引用到达的。换句话说，它们不在全局字典中，但它们被全局字典中的对象引用。我想在这个递归中腌制它们，但我不知道如何告诉 pickle 返回它遇到问题的对象，更改它，然后尝试再次腌制它。我的代码真的很混乱，如果有一种不同的、更好的方式来做我的事情

```
 surfaceStringHeader = 'PYGAME.SURFACE_CONVERTED:'
imageToStringFormat = 'RGBA'
def save_project(filename=None):
    assert filename != None, "Please specify path of project file"
    pickler = pickle.Pickler(file(filename,'w'))
    for key, value in globals().copy().iteritems():
        #There's a bit of a kludge statement here since I don't know how to 
        #access module type object directly
        if type(value) not in [type(sys),type(None)]   and \
        key not in ['__name__','value','key']          and \
        (key,value) not in pygame.__dict__.iteritems() and \
        (key,value) not in sys.__dict__.iteritems()    and \
        (key,value) not in pickle.__dict__.iteritems(): 
        #Perhaps I should add something to the above to reduce redundancy of
        #saving the program defaults?
            #Refromat unusable objects:
            if type(value)==pygame.Surface:
                valueString = pygame.image.tostring(value,imageToStringFormat)
                widthString = str(value.get_size()[0]).zfill(5)
                heightString = str(value.get_size()[1]).zfill(5)
                formattedValue = surfaceStringHeader+widthString+heightString+valueString
            else:
                formattedValue = value

            try:
                pickler.dump((key,formattedValue))
            except Exception as e:
                print key+':' + str(e)

def open_project(filename=None):
    assert filename != None, "Please specify path to project file"
    unpickler = pickle.Unpickler(file(filename,'r'))
    haventReachedEOF = False
    while haventReachedEOF:
        try:
            key,value = unpickler.load()
            #Rework the unpicklable objects stored 
            if type(value) == str and value[0:25]==surfaceStringHeader:
                value = pygame.image.frombuffer(value[36:],(int(value[26:31]),int(value[31:36])),imageToStringFormat)
            sys.modules['__main__'].__setattr__(key,value)
        except EOFError:
            haventReachedEOF = True 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:33:05.893

简而言之：不要这样做。

腌制应用程序中的所有内容很麻烦，并且可能会导致问题。从程序中获取您需要的数据并手动将其存储为适当的数据格式，然后通过从该数据中创建您需要的内容来加载它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T21:52:03.093

您想保存整个程序的状态，以便以后可以重新加载。这是 Pickle 的一个完美用例，我完全看不出这个用例有什么问题。但是，您腌制 globals() 命名空间并过滤掉 sys、pygame 和 pickle 的方法很不稳定。通常的模式是拥有一个您腌制的会话对象。

另外我认为如何腌制可能会有些混乱：

1.  当您腌制一个对象时，其成员变量引用的所有对象都将自动腌制/取消腌制，这很好
2.  如果pickle不能序列化一个对象，你应该告诉pickle如何保存和恢复该对象，方法是为任何不pickle的对象编写自定义[**getstate** 和**setstate**](http://docs.python.org/2/library/pickle.html)方法，所以嵌套在主会话对象中的一两个类将具有自定义**get/setstate**函数来执行诸如重新打开设备之类的操作，例如文件句柄，这在会话之间显然会有所不同
3.  如果您需要进行二进制序列化，则不需要将对象转换为字符串，只需在该对象的**get/setstate**方法中使用二进制序列化协议（[即使用协议 1](http://docs.python.org/2/library/pickle.html#data-stream-format)）

最后你的代码应该看起来更像这样：

```
session = None
import pickle
def startsession():
    globals session
    session = pickle.Unpickler(sessionfilehandle('r')).load()
    if session is None: session = Session() 

def savesession(filename=None):
    globals session
    pickle.Pickler.dump(session,sessionfilehandle('w'))

class Session(object):
    def __init__(self):
        self.someobject=NewObject1()
        #.... plus whole object tree representing the whole game
        self.somedevicehandlethatcannotbepickled=GetDeviceHandle1()  #for example
    def __getstate__(self):
        odict = self.__dict__.copy()
        del odict['somedevicehandlethatcannotbepickled'] #don't pickle this
        return odict
    def __setstate__(self, dict):
        self.__dict__.update(dict)
        self.somedevicehandlethatcannotbepickled=GetDeviceHandle1() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T21:01:50.263

如果您知道所有不可腌制的对象类型，那么这个问题的答案中的代码可能会有所帮助“[递归 dir() 一个 python 对象以查找某种类型或具有某个值的值](https://stackoverflow.com/questions/12611337/recursively-dir-a-python-object-to-find-values-of-a-certain-type-or-with-a-cer)”——我写它是为了回应类似的情况，我知道所有不可腌制的对象类型，但我不知道它们在数据结构中的位置。您可以使用此代码找到它们，将它们替换为其他内容，然后在 unpickling 时使用类似的代码将它们放回原处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-03T20:52:01.960

从您的评论中，听起来您尝试做的最困难的部分是为用户提供实时解释器，并保存*.*

那么，如何将实时解释器作为子进程运行呢？您想要公开给脚本的任何来自对象模型的信息，您都明确地这样做（无论是通过`multiprocessing`共享内存，还是某种消息传递 API）。

然后，您不需要保存自己的解释器的完整状态，这要么非常困难，要么不可能；您以正常方式保存数据模型，然后您可以从外部而不是内部冻结子解释器。

这显然比您尝试做的要复杂得多，但我认为任何简单的事情实际上都行不通。例如，如果用户对你的代码有一个实时解释器，他们可以对任何东西进行猴子补丁——甚至是酸洗代码——然后会发生什么？您需要对可以保存和恢复的确切内容定义一些限制——如果这些限制足够广泛，我认为您必须从外部进行。

同时，正如评论中提到的，两者`scipy`（或 Enthought 附带的一些相关项目）`ipython`都具有针对有限用例的保存和恢复功能，这至少为您提供了一些代码来研究，但它们的用例可能不是和你一样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-14T13:13:55.340

为此，我使用[dill](http://pythonhosted.org/dill)，它可以在 python 中序列化几乎任何东西。Dill 还提供[了一些很好的工具](https://github.com/uqfoundation/dill/blob/master/dill/detect.py)，可以帮助您了解在代码失败时导致酸洗失败的原因。此外，[objgraph](http://mg.pov.lt/objgraph/)也是对测试套件的一个非常方便的补充。

```
>>> import dill
>>> # blah blah blah... your session code here
>>> dill.dump_session('pygame.pkl')
>>>
>>> # and if you get a pickling error, use dill's tools to discover a workaround
>>> dill.detect.badobjects(your_bad_object, depth=1)
>>>
>>> # visualize the references in your bad objects
>>> objgraph.show_refs(your_bad_object, filename='pygame_bad_object.png') 
```

# javascript - Google Maps Api v3，从 XML 加载标记，不在地图上显示

> ID：13691189
> 
> 赞同：1
> 
> 时间：2012-12-03T20:31:15.817
> 
> 标签：javascript, jquery, google-maps-api-3

我对 Google Maps Api 和 jQuery 有一个大问题。我需要从 XML 文件中获取标记，并在地图上显示。

这是带有地图的页面： http: [//szymonnosal.pl/sandbox/bsk/](http://szymonnosal.pl/sandbox/bsk/)

我的代码：

我初始化地图：

```
var mapa;   // obiekt globalny
var dymek;  // okno z informacjami
var networks = []; 
var locations = [];

function mapaStart()  
{  
    var wspolrzedne = new google.maps.LatLng(50.0157021545812, 19.9094574787954);
    var opcjeMapy = {
        zoom: 15,
        center: wspolrzedne,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        disableDefaultUI: true,
        navigationControl: true,
        mapTypeControl: true
    };
    mapa = new google.maps.Map(document.getElementById("mapka"), opcjeMapy);            
    dymek = new google.maps.InfoWindow();

    loadNetworks();

    google.maps.event.addListener(mapa,'click',function(){
        resetLocations();
    }); 
} 
```

在 loadNetwork() 我从 XML 文件加载标记，我使用 jQuery：

```
function loadNetworks()
{
$.get('net.xml',function(xml){
    $(xml).find("network").each(function(){
        var lat         =   parseFloat($(this).find("lat").text());
        var lon         =   parseFloat($(this).find("lon").text());
        var icon_url    =   $(this).find("icon").text();
        var SSID        =   $(this).find("SSID").text();
        var BSSID       =   $(this).find("BSSID").text();
        var AuthMode    =   $(this).find("AuthMode").text();
        var Frequency   =   $(this).find("Frequency").text();
        //alert(lat+'  '+lon+'  '+icon_url+'  '+SSID+'  '+BSSID+'  '+AuthMode+'  '+Frequency);
        var marker      =   addNetwork(lat,lon,icon_url,SSID,BSSID,AuthMode,Frequency);  
        alert(marker.txt); // <- marker is correct object, because in alert pop-up is text from marker. 
    });
});
} 
```

在 addNetwork 中，我在地图上添加标记。

```
function addNetwork(lat,lon,icon_url,SSID,BSSID,AuthMode,Frequency)
{
    var size = new google.maps.Size(30,23);   
    var start_point = new google.maps.Point(0,0);   
    var start_hook = new google.maps.Point(15,12);   

    var icon = new google.maps.MarkerImage(icon_url, size, start_point, start_hook); 

    var marker  =   new google.maps.Marker(
        {
            position: new google.maps.LatLng(lat,lon),
            title: BSSID,
            icon: icon,
            map: mapa
        }
    );
    marker.txt = 'BSSID: '+BSSID+'<br/>SSID: '+SSID+'<br />AuthMode: '+AuthMode+'<br />Frequency: '+Frequency;
    google.maps.event.addListener(marker,"click",function()
    {
        dymek.setPosition(marker.getPosition());
        dymek.setContent(marker.txt);
        dymek.open(mapa);
    });

    return marker;
} 
```

如果我使用其他函数加载 XML，它是正确的：

```
function loadNetworks()
{
    jx.load('getNetwork.php', function(xml)
    {
        var markery = xml.getElementsByTagName("network");
        for(var i=0; i<markery.length; i++)
        {
            var lat         =   parseFloat(markery[i].attributes.getNamedItem("lat").nodeValue);
            var lon         =   parseFloat(markery[i].attributes.getNamedItem("lon").nodeValue);
            var ikona_url   =   markery[i].attributes.getNamedItem("ikona").nodeValue;
            var SSID        =   markery[i].attributes.getNamedItem("SSID").nodeValue;
            var BSSID       =   markery[i].attributes.getNamedItem("BSSID").nodeValue;
            var AuthMode    =   markery[i].attributes.getNamedItem("AuthMode").nodeValue;
            var Frequency   =   markery[i].attributes.getNamedItem("Frequency").nodeValue;
            var marker      =   addNetwork(lat,lon,ikona_url,SSID,BSSID,AuthMode,Frequency);
        }
        alert('Wczytano '+markery.length+' markerów z pliku networks.xml');
    },'xml','get');
} 
```

jx 的功能来自：[http ://www.openjs.com/scripts/jx/](http://www.openjs.com/scripts/jx/)

你有什么想法，我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:08:32.047

在我看来， icon_url 没有定义。测试将标记定义更改为：

```
var marker = new google.maps.Marker(
             {
               position: new google.maps.LatLng(lat,lon),
               title: BSSID,
               // icon: icon,
               map: mapa
             }); 
```

这是在现场：

```
var icon_url = jQuery(this).find("icon").text(); 
```

不是这个（这是您发布的代码）：

```
var ikona_url = markery[i].attributes.getNamedItem("ikona").nodeValue; 
```

您的 xml 使用“ikona”，并且是元素的内容而不是属性。

```
<networks>
  <network>
    <lat>50.0158556853</lat>
    <lon>19.9096229322</lon>
    <SSID>untitled</SSID>
    <BSSID>f0:7d:68:48:97:00</BSSID>
    <AuthMode>[WPA-PSK-TKIP+CCMP][WPA2-PSK-TKIP+CCMP][ESS]</AuthMode>
    <Frequency>2447</Frequency>
    <ikona>http://maps.google.com/intl/en_us/mapfiles/ms/micons/green.png"</ikona>
  </network>
</networks> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:21:05.310

有没有办法可以将 XML 转换为 JSON 作为返回数据？

如果是，请尝试 vMap。

vMap 是一个带有 HTML 5 的闪电 jQuery 插件，它通过发送一个简单的 JSON 数据结构使 Google Maps 变得简单。

[https://github.com/vhugogarcia/vMap](https://github.com/vhugogarcia/vMap)

它帮助我解决了很多谷歌地图的标记问题，但如果需要，它还添加了列出位置的功能。

随意修改它作为您的需要。

# php - PHP获取超类中的属性方法

> ID：13691192
> 
> 赞同：2
> 
> 时间：2012-12-03T20:31:37.923
> 
> 标签：php, oop

我希望我的类从其超类继承 getProperties 方法。

```
class Mother {
  function getProperties(){
    return get_class_vars(get_class($this));
  } 
}

class Child extends Mother{
  private $one = 1;
  private $two = 2;
} 
```

问题是，如果我在 Child 上调用 getProperties，我会得到一个空结果：

```
 $c = new Child();
 var_dump( $c->getProperties() ); 
```

返回`array(0) {}`

如果我用相同的命令覆盖 Child 中的 getProperties 方法，它会按预期工作并返回`array(2) { ["one"]=> int(1) ["two"]=> int(2) }`. 所以我认为这`$this`被解析为 Mother 类，而不是继承该方法的类。如何让 Child 以我需要的方式继承该方法？或者我如何改变`$this`与孩子而不是母亲一起工作的范围？也许我只是在这里遗漏了非常简单的事实，因此感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:36:24.250

问题是您的属性是`private`. 这使得它们只能被声明类访问，并且只能被声明类访问。制作它们`protected`。

请注意，即使那样，不同的 PHP 版本之间似乎也存在一些不一致：http: [//3v4l.org/1Rm6e](http://3v4l.org/1Rm6e)

# java - 我有两种方法需要使用 JUnit 测试进行测试。这是代码

> ID：13691193
> 
> 赞同：1
> 
> 时间：2012-12-03T20:31:40.360
> 
> 标签：java, junit4

公共类经理扩展员工{

```
/**
 * Manager Constructor takes in arguements and calls superclass
 * @param id
 * @param weeklyPay
 */
public Manager(int id, double weeklyPay) // Constructor
{
    super(id);
    super.weeklyPay=weeklyPay;
}

public String toString() // returns a String
{
    return "Manager "+super.toString();
}

public double calculateWeeklyPay() // calculates weeklypay
{
    return super.weeklyPay;
} 
```

我必须测试 toString 方法和 calculateWeeklyPay 方法。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:35:58.097

不确定你想测试这个类，因为它看起来很多逻辑都在你的超类中。但是这里...

```
assertEquals(42d, new Manager(1, 42d).calculateWeeklyPay,0.001); 
```

并测试字符串等于（假设`super.toString`返回`MyString`

```
assertEquals("ManagerMyString", new Manager(1, 42d)); 
```

`toString`右侧的 会自动调用，或者如果您想明确调用

```
assertEquals("ManagerMyString", new Manager(1, 42d).toString()); 
```

所有这些方法都是 JUnit 的一部分，可以通过[Assert](http://junit.sourceforge.net/javadoc/org/junit/Assert.html)类静态导入到您的 java 文件中。

# java - 游戏服务器的性能

> ID：13691194
> 
> 赞同：1
> 
> 时间：2012-12-03T20:31:43.217
> 
> 标签：java, networking

我已经使用 TCP 协议制作了一个游戏服务器。如果有什么要说的，我正在使用 KryoNet 框架。

它现在每半秒广播一次球员的位置和姓名，但我不确定在合理的情况下我能把它放多低。

建议多久让游戏服务器广播一次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:40:42.187

这完全取决于您制作的游戏类型。对于许多游戏来说，定期广播绝对不如即时更改或查询方法。但是，如果您决定定期广播，您可以很容易地确定正确的时间：问问自己客户端上需要多精确的玩家位置（而不是客户端可以插值多少）并将位置差异除以最大值玩家位置可以改变的速度。

# java - Java 中的 ActionListener 和 EventListener 有什么区别？

> ID：13691195
> 
> 赞同：8
> 
> 时间：2012-12-03T20:31:44.810
> 
> 标签：java, user-interface, actionlistener, event-listener

ActionListener 和 EventListener 有什么区别，尤其是在 Java GUI 开发的上下文中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:35:43.100

该接口`ActionListener`是 的子接口`EventListener`。在实践中，最好实现最具体的接口，例如`ActionListener`或`WindowListener`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:40:02.137

ActionListener 接口用于处理动作事件。例如，它用于 JButton 的按钮单击、JCheckbox 的检查和取消检查、选择选项时的 JMenuItem 以及许多其他图形组件。

这是一个简单的界面，只有一种技术：

```
 public interface ActionListener extends EventListener

 {
    public void actionPerformed(ActionEvent e);
 } 
```

事件侦听器用于练习事件。例如，类似于 JButton 或 JTextField 的图形组件被确认为事件源。

这表明它们可以生成事件 - 当用户在 JButton 上关联或在 JTextField 中键入文本时。事件侦听器的工作是捕捉这些事件并对其进行不可思议的处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-27T15:45:08.663

[尽管含义可能因平台而异](https://coderanch.com/t/645943/java/Difference-EventHandler-ActionListener)，但根据本[Oracle 教程](https://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html)，在 Java Swing 的上下文中`ActionListener`实现了一个功能，*当用户执行某些操作时*`actionPerformed(ActionEvent)`，该功能将执行某些操作。An是 的子接口。包含几个子接口，例如，当用户移动鼠标滚轮时会做一些事情。*`ActionListener``EventListener``EventListener``MouseWheelListener`*

# masstransit - MassTransit 请求/响应方案中的超时发布消息

> ID：13691199
> 
> 赞同：3
> 
> 时间：2012-12-03T20:32:00.900
> 
> 标签：masstransit

我正在尝试设置 MassTransit 请求/响应方案。问题是消息永远不会到达消费者。我在 PublishRequest 上收到“等待响应超时”错误。日志文件中没有显示其他错误。正在 msmq 中创建消息。

异常信息：

> 异常类型：TargetInvocationException 异常消息：调用的目标已抛出异常。在 System.RuntimeTypeHandle.CreateInstance（RuntimeType 类型，Boolean publicOnly，Boolean noCheck，Boolean& canBeCached，RuntimeMethodHandleInternal& ctor，Boolean& bNeedSecurityCheck）在 System.RuntimeType.CreateInstanceSlow（Boolean publicOnly，Boolean skipCheckThis，Boolean fillCache，StackCrawlMark 和 stackMark）在 System.RuntimeType.CreateInstanceDefaultCtor (Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark & stackMark)
> 在 System.Activator.CreateInstance(Type type, Boolean nonPublic) 在 System.Activator.CreateInstance(Type type) 在 System.Web.Mvc.DefaultControllerFactory.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType)
> 
> 等待响应超时，RequestId: 08cfa243-4a88-ba3a-20cf-307f54910000 at MassTransit.RequestResponse.RequestImpl `1.Wait() in d:\BuildAgent-03\work\8d1373c869590c5b\src\MassTransit\RequestResponse\RequestImpl.cs:line 124 at MassTransit.RequestResponseExtensions.PublishRequest[TRequest](IServiceBus bus, TRequest message, Action`1 configureCallback) in d:\BuildAgent-03\work\8d1373c869590c5b\src\MassTransit\RequestResponseExtensions.cs:line 31 at Producer。 c:\Users\rick\Documents\Visual Studio 2012\Projects\ConsumerTest1\Producer.Website\Controllers\AccountController.cs:line 56 中的 Website.Controllers.AccountController..ctor()

生产者设置：

```
 _bus = ServiceBusFactory.New(sbc =>
            {
                sbc.UseMsmq();
                sbc.VerifyMsmqConfiguration();

                sbc.UseMulticastSubscriptionClient();
                sbc.SetNetwork("Test");

               sbc.ReceiveFrom("msmq://localhost/consumer_test_1");

            }); 
```

生产者发送消息：

```
 var message = new AccountNewMessage()
                {
                    CorrelationId = CombGuid.Generate(),
                    UserName = “blah blah”,
                    Password = “yada yada”
                };

                this._bus.PublishRequest(message, r =>
                    {
                        r.SetTimeout(30.Seconds());

                        r.Handle<AccountNewMessageResponse>(m =>
                            {
                                var response = m;
                            });
                    }); 
```

消费者设置：

```
 this.bus = ServiceBusFactory.New(sbc =>
            {
                sbc.UseMsmq();
                sbc.VerifyMsmqConfiguration();

                sbc.UseMulticastSubscriptionClient();
                sbc.SetNetwork("Test");

                sbc.ReceiveFrom("msmq://localhost/consumer_test_2");

                sbc.Subscribe(subs => subs.Instance(new AccountNewMessageConsumer()));
            }); 
```

消费者：

```
public class AccountNewMessageConsumer : Consumes<AccountNewMessage>.Context
{
    public void Consume(IConsumeContext<AccountNewMessage> context)
    {
        context.Respond(new AccountNewMessageResponse()
        {
            CorrelationId = context.Message.CorrelationId,
            ErrorCode = "1",
            UserId = new Random().Next(1, 10000).ToString()
        });
    }
} 
```

留言：

```
[Serializable]
public class AccountNewMessage : CorrelatedBy<Guid>
{
    public Guid CorrelationId { get; set; }
    public string UserName { get; set; }
    public string Password { get; set; }
}

[Serializable]
public class AccountNewMessageResponse : CorrelatedBy<Guid>
{
    public Guid CorrelationId { get; set; }
    public string UserId { get; set; }
    public string ErrorCode { get; set; }
} 
```

我究竟做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:13:41.983

您必须告诉 MassTransit 如何存储它的订阅信息（对于 MSMQ）。

有两种选择：`MSMQ Multicast`，将订阅信息保存在内存中，并将`MSMQ Runtime Services`订阅信息存储在数据库中，因此它在会话之间保持不变。

您选择使用哪个取决于您是需要永久订阅还是临时订阅 - 来自[文档](https://masstransit.readthedocs.org/en/latest/overview/subscriptions.html#permanent-v-s-temporary-subscriptions)：

> 永久订阅表示您希望保留的订阅，即使您的进程已关闭（也许您正在进行升级并且不想错过任何消息）。如果您不在乎关闭时是否错过消息，则可以使用临时订阅。

没有理由在开发/PoC 期间不能使用 Multicast 并稍后切换到 RuntimeServices。文档页面还显示了如何在配置中设置每个，当然使用 RuntimeServices 您还必须设置数据库。

（请注意，多播可能需要一段时间才能自行设置，因此您可能需要暂停测试系统以预热，然后再开始通过它发送消息。）

编辑：我添加了几个验证订阅和消费者的例程：您将在设置订阅时调用第一个（即在 sbc.Subscribe 期间），在配置总线后调用第二个。也许他们会帮助找到问题？

```
private void ValidateSubscriptions(Configurator configurator)
{
    var errors = configurator.Validate();

    Console.WriteLine("Subscription Validation");
    Console.WriteLine("-----------------------");

    foreach (var err in errors.Where(e => string.IsNullOrEmpty(e.Value) == false))
    {
        Console.WriteLine("Type: {0} Message: {1} Key: {2} Value: {3}",
            err.Disposition, err.Message, err.Key, err.Value);
    }
}

private static void ValidateBus(Configurator bus)
{
    var errors = bus.Validate();

    Console.WriteLine("Consumer Validation");
    Console.WriteLine("-------------------");

    foreach (var err in errors.Where(e => string.IsNullOrEmpty(e.Value) == false))
    {
        Console.WriteLine("Type: {0} Message: {1} Key: {2} Value: {3}",
            err.Disposition, err.Message, err.Key, err.Value);
    }
} 
```

# javascript - 在 Raphael 中撤消 toFront？

> ID：13691200
> 
> 赞同：1
> 
> 时间：2012-12-03T20:32:09.160
> 
> 标签：javascript, raphael

我希望一个元素仅在悬停时出现在前面，然后返回到鼠标关闭之前的 z-index。我有办法在拉斐尔做到这一点吗？在调用 toFront 之前保存元素的当前 z-index，然后再次应用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T22:13:24.940

简短的回答是，*不*。这样做的原因是 SVG 不依赖 z-index 属性来确定元素的渲染顺序——它只是使用它们在 SVG 文档中出现的顺序（所谓的“画家的顺序”——从后到前） ）。为了复制相同的内容，您需要在当前元素之前记录该项目，将目标对象移动到悬停元素列表的末尾，然后将其移动到其原始位置，在其前一个兄弟的位置之后。凌乱而复杂，没有内置支持。

更长的答案是你真的不需要。在大多数情况下，您可以摆脱这个简单的技巧：

```
el.hover( function()
    {
        var duplicated_node = this.clone();
        duplicated_node.hover( function() {}, function()
            {
                this.remove();
            } );
        duplicated_node.toFront();
    }, function() {} ); 
```

换句话说，您 a) 克隆对象；b）向克隆添加悬停功能，当悬停结束时将其删除；c) 将克隆移到前面。由于它将共享原始位置，它的悬停事件将立即触发。

这不是一个完全干净的解决方案，但它比尝试重新调整元素以重新创建特定顺序更好（更简单和更有效） - 特别是如果你有很多元素。

# php - 创建和更新用户

> ID：13691208
> 
> 赞同：0
> 
> 时间：2012-12-03T20:32:28.107
> 
> 标签：php, codeigniter

我有一个用于编辑和创建用户的表单。在表单上，​​我有一个 if 语句，如果表单是一个编辑，那么它会放置一个隐藏的表单元素，该元素保存正在更新的用户的值。

当我在 php 端控制器上评估表单时，这就是我用来做的事情。

```
$user_id = $this->input->post('user_id');
if (isset($user_id_id))
{
$this->form_validation->set_rules('user_id', 'User ID', 'required|trim|xss_clean|integer');
} 
```

我没有在编辑表单上对此进行测试，但在添加表单上它说用户 ID 是必需的，我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:41:02.437

在 CodeIgniter 中，如果存在则`$this->input->post('foobar')`返回值，`$_POST['foobar']`如果不存在则返回`false`。无论哪种方式，都会设置一个值，因此[`isset()`将评估为 true](http://codepad.org/2tEj38i3)。

改为使用`if ($user_id !== FALSE)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:48:20.723

你可以简单地使用

```
if($this->input->post('user_id'))
{
    $this->form_validation->set_rules('user_id', 'User ID', 'required|trim|xss_clean|integer');
} 
```

# matlab - 使用 matlab 编写数学图像

> ID：13691209
> 
> 赞同：1
> 
> 时间：2012-12-03T20:32:29.797
> 
> 标签：matlab

我被困在函数程序（不是主程序）上，它必须绘制一个显示几条垂直正弦曲线的 3D 图形。

不幸的是，我有一个计划而不是窦曲线。我不知道为什么它不起作用，我一直试图在 2 小时内找出问题所在...请帮助谢谢

```
%fonction sinus_vertical:
function img=sinus_vertical(N,M)
w=2*pi;
t=1:0.1:N;
for j=1:M
    for i=1:N
        for k=1:N
            img(i,j)=sin(w*t(k));
        end
    end
end 
```

主程序：

```
%Main Script
img3=sinus_vertical(100,100);
figure(1);
mesh(img3);
colormap gray 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:51:06.347

对于您想要的，最简单的解决方案是：

```
function img=sinus_vertical(N,M)
  w=2*pi;
  t=0.1*(1:N);
  img = repmat(sin(w*t)',1,M);
end 
```

如果您跳过第三个内部循环，您可以更正原始代码，并修改设置`t`。所以正确的代码是：

```
function img=sinus_vertical(N,M)
    w=2*pi;
    t=0.1*(1:N);
    for j=1:M
        for i=1:N
            img(i,j)=sin(w*t(i)); % or j, depending on what direction you want the sin.
        end
    end
end 
```

解释：
我用 给你写了“不需要”循环`k`，因为如果你这样做

```
for k=1:N
  img(i,j) = sin(w*t(k))
end 
```

这和写作一样`img(i,j)=sin(w*t(N))`。也就是说，您会将所有图像像素设置为相同的值。

# cognos - 在 Cognos 8 Report/Event Studio 中：需要从日期中减去

> ID：13691212
> 
> 赞同：2
> 
> 时间：2012-12-03T20:32:38.933
> 
> 标签：cognos

如何使用 Cognos 8 Report/Event studio 中的函数从日期字段计算减法函数？

我有凭证到期日期，我需要在 Event Studio 中设置警报，让经理知道某人的凭证何时到期 90 天。有些日期是 2012 年、2013 年和 2014 年。

我似乎无法让系统工具减去日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T06:55:37.077

您可以尝试**[Credential Exp Date] - current_date <= 90**

（必需：凭证 exp 日期是一个 DATE 字段，否则您需要使用类似 to_date(...) 的东西将其转换为日期）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T05:29:24.113

如果您的字段是实际日期字段，您可以使用以下表达式：

```
_add_days ([Date],-90) 
```

这是它在 Report Studio 中的样子：![在此处输入图像描述](../Images/7bd9a8d258039a3aa6bf9ef08aef89fa.png)

结果：
![在此处输入图像描述](../Images/de06db9355825f26153b407251ecde03.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-27T20:12:43.810

我认为 Ran 的方式应该是正确的方式，除非你想使用这个功能：`_add_months`

```
 _add_months ([Date],-3) 
```

# google-api - 缩略图 404 错误

> ID：13691216
> 
> 赞同：7
> 
> 时间：2012-12-03T20:32:44.007
> 
> 标签：google-api, google-drive-api, google-api-java-client

我正在尝试获取文件的缩略图，但收到错误 404，返回驱动器的 url 在某些文件中是这样的

[https://docs.google.com/feeds/vt?gd=true&id=1DnoJzxnZXVERyqC5jfTwfpd8uEn&v=39&s=AMedNnoAAAAAUL0gv5da9U81UzT-L4N59b1BwNuZmzgU&sz=s220](https://docs.google.com/feeds/vt?gd=true&id=1DnoJzxnZXVERyqC5jfTwfpd8uEn&v=39&s=AMedNnoAAAAAUL0gv5da9U81UzT-L4N59b1BwNuZmzgU&sz=s220)

但在其他人是

[https://lh6.googleusercontent.com/ACwqFdvBX0NUJO6SR9fyemnCnSel-TpCZTaddu9CEkZqxtQpJY84cP_cFj64CA6=s220](https://lh6.googleusercontent.com/ACwqFdvBX0NUJO6SR9fyemnCnSel-TpCZTaddu9CEkZqxtQpJY84cP_cFj64CA6=s220)

最后一个来自 picasa 并且有效，所以显然有效的 url 来自 picasa，我怎样才能获得像最后一个一样的所有文件的 url？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-30T15:46:35.080

我遇到了同样的问题。

您应该将访问令牌附加到 thumbnailLink URL，这将授权您的 GET 请求。

所以像：

```
var thumbLink = driveEntry["thumbnailLink"] + "&access_token=" + YOURTOKEN; 
```

干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T05:00:04.000

要获取存储在 Google Drive 上的文件的缩略图，您必须向文件端点发送 GET 请求，然后检查其`thumbnailLink`属性：

[https://developers.google.com/drive/v2/reference/files/get](https://developers.google.com/drive/v2/reference/files/get)

无论缩略图 URL 的格式如何，只要您使用文件元数据中返回的值就可以了。

请注意缩略图 URL 会在一定时间后过期。

# solr - 在solr中查询多个url

> ID：13691219
> 
> 赞同：2
> 
> 时间：2012-12-03T20:32:51.310
> 
> 标签：solr

我目前的流程：

```
SolrServer solrServer = new HttpSolrServer(“http://localhost:8983/solr”)
SolrQuery parameters = new SolrQuery()
parameters.set("q", *:*)
QueryResponse response = solrServer.query(parameters)
SolrDocumentList list = response.getResults() 
```

如何在一周的几天内使用多个网址执行此操作？(“http://localhost:8983/solr/Monday”) (“http://localhost:8983/solr/Tuesday”) (“http://localhost:8983/solr/Wednesday”) (“http:// /localhost:8983/solr/Thursday”) (“http://localhost:8983/solr/Friday”)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:07:08.947

通过使用[DistributedSearch](http://wiki.apache.org/solr/DistributedSearch)，您可以将查询发送到多个 url。假设您有以下核心：

```
http://localhost:8983/solr/Monday
http://localhost:8983/solr/Tuesday
http://localhost:8983/solr/Wednesday
http://localhost:8983/solr/Thursday
http://localhost:8983/solr/Friday 
```

您可以通过如下更改代码在 SolrJ 中执行此操作。

```
SolrServer solrServer = new HttpSolrServer(“http://localhost:8983/solr/Monday”);
SolrQuery parameters = new SolrQuery();
parameters.set("q", *:*);
parameters.setParam("shards","localhost:8983/solr/Monday, localhost:8983/solr/Tuesday, localhost:8983/solr/Wednesday, localhost:8983/solr/Thursday, localhost:8983/solr/Friday");
QueryResponse response = solrServer.query(parameters);
SolrDocumentList list = response.getResults(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-13T07:13:57.803

您可以使用`LBHttpSolrServer`类来使用多个网址。

例子：

```
SolrServer solr = new LBHttpSolrServer("http://localhost:8983/solr/Monday",
                "http://localhost:8983/solr/Tuesday"); 
```

# php - PHP SQLSRV 查询很慢

> ID：13691227
> 
> 赞同：0
> 
> 时间：2012-12-03T20:33:14.730
> 
> 标签：php, sql

**更新了全功能代码**

我在 IIS 7.5 上运行 PHP 以连接到托管在另一台服务器上的 SQL Server 数据库...

我的网页可以正常工作，但是执行这样的简单查询需要很长时间......每个循环只返回 (12*3)*n 个结果，循环在 foreach“servicio_id”中给出，其中 n = 服务的数量我有... 一个简单的页面必须返回给我： ((12*3)*14) * 3 个结果... 我会解释： ((12 * 3) * SERVICES) * NUMBER OF TABLES (Banksphere 和 Umbrales * 2 就像你会看到的......）

我认为问题出在表中，因为我有近 200 万行，并且每天增加约 20.000 行......但我认为运行查询不会花那么长时间，因为我指定了 entidad_id 之类的参数， servicio_id, peticion_id, fecha... 显示页面大约需要 20-30 秒，有时它会停止并只显示一半... 请给点建议？

```
public static function getValues($entidad_id, $servicio_id, $peticion_id, $fecha) {

    if(date('d', strtotime($fecha)) >= '28' || date('d', strtotime($fecha)) <= '1') {
        $dia_id = 8;
    } else {
        $dia_id = date('N', strtotime($fecha)) -1;
    }
    echo '<script type="text/javascript" language="javascript"> 
    function openwindow(URL) {
        window.open(URL,"Comentarios","menubar=1,resizable=1,width=700,height=350"); 
    }
    </script>'; 

    $conn = sqlsrv_connect(DB_SERVER.', '.DB_PORT, array("UID"=>DB_USER,  "PWD"=>DB_PASS,  "Database"=>DB_NAME));

    $sqlQuery = sqlsrv_query($conn, "
        SELECT TOP ".OPT_RESULTADOS_MAXIMOS." *
        FROM Banksphere
        WHERE entidad_id = '$entidad_id'
        AND servicio_id = '$servicio_id'
        AND peticion_id = '$peticion_id'
        AND fecha = '".$fecha."'
        ORDER BY hora_id DESC
    ");

    while ($row = sqlsrv_fetch_array($sqlQuery)) {  
        $umbralesQuery = sqlsrv_query($conn, "
            SELECT *
            FROM Umbrales
            WHERE entidad_id = '$row[entidad_id]'
            AND servicio_id = '$row[servicio_id]'
            AND peticion_id = '$row[peticion_id]'
            AND dia_id = '$row[dia_id]'
            AND hora_id = '$row[hora_id]'
            ORDER BY hora_id DESC
        "); 
        $umbralesOk = sqlsrv_query($conn, "
            SELECT *
            FROM Umbrales
            WHERE entidad_id = '$row[entidad_id]'
            AND servicio_id = '$row[servicio_id]'
            AND peticion_id = '0'
            AND dia_id = '$row[dia_id]'
            AND hora_id = '$row[hora_id]'
            ORDER BY hora_id DESC
        "); 
        $umbrales = sqlsrv_fetch_array($umbralesQuery);
        $uOK = sqlsrv_fetch_array($umbralesOk);
        sqlsrv_free_stmt($umbralesQuery);
        sqlsrv_free_stmt($umbralesOk);
        $medias = Umbrales::getValues($uOK['minimo'], $umbrales['minimo']);
        if($row['usuario'] != '') $postedby = 'Comentado por '.$row['usuario'].': '; else $postedby = '';

        if($peticion_id == 0) {
            if($row['valor'] < $medias[0]) {
                $color = "D";
            } else if($row['valor'] > $medias[1]) {
                $color = "A";
            } else {
                $color = "OK";
            }
            $minimo = $medias[0];
            $maximo = $medias[1];
        }
        if($peticion_id == 1) {
            if($row['valor'] > $medias[2]) {
                $color = "D";
            } else {
                $color = "OK";
            }
            $minimo = 0;
            $maximo = $medias[2];
        }
        if($peticion_id == 2) {
            if($row['valor'] > $medias[3]) {
                $color = "D";
            } else {
                $color = "OK";
            }
            $minimo = 0;
            $maximo = $medias[3];
        }           
        if($color == "OK"){
            echo '
            <td title="MINIMO: '.$minimo.' | MAXIMO: '.$maximo.'" class="'.$color.'">'.round($row['valor'], 3).'</td>
            ';
        } else {
            echo '
            <td title="MINIMO: '.$minimo.' | MAXIMO: '.$maximo.'" class="'.$color.'">
                <a href="javascript:openwindow(\'/includes/commentForm.php?servicio='.$umbrales['servicio_id'].'&umbral_id='.$umbrales['id'].'&id='.$row['id'].'\')">'.round($row['valor'], 3).'</a>
            </td>
            ';
        }
    }
    sqlsrv_free_stmt($sqlQuery);
    sqlsrv_close($conn);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:37:19.847

您能否在第一个查询中执行一个包含 Umbrales 表的查询？你这样做的方式是为你在第一个查询中得到的每一行调用一个事务。另一种方式你只会对结果进行一次交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T16:06:14.390

得到了解决方案......速度提升现在可以接受......

```
 $sqlQuery = sqlsrv_query($conn, "
        SELECT TOP ".OPT_RESULTADOS_MAXIMOS."
            bs.id AS valor_id,
            bs.valor AS valor,
            bs.servicio_id,
            u.id AS umbral_id,
            u.minimo AS media,
            uok.minimo AS media_ok
        FROM
            [Banksphere] bs
        INNER JOIN
            Umbrales u
        ON
            u.entidad_id = bs.entidad_id
        AND
            u.servicio_id = bs.servicio_id
        AND
            u.dia_id = bs.dia_id
        AND
            u.hora_id = bs.hora_id
        AND
            u.peticion_id = bs.peticion_id
        INNER JOIN
            Umbrales uok
        ON
            uok.entidad_id = bs.entidad_id
        AND
            uok.servicio_id = bs.servicio_id
        AND
            uok.dia_id = bs.dia_id
        AND
            uok.hora_id = bs.hora_id
        AND
            uok.peticion_id = '0'
        WHERE
            bs.entidad_id = '$entidad_id'
        AND
            bs.servicio_id = '$servicio_id'
        AND
            bs.peticion_id = '$peticion_id'
        AND
            bs.fecha = '$fecha'
        ORDER BY
            bs.hora_id DESC,
            bs.peticion_id ASC
    "); 
```

# php - 重定向、屏幕分辨率或用户代理哪个更好？

> ID：13691234
> 
> 赞同：7
> 
> 时间：2012-12-03T20:33:30.940
> 
> 标签：php, javascript, android, html

我为网站创建了一个移动网页，但我想知道重定向的最佳方法是什么。我是根据屏幕分辨率还是用户代理重定向它们？

我会假设屏幕分辨率看起来像这样：

```
if (screen.width <= 1024) window.location.replace("http://www.site/mobile/")
else window.location.replace("http://www.site/"); 
```

使用 PHP，脚本看起来像这样：

```
$useragent=$_SERVER['HTTP_USER_AGENT'];
if(preg_match('/android/i',substr($useragent,0,4)))
header('Location: http://www,site/mobile/'); 
```

一种方法优于另一种方法吗？如果有，有什么好处？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T21:04:03.587

用户代理。

在当今视网膜显示时代和 Android 设备可以是您能想到的任何屏幕分辨率的事实中，屏幕分辨率和平台之间的相关性越来越小。事实上，有许多移动设备（nexus 7、nexus 10、ipad 3+）的屏幕分辨率与台式电脑相同或更高。分辨率根本不够描述。

另一方面，用户代理旨在告诉您发出请求的原因。毫无疑问，您会知道它是 Android 或 iOS 设备。此外，在 Android 上，我认为平板电脑不应该在其 Android 用户代理中包含字符串“mobile”，以便更好地定位。同样，iPad 和 iPhone 都有自己的一组用户代理字符串，您可以考虑这些字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:30:23.300

您需要考虑为什么要制作移动网站。它是否增加了功能（触摸）或消除了多余的重量（3G）简化了小屏幕上的导航？如果您为触摸设备制作了它，请检测触摸的可用性。如果您构建它以允许轻松访问小屏幕，则可能会选择屏幕分辨率（我的 1200x720 的 SGS3 会看到完整的分辨率，这对我来说没问题）。通过用户代理切换而不考虑太多是一个坏主意（如果 UA 中的“移动”是好的切换，但并非所有人都支持它）。如果用户代理包含 ios，你会去一个小屏幕优化网站吗？现在你不会，但你可以在几年前，在 iPad 之前做到这一点。你会用支持触摸的 Windows mini 电脑做什么？考虑功能，而不是设备，除非您想在每台新设备上更新所有站点。

写下您的移动网站的要求（触摸？）以及它添加到普通网站的内容（更好地处理小屏幕？），并测试这些。并让他们选择。

请记住，如果您有无限制的数据计划或 wifi 和大屏幕设备，您会发现移动站点的完整站点版本完全令人讨厌，而允许触摸导航和增强功能且扩展性良好的站点在任何屏幕尺寸上导航都是一种乐趣。

无论如何，我可以建议，当/如果您进行重定向时，请尝试访问其他站点上的同一页面，而不是主页。所以如果你在

```
index.php?language=en&page=about__us 
```

尝试重定向到

```
mobile?language=en&page=about__us 
```

为了更好的用户体验。不要假设访问者从主页访问您的网站。

# c# - 在 .config 中存储用于 SecureString 的凭据

> ID：13691238
> 
> 赞同：4
> 
> 时间：2012-12-03T20:33:47.040
> 
> 标签：c#

我有一个正在使用的库，但没有编写将身份验证凭据作为 SecureString 值的库。我想将这些值作为 SecureString 类型的纯文本存储在应用程序配置文件中。我还没有找到任何地方展示如何做到这一点。是否有可能，或者唯一的方法是从配置文件值构建一个 SecureString 对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T20:59:11.393

这绝对是可能的……至少如果您使用的是 ASP.NET。Jon Galloway 在这里写了一篇很好的文章： [http ://weblogs.asp.net/jgalloway/archive/2008/04/13/encrypting-passwords-in-a-net-app-config-file.aspx](http://weblogs.asp.net/jgalloway/archive/2008/04/13/encrypting-passwords-in-a-net-app-config-file.aspx)

[此外，这里是关于创建和导出 RSA 密钥容器](http://msdn.microsoft.com/en-us/library/2w117ede%28v=vs.90%29.aspx)的 Microsoft 演练，可能会有所帮助。

最后，另一个[微软指南](http://msdn.microsoft.com/en-us/library/ms998283.aspx#paght000006_webfarmscenarios)（虽然有点不同） - 谈到使用机器密钥。

这些指南将允许您创建一个`<secureAppSettings>`包含加密值的部分，以与非安全应用程序设置相同的方式访问代码。

# c# - 使用 log4net 在运行时读取和记录 HttpSession 数据

> ID：13691240
> 
> 赞同：2
> 
> 时间：2012-12-03T20:33:58.183
> 
> 标签：c#, logging, asp.net-mvc-4, log4net

这可能是不可能的，但我想知道是否有办法让它工作。

我有一个大型 ASP.NET MVC43 应用程序，该应用程序已经配备了日志记录语句。

现在我们需要在每个日志条目中包含来自 Session 对象的“公司名称”值。是否可以将 log4net 配置为读取会话数据并将其包含在日志条目中？或者有什么办法强迫它……？

感谢您的任何想法。

[编辑] 这个问题很有帮助： [如何在 ASP.NET 中使用 log4net 在日志文件中包含 SessionID？](https://stackoverflow.com/questions/362468/how-can-i-include-sessionid-in-log-files-using-log4net-in-asp-net)

我最终将此作为我的解决方案：

在 Global.asax.cs 中：

```
 // After the session is acquired, push the organization code into log4net's thread context, in case it has to log anything.
    protected void Application_PostAcquireRequestState(object sender, EventArgs e)
    {
        if (Context.Handler is IRequiresSessionState && Session != null && Session[Constants.EMPLOYEE_DETAILS] != null)
                log4net.ThreadContext.Properties["Company"] = ((EmployeeDetails)Session[Constants.EMPLOYEE_DETAILS]).Company;
    } 
```

在 log4net 配置中：

```
 <parameter>
    <parameterName value="@Company"/>
    <dbType value="String"/>
    <size value="10"/>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%property{Company}" />
    </layout>
  </parameter> 
```

效果很好 - 我现在在我的日志输出中得到了一个公司名称。谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:51:36.267

使用自定义布局转换器

```
public class CompanyLayoutConverter : PatternLayoutConverter
{
    protected override void Convert(TextWriter writer, LoggingEvent loggingEvent)
    {
         var httpContext = HttpContext.Current;
         if (httpContext == null)
             return;

         writer.Write(httpContext.Session["Company Name"]);
    }
} 
```

将此转换器添加到 appender 布局中，公司名称将出现在输出中（只需`%company`在 conversionPattern 值处使用）：

```
<appender name="RollingLogFileAppender" 
          type="log4net.Appender.RollingFileAppender">
  <threshold value="All" />
  <file value="C:\LogFile" />
  <appendToFile value="true" />
  <rollingStyle value="Date" />
  <datePattern value="'.'yyyyMMdd'.log.txt'" />
  <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
  <layout type="log4net.Layout.PatternLayout">
    <converter>
      <name value="company"/>
      <type value="Foo.Bar.CompanyLayoutConverter"/>
    </converter>
    <conversionPattern value="%date %-5level %logger - %company %message%newline" />
  </layout>
</appender> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:54:59.570

有关如何实现此功能的一些想法，请参阅此答案。

[使用 log4net 捕获用户名](https://stackoverflow.com/questions/4813242/capture-username-with-log4net)

您应该能够在不实现自己的 Appender 的情况下做到这一点。

下面是一个`PatternLayoutConverter`从 中提取参数化值的自定义示例`HttpContext.Current.Session`。（我不记得当我作为链接答案的一部分发布时是否测试过它，但它应该很接近）：

```
namespace Log4NetTest
{
  class HttpContextSessionPatternConverter : PatternLayoutConverter
  {
    protected override void Convert(System.IO.TextWriter writer, LoggingEvent loggingEvent)
    {
      //Use the value in Option as a key into HttpContext.Current.Session
      string setting = "";

      HttpContext context = HttpContext.Current;
      if (context != null)
      {
        object sessionItem;
        sessionItem = context.Session[Option];
        if (sessionItem != null)
        {
          setting = sessionItem.ToString();
        }
        writer.Write(setting);
      }
    }
  }
} 
```

另一个更简单的想法是做这样的事情......创建一个对象，它将检索您想要的 Session 参数并将该对象放入 MDC，然后在您的布局中引用 MDC。当 log4net 从 MDC 访问对象时，它会调用它的 ToString 方法来获取要写入日志的值。

```
public class HttpContextSessionParametreProvider
{
  private string _name;
  private string _notSet;

  public HttpContextSessionParameterProvider(string name)
  {
    _name = name;
    _notSet = string.Format("{0} not set", _name);
  }

  public override string ToString()
  {
    HttpContext context = HttpContext.Current;  
    if (context != null && context.Session != null)
    {
      object item = context.Session[_name];
      if (item != null)
      {
        return item.ToString();
      }
    }
    return _notSet;
  }
} 
```

在程序入口点附近的某个地方像这样使用它：

```
MDC.Set("CompanyName", new HttpContextSessionParametreProvider("Company Name")); 
```

（我没有方便的示例来说明如何配置 log4net 以从 MDC 中提取参数，但应该不难找到）。

编辑：

您可以像这样配置 PatternLayout：

```
 <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="[%thread]|[%property{CompanyName}]|%message%newline"/>
  </layout> 
```

现在，假设`HttpContext.Session["Company Name"]`设置为某个值，每当您记录一条消息时，该值都会写入日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:47:41.613

我认为您可以使用上下文和模式布局来做到这一点：

[http://logging.apache.org/log4net/release/manual/contexts.html](http://logging.apache.org/log4net/release/manual/contexts.html)

[http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html](http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html)

该文档并没有太大帮助。

# android - 自动链接在 HTC 上不起作用 - HtcLinkifyDispatcher

> ID：13691241
> 
> 赞同：3
> 
> 时间：2012-12-03T20:33:59.703
> 
> 标签：android, android-4.0-ice-cream-sandwich, autolink, commonsware

我在我的 Android 应用程序中使用set `android:autoLink`to来启用可点击链接。但是，如果我在升级到 ICS 的 HTC Desire S 上运行它，当我点击其中一个链接时，会出现以下异常`web``TextView`

```
android.content.ActivityNotFoundException: Unable to find explicit activity class 
  {com.htc.HtcLinkifyDispatcher/
  com.htc.HtcLinkifyDispatcher.HtcLinkifyDispatcherActivity}; 
  have you declared this activity in your AndroidManifest.xml?

    at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1634)
    at android.app.Instrumentation.execStartActivity(Instrumentation.java:1510)
    at android.app.Activity.startActivityFromChild(Activity.java:3519)
    at android.app.Activity.startActivityForResult(Activity.java:3271)
    at android.app.Activity.startActivity(Activity.java:3358)
    at woodsie.avalanche.info.InfoActivity.startActivity(InfoActivity.java:61)
    at android.text.style.LinkifyURLSpan.onClick(LinkifyURLSpan.java:73) 
```

尝试注册`HtcLinkifyDispatcherActivity`让我无处可去，因为该课程不在我的构建路径上。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-03T20:35:18.550

我发现与此相关的最好的文章是[Linkify 问题：检测和缓解](http://commonsware.com/blog/2012/07/24/linkify-problem-detection-mitigation.html)。

但是，我没有尝试拦截和替换`URLSpan`该类，而是降低了一个级别并覆盖了`startActivity()`TextView 的父 Activity。

```
@Override
public void startActivity(Intent intent) {
    try {
        /* First attempt at fixing an HTC broken by evil Apple patents. */
        if (intent.getComponent() != null 
                && ".HtcLinkifyDispatcherActivity".equals(intent.getComponent().getShortClassName()))
            intent.setComponent(null);
        super.startActivity(intent);
    } catch (ActivityNotFoundException e) {
        /*
         * Probably an HTC broken by evil Apple patents. This is not perfect,
         * but better than crashing the whole application.
         */
        super.startActivity(Intent.createChooser(intent, null));
    }
} 
```

哈克但简单，似乎工作。

# c++ - 在 C/C++ 命令行工具中输入密码时如何显示 *？

> ID：13691249
> 
> 赞同：2
> 
> 时间：2012-12-03T20:34:30.823
> 
> 标签：c++, passwords, getline, cin, command-line-tool

> **可能重复：**
> [从 std::cin 读取密码](https://stackoverflow.com/questions/1413445/read-a-password-from-stdcin)
> [将输入替换为“*” C++](https://stackoverflow.com/questions/7405312/replace-input-with-c)

我正在寻找 C/C++ 类似的方式`<input type="password" />`来允许用户在用 C 编写的命令行工具中出现提示后输入他们的密码。

```
string username;
string password;
cout << "Username: ";
getline(cin, username);
cout << "Password: ";
    [<input type="password" />]
getline(cin, password); 
```

# sql - 添加分组行

> ID：13691250
> 
> 赞同：1
> 
> 时间：2012-12-03T20:34:34.253
> 
> 标签：sql, database

我有一个包含客户的数据库表，其中包含他们的每个年龄等。

我想查询客户并将他们分类为年龄组以获得如下结果：

```
Age_Group   Num_Of_Cust 
 0-10        Count 
 10-20       Count 
 20-30       Count 
```

这可以在单个查询中完成吗？我基本上想插入表格行值并在第二列中计算该年龄段的人数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:48:09.987

尝试类似的东西

```
select age / 10, count(*) from table_name group by age / 10 order by age / 10; 
```

这将为您提供一个结果，其中的行首先包含分组年龄的十列，然后是该范围内的数字。范围实际上是 0-9、10-19 等；如果你想把它调高一个，你可以`age`用`(age-1)`. 请注意，它还将跳过不包含客户的范围。

为了更准确地重现请求的输出 - 但可能不适用于所有 RDBMS（在 PostgreSQL 上测试），可以使用以下内容：

```
select concat(Age*10, '-', Age*10+9) as Age_Group, Num_of_Cust from (
    select age / 10 as Age, count(*) as Num_Of_Cust from test
        group by age / 10 order by age / 10) as X; 
```

（我不喜欢子选择，但似乎有必要获得正确的排序和标签。`Age_Group`例如，排序本身会在 20-29 之前放置 100-109。尝试强制转换让`Age_Group`PostgreSQL 抗议它不是一个列。最后`as X`是还需要消除子查询需要别名的抱怨。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:51:10.880

一个简单`case`的语句就可以解决问题：

```
select agegroup, count(*)
from (select (case when age <= 10 then '00-10'
                   when age <= 20 then '11-20'
                   when age <= 30 then '21-30'
                   else '31+'
              end) as agegreoup, t.*
      from t
     ) t
group by agegroup 
```

我已经为其他所有人添加了最后一组（并假设年龄永远不会是负数）。另外，我使用了“00-10”而不是“0-10”，因此所有组名的长度都相同。子查询不是绝对必要的。我觉得它更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:44:03.357

我会做这样的事情：

```
SELECT
  Coalesce(case when age<10 then '0-9' end,
           case when age between 10 and 20 then '10-20' end,
           case when age>20 then '>20' end) As Age_Group,
  Count(*)
From your_table
Group by Age_Group 
```

# sql-server-2008 - 循环遍历临时表的标量并删除 SQL Server 2008 中存在的内容

> ID：13691254
> 
> 赞同：2
> 
> 时间：2012-12-03T20:34:57.560
> 
> 标签：sql-server-2008

我`stored procedure`在`SQL Server 2008`其中使用了很多临时表（我正在重构另一个代码并试图将它们移动到标量，但这是一个更长的过程）。在存储过程的开头，我想声明所有临时表，然后循环它们并删除任何存在的临时表。

利用其他编程语言（例如`python`），您可以创建一个`for loop`并循环遍历变量。你能做到`SQL Server`吗？ `WHILE`似乎使用正确的函数，但我见过的每个示例都使用增量值，例如`SET @intFlag = @intFlag + 1`. 我不想增加，只是取值并检查临时表是否存在 - 如果存在，则删除它。如果不是，则为下一个值。

这是我的想象，但不确定下一步该做什么，甚至是否可以以编程方式删除表：

```
DECLARE @Tables table (tablename varchar(50));
INSERT INTO @Tables VALUES 
    ('#a'),
    ('#b'),
    ('#c'),
    ('#d');

-- this part is how I would write the code in python -- 

for i in @Tables:
IF OBJECT_ID('tempdb..+ i ') IS NOT NULL
    DROP TABLE i 
```

有没有办法在我的内部完成这个`stored procedure`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:39:44.880

您可能希望为此使用[游标](http://msdn.microsoft.com/en-us/library/ms180169.aspx)，例如：

```
DECLARE @tablename nvarchar(50)
DECLARE table_cursor CURSOR FOR 
SELECT tablename
FROM @Tables;

OPEN table_cursor

FETCH NEXT FROM table_cursor 
INTO @tablename

WHILE @@FETCH_STATUS = 0
BEGIN
    PRINT @tablename
            -- Your DROP TABLE code goes here

    FETCH NEXT FROM table_cursor 
    INTO @tablename
END 
CLOSE table_cursor;
DEALLOCATE table_cursor; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T08:20:59.993

这个没有光标的循环。
只需在表变量中添加 IDENTITY 列

```
DECLARE @Tables table (Id int IDENTITY, tablename varchar(50)
INSERT INTO @Tables VALUES
    ('#a'),
    ('#b'),
    ('#c'),
    ('#d');

DECLARE @Id int = (SELECT MIN(Id) FROM @Tables),
        @dsql nvarchar(max)
WHILE (@Id IS NOT NULL)
BEGIN 
  SELECT @dsql = 'IF OBJECT_ID(''tempdb.dbo.' + tablename + ''') IS NOT NULL DROP TABLE ' + tablename
  FROM @Tables
  WHERE Id = @Id
  EXEC sp_executesql @dsql
SELECT @Id = MIN(Id) FROM @Tables WHERE Id > @Id
END 
```

# angularjs - uiSelect2 的语法错误

> ID：13691259
> 
> 赞同：0
> 
> 时间：2012-12-03T20:35:25.483
> 
> 标签：angularjs, angular-ui

我正在尝试在 a`ng-repeat`中使用字符串连接`ui-select2`：

```
 <select ui-select2 ng-model="selected2" style="width:300px;">
        <option ng-repeat="item in data[it + 'ems']" selected 
                value="{{item}}">{{item}}</option>
    </select> 
```

（这是一个简单的例子，但字符串连接对于代码重用来说是必要的。）

它在正常情况下工作得很好`select`。但是，`uiSelect2`会产生错误：

```
Error: Syntax Error: Token ']' is an unexpected token at column 6 of the expression ['ems']] starting at []].
    at Error (<anonymous>)
    at throwError (http://code.angularjs.org/angular-1.0.1.js:5830:11)
    at parser (http://code.angularjs.org/angular-1.0.1.js:5824:5)
    at http://code.angularjs.org/angular-1.0.1.js:6387:29
    at compileToFn (http://code.angularjs.org/angular-1.0.1.js:8040:16)
    at Object.Scope.$watch (http://code.angularjs.org/angular-1.0.1.js:7547:19)
    at http://angular-ui.github.com/angular-ui/build/angular-ui.js:911:19
    at nodeLinkFn (http://code.angularjs.org/angular-1.0.1.js:4223:13)
    at compositeLinkFn (http://code.angularjs.org/angular-1.0.1.js:3838:14)
    at compositeLinkFn (http://code.angularjs.org/angular-1.0.1.js:3841:12) <select ui-select2="" ng-model="selected2" style="width:300px;" class="ng-pristine ng-valid"> 
```

转载于此[小提琴](http://jsfiddle.net/_nth/6Zjd9/1/)。

我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:59:56.270

我怀疑这是因为 select-ui 有一个孤立的范围，ng-repeat 也是如此，这使您的`it`变量超出了该 ng-repeat 的范围。

我建议无论如何都使用[ng-options](http://docs.angularjs.org/api/ng.directive%3aselect)进行选择..（这很有效，大概是因为它可以防止我提到的范围问题）：

```
<select ui-select2 ng-model="selected2" style="width:300px;" 
  ng-options="item for item in data[it + 'ems']"></select> 
```

# jqxgrid - 如何根据第一个过滤条件过滤第二个 jqxgrid？

> ID：13691265
> 
> 赞同：2
> 
> 时间：2012-12-03T20:35:52.060
> 
> 标签：jqxgrid

我有两个 jqxgrids 都来自同一个地方并使用相同的 dataAdapter 来获取数据。一个网格具有可过滤的列。当用户在第一个中输入一些过滤器文本时，我无法弄清楚如何强制第二个网格自动重新过滤。有没有人这样做，或者甚至可以不必创建自定义过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T07:53:44.027

使用'getfilterinformation'，您可以获得jqxGrid 的过滤器、条件和值。getfilterinformation 返回一个过滤器数组。数组中的每个项目都有以下字段：

*   过滤器 - 这是列的过滤器。您可以将过滤器视为一组过滤器，因为一列可能有多个应用的​​过滤器。通过调用 filter.getfilters()，您可以将所有过滤器应用于列。过滤器组中的每个过滤器，都有{value, condition, operator and type}，其中value是过滤器的值，条件是ex：“包含”，运算符可以是“and”或“or”，type代表过滤器的类型（字符串过滤器、日期过滤器等）。

*   过滤列的数据字段。

然后，您可以将过滤器应用于 Grid 实例，如本示例所示：[customfiltering.htm](http://www.jqwidgets.com/jquery-widgets-demo/demos/jqxgrid/customfiltering.htm?classic)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T04:31:04.087

您可以将方法绑定到第一个网格的`filter`事件。如 API 中所述：

```
$("#jqxGrid").on("filter", function (event) {
  var filterinfo = $("#jqxgrid").jqxGrid('getfilterinformation');
  // then iterate through the filters applied to the 1st grid, and
  // write the appropriate codes to apply the same filters to the 2nd grid
}); 
```

HTH :)

# backbone.js - 使用 Backbone 一次渲染 3 张图像

> ID：13691269
> 
> 赞同：1
> 
> 时间：2012-12-03T20:36:15.813
> 
> 标签：backbone.js

我有一个无限滚动的页面。该页面最初加载了 3 个标签。每个部分包含从我的数据库中提取的 3 个产品图像（不仅是图像，还有产品信息）。下划线模板如下：

```
<section>
  <div class='left'>
    <img src="{{ product.src }}" />
  </div>
  <div class='right'>
    <div class='top'>
      <img src="{{ product.src }}" />
    </div>
    <div class='bottom'>
      <img src="{{ product.src }}" />
    </div>
  </div>
</section> 
```

我在思考如何渲染它时遇到了麻烦。我在想一个产品可能是一个骨干模型：

```
var ProductModel = Backbone.Model.extends({
  defaults: {
    src: '',
    title: 'Product'
    brand: 'ABC'
  }
}); 
```

然后下一部分我卡住了。在我看来，集合就像数据列表。但是，在这种情况下，我不希望显示整个产品列表，我只想要 3 个产品。那么视图呢？视图应该一次渲染所有 3 个图像还是一次渲染一个图像（例如调用渲染 3 次）？请记住，我仍然需要渲染其他 2 个部分（并且它们都显示不同的产品）。

我应该控制我的 HTTP GET 调用一次只响应 3 个图像还是应该让它返回所有产品？

有人可以帮助我或指出一些类似用例的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T10:55:03.867

你应该有一个产品集合，一个产品模型，一个页面视图，然后是每个产品的视图。这个想法是从页面视图中获取一个集合，然后循环通过它来呈现每个产品。

拥有每个产品的视图的好处是您可以轻松地为每个产品分配事件（如点击事件）。

从 HTTP GET 获得的图像数量取决于使用和开销。您可能需要考虑在 API 中添加一个变量，以便应用程序控制您在回复中获得多少图像。

看看这个包含无限滚动和主干的[例子。](http://backbonetutorials.com/infinite-scrolling/)

# sql - 有没有人有用于查找 SQL Server 实例版本的 WQL 查询？

> ID：13691272
> 
> 赞同：4
> 
> 时间：2012-12-03T20:36:30.883
> 
> 标签：sql, sql-server, vbscript, wmi, wql

有谁知道如何使用 WMI 在 VBScript 中获取 SQL Server 安装版本（不关心版本）？

我曾尝试使用注册表（但这需要您知道实例名称和 SQL Server 的版本。

我曾尝试使用 SQL 查询（但这要求您对数据库具有权限，并且我的进程使用的是 LOCAL 用户，而对 SQL Server DBMS 没有权限）。

所以，我只能使用 WQL 来查询 WMI。

我想我需要：

1) 查询 WMI 对象（哪一个）以获取实例名称。2) 然后，对于每个实例，查询另一个对象并从中获取版本。

我浏览了 Microsoft 文档，但找不到要使用的对象。

任何人都可以帮忙吗？

安静的莱尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T10:11:41.943

感谢那。这是我创建的脚本。我希望它可以帮助其他人在我的位置：

```
Dim strValueName, strSKUName, strEdition, strVersion, strArchitecture 
Dim objWMI, objProp

On Error Resume Next
' First try SQL Server 2008/2008 R2:
Set objWMI = GetObject("WINMGMTS:\\.\root\Microsoft\SqlServer\ComputerManagement10")
If Err.Number <> 0 Then
    ' Next, try SQL Server 2005:
    Set objWMI = GetObject("WINMGMTS:\\.\root\Microsoft\SqlServer\ComputerManagement")
    If Err.Number <> 0 Then
        ' Next, try SQL Server 2012:
        Set objWMI = GetObject("WINMGMTS:\\.\root\Microsoft\SqlServer\ComputerManagement11")
    End If
End If

If Err.Number = 0 Then

    On Error Goto 0
    ' Go through the properties (which is just one) and find the name of the SKU.
    For Each objProp In objWMI.ExecQuery("select * from SqlServiceAdvancedProperty where SQLServiceType = 1 AND (PropertyName = 'SKUNAME' OR PropertyName = 'VERSION')")
        If objProp.PropertyName = "SKUNAME" THEN
            strSKUName = objProp.PropertyStrValue
        Else
            strVersion = objProp.PropertyStrValue
        End If
    Next

    ' We do not want the number of bits, so chop it off!
    If Instr(strSKUName, " (") <> 0 Then
        strEdition = Left(strSKUName, Instr(strSKUName, " ("))
        strArchitecture = "64-bit"
    Else
        strEdition = strSKUName
        strArchitecture = "32-bit"
    End If

    WScript.Echo strEdition & " / " & strSKUName & " / " & strArchitecture

End If 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:59:45.997

从这里开始：[如何：使用 VBScript 修改 SQL Server 服务高级属性](http://msdn.microsoft.com/en-us/library/ms186353%28v=sql.105%29.aspx)

第一个样本：

```
set wmi = GetObject("WINMGMTS:\\.\root\Microsoft\SqlServer\ComputerManagement10")
for each prop in wmi.ExecQuery("select * from SqlServiceAdvancedProperty where SQLServiceType = 1 AND PropertyName = 'VERSION'")
    WScript.Echo prop.ServiceName & " " & prop.PropertyName & ": " & prop.PropertyStrValue
next 
```

似乎做你要求的。如果您使用的不是 2008 版，请选中“其他版本”。

# 3d - 3D 凸包内的体素

> ID：13691274
> 
> 赞同：0
> 
> 时间：2012-12-03T20:36:43.113
> 
> 标签：3d, metrics, connectivity, convex-hull, voxels

我有一个值体素的三次矩阵`1`（其余的是`0`）。我需要一个相同大小的矩阵，其中凸包内的体素都是有价值的`1`。我看过一个类似的例子并对其进行了修改：如果我对以下内容执行[此](https://stackoverflow.com/questions/2769138/converting-convex-hull-to-binary-mask)操作，那会起作用吗？

% im3D 是一个零和一的三次矩阵

```
**[x,y,z]=ind2sub(size(im3D), find(im3D==value));
pointMatrix(:,1) = x;
pointMatrix(:,2) = y;
pointMatrix(:,3) = z;
[K,V] = convhull(x,y,z);
dt = DelaunayTri(pointMatrix);
[X,Y,Z] = meshgrid(1:size(im3D));   
simplexIndex = pointLocation(dt,X(:),Y(:),Z(:));
filled_chull = ~isnan(simplexIndex);
filled_chull = reshape(filled_chull,size(X));** 
```

第二个问题：凸包内的体素应该都是连接的吧？那么为什么下面的函数给了我两个连接的对象......欧几里得或曼哈顿式/八角形？

```
**function [nEL, nVOX] = im3D_countobj(im3D,METRIC)
% set METRIC either 'euclidean' or 'octagon'
ES = mmsedisk(1,'3D',METRIC);
q = bwlabeln(im3D,mmseshow(ES));
nEL = max(max(max(q)));
nVOX = size(find(im3D),1);
end** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T01:11:17.723

假设：
-分辨率不是太高（我假设因为您使用 3d 体素）
-您对近似解决方案感到满意
-速度不是问题

那么您可以尝试使用形态运算符的选项。通过使用一组旋转的加厚结构元素来加厚您的体素，您最终会得到一个近似凸包。

在 2D 中进行此类计算的示例如下所示：

[http://homepages.inf.ed.ac.uk/rbf/HIPR2/thick.htm](http://homepages.inf.ed.ac.uk/rbf/HIPR2/thick.htm)

否则，您选择生成 3D 点并计算 delaunay 也是一个合理的选择。您可能想尝试您显示的代码。

# qt - 如何手动添加 Qt QML 库？

> ID：13691277
> 
> 赞同：1
> 
> 时间：2012-12-03T20:36:56.040
> 
> 标签：qt, plugins, static, import, qml

问题描述：我静态构建Qt 4.8.4并打开ShaderEffects示例

```
Application Output:
Run C: \ Qt \ 4.8.3 \ examples \ declarative \ shadereffects \ release \ shadereffects.exe ...
file :/ / / C :/ Qt/4.8.3/examples/declarative/shadereffects/qml/shadereffects/main.qml: 43:1: plugin cannot be loaded for module "Qt.labs.shaders": Unknown error import Qt . labs.shaders 1.0 ^
C: \ Qt \ 4.8.3 \ examples \ declarative \ shadereffects \ release \ shadereffects.exe exited with code 0 
```

所有 *.a 文件都存在。谢谢！

# text - 在响应式网站上工作，文本与媒体查询略有不同

> ID：13691282
> 
> 赞同：0
> 
> 时间：2012-12-03T20:37:20.307
> 
> 标签：text, responsive-design, media-queries

我正在开发一个单页响应式网站。它在很大程度上以我想要的方式工作，但是在调整浏览器宽度时有一部分文本会中断。

这是网站：http:
[//vitaliyg.com](http://vitaliyg.com)

中断的文本是大标签行。它打破了大约 780 像素的浏览器宽度——“挑战”这个词由于某种原因下降到下一行。想不通为什么。

我已经在 Chrome、Safari 和 Firefox 中复制了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:21:11.027

当浏览器获得大约 780 像素宽时，标语具有`font-size:50px`并且父 div .tencol 具有`width:82.7%`并且标语被迫中断。在浏览器宽度为 767px 时`width:auto`，.tencol 允许标语扩展一段时间，但随后随着浏览器继续缩小标语再次中断。

在您的 style.css 中，您只有用 . 声明的 h2 字体大小`@media only screen and (min-width : 481px) and (max-height: 1280px)`。您需要为 h2 font-size 添加额外的断点才能呼吸。

就像是： `@media only screen and (min-width : 481px) and (max-width: 787px) { h2 {font-size:45px;}} @media only screen and (min-width: 788px) and (max-width: 1024px) { h2 {font-size:50px;}}`

尝试使用断点，直到您对结果感到满意为止。

# php - jQuery 计时问题？使用 PHP/mssql

> ID：13691287
> 
> 赞同：2
> 
> 时间：2012-12-03T20:37:37.177
> 
> 标签：php, jquery, sql

```
<html>
<script type='text/javascript' src='jquery.js'></script>
<script type='text/javascript'>
<?php 
    // this sets variables sot session for nodeid 
    $nid = 1;//$_GET["nnid"];

    session_start(); 
    $_SESSION['sesnodid']=$nid;
?> 

var array;

$(document).ready(function (){
    $('#itemsOnPageDiv input:checkbox').click(function(event){
        var obj = [];
        $('#itemsOnPageDiv input[type=checkbox]:checked').each(function(index, value){
        obj.push($(this).attr("value"));
        alert($(this).attr("value")+" added to array");
    });
    array = JSON.stringify(obj);
    });
});

$(document).ready(function(){
    $("#cl").click(function(){
    $.post('buildUserPage.php', { array : array }, 
    function(output){
        $('#debug').html(output).show();
    });
    alert(array);
    });
});

</script>
<div id="itemsOnPageDiv">

<?php

include("hawkfunctions.php");

newPageCheckBoxBuider();

$user_page_cell_info = getUserPageCellInfo($nid);

$i = 0;

echo "<script>";
while($i < count($user_page_cell_info)){
    echo "
    alert('Clicking ".$user_page_cell_info[$i]['tag_id']."');
    \$(document).ready(function(){
    \$('#".trim($user_page_cell_info[$i]['tag_id'])."').trigger('click');
    });";
    $i++;
}
echo "</script>";
?>

</div>

<button id="cl">Save</button>

<div id = 'debug'></div>
</html> 
```

好的。我有一个从 sql 数据库构建的复选框列表。我使用 php 编写 jquery，它根据数据库中的数据获取正确的“选中”框。然后我让这个脚本“单击”所需的复选框。然后，每次“点击”都会填充一个数组。该数组将包含来自 jquery 'clicked' 框以及用户选中或未选中的任何框所需的数据。该数组将被另一个 php 脚本用于根据选中框的更改来更改数据库。

这是问题所在：

应该正确检查的框被选中，但是。应该填充的数组不会一直正确填充。最明显的是，如果最初仅选中一个复选框，则该数组为空。用户取消选中然后再次检查似乎可以解决此问题，但显然这并不理想。有时，当检查2个复选框数据之一时，没有输入数组。任何超过这个的金额似乎都可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:10:52.973

单击复选框是不明确的。有时它有效 - 有时它不起作用。这是一种不可靠的方法。如果它已经被选中，它将取消选中它。

正确的方法是使用[.prop](http://api.jquery.com/prop/)函数或[.attr() （请参阅](http://api.jquery.com/attr/)[此处](https://stackoverflow.com/questions/5874652/prop-vs-attr)的辩论）

```
$('#".trim($user_page_cell_info[$i]['tag_id'])."').prop("checked", true) 
```

当我们这样做时，这里有一些提示。

*   分开你的文件。PHP / HTML / JS / CSS 不应该放在一起（为了清楚起见）

*   据我了解.. 每次单击复选框时，它都会重建您的复选框 JSON ......然后什么也不做。因此，如果我单击 3 个框，它将查询 3 次文档以构造 JSON。只有当有人单击 $("#cl") 按钮时，您才应该这样做。

*   不要将您的数组命名为“数组”。尝试将其命名为更清晰的名称，例如 checkbox_array。

# java - 多类型列表注释翻译：JAXB 到 SimpleXML

> ID：13691292
> 
> 赞同：3
> 
> 时间：2012-12-03T20:37:57.520
> 
> 标签：java, xml, jaxb, xsd, simple-framework

我正在尝试将一些 JAXB xjc.exe 生成的类转换为简单的 XML 类。我不确定如何注释动态元素。例如，在架构中，我有：

```
<!-- Message Set Request/Response Pairs and contained requests  -->
<xsd:element name="QBXMLMsgsRq">
    <xsd:complexType>
        <xsd:choice minOccurs="0" maxOccurs="unbounded">
            <xsd:element name="HostQueryRq" type="HostQueryRqType"/>
            <xsd:element name="CompanyQueryRq" type="CompanyQueryRqType"/>
            <xsd:element name="CompanyActivityQueryRq" type="CompanyActivityQueryRqType"/>
            <!-- many more of these choices -->
        </xsd:choice>
        <xsd:attribute name="oldMessageSetID" type="STRTYPE"/>
        <!-- some other attributes -->
    </xsd:complexType>
</xsd:element> 
```

当通过 xjc.exe 运行时，它会为 @XmlElement 生成以下注释

```
@XmlElements({
    @XmlElement(name = "HostQueryRq", type = HostQueryRqType.class),
    @XmlElement(name = "CompanyQueryRq", type = CompanyQueryRqType.class),
    @XmlElement(name = "CompanyActivityQueryRq", type = CompanyActivityQueryRqType.class),
    //+ et al
})
protected List<Object> hostQueryRqOrCompanyQueryRqOrCompanyActivityQueryRq; 
```

那么如何将这个 JAXB 结构转换为 SimpleXML 带注释的类结构呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T17:03:17.520

答案是使用[ElementListUnion](http://simple.sourceforge.net/download/stream/doc/javadoc/org/simpleframework/xml/ElementListUnion.html)来识别 List 类型的可用选项。在“在单个列表中收集各种类型”下查看[此处。](http://simple.sourceforge.net/download/stream/doc/examples/examples.php)例子：

```
@Root
public class Example {

   @ElementListUnion({
      @ElementList(entry="int", type=Integer.class, inline=true),
      @ElementList(entry="date", type=Date.class, inline=true),
      @ElementList(entry="text", type=String.class, inline=true)
   })
   private List<Object> list;
} 
```

# wordpress - 如何将 Wordpress 博客文章从 Textile 2 转换为 Markdown？

> ID：13691296
> 
> 赞同：3
> 
> 时间：2012-12-03T20:38:19.253
> 
> 标签：wordpress, formatting, markdown, textile, pandoc

大约一两年前，我从 Movable Type 切换到了 Wordpress。但我继续使用 Textile 2 格式（在 WP 插件的帮助下）写我的帖子。

Markdown 在网络上的普及方式给我留下了深刻的印象。从 StackOverflow 到 GitHub 等无处不在。

所以，我正在考虑将我所有 Textile 2 格式的博客文章转换为 Markdown 的想法，我想知道我该怎么做。

[我在这个 StackOverflow 问题](https://stackoverflow.com/questions/2839304/convert-textile-markup-to-markdown)上看到了使用 Pandoc 在格式之间转换的建议。

我可以使用 Pandoc 处理从 Wordpress 导出的 SQL，然后将其重新导入 WP 吗？会有什么陷阱？

或者有人对如何做到这一点有其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:43:24.407

我一直在使用静态博客生成器 Jekyll 和 Octopress，它们使用 Markdown 作为创作格式。人们已经编写了一些工具来将 Wordpress 导出到 markdown：

[https://github.com/mojombo/jekyll/wiki/blog-migrations](https://github.com/mojombo/jekyll/wiki/blog-migrations)

请注意，我没有使用过它们中的任何一个，但希望它们可以帮助您入门。

# plone - getMultiAdapter 失败并出现 ComponentLookupError

> ID：13691297
> 
> 赞同：0
> 
> 时间：2012-12-03T20:38:29.327
> 
> 标签：plone, zope, z3c.form, zope.interface, zope.component

我有一个代码可以使用 get multi 适配器查找 iterface。传递给多适配器的元素成员之一是提供该接口，但不提供元素本身。

我无法控制传递给多适配器的内容，但我可以控制包含其中一个元素的元素。我该如何标记它？通知多适配器那里有一些有用的东西，是否有类似***provideAdapterFactory(cls, interface)***的东西？

代码示例：

声明

```
class ImplementsInterface(object):
    implements(IMarker)

class Parent(object)
    child = ImplementsInterface() 
```

抬头

```
some_members = zope.component.getMultiAdapter(((Parent()), IMarker) 
```

现在，如果我像这样运行代码，它将产生***ComponentLookupError***，同时我无法修改查找代码或多适配器，或者就此而言，我无法将 'implements(IMarker) 分配给 Parent，因为 parent 已经实现了不同的接口和会破坏很多其他的东西。

更新：

[我想我已经从第 6.1 章多适配器](http://www.muthukadan.net/docs/zca.html)中找到了一个我可以理解的解释

更新 2：我认为我没有在我的单元测试代码中正确初始化 zca，这是一个片段

```
import unittest2 as unittest
from zope.traversing.adapters import DefaultTraversable
from z3c.form.testing import TestRequest
from z3c.form import testing, field
from zope import component

class TestFunctionalForm(unittest.TestCase):
    def setUp(self):
        testing.setUp(self)
        component.provideAdapter(field.FieldWidgets)
        component.provideAdapter(DefaultTraversable, [None])
        self.context = self.globs['root']
    def tearDown(self):
        testing.tearDown(self) 
```

# c# - 支持“等待”的 API

> ID：13691298
> 
> 赞同：0
> 
> 时间：2012-12-03T20:38:36.553
> 
> 标签：c#, asynchronous, c#-5.0

我正在向 API 添加异步功能。我有这个界面：

```
public interface IThing
{
    bool Read();
    Task<bool> ReadAsync();
} 
```

调用者可以像这样异步使用它：

```
using (IThing t = await GetAThing())
{
    while (await t.ReadyAsync();
    {
        // do stuff w/the current t
    }
} 
```

有一个实现 IThing 的类：

```
public class RealThing : IThing
{
    public bool Read()
    {
        // do a synchronous read like before
    }

    public Task<bool> ReadAsync()
    {
        return _internal.ReadAsync(); // This returns a Task<bool>
    }
} 
```

这编译和工作！但其他示例更喜欢 ReadAsync() 的这种实现：

```
public async Task<bool> ReadAsync()
{
    return await _internal.ReadAsync();
} 
```

鉴于调用者将等待，为什么 API 中的 async/await ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:05:35.510

```
public async Task<bool> ReadAsync()
{
  return await _internal.ReadAsync();
} 
```

没有必要这样做。它只会增加开销，并没有提供任何好处。

你的代码更好：

```
public Task<bool> ReadAsync()
{
  return _internal.ReadAsync();
} 
```

# entity-framework - MVVM 架构 - 用户权限和获取数据

> ID：13691299
> 
> 赞同：0
> 
> 时间：2012-12-03T20:38:44.690
> 
> 标签：entity-framework, mvvm

我试图弄清楚如何适应用户权限和获取数据。这不是一个简单的任务

```
GetInvoices where Invoice.UserId = 5 
```

所以我可以将 userId 传递给一个方法，但它非常复杂，而且我不想比要求的更深入，它会造成混乱。目前它的工作方式如下：View 调用 ViewModel 上的命令，ViewModel 调用存储库方法，该方法使用 EF 获取数据。现在我需要根据用户权限过滤这些数据。

从逻辑上讲，VIewModel 应该强制执行业务规则。这是否意味着我应该在 ViewModel 中创建 IQueriable，并将其传递给 Model？

或者，可以这样做

... if (LoggedUser.Role.Permissions.any(x=> x.PErmissionType == somePermission) && ....)

在（M）模型方面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:31:55.320

您的**[DAL](http://en.wikipedia.org/wiki/Data_access_layer)**应该根据用户的权限获取和过滤结果。换句话说，VM 应该只接收允许用户查看的模型/数据。
如您所说， VM 强制执行*业务规则*，但我不确定模型过滤是否适合此类别。

您应该做的是，当 VM 请求数据时，他应该传递基于权限（用户 ID 或用户拥有的权限集）过滤数据所需的任何内容，并且只传递适合他的数据应该返回权限。

# javascript - 非 webkit 浏览器，旋转 div 中相邻图像之间的间隙

> ID：13691302
> 
> 赞同：2
> 
> 时间：2012-12-03T20:39:42.180
> 
> 标签：javascript, html, css, cross-browser, transform

目标是旋转一个填充有“tiles”的 div——它们是相邻的图像元素，它们的位置使用样式属性设置在顶部和左侧。

这在启用 webkit 的浏览器（Chrome/Safari）中按预期工作：http: [//jsfiddle.net/Yt99J/52/](http://jsfiddle.net/Yt99J/52/)

```
<html>
    <head>
    <title>Rotating div of adjacent elements</title>
    </head>

    <body>
        <div id="canvas" style="overflow: visible; position: absolute; -webkit-transform: translate3d(0px, 100px, 0px) rotate3d(0, 0, 1, 0deg);">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 0px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:0px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;top: 100px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
        </div>

        <div id="canvas_rotated" style="overflow: visible; position: absolute; -webkit-transform: translate3d(400px, 50px, 0px) rotate3d(0, 0, 1, 45deg);">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 0px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:0px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
        </div>
    </body>
</html>​ 
```

但是，对于非 webkit 浏览器，当图像旋转到不是 90 度的倍数时，图块之间会有 1 个像素的间隙。我假设这是由于浏览器内部最低级别的一些舍入错误。有什么办法可以解决这个问题，除了按大小的函数缩放瓷砖以弥补间隙（如果可能的话，我想避免这样做）。这是一个在 FireFox 中实现的错误示例：http: [//jsfiddle.net/Yt99J/50/](http://jsfiddle.net/Yt99J/50/)

```
<html>
    <head>
    <title>Rotating div of adjacent elements</title>
    </head>

    <body>
        <div id="canvas" style="overflow: visible; position: absolute; -moz-transform: translate(0px, 100px) rotate(0deg);">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 0px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:0px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;top: 100px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
        </div>

        <div id="canvas" style="overflow: visible; position: absolute; -moz-transform: translate(400px, 50px) rotate(45deg);">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 0px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:0px;" src="http://oi47.tinypic.com/15zjdky.jpg">
            <img galleryimg="no" style="display: block; position: absolute; width: 100px; height: 100px; top: 100px; left:100px;" src="http://oi47.tinypic.com/15zjdky.jpg">
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:31:46.677

对于任何想知道的人来说，这似乎是某些浏览器的怪癖。FireFox 似乎正在解决这个问题： [https ://bugzilla.mozilla.org/show_bug.cgi?id=504071](https://bugzilla.mozilla.org/show_bug.cgi?id=504071)

希望 IE 和其他浏览器也能效仿。这个问题对于映射网络应用程序来说真的很糟糕。

# javascript - 在 javascript 中使用 xsl 样式化 xml 来查找文档的高度

> ID：13691305
> 
> 赞同：0
> 
> 时间：2012-12-03T20:39:51.750
> 
> 标签：javascript, jquery, xml, xslt

我在这里使用了 w3 学校网站上的示例：http: [//www.w3schools.com/xsl/xsl_client.asp](http://www.w3schools.com/xsl/xsl_client.asp)

我使用了标题下的示例：在浏览器中将 XML 转换为 XHTML。

这里，变量“ex”和“resultDocument”是使用 xsl 转换 xml 的结果。

我想知道的是，是否有办法读取此生成文档的高度？

我最终需要将内容放在 iframe 中，并且需要知道高度才能使框架尺寸合适。

任何帮助/指针表示赞赏。谢谢

编辑：另外，如何用“ex”或“resultDocument”更新 iframe 的内容？

第二次编辑：我已经设法更新了 iframe 的内容，`$('#box').contents().find('html').html(resultDocument);` 尽管我已经搜索过高和低，但仍然无法找到一种解决方案来以跨浏览器兼容的方法查找 resultDocument 正文的高度，但仍然没有。有人请帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:10:31.457

尝试运行

```
document.documentElement.getBoundingClientRect() 
```

改造后。

# list - 从 tcl 列表中删除元素

> ID：13691306
> 
> 赞同：1
> 
> 时间：2012-12-03T20:39:54.507
> 
> 标签：list, tcl

如何从 tcl 中的列表中删除每个偶数索引元素？我用了

```
 for {set i 0} {$i <[llength $a]} {incr i} {
    if {[expr $i % 2] == 0} {
     lreplace $a [lindex $a $i] [lindex $a $i] 
    } 
```

但是每当我删除一个元素时如何使用 lreplace 更新变量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:54:36.050

创建一个新列表并在其中添加所需的元素可能要容易得多。在 foreach 下方将成对遍历列表并将第一个添加到新列表中。这也适用于具有奇数个元素的列表。j 的最后时间值将为空。

```
set a "0 1 2 3 4 5 6 7 8 9 10"                                          

set result []                                                        
foreach {i j} $a {                                                   
    lappend result $i                                                
}                                                                    

puts $result 
```

结果将是

```
0 2 4 6 8 10 
```

请注意，TCL 中大多数与列表相关的命令采用列表的名称（例如 lreplace A 0 0），而不是值（~~lreplace $A 0 0~~）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:51:00.097

使用您的技术，您需要更改`incr`命令：

```
% set a {a b c e f g h}
a b c e f g h
% for {set i 1} { $i < [llength $a] } {incr i 2} {lappend c [lindex $a $i]}
% puts $c
b e g
% 
```

# entity-framework - 将实体属性映射到不同的表

> ID：13691317
> 
> 赞同：1
> 
> 时间：2012-12-03T20:40:35.880
> 
> 标签：entity-framework, ef-code-first

我有两个实体：

```
public class User 
{
   public int Id { get; set; }
   public string UserName { get; set; }
}

public class Product 
{
   public int Id { get; set; }
   public string Name { get; set; }
   public string CreatedUserName { get; set }
} 
```

我的数据库模式在`Products`表中包含一个指向表中`Id`列的外键`Products`。我需要一种方法来告诉实体框架导航外键并获取属性`UserName`列的值。`CreatedUserName`

这可能吗？我不希望产品拥有整个用户实体。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-23T15:17:04.563

我正在研究同样的事情，发现了一种称为“实体拆分”的技术 [http://www.deliveron.com/blog/post/Entity-Splitting-in-Code-First-Entity-Framework.aspx](http://www.deliveron.com/blog/post/Entity-Splitting-in-Code-First-Entity-Framework.aspx)

因此，根据您的代码，您可以执行以下操作：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity()
        // Map to the Product table
        .Map(map =>
        {
            map.Properties(p => new {
                p.Id,
                p.Name
            });

            map.ToTable("Product");
        })
        // Map to the User table
        .Map(map =>
        {
            map.Properties(p => new {
                p.CreatedUserName
            });

            map.ToTable("User");
        });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T10:51:02.683

> 这可能吗？我不希望产品拥有整个用户实体。

不，除非你想为你的产品做一个数据库视图。您尝试映射的不再是真实实体。它更像是一个视图模型，那么为什么不使用投影呢？

```
var productView = context.Products
                         .Where(p => p.Id == ...)
                         .Select(p => new ProductView {
                             Id = p.Id,
                             Name = p.Name,
                             CreatedUserName = p.User.UserName
                         }); 
```

# objective-c - 核心情节：X轴标签卷曲

> ID：13691323
> 
> 赞同：0
> 
> 时间：2012-12-03T20:41:06.707
> 
> 标签：objective-c, ios, core-plot, xcode4.5

我正在向我的应用程序添加散点图，并且我想在 X 轴标签上显示包含在数组 cogsetUsed （即自行车齿轮组）中的项目。项目的数量可以从 8 到 11。

我得到的是以下内容：

![屏幕截图](../Images/b6e97b2114f931b1327f2903da22de73.png)

这是一段代码：

```
CPTGraph *graph = self.hostView.hostedGraph;
CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;

CPTXYAxis *x = axisSet.xAxis;

x.visibleRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromInteger(0) length:CPTDecimalFromInteger(12)];
x.labelingPolicy = CPTAxisLabelingPolicyNone;
x.labelTextStyle = axisTextStyle;
x.majorTickLineStyle = axisLineStyle;
x.majorTickLength =4.0f;
x.tickDirection =CPTSignNegative;
CGFloat recordCount = [cogsetUsed count];
NSMutableSet *xLabels =[NSMutableSet setWithCapacity:recordCount];
NSMutableSet *xLocations = [NSMutableSet setWithCapacity:recordCount];
NSInteger i =0;
for (NSString *sprocket in cogsetUsed) {
    CPTAxisLabel *label = [[CPTAxisLabel alloc] initWithText:sprocket  textStyle:x.labelTextStyle];
    CGFloat location = i++;
    label.tickLocation = CPTDecimalFromCGFloat(location);
    label.offset =x.majorTickLength;
    if (label) {
        [xLabels addObject:label];
        [xLocations addObject:[NSNumber numberWithFloat:location]];
    }
}
x.axisLabels = xLabels;
x.majorTickLocations = xLocations; 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T01:07:16.030

Core Plot 不能防止标签之间的冲突。不要求标记每个刻度线。由于您无论如何都要制作自定义轴标签，因此不要标记每个刻度位置。看起来您可以每隔三到四次标记一次以获得良好的外观。

# javascript - 如何使用延迟值检查 ajax 是完整还是失败？

> ID：13691325
> 
> 赞同：0
> 
> 时间：2012-12-03T20:41:28.553
> 
> 标签：javascript, jquery, ajax

我如何检查并等待服务器延迟以完成保存功能，该功能返回一个 ajax 对象 jqxhr，我想在执行其他任何操作之前检查 ajax 请求是否完成。

注意：保存功能成功，完成错误等。我想在我做任何事情之前确保它完成，这样当我使用 jqxhr.status 时我就会得到未定义。

```
 $(document).ready(function() { 
        $(function() {
            $("#save").click(function() {

             save().then(function(jqxhr){// check status...

                    alert(" jqxhr status " + jqxhr.status); <--getting undefined first
                    //200 for success
                    var stat = jqxhr.status;
                    //alert(" inside 200 status "+stat);
                    if (stat == 200) {
                        console.log("inside 200");

                        alert(" inside 200 status " + stat); 

                    }
                    if (stat == 400) {
                        console.log("inside 400");
                        alert(" inside 400 status " + stat);

                    } else {

                        alert(" inside 200 status " + stat);
                    }

                });

            });
        });
    });​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:44:51.407

save() 函数（实际上只是一个 ajax 调用）返回一个 promise，因此您可以使用 then() 链接您的代码：

```
save().then(function(jqxhr){// check status...}); 
```

# java - 检查字符串是否包含 ArrayList 中的单词之一

> ID：13691330
> 
> 赞同：1
> 
> 时间：2012-12-03T20:41:51.533
> 
> 标签：java, string, algorithm, arraylist, contains

我正在开发一个以 HTML 格式输出词汇表术语和定义的程序，我想根据我正在检查的定义是否有关键字来改变输出。为此，我有一个 ArrayList 包含我正在寻找的所有关键字，并且我试图使用 foreach 循环，但它并没有真正正常工作。有一个更好的方法吗。有人可以给我任何指示吗？我觉得应该没那么难。使用 HTML 位，我试图在关键字（关键字应该是 HREFED）之前输出前导词，然后继续检查定义中的更多关键字。

顺便说一句：checkValues 是我的 ArrayList，valueTwo 是定义。

这是我到目前为止所拥有的：

```
 for(String getTerm : checkValues){
                    String correct = getTerm + " ";

                if (valueTwo.contains(correct)) {

                int foundTermPosition = valueTwo.indexOf(correct);
                lead = valueTwo.substring(0, foundTermPosition-1);
                index = valueTwo.length() - lead.length();

                leftOver = valueTwo.substring(foundTermPosition+correct.length(), valueTwo.length());

                out.write(lead);

                out.write("<A HREF=\"#" + correct + "\">" + correct + "</A>");

                out.write(leftOver + "\n");

                }

              else
              {
                out.write(valueTwo);

              }

       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:07:26.460

我不能对 dreamcrash 的帖子发表评论，因为我没有代表在评论中发帖，但我认为他的观点是避免将“high”、“hip”等词视为“hi”这个词。空间会强制执行这一点，对吗？我并不是说这是最好的方法，因为它可能会导致标点符号出现问题（例如“hi”），但我认为这是他这样做的原因。如果我错了，请纠正我。

另外，回答问题。我相信 indexOf 也可以将起点作为传入的第二个值。您可以将最近找到的发生位置（foundTermPosition）设置为继续循环的起点。所以...

```
 ArrayList<Integer> foundTermPositions;   
    int startingPoint = 0;     

    while(valueTwo.indexOf(correct , startingPoint) != -1) {
         foundTermPositions.add(valueTwo.indexOf(correct);
         startingPoint = valueTwo.indexOf(correct, startingPoint) + correct.length();  
    } 
```

对 ArrayList 中的每个项目执行其余代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T01:10:06.513

编辑：在您解释之后，您要做的是：

```
String valueTwoWords [] = valueTwo.split(" "); // if value = "I went" 
                                               // valueTwoWords = ["I","went"]
for(String getTerm : checkValues)
 {
    for(int i = 0; i < valueTwoWords.length(); i++)
    {
       if(valueTwoWords[i].compareTo(getTerm) == 0) // If the words are the same.
       {
            int foundTermPosition = valueTwo.indexOf(getTerm); 
            lead = valueTwo.substring(0, foundTermPosition-1);
            index = valueTwo.length() - lead.length();

            leftOver = valueTwo.substring(foundTermPosition+getTerm.length(), valueTwo.length());

            out.write(lead);
            out.write("<A HREF=\"#" + getTerm + "\">" + getTerm + "</A>");
            out.write(leftOver + "\n");
            i = valueTwoWords.length() + 1; // getting out of the cycle.
       }
     }
   } 
```

* * *

您不应该在字符串中添加空格：

```
String correct = getTerm + " "; 
```

尝试直接在字符串上进行比较：

```
if (valueTwo.contains(getTerm)) 
```

如果您有以下字符串：

```
 String s1 = "hi";
    String s2 = "hi";
    String s3 = "hi "; 
```

这`s1.contains(s2));`将返回`true`但`s1.contains(s3));`会返回`false`。

如果您的目标是查看两个单词是否相同，您应该使用方法`compareTo`而不是方法包含。

**相比于**

```
public int compareTo(Object o) 
```

> 将此字符串与另一个对象进行比较。如果 Object 是 String，则此函数的行为类似于 compareTo(String)。否则，它会抛出 ClassCastException（因为字符串只能与其他字符串相比较）。

注意：

**回报：**

> 如果参数是按**字典顺序等于**该字符串的字符串，则**值为 0**；如果参数是按 **字典顺序大**于此字符串的字符串，则值**小于 0 ；**如果参数是按**字典顺序小**于此字符串的字符串，则值**大于 0 。**（[来源](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#compareTo%28java.lang.Object%29)）

 ******因此，如果相等，则for`string1`和将返回 0。`string2` `string1.compareTo(string2)`如果这是您想要的而不是做：

```
if (valueTwo.compareTo(getTerm) == 0) 
```

最后，如果您的对象只是检查 valueTwo 是否在 ArrayList 上一次，您可以使用

```
if(checkValues.contains(valueTwo))
// do something 
```******

# c - 如何在缓存友好的代码中找到未命中率？

> ID：13691334
> 
> 赞同：3
> 
> 时间：2012-12-03T20:42:13.493
> 
> 标签：c, caching, multidimensional-array

```
int sumarrayrows(int a[M][N])
{
    int i, j, sum = 0;
    for (i = 0; i < M; i++)
        for (j = 0; j < N; j++)
            sum += a[i][j];
    return sum;
} 
```

我想知道如何找到任何缓存友好代码的未命中率，并测量缓存或缓存块的大小，如果是的话，如何找到它的大小。

更新我想出了如何找到未命中率

由于这使用了 4 个字节，因此有 25% 的机会发生未命中率 a[0] = M a[1] = H a[2] = H a[3] = H

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:08:37.807

取决于你的平台。大多数现代 CPU 都有硬件性能计数器，可能用于计算缓存未命中数，但访问这些计数器可能会很尴尬。例如，Windows 通常希望您编写内核模式驱动程序。

您最好获得一些不错的性能分析软件并通过它运行您的代码。

# java - 添加计时器并显示标签文本

> ID：13691339
> 
> 赞同：0
> 
> 时间：2012-12-03T20:42:33.560
> 
> 标签：java, swing, timer, jlabel

我有一个 JLabel。最初我为它设置了一些文本。

```
JLabel j = new JLabel();
// set width height and position

j.setText("Hello"); 
```

我只希望文本 Hello 显示 5 秒。然后我希望显示文本再见。

我怎么能这样做。

我的作品；但我知道这是错误的，因为它一次只执行 1 个 if-else 块。我想我需要一个计时器或计数器。让这个工作。帮助 ？

```
long time = System.currentTimeMillis();

if ( time < (time+5000)) { // adding 5 sec to the time
    j.setText("Hello");

} else {
    j.setText("Bye");

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:47:17.673

Swing 是一个事件驱动的环境，你需要理解的最重要的概念之一是你永远不能以任何方式阻塞事件调度线程（包括但不限于循环、I/O 或`Thread#sleep`）

话虽如此，有一些方法可以实现你的目标。最简单的就是通过`javax.swing.Timer`类。

```
public class TestBlinkingText {

    public static void main(String[] args) {

        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new BlinkPane());
                frame.setSize(200, 200);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });

    }

    protected static class BlinkPane extends JLabel {

        private JLabel label;
        private boolean state;

        public BlinkPane() {
            label = new JLabel("Hello");
            setLayout(new GridBagLayout());

            add(label);
            Timer timer = new Timer(5000, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent ae) {
                    label.setText("Good-Bye");
                    repaint();
                }
            });
            timer.setRepeats(false);
            timer.setCoalesce(true);
            timer.start();
        }
    }
} 
```

查看

*   [事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)
*   [如何使用摆动计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

了解更多信息

# jquery - 我在循环中收到一个未定义的错误

> ID：13691340
> 
> 赞同：0
> 
> 时间：2012-12-03T20:42:40.193
> 
> 标签：jquery, html

下面我使用了一个 for 循环来遍历每个问题：

```
for (var i=0;i<=questions;i++){   
    if ($("[class*=q" + i + "_mark]").length == 1) {
        var bold_marks='<strong>0</strong>';
        var t_marksHtml = t_marks.val();
        $("[class*=q" + i + "_mark]").val(t_marksHtml).attr('readonly', true);
    }                    
} 
```

现在我想做的是创建一个验证函数，以便它通过每个问题和每个问题中的每个元素进行验证，但问题是我试图使用 foreach 函数循环遍历每一行，如下所示：

```
function validation() {

    var alertValidation = "";
    var _qid = "";
    var _msg = "";
    var marks = parseInt($("[class*=q" + i + "_mark]").text()); 

    _qid = $(".q"+questionno+"_ans_org").text();
    _msg = "You have errors on Question Number: " + _qid + "\n";

$("[class*=q" + i + "_mark]").each(function() {

if (!this.value) {
    alertValidation += "\n\u2022 You have not entered in a value in the Indivdiaul Marks textbox all your Answers\n";
}

if (alertValidation != "") {
    return false; //Stop the each loop 
}
});    

     $(".q"+questionno+"_ans_org").each(function(){

if($("[class*=q" + i + "_mark]").text() < '0')
{

 alertValidation = "Your Total Marks Remaining does not equal 0 \n\n\u2022 You Need To Remove " + Math.abs(marks) +  " Marks";   
}

        else if($("[class*=q" + i + "_mark]").text() > '0')
{

 alertValidation = "Your Total Marks Remaining does not equal 0 \n\n\u2022 You Have " + marks +  " Marks Remaining";   
}

            if (alertValidation != "") {
                return false; //Stop the each loop 
            }

});

    if (alertValidation != "") {
        alert(_msg + alertValidation);
        return false;
    }

    return true;
} 
```

显然因为我使用的是 foreach 方法，所以`i`未定义。现在我的问题是，首先，如果我对上面的验证函数使用 foreach 循环或 for 循环会更好吗？有人知道如何修复上面的代码，这样代码才能正常工作，这样我就不会得到`i`未定义的错误？

下面是html代码：

```
<table border='1' id='markstbl'>
<thead>
<tr>
<th class='answermarksth'>Marks per Answer</th>
<th class='totalmarksth'>Total Marks</th>
<th class='noofmarksth'>Marks Remaining</th>
</tr>
</thead>
<tbody>

<tr class="questiontd">
<td class="answermarkstd">
<input class="individualMarks q1_mark_0"  q_group="1" name="answerMarks[]" id="individualtext" type="text" />
</td>
<td class="totalmarkstd" rowspan="2">6</td>
<td class="noofmarkstd q1_ans_text"  q_group="1" rowspan="2"><strong>5</strong></td>
</tr>

<tr class="questiontd">
    <td class="answertd" name="answers[]">D</td>
<td class="answermarkstd">
<input class="individualMarks q1_mark_0"  q_group="1" name="answerMarks[]" id="individualtext" type="text" />
</td>
</tr>

<tr class="questiontd">
<td class="answermarkstd">
<input class="individualMarks q2_mark_0"  q_group="1" name="answerMarks[]" id="individualtext" type="text" />
</td>
<td class="totalmarkstd" rowspan="1">6</td>
<td class="noofmarkstd q2_ans_text"  q_group="1" rowspan="1"><strong>5</strong></td>
</tr>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:45:19.113

代替

```
$("[class*=q" + i + "_mark]").each(function() { 
```

只需使用

```
$("[class*='q'").each(function(i) { 
```

循环将`i in the $.each`是迭代的当前输入类。

对其他循环也遵循相同的方法..

# javascript - 在这段代码中添加自动播放？

> ID：13691344
> 
> 赞同：-3
> 
> 时间：2012-12-03T20:43:03.167
> 
> 标签：javascript

```
$(document).ready(function() {  
    $('a.link').click(function () {  

        $('#wrapper').scrollTo($(this).attr('href'), 200);
        setPosition($(this).attr('href'), '#cloud1', '0px', '5px', '20px', '30px')
        setPosition($(this).attr('href'), '#cloud2', '0px', '100px', '200px', '400px')
        setPosition($(this).attr('href'), '#cloud3', '0px', '15px', '30x', '45px')
        $('a.link').removeClass('selected');  
        $(this).addClass('selected');
        return false;  
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:54:22.413

你可以这样做：

1.  将行为隔离为一个函数，
2.  调用文档准备好的函数，
3.  将函数分配给 a.link 点击事件。

**代码**

```
 $(document).ready(function() {

    myFunc();

    $('a.link').click( myFunc );

 }

 function myFunc() {

     $('#wrapper').scrollTo($(this).attr('href'), 200);
     setPosition($(this).attr('href'), '#cloud1', '0px', '5px', '20px', '30px')
     setPosition($(this).attr('href'), '#cloud2', '0px', '100px', '200px', '400px')
     setPosition($(this).attr('href'), '#cloud3', '0px', '15px', '30x', '45px')
     $('a.link').removeClass('selected');  
     $(this).addClass('selected');
     return false; 

 } 
```

# makefile - Makefile 中具有多个参数的模式规则

> ID：13691345
> 
> 赞同：1
> 
> 时间：2012-12-03T20:43:07.450
> 
> 标签：makefile

```
%.600x.png: %.svg
    inkscape --export-png=$@ --export-width=600 --export-area-drawing $<

%.300x.png: %.svg
    inkscape --export-png=$@ --export-width=300 --export-area-drawing $< 
```

您将如何避免上述 Makefile 中显示的重复？为了表达我的观点，我将发明一些新的语法。

```
%(1).%(2)x.png: %(1).svg
    inkscape --export-png=$@ --export-width=%(2) --export-area-drawing $< 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T14:28:46.750

原始通配符处理是 Make 的明显缺点之一。这是一种做你想做的事的方法，但它并不完全优雅：

```
define pngrule
%.$(1)x.png: %.svg
    inkscape --export-png=$$@ --export-width=$(1) --export-area-drawing $$<
endef

$(eval $(call pngrule,300))

$(eval $(call pngrule,600)) 
```

请注意命令中的`$$@`and以及语句`$$<`中缺少空格。`call`

如果你有很多这样的宽度，那么删除更多的冗余可能是值得的：

```
WIDTHS := 300 600

$(foreach width,$(WIDTHS),$(eval $(call pngrule,$(width)))) 
```

# c# - C# 相当于 java 的 mail.smtp.sendpartial 属性？

> ID：13691348
> 
> 赞同：1
> 
> 时间：2012-12-03T20:43:14.290
> 
> 标签：c#, .net

我正在寻找相当于 mail.smtp.sendpartial 属性的 C#

[http://javamail.kenai.com/nonav/javadocs/com/sun/mail/smtp/package-summary.html](http://javamail.kenai.com/nonav/javadocs/com/sun/mail/smtp/package-summary.html)

如果设置为 true，并且消息具有一些有效地址和一些无效地址，则仍然发送消息，并使用 SendFailedException 报告部分失败。如果设置为 false（默认值），则如果存在无效（服务器上不存在邮箱）收件人地址，则不会将邮件发送给任何收件人。

```
public static void sendMails(string ptxtSubject, string ptxtBody)
{
    string txtTo = "valid1@aaa.com,valid2@aaa.com,invalid1@aaa.com";
    string txtFrom = "valid@aaa.com";
    string txtSubject = ptxtSubject;
    string txtBody = ptxtBody;

    MailMessage mail = new MailMessage();
    mail.To = txtTo;
    mail.From = txtFrom;
    mail.Subject = txtSubject;
    mail.Body = txtBody;

    try
    {
        SmtpMail.SmtpServer ="smtp.aaa.com";
        SmtpMail.Send(mail);
    }
    catch (Exception ex)
    {
       //log the exception
       throw;  
    }
} 
```

这是我正在使用的 C# 代码，但即使只有一个电子邮件地址无效，它也无法发送电子邮件。

谷歌没有帮助，任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:47:31.923

由于 .NET 不提供 MailAddress.TryParse 并且使用不正确的邮件格式创建 MailAddress 类的新实例引发异常，我建议您使用：

[http://cobisi.com/email-validation/.net-component](http://cobisi.com/email-validation/.net-component)

另一个更丑陋的选择是尝试捕获无效邮件地址的创建/分配。我们在企业邮件程序集中采用这种方式，因为我们不想使用第三方程序集，而且它工作正常。

可以提供帮助的类似问题：

[检查电子邮件地址是否对 System.Net.Mail.MailAddress 有效](https://stackoverflow.com/questions/7027887/check-that-email-address-is-valid-for-system-net-mail-mailaddress)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T22:01:41.780

这里的答案实际上取决于您所说的无效。

从上面的示例中，`invalid1@aaa.com`实际上是一个有效的电子邮件地址。

目前在 C# 中确保您要用于发送电子邮件的电子邮件地址格式有效的唯一方法是尝试通过将字符串地址传递给 MailAddress 实例并捕获`FormatException`，如下所示：

```
string email = "invalid1@aaa.com";
System.Net.Mail.MailAddress address = null;
try
{
    address = new MailAddress(email);
}
catch (FormatException fex)
{
    // do something about it here
} 
```

我怀疑您想知道的是电子邮件收件箱是否确实存在`invalid1@aaa.com`，例如某人在服务器上拥有该地址的帐户，该帐户将能够登录并查看该消息。

简短的回答是您无法验证这一点，如果这确实是它告诉您的内容，我会高度质疑 java 类给您的响应的完整性。如果邮件服务器这样做，对于垃圾邮件发送者来说，攻击服务器以寻找随机、有效的电子邮件地址就太简单了。

如果您想变得更漂亮，您可以验证域“aaa.com”是否存在，但这是您可以确定的范围。

# azure - 带有 A 记录的 Azure Web 角色自定义域名

> ID：13691352
> 
> 赞同：2
> 
> 时间：2012-12-03T20:43:44.360
> 
> 标签：azure, dns, azure-web-roles

我正在使用自定义域名设置 Web 角色。我想支持裸域名，所以我对使用A-Record很感兴趣。

是否有任何关于为 Web 角色设置 A 记录的文档。我确实看到了有关 Azure 网站的文档，但它们不适用于 Web 角色。我是在 Azure 上设置此功能还是通过我的 DNS 提供商完成？

此外，根据我的研究，我了解到需要在自定义域名和我的 Web 角色的虚拟 IP 地址 (VIP) 之间设置 A 记录。我不打算进行任何会删除我的 Web 角色的部署。在这种情况下，针对 VIP 设置 A-Record 是安全的。

VIP 是云服务独有的还是跨多个云服务共享的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:49:57.887

查看 windowsazure.com 上的教程：[为 Windows Azure 云服务或存储帐户配置自定义域名](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/)。本教程解释了 IP 地址的生命周期与部署有关：

> 但是请注意，由于 IP 地址的生命周期与部署相关联，因此如果您需要保留 IP 地址，请务必不要删除您的部署。方便的是，在 Windows Azure 中使用两种升级机制时，给定部署槽（生产或暂存）的 IP 地址会保持不变：VIP 交换和就地升级。

简单地说，不要删除部署以保持相同的 IP 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:03:59.963

我一直在为同样的要求和大量信息而苦苦挣扎。最后，我将我的 A_Record 指向了实例的 VIP，一切似乎都很好。

# oracle - 事务停留在捕获队列中 - Oracle Streams

> ID：13691353
> 
> 赞同：1
> 
> 时间：2012-12-03T20:43:55.150
> 
> 标签：oracle, oracle11g, replication

我使用 Oracle Streams 设置了简单的双向数据库复制。我为此使用了企业管理器。流处于活动状态，并且它们的状态正常。问题是复制非常慢。

发生了什么：

1.  我在机器A上插入。
2.  我检查了但机器B中没有数据。
3.  我在机器 A 上打开了 View Capture Statistics，我的事务位于 Active Streams Transactions List 下（运行时间超过 1 分钟）并且活动时间超过 1000 秒。
4.  我去做一些食物，当我回来时，交易最终被传播到机器 B。

所以看起来事务在某种缓冲区中停留了超过 1000 秒。我怎样才能加快这个过程？我是数据库的新手，所以如果这是一个愚蠢的问题，请原谅我:)。

机器只是 vbox 实例（WinXP + Oracle 11g Enterprise）。

问候。

# actionscript - 如何在actionscript中直接嵌入flv，以便ffmpeg可以从编译的swf转换？

> ID：13691359
> 
> 赞同：1
> 
> 时间：2012-12-03T20:44:14.433
> 
> 标签：actionscript, ffmpeg, flash, mxmlc

我有一个需要嵌入到 swf 中的 flv。我目前正在使用 Embed 标签并使用 NetStream 播放 flv。问题是它似乎没有直接嵌入flv文件，因为ffmpeg没有检测到它。我目前正在使用 mxmlc 进行编译。如果从 Flash Professional 发布，则转换有效。我不能使用 Flash Professional，因为我需要使用命令行。有没有办法在动作脚本中嵌入 FLV 并让 ffmpeg 转换它？

# c - Use of _Noreturn in C11

> ID：13691361
> 
> 赞同：20
> 
> 时间：2012-12-03T20:44:21.920
> 
> 标签：c, c11

> **Possible Duplicate:**
> [What is the point of the Noreturn attribute?](https://stackoverflow.com/questions/10538291/what-is-the-point-of-the-noreturn-attribute)

C11 introduced the [_Noreturn](http://en.wikipedia.org/wiki/C11_%28C_standard_revision%29#Changes_from_C99) attribute to indicate that a function never returns.

Except for documentation value in the source code, what other benefits do the attribute provide, and why would one use it ?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-03T20:48:54.437

If a function calls unconditionally a `_Noreturn` function, the compiler will be able to understand that:

*   the code that follows is dead code, which allows for optimization (it can be removed from the generated binary) and diagnostics - the compiler will be able to emit a "non-reachable code" warnings;

*   most importantly, knowing that the normal flow from the function is interrupted it will be able to avoid spurious warnings about missing return values, uninitialized variables and the like.

    This is particularly important with static code analyzers - the number of false positives given by CLang static analyzer in a biggish application of ours dropped considerably once we marked our `die` function (log a fatal error and terminate the application) as `noreturn`.

There may be also some other optimization available - since the function never returns, there's no need to push the return address on the stack, save the state of the registers and whatever, all that's needed is to pass the arguments and do a `jmp` to the start of the function, without worrying about the return and the post-return cleanup. But of course, since the call is one-shot, the performance to squeeze here is mostly negligible.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-03T21:31:10.763

`__attribute__((noreturn))` or `_Noreturn` is useful for functions like `die()`:

```
static __attribute__((noreturn)) void die(const char *fmt, ...) {
     /* print a formatted error message and exit  */
     exit(EXIT_FAILURE);
}
/* And let's say in main() you would want to exit because of an error but unforunately GCC complains about return value.  */
int main() 
{
    if (!whatever)
         die("a nasty error message goes here\n");
} 
```

And is also used for optimizations as stated.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:49:55.293

It allows additional optimizations to be made by the compiler. Take a look [here](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Function-Attributes.html) at GCC's `noreturn` attribute which it supports for a while now (semantics is probably the same)

# iphone - 如何在不打开应用程序的情况下更改应用程序图标？

> ID：13691369
> 
> 赞同：2
> 
> 时间：2012-12-03T20:44:44.987
> 
> 标签：iphone, objective-c, ios

我已经看到 iPhone Calender 应用程序每天都在更改其图标，以便在 1、2、3、...、29、30 月份拥有天数，我怎样才能让我的应用程序像这样更改图标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:53:34.767

在 iOS 上更改图标是不可能的，除非通过提交更新并在您的应用程序包中包含一个新图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:50:31.403

这很简单： NSApplication 有一个允许更改图标图像的方法： setApplicationIconImage: 。

# javascript - extjs4 从组合框中获取选定的值

> ID：13691375
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:14.543
> 
> 标签：javascript, model-view-controller, extjs, extjs4

好吧，这又让我发疯了。我正在尝试从组合框中获取选定的值，以便可以根据用户选择使用正确的数据更新网格。我该怎么做呢？

我在 MVC 模型中使用 extjs 4。这是我的代码：

我在视口内的初始化：

```
init: function() {
    this.control({
        'viewport > combobox': {
            select: this.onChangeStacker
        }
    });
},

// method with pseudocode of what I want to do
onChangeStacker: function(){

    selected =  getSelection;

   switch selected

    case == stk1

         load stk1

    case == stk2 

         load stkd
}
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:55:27.057

```
this.control({
    'viewport > combobox': {
        change: function(cmp) {
            var value = cmp.getValue();
            .
            .
            .
        }
    }
});​ 
```

文档：

*   [获取值方法](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.ComboBox-method-getValue)
*   [更改事件](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Field-event-change)

工作示例：http: [//jsfiddle.net/kMs86/](http://jsfiddle.net/kMs86/)

# c# - 缩放和图像填充屏幕

> ID：13691378
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:19.973
> 
> 标签：c#, wpf, zooming, transform

我有一个图像控件类，可以放大/缩小，填充屏幕，并执行 1:1 的比例（全部由 4 个不同的按钮控制。但是，当屏幕分辨率大于 1280 x 1024 时，我的填充屏幕和 1： 1比率不做他们应该做的事。

```
public void ZoomActual()
    {
        m_translateTransform.BeginAnimation(TranslateTransform.XProperty, CreateAnimation(0));
        m_translateTransform.BeginAnimation(TranslateTransform.YProperty, CreateAnimation(0));
        m_zoomFactor.BeginAnimation(ScaleTransform.ScaleXProperty, CreateAnimation(1));
        m_zoomFactor.BeginAnimation(ScaleTransform.ScaleYProperty, CreateAnimation(1));
    } //1:1 ratio button control

    /// <summary>
    /// This function is used to fill the screen with the current picture on the zoomandpan Control
    /// </summary>
    public void ZoomFit()
    {
        double screen_height = ActualHeight;
        double screen_width = ActualWidth;

        double image_width = m_source_child.ActualWidth;
        double image_height = m_source_child.ActualHeight;

        double image_ratio = image_width / image_height;
        double screen_ratio = screen_width / screen_height;

        if (image_width > image_height)
        {
            m_translateTransform.BeginAnimation(TranslateTransform.XProperty, CreateAnimation(0));
            m_translateTransform.BeginAnimation(TranslateTransform.YProperty, CreateAnimation(0));
            m_zoomFactor.BeginAnimation(ScaleTransform.ScaleXProperty, CreateAnimation(1 / screen_ratio * image_ratio)); //width
            m_zoomFactor.BeginAnimation(ScaleTransform.ScaleYProperty, CreateAnimation(1 / screen_ratio * image_ratio)); //height
        }
        else
        {
            m_translateTransform.BeginAnimation(TranslateTransform.XProperty, CreateAnimation(0));
            m_translateTransform.BeginAnimation(TranslateTransform.YProperty, CreateAnimation(0));
            m_zoomFactor.BeginAnimation(ScaleTransform.ScaleXProperty, CreateAnimation((screen_ratio * image_ratio))); //width
            m_zoomFactor.BeginAnimation(ScaleTransform.ScaleYProperty, CreateAnimation((screen_ratio * image_ratio))); //height
        }
    } //fillscreen button control

    /// <summary>
    /// This function is used to control the animations of the ZoomandPan. Animations consist of Zooming in
    /// and out of a picture and allows panning of the displayed image
    /// </summary>
    /// <param name="a_toValue">used for zoom in percentage [currently set at: 1.5 (150%)]</param>
    /// <returns>Animation values image</returns>
    private DoubleAnimation CreateAnimation(double a_toValue)
    {
        var dubAni = new DoubleAnimation(a_toValue, new Duration(TimeSpan.FromMilliseconds(300)))
        {
            AccelerationRatio = 0.1,
            DecelerationRatio = 0.9,
            FillBehavior = FillBehavior.HoldEnd
        };
        dubAni.Freeze();
        return dubAni;
    } //Animation value setter

    /// <summary>
    /// DoZoom is used for executing the physical zoom of the picture, enlarges or shrinks image depending
    /// on CreateAnimation values
    /// </summary>
    /// <param name="a_deltaZoom">Determinded to be + or -. can be set by mousewheel and/or buttons. Determines Zoom in/out</param>
    /// <param name="a_mousePosition">Current positon of mouse</param>
    /// <param name="a_physicalPositon">refrence to last area mousePosition was on image</param>
    private void DoZoom(Double a_deltaZoom, Point a_mousePosition, Point a_physicalPositon)
    {
        double currentZoom = m_zoomFactor.ScaleX;
        currentZoom *= a_deltaZoom;
        if (currentZoom < MinZoom)
            currentZoom = MinZoom;
        else if (currentZoom > MaxZoom)
            currentZoom = MaxZoom;

        m_translateTransform.BeginAnimation(TranslateTransform.XProperty, CreateAnimation(-1 * (a_mousePosition.X * currentZoom - a_physicalPositon.X)));
        m_translateTransform.BeginAnimation(TranslateTransform.YProperty, CreateAnimation(-1 * (a_mousePosition.Y * currentZoom - a_physicalPositon.Y)));

        m_zoomFactor.BeginAnimation(ScaleTransform.ScaleXProperty, CreateAnimation(currentZoom));
        m_zoomFactor.BeginAnimation(ScaleTransform.ScaleYProperty, CreateAnimation(currentZoom));
    } //Zoom animation 
```

当我这样做时，它没有做它应该做的事情，我的意思是：如果我的屏幕分辨率为 1280 x 1024 或更低，填充屏幕将填满屏幕，1:1 的比例将给出图片的实际大小。任何大于 1280 x 1024 的分辨率都会导致填充屏幕控件使图像更小（在画布内），而不是将整个图像放在窗口上。并且 1:1 比例控制将在右侧有一个小间隙，即空白区域。非常感谢提供的任何帮助，我对图像控制有点陌生，所以这看起来很微不足道。抱歉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:47:08.737

我假设您希望在保持适当纵横比的同时填充**ZoomFit函数。**这就是我通常这样做的方式：

```
double ratio = Math.Min(destArea.Width / imageSize.Width, destArea.Height / imageSize.Height);

double imageWidth = imageSize.Width * ratio;
double imageHeight = imageSize.Height * ratio; 
```

您应该能够将比率直接提供给 ScaleTransform。

如果您想缩放以填充和保持纵横比但修剪多余部分，您只需使用 Math.Max 而不是 Math.Min 来计算比率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T23:42:43.093

我认为你的基本问题是你有一些不稳定的数学来计算`ZoomFit`. 例如，如果您的屏幕纵横比是 1:1，您将始终缩放等于图像纵横比的因子。这意味着 2:1 的图像总是会放大 200%，无论它实际上有多大。

# html - 推特引导视口

> ID：13691379
> 
> 赞同：4
> 
> 时间：2012-12-03T20:45:21.707
> 
> 标签：html, twitter-bootstrap

我继承了一组基于 Twitter Bootstrap 的网站模板。在`<head>`以下元标记中出现：

```
<meta name="viewport" content="width=device-width"> 
```

但根据文档，它应该是：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

有人可以解释这两者之间的区别是什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T20:50:47.263

它们只是不同的属性，您可以添加一个或多个。来自 Mozilla 的网站：

> **width**属性控制视口的大小。它可以设置为特定数量的像素，例如 width=600 或特殊值 device-width 值，即屏幕宽度（以 CSS 像素为单位，比例为 100%）。

第二个控制页面显示时的缩放：

> **initial-scale**属性控制页面首次加载时的缩放级别。

此外，您还可以使用**maximum-scale**、**minimum-scale**和**user-scalable**属性来进一步控制用户如何放大或缩小页面。

这是必要的，因为移动设备具有非常不同的像素密度，因此通过指定诸如此类的属性，页面将在 iPhone、Galaxies、诺基亚等设备中以几乎相同的物理尺寸呈现，而不管屏幕密度如何。

[更多信息在这里（Mozilla 页面）](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)

# python - Django-Debug-toolbar：没有名为 setuptools 的模块

> ID：13691380
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:21.663
> 
> 标签：python, django, installation

我正在尝试安装 Django-Debug-toolbar。

我已经下载了 .tar 文件并完成了两次提取。然后我将提取的文件夹放在某个地方并完成了我一直在做的事情，即 cd 到包含 setup.py 的文件夹，然后执行

```
python setup.py install 
```

我收到错误“没有名为 setuptools 的模块”。我真的需要下载并安装其他东西来安装它吗？我已经以这种方式安装了所有其他软件包。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:47:57.943

问题是您安装了 setuptools 或分发，但推荐的步骤是安装分发，因为 setuptools 不适用于 Python 3 及更高版本，自 Django 1.5 起实验性可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:56:45.540

好吧，我安装了分发[http://pypi.python.org/pypi/distribute](http://pypi.python.org/pypi/distribute)然后能够安装调试工具栏，它现在可以工作了。

# objective-c - UITableView 上的 ScrollView 错误

> ID：13691385
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:34.810
> 
> 标签：objective-c, uitableview, uiscrollview

我有一个似乎无法修复的错误。我有一个在 ipad 上显示专辑的表格视图。如果我触摸并拖动背景（列表下方），我可以滚动表格视图，但如果我拖动表格视图单元格本身，则不能滚动。

我有一个附件按钮，可以在表格单元格上使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:50:09.633

尝试：

```
tableView.delaysContentTouches = YES; 
```

# configurationmanager - ConfigurationManager 将意外项目添加到 system.web 部分

> ID：13691389
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:53.860
> 
> 标签：configurationmanager, system.web

在 Web 安装程序自定义操作期间，我正在修改 Web.config 文件上的连接字符串。

这是正在做这项工作的代码片段

```
ExeConfigurationFileMap map = new ExeConfigurationFileMap();
map.ExeConfigFilename = path;

Configuration config = ConfigurationManager.OpenMappedExeConfiguration(map, System.Configuration.ConfigurationUserLevel.None);

var connectionsection = config.ConnectionStrings.ConnectionStrings;

ConnectionStringSettings connectionstring = connectionsection[connStringName];
if (connectionsection != null)
    connectionsection.Remove(connStringName);

connectionstring = new ConnectionStringSettings(connStringName, newValue, "System.Data.SqlClient");
connectionsection.Add(connectionstring);

config.Save(ConfigurationSaveMode.Modified, true);
ConfigurationManager.RefreshSection("connectionStrings"); 
```

到目前为止一切顺利，这实际上是有效的，但它也在“system.web”部分添加了一些项目，这些项目导致了错误：

```
Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: It is an error to use a section registered as allowDefinition='MachineOnly' beyond machine.config.
Source Error: 

Line 46:     <authorization />
Line 47:     <clientTarget />
Line 48:     <deployment />
Line 49:     <deviceFilters />
Line 50:     <fullTrustAssemblies /> 
```

当我手动删除 ConfigurationManager 添加的某些部分时，`<deployment />`错误就消失了。所以我只需要 ConfigurationManager 不创建这些部分。怎么做？`<protocols />``<processModel />`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:07:15.847

在 ConfigurationManager 弄脏文件后，快速修复将在 XML 中手动清除，但我认为这不是最合适的

```
config.Save(ConfigurationSaveMode.Modified, true);

var document = XDocument.Load(configPath);
var systemWeb = document.Root.Element("system.web");

XElement element;
element = systemWeb.Element("deployment");
if (element != null)
    element.Remove();

element = systemWeb.Element("protocols");
if (element != null)
    element.Remove();

element = systemWeb.Element("processModel");
if (element != null)
    element.Remove();

document.Save(configPath); 
```

# java - 自动化视频快照

> ID：13691390
> 
> 赞同：1
> 
> 时间：2012-12-03T20:45:54.777
> 
> 标签：java, javafx-2, video-capture, snapshot

如何使用 Java 自动化视频快照？

下面是我的尝试。不幸的是，seek 命令似乎不起作用，因为无论视频在哪里，[100,100] 处像素的颜色都保持不变。

我需要的是一个可以创建视频快照的应用程序（最好不需要 GUI）。

```
import javafx.application.Application;
import javafx.fxml.FXML;
import javafx.scene.SnapshotParameters;
import javafx.scene.image.WritableImage;
import javafx.scene.media.Media;
import javafx.scene.media.MediaPlayer;
import javafx.scene.media.MediaView;
import javafx.scene.paint.Color;
import javafx.stage.Stage;
import javafx.util.Duration;

public class VideoController extends Application {
private MediaPlayer media;
int posun = 100; // milisecs
int pocatek = 0; // milisecs
Duration cas = new Duration(0);

@Override
public void start(Stage scene) throws Exception {
    String uri = "http://download.oracle.com/otndocs/products/javafx/arth_512.flv";
    final Media medium = new Media(uri);
    media = new MediaPlayer(medium);
    final MediaView video = new MediaView(media);
    // videoPane.getChildren().add(video);
    media.setOnReady(new Runnable() {

        @Override
        public void run() {
            media.play();
            for (int i = pocatek; i < (int) medium.getDuration().toMillis(); i += posun) {
                System.out.println(i);
                cas = new Duration(i);
                media.seek(cas);

                WritableImage wi = new WritableImage(1000, 1000);
                video.snapshot(new SnapshotParameters(), wi);

                Color c = wi.getPixelReader().getColor(100, 100);
                System.out.println(c);
                // video.snapshot(params, image);
            }
        }
    });
}

    public static void main(String[] args) {
    launch();
    }
} 
```

输出：

```
0
0xffffffff
...
640000
0xffffffff
...
670000
0xffffffff 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:22:27.243

我不认为这是可能的。FX 媒体 API 面向播放而不是数据操作，如果没有屏幕上的实际媒体，您将无法轻松加载图片数据。

鉴于您不想要 UI，FX 没有实际工作，您可能希望通过其他工具解决您的任务，例如`ffmpeg`，请参阅[ffmpeg 以获取屏幕截图](https://stackoverflow.com/questions/3068424/ffmpeg-to-get-screenshot)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T21:14:17.760

不建议将 JAVAFX 用于此任务。更好的解决方案是使用 XUGGLER。本教程中描述了确切的情况：

[http://www.javacodegeeks.com/2011/02/xuggler-tutorial-frames-capture-video.html](http://www.javacodegeeks.com/2011/02/xuggler-tutorial-frames-capture-video.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-12T20:08:43.127

1.  创建一个 mediaView ： new MediaView(mediaplayer)

2.  使用当前时间属性并添加一个更改监听器**：每次播放时长更改时都会调用监听器

3.  在这个监听器中，我们将拍摄 mediaView 的快照。
    **示例**

    ```
     player.currentTimeProperty().addListener(new ChangeListener<Duration>() {
        @Override
        public void changed(ObservableValue<? extends Duration> arg0, Duration arg1, Duration arg2) {
            // TODO Auto-generated method stub

            WritableImage write = new WritableImage(media.getWidth(),media.getHeight());
            mview.snapshot(new SnapshotParameters(),write);
            //Now Write is Your current image 

        }
    }); 
    ```

# jboss - 带有 Seam3 的面

> ID：13691391
> 
> 赞同：0
> 
> 时间：2012-12-03T20:45:56.457
> 
> 标签：jboss, seam, java-ee-6, cdi, seam3

我有 1 `Entity`with 1 `Named`Bean with `ConversationScope`，我创建了一个`jsf form`带保存按钮，我的问题是，为什么当我的表单使用@injected 发布我的实体时，实体 bean 的属性（ArticuloController 属性）没有被注入。与 cdi 一起存在类似于`@in`seam2 的注释 to populate `@inject` `Entity entity`。

这是我的源代码：

```
@Entity
@Named("articulo")

public class Articulo implements Serializable {
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "articulo_seq")
    @SequenceGenerator(name = "articulo_seq", sequenceName = "articulo_seq")
    private Integer articulo;

    private String descripcion="";

//my action class

@Named("articuloController")
@ConversationScoped

public class ArticuloController implements Serializable {

    @Inject
    private Articulo articulo;

    @Inject
private Messages messages;

@Begin
public String init() {
    messages.info("init conversation");
    //this values is not show in the jsf form
    articulo.setDescripcion("complete descripcion");
    articulo.setPrecio(new BigDecimal(0));
    return null;
}

public String save() {
        //the values of the properties is not the values filled by user, 
        //but is the values filled by init method
        System.out.println("save!" + articulo.getDescripcion()
            + articulo.getPrecio() + " " + id);

    return null;
}

my jsf page is

<f:metadata>
            <f:viewParam name="id" value="#{articuloController.id}" />
            <s:viewAction action="#{articuloController.init}" />
        </f:metadata>
        <h:form>
        <h:panelGrid columns="3" id="panel">

            <h:outputLabel value="Descripcion" />

            <h:inputText value="#{articulo.descripcion}" id="descripcion"
                required="true" label="Descripción" />

            <rich:message for="descripcion" />

            <h:outputLabel value="Precio" />

            <h:inputText value="#{articulo.precio}" id="precio" required="true"
                label="Precio" />

            <rich:message for="precio" />

            <h:commandButton value="Guardar" action="#{articuloController.save}" />

        </h:panelGrid>
</h:form> 
```

更新：我正在使用 seam3 3.1.0.Final

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T14:10:40.093

以这种方式混合 JPA 和 CDI 是一个非常糟糕的主意。如果你这样做，事情将无法正确保存，而且你到处都会有例外。您需要做的是从实体中删除 @Name 并为其创建生产者。您还需要向生产者添加范围注释，可能请求或对话可以正常工作。

# jquery - Jquery Hover Opacity，我在这里缺少什么？

> ID：13691392
> 
> 赞同：3
> 
> 时间：2012-12-03T20:45:55.917
> 
> 标签：jquery, hover, opacity

我对我的 jquery 知识有点（更像是非常）生疏。出于某种原因，当绿色框悬停在上面时，我无法弄清楚我在这里缺少什么来使蓝色框消失。

剧本：

```
 $(document).ready(function() {
    $(".hover-text").hover({
    $(".hover-hide").animate({
        opacity: 0.4,
    }, 500);
    });​ 
```

的HTML：

```
 <div class="hover-hide">
    <div class="hover-text">
        BLAH
    </div>
    </div> 
```

的CSS：

```
 .hover-hide{
    width:200px;
    height:200px;
    background-color:blue;
    padding:30px;
    }
    .hover-text{
    color:white;
    background-color:green;
    padding:10px;
    width:auto;
    margin-top:20px;
    }​​ 
```

非常感谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T20:49:13.050

的第一个参数`.hover`是回调函数，应该是`$('.hover-text').hover(function(){`. [在这里](http://jsfiddle.net/TsW6n/)拉小提琴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:50:40.913

您错过了通话`function`后的内容。`.hover`此外，您在结尾处缺少右括号和括号`.ready();`

应该：

```
$(document).ready(function() {     

    $(".hover-text").hover( function() {     
        $(".hover-hide").animate({ opacity: 0.4, }, 500);     
    });

}); 
```

这是一个小提琴：http: [//jsfiddle.net/TMZhJ/](http://jsfiddle.net/TMZhJ/)

# ruby-on-rails-3 - has_one 在 has_many

> ID：13691393
> 
> 赞同：0
> 
> 时间：2012-12-03T20:46:05.857
> 
> 标签：ruby-on-rails-3, activerecord

我有一个正在与之斗争的协会。我有一个部门模型，它可以有很多员工，其中一位是经理。

我需要能够打电话。

Department.staff - 并获取包括经理在内的所有员工的集合。Department.manager - 并获得经理。

User.department - 并获取用户部门，无论他们是员工还是经理。User.is_manager - 并获得一个关于他们是否管理部门的布尔值。User.manages - 获取他们管理的部门。

成立这个协会最好的办法是什么？我目前已经开始这样的事情：

```
class User < ActiveRecord::Base
      belongs_to :department
      has_one :manages, :class_name => 'Department', :foreign_key => :manager_id
end

class Department < ActiveRecord::Base
      belongs_to :manager, :class_name => "User"
      has_many :staff, :class_name 'Users'
end 
```

我遇到的问题是，我必须将经理添加为经理和员工，这感觉有点笨拙 - 但也许我很挑剔？

谁能建议一些更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:03:22.450

Try this association:

```
class Department < ActiveRecord::Base
  has_many :staffs, class_name: "User"
  has_one :manager, class_name: "User", foreign_key: "manager_id"
end

class User < ActiveRecord::Base
  belongs_to :department
end 
```

Make sure your `User` table has a column called `manager_id`, and a column called `department_id`. If you have a boolean column called `manager` in your `User` table, you will have a method `manager?` to check whether user is manager or not.

To do what you want:

```
@department = Department.find(1) # Find department with id = 1
@department.staffs # Get all staffs of department

@department.manager.name # Get name of manager of department

@user = User.find(1) # Find user with id = 1
@user.department.name # Get name of department which user belongs to
@user.manager? # Return value of manager column 
```

# ms-access - 使用任务计划程序运行宏时获取运行时错误“429”ActiveX 组件无法创建对象

> ID：13691397
> 
> 赞同：0
> 
> 时间：2012-12-03T20:46:22.447
> 
> 标签：ms-access, vba

我有这个 VBA 代码用于在我的 Access 数据库中发送电子邮件，并且我还引用了 Microsoft Outlook 14.0 对象库。

当我手动运行代码时，一切正常。但是，当我从 Windows 任务计划运行宏时，访问失败。我收到这条消息：

运行时错误“429”ActiveX 组件无法创建对象

在任务计划程序的“操作”选项卡中，我引用这样的宏：“C:\Program Files\Microsoft Office\Office14\MSACCESS.EXE”“C:\mydata\Database\mydatabase.accdb”/X RunMyMacro

该错误似乎指向此代码，如下面的屏幕截图所示。

***代码：***

```
Dim strEmailBody As String

Sub emailNotification()
Dim oFolder As Outlook.MAPIFolder
Dim oItem As Outlook.MailItem
Dim oOutlook As New Outlook.Application

Dim MoOutlook As Outlook.NameSpace
Set MoOutlook = oOutlook.GetNamespace("MAPI")
Set oFolder = MoOutlook.GetDefaultFolder(olFolderOutbox)
Set oItem = oFolder.Items.Add(olMailItem)
With oItem
.Recipients.Add ("tome@me.com")
.Subject = "my notification"
.Body = strEmailBody
.Importance = olImportanceHigh
.Send
End With
Set oFolder = Nothing
End Sub 
```

***截屏：***

![在此处输入图像描述](../Images/22cdd2ff11a3825d2a81778b2416eba0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:38:35.873

将以下代码放入批处理文件并从 Windows 调度程序运行批处理文件。

```
"C:\Program Files\Microsoft Office\Office14\MSACCESS.EXE" "C:\mydata\Database\mydatabase.accdb" /X RunMyMacro 
```

# html - IE8 向右浮动将图像放在新行上

> ID：13691398
> 
> 赞同：1
> 
> 时间：2012-12-03T20:46:27.820
> 
> 标签：html, css, internet-explorer, web, twitter-bootstrap

我有 3 个由文本和图像组成的链接，除了 IE 8 兼容模式外，它在任何地方都可以使用。有人告诉我这个应用程序的用户使用 IE 8 兼容模式，所以它必须在那个浏览器环境中工作。问题是图像被下拉到下一行。

这是它的样子：http: [//i.imgur.com/2vAAH.png](http://i.imgur.com/2vAAH.png)

这是 IE 8 兼容模式下的样子：http: [//i.imgur.com/VHtQm.png](http://i.imgur.com/VHtQm.png)

这是它在屏幕上的样子：http: [//i.imgur.com/FZNxt.png](http://i.imgur.com/FZNxt.png)

我能够在 jsfiddle 中重现该问题：http: [//jsfiddle.net/dmase05/C6etX/](http://jsfiddle.net/dmase05/C6etX/)

该站点正在使用 Twitter Bootstrap，因此我将其中一些类用于网格和浮动。

**让这更难解决的一件事是，我发现在 IE 8 兼容模式下在 IE 9 中运行 jsfiddle 会显示问题，但是，在 IE 8 兼容模式下运行 IE 10 看起来是正确的。** 我无法访问本机 IE 8 安装，但有人告诉我它在那里看起来不错。

这是 HTML（使用 Bootstrap CSS）：

```
 <div id="divCalendarFooter">
        <div class="row">
             <div class="span3 pull-right">
                <a id="lnkSelectColumns" href="#" role="button" data-toggle="modal" class="pull-right">
               Choose Columns &nbsp;<img src="http://db.tt/cEFFCjw0"/>
                </a>
            </div>
        </div>
        <div class="row">
            <div class="span3 pull-right">
                <a href="#" class="pull-right">
                    Print Calendar &nbsp;<img src="http://db.tt/u94nalQx"/>
                </a>
            </div>
        </div>
        <div class="row">
            <div class="span4 pull-right">
                <a id="aShowPrintByDateRange" href="#" class="pull-right">
                   Print Calendar By Date Range &nbsp;<img src="http://db.tt/u7OxN09k"/>
                </a>
            </div>
        </div>
    </div>​ 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:13:07.300

我在 Internet Explorer 8 的真实副本（在 IE8 标准模式下）中看到了同样的问题。

`img`您可以使用 CSS 将蓝色图标添加为背景图像，而不是使用标签。例如，CSS 看起来像这样：

```
#divCalendarFooter a {
    padding-right: 36px;
    line-height: 32px;
    margin-right: 3px;
}

#lnkSelectColumns {
    background: url(http://db.tt/cEFFCjw0) no-repeat center right;
}

#printCalendar {
    background: url(http://db.tt/u94nalQx) no-repeat center right;
}

#aShowPrintByDateRange {
    background: url(http://db.tt/u7OxN09k) no-repeat center right;
} 
```

这是一个小提琴：http: [//jsfiddle.net/C6etX/6/](http://jsfiddle.net/C6etX/6/)。如您所见，我必须在第二个链接中添加一个 ID。

# c# - SVN 预提交钩子，用于避免提交到特定分支

> ID：13691400
> 
> 赞同：2
> 
> 时间：2012-12-03T20:46:36.667
> 
> 标签：c#, svn

使用 c# 阻止 svn 提交到指定分支的可能方法是什么？如何从 pre-commit 钩子中的参数获取分支的路径？（或获得阻止路径的任何其他建议）

有没有办法使用 svnlook 来查看它修改了哪些文件，也许？

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:23:19.270

当我不得不这样做时，我遵循了本指南： [http ://www.troyhunt.com/2010/02/creating-subversion-pre-commit-hooks-in.html](http://www.troyhunt.com/2010/02/creating-subversion-pre-commit-hooks-in.html)

我编写了一个名为 svnlook 的 C# 应用程序，它被 precommit 钩子触发以检查路径是否被允许。

以下是我的代码，它应该很容易适应您的情况：

```
class Program
{
    static void Main(string[] args)
    {
        var repos = args[0];
        var txn = args[1];

        var log = GetSvnLookOutput(repos, txn, "log");
        var changedPaths = GetSvnLookOutput(repos, txn, "changed");

        var logValidation = GetLogMessageErrors(log.Replace("\r", "").Replace("\n", ""));
        if (logValidation != null)
        {
            Console.Error.WriteLine(logValidation);
            Environment.Exit(1);
        }

        if (log.Contains("Autoversioning commit"))
        {
            // this is an autoversion webdav client, enforce path rules
            var changedPathsValidation = GetFileNameErrors(changedPaths);
            if (changedPathsValidation != null)
            {
                Console.Error.WriteLine(changedPathsValidation);
                Environment.Exit(1);
            }
        }

        Environment.Exit(0);
    }

    private static string GetLogMessageErrors(string log)
    {
        if (string.IsNullOrEmpty(log))
        {
            return "Log message is required.";
        }

        return null;
    }

    private static string GetFileNameErrors(string changedPaths)
    {
        var changeRows = Regex.Split(changedPaths.TrimEnd(), Environment.NewLine);
        foreach (var changeRow in changeRows)
        {
            var filePath = changeRow.Substring(4, changeRow.Length - 4);

            if (filePath.ToLower().Contains("/code/"))
            {
                return "Autoversioning commits are not allowed inside /CODE/ folders. Use a SVN client for this.";
            }
        }
        return null;
    }

    private static string GetSvnLookOutput(string repos, string txn, string subcommand)
    {
        var processStartInfo = new ProcessStartInfo
        {
            FileName = @"svnlook.exe",
            UseShellExecute = false,
            CreateNoWindow = true,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            Arguments = String.Format("{0} -t \"{1}\" \"{2}\"", subcommand, txn, repos)
        };

        var process = Process.Start(processStartInfo);
        var output = process.StandardOutput.ReadToEnd();
        process.WaitForExit();
        return output;
    }
} 
```

# jquery - 在没有命名空间的jquery中触发事件

> ID：13691402
> 
> 赞同：8
> 
> 时间：2012-12-03T20:46:44.763
> 
> 标签：jquery, onclick, namespaces

使用当前版本的 jQuery (1.8.3)，您仍然可以使用以下代码（显示带有和不带有命名空间的单击）：

```
$("span")
    .on("click", function(e) { console.log('click without a namespace'); })
    .on("click.namespace", function(e) { console.log('click with a namespace'); })
    .trigger("click!"); // "click without a namespace" 
```

[JSFiddle](http://jsfiddle.net/RczDZ/7/)

但是，这似乎在 1.9 中被删除了。jQuery 的新版本（测试版）有没有办法复制这个特性？还是我必须像这样创建一个自定义事件：

```
$("span")
    .on("click", function(e) { $(this).trigger("customevent"); })
    .on("click.namespace", function(e) { console.log('click with a namespace'); })
    .on("customevent", function(e) { console.log('"click" without a namespace'); })
    .trigger("customevent"); 
```

[JSFiddle](http://jsfiddle.net/RczDZ/9/)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T22:40:35.680

您可以使用

`.trigger("click.$")`

我们发现这是因为正则表达式

[http://jsfiddle.net/oceog/RczDZ/10/](http://jsfiddle.net/oceog/RczDZ/10/)

# android - Manifest 中的 android:sharedUserId 和 NFC 标签中的 AAR

> ID：13691403
> 
> 赞同：1
> 
> 时间：2012-12-03T20:46:46.277
> 
> 标签：android, nfc, intentfilter, ndef, android-applicationrecord

我正在开发两个具有 NFC 功能的应用程序。Android 应用程序记录很棒。在未安装应用程序时打开 Play 商店是一项很棒的功能。

我想写入`AAR`NFC 标签。这两个应用程序都有捕捉`NDEF_DISCOVERED`意图的活动。`Intent`但他们也会收到应用程序安装更改，如果另一个应用程序已安装，其中一个会禁用捕获 NFC 的活动。

因此，始终只有一个 Activity 可以捕获来自 NFC 标签的意图。这是有保证的。但是，如果我的两个应用程序都没有安装，它什么也不做，因为我现在没有使用 AAR。

我只能提供一份申请的 AAR。当我使用 AAR 时，android 只会将意图发送到该应用程序。即使我的其他应用程序试图捕捉到`IntentFilter`，手机也会打开 Play 商店。

这是该问题的可能解决方案：

我可以在标签中存储唯一的 url，而不是存储 AAR。当我将手机轻触标签时，它会询问该怎么做。打开浏览器还是打开我的活动？如果我的应用程序未安装，我可以将该网页重定向到 Play 商店。这可以工作，但问题是：即使安装了我的应用程序，用户也可以选择浏览器。这样，当该特定用户点击他的手机时，它将始终打开 Play 商店。

最后，我在 Manifest 中遇到了 sharedUserId。如果 Android 操作系统能够基于 AAR 中的 sharedUserId 或某种东西打开应用程序，那就太好了。

你们有什么感想？谢谢你。

# c++ - 制作替换系统库中的函数调用的 DLL 时出现问题

> ID：13691404
> 
> 赞同：1
> 
> 时间：2012-12-03T20:46:46.317
> 
> 标签：c++, windows, opengl

我正在尝试在 Windows 上制作一个假的 opengl32.dll 来捕获 OpenGL 调用。当我将 DLL 与简单的 OpenGL 应用程序放在同一目录中并运行时，我收到此错误：

> 无法在动态链接库 OPENGL32.dll 中定位程序入口点 glMap1f

这很奇怪，因为对于每个 OpenGL 调用，我的代码中都有一个虚拟函数，包括这个。在我的头文件中，我有：

```
void __declspec(dllexport) glMap1f (GLenum target, GLfloat u1, GLfloat u2, GLint stride, GLint order, const GLfloat *points); 
```

并在源文件中：

```
void  glMap1f (GLenum target, GLfloat u1, GLfloat u2, GLint stride, GLint order, const GLfloat *points){} 
```

而且我很确定编译器没有对其进行优化，因为在文本编辑器中查看 DLL，我可以找到文本“glMap1f”。

这可能是什么原因造成的？此外，我不确定如何让 Visual Studio 调试覆盖实际系统 DLL 的 DLL，因此我无法获得更多信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:49:56.567

您可能需要`extern "C"`在 glMap1f 声明之前防止编译器对其使用名称修饰。

# php - 来自 Facebook 粉丝页面的照片

> ID：13691405
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:46:49.537
> 
> 标签：php, facebook

> **可能重复：**
> [如何使用 Facebook 图形 API 检索上传到粉丝页面墙的粉丝照片？](https://stackoverflow.com/questions/5083464/how-to-use-facebook-graph-api-to-retrieve-fan-photos-uploaded-to-wall-of-fan-pag)

我花了一整天的时间来了解如何从 Facebook 粉丝页面获取公开照片。我无法得到它。我正在使用 PHP（实际上是 Yii 框架）。

这是我第一次与 Facebook 打交道。我找到了社交插件，阅读了有关 Graph 和其他 Facebook API 的信息，但我没有得到它。

我有一个粉丝页面（例如[https://facebook.com/Taviemmatiem](https://facebook.com/Taviemmatiem)），我需要从 Facebook 获取照片并将它们显示在另一个网页中。

1.  可能吗？
2.  我应该使用什么技术？
3.  没有任何身份验证是否可能？（粉丝专页是公开的）

请给我一些提示和关键字，之后我可以自己谷歌。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:56:23.180

我将从[FQL Explorer](https://developers.facebook.com/tools/explorer/)和[FQL 文档](https://developers.facebook.com/docs/reference/fql/photo/)开始。

然后寻找一些用于 PHP 的 Facebook/FQL API。

示例查询是：

```
SELECT aid, pid, src_big from photo where owner = me() 
```

# opengl - Mesa3d CPU 还是 GPU？

> ID：13691408
> 
> 赞同：0
> 
> 时间：2012-12-03T20:46:52.517
> 
> 标签：opengl, cpu, gpu, mesa

Mesa使用CPU渲染是真的吗？A 读过一些关于 Mesa 的文章，但仍然无法理解它是如何工作的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T21:06:16.053

> Mesa使用CPU渲染是真的吗？

这取决于系统中安装的 GPU 是否支持 Mesa/DRI 以及创建的 OpenGL 的版本。如果支持 GPU，则渲染将在 GPU 上进行。如果 GPU 不受支持，或者缺少请求的上下文版本所需的功能，Mesa 将回退到在 CPU 上运行的软件光栅化器后端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T20:52:13.880

Mesa 作为 X.org 的开源 DRI 驱动程序的 OpenGL 核心。

DRI 是一个开放源代码框架，允许直接访问 X 窗口系统下的图形硬件。DRI 驱动程序可利用图形硬件芯片组。

[http://www.mesa3d.org/faq.html](http://www.mesa3d.org/faq.html)
[http://dri.freedesktop.org/wiki/](http://dri.freedesktop.org/wiki/)
[http://dri.freedesktop.org/wiki/Status](http://dri.freedesktop.org/wiki/Status)

# java - 如何从 jar 中加载字体？

> ID：13691409
> 
> 赞同：2
> 
> 时间：2012-12-03T20:46:54.983
> 
> 标签：java, fonts, jar, jframe, embedded-resource

我正在将 java.awt.Frame 用于我的 Java 应用程序窗口，该窗口正在从 main 内的循环中刷新。

该应用程序在从 Eclipse 运行时的行为完全符合其应有的行为，但是当我将其打包到 jar 中时，它会绘制第一个屏幕，但之后就没有其他内容了。

当我尝试将窗口切换到 JFrame 时，它​​可以工作，但只有一部分图像被绘制和更新。

我不确定是什么问题？如果它在 Eclipse 中运行良好，它不应该在 jar 文件中运行完全相同吗？

编辑：我发现了问题。这是由于没有从 jar 文件加载字体。有没有办法让这些正确加载？这是我给他们的代码：

```
Font font = Font.createFont(Font.TRUETYPE_FONT, 
  obj.getClass().getClassLoader().getResource(fontName)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T07:41:35.950

获取它的 URL，然后查看[此答案](https://stackoverflow.com/questions/8364787/how-do-you-import-a-font/8365030#8365030)以创建它并在可用字体中注册它。

![](../Images/03783e3b304d85575780e28388d092cf.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-02T18:12:03.037

尝试使用此代码从 .jar 文件中加载字体文件。

```
import java.awt.Font;
import java.awt.FontFormatException;
import java.io.IOException;
import java.net.URISyntaxException;

public class FontLoader
{
    private ResourceLoader loader;

    public FontLoader(String fontFilePath)
    {
        loader = new ResourceLoader(fontFilePath);
    }

    public Font getFont(int fontStyle, float fontSize) throws FontFormatException, IOException, URISyntaxException
    {
        Font font = Font.createFont(Font.TRUETYPE_FONT, loader.getResource());

        font = font.deriveFont(fontStyle, fontSize);

        return font;
    }
} 
```

请注意，您还需要我的`ResourceLoader`课程，您可以在这里找到：
[如何从资源文件夹加载文件？](https://stackoverflow.com/questions/15749192/how-do-i-load-a-file-from-resource-folder/28283998#28283998)

# c# - 在 C# 中不使用 iTunes 的 COM 接口获取 iTunes XML 库的路径

> ID：13691410
> 
> 赞同：1
> 
> 时间：2012-12-03T20:46:56.510
> 
> 标签：c#, itunes

我正在开发一个涉及读取用户的 iTunes XML 库的应用程序。目前，它使用它来获取该路径：

```
iTunesApp app = new iTunesApp();
string xmp = app.LibraryXMLPath; 
```

...这会导致 iTunes 在`iTunesApp`构建时打开。是否有库的静态路径，或更简单的访问方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:50:30.743

尽管我确信它们可以被移动，但[苹果公司](http://support.apple.com/kb/HT1660)在这个话题上是这样说的：

> iTunes 库文件的位置：
> 
> Windows XP \Documents and Settings\用户名\我的文档\我的音乐\iTunes\iTunes Library.xml
> 
> Windows Vista \用户\用户名\音乐\iTunes\iTunes Library.xml
> 
> Windows 7 \用户\用户名\我的音乐\iTunes\iTunes Library.xml

希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:52:22.157

不幸的是，没有。因为 SDK 基于 COM 互操作，所以使用它需要运行 iTunes。一个可能的解决方案是允许 iTunes 第一次打开，然后保存位置，这样您就不必在以后访问时创建对象。

另一种选择是对文件的位置进行“有根据的猜测”（请参阅​​ hd1 的答案），如果它们都不起作用，则创建 com 对象并获取位置（打开 iTunes）。

# http - MSXML2.XMLHTTP 生成的结果与我仅在 Web 浏览器中访问页面不同

> ID：13691414
> 
> 赞同：1
> 
> 时间：2012-12-03T20:47:25.070
> 
> 标签：http, vba, excel, msxml

我使用 Excel VBA 通过以下方式下载某些网站的页面源：

```
 Public Function GetPage(URL As String) As String
        Dim oX As New MSXML2.XMLHTTP
        oX.Open "Get", URL, False
        oX.Send
        GetPage = oX.responseText
    End Function 
```

但是，经过仔细检查后，我注意到此代码返回的 HTML 源代码与我使用 Web 浏览器访问该站点时返回的 HTML 源代码不同。

[这是我正在访问的网站](http://rrcsearch.neubus.com/esd-rrc/index.php?subaction=1&profile=0&show_district=on&district=&show_field_no=on&field_no=&show_field_name=on&field_name=&show_lease_id=on&lease_id=&show_lease_name=on&lease_name=&show_fluid_no=on&fluid_no=&show_api_no=on&api_no=36537174&show_docket_no=on&docket_no=&docket_type=&city=&app_name=&app_file_date_from=&app_file_date_to=&final_order_date_from=&final_order_date_to=&admin_close_date_from=&admin_close_date_to=&t4permit_no=&county=&operator_name=&operator_no=&company_id=&company_name=&year=&drilling_no=&commingling_permit_no=&county_name=&county_number=&survey_name=&survey_section_number=&alternate_survey_name=&abstract_number=&scan_date_from=&scan_date_to=&ipp=10#results)。在页面底部，它列出了两个结果。现在，如果我使用我的 GetPage 函数访问该 URL，它会返回主页的 HTML，但它不包含任何结果——源明确表示“找到 0 个结果”。是什么赋予了？它似乎没有使用 JavaScript 来替换某些 HTML 元素，所以我很茫然。我确实注意到，当我自己访问该站点时，它运行缓慢，但是当我运行 VBA HTTP 请求时，它似乎几乎是瞬间完成的。也许我必须等待什么？

如果我通过 VBA 发出 HTTP 请求，有谁知道为什么我找不到这些结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T23:52:58.487

尝试`#results`从 URL 的末尾删除片段标识符。虽然这对于 URL 来说是完全合法的语法，但正如我在响应中看到的那样，它似乎在这里引起了问题：

```
 ERROR:  column "results" does not exist
LINE 1: ... = 'O') AND (parent_part_info IS NULL))) LIMIT 10#results OF... 
```

当我在没有该`#results`部分的情况下运行 URL 时，响应会在几秒钟后返回，并在浏览器中访问 URL 时显示相同的 2 个结果

也是- 即最初来自“Microsoft XML, v3.0”库的版本`MSXML2.XMLHTTP`的同义词。`MSXML2.XMLHTTP30`如果您使用的是“Microsoft XML, v6.0”库，那么通常建议将引用更改为`MSXML2.XMLHTTP60`. 请参阅[此 Microsoft 博客文章](http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx)

# r - 更改 grid.arrange 输出的背景颜色

> ID：13691415
> 
> 赞同：5
> 
> 时间：2012-12-03T20:47:25.717
> 
> 标签：r, ggplot2, r-grid

我正在使用`grid.arrange`from `gridExtra`package 将两个图形放在一个页面上并将其保存到 png 文件中。我喜欢更改最终生成的 png 文件的背景颜色`grid.arrange`。可能吗？我无法找到任何信息。

```
grid.arrange(p1, p2, main=textGrob("CPU Util", gp=gpar(cex=1.2, fontface="bold", col="#990000")), ncol = 1, clip=TRUE) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:54:51.853

尝试将`bg =`参数设置为`png()`

```
library(gridExtra)
library(lattice)

png(bg = "wheat1")
    grid.arrange(xyplot(1:10~1:10, pch=16), xyplot(1:4~1:4, pch=16))
dev.off() 
```

![在此处输入图像描述](../Images/8149ffcc3abf84cd8d540cc91c19eab7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-25T20:12:57.100

使用时`ggplot2`，我还发现包中的`ggdraw()`功能很有用，如下[所示](https://stackoverflow.com/a/50011781/5193830)。`cowplot`

这是一个例子：

```
library(ggplot2)
library(gridExtra)

# Create two plots
p1 <- ggplot(mtcars, aes(hp, mpg)) + 
  geom_point() + 
  theme(plot.background = element_rect(fill="wheat1", color = NA))
p2 <- ggplot(mtcars, aes(hp, drat)) + 
  geom_point() + 
  theme(plot.background = element_rect(fill="wheat1", color = NA))

# stitch them together
g <- grid.arrange(p1, p2, nrow = 1)
# final touch
g2 <- cowplot::ggdraw(g) + 
  theme(plot.background = element_rect(fill="wheat1", color = NA))

# check the plot
plot(g2)
# save it as png
ggsave("img/plot-background.png", g2) 
```

[![在此处输入图像描述](../Images/4c65c38b18329a805c4ec28f1fd5bed8.png)](https://i.stack.imgur.com/xS9Kb.png)

虽然`p1`并且`p2`已经`plot.background`设置了填充，但它们之间仍然存在一条细线，当使用相同的填充包裹`grid.arrange`时消失。`cowplot::ggdraw`就好像你把两块瓷砖缝在一起，然后刷上最后一层油漆。

# scala - 类型参数推断 + 高阶类型 + 类型类 = :-(

> ID：13691416
> 
> 赞同：4
> 
> 时间：2012-12-03T20:47:27.550
> 
> 标签：scala, implicit, scalaz, typeclass

```
import scalaz._; import Scalaz._

def foo[M[_]:MonadPlus,A](a:A) = a.point[M]
// foo: [M[_], A](a: A)(implicit evidence$1: scalaz.MonadPlus[M])M[A]

def bar1[M[_]:MonadPlus](i:Int): M[Int] = 
  foo(i) // <-- error: ambiguous implicit values

// this works, but why?  Isn't it just the same?
def bar2[M[_]:MonadPlus](i:Int): M[Int] = 
  foo(i)(implicitly[MonadPlus[M]])

def bar3[M[_]](i:Int)(implicit m:MonadPlus[M]): M[Int] = 
  foo(i)(m) // slightly less surprising that this works

def bar4[M[_]:MonadPlus](i:Int): M[Int] = 
  foo[M,Int](i) // this also works, but why? 
```

构建.sbt：

```
scalaVersion := "2.9.2"

libraryDependencies += "org.scalaz" %% "scalaz-core" % "7.0.0-M5" 
```

（虽然我在 2.10.0-RC3 中得到了相同的结果）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T00:05:16.847

如果您简单地编写，您会收到相同的错误消息：

```
import scalaz._; import Scalaz._

def foo[M[_]:MonadPlus,A](a:A) = a.point[M]

foo(1) // <-- error: ambiguous implicit values
       // both value listInstance ...
       // and value optionInstance ... 
```

我的理解是编译器尝试对`bar1`方法的“主体”进行类型检查，并且没有考虑范围内可能存在一个`MonadPlus[M]`实例（由`bar`定义带来），它已经找到了 2 个`MonadPlus[M]`适合的特定实例（listInstance 和 optionInstance）`foo`调用。在这个阶段，它只是声明了一个歧义。

然后 in`bar2`并`bar3`明确指定要使用的实例，并在 in 中`bar4`给出类型参数，这些参数在调用中是`M`和`Int`不模棱两可的，`foo`因为这些约束的唯一隐含范围是`implicitly[MonadPlus[M]]`.

# php - 在数据库中插入图像属性

> ID：13691419
> 
> 赞同：0
> 
> 时间：2012-12-03T20:47:33.920
> 
> 标签：php, javascript, jquery, html, mysql

当我单击图像时，我想在数据库中插入一些值，但是出了点问题。这是我的代码：我编辑了我的帖子。我按照您的建议进行了更改，但单击图像时仍然没有任何反应。

```
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<script src="jquery.js"></script>

<style type="text/css">
      body{background-color:black; background-repeat:no-repeat; position:absolute;width:100%;}
      img.imgnavbar{height:auto; width:15%; opacity: 1.0; padding:2%; z-index:100;}
      .menu{padding-top:3%;width:100%;}   
      img.shadow{height:100%; width:100%; bottom:0px; position:fixed; left:0%; z-index:-2;}

</style>

<script>
$(".imgnavbar").click(function() {
   var $myimage=$(this);
   $.ajax({
       type: 'POST',
       url: 'submit_form.php',
       data: { 'img_alt': $myimage.attr('alt') },
       success: function(){
          console.log("OK!");
       }
   });
});
</script>
</head>
<body>

<div  align="center" class="menu">
<img  src='images/green.png' id="green" alt="green" class="imgnavbar"/>
<img  src='images/blue.png' id="blue" alt="blue" class="imgnavbar"/>
<img  src='images/orange.png' id="orange" alt="orange" class="imgnavbar"/>
<img  src='images/red.png' id="red" alt="red" class="imgnavbar"/>
</div>
<img  src='images/shadow.png' id="shadow" class="shadow"/>
</body>

</html> 
```

和PHP：

```
<?php

    include ("db.php");

    $myimage        = htmlspecialchars(trim($_POST['img_alt']));

    $addCompany  = "INSERT INTO company (id,name) VALUES ('','$myimage')";
    mysql_query($addCompany) or die(mysql_error());

?> 
```

你能帮我一些建议吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T20:49:15.120

您正在为您发送的变量使用不同的名称：

```
data: { 'img_alt': $myimage.attr('alt') }, 
```

但在 php 中你使用：

```
$myimage        = htmlspecialchars(trim($_POST['myimage'])); 
```

将其更改为：

```
$myimage        = htmlspecialchars(trim($_POST['img_alt'])); 
```

另请注意，您的代码容易受到 sql 注入的影响。您应该切换到 PDO / mysqli 并使用绑定变量准备语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T20:53:05.097

你应该使用 class 属性，你不能使用 id attr 两次。

```
<script>
**$(".imgnavbar")**.click(function() {
   var $myimage=$(this);
   $.ajax({
       type: 'POST',
       url: 'submit_form.php',
       data: { 'img_alt': $myimage.attr('alt') },
       success: function(){
          console.log("OK!");
       }
   });
});
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:55:12.603

您似乎访问了错误的 $_POST 参数

此外，您所有的图像元素都具有相同的 ID。这可能不是一个好主意。也许尝试使用类作为句柄。另外，为什么不尝试调试应用程序以获得一些更有意义的错误信息。您可以打印出来自 AJAX 帖子的响应，如下所示：

```
success: function(response){
    console.log(response);
} 
```

然后在你的 PHP 中尝试 var_dump($_POST) 看看会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T20:50:45.267

最重要的是：每个 id 属性每页只能使用一次。不同元素不能有相同的 id 属性

# c# - Webforms 和 MVC 并排托管

> ID：13691421
> 
> 赞同：1
> 
> 时间：2012-12-03T20:47:43.000
> 
> 标签：c#, asp.net-mvc

我目前有一个运行 Umbraco CMS 的 ASP.net webforms web 应用程序，它运行得很好而且很漂亮。我还创建了一个单独的 MVC Web 应用程序，它构成了上述网站的一部分（一个保险报价引擎）。

是否可以简单地上传 MVC 应用程序（单独的文件夹）并在我现有的 Web 应用程序（即 /mvcapplication）中运行？它应该工作还是你必须做一些 web.config 黑客？

ps 有类似问题但未回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:54:56.173

是的，您可以，但您必须在 IIS 中将其视为 Web 表单站点文件夹下的单独 Web 应用程序。换句话说，将您的 MVC 应用程序放在您的 Webform 站点文件夹中，然后将 MVC 文件夹作为 Web 表单下的新应用程序，这样您就不必处理 web-config 并且每个应用程序 webforms 和 mvc 都将使用它自己的配置.

# mysql - 具有大表的 MySQL：2 个查询比 1 个查询快（未使用索引）

> ID：13691422
> 
> 赞同：3
> 
> 时间：2012-12-03T20:47:45.570
> 
> 标签：mysql, sql, indexing

我有两张桌子：

```
CREATE TABLE `linf` (
  `ID` bigint(20) NOT NULL AUTO_INCREMENT,
  `glorious` bit(1) DEFAULT NULL,
  `limad` varchar(127) COLLATE utf8_bin DEFAULT NULL,
  `linfDetails_id` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`ID`),
  KEY `FK242415D3B0D13C` (`linfDetails_id`),
  CONSTRAINT `FK242415D3B0D13C` FOREIGN KEY (`linfDetails_id`) REFERENCES `linfdetails` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=135111 DEFAULT CHARSET=utf8 COLLATE=utf8_bin 
```

（130K 行）

和

```
CREATE TABLE `messageentry` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `mboxOffset` bigint(20) DEFAULT NULL,
  `mboxOffsetEnd` bigint(20) DEFAULT NULL,
  `from_id` bigint(20) DEFAULT NULL,
  `linf_ID` bigint(20) DEFAULT NULL,
  `mailSourceFile_id` bigint(20) DEFAULT NULL,
  `messageDetails_id` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `FKBBB258CB60B94D38` (`mailSourceFile_id`),
  KEY `FKBBB258CB11F9E114` (`from_id`),
  KEY `FKBBB258CBF7C835B8` (`messageDetails_id`),
  KEY `FKBBB258CBB10E8518` (`linf_ID`),
  CONSTRAINT `FKBBB258CBB10E8518` FOREIGN KEY (`linf_ID`) REFERENCES `linf` (`ID`),
  CONSTRAINT `FKBBB258CB11F9E114` FOREIGN KEY (`from_id`) REFERENCES `emailandname` (`id`),
  CONSTRAINT `FKBBB258CB60B94D38` FOREIGN KEY (`mailSourceFile_id`) REFERENCES `mailsourcefile` (`id`),
  CONSTRAINT `FKBBB258CBF7C835B8` FOREIGN KEY (`messageDetails_id`) REFERENCES `messagedetails` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5888892 DEFAULT CHARSET=utf8 COLLATE=utf8_bin 
```

（5M 行）

我需要通过 linf.limad 找到 linf，然后找到这个 linf 对应的所有消息。

如果我在两个查询中选择它：

```
select sql_no_cache l.id from linf l where l.limad='test@';
select sql_no_cache me.* from messageentry me where me.linf_id = 118668; 
```

然后需要 0.06 秒。

如果我使用

```
select sql_no_cache me.* from messageentry me where me.linf_id in(
select l.id from linf l where l.limad='test@') ; 
```

执行需要 10 秒。和这个：

```
select sql_no_cache me.* from messageentry me, linf l where me.linf_id=l.id
and l.limad='test@'; 
```

需要 4 秒。（时间稳定）

此请求返回 0 个结果，因为没有此 linf 的消息。事实上，我已经从大请求中去掉了这个

```
select messageent1_.*
from
    MailSourceFile mailsource0_,        
    MessageEntry messageent1_ ,
    MessageDetails messagedet2_,    
    Linf linf3_
where
    messageent1_.messageDetails_id = messagedet2_.id
        and messageent1_.linf_ID = linf3_.ID
        and linf3_.limad = 'test@'
and mailsource0_.id = messageent1_.mailSourceFile_id 
```

这工作〜1分钟。这不是太多了吗？解释说没有使用 messageEntries 索引：

```
mysql> explain select sql_no_cache me.* from messageentry me, linf l where me.linf_id=l.id and l.limad='test@';
+----+-------------+-------+--------+--------------------+---------+---------+------------------+---------+-------------+
| id | select_type | table | type   | possible_keys      | key     | key_len | ref              | rows    | Extra       |
+----+-------------+-------+--------+--------------------+---------+---------+------------------+---------+-------------+
|  1 | SIMPLE      | me    | ALL    | FKBBB258CBB10E8518 | NULL    | NULL    | NULL             | 5836332 |             |
|  1 | SIMPLE      | l     | eq_ref | PRIMARY            | PRIMARY | 8       | skryb.me.linf_ID |       1 | Using where |
+----+-------------+-------+--------+--------------------+---------+---------+------------------+---------+-------------+ 
```

任何想法为什么？我已经获得了 mysql ~1.6 G 的内存，这应该适合所有表。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:25:02.293

让我们看一下查询：

```
select sql_no_cache me.*
from messageentry me, linf l
where me.linf_id=l.id
and l.limad='test@'; 
```

它有什么作用？根据表`EXPLAIN`中每一行的执行计划，`me`它检查表中是否有相应的记录`linf`。由于您在字段上没有任何索引`limad`，因此 MySQL 5M 次`limad`从磁盘（而不是内存）中获取字段的值以检查它是否等于“@test”。您说查询返回 0 行，但是对于另一个`limad`可以提供更多行的值，它需要为所有`me.*`字段在磁盘上进行。

好的，`limad`字段 is `varchar(127) COLLATE utf8_bin`，这是它的索引可能很昂贵（无论如何我都会添加它）。130k 行小于 5M，所以从 开始会很棒`linf`，而我们`messageentry`一开始只需要`id, mailSourceFile_id, messageDetails_id`. 为什么只有那些字段？由于我们将再进行两个连接，并且我们不从连接的表中获取数据，因此这些表似乎缩小了最终结果集，即它们是查询框架所必需的。让我们只从它们开始：

```
SELECT me.id, me.mailSourceFile_id, me.messageDetails_id
FROM (
  SELECT ID as linf_ID
  FROM linf
  WHERE limad='test@'
) as linf
JOIN messageentry me USING (linf_ID); 
```

查询选择所需的 linf_ID，然后为每个找到的 id 查找适当的行`messageentry`。由于您在 linf_iD 上有一个索引，因此查询的结果应该快于 4 秒。

但是这些`me.mailSourceFile_id, me.messageDetails_id`不能从内存中取出，因为 MySQL 需要进行复杂的索引合并，因此，无论如何，MySQL 都会为具有匹配 linf_ID 的每一行进入磁盘。如果您有一个同时包含所有这三个字段的索引，则查询会更快，以防有大量行被后续连接过滤。

如果您将 KEY 更新`FKBBB258CBB10E8518 (linf_ID)`为`FKBBB258CBB10E8518 (linf_ID, mailSourceFile_id, messageDetails_id)`，您将拥有这样的索引。

生成的查询将类似于：

```
SELECT me.*
FROM (
  SELECT ID as linf_ID
  FROM linf
  WHERE limad='test@'
) as linf
JOIN messageentry me USING (linf_ID)
JOIN MailSourceFile ms ON ms.id = me.mailSourceFile_id
JOIN MessageDetails md ON md.id = me.messageDetails_id; 
```

实际上，一旦您`FKBBB258CBB10E8518 (linf_ID)`按照上面的建议更新索引，您的原始查询很可能与最后一个查询具有相同的执行计划和时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:08:04.307

如果像这样显式定义连接条件会发生什么？

```
select sql_no_cache me.* 
from messageentry me JOIN linf l ON  me.linf_id=l.id
WHERE l.limad='test@'; 
```

如果优化器选择进行交叉连接或其他奇怪的事情，您的版本可能会出现问题。

除此之外，您可能会考虑做一个力指数：

```
select sql_no_cache me.* 
from messageentry me FORCE INDEX (FKBBB258CBB10E8518)
JOIN linf l ON  me.linf_id=l.id         
WHERE l.limad='test@'; 
```

这至少会告诉你索引是否真的会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:03:29.817

*   如果可能，尝试使用 INT 而不是 BIGINT，如果可能，也选择 INT 作为主键。像“linf_ID”这样的二级索引将它的相关主键存储在磁盘中。使用 BIGINT 意味着更多的页面错误和磁盘读取。 [http://planet.mysql.com/entry/?id=13825](http://planet.mysql.com/entry/?id=13825)

*   要减小 varchar 的索引大小，请尝试使用 limad 的索引部分。
    在《High Performance Mysql 3Edition》一书中给了我们一种选择varchar索引长度的方法。选择让以下两个sql的结果相似的长度

    SELECT COUNT(DISTINCT city)/COUNT(*) FROM sakila.city_demo；

    SELECT COUNT(DISTINCT LEFT(city, 3))/COUNT( *) AS sel3, COUNT(DISTINCT LEFT(city, 4))/COUNT(* ) AS sel4, COUNT(DISTINCT LEFT(city, 5))/COUNT( *) AS sel5, COUNT(DISTINCT LEFT(city, 6))/COUNT(* ) AS sel6, COUNT(DISTINCT LEFT(city, 7))/COUNT(*) AS sel7 FROM sakila.city_demo;

*   让 MySQL 分析和优化磁盘中的数据 [http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html](http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html) http://dev.mysql.com/doc/refman/5.0/en/分析表.html

*   对于你在问题中运行 1 分钟的“大请求”SQL，为了优化这个 SQL，你需要使用多列索引。 [http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)

    在 MessageEntry 上创建唯一索引 idx_name（linf_ID，messageDetails_id，mailSourceFile_id）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:09:47.887

MySQL 在子句中的子查询做得很差`in`，这解释了你在那里看到的糟糕的性能。我怀疑连接性能与连接的顺序有关。它可能正在完整地阅读消息表。

尝试将`in`版本更改为`exists`：

```
select sql_no_cache me.*
from messageentry me
where exists (select 1 from linf l where l.limad='test@' and l.id = me.inf_id limit 1) ; 
```

顺便说一句，您应该习惯于在`on`子句中而不是在`where`子句中进行连接。

# jquery - 添加到 HTML 时 SVG 不显示

> ID：13691424
> 
> 赞同：1
> 
> 时间：2012-12-03T20:47:53.017
> 
> 标签：jquery, html, svg

我有一个非常有趣的问题，当我将新的 SVG 元素添加到 div 时，只有第一次调用 append 时才会出现新的 svg 元素。它们在硬编码时工作，但是当它们被添加到 onmousedown 时，它们不会出现，即使它们被添加到 HTML 文件中。我假设这是我对 SVG 理解的问题，并且无法动态添加元素，但我一直在寻找互联网，并找不到任何关于该主题的内容。

你可以看到在 $(document).mousedown 函数中，一个新的圆圈被附加到了 svg holder 中，但是即使它被添加到了 SVG holder 中，它也不会显示在网页上。

代码：

HTML：

```
<div id="svgHolder">
    <!--THIS CIRCLE SHOWS UP-->
    <svg><circle cx='50' cy='50' r='40' stroke='black' stroke-width='1' fill='red' /></svg>
</div> 
```

jQuery/JavaScript：

```
$(document).ready(function(){

var mouse={
    x:0,
    y:0,
    drawing:false,
    lastX:0,
    lastY:0,

}

$(document).mousedown(function(e){
    console.log('md')
    mouse.x=e.clientX
    mouse.y=e.clientY
    mouse.drawing=true
            //THIS CIRCLE WILL BE ADDED TO THE SVGHOLDER, BUT WILL NOT SHOW UP
    $("#svgHolder").append("<svg><circle cx='"+mouse.x+"' cy='"+mouse.y+"' r='40' stroke='black' stroke-width='1' fill='red' /></svg>");
});

$(document).mouseup(function(e){
    console.log('mu')
    mouse.x=e.clientX
    mouse.y=e.clientY
    mouse.drawing=false
});

$(document).mousemove(function(e){
    console.log('mm')
    mouse.x=e.clientX
    mouse.y=e.clientY
});

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:17:14.417

我认为当您动态创建`svg`节点时，您必须创建名称空间。

```
var ns = "http://www.w3.org/2000/svg";
var svg = document.createElementNS(ns, "svg");
$(svg).append("<circle ..."); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T21:38:40.110

您`svg`正在插入但不在您的视口中，因此您看不到它，添加一些`width`and并`height`为and属性`svg`设置适当的值，即`cx``cy`

```
$(document).mousedown(function(e){
    $("#svgHolder")
    .append("<svg width='100' height='100'><circle cx='50' cy='50' r='40' stroke='black' stroke-width='1' fill='red' /></svg>");
}); 
```

还要记住`clientX`并`clientY`以 CSS 像素给出相对于视口的坐标。

[Example1](http://jsbin.com/ejisop/1/edit)、[Example2](http://jsbin.com/ejisop/5/edit)和[更多关于 SVG](http://www.w3.org/TR/SVG/shapes.html#CircleElement)的内容。

# multidimensional-array - 从数组返回索引和值

> ID：13691428
> 
> 赞同：3
> 
> 时间：2012-12-03T20:48:16.933
> 
> 标签：multidimensional-array, indexing, geospatial

因此，这里的目标是遍历 DEM（或任何空间引用数组）的每一行，找到最小值（例如低点），然后返回该值和相关索引。

这并不优雅，但我可以通过循环和种子轻松获得值：

```
`lowpts=[]
low=99999
for i in range(len(DEM)):
    for j in range(len(DEM)):
        low1 = DEM[i][j]
        if low1 < low:
            low = low1
    lowpts.append(low)` 
```

但是现在如何保留与每个值关联的 [i][j] 索引？

理想情况下，回报将是 [[i,j,value],......]

我试过 enumerate() 但不确定如何正确实现它。而且我必须注意可能的重复值，所以我不能只对 lowpts 数组进行 .index （类似于[Python：在数组中查找元素](https://stackoverflow.com/questions/604802/python-finding-an-element-in-an-array)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:31:26.747

您正在自己的问题中给出答案！

```
lowpts=[]
low=99999
for i in range(len(DEM)):
    for j in range(len(DEM)):
        low1 = DEM[i][j]
        if low1 < low:
            low = low1
            low_i = i
            low_j = j
    lowpts.append([i,j,low]) 
```

# search - Solr 中的设计方法

> ID：13691435
> 
> 赞同：0
> 
> 时间：2012-12-03T20:49:06.583
> 
> 标签：search, solr

这是一个笼统的问题，我希望它会以正确的精神来对待。我是 solr 的菜鸟，试图用它构建我的第一个应用程序。我想确认我考虑过的方法，请随时提出增减建议：

1) DIH - 找出要索引的所有数据，这应该包括要查询的数据和元数据（如果有的话）。弄清楚每个数据的易失性以及 cron 任务将如何更新和删除这些数据。围绕这些知识制定增量/部分导入策略。

2) Schema - 排列数据。还要在需要的地方安排元数据。在需要的地方使用分析器进行处理，在适用的地方设置查询分析器。

3) 查询调优——开始测试样本数据，进一步微调应用程序。

4）添加同义词并测试相同。

5) 刻面

6) 搜索框 (ajax) 中的建议仅适用于索引项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T07:01:43.667

如果您刚开始，您可能应该只关注基本索引并获取可搜索的数据。

*   从 Solr 的独立设置开始。
*   数据索引 - 取决于您拥有的数据。DB (DIH), Rich Documents (Extratc Handler), Web pages (With Nutch) ...
*   Schema.xml 的配置
    *   需要配置哪些字段
    *   什么目的（显示、搜索、构面、突出显示......）
    *   您想对这些字段进行什么分析？
    *   您可以逐步应用停用词、ascii 过滤器、词干分析器、同义词。
*   solrconfig.xml 的配置
    *   您希望搜索的行为方式。
    *   您希望搜索哪些字段？多个领域？
    *   您想使用什么解析器进行搜索 Standard ？迪斯马克斯？EDismax ?
*   如果正确配置并且只需要正确创建查询，则会在字段上启用分面、过滤、排序和突出显示

*   先进的 ：-

    *   搜索相关性调整
    *   Solr 设置 - 高级，您可以检查是否需要多核步骤、主/从配置、分布式搜索、Solr Cloud
    *   索引时间性能调优
    *   查询时性能调优
    *   Autosuggestions，你的意思是和其他功能可从 solr 获得，或者可以从应用程序端轻松构建。

# php - 使用 PHP 确定存档位置

> ID：13691438
> 
> 赞同：0
> 
> 时间：2012-12-03T20:49:16.850
> 
> 标签：php, zip, archive, ziparchive

我正在使用`ZipArchive`压缩文件，但 .zip 文件被保存到主页方向[http://example.com/](http://example.com/)。我希望将它们保存到[http://example.com/downloads/](http://example.com/downloads/)

这是我的代码。

```
<?php
    //Get the directory to zip
    $filename_no_ext= $_GET['loc'];

function recurse_zip($src,&$zip,$path_length) {
        $dir = opendir($src);
        while(false !== ( $file = readdir($dir)) ) {
            if (( $file != '.' ) && ( $file != '..' )) {
                if ( is_dir($src . '/' . $file) ) {
                    recurse_zip($src . '/' . $file,$zip,$path_length);
                }
                else {
                    $zip->addFile($src . '/' . $file,substr($src . '/' . $file,$path_length));
                }
            }
        }
        closedir($dir);
}
//Call this function with argument = absolute path of file or directory name.
function compress($src) {
        if(substr($src,-1)==='/')
            {
                $src=substr($src,0,-1);
            }
        $arr_src=explode('/',$src);
        $filename=end($arr_src);
        unset($arr_src[count($arr_src)-1]);
        $path_length=strlen(implode('/',$arr_src).'/');
        $f=explode('.',$filename);
        $filename=$f[0];
        $filename=(($filename=='')? 'backup.zip' : $filename.'.zip');

        $zip = new ZipArchive;
        $filename = '/downloads/'.$filename;
        $res = $zip->open($filename, ZipArchive::CREATE);

        if($res !== TRUE)
        {
            echo 'Error: Unable to create zip file';
            exit;
        }
        if(is_file($src))
            {
                $zip->addFile($src,substr($src,$path_length));
            }
        else
        {
            if(!is_dir($src))
            {
                 $zip->close();
                 @unlink($filename);
                 echo 'Error: File not found';
                 exit;
            }
            recurse_zip($src,$zip,$path_length);
        }
        $zip->close();
        header("Location: $filename");
        exit;
}

$zip = compress($_SERVER['DOCUMENT_ROOT'].$_GET['loc'])

        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:03:45.833

当我认为您希望它是相对的时，您的路径是绝对的。

尝试更改`'/downloads/' . $filename'`为`'downloads/' . $filename`.

或者

你可以像这样做一个绝对路径。

`'/home/path/to/site/downloads/' . $filename`

`$zip->open()`使用参数指定名称的位置`ZipArchive::CREATE`将设置保存路径

# utm - UTM 到经纬度，多个邮政编码 UK

> ID：13691440
> 
> 赞同：2
> 
> 时间：2012-12-03T20:49:30.300
> 
> 标签：utm

我们有一些这样的数据：

```
Miles    postcode          X           Y

3.13     al 2 1         517972    203372

2.6      al 2 2         514612    203397 
```

这里 X 和 Y 在 UTM 中，我们将这些值转换为纬度和经度。对于这个经纬度，我们根据英里指定的距离在地图上绘制 POI。由于重叠区域，很少有 POI 被映射到多个邮政编码。

真的有可能吗？由于我不熟悉英国邮政编码，如果我做错了什么，请告诉我。

我试图在谷歌上搜索，但没有找到任何有用的东西。

任何帮助都是非常可观的。

# css - Safari 6 渐变色混合/插值错误

> ID：13691444
> 
> 赞同：7
> 
> 时间：2012-12-03T20:49:53.987
> 
> 标签：css, graphics, safari, webkit, gradient

图片应该说明一切。左边是 Safari 6，右边是 Chrome。不仅透明红色渐变的下半部分完全错误（这可能是过度预乘 alpha 的情况），上半部分也更暗，这看起来像是伽马校正问题。

此问题出现在 Mountain Lion 上的 Safari 6 和 iOS6 Mobile Safari 上，但不会出现在 Lion 上的 Safari 6 上。

[http://jsfiddle.net/ZUTYm/4](http://jsfiddle.net/ZUTYm/4)

有没有人找到获得预期结果的解决方案？我需要我的渐变来涉及 alpha，因为我正在尝试淡入淡出文本。

由于在输入实际代码之前无法完成编辑，因此这里是渐变定义：`background-image: -webkit-linear-gradient(top, red, rgba(255,128,128,0), white);`

![在此处输入图像描述](../Images/c7df440cdd59a470133a46674c7b12e1.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T04:05:54.063

我能够在 Mac 10.8.1 Safari 6.0 (8536.25) 和 iOS Safari 6.0.1 上重现该问题。我认为应用 a[`-webkit-mask-image`](https://developer.mozilla.org/en-US/docs/CSS/-webkit-mask-image)而不是透明色标可以避免这个问题：

```
.grad-bg {
    background-image: 
        -webkit-linear-gradient(top, #ff0000, #fff);
    height: 100%;
}

.masked {
    -webkit-mask-image:
        -webkit-linear-gradient(top, white, transparent, white);
} 
```

[jsFiddle](http://jsfiddle.net/ZUTYm/25/)

在图像中，顶部显示在白色背景上，底部形状显示在相同颜色的不透明渐变背景上。

![顶部显示在白色背景上，底部形状显示在相同颜色的不透明渐变背景上。](../Images/ec0a62b24d57103030a5b6c7f2ba6507.png)

（许多编辑。）

# ios - 为两个 UITableView 获取正确的界面

> ID：13691448
> 
> 赞同：0
> 
> 时间：2012-12-03T20:50:00.830
> 
> 标签：ios, uitableview

我是为 iPad 构建 iOS 应用程序的初学者。

我正在尝试显示两个表视图来设置基本层次结构。我的应用程序将管理一个游戏的多个角色，每个角色都属于一个组。

第一个表将显示组的名称。它应该有一个添加对象按钮和一个编辑按钮。（这可以被认为是主视图，因为选定的行将决定在第二个表格视图上显示哪些字符）。

第二个表将显示上表中所选组内的字符名称。

这不是应用程序的主屏幕，但会在应用程序的特定时间点呈现。SplitView 似乎是一个很好的解决方案，但它既不能被推送也不能以模态方式呈现。此外，我需要在这两个 tableViews 的右侧显示额外的控件，如果 tableViews 占用了 SplitView 的两个视图，那么就没有空间了。

问题是，我不知道样式约定是什么。通常，编辑和“+”按钮将位于导航栏中。但是，在同一个视图中有两个表视图，这似乎不可行。

我试图通过每个表中的工具栏获得类似的功能，但遇到了一些问题：

1.  工具栏与 tableview 一起滚动（而不是像导航栏一样停留在顶部），
2.  我无法让编辑按钮正常运行（在编辑/完成模式之间切换），只需将其添加为 NavigationBar 的 leftBarButtonItem 即可，并且
3.  我不确定以这种方式使用工具栏是否被认为是“可接受的”。

这个视图看起来也有点有趣，tableviews 漂浮在更大的视图中。是否有处理这种接口的“标准”方式？或者一个看起来对我想要完成的事情有用的？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:45:30.153

如果您希望两个表视图同时可见且右侧有控件，您可以使用拆分视图中的容器视图来执行此操作。在拆分视图 UIViewControllers 中制作 2 个控制器，并为每个控制器添加 2 个容器视图。根据需要调整它们的大小。当您添加容器视图时，IB 会为您提供与它们一起使用的控制器——您可能必须删除它们，拖入导航控制器，并使用嵌入 segue 将它们重新连接到容器视图。

至于不能push或者显示split view controller，只需要在要显示split view时切换窗口的root view controller，如果要再显示其他controller再切换回来即可。

![在此处输入图像描述](../Images/88dfe8575ee7f12c02b3a946e0d17293.png)

# java - DefaultHttpClient 抛出 InvocationTargetException

> ID：13691453
> 
> 赞同：0
> 
> 时间：2012-12-03T20:50:36.683
> 
> 标签：java, rest, restful-authentication, apache-httpclient-4.x

我正在尝试使用 Java 使用 RESTful Web 服务，并且一直在关注[4.8 Preemptive Authentication](http://hc.apache.org/httpcomponents-client-dev/tutorial/html/authentication.html)的教程。

但是，我不断收到 InvocationTargetException 错误，并开始将代码的点点滴滴移出以追查源头。

我将代码简化为一个功能行：

```
import java.io.IOException;
import org.apache.http.impl.client.DefaultHttpClient;

public class TestRestClient() {

  public void doStuff() {
    DefaultHttpClient client = new DefaultHttpClient();
  }

} 
```

有任何想法吗？

编辑：[最终块中 getAllStackTrace() 的结果](http://pastebin.com/P92fHvWm)

# serial-port - 串行数据通信 Arduino

> ID：13691454
> 
> 赞同：0
> 
> 时间：2012-12-03T20:50:37.010
> 
> 标签：serial-port, arduino, deserialization

我目前正在尝试从小型电容表（JYETECH 的型号 DN060-02v04）读取串行输出。我设置了 arduino UNO 来读取仪表输出。我确实得到了数据，但它不可读，并且不符合手册中概述的格式。我的波特率匹配为 38400bps。该仪表声称采用 8-N-1 配置。我正在使用 Arduino 库中的 SerialSoftware 示例来阅读它。

```
#include <SoftwareSerial.h>

SoftwareSerial mySerial(2, 3); // RX, TX

void setup()  
{
  Serial.begin(38400);
  Serial.println("Begin");
  mySerial.begin(38400);
}

void loop() // run over and over
{
 if (mySerial.available())
    Serial.write(mySerial.read());
 if (Serial.available())
    mySerial.write(Serial.read());
} 
```

这就是我得到的：

```
3M$¦Ò)ºÁÁ¹aà3PL¦©ÊÁÁ¹eà3PL&rÂÉÁa\`à
3&ÓrÒÍÁa\`à
3PL&râÕÁa\bà
3M$¦+rÊÙÁa\dà3PL&+rÚáÁa\`à
3JiÂ¹ÁåA``\1¸3PL&SÉQÁÁ¹aà3N$¦SÉÁÁ¹eà3PL&S)Éi¢ÁÁ¹eà3L$¦S+Éu²ÁÁ¹aà
3PL&SKÉÚÁÁyaà
3&ÓSSÉIÊÁÁ¹aà3PL&+iÉ    ÁÁ¹eà
3M$¦SkÉAÒÁÁ¹eà
3PL&iÉÚÁÁ¹eà
3JiÒ¹ÉÕA``\0¸3PL&SÉaºÁÁ¹aà3N$¦S«É   ÂÁÁ¹eà3PL&S«ÉQÂÁÁ9eà
3L$¦S«ÉÁÁ¹aà3PL&3ÉÉ)ÚÁÁ¹aà
3&ÓSÓÉi¢ÁÁ¹aà3PL&SëÉ²ÁÁ¹eà3M$¦SëÉQºÁÁ¹ià3PL&SëÉÊÁÁ¹eà3Ii
¢Æá¹Ñe@``®¸Ã3PL&SrâÉÁa\`à
3N$¦S+rÊÑÁa\bà3PL&#)rÚÕÁa\bà
3L$¦ÉÚÁÁ9aà
3PL&ÉÂÁÁ¹aà3ÓS  É©ÁÁ¹aà3PL&+É1ÁÁ¹eà3M$¦
+ÉqÁÁ¹ià3PL&KÉ)ªÁÁ¹aà3JiÊ¹ÕÙA``\0¸3PL&IÉ©ÂÁÁ¹aà
3N$¦kÉ1ÊÁÁ¹eà
3PL&SiÉÁÁ¹ià3L$¦ÉIÒÁÁ¹aà
3PL&KÉÉâÁÁ¹aà
3&Ó³É   ²ÁÁ¹aà3PL&«ÉEºÁÁ¹eà3M$¦«É
ÊÁÁ¹ià3PL&ËÉ1ÁÁ¹aà3JiÚ¹ÝÉA``\1¸3PL&SéÉ)ÁÁ¹aà3N$¦ëÉ©ÊÁÁ9aà 
```

# c# - VS 2012 在错误的线程上中断

> ID：13691458
> 
> 赞同：2
> 
> 时间：2012-12-03T20:50:46.327
> 
> 标签：c#, multithreading, wcf, model-view-controller

我有一个多线程程序，并且在其中设置了许多断点。经常，当程序遇到断点时，我会看到一行代码以绿色突出显示，表示这是程序从当前函数返回时要执行的下一行代码。但是，被命中的断点实际上是在另一个线程上，在另一个源文件中。尽管实际上是导致中断的线程，但该行并未以黄色（或其他任何内容）突出显示。

到目前为止，我发现解决问题的唯一方法是停止程序执行，清理解决方案并重建整个解决方案。这大约有 70% 的效率，但我经常需要做几次。

可能相关的附加信息：该程序是用 C# 编写的，有问题的代码是 MVC 网站调用的 WCF 服务。所有这些都在我的本地机器上的 IIS7 下运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T20:59:56.253

您可以在调试中从一个线程转到另一个线程。

调试\Windows\线程[ctrl-alt-h]

您将获得线程列表。

请注意，在单步执行代码时，您可能会在线程之间切换。最好的选择是冻结其他线程。

# svg - SVG - 如何将图像裁剪为圆形？

> ID：13691463
> 
> 赞同：24
> 
> 时间：2012-12-03T20:50:55.327
> 
> 标签：svg

我对 SVG 有点陌生，但我一直在玩 D3，并且开始不了解基础知识。

我想要实现的是拍摄一个方形图像并将其裁剪为一个圆圈 - 这将代表我正在尝试绘制的树上的一个节点。

我能够通过为每个图像创建一个图案，然后用图案填充节点来实现这种效果。但是，当树上有多个节点时，这种方法的性能很糟糕。

所以，我正在寻找一种不同的方法。我可以将一个常规的“图像”对象作为我的节点，但显然它们只是作为普通矩形出现，我想将它们渲染为圆形。有人对如何在保持性能的同时屏蔽/裁剪图像以达到我想要的效果有任何建议吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-04T06:35:20.157

您可以使用剪辑路径，[如下所示](http://jsfiddle.net/cS5XS/)：

```
<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
  <clipPath id="clipCircle">
    <circle r="50" cx="50" cy="50"/>
  </clipPath>
  <rect width="100" height="100" clip-path="url(#clipCircle)"/>
</svg> 
```

将从矩形中“切出”一个圆圈。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-07T09:52:31.473

**如果您想使用 D3 以编程**方式生成与@Thomas 答案中相同的 html 代码， 您可以执行以下操作：

```
var svg = d3.select("body").append("svg")
  .attr("width", "100%")
  .attr("height", "100%");

svg.append("clipPath")
    .attr("id", "clipCircle")
  .append("circle")
    .attr("r", 50)
    .attr("cx", 50)
    .attr("cy", 50);

svg.append("rect")
    .attr("width", 100)
    .attr("height", 100)
    .attr("clip-path", "url(#clipCircle)"); 
```

# android - 获取 SQLite 可用空间 %

> ID：13691465
> 
> 赞同：1
> 
> 时间：2012-12-03T20:51:04.017
> 
> 标签：android, sqlite

有没有办法获得应用程序的 SQLite DB 可用的可用空间量？我看到[SQLiteDatabase.getMaximumSize()](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#getMaximumSize%28%29)返回数据库的最大大小，但是有没有办法获取数据库占用的当前字节数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T18:56:48.290

要回答您的问题，是的，有一种方法可以检查数据库当前使用了多少空间。正如 Joe 所说，您可以获取文件路径并检查文件的大小。

我以前使用这种方法来防止数据库增加到超过特定大小。将数据写入数据库后，我会调用一个函数来检查其大小并在必要时删除行。

```
public synchronized void checkDbSize()
{
    File f = m_context.getDatabasePath(DATABASE_NAME);
    long dbSize = f.length();

    if(dbSize > DB_SIZE_LIMIT)
    {
        //Delete X rows from DB
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T07:32:32.623

没有有意义的默认最大尺寸；您将首先遇到设备的存储大小限制。

您可以使用[sqlite-analyzer 之](http://www.sqlite.org/download.html)类的工具来估计您的数据在增长时可能占用多少空间，但没有简单的方法可以在运行时找出您离限制有多近。

如果您担心您的数据库变得太大，您必须定期清理旧数据。您不能使用[VACUUM](http://www.sqlite.org/lang_vacuum.html)（它会创建数据库文件的临时副本），但您可能希望启用[PRAGMA auto_vacuum](http://www.sqlite.org/pragma.html#pragma_auto_vacuum)，这至少可以确保数据库文件中未使用的页面不会超出范围。

# xpath - xpath 从父级中选择同级

> ID：13691470
> 
> 赞同：5
> 
> 时间：2012-12-03T20:51:41.570
> 
> 标签：xpath

我是xpath的新手，所以请原谅我。我有多个使用令牌的自动完成。我正在尝试根据parent`<p>`的文本选择 child并获取兄弟。`Some Text 1``div.title=title``span.remove-token`

例子

```
<div title="title">
    <ul class="token-list">
        <li class="input-token"
            <p>Some Text 1</p>
            <span class="remove-token">x</span>
        </li>
        <li class="input-token"
            <p>Some Text 2</p>
            <span class="remove-token">x</span>
        </li>
    </ul>
</div> 
```

我尝试过的

```
String path = "//div[contains(@title, 'title')]/p[text()="Some Text 1"]/following-sibling::span]"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T04:45:53.273

**使用**：

```
//div[@title = 'title']//li/p[. = 'Some Text 1']/following-sibling::span[1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-03T21:23:34.933

尝试

```
//div[contains(@title,'title')]//p[text()="Some Text 1"]/following-sibling::span 
```

有两个小错误：

1.  `]`表达式末尾有一个不必要的
2.  该`p`元素不是 的直接子元素`div`，因此您必须搜索所有后代

# jquery - 添加过渡到“熄灯”效果（css jQuery）

> ID：13691475
> 
> 赞同：0
> 
> 时间：2012-12-03T20:52:02.827
> 
> 标签：jquery, css-transitions

我正在尝试实现本教程中显示的“熄灯”效果：

我现在已经成功了。但我想添加一个过渡效果（使用 css），以便切换顺利进行，并具有很好的淡入淡出效果......

任何提示都会有所帮助......这是我正在尝试的代码，但我真的不知道......

这将是我对 jquery 的尝试：

```
 $(document).ready(function(){
    $("#ampolleta").css("height", $(document).height()).hide();
    $(".lightSwitcher").click(function(){
    $("#ampolleta").css("transform","opacity("+$(this).index() * -0.3+"s)");
        $("#ampolleta").toggle();
        if ($("#ampolleta").is(":hidden"))
            $(this).html("Turn off the lights").removeClass("turnedOff");
        else
            $(this).html("Turn on the lights").addClass("turnedOff");
    });
     }); 
```

这将是CSS：

```
 #ampolleta{
    position:absolute;
    left:0;
    top:0; 
    height: 768px;
    width: 100%;
    background: black;
    opacity: 0.75; 
    filter: alpha(opacity = 75); 
    zoom:1; 
    -webkit-transition: opacity 0.3s ease-in-out;
    -moz-transition: opacity 0.3s ease-in-out;
    -o-transition: opacity 0.3s ease-in-out;
    transition: opacity 0.3s ease-in-out;
    z-index: 100;
    }

   .lightSwitcher {
    position:absolute;
    z-index:101;
    text-decoration: none;
    }

.turnedOff {color:#ffff00; background-image:url(light_bulb.png);} 
```

您可能会注意到，我有点困惑，我真的不知道如何将 jquery 代码的功能与来自 css 的转换结合起来，但我有直觉认为转换应该来自 css 而不是jQuery...

因此，将考虑任何有用的方法转变。

谢谢！！

# mysql - 全文索引 - mysql

> ID：13691482
> 
> 赞同：1
> 
> 时间：2012-12-03T20:52:33.800
> 
> 标签：mysql

我们设置了一个全文索引，用于在网站 (mysql/php) 上进行搜索。

搜索在大多数情况下工作得很好，但我们不断遇到这些奇怪的错误。

例如：

1）这个作品：“中国炒锅”

2）这不是：“First Wok”

我的假设是第二个不起作用，因为：a）它踢出'wok'，因为它只有3个字母b）它踢出'first'，因为它在一些要忽略的单词列表中。

我的假设正确吗？

如果是这样，我将如何对两者进行调整：a）以某种方式将“first”列为在搜索中使用的词 b）以某种方式将“wok”列入白名单，尽管它只是一个 3 个字母的词

一如既往的感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T22:24:40.623

> 我的假设正确吗？

你在这两个方面都是正确的。如[自然语言全文搜索中所述](http://dev.mysql.com/doc/en/fulltext-natural-language.html)：

> 在全文搜索中会忽略某些词：
> 
> *   任何太短的单词都会被忽略。全文搜索找到的默认最小单词长度为四个字符。
>     
>     
> *   停用词列表中的单词将被忽略。停用词是诸如“the”或“some”之类的词，它非常常见，以至于被认为具有零语义值。有一个内置的停用词列表，但它可以被用户定义的列表覆盖。
>     
>     
> 
> 默认停用词列表在[第 12.9.4 节，“全文停用词”</a> 中给出。](http://dev.mysql.com/doc/en/fulltext-stopwords.html)[可以按照第 12.9.6 节“微调 MySQL 全文搜索”</a>](http://dev.mysql.com/doc/en/fulltext-fine-tuning.html)[中所述更改默认的最小字长和停用词列表。](http://dev.mysql.com/doc/en/fulltext-stopwords.html)
> 
> [](http://dev.mysql.com/doc/en/fulltext-fine-tuning.html)

[](http://dev.mysql.com/doc/en/fulltext-fine-tuning.html)

[如](http://dev.mysql.com/doc/en/fulltext-fine-tuning.html)[微调 MySQL 全文搜索中所述](http://dev.mysql.com/doc/en/fulltext-fine-tuning.html)：

> *   要索引的单词的最小和最大长度由[`ft_min_word_len`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_ft_min_word_len)和[`ft_max_word_len`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_ft_max_word_len)系统变量定义。（参见[第 5.1.4 节，“服务器系统变量”</a>。）默认最小值是四个字符；默认最大值取决于版本。如果更改任一值，则必须重建`FULLTEXT`索引。例如，如果您想搜索三个字符的单词，您可以](http://dev.mysql.com/doc/en/server-system-variables.html)[`ft_min_word_len`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_ft_min_word_len)通过将以下几行放入选项文件中来设置变量：
>     
>     
>     
>     ```
>     [mysqld]
>     ft_min_word_len=3
>     
>     ```
>     
>     
>     
>     然后重新启动服务器并重建`FULLTEXT`索引。请特别注意此列表后面的说明中有关[**myisamchk的注释。**](http://dev.mysql.com/doc/en/myisamchk.html)
>     
>     
> *   要覆盖默认停用词列表，请设置[`ft_stopword_file`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_ft_stopword_file)系统变量。（参见[第 5.1.4 节，“服务器系统变量”</a>。）变量值应该是包含停用词列表的文件的路径名，或者是禁用停用词过滤的空字符串。服务器在数据目录中查找文件，除非给出绝对路径名来指定不同的目录。更改此变量的值或停用词文件的内容后，重新启动服务器并重建`FULLTEXT`索引。](http://dev.mysql.com/doc/en/server-system-variables.html)
>     
>     [](http://dev.mysql.com/doc/en/server-system-variables.html)
>     
>     [停用词列表是自由格式的。也就是说，您可以使用任何非字母数字字符（例如换行符、空格或逗号）来分隔停用词。例外情况是下划线字符（“<code>_”）和单个撇号（“<code>'”），它们被视为单词的一部分。停用词列表的字符集是服务器的默认字符集；请参阅第 10.1.3.1 节，“<a href="http://dev.mysql.com/doc/en/charset-server.html" rel="nofollow">服务器字符集和排序规则](http://dev.mysql.com/doc/en/server-system-variables.html)”。

# database - 如何在 DB 中获取属性对象的属性

> ID：13691483
> 
> 赞同：0
> 
> 时间：2012-12-03T20:52:38.483
> 
> 标签：database, entity-framework, object, asp.net-mvc-4

我现在正在寻找某个时间，即使在这篇文章中，我也找不到任何解决我的问题的方法：

[asp.net mvc 3 - 你如何加载实体的子孙？](https://stackoverflow.com/questions/7239042/asp-net-mvc-3-how-do-you-load-children-and-grand-children-of-an-entity)

基本上我有3门课：

Offer.cs、Application.cs 和 Contractor.cs

1 个优惠包含应用程序集合

1 个应用程序包含 1 个承包商。

* * *

基本上我想在视图中获取作为 null 的 Contractor 对象。谢谢你的帮助！！！！

代码如下：

**看法**

```
@foreach (var item in Model)
{
foreach (var candidate in item.Candidates)
    {
       Here is the problem #### canditate.Contractor == null ### 
```

**控制器**

```
public ActionResult Index () {
 return View (db.Offers.Include(c => c.Location).Include(c => c.Candidates).ToList ());
} 
```

**模型**

```
public class Offer {

public Location Location { get; set }
public ICollection<Application> Candidates { get; set; }

}

public class Application {
    public Contractor Contractor { get; set}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:02:00.963

你可以试试

```
db.Offers.Include("Location.Candidates").ToList() 
```

这应该加载所有位置以及这些位置的所有相关候选人（尽管我不知道使用 lambda 执行此操作的方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:38:43.227

您可以使用...

```
return View(db.Offers
    .Include(o => o.Location)
    .Include(o => o.Candidates.Select(c => c.Contractor))
    .ToList()); 
```

...在您的`Index`行动中，以便将`Contractor`孙辈与孩子们一起加载`Candidates`。

# python - 在 Pandas 中合并两个数据框的问题

> ID：13691485
> 
> 赞同：0
> 
> 时间：2012-12-03T20:52:48.707
> 
> 标签：python, pandas, dataset

我正在尝试合并两个数据框，但遇到了问题。我在正确数据框中的列中只得到 NaN。

这就是我所做的：

```
X = read_csv('fileA.txt',sep=',',header=0);
print "-----FILE DATA-----"
print X;
X = X.astype(object); # convert every column to string type? does it do it?
print "-----INTERNALS-----"
pprint(vars(X));

Y = file_to_dataframe('fileB.txt',',',0); 
print "-----FILE DATA-----"
print Y;
print "-----INTERNALS-----"
pprint(vars(Y));

Z = merge(X,Y,how='left');
print Z;
sys.exit(); 

Y = file_to_dataframe('tmp.chr20.thresh.frq.count','\t',0);
print Y.dtypes;

def file_to_dataframe(filename,sep,header): # list of dict's
    i = 0; k = 0;
    cols = list();
    colNames = list();
    for line in fileinput.input([filename]):
        line = line.rstrip('\n');
        lst = line.split(sep);
        if i == header: #  row number to use as the column names
            for colName in lst:
                colNames.append(colName);
        elif i > header:
            j = 0;
            record = dict();
            for j in range(0,len(lst)): # iterate over all tokens in the current line
                if j >= len(colNames):
                    colNames.append('#Auto_Generated_Label_'+ str(k));
                    k += 1;
                record[colNames[j]] = lst[j];
            cols.append(record); # push the record onto stack
        i += 1;
    return DataFrame.from_records(cols); 
```

这是输出：

-----文件数据-----

```
 Chrom      Gene  Position

0     20    DZANK1  18446022

1     20      TGM6   2380332

2     20  C20orf96    271226 
```

-----内部-----

```
{'_data': BlockManager

Items: array([Chrom, Gene, Position], dtype=object)

Axis 1: array([0, 1, 2])

ObjectBlock: array([Chrom, Gene, Position], dtype=object), 3 x 3, dtype object,

 '_item_cache': {}} 
```

-----文件数据-----

```
 Chrom  Position Random

0    20  18446022    ABC

1    20   2380332    XYZ

2    20    271226    PQR 
```

-----内部-----

```
{'_data': BlockManager

Items: array([Chrom, Position, Random], dtype=object)

Axis 1: array([0, 1, 2])

ObjectBlock: array([Chrom, Position, Random], dtype=object), 3 x 3, dtype object,

 '_item_cache': {}}

  Chrom      Gene  Position Random

0    20  C20orf96    271226    NaN

1    20      TGM6   2380332    NaN

2    20    DZANK1  18446022    NaN 
```

如您所见，那里有一列NaN，其中应该有来自Y中随机列的值。关于如何调试它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T02:37:59.457

为我工作（v0.10.0b1，虽然我有点自信——但尚未检查——这也适用于 0.9.1）：

```
In [7]: x
Out[7]: 
   Chrom      Gene  Position
0     20    DZANK1  18446022
1     20      TGM6   2380332
2     20  C20orf96    271226

In [8]: y
Out[8]: 
   Chrom  Position Random
0     20  18446022    ABC
1     20   2380332    XYZ
2     20    271226    PQR

In [9]: pd.merge(x, y, how='left')
Out[9]: 
   Chrom      Gene  Position Random
0     20    DZANK1  18446022    ABC
1     20      TGM6   2380332    XYZ
2     20  C20orf96    271226    PQR 
```

我很惊讶所有的列都是对象 dtype。您的数据一定存在某种解析问题——检查每一列中的值（不是它们的样子，而是它们实际上*是*什么，字符串，整数，什么？）

# java - Android序列化——java反序列化

> ID：13691489
> 
> 赞同：0
> 
> 时间：2012-12-03T20:53:02.983
> 
> 标签：java, android, serialization, udp, datagram

我在将对象从我的 Android 应用程序发送到我的 Java 应用程序时遇到了一些问题。我有一个完全相同的可序列化类。

当我在接收端使用以下代码将对象从一个 java 应用程序发送到另一个应用程序时，它工作得很好：

```
@Override
public void run() {
    super.run();
    while(true){
        try{
            if(datagramSocket!=null)datagramSocket.close();
            datagramSocket = new DatagramSocket(PORT);
            buffer = new byte[4096];
            inPacket = new DatagramPacket(buffer, buffer.length);
            datagramSocket.receive(inPacket);

            InetAddress clientAddress = inPacket.getAddress();
            int clientPort = inPacket.getPort();

            ByteArrayInputStream bais = new ByteArrayInputStream(buffer);
            ObjectInputStream ois = new ObjectInputStream(new BufferedInputStream(bais));
            Song song = (Song) ois.readObject();
            song.setClientIP(inPacket.getAddress());
            dc.addSong(song);
            datagramSocket.close();

        }catch (IOException e) {
            System.out.println("IOException on receiving song: " + e);
        } catch (ClassNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

但是当我尝试在android中做同样的事情时（所以将歌曲对象从android发送到java）我得到了一个ClassCastException：

```
[Lcom.audiobuddy.serializables.Song; cannot be cast to com.audiobuddy.serializables.Song 
```

一开始我以为是因为包名不一样，所以两边都改成“com.audiobuddy.serializables”。但是我看看我的错误，Android应用程序更改了包，在前面添加了“[L”和“;” 在后面...

两侧的 Song 类具有相同的 serialVersionUID

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:55:27.447

错误消息说您尝试将 Song[]（`[L(...)Song`表示 Song 数组）转换为 Song。

您可能应该使用以下内容更改您的`ois.readObject();`-line：

```
Song[] songs = (Song[]) ois.readObject();
Song song = songs[0]; 
```

# c# - 从 C# 中的重复字符串中确定唯一字符串

> ID：13691491
> 
> 赞同：2
> 
> 时间：2012-12-03T20:53:04.003
> 
> 标签：c#, .net, string, string-parsing

我需要开发一种有效的算法来确定给定具有重复内容（并且仅重复内容）的字符串的唯一（重复）字符串...

例如：

`"AbcdAbcdAbcdAbcd"`=>`"Abcd"`

`"Hello"`=>`"Hello"`

我在想出一个相当有效的算法时遇到了一些麻烦；任何意见将不胜感激。

澄清：我想要**最短的字符串，当重复足够多次时，等于总字符串**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:15:21.087

```
 private static string FindShortestRepeatingString(string value)
    {
        if (value == null) throw new ArgumentNullException("value", "The value paramter is null.");

        for (int substringLength = 1; substringLength <= value.Length / 2; substringLength++)
            if (IsRepeatingStringOfLength(value, substringLength))
                return value.Substring(0, substringLength);
        return value;
    }

    private static bool IsRepeatingStringOfLength(string value, int substringLength)
    {
        if (value.Length % substringLength != 0)
            return false;
        int instanceCount = value.Length / substringLength;
        for (int characterCounter = 0; characterCounter < substringLength; characterCounter++)
        {
            char currentChar = value[characterCounter];
            for (int instanceCounter = 1; instanceCounter < instanceCount; instanceCounter++)
                if (value[instanceCounter * substringLength + characterCounter] != currentChar)
                    return false;
        }
        return true;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:06:32.997

像这样的东西：

```
public string ShortestRepeating(string str)
{
    for(int len = 1; len <= str.Length/2; len++)
    {
        if (str.Length % len == 0)
        {
            sub = str.SubString(0, len);
            StringBuilder builder = new StringBuilder(str.Length)
            while(builder.Length < str.Length)
                builder.Append(sub);
            if(str == builder.ToString())
                return sub;
        }
    }
    return str;
} 
```

这只是从头开始查看子字符串，然后重复它们以查看它们是否匹配。它还会跳过任何长度不均匀地划分为原始字符串长度并且仅上升到 length / 2 的任何内容，因为超过该长度的任何内容都不能成为重复的候选对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T21:11:27.203

也许这可以工作：

```
static string FindShortestSubstringPeriod(string input)
{
  if (string.IsNullOrEmpty(input))
    return input;

  for (int length = 1; length <= input.Length / 2; ++length)
  {
    int remainder;
    int repetitions = Math.DivRem(input.Length, length, out remainder);        
    if (remainder != 0)
      continue;
    string candidate = input.Remove(length);
    if (String.Concat(Enumerable.Repeat(candidate, repetitions)) == input)
      return candidate;
  }
  return input;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:22:33.170

我会用这样的东西：

```
private static string FindRepeat(string str)
{
    var lengths = Enumerable.Range(1, str.Length - 1)
        .Where(len => str.Length % len == 0);

    foreach (int len in lengths)
    {
        bool matched = true;

        for (int index = 0; matched && index < str.Length; index += len)
        {
            for (int i = index; i < index + len; ++i)
            {
                if (str[i - index] != str[i])
                {
                    matched = false;
                    break;
                }
            }
        }

        if (matched)
            return str.Substring(0, len);
    }

    return str;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-04T14:35:03.253

试试这个正则表达式：

```
^(\w*?)\1*$ 
```

它捕获尽可能少的字符，其中捕获的序列（并且仅捕获的序列）重复 0 次或更多次。根据 Jacob 的回答，您可以在之后的捕获中获取最短匹配的文本。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-03T21:08:20.350

您可以使用带有反向引用的正则表达式。

```
Match match = Regex.Match(@"^(.*?)\0*$");
String smallestRepeat = match.Groups[0]; 
```

# linux - 以不同用户身份运行钥匙串

> ID：13691492
> 
> 赞同：0
> 
> 时间：2012-12-03T20:53:08.107
> 
> 标签：linux, ssh

为了稍微提高安全性，我想以`keychain`不同的用户身份运行代理。这将防止劫持我的系统的用户获得实际的私钥，同时保持使用它进行身份验证`ssh`和`scp`连接的能力。

我尝试了什么？

我创建了一个名为`agent`谁应该存储私钥并运行 ssh-agent 进程的用户。我创建了一个脚本文件来为套接字设置正确的权限：

```
#!/bin/sh
export EVAL=$(keychain --eval -q)
eval $EVAL
chmod 770 $(dirname $SSH_AUTH_SOCK) $(dirname $GPG_AGENT_INFO)
chmod 660 $SSH_AUTH_SOCK $(echo $GPG_AGENT_INFO | sed 's/:.*//')
echo $EVAL 
```

并在我`.bashrc`的 eval'ing 中调用它。

但是当我现在通过 连接到服务器时`ssh`，我得到

```
$ ssh server
Error reading response length from authentication socket. 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T01:18:16.080

`keychain`似乎使用了已经运行的`ssh-agent`或`gpg-agent`，并在需要时启动一个。

`ssh-agent`检查正在运行的进程的用户 id 是否与通过 unix 域套接字连接的用户的 id 匹配（root 除外）。如果您在调试模式下运行代理，您将看到相应的错误消息。在这种情况下，套接字会立即关闭，因此您会收到上面提到的错误消息 - 您可能正在`ssh-agent`您的系统上使用。这意味着您尝试做的事情将无法使用`ssh-agent`（除非您不修改它）。

如果您使用`gpg-agent`该`--enable-ssh-support`选项作为 的替代品，它应该可以工作`ssh-agent`，但您应该知道，此设置并不能真正提高安全性。使用您尝试设置的权限，它将允许每个有权访问套接字的用户在解锁后使用添加的密钥进行身份验证，因此它实际上不太安全。

# c# - 没有名称字段的Json反序列化

> ID：13691493
> 
> 赞同：1
> 
> 时间：2012-12-03T20:53:11.477
> 
> 标签：c#, json, windows-phone-7, .net-4.0

我需要反序列化以下Json，根据Jsonlint.com，它是有效的，但我之前没有遇到过或者找不到类似Json的例子以及如何处理它？

```
[1,"Bellegrove  / Sherwood ","76705","486","Bexleyheath Ctr",1354565507000] 
```

我目前的系统是这样的：

数据类：

```
[DataContract]
public class TFLCollection 
{ [DataMember(Name = "arrivals")]
    public IEnumerable<TFLB> TFLB { get; set; } 
}
[DataContract]

public class TFLB
{ 
    [DataMember]
    public string routeName { get; set; }
    [DataMember]    
    public string destination { get; set; }
    [DataMember]    
    public string estimatedWait { get; set; } 
} 
```

解串器：

```
DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(TFLCollection));

                using (var stream = new MemoryStream(Encoding.Unicode.GetBytes(result))) 
                {     var buses = (TFLCollection)serializer.ReadObject(stream);
                foreach (var bus in buses.TFLBuses)     
                    {
                        StopFeed _item = new StopFeed();

                         _item.Route = bus.routeName;
                          _item.Direction = bus.destination;
                          _item.Time = bus.estimatedWait;

                          listBox1.Items.Add(_item); 
```

我现有的反序列化器与完整的 Json 流一起工作并遍历它，但在我的新 Json 中我需要反序列化，它只有 1 个项目，所以我不需要遍历它。

那么是否可以使用与我目前类似的方法来反序列化我的 Json 示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T20:57:07.833

我会说你试图使事情过于复杂。你所拥有的是一个完美形成的 json 字符串数组。如果我是你，我会先将其反序列化为 .net 数组，然后编写一个“映射器”函数来复制这些值：

```
public TFLB BusRouteMapper(string[] input)
{
    return new TFLB {
        Route = input[x],
        Direction = input[y],
    };
} 
```

等等。当然，这假设您知道 json 的顺序，但是如果您首先尝试这样做，那么您必须这样做！

# asp.net - 获取 HTTP 响应自定义标头时出错

> ID：13691498
> 
> 赞同：3
> 
> 时间：2012-12-03T20:53:26.547
> 
> 标签：asp.net, http, http-headers, webforms

我正在尝试`HttpContext.Current.Response.AddHeader("e1","example of an exception");`在 Page_Load 方法中向 HTTP 响应添加自定义标头 -> e1，当我在 chrome 开发人员工具中检查它时，它工作正常。

![U+25BC](../Images/88b8ad3aedef54a900ac30b139fa4733.png)

问题是如果我尝试使用以下方法编写相同的响应： `HttpContext.Current.Response.Write(HttpContext.Current.Response.Headers["ALL_HTTP"].ToString());` 它会导致*PlatformNotSupportedException：此操作需要 IIS 集成管道模式。*

所以主要问题是如何读取添加的响应头，因为我使用的是内置的 VS 开发服务器？**如果您能推荐一些文章或书籍来了解如何正确**使用 HTTP 标头和动词
，那就太好了。

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T15:08:27.037

如果您想将该变量直接写入响应，那么您只需在 Page_Load 中调用它即可。这将避免 IIS 集成管道模式要求。

```
Page.Response.Write(Request.ServerVariables["ALL_HTTP"]); 
```

对于学习，我将专注于学习 HTTP 和 REST。

*   有趣的 REST 入门[http://tomayko.com/writings/rest-to-my-wife](http://tomayko.com/writings/rest-to-my-wife)
*   HTTP: The Definitive Guide by David Gourley（一本厚实的书，将引导您从简单的 HTTP 协议进入更高级的概念）
*   [http://www.w3.org/Protocols/rfc2616/rfc2616.html](http://www.w3.org/Protocols/rfc2616/rfc2616.html)上的HTTP 1.1 规范（由权威机构干读）**

# javascript - 这里有什么问题，为什么 innerHTML 不起作用？

> ID：13691509
> 
> 赞同：-4
> 
> 时间：2012-12-03T20:53:52.243
> 
> 标签：javascript, innerhtml

我想问一下为什么 innerHTML 在以下代码中不起作用：

```
document.getElementById('text').innerHTML = localStorage["mytext"]; 
```

带有 id 文本的元素是一个 div 元素。如果我将它与警报一起使用，localStorage 会给我正确的字符串，错误可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:56:55.427

在尝试引用它之前确保 div 存在，

```
window.addEventListener("load",function() {
    document.getElementById('text').innerHTML = localStorage.getItem("mytext");
},false); 
```

这将在进行任何修改之前等待文档加载

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:23:09.020

你能检查一下 localStorage["text"] 是否真的返回一个字符串？也许这个链接可以帮助你检查它是否真的是一个字符串。

[https://stackoverflow.com/a/9729103/1873758](https://stackoverflow.com/a/9729103/1873758)

# p2p - 与 peersim 抄写员

> ID：13691513
> 
> 赞同：1
> 
> 时间：2012-12-03T20:54:10.543
> 
> 标签：p2p, publish-subscribe

有没有人可以提供任何有用的信息来使用 peersim 完成发布/订阅协议“Scribe”？我已经有了论文和演示文稿，对我的需要没有太大帮助，我了解算法，但我的问题主要是 peersim。

我在处理发送和接收时遇到了一些小问题。我已经在 t-man 上建立了一个对等采样服务。T-man 总是给出一个包含节点的列表，一个节点（或者更好的我自己，对于每个循环）都知道。

# vim - 让 Vim 打开像 Sublime Text 2 这样的新块

> ID：13691515
> 
> 赞同：1
> 
> 时间：2012-12-03T20:54:17.683
> 
> 标签：vim, sublimetext2

在崇高的文本 2 中，当您：

`BLOCK { <Return>`

它生成（管道是光标）：

```
BLOCK {
  |
} 
```

我怎样才能让 Vim 表现得这样？

我有`autoindent`开和`smartindent`关，因为`smartindent`它在返回时这样做：

```
BLOCK {
 |} 
```

更清楚地说，我特别在寻找 2 个返回，向上移动一行，并在（具体为 2 个软标签）中添加标签。我已经让它自动匹配字符，如,`{`等。`(``[`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:46:54.500

一个简单的映射将适用于大多数目的：

```
imap {<cr> {<cr>}<c-o>O 
```

根据插件的不同，一些用户可能需要`inoremap`而不是`imap`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:38:59.123

之前是 TextMate，现在是 ST2。

你面前基本上有两条路。

*   **“愚蠢”的道路**

    可以想出这种方法的几十种变体：您只需创建一个映射来执行实现目标所需的一系列按键：

    ```
    inoremap {<CR> {<cr><cr>}<C-o>k<tab> 
    ```

    我称它为“愚蠢”，但这并不意味着你会愚蠢地使用它：它技术含量低，没有依赖关系，易于定制，并且可以映射到任何你喜欢的东西。

*   **“聪明”的方法**

    此方法涉及使用插件。我使用[DelimitMate](http://www.vim.org/scripts/script.php?script_id=2754)，但还有[很多其他的，](http://www.vim.org/scripts/script_search_results.php?keywords=pair&script_type=&order_by=rating&direction=descending&search=search)选择你的毒药。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:57:12.853

我对 vim 插件做了一些快速挖掘（这通常是这类问题的解决方案）。我认为我没有找到您想要的：有[一些接近的插件](https://stackoverflow.com/questions/883437/how-do-i-get-vim-to-automatically-put-ending-braces)，但没有在右大括号之前插入额外的换行符。

你*可以*做类似的事情

```
imap { {<return><return>}<up><tab> 
```

但是，如果您使用在其他情况下使用大括号的语言工作，这将变得很尴尬。您可以改为对换行做出反应：

```
inoremap <return> <return><return>}<up><tab> 
```

当然，这将在每个输入的换行符上触发，而不仅仅是在左大括号后面的那些。要让它检查大括号是否是当前行的最后一个字符，您可以：

*   有一个看起来像的函数（在 ~/.vimrc 或 ~/.vim/plugin 的某个地方）

    ```
    function! CloseBraceIfOpened()
      if getline(".")[-1:] == '{'
        " insert a space and then delete it to preserve autoindent level
        exec "normal o "
        normal x
        normal o}
        normal k
      else
        normal o
      endif
    endfunction 
    ```

*   也做

    ```
    inoremap <buffer> <enter> <esc>:call CloseBraceIfOpened()<enter>A 
    ```

请注意，这`imap`是特定于缓冲区的，因此映射仅适用于您在运行它时所在的缓冲区。要将其应用于所有缓冲区，请删除`<buffer>`.

如果你真的有野心/特别，你可以在函数中做测试，看看当前行中的代码是否真的打开了一个块。

要使缩进按您想要的方式工作，请打开“自动缩进”和[“智能缩进”](http://vimdoc.sourceforge.net/htmldoc/options.html#'smartindent')设置。

```
: set autoindent smartindent 
```

要默认启用它，请添加

```
set autoindent smartindent 
```

到`~/.vimrc`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T00:13:27.750

我使用以下地图：

```
inoremap {{ {<CR><CR>}<ESC>kcc 
```

所以`{<CR>`我没有使用这个映射。除此之外，我还使用 romainl 提到的插件，DelimitMate 用于其他带大括号的映射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-06T14:47:34.140

我有同样的问题，delimitMate 解决了它。安装后，您可以通过以下方式启用它：

```
let g:delimitMate_expand_cr = 1 
```

有很多技巧可以提供 SublimeText 体验。因为我感到沮丧，所以我创建了一个项目，该项目在单个 vim 发行版中包含所有这些功能（无需安装/编译外部插件/工具）。

您可以从这里查看：[https ://github.com/fatih/subvim](https://github.com/fatih/subvim)

# jquery - jQuery UI 选项卡动态 AJAX 错误 IE7

> ID：13691518
> 
> 赞同：0
> 
> 时间：2012-12-03T20:54:36.680
> 
> 标签：jquery, jquery-ui, internet-explorer-7

我有一个使用具有静态和动态内容的 jQuery UI 选项卡的页面。我正在尝试`cache`加载选项卡后的选项卡内容，因此如果用户关闭选项卡然后想要重新进入，我不必再次返回服务器，并且可以制作选项卡显示在选项卡列表的末尾。这在 FF、Chrome、Safari、Opera 以及 IE 8 和 9 中效果很好。但是，IE7 给我带来了麻烦。

这是我制作的一个[jsFiddle ，它演示了这个问题。](http://jsfiddle.net/73CCR/7/)据我所知，这个问题似乎`beforeLoad`是即使在内容加载一次之后也调用了该函数。我知道我应该使用`cache: true`缓存选项，但是由于用户可以关闭选项卡然后尝试返回它，我认为这可能会更优雅一点。

要复制问题：

1.  单击`Dynamic 1`按钮。将出现一个新选项卡`Dyn 1`，其中包含一些内容
2.  离开选项卡（通过关闭它或单击其他选项卡）
3.  单击返回`Dyn 1`选项卡。内容现在将显示`unable to load dynamic tab`

正如我所做的那样，在使用 jQuery UI 的`cache: true`选项和在函数中更改选项卡的`href`属性时都会发生这种情况。`load`

有没有人有过类似的经历和/或知道我可能做错了什么导致这种情况？

谢谢你。您的帮助总是值得赞赏的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T14:58:07.130

我永远无法回答为什么会发生这种行为。但是，我确实找到了一个可行的解决方案。万一其他人碰巧遇到同样问题的这个答案，我就是这样解决的：

改变：

```
beforeLoad: function(evt, ui) {
    ui.jqXHR.error(function(jqXHR) {
        ui.panel.html('Unable to load application');
    });
} 
```

至：

```
beforeLoad: function(evt, ui) {
    ui.jqXHR.error(function(jqXHR) {
        if(jqXHR.statusText !== 'canceled') {
            ui.panel.html('Unable to load application');
        }
    });
} 
```

为什么`beforeLoad`即使发生`cache: true`或更改`href`选项卡的选项卡也会调用该方法，我仍然不确定。我将把它提交到 jQuery 错误论坛，看看他们怎么说。如果这是一个错误，我会尝试用票更新这篇文章。

# dojo - 带有dojo 1.8的简单jsfiddle示例不起作用

> ID：13691519
> 
> 赞同：1
> 
> 时间：2012-12-03T20:54:48.343
> 
> 标签：dojo, jsfiddle

这个使用 dojo 1.8 的简单 jsfiddle 示例有什么问题：http: [//jsfiddle.net/ractive/qKW2G/3/](http://jsfiddle.net/ractive/qKW2G/3/)

尽管 parseOnLoad 在 data-dojo-config 属性中设置为 true，但在启动时不会加载按钮小部件：

```
data-dojo-config="async: true, parseOnLoad: true" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:36:20.710

如果使用 运行`async: true`，则需要在 require 中包含解析器和按钮。

```
require(["dojo/parser", "dojo/on", "dojo/dom", "dijit/form/Button"], 
  function(parser, on, dom) {
    ...
});​ 
```

如果您使用 运行`async: false`，则将自动需要解析器和小部件。

# c++ - 如何使用 libssh 和 SFTP 在 C/C++ 中复制文件

> ID：13691520
> 
> 赞同：11
> 
> 时间：2012-12-03T20:54:48.867
> 
> 标签：c++, c, ssh, sftp, libssh

我想将文件从客户端复制到远程服务器，但我不明白如何使用 libssh 库 SFTP API 来执行此操作。

情况是：SSH会话打开了，SFTP会话也打开了，我可以用libssh的集成功能创建一个文件并从客户端写入到服务器。

我没有找到一种简单的方法来使用像**sftp_transfer(sourceFile(like c:\my document\hello world.txt),RemoteFile(/home/user/hello world.txt) 这样的简单函数将文件从客户端复制到服务器),对(读写))** ?

根据我从教程中了解到的内容，它首先在远程位置（服务器）中创建一个文件，然后使用这行代码打开这个文件：

```
file = sftp_open(sftp, "/home/helloworld.txt",access_type,1); 
```

之后在服务器上创建文件，然后用缓冲区写入这个创建的文件：

```
const char *helloworld = "Hello, World!\n";
int length = strlen(helloworld);
nwritten = sftp_write(file, helloworld, length); 
```

我现在的问题是，如果我有一个文件，例如一个 .doc 文件，并且我想将该文件从远程服务器传输/上传`c:\mydocument\document.doc`到远程服务器`/home/user/document.doc`，我该如何使用这种方法呢？

如何将此文件放入函数中以像[示例函数中的 helloworld](http://api.libssh.org/master/libssh_tutor_sftp.html)`sftp_write()`一样发送它？

我可能在编程方面不够好，无法理解，但我真的试图理解它并且我坚持下去。

在此先感谢您的帮助

请参阅下面我用来测试的代码示例：

```
// Set variable for the communication
char buffer[256];
unsigned int nbytes;

//create a file to send by SFTP
int access_type = O_WRONLY | O_CREAT | O_TRUNC;
const char *helloworld = "Hello, World!\n";
int length = strlen(helloworld);

//Open a SFTP session
sftp = sftp_new(my_ssh_session);
if (sftp == NULL)
{
    fprintf(stderr, "Error allocating SFTP session: %s\n",
    ssh_get_error(my_ssh_session));
    return SSH_ERROR;
}
// Initialize the SFTP session
rc = sftp_init(sftp);
if (rc != SSH_OK)
{
    fprintf(stderr, "Error initializing SFTP session: %s.\n",
    sftp_get_error(sftp));
    sftp_free(sftp);
    return rc;
}

//Open the file into the remote side
file = sftp_open(sftp, "/home/helloworld.txt",access_type,1);
if (file == NULL)
{
    fprintf(stderr, "Can't open file for writing: %s\n",ssh_get_error(my_ssh_session));
    return SSH_ERROR;
}

//Write the file created with what's into the buffer
nwritten = sftp_write(file, helloworld, length);
if (nwritten != length)
{
    fprintf(stderr, "Can't write data to file: %s\n",
    ssh_get_error(my_ssh_session));
    sftp_close(file);
    return SSH_ERROR;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T21:29:30.983

以通常的方式打开文件（使用 C++ 的[fstream](http://en.cppreference.com/w/cpp/io)或 C 的[stdio.h](http://en.cppreference.com/w/cpp/io/c)），将其内容读取到缓冲区，然后将缓冲区传递给`sftp_write`.

像这样的东西：

```
ifstream fin("file.doc", ios::binary);
if (fin) {
  fin.seekg(0, ios::end);
  ios::pos_type bufsize = fin.tellg();   // get file size in bytes
  fin.seekg(0);                          // rewind to beginning of file

  std::vector<char> buf(bufsize);        // allocate buffer
  fin.read(buf.data(), bufsize);         // read file contents into buffer

  sftp_write(file, buf.data(), bufsize); // write buffer to remote file
} 
```

请注意，这是一个非常简单的实现。您可能应该以附加模式打开远程文件，然后以块的形式写入数据，而不是发送单个巨大的数据块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-09-24T10:46:50.337

以下示例[`ifstream`](https://en.cppreference.com/w/cpp/io/basic_ifstream)在循环中使用以避免将整个文件加载到内存中（正如接受的答案所做的那样）：

```
ifstream fin("C:\\myfile.zip", ios::binary);

while (fin)
{
    constexpr size_t max_xfer_buf_size = 10240
    char buffer[max_xfer_buf_size];
    fin.read(buffer, sizeof(buffer));
    if (fin.gcount() > 0)
    {
        ssize_t nwritten = sftp_write(NULL, buffer, fin.gcount());
        if (nwritten != fin.gcount())
        {
            fprintf(stderr, "Error writing to file: %s\n", ssh_get_error(ssh_session));
            sftp_close(file);
            return 1;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-12-07T16:05:51.280

[我用了这里](http://api.libssh.org/master/libssh_tutor_sftp.html)的例子。

`sftp_read_sync`使用无限循环将文件从服务器读取到`/path/to/profile` 服务器路径`/etc/profile`。

# ruby-on-rails - 自定义 Rails 未捕获的异常日志记录

> ID：13691524
> 
> 赞同：3
> 
> 时间：2012-12-03T20:55:01.790
> 
> 标签：ruby-on-rails, logging

因此，如果我的 Rails 应用程序中有未捕获的异常，它会被记录，并带有堆栈跟踪。

伟大的。但我实际上想关闭“INFO”级别的日志记录，只记录WARN/ERROR/FATAL。

这意味着，对于未捕获的异常，我真的希望它记录更多关于*当前请求*的信息，而不仅仅是异常名称和堆栈跟踪。我想要请求参数，请求 URI，我什至想要请求客户端 IP 和用户代理。

我很难找到要定制的 Rails 的哪个部分来获得这个。无论是单独通过配置还是通过覆盖方法，甚至通过猴子修补——我都无法弄清楚这实际上发生在哪里。

那是因为它在中间件中关闭了吗？呸! 无论哪种方式...有关实际执行此操作的最简单方法的任何提示？

（令人惊讶的是，Rails 并没有让这变得简单，不是吗？这似乎不是什么不寻常的事情？是因为每个关心的人都在使用一些第三方平台来捕获这些东西而不是日志文件吗？我不是，呵呵。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T19:32:09.653

[您可以通过使用rescue_from](http://apidock.com/rails/ActionController/Rescue/ClassMethods/rescue_from/)捕获所有异常来添加额外的异常处理。

例如，您可以将其添加到您的 application_controller.rb：

```
rescue_from Exception, :with => :internal_error

def internal_error(e)
   logger.error request.fullpath
   raise e
end 
```

通过重新提出原始异常，您可以确保 rails 也能看到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-17T12:20:26.980

请参阅[https://github.com/rails/rails/issues/9343](https://github.com/rails/rails/issues/9343)，目前尚不支持。似乎 DebugExceptions 中间件正在记录这一点。我看到 atm 的唯一解决方案是使用 config.middleware.swap 换出这个中间件并用自定义版本替换它。

# templates - Meteor 可编程模板或通配符模板

> ID：13691525
> 
> 赞同：1
> 
> 时间：2012-12-03T20:55:07.020
> 
> 标签：templates, meteor, handlebars.js

我想对屏幕上的多个聊天室实例使用相同的代码。

假设我想同时在屏幕上显示 6 个聊天室，但每个聊天室都使用相同的模板，呃，模板，但实例不同，但仍然能够以 Meteor 方式独立做出反应。

我该怎么做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T07:45:09.527

您可以拥有一个`collection`聊天室，并使用`each`帮助程序遍历每个当前聊天室。在该迭代器内部，您将有另一个模板用于`chatroom`. 然后，您实际上会为多个聊天室使用相同的模板。这是 Meteor 非常常见的设计模式。

```
<template name='chatrooms'>
  {{#each chatrooms}}
    {{>chatroom}}
  {{/each}}
</template>

<template name='chatroom'>
  <div class='room'>
  {{name}}
  <ul>
   {{#each messages}}
    <li>{{text}}</li>
   {{/each}}
  </ul>
  </div>
</template> 
```

# iphone - IOS 配置门户 - 设备不是唯一的

> ID：13691529
> 
> 赞同：4
> 
> 时间：2012-12-03T20:55:20.077
> 
> 标签：iphone, ios, xcode, ipad, provisioning

我正在做一个项目，为此我购买了几台 iPad mini。我将两台 iPad 作为设备添加到配置门户。然后我尝试修改我的配置文件并单击两个设备以将它们添加到证书中。当我点击保存/提交将设备添加到证书时，我收到以下错误，“所选设备不是唯一的。请选择唯一的设备。”

两个设备在门户中具有不同的名称和不同的 UDID。我担心这个问题可能与通过 Xcode 4.5 添加设备有关，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T23:01:58.267

我最终解决了这个问题。当我通过 Xcode 添加设备时，其中一个设备以某种奇怪的故障以某种方式添加了两次，但有两个不同的名称。删除我猜确实有重复 udid 的额外设备解决了这个问题。这也阻止了其他设备，尽管这些设备在系统中没有重复的 udid。希望这可以帮助任何可能遇到此问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:07:26.193

我以前也有类似的问题。解决方法是只创建一个新的配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-25T16:32:54.510

可能是 udid：（对于 IOS7，需要新方法来获取 udid）。

[开发人员门户添加设备的问题](https://stackoverflow.com/questions/19378093/issue-with-developer-portal-added-device/19594548#19594548)

# c++ - 如何在 Objective C++ 标头中包含 C++ 标头？

> ID：13691539
> 
> 赞同：14
> 
> 时间：2012-12-03T20:56:12.353
> 
> 标签：c++, ios, import, include, objective-c++

我有一个 .cpp/.hpp 文件组合 -> .hpp 文件有 #include ..

我还有一个 .mm/.h 文件组合 -> 如果我在 .mm Objective C++ 文件中包含 .hpp 文件，则没有问题。但是，如果我尝试在 .h（Objective C 头文件）文件中包含 .hpp 文件，则会收到预处理器问题“找不到 iostream”。

除了在我的 Objective C .h 文件中有一个 void* 然后将其转换为 .mm 中包含的类型或将每个 C++ 类型包装在一个 Objective C++ 类型中之外，还有什么办法可以解决这个问题？

我的问题与托尼的问题基本相同（但没有人回答他的问题）：

[https://stackoverflow.com/questions/10163322/how-to-include-c-header-file-in-objective-c-header-file](https://stackoverflow.com/questions/10163322/how-to-include-c-header-file-in-objective-c-header-file)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-04T13:54:48.243

问题是您必须避免头文件中的所有 C++ 语义以允许普通的 Objective-C 类包含它。这可以使用[不透明指针](http://en.wikipedia.org/wiki/Opaque_pointer)来完成。

### CPPClass.h

```
class CPPClass
{
public:
    int getNumber()
    {
        return 10;
    }
}; 
```

### 对象CPP.h

```
//Forward declare struct
struct CPPMembers;

@interface ObjCPP : NSObject
{
    //opaque pointer to store cpp members
    struct CPPMembers *_cppMembers;
}

@end 
```

### 对象CPP.mm

```
#import "ObjCPP.h"
#import "CPPClass.h"

struct CPPMembers {
    CPPClass member1;
};

@implementation ObjCPP

- (id)init
{
    self = [super init];
    if (self) {
        //Allocate storage for members
        _cppMembers = new CPPMembers;

        //usage
        NSLog(@"%d", _cppMembers->member1.getNumber());
    }

    return self;
}

- (void)dealloc
{
    //Free members even if ARC.
    delete _cppMembers;

    //If not ARC uncomment the following line
    //[super dealloc];
}

@end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-04T08:05:34.803

要在 Objective-C++ 头文件中使用 C++，请确保：

1.  有一对.h/.mm (Objective-C++)
2.  在文件的标识中，将类型设置为 Objective-C++ Source（它应该是自动的）
3.  Include the considered file only from Objective-C++ source files. This point is obvious but can be very quickly forgotten and hard to track down

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T20:57:52.633

#include 指令只包含文本；Objective C 唯一会抱怨的是，如果包含文件中的某些内容不是有效的 Objective C。

就你而言，它会给你答案；在 Objective C 中找不到 iostream.h 头文件。找到该文件的引用位置并删除#include。

# jquery - 双击背景而不是元素时的事件

> ID：13691543
> 
> 赞同：0
> 
> 时间：2012-12-03T20:56:39.283
> 
> 标签：jquery

```
$( 'body' ).dblclick(function() {
    alert("You double-clicked the background!");
});​ 
```

如何匹配正文背景而不匹配元素链接输入或链接？我猜想使用`:not()`，但它不能让它工作。

测试：http: [//jsfiddle.net/SwARj/](http://jsfiddle.net/SwARj/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T20:59:06.193

[http://jsfiddle.net/SwARj/1/](http://jsfiddle.net/SwARj/1/)

```
$( 'body' ).dblclick(function(e) {
    if($(e.target).is('body')){
        alert("You double-clicked the background!");
    }
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T20:58:29.623

您可以使用[event.target.nodeName](http://api.jquery.com/event.target/)来检查哪个元素被双击。

例如：

```
$( 'body' ).dblclick(function() {
   if (event.target.nodeName != "A" && event.target.nodeName != "INPUT")
      alert("You double-clicked the background and not a link nor an input");
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T20:59:27.080

查看 jquery 中事件对象的文档：http: [//api.jquery.com/category/events/event-object/](http://api.jquery.com/category/events/event-object/)

考虑到这一点，您可以说“如果目标元素是`body`元素，则处理”

我相应地更新了你的 jsfiddle：http: [//jsfiddle.net/SwARj/2/](http://jsfiddle.net/SwARj/2/)

```
$( 'body' ).dblclick(function(evt)
{
    if(evt.target == document.body)
        alert("You double-clicked the background!");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T20:59:54.150

```
$('body').dblclick(function(e) {
    if (e.target.localName === 'body') {
      //...
    }
}); 
```

[http://jsfiddle.net/gXZyw/](http://jsfiddle.net/gXZyw/)

# mongodb - 试图从集合中提取 $first 文档

> ID：13691546
> 
> 赞同：0
> 
> 时间：2012-12-03T20:56:54.193
> 
> 标签：mongodb, aggregation-framework, database

通过聚合框架传输各种文档后，我终于有了结果文档。

现在的问题是我只想要 $first 和 $last 文档。

最终的文件看起来像这样（巨大的列表）：

```
 ...
            {
                    "_id" : "Kaila Deibler",
                    "count" : 406
            },
            {
                    "_id" : "Jessika Dagenais",
                    "count" : 406
            },
            {
                    "_id" : "Tamika Schildgen",
                    "count" : 404
            },
            ... 
```

我用来生成文档的 mongo shell 命令是：
`db.talks.aggregate([{$project: {_id: 0, comments: "$comments"}}, {$unwind: "$comments"}, {$group: {_id: "$comments.author", count: {$sum: 1}}}, {$sort: {count: -1}}])`

但我只需要第一个和最后一个文件，所以我尝试了这样的事情：
`db.talks.aggregate([{$project: {_id: 0, comments: "$comments"}}, {$unwind: "$comments"}, {$group: {_id: "$comments.author", count: {$sum: 1}}}, {$sort: {count: -1}}, {$first: "$_id"}])`

我尝试了其他实现，但似乎无法弄清楚何时/何地实现`$first`和`$last`

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:17:07.000

`$first`并且`$last`是`$group`管道中的聚合函数，这意味着您需要在`$group`文档中使用它们。

```
db.talks.aggregate([{$project: {_id: 0, comments: "$comments"}}, {$unwind: "$comments"}, {$group: {_id: "$comments.author", count: {$sum: 1}, first: {$first:"$_id"}}}, {$sort: {count: -1}}]) 
```

同样对于`$last`

[您可以在此处](http://docs.mongodb.org/manual/tutorial/aggregation-examples/#largest-and-smallest-cities-by-state)找到显示此内容的示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:55:45.783

这是我自己对这个问题的回答：

`db.talks.aggregate([{$project: {_id: 0, comments: "$comments"}}, {$unwind: "$comments"}, {$group: {_id: "$comments.author", count: {$sum: 1}}}, {$sort: {count: -1}}, {$group: {_id: "$_id.comments.author", first: {$first: "$_id"}, last: {$last: "_id"}}}])`

由于我想在排序后提取第一个和最后一个文档，因此我必须`$group`使用`$first`and应用另一个文档`$last`。结果：

```
{
        "result" : [
                {
                        "_id" : null,
                        "first" : "Elizabet Kleine",
                        "last" : "Mariela Sherer"
                }
        ],
        "ok" : 1
} 
```

注意`"_id" : null`. 这是必要的吗？
如果有人有更好的解决方案，请分享。

# ruby-on-rails - Rails 3路线中不区分大小写的用户名

> ID：13691547
> 
> 赞同：1
> 
> 时间：2012-12-03T20:56:59.517
> 
> 标签：ruby-on-rails, case-sensitive, case-insensitive

我试图允许用户通过他们的用户名访问他们的帐户，无论他们如何在 URL 中大写它。因此[http://example.com/Username将与](http://example.com/Username)[http://example.com/username](http://example.com/username)进入同一页面。

我对 URL 的任何其他部分区分大小写感到满意（我知道这是标准），但我认为没有必要强制用户在 URL 中获取正确的用户名大小写。

这可以通过单独在 routes.rb 文件中添加某些设置来完成吗？

我认为这很简单，但显然不是。

[我在这里](https://stackoverflow.com/questions/2291907/rails-routes-how-to-make-them-case-insensitive)发现了一个看似简单的问题，但[我认为](https://stackoverflow.com/a/2292837/839847)只有一个答案会有所帮助，而且太老套了（作者自己承认）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T21:08:40.667

我相信这不是路由问题，您可以在控制器代码中解决它：

```
User.where("lower(username) = lower(?)", params[:username]).first! 
```

或者

```
User.where("lower(username) = ?", params[:username].downcase).first! 
```

或者

```
User.find(:first, :conditions => [ "lower(username) = ?", params[:username].downcase ]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:02:30.043

在控制器中处理这种行为应该可以正常工作，而不是在路由中。

```
# config/routes.rb
match ':username' => 'users#show'

# app/controllers/users_controller.rb
def show
  username = params[:username]
  user = User.find_by_username(username) || User.find_by_username(username.downcase) 
  # or something along these lines...
end 
```

一个更好的解决方案可能是为用户存储某种类型的*slug*标识，该标识始终被小写并准备好在 URL 中使用。为此，您可以查看一下很棒[**的friendly_id gem**](https://github.com/norman/friendly_id)。

# android - Android wrapper 不会下载文件

> ID：13691554
> 
> 赞同：0
> 
> 时间：2012-12-03T20:57:17.783
> 
> 标签：android, webview, wrapper, android-websettings

我有一个 android 应用程序，它只是我的移动网站的包装。我有一个简单地指向我网站的登录 URL 的 webview。当我在常规浏览器上访问我的移动网站时，我可以在单击按钮时下载 PDF（通过 href="url 返回 pdf"）。然而，在我的包装上，我无法下载它。我认为这与我的网络设置或我需要覆盖的某些方法有关。如何让我的包装器像普通浏览器一样下载文件？

代码：

```
public class MainActivity extends Activity {

private static final String TAG = "TAG";
private WebView myWebViewGlobal=null;

@Override

public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    //Remove title bar as we already have it in the web app

    this.requestWindowFeature(Window.FEATURE_NO_TITLE);

    //Point to the content view defined in XML

    setContentView(R.layout.main);

    //Configure the webview setup in the xml layout
    WebView myWebView=(WebView) findViewById(R.id.webview);
    myWebViewGlobal=myWebView;
    WebSettings webSettings = myWebView.getSettings();

    //Yes, we want javascript, pls.

    webSettings.setJavaScriptEnabled(true);
    webSettings.setAllowFileAccess(true);
    myWebView.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);

    myWebView.setDownloadListener(new DownloadListener() 
    {
        public void onDownloadStart(String url, String userAgent,
                        String contentDisposition, String mimetype,
                        long contentLength) {

                Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
                startActivity(intent); 
    }
    });

    if (Build.VERSION.SDK_INT>=Build.VERSION_CODES.ECLAIR) {
        try {
            Log.d(TAG, "Enabling HTML5-Features");
            Method m1 = WebSettings.class.getMethod("setDomStorageEnabled", new Class[]{Boolean.TYPE});
            m1.invoke(webSettings, Boolean.TRUE);

            Method m2 = WebSettings.class.getMethod("setDatabaseEnabled", new Class[]{Boolean.TYPE});
            m2.invoke(webSettings, Boolean.TRUE);

            Method m3 = WebSettings.class.getMethod("setDatabasePath", new Class[]{String.class});
            m3.invoke(webSettings, "/data/data/" + getPackageName() + "/databases/");

            Method m4 = WebSettings.class.getMethod("setAppCacheMaxSize", new Class[]{Long.TYPE});
            m4.invoke(webSettings, 1024*1024*8);

            Method m5 = WebSettings.class.getMethod("setAppCachePath", new Class[]{String.class});
            m5.invoke(webSettings, "/data/data/" + getPackageName() + "/cache/");

            Method m6 = WebSettings.class.getMethod("setAppCacheEnabled", new Class[]{Boolean.TYPE});
            m6.invoke(webSettings, Boolean.TRUE);

            Method m7 = WebSettings.class.getMethod("setAllowContentAccess", new Class[]{Boolean.TYPE});
            m7.invoke(webSettings, Boolean.TRUE);

            Method m8 = WebSettings.class.getMethod("setAllowFileAccessFromFileURLs", new Class[]{Boolean.TYPE});
            m8.invoke(webSettings, Boolean.TRUE);

            Method m9 = WebSettings.class.getMethod("setAllowUniversalAccessFromFileURLs", new Class[]{Boolean.TYPE});
            m9.invoke(webSettings, Boolean.TRUE);

            Method m10 = WebSettings.class.getMethod("setLoadsImagesAutomatically", new Class[]{Boolean.TYPE});
            m10.invoke(webSettings, Boolean.TRUE);

            Method m11 = WebSettings.class.getMethod("setLoadsImagesAutomatically", new Class[]{Boolean.TYPE});
            m11.invoke(webSettings, Boolean.TRUE);

            Log.d(TAG, "Enabled HTML5-Features");
        }
        catch (NoSuchMethodException e) {
            Log.e(TAG, "Reflection fail", e);
        }
        catch (InvocationTargetException e) {
            Log.e(TAG, "Reflection fail", e);
        }
        catch (IllegalAccessException e) {
            Log.e(TAG, "Reflection fail", e);
        }
    }

    //Make sure links in the webview is handled by the webview and not sent to a full browser

    myWebView.setWebViewClient(new WebViewClient());

    //And let the fun begin

    myWebView.loadUrl("http://mywebsite.com/login.php");

}

@Override  
public void onBackPressed()   
{  
    if(myWebViewGlobal.canGoBack())
    {
        myWebViewGlobal.goBack();
    }

    return;  
} 
```

}

# regex - perl 用正则表达式在 3 日分割一行]

> ID：13691562
> 
> 赞同：0
> 
> 时间：2012-12-03T20:57:56.833
> 
> 标签：regex, perl

我有这条线：
`[Fri Oct 5 09:11 2012] 0.005 [ext2/1/rel 322 (0,50)] [abc] I'm Sure [he/she] is leading CORN @types (countyfair)`

我如何将它从第**3 个 ]**中拆分出来，并有 2 个部分：

```
[Fri Oct  5 09:11 2012] 0.005 [ext2/1/rel 322 (0,50)] [abc] 
```

和

```
I'm Sure [he/she] is leading CORN @types (countyfair) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:05:03.947

这个跳过三个`]`s：

```
use strict;
use warnings;

while (<>) {
  if (my ($p1, $p2) = (/([^]]+][^]]+][^]]+])\s*(.*)/)) {
    print "$p1 : $p2\n";
  }
} 
```

使用数组：

```
my @a; 
while (<>) {
  if (@a = (/([^]]+][^]]+][^]]+])\s*(.*)/)) {
    print join(",", @a), "\n";
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T13:57:44.573

对每个以 结尾的三个字符串进行回顾`]`就可以解决问题。你没有提到你想在第三个之后对空格做什么，`]`所以我把它留在那里。

```
use strict;
use warnings;

my $s = q{[Fri Oct 5 09:11 2012] 0.005 [ext2/1/rel 322 (0,50)] [abc] I'm Sure [he/she] is leading CORN @types (countyfair)};
my @pair = split /(?:[^]]*\]){3}\K/, $s;

print "$_\n" for @pair; 
```

**输出**

```
[Fri Oct 5 09:11 2012] 0.005 [ext2/1/rel 322 (0,50)] [abc]
 I'm Sure [he/she] is leading CORN @types (countyfair) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T03:21:31.040

我对通用函数感兴趣，所以这里是：

```
#!/usr/bin/env perl

use strict;
use warnings;

my $str = q{[Fri Oct 5 09:11 2012] 0.005 [ext2/1/rel 322 (0,50)] [abc] I'm Sure [he/she] is leading CORN @types (countyfair)};  #'# fix highlight

my ($first, $second) = split_after_nth( qr/]/, $str, 3 );
$second =~ s/^\s*//;  #/# fix highlight
print "$first\n$second\n";

sub split_after_nth {
  my ($qr, $str, $num) = @_;
  my @parts = split /($qr)/, $str, ++$num;
  my $second = pop @parts;
  my $first = join '', @parts;
  return ($first, $second);
} 
```

# c# - 实体框架始终包含上下文中的数据，即使我不要求它

> ID：13691563
> 
> 赞同：23
> 
> 时间：2012-12-03T20:57:57.677
> 
> 标签：c#, entity-framework, frameworks, entity

我首先使用 MVC.NET web api、EF 和 DB，并且我在上下文中关闭了延迟加载。即使关闭了 LazyLoading，EF 也会返回太多数据。

例如，我有一个角色的用户。当我查询用户并包含角色时，Role.Users 属性会自动填充数据，因为用户已加载到上下文中。

为什么我不能让 EF 满足我的要求？还是我在这里错过了一些大事？

```
public partial class User
{
    public int UserID { get; set; }
    public string Title { get; set; }
    public string Email { get; set; }
    public int RoleID { get; set; }

    ....

    public virtual Role Role { get; set; }
} 

public partial class Role
{
    public int RoleID { get; set; }
    public string RoleName { get; set; }

    ....

    public virtual ICollection<User> Users { get; set; }
} 

return db.Users.Include(u => u.Role);
// ^^ user.Role.Users is filled with 1000s of users 
```

TL;DR - 我希望 EF 永远不要将数据加载到导航属性/集合中，除非我直接 .Include() 它。序列化为 JSON 时，我只想要我明确要求的内容。似乎即使关闭延迟加载，已经在上下文中的导航属性（即通常是“循环引用”）也会被加载并返回。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-03T22:15:15.287

您看到的行为称为*[关系修复](https://stackoverflow.com/a/6259284/270591)*，您无法禁用它。

如果您正在加载具有角色的用户以对其进行序列化并将它们发送到某个地方，我猜您不想在它们已加载的上下文中跟踪实体的更改。因此，无需将它们附加到上下文和您可以使用：

```
return db.Users.Include(u => u.Role).AsNoTracking(); 
```

或者按照@STLRick 的建议，使用投影到专门用于序列化的对象中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-24T18:18:47.717

没错，通过延迟加载，您将返回导航属性，因为它们被序列化程序“触摸”，导致它们被加载。如果您希望属性返回为空，则应关闭延迟加载。也就是说，一旦实体被加载到上下文中（例如，通过其他查询），它们“似乎”就会被序列化程序处理。所以答案是告诉序列化器不要返回导航属性。我能找到的最好方法是使用 DTO（数据传输对象）。这使您可以准确地返回您想要的数据，而不是您的实际实体。

您的 DTO 可能如下所示：

```
public partial class UserDto
{
    public UserDto(user User)
    {
        UserID = user.UserID;
        Title = user.Title;
        //... and so on
    }
    public int UserID { get; set; }
    public string Title { get; set; }
    public string Email { get; set; }
    public int RoleID { get; set; }

    //exclude the Role navigation property from your DTO
} 
```

...然后你可以做这样的事情：

```
return db.Users.Include(u => u.Role).Select(user => new UserDto(user)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-03T22:15:06.413

您可以使用 仅选择您需要的内容`Select()`。

```
var users = _db.Users.Select(x => new
{
    UserID = x.UserID,
    Title = x.Title,
    Email = x.Email,
    RoleID = x.RoleID
}).AsEnumerable(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T22:00:12.350

> 除了我告诉它包含的内容之外，我不希望它加载任何内容。

看起来您需要使用[Explicit Loading](http://weblogs.asp.net/dotnetstories/archive/2011/03/10/lazy-loading-eager-loading-explicit-loading-in-entity-framework-4.aspx)。基本上，您可以像这样加载特定实体：

```
context.Include("Roles") 
```

据我所知，不应该包括相关实体。确实应该禁用延迟加载，您可以使用`Load`.

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-12-03T21:58:46.643

首先：打开延迟加载。

第二：如果你想过滤你检索和返回的内容，然后做一个自定义的返回对象或其他东西。

```
from u in db.Users
join r in db.Roles
  on u.RoleID equals r.RoleID
select new { u.UserID, u.Title, u.Email, r.RoleName } 
```

或类似的东西。您将有一个最小的返回对象，并且您的对象图将很小。

# java - Java 语法：这个短语是什么意思？

> ID：13691564
> 
> 赞同：-1
> 
> 时间：2012-12-03T20:58:00.917
> 
> 标签：java

这个短语在 Java 中是什么意思？我假设这意味着先前定义的名为“treeCopy”的变量正在调用其左源方法，该方法又分配给变量“leftCopy”。

我对么？远程关闭？完全错了吗？

```
 leftCopy = treeCopy(source.left);

    public static <E> BTNode<E> treeCopy(BTNode<E> source)
{
    BTNode<E> leftCopy, rightCopy;

    if (source == null)

        return null;
    else
    {
        leftCopy = treeCopy(source.left);

        rightCopy = treeCopy(source.right);

        return new BTNode<E>(source.data, leftCopy, rightCopy);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:02:26.147

No one here can tell you what this code means beyond :

*   It's an assignment of some variable called `leftCopy` from the result of some method `treeCopy`
*   The method `treeCopy` takes a parameter, in this case whatever is in `source.left`
*   It won't execute because it's commented out

Consider reading how to ask a [question](http://www.catb.org/esr/faqs/smart-questions.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:03:35.443

There is a tree with a node or a root "Source" from source two branches emanate. A left and a right branch. TreeCopy is a function that takes a node as an input and returns a subtree in this case the left sub tree of source.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:05:03.900

This code copies the left subtree of an binary tree.

# ios - 用于保存一些实例的数组或字典？

> ID：13691571
> 
> 赞同：1
> 
> 时间：2012-12-03T20:58:24.883
> 
> 标签：ios, xcode, nsarray, nsdictionary

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.carMakes = [[NSArray alloc]
                     initWithObjects:@"Chevy",
                     @"BMW",
                     @"Toyota",
                     @"Volvo",
                     @"Smart", nil];

    self.carModels = [[NSArray alloc]
                      initWithObjects:@"Volt",
                      @"Mini",
                      @"Venza",
                      @"S60",
                      @"Fortwo", nil];

    self.carImages = [[NSArray alloc]
          initWithObjects:@"chevy_volt.jpg",
                      @"mini_clubman.jpg",
                      @"toyota_venza.jpg",
                      @"volvo_s60.jpg",
                      @"smart_fortwo.jpg", nil];
} 
```

上面的代码填充在表格视图中。我想让用户选择一些汽车，这样汽车的名称、型号和图片将保存在另一个列表中。我不知道应该在哪里保存用户选择的数据以及如何保存。我希望稍后能够在 TableView 上显示用户选择的汽车列表。

*   我知道如果我想保留新创建的列表，我需要将选择的信息转换为 plist 文件或类似的文件，但我不确定在此之前将数据保存在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:18:07.433

您可以为此使用数组或字典。但更好的方法是创建一个模型类数组来保存这些数据。这最适合[MVC 架构](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。例如，您可以创建一个模型类，`Car`它具有属性、`NSString *make`和`NSString *model`在`UIImage *image`其中声明。如果要填充表格视图，则需要创建这些汽车模型对象的数组，并在委托方法中使用它来填充单元格。如果要持久化数据，可以将其转换为字典形式，然后将其存储为 plist。有关更多详细信息，请查看[ray wenderlich 的本教程](http://www.raywenderlich.com/1797/how-to-create-a-simple-iphone-app-tutorial-part-1)

一个典型的模型对象看起来像，

```
@interface Car : NSObject {}
@property (nonatomic, retain) NSString *make; 
@property (nonatomic, retain) NSString *model;
@property (nonatomic, retain) UIImage *image;
@end 
```

创建模型对象数组，

```
Car *carObject = [[Car alloc] init];
carObject.make = @"Chevy";
//set other properties and create more objects
NSMutableArray *carList = [[NSMutableArray alloc] init];
[carList addObject:carObject]; //you can do this in a loop 
```

显示时您可以使用`[carList objectAtIndex:indexPath.row].make`等。

或者

```
Car *myCar = [carList objectAtIndex:indexPath.row];
cell.textLabel.text = myCar.model; 
```

When the user chooses some cars, save those model objects into a separate array and save it as plist.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:27:03.690

Suppose, you added the following cars into an array as follows.

```
[arraySelectedCars addObject:[NSDictionary dictionaryWithObjectsAndKeys:@"BMW", @"Makes", @"Mini", @"Model", @"chevy_volt.jpg", @"Image", nil]];
[arraySelectedCars addObject:[NSDictionary dictionaryWithObjectsAndKeys:@"Toyota", @"Makes", @"Mini", @"Venza", @"toyota_venza.jpg", @"Image", nil]]; 
```

You can save them into NSUserDefaults, which reside into user's device till user delete apps or until you remove it.

```
[[NSUserDefaults standardUserDefaults] setValue:arraySelectedCars forKey:@"SelectedCars"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

Later you can access the array and reload tableview as follows.

```
NSMutableArray *arraySelectedCars = [[NSUserDefaults standardUserDefaults] valueForKey:@"SelectedCars"]; 
```

# c# - 通用数组索引

> ID：13691573
> 
> 赞同：1
> 
> 时间：2012-12-03T20:58:34.387
> 
> 标签：c#, arrays, indexing

C# 是否有一个可由泛型类型索引的数组类型（显然是一种约束`IComparable`或类似的类型）？例如：

```
public class GenericallyIndexedArray<I,T> where I : struct, IComparable { // ... 
```

秩序很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:00:55.630

是的，它是[`SortedList<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/ms132319.aspx)

您可以`IComparer<T>`为键提供要使用的值，或者如果键类型实现它，则使用默认值。

# sql-server - 具有多个数据库服务器的 ServiceStack OrmLite

> ID：13691575
> 
> 赞同：14
> 
> 时间：2012-12-03T20:58:40.947
> 
> 标签：sql-server, oracle11g, ormlite-servicestack

我正在围绕 servicestack 框架构建一个应用程序，并且需要能够访问 Oracle 和 MS Sql Server 中的数据。这是否可以使用 ORMLite，似乎我只能为应用程序设置一种方言，或者我错过了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-03T22:56:11.507

是的，这是可能的，并且已经内置了对此的支持`OrmLiteConnectionFactory`，请参阅[OrmLite 项目主页上的 Master SQLServer + Sqlite 分片示例](https://github.com/ServiceStack/ServiceStack.OrmLite#sharding-1000-robots-into-10-sqlite-db-shards---referencing-each-in-a-master-sqlserver-rdbms)。

基本上你会先注册你的**默认**（或主）连接：

```
var dbFactory = new OrmLiteConnectionFactory(
  "Data Source=host;Initial Catalog=RobotsMaster;Integrated Security=SSPI", 
  SqlServerDialect.Provider); 
```

然后，您将为您希望支持的每个其他连接注册一个**命名连接，例如：**

```
dbFactory.RegisterConnection("shard-1", 
  "~/App_Data/{0}.sqlite".Fmt(shardId).MapAbsolutePath(),
    SqliteDialect.Provider); 
```

配置完成后，打开连接而不指定名称将打开到默认数据库的连接，例如：

```
using (IDbConnection db = dbFactory.OpenDbConnection()) { ... } //Default DB 
```

虽然您可以指定一个名称以打开与具有不同提供程序的数据库的命名连接，例如：

```
using (var dbShard = dbFactory.OpenDbConnection("shard-1")) { ... } //Named DB 
```

### 手动使用不同的方言提供者

不同 RDBMS 之间的 SQL 提供程序实现之间的差异包含在每个方言提供程序中。因此，如果您想针对特定的 ADO.NET 提供程序实现使用 OrmLite 的便利扩展方法，您只需分配您希望使用的 ThreadStatic DialectProvider，例如：

```
OrmLiteConfig.DialectProvider = SqlServerDialect.Provider;
var dbConn = new SqlConnection(SqlServerConnString);
dbConn.Select<Table>(); //All db access now uses the above dialect provider 
```

这基本上就是`RegisterConnection`OrmLiteConnectionFactory 在幕后自动为您所做的所有事情。

到目前为止，OrmLite 的所有方言提供程序供参考：

*   SqlServerDialect.Provider
*   SqliteDialect.Provider（不同的 32/64 和 Mono impls 可用）
*   MySqlDialect.Provider
*   PostgreSqlDialect.Provider
*   Oracle方言提供者
*   FirebirdDialect.Provider

# php - 为什么 mySQL 语句对于适用于 print 或 echo 语句的比较会引发解析错误？

> ID：13691577
> 
> 赞同：0
> 
> 时间：2012-12-03T20:58:46.680
> 
> 标签：php, mysql

我正在尝试根据 mySQL 表查询的结果比较来设置开关。如果我使用打印或回显，则查询有效，但在尝试使用完全相同的循环进行比较时会引发语法错误。引发错误的比较代码如下。

```
//Define query for database entry lookup
$sql = "SELECT * FROM email_auth WHERE useremail='$user_email_address'";

//Define result for database entry lookup
$result = mysql_query($sql) or die(mysql_error());

//Find match for email authentication
$email_count = 0;
while($row = mysql_fetch_assoc($result)){
  if ( $row['authID'] == $user_email_auth ) { $validemailrequest = "true" }  //Line 60
  $email_count++;
} 
```

而我得到的错误......

```
<b>Parse error</b>:  syntax error, unexpected '}' in
<b>/home/user/public_html/send_email.php</b> on line <b>60</b> 
```

然而，在使用相同的打印时有效......

```
//Define query for database entry lookup
$sql = "SELECT * FROM email_auth WHERE useremail='$user_email_address'";

//Define result for database entry lookup
$result = mysql_query($sql) or die(mysql_error());

//Find match for email authentication
$email_count = 0;
while($row = mysql_fetch_assoc($result)){
  print $row['authID'];
  $email_count++;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:03:14.103

条件代码后似乎缺少一个分号。

```
while($row = mysql_fetch_assoc($result)){
    if ( $row['authID'] == $user_email_auth ) { $validemailrequest = "true"; }  //Line 60
    $email_count++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:59:53.320

此行缺少分号`;`，

```
$validemailrequest = "true"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:00:00.670

后缺少分号`$validemailrequest = "true"`

# java - 将一个对象的引用传递给另一个类中的另一个方法

> ID：13691578
> 
> 赞同：0
> 
> 时间：2012-12-03T20:58:48.923
> 
> 标签：java, class, object, methods

如何将对象引用传递给另一个类中的另一个方法？

我的程序的目标是从包含成绩单的文件中计算学生的 GPA。我正在努力解决的部分涉及 3 个课程。

有 GPACalculator，其中包含 main。有成绩单和课程。成绩单类读取文件并从中构建课程。

到目前为止，我的成绩单类具有读取成绩单文件的当前行并根据这些信息构建课程对象的方法。

我现在需要能够将课程对象发送到 gpa 计算器的主要方法，以便我可以将其打印到终端窗口。这就是我卡住的地方。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:02:46.503

GPA calculator probably needs to make a new course object:

```
CourseObject courseobject = new CourseObject(args); 
```

Then you need to do something like: `courseobject.getData();`

# java - Java 上的 StackOverflow 错误 - 看不到无限循环？

> ID：13691580
> 
> 赞同：2
> 
> 时间：2012-12-03T20:58:51.793
> 
> 标签：java, recursion, stack-overflow

我正在尝试创建一个程序来查找“三角形数字”和“星号”的值。但是，我对程序何时分支到第二个功能等感到有些困惑。感谢您的帮助！

```
public class Recursion {

        public static void main(String[] args) {
                // TODO Auto-generated method stub
                int count =0;
                int n = 1;
                int t=0;
                int triangularNumber =0;
                while (n<Integer.MAX_VALUE)
                {
                        t = isTriangularNumber(n,count,triangularNumber);  
                        triangularNumber=0;
                        int starNumber= ((6*n)*(n-1)) + 1;
                        if (starNumber ==t)
                        {
                                System.out.println(t);
                        }
                        n++;
                }      
                if (n==Integer.MAX_VALUE)
                {
                    System.exit(0);
                }
        }

        public static int isTriangularNumber(int n, int count, int triangularNumber)
        {
                triangularNumber =triangularNumber + (n-(n-count));
                if (count<=n)
                {      
                        return isTriangularNumber(n,(count++), triangularNumber);
                }      
                else return triangularNumber;
        }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:00:58.237

```
return isTriangularNumber(n,(count++), triangularNumber); 
```

在上面`invocation`，`count++` 仅评估为`count`。因此，在每次调用时，您实际上都在传递不变的`count`. 因此`if`条件： -

```
if (count<=n) 
```

`true`如果第一次调用为真，则将始终评估为。从而用无限的方法调用填充堆栈。

您的调用应该是`++count`： -

```
return isTriangularNumber(n,(++count), triangularNumber); 
```

# windows-8 - 如何在 Metro App 中创建显示模式和编辑模式？

> ID：13691583
> 
> 赞同：0
> 
> 时间：2012-12-03T20:59:04.493
> 
> 标签：windows-8, microsoft-metro

单击 Windows 8 商店应用程序的编辑按钮后，将 TextBlocks 更改为 TextBoxes 的最佳方法是什么？这类似于 iOS 应用程序，单击编辑按钮后可编辑字段变为文本框，然后您可以更改数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:02:37.623

您不需要`TextBlock`只使用`TextBox`与`IsReadOnly`属性一起使用。

在按钮上单击标记`IsReadOnly="True"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:02:34.600

我想你想要的[`IsReadOnly`财产](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.textbox.isreadonly.aspx)。 `IsReadOnly=true;`当您不想让他们编辑文本框时，`IsReadOnly=false;`当您想让他们编辑它时。

# facebook - 通过 iframe 的 Facebook 注册表单

> ID：13691585
> 
> 赞同：0
> 
> 时间：2012-12-03T20:59:07.237
> 
> 标签：facebook, iframe

我创建了一个注册页面，通过 iframe 用作注册页面。我想知道如果用户已经准备好使用联系表格，我该如何显示不同的页面（重定向？），这可能吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:50:04.410

在您的注册页面内

```
<% if (customer_has_used_contact_form()) %>
<script type="text/javascript">
   document.location="somewhere_else.html";
</script>

<% end %> 
```

# php - 即使网址有效，curl 仍为空

> ID：13691587
> 
> 赞同：1
> 
> 时间：2012-12-03T20:59:15.147
> 
> 标签：php

我只是被卷曲的东西困住了......它在我的代码中没有给我任何问题，但是在这里，当我执行 var_dump 时，$EAACCOUNT 总是为空......不过，我很确定 url 请求是正确的，因为它适用于我编码的其他部分......你们知道我该如何解决这个问题吗？

```
 $account= "http://www.ea.com/p/fut/a/" . $machine . "/l/". $ulocal ."/s/p/ut/game/fifa13/user/accountinfo?timestamp=". $time;
    $auth   = "http://www.ea.com/p/fut/a/" . $machine . "/l/". $ulocal ."/s/p/ut/auth";
    $quest  = "http://www.ea.com/p/fut/a/" . $machine . "/l/". $ulocal ."/s/p/ut/game/fifa13/phishing/validate";

    //Cookie Data includes the two keys from above
    $cookie_string = $EASW_KEY."; ".$EASF_SESS;
    //Setup cURL HTTP request
    $ch = curl_init($account);                                                                                                                                      
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_COOKIE, $cookie_string);                                                                      
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
        'Content-Type: application/x-www-form-urlencoded')                                                                   
    );                                                                                                                   

    $EAACCOUNT = curl_exec($ch);
    curl_close($ch);

    //Get personaID and Platform
    $d = json_decode($EAACCOUNT, true);
$personaID = $d->userAccountInfo->personas[0]->personaId;
    $platform  = $d->userAccountInfo->personas[0]->userClubList[0]->platform; 
```

# c - 字符串比较在 C 中不起作用

> ID：13691588
> 
> 赞同：1
> 
> 时间：2012-12-03T20:59:17.760
> 
> 标签：c, string, strcmp

我的程序中有一个函数应该接受摩尔斯电码输入，将其与字符串数组进行比较，并在找到匹配的摩尔斯电码后从相应的字符串中返回一个字母。我终于设法让它运行而不会崩溃，但现在它总是返回错误的字母。例如 ... --- ... 应该返回 sos 但我得到的是 amb。我尝试通过打印索引号、莫尔斯电码字符串和字母来测试它，它们都匹配了，所以我认为问题出在字符串比较上。

这是代码：

```
void morsetotext(char mor[])
{
     char alpha[]={"abcdefghijklmnopqrstuvwxyz1234567890 "};
     char *morse[] = {".-", "-...", "-.-.", "-..", ".", "..-.", "--.", "....", 
     "..", ".---","-.-", ".-..", "--", "-.", "---", ".--.", "--.-", ".-.", 
     "...", "-", "..-", "...-",".--", "-..-", "-.--", "--.","-----", ".----", 
     "..---", "...--", "....-",".....", "-....", "--...", "---..", "----." "/ "};
     char letter[8];
     char convert[250];
     int con_count=0;
     int let_count=0;
     int count=0;
     int index=0;
     int length=strlen(mor);

     while (count<length)
     {
           for(let_count=0; let_count<8 && mor[count]!=' '; let_count++)
           {
                            letter[let_count]=mor[count];
                            count++;
           }

           letter[let_count+1]='\0';

           index=0;
           while (strcmp (letter, morse[index])!=1)
           {
                 index++;
           }

           count++;

           printf ("%c", alpha[index]);
     } 
     return;
} 
```

谢谢你的帮助。

编辑：对不起，这是整个功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-03T21:03:13.727

Compare strcmp() against 0, not 1\. the function will only return 0 with a full match. Read the manual! :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T21:01:57.753

```
while (strcmp (letter, morse[index])!=1) 
```

您可能的意思是`0`而不是`1`. 或者只是说`while (!strcmp(...))`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T22:01:39.553

这个说法：

```
letter[let_count+1]='\0'; 
```

`letter[9]`如果输入 ( `mor`) 的长度为 8 个字符，则正在写入。

您将字母声明为`char letter[8];`，因此唯一有效的指标是 [0] - [7]。

分配给`letter[9]`最有可能导致您描述的段错误。

在我看来，您希望字母最多包含 8 个数据字符，外加一个空终止符 ( `\0`)。这表明您应该将其声明为`char letter[9];`.

# kinect - 初始化 Kinect 记录器错误

> ID：13691589
> 
> 赞同：0
> 
> 时间：2012-12-03T20:59:24.780
> 
> 标签：kinect, kinect-sdk, kinect.toolbox

当我尝试运行我的骨骼跟踪代码来测试我添加的以下代码行时，它会因错误而崩溃。

```
 void sensor_AllFramesReady(object sender, AllFramesReadyEventArgs e)
    {
        if (closing)
        {
            return;
        }

        //Get a skeleton
        Skeleton first = GetFirstSkeleton(e);

        if (first == null)
        {
            return;
        }

        using (SkeletonFrame skeletonFrame = e.OpenSkeletonFrame())
        {
            //if (skeletonFrame == null)
            //{
            //    return;
            //}
            this.recordStream = new MemoryStream(100);
            KinectRecorder Recorder = new KinectRecorder(KinectRecordOptions.Skeletons, recordStream);
            if (skeletonFrame != null)
            {
                this.Recorder.Record(skeletonFrame);
            }
            //StartRecord
           // Skeleton[] skeletonData = this.Recorder.Record(skeletonFrame);

        }
 // some more stuff
 } 
```

我正在调用 Kinect 工具箱中可用的记录功能。

错误是：未处理 System.NullReferenceException ....... Message=Object reference not set to an instance of an object。..... Source=SkeletalTracking

更新：如果我将初始化移动到与记录器调用相同的函数中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:15:46.667

根据您发布的代码，您永远不会初始化您的`KinectRecorder`.

```
this.Recorder.Record(skeletonFrame); // I get an error after the RGB camera view freezes 
```

... 将产生一个空指针，因为`Recorder`从未初始化。除非您在此处的代码示例中忽略了该部分。您可以在声明时执行此操作，或者如果您愿意，可以稍后执行。

```
KienctRecorder Recorder = new KinectRecorder(options, stream); 
```

`options`需要为你设置合适的`KinectRecordOptions`。 `stream`是你的输出`Stream`。

# sql-server - SQL Server While 循环返回找到的结果

> ID：13691593
> 
> 赞同：0
> 
> 时间：2012-12-03T20:59:31.683
> 
> 标签：sql-server, tsql, ado.net

我有一个我编写的 SQL 脚本，它可以帮助我搜索数据库模式以查找是否使用了某些列（即非空、非零长度字符串等）以及它们最流行的值是什么。

我真的很希望能够返回在循环中找到的结果，因为完成整个搜索可能需要一段时间。有没有办法以这样的方式返回结果，在 VB.NET 端，它会在尝试执行时看到结果`SqlDataReader.Read`？

因为现在，我将结果存储在临时表中并在最后返回临时表。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:03:56.443

不是当它是一个单一的 SQL 脚本时，不 - 调用者将在继续之前等待完整的结果集。

但是，您可以将其分解为几个步骤，如下所示：

*   进行初始查找，列出您可能感兴趣的所有列
*   将这些结果返回给 VB.NET
*   对于这组中的每个结果，运行其余过程以获取您真正感兴趣的值。循环遍历第一步中的每个结果
*   当您收到每个数据集合时，您可以根据需要选择对其进行处理。分拆一个新线程，例如，做一些额外的处理。

因此，如果它是一个单一的 T-SQL 脚本，您将无法运行它并一次返回结果 - 但如果您能够将其分解并在 .NET 中而不是在 SQL 中执行循环，您将拥有访问每个步骤的结果。

# mvc-mini-profiler - MiniProfiler SqlServerStorage 变得相当慢

> ID：13691597
> 
> 赞同：5
> 
> 时间：2012-12-03T20:59:36.347
> 
> 标签：mvc-mini-profiler

我们以两种方式使用 mini profiler：

1.  在带有弹出窗口的开发人员机器上
2.  在我们的 staging/prod 环境中，SqlServerStorage 存储到 MS SQL

几周后，我们发现写入分析数据库需要很长时间（几秒钟），并且会在网站上引起真正的问题。截断所有探查器表可以解决该问题。

查看 SqlServerStorage 代码，插入似乎还进行检查以确保具有该 id 的行不存在。这是为了确保与数据库无关的代码吗？随着行数的增加，这似乎会带来巨大的损失。

我将如何从性能分析器中消除性能损失？有没有其他人经历过这种减速？还是我们做错了什么？

为任何帮助或建议而欢呼。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T01:50:58.780

嗯，当我忘记默认聚集时，看起来我在创建该[`MiniProfilers`表](https://github.com/SamSaffron/MiniProfiler/blob/da5aea1b252b2097cec7259aa0f4a964eeccc668/StackExchange.Profiling/Storage/SqlServerStorage.cs#L447)`primary key`时犯了一个巨大的错误......聚集索引是一个 GUID 列，一个非常大的禁忌。

因为数据以与聚集索引相同的顺序物理存储在磁盘上（实际上，可以说该表*是*聚集索引），所以 SQL Server 必须保持每个新插入的行都以该物理顺序排列。当我们基本上使用随机数时，这将成为保持排序的噩梦。

解决方法是添加一个自动增加的 int 并将主键切换到那个，就像[所有其他表](https://github.com/SamSaffron/MiniProfiler/blob/da5aea1b252b2097cec7259aa0f4a964eeccc668/StackExchange.Profiling/Storage/SqlServerStorage.cs#L464)一样（为什么我忽略了这个，我不记得了......我们在 Stack Overflow 上不使用这个存储提供程序否则这个问题早就被发现了）。

我将更新表创建脚本并为您提供一些东西来迁移您当前的表。

**编辑**

再看一遍，主`MiniProfilers`表可能只是一个堆，这意味着没有聚集索引。所有对行的访问都是通过该 guid`ID`列进行的，因此没有物理排序会有所帮助。

如果您不想重新创建 MiniProfiler sql 表，可以使用此脚本使主键成为非聚集的：

```
-- first remove the clustered index from the primary key
declare @clusteredIndex varchar(50);

select  @clusteredIndex = name
from    sys.indexes
where   type_desc = 'CLUSTERED'
        and object_name(object_id) = 'MiniProfilers';

exec ('alter table MiniProfilers drop constraint ' + @clusteredIndex);

-- and then make it non-clustered
alter table MiniProfilers add constraint 
  PK_MiniProfilers primary key nonclustered (Id); 
```

**另一个编辑**

好的，我已经更新了创建脚本并为大多数查询添加了索引 -[**请参阅 GitHub 中的代码**](https://github.com/SamSaffron/MiniProfiler/blob/master/StackExchange.Profiling/Storage/SqlServerStorage.cs#L444)。

我*强烈*建议删除所有现有表并重新运行更新的脚本。

# android - 如何在 Spring for Android 中设置 charset=UTF-8？

> ID：13691598
> 
> 赞同：2
> 
> 时间：2012-12-03T20:59:39.013
> 
> 标签：android, spring

我有以下代码：

```
 HttpHeaders requestHeaders = new HttpHeaders();
  requestHeaders.setAccept(Collections.singletonList(new MediaType("text","plain;charset=UTF-8"))); 
```

然而，这给了我一个 IllegalArgumentException。问题是我想将字符集设置为 UTF-8 而不从配置文件中更改它。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:50:04.310

根据 API 文档`IllegalArgumentException`，如果`MediaType` [无法](http://grepcode.com/file/repository.springsource.com/org.springframework/org.springframework.web/3.0.0/org/springframework/http/MediaType.java#MediaType.toString%28java.util.Collection%29)将自身转换为`String`.

尝试以下操作：

```
requestHeaders.setAccept(
    Arrays.asList(new MediaType("text", "plain", Charset.forName("UTF-8")))
); 
```

# matlab - 绘制函数时的 MatLab 错误

> ID：13691600
> 
> 赞同：3
> 
> 时间：2012-12-03T20:59:43.290
> 
> 标签：matlab

所以我必须在 MatLab 中绘制一些图表。

起初我将其保存为 .m 文件：

```
function y = f(x)
y = sqrt((abs(sin(21*pi*x)))/(2+sin(20*pi*x))); 
```

然后我做：

```
x=[0:0.05:1]
y=f(x) 
```

然后当我需要绘制图表时，使用

```
plot(x,f) 
```

我收到此错误：

```
??? Input argument "x" is undefined.
Error in ==> f at 2
y = sqrt((abs(sin(21*pi*x)))/(2+sin(20*pi*x))); 
```

有人可以告诉我这里有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:08:22.323

您需要使用`./`运算符，而不是`/`在逐元素划分两个向量时使用。试试这个

```
x = 0:0.05:1;
y = sqrt((abs(sin(21*pi*x)))./(2+sin(20*pi*x)));
plot(x,y) 
```

![在此处输入图像描述](../Images/37fdf1cb577cf744bdfe829a25a2930c.png)

# java - 从 Java 中的 XML 输出创建可读报告 (PDF)

> ID：13691601
> 
> 赞同：1
> 
> 时间：2012-12-03T20:59:44.553
> 
> 标签：java, xml, pdf, report, output

我正在尝试制作一个能够从某个工具导入 XML 输出文件并将它们“转换”成漂亮的 PDF 报告的工具，该报告以普通人可以理解的语言总结事情。

输出文件总是包含特定的数据，但我只想让我的应用程序自动创建一份报告，让那些不太熟悉技术的人不难阅读。

我知道完全自动化是不可能的，所以我想我必须使用某种预定义的模板或其他东西，但我不确定最好的解决方案是什么。

导入和读取 XML 文件并不难，但如何将它们转换为可读的 PDF 文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:21:01.330

[Apache FOP](http://xmlgraphics.apache.org/fop/)可能会有所帮助。这是一个打印格式化程序。使用[XSL-FO](http://www.w3schools.com/xslfo/xslfo_intro.asp) (XSL Formatting Objects) 作为模板，并支持 pdf 作为输出。XSL-FO 是一种用于格式化 XML 数据的语言。

# windows - 检测文件是否在 Windows 中打开的编程方式是什么？

> ID：13691603
> 
> 赞同：8
> 
> 时间：2012-12-03T20:59:47.410
> 
> 标签：windows, file, file-io

有没有一种简单的方法来检测文件是否在 Windows 的任何进程中打开？

例如，我正在监视一个目录，如果将文件放入目录中，我想对这些文件执行一些操作。

如果文件仍在复制到目录中，或者这些文件的内容仍在更新，我不想执行这些操作。

所以，发生的事情是给定一个文件名，我想实现一个函数，例如 function `IsFileOpenedAnywhereElseInAnyProcess(const PathName: string): Boolean`，它返回`true`or `false`。

我能想到的一种方法是重命名文件，如果重命名成功，则没有其他进程打开我感兴趣的文件，如下所示：

```
function IsFileOpenedAnywhereElseInAnyProcess(const PathName: string): Boolean;
begin
  Result := not (MoveFileEx(PathName, PathName+'.BLAH', 0) and MoveFileEx(PathName+'.BLAH', PathName, 0));
end; 
```

逻辑是如果我可以重命名文件（到另一个扩展名）然后重命名它，它不会被任何其他进程打开（在检查时）。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T21:30:26.863

```
IsFileOpenedAnywhereElseInAnyProcess(const PathName: string): Boolean 
```

这是您永远无法在多任务操作系统上正确实现的功能。你会得到一个错误的回报，一纳秒后另一个进程打开文件并毁了你的一天。

正确执行此操作的唯一方法是自动执行此操作，实际上是尝试打开文件。并指定不共享，这样其他进程也不能打开该文件。如果另一个进程已经获得了对该文件的访问权限，那将失败并显示 ERROR_SHARING_VIOLATION。此时，您将等待一段时间，然后再试一次。

# c# - 如何在 .NET 中冻结冰棒（使类不可变）

> ID：13691612
> 
> 赞同：63
> 
> 时间：2012-12-03T21:00:16.660
> 
> 标签：c#, .net, multithreading

我正在设计一个我希望在主线程完成配置后使其只读的类，即“冻结”它。Eric Lippert 将这种[冰棒](http://blogs.msdn.com/b/ericlippert/archive/2011/05/23/read-only-and-threadsafe-are-different.aspx)称为不变性。冻结后，可以被多个线程并发访问读取。

我的问题是如何以线程安全的方式编写它，这种方式实际上是*有效*的，即不试图变得不必要*的聪明*。

**尝试1：**

```
public class Foobar
{
   private Boolean _isFrozen;

   public void Freeze() { _isFrozen = true; }

   // Only intended to be called by main thread, so checks if class is frozen. If it is the operation is invalid.
   public void WriteValue(Object val)
   {
      if (_isFrozen)
         throw new InvalidOperationException();

      // write ...
   }

   public Object ReadSomething()
   {
      return it;
   }
} 
```

Eric Lippert 似乎建议在[这篇](http://blogs.msdn.com/b/ericlippert/archive/2011/05/23/read-only-and-threadsafe-are-different.aspx)文章中这样做是可以的。我知道写入具有释放语义，但据我了解，这仅与*ordering*相关，并不一定意味着所有线程都会在写入后立即看到该值。谁能证实这一点？这意味着这个解决方案不是线程安全的（当然这可能不是唯一的原因）。

**尝试2：**

以上，但`Interlocked.Exchange`用于确保实际发布的值：

```
public class Foobar
{
   private Int32 _isFrozen;

   public void Freeze() { Interlocked.Exchange(ref _isFrozen, 1); }

   public void WriteValue(Object val)
   {
      if (_isFrozen == 1)
         throw new InvalidOperationException();

      // write ...
   }
} 
```

这样做的好处是我们确保发布该值而不会遭受每次读取的开销。如果在写入 _isFrozen 之前没有任何读取被移动，因为 Interlocked 方法使用完整的内存屏障，我猜这是线程安全的。但是，谁知道编译器会做什么（根据 C# 规范的第 3.10 节，这似乎很多），所以我不知道这是否是线程安全的。

**尝试 3：**

也可以使用`Interlocked`.

```
public class Foobar
{
   private Int32 _isFrozen;

   public void Freeze() { Interlocked.Exchange(ref _isFrozen, 1); }

   public void WriteValue(Object val)
   {
      if (Interlocked.CompareExchange(ref _isFrozen, 0, 0) == 1)
         throw new InvalidOperationException();

      // write ...
   }
} 
```

绝对线程安全，但每次读取都必须进行比较交换似乎有点浪费。我知道这种开销可能很小，但我正在寻找一种*相当*有效的方法（尽管也许就是这样）。

**尝试4：**

使用`volatile`：

```
public class Foobar
{
   private volatile Boolean _isFrozen;

   public void Freeze() { _isFrozen = true; }

   public void WriteValue(Object val)
   {
      if (_isFrozen)
         throw new InvalidOperationException();

      // write ...
   }
} 
```

但是 Joe Duffy 声明“ [sayon​​ara volatile](http://www.bluebytesoftware.com/blog/2010/12/04/SayonaraVolatile.aspx) ”，所以我不会认为这是一个解决方案。

**尝试 5：**

锁定一切，似乎有点矫枉过正：

```
public class Foobar
{
   private readonly Object _syncRoot = new Object();
   private Boolean _isFrozen;

   public void Freeze() { lock(_syncRoot) _isFrozen = true; }

   public void WriteValue(Object val)
   {
      lock(_syncRoot) // as above we could include an attempt that reads *without* this lock
         if (_isFrozen)
            throw new InvalidOperationException();

      // write ...
   }
} 
```

似乎也绝对是线程安全的，但比使用上面的 Interlocked 方法有更多的开销，所以我更倾向于尝试 3 而不是这个。

然后我至少可以想出更多（我敢肯定还有更多）：

**尝试 6：**使用`Thread.VolatileWrite`and `Thread.VolatileRead`，但据说这些有点偏重。

**尝试 7：**使用`Thread.MemoryBarrier`，似乎有点太*内部*了。

**尝试 8：**创建不可变副本 - 不想这样做

总结：

*   您将使用哪种尝试以及为什么（或者如果完全不同，您将如何做）？（即，发布一个值的最佳方式是什么，然后同时读取它，同时在不过度“聪明”的情况下合理高效？）
*   .NET 的内存模型“释放”写入语义是否意味着所有其他线程都看到更新（缓存一致性等）？我一般不想过多思考这个问题，但能有一个了解就好了。

编辑：

也许我的问题并不清楚，但我正在特别寻找上述尝试是好是坏的原因。请注意，我在这里谈论的是一个单一写入器的场景，该写入器写入然后在任何并发读取之前冻结。我相信尝试 1 是可以的，但我想确切地知道为什么（例如，我想知道是否可以以某种方式优化读取）。我不太关心这是否是好的设计实践，而是更关心它的实际线程方面。

* * *

非常感谢收到的问题的答复，但我自己选择将其标记为答案，因为我觉得给出的答案并不能*完全*回答我的问题，我不想给访问该网站的任何人留下标记的印象答案是正确的，因为由于赏金到期，它被自动标记为正确。此外，我认为票数最高的答案并没有被压倒性地投票，不足以自动将其标记为答案。

我仍然倾向于尝试 #1 是正确的，但是，我希望得到一些权威的答案。我知道 x86 有一个强大的模型，但我不想（也不应该）为特定架构编写代码，毕竟这是 .NET 的优点之一。

如果您对答案有疑问，请选择一种锁定方法，或许可以使用此处显示的优化来避免对锁定的大量争用。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-12T17:56:17.143

也许有点偏离主题，但只是出于好奇:) 为什么不使用“真正的”不变性？例如，让 Freeze() 返回一个不可变的副本（没有“写方法”或任何其他改变内部状态的可能性）并使用这个副本而不是原始对象。您甚至可以不更改状态，而是在每次写入操作时返回一个新副本（状态已更改）（afaik 字符串类可以这样做）。“真正的不变性”本质上是线程安全的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-03T21:50:25.333

我投票支持尝试 5，使用 lock(this) 实现。

这是使这项工作最可靠的方法。可以使用读/写锁，但收效甚微。只需使用普通锁即可。

`_isFrozen`如有必要，您可以通过首先检查然后锁定来提高“冻结”性能：

```
void Freeze() { lock (this) _isFrozen = true; }
object ReadValue()
{
    if (_isFrozen)
        return Read();
    else
        lock (this) return Read();
}
void WriteValue(object value)
{
    lock (this)
    {
        if (_isFrozen) throw new InvalidOperationException();
        Write(value);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-06T16:23:02.573

如果你真的在展示给其他线程之前创建、填充和冻结对象，那么你不需要任何特殊的东西来处理线程安全（.NET 的强内存模型已经是你的保证），所以解决方案 1 是有效的。

但是，如果您将未冻结的对象提供给另一个线程（或者如果您只是简单地创建类而不知道用户将如何使用它），那么使用返回一个新的完全不可变实例的解决方案可能会更好。在这种情况下，可变实例就像 StringBuilder，不可变实例就像字符串。如果您需要额外的保证，可变实例可能会检查其创建者线程，如果它被任何其他线程使用，则抛出异常（在所有方法中......以避免可能的部分读取）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T20:55:18.567

> 也许我的问题并不清楚，但我正在特别寻找上述尝试是好是坏的原因。请注意，我在这里谈论的是一个单一写入器的场景，该写入器写入然后在任何并发读取之前冻结。我相信尝试 1 是可以的，但我想确切地知道为什么（例如，我想知道是否可以以某种方式优化读取）。我不太关心这是否是好的设计实践，而是更关心它的实际线程方面。

好的，现在我更好地了解您在做什么并在寻找回复。请允许我通过首先解决您的每次尝试来详细说明我之前的回答，以促进使用锁。

**尝试1：**

在您的示例中，使用没有任何形式的同步原语的简单类的方法是完全可行的。由于“创作”线程是在其变异状态期间可以访问此类的唯一线程，因此这应该是安全的。如果仅当另一个线程有可能在类被“冻结”之前访问时，您需要提供同步。本质上，线程不可能缓存它从未见过的东西。

除了具有此列表内部状态的缓存副本的线程之外，您还应该关注另一个并发问题。您应该考虑通过创作线程进行写入重新排序。您的示例解决方案没有足够的代码让我解决这个问题，但是将这个“冻结”列表交给另一个线程的过程是问题的核心。您是在使用 Interlocked.Exchange 还是写入 volatile 状态？

我仍然主张这*不是*最好的方法，因为不能保证另一个线程在变异时没有看到该实例。

**尝试2：**

虽然不应使用尝试 2。如果您对成员使用原子写入，则还应该使用原子读取。我永远不会推荐一个没有另一个，因为如果没有读取和写入*都是*原子的，你就什么也得不到。原子读写的正确应用是您的“尝试 3”。

**尝试 3：**

如果线程试图改变冻结列表，这将保证抛出异常。但是，它没有断言只有在冻结的实例上才能接受读取。`_isFrozen`恕我直言，这与使用原子和非原子访问器访问我们的变量一样糟糕。如果您要说保护写入很重要，那么您应该始终保护读取。一个没有另一个只是“奇怪”。

忽略我自己对编写 gaurds 写但不读的代码的感觉，考虑到您的特定用途，这是一种可以接受的方法。我有一个作家，我写作，我冻结，然后我把它提供给读者。在这种情况下，您的代码可以正常工作。`_isFrozen`在将类交给另一个线程之前，您依赖于集合上的原子操作来提供所需的内存屏障。

简而言之，这种方法是有效的，但是如果一个线程有一个未冻结的实例，它就会中断。

**尝试4：**

虽然本质上这与尝试 3 几乎相同（给定一位作家），但有一个很大的不同。在这个例子中，如果你签`_isFrozen`入阅读器，那么每次访问都需要一个内存屏障。一旦列表被冻结，这是不必要的开销。

这仍然与尝试 3 具有相同的问题，因为`_isFrozen`在读取期间没有对状态进行断言，因此在您的示例用法中性能应该相同。

**尝试 5：**

正如我所说，这是我的偏好，因为修改为在我的其他答案中出现。

**尝试 6：**

与#4 基本相同。

**尝试 7：**

您可以使用`Thread.MemoryBarrier`. 基本上使用尝试 1 中的代码，您创建实例、调用`Freeze()`、添加您的实例`Thread.MemoryBarrier`，然后共享实例（或在锁中共享它）。这应该很好用，同样仅在您有限的用例下。

**尝试 8：**

在不了解更多信息的情况下，我无法就副本的成本提供建议。

**概括**

同样，我更喜欢使用具有一些线程保证或根本没有线程保证的类。在 IMO 中，创建一个仅“部分”线程安全的类是危险的。

用一位著名的绝地大师的话来说：

> 要么做要么不做没有尝试。

线程安全也是如此。该类应该是线程安全的或不是线程安全的。采用这种方法，您要么使用我对尝试 5 的增强，要么使用尝试 7。如果可以选择，我永远不会推荐 #7。

所以我的建议坚定地支持完全线程安全的版本。两者之间的性能成本非常小，几乎不存在。读取器线程*永远不会*仅仅因为您拥有一个写入器的使用场景而锁定。然而，如果他们这样做，正确的行为仍然是确定的。因此，随着您的代码随着时间的推移而发生变化，并且您的实例突然在被冻结之前被共享，您不会遇到导致程序崩溃的竞争条件。线程安全与否，不要半信半疑，否则有一天你会遇到令人讨厌的惊喜。

我的偏好是多个线程共享的所有类都是以下两种类型之一：

1.  完全不可变。
2.  完全线程安全。

由于冰棒列表在设计上不是一成不变的，因此它不适合 #1。因此，如果您要跨线程共享对象，它应该适合＃2。

希望所有这些咆哮能进一步解释我的推理:)

**_syncRoot**

许多人注意到我`_syncRoot`在锁定实现中跳过了 a 的使用。虽然使用 _syncRoot 的理由是正确的，但它们并不总是必要的。在您有一个编写器的示例用法中，使用`lock(this)`应该就足够了，而无需为`_syncRoot`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-13T11:27:52.073

#1 - 阅读器不是线程安全的 - 我相信问题出在阅读器方面，而不是编写器（代码未显示）
#2 - 阅读器不是线程安全的 - 与 #1 相同
#3 - 有希望，可以针对大多数情况优化读取检查（当CPU 缓存同步）

尝试 3：

还可以使用 Interlocked 进行读取。

```
public class Foobar {

  private object _syncRoot = new object();
  private int _isFrozen = 0; // perf compiler warning, but training code, so show defaults

  // Why Exchange to 1 then throw away result.  Best to just increment.
  //public void Freeze() { Interlocked.Exchange(ref _isFrozen, 1); }
  public void Freeze() { Interlocked.Increment(ref _isFrozen); }

  public void WriteValue(Object val) {
       // if this core can see _isFrozen then no special lock or sync needed
       if (_isFrozen != 0)
           throw new InvalidOperationException();

       lock(_syncRoot) {
           if (_isFrozen != 0)
               throw new InvalidOperationException(); // the 'throw' is 100x-1000x more costly than the lock, just eat it
           _val = val;
       }

  }

  public object Read() {
       // frozen is one-way, if one-way state has been published 
       // to my local CPU cache then just read _val.  
       // There are very strange corner cases when _isFrozen and _val fields are in 
       // different cache lines, but should be nearly impossible to hit unless
       // dealing with very large structs (make it more likely to cross 
       // 4k cache line).
       if (_isFrozen != 0) 
           return _val;

       // else
       lock(_syncRoot) { // _isFrozen is 0 here
           if (_isFrozen != 0) // if _isFrozen is 1 here we just collided with writer using lock on other thread, or our CPU cache was out of sync and lock() forced the dirty cache line to be read from main memory
              return _val;

           throw new InvalidOperationException(); // throw is 100x-1000x more expensive than lock, eat the cost of lock
       }          
  }

} 
```

我认为，Joe Duffy 关于“volatile is dead”的帖子是在他的下一代 CLR/OS 架构和 ARM 上的 CLR 的背景下。我们这些做多核 x64/x86 的人我认为 volatile 很好。如果性能是主要关注点，我建议您测量上面的代码并将其与 volatile 进行比较。

与其他发布答案的人不同，如果您有很多读者（3 个或更多线程可能同时读取同一个对象），我不会直接跳到 lock()。但是在您的示例中，当发生碰撞时，您将性能敏感问题与异常混合在一起，这没有多大意义。如果您使用异常，那么您还可以使用其他更高级别的构造。

如果您想要完全安全但需要针对大量并发读者进行优化，请将 lock()/Monitor 更改为 ReaderWriterLockSlim。

.NET 具有处理发布值的新原语。看看 Rx。在某些情况下，它可以非常快速且无锁（我认为他们使用类似于上面的优化）。

如果多次写入但只保留一个值 - 在 Rx 中是“new ReplaySubject(bufferSize: 1)”。如果您尝试一下，您可能会惊讶于它的速度有多快。同时，我赞赏您尝试学习这种详细程度的尝试。

如果您想无锁，请克服对 Thread.MemoryBarrier() 的厌恶。这是极其重要的。但它具有与 Joe Duffy 所描述的 volatile 相同的陷阱——它被设计为对编译器和 CPU 的提示，以防止内存读取的重新排序（这在 CPU 方面需要很长时间，因此当没有提示存在）。当这种重新排序与函数自动内联等 CLR 结构相结合时，您会在内存和寄存器级别看到非常令人惊讶的行为。MemoryBarrier() 只是禁用 CPU 和 CLR 大部分时间使用的那些单线程内存访问假设。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-03T22:39:28.363

尝试 2 在 x86 和其他具有强大内存模型的处理器上是线程安全的，但我将如何做到这一点是让线程安全成为消费者问题，因为您无法在使用的代码中有效地做到这一点。考虑：

```
if(!foo.frozen)
{
    foo.apropery = "avalue";
} 
```

属性的线程安全`frozen`和 's setter 中的保护代码`apropery`并不重要，因为即使它们是完全线程安全的，您仍然有竞争条件。相反，我会这样写

```
lock(foo)
{
    if(!foo.frozen)
    {
        foo.apropery = "avalue";
    }
} 
```

并且没有任何属性本质上是线程安全的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-03T21:49:23.377

事物是否被构造和写入，然后被永久冻结并多次读取？

或者你是否多次冻结和解冻并重新冻结？

如果是前者，那么“被冻结”检查可能应该在 reader 方法而不是 writer 方法中（以防止它在冻结之前读取）。

或者，如果是后者，那么您需要注意的用例是：

*   主线程调用 writer 方法，发现没有被冻结，于是开始写
*   在写入完成之前，有人尝试冻结对象然后从中读取，而另一个（主）线程仍在写入

在后一种情况下，谷歌显示了许多你可能会感兴趣的[多读单作者的结果。](https://www.google.com/search?q=multiple+reader+single+writer)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-06T23:49:20.227

我不确定以下方法的成本如何，但它有点不同。只有在最初有多个线程同时尝试写入值时，它们才会遇到锁。一旦它被冻结，所有以后的调用都将直接获得异常。

**尝试 9：**

```
public class Foobar
{
    private readonly Object _syncRoot = new Object();
    private object _val;
    private Boolean _isFrozen;

    private Action<object> WriteValInternal;

    public void Freeze() { _isFrozen = true; }

    public Foobar()
    {
        WriteValInternal = BeforeFreeze;
    }

    private void BeforeFreeze(object val)
    {
        lock (_syncRoot)
        {
            if (_isFrozen == false)
            {
                //Write the values....
                _val = val;
                //...
                //...
                //...
                //and then modify the write value function
                WriteValInternal = AfterFreeze;
                Freeze();
            }
            else
            {
                throw new InvalidOperationException();
            }
        }
    }

    private void AfterFreeze(object val)
    {
        throw new InvalidOperationException();
    }

    public void WriteValue(Object val)
    {
        WriteValInternal(val);
    }

    public Object ReadSomething()
    {
        return _val;
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-03T23:17:52.240

一般来说，每个可变对象都应该有一个明确定义的“所有者”；共享对象应该是不可变的。冰棒在被冻结之前不应该被多个线程访问。

就个人而言，我不喜欢暴露的“冻结”方法的冰棒免疫形式。我认为更简洁的方法是拥有`AsMutable`和`AsImmutable`方法（每个方法都会在适当的时候简单地返回未修改的对象）。这种方法可以允许关于不变性的更强大的承诺。例如，如果“未共享的可变对象”在其`AsImmutable`成员被调用时被变异（与“未共享”的对象相反的行为），则副本中的数据状态可能是不确定的，但无论返回什么将是不可变的。相比之下，如果一个线程冻结了一个对象，然后假设它是不可变的，而另一个线程正在写入它，那么“不可变”对象可能在它被冻结并读取其值后最终发生变化。

**编辑**

根据进一步的描述，我建议让写入对象的代码在监视器锁中执行此操作，并让冻结例程看起来像：

```
public Thingie Freeze(void) // 返回有问题的对象
{
  if (isFrozen) // 私有字段
    返回这个；
  别的
    返回 DoFreeze();
}

Thingie DoFreeze(无效)
{
  if (Monitor.TryEnter(随便))
  {
    isFrozen =真；
    返回这个；
  }
  else if (isFrozen)
    返回这个；
  别的
    throw new InvalidOperationException("作者正在使用的对象");
}

```

该`Freeze`方法可以被任意数量的线程调用任意次数；它应该足够短以便内联（尽管我没有对其进行分析），因此几乎不需要时间来执行。如果任何线程中对象的第一次访问是通过该`Freeze`方法，那应该保证在任何合理的内存模型下的适当可见性（即使线程没有看到创建并最初冻结它的线程对对象执行的更新，它将执行`TryEnter`，这将保证内存屏障，并且在失败之后它会注意到对象被冻结并返回它。

如果要写入对象的代码首先获得锁，则尝试写入冻结的对象可能会死锁。如果希望这样的代码抛出异常，则使用`TryEnter`并在无法获得锁时抛出异常。

用于锁定的对象应该是被冻结对象专有的东西。如果要冻结的对象不包含对任何东西的纯私有引用，则可以锁定`this`或创建一个纯粹用于锁定目的的私有对象。请注意，在不清理的情况下放弃“进入”的监视器锁是安全的；GC 将简单地忘记它们，因为如果不存在对锁的引用，那么任何人都不会关心（甚至可以询问）锁在被放弃时是否被输入。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-13T19:37:13.640

你检查过懒惰吗

[http://msdn.microsoft.com/en-us/library/dd642331.aspx](http://msdn.microsoft.com/en-us/library/dd642331.aspx)

它使用 ThreadLocal

[http://msdn.microsoft.com/en-us/library/dd642243.aspx](http://msdn.microsoft.com/en-us/library/dd642243.aspx)

实际上，进一步看，有一个 Freezable 类...

[http://msdn.microsoft.com/en-us/library/vstudio/ms602734(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms602734(v=vs.100).aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-12-20T16:11:35.537

您可以使用 POST Sharp 实现此目的

取一个接口

```
public interface IPseudoImmutable
{

    bool IsFrozen { get; }

    bool Freeze();
} 
```

然后像这样从 InstanceLevelAspect 派生您的属性

```
 /// <summary>
/// implement by divyang
/// </summary>
[Serializable]
[IntroduceInterface(typeof(IPseudoImmutable),
    AncestorOverrideAction = InterfaceOverrideAction.Ignore, OverrideAction = InterfaceOverrideAction.Fail)]
public class PseudoImmutableAttribute : InstanceLevelAspect, IPseudoImmutable
{

    private volatile bool isFrozen;

    #region "IPseudoImmutable"

    [IntroduceMember]
    public bool IsFrozen
    {
        get
        {
            return this.isFrozen;
        }
    }

    [IntroduceMember(IsVirtual = true, OverrideAction = MemberOverrideAction.Fail)]
    public bool Freeze()
    {
        if (!this.isFrozen)
        {
            this.isFrozen = true;
        }

        return this.IsFrozen;
    }

    #endregion

    [OnLocationSetValueAdvice]
    [MulticastPointcut(Targets = MulticastTargets.Property | MulticastTargets.Field)]
    public void OnValueChange(LocationInterceptionArgs args)
    {
        if (!this.IsFrozen)
        {
            args.ProceedSetValue();
        }
    }
}

public class ImmutableException : Exception
{
    /// <summary>
    /// The location name.
    /// </summary>
    private readonly string locationName;

    /// <summary>
    /// Initializes a new instance of the <see cref="ImmutableException"/> class.
    /// </summary>
    /// <param name="message">
    /// The message.
    /// </param>
    public ImmutableException(string message)
        : base(message)
    {
    }

    public ImmutableException(string message, string locationName)
        : base(message)
    {
        this.locationName = locationName;
    }

    public string LocationName
    {
        get
        {
            return this.locationName;
        }
    }
} 
```

然后像这样申请你的班级

```
 [PseudoImmutableAttribute]
public class TestClass
{

    public string MyString { get; set; }

    public int MyInitval { get; set; }
} 
```

然后在多线程中运行它

```
 /// <summary>
/// The program.
/// </summary>
public class Program
{
    /// <summary>
    /// The main.
    /// </summary>
    /// <param name="args">
    /// The args.
    /// </param>
    public static void Main(string[] args)
    {
        Console.Title = "Divyang Demo ";
        var w = new Worker();
        w.Run();
        Console.ReadLine();
    }
}

internal class Worker
{

    private object SyncObject = new object();

    public Worker()
    {
        var r = new Random();
        this.ObjectOfMyTestClass = new MyTestClass { MyInitval = r.Next(500) };
    }

    public MyTestClass ObjectOfMyTestClass { get; set; }

    public void Run()
    {

        Task readWork;

        readWork = Task.Factory.StartNew(

            action: () =>
                {
                    for (;;)
                    {
                        Task.Delay(1000);
                        try
                        {
                            this.DoReadWork();
                        }
                        catch (Exception exception)
                        {
                            // Console.SetCursorPosition(80,80);
                            // Console.SetBufferSize(100,100);
                            Console.WriteLine("Read Exception : {0}", exception.Message);
                        }
                    }
                    // ReSharper disable FunctionNeverReturns
                });

        Task writeWork;

        writeWork = Task.Factory.StartNew(

            action: () =>
                {
                    for (int i = 0; i < int.MaxValue; i++)
                    {
                        Task.Delay(1000);
                        try
                        {
                            this.DoWriteWork();
                        }
                        catch (Exception exception)
                        {
                            Console.SetCursorPosition(80, 80);
                            Console.SetBufferSize(100, 100);
                            Console.WriteLine("write Exception : {0}", exception.Message);
                        }

                        if (i == 5000)
                        {

                            ((IPseudoImmutable)this.ObjectOfMyTestClass).Freeze();

                        }
                    }
                });

        Task.WaitAll();
    }

    /// <summary>
    /// The do read work.
    /// </summary>
    public void DoReadWork()
    {
        // ThreadId  where reading is done
        var threadId = System.Threading.Thread.CurrentThread.ManagedThreadId;

        // printing on screen
        lock (this.SyncObject)
        {
            Console.SetCursorPosition(0, 0);
            Console.SetBufferSize(290, 290);
            Console.WriteLine("\n");
            Console.WriteLine("Read Start");
            Console.WriteLine("Read => Thread Id: {0} ", threadId);
            Console.WriteLine("Read => this.objectOfMyTestClass.MyInitval: {0} ", this.ObjectOfMyTestClass.MyInitval);
            Console.WriteLine("Read => this.objectOfMyTestClass.MyString: {0} ", this.ObjectOfMyTestClass.MyString);

            Console.WriteLine("Read End");
            Console.WriteLine("\n");
        }
    }

    /// <summary>
    /// The do write work.
    /// </summary>
    public void DoWriteWork()
    {
        // ThreadId  where reading is done
        var threadId = System.Threading.Thread.CurrentThread.ManagedThreadId;

        // random number generator
        var r = new Random();
        var count = r.Next(15);

        // new value for Int property
        var tempInt = r.Next(5000);
        this.ObjectOfMyTestClass.MyInitval = tempInt;

        // new value for string Property
        var tempString = "Randome" + r.Next(500).ToString(CultureInfo.InvariantCulture);

        this.ObjectOfMyTestClass.MyString = tempString;

        // printing on screen
        lock (this.SyncObject)
        {
            Console.SetBufferSize(290, 290);
            Console.SetCursorPosition(125, 25);

            Console.WriteLine("\n");
            Console.WriteLine("Write Start");
            Console.WriteLine("Write => Thread Id: {0} ", threadId);
            Console.WriteLine("Write => this.objectOfMyTestClass.MyInitval: {0} and New Value :{1} ", this.ObjectOfMyTestClass.MyInitval, tempInt);
            Console.WriteLine("Write => this.objectOfMyTestClass.MyString: {0} and New Value :{1} ", this.ObjectOfMyTestClass.MyString, tempString);
                          Console.WriteLine("Write End");
            Console.WriteLine("\n");
        }
    }
}

but still it will allow you to change property like array ,list . but if you apply more login in that then it may work for all type of property and field 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-02-19T20:04:01.547

受 C++ 可移动类型的启发，我会做这样的事情。请记住不要在冻结/解冻后访问该对象。

当然，`_data != null`如果您想清楚用户在解冻/冻结后访问时为什么会获得 NRE，您可以添加检查/抛出。

```
public class Data 
{
   public string _foo;
   public int _bar;
}

public class Mutable 
{
   private Data _data = new Data();

   public Mutable() {}

   public string Foo { get => _data._foo; set => _data._foo = value; }
   public int Bar { get => _data._bar; set => _data._bar = value; }

   public Frozen Freeze() 
   { 
      var f = new Frozen(_data);
      _data = null;
      return f;
   }
}

public class Frozen 
{
   private Data _data;

   public Frozen(Data data) => _data = data;              

   public string Foo => _data._foo;  
   public int Bar => _data._bar;

   public Mutable Thaw() 
   { 
      var m = new Mutable(_data);
      _data = null;
      return m;
   }
} 
```

# visual-studio-2010 - 如何将示例数据添加到 edmx 文件并在 Visual-Studio 中显示

> ID：13691613
> 
> 赞同：0
> 
> 时间：2012-12-03T21:00:29.530
> 
> 标签：visual-studio-2010, entity-framework, xsd, entity-framework-5

我正在使用 Visual Studio 2010 和 ADO.Net 实体数据模型来创建我的数据库架构。由于我仍在起草和讨论架构，我希望能够将示例数据添加到 edmx 文件中，并能够在设计器中显示它，如下面的屏幕截图所示：

![如何在 Visual Studio 中显示数据模型和示例数据](../Images/9dd614d23c90dcb99456f1c8f4bee90c.png)

## 添加示例数据的 EDMX 文件源代码

底层 xml 代码将包含正常的 edmx 输出，并在顶部包含如下示例数据：

```
<?xml version="1.0" encoding="utf-8"?>
....
<EntityType Name="Title">
  <Documentation>
    <Summary>Table titles contains all the dvd-title we have in our store</Summary>
  </Documentation>
  <Key>
    <PropertyRef Name="Id" />
  </Key>
  <Property Type="Int32" 
          Name="Id" Nullable="false" 
          annotation:StoreGeneratedPattern="Identity" />
  <Property Type="String" Name="Title" Nullable="false" >
  <Documentation>
    <Summary>The title of the movie</Summary>
    <LongDescription>
         The translated title of the movie and the original title     
    </LongDescription>
  </Documentation>
 </Property>
</EntityType>
<Titles>
    <Title>  
        <id>810</id>
        <title>Pulp Fiction</title>
        <year>1994</year>
    </Title> 
    <Title>  
        <id>940</id>
        <title>Lock, Stock and Two Smoking Barrels</title>
        <year>1998</year>
    </Title> 
</Titles> 
```

样本数据应该显示出来并且应该在设计视图中是可编辑的。

**有谁知道组合 edmx 文件并显示和添加示例数据的工具或方法？**

奖励问题：当我生成 sql 语句时，文档不会添加到 sql 语句中。有没有办法包含字段和表格的文档，以便将它们添加到 Microsoft SQL Server？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:18:07.197

我不认为这是可能的。原因之一是您看到的是模型而不是数据库模式。您没有看到实体是如何映射到数据库的。在基本场景中确实存在 1:1 映射，但是一旦您开始自定义模型，您最终可能会在数据库中拥有名称与模型中的属性名称不同的列，您可能有复杂的属性，甚至没有相应的属性对于图表，您可以将多个实体放在一张表中，也可以将一个实体放在多张表中。你将如何展示这个？而且由于它只是实体模型而不是表模型数据似乎不太合适。我不知道有什么工具可以满足您的需求。Edmx 是一个 Xml 文件，设计器本身是可扩展的并且基于 DSL。

# ios - 使用“分组”样式时自定义 UITableViewCell 未调整大小

> ID：13691615
> 
> 赞同：0
> 
> 时间：2012-12-03T21:00:55.677
> 
> 标签：ios, ipad

我有一个视图控制器，它是 SplitViewController 的“详细信息”端。它有一个控件，一个 UITableView。我正在加载一个自定义 UITableViewCell。当“样式”设置为“普通”（有点）时，它工作正常。但是当我将样式更改为“分组”时，自定义单元格会超出每个分组部分的边界。

如果我在自定义单元格笔尖上关闭“自动布局”，它就可以工作。但是，我希望单元格使用自动布局，以便它可以在不同设备上以我想要的方式工作。

就像我说的，它“有点”以“普通”风格工作。问题仍然存在。如果我在设备上切换方向，详细视图控制器现在在整个视图上都有滚动条。所以，我们确实有同样的间距问题，只是不那么明显。

我对此完全感到困惑。我不可能是第一个看到这个的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-05T15:33:09.247

这与自动放置在 UITableViewCell 中的任何对象上的“水平间距”约束有关。降低此约束的优先级，然后以编程方式添加您自己的约束将解决问题。

请参阅此 stackoverflow 问题 - [Auto layout with custom UITableViewCell](https://stackoverflow.com/questions/12998672/auto-layout-with-custom-uitableviewcell)。

我用来将标签保持在 Grouped UITableViewCell 范围内的示例。这需要在创建单元格时完成：

```
NSDictionary *dict = NSDictionaryOfVariableBindings(_label);
[self.contentView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-10-[_label]" options:0 metrics:nil views:dict]]; 
```

# php - 文件路径反斜杠

> ID：13691619
> 
> 赞同：0
> 
> 时间：2012-12-03T21:01:01.290
> 
> 标签：php, phpmyadmin

我使用 PHP、Appache 和 PHPMyAdmin 构建了一个相当基本的本地数据库驱动网站。该站点允许用户上传两种格式的 cad 详细文件。除了文件路径，他们还可以上传文件名、相关服务组以及详细 ID。

基本上，除了从上传页面上传文件时出现一个小问题外，一切都很顺利。一切都很好地提交到数据库，但文件的链接缺少必要的反斜杠。

但是，我可以进入数据库本身并将反斜杠输入到文件路径中。

**形式：**

```
<form method="post" action="add.php">
 <table border="0">

 <tr><td>Detail ID: </td><td><input type="number" name="id" /></td></tr>

 <tr><td>Detail Name: </td><td><input type="text" name="name" /></td></tr>

 <tr><td>Service Group: </td><td><input type="text" name="service" /></td></tr>

 <tr><td>PDF: </td><td><input type="file" name="pdf" enctype="multipart/form-data"/></td></tr>

 <tr><td>DWG: </td><td><input type="file" name="dwg"/></td></tr>

 <tr><td></td><td><input type="submit" value="Submit" />
    <input type="reset" value="Reset" /></td></tr>

 </table>
 </form> 
```

**PHP：**

```
$con=mysql_connect("localhost","root","");
 /* Select the database */
 mysql_select_db("hrg_test");

 /* Store the values submitted by form in variable */
 $id=$_POST['id'];
 $name=$_POST['name'];
 $service=$_POST['service'];
 $pdf=$_POST['pdf'];
 $dwg=$_POST['dwg'];

 /* Write a query to insert details into database */
 $insert_detail=mysql_query("INSERT INTO hrg_test (id, name, service, pdf, dwg) VALUES ('$id',      '$name',     '$service',     '$pdf',     '$dwg')");

 if($insert_detail)
 { echo "Detail Succesfully Added! <br /><br /><a href='add.html'>Add Another Detail</a>"; }
 else
 { echo "Error".mysql_error(); }

 /* closing the if else statements */

 mysql_close($con);
 ?> 
```

我已经阅读了魔术引号和stripslashes，尽管如果这是问题，我不确定如何将它们联系起来。也许我只是以错误的方式去做。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:55:45.713

我想你可以通过在每个输入的 POST 变量分配上使用这些来完成这项工作。

```
$pdf=mysql_real_escape_string($_POST['pdf']); 
```

然而。这里的问题更深。它现在可能只是一个本地脚本。我们都去过那里。事情变化的速度令人惊讶，而且可能并不总是有时间进行重构（老板喜欢原型并想要昨天完成的应用程序），或者有人复制您的代码（也许是您？）以在更公共的环境中使用。即使此脚本位于“仅限管理员”区域，恶意编码员（或心怀不满的管理员？）也可以访问管理系统，然后能够上传各种讨厌的东西并对您的数据库做一些令人讨厌的事情！没有人相信。

这里简要概述了一些问题，以及如何以低于零的工作成本对其进行改进。

1.  MySQL API。[不建议将此扩展用于编写新代码。相反，mysqli 或 PDO_MySQL](http://php.net/manual/en/intro.mysql.php)
2.  此代码易受数据库注入攻击。您需要转义您的数据。这意味着使数据可以安全地插入数据库（例如转义 ' 字符）。你可以使用`mysql_real_escape_string()`，但这仍然会留下安全漏洞，并让你有机会忘记逃跑。但是，如果我们选择 PDO 扩展，那么您可以使用参数化查询，您的所有问题都将得到神奇的解决。
3.  接受用户上传总是有风险的。你越能限制它越好。如果您知道您只想接受某种类型的文件，请确保检查文件类型。如果可能，请将文件移动到无法通过 HTTP 请求访问的位置。如果它必须可通过 HTTP 访问，则尝试将文件重命名为不易猜到的名称。也许是一个 30 个字符左右的随机字符串。这意味着恶意编码人员无法上传名为“bad_things.php”的顽皮 PHP 脚本，只需访问“www.example.com/uploads/bad_things.php”即可让该脚本在您的服务器上运行。您似乎没有在任何地方保存上传的文件，所以我没有提供示例。那里有无数的例子：[这里有一些看起来很合理的东西](http://php.about.com/od/advancedphp/qt/upload_security.htm)

这是一些示例代码，不仅安全，而且更简单（而且更短，一点都不重要。）

* * *

```
$dbh = new PDO('mysql:host=localhost;dbname=hrg_test', 'root', '');
$stmt = $dbh->prepare("INSERT INTO hrg_test (id, name, service, pdf, dwg) VALUES(?,?,?,?,?)");
$result = $stmt->execute(array($_POST['id'],$_POST['name'],$_POST['service'],$_POST['pdf'],$_POST['dwg']));

if($result){ 
    echo "Detail Succesfully Added! <br /><br /><a href='add.html'>Add Another Detail</a>"; 
}
else { 
    var_dump($stmt->errorInfo());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:10:21.097

我将忽略安全问题，因为这是在本地站点上（没有人读过它并明显理解它的含义）。您应该查看 mysqli 或 PDO 等较新的方法，但尝试使用 mysql_real_escape_string() 包装这些值。如果这是问题，那应该避开斜线并允许存储它们。

另一方面，我还开发了一个封闭的公司内部网。尽管我知道怎么做，但在许多情况下，我的老板恳求我放弃不必要的安全措施，因为唯一的访问权限是员工。

如果您还要回答这个问题，指出存在安全问题是可以的……如果不是，那您只是在浪费您和其他人的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T16:58:49.563

另一件要注意的是双引号的使用。我注意到您的 echo 语句使用了双引号 (")，这会导致引号内的字符串被预处理（变量被扩展等...）。如果您操作任何数据，并将路径放在双引号内的字符串中，反斜杠将将以下字符转换为文字，并使您的反斜杠消失。

例如：

```
$UploadPath = "New\Drawings";
$NewPath = "C:\UPLOADS\$UploadPath"; 
```

在这种情况下，$NewPath 被转换为“C:UPLOADSNewDrawings”，因为每个反斜杠都将其后面的字符变为文字。使用单引号 (') 将防止这种情况，或者使用双反斜杠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T20:49:37.823

我的观点 Joe 并不是说​​安全性不重要，只是你没有必要在像 SO 这样的网站上批评代码的安全性。事实上，我很想看到像 SO 这样的网站完全禁止它。如果我问的是安全性，很好，但是如果我发布一个代码片段（我可能只是为了展示我的意思的一个例子而写的）我不应该处理从“这里有 37 个链接关于安全性”到“玩得开心让您的数据库 pwned”或任何有人想留下的时髦评论。

目标应该始终是回答OP的问题。这几乎就像有人在考虑安全原则的那一刻起，他们认为他们需要在互联网上大肆攻击以防止糟糕的编码人员犯错。老实说，我发现这是完全放错了地方的能量，因为绝大多数人的回答是“我知道，这只是一个发帖的例子”。

更不用说，在你的例子中......你说“更简单？” 包括大括号行，你的代码片段是 11 行代码，使用人们应该学习的语法，但可能还不习惯。OP 发布了 14 行代码（其中 5 行将 post 变量设为本地，这是不需要的，并且会将他的代码减少到 9 行。那“更容易”呢？我不想在这里成为魔鬼的拥护者，但是说PDO/mysqli 更简单是一种观点，它们肯定更好，但更简单是一个折腾。

如果安全性是问题的重点，您的回答会很棒……我会诚实地考虑您劫持了什么。

# dojo - 如何确定 dgrid 是否已完成从商店加载数据

> ID：13691622
> 
> 赞同：2
> 
> 时间：2012-12-03T21:01:05.907
> 
> 标签：dojo, dgrid

有谁知道我怎样才能知道 dgrid 是否已完成从商店加载数据？

我一直试图在 dgrid 的 OnDemandList.js 中找到一种方法来做到这一点，但不幸的是它超出了我目前对 dojo 的了解。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T15:23:43.630

前段时间我想出了这个解决方案`dgrid v0.3.0`，但是从源代码来看，到目前为止似乎没有任何改变，所以我将尝试将我的解决方案调整为 v0.3.3。

看看它在行动：http: [//jsfiddle.net/phusick/FkANy/](http://jsfiddle.net/phusick/FkANy/)

问题是返回时`dgrid/_StoreMixin::_trackError`没有定义*成功*回调`Deferred::when`，因此您需要覆盖该方法，定义*成功*回调并在那里触发*刷新*事件。

`_RefreshMixin`模块：

```
define(["dojo/_base/declare", "dojo/_base/lang", "dojo/_base/Deferred", "dojo/on"], function(declare, lang, Deferred, listen) {

    function emitError(err){
        if(typeof err !== "object"){
            err = new Error(err);
        }
        err.grid = this;

        if(listen.emit(this.domNode, "dgrid-error", {
                grid: this,
                error: err,
                cancelable: true,
                bubbles: true })){
            console.error(err);
        }
    }

    var _RefreshMixin = declare(null, {

        _trackError: function(func){
            var result;

            if(typeof func == "string"){ func = lang.hitch(this, func); }

            try{
                result = func();
            }catch(err){
                emitError.call(this, err);
            }
            return Deferred.when(
                result, 
                // success callback instead of `null` in _StoreMixin:
                lang.hitch(this, function() {
                    // fire 'refresh' event
                    listen.emit(this.domNode, "refresh", {
                        cancelable: true,
                        bubbles: true
                    });
                }),
                lang.hitch(this, emitError)
            );
        }
    });

    return _RefreshMixin;

}); 
```

声明你自己的网格类并实例化它：

```
var MyGrid = declare([OnDemandGrid, _RefreshMixin]);
var grid = new MyGrid({ /* params here*/ }); 
```

现在您可以收听*刷新*事件：

```
grid.on("refresh", function(event) {
    // your handler
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-21T12:14:19.797

在**dgrid 0.3.5 上**，您可以监听`dgrid-refresh-complete`在结果渲染完成时发出的事件。

OnDemandList/Grid wiki 页面：[https ://github.com/SitePen/dgrid/wiki/OnDemandList-and-OnDemandGrid](https://github.com/SitePen/dgrid/wiki/OnDemandList-and-OnDemandGrid)

# perl - Perl::Critic “不要使用这种方法”类型的规则

> ID：13691624
> 
> 赞同：11
> 
> 时间：2012-12-03T21:01:08.360
> 
> 标签：perl, perl-critic

我们一直[`Perl::Critic`](https://metacpan.org/module/Perl::Critic)在工作中使用这里来执行我们的代码约定。最近我们遇到`/tmp`了由于该`Temp::File::tempdir`功能而导致目录被填满的问题。`tempdir`当 Perl 进程终止时进行清理，但由于我们的整个后端是一个 Perl 进程，所以这只发生在服务器本身重新启动时（不经常）。我们希望鼓励开发人员`newdir`在未来使用对象方法，一旦对象超出范围，该方法就会自行清理。

基本上，我们试图将其标记`Temp::File::tempdir`为违反代码约定，但我似乎无法在 CPAN 上找到任何类似的规则。我知道在不引入误报的情况下很难在动态类型的语言中强制执行，但我希望过去有人遇到过类似的问题，而另一个已弃用的函数。我们也不指望能捕捉到所有棘手的情况，只希望捕捉到`Temp::File::tempdir`. 这个想法是为了阻止意外使用`tempdir`when `newdir`could 做这项工作，而不是抓住所有试图愚弄评论家的企图（开发人员总是可以只使用`## no critic`）。`tempdir`如果`use Temp::File`已定义（最好检查没有其他东西重新定义`tempdir`）以及何时使用，抱怨何时使用可能就足够了`Temp::File::tempdir`。

是否已经有类似的东西，或者我应该从头开始？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-04T06:41:58.270

目前没有任何东西`Perl::Critic`可以提供你需要的东西，但是很可能添加一个策略来做类似的事情。不幸`PPI`的是，它还不够全面，无法正确识别程序中的每个令牌在做什么，因此它需要比它可能的更多编码。

该程序检查`use File::Temp`尝试`tempdir`使用任何导入的语句

```
use File::Temp 'tempdir';
use File::Temp q(tempdir);
use File::Temp "tempdir";
use File::Temp qq(tempdir);
use File::Temp qw/ tempdir /; 
```

`q`（带有、`qq`和`qw`形式的任何分隔符）。它还检查一个`PPI::Token::Word`看起来像函数调用并且等于的节点`File::Temp::tempdir`。

```
package Perl::Critic::Policy::Prohibit_tempdir;

use strict;
use warnings;

use Perl::Critic::Utils qw{ is_function_call :severities };
use Scalar::Util 'blessed';

use base 'Perl::Critic::Policy';

my $DESC = 'Temp::File::tempdir function';
my $EXPL = 'The tempdir function from Temp::File is deprecated. Use newdir method instead';

sub default_severity { $SEVERITY_HIGH };

sub applies_to{ qw/ PPI::Statement::Include PPI::Token::Word / }

sub violates {

  my ($self, $elem) = @_;

  if ($elem->isa('PPI::Statement::Include')) {

    return unless $elem->type eq 'use';

    my $module = $elem->module;
    return unless $module and $module eq 'File::Temp';

    for my $kid ($elem->children) {

      next unless blessed($kid) =~ /^PPI::Token::Quote/;

      if ($kid->can('string') and $kid->string eq 'tempdir'
          or $kid->can('literal') and grep $_ eq 'tempdir', $kid->literal) {
        return $self->violation($DESC, $EXPL, $elem);
      }
    }
  }
  else {
    if (is_function_call($elem) and $elem eq 'File::Temp::tempdir') {
      return $self->violation($DESC, $EXPL, $elem);
    }
  }

  return;
}

1; 
```

使用此代码

```
use strict;
use warnings;

use File::Temp 'tempdir';
use File::Temp "tempdir";
use File::Temp qw/ tempdir /;

my $dir = tempdir();
$dir = tempdir;
$dir = File::Temp::tempdir;

my $ft = File::Temp->new;
$dir = $ft->newdir; 
```

从生成此输出`perlcritic -4 test.pl`

```
Code not contained in explicit package at line 1, column 1\.  Violates encapsulation.  (Severity: 4)
Temp::File::tempdir function at line 4, column 1\.  The tempdir function from Temp::File is deprecated. Use newdir method instead.  (Severity: 4)
Temp::File::tempdir function at line 5, column 1\.  The tempdir function from Temp::File is deprecated. Use newdir method instead.  (Severity: 4)
Temp::File::tempdir function at line 6, column 1\.  The tempdir function from Temp::File is deprecated. Use newdir method instead.  (Severity: 4)
Temp::File::tempdir function at line 10, column 8\.  The tempdir function from Temp::File is deprecated. Use newdir method instead.  (Severity: 4)
Module does not end with "1;" at line 13, column 1\.  Must end with a recognizable true value.  (Severity: 4) 
```

# c++ - boost msm - 提升 msm 多个延迟事件

> ID：13691625
> 
> 赞同：2
> 
> 时间：2012-12-03T21:01:10.763
> 
> 标签：c++, boost, state-machine, boost-msm

假设我有 2 个状态，一个 Active 状态和一个 Idle 状态。如果我收到一些处于活动状态的事件，我想推迟它们并在我回到空闲状态时执行它们。

但是当我回到空闲状态时，有没有办法选择要处理的先前延迟的事件？或者有没有办法优先考虑它们，甚至忽略其中的一些？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T12:17:42.577

我不知道提升 MSM 的原生解决方案。我听说作者 Christophe Henry 对邮件列表中的此类问题非常敏感。

如果您的情况确实是微不足道的（只有两种状态），那么没有什么能阻止您实现自己的延迟事件队列，在 Active 中将“延迟事件”传递给它。您可以使用将它们推入自定义队列的操作为每种事件类型实现内部转换。进入 Idle 后，您可以根据需要重新排序它们并将它们全部发布回 SM。不过，这个解决方案并不能很好地扩展，而且有点破解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:04:58.217

我看到项目提供的文档中涵盖了延迟事件的基本功能，我发现这些文档总体上很有帮助。在标题为[正交区域、终止状态、事件延迟](http://www.boost.org/doc/libs/1_52_0/libs/msm/doc/HTML/ch03s02.html#d0e577)的部分中，查找文本“UML 将事件延迟定义为状态属性。为了适应这一点，MSM 允许您通过提供 deferred_events 类型在状态中指定它......”注意有那里描述了两种不同的方法来实现延迟事件。

如果不测试示例，我不能说有关冲突转换和守卫的参考材料是否允许您确定您在延迟事件上寻求的优先级。您可以发布您的问题或简化示例。

# networking - 这样的设置会导致什么问题？（思科 POE 交换机 -> 非托管千兆交换机 -> HP JD483B -> MSM313）

> ID：13691626
> 
> 赞同：2
> 
> 时间：2012-12-03T21:01:24.973
> 
> 标签：networking, poe

这样的设置会导致什么问题？Cisco POE 交换机 -> 非托管千兆交换机 -> HP JD483B（POE 注入器）-> MSM313

我需要在短时间内添加设备。除了HP JD483B，我还需要什么东西吗？

谢谢！

# iphone - Google Webfonts 无法在 iPhone5 上持续加载

> ID：13691627
> 
> 赞同：1
> 
> 时间：2012-12-03T21:01:26.297
> 
> 标签：iphone, ios, google-webfonts

在 iPhone5 Safari 上，我发现大多数时候我的页面在加载谷歌网络字体之前使用默认字体呈现，但是当谷歌字体完成加载时页面不会重新呈现。我在桌面浏览器或 WindowsPhone 中没有看到这个问题，在这些平台上我没有看到任何显示字体的问题。

我是否需要使用 webfonts API 手动告诉页面以某种方式重绘？这似乎有点矫枉过正，所以也许我错过了什么？

我按如下方式加载字体：

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>New Web Project</title>
    <link href='http://fonts.googleapis.com/css?family=Dosis:300,400,500' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script type="text/javascript" src="script.js"></script>
    <link rel="stylesheet" type="text/css" href="css.css" />
</head> 
```

我在一个单独的 CSS 文件中定义了一些样式，然后在我的页面正文中使用这些样式。

```
.defaultHeading {
font-family: 'Dosis', sans-serif; 
font-size:36px; 
color:#a02422; 
font-weight:500; 
line-height:36px 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:40:39.857

好的，我通过在 CSS 中指定以下内容解决了所有问题

```
@media only screen and (max-device-width: 480px) {      
    #main { -webkit-text-size-adjust:100% }               
} 
```

这会阻止 Safari 在 iPhone 上调整字体大小。

# database - Oracle SID 和服务名称；连接问题

> ID：13691628
> 
> 赞同：7
> 
> 时间：2012-12-03T21:01:26.707
> 
> 标签：database, linux, oracle, oracle11g

我正在尝试通过 sql developer 连接到远程服务器上的 oracle db。我将连接详细信息复制到 tnsnames 并且能够连接到数据库。

但是我有另一个与 sqldeveloper 相同的数据库应用程序，当我尝试建立连接时，我不断收到此错误。此应用程序使用需要主机名和 SID 的 oracle jdbc 瘦客户端。

我收到以下错误：

java.sql.SQLException：侦听器拒绝连接并出现以下错误：ORA-12505，TNS：侦听器当前不知道连接描述符中给出的 SID

在进行故障排除时，我更改了 sqldeveloper 中的 tns 选项，并选择了基本选项以找出问题所在，我意识到由于服务名称正确，我能够连接到它，但无法通过 SID 连接到 db甚至通过 sqldeveloper 命名。

我使用了一些数据库查询来找出 SID 名称，但我仍然收到相同的错误。请帮我解决问题。

谢谢你的时间..

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-03T21:10:04.090

ORA-12505 表示您的客户端传递了一个服务器端的侦听器根本无法识别的 SID。

在 10G 及以上你可以使用 EZ connect 而不需要像这样配置服务器端：

```
sqlplus hr@liverpool:1521/DEMO

hr is the user name
liverpool is the server name
1521 is the port the listener for the DB is listening on
DEMO is the database SID 
```

（或者）

如果您仍想使用 tnsnames.ora，请尝试从您的客户端运行 tnsping SID。

在 LINUX 上，您还可以让 ORACLE 从本地路径读取 tnsnames.ora 文件 - 只需将 TNS_ADMIN 设置为 tnsnames.ora 文件所在的目录。

否则，需要在客户端的 $ORACLE_HOME/network/admin 中配置 tnsnames.ora

* * *

如果您需要知道数据库 SID，请使用以下命令：

从对偶中选择 sys_context('userenv','db_name')；

请参阅此网址：

[检查 oracle sid 和数据库名称](https://stackoverflow.com/questions/6288122/checking-oracle-sid-and-database-name)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-08T12:32:37.220

我也面临这个问题。带有甲骨文的 Linux`11.2.0.1.`

我发现连接字符串必须是：

```
sqlplus hr@liverpool:1521:DEMO 
```

并不是

```
sqlplus hr@liverpool:1521/DEMO 
```

# jquery - 如果它们仍然具有特殊属性，则循环遍历所有元素（动态驱动的内容）

> ID：13691630
> 
> 赞同：1
> 
> 时间：2012-12-03T21:01:32.427
> 
> 标签：jquery, attr

我需要的东西（使用 Jquery 的问题）是遍历我的 ul 中的所有元素（动态驱动的内容），如果它们仍然具有这种特殊的属性 pl_id（值可能会有所不同）

如果这个 ul 中的所有元素仍然包含该属性，那么按钮仍然需要就位。如果添加了一个元素，则按钮必须消失......我很困惑如何处理这个问题。

```
<ul id="tracks"> 
<li pl_id="14" class="item" id="5" ytid="SnA52s7qceM" artist="Michael Bublé" albname="Christmas" track="Santa Claus Is Coming to Town" cdnr="1" trnr="2" length2="02:51"></li> 
<li class="item" id="1" ytid="8OsgqpnuizY" artist="Michael Bublé" albname="Christmas" track="White Christmas" cdnr="1" trnr="4" length2="03:37"></li>
</ul> 
```

所以在这种情况下，第二个 li 没有 pl_id attr。所以我的喜欢按钮（或任何功能）需要消失。只要此 ul 中的所有 li 都具有此属性，按钮就需要在那里！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:10:36.777

从理论上讲，以下代码可能会对您有所帮助：

```
$("#buttonID").toggle($("ul > li").filter(function() {
    return !this.hasAttribute("pl_id");
}).length === 0); 
```

**演示：http:** [//jsfiddle.net/HBbk3/](http://jsfiddle.net/HBbk3/)

# html - 创建可能会或可能不会迁移到 Wordpress 的 HTML 5 网站的最佳实践是什么

> ID：13691632
> 
> 赞同：0
> 
> 时间：2012-12-03T21:01:39.110
> 
> 标签：html, css, web, wordpress-theming

要点：我被委托为一个应用程序创建一个网站。该网站或多或少是静态的，并且与数据库的交互非常少。它基本上用于提供信息的目的，也允许用户为 iPad 应用购买虚拟物品。该网站可能会或可能不会迁移到 Wordpress。

问题： 1.鉴于上述情况，继续前进的最佳实践是什么，以保持网站的灵活性。

1.  我是否说通过创建新的 Wordpress 主题迁移可以很容易，尤其是静态页面？

2.  网站应该花多少时间（只是给我一个大概）？

这是我的第一个网站，我真的希望它很好，尤其是因为正在开发的 iPad 应用程序看起来非常棒。万分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:10:25.853

这绝对不是一个剪切和粘贴的工作。Wordpress 的预期用途是提供动态内容，并且大量“模板化”。

您可以轻松创建静态页面，但如果没有大量的肘部油脂，它们可能与您的主题不符。

基本上你必须决定是将你的内容塞进一个主题，还是围绕你的内容创建一个主题。我强烈建议从 wordpress 和特定主题开始，然后从那里进行自定义。这是阻力最小的路径。

这需要多长时间很难说。取决于内容的数量和复杂程度。还有你对 HTML+CSS 和 wordpress 的技能和熟悉程度。我不会低估这项任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:05:45.447

苹果和橙子，我害怕。与任何 CMS 页眉一样，导航和页脚通常使用模板系统生成。在静态站点中没有这样的等价物。

# image - 图像根据浏览器移动

> ID：13691637
> 
> 赞同：1
> 
> 时间：2012-12-03T21:02:03.913
> 
> 标签：image

这让我发疯，我是 100% 你们以前都看过。因此，我认为我犯了一个基本错误，但找不到其他帖子。

我有一个小图像，它位于不同的位置，具体取决于您使用的浏览器。我正在测试的两个浏览器是 Chrome 和 IE。

这是代码：

```
#stu_outer_hot3 {
position: relative;
top: 389px;
left: 320px;
}
#stu_hot3
position:absolute;
left: 0px;
height: 96px;
width: 84px;
} 
```

这是页面：[http ://www.rigol-uk.co.uk/category/products3/digital-oscilloscopes/](http://www.rigol-uk.co.uk/category/products3/digital-oscilloscopes/)

图像是黄色的 HOT 三角形。

任何指针都会有很大帮助！

提前致谢！斯图尔特

# ruby-on-rails - form_for @item.subitem.new

> ID：13691638
> 
> 赞同：0
> 
> 时间：2012-12-03T21:02:05.267
> 
> 标签：ruby-on-rails

我有这个表格用于上传图片。

```
<%= form_for Picture.new do |f| %>
    <%= f.label :file, "Upload Pictures: " %>
    <%= f.file_field :file, multiple: true, name: "picture[file]" %>
    <%= f.submit %>
<% end %> 
```

我现在试图在这个模型和另一个名为 Item 的模型（Item 有很多图片）之间建立一个 has_many 连接，并为这两个模型设置一个表单。

我想我所要做的就是这样的：

```
<%= form_for(@item) do |f| %>

  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :keywords %><br />
    <%= f.text_field :keywords %>
  </div>

  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>

 # and here goes the same form, just @item.pictures.new instead of Picture.new

<%= form_for(@item.pictures.new) do |f| %>
    <%= f.label :file, "Upload Pictures: " %>
    <%= f.file_field :file, multiple: true, name: "picture[file]" %>
    <%= f.submit %>
<% end %> 
```

但是当我提交图像时使用此表单 - 它不会将 item_id 分配给图片。（我确实正确编写了 has_many 和 belongs_to ）。

我需要手动传递 item_id 吗？（不要认为这是个好主意，因为我需要确保他们没有尝试将图片上传到他们不拥有的某些物品）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T23:55:49.120

以防万一有人好奇-我通过将 item_id 传递给图片来解决它，如下所示：

```
<%= form_for Picture.new do |f| %>
    <%= f.label :file, "Upload Pictures: " %>
    <%= f.hidden_field :item_id, :value => @item.id %>
    <%= f.file_field :file, multiple: true, name: "picture[file]" %>
    <%= f.submit %>
<% end %> 
```

并确保在图片模型中 current_user 拥有具有此 ID 的项目。

# html - 垂直菜单栏出现故障

> ID：13691641
> 
> 赞同：1
> 
> 时间：2012-12-03T21:02:08.047
> 
> 标签：html, css, html-lists

我正在尝试为大学网站创建垂直菜单栏。我在实现子级别列表的显示时遇到问题。我当前的代码产生了非常奇怪的结果。我该如何纠正？

HTML 代码：

```
 <div class="nav">
        <ul class="top-level">
            <li><a href="#">EME Alumni</a></li>
            <li>
                <a href="#">Alumni Reunion 2012</a>
                <ul class="sub-level">
                    <li><a href="#">RSVP</a></li>
                    <li><a href="#">Organizing Team</a></li>
                </ul>
            </li>
            <li>
                <a href="#">Alumni Reunion 2012</a>
                <ul class="sub-level">
                    <li><a href="#">RSVP</a></li>
                    <li><a href="#">Organizing Team</a></li>
                </ul>
            </li>
        </ul>
    </div>​ 
```

CSS是：

```
 .nav {
margin: 3%;
width: 225px;
float: left;
}
.nav ul{list-style: none;margin:0;}
.nav a {
    float: left;
    list-style: none;
    display:block;
    text-decoration: none;
    font-size: 1.25em;
    color: #696969;
    padding: 10px;
    width: 225px;
    position: relative;
    background: -webkit-gradient(linear, left top, left bottom, from(#A9A9A9),     to(#C0C0C0));
    }
    .nav a:hover {background: -webkit-gradient(linear, left top, left bottom,   from(#C0C0C0), to(#A9A9A9));}
    ul.sub-level {
        margin-left: 110%;
        display:none;
     } 
     li:hover .sub-level {
          display: block;
     } 
```

​</p>

[这是 jsfiddle 演示的链接](http://jsfiddle.net/BhSx5/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:14:07.387

您需要对子菜单进行绝对定位，因此其父级需要相对定位：

```
.nav li {position:relative}

ul.sub-level { 
    display:none;
    position:absolute;
    left:250px;
    top:0;
} 
```

你不需要浮动你的`A`-tag，也不需要`position:relative`它，因为它没有孩子。

# java - 获取知道索引的集合元素？

> ID：13691643
> 
> 赞同：4
> 
> 时间：2012-12-03T21:02:12.150
> 
> 标签：java, collections

> **可能重复：**
> [按索引从集合中获取价值的最佳方式](https://stackoverflow.com/questions/1047957/best-way-to-get-value-from-collection-by-index)

说我有一个[`Collection`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Collection.html). 我需要在索引 2 处获取元素。

如果没有 get 方法并且迭代器不跟踪索引，我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-03T21:03:57.770

首先尝试利用实际的实现。如果它是一个`List`你可以沮丧并使用更好的API：

```
if(collection instanceof List) {
  ((List<Foo>)collection).get(1);
} 
```

但是“*纯*”解决方案是创建一个`Iterator`并调用`next()`两次。这是您拥有的唯一通用界面：

```
Iterator<Foo> fooIter = collection.iterator();
fooIter.next();
Foo second = fooIter.next(); 
```

这可以很容易地推广到第 k 个元素。但不要打扰，已经有一种方法：[`Iterators.html#get(Iterator, int)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterators.html#get%28java.util.Iterator,%20int%29)在番石榴中：

```
Iterators.get(collection.iterator(), 1); 
```

...或与[`Iterables.html#get(Iterable, int)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterables.html#get%28java.lang.Iterable,%20int%29)：

```
Iterables.get(collection, 1); 
```

如果您需要多次执行此操作，则在以下位置创建集合的副本可能会更便宜`ArrayList`：

```
ArrayList<Foo> copy = new ArrayList<Foo>(collection);
copy.get(1); //second 
```

# perl - Starman and MovableType 5.2

> ID：13691650
> 
> 赞同：2
> 
> 时间：2012-12-03T21:02:44.923
> 
> 标签：perl, amazon-ec2, movabletype, psgi, starman

MovableType 5.2 has builtin PSGI support (via a mt.psgi in the main directory) and I've been trying to take advantage of it using starman/plackup.

Starman w/ MT fires up, but I get odd Not Founds and a silent hang & fail when I run mt-upgrade.cgi.

How I am running starman:

```
cd /home/ec2-user/mysite/perl/components/movabletype
plackup -s Starman --port 8045 --error-log /home/ec2-user/mysite/perl/logs/starman.log --pid /home/ec2-user/mysite/perl/var/starman.pid -a mt.psgi 
```

Mystery 1: My browser returns "Not Found" for index.html, but mt-static and mt.cgi is reachable.

```
X http://mysite:8045/mt/index.html ... Not Found 
✓ http://mysite:8045/mt-static ... listing of static assets 
✓ http://mysite:8045/mt/mt.cgi ... redirects to ... 
X http://mysite:8045/mt/mt-upgrade.cgi?__mode=install ... fails 
```

Mystery 2: Due to the redirect I believe that MT code is running. But it is mostly silent in the starman log even though I have tried different MT debug options. Worse, the mt-upgrade.cgi seems to be reached then fails with this lone message to the starman log:

```
[mypid] Bootstrap CGI script in non-buffering mode: /home/ec2-user/mysite/perl/components/movabletype/mt-upgrade.cgi 
```

This non-buffering message seems informational and normal, and is coming from the MT codebase.

I have also run directly under starman and get the same result.

Any ideas or help would be appreciated!

System/Environment:

```
MT_HOME='/home/ec2-user/mysite/perl/components/movabletype'

linux AMI on an amazon ec2.

perl-5.16.0 under perlbrew. 
```

CPAN modules:

```
cpanm starman
cpanm CGI::PSGI
cpanm CGI::Parse::PSGI
cpanm CGI::Compile
yum install expat-devel
cpanm XML::Parser
cpanm SOAP::Lite
cpanm SOAP::Transport::HTTP
cpanm XMLRPC::Transport::HTTP::Plack
cpanm DBI
sudo yum install postgresql9-devel
cpanm DBD::Pg
cpanm Task::Plack 
```

MT config:

```
CGIPath    http://mysite:8045/mt

StaticWebPath    http://mysite:8045/mt-static

PIDFilePath /home/ec2-user/mysite/perl/var/starman.pid

DebugMode 1

ObjectDriver DBI::postgres
Database db
DBUser dbuser
DBPassword dbpass
DBHost dbhost.mysite 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T05:46:25.977

我是 Movable Type 的首席工程师 Yuji Takayama。我确实尝试重现您的步骤，但我无法重现这一点。（这意味着我得到了初始安装屏幕）

那么，你可以试试mysql吗？你也可以试试“工具/升级”脚本吗？我认为当发生某些错误时您会收到错误消息。

例如）cd MT_HOME；perl -Ilib -Iextlib 工具/升级 --username --password --nickname --email --preferred_language --site_name --site_url --site_path --site_theme --site_timezone

而且，我有关于“找不到 index.html”的答案。

原因：MT永远不会像mt_static一样将MT_HOME挂载为静态文件目录，因为我们认为MT_HOME一定不可能列出来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:28:52.570

如果您尝试在 Starman 下运行 Movable Type，我强烈建议您使用您选择的命令行等效项来运行 Movable Type 附带的升级脚本。没有充分的理由让 mt-upgrade.cgi 以 Starman 和 Plack 所允许的方式持久化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T23:33:51.323

Try to change your paths in mt-config.cgi to relative paths, not URLs. Like so:

```
CGIPath /mt/
StaticWebPath /mt-static/ 
```

Just curious: although it does work now, are you aware that PG isn't supported and that you're taking a risk that a future version of MT might break with it?

P.S. also don't forget the PIDFilePath directive mentioned in [the documentation](https://github.com/movabletype/Documentation/wiki/En-dev-bootstrap-mt-psgi).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T09:36:43.203

顺便说一句，404`http://mysite:8045/mt/index.html`看起来很正常。您的站点索引不应该与 MT 处于同一级别（您可以，但这不是推荐的设置，并且它不适用于假设 MT 和生成的站点明显分开的库存 MT 安装）。

# jquery - jquery 手风琴输入[文本] Firefox 上的 maxlength 错误更新，请确认

> ID：13691652
> 
> 赞同：0
> 
> 时间：2012-12-03T21:02:46.690
> 
> 标签：jquery, firefox, jquery-ui-accordion

当我在两个面板中使用手风琴功能并尝试通过在其他面板中使用 js 函数来设置输入字段的 maxlength 时，在 mozilla Firefox 中的 maxlength 值会发生变化（我通过 firebug 检查）但是它不会在字段上发生变化（你不能编辑）。

```
It works fine for chrome but not Firefox. Is this a real bug and what is the solution? 
```

您可以详细查看该错误：http: [//jsfiddle.net/Jc3uc/1/](http://jsfiddle.net/Jc3uc/1/)

要查看错误：在开始时，maxlength 设置为 4。当您打开第二个选项卡并单击旨在将其设置为 45 的链接时。但是 maxlength 值会更改，但您无法编辑该字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:30:44.477

是的，它看起来确实是 jQuery 和 firefox 以及其他一些浏览器的一个怪癖。

解决它的一种方法是用新元素替换元素：

```
function xy(txv) {
    $('#tx2').replaceWith('<input id="tx2" type="text" size="35" name="txl"  maxlength="45" >').val(txv.test);
    $('#tx1').html('Email:')
} 
```

[http://jsfiddle.net/QrzjU/](http://jsfiddle.net/QrzjU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T10:57:15.350

我向[http://bugs.jqueryui.com/ticket/8879](http://bugs.jqueryui.com/ticket/8879)报告了同样的问题。。似乎是使用Firefox4出现的情况，暂时没有解决方案。由于它是由于 Firefox 中的错误，请检查[https://bugzilla.mozilla.org/show_bug.cgi?id=818270](https://bugzilla.mozilla.org/show_bug.cgi?id=818270)

使用手风琴时要注意这种情况

# excel - Grabbing data from all sheets in given directory

> ID：13691655
> 
> 赞同：1
> 
> 时间：2012-12-03T21:02:56.580
> 
> 标签：excel, vba

I am trying to create a macro that will grab information from all sheets in all workbook(s) located in a specific directory. I am a VBA newbie, so I'm basically limited to what I can copy or modify with extremely limited programming knowledge. I have been trying to modify the macro I got off a website below.

How would I modify the SearchValue line to filter any date in general? Would I have to create a new variable? Also, how would modify the ShName line to scan every single sheet in the workbooks?

```
Sub ConsolidateErrors()
Dim MyPath As String, FilesInPath As String
Dim MyFiles() As String
Dim SourceRcount As Long, FNum As Long
Dim mybook As Workbook, BaseWks As Worksheet
Dim sourceRange As Range, destrange As Range
Dim rnum As Long, CalcMode As Long
Dim rng As Range, SearchValue As String
Dim FilterField As Integer, RangeAddress As String
Dim ShName As Variant, RwCount As Long

MyPath = "C:\Documents and Settings\user\Desktop\New Folder"
ShName = 1
RangeAddress = Range("A1:N" & Rows.Count).Address
FilterField = 1
SearchValue = "10/21/2010"

If Right(MyPath, 1) <> "\" Then
    MyPath = MyPath & "\"
End If

FilesInPath = Dir(MyPath & "*.xl*")
If FilesInPath = "" Then
    MsgBox "No files found"
    Exit Sub
End If

FNum = 0
Do While FilesInPath <> ""
    FNum = FNum + 1
    ReDim Preserve MyFiles(1 To FNum)
    MyFiles(FNum) = FilesInPath
    FilesInPath = Dir()
Loop

With Application
    CalcMode = .Calculation
    .Calculation = xlCalculationManual
    .ScreenUpdating = False
    .EnableEvents = False
End With

Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)
rnum = 1

If FNum > 0 Then
    For FNum = LBound(MyFiles) To UBound(MyFiles)
        Set mybook = Nothing
        On Error Resume Next
        Set mybook = Workbooks.Open(MyPath & MyFiles(FNum))
        On Error GoTo 0

        If Not mybook Is Nothing Then

            On Error Resume Next
            With mybook.Worksheets(ShName)
                Set sourceRange = .Range(RangeAddress)
            End With

            If Err.Number > 0 Then
                Err.Clear
                Set sourceRange = Nothing
            End If
            On Error GoTo 0

            If Not sourceRange Is Nothing Then
                rnum = RDB_Last(1, BaseWks.Cells) + 1

                With sourceRange.Parent
                    Set rng = Nothing

                    .AutoFilterMode = False

                    sourceRange.AutoFilter Field:=FilterField, _
                                           Criteria1:=SearchValue

                    With .AutoFilter.Range

                        RwCount = .Columns(1).Cells. _
                                  SpecialCells(xlCellTypeVisible).Cells.Count - 1

                        If RwCount = 0 Then
                        Else
                            Set rng = .Resize(.Rows.Count - 1, .Columns.Count). _
                                      Offset(1, 0).SpecialCells(xlCellTypeVisible)

                            If rnum + RwCount < BaseWks.Rows.Count Then

                                rng.Copy BaseWks.Cells(rnum, "A")
                            End If
                        End If

                    End With

                    .AutoFilterMode = False

                End With
            End If

            mybook.Close savechanges:=False
        End If

    Next FNum

    BaseWks.Columns.AutoFit
    MsgBox "Look at the merge results in the new workbook after you click on OK"
End If

With Application
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculation = CalcMode
End With 
```

End Sub

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:13:01.897

您可以在代码运行时使用 InputBox() 方法从用户那里获取数据。这是一个简单的例子：

```
Option Explicit

Sub test()
    Dim SearchValue As String

    SearchValue = InputBox("Enter Date", "Date, please")

    If (SearchValue = "") Then Exit Sub ' case when "Cancel" or nothing is entered

    If (IsDate(SearchValue) = False) Then
        MsgBox "Sorry, that is not a valid date."
        Exit Sub
    End If

    ' Do other stuff
End Sub 
```

以下是来自 Microsoft 的一些文档：

[http://msdn.microsoft.com/en-us/library/office/aa195768(v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/office/aa195768(v=office.11).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:23:58.693

回答你的第二个问题`Also, how would modify the ShName line to scan every single sheet in the workbooks?`

试试这个语法...

```
Dim wks as Worksheet 

For each wks in myBook.Worksheets

    'run code here

Next 
```

您的上述代码需要进行一些调整，以确保它每次都引用正确的工作表等，但该`wks`变量将有很大帮助。

# html - dont change iframe source when click on F5(refresh)

> ID：13691666
> 
> 赞同：2
> 
> 时间：2012-12-03T21:03:37.627
> 
> 标签：html, iframe

i have an iframe that supposed to show me the pages according to the links.

the iframe code is :

```
<iframe width=940px onload=reSize() src="src/HEB/registerHEB.html" id="ifrm" name="iframe_main" frameborder="0" scrolling="no"></iframe> 
```

i want to do that when i click on link such as this one

```
<a href="html/guides.html" target="iframe_main"> 
```

it will open the page in the iframe, but when i click F5 (refresh) it won't load the original src of the iframe, but the last link ive clicked.

Thank you very much.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T09:21:28.977

在 iframe 之后使用此脚本，如下所示：

```
<iframe src="src/HEB/registerHEB.html" id="ifrm" ......></iframe>
<script>
document.getElementById("ifrm").src = 'src/HEB/registerHEB.html'; 
</script> 
```

# ember.js - {{action}} 与使用关系 ID 的 transitionTo 链接

> ID：13691667
> 
> 赞同：5
> 
> 时间：2012-12-03T21:03:38.027
> 
> 标签：ember.js

给定一个具有类似上下文的视图`{ id: 1, form_id: 5}`，我想`{{action}}`使用`form_id`.

我的视图代码如下所示：

```
<script type="text/x-handlebars" data-template-name="group">
  {{action showForm form_id href=true}}
</script> 
```

我的路由器中的操作如下所示：

```
showForm: function(router, event) {
  var form_id = event.context;
  router.transitionTo('root.form', { id: form_id });
}, 
```

我收到一条错误消息：

```
Uncaught Error: assertion failed: You must specify a target state for event 'showForm' in order to link to it in the current state 'root.index'. 
```

我猜问题出在我为 设置上下文的方式上`transitionTo`，但我一直无法找出正确的解决方案。

这是重现问题的完整代码：

```
<script type="text/x-handlebars" data-template-name="application">
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="group">
  {{action showForm form_id href=true}}
</script>

MyApp = Ember.Application.create({
  autoinit: false
});

MyApp.router = Ember.Router.create({
  root: Ember.Route.extend({
    index: Ember.Route.extend({
      route: '/',

      // Throws error: 
      //    You must specify a target state for event 'showForm' in 
      //    order to link to it in the current state 'root.index'
      //
      showForm: function(router, event) {
        var form_id = event.context;
        router.transitionTo('root.form', { id: form_id });
      },

      // Won't work because form deserialize finds id, not form_id 
      //showForm: Em.Route.transitionTo('root.form'),

      // This won't work either
      // showForm: Em.Route.transitionTo('root.form', { id: this.form_id }),        

      connectOutlets: function( router, context ){
        var group = Em.Object.create({ id:1, form_id: 5 });
        router.get( 'applicationController' ).connectOutlet( 'group', group );
      }
    }),
    form: Ember.Route.extend({
      route: '/form/:id',
      serialize: function( router, context ){
        return { id: context.id }
      },
      deserialize: function( router, context ){
        var form = Em.Object.create({ id: 5, name: 'my form' });
        return MyApp.Form.find( context.id );
      },
      connectOutlets: function( router, context ){
        // left out for fiddle example 
      }
    })
  })
});

MyApp.ApplicationController = Ember.Controller.extend({});

MyApp.GroupController = Em.ObjectController.extend({});
MyApp.GroupView = Em.View.extend({ templateName:  'group' });

MyApp.initialize(MyApp.router);​ 
```

和相应的小提琴：

[http://jsfiddle.net/jefflab/LJGCz/](http://jsfiddle.net/jefflab/LJGCz/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T00:54:15.663

使用计算属性作为我的操作的上下文，我能够想出一个丑陋的解决方案来解决这个问题。关键片段是：

```
<script type="text/x-handlebars" data-template-name="group">
  <a {{action showForm view.formHash href=true}}>go to form</a>
</script>

MyApp.GroupView = Em.View.extend({ 
  templateName:  'group',
  formHash: function() {
    return { id: this.get('controller').get('form_id') };
  }.property('form_id')
}); 
```

工作小提琴在这里：

[http://jsfiddle.net/jefflab/pGv8u/](http://jsfiddle.net/jefflab/pGv8u/)

但是，在与 Tom Dale 交谈之后，很明显解决这个问题的“正确方法”是使用物化对象而不是 id 值。如果您使用的是 Ember 数据，这是“侧载”belongsTo 功能的一个很好的用例。

# objective-c - IOS5：如何从视图导航到标签栏控制器

> ID：13691672
> 
> 赞同：0
> 
> 时间：2012-12-03T21:03:59.717
> 
> 标签：objective-c, ios5, xcode4

我正在开发一个应用程序，我必须在其中对用户进行身份验证（在具有用户名和密码的两个文本字段以及一个按钮（登录）的视图中），然后我必须导航到选项卡栏控制器。你能告诉我我怎么能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:10:56.907

构建您的登录视图控制器和标签栏视图控制器

现在让你的第一个视图是登录视图控制器；登录成功后，您可以使 [loginviewController presentModelViewController:tab-barControler]

或者您可以将导航控制器添加到您的登录视图控制器，一旦登录成功，您可以推送标签栏控制器并将导航栏设置为隐藏

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T01:56:11.537

我认为处理这些登录屏幕情况的最佳方法是将标签栏控制器作为窗口的根视图控制器，并在第一个标签的控制器中，从 viewDidLoad 方法模态显示您的登录控制器。在您的登录控制器中，如果登录成功，只需关闭登录控制器，您将返回到第一个选项卡的视图。如果不成功，只需向用户显示登录失败的一些信息，然后让登录屏幕保持打开状态（或允许重试，无论您想要什么）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T07:17:43.160

您需要像这样推送要在其上显示 tabbarController 的 viewController

```
[self.navigationController pushViewController:self.tabBarController animated:YES]; 
```

这`self.tabBarController`是您想要在 nextView 控制器上显示的所需的 tabBarController。

您需要使用 tabBarController 而不是`UIViewController`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:07:43.973

使用您的登录内容创建一个视图，然后在成功登录后，使用您的标签栏控制器转换到一个视图。

# c# - Application process after msi installer finished is started as SYSTEM user name which sometimes can not create com object

> ID：13691676
> 
> 赞同：2
> 
> 时间：2012-12-03T21:04:11.403
> 
> 标签：c#, windows, visual-studio-2010, windows-installer, setup-project

I have a visual studio installer project which installs a C# app, I have a custom action and code to run the process after install is complete.

Let's say the logged in user on windows machine is "john". Now when john runs the msi installer, I check the process in the taskmanager and it shows that msiexec.exe is the process name for installer and it is running as user "john"

The installer completes and runs the install app's process myapp.exe now when I check this process in taskmanager of windows it shows that myapp.exe is running as SYSTEM (which I do know what account is that and why its not running as john)

**Problem** When myapp.exe runs as SYSTEM user it can not create com component instance of a component (iTunes in my case) which was already running as user john. If the component was not running then creating isntance of the iTunes is sucessful, otherwise it fails.

**Question** So is it possible to make sure when installer runs as john, when it finishes it starts process myapp.exe as john and not as SYSTEM user ? Note that I do not asks user for password during installer.

Code that I run when installer completes

```
 // Event handler for 'Committed' event.
    private void MyInstaller_Committed(object sender, InstallEventArgs e)
    {
        try
        {                
            Directory.SetCurrentDirectory(Path.GetDirectoryName
            (Assembly.GetExecutingAssembly().Location));
            Process.Start(Path.GetDirectoryName(
              Assembly.GetExecutingAssembly().Location) + "\\MyApp.exe");
        }
        catch
        {
            // Do nothing... 
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T07:29:22.993

这很可能发生，因为您正在延迟运行自定义操作。即它默认在SYSTEM用户帐户下运行。

一种解决方案是确保立即启动它，例如，您可以使用安装最后一个对话框中的“完成”按钮上的已发布事件来启动它。我不确切知道如何在 VS 设置项目中添加已发布的事件，或者是否可能，但您可以轻松地在使用专门的[设置创作工具](http://www.installsite.org/pages/en/msi/authoring.htm)构建的包中添加一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T10:03:01.220

在 Form_Load 事件中这样写：

> 字符串 lUserName=Environment.GetEnvironmentVariable("USERNAME");

然后，您将在安装 MSI 时获得 Windows 登录用户名，而不是获取系统用户帐户。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-19T22:44:22.410

就我个人而言，我确实设法通过使用`explorer.exe`我的应用程序可执行文件的路径运行参数化来解决这个问题：

```
Process.Start(
    new ProcessStartInfo
    {
        FileName = "explorer.exe",
        Arguments = Context.Parameters["target"],
        UseShellExecute = true
    }); 
```

# matlab - Matlab, assigning an "if statement" within a "loop"

> ID：13691681
> 
> 赞同：1
> 
> 时间：2012-12-03T21:04:40.537
> 
> 标签：matlab, if-statement, for-loop

Matlab code:

```
eminc = 2.5; %the increment of the emission spectra you collected
exinc = 5; %the increment of the excitation spectra you collected
em = 250:eminc:560; %Emission scan
ex = 240:exinc:450; %Excitation scan
A = xlsread(char(Afile));  % Reads in raw EEM file in .xlsx format.
ExTop=[0,ex]; %Recreates the row of excitation wavelengths cut off 
A=[ExTop ; A]; %Adds the excitation wavelengths back into the EEM file
Asize = size(A);

emfind = A(:,1);
emstart = find(emfind == findem(1));
emend = Asize(1);

exfind = A(emstart-1,:);
exstart = find(exfind == findex(1));
exend = Asize(2);

A = A(emstart:emend,exstart:exend);

for A=A(1:125,1:43)
   if emstart<=(ex+10)
       A=0;
        if emstart>=(ex*2+20)
         A=0;
        end
   end
end 
```

Data is intensity of fluorescence from an excitation-emission matrix (size 125x43 matrix), and the Excitation wavelengths and Emission Wavelengths are also attached to the data (size 126x44 matrix)

I want to assign a value of 0 to the data matrix when the emission wavelengths are <= (excitation wavelengths+10) and when the excitation wavelengths are >= (excitation wavelengths*2+20)

I know the for loop and if statements are not right, mostly because I can not figure out how to even call up that area of data within my matrix.

The code is a little bit "verbose" so that if the scan parameters (excitation and emission wavelengths) are changed, they can be assigned and the rest of the code will work regardless.

Any help would be appreciated. Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:26:16.323

另一种方法是我们只是将相关值选择到一个新数组中，例如：

```
[val ind]=find(A > (excitation wavelengths+10) & A< (excitation wavelengths*2+20) ); 
```

# vb.net - how to sort list with strings containing numbers?

> ID：13691682
> 
> 赞同：0
> 
> 时间：2012-12-03T21:04:43.340
> 
> 标签：vb.net, linq, list

I have a Tlist that contains addresses. When I sort the list, numbers in the address are considered a string, and it doesn't sort correctly. How should I sort the list ascending?

```
 Dim sortme As List(Of data) = tempdata 'main list containing addresses as strings.
     sortme.Sort(Function(p1 As data, p2 As data) numorder(p1.Value).CompareTo(numorder(p2.Value)))

       Private Function numorder(ByVal str As String)
        Try
            Dim words() As String = str.Split(" "c) 'read string up to first space (for number)
            Return Convert.ToInt32(words(0))
        Catch ex As Exception
        End Try
    End Function 
```

Example of current output:

```
1001 street name

103 street name

1021 street name 
```

It should be:

```
103 street name

1001 street name

1021 street name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:23:00.780

这个想法是编写你自己的比较器，它将首先考虑数字前缀，然后是字符串本身。然后可以在任何地方使用此比较器，例如在 LINQ 中`OrderBy()`。这里有一个 c# 示例，请参阅下面的完整 VB.NET 版本。

```
 public class StreetComparer : IComparer<string>
    {
        public int Compare(string x, string y)
        {
            int indexOfSpaceX = x.IndexOf(' ');
            string numericalPartX = x.Substring(0, indexOfSpaceX);

            int indexOfSpaceY = y.IndexOf(' ');
            string numericalPartY = y.Substring(0, indexOfSpaceY);

            int numberX;
            int numberY;

            if(!int.TryParse(numericalPartX, out numberX) ||
                !int.TryParse(numericalPartY, out numberY))
            {
                //Some code to handle the case where number is missing
                throw new ArgumentException();
            }

            if (numberX!=numberY)
            {
                return numberX-numberY;
            }

            string textPartX = x.Substring(indexOfSpaceX + 1);
            string textPartY = x.Substring(indexOfSpaceY + 1);

            return String.Compare(textPartX, textPartY, true, CultureInfo.CurrentCulture);

        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var myStreets = new[] {"01 aaa", "02 bbb"};

            var result = myStreets.OrderBy(s => s, new StreetComparer());
        }
    } 
```

现在，一个 VB.NET 版本完全适合您的用例，其中包含按属性排序的类的列表：

```
Public Class StreetComparer
    Implements IComparer(Of String)
    Public Function Compare(x As String, y As String) As Integer
        Dim indexOfSpaceX As Integer = x.IndexOf(" "C)
        Dim numericalPartX As String = x.Substring(0, indexOfSpaceX)

        Dim indexOfSpaceY As Integer = y.IndexOf(" "C)
        Dim numericalPartY As String = y.Substring(0, indexOfSpaceY)

        Dim numberX As Integer
        Dim numberY As Integer

        If Not Integer.TryParse(numericalPartX, numberX) OrElse Not Integer.TryParse(numericalPartY, numberY) Then
            'Some code to handle the case where number is missing
            Throw New ArgumentException()
        End If

        If numberX <> numberY Then
            Return numberX - numberY
        End If

        Dim textPartX As String = x.Substring(indexOfSpaceX + 1)
        Dim textPartY As String = x.Substring(indexOfSpaceY + 1)

        Return [String].Compare(textPartX, textPartY, True, CultureInfo.CurrentCulture)

    End Function
End Class

Public Class Person
    Public Property Value() As String
        Get
            Return m_Value
        End Get
        Set
            m_Value = Value
        End Set
    End Property
    Private m_Value As String

    Public Sub New(value__1 As String)
        Value = value__1
    End Sub
End Class

Class Program
    Private Shared Sub Main(args As String())
        Dim sortme As New List(Of Person)(New () {New Person("1001 street name"), New Person("103 street name"), New Person("1021 street name")})

        Dim result = sortme.OrderBy(Function(p) p.Value, New StreetComparer())

        For Each person As var In result
            Console.WriteLine(person.Value)
        Next
        Console.ReadKey()
    End Sub
End Class 
```

# google-drive-api - 直接网络传输 C#

> ID：13691683
> 
> 赞同：0
> 
> 时间：2012-12-03T21:04:46.127
> 
> 标签：google-drive-api

我只是好奇，是否可以在 C# 中进行直接网络传输，而无需本地缓存。

例如，我有代表 GoogleDrive 文件的响应流和将文件上传到另一个 GoogleDrive 帐户的请求流。

在那一刻，我可以将文件下载到本地电脑，然后将其上传到谷歌驱动器。但是是否可以直接从一个谷歌驱动器上传到另一个，或者至少在完整下载完成之前开始上传。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:07:41.900

是的，您可以使用 Google Drive api 将文件下载到流中并将其保存在内存中，以便您可以在登录后将其上传到另一个 Google Drive 帐户。

您在第一个帐户上获得您的令牌并下载一个将其保存在流中的文件。

然后您在其他谷歌驱动器帐户上进行身份验证并使用流上传文件。

**PS：** 当您在第二个驱动器帐户上插入文件时，不是让 byte[] 数组从磁盘读取文件，而是从内存中的流中获取字节数组。

文件下载示例：

```
public static System.IO.Stream DownloadFile(
      IAuthenticator authenticator, File file) {
    if (!String.IsNullOrEmpty(file.DownloadUrl)) {
      try {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(
            new Uri(file.DownloadUrl));
        authenticator.ApplyAuthenticationToRequest(request);
        HttpWebResponse response = (HttpWebResponse) request.GetResponse();
        if (response.StatusCode == HttpStatusCode.OK) {
          return response.GetResponseStream();
        } else {
          Console.WriteLine(
              "An error occurred: " + response.StatusDescription);
          return null;
        }
      } catch (Exception e) {
        Console.WriteLine("An error occurred: " + e.Message);
        return null;
      }
    } else {
      // The file doesn't have any content stored on Drive.
      return null;
    } 
```

文件插入示例：

```
private static File insertFile(DriveService service, String title, String description, String parentId, String mimeType, String filename) {
    // File's metadata.
    File body = new File();
    body.Title = title;
    body.Description = description;
    body.MimeType = mimeType;

    // Set the parent folder.
    if (!String.IsNullOrEmpty(parentId)) {
      body.Parents = new List<ParentReference>()
          {new ParentReference() {Id = parentId}};
    }

    // File's content.
    byte[] byteArray = System.IO.File.ReadAllBytes(filename);
    MemoryStream stream = new MemoryStream(byteArray);

    try {
      FilesResource.InsertMediaUpload request = service.Files.Insert(body, stream, mimeType);
      request.Upload();

      File file = request.ResponseBody;

      // Uncomment the following line to print the File ID.
      // Console.WriteLine("File ID: " + file.Id);

      return file;
    } catch (Exception e) {
      Console.WriteLine("An error occurred: " + e.Message);
      return null;
    }
  } 
```

# python - Creating a buffer in python to store data before sending it out

> ID：13691684
> 
> 赞同：1
> 
> 时间：2012-12-03T21:04:47.630
> 
> 标签：python, buffer, storage

I receive an mp3 stream in client1 and then I send it out again to client2 in real time.
I want to create a buffer which would store some data and it would only send it out to client2 when it fills completely. This would help me to avoid deadlocks.

I am not sure how to create such a buffer in python. What data structure can I use and how can I implement it? Any hints?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:40:17.530

我认为惯用和 pythonic 的方法之一是使用 a`list`和`.append()`每个缓冲区元素/字符串到列表中。当我完成并且我想要整个缓冲区时，我会`"".join(buffer_list)`得到整个shebang。它像 StringBuilder 一样工作

您还可以查看`StringIO`C 扩展版本。

这个页面有很多关于这个主题的信息：[Python中的高效字符串连接](http://www.skymind.com/~ocrow/python_string/)

# c# - 上传图片访问路径被拒绝

> ID：13691693
> 
> 赞同：0
> 
> 时间：2012-12-03T21:05:20.780
> 
> 标签：c#, asp.net

嗨，我在 asp.net 中上传图片时似乎遇到了问题。当我尝试上传图片时，出现此错误：

> 拒绝访问路径“D:\Projects IDE\Visual Studio\MyWork\Websites\Forum\Images\avatar\userAvatars\aleczandru”。

我已将应用程序池 Identoty 设置为 NETWORKSERVICE 并且还以完全权限将 NETWORK SERVICE 帐户添加到 Images 文件夹，但我仍然遇到相同的错误。

这是我的代码：

```
private void addImageToApp()
{
    string path = "~/Images/avatar/userAvatars/" + User.Identity.Name;

    createPath(path);
    if( Directory.Exists(HostingEnvironment.MapPath(path)))
    {
        //try {
              UploadImage.SaveAs(HostingEnvironment.MapPath(path));
          //    MultiViewIndex.ActiveViewIndex = 0;
        //}catch(Exception ex)
        //{
          //     AvatarDetails.Text = ex.Message;
        //}  
    }
}

private void createPath(string path)
{  
    string activeDir = HostingEnvironment.MapPath("~/Images/avatar/userAvatars");
    if( !Directory.Exists(Server.MapPath(path)) )
    {
        string newPath = Path.Combine(activeDir, User.Identity.Name);
        Directory.CreateDirectory(newPath);
    }
} 
```

我还能做些什么来解决这个问题？

**编辑**

嗨，此时我对以下用户拥有完全的权限控制：

*   认证用户
*   IUSR
*   系统
*   网络服务
*   IIS_WPG
*   行政人员
*   用户

我是否需要为 IIS 设置任何配置才能使其正常工作？

**编辑**

在过去的几天里，为了完成这项工作，我一直在使用 SQL-SERVER，所以我可能错误地配置了一些我理解的网络服务存储在 SQL-SERVER master.db 数据库中的东西。我似乎有两个网络服务登录可能是这个问题吗？我记得当我第一次检查它时我没有现在我有两个：

![在此处输入图像描述](../Images/7a4f5d94ecff519d20e34042721b338f.png)

**编辑**

这是我添加到文件夹的权限的打印：

![在此处输入图像描述](../Images/0a5c3412fe5d9a49986bdc8e345e29d0.png)

**编辑：完全错误**

![在此处输入图像描述](../Images/6476bd5924091f1b56c6242bc7e41558.png)

堆栈跟踪：

![在此处输入图像描述](../Images/e8d5239a1e2da2f076db403071b9139f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T15:51:54.487

在方法`CreatePath`中，您正在创建文件夹“D:\Projects IDE\Visual Studio\MyWork\Websites\Forum\Images\avatar\userAvatars\aleczandru”。

然后，您尝试使用文件名“D:\Projects IDE\Visual Studio\MyWork\Websites\Forum\Images\avatar\userAvatars\aleczandru”保存上传的图像。

您不能拥有同名的文件夹和文件。如果您尝试这样做，操作系统会告诉您访问被拒绝。

![如果您在命令提示符下尝试此操作会发生什么](../Images/c75a26006b29411762a0a92fe56ead1c.png)

我想您想在文件夹中创建一个文件名`aleczandru`，或者您打算将文件另存为`aleczandru.png`或文件夹中的某些内容`userAvatars`。

假设您`UploadImage`是一个[FileUpload](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.aspx)控件，您可以使用上传文件的原始文件名将文件保存到用户的文件夹中。

```
UploadImage.SaveAs(HostingEnvironment.MapPath(
    Path.Combine(path, UploadImage.FileName))); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-11T13:28:53.013

请确保您的路径中有完整的文件名和文件扩展名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T23:07:33.857

好的...我之前已经为一个项目完成了此操作，以实现 http 的 PUT 方法。我不记得很清楚了..但是一些提示...如果我在办公室，我可以正确地告诉您。这是提示

1.  您需要添加 IIS_IUSRS 才能访问 Windows 中的文件夹。
2.  转到 IIS 管理控制台，单击已部署的站点节点，然后为进来的相同文件夹/网站请求设置权限...我不记得是哪个类别了..该设置窗格将允许您添加/修改 POST 的权限, GET 和其他动词……当你编辑它时，你应该看到管理员、特定用户帐户、匿名等选项。

可能我明天会回信……具体怎么做:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:07:20.910

尝试赋予名为 users 的组修改此目录的权限（在安全性下）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T21:13:25.833

您需要找出运行 asp.net 上传页面的用户。如果您没有更改它，并且没有在模拟下运行，它应该默认为本地计算机上的 ASPNET 用户。无论结果如何，都应授予该用户对该文件夹的读/写权限。

# jquery - tinyMCE 和 jQuery 对话框问题

> ID：13691695
> 
> 赞同：1
> 
> 时间：2012-12-03T21:05:32.530
> 
> 标签：jquery, tinymce

我在 jQuery 对话框中使用 TinyMCE。为了让编辑器工作，我必须将模式从“textareas”设置为“none”。但是，这样做会使工具栏消失。

这显示了工具栏，但实际的编辑窗口不起作用：

```
 tinyMCE.init({
    theme: "advanced",
    mode: "textareas",
    theme_advanced_toolbar_location: "top"
}); 
```

这会导致编辑窗口工作，但缺少工具栏：

```
 tinyMCE.init({
    theme: "advanced",
    mode: "none",
    theme_advanced_toolbar_location: "top"
}); 
```

有没有办法在模式：“无”时恢复工具栏？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T10:27:29.943

您应该使用第二种方法。编辑器不在那里工作，但 textarea 在那里。你还需要做的是使用`mceAddControl`动作初始化编辑器。这是代码和指向[工作 tinymce fiddle](http://fiddle.tinymce.com/7zcaab/1)的链接：

```
<script type="text/javascript">
    tinyMCE.init({
    theme: "advanced",
    mode: "none",
    theme_advanced_toolbar_location: "top"
});
tinymce.execCommand('mceAddControl',false,'textarea_id' );
</script>

<form method="post" action="dump.php">
    <textarea id="textarea_id" name="content"></textarea>
</form> 
```

# eclipse - Eclipse ctrl+Shift+G 未按预期工作

> ID：13691697
> 
> 赞同：4
> 
> 时间：2012-12-03T21:05:38.473
> 
> 标签：eclipse

`Ctrl`++`Shift`用于`G`在我的工作区中的所有项目中查找对当前选择的引用。

现在似乎只返回当前项目中的引用。

详细信息：我在同一个数据库中有 3 个项目。1个项目是通用代码。其他 2 个项目包括构建路径上公共代码的源文件夹。我更喜欢链接到公共源，而不是将公共代码作为项目包含在构建路径上，因为当我通过导出 WAR 进行部署时，每个项目都有自己的公共代码的自包含版本。

但是，当我将公共代码作为项目包含时，++ 似乎可以`Ctrl`工作`Shift`。`G`所以看起来我需要两者都做。我只是不知道为什么搜索结果发生了变化。我确实安装了 JBoss Tools，由于 Jboss 需要安装更新版本的 Indigo。

[类似的问题](http://www.eclipse.org/forums/index.php/mv/msg/366695/892914/#msg_892914)，但没有好的答案。

编辑：
用一个通用类文件打开两个编辑器，一个来自链接的源文件夹，一个用于实际项目文件夹。对链接源执行 ++`Ctrl`时，仅找到包含链接文件夹的项目中的引用。+ +从实际的公共项目中找到对工作区中所有项目的引用，当这些项目在构建路径上引用了公共项目时。问题是当我在一个项目中并且我控制单击一个常用代码方法时，我被带到链接的源类文件。那么当我做一个++`Shift``G``Ctrl``Shift``G``Ctrl``Shift``G`在那个方法上，我错过了引用这个常用方法的所有其他项目，因为编辑器包含来自链接源的文件。这从未使用过这种方式，并用于查找引用此方法的所有项目，无论使用哪个文件（链接的或实际的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-22T14:26:12.550

我找到了命令..它是

```
Ctrl+ALT +G  // search through out workspace 
```

不是

```
Ctrl +shift +G // searching within class/project 
```

**还有一个提示**

`Ctrl+shift+L`查看 Eclipse 中的所有命令

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T14:11:52.953

如果您使用的是 Maven 并且您的版本号不匹配，则可能会发生这种情况。我有一个依赖项目，`<version>1.0.0.RELEASE</version>`它在另一个项目中被引用为`<version>1.0.0-SNAPSHOT</version>`. 修复不匹配以使版本正确允许 CTRL-SHIFT-G 在工作区中找到以前无法找到的引用。

# jsf-2 - 需要一个链接 在 JSF2.0 中

> ID：13691698
> 
> 赞同：0
> 
> 时间：2012-12-03T21:05:39.423
> 
> 标签：jsf-2

```
<h:selectOneRadio id="rating" layout="pageDirection">
     <f:selectItem id="one" itemLabel="Step 1 - "> 
          <h:outputLink>Click here</h:outputLink>
     </f:selectItem>
</h:selectOneRadio> 
```

我需要在每个选项之后都有一个链接`f:selectItem`。我如何实现这一目标？

* * *

我得到一个 JavaScript 错误事件目标值为 null 或不是对象 JavaScript 错误。
无论如何，这就是我要找的。

```
<f:selectItem id="one" itemLabel="Step One" ><h:link>Click Here</h:link></f:selectItem> 
```

它把点击这里不是在第一步旁边，而是在它上面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T10:19:01.470

您可以使用 的`onclick`事件`h:selectOneRadio`将 Web 应用程序的位置更改为值中给出的链接`f:selectItem`

方法如下：

```
<h:form>
    <h:selectOneRadio id="rating" layout="pageDirection" onclick="var target = event.target || event.srcElement; window.location.href = target.value">
         <f:selectItem id="one" itemLabel="CNN" itemValue="http://www.cnn.com"/>
         <f:selectItem id="two" itemLabel="NBC" itemValue="http://www.nbc.com"/>
    </h:selectOneRadio>
</h:form> 
```

# html - 使用 CSS 为列表的每个第三项设置样式？

> ID：13691699
> 
> 赞同：102
> 
> 时间：2012-12-03T21:05:42.263
> 
> 标签：html, css

我可以为每个第三个列表项设置样式吗？

目前在我的`960px`宽 div 中，我有一个向左浮动并显示在 3x3 网格视图中的框列表。他们也有一个 margin-right `30px`，但是因为第 3 个第 6 和第 9 个列表项有这个边距，它使他们跳下一行，使网格显示错误

让 3rd 6th 和 9th 没有margin-right 而不必给他们一个不同的类是多么容易，或者这是唯一的方法吗？

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2012-12-03T21:07:13.433

是的，您可以使用所谓的[`:nth-child`](https://developer.mozilla.org/en-US/docs/CSS/:nth-child)选择器。

在这种情况下，您将使用：

```
li:nth-child(3n) {
// Styling for every third element here.
} 
```

**:nth-child(3n):**

```
3(0) = 0
3(1) = 3
3(2) = 6
3(3) = 9
3(4) = 12 
```

`:nth-child()`在 Chrome、Firefox 和 IE9+ 中兼容。

有关`:nth-child()`在 IE6 到 IE8 中使用其他伪类/属性选择器的解决方法，[请参阅此链接](http://selectivizr.com/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-03T21:07:40.923

您可以为此使用[`:nth-child`](https://developer.mozilla.org/en-US/docs/CSS/:nth-child)选择器

```
li:nth-child(3n) {
 /* your rules here */
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-03T21:07:33.420

试试这个

```
box:nth-child(3n) {  
     ...
} 
```

[**演示**](http://jsfiddle.net/Nwf2A/1/)

[`nth-child`浏览器支持](http://caniuse.com/#search=nth-child)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-04T04:12:04.823

`:nth-child`是您正在寻找的答案。

# php - 通过 fwrite 在 Redactor 中使用 imageGetJson

> ID：13691701
> 
> 赞同：0
> 
> 时间：2012-12-03T21:05:59.410
> 
> 标签：php, json

基本上我想要完成的是使用具有以下功能的编辑器编辑器从文件夹中获取上传图像的列表：imageGetJson

我已经设法让 fwrite 在我的 images.json 文件中添加一个数组。现在的问题是，redactor 需要在输入周围加上括号才能渲染图像。

所以我的问题是如何获得数据周围的括号？

我到目前为止的上传文件是这样的：

```
// This is a simplified example, which doesn't cover security of uploaded images. 
// This example just demonstrate the logic behind the process. 

// files storage folder
$dir = '../img/uploads/';

$_FILES['file']['type'] = strtolower($_FILES['file']['type']);

if ($_FILES['file']['type'] == 'image/png' 
|| $_FILES['file']['type'] == 'image/jpg' 
|| $_FILES['file']['type'] == 'image/gif' 
|| $_FILES['file']['type'] == 'image/jpeg'
|| $_FILES['file']['type'] == 'image/pjpeg')
{   
    // setting file's mysterious name
    $filename = md5(date('YmdHis')).'.jpg';
    $file = $dir.$filename;

    // copying
    copy($_FILES['file']['tmp_name'], $file);

    // displaying file    
    $array = array(
        'filelink' => '/img/uploads/'.$filename,
        'thumb' => '/img/uploads/'.$filename,
        'image' => '/img/uploads/'.$filename,
    );

    echo stripslashes(json_encode($array));

    $json = stripslashes(json_encode($array)), "\n";
    $files = fopen('../img/uploads/images.json','a+');
    fwrite($files, $json . "\n");
    fclose($files);
} 
```

我制作了一个包含文件位置的数组并将其写入文件 images.json

我需要它的样子是这样的

```
[
    {"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
    {"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
    {"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
    {"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
] 
```

只有它像这样添加：

```
[]
{"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
{"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"}
{"filelink":"image.jpg","thumb":"image.jpg","image":"image.jpg"} 
```

希望有人可以帮助我，因为我无法弄清楚。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T10:39:14.937

我找到了另一个解决方案：只需更改 php 文件 data.php 中的 data.json，该文件读取您要列出的目录，然后转换为 json 并回显。

这是我现在使用的（演示版，因为我的贝宝还没有运行）（路径应该根据你的设置设置）

在加载编辑器的页面中：

imageGetJson: 'redactor901trial/demo/json/data.php'

```
$path = 'redactor901trial/demo/json/';
$upload_dir = 'images/';

$handle = opendir($upload_dir);

while ($file = readdir($handle)) {
   if(!is_dir($upload_dir.$file) && !is_link($upload_dir.$file)) {

    $docs[] = $file;
   }
}

sort($docs);

foreach($docs as $key=>$file){
    $array[] = array(
            'filelink' => $path.$upload_dir.$file,
            'thumb' => $path.$upload_dir.$file,
            'image' => $path.$upload_dir.$file,
            'folder' => 'Folder 5'
        ); 
        }   
echo stripslashes(json_encode($array)); 
```

希望这会有所帮助，现在还为时不晚；）

问候

史蒂文

# javascript - 我将使用什么来点击链接并让它在与链接相同的页面上显示信息？

> ID：13691705
> 
> 赞同：0
> 
> 时间：2012-12-03T21:06:29.050
> 
> 标签：javascript, jquery, html

我正在尝试设置我的一个链接，以便在单击它时会显示一些信息。目前，链接和链接中的信息会同时显示。我想先显示链接，然后在单击第一个链接后显示这些链接的信息。

这是我的代码，

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script >
$(document).ready(function($) {
 // First link out of three
 var url = 'https://www.sciencebase.gov/catalog    
/items?parentId=504108e5e4b07a90c5ec62d4&max=60&offset=0&format=jsonp';

$.ajax({
    type: 'GET',
    url: url,
    jsonpCallback: 'getSBJSON',
    contentType: "application/json",
    dataType: 'jsonp',
    success: function(json) {
                 var linkBase = "http://www.sciencebase.gov/catalog/item/";
                 var link = "";

                 $.each(json.items, function(i,item){
                     link = linkBase + this.id
                     $('#sbItems').append('<li><b><a href="' + link + '">' +     
this.title + '</a> - </b>' + this.summary + '</li>');            
                 });

             for (var i = 21; i < 22; i++) {
                     var urlId = json.items[i].id;
             }

                 var itemLnkId =  urlId;
                 //alert(itemLnkId);

                 $.ajax({
                     type: 'GET',
                     url: 'https://www.sciencebase.gov/catalog/itemLink/' + 
itemLnkId + '?format=jsonp',
                     jsonpCallback: 'getSBJSON',
                     contentType: "application/json",
                     dataType: 'jsonp',
                     success: function(json) {
                                  var linkBase = "http://www.sciencebase.gov/
catalog/item/";
                                  var link = "";
                                  $.each(json, function(i,item){
                                      link = linkBase + this.relatedItemId
                                      $('#sbItems').append('<li><a href="' + 
link + '">' + this.title + '</a></li>');            
                                  });

                 for (var i = 19; i < 20; i++) {
                         var urlId = json.items[i].id;
                 }

                     var itemLnkId =  urlId;
                     //alert(itemLnkId);
                     },
                     error: function(e) {
                         console.log(e.message);
                     }
                 });
    },
    error: function(e) {
        console.log(e.message);
    }
});
});
</script>
</head>
<body>
<p><em>This is a simple example of a basic HTML page that uses JQuery to call 
items from ScienceBase in JSON format and output them on the page. It serves 
to show how a basic web application can interact with dynamic ScienceBase 
services. The code points out the one critical feature of such an application, 
the use of a callback method in the Javascript to allow web pages on one domain 
to call and render JSON from another domain (www.sciencebase.gov). The listing 
below comes from a query for items under a particular ScienceBase parent item - 
a set of project records from the USGS National Research Program. The listing 
shows title with a link to the full project record in ScienceBase and summary 
(first part of a full abstract). View source for code examples and inline 
comments.</em></p>

<h3>Projects of the USGS Water National Research Program</h3>

<div class='wrapper'>
<ul id='sbItems'></ul>
</div>
</body>
</html> 
```

这是 jsfiddle 链接[http://jsfiddle.net/XzRFu/](http://jsfiddle.net/XzRFu/) 感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T03:29:43.290

jc72,

试试这个大小 - 根据你的小提琴：

```
<!DOCTYPE html>
<html>
<head>
<style>
body {
    margin: 10px;
}
#programs {
    margin: 12px 0;
    font-family: verdana, arial;
    font-size: 10pt;
}
#programs h2, #programs h3 {
    margin: 5px 0;
    cursor: pointer;
}
#programs ul {
    margin: 5px;
    padding: 10px;
    list-style-type: disc;
}
#programTemplate, #projectTemplate {
    display: none;
}
.summary {
    display: none;
}
.prog .p_loading,
.related .loading {
    display: none;
}
</style>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type='text/javascript'>
$(function(){
    function getData(url) {
        return $.ajax({
            type: 'GET',
            url: url,
            jsonpCallback: 'getSBJSON',
            contentType: "application/json",
            dataType: 'jsonp'
        }).fail(function(jqXHR, textStatus, errorThrown) {
            console.log(textStatus + ' : ' + errorThrown);
        });
    }

    var strings = {
        linkTemplate: 'http://www.sciencebase.gov/catalog/item/%s',
        programUrlTemplate: 'https://www.sciencebase.gov/catalog/items?parentId=%s&max=60&offset=0&format=jsonp',
        urlTemplate: 'https://www.sciencebase.gov/catalog/itemLink/%s?format=jsonp',
        relatedLinkTemplate: '<a href="%s1">%s2</a>'
    };
    var $programTemplate = $("#programTemplate").find(".prog");
    var $projectTemplate = $("#projectTemplate").find(".project");

    function getProjects($program) {
        var $progContainer = $programTemplate.clone().insertAfter($program);
        var $ul = $progContainer.find(".program");
        var url = strings.programUrlTemplate.replace('%s', $program.attr('id'));
        $program.on('click', function() {
            if(!$program.data('served')) {
                $progContainer.show().find(".p_loading").show();
                getData(url).done(function(json) {
                    if(json.items.length) {
                        $.each(json.items, function(i, item) {
                            //if(i !== 21) return true;
                            var $project = $projectTemplate.clone().appendTo($ul);
                            var $title = $project.find(".title").text(item.title).on('click', function() {
                                $project.find(".summary").slideToggle();
                            });
                            $project.find(".text").html(this.summary);
                            //$project.find(".more").attr('href', strings.linkBase + item.id);
                            $project.find(".more").attr('href', strings.linkTemplate.replace('%s',item.id));
                            var $relatedUl = $project.find("ul.relatedLinks");
                            $project.find(".getRelated").on('click', function(e) {
                                var $this = $(this);
                                if(!$this.data('served')) {
                                    $project.find(".loading").show();
                                    getData(strings.urlTemplate.replace('%s', item.id)).done(function(json2) {
                                        if(json2.length) {
                                            $.each(json2, function(j, item2) {
                                                $("<li/>").appendTo($relatedUl).append($(strings.relatedLinkTemplate.replace('%s1', strings.linkBase + item2.relatedItemId).replace('%s2', item2.title)));
                                            });
                                        }
                                        else {
                                            $("<li>None</li>").appendTo($relatedUl);
                                        }
                                        $relatedUl.slideDown('slow');
                                        $project.find(".loading").hide();
                                    });
                                    $this.data('served', true);
                                }
                                else{
                                    $relatedUl.slideToggle('slow');
                                }
                                return false;
                            });
                        });
                    }
                    else {
                        $("<li>None</li>").appendTo($ul);
                    }
                    $ul.slideDown('slow');
                    $progContainer.find(".p_loading").hide();
                });
                $program.data('served', true);
            }
            else {
                $ul.slideToggle('slow');
            }
        });
    }

    $("h2.program").each(function(i, program) {
        getProjects( $(program) );
    });
});
</script>
</head>

<body>

<div id="programTemplate">
    <div class="prog">
        <div class="p_loading">Loading ...</div>
        <ul class="program"></ul>
    </div>
</div>

<ul id="projectTemplate">
    <li class="project">
        <h3 class="title"></h3>
        <div class="summary">
            <div>
                <span class="text"></span>
                <span><a class="more" href="" target="_new">more ...</a></span>
            </div>
            <div>
                <a href="#" class="getRelated">Related links ...</a>
            </div>
            <div class="related">
                <div class="loading">Loading ...</div>
                <ul class="relatedLinks"></ul>
            </div>
        </div>
    </li>
</ul>

<p><em>This is a simple example of a basic HTML page that uses JQuery to call items from ScienceBase in JSON format and output them on the page. It serves to show how a basic web application can interact with dynamic ScienceBase services. The code points out the one critical feature of such an application, the use of a callback method in the Javascript to allow web pages on one domain to call and render JSON from another domain (www.sciencebase.gov). The listing below comes from a query for items under a particular ScienceBase parent item - a set of project records from the USGS National Research Program. The listing shows title with a link to the full project record in ScienceBase and summary (first part of a full abstract). View source for code examples and inline comments.</em></p>

<div id="programs">
    <h2 class="program" id="504108e5e4b07a90c5ec62d4">Projects of the USGS Water National Research Program</h2>
    <!-- add other programs here -->
</div>

</body>
</html> 
```

**[演示](http://jsfiddle.net/gz83a/3/show/)**

它需要使用更好的 CSS 进行美化，但基本功能就在那里。

# f# - 为 F# 增强 Observable.Create

> ID：13691710
> 
> 赞同：1
> 
> 时间：2012-12-03T21:06:49.963
> 
> 标签：f#, system.reactive

我想增强

```
public static IObservable<TSource> Create<TSource>(
    Func<IObserver<TSource>, Action> subscribe)
{...} 
```

为了在 F# 中使用，我可以只使用标准 F# 类型，而不是使用 Function 或 Action 调用，即`IObserver -> (unit -> unit)`.

我怎样才能做到这一点？

编辑：

添加完整示例。不知道为什么`obsAction`不起作用。

```
open System
open System.Reactive
open System.Reactive.Disposables
open System.Reactive.Linq

type Observable with
  static member Create(subscribe) = 
    Observable.Create(fun observer -> Action(subscribe observer))

let obsDispose (observer:IObserver<_>) =
    let timer = new System.Timers.Timer()
    timer.Interval <- 1000.00
    let handlerTick = new Timers.ElapsedEventHandler(fun sender args ->     observer.OnNext("tick"))
    let handlerElapse = new Timers.ElapsedEventHandler(fun sender args -> printfn "%A" args.SignalTime)
    timer.Elapsed.AddHandler(handlerTick)
    timer.Elapsed.AddHandler(handlerElapse)
    timer.Start()
    Disposable.Empty

let obsAction (observer:IObserver<_>) =
    let timer = new System.Timers.Timer()
    timer.Interval <- 1000.00
    let handlerTick = new Timers.ElapsedEventHandler(fun sender args -> observer.OnNext("tick"))
    let handlerElapse = new Timers.ElapsedEventHandler(fun sender args -> printfn "%A" args.SignalTime)
    timer.Elapsed.AddHandler(handlerTick)
    timer.Elapsed.AddHandler(handlerElapse)
    timer.Start()
    let action() =
        timer.Elapsed.RemoveHandler(handlerTick)
        timer.Elapsed.RemoveHandler(handlerElapse)
        timer.Dispose()
    action

let obsOtherAction (observer:IObserver<_>) =
    let timer = new System.Timers.Timer()
    timer.Interval <- 1000.00
    let handlerTick = new Timers.ElapsedEventHandler(fun sender args -> observer.OnNext("tick"))
    let handlerElapse = new Timers.ElapsedEventHandler(fun sender args -> printfn "%A" args.SignalTime)
    timer.Elapsed.AddHandler(handlerTick)
    timer.Elapsed.AddHandler(handlerElapse)
    timer.Start()
    new System.Action( fun () ->
        timer.Elapsed.RemoveHandler(handlerTick)
        timer.Elapsed.RemoveHandler(handlerElapse)
        timer.Dispose())

let worksNeverStops = obsDispose |> Observable.Create |> Observable.subscribe(fun time -> printfn "Time: %A" time)
let actionWorks = obsOtherAction |> Observable.Create |> Observable.subscribe(fun time -> printfn "Time: %A" time)
let doesNotWork = obsAction |> Observable.Create |> Observable.subscribe(fun time -> printfn "Time: %A" time) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:56:31.470

您面临的问题是 FP 陷阱。

在，

```
 static member Create(subscribe) = 
    Observable.Create(fun observer -> Action(subscribe observer)) 
```

的类型`subscribe`是`IObserver<_> -> unit -> unit`。

`IObserver<_> -> unit -> unit` 现在和`IObserver<_> -> Action`where之间存在细微差别`Action : unit -> unit`。区别在于前者是咖喱，而后者不是。

当观察者订阅时，`subscribe observer`返回一个`()`可以应用于 get`unit`的方法 - 在应用最后一个之前，您的订阅方法永远不会真正被调用`()`- 直到它取消订阅时它才会被分离。

你可以通过强制它不被咖喱来克服它：

```
let action() = ... | let action = (subscribe observer)
Action(action) 
```

更远：

`Invoke`如果您检查 IL，则`FastFunc`生成的等效 VB（函数引用在 VB 中更清晰）版本

```
 static member Create(subscribe) = 
    Observable.Create(fun observer -> Action(subscribe observer)) 
```

是：

```
Friend Function Invoke(ByVal arg As IObserver(Of a)) As Action
    Return New Action(AddressOf New Observable-Create-Static@27-1(Of a)(Me.subscribe, arg).Invoke)
End Function 
```

并为：

```
 static member Create(subscribe) = 
    Observable.Create(fun observer ->
      let action = subscribe observer
      Action(action)) 
```

是：

```
Friend Function Invoke(ByVal arg As IObserver(Of a)) As Action
    Return New Action(AddressOf New Observable-Create-Static@28-1(Me.subscribe.Invoke(arg)).Invoke)
End Function 
```

1.  `AddressOf New Closure(Me.subscribe, arg).Invoke`-> 在调用 dispose 操作之前不会调用 subscribe 函数。

2.  `AddressOf New Closure(Me.subscribe.Invoke(arg)).Invoke`-> subscribe 函数实际上被调用，结果操作按预期返回。

我希望现在清楚为什么第二种情况有效，而不是第一种。

# java - 为什么可以将 LinkedList 分配给 List 变量？

> ID：13691713
> 
> 赞同：2
> 
> 时间：2012-12-03T21:07:00.377
> 
> 标签：java, oop

我对 LinkedList 感到困惑。它们对我来说真的没有意义。有人可以向我解释它基本上是如何工作的。例如，我看到了这段代码（如下），这对我来说没有意义。根据我的猜测，创建了一个字符串列表（list1）并将其放入 LinkedList 中。但是 list 和 LinkedList 之间有什么区别？谢谢

```
List<String>list1 = new LinkedList<String>() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:08:24.683

LinkedList 是一个实现 List 接口的类。接口不是实际的类，它更像是实现它们的类需要公开哪些方法的约定/蓝图。

例如，如果您有名为 Shape 的接口

```
interface Shape() {
     public void draw(); 
} 
```

请注意，这包含一个用于绘制的方法体，而是一个约定，即所有实现此接口的类都必须有一个名为 draw 的方法。现在，假设您有两个类都实现了上述接口

```
class Box implements Shape {
    public void draw() {
        //do actual drawing in this method body
    }
}

class Circle implements Shape {
    public void draw() {
        //do actual drawing in this method body
    }
} 
```

然后，您可以将 Circle 或 Box 的实例转换为 Shape 变量，并安全地调用 draw 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:13:31.460

这一行将一个空`LinkedList`对象分配`String` 给 List 接口。
List 接口的想法是，您以后可以在无需更改其余代码的情况`LinkedList`下进行交换`ArrayList`

例如：

```
List<String> list1 = new ArrayList<String>();

list.add("element1"); 
```

list.add() 适用于 for`ArrayList`和 for `LinkedList`，这就是`List Interface`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T21:08:17.740

`java.util.List`是一个接口，`java.util.LinkedList`是实现的类`List interface`。

```
List<String>list1 = new LinkedList<String>();
SuperClass(Class or interface) ref= new SubClass(Implementing class/concrete class) 
```

以上是创建LinkedList的**多态方式。**

以下是 List 的一些特征：

1.  接受重复
2.  可以使用索引访问。
3.  维护广告订单

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-03T21:38:07.123

`LinkiedList`实现 List 接口，List`LinkedList`也是如此。

这是`LinkedList`类的定义：

```
public class LinkedList<E> extends AbstractSequentialList<E> implements List<E>, Deque<E>, Cloneable, Serializable 
```

如您所见，[`LinkedList`该类](http://docs.oracle.com/javase/6/docs/api/index.html?java/lang/Object.html)实现了 List 接口。

Therefore, as `LinkedList` is a List (or a child of List bot not exactly), you can use polymorphism to instantiate a List object like you are saying. The List interface say the behavior of the class that implement this interface, in this case `LinkedList`. Remember that the Interfaces are like a contract, so A**LL THE METHODS THAT ARE DEFINIED IN** List interface **MUST BE IMPLEMENTED** in the `LinkedList class`. In that way List interface has the same methods as the `LinkedList` class.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T21:18:05.813

我认为让您感到困惑的是泛型的使用。

这里没有泛型：

```
List list1 = new LinkedList(); 
```

这是非常简单的 Java 代码。我们正在创建一个 LinkedList 对象并将其分配给 List 类型的变量。LinkedList 实现了 List 接口，因此可以正常工作。

现在让我们重新添加泛型：

```
List<String>list1 = new LinkedList<String>(); 
```

不同之处在于您指定了 LinkedList 将包含的内容。

将某些内容放入列表中：

```
list1.add("Something in my linked list"); 
```

# c - 在 C/C++ 中创建 unix/linux 命令行工具的最佳实践是什么？

> ID：13691715
> 
> 赞同：7
> 
> 时间：2012-12-03T21:07:13.507
> 
> 标签：c, linux, unix, parameters, command-line-arguments

我目前的任务是创建一些命令行帮助实用程序供我们的内部开发团队使用。但是，我想知道创建 unix 命令行工具的最佳实践。我尝试查看[git 源代码](https://github.com/git/git/blob/master/git.c)以获取有关如何读取参数并相应地显示消息的示例。但是，我正在寻找一个清晰的模板来创建工具、安全地读取参数以及在用户输入不正确的参数或`--help`我想显示帮助消息时显示标准的“帮助”消息。是否有一个标准库用于根据传递的参数读取`-abcFGH`和切换哪个进程启动？`--parameter`

**命令行：**

```
git 
```

或者

```
git --help 
```

**输出：**

```
usage: git [--version] [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]
       [-p|--paginate|--no-pager] [--no-replace-objects] [--bare]
       [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]
       [-c name=value] [--help]
       <command> [<args>]
... 
```

**命令行：**

```
MyTool CommandName --CommandArgs 
```

**输出：**

无论该特定命令做什么。

* * *

到目前为止我所做的工作：

**代码：**

```
int main(int argc, char **argv)
{
    if(argc < 2)
    helpMessage();
    char* commandParameter = argv[1];
    if (strncmp(argv [1],"help", strlen(commandParameter)) == 0)
        helpMessage();
    else if (strncmp(argv [1],"pull", strlen(commandParameter)) == 0)
        pull();
    else
        helpMessage();
} 
```

理想的情况如下所示：

**代码：**

```
int main(int argc, char **argv)
{
    MagicParameters magicParameters = new MagicParameters(argv);
    switch(magicParameters[1])
    {
        case command1:
            Command1();
            break;
        case ...

        case help:
        default:
            HelpMessage();
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T21:20:22.027

getopt_long() 是您要查找的内容，这是最简单用法的示例：

```
 static const struct option opts[] = {
        {"version",   no_argument,    0, 'v'},
        {"help",      no_argument,    0, 'h'},
        {"message", required_argument, 0, 'm'},
        /* And so on */
        {0,      0,                   0,  0 }   /* Sentiel */
    };
    int optidx;
    char c;

    /* <option> and a ':' means it's marked as required_argument, make sure to do that.
     * or optional_argument if it's optional.
     * You can pass NULL as the last argument if it's not needed.  */
    while ((c = getopt_long(argc, argv, "vhm:", opts, &optidx)) != -1) {
        switch (c) {
            case 'v': print_version(); break;
            case 'h': help(argv[0]); break;
            case 'm': printf("%s\n", optarg); break;
            case '?': help(argv[0]); return 1;                /* getopt already thrown an error */
            default:
                if (optopt == 'c')
                    fprintf(stderr, "Option -%c requires an argument.\n",
                        optopt);
                else if (isprint(optopt))
                    fprintf(stderr, "Unknown option -%c.\n", optopt);
                else
                    fprintf(stderr, "Unknown option character '\\x%x'.\n",
                        optopt);
               return 1;
        }
    }
    /* Loop through other arguments ("leftovers").  */
    while (optind < argc) {
        /* whatever */;
        ++optind;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:10:22.203

看看 getopt 库。

# php - 如何正确加载 dynatree 以选择更多或取消选择节点

> ID：13691717
> 
> 赞同：1
> 
> 时间：2012-12-03T21:07:15.540
> 
> 标签：php, jquery, json, edit, dynatree

如何生成具有选定值的树？我所做的是存储选定的键，然后在编辑时，我在一个带有选定键的额外 json 数组的帮助下生成树。但问题是如果我通过 mysql 更改图像的顺序，键不代表真实值。

这就是我为树创建 json 数组的方式，深度 = 1。

```
 /*** get image tree structure ***/
    $i = 0; $j = 0;//$j = 0;  $l = 0;
    $counter = 0;
    $whole_tree = $this->cms_model->get_tree_big_array('0');
    foreach ($whole_tree as $node_key => $node_array) {
        foreach ($node_array as $key_name => $node_element_value) {

            if($key_name == 'title'):
                $new_array[$i][$key_name] = $node_element_value;                
            elseif($key_name == 'filename'):
                $new_array[$i][$key_name] = $node_element_value;
            elseif($key_name == 'id'):
                $new_array[$i][$key_name] = $node_element_value;
            elseif($key_name == 'is_folder'):
                $new_key_name = 'isFolder';

                if($node_element_value == '1'):
                    $new_node_element_value = 'true';
                    $new_array[$i][$new_key_name] = $new_node_element_value;

                    $cur_id = $node_array['id'];
                    $children = $this->cms_model->get_children_array($cur_id);

                    foreach ($children as $child_key_name => $child_element_value) {
                        foreach ($child_element_value as $super_child_key_name => $childnode_element_value) {

                        if($super_child_key_name == 'title'):
                            $new_array[$i]['children'][$child_key_name][$super_child_key_name] = $childnode_element_value;
                        elseif($super_child_key_name == 'filename'):
                            $new_array[$i]['children'][$child_key_name][$super_child_key_name] = $childnode_element_value;
                        elseif($super_child_key_name == 'id'):
                            $new_array[$i]['children'][$child_key_name][$super_child_key_name] = $childnode_element_value;
                        endif;
                        }
                        $counter++;
                    }
                else:
                    $new_node_element_value = 'false';
                endif;

                $cur_id = $node_array['id'];
                $children = $this->cms_model->get_children_array($cur_id);

            endif;
            $j++;
        }
        $i++;
    }
    //print_r($new_array);
    $json_tree = json_encode($new_array);
    $data['json'] = $json_tree; 
```

上面是 dynatree 脚本，我在其中为页面挑选一些照片并预览选择的内容和激活的内容。在这种情况下，我有照片。

```
jQuery(function(){
jQuery("#tree").dynatree({
    checkbox: true,

    onPostInit: function(isReloading, isError){
        var data = <?php echo $json;?>; // the whole json array tree object
        var array = <?php echo $key_array;?>; // these the stored keys where selected from last post.
        var imgarray = <?php echo $img_array;?>; // these are the selected images id's

        for(i=0; i<array.length; i++){
            var tree = jQuery("#tree").dynatree("getTree");
            tree.getNodeByKey(array[i]).select(); // i'm selecting on load the selected nodes using this function.
            // what i want is to select the nodes using the $img_array array in order to have
            // an independence in what order the nodes are generated
        }

    },                              

    onActivate: function(node) {
        var site_url = '<?php echo site_url(); ?>';
        var controller_path = '/admin/actions/get_image_path/';
        var image_id = node.data.id;

        jQuery.ajax({
            url: site_url+controller_path+image_id,
            type: 'GET',
            datatype: 'html',
            processData: false,
            success: function(msg){
                jQuery('.image-previewer').css({display: 'block'});
                jQuery('.image-previewer').html(msg);
            }
        });

    },
    onSelect: function(flag, node) {
        //alert(node.data.id);
        if(flag){
            jQuery('<div id="'+node.data.id+'">').css({
                    display: 'block',
                    borderRadius: '3px',
                    margin: '0 0 10px 0',
            })
            .appendTo('.list');
            jQuery('<span id="'+node.data.id+'" style="padding:0px 5px; line-height:40px; margin-right:5px; float:left; background:#fffccc;">Εχεις επιλέξει: '+node.data.filename+' </span>').appendTo('div#'+node.data.id+'');
            jQuery('<img id="img_'+node.data.id+'" src="http://pinecone.gr/files/thumbs/'+node.data.filename+'" style="float:left; margin-right:5px">').appendTo('div#'+node.data.id+'');   
            jQuery('<span>').css({
                lineHeight: '40px',
                display: 'block',
                float: 'left',
                id: 'span_'+node.data.id
            })

            jQuery('<input>',
            { 
                type: 'hidden',
                name: 'img_array[]',
                id : 'input_'+node.data.id,
                value: 'img_'+node.data.id
            }).appendTo('div#'+node.data.id+'');

            jQuery('<input>',
            { 
                type: 'hidden',
                name: 'keys_array[]',
                id : 'inputkeys_'+node.data.id,
                value: node.data.key
            }).appendTo('div#'+node.data.id+'');                                        

            jQuery('<br clear="all" />').appendTo('div#'+node.data.id+'');
            jQuery('input#input_'+node.data.id+'').attr({ value: node.data.id})

        }else if(!flag){
            jQuery('.list div#'+node.data.id+'').remove();
        }

    },
    persist: false,
    children:
    <?php echo $json; ?>

}); 
```

});

如果我更改数据库中图像记录的顺序，或者通过添加图像，当前记录的选定键不代表真实，因为结构已更改，并且我有数据完整性失败。您对解决方案有何建议。提前致谢

# git - 什么是默认的 git core.askpass 配置值？

> ID：13691721
> 
> 赞同：11
> 
> 时间：2012-12-03T21:07:26.033
> 
> 标签：git

我已将其设置`core.askpass`为应用程序，现在我想将其还原。我该怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T21:09:41.183

去掉它：

```
git config --global --unset core.askpass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:09:51.970

我觉得[默认](http://www.kernel.org/pub/software/scm/git/docs/git-config.html)是GIT_ASKPASS，后面是SSH_ASKPASS，后面是简单的密码提示。不过，建议您通过 GIT_ASKPASS 环境变量进行设置。

# android - 显示电影文件的缩略图

> ID：13691731
> 
> 赞同：2
> 
> 时间：2012-12-03T21:07:49.070
> 
> 标签：android, thumbnails, movieclip

我是 Android 开发的新手，我正在使用 Onur Cinar 的“Android Apps with Eclipse”一书开始。

我已经完成了开发 MoviePlayer 应用程序的第 6 章（源代码： http: [//www.apress.com/9781430244349](http://www.apress.com/9781430244349)），但是在我的手机上运行该应用程序时，我无法看到我列出的电影的任何缩略图。当我使用手机录制新电影时，新电影会以默认绿色 Android 图标作为缩略图添加到电影列表中，而原始电影仍然没有缩略图图标。

我的代码似乎与给定源代码的代码相匹配。书中给出的代码有问题还是这是预期的行为？如果是后者，什么情况下（非默认）缩略图图标会出现在电影列表中？

电影.java：

```
package com.apress.movieplayer;

import android.database.Cursor;
import android.provider.MediaStore;

/**
 * Movie file meta data.
 * 
 * @author Josh
 */
public class Movie
{
/** Movie title */
private final String title;

/** Movie file */
private final String moviePath;

/** MIME type */
private final String mimeType;

/** Movie duration in ms */
private final long duration;

/** Thumbnail file */
private final String thumbnailPath;

/**
 * Constructor.
 * 
 * @param mediaCursor media cursor.
 * @param thumbnailCursor thumbnail cursor.
 */
public Movie(Cursor mediaCursor, Cursor thumbnailCursor)
{
    title = mediaCursor.getString(mediaCursor.getColumnIndexOrThrow(
            MediaStore.Video.Media.TITLE));

    moviePath = mediaCursor.getString(mediaCursor.getColumnIndex(
            MediaStore.Video.Media.DATA));

    mimeType = mediaCursor.getString(mediaCursor.getColumnIndex(
            MediaStore.Video.Media.MIME_TYPE));

    duration = mediaCursor.getLong(mediaCursor.getColumnIndex(
            MediaStore.Video.Media.DURATION));

    if ( (thumbnailCursor != null) && thumbnailCursor.moveToFirst() )
    {
        thumbnailPath = thumbnailCursor.getString(
                thumbnailCursor.getColumnIndex(
                        MediaStore.Video.Thumbnails.DATA));
    }
    else
    {
        thumbnailPath = null;
    }
}

/**
 * Get the movie title.
 * 
 * @return movie title.
 */
public String getTitle() {
    return title;
}

/**
 * Get the movie path.
 * 
 * @return movie path.
 */
public String getMoviePath() {
    return moviePath;
}

/**
 * Get the MIME type.
 * 
 * @return MIME type.
 */
public String getMimeType() {
    return mimeType;
}

/**
 * Get the movie duration.
 * 
 * @return movie duration.
 */
public long getDuration() {
    return duration;
}

/**
 * Get the thumbnail path.
 * 
 * @return thumbnail path.
 */
public String getThumbnailPath() {
    return thumbnailPath;
}

/*
 * @see java.lang.Object#toString()
 */
@Override
public String toString()
{
    return "Movie [title=" + title + ", moviePath=" + moviePath
            + ", mimeType=" + mimeType + ", duration=" + duration
            + ", thumbnailPath=" + thumbnailPath + "]";
}
} 
```

MovieListAdapter.java：

```
package com.apress.movieplayer;

import java.util.ArrayList;

import android.content.Context;
import android.net.Uri;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;

/**
 * Movie list view adapter.
 * 
 * @author Josh
 */
public class MovieListAdapter extends BaseAdapter
{
/** Context instance */
private final Context context;

/** Movie list */
private final ArrayList<Movie> movieList;

/**
 * Constructor.
 * 
 * @param context context instance.
 * @param movieList movie list.
 */
public MovieListAdapter(Context context, ArrayList<Movie> movieList)
{
    this.context = context;
    this.movieList = movieList;
}

/**
 * Gets the number of elements in movie list.
 * 
 * @see BaseAdapter#getCount()
 */
public int getCount() {
    return movieList.size();
}

/**
 * Gets the movie item at given position.
 * 
 * @param position item position.
 * @see BaseAdapter#getItem(int)
 */
public Object getItem(int position) {
    return movieList.get(position);
}

/**
 * Gets the movie id at given position.
 * 
 * @param position item position.
 * @return movie id.
 * @see BaseAdapter#getItemId(int)
 */
public long getItemId(int position) {
    return position;
}

/**
 * Gets the item view for given position.
 * 
 * @param position item position.
 * @param convertView existing view to use.
 * @param parent parent view to use.
 */
public View getView(int position, View convertView, ViewGroup parent) {
    // check if convert view exists or inflate the layout
    if (convertView == null)
    {
        LayoutInflater layoutInflater = (LayoutInflater)
                context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = layoutInflater.inflate(R.layout.movie_item, null);
    }

    // Get the movie at given position
    Movie movie = (Movie) getItem(position);

    // Set thumbnail
    ImageView thumbnail = (ImageView) convertView.findViewById(
            R.id.thumbnail);

    if (movie.getThumbnailPath() != null)
    {
        thumbnail.setImageURI(Uri.parse(movie.getThumbnailPath()));
    }
    else
    {
        thumbnail.setImageResource(R.drawable.ic_launcher);
    }

    // Set title
    TextView title = (TextView) convertView.findViewById(R.id.title);
    title.setText(movie.getTitle());

    // Set duration
    TextView duration = (TextView) convertView.findViewById(R.id.duration);
    duration.setText(getDurationAsString(movie.getDuration()));

    return convertView;
}

private static String getDurationAsString(long duration)
{
    // Calculate milliseconds
    long milliseconds = duration % 1000;
    long seconds = duration / 1000;

    // Calculate seconds
    long minutes = seconds / 60;
    seconds %= 60;

    // Calculate hours and minutes
    long hours = minutes / 60;
    minutes %= 60;

    // Build the duration string
    String durationString = String.format("%1$02d:%2$02d:%3$02d.%4$03d",
            hours, minutes, seconds, milliseconds);

    return durationString;
}

} 
```

MoviePlayerActivity.java：

```
package com.apress.movieplayer;

import java.util.ArrayList;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.util.Log;
//import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;

/**
 * Movie Player.
 * 
 * @author Josh
 *
 */
public class MoviePlayerActivity extends Activity implements OnItemClickListener
{
/** Log tag. */
private static final String LOG_TAG = "MoviePlayer";

/**
 * On create lifecycle method.
 * 
 * @param savedInstanceState saved state.
 * @see Activity#onCreate(Bundle)
 */
@Override
    protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_movie_player);

    ArrayList<Movie> movieList = new ArrayList<Movie>();

    // Media columns to query
    String[] mediaColumns = {
            MediaStore.Video.Media._ID,
            MediaStore.Video.Media.TITLE,
            MediaStore.Video.Media.DURATION,
            MediaStore.Video.Media.DATA,
            MediaStore.Video.Media.MIME_TYPE };

    // Thumbnail columns to query
    String[] thumbnailColumns = { MediaStore.Video.Thumbnails.DATA };

    // Query external movie content for selected media columns
    Cursor mediaCursor = getContentResolver().query(
            MediaStore.Video.Media.EXTERNAL_CONTENT_URI,
            mediaColumns, null, null, null);

            /*managedQuery(
            MediaStore.Video.Media.EXTERNAL_CONTENT_URI, mediaColumns,
            null, null, null);*/

    // Loop through media results
    if ( (mediaCursor != null) && mediaCursor.moveToFirst() )
    {
        do
        {
            // Get the video id
            int id = mediaCursor.getInt(mediaCursor
                    .getColumnIndex(MediaStore.Video.Media._ID));

            // Get the thumbnail associated with the video
            Cursor thumbnailCursor = getContentResolver().query(
                    MediaStore.Video.Thumbnails.EXTERNAL_CONTENT_URI,
                    thumbnailColumns, MediaStore.Video.Thumbnails.VIDEO_ID
                        + "=" + id, null, null);

                    /*managedQuery(
                    MediaStore.Video.Thumbnails.EXTERNAL_CONTENT_URI,
                    thumbnailColumns, MediaStore.Video.Thumbnails.VIDEO_ID
                            + "=" + id, null, null);*/

            // New movie object from the data
            Movie movie = new Movie(mediaCursor, thumbnailCursor);
            Log.d(LOG_TAG, movie.toString());

            // Add to movie list
            movieList.add(movie);

        }
        while (mediaCursor.moveToNext());
    }

    // Define movie list adapter
    MovieListAdapter movieListAdapter = new MovieListAdapter(this,
            movieList);

    // Set list view adapter to movie list adapter
    ListView movieListView = (ListView) findViewById(R.id.movieListView);
    movieListView.setAdapter(movieListAdapter);

    // Set  item click listener
    movieListView.setOnItemClickListener(this);
}

@Override
/*public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_movie_player, menu);
    return true;
}*/

    /**
     * On item click listener.
     */
    public void onItemClick(AdapterView<?> parent, View view, int position, long id)
    {
        // Gets the selected movie
        Movie movie = (Movie) parent.getAdapter().getItem(position);

        // Plays the selected movie
        Intent intent = new Intent(Intent.ACTION_VIEW);
        intent.setDataAndType(Uri.parse(movie.getMoviePath()), movie.getMimeType());
        startActivity(intent);
    }
} 
```

activity_movie_player.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/movieListView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >
    </ListView>
</LinearLayout> 
```

电影项目.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<ImageView
    android:contentDescription="@string/thumbnail_description"
    android:id="@+id/thumbnail"
    android:layout_width="64dp"
    android:layout_height="64dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginRight="16dp"
    android:src="@drawable/ic_launcher" />
<TextView
    android:id="@+id/title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignTop="@+id/thumbnail"
    android:layout_toRightOf="@+id/thumbnail"
    android:text="@string/large_text"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView 
    android:id="@+id/duration"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/title"
    android:layout_below="@+id/title"
    android:text="@string/small_text"
    android:textAppearance="?android:attr/textAppearanceSmall" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:52:58.883

鉴于代码，这似乎是 Android 操作系统的正常功能。一旦视频被其他视频播放应用程序打开，就好像缩略图是在这些更复杂的程序中生成的，并可供其他应用程序使用（包括这个演示电影播放器​​应用程序）。

如果有人能详细说明这在“幕后”是如何运作的，我会很高兴，因为我的分析有点黑匣子。

# java - java.awt 似乎是空的

> ID：13691732
> 
> 赞同：0
> 
> 时间：2012-12-03T21:07:49.970
> 
> 标签：java, eclipse, import

我正在尝试像这样导入类 RenderingHints：

```
import java.awt.RenderingHints; 
```

但 java.awt 似乎完全没有任何类，所以我得到一个“无法解决”的错误。我的理解是 java.awt 包包含在 JDK 中。我是最新的（1.7版） - 那么可能导致问题的原因是什么？

我正在使用 Eclipse Juno。

任何想法将不胜感激！

# java - Java 数独求解器输出

> ID：13691739
> 
> 赞同：0
> 
> 时间：2012-12-03T21:08:07.830
> 
> 标签：java

我的数独求解器出现了一些问题，我需要制作，我应该做的是创建一个程序来检查输入的数独谜题是否正确。我有检查每一行、每一列和“minibox”是否工作的代码。我现在唯一的问题是打印出拼图。这是我到目前为止所拥有的：

```
public String printGrid(int size, int[][] puzzle){
    double temp = Math.sqrt(size);

    for(int row = 0; row < size; row++){
        for(int column = 0; column < size; column++){
            System.out.print(puzzle[row][column]);

            if(column == temp - 1) {
                System.out.print("|");   
            }

            if(row == temp - 1){
                for(int i = 0; i < size; i++){
                    System.out.print("-\t");
                }
            }

            if(column == size - 1) {
                column = 0;
                row++;
            }
        }
    }
    return "Correct!";
} 
```

例如，大小为 4，输入的数独为：

```
 1 2 3 4
 4 3 2 1 
 3 4 1 2
 2 1 4 3 
```

我的输出看起来像这样：

```
 1 2 | 3 4
 4 3 | 2 1
 ----+----
 3 4 | 1 2
 2 1 | 4 3 
```

但是，我当前的代码给出了 ArrayOutOfBounds 错误并输出：

```
 -  2-  -   -   -   1-  -   -   -   4|121|43 
```

我完全迷失了如何编写这个方法来输出，任何人都可以为我解释一下吗？（也忽略所有数独都返回“正确！”的事实，我自己应该能够弄清楚。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:12:19.960

```
if(column == size - 1) {
    column = 0;
    row++;
} 
```

使用上述方法`if-statement`，您不会让内循环获取`terminated`，因为每次`column`值到达死胡同，您就是`resetting`它`0`，因此内循环的终止条件`(column < size)`将始终为真，并且您正在不断增加`row`值，这将逐渐产生`ArrayIndexOutOfBounds`。

只需删除该`if`条件。它不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:16:34.017

您至少有 4 个我立即看到的问题：

1.  您不会在外部 ( `row`) 循环的末尾打印换行符
2.  循环应该只在外循环中`if(row == temp - 1)`（你想在它自己的行上做，而不是每次都在列中
3.  `column == temp-1`等仅适用于 2x2 情况，它应该是`column > 0 && column % temp == 0`
4.  永远不要修改`for`循环内的循环变量，这会混淆一切，通常会导致`ArrayIndexOutOfBoundsException`，就像这里发生的那样。

# python - 如何确定“振荡”轨迹的幅度和频率

> ID：13691740
> 
> 赞同：3
> 
> 时间：2012-12-03T21:08:10.877
> 
> 标签：python, simulation

这是行人在拥堵中移动的轨迹 ![在此处输入图像描述](../Images/80c3353f7b8549363956d29f2680e2e8.png)

如您所见，他/她的头部进行类似振荡的运动。所以不是完美的正弦曲线，但也不是一条线。

是否可以为这条不规则曲线定义“幅度”和“频率”？

**更新**：

到目前为止，我尝试了两种不同的方法：

1.  第一个是基于计算转折点，然后用它们制作样条曲线。
2.  第二种方法基于[unutbu](https://stackoverflow.com/users/190597/unutbu)的建议，使用 Ramer-Douglas-Peucker 算法。

结果如下：

![在此处输入图像描述](../Images/074627b75043e466cbbb43e7805f871f.png)

我在 RDP 中看到的问题是 free parameter `dist`。低值（意味着更多细节）意味着结果轨迹中的振荡。所以我不得不小心这个参数。此外，`splin`ed 曲线更加平滑。

你怎么看？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T21:19:38.210

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T20:37:12.283

这是您链接到的 RDP 模块的更新，它应该使用 Vectors 与 Python 3.x 一起使用：

```
import functools

def autocast(function):
    @functools.wraps(function)
    def wrapper(self, other):
        if isinstance(other, self.__class__):
            if len(other) != len(self):
                raise ValueError('Object dimensions are not equivalent!')
            return function(self, other)
        return function(self, self.__class__(size=len(self), init=other))
    return wrapper

class Vector:

    __slots__ = '__data'

    def __init__(self, *args, size=0, init=0):
        self.__data = list(map(float, args if args else [init] * size))

    def __repr__(self):
        return self.__class__.__name__ + repr(tuple(self))

    @autocast
    def __cmp__(self, other):
        return (self.__data > other.__data) - (self.__data < other.__data)

    def __lt__(self, other):
        return self.__cmp__(other) < 0

    def __le__(self, other):
        return self.__cmp__(other) <= 0

    def __eq__(self, other):
        return self.__cmp__(other) == 0

    def __ne__(self, other):
        return self.__cmp__(other) != 0

    def __gt__(self, other):
        return self.__cmp__(other) > 0

    def __ge__(self, other):
        return self.__cmp__(other) >= 0

    def __bool__(self):
        return any(self)

    def __len__(self):
        return len(self.__data)

    def __getitem__(self, key):
        return self.__data[key]

    def __setitem__(self, key, value):
        self.__data[key] = float(value)

    def __delitem__(self, key):
        self[key] = 0

    def __iter__(self):
        return iter(self.__data)

    def __reversed__(self):
        return reversed(self.__data)

    def __contains__(self, item):
        return item in self.__data

    @autocast
    def __add__(self, other):
        return Vector(*(a + b for a, b in zip(self, other)))

    @autocast
    def __sub__(self, other):
        return Vector(*(a - b for a, b in zip(self, other)))

    @autocast
    def __mul__(self, other):
        return Vector(*(a * b for a, b in zip(self, other)))

    @autocast
    def __truediv__(self, other):
        return Vector(*(a / b for a, b in zip(self, other)))

    @autocast
    def __floordiv__(self, other):
        return Vector(*(a // b for a, b in zip(self, other)))

    @autocast
    def __mod__(self, other):
        return Vector(*(a % b for a, b in zip(self, other)))

    @autocast
    def __divmod__(self, other):
        result = tuple(divmod(a, b) for a, b in zip(self, other))
        return Vector(*(a for a, b in result)), Vector(*(b for a, b in result))

    @autocast
    def __pow__(self, other):
        return Vector(*(a ** b for a, b in zip(self, other)))

    @autocast
    def __radd__(self, other):
        return Vector(*(a + b for a, b in zip(other, self)))

    @autocast
    def __rsub__(self, other):
        return Vector(*(a - b for a, b in zip(other, self)))

    @autocast
    def __rmul__(self, other):
        return Vector(*(a * b for a, b in zip(other, self)))

    @autocast
    def __rtruediv__(self, other):
        return Vector(*(a / b for a, b in zip(other, self)))

    @autocast
    def __rfloordiv__(self, other):
        return Vector(*(a // b for a, b in zip(other, self)))

    @autocast
    def __rmod__(self, other):
        return Vector(*(a % b for a, b in zip(other, self)))

    @autocast
    def __rdivmod__(self, other):
        result = tuple(divmod(a, b) for a, b in zip(other, self))
        return Vector(*(a for a, b in result)), Vector(*(b for a, b in result))

    @autocast
    def __rpow__(self, other):
        return Vector(*(a ** b for a, b in zip(other, self)))

    @autocast
    def __iadd__(self, other):
        for key in range(len(self)):
            self[key] += other[key]
        return self

    @autocast
    def __isub__(self, other):
        for key in range(len(self)):
            self[key] -= other[key]
        return self

    @autocast
    def __imul__(self, other):
        for key in range(len(self)):
            self[key] *= other[key]
        return self

    @autocast
    def __itruediv__(self, other):
        for key in range(len(self)):
            self[key] /= other[key]
        return self

    @autocast
    def __ifloordiv__(self, other):
        for key in range(len(self)):
            self[key] //= other[key]
        return self

    @autocast
    def __imod__(self, other):
        for key in range(len(self)):
            self[key] %= other[key]
        return self

    @autocast
    def __ipow__(self, other):
        for key in range(len(self)):
            self[key] **= other[key]
        return self

    def __neg__(self):
        return Vector(*(-value for value in self))

    def __pos__(self):
        return Vector(*(+value for value in self))

    def __abs__(self):
        return Vector(*(abs(value) for value in self))

    def __get_magnitude(self):
        return sum(value ** 2 for value in self) ** 0.5

    def __set_magnitude(self, value):
        self *= value / self.magnitude

    magnitude = property(__get_magnitude, __set_magnitude)

###############################################################################

def point_line_distance(point, start, end):
    if start == end:
        return (point - start).magnitude
    es, sp = end - start, start - point
    return abs(es[0] * sp[1] - es[1] * sp[0]) / es.magnitude

def rdp(points, epsilon):
    dmax = index = 0
    start, *middle, end = points
    for i in range(1, len(points) - 1):
        d = point_line_distance(points[i], start, end)
        if d > dmax:
            index, dmax = i, d
    if dmax >= epsilon:
        return rdp(points[:index+1], epsilon)[:-1] + \
               rdp(points[index:], epsilon)
    return start, end 
```

与原模块给出的演示类似，下面是一个示例使用场景：

```
>>> from pprint import pprint
>>> line = [Vector(0.0, 0.0),
            Vector(1.0, 0.0),
            Vector(2.0, 0.0),
            Vector(2.0, 1.0),
            Vector(2.0, 2.0),
            Vector(1.0, 2.0),
            Vector(0.0, 2.0),
            Vector(0.0, 1.0),
            Vector(0.0, 0.0)]
>>> pprint(rdp(line, 1.0))
(Vector(0.0, 0.0),
 Vector(2.0, 0.0),
 Vector(2.0, 2.0),
 Vector(0.0, 2.0),
 Vector(0.0, 0.0))
>>> 
```

# python - Python 错误：“元组”对象没有属性“编码”

> ID：13691751
> 
> 赞同：1
> 
> 时间：2012-12-03T21:08:42.047
> 
> 标签：python, email, smtplib

我正在做的是从网页中获取信息并尝试以如下格式将其放入电子邮件中：名字：first \n#first 是一个变量姓氏：last #last 是一个变量

下面是我的代码：

```
import smtplib
import base64

from email.MIMEMultipart import MIMEMultipart
from email.mime.text import MIMEText

msg = MIMEMultipart('relative')
msg['Subject'] = 'Confirmation E-Mail'
msg['From'] = "none"
msg['To'] = email
text1 = "First Name: ", first_name, "<br>Last Name: ", last_name
part1 = MIMEText(text1, 'html')

s = smtplib.SMTP('localhost')
s.sendmail(email, email, msg.as_string())
s.quit() 
```

first_name 和 last_name 是从网页中提取的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:34:53.057

MIMEText 将字符串作为其第一个参数。您正在将 text1 创建为元组。你需要更多类似的东西

```
"First Name: %s\nLast Name: %s" % (first_name, last_name) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:34:19.523

您需要将第 1 部分附加到味精：

```
msg.attach(part1) 
```

[您还可以在Python 文档](http://docs.python.org/2/library/email-examples.html)中找到如何发送多部分电子邮件的一个很好的示例

# .net - 从 ASP 页执行的 .Net 程序

> ID：13691752
> 
> 赞同：0
> 
> 时间：2012-12-03T21:08:43.037
> 
> 标签：.net, vb.net, asp-classic

我有一个调用 Excel 和 Word 的 .net (VB .Net) 程序。完成所有任务需要花费大量时间（它读取许多日志，将数据导出到 Excel，创建图形，然后将图形导入 Word 模板）。

我的第一个解决方案是将程序作为 .dll 包含在 ASP 网站中，但现在我已经解雇了。该程序的 CPU 使用率很高，完成所有任务可能需要数小时。网页必须运行 CPU 使用率低的进程和/或快速进程。

现在我有两个选择：

**A)**从 ASP 执行程序：

```
set WshShell = server.CreateObject("WScript.Shell") 
wshShell.Run program 
```

**B)**在 Windows 服务中转换程序，并执行通过 MSMQ 发送消息的例程（读取日志、将数据导出到 excel、创建图形...）。

我有两个问题：

**- 第一：**这些是“好”的解决方案吗？还有其他“好”的解决方案吗？

**- 第二**：我不想要程序中的图形界面。如果 word 和 excel 也在后台，那就更好了。有什么想法可以做到这一点吗？我想唯一的解决方案是选项 B)，将程序作为 Windows 服务。Excel，word ...将在另一个“会话”中，并且不会显示任何内容（我已经阅读了有关此内容的antoher stackoverflow以及获取excel和word工作的问题和解决方案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:15:01.867

B 是更好的选择，但我对 MSMQ 没有任何经验。您可能想要使用 WCF+MSMQ，因为如果结果证明 MSMQ 是错误的选项，则可以尝试其他一些重写较少的协议。

至于选项 A，ASP classic 或 ASP.NET 都没有针对处理长时间运行的进程进行优化。浏览器在请求中关闭，IIS 可能会卡住，更难限制工作负载等。此外，如果您有一个 ASP 页面，这意味着您还有其他页面，并且在您的网站中包含长时间运行的任务意味着您冒着用户的风险当所有网络服务器线程都在处理长时间运行的进程时，无法访问其他不相关的页面。

# mysql - 使用 node-orm 连接到 mysql db 的节点问题

> ID：13691753
> 
> 赞同：0
> 
> 时间：2012-12-03T21:08:58.800
> 
> 标签：mysql, node.js, orm

[当我在此示例](https://github.com/felixge/node-mysql#introduction)中使用没有 node-orm 和 node-mysql 的连接时有效。但是，当我尝试像[这样](https://github.com/dresende/node-orm#connecting-via-raw-database-api)制作时，它会崩溃。据我了解，orm 重新设计了他们的 api，但没有编辑他们的 wiki。

然而这：

```
var db = orm.connect("mysql://username:password@hostname/database", function (success, db) {...}); 
```

不要崩溃，但成功也是空的:(

我应该如何将 orm 连接到 mysql？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T10:28:56.573

node-orm 有一些问题。不可调试的神奇错误...试试这个：[https](https://npmjs.org/package/light-orm) ://npmjs.org/package/light-orm （简单数据库的关键）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T02:02:34.327

看来您正在使用旧的 orm，使用[orm2](https://github.com/dresende/node-orm2)将使用语法 `orm.connect("mysql://username:password@host/database", function (err, db) { if (err) throw err;`

# ios - 如何确定一种产品是否是消耗品？

> ID：13691754
> 
> 赞同：1
> 
> 时间：2012-12-03T21:08:57.733
> 
> 标签：ios, in-app-purchase

在我的代码中，我不希望在购买回调后将任何产品保存在 NSUserDefaults 中。我尝试了 SkProduct 类，看看它是否提供了该信息，但它没有。有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:45:08.677

在[SKProduct](http://developer.apple.com/library/mac/#documentation/StoreKit/Reference/SKProduct_Reference/Reference/Reference.html)对象中，您可以设置`productIdentifier`为任何您想要的。

例如：

*   Consumable Items 产品 id 可以以 GGG-XXXXXXX 开头
*   非消耗品产品 ID 可以以 KEEP-XXXXXX 开头

然后在您的应用程序中检查 productIdentifier 的前缀。

# mysql - SQL 连接和限制

> ID：13691755
> 
> 赞同：1
> 
> 时间：2012-12-03T21:09:07.350
> 
> 标签：mysql

目前，我正在为我的框架 Scaffold 编写一个模型系统。但是，我的 SQL 技能并不是那么好。目前，我的系统正在生成此查询。

```
SELECT 
 `User`.`id` AS `User_id`,
 `User`.`name` AS `User_name`,
 `Address`.`id` AS `Address_id`,
 `Address`.`address` AS `Address_address`,
 `Address`.`user_id` AS `Address_user_id`,
 `Database`.`id` AS `Database_id`,
 `Database`.`user_id` AS `Database_user_id`
FROM
 `users` AS `User`,
 `addresses` AS `Address`,
 `databases` AS `Database`
GROUP BY `User_id`,`Address_id`,`Database_id`
HAVING
 `User`.`id` = 1 AND
 `Address`.`user_id` = `User`.`id` AND
 `Database`.`user_id` = `User`.`id`; 
```

这产生了这个结果。

```
User_id    User_name    Address_id    Address_address    Address_user_id    Database_id    Database_user_id
=======    =========    ==========    ===============    ===============    ===========    ================
1          Nat          1             1234               1                  1              1
1          Nat          1             1234               1                  2              1
1          Nat          2             3456               1                  1              1
1          Nat          2             3456               1                  2              1 
```

这很好用，但我知道我可能没有以最好的方式做到这一点（我可能应该使用真正的连接？）这使得我可以从这里做的事情非常有限。

例如，如果我想限制为一个地址（对于 oneToOne 关系）而不影响 oneToMany 数据库关系。我将如何修改此 SQL 来做到这一点？

这是一个查询的最佳主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:12:40.740

无需 GROUP 您当前的查询：

```
SELECT 
    `User`.`id` AS `User_id`, `User`.`name` AS `User_name`, 
    `Address`.`id` AS `Address_id`, `Address`.`address` AS `Address_address`, `Address`.`user_id` AS `Address_user_id`, 
    `Database`.`id` AS `Database_id`, `Database`.`user_id` AS `Database_user_id` 
FROM `users` AS `User`,
    JOIN `addresses` AS `Address` ON `Address`.`user_id` = `User`.`id` 
    JOIN `databases` AS `Database` ON `Database`.`user_id` = `User`.`id`
WHERE `User`.`id` = 1; 
```

要仅获取一个用户记录，您需要找到一种方法来根据应用程序的要求从逻辑上限制您正在检索的地址和数据库记录（使用 MAX 或其他聚合函数），或者只是将它们分组以供以后解析通过您的应用程序，例如：

```
SELECT 
    `User`.`id` AS `User_id`, `User`.`name` AS `User_name`, 
    GROUP_CONCAT(CONCAT(`Address`.`id`, ',', `Address`.`address`, ',', `Address`.`user_id`) SEPARATOR '|') AS `Addresses`
    GROUP_CONCAT(CONCAT(`Database`.`id`, ',', `Database`.`user_id`) SEPARATOR '|') AS `Databases`
FROM `users` AS `User`,
    JOIN `addresses` AS `Address` ON `Address`.`user_id` = `User`.`id` 
    JOIN `databases` AS `Database` ON `Database`.`user_id` = `User`.`id`
WHERE `User`.`id` = 1
GROUP BY `User`.`id`; 
```

注意 GROUP_CONCAT 的限制（默认为 1024 个字符，但可配置）......在这里仅以示例为例。

**编辑**：你应该从上面的例子中得到的另一点是永远不要使用 HAVING 子句，你可以使用 WHERE 子句来做同样的事情。WHERE 明显更快。仅使用 HAVING 子句来测试聚合操作的结果。

# jquery - 在 jQuery 中停止 HTML5 音频标签

> ID：13691756
> 
> 赞同：3
> 
> 时间：2012-12-03T21:09:09.207
> 
> 标签：jquery, html, audio

我正在使用 jquery 插件来进行站点游览。要定义游览的站点，您可以创建一个具有特定 ID 的有序列表，并使用行项目来分隔站点。

HTML：

```
<ol id="joyRideTipContent">
    <li>
        <center>
            <audio id="welcome" src="intro.mp3" controls></audio>
        </center>    
        <h2>Stop 1 title</h2>
        <p>Stop 1 content</p>
    </li>
    <li>
        <center>
            <audio src="sectionIntro01.mp3" controls></audio>
        </center>
        <h2>Stop 2 title</h2>
        <p>Stop 2 content</p>
    </li>
    <li data-id="s01c01">
        <p>Stop 3 content<p> 
    </li>
</ol> 
```

我的音频嵌入工作正常：（将嵌入代码放入订单项）

```
<audio id="myID" src="filename.mp3"></audio> 
```

我无法让它停止播放，我尝试了很多方法，主要是我一直试图在 *.js 中找到对关闭按钮和下一步按钮的调用，并在那里调用暂停......即。

```
welcome.pause(); 
```

这不起作用。

我使用了[此处提供的 Joyride 插件](http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:22:00.300

`welcome.pause()`应该是`DOMElement.pause()`。只要您实际选择了 DOM 元素，您的代码就可以工作：

```
var welcome = $("#welcome")[0]; 
```

或者

```
var welcome = document.getElementById('welcome'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T16:53:23.253

我已经解决了这个问题：

代替：

```
welcome.pause(); 
```

在 jquery 函数中：

```
jQuery('audio').each(function(){ this.pause() }); 
```

# android - Android Robotium - 你如何检测上下文菜单？

> ID：13691758
> 
> 赞同：0
> 
> 时间：2012-12-03T21:09:14.683
> 
> 标签：android, robotium

我正在编写一个 Robotium 测试，我长按列表中的一个项目以调出上下文菜单。我需要以某种方式检测我的 tearDown 中的上下文菜单，以便我可以退出它并退出应用程序。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T07:27:04.163

finishOpenedActivities 应该关闭您打开的所有活动，但我假设您需要做一些特定的事情来清除您的拆卸方法中的应用程序状态。在这种情况下，您将不得不检查上下文菜单是否存在，我假设您有代码要做，因为您正在使用上下文菜单（或查看 dmons 答案）。

第二种选择当然也是值得花时间做的事情是在您的应用程序/测试基础设施中构建一个简单的方法来删除所有状态，以便您的拆卸是一致的，并且都从没有以前的状态开始，在长期运行将使您的测试更好并允许更快的开发，因为通常任何时候您都必须记住执行 x 和 y 和 z 以清除状态，您会忘记其中一个，并且追踪起来会很痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:58:38.723

不确定最新的 Robotium 版本是否有更好的方法，但我们在早期版本中发现了一个功能性黑客：

```
 private ListView getContextMenuListView(){
    ArrayList<ListView> currentListViews = solo.getCurrentListViews();
    for (ListView lv : currentListViews){
      String listViewClassName = lv.getClass().getName();
      if (listViewClassName.startsWith("com.android.internal.app.AlertController$RecycleListView")){
        return lv;
      }
    }
    return null;
  } 
```

请注意，与其他所有内容一样，您需要*等待*列表视图弹出。如果您立即尝试找到它，您可能会错过它，尤其是在模拟器中运行时。

# search - solr 中的默认邻近搜索

> ID：13691759
> 
> 赞同：0
> 
> 时间：2012-12-03T21:09:25.033
> 
> 标签：search, solr, proximity

我想知道是否可以通过 solrconfig.xml 在 solr 中设置默认搜索邻近度。

目前，如果我想执行邻近搜索，我必须执行以下操作：

```
q="red cars"~10 
```

有没有办法默认设置 10 个单词的邻近度，以便所有查询都是具有 10 个单词邻近度范围的邻近搜索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T09:59:05.660

通过使用[eDismax](http://wiki.apache.org/solr/ExtendedDisMax)，您将接近度设置为默认斜率。
默认情况下会启用邻近性，因为搜索会查找相距倾斜距离的单词。

检查[Query Phrase Slop](http://wiki.apache.org/solr/ExtendedDisMax#qs_.28Query_Phrase_Slop.29)和[Phrase slop](http://wiki.apache.org/solr/ExtendedDisMax#ps_.28Phrase_Slop.29)，这将为查询设置 slop。
查询短语 Slop 应用于短语查询。
同时，Phrase slop 将应用于普通查询。

```
<requestHandler name="standard" class="solr.SearchHandler" default="true">
    <lst name="defaults">
        <str name="defType">edismax</str>
        <str name="echoParams">explicit</str>
        <str name="qf">field</str>
        <str name="qs">10</str>
        <str name="pf">field</str>
        <str name="ps">10</str>
        <str name="q.alt">*:*</str>
    </lst>
</requestHandler> 
```

# android - Android开发中如何为ORMLite-Database类生成TestCases

> ID：13691768
> 
> 赞同：2
> 
> 时间：2012-12-03T21:10:04.403
> 
> 标签：android, testing, junit, ormlite

我正在为我的 android 应用程序开发数据库层，我想为此使用测试用例，但我不知道如何在 android 开发环境中解决这个问题。

我有这个 DBHelper 类

```
public class DBHelper extends OrmLiteSqliteOpenHelper{

    private static final String DATABASE_NAME = "pdixattach.db";
    private static final int DATABASE_VERSION = 1;
    private static final String TAG = DBHelper.class.getSimpleName();
    private static DBHelper _helperInstance;

    private Dao<Attachment, Integer> attachmentDao = null;
    private Dao<User, Integer> userDao = null;
    private Dao<Comment, Integer> commentDao = null;
    private Dao<Job, Integer> jobDao = null;
    private Dao<Target, Integer> targetDao = null;

    public DBHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db, ConnectionSource source) {
        Log.i(TAG, "onCreate");
        try{
            TableUtils.createTable(source, Attachment.class);
            TableUtils.createTable(source, User.class);
            TableUtils.createTable(source, Comment.class);
            TableUtils.createTable(source, Target.class);
            TableUtils.createTable(source, Job.class);

        } catch (Exception e){
            Log.e(TAG, "error while creating tables "  + e.getMessage());
            throw new RuntimeException(e);
        }

    }

    @Override
    public void onUpgrade(final SQLiteDatabase db, final ConnectionSource connectionSource, final int oldVersion, final int newVersion) {
        Log.i(TAG, "onUpgrade");
        try {
            TableUtils.dropTable(connectionSource, Attachment.class, true);
            TableUtils.dropTable(connectionSource, User.class, true);
            TableUtils.dropTable(connectionSource, Target.class, true);
            TableUtils.dropTable(connectionSource, Job.class, true);
            TableUtils.dropTable(connectionSource, Comment.class, true);
        } catch (SQLException e) {
            Log.e(TAG, "error while upgrading tables " + e.getMessage());
            throw new RuntimeException(e);
        }

        // after we drop the old databases, we create the new ones
        onCreate(db, connectionSource);

    }

    public Dao<Attachment, Integer> getAttachmentDao() throws SQLException {
        if (this.attachmentDao == null) {
            this.attachmentDao = getDao(Attachment.class);
        }
        return this.attachmentDao;
    }

    public Dao<User, Integer> getUserDao() throws SQLException {
        if (this.userDao == null) {
            this.userDao = getDao(User.class);
        }
        return this.userDao;
    }

    public Dao<Comment, Integer> getCommentDao() throws SQLException {
        if (this.commentDao == null) {
            this.commentDao = getDao(User.class);
        }
        return this.commentDao;
    }

    public Dao<Target, Integer> getTargetDao() throws SQLException {
        if (this.targetDao == null) {
            this.targetDao = getDao(User.class);
        }
        return this.targetDao;
    }

    public Dao<Job, Integer> getJobDao() throws SQLException {
        if (this.jobDao == null) {
            this.jobDao = getDao(User.class);
        }
        return this.jobDao;
    }

    /**
     * Close the database connections and clear any cached DAOs.
     */
    @Override
    public void close() {
        super.close();
        _helperInstance = null;
        this.attachmentDao = null;
        this.commentDao = null;
        this.jobDao = null;
        this.targetDao = null;
        this.userDao = null;
    } 
```

使用这个 DBManager：

```
public class DBManager {

    private Dao<User,Integer> userDao;
    private Dao<Attachment,Integer> attachmentDao;
    private Dao<Target,Integer> targetDao;
    private Dao<Comment,Integer> commentDao;
    private Dao<Job,Integer> jobDao;
    private DBHelper helper;

    private static DBManager uniqueInstance;
    private static final String TAG = DBManager.class.getSimpleName();

    public DBManager(Context context) {
        helper = new DBHelper(context);
    }

    public static void init(Context context){
        if (uniqueInstance == null) {
            uniqueInstance = new DBManager(context);
        }
    }

    public static synchronized DBManager getInstance(){
        return uniqueInstance;
    }

    private void injectDBHelper(DBHelper dbhelper) {            
        if (this.helper == null)
            this.helper = dbhelper;
        else
            Log.d(TAG, "DBHelper already available in DBManager");
    }

    public boolean addUser(User u){
        boolean retVal = false;
        if (u == null){
            throw new IllegalArgumentException("user must not be null");
        }

        try {                                                               
            helper.getUserDao().create(u);
            retVal = true;
        } catch (SQLException e) {
            Log.e(TAG, "error while adding user to db " + e.getMessage());
        }

        return retVal;
    }

    public boolean addServiceEndpoint(String endpoint) {
        boolean retVal = false;
        if (endpoint == null){
            throw new IllegalArgumentException("endpoint must not be null");
        }

        try {
            Target t = new Target(endpoint);                
            int result = helper.getTargetDao().create(t);
            retVal = (result == 1);

        } catch (SQLException e) {
            Log.e(TAG, "error while adding target to db, with service endpoint " + endpoint + "error" + e.getMessage());
        }

        return retVal;

    } 
```

我想为 addUser 方法生成测试用例，有人可以帮助我吗？如何在 android 开发环境中实现这一点？

谢谢

# c# - 数据访问层中的异常处理策略

> ID：13691769
> 
> 赞同：2
> 
> 时间：2012-12-03T21:10:06.373
> 
> 标签：c#, .net, exception-handling, data-access-layer

我正在构建一个数据访问层，它将用于两种类型的应用程序。

1.  不关心错误细节的应用程序。如果发生异常，那么很可能只会被记录下来，而用户可能没有意识到这一点。

    示例：简单的条码盘点应用。用户输入条形码，如果数据库连接可用，则系统提供一些额外信息，如果没有，则仅在本地记录条形码。在这种情况下，我不想要详细的异常处理。

2.  我非常关心异常细节的应用程序。

在构建 DAL 以适应这两个类别时，我必须遵循什么策略？

现在我正在从第一个类别构建一个应用程序，我在 DAL 方法中所做的只是让异常冒泡到表示层，在那里我有几个`try..catch`块来进行简单的日志处理，让用户不知道他的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T21:21:19.843

错误处理是从需要知道的人知道的代码部分获取信息。DAL 知道如何打印 SqlException、SqlCommand 和 SqlParameters 集合的踪迹。但是 UI 知道导致异常的整个调用堆栈。用户可能不知道如何处理这些信息，因此您应该登录到单独的渠道，例如给开发人员发送电子邮件或登录数据库。

如果您正在编写错误记录器，我还建议使用真实的应用程序（或几个真实的应用程序）作为库的测试。例如，您可以将您的错误记录器连接到 codeplex 上的各种应用程序，看看解决错误的痛点是什么，或者尝试使用您的错误记录器来记录错误是您自己的库。

# algorithm - 寻找航路点轨迹的最快部分

> ID：13691770
> 
> 赞同：2
> 
> 时间：2012-12-03T21:10:07.903
> 
> 标签：algorithm, gps

运动追踪器应用程序通常会定期记录时间戳和位置，以便存储整个轨迹。然后，分析应用程序允许找到某些统计数据，例如具有固定持续时间（例如 5 英里所需时间）的最高速度的轨道分段。反之亦然，在一定时间跨度内穿越的最长距离（例如 12 分钟内的库珀距离）。

我想知道计算这些部分的最优雅和/或最有效的方法是什么。

在一种天真的方法中，我会对航点进行归一化和插值，以获得更细粒度的航点列表，无论是固定时间间隔还是固定距离步长。然后，移动一个代表我的时间跨度的滑动窗口。列表上的距离分段并搜索符合我的条件的最佳子列表。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T16:38:24.967

优雅和效率在旁观者的眼中。

就个人而言，我认为您的插值想法很优雅。

我想插值算法很容易构建，您将对后续数据执行的搜索也很容易执行。这可能导致代码紧凑，其正确性可以很容易地验证。此外，插值算法可能已经存在并且是多用途的，因此您不必重复自己（DRY）。*您建议的解决方案具有将数据处理*与数据*分析*分开的好处。这种性质的模块化通常被认为是优雅的一个组成部分。

效率——我们谈论的是速度、空间还是代码行数？您可以尝试将插值步骤与搜索步骤结合起来以节省空间，但这可能会牺牲速度和代码简单性。在多个查询无法利用之前的计算的意义上，速度肯定会被牺牲。

当您考虑代码的效率时，不要太担心计算机将如何处理它，或者您将如何编码。更深入地考虑您的方法的内在时间复杂度。我怀疑插值和搜索都可以在 O(N) 时间内进行，在这种情况下，需要大量数据才能让你陷入困境：很难让 O(N) 算法表现得非常糟糕。

为了支持上述内容，插值只是估计两个值之间的中间点，因此这在值的数量上是线性的，在中间点的数量上是线性的。搜索可能可以使用[Knuth-Morris-Pratt 算法](https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)的数值变体来完成，该算法也是线性的。

# actionscript-3 - 在 AS3 中，Dictionary 和 ArrayCollection 之间的界限在哪里？

> ID：13691771
> 
> 赞同：0
> 
> 时间：2012-12-03T21:10:16.547
> 
> 标签：actionscript-3, apache-flex, dictionary, containers, arraycollection

基本上，我一直在我的程序中使用一个 Dictionary 对象，该对象基本上将整数作为其键，并将 RTMFP 对等 ID 存储在适当的位置。每个 int 都是唯一的，代表一个用户。

现在我需要对此进行扩展，其中用户由 int 和布尔值的组合标识，有点像这样：

```
private var m_iUID:int;
private var m_blnIsCurrent:Boolean; 
```

只有这两者之间的组合才能真正唯一地标识用户。话虽这么说，我正要使用一个由此制成的新类作为字典键；但后来我突然想到，我可以不这样做，而是将对等 ID 添加到类定义中并将 Dictionary 对象转换为 ArrayCollection：

```
private var m_iUID:int;
private var m_blnIsCurrent:Boolean;
public var m_strNearID:String; 
```

所以现在我想知道在这种情况下哪个更好。这个问题引出了一个更大的问题：一般而言，您在哪里真正划定这两种集合类型之间的界限？毕竟它们突然开始看起来并没有那么不同，除非你试图避免弄乱类定义。我想我真的在就具体情况和一般问题征求意见。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:51:03.117

ArrayCollection 只是一个 Array 的包装器，并且仅在 Flex 中可用。

在 AS3 中，您确实有 3 种基本哈希表类型：数组、对象和字典。您可以根据要使用的键类型选择使用哪一个：整数、字符串或对象引用。数组会将任何键转换为 int，Object 会将任何键转换为字符串。Dictionary 的作用类似于字符串键的对象（并将*原语*转换为字符串），但它真正擅长的是使用对象*引用*作为键。

如果您想使用单个 int 作为唯一键，请使用数组。如果要使用单个字符串作为唯一键，请使用对象。如果您想使用对象引用作为唯一键，请使用字典。

`toString()`在您的情况下，您可能应该在“关键”类上使用一个对象和一个自定义方法。这是因为您想使用原始值的组合（不是对象引用）作为唯一键。没有办法在本地执行此操作，因此您必须将这些值作为单个字符串混合在一起。对象是字符串键的最佳（最快）哈希表，因此这是您应该使用的集合。

例子：

```
class User {
    private var m_iUID:int;
    private var m_blnIsCurrent:Boolean;
    public var m_strNearID:String;
    public function User(UID:int, IsCurrent:Boolean) {
        m_iUID = UID;
        m_blnIsCurrent = IsCurrent;
    }

    // Custom toString to mash together primitives
    public function toString() {
        return m_iUID.toString() + "-" + (m_blnIsCurrent ? "1" : "0");
    }
}

// Later:
var allUsers:Object = {}
var user1:User = new User(231049, true);
var user2:User = new User(0x2309, false);

// Implicitly calls toString():
allUsers[user1] = "User 1";
allUsers[user2] = "User 2";

// All of the following will successfully retrieve the value for user1 ("User 1"):
// ONLY the first would work if allUsers was a Dictionary
trace(allUsers[user1]);
trace(allUsers[user1.toString()]); 
trace(allUsers["231049-1"]); 
trace(allUsers[new User(231049, true)]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:33:49.010

`Dictionary`并且`ArrayCollection`有一些重要的区别：

*   `Dictionary`将对象映射到其他对象，而`ArrayCollection`只是对象列表。
*   `ArrayCollection`仅是 Flex，因此在通用 AS3 项目中无法使用。

您应该使用哪一个实际上取决于您在应用程序中需要什么：

*   您是否会在其他地方使用“身份”对象（带有用户 ID 和“当前”），而没有关联的对等 ID？在这种情况下，将其设为一个单独的`Identity`类左右，并使用 a`Dictionary`将实例映射`Identity`到对等 id。
*   您是否需要根据身份执行查找？换句话说，你需要问“哪个peer id与这个身份相关联？”。如果是这样，请再次使用`Dictionary`+ `Identity`，以避免循环遍历列表。

我敢肯定还有更多考虑因素，但是这些应该可以帮助您入门。

# javascript - javascript setDate 的 chrome 问题

> ID：13691773
> 
> 赞同：1
> 
> 时间：2012-12-03T21:10:20.393
> 
> 标签：javascript, google-chrome

这个非常基本的脚本创建了 3 个变量以在页面上使用，以首选格式的今天日期，从今天起 +90 天的日期和从今天起 +120 天的日期。

它在 Firefox 和 IE 上运行良好，但在 Chrome 中，这些变量显示为“未定义”，控制台输出：“未捕获的类型错误：对象 false 没有方法 'setDate'”

这是我的 JavaScript

```
var today = new Date();
var rg = (today.getMonth()+1) + "/" + today.getDate() + "/" + today.getFullYear();

var closed = new Date();
closed.setDate(today.getDate()+90);
var cl = (closed.getMonth()+1) + "/" + closed.getDate() + "/" + closed.getFullYear();

var expire = new Date();
expire.setDate(today.getDate()+120);
var ex = (expire.getMonth()+1) + "/" + expire.getDate() + "/" + expire.getFullYear(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:17:29.123

`closed`是任何`window`对象的保留名称。（见[这里](https://developer.mozilla.org/en-US/docs/DOM/window.closed)）由于您在全局空间中运行它，所有变量都存储在下面`window`，因此您正在与浏览器认为的内容发生冲突`window.closed`。

只需更改`var closed = new Date();`为新名称或按照@KingKongFrog 的建议通过闭包将其放置在新范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:18:12.713

将其放在匿名函数中并尝试

```
(function() {
    var today = new Date();
    var rg = (today.getMonth()+1) + "/" + today.getDate() + "/" + today.getFullYear();

    var closed = new Date();
    closed.setDate(today.getDate()+90);
    var cl = (closed.getMonth()+1) + "/" + closed.getDate() + "/" + closed.getFullYear();

    var expire = new Date();
    expire.setDate(today.getDate()+120);
    var ex = (expire.getMonth()+1) + "/" + expire.getDate() + "/" + expire.getFullYear();
})(); 
```

# python - Python：精确定位斜坡的线性部分

> ID：13691775
> 
> 赞同：19
> 
> 时间：2012-12-03T21:10:23.727
> 
> 标签：python, matplotlib, graph

我有几个如下所示的图：

[![在此处输入图像描述](../Images/f0a95897f06439f146ae1420065b1a98.png)](https://i.stack.imgur.com/kTW5f.png)

我想知道有哪些方法可以找到 x 轴大约 5.5 到 8 之间的斜率。如果有几个这样的图，我更想知道是否有一种方法可以自动找到斜率值。

有什么建议么？

我在想`ployfit()`，还是线性回归。问题是我不确定如何自动找到这些值。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-05T16:40:30.743

在数据集中找到线性部分的一种通用方法是计算函数的二阶导数，并查看它在哪里（接近）为零。在解决问题的过程中需要考虑几件事：

*   如何计算噪声数据的二阶导数？一种快速简单的方法，可以很容易地适应不同的噪声水平、数据集大小和线性补丁的预期长度，是将数据与等于高斯二阶导数的卷积核进行卷积。可调整的部分是内核的宽度。

*   在您的上下文中，“接近于零”是什么意思？要回答这个问题，您必须对数据进行试验。

*   该方法的结果可以用作上述 chi^2 方法的输入，以识别数据集中的候选区域。

这里有一些可以帮助您入门的源代码：

```
from matplotlib import pyplot as plt

import numpy as np

# create theoretical data
x_a = np.linspace(-8,0, 60)
y_a = np.sin(x_a)
x_b = np.linspace(0,4,30)[1:]
y_b = x_b[:]
x_c = np.linspace(4,6,15)[1:]
y_c = np.sin((x_c - 4)/4*np.pi)/np.pi*4\. + 4
x_d = np.linspace(6,14,120)[1:]
y_d = np.zeros(len(x_d)) + 4 + (4/np.pi)

x = np.concatenate((x_a, x_b, x_c, x_d))
y = np.concatenate((y_a, y_b, y_c, y_d))

# make noisy data from theoretical data
y_n = y + np.random.normal(0, 0.27, len(x))

# create convolution kernel for calculating
# the smoothed second order derivative
smooth_width = 59
x1 = np.linspace(-3,3,smooth_width)
norm = np.sum(np.exp(-x1**2)) * (x1[1]-x1[0]) # ad hoc normalization
y1 = (4*x1**2 - 2) * np.exp(-x1**2) / smooth_width *8#norm*(x1[1]-x1[0])

# calculate second order deriv.
y_conv = np.convolve(y_n, y1, mode="same")

# plot data
plt.plot(x,y_conv, label = "second deriv")
plt.plot(x, y_n,"o", label = "noisy data")
plt.plot(x, y, label="theory")
plt.plot(x, x, "0.3", label = "linear data")
plt.hlines([0],-10, 20)
plt.axvspan(0,4, color="y", alpha=0.2)
plt.axvspan(6,14, color="y", alpha=0.2)
plt.axhspan(-1,1, color="b", alpha=0.2)
plt.vlines([0, 4, 6],-10, 10)
plt.xlim(-2.5,12)
plt.ylim(-2.5,6)
plt.legend(loc=0)
plt.show() 
```

这是结果： ![在此处输入图像描述](../Images/7bfa453f2bc140c821b418d2814c877f.png)

`smooth_width`是卷积核的宽度。为了调整噪声量，将`0.27`random.normal 中的值更改为不同的值。请注意，此方法在靠近数据空间边界时效果不佳。

如您所见，二阶导数（蓝线）的“接近零”要求对于数据是线性的黄色部分非常适用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T21:42:13.097

您可以使用[Ramer Douglas Peucker 算法](http://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm)将您的数据简化为一组较小的线段。该算法允许您指定一个`epsilon`这样的方法，即每个数据点都不会比`epsilon`某个线段更远。线段的斜率将粗略估计曲线的斜率。

这里有[RDP 算法的 Python 实现。](https://github.com/sebleier/RDP/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T22:00:16.800

这只是一种可能的解决方案，它会找到最小 chi^2 值大于预设最小值的点的直线段；

```
from matplotlib.pyplot import figure, show
from numpy import pi, sin, linspace, exp, polyfit
from matplotlib.mlab import stineman_interp

x = linspace(0,2*pi,20);
y = x + sin(x) + exp(-0.5*(x-2)**2);

num_points = len(x)

min_fit_length = 5

chi = 0

chi_min = 10000

i_best = 0
j_best = 0

for i in range(len(x) - min_fit_length):
    for j in range(i+min_fit_length, len(x)):

        coefs = polyfit(x[i:j],y[i:j],1)
        y_linear = x * coefs[0] + coefs[1]
        chi = 0
        for k in range(i,j):
            chi += ( y_linear[k] - y[k])**2

        if chi < chi_min:
            i_best = i
            j_best = j
            chi_min = chi
            print chi_min

coefs = polyfit(x[i_best:j_best],y[i_best:j_best],1)
y_linear = x[i_best:j_best] * coefs[0] + coefs[1]

fig = figure()
ax = fig.add_subplot(111)
ax.plot(x,y,'ro')
ax.plot(x[i_best:j_best],y_linear,'b-')

show() 
```

![在此处输入图像描述](../Images/09d6a11611c78d2f528b00aef3079f16.png)

我可以看到它对于更大的数据集会出现问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:30:33.803

如果您的数据“模型”由大部分符合直线的数据组成，最后有一些异常值或摆动位，您可以尝试[RANSAC](http://en.wikipedia.org/wiki/RANSAC)算法。

这里的（非常罗嗦，抱歉）伪代码是：

```
choose a small threshold distance D

for N iterations:
    pick two random points from your data, a and b
    fit a straight line, L, to a and b
    count the inliers: data points within a distance D of the line L
    save the parameters of the line with the most inliers so far

estimate the final line using ALL the inliers of the best line 
```

# perl - Net::SSL 正在破坏我的 Sys::SigAction timeout_call 函数

> ID：13691777
> 
> 赞同：1
> 
> 时间：2012-12-03T21:10:26.097
> 
> 标签：perl, https, timeout, mechanize, www-mechanize

在使用 Sys::SigAction timeout_call 从我上一个**[问题](https://stackoverflow.com/questions/12964503/wwwmechanizetimed-https-timeout-does-not-work/13016289)**的答案中超时后（注意：这次我使用 WWW::Mechanize 而不是 WWW::Mechanize::Timed），我的 60 秒超时警报正常工作。有一段时间，我以为我在使用 Crypt::SSLeay (Net::SSL) 进行 SSL，但仔细观察后，我意识到代码出于某种原因正在使用 Net::SSLeay (IO::Socket::SSL)我以为 WWW::Mechanize 自动使用了 Crypt::SSLeay。在我开始使用 Net::SSL 后，我注意到 SSL 页面的响应时间有所改善（快了 50%）。但是现在我的 60 秒超时失败并且再次运行超过 60 秒！如果我取出使用 Net::SSL，那么我的 Sys::SigAction 超时 (timeout_call) 将起作用，但 SSL 页面加载速度不快。所以我有两个问题。

1.  Crypt::SSLeay (Net::SSL) 是否提供比 Net::SSLeay (IO::Socket:SSL) 更快的 SSL 算法？

2.  如何让我的超时再次使用 Net::SSL？（也许这是我必须做出的权衡？）

代码：

```
use Net::SSL
use WWW::Mechanize;
use HTTP::Cookies;
use Sys::SigAction qw(timeout_call);
use Time::HiRes qw(time); #also for use with sigaction?

my ($start_time, $end_time) = 0;

my $ua = WWW::Mechanize->new(
autocheck => 0, #turning off autocheck becuase any get errors will be fatal need to check for errors ourselves
ssl_opts => { verify_hostname => 0 } # if not set to 0 then Crypt::SSLeay will complain that it cant resolve hostnames
);

my $cookies = HTTP::Cookies->new(
autosave => 1
);

$ua->cookie_jar($cookies);

$ua->agent_alias("Windows IE 6");

if ( timeout_call( 60 ,sub { $start_time = time(); $ua->get('https://secure.site.com'); $end_time = time();} ))
{
   print "index page timed out\n" ;
   exit;
}

my $total_index_time = sprintf '%.3f', ($end_time - $start_time);

print "index load time: $total_index_time\n";

unless($ua->success){
   print "Error: " . $ua->status;
   exit;
}
... 
```

**使用 Net::SSL 加载的模块 -**

地穴/SSLeay/CTX.pm

地穴/SSLeay/X509.pm

地穴/SSLeay.pm

网络/SSL.pm

地穴/SSLeay/MainContext.pm

**不使用 Net::SSL 加载的模块 -**

网络/SSLeay.pm

IO/套接字/SSL.pm

/usr/lib/perl5/vendor_perl/5.10.0/x86_64-linux-thread-multi/auto/Net/SSLeay/randomize.al

/usr/lib/perl5/vendor_perl/5.10.0/x86_64-linux-thread-multi/auto/Net/SSLeay/autosplit.ix

# ios - iOS 区分点击了哪个标注附件

> ID：13691783
> 
> 赞同：5
> 
> 时间：2012-12-03T21:10:45.720
> 
> 标签：ios, annotations, uibutton, mkmapview, callout

在我的地图注释中，我有一个 UIButton 作为标注中的每个附件视图。在该`- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control`方法中，我如何确定触摸了哪个附件视图来处理每个事件？这是我的代码：

```
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation {

if ([annotation isKindOfClass:[MKUserLocation class]])
    return nil;

MKPinAnnotationView *MyPin=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];

UIButton *calloutButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
UIButton *directionsButton = [UIButton buttonWithType:UIButtonTypeCustom];
directionsButton.frame = CGRectMake(0, 0, 23, 23);
[directionsButton setBackgroundImage:[UIImage imageNamed:@"directions.png"] forState:UIControlStateNormal];

MyPin.leftCalloutAccessoryView = directionsButton;
MyPin.rightCalloutAccessoryView = calloutButton;
MyPin.draggable = NO;
MyPin.highlighted = NO;
MyPin.animatesDrop= YES;
MyPin.canShowCallout = YES;
MyPin.pinColor = MKPinAnnotationColorRed;

return MyPin;
}

- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)view calloutAccessoryControlTapped:(UIControl *)control {

Annotation *ann = view.annotation;

if ([control tag] == 1) {

    CLLocationCoordinate2D currentCoords = {ann.coordinate.latitude, ann.coordinate.longitude};

    MKPlacemark *place = [[MKPlacemark alloc] initWithCoordinate: currentCoords addressDictionary:nil];
    MKMapItem *destination = [[MKMapItem alloc] initWithPlacemark: place];
    destination.name = ann.title;
    destination.url = [NSURL URLWithString:@"http://www.wccca.com/PITS"];
    NSArray *items = [[NSArray alloc] initWithObjects: destination, nil];
    NSDictionary *options = [[NSDictionary alloc] initWithObjectsAndKeys:
                             MKLaunchOptionsDirectionsModeDriving,
                             MKLaunchOptionsDirectionsModeKey, nil];
    [MKMapItem openMapsWithItems: items launchOptions: options];

}

if ([control tag] == 2) {

    MKCoordinateRegion region;
    region.center.latitude = ann.coordinate.latitude;
    region.center.longitude = ann.coordinate.longitude;
    region.span.latitudeDelta  = 0.02;
    region.span.longitudeDelta = 0.02;

    [self.mapView setRegion:region animated:YES];
}

} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-03T21:28:54.027

无需设置和使用标签，您只需检查`control`是左附件视图还是右附件视图：

```
if (control == view.leftCalloutAccessoryView) {
    //handle left control tap...        
}
else
if (control == view.rightCalloutAccessoryView) {
    //handle right control tap...       
} 
```

# ios - 解码一个巨大的 NSString，内存不足

> ID：13691787
> 
> 赞同：2
> 
> 时间：2012-12-03T21:10:59.810
> 
> 标签：ios, xml, memory-management, base64, nsdata

我正在寻找有关如何改进使用 base64 编码解码 40+MB NSString 并将其保存到文件的过程的想法，同时能够将该过程适应 iPad 1 的 256 MB RAM

我从 NSXMLParser 得到 NSString：

```
id pointerToString;

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
if ([currentElement isEqualToString:@"myElement"]) 
    {
    pointerToString = [string retain];
}
} 
```

然后我在回调中使用pointerToString：

```
[handler performSelector: action withObject: pointerToString]; 
```

在回调中（id 值是 pointerToString）。我用pointerToString初始化NSData，同时用base64编码解码它。

```
^(id value)
{
    if ( [[value class] isSubclassOfClass:[NSString class]] ) 
    {
    NSData *data = [NSData dataFromBase64String:value];
    [data writeToFile:file.path atomically:YES];
}
} 
```

在 NSData 调用之后或期间，当内存分配达到大约 130MB 时，iPad 1 设备内存不足并被 iOS 杀死。

我已经确定，为了以这种方式处理 40+MB 的 NSString，我需要大约 180+MB 的 RAM（这是 iPad 2 和 3 上的最大内存分配，由于更多的 RAM，该过程有效）

任何想法/提示？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T04:44:55.367

**编辑**：

在处理这种大小的文件时，您可能不想一次将整个数兆字节的文件加载到内存中，既不是巨大的输入文件，也不是几乎一样巨大的输出文件。您应该以流式方式解析它，在进行过程中解码您的数据`foundCharacters`，而不是在内存中保存任何重要部分。

但是，传统技术可能会在该过程的三个阶段中保存整个 XML 文件内存：

1.  当您从服务器下载 XML 文件时；

2.  当 XML 解析器解析该文件时；和

3.  正如您对文件进行 Base64 解码一样。

诀窍是采用流技术，对单个大型 XML 文件的小块同时执行这三个过程。最重要的是，当您下载整个 50mb 文件时，抓取几 kb，解析 XML，如果您要解析 Base64 编码字段，则对那几 kb 执行 Base64 解码，然后继续下一步数据块。

有关这方面的示例（至少是流式 XML 下载和解析，不包括 Base64 解码），请参阅 Apple 的[XMLPerformance 示例项目](https://developer.apple.com/library/ios/#samplecode/XMLPerformance/Introduction/Intro.html#//apple_ref/doc/uid/DTS40008094)。您将看到它将演示`NSXMLParser`我们都熟悉的两个 XML 解析器，以及不太熟悉的`LibXML`解析器。问题`NSXMLParser`在于，留给它自己的设备，将在开始解析之前将整个 XML 文件加载到内存中，即使您使用`initWithContentsOfURL`.

在我之前的回答中，我错误地声称通过使用`initWithContentsOfURL`，`NSXMLParser`会在下载 URL 的内容时将其解析为漂亮的小数据包。协议的`foundCharacters`方法`NSXMLParserDelegate`似乎与`NSURLConnectionDelegate`方法非常相似`didReceiveData`，我确信它`NSXMLParser`会像处理流一样处理流`NSURLConnection`，即在下载正在进行时返回信息。可悲的是，它没有。

但是，通过`LibXML`像 Apple XMLPerformance 示例项目一样使用 ，您实际上可以使用`NSURLConnection`流式传输的能力，从而动态解析 XML。

我创建了一个小[测试项目](https://github.com/robertmryan/iOS-XML-Streaming-w-Base64-Decode)，但我可能会建议您详细了解 Apple 的 XMLPerformance 示例项目。但在我的实验中，一个 56mb 的 XML 文件在通过解析和转换时消耗超过 100mb，`NSXMLParser`但在使用`LibXML2`.

* * *

在您的评论中，您描述了将 Base64 编码数据下载到文件然后对其进行解码的愿望。这种方法似乎效率低得多，但肯定可以奏效。顺便说一句，在最初的下载中，你有同样的内存问题（我在上面解决了）。我敦促您确保最初下载的 Base64 编码数据不会像大多数例程那样轻松地将其加载到 RAM 中。假设您正在使用`NSURLConnection`，您希望在`NSOutputStream`收到数据时将数据写入`didReceiveData`，而不是将其保存在 RAM 中。

请参阅`didReceiveResponse`Apple 的[AdvancedURLConnections 示例](https://developer.apple.com/library/ios/#samplecode/AdvancedURLConnections/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009558)的 AdvancedGetController.m中的示例，了解如何在收到文件时写入文件，而不是典型的将文件添加`NSMutableData`到）。（忽略 AdvancedURLConnections 示例中有关身份验证等的所有内容，但重点是了解它是如何写入的`NSOutputStream`。）此技术将解决此答案顶部列出的三个问题中的第一个，但不是后两者。为此，您必须考虑使用`LibXML2`Apple 的 XMLPerformance 示例项目中的说明或其他类似技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:33:00.760

方法

```
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string 
```

可能不会一次接收所有数据。医生在说

"*由解析器对象发送以向其委托提供代表当前元素的全部或部分字符的字符串。* "

所以它被多次调用。看起来您正在尝试一次编写整个字符串（如果我错了，请见谅）。因此，您可以通过执行以下操作将接收到的数据附加到文件中：

您可以使用以下组合

```
-writeData: 
```

和

```
-seekToEndOfFile 
```

NSFileHandle 类中用于将 NSData 写入文件末尾的方法。

**但是**在接收部分数据时要小心你的 base64 编码！

# python - 如何在空闲时查找和替换所有带有空格的选项卡

> ID：13691790
> 
> 赞同：4
> 
> 时间：2012-12-03T21:11:18.913
> 
> 标签：python, python-idle

我有一个不可见的`expected an indented block`错误，这可能是由于我使用制表符而不是空格引起的。

当我打开“查找/替换”窗口并尝试`TAB`在`find`IDLE 字段中输入时，不出所料地只是跳到该`replace`字段。

我该怎么做呢？

* * *

**最终更新：**

谢谢大家的解答，不胜感激。我的问题是python希望函数注释也缩进，即

```
def imdheladumb():
"""
I'm dum as hel
""" 
```

不起作用，它需要

```
def imdheladumb():
    """
    I'm dum as hel
    """ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:24:33.453

IDLE 不允许您搜索文字制表符。您可以将一个粘贴到搜索框中（按照 will 的建议），但它永远不会匹配任何内容。

但是，它确实允许您进行正则表达式搜索，并且正则表达式`\t`将匹配文字选项卡。因此，打开`Regular expression`复选框，并`\t`在`Find:`框中输入 '，并在框中输入 4 或 8 个空格（视情况而定）`Replace:`。

但是，正如将建议的那样，最好使用 IDLE 的功能而不是尝试手动执行操作：选择带有标签（或不一致）缩进的代码块，转到`Format`菜单，然后选择`Untabify Region`. （或者直接按 control-6。）如果使用 4 空格制表符的编辑器插入制表符，您可能需要先使用`New Indent Width`并将其更改为 4，然后`Untabify Region`.

当您编写不一致的代码时，IDLE 没有任何代码来猜测您的标签大小。我知道的唯一编辑器是emacs。如果你只是在 emacs 中打开文件，它会尝试猜测你的设置，然后你可以选择整个缓冲区和`untabify-region`. 如果它猜对了，你就是金子；如果它猜错了，不要保存缓冲区，因为现在它会更难修复。（如果您是世界上知道如何阅读 emacs lisp 但不喜欢 emacs 的 3 个人之一，您可以查看`python-mode.el`源代码，看看它是如何发挥作用的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-03T21:14:30.050

一种通用的方法是从文档中复制一个制表符（或者在任何随机文本编辑器中复制一个制表符并复制它），然后将其放入字段中。

您可以尝试将其放入`\t`其中，但这仅适用于某些编辑器。

大多数 IDE 都具有自动将制表符替换为预定义数量的空格的功能。建议开启...

编辑：如果您出于任何原因在其他地方使用标签，则执行标准查找和替换*可能会很危险。*

如果你看[这里](http://docs.python.org/2/library/idle.html)，有一个名为“tabify region”的选项。这对你来说可能更有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-03T21:22:52.310

应该有一个应用程序。;)

如果您喜欢矫枉过正，那么通过正则表达式运行代码怎么样：

```
re.sub('\t', '\s\s\s\s', yourCode) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-10T22:35:49.103

对于那些遇到问题的人，新版本的 VSCode 可以轻松解决。

1.  单击页面底部的标签大小。
2.  从弹出的“选择操作”菜单中选择将缩进转换为空格。

# php - 跟踪第 0 行的未知错误

> ID：13691796
> 
> 赞同：7
> 
> 时间：2012-12-03T21:11:59.603
> 
> 标签：php

从 Apache 错误日志中：

> [Mon Dec 03 14:58:01 2012] [error] [client xxxx] PHP Fatal error: Allowed memory size of 16777216 bytes used in Unknown on line 0, referer: [https://www. domain.tld/referer](https://www.domain.tld/referer)

为什么它说“第 0 行未知”？为什么不是“第 xx 行的 Filename.php”？

# facebook-graph-api - 预定的 http DELETE 请求？

> ID：13691798
> 
> 赞同：1
> 
> 时间：2012-12-03T21:12:09.077
> 
> 标签：facebook-graph-api, httprequest

我正在使用 Facebook 分数 API 来存储 iPhone 游戏的分数。为了成为每周一次的锦标赛，我想在每周一的同一时间重置分数。现在我可以通过手动删除请求来重置分数。（带有应用令牌的 Facebook Graph DELETE 请求 /APP_ID/scores）。我想知道如何实现自动化并避免每周手动操作。

# google-maps - 播种生产数据库时获取 OVER_QUERY_LIMIT。（请求太多？）

> ID：13691799
> 
> 赞同：1
> 
> 时间：2012-12-03T21:12:16.627
> 
> 标签：google-maps, gmaps4rails

我正在使用 gmaps4rails gem 在地图上标记位置。

当我为我的 heroku 应用程序数据库播种时，我得到

`#<Gmaps4rails::GeocodeStatus: The address you passed seems invalid, status was: OVER_QUERY_LIMIT`.

对于应包含在数据库中的许多记录。

因此，大量记录最终被排除在外。我很确定原因是一次发送的请求太多。

有一次，我真的很幸运，不会有这些。但是，大多数时候有不少。最终得到一张地图，其中包含我想要在地图上标记的大约一半的位置。

知道如何在播种一定数量的记录后进行某种延迟，以防止一次发送太多请求吗？

# asp.net-mvc - 剑道：从网格行中获取模型

> ID：13691801
> 
> 赞同：0
> 
> 时间：2012-12-03T21:12:20.737
> 
> 标签：asp.net-mvc, kendo-ui

**在MVC 4**中使用**Kendo** UI Grid ：

 **我正在尝试放置一个“**编辑**”按钮和“**删除**”按钮，将行的模型发布到控制器和操作。网格应该像一个具有编辑和删除按钮的简单列表。

```
@(Html.Kendo().Grid<MyViewModel>()
  .Name("Grid")
  .Columns(columns =>
      {
          columns.Bound(p => p.UserLoginId);
          columns.Bound(p => p.AppUserName);
          columns.Bound(p => p.AppUserStatus);
           *** EDIT BUTTON HERE to post row's MyViewModel to new Controller/action ***
           *** DELETE BUTTON HERE to post row's MyViewModel to new Controller/action***

      })
  .DataSource(dataSource => dataSource
           .Ajax()
           .Read(read => read.Action("SearchUser_Read", "Search"))
  )) 
```

我如何将这两个按钮添加到每一行，以便网格将模型发布到控制器/动作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:50:58.493

这只能通过 Ajax 实现。因为即使您使用**表单**标签围绕网格，表单也只能发布到单个操作，您不能根据您按下的提交按钮发布到不同的操作。

我建议您使用标准方法来编辑 Grid - [InLine](http://demos.kendoui.com/web/grid/editing-inline.html)、[Popup](http://demos.kendoui.com/web/grid/editing-popup.html)和[InCell](http://demos.kendoui.com/web/grid/editing.html)模式。

或者，如果您想通过表单提交（不带 Ajax）向服务器发布 POST，请使用 ServerBinding（如离线演示中所示）和[文档](http://docs.kendoui.com/getting-started/using-kendo-with/aspnet-mvc/helpers/grid/server-editing)中。**

# angularjs - 为什么jsFiddle上的这个angularjs不起作用

> ID：13691803
> 
> 赞同：0
> 
> 时间：2012-12-03T21:12:28.580
> 
> 标签：angularjs

[http://jsfiddle.net/maxl/tNZAm/102/](http://jsfiddle.net/maxl/tNZAm/102/)

我希望中继器列出这个数组：

> 函数 MyControl(){ var self = this;
> 
> ```
> self.values = ["a","b","c","d","e","f"];
> self.selectedIndex = -1;
> 
> self.toggleSelect = function(ind){
>     if( ind === self.selectedIndex ){
>         self.selectedIndex = -1;
>     } else{
>         self.selectedIndex = ind;
>     }
> }
> 
> self.getClass = function(ind){
>     if( ind === self.selectedIndex ){
>         return "selected";
>     } else{
>         return "";
>     }
> }
> 
> self.getButtonLabel = function(ind){
>     if( ind === self.selectedIndex ){
>         return "Deselect";
>     } else{
>         return "Select";
>     }
> } }​ 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:25:23.623

您应该使用`$scope`可注入将数据附加到 DOM。此外，您加载了 Angular.js 两次（一次通过“选择框架”下拉菜单，一次通过“添加资源”面板），导致了一个非常非常奇怪的错误。

这是一个有效的 jsFiddle：http: [//jsfiddle.net/BinaryMuse/tNZAm/103/](http://jsfiddle.net/BinaryMuse/tNZAm/103/)

```
function MyControl($scope){
    $scope.values = ["a","b","c","d","e","f"];
    $scope.selectedIndex = -1;

    $scope.toggleSelect = function(ind){
        if( ind === $scope.selectedIndex ){
            $scope.selectedIndex = -1;
        } else{
            $scope.selectedIndex = ind;
        }
    }

    $scope.getClass = function(ind){
        if( ind === $scope.selectedIndex ){
            return "selected";
        } else{
            return "";
        }
    }

    $scope.getButtonLabel = function(ind){
        if( ind === $scope.selectedIndex ){
            return "Deselect";
        } else{
            return "Select";
        }
    }
}​ 
```

# html - 我的布局的身体部分的高度

> ID：13691804
> 
> 赞同：0
> 
> 时间：2012-12-03T21:12:30.523
> 
> 标签：html, css

我需要看一个身高问题...

这是我页面的链接：http: [//www.whiterootmedia.com/database/test/relative.html](http://www.whiterootmedia.com/database/test/relative.html)

如果你一直放大，`#article`div背景不会到页脚。`#article`鉴于导航 div 将是动态高度，我如何使100% 的高度减去横幅、导航和页脚。

我正在尝试`position:absolute`页脚，但我认为我不能对横幅和导航 div 做同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:14:32.407

试试[CSS Sticky Footer](http://www.cssstickyfooter.com/)。它可以跨浏览器工作，不需要任何 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:32:10.820

您可以在 CSS 中尝试 min-height ，滚动出来重要吗？

并且不要绝对定位它！

# c# - Azure Web 角色在部署时开始

> ID：13691806
> 
> 赞同：0
> 
> 时间：2012-12-03T21:12:41.487
> 
> 标签：c#, asp.net-mvc-3, entity-framework, azure, azure-web-roles

我正在创建一个在我的网络角色后台运行的消息传递服务。当 web 角色启动时，它会启动一个 Quartz 作业，该作业每天运行一次并发送一些电子邮件。我现在将我的网络角色设置为永远不会因为空闲而入睡。无论我的网站上的活动如何，这都允许我的工作执行。

我遇到的问题是，如果我在首次部署站点时不访问我的站点，则该工作永远不会开始。我担心如果我的 webrole 被某些 Azure 魔法移动到一个新实例，我的电子邮件服务将无法运行。

该作业在 Application_Start 方法中的 Global.asax 中启动。如何让我的 Web 角色在部署后自动启动？

-编辑-

最初我试图从 WebRole.cs OnStart 开始我的工作，但后来我从实体框架中收到有关我的数据库连接的错误。因此，如果有人知道如何从 WebRole.cs OnStart 访问我的 Web 配置中的连接字符串，那也会回答我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:25:59.397

将您的代码放在您的**WebRole.cs**中：

```
public class WebRole : RoleEntryPoint
{
    public override bool OnStart()
    {
        Task.Factory.StartNew(StartQuartzJob);
        return base.OnStart();
    }

    private void StartQuartzJob()
    {
        // Do work here.            
    }
} 
```

此代码在您的实例启动时运行（部署后、重启后......）。此处的优点是它在您的 Web 应用程序在 IIS 中启动之前运行的不同进程 ( **WaIISHost.exe ) 中运行。**因此，即使您没有任何请求发送到该实例，或者如果您的应用程序池回收，此过程也将继续运行。请记住，由于这是一个不同的过程，您将无法访问 web.config

# javascript - 通过 LAN 网络流式传输视频

> ID：13691807
> 
> 赞同：-1
> 
> 时间：2012-12-03T21:12:48.783
> 
> 标签：javascript, html, video, streaming, jwplayer

我正在寻找一种将视频流式传输到本地网络的方法。大约有 1000 名观众，如果不是更多的话，这必须通过浏览器进行（大多数观众都有 Internet Explorer，但 Chrome 和 Firefox 支持也很好）。由于这是公司政策，并非所有用户都可以访问互联网，因此必须在公司网络内部托管。视频的来源将是视频文件和来自网络摄像头的实时提要。

在接收端，我计划通过 JW Player 提供提要，但我在如何流式传输视频方面遇到了麻烦。

我一直在尝试使用 VLC 媒体播放器但没有成功，我正在寻找另一种方法（或有关如何正确执行此操作的说明）。一般来说，任何帮助都将不胜感激，因为我有一个完全大脑放屁的时刻。目前我首先说明视频文件部分，当它运行时，我将专注于网络摄像头部分。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T16:31:20.817

由于您的播放器大多在 Internet Explorer 中，因此支持实时流式传输的最简单方法是使用 Flash RTMP 流式传输。这个解决方案不是*最先进的*，事实上可能会在几年内过时，但对于大多数客户端是 IE 的 LAN 来说，这将是最好的解决方案。我建议将 Adob​​e 的[FMS](http://www.adobe.com/products/adobe-media-server-family.html)或[Wowza](http://www.wowza.com)视为流媒体服务器。[您可以在他们的网站 ( 1](http://www.adobe.com/devnet/adobe-media-server/getting_started.html) , [2](http://www.adobe.com/devnet/adobe-media-server/articles/beginner_live_fms3.html) , [3](http://www.wowza.com/forums/content.php?3-quick-start-guide) )上找到有关如何设置系统以进行实时或点播流媒体的教程。

您还应该考虑为实时流实现多播，因为它可以防止 1000 多个并发流拥塞您的 LAN。AFAIK 你只能用[FMS](http://help.adobe.com/en_US/flashmediaserver/amazonec2/WS6fc2df2b6d2ce24359910e2812c396a83eb-7ff8.2.html#WS6fc2df2b6d2ce24359910e2812c396a83eb-7ff3.2)做到这一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-07T17:27:03.893

一开始我用VLC做流媒体成功，但是当观众开始放大后，流开始变慢。然后用Adobe Flash Media Live Encoder把视频源做成RTMP流，用Wowza作为流媒体服务器，当观众增长时，流已经启动并运行，没有明显的减速。

我希望这个解决方案在活动到期时（下周二）有效。

# jquery - 用于 SELECT 的 Jquery 验证插件自动验证

> ID：13691811
> 
> 赞同：1
> 
> 时间：2012-12-03T21:13:05.570
> 
> 标签：jquery, validation, select

我正在使用 JQuery Validation Plugin 来验证表单，并且我想在您键入或从字段中跳出时关闭字段的自动验证，所以我添加了：

onkeyup：假，onfocusout：假

到 validate() 选项....但问题是我有一个下拉列表 () 并且在触发了“必需”规则并且我选择了一个值和选项卡到下一个字段之后，下拉列表的错误消息消失了，我不想要。我希望验证仅在访问者单击“提交”时触发。输入字段的一切都按预期工作。

请指教。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T06:29:25.467

它写在官方文档中，还有另一个可能的验证回调：

> 点击
> 
> 类型：布尔值或函数（）
> 
> 单击时验证复选框和单选按钮。设置为 false 以禁用。

但是，当我打开`jquery.validate.js`并查看回调列表时，我在评论中看到，该`click`事件也用于验证选择字段。

**禁用自动验证的最终代码：**

```
$('form').validate({
    onclick: false,
    onkeyup: false,
    onfocusout: false
}); 
```

# c++ - VS2012 中的 std::variate_generator

> ID：13691813
> 
> 赞同：2
> 
> 时间：2012-12-03T21:13:07.917
> 
> 标签：c++, c++11, visual-studio-2012

我`std::variate_generator`在一个VS2010项目中使用如下方式：

```
#include <random>
...
using std::variate_generator;
using std::mt19937;
using std::uniform_real_distribution;

typedef mt19937                                     Engine;
typedef uniform_real_distribution<float>            Distribution;
typedef variate_generator< Engine, Distribution >   Generator;  

Generator r( Engine((DWORD)time(NULL)), Distribution(0.0f, 1.0f) ); 

// from now, calling float rnd = r() gave me a random number between 0.0f and 1.0f in rnd. 
```

我现在已将此代码放入 VS2012 解决方案中，我收到的错误消息是它`std::variate_generator`不是`std`.

已`std::variate_generator`移动或被移除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:17:11.490

variate_generators 未在`<random>`. variate_generator 是 tr1 的一部分，但从未成为标准，所以我对`std::variate_generator`在 VS2010 中工作（而不是`std::tr1::variate_genrator`）感到有点惊讶。我相信它仍然存在于 VS2012 的 tr1 命名空间中。

您可以改为执行以下操作：

```
#include <random>
#include <functional> // for std::bind
...
using std::mt19937;
using std::uniform_real_distribution;

typedef mt19937                                     Engine;
typedef uniform_real_distribution<float>            Distribution;

auto r = std::bind(Distribution(0.0f, 1.0f), Engine((DWORD)time(NULL)));

// from now, calling float rnd = r() gave me a random number between 0.0f and 1.0f in rnd. 
```

# apache-flex - Flex 项目渲染器 - 闪烁图像

> ID：13691814
> 
> 赞同：1
> 
> 时间：2012-12-03T21:13:11.657
> 
> 标签：apache-flex, list, itemrenderer

我有一个带有他的 ItemRenderer 的列表，好吧，当我将数据发送到 dataprovider 时，这会进入函数“设置数据”（覆盖），我有两个图像和一个标签，当发送数据时，我检查是否图像有要设置的来源，如果这个项目有那个来源，那么我没有设置来源以避免闪烁效果，但它不起作用，为什么？在我检查图像来源的情况下，这是空的。

资源：

```
override public function set data( _data:Object ) : void {
    if (imgStatusMessage.source != _data.source) {
        imgStatusMessage.source = _data.source;
    }
} 
```

...

```
<s:Image id="imgStatusMessage" width="15" height="15" visible="false"/> 
```

然后，当 item 为 'repaint' 检查该元素的属性时，如果 _data var 的值相同，则不要再次设置该值。

编辑：如果发送更多数据，所有项目都工作良好，除了第一项；只有第一项在其中一个图像中存在闪烁问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T13:22:15.217

您可以将其添加到您的列表定义中（它将关闭渲染器的回收）：

```
<s:List>
   <s:layout>
      <s:VerticalLayout useVirtualLayout="false" />
   </s:layout>
</s:list> 
```

看看问题是否仍然存在。

如果不是，您可以这样保留，但它可能会影响应用程序在大型列表中的性能。否则，您可能会以不会`source`再次设置的方式实施您的渲染器，而是会从一些预先制作的集合中添加已经制作的图像，特别是如果“源”是一个 url 而不是嵌入的 BitmapAsset。

# javascript - ipinfodb 查找返回 countryCode 'RD'

> ID：13691815
> 
> 赞同：2
> 
> 时间：2012-12-03T21:13:24.947
> 
> 标签：javascript, geocode

我通过 JS 调用 ipinfodb。最近我收到了大约 5-6 个回复（来自大约 600 个），将 countryCode 指定为“RD”。

'RD' 不是 ccTLD，我找不到任何理由将其退回。有没有人遇到过类似的问题，你找到解决方法了吗？

我在路由上调用 ipinfodb

```
http://api.ipinfodb.com/v3/ip-country/?key=_apikey_&ip=_ip_ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T21:54:51.817

`RD`作为保留 IP 地址的伪国家代码返回。

这包括私有地址、D 类和 E 类网络 (IPv4) 和环回。

有关将返回此值的地址的完整列表，请参见[此处](http://en.wikipedia.org/wiki/Reserved_IP_addresses)。

我实际上无法在任何地方找到这种行为记录，但实验很容易证明是这种情况，而且`<CountryName>`在这些情况下，元素填充了“保留”一词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T11:07:50.600

RD 是“保留”IP 地址范围的短国家代码。它是 IETF 批准的为特定网络目的保留的范围。

此代码仅在已弃用的 IPInfoDB 版本 2 中使用。

您应该升级到不断更新的最新版本 3 API。

在 v3 中，您只会在国家代码结果中看到“-”以避免这种混淆。

# asp.net - 无法将 X 类型的对象转换为 X 类型

> ID：13691820
> 
> 赞同：1
> 
> 时间：2012-12-03T21:13:37.077
> 
> 标签：asp.net, vb.net, exception, web-site-project

用户随机收到“无法将“X”类型的对象转换为“X”类型的异常错误。有时这个问题一天会发生几次。有时我们可以去一个星期+没有它出现。

我有一个序列化对象（“X”），我在列表“CurrentDetails”和“NextDetails”中填充为“X”。在文本更改事件中，我检查“CurrentDetails”中的值，此时异常触发。“无法将 X 类型的对象转换为 X 类型”这里有一些代码示例......

文本更改事件（编辑以显示原始数据）

```
Protected Sub txtPackaging_TextChanged(sender As Object, e As System.EventArgs) Handles txtPackaging.TextChanged
    If WarehouseManager.GetDeliveryStatus(CurrentSUPPDelivery.DeliveryNumber) > 60 Then
        'GETTIGN ERROR HERE Unable to cast object of type 'SUPPDelivery' to type 'SUPPDelivery' 
        'THROW ERROR
        SetErrorMessage("<b>REFRESH/BACK DETECTED!</b> <br/> Or, this item has already been packed. <br/> Please exit wave.")
        pnlItemDetails.Visible = False
        pnlCurrent.Visible = False
        pnlWaveDetails.Visible = False
    Else 'continue pick/pack
        btnProcessSingleItem_Click(sender, e)

    End If

End Sub 
```

查看状态对象（编辑以显示原始数据）

```
Private Property CurrentSUPPDelivery() As WarehouseManager.SUPPDelivery
    Get
        Return Me.ViewState("CurrentSUPPDelivery")
    End Get
    Set(ByVal value As WarehouseManager.SUPPDelivery)
        Me.ViewState("CurrentSUPPDelivery") = value
    End Set
End Property 
```

它在 txtChange 事件的 IF 语句上引发错误。有任何想法吗？

编辑：原始堆栈数据....

> 堆栈跟踪：在 C:\Inetpub\lawsonwebapps\warehouse\mobile\SingleUnitPickPack.aspx.vb 中的 Warehouse_SingleUnitPickPack.get_CurrentSUPPDelivery()：C:\Inetpub\lawsonwebapps\warehouse\ 中 Warehouse_SingleUnitPickPack.txtPackaging_TextChanged(Object sender, EventArgs e) 的第 107 行mobile\SingleUnitPickPack.aspx.vb：System.Web.UI.WebControls.TextBox.OnTextChanged(EventArgs e) 的 System.Web.UI.WebControls.TextBox.RaisePostDataChangedEvent() 的 System.Web.UI.WebControls.TextBox 的第 249 行.System.Web.UI.IPostBackDataHandler.RaisePostDataChangedEvent() 在 System.Web.UI.Page.RaiseChangedEvents() 在 System.Web.UI.Page.ProcessRequestMain（布尔值 includeStagesBeforeAsyncPoint，布尔值 includeStagesAfterAsyncPoint）

编辑：“X” - Manager.CurrentDetails ... RAW 名称：SUPPDelivery

```
<Serializable()> Public Class SUPPDelivery

        Private _DeliveryNumber As String
        Private _OrderNumber As String
        Private _OrderLine As String
        Private _TransactionType As String
        Private _PackedQty As String
        Private _PackageNumber As String
        Private _PackageMaterial As String
        Private _OrderLineSuffix As String
        Private _ItemNumber As String
        Private _ItemLocation As String

        Public Property DeliveryNumber() As String
            Get
                Return _DeliveryNumber
            End Get
            Set(ByVal value As String)
                _DeliveryNumber = value
            End Set
        End Property

        Public Property OrderNumber() As String
            Get
                Return _OrderNumber
            End Get
            Set(ByVal value As String)
                _OrderNumber = value
            End Set
        End Property

        Public Property OrderLine() As String
            Get
                Return _OrderLine
            End Get
            Set(ByVal value As String)
                _OrderLine = value
            End Set
        End Property

        Public Property TransactionType() As String
            Get
                Return _TransactionType
            End Get
            Set(ByVal value As String)
                _TransactionType = value
            End Set
        End Property

        Public Property PackedQty() As String
            Get
                Return _PackedQty
            End Get
            Set(ByVal value As String)
                _PackedQty = value
            End Set
        End Property

        Public Property PackageNumber() As String
            Get
                Return _PackageNumber
            End Get
            Set(ByVal value As String)
                _PackageNumber = value
            End Set
        End Property

        Public Property PackageMaterial() As String
            Get
                Return _PackageMaterial
            End Get
            Set(ByVal value As String)
                _PackageMaterial = value
            End Set
        End Property

        Public Property OrderLineSuffix() As String
            Get
                Return _OrderLineSuffix
            End Get
            Set(ByVal value As String)
                _OrderLineSuffix = value
            End Set
        End Property

        Public Property ItemNumber() As String
            Get
                Return _ItemNumber
            End Get
            Set(ByVal value As String)
                _ItemNumber = value
            End Set
        End Property

        Public Property ItemLocation() As String
            Get
                Return _ItemLocation
            End Get
            Set(ByVal value As String)
                _ItemLocation = value
            End Set
        End Property

    End Class 
```

# c++ - 特征错误：please_protect_your_min_with_parentheses

> ID：13691822
> 
> 赞同：6
> 
> 时间：2012-12-03T21:13:56.280
> 
> 标签：c++, visual-studio-2010, eigen, nonlinear-optimization

我正在尝试通过运行包附带的测试代码来测试 Eigen 的非线性优化功能。

我对这些错误感到困惑（更像是困惑）：

```
Error   5   error C2039: 'please_protect_your_min_with_parentheses' : is not a member of 'std::numeric_limits<double>'  c:\program files (x86)\microsoft sdks\windows\v7.0a\include\eigen-eigen-5097c01bcdc4\unsupported\eigen\src\nonlinearoptimization\lmpar.h    184
Error   7   error C2039: 'please_protect_your_min_with_parentheses' : is not a member of 'std::numeric_limits<double>'  c:\program files (x86)\microsoft sdks\windows\v7.0a\include\eigen-eigen-5097c01bcdc4\unsupported\eigen\src\nonlinearoptimization\lmpar.h    28
Error   6   error C2065: 'please_protect_your_min_with_parentheses' : undeclared identifier c:\program files (x86)\microsoft sdks\windows\v7.0a\include\eigen-eigen-5097c01bcdc4\unsupported\eigen\src\nonlinearoptimization\lmpar.h    184
Error   8   error C2065: 'please_protect_your_min_with_parentheses' : undeclared identifier c:\program files (x86)\microsoft sdks\windows\v7.0a\include\eigen-eigen-5097c01bcdc4\unsupported\eigen\src\nonlinearoptimization\lmpar.h    28 
```

顺便说一下（我认为）导致这种情况的线路是这样的：

```
#define min(A,B) please_protect_your_min_with_parentheses 
```

并且错误指的是这一行（在上面提到的 2 个不同的地方，即第 28 行和第 184 行）：

```
const Scalar dwarf = std::numeric_limits<Scalar>::min(); 
```

任何建议都将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T21:19:58.553

它要求您将这一行改为这一行：

```
const Scalar dwarf = (std::numeric_limits<Scalar>::min)(); 
```

因此，如果`min`定义了类似函数的宏，则不会被替换。

问题是 Microsoft Windows 标头定义了`min`宏，因此包含 Windows 标头的标准 C++ 代码可能无法编译。可移植 C++ 库实现的解决方案是`min`用括号将它们对标准函数的调用包装起来，如上所述。您编译的测试代码似乎检查了代码是否使用了这种技术。

上述方法的问题在于，您将无法`min(a,b)`使用参数相关查找执行不合格的调用，因为添加括号会导致名称独立于参数进行查找。

`min`可以应用于她自己的代码的另一种解决方案是在包含任何 Windows 标头或取消定义/`max`宏之前定义 NOMINMAX 标志。这通常不是由库代码完成的，因为它们不应该调整用户代码的配置。

# c++ - （指向）错误....*叹息*

> ID：13691824
> 
> 赞同：1
> 
> 时间：2012-12-03T21:14:04.377
> 
> 标签：c++, pointers

```
// program assignment 2.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include "math.h"

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    double percentconverter;
    int playerinput;
    int years;
    double intrates;
    double answer;

    cout << " Enter initial amount:" << endl;
    cin  >> playerinput;

    cout << "Enter number of years:" << endl;
    cin  >> years;

    cout << "Enter interest rate (percent per year):" << endl;
    cin  >> percentconverter;

    intrates = percentconverter / 100;
answer = playerinput * (1 + intrates) ^ years;

    return 0;
} 
```

行“答案 = playerinput * (1 + inrates) ^ years;” 我在 playerinput 下面有一条小红线，它表示指向函数的指针……我不明白你得到那个错误，也是我的任务“编写一个程序来计算如果你最终会得到多少钱你以固定利率投资一笔钱，每年复利一次。” 我有足够信心的方程式是正确的，当我运行完成的程序时，它会按照应有的方式运行，如果我在方程式中错了，请随时留下反馈。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:17:39.710

小帽子 (^) 不是 C++ 中的幂运算，我认为您的意思是：

```
answer = pow( playerinput * (1 + intrates), years ); 
```

这会将“playerinput * (1 + inrates)”提高到“years”的幂。

哦，仅供参考 ^ = XOR，按位计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:21:56.890

`^`不是 pow 它的按位异或，所以你应该使用 pow

```
#include <math.h>
[...]
answer = playerinput * pow ((1 + intrates), years);
[...] 
```

# shell - 通过命令提示符在 Windows 中打开带空格的文件

> ID：13691827
> 
> 赞同：8
> 
> 时间：2012-12-03T21:14:30.740
> 
> 标签：shell, windows-7, command-line

我想通过脚本在其默认程序中打开一个文件（尤其是视频文件）。当我遇到带有空格的文件名时，它被视为几个参数，这并不奇怪：

```
 C:\folder>start test space.avi
  The system cannot find the file test. 
```

但是，当我用引号将文件名括起来时：

```
 C:\folder>start "test space.avi" 
```

不是在其默认程序 (VLC) 中打开文件，而是在文件目录中打开一个新的命令提示符窗口。

打开没有空格或引号的文件会按预期在 VLC 中打开文件。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-03T22:29:33.310

当第一个参数的第一个字符是引号时，我怀疑 start 会做一些特别的事情。第一个参数是窗口标题，第二个是要打开的命令/文件

```
start "" "test space.avi" 
```

[http://ss64.com/nt/start.html](http://ss64.com/nt/start.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-03T21:23:22.480

只需离开`start`，并用双引号将完整的文件名（包括任何路径）括起来。这在我的系统上运行良好：

```
C:\>"test space.avi" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T21:32:07.983

这是一个众所周知的问题（至少对我来说:-)

您必须在`CMD`脚本中使用短名称格式。要查找特定文件的短名称，请执行以下操作：

1.  打开一个`CMD`指向文件文件夹的窗口。
2.  运行命令：`$> dir /X`
3.  在中间列中，您将看到感兴趣文件的短名称。在您的特定情况下，它将类似于：TESTSP~1.AVI
4.  在你的脚本中使用这个裸名。

希望能帮助到你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-11T12:28:57.457

按照 Glen 的指示添加初始的 "" 可确保 CMD 继续并且不会进入等待模式。这在批处理文件中尤为重要。

总之：

1-打开文件并等待用户关闭它，然后再继续执行下一个命令

```
start "" "test space.avi" 
```

2-打开文件并继续下一个命令（无需等待）

```
start "" "test space.avi" 
```

根据您的需要，您可以选择 1 或 2。

# servicestack - 带有 URL 不友好字符的路径参数

> ID：13691829
> 
> 赞同：2
> 
> 时间：2012-12-03T21:14:32.003
> 
> 标签：servicestack

使用服务堆栈 3.9.21。在 IIS 7.5 中托管应用程序。使用集成的 4.0.30319 ASP.NET 应用程序池。

出于说明目的，假设我有以下路径（由 DTO 和相应的请求处理程序支持）：

```
/cars/{id} 
```

有些汽车的 id 中包含我认为必须进行 URL 编码的字符 - 管道 | 就是其中之一。当我发送请求以获取例如 id 为 '1|2' 的汽车时，我得到了一个很好的旧 500，并带有以下堆栈跟踪：

```
[ArgumentException]: Illegal characters in path.
   at System.IO.Path.CheckInvalidPathChars(String path)
   at System.IO.Path.GetFileName(String path)
   at ServiceStack.MiniProfiler.UI.MiniProfilerHandler.MatchesRequest(IHttpRequest request) in C:\src\ServiceStack\src\ServiceStack\MiniProfiler\UI\MiniProfilerHandler.cs:line 24
   at ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory.GetHandler(HttpContext context, String requestType, String url, String pathTranslated) in C:\src\ServiceStack\src\ServiceStack\WebHost.Endpoints\ServiceStackHttpHandlerFactory.cs:line 153
   at System.Web.HttpApplication.MaterializeHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

无论我是否对路径中的管道进行 URL 编码，我都会得到这个。我怎么解决这个问题？

**更多细节**

*DTO*

```
using ServiceStack.ServiceHost;

namespace SSUEB
{
    [Route("/cars/{id}", "GET")]
    public class ById
    {
        public string Id { get; set; }
    }
} 
```

*端点*

```
using System.Collections.Generic;
using System.Net;
using ServiceStack.Common.Web;
using Stack = ServiceStack.ServiceInterface;

namespace SSUEB
{
    public class Cars : Stack.Service
    {
        public object Get(ById byId)
        {
            return new HttpResult(new Dictionary<string, string> {{"id", byId.Id}}, HttpStatusCode.OK);
        }
    }
} 
```

*应用程序*

```
using ServiceStack.WebHost.Endpoints;

namespace SSUEB
{
    public class SSUEB : AppHostBase
    {
        public SSUEB() : base("ServiceStack toy service", typeof(SSUEB).Assembly)
        {
        }

        public override void Configure(Funq.Container container)
        {
            ServiceStack.Text.JsConfig.EmitCamelCaseNames = true;
            SetConfig(new EndpointHostConfig { DebugMode = true });
        }
    }
} 
```

*要求*

这个：

```
curl -v -X GET -H "Accept: application/json" http://localhost:80/dealership/cars/123%20456 
```

获得预期的 200 响应：

```
{"id":"123 456"} 
```

但是这个：

```
curl -v -X GET -H "Accept: application/json" http://localhost:80/dealership/cars/123%7C456 
```

导致最初报告的问题。

*IIS 请求日志*显示 %7C 被解码为管道并且 %20 被解码（在日志中至少作为一个加号）。后者导致 200（OK）响应，前者 - 500（内部服务器错误）。

```
2012-12-03 22:21:20 127.0.0.1 GET /dealership/cars/123|456 - 80 - 127.0.0.1 curl/7.27.0 500 0 0 5
2012-12-03 22:21:25 127.0.0.1 GET /dealership/cars/123+456 - 80 - 127.0.0.1 curl/7.27.0 200 0 0 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T09:01:03.597

我已经看过了，我们在 ServiceStack 中无能为力，因为它是由 ASP.NET 生成的预先验证的异常，请参阅[Scott Hanselman](http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx)关于如何在 IIS/ASP.NET 中允许无效字符的帖子。

注意：因为它不通过 ASP.NET，所以从这个[HttpListener 集成测试](https://github.com/ServiceStack/ServiceStack/commit/adef8e7068de8a10fc7cc094095ac4b91eeb8792)中可以看出，ServiceStack 的自主机允许这样做。

# scala - Scala 隐式任何包装器

> ID：13691831
> 
> 赞同：0
> 
> 时间：2012-12-03T21:14:40.803
> 
> 标签：scala, types, implicit-conversion, implicit

我正在尝试为我正在编写的一个简单数据库的值编写一个包装器。目前，我有一个 Value 类，它的类型是ordered 的子类型（这很重要，因为我将对这些值进行比较）。我有 Int、Double、String、Boolean 和 Date 类型的隐式包装器。我的问题是，当我尝试将 Any 类型的内容包装在 Value 中时，我收到一个错误。

这是我的价值课程：

```
case class Value[A <% Ordered[A]](value: A) extends Ordered[Value[A]] {

  def matches(otherType: A): Boolean = {
    if(value.getClass == otherType.getClass)
      true
    else false
  }

  override def toString() = {
    value.toString
  }

  def compare(other: Value[A]) = value compare other.value
}

object Value {
  implicit def intVal(some: Int) = new Value[Int](some) {
    def compare(other: Int): Int = value compare other
  }
  implicit def doubleVal(some: Double) = new Value[Double](some) {
    def compare(other: Double): Int = value compare other
  }
  implicit def stringVal(some: String) = new Value[String](some) {
    def compare(other: String): Int = value compare other
  }
  implicit def boolVal(some: Boolean) = new Value[Boolean](some) {
    def compare(other: Boolean): Int = value compare other
  }
  implicit def dateVal(some: Date) = new Value[Date](some) {
    def compare(other: Date): Int = value.compareTo(other)

    override def toString() = {
      var formatter = new SimpleDateFormat("dd/MM/yyyy")
      formatter.format(value)
    }
  }
//  implicit def anyVal(some: Any) = new Value[Any](some){
//    def compare(other: Any) = {
//      
//    }
//  }

  var x = new Value(0)
} 
```

从另一个类中，我有一个 List[Any] ，我想将其包装为一个值（我知道 Any 是正确的类型之一）。不幸的是，我无法将 Any 包装在一个值中，因为它不是 Ordred 类型。

此外，如果我可以使用泛型 Value 作为类型参数，我的问题将得到解决，但我遇到了问题：

我知道将值放入参数中会更有意义，但是当我将值解析到程序中时，我无法解析类型

例如我想做：

```
def integer: Parser[Value] = """\d+""".r ^^ {x => Value(augmentString(x).toInt)} 
```

但是，它抱怨 Parser[Value] 需要一个类型。这不是问题，因为我可以创建类型 [Value[Int]] 但是，当我有这样的组合器方法时：

```
def value: Parser[Value[Something]] =  integer ||| real | date 
```

或者

```
def getSome(some: Value[Something]) 
```

我没有包含所有五种可能类型的通用值。

我正在尝试的事情有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T21:52:24.857

也许您可以使用一种在 scala 中对不相交联合类型进行编码的方法（请参阅：[Does Scala have “type disjunction”（union types）？](https://stackoverflow.com/questions/3508077/does-scala-have-type-disjunction-union-types)）

例如，如果您使用[“口吃或”](http://cleverlytitled.blogspot.it/2009/03/disjoint-bounded-views-redux.html)方法，您可以定义：

```
case class Value[A <% Ordered[A] <% String or Int or Double or Boolean](value: A) extends Ordered[Value[A]] {

  def matches(otherType: A): Boolean = {
    if(value.getClass == otherType.getClass)
      true
    else false
  }

  override def toString() = {
    value.toString
  }

  def compare(other: Value[A]) = value compare other.value
} 
```

然后你可以有：

```
def integer[T <% Value[T]] = """\d+""".r ^^ {x => Value(augmentString(x).toInt)} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:13:02.907

为了`def value: Parser[Value[Something]] = integer ||| real | date`工作，你真的需要像..

```
trait Value
case class StringValue(s: String) extends Value
case class IntValue(i: Int) extends Value
case class DateValue(d: Date) extends Value 
```

# linux - 计算标准输入中的字数和行数

> ID：13691834
> 
> 赞同：2
> 
> 时间：2012-12-03T21:14:54.747
> 
> 标签：linux, bash, unix, pipe, pipeline

我如何使用 STANDARD UNIX UTILITIES 编写一个程序，该程序一次从标准输入读取一个字符并将结果输出到标准输出。我知道在这种情况下它的运行类似于 C 程序。有人告诉我这可以在一行代码中完成，但从未做过 Unix 管道编程，所以我只是好奇。**该程序的目的是从标准输入读取数据并计算每行的字数，并在标准输出中输出总字数和行数**

我想出了以下代码，但我不确定：

`tr A-Z a-z < file | tr -sc a-z | sort uniq -c wc '\n'`

关于如何获得我想要的东西的任何想法或建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-03T22:04:09.343

您可以使用`wc` *(word count)*选项来计算文件中的`-w`字数或`-l`行数。

```
$ cat file.txt
this file has 5 words.

$ wc -w file.txt             # Print number of words in file.txt
5 file.txt

$ wc -l file.txt             # Print number of lines in file.txt
1 file.txt

$ wc file.txt                # No option, print line, words, chars in file.txt
 1  5 23 file.txt 
```

其他选项`wc`：

```
 -c, --bytes            print the byte counts
  -m, --chars            print the character counts
  -l, --lines            print the newline counts
  -L, --max-line-length  print the length of the longest line 
```

# css - 我想使用 img sprites 但我不确定是否可行

> ID：13691835
> 
> 赞同：0
> 
> 时间：2012-12-03T21:14:55.717
> 
> 标签：css

我想使用图像精灵来提高性能，但在这种情况下我该怎么做？

我有一个使用带有锚标签的 div 的平铺布局，现在我为每个图像都有一个类，将其放置在平铺锚标签上的某个位置。每个图块的图像位置不会相同。

如果我使用精灵，我将如何在图块中唯一地定位图像？通过设置 xy 坐标，我只是设置图像在精灵上的位置，而不是它应该在 div 中的位置，对吗？

示例 HTML：

```
<div class="tileFlip"> 
    <a class="size4 red i-projects">
        <h1>Project Portfolio</h1>
    </a>
</div> 
```

示例 CSS：

```
.i-projects {
    background-image: url('../../../img/icons/projects.png');
    background-repeat: no-repeat;
    background-position: 49% 80%;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:17:23.617

您在正确的轨道上，您需要做的就是声明位置差异。

```
.i-projects {
    background-image: url('../../../img/icons/projects.png');
    background-repeat: no-repeat;
    display:block;
    background-position: 49% 80%;
}

.i-projects .green{
    background-position: 69% 40%;
} 
```

对于此类应用程序，位置通常以像素表示，它们指的是背景精灵的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:17:42.037

如果图块要动态更改，则必须使用 Javascript 来动态调整 CSS。例如，使用 jQuery 你可以这样做：

```
$(oneOfThoseDivs).css({
    backgroundImage: 'url("../../../img/icons/projects.png")',
    backgroundRepeat: "no-repeat",
    backgroundPosition: "49% 80%"
}); 
```

# sql - 更改 SharePoint 列表的主键？

> ID：13691840
> 
> 赞同：3
> 
> 时间：2012-12-03T21:15:22.037
> 
> 标签：sql, sharepoint, database-design, ms-access-2010

我有三个链接到 Access 2010 数据库的 SharePoint 列表。我正在尝试编写一个查询，该查询将从每个表中提取不同的数据列并将它们一起显示。我想更改列表的主键，以便不是 1、2、3 等，而是某个代码（16435、15350 等）。五位数的代码在每个表中都是标准的，我认为如果这是主键，那么提取数据会更容易。

如何在 SharePoint 中更改它？甚至可能吗？每次我尝试在 Access 中更改它时，它都会告诉我它无法完成，因为它是一个链接表。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T21:03:48.807

主键是自动分配的，遗憾的是无法更改。

# java - 字符串缓冲区问题

> ID：13691842
> 
> 赞同：-1
> 
> 时间：2012-12-03T21:15:32.343
> 
> 标签：java, fileoutputstream, stringbuffer

我写了一个代码，让用户可以像文本编辑器一样在文本区域打开文本文件并输入新字符。编辑大文件并输入大量字符时似乎存在容量问题，文件没有得救。我试过 StringBuffer stuff.ensureCapacity(10000); 仍然没有工作。我想知道问题是在保存到文件时还是在我的文本区域中修改时？我有这样的事情：

```
 java.lang.StringBuffer text = new java.lang.StringBuffer();
  //some code here

  File myFile = new File(filename);
  DataInputStream dis = new DataInputStream(new FileInputStream (myFile));

    while((data = dis.readLine()) != null)
    {
      text.append(data+"\n");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:41:32.643

一些指针。

*   您无需指定`java.lang.`
*   如果可以使用 StringBuilder，请不要使用 StringBuffer
*   最重要的是，不要混合文本和二进制，因为这会导致混淆。

如果您想将整个文件作为字符串读取，我建议在 Java 7 中使用

```
Path path = FileSystems.getDefault().getPath("logs", "access.log");
String text = new String(Files.readAllBytes(path), "UTF-8"); 
```

或使用 Apache Commons IO [FileUtils](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html)

```
String text = FileUtils.readFileToString(new File(filename)); 
```

# java - 如何将此 Struts2 转换为 displaytag（日期比较）

> ID：13691846
> 
> 赞同：0
> 
> 时间：2012-12-03T21:16:06.400
> 
> 标签：java, struts2, displaytag

我有 Struts2 代码根据这样的日期比较结果显示一个按钮（请注意，这是我实际拥有的简化示例）：

```
<s:iterator value="myList">
    <s:if test="%{getDate().compareTo(getNow()) > 0}">
        // Show the item
    </s:if>
</s:iterator> 
```

我已经将结果集的显示转换为使用 displaytag。我将如何使用显示标签进行上述操作。这是我尝试过的。

```
<display:table name="myList" pagesize="50" id="row">
    <display:column title="Item">
        <s:if test="%{#attr.row.endDt.compareTo(#attr.row.now()) > 0}"><%--does NOT work--%>
    </display:column>
</display:table> 
```

该语句的正确语法是`<s:if>`什么？
或者这不能使用 displaytag + Struts2 来完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:54:04.843

另一种方法是使用 displaytag 装饰器。

```
 public String getLink()
 {
    YourObject yourObject = (YourObject) getCurrentRowObject();
    //Do your checks....
    return "<a href="#">your link</a>";

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T08:46:44.340

使用`#attr.row`as 索引来引用列表中的元素应该可以工作：

```
<display:table name="myList" pagesize="50" id="row">
    <display:column title="Item">
        <s:if test="myList[%{#attr.row_rowNum - 1}].endDt.compareTo(myList[%{#attr.row_rowNum - 1}].now()) > 0}">
           <span>Let's rock</span>
        </s:if>
    </display:column>
</display:table> 
```

注意：是`getNow()`来自迭代对象的函数吗？

这对我来说似乎很奇怪，它不应该是来自 example 的 baseAction 的常用功能吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T15:46:58.450

可能有多种解决方案，但这最终对我有用：

```
<display:table name="myList" pagesize="50" id="row">
    <display:column title="Item">
        <s:set name="endDt" value="#attr.row.endDt"/>
        <s:set name="now" value="now" />
        <s:if test="%{#endDt.compareTo(#now) > 0}">
           <span>w00 h00!</span>
        </s:if>
    </display:column>
</display:table> 
```

# vbscript - 我可以在不登录的情况下在我的服务器上运行无人值守的 vb 脚本吗？

> ID：13691847
> 
> 赞同：1
> 
> 时间：2012-12-03T21:16:19.723
> 
> 标签：vbscript

我有一个在我的服务器上运行的 vbscript，并在将文件添加到某个目录时通过 telnet 发送电子邮件。该脚本持续运行，但是如果我没有通过 RemoteDesktop 登录，它将不会执行 telnet 命令。

任何人都可以建议一种在我未登录时执行此脚本的方法吗？

```
Option Explicit 
Dim fso, count, src, folder, file, ncount, cloner 
Set fso = CreateObject("Scripting.FileSystemObject") 
Set cloner = CreateObject("WScript.Shell")
src = "F:/serverfolders/public/camera" 
Set folder = fso.GetFolder(src) 
count = 0 
For Each file In folder.files 
  If LCase(fso.GetExtensionName(file)) = "mp4" Then 
  count = count + 1 
End If 
Next
ncount = count
WScript.Echo "Initial Count: " & count 

Do 

count = 0 
For Each file In folder.files 
  If LCase(fso.GetExtensionName(file)) = "mp4" Then 
  count = count + 1 
  End If
  If LCase(fso.GetExtensionName(file)) = "x" Then Exit DO
Next
if count > ncount then 
  Call Alarm()
  ncount = count
End If
WScript.Sleep 10000
Loop

Sub Alarm
cloner.run"cmd",1,false
WScript.Sleep 1000

cloner.SendKeys"telnet smtp.1and1.com 587"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.AppActivate "telnet smtp.1and1.com"
WScript.Sleep 1000

cloner.SendKeys"EHLO ****.com"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"auth login"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"password"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"password2"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"MAIL FROM: ****.com"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"RCPT TO: ****.com"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"DATA"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"Subject:Motion Alarm Detected"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"Motion Alarm Detected"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys"."
cloner.SendKeys("{Enter}")
WScript.Sleep 2000

cloner.SendKeys"quit"
cloner.SendKeys("{Enter}")
WScript.Sleep 1000

cloner.SendKeys("{Enter}")
WScript.Sleep 10000

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T07:07:13.240

您可以通过以下两种方式之一执行此操作： 1)使用[命令行程序](http://support.microsoft.com/kb/251192)[SC.EXE](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/sc.mspx)[创建新的 Windows 服务](https://stackoverflow.com/questions/10885976/create-windows-service-with-current-user-account-using-sc-exe?rq=1)。该服务将配置为运行您的脚本，并且需要使用特定帐户（新帐户或现有帐户）。您将使用 script.vbs 作为可执行文件。

2)[计划任务](http://support.microsoft.com/kb/308569)。

# c++ - 霍夫曼代码，树的初始输入有问题

> ID：13691850
> 
> 赞同：0
> 
> 时间：2012-12-03T21:16:33.630
> 
> 标签：c++, huffman-code

我正在编写一个代码，该代码采用诸如“abracadabra”之类的词并将其变成一棵霍夫曼树。我了解霍夫曼树的原理，但我现在陷入困境的是我将如何首先在其中实现 abracadabra。

我的老师告诉我们的方法是有两个单独的队列/数组。第一个存储每个字母的数量，另一个按数量（从高到低）的顺序存储字母，当字母具有相同的值时，它们按字母顺序排序。

所以它会导致： 5,2,2,1,1 和 a,b,r,c,d 我很确定他希望我们使用队列，但我不知道如何处理这个简单的部分代码..

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:46:44.313

我想不出你为什么会被要求用那种形式来写它，但是在我的脑海中，我会这样做：

```
初始化计数和字母的两个队列。

对于输入中的每个字母：
 在字母队列中搜索字母。
 如果发现
   将 count 设置为 count-queue + 1 中的相应值
   从两个队列中删除
 别的
   将计数设置为 1
 将字母添加到正确位置的两个队列中

```

完成后，您有一个按正确顺序排列的队列来构建您的树。

对我来说感觉像是在滥用队列，但如果那是你被要求做的......

编辑：这就是我可能实际写它的方式，没有队列等。

```
unsigned char input[]="abracadabra";
int counts[256];
memset(counts, 0, 256 * sizeof(int));

unsigned char i;
unsigned char *pt = input;
int max = 0;
while(i = *pt++)
{
    counts[i]++;
    if(counts[i] > max) max = counts[i];
}

while(max)
{
    int nmax = 0;
    for(int c = 0 ; c < 256 ; c++)
    {
        if(counts[c] < max && counts[c] > nmax) nmax = counts[c];
        if(counts[c] == max)
        {
            printf("%c: %d\n", c, max);
        }
    }
    max = nmax;
} 
```

# solr - 如何在 Solr 中搜索 C# 或 C++

> ID：13691854
> 
> 赞同：0
> 
> 时间：2012-12-03T21:16:45.877
> 
> 标签：solr, full-text-search

我想知道每次搜索“C#”时使用哪个分析器或如何阻止 solr 删除 #（磅），它只是查找“C”，然后删除磅，我使用的是 edismax 查询解析器。

# java - Java 服务器端 UnitTesting GCM 的结果

> ID：13691855
> 
> 赞同：3
> 
> 时间：2012-12-03T21:16:50.080
> 
> 标签：java, junit, mockito, google-cloud-messaging

我正在使用 GCM（Google Cloud Messaging）向 Android 应用发送通知。我的服务器使用的是 Google 提供的`gcm-server.jar`，我正在关注[文档](http://developer.android.com/google/gcm/gcm.html#server)。我能够毫无问题地向设备发送通知。

现在我正在尝试根据从私有方法返回的[`Result`](http://developer.android.com/guide/google/gcm/server-javadoc/index.html)([源](https://gist.github.com/4197940)) 对业务逻辑进行单元测试。`PushNotificationDaoGcmImpl``sendNotificationToServer`

我知道由于它是一个类`Result`而不能被模拟，并且由于没有公共构造函数而简单地将其实例化是行不通的。内部类在外部无法访问，因此我无法以这种方式构建对象。 `final``new Result()``Result``Builder``package com.google.android.gcm.server;`

我没有找到一个好方法来创建一个`Result`从[`Sender`](http://developer.android.com/guide/google/gcm/server-javadoc/index.html)( [source](https://gist.github.com/4198106) ) 返回的内容。

我的问题是我将如何进行`PushNotificationDaoGcmImpl`基于 处理某些条件的单元测试`Result`？

```
public class PushNotificationDaoGcmImpl{

    //method I'm trying to test
    public void sendPushNotification(){
        // builds message to send

        Result result = this.sendNotificationToServer(gcmMessage, deviceToken)

        //handle result's error conditions
    }

    //method call I'm trying to mock
    private Result sendNotificationToServer(Message gcmMessage, String deviceToken){
        return gcmSender.send(gcmMessage, deviceToken, 1);
    }
}   

//test snipet
@Test
public void testSendNotificationToServer () throws Exception {
    Result result = new Result();

    PushNotificationMessage message = new PushNotificationMessage("123", "Test", "deviceToken", "Android");

    //Having issue with how to handle Result here
    doReturn(result).when(gcmPushNotificationDaoSpy).sendNotificationToServer(any(Message.class), anyString());

    PushNotificationResult result = gcmPushNotificationDaoSpy.sendPushNotification(message);

    //verify business logic was correct based on Result
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:27:14.183

您还可以在 com.google.android.gcm.server 包中创建一个 MockResult 类，它可以让您访问 Builder。

```
package com.google.android.gcm.server;

class MockResult {

    public static Result mockResult(...) {
      // Use Builder here to construct Result
    }

} 
```

对我来说，这感觉比处理反射更容易管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T21:40:31.657

我想到的解决方案是使用反射来创建`Result`对象。我不确定这是否是一种好方法，但我能够根据不同的`Result`错误代码测试业务逻辑。

```
@Test
public void testSendNotificationToServer () throws Exception {
    String successIndicator = null;
    Result result = buildFauxResult("messageId", "deviceToken", successIndicator);

    PushNotificationMessage message = new PushNotificationMessage("123", "Test", "deviceToken", "Android");

    //Having issue with how to handle Result here
    doReturn(result).when(gcmPushNotificationDaoSpy).sendNotificationToServer(any(Message.class), anyString());

    PushNotificationResult result = gcmPushNotificationDaoSpy.sendPushNotification(message);

    //verify business logic was correct based on Result
}

public Result buildFauxResult (String messageId, String canonicalRegistrationId, String errorCode) throws Exception {
           Class <?> builderClass = Class.forName("com.google.android.gcm.server.Result$Builder");
           Constructor <?> builderConstructor = builderClass.getDeclaredConstructors()[0];
           ReflectionUtils.makeAccessible(builderConstructor);
           Object builderObject = builderConstructor.newInstance();

           Method canonicalRegistrationIdMethod = builderClass.getMethod("canonicalRegistrationId", String.class);
           ReflectionUtils.makeAccessible(canonicalRegistrationIdMethod);
           builderObject = ReflectionUtils.invokeMethod(canonicalRegistrationIdMethod, builderObject, canonicalRegistrationId);

           Method messageIdMethod = builderClass.getMethod("messageId", String.class);
           ReflectionUtils.makeAccessible(messageIdMethod);
           builderObject = ReflectionUtils.invokeMethod(messageIdMethod, builderObject, messageId);

           Method errorCodeMethod = builderClass.getMethod("errorCode", String.class);
           ReflectionUtils.makeAccessible(errorCodeMethod);
           builderObject = ReflectionUtils.invokeMethod(errorCodeMethod, builderObject, errorCode);

           Method buildMethod = builderClass.getMethod("build");
           ReflectionUtils.makeAccessible(buildMethod);

           return (Result) ReflectionUtils.invokeMethod(buildMethod, builderObject);
    } 
```

# windows - 如何使用硬件视频缩放器？

> ID：13691857
> 
> 赞同：10
> 
> 时间：2012-12-03T21:17:02.563
> 
> 标签：windows, image, video, directx, video-processing

现代显卡具有硬件视频缩放器，例如作为 AMD Avivo、NVIDIA PureVideo 或 Intel ClearVideo 的一部分。例如，AMD 的[Avivo 白皮书](http://www.ati.com/technology/avivo/pdf/Avivo_Display_Engine_Whitepaper_v2_final.pdf)说：

> “图像输出缩放器支持多达 6 个垂直滤波器抽头和多达 10 个水平滤波器抽头。这些缩放器是高度可编程的高精度多相缩放器；它们适用于几乎任何比例的放大，或最多 4 个缩小：1。”

问题： **如何在 Windows 程序中使用视频缩放器硬件？**

假设已经存在解码的视频帧，例如在 a`IDirect3DSurface9`中，目标是使用硬件缩放器在屏幕上显示该视频帧。如果可能，我想使用像 Media Foundation 或 DirectShow 这样的 Windows API，而不是供应商特定的 API。我主要对以1.5-3**倍**左右的相当大的因子进行升级感兴趣。

第二个问题是，如何控制视频缩放器的硬件参数？（例如上面提到的多相滤波器中的滤波器系数）

**编辑：**赏金开始了。请提供在视频卡中使用视频缩放器硬件的任何方式的示例（这可能是特定于供应商的，或使用任何版本的 DirectX/DirectShow/Media Foundation API）。

**编辑：**更新：使用视频缩放器硬件的一些程序示例：WinDVD、PowerDVD、madVR。我想知道如何完成他们的工作，即使用 GPU 的内置视频硬件缩放器，*而不是*使用 D3D 着色器和纹理采样器实现的缩放器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:16:40.720

一些可能的方法是：

1.  用于`MFCreateVideoRenderer`创建 EVR 媒体接收器，调用[IMFVideoDisplayControl::SetRenderingPrefs](http://msdn.microsoft.com/en-us/library/windows/desktop/ms698981%28v=vs.85%29.aspx)并`MFVideoRenderPrefs_AllowScaling`设置标志（或使用`IMFAttributes`并设置`EVRConfig_AllowScaling`属性），然后调用[IMFVideoDisplayControl::SetVideoPosition](http://msdn.microsoft.com/en-us/library/windows/desktop/ms697352%28v=vs.85%29.aspx)来定义结果的缩放方式。这是增强型视频渲染器 (EVR) 的一部分。

2.  使用[IDirectXVideoProcessor::VideoProcessBlt](http://msdn.microsoft.com/en-us/library/windows/desktop/ms697022%28v=vs.85%29.aspx)并设置`DXVA2_VideoProcessBltParams::ConstrictionSize`来定义结果的缩放方式。这也是基于 EVR/DXVA。

3.  （ananthonline 建议）使用[Video Resizer DSP](http://msdn.microsoft.com/en-us/library/windows/desktop/ff819491%28v=vs.85%29.aspx)并使用`IWMResizerProps::SetFullCropRegion`（或`MFPKEY_RESIZE_DST_WIDTH`和`MFPKEY_RESIZE_DST_HEIGHT`）缩放结果。这既是 DirectX 媒体对象 (DMO) 又是媒体基础转换 (MFT)。注意：视频MFT有属性[MF_SA_D3D_AWARE](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162889%28v=vs.85%29.aspx)可以用来查询是否支持DirectX 3D硬件加速，可以通过发送`MFT_MESSAGE_SET_D3D_MANAGER`消息来启用。

4.  使用[Video Processor MFT](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162913%28v=vs.85%29.aspx)并设置`IMFVideoProcessorControl::SetConstrictionSize`缩放结果。这是一个 MFT。

5.  使用 DirectX 3D 设备并调用`StretchRect`以缩放表面。注意：这很明显不使用*视频缩放器*硬件，它使用纹理采样器硬件。可以在具有类似效果的四边形上渲染纹理。

我仍然不确定这些方法中的哪一种（如果有的话）使用视频缩放器硬件。至少方法 1 和 2 可能会，因为它们直接与 EVR/DXVA 相关联；方法 3 和 4 如果它们被 DXVA 加速也可能。仍然需要一个明确的答案，最好是参考文档和/或代码示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T21:57:21.307

仅访问硬件 - Direct2D（Direct3D 可能是更好的选择）就可以了。但是要访问视频缩放器，您需要使用 DirectShow 或 Windows Media Foundation（我并没有真正使用过很多）。

AFAIK - “Resizer DMO”过滤器将访问正确的硬件并为您执行视频调整大小。[这](http://alax.info/blog/1371)是使用此过滤器的代码示例。

**编辑：**如果您使用 MFT，[视频处理器过滤器](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162913%28v=vs.85%29.aspx)也应该同样有效。如文档中所述，“视频处理器支持使用 Microsoft Direct3D 11 的 GPU 加速视频处理。有关详细信息，请参阅[MF_SA_D3D11_AWARE](http://msdn.microsoft.com/en-us/library/windows/desktop/hh162889%28v=vs.85%29.aspx)。”

另请参阅[有关](http://msdn.microsoft.com/en-us/library/windows/desktop/dd940330%28v=vs.85%29.aspx#attributes)硬件 MFT 属性的部分，尤其是[MFT_ENUM_HARDWARE_URL_Attribute](http://msdn.microsoft.com/en-us/library/windows/desktop/dd388664%28v=vs.85%29.aspx)，它**可以让您检查 MFT 是否在硬件中实现**。[请注意，](http://en.wikipedia.org/wiki/DirectX_Video_Acceleration#DXVA_on_Windows_Vista_and_later) DXVA 与 Media Foundation 集成并将其功能公开为 MFT。所以在硬件上实现的MFT最有可能是使用底层硬件，是Windows自己使用的方法。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:06:27.893

[Direct2D](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370987%28v=vs.85%29.aspx)是 Microsoft 获得对图形硬件的访问权的方式，尽管是间接的。[Direct2D 转换](http://msdn.microsoft.com/en-us/library/windows/desktop/dd756655%28v=vs.85%29.aspx)进行缩放。您无法直接控制视频缩放器，但必须相信驱动程序会为您选择正确的设置。

# drupal - Drupal + Commerce - 一个 SKU

> ID：13691860
> 
> 赞同：0
> 
> 时间：2012-12-03T21:17:12.727
> 
> 标签：drupal, drupal-commerce, commerce

例如，我有一种产品具有多种属性（各种颜色和尺寸的 T 恤）。我可以为所有颜色指定一个 SKU 吗？我在官方论坛上问过这个问题 - 但没有运气，没有答案。我已经在 Commerce 支持处张贴了票——他们告诉我使用 Commerce 可定制产品——我不知道如何使用这个模块。也许有人有解决方案？我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-28T23:22:14.140

两种产品的 SKU 永远不会相同。他们应该保持独一无二。

详细信息可以在[https://drupal.stackexchange.com/a/54047/10021上找到](https://drupal.stackexchange.com/a/54047/10021)

PS Drupal 相关问题应该去[https://drupal.stackexchange.com/](https://drupal.stackexchange.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-08T14:56:39.327

您可以做的一件事是创建一个选项集。因此，您创建了一个产品“T-SHIRT”，并且您有一个字段选项集，允许您选择衬衫的颜色和尺寸。

[https://www.drupal.org/project/commerce_option](https://www.drupal.org/project/commerce_option)

如果你需要这些不同的选项有不同的价格，你也可以使用定价属性模块。

[https://www.drupal.org/project/commerce_product_attributes](https://www.drupal.org/project/commerce_product_attributes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T07:11:38.610

我相信您只有一种产品称为 T 恤，但产品属性不同。所以一个产品只能有一个 sku 同一产品不能有一个 2 个 sku。如果您想要不同的 sku，请将其创建为两个单独的产品。

# jquery - 我如何用鼠标在父级中找到子级 div，div 只有一个类名

> ID：13691866
> 
> 赞同：1
> 
> 时间：2012-12-03T21:17:28.803
> 
> 标签：jquery, class, html, mouse

抱歉，如果这已经被问过了，但我找不到我需要的确切解决方案。

我是 jquery 的菜鸟，正在制作报纸版面表格。我可以使用此代码在布局画布中创建新的 div 而不会出现问题

```
function makeSplashBlockdiv() {
    $("#canvas").append('<div class="SplashBlock" class="bar">Splash Block 700X250</div>')
    $(".SplashBlock").draggable({
        containment: "#canvas",
        scroll: false,
        grid: [10, 10]
    }, {
        cursor: "move",
        cursorAt: {
            top: 125,
            left: 350
        }
    })
}​ 
```

还有其他不同大小和类名的 div。我没有使用 id，因为程序可以创建多个相同类型的 div，所以 id

所有这些 div 都放在一个名为`#canvas`.

我需要能够用鼠标选择一个 div 并将其删除，我可以找到最接近的 div 与此代码但没有任何反应。

```
$("#canvas").click(function(event) {
    $("#log").html("clicked: " + event.target.className); 
```

我知道应该有一个点击处理程序，但我无法弄清楚这部分。

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:20:27.167

将 click 事件绑定到 div 的类，而不是保存它们的画布。

例如

```
$(".divclass").click(function(){}); 
```

这样你就可以`$(this)`用来访问点击的 div 并删除它

例如

```
$(".divclass").click(function(){
   $(this).remove()
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:23:13.590

几个选项供您选择：

1)[`closest`](http://api.jquery.com/closest)用于`event.target`：

```
$("#canvas").click(function(event) {
    var theDiv = $(event.target).closest('div');
    // ...
}); 
```

这将找到鼠标单击的 div。`closest`从集合中的元素开始并找到与选择器匹配的第一个元素，并根据需要通过父元素进行处理。

2) 或者，您可以通过以下方式让 jQuery 为您执行此操作，方法是将您的`click`处理程序更改为显式使用事件委托[`delegate`](http://api.jquery.com/delegate)：

```
$("#canvas").delegate("div", "click", function(event) {
    var theDiv = $(this);
    // ...
}); 
```

在较新版本的 jQuery 中，您可以[`on`](http://api.jquery.com/on)改用（注意参数的顺序更改）；

```
$("#canvas").on("click", "div", function(event) {
    var theDiv = $(this);
    // ...
}); 
```

...虽然我个人更喜欢`delegate`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:25:41.000

以下将为`selected`所有单击的 div 添加一个类。

```
function makeSplashBlockdiv() {
    var $myNewDiv = $('<div class="SplashBlock" class="bar">Splash Block 700X250</div>');

    $myNewDiv.click(function () {
        $(this).addClass("selected");
    });

    $("#canvas").append($myNewDiv);

    $(".SplashBlock").draggable({
        containment: "#canvas",
        scroll: false,
        grid: [10, 10]
    }, {
        cursor: "move",
        cursorAt: {
            top: 125,
            left: 350
        }
    });
}​ 
```

然后你可以通过`$("#canvas .selected")`.

# ruby - 301 在 S3 上传后永久移动

> ID：13691881
> 
> 赞同：12
> 
> 时间：2012-12-03T21:18:45.587
> 
> 标签：ruby, amazon-s3, ruby-on-rails-3.2, carrierwave, fog

我尝试使用carrierwave和fog gems将图像上传到Ruby on Rails上的S3，图像上传正确但是当我尝试保存包含有关刚刚上传的图像信息的模型时，我收到此错误：

```
Excon::Errors::MovedPermanently in UserController#show
app/models/user.rb:46:in `process_image_with_key'
app/controllers/user_controller.rb:12:in `show'

<Excon::Response:0x007f97846a3c18 @body="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Error><Code>PermanentRedirect</Code><Message>The bucket you are attempting to access must be addressed using the specified endpoint. Please send all future requests to this endpoint.</Message> 
```

用户型号：

```
mount_uploader :image, AvatarUploader

def image_name
  File.basename(image.path || image.filename) if image
end

def process_image_with_key( key )
  unless key.nil?
    self.key = key
    self.remote_image_url = self.image.direct_fog_url(with_path: true)
    self.save!
  end
end 
```

头像上传者：

```
# encoding: utf-8

class AvatarUploader < CarrierWave::Uploader::Base

  include CarrierWaveDirect::Uploader

  include CarrierWave::RMagick

  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:
  include Sprockets::Helpers::RailsHelper
  include Sprockets::Helpers::IsolatedHelper

  include CarrierWave::MimeTypes
  process :set_content_type

  version :thumb do
    process resize_to_fill: [50, 50]
  end

end 
```

用户控制器

```
def show
  @user = User.find_by_id(params[:id])
  @user.process_image_with_key(params[:key])
  @uploader = User.new.image
  @uploader.success_action_redirect = user_url(@user.id)
end 
```

载波初始化器

```
CarrierWave.configure do |config|
  config.fog_credentials = {
    :provider               => 'AWS',
    :aws_access_key_id      => ENV['AWS_ACCESS_KEY_ID'],
    :aws_secret_access_key  => ENV['AWS_SECRET_ACCESS_KEY'],
    :region                 => 'us-west-1'
  }
  config.fog_directory  = ENV['AWS_FILE_BUCKET']
  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}
end 
```

宝石文件

```
gem 'carrierwave'
gem 'rmagick'
gem 'fog'
gem 'carrierwave_direct' 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-04T13:02:21.933

```
<Error><Code>PermanentRedirect</Code><Message>The bucket you are attempting to access
must be addressed using the specified endpoint. Please send all future requests to 
this endpoint.</Message></Error> 
```

这是一个经常遇到的问题：您正在尝试访问区域*us-west-1*中的存储桶，但是，由于遗留原因，大多数/所有[AWS 开发工具包中的默认](http://aws.amazon.com/code)[Amazon S3](http://aws.amazon.com/s3/)区域是*US Standard*，它会*自动将请求路由到 Northern 的设施使用网络地图的弗吉尼亚或太平洋西北部*（有关详细信息，请参阅[区域和端点](http://docs.amazonwebservices.com/general/latest/gr/rande.html#s3_region)）。

 **因此，您只需在使用 S3 API 之前明确指定存储桶区域的端点，例如*us-west-1*：

```
 config.fog_credentials = {
    :provider               => 'AWS',
    :aws_access_key_id      => ENV['AWS_ACCESS_KEY_ID'],
    :aws_secret_access_key  => ENV['AWS_SECRET_ACCESS_KEY'],
    :region                 => 'us-west-1'
    :endpoint               => 'https://s3-us-west-1.amazonaws.com/'
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T21:13:17.203

再次感谢[史蒂芬欧宝](https://stackoverflow.com/users/45773/steffen-opel)！

但是我没有考虑到，我的地区是美国标准，因此，我的载波初始化程序如下所示：# :region => # NOT NEEDED BY US STANDARD :endpoint => ' [https://s3.amazonaws.com](https://s3.amazonaws.com) '

这个[链接](http://docs.amazonwebservices.com/general/latest/gr/rande.html#s3_region)是关键：D**

# c# - 将项目添加到列表

> ID：13691882
> 
> 赞同：0
> 
> 时间：2012-12-03T21:18:46.657
> 
> 标签：c#

我有一份学生名单和一份成绩单。我想根据输入的id添加学生分数，然后查看记录。我没有正确实施它。有人可以告诉我如何正确地做到这一点吗？这是我想要实现的输出：1）添加学生 2）添加标记：将要求用户输入 id 并根据 id 如果存在，则将根据该 id 存储标记。3）查看分数：查看学生ID和他的分数

```
class Student
{     
    public Student(string name, string surname, string dob, string address)
    {
        this.Name = name;
        this.Surname = surname;
        this.DOB = dob;
        this.Address = address;
    }

    public List<Marks> studentId = new List<Marks>();
    public List<Marks> Mathematics = new List<Marks>();
    public List<Marks> English = new List<Marks>();
    public List<Marks> Maltese = new List<Marks>();
    public List<Marks> ReligiousStudies = new List<Marks>();
    public List<Marks> SocialStudies = new List<Marks>();

    public string Name { get; set; }
    public string Surname { get; set; }
    public string DOB { get; set; }
    public string Addr { get; set; }
    public string Id { get; set; }

    public Student(string s)
    {
        string[] splitted = s.Split(',');
        name = splitted[0];
        surname = splitted[1];
        dob = splitted[2];
        address = splitted[3];
        id = splitted[4];          
     }

    public void AddMarks(string id, int hyexam, int anexam)
    {
        if (Id.Equals(id))
        {
            studentId.Add(new Marks(id));
            Mathematics.Add(new Marks(hyexam, anexam));
            English.Add(new Marks(hyexam, anexam));
            Maltese.Add(new Marks(hyexam, anexam));
            ReligiousStudies.Add(new Marks(hyexam, anexam));
            SocialStudies.Add(new Marks(hyexam, anexam));
        }
        else
        {
            Console.WriteLine("id not found");
        }
    }

    public void StudMarks()
    {
        foreach (Marks mrk in studentId)
        {
            Console.WriteLine(mrk);
        }
        foreach (Marks mrk in Mathematics)
        {
            Console.WriteLine(mrk);
        }

        foreach (Marks mrk in English)
        {
            Console.WriteLine(mrk);
        }

        foreach (Marks mrk in Maltese)
        {
            Console.WriteLine(mrk);
        }

        foreach (Marks mrk in ReligiousStudies)
        {
            Console.WriteLine(mrk);
        }            
     }           
   }
}

public class ClassYear 
{               
    private const string filestud = "C:\\Users\\Maria\\Desktop\\Students\\stud.txt";    
    public string Year { get; set; }
    public List<Student> mystudent=new List <Student> ();
    public List<Student> MyStud
    {
        get { return mystudent; }
    }

    public void Addstudent(string name,string surname,string dob, string addr)
    {
        mystudent.Add(new Student(name,surname,dob,addr));                   
    }

    private void LoadFromFile()
    {
        try
        {
            string s;
            StreamReader myFile = File.OpenText(filestud);
            while ((s = myFile.ReadLine()) != null)
            {
                Student st = new Student(s);
                mystudent.Add(st);
            }
            myFile.Close();
        }
        catch (Exception e)
        {
            Console.WriteLine("There was a file handling problem");
        }
    }

    private void DumpToFile()
    {
        try
        {
            StreamWriter myFile = File.CreateText(filestud);
            foreach (Student s in mystudent)
            {
                myFile.WriteLine(s.ToString());
            }
            myFile.Close();
        }
        catch (Exception e)
        {
            Console.WriteLine("There was a file handling problem");
        }
    }

    private int SearchItem(int search)
    {
        int found = -1;
        if (mystudent != null)
        {
            foreach (Student st in mystudent)
            {
                found++;
                if (Student.Equals(search,st)) {
                    break;
                }
            }
        }
        return found;
    }

    private void Delete(int index)
    {
        SearchItem(index);
        mystudent.RemoveAt(index);
        foreach (Student st in mystudent) {
            Console.WriteLine(st);
        }            
    }

    private void EditItem(int index)        
    {
        Student stud = new Student();        
        SearchItem(index);
        mystudent[index] = stud;
        Console.WriteLine("current record is" + index);
        Console.WriteLine("enter new record:");
        stud.Name = Console.ReadLine();
        stud.Surname = Console.ReadLine();
        stud.Addr = Console.ReadLine();
        stud.Id = Console.ReadLine();
        foreach (Student st in mystudent)
        {
            Console.WriteLine(st);
        }
    }
    private void ViewStudents()
    {
        foreach (Student st in mystudent)
        {
            Console.WriteLine(st);
        }
    }                    
 }  
 }

public class Marks
{      
    public int HYEXAM { get; private set; }
    public int ANEXAM { get; private set; }
    public string Id { get; private set; }

    public Marks(int hyexam, int anexam)
    {          
        this.HYEXAM = hyexam;
        this.ANEXAM = anexam;
    }

    public Marks(string id)
    {
        this.Id = id;
    }

    public double OverallExam()
    {
        return (0.4 * HEYXAM) + (0.6 * ANEXAM);
    }
   }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T17:44:01.790

好的，据我所知，您有一份学生名单。这些学生中的每一个都有几个分数列表：数学、英语、马耳他语等。

因此，假设您想为某个学生添加数学标记。假设你有：

```
List<Student> students;
int userId; // the id entered by the user
Mark mathMark; // the mark you want to add 
```

在列表中搜索给定的 id：

```
foreach (Student myStudent in students)
{
    if (myStudent.Id == userId)
    {
        myStudent.Mathematics.Add(mathMark);
    }
} 
```

然后，当您想为学生显示所有数学分数时：

```
foreach (Mark mark in myStudent.Mathematics)
{
    Console.WriteLine(mark.HYEXAM + "," + mark.ANEXAM);
} 
```

这就是你所追求的吗？

# css - 内侧水平居中

> ID：13691883
> 
> 赞同：-2
> 
> 时间：2012-12-03T21:18:51.550
> 
> 标签：css, html, text-align

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:23:49.643

您不能设置`display: inline`元素的尺寸。

`display: block`如果要显式设置其宽度，则可以同时拥有 a 和 span ：

```
.footer {position:absolute; bottom:0; width:100%;}
.footer a {display:block; background:orange;} /* no need to center text, here */
.footer a span {
  display: block; /* give it a box layout */
  margin: 0px auto; /* center it horizontally */
  width:100px; /* give it explicit absolute size */
  text-align: center; /* you might center the content here, though */
  background:#FFF; font-size:12px;} 
```

或者只是`text-align: center`像你已经在做的那样使用：

```
.footer {position:absolute; bottom:0; width:100%;}
.footer a {display:block; background:orange; text-align:center;}
.footer a span {background:#FFF; font-size:12px;
  padding: 0px 30px;} /* if you only want some padding, and not a fixed width 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:24:21.097

尝试以下操作：-

.footer 跨度 {背景：#FFF; 字体大小：12px；宽度：50%；显示：块；边距：0 自动；}

“内部跨度”需要一个小于“外部”div（或页脚）的宽度以及一个边距：0 设置为自动对齐。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-12-03T21:21:38.690

你可以做

```
<center> </center> 
```

所以像这样，

```
<div class="footer">
<center>
 <a href="#">
      <span>Show/Hide</span>
 </a>
</center>
</div> 
```

# bash - Zenity——Handbrake CLI 输出的进度

> ID：13691884
> 
> 赞同：6
> 
> 时间：2012-12-03T21:18:59.603
> 
> 标签：bash, zenity

我的目标是使用 zenity --progress 创建一个带有 HandBrakeCLI 输出的 gtk 进度条。我遇到了一些障碍，我想知道是否有人知道更好的方法或者可以帮助我完成我目前正在做的事情。

正常输出：

```
HandBrakeCLI -i infile -o outfile --preset=iPad 
```

显示器

> 编码：任务 1 of 1, 11.97 % (72.81 fps, avg 86.78 fps, ETA 00h00m43s)

HandBrake 通过管道传输到 tr 和 cut 命令，所以我只有 zenity 期望的百分比。

```
HandBrakeCLI -i infile -o outfile --preset=iPad 2>&1 | tr -s '\r' '\n' | cut -b 24-28 
```

结果是我所期望的：

```
1.05 
1.06 
1.10 
1.10 
```

但是，输出延迟很多，有时甚至不会显示。如果我只使用我的 tr 表达式，我会在每一行得到上面的输出，但它是整个输出，包括“编码：任务......”。

这就像 cut 命令跟不上手刹的标准一样。我阅读了有关使用命名管道的信息，创建了一个并将 HandBrake 的输出定向到管道，然后在另一个终端中通过管道尝试了 tr 和 cut 命令，它导致了相同的延迟。

使用 awk 的打印子字符串也会导致相同的延迟。

我想不通。我在 zenity --progress 指示器之后，因为我的 HandBrake 作业被称为 MythTV 作业，我希望弹出一个进度条，以便我知道何时以及编码正在进行中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T15:26:18.390

您可以使用在 stackexchange 上回答的解决[方案](https://unix.stackexchange.com/questions/25372/turn-off-buffering-in-pipe)。

例如：

该`stdbuf`程序是 GNU coreutils 的一部分。

```
stdbuf -i0 -o0 -e0 command 
```

* * *

另一个例子是[`expect`](http://expect.sourceforge.net/)命令[`unbuffer`](http://expect.sourceforge.net/example/unbuffer.man.html)，例如

```
unbuffer long_running_command | print_progress 
```

`unbuffer`通过伪终端 (pty)连接`long_running_command`，这使得系统将其视为交互式进程，因此不使用可能导致延迟的管道中的 4-kiB 缓冲。

对于更长的管道，您可能必须取消缓冲每个命令（最后一个命令除外），例如

```
unbuffer x | unbuffer -p y | z 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-14T20:17:56.110

使用 erik 建议的 UNBUFFER 与您的第一篇文章一起使用，以下命令可以解决问题：

```
( HandBrakeCLI -i infile -o outfile --preset=iPad | 
        unbuffer -p grep -i "encoding: task " | 
        unbuffer -p cut -c24-25 ) | 
        zenity --progress --auto-close 
```

# python - 无法从其他模块修改 Python 字符串/列表变量（由 tkinter 使用）

> ID：13691885
> 
> 赞同：2
> 
> 时间：2012-12-03T21:18:59.390
> 
> 标签：python, python-3.x, tkinter

我正在重新设计（“对象”化）一个 Python 3.2 GUI 应用程序，它自动将 tkinter GUI 对象（按钮标签）适应用户的语言（在启动时确定并且永远不会改变）。作为第一步，我将大型的单一源文件分解为多个模块文件。我能够毫无问题地将一些函数移动到它们自己的模块文件中——但是当从它们自己的模块文件调用时，其他“被证明很好”的函数将不起作用。

尝试使用驻留在一个模块中并由不同（兄弟）模块设置的变量（“Database_to_use”，见下文）时发生“IndexError：字符串索引超出范围”错误。当修改变量的过程位于主线模块中时，不会发生该错误。我怀疑存在范围界定问题和/或名称冲突，但从我所阅读和所做的一切来看，似乎已经消除了这两种可能性。

我正在使用“import”、虚线引用，并将全局声明放在修改函数中。点分符号也被用于“重命名”实体，以一种将名称从其所在位置的实现细节中抽象出来的方式 - 并且还将模块名称更改的范围限制为模块内的一行。我检查了这种方法不会导致名称隐藏问题；在我重命名问题模块和问题函数（下面的“SelectSqlDatabase”模块）后发生了同样的问题。顺便说一句，我也很清楚全局变量的优缺点（最终会消失）。

在下面的摘录中，我对代码进行了严格的编辑（例如，仅显示一个按钮的代码）以删除对理解问题不重要的所有内容。

首先是“SetUpLanguageInUse.py”模块；这是有问题的“Database_to_use”（以及没有问题的“Main_Title”）变量的位置：

```
English  = 'English'
Francais = 'Francais'

Database_to_use = "dummy string forces this variable into the global namespace"
Main_Title      = "dummy string forces this variable into the global namespace"

def SetUpLanguageInUse( user_language ):

    import __main__     # needed to modify the global value 

    if ( user_language == English ):       
        __main__.Main_Title      = 'Monthly Summary of Reports'
        __main__.Database_to_use = ( '', 'Build', 'Staging', 'Production' )
    elif ( user_language == Francais ):
        __main__.Main_Title       = 'Resume Mensuel de Rapports' 
        __main__.Database_to_use  = ( '', 'Construire', 'Relais', 'Production' )

    .....

    return 
```

关于上述模块的一些观察：

a) 问题与用户语言无关。b) 使用 [] 而不是 () 并不能解决问题。c) 在函数内部（和/或之前）插入“global Database_to_use”行没有帮助
d) 删除虚拟字符串分配没有帮助
e) 主线的第一行（见下文）调用此函数。当函数包含“全局”行时，变量没有更新。我明白为什么使用“ **main** ”。有效 - 但是当存在“全局”行时，为什么修改不起作用？

Next, the "SelectSqlDatabase.py" module, it holds the problem function:

```
from tkinter import *
from tkinter import ttk

import LanguageInUse

Database_to_use = LanguageInUse.Database_to_use

Database_List  = ( '', 'server1', 'server2', 'server3' )
SQL_Database   = "To be determined"

# ----- the problematic function

def SelectSqlDatabase( SelectDatabaseFrame ) : 

    global SQL_Database

    UserSelection = StringVar( value = "Empty" )

    Build_DB      = Radiobutton( SelectDatabaseFrame, 
                                 text        = Database_to_use[ 1 ],  # the problematic line
                                 variable    = UserSelection, 
                                 value       = Database_List[ 1 ] )

    SQL_Database = UserSelection.get()

    return 
```

Finally the mainline. Notice that inthis file the "SelectSqlDatabase" function is a COMMENT and is IDENTICAL to that in "SelectSqlDatabase.py". When this code is run "AS IS" (i.e. using the function in "SelectSqlDatabase.py"), I get the following error:

File "...\SelectSqlDatabase.py", line 65, in SelectSqlDatabase text = Database_to_use[ 1 ],
IndexError: string index out of range

But when I UN-comment the function (thereby hiding the function in "SelectSqlDatabase.py"), the application runs correctly!

```
from tkinter  import *
from tkinter  import ttk

import LanguageInUse
import SelectSqlDatabase       

Database_to_use          = LanguageInUse.Database_to_use
Database_List            = SelectSqlDatabase.Database_List
English                  = LanguageInUse.English
SetUpLanguageInUse       = LanguageInUse.SetUpLanguageInUse
SQL_Database             = SelectSqlDatabase.SQL_Database

SelectSqlDatabase        = SelectSqlDatabase.SelectSqlDatabase     # gets overridden

# ----- the problematic function

'''
def SelectSqlDatabase( SelectDatabaseFrame ) : 

    global SQL_Database

    UserSelection = StringVar( value = "Empty" )

    Build_DB      = Radiobutton( SelectDatabaseFrame, 
                                 text        = Database_to_use[ 1 ],  # the problematic line
                                 variable    = UserSelection, 
                                 value       = Database_List[ 1 ] )

    SQL_Database = UserSelection

    return
'''
'''----------'''
def ChooseDataSourceFrame( mainframe ) :

    ChooseSourceFrame   = ttk.LabelFrame( mainframe, ...  )
    SelectDatabaseFrame = ttk.LabelFrame( ChooseSourceFrame )

    SelectSqlDatabase( SelectDatabaseFrame )

    return

'''***** MAINLINE ***** '''

SetUpLanguageInUse( English )      #TODO: make language a startup parameter

mainframe = ttk.Frame( ... )

ChooseDataSourceFrame( mainframe ) 
```

To be complete, at one time I was able to eliminate this error (by passing "Database_to_use" as a parameter) but other nasty things happened such as:
a) the GUI displaying the useless dummy titles (effectively ignoring the call to "SetUpLanguageInUse"), b) getting an error message about "Database_to_use" not having a get() function, or c) the value returned in "SQL_Database" being either it's default value ("To be determined") or the default value for User_Choice ("Empty") instead of the database chosen by the user.

To summarize, my objective is to set "SQL_Database" to the database server chosen by the user (i.e. extracted from "Database_List") - with tkinter displaying the (language-dependent) strings passed to it inside "Database_to_use".

I've spent a LOT of time experimenting & researching this problem - all to no avail. Everything I've read (including the Python 3.2.3 Tutorial) suggests that what I'm doing is correct, however I feel I'm overlooking something simple. Where am I going wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T06:29:32.213

What you are missing here is that Python does *not* have variables that are pointers, they are references to objects. Hence, when you change a variable name, that variable name will point to the new object you created. All other variable names will continue to point to the old variable.

Hence, when you import `Database_to_use` into SelectSqlDatabase it will point to the string object `"dummy string forces this variable into the global namespace"`. When your function later changes the `Database_to_use` name in your first file to point to another string, this will not modify what `SelectSqlDatabase.Database_to_use` references. It will continue to reference the original string.

So, what should you do? You should keep your run-time configurations in an object of some sort, and always look up the variables from that object, so that you do not keep your configuration variables in local variables that do not change.

So in this case, to solve the problem, remove the line

```
Database_to_use = LanguageInUse.Database_to_use 
```

And just reference `LanguageInUse.Database_to_use` all the time instead, it would probably solve the problem.

It's still a bit ugly though. I would probably just have a `configuraion = {}` in your main `__init__.py`, and use that:

Setting:

```
from mainmodule import configuration

def somefuction():
    configuration['database'] = "mysql:blahblahblah" 
```

Using:

```
from mainmodule import configuration
configuration['database'] = "mysql:blahblahblah"

def somefuction():
    databaseopener(cofiguration['database']) 
```

Also: [PEP8](http://www.python.org/dev/peps/pep-0008/)

# ruby-on-rails - Rails 3邮件问题

> ID：13691894
> 
> 赞同：0
> 
> 时间：2012-12-03T21:19:39.407
> 
> 标签：ruby-on-rails, email, actionmailer

我正在关注这个 railscast 以熟悉 Rails 3 中的 ActionMailer，但我没有运气让电子邮件送达。

我在想我的问题可能与我的 setup_mail.rb 文件有关，有人可以在这里发现问题吗？我正在尝试从我的 gmail 帐户 jbdyno@gmail.com 发送电子邮件

```
ActionMailer::Base.smtp_settings = {
  :address              => "smtp.gmail.com",
  :port                 => 587,
  :domain               => "gmail.com",
  :user_name            => "jbdyno",
  :password             => "I PUT MY PASSWORD HERE",
  :authentication       => "plain",
  :enable_starttls_auto => true
} 
```

* * *

其他文件

user_mailer.rb

```
class UserMailer < ActionMailer::Base
  default from: "jbdyno@gmail.com"

  def registration_confirmation(user)
    mail(:to => user.email, :subject => "Registered")
  end

end 
```

registration_confirmation.text.erb

```
Thanks for registering! 
```

users_controller.rb

```
 def create
    @user = User.new(params[:user])

    respond_to do |format|
      if @user.save
        UserMailer.registration_confirmation(@user).deliver
        format.html { redirect_to @user, notice: 'User was successfully created.' }
        format.json { render json: @user, status: :created, location: @user }
      else
        format.html { render action: "new" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:56:23.623

在您尝试发送电子邮件的环境的配置中，您可能需要添加`config.action_mailer.delivery_method = :smtp`.

有关使用 gmail 的完整示例配置，请参阅[ActionMailer 上的 Rails 指南（使用 Gmail 设置）](http://guides.rubyonrails.org/action_mailer_basics.html#action-mailer-configuration-for-gmail)。

请务必在更改配置文件后重新启动您的开发服务器。

# java - 尝试编写二次公式？

> ID：13691898
> 
> 赞同：0
> 
> 时间：2012-12-03T21:19:59.320
> 
> 标签：java, quadratic

我是 Java 新手——我的第一个项目是构建一个计算器。

试图编写一个二次方程；虽然我没有错误，但我得到了错误的答案。

```
void quadratic() {
    if((b*b-4*a*c) < 0){
        System.out.println("The answer is imaginary.");
    }
    else {
        System.out.println(
             "The two roots x values of the quadratic function "
             + a + "x^2 + " + b + "x + " + c + " are "
             + ((-b) + (Math.sqrt((b*b)-(4*a*c))/(2*a))) + " and "
             + ((-b) - (Math.sqrt((b*b)-(4*a*c))/(2*a)))
        );
    }
} 
```

如果我替换`a=1, b=4, c=4`，我得到 -4 和 -4。

如果我替换`a=1, b=1, c=-12`，我得到 2.5 和 -4.5。

这可能只是一个数学错误，但我认为这个公式是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:37:07.700

不，论坛不太正确。你把错误的东西除以`2*a`。

我的建议是排除判别式计算，并去掉多余的括号。这将使代码更容易正确：

```
void quadratic() {
    double discriminant = b*b-4*a*c;
    if(discriminant < 0) {
        System.out.println("The answer is imaginary.");
    } else {
        System.out.println(
                "The two roots x values of the quadratic function "
                + a + "x^2 + " + b + "x + " + c + " are "
                + (-b + Math.sqrt(discriminant)) / (2*a) + " and "
                + (-b - Math.sqrt(discriminant)) / (2*a)
                );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:22:44.573

你缺少括号，应该是

```
(((-b) + (Math.sqrt((b*b)-(4*a*c)))/(2*a))) + " and " + (((-b) - (Math.sqrt((b*b)-(4*a*c)))/(2*a)))) 
```

您需要将整个事物除以 2a。

# php - 运行查询并快速挑选出一个结果，其中包含之前的行数？

> ID：13691900
> 
> 赞同：1
> 
> 时间：2012-12-03T21:20:00.700
> 
> 标签：php, mysql

我正在为基于 sql 数据库中的统计数据的网站开发排行榜式排名系统。但是，我想让它让用户可以输入他们的用户名，它会显示比他们少 5 个等级和多 5 个等级。

我不确定如何执行此操作，因为我想从中获取信息的表大约有 123,000 行长，正如您可以想象的那样，这将需要很长时间才能完成。我想知道是否有一种简单的方法可以让它搜索行，记录行数直到它到达 x 行，然后拆分行号。如果您可能会被打扰，也可能包含有关我将如何获取该查询中更高和更低的行的信息。谢谢 ：）

对于其他信息，希望通过 sql 和 php 来完成

举一个更好的例子来说明我想要做什么：我想找到满足特定条件的特定行的结果编号，在这种情况下是一个名称，然后使用该数字来获取它周围的数据。我宁愿能够得到结果 # 而不必扫描所有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:51:49.173

它不是很有效，因为即使在`score`列上有一个索引，它仍然涉及全表扫描来创建排名，但这会做你想要的：

```
SELECT    allusers.rank, allusers.Name, allusers.Kills
FROM (
  SELECT   AgStats.Name,
           @t:=IF(score<=>@s,@t,@r) AS rank,
           @s:=AgStats.Kills AS Kills,
           @r:=@r+1
  FROM     AgStats, (SELECT @r:=0, @s:=NULL, @t:=NULL) init
  ORDER BY AgStats.Kills DESC
) allusers, (
  SELECT COUNT(*) AS rank
  FROM   AgStats
  WHERE  Kills > (SELECT Kills FROM AgStats WHERE Name = 'VoidWhisperer')
) user
WHERE    ABS(allusers.rank-user.rank) <= 5
ORDER BY allusers.rank 
```

# c# - json.net 在序列化和反序列化一个非常简单的类时抛出错误

> ID：13691901
> 
> 赞同：3
> 
> 时间：2012-12-03T21:20:15.147
> 
> 标签：c#, json, serialization, json.net, deserialization

我正在第一次认真尝试使用 Json 并将其从一个应用程序返回到另一个应用程序。

我的应用程序是一个使用 .Net 4.0 Framework 的 ASP.NET MVC 3 应用程序。

我需要序列化和反序列化一个非常简单的类来和来自 json。

```
public class ProxyRequestResultDetails
{
    public string ApplicationName { get; set; }
    public string ProxyValue { get; set; }
    public bool ProxyRelationshipExists { get; set; }
} 
```

该类不继承或实现任何东西。

我可以通过执行以下操作成功地将其转换为 json：

```
string json = JsonConvert.SerializeObject(requestDetails); 
```

创建的 json 示例如下：

```
"{\"ApplicationName\":\"Awesome App\",\"ProxyValue\":\"0\",\"ProxyRelationshipExists\":true}" 
```

然后我拨打以下电话：

```
ProxyRequestResultDetails deserializedTestRequestDetails = 
                JsonConvert.DeserializeObject<ProxyRequestResultDetails>(json); 
```

这有一个堆栈跟踪，如下所示。它已被格式化为包含所有内部异常。

```
Method: CustomHandleErrorAttribute
     Message:  Error converting value "{\"ApplicationName\":\"Awesome App\",\"ProxyValue\":\"0\",\"ProxyRelationshipExists\":true}" to type 'ProxySetup.Models.ProxyRequestResultDetails'. Path '', line 1, position 98\. Inner Error #1: Could not cast or convert from System.String to ProxySetup.Models.ProxyRequestResultDetails.
     stack trace:    at Newtonsoft.Json.Utilities.ConvertUtils.EnsureTypeAssignable(Object value, Type initialType, Type targetType)
   at Newtonsoft.Json.Utilities.ConvertUtils.ConvertOrCast(Object initialValue, CultureInfo culture, Type targetType)
   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.EnsureType(JsonReader reader, Object value, CultureInfo culture, JsonContract contract, Type targetType) 
```

这似乎是一个非常简单的对象。我可能遗漏了一些简单的东西，但我无法从示例中找到确切的内容。任何想法将不胜感激。

**编辑 1**

严肃的是对的。这正是正在发生的事情，但我不知道如何适应它。我想要做的是在控制器上公开一个操作，以便它可以像 Web 服务调用一样使用。在操作中创建为原始字符串的 json 是：

```
{"ApplicationName":"Awesome App","ProxyValue":"0","ProxyRelationshipExists":true} 
```

但是操作返回的 json（返回类型为 JsonResult）

```
return Json(json, "application/json; charset=utf-8", JsonRequestBehavior.AllowGet); 
```

是：

```
"{\"ApplicationName\":\"Awesome App\",\"ProxyValue\":\"0\",\"ProxyRelationshipExists\":true}" 
```

想法？

**编辑 2 - 已解决**

这很简单。我将操作返回类型更改为

```
string 
```

并从以下位置返回结果字符串：

```
string json = JsonConvert.SerializeObject(requestDetails); 
```

称呼。

谢谢严重！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-03T21:40:01.757

似乎您的序列化字符串已被转义或类似的东西，使其显示为表示字符串的字符串，而不是表示 JSON 流的字符串。

举个例子 ：

```
string json = "{}";
string notJson = "\"{}\""; 
```

因此，例如使用 VS 调试器检查字符串的原始值。

# ruby-on-rails - 在服务器运行时更 改文件触发 SystemStackError？

> ID：13691904
> 
> 赞同：10
> 
> 时间：2012-12-03T21:20:21.877
> 
> 标签：ruby-on-rails, macos, error-handling, ruby-on-rails-3.2

在我的 RoR 应用程序开发机器（本地服务器、OSX 10.8.1、Ruby 1.9.3、Rails 3.2.8）上，一些奇怪的东西开始凭空出现（当然……）：

Rails 服务器崩溃（所有路由都被杀死，服务器重启是让它再次工作的唯一方法），并出现以下日志条目：

```
SystemStackError (stack level too deep):
  actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:70

  Rendered /Users/dekay/.rvm/gems/ruby-1.9.3-head@global/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.9ms)
  Rendered /Users/dekay/.rvm/gems/ruby-1.9.3-head@global/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.2ms)
  Rendered /Users/dekay/.rvm/gems/ruby-1.9.3-head@global/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (14.7ms) 
```

我用谷歌搜索发现 SystemStackError 通常是由于无限循环造成的，但据我所知，我的代码中没有这样的循环。并且错误似乎不在应用程序逻辑的某个步骤中。

服务器崩溃与我的操作之间的唯一关联如下：

1.  更改应用程序中的一些代码
2.  重新加载应用程序的当前网页
3.  繁荣，服务器不见了，错误消息。
4.  在此之后没有页面工作，错误是：

    路由错误

    没有路线匹配 [GET] "/"

    尝试运行 rake 路线以获取有关可用路线的更多信息。

任何人都可以指出我调试这个的正确方向吗？PS：我怀疑它发生在粗心的“捆绑更新”之后。这可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T05:06:18.947

调试 a`stack level too deep`中的错误消息`rails app`并不容易，因为错误可能是由多种原因造成的，并且错误消息并没有太大帮助。

导致 a 的一些原因`stack level too deep error`：

1.  [宝石和插件以及应用程序的任何其他依赖](https://stackoverflow.com/a/2188007/429758)项中的不一致。
2.  [代码语法错误](http://www.ruby-forum.com/topic/51430)
3.  [错误地应用数据库迁移](http://t3h-butter-pecan.blogspot.in/2012/07/my-first-stack-level-too-deep-error-yay.html)导致的不一致。

如果错误发生在系统启动时，那么这个提示将非常有用：[http ://www.datatravels.com/technotes/2012/07/11/awesome-debugging-for-rails-boot-stacklevel-too-德/](http://www.datatravels.com/technotes/2012/07/11/awesome-debugging-for-rails-boot-stacklevel-too-de/)

根据描述，该应用程序似乎可以正常运行一段时间，然后开始崩溃 - 因此上述启动情况可能不适用。

[解决问题的一种方法是通过使用printf 调试](https://stackoverflow.com/a/8405963/429758)来隔离`line/block of code`导致错误的具体原因

此外，可能值得回滚更改并使系统恢复工作状态，然后逐步恢复更改以隔离根本原因。

在这种情况下，很可能`bundle update`确实触发了错误；因此检查新添加的依赖项并查看它们是否是罪魁祸首是个好主意。

# css - 在 PHP 中的重复渐变图像上添加图像

> ID：13691907
> 
> 赞同：0
> 
> 时间：2012-12-03T21:20:35.117
> 
> 标签：css

我环顾四周，但我遇到的任何事情似乎都没有为我想要实现的目标而努力。

我有盒子，我正在使用渐变/背景。该框询问用户是否想为朋友购买该产品，因此我也想在其中添加一张礼物照片。问题是礼物照片出现在另一张图片的背面，我找不到修复它的方法。

顺便说一句，我正在使用主题开发 WP。

这是我的代码：

PHP

```
<div class="gift boxed3">
                    <span class="gift_title">
                           <?php gb_e('Buy for friend') ?>
                    </span>
                </div> 
```

CSS

```
.gift{
font-size: 0.6em;
font-family: Arial;
float:left;
}

.gift_title {
color: #666666;
font-size: 15px;
font-family: arial;
font-weight: bold;
margin-left: 10px;
margin-top: 10px;
line-height: 66px;
}

.boxed3 {
width: 297px;
height:65px;
background-color: #f9f9f9;
margin-top: 15px;
border-radius: 5px;
-moz-border-radius: 5px;
background-image: url(http://domain.gr/example/gradient.png);
background-repeat: repeat-x;
background-position: center bottom;
border-bottom: 1px solid #CCC;
border-bottom: 1px solid rgba(0, 0, 0, .1);
box-shadow: 0 1px 1px #7D7D7D;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T17:02:53.770

以防万一该帖子将来对某人有所帮助。这就是我设法解决我面临的问题的方法。

注意：我正在研究 WordPress。

```
<div class="gift boxed3">
                     <span class="gift_image">
                            <img src="http://topgreekgyms.fitnessforum.gr/wp-content/uploads/2012/12/gift.png";?>
                     </span>

                     <span class="gift_title">
                            <a href="<?php gb_add_to_cart_url(); ?>" class=""><?php gb_e('Buy for friend') ?></a>
                      </span>
                </div> 
```

CSS

```
.gift{
    font-size: 0.6em;
    font-family: Arial;
    float:left;
    }

    .gift_title {
    color: #666;
    font-size: 15px;
    font-family: arial;
    font-weight: bold;
    margin-left: 3px;
    margin-top: 10px;
    line-height: 66px;
    }

    .gift_image {
    float: left;
    margin: 16px 9px;
    }

    .boxed3 {
    width: 297px;
    height:65px;
    background-color: #f9f9f9;
    margin-top: 15px;
    border-radius: 5px;
    -moz-border-radius: 5px;
    background-image: url(http://topgreekgyms.fitnessforum.gr/wp-content/themes/blank-child-theme/img/gradient.png);
    background-repeat: repeat-x;
    background-position: center bottom;
    border-bottom: 1px solid #CCC;
    border-bottom: 1px solid rgba(0, 0, 0, .1);
    box-shadow: 0 1px 1px #7D7D7D;
    } 
```

# php - Javascript 内容储物柜如何重定向？

> ID：13691912
> 
> 赞同：0
> 
> 时间：2012-12-03T21:21:06.417
> 
> 标签：php, javascript, jquery, ajax

我为我的网站成员构建了一个内容储物柜小部件。内容储物柜会强制访问者在重定向之前完成调查。

基本上，如果调查完成，我需要让 Javascript 向我的域发出 Ajax 请求并重定向用户。假设一个 PHP 脚本将回显“1”表示完整，“0”表示不完整。

这通常是微不足道的，但用户将 javascript 代码放在他们的网站上，而不是我的。所以我担心遇到跨脚本标志。

那么内容储物柜是如何做到这一点的呢？我知道这是可能的，因为像 Adscend Media 这样的公司有一个。

此外，在我的网站上设计了他们的小部件之后，他们在他们的网站上放置了一个代码，如下所示：

```
<script type="text/javascript" src="http://mywebsite.com/js/w.php?i=6PS0D9"></script> 
```

这在 head 标签中。由于脚本本身在我的域中，因此包含此脚本是否会以某种方式使跨脚本到我的域可用？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:24:54.157

您关心的基本问题是“同源策略”，这是所有主要浏览器都遵循的策略，以防止网站向其他域发出 AJAX 请求。

但是，同源策略并不*限制*标签引入的脚本`<script>`，这就是为什么内容柜能够毫无问题地提供他们想要的任何脚本文件。顺便说一句，这也是同源策略的“JSONP”解决方法的工作原理。

如果您想允许您的客户向您的网站提出跨域请求，您可以将他们的域名添加到您网站上的特殊“crossdomain.xml”文件中，并且（当前）浏览器将允许这些请求工作（~~我忘了文件的名称/路径，但如果您有兴趣~~查看此处了解更多信息，应该很容易查找：https: [//support.ookla.com/entries/21097566-what-is-crossdomain-xml-以及为什么我需要它](https://support.ookla.com/entries/21097566-what-is-crossdomain-xml-and-why-do-i-need-it)）。

或者，您的客户*可以*在他们的服务器上设置代理（可能不是他们想做的事情）。或者，您可以只使用 JSONP，这基本上是：

1.  您的用户运行的 JS 将脚本标签添加到页面；该脚本标签的网址类似于“yoursite.com/shouldILetThisGuyIn/”。
2.  您的服务器将它们发送回一个 JS 文件，其中包含类似的内容`var letThisGuyIn = true; function foo() { return letThisGuyIn }`
3.  你的用户运行'foo()'，并得到结果，决定是否让那个人进来。

# c# - 使用 Unity 初始化属性

> ID：13691914
> 
> 赞同：0
> 
> 时间：2012-12-03T21:21:12.823
> 
> 标签：c#, inversion-of-control, unity-container

我有以下控制台程序。但是，属性服务为 null，并且以下代码块中的最后一行引发异常。我错过了什么？

```
class Program
{
    static void Main(string[] args)
    {
        container = new UnityContainer();
        container.RegisterType<Service.IService, Service.Service>();
        container.RegisterType<IC1, C1>();
        container.Resolve<Service.IService>();
        // var c1 = container.Resolve<IC1>();
        c1.Run();
    }

    [Depenency] C1 c1 { get; set; }
}

public class C1
{
    [Depenency] Service.IService service { get; set; }

    public void Run()
    {
        var s = service.GetSomething(); // service is null 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:23:18.237

`public`必须注入属性。

```
public class C1
{
    [Dependency] public Service.IService service { get; set; }
...
} 
```

事实上，他们需要一个公共二传手。这有效：

```
public class C1
{
    [Dependency] public Service.IService service { protected get; set; }
...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:26:36.810

您应该使用[UnityContainer.Resolve](http://msdn.microsoft.com/en-us/library/ff660794%28v=pandp.20%29.aspx)而不是直接创建对象`new`来解决依赖关系

# ruby-on-rails - Rails 按关联计数和同一模型上的关联字段排序

> ID：13691915
> 
> 赞同：2
> 
> 时间：2012-12-03T21:21:18.720
> 
> 标签：ruby-on-rails, activerecord

我有一个`Department`与用户有两个关联的模型，这样

```
class Department < ActiveRecord::Base
   has_many :members, class_name:"User", foreign_key:"department_id"
   belongs_to :director, class_name:"User", foreign_key:"director_id
end 
```

要在列表中显示此模型，按成员数量排序，我可以这样做

```
@departments = Department.select("departments.*, COUNT(users.id) AS members").joins(:members).group("departments.id")
@departments = @departments.order("members ASC") 
```

如果我想按`last_name`导演关联模型中的字段 () 进行排序，我可以这样做：

```
@departments = Department.includes(:director)
@departments = @departments.order("users.last_name") 
```

但是，我不能将这两个查询组合成一个允许对两者进行正确排序的查询。如果我做

```
Department.select("departments.*, COUNT(users.id) AS members").joins(:members, :director).group("departments.id, users.last_name") 
```

然后我得到大量重复的结果，并且我还排除了`director_id`零的结果。如何构建查询，以便我可以按两者`COUNT(users.id)`和本质上的顺序排序`director.last_name`？

**编辑**：这是`.to_sql`针对那个糟糕的组合查询：

```
SELECT departments.*, COUNT(users.id) AS members FROM "departments" 
INNER JOIN "users" ON "users"."department_id" = "departments"."id" 
INNER JOIN "users" "directors_departments"    
ON "directors_departments"."id" = "departments"."director_id" 
GROUP BY departments.id, users.last_name 
ORDER BY users.last_name DESC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:40:23.960

所以这里有2个问题：

1.  您正在使用可能不存在`.joins`的关联。`belongs_to`
2.  您要加入同一个用户表两次（用于 2 个不同的关联），导致 rails 生成表别名，以便 SQL 有效。但是您没有按此别名进行分组。

解决方案：

您需要一个 LEFT JOIN，不幸的是它不如标准连接漂亮。您还需要修改您的`.group`条款：

```
Department.
  select("departments.*, COUNT(users.id) AS members").
  joins(:members, "LEFT JOIN users directors ON departments.director_id = directors.id").
  group("departments.id, directors.last_name").
  order("members, directors.last_name") 
```

# sql - 未知命令开始 SELECT ... 错误？

> ID：13691917
> 
> 赞同：0
> 
> 时间：2012-12-03T21:21:23.540
> 
> 标签：sql, database, oracle, relational-database

我正在尝试在 Oracle 中运行以下命令

```
SELECT artistic_name 
FROM Artist 
INNER JOIN Groups ON artistic_name = Groups.group_name, Groups.group_name = ‘Frankensense’, OR Groups.group_name = ‘Jameson’; 
```

错误是：`SP2-0734: unknown command beginning "1) SELECT ..." - rest of line ignored.`

我看不出这到底是什么问题。

有人有想法么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:25:17.930

首先，发布确切的错误（ORA-xxxxx 错误代码和错误消息的全文）总是有帮助的。

我怀疑你想要

```
SELECT artistic_name 
  FROM Artist 
       INNER JOIN Groups 
       ON artistic_name = Groups.group_name
 WHERE Groups.group_name IN ('Frankensense', 'Jameson'); 
```

您也可以将`group_name`谓词放在`ON`子句中

```
SELECT artistic_name 
  FROM Artist 
       INNER JOIN Groups 
       ON(     artistic_name = Groups.group_name
           AND Groups.group_name IN ('Frankensense', 'Jameson')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:22:48.823

告诉我们错误。同时，删除多余的逗号。

```
SELECT artistic_name 
FROM Artist
INNER JOIN Groups
  ON artistic_name = Groups.group_name
    AND Groups.group_name = 'Frankensense'
    OR Groups.group_name = 'Jameson'; 
```

您可能需要添加括号，具体取决于您希望 at "ON" 子句如何工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:23:42.797

这应该工作，

```
SELECT artistic_name 
FROM Artist 
INNER JOIN Groups ON artistic_name = Groups.group_name 
  AND (Groups.group_name = 'Frankensense' OR Groups.group_name = 'Jameson') 
```

`JOIN`或`WHERE`条件不需要逗号

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-03T21:26:52.543

看起来你打算有一个 WHERE 子句，并删除逗号：

```
 SELECT artistic_name 
 FROM Artist 
   INNER JOIN Groups ON artistic_name = Groups.group_name 
 WHERE Groups.group_name = 'Frankensense' 
    OR Groups.group_name = 'Jameson'; 
```

# c# - 在表单之间切换时保持复选框的状态

> ID：13691920
> 
> 赞同：0
> 
> 时间：2012-12-03T21:21:43.023
> 
> 标签：c#, winforms, checkbox

我有 form1，它有一个命令按钮，可以打开 form2，然后有一些复选框。当我运行程序时，首先出现form1，然后单击命令按钮转到form2，然后单击其中一个复选框，如果我返回form1并再次返回form2，则复选框将其状态更改为未选中再次。我怎样才能将它的状态保持在“已检查”？我拥有的唯一一段代码来自from1的命令按钮。

```
private void button3_Click(object sender, EventArgs e)
{
    this.Hide();
    Form4 form4 = new Form4();
    form4.Show();       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:24:10.273

考虑此类问题的最佳方法是将 UI（“视图”）与应用程序正在编辑的数据状态（“模型”）分开。

将状态存储在对两种形式都可用的类实例中。将每个表单中复选框的状态绑定到表示该类实例中选中状态的布尔属性的状态。

根据您使用的 UI 技术，对将模型属性绑定到表示该属性值的 UI 元素的支持或多或少。WPF 和 Silverlight 有很好的支持。WinForms 没有提供良好的开箱即用支持，但是有第三方库可以添加不错的支持，或者您可以手动将复选框的状态连接到使用事件处理程序支持该状态的布尔属性的状态。

这是称为 MVC 或模型-视图-控制器的模式的一部分。

# visual-studio-2010 - 将多个复选框更改为单选按钮

> ID：13691921
> 
> 赞同：0
> 
> 时间：2012-12-03T21:21:49.130
> 
> 标签：visual-studio-2010

我在一个组框中有大约 50 个复选框。我需要将它们更改为单选按钮...有没有办法*安全地*批量执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T08:34:39.027

如果您只是想更改标记，例如更改此：

```
<input type="radio" id="rad1" name="myGroup" value="1" />Button 1<br/>
<input type="radio" id="rad2" name="myGroup" value="2"/>Button 2<br/> 
```

对此：

```
<input type="checkbox" id="chk1" value="1"/>Checkbox 1<br/>
<input type="checkbox" id="chk2" value="2"/>Checkbox 2 
```

然后运行查找和替换几次应该可以满足您的需要。至少您需要更改 type 属性并删除 name 属性。

但是，如果您正在使用 ASP.NET 服务器控件，或者如果您正在运行客户端 JavaScript，正如其他人所写的那样，您可能需要重新访问您的代码以确保您的逻辑在控件发生更改时仍然保持一致。

# java - 集成java程序和wordpress网站

> ID：13691931
> 
> 赞同：1
> 
> 时间：2012-12-03T21:22:20.590
> 
> 标签：java, wordpress, jsp, servlets

我用 Java 开发了一个工具，用 Wordpress 开发了一个网站。现在我想把我的 Java 工具放到网上。该工具根据一些用户输入执行计算。我想要实现的情况是，用户可以在我网站的特定页面上输入工具所需的数据，java 工具将在同一页面上输出解决方案。

我对 Web 开发了解不多，但我阅读了一些关于 Servlet、JSP、Web 容器（如 Tomcat）的文章。我现在必须用 JSP 重写我的网站吗？或者还有一种方法可以“将 Java Servlet 集成到现有网站中（在我的例子中是使用 Wordpress 开发的）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T19:38:14.840

如果预计该进程是短暂的，那么最好通过在进程中像常规 Java 命令行程序一样运行它，捕获 stdout 和 stderr。无需像 Tomcat 那样设置 java 容器。

# c# - 多个工作流任务卡在 Sharepoint 2007 中

> ID：13691932
> 
> 赞同：3
> 
> 时间：2012-12-03T21:22:22.337
> 
> 标签：c#, sharepoint, sharepoint-2007

我是编程新手，我需要帮助解决我无法解决的问题。我使用 SharePoint 2007 和 Visual Studio 2010 创建了一个顺序审批工作流。本页中的教程：http: [//www.sheltonblog.com/archive/2007/11/21/how-to-video-building-a-带有sharepoint.aspx的基本审批工作流](http://www.sheltonblog.com/archive/2007/11/21/how-to-video-building-a-basic-approval-workflow-with-sharepoint.aspx)

一切似乎都很好，我可以创建批准表格并批准它！但是，如果我需要同时批准工作流程，它就会卡住！我尝试使用 Visual Studio Debug 进行故障排除并检查工作流日志，但似乎没有任何内容。你有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T09:44:07.803

在该教程之后，我遇到了同样的情况，我发现问题在于他对任务使用相同的 guid，因此，如果您有多个具有相同 Guid 的任务，Sharepoint 会“混淆”并且什么也不做。要解决这个问题必须：

进入设计师。选择创建任务。删除 Guid 点击 ... 选择 Bind to a`New Member`并`Create new Field`点击 OK

在 CreateTask 方法后面的代码中，使用以下代码每次都重新创建 TaskID Guid：

```
createTaskt1_TaskId1 = Guid.NewGuid(); 
```

PS 将 createTaskt1_TaskId1 更改为您的属性名称。

# actionscript-3 - 羽毛椋鸟 AS3 AIR 主题

> ID：13691934
> 
> 赞同：2
> 
> 时间：2012-12-03T21:22:29.643
> 
> 标签：actionscript-3, starling-framework

我正在构建一个 AS3 项目，我想将 Feathers 合并到其中，但是在尝试遵循他们的文档时我很困惑。大概是我的错！

我正在尝试添加一个主题（MinimalMobileTheme）但是我不知道在哪里添加主题文件夹或我应该添加哪些文件夹或我如何显示添加它们。

我正在使用 Flash 生成器。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T22:33:41.043

好的，只需按照本教程进行 Starling 和 Feathers 设置：

[http://gamua.com/starling/first-steps/](http://gamua.com/starling/first-steps/)

从各自的 github 存储库下载每个文件并解压缩，然后将源文件夹添加到指定的构建路径中。在 -app.xml 文件中将 renderMode 更改为 direct，并使用示例确保 Starling 本身工作正常。

我现在正在研究主题的使用，但似乎基本上只使用了一个大的精灵表 png 和一个伴随它的 XML 文件以及每个主题的字体。我想这将与您只需下载源并将其链接到 flash builder 项目属性中的方式相同（可以右键单击导航器中的项目并转到属性，或转到主项目菜单并选择属性，然后转到到 ActionScript 构建路径并添加源文件夹）。

Embed 应该与您的构建路径之一相关。

以下是迄今为止帮助我的一些资源：

[http://wiki.starling-framework.org/feathers/getting-started](http://wiki.starling-framework.org/feathers/getting-started)

[http://www.hsharma.com/tutorials/starting-with-starling-ep-1-intro-setup/](http://www.hsharma.com/tutorials/starting-with-starling-ep-1-intro-setup/)

挂断我在尝试使用羽毛时遇到了一个错误，看起来开发人员已经意识到了，他们正在解决当前版本的一些问题，因此需要付出相当大的努力来挖掘和解决问题（这里是新手）。如果您已经让当前的负责人开始工作或进行了一些较旧的修订，请告诉我，我会再试一次。

[http://forum.starling-framework.org/topic/error-supportscissorrectangle-this_scissorrect](http://forum.starling-framework.org/topic/error-supportscissorrectangle-this_scissorrect)

发布到 Feathers 网站的示例在源代码中使用了这个：

```
private function addedToStageHandler(event:Event):void
{
    this._theme = new MetalWorksMobileTheme(this.stage); //start using theme

    this._navigator = new ScreenNavigator(); //components added afterwards have theme applied
    this.addChild(this._navigator); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-08T11:30:30.487

按照以下步骤 1) 将文件 feathers-1.0.1 解压到桌面 2) 右键单击​​包资源管理器上的项目名称并转到属性 3) 选择源路径 4) 添加新文件夹 feathers-1.0.1\themes\桌面上的 MetalWorksMobileTheme\source 文件夹 5) 好的。行。然后导入包

```
import feathers.themes.MetalWorksMobileTheme; 
```

并按照教程[http://wiki.starling-framework.org/feathers/getting-started中的后续步骤进行操作](http://wiki.starling-framework.org/feathers/getting-started)

# iphone - AudioQueue 读取输入音量

> ID：13691936
> 
> 赞同：0
> 
> 时间：2012-12-03T21:22:31.167
> 
> 标签：iphone, objective-c, audio, input, volume

我在 OS X 上，我必须在说话时连续读取输入音量（例如 Siri，它会在高或低的紫色条上显示强大的声音或微弱的声音）。我试过这段代码，但它返回“参数 ID 无效”：

```
 UInt32 size = sizeof(AudioQueueLevelMeterState) * record_state.data_format.mChannelsPerFrame;
    AudioQueueLevelMeterState *outValue = malloc(size);
OSStatus errorMsg = AudioQueueGetProperty (record_state.queue, kAudioQueueProperty_CurrentLevelMeter,  &outValue, &size     );

    if (!errorMsg) {
        printf("Volume: %f", outValue[0].mPeakPower);
    }
    else
    {
        printf("Er: %i", errorMsg);
    } 
```

我能怎么做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:31:27.143

`kAudioQueueProperty_EnableLevelMetering`您是否通过设置属性启用了计量？如果不是，那可能是原因。

# jquery - Jquery each 不适用于 Ajax 加载的内容

> ID：13691938
> 
> 赞同：0
> 
> 时间：2012-12-03T21:22:31.683
> 
> 标签：jquery, ajax

以下是我的代码，当页面加载正常时，无论我们检查什么，数组都有数据。

```
<div id="checkBoxes">
<input type="checkbox" class="applicationCheckbox" value="1" />
<input type="checkbox" class="applicationCheckbox" value="2" />
<input type="checkbox" class="applicationCheckbox" value="3" />
<input type="checkbox" class="applicationCheckbox" value="4" />
</div>

<script type="text/javascript">
$(".applicationCheckbox:checked").each(function(){
    applications[i] = $(this).val();
    i++;
});
</script> 
```

但是，如果我从 jquery .append() 中附加一些复选框，并且如果我选择了曾经出现的复选框，则数组返回 Empty :(

请帮我解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:24:44.637

将事件`click`或`change`事件附加到您的复选框..

```
 $(function(){
       $('body').on('click',.applicationCheckbox , function(){
           $(".applicationCheckbox:checked").each(function(i){
              applications[i] = $(this).val();
            });
        });
    }); 
```

因为您正在动态添加元素，所以您需要**委托事件**。

身体可以用任何静态父级替换..

**完整代码**

```
var applications = [];
$(document).on('click', '.applicationCheckbox', function() {

    applications = $(".applicationCheckbox:checked").map(function() {
        return this.value;
    }).get();

    console.log(applications);
});

var i = 5;
$('#btn').on('click', function() {
    $('#checkBoxes').append('<input type="checkbox" class="applicationCheckbox" value="' + i + '" />');
    i++;
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/Jm6dY/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-12T01:41:10.803

试试这个

```
$('.applicationCheckbox').on('input', function(){
  if ($(this).is(':checked')) {
    applications[i] = $(this).val();
    i++;
  }
}); 
```

# ajax - 在执行 jquery ajax Get 时，Access-Control-Allow-Origin 不允许 Origin null

> ID：13691939
> 
> 赞同：1
> 
> 时间：2012-12-03T21:22:32.167
> 
> 标签：ajax, jquery

我正在尝试使用 jquery ajax 从这里下载 xml： [http ://www.maciejko-sklep.pl/components/com_esklep/integracja.php?type=cenuj&pass=JH64HU7](http://www.maciejko-sklep.pl/components/com_esklep/integracja.php?type=cenuj&pass=JH64HU7)

或任一 html：链接：[http ://www.maciejko-sklep.pl/components/com_esklep/integracja.php?type=html&pass=4FMIHGfd](http://www.maciejko-sklep.pl/components/com_esklep/integracja.php?type=html&pass=4FMIHGfd)

我得到这个错误 Origin null is not allowed by Access-Control-Allow-Origin。

我试图弄清楚这一点，任何人都知道如何解决这个问题并以某种方式从这些链接中的任何一个下载内容。Ps 当我将链接粘贴到 url 中时它工作正常，但我无法发送 ajax 请求。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:27:27.757

跨域 ajax 请求受浏览器限制，除非服务器明确[启用了 cors](http://enable-cors.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T21:59:28.657

将此添加到您的 php 文件的顶部：

```
<?php header('Access-Control-Allow-Origin: *'); ?> 
```

它解决了我的访问控制允许来源问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T01:53:37.277

这是我解决这个问题的方法
[http://www.cypressnorth.com/blog/programming/cross-domain-ajax-request-with-xml-response-for-iefirefoxchrome-safari-jquery/](http://www.cypressnorth.com/blog/programming/cross-domain-ajax-request-with-xml-response-for-iefirefoxchrome-safari-jquery/)

# android - 除非您更新 Google Play 服务（通过 Bazaar），否则此应用将无法运行

> ID：13691943
> 
> 赞同：101
> 
> 时间：2012-12-03T21:22:48.053
> 
> 标签：android, google-maps, android-mapview, google-maps-android-api-2

我正在测试适用于 Android 的新 Google Maps API V2，当应用程序启动时我会收到以下消息：

![MainActivity 显示错误消息](../Images/e65b714813753d1d2fa72e0b85e36e8a.png)

*这是在 4.1 模拟器上运行的。*

这是我的`AndroidManifest.xml`文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.maptest"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <permission
        android:name="com.example.maptest.permission.MAPS_RECEIVE"
        android:protectionLevel="signature"/>
    <uses-permission android:name="com.example.maptest.permission.MAPS_RECEIVE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <!-- Require OpenGL ES version 2 -->
    <uses-feature
          android:glEsVersion="0x00020000"
          android:required="true"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <meta-data
            android:name="com.google.android.maps.v2.API_KEY"
            android:value="##myapikey##"/>

    </application>
</manifest> 
```

文件 MainActivity.java：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

文件 activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.MapFragment"/>
</RelativeLayout> 
```

单击“更新”会使应用程序崩溃，并显示以下堆栈跟踪：

```
E/Trace(1034): error opening trace file: No such file or directory (2)
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
W/GooglePlayServicesUtil(1034): Google Play services out of date.  Requires 2010100 but found 1
D/gralloc_goldfish(1034): Emulator without GPU emulation detected.
D/AndroidRuntime(1034): Shutting down VM
W/dalvikvm(1034): threadid=1: thread exiting with uncaught exception (group=0x40a13300)

E/AndroidRuntime(1034): FATAL EXCEPTION: main
E/AndroidRuntime(1034): android.content.ActivityNotFoundException: No Activity found to handle Intent
  { act=android.intent.action.VIEW dat=http://play.google.com/store/apps/details? \
  id=com.google.android.apps.bazaar flg=0x80000 pkg=com.android.vending }
E/AndroidRuntime(1034):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1545)
E/AndroidRuntime(1034):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
E/AndroidRuntime(1034):     at android.app.Activity.startActivityForResult(Activity.java:3351)
E/AndroidRuntime(1034):     at android.app.Activity.startActivityForResult(Activity.java:3312)
E/AndroidRuntime(1034):     at android.app.Activity.startActivity(Activity.java:3522)
E/AndroidRuntime(1034):     at android.app.Activity.startActivity(Activity.java:3490)
E/AndroidRuntime(1034):     at com.google.android.gms.internal.c$2.onClick(Unknown Source)
E/AndroidRuntime(1034):     at android.view.View.performClick(View.java:4084)
E/AndroidRuntime(1034):     at android.view.View$PerformClick.run(View.java:16966)
E/AndroidRuntime(1034):     at android.os.Handler.handleCallback(Handler.java:615)
E/AndroidRuntime(1034):     at android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime(1034):     at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(1034):     at android.app.ActivityThread.main(ActivityThread.java:4745)
E/AndroidRuntime(1034):     at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(1034):     at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(1034):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
E/AndroidRuntime(1034):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
E/AndroidRuntime(1034):     at dalvik.system.NativeStart.main(Native Method) 
```

我还引用了 Google Play Services 项目。我在这里做错了什么？

**更新**

Google 问题跟踪器 ( [https://issuetracker.google.com/issues/35822258](https://issuetracker.google.com/issues/35822258) ) 中的相应错误已在不久前解决。

现在您可以在模拟器中使用 Google Maps Android API 并使用 Play 服务创建虚拟设备，如本答案所述：

[https://stackoverflow.com/a/46246782/5140781](https://stackoverflow.com/a/46246782/5140781)

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-13T22:07:01.200

**更新**

**Google 地图 API v2 现在安装在最新的 Google 系统映像（api:19 ARM 或 x86）上。
因此，您的应用程序应该只使用新图像。无需安装这些文件。**

我一直在尝试在模拟器下运行 Android Google Maps V2 应用程序，一旦我最终运行 Google Play 服务，我将我的 SDK 更新为 Google Play 服务修订版 4，我的模拟器将不再运行我的应用程序。

我现在已经弄清楚如何从我的变压器平板电脑更新我的模拟器。（您不需要平板电脑，因为您可以下载以下文件。）

我使用 Titanium Backup 来备份我的[Asus Eee Pad Transformer](https://en.wikipedia.org/wiki/Asus_Eee_Pad_Transformer) (TF101)，然后从备份中抓取 com.android.vending 和 com.google.android.gms [APK](http://en.wikipedia.org/wiki/APK_%28file_format%29)文件。

我将这些安装在配置了平台的模拟器上：4.1.2，API 级别：16，CPU Intel/Atom x86）并且我的 Google Maps V2 应用程序再次运行。

这就是全部.. 不需要有关 /system/app 的其他步骤。

我的应用程序仅使用 Google Maps API，毫无疑问，如果您使用其他 Google Play 服务，则需要执行更多步骤。

最新 Google Play 服务的新文件：

*   [com.google.android.gms-20140218.apk](https://mega.co.nz/#!OR82UKbT!ualgRzV92D1-6SBD6wUqBKUgBpFoeYBKvotQUB2NWY4)

*   [com.android.vending-20140218.apk](https://mega.co.nz/#!GQFDETTb!uWPygDxdTr81cd6QRQx-Iqn-9H6u3MKfMijS10ubkMI)

与以前相同的说明：使用任何[CPU](http://en.wikipedia.org/wiki/Central_processing_unit) / [ABI](https://en.wikipedia.org/wiki/Application_binary_interface)、非 Google API 目标（版本 10-19 工作）和[GPU](https://en.wikipedia.org/wiki/Graphics_processing_unit)仿真打开或关闭创建一个新模拟器，然后安装文件：

```
adb install com.android.vending-20140218.apk
adb install com.google.android.gms-20140218.apk 
```

如果您要升级现有的模拟器，那么您可能需要通过以下方式卸载以前的版本：

```
adb uninstall com.android.vending
adb uninstall com.google.android.gms 
```

就这样。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-12-04T10:25:19.363

根据在 Google+ 上[与*Android 开发者*](https://plus.google.com/+AndroidDevelopers/posts/Tyz491d96Ci)的讨论，目前无法在模拟器上运行新的 Map API。

（评论来自昨天23:18的Zhelyazko Atanasov，不知道怎么直接链接）

此外，在实际设备上运行时，您看不到“ **（通过 Bazaar） ”部分，并且更新按钮会打开 Play 商店。**我假设 Bazaar 旨在在 Android 模拟器上提供 Google Play 服务，但它还没有准备好......

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-12-07T14:32:09.143

我花了大约一天时间在 Android 模拟器上配置新的 gmaps [API](http://en.wikipedia.org/wiki/Application_programming_interface)（Google Maps Android API v2）。我在互联网上找到的那些方法都没有对我正常工作。但我还是做到了。方法如下：

1.  使用以下配置创建一个新的模拟器：

![在此处输入图像描述](../Images/d46a271042972c5ce3f7f266fd0a887b.png)

在安装必要的应用程序时，由于各种错误，我无法配置其他版本。

2）启动模拟器并安装以下应用程序：

*   谷歌登录服务.apk
*   GoogleServicesFramework.apk
*   电话天空.apk

您可以使用以下命令执行此操作：

2.1) `adb shell mount -o remount,rw -t yaffs2 /dev/block/mtdblock0 /system`
2.2) `adb shell chmod 777 /system/app`
2.3-2.5)`adb push Each_of_the_3_apk_files.apk /system/app/`

[下载 APK 文件](http://www.dropbox.com/sh/20hcf8kxdk19z3c/Ukc8uGnk7p)的链接。我已经从我的根 Android 设备中复制了它们。

*   [谷歌登录服务.apk](http://www.dropbox.com/s/lfde3juixuy88rg/GoogleLoginService.apk)
*   [GoogleServicesFramework.apk](http://www.dropbox.com/s/9kurwyhbbuecaea/GoogleServicesFramework.apk)
*   [电话天空.apk](http://www.dropbox.com/s/9x8924gtb52ksn6/Phonesky.apk)

3)在模拟器上安装*Google Play Services*和*Google Maps 。*如果我从*Google Play*商店安装它们，我会遇到错误 491。我将应用程序上传到模拟器并在本地运行安装。（您可以使用它`adb`来安装它）。应用程序链接：

*   [谷歌地图](http://www.dropbox.com/s/koo4wiwqg8agy8n/com.google.android.apps.maps-1.apk)
*   [谷歌播放服务](http://www.dropbox.com/s/bh058hbrelccfsr/com.google.android.gms-2.apk)

4）经过这些步骤后，我在模拟器上成功运行了一个演示示例。这是一个屏幕截图：

![谷歌地图](../Images/4ffd2d893d0ebebd784233d95da57128.png)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-12-06T00:19:03.623

我第二次回答这个问题，因为我尝试过的最初不起作用的解决方案现在起作用了，我可以重新创建步骤以使其起作用:)

我也有一种感觉，缺少 Google Play 商店是这里的罪魁祸首，所以我尝试通过此链接上的建议将 Google Play 商店安装到模拟器上，[并](http://www.piotrbuda.eu/2012/05/installing-google-play-on-android-emulator.html)结合[此链接](http://blog.apkudo.com/2012/08/08/run-google-play-on-an-emulator-and-pretend-to-be-any-device/)。我遇到了一些困难，但最后我成功安装了 Google Play Store 并通过下载一些随机应用程序对其进行了测试。但是地图活动继续显示带有“更新”按钮的消息。该按钮会将我带到商店，但在那里我会收到有关“找不到项目”的消息，并且地图仍然无法使用。那一刻我放弃了。

昨天，我不小心启动了同一个测试应用程序，它成功了！我很困惑，但很快我就从它正在工作的模拟器和新的干净的模拟器中做了一个差异，我已经确定了 /data/app/ 目录中正在工作的两个应用程序：com.android.vending-1。 apk 和 com.google.android.gms-1.apk。这很奇怪，因为当我按照这些站点的说明安装 Google Play 商店时，我将 Phonesky.apk、GoogleServicesFramework.apk 和 GoogleLoginService.apk 推送到不同的文件夹 /system/app。

无论如何，现在 Android Google Maps API v2 正在我的模拟器上运行。这些是执行此操作的步骤：

* * *

创建一个新的模拟器

*   对于*设备*，选择“5.1'' WVGA (480 x 800: mdpi)”
*   对于*目标*，选择“Android 4.1.2 - API level 16”
*   对于“CPU/ABI”，选择“ARM”
*   将其余部分保留为默认值

这些是对我有用的设置。我不知道不同的。

* * *

启动模拟器

* * *

通过 ADB install 命令安装[com.android.vending-1.apk](http://www.filedropper.com/comandroidvending-1)和[com.google.android.gms-1.apk](http://www.filedropper.com/comgoogleandroidgms-1)

* * *

谷歌地图现在应该可以在你的模拟器中运行了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-08T05:49:16.340

我创建了一个[（德语）描述如何让它工作](http://linuxchef.blogspot.de/2013/05/google-maps-api-v2-im-android-emulator.html)。您基本上需要一个至少具有 API 级别 9 且没有 Google API 的模拟器。然后，您必须从有**根**设备中获取 APK：

```
adb -d pull /data/app/com.android.vending-2.apk
adb -d pull /data/app/com.google.android.gms-2.apk 
```

并将它们安装在模拟器中：

```
adb -e install com.android.vending-2.apk
adb -e install com.google.android.gms-2.apk 
```

如果您的模拟器至少具有 API 级别 14 并另外安装，您甚至可以运行本机 Google Maps 应用程序`com.google.android.apps.maps-1.apk`

玩得开心。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-30T13:34:24.063

我通过执行以下步骤解决了这些问题：

*   **在模拟器中：**

    您必须使用最新的 API `Google APIs(Google Inc.)-API Level 19`。

    执行屏幕截图本身中的其余操作。

    ![在此处输入图像描述](../Images/a683f66c7ae5f7706f7e2f04c618d0e3.png)

*   **API 密钥：**

    创建新的 API 密钥并仔细检查 Google Map API 密钥和 SHA 密钥。

*   **谷歌播放服务：**

    您必须下载最新的 Google Play 服务 [com.android.vending-4.8.20.apk](http://www.androidfilehost.com/?fid=23501681358540606)。如果 google play 服务无法正常工作，则在该站点中您可以在互联网上找到很多名为`com.android.vending 4.8.20.apk`.

    您可以使用命令提示符运行 Google play Services `adb install com.android.vending 4.8.20.apk`。

    **注意：**您必须下载最新的 Google play 服务，因为每年都会在互联网上更新最新版本。

    **输出**：

    ![在此处输入图像描述](../Images/7aff75a4218e2766b9a2e0fa72cbb568.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-11T12:32:23.570

我一直在尝试在模拟器下运行 Android Google Maps v2，我找到了很多方法来做到这一点，但没有一个对我有用。我在 Logcat 中总是有这个警告，`Google Play services out of date. Requires 3025100 but found 2010110`当我想在模拟器上更新 Google Play 服务时，什么也没发生。问题是 com.google.android.gms [APK](http://en.wikipedia.org/wiki/APK_%28file_format%29)与我的 Android SDK 中的库版本不兼容。

我在模拟器上安装了这些文件“com.google.android.gms.apk”、“com.android.vending.apk”，我的应用[Google Maps](http://en.wikipedia.org/wiki/Google_Maps) v2 运行良好。不需要有关 /system/app 的其他步骤。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-23T13:18:59.047

除非您更新 Google Play 服务，否则此应用将无法运行。我已经尝试了很长时间，但我仍然没有得到地图......即使我修改了以下评论给出的 Google Play 服务，也只出现了一个空白屏幕......

* * *

检查您的播放服务清单文件并检查 APK 文件 com.google.android.gms 的版本代码。在下面，它是“3136110”。下载这些 APK 文件并从 DOS 提示符安装，但在安装之前运行您的目标模拟器。

```
package="com.google.android.gms"
android:versionCode="3136110"
android:versionName="3.1.36 (673201-10) 
```

我从[这个链接](http://ge.tt/9x9n4lg)获得了这些 APK 文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-03T07:06:50.017

更新到 ADT 22.0.1 后，由于 Android 私有库，谷歌地图服务出现错误，应用程序崩溃。所以我终于找到了解决方案，它对我有用。

只需安装 Google Play 服务库，然后转到`google-play-service/libproject/google-play-services_lib`from `https://www.dropbox.com/sh/2ok76ep7lmav0qf/9XVlv61D2b`。将其导入您的工作区。清理您要使用 gogole-play-services-lib 的项目，然后再次构建它并转到*项目*->*属性*-> *Java BuildPath* -> 选择“Android Private Libraries, Android Dependencies, google-play-service”

在属性本身中，转到 Android，然后选择任何版本，然后选择添加并选择 google-play-service-lib，然后按应用，最后确定。

最后，转到项目 -> Android 工具 -> Android 支持库。接受许可证并在安装后运行您的项目。

它会正常工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-11T04:11:52.310

我找到了一个很好的解决方案，它可以让您在模拟器中测试您的应用程序，并且不需要您恢复到旧版本的库。查看[Stack Overflow 问题的答案*Running Google Maps v2 on the Android emulator*](https://stackoverflow.com/a/17036337/1241606)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-12-03T11:32:20.370

```
 just change it to 

compile 'com.google.android.gms:play-services-maps:9.6.0'
compile 'com.google.android.gms:play-services-location:9.6.0' 
```

这对我有用，当前版本是 10.0.1

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-21T14:48:03.633

从 Android SDK Manager 安装：Extras: Google Play services

# jquery - jQuery旋转图像？

> ID：13691946
> 
> 赞同：0
> 
> 时间：2012-12-03T21:23:01.310
> 
> 标签：jquery

我有一个看起来像这样的仪表：

![在此处输入图像描述](../Images/3a7b3111a1c09a961f0300d63da8b68d.png)

我可以保持蓝色的阴影相同，所以我需要做的就是让红色箭头从 0% 旋转到我从 JSON 文件中得到的任何百分比。

是否有一个简单的 Jquery 插件可以做到这一点，我在 IE7-IE8 中也需要它。

我找到了类似的插件，但似乎没有一个在 IE 中工作。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:24:44.077

使用 jQuery 旋转：[http](http://code.google.com/p/jqueryrotate/) ://code.google.com/p/jqueryrotate/ 目前支持

1.  互联网浏览器 6.0 >
2.  火狐 2.0 >
3.  野生动物园 3 >
4.  歌剧 9 >
5.  谷歌浏览器

使用起来真的很简单：

```
$("#img").rotate(45); 
```

您可以在 WIKI 上找到更多信息：[http ://code.google.com/p/jqueryrotate/wiki/Examples](http://code.google.com/p/jqueryrotate/wiki/Examples)

# c# - 在冗长的异步 Postack 期间从进度表中查询

> ID：13691953
> 
> 赞同：2
> 
> 时间：2012-12-03T21:23:27.460
> 
> 标签：c#, asp.net, sql, ajax, pagerequestmanager

我正在将一个数据库接口从 InfoPath 迁移到 Visual Studio 中的 .NET Web 应用程序。SQL Server 数据库设置为用户执行单个程序，启动其他程序，启动更多程序等。整个数据库完成其程序（“模型运行”），大约需要 30 分钟.

在这些单个过程中的每一个结束时，都会将一条记录插入到名为 sysProgressAudit 的表中。我想将此表绑定到更新面板中的网格视图，以便它可以不断刷新并且用户可以监控模型运行的进度。但是，由于数据绑定也是回发，恐怕我无法在模型运行时同步刷新gridview（因为原始存储过程不会完全返回）。

是否可以在任何 PageRequestManager 事件中不断刷新更新面板？您认为对于长时间运行的查询和需要同时刷新表的最佳解决方案是什么？

我想我可以启动查询而不让它返回任何东西（原始 InfoPath 方法），但我会失去很多错误处理和异常捕获功能......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T15:53:27.567

您应该查看 SignalR 以获取状态。或者您可以在计时器上进行 ajax 调用，获取状态信息，然后更新网格。

# entity-framework - DbContext 中的表审计

> ID：13691956
> 
> 赞同：0
> 
> 时间：2012-12-03T21:23:46.730
> 
> 标签：entity-framework

我知道您可以覆盖对象中的`SaveChanges()`方法`DbContext`来更新审计属性值。但是，当我想更新审计列而不将它们实际映射到我的实体时会发生什么？

有没有办法告诉实体框架在“要更新的列”列表中包含额外的未映射列值？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:16:51.630

嗯……审计不可知论……所以你不知道这些字段是否一开始就存在？还是您不在乎是否设置了字段？

如果后者可以只添加列但不需要它们吗？我个人通过继承将 CreatedDate、CreatedBy、ModifiedDate、ModifiedBy 添加到我的大多数实体中。IE 你可以有一个像这样的 AuditableEnity 类：

```
public class AuditableEnity
{
    public int? CreatedById { get; set; }

    [Display(Name = "Created Date")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy H:mm}")]
    public DateTime? CreatedDate { get; set; }

    public int? ModifiedById { get; set; }

    [Display(Name = "Modified Date")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy H:mm}")]
    public DateTime? ModifiedDate { get; set; }
} 
```

然后你不必用样板属性来搞乱你的所有模型。然后你只需添加一点。

然后你的 SaveChanges() 看起来像这样：

```
 public override int SaveChanges()
    {
        //Only get changes from the auditable entities
        var changeSet = ChangeTracker.Entries<AuditableEnity>();

        ...

        if (changeSet != null)
        {
            foreach (var entry in changeSet.Where(c => c.State != EntityState.Unchanged))
            {
                if (entry.State == EntityState.Added)
                {
                    if (entry.Entity.OverrideAuditing == false)
                    {
                        entry.Entity.CreatedById = userId;
                        entry.Entity.CreatedDate = DateTime.UtcNow;
                    }
                }

                entry.Entity.ModifiedById = userId;
                entry.Entity.ModifiedDate = DateTime.UtcNow;
            }
        }            

        return base.SaveChanges();
    } 
```

# sql-server - 如何为 sql server 数据库选择排序规则？

> ID：13691957
> 
> 赞同：0
> 
> 时间：2012-12-03T21:23:48.287
> 
> 标签：sql-server, sql-server-2012, collation, culture

我正在使用许多包含来自不同语言的数据的 sql server 2012 数据库。我一直在阅读这些内容，并发现让 sql server 数据库的排序规则正确是需要仔细考虑的事情。我不熟悉这样的，真的可以做一些帮助。让我概述一下，哪个数据库中有哪些语言：

*   数据库 1 - 俄罗斯数据
*   数据库 2 - 波兰语和英语数据
*   数据库 3 - 吉尔吉斯斯坦和俄罗斯数据

我该如何决定每个数据库的排序规则？有没有我可以遵循的指南或任何提示？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:43:51.270

请参阅此处获取指南（还不是 SQL 2012 的版本，但应该是相同的）：

*   [http://msdn.microsoft.com/en-us/library/ms144250.aspx](http://msdn.microsoft.com/en-us/library/ms144250.aspx)
*   [http://msdn.microsoft.com/en-us/library/aa174903(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa174903(v=sql.80).aspx)

此外，无论排序规则如何，我都建议始终使用`NVARCHAR`/`NCHAR`列而不是`VARCHAR`/ `CHAR`。（我也会说`NTEXT`，但无论如何在 2008 年及更高版本中已弃用）。

```
Database 1 - Russian data - `Cyrillic_General_CI_AS`
Database 2 - Polish and English data - `SQL_Polish_Cp1250_CI_AS_KI_WI`
Database 3 - Kyrgyz and Russian data - `Cyrillic_General_CI_AS` 
```

注意：我不是 100% 使用波兰语和英语，比如按字母顺序排序数据。其他的我还是很有信心的。

# xaml - 如何更改 Microsoft Player Framework 中的进度条？

> ID：13691964
> 
> 赞同：0
> 
> 时间：2012-12-03T21:24:17.743
> 
> 标签：xaml, windows-8

在 Microsoft Player Framework 的 Preview 2 中，他们添加了一个不确定的缓冲进度条。如何将其更改为戒指或将其移除，以便我可以继续使用已有的戒指？

编辑：我目前正在使用 11 月 8 日发布的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T17:01:34.040

如果使用播放器框架的 Xaml 版本，您可以设置 BufferingPlugin.BufferingViewStyle 以覆盖 BufferingView 的样式（这是定义进度条的位置）。

# java - SocketException：权限被拒绝：连接

> ID：13691966
> 
> 赞同：5
> 
> 时间：2012-12-03T21:24:29.553
> 
> 标签：java, sockets

我想知道在什么其他情况下会从该行抛出此 (SocketException: Permission denied: connect) 错误

```
SocketAddress socketAddress = new InetSocketAddress("86.143.5.165", 6464);
// Set a 3s timeout
clientSocket.connect(socketAddress, 3000); 
```

有一些与权限相关的 Android 问题，以及使用端口 < 1024 时。我在端口 6464 上运行一个简单的 java 客户端/服务器应用程序，并且我正在使用 java 1.6.0_32（在阅读了 Java 1.7.0_7 添加后IPv6 支持）。

我已将端口 80 转发到我的服务器（通过在浏览器中访问我的外部 IP 在客户端计算机上进行验证），并且端口 6464 也已打开。

为什么客户端会被拒绝连接？

编辑：尝试从服务器本身连接到服务器时，我最初确实收到了这个错误。（显然，我想这就像一部电话，因为你会听到一个忙碌的音调）。我有一个朋友测试它，他可以连接。我现在从不在 LAN 上的笔记本电脑连接（即使用 3g 手机作为热点），但奇怪的是仍然出现错误。

编辑2：

```
java.net.SocketException: Permission denied: connect
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.PlainSocketImpl.doConnect(Unknown Source)
at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
at java.net.PlainSocketImpl.connect(Unknown Source)
at java.net.SocksSocketImpl.connect(Unknown Source)
at java.net.Socket.connect(Unknown Source)
at runtime.MyGame.main(MyGame.java:31)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at com.sun.javaws.Launcher.executeApplication(Unknown Source)
at com.sun.javaws.Launcher.executeMainClass(Unknown Source)
at com.sun.javaws.Launcher.doLaunchApp(Unknown Source)
at com.sun.javaws.Launcher.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)
#### Java Web Start Error:
#### Socket failed to connect 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:30:00.390

客户端没有被“拒绝连接”。它被本地操作系统拒绝连接*。*

Java 1.4 中添加了 IPv6 支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T22:15:33.680

这与客户端上非常本地化的网络设置有关。其他客户端可以毫无问题地连接，我认为这可能与工作组或特定的本地客户端防火墙有关。谢谢大家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:27:01.600

好吧，首先，给我们“MyIpAsAString”和端口会很有用。无论如何，您确定服务程序正在该 IP 和端口上运行吗？这通常是为什么，或者您用于连接的代码本身是不正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-20T08:12:56.747

对于那些登陆这里与我有类似问题的人。

`Spock` `groovy`我在运行测试时收到此错误`maven`。直接运行`groovy`测试运行良好，而从`maven`失败中运行它们。

为了解决这个问题，配置`maven-surefire-plugin`永不分叉。

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.19.1</version>
            <configuration>
                <forkMode>never</forkMode>
            </configuration>
        </plugin> 
```

不知道为什么这解决了问题 - 欢迎发表评论。

# json - d3.js 用 json 更新垂直条形图

> ID：13691968
> 
> 赞同：1
> 
> 时间：2012-12-03T21:24:32.300
> 
> 标签：json, d3.js, bar-chart, real-time-updates

我正在尝试使用 d3 创建我的家庭电力监控项目的仪表板。我苦苦挣扎的地方是 json 并且只刷新了部分数据。

下面的脚本绘制了一个温度计。我使用带有 svg 环绕的垂直条形图来绘制温度计轮廓。

json 以下列格式返回当前温度：[{"x":1354590256000,"value":18.6}]

我可以重新绘制整个图表，我可以从 0 开始重新绘制条形图，我无法做到的是让值从最后一个值过渡到当前值。

任何帮助都感激不尽！我看了这么多在线 d3 更新示例（包括尝试破译 barchart2 示例），我的头脑在旋转！

```
var chart = d3.select("#svgpathSVGdata");
var svg =  chart.append("svg:svg").
attr("width", 160).
attr("height", 300);

var g;
var update = function () {
d3.json(
'http://192.168.0.10/energy/lastvalue.php?id=36' ,
function(data) {

var x = d3.scale.linear().domain([0, data.length]).range([30, 160]);
var y = d3.scale.linear().domain([15, 30]).range([100 , 250 ]);

if (g)
g.remove();  

g = svg.append('svg:g')

g.selectAll("text").
  data(data).
  enter().
  append("svg:text").
  attr("x", 65).
  attr("y", 190).
  attr("text-anchor", "start").
 transition().delay(function (datum,index){ return index * 300;}).
 duration(1200).
  text(function(datum) { return datum.value +"\u00B0"+"c"; }).
  attr("class", "thermtemp");

g.selectAll('rect')
  .data(data)
  .enter()
 .append("rect")
  .attr("x", function(datum, index) { return x(index); })
  .attr("y", function(datum) { return 300 - 100 /*- y(datum.value)*/; })
  .attr("width", 25)
  .attr("fill", "#2d578b")
 .transition().delay(function (datum,index){ return index * 300;})
 .duration(1200)
 .attr("height", function(datum) { return y(datum.value)- 100; }) 
 .attr("y", function(datum) { return  (300 - y(datum.value)) ; });           

g.append("svg:text")
.attr("class", "thermsubtitle")
.attr("dy", ".71em")
.attr("text-anchor", "start")
.attr("transform", "translate(100,100)")
.attr("transform", "rotate(-90,100,95)") 
.text("Label");            

// THERMOMETER OUTLINE START           

g.append("svg:path")
  .attr("d","M 30 50 L 30 200   a25,25 0 1,0 25 0 L 55 50 M 30 50 a15,15 0 0 1 25 0")
  .style("stroke-linecap", "round")
  .style("stroke-width", 6)
  .style("stroke", "rgb(204,204,204)")
  .style("fill", "none")
  .style('shape-rendering', 'geometricPrecision')

g.append("svg:path")
  .attr("d","M 30 200  a25,25 0 1,0 25 0")
  .style("stroke-linecap", "round")
  .style("stroke-width", 6)
  .style("stroke", "rgb(204,204,204)")
  .style("fill", "steelblue")
  .style('shape-rendering', 'geometricPrecision')
  .style("fill-opacity", 0.6);

// THERMOMETER OUTLINE END            
}  );         
 }

update();

setInterval(function() {
//  data.shift();
 //data.push(next());
console.log("redraw");

d3.timer.flush();// avoid memory leak when in background tab
update();
}, 6500); 
```

# google-apps-script - ListBox不能设置为下拉框和多选？

> ID：13691969
> 
> 赞同：0
> 
> 时间：2012-12-03T21:24:32.700
> 
> 标签：google-apps-script

我正在尝试创建一个 ListBox 设置为允许选择多个列表项的下拉列表。我已经[阅读](https://stackoverflow.com/questions/11439059/google-apps-script-listbox-to-dropdown-box)了下拉列表和多选是互斥的，尽管我不确定[GWT](http://google-web-toolkit.googlecode.com/svn/javadoc/2.4/com/google/gwt/user/client/ui/ListBox.html#getVisibleItemCount%28%29)是否是预期的行为。

有解决方法或替代方法吗？我希望用户从 20 个项目的列表中选择 Fusion 表中的查询。任何使用有限空间的解决方案就足够了。

这应该在[Google Apps 脚本](http://code.google.com/p/google-apps-script-issues/)问题中报告为缺陷还是增强？

我希望这个示例代码是一个多选下拉列表：

```
function doGet() {
 var app = UiApp.createApplication().setTitle('foo');
 var main = app.createVerticalPanel().setTitle('main');
 var lb = app.createListBox(true);
 lb.setWidth("200px");
 lb.addItem("first");
 lb.addItem("second");
 lb.addItem("third");
 lb.addItem("fourth");
 lb.addItem("fifth");
 lb.addItem("sixth");
 lb.setVisibleItemCount(1);
 app.add(main);
 main.add(lb);
 return app;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T17:05:41.753

好吧，从逻辑上讲，这是不可能的。下拉框旨在允许用户选择单个值，因为当下拉框展开并且您选择一个值时，它意味着立即折叠回来。

为了节省空间以及多选，您可以简单地将多选列表框的高度降低到 20px。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-31T12:16:30.053

如果您按照 Magento CMS-> Pages 操作，然后选择任何页面或创建一个新页面，您会在其中找到一个商店视图下拉列表，直到现在我还想不通，但是因为它已经为 magento 管理面板完成了，我从逻辑上思考可以创建一个下拉列表框..

# lucene - 查询匹配字段中的所有标记，而不是任何标记

> ID：13691971
> 
> 赞同：1
> 
> 时间：2012-12-03T21:24:37.553
> 
> 标签：lucene

对于脚本，我需要将广告标题与 lucene 索引进行比较。
此索引包含几个关键字以及广告匹配时要采取的操作。

例如：

```
(keyword,action,new_category,optional)
"red volvo","recategorize","cars","red" 
```

这个想法是我需要根据关键字字段查询整个广告标题。两者（查询和索引）都是用我自己的分析器分析的，它有词干、小写等。

我遇到的问题是部分匹配。例如：
“我在卖一匹红马”匹配“红沃尔沃”。

如果反过来（广告被编入索引，我需要按关键字查询），我可以这样做：

```
q=+red +volvo 
```

但这不是一个选择，因为我需要处理大量的广告。

那么，具体的问题是，**有没有办法强制字段中的所有标记与查询匹配？**
我可以使用 KeywordAnalyzer，以便将整个“red volvo”视为一个标记，但我无法将整个广告标题分析为单个关键字，因为它不会匹配任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T16:54:02.710

鉴于您确实想准确地捕捉到“red volvo”这个短语，而不仅仅是“red”或“volvo”，那么我认为您使用关键字分析器对其进行索引是正确的。但是您希望使用比您搜索的字段更长的查询进行搜索，这与典型用例相反。

我不愿推荐它，但我认为进行此查询的正确方法可能是使用与用于创建索引的分析器不同的分析器进行查询。

如果索引的短语具有可预测的大小，例如 2-5 个单词，那么使用[ShingleFilter](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/shingle/ShingleFilter.html)可以从长查询中生成您需要的术语，以将其作为关键字进行搜索。

像这样的东西：

```
Analyzer analyzer = new WhitespaceAnalyzer(Version.LUCENE_36);
analyzer = new ShingleAnalyzerWrapper(analyzer, 1, 5); //wrapper that adds a ShingleFilter to the analyzer
QueryParser parser = new StandardQueryParser(analyzer);  
Query query = parser.parse(query, defaultField);
searcher.search(query, 10); 
```

这将仅在空格上拆分，然后生成长度为 1 到 5 个标记的搜索词，因此在示例中：“我正在卖一匹红马”将产生诸如“我”、“我”、“我是”之类的词”、“红马”、“我在卖”、“我在卖一匹红马”等。

我认为空白过滤器可能是使这项工作与关键字一起使用的最佳选择，但如果您遇到空白字符，它会拆分为空格以外的字符，或者连续多个空格，您可能会遇到问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T23:27:33.650

听起来您可以使用 Lucene 的[MemoryIndex](http://lucene.apache.org/core/4_0_0/memory/index.html)：“此类针对相对较小的瞬态实时数据（前瞻性搜索）的大量查询的全文搜索”

# wcf - 端口特定的 wcf 错误

> ID：13691974
> 
> 赞同：3
> 
> 时间：2012-12-03T21:24:45.277
> 
> 标签：wcf, exception, port

我们有一个简单的具有证书传输安全性的 WCF NetTCPbinding 文件传输实用程序，还有一个客户端服务可以监视文件夹并将文件从我们的客户端推出。和一个服务器端服务，它在我们的接收服务器上侦听和接收文件，这两个 WCF 服务都作为 Windows 服务托管。

该服务目前在端口 444 上运行良好，我们必须将其更改为端口 443。在我们的测试环境中，一切都在 443 上正常工作。但是，当尝试将我们的一个客户端切换到端口 443 时，我们会看到以下错误：

> 服务器拒绝了升级请求。在流的位置 0 读取消息帧格式时出错（状态：>ReadingUpgradeRecord） 服务器堆栈跟踪：在 System.ServiceModel.Channels.ConnectionUpgradeHelper.ValidateUpgradeResponse(Byte[] >buffer, Int32 count, ClientFramingDecoder 解码器)...

在服务器上打开 wcf 跟踪时，我们还会看到这个额外的异常：

> 预期的记录类型“版本”，发现“22”。

我发现的关于这些错误的所有信息似乎都与对象类型、枚举等有关，这对我来说没有任何意义，因为服务只需切换端口即可正常运行。不幸的是，这不是一个解决方案，因为我们必须使用端口 443。

其他想法：端口 443 可用，并且没有其他进程正在监听它。IIS 已关闭。

如果您有任何想法或需要任何其他信息，请告诉我。非常感谢您的宝贵时间。

# ruby - 我如何在 Espresso 框架中使用 Slim 引擎

> ID：13691981
> 
> 赞同：1
> 
> 时间：2012-12-03T21:25:17.087
> 
> 标签：ruby

好的，看来我会选择 Espresso。它真的很干净而且很容易。

是否有对 Slim 的内置支持？

在文档中找不到任何地方如何使用它。

试试这个：

```
require 'e'
require 'slim'

class Blog < E

  engine :Slim
  # etc.
end 
```

并得到一个关于没有`Slim`找到引擎的奇怪错误，虽然我加载了它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:50:49.240

这里的问题是`Espresso`用于`Tilt`渲染。

并且`Tilt`没有对`Slim`.

但是，确实具有对:)`Slim`的内置支持`Tilt`

您所要做的就是注册一个新`Tilt`模板：

```
require 'slim'

Tilt::SlimTemplate = Slim::Template 
```

就是这样。现在你可以像这样使用它：

```
class Blog < E

  engine :Slim
  engine_ext :slim
  # etc.
end 
```

请注意`engine_ext :slim`- 它将通知`Espresso`模板扩展。

您很可能会将模板命名为`template-name.slim`

# html - 二等舱的风格没有像预期的那样凌驾于上一课的风格之上

> ID：13691982
> 
> 赞同：1
> 
> 时间：2012-12-03T21:25:18.757
> 
> 标签：html, css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T21:31:49.437

You're assuming that lower placement in the stylesheet means higher priority. In CSS, the more specific the selector, the higher priority. There are many other factors that determine priority, but in your case this should work -

Just use a more specific selector for the disabled class:

```
input[type="button"].login_selection_button.gen-btn-disabled{
    /* disabled styles here */
} 
```

And as Zeta pointed out, applying specific styles generically can lead to unwanted effects. I suppose my observation was more that the padding and font sizes were different and by selectors, the first declaration would take priority no matter where the disabled style was defined.

# github - 如何设置 GitHub 存储库以使某些团队成员无法写入主分支

> ID：13691983
> 
> 赞同：0
> 
> 时间：2012-12-03T21:25:21.813
> 
> 标签：github

新手 GitHub 问题：我在 GitHub 中设置了一个**组织**并创建了一个**私有**存储库。现在，我如何只允许某些成员能够推送到主分支，而允许其他成员能够创建和推送除主分支之外的分支？

还是我想错了？我基本上想要一个审查流程，以便在合并到 master 之前必须审查代码，并且不想让贡献者能够直接推送到 master 分支。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:43:08.383

最好的办法是将写入您的主仓库（master 所在的地方）限制为您允许的开发人员。并且您授予另一个读取权限；这样他们就可以`fork`回购（分叉将保持私有）。

然后，当他们想与 Master 合并时，他们会发送一个拉取请求。

如果未经授权的开发人员需要在他们之间共享分支，他们可以相互添加分支作为远程和拉/拉请求作为任何其他 repo。

希望这有帮助！

# javascript - 如何将更多视频源添加到我的 javascript 代码中？

> ID：13691988
> 
> 赞同：0
> 
> 时间：2012-12-03T21:25:58.397
> 
> 标签：javascript, html, video, html5-video

> 我有 5 个不同的视频，我希望他们向他们添加一个以上的来源，以便他们可以在更多浏览器中播放，但我不确定如何制作它，以便您可以做到这一点。这是我的 javascript 看起来非常重复的内容

```
function addVideo1() {
  var changeStuff = document.getElementById("myVideo");
    changeStuff.src = "video/demoreel.mp4";

}

function addVideo2() {
 var changeStuff = document.getElementById("myVideo");
    changeStuff.src = "video/video1.mp4";
}

function addVideo3() {
    var changeStuff = document.getElementById("myVideo");
    changeStuff.src = "video/video2.mp4";
}

function addVideo4() {
    var changeStuff = document.getElementById("myVideo");
    changeStuff.src = "video/video3.mp4";

}

function addVideo5() {
    var changeStuff = document.getElementById("myVideo");
    changeStuff.src = "video/video4.mp4";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:37:23.787

要创建多个来源，您需要在 video 标签内包含 source 元素，而不是使用视频的 source 属性。采用：

```
sourceElement=document.createElement("source")
sourceElement.source=someSource
sourceElement.type=someType
changeStuff.appendChild(sourceElement) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:53:19.053

试试这个[jsFiddle](http://jsfiddle.net/jesus_tesh/fPKK8/)，它应该做你想做的。

**啊！**我是用 jQuery 做的，对不起。我没注意。好的，我回去用普通的 javascript 做了它。

**HTML**

```
<div id="video"><video></video></div>
<ul>
    <li><a href="#" data-video="video1.mp4">Video 1</a></li>
    <li><a href="#" data-video="video2.mp4">Video 2</a></li>
    <li><a href="#" data-video="video3.mp4">Video 3</a></li>
</ul> 
```

**JS**

```
var elems = document.getElementsByTagName("a");
for (i = 0; i < elems.length; i ++) {
    elems[i].addEventListener("click", function () {
        var video = this.dataset["video"];
        var source = document.createElement("source");
        source.src = video;
        var container = document.getElementById("video");
        var v = container.firstChild;
        v.innerHTML = "";
        v.appendChild(source);
    });
} 
```

**CSS**

没必要，只是为了“美化”一点

```
html { padding: 10px; }
#container { width: 450px; }
#video { width: 320px; height: 240px; border: 3px solid #CCC; }
ul { margin: 10px 0; width: 320px; padding: 0; }
ul li { display: inline; margin: 0 10px 0 0; padding: 0;  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T21:46:38.100

您可以尝试这样的事情（未经测试，在移动设备上输入）。

```
function addSource(id,type,path) {

    var vid=document.getElementById(id);
    vid.innerHTML+='<source src="'+path+'" type="'+type+'">';
} 
```

# html - HTML/CSS 模态对话框：将未知大小的内容居中——溢出时滚动

> ID：13691995
> 
> 赞同：0
> 
> 时间：2012-12-03T21:26:18.163
> 
> 标签：html, css

我有一个创建模式对话框的 javascript 函数。我希望未知或大小变化的内容水平和垂直居中。如果它超出屏幕，我希望它滚动。

它由四个div组成：

第一个创建半透明覆盖，创建时可用的下一个最高 z-index。第二个在其顶部创建另一个完全透明的区域，显示设置为 table 并且 z-index 高于先前的覆盖。第三个显示 table-cell 第四个是内容，显示 inline-block。

```
<html>
    <head>
    </head>
    <body>
        <div class="overlay" style="z-index=1;">
            <div class="modaltable" style="z-index=2;">
                <div class="modalcell">
                    <div class="modalcontent">
                        <p>this is some text</p>
                        <p>this is some text</p>
                        <p>this is some text</p>
                        <p> ... repeat to overflow ... </p>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html> 
```

​</p>

```
.overlay
{
    background-color: #000;
    opacity: .7;
    filter: alpha(opacity=70);
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow:auto;
}
.modaltable
{
    display: table;
    text-align: center;
    vertical-align:middle;
    background: rgb(236, 236, 236); /*Fallback if rgba not supported*/
    background: rgba(236, 236, 236, 0);
    background: none\9;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#00ececec, endColorstr=#00ececec); /*IE*/
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.modalcell
{
    display: table-cell;
    vertical-align: middle;
    background:rgb(236, 236, 236); /*Fallback if rgba not supported*/
    background:rgba(236, 236, 236, 0);
    background: none\9;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#00ececec, endColorstr=#00ececec); /*IE*/
}
.modalcontent
{
    display:inline-block;
    overflow:auto!important;
    background-color:white;
    padding:5px;
} 
```

​</p>

我无法让滚动工作。我搜索了高和低，找不到一个好的解决方案。任何帮助深表感谢。

我已经建立了一个 jsfiddle：http: [//jsfiddle.net/4K6ug/](http://jsfiddle.net/4K6ug/)

谢谢，

布拉德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T22:35:28.690

我已经更新了你的[jsfiddle](http://jsfiddle.net/4K6ug/1/)

你已经穿上`position:fixed`了`overlay`和`modaltable`。然而，这些元素是嵌套的，所以只有一个应该在这样的位置。

通过嵌套它们，父元素 ( `overlay`) 什么也不包含。所以它只适用于它的尺寸`height:100%;`定义`overflow:hidden`（z-index 在这种情况下也没用。

# google-plus - Google Apps 和检索 Google Plus 用户 ID

> ID：13691997
> 
> 赞同：1
> 
> 时间：2012-12-03T21:26:40.820
> 
> 标签：google-plus

我们目前正在使用 Google Apps for Education 并启用了 Google Plus。我查看了许多 API 的谷歌提供[https://developers.google.com/oauthplayground/](https://developers.google.com/oauthplayground/)并没有找到答案。

我希望能够在谷歌应用中查询用户并找出他们的 Google Plus ID。

Google+ 有自己的 API，我知道它处于教育测试阶段，所以可能只是他们没有添加到这个列表中：[https](https://developers.google.com/google-apps/) ://developers.google.com/google-apps/在应用程序 API 下。

是否有可能通过调用组合从我们的用户电子邮件中获取 Google Plus 用户 ID？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T16:57:52.450

这取决于你想要做什么，据我所知，你不能只在你的系统中根据他们的电子邮件查找某人的 Google+ id。

但是，如果用户登录，您可以获得用户 ID，如 History client side starter [Google+ history client-side flow](https://developers.google.com/+/history/client-side-flow)中所述。您无需编写时刻，而是阅读个人资料，然后可以检索他们的 Google+ 帐户的 ID。您将需要来自启用了 Google+ 服务的[Google API 控制台](https://code.google.com/apis/console)的客户端 ID ，与客户端流程相同。获得此 ID 后，您可以创建 HTML 页面，该页面将使用 JavaScript 客户端获取 Google+ ID。

以下代码显示了如何执行此操作：

```
<html>
<script src="https://apis.google.com/js/client.js"></script>
<script src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
  function onSignInCallback(authResult){
    // Set the access token on the JavaScript API Client
    gapi.auth.setToken(authResult);

    var args = {
      'path': '/plus/v1moments/people/me',
      'method': 'GET',
      'callback': function(response) {
        var profile = response;
        console.log(profile);
        alert('id is ' + profile.id);
      }
    };
    gapi.client.request(args);
  }
</script>

<body>
  <!-- Render the sign-in button -->
  <g:plus action="connect"
          clientid="YOUR CLIENT ID"
          scope="https://www.googleapis.com/auth/plus.me"
          callback="onSignInCallback"></g:plus>
</body>
</html> 
```

当您运行上述代码时，它将弹出登录用户的 ID 作为警报。如果您尝试为非 Google（例如 GMail）帐户执行此操作，请使用您的域凭据登录以获取该 Google+ 帐户 ID。

这是[此代码的演示](http://wheresgus.com/profiledemo/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T16:46:38.840

我无法让 2012 年 12 月 4 日发布的答案起作用，也许 google+ api 从那时起发生了变化，或者我只是错过了一些东西。但是，我确实使用谷歌的快速入门示例获得了个人资料信息（包括原始发帖人想要的 id）：

[https://developers.google.com/+/quickstart/javascript](https://developers.google.com/+/quickstart/javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T10:55:46.433

```
Follow these simple steps to find your Google Plus User ID:

1) Login to your Google+ account.

2) From the side menu click on the Profile icon

3) In the address bar you will see your complete Google+ URL. It will look something like this:

https://plus.google.com/100009709084787102522/posts

4) Your Google Plus User ID is the long series of numbers. in this instance my Google+ ID is the following:

100009709084787102522 
```

参考：[http ://www.jumpmobi.com/miscellaneous/what-is-my-google-google-plus-user-id/](http://www.jumpmobi.com/miscellaneous/what-is-my-google-google-plus-user-id/)