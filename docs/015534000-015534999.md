# StackOverflow 问答 15534000-15534999

# matlab - Dpll, SAT (satisfability) 问题, 需要 DPLL Function or Procedure?

> ID：15534000
> 
> 赞同：-3
> 
> 时间：2013-03-20T20:26:43.893
> 
> 标签：matlab, satisfiability

这是我的问题，我在 Matlab 中遇到了 SAT 问题（满意度）

实际上我需要一个名为 DPLL 的函数，我在这里的某个地方看到了它，但它是在 java 中，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:55:09.090

MATLAB 有一个嵌入式 JVM，可以轻松地从 MATLAB 内部调用 Java 类。

这在[文档中得到了很好的解释](http://www.mathworks.com/help/matlab/using-java-libraries-in-matlab.html)

# c++ - c++ boost asio异步编译错误

> ID：15534004
> 
> 赞同：-2
> 
> 时间：2013-03-20T20:27:00.743
> 
> 标签：c++, linux, boost, boost-asio

我正在编译这个简单的 boost::asio 异步服务器，它因这个错误而失败，有什么想法吗？

```
#include <iostream>
#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/thread.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/enable_shared_from_this.hpp>

using namespace std;

using namespace boost::asio;
using namespace boost::posix_time;
typedef boost::shared_ptr<ip::tcp::socket> socket_ptr;

int main()
{

    io_service service;
    void start_accept(socket_ptr sock);
    void handle_accept(socket_ptr sock, const boost::system::error_code & err);
    ip::tcp::endpoint ep( ip::tcp::v4(), 2001);
    ip::tcp::acceptor acc(service, ep);
    socket_ptr sock(new ip::tcp::socket(service));
    start_accept(sock);
    service.run();

}

void start_accept(socket_ptr sock)
{
    acc.async_accept(*sock, boost::bind( handle_accept, sock, _1) );
}

void handle_accept(socket_ptr sock, const boost::system::error_code & err) 
{
    if (err) return;
    socket_ptr sock(new ip::tcp::socket(service));
    start_accept(sock);
} 
```

**错误：** 编译这个

```
[root@kris server]# g++ -o test3 test3.cpp -lboost_system -lpthread -lboost_thread-mt
test3.cpp: In function ‘void start_accept(socket_ptr)’:
test3.cpp:31: error: ‘acc’ was not declared in this scope
test3.cpp:31: error: ‘handle_accept’ was not declared in this scope
test3.cpp: In function ‘void handle_accept(socket_ptr, const boost::system::error_code&)’:
test3.cpp:38: error: declaration of ‘socket_ptr sock’ shadows a parameter
test3.cpp:38: error: ‘service’ was not declared in this scope 
```

**编译 Freds 版本时出错：**

```
#include <iostream>
#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/thread.hpp>
#include <boost/shared_ptr.hpp>
#include <boost/enable_shared_from_this.hpp>

using namespace std;

using namespace boost::asio;
using namespace boost::posix_time;
typedef boost::shared_ptr<ip::tcp::socket> socket_ptr;

class myAcceptor
{
    io_service service;
    ip::tcp::endpoint ep( ip::tcp::v4(), 2001);
    ip::tcp::acceptor acc(service, ep);
    socket_ptr sock(new ip::tcp::socket(service));

    myAcceptor(): ep(ip::tcp::v4(), 2001),acc(service,ep),
    sock(new ip::tcp::socket(service))
    { start_accept(); }

    void run()
    {
        service.run();
    }

    void start_accept()
    {
        acc.async_accept(boost::bind( handle_accept,  _1) );
    }

    void handle_accept(const boost::system::error_code & err)
    {
        if (err) return;
        sock = socket_ptr(new ip::tcp::socket(service));
        start_accept(sock);
    }
};
int main()
{
    myAcceptor acceptIt;
    acceptIt.run();
}

g++ -o test4 test4.cpp -lboost_system -lpthread -lboost_thread-mt

test4.cpp:18: error: ‘boost::asio::ip::tcp::v4’ is not a type
test4.cpp:18: error: expected identifier before numeric constant
test4.cpp:18: error: expected ‘,’ or ‘...’ before numeric constant
test4.cpp:19: error: ‘service’ is not a type
test4.cpp:19: error: ‘ep’ is not a type
test4.cpp:20: error: expected identifier before ‘new’
test4.cpp:20: error: expected ‘,’ or ‘...’ before ‘new’
test4.cpp: In constructor ‘myAcceptor::myAcceptor()’:
test4.cpp:22: error: class ‘myAcceptor’ does not have any field named ‘ep’
test4.cpp:22: error: class ‘myAcceptor’ does not have any field named ‘acc’
test4.cpp:23: error: class ‘myAcceptor’ does not have any field named ‘sock’
test4.cpp: In member function ‘void myAcceptor::start_accept()’:
test4.cpp:33: error: ‘((myAcceptor*)this)->myAcceptor::acc’ does not have class type
test4.cpp:33: error: no matching function for call to ‘bind(<unresolved overloaded function type>, boost::arg<1>&)’
/usr/include/boost/bind/bind.hpp:1461: note: candidates are: boost::_bi::bind_t<boost::_bi::unspecified, F, typename boost::_bi::list_av_1<A1>::type> boost::bind(F, A1) [with F = void (myAcceptor::*)(const boost::system::error_code&), A1 = boost::arg<1>]
/usr/include/boost/bind/bind.hpp:1710: note:                 boost::_bi::bind_t<typename boost::_bi::dm_result<M T::*, A1>::type, boost::_mfi::dm<M, T>, typename boost::_bi::list_av_1<A1>::type> boost::bind(M T::*, A1) [with A1 = boost::arg<1>, M = void(const boost::system::error_code&), T = myAcceptor]
test4.cpp: In member function ‘void myAcceptor::handle_accept(const boost::system::error_code&)’:
test4.cpp:39: error: invalid use of member (did you forget the ‘&amp;’ ?)
test4.cpp:40: error: no matching function for call to ‘myAcceptor::start_accept(<unresolved overloaded function type>)’
test4.cpp:31: note: candidates are: void myAcceptor::start_accept()
test4.cpp: In function ‘int main()’:
test4.cpp:22: error: ‘myAcceptor::myAcceptor()’ is private
test4.cpp:45: error: within this context
test4.cpp:26: error: ‘void myAcceptor::run()’ is private
test4.cpp:46: error: within this context 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:42:20.333

> `test3.cpp:31: error: ‘acc’ was not declared in this scope`

什么弗雷德里克和MM。说。

> `test3.cpp:31: error: ‘handle_accept’ was not declared in this scope`

从`start_accept depends`on 开始`handle_accept`，反之亦然，您将不得不转发声明一个。在您的代码中，前向`handle_accept`声明`start_accept`。

```
test3.cpp:38: error: declaration of ‘socket_ptr sock’ shadows a parameter
test3.cpp:38: error: ‘service’ was not declared in this scope 
```

可能您只是想将`sock`参数传递给`start_accept`? 不过，这个功能看起来很没有意义。

另外，我不得不说，如果无法阅读如此基本的编译错误，您将很难使用 asio 和一般的 boost。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:36:04.273

The `acc` variable is only in scope in `main`. You need to make it a global variable - of define everything in a class.

```
class myAcceptor
{
  io_service service;
  ip::tcp::endpoint ep;
  ip::tcp::acceptor acc;
  socket_ptr sock;

  myAcceptor(): ep(ip::tcp::v4(), 2001),acc(service,ep),
    sock(new ip::tcp::socket(service))
  { start_accept(); }

  void run()
  {
    service.run();
  }

  void start_accept()
  {
    acc.async_accept(boost::bind( handle_accept, _1) );
  }

  void handle_accept(const boost::system::error_code & err) 
  {
    if (err) return;
    sock = socket_ptr(new ip::tcp::socket(service));
    start_accept(sock);
  }
};

int main()
{
  myAcceptor acceptIt;
  acceptIt.run();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:38:41.397

使`acc`全局（不推荐），或将其传递给函数：

```
void start_accept(socket_ptr sock,  ip::tcp::acceptor &acc)
{
    acc.async_accept(*sock, boost::bind( handle_accept, sock, _1) );
} 
```

# cloud-foundry - 将 ruby 应用程序推送到 V2 云 - 错误，没有这样的文件 ruby _versions.yml

> ID：15534008
> 
> 赞同：0
> 
> 时间：2013-03-20T20:27:03.413
> 
> 标签：cloud-foundry

（交叉发布在[Google 网上论坛](https://groups.google.com/a/cloudfoundry.org/forum/?fromgroups=#!topic/vcap-dev/nQfyzZbwb4k)上）

我有一个手工制作的 V2 安装，我正在尝试向其推送一个 ruby​​ 应用程序。它被正确识别为 ruby​​ 应用程序，因为它报告它正在“安装 ruby​​”。但随后抛出以下内容：

```
Installing ruby.
/usr/lib/ruby/1.9.1/psych.rb:297:in `initialize': No such file or directory - ruby_versions.yml (Errno::ENOENT)
            from /usr/lib/ruby/1.9.1/psych.rb:297:in `open'
            from /usr/lib/ruby/1.9.1/psych.rb:297:in `load_file'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:192:in `block (2 levels) in ruby_versions'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:190:in `chdir'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:190:in `block in ruby_versions'
            from /usr/lib/ruby/1.9.1/tmpdir.rb:83:in `mktmpdir'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:189:in `ruby_versions'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:235:in `install_ruby'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/ruby.rb:77:in `compile'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/bin/compile:11:in `block in <main>'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/lib/language_pack/base.rb:84:in `log'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/vendor/ruby/bin/compile:10:in `<main>'
/home/cdavisafc/cloud-fabric/dea_ng/buildpacks/lib/installer.rb:17:in `compile': Buildpack compilation step failed: (RuntimeError)
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/lib/buildpack.rb:15:in `block in stage_application'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/lib/buildpack.rb:11:in `chdir'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/lib/buildpack.rb:11:in `stage_application'
            from /home/cdavisafc/cloud-fabric/dea_ng/buildpacks/bin/run:10:in `<main>' 
```

在调试中更深入一点，我发现在查看 buildpack 缓存和 blobstore 之后，它会尝试 curl [https://s3.amazonaws.com/heroku-buildpack-ruby/ruby_versions.yml](https://s3.amazonaws.com/heroku-buildpack-ruby/ruby_versions.yml)。我认为 S3 存储桶是可以访问的，因为在该 URL 上获取 bundler-1.3.2.tgz 似乎已经成功。

有任何想法吗？

谢谢，科妮莉亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:58:51.560

我不能 100% 确定那个特定的错误，但我们确实有一个 Heroku 构建包的分支，可能值得尝试。

[https://github.com/cloudfoundry/heroku-buildpack-ruby](https://github.com/cloudfoundry/heroku-buildpack-ruby)

所以只需再次推送应用程序，但要这样做；

```
vmc push --buildpack=git://github.com/cloudfoundry/heroku-buildpack-ruby.git 
```

# sql-server - 如何使用 SQL Server 堆叠数据

> ID：15534011
> 
> 赞同：2
> 
> 时间：2013-03-20T20:27:13.850
> 
> 标签：sql-server, unpivot

好的，所以我有一些包含大量列的数据，比如 400。

```
UID, ID, ID, var1, var2, . . . var400

1, 23,  4651,  0,     0, . . .   1
2, 47,  8567,  1,     1, . . .   5 
```

我需要将它堆叠起来，使其看起来像这样：

```
UID, ID, ID,    Variable,  Value
1,   23, 4651    var1,       0
1,   23, 4651    var2,       0
. . .
1,   23, 4651    var400,     1
2,   47, 8567,   var1        1
2,   47, 8567,   var2        1
. . . 
2,   47, 8567,   var400      5 
```

必须有一些相对简单的方法来执行这种转换。但我想不出它是什么。有人有想法么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:44:24.410

好的，这适用于 SQL Server 2005+。你有静态版本`UNPIVOT`：

```
SELECT UID, ID1, ID2, Variable, Value
FROM (SELECT * FROM YourTable) T
UNPIVOT (Value FOR Variable IN (var1, var2, ....var400)) AS U; 
```

这是一个带有演示**[的 sqlfiddle 。](http://sqlfiddle.com/#!3/4d1a7/1)**

这将起作用，但您需要编写 400 列中的每一列。如果您不想这样做（但我建议您这样做），您可以先提取列名并使用动态 SQL：

```
DECLARE @sql NVARCHAR(MAX), @cols NVARCHAR(MAX)

SELECT @cols = STUFF((SELECT DISTINCT ',' + QUOTENAME(COLUMN_NAME) 
                      FROM INFORMATION_SCHEMA.COLUMNS
                      WHERE TABLE_NAME = 'YourTable'
                      AND COLUMN_NAME LIKE 'Var%'
               FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'),1,1,'')

SET @sql = '
SELECT UID, ID1, ID2, Variable, Value
FROM (SELECT * FROM YourTable) T
UNPIVOT (Value FOR Variable IN ('+@cols+')) AS U;'

EXEC(@sql) 
```

**[这是一个](http://sqlfiddle.com/#!3/4d1a7/2)**动态版本的sqlfiddle。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:54:52.657

如果您使用的是 SQL Server 2008+，那么您可以使用`CROSS APPLY`with `VALUES`：

```
select t.uid,
  t.id1,
  t.id2,
  c.variable,
  c.value
from YourTable t
cross apply
(
  values 
    ('var1', t.var1),
    ('var2', t.var2),
    ('var3', t.var3)
) c (variable, value); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/4d1a7/3)感谢@Lamak 的小提琴

# c++ - 我在哪里可以找到工作的 winnt.h？Rubenvb 的似乎非常错误

> ID：15534015
> 
> 赞同：2
> 
> 时间：2013-03-20T20:27:21.133
> 
> 标签：c++, windows, ming

查看 rubenvb 的 4.7.2 下载（c++.exe --version is rubenvb-4.7.2-release）中的 winnt.h 中的定义，可以发现许多内联汇编的例程根本无法正常工作。至少它们不在我的 i7 处理器上（这些可能是为其他处理器编码的吗？）。

然而，考虑到 gcc 的开发方式，其他一些实现似乎可能在这个文件上做得更好。

所以，2个问题：

1.  有谁知道在哪里可以找到更好的winnt.h？
2.  如果做不到这一点，有谁知道如何联系reubanvb？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:19:43.110

Windows SDK 可免费下载。您可以在[此处](http://msdn.microsoft.com/en-us/windows/desktop/hh852363.aspx)获得适用于 Windows 8 的那个，或者使用[这个](http://www.microsoft.com/en-us/download/details.aspx?id=8279)来坚持以 Windows 7 为目标。当然，它包括调用 Windows 函数所需的所有标头，包括`WinNT.h`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-17T04:52:37.287

我与 Mingw-w64 团队合作更新了 winnt.h（和其他头文件）中的 asm 例程。据我所知，它们现在都是正确的。

# ruby-on-rails - Rails 表单标签

> ID：15534018
> 
> 赞同：0
> 
> 时间：2013-03-20T20:27:32.497
> 
> 标签：ruby-on-rails, forms, labels

我正在尝试在我的导轨中生成一个标签。标签最终应如下所示：

```
<label for="member_ids_index><span></span>collaborator.name</label> 
```

其中 index 是我下面循环的当前迭代，collaborator.name 是一个字符串。出于某种原因，我无法让我的 f.label 语句正确生成它。有人能帮我吗？到目前为止我所拥有的如下。

```
<% if !@current_user.all_collaborators.nil? %>
  <% @current_user.all_collaborators.each_with_index do |collaborator, index| %>
    <%= check_box_tag "project_ids[#{index}]", collaborator.id %>
    <%= f.label :member_ids_, "<span></span>collaborator.name %>
    <br/>
  <% end %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:33:22.070

使用`label_tag`：

```
<% if !@current_user.all_collaborators.nil? %>
  <% @current_user.all_collaborators.each_with_index do |collaborator, index| %>
    <%= check_box_tag "project_ids[#{index}]", collaborator.id %>
    <%= label_tag "member_ids_#{index}" do %>
      <span></span><%= collaborator.name %>
    <% end %>
    <br/>
  <% end %>
<% end %> 
```

# javascript - 如何将项目放入按特定键分组的分组数组中

> ID：15534021
> 
> 赞同：1
> 
> 时间：2013-03-20T20:27:45.577
> 
> 标签：javascript, arrays, object

我在 JS 中的对象方面很新，所以我需要一些帮助。我有以下数组：

```
var persons = [
    { fname : 'Steven', lname : 'Jameson', age : 20 },
    { fname : 'George', lname : 'Thrump', age : 40 },
    { fname : 'Peter', lname : 'Jacobs', age : 60 },
    { fname : 'Peter', lname : 'Thrump', age : 20 },
    { fname : 'Steven', lname : 'Henderson', age : 40 },
    { fname : 'John', lname : 'Jacobs', age : 30 },
    { fname : 'Steven', lname : 'Thrump', age : 50 },
    { fname : 'George', lname : 'Peterson', age : 40 },
    { fname : 'Peter', lname : 'Jameson', age : 60 }
]; 
```

我需要按给定属性对信息进行排序。我试过了`function( array, 'property' )`。就我而言，它将是`function(persons, 'fname')`。我必须实现一个对象，其中包含**不同名称**的键和用于存储具有该名称的每个人的信息的键。例如：

```
Object {
    Steven : everyone with first name Steven,
    George : everyone with first name George,
    Peter : everyone with first name Peter,
    John : everyone with first name John
} 
```

我实现了这一点：

```
function group( array, property ) {
        var object = {};

        for (var i = 0; i < persons.length; i++) {
            object[persons[i][property]] = [];

            object[persons[i][property]].push(persons[i])
        };
    }; 
```

创建具有不同名称的对象作为键，并赋予它们数组作为值。然后我被卡住了，不知道下一步该怎么做？有人可以帮忙吗，如果他有几分钟的时间来解释一下。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:33:36.673

唯一的问题似乎是这一行：

```
object[persons[i][property]] = []; 
```

它为每次迭代执行，在添加 1 个元素之前将每个迭代重置`Array`为空。在设置之前只需要一个条件：

```
if (!(persons[i][property] in object))
    object[persons[i][property] = [];

object[persons[i][property].push(persons[i]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:31:25.697

您应该检查是否`object[persons[i][property]]`已经初始化

```
 function group( persons, property ) {
    var object = {};

    for (var i = 0; i < persons.length; i++) {
        if(!object[persons[i][property]]) {
            object[persons[i][property]] = [];
     }

      object[persons[i][property]].push(persons[i])
    };
    return object;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:37:04.737

```
function group(array, property) {
    var object = {};

    for (var i = 0; i < array.length; i++) {
        var person = array[i];
        if (person[property]) {
            object[person[property]] = object[person[property]] || [];
            object[person[property]].push(person);
        }
    };

    return object;
};

group(persons, "fname"); 
```

# ios - UILabel 动画不正确

> ID：15534022
> 
> 赞同：3
> 
> 时间：2013-03-20T20:27:45.480
> 
> 标签：ios, objective-c, uilabel

出于某种原因，UILabel 的文本想要在没有动画的情况下设置其对齐方式，我无法弄清楚如何让文本与标签的其余部分一起动画。

我现在有以下代码：

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(40,200,100,50)];
[label setText:@"Label Name"];
[label setBackgroundColor:[UIColor blueColor]];
[label setFont:[UIFont systemFontOfSize:17.0]];
[label setTextColor:[UIColor blackColor]];
[label setTextAlignment:NSTextAlignmentCenter];
[self.view addSubview:label];
[UIView animateWithDuration:3 animations:^{
    [label setFrame:CGRectMake(40,200,200,300)];
}]; 
```

此代码在按钮的操作方法中调用。通常动画将与标签的创建分开发生，但我将其放在相同的方法中进行测试。

由于某种原因，当它运行时，标签会按预期完美调整大小，我可以看到框架调整大小。但是，文本会在水平轴上与动画结束时的位置对齐。但是，在垂直轴上，它的动画效果很好。

现在这是动画的样子：

![动画1](../Images/20d8b1a7297a170f617273ba4610732e.png) ![动画2](../Images/1f9ca83270fbcf94fde3c65c0b7607ce.png) ![动画3](../Images/8b24a8a3e34060cb8a78e1d04cda1277.png)

出于某种原因，标签的文本在上下移动时保持居中，但不会像我认为的那样保持左右居中。

我看了一遍，找不到解决这个问题的方法。有谁知道 UILabel 的行为是这样的，是否有任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T14:05:40.503

您可以添加一个 UIView，然后将 UILabel 添加为其子视图：

```
 UIView *view = [[UIView alloc] initWithFrame:CGRectMake(40, 20, 100, 50)];
[view setBackgroundColor:[UIColor blueColor]];
[self.view addSubview:view];

UILabel *label = [[UILabel alloc] init];
[label setText:@"Label Name"];
[label setBackgroundColor:[UIColor clearColor]];
[label setFont:[UIFont systemFontOfSize:17.0]];
[label setTextColor:[UIColor blackColor]];
[label setTextAlignment:NSTextAlignmentCenter];
[label sizeToFit];
[label setNumberOfLines:0];
[label setFrame:CGRectOffset(label.frame, (view.frame.size.width - label.frame.size.width)/2, (view.frame.size.height - label.frame.size.height)/2)];
[view addSubview:label];

 [UIView animateWithDuration:3 animations:^{
 [view setFrame:CGRectMake(40, 20, 200, 300)];
 [label setFrame:CGRectMake((view.frame.size.width - label.frame.size.width)/2, (view.frame.size.height - label.frame.size.height)/2, label.frame.size.width, label.frame.size.height)];
 } completion:^(BOOL finish){

 }]; 
```

# java - 如何确定从 Java 中的文本文件读取的最大值和最小值

> ID：15534024
> 
> 赞同：1
> 
> 时间：2013-03-20T20:27:52.613
> 
> 标签：java, string, text-files, max, min

我正在为一个班级做家庭作业，并且正在寻找一些有用的指示，而不是完整的解决方案。基本上，我必须编写一个 Java 程序，它读取一个文本文件并逐行列出信息，列出行号，最后打印出最大值和最小值以及与每个相关的年份。文本文件包含一年和那一年的温度。因此，它列出了类似“1900 50.9”的内容。我不打算使用阵列或扫描仪，这是作业的一部分。我已经能够成功地让程序根据行数逐行打印出每年和相应的温度。有人告诉我，并且确实使用了 while 循环。现在，我唯一的问题是以某种方式访问​​文本文件，我可以以某种方式区分所有温度，哪个是最大值，哪个是最小值，每个发生在哪一年。我直到现在才寻求帮助，因为我想自己弄清楚，但是作业不再值得任何应得的功劳到迟到的处罚。任何帮助将不胜感激，因为我仍然想解决这个问题。谢谢。

这就是我所拥有的。

```
public class main {

/**
 * @param args the command line arguments
 */

public static void main(String[] args) throws Exception {

File temps = new File ("temps.txt"); //Creates path to temps.txt file
FileReader textReader = new FileReader (temps); //Input information from temps.txt file into file reader
BufferedReader kb = new BufferedReader (textReader); //Use buffered reader to hold temps.txt file info from the file reader

String tempList; //Create string variable named tempList
int lineCount = 0; //Create integer variable named lineCount
String sep = ": Temp "; //Create string variable named sep (short for separation) and set it equal to the literal string ":"
String space = " "; //Create string variable named space and set it equal to an actual space between texts

System.out.println("The following is the provided information from the file input. ");
while ((tempList = kb.readLine()) !=null) { //while loop stating that as long as the text file still has values to read (is not null), continue to execute

    System.out.println("Line " + lineCount++ + ": Year " + tempList.replace(space, sep)); //Prints out the line number (lineCount++), the info from the temps.txt file with a ":" between the year and the number (tempList.replace (space,sep)

}

} 
```

}

到目前为止的输出是这样的：

```
Line 0: Year 1900: Temp 50.9
Line 1: Year 1901: Temp 49
Line 2: Year 1902: Temp 49.7
Line 3: Year 1903: Temp 49.5
Line 4: Year 1904: Temp 47.1
Line 5: Year 1905: Temp 49.1 
```

等等一路...

```
Line 99: Year 1999: Temp 52.7
BUILD SUCCESSFUL (total time: 0 seconds) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:53:58.110

这是一种方法：

```
String tempList; //Create string variable named tempList
int lineCount = 0; //Create integer variable named lineCount
String sep = ": Temp "; //Create string variable named sep (short for separation) and set it equal to the literal string ":"
String space = " "; //Create string variable named space and set it equal to an actual space between texts

String maxValueYear = "";
String minValueYear = "";
double maxValue = 0;
double minValue = Double.MAX_VALUE;
System.out.println("The following is the provided information from the file input. ");
while ((tempList = kb.readLine()) !=null) { //while loop stating that as long as the text file still has values to read (is not null), continue to execute

    String year = tempList.substring(0, tempList.indexOf(space));
    double temp = Double.valueOf(tempList.substring(tempList.indexOf(space), tempList.length()));

    if (temp > maxValue) {
        maxValue = temp;
        maxValueYear = year;
    }
    if (temp < minValue) {
        minValue = temp;
        minValueYear = year;
    }
    System.out.println("Line " + lineCount++ + ": Year " + tempList.replace(space, sep)); //Prints out the line number (lineCount++), the info from the temps.txt file with a ":" between the year and the number (tempList.replace (space,sep)

}

System.out.println("The minimum temp occured in year " + minValueYear + " and was " + minValue);
System.out.println("The maximum temp occured in year " + maxValueYear + " and was " + maxValue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:31:12.897

您需要使用一些变量来跟踪最低和最高温度。
每次出现更高（更低）的温度时，您都会更新变量。

好的，在循环外从非常高的最大值和非常低的最小值开始。
一旦您在循环内看到（较高）较低温度，您就可以调整变量。
在循环之后你回顾一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:54:42.500

```
Highest Seen So Far: -Infinity
    (or any really low number so that any number you see next will be higher)
Lowest Seen So Far: Infinity
    (or any really high number so that any number you see next will be lower)

Walk through each data point "d":
    is d higher than your latest "highest seen so far"?
        -> if yes, your new highest seen so far is now d
    is d lower than your latest "lowest seen so far"?
        -> if yes, your new lowest seen so far is now d

Your highest seen so far is now the highest data point
Your lowest seen so far is now the lowest data point 
```

在伪代码中：

```
highest = -inf
lowest = inf

for d in dataset:
  if d > highest:
    highest = d
  if d < lowest:
    lowest = d

print "highest: " + highest
print "lowest: " + lowest 
```

这是一个例子

假设您的数据集是 5 2 8 4

```
Step 0
    Highest: -inf
    Lowest: inf

Step 1
  See d = 5...that's higher than highest -inf, so new highest is 5.
  See d = 5...that's lower than lowest -inf, so new lowest is 5
    Highest: 5
    Lowest: 5

Step 2:
  See d = 2...that's not higher than highest 5...highest is still 5
  See d = 2...that is lower than lowest 5...new lowest is 2
    Highest: 5
    Lowest: 2

Step 3:
  See d = 8...that's higher than highest 5...new highest is 8
  See d = 8...that's not lower than lowest 2...lowest is still 2
    Highest: 8
    Lowest: 2

Step 4:
  See d = 4...that's not higher than highest 8...highest is still 8
  See d = 4...that's not lower than lowest 2...lowest is still 2
    Highest: 8
    Lowest: 2

Result:
    Highest: 8
    Lowest: 2 
```

# c# - MonoMac WebView - 显示控制台或 Web 检查器？

> ID：15534027
> 
> 赞同：4
> 
> 时间：2013-03-20T20:27:59.873
> 
> 标签：c#, webview, xamarin, monomac

试图弄清楚如何从 MonoMac 应用程序中显示 webkit 控制台或检查器。看起来可以通过设置 WebKitDeveloperExtras 在 Objective-C 中完成。

```
[USER_DEFAULTS registerDefaults:[NSDictionary dictionaryWithObject: 
[NSNumber numberWithBool:YES] forKey:@"WebKitDeveloperExtras"]]; 
```

如何在 MonoMac.WebKit.WebView 中设置 WebDeveloperExtras？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T00:51:58.273

尝试这个：

```
var defaults = NSUserDefaults.StandardUserDefaults;
defaults.SetBool (true, "WebKitDeveloperExtras");
defaults.Synchronize(); 
```

# r - 在 R 中调用多边形时禁止重绘

> ID：15534032
> 
> 赞同：4
> 
> 时间：2013-03-20T20:28:13.967
> 
> 标签：r, graphics

我想在 R 中的一个绘图上绘制 60,000 多个非重叠三角形（非结构化三角形网格的一部分）。目前，每个绘图需要 15-20 分钟，这使得它无法用于制作动画。例如，

```
n <- 100 #Except replace this with 60,000
x <- matrix(runif(3*n), n)
y <- matrix(runif(3*n), n)
cols <- heat.colors(n)[order(x[,1])]
poly <- function(i) {polygon(x[i,], y[i,], col=cols[i])}
plot(0, xlim=c(min(x),max(x)), ylim=c(min(y),max(y)))
sapply(1:n, poly) 
```

是否可以在每个多边形之后抑制多边形（）重绘？我猜这是最耗时的步骤，并且在手册页中没有提到。对于如何实现这一点的替代建议将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:15:11.507

您可以将多个多边形传递给`polygon`. 您所要做的就是与`NA`. 这是一个代码：

```
cuts <- function(x)
{
    n <- length(x) %/% 3

    map <- rep(c(TRUE,TRUE,TRUE,FALSE), n)

    result <- rep(NA, n*4)

    result[map] <- x

    result
}

set.seed(1234)

n <- 10000
x <- matrix(runif(3*n), n)
y <- matrix(runif(3*n), n)
cols <- heat.colors(n)[order(x[,1])]
plot(0, xlim=c(min(x),max(x)), ylim=c(min(y),max(y)))
polygon(x=cuts(t(x)), y=cuts(t(y)), col=cols) 
```

工作速度快。我已经测试了控制种子并与您的代码生成的图进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:05:44.453

`grid.polygon`这里是使用包的矢量化解决方案`grid`。我使用`lattice`just 来绘制场景（`xyplot(0~0)`~ `plot(0)`）。

```
library(lattice)
library(grid)
xyplot(0~0, xlim=c(min(x),max(x)), ylim=c(min(y),max(y)),
       panel=function(...)
       {
         grid.polygon(x  = as.vector(t(x)),
                      y  = as.vector(t(y)),
                      id = rep(1:n,each=3),
                      gp=gpar(fill=cols),
                      def='native')         
       }) 
```

在我的普通 PC 中生成 60000 个多边形需要不到 30 秒的时间。

# c# - 无效的 URI：当 url 有多个冒号时指定的端口无效

> ID：15534034
> 
> 赞同：3
> 
> 时间：2013-03-20T20:28:14.290
> 
> 标签：c#, httpwebrequest, uri

我正在使用 dnsdynamic.org 指向我家中托管的个人网站。我的家庭IP每个月都会经常更换一次。dnsdynamic.org 提供了一个 web 方法调用来更新 ip。

```
https://username:password@www.dnsdynamic.org/api/?hostname=techno.ns360.info&myip=127.0.0.1 
```

当我通过浏览器调用它时，它工作得很好。当我尝试通过 c# 代码调用它时，它会引发以下异常。

```
Invalid URI: Invalid port specified.
    at System.Uri.CreateThis(String uri, Boolean dontEscape, UriKind uriKind)
    at System.Net.WebRequest.Create(String requestUriString) 
```

由于 url 中有一个冒号，它看起来像 system.uri 尝试将我的密码解析为整数。

我尝试在 .org 之后添加一个端口

```
https://username:password@www.dnsdynamic.org:443 
```

没有运气。

有人可以指点我如何解决这个错误。

我在创建 uri 时尝试了不要转义和转义选项，但仍然无法正常工作。

```
var ri = new Uri("https://username:password@www.dnsdynamic.org/api/?hostname=techno.ns360.info&myip=127.0.0.1",true); 
```

编辑：看起来用户名导致了问题。我的用户名是我的电子邮件地址。我的电子邮件地址以 *.com 结尾。所以 uri 正在尝试解析我的密码。

仍然没有找到解决这个问题的解决方案。我无法更改我的用户名，因为 dnsdyanmic.org 使用电子邮件地址作为用户名。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T20:32:22.340

如果您使用 an`HttpWebRequest`进行请求，则不应在 URI 中包含凭据（如您所知，它是无效的）。

您应该改为将凭据添加到`HttpWebRequest`并让它处理传递它们：

```
// Only broke this up for readability
var uri = new Uri("https://www.dnsdynamic.org/api/?hostname=techno.ns360.info" + 
                  "&myip=127.0.0.1", true);
var cache = new CredentialCache();
cache.Add(uri, "Basic", new NetworkCredential("username", "password"));

var request = WebRequest.Create(uri);
request.Credentials = cache; 
```

# ios - 在 iOS 中，如果不在视图控制器中，应该在哪里创建对象

> ID：15534035
> 
> 赞同：0
> 
> 时间：2013-03-20T20:28:22.730
> 
> 标签：ios, objective-c

我有一个类（从 NSNotificationCenter 获取数据，处理它并再次将其发送到 NSNotificationCenter），我喜欢在我的应用程序启动后立即创建一个实例。我可以从视图控制器中做到这一点，但这似乎很尴尬，因为它们不相关。那么，您认为在哪里适合创建与 UI 不直接相关但应持续应用程序生命周期的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:53:18.423

将代码塞入 App Delegate 是一件很诱人的事情，但要**抵制这种冲动**。理想情况下，应用程序委托应尽可能远离正常的应用程序执行。它是全局实例的唯一原因是它可以充当应用程序和系统之间的委托。为了保持权力分离，初始化一个单例实例`main()`并让它对通知做出反应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:31:33.103

我会在应用程序委托中执行此操作。应用程序委托是最先创建的对象之一（远在您的任何视图控制器之前！），它对所有其他对象全局可见。因此，如果您实例化这个其他类并使该实例成为您的应用程序委托的属性，那么它对所有其他对象也是全局可见的！

正如我在我的书中所说（[http://www.aeth.com/iOSBook/ch13.html#_global_visibility](http://www.apeth.com/iOSBook/ch13.html#_global_visibility)）：

> 您可以自由创建的应用程序委托的公共属性是全局可见的，因为应用程序委托是全局可见的（由于共享应用程序是全局可见的）。

即使您不需要可见性（因为您正在使用通知），应用程序委托也是您拥有的寿命最长的对象；它是在应用程序启动时创建的，并且永远不会被销毁（直到应用程序被杀死）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:30:33.037

如果你不想把那种东西放在 ViewController 中，AppDelegate 通常看起来是个放置它的好地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T20:30:34.177

您应该将需要在正在运行的应用程序的整个生命周期内保持活动状态的项目放在 AppDelegate.h/m 文件中。

# ruby - 简单的红宝石：从get中添加字符串/结果？

> ID：15534038
> 
> 赞同：-2
> 
> 时间：2013-03-20T20:28:47.263
> 
> 标签：ruby, string

获取全名

```
puts 'Hello there, and what\'s your name?'
name= gets.chomp
puts 'Your first name is ' + name + '? What a lovely name!'
puts 'Whats your second name?'
name = gets.chomp
puts 'Your second name is ' + name + '.'
puts 'So whats your last name?'
name = gets.chomp
puts 'So your last name is: ' + name + '.' 
```

我似乎无法得到最后的全名。

```
puts ' Your full name is :' name + name +name '.' 
```

^ 即使我尝试过，这似乎也是错误的。

在估算每个名称后我是否必须创建一个变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:51:39.323

看起来你在变量的概念上遇到了麻烦。

变量是内存中的一个位置，用于存储某种数据。您可以使用变量的名称来引用数据。把它想象成一个带有标签的盒子。为了简单起见，假设你可以在盒子里放一个东西。

当您输入该行时`name = gets.chomp`，您所做的基本上是在说“将用户将输入的信息存储在一个框中，并标记该框`name`。”

盒子是内存中的一个位置。标签是您找到它并检索存储值的方式。

然后，当你`name = gets.chomp`第二次写作时，你所做的几乎相同。您将用户输入的信息（他的第二个名字）存储在标有 的框中`name`。但是，您不只是将此信息添加到框中。您**替换**了旧数据。

然后，当您尝试在 puts 中获取全名时，`Your full name is :' name + name +name '.'`实际上您从同一个“框”中获得了相同的值 3 次。

所以，你需要的是三个不同的“盒子”，或者在编程词汇中，三个变量。如果您对每个名称部分使用不同的变量，您将得到类似于以下代码的内容：

```
puts 'Hello there, and what\'s your name?'
first_name = gets.chomp
puts 'Your first name is ' + first_name + '? What a lovely name!'
puts 'Whats your second name?'
second_name = gets.chomp
puts 'Your second name is ' + second_name + '.'
puts 'So whats your last name?'
last_name = gets.chomp
puts 'So your last name is: ' + last_name + '.'    
puts ' Your full name is :' + first_name + second_name + last_name + '.' 
```

有一些方法可以将更复杂的东西放入变量中。喜欢事物的集合，而不是单个事物。你很快就会明白的。

# java - 填充对象数组

> ID：15534043
> 
> 赞同：2
> 
> 时间：2013-03-20T20:29:04.893
> 
> 标签：java, arrays, object, populate

我目前正在学习 Java，但不太确定如何做到这一点。

目前我有一个员工班

```
public class employee {

private int empID;
private String empName;
private String job;

//constructors;

public employee(){
    this.empID = 0;
    this.empName = "";
    this.job = "";
}
public employee(int empID, String empName, String job){
    this.empID = empID;
    this.empName = empName;
    this. job = job;
}

//gets;

public int getEmpID(){
    return this.empID;
}
public String getEmpName(){
    return this.empName;
}
public String getJob(){
    return this.job;
}

//sets;

public void setEmpID(int empID){
    this.empID = empID;
}
public void setEmpName(String empName){
    this.empName = empName;
}
public void setJob(String job){
    this.job = job;
} 
```

}

在我的主目录中，我创建了一个大小为 2 的员工类型的对象数组，然后只增加数组计数，同时让用户输入一些基本信息，然后另一个循环打印输入的所有信息。

```
import java.util.Scanner;
public class employeeArray {

public static void p(String s) {System.out.println(s);}

public static void main(String args[]){
    Scanner k = new Scanner(System.in);
    int empID, size=0, x=0;
    String empName;
    String job;
    employee [] employees = new employee[2];

    for(size = 0; size < 2; size++)
    {
        p("Employee "+(size+1));
        p("Please enter employee ID number: ");
        empID = k.nextInt(); k.nextLine();
        p("Please enter your name: ");
        empName = k.nextLine();
        p("Please enter your job role: ");
        job = k.nextLine();

        employees[size] = new employee();

        employees[size].setEmpID(empID);
        employees[size].setEmpName(empName);
        employees[size].setJob(job);

    }

    for(x=0; x<2;x++){
        p("Hello employee: "+employees[x].getEmpName()+" your job role is "+employees[x].getJob()+ 
                " your log in ID is 0800"+employees[x].getEmpID());
    }
} 
```

}

我了解如何通过输入填充对象的每个实例，但说我想将大小从 2 增加到 20，但已经有前 10 个“预输入”，所以我可以显示我目前拥有但仍然允许输入的 10 个还有10个。

附言。抱歉我的冗长问题、代码块和术语不佳/缺乏。我是新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T20:31:45.423

当您需要动态调整数组大小时，不要打扰使用数组，除非它是绝对必要的（即使在这种情况下，您也可以通过 转换`ArrayList.toArray(..)`）。

使用 an`ArrayList<Employee>`而不是`Employee[]`. 您不必担心容量，也不必担心删除和移动元素。它还将支持通用容器。

附带说明：Java 的命名约定建议使用`Capitalized`类的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:52:12.390

首先将类名更改为，`Employee`而不是`employee`. 坚持使用 java 命名约定。现在您应该改用 java 实用程序类。例如`ArrayList<Employee>`。`ArrayList`实现了动态调整数组大小，这让用户可以在其中插入尽可能多的数据，而不必担心内部的当前大小，`array`因为`ArrayList`可以处理它。但是在使用`ArrayList`存储`Employee`对象之前，您需要覆盖`equals`方法，`Employee`因为`ArrayList`内部使用此方法来找出某些方法中是否存在类似对象。该`equals`方法在类中如下所示`Employee`：

```
@Override
public boolean equals(Object anObject) 
{
    if (this == anObject) 
    {
        return true;
    }
    if (anObject instanceof Employee) 
    {
        Employee anotherEmployee = (Employee)anObject;
        if ((this.toString()).equals(anotherEmployee.toString()))
        {
            return true;
        }
        return false;
    }
    return false;
}
@Override
public String toString()//Override it so that it could be easier to compare two objects of Employee using toString()
{
    return empID+","+empName+","+job;
} 
```

现在，您可以通过`ArrayList`以下方式使用：

```
List<Employee> list = new ArrayList<Employee>();
for(size = 0; size < 2; size++)
    {
        p("Employee "+(size+1));
        p("Please enter employee ID number: ");
        empID = k.nextInt(); k.nextLine();
        p("Please enter your name: ");
        empName = k.nextLine();
        p("Please enter your job role: ");
        job = k.nextLine();

        Employee employee = new Employee();

        employee.setEmpID(empID);
        employee.setEmpName(empName);
        employee.setJob(job);
        list.add(employee);
    }

   for(int i = 0 ;i < list.size() ; i++){
    Employee employee = list.get(i);
    p("Hello employee: "+employee.getEmpName()+" your job role is "+employee.getJob()+ 
            " your log in ID is 0800"+employee.getEmpID());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:01:43.627

根据您的评论，您实际上不想要一个动态数组，而是输入一个固定大小为 20 和 10 的数组。

例子：

```
int[] intArray = new int[20];

intArray[0] = 1
intArray[1] = 2
intArray[2] = 3
intArray[3] = 4
intArray[4] = 5
intArray[5] = 6
intArray[6] = 7
intArray[7] = 8
intArray[8] = 9
intArray[9] = 10

//now to fill the rest of the slots.
for(int i = 10; i < intArray.length; i++) {
    intArray[i] = i + 1;
} 
```

但是，您将负责跟踪数组中的内容和不包含的内容，并且您不能向数组中添加超过 20 个项目。

编辑：您编辑了您的帖子。使用上面的代码，你可以做你想做的事。如果你真的想在不使用 ArrayList 的情况下动态增加你的数组，你可以使用 System#arrayCopy

[http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy(java.lang.Object](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy(java.lang.Object) , int, java.lang.Object, int, int)

它允许您将现有数组复制到具有新大小的新（空）数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:47:49.930

Java 数组（带有一个小的“a”——一个`[]`对象）在创建时是固定大小的。因此，如果您创建包含 10 个元素的数组，它将始终恰好有 10 个元素（尽管其中一些可能没有非空值）。如果您需要将数组的大小增加到超出当前分配的大小，那么祝您好运！！.... 呃，我的意思是你必须分配一个新的、更大的数组，然后将较小数组的内容复制到其中。

以这种方式复制数组并不是那么低效，但它很笨拙且容易出错，因此有几个 JDK 类（例如 java.util.ArrayList）可以保存可变长度列表并管理丑陋的东西你。（说实话，一般来说，这些类保留一个内部数组并在需要时将其复制到更大的数组中，就像您一样，所以它们效率不高。但它们简化了编码并减少了错误，这就是重点。 )

# apache-flex - 如何使用 actionscript 检查 %USERNAME%

> ID：15534045
> 
> 赞同：1
> 
> 时间：2013-03-20T20:29:12.203
> 
> 标签：apache-flex, shell, actionscript

我正在处理的项目是一个 FLEX 内部网站，在尝试从远程位置访问时也可以登录该网站。当他们在本地访问该站点时，我试图让它显示当前登录的 Windows 用户的用户名。我曾尝试使用 NativeProcess 访问命令行，但在使用 Web 应用程序时不可用。关于我将如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T04:05:35.300

我们在我工作的地方做类似的事情。不幸的是，它不使用前端，而是向后端进程发出请求。如果我没记错的话，我的建议也只能通过 vpn 起作用。基本上，在我的 PHP 后端，我允许 Windows 身份验证，然后使用该 COM 对象调用的结果来获取有关当前用户的数据。然后，我将这些数据发送回我的 Flex 前端、Web 或 AIR，并将其显示给用户，并限制对应用程序各个部分的访问。

# sql-server - 查询以选择一个表中存在另一表中的记录的记录

> ID：15534047
> 
> 赞同：0
> 
> 时间：2013-03-20T20:29:23.697
> 
> 标签：sql-server

我有两张桌子：

```
Appointments    (CustomerID,AppointmentID,SalesRepID,Status,AppointmentDate)

ResultedSales   (CustomerID,AppointmentID,ResultedDate) 
```

我正在寻找约会中的记录，其中：

1.  结果状态（与待处理、已取消、打开等相反）
2.  客户之前已出售给（ResultedSales 中的 CustomerID）
3.  约会未作为销售结果（AppointmentID 不在 ResultedSales 中）
4.  约会发生在客户第一次被出售之后
    （AppointmentDate > AppointmentDate ResultedSales 中该 CustomerID 的最小 AppointmentID 记录）
5.  分配给预约的 SalesRep 与之前的销售相同
    （SalesRepID = 该 CustomerID 的 ResultedSales 中任何 AppointmentID 记录的 SalesRepID）

前三个是通过

```
Select Distinct .AppointmentID from Appointments A
    join ResultedSales RS on A.CustomerID=RS.CustomerID
Where A.StatusID='resulted'
And A.CustomerID in (Select CustomerIDfrom ResultedSales)
And A.AppointmentID Not in (select AppointmentID from ResultedSales) 
```

但我不知道如何实现#4 和#5

任何帮助/提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:44:35.833

```
Select Distinct .AppointmentID from Appointments A
    join ReportedSales RS on A.CustomerID=RS.CustomerID
Where A.StatusID='resulted'

and exists ( select null from ResultedSales innerRSTable1 where innerRSTable1.CustomerID = A.CustomerID)
and not exists ( select null from ResultedSales innerRSTable2 where innerRSTable2.AppointmentID = A.AppointmentID ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:43:19.497

查看`EXISTS` [http://msdn.microsoft.com/en-us/library/ms188336.aspx上的 MSDN 信息](http://msdn.microsoft.com/en-us/library/ms188336.aspx)

```
Select  Distinct A.AppointmentID 
from    Appointments A
join    ResultedSales RS 
        on  A.CustomerID=RS.CustomerID
Where   A.StatusID='resulted'
And     Not Exists (Select 1 
                    From    ResultedSales rs2
                    Where   A.AppointmentID = rs2.AppointmentID)
And     Exists (Select  1
                From    Appointments A2
                Where   A.CustomerID=A2.CustomerID
                And     A.AppointmentDate > A2.AppointmentDate)
And     Exists (Select  1
                From    Appointments A3
                Where   A.CustomerID=A3.CustomerID
                And     A.SalesRepID = A2.SalesRepID) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T15:04:00.400

从另一个论坛得到另一个回复，似乎符合查询的要求。

```
;WITH FirstSales (CustomerID, AppointmentDate, SalesRepID)
AS (
SELECT DISTINCT 
   A.CustomerID
   , MIN(AppointmentDate)
   , A.SalesRepID
FROM ResultedSales RS
JOIN Appointments A
   ON A.AppointmentID = RS.AppointmentID 
   AND A.CustomerID = RS.CustomerID
WHERE StatusID = 'Resulted'
GROUP BY A.CustomerID, A.SalesRepID
)

SELECT DISTINCT 
    A.AppointmentID
FROM Appointments A
    JOIN ResultedSales RS
        ON RS.CustomerID = A.CustomerID
    JOIN FirstSales FS
        ON FS.CustomerID = A.CustomerID
WHERE A.StatusID = 'Resulted'
AND A.AppointmentDate > FS.AppointmentDate
AND A.SalesRepID = FS.SalesRepID
AND A.AppointmentID Not in (select AppointmentID from ResultedSales) 
```

# php - 如何在带有表单的 PHP 页面中使用函数？

> ID：15534053
> 
> 赞同：0
> 
> 时间：2013-03-20T20:29:36.940
> 
> 标签：php, html, forms, function, inputbox

我的 php 网页上有一个 html 表单。有四个输入框。我正在用这些添加新数据。

我想这样做，当我在输入框1中写东西时，输入框2将是相同的，但用“-”而不是空格..

例如，当我在输入框 1 中写“你好吗”时，输入框 2 必须是“你好吗”。我该怎么做？：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:38:17.873

只需在您的页面上添加此 JavaScript

```
 document.getElementById('box1').onkeyup = function (){
    document.getElementById('box2').value = document.getElementById('box1').value.replace(' ','-')
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:30:42.057

你可以用一些简单的 jQuery 来做到这一点。当第一个框中的文本发生变化时，设置第二个框中的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:30:46.163

您需要使用 javascript 才能在不重新加载页面的情况下执行此操作。PHP 只在服务器上运行。

# python - 请提供 Python 帮助 - 创建基本函数（2.7 版）

> ID：15534057
> 
> 赞同：-3
> 
> 时间：2013-03-20T20:29:52.230
> 
> 标签：python

我在这个问题上取得了进展，但它总是只返回列表中的第一个值。我的代码中缺少什么？

**编写一个名为 add_numbers 的函数，它接收一个列表参数。它从开始返回列表中所有数字的总和，直到找到至少 10 个。如果找不到大于或等于 10 的数字，则返回列表中所有数字的总和。**

```
def add_numbers(a):

total = 0

i = 0

  while a[i] < 10:

    total = total + a[i]

    i = i + 1

    return total 
```

第二个是：

**编写一个名为 make_list 的函数，它接收一个数字参数。它返回从 0 到比数字参数小一的数字列表。**

如果被问及所有数字的总和，我知道该怎么做，但我对列表感到困惑。

最后一个是：

**编写一个名为 count_bricks 的函数，它接收一个数值参数。此函数返回金字塔中的砖的数量，即许多层高。金字塔中的每一层都比它上面的一层多一块砖。**

甚至不知道从哪里开始。

我在这里先向您的帮助表示感谢。这不是家庭作业，它只是一个充满问题的样本测验——这些是我无法回答的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:40:10.587

您必须将 return 放在循环之外，否则该值将在第一次迭代时返回。

```
def add_numbers(a):
    total = 0
    i = 0
    while a[i] < 10 and i < len(a):
        total = total + a[i]
        i = i + 1
    return total        # return  should be outside the loop 
```

提示第二个问题：

1.  创建一个接受一个输入的函数
2.  使用内置函数[range()](http://docs.python.org/2/library/functions.html#range)返回一个新列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:40:28.543

**第一个问题：**

添加检查以在列表结束时结束循环：

```
while a[i] < 10 and i < len(a): 
```

**第二个问题：**

阅读 Python 的[列表](http://docs.python.org/release/2.7.3/tutorial/introduction.html#lists)。只需循环数字的时间并将数字添加到列表中。最后返回那个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:48:03.400

```
def add_numbers(a):
    """
        returns the total of all numbers in the list from the start, 
        until a value of least 10 is found. If a number greater than 
        or equal to 10 is not found, it returns the sum of all numbers in the list.
    """
    total = 0
    index = 0
    while index < len(a):
        total = total + a[index]
        if a[index] >= 10:
            break
        index += 1
    return total 
```

# android - android如何处理电话号码中的+-sign

> ID：15534059
> 
> 赞同：0
> 
> 时间：2013-03-20T20:29:59.593
> 
> 标签：android, android-intent, exit-code

我正在尝试通过代码调用电话卡，并希望将以下 uri 发送到意图：

访问号码+暂停+电话号码+#

电话号码来自地址列表，但我如何处理 +（如退出代码），因为它在美国 011 和欧洲 00 中。而且我想我不能只将它发送到意图。有没有办法处理这个？

问题是电话卡希望加号为 00 或 011。

```
String uri = "tel:" + Uri.encode(phonenumber)

try { 
                Intent intentCall = new Intent(Intent.ACTION_CALL); 
                intentCall.setData(Uri.parse(uri));  
                startActivity(intentCall);
                } catch (ActivityNotFoundException e)        { } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:37:53.657

Android[被记录](http://developer.android.com/guide/appendix/g-app-intents.html)为使用[rfc3966](https://www.rfc-editor.org/rfc/rfc3966)兼容的电话 uri。RFC3966 指定“+”字符用于国际拨号，因此 Android 应识别“+”字符并进行适当处理。

# csv - 使用宏格式化 csv 文件

> ID：15534060
> 
> 赞同：1
> 
> 时间：2013-03-20T20:30:00.557
> 
> 标签：csv, import, excel-2010, ms-access-2010

我有一个从我们的会计软件中导出的 .csv 文件。最终目标是通过附加记录将“部分”数据导入 Access 2010 数据库表。我的问题是我需要某种设备从 .csv 文件中仅选择选择字段并格式化这些字段（定义数据类型），以便我能够将“新”格式化的 .csv 导入 Access，附加到现有的表，没有任何错误。

我们的会计软件确实允许导出其数据文件中的特定字段，但这是一个繁琐的过程，并且可能会给客户服务部门带来很多错误机会。我需要尽可能地使它成为“防白痴”！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:06:17.833

使用查询将 CSV 数据直接导入 Access 表。

查询将使选择可用 CSV 字段的子集变得容易。查询可以包含转换 CSV 值以与访问目标字段数据类型兼容的函数。

```
INSERT INTO tblFromCSV ( FK_ID, CD, [TIMESTAMP], ts_as_datetime )
SELECT
    CLng(csv.FK_ID),
    UCase(csv.CD),
    csv.TIMESTAMP,
    CDate(csv.ts_as_datetime)
FROM [Text;HDR=yes;Database=C:\share\Access\].[sample.csv] AS csv; 
```

SQL 第一行中列出的字段名称`INSERT INTO tblFromCSV (<here>)`，是存储导入数据的 Access 表字段的名称。如果您要为所有表字段提供值，并以与表字段相同的顺序提供这些值，则可以省略该字段列表。无论如何，我通常都会列出这些字段。

在`FROM`子句中，`HDR=yes`表示我的 CSV 源文件的第一行包含字段名称。如果您的 CSV 文件没有，请使用`HDR=no`，Access 将为 CSV 字段分配假名称，例如 fld1、fld2 等。

请注意，如果 CSV 确实包含字段名称，则它们不必与 Access 字段的名称匹配。

如果您在查询设计器中构建类似的查询，请注意它可能会`FROM`像这样更改子句...

```
FROM (Text;HDR=yes;Database=C:\share\Access\) sample.csv AS csv; 
```

因此，如果发生这种情况，请将其改回以避免语法错误。

我建议您从一个`SELECT`查询开始，以使该`FROM`子句起作用。然后根据需要添加转换 CSV 值所需的函数。一旦该`SELECT`查询返回您需要的内容，请将其转换为`INSERT`查询。

我希望如果类似的查询适用于您的情况，您将不需要 Excel 作为中介来将 CSV 数据导入 Access。

# jquery - JQuery 工具提示不显示

> ID：15534061
> 
> 赞同：10
> 
> 时间：2013-03-20T20:30:04.773
> 
> 标签：jquery, tooltip

我正在尝试使用 jquery ui 为一些列出的元素设置工具提示，但我无法显示工具提示。我正在尝试使用工具提示类将工具提示应用于所有项目。请检查我的代码是否有问题...

HTML

```
<li>
<label>
  <input id="someid" type="radio" name="name" />
  <strong><span>text</span></strong></label>
  <a href="#" class="tooltip" title="some text"></a>
  <h4>text</h4>
</li> 
```

JS

```
function showTooltip() {
$("#tooltip").each(function()
    {
        $(this).tooltip();
    };
}; 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2017-01-21T18:17:13.200

对于其他任何因工具提示无法正常工作而苦苦挣扎的人。

我最近发现了 jquery-ui 的一些问题，但似乎他们没有处理默认项目内容的空输入。

因此，默认情况下它是“标题”，因此如果您没有为要制作工具提示对象的元素输入标题属性，即使您像这样指定内容，它也会失败：

```
$("#element").tooltip({content:"test"}); 
```

在我看来，不处理空（或未定义）值是很弱的，但事实就是这样。

我通过向元素添加这样的标题属性来处理它：

```
title='' 
```

`items`我想您可以像这样在工具提示构造函数中指定 a ：

```
$("#selector").tooltip({items:'other-title', content: 'test'}); 
```

但是你仍然需要像这样将新属性添加到元素中：

```
other-title='' 
```

PS：使用 JQuery-UI 1.11.4

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-10T23:03:52.313

尝试使用：

JS：

```
$(document).ready(function(){
    $(document).tooltip();
}); 
```

因此，`title="yourtitle"`当您将鼠标悬停在其中时，其中的所有内容都会有一个 jquery 工具提示。

[例子](http://jsfiddle.net/Shmoyojoe/uD9en/ "有用！！！")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:43:53.427

您的函数必须有一个类选择器： $(".class")... 而不是 $("#id")

```
$(function(){
    showTooltip();
    function showTooltip() {
       $(".tooltip").each(function() {
           $(this).tooltip();
       });
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-31T10:42:58.283

就我而言，出现问题是因为页面上也加载了 Bootstrap。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-23T19:05:38.750

就像其他人所说的那样，您只需要以下内容：

```
$(document).tooltip(); 
```

但也有例外，仅此一项是行不通的。这不起作用的特定情况：

*   `option`块内的元素`select`。（工具提示显示在选择选项下方）
*   `disabled="true"`元素将继续以非 jQuery-UI 格式显示工具提示，直到重新启用。

除了重新编程 jQuery-UI 之外，我还没有找到真正解决这些问题的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-17T14:17:32.870

当我使用 $(document).tooltip(); ，它为每个元素制作了工具提示，以获取我使用的特定工具提示，

```
 $(function () {
      $(document).tooltip({
          track: true, 
          items: ".tooltip",
          content: function () {
              return $(this).attr("title");
          }
      });
  }); 
```

# javascript - JQuery 错误：无法在初始化之前调用对话框上的方法；试图调用方法“关闭”

> ID：15534063
> 
> 赞同：52
> 
> 时间：2013-03-20T20:30:11.143
> 
> 标签：javascript, jquery, html, jquery-ui

我突然从 jQuery 收到这个错误：

> 错误：无法在初始化之前调用对话框上的方法；试图调用方法“关闭”

**插件**

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
 <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script> 
```

**jQuery代码**

我在以下函数中收到这些消息：

```
$(document).ready(function() {
  if ($('#results').html().length != 0) {
    alert('has information');

    $('#dialog').dialog({
      modal: true,
      buttons: {
        Ok: function() {
          // If I use $(this).dialog($(this)).dialog('close'), the UI is displayed,
          // however I do not see the OK button and no errors 
          $(this).dialog('close');
        }
      }
    });
  } else {
    alert('has no data');
  }
}); 
```

**HTML**

```
<div id="dialog" title="Server Response">
  <p><span class="${icon}" style="float: left; margin: 0 7px 50px 0;"></span>
    <label id="results">${results}</label>
  </p>      
</div> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-03-19T14:22:31.333

在 asp.net MVC 中打开带有部分布局的对话框时，我遇到了类似的问题。我正在部分页面以及导致此错误出现的主页上加载 jquery 库。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-20T20:40:42.827

看起来您的按钮未正确声明（无论如何 根据[最新的 jQuery UI 文档）。](http://api.jqueryui.com/dialog/#option-buttons)

尝试以下操作：

```
$( ".selector" ).dialog({ 
   buttons: [{ 
      text: "Ok", 
      click: function() { 
         $( this ).dialog( "close" ); 
      }
   }]
}); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-05-04T23:59:37.360

试试这个 - 它对我有用：

```
$(".editDialog").on("click", function (e) {
    var url = $(this).attr('href');
    $("#dialog-edit").dialog({
        title: 'Edit Office',
        autoOpen: false,
        resizable: false,
        height: 450,
        width: 380,
        show: { effect: 'drop', direction: "up" },
        modal: true,
        draggable: true,
        open: function (event, ui) {
            $(this).load(url);
        },
        close: function (event, ui) {
            $("#dialog-edit").dialog().dialog('close');
        }
    });

    $("#dialog-edit").dialog('open');
    return false;
}); 
```

希望对你有帮助

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-09-11T10:44:24.640

我也遇到了同样的错误：在初始化之前无法调用对话框上的方法；试图调用方法“关闭”

我所做的是我触发了对话框标题中的关闭按钮事件，例如

这对我来说很好，可以关闭对话框

```
function btnClose() {
$(".ui-dialog-titlebar-close").trigger('click');
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-11-04T20:47:15.267

您是否`$(this).dialog("close")`有机会从 Ajax“成功”回调中调用？如果是这样，请尝试将`context: this`选项之一添加到您的`$.ajax()`通话中，如下所示：

```
$("#dialog").dialog({
    modal: true,
    buttons: {
        Ok: function() {
            $.ajax({
                url: '/path/to/request/url',
                context: this,
                success: function(data)
                {
                    /* Calls involving $(this) will now reference 
                       your "#dialog" element. */
                    $(this).dialog( "close" );
                }
            });
        }
    }
}); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-02-24T15:57:01.867

似乎出于某种原因，jQuery UI 会尝试在定义时运行按钮中定义的所有代码。这很疯狂，但我遇到了同样的问题，一旦我做出这个改变，它就停止了。

```
if ($(this).dialog.isOpen === true) { 
    $(this).dialog("close");
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-09-16T10:48:25.847

我在 1.10.2 中遇到了同样的错误。在我的例子中，我想让点击背景覆盖隐藏当前可见的对话框，不管它基于哪个元素。因此我有这个：

```
$('body').on("click", ".ui-widget-overlay", function () {
    $(".ui-dialog").dialog('destroy');
}); 
```

这曾经是有效的，所以我认为他们一定已经删除了 JQUI 中对在某个时候在弹出窗口本身上调用 .dialog() 的支持。

我的解决方法如下所示：

```
$('body').on("click", ".ui-widget-overlay", function () {
    $('#' + $(".ui-dialog").attr('aria-describedby')).dialog('destroy');
}); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-28T09:45:45.560

在一个对话框抛出此错误之前，我曾经遇到过这个问题，而所有其他对话框都运行良好。答案是因为我在页面上有另一个元素与相同的`id="dialogBox"`else ware。我在搜索过程中发现了这个线程，所以希望这对其他人有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-08T16:24:04.017

我偶然发现了同样的问题，并想分享我的解决方案：

```
<script type="text/javascript">
    $( "#dialog-confirm" ).dialog("option","buttons",
                {
                    "delete": function() {
                        $.ajax({
                            url: "delete.php"
                        }).done(function(msg) {
                         //here "this" is the ajax object                                       
                            $(this).dialog( "close" );
                        });

                    },
                    "cancel": function() {
                        //here, "this" is correctly the dialog object
                        $(this).dialog( "close" );
                    }
                });
</script> 
```

因为“this”引用了一个非对话框对象，所以我得到了提到的错误。

解决方案：

```
<script type="text/javascript">
    var theDialog = $( "#dialog-confirm" ).dialog("option","buttons",
                {
                    "delete": function() {
                        $.ajax({
                            url: "delete.php"
                        }).done(function(msg) {
                            $(theDialog).dialog( "close" );
                        });

                    },
                    "cancel": function() {
                        $(this).dialog( "close" );
                    }
                });
</script> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-07T11:48:44.130

所以你用这个：

```
var opt = {
        autoOpen: false,
        modal: true,
        width: 550,
        height:650,
        title: 'Details'
};

var theDialog = $("#divDialog").dialog(opt);
theDialog.dialog("open"); 
```

如果在对话框中打开 MVC 部分视图，则可以在索引中创建隐藏按钮和 JQUERY 点击事件：

```
$("#YourButton").click(function()
{
   theDialog.dialog("open");
   OR
   theDialog.dialog("close");
}); 
```

然后在局部视图 html 中调用按钮触发单击，例如：

```
$("#YouButton").trigger("click") 
```

再见。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-23T13:32:27.853

当我的 ajax 替换页面上的内容并以两个元素结束时，这发生在我身上第二个从未初始化过。

```
$(".dialogClass").dialog("close"); //This line was expecting to find one element but found two where the second had not been initialised. 
```

对于 ASP.NET MVC 上的任何人来说，发生这种情况是因为我的控制器操作正在返回一个完整视图，包括具有该元素的共享布局页面，因为 javascript 只替换了主要内容区域，所以它应该返回部分视图。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-05T20:15:44.440

我有一个类似的问题，我通过在对话框声明之外定义我的按钮数组来解决。

```
var buttonArray = {};
buttonArray["Ok"] = function() { $( this ).dialog( "close" );} 
```

您的选择将变为：

```
modal: true,
autoOpen: false,
buttons: buttonArray 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-06T15:49:46.340

一个小时后，我找到了最好的方法。我们应该将对话的结果保存在变量中，然后调用变量的关闭方法。

像这样：

```
var dd= $("#divDialog")
.dialog({
   height: 600,
   width: 600,
   modal: true,
   draggable: false,
   resizable: false
});

// . . .

dd.dialog('close'); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-22T04:20:31.170

尝试使用对话框主体内的按钮关闭对话框时，我收到此错误消息。我尝试使用`$('#myDialog').dialog('close');`哪个不起作用。

我最终使用以下命令触发了标题上“x”按钮的点击操作：

```
$('.modal-header:first').find('button:first').click(); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-15T22:27:44.823

Senguttuvan：您的解决方案是唯一对我有用的方法。

> 函数 btnClose() {
>   $(".ui-dialog-titlebar-close").trigger('click');
> }

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-09T15:49:09.843

我有同样的问题，我打开了几个对话框我的问题是应该删除哪些内容以防止表单数据保持相同的数据，然后创建对话框这些参数

```
var dialog = $("#dummy-1");

    dialog.html('<div style="position:absolute; top:15px; left:0px; right:0px; bottom:0px; text-align:center;"><img align="middle" src="cargando.gif"></div>');
    dialog.html(mensaje);
    dialog.dialog(
    {
        title:'Ventana de Confirmacion',
        width:400, 
        height:200, 
        modal:true,
        resizable: false,
        draggable:false,
        position: { my: "center center", at: "center center", of: window },
        buttons:
        [
            {
                text: "Eliminar",
                click: function() {
                    functionCall(dialog,var1,var2);
                }
            },
            {
                text: "Cerrar",
                click: function() {
                    dialog.dialog("close");
                }
            }
        ],
        close: function(event, ui)
        {
            dialog.dialog("close").dialog("destroy").remove();
        }
    }); 
```

对话框作为参数传递给函数以执行操作：

```
 function functionCall(dialogFormulario,var1,var2)
{
    //same action 
        dialogFormulario.dialog("close"); 
```

}

这里只需要使用 .dialog("close") 而不需要 .dialog("destroy") 因为对话框将调用其函数 close: 并且元素将不存在

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-05-09T03:46:15.880

我知道这已经很老了，但是当我不得不通过有角度的路线导航并且对话框打开时，我遇到了同样的问题，它仍然是打开的。所以我有一个解决方法来调用路由控制器析构函数中的 close 方法。但如果对话框未打开，则会出现上述错误。所以答案是如果您在初始化之前关闭对话框，它将通过此​​错误。要检查对话框是否打开然后关闭它在这种情况下包装你的关闭状态。

```
if($('#mydialog').dialog('isOpen')) { //close dialog code} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-04-02T17:56:18.370

创建一个单独的 JavaScript 函数，可以调用该函数以使用特定的对象 ID 关闭对话框，并将该函数放置在`$(document).ready()`这样的外部：

```
function closeDialogWindow() { 
$('#dialogWindow').dialog('close');
} 
```

注意：该函数必须在外部声明，`$(document).ready()`因此 jQuery 在 DOM 中创建之前不会尝试触发对话框上的关闭事件。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-05-08T13:28:37.780

您可能想在对话框之外声明按钮内容，这对我有用。

```
var closeFunction = function() {
    $(#dialog).dialog( "close" );
};

$('#dialog').dialog({
    modal: true,
    buttons: {
        Ok: closeFunction
    }
}); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-09-14T04:56:32.530

我有一个类似的问题，在我的情况下，问题是不同的（我使用的是 Django 模板）。

JS 的顺序不同（我知道这是您检查的第一件事，但我几乎可以肯定情况并非如此，但确实如此）。调用对话框的 js 在调用 jqueryUI 库之前被调用。

我正在使用 Django，因此继承了模板并使用 {{super.block}} 将代码从块以及模板继承。我不得不在解决问题的块末尾移动 {{super.block}}。调用对话框的 js 是在 Django 的 admin.py 中的 Media 类中声明的。我花了一个多小时才弄清楚。希望这可以帮助某人。

# python - 在运行时向类添加方法而不是子类化是否存在缺陷？

> ID：15534064
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:20.090
> 
> 标签：python, django

从 Django 1.5 开始，现在内置了对 User 模型的子类化以添加自定义功能的支持，但仍然存在一些兼容性方面的考虑，这意味着我不希望这样做。在 1.5 之前，子类化是一个很大的麻烦。但是，我需要一些功能，特别是以方法 .full_name() 的形式。这将返回`first + " " + middle + " " +last`用户的名称。更一般地说，它只在适当的地方放置空格，并且可以处理中间名，但不要求模型包含中间名。

现在，而不是子类 User，我只是在我的 models.py 的顶部有以下内容：

```
def full_name(self):                                    # Here's a useful full_name method
    '''Return the full name of an object, or else an empty string. Can be applied to objects with first_name, last_name and optionally middle_name fields'''
    fullname = self.first_name
    try:
        self.middle_name
    except AttributeError:                          # this type of object might not have a middle_name field
        pass
    else:                                           # If it has a middle_name field, append it with a conditional space
        if(self.first_name and self.middle_name):
            fullname += " "
        fullname += self.middle_name
    if(fullname and self.last_name):                # if fullname has stuff in it now, we'll need a space.
            fullname += " "
    fullname += self.last_name
    return fullname
User.full_name = full_name                              # Bless the User model with our full_name function 
```

总的来说，我对 Python 比较陌生，所以我很高兴发现它可以工作。通过对其他几个模型使用相同的函数，我节省了一些时间（稍后在 models.py 中的类定义中简单地描述 full_name = full_name）。也许现在 middle_name 功能更有意义 - 其他模型有中间名。

我的问题是，这种做法与子类化有什么本质上的*错误*或*坏处*吗？大概主要的缺点是我不能以这种方式将字段添加到模型中。但就是这样吗？此方法添加似乎在应用程序的其余部分以及导入用户的任何其他模块中持续存在（具体而言，模板按预期工作）。

基本上，我认为这是解决我需要更多功能的问题的一种非常聪明和优雅（虽然我肯定不是新奇）的方式，但它会回来咬我吗？

更多细节：我问的一个原因是我有一些具有关系的用户角色（我们称他们为 Painter、Clerk 和 Manager）`models.ForeignKey(User, blank=True)`。例如，User.painter 可能会返回 Painter 角色，但如果用户实际上不是画家，它也可能引发 ObjectNotFound 异常。我不想用 try: except: 语句乱扔我的代码，我想扩展我对上述想法的使用，例如向 User 添加 .is_painter() 和 .is_manager() 方法，这样我就可以简单地在if 语句而不是做很少的尝试：除了：到处乱七八糟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:09:05.453

这称为[猴子修补](http://en.wikipedia.org/wiki/Monkey_patch)。正如您可能已经从它不太讨人喜欢的名字中了解到的那样，并不总是受到好评。在 Python 社区中，这不是一种常见的技术，通常保留在没有其他选择的情况下。由于您有一个适当的接口（子类化）来实现您想要的，因此最好避免。

Monkey patching 可能很脆弱，如果你正在修改的模块在你下面发生变化，就会破坏。其他人以后可能很难修改/调试，因为代码实际位于何处并不总是很明显。

也就是说，如果它已经存在并且正在工作，您可以保留它。没有人会追踪您并为此在黑暗的小巷中殴打您。

# c# - 如何以编程方式向上滚动 WPF ListBox 一项？

> ID：15534067
> 
> 赞同：3
> 
> 时间：2013-03-20T20:30:26.847
> 
> 标签：c#, wpf, listbox, scroll

我`ListBox`在 WPF 中有一个，我将歌曲、艺术家、专辑和播放列表加载到其中。

例如，当我单击艺术家按钮时，我会在列表框中填充每个艺术家。

当我单击艺术家时，它会加载该艺术家的歌曲。专辑也一样。

有向上和向下按钮滚动列表框，自动选择条目并向上和向下滚动如下：

```
private void FileNavDown_Click(object sender, RoutedEventArgs e)
{
    if (MediaList.SelectedIndex < MediaList.Items.Count)
    {
        MediaList.SelectedIndex++;
        MediaList.ScrollIntoView(MediaList.SelectedItem);
    }
} 
```

也许你已经看到我的问题了。我无法使用这些按钮滚动浏览我的艺术家、专辑或播放列表，因为它们会自动选择下一个条目，然后填充歌曲。

您认为当我在艺术家的类别中时不选择它应该很简单，然后滚动查看所选项目+ 1，当然，这确实有效，但是当向上滚动时，因为上面的条目已经在视图中，滚动到视图中不会对用户可见。我必须向上单击五次才能滚动查看向上 5 个条目的条目，这在之前是看不见的。

那么，简单的修复？我不想过多地改变结构，也许我只需要一些东西来检测视图是否滚动。如果没有，我可以再次增加/减少滚动索引，并将其滚动到视图中直到它改变。

# jquery - jQuery：如何在循环函数结束后自动调用它？

> ID：15534068
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:28.037
> 
> 标签：jquery, function, for-loop

所以这是我的代码：

```
function draw () {
    var length=50;
    for (i=0; i<length; i++) {
        var entity2 = $("<div class='ab' id='infinite"+i+"'></div>"); //&#8734
        entity2.html(pi[i]);
        entity2.css({'left':window.innerWidth/length*(i), 'top':pi[i]*window.innerHeight/20+window.innerHeight/2, 'position':'absolute', 'color':color[pi[i]]});
        $('body').append(entity2);
    }

    for (i=0; i<length; i++) {
        for (a=i; a<length; a++) {
            $('#infinite'+i).animate({'top':pi[a]*window.innerHeight/20+window.innerHeight/2+'px', 'color':color[pi[a]]});
        } 
    };
}; 
```

循环结束时动画停止。如何让它停止后自动重新启动？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:39:31.073

添加一个 setTimeout

```
for (i=0; i<length; i++) {
    for (a=i; a<length; a++) {
           $('#infinite'+i).animate({'top':pi[a]*window.innerHeight/20+window.innerHeight/2+'px', 'color':color[pi[a]]});
    } 
};

setTimeout(draw(),2000); 
```

# html - 填充了 100% 的宽度，但 在换行符上不居中对齐

> ID：15534069
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:30.513
> 
> 标签：html, css

我正在尝试在主页上制作一个带有框的网页，它看起来像这样

```
Login
-----Or-----
Register 
```

这是我的代码

```
<center>
   <p>Login</p>
    <hr style="width: 16%; float: left; margin-left:30%;"/>
     <p style="float: left; margin-left:2%; margin-right: 2%; width: 4%;">Or</p>
    <hr style="width: 16%; float: right; margin-right: 30%;"/>
   <p>Register</p>
</center> 
```

看起来像这样 -

![在此处输入图像描述](../Images/8cd466d492d7b0a8160d05103e6bf37e.png)

我有 1 个问题和 1 件事需要帮助

问题是 Register 文本没有对齐，即使它应该对齐，我需要帮助的事情是让 < hr> 行位于 Or 文本的一半

像这样 -

![很抱歉图片很差](../Images/4cd3c553401651ac78e2510d1f6f2a22.png)

请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:39:10.367

我会像这个**[jsFiddle 示例](http://jsfiddle.net/j08691/dDS8t/1)**那样做。

**HTML**

```
<div id="container">
    <p>Login</p>
    <div id="or"> <span>Or</span>
    </div>
    <p>Register</p>
</div> 
```

**CSS**

```
#container {
    text-align:center;
}
#or {
    height: 2px;
    background-color: black;
    text-align: center;
}
span {
    background-color: white;
    position: relative;
    top: -0.5em;
    padding:0 10px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:41:39.587

尝试这个：

```
<div class="foo">
    <p>Login</p>
    <div class="hr"><p>or</p></div>
    <p>Register</p>
</div>

.foo{text-align:center;line-height:1em;}
.foo .hr p{background:#fff;margin:0;position:relative;z-index:2;display:inline-block;padding:0 1em;}
.foo .hr:after{border-bottom:1px solid #000;content: " ";display:block;position:relative;top:-0.5em;} 
```

应该是这样的：

![在此处输入图像描述](../Images/e877acda2fe4f51a37f77ea2bd7c674b.png)

# oracle - 转置并插入具有不同值的多行

> ID：15534073
> 
> 赞同：1
> 
> 时间：2013-03-20T20:30:34.337
> 
> 标签：oracle, plsql, oracle11g, pivot, unpivot

我有下表的更复杂版本：

```
ID | FIRST  | LAST     | EMAIL
1  | John   | Doe      | jdoe@example.com
1  | Mack   | Johnson  | mjohnson@example.com
1  | Steven | Michaels | smichaels@example.com
2  | Sarah  | Sampson  | ssampson@example.com
2  | Tom    | Smith    | tsmith@example.com
2  | Jane   | Rogers   | jrogers@example.com
3  | Bob    | Johns    | bjohns@example.com
3  | Kim    | Lane     | klane@example.com
3  | Ron    | Swanson  | rswanson@example.com 
```

我想编写一个查询，将这些数据插入到另一个表中，看起来像这样（表已经存在）：

```
ID | first1 | last1    | email1               | first2 | last2    | email2               | first3 | last3    | email3 
1  | John   | Doe      | jdoe@example.com     | Mack   | Johnson  | mjohnson@example.com | Steven | Michaels | smichaels@example.com
2  | Sarah  | Sampson  | ssampson@example.com | Tom    | Smith    | tsmith@example.com   | Jane   | Rogers      | jrogers@example.com
3  | Bob    | Johns    | bjohns@example.com   | Kim    | Lane     | klane@example.com    | Ron    | Swanson     | rswanson@example.com 
```

我觉得这应该很容易，但这个概念让我望而却步。实现这一目标的最佳实践是什么？

也许我还应该提到我写了一个函数，我可以传递 ID、索引号和列名来返回值（即 getpersoninfo(2,'1','first') 来返回 Sarah）。

```
select a_id,
  FIRST1, LAST1, EMAIL1,
  FIRST2, LAST2, EMAIL2,
  FIRST3, LAST3, EMAIL3
from
(
  select a_id, col||rn as new_col, value
  from
  (
    select a_id, first_name, last_name, email,
      cast(row_number() over(partition by a_id order by a_id) as varchar2(10)) rn
    from dump_recs_2015
  ) 
  unpivot
  (
    value
    for col in (first_name, last_name, email)
  )
) 
pivot
(
  max(value)
  for new_col in ('FIRST1' FIRST1, 'LAST1' LAST1, 'EMAIL1' EMAIL1,
                  'FIRST2' FIRST2, 'LAST2' LAST2, 'EMAIL2' EMAIL2,
                  'FIRST3' FIRST3, 'LAST3' LAST3, 'EMAIL3' EMAIL3)
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:44:14.797

由于您使用的是 Oracle 11g，因此您可以同时实现[`UNPIVOT`](http://www.oracle.com/technetwork/articles/sql/11g-pivot-097235.html)和[`PIVOT`](http://www.oracle.com/technetwork/articles/sql/11g-pivot-097235.html)函数。

将`UNPIVOT`获取您的列`first`，`last`并将`email`值转换为行。然后您可以`PIVOT`将新名称`First1`等放入列中：

```
select id,
  First1, Last1, Email1,
  First2, Last2, Email2,
  First3, Last3, Email3
from
(
  select id, col||rn as new_col, value
  from
  (
    select id, first, last, email,
      cast(row_number() over(partition by id order by id) as varchar2(10)) rn
    from yourtable
  ) 
  unpivot
  (
    value
    for col in (first, last, email)
  )
) 
pivot
(
  max(value)
  for new_col in ('FIRST1' First1, 'LAST1' Last1, 'EMAIL1' Email1,
                  'FIRST2' First2, 'LAST2' Last2, 'EMAIL2' Email2,
                  'FIRST3' First3, 'LAST3' Last3, 'EMAIL3' Email3)
) 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!4/89974/11)。然后可以在`INSERT`语句中使用它来将数据加载到新表中。

编辑，根据您的列名更改，您将使用：

```
select a_id,
  First1, Last1, Email1,
  First2, Last2, Email2,
  First3, Last3, Email3
from
(
  select a_id, col||rn as new_col, value
  from
  (
    select a_id, first_name, last_name, email,
      cast(row_number() over(partition by a_id order by a_id) as varchar2(10)) rn
    from yourtable
  ) 
  unpivot
  (
    value
    for col in (first_name, last_name, email)
  )
) 
pivot
(
  max(value)
  for new_col in ('FIRST_NAME1' First1, 'LAST_NAME1' Last1, 'EMAIL1' Email1,
                  'FIRST_NAME2' First2, 'LAST_NAME2' Last2, 'EMAIL2' Email2,
                  'FIRST_NAME3' First3, 'LAST_NAME3' Last3, 'EMAIL3' Email3)
) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/fd15d/1)

# php - 与一起使用时不会触发 jQuery Focus 功能由 PHP 中的数组生成的选项 下面的 $('select').focus 函数与 html <select>元素一起使用，但当与选项由 php 生成的</select> 元素一起使用时，它不会被触发函数“printSelectOptions”如下所示。$('select').focus 函数允许我区分选择元素的默认值（或“默认状态”，它们预先设置为最常选择的选项）与用户主动选择的时候通过单击表单元素来获取值（表

> ID：15534078
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:49.200
> 
> 标签：php, jquery, arrays, focus

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T03:02:32.660

在您的评论中，您说您正在尝试使用 Dropkick 或 jQuery UI MultiSelect Widget。由于这不是多选下拉菜单，因此我认为 Dropkick 将是您想要的。

这是一个[jsfiddle](http://jsfiddle.net/john_s/JHAPp/9/)，显示代码不适用于 Dropdkick。

我的理解是正常的事件绑定不适用于 Dropkick。相反，您必须使用 dropkick 回调，如下所示：

```
$('select').dropkick({
    change: function(value, label) {
        alert('You picked: ' + label + ':' + value);
   }
}); 
```

似乎“更改”回调是唯一可用的回调。似乎不支持“焦点”回调。

另一个问题是似乎没有办法更改 Dropkick 选择的选项。（我在 jsfiddle 中尝试了您的代码，值变为“0”。）

如果您可以限制使用“更改”回调，那么解决您无法更改选项值这一事实的方法是不要在任何值上包含“_default”。相反，您将在表单中包含一个隐藏字段。当数据库中的值以“_default”结尾时，隐藏字段设置为“true”；否则设置为“假”。dropkick 选择的“更改”回调会将隐藏值设置为“假”。当表单发布时，服务器检查隐藏值是否为“true”，并在发布的选择值末尾附加“_default”。

更新：

如果您要实现隐藏字段，则显示页面的代码如下所示：

```
<script>
$(function() {
    $('select').dropkick({
        change: function() {
            $('input[name=isDefaultPriceSelected]').val('false');
       }
    });
});
</script>

<?php
    // Helper method that tells if the given string ends with the given substring.
    function endsWith($str, $substr) {
        $substrLength = strlen($substr);
        return substr_compare($str, $substr, -substrLength, substrLength) === 0;
    }

    // Helper method that prints out a hidden input element.
    function printHiddenInput($name, $value) {
        echo '<input type="hidden" name="' . $name . '" value="' . $value . '" />
    }
?> 

<select name="jeans">
<?php
    $options = array("Null"=>"", "$0"=>"$0", "$50"=>"$50", "$100"=>"$100", "$150"=>"$150");
    echo printSelectOptions($options, $row_default['jeans']); 
?> 
</select>

<?php
    echo printHiddenInput('isDefaultPriceSelected', endsWith($row['jeans'], '_default') ? 'true' : 'false'); 
?> 
```

您仍然需要处理处理表单发布的代码。它必须同时查找选择值和隐藏值。如果隐藏值为“true”，则应将“_default”附加到已发布选择值的末尾。

注意：您将不再使用`replaceKey()`辅助函数。:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:04:38.470

我之前应该注意到这一点，但是调用`$('select').focus`不是在文档就绪处理程序中，而是在`<select>`添加到 DOM 之前。因此，它不会绑定到`<select>`.

尝试：

```
<script>
$(function() {
    $('select').focus(function () {
        var option = $(this).find("option[value*=default]");
        option.attr('value', option.attr('value').replace(/_default/g, ''));
    });
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T17:28:51.237

您是否尝试过使用

```
$(document).on('focus', 'select', function() {
    //code here
}); 
```

# delphi - 有没有办法通过 windows API 获取 VCL 控件的名称？

> ID：15534081
> 
> 赞同：13
> 
> 时间：2013-03-20T20:30:51.953
> 
> 标签：delphi, winapi

我有一个位于另一个进程窗口上的 VCL 控件的 Hwnd。有没有办法`TControl.Name`通过 Windows API 获取该控件的 VCL 名称（属性）？我需要这个名称，因为该窗口上有几个 TEdit，我需要确定我想要的那个以便向`WM_SETTEXT`它发送消息。

这两个应用程序都是使用 Delphi 2010 构建的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T09:09:21.233

Delphi 具有`FindControl()`返回`TWinControl`指定 hWnd 的内置函数。但它适用于同一个 VCL 实例。我觉得你应该调查一下。在您拥有指向 TWinControl 对象的指针后，其名称（字符串）位于`+8`偏移处。您可以尝试 ReadProcessMemory 来读取它。这里的主要问题是创建适合您需要的 FindControl() 版本。

编辑：（终于明白了：D）调用GetWinControlName函数

```
// Get Pointer to TWinControl in another process
function GetWinControl(Wnd: HWND; out ProcessId: THandle): Pointer;
var
  WindowAtomString: String;
  WindowAtom: ATOM;
begin
  if GetWindowThreadProcessId(Wnd, ProcessId) = 0 then RaiseLastOSError;

  // This is atom for remote process (See controls.pas for details on this)
  WindowAtomString := Format('Delphi%.8X',[ProcessID]);
  WindowAtom := GlobalFindAtom(PChar(WindowAtomString));
  if WindowAtom = 0 then RaiseLastOSError;

  Result := Pointer(GetProp(Wnd, MakeIntAtom(WindowAtom)));
end;

function GetWinControlName(Wnd: HWND): string;
var
  ProcessId: THandle;
  ObjSelf: Pointer;
  Buf: Pointer;
  bytes: Cardinal;
  destProcess: THandle;
begin
  ObjSelf := GetWinControl(Wnd, ProcessId);

  destProcess := OpenProcess(PROCESS_VM_READ, TRUE, ProcessId);
  if destProcess = 0 then RaiseLastOSError;

  try
    GetMem(Buf, 256);
    try
      if not ReadProcessMemory(destProcess, Pointer(Cardinal(ObjSelf) + 8), Buf, 4, bytes) then RaiseLastOSError;
      if not ReadProcessMemory(destProcess, Pointer(Cardinal(Buf^)), Buf, 256, bytes) then RaiseLastOSError;
      Result := PChar(Buf);
    finally
      FreeMem(Buf);
    end;
  finally
    CloseHandle(destProcess);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-20T20:40:12.263

不，没有可以产生控件名称的 Windows API 函数。那是一个私有的 Delphi 实现细节。

如果您控制目标进程的代码，那么显然您可以实现某种形式的 IPC 来解决问题。否则，任何产生控件名称的解决方案都将涉及相当卑鄙的黑客攻击。一种方法是将使用相同版本的运行时构建的 DLL 注入进程。获取该 DLL 以从 HWND 中找到 VCL 控件引用并读出名称。这方面有很多变体`ReadProcessMemory`，@Samaliani 的回答提供的巧妙技巧是您必须跳过的典型环节。

但是，我可以想到一个更简单的解决方案来解决您的问题。找到所有编辑控件的句柄并使用这些句柄接收控件的坐标。编辑控件的相对位置将足以确定哪个是所需的目标。请阅读下面@dthorpe 的评论，了解更多有用的想法。

# silverlight - MVVM、MEF、Silverlight 和服务代理

> ID：15534085
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:56.757
> 
> 标签：silverlight, mvvm, mef

我的视图模型中目前有以下构造函数

```
 public CartViewModel() : this(new PayPalCompleted()) { }

    public CartViewModel(IPayPalCompleted serviceAgent)
    {
        if (!IsDesignTime)
        {
            _ServiceAgent = serviceAgent;
            WireCommands();
        }
    } 
```

我正在尝试模块化我的应用程序 Prism 和 MEF。我的模块工作正常，但我的一个视图模型有问题。

我的问题是我需要在构造函数中导入 EventAggregator 但我遇到了关于如何使用无参数构造函数以及导入构造函数执行此操作的问题

```
 [ImportingConstructor]
    public CartViewModel([Import] IEventAggregator eventAggregator)
    {
        if (!IsDesignTime)
        {
            _ServiceAgent = new PayPalCompleted();
            TheEventAggregator = eventAggregator;
            WireCommands();

        }
    } 
```

即我想做这样的事情

```
 public CartViewModel() : this(new PayPalCompleted(),  IEventAggregator  eventAggregator) { }

    [ImportingConstructor]
    public CartViewModel(IPayPalCompleted serviceAgent, IEventAggregator eventAggregator)
    {
             ...stuff
     } 
```

我知道哪个不正确...什么是？

我认为，部分问题在于，当使用导入构造函数时，构造函数中的参数默认为导入参数——这意味着它们需要相应的导出才能使 MEF 能够正确组合。这可能意味着我应该导出我的 paypay 服务？还是应该？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T08:05:03.753

处理此问题的最简单方法是公开 IEventAggregator 类型的属性，实现 IPartImportsSatisifiedNotification 并在该方法中处理事件订阅。

像这样的东西

```
public class CartViewModel : IPartImportsSatisfiedNotification
{
    private readonly IPayPalCompleted _serviceAgent;

    public CartViewModel(IPayPalCompleted serviceAgent)
    {
        this._serviceAgent = serviceAgent;
        CompositionInitializer.SatisfyImports(this);
    }

    [Import]
    public IEventAggregator EventAggregator { get; set; }

    void IPartImportsSatisfiedNotification.OnImportsSatisifed()
    {
        if (EventAggregator != null)
        {
            // Subscribe to events etc.
        }
    }
} 
```

# php - 来自 PHP 的幻像 mysql_error

> ID：15534087
> 
> 赞同：0
> 
> 时间：2013-03-20T20:30:58.977
> 
> 标签：php, mysql, sql

我有这个 sql 语句，当我在 phpmyadmin 中运行它时运行良好，但是`mysql_error` 当我从 PHP 运行它时，它启动了一个非常模糊的服务器：

> > 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 ' 附近使用的正确语法
> 
> ```
> UPDATE srSignals SET falseBreak = "true",' 
> ```
> 
> 在第 5 行

完整的 sql 语句：

```
UPDATE srSignals
                SET falseBreak = "true",
                    candleClose = 1.51132,
                    result=-48
                WHERE id=4429;UPDATE srSignals
                SET falseBreak = "true",
                    candleClose = 1.51132,
                    result=-27
                WHERE id=4431; 
```

任何人都知道这个语句有什么问题，或者为什么它在 phpmyadmin 中复制/粘贴而不是通过 PHP 请求时起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:33:31.103

你的语法是错误的。您必须使用单引号而不是像 tis 这样的双引号：

```
 UPDATE srSignals
            SET falseBreak = 'true',
                candleClose = 1.51132,
                result=-48
            WHERE id=4429;UPDATE srSignals
            SET falseBreak = 'true',
                candleClose = 1.51132,
                result=-27
            WHERE id=4431; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:34:31.993

在';'上拆分字符串 并执行两条sql语句。

# nunit - 使用 nunit 和 TestCaseSource 和 TestCaseData 设置复杂的行测试

> ID：15534089
> 
> 赞同：5
> 
> 时间：2013-03-20T20:31:03.837
> 
> 标签：nunit, testcasesource, testcasedata

对于像 2 或 4 这样的每个期望返回值，我想将此值作为单元测试方法的参数传递。但我得到一个例外，即参数不正确。当我删除 countExpected 参数时，单元测试运行良好，我无法断言 countExpected ...

NUnit 完全可以实现这种情况吗？

```
[Test, TestCaseSource("VisibleWeekDays")]
public void Test(DayOfWeek[] visibleWeekDaysSetup, int countExpected)
{
    // ARRANGE

    // ACT

    // ASSERT
    Assert.That(periods.Count(),Is.EqualTo(countExpected));
}

private static IEnumerable<TestCaseData> VisibleWeekDays
{
    get
    {
        yield return new TestCaseData(new DayOfWeek[] {DayOfWeek.Sunday}).Returns(2);
        yield return new TestCaseData(new DayOfWeek[] {DayOfWeek.Sunday, DayOfWeek.Monday}).Returns(4);
        // more days...
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T20:52:57.983

请参阅[此处的](http://nunit.org/index.php?p=testCaseSource&r=2.5)说明：

> **.Returns**
> 从方法返回的预期结果，它必须具有兼容的返回类型。

因此，如果要使用`TestCaseData.Returns()`，则需要编写 test 如下：

```
[Test, TestCaseSource("VisibleWeekDays")]
public int Test(DayOfWeek[] visibleWeekDaysSetup)
{
     // ARRANGE

    // ACT

    // ASSERT
    return periods.Count();
} 
```

**更新：**
如果要将期望值作为参数传递，则需要将其作为常规测试用例数据传递。参见示例：

```
[Test, TestCaseSource("VisibleWeekDays")]
public void Test(DayOfWeek[] visibleWeekDaysSetup, int countExpected)
{
    ...

    Assert.That(periods.Count(),Is.EqualTo(countExpected));
}

private static IEnumerable<TestCaseData> VisibleWeekDays
{
    get
    {
        yield return new TestCaseData(new DayOfWeek[] {DayOfWeek.Sunday}, 2);
        yield return new TestCaseData(new DayOfWeek[] {DayOfWeek.Sunday, DayOfWeek.Monday}, 4);
        // more days...
    }
} 
```

# javascript - 在大型 JS 应用程序中，我应该在哪里将自定义方法放入库和插件中

> ID：15534094
> 
> 赞同：0
> 
> 时间：2013-03-20T20:31:32.050
> 
> 标签：javascript, directory-structure, application-structure

我有一个相当大的 javascript 应用程序，主要使用 jquery 和淘汰赛。本质上，我在我的文件夹结构`app`中做了一个主要的分离，其中包含我编写的所有代码，并进一步分为常量、视图、模型和视图模型。然后我得到`vendor`了我没有写的代码，比如 jquery、knockout、插件等。我遇到的问题是我应该把介于两者之间的东西放在哪里。我已经为敲除编写了一些自定义绑定并扩展了一些 jquery 插件的一些功能，它们只是位于我的目录的根`app`目录中。什么是最佳实践或命名约定。

```
+app
 -- constants
 -- models
 -- viewmodels
 -- views
 jquery-plugin-extras.js
 knockout-bindings.js
 etc
+vendor
 jquery.min.js
 knockout.min.js
 jquery-plugin.min.js 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T16:19:30.293

```
+app
 -- system (or core) //contains core or system related generics
 -- config // single place to store your configurations, if you have just one, put it at the root
 -- plugins // all plugins or ko bindings here
 -- constants
 -- models
 -- viewmodels
 -- views
 -- main.js // any bootstrapping, initial configurations and such go in to this file.
+lib
 --jquery.min.js
 --knockout.min.js
 --jquery-plugin.min.js 
```

# java - 为什么 TimeZone.getTimeZone() 不抛出异常

> ID：15534099
> 
> 赞同：3
> 
> 时间：2013-03-20T20:31:48.063
> 
> 标签：java, timezone

[如果TimeZone.getTimeZone()](http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html#getTimeZone%28java.lang.String%29)方法给出的时区 ID 无效，为什么它不会抛出错误？相反，它返回“如果无法理解给定 ID，则返回 GMT 区域”。这个决定背后的理由是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:37:21.203

I'm not sure of the rationale, but they did provide you with a `getAvailableIDs()` method to allow you to ensure your timezone is vaild. They do mention this in the javadoc:

> You can use the getAvailableIDs method to iterate through all the supported time zone IDs. You can then choose a supported ID to get a TimeZone. If the time zone you want is not represented by one of the supported IDs, then a custom time zone ID can be specified to produce a TimeZone

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-23T14:09:58.977

造成这种情况和 Java 类似问题的一个原因（必须特别注意避免依赖系统的默认语言环境、字符集和时区，以便在读取文本文件或写入文本文件失败时出现异常，因为磁盘已满等）可能是[Java 最初应用于编程用户界面](http://www.oracle.com/technetwork/java/javase/overview/javahistory-index-198355.html)，而不是服务器后端：在 UI 中，显示错误输出可能比完全失败更好，因为用户通常可以找出错误并解释现有的正确输出。尽管如此，我认为省略异常`TimeZone.getTimeZone(String)`是一个设计错误。

无论如何，现在有新的更好的 API 可用。获取时区的现代方法（从 Java 8 开始）是

```
TimeZone.getTimeZone(ZoneId.of(zoneId)); 
```

这确实会为无效的区域 ID 引发异常。接受的区域 ID 格式与`ZoneId.of(String)`的不完全相同`TimeZone.getTimeZone(String)`，但正如[Javadoc`ZoneId.of(String)`](http://docs.oracle.com/javase/8/docs/api/java/time/ZoneId.html#of-java.lang.String-)所说，大多数区域 ID 都是兼容的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-12T09:43:35.090

基于@Jaan 的回答建议使用`ZoneId.of()`. 这是一种避免 ZoneId 的 ID 与 TimeZone 的 ID 不完全相同这一事实的方法：首先用于`TimeZone.getAvailableIDs()`检查提供的时区 ID 是否为“Europe/Rome”之类的字符串，然后使用 ZoneId.of()如果是固定偏移ID，否则无效。

```
/* Returns null if the timezoneID is invalid */
private static TimeZone getTimeZone(String timezoneID) {

    final String[] availableTimezoneIDs = TimeZone.getAvailableIDs();

    if ( ! Arrays.asList(availableTimezoneIDs).contains(timezoneID) ) {

        // Unknown timezone ID, maybe a fixed offset timezone id?

        if (timezoneID.equals("Z") ||
                timezoneID.startsWith("+") || timezoneID.startsWith("-") ||
                timezoneID.startsWith("UTC") || timezoneID.startsWith("UT") || timezoneID.startsWith("GMT")
                ) {
            try {
                return TimeZone.getTimeZone(ZoneId.of(timezoneID));
            } catch (DateTimeException e) {
                // Invalid fixed-offset timezone id
                return null;
            }
        } else
            // Not even a fixed offset timezone id
            return null;

    } else
        return TimeZone.getTimeZone(timezoneID);

} 
```

# ruby-on-rails - Rails 3 + Select2 多个 id + AJAX

> ID：15534100
> 
> 赞同：0
> 
> 时间：2013-03-20T20:31:48.747
> 
> 标签：ruby-on-rails, ajax, jquery-select2

我正在使用 Select2 进行 AJAX 调用，以便为我的应用程序中的简单消息传递系统选择用户。几乎所有东西都能正常工作（甚至是通过 AJAX 进行的 InitSelection），除了我一直在努力尝试做一件看似简单的事情：遍历多个用户 ID 以为每个用户 ID 创建一条消息。

显然，问题在于 Select2 将多个 id 作为字符串返回，而不是 Rails 期望的数组。试了一堆好像都没用。。。。

如何转换字符串：

```
{"username" => "78,21,12"} 
```

至

```
{"username" => [78,21,12]} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:34:30.197

实际上，经过多次谷歌搜索，我终于得到了相当简单的答案。此代码现在驻留在我的应用程序控制器中，用于任何需要为 Select2 目的进行转换的字符串：

```
def s_to_array(string)
  result = [string[0..-1].split(',').collect! {|n| n.to_i}].flatten
end 
```

希望这可以节省其他人我花费的时间...... :)

为了清楚起见，我从控制器中的创建操作中调用它：

```
 def create
        messaged = (params[:message][:username])
        body = (params[:message][:body])
        subject = (params[:message][:subject])
        msg_group = s_to_array(messaged)
        sanitized = Sanitize.clean(body, Sanitize::Config::BASIC)

        msg_group.each do |u|
          @message = Message.new
          @message.subject = subject
          @message.sender = @user
          @message.recipient = User.find(u)
          @message.body = sanitized
          @message.save
        end
    ....
     end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:37:41.047

Here is one solution :

```
h = {"username" => "78,21,12"}

h.map{|a,b| {a=> b.split(',')}}.reduce(:merge) 
```

Produces :

```
 {"username"=>["78", "21", "12"]} 
```

Or if you want integers instead of string :

```
h.map{|a,b| {a=> b.split(',').map(&:to_i)}}.reduce(:merge) 
```

Produces :

```
{"username"=>[78, 21, 12]} 
```

# java - GWT 编译文件夹中的 deferredjs 文件夹

> ID：15534101
> 
> 赞同：1
> 
> 时间：2013-03-20T20:31:50.370
> 
> 标签：java, gwt

我在 CMS 中部署我的 GWT 应用程序，因此从已编译的文件夹中复制文件，我不复制文件夹，`deferredjs`但应用程序仍然可以正常工作，这个文件夹的用途是什么，为什么它包含许多文件夹名称的子文件夹像 GUID？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:17:20.270

它包含将在需要时异步加载的部分代码。这是一种拥有较小部分 javascript 的方法。阅读此[页面](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodeSplitting)以获取更多信息。

如果您的应用程序工作正常是因为您没有使用该代码（它甚至可能是 3 方组件的一部分），或者加载失败并且您在失败时没有引发任何错误。

# sql - NSIS 与 C# 或 VB 交互？

> ID：15534103
> 
> 赞同：0
> 
> 时间：2013-03-20T20:32:00.537
> 
> 标签：sql, sql-server, nsis

我正在寻找一种可能与 NSIS 与 C# 或 VB 交互的方法。这个想法是通过数据库对用户进行一些验证。（基本上检查用户是否存在）在进行安装程序时。

由于我认为 NSIS 不能直接与 Microsoft SQL 交互，但 C# 可以，那么最简单的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:44:18.323

NSIS 本身只能调用 NSIS 插件（具有特定格式的函数导出的 DLL）

[系统插件](http://nsis.sourceforge.net/Docs/System/System.html)可以调用 Windows 或 3rd-party DLL 中的任何普通 WinAPI (stdcall/cdecl) 函数。

要使用 .NET 的东西，您需要使用[CLR 插件](http://nsis.sourceforge.net/Call_.NET_DLL_methods_plug-in)...

# android - ldd 在 android 上等效

> ID：15534104
> 
> 赞同：23
> 
> 时间：2013-03-20T20:32:02.277
> 
> 标签：android, android-ndk, ldd, readelf

我有一个 libTest.so 无法在某些设备上加载。logcat 绝对没用。使用`arm-linux-androideabi-readelf.exe -d libTest.so`我能够看到 libTest.so 需要的所有必需库。我将它们全部拉入本地 PC 上的同一个文件夹中。

如何找出缺少哪些符号以及在哪个库中？我只有 NDK 的标准工具集（nm、readelf、objdump 等）。我可以使用哪个工具以及如何使用它来解析我的 libTest.so 和所有依赖库，并告诉我哪个符号阻止我的库加载到目标设备上。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-05T22:40:29.043

感谢安卓开发者。我的功能请求已实现 :) 现在我们有了[ndk-depends](https://android.googlesource.com/platform/ndk/+/426f4ee8a8c3be97122c1a6bf5f58dbd9486bbc9/docs/text/NDK-DEPENDS.text)，这是一个允许对依赖项进行故障排除的工具。

编辑：虽然它不做完整的符号解析。例如，如果您针对 Android-14 构建并尝试使用旧 Android 中不存在的方法，则此工具不会列出丢失的符号。这部分在 ndk-depends 中作为 TODO 留下。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-10-19T11:41:15.217

如果您没有 NDK，请尝试执行以下操作：

```
readelf --dynamic filename | grep NEEDED 
```

显示精灵二进制文件的动态库。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-24T22:13:37.607

在 Android 终端试试这个：
`strings /path/to/your/file | grep ^lib` 在这里找到： [https ://forum.xda-developers.com/showthread.php?t=2737126&page=5](https://forum.xda-developers.com/showthread.php?t=2737126&page=5)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-15T17:27:46.043

您可以执行以下操作：

```
$ /lib/ld-linux.so.2 --list filename 
```

这是因为 ldd 只是一个 shell 脚本，它就像动态加载器的包装器一样工作。动态加载程序的名称，即 ld-{version}.so 可能不同。

# c# - 用 aforge 和手动计算许多 blob 的中心

> ID：15534110
> 
> 赞同：0
> 
> 时间：2013-03-20T20:32:33.667
> 
> 标签：c#, computer-vision, aforge

我正在尝试获取图像中所有检测到的斑点的中心，因此我尝试以两种不同的方式进行操作，得到了两种不同的结果！
第一个如下：

```
 BlobCounter blobCounter = new BlobCounter();
        blobCounter.ObjectsOrder = ObjectsOrder.Area;
        blobCounter.ProcessImage(image);
        Blob[] blobs = blobCounter.GetObjectsInformation();
        AForge.Point Center = new AForge.Point();

        if (blobs.Length > 0)
        {
                Center.X = blobs.Average(c => c.CenterOfGravity.X);
                Center.Y = blobs.Average(c => c.CenterOfGravity.Y);
        } 
```

第二种方法如下：

```
 System.Drawing.Point Center = new System.Drawing.Point();
        int count = 0;
        int sumX = 0;
        int sumY = 0;
        for(int i = 0 ;i<image.Width;i++)
            for (int j = 0; j < image.Height; j++)
            {
                var p = image.GetPixel(i,j);
                if (!p.Name.ToLower().Equals("ff000000"))
                {
                    sumX += i;
                    sumY += j;
                    count++;
                }
            }
        if (count > 0)
        {
            Center.X = sumX / count;
            Center.Y = sumY / count;
        }
        return Center; 
```

在哪里

```
!p.Name.ToLower().Equals("ff000000") 
```

意味着像素不是黑色的（即它来自一些斑点）。
但是我不明白为什么我会得到不同的结果！有人可以帮助我并告诉我为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:55:06.403

如果不确切查找您使用的 AForge 方法的作用，我认为问题在于**The average of averages does not equal the average of their parts**。

例如，我可以取这些数字：

*   1
*   3
*   5
*   7
*   9

加起来，它们的平均值为 (1+3+5+7+9)/5=5。**但是**，如果我将列表分成 {5,3}（平均 4）和 {1,7,9}（平均 5.66...），然后取 {4, 5.66...} 的平均值，我会得到接近但不等于 5 的东西。

在这种情况下，AForge 的 CenterOfGravity 方法很可能会返回您正在平均的对象的平均位置，而您自己的方法是对每个对象的每个部分进行单一平均。

无关：查看[Bitmap.LockBits](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.lockbits.aspx)以获得更有效的图像操作。

# ios - 为什么 iPhone5 的表面尺寸错误？

> ID：15534115
> 
> 赞同：0
> 
> 时间：2013-03-20T20:32:50.260
> 
> 标签：ios, cocos2d-iphone, screen, retina-display

我正在使用带有模拟器 6.1 的 cocos2d v2.0.0。

当我在 xcode 中的 iPhone5 模拟器中编译项目时，表面大小为

> cocos2d：表面尺寸：1136x640

该应用程序工作正常，适合屏幕边框 1136x640，但是当我在 iPhone5 设备上运行应用程序时，我得到

> cocos2d：表面尺寸：960x640

图像不再覆盖全屏。

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-25T04:04:11.013

您需要确保并在项目中定义了一个 4 英寸的启动图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:47:07.560

尝试使用[cocos2d 2.1](http://www.cocos2d-iphone.org/archives/2039)

并使用方法获取屏幕尺寸：

```
[[CCDirector sharedDirector] winSize];

[[CCDirector sharedDirector] winSizeInPixels]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T10:31:27.603

您为 iPhone 5 (Default-568@2x.png) 提供的屏幕截图很可能不会以某种方式复制到设备上。可能的原因：
- 错误的 png 格式。
- 错误的名称（default-568@2x.png 与 Default-568@2x.png）。模拟器区分大小写。
- 不在项目设置中的复制文件目标中。它可能已经在某个时间点复制到模拟器上，但现在它没有复制到项目中。

希望这可以帮助。

# java - Java：将类从外部源添加到类路径

> ID：15534116
> 
> 赞同：4
> 
> 时间：2013-03-20T20:32:53.473
> 
> 标签：java, plugins

所以这是我的问题。我正在创建一个类似于 DOS 命令行的软件。我希望人们能够通过简单地将包含扩展基`Command`类的类的 jar 文件拖放到文件夹中来添加其他命令。我没有尝试过任何工作。

这是我尝试过的：

1.  **使用 Reflections 库添加在 jar 文件中搜索扩展 Command 类的类**
    这引发了许多错误，只是没有在我的 jar 中找到大多数类。我认为这与正在发生的所有`SomeClass$1.class`事情有关。
2.  **遍历 jar 中的每个文件并将其添加到类路径中，**
    我找不到一种方法来实现这一点，因为我根本无法将迭代`ZipEntry`转换为可以添加到类路径中的任何内容，例如 URL。
3.  **将整个 jar 添加到类路径**
    这也不起作用，因为程序不知道这些类的名称，因此，它不能将它们转换为命令。

我想在这里得到一些帮助。任何关于如何使我的程序更具可扩展性的建议都将非常受欢迎。包括代码的+1；）
如果您需要任何进一步的信息，请告诉我。

**编辑：**
新代码：

```
URLClassLoader ucl = (URLClassLoader) ClassLoader.getSystemClassLoader();
    for(File file : FileHelper.getProtectedFile("/packages/").listFiles()) {
        if(file.getName().endsWith(".jar")) {
            Set<Class<?>> set = new HashSet<Class<?>>();
            JarFile jar = null;
            try {
                jar = new JarFile(file);
                Enumeration<JarEntry> entries = jar.entries();
                while(entries.hasMoreElements()) {
                    JarEntry entry = entries.nextElement();

                    if(!entry.getName().endsWith(".class"))
                        continue;

                    Class<?> clazz;
                    try {
                        clazz = ucl.loadClass(entry.getName().replace("/", ".").replace(".class", "")); // THIS IS LINE 71
                    } catch(ClassNotFoundException e) {
                        e.printStackTrace();
                        continue;
                    }

                    if(entry.getName().contains("$1"))
                        continue;

                    if(clazz.getName().startsWith("CMD_"))
                        set.add(clazz);

                    jar.close();
                }
            } catch(Exception e) {
                //Ignore file
                try {
                    jar.close();
                } catch (IOException e1) {/* Don't worry about it too much... */}
                OutputHelper.log("An error occurred whilst adding package " + OutputStyle.ITALIC + file.getName() + OutputStyle.DEFAULT + ". " + e.getMessage() + ". Deleting package...", error);
                e.printStackTrace();
                file.delete();
            } 
```

抛出的错误：

```
java.lang.ClassNotFoundException: com.example.MyCommands.CMD_eggtimer
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at com.MyWebsite.MyApplication.Commands.CommandList.update(CommandList.java:71) 
```

上面的代码中已经标记了第 71 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:54:35.207

当我过去需要这样做时，我结合使用了您的第 2 点和第 3 点，即我将 jar 文件添加到类路径中，然后遍历它列出它包含的文件以计算出类的名称，并使用 Class.forName(...) 加载它们，以便我可以检查它们是否是我需要对其执行处理的类。

另一种选择是要求在 jar 文件的清单中或通过其他一些元数据机制来标识类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T16:36:58.657

感谢大家的帮助，但我自己想通了。

首先，您需要您要操作的文件的位置。使用它来创建 jar 的 File 和 JarFile。

```
File file = new File("/location-to/file.jar");  
JarFile jar = new JarFile(file); 
```

如果需要，您可以通过遍历文件夹中的内容来做到这一点。

然后您需要`URLClassLoader`为该文件创建一个：

```
URLClassLoader ucl = new URLClassLoader(new URL[] {file.toURI().toURL()}); 
```

然后遍历 Jar 文件中的所有类。

```
Enumeration<JarEntry> entries = jar.entries();
while(entries.hasMoreElements()) {
JarEntry entry = entries.nextElement();

if(!entry.getName().endsWith(".class"))
    continue;

Class<?> clazz;
try {
    clazz = ucl.loadClass(entry.getName().replace("/", ".").replace(".class", ""));
} catch(ClassNotFoundException e) {
    e.printStackTrace();
    continue;
}

if(entry.getName().contains("$1"))
    continue;

if(clazz.getSimpleName().startsWith("CMD_"))
    set.add(clazz); //Sort the classes how you like. Here I added ones beginning with 'CMD_' to a HashSet for later manipulation 
```

不要忘记关闭东西：

```
jar.close();
ucl.close(); 
```

所以，让我们回顾一下发生了什么：

1.  我们得到了文件
2.  我们使用新的将它添加到类路径中`URLClassLoader`
3.  我们遍历了 jar 中的条目，找到了我们想要的类
4.  我们关闭了`URLClassLoader`and`JarFile`以防止内存泄漏

嘘！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:44:20.700

扫描类路径以查找实现给定接口的所有类似乎是一件相当麻烦的事情，但似乎有[一些方法](https://stackoverflow.com/questions/1498122/java-loop-on-all-the-classes-in-the-classpath)可以做到这一点 - 那里的答案建议使用[反射](https://code.google.com/p/reflections/)库（我假设我实际上从未使用过它）

[一个更明智的方法是使用ServiceLoader](http://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html)机制，即使它意味着一些元数据编辑。

**编辑**：我错过了您帖子中的*反射*参考，抱歉......仍然，关于 ServiceLoader 的建议仍然适用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:26:46.853

如果您使用类路径中的 jar 启动程序，则可以通过获取系统属性`java.class.path`并创建[`JarFile`](http://docs.oracle.com/javase/7/docs/api/java/util/jar/JarFile.html)对象来获取该 jar 路径。然后，您可以[遍历该对象的条目](http://docs.oracle.com/javase/7/docs/api/java/util/jar/JarFile.html#entries%28%29)。每个条目都有一个路径（相对于 jar）。您可以解析此路径以获取包和类名称为`com.package.Class`. 然后，您可以使用 a`ClassLoader`加载该类并使用它做任何您想做的事情。（您可能想使用另一个 ClassLoader，但它适用于下面的那个）

```
public class Main {
    static ClassLoader clazzLoader = Main.class.getClassLoader();

    public static void main(String [] args) {

        try {
            List<Class<?>> classes = new LinkedList<>();

            // do whatever transformation you need to get the jar file
            String classpath = System.getProperty("java.class.path").split(";")[1];

            // I'm just checking if it's the right jar file
            System.out.println(classpath);

            // get the file and make a JarFile out of it
            File bin = new File(classpath);
            JarFile jar = new JarFile(bin);

            // get all entries in the jar file
            Enumeration<JarEntry> entries = jar.entries();

            // iterate over jarfile entries
            while(entries.hasMoreElements()) {
                try {
                    JarEntry entry = entries.nextElement();

                    // skip other files in the jar
                    if (!entry.getName().endsWith(".class"))
                        continue;

                    // extract the class name from its URL style name
                    String className = entry.getName().replace("/", ".").replace(".class", "");

                    // load the class
                    Class<?> clazz = clazzLoader.loadClass(className);

                    // use your Command class or any other class you want to match
                    if (Comparable.class.isAssignableFrom(clazz))
                        classes.add(clazz);
                } catch (ClassNotFoundException e) {
                    //ignore
                }
            }

            for (Class<?> clazz : classes) {
                System.out.println(clazz);
                clazz.newInstance(); // or whatever
            }   

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

我已经用内部类尝试过这个并且它也可以工作，我不知道`Reflections`库做了什么样的解析。

此外，你不需要一个完整的 Jar 来完成这样的工作。如果你有一个包含`.class`文件的 bin 文件夹，你可以递归地浏览它的文件/文件夹，将类文件解析为正确的格式，然后像上面一样加载它们。

**编辑**使用您的新代码，一些事情

1.  迭代时不要关闭`jar.close()`循环中的 jar。
2.  这`if(clazz.getName().startsWith("CMD_"))`不是你想要的。该`getName()`方法返回类的完整路径名，包括包。利用`getSimpleName()`
3.  如果你得到一个`ClassNotFoundException`，那是因为那个类不在类路径上。这告诉我您没有在类路径上运行带有 jar 文件的程序。加载类时，仅打开一个 zip/jar 文件并“加载”类文件是不够的。你必须像这样运行你的程序

    `java -classpath <your_jars> com.your.class.Main`

    或者使用 Eclipse（或其他 IDE），将 jars 添加到构建路径中。

看一下[这个](https://stackoverflow.com/questions/945962/java-problem-running-a-jar-file-in-command-line)关于使用类路径条目运行 java 的更多解释。

# jquery - 从 jQuery 调用 $setValidity

> ID：15534117
> 
> 赞同：1
> 
> 时间：2013-03-20T20:32:56.280
> 
> 标签：jquery, angularjs, angularjs-directive

我有一个文件上传器，我喜欢用 jQuery 编写的 UI。它在更改操作上绑定到我的文件元素。更改操作显示了漂亮的预览和其他很酷的东西。它还会检查 mime 类型是否在我的有效 mime 类型列表中。

此外，我已经连接了 angularJS 并监控了我的表单，并且我编写了许多指令来完成我的所有验证。我尝试为我的文件输入字段编写验证，但由于某种原因它永远不会被触发。做一些谷歌搜索表明它是因为 angular 不支持文件输入类型。

所以我将以下代码直接添加到我的 jQuery 更改操作中：

```
 angular.element(myinput).scope().$apply(function(scope){
      scope.project.avatar.$setValidity('image',false);
    }); 
```

我可以看到有效性在调试器中正确设置为 false，但我所拥有的 ng-class 操作没有看到它。所以除此之外，我有以下标签：

```
<div ng-class="{error: project.avatar.$invalid}">You did it wrong</div> 
```

该类永远不会被添加。

从 Angular 文档看来， $apply 应该强制刷新模型，以便一切最终恢复同步。那显然没有发生，但我不确定我做错了什么。谷歌搜索找到了很多关于如何从 Angular 中调用 jQuery 的示例，但关于如何从 jQuery 中调用 Angular 的信息却很少。任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:39:00.063

你能试试下面的代码吗

```
<div ng-class="{error: project.avatar.image}">You did it wrong</div> 
```

这里`validationErrorKey`is `image`，因此`$error`输入类型文件的对象将有一个名为的键，该键`image`将是`true`或`false`基于您在验证后设置的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T04:07:34.737

您可能正在寻找的是

标记

```
<div ng-show="project.avatar.$invalid">You did it wrong</div> 
```

JS

```
 var valid = some logic;
    angular.element(this).scope().$apply(function(scope){
        scope.project.avatar.$setValidity('image', valid);
    }); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/8UaML/2/)

# c# - 2 条产品线共享相同的代码

> ID：15534118
> 
> 赞同：1
> 
> 时间：2013-03-20T20:32:56.817
> 
> 标签：c#, oop, refactoring, factory

我们正在开发两条共享相同代码的产品线。

对于不同的功能，我让两个产品线实现相同的接口（或在某些情况下为基类），这些类型将在 Main 类中创建（这两个产品线是分开的）并进一步传递到下游。

对于深入业务逻辑的代码，很难有特定于产品线的代码。我们不想使用 if(ProductLine == "ProductLine1") 和 else 方法。

所以我打算实现一个工厂类，它有静态方法来返回 NewObject1()、NewObject2() 等等。这个 Factory 类将在 Main 类中注册为 Factory.RegisterClient(ProductLine1)。

因此，通过上述方法，工厂（内部包含 ProductLine1Factor 和 ProductLine2Factory）知道要创建哪种类型的对象。

你知道解决这个问题的更好方法吗？请注意，ProductLine1 已经存在，而 ProductLine2 是新事物（但 90% 与 ProductLine1 相似）。我们不能进行剧烈的重构，使得两条产品线都存在。我们希望尽可能减少侵入性的代码更改。

工厂方法通常会公开一个接口，但接口的问题是我无法公开同样需要的静态类型。

如果一些专家能提供一些启示，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:39:49.770

你的方法听起来不错。

您为什么不使用像 NInject 或 Unity 这样成熟的 IoC 框架，而不是定制的工厂？您可以为每个客户端实现两次服务，并在容器配置文件中静态选择一个。这样，如果您添加另一个实现，您甚至不需要更改单行代码，您只需重新配置，即在 xml 文件中进行一些更改。

无论如何，IoC 容器只是一个工具，不管使用与否，它只是取代了您的工厂（IoC 容器有时被称为“类固醇工厂”）。

# ruby-on-rails - 如何在rails中自定义设计表单css

> ID：15534122
> 
> 赞同：8
> 
> 时间：2013-03-20T20:33:13.727
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise, sass

命令`rails generate devise:views`成功在下创建文件夹`\app\views\users`

我正在寻找自定义设计表单，但不确定是否要放置 css`application.css`或者我需要单独创建`user.css.scss`. 谷歌了一下并检查了 git doc ，但没有指定设计中的 CSS 处理。

告诉我正确的处理方法

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T20:47:39.680

设计将使用您的默认布局。因此，您使用的 CSS`views/layouts/application.html.erb`将在您生成的设计视图中使用。

如果你想设计特定的布局，你可以创建一个`views/layouts/devise.html.erb`文件，你可以在其中提供设计特定的 CSS。由于 Rails 命名约定，它会自动选择它。

以上内容适用于任何控制器，只需在以控制器命名的布局中添加一个文件，例如。`views/layouts/reservations.html.erb`为了`ReservationsController`

您还可以`Devise::RegistrationsController`通过创建目录`views/layouts/devise`并添加`views/layouts/devise/registrations.html.erb`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-10-21T09:38:32.153

如果您正在执行特定于控制器的样式表，也就是说，如果您关闭了将所有样式表自动编译为 . `application.css`，您应该在设计控制器之后命名您的样式表，例如：

```
registrations.css.scss 
```

并将其添加到`Rails.application.config.assets.precompile`列表中`assets.rb`。

样式表的放置是标准的，`app/assets/stylesheets/`因此请注意设计控制器与您的控制器之间的名称冲突。

要在布局中获取特定于控制器的样式表，您需要以下内容：

### 高达 4.1 的导轨

```
<%= stylesheet_link_tag controller_name, media: 'all' if Rails.application.assets.find_asset("#{controller_name}.css") %> 
```

### 导轨 4.2+

```
<%= stylesheet_link_tag controller_name, media: 'all' if asset_present?("#{controller_name}.css") %>

# ...meanwhile, somewhere in the helpers...

def asset_present?(name)
  # Rails 4.1 had Rails.application.assets filled out in all environments.
  # Rails 4.2 has it filled only when config.assets.compile == true which is only
  # in development by default.
  if Rails.application.assets.present?
    Rails.application.assets.find_asset(name)
  else
    Rails.application.assets_manifest.files.values.map { |v| v['logical_path'] }.include?(name)
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T11:13:51.923

要生成设备视图，请运行此行

```
rails generate devise:views 
```

并使用页面样式做任何你想做的事情。

阅读更多点击[这里](https://github.com/plataformatec/devise)

# intellij-idea - 在intellij中配置tomcat 7

> ID：15534123
> 
> 赞同：2
> 
> 时间：2013-03-20T20:33:15.967
> 
> 标签：intellij-idea, tomcat7

我正在尝试使用 intellij 12 配置 tomcat 7，但没有成功。

如果我从命令行运行 catalina.sh 启动脚本，tomcat 可以正常启动，我可以看到 tomcat 主页。

如果我从 Intellij 运行 tomcat，我会得到以下堆栈跟踪（来自 intellijs 日志文件）：

```
2013-03-20 21:11:48,631 [1065007]  DEBUG - .util.AbstractConnectorCommand -  
javax.management.InstanceNotFoundException: Catalina:type=Server at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getMBean(DefaultMBeanServerInterceptor.java:1095)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:643)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:668)
    at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1442)
    at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:75) 
```

.....................

看起来它找不到任何tomcat实例。

我在 intellij 的输出日志中没有收到任何错误，在 intellij 中配置 tomcat 时也没有错误。

输出日志：/Library/Tomcat/bin/catalina.sh 运行

```
Mar 20, 2013 9:11:48 PM org.apache.catalina.core.AprLifecycleListener init
    INFO: The APR based Apache Tomcat Native library which allows optimal performance in                   
    production environments was not found on the java.library.path: /Users/rana/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
Mar 20, 2013 9:11:48 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Mar 20, 2013 9:11:48 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Mar 20, 2013 9:11:48 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 482 ms
Mar 20, 2013 9:11:48 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Mar 20, 2013 9:11:48 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.37
Mar 20, 2013 9:11:48 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Mar 20, 2013 9:11:48 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
Mar 20, 2013 9:11:48 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 37 ms
Connected to server
Mar 20, 2013 9:11:58 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory /usr/local/apache-tomcat-7.0.37/webapps/manager 
```

有谁知道为什么会这样？

# ruby-on-rails - 如何在重定向时显示 Rails flash 通知？

> ID：15534128
> 
> 赞同：68
> 
> 时间：2013-03-20T20:33:40.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, ruby-on-rails-4, rails-flash

我在 Rails 控制器中有以下代码：

```
flash.now[:notice] = 'Successfully checked in'
redirect_to check_in_path 
```

然后在 /check_in 视图中：

```
<p id="notice"><%= notice %></p> 
```

但是，通知没有出现。如果我不在控制器中重定向，则效果很好：

```
flash.now[:notice] = 'Successfully checked in'
render action: 'check_in' 
```

不过，我需要重定向……而不仅仅是该动作的渲染。重定向后我可以有一个快速通知吗？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-03-20T20:39:58.637

删除`.now`. 所以只要写：

```
flash[:notice] = 'Successfully checked in'
redirect_to check_in_path 
```

当`.now`您只是渲染而不是重定向时，应该特别使用。重定向时，`.now`不使用 。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-03-21T10:52:12.803

```
redirect_to new_user_session_path, alert: "Invalid email or password" 
```

代替`:alert`你可以使用`:notice`

显示

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-12-12T16:10:55.453

或者你可以在一行中完成。

```
redirect_to check_in_path, flash: {notice: "Successfully checked in"} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-05-25T13:49:39.413

这也可以

`redirect_to check_in_path, notice: 'Successfully checked in'`

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-10-05T20:41:03.880

如果您使用的是 Bootstrap，这将在作为重定向目标的页面上显示格式良好的 flash 消息。

在您的控制器中：

```
if my_success_condition
  flash[:success] = 'It worked!'
else
  flash[:warning] = 'Something went wrong.'
end
redirect_to myroute_path 
```

在您看来：

```
<% flash.each do |key, value| %>
  <div class="alert alert-<%= key %>"><%= value %></div>
<% end %> 
```

这将产生如下 HTML：

```
<div class="alert alert-success">It worked!</div> 
```

有关可用的引导警报样式，请参阅： http: [//getbootstrap.com/docs/4.0/components/alerts/](http://getbootstrap.com/docs/4.0/components/alerts/)

参考：[https ://agilewarrior.wordpress.com/2014/04/26/how-to-add-a-flash-message-to-your-rails-page/](https://agilewarrior.wordpress.com/2014/04/26/how-to-add-a-flash-message-to-your-rails-page/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-02-08T18:44:40.063

我有同样的问题，你的问题解决了我的问题，因为我忘记包含在 /check_in 视图中：

```
<p id="notice"><%= notice %></p> 
```

在控制器中，只有一行：

```
redirect_to check_in_path, :notice => "Successfully checked in" 
```

# python - 自然语言处理

> ID：15534135
> 
> 赞同：1
> 
> 时间：2013-03-20T20:34:11.300
> 
> 标签：python, nlp, nltk

我有一个词可以说“赛车”。

我想知道它的所有格式名词、形容词动词等。例如。赛车比赛等

有没有可以帮助我解决这个问题的python库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:41:53.690

如果您有兴趣*匹配*这些字符串，我建议您查看[blurwuzzy](https://github.com/seatgeek/fuzzywuzzy)。它使您可以轻松地标记字符串并在一定容差内基于标记等效性进行匹配。

例如，'Race' 和 'Racer' 的标记匹配率会很高，可以认为是匹配的。

至于推断单词的不同形式，恐怕我从来没有见过罐头，尽管这很可能有助于实现您的目标，并且可能为您提供编写自己的单词的正确起点。

我希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:44:32.243

我发现了类似的问题[Convert words between verb/noun/adjective forms](https://stackoverflow.com/questions/14489309/convert-words-between-verb-noun-adjective-forms)

在其中一个答案中，用户@PBelzile 建议在线服务 Idilia： [http ://www.idilia.com/demos/language-graph-browser/?node=code%2FV3](http://www.idilia.com/demos/language-graph-browser/?node=code%2FV3)

看起来它可以做你想做的事。

您也可以尝试使用 wordnet 的 nltk：

```
import nltk
nltk.download("wordnet")

from nltk.corpus import wordnet as wn

for lemma in wn.lemmas("race"):
    for form in lemma.derivationally_related_forms():
        print lemma, form 
```

输出：

```
Lemma('race.n.01.race') Lemma('race.v.02.race')
Lemma('race.n.02.race') Lemma('race.v.02.race')
Lemma('race.n.02.race') Lemma('racy.s.04.racy')
Lemma('race.n.03.race') Lemma('racial.a.01.racial')
Lemma('race.v.02.race') Lemma('racing.n.01.racing')
Lemma('race.v.02.race') Lemma('race.n.02.race')
Lemma('race.v.02.race') Lemma('racer.n.03.racer')
Lemma('race.v.02.race') Lemma('racer.n.02.racer')
Lemma('race.v.02.race') Lemma('race.n.01.race')
Lemma('race.v.04.race') Lemma('racer.n.01.racer') 
```

# vb.net - 检测单选按钮更改

> ID：15534138
> 
> 赞同：4
> 
> 时间：2013-03-20T20:34:26.503
> 
> 标签：vb.net, radio-button, detect

我在一个表单上有大约 50 个单选按钮，我不想为每个单选按钮创建一个 if 语句来检测一个何时更改，它们不是组框的一部分。我将如何检测是否有任何单选按钮更改，然后将名称写入另一个变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:16:00.887

将所有单选按钮放在面板上并循环通过面板单选按钮控件，以编程方式为每个单选按钮添加相同的事件处理程序，如@Steve 所述。我喜欢处理事件的一种方法是为每个单选按钮分配一个索引到其标签属性中。然后只需将任何相关数据存储在对象列表中，并通过使用其标签从列表中拉出它的相应对象来访问该单选按钮的数据。比手动操作要容易得多。

### 编辑：很好的捕捉@Neolisk。更新了答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T20:49:44.813

您可以始终将所有 50 个单选按钮的 CheckedChanged 事件设置为相同的事件处理程序。这是通过代码完成的示例：

```
Private Sub OnChange(sender As System.Object, e As System.EventArgs)
    Dim rb = CType(sender, RadioButton)
    Console.WriteLine(rb.Name + " " + rb.Checked.ToString)
End Sub

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    AddHandler Me.RadioButton1.CheckedChanged, AddressOf OnChange
    AddHandler Me.RadioButton2.CheckedChanged, AddressOf OnChange
    ' and so on .....'
End Sub 
```

我已经通过代码完成了这项工作，而不是使用设计器来避免长时间添加`Handles RadioButton1.CheckedChanged, RadioButton2.CheckedChanged .......`

# c++ - 如何将原始指针包装到 shared_ptr 并防止 shared_ptr 删除对象？

> ID：15534146
> 
> 赞同：3
> 
> 时间：2013-03-20T20:34:41.410
> 
> 标签：c++, shared-ptr

我需要将原始指针包装成 a`shared_ptr`以便将其传递给函数。该函数一旦返回就不会持有对输入对象的任何引用。

```
{
  MyClass i;
  shared_ptr<MyClass> p(&i);
  f(p);
  // BAD: shared_ptr will delete i.
} 
```

如何防止`shared_ptr`删除引用的对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:20:31.633

正如[克里斯](https://stackoverflow.com/users/962089/chris)在评论中提到的那样，写一个空的删除器：

```
#include <type_traits>

template <typename T>
struct empty_delete
{
    empty_delete() /* noexcept */
    {
    }

    template <typename U>
    empty_delete(const empty_delete<U>&,
        typename std::enable_if<
            std::is_convertible<U*, T*>::value
        >::type* = nullptr) /* noexcept */
    {
    }

    void operator()(T* const) const /* noexcept */
    {
        // do nothing
    }
}; 
```

使用示例：

```
#include <iostream>
#include <memory>

struct noisy
{
    noisy() { std::cout << "alive" << std::endl; }
    ~noisy() { std::cout << "dead" << std::endl; }

    noisy(const noisy&);
    noisy& operator=(const noisy&);
};

template <typename T>
void take(T& yours)
{
    std::cout << "Taking..." << std::endl;
    {
        auto mine = std::move(yours);
    }
    std::cout << "Took." << std::endl;
}

int main()
{
    std::unique_ptr<noisy> a(new noisy());
    std::shared_ptr<noisy> b(new noisy());
    std::unique_ptr<noisy, empty_delete<noisy>> c(new noisy());
    std::shared_ptr<noisy> d(new noisy(), empty_delete<noisy>());

    take(a);
    take(b);
    take(c);
    take(d);
} 
```

输出：

> 活着
> 活着
> 活着
> 活着
> 采取...
> 死了 采取
> 了。
> 采取...
> 死
> 了。
> 采取...采取
> 。
> 采取...采取
> 。

当然，这个例子会泄漏内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-21T19:18:00.363

对于评论中提到的 .NET/clr，您应该实现`ref class`、传递托管句柄`^`并让垃圾收集器管理生命周期。

```
ref class MyClassManaged : public Pen
{
public:
  MyClassManaged() : Pen{}, native_{ new MyClass{} } { }
  ~MyClassManaged() { this->!MyClassManaged(); }
  !MyClassManaged() { delete native_; }
private:
  MyClass* native_;
};
//...
{
  MyClassManaged^ i = gcnew MyClassManaged{};
  fManaged(i);
} 
```

* * *

**TL;DR 只需保留另一个活动副本，如果您仍然需要它，则在堆而不是堆栈上`shared_ptr<MyClass>`分配。`i`**

方案 1

```
{
  shared_ptr<MyClass> another_p;
  {
    MyClass i;
    shared_ptr<MyClass> p(&i);
    f(p);
    // p has not deleted i yet
    another_p = p; // increment reference count
    // p will decrement the reference count
    // i will be deleted due to stack unwinding
  }
  // another_p still holds a reference to where i was on the stack
  if (another_p)
    something(); // yes, something() will be invoked
  else
    nothing(); // no, nothing() won't run here
  // another_p will attempt to delete again if not the shared_ptr is not copied elsewhere
} 
```

方案 2

```
{
  shared_ptr<MyClass> another_p;
  {
    auto p = make_shared<MyClass>();
    auto& i = *p;
    f(p);
    // p has not deleted i
    another_p = p; // increment reference count
    // p will decrement the reference count
    // i will be NOT deleted
  }
  // another_p still holds a reference to where i was on the heap
  if (another_p)
    something(); // yes, something() will be invoked
  else
    nothing(); // no, nothing() won't run here
  // another_p will attempt to delete again if not the shared_ptr is not copied elsewhere
}
// it will finally be deleted now 
```

只需保留 shared_ptr 的另一个副本；无需像空的删除器一样弄乱。

# python - sqlalchemy中的python继承

> ID：15534147
> 
> 赞同：6
> 
> 时间：2013-03-20T20:34:42.910
> 
> 标签：python, inheritance, sqlalchemy

所以我是这个 python 和 sqlalchemy 的新手。我需要一些关于继承的帮助，或者可能是一个 mixin（而是继承）。

我有一些伪代码，但我还没有真正取得任何进展：

```
Base = declarative_base()

class ModelBase(Base):
  """Base model that only defines last_updated"""
  __tablename__ = 'doesnotexistandtheclassshouldnotbeinstantiated'

  #all tables inheriting from ModelBase will have this column
  last_updated = Column(DateTime)

  def __init__(self, last_updated):
    self.last_updated = last_updated

class User(ModelBase):
  """Defines the user but should also have the last_updated inherited from ModelBase"""
  __tablename__ = 'user'

  id = Column(Integer, primary_key=True)

  def __init__(self, ....):
    ModelBase.__init__(last_updated) 
```

我希望从 ModelBase 继承的所有表也都具有 last_updated。我该怎么做？

**更新代码：**

```
class BaseUserMixin(object):
    """Base mixin for models using stamped data"""

    @declared_attr
    def last_updated(cls):
        return Column(DateTime)

    @declared_attr        
    def last_updated_by(cls):
        return Column(String)

    def __init__(self, last_updated, last_updated_by):
        self.last_updated = last_updated
        self.last_updated_by = last_updated_by

Base = declarative_base(cls=BaseUserMixin)

class User(Base):
    __tablename__ = 'user'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    email = Column(String)
    fullname = Column(String)
    password = Column(String)
    enabled = Column(Boolean)

    def __init__(self, name, fullname, password, email, last_updated, last_updated_by):
        self.name = name
        self.fullname = fullname
        self.password = password
        self.email = email
        # goes wrong here
        super(User, self).__init__(last_updated, last_updated_by)

    def __repr__(self):
        return "<User('%', '%', '%', '%', '%', '%')>"\
               % (self.name,
                  self.fullname,
                  self.password,
                  self.email,
                  self.last_updated,
                  self.last_updated_by
                  ) 
```

错误是：

```
_declarative_constructor() takes exactly 1 argument (3 given) 
```

可能是什么问题？我认为它正在工作，但是当重新运行调试器时它失败了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T20:50:03.500

解决方案是[`declared_attr`](http://docs.sqlalchemy.org/en/rel_0_8/orm/extensions/declarative.html#sqlalchemy.ext.declarative.declared_attr)；它将在任何时候被调用并添加到 DeclarativeMeta 的实例中：

**编辑**：`__init__`自动提供的`declarative`cannot call `super()`。如果你想要它，它必须是*last*，唯一的方法是使用常规的 mixin。

```
import datetime
from sqlalchemy import Column, DateTime, Integer, String
from sqlalchemy.ext.declarative import declared_attr, declarative_base

class BaseMixin(object):
    @declared_attr
    def last_updated(cls):
        return Column(DateTime)

    def __init__(self, last_updated, *args, **kwargs):
        super(BaseMixin, self).__init__(last_updated=datetime.datetime.now(), *args, **kwargs)
        print "BaseMixin.__init__"
        self.last_updated = last_updated

ModelBase = declarative_base() 
```

请注意，mixin*必须先出现*！

```
class User(BaseMixin, ModelBase):
    """Defines the user but should also have the last_updated inherited from ModelBase"""
    __tablename__ = 'user'

    id = Column(Integer, primary_key=True)
    username = Column(String)

    def __init__(self, *args, **kwargs):
        super(User, self).__init__(last_updated=datetime.datetime.now(), *args, **kwargs)
        print "User.__init__"

if __name__ == '__main__':
    from sqlalchemy import create_engine
    from sqlalchemy.orm import sessionmaker
    engine = create_engine('sqlite:///:memory:', echo=True)
    ModelBase.metadata.create_all(engine)
    user = User(username='alice')

    Session = sessionmaker(engine)
    session = Session()
    session.add(user)
    session.commit() 
```

然而; 您确定要首先`__init__`用于此目的吗？`__init__`从查询返回对象时不调用；您真正想要的是在修改列时立即*更改为*。这`Column()`已经被烤熟了：

```
from sqlalchemy import func

class BaseMixin(object):
    @declared_attr
    def created_date(cls):
        return Column(DateTime, default=func.now())

    @declared_attr
    def modified_date(cls):
        return Column(DateTime, default=func.now(), onupdate=func.now()) 
```

回到使用`cls=`论点

```
ModelBase = declarative_base(cls=BaseMixin)

class User(ModelBase):
    __tablename__ = 'user'

    id = Column(Integer, primary_key=True)
    username = Column(String)

if __name__ == '__main__':
    engine = create_engine('sqlite:///:memory:', echo=True)
    ModelBase.metadata.create_all(engine)
    user = User(username='alice')

    Session = sessionmaker(engine)
    session = Session()
    session.add(user)
    session.commit()

    session = Session()
    sameuser = session.query(User).one()
    sameuser.username = 'bob'
    session.commit() 
```

# css - 全尺寸 在另一个里面 旁边

> ID：15534148
> 
> 赞同：1
> 
> 时间：2013-03-20T20:34:45.717
> 
> 标签：css

这是我的小游戏的 html。

```
 <div id="game">
        <div id="choice" onmouseover="npcRoll()">
            <p>Chosse your weapon!</p>
            <button id="rock" onClick="choose(1)">Rock</button>
            <button id="paper" onClick="choose(2)">Paper</button>
            <button id="scissors" onClick="choose(3)">Scissors</button>
            <p>You chose <span id="userChoice">none</span>!</p>
        </div>
        <div id="confirm">
            <p>When you are ready, click on <strong>Fight</strong>.</p>
            <button id="resulot" onClick="resulte()">Fight!</button>
        </div>
        <div id="clear"></div>
    </div> 
```

这是我的 CSS

```
body {
    background-color: #DFEFF0;
    text-align: center;
}

button {
    font-size: 22px;
    border: 2px solid #87231C;
    border-radius: 100px;
    width: 100px;
    height: 100px;
    color: #FF5A51;
    text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
    padding-top: 36px;
}

button:active {
    font-size: 22px;
    border: 2px solid #328505;
    color: #32A505;
    border-radius: 100px;
    width: 100px;
    height: 100px;
    padding-top: 36px;
}

#rock {
    width: 100px;
    height: 100px;
    background-color: white;
    background-image: url(img/rock.png);
    background-repeat: no-repeat;
    background-size: 80px 80px;
    background-position: center center;
}
#paper {
    width: 100px;
    height: 100px;
    background-color: white;
    background-image: url(img/paper.png);
    background-repeat: no-repeat;
    background-size: 80px 80px;
    background-position: center center;
}
#scissors {
    width: 100px;
    height: 100px;
    background-color: white;
    background-image: url(img/scissors.png);
    background-repeat: no-repeat;
    background-size: 80px 80px;
    background-position: center center;
}

#result {
    background-color: #ECECEC;
    border:2px solid gray;
    border-radius:25px;
    width: 200px;
    height: 100px;
}

#choice {
    border: 2px solid #87231C;
    border-radius: 12px;
    border-top-right-radius: 0px;
    border-bottom-right-radius: 0px;
    background-color: #FF5A51;
    width: 350px;
    float: left;
}
#game {
    border: 2px solid #fff;
    border-radius: 15px;
    background-color: white;
    width: 500px;
    margin: 0 auto;
    display: block;
    overflow: auto;
}
#confirm {
    border: 2px solid #00008B;
    border-radius: 12px;
    border-top-left-radius: 0px;
    border-bottom-left-radius: 0px;
    background-color: #1E90FF;
    width: 142px;
    height: 100%;
    float: right;
}
#clear {
    clear: both;
} 
```

您可以在[http://jsfiddle.net/RWfhQ/](http://jsfiddle.net/RWfhQ/)上查看。我想让蓝色 div 与红色 div 大小相同。我想让它们大小相同。蓝色的 div 可能会比红色的大，所以我需要它们的大小相同。

**非常感谢。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:38:53.897

显而易见的解决方案是`position: relative`在`#game`container 和`position: absolute`on 上使用`#confirm`：

```
#confirm {
    ...
    position: absolute;  // <-- stretch the div
    top: 0;
    bottom: 0;
    right: 0;
} 
```

`height: 100%`在这种情况下，您不再需要`float: right`。

[http://jsfiddle.net/RWfhQ/1/](http://jsfiddle.net/RWfhQ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:41:04.877

由于这是一个固定宽度，您可以使用[假列技巧](http://alistapart.com/article/fauxcolumns)。将两者都包裹在 a`<div>`中以处理背景，并使用一半蓝色和一半红色的背景图像。

# c# - 不能使用 FileFormatException (?)

> ID：15534149
> 
> 赞同：9
> 
> 时间：2013-03-20T20:34:46.413
> 
> 标签：c#, exception, xna

我目前正在为我的小型 XNA 项目编写一个自定义导入器，并且正在尝试做一些简单的事情，比如[`FileFormatException`](https://msdn.microsoft.com/en-us/library/system.io.fileformatexception.aspx)在我的导入器`Import`方法中抛出一个。

我已经引用了`WindowsBase.dll`，所以`FileFormatException`应该`System.IO`在 IntelliSense 下可用，对吧？我输入`System.IO`并且没有自动完成`FileFormatException`under `System.IO`。

这是 throw 语句所在的位置：

```
namespace TetrominoImporter
{
    public class TetrominoReader : ContentImporter<Tetromino>
    {
        public const string blockFileName = "blocks.txt";

        public override Tetromino Import(string filename, ContentImporterContext context)
        {
            // HERE 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-20T20:43:01.850

您需要在引用中包含 WindowsBase，因为 FileFormatException 是在该程序集中定义的。添加后，您应该能够解决 System.IO.FileFormatException

# javascript - 使用 TaffyDB（或其他 JS DB）进行不区分大小写的查询

> ID：15534152
> 
> 赞同：3
> 
> 时间：2013-03-20T20:35:02.767
> 
> 标签：javascript, taffydb

我正在使用 TaffyDB 作为我现在正在开发的网站的“数据库”。它非常整洁，我可以进行“喜欢”搜索。但是，“like”搜索仍然区分大小写，并且如果存在记录：“Banana”，则“banana”查询将失败。

*   任何人都知道如何使用 TaffyDB 进行此类查询
*   或者，有没有可以做这种功能的 JS DB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:05:48.750

只需使用`likenocase`：

`db( {title:{"likenocase":val}} ).order( ...`

# asp.net-mvc - 从常规 MVC 控制器访问 ASP Web API 方法

> ID：15534156
> 
> 赞同：1
> 
> 时间：2013-03-20T20:35:25.893
> 
> 标签：asp.net-mvc, asp.net-web-api

我有一个相当复杂的解决方案，我使用 ASP Web API 等实现了它。我的解决方案中有 3 个项目现在值得一提。一种是仅包含 api 方法的 WebAPI。另外两个是我的应用程序的后端和前端。后端使用 SPA 方法为视图加载大部分空壳，并使用 ajax 访问 API 填充所有内容。另一方面，出于对 SEO 的考虑，前端决定通过更传统的方式实现，也就是大多数东西都呈现在服务器端。我的问题是，是否可以简单地从前端控制器调用 web api 方法并将结果发送到视图？我认为在常规控制器中复制大多数代码没有意义，因为这一切都是通过 api 完成的。

有这方面的样本吗？我一直在寻找，但找不到太多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T02:01:34.117

如果您需要从 C# 代码（MVC 控制器或其他地方）调用 Web API 服务，可以使用 HttpClient 或 WebClient 通过 HTTP 调用服务。

如果您需要简单地重用代码，则应将其抽象为类库 (DLL) 并从 Web API 和 MVC 项目中引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:42:56.547

我遇到过同样的情况，并且至少在一段时间内使用了 MVC 控制器中的 Web API 控制器。您可以简单地通过创建 Web API 控制器的新对象然后调用它们的适当方法来做到这一点。我发现这个方法最初工作得很好，但是会创建依赖关系，这意味着你的 Web API 不能在不改变 MVC 控制器的情况下改变。

我的建议是在你的模型上添加对部分类有意义的尽可能多的功能，如果这仍然不够，那么创建另一个包含所有共享业务逻辑的逻辑层。你的 MVC 和 Web API 控制器中不应该有重复的逻辑，它们应该只是作为获取数据的粘合剂。

# ruby-on-rails - 有效地使用数组和哈希？

> ID：15534167
> 
> 赞同：0
> 
> 时间：2013-03-20T20:36:05.940
> 
> 标签：ruby-on-rails, ruby, arrays, hash

我有这些数组：

```
 @users = [[1,'Mark'],[2,'Bill'],[3,'John']]
 @projects = [[1,'Change the world'],[2,'Build a computer'],[3,'Run in a circle']]
 @points_due = [[1,1,"40"],[1,3,"80"],[2,1,"20"]] 
```

我有一些解决方案，但我正在寻找迭代所有这些项目的最高效的方法，就好像结果是通过 ActiveRecord 给我的一样。

我想显示一个`<UL>`带有项目的 a，以及一个`<LI>`带有用户名和该特定用户的积分。我想出了一些使用`inject`and将数组转换为哈希的解决方案`map`，但是，我觉得有更好的方法来做这样的事情。

我想做类似的事情：

```
@projects.each do |project|
  <%= project.name %>
  <ul>
  project.each do |user|
    <li><%= user.name %> | <%= user.points_due %></li>
  end
  </ul>
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:55:43.387

要执行您正在谈论的事情（迭代模型 X，然后为每个模型 Y 显示某些内容），嵌套`.each`循环（或多或少类似于您在问题中包含的那个）是一个非常标准方法。如果显示开始变得复杂，您可以将其提取为一层或多层分音。

担心这种或其他方法的性能充其量可能为时过早。操作数据结构的不同方式的性能不会成为影响页面整体性能的重要因素。一旦你有一些工作，看看它是否真的很慢，*然后*担心如何让它更快。

**根据您的评论进行编辑：**对于此数据，哈希数组（带有键符号）可能比数组数组更好。不是因为它们的性能更高，而是因为它会让你的代码更容易理解（对你自己来说，即使没有其他人在它上面工作过）。

考虑：使用 AR 对象，您将执行以下操作来打印每个项目的名称：

```
@projects.each do |project|
  puts project.name
end 
```

如果您使用哈希模拟此行为：

```
@projects.each do |project|
  puts project[:name]
end 
```

而使用数组：

```
@projects.each do |project|
  puts project[1]
end 
```

更难记住，你必须确保你的代码以正确的顺序放置属性，或者这可能是项目的其他方面，而不是名称。

假设您已同意我的观点并正在使用此结构（等），这是一种执行您提到的迭代的方法，只需打印（我认为是）所需的数据 -每个用户`@projects = [{:title => 'foo', 'id' => 1}, {:title => 'bar', :id => 2}]`列出的点数`@points_due`在那个项目中有一些：

```
@projects.each do |project|
  puts project[:name]
  @points_due.select{|pd| pd[:project_id] == project[:id] }.each do |project_points|
    user = @users.select{|u| u[:id] == project_points[:user_id]}.first
    puts "#{user[:name]} has #{project_points[:points]} points due on this project."
  end
end 
```

我希望这近似于您想要的输出，但如果不是，它应该很容易用作示例 - 明智地使用`.select`可能会完成它。

**编辑第二个：**将数组转换为哈希：

```
@projects_as_arrays = [[1,'Change the world'],[2,'Build a computer'],[3,'Run in a circle']]
@projects_as_hashes = @projects_as_array.map do |p_arr|
  {:id => p_arr[0], :name => p_arr[1]}
end 
```

您应该能够按照这些一般路线为每个阵列做一些事情。

# android - Capturing audio frames from HDMI IN port

> ID：15534175
> 
> 赞同：0
> 
> 时间：2013-03-20T20:36:18.533
> 
> 标签：android, linux, embedded, google-tv, hdmi

I have a rooted HiSense GoogleTV which has HDMI IN and OUT ports.

What I want to do is to record about 10 secs of the audio from the HDMI IN (from the set-top box). I am new to this, so please bear with me.

1.  Is this possible to do this on a rooted device?

2.  Does the HDMI data get decrypted (due to HDCP) after the HDMI IN and re-encrypted before it is routed out via HDMI out?

3.  If I were to try to capture the audio frames on a regular Linux box, how should I go about it? What components should I look into? I cannot find any documentation that describes the low level architecture and details on how the HDMI IN signal gets routed to HDMI OUT.

4.  Can you please point to the Android framework code that actually does this routing from HDMI In to OUT? Basically, want to understand the flow of what happens to the audio signal during the transfer from the HDMI IN to the OUT.

I am not sure if my questions make sense, but I hope you can give me some pointers on where I should start.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:46:31.273

简短的回答：不可能。直通通过可信视频路径 SOC 与 android 完全隔离。您需要成为经过认证的 SOC 供应商才能接近信号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:00:18.610

HDMI 输入设备*应*标识为`AUDIO_DEVICE_IN_AUX_DIGITAL`（请参阅[audio.h](https://www.codeaurora.org/gitweb/quic/la/?p=platform/system/core.git;a=blob;f=include/system/audio.h;h=0a55ff0fe816326491f359b647d233a99573624f;hb=refs/heads/jb_mr1)），尽管我从未遇到具有 HDMI 输入的 Android 设备，因此无法验证。

音频路由由`AudioPolicyManager`. libhardware_legacy 中有一个`AudioPolicyManagerBase`，然后通常有一个特定于平台的`AudioPolicyManager`实现，它重载了一些基类的方法。找到此实现的位置取决于平台。在 Qualcomm 平台上，它通常位于源代码树中的 hardware/qcom/audio 下的某个位置。
执行`AudioPolicyManager`高级路由（例如将流类型和音频源映射到音频设备），然后使用`AudioHardware`实现和可能的其他特定于平台的类来执行低级路由（在硬件级别管理音频流，加载声学调整参数、与设备驱动程序的接口等）。

任何与 HDMI 输入相关的功能都可能是特定于供应商的，因此如果您希望能够查看，可能需要您的 Google TV 设备的完整源代码（即包括供应商在 vanilla Android 之上应用的所有补丁）处理 HDMI 音频输入的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:11:01.817

由于 Google TV 实施了 HDCP，您将无法访问视频或音频输入。改变这一点的唯一方法，即使是在有根设备上，也是改变谷歌电视代码，可能还有 SOC HDMI 驱动程序，谷歌都没有开源。

# maven - Artifactory maven 3无法找到快照文件

> ID：15534176
> 
> 赞同：2
> 
> 时间：2013-03-20T20:36:19.570
> 
> 标签：maven, artifactory, maven-metadata

我在将 jar 文件提供给 maven 3 构建过程时遇到问题

我已将 jar 文件 gwt-openlayers-server-1.0-SNAPSHOT.jar 部署到 libs-snapshot-local

我可以使用 Artifacts 选项卡中的常规查找找到这个 jar 文件，它显示为

```
<dependency>
    <groupId>org.gwtopenmaps.openlayers</groupId>
    <artifactId>gwt-openlayers-server</artifactId>
    <version>1.0-20130320.151820-1</version>
</dependency> 
```

所以我知道神器有它。

当我尝试使用带有以下部分的 pom 进行构建时

```
<dependency>
  <groupId>org.gwtopenmaps.openlayers</groupId>
  <artifactId>gwt-openlayers-server</artifactId>
  <version>1.0-SNAPSHOT</version> 
```

我收到一个关于无法找到 gwt-openlater-server 的诊断的构建错误，请参阅清单。

我不明白为什么我有这个问题，神器有文件！

我正在使用 mvn -U compile

有什么建议么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-28T15:47:04.197

检查您是否有 maven-metadata.xml 损坏，或者您的快照信息是否为空。不应该。

# c++ - 为什么 boost filter_iterator 有奇怪的 make_filter_iterator 函数？

> ID：15534180
> 
> 赞同：4
> 
> 时间：2013-03-20T20:36:34.823
> 
> 标签：c++, boost, boost-iterators

经过一番痛苦后，我设法将这个最小的 boost filter_iterator 示例拼凑在一起

```
using namespace std;
std::function<bool(uint32_t)> stlfunc= [](uint32_t n){return n%3==0;};
int main()
{
   vector<uint32_t> numbers{11,22,33,44,55,66,77,3,6,9};
   auto start = boost::make_filter_iterator(stlfunc, numbers.begin(), numbers.end());
   auto end   = boost::make_filter_iterator(stlfunc, numbers.end()  , numbers.end());
   auto elem  = std::max_element(start,end);
   cout << *elem;
} 
```

它工作得很好，但我想知道为什么 make_filter_iterator 需要`numbers.end()`？那样使用它可能是错误的，我从 C 数组示例中猜测它：http:
[//www.boost.org/doc/libs/1_53_0/libs/iterator/example/filter_iterator_example.cpp](http://www.boost.org/doc/libs/1_53_0/libs/iterator/example/filter_iterator_example.cpp)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T20:43:08.400

[文档](http://www.boost.org/doc/libs/1_53_0/libs/iterator/doc/filter_iterator.html)中对此进行了解释：

> 当跳过元素时，过滤器适配器必须知道何时停止以避免超出基础范围的末尾。因此，过滤器迭代器由一对迭代器构成，指示要遍历的未过滤序列中的元素范围。

从下面的源代码中，您可以看到总是检查它们是否已到达末尾`satisfy_predicate`：

```
void increment()
{
    ++(this->base_reference());
    satisfy_predicate();
}

void satisfy_predicate()
{
    while (this->base() != this->m_end && !this->m_predicate(*this->base()))
        ++(this->base_reference());
} 
```

[此外，正如Alex Chamberlain](https://stackoverflow.com/questions/15534180/why-boost-filter-iterator-has-weird-make-filter-iterator-function/15534312#comment22006984_15534312)所指出的，构造函数在传递结束迭代器时使其成为可选，例如：（`filter_iterator(Iterator x, Iterator end = Iterator());`假设它是默认可构造的）。`numbers.end()`因此，您可以在构建结束迭代器时从代码中省略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:45:04.530

如果您查看`make_filter_iterator`模板的声明，您会看到它如下所示：

```
template <class Predicate, class Iterator>
filter_iterator<Predicate,Iterator>
make_filter_iterator(Predicate f, Iterator x, Iterator end = Iterator()); 
```

具体来说，您会看到最后一个参数是默认参数，它设置为`Iterator()`which 意味着它是默认构造的，对于*某些类型*的迭代器，它的行为类似于实际`end()`迭代器，它指向任何数组的末尾，即它指向垃圾。

`end()`大多数容器类型确实需要传递一个实际的迭代器。

# ios - How does the My Verizon Mobile app know the device phone number?

> ID：15534182
> 
> 赞同：1
> 
> 时间：2013-03-20T20:36:42.033
> 
> 标签：ios

I just installed the My Verizon Mobile app onto an iPhone and upon launch it was immediately able to display the device's phone number - something which is not possible for regular apps to do.

Does anybody know how it does it, could it be one of these, or something else?

*   As the app is from Verizon, Apple has granted it permission to access private iOS APIs to obtain the phone number
*   The App makes an HTTP connection to a Verizon server which goes through a gateway which is able to detect the phone number and sends it back to the device in the HTTP response.

These are just my guesses as to what perhaps could be happening, does anybody know what actually is happening?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-12T10:40:29.410

如果您转到设置/常规/关于，您会找到一个 IMEI 号码和一个 ICCID 号码。IMEI号码识别手机，ICCID号码识别SIM卡。如果您有 Verizon 电话帐户，那么 Verizon 会将该 ICCID 号码与电话号码相关联。他们*必须*能够做到这一点，否则如果我拨打您的号码，Verizon 怎么会响起您的电话？

因此，Verizon 使用他们自己的数据来查找与您的 SIM 卡关联的电话号码，他们*必须*拥有这些数据才能使您的手机正常运行。这应该只适用于 Verizon 手机（如果您与其他电话公司有合同，其他电话公司应该能够找到您的电话号码，但如果您与 Verizon 合作，则不能）。

顺便说一句，如果你去设置/电话，我的 iPhone 显示的第一件事是“我的号码”。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-26T01:44:46.990

Verizon Mobile 应用程序，至少对于 android，在 rom 中带有特殊代码应用程序。您可以通过使用 Verizon Galaxy Nexus 并对其应用备用 rom（例如 CM10）来验证这一点。如果没有 rom 中的特殊“运营商 blob”，Verizon“专业应用程序”就无法工作。

这本身不是一个错误——非 Verizon rom 缺少特殊的“运营商位”，但也像许多人不希望在他们的 Nexi 上使用的运营商应用程序。您在 iPhone 上没有“自动登录”的原因是因为 Apple rom 中不存在此运营商“应用程序”。

# php - PHP 无法将上传的文件移动（写入）到挂载的网络驱动器

> ID：15534184
> 
> 赞同：0
> 
> 时间：2013-03-20T20:36:49.433
> 
> 标签：php, linux, windows, sharing, mount

我们通过在每台 Windows 机器上的共享本地目录中编辑工作文件来开发基于 PHP 的 Web 应用程序。然后（linux）登台服务器安装我们的共享驱动器并在子域下为它们提供服务。例如 joe.work.com 将服务于 Joe 的工作目录。然后，我们通过编辑我们的主机文件以将子域指向登台服务器来访问我们自己的登台站点……所有这些都很好！

我们现在遇到的问题是 PHP 似乎无权将上传的文件从 tmp 目录移动到挂载目录（实际上是共享的 Windows 驱动器...？）内的目录。

windows机器上的工作目录设置为允许所有人rw，我尝试将777放在登台机器上的挂载目录上，但我仍然被拒绝权限。

比如说，共享驱动器`\\joes_machine\joes_working_dir`在登台服务器上安装到`/var/mnt/joe`. 文件上传需要移动到`/images/common`.

尽管这个例子稍微有点笨拙，但我并没有在代码方面做任何花哨的事情：

```
$working_directory = '/var/mnt/joe';
$image_directory = '/images/common/';
$full_filename = $working_directory . $image_directory . $filename;
if(move_uploaded_file($_FILES['photo']['tmp_name'], $full_filename))
    // do some other stuff 
```

我的错误当然是：

```
Message: move_uploaded_file(/var/mnt/joe/images/common/resulting_filename.jpg): 
    failed to open stream: Permission denied
Message: move_uploaded_file(): Unable to move '/tmp/phpjsEfBc' to 
    '/var/mnt/joe/images/common/resulting_filename.jpg' 
```

我对与通过网络安装的 Windows 共享驱动器有关的文件权限有什么不理解，而 PHP 需要写入它？我似乎找不到挂机！

一旦我们投入生产，我们将不会使用模式，但如果有一个简单的解决方案能够在我们当前的开发环境中继续，那将是理想的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:17:31.523

经过几个小时的翻脸，我终于找到了我所缺少的东西。问题是提供的凭据无法按预期写入已安装的目录。我能够解决这个问题的方法是通过如下编辑 mount 命令：

```
mount -t cifs //shared/directory /mount/target
    -o rw,username=connectionuser,password=password,uid=48 
```

所以，`username`并且`password`将是用于连接到驱动器的 Windows 凭据，但`uid`指定 apache 运行的登台服务器上本地用户的唯一标识符，以便它可以写入已安装的目录。

以前，我没有指定本地用户的 uid，所以当 apache 试图写入挂载目录时，它试图使用 Windows 凭据（无法在“本地”驱动器上写入）

希望这会有所帮助！

# android - 将 android phon 添加到 DNS 服务器？

> ID：15534185
> 
> 赞同：0
> 
> 时间：2013-03-20T20:36:53.480
> 
> 标签：android, dns

我想知道是否有可能以及如何制作一个应用程序，该应用程序允许我将我的 android 手机放在 DNS 服务器中，就像我们在 Windows PC 中所做的那样。我想通过 DNS 网络中的名称来识别我的 android 手机，显然是在有 DNS 服务器的网络中。提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:58:10.930

如果您的 DNS 和 DHCP 服务器支持它，您可以让 DHCP 服务器自动更新 DNS 服务器。有关如何使用 Microsoft 服务器的说明，请参阅[http://technet.microsoft.com/en-us/library/cc787034(v=ws.10).aspx 。](http://technet.microsoft.com/en-us/library/cc787034(v=ws.10).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T09:45:43.500

通常，您有三种选择：

1.  静态IP。有时可以为您的手机获取一个固定 IP，在这种情况下，您只需要设置一次 DNS 记录，并且它不需要任何软件或手机本身的配置。您所需要的只是创建一个常规的 DNS 地址记录。（咨询您的 DNS 管理员（或在 superuser.com 上询问您是否需要帮助））

2.  家庭/办公网络 (DHCP)。如果您想通过 LAN 访问您的电话，并且此 LAN 有您控制的 DHCP 服务器，则可以将 DHCP 服务器配置为在您的电话连接时更新 DNS 记录。在这种情况下，电话也不需要任何特殊的配置/软件——它是一个需要配置的 DHCP 服务器。

3.  动态 DNS。您的手机可以通过动态 DNS 提交其地址。这适用于任何情况 - LAN（包括 NAT）和蜂窝连接。您通常需要为此订阅一些动态 DNS 服务，是的，有适用于 Android 的动态 DNS 客户端。尝试[在 Android 下设置动态 DNS 的 net-me.net 指南](https://www.net-me.net/client#android-neil) *（我是附属的）*。

*（您想要访问手机的目的是什么，哪些软件会监听传入的连接，以及是否可以从任何地方访问手机 IP - 这都是完全不同的故事。）*

# java - unable to send more than one file through socket in android

> ID：15534188
> 
> 赞同：0
> 
> 时间：2013-03-20T20:37:01.960
> 
> 标签：java, android, sockets, io

I am trying to record audio into a file in the server side which is an android device and send it to client, another android device when the record is done. It works fine for the first time, but when I record again, my second record is not received by the client. Here is my code

SERVER THREAD:

```
public class ServerThread implements Runnable {

    public void run() {
        try {
            if (SERVERIP != null) {
                serverSocket = new ServerSocket(SERVERPORT);
                while (true) {
                    client = serverSocket.accept();
                    OutputStream out = client.getOutputStream();
                    while(true){
                        //record status is true 
                        //when record is done
                        if(record_status){
                            try {
                                BufferedInputStream bis = new BufferedInputStream(new FileInputStream(new File(mFileName)));
                                BufferedOutputStream bout = new BufferedOutputStream(out);
                                copyFile(bis, bout);
                                bout.flush();
                            } catch (FileNotFoundException e) {
                                e.printStackTrace();
                            } catch (IOException e) {
                                e.printStackTrace();
                            }
                            record_status = false;
                        }
                    }
                }
            }
        } catch (Exception e) {

            e.printStackTrace();
        }
    }
} 
```

CLIENT THREAD:

```
 public class ClientThread implements Runnable {

    public void run() {
        try {
            InetAddress serverAddr = InetAddress.getByName(SERVERIP);
            Socket socket = new Socket(serverAddr, SERVERPORT);
            connected = true;
            while (connected) {
                try {
                    dis = socket.getInputStream();
                    while(true){
                        if(dis.available()>0){
                        BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(new File(mFileName)));
                        copyFile(socket.getInputStream(), bos);
                        bos.flush();
                        //file has been received
                        //start playing the audio
                        startPlaying();
                        }
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
            socket.close();
        } catch (Exception e) {
            connected = false;
        }
    }
} 
```

method copyFile:

```
 public static boolean copyFile(InputStream inputStream, OutputStream out) {
    byte buf[] = new byte[4092];
    int len;
    try {
        while ((len = inputStream.read(buf)) != -1) {
            out.write(buf, 0, len);

        }
        out.close();
        inputStream.close();
    } catch (IOException e) {

        return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:54:37.943

这真的应该是一个评论，但是我还没有代表。但在我看来，在服务器端，一旦该流被发送到客户端，您在 while 循环的第一次迭代中将 record_status 设置为 true，然后 record_status 设置为 false，并且在 while 循环内再也没有真正设置为 true。结果， if 语句中的代码永远不会再次执行。那么 record_status 在哪里再次设置为 true 呢？检查服务器端设备上的 logcat 以查看是否有任何内容实际放入比特流中以进行第二次录制，如果不是，这是您的问题

# javascript - javascript 预定义函数的算法（parseInt、parseFloat、isNaN 等）

> ID：15534192
> 
> 赞同：9
> 
> 时间：2013-03-20T20:37:09.900
> 
> 标签：javascript, native-code

如果可能的话，最好的方法是查看 Javascript 中预定义函数的底层代码。是否有说明这些代码是如何编码的文档，或者是实际查看底层代码的简单方法？

*   `parseInt`
*   `parseFloat`
*   `isNaN`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T20:40:37.933

它们是本机函数，并且可能以您的 JS 引擎编写的语言编码 - 您需要联系它的源代码。

但是，您可能对描述算法如何工作的[EcmaScript 规范](http://ecma-international.org/ecma-262/5.1/)更感兴趣。

如果幸运的话，对于某些功能，您甚至可能会找到 JS 等价物。您会在根据标准测试 ES 实现的页面上找到它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T20:43:15.983

进一步查看后，我在 ECMAScript 规范中发现了这一点。 [http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)

**当调用 parseInt 函数时，会执行以下步骤：**

1.  让 inputString 为 ToString(string)。
2.  令 S 是 inputString 的一个新创建的子字符串，由不是 StrWhiteSpaceChar 的第一个字符和该字符之后的所有字符组成。（换句话说，删除前导空格。）如果 inputString 不包含任何此类字符，则令 S 为空字符串。
3.  设符号为 1。
4.  如果 S 不为空且 S 的第一个字符是减号 -，则令符号为 1。
5.  如果 S 不为空并且 S 的第一个字符是加号 + 或减号 -，则从 S 中删除第一个字符。
6.  令 R = ToInt32(radix)。
7.  让 stripPrefix 为真。
8.  如果 R  0，则 © Ecma International 2011 105 a. 如果 R < 2 或 R > 36，则返回 NaN。湾。如果 R  16，让 stripPrefix 为假。
9.  否则，R = 0 a。令 R = 10。
10.  如果 stripPrefix 为真，则 a. 如果 S 的长度至少为 2，并且 S 的前两个字符是“0x”或“0X”，则从 S 中删除前两个字符并令 R = 16。
11.  如果 S 包含任何不是 radix-R 数字的字符，则令 Z 是 S 的子串，由第一个此类字符之前的所有字符组成；否则，令 Z 为 S。
12.  如果 Z 为空，则返回 NaN。
13.  令 mathInt 为由 Z 以 radix-R 表示法表示的数学整数值，使用字母 AZ 和 az 表示值为 10 到 35 的数字。（但是，如果 R 为 10 且 Z 包含超过 20 个有效数字，则每个有效数字根据实现的选择，第 20 位之后的数字可以替换为 0 数字；如果 R 不是 2、4、8、10、16 或 32，则 mathInt 可能是数学整数的依赖于实现的近似由 Z 以 radix-R 表示法表示的值。）
    1.  令 number 为 mathInt 的 Number 值。
    2.  返回符号数字。注意 parseInt 只能将字符串的前导部分解释为整数值；它忽略任何不能被解释为整数表示法的一部分的字符，并且没有给出任何此类字符被忽略的指示。

**当调用 parseFloat 函数时，会执行以下步骤：**

1.  让 inputString 为 ToString(string)。
2.  令 trimmedString 是 inputString 的一个子字符串，它由不是 StrWhiteSpaceChar 的最左侧字符和该字符右侧的所有字符组成。（换句话说，删除前导空格。）如果 inputString 不包含任何此类字符，则让 trimmedString 为空字符串。
3.  如果 trimmedString 和 trimmedString 的任何前缀都不满足 StrDecimalLiteral 的语法（见 9.3.1），则返回 NaN。
4.  令 numberString 为 trimmedString 的最长前缀，它可能是 trimmedString 本身，满足 StrDecimalLiteral 的语法。
5.  返回 numberString 的 MV 的 Number 值。

注意 parseFloat 可能仅将字符串的前导部分解释为数字值；它忽略任何不能被解释为十进制文字符号的一部分的字符，并且没有给出任何此类字符被忽略的指示。

**如果参数强制为 NaN，则返回 true，否则返回 false。**

1.  如果 ToNumber(number) 为 NaN，则返回 true。
2.  否则，返回假。注意 ECMAScript 代码测试值 X 是否为 NaN 的一种可靠方法是 X !== X 形式的表达式。当且仅当 X 为 NaN 时结果才为真。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:43:28.993

这些功能是特定于浏览器的实现，而不是用 JS 编写的（除非有人决定用 JS 编写浏览器引擎）。不保证代码在不同环境中是相同的，尽管它们必须（理论上）遵守 ECMAScript 规范的行为。

# python - 我在python的Flask教程的开头，我不明白这一段

> ID：15534196
> 
> 赞同：3
> 
> 时间：2013-03-20T20:37:29.467
> 
> 标签：python, flask

> 通常，从可配置文件加载配置是个好主意。这是`from_envvar()`可以做的，替换`from_object()`上面的行：
> 
> `app.config.from_envvar('FLASKR_SETTINGS', silent=True)`
> 
> 这样，有人可以设置一个环境变量`FLASKR_SETTINGS`来指定要加载的配置文件，然后该配置文件将覆盖默认值。如果没有设置这样的环境键，静默开关只是告诉 Flask 不要抱怨。

我对环境变量不太熟悉。我想简单地解释一下上面的段落。我最好的猜测是，当程序读取时`FLASKR_SETTING`，这是否意味着在我自己的计算机上，我已经使用称为环境变量的名称设置了到该文件的映射？我之前弄乱了我的环境路径，老实说我还是不明白，所以我来这里寻找一个明确的答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:56:02.787

环境变量是为计算机（Windows 或 UNIX/LINUX 等）上运行的特定进程定义的名称、值对。它们不是文件。您可以创建自己的环境变量并为其指定任何名称/值。例如，FLASKR_SETTING 是环境变量的名称，其值可以设置为配置文件。例如，在 UNIX 终端上，您可以执行以下操作：

```
export FLASKR_SETTING = /somepath/config.txt 
```

通过执行上述操作，您刚刚创建了一个名为 FLASKR_SETTING 的环境变量，其值设置为 /somepath/config.txt。您使用环境变量的原因是因为您可以将它们绑定到某个进程并在您的进程启动时按需使用。您不必担心将它们保存在文件中。事实上，您可以为您的进程/应用程序创建一个启动脚本，该脚本可以在您开始使用应用程序之前设置各种环境变量。

在烧瓶的情况下， app.config.from_envvar('FLASKR_SETTINGS', silent=True) 将 FLASKR_SETTINGS 的值设置为来自 env 的值。多变的。所以它基本上翻译为：

```
- Find the config file (/somepath/config.txt etc.)
- lets say the contents of config file is:
    SECRET_KEY="whatever"
    DEBUG = True
- Then using the 2 above, it will be translated to:
    app.config['SECRET_KEY'] = "whatever"
    app.config['DEBUG'] = True 
```

因此，您可以根据需要更新配置文件，而无需更改代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:42:16.110

环境变量是一种将信息传递给程序的简单、临时的方式。在 unixy 机器上，从命令外壳，它就像

```
export FLASKR_SETTINGS=/path/to/settings.conf
/path/to/program 
```

这在安装程序以在重新启动时启动时特别有用；配置可以很容易地包含在启动系统程序的同一设置脚本中。

# jquery - Differences between pageinit and pageshow

> ID：15534198
> 
> 赞同：1
> 
> 时间：2013-03-20T20:37:39.517
> 
> 标签：jquery, events, web-applications, mobile

I created a simple webapp using jQuery Mobile 1.2\. This app consists of a main page index.html and a second page named settings.html. The main page contains a button in the header section to open the settings page:

```
<div data-role="header">
    <h1>Main</h1>
    <a href="settings.html">Settings</a>
</div><!-- /header --> 
```

In the settings dialog the user should be able to change program options. For this purpose I implemented a function to set the current options every time the dialog opens:

```
$(document).on("pageinit", "#page-settings", function() {
    // numeric text field to change the year of date (settings is an array)
    $("#text-year").val(settings.year);
    ...
}); 
```

That works correct so far.

Now I read that there are some more events like "pagebeforeshow" and "pageshow". But I don't understand the difference between these events. I tested the triggers as follows:

```
$(document).on("pageinit", "#page-settings", function() {
    alert("pageinit");
});
$(document).on("pagebeforeshow", "#page-settings", function() {
    alert("pagebeforeshow");
});
$(document).on("pageshow", "#page-settings", function() {
    alert("pageshow");
}); 
```

If I click the button on the main page then all three events will fire and all alerts will display. So why there are different events? And which one should I use in my settings scenario?

I thought that the process is the following: I go to my index page the first time, all elements on that page are added to the DOM and then the events pageinit and pageshow for index are fired. Then I click the link and change to the settings page, all elements of the settings page are added to the DOM and the events pageinit and pageshow for settings are fired. So far okay. Then I go back to the index page. Beacuse the index elements are still in DOM, only the pageshow event is firing. Then I click the settings link again. The settings elements should also be in DOM, so only pageshow should firing again. But the problem is that all events are fired everytime I change a page. So the question is: Why are there different events? And where should I place the filling of text boxes or the triggers of button clicks?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:48:56.103

*   当 DOM 准备好时触发“pageinit”。当您想在下载页面时初始化变量时，此选项非常有用。

*   “pagebeforeshow”在您的页面显示之前触发。
    当您需要在显示之前执行操作时，您可以使用此事件，
    例如添加 div 或 HTML 结构。

*   “pageshow”在页面显示时触发。我使用这个事件来添加我的点击事件和其他事件。

您可以在文档中找到有关事件的更多信息：http: [//api.jquerymobile.com/category/events/](http://api.jquerymobile.com/category/events/)

# iphone - 探索设备中的 sqlite db 文件的好软件？

> ID：15534202
> 
> 赞同：1
> 
> 时间：2013-03-20T20:37:57.600
> 
> 标签：iphone, ios, objective-c, sqlite

有没有一个很好的软件可以探索设备中安装的 iphone 应用程序的应用程序包？我特别想从应用程序包中提取 sqlite 文件？

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:58:11.577

Phoneview对此很有用...

[http://www.ecamm.com/mac/phoneview/](http://www.ecamm.com/mac/phoneview/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T23:52:01.890

我为 firefox 使用 sqlite-manager 插件。Whcih 对于搜索和添加/删除/更新操作非常灵活。

[https://code.google.com/p/sqlite-manager/](https://code.google.com/p/sqlite-manager/)

# linux - Get an idea of the ages of linux machines

> ID：15534204
> 
> 赞同：2
> 
> 时间：2013-03-20T20:37:58.847
> 
> 标签：linux, system

I have a number of servers that has been running for a long period of time (on the time scale of years) but I want to know exactly how old they are from the command line because I cannot physically access them. Basically, I have sudo accounts but I cannot physically go to the machine room to read the manufacture labels. How do I get an idea of that from the command line? A rough idea would be enough. Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:49:58.587

我发现了两件事可以帮助你：

链接是法语：s（你可以使用谷歌翻译来翻译它们）
[http://dev.petitchevalroux.net/linux/connaitre-nom-carte-mere-linux.72.html](http://dev.petitchevalroux.net/linux/connaitre-nom-carte-mere-linux.72.html)
[http://dev.petitchevalroux.net /linux/lshw-recuperer-les-informations-hardware-machine-l.244.html](http://dev.petitchevalroux.net/linux/lshw-recuperer-les-informations-hardware-machine-l.244.html)

[http://linux.die.net/man/1/lshw](http://linux.die.net/man/1/lshw)

在这两种情况下，您可以通过查看固件版本（某些版本显示发布日期）来了解一下，如果您没有看到日期，您可以尝试在网络上找到它的发布日期

`dmidecode`显示bios版本等

# php - 使用PHP创建Json添加数组

> ID：15534207
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:38:02.620
> 
> 标签：php, json

我以以下 php 脚本为例

```
 $stockline = array("details" => "This will hole all data for entire page" ) ;

    $date = "2013-20-20" ;  
    $named_array = array( "date" => $date  ) ;
        $named_array["vehicles"][] = array("vehicle" => "i100-1" , "driver" => "jack" , "events" => "boat race"  ) ;
        $named_array["vehicles"][] = array("vehicle" => "i100-2" , "driver" => "paul" , "events" => "boat race"  );
        $named_array["vehicles"][] = array("vehicle" => "i60-2" , "driver" => "andrew" , "events" => "popping"  );  

    $stockline['day'] = array( $named_array ) ;

    // I cant add this next data as an array to 'day' 
    $date = "2013-20-21" ;  
    $named_array = array( "date" => $date  ) ;
        $named_array["vehicles"][] = array("vehicle" => "i100-1" , "driver" => "jack" , "events" => "Tuesday"  ) ;
        $named_array["vehicles"][] = array("vehicle" => "i100-2" , "driver" => "paul" , "events" => "Tuesday"  ) ;
        $named_array["vehicles"][] = array("vehicle" => "i60-2" , "driver" => "andrew" , "events" => "Tuesday"  ) ;

    $rs =  json_encode($stockline);

    echo $rs ; 
```

当我使用控制台日志时，我得到了这个，这正是我想要的

```
 Object {details: "This will hole all data for entire page", day: Array[1]}
    day: Array[1]
    0: Object
    length: 1 
```

如何将我的第二组数组添加到 'day' ？所以我最终得到

```
 Object {details: "This will hole all data for entire page", day: Array[2]}
   day: Array[2]
   0: Object
   1: Object
   length: 2 
```

我在这里有点超出我的深度，所以任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:05:54.883

```
<?php
$stockline = array("details" => "This will hole all data for entire page" ) ;
$stockline['day'] = array();

$date = "2013-20-20" ;  
$named_array = array( "date" => $date  ) ;
$named_array["vehicles"][] = array("vehicle" => "i100-1" , "driver" => "jack" , "events" => "boat race"  ) ;
$named_array["vehicles"][] = array("vehicle" => "i100-2" , "driver" => "paul" , "events" => "boat race"  );
$named_array["vehicles"][] = array("vehicle" => "i60-2" , "driver" => "andrew" , "events" => "popping"  );  

$stockline['day'][] = $named_array;

//second array 
$date = "2013-20-21" ;  
$named_array = array( "date" => $date  ) ;
$named_array["vehicles"][] = array("vehicle" => "i100-1" , "driver" => "jack" , "events" => "Tuesday"  ) ;
$named_array["vehicles"][] = array("vehicle" => "i100-2" , "driver" => "paul" , "events" => "Tuesday"  ) ;
$named_array["vehicles"][] = array("vehicle" => "i60-2" , "driver" => "andrew" , "events" => "Tuesday"  ) ;

$stockline['day'][] = $named_array;

$rs =  json_encode($stockline);

echo $rs;
?> 
```

# android - Add button to a specific fragment in ViewPager

> ID：15534208
> 
> 赞同：0
> 
> 时间：2013-03-20T20:38:03.683
> 
> 标签：android, android-fragments, android-viewpager, android-pageradapter

I found the ViewPager in the android SDK and was messing around with it. Basically my final task is to create a youtube, facebook, and twitter feed all in one app, using the ViewPager and Fragments to scroll between the 3 categories. I'm having a bit of a hard time understanding house these work, more specifically, how to I add an element (Button) to a specific Fragment? Here's my code so far:

```
package com.ito.mindtrekkers;

import java.util.ArrayList;

import twitter4j.Query;
import twitter4j.QueryResult;
import twitter4j.Twitter;
import twitter4j.TwitterException;
import twitter4j.TwitterFactory;
import android.annotation.SuppressLint;
import android.os.AsyncTask;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import android.util.Log;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.view.Window;
import android.view.WindowManager;
import android.widget.TextView;
import android.widget.Toast;

@SuppressLint("ShowToast")

//Brady Mahar

public class Main extends FragmentActivity {

    /**
     * The {@link android.support.v4.view.PagerAdapter} that will provide
     * fragments for each of the sections. We use a
     * {@link android.support.v4.app.FragmentPagerAdapter} derivative, which
     * will keep every loaded fragment in memory. If this becomes too memory
     * intensive, it may be best to switch to a
     * {@link android.support.v4.app.FragmentStatePagerAdapter}.
     */
    SectionsPagerAdapter mSectionsPagerAdapter;

    /**
     * The {@link ViewPager} that will host the section contents.
     */
    ViewPager mViewPager;

    ArrayList<String> tweetList = new ArrayList<String>();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.main);

        // Create the adapter that will return a fragment for each of the three
        // primary sections of the app.
        mSectionsPagerAdapter = new SectionsPagerAdapter(
                getSupportFragmentManager());

        // Set up the ViewPager with the sections adapter.
        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mSectionsPagerAdapter);
        mViewPager.setCurrentItem(1); //sets initial page to "Facebook"
        new DownloadFilesTask().execute("weather" , null, null);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    /**
     * A {@link FragmentPagerAdapter} that returns a fragment corresponding to
     * one of the sections/tabs/pages.
     */
    public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            // getItem is called to instantiate the fragment for the given page.
            // Return a DummySectionFragment (defined as a static inner class
            // below) with the page number as its lone argument.
            Fragment fragment = new DummySectionFragment();
            Bundle args = new Bundle();
            args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, position + 1);
            fragment.setArguments(args);
            return fragment;
        }

        @Override
        public int getCount() {
            // Show 3 total pages.
            return 3;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            switch (position) {
            case 0:
                return getString(R.string.title_youtube);
            case 1:
                return getString(R.string.title_facebook);
            case 2:
                return getString(R.string.title_twitter);
            }
            return null;
        }
    }

    /**
     * A dummy fragment representing a section of the app, but that simply
     * displays dummy text.
     */
    public static class DummySectionFragment extends Fragment {
        /**
         * The fragment argument representing the section number for this
         * fragment.
         */
        public static final String ARG_SECTION_NUMBER = "section_number";

        public DummySectionFragment() {
        }

        @SuppressLint("ShowToast")
        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            // Create a new TextView and set its text to the fragment's section
            // number argument value.
            TextView textView = new TextView(getActivity());
            textView.setGravity(Gravity.CENTER);
            textView.setText(Integer.toString(getArguments().getInt(ARG_SECTION_NUMBER)));

            return textView;
        }
    }

    /**
     * Class for handling NetworkOnMainThread
     * Sends the command Asynchronously 
     * @author austinn
     *
     */
    private class DownloadFilesTask extends AsyncTask<String, Void, String> {
        protected String doInBackground(String... command) {

            Twitter twitter = new TwitterFactory().getInstance();
            Query query = new Query("from:MindTrekkers");
            query.setRpp(100);
            try {
                QueryResult result = twitter.search(query);
                for(twitter4j.Tweet tweet : result.getTweets()) {
                    //Toast.makeText(getApplicationContext(), tweet.getText(), Toast.LENGTH_SHORT);
                    Log.v("Tweet", tweet.getText());
                    tweetList.add(tweet.getText());
                }
            } catch (TwitterException e) {
                //Toast.makeText(getApplicationContext(), e + "", Toast.LENGTH_SHORT);
                Log.v("Error", e+"");
            }

            return null;
        }

        protected void onProgressUpdate(Void... progress) {}
        protected void onPostExecute(String result) {}
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-23T14:32:21.727

使用 Singleton 实例 getter 在单独的 Fragment 类中实现您的 3 个 Fragment 类别（youtube、facebook 和 twitter）。这是一个 Facebook Fragment 示例（注意 onCreateView() 膨胀了 fragment_facebook 布局）：

```
public class FaceBookFragment extends Fragment {
    private static FaceBookFragment instance = null;
    public static FaceBookFragment newInstance() {
        if(instance == null) {
            instance = new FaceBookFragment();
            Bundle args = new Bundle();
            instance.setArguments(args);
            return instance;
        }
        return instance;
    }

    public FaceBookFragment() {

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.fragment_facebook, container,
                false);
        ...
        return rootView;
    }
} 
```

然后在您的 FragmentPagerAdapter（位于上面代码的 MainActivity 中）中，让 getItem() 返回 Fragment 实例：

```
public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        Fragment frag = null;
        switch (position) {
        case 0:
            frag = FaceBookFragment.newInstance();
            break;
        case 1:
            frag = TwitterFragment.newInstance();
            break;
        case 2:
            frag = YouTubeFragment.newInstance();
            break;
        }
        return frag;
    }
} 
```

**奖励：**另外，我知道您的代码是实验性的，但您的推文列表将无法从您的任何片段访问。

Fragment 是一个新的类对象，不能直接访问 MainActivity 中的任何内容，除非您在构造（限制）期间传递对对象（推文列表）的引用，或者如果 Fragment 代码获得对象/变量的“最终”在 MainActivity 下（从 Fragment 的角度来看，列表永远不会改变）。*也许我没有像其他人那样清楚地表达这个声明，但是推特列表将无法从您的片段中访问。*

有几个解决方案：

1.  将 tweetlist 移动到 Twitter Fragment 并让它调用下载器。然后您的 TwitterFragment 可以构建并保存列表并根据需要更新 UI。但是，请考虑片段生命周期（[http://developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html))，请参阅生命周期部分和图表) onDestroyView() 方法将在您滑动/翻转几个片段并再次返回时被调用。例如，Android 不会保持无限数量的 Fragment 处于活动状态，并且会根据需要销毁/重新创建视图。不要尝试从 AsyncTask 更新 Fragment 的 UI/布局对象。Fragment 可能会在您的任务完成之前调用 onDestoryView() 。（然后你可能会得到 NullPointerExceptions）而是让你的 AsyncTask 只更新片段范围变量（tweetlist）并让你的 onCreateView() 使用相同的变量。（也许也同步变量）

2.  将主要变量/对象/AsyncTask 调用代码全部保存在 MainActivity 中，并添加从 Fragment 访问它们的方法，并让 Fragment getActivity() 将其转换为 MainActivity 并在需要时调用该方法：

    ```
    public class MainActivity extends ActionBarActivity implements ActionBar.TabListener {
            ArrayList<String> tweetList = new ArrayList<String>();
            ...
            public ArrayList<String> getTweetlist() {
                    return tweetlist;
            }
            ...
    }

    public class TwitterFragment extends Fragment {
            ...
            @Override
            public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
                    View rootView = inflater.inflate(R.layout.fragment_twitter, container, false);
                    ...
                    ArrayList<String> tweetList = ((MainActivity)getActivity()).getTweetlist();
                    ...
                    return rootView;
            }
            ...
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T03:05:54.423

让我尝试解释一下，首先使用这个FragmentPagerAdapter：

```
public class TestFragmentAdapter extends FragmentPagerAdapter implements IconPagerAdapter {
    protected static final String[] CONTENT = new String[] { "CATEGORIAS", "PRINCIPAL", "AS MELHORES", };
    protected static final int[] ICONS = new int[] {
            R.drawable.perm_group_calendar,
            R.drawable.perm_group_camera,
            R.drawable.perm_group_device_alarms,
    };

    private int mCount = CONTENT.length;

    public TestFragmentAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {Fragment f = null;
    switch(position){
    case 0:
    {
    f = new ArrayListFragment();//YourFragment
    // set arguments here, if required
    Bundle args = new Bundle();
    f.setArguments(args);
    break;
    }
    case 1:
    {
        f = new HomeFragment();//YourFragment
        // set arguments here, if required
        Bundle args = new Bundle();
        f.setArguments(args);
        break;
    }
    case 2:
    {   
        f = new EndlessCustomView();//YourFragment
        // set arguments here, if required
        Bundle args = new Bundle();
        f.setArguments(args);
        break;
    }   
    default:
      throw new IllegalArgumentException("not this many fragments: " + position);
    }

    return f;
    }

    @Override
    public int getCount() {
        return mCount;
    }

    @Override
    public CharSequence getPageTitle(int position) {
      return TestFragmentAdapter.CONTENT[position % CONTENT.length];
    }

    @Override
    public int getIconResId(int index) {
      return ICONS[index % ICONS.length];
    }

    public void setCount(int count) {
        if (count > 0 && count <= 10) {
            mCount = count;
            notifyDataSetChanged();
        }
    }
} 
```

可以看到，ArrayListFragment、HomeFragment 和 EndlessCustomView 是一个扩展 Fragment 的类，所以对于 onCreate() 里面的每一个类，你可以 setContentView(R.layout.your_layout);

然后你可以在这个布局中添加一个按钮或任何你想要的东西。

# php - Autoloaders in PHP - two running at a time

> ID：15534211
> 
> 赞同：2
> 
> 时间：2013-03-20T20:38:10.953
> 
> 标签：php, wordpress, autoload, spl, autoloader

I understand how to register autoloaders and even how to create one, that's no issue at all. How ever the main issue is - how do you have two auto loaders running side by side for something like:

```
class project_one_folder_class extends project_two_folder_class{} 
```

You'll notice that the child class belongs to a project which is reaching out and calling the parent class which is locate in a different project.

The way the projects are linked project two's classes are always seen by the auto loader, how ever project one's classes are never seen.

So the way I thought around this was to write two auto loaders and register them because php will look in on then the other. How ever php seems to be looking in only one and not the other.

how would you solve this?

**Edit**

Project two is parent, Project one is child. This is more expanded question then [What was posted on this question](https://stackoverflow.com/questions/15532069/wordpress-child-themes-and-php-autoload).

To better expand this is my class.

```
class AisisCore_Loader_AutoLoader{

    protected static $_instance;

    public function get_instance(){
        if(null == self::$_instance){
            self::$_instance = new self();
        }

        return self::$_instance;
    }

    public function reset_instance(){
        self::$_instance = null;
    }

    public function register_auto_loader(){
        spl_autoload_register(array($this, 'load_class'));
        spl_autoload_register(array($this, 'load_child_class'));
    }

    public function load_class($class){
        $path = str_replace('_', '/', $class);
        if(file_exists(get_template_directory() . '/' . $path . '.php')){
            require_once(get_template_directory() . '/' . $path . '.php');
        }
    }

    public function load_child_class($class){
        $path = str_replace('_', '/', $class);
        if(file_exists(get_stylesheet_directory() . '/' . $path . '.php')){
            require_once(get_stylesheet_directory() . '/' . $path . '.php');
        }
    }   
} 
```

Currently this class will load anything in the parent project. It will even load parent project objects in the child project. How ever no child object can be loaded using this class as it is not found.

Those familiar with WordPress will instantly say, yes its because you have `get_template_directory` when you want `get_stylesheet_directory` How ever - Knowing this - I want to write then two auto loaders, one that will load child projects objects using `get_stylesheet_directory` and then one that will load parent objects via `get_stylesheet_directory` so that:

`class project_one_folder_class extends project_two_folder_class{}`

works and loads, with out error.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:02:21.977

好吧，当然你可以在第一个 file_exists 返回 false 时查找第二个路径 - 在同一个自动加载器中。

您还可以为第二条路径注册第二个自动加载器。

[PHP 文档](http://php.net/manual/function.spl-autoload-register.php)解决了这个问题：

> 如果必须有多个自动加载功能，`spl_autoload_register()`请允许这样做。它有效地创建了一个自动加载函数队列，并按照定义的顺序遍历它们中的每一个。相比之下，`__autoload()`只能定义一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:22:00.697

分离自动加载过程！

PHP 是这样工作的：在某些时候，代码执行偶然发现了一个尚未加载的类引用。`$obj = new project_one_folder_class()`

现在调用注册的自动加载器函数，从第一个添加的函数开始（除非后面添加的函数使用“prepend”参数）。

第一个（以及所有后续）自动加载函数获取应该加载的类的名称。该功能现在有任务来决定

1.  加载这个类是任务吗？如果没有，什么也不做，让其他函数尝试加载它。
2.  如果这个函数负责加载类，试着用已知的类名组成一个路径和文件名，并要求这个文件。

第 1 步通常通过查看要加载的类名是否以某个前缀开头来解决。在您的情况下，负责加载以“project_one_”开头的类的自动加载器不应尝试加载以其他内容开头的任何其他类。

如果自动加载器知道它必须执行自动加载，则执行第 2 步。它现在将类名转换为相对路径和文件名，添加基目录，然后需要文件。

需要一个定义扩展另一个类（或实现接口）的类的文件，然后可以触发另一个运行任何仍然未知的类的自动加载。在您的情况下，使用类名“project_two_folder_class”再次启动自动加载过程。请注意，“project_one_”类的第一个自动加载器将使用第二个类名再次调用，但它不能做任何事情，因为它不知道如何加载这些类。这取决于知道“project_two_”类的自动加载器。

对于不同的自动装载机，注册顺序应该无关紧要。如果是这样，则自动装载机行为不端。

因为将类名中的任何下划线字符简单地转换为 DIRECTORY_SEPARATOR 以及命名空间中的反斜杠是一种常见模式，所以在末尾添加“.php”，然后尝试从定义的基目录加载此文件，代码因为其中两个自动加载器是相同的，所以问题被简化为只配置一个自动加载函数，这两种情况：应该存在哪个前缀，以及文件应该在哪个基目录中，前提是类名可以转换为文件的相对路径。

在每种情况下检查文件是否存在于某个目录中对于性能来说并不是最佳的。您最终将对文件进行大量检查，只需查看类名即可知道您无法加载这些文件。

顺便说一句：Autoloader 函数不需要是单例的。实际上，您的单例实现已损坏且无用。用 实例化自动加载器`new`，也许将一些配置值传递给构造函数，然后调用`spl_autoload_register()`，你应该完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:25:56.663

这有点粗糙，但您实际上只需要一个自动加载器，它只检查多个目录：

```
abstract class Hakre_Theme_AutoLoader
{
    public static $directories;

    public static function init()
    {
        // configure paths
        self::$directories = array(
            get_template_directory(), // current theme, parent in case of childtheme
            get_stylesheet_directory(), // current theme, child in case of childtheme
        );

        // please double check if you really need to prepend
        return spl_autoload_register('Hakre_Theme_AutoLoader::autoload', true, true);
    }

    public static function autoload($class)
    {
        $filename = str_replace('_', '/', $class) . '.php';

        foreach (self::$directories as $directory) {
            $path = $directory . '/' . $filename;
            if (is_file($path)) {
                require($path);
                return; # leave because the class has been loaded
            }
        }
    }
}

Hakre_Theme_AutoLoader::init();

## If you're unsure all worked out properly:
var_dump(Hakre_Theme_AutoLoader::$directories); 
```

这实际上应该这样做，但是我没有测试过。查看`var_dump`，您可以调试是否注册了正确的目录。不需要多个回调，因为您想签入两个目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-24T13:05:07.550

您可以添加多个加载器，只需使用 spl_autoload_register() 注册每个函数。

程序风格：

```
spl_autoload_register('loader_function1'));
 // your second class location
spl_autoload_register('loader_function2')); 
```

或以OO风格

```
spl_autoload_register(array($this, 'loader_function1'));
spl_autoload_register(array($this, 'loader_function2')); 
```

但是，根据您的问题：您可能可以通过使用更灵活的自动加载器来完成同样的事情，请在此处查看我在另一个问题中的答案： [wordpress 插件中的类自动加载器](https://stackoverflow.com/questions/32288861/class-autoloader-in-wordpress-plugin/45766931#45766931)

# ruby-on-rails - Rails 模型 as_json 覆盖默认值

> ID：15534212
> 
> 赞同：0
> 
> 时间：2013-03-20T20:38:11.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试覆盖 json 的默认模型值，但不是覆盖它，而是创建重复的哈希

我的模型：

```
class HomeScreenButton < ActiveRecord::Base
    belongs_to :product_category    
    validates :product_category_id, :x, :y, :presence => true
  attr_accessible :product_category_id, :x, :y

  def as_json(options={})
    hash = super(options)
    hash.merge({
      :product_category_id => "fdfd"
    })
  end
end 
```

我的控制器：

```
def index
    @home_screen_buttons = HomeScreenButton.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @home_screen_buttons}
    end
end 
```

当我打开 json 时，它会显示 product_category_id 的重复项： `[{"created_at":"2013-03-17T11:14:32Z","id":1,"product_category_id":5,"updated_at":"2013-03-17T11:14:32Z","x":300,"y":200,"product_category_id":"dfdffff"}]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:45:09.977

无需合并哈希

```
def as_json(options={})
  hash = super(options)
  hash[:product_category_id] = "fdfd"
  hash
end 
```

# javascript - 移动图像元素鼠标移出时卡顿

> ID：15534216
> 
> 赞同：0
> 
> 时间：2013-03-20T20:38:38.610
> 
> 标签：javascript, jquery

基本上，当悬停在图像上时，我想稍微移动图像，然后在鼠标移出时，将图像返回到原始位置。我有一个版本的代码可以完成这项任务，但是如果用户将鼠标从图像移动到图像最初所在的区域，则会出现一些“口吃”效果。

```
 -----
          |   |
-----     |img|
|   |     |   |
|img| ==> -----
|   |     xxxxx
-----     xxxxx 
```

在上图中，当鼠标悬停在图像上时，它会向上移动 2 个单位。鼠标移出时，图像返回到原始位置。如下所示，我的代码可以工作，但是当鼠标移动到先前腾出的区域（例如 x）时，代码认为它再次悬停在图像上，然后将图像向上移动 2 个单位。当鼠标悬停在上面由 x 标记的区域时，这会产生一种口吃效果。

我尝试了不同的方法（例如，使用 animate()、添加/删除包装 div、使用 setTimeout() 等），但它们都会产生相同的不良效果。我考虑过不断监控页面上的鼠标位置并记住图像的位置，但这似乎太过分了，尤其是因为可能存在 1 到 n 个图像之间的任何位置。

```
$(document).ready(function() {
    $('.hoverImage').hover(
        function(){
            $(this).offset({'top':$(this).offset().top-2});
        },
        function(){
            $(this).offset({'top':$(this).offset().top+2});
        }
    );
}); 
```

这是一个 jsfiddle 演示问题：http: [//jsfiddle.net/Ut8eK/](http://jsfiddle.net/Ut8eK/)

任何提示将不胜感激。提前致谢！

**更新**

惊人的。我最终使用了两个答案：

```
$(document).ready(function() {
    $('.hoverImage').wrap('<div class="hoverImageWrapper" style="display: inline-block;">');
    $('.hoverImageWrapper').hover(
        function(){
            $('.hoverImage',this).offset({'top':$(this).offset().top-10});
        },
        function(){
            $('.hoverImage',this).offset({'top':$(this).offset().top});
        }
    );
}); 
```

这是上面的 jsfiddle：http: [//jsfiddle.net/rf5mE/](http://jsfiddle.net/rf5mE/)

这非常适合我的需求，因为只需添加`class="hoverImage"`到适当的图像，添加功能就非常容易。

我接受@Matyas 作为答案只是因为他的答案首先出现（大约 4 秒！）。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:48:08.577

您应该将图像放在包装器中，并聆听包装器中的悬停，这不会改变其位置。这样你应该得到一个恒定的效果

编辑：问题是鼠标移出时图像移动低于 div 的大小（图像的原始大小）解决方案：向 div 添加 10px 底部填充，如果图像移动 10px 低，仍然有一个 div如果它悬停在它的背景中。（更新链接）

TY Huangism for the notification

[更新示例](http://jsfiddle.net/Ut8eK/6/)：

HTML

```
    <br />
    <div>< img src="http://placekitten.com/120/100" class="hoverImage" /></div>
    <div>< img src="http://placekitten.com/100/100" class="hoverImage" /></div>
    <div>< img src="http://placekitten.com/110/100" class="hoverImage" /></div>

```

JS

```
$(document).ready(function() {
$('div').hover(
    function(){
        //search for the image inside the wrapper (reffered to by this)
        $('.hoverImage', this).offset({'top':$(this).offset().top-10});
    },
    function(){
        $('.hoverImage', this).offset({'top':$(this).offset().top+10});
    }
);
}); 
```

CSS：

```
div{
    display: inline-block;
}
div:hover{
   padding-bottom: 10px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:48:12.393

在其上放置一个包装器并以包装器为目标以移动图像

[http://jsfiddle.net/Ut8eK/4/](http://jsfiddle.net/Ut8eK/4/)

HTML

```
<div class="hoverImage"><img src="http://placekitten.com/120/100" /></div> 
```

JS

```
$(document).ready(function() {
    $('.hoverImage').hover(
        function(){
            var $img = $(this).find('img');
            $img.offset({'top':$img.offset().top-10});
        },
        function(){
            var $img = $(this).find('img');
            $img.offset({'top':$img.offset().top+10});
        }
    );
}); 
```

对于多个 div，您确实需要 inline-block css

# c# - 如何在 Linux 中从 Mono/C# 访问游戏杆/游戏手柄？

> ID：15534217
> 
> 赞同：0
> 
> 时间：2013-03-20T20:38:39.033
> 
> 标签：c#, linux, mono, joystick, gamepad

我正在运行 Debian 的 Raspberry Pi 上使用 C# 开发一个机器人项目。我得到了一个与操作系统配对的 PS3 DualShock 控制器，因此它显示为操纵杆设备 /dev/input/js0。

现在我想从 C# 代码访问 DualShock 操纵杆和按钮。这似乎比我预期的更难（或至少更模糊）——我发现了对 OpenTK 的引用，它似乎至少处于昏迷状态，如果没有死的话；和 XNA，它可能会这样做，但包含的内容超出了我的需要（而且我担心让所有这些都在我的 RPi 上工作），以及其他各种不太受支持的小型包装器项目。

作为一个同时使用 Mono、C# 和 Linux 的新手，我有点不知所措……关于在这种环境中读取 DualShock 状态的最简单/最佳方法有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:44:37.060

[Monogame](http://monogame.net/)是 XNA 的开源实现。它是跨平台的，并且确实以 Linux 为目标。您可以查看框架的[输入源代码](https://github.com/mono/MonoGame/tree/develop/MonoGame.Framework/Input)以了解他们是如何做到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-05T10:18:56.860

Mono 游戏手柄事件通常是轮询的。下面是一个非常基本的代码，演示了检查按钮“A”的状态。

```
GamePadState gamePadState;

gamePadState = GamePad.GetState((PlayerIndex)0); //Palyer indices are from 0-3, basically indicate the gamepad index

if (gamePadState.Buttons.A == ButtonState.Pressed)
{
    //take action for button "A"
} 
```

在访问其按钮/触发器/拇指杆状态值之前检查游戏手柄连接状态始终是一个好主意。

```
if (gamePadState.IsConnected)
{
    //check for button/trigger/thumbstick status
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-18T13:29:48.717

你应该看一下directinput，但那是针对windows的，但是现在有一个将它包装到c#的库。它叫做 slimDX，也许你可以让它工作

# python - Python 匹配字符串，如果它不以 X 开头

> ID：15534223
> 
> 赞同：5
> 
> 时间：2013-03-20T20:38:50.327
> 
> 标签：python, regex, match

我想在我的磁盘上搜索一个名为“AcroTray.exe”的文件。**如果文件位于 "Distillr" 以外的目录中，则**程序应打印警告。我使用以下语法来执行否定匹配

```
(?!Distillr) 
```

问题是虽然我使用“！” 它总是产生 MATCH。我尝试使用 IPython 找出问题，但失败了。这是我尝试过的：

```
import re

filePath = "C:\Distillr\AcroTray.exe"

if re.search(r'(?!Distillr)\\AcroTray\.exe', filePath):
    print "MATCH" 
```

它打印一个 MATCH。我的正则表达式有什么问题？

我想参加比赛：

```
C:\SomeDir\AcroTray.exe 
```

但不在：

```
C:\Distillr\AcroTray.exe 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:41:08.730

使用否定的**lookbehind** ( `(?<!...)`)，而不是否定的lookahead：

```
if re.search(r'(?<!Distillr)\\AcroTray\.exe', filePath): 
```

* * *

这匹配：

```
In [45]: re.search(r'(?<!Distillr)\\AcroTray\.exe', r'C:\SomeDir\AcroTray.exe')
Out[45]: <_sre.SRE_Match at 0xb57f448> 
```

这不匹配：

```
In [46]: re.search(r'(?<!Distillr)\\AcroTray\.exe', r'C:\Distillr\AcroTray.exe')
# None 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:41:19.050

您正在尝试使用负面的后视：`(?<!Distillr)\\AcroTray\.exe`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:41:37.543

你想要*向后看*，而不是向前看。像这样：

```
(?<!Distillr)\\AcroTray\.exe 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:42:59.133

`(?mx)^((?!Distillr).)*$`

查看您提供的示例，我[在这里使用它们作为示例](http://rubular.com/r/zMfbJnCQuT)

# portaudio - 在 Win7 上将 WASAPI 与 PortAudio 一起使用时出错

> ID：15534228
> 
> 赞同：1
> 
> 时间：2013-03-20T20:39:00.707
> 
> 标签：portaudio, libsndfile, wasapi

我正在尝试使用 PortAudio 和 libsndfile 在我的 Windows 7 机器上以独占模式播放 .wav 文件，但我得到了

> 错误号 -9984 “不兼容的主机 API 特定流信息”。

我填写了 PaWasapiStreamInfo 结构如下：

```
struct PaWasapiStreamInfo wasapiInfo ;
wasapiInfo.size = sizeof(PaWasapiStreamInfo);
wasapiInfo.hostApiType = paWASAPI;
wasapiInfo.version = 1;
wasapiInfo.flags = paWinWasapiExclusive;   
wasapiInfo.channelMask = NULL;
wasapiInfo.hostProcessorOutput = NULL;
wasapiInfo.hostProcessorInput = NULL;
wasapiInfo.threadPriority = eThreadPriorityProAudio; 
```

然后分配 hostApiSpecificStreamInfo 参数并通过 Pa_OpenStream 打开流，如下所示：

```
/* stereo or mono */
    out_param.channelCount = sfinfo.channels;
    out_param.sampleFormat = paInt16;
    out_param.suggestedLatency = _GetDeviceInfo(out_param.device)->defaultLowOutputLatency;
    out_param.hostApiSpecificStreamInfo = (&wasapiInfo);

    err = Pa_OpenStream(&stream, NULL, &out_param, sfinfo.samplerate,
            paFramesPerBufferUnspecified, paClipOff,
            output_cb, file); 
```

我错过了一步吗？

谢谢，泰勒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-25T19:17:06.913

您用来以独占模式运行流的技术对我有用。您可能没有在 WASAPI 设备上打开流。根据您的系统配置，您可能还拥有 DirectSound 和 WMME 设备。以下代码将验证 index 引用的设备是否`deviceIndex`为 WASAPI 设备：

```
bool isWasapi = Pa_GetHostApiInfo(Pa_GetDeviceInfo(deviceIndex)->hostApi)->type == paWASAPI; 
```

您还需要在 out_param 结构中指定相同的索引：

```
out_param.device = deviceIndex; 
```

你做了几件我没有做的事情。在您的示例中，您尝试设置线程优先级，但 PortAudio 文档指出以下行：

```
wasapiInfo.threadPriority = eThreadPriorityProAudio; 
```

将无效，因为您没有`paWinWasapiThreadPriority`在`wasapiInfo.flags`. 根据相同的规则，没有必要将其他变量显式设置为 null。要修复此集`wasapiInfo.flags`，如下所示：

```
wasapiInfo.flags = (paWinWasapiExclusive|paWinWasapiThreadPriority) 
```

这应该启用独占模式并导致`threadPriority`变量生效。

# ruby-on-rails-3 - IntelliJ 12 不会引入 Sass 变量

> ID：15534229
> 
> 赞同：0
> 
> 时间：2013-03-20T20:39:04.047
> 
> 标签：ruby-on-rails-3, intellij-idea, sass, bootstrap-sass

我有一个非常基本的 Ruby on Rails 安装。我已经安装了`bootstrap-sass`gem，`'bootstrap-sass' ~> 2.3.1.0`在我的 Gemfile 中运行了`bundle install`. 重新启动所有应用程序。我`style.css.scss`在 app > assets > stylesheets 中有一个文件，它`@imports 'bootstrap';`还有响应式。这些样式实际上被拉入我的应用程序，因为它们为前端设置样式。但是，当我尝试使用变量或 mixin 时，我在附加的图像中收到错误，并且 IntelliJ 告诉我它找不到变量。我在整个过程中都是新手，所以我只是想了解解决它需要什么。

我正在使用 Ruby 2.0.0 和 Rails 3.2.13rc2

[https://docs.google.com/file/d/0BwMz3RH42HtQb0U1TXdHTVF0QjQ/edit?usp=sharing](https://docs.google.com/file/d/0BwMz3RH42HtQb0U1TXdHTVF0QjQ/edit?usp=sharing)

```
@import "bootstrap";

body {
  padding-top: 60px;
}

@import 'bootstrap-responsive';

.footer {
  margin-top: 50px;
  color: $greyLight;

    a {
      color: #e5e5e5;
    }
} 
```

这是heruko上实时开发站点的链接，不使用变量：

[http://shrouded-ocean-4277.herokuapp.com/](http://shrouded-ocean-4277.herokuapp.com/)

编辑：在我的 vendor/assets/stylesheets 文件夹中，没有引导文件夹或 _mixins 或 _variables 文件。当我将 gem 放入 Gemfile 并进行捆绑安装时，是否应该安装这些？

编辑：添加我的 github：[https ://github.com/ChrisSki/omrails](https://github.com/ChrisSki/omrails)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:03:54.523

关于您的编辑，`bootstrap`不会在.gem 文件中`vendor`，而是在 .gem 文件中，该文件位于 Ruby 安装中的某个位置。

[我最近按照本指南](http://railsapps.github.com/twitter-bootstrap-rails.html)设置了一个类似的应用程序。我有 2 个`.css.scss`文件，一个[包含并覆盖部分 bootstrap](https://bitbucket.org/bjansen/feedzee/src/656a8ce08d11/app/assets/stylesheets/bootstrap_and_overrides.css.scss?at=master)，另一个包含[我的应用程序样式](https://bitbucket.org/bjansen/feedzee/src/656a8ce08d11/app/assets/stylesheets/application.css.scss?at=master)（与 Bootstrap 没有直接关系）。如果您查看第二个文件，您会看到我导入了`bootstrap/variables`，因为我需要访问 Bootstrap 的一些变量，它就像一个魅力。

我不明白的是为什么您的原始屏幕截图抱怨名为 的东西`variables`，我在您的 SCSS 文件中看不到...您是否尝试过`bootstrap/variables`？

**编辑：**

我刚刚克隆了您的存储库，启动了服务器并破解了`style.css.scss`. 我认为你在测试中打错了:)

```
h1 {
    color: $greyLight; /* Does not work!! */
    color: $grayLight; /* Works :) */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:49:01.603

您应该在导入引导程序之前声明您的变量，然后您可以在您的 scss 中使用这些变量。例如，这是我在 Rails 应用程序中使用变量的方式：

```
/************************ CSS Variables ***************************/
$myColor: #0F851C;    

/************************ Import Bootstrap ********************************/
@import 'bootstrap';
body { padding-top: 80px; }
@import 'bootstrap-responsive'; 
```

只需在 scss 顶部定义变量，然后导入 bootstrap。然后在你的 scss 中，你可以像这样使用这些变量：

```
#myDiv {
  color: $myColor;
} 
```

希望这可以帮助！

# c - 使用 MinGW 在 Windows 上构建 RabbitMQ-C

> ID：15534230
> 
> 赞同：0
> 
> 时间：2013-03-20T20:39:08.753
> 
> 标签：c, mingw, rabbitmq

和标题说的差不多。我一直在尝试使用 MinGW 在 Windows 下构建 RabbitMQ，但没有成功。从我看到的询问如何使用它的问题来看，我怀疑我犯了一个愚蠢的错误，但我不知道它是什么。我在 Win7-64 上，我正在提取 repo，在其中创建一个构建目录，然后运行

```
cmake -G "MinGW Makefiles" .. 
```

这似乎有效，然后

```
cmake --build . 
```

这会引发一堆函数重新声明错误。有人知道我在这里搞砸了什么吗？

只是为了更好地衡量，错误的一小部分样本：

```
Linking C shared library librabbitmq.1.dll
CMakeFiles\rabbitmq.dir/objects.a(amqp_api.c.obj):amqp_api.c:(.rdata+0x3c): mult
iple definition of `amqp_empty_array'
CMakeFiles\rabbitmq.dir/objects.a(amqp_framing.c.obj):amqp_framing.c:(.bss+0x0):
 first defined here
CMakeFiles\rabbitmq.dir/objects.a(amqp_api.c.obj):amqp_api.c:(.rdata+0x44): mult
iple definition of `amqp_empty_table'
CMakeFiles\rabbitmq.dir/objects.a(amqp_framing.c.obj):amqp_framing.c:(.bss+0x8):
 first defined here
CMakeFiles\rabbitmq.dir/objects.a(amqp_api.c.obj):amqp_api.c:(.rdata+0x4c): mult
iple definition of `amqp_empty_bytes'
CMakeFiles\rabbitmq.dir/objects.a(amqp_framing.c.obj):amqp_framing.c:(.bss+0x10)
: first defined here
CMakeFiles\rabbitmq.dir/objects.a(amqp_connection.c.obj):amqp_connection.c:(.bss
+0x0): multiple definition of `amqp_empty_array'
CMakeFiles\rabbitmq.dir/objects.a(amqp_framing.c.obj):amqp_framing.c:(.bss+0x0):
 first defined here
CMakeFiles\rabbitmq.dir/objects.a(amqp_connection.c.obj):amqp_connection.c:(.bss
+0x8): multiple definition of `amqp_empty_table'
CMakeFiles\rlibrabbitmq\CMakeFiles\rabbitmq.dir\build.make:271: recipe for targe
t 'librabbitmq/librabbitmq.1.dll' failed 
```

**编辑：** 一段时间后，我确定问题在于预处理器指令的编写方式存在一些错误。我现在不打算关闭它，如果我有时间修复整个事情，我会回到这里并留下一个解决方案的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T12:12:33.273

我一直在分析 amqp.h 文件中定义的宏，并在构建非静态库时将 extern 修饰符添加到 AMQP_PUBLIC_VARIABLE 宏中。

```
 78 #elif defined(_WIN32) && defined(__MINGW32__)
 79 # if defined(AMQP_BUILD) && !defined(AMQP_STATIC)
 80 #  define AMQP_PUBLIC_FUNCTION __declspec(dllexport)
 81 #  define AMQP_PUBLIC_VARIABLE __declspec(dllexport) extern 
```

另一件事是，我必须在 MinGW 环境中修改文件“/MinGW/include/windef.h”上的 WINVER 宏以适应新的 Windows 版本。

```
11 #ifndef WINVER
12 #define WINVER 0x0501 
```

之后，我使用`cmake -G "MinGW Makefiles"`.. &&`cmake --build .`命令构建了 librabbitmq.1.dll 库而没有问题

# c++ - 使用成员函数指针调用正确的虚方法

> ID：15534241
> 
> 赞同：2
> 
> 时间：2013-03-20T20:39:44.983
> 
> 标签：c++, function, virtual

在下面的示例中，我试图将问题减少到最小，有 4 个类**A、B、C、D。**, 形成继承层次结构

程序启动时，会创建一个来自**D**类的对象 d，并调用**D类的****测试**方法。该方法依次调用**C**类的**调用者**方法。此方法尝试使用成员函数指针来调用正确的**f**方法。在这种情况下，它应该调用与类**D相关联的****f**方法，但它调用与类**B**相关联的方法。

 ******怎么来的 ？

```
class A {
    public:
    virtual void f() = 0;
};

class B : public A{
    public:
    virtual void f() { cout << "IN B" << endl;}   
};

class C : public B{
    public:
    virtual void f() { B::f(); cout << "IN C" << endl; }
    virtual void caller(){
        void (A::*cb)() = NULL;
        cb = &A::f;
        (this->*cb)();
    }
};

class D : public C{
    public:
    virtual void f() { C::f(); cout << "IN D" << endl; }
    void test(){
         caller();
    }
};

int main(){
    D d;
    d.test(); // Why does this prints only "IN B" 
    return 0;
} 
```

**更新**：代码确实有效，问题与提供的代码无关，似乎来自提供 A、B、C 类的库与提供 D 类的库之间的版本不匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:45:20.617

你确定它只打印“IN B”吗？我在 MSVC2012 上编译它，我得到了

```
IN B
IN C
IN D 
```

更重要的是，您的原始代码无法在 VS2012 上编译，至少在我将`public`: 添加到每个类之前不会编译。例如：

```
class C : public B{
public:  // <--- here
    virtual void f() { B::f(); cout << "IN C" << endl; }
    virtual void caller(){
        void (A::*cb)() = NULL;
        cb = &A::f;
        (this->*cb)();
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:43:05.733

它打印

```
IN B
IN C
IN D 
```

所以，问题出在其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:54:29.753

有用。添加`public:`声明。还警告有关重载和虚拟化的不同行为。最好的方法是使用指针或引用。

```
class A {
public:
    virtual void f() = 0;
};

class B : public A{
    public:
    virtual void f() { std::cout << "IN B" << std::endl;}   
};

class C : public B{
    public:
    virtual void f() { B::f(); std::cout << "IN C" << std::endl; }
    virtual void caller(){
        void (A::*cb)() = NULL;
        cb = &A::f;
        (this->*cb)();
    }
};

class D : public C{
    public:
    virtual void f() { C::f(); std::cout << "IN D" << std::endl; }
    void test(){
         caller();
    }
}; 
```

输出：

> IN B
> IN C
> IN D******

# javascript - 无法从 javascript 调用 wcf 服务

> ID：15534245
> 
> 赞同：0
> 
> 时间：2013-03-20T20:40:02.957
> 
> 标签：javascript, asp.net, wcf, call

大家好，由于某种原因，我试图从 javascript 函数调用 wcf 服务，asp.net 无法识别名称空间并在运行时给我一个错误，任何帮助将不胜感激，以下是代码：

默认 aspx 页面

```
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server">
        <Services>
            <asp:ServiceReference Path="~/WeatherService.svc"/>
        </Services>
    </asp:ScriptManager>

    Enter a zipcode:
    <input id="zipCodeInput" type="text" />
    <br/>
    <input id="getForecastButton" type="button" value="Get Forecast" onclick="onGetForecast()"/>
    <br/>

 <div id="resultsDiv">

    </div>
</form> 
```

Javasript

```
 <script language="javascript" type="text/javascript">
    function onGetForecast() {
        var zip = document.getElementById("zipCodeInput").value;
        //alert(zip);

        UltimateServices.GetForecast(zip, onGetForecastComplete, onGetForecastError, zip);

    }

    function onGetForecastComplete(result, userData) {
        document.getElementById("resultsDiv").innerHTML = "Weather for " + userData + " is going to be " + result;
    }

    function onGetForecastError(err) {
        alert("There was a error " + err.get_message());
    }
</script> 
```

WeatherService.cs 文件（代码隐藏）

```
 using System;
 using System.Collections.Generic;
 using System.Linq;
 using System.Runtime.Serialization;
 using System.ServiceModel;
 using System.ServiceModel.Activation;
 using System.ServiceModel.Web;
 using System.Text;

 [ServiceContract(Namespace = "UltimateServices")]
 [AspNetCompatibilityRequirements(RequirementsMode =         AspNetCompatibilityRequirementsMode.Allowed)]
 public class WeatherService
 {

private static Random _rand = new Random();

[OperationContract]
public string GetForecast(string zipcode)
{
    string forecast = "";
    switch(_rand.Next(3))
    {
        case 0:
            forecast = "Sunny and Warm";
            break;

        case 1:
            forecast = "Chilly and overcast";
            break;

        case 2:
            forecast = "Hot and humid";
            break;
    }
    return forecast;
}

// Add more operations here and mark them with [OperationContract] 
```

}

web.config 文件

```
 <system.serviceModel>
<behaviors>
  <endpointBehaviors>
    <behavior name="WeatherServiceAspNetAjaxBehavior">
      <enableWebScript />
    </behavior>
  </endpointBehaviors>
</behaviors>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"
  multipleSiteBindingsEnabled="true" />
<services>
  <service name="WeatherService">
    <endpoint address="" behaviorConfiguration="WeatherServiceAspNetAjaxBehavior"
      binding="webHttpBinding" contract="WeatherService" />
  </service>
</services>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-19T05:17:01.367

在这里，我使用 javascript 从 WCF 调用简单的 hello world

服务.cs

```
using System;
using System.Collections.Generic;
using System.Linq;`
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;
using System.ServiceModel.Activation; 
```

// 注意：您可以使用“重构”菜单上的“重命名”命令将代码、svc 和配置文件中的类名“服务”一起更改。

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class Service : IService
{
 [WebGet(ResponseFormat = WebMessageFormat.Json)]
    public string helloworld(string name)
    {
        name = "Hello " + name;
        return  name;
    }
} 
```

网络配置

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0"/>
  </system.web>
  <system.serviceModel>
    <services>
      <service name="Service" behaviorConfiguration="DefaultBehavior">
        <endpoint address="" binding="webHttpBinding" contract="IService" name="RunningBarbus.Services.RunningBarbusService" behaviorConfiguration="AjaxBehavior">
          <identity>
            <dns value="localhost"/>
          </identity>
        </endpoint>
        <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex"/>
      </service>
    </services>
    <bindings>
      <webHttpBinding>
        <binding crossDomainScriptAccessEnabled="true">
          <security mode="None"/>
        </binding>
      </webHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="DefaultBehavior">
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="AjaxBehavior">
          <!--<enableWebScript/>-->
          <webHttp  helpEnabled="true" automaticFormatSelectionEnabled="false" />
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
    <standardEndpoints>
      <webScriptEndpoint>
        <standardEndpoint crossDomainScriptAccessEnabled="true" name="">
        </standardEndpoint>
      </webScriptEndpoint>
    </standardEndpoints>
   </system.serviceModel>
  <system.webServer>
    <httpProtocol>
      <customHeaders>
        <add name="access-control-allow-headers" value="content-type, Accept" />
        <add name="Access-Control-Allow-Origin" value="*" />
        <add name="Access-Control-Allow-Methods" value="POST,GET,OPTIONS" />
        <add name="Access-Control-Max-Age" value="1728000" />
      </customHeaders>
    </httpProtocol>
    <modules runAllManagedModulesForAllRequests="true"/>

  </system.webServer>
</configuration> 
```

javascript代码

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="jsonp.aspx.cs" Inherits="jsonp" %>

<!DOCTYPE html >

<html>
<head runat="server">
    <title></title>
 <script src="js/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var name="";
        var Type;
        var Url = "http://192.168.X.X/WCFjavascript/Service.svc/helloworld?name=world";
        var Data;
        var ContentType;
        var DataType;
        var ProcessData;
        var method;
        //Generic function to call WCF  Service
        function CallService() {
            $.ajax({
                type: Type, //GET or POST or PUT or DELETE verb
                url: Url, // Location of the service
               // data: name, //Data sent to server
                contentType: ContentType, // content type sent to server
                //data: '[{"name":"' + name + '"}]',
                dataType: DataType, //Expected data format from server
                processdata: ProcessData, //True or False
                success: function (msg) {//On Successfull service call
                    ServiceSucceeded(msg);
                },
                error: ServiceFailed// When Service call fails
            });
        }
        function ServiceFailed(xhr) {
            alert(xhr.responseText);
            if (xhr.responseText) {
                var err = xhr.responseText;
                if (err)
                    error(err);
                else
                    error({ Message: "Unknown server error." })
            }
            return;
        }
        function ServiceSucceeded(result) {
            debugger;
            if (DataType == "jsonp") {
                alert(result);
                resultObject = result.helloworld;
                var string = result.name ;
                alert(string);
            }
        }
        function helloworld() {
            debugger;
            var uesrid = "";
            Type = "GET";
            // Url = "http://192.168.X.X/WCFjavascript/Service.svc/helloworld?'"+uesrid+'"';
            Url = Url;

            DataType = "jsonp"; ProcessData = false;
            method = "helloworld";
            CallService();
        }

        $(document).ready(
         function () {

             helloworld();
         }
);

    enter code here
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:44:28.850

您的服务/服务方法似乎缺少 ScriptService/ScriptMethod 属性。

# haskell - 在haskell中解析sql语句

> ID：15534250
> 
> 赞同：-3
> 
> 时间：2013-03-20T20:40:16.740
> 
> 标签：haskell

我是haskell的新手

如何解析sql语句“select a from b where a in (value1,value2,value3,...);” 使用haskell

我指的是[http://hpaste.org/76009](http://hpaste.org/76009)用于解析 sql 语句

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:21:08.460

它使用[parsec](http://hackage.haskell.org/package/parsec)包进行解析。`import Text.Parsec`那么你需要

```
case
    parse p_sql "filename for error messages"
        "select a from b where a in (value1,value2,value3,...);"
  of
    Left parseError  -> -- handle the error
    Right statements -> -- do something with your parsed sql statements 
```

# ruby-on-rails - 防止活动记录属性被表单修改

> ID：15534252
> 
> 赞同：0
> 
> 时间：2013-03-20T20:40:21.983
> 
> 标签：ruby-on-rails, activerecord

在 Ruby on Rails 中，从 HTML 表单更新模型非常容易。通常你可以用模型创建一个form_for，当用户点击提交按钮时，里面的字段就会更新。

假设恶意用户想要在不通过适当渠道的情况下更新他们的“薪水”。难道他们不能在更新他们的电子邮件地址（例如）时只注入一个名为“薪水”的字段，并将他们的工资设置为基本上是他们想要的任何东西吗？我如何指定哪些字段可以修改，哪些不能防止这种情况发生？

看到类似的东西

```
@user.update_attributes(params[:user]) 
```

看起来很吓人。他们可以更新任何东西。我了解 attr_accessible 的使用，但这仅与大规模更新有关，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:42:46.957

您可以使用以下方法限制可以批量分配的字段：

```
attr_accessible :name, :address # no :salary 
```

# c# - 阅读 .html#XXX 并将其显示在网络浏览器上

> ID：15534254
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:40:36.000
> 
> 标签：c#, html

我在本地读取 html 文件，但这些“.html”文件在内部被分割，格式为“file.html#xxxxx”。我在网络浏览器上显示这些文件，但由于“#”，它不接受给出的路径

我正在阅读一本 epub 书，它的章节在内部由“#”划分，解析后我为每一章得到它自己的分区，这个分区由 # 表示。

这是除法的一个例子

```
<navMap>
    <navPoint id="np-1" playOrder="1">
      <navLabel>
        <text>YOUR NATIONAL PARKS BY ENOS A. MILLS</text>
      </navLabel>
      <content src="@public@vhost@g@gutenberg@html@files@42248@42248-h@42248-h-0.htm.html#pgepubid00000"/>
      <navPoint id="np-2" playOrder="2">
        <navLabel>
          <text>PREFACE</text>
        </navLabel>
        <content src="@public@vhost@g@gutenberg@html@files@42248@42248-h@42248-h-0.htm.html#pgepubid00001"/>
      </navPoint>
      <navPoint id="np-3" playOrder="3">
        <navLabel>
          <text>CONTENTS</text>
        </navLabel>
        <content src="@public@vhost@g@gutenberg@html@files@42248@42248-h@42248-h-0.htm.html#pgepubid00002"/>
      </navPoint>
</navMap> 
```

并显示：

```
 navPoint = toc.NavMap[0];
 string srcContent = navP.Src;
    webBrowser1.Source= path+srcContent 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:42:31.770

我想保持答案尽可能干净，所以我完全重写了答案。我相信您需要执行以下步骤：

*   订阅调用的事件`Navigating`和`DocumentCompleted`
*   使用代码解析 url 并将其拆分为`#`
*   覆盖导航并为 WebBrowser 提供没有锚的新的干净 URL
*   例如，将锚点存储在变量中
*   加载文档后，只需找到锚点引用的元素并滚动到它

结果可能看起来像这样。请注意，这不是复制和粘贴代码，我只是想让您了解如何完成您所追求的。您需要根据需要修改此代码！

假设请求的网址是`myFile.html#customAnchor`

```
webBrowser1.Navigating += new WebBrowserNavigatingEventHandler(webBrowser1_Navigating);
webBrowser1.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(webBrowser1_DocumentCompleted);

private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e)
{
    if (e.Url.Contains("#")
    {
       string[] urlParts = e.Url.Split('#'); // split the string by character #
       string newUrl = urlParts[0];          // = myFile.html
       _somePrivateField = urlParts[1];      // = customAnchor

       webBrowser1.Navigate(new Uri(newUrl));
    }
}

private void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    HtmlElementCollection elements = this.webBrowser1.Document.Body.All;
    foreach(HtmlElement element in elements){
       string nameAttribute = element.GetAttribute("Name");
       if(!string.IsNullOrEmpty(nameAttribute) && nameAttribute == _somePrivateField){
          element.ScrollIntoView(true);
          break;
       }
    }
} 
```

实际上还没有尝试过，但我希望这对您解决问题有足够的帮助。

# xml - 将 CDATA 添加到 xml 文件

> ID：15534255
> 
> 赞同：12
> 
> 时间：2013-03-20T20:40:36.720
> 
> 标签：xml, xslt, cdata

我想`CDATA`在一些 xml 标签周围添加一些标签

**XML源是（它只是我文件的一小部分）**

```
<teaserText_fr>
<div xmlns:xlink="http://www.w3.org/1999/xlink xmlns="http://www.coremedia.com/2003/richtext-1.0"><p>2012 ist für viele Länder ein   wichtiges Wahljahr. Die Reihe fühlt der weltweiten Demokratie auf den Zahn. </p>
</div>
</teaserText_fr> 
```

**我想要的是**

```
<teaserText_fr>
<![CDATA[
<div xmlns:xlink="http://www.w3.org/1999/xlink"      xmlns="http://www.coremedia.com/2003/richtext-1.0"><p>2012 ist für viele Länder ein   wichtiges Wahljahr. Die Reihe fühlt der weltweiten Demokratie auf den Zahn. </p>
</div>
]]>
</teaserText_fr> 
```

**我的 xslt 是**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output 
  method="html"
  encoding="UTF-8"
  omit-xml-declaration="yes"
  doctype-public="-//W3C//DTD HTML 4.01//EN"
  doctype-system="http://www.w3.org/TR/html4/strict.dtd"  
  indent="yes" />  

<xsl:template match="node()|@*">
  <xsl:copy>
    <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="teaserText_fr">
  <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
  <xsl:copy-of select="*"/>    
  <xsl:text disable-output-escaping="yes">]]&gt;</xsl:text>
</xsl:template>

</xsl:stylesheet> 
```

**我得到的是**

```
</teaserText_de><![CDATA[<div xmlns="http://www.coremedia.com/2003/richtext-1.0" xmls:xlink="http://www.w3.org/1999/xlink"><p>Ã partir du 10 janvier, ARTE diffuse "I love democracy", une sÃ©rie documentaire qui, en cette grand annÃ©e Ã©lectorale, prend le pouls dÃ©mocratique de la planÃ¨te.</p></div>]]><addTeaserText_de> 
```

我丢失了我的`teaserText_fr`标签，我不明白为什么

如果可能的话，我想为一些额外的标签这样做（使用正则表达式，`[add|]TeaserText_[fr|de]`但我无法让它工作......“

我整天都做了一些测试，但我没有成功。

最好的问候，纪尧姆

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-20T20:51:20.510

您要么需要这样做：

```
<xsl:template match="teaserText_fr">
  <xsl:copy>
    <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
    <xsl:copy-of select="*"/>    
    <xsl:text disable-output-escaping="yes">]]&gt;</xsl:text>
  </xsl:copy>
</xsl:template> 
```

或这个：

```
<xsl:template match="teaserText_fr">
  <teaserText_fr>
    <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
    <xsl:copy-of select="*"/>    
    <xsl:text disable-output-escaping="yes">]]&gt;</xsl:text>
  </teaserText_fr>
</xsl:template> 
```

（我推荐第一种方法）

你应该准备好了。

对名称以“teaserText_”开头的任何元素进行相同的处理：

```
<xsl:template match="*[starts-with(local-name(), 'teaserText_')]">
  <xsl:copy>
    <xsl:text disable-output-escaping="yes">&lt;![CDATA[</xsl:text>
    <xsl:copy-of select="*"/>    
    <xsl:text disable-output-escaping="yes">]]&gt;</xsl:text>
  </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-03T14:41:16.160

更清洁的方法是使用**cdata-section-elements**

cdata-section-elements 中的Delcare **teaserText_fr**如下

```
<xsl:output method="xml" indent="yes" version="1.0" encoding="UTF-16" 
standalone="yes" cdata-section-elements="teaserText_fr" /> 
```

然后按如下方式格式化 XSLT。（请注意，您必须包含 CDATA 作为元素的包装）

```
<xsl:template match="/">
    <teaserText_fr>
        <![CDATA[
            <div xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.coremedia.com/2003/richtext-1.0"><p>2012 ist für viele Länder ein   wichtiges Wahljahr. Die Reihe fühlt der weltweiten Demokratie auf den Zahn. </p>
            </div>
        ]]>
    </teaserText_fr>
</xsl:template> 
```

# google-apps-script - 谷歌脚本添加按钮来打开一个 URL

> ID：15534260
> 
> 赞同：1
> 
> 时间：2013-03-20T20:40:50.573
> 
> 标签：google-apps-script

我在下面有以下代码，它会生成按钮，当它们被点击时会向我发送一封电子邮件。

我现在想添加一个按钮以在按下按钮时打开网页，例如 www.bbc.co.uk。

我怎么做？？？

这是我运行的代码

[https://script.google.com/macros/s/AKfycbw6yYRE7aroV3lXvXyfNYm15NeKa2FyBCvvvcOuD1k/dev](https://script.google.com/macros/s/AKfycbw6yYRE7aroV3lXvXyfNYm15NeKa2FyBCvvvcOuD1k/dev)？

这就是它背后的代码。

```
 function doGet() {

      var app = UiApp.createApplication();

     var buttonPhilippaTitle = app.createButton('Philippa\'s Morning Routine')
        .setId('LabelPhilippaTitle');
        buttonPhilippaTitle.setHTML('<H1>Philippa</h1>');
        app.add(buttonPhilippaTitle);

     var buttonPhilippaUp = app.createButton('I have got up')
        .setId('LabelPhilippaUp');
        app.add(buttonPhilippaUp);
        var handler = app.createServerHandler('myClickHandlerPhilippaUp');
        buttonPhilippaUp.addClickHandler(handler);

      var buttonPhilippaApple = app.createButton('I have had an apple')
        .setId('LabelPhilippaApple');
        app.add(buttonPhilippaApple);
        var handler = app.createServerHandler('myClickHandlerPhilippaApple');
        buttonPhilippaApple.addClickHandler(handler);

      var buttonPhilippaBath = app.createButton('I have had a bath')
        .setId('LabelPhilippaBath');
        app.add(buttonPhilippaBath);
        var handler = app.createServerHandler('myClickHandlerPhilippaBath');
        buttonPhilippaBath.addClickHandler(handler);

      var buttonPhilippaPray75 = app.createButton('I have prayed for 75')
        .setId('LabelPhilippaPray75');
        app.add(buttonPhilippaPray75);
        var handler = app.createServerHandler('myClickHandlerPhilippaPray75');
        buttonPhilippaPray75.addClickHandler(handler);

      var buttonPhilippaEyesClosed50 = app.createButton('I have had my eyes closed for 50')
        .setId('LabelPhilippaEyesClosed50');
        app.add(buttonPhilippaEyesClosed50);
        var handler = app.createServerHandler('myClickHandlerPhilippaEyesClosed50');
        buttonPhilippaEyesClosed50.addClickHandler(handler);

      var buttonPhilippaCreamVitDeod = app.createButton('I have put on cream on my face, had a vitamin and put on deodorant')
        .setId('LabelPhilippaCreamVitDeod');
        app.add(buttonPhilippaCreamVitDeod);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamVitDeod');
        buttonPhilippaCreamVitDeod.addClickHandler(handler);   

    var buttonPhilippaCreamOnArms1 = app.createButton('I have put on cream on my arms once')
        .setId('LabelPhilippaCreamOnArms1');
        app.add(buttonPhilippaCreamOnArms1);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamOnArms1');
        buttonPhilippaCreamOnArms1.addClickHandler(handler);   

    var buttonPhilippaCreamOnArms2 = app.createButton('Cream Twice')
        .setId('LabelPhilippaCreamOnArms2');
        app.add(buttonPhilippaCreamOnArms2);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamOnArms2');
        buttonPhilippaCreamOnArms2.addClickHandler(handler);   

    var buttonPhilippaCreamOnArms3 = app.createButton('Cream Three Times')
        .setId('LabelPhilippaCreamOnArms3');
        app.add(buttonPhilippaCreamOnArms3);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamOnArms3');
        buttonPhilippaCreamOnArms3.addClickHandler(handler);   

    var buttonPhilippaCreamOnArms4 = app.createButton('Cream Four times')
        .setId('LabelPhilippaCreamOnArms4');
        app.add(buttonPhilippaCreamOnArms4);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamOnArms4');
        buttonPhilippaCreamOnArms4.addClickHandler(handler);   

    var buttonPhilippaCreamOnArms5 = app.createButton('Cream Five times')
        .setId('LabelPhilippaCreamOnArms5');
        app.add(buttonPhilippaCreamOnArms5);
        var handler = app.createServerHandler('myClickHandlerPhilippaCreamOnArms5');
        buttonPhilippaCreamOnArms5.addClickHandler(handler);   

    // Classical Radio Is On
    var buttonPhilippaClassicalRadioOn = app.createButton('I have put the classical radio on in my bedroom')
        .setId('LabelPhilippaClassicalRadioOn');
        app.add(buttonPhilippaClassicalRadioOn);
        var handler = app.createServerHandler('myClickHandlerPhilippaClassicalRadioOn');
        buttonPhilippaClassicalRadioOn.addClickHandler(handler);   

       var buttonPhilippaWashingUp = app.createButton('I have done some washing up')
        .setId('LabelPhilippaWashingUp');
        app.add(buttonPhilippaWashingUp);
        var handler = app.createServerHandler('myClickHandlerPhilippaWashingUp');
        buttonPhilippaWashingUp.addClickHandler(handler);

    // Shoe Crate Is Tidy
    var buttonPhilippaShoeCrateIsTidy = app.createButton('Shoe Crates Are Tidy Including All Girls Shoes In The Bedroom')
        .setId('LabelPhilippaShoeCrateIsTidy');
        app.add(buttonPhilippaShoeCrateIsTidy);
        var handler = app.createServerHandler('myClickHandlerPhilippaShoeCrateIsTidy');
        buttonPhilippaShoeCrateIsTidy.addClickHandler(handler);   

    // Cleaned Under My Bed
    var buttonPhilippaCleanedProperlyUnderMyBed = app.createButton('I Have Cleaned Properly Under My Bed')
        .setId('LabelPhilippaCleanedProperlyUnderMyBed');
        app.add(buttonPhilippaCleanedProperlyUnderMyBed);
        var handler = app.createServerHandler('myClickHandlerPhilippaCleanedProperlyUnderMyBed');
        buttonPhilippaCleanedProperlyUnderMyBed.addClickHandler(handler);   

     var buttonPhilippaSetGoalsForTheDay = app.createButton('I have set my goals for the day')
        .setId('LabelPhilippaSetGoalsForTheDay');
        app.add(buttonPhilippaSetGoalsForTheDay);
        var handler = app.createServerHandler('myClickHandlerPhilippaSetGoalsForTheDay');
        buttonPhilippaSetGoalsForTheDay.addClickHandler(handler);   

    var text1 = app.createTextArea();
      app.add(text1);
      text1.setText("*** Please email Daddy these goals once you have set them****\nPhilippa : My goals for the day are\n\nMorning\n\n\n\nEvening\n\n\nGoals For The Week\nSat\nSun\nMon\nTues\nWed\nThurs\nFri");
      text1.setWidth("100%");
      text1.setHeight("200");
      text1.setVisible(true);

      return app;

    }

    // Philippa Up
    function myClickHandlerPhilippaUp(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaUp');
      label.setHTML('<h2 style="background-color:red;">Congratulations, Philippa!  You have got up ! ! !</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress, 'Philippa has got up','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaApple(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaApple');
      label.setHTML('<h2 style="background-color:red;">Congratulations Philippa you have started the day well with a piece of fruit.  Remember - God made fruit and salad, not chocolate!!!</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress, 'Philippa has had an apple!!!','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaBath(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaBath');
      label.setHTML('<h2 style="background-color:red;">Congratulations Philippa You Have Had A Bath!!!</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has had a bath!!!','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaPray75(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaPray75');
      label.setHTML('<h2 style="background-color:red;">Congratulations Philippa you have had a proper prayer for 75!!!</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,   'Philippa has prayed for 75!!!','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaEyesClosed50(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaEyesClosed50');
      label.setHTML('<h2 style="background-color:red;">Wow ! Did you really pray with your eyes closed for 50?  Did God speak to you Philippa?  Let me know!!!</h2>')
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has prayed for 50 with eyes closed!!!','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaCreamVitDeod(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamVitDeod');
      label.setHTML('<h2 style="background-color:red;">Well done Philippa! Thanks for letting me know you have had cream, vitamin and deodorant!!!</h2>')
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on, had a vitamin and put deodorant on...','');            
      app.close();
      return app;
    }

    // Cream On Arms
    function myClickHandlerPhilippaCreamOnArms1(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamOnArms1');
      label.setHTML('<h2 style="background-color:red;">Well done Philippa! Thanks for keeping your arms moist!!!</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on her arms once','');            
      app.close();
      return app;
    }

    // Cream On Arms
    function myClickHandlerPhilippaCreamOnArms2(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamOnArms2');
      label.setHTML('<h2 style="background-color:red;">Cream on arms twice</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on her arms twice','');            
      app.close();
      return app;
    }

    // Cream On Arms
    function myClickHandlerPhilippaCreamOnArms3(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamOnArms3');
      label.setHTML('<h2 style="background-color:red;">Cream on arms three times</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on her arms three times','');            
      app.close();
      return app;
    }

    // Cream On Arms
    function myClickHandlerPhilippaCreamOnArms4(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamOnArms4');
      label.setHTML('<h2 style="background-color:red;">Cream on arms four times</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on her arms four times','');            
      app.close();
      return app;
    }

    // Cream On Arms
    function myClickHandlerPhilippaCreamOnArms5(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCreamOnArms5');
      label.setHTML('<h2 style="background-color:red;">Cream on arms five times</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put cream on her arms five times','');            
      app.close();
      return app;
    }

    // Classical Radio Is On
    function myClickHandlerPhilippaClassicalRadioOn(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaClassicalRadioOn');
      label.setHTML('<h2 style="background-color:red;">I have put the classical radio on in the bedroom ! </h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has put the classical radio on in the bedroom','');            
      app.close();
      return app;
    }

    // Washing Up
    function myClickHandlerPhilippaWashingUp(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaWashingUp');
      label.setHTML('<h2 style="background-color:red;">You are getting helpful, Philippa!!! Thanks for doing some washing up!!!</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has done some washing up','');            
      app.close();
      return app;
    }

    // Shoe Crate Is Tidy
    function myClickHandlerPhilippaShoeCrateIsTidy(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaShoeCrateIsTidy');
      label.setHTML('<h2 style="background-color:red;">Shoe Crates Are Tidy Including All Girls Shoes In The Bedroom</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has tidied the shoe crates','');            
      app.close();
      return app;
    }

    // Cleaned Properly Under My Bed
    function myClickHandlerPhilippaCleanedProperlyUnderMyBed(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaCleanedProperlyUnderMyBed');
      label.setHTML('<h2 style="background-color:red;">I Have Cleaned Properly Under My Bed</h2>');
      var emailAddress = ('user@example.com');
      GmailApp.sendEmail(emailAddress,'Philippa has cleaned under her bed','');            
      app.close();
      return app;
    }

    function myClickHandlerPhilippaSetGoalsForTheDay(e) {
      var app = UiApp.getActiveApplication();
      var label = app.getElementById('LabelPhilippaSetGoalsForTheDay');
      label.setHTML('<h2 style="background-color:red;">Thanks for setting your goals for today, Philippa ! ! !</h2>');
    var emailAddress = ('user@example.com');
    GmailApp.sendEmail(emailAddress,'Philippa Has Set Goals','');            
    app.close();
    return app;
    } 
```

# php - 如何防止在预订系统上添加两次

> ID：15534261
> 
> 赞同：1
> 
> 时间：2013-03-20T20:40:53.333
> 
> 标签：php, mysql

我有一个预订系统时间，用户可以在其中预订一个时间，比如说在特定日期内的一个小时。我的问题是，当我在网站的两个选项卡中打开时，我无法处理这种情况，我尝试从一个选项卡预订时间，然后在日历上显示预订已完成，但由于在另一个选项卡中页面是没有刷新，它显示仍然可以预订的时间，我可以预订它，所以它显示了两个，我的意思是我可以打开尽可能多的标签并做同样的事情，我怎么能阻止这个能够在特定日期只能预订一次？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:47:06.637

您可以编写一些脚本，该脚本将根据请求返回任何时期的可行性。然后，在您的预订页面中进行一个简单的 Ajax 查询以检查所选时段是否仍然可用并运行它`setTimeout()`。如果请求显示您已经预订了该期限，您可以通过向他显示相关消息来通知用户并禁用表单提交，直到选择有效期限。这也将帮助您，以防有人在其他用户正在考虑的情况下预订选定的日期:)

# exception - Grails 应用程序中的 java.lang.ClassCastException

> ID：15534262
> 
> 赞同：13
> 
> 时间：2013-03-20T20:40:53.273
> 
> 标签：exception, grails, groovy, classcastexception

我正在关注免费的在线书籍“Grails 入门”( [http://www.infoq.com/minibooks/grails-getting-started](http://www.infoq.com/minibooks/grails-getting-started) )，并且在尝试列出任何域类时遇到 java.lang.ClassCastException。谁能破译这个？

```
URI: /RaceTrack/runner/list
Class: java.lang.ClassCastException
Message: sun.proxy.$Proxy26 cannot be cast to org.springframework.orm.hibernate3.HibernateCallback 
```

堆栈跟踪：

```
 Line | Method
->>   15 | list      in RunnerController.groovy
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    186 | doFilter  in PageFragmentCachingFilter.java
|     63 | doFilter  in AbstractFilter.java
|   1145 | runWorker in java.util.concurrent.ThreadPoolExecutor
|    615 | run . . . in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run       in java.lang.Thread 
```

附加信息（PageFragmentCachingFilter.java 的第 186 行附近）

```
183:            if(method == null) {
184:                log.debug("No cacheable method found for {}:{} {}",
185:                        new Object[] { request.getMethod(), request.getRequestURI(), getContext() });
186:                chain.doFilter(request, response);
187:                return;
188:            }
189:            Collection<CacheOperation> cacheOperations = cacheOperationSource.getCacheOperations( 
```

附加信息（在 AbstractFilter.java 的第 63 行附近）：

```
60:     try {
61:         // NO_FILTER set for RequestDispatcher forwards to avoid double gzipping
62:         if (filterNotDisabled(request)) {
63:             doFilter(request, response, chain);
64:         }
65:         else {
66:             chain.doFilter(req, res); 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-11T16:28:44.223

几天前突然发生了同样的问题。删除 ~/.grails/2.0.4/.slcache/ 目录为我修复了它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-10T22:03:48.497

删除 .grails 子目录顶部的 .slcache 以及 .slcache（如果存在），以用于正在使用的特定版本的 grails。例如，~/.grails/2.1.3/.slcache。

这在使用 IntelliJ IDEA 启动应用程序时有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T17:17:19.753

应用程序是否在禁用重新加载（[弹簧加载代理](https://github.com/SpringSource/spring-loaded)）的情况下启动？

```
grails -noreloading run-app 
```

Grails Jira 已向Grails Jira 报告了类似的问题[GRAILS-9952](http://jira.grails.org/browse/GRAILS-9952)。如果您可以提供重现问题的测试应用程序，这将有助于解决问题。请将其附加到 jira 问题上。

# excel - 在 Excel 中编辑值

> ID：15534269
> 
> 赞同：0
> 
> 时间：2013-03-20T20:41:15.093
> 
> 标签：excel, function

```
 COL1         COL2
   (1432)UE           UE
(1352)XE234        XE234
         AA           AA
   (512) GT           GT
 (412)XT I3        XT I3 
```

我有一个像 COL1 这样的列。我需要删除 (*) 值来创建 COL2。如何在 Excel 中执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:47:26.567

假设您的数据从 开始`A1`，这个公式将完成这项工作：

```
=IF(OR(ISERROR(SEARCH("(",A1)),ISERROR(SEARCH(")",A1))),A1,TRIM(RIGHT(A1,LEN(A1)-SEARCH(")",A1 ））））

```

# r - 股票价格模拟 R 代码 - 慢 - 蒙特卡洛

> ID：15534270
> 
> 赞同：3
> 
> 时间：2013-03-20T20:41:16.473
> 
> 标签：r, montecarlo

我需要使用 R 代码执行股票价格模拟。问题是代码有点慢。基本上我需要模拟每个时间步（每天）的股票价格并将其存储在矩阵中。

假设库存过程是几何布朗运动的示例

```
for(j in 1:100000){
    for(i in 1:252){
        S[i] <- S[i-1]*exp((r-v^2/2)*dt+v*sqrt(dt)*rnorm(1))
    }
    U[j,] <- S
} 
```

有什么改进和加速代码的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:43:18.703

假设`S[0] = 1`，您可以按如下方式构建 U：

```
Ncols <- 252

Nrows <- 100000

U <- matrix(exp((r-v^2/2)*dt+v*sqrt(dt)*rnorm(Ncols*Nrows)), ncol=Ncols, nrow=Nrows)

U <- do.call(rbind, lapply(1:Nrows, function(j)cumprod(U[j,]))) 
```

编辑：使用 Joshua 和 Ben 的建议：

产品版本：

```
U <- matrix(exp((r-v^2/2)*dt+v*sqrt(dt)*rnorm(Ncols*Nrows)), ncol=Ncols, nrow=Nrows)

U <- t(apply(U, 1, cumprod)) 
```

总和版本：

```
V <- matrix((r-v^2/2)*dt+v*sqrt(dt)*rnorm(Ncols*Nrows), ncol=Ncols, nrow=Nrows)

V <- exp( t(apply(V, 1, cumsum)) ) 
```

编辑：正如@Paul 所建议的：

每个提案的执行时间（使用 10000 行而不是 10^5）：

使用`apply + cumprod`

```
 user  system elapsed 
0.61    0.01    0.62 
```

使用`apply + cumsum`

```
 user  system elapsed 
0.61    0.02    0.63 
```

使用 OP 的原始代码

```
 user  system elapsed 
67.38    0.00   67.52 
```

注：以上时间为 的第三小节`system.time`。每个代码的前两个度量被丢弃。我用过`r <- sqrt(2)`，`v <- sqrt(3)`和`dt <- pi`。在他的原始代码中，我还替换`S[i-1]`了 for`ifelse(i==1,1,S[i-1])`和 preallocated `U`。

# javascript - 如何在 url 中使用“&”作为搜索条件

> ID：15534275
> 
> 赞同：0
> 
> 时间：2013-03-20T20:41:26.890
> 
> 标签：javascript, html, url, search

这是我的第一篇文章，所以如果它是重复的，请不要介意我，但我找不到答案。

我正在使用 javascript/html/abl/css 等，我必须能够使用 & 作为搜索条件。

我需要一种方法来让[http://this.com/mode=results&action=search&result=](http://this.com/mode=results&action=search&result=) '&'& 工作。

我遇到的问题是 url 一直像分隔符一样解释它，并且分页符。我尝试将其转换为 %26 或 & 以尝试将其保留在搜索中，但它不会找到我的搜索。我在搜索 & 时查看了 google 的 url，它被替换为 %26。有什么意见吗？

谢谢，谢尔顿。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:55:59.910

使用 javascript encodeURIComponent() 函数。

[http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp](http://www.w3schools.com/jsref/jsref_encodeuricomponent.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:45:47.307

您*需要*在 URL 中转义`&`，以使字符不被视为分隔符。正如你所说，正确的编码是`%26`. 也许您需要在服务器上进行额外的更改以确保正确处理编码的字符？

# java - 退出for循环后Java数组变为零

> ID：15534282
> 
> 赞同：0
> 
> 时间：2013-03-20T20:41:43.067
> 
> 标签：java, image-processing, multidimensional-array, fft

我正在使用我在网上找到的 FFT 类来计算图像的 FFT。这是计算 FFT 的代码。

w（宽度）和 h（高度）在这种情况下是相同的值。

```
FFT2 fft = new FFT2(w);
double[] realRow = new double[w];
double[] imagRow = new double[w];
double[][] realVals1 = new double[w][h];
double[][] imagVals1 = new double[w][h];

for (int y = 0; y < h; y++)
    {   
        for (int x = 0; x < w; x++)
        {
            pixel = bmporiginal.getPixel(x, y);
            R = (int) (Color.red(pixel));
            G = (int) (Color.green(pixel) );
            B = (int) (Color.blue(pixel));

            I = ((R+G+B)/3);
            I *= Math.pow(-1, (x+y) % 2.0 );
            realRow[x] = I;
            imagRow[x] = 0.0;
        }
            fft.fft(realRow, imagRow);
            realVals1[y] = realRow;
            imagVals1[y] = imagRow;
    } 
```

我需要的值存储在 realVals 和 ImagVals 中。我可以在 for 循环中打印这些值并获得好的值。离开 for 循环后，我再次打印它们，但一无所获！！！可能是什么问题呢？我感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:44:59.350

您为循环的*每次迭代重用相同的行数组。*

因此，在两个循环结束时，您的`realVals1`和`imagVals1`都将`h`引用同一个数组。您需要在外循环的每次迭代中创建一个新数组：

```
for (int y = 0; y < h; y++)
{   
    double[] realRow = new double[w];
    double[] imagRow = new double[w];

    for (int x = 0; x < w; x++)
    {
        ...
    }
    fft.fft(realRow, imagRow);
    realVals1[y] = realRow;
    imagVals1[y] = imagRow;
} 
```

此外，我相信您的声明`realVals1`和`imagVals1`是a）效率低下和b）错误的方式。我怀疑你想要：

```
double[][] realVals1 = new double[h][];
double[][] imagVals1 = new double[h][]; 
```

无论如何你都要替换元素，所以填充一堆空行没有意义......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:45:48.777

您每次通过内部循环重用相同的数组 realRow 和 imagRow 。由于 Java 使用引用，因此当您分配 realVals1[y]=realRow 时，您分配了一个引用。由于您始终使用相同的数组，因此您将所有行分配给相同的数组引用。这不是你想要的。您需要在外部 for 循环的顶部将 realRow 和 imagRow 重新创建为新的 double[]。

# java - 为什么我的程序在从 BufferedReader 读取行时会阻塞？

> ID：15534283
> 
> 赞同：0
> 
> 时间：2013-03-20T20:41:47.017
> 
> 标签：java, adb

我正在使用 ProcessBuilder 执行一些命令，如下所示：

```
BufferedReader response = null;
process = processBuilder.start();           
response = new BufferedReader(new InputStreamReader(process.getInputStream())); 
```

但是代码块在下一行，同时从响应中读取行。

```
while((line = response.readLine()) != null) {
  /* some code here */
} 
```

我做了一些谷歌，我发现当 readLine() 没有得到 EOL 时，它会阻塞。

我怎样才能使它工作或解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:46:41.927

根据 API，这就是所指示的`readLine()`

> 读取一行文本。一行被认为是由换行符 ('\n')、回车符 ('\r') 或紧跟换行符的回车符中的任何一个终止的。

因此，我认为您必须确保提供行终止符以避免阻塞。

# exception - 是什么导致我的 OLEDbException，IErrorInfo.GetDescription 失败并出现 E_FAIL（0x80004005）

> ID：15534284
> 
> 赞同：13
> 
> 时间：2013-03-20T20:41:47.580
> 
> 标签：exception, ms-access, oledbconnection

我正在对 Access 数据库使用 OleDbConnection、OldDbCommand 和 OleDbReader。

我在从代码中调用的数据库中有一个命名查询。

从访问权限运行查询时，该查询可以正常工作。

一些资源表明错误可能是由于在查询中使用保留字并用括号括起来引起的。我没有使用任何保留字，并且无论如何都将所有列名括在括号中以排除它。

为了确定问题出在哪里，我将查询简化为一个简单的

```
SELECT id FROM table1 WHERE id = 5 
```

其中 Ole 连接不会引发异常。

当我介绍查询的下一部分时：

```
SELECT table1.id FROM table1 INNER JOIN storedQuery ON table1.id = storedQuery.id WHERE table1.id = 5" 
```

然后我得到了例外。

异常详情如下：

> *   消息：IErrorInfo.GetDescription 失败，出现 E_FAIL(0x80004005)。
> *   错误代码：-2147467259
> *   本机错误：-533136361
> *   SQL 状态：3000

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-25T13:50:03.323

当我说查询不包含任何保留字时，我显然弄错了。

我使用的查询是从 Access 数据库中的另一个查询中选择的。另一个查询有一个导致问题的保留关键字。

顺便提一句：

> Access 数据库引擎以不同的模式运行，具体取决于它是从 Access、数据访问对象、Access 数据库引擎的 Microsoft OLE 提供程序还是 Microsoft Access ODBC 驱动程序调用的。它可以在 ANSI 模式或非 ANSI（传统）模式下运行。
> 
> 因为使用这两种模式会导致两组略有不同的保留字，所以使用保留字的查询可能在一种模式下工作而在另一种模式下失败
> 
> [Access 2007 保留字和符号](http://office.microsoft.com/en-us/access-help/access-2007-reserved-words-and-symbols-HA010030643.aspx)

基思

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-12-31T03:22:52.963

> ..并且无论如何都将所有**列**名括在括号中以排除它。

不仅应该用方括号括起来的列名表名也应该例如，替换下面的行

```
SELECT id FROM table1 WHERE id = 5 
```

用下面的线

```
SELECT [id] FROM [table1] WHERE [id] = 5 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-30T14:03:23.153

此异常的另一个可能原因是您尝试加载/读取的文件不存在。

我发现在尝试打开文件之前执行“File.Exists”很有用，只是为了确保我的代码正确检测到“IErrorInfo.GetDescription failed with E_FAIL”异常的特定原因。

# r - 如何在 R 中进行 ma 和 loess 归一化？

> ID：15534287
> 
> 赞同：3
> 
> 时间：2013-03-20T20:41:54.563
> 
> 标签：r, statistics, normalization, regression, loess

尝试使用 MA 归一化（[http://en.wikipedia.org/wiki/MA_plot](http://en.wikipedia.org/wiki/MA_plot)`x` ）对两个变量和R 中的 loess 进行如下处理：`y`

```
> x = rnorm(100) + 5
> y = x + 0.6 + rnorm(100)*0.8
> m = log2(x/y)
> a = 0.5*log(x*y) 
```

我想以平均值`m`为 0 的方式对 x 和 y 进行归一化，就像在标准 MA 归一化中一样，然后反算正确的 x 和 y 值。首先在 MA 上运行黄土：

```
> l = loess(m ~ a) 
```

那么获得校`m`正值的方法是什么？这个对吗？

```
> mc <- predict(l, a)
# original MA plot
> plot(a,m)
# corrected MA plot
> plot(a,m-mc) 
```

我不清楚在对象`predict`的情况下实际上做了什么，以及它与在返回的对象中`loess`使用有何不同- 有人可以解释一下吗？最后，我怎样才能根据这个更正计算新的值？`l$residuals``l``loess``x``y`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-01-27T00:39:37.173

首先，是的，您提出的方法得到了正确的`m`值。

关于预测函数：是的，`l$residuals`，`m - fitted(l)`，并且`m - predict(l)`都给出相同的结果：校正后的 m 值。但是，该`predict`函数更通用：它将任何新值作为输入。如果您只想使用数据的一个子集来拟合黄土，然后对数据的整体进行预测（例如，当使用加标标准时），这很有用。

最后，您如何根据此更正计算新值`x`和值？`y`如果您将数据转换为日志空间，通过创建两个新变量`x1 <- log2(x)`和`y1 <- log2(y)`，它会变得更容易查看。由于我们在对数空间中，计算`m`和`a`更简单：

*   `m <- x1 - y1`
*   `a <- (x1 + y1)/2`

现在，为了根据拟合的黄土模型更正您的数据，而不是`m`通过您的更正来更新变量`mc`，您可以更新`x1`and`y1`代替。放：

*   `x1 <- x1 - mc / 2`
*   `y1 <- y1 + mc / 2`

此更新与更新具有相同的效果`m <- m - mc`（因为`m`将重新计算为更新后的`x1`和之间的差异`y1`）并且对`a`值没有影响。

要获取更正后的数据，请通过返回`2^x1`和转换它们`2^y1`。

这是 affy 包中 normalize.loess 函数的作者使用的方法，最初在此处描述（并且包括循环查看所有变量对而不是本例中的单个变量对的能力）： [http：/ /web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/limma/html/normalizeCyclicLoess.html](http://web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/limma/html/normalizeCyclicLoess.html)

# javascript - 如何在while循环中仅显示一次文本？

> ID：15534288
> 
> 赞同：0
> 
> 时间：2013-03-20T20:41:55.640
> 
> 标签：javascript, jquery, api, vimeo

我正在尝试显示 javascript 对象的“文本”属性以在达到其时间码属性时显示在控制台中。“时间码”属性与 Vimeo 播放器中的经过时间进行比较。这很好——我遇到的问题是由于 Vimeo API 每秒返回多个毫秒数据“命中”，所以我看到我的文本在控制台中多次弹出。

谁能建议如何将每个文本属性显示一次，并且只显示一次？

```
notes_ex = [
  {
    timecode: 2,
    text: 'Hi there!'
  },
  {
    timecode: 7,
    text: 'Hi again!'
  }
];

function ready(player_id) {
  var player = $f(player_id);

  player.addEvent('ready', function() {
      console.log('ready');
      player.addEvent('playProgress', onPlayProgress);
  });

  function onPlayProgress(data, id) {
    timeElapsed = Math.floor(data.seconds);
    console.log('timeElapsed:' + timeElapsed);

    while (timeElapsed++) {
      for (var i = 0; i < notes_ex.length; i++) {
        timecode = notes_ex[i].timecode;
        if (timecode === timeElapsed) {
          console.log(notes_ex[i].text);
        }
      }
      break;
    }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:48:02.120

您能否分配第二个变量来表示它何时被触发？所以是这样的：

```
var z = 0;

if (timecode === timeElapsed && z == 0) {
  console.log(notes_ex[i].text);
  z++;
} 
```

有点不完整，但你明白了原理......

# objective-c - 操作无法完成。（可可错误：3840。）

> ID：15534289
> 
> 赞同：8
> 
> 时间：2013-03-20T20:41:59.183
> 
> 标签：objective-c, json, web-services, ios6, nsjsonserialization

我正在尝试为 ios 6 应用程序解析 JSON，但似乎无法使其正常工作。我已经搜索了大量的论坛，但还没有找到一个可行的、我理解的足以实施或适用的解决方案。

如果我错过了一个，我深表歉意。

首先，我有一个测试 WebService，据我所知，它返回有效的 JSON

[http://thetrouthunter.com/SVLocationsAPI.php](http://thetrouthunter.com/SVLocationsAPI.php)

其次，这是我的 Objective-C 代码：

```
+ (NSDictionary *)connectToService:(NSString *)query
{
    NSError *error = nil;

    query = [NSString stringWithFormat:@"%@&format=json&nojsoncallback=1", query];
    query = [query stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSData *jsonData = [[NSString stringWithContentsOfURL:[NSURL URLWithString:query] encoding:NSUTF8StringEncoding error:nil] dataUsingEncoding:NSUTF8StringEncoding];

    NSDictionary *results = jsonData ? [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers|NSJSONReadingMutableLeaves error:&error] : nil;

    NSLog(@"locations: %@", results);

    if (error)
        NSLog(@"[%@ %@] JSON error: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), error.localizedDescription);

    return results;
}

+ (NSArray *)userLocation {
    NSString *request = [NSString stringWithFormat:@"http://thetrouthunter.com/SVLocationsAPI.php"];
    return [[self connectToService:request] valueForKeyPath:@"locations.location"];
} 
```

ls NSLog 函数打印出错误：“操作无法完成。（Cocoa 错误：3840。）”

我不明白为什么会这样。我已经尝试了各种各样的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:47:10.930

您正在添加`%@&format=json&nojsoncallback=1`到中的 URL `connectToService:`，并且该新 URL 会生成一个网页，而不是您期望的 JSON（即[http://thetrouthunter.com/SVLocationsAPI.php&format=json&nojsoncallback=1](http://thetrouthunter.com/SVLocationsAPI.php&format=json&nojsoncallback=1)）。

记录来自 HTTP 请求的实际结果可能很有用，这样您就可以调试它，直到获得 JSON（即在调用序列化函数之前）。

# jquery - 如何从文本输入框中删除空格

> ID：15534290
> 
> 赞同：6
> 
> 时间：2013-03-20T20:42:05.347
> 
> 标签：jquery, onchange, str-replace

我有以下工作的 jQuery shell：

```
 $('.jq_noSpaces').on('change', function(){
    alert('you changed the value in the box');
  }); 
```

我的表单属性是`id="username" name="username"`

如何使用以下 jQuery 替换功能自动更改从输入字段中删除空格？

```
str.replace(/\s+/g, ''); 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T20:43:26.320

您可以使用以下语法：

```
$(this).val($(this).val().replace(/\s+/g, '')); 
```

在事件处理程序内部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T20:43:51.697

在事件处理程序中替换框的内容

```
this.value = this.value.replace(/\s+/g, ''); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:44:10.370

根本不需要 jQuery ......只要做`this.value = this.value.replace(/s+/g, '');`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:45:16.793

```
$('.jq_noSpaces').on('change', function(){
    $(this).val($(this).val().replace(/\s+/g,"")) //thanks @Sushil for the reminder to use the global flag
    alert('you changed the value in the box');
}); 
```

或者，就像其他人所说的那样，您根本不需要 jQuery。不过，我还是倾向于使用它。所有真正酷的程序员都会这样做。

# python - 将数据从 Raspberry pi 移动到 Synology 磁盘站以呈现在网页中

> ID：15534297
> 
> 赞同：2
> 
> 时间：2013-03-20T20:42:25.023
> 
> 标签：python, service, web

我正在寻找有关如何在由 Synology Diskstation 托管的网页中显示传感器数据的想法，其中数据来自连接到 Raspberry pi 的传感器。这将在 Python 中实现。

我已经将传感器放在一起，并将它们连接到 Raspberry。我也有 Python 代码，所以我可以读取传感器。我使用 Python 在 Diskstation 上启动并运行了一个网页。但是如何从锉刀获取数据到 Diskstation。当显示网页时，阅读刚刚完成。

猜猜 Rasp 上的某种 WebServices ？我看过 Pyro4，但看起来它不能安装在 Diskstation 上。而且我不希望在 rasp 上安装整个 WebServer 框架。

你有什么建议吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:52:14.297

我没有在这个主题上做实验，但我要做的是在两者之间设置一个数据库（在 Synology 上而不是在 Raspberry Pi 上）。让我们称您的 Synology**服务器**和 Raspberry Pi 为**传感器客户端**。

我会在服务器上托管一个数据库，然后从传感器客户端推送。数据可以通过 Web 服务使用 API 推送，或者如果您需要更快地推送数据（服务器端需要一些代码），或者由于客户端计算机在您的控制之下，它可以直接推送到数据库中。

您在数据库、Web 服务或其他 API 之间的具体选择取决于：

*   需要推送多少数据？
*   数据必须以多快的速度推送？
*   你对你的网络有多信任？
*   您对传感器客户端的信任程度如何？

我从未使用过它，但我建议您使用 SQLAlchemy 连接到数据库（从双方）。

如果在某些用例中远程服务器可能关闭，传感器客户端会将传感器数据存储在某个本地文件中，并在服务器重新联机时推送它们。

# three.js - 我已经在threejs中添加了一个obj模型。如何删除它？

> ID：15534299
> 
> 赞同：0
> 
> 时间：2013-03-20T20:42:28.620
> 
> 标签：three.js, loader

```
var loader = new THREE.OBJMTLLoader();

loader.addEventListener( 'load', function ( event ) {

    var object = event.content;
    object.position.z = -700;
    scene.add( object );    
});

loader.load( 'obj/male02/male02.obj', 'obj/male02/male02.mtl' ); 
```

如何删除对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:03:06.730

你只需 scene.remove(object);

# bash - 将文件名的前 4 个字符存储到变量中

> ID：15534301
> 
> 赞同：2
> 
> 时间：2013-03-20T20:42:38.877
> 
> 标签：bash

以下代码是我正在编写的脚本的一部分。现在，为了这个脚本的目的，我假设 ./src 中只有 1 个文件，所以这个循环应该只执行一次。现在，在某处的循环中，我想获取 $f （文件名）的前 4 个字符并将其存储在另一个变量中。我知道有 cut 命令，但我不确定是否或如何在这里使用它，因为我认为 cut 用于文件的内容，而不是文件本身。

```
for f in `ls ./src`
do
    echo $f
    cd tmp
    f="../src/$f"
    sh "$f"
done 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T20:48:30.027

来自[http://tldp.org/LDP/abs/html/string-manipulation.html](http://tldp.org/LDP/abs/html/string-manipulation.html)

> **子串提取**
> 
> `${string:position}` 在 $position 处从 $string 中提取子字符串。
> 
> 如果 $string 参数是“*”或“@”，那么这会提取位置参数，[1] 从 $position 开始。
> 
> `${string:position:length}` 从 $position 的 $string 中提取 $length 个子字符串的字符。

**例子**

```
shortName=${f:0:4} 
```

玩得开心！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T20:46:55.147

您可以使用纯 bash 方式：

```
${parameter:offset:length} 
```

即获取`$HOME`变量的第一个字符：

```
echo ${HOME:0:4} 
```

顺便说一句，您的脚本也有问题（从不解析 ls 输出）。它应该是这样的：

```
for f in ./src/*
do
    echo $f
    cd tmp
    f="../src/$f"
    first4=${f:0:4}
    sh "$f"
done 
```

# java - 在java中创建DIV

> ID：15534302
> 
> 赞同：2
> 
> 时间：2013-03-20T20:42:43.270
> 
> 标签：java, gwt

如何在 Java 中以编程方式创建 DIV，以呈现如下所示的 DIV：

```
<div class="fb-like-box" data-href="http://www.facebook.com/platform" data-width="595" data-show-faces="true" data-stream="true" data-header="true"></div> 
```

出于某种原因，我需要用 Java 而不是 Errai-UI 模板来做；因为它似乎在页面转换时被删除。

无论如何，我应该使用 DivElement 还是其他？这个想法是我应该能够在 Java 代码上创建它并将其插入到某种 SimplePanel 中......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T04:49:39.553

您可以在 GWT 中使用**[SafeHtml](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/safehtml/shared/SafeHtml.html)（防止脚本注入）来实现。**

```
String s = "<div>some html goes here</div>";
SafeHtml safeHtml = SafeHtmlUtils.fromString(s);

And then Prepare HTML with that

HTML dynamicHTml = new HTML(safeHtml); 
```

*SafeHtml 将字符串评估为浏览器中的 HTML 不会导致脚本执行。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T22:12:59.383

使用 HTML 小部件：

```
HTML html = new HTML("<div class='fb-like-box' data-href='http://www.facebook.com/platform' data-width='595' data-show-faces='true' data-stream='true' data-header='true'></div>");

panel.add(html); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-20T22:30:19.770

或者， a`FlowPanel`将默认呈现一个`div`元素。您可以在其上设置任意`data`属性，例如：

```
FlowPanel div = new FlowPanel();
div.getElement().setAttribute("data-myattr", "somevalue"); 
```

# user-interface - 如何将 LabelMorph/TextMorph 绑定到变量，以便 Morph 反映变量的变化？

> ID：15534305
> 
> 赞同：4
> 
> 时间：2013-03-20T20:42:51.313
> 
> 标签：user-interface, smalltalk, pharo, squeak, morphic

*   我有一个带有包含字符串的变量的对象。
*   我有一个包含 LabelMorph/TextMorph（或其他显示文本的 Morph？）的窗口。

如何将 LabelMorph/TextMorph 绑定到变量，以便在变量中的字符串更改时标签更新？

*   经典的 Smalltalk-80 依赖/更改/更新机制？
*   Pharo 公告框架？
*   有些不同？？

我该怎么做？我应该使用哪种变形？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T21:34:27.080

最简单的是使用更新的字符串变形：

```
UpdatingStringMorph on: self selector: #myLabel 
```

这会将#myLabel（或任何其他消息）发送给自己（或任何其他对象）并显示它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:54:55.590

这是 Benjamin Van Ryseghem 在 Pharo Mailinglist 上提供的解决方案：

> 对于这种情况，我的解决方案是使用 ValueHolder。不要将字符串直接存储在实例变量中，而是将其存储到 ValueHolder 中。

我在工作区中试过这个：

```
|string label|

string := 'Wait till i change..' asValueHolder.
label := LabelMorph contents: string contents.
string whenChangedDo: [:newValue | label contents: newValue ].
label openInWindow.
[ 5 seconds asDelay wait. string value: 'I changed :)' ] fork. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T10:34:19.330

Depends on what you want to achieve. You might want to take a look at a way to do it with Glamour in a current Moose image. In a workspace, do-it:

```
GLMBasicExamples new magritte openOn: GLMMagrittePersonExample sampleData 
```

That shows how to work with announcements on save. The earlier examples are a better way to start understanding how to work with Glamour (and because of the way the examplebrowser is build, the Magritte example doesn't update the list when it is nested):

```
GLMBasicExamples open 
```

That has several other examples that update on change.

# jsf - h:selectManyListbox 必需属性未触发 - JSF 2.0

> ID：15534306
> 
> 赞同：0
> 
> 时间：2013-03-20T20:42:52.553
> 
> 标签：jsf, required, selectmanylistbox

以下代码不会导致需要该组件：

```
 <h:selectManyListbox id="id" size="10" value="#{bean.emptylist}" 
  required="true" requiredMessage="Required">
        <f:selectItems value="#{bean.listofvalues}" var="var"
        itemLabel="#{var.val1 - #{var.val2}" itemValue="#{var}" />
 </h:selectManyListbox>
 <rich:message id="msg" for="id" styleClass="required"/> 
```

单击提交时，不会显示任何消息。

# antlr - OR 词法分析器表达式的 AST 重写规则

> ID：15534307
> 
> 赞同：2
> 
> 时间：2013-03-20T20:42:54.570
> 
> 标签：antlr, antlr3

我有以下 ANTLR 规则：

```
procedure
 : ('int' | 'char') IDENT '(' args ')' body -> ^(PROCEDURE IDENT (args)* body)
 ; 
```

我想捕获`('int' | 'char')`AST 中的部分。如您所见，在右侧它没有出现，但我不确定如何选择`'int'`或`'char'`出现在 AST 中。我希望`'int'`or '`char'`部分位于根下的树中，`PROCEDURE`但*在*`IDENT`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:47:38.673

您可以标记该对，然后在重写中引用该标签：

```
procedure
    : primType=('int' | 'char') IDENT '(' args ')' body
      -> ^(PROCEDURE $primType IDENT args body)
    ; 
```

# windows - 有没有办法检查批处理文件中的重定向？

> ID：15534320
> 
> 赞同：4
> 
> 时间：2013-03-20T20:43:16.360
> 
> 标签：windows, batch-file, logging, cmd

如果我们有一个批处理文件被重定向到这样的日志：

```
C:\Testing\Example.bat > C:\Testing\Example.log 
```

批处理文件中是否有任何方法可以确定日志文件是否发生标准输出重定向？

基本上，我拥有的批处理文件需要三个参数传递给它。当参数被忽略时，批处理文件会打印一个用法示例，就像常规 Windows 命令一样，并抛出一个“暂停”，以便可以读取指令。但是，如果在没有参数的情况下调用批处理并且它正在被记录，那么批处理文件将永远坐在那里等待一个键来打破暂停，但不会在屏幕上显示任何内容。

通常这根本不是问题，但是我试图让这个白痴证明，因为我不会是在其他脚本/计划任务中实现批处理文件的人。

在这一点上，我似乎需要完全摆脱使用暂停，但我希望有一个我不需要的解决方案。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-09-02T18:03:12.683

没有很好的方法来确定标准输入或标准输出是否已使用本机批处理命令重定向。

但是在您的情况下无需担心重定向。只需将 PAUSE 标准输入和标准输出重定向到 con，您不必担心之前的重定向。

```
pause <con >con 
```

* * *

### 更新

可以干净地检测标准输入和/或标准输出和/或标准错误是否可能已被重定向。但是我还没有想出一种方法来非破坏性地确定哪些句柄被重定向。

```
@echo off
2>nul (5>&4 break) && (
  >con echo There has been redirection
) || (
  >con echo No redirection found
) 
```

该技术依赖于这样一个事实，即[无论何时重定向现有句柄，旧定义都会保存在最低可用的未定义句柄](https://stackoverflow.com/a/9880156/1012053)中。

如果没有任何重定向，则将`2>nul`stderr 保存在 3 中，并且 4 未定义。所以`5>&4`失败了，`||`分支被解雇了。

如果有重定向，那么 3 已经被定义为保留重定向句柄的原始值，因此`2>nul`会将 stderr 保存在 4 中（除非 4 也已被其他重定向使用）。无论哪种方式，`5>&4`都会成功，因为 4 已定义，因此`&&`分支将触发。

如果测试报告存在重定向，则以下至少一项必须为真：

*   标准输入重定向
*   标准输出重定向
*   标准错误重定向
*   处理 4 直接用类似 4>"log.txt" 的东西定义
*   处理 5 直接用 5>"log.txt" 之类的东西定义

不幸的是，我无法确定以上哪些是正确的，除了......

[在 DosTips 上](https://www.dostips.com/forum/viewtopic.php?f=3&t=2371&p=57999#p57997)，SiberiaMan 发布了一种简单的技术来确定标准输入是否已被重定向或正在接收管道：

```
2>nul >nul timeout /t 0 && (
  >con echo stdin not redirected or piped
) || (
  >con echo stdin has been redirected or is receiving piped input
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:57:51.470

我不知道仅使用批处理和标准命令的任何方法。但是，如果在 .bat 中包含另一个 .exe 对您来说足够重要，则可以从其他语言（例如本机 C 或 C# 程序）中使用一些技巧。

*   这是一个偷偷摸摸的方法。此批处理文件创建一个 .com 文件，然后调用它来测试标准输出句柄： [http ://www.dostips.com/forum/viewtopic.php?f=3&t=2800](http://www.dostips.com/forum/viewtopic.php?f=3&t=2800)

*   如果您想编写一个简单的 C# 帮助程序，这将解释如何使用 C# 来完成： [检查输出是否被重定向](https://stackoverflow.com/questions/1169591/check-if-output-is-redirected)。这让我认为 Powershell 也应该可以，但我没有尝试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:01:21.350

在标准 Windows 批处理文件（我知道）中没有办法确定 STDOUT 被重定向到哪里，或者即使它被重定向。但是，您可能希望将使用示例写入 STDERR 而不是 STDOUT，因此至少简单的重定向到文件不会捕获使用信息。

示例 test.cmd：

```
@ECHO OFF

ECHO Test output 1>&2
PAUSE 1>&2 
```

然后调用它：

```
test.cmd > output.log 
```

仍然会输出：

```
Test output
Press any key to continue . . . 
```

当然，这对于在重定向 STDERR 的情况下调用文件时没有任何作用。

```
test.cmd 2> error.log 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-17T13:32:08.033

`stdout`您可以通过一个小技巧检查是否重定向。
它使用了在 TAB 将光标移回后输出退格键的事实，如果在这种情况下光标应移动到起始位置之前，则会创建一个错误以在日志文件中提示奇怪字符。

缺点是，它输出`<FF><TAB>><BACKSPACE><BACKSPACE><CR><LF>`到标准输出。
当 stdout 是控制台时，它只是将其清除。
但是，当 stdout 被重定向到文件时，您会将这些字符附加到文件中，但可以用有意义的文本对其进行注释。

```
@echo off
setlocal
call :createTAB_BS

echo Script started, test for redirection:
cls
( echo %%TAB%%%%BS%%%%BS%%) | ( findstr "^"  2^> nul)
if %errorlevel% EQU 0 (
    >CON echo stdout is redirected
) ELSE (
    echo stdout goes to the console
)

exit /b

:createTAB_BS
for /f "tokens=1,2 delims=," %%A in ('forfiles /p "%~dp0." /m "%~nx0" /c "cmd /c echo(0x09,0x08"') do (
    set "TAB=%%A"
    set "BS=%%B"
)
exit /b 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-17T15:59:48.427

我想你只是问错了问题。您想找到一种在 cmd 模式下以额外中断结束批处理的方法。并以批处理模式停止而不暂停。您可以使用 CMDpause 这将创建一个名为 cmdpause 的变量示例 [https://www.administrator.de/wissen/batchcode-erstellen-fehler-batch-leichter-finden-184736.html](https://www.administrator.de/wissen/batchcode-erstellen-fehler-batch-leichter-finden-184736.html) [https://www.dostips.com/forum /viewtopic.php?t=7257#p47510](https://www.dostips.com/forum/viewtopic.php?t=7257#p47510)

戴夫和杰布有一些东西。但我没有链接。

菲尔

# javascript - 对 facebook JS SDK 登录的困惑

> ID：15534321
> 
> 赞同：0
> 
> 时间：2013-03-20T20:43:19.290
> 
> 标签：javascript, jquery, facebook, facebook-graph-api, facebook-javascript-sdk

我有两个单独的 js 文件，**domready.js**和**fb-jssdk.js**。

jssdk 处理加载 sdk 和登录。当用户登录或未登录时，它会从 response.state 返回正确的状态，具体取决于场景。

我感到困惑的是，当用户登录并使用 jQuery 在我的网站上使用它时，我如何使用从 FB 响应和 FB.api 获得的数据来获取姓名和电子邮件。

**编辑：** 我想知道如何在与 fb 代码所在的文件不同的 js 文件中使用响应内容，并将其与 jQuery 事件处理程序一起使用。

因此，如果我有一个名为 testAPI() 的函数将 response.name 打印到控制台，我如何获取 response.name = "Kryptonite Dove" 的数据以在另一个文件中使用？

**测试API()**

```
function testAPI() {
console.log('Welcome!  Fetching your information.... ');
FB.api('/me', function(response) {
    console.log('Good to see you, ' + response.name + '.');
    var state = response.name;
    return response.name;

});
} 
```

**一些功能**

```
 $("#id").click(function() {
      if (response.name == "Kryptonite Dove") {
        // Do something
      }
   }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:47:18.643

您正在尝试访问`response`，这是不同函数中的局部变量（请参阅：[https](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures) ://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures ）。所以你可以做的一件事是将它分配给一个全局变量，然后在你的另一个函数中访问它。

```
var saved_response;

function testAPI() {
  console.log('Welcome!  Fetching your information.... ');
  FB.api('/me', function(response) {
      console.log('Good to see you, ' + response.name + '.');
      var state = response.name;
      saved_response = response;

      return response.name;
  });
}

$("#id").click(function() {
   if (saved_response.name == "Kryptonite Dove") {
     // Do something
   }
}); 
```

# function - 2 并行执行的函数

> ID：15534322
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:43:24.277
> 
> 标签：function, dice

好的，这是我第一次在这里提问，所以如果这不是一个好问题，请不要生气。我有 6 个函数代表正在滚动的骰子的图像。我必须制作一个用于编程的掷骰子游戏。游戏本身运行得很好，但我必须让骰子并排显示，而不是放在一起。例如：

```
I have this:
+------+
|  *   |
|  *   |
+======+
+------+
|  *   |
|  *   |
+------+

I need this:
+------+  +------+
|  *   |  |  *   |
|  *   |  |  *   |
+------+  +------+

Here is my program so far:

import random

def roll_dice1():
    print "+-------+"
    print "|       |"
    print "|   *   |"
    print "|       |"
    print "+-------+"
def roll_dice2():
    print "+-------+"
    print "| *     |"
    print "|       |"
    print "|     * |"
    print "+-------+"    

def roll_dice3():
    print "+-------+"
    print "| *     |"
    print "|   *   |"
    print "|     * |"
    print "+-------+"    

def roll_dice4():
    print "+-------+"
    print "| *   * |"
    print "|       |"
    print "| *   * |"
    print "+-------+"    

def roll_dice5():
    print "+-------+"
    print "| *   * |"
    print "|   *   |"
    print "| *   * |"
    print "+-------+"

def roll_dice6():
    print "+-------+"
    print "| * * * |"
    print "|       |"
    print "| * * * |"
    print "+-------+"    

def dice_roll():
    counter = 0
    dice = []
    while counter < int(2):
        dice += [random.randint(1,6)]
        counter += 1    
    i = 0 
    while i < 2:
        if dice[i] == 1:
            roll_dice1()
        elif dice [i] == 2:
            roll_dice2()
        elif dice [i] == 3:
            roll_dice3()
        elif dice [i] == 4:
            roll_dice4()
        elif dice [i] == 5:
            roll_dice5()
        elif dice [i] == 6:
            roll_dice6()     
        i += 1    
    roll = dice
    return roll

def point_cycle():
    raw_input( "Press <Enter> to roll the dice")
    roll = dice_roll()
    total1 = int(roll[0]) + int (roll[1])  
    if total1 == 7:
        print "You rolled a 7."
        print "You lose!"
    elif total1 == total:
        print "You rolled a " + str(total1)
        print "You win!"
    else:
        print "You rolled a " + str(total1)
        point_cycle()

def main():
    print "Craps: A Popular Dice Game"
    raw_input( "Press <Enter> to roll the dice")
    roll = dice_roll()
    total = int(roll[0]) + int (roll[1])
    if total == 7 or total == 11:
        print "You rolled a " + str(total) + " on your first roll."
        print "You win!"
    elif total == 2 or total == 3 or total == 12:
        print "You rolled a " + str(total) + " on your first roll."
        print "You lose!"
    else:
        print "You rolled a " + str(total) + " on your first roll."
        print " "
        print "Thats your point. Roll it again before you roll a 7 and lose!"
        point_cycle()
    global total    

main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:01:01.800

假设您使用的是 python，一个快速而肮脏的解决方案可以帮助您入门：

```
# Save the dices in a way that allows you to access each line separatedly
DICES = (None, 
         ("+-------+", "|       |", "|   *   |", "|       |", "+-------+"),  # dice 1
         ("+-------+", "| *     |", "|       |", "|     * |", "+-------+"),  # dice 2
         <put here the tuples with the other lines of each dice>) 
```

并使用这样的功能：

```
def print_dices(diceslist):
    for i in range(5):
        for dicenum in dicelist:
            print DICES[dice][i] + " ",
        print 
```

打印您想要的骰子，其中 diceslist 是结果列表，例如：(1,3,4)

当然还有更优雅/优化的解决方案，但是这个很简单，可能会为您指明一个可接受的方向

# tfs - TFS MSBuild 将文件从网络位置复制到构建目录

> ID：15534328
> 
> 赞同：0
> 
> 时间：2013-03-20T20:43:38.317
> 
> 标签：tfs, msbuild

我们正在使用 TFS 来构建我们的解决方案。我们有一些帮助文件没有包含在我们的项目中，因为我们不想授予我们的文档编写者访问源代码的权限。这些文件被放置在我们网络上的一个文件夹中。

当构建开始时，我们希望该过程从网络位置获取文件并将它们放入作为源代码一部分的帮助文件夹中。

我在名为 CopyDirectory 的构建过程的 xaml 中找到了一个活动。我认为这可能有效，但我不确定要在 Destination 和 Source 属性中放置什么值。每次成功构建后，都会将构建复制到网络位置。我们想将文件从一个网络位置复制到新的构建目录中。

我可能以错误的方式处理这个问题，但任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:18:57.657

首先，您可能需要考虑您的文档作者将他的文档放在 TFS 中。您可以授予他对单独文件夹或项目的访问权限，而无需授予对您的源代码的访问权限。这样做的好处是：

*   一切都在源代码控制中。放在网络文件夹中的文件很容易放错地方或损坏，并且您没有更改它们的历史记录。任何项目的理想情况是，与项目相关的所有内容都在源代码控制中捕获，因此您可以在需要时提取完整的历史版本。
*   您可以将文档映射到构建服务器上的不同本地文件夹，这样只需执行源代码的“get”即可自动将文档准确复制到需要的位置。

缺点是您可能需要额外的 CAL 才能让他这样做。

另一种（更费力的）方法是让他保存到网络位置，并让开发人员定期将新文件检查到 TFS 中。如果文档不经常更新，这可能是一个可以接受的折衷方案。

但是，如果您希望在构建期间从网上复制文档，您可以使用 MSBuild`Copy`命令之一（您已经知道），或者您可以使用`Exec`. 复制命令使用起来更复杂，因为它们通常填充有从其他构建目标的输出生成的文件名列表，并且通常与解决方案相关的路径名一起使用。但是，如果您对 DOS 命令（xcopy/robocopy）感到满意，那么您可能会发现使用 Exec 运行 xcopy/robocopy 命令要容易得多。然后，您可以在 MSBuild 环境之外“开发”和测试 xcopy 命令，然后将其粘贴到 MSBuild 脚本中，确信它会起作用 - 比在完整构建过程中试用复制设置要容易得多。

Exec[记录在这里](http://msdn.microsoft.com/en-gb/library/x8zx72cd.aspx)。该示例很好地显示了如何执行您想要的操作，但在您的情况下，您可能只需将 Command 属性替换为您想要使用的整个 xcopy/robocopy 命令（甚至是批处理文件的名称），这样您就不会了t 需要设置 ItemGroup 等。

# c# - C#确定IP地址是否代表真实主机

> ID：15534329
> 
> 赞同：0
> 
> 时间：2013-03-20T20:43:44.130
> 
> 标签：c#, ip-address, verification, hostname

问题：应用程序中有一个输入字段，用户可以在其中输入主机名或 IP 地址。我需要判断输入的地址是否对应于真实主机。

我不是在谈论简单的正则表达式检查或 IPAddress.TryParse 或 Uri.CheckHostName。检查主机名没有困难：如果无法解析为 IP 地址，则 Dns.GetHostEntry 将引发异常。那是小菜一碟。

*然而*。如果我得到一个 IP 地址输入，那么如果我进行 Dns.GetHostAddresses 调用它总是会成功，即使我输入一个愚蠢的 IP，比如“1.1.1.1”（“1.1.1.1”是 IANA 保留的 IP 地址，我们的 DNS 服务器报告“不存在的主机/域”）。Dns.GetHostAddresses 立即吐出我刚刚传入的 IP，就好像一切都会好起来一样。

我也不能使用 Dns.GetHostEntry，因为有一些 IP 地址（比如我在本地网络上的虚拟机）没有任何与它们关联的 DNS 主机名，但它们仍然有有效的 IP 地址，并且 Dns.GetHostEntry会向那些抛出异常（我猜它会尝试为他们解析主机名？）。

我需要一个方法调用，它实际上告诉我它是否是虚假 IP，即使它看起来像好的 IP 地址（通过 Uri.CheckHostName），但它没有相应的 DNS 主机名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:20:18.390

您可以进行的唯一合理检查是 IP 是否是某种保留 IP。否则，您无能为力——即使缺少“ping”（ICMP）响应和知名端口（如 HTTP - 80）上的响应也没有任何意义。

保留如下：

*   127.0.0.0/8 - 环回（可能会或可能不会被视为“有效主机”）
*   224.0.0.0 - 239.255.255.255 - 多播（不太可能被视为“有效主机”）
*   子网中的全零/全一（即 192.168.1.0 和 192.168.1.255 用于 192.168.1.0/24 子网）全部/广播 - 显然与特定方式无关。

检查[IP4 子网划分](http://en.wikipedia.org/wiki/IPv4_subnetting_reference)和链接的 RFC 以获取有关特殊范围/IP 的更多信息。

# c# - DataGridView 和记录 ID C#

> ID：15534330
> 
> 赞同：0
> 
> 时间：2013-03-20T20:43:45.483
> 
> 标签：c#, database, datagridview, sqldataadapter

我想我需要澄清一下 (My)SqlDataAdapter 的工作原理。我有一个 DGV，用于显示 MySQL 表中的一列；但是，当我需要编辑记录时，我需要大多数其他字段，并且我在另一个 winform 中执行此操作。所以我想我需要一些最佳实践建议：

问题1：绑定到数据源时：我需要在表单中选择我想要编辑的所有字段吗？

```
string query = "SELECT * FROM cusdata";
cusAdapter = new MySqlDataAdapter(query,pppDB.sqlConn);         
cusAdapter.Fill(mainSet,"cusdata");
dgv_cusData.DataSource = mainSet.Tables["cusdata"] 
```

问题 2：我在网上看到很多关于只选择要在 DGV 中显示的字段的信息，但是如果我编辑该数据，适配器如何确切知道后端正在更新哪些记录？

我想我对不同的方法有点困惑，我需要一些指导。我想要一个可以显示单列（客户名称）的数据网格视图。我希望能够以另一种形式编辑客户记录，并在成功完成数据库操作后使用新信息刷新 DVG。

到今天为止，我已经度过了一个周末最好的部分，以找到一篇文章或博客或一些可以证明这一点的东西。列表形式范式。有人可以指出我正确的方向吗？非常感谢社区。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:42:36.267

根据经验，您不应选择所有字段，而应仅选择您需要的字段

```
Select CustId, CustName, CustAddress, CustPhone from cusdata 
```

这会影响性能。

当您编辑数据时，您可以使用以下代码：

```
string connectionString = "[Put your connection string here]";
using (SqlConnection conn = new SqlConnection(connectionString))
    {
        conn.Open();
        using (SqlCommand cmd = new SqlCommand("UPDATE cusdata SET CustName=@CustName, CustAddress=@CustAddress WHERE CustId=@CustId", conn))
        {
            cmd.Parameters.AddWithValue("@CustId", 1);
            cmd.Parameters.AddWithValue("@CustName", "Name Input");
            cmd.Parameters.AddWithValue("@CustAddress", "Address input");

            int rows = cmd.ExecuteNonQuery();

            //rows number of record got updated
        }
    } 
```

这部分代码让您指定要在表中更新的字段和数据

```
cmd.Parameters.AddWithValue("@CustId", 1);
cmd.Parameters.AddWithValue("@CustName", "Name Input");
cmd.Parameters.AddWithValue("@CustAddress", "Address input"); 
```

# jquery - 如何使用 jQuery 访问这些元素以在单击时添加和删除类？

> ID：15534332
> 
> 赞同：1
> 
> 时间：2013-03-20T20:43:47.590
> 
> 标签：jquery, jquery-selectors, siblings

我有许多通过 for 循环动态创建的无序列表。问题是我无法仅针对此 ul 中的元素，它一直在更改每个元素的 active 类。我很难理解什么是兄弟姐妹，什么是堂兄弟等等。我尝试了最接近（），兄弟姐妹（），上一个（），查找（）以及它们的一些不同组合，但似乎无法工作出去。 [http://jsfiddle.net/T3cm4/](http://jsfiddle.net/T3cm4/)

这是HTML

```
<ul>
    <li><a href="#" class="button active">Option 1</a></li>
    <li><a href="#" class="button">Option 2</a></li>
    <li><a href="#" class="button">Option 3</a></li>
    <li><a href="#" class="button">Option 4</a</li>
</ul> 
```

JS

```
var set_active = $('.button');
set_active.on('click', function() {
  var $this = $(this);
  var others = set_active.not($this);

  $this.addClass('active');
  others.removeClass('active');

// this will remove all other active 
// states, what do I need to add so 
// it only selects the siblings?

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:48:09.983

您可以将其简化为：

```
$('.button').click(function () {
    $(this).parents('ul').find('a.button').removeClass('active');
    $(this).addClass('active');
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/T3cm4/2/)**

这会将点击处理程序分配给带有按钮类 ( `.button`) 的链接。单击后，它会向上`ul`找到它找到的第一个父元素，然后它会向下搜索所有`a.button`元素子元素并从所有元素中删除活动类。然后它将活动类应用于刚刚单击的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:46:06.553

你可以绑定它

```
$('.button').on('click', function(e) {
    $('.button').removeClass('active'); //remove all classes
    $(this).addClass('active');  //add it to the clicked one
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:55:32.967

在您的示例中，`this`, 是一个`<a>`元素。它是元素的子`<li>`元素，没有兄弟姐妹。兄弟姐妹将是*相同* `<li>`的其他孩子。您试图访问的是`<this>`. 选择这些，然后从中删除活动类的基本方法是使用以下行：

```
$(this).parent().siblings().children().removeClass('active'); 
```

`$(this).parent()``<li>`返回作为的直接父元素的单个元素`<a>`，返回作为子元素的元素`$(this).parent().siblings()`的所有*其他*子`<ul>`元素的数组`<li>`，并`$(this).parent().siblings().children()`返回这些元素的所有子元素的数组，即所有元素的数组您正在寻找的元素。如您在其余答案中所见，还有许多其他方法可以选择所有这些元素。

在这些选择器中的任何一个中，都可以通过向方法添加参数来过滤返回的内容。例如，如果我们只想要父`<li>`类中具有“foo”类的兄弟姐妹，我们可以使用`$(this).parent().siblings('.foo')`来获取这些元素的数组。

`.find(selector)`将挖掘所有后代（孩子、孙子、曾孙等）并返回与选择器匹配的所有元素的数组，这就像`'.foo'`我们看到的选择器，它是一种使用“ foo" 类在前面的例子中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:46:44.297

尝试将其他设置为：

```
var others = set_active.parents('ul:eq(0)').find('.button').not($this); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T20:49:43.020

```
$('ul li a').first().addClass('active');
$('ul li a').on('click', function() {
  var parents = $(this).parents('ul');
  $('li a', parents).removeClass('active');
  $(this).addClass('active');
}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-20T20:49:37.973

将活动类添加到单击的元素从其他元素中删除。 [jsfiddle](http://jsfiddle.net/T3cm4/3/)

```
var set_active = $('.button');
set_active.on('click', function() {
  set_active.parents("ul:first").find(".active").removeClass("active");   
  $(this).addClass('active'); 
```

});

# nant - 南特贡献 任务

> ID：15534335
> 
> 赞同：0
> 
> 时间：2013-03-20T20:43:51.613
> 
> 标签：nant, nantcontrib

我正在尝试将日志文件附加到电子邮件。

我的代码是：

```
**<loadtasks assembly=".../tasks.dll" />
<record name="c:foo\log.txt" action="Start" />
<target name="email">
<mail
      from="abc@foo.com"
      tolist="xyz@foo.com"
      subject="Build"
      message="Build Failed"
      mailhost="smtp.anywhere.net">
      <files>
        <include name="c:foo\log.txt" />
      </files>
      <attachment>
        <include name="c:foo\log.txt" />
      </attachment>
    </mail>
</target>
<record name="c:foo\log.txt" action="Close" />** 
```

我的命令是：

```
nant -f:filename.build email -l:c:foo\log.txt 
```

我收到以下错误：

```
System.Security.SecurityException: Request for the permission of type 'System.Se
curity.Permissions.FileIOPermission, mscorlib, Version=4.0.0.0, Culture=neutral,
 PublicKeyToken=b77a5c561934e089' failed.
   at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMa
rk& stackMark, Boolean isPermSet)
   at System.Security.CodeAccessPermission.Demand()
   at System.IO.FileSystemInfo.get_FullName()
   at NAnt.Contrib.Tasks.RecordTask.ExecuteTask()
   at NAnt.Core.Task.Execute()
   at NAnt.Core.Project.InitializeProjectDocument(XmlDocument doc)
   at NAnt.Core.Project.Execute()
   at NAnt.Core.Project.Run() 
```

当我不使用`<record>`任务时，它会出现另一个错误，例如无法附加 txt 文件。bcoz 它被另一个进程使用。

为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T23:15:05.657

在尝试通过电子邮件发送文件之前，请确保文件已关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T03:36:24.797

我做了类似刷新记录任务的事情，就在发送电子邮件之前，然后将文件复制到电子邮件中，希望这个解决方法有效

```
 <echo>${emailsubject}</echo>    
    <echo>Sending Email</echo>
    <echo>Attaching File : ${build.log.dir}/email_${build.log.filename}</echo>
    <echo>Attaching File : ${path.vsshelper.log}/logs/email_${build.log.getlistoffiles}</echo>

    <record name="${build.log.dir}/${build.log.filename}"       action="Flush" level="Verbose"/>
    <sleep milliseconds="5000" />
    <copy file= "${build.log.dir}/${build.log.filename}" tofile="${build.log.dir}/email_${build.log.filename}" />   
    <copy file= "${path.vsshelper.log}/logs/${build.log.getlistoffiles}" tofile="${path.vsshelper.log}/logs/email_${build.log.getlistoffiles}" /> 
```

# mysql - 在 SELECT 语句中运行用户定义的函数 - MySQL

> ID：15534343
> 
> 赞同：0
> 
> 时间：2013-03-20T20:44:24.860
> 
> 标签：mysql, function, select

我有一个简单的表，名为`unzip`. 它具有如下三列 -: `id INT UNSIGNED NOT NULL AUTO_INCREMENT`, `share_src VARCHAR(30) NULL`, `creator INT UNSIGNED NOT NULL`。

我还有一个调用的函数`checkSrc`，它返回`no`或`yes`当 share_src 作为参数提供给它时​​。

我想返回创建者为`10`AND（`share_src is null`或 `the result from the function checkSrc is yes`）的所有行。

目前我正在这样做

```
SELECT * FROM unzip WHERE creator = 12 AND (share_src IS NULL || checkSrc(share_src) = 'yes'); 
```

但这会导致错误。查询中有什么问题？非常感谢帮助。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:59:50.577

SELECT * FROM unzip WHERE creator = 12 AND (share_src IS NULL 或 checkSrc(share_src) = 'yes');

试着让我知道。

检查函数是否返回正确的数据类型。检查它是否返回字符串类型。

# python - Python 2.7 并基于一个公共值连接两个数组

> ID：15534351
> 
> 赞同：0
> 
> 时间：2013-03-20T20:44:52.053
> 
> 标签：python, arrays, python-2.7

我有两个数组。第一个来自 SQL Server，是救护车配置（工作、可用等）。第二个是那些救护车的 xy 坐标。我想根据救护车的名称加入这两个阵列。例如：

```
[M01, working], [M02, free]
[M01, 446, 267], [M02, 452, 176] 
```

应该像下面这样连接在一起：

```
[M01, working, 446, 267]
[M02, free, 452, 176] 
```

我是如此接近，但我就是无法到达那里。我收到的错误消息是：回溯（最近一次通话）：

```
File "C:\Documents and Settings\kulpandm\My 
Documents\EclipseCode\PyLearning\FireStations4.py", line 83, in <module>
res = [r1 + r2 for r1 in t1 for r2 in t2 if r1[1] == r2[0]]
IndexError: string index out of range 
```

下面显示的是我的代码：

```
import pyodbc

cnxn = pyodbc.connect('DRIVER={SQL Server}; SERVER=xxxxxx; DATABASE=xx; UID=xx; PWD=xx')
cursor = cnxn.cursor()
AmbulanceStatus = """
WITH Maxtimes AS
(
SELECT
  MAX(M_Manpower_PK) AS [FirstRecord]
, PUN_UnitID
FROM MManpower
INNER JOIN PUnit ON M_kUnit = PUN_Unit_PK
WHERE PUN_UnitID LIKE 'M__'
AND M_tTime > DATEADD(HOUR, -24, GETDATE())
GROUP BY PUN_UnitID
)
,
MaxAttributes AS
(
SELECT
  M_Manpower_PK
, M_tTime
, M_Code
, CASE 
  WHEN M_Code IN ('USTA', 'USER', 'USOL', 'USAR', 'USIZ', 'UF', 'USTR', 'USDP') THEN 'Working'
  WHEN M_Code IN ('USAQ', 'USRQ') THEN 'Free'
  WHEN M_Code IN ('USES', 'USSB', 'USAS', 'USRS', 'USLC') THEN 'Standby'
  WHEN M_Code IN ('USOS') THEN 'OutofService'
  ELSE 'NA'
  END AS [Disposition]
FROM MManpower
INNER JOIN PUnit ON M_kUnit = PUN_Unit_PK
WHERE PUN_UnitID LIKE 'M__'
AND M_tTime > DATEADD(HOUR, -24, GETDATE())
)

SELECT
  MaxTimes.firstRecord AS [RecordNumber]
, MaxTimes.PUN_UnitID AS [Ambulance]
, CONVERT(VARCHAR(20), MaxAttributes.M_tTime, 108) AS [FinalTimeStamp]
, MaxAttributes.M_Code AS [UnitStatus]
, MaxAttributes.Disposition AS [Disposition]
FROM Maxtimes
LEFT OUTER JOIN MaxAttributes ON Maxtimes.FirstRecord=MaxAttributes.M_Manpower_PK
"""

cursor.execute(AmbulanceStatus)
t1 = []
t1 = str(cursor.fetchall())
cursor.close()

print t1

# These are hard-coded values if you want to use this as an experiment. This data is output from SQL Server query
#===============================================================================
# t1 = [['M01', 'Working'],
#               ['M02', 'NA'],
#               ['M03', 'Free'],
#               ['M04', 'Working'],
#               ['M05', 'Free'],
#               ['M06', 'Free'],
#               ['M07', 'Free'],
#               ['M08', 'Working'],
#               ['M09', 'Free'],
#               ['M10', 'Free']]
#===============================================================================
# grid coordinates of ambulance stations
t2 = [['M01', 446, 267], ['M16', 28, 45], ['M37', 504, 546], ['M13', 514, 491], ['M06', 589, 538],
                ['M04', 353, 264], ['M30', 372, 216], ['M14', 359, 125], ['M28', 319, 164], ['M26', 519, 138],
                ['M02', 452, 176], ['M03', 474, 155], ['M23', 536, 221], ['M18', 478, 212], ['M11', 546, 112],
                ['M21', 534, 431], ['M31', 430, 95], ['M15', 347, 341], ['M08', 419, 331], ['M20', 409, 278],
                ['M27', 375, 327], ['M12', 387, 161], ['M22', 338, 190], ['M40', 446, 245], ['M10', 179, 207],
                ['M09', 497, 381], ['M33', 459, 346], ['M25', 543, 394], ['M05', 224, 417], ['M19', 520, 85],
                ['M24', 359, 125], ['MT01', 370, 178], ['FBA31', 370, 178],
                ['FBA32', 363, 365], ['FBA33', 415, 444], ['D1', 442, 191],
                ['M07', 431, 145], ['M17', 404, 63], ['LAR104', 659, 216],
                ['LAR103', 612, 204], ['LAR102', 700, 231], ['LAR101', 738, 170]]

# loop through to join the two data sets like a SQL LEFT OUTER JOIN. It works with an array t1 commented out above,
# but it will not work with database output from my sql query.
res = [r1 + r2 for r1 in t1 for r2 in t2 if r1[1] == r2[0]]

for ambulance in res:
    print ambulance 
```

问题：如何让这两个数组像 SQL Server 中的 INNER JOIN 一样连接起来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:02:50.963

我想你只是把你的指数弄混了。

```
>>>res = [r1 + r2 for r1 in t1 for r2 in t2 if r1[0] == r2[0]]
>>>print res
[['M01', 'Working', 'M01', 446, 267], ['M02', 'NA', 'M02', 452, 176], ['M03', 'Free', 'M03', 474, 155], ['M04', 'Working', 'M04', 353, 264], ['M05', 'Free', 'M05', 224, 417], ['M06', 'Free', 'M06', 589, 538], ['M07', 'Free', 'M07', 431, 145], ['M08', 'Working', 'M08', 419, 331], ['M09', 'Free', 'M09', 497, 381], ['M10', 'Free', 'M10', 179, 207]] 
```

如果你想摆脱重复的 id 只需切片第二个列表：

```
>>>res = [r1 + r2[1:] for r1 in t1 for r2 in t2 if r1[0] == r2[0]]
>>>print res
[['M01', 'Working', 446, 267], ['M02', 'NA', 452, 176], ['M03', 'Free', 474, 155], ['M04', 'Working', 353, 264], ['M05', 'Free', 224, 417], ['M06', 'Free', 589, 538], ['M07', 'Free', 431, 145], ['M08', 'Working', 419, 331], ['M09', 'Free', 497, 381], ['M10', 'Free', 179, 207]] 
```

编辑：看起来 Bartlomiej 打败了我。

# c# - 通过按钮单击事件设置应用程序的背景图像

> ID：15534353
> 
> 赞同：0
> 
> 时间：2013-03-20T20:44:54.177
> 
> 标签：c#, xaml, windows-8, microsoft-metro, winrt-xaml

当按下按钮时，应用程序的背景图像必须可以更改为项目中的图像。

我试图通过修改 XAML 图像控件的可见性来设置背景图像，该控件的源指向项目中的图像。但在这种情况下，问题是图像在设置可见性 = true 时隐藏了一些 XAML 控件。我尝试设置“发送到后面”和不透明度选项，但没有用。

请告知，如果有解决此问题的方法或帮助我使用正确的图像 XAML 属性来实现我的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:51:10.820

您可以使用 将`VisualBrush`图像设置为根元素的背景（在本例中为网格）。在您的代码中，按下按钮时将`BackgroundImage`属性设置为您的图像路径，如果您对此属性有某种类型的更改通知，则图像将被更改。

```
 <Grid.Background>
        <VisualBrush TileMode="None" Opacity="{Binding BackgroundOpacity}">
            <VisualBrush.Visual>
                <Image Source="{Binding BackgroundImage}"></Image>
            </VisualBrush.Visual>
        </VisualBrush>
    </Grid.Background> 
```

# c# - 从服务器调用时，RenderControl 会导致 NullReferenceException

> ID：15534357
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:08.233
> 
> 标签：c#, asp.net, asp.net-4.0

一些背景信息：我正在尝试从运行在 ASP.NET 服务器上的线程（在 Appication_Start 中开始）发送包含许多图表的 HTML 电子邮件。

在最简单的形式中，我有以下代码，从服务器上运行的线程调用：

```
StringBuilder sb = new StringBuilder();
StringWriter tw = new StringWriter(sb);
HtmlTextWriter hw = new HtmlTextWriter(tw);

Chart c = new Chart();
c.RenderControl(hw); <-- NullReferenceException 
```

调试信息：

```
 StackTrace:
           at System.Web.UI.DataVisualization.Charting.ChartHttpHandler.GetHandlerUrl()
           at System.Web.UI.DataVisualization.Charting.ChartHttpHandler.GetUrl(String query, String fileKey, String currentGuid)
           at System.Web.UI.DataVisualization.Charting.ChartHttpHandler.GetChartImageUrl(MemoryStream stream, String imageExt)
           ... 
```

当我从任何 aspx 页面调用这段代码时，没有问题。同样为标签调用 RenderControl() 也没问题。

我怀疑在调用 Chart 对象的 RenderControl() 函数之前需要初始化一些变量，并且当从 aspx 页面调用此函数时，这些变量会自动到位。

那么我的问题是，RenderControl() 需要哪些变量/对象才能成功执行？

# c++ - C++ - WINAPI - 可能与 std::map 冲突？

> ID：15534359
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:15.000
> 
> 标签：c++, winapi, window, conflict, stdmap

在尝试找到处理窗口消息的合适解决方案时，我在 StackOverflow 上遇到了这个问题：

[面向对象的c++ win32？](https://stackoverflow.com/questions/3380294/object-oriented-c-win32)

答案提供了很好的解决方案，我个人最喜欢的是使用 std::map 的公认答案。

但是，每当我在我的代码中使用 std::map 时，它看起来像这样：

```
#include <cstdio>
#include <map>
#include <windows.h>
#include <helixirrwidgets/Window.hpp>
using namespace HelixirrWidgets;

/// ----------------------------
/// @class  Window
/// @brief  Represents a window.
/// ----------------------------
/// Inner classes:
class Window::Helper{
public:

    /// Constructors & destructors:
    Helper(void) : active(false), created_window(false), handle_instance(GetModuleHandle(NULL)), handle_window(nullptr), message({0}){
        _ms_mopopHelpers.insert({handle_window, this});
    }
    Helper(Helper const& helper_) : active(false), created_window(false), handle_instance(helper_.handle_instance), handle_window(helper_.handle_window), message(helper_.message){
        _ms_mopopHelpers.insert({handle_window, this});
    }
    Helper(Helper&& helper_) : active(false), created_window(false), handle_instance(std::move(helper_.handle_instance)), handle_window(std::move(helper_.handle_window)), message(std::move(helper_.message)){
        helper_.handle_instance = nullptr;
        helper_.handle_window = nullptr;
        _ms_mopopHelpers.insert({handle_window, this});
    }
    ~Helper(void){
        handle_instance = nullptr;
        handle_window = nullptr;
        _ms_mopopHelpers.erase(handle_window);
    }

    /// Member data:
    bool mutable active, created_window;
    HINSTANCE mutable handle_instance;
    HWND mutable handle_window;
    MSG message;

    /// Member functions (overloaded operators, assignment):
    Helper& operator=(Helper const& helper_) = default;
    Helper& operator=(Helper&& helper_) = default;

    /// Static member functions:
    static LRESULT CALLBACK handle_callback(HWND handle_window_, UINT message_, WPARAM wparam_, LPARAM lparam_){
        if(_ms_mopopHelpers.size() != 0){
            // Delegate message handling:
            return _ms_mopopHelpers[handle_window_]->_handle_callback(message_, wparam_, lparam_);
        }
        return 0;
    }

private:
    /// Member functions:
    LRESULT _handle_callback(UINT message_, WPARAM wparam_, LPARAM lparam_){
        switch(message_){
            case WM_DESTROY:
                active = false;
                DestroyWindow(handle_window);
                return 0;
            default:
                return DefWindowProc(handle_window, message_, wparam_, lparam_);
        }
    }
    /// Static member data:
    static std::map<HWND, Window::Helper*> _ms_mopopHelpers;
};
    /// Static member data:
    std::map<HWND, Window::Helper*> Window::Helper::_ms_mopopHelpers = {};
/// Constructors & destructors:
Window::Window(void) : _m_bVisible(false), _m_opHelper(new Window::Helper){

}
Window::Window(Window const& window_) = default;
Window::Window(Window&& window_) = default;
Window::Window(std::string const& name_) : _m_bVisible(false), _m_opHelper(new Window::Helper), _m_oName(name_){

}
Window::Window(std::string&& name_) : _m_bVisible(false), _m_opHelper(new Window::Helper), _m_oName(std::move(name_)){

}
Window::~Window(void) = default;
/// Member functions:
bool const& Window::active(void) const noexcept{
    return _m_opHelper->active;
}
Window& Window::save_changes(void){
    // Create and register window class:
    static bool __registered_class_window = false;
    static WNDCLASSEX __class_window = {
        sizeof(WNDCLASSEX),
        CS_HREDRAW | CS_VREDRAW,
        Window::Helper::handle_callback,
        0, 0,
        _m_opHelper->handle_instance,
        LoadIcon(_m_opHelper->handle_instance, NULL),
        LoadCursor(NULL, IDC_ARROW),
        reinterpret_cast<HBRUSH>(GetStockObject(BLACK_BRUSH)),
        NULL,
        "Helixirr Widgets Window Class Basic",
        LoadIcon(_m_opHelper->handle_instance, NULL)
    };
    if(!__registered_class_window){
        RegisterClassEx(&__class_window);
        __registered_class_window = true;
    }

    // If window hasn't been created yet:
    if(!_m_opHelper->created_window){
        _m_opHelper->created_window = true;
        _m_opHelper->handle_window = CreateWindowEx(
            0,
            "Helixirr Widgets Window Class Basic",
            _m_oName.c_str(),
            WS_OVERLAPPEDWINDOW,
            _m_uiPos[0], _m_uiPos[1],
            _m_uiSize[0], _m_uiSize[1],
            NULL, NULL, _m_opHelper->handle_instance, NULL
        );
    }
    _m_opHelper->active = true;
    return *this;
}
void Window::show(void){
    if(_m_opHelper->active){
        if(GetMessage(&_m_opHelper->message, NULL, 0, 0)){
            // Handle messages:
            TranslateMessage(&_m_opHelper->message);
            DispatchMessage(&_m_opHelper->message);

            // Handle window displaying:
            ShowWindow(_m_opHelper->handle_window, SW_SHOWDEFAULT);
            UpdateWindow(_m_opHelper->handle_window);
            return;
        }
    }
} 
```

我的窗户由于某种原因没有打开。在切断与 std::map 的所有连接后，窗口再次显示得很好。是什么导致了这种奇怪的现象？很难相信会有某种冲突。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:12:47.533

从您的 Window::show 方法来看，问题可能是您没有消息循环。正常的消息循环如下所示：

```
MSG msg = {};

while (GetMessage(&msg, nullptr, 0, 0))
{
    TranslateMessage(&msg);
    DispatchMessage(&msg);
} 
```

但是您的 Window::show 方法只执行一次，因此窗口可能不会获得实际显示窗口所需的消息。

# servicestack - Swagger UI 和 ServiceStack

> ID：15534363
> 
> 赞同：3
> 
> 时间：2013-03-20T20:45:42.863
> 
> 标签：servicestack, swagger

服务堆栈是否支持 Swagger 中的模型。在下面的示例代码中

```
[Route("/User", "GET", Summary = "Get all the users available")]
[Route("/User", "POST, PUT", Summary = "Create a new user")]
[Route("/User/{Id}", "GET", Summary = "Get user with a specific id")]
public class User : RequestBase, IReturn<UserResponse>
{
    [ApiMember(Name = "Id", Description = "The User Id", ParameterType = "path", DataType = "int", IsRequired = false)]
    public int Id { get; set; }

    [ApiMember(Name = "UserData", Description = "The User Data", ParameterType = "body", DataType = "complex", IsRequired = false)]
    public UserData Entry { get; set; }
} 
```

我希望 UserData 是复杂类型或容器类型。但是，如果我将其定义为其中之一，我在 SwaggerUI 中得到的只是一个文本区域框。我没有得到我在 petstore 在线示例中看到的 Model 和 ModelSchema 链接。

[http://petstore.swagger.wordnik.com/#!/pet/addPet_post_1](http://petstore.swagger.wordnik.com/#!/pet/addPet_post_1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T13:04:16.540

从最新的 ServiceStack 版本开始，正确支持“body”类型的参数。您需要设置`DataType = "User"`第二个`ApiMember`属性。这将允许 Swagger UI 正确显示模型架构信息。此外，对于简单类型，您可以在类中使用常量`SwaggerType`；例如，您可以将第一个`Apimember`属性更改为 have `DataType = SwaggerType.Int`。

# java - 编写作为 Vector 子类的类，java

> ID：15534364
> 
> 赞同：-2
> 
> 时间：2013-03-20T20:45:44.247
> 
> 标签：java, vector, constructor

只是希望我能让有人告诉我我这样做是否正确，因为我以前从未写过这样的东西。所以我必须编写一个名为 ProcessQueue 的类，它是 Vector 的子类，以及一个定义空队列的构造函数。Vector 也将保存“Object”类型的项目。所以这里...

```
public class ProcessQueue<Vector>{

ProcessQueue(){}

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T20:48:21.193

不，这是不对的。这是通用的，不是扩展的。

此外，这不是一个好主意。您`ProcessQueue`可能在下面有某种集合，但它不需要扩展。更喜欢组合而不是继承。

如果你必须实现*某些东西*，首先要有一个看起来像`Queue`. 有某种行为是预期的；确保你的符合它。最好的方法是实现一个强制它的接口。

```
public class ProcessQueue<T> implements Queue<T> {
   // Have a private collection of some sort that provides the behavior that the interface requires
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T20:48:00.217

你没有扩展到`Vector`任何地方。将您的代码更改为：

```
public class ProcessQueue<T> extends Vector<T> {

} 
```

顺便说一句，我不建议你使用`Vector`。检查[为什么 Java Vector 类被认为已过时或不推荐使用？](https://stackoverflow.com/q/1386275/1065197). IMO 如果你必须这样做，它会更好地扩展`ArrayList`。

```
public class ProcessQueue<T> extends ArrayList<T> {

} 
```

并在您的代码中使用`List`：

```
List<SomeClass> lstQueue = new ProcessQueue<SomeClass>(); 
```

U̶n̶r̶e̶l̶a̶t̶e̶d̶̶t̶o̶̶t̶h̶e̶̶o̶r̶i̶g̶i̶n̶a̶l̶̶q̶u̶e̶s̶t̶i̶o̶n̶，我认为与 duffymo 类似，您不应该扩展任何 Java Collection 类，除非它是必须做的。请注意，有很多类可以容纳几乎任何类型的常见集合，并且您拥有[`Queue`](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)并且[`PriorityQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html)可以在您的实际工作中为您提供帮助。

最好的解决方案是 duffymo 所指出的，组合而不是扩展 Java 集合：

```
public class ProcessQueue<T> {

    private List<T> data = new ArrayList<T>();

    //rest of code...
} 
```

或者创建一个新的接口实现，比如`Queue`or `List`。

```
public class ProcessQueue<T> implements Queue<T> {

    //Queue interface methods implementation...
} 
```

# python - 在 Django DB 中正确定义关系

> ID：15534365
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:46.403
> 
> 标签：python, sql, django

我正在开发一个健身游戏网络应用程序。这个想法是，每周都有一定数量的任务，一个人必须在下周公布之前完成这些任务。`models.py`到目前为止，这是我的应用程序架构：

从 django.db 导入模型 从 django.contrib.auth.models 导入用户

```
class WeekOne(models.Model):
    squats = models.PositiveIntegerField()
    lunges = models.PositiveIntegerField()
    skipStairs = models.BooleanField()
    stairDaysCount = models.PositiveSmallIntegerField()
    # Set to true if (squats == 1000), (lunges == 250), 
    # (skipStairs is True), and (stairDaysCount == 3)
    weekOneComplete = models.BooleanField()

class UserProfile(models.Model):
    user = models.OneToOneField(User)
    weekOne = models.ForeignKey(WeekOne) 
```

我迷失了几点。首先，显然我希望每个用户都能够跟踪他们自己的进度，而不是让任何其他用户看到它。做`weekOne`一个`ForeignKey`最好的方法来做到这一点？如果是这样，一旦定义了这种关系，如何访问每个用户的数据？例如，如果我想创建一个`addSquats`函数，我会这样做：

```
user = UserProfile()
user.squats += 5 
```

还是我必须做一些其他的魔术才能到达深蹲场？

其次，每次用户对他们的进度进行更改（即，增加深蹲或弓步）时，我想检查所有字段是否都达到了某个基准。如果他们有，我想设置`weekOneComplete`为true。当用户单击一个按钮时，每个添加都将由一些 javascript 触发——但是我应该把检查/更新数据库的函数放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:51:24.823

要访问第一周的字段，您需要执行以下操作：

```
user.weekOne.squats += 5
user.weekOne.save() 
```

实际上，最好使用 F 函数并执行（或类似）：

```
user.weekOne.squats = F('squates') + 5 
```

一般来说，最好在服务器端进行所有检查，而不是依赖客户端（JS 或其他）。例如，您公开一个 url 并检查所有 POST 参数是否为整数（例如转换为整数）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:07:20.890

对于您的第二个问题：由于您说您使用的是javascript，因此一种可能（且简单）的方法是通过ajax调用。

它应该指向一个 url，该 url 本身指向一个视图，该视图将处理您在请求中发送的数据。类似于（假设您正在使用 POST 请求）：

```
def add(request):
    if not request.is_ajax():
        raise ...
    excercise, amount = request.POST['excercise'], request.POST['amount']
    user = request.user

    # a model method that'll add to whatever activity 
    # the user did and update the "week one complete" field
    user.did_activity(excercise, amount) 
    if user.weekOne.weekOneComplete:
        return HttpResponse(json.dumps(some_return_data), mimetype="application/json")
    return HttpResponse(json.dumps(other_return_data), mimetype="application/json") 
```

这更偏向于伪代码，所以你明白了。您仍然需要在 JS 端编写 ajax 调用，该模型方法将添加到正确的练习和验证基准，并将用户保存到数据库。例如：

```
def did_activity(self, excercise, amount):
    if excercise == 'squats':
        self.weekOne.squats += amount
    ...
    if self.hit_benchmark():
        self.weekOne.weekOneComplete = True
    self.save() 
```

此外，此示例假定用户已通过身份验证。

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T03:11:53.287

**首先，显然我希望每个用户都能够跟踪他们自己的进度，而不是让任何其他用户看到它。**

在模板中，您可以这样做

```
 User: {{ user.username }}
 squats: {{ user.userprofile.squats }} 
 lunges: {{ user.userprofile.lunges }}
 Skip Stairs: 
    {% if user.userprofile.skipStairs %}
       Yes
    {% else %}
       No
    {% endif %}
 Stair: {{ user.userprofile.stairDaysCount }}}
 Week Completed: 
    {% if user.userprofile.weekOneComplete %}
        Yes
    {% else %}
        In-Progress
    {% endif %} 
```

**一旦定义了这种关系，如何访问每个用户的数据？例如，如果我想创建一个 addSquats 函数。**

要访问用户数据，

```
user = UserProfile(user=request.user)
user.weekOne.squats += 5
user.weekOne.save()
user.save() 
```

**其次，每次用户对他们的进度进行更改（即增加深蹲或弓步）时，我想检查所有字段是否都达到了某个基准。如果有，我想将 weekOneComplete 设置为 true。**

在您的 UserProfile 模型下，创建检查更新功能。

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    weekOne = models.ForeignKey(WeekOne)

    def check_updates(self):
        check = WeekOne.object.get(id=self.weekOne)

        if check.skipStairs and \
           check.squats == 1000 and \
           check.lunges == 250 and \
           check.stairDaysCount == 3:

           check.weekOneComplete = True
           check.save() 
```

因此，每次更新该用户的数据时，只需调用如下方法：

```
user = UserProfile.objects.get(user=request.user)
user.check_updates() 
```

# ruby - 如何获取红宝石日期对象的日期

> ID：15534369
> 
> 赞同：1
> 
> 时间：2013-03-20T20:45:51.627
> 
> 标签：ruby, date, datetime

假设我创建了一个这样的 Data 对象。

```
semester_start_date = Date.new(2013,1,15) 
```

现在我怎么能找到`semester_start_date.day == 'Thursday'`这件事的是否或任何其他日子？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:17:09.053

如果您使用的是 1.9，您应该可以这样做：

```
require 'date'

d = Date.new(2013,1,15)
d.thursday? #=> false
d.wday #=> 2
Date::DAYNAMES[d.wday] #=> "Tuesday"
d.tuesday? #=> true 
```

我假设您实际上并不是在寻找与字符串“Thursday”相同的日期对象

# oracle - Oracle：关于从远程视图过滤结果的性能

> ID：15534370
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:54.127
> 
> 标签：oracle, oracle11g, dblink

我有一个远程数据库 A，它有一个视图 v_myview。我正在开发一个本地数据库，它有一个 dblink 可以访问数据库 A 上的 v_myview。如果我像这样查询视图：

```
select * from v_myview @ dblink ; 
```

它返回 50 万行。我只想从视图中获取一些特定的行，例如，要获取 id=123 的行，我的查询是

```
select * from v_myview @ dblink where id=123; 
```

这按预期工作。我的问题来了，当我运行这个查询时，远程数据库会先生成 50 万行然后从那里找到 id=123 的行吗？或者远程视图首先应用我的过滤器然后查询数据库而不先检索 50 万行？我怎么知道。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:50:10.283

Oracle 可以自由选择。您需要查看查询计划以了解过滤是在本地还是远程完成。

据推测，在您提供的这种简单的情况下，优化器希望将过滤器发送到远程服务器而不是仅通过网络拉出 50 万行来在本地过滤它们更有效。如果优化器期望未过滤的查询返回单行而不是半百万行，则该计算可能会有所不同，并且如果查询变得更加复杂，例如加入本地表或调用本地服务器上的函数，则计算可能会有所不同.

# javascript - 如何以更复杂的方式编写它？

> ID：15534371
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:55.410
> 
> 标签：javascript, jquery, html, css

这行得通，但我确信它写得更干净。

```
<script>
$(document).ready(function(){
  $('.col').css({'height':($(document).height())+'px'});
  $(window).resize(function() {
    $('.col').css({'height':($(document).height())+'px'});
  });
}
</script> 
```

我试过没有第一个`$('.col').css...`，但它不起作用。所以基本上我想告诉浏览器的是：“当文档准备好时，调整这个 div 的大小，并在每次高度变化时继续调整它的大小”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:50:56.310

这里是：

```
<script>
    $(window).resize(function() {
        $('.col').css({'height':($(document).height())+'px'});
    });
    $(function(){
        $(window).trigger('resize');
    });
</script> 
```

您可以监听`resize`事件并在文档准备好时触发它。

其他小改动：

*   你可以`document.ready`简化`$(function(){})`
*   可以在之前创建调整大小事件侦听器`document.ready`，因为该`window`对象始终存在，您可以在需要时尽早将事件附加到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:55:34.447

或另一种变体，具有一点（我猜）更清晰的语法：

```
$(window).resize(function() {
    $('.col').height($(document).height());
}).resize(); 
```

# knitr - 使用 knitr 将绘图嵌入到 html 中

> ID：15534374
> 
> 赞同：0
> 
> 时间：2013-03-20T20:45:59.810
> 
> 标签：knitr, r-markdown

我的一位同事向我展示了一种使用 Rstudio 并将 Markdown R 脚本转换为 hmtl 的酷方法。Rscript 中的所有绘图都嵌入在 html 中，因此可以共享一个 html 文件并将完整文档包含在一个文件中。我试图在 Rstudio GUI 之外复制它，以便自动创建 html（不是由具有 GUI 的用户创建）。我尝试过 knit() 和 knit2html()，它们为我创建了 html 文件，但它们也创建了一个“figure”文件夹，我必须将其与 html 一起传递。如何将绘图和所有内容嵌入到单个 html 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:51:28.257

在 RStudio 中单击`Knit HTML`（应该是）等效于`knit2html()`in `knitr`。您确实会看到一个`figure`目录，但您可以放心地忽略它——默认情况下，您的所有绘图都嵌入在 HTML 文件中。当您与同事共享 HTML 文件时，您只需将 HTML 文件传递​​给他们。要验证这一点，只需删除`figure`目录并查看绘图是否仍在 HTML 文件中。

* * *

**2020/04/20 更新**：请忽略上面的答案。RStudio 不再调用`knitr::knit2html()`. 请参阅此帖子以获取更新：[https ://stackoverflow.com/a/10654295/559676](https://stackoverflow.com/a/10654295/559676)

# extjs - ExtJS Grid Cell 锁定 + 编辑导致异常

> ID：15534379
> 
> 赞同：1
> 
> 时间：2013-03-20T20:46:09.437
> 
> 标签：extjs, extjs4, extjs4.1

我有一个简单的网格，我想在其中锁定一些单元格。但是如果还设置了单元格编辑插件，我会收到以下错误：

类型错误：view.selModel 未定义

我的代码如下：

```
Ext.define('BT.view.EmployeeView', {
    extend: 'Ext.grid.Panel',
    alias: 'widget.employeeview',

    store: 'Employees',

    header: false,

    plugins: [
        Ext.create('Ext.grid.plugin.CellEditing', {
            clicksToEdit: 1
        })
    ],

    columns: [
        {header: 'Employee', dataIndex: 'employee', locked: true, width: 200},
        {header: 'Bonus', dataIndex: 'bonus', flex:1, xtype: 'numbercolumn',
            editor: {
                xtype: 'combobox',
                allowBlank:true,
                store: 'Months',
                displayField: 'month',
                valueField: 'value',
            }
        }   
    ]
}); 
```

如果我删除插件部分，则没有错误，并且锁定工作正常：

```
plugins: [
    Ext.create('Ext.grid.plugin.CellEditing', {
        clicksToEdit: 1
    })
], 
```

如果没有使用编辑器设置列，问题仍然相同。不知何故，插件声明搞砸了。尽管如果该数组为空，则不会再次出现错误。为什么这会导致问题，我做错了什么？

# c# - 如何在覆盖中访问超类的私有成员？

> ID：15534382
> 
> 赞同：0
> 
> 时间：2013-03-20T20:46:24.473
> 
> 标签：c#, nhibernate, overriding, private, members

我想完全像这样从 NHibernate 的 SqlClientBatchingBatcher 类继承（代码取自 [带有加密触发器的 TooManyRowsAffectedException](https://stackoverflow.com/questions/1354362/toomanyrowsaffectedexception-with-encrypted-triggers/)）：

```
public class NonBatchingBatcherWithoutVerification : SqlClientBatchingBatcher
{
    public NonBatchingBatcherWithoutVerification(ConnectionManager connectionManager, IInterceptor interceptor) : base(connectionManager, interceptor)
    {}

    protected override void DoExecuteBatch(IDbCommand ps)
    {
        log.DebugFormat("Executing batch");
        CheckReaders();
        Prepare(currentBatch.BatchCommand);
        if (Factory.Settings.SqlStatementLogger.IsDebugEnabled)
        {
            Factory.Settings.SqlStatementLogger.LogBatchCommand(currentBatchCommandsLog.ToString());
            currentBatchCommandsLog = new StringBuilder().AppendLine("Batch commands:");
        }

        int rowsAffected = currentBatch.ExecuteNonQuery();

        // Removed the following line
        //Expectations.VerifyOutcomeBatched(totalExpectedRowsAffected, rowsAffected);

        currentBatch.Dispose();
        totalExpectedRowsAffected = 0;
        currentBatch = new SqlClientSqlCommandSet();
    }
} 
```

请注意此处方法中访问的一些成员（如 currentBatch 或 totalExpectedRowsAffected）。

好吧，事实证明这些成员实际上是当前 NHibernate 3.3 源的超类中的私有成员。那么如何在不复制整个内容的情况下有效地继承类呢？顺便说一下，这是该类的未修改的 NHibernate 代码：

```
 public class SqlClientBatchingBatcher : AbstractBatcher
{
    private int _batchSize;
    private int _totalExpectedRowsAffected;
    private SqlClientSqlCommandSet _currentBatch;
    private StringBuilder _currentBatchCommandsLog;
    private readonly int _defaultTimeout;

    public SqlClientBatchingBatcher(ConnectionManager connectionManager, IInterceptor interceptor)
        : base(connectionManager, interceptor)
    {
        _batchSize = Factory.Settings.AdoBatchSize;
        _defaultTimeout = PropertiesHelper.GetInt32(Cfg.Environment.CommandTimeout, Cfg.Environment.Properties, -1);

        _currentBatch = CreateConfiguredBatch();
        //we always create this, because we need to deal with a scenario in which
        //the user change the logging configuration at runtime. Trying to put this
        //behind an if(log.IsDebugEnabled) will cause a null reference exception 
        //at that point.
        _currentBatchCommandsLog = new StringBuilder().AppendLine("Batch commands:");
    }

    public override int BatchSize
    {
        get { return _batchSize; }
        set { _batchSize = value; }
    }

    protected override int CountOfStatementsInCurrentBatch
    {
        get { return _currentBatch.CountOfCommands; }
    }

    public override void AddToBatch(IExpectation expectation)
    {
        _totalExpectedRowsAffected += expectation.ExpectedRowCount;
        IDbCommand batchUpdate = CurrentCommand;
        Driver.AdjustCommand(batchUpdate);
        string lineWithParameters = null;
        var sqlStatementLogger = Factory.Settings.SqlStatementLogger;
        if (sqlStatementLogger.IsDebugEnabled || Log.IsDebugEnabled)
        {
            lineWithParameters = sqlStatementLogger.GetCommandLineWithParameters(batchUpdate);
            var formatStyle = sqlStatementLogger.DetermineActualStyle(FormatStyle.Basic);
            lineWithParameters = formatStyle.Formatter.Format(lineWithParameters);
            _currentBatchCommandsLog.Append("command ")
                .Append(_currentBatch.CountOfCommands)
                .Append(":")
                .AppendLine(lineWithParameters);
        }
        if (Log.IsDebugEnabled)
        {
            Log.Debug("Adding to batch:" + lineWithParameters);
        }
        _currentBatch.Append((System.Data.SqlClient.SqlCommand) batchUpdate);

        if (_currentBatch.CountOfCommands >= _batchSize)
        {
            ExecuteBatchWithTiming(batchUpdate);
        }
    }

    protected override void DoExecuteBatch(IDbCommand ps)
    {
        Log.DebugFormat("Executing batch");
        CheckReaders();
        Prepare(_currentBatch.BatchCommand);
        if (Factory.Settings.SqlStatementLogger.IsDebugEnabled)
        {
            Factory.Settings.SqlStatementLogger.LogBatchCommand(_currentBatchCommandsLog.ToString());
            _currentBatchCommandsLog = new StringBuilder().AppendLine("Batch commands:");
        }

        int rowsAffected;
        try
        {
            rowsAffected = _currentBatch.ExecuteNonQuery();
        }
        catch (DbException e)
        {
            throw ADOExceptionHelper.Convert(Factory.SQLExceptionConverter, e, "could not execute batch command.");
        }

        Expectations.VerifyOutcomeBatched(_totalExpectedRowsAffected, rowsAffected);

        _currentBatch.Dispose();
        _totalExpectedRowsAffected = 0;
        _currentBatch = CreateConfiguredBatch();
    }

    private SqlClientSqlCommandSet CreateConfiguredBatch()
    {
        var result = new SqlClientSqlCommandSet();
        if (_defaultTimeout > 0)
        {
            try
            {
                result.CommandTimeout = _defaultTimeout;
            }
            catch (Exception e)
            {
                if (Log.IsWarnEnabled)
                {
                    Log.Warn(e.ToString());
                }
            }
        }

        return result;
    }
} 
```

我忽略了什么吗？复制整个内容以覆盖对任何私有成员的所有访问权限似乎是一种相当糟糕的方法。我只想覆盖一种方法！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T21:10:50.723

只有一种方法可以合法地访问基类的私有成员：将派生类放在基类中：

```
class Base
{
    private int x;
    private class Derived : Base
    {
        private void M()
        {
            Console.WriteLine(this.x); // legal!
        }
    }
} 
```

当然，如果您可以将类放在基类中，那么您也可以重写基类以保护成员。

原作者将成员设为私有是对您的暗示，该课程不是为您设计的，用于处理这些数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T20:48:15.803

如果它们被设置为私有，那么您真的无能为力（除了使用反射，这很丑陋而且当然并不总是安全）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:50:11.300

`Private`无法访问超类的成员，因为它们是`private`. OOP 中的封装是为了禁止这种**直接**访问，从而确保对象正常运行。
可能需要`properties`访问私有成员，这些是您可以用来读取/写入私有成员的成员。这些属性将确保不会对对象造成伤害。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T20:51:01.447

您可以使用反射访问父类的私有字段、属性和方法（例如，访问此处描述的字段：[Reflecting a private field from a base class](https://stackoverflow.com/questions/6961781/reflecting-a-private-field-from-a-base-class)）

这是不安全的，但是私有的想法是库实现可能会改变，那些私有方法、字段和属性可能会改变或消失。如果他们更改实现，更新可能会破坏您的代码。

也就是说，我自己已经做过几次了。你只需要权衡风险。

# jquery - 使用 Foundation 的 Orbit 内容滑块同时滑动两个 div

> ID：15534385
> 
> 赞同：0
> 
> 时间：2013-03-20T20:46:40.507
> 
> 标签：jquery, css, slider, zurb-foundation

![截屏](../Images/8b41504e98f007112c8397e24ee44367.png)

单击箭头时，我需要同时在投资组合页面上动画/滑动两个 div（根据附加的图像，笔记本电脑和手机上的屏幕截图）。我可以适度理解/更改 JS 插件，并且非常精通 HTML/CSS。有什么推荐的插件或方法可以做到这一点而无需编写特定的 JS 代码？

PS 我正在使用 Zurb 的 Foundation 框架，它内置了“Orbit”滑块插件，但不确定它的可定制性是否足以实现这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:55:43.647

jQuery 中的动画函数是异步工作的，因此您可以同时调用元素的动画：

```
var deltaW = window.innerWidth;

$('#myDiv1').animate({left : deltaW});
$('#myDiv2').animate({left : deltaW}); 
```

您还可以在动画完成时触发一个函数：

```
$('#myDiv1').animate({left : deltaW});
$('#myDiv2').animate({left : deltaW }, function() { /*.. do something ..*/}); 
```

编辑：工作示例（请注意 css 规则的位置属性）：http:
[//jsfiddle.net/2gCKY/1/](http://jsfiddle.net/2gCKY/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T10:42:56.520

没有开箱即用的方法，但您可以随意破解。假设您有以下轨道：

```
<div class="row">
    <div class="large-8 columns">
        <ul data-orbit id="slider1">
            <li>
            <img src="http://placehold.it/800x350&text=slide 1" />                
            </li>
            <li>
            <img src="http://placehold.it/800x350&text=slide 2" />                
            </li>
            <li>
            <img src="http://placehold.it/800x350&text=slide 3" />                
            </li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="large-4 columns">
        <ul data-orbit id="slider2">
            <li>
            <img src="http://placehold.it/400x150&text=slide 1" />                
            </li>
            <li>
            <img src="http://placehold.it/400x150&text=slide 2" />                
            </li>
            <li>
            <img src="http://placehold.it/400x150&text=slide 3" />                
            </li>
        </ul>
    </div>
</div> 
```

您可以通过单击导航箭头来同步两个 Orbit 的滑动，**前提是这两个 Orbit 具有相同的`timer_speed`**（默认情况下它们会）：

```
<script type="text/javascript">
    $(document).foundation();
    $(document).ready(function () {
        var fromSlide1 = false;
        var fromSlide2 = false;
        var slider1 = $("#slider1");
        var slider2 = $("#slider2");
        var slider1Prev = slider1.parent().find(".orbit-prev");
        var slider2Prev = slider2.parent().find(".orbit-prev");
        var slider1Next = slider1.parent().find(".orbit-next");
        var slider2Next = slider2.parent().find(".orbit-next");

        slider1Prev.click(function () {
            if (fromSlide1) return;
            fromSlide1 = true;              
            slider2Prev.click();
            fromSlide1 = false;
        });
        slider2Prev.click(function () {
            if (fromSlide2) return;
            fromSlide2 = true;
            slider1Prev.click();
            fromSlide2 = false;
        });
        slider1Next.click(function () {
            if (fromSlide1) return;
            fromSlide1 = true;              
            slider2Next.click();
            fromSlide1 = false;
        });
        slider2Next.click(function () {
            if (fromSlide2) return;
            fromSlide2 = true;
            slider1Next.click();
            fromSlide2 = false;
        });
    });
</script> 
```

# hibernate - 将 Envers 添加到现有数据库

> ID：15534398
> 
> 赞同：9
> 
> 时间：2013-03-20T20:47:20.337
> 
> 标签：hibernate, hibernate-envers

我在生产中有一个基于 Hibernate 的应用程序，它有一个大型数据库。我需要为这个应用程序中的两个实体（两个表）添加审计，我决定使用 Envers。

对于每个 INSERT、UPDATE 或 DELETE，Envers 都会向实体的审计表中添加一条新记录。

如果我从应用程序一开始就有 Envers 支持，审计表将在实体创建时填充 (INSERT)。

Envers 文档非常薄，没有提到任何关于将 Envers 添加到现有应用程序的内容。

如果我只是添加 Envers 支持并创建相应的审计表，它们将开始为空，因此当我更新现有实体时，Envers 将在审计表中添加一条记录新值的记录，但我会丢失以前的值。

我应该如何将 Envers 支持添加到具有现有数据库的应用程序中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T16:09:10.420

目前没有内置的解决方案。

“正确”的方法是编写一个 SQL 脚本（或手动创建）一个“0”修订，以及为每个现有实体插入绑定到该修订的审计记录。

实际上，这是一个很常见的功能，所以如果你愿意贡献，那将是非常受欢迎的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T16:43:57.350

您将需要手动插入。就像是

```
INSERT INTO z_envers_revisions (ID, timestamp, user_id, user_name) values (1, round((sysdate - to_date('19700101','YYYYMMDD')) * 86400000) , 42, 'UserName');

INSERT INTO z_Table1(rev, revtype, id, description, name) select 1 as rev, 0 as revtype, id, description, name from Table1;
INSERT INTO z_Table2(rev, revtype, id, description, name) select 1 as rev, 0 as revtype, id, description, name from Table2; 
```

我在我的审计表前面加上了 az 以使其更短

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-01T10:28:17.747

就 envers 而言，基本用例是记录一个实体的完整审计（我们希望通过 @Audited 注解的参数）。对于您提到的情况，可能会正确添加新实体，但对于现有实体，它会出现问题，因为审计表中没有修订。

让我们借助一个场景来解决这个问题：

假设我们考虑的实体是**users**。现在为观察历史而创建的表是**users_audit**。除此之外，**revinfo**也将用于观察和记录对给定记录的所有更改。

*首先问题来了，因为只要有更新，持久层就找不到修订记录*。因此，要修复它，表中需要存在所有现有条目，并且与 revinfo 表的外键映射不应中断。因此，需要做两件事：

1.  在 revinfo 表中插入临时值，以便 rev 可以充当外键
2.  将数据从*users*表复制到**users_audit**表。

示例 Liquibase 文件可以是这样的：

```
 CREATE TABLE `revinfo` (
      `rev` int(11) NOT NULL AUTO_INCREMENT,
      `revtstmp` bigint(20) DEFAULT NULL,
      PRIMARY KEY (`rev`)
    ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

    INSERT INTO `revinfo` (`revtstmp`) select updated_at from users u;

    SET @position := 0;

    insert into users_audit (
    rev,
    revtype,
    id,
    name,
    type,
    mobile_number,
    password,
    parent_id,
    profile_image_uri,
    is_active,
    created_at,
    updated_at
    ) select @position := @position +1, 0,
    id,
    name,
    type,
    mobile_number,
    password,
    parent_id,
    profile_image_uri,
    is_active,
    created_at,
    updated_at from us 
```

# c++ - 更改 int 中的字节 - 将字节转换为整数

> ID：15534405
> 
> 赞同：0
> 
> 时间：2013-03-20T20:47:36.110
> 
> 标签：c++, pointers, casting, int

我正在从服务器传输数据。服务器发送各种 BigEndian 变量，但也发送字节（代表数字）。我的`SocketClient.read`重载之一接受`(int length, char* array)`. 我想**将一个整数变量指针传递**给该函数以在其中**获取 0-255 值**（无符号字节）。

### 我尝试了什么：

```
unsigned int UNSIGNED_BYTE;
socket.read(1, &((char*)&UNSIGNED_BYTE)[0]);  //I am changing 1st byte of a variable - C++ uses little endian
//I know that function reads 6, and that is what I find in 1st byte
std::cout<<(int)((char*)&UNSIGNED_BYTE)[0]<<")\n";  //6   - correct
std::cout<<UNSIGNED_BYTE<<")\n";  //3435973638   -What the hell? 
```

根据上述，我正在**更改`int`**. 但**我还应该改变**什么？

### 我的类声明和实现：

```
/*Declares:*/
bool read(int bytes, char *text);
/*Implements:*/
bool SocketClient::read(int bytes, char *text) {
      //boost::system::error_code error;
      char buffer = 0;
      int length = 0;
      while(bytes>0) {
        try
        {
          size_t len = sock.receive(boost::asio::buffer(&buffer, 1));  //Read a byte to a buffer
        }
        catch(const boost::system::system_error& ex) {
            std::cout<<"Socket exception: "<<ex.code()<<'\n';
            return false;   //Happens when peer disconnects for example
        }
        if(byteEcho)
            std::cout<<(int)(unsigned char)buffer<<' ';
        bytes--;      //Decrease ammount to read
        text[length] = buffer;
        length++;

      }
      return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:58:27.457

所以首先：

```
unsigned int UNSIGNED_BYTE; 
```

可能不是很有帮助的命名，因为我非常怀疑您使用的体系结构将 a 定义`int`为 8 位无符号整数，另外**您没有将其初始化为零**，然后**您只写入其中的一部分而**留下其余部分作为垃圾。在大多数现代编译器/架构上，它的大小可能是 32/64 位。

第二：

```
socket.read(1, &((char*)&UNSIGNED_BYTE)[0]) 
```

正在将 8 位读入（可能）32 位内存位置，而放置 8 位的正确端并不取决于 C++（正如您在评论中所说）。这实际上取决于您的 CPU，因为字节序是 CPU 的属性而不是语言。您为什么不将值读入实际值`char`，然后简单地将其分配给 a，`int`因为这将为您处理转换**并使您的代码可移植**。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T20:56:45.037

问题是，我没有**初始化 int**。虽然第 1 个字节发生了变化，但其他 3 个字节具有随机值。
这使得解决方案非常简单（并且也使我的问题很可能因为*过于本地化*而被关闭）：

无符号整数 UNSIGNED_BYTE = 0;

# c++ - 将文件读入对象数组C++

> ID：15534416
> 
> 赞同：3
> 
> 时间：2013-03-20T20:48:05.187
> 
> 标签：c++, arrays, object

我必须从格式如下的数据文件中读取

abcd(string) 1(int) 2(int) 3(int)
abcde(string) 4(int) 3(int) 2(int)
。
.
.

我想执行一些仅在同一行中使用变量的函数。但这是我的代码。我是初学者，请指正，谢谢。

在 .h 文件中

```
#include <string>
using namespace std;

#ifndef CALC_H  
#define CALC_H

class Calc  
{  
public:

    void readFile(string file);

private:

    string name;
    int a;
    int b;
    int c;
};

#endif 
```

在实现文件中

```
 #include "Vehicle.h"  
 #include iostream>  
 #include fstream>  
 #include string>  
 #include cstdlib>  
 #include cmath>  

 using namespace std;

void Vehicle::readFile(string filename)  
{  
   ifstream myIn;  

 int totalNum=0;  

myIn.open(filename.c_str());
if (!myIn)
{
    cerr<<"Data file failed to open!\n";
    exit (0);
}   
for (int i=0; i<MAX; i++)
{
    while (myIn.peek() != EOF)
    {
        myIn>>calc[i].name;
        myIn>>calc[i].a;
        myIn>>calc[i].b;
        myIn>>calc[i].c;

        totalNum++;
    }
}
myIN.close(); 
```

然后我想显示我刚刚从文件中读取的内容

```
 for (int i = 0; i < MAX; i++)  
 cout << calc[i].name << calc[i].a << calc[i].b << calc[i].c << endl; 
```

抱歉，我遗漏了很多东西，我只想知道我是否走在正确的道路上。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:55:42.507

执行此操作的正确方法是`>>`为您的类重载运算符`Calc`。

```
class Calc {
   public:
      friend istream& operator >>(istream& myIn, Calc& calc);
};

istream& operator >>(istream& myIn, Calc& calc) {
    myIn >> calc.name;
    myIn >> calc.a;
    myIn >> calc.b;
    myIn >> calc.c;

    return myIn;     
} 
```

现在你可以这样做：

```
while (myIn >> calc[i]) {
    ++totalNum;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:10:13.607

你应该考虑设计它有点不同。

创建一个包含一行的类，即 string int int int - 就像您在“Calc”中拥有它一样，但不依赖于您如何创建一行（readfile）。让我们称之为“线”

```
class Line
{
public:
  std::string name;
  int a;
  int b;
  int c;  
}; 
```

现在，由于您需要阅读几行，您将需要某种容器来保存它们，创建一个 Line 向量（或其他一些容器）

```
std::vector<Line> contents; 
```

然后按照 Tushar 的建议覆盖流运算符，因此当您从文件（或从例如标准输入）读取时，您可以为读取的每一行创建 Line 实例，这些实例用于填充“内容”数组

现在你可以开始做任何你想做的事情，即实际操作`calc`

# javascript - AngularJS：通过指令更新模板绑定

> ID：15534428
> 
> 赞同：0
> 
> 时间：2013-03-20T20:48:33.817
> 
> 标签：javascript, angularjs

我修改了工具提示的 AngularUI-Bootstrap 指令以帮助我显示错误消息，这是我到目前为止所做的：http: [//jsfiddle.net/distractedBySquirrels/TaAHZ/](http://jsfiddle.net/distractedBySquirrels/TaAHZ/)

但我对动态消息有疑问。当您第一次将鼠标悬停在第一个输入字段上时，消息在错误的位置，这是因为模型尚未正确更新。当然，在第二次鼠标悬停之后，工具提示就在正确的位置。但是，如果要显示的消息再次更改，则会发生相同的故障。

我正在使用`$parse`更新模板：

```
$parse('tt_content').assign( scope, 
    getErrorMessage( ctrl.$error ) || attrs.tooltip
); 
```

似乎并非所有听众都已接收和更新，并且“ttHeight”和“ttWidth”仍设置为“旧”值。消息/模型的正确更新仅适用于 $observe，如第三个示例所示。

我被卡住了，不知道我做错了什么？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T04:38:29.830

问题是当您使用 $apply 修改模型时，您需要***手动***激活摘要循环以通知所有观察者此类模型。因此，基本上，您需要`scope.$digest();`在更改范围时添加，例如`scope.$apply( show );`

我在这里用我的建议修改了你的代码[http://jsfiddle.net/TaAHZ/2/](http://jsfiddle.net/TaAHZ/2/)

# ios - NSDecimalNumber decimalNumberWithString：忽略当前语言环境

> ID：15534431
> 
> 赞同：10
> 
> 时间：2013-03-20T20:48:44.970
> 
> 标签：ios, objective-c, cocoa-touch, nsdecimalnumber

根据文档，`[NSDecimalNumber decimalNumberWithString:]`应使用语言环境小数分隔符：

> NSDecimalSeparator 是句点（例如在美国使用）还是逗号（例如在法国使用）取决于默认语言环境。

但是当我尝试时，这段代码：

```
NSLog(@"%@", [NSDecimalNumber decimalNumberWithString:@"100,1"]);
NSLog(@"%@", [NSDecimalNumber decimalNumberWithString:@"100,1" locale:NSLocale.currentLocale]); 
```

给...

```
100
100.1 
```

...作为 iOS 5 和 iOS 6 上的输出。我尝试使用瑞典语和法语作为区域设置，因为这两个国家/地区都使用逗号 (,) 作为小数分隔符。

**输出不应该相同吗？**

*（我知道我可以使用 [NSDecimalNumber decimalNumberWithString:locale:] 来强制行为，所以这个问题不是关于寻找替代方案，只要这是一个错误或者我做错了什么）*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T21:47:04.350

NSDecimalNumber 只是数字类型数据的存储类。它在你传递给它的字符串上运行一个解析器（NSNumberFormatter）来创建它的数字。您的第二个日志语句“更好”工作的原因是因为第一个使用默认数字格式语言环境（它*看起来像*en_US，但我无法验证这一点，**请参阅编辑打击以获取更多信息**。）进行解析，并且“100,1”不是有效数字，因此“非数字”部分被剥离。通过指定使用“，”小数分隔符的语言环境，它可以正确捕获完整的数字。

当你 NSLog() 一个 NSDecimalNumber 时，它只是简单地调用`-description`，它没有语言环境上下文并且可以或多或少地打印它想要的任何东西。

如果要打印格式正确的数字，请使用 NSNumberFormatter，如下所示：

```
NSDecimalNumber *number = [NSDecimalNumber decimalNumberWithString:@"100.1"];

NSLog(@"%@", number);

NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];

[formatter setNumberStyle:NSNumberFormatterDecimalStyle];

NSLocale *locale = [[NSLocale alloc] initWithLocaleIdentifier:@"fr_FR"];

[formatter setLocale:locale];

NSLog(@"%@", [formatter stringFromNumber:number]); 
```

或者，简要地

```
NSDecimalNumber *number = [NSDecimalNumber decimalNumberWithString:@"100.1"];
NSLog(@"%@", [NSNumberFormatter localizedStringFromNumber:number numberStyle:NSNumberFormatterDecimalStyle]); 
```

如果您只想使用当前的语言环境。

总之：

1.  NSDecimalNumber 只是存储。记录它不会反映任何关于语言环境的信息。
2.  为了让 NSDecimalNumber 正确存储一个数字，它的语言环境需要与预期输入的语言环境相匹配（`-[NSLocale currentLocale]`这里是一个不错的选择）。
3.  为了显示给定区域设置正确格式的数字，请使用 NSNumberFormatter。

* * *

**编辑：**

好的，我对此进行了更多研究。

在 GNUStep 中，它看起来最终使用了`NSDecimalSeparator`in的值`NSUserDefaults`（通过快速浏览他们的代码）。

做一些实验，我发现以下都不会影响默认的解析行为，据我所知：

1.  `NSDecimalSeparator`在`NSUserDefaults`.
2.  `AppleLocale`在`NSUserDefaults`.
3.  `NSLocaleCode`在`NSUserDefaults`.
4.  为 设置的值`CFBundleDevelopmentRegion`。
5.  环境的`LANG`/ `LC_ALL`/etc... 值。
6.  `+[NSLocale systemLocale]`.

显然不是`+[NSLocale currentLocale]`，因为这个问题源于当前语言环境无效的事实。

# apache - Sqoop - 无法找到或加载主类 org.apache.sqoop.Sqoop

> ID：15534436
> 
> 赞同：7
> 
> 时间：2013-03-20T20:49:10.007
> 
> 标签：apache, hadoop, hbase, hive, sqoop

我安装了**Hadoop**、**Hive**、**HBase**、**Sqoop**并将它们添加到 PATH 中。

当我尝试执行`sqoop`命令时，出现此错误：

```
Error: Could not find or load main class org.apache.sqoop.Sqoop 
```

**开发环境：**

操作系统：Ubuntu 12.04 64 位

Hadoop版本：1.0.4

蜂巢版本：0.9.0

Hbase 版本：0.94.5

Sqoop 版本：1.4.3

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-20T23:18:52.730

确保您的 SQOOP HOME 目录下有 sqoop-1.4.3.jar。

注意：可能是因为你在[Sqoop Distribution下下载了错误的发行版](http://www.apache.org/dist/sqoop/1.4.3/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-05T17:17:37.533

我已经在 CentOS 6.3 上解决了这个问题。
我安装了 Hadoop-1.0.4、hbase-0.94.6、hive-0.10.0、pig-0.11.1、sqoop-1.4.3.bin__hadoop-1.0.0、zookeeper-3.4.5。

我在 sqoop: 上也遇到了同样的问题`Error - Could not find the main class: org.apache.sqoop.Sqoop`。

为了解决这个问题，我复制了 jar 文件：`sqoop-1.4.3.jar`from`$SQOOP_HOME/`到`$HADOOP_HOME/lib/`.

希望这能帮助那些在 sqoop 上苦苦挣扎的人使用 hadoop。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-03T17:39:52.683

不幸的是，我没有为我的问题找到完整的答案。我使用的当前 sqoop 安装版本是 1.4.6 。我不确定 sqoop-1.4.6.tar.gz 如果必须编译源代码，我可以`Error - Could not find the main class: org.apache.sqoop.Sqoop`使用以下说明解决相同的错误：

相反，我`sqoop-1.4.6.bin__hadoop-2.0.4-alpha.tar.gz`从 apache sqoop 下载并将其安装在`/home/ubuntu/SQOOP/`重命名`sqoop-1.4.6.bin__hadoop-2.0.4-alpha`为`sqoop`. 我想和 Yarn 一起使用。

然后导出并设置 $SQOOP_HOME 我用这个

`export SQOOP_HOME=/home/ubuntu/SQOOP/sqoop/`

`export PATH=$PATH:$SQOOP_HOME/bin`

现在，如果去 $SQOOP_HOME/bin 并尝试

```
./sqoop help 
```

它应该可以正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-05T03:26:18.667

我的问题是该`hadoop-env.sh`文件中有这一行：

```
export HADOOP_CLASSPATH=${JAVA_HOME}/lib/tools.jar 
```

似乎当您`sqoop`在内部调用它时，调用`configure-sqoop`它设置`HADOOP_CLASSPATH`正确，但是当它（sqoop）调用时`hadoop`，`hadoop`忽略该变量并将其重置回`hadooop-env.sh`

解决方法是更改`hadoop-env.sh`​​为具有此行：

```
export HADOOP_CLASSPATH="${JAVA_HOME}/lib/tools.jar:$HADOOP_CLASSPATH" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-07T03:03:35.103

@user225003 解决方案神奇地起作用了，我查看了一些文件，这是执行“sqoop”脚本时发生的事情。

“ **sqoop** ”脚本实质上是从目录执行“ **hadoop ”脚本。**`$HADOOP_COMMON_HOME/bin/`在配置 sqoop 时，在“ `sqoop-env.sh`”中我们设置了`$HADOOP_COMMON_HOME`hadoop 安装目录。如果您的 sqoop 和 hadoop 安装不在常规位置`/usr/local`，我相信`sqoop-x.x.x.jar`不在 hadoop 脚本的类路径中。

# python - 火车路线的字典最佳数据结构？

> ID：15534438
> 
> 赞同：3
> 
> 时间：2013-03-20T20:49:15.083
> 
> 标签：python, dictionary, routing

因此，我的任务基本上是读取一个文件（记事本文件），其中包含一堆火车停靠站以及从一个站点到另一个站点所需的时间。例如，它看起来像：

```
Stop A     15
Stop B     12
Stop C     9 
```

现在我需要回去访问这些站点及其时间。我正在考虑读取文件并将其存储为字典。我的问题是，字典会是最好的吗？还是有其他一些 python 工具会被证明更有用？任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T21:03:18.070

我会反对这一点 - 并说平直的字典不是最好的。

假设您有 100 个站点和多条非字母和非数字的路线。想想巴黎地铁：

![巴黎地铁](../Images/1f6c3d311609fa8c5af581428230ada4.png)

现在尝试使用直接的 Python 字典来计算 FDR 和 La Fourche 之间的时间？这涉及两条或更多条不同的路线和多种选择。

树或某种形式的[图](http://en.wikipedia.org/wiki/Graph_%28mathematics%29)是更好的结构[。](http://en.wikipedia.org/wiki/Tree_%28data_structure%29)dict 非常适合 1 对 1 映射；树更适合于对彼此相关的节点进行丰富的描述。然后，您将使用诸如[Dijkstra 算法之](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)类的东西来导航它。

由于[dicts 的嵌套 dict 或列表](http://www.python.org/doc/essays/graphs.html)的 dict是一个图，因此很容易提出一个递归示例：

```
def find_all_paths(graph, start, end, path=[]):
        path = path + [start]
        if start == end:
            return [path]
        if start not in graph:
            return []
        paths = []
        for node in graph[start]:
            if node not in path:
                newpaths = find_all_paths(graph, node, end, path)
                for newpath in newpaths:
                    paths.append(newpath)
        return paths       

def min_path(graph, start, end):
    paths=find_all_paths(graph,start,end)
    mt=10**99
    mpath=[]
    print '\tAll paths:',paths
    for path in paths:
        t=sum(graph[i][j] for i,j in zip(path,path[1::]))
        print '\t\tevaluating:',path, t
        if t<mt: 
            mt=t
            mpath=path

    e1=' '.join('{}->{}:{}'.format(i,j,graph[i][j]) for i,j in zip(mpath,mpath[1::]))
    e2=str(sum(graph[i][j] for i,j in zip(mpath,mpath[1::])))
    print 'Best path: '+e1+'   Total: '+e2+'\n'  

if __name__ == "__main__":
    graph = {'A': {'B':5, 'C':4},
             'B': {'C':3, 'D':10},
             'C': {'D':12},
             'D': {'C':5, 'E':9},
             'E': {'F':8},
             'F': {'C':7}}
    min_path(graph,'A','E')
    min_path(graph,'A','D')
    min_path(graph,'A','F') 
```

印刷：

```
 All paths: [['A', 'C', 'D', 'E'], ['A', 'B', 'C', 'D', 'E'], ['A', 'B', 'D', 'E']]
        evaluating: ['A', 'C', 'D', 'E'] 25
        evaluating: ['A', 'B', 'C', 'D', 'E'] 29
        evaluating: ['A', 'B', 'D', 'E'] 24
Best path: A->B:5 B->D:10 D->E:9   Total: 24

    All paths: [['A', 'C', 'D'], ['A', 'B', 'C', 'D'], ['A', 'B', 'D']]
        evaluating: ['A', 'C', 'D'] 16
        evaluating: ['A', 'B', 'C', 'D'] 20
        evaluating: ['A', 'B', 'D'] 15
Best path: A->B:5 B->D:10   Total: 15

    All paths: [['A', 'C', 'D', 'E', 'F'], ['A', 'B', 'C', 'D', 'E', 'F'], ['A', 'B', 'D', 'E', 'F']]
        evaluating: ['A', 'C', 'D', 'E', 'F'] 33
        evaluating: ['A', 'B', 'C', 'D', 'E', 'F'] 37
        evaluating: ['A', 'B', 'D', 'E', 'F'] 32
Best path: A->B:5 B->D:10 D->E:9 E->F:8   Total: 32 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:04:03.467

字典完全适合查找特定站点的值。但是，这不会存储有关停止顺序的任何信息，因此无论如何您可能都需要一个单独的列表。我假设这些时间只是相邻停靠点之间的延迟，因此如果您需要计算在任意对停靠点之间到达的总时间，您实际上可能会发现 2 元组列表比列表和字典更方便：

```
train_times = [("A", 0), ("B", 15), ("C", 12), ("D", 9)] 
```

注意：第一次可能总是为零，因为没有以前的停止时间。或者，您可以将最后时间设为零并将值存储在上一站的位置，但我在这里假设了第一种情况。

这使您可以非常简单地计算从 A 到 C 的总时间：

```
def get_total_time(start_stop, end_stop):
    total_time = None
    for stop, this_time in train_times:
        if total_time is None and stop == start_stop:
            total_time = 0
        if total_time is not None:
            total_time += this_time
            if stop == end_stop:
                return total_time
    raise Exception("stop not found")

print "Time from A to C: %d" % (get_total_time("A", "C"),) 
```

结合列表和字典可以提高效率，但除非列表很长（至少数百个站点），否则不会有太大区别。

此外，一旦您引入许多相互连接的火车线路，事情就会变得更加复杂。在这种情况下，您可以使用任意数量的数据结构 - 一个简单的示例是字典，其中键是停靠点，值是所有行上相邻停靠点的列表以及它们的时间。但是，通过此找到一条路线需要一些稍微不平凡（但非常知名）的算法，这些算法超出了这个问题的范围。

在任何一种情况下，如果您需要快速查找这些值，您可以考虑预先计算所有停靠点对之间的时间 - 这被称为图的[传递闭包](http://en.wikipedia.org/wiki/Transitive_closure#In_graph_theory)（其中“图”在这种意义上是一个节点网络，而不是折线图或类似图表）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T20:54:53.180

在这种情况下，dict 是完全可以接受的。事实上，如果您无法使用数据库，并且您有兴趣在将来重用此字典，则可以腌制该对象并在另一个脚本中使用它：

```
import pickle

output = open('my_pickled_dict', 'wb')
pickle.dumb(my_dict, output)
output.close 
```

然后在你的下一个脚本中：

```
import pickle

my_pickled_file = open('my_pickled_dict', 'rb')
my_dict = pickle.load(my_pickled_file) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T20:55:28.740

一本字典可能对此有好处，是的。但是，如果您需要跟踪旁边的停靠点，您可能需要其他东西，例如[有序的 dict](http://docs.python.org/2/library/collections.html#ordereddict-objects)，或者定义下一个停靠点的小类（以及您想要保留的任何其他数据）关于停止），甚至是停止列表，因为它保持顺序。

根据您需要什么样的访问权限或您希望如何处理这些数据，其中任何一个都可能适合您。

祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T20:55:26.727

字典适合这样做。

它使您可以轻松访问给定巴士站（= 键）的时间（= 值）。

```
time_per_stop = {"Stop A": 15, "Stop B": 12, "Stop C": 9} 
```

当然，如果您的公交车站数量有限且数量很少，您也可以只保留停车时间的列表或元组。

```
time_per_stop_list = [15, 12, 9] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T20:55:56.350

字典是由一组键的散列存储的一组值。使用字典的优点是定位特定记录所需的时间是固定的（通常称为`O(1)`），而不管大小如何。或者，如果您使用列表，则定位记录所需的时间将等于读取每个元素所需的时间（通常称为`O(n)`其中 n 等于列表中元素的数量）。

# c# - C# 列表 .ForEach(delegate(type t) 以及如何在迭代列表时删除项目

> ID：15534441
> 
> 赞同：2
> 
> 时间：2013-03-20T20:49:30.127
> 
> 标签：c#, list, xna-4.0

这可能被认为是糟糕的编程，但在 .net 4 之前，我曾经大量使用类似这样的代码：

```
 enemyList.ForEach(delegate(Enemy e)
    {
        e.Update();
        if (someCondition)
              enemyList.Remove(e);
    }); 
```

现在，我正在更新一些旧项目，自从 ForEach 被删除以来，有*很多代码需要更改。现在，我确实有一个扩展程序允许我使用 ForEach ：*

```
 public static void ForEach<T>(this IEnumerable<T> sequence, Action<T> action)
    {
        if (sequence == null) throw new ArgumentNullException("sequence");
        if (action == null) throw new ArgumentNullException("action");
        foreach (T item in sequence)
            action(item);
    } 
```

我知道我可以这样做：

```
 var index = 0;
    while(index < enemyList.Count)
    {
        if(condition)
            enemyList.RemoveAt(index);
        else
            index++;
    } 
```

但是其中一些这样重写会很痛苦..有没有办法重新添加该功能，以便我可以遍历该列表，删除我需要的项目而无需返回并重写和编辑所有这些功能? 我仍然认为自己是编码的新手，我只是想不通这个..任何帮助将不胜感激！

****** *** ** *** *******编辑******* *** ** *** ** **********

 *****所以我想归结为重写很多代码。我有很多这样的代码，我刚刚从一个项目中提取出来：

```
 GameplayScreen.gameWorld.shipList.ForEach(delegate(Ship s)
            {
                if (eS.originalShipsID == s.shipID)
                {
                    if (!eS.Alive || eS.health <= 0)
                    {
                        // this one sunk...
                        string log = "0" + s.shipName + " was sunk in battle.. All crew and cargo were lost.";
                        AddLogEntry(log);
                        totalCrewLost += s.currentCrew;
                        GameplayScreen.gameWorld.shipList.Remove(s);
                    }
                }
            }); 
```

我只是希望有一种方法不必重写所有这些。所以是时候更新和改变我的编码方式了。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T21:02:25.850

使用列表的`RemoveAll`方法。

您可以将代码重构为：

```
enemyList.RemoveAll(enemy => enemy.SomeCondition); 
```

它不仅比`while`循环好，而且我认为它比`Foreach`方法好得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T20:50:31.350

你不能。唯一的方法是将要删除的项目添加到另一个列表，然后遍历该列表并在初始迭代后将其删除。

更好的选择是使用反向 for 循环来迭代这些值。然后，您可以在初始迭代期间安全地删除项目：

```
for (var i = enemyList.Count() - 1; i >= 0; i--) {
{
    if(condition) enemyList.RemoveAt(i);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T20:55:49.080

既然你说你做了很多，为什么不做这样的事情：

```
public static void RemoveIfTrue<T>(this ICollection<T> list, Func<T, bool> condition)
{
    List<T> itemsToRemove = list.Where(condition).ToList();
    foreach (var item in itemsToRemove)
    {
        list.Remove(item);
    }
} 
```

然后你可以像这样使用它：

```
myList.RemoveIfTrue(x => YourConditionIsTrue) 
```

这样你就没有一堆重复的逻辑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T21:01:21.287

如果您使用的是`List<T>`，则可以使用[`List<T>.RemoveAll(Predicate<T> match)`](http://msdn.microsoft.com/en-us/library/wdka673a.aspx)

所以已经有一个内置的东西可以做到这一点。

更好的是 - 内置的确切知道如何避免在迭代集合时修改集合的问题。而且因为它可以访问私有内部，所以它也更有效率。

因此，只需使用 List 类本身，您就可以编写如下代码：

`enemies.RemoveAll(enemy => (enemy.Health <= 0));`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T21:02:16.363

这可以通过一个小的调整来实现。这是一个例子：

```
public static class Extensions
{
    public static void ForEach<T>(this IList<T> list, Action<T> action)
    {
        for (int i = 0; i < list.Count; i++)
        {
            action(list[i]);
        }
    }
}

class Program
{

    static void Main(string[] args)
    {
        List<string> vals = new List<string>(new string[] { "a", "bc", "de", "f", "gh", "i", "jk" });

        vals.ToList().ForEach<string>(delegate(string value)
        {
            if (value.Length > 1)
            {
                vals.Remove(value);
            }
        });

        vals.ToList().ForEach<string>(delegate(string value)
        {
            Console.WriteLine(value);
        });

        Console.ReadKey();
    }
} 
```

现在，这里有几件事值得一提：首先，通常会跳过元素。但是，通过调用 ToList() 会生成列表的单独副本。`remove`其次，您应该小心仅对引用类型执行此操作——即不使用原始类型——否则您将使用该方法删除多个元素。

**编辑**

我还想补充一点，可能任何已发布的替代方案都更好——但我认为可以做到这一点很有趣；它的性能较低，但可能更快地插入现有代码。*****

# c# - 温莎没有解析截获的组件

> ID：15534452
> 
> 赞同：5
> 
> 时间：2013-03-20T20:50:17.700
> 
> 标签：c#, castle-windsor, interceptor

谁能解释为什么这不起作用？如果你从 IFoo 的注册中移除拦截器并解析一个 Bar，你会得到一个 Foo（MyFoo 不为空）。但是使用拦截器， Foo 不再解析。

为什么？我怎么知道为什么它不能通过日志记录或跟踪来解决？

版本：

*   城堡核心：3.2
*   温莎城堡：3.2
*   .NET 4.5
*   C# 5

    ```
    using Castle.DynamicProxy;
    using Castle.MicroKernel.Registration;
    using Castle.Windsor;
    using System;

    namespace Sandbox
    {
    public interface IFooInterceptor : IInterceptor { }

    public interface IFoo
    {
        void Print();
    }

    public interface IBar
    {
        IFoo MyFoo { get; set; }
    }

    public class Foo : IFoo
    {
        public void Print()
        {
            Console.WriteLine("Print");
        }
    }

    public class FooInterceptor : IFooInterceptor, IInterceptor
    {

        public void Intercept(IInvocation invocation)
        {
            Console.WriteLine("Awesome");
            invocation.Proceed();
        }
    }

    public class Bar : IBar
    {
        public virtual IFoo MyFoo { get; set; }
    }

    class Program
    {

        static void Main(string[] args)
        {
            IWindsorContainer container = new WindsorContainer()
                .Register(
                    Component.For<IBar>().ImplementedBy<Bar>().LifestyleTransient(),
                    Component.For<IFoo>().ImplementedBy<Foo>().LifestyleTransient().Interceptors<IFooInterceptor>(),
                    Component.For<IFooInterceptor>().ImplementedBy<FooInterceptor>().LifestyleTransient()
                );

            var bar = container.Resolve<IBar>();
            var foo = container.Resolve<IFoo>();  // this isn't null
            bar.MyFoo.Print();                    // exception: bar.MyFoo is null
            Console.WriteLine("Done");
            Console.ReadLine();
        }

    }
    } 
    ```

**编辑：** 我刚刚发现（大部分是偶然的）将拦截器配置从接口更改为具体类是可行的。但是，我正在注册拦截器及其接口，所以对原来的问题稍作修改：为什么接口规范会失败（默默地，不少于）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T08:17:43.037

Castle 将属性作为可选依赖项处理，但默认情况下应该注入它们。但似乎这些可选依赖项与拦截器相结合并没有正确解决。

您可以做的是通过更改 Bar 以使用构造函数注入来使您的依赖项成为必需：

```
public class Bar : IBar
{
    public Bar(IFoo foo)
    {
        MyFoo = foo;
    }

    public virtual IFoo MyFoo { get; private set; }
} 
```

`Properties`或者使用明确标记的 required 注册 Bar ：

```
Component.For<IBar>().ImplementedBy<Bar>().LifestyleTransient()
    .Properties(Prop‌​ertyFilter.RequireAll) 
```

注意：在生产中你应该使用`PropertiesRequired`方法而不是，`Properties`因为它现在已经过时了。

我还发现了这个似乎也相关的 github 问题：[错误 - 未提供可选依赖项](https://github.com/castleproject/Windsor/issues/24)

# javascript - nicEdit 在 Chrome 中的行为不相应

> ID：15534458
> 
> 赞同：1
> 
> 时间：2013-03-20T20:50:52.893
> 
> 标签：javascript, jquery, nicedit

我集成了 nicEdit，因为它与包含数百 kb 的所有其他版本不同，非常轻巧。

然而，在 Chrome 中它会导致问题。例如，它不会将文本保存到 textarea 中或使内容变粗。可以在[此网站](http://www.posterlion.com/xz/asdfssadfadf)上观察该问题或查看以下代码。请不要像一位回答者那样提供黑客攻击，因为这无济于事。

我已禁用编辑器以进行调试。您可以通过 new nicEditor().panelInstance('comment'); 使用控制台启用它。

```
<div class="rdd blog-item">
    <h1><a id="blog-item-title" href="/b/asdfssadfadf">this ia test</a></h1>
    <div class="blog-date">
         Date posted: 2013-03-01
    </div>
    <div class="blog-message">
        <p>
            asdfasdfas
        </p>
    </div>
    <div class="blog-keywords">
        Keywords: <a href="/k/dfsa sadfasd adfasf adfas">dfsa sadfasd adfasf adfas</a>
        - <a href="/k/jlk">jlk</a>
    </div>
    <h4>0 Comments</h4>
    <div class="blog-comment blog-new-comment">
        <form id="new_comment" name="new_comment">
            <div class="blog-comment-row">
                <h4></h4>
                <h4>Would you like to place a comment?</h4>
            </div>
            <div class="blog-comment-row">
                <label for="comment">Comment</label>
                <textarea name="comment" id="comment"></textarea>
            </div>
            <div class="blog-comment-row">
                <label for="name">Name</label>
                <input type="text" name="name" id="name" value="" title="Enter your name">
            </div>
            <div class="blog-comment-row">
                <label for="email">Email</label>
                <input type="text" name="email" id="email" value="" title="Enter your email">
            </div>
            <div class="blog-comment-row">
                <div class="blog-comment-cell">
                    &nbsp;
                </div>
                <div class="blog-comment-cell">
                    <a class="blog-comment-submit blog-comment-button" href="">Submit</a><br/>
                    Your ip address is 220.245.93.218
                </div>
            </div>
        </form>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T10:52:32.323

Bold 问题是由 CSS 继承引起的。在您的 css 文件中删除 rdd blog-item span{} 它将起作用。nicEdit 不会在 textarea 中自动保存内容。因此，在提交表单时，您必须运行：nicEditors.findEditor('comment').saveContent(); 保存它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:58:12.477

您可以在编辑器上[绑定事件](http://wiki.nicedit.com/w/page/518/Editor%20Events)并在触发该事件时保存其内容。

当我在您的示例页面上运行此代码时，它对我有用（尽管您的服务器没有拾取 nicEditor HTML 标签）：

```
var commentNicEditor = new nicEditor().panelInstance('comment');
commentNicEditor.addEvent("blur", function () {

    commentNicEditor.instanceById('comment').saveContent();

}); 
```

使用基于[官方文档](http://wiki.nicedit.com/w/page/518/Editor%20Events)的无 jQuery 解决方案进行了更新。

# python - 我的第一个 Google App Engine/Python 应用

> ID：15534460
> 
> 赞同：0
> 
> 时间：2013-03-20T20:50:57.957
> 
> 标签：python, google-app-engine, web-applications, google-cloud-datastore, jinja2

我正在尝试编写我的第一个 GAE/Python 应用程序，它执行以下三件事：

1.  显示一个表单，用户可以在其中输入有关自己的详细信息 (index.html)
2.  将提交的表单数据存储在数据存储区中
3.  从数据存储中检索所有数据并在表单上方显示所有结果 (index.html)

但是，我收到以下错误

> 第 15 行，在 MainPage 'people' 中： people NameError: name 'people' is not defined

任何有关如何解决此问题并使我的应用程序正常工作的建议将不胜感激！

**主文件**

```
import webapp2
import jinja2
import os

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):

        people_query = Person.all()
        people = people_query.fetch(10)

    template_values = {
        'people': people
    }

    template = jinja_environment.get_template('index.html')
    self.response.out.write(template.render(template_values))

# retrieve the submitted form data and store in datastore   
class PeopleStore(webapp2.RequestHandler):
    def post(self):
        person = Person()
        person.first_name = self.request.get('first_name')
        person.last_name = self.request.get('last_name')
        person.city = self.request.get('city')
        person.birth_year = self.request.get('birth_year')
        person.birth_year = self.request.get('height')
        person.put()        

# models a person class 
class Person(db.Model):
    first_name = db.StringProperty()
    last_name = db.StringProperty()
    city = db.StringProperty()
    birth_year = db.IntegerProperty()
    height = db.IntegerProperty()

app = webapp2.WSGIApplication([('/', MainPage),
                                ('/new_person')], debug=True) 
```

**索引.html**

```
<html>
    <body>
        {% for person in people %}
            {% if person %}
                <b>{{ person.first_name }}</b> 
                <b>{{ person.last_name }}</b>
                <b>{{ person.city }}</b> 
                <b>{{ person.birth_year }}</b> 
                <b>{{ person.height }}</b> 
                <hr></hr>
            {% else %}
                No people found         
        {% endfor %}

        <form action="/new_person" method="post">           
            <div><textarea name="first_name" rows="3" cols="60"></textarea></div>
            <div><textarea name="last_name" rows="3" cols="60"></textarea></div>
            <div><textarea name="city" rows="3" cols="60"></textarea></div>
            <div><textarea name="birth_year" rows="3" cols="60"></textarea></div>
            <div><textarea name="height" rows="3" cols="60"></textarea></div>
            <div><input type="submit" value="Submit"></div>
        </form>         
    </body>
</html> 
```

**应用程序.yaml**

```
application: some_name
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /.*
  script: main.app

libraries:
- name: jinja2
  version: latest 
```

* * *

**编辑 1** * *main.py* *

```
import webapp2
import jinja2
import os

from google.appengine.ext import db

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):

        people_query = Person.all()
        people = people_query.fetch(10)

        template_values = {
            'people': people
        }

        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

class PeopleStore(webapp2.RequestHandler):
    def post(self):
        person = Person()
        person.first_name = self.request.get('first_name')
        person.last_name = self.request.get('last_name')
        person.city = self.request.get('city')
        person.birth_year = self.request.get('birth_year')
        person.height = self.request.get('height')
        person.put()        

class Person(db.Model):
    first_name = db.StringProperty()
    last_name = db.StringProperty()
    city = db.StringProperty()
    birth_year = db.IntegerProperty()
    height = db.IntegerProperty()

app = webapp2.WSGIApplication([('/', MainPage),
                                ('/new_person')], debug=True) 
```

* * *

**编辑 2** * *main.py* *

以下编辑修复了此错误

> AttributeError：“str”对象没有属性“get_match_routes”

```
app = webapp2.WSGIApplication([('/', MainPage),('/new_person',PeopleStore)], debug=True) 
```

好的，表单显示在浏览器中，但是当我提交数据时，我收到此错误：

> BadValueError：属性birth_year 必须是 int 或 long，而不是 unicode

* * *

**编辑 3 main.py**

```
person.birth_year = int(self.request.get('birth_year'))
person.height = int(self.request.get('height')) 
```

解决了这个错误：

> badvalueerror 属性必须是 int 或 long，而不是 unicode

好的，到目前为止很好。数据存储在数据存储中。但是，我的页面出现空白...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:55:48.323

你有一个缩进问题。方法的第 3 行及以后的行`get`应与前两行在同一级别缩进。否则，它们不是方法的一部分，而是类定义本身，并且将在定义类时执行——此时范围内没有变量`people`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:32:44.403

在您的 app.yaml 中，它不喜欢下划线

```
#application: some_name
application: somename 
```

还有一些其他问题，例如未关闭的块等，您需要自己解决

# hibernate - 导致 HibernateException 的多个数据源？

> ID：15534462
> 
> 赞同：2
> 
> 时间：2013-03-20T20:50:58.290
> 
> 标签：hibernate, session, grails, hibernateexception

对于我的 grails 项目，我的大多数类都有一个内存中的 h2 数据库，但只是为所有与用户相关的类添加了一个持久性数据库。启动时，应用程序执行多个线程。添加第二个数据源后，我得到了 HibernateExceptions。具体来说，

```
Illegal attempt to associate a collection with two open sessions; nested exception is org.hibernate.HibernateException 
```

它们只发生在前一个或两个线程上，然后其余的线程毫无问题地执行。这让我相信这是数据库首次启动时的某种并发问题。发生错误的代码是：

```
instance.customer = customerService.retrieveCustomer instance
instance.name = instance.customer?.name

Instance.withTransaction{
    instance.customer.save()  // <-- THIS LINE IS THE PROBLEM
    instance.save()
} 
```

我不知道这是数据库问题、休眠问题还是其他问题。运行 Grails 2.0.4

完整的堆栈跟踪：

```
| Error 2013-03-20 16:25:30,995 [pool-16-thread-1] ERROR kindlingcustomers.InstanceList  - k_54 Illegal attempt to associate a collection with two open sessions; nested exception is org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions org.springframework.orm.hibernate3.HibernateSystemException: Illegal attempt to associate a collection with two open sessions; nested exception is org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions
    at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:683)
    at org.springframework.orm.hibernate3.HibernateAccessor.convertHibernateAccessException(HibernateAccessor.java:412)
    at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:411)
    at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:339)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.SavePersistentMethod.performSave(SavePersistentMethod.java:56)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractSavePersistentMethod.doInvokeInternal(AbstractSavePersistentMethod.java:212)
    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractDynamicPersistentMethod.invoke(AbstractDynamicPersistentMethod.java:63)
    at org.codehaus.groovy.grails.commons.metaclass.DynamicMethodInvocation$invoke.call(Unknown Source)
    at org.codehaus.groovy.grails.orm.hibernate.HibernateGormInstanceApi.save(HibernateGormEnhancer.groovy:847)
    at kindlingcustomers.Customer.save(Customer.groovy)
    at kindlingcustomers.Customer$save$0.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
    at kindlingcustomers.InstanceList$__clinit__closure5_closure8.doCall(InstanceList.groovy:67)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1231)
    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
    at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1047)
    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:877)
    at groovy.lang.Closure.call(Closure.java:412)
    at kindlingcustomers.InstanceList$__clinit__closure5_closure8.call(InstanceList.groovy)
    at org.codehaus.groovy.runtime.ConvertedClosure.invokeCustom(ConvertedClosure.java:51)
    at org.codehaus.groovy.runtime.ConversionHandler.invoke(ConversionHandler.java:82)
    at com.sun.proxy.$Proxy30.doInTransaction(Unknown Source)
    at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1231)
    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSite.invoke(PojoMetaMethodSite.java:189)
    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:53)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
    at org.grails.datastore.gorm.GormStaticApi.withTransaction(GormStaticApi.groovy:573)
    at kindlingcustomers.Instance.withTransaction(Instance.groovy)
    at kindlingcustomers.Instance$withTransaction.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
    at kindlingcustomers.InstanceList$__clinit__closure5.doCall(InstanceList.groovy:66)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1231)
    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
    at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1047)
    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:877)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:921)
    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:877)
    at groovy.lang.Closure.call(Closure.java:412)
    at groovy.lang.Closure.call(Closure.java:406)
    at groovy.lang.Closure.run(Closure.java:490)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
    at java.lang.Thread.run(Thread.java:680) 
```

我的数据源：

```
environments {
    development {
        dataSource {
            dbCreate = "create-drop" // one of 'create', 'create-drop', 'update', 'validate', ''
            url = "jdbc:h2:mem:devDb;MVCC=TRUE"
        }

        dataSource_users {
            dbCreate = "update" 
            url = "jdbc:h2:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }
    }
    test {
        dataSource {
            dbCreate = "update"
            url = "jdbc:h2:mem:testDb;MVCC=TRUE"
        }

        dataSource_users {
            dbCreate = "update"
            url = "jdbc:h2:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }
    }
    production {
        dataSource {
            dbCreate = "create-drop"
            url = "jdbc:h2:mem;MVCC=TRUE"
            pooled = true
            properties {
               maxActive = -1
               minEvictableIdleTimeMillis=1800000
               timeBetweenEvictionRunsMillis=1800000
               numTestsPerEvictionRun=3
               testOnBorrow=true
               testWhileIdle=true
               testOnReturn=true
               validationQuery="SELECT 1"
            }
        }

        dataSource_users {
            dbCreate = "update"
            url = "jdbc:h2:prodDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T17:29:29.103

我设法用一个相当草率的解决方法来抑制异常。希望它会帮助其他人，但如果有人有其他解决方案或对问题有任何见解，我很想听听。

无论如何，您想在适当的时候调用 merge() 而不是 save()。我不知道如何确定一个实例是否在多个会话中被引用，所以我只是将每个保存包装在一个 try-catch 块中，然后在出现异常时调用 merge() 。这不是最漂亮的解决方案，但它有效。

```
def customerService = AH.application.mainContext.customerService
instance.customer = customerService.retrieveCustomer instance
instance.name = instance.customer?.name ?: instance.domain?.tokenize('.')[0].capitalize() ?: ''

Instance.withTransaction{
    try{ instance.customer.save() } 
    catch (Exception e) { instance.customer.merge() }

    try { instance.save() } 
    catch (Exception e) { instance.merge() }                    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:32:15.223

在 Hibernate 中，每个`PersistedCollection`（Hibernate 为您的任何集合关系放置的包装类）都与一个`Session`实例相关联。这是 Hibernate 所做的工作的一部分，以确保`Session`维护实例身份的级别保证。

您收到的错误表明您在 one 中加载了一个带有集合的实体`Session`，然后`.save()`在另一个中尝试了它`Session`。这可能行不通，除非您首先将该实体与另一个相关联，`Session`您可以通过调用`otherSession.merge(entity)`. 这就是为什么您的解决方法“有效”的原因。

您应该查看 Hibernate 文档的[这一部分](http://docs.jboss.org/hibernate/orm/3.3/reference/en-US/html/objectstate.html#objectstate-replicating)，它处理从一个数据源到另一个数据源的复制。我不确定是否`replicate`在 Ruby/Grails 中可用......

# java - 使用包含 CDATA 的 XML 配置 MOXy 的 @XmlPath

> ID：15534466
> 
> 赞同：1
> 
> 时间：2013-03-20T20:51:06.383
> 
> 标签：java, jaxb, eclipselink, moxy

我正在尝试使用 XPath 通过[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)映射 XML 文档。但是当 XML 包含 CDATA 标记时会遇到问题示例：

```
<![CDATA[Jill's Box Company]]> 
```

我正在使用 eclipselink-2.3.0 jar 在我的应用程序中获取 XPath 映射。为了让 JAXB 使用这个实现，我正在创建一个`jaxb.properties`包含以下内容的文件：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

XPath 只能以这种方式工作，否则应用程序甚至不会获取注释`@XmlPath`。

现在，在通过 unmarshaller 方法运行 XML 时，它会抛出一个空指针错误，如下所示：

```
java.lang.NullPointerException
    at org.eclipse.persistence.oxm.record.UnmarshalRecord.startCDATA(UnmarshalRecord.java:1035)
    at org.eclipse.persistence.internal.oxm.record.XMLReader$LexicalHandlerWrapper.startCDATA(XMLReader.java:226)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startCDATA(AbstractSAXParser.java:625)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:487)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)
    at weblogic.xml.jaxp.WebLogicXMLReader.parse(WebLogicXMLReader.java:133)
    at weblogic.xml.jaxp.RegistryXMLReader.parse(RegistryXMLReader.java:173)
    at org.eclipse.persistence.internal.oxm.record.XMLReader.parse(XMLReader.java:147)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshaller.unmarshal(SAXUnmarshaller.java:713)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshaller.unmarshal(SAXUnmarshaller.java:286)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshaller.unmarshal(SAXUnmarshaller.java:260)
    at org.eclipse.persistence.internal.oxm.record.SAXUnmarshaller.unmarshal(SAXUnmarshaller.java:505)
    at org.eclipse.persistence.oxm.XMLUnmarshaller.unmarshal(XMLUnmarshaller.java:594)
    at org.eclipse.persistence.jaxb.JAXBUnmarshaller.unmarshal(JAXBUnmarshaller.java:269)
    at com.jbhunt.lib.mgintegrationutils.utils.JAXBUtils.unmarshal(JAXBUtils.java:67)
    at com.jbhunt.biz.mgarListener.mq.converter.MgarListenerMQMessageParser.getMasterARStagingVo(MgarListenerMQMessageParser.java:51)
    at com.jbhunt.biz.mgarListener.mq.MgarListenerMessageConsumerImpl.onMessage(MgarListenerMessageConsumerImpl.java:62)
    at com.jbhunt.biz.mgarListener.mq.JMSMessageProcessor.receiveAndProcessMessage(JMSMessageProcessor.java:106)
    at com.jbhunt.biz.mgarListener.thread.MessageProcessorThread.run(MessageProcessorThread.java:46)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T10:12:43.623

**更新**

> 嗨 Blaise，我将 eclipse 版本更新到 2.4.1，它解决了我面临的 CDATA 问题。现在一切都很好。

我很高兴听到现在一切正常。下面是一篇关于 EclipseLink 2.4 中 MOXy 新特性的文章：

*   [http://blog.bdoughan.com/2012/06/eclipselink-24-release-available-for.html](http://blog.bdoughan.com/2012/06/eclipselink-24-release-available-for.html)

* * *

由于您使用的是 EclipseLink 2.3.0，我相信您遇到了以下在 EclipseLink 2.3.1 中修复的错误。

*   [http://bugs.eclipse.org/357145](http://bugs.eclipse.org/357145)

EclipseLink 目前是 2.4.1 版本，如果可以的话，我建议升级到该版本：

*   [http://www.eclipse.org/eclipselink/downloads/](http://www.eclipse.org/eclipselink/downloads/)

# c# - C#如何使存储的文件上限为100项？

> ID：15534472
> 
> 赞同：1
> 
> 时间：2013-03-20T20:51:22.893
> 
> 标签：c#

我正在尝试制作一个小程序来获取用户输入并将其存储在文件中，但我希望该文件最多包含 100 个元素：

假设用户添加了 100 个名称，用户添加的下一个名称将显示一条消息“列表已满”

这是我到目前为止所做的代码：

```
 public Form1()
    {
        InitializeComponent();
    }
    private string SongName, ArtistName;

    public void Registry()
    {
        List<Name> MusicList = new List<Name>(); //Create a List
        MusicList.Add(new Name(SongName = txtSongName.Text, ArtistName = txtArtistName.Text)); //Add new elements to the NameClass

        //check if the input is correct
        if (txtSongName.TextLength < 1 || txtArtistName.TextLength < 1)
        {
            Info info = new Info();
            info.Show();
        }
        else //if input is correct data will be stored
        { 
            //Create a file to store data
            StreamWriter FileSaving = new StreamWriter("MusicList", true);
            for (int i = 0; i < MusicList.Count; i++)
            {
                string sName = MusicList[i].songName; //Create new variable to hold the name
                string aName = MusicList[i].artistName; //Create new variable to hold the name
                FileSaving.Write(sName + " by "); //Add SongName to the save file
                FileSaving.WriteLine(aName); //Add ArtistName to the save file

            }
            FileSaving.Close();
        }
    }

    private void btnEnter_Click(object sender, EventArgs e)
    {
        Registry();
        //Set the textbox to empty so the user can enter new data
        txtArtistName.Text = "";
        txtSongName.Text = "";
    }

    private void btnClose_Click(object sender, EventArgs e)
    {
        Application.Exit();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:53:20.313

```
 private const int MAX_STORED_SONGS = 100;//as class level field

 for (int i = 0; i < MusicList.Count && i < MAX_STORED_SONGS; i++)

 //...after the loop
 if( MusicList.Count > MAX_STORED_SONGS )
    errorMessageLabel.Text = "List is full, only 100 items added" 
```

我不确定您的列表选择器是什么样的，但您可能希望通过在提交页面之前使用一些 javascript/validation 客户端来实际阻止他们选择 100 多个项目。

您的代码不清楚的是，当用户提交一首歌曲时，您创建一个新的空 MusicList，向其中添加一个项目，但您循环遍历它，就好像有多个项目一样。也许您应该首先阅读文件以确定其中有多少首歌曲，这样您就可以确定它何时为 100 首歌曲。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T20:56:36.217

您可能希望尝试使用 xml 为您的数据提供一些结构。

如果您想将其保留为当前格式，您唯一的选择是计算文件中的 NewLines，并查看该计数加上音乐列表中的任何新项目是否超过了您的限制。

```
List<string> lines = new List<string>(System.IO.File.ReadAllLines(MyFile));
lines.Add(sName + " by " + aName);

int lineCount = lines.Count;
//limit reached
if(lineCount > 100 )
{
    //TODO: overlimit code
} else {
    System.IO.File.WriteAllLines(MyFile, lines.ToArray());
} 
```

# gtk - 如何在 Gtk+3 中创建固定大小的 Gtk.TextView？

> ID：15534475
> 
> 赞同：3
> 
> 时间：2013-03-20T20:51:38.167
> 
> 标签：gtk, textview, gtk3

我在 Gtk.Fixed 中有一个 Gtk.TextView，我将其设置为宽度和高度以及环绕模式。

我的问题是，当用户插入的文本超出设置的大小时，我需要避免 TextView 扩展。在那种情况下，我只需要阻止用户继续写作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-15T07:46:21.137

如果你有一个单行条目作为输入，最好使用 textentry 而不是 textview。对于文本输入，您可以设置文本输入的最大长度。

用于使用 glade 开发 UI。此外，如果您的 UI 根据来自服务器的配置文件而更改，也有一个解决方案，在窗口中显示所有小部件，根据来自服务器的配置文件显示/隐藏小部件。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-11T16:10:49.077

为什么不使用 GLADE 进行 UI 开发？它提供了更方便的方法来完成您的任务。

在 Glade 中，您可以设置所有选项，您可以交叉验证和实时检查。

# asp.net - ASP VB - 如何使用数据源更新所选项目来自下拉列表的数据库

> ID：15534479
> 
> 赞同：1
> 
> 时间：2013-03-20T20:51:58.353
> 
> 标签：asp.net

嗨，我是 ASP 新手，能够创建一个下拉列表，其中列出了我表中的所有项目`(DB2_INSTANCES)`。

现在我需要`PROCESS`使用选定的 DB2_DSN 值更新第二个表 ( )。`The table does not allow Null values`.

如果我`"SelectedValue='<%# Bind("DB2_DSN") %>'`在`asp:DropDownList`我设置后使用

`DataSourceID="SqlDataSource6" DataTextField="INSTANCE" DataValueField="INSTANCE"`

我收到一个错误：

> “'DropDownList6' 有一个无效的 SelectedValue，因为它不存在于项目列表中。参数名称：值”

`"SelectedValue='<%# Bind("INSTANCE") %>'`如果我`asp:DropDownList`在设置后更改为

`DataSourceID="SqlDataSource6" DataTextField="INSTANCE" DataValueField="INSTANCE"`

我收到一个错误：

> “DataBinding：‘System.Data.DataRowView’不包含名为‘INSTANCE’的属性。”

如果我删除“ `SelectedValue`...”，我会收到错误消息：

> 无法将值 NULL 插入列“DB2_DSN”、表“xxx.dbo.PROCESS”；列不允许空值。更新失败。该语句已终止。

我也尝试过使用，`DataBind()`但它也给了我一个错误。另一个值`(FTP_IND)`可以正常工作，因为它是列出/硬编码的。为什么它适用于`FTP_IND`而不适用于`DB2_DSN`？

第一的：

```
<asp:SqlDataSource ID="SqlDataSource3" runat="server" 
    ConnectionString="<%$ ConnectionStrings:xxxConnectionString2 %>" 
    DeleteCommand="DELETE FROM PROCESS WHERE NAME = @NAME AND ENVIRONMENT =   @ENVIRONMENT"
    SelectCommand="SELECT * FROM [PROCESS]" 
    UpdateCommand="UPDATE PROCESS SET ENVIRONMENT = @ENVIRONMENT, PROCESS_STATUS = @PROCESS_STATUS, IC_VALUE = @IC_VALUE, 
    FTP_IND = @FTP_IND, DB2_DSN = @DB2_DSN, DB2_REGION = @DB2_REGION, 
    ALERT_EMAIL = @ALERT_EMAIL, NOTIFY_EMAIL = @NOTIFY_EMAIL, DEBUG_INFO = @DEBUG_INFO, 
    LAST_UPDATE_DATE = CURRENT_TIMESTAMP, LAST_UPDATE_USERID = @UID, LAST_UPDATE_IP = @UIP WHERE (NAME = @NAME)">
        <UpdateParameters>
        <asp:SessionParameter Name="UID" SessionField="User_ID" Type="String" />
        <asp:SessionParameter Name="UIP" SessionField="User_IP" Type="String" />
        <asp:Parameter Name="ENVIRONMENT" />
        <asp:Parameter Name="PROCESS_STATUS" />
        <asp:Parameter Name="IC_VALUE" />
        <asp:Parameter Name="FTP_IND" />
        <asp:Parameter Name="DB2_DSN" />
        <asp:Parameter Name="DB2_REGION" />
        <asp:Parameter Name="ALERT_EMAIL" />
        <asp:Parameter Name="NOTIFY_EMAIL" />
        <asp:Parameter Name="DEBUG_INFO" />
        <asp:Parameter Name="NAME" />
    </UpdateParameters>
</asp:SqlDataSource>
<asp:SqlDataSource ID="SqlDataSource6" runat="server" 
    ConnectionString="<%$ ConnectionStrings:xxxConnectionString2 %>" 
    SelectCommand="SELECT [INSTANCE] FROM [DB2_INSTANCES] ORDER BY [INSTANCE] ASC">
</asp:SqlDataSource> 
```

第二：

```
<asp:TemplateField HeaderText="FTP" SortExpression="FTP_IND">
            <EditItemTemplate>
                <asp:DropDownList ID="DropDownList5" runat="server"  
                    SelectedValue='<%# Bind("FTP_IND") %>' 
                    ToolTip="Use this to turn off and on the FTP process" Font-Size="Small">
                    <asp:ListItem>N</asp:ListItem>
                    <asp:ListItem>Y</asp:ListItem>
                </asp:DropDownList>
            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label11" runat="server" Text='<%# Bind("FTP_IND") %>' 
                    ToolTip="Indicates if FTP will take place" Font-Size="Small">
                </asp:Label>
            </ItemTemplate>
            <ItemStyle Font-Size="Small" HorizontalAlign="Center" />
        </asp:TemplateField>

        <asp:TemplateField HeaderText = "DB2 Instance" SortExpression="DB2_DSN">
            <EditItemTemplate>
                <asp:DropDownList ID="DropDownList6" runat="server" 
                    ToolTip="Use this to choose the DB2 Instance" Font-Size="Small" 
                    DataSourceID="SqlDataSource6"
                    DataTextField="INSTANCE" 
                    DataValueField="INSTANCE">
                 </asp:DropDownList>
            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label12" runat="server" Text='<%# Bind("DB2_DSN") %>'
                    ToolTip="Indicates the DB2 Instance being used" Font-Size="Small">
                </asp:Label>
            </ItemTemplate>
            <ItemStyle Font-Size="Small" HorizontalAlign="Center" /> 
```

# jquery - 只有其他的 li 受到简单的 mouseover mouseout 模态窗口代码的影响

> ID：15534485
> 
> 赞同：1
> 
> 时间：2013-03-20T20:52:45.823
> 
> 标签：jquery

我正在尝试编写简单的代码，当它们相应的“信息 div”悬停时，允许特定的 div 淡入和淡出。我有八个列表项和八个相应的“信息 div”。当第一个 li 悬停在上面时，相应的“info div”应该淡入，并且确实如此。但是当我将鼠标悬停在第二个 li 上时，第三个“信息 div”会淡入。第三个 li 会影响第五个，依此类推。我已经包含了 jQuery 代码。任何帮助，将不胜感激。谢谢。

```
 $(document).ready(function(){
        $('.case-info').hide();
        $('#text323-b li').mouseover(function(){
            var x = $(this).index();
            $('.case-info').eq(x).fadeIn();
        });
        $('#text323-b li').mouseout(function(){
            var x = $(this).index();
            $('.case-info').eq(x).fadeOut(function(){
                $(this).hide();
            });
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:13:11.237

我将在黑暗中尝试一下，并假设您的 LI 列表中有其他标记，例如一些`<br />`ro 一些这样的，这可以解决：

```
$('.case-info').hide();
$('#text323-b li').mouseover(function () {
    var x = $(this).index('#text323-b li');
    $('.case-info').eq(x).fadeIn();
}).mouseout(function () {
    var x = $(this).index('#text323-b li');
    $('.case-info').eq(x).fadeOut(function () {
        $(this).hide();
    });
}); 
```

# php - php语法问题

> ID：15534487
> 
> 赞同：-1
> 
> 时间：2013-03-20T20:53:00.890
> 
> 标签：php, html

我是 php 新手...这是 wordpress。这里有什么问题？每个循环都很简单...

```
<?php
    foreach( $how_posts as $post ) : setup_postdata($post);
    echo '<li><a href="#section_' . get_post_meta($post->ID, 'sub_nav_name', true); . '">' . the_title(); . '</a></li>';
    $nav_items[] = html_entity_decode(get_the_title(), ENT_QUOTES, 'UTF-8');
    endforeach; 
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:55:32.490

去掉`;`函数末尾的

```
echo '<li><a href="#section_' . get_post_meta($post->ID, 'sub_nav_name', true) . '">' . the_title() . '</a></li>'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T21:00:04.153

这里有几件事你应该注意。

**1）您的代码中间有分号：**

```
echo '<li><a href="#section_' . get_post_meta($post->ID, 'sub_nav_name', true); . '">' . the_title(); . '</a></li>';
// Should be:
echo '<li><a href="#section_' . get_post_meta($post->ID, 'sub_nav_name', true) . '">' . the_title() . '</a></li>'; 
```

**2)`endforeach`使用“替代”语法：**

为了标准、可读性和防止下一个必须阅读您的代码的人追捕您并用生锈的刀刺伤您，应尽可能避免使用备用 PHP 语法。

因为这些语法是“替代的”，所以可以安全地假设这些不是执行操作的推荐方法。虽然它们确实有效并且目前没有任何弃用此功能的计划，但我不会长期指望它们，因为 PHP 开始卷入它的失控方法。

```
foreach( $how_posts as $post ) :
// Should be:
foreach( $how_posts as $post ) {

and

endforeach;
// Should be:
} 
```

**例子：**

```
<?php
foreach($how_posts as $post) {
  setup_postdata($post);
  echo '<li><a href="#section_' . get_post_meta($post->ID, 'sub_nav_name', true) . '">' . the_title() . '</a></li>';
  $nav_items[] = html_entity_decode(get_the_title(), ENT_QUOTES, 'UTF-8');
} 
```

# php - CakePHP 和 Ajax 请求网址

> ID：15534488
> 
> 赞同：1
> 
> 时间：2013-03-20T20:53:06.620
> 
> 标签：php, ajax, cakephp

我目前在我的应用程序的多个控制器中使用 ajax。我使用 jQuery 支持的版本实现了 ajax 功能。

```
$.ajax({
    url:'getCountries',
    type: "POST",
    dataType: "html",
    data:"data=" + result,
    success: function(data){
                    //magic...
        }
    }
}); 
```

正如您从上面的代码中看到的，此请求的 url 是“getCountries”。这意味着如果请求来自

```
http://localhost/appname/controllername/methodname 
```

请求网址将是

```
http://localhost/appname/controllername/getCountries 
```

但是，如果您使用此脚本的 url 与上面的示例不同，请说

```
http://localhost/appname/controllername/methodname/7 
```

（就像在编辑视图中一样），那么来自这些 url 的 ajax 调用中的请求 url 将更改为

```
http://localhost/appname/controllername/methodname/getCountries 
```

我怎样才能使它根据我当前所在的控制器自动生成请求 url？

请注意，url 路径中的**appname**是应用程序根文件夹的名称，它也应该包含在内，这样如果文件将被传输到不同的服务器/位置，javascript 链接也将与根文件夹保持一致.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:24:36.457

试试这个

```
 $.ajax({
url:"<?php echo $this->webroot . $this->params["controller"]; ?>/yourAction"
}); 
```

`$this->webroot` 包含您的 webroot 的路径，例如，如果您的应用程序文件夹位于 htdocs/test 并且您使用它进行访问它时`localhost/test/` `$this->webroot`将包含以下字符串`'/test/'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T09:39:31.730

我认为您应该在 Ajax 调用中使用完整路径，如果您在多个视图中使用此代码，您可以在某个变量中传递 ControllerName：

```
$.ajax({
       url: http://localhost/appname/<?php echo $controllerName; ?>/getCountries
       // code
}); 
```

在这种情况下，您需要使用 View 或 Element 文件（带有 *.ctp 扩展名）将变量回显到 JavaScript 代码。或者，您可以将其回显到视图中的某个 JavaScript 变量，并将其传递给您的外部 *.js 脚本文件。

它在类似情况下对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-23T08:32:39.750

利用

```
echo Router::url(array('controller' => 'controllername', 'action' => 'methodname',7)); 
```

会输出；

```
/controllername/methodname/7 
```

在js中

```
$.post({url : "<?php echo Router::url(array('controller' => 'controllername', 'action' => 'methodname',7)); ?>"}) 
```

# angularjs - AngularJS - 在页面加载时将数据引导到服务中

> ID：15534490
> 
> 赞同：5
> 
> 时间：2013-03-20T20:53:13.387
> 
> 标签：angularjs, bootstrapping, angularjs-service

在 angularjs 应用程序中，我试图使用自定义服务来保存应用程序的主要数据“项目”。但是，我想在初始页面加载时将数据引导到服务中，以避免向服务器发出单独的 ajax 请求来获取它。这样做最干净的方法是什么？

这是我的服务片段供参考：

```
app.factory('items', function() {
    var itemsService = {},
        items = [];

    itemsService.list = function() {
        return items;
    };

    itemsService.add = function() {
        /* ... */
    };

    return itemsService;
}); 
```

在后端，我使用的是 node.js + expressjs + jam，所以我将使用以下方法将数据注入页面：

```
!{JSON.stringify(items)} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:16:07.937

将来自服务器的引导数据放入全局 JavaScript 变量中。让您的服务分配`items`给该全局变量（或将数据复制到`items`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:03:01.950

像这样的东西怎么样：

```
app.run(['items', function (items) {
   items.load();
}]) 
```

这假定您的`items`服务具有`load`使用 $http 或 $resource 执行实际 Ajax 工作的功能（或类似功能）。

# mysql - Wordpress MySQL 查询类别页面

> ID：15534494
> 
> 赞同：0
> 
> 时间：2013-03-20T20:53:24.947
> 
> 标签：mysql, wordpress, categories

我在我的 wordpress index.php 上使用这个查询来显示帖子并按日期对它们进行排序（最早的第一个 ASC）。我使用这个数据库查询是因为 query_posts 出于某种原因对我不起作用。

[http://pastebin.com/e7vVyKP9](http://pastebin.com/e7vVyKP9)

现在我想在我的类别页面上使用完全相同的查询。我必须以某种方式添加一些行，以便仅显示处于活动状态的类别的帖子。

有没有人有办法解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:36:04.057

好的，根据您发布的信息，您可以使用以下内容：

```
$args = array( 'post_status' => array( 'publish', 'future' ), 'post_type' => 'post','orderby' => 'date', 'order' => 'ASC' );

$the_query = new WP_Query( $args );

while ( $the_query->have_posts() ) :
        $the_query->the_post();
        the_time('l, F jS, Y');
        the_content();
        the_category();
endwhile;

wp_reset_postdata(); 
```

## 根据要求更新

```
get_header(); ?>

    <section id="primary" class="site-content">
        <div id="content" role="main">

        <?php if ( have_posts() ) : ?>
            <header class="archive-header">
                <h1 class="archive-title"><?php printf( __( 'Category Archives: %s' ), '<span>' . single_cat_title( '', false ) . '</span>' ); ?></h1>

            <?php if ( category_description() ) : // Show an optional category description ?>
                <div class="archive-meta"><?php echo category_description(); ?></div>
            <?php endif; ?>
            </header><!-- .archive-header -->

            <?php
            $args = array( 'post_status' => array( 'publish', 'future' ), 'post_type' => 'post','orderby' => 'date', 'order' => 'ASC' );

            $the_query = new WP_Query( $args );

            while ( $the_query->have_posts() ) :
                    $the_query->the_post();
                    the_time('l, F jS, Y');
                    the_content();
                    the_category();
            endwhile;

            wp_reset_postdata();
            ?>

        <?php else : ?>

        <?php endif; ?>

        </div><!-- #content -->
    </section><!-- #primary -->

<?php get_sidebar(); ?>
<?php get_footer(); ?> 
```

这是一个二十二个类别的页面，显示： [**这个页面**](http://davidchase.koding.com/kodingwp/?cat=1)

# debugging - 使用 Chrome 远程调试时，是否可以通过手机连接到桌面上的 Apache？

> ID：15534495
> 
> 赞同：0
> 
> 时间：2013-03-20T20:53:41.970
> 
> 标签：debugging, google-chrome

我正在这样做（Chrome 远程调试）：[https ://developers.google.com/chrome-developer-tools/docs/remote-debugging](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)

我希望能够从我的手机访问 localhost 或我的任何虚拟主机（通过我桌面上的 apache），以便我可以调试本地站点。

有没有办法做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:30:42.017

我是否正确理解您在工作站上运行 Apache 并希望将您的手机连接到其上托管的网站？

是的，这是可能的。最简单的方法是将手机连接到工作站所在的同一网络 (WiFi)，然后将手机连接到`http://IP-ADDRESS-OF-WORKSTATION`. 然后像往常一样使用远程调试。

或者，您需要配置您的 WiFi 路由器以启用端口转发。基本思想是您的 WiFi 路由器控制您的私人家庭网络（您的工作站所在的位置）和公共 Internet（您的电话所在的位置）之间的流量，并且端口转发允许来自 Internet 的入站流量路由到您的专用网络。

这是我的 WiFi 路由器的配置页面。我的工作站的私有 IP 地址是**192.168.1.5**并且我在默认端口**80**上运行 Apache 。如果我的公共 IP 地址是**8.8.8.8**，那么我将`http://8.8.8.8:3000`在手机的浏览器中输入，路由器会将请求重定向到我的工作站`192.168.1.5:80`。

![在此处输入图像描述](../Images/a804b26a38327a46f3cc30e2fb7de51b.png)

在任一设置中，您都需要找到工作站的私有 IP 地址（例如，使用 Mac OS X 上 WiFi 状态图标中的“打开网络首选项”）。您只需在工作站上搜索“我的 IP 地址”即可找到 WiFi 路由器的公共 IP 地址。

显然，第一种方法（将您的手机和工作站放在同一网络上）要简单得多。端口转发可能很难调试，并且每个路由器的配置都略有不同。如果您在某个地方遇到困难，请发布后续问题。

# c# - 编写可以处理多个数据库对象的代码

> ID：15534497
> 
> 赞同：0
> 
> 时间：2013-03-20T20:53:49.660
> 
> 标签：c#, linq, linq-to-sql

我基本上有两个不同的数据库，其中有不同的表，但它们都有具有完全相同结构的“Table1”。

```
var db = new ???;
if(mode == "PRODUCTION"){
    db = new Database1("Connection string for Database1");
}
else{
    db = new Database2("Connection string for Database2");
}

var result = db.Table1.Where(a=>a.Value==1).First(); 
```

如何进行上述工作，以便我可以从两个不同的数据库（取决于“模式”）分配“结果”，而无需为“结果”编写两个不同的定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T20:55:37.777

将连接字符串单独存储在配置文件中。然后，您可以在运行时交换连接字符串以将数据库对象指向正确的数据库：

```
if(mode == "PRODUCTION")
{
    db = new Database(ConfigurationManager.ConnectionStrings["production-key"]);
}
else
{
    db = new Database(ConfigurationManager.ConnectionStrings["dev-key"]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T20:57:39.660

贾斯汀的观点很好，这是另一个——

为什么要在数据库级别这样做？

像这样的东西会起作用

```
var table;

if(mode == "PRODUCTION"){
    db = new Database1("Connection string for Database1");
    table = db.table1;
}
else{
    db = new Database1("Connection string for Database2");
    table = db.table1
}

var result = table.Where(a=>a.Value==1).First(); 
```

如果您没有完全相同的 db，那么您将需要执行类似的操作（您还可以向 db1 和 db2 添加一个接口以返回 commonElements - 如您所愿。

```
class commonElements {
   /// some code
}

public commoneElements GetCommon(Database1 inDB1) {
   /// some code
}

public commoneElements GetCommon(Database2 inDB2) {
   /// some code
}

commonElements common;
if(mode == "PRODUCTION"){
    db1 = new Database1("Connection string for Database1");
    common = GetCommon(db1);
}
else{
    db2 = new Database2("Connection string for Database2");
    common = GetCommon(db2);
}

var result = common.Where(a=>a.Value==1).First(); 
```

# ruby-on-rails - Rails vestal_versions gem 创建版本而不保存父版本

> ID：15534502
> 
> 赞同：0
> 
> 时间：2013-03-20T20:54:05.887
> 
> 标签：ruby-on-rails, ruby, vestal-versions

我有兴趣在我的 rails 应用程序中使用 vestal_versions gem，但我想知道是否有人知道是否有任何方法可以创建新版本，但实际上并没有更新关联的 ActiveRecord。

例如，如果我有一个名字为“jim”的用户，并且我创建了一个名字为“steve”的新版本，我希望能够在不更改父记录的情况下保留该版本，直到我以后想要时间（使用 revert_to!(newer_version) 或类似的）。

如果这没有内置到 gem 中，关于我应该从哪里开始修补的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T18:47:34.233

在调查了这个 gem 的行为之后，我发现这不是 vestal_versions 真正设置要做的事情。

您可以通过以下方式强制执行此行为：

```
def create_version
  merge_version_changes
  create_version
end 
```

在“版本化”模型中，但是当您使用时，它会创建一个新版本，其中包含您在实时 ActiveRecord 中所做的更改而不修改父对象的表：

```
blah = Blah.first
blah.version 
```

它会告诉您您正在使用最新版本，但不会加载该数据（因为它从未更改过）。如果您使用：

```
blah.revert_to(:last) 
```

它不会更改您的记录，因为它认为您已经在使用最新版本。ETC..

长话短说，vestal_versions 不打算有这种行为，也不应该期望它这样做。我现在正在调查 has_drafts gem，因为它似乎更接近我想要做的事情。

# objective-c - [__NSCFDictionary objectAtIndex:]：无法识别的选择器发送到实例

> ID：15534504
> 
> 赞同：1
> 
> 时间：2013-03-20T20:54:16.443
> 
> 标签：objective-c, xcode, json, parsing, uitableview

我正在尝试将 Json 文件解析到表视图中，但出现此错误

[__NSCFDictionary objectAtIndex:]：无法识别的选择器发送到实例并且应用程序正在崩溃。请帮助我，我是iOS开发的新手。

我的代码

```
@implementation ViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
    // Custom initialization
}
    return self;
}

- (void)viewDidLoad
{
    self.title = @"Feeds";
    [super viewDidLoad];
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;

    NSURL *url = [NSURL URLWithString:@"http://little-people.blogspot.com/feeds/posts        /default?alt=json"];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [[NSURLConnection alloc] initWithRequest:request delegate:self];
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    data = [[NSMutableData alloc] init];
    NSLog(@"Data Data , %@", data);
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)theData
{
    [data appendData:theData];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;

    feed = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:nil];
    NSLog(@"Data  , %@", feed);
    [mainTableView reloadData];
}
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    UIAlertView *errorView = [[UIAlertView alloc] initWithTitle:@"Error" message:@"The download   could not complete - please make sure you're connected to either 3G or Wi-Fi." delegate:nil cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
    [errorView show];
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
}

- (int)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}    

- (int)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [feed count];
    NSLog(@"Data Data , %@", feed);
 }
  - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath    *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MainCell"];

    if(cell == nil){
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"MainCell"];
}
if (([feed count] - 1) >=indexPath.row) {

    cell.textLabel.text = [[feed objectAtIndex:indexPath.row] objectForKey:@"feed"];
    cell.detailTextLabel.text = [[feed objectAtIndex:indexPath.row] objectForKey:@"title"];
}

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T15:51:06.083

问题是`feed`不是 a `NSArray`，而是 a `NSDictionary`。

查看 JSON，您可能想要访问此数组：`[feed objectForKey:@"entry"]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T15:54:46.763

Feed 中的顶级对象是 JSON 对象，而不是 JSON 数组。所以反序列化给你一个 NSDictionary，而不是一个 NSArray。

# .htaccess - 自定义 301 使用 .htaccess 从旧的 joomla (mambo) 网站重定向到新的 drupal 7 网站

> ID：15534509
> 
> 赞同：0
> 
> 时间：2013-03-20T20:54:36.310
> 
> 标签：.htaccess, drupal-7

在过去的几个小时里，我正在尝试使用我的 drupal 根目录中存在的 .htaccess 文件创建从旧 mambo 网站到新的 drupal 7 网站的自定义重定向。我想做的是...

301重定向

[http://mysite.com/index.php?option=com_content&task=blogsection&id=11&Itemid=54](http://mysite.com/index.php?option=com_content&task=blogsection&id=11&Itemid=54)

至

[http://mysite.com/this-is-the-new-page](http://mysite.com/this-is-the-new-page)

这是我的 .htaccess 文件...

```
RewriteEngine on

RewriteRule ^index.php?option=com_content&task=blogsection&id=11&Itemid=54$ http://mysite.com/this-is-the-new-page [R=301,L]

RewriteRule "(^|/)\." - [F]

RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ http://%1%{REQUEST_URI} [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !=/favicon.ico
RewriteRule ^ index.php [L] 
```

我确信它与这条线有关......

```
RewriteRule ^ index.php [L] 
```

但我不明白！你看看我是否使用这个...

```
RewriteRule ^option=com_content&task=blogsection&id=11&Itemid=54$ http://mysite.com/this-is-the-new-page [R=301,L] 
```

而不是这个...

```
RewriteRule ^index.php?option=com_content&task=blogsection&id=11&Itemid=54$ http://mysite.com/this-is-the-new-page [R=301,L] 
```

并使用 firefox 和 LiveHTTP Headers 插件对其进行测试，它可以工作！

有什么建议么？！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:05:58.640

查询字符串不是[URL 路径模式](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)的一部分。如果要基于查询字符串建立规则，则必须在[`RewriteCond`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)

```
RewriteEngine on
RewriteCond %{QUERY_STRING} option=com_content&task=blogsection&id=11&Itemid=54
RewriteRule ^index.php$ /this-is-the-new-page? [R,L] 
```

# c# - 基于角色的控制器访问

> ID：15534512
> 
> 赞同：1
> 
> 时间：2013-03-20T20:54:41.347
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

我要新的 asp.net 和 asp.net MVC。我试图根据他的角色向用户显示一个页面。

```
public class HomeController : Controller
{
    [Authorize(Roles = "Reviewer")]
    public ActionResult Index()
    {
        ViewBag.Title = "Reviwer";
        return View();
    }

    [Authorize(Roles="User")]
    public ActionResult Index()
    {
        return View();
    }
} 
```

我的代码是上面的代码，它不会像这样编译是完全有道理的，我不能使用同名的两个相同的方法。但是有人可以指出我正确的方向。我应该如何根据用户的角色向用户显示不同的页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:05:29.683

如果它们**必须**是两个独立的动作，那么根据角色命名它们更有意义，如下所示：

```
public class HomeController : Controller
{
    [Authorize(Roles = "Reviewer")]
    public ActionResult Reviewer()
    {
        ViewBag.Title = "Reviewer";
        return View();
    }

    [Authorize(Roles="User")]
    public ActionResult User()
    {
        return View();
    }
} 
```

如果您可以将它们合二为一，您可以这样做：

```
public class HomeController : Controller
{
    [Authorize(Roles = "Reviewer", "User")]
    public ActionResult Index()
    {
        if (User.IsInRole("Reviewer"))
        {
            return View("Reviewer");
        }
        else
        {
            return View("User");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:07:21.203

每个角色是否有不同的视图，或者只是您希望根据角色的不同而拥有不同的头衔？

您可以做的是将角色组合到单个 Controller 方法中，然后在该方法内部具有条件逻辑，例如：

```
public class HomeController : Controller
{
    [Authorize(Roles = "Reviewer, User")]
    public ActionResult Index()
    {
        if (Roles.IsUserInRole("Reviewer"))
        {
            ViewBag.Title = "Reviwer";
        }

        return View();
    }
} 
```

如果您所做的只是更改标题。如果您想显示不同的视图或将它们[重定向](http://msdn.microsoft.com/en-us/library/dd460241%28v=vs.108%29.aspx)到其他地方，您可以这样做：

```
 [Authorize(Roles = "Reviewer, User")]
    public ActionResult Index()
    {
        if (Roles.IsUserInRole("Reviewer"))
        {
            return View("ReviewerView");
        }
        else if (Roles.IsUserInRole("User"))
        {
            //Or do a RedirectToAction("SomeAction")
            return View("UserView");
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:03:48.290

在操作中测试用户是否处于角色中并返回不同的视图或重定向到不同的操作。

您可以尝试以下方法：

```
public class HomeController : Controller
{
    [Authorize(Roles = "Reviewer,User")]
    public ActionResult Index()
    {
    if (User.IsInRole("Reviewer")){

            ViewBag.Title = "Reviwer";
            return View("IndexReviwer");
     }
    return View();
    }
} 
```

需要创建一个名为 IndexReviwer 的 View

# .net - 使用依赖注入公开类的其他属性的最佳方法是什么

> ID：15534519
> 
> 赞同：0
> 
> 时间：2013-03-20T20:54:54.077
> 
> 标签：.net, dependency-injection

我可能以错误的方式处理这个问题。我希望对一类类使用依赖注入，以便在运行时基于设置我可以将正确的类解析为正确的类。我创建了一个接口，其中包含将在所有类中使用的基本属性和方法。一些类具有其他属性以扩展基本实现。除了反射或方法之外，还有其他方法可以获取和设置其他属性以公开/与客户端上的扩展属性交互吗？

如果这不是一个合适的用途，我会不会更好地不使用 DI 并坚持在客户端硬实例化这些类？

感谢您对此提出任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:52:07.907

> 我创建了一个接口，其中包含将在所有类中使用的基本属性和方法。

我假设这些*类*意味着*实现类*。

> 一些类具有其他属性以扩展基本实现。

对于进一步的讨论，您必须从这些类的客户的角度了解这些*其他属性*是否真的需要，或者它们是否实际上只是私有实现细节。

*   假设它们是私有的实现细节，那么你不应该让它们公开可见，你可以愉快地继续作为接口实例访问对象。

*   如果客户端需要使用*其他属性*，那么如果您通过接口实例上的反射来访问这些属性，那么您就违反了 LSP（Liskov 替换原则，[SOLID原则之一）。](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)请注意，这些原则不是规则，但遵循它们会对您有很大帮助。违反 LSP 告诉我你真的不想像你所做的那样抽象对象，在那个单一的接口后面。虽然在这种情况下使用 cast 或**as**或**is**运算符来查看实际类型是完全合法的，但它既不会在您的嘴里留下美味，也不会在之后产生良好的胃部感觉。

> 除了反射或方法之外，还有其他方法可以获取和设置其他属性以公开/与客户端上的扩展属性交互吗？

这是一种方式：

首先，今天这是您在没有额外属性的“简单”情况下所拥有的：

```
interface ICar
{
    void Accelerate();
}

class CompactCar : ICar
{
    public void Accelerate()
    {
        // Slooooow acceleration
    }
}

class NasCar : ICar
{
    public void Accelerate()
    {
        // Yiehaa!
    }
}

sealed class TrafficSimulator
{
    private readonly List<ICar> _cars = new List<ICar>();

    public void AddCar(ICar car)
    {
        _cars.Add(car);
        car.Accelerate();
    }
} 
```

然后您会发现自己为某些具体类型添加了一些属性，而为其他类型添加了一些其他属性：

```
class CompactCar : ICar
{
    // Can only be used *before* the car is accelerated
    public bool CanOnlyTurn { get; set; } 
    ...
}

class NasCar : ICar
{
    // Can only be used *after* the car is accelerated
    public string NumberPlate { get; set; }
    ...
}

sealed class TrafficSimulator
{
    ...
    public void AddCar(ICar car)
    {
        _cars.Add(car);

        // Check if there's something to do before accelerating
        CompactCar compact = car as CompactCar;

        if (compact != null)
        {
            compact.CanOnlyTurn = true;
        }

        car.Accelerate();

        // Check if there's something to do after accelerating
        NasCar nascar = car as NasCar;

        if (nascar != null)
        {
            nascar.NumberPlate = "I rule!";
        }
    }
} 
```

现在，当您继续这样做时，上述内容将变得一团糟。这就是违反 LSP 会给你带来的。总是有理由添加这些额外的属性。在上面的例子中，有时在加速之前做一件“特殊”的事情，在加速之后做另一件“特殊”的事情。

这种特定情况可以通过*以下方式*解决：

```
interface ICarSetup
{
    void BeforeAccelerate();
}

interface ICarTeardown
{
    void AfterAccelerate();
}

class ActionSetup : ICarSetup
{
    private readonly Action _action;

    public ActionSetup(Action action)
    {
        _action = action;
    }

    public void BeforeAccelerate()
    {
        _action();
    }
}

class NullSetup : ICarSetup
{
    public void BeforeAccelerate()
    {
    }
}

class ActionTeardown : ICarTeardown
{
    private readonly Action _action;

    public ActionTeardown(Action action)
    {
        _action = action;
    }

    public void AfterAccelerate()
    {
        _action();
    }
}

class NullTeardown : ICarTeardown
{
    public void AfterAccelerate()
    {
    }
}

sealed class TrafficSimulatorDriver
{
    private TrafficSimulator _trafficSimulator;

    public void RunTheSimulation()
    {
        var nascar = new NasCar();
        var nascarSetup = new NullSetup();
        var nascarTeardown = new ActionTeardown(() => nascar.NumberPlate = "I rule!");
        _trafficSimulator.AddCar(nascar, nascarSetup, nascarTeardown);

        var compact = new CompactCar();
        var compactSetup = new ActionSetup(() => compact.CanOnlyTurn = true);
        var compactTeardown = new NullTeardown();
        _trafficSimulator.AddCar(compact, compactSetup, compactTeardown);
    }
}

sealed class TrafficSimulator
{
    ...
    public void AddCar(ICar car, ICarSetup setup, ICarTeardown teardown)
    {
        _cars.Add(car);
        setup.BeforeAccelerate();
        car.Accelerate();
        teardown.AfterAccelerate();
    }
} 
```

> 如果这不是一个合适的用途，我会不会更好地不使用 DI 并坚持在客户端硬实例化这些类？

不要混淆这两个问题；DI 和硬实例化并不相互排斥。仅仅因为您不以接口实例的形式注入依赖项并不意味着您不能注入具体实例。

# flash - 矩形笔划线不缩放

> ID：15534520
> 
> 赞同：0
> 
> 时间：2013-03-20T20:54:55.277
> 
> 标签：flash

每当我调整对象的大小时，笔划的宽度不会随之调整大小。前几天它工作得很好，这让我相信我关掉了一些东西。我不确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:37:11.170

如果您选择一个形状并查看“属性”面板，则“填充和描边”选项卡下有一个“比例”设置。这控制了剪辑缩放时笔划的行为/

*   法线随剪辑一起缩放笔划。
*   Vertical 仅垂直缩放笔划。
*   水平仅水平缩放笔划。
*   无论剪辑的比例如何，无都不会缩放笔划。

# move - 带有徽标的闪屏淡入 + 上移

> ID：15534521
> 
> 赞同：0
> 
> 时间：2013-03-20T20:54:55.983
> 
> 标签：move, fade, splash-screen

我真的是 jquery 的新手......但我想对我的网站产生影响，希望你能帮助我。

我的意图是制作一个带有徽标 ( [http://oi49.tinypic.com/34ss55v.jpg](http://oi49.tinypic.com/34ss55v.jpg) ) 的闪屏，然后淡入显示，然后（2 秒后）向上移动徽标并让网站的其余部分出现。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:59:06.193

您可以使用 jQuery 的`fadeIn()`方法来显示启动画面。- [http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

之后，您将调用`fadeOut()`或`slideUp()`隐藏图形。

*   [http://api.jquery.com/fadeOut/](http://api.jquery.com/fadeOut/)
*   [http://api.jquery.com/slideUp/](http://api.jquery.com/slideUp/)

试试这个（最小的）例子：

```
<html>
  <head>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
  </head>
  <body>
    <div id="splash" style="display:none;"><img src="http://oi49.tinypic.com/34ss55v.jpg"/></div>

    <script>
      // Slowly fade in image (5 seconds) and then slide it up (2 seconds).
      $().ready(function() {
        $("#splash").fadeIn(5000).slideUp(2000);
      });

    </script>
  </body>
</html> 
```

希望有帮助:)

# javascript - 如何在不发送私钥的情况下获取新消息 SQS

> ID：15534552
> 
> 赞同：1
> 
> 时间：2013-03-20T20:56:14.987
> 
> 标签：javascript, amazon-web-services, amazon-sqs

我们想使用 SNS + SQS 为我们的系统创建类似推送的服务。我们知道我们可以做到并且我们目前正在这样做，问题是：

客户端会向通道（SQS Queue）询问是否有新消息，但是为了做到这一点，客户端必须发送私钥，这是一个安全漏洞，因为这样，每个人都可以向 sns 服务发送了新的通知...

我们有办法避免吗？

澄清一下：我不必发送 PrivateKey，但我需要确认请求，为了做到这一点，我需要私钥，因为这是通过 javascript 完成的，所以我不能简单地做：

```
var PrivateKeySoYouCanHackMe = "myPrivateKey"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:49:35.633

好吧，我了解到您的客户不想向您发送 aws 访问密钥和密钥？在这种情况下，我会向您的客户推荐：创建新的 iam 用户并仅授予对您的 sqs 的访问权限。比获取新用户的 aws 密钥和访问密钥给你。这有助于您的客户避免安全漏洞并控制您在 aws 上的帐户。

# asp.net-mvc-4 - 模型绑定验证错误

> ID：15534554
> 
> 赞同：0
> 
> 时间：2013-03-20T20:56:22.223
> 
> 标签：asp.net-mvc-4, model-binding

在我的自定义模型验证中，我有以下内容：

```
 public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext){
        var repository = DependencyResolver.Current.GetService(typeof(IContactRepository));
        IContactRepository repo = repository as IContactRepository;
        USRContact c = repo.GetContactByID(Convert.ToInt64(bindingContext.ValueProvider.GetValue("ContactID").AttemptedValue));
        c.FormalName = bindingContext.ValueProvider.GetValue("FormalName").AttemptedValue;

        if (!repo.IsValidFormalName(c.ContactID, c.FormalName))
        {
            var result = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);

            bindingContext.ModelState.AddModelError("FormalName", Resources.ErrorMsgs.FormalNameNotUnique);

            return bindingContext.Model;
        }

        c.PreferredName = bindingContext.ValueProvider.GetValue("PreferredName").AttemptedValue;
        c.Alias = bindingContext.ValueProvider.GetValue("Alias").AttemptedValue;
        c.Pseudonym = bindingContext.ValueProvider.GetValue("Pseudonym").AttemptedValue;
        c.GenderID = Convert.ToInt32(bindingContext.ValueProvider.GetValue("GenderID").AttemptedValue);
        c.NationalityID = Convert.ToInt32(bindingContext.ValueProvider.GetValue("NationalityID").AttemptedValue);
        c.ModifiedByID = Utilities.SessionUtil.Current.UserID;
        c.ModifiedDate = DateTime.Now; 
```

}

我的控制器通过执行以下操作调用此模型绑定器：

```
public ActionResult Update([ModelBinder(typeof(ModelBinder.ContactModelBinder))] USR.USRContact contact)
    {
        if (ModelState.IsValid)
        {
            repository.Update();
            return View("~/Views/Shared/Contacts/ShowContactInfo.cshtml", repository.GetContactByID(contact.ContactID));
        }
} 
```

}

我的视图模型包含数据注释，说明需要正式名称并且别名需要少于 60 个字符。如果模型绑定器将其转换为持久数据模型 (USRContact) 并且我的视图需要视图模型，我该如何显示错误？

有什么方法可以确保在视图模型上出现验证错误时，控制器不会转换为持久数据模型？即使我们确实检查了数据对象中的所有模型错误并找到了验证错误，我们如何将用户发送回他们刚刚所在的视图，错误出现在他们所在的文本框旁边。

谢谢您的帮助！萨弗里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T19:37:40.040

I think the issue you may be facing is that once you push those values into the other object through the custom binder they are no longer the same as they were on the page.

A property called "PropertyValue" with an Html.ValidationFor(x=>x.PropertyValue) is going to look in the ModelState error collection for items with PropertyValue.

Once you have pushed those into Contact now the value is Contact.PropertyValue. If you validated it then it will be added to the ModelState as "Contact.PropertyValue" This will only be picked up by Html.ValidationFor(x=>x.Contact.PropertyValue)

The easiest solution is to make sure that your input and output's follow the same structure. If you can render the items as Html.TextBoxFor(x=>x.Contact.SomeProperty) then things will be fine.

# jquery-ui-accordion - 使用 Web 数据库动态创建 Jquery UI Accordion 时不会折叠

> ID：15534562
> 
> 赞同：1
> 
> 时间：2013-03-20T20:56:54.557
> 
> 标签：jquery-ui-accordion

这个手风琴本身在页面上时工作正常，但是当我通过网络数据库动态填充单个标题/内容对时，标题和内容不会折叠。我实现它的方式有问题吗？

数据库的其余部分（在 2 个不同的字段中插入字典术语和定义）在没有手风琴功能的情况下完美运行。可以理解，我想集成手风琴，这样用户的滚动就更少了。

这是实现的代码，然后是直接从源代码（注释掉）进行比较的代码：

```
function showRecords() {
  var results = '';
  results.innerHTML = '';
  db.transaction(function(tx) {
     tx.executeSql(selectAllStatement, [], function(tx, result) {
        dataset = result.rows;
        for (var i = 0, item = null; i < dataset.length; i++) {
           item = dataset.item(i);
           results.innerHTML = '<div id="accordion">';
           results.innerhtml += '<h3>' + item['term'] + '</h3><div><p>' + item['definition'] + '<button class="glossaryButton2" onClick="loadRecord('+i+')">Edit</button> <button  class="glossaryButtonDel" style="float:right;" onClick="deleteRecord(' + item['id'] + ')">Delete</button></p><hr></div>';
           }
        });
});
results.innerHTML += '</div>';
// TRIED: $('#accordion').html(results).accordion({collapsible: true});
// TRIED: $("#accordion").accordion({collapsible: true});
// getter
var collapsible = $( "#accordion" ).accordion( "option", "collapsible" );
// setter
$( "#accordion" ).accordion( "option", "collapsible", true );
exportRecords();
} 
```

（$('#accordion').html(results).accordion({collapsible: true}); 的解释：“手风琴调用仅适用于 DOM 中匹配的元素，因为您要添加手风琴动态，没有什么可以匹配的。您需要在加载新内容后重新应用手风琴。“我认为这是我一无所知的地方。）

```
/* The HTML of original accordion:

<div id="accordion">

   <h3>Section 1</h3>
   <div>
      <p>Mauris mauris ante, blandit et, ultrices a, suscipit eget, quam. Integer ut neque. Vivamus nisi metus, molestie vel, gravida in, condimentum sit amet, nunc. Nam a nibh. Donec suscipit eros. Nam mi.</p>
   </div>

</div>
*/ 
```

上述问题并非 Jquery UI 独有。我在 4-5 部其他 Javascript 手风琴上也遇到了完全相同的问题——我一直在努力！我总是自己尝试手风琴；如果它有效，那么我将它与数据库+innerHTML 集成——并发现它退出崩溃。

（仅供参考：此代码与 Zurb Foundation 3 共享空间，并使用随附的 Jquery。当与数据库分开使用时，它可以与上述 HTML 手风琴版本一起正常工作，所以这不是问题。）

# android - 使用默认可绘制对象的最佳实践是什么？

> ID：15534565
> 
> 赞同：0
> 
> 时间：2013-03-20T20:57:14.900
> 
> 标签：android, drawable, convention

为默认可绘制对象（没有屏幕尺寸扩展的“可绘制对象”）设置一个专门的文件夹会更加直观和不言自明，从而更容易找到文件。但它会在运行时导致逻辑错误吗？这里的约定是什么？大多数开发人员是否将默认可绘制对象放在特定于屏幕尺寸的文件夹之一（如果是，是哪个？）还是大多数开发人员创建一个非特定的“可绘制”文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:43:00.227

实际上，您应该按照[此处](http://developer.android.com/guide/practices/screens_support.html)`drawable-nodpi`的说明将其放入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:00:11.313

它不会引起问题。Android 首先查看“drawable”文件夹，然后将任何其他文件夹视为覆盖。

# ios - 使用 NSXMLParser 解析复杂的 XML 结构

> ID：15534566
> 
> 赞同：0
> 
> 时间：2013-03-20T20:57:16.723
> 
> 标签：ios, xml, nsdictionary, nsxmlparser

我从我的服务器返回了这个相当复杂的 XML，我需要一些帮助来将其解析为我可以访问以供以后使用的对象。

这就是xml的样子

```
<Eng>
    <Result         >
        <Series         >
            <Link/>
            <FMF/>
                <AlsoLink/>
                <Plugins/>
            </FMF>
            <Sheet          >
                <Spaces>
                    <Spacing            >
                    <Names/>
                    </Spacing>
                    <Spacing            >
                    <Names/>
                    </Spacing>
                </Spaces>
            </Sheet>
        </Series>
    </Result>
</Eng> 
```

然后，我使用 NSXMLParser 尝试将 xml 中每个元素的所有“ObjectForKey/s”解析到他们自己的字典中。如果这有意义的话。

这就是我的代码目前的样子

```
#pragma mark - Parsing lifecycle

- (void)startTheParsingProcess:(NSData *)parserData
{
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:parserData]; //parserData passed to NSXMLParser delegate which starts the parsing process
    [parser setDelegate:self];
    [parser parse]; // starts the event-driven parsing operation.
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    if([elementName isEqualToString:@"Series"]){
        parsedMutableDictionary = [[NSMutableDictionary alloc] initWithDictionary:attributeDict];
        self.parsedDataArrayOfDictionaries = [NSMutableArray arrayWithCapacity:8];

        if ([elementName isEqualToString:@"Link"]) {

        }
        if ([elementName isEqualToString:@"FMF"]) {
            if ([elementName isEqualToString:@"AlsoLink"]) {

            }
            else if ([elementName isEqualToString:@"Plugins"]) {

            }
        }
        else if ([elementName isEqualToString:@"Sheet"]) {

            if ([elementName isEqualToString:@"Spaces"]) {

                if ([elementName isEqualToString:@"Spacing"]) {

                    if ([elementName isEqualToString:@"Names"]) {

                    }
                }
            }

        }
    }

}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{    
    if([elementName isEqualToString:@"Series"]){
         [parsedDataArrayOfDictionaries addObject:parsedMutableDictionary];

        if ([elementName isEqualToString:@"Link"]) {

        }
        if ([elementName isEqualToString:@"FMF"]) {
            if ([elementName isEqualToString:@"AlsoLink"]) {

            }
            else if ([elementName isEqualToString:@"Plugins"]) {

            }
        }
        else if ([elementName isEqualToString:@"Sheet"]) {

            if ([elementName isEqualToString:@"Spaces"]) {

                if ([elementName isEqualToString:@"Spacing"]) {

                    if ([elementName isEqualToString:@"Names"]) {

                    }
                }
            }

        }
    }

//     parsedMutableDictionary = nil;
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
{
    NSLog(@"Paser Error = %@", parseError);
    UIAlertView *errorAlert = [[UIAlertView alloc] initWithTitle:@"Error!" message:@"A parsing failure occurred." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
    [errorAlert show];
}

//TODO: Look into how to use this method over multiple views. i.e.(other requests such as keycode, advanced )
- (void)parserDidEndDocument:(NSXMLParser *)parser
{
    // display values
        NSArray *filteredArray = parsedDataArrayOfDictionaries;
        NSLog(@"%@", filteredArray);

} 
```

我遇到的问题是我不明白我应该在他们自己的对象中拥有什么......而且当其中一些值返回时，我可能有多个 Spacing 元素，我只是不知道如何处理......

任何帮助或提示将不胜感激，如果我没有指定一些东西只是问我的大脑正在努力解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:39:53.127

假设您的 XML 文件....

```
<Series element1="something" element2="something">
    <Spaces>
         <Spacing>
              <Names>
                 Something
              </Names>
         </Spacing>
         <Spacing>
              <Names>Something</Names>
         </Spacing>
    </Spaces>
</Series> 
```

要获得 element1 的值，您必须这样做......

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{   
    if([currentElement isEqualToString:@"Series"]) {
        NSLog(@"%@",[attributeDict objectForKey:@"element1"]);
    }
} 
```

要获得 Spacing 的多个值，您必须这样做......

```
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if([currentElement isEqualToString:@"name"]) {
       [currentSpacingName appendString:string];
       [currentSpacingName appendString:@"any character"]
    }
} 
```

之后，在此方法中将值存储到带有期望键的字典中......

```
 - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName 
```

这只是一个例子，我希望你现在可以解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:06:36.737

您正在使用 NSXMLParser .... 所以您将获得标签之间的字符串...`<tag>strings</tag>`

要获得多个 Spacing 元素，您可以将所有字符串附加到 NSString 对象中。

# objective-c - NSManagedObject 作为存储，持续分析原始数据

> ID：15534571
> 
> 赞同：0
> 
> 时间：2013-03-20T20:57:29.190
> 
> 标签：objective-c, cocoa, core-data, nsmanagedobject

这类似于我之前问过的一个问题，但是现在我已经走得更远了，我仍然有一个关于 NSManagedObject 的“正确”子类化的问题，因为昨晚有人告诉我，放很多非-持久的属性和 ivars 在一个里面。目前我的 NSManagedObject 中有大量代码，而 Apple 的文档并没有真正解决它的“正确性”。仅供参考：代码有效，但我问的是前面是否存在陷阱，或者是否有明显的改进以另一种方式进行。

我的“对象”是不断增长的传入数据数组、跟踪该数据分析进度的属性/变量以及处理后的数据（输出）。所有这些都存储在内存中，因为它会非常快速地增长，并且无法连续重新生成/重新分析。实际持久化的 NSManagedObject 属性只是原始数据（定期保存，因为 Core Data 不支持 NSMutableData）、一些基本属性和 2 个与其他 NSManagedObjects 的关系（1 个是用户，另一个是一组快照数据）。任何时候都只记录一个对象，尽管可以打开几十个对象进行查看（这可能随时涉及进一步处理）。

插入实体的对象（管理核心数据的数据管理器）不可能在其中包含所有处理逻辑/变量，因为每个对象都需要至少少数用作中介和跟踪值的数组/属性用于分析。而且我个人认为，为每个正在使用的对象创建两个对象（NSManagedObject 是存储，另一个对象是处理/临时存储）听起来很愚蠢。

基本上，我能找到的所有使用 NSManagedObjects 的示例都有超级简单的对象，例如坐标、地址簿条目、图片：基本上是静态的东西。在那种情况下，我可以看到在对象之外创建/修改它们的所有逻辑。但是，我的情况并不是那么简单，我还没有想出一个不涉及重复的替代方案。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:20:43.563

您可能会使用“包装器”，也就是说一个引用了您的托管对象实例之一的类，该包装器将包含您的算法和非持久化算法。

# powershell - 导出 csv 只吐出长度

> ID：15534572
> 
> 赞同：2
> 
> 时间：2013-03-20T20:57:29.800
> 
> 标签：powershell

我只能在将其导出到 csv 时获得长度，应该如何正确完成。

```
$redo = Import-CSV c:\temp\testimport.txt | Group-Object email |
foreach {  "{0} ,{1}" -f $_.Name, (($_.Group | foreach { $_.group }) -join ', ')

}

$redo | Export-CSV c:\temp\test.csv -NoTypeInformation 
```

#

> “长度”“46”“59”“110”“47”“149”“38”“69”“32”“62”“29”“49”“31”“27”“48”“55”“42” "

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:48:22.420

`Export-Csv`需要一个具有属性的对象（或对象列表），而您的命令管道会生成一个字符串数组。如果将此数组提供给`Export-Csv`cmdlet，则获取每个给定项目的属性（仅`Length`用于字符串）并将这些属性写入输出文件。

您需要构建具有所需属性的对象列表，例如：

```
Import-CSV c:\temp\testimport.txt `
  | Group-Object email `
  | select @{n="Name";e={$_.Name}},@{n="Group";e={($_.Group | %{$_.group}) -join ', '}} `
  | Export-CSV c:\temp\test.csv -NoTypeInformation 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T12:29:10.467

这正是我想要的。所以我要补充一下我的评论，以确保每个人都能理解。

这**不起作用**：

```
$str_list = @('Mark','Henry','John')
$str_list | Export-Csv .\ExportStrList.csv -NoType 
```

因为`Export-Csv`需要对象和输出属性。String[ ] 的唯一属性是`Length`，因此 CSV 文件仅包含长度。

为了解决这个问题，就像上一个人说的那样，我们需要将 String[ ] 更改为 Object[ ]。最简单的方法是使用`Select-Object`.

将每个字符串放入新 Object[] 的 Name 属性中，如下所示：

```
$str_list = @('Mark','Henry','John')
$str_list = $str_list | Select-Object @{Name='Name';Expression={$_}}
$str_list | Export-Csv .\ExportStrList.csv -NoType 
```

只是为了重新迭代，`Select-Object`输出一个可以轻松操作的自定义 PSObject。这是非常强大的信息，请明智地使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-28T17:21:45.583

显示的将数据转换为对象的方法是一种非常冗长的方法，至少在我的情况下是这样。我正在开发与 IBM V7000 SAN 存储子系统集成的报告，它是 CLI，我可以使用 putty plink 从 PS 调用它，根据查询返回表格输出（可以是 CSV）或列表。我希望将数据导出为 CSV。从列表输出中，我循环遍历结果集（一行 = 一个字段）并将字段组合成一个字符串，用逗号分隔值。（对于表格输出，我可以跳过这个繁琐的步骤。）

以下工作将输出写入 CSV 文件，然后我可以将其作为电子表格打开。

```
$fhStream = [System.IO.StreamWriter] "20150527_QALUNTable.csv" 
$fhStream.WriteLine($stColumnHeadings)
$fhStream.WriteLine($stColumnValues)
$fhStream.Close() 
```

Import-Csv 将输入作为一个对象返回，我可以轻松地使用该对象来准备我的报告（这些文件由许多这样的输出文件组装而成，每个文件都在一个单独的时间点收集——因此是 datestamp 前缀）。

这里有 57 列数据，因此通过转换为 CSV，我可以避免准备 57 个对象语句。

[（在http://blogs.technet.com/b/gbordier/archive/2009/05/05/powershell-and-writing-files-how-fast-can-you-](http://blogs.technet.com/b/gbordier/archive/2009/05/05/powershell-and-writing-files-how-fast-can-you-write-to-a-file.aspx)找到 .Net 编写输出的技术（最快）[写入文件.aspx](http://blogs.technet.com/b/gbordier/archive/2009/05/05/powershell-and-writing-files-how-fast-can-you-write-to-a-file.aspx) )

# php - Magento PHP 致命错误：调用非对象上的成员函数 setName()

> ID：15534573
> 
> 赞同：0
> 
> 时间：2013-03-20T20:57:33.210
> 
> 标签：php, magento, checkout

我在 magento 结账时遇到问题。通过集成 Billsafe Payment 插件，我在结帐过程中收到以下错误：

```
HTTP-Error 500 (Internal Server Error): 
```

错误日志说：

> mod_fcgid：stderr：PHP 致命错误：在 /var/www/vhosts/domain.com/httpdocs/app/code/community/AwHh/PaymentFee/Helper/Data.php 中的非对象上调用成员函数 setName()

有任何想法吗？

Data.php 的代码：

```
/**
 * Check if the extension is active
 * 
 * @return boolean
 */
public function isEnabled()
{
    return (bool)Mage::getStoreConfig('payment_services/paymentfee/active');
}

/**
 * Check if minimum fee amount, maximum fee amount or percentage rate is given
 * @return boolean
 */
public function hasFeeValues()
{
    $min = (bool)max(0, Mage::getStoreConfig('payment_services/paymentfee/min_fee_amount'));
    $max = (bool)Mage::getStoreConfig('payment_services/paymentfee/max_fee_amount');
    $rate = (bool)Mage::getStoreConfig('payment_services/paymentfee/relative_fee');
    return ($min || $max || $rate);
}

public function getFeeProductSku()
{
    return Mage::getStoreConfig('payment_services/paymentfee/sku');
}

/**
 * if item represents fee product
 *
 * @param Mage_Catalog_Model_Product|Mage_Sales_Model_Item $product
 * @return boolean
 */
public function isFeeProduct($product)
{
    return ($product->getSku() == $this->getFeeProductSku());
}

public function setFeeProduct($feeProduct)
{
    $this->feeProduct = $feeProduct;
}

public function getFeeProduct()
{
    if (is_null($this->feeProduct)) {
        $this->feeProduct = Mage::getModel('catalog/product')->loadByAttribute('sku', $this->getFeeProductSku());
    }

    return $this->feeProduct;
}

public function hasFeeProduct()
{
    $feeProduct = $this->getFeeProduct();
    return ($feeProduct && 0 < $feeProduct->getId());
}

/**
 * Obtain the fee that is set for the current payment method
 * @return float
 */
public function getPaymentFee()
{
    if (!$this->isEnabled()) {
        return 0;
    }

    if (!Mage::getModel('checkout/cart')->getQuote()->getPayment()->hasMethodInstance()) {
        return 0;
    }

    // get the currently set payment method
    $payment_model = Mage::getModel('checkout/cart')->getQuote()->getPayment()->getMethodInstance();

    // check which methods are enabled for payment fee via backend
    $enabled_methods = explode(',', Mage::getStoreConfig('payment_services/paymentfee/payment_methods'));

    if (!$payment_model || !in_array($payment_model->getCode(), $enabled_methods)) {
        return 0;
    }

    // return fee if
    // (1) a payment method has been selected by the customer
    // (2) the selected payment method is enabled for payment fee via backend
    // (3) the payment method has a fee
    return (float)$payment_model->getFee();
}

/**
 * get quote item representing fee
 * 
 * @return Mage_Sales_Model_Quote_Item
 */
protected function getFeeQuoteItem()
{
    foreach (Mage::getSingleton('checkout/session')->getQuote()->getItemsCollection() as $item) {
        if ($this->isFeeProduct($item->getProduct())) {
            return $item;
        }
    }
}

/**
 * Computed amount of payment fee based on backend configuration
 * and grand total and attach it to fee product.
 */
public function getUpdatedFeeProduct($product=null, $grandTotal=null)
{
    if (!$product) {
        $product = $this->getFeeProduct();
    }
    $product->setName($product->getResource()->getAttributeRawValue($product->getId(), 'name', Mage::app()->getStore()->getId()));
    if (!$grandTotal) {
        $quote      = Mage::getSingleton('checkout/session')->getQuote();
        $grandTotal = $quote->getGrandTotal();
        $feeAmount  = 0;
        foreach ($quote->getItemsCollection() as $quoteItem) {
            if ($this->isFeeProduct($quoteItem->getProduct())) {
                $feeAmount = $quoteItem->getBaseRowTotalInclTax();
                continue;
            }
        }
        $grandTotal -= $feeAmount;
    }
    $min = max(0, Mage::getStoreConfig('payment_services/paymentfee/min_fee_amount'));
    $max = Mage::getStoreConfig('payment_services/paymentfee/max_fee_amount');

    $rate = Mage::getStoreConfig('payment_services/paymentfee/relative_fee');
    //$product->setName($this->__('Payment fee'));
    if ($this->getFeeQuoteItem()) {
        $product->setTaxPercent($this->getFeeQuoteItem()->getTaxPercent());
    }

    // first, set payment fee to the price configured in backend
    $price = $max;

    // If set to zero, do not limit the final fee
    if (!$max) {
        $max = INF;
    }

    $product->setCheckoutDescription($this->formatPrice($price))
        ->setExceedsMaxAmount(false)
        ->setExceedsMinAmount(false);

    // calculate relative fee if given in backend
    if ($rate) {
        $price = $grandTotal * $rate / 100;

        if ($max < $price) {
            // calculated relative fee exceeds maximum charge 
            // -> use maximum charge
            $product->setCheckoutDescription($this->formatPrice($max));
            $product->setExceedsMaxAmount(true);
            $price = $max;
        } elseif ($price < $min) {
            // calculated relative fee is below minimum charge 
            // -> use minimum charge
            $product->setCheckoutDescription($this->formatPrice($min));
            $product->setExceedsMinAmount(true);
            $price = $min;
        } else {
            // calculated relative fee is between minimum and maximum charge
            // -> use calculated relative fee
            $msg = '%s (%s%% of Total %s)';
            $product->setCheckoutDescription($this->__(
                $msg,
                $this->formatPrice($price),
                $rate,
                $this->formatPrice($grandTotal)
            ));
            $msg = '%s %s (%s%% of Total %s)';
            $product->setName($this->__(
                $msg,
                $product->getName(),
                strip_tags($this->formatPrice($price)),
                $rate,
                strip_tags($this->formatPrice($grandTotal))
            ));
        }
    }
    $product->setPriceInclTax($price)
        ->setPrice($price)
        ->setFinalPrice($price);

    // Make sure fee product is "in stock"
    $stockItem = Mage::getModel('cataloginventory/stock_item');
    $stockItem->assignProduct($product);
    $stockItem->setIsInStock(1);
    $stockItem->setManageStock(1);
    $stockItem->setQty(10000);
    $stockItem->save();

    return $product;
}

public function removeFeeFromQuote(Mage_Sales_Model_Quote $quote)
{
    foreach ($quote->getItemsCollection() as $quoteItem) {
        if ($this->isFeeProduct($quoteItem->getProduct())) {
            $quote->removeItem($quoteItem->getId());
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T14:38:24.470

我有同样的问题。解决方案：你可能没有添加虚拟文章。

转到您的 Adminarea，选择目录 -> 管理文章添加新文章并选择虚拟文章为其命名，并确保其活动且不可见，将 SKU 设置为某些内容并复制它。你以后需要它！将价格设置为零并且库存至少为 1 您可以选择是否给它更高的库存或只给它一个并转向库存管理。保存后转到 system->configuration->paymenttypes，您必须将刚刚复制的 SKU 粘贴到其中包含 SKU 的字段中。

毕竟你必须清除你的缓存然后你去:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T05:25:06.887

一个帮助类扩展了 extends `Mage_Core_Helper_Abstract`..

类`Mage_Catalog_Helper_Data` 不扩展 varien_object 所以`getName()`函数会产生这个错误。

而不是从帮助类对象调用 getname。

使用 `$model = getmodel('whatever')`然后 `$model->getName()`从那里调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-11T18:59:19.597

或者，您可以在 Configuration (System->Configuration->payment) 下**禁用 Billsafe (设置 Active: no )**

# asp.net - TFS 构建过程以不同于发布配置文件中指定的名称发布网站

> ID：15534576
> 
> 赞同：0
> 
> 时间：2013-03-20T20:57:55.373
> 
> 标签：asp.net, web, build, tfs, publish

我正在使用 TFS Build 使用我定义的发布配置文件发布网站。发布发生了，但它发布到以 Web 应用程序项目名称命名的 Web 应用程序，而不是我在发布配置文件中指定的名称。如果我使用相同的发布配置文件发布到我的本地计算机，它会使用我在发布配置文件中指定的名称进行发布。尽管在 TFS 构建案例中它是本地非域帐户，但我在这两种情况下都使用了管理帐户。

使用的参数如下（出于安全原因删除了相关细节）：

```
/p:DeployOnBuild=True /p:DeployTarget=MsDeployPublish /p:PublishProfile=MyProfile 
/p:AllowUntrustedCertificate=True /p:MSDeployPublishMethod=WMSVC 
/p:MSDeployServiceUrl=https://SomeName:8172/MsDeploy.axd 
/p:UserName=SomeName\LocalAdminDude /p:Password=SomePassword 
```

发布配置文件本身如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<!--
This file is used by the publish/package process of your Web project. You can customize     the behavior of this process
by editing this MSBuild file. In order to learn more about this please visit     http://go.microsoft.com/fwlink/?LinkID=208121\. 
-->
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<PropertyGroup>
   <WebPublishMethod>MSDeploy</WebPublishMethod>
   <SiteUrlToLaunchAfterPublish/>http://Server/NameIWant</SiteUrlToLaunchAfterPublish>
   <MSDeployServiceURL>https://Server:8172/msdeploy.axd</MSDeployServiceURL>
   <DeployIisAppPath>Default Web Site/NameIWant</DeployIisAppPath>
   <RemoteSitePhysicalPath />
   <SkipExtraFilesOnServer>True</SkipExtraFilesOnServer>
   <MSDeployPublishMethod>WMSVC</MSDeployPublishMethod>
   <UserName>Server\LocalAdminDude</UserName>
   <_SavePWD>True</_SavePWD>
 </PropertyGroup>
</Project> 
```

本质上，如果我的 Web 项目名为**NameIWantPROJECT**，我希望它发布到一个名为**NameIWant**的网站。如果我在本地发布，那行得通，如果我使用上述参数通过 TFS，它会发布为**NameIWantPROJECT**而不是我指定的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T14:09:38.213

尝试使用 /p:DeployIisAppPath 代替 /p:PublishProfile。也就是说，添加以下参数。

/p:DeployIisAppPath="默认网站/NameYouWant"

TFS 2010 对我有用。

# exception - haskell 如果异常

> ID：15534577
> 
> 赞同：0
> 
> 时间：2013-03-20T20:58:00.077
> 
> 标签：exception, haskell

我有这样的东西

```
isLastPermutation (h:t)=
            catch (nextPermutation (h:t)) (\e-> return True)
            return False 
```

在某些情况下`nextPermutation`会抛出异常，如果抛出异常，我希望我的函数`isLastPermutation`返回 true，`nextPermutation`否则返回 false。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:13:19.643

不要在纯 Haskell 中使用异常进行流控制。使用`Maybe`或`Either`。

# java - 基本的泛型方法以及如何从非泛型类调用方法？

> ID：15534587
> 
> 赞同：0
> 
> 时间：2013-03-20T20:58:32.043
> 
> 标签：java, generics

我一般需要泛型方法和泛型方面的帮助。

这是我坚持的规范：

在上面的 MyPets 类中，添加一个以 T 作为参数的方法。此方法称为 myGenericMethod，将调用 makeNoise。在此方法中为您的两只宠物调用 makeNoise 方法。

问题是如何从 Animal Class（非泛型类）调用 makeNoise 方法。我必须使用反射吗？

```
 public class MyPets<T>{

//creating the myGenericMethod with T as its parameter.

    public void myGenericMethod(T t){

// How do I call the makeNoise() from Animal class here? 

    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:12:24.843

你只需要你的泛型类型声明来反映它扩展了 Animal：

```
public class MyPets<T extends Animal> {
  public void myGenericMethod(T t) {
    t.makeNoise();
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:11:47.437

要么从中删除类型参数`MyPets`并`myGenericMethod`只使用`Animal`，要么声明`T`为必须是或某个子类型的*有界通配符：*`Animal`

```
class MyPets<T extends Animal> {
  public void myGenericMethod(T t) {
    // you can call Animal methods on t here
  }
} 
```

*您可以*做的另一件事就是强制`t`转换为`Animal`，即`Animal animalT = (Animal) t;`。但如果你这样做，那么一开始就宣布`myGenericMethod`采取 a是没有意义的`T`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:06:13.297

您可以将您的对象声明为：

```
 MyPets<Animal> obj; 
```

你称之为：

```
obj.myGenericMethod(Animal aimal); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:21:21.667

如果我正确理解您的问题，您需要`MyPets`像这样修改您的课程：

```
public class MyPets<T extends Animal> {
   public void myGenericMethod(T t) {
       t.makeNoise()
    }
} 
```

现在您有了一个限制为 的实例的泛型`MyPets`类，并且您知道 的所有实例都有一个方法，您可以安全地调用。`T``Animal``Animal``makeNoise``T#makeNoise()``myGenericMethod`

这使您可以按如下方式解决您的问题：

```
MyPets<Dog> myDog;
MyPets<Cat> myCat;

myDog = new MyPets<Dog>();
myDog.myGenericMethod(new Dog());

myCat = new MyPets<Cat>();
myCat.myGenericMethod(new Cat()); 
```

请注意，以下内容在技术上也是正确的，尽管它首先违背了使用泛型的目的：

```
MyPets<Animal> myPet;

myPet = new MyPets<Animal>();
myPet.myGenericMethod(new Dog());
myPet.myGenericMethod(new Cat()); 
```

# ios - phonegap 应用程序中的随机白色闪烁

> ID：15534592
> 
> 赞同：4
> 
> 时间：2013-03-20T20:58:59.183
> 
> 标签：ios, cordova, jquery-mobile

我有一个使用 Phonegap 和 Jquery Mobile 制作的应用程序，它在多个多页 Jquery Mobile 文档之间进行传输。它可以很好地满足我的需要，但发生的一件奇怪的事情是，当我在不同的 html 文件之间进入时，偶尔会出现白色闪光。现在我已经看到这是使用 JQM 和 Phonegap 时的常见问题，但是从我看过的所有其他帖子中，除了摆脱页面转换之外，还有其他解决方案吗？这个问题在 Phonegap 2.5 中解决了吗？

我正在使用 Jquery Mobile 1.3、Jquery 1.9 和 Phonegap 2.4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T23:22:27.783

[这里](http://jquerymobile.com/demos/1.2.0/docs/pages/page-transitions.html)有一些很好的文档

我最近遇到了类似的问题，您可以将页面转换设置为“无”：

`<a href="" data-transition="none">XX</a>`

这为我减轻了所有闪烁的问题。

您也可以尝试添加以下内容：

`.ui-page { -webkit-backface-visibility: hidden; }`

然而，对于您的 CSS，这并不是一个完美的修复，并且对我造成了严重的不稳定。

# java - 在java中设置静态对象

> ID：15534593
> 
> 赞同：0
> 
> 时间：2013-03-20T20:59:03.813
> 
> 标签：java, string, static

我有一堂课`GlobalData`

```
public class GlobalData {
    public static  String SERVER_ROOT;
    public static  String LOGIN_JSP = GlobalData.SERVER_ROOT + "login.jsp";
    public static  String HOME_JSP = GlobalData.SERVER_ROOT + "s/home.jsp";
    public static  String Logout = GlobalData.SERVER_ROOT + "Logout";
    public static ServletContext SERVLET_CONTEXT;
 } 
```

我从 contextListener 设置这些字符串

```
 GlobalData.SERVLET_CONTEXT = contextEvent.getServletContext();
        GlobalData.SERVER_ROOT = GlobalData.SERVLET_CONTEXT.getContextPath()+"/";

        System.out.println("setting server root : " + GlobalData.SERVER_ROOT);
        System.out.println("setting Home jsp : " + GlobalData.HOME_JSP);
        System.out.println("setting Login : " + GlobalData.LOGIN_JSP);
        System.out.println("setting Logout : " + GlobalData.Logout) 
```

**输出是：**

```
setting server root : /JCMM/
setting Home jsp : nulls/home.jsp
setting Login : nulllogin.jsp
setting Logout : nullLogout 
```

我无法理解这种行为。谁能找到，问题出在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T21:01:41.713

初始化类时`GlobalData`，会设置所有静态变量。没有值`SERVER_ROOT`，所以它被初始化为`null`。然后初始化接下来的 3 个变量。用于`+`连接字符串时，a`null`会产生*字符串*“null”，因此 3 个值`LOGIN_JSP`、`HOME_JSP`和中的每一个都`Logout`以“null”开头。

稍后，您设置了 SERVER_ROOT，但您不更新其他 3 个，因此它们保留为前面带有“null”的字符串。

# bash - Bash脚本，while循环中的多个条件

> ID：15534595
> 
> 赞同：65
> 
> 时间：2013-03-20T20:59:11.107
> 
> 标签：bash, shell, loops, while-loop

我试图让一个简单的 while 循环在使用两个条件的 bash 中工作，但是在尝试了各种论坛的许多不同语法之后，我无法停止抛出错误。这是我所拥有的：

```
while [ $stats -gt 300 ] -o [ $stats -eq 0 ] 
```

我也试过：

```
while [[ $stats -gt 300 ] || [ $stats -eq 0 ]] 
```

...以及其他几个构造。我希望这个循环继续 while`$stats is > 300`或 if `$stats = 0`。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2013-03-20T22:10:20.377

正确的选项是（按推荐的递增顺序）：

```
# Single POSIX test command with -o operator (not recommended anymore).
# Quotes strongly recommended to guard against empty or undefined variables.
while [ "$stats" -gt 300 -o "$stats" -eq 0 ]

# Two POSIX test commands joined in a list with ||.
# Quotes strongly recommended to guard against empty or undefined variables.
while [ "$stats" -gt 300 ] || [ "$stats" -eq 0 ]

# Two bash conditional expressions joined in a list with ||.
while [[ $stats -gt 300 ]] || [[ $stats -eq 0 ]]

# A single bash conditional expression with the || operator.
while [[ $stats -gt 300 || $stats -eq 0 ]]

# Two bash arithmetic expressions joined in a list with ||.
# $ optional, as a string can only be interpreted as a variable
while (( stats > 300 )) || (( stats == 0 ))

# And finally, a single bash arithmetic expression with the || operator.
# $ optional, as a string can only be interpreted as a variable
while (( stats > 300 || stats == 0 )) 
```

一些注意事项：

1.  引用内部的参数扩展`[[ ... ]]`并且`((...))`是可选的；如果未设置变量，`-gt`则`-eq`假定值为 0。

2.  using`$`在 inside 是可选的`(( ... ))`，但使用它可以帮助避免意外错误。如果`stats`未设置，则`(( stats > 300 ))`假定`stats == 0`为 ，但`(( $stats > 300 ))`会产生语法错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:04:27.307

尝试：

```
while [ $stats -gt 300 -o $stats -eq 0 ] 
```

`[`是对`test`. 它不仅仅是用于分组，就像其他语言中的括号一样。检查`man [`或`man test`了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:14:07.623

第二种语法外部的额外 [ ] 是不必要的，并且可能令人困惑。您可以使用它们，但如果必须，它们之间需要有空格。

或者：

```
while [ $stats -gt 300 ] || [ $stats -eq 0 ] 
```

# java - 如何在Java中动态创建一个类并实例化它？

> ID：15534596
> 
> 赞同：0
> 
> 时间：2013-03-20T20:59:12.017
> 
> 标签：java, class

我对 Java 还很陌生，而且我是从 C++ 背景开始接触它的。我正在使用一个在调用受保护的构造函数之前必须扩展的类。我只需要一个实例中的类。有没有办法可以动态创建类并同时实例化它？

我发现了类似的帖子，但没有达到目标。我有以下代码作为示例，但当然它在语法上是不正确的。

```
final ffd.tokens.CountryTokens cToken = new class USA extends ffd.tokens.CountryTokens
{
    USA (String value)
    {
        super(value);
    }
} ("USA"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:07:41.137

像这样的东西？

```
final ffd.tokens.CountryTokens cToken = new ffd.tokens.CountryTokens("someValue")
{
// override something
}; 
```

更正：

即使使用受保护的方法，您也可以创建一个可以扩展的 Builder `ffd.tokens.CountryTokens`（很疯狂吧？）

```
public abstract class CountryBuilder extends ffd.tokens.CountryTokens {
   public CountryBuilder () { super("useless-data"); }    
   public abstract ffd.tokens.CountryTokens build (String val); 
} 
```

使用：

```
CountryBuilder builder = new CountryBuilder (){
   @Override
   public ffd.tokens.CountryTokens build(String val) {
      return new ffd.tokens.CountryTokens(val) {};
   }
};

builder.build("USA");
builder.build("Canada"); 
```

我想你应该已经明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:37:49.220

我想我明白了。我一直在考虑使用 Java 进行动态分配，但如果我只是创建一个本地实例，我就是这样做的。

```
class USA extends ffd.tokens.CountryTokens
{

    public USA() { super("USA"); }

} USA country; 
```

现在我有我的局部变量`country`type `USA`。

# ibm-mobilefirst - 在 WL.Server.readSingleJMSMessage 中使用主题会导致类转换异常

> ID：15534597
> 
> 赞同：0
> 
> 时间：2013-03-20T20:59:13.613
> 
> 标签：ibm-mobilefirst

JMS 有两种风格：p2p 消息传递（队列）或发布/订阅（主题）。令我惊讶的是，它在 JMS 适配器中不是对称的。队列可以通过两种方式正常工作，读取和写入。对于仅写入（发布）的主题，当消息发布到 WL 适配器侦听的主题时，从主题（订阅，非持久方式）读取失败。记录的错误是：

```
com.ibm.ws.sib.api.jms.impl.JmsTopicImpl cannot be cast to javax.jms.Queue
FWLSE0101E: Caused by: null 
```

文档显示使用主题没有任何限制，因此对我来说，JMS 中的“目的地”概念处理不当。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:46:02.460

Worklight 中的 JMS 适配器不支持从主题中读取。需要更新文档以包含此内容或使其更清晰。

# sql - MS 访问错误：函数参数无效

> ID：15534598
> 
> 赞同：0
> 
> 时间：2013-03-20T20:59:16.383
> 
> 标签：sql, ms-access

我正在使用以下查询：

```
SELECT Products.SKU,
    Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Customer,
    First(Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Requested_But_Not_Sent) AS     FirstOfRequested_But_Not_Sent
FROM Products
LEFT JOIN Buy_Orders_Details_Requested_But_Not_Sent_By_Customer
    ON Products.SKU = Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.SKU
GROUP BY Products.SKU,
    Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Customer; 
```

我得到“无效的函数参数”。

当我运行时：

```
SELECT Products.SKU,
    Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Customer,
    First(Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Quantity_Ordered) AS     FirstOfQuantity_Ordered
FROM Products
LEFT JOIN Buy_Orders_Details_Requested_But_Not_Sent_By_Customer
    ON Products.SKU = Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.SKU
GROUP BY Products.SKU,
    Buy_Orders_Details_Requested_But_Not_Sent_By_Customer.Customer; 
```

它没有问题。两个查询之间的唯一区别是正在聚合的字段——Quantity_Ordered 或 Requested_But_Not_Sent。基础记录集“Buy_Orders_Details_Requested_But_Not_Sent_By_Customer”本身就是一个查询，而不是一个表。单独打开该查询可以正常工作，没有问题。“Requested_But_Not_Sent”不包含任何 NULL。当我将查询 Buy_Orders_Details_Requested_But_Not_Sent_By_Customer 的内容转储到临时表并加入该表而不是查询时，它工作正常。

在查询 Buy_Orders_Details_Requested_But_Not_Sent_By_Customer 中，我发现有些字段有效，有些则无效（如前所述）。为什么会出现这种情况？为什么底层记录集是表还是查询是相关的？最重要的是，如何在不使用临时表的情况下获得我想要的结果？如果需要更多信息，请指定，我会提供。

谢谢！

# git - git svn 克隆挂起。fetch 重新启动但挂在同一个地方

> ID：15534600
> 
> 赞同：4
> 
> 时间：2013-03-20T20:59:18.107
> 
> 标签：git, svn, clone, freeze

我正在尝试*git svn clone*一个 svn repo。它到达某个点，例如在文件 x.xxx 处，然后挂起。没有网络活动。我 ctrl-C 和*git svn fetch*。它重新开始下载，但从某个点开始，x.xxx 之前有数百个文件。十分钟后，当它再次到达 x.xxx 时，它再次冻结。我已经经历了这个循环大约十几次。实际上，在类中有一小部分带有 x.xxx 的文件，比如 y.yyy 和 z.zzz。重新启动后，它*总是*停在这些文件*之一*。有时它会通过较早的一个，但最终会挂在其中一个上。

有没有办法强制它从更接近它挂起的点重新启动？有没有办法尝试按名称单独获取文件？是否有一些设置我可以尝试更改只是为了稍微改变一下？

编辑：这曾经发生在我身上[......](https://stackoverflow.com/questions/9484649/resuming-git-svn-clone-git-svn-fetch-starts-from-scratch)我完全忘记了。尽管如此，问题仍然存在。

# c++ - 嵌套的 include 语句便于编程 c/c++

> ID：15534603
> 
> 赞同：1
> 
> 时间：2013-03-20T20:59:23.330
> 
> 标签：c++, c, header, include

抛开良好的做法不谈，我正试图让自己的编码变得更容易一些。

是否可以制作一个头文件来处理无数的包含，以便源可以只包含一个头文件？

编辑：你们中的一些人正在引用 Cocoa。我忘了提到 C/C++ 编程。它在标签中，但我忘了把它放在这里。

编辑：没关系。似乎我这个问题踩到了蚁丘。学过的知识。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T21:01:27.933

当然这是可能的，但我不认为这是一种好的编程风格。

您将增加源代码依赖性，如果不重新编译所有内容，您将无法重新编译项目的一部分，并且您将忘记什么依赖于什么。

就个人而言，我会说不要这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:04:00.603

这不值得。

大量编译器时间、CPU 周期和树用于处理`#include`指令。如果您不需要它，请不要费心加载它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:09:51.317

听起来您想要一个[预编译的标头](http://en.wikipedia.org/wiki/Precompiled_header)。虽然它确实有一个缺点，即您忘记了哪个源文件依赖于其他外部代码，但预编译的头文件本身可以显着提高编译速度。

减轻我上面提到的缺点的一个好做法是避免在该预编译头文件中包含您自己的头文件。这样至少你可以确保你自己的类之间没有奇怪的依赖关系。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T21:04:54.690

我会说这取决于你想要达到的目标。如果你为 mac os x 开发一个 cocoa 应用程序，默认模板会让你通过一个头文件包含他们所有的 cocoa 库：

```
<Cocoa/Cocoa.h> 
```

包括：

```
#import <Foundation/Foundation.h>
#import <AppKit/AppKit.h>
#import <CoreData/CoreData.h> 
```

其中包括：

```
#include <CoreFoundation/CoreFoundation.h>

#import <Foundation/NSObjCRuntime.h>

#import <Foundation/NSArray.h>
#import <Foundation/NSAutoreleasePool.h>
#import <Foundation/NSBundle.h>
#import <Foundation/NSByteOrder.h>
#import <Foundation/NSCalendar.h>
#import <Foundation/NSCharacterSet.h>
#import <Foundation/NSError.h>
#import <Foundation/NSException.h>
#import <Foundation/NSFileHandle.h>
#import <Foundation/NSFileManager.h>
#import <Foundation/NSFormatter.h>
#import <Foundation/NSHashTable.h>
#import <Foundation/NSHTTPCookie.h>
#import <Foundation/NSHTTPCookieStorage.h>
#import <Foundation/NSNotification.h>
#import <Foundation/NSNotificationQueue.h>
#import <Foundation/NSNull.h>
#import <Foundation/NSNumberFormatter.h>
#import <Foundation/NSObject.h>

etc... 
```

您最终会包含 200 多个标题，嵌套在（至少）4 个级别上。它们通过`.pch`文件（预编译头文件）包含所有内容。编译速度非常快。

# powershell - 检查 PSObject 中的空数组

> ID：15534605
> 
> 赞同：0
> 
> 时间：2013-03-20T20:59:37.440
> 
> 标签：powershell

我将如何检查具有多个数组的对象中的 Null 或空？

```
$buildings.North = {bld1,bld2,bld3}
$buildings.South = {}
$buildings.East = {bld5,bld6}
$buildings.West = {bld7,bld8,bld9,bld10} 
```

我开始使用 if / elseif 来遍历每一个，但这将是 16 种组合：

```
if ($Buildings.North.count -eq "0" -and $Buildings.South.count -ge "1" -and $Buildings.East.count -ge "1" -and $Buildings.West.count -ge "1" ){set-function -OPT1 $Buildings.South -OPT2 $Buildings.East -OPT3 $Buildings.West }
elseif ($Buildings.North.count -ge "1" -and $Buildings.South.count -ge "1" -and $Buildings.East.count -ge "1" -and $Buildings.West.count -ge "1" ){set-function -OPT1 $Buildings.North -OPT2 $Buildings.South -OPT3 $Buildings.East -OPT4 $Buildings.West}
elseif ($Buildings.North.count -eq "0" -and $Buildings.South.count -eq "0" -and $Buildings.East.count -eq "0"  -and $Buildings.West.count -eq "0"){#empty do nothing}
elseif ($Buildings.North.count -eq "0" -and $Buildings.South.count -eq "0" -and $Buildings.East.count -ge "1" -and $Buildings.West.count -ge "1" ){set-function -OPT3 $Buildings.East -OPT4 $Buildings.West} 
```

由于您可以在一个对象中有数百个选项，因此可能需要很多代码。我还尝试使用字符串构建 cmd：

```
$cmd = ' -Location $Loc' 
if ($Buildings.North.count -ge "1"){ $cmd += ' -OPT1 $Buildings.North ' }
elseif ($Buildings.South.count -ge "1"){$cmd += ' -OPT2 $Buildings.South'}
elseif ($Buildings.East.count -ge "1"){$cmd += ' -OPT3 $Buildings.East'}
elseif ($Buildings.West.count -ge "1"){$cmd += ' -OPT4 $Buildings.West'}
Set-Function $cmd 
```

这种方法也没有太大的成功。必须有更好的方法来进行这种检查，帮助找到它将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:32:42.623

这应该工作：

```
$cmd = ' -Location `$Loc' 
if ($Buildings.North.count -ge "1"){ $cmd += ' -OPT1 `$Buildings.North ' }
elseif ($Buildings.South.count -ge "1"){$cmd += ' -OPT2 `$Buildings.South'}
elseif ($Buildings.East.count -ge "1"){$cmd += ' -OPT3 `$Buildings.East'}
elseif ($Buildings.West.count -ge "1"){$cmd += ' -OPT4 `$Buildings.West'}
Invoke-Expression "Set-Function $cmd" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:53:20.187

```
$Opts = @{
OPT1 = $buildings.North
OPT2 = $buildings.South
OPT3 = $buildings.East
OPT4 = $buildings.West
}

$opts.GetEnumerator() |
foreach {if (-not $_.value){$opts.Remove($_.Name)}}

Set-Function @Opts 
```

FWIW

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T05:23:37.090

```
#Create Test Object
$buildings = New-Object -TypeName psobject -Property @{'North'=@('a','b');'south'=@('x');'West'=@()}

#Returns arrays that are not 0 in count
$buildings | Get-Member -MemberType NoteProperty | ? {($buildings.($_.name)).count} 
```

# c# - Linq 最有效的方法

> ID：15534607
> 
> 赞同：3
> 
> 时间：2013-03-20T20:59:40.763
> 
> 标签：c#, linq

我需要使用 Linq 语句如下

```
 var data = db.tbl1
      .Where(w => clientIds == clientid && w.Source == source); 
```

我有一个下拉列表，我从中获取资源。下拉值如下：

```
All
NewsPaper
Web 
```

问题是 NewsPaper 和 Web 是 Source 的有效值。一切都不是。都意味着记录可以是 NewsPaper 或 Web。

如果他们选择全部，我如何修改 w.Source 以使全部表示 NewsPaper 或 Web。我可以执行 2 个单独的查询，如下所示，但不能：

```
 if(source == "All")
    {
       var data = db.tbl1
      .Where(w => clientIds == clientid);
    }
    else
    {
       var data = db.tbl1
      .Where(w => clientIds == clientid && w.Source == source);
    } 
```

我喜欢在 1 个查询中执行此操作，因为我的查询实际上比上面显示的更复杂。

先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:00:52.710

试试这个：

```
var data = db.tbl1
  .Where(w => clientIds == clientid && (source == "All" || w.Source == source)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T21:02:53.350

@mattytommo 的答案是可以接受的，但我更喜欢将它们分开一点。IMO 更具可读性。

```
var data = db.tbl1.Where(w => clientIds == clientid);

if (source != "All")
    data = data.Where(w => w.Source == source); 
```

# java - Jackson mapper：写作时忽略某些属性？

> ID：15534610
> 
> 赞同：2
> 
> 时间：2013-03-20T20:59:57.047
> 
> 标签：java, json, jackson

我使用 JSON 映射器从字符串中读取对象，然后从对象中写入字符串。我希望只有在写作时才能忽略某些属性。实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:09:45.213

在界面上，您可以使用`@JsonIgnoreProperties(ignoreUnknown=true)`注解忽略任何尚未指定的字段。

例如：

```
@JsonIgnoreProperties(ignoreUnknown=true)
public static interface Point {
    double getLatitude();

    double getLongitude();
} 
```

这将忽略使用 Point 接口序列化的任何其他字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-05T23:12:02.313

您可以使用 @JsonProperty(access = Access.WRITE_ONLY) 忽略序列化的属性。

您可以在以下链接中详细了解有关此属性的更多信息。

[https://fasterxml.github.io/jackson-annotations/javadoc/2.8/com/fasterxml/jackson/annotation/JsonProperty.Access.html](https://fasterxml.github.io/jackson-annotations/javadoc/2.8/com/fasterxml/jackson/annotation/JsonProperty.Access.html)

# db2 - DB2 向用户授予添加、更新、删除权限

> ID：15534613
> 
> 赞同：0
> 
> 时间：2013-03-20T21:00:01.523
> 
> 标签：db2

我需要在我连接到的数据库中向名为“test”的用户授予添加、更新和删除权限。

语法是什么？我试过了：

```
db2 grant add, update, delete on database to test 
```

没有运气。

我在 AIX 中使用 DB2 10（命令行）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:29:30.857

您必须检查可以在数据库及其对象中​​授予的权限类型。

我想“添加”是插入，但这是通过表而不是数据库授予的。更新和删除也是如此。

您可以授予自己权限，前提是您拥有更高的权限，例如 sysadm、dbadm 或 secadm（取决于 DB2 版本和配置的安全性）。

例如：

```
db2 grant insert, update, delete on table db2inst1.emp to user test 
```

授予模式 db2inst1 中表 emp 的所有 DML 权限

如果要将其授予所有表，则应生成授予语句：

```
db2 -x +o -z commands.sql "select 'grant insert, update, delete on table ' || trim(tabschema) || '.' || trim(tabname) || ' to user test;' from syscat.tables where type = 'T'" >
db2 -tvf commands.sql 
```

第一个命令仅通过访问目录即可生成所有授权。第二个，是执行第一个命令的输出。

您最终可以通过管道在一行中执行这两个命令，但是 Unix 限制会阻止输出。

```
db2 -x "select 'grant inser... ... pe = 'T'" | db2 +p -tv 
```

*   授予信息 - [http://publib.boulder.ibm.com/infocenter/db2luw/v10r1/topic/com.ibm.db2.luw.admin.sec.doc/doc/t0005804.html](http://publib.boulder.ibm.com/infocenter/db2luw/v10r1/topic/com.ibm.db2.luw.admin.sec.doc/doc/t0005804.html)
*   db2 +p 解释 - [http://pic.dhe.ibm.com/infocenter/db2luw/v10r1/index.jsp?topic=%2Fcom.ibm.db2.luw.admin.cmd.doc%2Fdoc%2Fr0010412.html](http://pic.dhe.ibm.com/infocenter/db2luw/v10r1/index.jsp?topic=%2Fcom.ibm.db2.luw.admin.cmd.doc%2Fdoc%2Fr0010412.html) [http ://angocadb2.blogspot.fr/2011/12/ejecutar-la-salida-de-un-query-en-clp.html](http://angocadb2.blogspot.fr/2011/12/ejecutar-la-salida-de-un-query-en-clp.html)

# sitecore - Sitecore - 保存媒体项目时执行的操作

> ID：15534617
> 
> 赞同：0
> 
> 时间：2013-03-20T21:00:11.357
> 
> 标签：sitecore, sitecore6, sitecore-media-library

我想在保存媒体项目时运行一些自定义代码，但似乎没有媒体项目保存管道。我们并没有尝试以任何方式更改项目 - 我们只想在保存媒体项目时运行一些自定义代码。谷歌提到了 Sitecore.Resources.Media.MediaProvider 但我读到这不能被覆盖。有谁知道我们可以覆盖在保存媒体项目时触发的管道或自定义处理器？

我正在运行 Sitecore 6.5 rev 120706。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:39:22.710

MediaItem 继承自 CustomItemBase 类。CustomItemBase 类还使用 item:saved 事件，因此您可以创建自定义事件来处理您的自定义代码。

检查您是否正在处理 mediaItem 的快速方法：

```
if (myItem.Paths.IsMediaItem)
{
  // your custom code
} 
```

# iphone - 特定月份和年份的 NSFetchRequest

> ID：15534623
> 
> 赞同：0
> 
> 时间：2013-03-20T21:00:29.260
> 
> 标签：iphone, ios, core-data, nsfetchrequest

我正在尝试设置一个 NSFetchRequest 来查找与给定月份和年份匹配的条目。

数据存储为 NSDate。我现在想知道如何从获取请求中取出组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:12:56.133

根据我的经验，我会创建两个不同的属性来处理这个问题。

在您的实体中创建`month`和`year`类型 int 并再次检查这些。您的谓词将很简单，请求也会很快。

您将在获取日期中的组件时填充它们。

**PS**我不知道其他可能的解决方案，所以也等待其他回复。这是我实现这一目标的个人解决方案。

致谢**@MartinR**。他的评论完全正确。

# ms-access - 需要有关 Access 2000 中 Instr 语法的帮助。尝试在文本字符串中查找值 0.0 到 9.9。

> ID：15534624
> 
> 赞同：0
> 
> 时间：2013-03-20T18:05:27.463
> 
> 标签：ms-access

我是一名访问新手，试图使用 Instr 从文本字符串中选择数字数据。

```
 Instr ( [start], string_being_searched, string2, [compare] )
      [start] defaults to 1
      string_being_searched is [Source Key]
      string2 is a number, decimal and number between 0.0 and 9.9
      [compare] is optional and I do not think it applies here 
```

我的问题是 string2，当我使用它时，它每次出现都返回一个 0

```
 Expr1: InStr([Source Key],'#.#') or, with double quotes 
 Expr1: InStr([Source Key],"#.#") 
```

如果我指定一个诸如 1.4 或 3.2 之类的值，甚至是诸如 QJX 之类的文本值（甚至不是数字），它会返回指定的值，但我需要它来选择两个带有小数点的数字。

请你能帮忙，因为我真的被困住了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:08:46.010

您可能需要 VBA，具体取决于要发生的事情和字符串的结构。

你可以说：

```
If aString Like "*[0-9].[0-9]*" 
```

和

```
Instr(aString,".") 
```

但是您不能在 InStr 中使用通配符。

`Val(aString)`如果文本在数字之后，您可能会逃脱：

```
aString="12.3 lbs"
Val(aString) '' 12.3 
```

或者

```
Mid(aString,Instr(aString,".")-1,3) 
```

否则，您将需要考虑在函数中逐个字符地拆分或循环字符串。

# javascript - 类型不匹配 - JavaScript

> ID：15534629
> 
> 赞同：6
> 
> 时间：2013-03-20T21:00:57.493
> 
> 标签：javascript

尝试使用以下代码时遇到问题。它在 Firefox、Safari、Chrome 和 IE 9+10 中完美运行，但在 IE8 中运行时会导致我的页面的其余部分“崩溃”。我收到的控制台错误是“类型不匹配”，调试器指向 IF 语句行。我一直把头撞在墙上试图弄清楚，但无济于事。有没有人知道这里到底发生了什么？

```
function writeIframe11092()
{
    alert("BEFORE");
    document.write('<iframe style=\"position:absolute;left:-40000px;\" src=\"https://mydomain.com/images/close.gif\" ></iframe>');
    alert("AFTER");
}

if (window.attachEvent) 
    window.attachEvent('onload', writeIframe11092() );
else if (window.addEventListener) 
    window.addEventListener('load',  writeIframe11092(),false); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-20T21:03:49.803

`writeIframe11092()`调用函数并返回一个值（`undefined`在这种情况下），并将该值传递给`attachEvent`.

`writeIframe11092`是一个代表函数本身的变量，这就是你要在这里使用的。

```
if (window.attachEvent){
    window.attachEvent('onload', writeIframe11092);
}
else if (window.addEventListener){
    window.addEventListener('load', writeIframe11092, false);
} 
```

# javascript - PhoneGap Build：如何在 Android 设备浏览器中打开外部 url？

> ID：15534630
> 
> 赞同：19
> 
> 时间：2013-03-20T21:00:57.980
> 
> 标签：javascript, android, cordova, phonegap-build

外部 URL 没有在我的 PhoneGap Android 应用程序的系统浏览器中打开。我正在使用 PhoneGap Build 2.3.0。

根据[Cordova 文档](http://cordova.apache.org/docs/en/2.3.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)，我使用了目标“_system”：

```
window.open('http://www.myurl.nl', '_system'); 
```

在我的 config.xml 中，我有：

```
<plugin name="InAppBrowser" value="org.apache.cordova.InAppBrowser" />
<access origin="*" browserOnly="true" /> 
```

但仍然在我的应用程序 webview 中打开链接。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-23T19:03:05.297

当您想继续使用 PhoneGap Build 时，这不是答案，但我通过在我的机器上为 Cordova (PhoneGap) 设置开发环境并在本地编译应用程序解决了这个问题。在 Cordova 2.5.0`window.open('http://www.myurl.nl', '_system');`中完美运行，它会在系统的浏览器中打开链接。

所以我的建议是停止使用 PhoneGap Build 并开始在本地编译您的应用程序。[以下是如何为 Cordova 设置开发环境 >>](http://cordova.apache.org/docs/en/2.5.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-02-22T17:12:26.607

迟到的答案，但可能对某人有帮助。

```
navigator.app.loadUrl('https://google.com/', { openExternal:true }); 
```

**科尔多瓦 3.3.1**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-06T19:13:30.197

这个问题现在有点老了，但我觉得值得更新。现在，当与 2.9.0 一起使用时，这可以与 PhoneGap Build 一起正常工作。

我已经在 Android 4.3 和 iOS 6.1.3 上编译并测试了它。我的应用程序中没有 InAppBrowser 插件，因为它是在应用程序中打开页面，而不是导致本机浏览器打开它们，并且我只有以下访问标签：

```
<access origin="http://127.0.0.1*"/>
<access origin="http://phonegap.com" subdomains="true" /> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-02-23T18:58:31.813

这对我有用。电话间隙 3.1.0。

html代码：

```
<a id="ext-link" href="#">Google it</a> 
```

或者

```
<button id="ext-link" href="#">Google it</button> 
```

Javascript（使用 jQuery+cordova）：

```
$("#ext-link").on("click"), function() {
    if (typeof navigator !== "undefined" && navigator.app) {
        // Mobile device.
        navigator.app.loadUrl('http://www.google.com/', {openExternal: true});
    } else {
        // Possible web browser
        window.open("http://www.google.com/", "_blank");
    }
}); 
```

希望有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-02T14:27:40.997

@George Siggouroglou：对于最终将在文档中出现多次的元素使用 id 并不是一个好主意。相反，使代码更加模块化是一种很好的做法。

如果期待触摸设备，在“点击”之前使用“点击”也是一个不错的选择，因为它比点击更快更早地触发。要检查具有触摸功能的东西，我更喜欢使用modernizr，因为它使功能检测变得轻而易举。

> jQuery Mobile 点击事件在单个目标对象上发生的快速、完整的触摸事件之后触发。它相当于标准点击事件的手势，由触摸手势的释放状态触发。 *[https://api.jquerymobile.com/tap/](https://api.jquerymobile.com/tap/)*

希望对某人有所帮助

```
**html code:**

<a class="ext-link" href="#">Google it</a> 
```

**或者**

```
<button class="ext-link" href="#">Google it</button> 
```

**Javascript（使用 jQuery）：**

```
//define tap or click event type on root level (can be combined with modernizr)
iaEvent = "click";
if (typeof navigator !== "undefined" && navigator.app) {
   iaEvent = "tap";
}
$('.ext-link').each.bind(iaEvent, function() {
    if (typeof navigator !== "undefined" && navigator.app) {
        // Mobile device.
        var linktarget = this.attr("href");
        navigator.app.loadUrl(linktarget, {openExternal: true});
    } else {
        // Possible web browser
        window.open(linktarget, "_blank");
    }
}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-20T21:09:47.687

用这个

`window.open('http://www.myurl.nl', '_blank', 'location=yes');`

# perl - 如何编写 Perl 脚本来检查 x 列数以在另一行中为每个返回值打印一个值

> ID：15534631
> 
> 赞同：0
> 
> 时间：2013-03-20T21:01:00.223
> 
> 标签：perl, loops, if-statement, foreach

我在 CSV 文件中有数据（IP 地址），该文件将是第 9-13 列。如果其他列中没有值，则默认情况下它应该只打印第 9 列中的内容。有一个输出文件将打印一组值和第 9 列的值（如果有值，则通过 13存在）与静态值连接以创建别名值。我的问题是，你将如何有效地做到这一点？我有这个有效的代码：

```
my $alias0= "ComponentAliases=['ComputerSystem:$columns[9]'];\n";
my $alias1= "ComponentAliases=['ComputerSystem:$columns[9]','ComputerSystem:$columns[10]'];\n";
my $alias2= "ComponentAliases=['ComputerSystem:$columns[9]','ComputerSystem:$columns[10]','ComputerSystem:$columns[11]'];\n";

        print BAROC "ComputerSystem;\n";
        if(($columns[11] != '')&&($columns[10] != '')) {  print BAROC $alias2 }
        elsif(($columns[11] == '')&&($columns[10] != '')) {  print BAROC $alias1 }
        elsif(($columns[11] == '')&&($columns[10] == '')) { print BAROC $alias0 } 
```

这可以做我想做的事情，但是CSV文件有可能在第9-13或9-11列等中有值。很容易我认为静态编写它会很好，但我想做它有效地理解并始终应用最佳实践。我是编写 Perl 脚本的新手，但一直被它吸引来解决工作中的问题。建议？

这是输出，顺便说一句：

```
ComponentAliases=['ComputerSystem:10.1.0.225','ComputerSystem:10.200.252.77','ComputerSystem:10.100.252.77']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:05:01.800

```
#!/usr/bin/env perl

use strict;
use warnings;

use Text::CSV_XS;

my $csv_in = Text::CSV_XS->new
    or die Text::CSV_XS->error_diag;

my $csv_out = Text::CSV_XS->new({
    always_quote => 1,
    quote_char => q{'},
}) or die Text::CSV_XS->error_diag;

while (my $row = $csv_in->getline(\*DATA)) {
    my @aliases = map "ComputerSystem:$_",
                  grep defined && length, @$row[9 .. 13];
    if ($csv_out->combine(@aliases)) {
        printf "ComponentAliases=[%s];\n", $csv_out->string;
    }
}

__DATA__
0,1,2,3,4,5,6,7,8,10.1.0.225,10.200.252.77,,,,,,,
0,1,2,3,4,5,6,7,8,10.1.0.225,10.200.252.77,10.100.252.77,,,,, 
```

输出：

```
C:\温度> gn
ComponentAliases=['ComputerSystem:10.1.0.225','ComputerSystem:10.200.252.77'];
ComponentAliases=['ComputerSystem:10.1.0.225','ComputerSystem:10.200.252.77','Co
电脑系统：10.100.252.77']；
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:05:36.547

Efficiently now 意味着*可维护*的。尝试保存一两个命令不会为您节省太多时间。事实上，如果编译器无法弄清楚你在做什么，它实际上可能会使程序效率更低。

重要的是可读性。摆脱这些`$alias`东西。它只是让你更难看到你的代码在做什么，你最终可能会遇到各种各样的副作用来做这样的事情。

缺少空白也使您的代码更难弄清楚。重新格式化您的代码后，我立即发现了一个错误。你这样做了：

```
if ( ($columns[11] != '') && ($columns[10] != '') ) 
```

但是，这是一个*字符串比较*。你需要这样做：

```
if ( ( $columns[11] ne '' ) && ( $columns[10] ne '' ) ) { 
```

或者，您可以进一步简化它：

```
if ( not $column[10] and not $column[11] ) { 
```

这使您非常清楚您要查找的内容，并且无论列是否包含数字零、空字符串或未定义，都可以使用。

此代码片段正在使用您的逻辑，但我利用了`print`不会`\n`在字符串末尾自动添加 a 的事实。我只是继续建立在这条线上：

```
if ( $columns[9] ) {
    print BAROC "ComputerSystem;\n";
    print BAROC "ComponentAliases=['ComputerSystem:$columns[9]'";

    if ( $columns[10] ) {
         print BAROC ",ComputerSystem:$columns[10]";
    }
    if ( $columns[11] )  {
        print BAROC ",ComputerSystem:$columns[11]";
    }
    print BAROC "];\n";
} 
```

您提到如果这些列中有数据，您可能需要第 9 到 13 列。为什么不使用循环？

```
if ( $#columns >= 9 ) {    #There are at least nine columns
    print BAROC "ComputerSystem;\n";
    print BAROC "ComponentAliases=[ComputerSystem:$columns[9]";

    for my $column ( (10..$#columns) ) {
       last if not $column[$column];
       print BAROC ",ComputerSystem:$columns[$columns];
    }
    print BAROC "];\n";
} 
```

如果有更多时间，我相信我可以进一步清理逻辑。但是，无论有 9、10、11 还是 43 列数据，这都可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:09:52.847

一个班轮（不是那么优雅，但不知何故我喜欢它）：

```
print "ComponentAliases=[".join(",",map {"'ComputerSystem:$_'"} grep {$_ ne ""} @columns[9-13])."]\n"; 
```

或者，如果您更喜欢以更易于理解的方式使用相同的代码：

```
print(  
        "ComponentAliases=[",
        join(
            ",",
            map(    
                "'ComputerSystem:$_'",
                grep (
                        $_ ne "",
                        @columns[9-13]
                     )
               )
            ),  
        "]\n"
     ); 
```

# java - 如何检查对象是否已保存到数据库

> ID：15534634
> 
> 赞同：2
> 
> 时间：2013-03-20T21:01:17.810
> 
> 标签：java, jdbc, spring-jdbc

我正在使用 Spring JDBC，我想创建一个方法来检查它是否已经持久化到数据库中，这意味着它会获得一个自动递增的键。

我有一个名为`id`int 类型的字段。由于如果没有给出其他值，原始整数会自动分配为 0，我可以创建一个方法来检查是否`id == 0`但我必须确保我的主键序列从 1 开始。

我还可以在存储库中创建一个方法来检查对象是否已保存，但是我不想对此进行查询。

我能想到的最后一个选项是更改 to 的类型，`id`然后`Integer`检查它是否是，`null`但我不知道这是否是一个好方法。

有没有办法在域层中有一个方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:33:35.263

改变`id`from `int`to的类型被认为是一个好主意： [Hibernate](http://docs.jboss.org/hibernate/core/3.6/quickstart/en-US/html/hibernate-gsg-tutorial-annotations.html#hibernate-gsg-tutorial-annotations-entity)`Integer`和 JPA等持久性框架鼓励这样做（参见[java.net](http://weblogs.java.net/blog/bleonard/archive/2006/12/need_a_primary.html)中的这个示例和[adam-bien.com](http://www.adam-bien.com/roller/abien/entry/ejb_3_persistence_jpa_for)中的这个示例）。

使用对象类型可以让您快速区分非持久对象和持久对象，只需检查`id == null`. 只是为了完整性：

*   `id == null`：未保存的对象，执行`INSERT`
*   `id != null`：对象已保存，执行`UPDATE`

这样，您不必将`0`（或任何其他整数值）视为特殊情况，即*uninitialized*；你已经有了`null`，它很好地传达了特殊情况的想法。

**添加业务密钥**

[本文](http://www.onjava.com/pub/a/onjava/2006/09/13/dont-let-hibernate-steal-your-identity.html "不要让 Hibernate 窃取您的身份")建议的一种更好的方法是在数据库管理的 ID 之外使用业务密钥。业务键是一个实体标识符，与自动生成的主键（*代理键*）不同，它对用户具有一定的意义（*自然键*）。

然后，您应该重写该`equals`方法以使用业务键而不是自动生成的主键来比较两个对象。

# c# - Ajax - 'Access-Control-Allow-Origin 不允许 Origin localhost'

> ID：15534640
> 
> 赞同：4
> 
> 时间：2013-03-20T21:01:41.090
> 
> 标签：c#, ajax, jquery, xmlhttprequest, cross-domain

我对 Ajax 比较陌生，只是负责这个跨域调用。我们的网页上有一个文本框，用户将使用它来搜索公司名称。通过单击文本框旁边的按钮，将请求 Ajax 调用。不幸的是，Web 服务位于一个单独的域中，因此这自然会引起问题。

以下是我完成这项工作的最佳尝试。我还应该注意，此调用的目的是以 XML 格式返回结果，该结果将在`success`请求的部分中进行解析。

这是错误消息：

`Origin http://localhost:55152 is not allowed by Access-Control-Allow-Origin.`

我不知道该怎么做才能解决问题，任何想法都将不胜感激。

```
function GetProgramDetails() {
    var URL = "http://quahildy01/xRMDRMA02/xrmservices/2011/OrganizationData.svc/AccountSet?$select=AccountId,Name,neu_UniqueId&$filter=startswith(Name,\'" + $('.searchbox').val() + "\')";
    var request = $.ajax({
        type: 'POST',
        url: URL,
        contentType: "application/x-www-form-urlencoded",
        crossDomain: true,
        dataType: XMLHttpRequest,
        success: function (data) {
            console.log(data);
            alert(data);
        },
        error: function (data) {
            console.log(data);
            alert("Unable to process your resquest at this time.");
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T01:40:43.280

此错误是由于跨域资源共享中强制执行的限制。这已作为安全功能的一部分实现，以通过跨域调用限制资源的客户端（域）。当您向 web 服务或 api 或类似服务发送请求时，它会在服务器或目标（此处为您的 api）的请求中添加 Origin 标头，以验证请求是否来自授权来源。理想情况下，api/server 应该`Origin`在`Request header`它收到的内容中查找，并可能针对允许向其提供资源的一组源（域）进行验证。如果它来自允许的域，它将在响应标头中添加与`"Access-Control-Allow-Origin"`价值。为此也允许使用通配符，但问题是，有了通配符权限，任何人都可以发出请求并获得服务（有一些限制，例如通过 windows auth 或 cookie 对 api 进行身份验证，您需要在其中发送`withCredentials`值`*`是不允许的）。使用通配符来源作为对所有人开放的响应标头不是一个好习惯。

这些是使用值设置响应标头的一些方法：-

```
Access-Control-Allow-Origin: *
Access-Control-Allow-Origin: http://yourdomain.com 
```

您甚至可以在同一个响应中添加多个 Access-Control-Allow-Origin 标头（我相信适用于大多数浏览器）

```
Access-Control-Allow-Origin: http://yourdomain1.com
Access-Control-Allow-Origin: http://yourdomain2.com
Access-Control-Allow-Origin: http://yourdomain3.com 
```

在服务器端（c# 语法）你会这样做： -

```
var sourceDomain = Request.Headers["Origin"]; //This gives the origin domain for the request
     Response.AppendHeader("Access-Control-Allow-Origin", sourceDomain ); //Set the response header with the origin value after validation (if any) .Depending on the type of application you are using syntax may vary. 
```

希望这可以帮助！！！

# r - 使用 TopGO 丰富一组基因的 GO 术语

> ID：15534645
> 
> 赞同：1
> 
> 时间：2013-03-20T21:02:06.310
> 
> 标签：r, bioconductor

我正在尝试从用户给出的一组基因中获取丰富的 GO 术语列表。我理解和实施的方式是：

我的输入是一个包含大约 500 个基因的 csv 文件。

```
>library(topGO)        
>library(hgu133plus2.db)
>all.genes <- ls(hgu133plus2ACCNUM) # I guess, this creates my gene universe

>data <- read.csv(file.choose(),header=FALSE) #Here I give an input csv file containing     genes

>relevant.genes <- factor(as.integer(all.genes %in% data)
>names(relevant.genes) <- all.genes
>GOdata.BP <- new("topGOdata", ontology='BP', allGenes = relevant.genes, annotationFun =annFUN.db, affyLib = 'hgu133plus2.db') 
```

在此之后我收到以下错误：

```
Error in .local(.Object, ...) : allGenes must be a factor with 2 levels
> str(relevant.genes)
Factor w/ 1 level "0": 1 1 1 1 1 1 1 1 1 1 ...
- attr(*, "names")= chr [1:54675] "1007_s_at" "1053_at" "117_at" "121_at" ... 
```

你能告诉我我哪里错了吗？我使用 TopGO 是否正确，即使我没有表达式值。

# git - git svn 分支历史丢失

> ID：15534646
> 
> 赞同：2
> 
> 时间：2013-03-20T21:02:07.710
> 
> 标签：git, git-svn

我正在使用“git svn”来克隆一个 SVN 存储库。我正在使用的 SVN 存储库不遵循 SVN 分支的标准约定（将分支放在名为“bugs”的文件夹中，而不是“分支”）。像我这样的开发人员应该在这个 bug 文件夹中创建的分支上工作。

为了能够针对这些错误进行开发，并且能够测试它是否可以正常合并，这就是我所做的。

1.  我将 svn 主干克隆为主分支。
2.  然后我检查了一个跟踪 SVN 分支 (svn/bugs) 的分支。

    我按照此链接中的说明在本地创建了一个 git 分支。

[我如何告诉 git-svn 获取 repo 后创建的远程分支？](https://stackoverflow.com/questions/296975/how-do-i-tell-git-svn-about-a-remote-branch-created-after-i-fetched-the-repo)

在 master (svn trunk) 上，当我执行“git log”时，查看整个 svn 历史记录。我想要的。但是，在我的错误分支中，当我执行“git log”时，它只显示为创建分支所做的最后一次提交。如果我直接导​​入相同的 svn 分支（不使用 git），我确实会看到所有其他提交历史记录。

谁能告诉我如何链接这个“git svn 分支”（bug 分支）上的历史记录，以便获得整个历史记录？（我希望能够做 git blame 来找到所有的变化）

# quickbooks - 通过商户服务确认测试信用卡交易

> ID：15534649
> 
> 赞同：0
> 
> 时间：2013-03-20T21:02:17.153
> 
> 标签：quickbooks, intuit-partner-platform

我们正在向测试 QBMS 网关提交测试 cc 信用卡交易，并希望验证它们是否正确提交。我们得到的似乎是对提交的正确响应有效的响应，但在过去的一个月里，商家服务中心没有显示任何内容。这是正确的，即测试服务中心被击中或错过，还是在其他地方失败？即使我们通过测试页面提交的项目也不会显示在服务中心。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:37:14.193

如果您在此处使用 TEST 工具，它将在测试帐户而不是您的帐户下发布交易，因此您会看到成功的响应，但是如果您在测试帐户下登录，您只会看到交易，这是不可能的它只是为了测试。

[http://docs.developer.intuit.com/0085_QuickBooks_Windows_SDK/030_qbms/0030_Get_Set_Up/5._Try_a_Test_Transaction](http://docs.developer.intuit.com/0085_QuickBooks_Windows_SDK/030_qbms/0030_Get_Set_Up/5._Try_a_Test_Transaction)

谢谢贾里德
_

# assembly - 排除反向字符串

> ID：15534652
> 
> 赞同：0
> 
> 时间：2013-03-20T21:02:28.297
> 
> 标签：assembly, x86, masm, irvine32

我编写了一个程序来反转它给出的字符串，但结果似乎不匹配。

我使用正向和反向指示要交换的索引，最后在尾部添加空字符。

结果应该是

```
67 6E 69 72 74 73 20 65 63 72 75 6F 73 20 65 68 74 20 73 69 20 73 69 68 54 00 
```

但我的结果是

```
00 67 6E 69 72 74 73 20 65 63 72 75 6F 73 20 65 68 74 20 73 69 20 73 69 68 00 
```

似乎有问题，但我无法找出错误在哪里。

你能帮我找出可能出错的地方吗？

提前谢谢。

```
INCLUDE Irvine32.inc

.data
source BYTE "This is the source string",0;26
target BYTE SIZEOF source DUP('#')
strl BYTE 0 
foward DWORD 0
backward DWORD 0

.code
main PROC
    mov strl, LENGTHOF source;26
    dec strl; last char is 25\. 26 is null
    movzx ecx, strl;count = 25 
    mov foward, 0
    movzx eax, strl
    mov backward, eax

    L1:
        mov esi, backward
        mov al,source[esi]
        dec backward

        mov esi, foward
        mov target[esi], al
        inc foward

        loop L1

    movzx esi, strl

    mov al,source[esi]
    mov target[esi], al

    mov esi,OFFSET target ; offset of variable
    mov ebx,1 ; byte format
    mov ecx,SIZEOF target ; counter
    call DumpMem

main ENDP

END main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:07:19.960

改变这个：

```
 mov esi, backward
    mov al,source[esi]
    dec backward 
```

到：

```
 dec backward
    mov esi, backward
    mov al,source[esi] 
```

因为：

```
 movzx eax, strl
    mov backward, eax 
```

最初`backward`不是指向字符串的最后一个元素，而是最后一个（0字节），所以你首先阅读它。

# c++ - 内存泄漏错误？

> ID：15534654
> 
> 赞同：1
> 
> 时间：2013-03-20T21:02:42.207
> 
> 标签：c++, memory-leaks

对于与动态内存和复制构造函数有关的简单分配，我的教授已经分配给我们一个简单的分配，但是在第二次发生时我得到了一个错误`delete []`。

头文件：

```
class Stream {
    int len;
    char *hold;
    char* newmem(int);
public:
    Stream ();
    Stream (int);
    Stream(const char *);
    ~Stream ( );
    void operator=(const Stream &);
    Stream(const Stream &);
    friend void show(Stream);
    void operator<<(const char*);
}; 
```

它应该相当简单。这是我的代码：

```
#include <iostream>
#include <new>
#include <cstring>
using namespace std;
#include "stream.h"

char* Stream::newmem(int x) {
    char * tmp;
    try {
        tmp = new char[x];
    }
    catch(std::bad_alloc) {
        tmp = NULL;
    }
    if(tmp)
        cout << "newmem:  " << (void *) tmp << endl;
    return tmp;
}

Stream::Stream ( ) {
    len = 1000;
    hold = newmem(len);
    if (hold)
        strcpy (hold, "");
}

Stream::Stream(int n) {
    len = n;
    hold = newmem(len);
    if (hold)
        strcpy (hold,"");
}

Stream::Stream(const char * dat) {
    len = strlen(dat) +1;
    hold = newmem(len);
    if (hold)
        strcpy(hold,dat);
}

Stream::Stream(const Stream &from) {
    cout << "in the copy constructor, allocating new memory..." << endl;
    cout << "original pointer address is: " << (void *) from.hold << endl;
    cin.get( );

    len=from.len;
    hold=newmem(len +1);
    cout << "new pointer address is: " << (void *) hold << endl;
    cin.get( );

    if(hold)
        strcpy (hold,from.hold);
}

Stream::~Stream ( ) {
    cout << "destruct:  " << (void *) hold << endl;
    cin.get( );
    if (hold)
        delete [] hold;
}

void Stream::operator= (const Stream &from) {
    if(hold)
        delete [ ] hold;
    len = from.len;
    hold=newmem(len +1);
    if (hold)
        strcpy(hold,from.hold);
}

void show (Stream prt) {
    cout << "String is: " << prt.hold << endl << "Length is: " << prt.len << endl;
}

void Stream::operator<< (const char *data) {
    int dlen = strlen(data);
    for (int i=0 ; i<=len && i<=dlen ; i++) {
        hold[i] = data[i];
    }
}

int main( ) {
   char data[ ] = "Growing up it all seems so one-sided;"
                  "Opinions all provided;"
                  "The future pre-decided;"
                  "Detached and subdivided;"
                  "In the mass production zone!"
                  "-Neil Peart- \"Subdivisions\"";

   Stream x1, x2(25), x3;
   x1 << data;
   x2 << data;
   show(x1);
   show(x2);

   x3 = x2;
   show(x3);

   return 0;
} 
```

和我的输出/错误：

```
在复制构造函数中，分配新内存...
原始指针地址为：0x804c008

新指针地址为：0x804c808

弦是：长大这一切似乎如此片面；意见全都提供；未来已定；分离和细分；在量产区！-Neil Peart-细分”
长度为：1000
破坏：0x804c808

在复制构造函数中，分配新内存...
原始指针地址为：0x804c3f8

新指针地址为：0x804c808

字符串是：长大了这一切似乎都是如此
长度为：25
破坏：0x804c808

*** 检测到 glibc *** a.out：free()：无效指针：0x0804c808 ***

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:15:21.553

中的 for 循环`operator<<`有*两个*错误：

```
for (int i=0 ; i<=len 
```

允许`i==len`，但唯一有效的索引`hold`是`0..(len-1)`。所以，你可以在最后写一个。

其次，正如 thiton 指出的那样，`\0`即使有空间，它也不会复制终止符。

* * *

正确的实现可能如下所示：

```
void Stream::operator<< (const char *data) {
    int source_len = strlen(data);
    int copy_len = min(source_len, len-1); // allow for terminator

    for (int i=0; i<copy_len; i++) {
        hold[i] = data[i];
    }
    hold[copy_len] = '\0';
} 
```

尽管最好简单地使用`strncpy`.

* * *

请注意，使用半开（或过去一个）范围的习惯用法不仅在直接数组索引中是标准的，而且在 C++ 迭代器中也是标准的。所以，你应该总是期望看到

```
for (i=0; i<n; ++i) { 
```

或者

```
for (i = begin; i != end; ++i) { 
```

并且通常应该将像您这样的封闭式循环视为值得进一步调查的气味。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:15:38.087

首先是一点自助建议：捕获内存访问错误的最重要工具是`valgrind`. 在您的程序上运行它，每次您尝试访问未分配或未初始化的内存时都会收到警告。它不能替代知识，而是下一个最好的东西。

虽然我得到的输出与你得到的不同，但错误似乎在这里相互作用：

1.  在`operator<<`范围检查中有一个错误。它写了一个字节太多（`hold[len]`）。
2.  `operator<<`永远不会写入终止的空字节。这两个错误都是由 调用的`x2 << data`。
3.  当复制构造函数尝试从 复制字符串时`x2`，`strcpy`找不到终止的空字节，并且都在 结尾处读取并在结尾处`x2.hold`写入`x3.hold`。后者有可能造成无限的损坏，并可能导致您的错误。

每当您处理 C 字符串时，请务必确保正确终止。固定版本是：

```
void Stream::operator<< (const char *data) {
    int dlen = strlen(data);
    hold[len-1] = 0;
    for (int i=0 ; i < len-1 && i <= dlen ; i++) {
         hold[i] = data[i];
    }
} 
```

或者，使用 std 库：

```
void Stream::operator<< (const char *data) {
    strncpy(hold, data, len);
    hold[len-1] = 0;
} 
```

# javascript - 加载后页面跳转

> ID：15534655
> 
> 赞同：2
> 
> 时间：2013-03-20T21:02:44.670
> 
> 标签：javascript, html, css

页面加载后 1-3 秒后，我的页面跳回顶部。我开始滚动页面加载的第二个。它跳回来。我找不到问题。任何人有任何想法为什么会这样？

[http://vietnam.asiastreetfood.com/vietnamesischer-feuertopf/](http://vietnam.asiastreetfood.com/vietnamesischer-feuertopf/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:07:53.570

这是你的代码：

```
$(document).ready(function() {
    $('input[placeholder]').placeholder();
});

$(window).load(function() {
    var vWrapWidth  = -$("#wrapper").width()/2;
    var vWrapHeight = -$("#wrapper").height()/2;
           $("#wrapper").css({'margin-left' : vWrapWidth});
           $("#wrapper").css({'margin-top' : vWrapHeight});

    var vCompWidth    = -$(".company a img").width()/2;
           $(".company a img").css({'margin-left' : vCompWidth});
}); 
```

在您的所有图像完全渲染之前，该部分`$(window).load(function(){})`不会触发，这可能需要几秒钟。对边距的 .css 更改可能会导致跳跃行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:06:17.627

一个可能的罪魁祸首是：

```
document.location.href = "#"; 
```

或者

```
document.location.href = "#missinganchor"; 
```

`missinganchor`页面上未定义的锚点在哪里。这将导致页面*跳转*到顶部。

# android - 移动图像按钮后应用程序崩溃！安卓

> ID：15534656
> 
> 赞同：0
> 
> 时间：2013-03-20T21:02:48.010
> 
> 标签：android, crash

所以我最近开发的应用程序进展顺利，我刚刚更新了应用程序背景中的图像。好吧，在我调整图像按钮以与我制作的图像对齐之前，该应用程序正在运行。在我移动它之后，该应用程序将不再工作，我尝试了一切都没有成功。这是活动的xml

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:tools="http://schemas.android.com/tools"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:background="@drawable/title_screen"
  tools:context=".TitleScreen" >

  <TextView
    android:id="@+id/txtCoins"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:layout_marginRight="18dp"
    android:layout_marginTop="11dp"
    android:text="000"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="#f3c50d"
    android:textSize="12sp" />

  <ImageButton
    android:id="@+id/imageBtnPlay"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/txtCoins"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="51dp"
    android:background="@null"
    android:src="@drawable/btn_play" />

   </RelativeLayout> 
```

编辑：这是我的 logcat

```
03-20 17:08:29.847: W/dalvikvm(28692): threadid=1: thread exiting with uncaught exception (group=0x416282a0)
03-20 17:08:29.852: E/AndroidRuntime(28692): FATAL EXCEPTION: main
03-20 17:08:29.852: E/AndroidRuntime(28692): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.ChonBonStudios.Tidbits/com.ChonBonStudios.Tidbits.TitleScreen}: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.ImageButton
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2100)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.os.Looper.loop(Looper.java:137)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread.main(ActivityThread.java:4898)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at java.lang.reflect.Method.invokeNative(Native Method)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at java.lang.reflect.Method.invoke(Method.java:511)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at dalvik.system.NativeStart.main(Native Method)
03-20 17:08:29.852: E/AndroidRuntime(28692): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.ImageButton
03-20 17:08:29.852: E/AndroidRuntime(28692):    at com.ChonBonStudios.Tidbits.TitleScreen.onCreate(TitleScreen.java:20)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.Activity.performCreate(Activity.java:5191)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
03-20 17:08:29.852: E/AndroidRuntime(28692):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2064)
03-20 17:08:29.852: E/AndroidRuntime(28692):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:15:45.957

> android.widget.TextView 不能转换为 android.widget.ImageButton

您正在将活动更改`TextView`为班级`ImageButton`某处的错误`com.ChonBonStudios.Tidbits.TitleScreen`班级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:18:27.473

这是一个常见问题。通过选择清理您的项目，`Project - Clean`它将起作用。就像*gpasci*说的，检查你是否正确初始化了你的字段

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:20:59.967

如果我理解正确，您只是在布局中切换了 TextView 和 ImageButton 的位置，没有代码更改。

尝试简单地清理项目和/或重新启动 Eclipse。有时我会遇到类似的问题，即自动生成的 Id 只是不同步，这就是 a`findViewById(R.id.imageBtnPlay)`实际返回 TextView 的原因。

# java - 识别方法逻辑按下哪个按钮的最佳方法

> ID：15534657
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:02:49.437
> 
> 标签：java, button, swt

我有一种用于两种不同操作的方法。动作由用户按下哪个按钮来识别。

我正在使用布尔值来识别按钮按下。

```
PDFButton.addSelectionListener(new SelectionAdapter() {
   public void widgetSelected(SelectionEvent e) {
      buildArray(true);
   }
});

PlotButton.addSelectionListener(new SelectionAdapter() {
   public void widgetSelected(SelectionEvent e) {
      buildArray(false);
   }
});

public void buildArray(boolean buttonId) {
   get indexs etc...
   if(true) {
      PDF.getInstance.buildArray(index);
   }
   else { 
      Plot.getInstance.buildArray(index);
   }
 } 
```

这似乎是最好的方法吗？

**编辑**粘贴的按钮片段中的错字。有2个按钮不是一个。我想要做的是在 IF 逻辑中设置一个条件，所以我知道按下了哪个按钮来激活 buildArray 方法。

```
public void buildArray() {
   get indexs, mode code.....
   if**(button press equals PDFButton)** {
      PDF.getInstance.buildArray(index);
   }
   else { 
      Plot.getInstance.buildArray(index);
   }
 } 
```

我知道一种方法是创建一个类似于 buildArray 的单独方法。然后每个按钮将执行自己的方法。

```
PDFButton.addSelectionListener(new SelectionAdapter() {
   public void widgetSelected(SelectionEvent e) {
      PDFbuildArray(true);
   }
});

PlotButton.addSelectionListener(new SelectionAdapter() {
  public void widgetSelected(SelectionEvent e) {
      PlotbuildArray(false);
  }
}); 
```

但我想整合尽可能多的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T16:07:39.183

我最终使用了 Action Event getSource().getText()。所以这个方法最终看起来像这样。

```
 ublic void getSelectedTableData(SelectionEvent e) {
  int[] row = viewer.getTable().getSelectionIndices();
  Arrays.sort(row);
  if (row.length > 0) {
     for(int i = row.length-1; i >= 0; i--){
        if(((Button) e.getSource()).getText() == "Plotting")   
           AplotPlotDataModel.getInstance().buildPlotArray(row[i]);
        else {
           AplotPDFDataModel.getInstance().buildArray(row[i]);
        }
     }
  }
 } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T21:24:47.217

你读过 Swing 教程吗？它有关于如何执行此操作的示例，通常使用 setActionCommand() 和 getActionCommand() IIRC。

此外，您的代码中至少有两个错误。

*   首先，您当前的代码从未将数组值设置回 false，因此每次按下按钮时，所有先前按下的按钮也会执行。除非这是你想要的...
*   其次，就像第一次一样，如果按钮被按下得太快，第二次按下按钮可能会在第一次按下按钮代码将状态更改回 false 之前执行。除非你添加一个同步块，否则会有一个时序条件，其行为与我的第一个项目符号中描述的一样。

# erlang - Erlang 元组转字符串

> ID：15534663
> 
> 赞同：7
> 
> 时间：2013-03-20T21:03:18.033
> 
> 标签：erlang

有没有办法将元组转换为字符串？

考虑我有以下列表：

```
[{atom,5,program},{atom,5,receiving},{nil,5}] 
```

我希望将其转换为以下字符串：

```
"{atom,5,program},{atom,5,receiving},{nil,5}" 
```

我尝试在列表中的每个元素上使用 erlang:tuple_to_list ，它返回

```
A = [atom,5,program] 
```

最终，我无法将其与 "{" ++ A ++ "}" 连接起来

有什么想法可以将其转换为字符串吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-20T21:23:19.887

```
Term = [{atom,5,program},{atom,5,receiving},{nil,5}].
lists:flatten(io_lib:format("~p", [Term])). 
```

# java - 如何在 Jasper Reports 中动态添加多条数据

> ID：15534664
> 
> 赞同：0
> 
> 时间：2013-03-20T21:03:19.433
> 
> 标签：java, jasper-reports

我有一份正在使用 Java 编写的 Jasper 报告。

在 Java 中，我可以使用以下代码使用数据动态填充 bean：

```
 List<ThemeBean> themes = new ArrayList<ThemeBean>();
    CSVReader csvReader = new CSVReader(new FileReader(csvFilename));
    List<String[]> data = csvReader.readAll();
    for(String[] d : data) {
        ThemeBean tb = new ThemeBean();
        tb.setThemes(d[0]);
        tb.setComments(d[1]);
        tb.setSentiment(d[2]);
        themes.add(tb);
    }   
        JasperDesign jasperDesign = JRXmlLoader.load(fileName);
        JRBeanCollectionDataSource ds = new JRBeanCollectionDataSource(themes);
        JasperReport jasperReport = JasperCompileManager.compileReport(jasperDesign);
        JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, null, ds); 
```

当 .jrxml 文件在标签中指定了正确的字段和 textFieldExpression 时，这很有效......

以下内容使用已构建的列表动态填充：

```
<textFieldExpression><![CDATA[$F{themes}]]></textFieldExpression> 
```

我的问题是弄清楚如何为同一报告中的两个不同表动态地执行此操作。看来我只能用于动态添加数据的一次迭代。我正在尝试实现在同一个报告中生成两个完全不同的表的结果。如果这个问题不清楚，请告诉我，我会尝试解决它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T10:46:39.437

You can pass multiple bean collections to a report by creating another bean that holds a beanCollection. Such a bean would look like this:

```
public class DataBean {
    private Collection beanCollection = null;

    public DataBean() {
    }

    public Collection getBeanCollection() {
        return beanCollection;
    }

    public void setBeanCollection(Collection beanCollection) {
        this.beanCollection = beanCollection;
    }
} 
```

I assume that the other collection will be of a different type than `ThemeBean`. I'm using `FruitBean` as an example. For each bean collection you want to pass, you create a `DataBean` and add it to a collection, then pass *that* collection to the report. So your code would change to be something like this:

```
List<DataBean> allData = new ArrayList<DataBean>();

//...Create and populate `List<ThemeBean> themes`

DataBean db = new DataBean();
db.setBeanCollection(themes);
allData.add(db);

//...Create and populate `List<FruitBean> fruits`

db = new DataBean();
db.setBeanCollection(fruits);
allData.add(db);

//... Load the report
JRBeanCollectionDataSource ds = new JRBeanCollectionDataSource(allData);
//... Fill the report 
```

The report that you fill with this datasource will be a shell report, containing a subreport for each `DataBean` you created. There will only be one field available in this report: `$F{beanCollection}`

Set the datasource expression of the subreport(s) to

`new JRBeanCollectionDataSource($F{beanCollection})`.

The fields for `ThemeBean` or `FruitBean` will then be available within the subreport.

If you prefer to use list components instead of subreports, that would also work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T10:00:31.303

Jasper 意识形态：一份报告 - 一个数据源。

在主报告中使用 2 个子报告。Main.jrxml 包含 subreport1（用于显示 List<ThemeBean>）和 subreport2（用于 List<AnotherBean>）。Subreport1 和 Subreport2 放入标题（或摘要）带。

在 Main.jrxml 中定义参数：themesPar, anotherPar as java.util.Collection

将集合作为参数放入主报告：

```
List<ThemeBean> themes = new ArrayList<ThemeBean>();
themes.add(...);
...
List<AnotherBean> blablas = new ArrayList<AnotherBean>();
blablas.add(...);
...

HashMap<String, Object> parameters = new HashMap<String, Object>();
parameters.put("themesPar", themes);
parameters.put("anotherPar", blablas);

JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport, parameters, new JREmptyDataSource()); 
```

对于主报告中的 subreport1 数据源表达式，如下所示

```
new JRBeanCollectionDataSource($P{themesPar}) 
```

并以与 $P{anotherPar} 相同的方式用于 subreport2。在这两种情况下都设置为子报表

```
Connection Type = "Use a datasource expression" 
```

为什么有新手问这个问题？？？:) 为什么这个解决方案没有出现在 jasperforge 常见问题解答中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-27T11:58:04.333

Jasper 意识形态：一份报告 - 一个数据源。

在主报告中使用 2 个子报告。Main.jrxml 包含 subreport1（用于显示列表）和 subreport2（用于列表）。Subreport1 和 Subreport2 放入标题（或摘要）带。

在 Main.jrxml 中定义参数：themesPar, anotherPar as java.util.Collection

# java - Contdown on Servlet 会话

> ID：15534669
> 
> 赞同：6
> 
> 时间：2013-03-20T21:03:21.607
> 
> 标签：java, jsp, session, servlets, session-timeout

我需要在 servlet 会话上创建倒计时以在 X 分钟到期时触发事件......

那么，有一种方法可以知道完成会话还剩多少秒？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T21:37:25.470

[您可以使用HttpSession](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSession.html) API计算剩余时间（以秒为单位） ：

```
httpSession.getMaxInactiveInterval() - ((System.currentTimeMillis() - httpSession.getLastAccessedTime())/1000 
```

# javascript - 用 JavaScript 替换部分 URL

> ID：15534673
> 
> 赞同：2
> 
> 时间：2013-03-20T21:03:41.003
> 
> 标签：javascript, regex, url

我想用 JavaScript 替换部分 URL，但愚蠢的正则表达式让我头疼。我想从这个切换：

```
http://website.com/test.html/post/something-else/ 
```

对此：

```
http://website.com/post/something-else/ 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T21:10:47.327

使用 replace() 函数

```
var url = 'http://website.com/test.html/post/something-else/'
url = url.replace('/test.html','')
console.log(url) // "http://website.com/post/something-else/" 
```

# php - javascript 转义/取消转义的 PHP 等效项

> ID：15534674
> 
> 赞同：10
> 
> 时间：2013-03-20T21:03:43.277
> 
> 标签：php, javascript, escaping

假设我有一个字符串：**something**

当我在 JS 中转义它时，我得到这个：**%73%6F%6D%65%74%68%69%6E%67**

所以我可以在JS中使用这段代码来解码它：

```
 document.write(unescape('%73%6F%6D%65%74%68%69%6E%67')); 
```

我需要 PHP 中的转义函数，它会做同样的**事情**（会将某些内容编码为：**%73%6F%6D%65%74%68%69%6E%67**）

怎么做 ？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-27T14:46:00.630

**PHP：**

```
rawurlencode("your funky string"); 
```

**JS：**

> decodeURIComponent('你的%20funky%20string');

不要使用`escape`，因为它已被弃用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-21T21:40:34.190

```
rawurldecode('%73%6F%6D%65%74%68%69%6E%67'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T22:00:27.297

首先澄清一下：

> 假设我有一个字符串：something
> 当我在 JS 中转义它时，我得到这个：%73%6F%6D%65%74%68%69%6E%67

**那是错误的**。（顺便说一句，JS`escape()`函数已被弃用。您应该`encodeURIComponent()`改用！）

> 所以我可以在JS中使用这段代码来解码它： document.write(unescape('%73%6F%6D%65%74%68%69%6E%67'));

是的，这将在文档中写入*“某些东西”*（因为`escape()`, 也`unescape()`已弃用；请`decodeURIComponent()`改用）。

* * *

对于你的问题：

> 我需要 PHP 中的 [snip] 函数，它 [snip]将*某些*内容编码为*%73%6F%6D%65%74%68%69%6E%67*

您正在寻找的是字符的十六进制表示。因此，要从字符串*"something"中获取字符串**"%73%6F%6D%65%74%68%69%6E%67"*，您需要：

 *```
<?php
function stringToHex($string) {
    $hexString = '';
    for ($i=0; $i < strlen($string); $i++) {
        $hexString .= '%' . bin2hex($string[$i]);
    }
    return $hexString;
}

$hexString = stringToHex('something');
echo strtoupper($hexString); // %73%6F%6D%65%74%68%69%6E%67 
```

向后：

```
function hexToString($hexString) {
    return pack("H*" , str_replace('%', '', $hexString));
}

$string = hexToString('%73%6F%6D%65%74%68%69%6E%67');
echo $string; // something 
```*

# c# - 动画闪烁效果 C#

> ID：15534675
> 
> 赞同：0
> 
> 时间：2013-03-20T21:03:48.033
> 
> 标签：c#, wpf, animation

我正在做一个我只想让屏幕闪烁的项目。

我以前从未编写过 C# 代码或使用过 Visual Studio，所以我不知道我在做什么。

我刚刚敲了一个我正在尝试做的快速 javascript 版本，你可以在这里看到它。

[http://jsfiddle.net/OwenMelbz/73Le7/](http://jsfiddle.net/OwenMelbz/73Le7/)

我附上了 VS 项目文件[http://www.mediafire.com/?6cji3czfsc6f5h3](http://www.mediafire.com/?6cji3czfsc6f5h3)

这是我目前在我的 xaml.cs 文件中得到的内容。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Timers;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication3
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private static System.Timers.Timer testTimer;

        public MainWindow()
        {
            InitializeComponent();
            testTimer = new System.Timers.Timer(5000); // 5 seconds
            testTimer.Elapsed += new ElapsedEventHandler(OnTimerElapsed);

            testTimer.Interval = 5000;
            testTimer.Enabled = true;

        }

        public void OnTimerElapsed(object source, ElapsedEventArgs e)
        {
            this.Dispatcher.Invoke((Action)(() =>
            {
                b1.Height = 420;
                b2.Height = 420;
            }));
            this.Dispatcher.Invoke((Action)(() =>
            {
                b1.Height = 0;
                b2.Height = 0;
                System.Threading.Thread.Sleep(100);
            }));
        }
    }
} 
```

这就是我在 MainWindow.xaml 中的内容

```
<Window x:Class="WpfApplication3.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="1440"
        Name="Winda" AllowsTransparency="True" WindowStyle="None"
        Opacity="1" Topmost="True" WindowStartupLocation="CenterScreen"
        WindowState="Maximized" IsHitTestVisible="False" ShowInTaskbar="False" Background="Transparent">
    <Grid>
        <Rectangle Fill="Black" HorizontalAlignment="Left" Height="0" Stroke="Black" VerticalAlignment="Top" Width="1440" Stretch="Fill" Name="b1"/>
        <Rectangle Fill="Black" HorizontalAlignment="Left" Height="0" Stroke="Black" VerticalAlignment="Bottom" Width="1440" Margin="0"  Stretch="Fill" Name="b2"/>

    </Grid>
</Window> 
```

从 JavaScript 演示中，我希望你能看到我正在尝试做的事情。所以任何帮助将不胜感激！

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:22:30.273

```
<Window x:Class="MiscSamples.BlinkingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ScreenBlink" Height="300" Width="300">
    <Window.Resources>
        <Storyboard x:Key="Storyboard" Duration="00:00:05.10" RepeatBehavior="Forever">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trans1" Storyboard.TargetProperty="ScaleY">
                <DiscreteDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
                <DiscreteDoubleKeyFrame KeyTime="00:00:04.99" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="00:00:05" Value="1"/>
                <EasingDoubleKeyFrame KeyTime="00:00:05.1" Value="0"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Trans2" Storyboard.TargetProperty="ScaleY">
                <DiscreteDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
                <DiscreteDoubleKeyFrame KeyTime="00:00:04.99" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="00:00:05" Value="1"/>
                <EasingDoubleKeyFrame KeyTime="00:00:05.1" Value="0"/>
            </DoubleAnimationUsingKeyFrames> 
        </Storyboard>
    </Window.Resources>
    <Window.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <EventTrigger.Actions>
                <BeginStoryboard Storyboard="{StaticResource Storyboard}"/>
            </EventTrigger.Actions>
        </EventTrigger>
    </Window.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <Rectangle Fill="Black">
            <Rectangle.RenderTransform>
                <ScaleTransform ScaleY="0" x:Name="Trans1"/>
            </Rectangle.RenderTransform>
        </Rectangle>
        <Rectangle Fill="Black" Grid.Row="1" RenderTransformOrigin="0.5,1.0">
            <Rectangle.RenderTransform>
                <ScaleTransform ScaleY="0" x:Name="Trans2"/>
            </Rectangle.RenderTransform>
        </Rectangle>
    </Grid>
</Window> 
```

代码背后：

```
using System.Windows;

namespace MiscSamples
{
    public partial class BlinkingWindow : Window
    {
        public BlinkingWindow()
        {
            InitializeComponent();
        }
    }
} 
```

# c# - c# 使用套接字进行单元测试

> ID：15534694
> 
> 赞同：7
> 
> 时间：2013-03-20T21:04:57.687
> 
> 标签：c#, unit-testing, sockets

我试图弄清楚如何为需要 C# 中的套接字的服务器应用程序编写单元测试。我需要从套接字读取以处理请求。在 Java 中，我可以通过使用 Streams 来避免使用套接字，因此在编写单元测试时，我可以轻松地将字符串转换为流。

```
// ====== Input ======
InputStream socketInputStream = new InputStream(socket.getInputStream()); 
// or using string instead like this
InputStream socketInputStream = new ByteArrayInputStream("string".getBytes());

BufferedReader in = new BufferedReader(new InputStreamReader(socketInputStream));

// ====== Output ======
OutputStream socketOutputStream = new OutputStream(socket.getOutputStream());
// I need to write byte[] to the stream
BufferedOutputStream out = new BufferedOutputStream(socketOutputStream); 
```

我只找到了 NetworkStream() 但它也需要一个套接字。

如何在 C# 中实现这一点，以便我可以创建没有套接字的流？以及如何写入 Stream 并再次阅读以查看消息是否正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:28:44.733

[nkvu - 根据发布者针对我的评论提出的问题，将其从评论中移出并进入答案；不想偷@Andrey 的风头]

所以在Java中你正在做：

```
InputStream socketInputStream = new ByteArrayInputStream("string".getBytes()); 
```

在您的单元测试中（我假设，基于您的原始问题）。

在 C# 中，你可以这样做：

```
Stream socketInputStream = new MemoryStream(Encoding.UTF8.GetBytes("string")); 
```

那将是（注意我有一段时间没有做过真实世界的 Java 了）一个 C#-ish 等价物。因为 MemoryStream 只是 Stream 的一个子类，[您](http://msdn.microsoft.com/en-us/library/system.io.stream.aspx)可以使用通用的 Stream 方法从中读取数据（例如 Read()）。

您还可以写入 MemoryStream，例如：

```
bytes[] toWrite = Encoding.UTF8.GetBytes("Write to stream");
Stream writeToStream = new MemoryStream();
writeToStream.Write(toWrite, 0, toWrite.Length); 
```

HTH，弥敦道

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:10:33.563

您可以在 C#中使用[MemoryStream 。](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)

# php - PHP 显示/隐藏链接

> ID：15534696
> 
> 赞同：0
> 
> 时间：2013-03-20T21:05:15.377
> 
> 标签：php, mysql

我有一个从我的数据库中打印出文章的功能，以及三个链接 Edit 、 Add 、 Show/hide。在显示/隐藏链接中，我希望能够隐藏/显示该特定文章。我怎样才能做到这一点？编辑：我需要能够在我的后端页面中隐藏/显示文章，并且它需要在前端页面中保持隐藏状态

```
function displaynews()
{
    $data = mysql_query("SELECT * FROM news")  // query
    or die(mysql_error());   
    while ($info = mysql_fetch_array($data)) 
    {
        $id = $info['id']; 
        echo "<br>
              <a href=Edit.php?id=$id>Edit</a></a>
              <a href='addnews.php'> Add </a>
              <a href='#'>Show/Hide</a><br><strong>" .
              $info['date'] .
              "</strong><br>" . 
              $info['news_content'] . 
              "<hr><br>"; // Print Articles and Date
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:08:15.683

您可以使用一些 Javascript 并将样式属性设置为 display:none 以隐藏，然后 display:block 再次显示它。或者使用 jQuery。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:08:24.357

使用 jQuery。

```
<head>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
</head>

<a href='#' onclick="$('#whatever').toggle();return false;">show/hide</a>
<div id="whatever">
  Content
</div>
<script>
 //Try these too
$('#whatever').hide();
$('#whatever').show();
$('#whatever').toggle();
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:14:21.740

使用以下代码：

**PHP代码：**

```
function displaynews()
{
    $data = mysql_query("SELECT * FROM news")  // query
    or die(mysql_error());   
    while ($info = mysql_fetch_array($data)) 
    {
        $id = $info['id']; 
        echo "<div class="news"><br><a href=Edit.php?id=$id>Edit</a></a><a href='addnews.php'> Add </a><a href=hide.php>Show/Hide</a><br><strong>". $info['date']."</strong><br>". $info['news_content'] . "<hr><br></div>"; // Print Articles and Date
    }
} 
```

**Javascript/jQuery 代码**（不要忘记在您的页面中添加 jQuery）

```
<script type="text/javascript">
$(document).ready(function(){
 $(".news").click(function(){
  $(this).toggle();
});
});
</script> 
```

# java - 代理身份验证失败错误

> ID：15534701
> 
> 赞同：1
> 
> 时间：2013-03-20T21:05:56.923
> 
> 标签：java, authentication, ftp

我正在尝试通过 FTP SITE 代理访问 FTP 服务器以绕过防火墙，`it.sauronsoftware.ftp4j.FTPClient`因为我知道我的用户名/密码是正确的，因为我可以使用 FileZilla 进行连接。我尝试使用`Authenticator`，但它没有用。代码：

```
import java.net.Authenticator;
import it.sauronsoftware.ftp4j.FTPClient;
import it.sauronsoftware.ftp4j.connectors.FTPProxyConnector;
...
    FTPClient client = new FTPClient();
        FTPProxyConnector connector = new FTPProxyConnector(String "proxyHost", int proxyPort);
        client.setConnector(connector);

        Authenticator.setDefault(new Authenticator() {
        @Override
             public PasswordAuthentication getPasswordAuthentication() {
                       return new PasswordAuthentication("proxyUser", "proxyPass".toCharArray());
         }});

        System.setProperty("ftp.proxyHost", "proxyHost");
        System.setProperty("ftp.proxyPort", "proxyPort");
        System.setProperty("ftp.proxyUser", "proxyUser");
        System.setProperty("ftp.proxyPass", "proxyPass");

        System.out.println("Proxy Accessed");

        client.connect("ftpHost");
        client.login("ftpUser", "ftpPass"); 
```

给我这个错误：`java.io.IOException: Proxy authentication failed`

我尝试过的事情：

*   使用备用构造函数`(String, int, String, String)`。
*   移除`Authenticator`
*   使用 just `Authenticator`，不使用 FTPProxyConnector
*   在设置连接器之前进行身份验证，反之亦然。

但是，当我只是使用 Authenticator 时，我得到一个不同的错误说`Connection timed out`。

两个错误都在线发生`client.connect("ftpHost");`

**任何**帮助将不胜感激。

注意：[FTP 代理连接器](http://www.sauronsoftware.it/projects/ftp4j/api/it/sauronsoftware/ftp4j/connectors/FTPProxyConnector.html)

编辑：我发现代理用于绕过 Firewall-1 检查点——如果这有帮助的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:03:35.393

检查密码属性名称。它的名称是 ftp.proxyPassword，而不是 ftp.proxyPass。

```
System.setProperty("ftp.proxyUser", "proxyUser");
System.setProperty("ftp.proxyPassword", "proxyPass"); 
```

试试看，让我们知道你的结果！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T18:04:13.083

检查密码属性名称。它的名称是 ftp.proxyPassword，而不是 ftp.proxyPass。

```
System.setProperty("ftp.proxyUser", "proxyUser");
System.setProperty("ftp.proxyPassword", "proxyPass"); 
```

试试看，让我们知道你的结果！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T18:57:17.383

我找到了解决方案...

我发现 FTP 客户端使用不同的响应代码进行响应：

`200-User <username> authenticated by FireWall-1 authentication`

在 的源代码中`FTPProxyConnector`，除常规之外的任何响应代码

`230-Connected to server. Logging in...`

会抛出错误。

我必须反编译类文件`FTPProxyConnector`，然后修改源代码，然后重新编译并将其保存回 jar。像魅力一样工作。

# asp.net - 表单操作错误

> ID：15534706
> 
> 赞同：0
> 
> 时间：2013-03-20T21:06:14.627
> 
> 标签：asp.net, forms, webforms, action, nullreferenceexception

我有以下 C# 代码：

```
 AddCommentForm = string.Format("<form name=\"AddComment\" method=\"post\"  runat=\"server\" id=\"add_comment_form\"><p> TITLE:  <input type =\"text\" name=\"Title\" /></p><p> Contnt <textarea name=\"Content\" ></textarea></p><p> <button type=\"submit\">Submit!</button></p></form>");
                this.Form.Action = "ViewArticle.aspx?ArticleID=" + ArticleID; 
```

问题是第二行有错误：

```
System.NullReferenceException was caught 
```

我的问题是我怎么会出现这个错误？

为什么使用这段代码可以工作？

```
 <%
     this.Form.Action = "ViewArticle.aspx?ArticleID=" + ArticleID.ToString();
 %>
 <form name="AddComment"  method="post" runat="server"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:33:21.170

```
AddCommentForm = string.Format("<form name=\"AddComment\" method=\"post\" .... 
```

以上代码无效。AddCommentForm 是一个 HtmlForm 控件 - 不是字符串。此外，您不能`form`在 ASP.Net 中的表单内创建另一个标签。

```
this.Form.Action = "ViewArticle.aspx?ArticleID=" + ArticleID.ToString(); 
```

基本上，你是[跨站脚本](http://msdn.microsoft.com/en-us/library/ff649310.aspx)。虽然它编译，但它不会工作。当你进入`ViewArticle.aspx`页面时，你会得到一个错误。

**如果您想在 ASP.Net 中使用表单，请使用 iframe。**

# ios - 使用 ARC 释放 NSObject

> ID：15534708
> 
> 赞同：1
> 
> 时间：2013-03-20T21:06:16.273
> 
> 标签：ios, automatic-ref-counting, nsobject, dealloc

我有多个视图控制器，它们强烈引用 NSObject 的子类。每个视图控制器都允许用户以某种方式改变这个对象，然后将该对象传递给下一个视图控制器。完成后，用户可以提交这些更改并使用 NSObject 子类的新实例重新开始该过程。我遇到的问题是堆栈上的一些视图控制器保留了对提交实例的引用。

我尝试过使用弱和 unsafe_unretained ，但这使得在视图控制器之间传递对象变得困难。

一旦提交，我基本上需要释放对象的一个​​实例，这样任何视图控制器对它的引用都将为零。但是，ARC 不允许显式调用 dealloc。

我可以使用 NSNotificationCenter 或使用委托来解决这个问题，但是有没有更清洁的方法呢？

任何见解将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:14:01.177

`retain`在每个视图控制器处理对象时让它们成为对象是合理的。

当视图控制器 A 处理对象时，它会保留它。当它完成并将其传递给 B 时，B 保留它，然后 A 将自己对它的引用设置为 nil 以放弃对它的所有权。这个过程一直持续到最终的视图控制器提交对象，然后将它自己的引用设置为 nil，这应该会导致对象被释放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:13:46.307

模型对象（每个人都会改变的对象）应该归一个中央“模型”类所有。你可以把它传过去。它可以具有诸如`currentRecord`或类似的方法。这样，你所有的视图控制器要么对当前记录有一个弱引用，要么他们可以在每次需要时向模型询问它。视图控制器不应该“拥有”数据对象。

这意味着视图控制器可以使用 KVO 来观察何时`currentRecord`发生变化。它交替地为您提供一个可以在事情发生变化时提供通知的对象。您的模型对象还可以潜在地处理网络或磁盘访问（或者，您可以拥有一个单独的控制器，该控制器也利用模型并提供网络或磁盘访问）。这里的关键是 MVC。您想将模型类与视图和控制器类分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:11:24.030

一旦提交，您只需将对象设置为`nil`. ARC 会自动释放它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:11:57.777

您可以在视图控制器中覆盖 dealloc 方法并将对象设置为 nil 。因此，当您的视图控制器的实例超出范围时，会调用 dealloc 并且对象将设置为 nil。不要调用 [super dealloc] 。

# c++ - rpc 服务器 C++ Linux 服务器和 Windows 客户端

> ID：15534710
> 
> 赞同：-2
> 
> 时间：2013-03-20T21:06:17.343
> 
> 标签：c++, linux, windows, rpc, protocol-buffers

是否有一个在 Linux 上运行并具有 Windows 客户端的 RPC 服务器的良好实现。它应该对消息使用 protocolbuf。所有代码都是 C++。

我能找到的唯一示例都在 Linux 上编译得很好，但在 Windows 上就没有这么幸运了！

我检查了所有这些[https://code.google.com/p/protobuf/wiki/ThirdPartyAddOns](https://code.google.com/p/protobuf/wiki/ThirdPartyAddOns)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:17:32.403

[Mongrel2](http://mongrel2.org/)和[ZeroMQ](http://www.zeromq.org/)怎么样？

事实上，你可以用你想要的任何语言编写处理程序。

# bash - 如何使用打印命令获得更清晰的文件信息？

> ID：15534712
> 
> 赞同：1
> 
> 时间：2013-03-20T21:06:24.603
> 
> 标签：bash, unix

我有这个命令来转储所有的 java 和 xml 文件：

```
find . -name '*.*' -print -ls 
```

我得到以下输出：

```
./auth-jaas/pom.xml
562949954141667    2 ----------   1 John ????????     1282 Feb 14  2011 ./auth-jaas/pom.xml 
```

有没有办法像这样得到更小的东西：

```
1282 Feb 14  2011 ./auth-jaas/pom.xml 
```

我只对文件大小和时间戳感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:15:38.307

我认为您所追求的是：

```
find . -name '*.*' -exec stat -f "%10z %Sm %N" {} + 
```

我在我的一个目录中将其作为输出的一部分：

```
 534 Mar  2 20:17:16 2013 ./so.6964747
   835 Mar  2 20:17:16 2013 ./so.6965001
 25048 Jun 25 21:29:46 2012 ./so.8854855.sql
  7710 Feb 13 07:17:01 2013 ./sortAtt.c
  1565 Sep  4 19:15:30 2010 ./strandsort.c
  7224 Sep 22 13:42:17 2012 ./streplace.c
  3033 Jan 28 23:16:46 2013 ./substr.c
   139 Mar 20 12:48:24 2013 ./sum.sh
  6833 Sep 21 07:57:53 2012 ./timezeromoves.c
   614 Feb 21 09:23:00 2013 ./travAsm.c
   347 Feb 21 09:23:00 2013 ./traverse.c
  1277 Jul 26 09:30:12 2012 ./uint128.c
   793 Aug 19 00:47:48 2012 ./unwrap.c
  1906 Jul 28 08:41:22 2012 ./xxx.sql
  1904 Sep 22 21:30:09 2011 ./yyy.sql 
```

阅读选项可能会告诉您如何从“修改时间的字符串格式”（`%Sm`）中删除时间。

只是为了记录，这是`/usr/bin/stat`在 Mac OS X 10.7.5 上使用的，而不是 GNU [`stat`](http://linux.die.net/man/1/stat)。您将需要仔细检查那里可用的内容。

```
find . -name '*.*' -exec /usr/gnu/bin/stat --format "%s   %y   %N" 
```

输出的相同部分是：

```
534   2013-03-02 20:17:16.000000000 -0800   ./so.6964747
835   2013-03-02 20:17:16.000000000 -0800   ./so.6965001
25048   2012-06-25 21:29:46.000000000 -0700   ./so.8854855.sql
7710   2013-02-13 07:17:01.000000000 -0800   ./sortAtt.c
1565   2010-09-04 19:15:30.000000000 -0700   ./strandsort.c
7224   2012-09-22 13:42:17.000000000 -0700   ./streplace.c
3033   2013-01-28 23:16:46.000000000 -0800   ./substr.c
139   2013-03-20 12:48:24.000000000 -0700   ./sum.sh
6833   2012-09-21 07:57:53.000000000 -0700   ./timezeromoves.c
614   2013-02-21 09:23:00.000000000 -0800   ./travAsm.c
347   2013-02-21 09:23:00.000000000 -0800   ./traverse.c
1277   2012-07-26 09:30:12.000000000 -0700   ./uint128.c
793   2012-08-19 00:47:48.000000000 -0700   ./unwrap.c
1906   2012-07-28 08:41:22.000000000 -0700   ./xxx.sql
1904   2011-09-22 21:30:09.000000000 -0700   ./yyy.sql 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:12:41.987

如果您的命令中有 Linux 风格`-printf`，请`find`使用`%a`访问时间、`%t`修改时间（以及用于更具体格式的大写变体）和`%s`文件大小（以字节为单位）。

`-ls`或者，将输出从through管道化`cut`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:13:04.807

改用`du`：

```
$ du --time file
4   2013-03-20 19:49    file 
```

与`find`：

```
$ find . -name 'file' -exec du --time {} + 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:22:18.293

通常我会说剪切，但不知道它们是制表符还是空格分隔符：

```
find . -name '*.*' -print -ls |awk '{$0=substr($0,index($0,FS)+4);printf $0}' 
```

# ruby-on-rails - 如果存在就更新，否则什么都不做？

> ID：15534713
> 
> 赞同：5
> 
> 时间：2013-03-20T21:06:25.317
> 
> 标签：ruby-on-rails, ruby

当且仅当模型存在时，我才尝试更新模型的值。如果没有，我什么也不做。搜索似乎只返回更新或创建问题/答案，但我不想创建。

我知道我可以用一个简单的方法做到这一点：

```
found = Model.find_by_id(id)
if found
  update stuff
end 
```

但是，我觉得有一种方法可以在一次调用中执行此操作，而无需分配任何临时本地值或执行 if。

如果它不存在，我将如何编写一个 rails 调用来更新没有嘈杂错误的记录？

最新的 Rails 3.x

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T09:10:43.403

在or的结果上调用 update_attributes 之前，您可以使用Rails 的[try](http://api.rubyonrails.org/classes/Object.html#method-i-try)方法。`find_by_id``where`

`try``nil`如果记录不存在，将静默返回而不引发异常。如果记录存在，它将更新它。

```
found = Model.find_by_id(id).try(:update_attributes, {key: value}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:16:18.357

您可以将 first_or_initialize 与 new_record 结合使用吗？如下：

```
client = Client.where(first_name: 'Nick').first_or_initialize(locked: false)
client.save unless client.new_record? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:09:36.807

假设您的模型称为“事件”并且您按 id 搜索，您可以执行以下操作：

```
e = Event.where(:id => id)
if !e.empty?
  e.first.value = new_value
  e.first.save!
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-19T01:09:35.030

在 Rails 4 中，这可能是我找到的最简单的解决方案：

```
# POST /users
# POST /users.json
def create
  @user = User.find_or_initialize_by(fbid: user_params[:fbid])
  @user.assign_attributes(user_params)
  respond_to do |format|
    if @user.save
      format.html { redirect_to @user, notice: 'User was successfully created.' }
      format.json { render action: 'show', status: :created, location: @user }
    else
      format.html { render action: 'new' }
      format.json { render json: @user.errors, status: :unprocessable_entity }
    end
  end
end 
```

如果存在 FBID 的用户，则更新记录；否则，将创建一个新的。您可以更新记录以匹配您想要保持唯一的任何列。可能索引该列将有助于搜索和检索等。

希望这可以帮助！

# multithreading - 调用 Windows 窗体线程并休眠

> ID：15534716
> 
> 赞同：0
> 
> 时间：2013-03-20T21:06:42.467
> 
> 标签：multithreading, managed-c++, invokerequired

我有一个托管的 c++ 应用程序，我启动一个新线程来做一些事情并更新一些文本框，它循环并在每个循环结束时休眠。因为它在睡觉，所以我需要将它放在一个新线程中，这样 UI 就不会崩溃。然后我意识到我需要调用创建 UI 的线程来访问文本框，但现在我回到了主线程中，所以睡眠崩溃了。我应该如何处理这个问题。

```
private: System::Void buttonStartCamera_Click(System::Object^  sender, System::EventArgs^  e) 
         {
             ThreadStart^ threadStart = gcnew ThreadStart(this, &UserInterface::SetText);
             Thread^ newThread = gcnew Thread(threadStart);
             newThread->Start();
         }

    void SetText()
    {
        if (this->textBoxCameraOneX->InvokeRequired)
        {
            MyDel^ del = gcnew MyDel(this, &UserInterface::SetText);
            this->Invoke(del);
        }
        else 
        {
            int count  = 0;
            srand (time(NULL));

            for (count = 0; count < 20; ++count)
            {
                for each (Camera^ camera in cameraList)
                {
                    textBoxCameraOneX->Text = count.ToString();

                }

                Sleep(300);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:15:19.177

最好的选择可能是重构这个，这样你的睡眠就不会出现在`SetText`方法中。您的后台线程可以使用一种单独的方法来执行睡眠，然后调用适当的方法在循环中设置文本（一次一个文本框）。

一般来说，您应该`Control::Invoke`尽可能缩短使用的方法——它们应该只包含您的 UI 工作所需的逻辑，而不是其他功能。

话虽如此，在这种情况下，似乎 a`System::Windows::Forms::Timer`会更合适。您可以将时间间隔设置为，并在计时器事件`300`中一次更新一个文本框。`Tick`

# javascript - jQuery脚本没有正确引用

> ID：15534719
> 
> 赞同：0
> 
> 时间：2013-03-20T21:07:01.803
> 
> 标签：javascript, jquery, html, css

我不知道为什么，但我的脚本不能正常工作，因为它以前工作正常。现在，它不再工作了，我不知道为什么，因为我不记得对脚本标签进行了任何更改。

```
<body>
<form id="contact">
    <fieldset id="contactInformation">
        <legend>Contact Information</legend>
        <p id="error"></p>
        <label for="name">Name:</label>
        <br>
        <input id="name" type="text">
        <br>
        <br>
        <label for="phoneNumber">Phone Number:</label>
        <br>
        <input id="phoneNumber" type="text">
        <br>
        <br>
        <label id="eMail">E-Mail Address:</label>
        <br>
        <input type="text">
        <br>
        <br>
        <label id="address">Address:</label>
        <br>
        <input type="text">
        <br>
        <br>
        <label id="city">City:</label>
        <br>
        <input type="text">
        <br>
        <br>
        <label id="postalCode">Postal Code:</label>
        <br>
        <input type="text">
        <br>
        <br>
        <label id="province">Province</label>
        <br>
        <select id="province">
            <option>Choose Your Province</option>
            <option>Alberta</option>
            <option>British Columbia</option>
            <option>Manitoba</option>
            <option>New Brunswick</option>
            <option>Newfoundland and Labrador</option>
            <option>Northwest Territories</option>
            <option>Nova Scotia</option>
            <option>Nunavut</option>
            <option>Ontario</option>
            <option>Prince Edward Island</option>
            <option>Quebec</option>
            <option>Saskatchewan</option>
            <option>Yukon Territory</option>
        </select>
        <br>
        <br>
        <div id="shipping">
            <label id="shippingCheckbox">Is your shipping information the same as your contact information?</label>
            <br>
            <br>
            <input type="checkbox" id="sameInfo">
            <label>Yes it is</label>
            <br>
            <br>
        </div>
        <fieldset id="shippinginformation">
            <legend>Shipping Information</legend>
            <label for="phoneNumber">Phone Number:</label>
            <br>
            <input id="phoneNumber" type="text">
            <br>
            <br>
            <label id="address">Address:</label>
            <br>
            <input type="text">
            <br>
            <br>
            <label id="postalCode">Postal Code:</label>
            <br>
            <input type="text">
            <br>
            <br>
        </fieldset>
        <br>
        <input type="submit" id="submit" name="submit" value="Submit">
</form>
<br>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script src="js/script.js"></script>
</body>
</html>

//script.js
var errorNotify = 'Sorry, we could not process your request because '
var errorField = [];

function formVal() {
    var isValid = true;

    for (var i = 0; i < errorField.length; i++ ) {
        $(errorField[i]).removeClass('error');
    }
    errorField = [];

    if(!nameCheck()) {
        isValid = false;
    }
    if(!phoneCheck()) {
        isValid = false;
    }
    if (isValid === false) {
        $('#error').html(errorNotify).hide().slideDown('slow');
        for (var i = 0; i < errorField.length; i++) {
            $(errorField[i]).addClass('error');
        }
        errorNotify = 'Sorry, we could not process your request because ';
    }

    function nameCheck(){
        if ($('#name').val() === '') {
            errorNotify += ' you did not enter your name.';
            errorField.push($('#name'));
            return false;
        } else {
            return true;
        }
    }
    function phoneCheck(){
        var phoneCheck = $('#phoneNumber').val();
        if (phoneCheck === '') {
            errorNotify += ' you did not enter your phone number.';
            errorField.push($('#phoneNumber'));
            return false;
        } else if (phoneCheck.length !== 10) {
            errorNotify += 'please enter a 10 digit phone number';
            errorField.push($('#phoneNumber'));
        }
        else if (isNaN(parseInt(phoneCheck))) {
            errorNotify += 'you have entered a letter, please enter a number';
            errorField.push($('#phoneNumber'));
        }
        else {
            return true;
        }
    }
    return isValid;
}

$(function () {

    $('#contact').submit(function() {
        return formVal();
    });

    $('#sameInfo').change(function() {
        if ($(this).is(":checked")) {
            alert('this is a test');
        } else {
            alert('this is not a test');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:33:03.450

并不是说它应该因此而完全失败，但是您的 else if 在 phoneCheck() 函数中缺少返回值。

除此之外，它看起来还不错。

# javascript - 如何更改带有文本的html div元素的大小

> ID：15534728
> 
> 赞同：0
> 
> 时间：2013-03-20T21:07:32.987
> 
> 标签：javascript, html

我的页面上有一个 DIV 元素，里面有一些文本，它小于 DIV 元素的大小。

我还有一个 javascript 函数，它使用 setTimeout 为元素的宽度属性的变化设置动画。

但是，当宽度变得小于其中文本的宽度时，文本会换行，依此类推。我尝试使用 white-space:nowrap 使文本保持在同一行，但是当元素的宽度变得小于文本宽度时，文本保持在它之外。

如何使文本保持在同一行并沿 div 容器隐藏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:14:00.273

将 (overflow:hidden) 添加到 div 元素。（[演示](http://cssdesk.com/haef2)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:10:47.733

您想再添加一点 CSS ( [demo](http://cssdesk.com/haef2) )：

```
overflow:hidden; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:11:16.073

尝试

空白：预包装

# ruby-on-rails - Nokogiri：使用字段名称中的“？”从字符串创建 xml

> ID：15534730
> 
> 赞同：0
> 
> 时间：2013-03-20T21:07:34.423
> 
> 标签：ruby-on-rails, ruby, nokogiri

控制器响应包括“规范？” 场地：

```
r = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<hash type=\"array\">\n  <item><spec? type=\"boolean\">false</spec?>\n </item>\n  <hash>\n" 
```

当尝试使用`Nokogiri.xml(r)`接收字面从它创建 xml 时：

```
<?xml version="1.0" encoding="UTF-8"?>
<hash type="array">
  <item><spec type=" type=&quot;boolean&quot;&gt;false/spec">
 </spec>item&gt;
  <hash>
</hash></item></hash> 
```

这很奇怪；

我的问题是：是否可以`?`在阶段使用 Nokogiri、解析或删除以及其他非 xml 标准字符从字符串创建 xml `Nokogiri.XML()`？

理想的结果：

```
Nokogiri.xml(r) do |config|
 config.maybe_some_configs?
end #=>
    <?xml version="1.0" encoding="UTF-8"?>
    <hash type="array">
      <item><spec type="boolean">false</spec></item>       
    </hash> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:16:58.667

将字符串解析为 XML DOM 的正确方法是`Nokogiri::XML`or`Nokogiri.XML`或`Nokogiri::XML.parse`，但不使用`xml`.

此外，XML 标记不能包含`?`. 有关更多信息，请参阅[规范](http://www.w3.org/TR/2008/REC-xml-20081126/#NT-Name)。您必须深入研究“名称和令牌”部分并解码十六进制字符描述以找出允许的字符范围，但提示`?`是字符代码`0x3f`。

这导致 XML in`r`无效的事实：

```
<?xml version="1.0" encoding="UTF-8"?>
<hash type="array">
  <item><spec? type="boolean">false</spec?>
 </item>
  <hash> 
```

其中，解析时会导致：

```
irb(main):012:0> doc = Nokogiri::XML(r)
#<Nokogiri::XML::Document:0x80c8014c name="document" children=[#<Nokogiri::XML::Element:0x80c7399c name="hash" attributes=[#<Nokogiri::XML::Attr:0x80c733e8 name="type" value="array">] children=[#<Nokogiri::XML::Text:0x80c6e26c "\n  ">, #<Nokogiri::XML::Element:0x80c6df60 name="item" children=[#<Nokogiri::XML::Element:0x80c6d970 name="spec">, #<Nokogiri::XML::Text:0x80c6d09c "? type=\"boolean\">false">]>, #<Nokogiri::XML::Text:0x80c6ca34 "?>\n ">]>]>
irb(main):013:0> doc.errors
[
    [0] #<Nokogiri::XML::SyntaxError: error parsing attribute name>,
    [1] #<Nokogiri::XML::SyntaxError: attributes construct error>,
    [2] #<Nokogiri::XML::SyntaxError: Couldn't find end of Start Tag spec line 3>,
    [3] #<Nokogiri::XML::SyntaxError: expected '>'>,
    [4] #<Nokogiri::XML::SyntaxError: Opening and ending tag mismatch: item line 3 and spec>,
    [5] #<Nokogiri::XML::SyntaxError: Opening and ending tag mismatch: hash line 2 and item>,
    [6] #<Nokogiri::XML::SyntaxError: Extra content at the end of the document>
] 
```

结果，Nokogiri 不得不在 DOM 中进行一些修复以尝试理解它。生成的 XML 如下所示：

```
irb(main):014:0> puts doc.to_xml
<?xml version="1.0" encoding="UTF-8"?>
<hash type="array">
  <item><spec/>? type="boolean"&gt;false</item>?&gt;
 </hash> 
```

修复它的方法是为 Nokogiri 提供*有效*的XML。修复 XML 的源（如果您对其进行控制），或者在将字符串传递给 Nokogiri 之前修复字符串中的问题。

根据其定义，XML 是一种严格的格式，Nokogiri 尊重这一点，并且为了友好，您可以检查`errors`它是否`empty?`. 如果不是，那么在确定问题并修复导致解析问题的任何原因之前，您不应该继续使用源代码。有时问题是相当良性的，您可以忽略它，但无论哪种情况，您至少应该意识到它。

在 Nokogiri 发现之前预先按摩数据并不难：

```
doc = Nokogiri::XML(r.gsub('spec?', 'spec'))

irb(main):024:0> puts doc.to_xml
<?xml version="1.0" encoding="UTF-8"?>
<hash type="array">
  <item><spec type="boolean">false</spec>
 </item>
  <hash>
</hash></hash>
nil
irb(main):025:0> doc.errors
[
    [0] #<Nokogiri::XML::SyntaxError: Premature end of data in tag hash line 5>,
    [1] #<Nokogiri::XML::SyntaxError: Premature end of data in tag hash line 2>
] 
```

这是一个开始，但不是试图为您完全修复它。我教你钓鱼，而不是分发鱼。

# javascript - 从 CSV 基本示例读取 HighCharts

> ID：15534735
> 
> 赞同：1
> 
> 时间：2013-03-20T21:07:49.120
> 
> 标签：javascript, jquery, highcharts

我是 highcharts 和 JS 的新手，我正在尝试从 csv 文件（data3.csv）中绘制数据。

这是目前的代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Highcharts Example</title>

        <!-- 1\. Add these JavaScript inclusions in the head of your page -->
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <script type="text/javascript" src="highcharts.js"></script>
        <!--[if IE]>
            <script type="text/javascript" src="../js/excanvas.compiled.js"></script>
        <![endif]-->

        <!-- 2\. Add the JavaScript to initialize the chart on document ready -->
        <script type="text/javascript">
        $(document).ready(function() {

            var options = {
                chart: {
                    renderTo: 'container',
                    defaultSeriesType: 'line'
                },
                title: {
                    text: 'Stock Chart'
                },
                xAxis: {
                    categories: []
                },
                yAxis: {
                    title: {
                        text: 'Price'
                    }
                },
                series: []
            };

            $.get('data3.csv', function(data) {

                $.each(lines, function(lineNo, line) {
                var items = line.split(',');

                var series = {
                    data: []
                };

                $.each(items, function(itemNo, item) {
                    if (itemNo == 0) {
                        series.name = item;
                    } else {
                        series.data.push(parseFloat(item));
                    }
                });

                options.series.push(series);

                });

                var chart = new Highcharts.Chart(options);
            });
        });

        </script>

    </head>
    <body>

        <!-- 3\. Add the container -->
        <div id="container" style="width: 800px; height: 400px; margin: 0 auto"></div>

    </body>
</html> 
```

csv文件的内容是：

```
Date    Open
29/01/2010  538.49
28/01/2010  544.49
27/01/2010  541.27
26/01/2010  537.97
25/01/2010  546.59 
```

但是，这不是给出图表（只是给出标题）。

谁能建议我哪里出错了？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:46:52.263

排队

```
var items = line.split(','); 
```

您应该用逗号对 csv 进行样条分割，但您有空间。因此，您可以将此行替换为：

```
var items = line.split(' '); 
```

或生成 csv 哪些项目将用逗号分隔。

因此，您的解析器应如下所示：

```
$.get('data.csv', function(data) {
    // Split the lines
    var lines = data.split('\n');
    // Iterate over the lines and add categories or series
    $.each(lines, function(lineNo, line) {
        var items = line.split(',');
        if(lineNo>0)
        {
            options.xAxis.categories.push(items[0]); //set first column from CSV as categorie
            options.series[0].data.push(parseFloat(items[1])); //set second column from CSV as point value
        }

    });

    // Create the chart
    var chart = new Highcharts.Chart(options);
}); 
```

# paypal - PayPalAPIInterfaceServiceService::SetExpressCheckout() 返回空响应对象

> ID：15534737
> 
> 赞同：0
> 
> 时间：2013-03-20T21:07:50.027
> 
> 标签：paypal, paypal-sandbox

我正在使用 Yii 构建一个需要通过 PayPal 付款的应用程序。经过大量挖掘，我发现ExpressCheckout是使用的方法。下面的代码使用 PHP SDK 的 1.2.95 版本在一段时间前运行良好（一些（？）几周前，我想在 PayPal 推出他们的新开发者平台之前）。现在，使用最新版本 v.2.2.98，代码失败。

```
require_once(Yii::getPathOfAlias('application.libraries.paypal') . '/PPBootStrap.php');
$logger = new PPLoggingManager('SetExpressCheckout');

$PaymentDetails = new PaymentDetailsType();
$PaymentDetails->OrderTotal =  $PaymentDetails->ItemTotal =
  new BasicAmountType('USD', $subscription->price);
$PaymentDetails->PaymentAction = "Sale";
$PaymentDetails->OrderDescription = $subscription->description;

$setECReqDetails = new SetExpressCheckoutRequestDetailsType();
$setECReqDetails->PaymentDetails[0] = $PaymentDetails;
$setECReqDetails->CancelURL = 'someCancelUrl';
$setECReqDetails->ReturnURL = 'someReturnUrl';

$setECReqType = new SetExpressCheckoutRequestType();
$setECReqType->SetExpressCheckoutRequestDetails = $setECReqDetails;

$setECReq = new SetExpressCheckoutReq();
$setECReq->SetExpressCheckoutRequest = $setECReqType;

$paypalService = new PayPalAPIInterfaceServiceService();

$ok = TRUE;
try {
  $setECResponse = $paypalService->SetExpressCheckout($setECReq);
  if($setECResponse && strtoupper($setECResponse->Ack) =='SUCCESS') {
    $token = $setECResponse->Token;
    // Redirect to paypal.com here
    $this->redirect(
      'https://www.sandbox.paypal.com/webscr?cmd=_express-checkout&token=' . $token);
  }
}
catch (Exception $ex) {
  Yii::trace(__METHOD__ . ': Exception while interacting with PayPal API, error: '
    . $ex->getMessage());
  $ok = FALSE;
} 
```

违规行是：

```
$setECResponse = $paypalService->SetExpressCheckout($setECReq); 
```

在 PayPalAPIInterfaceServiceService::SetExpressCheckout() 中，这两行：

```
$resp = $this->call('PayPalAPIAA', 'SetExpressCheckout', $setExpressCheckoutReq, $apiCredential);
$ret->init(PPUtils::xmlToArray($resp)); 
```

是问题。`$resp`为空，因此下一行在`PPUtils::xmlToArray($resp)`方法调用时失败。

显然，要么我在这里遗漏了一些东西，要么 PayPal 做错了什么。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:07:45.313

经过大量调试，问题的原因是`service.EndPoint.PayPalAPI`参数没有在`sdk_config.ini`. 由于某种我不记得的原因，此参数已从以前版本的工作配置文件中删除。

现在，即使使用最新的 2.3.100 版本的 API，快速结帐方法也可以正常工作。

# asp.net - 查找或将 clientID 分配给 HyperLinkColumn？

> ID：15534738
> 
> 赞同：0
> 
> 时间：2013-03-20T21:07:50.563
> 
> 标签：asp.net, datagrid

我们正在使用具有 HyperlinkColumn 以及其他 BoundColumns 的 ASP.Net DataGrid 类。

当 DataGrid 在屏幕上呈现时，它有一个 ID 值（在 aspx 页面上的控件中分配），但内部结果和值没有与之关联的 ID。

是否可以为从 DataGrid 产生的结果表条目分配或获取 id？我们研究了向 HyperLinkColumn 添加一个“ID”值，但显然它在 ASP.Net 中不存在。（如果这意味着什么，我们正在使用 .Net 4.0。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:44:35.340

您可以尝试用 asp 对象替换（在行数据绑定事件中）所有“内部元素”，对于行中的每个单元格。例如，在内部添加一个 asp:label（带有静态/或动态 id）具有与每个单元格的值相同的文本（内容）。

# java - Jtable 和 MySql

> ID：15534741
> 
> 赞同：0
> 
> 时间：2013-03-20T21:08:05.297
> 
> 标签：java, mysql, swing, jtable, resultset

当我尝试执行以下编码时，我遇到了错误。我无法理解这个 netbeans 错误。错误如下。

```
Mar 21, 2013 2:28:19 AM timetable.generator.JFTTGenerator6 jButton2ActionPerformed
SEVERE: null
java.sql.SQLException: Before start of result set
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1073) 
```

请帮我 ！！！！

```
String subj=(String) jTable1.getValueAt(0,1 );
Connection con = Driver.connect();
ResultSet lec1=Handler.getData(con,
"select lec_id from lecdetails,subjects where subjects.sub_code=lecdetails.sub_code 
 and subjects.sub_name='"+subj+"'");
ResultSet rst1= Handler.getData(con, "select sub_name from subjects,lecdetails 
where subjects.sub_code=lecdetails.sub_code and subjects.sem='2nd' and 
lecdetails.lec_id  <> '"+lec1.getString(1) +"' order by rand() limit 1 ");
jTable2.setValueAt(lec1.getString(1), 0, 1); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:14:06.387

在使用之前`lec.getString(1)`，你必须打电话`next()`。

所以，在声明之前 `ResultSet rst1= Handler.getData`，

添加

```
if (lec1.next()){
    //second result set statement.
    //set value in jtable
} 
```

# c++ - 为什么我收到错误 c2512：没有合适的默认构造函数可用？

> ID：15534744
> 
> 赞同：-2
> 
> 时间：2013-03-20T21:08:16.370
> 
> 标签：c++, templates

我正在尝试实现模板类 MyQueue（逻辑结构是环形缓冲区）：

```
// MyQueue.h
#pragma once
template<typename T>
class MyQueue
{
public:
    /* interface */
    MyQueue(int sizeOfBuffer);
    void push(const T& elem);
    T pop(void);

private:
    T* m_array;
};

template<typename T>
MyQueue<T>::MyQueue(int sizeOfBuffer)
{
    m_array = new T[sizeOfBuffer];
} 
```

通常，当我在模板类中实现构造函数时，我会在声明中实现它：

```
#pragma once
template<typename T>
class MyQueue
{
public:
    /* interface */
    MyQueue(int sizeOfBuffer){// do some actions with argument sizeOfBuffer};
    void push(const T& elem);
    T pop(void);

private:
    T* m_array;
}; 
```

*由于构造函数的主体会占用大量空间，我决定在声明之外（但在同一个标​​头中）实现它，以使代码更具可读性*。
**问题：**我做错了什么以及如何解决我的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:13:49.457

这与您如何编写构造函数的主体无关。

这与您显然正在尝试创建此类的默认构造对象的事实有关，但您没有提供默认构造函数。通常，编译器会合成一个默认构造函数，但由于您编写了一个带参数的构造函数，编译器也不会（自动）这样做。

使用最近的编译器，您应该能够使用`= default;`C++11 中引入的语法合成默认构造函数。否则，您将需要显式编写一个，或向现有构造函数添加一个默认参数（例如，`MyQueue(int sizeOfBuffer = 20);`）。

# javascript - 带有 ID 的表单元素

> ID：15534745
> 
> 赞同：1
> 
> 时间：2013-03-20T21:08:18.577
> 
> 标签：javascript, html, forms

`form`如果 HTML元素具有`id`属性 ( `<form id="something" action="endpoint" method="POST">`) ，它们似乎无法正常工作。

`form`在具有多个元素的页面上选择正确元素的另一种可靠方法是什么`form`？

我更喜欢使用，`getElementById`因为`getElementsByTagName`,`getElementsByName`等可以返回多个结果。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:11:04.013

只要该 ID 不用于**多个**元素，它们**就可以使用 ID 。**

 **鉴于这种：

```
<form id="myForm" method="POST">
</form> 
```

你可以做：

```
alert(document.getElementById("myForm").method); 
```

**演示：http: [//jsfiddle.net/xw3jc/](http://jsfiddle.net/xw3jc/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:19:39.187

ID 将**始终有效**。

确保您有一个唯一的 ID，即它在整个页面中只出现一次。如果您有多个名称相似的 ID，尽管您的 HTML 可以工作（尽管无效的 HTML 不会通过 W3C 验证），但 JavaScript 不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:18:01.720

`id`属性值必须是唯一的并遵循规则（如果不是 HTML5）：

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

如果是 HTML5，则规则更软：必须至少有一个字符且不能有空格。

如果解决了这个问题，那么表格应该可以正常工作。**

# sql - 在 Rails 中重构昂贵的查询

> ID：15534746
> 
> 赞同：0
> 
> 时间：2013-03-20T21:08:19.603
> 
> 标签：sql, ruby-on-rails

我整天都在尝试重构我的查询。加载一个包含 20 条记录的表需要几分钟时间。起初，我在这个 stackoverflow 帖子中指责了查询：

[rails - 使用 Rails.cache 会出错](https://stackoverflow.com/questions/15442194/rails-using-rails-cache-gives-error)

然而，在做了一些测试之后，我意识到查询加载非常快，并不是罪魁祸首。

然后我把它归咎于 kaminari，因为我认为 kaminari 正在将数千条记录填充到 ruby​​ 对象中，正如我在这篇文章中解释的那样：

[轨道和kaminari](https://stackoverflow.com/questions/15528861/rails-and-kaminari)

但这也是错误的。Kaminari 一次只加载 20 条记录（我使用记录器检查加载了多少报告，结果显示为 20 条）。

所以最后我想我找到了真正的罪魁祸首。这是在该页面的分页期间发生的另一个查询。我意识到这个查询每次运行都需要 20 多秒的时间来加载：

```
def virtual_fence_duration
    inside_fence_time = nil
    outside_fence_time = nil

    outside_fence_time = self.time

    previous_reports = Report.where{(time    <  my{self.time}) &
                                   (unit_id == my{self.unit_id})}.order('time desc')

    previous_reports.each do |report|
      alerts = report.alerts.collect { |a| a.code_name }
      if alerts.include? "Inside virtual fence"
        inside_fence_time = report.time
        break
      end
    end

    if inside_fence_time && outside_fence_time
      "Virtual Fence Elapsed Time: #{(((outside_fence_time - inside_fence_time).to_i).to_f/60.0).ceil} minutes" 
    else
      ""
    end    
  end 
```

基本上，当存在“超出虚拟围栏”的警报时，会调用此方法。我存储时间。然后我查询之前的所有报告（报告 has_many 警报）。然后我使用 ruby​​ 的每个迭代器来遍历每个报告，然后使用与这些报告关联的警报来查找“在虚拟围栏内”的警报。然后我存储该报告的时间并取两者之间的差异。如果在两个持续时间之间有很多报告，这种逻辑似乎会永远持续下去。在 sql (mysql) 或 ruby​​ 中是否有更有效的方法来执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:20:03.330

首先，我不熟悉`"=="`在 mysql 中使用的查询。应该只是`"="`。其次，`"my()"`查询中使用的函数是什么？

除非我不理解您的问题或您正在做的高级事情，否则我认为与此类似的查询会为您提供所需的内容。

```
Report.where('time < ? and unit_id = ?', self.time, self.unit_id).order('time desc') 
```

如果不是，请发布实际从日志文件运行的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:20:09.630

这似乎是一个 N+1 性能问题。尝试使用急切加载`includes`：

```
previous_reports = Report.where{(time    <  my{self.time}) &
                               (unit_id == my{self.unit_id})}.
                          includes(:alerts).order('time desc') 
```

这肯定至少会产生一些影响，尽管它可能仍然很慢，具体取决于表中的行数。如果此时您不满意，则需要为表的`time`和`unit_id`列添加索引`reports`，并检查`alerts`表在列上是否有索引`report_id`。

您还可以在单​​个查询中执行所有这些逻辑，这应该比当前方法有*显着*改进。当然，拥有正确的索引也不会受到伤害：

```
prev_report = Report.joins(:alerts)
                where{time < my{self.time} &&
                      unit_id == my{self.unit_id} &&
                      alerts.code_name.like '%Inside virtual fence%'}.
                order("reports.time DESC").first

inside_fence_time = prev_report.time if prev_report 
```

# python - Tornado PUT 请求缺少正文

> ID：15534748
> 
> 赞同：6
> 
> 时间：2013-03-20T21:08:25.003
> 
> 标签：python, tornado

我正在尝试使用龙卷风 ASyncHTTPClient 发出 put 请求，如下所示：

```
 data = { 'text': 'important text',
           'timestamp': 'an iso timestamp' }

  request = tornado.httpclient.HTTPRequest(URL, method = 'PUT', body = urllib.urlencode(data))

  response = yield Task(tornado.httpclient.ASyncHTTPClient().fetch, request) 
```

但是，当请求到达其所需的端点时，它似乎没有正文，尽管上述正文已在上面正确编码和定义。有什么我在这里忽略的吗？

* * *

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T22:14:54.897

如果另一端需要 JSON，您可能需要设置“Content-Type”标头。试试这个：

```
data = { 'text': 'important text',
       'timestamp': 'an iso timestamp' }

headers = {'Content-Type': 'application/json; charset=UTF-8'}

request = tornado.httpclient.HTTPRequest(URL, method = 'PUT', headers = headers, body = simplejson.dumps(data))

response = yield Task(tornado.httpclient.ASyncHTTPClient().fetch, request) 
```

这样，标头告诉服务器您正在发送 JSON，而正文是可以解析为 JSON 的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T18:53:13.063

问题可能在另一端。
以下使用 Tornado 2.4.1 的测试产生了预期的输出。

```
import logging
import urllib

from tornado.ioloop import IOLoop
from tornado.web import Application, RequestHandler, asynchronous
from tornado.httpclient import HTTPRequest, AsyncHTTPClient
from tornado import gen, options

log = logging.getLogger()
options.parse_command_line()

class PutBodyTest(RequestHandler):
    @asynchronous
    @gen.engine
    def get(self):
        data = {
            'text': 'important text',
            'timestamp': 'a timestamp'
        }
        req = HTTPRequest(
            'http://localhost:8888/put_body_test',
            method='PUT',
            body=urllib.urlencode(data)
        )
        res = yield gen.Task(AsyncHTTPClient().fetch, req)
        self.finish()

    def put(self):
        log.debug(self.request.body)

application = Application([
    (r"/put_body_test", PutBodyTest),
])

if __name__ == "__main__":
    application.listen(8888)
    IOLoop.instance().start() 
```

日志输出：

```
$ python put_test.py --logging=debug
[D 130322 11:45:24 put_test:30] text=important+text&timestamp=a+timestamp
[I 130322 11:45:24 web:1462] 200 PUT /put_body_test (127.0.0.1) 0.37ms
[I 130322 11:45:24 web:1462] 200 GET /put_body_test (::1) 9.76ms 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-09T10:47:09.630

**这是期望 JSON 的发布请求！试试这个：**

```
 @gen.coroutine
    def post(self):
        http_client = AsyncHTTPClient()
        http_client = tornado.httpclient.AsyncHTTPClient()

        URL = "http://localhost:1338/api/getPositionScanByDateRange"
        data = {"startDate":"2017-10-31 18:30:00","endDate":"2018-02-08 12:09:14","groupId":3} #A dictionary of your post data
        headers = {'Content-Type': 'application/json; charset=UTF-8'}

        record = yield http_client.fetch(URL, method = 'POST', headers = headers, body = json.dumps(data))

        if record.error:
            response = record.error
        else:
            response = record.body
        self.set_header('Content-Type', 'application/json')
        self.finish(response) 
```

# perl - 哈希中是否有隐藏的空白元素？

> ID：15534753
> 
> 赞同：1
> 
> 时间：2013-03-20T21:08:43.633
> 
> 标签：perl

玩 Hash 我遇到了以下输出，不知道为什么会这样。默认情况下，哈希中是否有嵌入的空格？

```
#! /usr/bin/perl
# playwhash
use warnings;
use strict;

my %normal = ("Tom ","5'3","Peter ","5'11","John " ,"5'7",);
foreach (1..6) {
    print each %normal, "\n";
    } 
```

输出看起来像

```
Peter 5'11
Tom 5'3
John 5'7

Peter 5'11
Tom 5'3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T21:12:03.217

从[每个函数的文档中](http://perldoc.perl.org/functions/each.html)：

> 在 each 从散列或数组返回所有条目后，对 each 的下一次调用在列表上下文中返回空列表，在标量上下文中返回 undef；紧随其后的下一个调用将重新开始迭代。

因此，在第三次迭代之后`each`只返回一个空列表以表明哈希中没有更多元素。Next 调用从头开始返回哈希条目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:19:37.310

返回键和值，因此`each`迭代次数不是 6（这是键 + 值的总和）。这是 的常见用法`each`：

```
while( ($key, $value) = each %normal ) {
   print "$key  =>  $value\n";
} 
```

或仅用于打印 perl 结构：

```
use Data::Dump;
my %normal = ("Tom ","5'3","Peter ","5'11","John " ,"5'7",);
dd %normal; 
```

# node.js - 工人可以向生产者发送消息吗

> ID：15534754
> 
> 赞同：2
> 
> 时间：2013-03-20T21:08:44.397
> 
> 标签：node.js, queue, message-queue, worker, job-queue

我有一个具有以下情况的 NodeJS 应用程序：我收到用户的请求，要求计算需要使用非常复杂的数学公式的东西。目前，我在那一刻运行整个过程，找出值，然后将其发送回用户。不幸的是，这不是很异步友好:)

相反，我想做的是在后台运行整个操作，一旦任务完成，工作人员就会返回给我计算的值是什么，然后我将其发回给用户。

我一直在查看各种工作队列，包括[Kue](http://learnboost.github.com/kue/)、[Celery](http://www.celeryproject.org/)、[Resque](https://github.com/defunkt/resque)和[Beanstalk](http://kr.github.com/beanstalkd/)，但似乎没有一个提供此功能。它们非常适合发送电子邮件或运行不需要接收某种价值的任何类型的工作，只是简单地说它是否成功，但似乎没有任何东西允许worker 将自定义消息实际发送回创建任务的原始生产者。

我说上述队列都不支持这一点是错的吗？如果是这样，请指出我可以在文档中了解如何使用此功能的位置。否则，您能否指出任何其他支持此功能的人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-29T03:02:47.453

You should fetch results from a dedicated queue and then push them to user.
Use celery as tasks queue manager and long-polling or socket for return result of operations to user.
From nodeJS app you can use node-celery [https://github.com/mher/node-celery](https://github.com/mher/node-celery) or insert messages directly in the celery reserved queue.
eg

```
var amqp = require('amqp');
var connection = amqp.createConnection({
  host: 'localhost',
  port: 5672
});
connection.on('ready',function(){
  connection.publish('celery', {id:uuid.v4(), task:'yourapp.tasks.usefultask', args:['firstArg','secondArg'], kwargs:{}},{
      'contentType': 'application/json'
      });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T16:19:55.513

您可以将 Celery 与[https://github.com/mher/node-celery一起使用](https://github.com/mher/node-celery)

node-celery 允许对任务进行排队并接收执行结果

```
var celery = require('node-celery'),
    client = celery.createClient({
        CELERY_BROKER_URL: 'amqp://guest:guest@localhost:5672//',
        CELERY_RESULT_BACKEND: 'amqp'
    });

client.on('connect', function() {
    client.call('factorial', [1000000], function(result) {
        console.log(result);
    });
}); 
```

# javascript - 输出到javascript中的标签

> ID：15534755
> 
> 赞同：0
> 
> 时间：2013-03-20T21:08:57.253
> 
> 标签：javascript, html

我目前正在运行一个将结果输出到文本框中的脚本，但是我想使用不同的控件来显示结果

这是片段。. . 谢谢你！这就是我所拥有的。. .

```
 <input type="text" id="dice2" /><br/><br/>
    $("dice2").value = die1.getValue2(); 
```

这行不通。. .

```
 <span id="dice2">&nbsp;</span><br /><br />
    $("dice2").value = die1.getValue2(); 
```

我希望 javascript/html 相当于输出到 C# 中的标签。再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:12:09.947

如果您使用的是 jQuery，`.val()`是一个用于获取和设置输入值的函数。并且不要忘记将 # 放在元素 id 之前 `$("#dice2").val($("#dice1").val());`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:12:47.570

您可能错过了“#”：

```
$("dice2").value = die1.getValue2(); 
```

应该是（对于 ID）：

```
$("#dice2").value = die1.getValue2(); 
```

对于（类）：

```
$(".dice2").value = die1.getValue2(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:33:23.807

首先，**这不需要 jQuery，您可以使用 vanilla JS 轻松实现**。

其次，`<input>`标签与标签的属性不同`<span>`，需要分别对待。

要获取/设置`<input>`标签内的内容，只需调用：

`document.getElementById('my-input').value`

要获取/设置`<span>`标签调用内部的内容：

`document.getElementByTagName('span').innerText`（或者`.innerHTML`如果您不希望 HTML 被解码）

因此，如果您想从文本框中获取文本并将其放入 span 标签中，您可以执行以下操作：

```
var inputTextbox = document.getElementById('my-input-textbox'),
    spanResult = document.getElementById('my-resulting-span');

spanResult.innerHTML = inputTextbox.value; 
```

# sql - Oracle CREATE TABLE 缺少右括号 为什么？

> ID：15534759
> 
> 赞同：1
> 
> 时间：2013-03-20T21:09:14.943
> 
> 标签：sql, oracle, ddl

使用 Oracle 我正在尝试创建这些表（这只是一个）并且我不断收到“缺少右括号”错误。我不明白为什么。

这不是服务器，尝试了一张预制的桌子，效果很好。有什么建议么？

```
CREATE TABLE Project (
Proj_Num DECIMAL(2,0)
Proj_Name CHAR(40),
Proj_Value DECIMAL(10,2),
Proj_Balance DECIMAL(10,2),
Emp_Num CHAR(3) 
FOREIGN KEY (emp_num),
PRIMARY KEY (Proj_Num) )
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:10:58.717

您似乎在第一个字段后缺少逗号：

```
Proj_Num DECIMAL(2,0), <--- No comma here in your example
Proj_Name CHAR(40), 
```

# python - 从字符串中删除所有字母和逗号

> ID：15534761
> 
> 赞同：1
> 
> 时间：2013-03-20T21:09:14.707
> 
> 标签：python, regex, string

我有一个巨大的列表，其中包含多个元素，如下所示：

`'A.21,48;B.64,91;C.95,125;D.139,166;E.175,200'`

我想剥离所有字母和`; .`字符并附加到列表中，使列表看起来像`['21','48','64','91','95','125','139','166','175','200']`

我尝试使用：

```
import re
list.append(re.sub("\D","", <the string i am working on>)) 
```

但它会产生这样的列表 -`[' 21 48 64 91 95 125 139 166 175 200']`

由于我在一个非常大的文件的循环中工作，因此一行代码将非常有帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:12:10.990

你可以使用`re.findall()`：

```
>>> import re
>>> strs='A.21,48;B.64,91;C.95,125;D.139,166;E.175,200'
>>> re.findall(r"\d+",strs)
['21', '48', '64', '91', '95', '125', '139', '166', '175', '200'] 
```

使用`re.sub()`：

```
>>> re.sub(r"[A-Z;,.]"," ",strs).split()
['21', '48', '64', '91', '95', '125', '139', '166', '175', '200'] 
```

**帮助（重新.findall）：**

```
Help on function findall in module re:

findall(pattern, string, flags=0)
Return a list of all non-overlapping matches in the string.

If one or more groups are present in the pattern, return a
list of groups; this will be a list of tuples if the pattern
has more than one group.

Empty matches are included in the result. 
```

# image - 如何在 MATLAB 中对图像进行水平移动？

> ID：15534764
> 
> 赞同：6
> 
> 时间：2013-03-20T21:09:28.623
> 
> 标签：image, matlab

我有一张已转换为双矩阵的图像。我想水平移动它，但我不知道该怎么做。我试图操纵位置，但事实证明我只是操纵颜色。

有没有办法可以引用像素位置，然后添加一个常量来执行移位？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T00:40:49.007

Using the Image Processing Toolbox, you can apply a [spatial transformation](http://blogs.mathworks.com/steve/category/spatial-transforms/):

```
img = imread('pout.tif');
T = maketform('affine', [1 0 0; 0 1 0; 50 100 1]);   %# represents translation
img2 = imtransform(img, T, ...
    'XData',[1 size(img,2)], 'YData',[1 size(img,1)]);
subplot(121), imshow(img), axis on
subplot(122), imshow(img2), axis on 
```

![affine translation](../Images/2585d5ee1566811899cdb39fdd20e61e.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T21:37:01.570

您可以使用`circshift`来执行循环移位，`im = circshift(im, [vShift hShift])`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:13:27.013

假设您的图像是矩阵 A 并且您想将 x 列包装到左侧：

```
A = [A(x+1:end,:) A(1:x,:)]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-20T11:55:45.660

如果您没有工具箱但仍想进行亚像素移动，您可以使用此功能。它制作了一个在 x 和 y 上移动单个像素的过滤器，并将该过滤器应用于图像。

```
function [IM] = shiftIM(IM,shift)
S = max(ceil(abs(shift(:))));
S=S*2+3;
filt = zeros(S);
shift = shift + (S+1)/2;
filt(floor(shift(1)),floor(shift(2)))=(1-rem(shift(1),1))*(1-rem(shift(2),1));
filt(floor(shift(1))+1,floor(shift(2)))=rem(shift(1),1)*(1-rem(shift(2),1));
filt(floor(shift(1)),floor(shift(2))+1)=(1-rem(shift(1),1))*rem(shift(2),1);
filt(floor(shift(1))+1,floor(shift(2)+1))=rem(shift(1),1)*rem(shift(2),1);
IM=conv2(IM, filt, 'same');
end

%to test
IM = imread('peppers.png');IM = mean(double(IM),3);
for ct = 0:0.2:10
    imagesc(shiftIM(IM,[ct/3,ct]))
    pause(0.2)
end
%it should shift to the right in x and y 
```

# javascript - 在客户的网站上加载自己的脚本

> ID：15534766
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:09:35.163
> 
> 标签：javascript, jquery, xss

我试图在 javascript 中构建某种 API。基本上，我希望客户端在他的页面上包含一个脚本，该脚本将加载 jquery、colorbox 并执行一个自定义函数，目前，该函数只会显示一个带有消息的 colorbox 弹出窗口。当然，客户在他的页面上包含的脚本将由我托管。

为了实现上述所有目标，这个脚本应该是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:11:08.090

脚本 SRC 指向您自己的 URL，就像您使用 CDN 或 Google Analytics 一样。

当然，脚本会期望找到一些 HTML，正如脚本已经运行的方式所定义的那样。除此之外 - 就好像它在您自己的页面上一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:18:40.347

像这样的东西

```
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'link to your script here';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s); 
```

从[如何在 javascript 中附加 <script></script>？](https://stackoverflow.com/questions/9413737/how-to-append-script-script-in-javascript)

# file - AWS S3 对象到期问题 - 前缀

> ID：15534769
> 
> 赞同：2
> 
> 时间：2013-03-20T21:09:36.870
> 
> 标签：file, amazon-web-services, amazon-s3

我想使用 AWS S3 Object Expiry 并设置存储桶和生命周期规则。

规则如下图所示：

![在此处输入图像描述](../Images/e15617ca33fe0506c15031fc4f9f0629.png)

我认为我遇到的问题与前缀有关。

我在存储桶“在线约会/约会裁剪/”下创建了这个结构，并开始将文件放入我想要删除的这个位置 - tmp 文件。这个想法是这些文件将被自动删除。

当我检查时，我发现结构“在线约会/约会裁剪/”已被删除。例如：它没有清除此处的文件，而是将其完全删除。

因此，我是否正确假设您不能像这样使用到期规则（指向要清理的存储桶下的位置？前缀是否必须反映您要删除的实际文件 - 例如：remove apples.jpg -例如，您可以将规则设置为 app* 吗？

因此，我认为文件实际驻留在存储桶中的哪个位置并不重要。只是前缀必须与文件匹配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:45:55.173

虽然许多 S3 浏览器（包括 AWS 管理控制台）会显示带有“/”作为目录的路径，但这不是它们的本质。删除所有具有指定前缀的文件将意味着浏览器不再能够检测到该名称的“文件夹”是否存在。

无论您使用什么过程来创建临时文件，在写入更多文件时都应该没有任何问题，一旦写入新的临时文件，“文件夹”就会重新出现在 S3 浏览器中。

# java - 如何使用 Java 在 MySQL 中插入当前时间

> ID：15534775
> 
> 赞同：5
> 
> 时间：2013-03-20T21:10:07.893
> 
> 标签：java, mysql

我需要将当前日期和时间（毫秒）插入 MySQL。我做了以下事情：

```
long time = System.currentTimeMillis();
java.sql.Timestamp timestamp = new java.sql.Timestamp(time);
System.out.println("Time in milliseconds :" + timestamp); 
```

我正确地得到了以毫秒为单位的时间（例如 2013-03-21 00:08:33.523）。但是，我需要将此信息插入 MySQL 数据库。我尝试了以下使用`PreparedStatement`

```
prepStmt.setTimestamp(2,timestamp); 
```

但是插入的时间没有毫秒（例如 2013-03-21 00:08:33）。

如何插入以毫秒为单位的时间。

**编辑：**数据库中的列是`DATETIME`类型。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T21:12:31.477

```
java.util.Date date = new java.util.Date();
java.sql.Timestamp timestamp = new java.sql.Timestamp(date.getTime());
preparedStatement.setTimestamp(1, timestamp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:15:54.140

如果列是 DATETIME 类型，请使用 PreparedStatement 的 setDate 方法。

```
java.sql.Date date = new java.sql.Date(System.currentTimeMillis());
stmnt.setDate(1, date); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-24T16:53:35.150

您可以创建一个方法 getCurrentTimeStamp() 并从 JDBC 语句中调用它

PreparedStatement.setTimestamp(4,getCurrentTimeStamp());

方法：

私有静态 java.sql.Timestamp getCurrentTimeStamp() {

```
java.util.Date today = new java.util.Date();
return new java.sql.Timestamp(today.getTime()); 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:29:02.077

由于其他成员已正确回答了该问题，让我添加一些关于数据库中日期类型存储的个人后见之明。

在个人层面上，我更喜欢以长格式存储日期信息。我发现以后存储和使用都更容易。不仅大多数语言都提供了创建带有长参数的新日期，而且您不会被预设格式卡住，您将有机会以不同的方式对其进行格式化。例如，我必须在我开发的某个网站上将日期格式化为英语或法语格式，然后在某些语言参数上使用 if-else if 并根据语言偏好应用给定格式会更容易。

但是，这种方法有一些缺点。您需要将其格式化回可读格式，例如，由不使用 Java 格式化的查询完成的自动报告。

```
-----------------------------ADD CODE-----------------------------

    // Stored as 0 if the date is not initialised
    long time = objInscription.getDatePremierVisionnement() != null ?
        objInscription.getDatePremierVisionnement().getTime() : 0;

-------------------------------GET CODE----------------------------
    // long is store as 0 if the date has not been initialised           
    long long = rs.rsReadColumnLong(1);
    if (long  == 0) {
        someobj.setSomeDate(null);
    } else {
        someobj.setSomeDate(new Date(long));
    } 
```

您将能够轻松地使用 SimpleFormat 来显示您的数据。

# javascript - 使用 Promise 处理分支

> ID：15534776
> 
> 赞同：6
> 
> 时间：2013-03-20T21:10:13.577
> 
> 标签：javascript, jquery, asynchronous, promise

我对 jQuery 1.9.1 Promise 有疑问，我可能需要条件逻辑来返回另一个 deferred，但我不知道如何处理它。这是我最好的尝试，但正如下面的评论所示，当我点击 else 分支时，我仍然点击了第二个 .then() 函数，我希望我可以回到用户那里。如何处理这种情况的任何模式？

```
storage.provision(c)

.then(function(rc){
    if(rc === 0){
        storage.write(c);
    }else{
        return options.onSuccess(rc); //how i got back to the users callbacks/promise, but this
        //takes me to the .then below
    }
})
 //storage.write returns a promise as well, do I do another .then 
// like this?
.then(function(rc){
    //I was hoping this would catch, the storage.write() case, and it does, but it also catches
    //the retun options.onSuccess(rc) in the else case.
    options.onSuccess(rc);
})

.fail(function(e){
    //handle error using .reject()
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:10:57.417

通过采用在第二个但从不在第一个中`options.onSuccess(rc);`无条件执行的视图，这变得更容易。`.then()`

因此，第一个`.then()`必须传递`rc`：

*   if `rc === 0`，响应`storage.write(c)`完成
*   或立即如果`rc !== 0`。

`.then()`这样做真的很方便，因为它自然允许从`done`回调中返回新 Promise 的值。

```
storage.provision(c).then(function(rc) {
    if(rc === 0) {
        var dfrd = $.Deferred();
        storage.write(c).done(function() {
            dfrd.resolve(rc);
        }).fail(dfrd.fail);
        return dfrd.promise();
    } else {
        return rc;//pass on rc to the second .then()
    }
}).then(function(rc){
    options.onSuccess(rc);
}).fail(function(e){
    //handle error using .reject()
}); 
```

我确信存在其他方法，但这是我能想到的最接近您的原始概念的方法。

不必创建新的 Deferred when 会很好，`rc === 0`但它是传递最现实的方法`rc`，避免了修改`storage.write()`以这种方式运行的需要。

# scala - 光滑的连接池？

> ID：15534777
> 
> 赞同：29
> 
> 时间：2013-03-20T21:10:22.020
> 
> 标签：scala, slick

有没有一种简单的方法可以使用带有 scala 的[Slick](http://slick.typesafe.com/)的数据库连接池？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-21T17:06:20.597

我用`Apache Commons DBCP`这个。基本上，您只需创建一个`DataSource`, 封装池化详细信息，然后将其传递`DataSource`给 Slick：

```
import org.apache.commons.dbcp.BasicDataSource

val dataSource: DataSource = {
  val ds = new BasicDataSource
  ds.setDriverClassName("org.hsqldb.jdbc.JDBCDriver")
  ds.setUsername("SA")
  ds.setPassword("")
  ds.setMaxActive(20);
  ds.setMaxIdle(10);
  ds.setInitialSize(10);
  ds.setValidationQuery("SELECT 1 FROM INFORMATION_SCHEMA.SYSTEM_USERS")
  new java.io.File("target").mkdirs // ensure that folder for database exists
  ds.setUrl("jdbc:hsqldb:file:target/db/db")
  ds
}

// test the data source validity
dataSource.getConnection().close()

// get the Slick database that uses the pooled connection
val database = Database.forDataSource(dataSource) 
```

此示例使用 HSQLDB，但可以轻松适应任何其他数据库。

完整的例子在[这里](https://github.com/Rogach/template/blob/master/lift/src/main/scala/DB.scala#L12)（你可以克隆项目，并`sbt run`在 lift/ 目录中运行以查看它的工作）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-07T21:45:56.510

为了完成，我最终写了一篇关于此的博客文章：

[http://fernandezpablo85.github.io/2013/04/07/slick_connection_pooling.html](http://fernandezpablo85.github.io/2013/04/07/slick_connection_pooling.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-08T21:06:52.147

Play 2.4 现在使用看起来非常不错的 HikariCP： [https ://brettwooldridge.github.io/HikariCP/](https://brettwooldridge.github.io/HikariCP/) [https://www.playframework.com/documentation/2.4.x/SettingsJDBC](https://www.playframework.com/documentation/2.4.x/SettingsJDBC)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-22T20:19:51.857

似乎更高版本的播放池配置了连接 - 请参阅[http://www.playframework.com/documentation/2.0.1/SettingsJDBC](http://www.playframework.com/documentation/2.0.1/SettingsJDBC)

# matlab - 寻找对 MATLAB 的 methods() 函数的未记录使用的洞察力

> ID：15534779
> 
> 赞同：4
> 
> 时间：2013-03-20T21:10:27.810
> 
> 标签：matlab, matlab-class

我已经看过了，但没有看到`[a b] = methods(classname)`记录。我的意思是，记录了单变量输出，但没有记录双变量输出。我在 MATLAB 或未记录的 matlab 中，*甚至在*. 也许我错过了？

`char`例如，如果我用 matlab 类调用它

```
[a b] = methods(char); 
```

然后`a`是 char 的方法列表，并且`b`是`[]`

但...

对于 java 类，`b`具有一些有用的值。假设这`javaClass`是一个 java 类或 java 类名。

通常，我会打电话`a = method(javaClass)`或打电话`a = method(javaClass,'-full')`。但是，我注意到我也可以打电话

`[a b] = method(javaClass)`

当我做：

*   `a`是一个包含所有类方法名称的唯一列表的单元格。（如预期）
*   `b`是一个 N x 6 的字符串单元格，每列代表：
    1.  `'static'`如果是静态的，`[]`否则
    2.  完全合格的返回类
    3.  方法名称
    4.  完全限定方法名
    5.  输入参数（在括号中），或者只是`()`
    6.  '抛出*fully.qualified.exception.name* '，或`[]`

例子：

```
[a b] = method(java.lang.Integer); 
```

然后，`a`是一个包含简单名称的 <32x1 单元格>，例如`'Integer'`,`'bitCount'`等。

但是，`b`是一个 <43x6 单元格>，包含每个函数的每个变体。例如，valueOf 函数之一将显示

```
COL  VALUE
1\.   static
2\.   java.lang.Integer
3\.   valueOf
4\.   java.lang.Integer.valueOf
5\.   (java.lang.String)
6\.   throws java.lang.NumberFormatException` 
```

### 所以，这是我的问题：

主要问题：这完全不安全使用吗？因为它是无证的，所以我假设是这样；但是它为我提供了一些无需复制的内置功能。解析的解决方法并不令人讨厌，但是这个功能已经在这里了。

这是从哪里来的？也就是说，这实际上是来自 MATLAB 函数，还是它正在使用一些 Java 函数？

有人用吗？或者（如主要问题）应该避免它吗？

有这方面的文件吗？除了这篇文章，我的意思是。我的意思是，当然，它似乎是一个直截了当的功能......这对任何人来说都足够有趣吗？

我在 MATLAB 2011b 上，此功能是否仍然存在于更高版本的 MATLAB（2013a）中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:25:58.443

对于 MATLAB 自己的类（`classdef`样式），可以使用[元数据系统](http://www.mathworks.com/help/matlab/get-information-about-classes-and-objects.html)获取类​​似信息：

```
mc = ?timer
mc.MethodList 
```

[`methods`](http://www.mathworks.com/help/matlab/ref/methods.html)您在上面显示的使用似乎对 Java 类和对象特别有用。[`methodsview`](http://www.mathworks.com/help/matlab/ref/methodsview.html)检查内部使用两个输出的函数的源代码`methods`。

```
edit methodsview 
```

![方法视图](../Images/e83ded7ed5a490de2074c83b82456725.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T19:58:21.050

Matlab 包括许多这样的无证金块，我自 2009 年以来一直在我的[UndocumentedMatlab.com](http://UndocumentedMatlab.com)网站上进行记录（该网站几天前迎来了 4 岁生日）。其中大部分与 Matlab-Java 接口（我在其上写了一[本书](http://undocumentedmatlab.com/matlab-java-book/)）有关，但也有许多[纯 Matlab](http://undocumentedmatlab.com/blog/tag/pure-matlab/)未记录的特性和函数非常有用。

就未来的 Matlab 兼容性而言，其中一些功能比其他功能更具风险。我认为第二个输出 arg 的`methods`风险很低。它确实是无证的，但以目前的形式存在了很长时间（至少十年，可能更久）。从 R2013a 开始，它仍然可用。正如 Amro 所说，它由内部`methodsview`函数使用，使用起来完全安全。

如果您有兴趣在 Matlab 中获取有关 Java 对象的信息，请考虑使用[`uiinspect`](http://www.mathworks.com/matlabcentral/fileexchange/17935-uiinspect-display-methods-properties-callbacks-of-an-object)或实用程序，它提供的信息比或[`checkClass`](http://www.mathworks.com/matlabcentral/fileexchange/26947-checkclass)多得多。两者都适用于多种类型的对象句柄和类名，包括 Java、COM、Matlab 类和 HG 句柄（HG 仅由 提供）。[此处](http://undocumentedmatlab.com/blog/uiinspect/)提供了的技术说明。`methods``methodsview``uiinspect``checkClass``uiinspect``uiinspect`

* * *

`uiinspect`用于 Java、COM 和 Matlab 句柄： ![<code>uiinspect</code> 用于 Java、COM 和 Matlab 句柄](../Images/ef02dc8ff640943cbf0b340b5aef38cb.png)

* * *

`checkClass`在 Java 对象或类名上使用：

![<code>checkClass</code> 在 Java 对象上使用](../Images/7f26b7a54feef016b42a41eb257ed9a9.png)

# jquery - fancybox 和 wordpress：图片标题

> ID：15534781
> 
> 赞同：0
> 
> 时间：2013-03-20T21:10:32.377
> 
> 标签：jquery, wordpress, fancybox, fancybox-2

我在没有插件的情况下可以很好地使用 wordpress，但在图像标题方面却苦苦挣扎。

fancybox 正在寻找标题的锚点，但 wordpress 将标题放在 img 中。

我查看了所有解决方法并尝试了每个 stackoverflow 解决方案，但似乎没有任何效果。

我认为有两个选择： 1\. 告诉 fancybox 使用 img 标题（或 alt）而不是锚标题 2\. 运行一个函数来提取附件标题并将其插入锚

周围有很多解决方案，但我显然做错了什么。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:03:50.090

您可以使用fancybox 的回调来获取标签中的`alt`或`title`属性的值，例如：`<img>``beforeShow`

```
$(".fancybox").fancybox({
    beforeShow: function () {
        // option 1
        // get the title from "alt" attribute
        this.title = $(this.element).find("img").attr("alt");
        // option 2
        // get the title from "title" attribute in img tag
        // this.title = $(this.element).find("img").attr("title");
    }
}); 
```

见**[JSFIDDLE](http://jsfiddle.net/9jqwf/)**

# java - 计算循环执行次数

> ID：15534783
> 
> 赞同：0
> 
> 时间：2013-03-20T21:10:42.570
> 
> 标签：java, loops, counting

我想计算一个循环执行了多少次，不知道我会怎么做。

我正在使用 Dr Java，提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:13:48.243

在循环之前，定义一个计数变量：

```
int count = 0; 
```

在循环内的某处，增加该变量：

```
count++; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:13:49.990

在范围外声明一个变量，将其设置为 0 并在每次循环开始时递增：

```
int counter = 0;
do { 
    counter++;
    uNum= TextIO.getlnInt(); 
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:35:33.807

这与其他答案略有不同......

### 选项1：

使用*局部*变量

```
int count = 0;
do {
    count++;
    ...
} while ...

// count now equals the number if iterations 
```

但这只会计算一次迭代。如果你再次调用进入循环，它会再次计数，忘记之前的迭代。

### 选项 2：

使用*实例*变量

要累积计算迭代次数 - 真正的“总数” - 您需要在调用方法之间保存状态：

```
int count;

public void loopMethod() {
    do {
        count++;
    } while ...
    // count equals the total cumulative iterations 

} 
```

如果需要，使用实例变量还意味着该计数可用于其他方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:14:01.860

在循环执行之前将 int 初始化为 0。在循环顶部将该 int 递增 1。现在 int 将始终保存循环执行的次数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:15:05.173

`do{}`很简单，在循环之前添加一个初始化为零的计数器，如下所示：

```
int count = 0; 
```

然后，在循环中递增计数器，如下所示：

```
...
count+=1;
} while (uNum > gNum || uNum < gNum); 
```

然后，在循环显示值之后：

```
System.out.println("Count: " + count); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T21:15:12.020

在循环外添加一个变量，并将其初始化为零。在循环中，只需增加该变量，您就会得到计数！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T21:15:13.970

在循环外初始化一个变量，例如`int count = 0`. 在循环开始时将变量加一，通过`count++`或`count = count + 1`

# jquery - 有没有一种很好的方法来处理不显眼的验证看似异步的行为？

> ID：15534790
> 
> 赞同：2
> 
> 时间：2013-03-20T21:11:03.313
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4, jquery-validate, unobtrusive-validation

我在提交表单时运行了以下缩写验证代码。为我的表单设置了不显眼的验证。

```
(function () {
    "use strict";

    $("#feedbackForm").submit(function () {
        var t = $(this).serialize();
        var val = $(this).validate();
        console.log(val.errorList.length);
        return false;
    });
})(); 
```

当我在 Chrome 中遇到断点时，我看到以下行为： ![不显眼的验证行为](../Images/e1522e1f307524994d53d884fb5e080e.png)

您可以从控制台看到，当代码最初执行时，它在验证的错误列表中识别出 0 个错误，但是当我通过断点暂停执行时，它在验证的错误列表中识别出 4 个错误。此外，在第一次之后，正确的错误数会在运行时正确计算。

*   这怎么可能？
*   如何在运行时获得正确数量的错误？

* * *

### 编辑1：

我无法在 jsfiddle 上重现这个问题，所以肯定有其他事情发生。

[小提琴](http://jsfiddle.net/peter_majeed/xf7K4/1/ "JS小提琴")

* * *

### 编辑2：

我还必须注意，`setTimeout()`在提交处理程序中使用每次都会在第二次获得正确的结果，但这似乎只是证实了 mattytommo 在他的回答中提到的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T16:09:08.077

而不是`validate`你可以使用同步`invalidHandler`检查。这样你就知道它已经完成了。

它可能在您的 Fiddle 中起作用的原因可能是巧合，因为它可以更快地验证表单，但在您的实际实现中速度较慢。

尝试这样的事情：

```
$("#feedbackForm").submit(function () {
    var t = $(this).serialize();
    $(this).validate({
        invalidHandler: function(event, validator) {
            var errors = validator.numberOfInvalids();
            if (errors) {
                if (validator.errorList.length > 0) {
                    for (x=0;x<validator.errorList.length;x++) {
                        console.log("\n\u25CF " + validator.errorList[x].message);
                    }
                }
            }
        }
    });

   $(this).validate();

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T17:27:25.870

最终我不确定为什么手动测量错误数量不起作用，但最后，我真正想做的就是验证表单并根据其状态做一些事情，为了实现这一点，Darin Dimitrov 的建议有效：

[如何检查不显眼的验证是否已在 jquery 函数中验证？](https://stackoverflow.com/questions/8238320/how-to-check-that-the-unobtrusive-validations-has-been-validated-in-jquery-funct/8238421#8238421)

我确信我已经尝试过这个`valid()`方法，但它没有用，但我想我没有。此外，与其他两种方法相比，不显眼的插件似乎更喜欢这种方法。

### 工作代码：

```
(function ($) {
    "use strict";

    $("#feedbackForm").on("submit", function () {
        var t = $(this).serialize(),
            val;

        val = $(this).validate();
        console.log(val.numberOfInvalids());
        console.log(val.errorList.length);
        console.log($(this).valid());       

        return false;
    });
})(jQuery); 
```

![验证](../Images/5cc1c87e62739a59d32c30d975be0c55.png)

### 工作小提琴

小提琴在原来的情况下工作，所以没有必要更新它。

# php - php比较区间数

> ID：15534793
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:11:11.100
> 
> 标签：php, arrays, max

我有这个 ：

```
 $values=array("10","30","40")
    $real_value=22; 
```

我需要比较这个数字是 $values 的数组列表之间的最大值还是最小值，例如获取这个，数字 22 它更大的 10 和更多的 30 并且不继续包含和获取间隔

我试试这个，但没有划定间隔

```
for ($i=0;$i<count($values);$i++)
{

if ($real_value>$values[$i])
{
print "".$values."";
}

} 
```

例如，我需要获取数字 22 的值 real_value 30 因为 22 它超过 10 但不超过 30 或 50，并且间隔在 10 到 30 之间

我不知道如何得到这个我希望来自社区的一些想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:14:31.587

一起去：

```
for ($i=0;$i<count($values);$i++)
{

   if ($real_value>$values[$i])
   {
      if($1>0){
         print $values[$i-1]." - ".$values[$i-1];
      }else{
         print $values[$i];
      }
   break;
   }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:14:43.293

如果我对您的理解正确，您只需要更改您的条件并在以下情况下休息`true`：

```
if ($real_value <= $values[$i])
{
  print $values[$i];
  break;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T21:14:51.210

试试这个：

```
for ($i=0;$i<count($values);$i++)
{
    if ($real_value < $values[$i])
    {
        print $values[$i];
        break;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:16:57.967

```
<?php
// Define the number added to each step
$increment = 10; 

// The number we're actually dealing with
$real_value = 22;

$current = 0; // Starting value
while($current <= $real_value) { // Iterate, adding $increment each loop
  if($current < $real_value) {
    $current += 10;
  }
}

print' Real Value "' . $real_value . '" has calculated value of: "' . $current . '".'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:17:52.790

你可以试试这个。1\. 将您的 $real_value 添加到数组中。2\. 对数组进行排序。3\. 获取实际值+1索引处的元素。

# jquery - JQuery一键事件多元素事件

> ID：15534810
> 
> 赞同：3
> 
> 时间：2013-03-20T21:12:05.113
> 
> 标签：jquery

我的问题与此有关： [jQuery same click event for multiple elements](https://stackoverflow.com/questions/1313373/jquery-same-click-event-for-multiple-elements)

但是，当我这样做时：

```
$('.class1, .class2').click(function() {
   some_function();
}); 
```

我总是对同一个对象使用同一个函数。例如，如果我想合并以下两个语句怎么办：

```
$(".class1").click(function () {
  $(".classer1").slideToggle("slow");
});

$(".class2").click(function () {
  $(".classer2").slideToggle("slow");
}); 
```

他们为每个引用一个不同的对象-我什至可以合并它吗？

谢谢，奥利弗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:17:34.563

你可以这样做：

```
$(".class1, .class2").click(function () {
  $(".classer"+$(this).attr('class').substr(-1)).slideToggle("slow");
}); 
```

只要您单击的元素只有一个类。这会将整数从被单击的元素中拉出并将其附加到`.classer`. 所以点击`.class2`会触发切换`.classer2`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:14:45.057

我认为最好的方法是为每个类使用的参考号添加一个数据属性，所以如果你有类似的东西

`<div class="class1" data-ref-id="1"></div>`

和

`<div class="class2" data-ref-id="2"></div>`

您可以像这样找到引用的切换类：

```
$('.class1, .class2').click(function (e) {
    $('.' + NAME_OF_REFERENCED_TOGGLE_CLASS + this.data.refId).slideToggle('slow');
}) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:17:45.603

您可能想看看[add()](http://api.jquery.com/add/)。使用它将选择器添加到选择堆栈。像这样使用它：

```
$('.class1').add('.class2').click(function (e) {
    // Do whatever you want
}) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T21:18:10.487

```
<div class='common-class' data-id='1'></div>

$('.common-class').on('click', function() {
    if ($(this).data('id')) { 
        $(".classer" + $(this).data('id')).slideToggle("slow");
    }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T21:23:22.603

根据您的html，根据元素位置进行选择可能会更好。例如，如果这是您的 html：

```
<dl class="class1 list">
    <dt>Foo</dt>
    <dd>Foobar</dd>
    <dt>Dog</dt>
    <dd>Pitbull</dd>
</dl>
<dl class="class2 list">
    <dt>Foo</dt>
    <dd>Foobar</dd>
    <dt>Dog</dt>
    <dd>Pitbull</dd>
</dl> 
```

你可以使用：

```
$(".list dt").click(function(){
    $(this).next("dd").slideToggle();
}); 
```

通过单击事件处理两个列表。

# vb.net - 将字符串变量与数据文件（指定列）中的位置匹配，以便我可以使用该行 VB 中的所有值？

> ID：15534811
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:12:07.813
> 
> 标签：vb.net, match

字符串匹配的行我想为每一列的该行中的其余值分配变量。这是我试图找到我认为错误的匹配项：

```
Dim intIndex As Integer
For Each Str As String In strColumn(1)
If Str.Contains(strID) Then
intIndex = Str.IndexOf(strID, 0)
End If
Next 
```

即使找到匹配的行号，我如何告诉每个变量将自己分配给哪一行和哪一列？

一行的样本，每列用“，”分隔：1234567,03/02/2013,7,2,B,L,ST
并且这些行的行数不受限制

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:18:38.207

给你 - 假设你已经有一个字符串（行）数组（可能来自带有 的文件`ReadAllLines`），这样的事情应该让你朝着正确的方向前进：

```
Dim rowFound As Boolean = False
Dim rowNumber As Integer = 0
Dim columns As String()
Dim col1 As String = ""
Dim col2 As String = ""
Dim col3 As String = ""
Dim col4 As String = ""
Dim col5 As String = ""
Dim col6 As String = ""
Dim col7 As String = ""

Do While Not rowFound And rowNumber < rowArray.Length
   columns = rowArray(rowNumber).Split(New Char() {","c)
   If columns(0) = strID Then
       rowFound = True
       col1 = colunns(0)
       col2 = columns(1)
       col3 = columns(2)
       col4 = columns(3)
       col5 = columns(4)
       col6 = columns(5)
       col7 = columns(6)
   Else
       rowNumber = rowNumber + 1
   End If
Loop 
```

需要注意的一些事项：

首先，我没有对此进行测试，因此可能存在一些语法错误（我做的 C# 比 VB.NET 多得多）。

其次，我使用了一个 While 循环，这样您就不会浪费时间检查每一行，如果您尽早找到您正在寻找的那一行。如果标志 rowFound 设置为 true 或 rowNumber 计数超过或等于数组的长度（假设从 0 开始的索引数组），While 循环将退出。

在 While 循环中，它拆分每一行并检查 ID。如果匹配，它会使用列值填充变量并将 rowFound 标志设置为 True，从而结束循环。如果没有匹配，它增加 rowNumber 变量并查看下一行（如果有 - 如果没有，While 循环退出）。

如果要将值存储在 String 以外的类型中（您的第二列看起来是 DateTime），则可能需要进行一些转换。

无论如何，这应该让你朝着正确的方向前进。

# opengl - GLSL 330：下采样纹理

> ID：15534815
> 
> 赞同：2
> 
> 时间：2013-03-20T21:12:23.183
> 
> 标签：opengl, glsl, textures, downsampling

我想将输入纹理从 800x600 降低到本身的四分之一（200x150 像素）。但如果我这样做，我只能看到一小部分图像。框架着色器似乎没有对整个纹理进行采样。以下示例是创建景深效果。

顶点着色器：

```
#version 330

uniform UVertFrameBuffer
{
    mat4  m_ScreenMatrix;
};

uniform UDofInvertedScreenSize
{
    vec2 m_InvertedScreenSize;
};

// -----------------------------------------------------------------------------
// in variables
// -----------------------------------------------------------------------------

layout(location = 0) in vec3 VertexPosition;

// -----------------------------------------------------------------------------
// out variables
// -----------------------------------------------------------------------------

struct SPixelCoords
{
    vec2 tcColor0;
    vec2 tcColor1;
};

out SPixelCoords vs_PixelCoords;

// -----------------------------------------------------------------------------
// Program
// -----------------------------------------------------------------------------

void main()
{
    vec4 Position = vec4(VertexPosition.xy, 0.0f, 1.0f);

    vec4 PositionInClipSpace = m_ScreenMatrix * Position;
    vec2 ScreenCoords        = VertexPosition.xy;

    // -----------------------------------------------------------------------------

    vs_PixelCoords.tcColor0 = ScreenCoords + vec2(-1.0f, -1.0f) * m_InvertedScreenSize;
    vs_PixelCoords.tcColor1 = ScreenCoords + vec2(+1.0f, -1.0f) * m_InvertedScreenSize;

    // -----------------------------------------------------------------------------

    gl_Position = PositionInClipSpace;
} 
```

片段着色器：

```
#version 330

uniform sampler2D g_ColorTex;
uniform sampler2D g_DepthTex;

uniform UDofDownBuffer
{
    vec2  m_DofNear;
    vec2  m_DofRowDelta;
};

// -----------------------------------------------------------------------------
// Inputs per vertice
// -----------------------------------------------------------------------------

struct SPixelCoords
{
    vec2 tcColor0;
    vec2 tcColor1;
};

in SPixelCoords vs_PixelCoords;

// -----------------------------------------------------------------------------
// Output to graphic card
// -----------------------------------------------------------------------------

layout (location = 0) out vec4 FragColor;

// -----------------------------------------------------------------------------
// Program
// -----------------------------------------------------------------------------

void main() 
{
    // Initialize variables
    vec3  Color;
    float MaxCoc;
    vec4  Depth;
    vec4  CurCoc;
    vec4  Coc;
    vec2  RowOfs[4];

    // Calculate row offset
    RowOfs[0] = vec2(0.0f);
    RowOfs[1] = m_DofRowDelta.xy;
    RowOfs[2] = m_DofRowDelta.xy * 2.0f;
    RowOfs[3] = m_DofRowDelta.xy * 3.0f;

    // Bilinear filtering to average 4 color samples
    Color  = vec3(0.0f);
    Color += texture(g_ColorTex, vs_PixelCoords.tcColor0.xy + RowOfs[0]).rgb;
    Color += texture(g_ColorTex, vs_PixelCoords.tcColor1.xy + RowOfs[0]).rgb;
    Color += texture(g_ColorTex, vs_PixelCoords.tcColor0.xy + RowOfs[2]).rgb;
    Color += texture(g_ColorTex, vs_PixelCoords.tcColor1.xy + RowOfs[2]).rgb;
    Color /= 4.0f;

    // Calculate CoC
    ...

    // Calculate fragment color
    FragColor = vec4(Color, MaxCoc);
} 
```

输入纹理为 800x600，输出纹理为 200x150 像素。作为 m_InvertedScreenSize，我使用 1/800 和 1/600 像素。那正确吗？

我上传了两个三角形，它们代表 OpenGL 的屏幕坐标。

```
QuadVertices[][1] = { 
{ 0.0f, 1.0f, 0.0f, }, 
{ 1.0f, 1.0f, 0.0f, }, 
{ 1.0f, 0.0f, 0.0f, }, 
{ 0.0f, 0.0f, 0.0f, }, }; 

QuadIndices[][2] = { 
{ 0, 1, 2, }, 
{ 0, 2, 3, }, }; 
```

我的屏幕矩阵通过正交矩阵将这些顶点转换为裁剪空间。

```
Position(0.0f, 0.0f, 1.0f);
Target(0.0f, 0.0f, 0.0f);
Up(0.0f, 1.0f, 0.0f);

LookAt(Position, Target, Up);

SetOrthographic(0.0f, 1.0f, 0.0f, 1.0f, -1.0f, 1.0f); 
```

下图显示了输入纹理和结果。第一个是没有下采样的原始图像。其次是实际的下采样纹理。第三个是计算 ScreenCoords *= 4.0f; 的下采样纹理。

![这是进入着色器的纹理，应该向下采样。](../Images/f0ba1b84db4cf4aeb39391b3ae1c7f7c.png) ![下采样后的结果...](../Images/2ccf2028924bb7f6f720b76b78755ae5.png) ![我想拥有的形象。](../Images/fde319c95a9889a47b56ded4cb406a1f.png)

# mysql - mysql：从连接中返回多个 csv 列

> ID：15534817
> 
> 赞同：1
> 
> 时间：2013-03-20T21:12:26.807
> 
> 标签：mysql, database, group-concat

我有这个查询：

```
SELECT * 
FROM  `test` t
LEFT JOIN  `result` r ON r.test_id = t.id
LEFT JOIN  `parameter` p ON p.test_id = t.id 
```

返回：

```
id                name   id test_id      description    id test_id          name
 1 test w/o parameters    1       1 the first result  NULL    NULL          NULL
 1 test w/o parameters    2       1 the second result NULL    NULL          NULL
 2 test w/ paramters   NULL    NULL              NULL    1       2  command_line
 2 test w/ paramters   NULL    NULL              NULL    2       2        userid 
```

我想要返回的是：

```
id                name                             results           parameters
 1 test w/o parameters  the first result,the second result                 NULL
 2 test w/ paramters                                  NULL  command_line,userid 
```

我试图让 GROUP_CONCAT 工作，但 NULLS 被丢弃。有没有办法说服 GROUP_CONCAT 返回空值？

我真正想要的是这样的东西，但这都是错误的：

```
SELECT * , group_concat(r.description), group_concat(p.name)
  FROM `test` t 
  left join `result` r on r.test_id = t.id
  left join `parameter` p on p.test_id = t.id 
```

这将返回非 NULL 行：

```
SELECT * , group_concat(r.description)
  FROM `test` t 
  LEFT JOIN `result` r on r.test_id = t.id
  LEFT JOIN `parameter` p on p.test_id = t.id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:18:39.390

首先在子查询中将这些值连接在一起可能会更容易，然后将它们加入父表（[**DEMO**](http://www.sqlfiddle.com/#!2/43b3d/7)）：

```
SELECT t.id, t.name, r.results, p.parameters
FROM  `test` t
LEFT JOIN  (select test_id, group_concat(result) results
            from `result` r group by test_id) r ON r.test_id = t.id
LEFT JOIN  (select test_id, group_concat(name) parameters
            from `parameter` p group by test_id) p ON p.test_id = t.id; 
```

结果：

```
| ID |                NAME |                            RESULTS |          PARAMETERS |
---------------------------------------------------------------------------------------
|  1 | test w/o parameters | the first result,the second result |              (null) |
|  2 |   test w/ paramters |                             (null) | command_line,userid | 
```

# javascript - Dojo：如何真正从 NodeList 中删除/销毁节点

> ID：15534821
> 
> 赞同：0
> 
> 时间：2013-03-20T21:12:43.867
> 
> 标签：javascript, dojo

在这里，我有一个节点列表和一个要从列表中删除的已识别节点（既从视图中又在内存中）。

```
var currentRow = dojo.query(this).parents("div").first()[0];
var parentDiv = dojo.query(currentRow).parents("div").first()[0];
var rowList = dojo.query(parentDiv).children(); 
```

问题是，

```
dojo.destroy(currentRow); 
```

只`currentRow`从视图中删除，但是当我循环时`rowList`，从`firebug`我仍然可以看到 rowList 的大小是原始大小而不减去一个删除，所以它似乎留在内存中，所以我们如何从 nodeList 中删除一个节点并返回新节点列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T06:53:59.080

销毁节点不会操作`rowList`数组，它只是从 DOM 树中删除节点。这意味着您将`currentRow`节点*缓存*在`rowList`数组（以及`currentRow`变量）中。DOM 节点是 JavaScript 对象，当您从 DOM 树中删除它们时，如果它们无法访问，它们稍后会被 JavaScript 虚拟机收集起来。

在这种情况下，您只需要`rowList`在调用之后（或之后再次查询）`dojo.destroy`：

```
var currentRow = dojo.query(this).parents("div").first()[0];
var parentDiv = dojo.query(currentRow).parents("div").first()[0];

dojo.destroy(currentRow);
currentRow = null;

var rowList = dojo.query(parentDiv).children(); 
```

如果`currentRow`全局可达，则将其设置为`null`.

看看它在行动：http: [//jsfiddle.net/phusick/9MaUn/](http://jsfiddle.net/phusick/9MaUn/)

阅读 Addy Osmani 的[Writing Fast, Memory-Efficient JavaScript](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)了解更多信息。

# php - Wordpress 数据库上的 MySQL 查询

> ID：15534833
> 
> 赞同：0
> 
> 时间：2013-03-20T21:13:41.273
> 
> 标签：php, mysql, sql, database, wordpress

我想在 wordpress 数据库上进行 mysql 查询，以恢复最后 6 个帖子的标题和第一个图像链接。

不允许使用 Wordpress 核心功能，因为我想在外部网站上展示它们。换句话说，我需要纯 mysql 查询。

我能够以这种方式显示标题：

```
$result = mysql_query("select * FROM wp_posts WHERE post_status='publish' AND post_type='ad_listing' ORDER BY id desc limit 6" ,$db);
while ($records = mysql_fetch_assoc($result)) {
  echo '<li>'.$records['post_title'] ."</li>";
} 
```

但是如何恢复附加到这些帖子的第一张图片（如果存在）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:06:57.887

对于您在 wp_posts 表中的图像记录，post_parent 是否指向已发布的页面？我的没有，如果您的也没有，那么您需要搜索每个已发布页面的 post_content 字段，查找 img 标签（或您用于图像的任何标签）。

从我读过的其他文章来看，有时图像的 post_parent 似乎指向父页面。如果这对您的数据库是正确的，那么您应该能够执行以下操作：

```
SELECT 
    post.id AS post_id, 
    post.post_title, 
    post.guid AS post_url, 
    image_detail.id AS image_id, 
    image_detail.post_title AS image_title, 
    image_detail.guid AS image_url
FROM wp_posts AS post
LEFT JOIN (
    SELECT post_parent, MIN( id ) AS first_image_id
    FROM wp_posts
    WHERE post_type = 'attachment'
        AND post_mime_type LIKE 'image/%'
    GROUP BY post_parent
    ) AS image_latest 
    ON post.id = image_latest.post_parent
LEFT JOIN wp_posts AS image_detail 
    ON image_detail.id = image_latest.first_image_id
WHERE post.post_status = 'publish'; 
```

# iphone - TBXML 表格视图内容不更新

> ID：15534834
> 
> 赞同：0
> 
> 时间：2013-03-20T21:13:41.593
> 
> 标签：iphone, ios, objective-c, uitableview, tbxml

我有一个 UITableView，它从网络服务器内的 xml 文件加载内容。

*   TableView 位于标签栏控制器内；
*   `[table reloadData]`我在里面打电话`TBXMLSuccessBlock`；
*   问题是 TableView 的内容没有更新。
*   我正在使用 TBXML 库；

单击按钮后，如何向 tableVIew 说 XML 文件已下载并显示？

```
- (IBAction)leftButton:(UIButton *)sender {
    if (a<=2 && a != 0) {
        a = a - 1;

        NSString *leftURL = self.getDate;
        [self loadURL:leftURL];
    }

}

- (void)loadURL:(NSString *)newURL{

    if (newURL == NULL) {
        newURL = self.getDate;
    }

    // Create a success block to be called when the asyn request completes
    TBXMLSuccessBlock successBlock = ^(TBXML *tbxmlDocument) {
        NSLog(@"PROCESSING ASYNC CALLBACK");

        [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
        // If TBXML found a root node, process element and iterate all children
        if (tbxmlDocument.rootXMLElement)
        {
            // Obtain root element
            TBXMLElement * root = tbxml.rootXMLElement;
        if (root)
        {
            _storeArray = [NSMutableArray new];
            TBXMLElement * elem_PLANT = [TBXML childElementNamed:@"news" parentElement:root];
            while (elem_PLANT !=nil)
            {
                TBXMLElement * elem_title = [TBXML childElementNamed:@"title" parentElement:elem_PLANT];
                NSString *titleName = [TBXML textForElement:elem_title];

                TBXMLElement * elem_artist = [TBXML childElementNamed:@"text" parentElement:elem_PLANT];
                NSString *artistName = [TBXML textForElement:elem_artist];

                TBXMLElement * elem_thumb = [TBXML childElementNamed:@"thumb_url" parentElement:elem_PLANT];
                NSString *thumbName = [TBXML textForElement:elem_thumb];

                NSDictionary *dictionary = [[NSDictionary alloc]initWithObjects:@[titleName, artistName, thumbName] forKeys:@[@"title", @"text", @"thumb"]];
                elem_PLANT = [TBXML nextSiblingNamed:@"news" searchFromElement:elem_PLANT];
                [_storeArray addObject:dictionary];

            }

        }

          [_tableView reloadData];
        }
    };

    // Create a failure block that gets called if something goes wrong
    TBXMLFailureBlock failureBlock = ^(TBXML *tbxmlDocument, NSError * error) {
        NSLog(@"Error! %@ %@", [error localizedDescription], [error userInfo]);
    };

    // Initialize TBXML with the URL of an XML doc. TBXML asynchronously loads and parses the file.
    tbxml = [[TBXML alloc] initWithURL:[NSURL URLWithString:newURL]
                               success:successBlock
                               failure:failureBlock];
} 
```

**编辑：按钮点击内的 ReloadData**

```
- (IBAction)leftButton:(UIButton *)sender {
    if (a<=2 && a != 0) {
        a = a - 1;

        NSString *leftURL = self.getDate;
        [self loadURL:leftURL];
        [_tableView reloadData];
    }

    }

- (IBAction)rightButton:(UIButton *)sender {
    if (a<2) {
        a = a + 1;
        NSString *rightURL = self.getDate;
        [self loadURL:rightURL];
        [_tableView reloadData];
    }
} 
```

应用启动时： - 加载 1 号 URL；- 显示第 1 个 URL；当我单击一次右键时： - 加载了 2 号 URL；- 什么都没发生; 当我再右击一次时： - 加载了 3 号 URL；- 显示 2 号 URL；当我左键单击一次时： - URL 2 已加载；- 显示 URL 3；当我再单击一次时： - URL 1 已加载；- 显示 URL 2；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:11:29.953

你说：

> 应用启动时： - 加载 1 号 URL；- 显示第 1 个 URL；当我单击一次右键时： - 加载了 2 号 URL；- 什么都没发生; 当我再右击一次时： - 加载了 3 号 URL；- 显示 2 号 URL；当我左键单击一次时： - URL 2 已加载；- 显示 URL 3；当我再单击一次时： - URL 1 已加载；- 显示 URL 2；

由此，我们知道：

1.  URL/XML 加载工作——数据在那里显示，但显示没有在它应该发生的时候发生。
2.  表重新加载有效 - 在稍后按下按钮时，显示较早的数据，但显示不同的数据。
3.  表重新加载发生得太早了——这就是它显示先前 URL/XML 数据的原因。

您的按钮操作正在（间接）使用带有成功/失败块的库进行 URL 加载调用，因此大致如下：

1.  `loadUrl:`运行 TBXML 的IBAction 调用`initWithURL:success:failure:`
2.  `initWithURL:success:failure:`存储成功和失败块并在单独的线程（“在后台”）上启动实际的网络操作，然后返回，几乎可以肯定在网络操作完成之前。
3.  IBAction 调用`reloadData`.
4.  稍后，在后台，网络操作完成并运行成功或失败块。

因此，将`reloadData`调用移动到成功块中，以便在处理 XML 数据后重新加载表。

但最初这崩溃了一个错误，其中包括：

> 这可能是从辅助线程调用 UIKit 的结果。

UIKit 调用——粗略地说，任何影响用户界面的方法调用——都必须在主线程上进行。对于一些使用块回调的异步库（特别是 AFNetworking），正是因为这个原因，块回调才能保证在主线程上运行。显然，对于 TBXML，块回调在后台运行，可能在执行实际网络加载操作的同一线程上。所以，我们需要一些方法来`reloadData`调用`UITableView`主线程上的发生。

有几种方法可以做到这一点。我的首选通常是使用主操作队列（我们使用`mainQueue`类方法 on获得`NSOperationQueue`），这是在主线程上执行的操作队列：

```
[[NSOperationQueue mainQueue] addOperationWithBlock:^{
    [_tableView reloadData];
}]; 
```

然后，主操作队列会尽快在主线程上自动处理执行该块。或者，但仍处于 Objective-C/Cocoa/CocoaTouch 级别，您可以`performSelectorOnMainThread:withObject:waitUntilDone:`在表视图上使用：

```
[_tableView performSelectorOnMainThread:@selector(reloadData)
                             withObject:nil
                          waitUntilDone:NO]; 
```

（或者`YES`等到完成——在这种情况下可能无关紧要），这具有完全相同的效果。第三种选择，虽然在这种情况下通常不是首选，但直接使用 Grand Central Dispatch：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [_tableView reloadData];
}]; 
```

（但是当有更高级别的选项时，如`NSOperationQueue`route 或`performSelectorOnMainThread:withObject:waitUntilDone:`route，应该使用它们来代替这种较低级别的 C Grand Central Dispatch 例程；另外，更改`dispatch_async`为与前面示例中更改为`dispatch_sync`的效果相同） .`waitUntilDone:NO``waitUntilDone:YES`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-23T04:40:56.847

正如你所说，你有调用方法 reloadData 然后它应该刷新表格视图..我认为问题不存在，你是否尝试过不使用标签栏控制器的人..有时可能会出现标签栏控制器问题。 ..所以只需尝试一次..&让我们知道..或者我们以其他方式帮助你

# sql-server - 将字符串转换为日期时间

> ID：15534839
> 
> 赞同：0
> 
> 时间：2013-03-20T21:13:50.450
> 
> 标签：sql-server, tsql, datetime, casting

此时间戳作为字符串保存到表中。查询表时如何将其转换为日期时间类型？

例如：

```
declare @timestamp as nvarchar
set @timestamp ='20130319092507.000000-000' 
```

我已经尝试`convert(datetime, timestamp, *n*)`过`cast(timestamp as datetime)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:22:35.880

我的第一个建议：修好你的桌子！停止将日期/时间值存储为字符串。不会有什么好事。例如，该列可能具有`20130231`or`Hallowe'en`或`This is not a date`，您现在必须将它们过滤掉。除了固有的验证之外，您还失去了执行日期操作的能力。

```
DECLARE @timestamp VARCHAR(32);
SET @timestamp = '20130319092507.000000-000';

SELECT CONVERT
(
  DATETIME, 
  LEFT(@timestamp, 8) + ' ' 
  + STUFF(STUFF(SUBSTRING(@timestamp,9,6),3,0,':'),6,0,':')
); 
```

# c - 将 STDIN 重定向到套接字，将套接字重定向到 STDOUT

> ID：15534841
> 
> 赞同：3
> 
> 时间：2013-03-20T21:13:55.807
> 
> 标签：c, sockets, file-descriptor

我正在尝试为服务器开发一个简单的命令行客户端。在我连接到服务器并正确设置所有内容后，我想重定向`STDIN`到连接到服务器的套接字和相同的套接字到`STDOUT`. 我想实现类似于 of`nc`工具的行为。

最简单的解决方案是使用`select()`和使用`read()`/`write()`将数据从`STDIN`套接字传递到`STDOUT`.

有没有其他更简单的方法可以以某种方式将套接字连接到`STDIN`/`STDOUT?`我想使用`dup2()`系统调用。但是，我不确定如何使它工作。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T10:43:28.200

在 Linux 上，您可以使用`splice(2)`在内核级别的文​​件描述符之间移动数据。但是，您仍然必须使用`select(2)`（或等效的）并行处理两个方向，或者使用两个线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:51:53.203

另一种可能性是在你的程序中进行协议握手，一旦套接字准备好，就执行一个程序`socat`来执行数据转发。

例如，调用`dup2`将套接字复制到文件描述符 3，取消其 close-on-exec 标志，然后取消 exec `socat STDIO FD:3`。

# perl - Mojo::UserAgent TLS/SSL 证书认证

> ID：15534849
> 
> 赞同：2
> 
> 时间：2013-03-20T21:14:22.940
> 
> 标签：perl, mojolicious

我是 Mojolicious 的新手，我正在尝试获取 Mojo::UserAgent 脚本以同时使用 TLS 证书颁发机构和 TLS 证书文件，但证书文件受密码保护。我在传递密码时遇到问题，因此可以打开客户端证书。

我有以下代码：

```
 #!/usr/bin/env perl

use Modern::Perl;
use Mojo::UserAgent;

IO::Socket::SSL::set_defaults(SSL_passwd_cb => sub {return "password";});
my $ua = Mojo::UserAgent->new;
my $base_dir = '/path/to/certs/';
$ua->ca($base_dir . 'ca-cert.crt');
$ua->cert($base_dir . 'clientcert.crt');
my $tx = $ua->build_tx(POST => '/POST HTTP/1.1');
$tx->req->url->parse('https://example.com:12345');
$ua->start($tx);

if(my $res = $tx->success) {
  say $res->body;
  print Dumper($tx);
} else {
  my ($err, $code) = $tx->error;
  say $code ? "$code response: $err" : "Connection error: $err";
} 
```

我已使用以下内容验证了证书：

`openssl s_client -connect host:port -CApath /path/to/cert - CAfile ca-cert.crt -cert clientcert.crt`

我收到提示：

`Enter pass phrase for clientcert.crt:`

我输入密码并正确验证。

那么，如何获取 IO::Socket::SSL 的密码呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T15:55:34.420

我找到了一个解决方案（并报告了这个问题），所以现在你可以用以下方法解决这个问题。

在 Mojo::IOLoop::Client 中更改了以下内容：

```
SSL_key       => $args->{tls_key},
#SSL_key_file       => $args->{tls_key}, 
```

然后，您可以使用以下代码进行身份验证：

```
#!/usr/bin/env perl

use Modern::Perl;
use Mojo::UserAgent;

my $ua = Mojo::UserAgent->new;
my $base_dir = '/path/to/certs/';
$ua->ca($base_dir . 'ca-cert.crt');
$ua->cert($base_dir . 'clientcert.crt');

my $bio = Net::SSLeay::BIO_new_file($base_dir . 'clientcert.crt', 'r');
my $privkey = Net::SSLeay::PEM_read_bio_PrivateKey($bio, undef, 'password');
$ua->key($privkey);

my $tx = $ua->post('https://example.com:12345');

if(my $res = $tx->success) {
  say $res->body;
  print Dumper($tx);
} else {
  my ($err, $code) = $tx->error;
  say $code ? "$code response: $err" : "Connection error: $err";
} 
```

# php - 如何使用 cron 作业让 php 脚本运行 4 到 5 天？

> ID：15534860
> 
> 赞同：0
> 
> 时间：2013-03-20T21:15:06.150
> 
> 标签：php, codeigniter, cron, crontab

我在 codeignitor 框架中有一个 php 脚本。它适用于复杂的计算算法，需要让脚本运行至少 4 到 5 天。但它在运行几个小时后停止。我怎样才能让它继续运行直到脚本完成？

cron 命令：

```
13 21 * * * /usr/bin/php /var/www/project/index.php 'test/mytest' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:20:02.603

也许它取决于`max_execution_time`php.ini

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:34:12.250

我认为你应该使用 GNU screen 来做这件事。启动一个屏幕，启动你的 PHP 脚本，分离屏幕。它会一直运行，直到你杀死屏幕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:22:14.527

`set_time_limit(0);`将删除 PHP 内置的超时安全协议。请注意，如果脚本运行时间过长，还有更多因素，例如系统中断和 apache/webpanel 协议，可能仍会中止脚本。例如，即使您取消了超时限制，某些网络托管服务商仍会中止您的脚本。

祝测试顺利！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T21:22:52.453

您可以将 max_execution_time 设置为 432000

但是由于总是有其他东西可以阻止你的脚本，我会考虑让它的中断变得健壮。

# oracle11g - ORA-00979: not a GROUP BY expression 错误，如何解决？

> ID：15534868
> 
> 赞同：2
> 
> 时间：2013-03-20T21:15:35.120
> 
> 标签：oracle11g, ora-00979

```
SELECT ssn, fname, minit, lname, AVG(hours)
FROM EMPLOYEE, WORKS_ON
WHERE EMPLOYEE.ssn = WORKS_ON.essn
GROUP BY hours
ORDER BY AVG(hours) DESC 
```

它显示 ORA-00979 错误：不是 GROUP BY 表达式

我想知道为什么它不起作用？顺便说一句，所有表都存在并且没有任何错误。它在 Oracle AE 11g ===========UPDATE========================== 请求的表

```
SSN FNAME   MINIT   LNAME   AVG(HOURS)
888665555   James   E   Borg    -
666884444   Ramesh  K   Narayan 40
999887777   Alicia  J   Zelaya  20
987987987   Ahmad   V   Jabbar  20
453453453   Joyce   A   English 20
123456789   John    B   Smith   20
987654321   Jennifer    S   Wallace 17.5
333445555   Franklin    T   Wong    7.33333333333333333333333333333333333333 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:17:14.443

我认为您的意思`GROUP BY`是聚合列：

```
SELECT ssn, fname, minit, lname, AVG(hours)
FROM EMPLOYEE, WORKS_ON
WHERE EMPLOYEE.ssn = WORKS_ON.essn
GROUP BY ssn, fname, minit, lname
ORDER BY AVG(hours) DESC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T21:17:26.197

我认为你的分组与你需要的完全相反。你要：

```
SELECT ssn, fname, minit, lname, AVG(hours)
FROM EMPLOYEE, WORKS_ON
WHERE EMPLOYEE.ssn = WORKS_ON.essn
GROUP BY ssn, fname, minit, lname
ORDER BY AVG(hours) DESC 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:17:12.490

由于您使用的是聚合函数`AVG(hours)`，因此您需要对其余结果进行分组：

```
SELECT ssn, fname, minit, lname, AVG(hours)
FROM EMPLOYEE, WORKS_ON
WHERE EMPLOYEE.ssn = WORKS_ON.essn
GROUP BY ssn, fname, minit, lname
ORDER BY AVG(hours) DESC 
```

# drupal - 如何将自动完成添加到 Drupal 的核心搜索表单？

> ID：15534871
> 
> 赞同：1
> 
> 时间：2013-03-20T21:15:40.570
> 
> 标签：drupal, drupal-7

我说的是在核心搜索表单上启用的 jQuery UI 的自动完成功能。

处理程序应该从数据库查询（我已经保存在现有字段中的短标题）返回建议的术语。

我知道有一堆 contrib 模块可以让你创建一个自动完成字段，但他们似乎没有将它应用于核心搜索表单。不过我可能是错的。

以下是我发现最有帮助的两篇文章：

[http://timonweb.com/how-create-ajax-autocomplete-textfield-drupal-7](http://timonweb.com/how-create-ajax-autocomplete-textfield-drupal-7)

[http://drupal.org/node/42552](http://drupal.org/node/42552)

有没有其他人实现过这个？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:27:18.243

您是否尝试过[搜索自动完成](http://drupal.org/project/search_autocomplete)您必须进行一些配置。我没有完全理解它，但最初使用它给出了它会解决你的问题的想法。

只需查看其文档以获取更多详细信息。

# c# - 使用winforms为excel单元格着色

> ID：15534878
> 
> 赞同：1
> 
> 时间：2013-03-20T21:15:57.020
> 
> 标签：c#, winforms, visual-studio-2010, excel, export-to-excel

嗨，我想将几​​个按钮的颜色导出到 excel 中，这些按钮代表一个网格并且是动态创建的。

导出到 Excel 时，我的代码似乎给了我颜色的名称，而不是单元格的实际颜色。

```
for (int i = 0; i < row; i++)
{   
     for (int j = 0; j < col; j++)
     {
          worksheet.Cells[i + 2, j + 1] = (buttons[i][j].BackColor); 
     }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:32:47.907

您应该使用以下代码：

```
for (int i = 0; i < row; i++)
{   
     for (int j = 0; j < col; j++)
     {
        Range range = worksheet.Cells[i + 2, j + 1];
        range.Interior.Color = buttons[i][j].BackColor.ToArgb();
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:28:43.113

您可以尝试分配背景颜色吗？= 颜色.红色

```
DataGridView1.Rows(4).DefaultCellStyle.BackColor = Color.Red 
```

我的意思是，如果您要获得颜色的名称，请将其分配给背面颜色。不是一个好的解决方案，但将其视为一种解决方法

# python - 在 Python 交互式会话中禁用自动打印

> ID：15534880
> 
> 赞同：1
> 
> 时间：2013-03-20T21:16:05.360
> 
> 标签：python, python-2.7, python-interactive

我将举办一个 Python 研讨会，在我的大学 Python 教授一些初级程序员。

我正在寻找一种方法来修改 Python 交互式会话的默认行为，以便表达式不会自动打印出结果。例如，采取以下交互式会话：

```
wil@calcifer:~$ python
Python 2.7.3 (default, Aug  1 2012, 05:16:07)
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> x = 5
>>> y = 7
>>> x + y
12
>>> first_name = "Test"
>>> last_name = "Person"
>>> first_name + last_name
'TestPerson'
>>> 
```

这将强制使用该`print`语句以避免以后混淆。这并不重要，但令我惊讶的是，我无法在任何地方找到任何设置。

我将能够预先配置机器，所以任何解决方案都可以工作。有谁知道这是否可能，或者交互式会话的哪些更改会产生这种效果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T21:50:02.637

交互式会话中的表达式打印通过调用 `sys.displayhook`. 只需将其覆盖为 NOP：

```
>>> import sys
>>> sys.displayhook = lambda x: None

>>> 2 + 3
>>> print 2 + 3
5
>>> 
```

在普通的 Python 会话中，它连接到 sys.stdout。在 GUI 上提供 Python shell 的应用程序预计会使用它来将表达式值打印回用户。

默认情况下，每次调用解释器时，您都可以编写您的 pythonrc.py（~/.pythonrc.py 文件）来执行此操作。可以在此处找到有关 sys.displayhook 的更多文档：http: [//docs.python.org/3/library/sys.html#sys.displayhook](http://docs.python.org/3/library/sys.html#sys.displayhook)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:29:12.517

我不认为你可以配置 shell 来抑制表达式的结果，但是如果你只是将每个表达式分配给一个变量，它会起作用吗？然后它不会打印任何东西......

例如

```
x=5
y=7
z = x+y 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:51:19.627

我知道你来这里不是为了教学建议，但是没有输出，该怎么`x + y`办？如果您不希望将值输出或存储在任何地方，为什么还要输入它？

你的学生会困惑：“做`x + y`什么？”

如果你想显示一些表达式，只需`print`在它前面始终放置一个语句，或者将它分配给一个值。

我发现人们经常反过来混淆，以至于他们不知道这`return`实际上给了他们价值，他们总是想使用`print`. 不要忘记您可以交互地定义函数，并将返回值放在那里。然后您可以向他们展示该函数返回该值，即使没有`print`s。

# iis - URL 重写 - REMOTE_USER 始终为空

> ID：15534881
> 
> 赞同：1
> 
> 时间：2013-03-20T21:16:06.563
> 
> 标签：iis, iis-7

我需要创建一个 URL 重写规则，将 REMOTE_USER 值添加到查询字符串中。我将我的应用程序简化为绝对必需品。但是，在评估规则条件时，REMOTE_USER 始终为空。

我的网站在 IIS 7 中配置，应用程序池使用 .NET 2.0 的集成模式。我禁用了匿名身份验证并通过 IIS 管理器在站点上启用了 Windows 身份验证，我什至将这一行添加到 web.config 以防止匿名访问。这是我的两个文件。

网络配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer> 
        <security> 
            <authorization> 
                <remove users="?" roles="" verbs="" />
            </authorization>
        </security>
        <rewrite>
            <rules>
                <clear />
                <rule name="Add login into URL" stopProcessing="true">
                    <match url=".*" />
                    <conditions logicalGrouping="MatchAll" trackAllCaptures="true">
                        <add input="{QUERY_STRING}" pattern="login" negate="true" />
                        <add input="{REMOTE_USER}" pattern="(.*)" />
                    </conditions>
                    <action type="Redirect" url="{HTTP_URL}?login={C:1}" redirectType="Temporary" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

默认的.asp

```
<%= Request.ServerVariables("REMOTE_USER") %> 
```

我的规则永远不会命中，因为在评估条件时 {REMOTE_USER} 总是空白（其他服务器变量显示在规则中，所以它只是 {REMOTE_USER}）。不同之处在于 default.asp 显示了我的 REMOTE_USER 值。

任何建议为什么会发生这种情况？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:21:32.380

我不知道为什么我之前没有找到这个链接。正如我所怀疑的，auth 在 URL 重写规则之后运行，并且 REMOTE_USER 不能用于重定向。我想我必须编写自己的重定向模块。

[http://forums.iis.net/t/1155169.aspx/1](http://forums.iis.net/t/1155169.aspx/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T13:58:42.397

那么，你解决了吗？

显然，在某些情况下，C# 的[ServerVariables](http://msdn.microsoft.com/en-us/library/system.web.httprequest.servervariables.aspx)已被贬低。

如果这是你的情况，你需要这样做：

```
string login = System.Security.Principal.WindowsIdentity.GetCurrent().Name; 
```

如果您真的想使用 ServerVariables，请记住它们在 C#中对**CaSe 敏感。**正确的大小写几乎总是*UPPER*，这是它们的列表：

[服务器变量列表](http://msdn.microsoft.com/en-us/library/ms524602.aspx)

# jquery - 灯箱，屏幕褪色但图片未显示

> ID：15534884
> 
> 赞同：0
> 
> 时间：2013-03-20T21:16:17.410
> 
> 标签：jquery, lightbox

我正在尝试为朋友制作图片网站，[http://www.johnny.no](http://www.johnny.no)

我有 lightbox.js，当我点击图片时，屏幕会变黑，但图片不会显示。网站上还使用了砖石，但我没有看到其他人对这两者有兼容性问题。我会怀疑一些 CSS 错误，但我一直在挠头，因为我的头发正在稀疏。

有任何想法吗？

# asp.net - 输出json时针对@variable的Response.Write

> ID：15534889
> 
> 赞同：0
> 
> 时间：2013-03-20T21:16:25.230
> 
> 标签：asp.net, ajax, json, asp.net-webpages

ASP.NET 网页 2 示例 api.cshtml 文件：

此代码返回由 jquery $.ajax 调用识别的正确 json：

```
@{
    var data1 = AppFunctions.PerformSelect(AppState["U1select"].ToString());
    var jsondata = Json.Encode(data1);
    Response.ContentType = "application/json; charset=utf-8";
    Response.Write(jsondata);
} 
```

但事实并非如此。为什么？

```
@{
    var data1 = AppFunctions.PerformSelect(AppState["U1select"].ToString());
    var jsondata = Json.Encode(data1);
    Response.ContentType = "application/json; charset=utf-8";
}
@jsondata 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:28:07.447

我认为这与 Razor 而不是 json 输出问题有关 - 请参阅[此答案](https://stackoverflow.com/a/5611858/74309)。

而不是`Response.Write(jsondata)`你用过`Html.Raw(jsondata)`or`Html.Output(jsondata)`吗？

# mysql - 如何使用 mysql 查询获得前 5 个选定项目？

> ID：15534891
> 
> 赞同：0
> 
> 时间：2013-03-20T21:16:32.577
> 
> 标签：mysql, sql, join

我有一个表格 **submit_answers**和一个表格**answers**

在**submit_answers**我有*id*，并且*ans*字段 *ans*是一个 varchar(255) 字段，其中包含逗号分隔的数据，例如“18,19,20,22,23,25”

所有这些数字都与**答案表中的***id*相关示例表结构

 **```
submitted_answers
id (int)    ans(varchar(255))
1           "18, 19"
2           "21, 22"

answers
id  ans
18  "Money"
19  "Gold"
20  "Whatever"
21  "Whatever2" 
```

我如何加入这些表格并查看哪些前 5 个项目出现在 submit_answers 中**最多**。*ans*字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:31:12.763

诚然，您的数据库结构非常棒。您不应该在关系数据库中将 id 列表表示为逗号分隔的字符串。

也就是说，您可以通过巧妙地使用该`on`子句来做您想做的事情：

```
select a.id, a.ans, count(*) as cnt
from submitted_answers sa join
     answers a
     on concat(', ', sa.ans, ', ') like concat('%, ', a.id, ', %')
group by a.id, a.ans
order by cnt desc
limit 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:31:01.003

干得好：

```
 SELECT answer_num, COUNT(*) AS magnitude 
FROM answers 
GROUP BY answer_num 
ORDER BY magnitude DESC
LIMIT 5 
```

工作示例： [http ://sqlfiddle.com/#!2/80a68/2](http://sqlfiddle.com/#!2/80a68/2)

请注意我在那里设置数据库的方式，您可能需要考虑这种类型的设置来处理用户和用户答案的​​多对多关系。**

# c++ - Hadoop 是否有优雅的 C++ API？

> ID：15534893
> 
> 赞同：3
> 
> 时间：2013-03-20T21:16:40.803
> 
> 标签：c++, hadoop

有没有办法从 C 或 C++ 向 Hadoop 提交 Map/Reduce 作业？

类似这样的东西，但在 C++ 中（这是 java 代码）：

```
 Configuration config = new Configuration();

    JobConf job = new JobConf(config);
    job.setJarByClass(MyFirstJob.class);
    job.setJobName("My first job");

    FileInputFormat.setInputPaths(job, new Path(args[0));
    FileOutputFormat.setOutputPath(job, new Path(args[1]));

    job.setMapperClass(MyFirstJob.MyFirstMapper.class);
    job.setReducerClass(MyFirstJob.MyFirstReducer.class);

    JobClient.runJob(job); 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-04-08T14:29:01.403

[Google 发布了一个名为MR4C](http://google-opensource.blogspot.fr/2015/02/mapreduce-for-c-run-native-code-in.html)的开源框架，用于在 Hadoop 上运行 C 或 C++ 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:55:12.790

您可以使用配置 xml 并执行作业，以获取有关如何从 C++ 执行作业的更多信息，请参阅 [Running C++ Programs on Hadoop](http://cs.smith.edu/dftwiki/index.php/Hadoop_Tutorial_2.2_--_Running_C++_Programs_on_Hadoop) 或 [C/C++ MapReduce Code & build](http://wiki.apache.org/hadoop/C++WordCount#Execute)

# css - Sinatra 中的 css.erb 文件

> ID：15534896
> 
> 赞同：3
> 
> 时间：2013-03-20T21:16:47.363
> 
> 标签：css, ruby, amazon-s3, sinatra, assets

例如，是否可以在 Sinatra 中有一个 css.erb 文件来提供来自 AWS 的图像。我正在从 AWS 中提取我的静态资产，并且可以在我的视图中提取图像，例如

```
<%= image_tag( aws_asset "/assets/img/banner2.jpg") %> 
```

aws_asset 是设置 AWS url 的助手

```
helpers do
 def aws_asset( path )
 File.join settings.asset_host, path
 end
end

configure :development do 
 set :asset_host, "https://s3-eu-west-1.amazonaws.com/#{ENV['FOG_DIRECTORY']}" 
end 
```

所以问题是我如何从我的 css 文件中获取背景图像以从 AWS 中提取该图像

编辑

当前设置

我的应用程序.rb

```
get "/assets/css/style.css" do
erb :style 
end 
```

布局.erb

```
<%= stylesheet_link_tag  "/assets/css/style.css"  %> 
```

样式.css

```
body {
background: url('<%= aws_asset "/assets/img/banner1.jpg" %>');

} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:31:26.770

由于您已经为此使用 ERB：

```
body
{
  background-image:url('banner2.jpg');
} 
```

会成为：

```
body
{
  background-image:url('<%= aws_asset "/assets/img/banner2.jpg" %>');
} 
```

这就是简单的答案。但是，由于您可能要从 AWS 提供相当多的文件，然后在您需要的所有不同地方使用帮助程序可能会变得令人厌烦，而且也很困难 - 也许您将来会想要预编译 CSS 等等。这是什么时候使用 Rack 中间件隐藏一些实现是个好主意。

```
module MySinatraApp

  # A remote file called banner2.jpg would have the relative path
  # in the app of "/images/extra/banner2.jpg"
  # and on being requested, this middleware/app would check if
  # the remote file is in the list you've given
  # if it is, a 307 redirect is issued.
  # If it isn't, then a 404\. Use with Rack::Cascade to pass on
  # to another app that may serve a local version of the file.
  # @example
  #   use RemoteImageServer, 
  #       :asset_host => "//s3-eu-west-1.amazonaws.com"
  #       :files      => ["banner2.jpg", "blah.gif"]
  class RemoteImageServer
    DEFAULT_OPTIONS = {
      subdir:        "images/extra",
      cascade:       false # until I work it out more, see note at bottom
    }

    def initialize(app,options={})
      app, options = app, DEFAULT_OPTIONS.merge(options)
      @asset_host = options[:asset_host]
      files = options[:files]
      @subdir = options[:subdir]
      @http_path_files = files.map{|file| File.join @subdir, file }
    end

    def call( env )
      dup._call( env ) # for thread safety
    end

    def _call( env )
      request = Rack::Request.new env
      if request.path_info.start_with? @subdir
        response = Rack::Response.new env
        if @http_path_files.include? request.path_info
          response.redirect File.join(@asset_host,request.path_info), 307
          response.finish
        else
          if @options[:cascade]
            response.status = 404
            response.finish
          end
        end
      else
        @app.call env
      end
    end
  end

  class MainApp < Sinatra::Base do
    # other stuff here…
  end

end 
```

您可以[在 Sinatra Application](http://www.sinatrarb.com/intro#Rack%20Middleware)或 rackup 文件中使用它。我更喜欢后者~~并使用[Rack::Cascade](http://rack.rubyforge.org/doc/classes/Rack/Cascade.html)：~~

~~运行 Rack::Cascade.new([MySinatraApp::RemoteImageServer, MySinatraApp::MainApp])~~（我不确定在使用级联时如何最好地传递选项，我可能需要更多地考虑这一点）。

```
 use RemoteImageServer, 
    :asset_host => "//s3-eu-west-1.amazonaws.com"
    :files      => ["banner2.jpg", "blah.gif"]
  run MySinatraApp::MainApp 
```

这样，远程主机就“隐藏”在了相对 url 后面，您可以用本地文件替换远程文件，或者轻松更改远程提供程序。最后的 Sinatra 应用程序仍将提供其公用文件夹中的任何本地文件。不过，这段代码完全未经测试！可能有一个 Rack 中间件已经这样做了（[Rack Static Fallback](https://rubygems.org/gems/rack-static_fallback)可能很接近）。

* * *

编辑：通过 ERB 提供 CSS。

主要有2种方式：

*   预编译 CSS 并通过`public_folder`.
*   从`get`路线上服务。

### 预编译 CSS

可能有一个 gem 或其他东西可以做到这一点（可能是一个[Guard](https://github.com/guard/guard)助手或其他东西），但这将在控制台中工作：

```
require 'erb'
require 'tilt'
template = Tilt.new( "path/to/erb/file" )
File.open "app/public/stylesheets/main.css", "w" do |f|
  f.write template.render
end 
```

由于编译后的 CSS 文件将驻留在 Sinatra 的公共目录中，因此它将作为静态文件提供。由于您在`aws_asset`文件中获得了来自 Sinatra 的帮助程序，因此您需要稍微更改它，或者在运行它之前在控制台中重新定义帮助程序，或者对路径进行硬编码，或者[将其传递给变量](https://github.com/rtomayko/tilt#basic-usage)。

### 从 Sinatra 获取路线上提供服务

```
get "/css/main.css" do
  erb :main # it will server main.erb from the views directory
            # and it will have access to helpers.
end 
```

由于它是一个不会经常更改的文件，因此您最好添加[缓存控制标头](http://www.sinatrarb.com/intro#Cache%20Control)。

# python - 两个具有相同比例的 y 轴

> ID：15534898
> 
> 赞同：3
> 
> 时间：2013-03-20T21:16:50.350
> 
> 标签：python, matplotlib

我用两个 y 轴和两个数据集做了一个直方图，但我无法将两个 y 轴的比例设置为相同的限制。

在这个例子中[http://matplotlib.org/examples/api/two_scales.html#api-two-scales](http://matplotlib.org/examples/api/two_scales.html#api-two-scales)的想法是让两个比例都从 0 到 25.000。

有人对这个案子有想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T21:21:57.703

您是否尝试过类似的方法：

```
...
ax2 = ax1.twiny()
a,b = 0,25000
ax1.set_ylim(a,b)
ax2.set_ylim(a,b) 
```

# c++ - 简单的 x86-64 C++ 内联汇编“Hello World”示例

> ID：15534899
> 
> 赞同：0
> 
> 时间：2013-03-20T21:16:55.593
> 
> 标签：c++, linux, assembly, x86-64, inline-assembly

我试图找到一个非常基本的 C++ 内联 x86-64 汇编示例，类似于：

[C/C++ 中的简单“Hello World”内联汇编语言程序](https://stackoverflow.com/questions/2179183/a-simple-hello-world-inline-assembly-language-program-in-c-c)

```
char msg[] = "Hello, world";

asm {
    mov ax,4       // (I/O Func.)
    mov bx,1       // (Output func)  
    lds cx, msg   // (address of the string)
    mov dx,6       //  (lenght of the string)
    int 0x21       // system call
} 
```

这将与英特尔编译器一起使用。有人可以帮忙吗？

编辑关于操作系统我在 Windows 和 Linux 上有 ICC - 让我们说 Linux！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:36:20.653

您发布的代码是 16 位代码。64 位 Windows（或任何版本的 Linux）不支持 16 位代码。[而且有点问题，因为它将长度设置为 6，而字符串的实际长度是 12...]

您可能会弄清楚如何在 Windows 代码中做同样的事情，但我看不到学习如何从汇编程序中进行系统调用的意义。编写一些代码来做一些你可以在现实生活中实际应用的事情，例如计算字符串中的字符数。

当然，您将需要使用 Intel 或 GCC 编译器，因为 Microsoft 编译器不允许在 64 位模式下使用内联汇编程序。

这是使用“读取时间戳计数器”指令的内联汇编程序的一个小示例，它将与 gcc 编译器一起使用（并且通过兼容性也应该与英特尔编译器一起使用）。

```
static __inline__ unsigned long long rdtsc(void)
{
    unsigned hi, lo;
    __asm__ __volatile__ ("rdtsc" : "=a"(lo), "=d"(hi));
    return ( (unsigned long long)lo)|( ((unsigned long long)hi)<<32 );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T05:23:41.727

AT&T 与英特尔汇编格式。

```
at&t noprefix                   intel
mov eax, -4(ebp,edx,4)          mov DWORD PTR[-4 +ebp +edx *4], eax
mov eax, -4(ebp)                mov DWORD PTR[-4 +ebp], eax
mov edx, (ecx)                  mov DWORD PTR[ecx], edx
lea (   ,eax,4), eax            lea eax, DWORD PTR[8 + eax*4]
lea (eax,eax,2), eax            lea eax, DWORD PTR[eax*2+eax] 
```

或这个。

```
asm(".intel_syntax noprefix");
asm("mov eax, ebx");

asm(".att_syntax prefix");
asm("mov %ebx, %eax"); 
```

AT&T 语法。

```
int main(int argc, char *argv[])
{
int x=1, f=2, fa=3;
asm("int $0x3");
asm("mov 4%0,%%eax"::"m"(x));
asm("movss 4%0,%%xmm1"::"m"(f));
asm("fld 4%0"::"m"(fa));
return 0;
} 
```

请注意，其中一个区别是“%”的使用和分配给寄存器的方向。

更多讨论[here](https://stackoverflow.com/questions/972602/att-vs-intel-syntax-and-limitations)和[here](http://wiki.osdev.org/Inline_Assembly)。其中大部分与调试有关。

# ruby-on-rails - 在 Excel 文档中按名称提取单元格值

> ID：15534901
> 
> 赞同：0
> 
> 时间：2013-03-20T21:17:00.880
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我想通过使用单元格名称而不是使用单元格引用（行、列）从 Excel 电子表格中提取一些值。

这样做的原因是因为用户想要修改他们的 Excel（添加或删除行/列）并且不想照顾我的 rails 进程的单元格引用。我认为另一种方法是在 Excel 电子表格中使用单元格命名功能。

有没有办法做到这一点？

如果是，哪种 GEM 解析器是最好的（电子表格、roo 等）？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-23T18:14:52.107

我制作了一个由单个单元格组成的命名范围。

我的函数中的逻辑现在没有改变，以满足您的要求：

```
Function CallFunctionFromExternalExtract() As Variant

    CallFunctionFromExternalExtract = Application.Names("MyRangeName").RefersToRange.Formula

End Function 
```

如果它可以启用宏，您应该可以从您的提取程序中调用它。

# c# - 将文件复制到 .jar 文件会导致错误

> ID：15534902
> 
> 赞同：1
> 
> 时间：2013-03-20T21:17:10.847
> 
> 标签：c#, java

我正在尝试使用 C# 方法将 zip 文件复制到 jar 文件中，如下所示：

```
ProcessStartInfo start = new ProcessStartInfo();
start.FileName = "java.exe";
start.WorkingDirectory = @"C:\mydir\";
start.Arguments = @" -jar example.jar example.zip";
Process java = new Process();
java.StartInfo = start;
java.Start();

var stdOut = java.StandardOutput.ReadToEnd();
java.WaitForExit();
Console.WriteLine(java.ExitCode.ToString()); 
```

问题是我收到此错误：

**错误：无法访问 jarfile example.jar**

我已经确认 example.jar 和 example.zip 都存在于工作目录中，并且还编写了一个批处理文件，我可以运行并创建一个几乎相同的 .jar 文件：

```
jar -cf example.jar test.zip 
```

我能够在没有问题的情况下运行此代码：

```
const string batchFile = @"C:\mydir\batJar.bat";
System.Diagnostics.Process.Start(batchFile); 
```

我的环境变量（Windows 7）也设置正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:31:46.430

您的批处理文件使用可执行文件“jar”，但您的 C# 程序使用可执行文件“java.exe”。

尝试：

```
start.FileName = "jar"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T15:32:57.340

Changing lines:

2-FileName

AND

4-Arguments

fixed my problem:

```
 ProcessStartInfo start = new ProcessStartInfo();
  start.FileName = "jar";
  start.WorkingDirectory =@"C:\myDir";
  start.Arguments = @" cf myJar.jar test.zip";**
  start.UseShellExecute = false;
  start.RedirectStandardInput = true;
  start.RedirectStandardOutput = true;

  Process java = new Process();
  java.StartInfo = start;
  java.Start();

  var stdOut = java.StandardOutput.ReadToEnd();
  java.WaitForExit();
  Console.WriteLine(java.ExitCode.ToString()); 
```

Thanks everyone for your help.

# javascript - 为什么 firebase 集合似乎以空行开头？

> ID：15534917
> 
> 赞同：24
> 
> 时间：2013-03-20T21:17:48.703
> 
> 标签：javascript, rest, firebase

![firebase 示例数据库](../Images/8c20536883ec6d2b60b0a5eab6d8e450.png)

我创建了一个简单的 firebase 数据集来测试一些 REST 调用（见下图）。我想知道为什么，当我查询数据库中的集合时，firebase 总是先返回一个空行，然后才是实际的行。这是我导出数据时得到的结果。注意系统和系统类型下的空行：

```
{
  "systems" : [ null, {
    "system_type_id" : 2,
    "name" : "Commodore 128",
    "id" : 1
  }, {
    "system_type_id" : 1,
    "name" : "Difference Engine",
    "id" : 2
  }, {
    "system_type_id" : 2,
    "name" : "Osborne",
    "id" : 3
  } ],
  "system_types" : [ null, {
    "name" : "Babbage",
    "id" : 1
  }, {
    "name" : "Von Neumann",
    "id" : 2
  } ]
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-20T21:30:42.463

Firebase 会自动检测对象何时“看起来像”数组，并相应地进行转换。由于 'systems' 和 'system_types' 有 1、2 和 3 的孩子，Firebase 会在输出时自动将它们转换为数组。但是，由于您没有为索引 0 指定值，因此 Firebase 只是插入了一个空元素。

我建议要么使用从零开始的 ID，要么使用非数字的东西开始你的 id，这样我们就知道它不是一个数组（即：item1、item2、item3）。

您也可以忽略 null 元素——在 Firebase 中，null 和不存在是一回事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-13T13:16:12.790

我为上述问题找到了一个hack。只需对所有数字键使用非数字（虚拟）键，当您导出时，firebase 不会将数字键转换为 null。请检查屏幕截图以获得更好的理解。我已经将“d”与其他数字键一起使用，即使我没有使用键“d”。

[![在此处输入图像描述](../Images/29fb5df881ee1b7cb00ca6525103cfef.png)](https://i.stack.imgur.com/qNzae.png)

# ide - Arduino IDE 错误信息

> ID：15534918
> 
> 赞同：1
> 
> 时间：2013-03-20T21:17:51.730
> 
> 标签：ide, null, serial-port, arduino, sudo

几天前一切正常，但现在我对 Arduino 有 2 个错误：

1.  打开随机草图时出现 IDE 错误。然后那个窗口死了，甚至不能关闭它。它说

    **线程 -l ... Java.Lang.NullPointerException**

    这是一个屏幕截图： ![在此处输入图像描述](../Images/08b4d370aae05afaeb80d1715b51ca89.png)

![在此处输入图像描述](../Images/274cdb46b16718c7b4b2db08ce582320.png)

2.  除非我用 sudo 运行 arduino，否则无法将我的代码上传到板上。（例如，我得到“找不到 ttyACM0”）我两天前不需要这个。有什么办法可以让它恢复正常吗？

谢谢！希望可以有人帮帮我。

**编辑：**

我刚刚下载了 1.0.4 版，问题 #1 消失了。但是＃2和＃3仍然存在......我注意到当我不使用sudo运行arduino时，问题＃3就消失了。但是我需要 sudo 将我的代码上传到板上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:03:50.637

首先插入您的 Arduino，然后在命令行上

```
ls /dev/tty* 
```

查看系统上有哪些设备。检查你的 Arduino IDE 的`Tools/Serial Port`菜单：你应该有一些东西。如果有不止一件事，请尝试两者。

您可能还需要更改映射到 Arduino 的串行端口的权限：

```
sudo chmod 777 /dev/ttyACM0 
```

`ttyACM0`您的设备名称在哪里。较新版本的 Arduino IDE 通过将当前用户添加到`dialout`组来实现相同的效果（尽管更安全）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:20:29.433

我会保存您的草图（将它们复制到新位置或拇指驱动器），然后重新安装 arduino 软件或查看是否有可用更新。重新安装/更新应该可以解决它。

# c - 在共享内存进程中分配字符串

> ID：15534923
> 
> 赞同：5
> 
> 时间：2013-03-20T21:18:13.080
> 
> 标签：c, string, shared-memory

我有一个程序需要在两个进程之间共享一个字符串。我已经声明了一个包含`*char`. 这个结构是在主进程被分叉之前`shmget`和之前分配的。`shmat`

```
typedef struct Queue
{
    int index;
    char *directory[10];
} Queue; 
```

在其中一个过程中，我尝试设置值：（`data->dir_name`是`*char`一个字符串，例如“/data1”）

```
queue->directory[i] = data->dir_name; // Option 1
queue->directory[i] = "foo";          // Option 2 
```

我的问题是，上面的第一个和第二个语句有什么区别？设置`queue->directory[i]`to`"foo"`时，其他进程会看到它。但是，传递 value `data->dir_name`，它没有。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T21:29:10.877

问题是您只是分配一个指针，而不是复制字符串数据。在第一种情况下，您将值设置为指向第二个进程看不到的内存。当您执行第一行时，指针`data->dir_name`被放入`queue->directory[i]`，但是当另一个进程在其自己的内存空间中查看该内存地址时，数据不存在。另一方面，第二行将静态字符串的地址`"foo"`放入变量中。由于进程是从同一源编译的，因此该字符串在每个进程的内存中位于同一位置，因此第二个可以看到它。

您想要做的是在`strcpy`目录名称所在的结构中有一个缓冲区。你需要

```
char directory[10][200]; 
```

和

```
strcpy (queue->directory[i], data->dir_name); 
```

您需要检查字符串长度是否小于 200（在这种情况下），如果太长则报告相应的错误。我不熟悉共享内存功能，无法确切知道如何进行`malloc`等效操作；如果你能做到的话；然后你会将字符串复制到`malloc`ed 共享内存中，并将指向它的指针放在一个数组中，就像你在代码中一样。但是，通过非常快速的 Google 搜索，似乎这样的`malloc`共享内存可能效果不佳。

# r - 强制将编码从未知设置为 UTF-8 或 R 中的任何编码？

> ID：15534926
> 
> 赞同：14
> 
> 时间：2013-03-20T21:18:28.660
> 
> 标签：r, encoding, iconv

我正在从旧的专有数据库中读取数据。不幸的是，我最终（仅针对某些字符串）`Encoding(mychar_vector)`返回了`"unknown"`. 不幸的是，我正在使用封闭源代码`c hli`（宿主语言接口）的包装器，所以我可能对此无能为力——如果是这样，我很高兴在这里被证明是错误的......

但是，查看字符串向量，除了我必须使用字符串进行的一些替换（请参阅我的[相关问题）](https://stackoverflow.com/questions/15482351/encoding-in-r-how-to-convert-this-string-to-utf-8)`gsub`看起来不错。我很想重新获得对编码的控制。有没有办法强制将编码设置为 UTF-8？我尝试过了

```
Encoding(mychar_vector) <- "UTF-8"
# or
mychar_vector <- enc2utf8(mychar_vector) 
```

但这一切都没有奏效。检查后立即`"unknown"`退货。也调查了`iconv`，但显然没有办法从“未知”转换为 UTF-8，因为没有映射。

有没有办法告诉 R，只涉及 UTF-8 字符，因此可以将编码设置为 UTF-8。请注意，向量的某些元素已经是 UTF-8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-02-11T20:38:35.283

我也陷入了编码兔子洞，我学到的重要一件事是`"unknown"`编码并不一定意味着它不是 UTF-8。还是不好。或者需要修复的东西。

这里有些例子：

```
# Some string that might be UTF-8 or just some ASCII (but created in UTF-8 editor/environment)
ambiguous <- "wat"
Encoding(ambiguous)
#> [1] "unknown"

# Forced coercion to UTF-8 via stringi
ambiguous <- stringi::stri_enc_toutf8("wat", is_unknown_8bit = TRUE)

# Still ambiguous
Encoding(ambiguous)
#> [1] "unknown"

# Some pretty-sure-not-ASCII string
totallygermanic <- "wät"

# It's UTF-8 because that's what my RStudio and every other part of my env is set to
Encoding(totallygermanic)
#> [1] "UTF-8"

# Let's force it to be unknowm
Encoding(totallygermanic) <- "unknown"

# Still prints ok
totallygermanic
#> [1] "wät"

# What's its encoding now?
Encoding(totallygermanic)
#> [1] "unknown"

# Converting it to UTF-8 still prints ok
stringi::stri_enc_toutf8(totallygermanic)
#> [1] "wät"

# So the converted string is UTF-8, right? No.
Encoding(stringi::stri_enc_toutf8(totallygermanic))
#> [1] "unknown"

# Maybe we should just guess?
stringi::stri_enc_detect("wat")
#> [[1]]
#>     Encoding Language Confidence
#> 1 ISO-8859-1       en       0.75
#> 2 ISO-8859-2       ro       0.75
#> 3      UTF-8                0.15

stringi::stri_enc_detect("wät")
#> [[1]]
#>   Encoding Language Confidence
#> 1    UTF-8                 0.8
#> 2 UTF-16BE                 0.1
#> 3 UTF-16LE                 0.1
#> 4  GB18030       zh        0.1
#> 5   EUC-JP       ja        0.1
#> 6   EUC-KR       ko        0.1
#> 7     Big5       zh        0.1 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1）于 2019 年 2 月 11 日创建)

要点是：如果你的字符串不是*明显*的非 ASCII，例如它只包含字母 az，它*可能*是 ASCII，或者它*可能*是 UTF-8，所以你得到一个`unknown`，但这并不一定意味着你的字符串显然，它实际上不是 UTF-8。您可能会尝试强行强制字符串，在此过程中您*可能会*破坏一些根本没有破坏的东西。根据我的经验，在变量/向量上使用一些转换函数可能是完全足够`stringi::stri_enc_toutf8`的，测试它是否按预期打印/工作，也许对可能有问题的字符使用正则表达式过滤器（作为德国人，我们倾向于寻找`äöüß`）。

无论如何，如果您想深入了解细节，我可以建议您查看[`stringi`软件包](https://www.rdocumentation.org/packages/stringi/versions/1.2.4/topics/stri_encode)及其编码功能。这个包是背后的力量[`stringr`](https://www.rdocumentation.org/packages/stringr/versions/1.4.0)，它提供了一个更高级的接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-29T19:28:41.867

当我处理了未正确 UTF-8 编码的文件时，我使用 iconv 非常成功地通过在我的 rmarkdown 笔记本中运行 bash 脚本来强制转换文件：

```
iconv -c -t UTF-8 myfile.txt > Ratebeer-myfile.txt 
```

您也可以试试这个，其中 file 是您的原始文件，而 file-iconv 是修改后的文件：

```
#iconv −f iso−8859−1 −t UTF−8 file.txt > file-iconv.txt 
```

验证编码：

```
file -I file-iconv.txt 
```

让我知道这是否有帮助。

# android - 如何正确使用 instantiateItem 与视图和布局对象的混合？

> ID：15534927
> 
> 赞同：0
> 
> 时间：2013-03-20T21:18:29.037
> 
> 标签：android

我试图让这段代码工作：

```
 @Override
    public Object instantiateItem(ViewGroup collection, int position) {

        View v = null;

        if( 0 == position ) {
            String data = "<html><body>Hi there</body><html>";
            WebView wv = (WebView) findViewById(R.id.webView);
            wv.loadData(data, "text/html", null);
            v = wv;
        }
        else {
            LayoutInflater vi = (LayoutInflater) cxt.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.editor, null);
        }

        collection.addView(v,0);

        return v;
    } 
```

我在这里基本上是在模仿这篇文章来构建一个水平滑动视图：[http ://android-developers.blogspot.com/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html)

使用此代码时发生崩溃。我通过尝试将布局插入 ViewGroup 来收集我没有正确地做事。有什么建议么？

```
03-20 14:49:55.037: ERROR/AndroidRuntime(25990): FATAL EXCEPTION: main
    java.lang.NullPointerException
    at com.EditorHyde.app.b.a(Unknown Source)
    at android.support.v4.view.ViewPager.a(Unknown Source)
    at android.support.v4.view.ViewPager.a(Unknown Source)
    at android.support.v4.view.ViewPager.c(Unknown Source)
    at android.support.v4.view.ViewPager.onMeasure(Unknown Source)
    at android.view.View.measure(View.java:15518)
    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4825)
    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
    at android.widget.LinearLayout.measureVertical(LinearLayout.java:695)
    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
    at android.view.View.measure(View.java:15518)
    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4825)
    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
    at android.view.View.measure(View.java:15518)
    at android.widget.LinearLayout.measureVertical(LinearLayout.java:847)
    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
    at android.view.View.measure(View.java:15518)
    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4825)
    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2176)
    at android.view.View.measure(View.java:15518)
    at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1874)
    at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1089)
    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1265)
    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
    at android.view.Choreographer.doCallbacks(Choreographer.java:562)
    at android.view.Choreographer.doFrame(Choreographer.java:532)
    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
    at android.os.Handler.handleCallback(Handler.java:725)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:5041)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:36:27.113

你需要一个演员来解决你的问题。改变：

```
collection.addView(v,0); 
```

进入：

```
((ViewPager)collection).addView(v, 0); 
```

# sql - 如何在同一个查询中进行内连接和右外连接

> ID：15534934
> 
> 赞同：0
> 
> 时间：2013-03-20T21:19:05.490
> 
> 标签：sql, linq

我有这 3 张桌子：

1.  FeatureTbl (FeatureId (PK),FeatureName)
2.  ParameterTbl (ParameterId (PK),ParameterName)
3.  Map_Parameter_To_Feature (MapId (PK),FeatureId(FK),ParameterId(FK))

我想将以下 SQL 转换为 LINQ：

```
SELECT 
    FeatureTbl.FeatureId,
    FeatureTbl.FeatureName,
    Map_Parameter_To_Feature.ParameterId,
    ParameterTbl.ParameterName
FROM ParameterTbl
INNER JOIN Map_Parameter_To_Feature
    ON ParameterTbl.ParameterId = Map_Parameter_To_Feature.ParameterId
RIGHT OUTER JOIN FeatureTbl
    ON Map_Parameter_To_Feature.FeatureId = FeatureTbl.FeatureId 
```

上述查询返回以下结果

```
FeatureId,FeatureName,ParameterId,ParameterName
    1       Feat A      NULL        NULL
    2       Feat B       10         Param X
    3       Feat B       10         Param Y
    4       Feat C      NULL        NULL 
```

我写了以下LINQ：

```
(from p in context.ParameterTbls
join mp2f in context.Map_Parameter_To_Feature 
    on p.ParameterId equals mp2f.ParameterId
join f in context.FeatureTbls 
    on mp2f.FeatureId equals f.FeatureId
into desiredresult
from r in desiredresult.DefaultIfEmpty()
select new { 
    r.FeatureId,
    r.FeatureName, 
    mp2f.ParameterId, 
    p.ParameterName
}); 
```

但我得到了这个结果

```
FeatureId,FeatureName,ParameterId,ParameterName
    2       Feat B       10         Param X
    3       Feat B       10         Param Y 
```

如何将上述 SQL 转换为 LINQ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:31:08.317

LINQ 没有右连接运算符，但您可以将其重写为左连接：

```
from f in context.FeatureTbls
join mp in (
    from p in context.ParameterTbls
    join mp2f in context.Map_Parameter_To_Feature on p.ParameterId equals mp2f.ParameterId
    select new { mp2f.FeatureId, p.ParameterId, p.ParameterName }
) on f.FeatureId equals mp.FeatureId into ps
from p in ps.DefaultIfEmpty()
select new { f.FeatureId, f.FeatureName, null == p.ParameterId ? (int?)null : p.ParameterId, null == p.ParameterName ? null : p.ParameterName } 
```

# java - Java MultiThreading Equal Cards 分为 4 个线程

> ID：15534937
> 
> 赞同：0
> 
> 时间：2013-03-20T21:19:16.843
> 
> 标签：java, multithreading

我正在尝试通过实现代码片段来学习多线程。问题是使用 4 个线程（每个 13 个）在四个列表中分配卡片（52），请在下面的代码中提出更好的解决方案或更正。

由于这是为了练习多线程，我没有对命名约定和泛型做太多强调（为此道歉）

```
import java.util.LinkedList;
import java.util.List;

public class CardsDivideIntoFour {
    static final int Max = 52;
    static int val = 0;
    static Object ox = new Object();
    static List list1 = new LinkedList();
    static List list2 = new LinkedList();
    static List list3 = new LinkedList();
    static List list4 = new LinkedList();

    public static void main(String[] args) {

        Thread t1 = new Thread(new Runnable() {
            public void run() {
                while (true) {
                    if (val >= Max) {
                        break;
                    }
                    synchronized (ox) {
                        list1.add(++val);
                        System.out.println("a>  " + val);
                        ox.notifyAll();
                        try {
                            if (val >= Max) {
                                // System.out.println("t1 run finished");
                                // Thread.currentThread().interrupt();
                                break;
                            }
                            Thread.sleep(1000);
                            ox.wait();
                        } catch (InterruptedException e) {
                        }
                    }
                }
                // Unreachable code
                // System.out.println("t1 run finished");

            }
        });

        Thread t2 = new Thread(new Runnable() {
            public void run() {
                while (true) {
                    if (val >= Max) {
                        break;
                    }
                    synchronized (ox) {
                        list2.add(++val);
                        System.out.println("b>  " + val);
                        ox.notifyAll();
                        try {
                            if (val >= Max) {
                                break;
                            }
                            Thread.sleep(1000);
                            ox.wait();
                        } catch (InterruptedException e) {
                        }
                    }
                }
            }
        });

        Thread t3 = new Thread(new Runnable() {
            public void run() {
                while (true) {
                    if (val >= Max) {
                        break;
                    }
                    synchronized (ox) {
                        list3.add(++val);
                        System.out.println("c> " + val);
                        ox.notifyAll();
                        try {
                            if (val >= Max) {
                                break;
                            }
                            Thread.sleep(1000);
                            ox.wait();
                        } catch (InterruptedException e) {
                        }
                    }
                }
            }
        });

        Thread t4 = new Thread(new Runnable() {
            public void run() {
                while (true) {
                    if (val >= Max) {
                        break;
                    }
                    synchronized (ox) {
                        list4.add(++val);
                        System.out.println("d> " + val);
                        ox.notifyAll();
                        try {
                            if (val >= Max) {
                                break;
                            }
                            Thread.sleep(1000);
                            ox.wait();
                        } catch (InterruptedException e) {
                        }
                    }
                }
            }
        });

        t1.start();
        t2.start();
        t3.start();
        t4.start();

        try {
            t1.join();
            t2.join();
            t3.join();
            t4.join();
        } catch (Exception e) {
        }

        System.out.print("List1 has > ");
        for (Object o : list1) {
            System.out.print((Integer) o + ",");
        }

        System.out.println("");
        System.out.print("List2 has > ");
        for (Object o : list2) {
            System.out.print((Integer) o + ",");
        }

        System.out.println("");
        System.out.print("List3 has > ");
        for (Object o : list3) {
            System.out.print((Integer) o + ",");
        }

        System.out.println("");
        System.out.print("List4 has > ");
        for (Object o : list4) {
            System.out.print((Integer) o + ",");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:37:29.717

为什么要重新发明轮子？新的 Java SE 7 提供了[`Fork\Join framework`](http://docs.oracle.com/javase/tutorial/essential/concurrency/forkjoin.html)，它可以同时为您完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:52:12.453

添加一个指示当前线程轮次的字段怎么样？

```
static int turn = 0; 
```

看看[代码](http://ideone.com/doTpAC)。

# 同步细节

线程同步分为三个部分。

1) 首先，线程必须在 处获得锁`synchronized (ox)`。线程处于*阻塞*状态，直到持有者线程释放锁，然后线程尝试获取锁。如果再次获取锁失败，则再次进入*阻塞*状态。

2）当线程获取锁并进入 的块时`synchronized`，首先要判断它是否真的能够获取锁或等待某个操作完成。因此，我们有一个循环来检查轮到线程是否轮到。如果不是，线程将自己置于*等待*状态，说“我必须等待轮到完成任务的那个”。然后线程保持在*等待*状态，直到另一个线程用`notifyAll`. 然后它重新确定它是否能够完成这项工作，如果不能，它再次将自己置于*等待*状态。否则，它会完成它的工作。

3）最后，线程在完成其任务后不会忘记唤醒其他*等待*线程。`notfiyAll`如果它忘记了，其他线程将永远处于*等待*状态。这种状态称为**死锁**，可能会导致程序挂起。

# jquery - Scripts.Render 之后 JQuery UI 在 MVC 4 中不起作用？

> ID：15534938
> 
> 赞同：4
> 
> 时间：2013-03-20T21:19:16.820
> 
> 标签：jquery, asp.net-mvc-4

不知道这里有什么问题。我已经阅读了其他一些解决方案并尝试使用它们，但似乎没有任何效果。我想做的就是渲染一个日期选择器。我以前做过很多次，只是不确定我是否有大脑功能障碍，因为过去几周我一直处于“紧缩”时间，或者什么。

1.  我有最新的 JQuery (1.9.1)，最新的 JQuery UI (1.10.2)。
2.  我检查了 BundleConfig，一切似乎都很好：

    ```
     bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
                    "~/Scripts/jquery.unobtrusive*",
                    "~/Scripts/jquery.validate*"));

        // Use the development version of Modernizr to develop with and learn from. Then, when you're
        // ready for production, use the build tool at http://modernizr.com to pick only the tests you need.
        bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                    "~/Scripts/modernizr-*"));

        bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));

        bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
                    "~/Content/themes/base/jquery.ui.core.css",
                    "~/Content/themes/base/jquery.ui.resizable.css",
                    "~/Content/themes/base/jquery.ui.selectable.css",
                    "~/Content/themes/base/jquery.ui.accordion.css",
                    "~/Content/themes/base/jquery.ui.autocomplete.css",
                    "~/Content/themes/base/jquery.ui.button.css",
                    "~/Content/themes/base/jquery.ui.dialog.css",
                    "~/Content/themes/base/jquery.ui.slider.css",
                    "~/Content/themes/base/jquery.ui.tabs.css",
                    "~/Content/themes/base/jquery.ui.datepicker.css",
                    "~/Content/themes/base/jquery.ui.progressbar.css",
                    "~/Content/themes/base/jquery.ui.theme.css")); 
    ```

3.  我已经设置了 _Layout.cshtml 标头：

    ```
     @Styles.Render("~/Content/css")
        @Scripts.Render("~/bundles/modernizr")
        @Scripts.Render("~/bundles/jquery")
        <script>
            $(function () {
                $("#datepicker").datepicker();
            });
        </script> 
    ```

然后在正文中添加了另一个 Scripts.Render("~/bundles/jquery") 。然而，当我添加日期选择器时，什么也没有发生……我只是得到一个文本框。

我也试过：

*   在标题中手动添加脚本引用
*   添加 jquery ui 演示中提供的 jquery 脚本参考（网址）

什么都没有......我的意思是没有任何工作。我已经仔细检查了我的文件路径，它们是正确的......我错过了什么？！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-17T13:07:26.287

我遇到了完全相同的问题，一直摇头，直到找到解决方案：[http ://forums.asp.net/t/1879457.aspx](http://forums.asp.net/t/1879457.aspx)

简而言之 ：

*   **样式**应该在 page **head**中使用 @Styles.Render 来呈现。
*   至少在我的代码中，只有 jquery 包将包含在页眉中（使用@Scripts.Render）。
*   所有其他**脚本**（再次是 jquery，jquery UI 等）应该**在页面正文中使用 @Scripts.Render 呈现，就在结束正文标记之前**...

该页面以这样的代码结束：

```
 @Scripts.Render("~/bundles/jquery")
     @Scripts.Render("~/bundles/jqueryui")

     @Scripts.Render("~/bundles/jqueryval")
     @Scripts.Render("~/bundles/modernizr")
     @RenderSection("scripts", required: false)
 </body> 
```

所以我让 jquery IU 工作了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:54:31.077

您为 jQuery ui 制作了一个捆绑包，但尚未在页面中设置参考。在您的 jQuery 捆绑包引用之后和创建日期选择器之前添加一个引用。您是否将日期选择器设置为 id 或类？现在您将其设置为 id。如果你给你的文本框一个 datepicker 类，请使用 jQuery 的类选择器。

# html - HTML 标签“For”值

> ID：15534939
> 
> 赞同：1
> 
> 时间：2013-03-20T21:19:19.440
> 
> 标签：html, forms

我有一个标签标签，我试图链接到输入类型复选框标签。我有多个标签和多个复选框输入，它们都具有相同的 id 和相同的名称，但值不同。有人可以指导我如何构建链接到值而不是 id 的标签吗？所以这：

```
<label for="8994"></label> 
```

将链接到：

```
<input id="member_ids_" name="member_ids[]" type="checkbox" value="8994"> 
```

或者这是不可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:20:45.843

标签的`for`属性必须与`<input>`它所引用的元素的 ID 相匹配。在您的情况下，它将类似于：

```
<label for="member_id_8994"></label>
<input id="member_id_8994" name="member_ids[]" type="checkbox" value="8994"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:26:34.303

表单元素的“for”必须与同一表单元素的 ID 匹配。

```
<label for="id_1"></label>
<input id="id_1" name="member_ids[1]" type="checkbox" value="8994">

<label for="id_2"></label>
<input id="id_2" name="member_ids[2]" type="checkbox" value="8994">

<label for="id_3"></label>
<input id="id_3" name="member_ids[3]" type="checkbox" value="8994">

<label for="id_3"></label>
<input id="id_3" name="member_ids[4]" type="checkbox" value="8994"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T21:22:27.187

您的 DOM 元素***必须***具有不同的 ID。即使每个 ID 只是设置为该值是... ...或其他任何值。

它们不能具有相同的 ID。

一旦你把它排除在外，`for`在标签上设置就变得非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T21:25:21.187

一个可能不起作用的 jQuery 解决方案。

```
 $(function() {
    ModifyLabels({target: $('input')});
    $('input').change(ModifyLabels);
 });

function ModifyLabels(eventObject) {
    var inputs = $(eventObject.target);
    input.each(function(i, input) {
         $('label').each(function(i, label) {
             if ($(label).attr('for') == $(input).val()) {
                $(input).attr('id', $(input).val());
             }
         });
    });
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:26:41.740

我怀疑这是否可能。标签的 for 与输入的 id 属性相关联。实现目标的一种方法可能是通过 javascript，例如淘汰赛的声明性绑定。

在这里查看：http: [//knockoutjs.com/documentation/introduction.html](http://knockoutjs.com/documentation/introduction.html)

沿着这条线的东西：

```
<label data-bind="click: myInput"></label>
<input type="checkbox" id="hello">

<script type="text/javascript">
    var myInput= {
        //implement the function to bind the label to the input#hello here
        }
    };
</script> 
```

[http://knockoutjs.com/documentation/click-binding.html](http://knockoutjs.com/documentation/click-binding.html)

# java - 在android中使用外部应用程序访问google sql数据库

> ID：15534944
> 
> 赞同：0
> 
> 时间：2013-03-20T21:19:34.343
> 
> 标签：java, android, google-app-engine, google-cloud-sql

所以我意识到你不能直接将应用程序直接连接到数据库。所以我所做的是使用将访问数据库的外部应用程序创建一个 GAE（谷歌应用程序引擎）后端。

外部应用->后端->google cloud sql

但是，我对将 google SQL 服务器的地址放在 GAE 后端的哪个位置感到困惑。它会在应用引擎属性下启用 google cloud sql 吗？

这是一个已经存在的谷歌云数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T15:09:31.703

您需要在创建连接时指定 Cloud SQL 实例的地址（以及用户名和密码）：

Connection conn = DriverManager.getConnection("jdbc:google:mysql://your-project-id:your-instance-name/database", "user", "password");

请参阅[https://developers.google.com/cloud-sql/docs/dev-access](https://developers.google.com/cloud-sql/docs/dev-access)

# delphi - 在图像上绘制多边形

> ID：15534947
> 
> 赞同：3
> 
> 时间：2013-03-20T21:19:52.367
> 
> 标签：delphi, delphi-xe2

我一直在寻找这个很长一段时间，但无法得到答案。

我想在图像上绘制一个多边形，但我想通过创建点来做到这一点；用`MouseCursor`创建这个特定的点，并用一个按钮沿着这些点画一条线；

我找到了这个：

```
var
  Poly: array of TPoint;
begin  
   // Allocate dynamic array of TPoint
   SetLength(Poly, 6);

  // Set array elements
  Poly[0] := Point(10, 10);
  Poly[1] := Point(30, 5);
  Poly[2] := Point(100, 20);
  Poly[3] := Point(120, 100);
  Poly[4] := Point(50, 120);
  Poly[5] := Point(10, 60);

  // Pass to drawing routine
  Canvas.Polygon(Poly);

  // Redim if needed
  SetLength(Poly, 7);
  Poly[6] := Point(1, 5);

  // Pass to drawing routine
  Canvas.Polygon(Poly);
end; 
```

这就是我想要的，但不同的是`Point[1]`,`Point[2]`等是由用户给出的`MouseEvent`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:33:40.173

您可以在图像上叠加一个 Paintbox 并使用这样的代码

```
unit Unit3;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, StdCtrls;

type
  TPointArray=array of TPoint;
  TForm3 = class(TForm)
    Image1: TImage;
    PaintBox1: TPaintBox;
    Button1: TButton;
    procedure PaintBox1MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure PaintBox1Paint(Sender: TObject);
    procedure Button1Click(Sender: TObject);
  private
    { Private-Deklarationen }
    FPointArray:TPointArray;
  public
    { Public-Deklarationen }
  end;
var
  Form3: TForm3;
implementation
{$R *.dfm}

procedure TForm3.Button1Click(Sender: TObject);
begin
   PaintBox1.Visible := false;
   Image1.Canvas.Polygon(FPointArray);
end;

procedure TForm3.PaintBox1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
   SetLength(FPointArray,Length(FPointArray)+1);
   FPointArray[High(FPointArray)].X := X;
   FPointArray[High(FPointArray)].Y := Y;
   Paintbox1.Invalidate;
end;

procedure TForm3.PaintBox1Paint(Sender: TObject);
var
 i:Integer;
begin
  PaintBox1.Canvas.Brush.Style := bsClear; //as suggested by TLama
  PaintBox1.Canvas.Polygon(FPointArray);
  for I := 0 to High(FPointArray) do
      begin
        PaintBox1.Canvas.TextOut(FPointArray[i].X-5,FPointArray[i].y-5,IntToStr(i));
      end;
end;

end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:48:13.893

制作一个由您的表单管理的点数组。在表单类中声明一个动态数组字段：

```
private
  FPoly: array of TPoint; 
```

在您的`OnClick`事件中，延长数组并向其附加一个新坐标：

```
procedure TFruitForm.ImageClick(Sender: TObject);
var
  p: TPoint;
begin
  p := ...;
  SetLength(FPoly, Length(FPoly) + 1);
  FPoly[High(FPoly)] := p;
end; 
```

要分配`p`，请参阅[单击控件时如何获取鼠标的坐标？](https://stackoverflow.com/q/826914/33732)

除了数组，您还可以考虑使用通用列表`TList<TPoint>`：

# c# - 是否可以使用属性对从 Type.GetProperties() 返回的类型的属性进行排序？

> ID：15534948
> 
> 赞同：1
> 
> 时间：2013-03-20T21:19:56.590
> 
> 标签：c#, reflection, types, custom-attributes

根据[MSDN](http://msdn.microsoft.com/en-us/library/kyaxdd3x%28v=vs.100%29.aspx)，

> **Type.GetProperties()** GetProperties 方法不按特定顺序返回属性，例如字母顺序或声明顺序。您的代码不得依赖于返回属性的顺序，因为该顺序会有所不同。

可以以某种方式对属性进行注释（可能是自定义属性），以便您可以执行类似的操作吗？

```
var properties = typeof(myClass).GetProperties()
.AsEnumerable().OrderBy(Func<VoodooOrdinalAttribute>); 
```

和

```
public class MyClass
{
   [VoodooOrdinalAttribute(2)] public string Color { get; set;}
   [VoodooOrdinalAttribute(3)] public string Shape { get; set;}
   [VoodooOrdinalAttribute(1)] public string Mass { get; set;}
} 
```

还有这个

```
public class VoodooOrdinalAttribute : Attribute
{
   public VoodooOrdinalAttribute(int ordinal)
   {
       this.Ordinal = ordinal;
   }
   public int Ordinal { get; set; }
} 
```

并期望属性的顺序是

1.  大量的
2.  颜色
3.  形状

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:26:01.220

是的，您可以使用属性对属性进行排序。如果您像在示例中所做的那样使用 use 定义属性，则这是一个 LINQ 查询，该查询按属性中指定的数字对具有该属性的属性进行排序。

```
var propertyData = from prop in typeof(MyClass).GetProperties()
                   let voodooOrdinalAttribute = Attribute.GetCustomAttribute(prop, typeof(VoodooOrdinalAttribute)) as VoodooOrdinalAttribute
                   where voodooOrdinalAttribute != null
                   let lineOrder = voodooOrdinalAttribute.Ordinal
                   orderby lineOrder ascending
                   select prop; 
```

# oracle - Oracle PL/SQL 触发器仅在 9-5 小时后对数据进行更改时运行

> ID：15534951
> 
> 赞同：1
> 
> 时间：2013-03-20T21:20:07.613
> 
> 标签：oracle, plsql, triggers

我创建了一个基本的审计表，因此如果对“员工”表有任何更改，无论是插入、更新、删除、时间、用户和操作的内容，都存储在“审计员工”表中。

我只是想知道是否有可能只有在“员工”表上所做的更改是在下午 5 点到早上 7 点之后才触发触发器？

有谁知道如何使用 SYSDATE 来实现这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T21:23:32.383

您无法控制触发器是否会根据一天中的时间触发。但是，您可以向触发器添加逻辑，以便仅在特定时间之间将数据插入历史记录表。就像是

```
IF( to_number( to_char(sysdate, 'hh24')) >= 17 or
    to_number( to_char(sysdate, 'hh24')) < 7 )
THEN
  INSERT INTO employee_history...
END IF; 
```

# c# - 将 PictureBox 中的图像调整到尽可能大，同时保持纵横比？

> ID：15534955
> 
> 赞同：11
> 
> 时间：2013-03-20T21:20:13.293
> 
> 标签：c#, .net, winforms, picturebox

我正在尝试使 PictureBox 控件中的图像根据窗口的大小自动调整其大小，但保持纵横比。到目前为止，只需设置`SizeMode`为即可`StretchImage`使图像拉伸以适合整个 PictureBox 控件。这忽略了纵横比，这不是我想要的。

是否可以保持纵横比，但仍然可以将图像拉伸到随着表单大小的变化而动态变化的最大？是否有可能做到这一点*并*让它仍然居中？我想每次调整窗口大小时我都可以在内存中重新创建图像，但这似乎是个坏主意。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-20T21:24:33.690

我相信这就是效果[`PictureBoxSizeMode.Zoom`](http://msdn.microsoft.com/en-us/library/system.windows.forms.pictureboxsizemode.aspx)。文档说：

> 图像的大小在保持大小比例的情况下增加或减少。

[`PictureBox.SizeMode`](http://msdn.microsoft.com/en-us/library/system.windows.forms.picturebox.sizemode.aspx)你在属性上设置这个。该函数文档的“备注”部分还说：

> 使用 Zoom 值会导致图像被拉伸或缩小以适合 PictureBox；但是，原始的纵横比保持不变。

当然，您可以`PictureBox.SizeMode`在设计器的属性窗口或代码中（例如，在表单的构造函数中）设置属性：

```
myPictureBox.SizeMode = PictureBoxSizeMode.Zoom; 
```

如果这不完全符合您的要求，您始终可以自己实现调整大小的逻辑。您担心的是，每次调整控件大小时在内存中重新创建图像“似乎是个坏主意”，但我不确定为什么对您来说是这样。唯一的问题是，如果您不小心销毁未使用的图形对象，例如旧的`Bitmap`. 这些对象不仅包含需要释放的非托管资源，而且如果您让它们泄漏，您将开始对内存施加极大的压力。

或者，为避免创建临时位图，您可以执行 PictureBox 控件可能在内部执行的操作，并使用该[`Graphics.DrawImage`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawimage.aspx)方法来处理拉伸。如果你传递一个矩形，它会自动缩放图像以适应矩形的内部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T21:24:17.047

将“尺寸模式”更改为`Zoom`. 顾名思义，“StretchImage”将拉伸它以适合图像文件。简单的消除过程会给你同样的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T21:24:28.853

根据[`PictureBoxSizeMode`文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.pictureboxsizemode.aspx)，您可以指定`PictureBoxSizeMode.Zoom`让图像保持其纵横比。它将尽可能放大，而图像的任何部分都不会溢出图片框。

您可以使用[`Dock`属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx)（设置[`DockStyle.Fill`](http://msdn.microsoft.com/en-us/library/system.windows.forms.dockstyle.aspx)）来让图片框调整到其容器的大小。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2016-12-07T21:17:42.050

您可以将其添加到 Web 浏览器控件。使用 Ctrl 和鼠标按钮，您可以随意放大。

# c++ - 我可以穿这个for循环吗

> ID：15534973
> 
> 赞同：0
> 
> 时间：2013-03-20T21:21:18.230
> 
> 标签：c++, multithreading, qt

```
for(unsigned int mBlock = 0; mBlock < coords.size(); mBlock++)
{   
    WidgetType widgetType; 
    height = macBlockWidth + coords[mBlock].y;
    width = macBlockHeight + coords[mBlock].x;

    macBlockParent = new QWidget;
    cooefsLink = new QPushButton(macBlockParent);
    macBlock = new QWidget(macBlockParent);
    widgetType.widget = macBlock;
    widgetType.type = (macBlocks[mBlock][2] != 'S') 
                        ? (macBlocks[mBlock][0]) : (macBlocks[mBlock][2]);
    blockWidgetTypes.push_back(widgetType);

    connect(cooefsLink, SIGNAL(released()), 
                                    this, SLOT(showCoefficients()));
    buttonSignals[cooefsLink] = mBlock;

    constructMotionVector(mBlock);
    macBlockLayout->addWidget(macBlockParent, height - 16, width - 16);
    styleMacroBlocks(mBlock);
} 
```

我可以从这个 for 循环中创建一个函数，我可以通过将它分成两个不同的 for 循环来并行操作，这两个循环都同时在向量上运行。一个处理前半部分的项目，第二个线程构建下半部分。所以例如

**线程 1**

```
for(unsigned int mBlock = 0; mBlock < coords.size() / 2; mBlock++)
{   
    WidgetType widgetType; 
    height = macBlockWidth + coords[mBlock].y;
    width = macBlockHeight + coords[mBlock].x;

    macBlockParent = new QWidget;
    cooefsLink = new QPushButton(macBlockParent);
    macBlock = new QWidget(macBlockParent);
    widgetType.widget = macBlock;
    widgetType.type = (macBlocks[mBlock][2] != 'S') 
                        ? (macBlocks[mBlock][0]) : (macBlocks[mBlock][2]);
    blockWidgetTypes.push_back(widgetType);

    connect(cooefsLink, SIGNAL(released()), 
                                    this, SLOT(showCoefficients()));
    buttonSignals[cooefsLink] = mBlock;

    constructMotionVector(mBlock);
    macBlockLayout->addWidget(macBlockParent, height - 16, width - 16);
    styleMacroBlocks(mBlock);
} 
```

**线程 2**

```
for(unsigned int mBlock = coords.size() / 2; mBlock < coords.size(); mBlock++)
{   
    WidgetType widgetType; 
    height = macBlockWidth + coords[mBlock].y;
    width = macBlockHeight + coords[mBlock].x;

    macBlockParent = new QWidget;
    cooefsLink = new QPushButton(macBlockParent);
    macBlock = new QWidget(macBlockParent);
    widgetType.widget = macBlock;
    widgetType.type = (macBlocks[mBlock][2] != 'S') 
                        ? (macBlocks[mBlock][0]) : (macBlocks[mBlock][2]);
    blockWidgetTypes.push_back(widgetType);

    connect(cooefsLink, SIGNAL(released()), 
                                    this, SLOT(showCoefficients()));
    buttonSignals[cooefsLink] = mBlock;

    constructMotionVector(mBlock);
    macBlockLayout->addWidget(macBlockParent, height - 16, width - 16);
    styleMacroBlocks(mBlock);
} 
```

因为它对我的系统来说是一个真正的瓶颈，我注意到它只使用一个 CPU 并且它最大化了那个 CPU。任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:52:37.487

嗯......如果你有这样的结构：`blockWidgetTypes.push_back(widgetType);`在**两个**线程中，多线程执行似乎非常危险。

# c# - 对如何在 LINQ 中进行分组非常困惑，对 HAVING 更加困惑

> ID：15534974
> 
> 赞同：2
> 
> 时间：2013-03-20T21:21:20.347
> 
> 标签：c#, sql, linq

我是Linq的新手。我正在尝试转换这个简单的 SQL 查询，但找不到任何关于如何将 SQL 转换为 LINQ 的重要资源。我的 SQL 查询是：

```
SELECT SomeValue
FROM SomeTable
GROUP BY SomeValue
HAVING SUM (OtherValue) > 0; 
```

我不太了解 LINQ，无法做到这一点。我在让 GROUP BY 工作时遇到了很多麻烦，我什至还没有尝试解决 HAVING SUM 问题。

我已经尝试了几件事。这是最新的，尽管它仍然非常错误：

```
from entry in SomeTable
group entry by entry.SomeValue into grp
select grp.Select(x => x.SomeValue).toList(); 
```

任何帮助或资源都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T21:25:03.787

等效的 LINQ 语句如下所示：

```
SomeTable.GroupBy(x => x.SomeValue)
         .Where(g => g.Sum(x => x.OtherValue) > 0)
         .Select(g => g.Key); 
```

它首先按`SomeValue`. 结果将是一个组列表。每个组依次包含所有具有相同`SomeValue`.
下一步创建一个过滤器 ( `Where`)。此过滤器将仅返回该组中`OtherValue`的行总和大于零的那些组。
最后，从过滤后的组中，它将选择每个组的键。组的键是在 中指定的值`GroupBy`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T21:28:48.887

为了让分组工作看起来你想要这个（在查询语法而不是 lambdas 中）：

```
from entry in SomeTable
group entry by entry.SomeValue into grp
where grp.Sum(x => x.OtherValue) > 0
select grp.Key; 
```

# mysql - MySQL 无法添加外键约束

> ID：15534977
> 
> 赞同：352
> 
> 时间：2013-03-20T21:21:24.490
> 
> 标签：mysql, sql, foreign-keys

因此，我尝试将外键约束作为项目要求添加到我的数据库中，并且它第一次或两次在不同的表上工作，但是我有两个表在尝试添加外键约束时出现错误。我得到的错误信息是：

> ERROR 1215 (HY000): 无法添加外键约束

这是我用来创建表的 SQL，两个有问题的表是`Patient`和`Appointment`。

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=1;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

CREATE SCHEMA IF NOT EXISTS `doctorsoffice` DEFAULT CHARACTER SET utf8 ;
USE `doctorsoffice` ;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`doctor`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`doctor` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`doctor` (
  `DoctorID` INT(11) NOT NULL AUTO_INCREMENT ,
  `FName` VARCHAR(20) NULL DEFAULT NULL ,
  `LName` VARCHAR(20) NULL DEFAULT NULL ,
  `Gender` VARCHAR(1) NULL DEFAULT NULL ,
  `Specialty` VARCHAR(40) NOT NULL DEFAULT 'General Practitioner' ,
  UNIQUE INDEX `DoctorID` (`DoctorID` ASC) ,
  PRIMARY KEY (`DoctorID`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`medicalhistory`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`medicalhistory` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`medicalhistory` (
  `MedicalHistoryID` INT(11) NOT NULL AUTO_INCREMENT ,
  `Allergies` TEXT NULL DEFAULT NULL ,
  `Medications` TEXT NULL DEFAULT NULL ,
  `ExistingConditions` TEXT NULL DEFAULT NULL ,
  `Misc` TEXT NULL DEFAULT NULL ,
  UNIQUE INDEX `MedicalHistoryID` (`MedicalHistoryID` ASC) ,
  PRIMARY KEY (`MedicalHistoryID`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`Patient`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`Patient` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`Patient` (
  `PatientID` INT unsigned NOT NULL AUTO_INCREMENT ,
  `FName` VARCHAR(30) NULL ,
  `LName` VARCHAR(45) NULL ,
  `Gender` CHAR NULL ,
  `DOB` DATE NULL ,
  `SSN` DOUBLE NULL ,
  `MedicalHistory` smallint(5) unsigned NOT NULL,
  `PrimaryPhysician` smallint(5) unsigned NOT NULL,
  PRIMARY KEY (`PatientID`) ,
  UNIQUE INDEX `PatientID_UNIQUE` (`PatientID` ASC) ,
  CONSTRAINT `FK_MedicalHistory`
    FOREIGN KEY (`MEdicalHistory` )
    REFERENCES `doctorsoffice`.`medicalhistory` (`MedicalHistoryID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `FK_PrimaryPhysician`
    FOREIGN KEY (`PrimaryPhysician` )
    REFERENCES `doctorsoffice`.`doctor` (`DoctorID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`Appointment`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`Appointment` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`Appointment` (
  `AppointmentID` smallint(5) unsigned NOT NULL AUTO_INCREMENT ,
  `Date` DATE NULL ,
  `Time` TIME NULL ,
  `Patient` smallint(5) unsigned NOT NULL,
  `Doctor` smallint(5) unsigned NOT NULL,
  PRIMARY KEY (`AppointmentID`) ,
  UNIQUE INDEX `AppointmentID_UNIQUE` (`AppointmentID` ASC) ,
  CONSTRAINT `FK_Patient`
    FOREIGN KEY (`Patient` )
    REFERENCES `doctorsoffice`.`Patient` (`PatientID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `FK_Doctor`
    FOREIGN KEY (`Doctor` )
    REFERENCES `doctorsoffice`.`doctor` (`DoctorID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`InsuranceCompany`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`InsuranceCompany` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`InsuranceCompany` (
  `InsuranceID` smallint(5) NOT NULL AUTO_INCREMENT ,
  `Name` VARCHAR(50) NULL ,
  `Phone` DOUBLE NULL ,
  PRIMARY KEY (`InsuranceID`) ,
  UNIQUE INDEX `InsuranceID_UNIQUE` (`InsuranceID` ASC) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `doctorsoffice`.`PatientInsurance`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `doctorsoffice`.`PatientInsurance` ;

CREATE  TABLE IF NOT EXISTS `doctorsoffice`.`PatientInsurance` (
  `PolicyHolder` smallint(5) NOT NULL ,
  `InsuranceCompany` smallint(5) NOT NULL ,
  `CoPay` INT NOT NULL DEFAULT 5 ,
  `PolicyNumber` smallint(5) NOT NULL AUTO_INCREMENT ,
  PRIMARY KEY (`PolicyNumber`) ,
  UNIQUE INDEX `PolicyNumber_UNIQUE` (`PolicyNumber` ASC) ,
  CONSTRAINT `FK_PolicyHolder`
    FOREIGN KEY (`PolicyHolder` )
    REFERENCES `doctorsoffice`.`Patient` (`PatientID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `FK_InsuranceCompany`
    FOREIGN KEY (`InsuranceCompany` )
    REFERENCES `doctorsoffice`.`InsuranceCompany` (`InsuranceID` )
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

USE `doctorsoffice` ;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS; 
```

* * *

## 回答 #1

> 赞同：870
> 
> 时间：2013-03-20T21:30:21.237

要查找特定错误，请运行以下命令：

```
SHOW ENGINE INNODB STATUS; 
```

并查看该`LATEST FOREIGN KEY ERROR`部分。

子列的数据类型必须与父列完全匹配。例如，既然`medicalhistory.MedicalHistoryID`是一个`INT`，`Patient.MedicalHistory`也需要是一个`INT`，而不是一个`SMALLINT`。

此外，您应该`set foreign_key_checks=0`在运行 DDL 之前运行查询，这样您就可以按任意顺序创建表，而无需在相关子表之前创建所有父表。

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2015-02-12T06:21:28.423

我已将一个字段设置为“未签名”，而另一个则没有。一旦我将两列都设置为无符号，它就起作用了。

* * *

## 回答 #3

> 赞同：107
> 
> 时间：2016-01-22T17:59:56.743

*   **引擎**应该是相同的，*例如 InnoDB*
*   **数据类型**应该相同，并且具有相同的长度。*例如 VARCHAR(20)*
*   **Collat​​ion** Columns 字符集应该相同。*例如 utf8*
    *Watchout：即使您的表有相同的排序规则，列仍然可能有不同的排序规则。*
*   **唯一**- 外键应指引用表中唯一的字段*（通常是主键）*。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-03-20T21:34:45.480

尝试在外键 - **smallint(5) - 上使用相同类型的主键 -** **int(11)**。

 **希望能帮助到你！

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-06-29T12:07:56.307

确认两个表的字符编码和排序规则相同。

在我自己的情况下，其中一张表正在使用`utf8`，另一张正在使用`latin1`.

我有另一种情况，编码相同但排序规则不同。一个`utf8_general_ci`另一个`utf8_unicode_ci`

您可以运行此命令来设置表的编码和排序规则。

```
ALTER TABLE tablename CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci; 
```

我希望这可以帮助别人。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-06-04T12:49:00.067

要在表 B 中设置 FOREIGN KEY，您必须在表 A 中设置 KEY。

在表 A 中：索引`id`( `id`)

然后在表 B 中，

```
CONSTRAINT `FK_id` FOREIGN KEY (`id`) REFERENCES `table-A` (`id`) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-03-04T23:53:47.420

我有同样的问题，解决方案非常简单。解决方案：表中声明的外键不应设置为非空。

参考：如果您指定 SET NULL 操作，请确保您没有将子表中的列声明为 NOT NULL。（[参考](http://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html) ）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-11-20T19:05:12.537

检查以下规则：

*   首先检查是否为表名赋予了正确的名称

*   第二个正确的数据类型给外键？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-07-02T11:30:44.463

请确保这两个表都是 InnoDB 格式。即使是 MyISAM 格式，外键约束也不起作用。

另外，另一件事是，两个字段应该是相同的类型。如果一个是 INT，那么另一个也应该是 INT。如果一个是 VARCHAR，另一个也应该是 VARCHAR，等等。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-02-29T05:36:05.730

我遇到了这个问题，并且能够通过确保数据类型完全匹配来解决它。

我正在使用 SequelPro 添加约束，并且默认情况下将主键设置为无符号。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-11-23T08:34:24.710

检查两个表格列上的签名。如果引用表列已签名，则引用表列也应签名。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-05-11T07:15:25.177

我的问题是我试图在其他表之前创建关系表！

所以你有两种方法可以解决它：

*   更改 MSQL 命令的顺序

*   在您的查询之前运行它：

    SET foreign_key_checks = 0;

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-10-12T19:15:54.130

> 注意：下表是在我对数据库进行一些研发时从某个站点获取的。所以命名约定是不合适的。

**对我来说，问题是，我的父表的字符集与我创建的表不同。**

**父表（产品）**

```
products | CREATE TABLE `products` (
  `productCode` varchar(15) NOT NULL,
  `productName` varchar(70) NOT NULL,
  `productLine` varchar(50) NOT NULL,
  `productScale` varchar(10) NOT NULL,
  `productVendor` varchar(50) NOT NULL,
  `productDescription` text NOT NULL,
  `quantityInStock` smallint(6) NOT NULL,
  `buyPrice` decimal(10,2) NOT NULL,
  `msrp` decimal(10,2) NOT NULL,
  PRIMARY KEY (`productCode`),
  KEY `productLine` (`productLine`),
  CONSTRAINT `products_ibfk_1` FOREIGN KEY (`productLine`) REFERENCES `productlines` (`productLine`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

**有问题的子表 (PRICE_LOGS)**

```
price_logs | CREATE TABLE `price_logs` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `productCode` varchar(15) DEFAULT NULL,
  `old_price` decimal(20,2) NOT NULL,
  `new_price` decimal(20,2) NOT NULL,
  `added_on` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `productCode` (`productCode`),
  CONSTRAINT `price_logs_ibfk_1` FOREIGN KEY (`productCode`) REFERENCES `products` (`productCode`) ON DELETE CASCADE ON UPDATE CASCADE
); 
```

**修改为**

```
price_logs | CREATE TABLE `price_logs` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `productCode` varchar(15) DEFAULT NULL,
  `old_price` decimal(20,2) NOT NULL,
  `new_price` decimal(20,2) NOT NULL,
  `added_on` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `productCode` (`productCode`),
  CONSTRAINT `price_logs_ibfk_1` FOREIGN KEY (`productCode`) REFERENCES `products` (`productCode`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-01-07T12:49:11.320

此错误的另一个原因是您的表或列包含保留[关键字](https://dev.mysql.com/doc/refman/5.5/en/keywords.html)：

有时确实会忘记这些。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-04-15T08:09:20.903

我在多对多表中创建外键时遇到了类似的错误，其中主键由 2 个外键和另一个普通列组成。我通过更正引用的表名称即公司来解决此问题，如下面的更正代码所示：

```
create table company_life_cycle__history -- (M-M)
(
company_life_cycle_id tinyint unsigned not null,
Foreign Key (company_life_cycle_id) references company_life_cycle(id) ON DELETE    CASCADE ON UPDATE CASCADE,
company_id MEDIUMINT unsigned not null,
Foreign Key (company_id) references company(id) ON DELETE CASCADE ON UPDATE CASCADE,
activity_on date NOT NULL,
PRIMARY KEY pk_company_life_cycle_history (company_life_cycle_id, company_id,activity_on),
created_on datetime DEFAULT NULL,
updated_on datetime DEFAULT NULL,
created_by varchar(50) DEFAULT NULL,
updated_by varchar(50) DEFAULT NULL
); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-12-08T19:35:50.893

我对不同表的两个外键有类似的错误，但键名相同！我已经重命名了键并且错误消失了）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-02-28T12:09:13.613

有一个类似的错误，但在我的情况下，我没有将 pk 声明为 auto_increment。

以防万一它对任何人都有帮助

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-12-22T11:08:17.833

我得到了同样的错误。我的原因是：

1.  我通过复制整个数据库通过 phpmyadmin 创建了数据库的备份。
2.  我创建了一个与旧数据库同名的新数据库，并没有选择它。
3.  我启动了一个 SQL 脚本来创建更新的表和数据。
4.  我得到了错误。当我禁用foreign_key_checks 时。尽管数据库完全是空的。

原因是：由于我使用 phpmyadmin 在重命名的数据库中创建了一些外键 - 使用数据库名称前缀创建的外键但未更新数据库名称前缀。所以备份数据库中仍然有指向新创建的数据库的引用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-16T16:30:43.507

我的解决方案可能有点尴尬，它讲述了为什么有时应该看看你面前的东西而不是这些帖子:)

我之前运行过一个正向工程师，但失败了，这意味着我的数据库已经有几个表，然后我一直在尝试修复外键约束失败，试图确保一切都很完美，但它遇到了以前创建的表，所以它没有占上风。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-09-29T22:04:12.777

就我而言，运行查询时 MySQL 控制台未明确通知语法错误。但是，`SHOW ENGINE INNODB STATUS`命令的`LATEST FOREIGN KEY ERROR`部分报告说，

```
 Syntax error close to:

  REFERENCES`role`(`id`) ON DELETE CASCADE) ENGINE = InnoDB DEFAULT CHARSET = utf8 
```

`REFERENCES`我必须在和之间留一个空格`role`才能让它工作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-02-21T13:03:34.000

对我来说，如果为引用当前数据库的非当前数据库创建 FK，则不能省略为当前数据库表添加前缀：

```
USE currrent_db;
ALTER TABLE other_db.tasks ADD CONSTRAINT tasks_fk FOREIGN KEY (user_id) REFERENCES currrent_db.users (id); 
```

如果我省略“current_db”。对于用户表，我收到 FK 错误。有趣的是 SHOW ENGINE INNODB STATUS；在这种情况下没有显示任何内容。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-07-22T04:56:47.403

**我的解决方案！！**

如果我们想让 table1 的 column1 作为 table2 的外键，那么 column1 应该是 table1 的键。

例如，考虑我们有一个`departments`表，它有`dept_id`列。

现在假设我们有另一个名为的表`employees`，其中包含`emp_dept_id`列。

如果我们想使用表的`dept_id`列作为 的列`department`的外键，那么表的列**应该至少是**一个键，如果不是主键的话。`emp_dept_id``emp``dept_id``department`

 **因此，在将其用作另一个表的外键之前，请确保它`dept_id`是主键或唯一键。`depratment`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-08-25T09:59:20.693

如果您在使用 PhpMyAdmin 时遇到此错误，请在导入 SQL 文件之前禁用外键检查。

[![在此处输入图像描述](../Images/b7bba7d20edc121cdb921a63268a20ac.png)](https://i.stack.imgur.com/B2GnA.png)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-03-02T12:45:34.353

对我来说，目标表阻止了外键。`AI`我必须在外键指向的表上设置 Auto-Increment ( )。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2015-10-14T10:18:43.700

我遇到了同样的问题，然后我在父表和子表中将引擎名称更正为 Innodb，并更正了引用字段名称 FOREIGN KEY ( `c_id`) REFERENCES `x9o_parent_table`( `c_id`)
，然后它工作正常并且表安装正确。这将对某人完全使用。****

# php - php：正则表达式和插入符号

> ID：15534979
> 
> 赞同：0
> 
> 时间：2013-03-20T21:21:47.580
> 
> 标签：php, regex

所以我正在尝试制作一个正则表达式来包含文本的课程内容，但不包括后跟句点和一些文本的 3 位数字。基本上，我试图将课程文本分成单独的课程线，以便最终得到一个数组，其中每个元素都有一个课程的课程信息。

例如，假设我们有：

$text = "295\. 学生发起的课程或项目。(1-2) 对完成第一年课程的学生开放。临床工作、实地工作、法律援助、个人研究和写作、专业写作或编辑sional 期刊、学生讲授的课程或其他具有严肃教育性质的法律项目。需要得到 Law 295 管理员和院长的批准。296\. Legal Dissertation。(8-13)"

和这个巨大的正则表达式：

```
$lineDelimiter = ='/(?:[0-9]{3}(?:\.5|\-[1-5])?[A-Z]?)(?:\-[0-9]{3}(?:\.5|\-[0-9])?  [A-Z]?)?\.\s*.+\.\s*(?:(?:\([0-9]+\-*[0-9]*\))(?:\s*or\s*\([0-9]+\-*[0-9]*\))?)?\s*(?:Prerequisite)?.+(?:\n.+)?\.\n?(?:\s*Mr\.\s.+,?|\s*Ms\.\s.+,?|\s*Dr\.\s.+,?|\s*The\sFaculty.*,?)*[^(?:[0-9]{3}\..+)]/'; 
```

那个巨大的正则表达式的最后一部分，包括

```
'/[^(?:[0-9]{3}\..+)]/' 
```

我 preg_match_all 时出错。

我正在尝试排除“296\. Legal Dissertation. (8-13)”部分，以便

"295\. 学生发起的课程或项目。(1-2) 向已完成第一年课程的学生开放。临床工作、实地工作、法律援助、个人研究和写作、专业期刊的写作或编辑，学生授课的课程，或其他具有严肃教育性质的法律项目。需要获得第 295 号法律管理员和院长的批准。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:25:53.330

如果您想将除最后一部分之外的所有内容与数字和文本匹配，您可以尝试以下操作：

```
'/([\s\S]+)(?=\d{3}\..+)/' 
```

*   `[\s\S]+`匹配所有内容 - 空格和非空格
*   `(?=)`执行[`Positive Lookahead`](http://www.regular-expressions.info/lookaround.html)。它与括号中的内容不匹配，但它确保括号之前的内容跟在括号中的 this 后面。
*   `\d{3}\..+`匹配 3 位数字，后跟一个点和其他一些不带换行符的字符。

# android - Android Image resize (resample/downsample) 上传前

> ID：15534980
> 
> 赞同：2
> 
> 时间：2013-03-20T21:21:47.227
> 
> 标签：android, http, bitmap, resize

```
private void doFileUpload(){

    File file1 = new File(selectedPath1);

    String urlString = "http://example.com/upload_media_test.php";
    try
    {
         HttpClient client = new DefaultHttpClient();
         HttpPost post = new HttpPost(urlString);
         FileBody bin1 = new FileBody(file1);

         MultipartEntity reqEntity = new MultipartEntity();
         reqEntity.addPart("uploadedfile1", bin1);
         reqEntity.addPart("user", new StringBody("User"));
         post.setEntity(reqEntity);

         HttpResponse response = client.execute(post);
         resEntity = response.getEntity();
         final String response_str = EntityUtils.toString(resEntity);

         if (resEntity != null) {
             Log.i("RESPONSE",response_str);
             runOnUiThread(new Runnable(){
                    public void run() {
                         try {
                            res.setTextColor(Color.GREEN);
                            res.setText("n Response from server : n " + response_str);
                            Toast.makeText(getApplicationContext(),"Upload Complete. Check the server uploads directory.", Toast.LENGTH_LONG).show();
                        } catch (Exception e) {
                            e.printStackTrace();
                        }
                       }
                });
         }
    }
    catch (Exception ex){
         Log.e("Debug", "error: " + ex.getMessage(), ex);
    }
  } 
```

我从互联网上得到这个代码。可以，但是当我尝试上传大于 1Mbyte 的文件时，

我面临文件大小错误。

我知道如何调整位图图像的大小，但我不知道上传调整后的位图图像。

如何调整大小并使用文件体上传？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:57:27.313

您不仅需要调整位图的大小，还需要将结果编码为 .jpg 图像。因此，您必须打开文件并将其转换为 Bitmap，将 Bitmap 调整为较小的图像，将图像编码为 byte[] 数组，然后以与上传文件相同的方式上传 byte[] 数组`file1`.

如果位图很大，很明显，你没有足够的堆内存来打开整个东西，所以你必须用`BitmapFactory.Options.inSampleSize`.

首先，打开缩小尺寸的Bitmap：

```
Uri uri = getImageUri(selectedPath1);
BitmapFactory.Options options = new BitmapFactory.Options();
options.inSampleSize = 4; // Example, there are also ways to calculate an optimal value.
InputStream in = in = contentResolver.openInputStream(uri);
Bitmap bitmap = BitmapFactory.decodeStream(in, null, options); 
```

接下来，编码成一个`byte[]`数组：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.JPEG, quality, baos);
byte[] bitmapdata = bos.toByteArray(); 
```

最后，使用直接`reqEntity.addPart()`添加`byte[]`数组，或写入较小的文件并像当前示例一样添加文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-12T21:25:46.983

这个答案[基于另一个答案](https://stackoverflow.com/a/15535555/2615737)，但我对该代码有一些问题，所以我发布了编辑和工作的代码。

我是这样做的：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.outWidth = 50; //pixels
options.outHeight = 50; //pixels
InputStream in = context.getContentResolver().openInputStream(data.getData()); // here, you need to get your context.
Bitmap bitmap = BitmapFactory.decodeStream(in, null, options);
ByteArrayOutputStream baos = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.JPEG, 100, baos);
byte[] bitmapdata = baos.toByteArray(); 
```

请注意，*数据*是您用于获取文件的 Intent 返回的数据。如果您已经有文件路径，请使用它...

现在，当您创建 HTTP 实体时，添加：

```
 FormBodyPart fbp = new FormBodyPart("image", new ByteArrayBody(baos.toByteArray(), "image/jpeg", "image"));
 entity.addPart(fbp); 
```

另外，请注意您需要一个*MultipartEntity*来上传文件。

# android - 仅用一个 Button.xml 实例化多个 Button

> ID：15534981
> 
> 赞同：-1
> 
> 时间：2013-03-20T21:21:49.743
> 
> 标签：android, android-layout

**[已解决]**
**好的，这真的很奇怪。我用我的模拟器运行程序，当我启动模拟器并使用 Run as -> Android 应用程序时，一切正常。**

**如果我尝试，直接使用 Run as -> Android application 启动程序并启动模拟器，在 sdcard.img 上找不到我的 XML 文件，这就是我得到 NullPointerException 的原因，因为 XML Parser 没有'不要创建任何导致这种情况的对象。也许是一个错误？模拟器总是启动相同的 sdcard 映像。**

我正在解析一个 XML 文件，该文件可能会有很大的不同。所以我尝试创建一个RelativeView，我可以根据XML 文件内容在其中添加按钮等。

所以我创建了一个 button.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<Button xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/button"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_marginLeft="10dp"
android:layout_marginRight="10dp"
android:layout_marginTop="10dp"
android:textSize="25sp" /> 
```

现在我尝试了这样的事情（我在这里只使用伪代码）：

```
 int i = 0;
for(File file : fileArray){
   Button b[i] = (Button)findViewById(R.layout.button);
   b[i].setText(file.getTitel);
   i++;
} 
```

问题是，现在我得到一个 NullPointerException！只有在第一个 Button 被实例化之后。当我的 fileArray 仅包含一个 Object 时，此方法有效。这可能听起来很愚蠢，但有没有像我打算的那样简单的方法，或者我必须用一个新文件创建一个多按钮布局.xml，将所有内容粘贴在那里，例如使用 BufferedOutputStream，保存所有把Buttons 0..n等放在里面然后给它充气？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:28:30.253

尝试这个

```
 int i = 0;
for(File file : fileArray){
   Button b[i] = (Button) View.inflate(this, R.layout.button, null);
   b[i].setText(file.getTitel);
   i++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:28:13.803

有一个简单的错误。移出循环`int i = 0;`。`for()`

# php - 哪些迭代规则适用于使用 CRYPT_EXT_DES 的 crypt()？

> ID：15534982
> 
> 赞同：4
> 
> 时间：2013-03-20T21:21:49.927
> 
> 标签：php, des, crypt

我的测试用例如下：

```
echo crypt('string', '_....salt');//error
echo crypt('string', '_A...salt');//fast
echo crypt('string', '_AAAAsalt');//slow 
```

[http://www.php.net/manual/en/function.crypt.php](http://www.php.net/manual/en/function.crypt.php)中所述的解释：

> CRYPT_EXT_DES - 扩展的基于 DES 的散列。“salt”是一个 9 字符的字符串，由一个下划线后跟 4 个字节的迭代计数和 4 个字节的 salt 组成。这些被编码为可打印字符，每个字符 6 位，最低有效字符在前。值 0 到 63 被编码为“./0-9A-Za-z”。在 salt 中使用无效字符会导致 crypt() 失败。

点是可打印的字符，为什么它会返回错误？哪个“顺序”适用于使用的字符，导致“AAAA”的迭代次数比“A ...”多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T19:29:37.107

它在引用的段落中说明了所有内容： - 最低有效字符优先 - 值 0 到 63 被编码为“./0-9A-Za-z”

因此，在您的示例中，“_....salt”意味着 0 轮显然无法工作。并且“_A...salt”小于“_AAAAsalt”，考虑到最不重要的字符首先出现。

“_...Asalt”也将超过“_A...salt”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-07T12:32:13.973

这个问题有点老了，但是当我试图围绕如何在这里创建一个供内部使用的散列类时发现了这个问题，我想出了这个小函数，它将base64编码一个具有适当字符/意义的整数用作 4 个字符的“迭代计数”。可能的值是从 1 到 16,777,215

```
private function base64_int_encode($num){
    $alphabet_raw = "./0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
    $alphabet = str_split($alphabet_raw);
    $arr = array();
    $base = sizeof($alphabet);
    while($num){
        $rem = $num % $base;
        $num = (int)($num / $base);
        $arr[]=$alphabet[$rem];
    }

    $arr = array_reverse($arr);
    $string = implode($arr);

    return str_pad($string, 4, '.', STR_PAD_LEFT);
} 
```

希望它可以帮助某人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-10T12:46:58.037

Klathmon 的代码很好，但有一些错误：

**第一个 - 字母**

```
It is:
./0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
Should be:
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz 
```

**第二 - 字符/数字的顺序**

```
It generates for example: ...z
But it should generate: z... 
```

**改进后的代码：**

```
function base64_int_encode($num) {
  $alphabet_raw='./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
  $alphabet=str_split($alphabet_raw);
  $arr=array();
  $base=sizeof($alphabet);
  while($num) {
    $rem=$num % $base;
    $num=(int)($num / $base);
    $arr[]=$alphabet[$rem];
  }

  $string=implode($arr);

  return str_pad($string, 4, '.', STR_PAD_RIGHT);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-10T12:54:27.453

扩展 DES 中使用的数字系统：

```
.... - 0 (Extended DES error)
/... - 1
0... - 2
1... - 3
2... - 4
3... - 5
4... - 6
5... - 7
6... - 8
7... - 9
8... - 10

z... - 63
./.. - 64
//.. - 65
0/.. - 66
1/.. - 67

Y/.. - 100
61.. - 200
g2.. - 300
E4.. - 400
o5.. - 500
M7.. - 600
w8.. - 700
UA.. - 800
2C.. - 900
cD.. - 1000

zz.. - 4095
../. - 4096
/./. - 4097
0./. - 4098
1./. - 4099

xzzz - 16 777 213
yzzz - 16 777 214
zzzz - 16 777 215 
```

与盐有关：

```
_/...salt - 1
_0...salt - 2
_1...salt - 3
_2...salt - 4
_3...salt - 5
_4...salt - 6
_5...salt - 7
_6...salt - 8
_7...salt - 9
_8...salt - 10

_z...salt - 63
_./..salt - 64
_//..salt - 65
_0/..salt - 66
_1/..salt - 67

_Y/..salt - 100
_61..salt - 200
_g2..salt - 300
_E4..salt - 400
_o5..salt - 500
_M7..salt - 600
_w8..salt - 700
_UA..salt - 800
_2C..salt - 900
_cD..salt - 1000

_zz..salt - 4095
_../.salt - 4096
_/./.salt - 4097
_0./.salt - 4098
_1./.salt - 4099

_xzzzsalt - 16 777 213
_yzzzsalt - 16 777 214
_zzzzsalt - 16 777 215 
```

# android - java.lang.unsatisfiedLinkError lib not found :(未能链接 mylib.so)

> ID：15534983
> 
> 赞同：0
> 
> 时间：2013-03-20T21:21:54.130
> 
> 标签：android, c++, android-ndk, cross-compiling

我已经使用 android **ndk 独立工具链成功地将****c++ 库**交叉编译到了 android 平台。我已经使用 jni dolder 和 Android.mk 文件在 Eclipse 中创建了一个新的 android 应用程序项目，当我执行 ndk-build 时，构建进展顺利，并将 mylib.so 添加到 libs/armeabi 文件夹问题是当我执行System.loadLibrary("mylibname"); 我在 logcat 中收到以下错误：无法 dlopen（/data/data/com.oussama.firsttry/lib/libdash.so）：无法加载库：link_image [1995]：无法链接 libdash.so 导致**java .lang.UnsatisfiedLinkError: my lib not found****。

 ****必须有一个库，我的 lib 依赖并且模拟器无法加载它，所以我已经完成了**readelf -d mylib.so**，结果如下：

偏移 0x1617c4 处的动态部分包含 26 个条目：

```
 Tag        Type                         Name/Value
0x00000001 (NEEDED)                     Shared library: [libm.so]
0x00000001 (NEEDED)                     Shared library: [libc.so]
0x00000001 (NEEDED)                     Shared library: [libdl.so]
0x0000000e (SONAME)                     Library soname: [libdash.so]
0x00000010 (SYMBOLIC)                   0x0
0x0000000f (RPATH)                      Library rpath:      [/home/oussama064/libdash/libdash/../../neededLibs]
0x00000019 (INIT_ARRAY)                 0x157268
0x0000001b (INIT_ARRAYSZ)               172 (bytes)
0x0000001a (FINI_ARRAY)                 0x157314
0x0000001c (FINI_ARRAYSZ)               8 (bytes)
0x00000004 (HASH)                       0xf4
0x00000005 (STRTAB)                     0x10f58
0x00000006 (SYMTAB)                     0x50b8
0x0000000a (STRSZ)                      134112 (bytes)
0x0000000b (SYMENT)                     16 (bytes)
0x00000003 (PLTGOT)                     0x1618b4
0x00000002 (PLTRELSZ)                   1096 (bytes)
0x00000014 (PLTREL)                     REL
0x00000017 (JMPREL)                     0x40dd8
0x00000011 (REL)                        0x31b38
0x00000012 (RELSZ)                      62112 (bytes)
0x00000013 (RELENT)                     8 (bytes)
0x00000018 (BIND_NOW)                   
0x6ffffffb (FLAGS_1)                    Flags: NOW
0x6ffffffa (RELCOUNT)                   7738
0x00000000 (NULL)                       0x0 
```

这是我的 Android.mk 文件：

```
 LOCAL_PATH := $(call my-dir)

 include $(CLEAR_VARS) LOCAL_MODULE    := libcurl  LOCAL_SRC_FILES :=
 ../../../../neededLibs/libcurl.a

 include $(PREBUILT_STATIC_LIBRARY)

 include $(CLEAR_VARS) LOCAL_MODULE    := libxml  LOCAL_SRC_FILES :=
 ../../../../neededLibs/libxml2.a

 include $(PREBUILT_STATIC_LIBRARY)

 include $(CLEAR_VARS) LOCAL_MODULE    := libz  LOCAL_SRC_FILES :=
 ../../../../neededLibs/libz.a

 include $(PREBUILT_STATIC_LIBRARY)

 include $(CLEAR_VARS) LOCAL_MODULE    := m  LOCAL_SRC_FILES :=
 libm.so include $(PREBUILT_SHARED_LIBRARY) include $(CLEAR_VARS)
 LOCAL_MODULE    := dl  LOCAL_SRC_FILES := libdl.so

 include $(PREBUILT_SHARED_LIBRARY) include $(CLEAR_VARS) LOCAL_MODULE
 := c  LOCAL_SRC_FILES := libc.so

 include $(PREBUILT_SHARED_LIBRARY)

 include $(CLEAR_VARS)

 LOCAL_MODULE := d LOCAL_SRC_FILES := libdash.so
 LOCAL_SHARED_LIBRARIES := c m dl 

 LOCAL_STATIC_LIBRARIES := libz libxml libcurl  include
 $(PREBUILT_SHARED_LIBRARY) 
```

我现在真的被卡住了，我无法弄清楚丢失的图书馆是什么

当我执行 ndk-build V=1 -B 时，我得到以下结果：

```
rm -f /home/oussama064/Android/workspace/FirstTry/libs/armeabi/lib*.so 
```

所以依赖性下降了。make: 循环 obj/local/armeabi/libm.so <- obj/local/armeabi/libc.so 依赖被删除。make: 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libm.so 依赖被删除。make: 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libc.so 依赖被删除。make: 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libdl.so 依赖被删除。预建：libdl.so <= /home/oussama064/Android/workspace/FirstTry/jni/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/libdl.so 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libc.so 依赖被删除。make: 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libdl.so 依赖被删除。预建：libdl.so <= /home/oussama064/Android/workspace/FirstTry/jni/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/libdl.so 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libc.so 依赖被删除。make: 循环 obj/local/armeabi/libdl.so <- obj/local/armeabi/libdl.so 依赖被删除。预建：libdl.so <= /home/oussama064/Android/workspace/FirstTry/jni/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/libdl.so
obj/local/armeabi/libdl.so 预建：libm.so <= /home/oussama064/Android/workspace/FirstTry/jni/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/libm.so obj/ local/armeabi/libm.so 制作：循环 obj/local/armeabi/libc.so <- obj/local/armeabi/libc.so 依赖项已删除。预建：libc.so <= /home/oussama064/Android/workspace/FirstTry/jni/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/libc.so obj/local/armeabi/libc.so 安装： libc.so => /home/oussama064/Android/workspace/FirstTry/libs/armeabi/libc.so install -p ./obj/local/armeabi/libc.so
/home/oussama064/Android/workspace/FirstTry/libs/ armeabi/libc.so /home/oussama064/NDK/android-ndk-r8d/toolchains/arm-linux-androideabi- 4.
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libc.so 预建：libxml2.a <=
/home/oussama064/Android/workspace/FirstTry/jni/../../../../ requiredLibs/ cp -f
/home/oussama064/Android/workspace/FirstTry/jni/../../../../neededLibs/libxml2.a obj/local/armeabi/libxml2.a 预建：libcurl.a < = /home/oussama064/Android/workspace/FirstTry/jni/../../../../neededLibs/ cp -f /home/oussama064/Android/workspace/FirstTry/jni/../../ ../../neededLibs/libcurl.a
obj/local/armeabi/libcurl.a 预建：libdash.so <= /home/oussama064/Android/workspace/FirstTry/jni/

```
cp -f /home/oussama064/Android/workspace/FirstTry/jni/libdash.so      
obj/local/armeabi/libdash.so
Install        : libdash.so =>   
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdash.so
install -p ./obj/local/armeabi/libdash.so    
 /home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdash.so
/home/oussama064/NDK/android-ndk-r8d/toolchains/arm-linux-androideabi-
4.6/prebuilt/linux-x86/bin/arm-linux-androideabi-strip --strip-unneeded  
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdash.so
Install        : libdl.so => 
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdl.so

install -p ./obj/local/armeabi/libdl.so 
```

/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdl.so
/home/oussama064/NDK/android-ndk-r8d/toolchains/arm-linux-androideabi-4.6/prebuilt/linux-x86/bin/arm -linux-androideabi-strip --strip-不需要

```
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libdl.so
Install        : libm.so =>   
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libm.so
install -p ./obj/local/armeabi/libm.so
/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libm.so
/home/oussama064/NDK/android-ndk-r8d/toolchains/arm-linux-androideabi-     

4.6/prebuilt/linux-x86/bin/arm-linux-androideabi-strip --strip-unneeded    

/home/oussama064/Android/workspace/FirstTry/libs/armeabi/libm.so 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-10T16:46:14.973

您应该使用系统版本的 libm、libc 和 libdl 共享库，

```
LOCAL_LDLIBS := -lm -ldl 
```

如果不能，请静态链接它们。****

# python - 向必须共享环境的 bash shell 发送多个命令

> ID：15534992
> 
> 赞同：3
> 
> 时间：2013-03-20T21:22:29.150
> 
> 标签：python, bash

我试图在这里遵循这个答案：[https ://stackoverflow.com/a/5087695/343381](https://stackoverflow.com/a/5087695/343381)

我需要在单个环境中执行多个 bash 命令。我的测试用例很简单：

```
import subprocess
cmd = subprocess.Popen(['bash'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)

# Write the first command
command = "export greeting=hello\n"
cmd.stdin.write(command)
cmd.stdin.flush() # Must include this to ensure data is passed to child process
result = cmd.stdout.read()
print result

# Write the second command
command = "echo $greeting world\n"
cmd.stdin.write(command)
cmd.stdin.flush() # Must include this to ensure data is passed to child process
result = cmd.stdout.read()
print result 
```

我期望发生的事情（基于引用的答案）是我看到打印了“hello world”。实际发生的是它挂在第一个上`cmd.stdout.read()`，并且永远不会返回。

谁能解释为什么`cmd.stdout.read()`永远不会回来？

笔记：

*   在同一环境中从 python 运行多个 bash 命令是绝对必要的。因此， subprocess.communicate() 没有帮助，因为它等待进程终止。
*   请注意，在我的真实测试用例中，它不是要执行的 bash 命令的静态列表。逻辑更加动态。我没有一次运行所有这些的选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T21:55:48.850

你在这里有两个问题：

1.  您的第一个命令不会产生任何输出。所以第一次读块等待一些。
2.  您正在使用 read() 而不是 readline() - read() 将阻塞，直到有足够的数据可用。

以下修改后的代码（使用 Martjin 的投票建议更新）工作正常：

```
import subprocess
import select

cmd = subprocess.Popen(['bash'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)

poll = select.poll()
poll.register(cmd.stdout.fileno(),select.POLLIN)

# Write the first command
command = "export greeting=hello\n"
cmd.stdin.write(command)
cmd.stdin.flush() # Must include this to ensure data is passed to child process
ready = poll.poll(500)
if ready:
   result = cmd.stdout.readline()
   print result

# Write the second command
command = "echo $greeting world\n"
cmd.stdin.write(command)
cmd.stdin.flush() # Must include this to ensure data is passed to child process
ready = poll.poll(500)
if ready:
   result = cmd.stdout.readline()
   print result 
```

以上有 500 毫秒超时 - 根据您的需要进行调整。

# kernel - /dev/video0 : 无效参数

> ID：15534994
> 
> 赞同：5
> 
> 时间：2013-03-20T21:22:33.587
> 
> 标签：kernel, device, webcam, linux-device-driver, device-driver

为什么我无法读取此文件。我尝试用 cat 读取这个文件：

```
cat /dev/video0 
```

但它说

```
cat: /dev/video0 : invalid arguments 
```

同样，如果我尝试使用 dd as ：

```
dd if=/dev/video0 ~/vid 
```

它仍然无法读取它。

请注意，video0 是我的网络摄像头的设备文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-09-22T10:07:48.610

在这种情况下，了解更多信息的一种方法是在*strace中运行命令*

```
strace cat /dev/video0 
```

这将显示故障点的更多详细信息：

```
....
open("/dev/video0", O_RDONLY)           = 3
fstat(3, {st_mode=S_IFCHR|0660, st_rdev=makedev(81, 0), ...}) = 0
fadvise64(3, 0, 0, POSIX_FADV_SEQUENTIAL) = 0
read(3, 0x2379000, 65536)               = -1 EINVAL (Invalid argument)
.... 
```

在我的情况下，这似乎是说我的 /dev/video0 设备不支持所需的操作：所以在这种情况下，'cat' 正在尝试从设备读取 64k 字节。

但是，我发现使用 nc (netcat) 代替 cat 确实可以达到这个目的：

```
nc -l 1234 </dev/video0 
```

有相应的：

```
nc 127.0.0.1 1234 | mplayer tv://device=/dev/stdin 
```

在本地显示；SSH 隧道端口也可以在这里工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-10T14:14:39.110

我用：

`dd if=/dev/video0 of=~/movie.mpg`

然后

`vlc movie.mpg`

但我使用 PVRUSB2 mpg 编码器/解码器作为源。

在您的 dd 调用中，您可能会考虑使用“of”构造的重定向“>”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-29T06:23:13.330

我认为您在驱动程序中创建的设备节点“video0”的显示功能可能是错误的。

下面举个例子。

```
static DEVICE_ATTR(video0, S_IRUGO|S_IWUSR|S_IWGRP|S_IWOTH, video0_show, video0_store);

static ssize_t video0_show(struct device *dev, struct device_attribute *attr, char *buf);

static ssize_t video0_store(struct device *dev, struct device_attribute *attr, char *buf, size_t count); 
```

当您在运行时 cat 设备节点“video0”时，它会调用“video0_show”函数来打印一些东西。错误消息“cat: /dev/video0 : invalid arguments”表示 video0_show 函数的参数错误。您应该调试驱动程序。