# StackOverflow 问答 12827000-12827999

# java - Spring - 解耦与性能

> ID：12827003
> 
> 赞同：3
> 
> 时间：2012-10-10T19:35:57.007
> 
> 标签：java, spring, spring-mvc, standards

我有一个包含以下 java 文件的应用程序：

服务：

```
AccountService.java
UserService.java
MessageService.java 
```

DAO：

```
AccountDAO.java
UserDAO.java
MessageDAO.java 
```

表：

```
ACCOUNTS
USERS
MESSAGES 
```

在`MessageService.java`中，我有一个`newMessage()`必须从所有 3 个表中查询数据的函数。

(1) 根据 Spring 的解耦标准，应该这样调用：

```
 AccountDAO.java -- ACCOUNTS
                    /
MessageService.java -- MessageDAO.java -- MESSAGES
                    \
                     UserDAO.java -- USERS 
```

但问题是，这种方法会进行 3 次 DB 调用。

(2) 为了获得更好的性能，我会这样做：

```
MessageService.java -- MessageDAO.java -- Join ACCOUNTS, MESSAGES and USERS 
```

但是这样，它是紧密耦合的，如果 USERS 表发生变化，我将不得不更改 MessageDAO.java（以及我拥有的所有其他使用 USERS 表的 DAO）。这真的很糟糕，因为（在非假设的情况下）我们有很多 DAO

哪种方法被认为是更好的做法？还是我缺少另一种方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:34:01.163

> 根据 Spring 的解耦标准，这就是调用的方式

这是错误的。Spring 没有“解耦标准”。请在 Spring 文档中找到我的参考资料，该参考资料告诉您必须如何构建持久层代码。

通常，您的应用程序要操作的每个“实体”都有一个 DAO，但是如果将这种模式发挥到极致，即解构将多个表连接成三个不同查询的查询，那将是愚蠢的。

如果您需要一种`newMessage()`在查询中将一些表连接在一起的方法，请选择最有意义的 DAO - 可能`MessageDAO`并以有意义的方式编写查询/方法。

但是没有规定必须对每个实体有不同的查询，并且不允许一个 DAO 类进行涉及其他实体表的查询。这太极端了，没有任何好处。

另一方面，如果您担心拥有多个知道所有表的数据层类的可维护性，那么请研究 Parsifal 提到的 ORM 解决方案以减轻其中的一些工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-10T20:55:00.040

另一种方法是使用诸如 Hibernate 之类的 ORM，将每个表映射到一个实体。然后定义这些实体之间的逻辑关系。例如，用户和消息之间的 1:M 关系。当你的表改变时，你的映射需要改变，但你的 SQL 不会改变（因为 Hibernate 会生成它）。

对于大多数关系，Hibernate 非常擅长创建连接以在一个查询中检索相关实体。您可以控制是否发生这种情况；我建议使用延迟加载作为大多数关系的默认值，并根据需要切换到急切加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T20:59:28.980

如果数据可能在一个查询和下一个查询之间发生变化，那么作为 3 个单独的查询执行此操作可能会影响正确性。不要让（你的想法）Spring 的指导方针让你编写得到错误结果的代码。

听起来 SQL 中的连接是正确的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T11:18:57.180

无论您采用哪种方法，它始终是在解耦和性能之间找到一个最佳点。它甚至适用于层数的选择等。

所以我想正如@mattb 推荐的那样，如果在特定上下文中有意义，那么在 DAO 中加入表是完全可以的

# java - 在 Liferay Social Office 中结合任务和工作流

> ID：12827011
> 
> 赞同：0
> 
> 时间：2012-10-10T19:36:28.223
> 
> 标签：java, workflow, liferay, liferay-6

我目前正在使用它的社交办公插件测试 Liferay 6.1 CE。我已经设法使用 Kaleo 创建了一个自定义工作流程，并让一些测试用户通过它工作。但是，Social Office 中的“任务”面板和控制面板中的“我的工作流程”portlet 似乎是两个完全独立的实体。

我真的很喜欢用户在被分配任务时收到警报的方式，并且希望我的自定义工作流程也能做同样的事情。这可能吗？我不希望用户必须检查他们的控制面板以获取工作流请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T09:17:16.377

要检查用户之间的关系，您需要检查工作流任务 Portlet 和工作流实例 Portlet，尽管他们一个是创建者用户，一个是受让人，这在工作流任务 Portlet 中可用。要检查每个步骤的用户状态，我们可以使用工作流日志，其中包含完整的信息。

# iphone - iPhone Adwhirl 3.2 InMobi 集成

> ID：12827019
> 
> 赞同：0
> 
> 时间：2012-10-10T19:36:55.883
> 
> 标签：iphone, adwhirl, inmobi

我正在尝试将 InMobi 3.6.0 SDK 集成到 iPhone 上的 adWhirl 3.2 中。由于以下错误，无法构建应用程序：

```
- (GenderType)gender;     Error: Expected a type 
```

我尝试将 .h 和 .m 文件用于 adwhirl 3.0 InMobiAdapter，但它们也会返回错误。请帮我解决这个问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:42:52.433

好的，问题解决了。以下是需要更换的 SDK 和适配器的链接：http: [//developer.inmobi.com/wiki/index.php ?title=InMobi_AdWhirl_Adapter_SDK_3.6.0](http://developer.inmobi.com/wiki/index.php?title=InMobi_AdWhirl_Adapter_SDK_3.6.0)

# c# - 创建泛型列表

> ID：12827023
> 
> 赞同：5
> 
> 时间：2012-10-10T19:37:09.190
> 
> 标签：c#, generics, collections

我的实体有基类

```
public class Entity<T> where T : Entity<T>, new()
{
    public XElement ToXElement()
    {
    }
    public static T FromXElement(XElement x)
    {
    }
} 
```

我必须使用这种奇怪的结构`Entity<T> where T : Entity<T>`，因为我希望静态方法 FromXElement 是强类型的另外，我有一些实体，比如

```
public class Category : Entity<Category>
{
}
public class Collection : Entity<Collection>
{
} 
```

如何使用基类创建我的实体的通用列表？

```
var list = new List<Entity<?>>();
list.Add(new Category());
list.Add(new Collection()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T19:40:58.710

你不能用那个定义。`Category`和之间没有“公共基类” `Collection`（当然，除了`object`）。

如果有*，*说如果`Entity<T>`被定义为：

```
public class Entity
{
}

public class Entity<T> : Entity where T : Entity<T>, new()
{
    public XElement ToXElement()
    {
    }
    public static T FromXElement(XElement x)
    {
    }
} 
```

那么你可以做

```
var list = new List<Entity>();
list.Add(new Category());
list.Add(new Collection()); 
```

但这会给你带来什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:44:54.717

创建标记界面：

```
public interface IAmAGenericEntity { }

public class Entity<T> where T : IAmAGenericEntity, new()
// ...

public class Category : Entity<T>, IAmAGenericEntity
// ....

var list = new List<IAmAGenericEntity>();
// ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T19:59:07.250

由于缺少`abstract`标记`Entity`，我假设`To`/`FromXElement`使用反射并且应该适用于`Entity`. 我建议您按如下方式构建您的课程：

```
public class Entity
{
    public XElement ToXElement() { ... }

    protected static T FromXElement<T>(XElement x)
        where T : Entity
    {
        ...
    }
}

public class Category : Entity
{
    public static Category : FromXElement(XElement x)
    {
        return FromXElement<Category>(x);
    }
} 
```

“样板”是最小的，它不需要你创造性地绕过类型系统。您不必担心缺乏共同基础或手动转换。如果你愿意，你可以完全消除样板，直接从以下构造你的对象`Entity`：

```
public class Entity
{
    public XElement ToXElement() { ... }

    public static T FromXElement<T>(XElement x)
        where T : Entity
    {
        ...
    }
} 
```

本质上，您所做的是实现一个 C# 不直接支持的类型类。有很多方法可以解决这个缺陷，但我通常发现它们比它们的价值更麻烦，尤其是在涉及静态方法时。如果 C# 支持静态扩展方法，那会很简单，可惜它不支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T19:44:40.830

您可以定义一个非泛型类作为所有实体类的基类

```
public class Entity
{
} 
```

并使实体继承实体

```
public class Entity<T> : Entity where T : Entity<T>, new()
{
} 
```

现在您可以将实体列表创建为：

```
var list = new List<Entity>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T19:44:42.153

您可以通过添加类的非泛型版本来解决此问题

```
class Entity
{
  // methods

  public T As<T>() 
  { 
    if (this is T) return (T)this;
    throw new InvalidCastException();
  }
}

class Entity<T> : Entity where T : Entity<T>, new()

class Cathegory : Entity<T> {} 
```

然后创建基类的列表：

```
var list = new List<Entity>()
list.Add(new Cathegory()); 
```

然后，如果要调用“通用特定”操作，则需要调用“As”函数或简单地转换对象。

# c++ - C++ 子字符串返回错误结果

> ID：12827030
> 
> 赞同：6
> 
> 时间：2012-10-10T19:37:23.657
> 
> 标签：c++, substring

我有这个字符串：

```
std::string date = "20121020"; 
```

我正在做：

```
std::cout << "** Date: " << date << "\n";
std::cout << "Year: " << date.substr(0,4) << "\n";
std::cout << "Month: " << date.substr(4,6) << "\n";
std::cout << "Day: " << date.substr(6,8) << "\n"; 
```

但我得到：

```
** Date: 20121020
Year: 2012
Month: 1020
Day: 20 
```

注意月份应该是`10`，不是`1020`。立场是正确的，什么都试过了，是不是失败了？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-10T19:39:54.040

```
std::cout << "Month: " << date.substr(4,6) << "\n"; 
```

第二个论点是错误的。您正在指定，“给我作为*6 个*字符的子字符串，从位置 4 开始。”

你可能想要：

```
std::cout << "Month: " << date.substr(4,2) << "\n"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T19:40:35.987

试试这个：

```
std::cout << "** Date: " << date << "\n";
std::cout << "Year: " << date.substr(0,4) << "\n";
std::cout << "Month: " << date.substr(4,2) << "\n";
std::cout << "Day: " << date.substr(6,2) << "\n"; 
```

我相信 substr 将 start 和**length**作为参数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-10T19:47:20.063

[http://www.cplusplus.com/reference/string/string/substr/](http://www.cplusplus.com/reference/string/string/substr/)

字符串 substr ( size_t pos = 0, size_t n = npos ) const;

pos 当前字符串对象中要用作子字符串起始字符的字符的位置。如果传递的位置超过了字符串的末尾，则会引发 out_of_range 异常。

n 子串的长度。如果此值会使子字符串跨越当前字符串内容的结尾，则仅使用直到字符串结尾的那些字符。npos 是 size_t 类型元素的最大可能值的静态成员常量值，因此，使用该值时，将 pos 和字符串末尾之间的所有字符用作初始化子字符串。

所以你在代码中的错误是你期望第二个参数是最后一个字符的位置而不是子字符串的长度。

# sql - 创建表并将其从一个 SQL 数据库复制到另一个

> ID：12827032
> 
> 赞同：0
> 
> 时间：2012-10-10T19:37:24.573
> 
> 标签：sql, oracle, crud

假设我有一个生产数据库和一个开发数据库。

该`CUSTOMER_PERMISSIONS`表在开发数据库中创建和填充。

创建表并将其复制`CUSTOMER_PERMISSIONS`到生产数据库的最佳方法是什么？

```
INSERT INTO CUSTOMER_MARKET_PERMS
SELECT * FROM indeiso.dbo.CUSTOMER_MARKET_PERMS 
```

返回

```
INSERT INTO CUSTOMER_MARKET_PERMS
SELECT * FROM inukiso.dbo.CUSTOMER_MARKET_PERMS
Error at Command Line:668 Column:25
Error report:
SQL Error: ORA-00933: SQL command not properly ended
00933\. 00000 -  "SQL command not properly ended"
*Cause:    
*Action: 
```

我正在使用 Oracle 12 数据库系统，但我不确定它为什么会抛出此错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:40:08.220

在 prod 服务器上，您可以执行如下查询：

```
INSERT INTO CUSTOMER_PERMISSIONS
SELECT * FROM [devserver].dbo.CUSTOMER_PERMISSIONS 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:43:30.097

如果您可以不使用查询，并且如果您碰巧使用的是 MSSQL Server，为什么不使用导入/导出向导呢？

右键单击要从中导出的数据库，然后选择任务 -> 导出数据。从那里，按照向导。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T10:56:54.877

您确定您有两个不同的 Oracle 数据库吗？如果是这样，那么您需要在两个数据库之间设置数据库链接。如果我是你，我首先要确保你可以从生产数据库中选择开发数据库中的数据。如果可以，并且两个表相同，那么我看不出您的语句不起作用。

# mysql - 带有回滚的Mysql嵌套事务

> ID：12827036
> 
> 赞同：3
> 
> 时间：2012-10-10T19:37:49.193
> 
> 标签：mysql

有人可以告诉我是否可以从一个过程中调用另一个过程，并且如果任一过程的任何部分失败，则将所有内容回滚？

如果这是可能的，有人可以给我看一个如何实现的小例子吗？

**编辑：**过程“b”失败，但过程“a”仍然在表“a”中插入一行。我的理解是，如果插入的任何部分失败，那么所有内容（两个插入）都会回滚，这不会在此处发生。问题是为什么不呢？

**程序“一”**

```
BEGIN
  DECLARE b INT DEFAULT 0;
  DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;
  DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;

  START TRANSACTION;
    INSERT INTO a(a)
    VALUES(iA);

     CALL b(iB,LAST_INSERT_ID(),@b);
     SELECT @b INTO b;

     IF b !=1 THEN
        ROLLBACK;
      ELSE
        COMMIT;
  END IF;
END 
```

**程序“b”**

```
BEGIN
  DECLARE b INT DEFAULT 0;
  DECLARE EXIT HANDLER FOR SQLWARNING ROLLBACK;
  DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;

  START TRANSACTION;
    INSERT INTO b VALUES(iB,id);
    SET b=1;
  COMMIT;
END; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:44:04.290

您将需要在两个过程中处理事务，但是调用另一个过程的过程应该检查返回值并基于它回滚它的事务。这是内部过程的示例：

[如何检测 MySQL 存储过程中的回滚？](https://stackoverflow.com/questions/4076566/how-to-detect-a-rollback-in-mysql-stored-procedure)

然后，您将检查`p_return_code`并回滚父事务。

> 编辑：

我认为正在发生的是内部 SP COMMIT 或 ROLLBACK 影响外部 SP 事务。这段代码对我有用，如果内部 SP 失败，它会回滚两个插入语句。第一次调用 ab() 有效，插入新用户记录并插入新游戏记录，如果我们从游戏表中删除记录并再次运行 ab()，因为用户 id 已经存在，它会回滚游戏表插入：

```
create procedure ab()
BEGIN
  START TRANSACTION;
    INSERT INTO games (title) VALUES ('bad game');
    CALL ba(@ret);
    IF @ret!=0 THEN
      ROLLBACK;
    ELSE
      COMMIT;
    END IF;
END;

create procedure ba(OUT return_value tinyint unsigned)
BEGIN
  DECLARE exit handler for sqlexception
  BEGIN
    set return_value = 1;
  END;

  INSERT INTO users (id) VALUES(1);
  set return_value = 0;
END; 
```

测试使用`call ab();`

# gwt - PubNub 的 GWT 脚本注入失败

> ID：12827038
> 
> 赞同：0
> 
> 时间：2012-10-10T19:37:54.107
> 
> 标签：gwt, pubnub

GWT 的新手，但到目前为止我很喜欢它。我确实有一个很容易重现的问题。这对我来说是个大问题，因为我想为 PubNub 创建一个 GWT 模块——我们在内部使用的一个实用程序。

我创建了一个演示项目来测试封装，我发现 ScriptInjector/Pubnub 存在一个有趣的问题。

起初我按照 PubNub 的说明进行操作。注意：我已经包含了我的测试帐户的密钥。随意使用它们。

按照说明，我将这两项放在 GWT 项目的 html 文件中（指定了我的密钥）：

```
<div pub-key="pub-b8b75fbd-c4cf-4583-bab9-424af7a7f755" sub-key="sub-5e843c94-1193-11e2-bba9-b116c93082cf" ssl="off" origin="pubsub.pubnub.com" id="pubnub"></div>
<script src="http://cdn.pubnub.com/pubnub-3.1.min.js"></script> 
```

当我这样做时，我可以使用 JSNI 访问 pubnub。这一切都很好。

如果我在此处删除标签并使用以下代码注入脚本，则不起作用。我知道脚本会注入，因为我可以看到成功消息，并且可以在 Chrome 的开发人员工具中看到脚本。

```
 ScriptInjector.fromUrl("http://cdn.pubnub.com/pubnub-3.1.js").setCallback(
                  new Callback<Void, Exception>() {
                     public void onFailure(Exception reason) {
                       Window.alert("Script load failed.");
                     }
                     public void onSuccess(Void result) {
                       Window.alert("Script load success.");
                     }
                  }).inject(); 
```

我觉得这一定与使用延迟脚本访问 DOM 有某种关系，或者因为脚本不是 DOM 的一部分。它正在尝试访问设置 div，但无法...（只是我的猜测）

有什么想法吗？我需要将项目移出 html 文件，因为我需要将此项目模块化以用于其他更大的项目。任何帮助，将不胜感激。

（PS，我也尝试创建 html 小部件，并将它们添加到 EntryPoint。这也会根据我在 Chrome 中的开发人员工具中的浏览将标签添加到页面，但它无法正常工作，就像 ScriptInjector 失败一样。）

编辑：这是一个我可以用来演示问题的简单项目：

.html 文件：

在结束正文标签上方：

```
<div pub-key="pub-b8b75fbd-c4cf-4583-bab9-424af7a7f755" sub-key="sub-5e843c94-1193-11e2-bba9-b116c93082cf" ssl="off" origin="pubsub.pubnub.com" id="pubnub"></div>
<script src="http://cdn.pubnub.com/pubnub-3.1.min.js"></script>
<script src="pubnubWrapper.js"></script> 
```

pubnubWrapper.js（基本上是 pubnub 网站上的内容）：

```
function subToPubNub(){
    PUBNUB.subscribe({
        channel    : "hello_world",      // CONNECT TO THIS CHANNEL.

        restore    : false,              // STAY CONNECTED, EVEN WHEN BROWSER IS CLOSED
                                         // OR WHEN PAGE CHANGES.

        callback   : function(message) { // RECEIVED A MESSAGE.
            alert(message);
        },

        disconnect : function() {        // LOST CONNECTION.
            alert(
                "Connection Lost." +
                "Will auto-reconnect when Online."
            )
        },

        reconnect  : function() {        // CONNECTION RESTORED.
            alert("And we're Back!")
        },

        connect    : function() {        // CONNECTION ESTABLISHED.

            PUBNUB.publish({             // SEND A MESSAGE.
                channel : "hello_world",
                message : "Hi from PubNub."
            })

        }
    })
} 
```

ScriptTest.java：

```
public class ScriptTest implements EntryPoint {
    public void onModuleLoad() {
        //add a button to sub to pubnub
        Button subButton = new Button("Sub");
        //add the event handler for button
        subButton.addClickHandler(new ClickHandler() {
            public void onClick(ClickEvent event) {
                //sub to pubnub
              callSub();
            }
          });
        RootPanel.get().add(subButton);
    }
    public native void callSub() /*-{
        //call my wrapper to pubnub
        $wnd.subToPubNub();
    }-*/;
} 
```

这一切都按原样工作。

如果您从 html 文件中删除 pubnub 脚本并使用脚本注入器添加它，则会失败。如果将脚本添加到 gwt.xml 文件，则会失败。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T06:52:50.870

你能发布你的JSNI代码吗？
我敢打赌，您是通过`$wnd`变量访问 PubNub 吗？
如果您将脚本标签放在模块的 xml 文件中，则 pubnub 代码将加载到主机的页面窗口中（您可以使用 Chrome DeveloperTools 进行检查）。

`ScriptInjector`默认情况下不会加载它，而是在 GWT 命名空间中。因此，为了将其加载到主机的窗口命名空间中，您必须`TOP_WINDOW`将`ScriptInjector`

```
ScriptInjector.fromUrl("http://cdn.pubnub.com/pubnub-3.1.js").setCallback(
    new Callback<Void, Exception>() {
        public void onFailure(Exception reason) {
            Window.alert("Script load failed.");
        }
        public void onSuccess(Void result) {
            Window.alert("Script load success.");
        }
}).setWindow(ScriptInjector.TOP_WINDOW).inject(); 
```

# vbscript - 使用 VBSCRIPT 将调用 URL 传递给被调用页面

> ID：12827039
> 
> 赞同：2
> 
> 时间：2012-10-10T19:37:57.547
> 
> 标签：vbscript

我想我需要 vbscript 来解决这个任务。

我有5个`foster mother`页面可以调用一个`daughter`页面。

`Daughter`page 可以调用 3 个不同的`Friend`页面并返回到`daughter`页面。

我希望`daughter`页面能够返回到它称为养父母

例如：

> > “myurl = 主页 1.htm”
> > 
> > "myurl = 主页 2.htm
> > 
> > “myurl = 主页 3.htm”等

因此`daughter`将“myurl”作为主页 1 或 2 或 3 等。

window-history-back 在这种情况下不起作用，因为`daughter`最终会返回到上一个调用`friend`页面。

这是在客户端 PC 上，因此不能使用服务器端方法。

# apache - 用于 ARM - Linux 平台的交叉编译 Apache apr-util 库

> ID：12827040
> 
> 赞同：2
> 
> 时间：2012-10-10T19:37:58.033
> 
> 标签：apache, arm, embedded-linux

第一次发帖~

我正在尝试将 ActiveMQ-cpp 客户端移植到 ARM 平台（Beaglebone/BeagleBoard） - 因为我在我的 PC 上进行开发，所以我需要交叉编译 ActiveMQ-cpp 库才能运行在 ARM 系统上。

我按照他们的[构建指令](http://activemq.apache.org/cms/building.html)中的步骤进行操作，除了我使用以下代码编译 APR 和 APR-util 库：

对于 4 月：

./configure --prefix=/usr/arm-linux-gnueabi/apr --host=arm-linux-gnueabi CC="arm-linux-gnueabi-gcc" CXX="arm-linux-gnueabi-g++" 我跑进行安装，一切都很好。

对于 APR 实用程序：

./configure --prefix=/usr/arm-linux-gnueabi/apr-util --host=arm-linux-gnueabi -with-apr=/usr/arm-linux-gnueabi/apr CC="arm-linux- gnueabi-gcc" CXX="arm-linux-gnueabi-g++" 我运行 make install 得到了这个：

```
/home/peter/apache/Apache_apr/apr-util-1.5.1/xml/expat/.libs/libexpat.so: could not read symbols: File in wrong format 
```

经过一番搜索，我“认为”问题在于 libexpat 格式错误（为 i386 编译？）

我的问题是：如何为 ARM 平台正确编译 ActiveMQ-cpp 库？有什么方法可以修复 libexpat.so 吗？还是跳过 Apr-util？还是 ./configure 中的某个选项用于 Apr-util？

跟进：这是运行配置的日志文件：

```
checking build system type... i686-pc-linux-gnu
checking host system type... arm-unknown-linux-gnueabi
checking target system type... arm-unknown-linux-gnueabi
checking for a BSD-compatible install... /usr/bin/install -c
checking for working mkdir -p... yes
APR-util Version: 1.5.1
checking for chosen layout... apr-util
checking for arm-linux-gnueabi-gcc... arm-linux-gnueabi-gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... yes
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether arm-linux-gnueabi-gcc accepts -g... yes
checking for arm-linux-gnueabi-gcc option to accept ISO C89... none needed
Applying apr-util hints file rules for arm-unknown-linux-gnueabi
checking for APR... yes
  setting CPP to "gcc -E"
  adding "-pthread" to CFLAGS
  setting CPPFLAGS to " -D_REENTRANT -D_GNU_SOURCE -D_LARGEFILE64_SOURCE"
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for ldap support...
checking for default DBM... sdbm (default)
checking for pg_config... no
checking libpq-fe.h usability... no
checking libpq-fe.h presence... no
checking for libpq-fe.h... no
checking postgresql/libpq-fe.h usability... no
checking postgresql/libpq-fe.h presence... no
checking for postgresql/libpq-fe.h... no
checking sqlite3.h usability... no
checking sqlite3.h presence... no
checking for sqlite3.h... no
checking sqlite.h usability... no
checking sqlite.h presence... no
checking for sqlite.h... no
checking sybdb.h usability... no
checking sybdb.h presence... no
checking for sybdb.h... no
checking freetds/sybdb.h usability... no
checking freetds/sybdb.h presence... no
checking for freetds/sybdb.h... no
checking for odbc_config... no
checking sql.h usability... no
checking sql.h presence... no
checking for sql.h... no
checking odbc/sql.h usability... no
checking odbc/sql.h presence... no
checking for odbc/sql.h... no
checking Expat 1.95.x... no
checking old Debian-packaged expat... no
checking old FreeBSD-packaged expat... no
checking Expat 1.0/1.1... no
  setting LDFLAGS to "-L/usr/local/lib"
  adding "-I/usr/local/include" to CPPFLAGS
checking Expat 1.95.x in /usr/local... no
  nulling LDFLAGS
  removed "-I/usr/local/include" from CPPFLAGS
configuring package in xml/expat now
checking build system type... i686-pc-linux-gnu
checking host system type... arm-unknown-linux-gnueabi
checking target system type... arm-unknown-linux-gnueabi
checking how to print strings... printf
checking for arm-linux-gnueabi-gcc... arm-linux-gnueabi-gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... yes
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether arm-linux-gnueabi-gcc accepts -g... yes
checking for arm-linux-gnueabi-gcc option to accept ISO C89... none needed
checking for a sed that does not truncate output... /bin/sed
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for fgrep... /bin/grep -F
checking for ld used by arm-linux-gnueabi-gcc... /usr/arm-linux-gnueabi/bin/ld
checking if the linker (/usr/arm-linux-gnueabi/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/arm-linux-gnueabi-nm -B
checking the name lister (/usr/bin/arm-linux-gnueabi-nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 1572864
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands "+="... yes
checking how to convert i686-pc-linux-gnu file names to arm-unknown-linux-gnueabi format... func_convert_file_noop
checking how to convert i686-pc-linux-gnu file names to toolchain format... func_convert_file_noop
checking for /usr/arm-linux-gnueabi/bin/ld option to reload object files... -r
checking for arm-linux-gnueabi-objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for arm-linux-gnueabi-dlltool... dlltool
checking how to associate runtime and link libraries... printf %s\n
checking for arm-linux-gnueabi-ar... arm-linux-gnueabi-ar
checking for archiver @FILE support... @
checking for arm-linux-gnueabi-strip... arm-linux-gnueabi-strip
checking for arm-linux-gnueabi-ranlib... arm-linux-gnueabi-ranlib
checking for gawk... no
checking for mawk... mawk
checking command to parse /usr/bin/arm-linux-gnueabi-nm -B output from arm-linux-gnueabi-gcc object... ok
checking for sysroot... no
checking for arm-linux-gnueabi-mt... no
checking for mt... mt
configure: WARNING: using cross tools not prefixed with host triplet
checking if mt is a manifest tool... no
checking how to run the C preprocessor... arm-linux-gnueabi-gcc -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
checking if arm-linux-gnueabi-gcc supports -fno-rtti -fno-exceptions... no
checking for arm-linux-gnueabi-gcc option to produce PIC... -fPIC -DPIC
checking if arm-linux-gnueabi-gcc PIC flag -fPIC -DPIC works... yes
checking if arm-linux-gnueabi-gcc static flag -static works... yes
checking if arm-linux-gnueabi-gcc supports -c -o file.o... yes
checking if arm-linux-gnueabi-gcc supports -c -o file.o... (cached) yes
checking whether the arm-linux-gnueabi-gcc linker (/usr/arm-linux-gnueabi/bin/ld) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
checking for arm-linux-gnueabi-gcc... (cached) arm-linux-gnueabi-gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether arm-linux-gnueabi-gcc accepts -g... (cached) yes
checking for arm-linux-gnueabi-gcc option to accept ISO C89... (cached) none needed
checking for a BSD-compatible install... /usr/bin/install -c
checking for ANSI C header files... (cached) yes
checking for an ANSI C-conforming const... yes
checking for size_t... yes
checking for memmove... yes
checking for bcopy... yes
checking check.h usability... no
checking check.h presence... no
checking for check.h... no
configure: creating ./config.status
config.status: creating Makefile
config.status: creating expat_config.h
config.status: expat_config.h is unchanged
config.status: executing libtool commands
xml/expat configured properly
  setting APRUTIL_INCLUDES to "-I/home/jacky/apache/Apache_apr/apr-util-1.5.1/xml/expat/lib"
  setting LDFLAGS to "-L/home/jacky/apache/Apache_apr/apr-util-1.5.1/xml/expat/lib"
  setting APRUTIL_EXPORT_LIBS to "/home/jacky/apache/Apache_apr/apr-util-1.5.1/xml/expat/libexpat.la"
  setting APRUTIL_LIBS to "/home/jacky/apache/Apache_apr/apr-util-1.5.1/xml/expat/libexpat.la"
checking iconv.h usability... yes
checking iconv.h presence... yes
checking for iconv.h... yes
checking for type of inbuf parameter to iconv... char **
checking for iconv.h... (cached) yes
checking langinfo.h usability... yes
checking langinfo.h presence... yes
checking for langinfo.h... yes
checking for nl_langinfo... yes
checking for CODESET in langinfo.h... yes
checking whether APR has DSO support... yes
checking for library containing crypt... -lcrypt
checking if system crypt() function is threadsafe... no
checking for crypt_r... yes
checking style of crypt_r... struct_crypt_data
  adding "/usr/arm-linux-gnueabi/apr/lib/libapr-1.la" to APRUTIL_LIBS
  adding "-luuid" to APRUTIL_LIBS
  adding "-lrt" to APRUTIL_LIBS
  adding "-lcrypt" to APRUTIL_LIBS
  adding "-lpthread" to APRUTIL_LIBS
  adding "-ldl" to APRUTIL_LIBS
configure: creating ./config.status
config.status: creating Makefile
config.status: creating export_vars.sh
config.status: creating build/pkg/pkginfo
config.status: creating apr-util.pc
config.status: creating apu-1-config
config.status: creating include/private/apu_select_dbm.h
config.status: creating include/apr_ldap.h
config.status: creating include/apu.h
config.status: creating include/apu_want.h
config.status: creating test/Makefile
config.status: creating include/private/apu_config.h
config.status: executing default commands 
```

据我所知，xml/expat 配置正确。我想 - 也许我需要在 gcc-arm-linux 中编译 expat 库？我继续这样做，然后再次运行配置：

./configure --prefix=/usr/arm-linux-gnueabi/apr-util --host=arm-linux-gnueabi -with-apr=/usr/arm-linux-gnueabi/apr -with-expat=/usr /arm-linux-gnueabi/expat CC="arm-linux-gnueabi-gcc" CXX="arm-linux-gnueabi-g++"

我在日志中得到了类似的结果，除了我现在有 Expat 1.95.x：

```
checking for odbc/sql.h... no
  setting LDFLAGS to "-L/usr/arm-linux-gnueabi/expat/lib"
  adding "-I/usr/arm-linux-gnueabi/expat/include" to CPPFLAGS
  setting APRUTIL_INCLUDES to "-I/usr/arm-linux-gnueabi/expat/include"
  setting APRUTIL_LDFLAGS to "-L/usr/arm-linux-gnueabi/expat/lib"
checking Expat 1.95.x... yes
  setting APRUTIL_EXPORT_LIBS to "-lexpat"
  setting APRUTIL_LIBS to "-lexpat" 
```

运行make，出现同样的错误。

我搜索了与 libexpat.so 相关的错误。我注意到那些想要交叉编译的人通常会看到这个“libexpat.so”错误：使用[centos 5.2 64bits](http://www.directadmin.com/forum/showthread.php?t=27045&page=1)，或者使用 Xeon 64bit 的其他情况。

以下是实际导致错误的命令：

```
make[1]: Entering directory `/home/jacky/apache/Apache_apr/apr-util-1.5.1'
/bin/bash /usr/arm-linux-gnueabi/apr/build-1/libtool --silent --mode=link  gcc -g -O2 -pthread   -DHAVE_CONFIG_H -D_REENTRANT -D_GNU_SOURCE -D_LARGEFILE64_SOURCE   -I/home/jacky/apache/Apache_apr/apr-util-1.5.1/include -I/home/jacky/apache/Apache_apr/apr-util-1.5.1/include/private  -I/usr/arm-linux-gnueabi/apr/include/apr-1  -I/usr/arm-linux-gnueabi/expat/include  -version-info 5:1:5    -o libaprutil-1.la -rpath /usr/arm-linux-gnueabi/apr-util/lib buckets/apr_brigade.lo buckets/apr_buckets.lo buckets/apr_buckets_alloc.lo buckets/apr_buckets_eos.lo buckets/apr_buckets_file.lo buckets/apr_buckets_flush.lo buckets/apr_buckets_heap.lo buckets/apr_buckets_mmap.lo buckets/apr_buckets_pipe.lo buckets/apr_buckets_pool.lo buckets/apr_buckets_refcount.lo buckets/apr_buckets_simple.lo buckets/apr_buckets_socket.lo crypto/apr_crypto.lo crypto/apr_md4.lo crypto/apr_md5.lo crypto/apr_passwd.lo crypto/apr_sha1.lo crypto/crypt_blowfish.lo crypto/getuuid.lo crypto/uuid.lo dbd/apr_dbd.lo dbm/apr_dbm.lo dbm/apr_dbm_sdbm.lo dbm/sdbm/sdbm.lo dbm/sdbm/sdbm_hash.lo dbm/sdbm/sdbm_lock.lo dbm/sdbm/sdbm_pair.lo encoding/apr_base64.lo hooks/apr_hooks.lo ldap/apr_ldap_stub.lo ldap/apr_ldap_url.lo memcache/apr_memcache.lo misc/apr_date.lo misc/apr_queue.lo misc/apr_reslist.lo misc/apr_rmm.lo misc/apr_thread_pool.lo misc/apu_dso.lo misc/apu_version.lo strmatch/apr_strmatch.lo uri/apr_uri.lo xlate/xlate.lo xml/apr_xml.lo    -luuid -lrt -lcrypt  -lpthread -ldl -L/usr/arm-linux-gnueabi/expat/lib -lexpat /usr/arm-linux-gnueabi/apr/lib/libapr-1.la -luuid -lrt -lcrypt -lpthread -ldl
/usr/arm-linux-gnueabi/expat/lib/libexpat.so: could not read symbols: File in wrong format
collect2: ld returned 1 exit status
make[1]: *** [libaprutil-1.la] Error 1
make[1]: Leaving directory `/home/jacky/apache/Apache_apr/apr-util-1.5.1'
make: *** [all-recursive] Error 1 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T05:47:05.067

看来您之前以不同的格式构建了一些库。由于您收到错误： File in wrong format collect2: ld returned 1 exit status 在 /usr/arm-linux-gnueabi/expat/lib/libexpat.so 上运行文件命令 如果它显示某些不同的格式，那么您需要重建它。但它很奇怪，因为我认为它是一个预构建的 arm 库，它应该是正确的格式。

# validation - JSF - 类似于 viewParam 的 bean 属性验证？

> ID：12827042
> 
> 赞同：0
> 
> 时间：2012-10-10T19:38:03.530
> 
> 标签：validation, jsf, properties, viewparams

是否有类似的东西`f:viewParam`可以检查给定属性是否存在，如果不存在则打印消息？

例如，我有一个购物车网站，用户被重定向到该网站。购物车位于会话范围内。在第二个站点上，应该在我想使用此验证的地方显示扩展购物车。

有许多用例，例如，如果将存储在会话中的用户访问帐户站点但未登录。

# php - pdo 绑定没有提供价值

> ID：12827044
> 
> 赞同：0
> 
> 时间：2012-10-10T19:38:09.150
> 
> 标签：php, pdo

:cat_id 的值为 9 并且 :tlk_id 的值为 3 如果我手动输入它们，它将以所需的结果运行，但在绑定它们后它给我的行数为零

```
<?

   $sql = ("
       SELECT
           p.post_id as sn,
           p.subject,
           p.username,
           COUNT(thread_id)-1 AS responses,
           MAX(DATE_FORMAT(p.date_posted,'%e-%b-%y %l:  %i    %p')) AS first,
           MAX(DATE_FORMAT(t.date_posted,'%e-%b-%y %l:%i %p')) AS last
       FROM
           posts AS p
       INNER JOIN
           threads AS t 
       USING 
           (post_id) 
       INNER JOIN 
           register AS u 
       ON
           p.username = u.username
       WHERE 
           t.category_id =:cat_id
       AND
           p.category_id =:cat_id
       AND
           t.forum_id = :tlk_id
       AND
           p.forum_id = :tlk_id
       GROUP BY
           (t.post_id)
       ORDER BY
           last DESC
       LIMIT $start,$display
    ");

    $sth = $dbh->prepare($sql);
    $sth->bindParam(':tlk_id',$tlk_id);
    $sth->bindParam(':cat_id',$cat_id);

    $r =  $sth->execute();
    $count = $sth->rowCount();
    echo $count;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:50:14.147

如果你这样做会发生什么：

```
$tlk_id = 3;
$cat_id = 9;

$sth = $dbh->prepare($sql);
$sth->bindParam(':tlk_id',$tlk_id);
$sth->bindParam(':cat_id',$cat_id); 
```

我将这些值分配给一个变量，因为 bindParam 需要一个引用作为第二个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:50:39.823

从错误：

> 参数号无效：参数...

可以看到并不是所有的参数都被处理了。所以也许你可以在这种情况下添加 4 个参数：

```
$sql = "SELECT 
        .....
       WHERE 
           t.category_id =:cat_id_1
       AND
           p.category_id =:cat_id_2
       AND
           t.forum_id = :tlk_id_1
       AND
           p.forum_id = :tlk_id_2
      ....
    ";

    $sth = $dbh->prepare($sql);
    $sth->bindParam(':tlk_id_1',$tlk_id);
    $sth->bindParam(':tlk_id_2',$tlk_id);
    $sth->bindParam(':cat_id_1',$cat_id);
    $sth->bindParam(':cat_id_2',$cat_id); 
```

# c - 尝试在 C 中创建基本数组实用程序

> ID：12827047
> 
> 赞同：0
> 
> 时间：2012-10-10T19:38:13.873
> 
> 标签：c, arrays, header, boolean, malloc

我已经很久没有使用过 C 语言了，因此我忘记了很多关于 C 语言是如何工作的令人尴尬的事情。我正在尝试创建一个标头“arrayUtils.h”和一个相应的“arrayUtils.c”，我在其中定义原型函数。然后我试图在第二个 .c 文件中调用这些函数之一

标题内容：

```
#define _OUT_OF_RANGE_ = NAN

#ifndef INT_ALLOCATE_H
#define INT_ALLOCATE_H
int * allocIntArray(const int size);
#endif

#ifndef INT_ACCESS_H
#define INT_ACCESS_H
int accessIntArray(const int index, const int * array, const bool checked);
#endif

#ifndef INT_FREE_H
#define INT_FREE_H
int freeIntArray(int * array);
#endif 
```

标题来源：

```
/* Allocates an array of integers equal to length size
 * Args: int size: length of the array
 * Return: Allocated array
 */
int * allocIntArray(const int size){
    /*Assert that size of array is greater than zero*/
    if(size <= 0){
        return(-1);
    }
    else{
        return((int*)malloc(size*sizeof(int)));
    }
}
/* Returns the value of the array 
 * Args: int    index:   position in the array to access
 *       int  * array:   array to access
 *       bool   checked: if the access should be checked or not
 * Returns: integer at position index
 */
int accessIntArray(const int index, const int * array, const bool checked){
    /*unchecked access*/
    if(!checked){
        return(array[index]);
    }
    /*checked access*/
    else{
        if(index <= 0){
            return(_OUT_OF_RANGE_)
        }
        double size = (double)sizeof(array)/(double)sizeof(int)
        if(index => (int)size){
            return(_OUT_OF_RANGE_)
        }
        else{
            return(array[index])
        }
    }
}

/* Frees the allocated array 
 * Args: int * array: the array to free
 * Returns: 0 on successful completion
 */
int freeIntArray(int * array){
    free(array);
    return(0);
} 
```

然后调用第二个源文件：

```
#include "arrayUtil.h"
int main(){
    int * array = allocIntArray(20);
    return(0);
} 
```

当我编译时：

```
gcc utilTest.c 
```

我收到此错误：

> arrayUtils.h:10：错误：“检查”之前的语法错误

最初我在 accessIntArray 中使用“bool checked”，得到了同样的错误，但使用 bool 而不是选中的。

对不起，如果这不是一个具体的问题，但我在这里很迷茫。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T19:41:24.340

`bool`不是 C 中的标准类型。C99 语言标准为布尔数据类型添加了新类型，以及分别定义、和映射到、和`_Bool`的头文件。`<stdbool.h>``bool``true``false``_Bool``(_Bool)1``(_Bool)0`

如果您使用 C99 编译器进行编译，请务必`#include <stdbool.h>`在使用`bool`关键字之前进行。如果没有，请自行定义，例如：

```
typedef unsigned char bool;  // or 'int', whichever you prefer
#define true ((bool)1)
#define false ((bool)0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T19:41:00.903

C没有'bool'，你可能只想使用一个int。或 C++，它确实具有布尔类型。

# java - 需要帮助显示来自不同私人课程的价值

> ID：12827050
> 
> 赞同：0
> 
> 时间：2012-10-10T19:38:25.047
> 
> 标签：java

好的，首先我对java非常非常陌生。对于这个项目，我需要设计一个程序，它需要一个产品编号、一个销量，计算总数，然后显示它。但是，当我选择选项 2 时，我需要显示，这是一个单独的私人课程，老实说，我什至不知道从哪里开始。任何帮助，将不胜感激。

```
import java.util.Scanner;

public class Attempt1
{
//method to pause until a key is pressed
public static void pause() 
{ 
    try 
    { 
        System.out.print("Press <Enter> to continue..."); 
        System.in.read(); 
    } 
    catch (Exception e)
    {
        System.err.printf("Error %s%c\n",e.getMessage(),7);
    }
}//end pause

public static void main(String[] args)
{
    //variables to capture keyboard input
    Scanner keyBd = new Scanner( System.in );
    char selection;
    //int selection;

    do{//display menu
        System.out.println("\n--------------");
        System.out.println("Retail Sales\n");
        System.out.println("1\. Enter Products Sold");
        System.out.println("2\. Display Total Retail Sales");
        System.out.println("3\. Exit\n");
        System.out.print  ("Selection: ");

        //get menu selection
        selection = keyBd.next().charAt(0);
        //selection = keyBd.nextInt();

        //process menu selection
        switch (selection){
            case '1':
                enterProducts();
                break;
            case '2':
                displaySales();
                break;
            case '3':               
                //recognize as valid selection but do nothing
                break;
            default :
                //System.out.printf("%c\n",7);
                System.out.println("Invalid Selection");
        }//end switch

    }while( selection != '3');

}//end main()

private static void enterProducts()
{
    Scanner inp = new Scanner(System.in);

    int product,quantity;
    double total = 0.00;

    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt();

    while(product !=0)
        {
        System.out.print("Enter quantity: ");
        quantity=inp.nextInt();
    switch( product ){
    case 1:total+=quantity*2.98;
    break;
    case 2:total+=quantity*4.50;
    break;
    case 3:total+=quantity*3.98;
    break;
    case 4:total+=quantity*4.49;
    break;
    case 5:total+=quantity*6.87;
    break;
    default:System.out.println("Invalid Product Number");
    System.out.println("Product Number Does not Exist");

    if(product<0 && product>=6)
      {
    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt();
    System.out.print("Enter quantity: ");
    quantity=inp.nextInt();
      }
    break;
    }
    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt(); 
    }

    pause();    
    }
private static void displaySales()
{
    System.out.println( "The total retail value was: " + total );
    pause();    
} 
```

}//结束菜单演示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:42:49.927

我认为你的意思是`private` *方法*。你可以像这样传递总数：

```
private static void displaySales(double total) {
... 
```

`total`在显示循环的方法中定义`enterProducts`但不在`main`显示循环的方法中，因此您可以返回：

```
double enterProducts() {
   ...
   return total;
} 
```

这样您就可以将其传递给`displaySales`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:52:39.303

这是改进代码的算法：

1.  在您的 main 开头添加一个变量`total`并将其初始化为 0：`double total=0;`
2.  `enterProducts`将方法的返回类型更改为 double: 并在调用后从该方法`private static double enterProducts()`返回最后的局部变量：`total``pause``return total;`
3.  在输入的情况下，`1`将返回的值从添加`enterProducts`到当前值`total`（它`total`在你的 main 内部）：`total += enterProducts();`
4.  在方法中添加`displaySales`一个双参数：并在 main 的情况下更改`private static void displaySales(double total)`对它的调用`2``displaySales(total);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:02:31.643

代码的问题在于您试图访问在静态 displaySales() 方法内部的静态 enterProducts() 方法中声明的局部变量。

下面的代码解决了这个“问题”。

话虽如此，我建议您阅读一些 Java 教程以了解代码现在可以工作的原因……看看[Variable Scope](http://www.java2s.com/Tutorial/Java/0020__Language/VariableScope.htm)。

```
public class Attempt1
{
//use a static variable to store the total  
static double total = 0.00;

//method to pause until a key is pressed
public static void pause() 
{ 
    try 
    { 
        System.out.print("Press <Enter> to continue..."); 
        System.in.read(); 
    } 
    catch (Exception e)
    {
        System.err.printf("Error %s%c\n",e.getMessage(),7);
    }
}//end pause

public static void main(String[] args)
{
    //variables to capture keyboard input
    Scanner keyBd = new Scanner( System.in );
    char selection;
    //int selection;

    do{//display menu
        System.out.println("\n--------------");
        System.out.println("Retail Sales\n");
        System.out.println("1\. Enter Products Sold");
        System.out.println("2\. Display Total Retail Sales");
        System.out.println("3\. Exit\n");
        System.out.print  ("Selection: ");

        //get menu selection
        selection = keyBd.next().charAt(0);
        //selection = keyBd.nextInt();

        //process menu selection
        switch (selection){
            case '1':
                enterProducts();
                break;
            case '2':
                displaySales();
                break;
            case '3':               
                //recognize as valid selection but do nothing
                break;
            default :
                //System.out.printf("%c\n",7);
                System.out.println("Invalid Selection");
        }//end switch

    }while( selection != '3');

}//end main()

private static void enterProducts()
{
    Scanner inp = new Scanner(System.in);

    int product,quantity;

    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt();

    while(product !=0)
        {
        System.out.print("Enter quantity: ");
        quantity=inp.nextInt();
    switch( product ){
    case 1:total+=quantity*2.98;
    break;
    case 2:total+=quantity*4.50;
    break;
    case 3:total+=quantity*3.98;
    break;
    case 4:total+=quantity*4.49;
    break;
    case 5:total+=quantity*6.87;
    break;
    default:System.out.println("Invalid Product Number");
    System.out.println("Product Number Does not Exist");

    if(product<0 && product>=6)
      {
    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt();
    System.out.print("Enter quantity: ");
    quantity=inp.nextInt();
      }
    break;
    }
    System.out.print("Enter product #(1-5)(0 to stop): ");
    product=inp.nextInt(); 
    }

    pause();    
    }
private static void displaySales()
{
    System.out.println( "The total retail value was: " + total );
    pause();    
}
}//end MenuDemo 
```

# javascript - 从客户端 javascript/jquery 访问 Windows Azure 队列

> ID：12827059
> 
> 赞同：3
> 
> 时间：2012-10-10T19:39:19.080
> 
> 标签：javascript, jquery, azure, azure-storage

对于 UI 功能，我需要从 Windows Azure 队列中读取数据并相应地更新 UI。

我看到很多 node.js 示例，但没有使用纯 Javascript 或 Jquery。（[azureQuery 很](http://azurequery.codeplex.com/documentation)接近，但还没有队列功能，它需要一个 Web API 才能与之交谈）

这是一个使用 asp.net 和 MVC 4 的混合 Web 应用程序。这个特定页面是使用 MVC 4 生成的。

任何建议，将不胜感激。

罗伯托（PS。能够写入队列也很好）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:42:00.467

这不能直接从浏览器中实现。浏览器中的 JavaScript 必须遵循同源策略，这意味着 JavaScript 只能调用当前网页的域。由于您的网页不会从 提供`<account>.queue.windows.net`，这意味着您的 JavaScript 将无法调用该域上的 API。[（如果队列服务提供CORS](https://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing)标头，这在大多数浏览器中都是可能的，但事实并非如此。）

您需要托管一个代理队列消息的 Web 端点（可能在您的 MVC 4 应用程序中）。您的 JavaScript 将向您的 Web 应用程序发送一条消息，而您的 Web 应用程序会将消息放入队列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T04:54:41.210

**更新：请参阅下面的评论并放弃此答案。**

您可以尝试使用队列的共享访问签名 (SAS) 获取消息列表。我刚刚做了一个简单的测试，我为具有“读取”权限的队列创建了一个 SAS。我得到一个类似这样的URI：

youraccount.core.queue.net/queuename?sv=2012-02-12&st=2012-10-11T04%3A31%3A53Z&se=2012-10-11T05%3A31%3A53Z&sp=raup&sig=PN4dyOoOIBlJPQbQ%2Bu7jDLyt%2FpIc3k2k1NZTei67q

使用它我创建了一个用于查看消息的 URI

youraccount.core.queue.net/queuename/messages ?sv=2012-02-12&st=2012-10-11T04% **3A31** %3A53Z&se=2012-10-11T05%3A31%3A53Z&sp=r&sig=PN4dyOoOIBlJPQbQ%2Bu7jDLyt%2FpIc3k2k1NZTEi6% **D =真**

然后我在我的 JavaScript 代码中使用了这个 URI，并在 Fiddler 中跟踪了请求。我能够看到来自 Windows Azure 存储的响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:53:04.453

您可以使用任何支持的语言通过 REST 界面访问 Windows Azure 队列。使用 JavaScript，您可以进行 ajax 调用以连接 Azure 存储队列以读取和写入消息。一旦您掌握了基于 JavaScript + Ajax 的代码，您只需要使用[Azure Queue Storage REST API](http://msdn.microsoft.com/en-us/library/windowsazure/dd179363.aspx)来执行任何操作。

[这](http://social.msdn.microsoft.com/Forums/en/windowsazuredevelopment/thread/c1e5d77e-9692-45df-931a-46237a366493)是一个使用 JavaScript 连接 Azure 存储队列的示例。您可以修改代码以连接到您的真实 Azure 存储队列，它将满足您的需求：

# php - dompdf 和 codeigniter - 执行 load_html 时出现错误 500

> ID：12827063
> 
> 赞同：1
> 
> 时间：2012-10-10T19:39:35.530
> 
> 标签：php, codeigniter, dompdf, internal-server-error

这段代码出现错误 500：

```
require_once FCPATH.'application/helpers/dompdf/dompdf_config.inc.php';
$dompdf = new DOMPDF();
$dompdf->load_html( $html );
$dompdf->render();
$pdf = $dompdf->output();
file_put_contents( './tmp/'.$filename.'.pdf' , $pdf ); 
```

通过一些调试，我发现“邪恶”的代码是这样的

```
$dompdf->load_html( $html ); 
```

我不知道如何解决这个问题。

即使是带有 memory_limit 和 max_execution_time 的“ini_set”指令也不能解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T03:12:56.347

1.  遵循[这个 SO question 中](https://stackoverflow.com/a/2687747/568884)的建议。PHP 可能会将错误冒泡到 Apache。

2.  检查文件和父文件夹的权限`application/helpers/dompdf/dompdf_config.inc.php`，确保它们是可读的。

3.  相信如果你在访问日志中看到500错误，那么错误日志中也会有报告。如果不是，则错误来自 PHP。检查您的服务器日志。请参阅`/var/log/apache2/error.log`和`var/log/apache2/access.log`在 Linux 上。

# ruby - 您如何将动态内容放入操作邮件主题行中？

> ID：12827064
> 
> 赞同：1
> 
> 时间：2012-10-10T19:39:38.803
> 
> 标签：ruby, ruby-on-rails-3, actionmailer

我正在尝试将我的应用程序的名称放在 action mailer 发送的电子邮件的主题行中。使用电子邮件地址的默认值执行此操作没有问题，但是当我尝试将其添加到主题时，它会将其作为纯文本发送`<%= app_name %>`。

这是我的邮件程序/user_mailer.rb：

```
class UserMailer < ActionMailer::Base  
  add_template_helper(ApplicationHelper)
  extend ApplicationHelper

  default from: "#{app_name} <#{system_email}>"

  def reset_password_email(user)
    @user = user
    @url  = "#{root_url}/password_resets/#{user.reset_password_token}/edit"
    mail(:to => user.email,
         :subject => "Reset Your Password | #{app_name}")
  end
end 
```

这是我的应用程序助手中的内容：

```
 def app_name
    'Tip Share'
  end

  def app_domain
    'tipshare.herokuapp.com'
  end

  def system_email
    'info@wingardcreative.com'
  end 
```

既不工作`#{app_name}`也不`<%= app_name %>`工作。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:50:40.903

您是否尝试过像这样添加它：

```
include ApplicationHelper 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:25:14.057

通过扩展`UserMailer`with `ApplicationHelper`，这些方法可以作为类方法使用——这就是引用 in`default from: "#{app_name} <#{system_email}>"`起作用的原因。在该`reset_password_email`方法中，`app_name`将是一个未定义的局部变量。所以你要么需要另外`include ApplicationHelper`，要么用`self.class.app_name`.

# ios - 我可以检测到用户使用 facebook sdk 登录应用程序的*第一次*时间吗？

> ID：12827067
> 
> 赞同：1
> 
> 时间：2012-10-10T19:39:43.237
> 
> 标签：ios, facebook

使用最新的 facebook sdk 3.1，我使用以下命令打开一个请求权限的会话：

```
[FBSession openActiveSessionWithReadPermissions:permissions
                                      allowLoginUI:allowLoginUI
                                 completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
                                     [self sessionStateChanged:session state:state error:error];
                                 }]; 
```

我的 sessionStateChanged 方法如下所示：

```
- (void)sessionStateChanged:(FBSession *)session
                        state:(FBSessionState)state
                        error:(NSError *)error
{

    switch (state) {
        case FBSessionStateOpen:
            // handle successful login
            break;
        case FBSessionStateClosed:
        case FBSessionStateClosedLoginFailed:
            // handle failed login
            break;
        default:
            break;
    }
} 
```

sessionStateChanged 中是否有任何方法可以区分这是否是用户*第*一次登录（即他们以前从未允许我们使用此特定应用程序）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:45:07.243

无法知道这是否是用户第一次授权应用程序。如果他们之前登录过，您最好的选择是在您自己的应用程序中进行跟踪。

# xcode - XCode 4.5.1 安装配置文件时崩溃

> ID：12827075
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:05.310
> 
> 标签：xcode, ios6, xcode4.5

我最近升级到 4.5.1。我去我的配置文件中添加了一个设备，XCode 崩溃了。如果我打开管理器并选择设备，它也会崩溃。

我在 Mac OSX 10.7.4 上。下面是堆栈跟踪：

崩溃的线程：7 调度队列：com.apple.dt.DVTCertificateUtilities.scan

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x00000000000000b8

VM Regions Near 0xb8:
--> 
    __TEXT                 000000010c833000-000000010c836000 [   12K] r-x/rwx SM=COW  /Applications/Xcode.app/Contents/MacOS/Xcode

Application Specific Information:
ProductBuildVersion: 4G1004
objc[10449]: garbage collection is ON

Thread 0:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff9245a67a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff92459d71 mach_msg + 73
2   com.apple.framework.IOKit       0x00007fff905a49bf io_service_get_matching_services + 210
3   com.apple.framework.IOKit       0x00007fff9055c604 IOServiceGetMatchingServices + 137
4   com.apple.framework.IOKit       0x00007fff9055c741 IOServiceGetMatchingService + 25
5   com.apple.Foundation            0x00007fff955cd10b +[NSFileWrapper _canSafelyMapFilesAtPath:] + 241
6   com.apple.Foundation            0x00007fff95572510 -[NSData(NSData) initWithContentsOfFile:options:error:] + 139
7   com.apple.AppKit                0x00007fff8d5b0c22 -[NSNib _loadNibDataFromPath:] + 310
8   com.apple.AppKit                0x00007fff8d5b0abc -[NSNib _initWithPath:bundle:] + 162
9   com.apple.AppKit                0x00007fff8d5b0a11 -[NSNib initWithNibNamed:bundle:] + 257
10  com.apple.AppKit                0x00007fff8d5b08f9 -[NSViewController(NSInternal) _nibWithName:bundle:] + 56
11  com.apple.AppKit                0x00007fff8d5b07b0 -[NSViewController loadView] + 155
12  com.apple.DTDeviceKit           0x0000000111c9b466 -[DTDKDetailViewController loadView] + 51
13  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c26675 -[IDEiPhoneOrganizerScreenshotsViewController loadView] + 49
14  com.apple.AppKit                0x00007fff8d5ac4ae -[NSViewController view] + 41
15  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c2d08d -[IDEiPhoneOrganizerViewController outlineViewSelectionDidChange:] + 194
16  com.apple.Foundation            0x00007fff95563d0e __-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_1 + 47
17  com.apple.CoreFoundation        0x00007fff978f77ba _CFXNotificationPost + 2634
18  com.apple.Foundation            0x00007fff9554ffc3 -[NSNotificationCenter postNotificationName:object:userInfo:] + 65
19  com.apple.AppKit                0x00007fff8d5e9499 -[NSTableView _sendSelectionChangedNotificationForRows:columns:] + 203
20  com.apple.AppKit                0x00007fff8d5bff5a -[NSTableView _enableSelectionPostingAndPost] + 425
21  com.apple.AppKit                0x00007fff8d5e8305 -[NSTableView _doSelectIndexes:byExtendingSelection:indexType:funnelThroughSingleIndexVersion:] + 2915
22  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c2aae4 -[IDEiPhoneOrganizerViewController setCurrentNodeIdentifier:] + 1442
23  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c2bb9b -[IDEiPhoneOrganizerViewController updateNodes] + 2542
24  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c29997 -[IDEiPhoneOrganizerViewController sharedViewSetup] + 219
25  com.apple.dt.IDE.IDEiPhoneSupport   0x0000000110c29a23 -[IDEiPhoneOrganizerViewController viewDidInstall] + 59
26  com.apple.dt.DVTKit             0x000000010cd49165 -[DVTViewController _didInstallContentView:] + 128
27  com.apple.dt.DVTKit             0x000000010cc83b0c -[DVTControllerContentView _viewDidInstall] + 406
28  com.apple.dt.DVTKit             0x000000010cc8338f -[DVTControllerContentView viewDidMoveToWindow] + 75
29  com.apple.AppKit                0x00007fff8d591a55 -[NSView _setWindow:] + 2618
30  com.apple.AppKit                0x00007fff8d58fc6d -[NSView addSubview:] + 405
31  com.apple.dt.DVTKit             0x000000010cd48ef0 __42-[DVTReplacementView _setupViewController]_block_invoke_0 + 164
32  com.apple.dt.DVTFoundation      0x000000010c8c02c8 DVTInvokeWithFailureHintObject + 59
33  com.apple.dt.DVTKit             0x000000010cc75141 -[DVTReplacementView _setupViewController] + 249
34  com.apple.dt.DVTKit             0x000000010cc75015 -[DVTReplacementView installedViewController] + 138
35  com.apple.dt.IDEKit             0x000000010d55ddd9 -[IDEApplicationController _openFiles:] + 533
36  com.apple.dt.IDEKit             0x000000010d55dbba -[IDEApplicationController application:openFiles:] + 49
37  com.apple.AppKit                0x00007fff8d7395e5 __-[NSApplication(NSAppleEventHandling) _handleAEOpenDocumentsForURLs:]_block_invoke_1 + 1064
38  com.apple.AppKit                0x00007fff8d4833e1 -[NSDocumentController(NSInternal) _autoreopenDocumentsWithCompletionHandler:] + 64
39  com.apple.AppKit                0x00007fff8d48310f -[NSApplication _reopenWindowsAsNecessaryIncludingRestorableState:registeringAsReady:completionHandler:] + 287
40  com.apple.AppKit                0x00007fff8d6c1f33 -[NSApplication(NSAppleEventHandling) _handleAEOpenDocumentsForURLs:] + 272
41  com.apple.AppKit                0x00007fff8d482c5a -[NSApplication(NSAppleEventHandling) _handleCoreEvent:withReplyEvent:] + 307
42  com.apple.CoreFoundation        0x00007fff97941541 -[NSObject performSelector:withObject:withObject:] + 65
43  com.apple.Foundation            0x00007fff955867c7 __-[NSAppleEventManager setEventHandler:andSelector:forEventClass:andEventID:]_block_invoke_1 + 101
44  com.apple.Foundation            0x00007fff9558574e -[NSAppleEventManager dispatchRawAppleEvent:withRawReply:handlerRefCon:] + 283
45  com.apple.Foundation            0x00007fff955855dc _NSAppleEventManagerGenericHandler + 105
46  com.apple.dt.IDEKit             0x000000010d5f34d4 HandleOpenDocAE + 47
47  com.apple.AE                    0x00007fff8c7c3c25 aeDispatchAppleEvent(AEDesc const*, AEDesc*, unsigned int, unsigned char*) + 200
48  com.apple.AE                    0x00007fff8c7c3b03 _ZL25dispatchEventAndSendReplyPK6AEDescPS_ + 38
49  com.apple.AE                    0x00007fff8c7c39f7 aeProcessAppleEvent + 250
50  com.apple.HIToolbox             0x00007fff96443d7d AEProcessAppleEvent + 102
51  com.apple.AppKit                0x00007fff8d48007d _DPSNextEvent + 1247
52  com.apple.AppKit                0x00007fff8d47f735 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 135
53  com.apple.AppKit                0x00007fff8d47c071 -[NSApplication run] + 470
54  com.apple.AppKit                0x00007fff8d6f8244 NSApplicationMain + 867
55  com.apple.dt.Xcode              0x000000010c834d17 0x10c833000 + 7447
56  com.apple.dt.Xcode              0x000000010c834ca8 0x10c833000 + 7336

Thread 1:: Dispatch queue: com.apple.libdispatch-manager
0   libsystem_kernel.dylib          0x00007fff9245c7e6 kevent + 10
1   libdispatch.dylib               0x00007fff9075378a _dispatch_mgr_invoke + 923
2   libdispatch.dylib               0x00007fff9075231a _dispatch_mgr_thread + 54

Thread 2:: com.apple.NSURLConnectionLoader
0   libsystem_kernel.dylib          0x00007fff9245a67a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff92459d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff978db50c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff978e3c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff978e3486 CFRunLoopRunSpecific + 230
5   com.apple.Foundation            0x00007fff955b2fd7 +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 335
6   com.apple.Foundation            0x00007fff955a772a -[NSThread main] + 68
7   com.apple.Foundation            0x00007fff955a76a2 __NSThread__main__ + 1575
8   libsystem_c.dylib               0x00007fff8c2188bf _pthread_start + 335
9   libsystem_c.dylib               0x00007fff8c21bb75 thread_start + 13

Thread 3:
0   libsystem_kernel.dylib          0x00007fff9245a67a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff92459d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff978db50c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff978e3c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff978e3486 CFRunLoopRunSpecific + 230
5   com.apple.DTDeviceKit           0x0000000111c9ab1f -[DTDKRemoteDeviceDataListener listenerThreadImplementation] + 298
6   com.apple.Foundation            0x00007fff955a772a -[NSThread main] + 68
7   com.apple.Foundation            0x00007fff955a76a2 __NSThread__main__ + 1575
8   libsystem_c.dylib               0x00007fff8c2188bf _pthread_start + 335
9   libsystem_c.dylib               0x00007fff8c21bb75 thread_start + 13

Thread 4:: com.apple.CFSocket.private
0   libsystem_kernel.dylib          0x00007fff9245bdf2 __select + 10
1   com.apple.CoreFoundation        0x00007fff9792cc8b __CFSocketManager + 1355
2   libsystem_c.dylib               0x00007fff8c2188bf _pthread_start + 335
3   libsystem_c.dylib               0x00007fff8c21bb75 thread_start + 13

Thread 5:
0   libsystem_kernel.dylib          0x00007fff9245b47a __accept + 10
1   com.unity3d.Unity4XC            0x0000000110fa02e8 +[UnityXcodePlugin pluginBg] + 201
2   com.apple.Foundation            0x00007fff955a772a -[NSThread main] + 68
3   com.apple.Foundation            0x00007fff955a76a2 __NSThread__main__ + 1575
4   libsystem_c.dylib               0x00007fff8c2188bf _pthread_start + 335
5   libsystem_c.dylib               0x00007fff8c21bb75 thread_start + 13

Thread 6:: DYMobileDeviceManager
0   libsystem_kernel.dylib          0x00007fff9245a67a mach_msg_trap + 10
1   libsystem_kernel.dylib          0x00007fff92459d71 mach_msg + 73
2   com.apple.CoreFoundation        0x00007fff978db50c __CFRunLoopServiceMachPort + 188
3   com.apple.CoreFoundation        0x00007fff978e3c74 __CFRunLoopRun + 1204
4   com.apple.CoreFoundation        0x00007fff978e3486 CFRunLoopRunSpecific + 230
5   com.apple.Foundation            0x00007fff95558f7b -[NSRunLoop(NSRunLoop) runMode:beforeDate:] + 267
6   com.apple.Foundation            0x00007fff95558e67 -[NSRunLoop(NSRunLoop) run] + 62
7   com.apple.Foundation            0x00007fff955a772a -[NSThread main] + 68
8   com.apple.Foundation            0x00007fff955a76a2 __NSThread__main__ + 1575
9   libsystem_c.dylib               0x00007fff8c2188bf _pthread_start + 335
10  libsystem_c.dylib               0x00007fff8c21bb75 thread_start + 13

Thread 7 Crashed:: Dispatch queue: com.apple.dt.DVTCertificateUtilities.scan
0   com.apple.security              0x00007fff976b3d98 DERDecodeSeqContentInit + 4
1   com.apple.security              0x00007fff976ad0fa parseX501NameContent + 32
2   com.apple.security              0x00007fff976ad193 SecCertificateCopyCommonNames + 62
3   com.apple.security              0x00007fff976ac49a Security::KeychainCore::CertificateValues::copyFieldValues(__CFArray const*, __CFError**) + 282
4   com.apple.security              0x00007fff97678fb3 SecCertificateCopyValues + 44
5   com.apple.dt.DVTFoundation      0x000000010c93a2cc +[DVTCertificateUtilities certificateKindForCertificate:] + 62
6   com.apple.dt.DVTFoundation      0x000000010c93ad0f +[DVTCertificateUtilities _scanForSigningCertificates] + 492
7   com.apple.dt.DVTFoundation      0x000000010c8e32a0 __DVTDispatchAsync_block_invoke_0 + 16
8   libdispatch.dylib               0x00007fff90751a86 _dispatch_call_block_and_release + 18
9   libdispatch.dylib               0x00007fff907532d6 _dispatch_queue_drain + 264
10  libdispatch.dylib               0x00007fff90753132 _dispatch_queue_invoke + 54
11  libdispatch.dylib               0x00007fff9075292c _dispatch_worker_thread2 + 198
12  libsystem_c.dylib               0x00007fff8c21a3da _pthread_wqthread + 316
13  libsystem_c.dylib               0x00007fff8c21bb85 start_wqthread + 13

Thread 8:
0   libsystem_kernel.dylib          0x00007fff9245c192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff8c21a594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff8c21bb85 start_wqthread + 13

Thread 9:
0   libsystem_kernel.dylib          0x00007fff9245c192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff8c21a594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff8c21bb85 start_wqthread + 13

Thread 10:
0   libsystem_kernel.dylib          0x00007fff9245c192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff8c21a594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff8c21bb85 start_wqthread + 13

Thread 11:
0   libsystem_kernel.dylib          0x00007fff9245c192 __workq_kernreturn + 10
1   libsystem_c.dylib               0x00007fff8c21a594 _pthread_wqthread + 758
2   libsystem_c.dylib               0x00007fff8c21bb85 start_wqthread + 13

Thread 7 crashed with X86 Thread State (64-bit):
  rax: 0x0000000401acd3c0  rbx: 0x00007fff976ad1b8  rcx: 0x0000000000000005  rdx: 0x00007fff976ad1b8
  rdi: 0x00000000000000b8  rsi: 0x000000011522dba8  rbp: 0x000000011522db80  rsp: 0x000000011522db80
   r8: 0x0000000000000001   r9: 0x00000000ffffffff  r10: 0x000000000000009e  r11: 0x0000000401acd3c0
  r12: 0x0000000401acda40  r13: 0x000000000000000f  r14: 0x0000000401acd3c0  r15: 0x0000000402e60be0
  rip: 0x00007fff976b3d98  rfl: 0x0000000000010206  cr2: 0x00000000000000b8
Logical CPU: 6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:43:06.147

您是否尝试过明显的 - 重新启动 Xcode / 重新启动？

您可能需要比删除个人资料更进一步。尝试撤销现有配置文件并重置您的钥匙串。另请参阅：[https ://discussions.apple.com/thread/3752773?start=0&tstart=0](https://discussions.apple.com/thread/3752773?start=0&tstart=0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:28:04.507

这听起来可能很傻，但是您是否尝试过断开连接到您的 Mac 的任何 iOS 设备？

我遇到了同样的问题，并尝试删除配置文件和证书，重新启动等，但没有骰子。当我拔下我的新 iPhone 5 时，它工作正常。我可能还需要清理 iPhone 上的证书。

# android - CountDownTimer 与 AlarmManager

> ID：12827078
> 
> 赞同：5
> 
> 时间：2012-10-10T19:40:09.350
> 
> 标签：android, alarmmanager, countdowntimer

**CountDownTimer**和**AlarmManager**之间有什么主要区别吗？我不是指语法或如何使用它，而是想知道是否有这样的任务，当您肯定可以说我应该使用其中一个而不是另一个时？
简单的例子，我必须每分钟启动一次动作。我应该使用什么？CountDownTimer 还是 AlarmManager？怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:49:08.190

[`AlarmManager`](http://developer.android.com/reference/android/app/AlarmManager.html)通常用于您的应用程序关闭或必须[执行一些重复任务的](http://developer.android.com/reference/android/app/AlarmManager.html#setRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)目的。`Timer`它也比or的精度略低`Handler`。

[`CountDownTimer`](http://developer.android.com/reference/android/os/CountDownTimer.html)更多地用于在一段时间内运行特定任务（`onFinish`），并定期更新直到它执行（`onTick`）。

在您的具体情况下，我相信您应该使用`AlarmManager`，因为它可以无限重复。例如，如果您希望每秒执行一次 10 秒，请使用`CountDownTimer`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T19:52:52.090

`CountDownTimer`

CountDownTimer 将在您的 Activity 上下文中运行。意味着它可以随时被杀死，如果您的应用程序不在前台。

`AlarmManager`

一种完全不同的方法使用粘性意图。并告诉你`Receiver`，一段时间后。它不依赖于 Activity 的生命周期。

因此，如果您想每分钟进行一次操作，即使您的应用程序不在前台，那么您应该使用`AlarmManager`，否则`CountDownTimer`将为您完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:46:10.983

[如此处](http://developer.android.com/reference/android/app/AlarmManager.html)所述：

> **注意**：警报管理器适用于您希望应用程序代码在特定时间运行的情况，即使您的应用程序当前没有运行。对于正常的计时操作（滴答声、超时等），使用 Handler 更容易、更高效。

因此，在您的情况下，最好使用 CountDownTimer，因为即使应用程序关闭，您也不想执行此操作。

# jmeter - 从 JMeter 中具有动态名称的文件中读取字符串

> ID：12827079
> 
> 赞同：4
> 
> 时间：2012-10-10T19:40:11.927
> 
> 标签：jmeter

我的测试计划包含一个看起来像这样的线程组：

*   只有一次控制器：登录到应用程序
    *   CSV 数据集配置：用于登录应用程序的信息
    *   只有一次控制器
        *   HTTP 请求：POST 登录信息
    *   回路控制器（10次）
        *   HTTP 请求：POST 向“问题”添加“评论”

我的 CSV 数据集包含以下字段：

*   用户名
*   密码
*   group_id

用户可以根据其 group_id 访问问题。我想为每个线程添加 10 条评论到不同的问题。

我的想法是构建一个文件，例如`questions_by_group_${group_id}.txt`包含一些`${group_id}`可以访问的问题的 id。然后我可以`${__StringToFile(questions_by_group_${group_id}.txt)}`在 POST 参数值中添加注释。使用`__StringToFile`函数应该在每次调用时遍历我的文件行。这样我就可以为许多不同的问题添加许多评论。

问题是 JMeter 似乎一次打开文件并为每个线程共享它（甚至认为我知道`${group_id}`每个线程的更改。

我尝试了很多事情，比如

*   `${__StringFromFile(questions_by_group_${group_id}.txt)}`
*   `${__StringFromFile(${__eval(questions_by_group_${group_id}.txt)})}`
*   `${__eval(${__StringFromFile(${__eval(questions_by_group_${group_id}.txt)})})}`

但没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:01:05.813

StringFromFile 默认以这种方式工作，请阅读：

*   [__StringFromFile](http://jmeter.apache.org/usermanual/functions.html#__StringFromFile)

您可以像这样组织您的 csv：

*   用户名、密码、group_id、commentID1、commentID2 ....

然后将 CSV Data Set Config 放在 Once Only Controller 之前。

例如，将共享模式设置为所有线程。

最后只使用变量而不是使用 __StringFromFile。

这不是最好的解决方案，因为您必须构建此文件并重复 group_id id。

如果您的组数不是很大，另一种选择是在[setUp Thread Group](http://jmeter.apache.org/usermanual/component_reference.html#setUp_Thread_Group)中执行此操作：

*   读取包含以下内容的 CSV 文件：

    ```
     groupID1, IDA1, IDA2,....
      groupID2, IDB1, IDB2,....
      ... 
    ```

*   每组设置一个属性[__setProperty](http://jmeter.apache.org/usermanual/functions.html#__setProperty)或在 Beanshell 采样器中调用它：

    ```
    JMeterUtils.setProperty(propertyName, propertyValue); 
    ```

然后在您的控制器中，使用 Beanshell 采样器获取 id，使用：

```
 JMeterUtils.getProperty(propertyName); 
```

我必须说我讨厌所有这些解决方案:-)

# c# - 如何避免使用自引用对象进行递归 Automapper 调用？

> ID：12827083
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:17.417
> 
> 标签：c#, .net, automapper

我有一个班级员工：

```
public partial class Employee
{
    public Employee()
    {
        this.Employees1 = new HashSet<Employee>();
    }

    public int Id { get; set; }
    public string Surname { get; set; }
    public string Email { get; set; }
    public Nullable<int> ReportsToId { get; set; }

    public virtual ICollection<Employee> Employees1 { get; set; }
    public virtual Employee ReportsTo { get; set; }
} 
```

还有一个视图模型：

```
public class EmployeeEditModel : MappedViewModel<Employee>
{
    public int Id { get; set; }
    public string Surname { get; set; }
    public string FirstName { get; set; }
    public string Email { get; set; }
    public int? ReportsTo { get; set; }
} 
```

`MappedViewModel<T>`声明一个方法：

```
public class MappedViewModel<TEntity>: ViewModel
{
    public virtual TEntity MapToEntity()
    {
        return (TEntity)Mapper.Map(this, GetType(), typeof(TEntity));
    }
} 
```

当我调用`MapToEntity`一个动作方法时，像这样

我从 AutoMapper 收到异常消息：

> 缺少类型映射配置或不支持的映射。
> 
> 映射类型：Int32 -> Employee System.Int32 -> Leave.Data.Employee
> 
> 目标路径：Employee.ReportsTo.ReportsTo
> 
> 源值：5

我的映射定义如下：

```
public static void RegisterMaps()
{
    Mapper.CreateMap<Employee, EmployeeCreateModel>();
    Mapper.CreateMap<EmployeeCreateModel, Employee>();
} 
```

双重引用`Employee.ReportsTo.ReportsTo`告诉我这个异常是由某种循环映射怪癖引起的，但我能做些什么呢？至少我想`ReportsTo`从映射中省略，只需在调用`MapToEntity`. 我怎么能做到这一点，更确切地说，我应该为这种 AutoMapper 问题模式做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T06:12:28.040

您需要做的不仅仅是简单的事情`Mapper.CreateMap`，因为它不会神奇地弄清楚如何在`EmployeeViewModel.ReportsTo`( `int?`) 和`Employee.ReportsTo`( `Employee`) 之间进行转换。

要么在 and 之间创建一个映射`int`，`Employee`要么使用该`ForMember`方法告诉 AutoMapper 如何转换`ReportsTo`属性。

# plugins - CodeRush 插件可以针对 C# 或 VB 以外的语言吗？

> ID：12827084
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:18.463
> 
> 标签：plugins, coderush

我正在尝试编写一个类似于 XML Doc Comment Painter 的 CodeRush 插件。我的插件使用 TileVisual 装饰，可以很好地修饰 C# 文件中的注释，但不适用于 F# 文件中的注释。

如何指定应该为 F# 文件启用我的插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T16:09:46.610

不幸的是，目前不支持 F# 语言。因此，您不能启用该语言的插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:50:01.137

你检查过[这个线程](https://stackoverflow.com/questions/491415/are-there-any-support-tools-like-coderush-or-resharper-for-f)吗？那里的一个人建议说

> CodeRush 在 F# 编辑器中工作。至少有一些代码帮助和代码模板。但是代码模板尚未定义（您必须创建自己的）。

如果您在自己的插件方面需要帮助，我认为您最好联系 Devexpress 支持。

# sql - 将总值的部分计数为每行的列（数据透视表）

> ID：12827085
> 
> 赞同：2
> 
> 时间：2012-10-10T19:40:19.267
> 
> 标签：sql, oracle, oracle11g, pivot-table

我遇到了一个看似简单的查询，但在最后几个小时无法让它工作。

我有一个表`files`，其中包含文件名和一些值，例如此文件中的记录、创建日期 ( `create_date`)、处理日期 ( `processing_date`) 等。不同时间的创建日期可能有多个文件，并且它们可能不会在创建的同一天得到处理，实际上它们甚至可能需要三天或更长时间才能得到处理。

因此，假设我有这些行，例如：

```
create_date            | processing_date
------------------------------
2012-09-10 11:10:55.0  | 2012-09-11 18:00:18.0
2012-09-10 15:20:18.0  | 2012-09-11 13:38:19.0
2012-09-10 19:30:48.0  | 2012-09-12 10:59:00.0
2012-09-11 08:19:11.0  | 2012-09-11 18:14:44.0
2012-09-11 22:31:42.0  | 2012-09-21 03:51:09.0 
```

我想要**在单个查询**中将分组列截断到当天，并添加 11 个附加列来表示和`create_date`之间的差异，因此结果大致如下所示：`processing_date``create_date`

```
create_date   |   diff0days   | diff1days | diff2days | ... | diff10days
------------------------------------------------------------------------
2012-09-10    |       0             2           1       ...        0
2012-09-11    |       1             0           0       ...        1 
```

等等，我希望你明白这一点:)

我已经尝试过了，到目前为止，它可以为 a 获取一个聚合列，`create_date`其差异为 - 例如 - 3：

```
SELECT TRUNC(f.create_date, 'DD') as created, count(1) FROM files f WHERE TRUNC(f.process_date, 'DD') - trunc(f.create_date, 'DD') = 3 GROUP BY TRUNC(f.create_date, 'DD') 
```

我尝试组合单个查询并尝试子查询，但这没有帮助，或者至少我对 SQL 的了解不够。

我需要的是一个提示，以便我可以将各种差异包含在列中，如上所示。**我怎么可能做到这一点？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:42:50.287

这基本上是旋转问题：

```
SELECT  TRUNC(f.create_date, 'DD') as created
,       sum(case TRUNC(f.process_date, 'DD') - trunc(f.create_date, 'DD')
                  when 0 then 1 end) as diff0days   
,       sum(case TRUNC(f.process_date, 'DD') - trunc(f.create_date, 'DD')
                  when 1 then 1 end) as diff1days   
,       sum(case TRUNC(f.process_date, 'DD') - trunc(f.create_date, 'DD')
                  when 2 then 1 end) as diff2days   
,       ...
FROM    files f 
GROUP BY 
        TRUNC(f.create_date, 'DD') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:44:54.010

```
SELECT CreateDate,
    sum(CASE WHEN DateDiff(day, CreateDate, ProcessDate) = 1 THEN 1 ELSE 0 END) AS Diff1,
    sum(CASE WHEN DateDiff(day, CreateDate, ProcessDate) = 2 THEN 1 ELSE 0 END) AS Diff2,
    ...
FROM table
GROUP BY CreateDate
ORDER BY CreateDate 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T20:46:56.310

当您使用 Oracle 11g 时，您还可以使用`pivot query`.

这是一个例子：

```
 -- sample of data from your question
  SQL> create table Your_table(create_date, processing_date) as
  2  (
  3        select '2012-09-10', '2012-09-11' from dual union all
  4        select '2012-09-10', '2012-09-11' from dual union all
  5        select '2012-09-10', '2012-09-12' from dual union all
  6        select '2012-09-11', '2012-09-11' from dual union all
  7        select '2012-09-11', '2012-09-21' from dual
  8   )
  9  ;

Table created

 SQL> with t2 as(
  2    select create_date
  3         , processing_date
  4         , to_date(processing_date, 'YYYY-MM-DD')  
                      - To_Date(create_date, 'YYYY-MM-DD') dif
  5      from your_table
  6    )
  7      select create_date
  8           , max(diff0) diff0
  9           , max(diff1) diff1
 10           , max(diff2) diff2
 11           , max(diff3) diff3
 12           , max(diff4) diff4
 13           , max(diff5) diff5
 14           , max(diff6) diff6
 15           , max(diff7) diff7
 16           , max(diff8) diff8
 17           , max(diff9) diff9
 18           , max(diff10) diff10
 19        from (select *
 20                from t2
 21                pivot(
 22                       count(dif)
 23                       for dif in ( 0 diff0
 24                                  , 1 diff1
 25                                  , 2 diff2
 26                                  , 3 diff3
 27                                  , 4 diff4
 28                                  , 5 diff5
 29                                  , 6 diff6
 30                                  , 7 diff7
 31                                  , 8 diff8
 32                                  , 9 diff9
 33                                  , 10 diff10
 34                                  )
 35                     ) pd
 36             ) res
 37      group by create_date
 38  ; 
```

结果：

```
Create_Date Diff0 Diff1 Diff2 Diff3 Diff4 Diff5 Diff6 Diff7 Diff8 Diff9 Diff10
-------------------------------------------------------------------------------- 
2012-09-10    0     2     1     0     0     0     0    0      0     0     0 
2012-09-11    1     0     0     0     0     0     0    0      0     0     1 
```

# jquery - 颜色框宽度问题

> ID：12827087
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:29.203
> 
> 标签：jquery, width, colorbox

我在正在开发的网站上遇到颜色框问题。

colorbox 元素的调用方式如下：

```
$(document).ready(function(){
    $('a.video').colorbox({width:'650px',height:'350px'});
}); 
```

a.video 对只有一个视频的页面有一个 href，该页面使用具有设定宽度和高度的 flowplayer。

问题是，无论我设置什么宽度，它都不会大于 559px。高度很好，我可以将高度更改为任何像素值，它会更新。然而，颜色框的宽度不会超过 559 像素，这太小而无法显示视频。

我试过设置innerWidth，但这没有任何区别。关于可能导致此问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:49:57.310

```
$(document).ready(function() {
    $('a.video').colorbox.resize({width:'650px',height:'350px'});
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T08:12:53.900

发现了问题，在我开始在网站上工作之前已经存在的 javascript 配置文件中有一个最大宽度设置。

谢谢你们的帮助。

# php - 使用动态导航多维数组

> ID：12827091
> 
> 赞同：2
> 
> 时间：2012-10-10T19:40:40.037
> 
> 标签：php, arrays, multidimensional-array

我试图弄清楚为什么我无法使用以下语句访问跟随数组：

```
var_dump($thevar[0]['product_id']);

Array
(
    [d142d425a5487967a914b6579428d64b] => Array
        (
            [product_id] => 253
            [variation_id] => 
            [variation] => 
            [quantity] => 1
            [data] => WC_Product Object
                (
                    [id] => 253
                    [product_custom_fields] => Array
                        (
                            [_edit_last] => Array
                                (
                                    [0] => 1
                                )

                            [_edit_lock] => Array
                                (
                                    [0] => 1345655854:1
                                )

                            [_thumbnail_id] => Array
                                (
                                    [0] => 102
                                ) 
```

但是，我可以使用动态创建的数组名称访问“product_id”：

```
print_r($thevar['d142d425a5487967a914b6579428d64b']['product_id']); 
```

问题是，我不知道动态名称将是什么...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:49:18.687

此类场景有多种选择。

### 手动迭代数组

您可以使用`reset`、`next`和`key`/或`each`迭代数组（可能是部分）。

例如，无论键如何都抓取第一个项目：

```
$item = reset($thevar); 
```

### 重新索引数组

有时，能够以数字方式对数组进行索引只是很方便，而且对性能的小幅影响也不是问题。在这种情况下，您可以使用重新索引`array_values`：

```
$values = array_values($thevar);
$item = $values[0]; // because $values is numerically indexed 
```

### 用 foreach 迭代

这既适用于单个值，也适用于更多值，但它可能会给代码的读者留下错误的印象。

```
foreach($thevar as $item) {
    // do something with $item
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:47:03.937

如果数组键是动态的，您可能会发现 PHP 函数 array_keys() 很有用。

它将返回一个数组中使用的键的数组。然后，您可以使用它来访问数组中的特定元素。

请参阅此处了解更多信息：

[http://php.net/manual/en/function.array-keys.php](http://php.net/manual/en/function.array-keys.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:43:37.070

因为 PHP 数组是关联的，所以你必须通过键来访问它们。

但你可以[`reset($thevar)`](http://php.net/manual/en/function.reset.php)用来获得第一个项目。

或者[`array_values()`](http://www.php.net/manual/en/function.array-values.php)：

```
array_values($thevar)[0] 
```

或者，如果您觉得有点矫枉过正，您也可以像这样使用[`array_keys()`](http://www.php.net/manual/en/function.array-keys.php)和使用该`[0]`元素来寻址元素：

```
$thevar[ array_keys($thevar)[0]] 
```

# c# - 未使用 XamlWriter 设置绑定

> ID：12827096
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:49.803
> 
> 标签：c#, wpf, xaml, binding

我有我的课：

```
public class CustomCell
{
    public string BindingData
    {
        get { return (string)GetValue(BindingDataProperty); }
        set { SetValue(BindingDataProperty, value); }
    }

    public static readonly DependencyProperty BindingDataProperty =
        DependencyProperty.Register("BindingData", typeof(string), typeof(CustomCell));
} 
```

我使用 BindingDataProperty 设置绑定

```
CustomCell cell = new CustomCell();
cell.SetBinding(CustomCell.BindingDataProperty, new Binding("source")); 
```

现在我想使用以下命令获取 XAML 等效字符串`XamlWriter`：

```
string xaml = XamlWriter.Save(cell); 
```

但是在`xaml`字符串`BindingData`中是`{x:Null}`并且没有进行任何绑定。

为什么？我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:16:28.397

这是[XamlWriter.Save 的序列化限制](http://msdn.microsoft.com/en-us/library/ms754193.aspx)

请参阅 MSDN 文档：

> 对各种标记扩展格式（例如 StaticResource 或**Binding ）的对象的通用引用**, 将被序列化过程取消引用。在应用程序运行时创建内存对象时，这些已被取消引用，并且保存逻辑不会重新访问原始 XAML 以恢复对序列化输出的此类引用。这可能会将任何数据绑定或资源获得的值冻结为运行时表示最后使用的值，只有有限或间接的能力将此类值与本地设置的任何其他值区分开来。图像也被序列化为项目中存在的图像的对象引用，而不是作为原始源引用，丢失最初引用的任何文件名或 URI。甚至在同一页面中声明的资源也会被序列化到它们被引用的位置，

# html - HTML 区域标签，显示文本和/或图形

> ID：12827100
> 
> 赞同：1
> 
> 时间：2012-10-10T19:40:59.473
> 
> 标签：html

我想在另一个图形上显示文本和/或图形。

通过使用以下示例，我显示了一个图形，然后可以使用以下方法“敏感化”它的某些部分`AREA`：

```
<img src ="planets.gif" width="145" height="126" alt="Planets" usemap ="#planetmap" />

<map name="planetmap">
  <area shape="rect" coords="0,0,82,126" href="sun.htm" alt="Sun" />
  <area shape="circle" coords="90,58,3" href="mercur.htm" alt="Mercury" />
  <area shape="circle" coords="124,58,8" href="venus.htm" alt="Venus" />
</map> 
```

我如何能够以相同的方式显示文本和/或图形？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:44:25.727

您可以使用 HTML5 CANVAS 执行此操作。区域地图不支持这一点。

[这是一个入门教程： http](http://blog.reybango.com/2010/07/01/canvas-baby-steps-an-introduction-to-the-html-5-canvas-element/) ://blog.reybango.com/2010/07/01/canvas-baby-steps-an-introduction-to-the-html-5-canvas-element/

# java - 在命令行中执行无头 Eclipse

> ID：12827104
> 
> 赞同：7
> 
> 时间：2012-10-10T19:41:04.717
> 
> 标签：java, eclipse, command-line, eclipse-plugin, headless

按照[这个指令](http://www.developertesting.com/archives/month200508/20050823-HeadlessHelloWorldInEclipse.html)，我可以在 Eclipse IDE 中运行无头 Eclipse 插件。

![在此处输入图像描述](../Images/1f856177f40dd7d2e72933d0d17ab726.png)

我有一些错误日志信息，但我想我可以根据这篇文章忽略它 - [Unable to find feature.xml in directory](https://stackoverflow.com/questions/6800634/unable-to-find-feature-xml-in-directory)

![在此处输入图像描述](../Images/10a0309302dfa8e5446a7a9c941d68d9.png)

按照站点中的说明，我可以生成 jar 文件。复制org.eclipse.equinox.launcher.jar后，我尝试执行jar文件

```
java -jar org.eclipse.equinox.launcher_1.2.0.v20110502.jar -application headlessHello_1.0.0.201210101430.jar 
```

我试过

```
java -cp .:org.eclipse.equinox.launcher_1.2.0.v20110502.jar org.eclipse.core.launcher.Main -application headlessHello_1.0.0.201210101430.jar 
```

获取错误信息

```
An error has occurred.  See the log file
/Users/users/Desktop/configuration/1349897444823.log 
```

使用此日志文件

```
!SESSION Wed Oct 10 14:30:44 CDT 2012 ------------------------------------------
!ENTRY org.eclipse.equinox.launcher 4 0 2012-10-10 14:30:44.843
!MESSAGE Exception launching the Eclipse Platform:
!STACK
java.lang.RuntimeException: Could not find framework
    at org.eclipse.equinox.launcher.Main.getBootPath(Main.java:978)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:557)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1386) 
```

## 添加

从[这个站点](http://kb.microfocus.com/display/4/kb/article.aspx?aid=25800)，问题是因为我没有`%R2_HOME%/plugins`正确设置。设置后，我仍然收到错误消息。

```
java.lang.IllegalStateException: Unable to acquire application service. Ensure that the org.eclipse.core.runtime bundle is resolved and started (see config.ini).
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:74)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1410)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1386)
    at org.eclipse.core.launcher.Main.main(Main.java:34) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:04:40.217

一个无头 Eclipse 实例需要包含许多插件，而不仅仅是您的插件。最低限度的产品包括：

*   `org.eclipse.core.runtime`
*   `org.eclipse.core.variables`
*   <你的插件在这里>

**编辑**

我生成了产品，这里是我的“最小”无头 Eclipse 使用的插件列表：

我输出了产品，这里是加载的插件列表：

```
org.eclipse.core.contenttype_3.4.100.v20100505-1235.jar
org.eclipse.core.jobs_3.5.1.R36x_v20100824.jar
org.eclipse.core.runtime.compatibility.auth_3.2.200.v20100517.jar
org.eclipse.core.runtime.compatibility.registry_3.3.0.v20100520
org.eclipse.core.runtime_3.6.0.v20100505.jar
org.eclipse.equinox.app_1.3.1.R36x_v20100803.jar
org.eclipse.equinox.common_3.6.0.v20100503.jar
org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.2.R36x_v20101222
org.eclipse.equinox.launcher_1.1.1.R36x_v20101122_1400.jar
org.eclipse.equinox.preferences_3.3.0.v20100503.jar
org.eclipse.equinox.registry_3.5.0.v20100503.jar
org.eclipse.osgi.services_3.2.100.v20100503.jar
org.eclipse.osgi.util_3.2.100.v20100503.jar
org.eclipse.osgi_3.6.2.R36x_v20110210.jar 
```

所以，我是否建议您为正在构建的这个 Eclipse 应用程序创建一个产品，然后尝试一下。寻找常见问题解答我发现了这个。[http://wiki.eclipse.org/FAQ_What_is_the_minimal_Eclipse_configuration%3F](http://wiki.eclipse.org/FAQ_What_is_the_minimal_Eclipse_configuration%3F)

# android - Android 在 res 文件夹中存储可绘制图像会出错

> ID：12827114
> 
> 赞同：4
> 
> 时间：2012-10-10T19:41:40.417
> 
> 标签：android

因此，我试图将图像保存在我的 android 问题中的一个可绘制文件夹中，但无论我将图像文件放在哪里，尝试构建或运行我的程序都会出现此错误

```
C:\Users\*****\AppData\Local\Android\android-sdk\tools\ant\build.xml:621: The following error occurred while executing this line: 
C:\Users\******\AppData\Local\Android\android-sdk\tools\ant\build.xml:657: null returned: 1 
```

有问题的代码行是：

```
621-elseText="hasCode = false. Skipping aidl/renderscript/R.java">
657-proguardFile="${out.absolute.dir}/proguard.txt"> 
```

一旦我删除图像文件，我的应用程序就会清理、构建和运行，没有任何问题。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T19:45:53.010

资源文件名中不允许使用大写字母。你验证了吗？

# python - IDLE Python 未检测到更改

> ID：12827116
> 
> 赞同：3
> 
> 时间：2012-10-10T19:41:47.150
> 
> 标签：python, python-2.7

我正在使用 IDLE 编写一些小型 Python 程序。有两个类文件——node.py（节点类）和 position.py（位置类）。我在 main.py 中有我的主模块代码，我从中实例化 Node 和 Position 对象。

我注意到的是 - 当我在 node.py 或 position.py 中进行更改时，检查模块然后使用 F5 运行它们，只要所有文件都打开，当我运行 main.py 时，更改就不会反映回来处于空闲状态。我注意到我必须手动关闭所有三个 .py 文件，然后关闭 IDLE，重新开始并运行 main.py 以查看在 node.py 和 position.py 中所做的更改。

这里有什么问题？我的环境变量设置不正确吗？我在 SO 和网上搜索过，但没有找到满意的答案。

[详细信息：我在 Ubuntu 中使用 IDLE 版本 2.7.3。这三个 .py 文件和对应的 .pyc 字节码文件都在同一个目录下。这个目录也可以在 sys.path 中看到]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:51:10.203

发生的事情是我需要使用“import node”，但我使用的是 main.py 中的“from node import *”。这阻止了 main.py 链接到更新的节点模块！

（很抱歉接受我自己的答案，但可能有人以后也会面临同样的问题，因此我正在上传解决方案）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T12:54:08.147

~~我按照 Matthew Plourde 的建议使用了 Ctrl+F6。使用 Python 3 和 IDLE，我可以打开我的测试文件和核心文件。然后，我将修复我的核心文件中的测试文件中的断言报告的错误，但测试文件不会看到更改。我唯一的解决方案是关闭并重新打开，这很痛苦。Ctrl+F6 确实有效。我在 Python3 中找不到 reload 函数。~~

我收回这个声明。使用 python3，如果由于缺乏管理员权限或其他一些安全原因而运行 IDLE 一个“-n”，则需要导入 imp 并使用 imp.reload(function) for IDLE 来获取对您正在编辑的其他 python 文件的任何更改和回忆。否则 python 不会检测到更改并且不会重新加载文件。

[http://docs.python.org/3.0/library/imp.html#imp.reload](http://docs.python.org/3.0/library/imp.html#imp.reload)

# nginx - nginx 配置强制 www 但允许 m 导致 503

> ID：12827120
> 
> 赞同：0
> 
> 时间：2012-10-10T19:42:02.923
> 
> 标签：nginx, rewrite

我们正在尝试使用以下规则来强制 www 并允许 m 个子域：

```
server {
       listen 80;
       server_name example.com;
       set $test 0;
       if ($host !~* ^www\.){
                set $test 1;
        }

        if ($host ~* ^m\.){
                set $test 2;
        }

        if ( $test = 1 ) {
                return 301 $scheme://www.example.com$request_uri;
        }
}

server {

    listen   80;
    server_name www.example.com;
    access_log /var/log/nginx/www.example.com.access.log;
    error_log /var/log/nginx/tmp.error.log;

    location / {
        root   /var/www/home/;
        index index.html index.php;
    }
} 
```

我们看到的是它一开始可以工作几分钟，然后突然停止工作。一旦我们注释掉第一部分中的规则，它就会再次完美运行。有任何想法吗？

# vb.net - 在没有滞后的表单上绘制图形？

> ID：12827122
> 
> 赞同：0
> 
> 时间：2012-10-10T19:42:07.397
> 
> 标签：vb.net, winforms, gdi

我的方法的问题是，在调整表单大小时，图像、文本或绘制的线条可能会滞后 0.2 秒。因此，如果您需要右下角的图像，则在调整大小后需要 0.2 秒才能到位。此外，如果您进行大量调整大小，它开始滞后到 1-2FPS，而表单在大屏幕上展开。示例代码如下所示（VB.NET）：

```
Public Class Form1
  Protected Overrides Sub OnPaint(e As System.Windows.Forms.PaintEventArgs)
    MyBase.OnPaint(e)
    Dim icon As Icon = SystemIcons.Exclamation
    Dim imageWidth As Integer = icon.Width
    Dim imageHeight As Integer = icon.Height
    e.Graphics.DrawIcon(icon, Me.ClientRectangle.Right - imageWidth,
                              Me.ClientRectangle.Bottom - imageHeight)
  End Sub
  Private Sub Form1_Resize(sender As Object, e As System.EventArgs) Handles Me.Resize
    Me.Invalidate()
  End Sub
End Class 
```

有什么办法可以让它更顺畅吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:43:18.150

Windows 窗体提供了一种[样式设置](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.setstyle.aspx)来双重缓冲屏幕。这为您做了很多设置。

此外，双缓冲消除了清除屏幕的需要，因此在*不*`OnPaintBackground`调用基类的情况下覆盖和返回将阻止很多无论如何都不会看到的工作。

 *有关 GDI+/winforms 双缓冲的一些最佳示例，请查看我的[动画](https://web.archive.org/web/20141223080308/http://bobpowell.net/animation.aspx) [示例](https://web.archive.org/web/20140811193726/http://bobpowell.net/doublebuffer.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:08:07.737

调整窗口大小总是需要在新位置重新绘制图像。但是，您可以尝试一些可能会或可能不会使重绘更有效的方法。

1.  仅使图像的新旧位置无效，而不是整个表格。这意味着您不必绘制不会更改的窗口部分。
2.  将图像从旧位置复制到新位置。您必须小心使窗口的右侧部分无效，特别是当窗口变小并且新旧图像区域重叠时。
3.  为图像创建一个单独的控件，并将该控件移动到正确的位置。然后表单和控件将自动使正确的区域无效。*

# sql - 显示来自 2 个表的数据列表中的数据

> ID：12827123
> 
> 赞同：-2
> 
> 时间：2012-10-10T19:42:11.577
> 
> 标签：sql

我有两张桌子：

```
tbl_car_detail
--------------
CarID (primary key)
CarBrand 
```

和

```
tbl_car_image
-------------
ImageID (primary key)
CarID (foreign key)
Image 
```

我已将以下记录插入`tbl_car_detail`：

```
CarID                CarBrand
-----------------------------
1                    Audi
2                    bwm 
```

我正在插入多个相同的图像，`CarID`如下`tbl_car_Image`所示：

```
ImageID                  CarID             Image
------------------------------------------------
1                        1                 Image1
2                        1                 Image2
3                        1                 Image3
4                        2                 Image4
5                        2                 Image5 
```

我想在两个表的一个结果集中显示结果。我正在使用这个查询：

```
SELECT     dbo.Tbl_Car_detail.CarID,dbo.tbl_mst_CarDetail.CarBrand , tbl_car_Image.Image
FROM         dbo.Tbl_Car_detail.CarID RIGHT OUTER JOIN
                      tbl_car_Image.Image ON dbo.Tbl_Car_detail.CarID = dbo.tbl_car_Image.CarID 
```

结果如下：

```
CarID               CarBrand                Image
--------------------------------------------------
1                   Audi                    Image1
1                   Audi                    Image2
1                   Audi                    Image3
2                   Bmw                     Image4
2                   Bmw                     Image5 
```

但是，我只想要一张像这样的每个 CarID 结果的图像

```
CarID               CarBrand                Image
--------------------------------------------------
1                   Audi                    Image1
2                   Bmw                     Image4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:37:21.640

所以你只想要每个 CarID 的第一张图片？这将做到这一点...

```
SELECT dbo.Tbl_Car_detail.CarID,dbo.tbl_mst_CarDetail.CarBrand,(SELECT TOP 1 tbl_car_Image.Image FROM tbl_car_Image.Image WHERE dbo.Tbl_Car_detail.CarID=dbo.tbl_car_Image.CarID) AS Image FROM dbo.Tbl_Car_detail.CarID 
```

# sql-server-2008 - 如何将 OPENXML 数据加入我的内部联接查询？

> ID：12827126
> 
> 赞同：1
> 
> 时间：2012-10-10T19:42:22.900
> 
> 标签：sql-server-2008, openxml

开放式XML：

```
DECLARE @idoc int
DECLARE @doc varchar(1000)
SET @doc =
'<ROOT>
        <Employee EmployeeID = "1"  EmpStatus = "Full Time"/>
        <Employee EmployeeID = "2"  EmpStatus ="Part Time" />
        </ROOT>'
    EXEC sp_xml_preparedocument @idoc OUTPUT, @doc
SELECT    *
FROM       OPENXML (@idoc, '/ROOT/Employee',1)
            WITH (EmployeeID  varchar(10),
                  EmpStatus varchar(20)) 
```

结果：

```
EmployeeID    EmpStatus
    1         Full Time
    2         Part Time 
```

表查询：

```
 SELECT hr.EmployeeID, hr.Title, c.FirstName,c.LastName 
    FROM HumanResources.Employee hr WITH (NOLOCK)
    INNER JOIN ContactInfo c WITH (NOLOCK)
    ON hr.ContactID = c.ContactID
    Where hr. EmployeeID IN ( 1, 2) 
```

结果：

```
EmployeeID  Title         FirstName  LastName
    1   Engineering   Mike       Brown
    2   Programmer    Yves       Anthony 
```

如何将 OpenXML 数据加入到我的内部连接查询中`EmployeeID`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:49:41.820

您是否**坚持**使用 OpenXML？它是旧的，它是遗留的——使用本机 XQuery 函数通常**要容易得多**。

尝试这样的事情：

```
DECLARE @Employees TABLE (EmployeeID INT, Title VARCHAR(20), FirstName VARCHAR(20),LastName VARCHAR(20))

INSERT INTO @Employees VALUES(1, 'Engineering', 'Mike', 'Brown')
INSERT INTO @Employees VALUES(2, 'Programmer', 'Yves', 'Anthony')

DECLARE @doc XML 
SET @doc = '<ROOT>
              <Employee EmployeeID = "1"  EmpStatus = "Full Time"/>
              <Employee EmployeeID = "2"  EmpStatus ="Part Time" />
            </ROOT>'

;WITH XmlCTE AS
(
    SELECT
        EmpID = Empl.value('@EmployeeID', 'int'),
        EmpStatus = Empl.value('@EmpStatus', 'varchar(10)')
    FROM @doc.nodes('/ROOT/Employee') AS Tbl(Empl)
)
SELECT 
    e.*, x.EmpStatus 
FROM 
    @Employees e
INNER JOIN  
    xmlcte x ON e.EmployeeID = x.EmpID 
```

这给了我一个输出：

![在此处输入图像描述](../Images/360f216f152569f6fa9b0ea59ffaacdf.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-01T11:02:44.297

尽管另一个答案暗示了一定程度的弃用，`openxml`因为我找不到任何证据，也没有费心去解决如何去做......你*可以同时*使用`openxml`和`join`。

在你的情况下，它会是这样的：

```
select
    x.*,
    hr.EmployeeID, hr.Title, c.FirstName, c.LastName 
from
    openxml (@IDoc, '/ROOT/Employee',1)
    with (
        EmployeeID  varchar(10),
        EmpStatus   varchar(20)
    ) as x
    inner join HumanResources.Employee hr with (nolock) on
        x.EmployeeID = hr.EmployeeID
    inner join Contactinfo c with (nolock)
        on hr.ContactID = c.ContactID; 
```

h/t：[http ://www.informit.com/articles/article.aspx?p=26499&seqNum=3](http://www.informit.com/articles/article.aspx?p=26499&seqNum=3)

# cocos2d-iphone - 如何在 cocos2d 中正确覆盖超类更新方法

> ID：12827127
> 
> 赞同：1
> 
> 时间：2012-10-10T19:42:33.120
> 
> 标签：cocos2d-iphone

我制作了一个简单的物理精灵，它将自动触发更新选择器并将精灵相应地移动到 b2body 成员集。

但是，当我对该物理精灵进行子类化时，我想扩展该更新方法以执行更多操作。当我重写该更新方法时，我需要以某种方式调用超类更新方法，以便它可以在我在子类中执行我的业务之前执行它的业务。

这是一些代码：

超类：

```
 /**
 * SELECTOR
 * This selector updates the sprites position
 */
-(void) update:(ccTime) dt {
    CCLOG(@"PSprite update");
    if (self.body) {

        //Get the body's position in pixels
        CGPoint newLocationForSprite = ccp(self.body->GetPosition().x * PTM_RATIO, self.body->GetPosition().y * PTM_RATIO);
        //positioning self
        [self setPosition:newLocationForSprite];
    }
} 
```

子类：

```
-(void) update:(ccTime) dt {
//I want to call my superclass's update method
CCLOG(@"Subclass update");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:07:48.443

子类代码

```
- (void) update:(ccTime)dt
{
    [super update: dt];

    // do anything you want
} 
```

# jsf - 在 JSF 中创建多行表

> ID：12827128
> 
> 赞同：-1
> 
> 时间：2012-10-10T19:42:35.367
> 
> 标签：jsf

我需要创建一个结构如下所示的表：

```
+----+--------+
| ID | Values |
+----+--------+
|  1 | val 1  |
+----+--------+
|    | val2   |
+----+--------+
|    | val 3  |
+----+--------+
|  2 | val 4  |
+----+--------+
|    | val 5  |
+----+--------+ 
```

即第一列的值可以扩展到多行。

我的 JSF 对象是；

```
class abc {
    int id;
    String[] values;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:15:23.670

你会做这样的事情：

```
public class DataBean {
 private List<abc> list;

 public DataBean() {
  list = new ArrayList<abc>();
  populate(list); // method that populates your List
 }

 // getter and setters 
```

在您的 .xhtml 页面中，您将执行以下操作：

```
<h:dataTable value="#{dataBean.list}" var = "item">
 <h:column>
  <f:facet name="header">
   <h:outputText value="Id" />
  </f:facet>
  <h:outputText value="#{item.id} />
 </h:column>
 <h:column>
  <f:facet name="header">
   <h:outputText value="Values" />
  </f:facet>
  <ui:repeat value="#{item.values}" var = "value">
   <h:outputText value="#{value} /><br />
  </ui:repeat>
 </h:column>
</h:dataTable> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:59:56.813

我最终使用了 panelGrid 的 PrimeFaces 实现：

```
<p:panelGrid>
    <p:row>
        <p:column rowspan="2">Header 1</p:column>
        <p:column>attrib 1 1</p:column>
        <p:column>arrtib 1 2</p:column>
    </p:row>
    <p:row>
        <p:column>attrib 2 1</p:column>
        <p:column>arrtib 2 2</p:column>
    </p:row>
</p:panelGrid> 
```

# sql - 防止对数据完整性的定时攻击

> ID：12827129
> 
> 赞同：1
> 
> 时间：2012-10-10T19:42:45.580
> 
> 标签：sql, security, web-applications

场景：基于网络的文字游戏

1.  玩家 A 向玩家 B 发送发送 10,000 积分的请求（此请求需要 20 毫秒才能完成）。
2.  在发送第一个请求（仍在处理中）后 3 毫秒，玩家 A 向战斗玩家 C 发送另一个请求，此请求需要 100 毫秒才能完成。

发生了什么，在第 1 步中，应用程序从玩家 A 中删除积分，将其提供给玩家 B，但在将其保留在数据库中之前，第二个请求到来，加载状态仍显示玩家 A 帐户中的 10k 并覆盖请求中的正确状态1（0学分），10k +第2步的战利品。结果：玩家A和B现在都有10k在他们的账户中，钱只是翻了一番。

可以做些什么来防止这种情况发生？这是显示问题的假设场景，对于上述场景`account=account+loot`sql 会做，但我正在寻找适用于所有数据类型的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:46:08.130

如果[`transaction isolation level`](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29)将数据库上的 设置为可序列化，则可以将上述内容视为数据库级别的单个原子事件。

原子性是数据库系统的关键组成部分之一。

# css - CSS3 转换影响其他元素与 chrome/safari

> ID：12827135
> 
> 赞同：13
> 
> 时间：2012-10-10T19:43:06.040
> 
> 标签：css, css-transitions, flicker, css-transforms

我有一个问题，我的 css3 转换影响了页面上的其他元素，甚至导致它们有点闪烁。我看到了另一篇关于这个的帖子，但他们没有解决这个问题。

[http://scosha.mybigcommerce.com/w107b/](http://scosha.mybigcommerce.com/w107b/)当您滚动导航时，您会看到动画 css3 转换。它在 Firefox 中运行良好，没有闪烁，但在 chrome 和 safari 中效果非常明显，您可以在下拉菜单项和页脚文本中看到它。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-11-06T16:19:37.047

在 Chrome 中过渡期间闪烁元素的工作解决方案是为父节点设置 CSS：

`-webkit-backface-visibility: hidden;`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-01-09T15:27:01.357

我的解决方案是将波纹管CSS应用于所有受影响元素的父级。

```
-webkit-transform-style: preserve-3d;
-webkit-transform:translate3d(0,0,0); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-10-11T00:31:16.120

这是Chrome 22（显然是 Safari）上 Macintosh 文本渲染的[一个已知问题。](http://lists.w3.org/Archives/Public/www-style/2012Oct/0014.html)GPU 加速导致 MacOS 从亚像素切换到灰度抗锯齿，这使得字体粗细看起来明显减少。

更新：

正如下面的 OP 所述，修复是应用[`-webkit-font-smoothing: antialiased`](https://developer.mozilla.org/en-US/docs/Web/CSS/font-smooth)- 它始终应用灰度抗锯齿。如果你这样做，你可能会想要增加你的字体权重，因为灰度抗锯齿文本看起来比亚像素更薄

您可以通过应用导致内容始终为 GPU 加速的属性（例如 back-face-visibility: hidden）来获得相同的效果，但因为这些属性并不能保证在未来的浏览器版本中导致 GPU 加速 - 它更面向未来只需指定灰度。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-10-13T01:48:31.837

我在 Chrome 中遇到了同样的问题，但在 Firefox 中没有。

临时修复是添加`web-kit`修复并删除过渡：

```
-webkit-transition: none; 
```

# javascript - 新建时使用可变参数

> ID：12827140
> 
> 赞同：3
> 
> 时间：2012-10-10T19:43:18.213
> 
> 标签：javascript, new-operator, apply

我有一个参数列表，例如`var args = ['blah', 1, 3.9]`，我想将其应用于需要更新的内容，例如`new bleh.Thinggy(a, b, c)`.

我想做以下`var m = {}; bleh.Thinggy.apply(m, args);`

我担心有些事情我没有想到有谁知道这是否安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:50:38.650

您当前的方法有缺陷，因为原型继承不会按预期工作。for 构造函数
的等价物是：`method.apply(context, args)`

```
// Given a list of arguments `args`:
var bindArgs = [Constructor.prototype].concat(args);
new (Function.prototype.bind.apply(Constructor, bindArgs)); 
```

[`Function.prototype.bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)和的作用[`Function.prototype.apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)在相应的文档中进行了说明。**记住：`.bind`返回一个函数！**

为了简单起见，我将解释如何使用`.bind`固定数量的参数，比如两个。然后，以下具有相同的效果：

```
Math.max.apply(Math, 2, 3);
Math.max.bind(Math, 2, 3)(); 
```

和

```
Math.max.apply(Math, 2, 3, 4, 5);
Math.max.bind(Math, 2, 3)(4, 5); 
```

如果您甚至浏览过文档，您肯定会理解第一种形式。第二种形式虽然更棘手。它*在这种情况下*有效，因为参数的位置`Math.max`不相关。*考虑所有*参数的最大值，其中所有参数都被同等对待。

现在，下面是一个带有自定义函数的示例：

```
function echoMe(name, age) {
    console.log('Hello ' + name + '. Your age is ' + age);
    console.log('this is ', this);
}
echoMe('Rob', '19');
// "Hello Rob. Your age is 19"
// "this is [object DOMWindow]"  (non-strict mode)
var echoYou = echoMe.bind(null, "Oops");
echoYou("Peter", "19");
// "Hello Oops. Your age is Peter"
// "this is null" 
```

因为在这种情况下参数的位置很重要，所以最后一个例子显示了一些奇怪的东西。事实上，第一个参数被该方法**绑定到“Oops”**`.bind`。传递给*绑定函数* `echoYou`的参数被附加到参数列表中。此外，您注意到上下文`this`已更改为`null`.

有趣..让我们尝试使用以下方法更改上下文`.apply`：

```
function printThisFood() {
    console.log("this.food is " + this.food);
}
printThisFood.apply({food: "Fish"});
// "this.food is fish"
var locked = printThisFood.bind({food: "Strong"});
locked.apply({food: "Weak"});
// "This.food is Strong" 
```

如您所见，`this.food`仍然指向通过`.bind`!定义的上下文中的方法。

* * *

因此，我们知道如何锁定函数的上下文，以及将任意数量的*固定*参数传递给函数。这可以应用于构造函数，从而产生我在答案之上提出的函数。要验证它是否按预期工作：

```
function Constructor() {
    console.log(this instanceof Constructor); // true
    console.log(this, arguments);             // Convince yourself via console
}
var bindArgs = [Constructor.prototype].concat([1, 2]);
// is equal to [Constructor.prototype, 1, 2]

var BoundConstructor = Function.prototype.bind.apply(Constructor, bindArgs);
var instance = new BoundConstructor();

// Eliminated intermediate variable, and put on one line
var instance = new (Function.prototype.bind.apply(Constructor, bindArgs)); 
```

注意：我省略`()`了单行中的括号，因为没有这些就可以初始化构造函数。`new Image`并且`new Image()`行为相同。
要立即从构造的方法中读取属性（或调用方法），您可以将整个表达式括在括号中或附加`()`以消除歧义：

```
(new (Function.prototype.bind.apply(Constructor, bindArgs))).method()
new (Function.prototype.bind.apply(Constructor, bindArgs))().method(); 
```

注 2：它仍然认为附加参数附加到参数列表中。此属性还可用于“预设”给定构造函数的第一个参数：

```
function Stupid(obvious1, obvious2, foo) { this.interesting = foo; }
Stupid.prototype.onlymethod = function() { return this.interesting};
var saveKeyStroke = Function.prototype.bind.call(Stupid, Stupid.prototype, 1, 2);
// Or, equivalent:
//var saveKeyStroke=Function.prototype.bind.apply(Stupid,[Stupid.prototype,1,2]);

new saveKeyStroke('Fourth argument').onlymethod(); // "Fourth argument"
new saveKeyStroke().onlymethod(); // undefined
(new saveKeyStroke).onlymethod(); // undefined 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:49:35.850

Apply 是安全的，但它不会返回任何`bleh.Thinggy`. 如果你想要实例，`bleh.Thinggy`那么你必须在使用 bleh.Thinggy.apply 之前创建它。

代码：

```
var m = new bleh.Thinggy; // m is instance of  bleh.Thinggy.
        bleh.Thinggy.apply(m, args);
        ... use m as instance of bleh.Thinggy.apply 
```

# c++ - 使用 C/C++，如何以彩色打印到标准输出，但前提是终端支持它？

> ID：12827143
> 
> 赞同：23
> 
> 时间：2012-10-10T19:43:27.620
> 
> 标签：c++, c, linux, colors

我有一个程序将事情记录到`STDOUT`.

这些日志条目具有关联的“日志级别”（调试、警告、信息等），我想让用户能够根据日志级别为该输出着色。

确定是否`STDOUT`连接到具有颜色功能的终端的方法是什么？那么我怎样才能用颜色输出我的文本呢？

我正在寻找仅涉及 C 或 C++ 调用的解决方案。我猜`curses`（或`ncurses`）有一些东西可以缓解这种情况，但我想避免使用它来将我的依赖关系降至最低。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-10T19:50:03.870

可能最简单的检查方法很简单：

```
isatty(fileno(STDOUT)) 
```

`1`如果您的标准输出被发送到任何类型的终端，这将返回。实际上，任何终端都将支持或忽略 VT100 颜色代码；检查 terminfo 是不必要的，除非您希望输出到某些非常不寻常的硬件终端。（其中大部分已经几十年没有制造了。）

要输出颜色，请使用（扩展的）SGR 序列：

```
"\x1b[%dm" 
```

其中`%d`是常用支持颜色的以下值之一：

```
0: reset colors/style
1: bold
4: underline
30 - 37: black, red, green, yellow, blue, magenta, cyan, and white text
40 - 47: black, red, green, yellow, blue, magenta, cyan, and white background 
```

还有更多值，但这些是最广泛支持的值。同样，对于这些控制代码来说，检查 terminfo 基本上是不必要的，因为每个值得一提的软件终端都会支持（或忽略）它们。

如果您需要一次更改多个属性，您可以一次指定它们，用分号分隔。例如，以下序列将在绿色背景上用粗体洋红色文本灼伤您的眼球：

```
"\x1b[1;35;42m" 
```

# iphone - 从一个 ViewController 导航到另一个

> ID：12827147
> 
> 赞同：2
> 
> 时间：2012-10-10T19:43:37.693
> 
> 标签：iphone, objective-c, ios, xcode, storyboard

我的故事板中有这样的设计：

![在此处输入图像描述](../Images/adb7437cdaf7fd3b6ab83d6bb56f4610.png)

如您所见，中间的 ViewController 连接到导航控制器（我刚刚使导航栏不可见）。在这个中间页面中，我以编程方式添加了所有控件（[使用 Parse 移动平台登录向导](https://parse.com/docs/ios/api/Protocols/PFLogInViewControllerDelegate.html#//api/name/logInViewController:didLogInUser:)）。

问题是我想在登录成功后导航到第三页。

```
- (void)logInViewController:(PFLogInViewController *)logInController didLogInUser:(PFUser *)user {
    [self dismissModalViewControllerAnimated:YES];
    ViewController2 *viewController = [[[ViewController2 alloc] init] autorelease];
    [self.navigationController pushViewController:viewController animated:YES];
    printf("%s", [@"Ali" UTF8String]);
} 
```

该消息将被打印，但导航失败。你能帮我吗？也许我需要在故事板中修复一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T03:27:22.080

我不确定你是否应该发送`dismissModalViewControllerAnimated:`消息。您是否在登录视图控制器之上以模态方式呈现另一个视图控制器？

无论如何，当您在情节提要中配置了视图控制器时，您无法使用`alloc`and创建视图控制器`init`。您需要询问情节提要来创建它。有几种方法可以做到这一点。

### 单程

让故事板创建您的一种方法`ViewController2`是在您的故事板中制作一个 push segue。

1.  打开你的故事板。
2.  按住 Control 从登录视图控制器拖动到`ViewController2`.
3.  选择“推”segue 类型。
4.  点击转场。
5.  选择“视图”>“实用工具”>“显示属性检查器”。
6.  在 Attributes Inspector（窗口右侧）中，将 segue 标识符设置为“didLogIn”。

要执行 segue，请执行以下操作：

```
- (void)logInViewController:(PFLogInViewController *)logInController didLogInUser:(PFUser *)user {
    [self dismissModalViewControllerAnimated:YES];
    [self performSegueWithIdentifier:@"didLogIn" sender:self];
} 
```

### 另一种方式

让故事板创建您的另一种方法`ViewController2`是给它一个故事板 ID 并要求故事板按 ID 实例化视图控制器。然后你可以推送视图控制器。

`ViewController2`在您可以要求故事板创建它之前，您必须为故事板中的实例提供一个“故事板 ID” 。

1.  打开你的故事板。
2.  选择`ViewController2`实例。
3.  选择“视图”>“实用工具”>“显示身份检查器”。
4.  在 Identity Inspector（窗口右侧）中，输入“viewController2”。案例很重要！

然后，在您的代码中，让故事板实例化`viewController2`：

```
- (void)logInViewController:(PFLogInViewController *)logInController didLogInUser:(PFUser *)user {
    [self dismissModalViewControllerAnimated:YES]; // Should this be here?
    ViewController2 *viewController = [[[ViewController2 alloc] init] autorelease];
    [self.navigationController pushViewController:viewController animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:00:14.663

试试这个方法

```
 ViewController2 *myViewController=[storyboard instantiateViewControllerWithIdentifier:@"TheNameOfYourController"]
    [self.navigationController pushViewController:myViewController animated:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:59:19.510

因为缺少很多相关的代码/设置，我建议如下：

1.  使用此代码：

    ```
    -(void)logInViewController:(PFLogInViewController *)logInController didLogInUser:(PFUser *)user {
     [self dismissViewControllerAnimated:YES completion:NULL];

     Class klass = [[NSBundle mainBundle] classNamed:@"ViewController2"];
     ViewController2 *viewController = [[klass alloc] init];
     [self.navigationController pushViewController:viewController animated:YES];
     [viewController release];

     NSLog("%@", @"Ali");
     } 
    ```

2.  如果这不起作用，请检查您打算如何初始化 ViewController2。

如果这一切都没有帮助，请尝试发布更多相关代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-30T09:19:15.750

**使用 Storyboard Identifier 移动下一个 viewController**

```
nextViewController *objnextViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"nextViewControllerIdentifier"];

[self.navigationController pushViewController: objnextViewController animated:YES]; 
```

# c# - 方法调用计时器

> ID：12827149
> 
> 赞同：0
> 
> 时间：2012-10-10T19:43:42.563
> 
> 标签：c#, .net

如何在时间到期后调用方法

```
public void tMetro(string url)
          {
              tm.Stop();
              tm.Interval = 5000;
              tm.Start();
              method_8(url, "");
              if (wb.Url.AbsoluteUri == url)
                  wb.Stop();
          } 
```

但不是在事件 Timer_tick

```
private void timer1_Tick(object sender, EventArgs e)
        {
            tm.Stop();
            wb.Stop();
        } 
```

已尝试通过`Thread.Sleep()`应用程序冻结

不知道该怎么办。需要你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:18:07.283

最常见的方法是在[Timer Thread](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)中调用您的函数。

Timer 线程构造函数有一个变体，它接受 4 个参数：

```
public Timer(
    TimerCallback callback, // The function to be called
    Object state, // Any parameter passed to that function
    TimeSpan dueTime, // Delay before executing the function, this is what you want
    TimeSpan period // Set this to -1 if you want your function to be executed once.
) 
```

线程处理可能很难处理，但在消耗远程资源时它是首选方法。这样您就可以避免冻结您的主框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:55:33.713

尝试这个

```
var thread = new Thread(() => {
    Thread.Sleep(5000); tm.Stop(); wb.Stop();
});
thread.Start(); 
```

# python - python列出和计算值

> ID：12827150
> 
> 赞同：-3
> 
> 时间：2012-10-10T19:43:43.470
> 
> 标签：python, iterator, counter

在下面给出的示例数据（存储在文件中）中，我需要以最快的方式在每个“项目”类别中找到不同的“ID”。我可以通过遍历每一行然后找到所有项目集然后计数来做到这一点，但我正在寻找一种更快的方法，例如“Counter”或“itemgetter”。

“infile.txt”

```
id  item
444 Anemia
444 liver
444 Anemia
444 Anemia
222 liver
222 pancreas
222 liver
222 Anemia
444 pancreas
444 pancreas
444 Anemia
001 Iiver
001 pancreas
111 pancreas
111 liver
111 liver
111 pancreas
555 pancreas
555 liver
555 pancreas
555 liver
555 pancreas
555 liver 
```

我需要类似以下的输出

```
item    count   ids
pancreas    5   001, 111, 222, 444, 555
liver   5   111,222,444,555,001
Anemia  2   222,444 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:45:55.607

我会使用 defaultdict 和`set`

```
from collections import defaultdict
d = defaultdict(set)
with open(datafile) as f:
    for line in f:
        my_id,item = line.split()
        d[item].add(my_id)

for item in d:
    print item,len(d[item]),sorted(d[item]) 
```

# java - 适合 int、int 和 string 的数据结构

> ID：12827154
> 
> 赞同：1
> 
> 时间：2012-10-10T19:44:17.430
> 
> 标签：java, data-structures

我正在犹豫什么是合适的数据结构来保存以下数据形式：

1.  一个整数代表最小数
2.  一个整数代表最大数量
3.  一个字符串包含一条消息

所以如果我有一个 result_number 我可以 -

1.  检查 result_number 是否介于最小值和最大值之间
2.  并显示相应的消息

那么什么是合适的数据结构呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T19:46:38.070

听起来你想要...

（等等……）

...一个有两个整数和一个字符串的类。

```
public final class RangeValidation {
    private final int minimum;
    private final int maximum;
    private final String message;

    public RangeValidation(int minimum, int maximum, String message) {
        if (minimum > maximum) {
            throw new IllegalArgumentException("Invalid min/max combination");
        }
        if (message == null) {
            throw new NullPointerException();
        }
        this.minimum = minimum;
        this.maximum = maximum;
        this.message = message;
    }

    // You can tweak this API, of course...
    // it could throw an exception instead, or return an empty string for
    // success, etc.
    public String validate(int value) {
        return value < minimum || value > maximum ? mesasge : null;
    }
} 
```

当然，你可能想让这个实现一个接口以适应更通用的验证框架等......但重要的一点是你已经清楚地描述了你想要你的类型包含的内容 - 所以你只需要编写它。

另请注意，这会将`maximum`值视为*包含*值- 您可能希望将其设为独占，以便能够表示空范围。（这确实使表示一个`Integer.MAX_VALUE`有效的范围变得更加困难......）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T19:46:32.143

在 java 中，“数据结构”由具有字段的类表示。该类可能具有使用这些字段的方法。

尝试这个：

```
public class MyClass {

    private int min;
    private int max;
    private String message;

    public void testNumber(int number) {
        if (number >= min && number <= max) {
            System.out.println(message);
        }
    } 
} 
```

您可能应该有一个构造函数来设置字段的值，我建议您制作字段`final`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T19:48:42.087

如果区间数很少，请使用`class`具有三个成员（`min`、`max`和`message`）的 a，将它们存储在列表中，然后运行线性搜索。

如果间隔的数量过多，并且时间要求使线性搜索望而却步，则创建一个[*间隔树*](http://en.wikipedia.org/wiki/Interval_tree)，并将消息与其叶节点相关联。

如果区间不重叠，您可以创建一个具有两端的区间类，并将区间对象存储在 a 中，`TreeMap`使用它们的左边界来比较区间。有了这个`TreeMap`，您可以通过调用[`floorEntry`](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html#floorEntry%28K%29)您尝试定位的号码并检查返回的间隔键是否与您正在查找的值重叠来快速找到一个间隔。

# c# - c# 与 Youtube Javascript API？

> ID：12827155
> 
> 赞同：0
> 
> 时间：2012-10-10T19:44:24.980
> 
> 标签：c#, javascript, youtube

我正在使用在 .net 4 下运行的应用程序，并希望在那里观看 youtube 视频（该应用程序类似于 MediaCenter）。

我也想用按钮播放/暂停，所以据我所知，我可以使用 youtube 的 api for javascript？

我目前正在使用 Webbrowser 控件来显示视频，还是有更好的解决方案？

感谢您的建议问候

# xml - 引入 Spring Portlet 的 XML 配置的最佳方式是什么？

> ID：12827157
> 
> 赞同：0
> 
> 时间：2012-10-10T19:44:25.607
> 
> 标签：xml, spring, portlet, opentext

我一直在尝试在我的 Spring Portlet 中定义一些可用于应用程序默认值的原始常量，但没有成功。我希望它们在 XML 文件中定义。

这听起来应该是一个简单的问题，但是**Spring 2.5**和**Vignette**的结合使它变得困难。因为我使用的是 Spring，我已经通过使用类似的东西定义数据结构将数据结构注入到我的 portlet 中

```
<util:list></util:list> 
```

在上下文配置 xml 文件中。但是，Spring 不允许使用这种范式引入单个原语（如字符串和整数）的机制。

我一直在尝试通过**portlet.xml**文件引入这些数据。我尝试添加**“init-param”**节点，但在我看来，这是针对与后端配置相关的特定参数，不应该（也不能）用于特定于应用程序的变量。

目前，我的控制器实现了**PortletConfigAware**，我希望能够以某种方式在 XML 文件中定义参数，这些参数可通过 PortletConfig 对象（其中包含 PortletConfig.getInitParameter("PARAMETER_NAME") 方法）获得。

我正在使用 Vignette (OpenText)，但希望使用独立于供应商的模式......理想情况下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T11:42:01.883

您可以将配置文件放在 WEB-INF/path/to/config.xml 中的某个位置

然后，使用以下路径将其取回：

```
String pathToConfig = portletConfig.getPortletContext().getRealPath("/") + File.separator + "WEB-INF" + ...; 
```

希望这会有所帮助，菲利普

# json.net - 无法使用 RavenDB 和 JsonConverter 自定义序列化程序 - 可能与 Json.Net 4.0.8 不兼容

> ID：12827161
> 
> 赞同：1
> 
> 时间：2012-10-10T19:44:41.360
> 
> 标签：json.net, ravendb, restsharp

对于我的项目，我必须反序列化一个 Uri 字符串，并通过创建一个自定义转换器来 遵循这个[SO 问题中提供的建议。](https://stackoverflow.com/questions/7792382/json-net-uri-deserialization-errors)

当我将转换添加到 RavenDB 中公开的序列化程序时，我收到以下错误：

*TestSuite.EmailSMSTests.CanSendSMSWithFilter: System.ArrayTypeMismatchException : 试图以与数组不兼容的类型访问元素。*

我以这种方式添加转换器：

```
docStore.Conventions.CustomizeJsonSerializer = serializer => serializer.Converters.Add(new UriJsonConverter());
docStore.Initialize(); 
```

如果我使用 Json.Net 创建 JsonSerializer，我可以成功添加转换器：

```
var serializer = new JsonSerializer();
serializer.Converters.Add(new UriJsonConverter()); 
```

我怀疑这可能是由于程序集重定向造成的，因为我需要与 RESTSharp 一起使用的更高版本的 Json.Net。该项目使用 Raven.client 960、Json.Net 4.08 和 Json.Net 4.5.7。欢迎任何见解。

这是转换器的代码：

```
public class UriJsonConverter : JsonConverter
    {

        public override bool CanConvert(Type objectType)
        {
            return object.Equals(objectType, typeof(Uri));
        }

        public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
        {
            switch (reader.TokenType)
            {
                case JsonToken.String:
                    return CreateUri((string)reader.Value);
                case JsonToken.Null:
                    return null;
                default:
                    var msg = string.Format("Unable to deserialize Uri from token type {0}", reader.TokenType);
                    throw new InvalidOperationException(msg);
            }
        }

        private static Uri CreateUri(string uriString)
        {
            Uri uri;
            if (!Uri.TryCreate(uriString, UriKind.Absolute, out uri))
                if (!Uri.TryCreate(uriString, UriKind.Absolute, out uri))
                    if (!Uri.TryCreate(uriString, UriKind.RelativeOrAbsolute, out uri))
                    {
                        var msg = string.Format("Unable to determine proper UriKind for Uri {0}", uriString);
                        throw new InvalidOperationException(msg);
                    }
            return uri;
        }

        public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
        {
            if (null == value)
            {
                writer.WriteNull();
                return;
            }

            var uri = value as Uri;
            if (uri != null)
            {
                writer.WriteValue(uri.OriginalString);
                return;
            }
            var msg = string.Format("Unable to serialize {0} with {1}", value.GetType(), typeof(UriJsonConverter));
            throw new InvalidOperationException(msg);
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T00:56:26.170

您是否尝试过使用 json 4.5.7 的 Raven 客户端 972？ [https://nuget.org/packages/RavenDB.Client/1.0.972](https://nuget.org/packages/RavenDB.Client/1.0.972)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-22T22:21:47.830

出于某种奇怪的原因，Raven DB 在其客户端中包含旧版本的 Newtonsoft JSON。要注册类型转换器，您必须执行以下操作：

```
using (var store = new DocumentStore { Url = "http://..." })
{
    store.Initialize();

    // Required if you are going to serialize Identity types
    store.Conventions.IdentityTypeConvertors.Add(new IdentityTypeConverter());

    // This is how you register 
    store.Conventions.CustomizeJsonSerializer = serializer => serializer.Converters.Add(new IdentityTypeConverter());

...
} 
```

# html - 为什么浏览器会解析 HTML5 中的自定义标签？

> ID：12827169
> 
> 赞同：4
> 
> 时间：2012-10-10T19:45:14.070
> 
> 标签：html, tags, semantics

> **可能重复：**
> [可以使用未知的 HTML 标签吗？](https://stackoverflow.com/questions/10830682/is-it-ok-to-use-unknown-html-tags)

我已经`<oles-tag> ... </oles-tag>`在 Chrome 和 IE9 中测试了一个自定义标签。

我使用 HTML5 文档类型`<!DOCTYPE html>`。

HTML5 不支持自定义标签。代码不会验证，但浏览器还是会解析它。我什至可以用 CSS 来定位它...

当自定义标签不是标准化的有效代码时，为什么浏览器会解析它？

为什么我不应该为了语义代码而使用自定义标签？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-10T19:47:54.430

> 为什么浏览器解析自定义标签，而不是标准化和有效的代码？

使其向前兼容。试想一下，如果您无法`<article>`在旧浏览器中设置元素样式，因为`<article>`在编写这些旧浏览器时不存在。那会很可怕，不是吗？*瞪着IE*

> 为什么我不应该为了语义代码而使用自定义标签？

因为没有其他人（程序）识别这些标签，所以它们不是语义的。元素 like`<article>`被认为是语义的原因是因为它们有一个*既定*的用途。当您使用没有既定用途的自定义元素时，可能会以多种方式对其进行解释，从而导致程序之间的不一致。*瞪着`<b>`和`<i>`*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:49:07.367

浏览器往往对标记很宽容。这在历史上部分源于难以采用复杂的 SGML 语法。

90 年代后期出现了趋向严格的趋势，导致了[XHTML](http://en.wikipedia.org/wiki/XHTML)的出现，每一个错误都会导致灾难性的失败。如果您更喜欢严格性，似乎有一个[适用于 HTML5 的 XHTML](http://en.wikipedia.org/wiki/HTML5#XHTML5)版本。

XHTML 还有一个有趣的特性——你可以定义和使用任何你想要的自定义标签，事实上这是它发展[的两个主要原因之一](http://www.w3.org/TR/xhtml1/#why)。

# arrays - 在富文本框中对齐数组输出

> ID：12827173
> 
> 赞同：0
> 
> 时间：2012-10-10T19:45:48.753
> 
> 标签：arrays, vb.net, arraylist, alignment

我正在处理与上一个问题相同的程序，但现在我无法对齐我现在修复的程序的输出。我知道其中一些可能看起来很乱，但不知何故我让它工作了。

无论如何，输出与我的标题不一致，看起来不太好。我无法弄清楚如何解决这个问题。

```
Imports System.IO
Imports System.Convert

Public Class frmAll
'Declare Streamreader
Private objReader As StreamReader

'Declare arrays to hold the information
Private strNumber(24) As String
Private strName(24) As String
Private strSize(24) As String
Private decCost(24) As Integer

Private Sub frmAll_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    'Set objReader
    objReader = New StreamReader("products.csv")
    Call FillArray()
End Sub

Private Sub FillArray()
    'Declare variables and arrays

    Dim decCost(24, 1) As Decimal
    Dim strFields() As String
    Dim strRec As String
    Dim intCount As Integer = 0
    Dim chrdelim As Char = ToChar(",")
    'Set strRec to read the lines

    strRec = objReader.ReadLine

    'Do while loop to fill array.
    Do While strRec <> Nothing
        strFields = strRec.Split(chrdelim)
        strNumber(intCount) = strFields(0)
        strName(intCount) = strFields(1)
        strSize(intCount) = strFields(2)
        decCost(intCount, 0) = ToDecimal(strFields(3))
        decCost(intCount, 1) = ToDecimal(strFields(4))
        'Set strRec to read the lines again
        strRec = objReader.ReadLine
        'increment the index
        intCount += 1
    Loop
    Call Calculate(decCost)
End Sub

Private Sub Calculate(ByVal numIn(,) As Decimal)
    'Define arrays to hold total cost
    Dim decRowTotal(24) As Decimal

    'Define variables to hold the counters for rows and columns
    Dim intR As Integer
    Dim intC As Integer

    'Calcualte total cost
    For intC = 0 To 1
        For intR = 0 To 24
            decRowTotal(intR) += numIn(intR, intC) * 1
        Next
    Next

    Call Output(numIn, decRowTotal)

End Sub

Private Sub Output(ByVal NumIn(,) As Decimal, ByVal RowTotalIn() As Decimal)
    Dim strOut As String

    Dim intR As Integer = 0
    Dim intC As Integer = 0

    strOut = "ID" & vbTab & "Item" & vbTab & vbTab & vbTab & "Size" & vbTab & vbTab & vbTab & vbTab & "Total Price" &
        vbCrLf & "--------------------------------------------------------------------------------------------------------------------------------------------------" &
        vbCrLf

    For intC = 0 To 24
        strOut &= strNumber(intC) & vbTab
        strOut &= strName(intC) & vbTab
        strOut &= strSize(intC) & vbTab & vbTab
        strOut &= RowTotalIn(intC).ToString("c")
        strOut &= vbCrLf

    Next

    rtbAll.Text = strOut

End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:14:32.527

您为此类工作使用了错误的工具。
您需要一个 DataGridView 而不是 RichTextBox。
使用 DataGridView，您可以随意调整列大小。

使用制表符在 Richtextbox 中创建伪列的方法失败了，因为如果某些文本（例如项目列）比用于表示制表符的空间长，那么下一个制表符将移动到最右边的位置并贯穿其余部分文本未对齐的行。您可以尝试尽量减少添加或删除选项卡的问题，但是，除非文本像素长度等于为选项卡保留的长度，否则您的列将不对齐。

在下面提供的链接中，您将找到一个简单的未绑定数据网格视图的示例，其中填充了字符串数据。

[http://msdn.microsoft.com/en-us/library/5s3ce6k8(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/5s3ce6k8(v=vs.100).aspx)

# java - java.lang.ExceptionInInitializerError 在 Spring 中创建应用程序上下文时出现异常

> ID：12827178
> 
> 赞同：5
> 
> 时间：2012-10-10T19:46:03.917
> 
> 标签：java, spring, exception, applicationcontext

我正在使用 Spring 进行练习，当我尝试实例化上下文时遇到 java.lang.ExceptionInInitializerError 异常。异常出现在下面，我的代码紧随其后。我已经简化了我之前的实验。

例外

```
Oct 17, 2012 5:54:22 PM org.springframework.context.support.AbstractApplicationContext prepareRefresh
INFO: Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@570c16b7: startup date [Wed Oct 17 17:54:22 CDT 2012]; root of context hierarchy
Exception in thread "main" java.lang.ExceptionInInitializerError
at org.springframework.context.support.AbstractRefreshableApplicationContext.createBeanFactory(AbstractRefreshableApplicationContext.java:195)
at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:128)
at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:535)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
at helloworld.HelloWorldTest.main(HelloWorldTest.java:13)
Caused by: java.lang.NullPointerException
at org.springframework.beans.factory.support.DefaultListableBeanFactory.<clinit>(DefaultListableBeanFactory.java:105)
... 7 more 
```

我的配置 XML

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:c="http://www.springframework.org/schema/c"
xmlns:p="http://www.springframework.org/schema/p"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

<bean id="messageContainer" class="helloworld.MessageContainer">
    <property name="message" value="Hello World">
    </property>
</bean>

<bean id="messageOutputService" class="helloworld.MessageOutputService">
</bean> 
```

我的测试课。

```
package helloworld;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class HelloWorldTest {

/**
 * @param args
 */
public static void main(String[] args)
{
    ApplicationContext context = new ClassPathXmlApplicationContext("HelloWorldTest-context.xml");

    MessageContainer message = context.getBean(MessageContainer.class);

    MessageOutputService service = context.getBean(MessageOutputService.class);

    service.outputMessageToConsole(message);

}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T13:52:22.720

第 17 行不对应于该`context.getBean("userRepository"`行，它对应于您初始化 Spring 上下文的那一行。实际上，您还可以通过堆栈跟踪看到，它说它在`ClassPathXmlApplicationContext`该类的构造函数所在的第 83 行失败。

[无论如何，当 Spring 由于任何原因（构造函数中的异常、资源加载问题](http://forum.springsource.org/showthread.php?46346-Exception-after-deploying-java-lang-ExceptionInInitializerError)、[类加载问题](https://stackoverflow.com/q/2272354/644766)等）无法创建任何 bean 时，通常会引发此异常。我建议降低 spring 类和你自己的库的日志级别，看看下面发生了什么。

```
org.springframework=TRACE
com.gamemanagertest=TRACE
com.gamemanagertest=TRACE 
```

并检查您的资源文件是否可以被您的应用程序和所有对象的构造函数访问，如果它们产生任何错误等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-29T09:10:02.610

我面临着同样的问题。我从项目中删除了所有的弹簧罐。然后再次将它们全部粘贴到项目文件夹中并将它们全部添加到构建路径中。它奏效了。不太清楚是怎么发生的。。

# c - 退出清理线程

> ID：12827181
> 
> 赞同：2
> 
> 时间：2012-10-10T19:46:08.803
> 
> 标签：c, multithreading

我有一个应用程序，其中我有 1 个主线程，它创建 10 个不同的线程来完成某些工作。在应用程序结束时，当我尝试退出时，应用程序无法干净地退出。堆栈跟踪不是那么有用，但它显示函数“cancel_deliver()”中的崩溃我的第一个猜测是这是在释放每个线程使用的资源时进行的一些底层调用，但并不完全确定。

fyi：每个线程的回调函数都有一个 while (1) 循环：

这是片段

```
void main (...)
{
    pthread_t tid;
    for (int i=0; i<10; i++)
        pthread_create(&tid, NULL, xyzCallback,  NULL);
}

void xyzCallback(void* data)
{
    while (1)
    {
       ////
    } 
}

void atExit()
{
    exit(1);
} 
```

我可以做些什么来释放我的线程使用的资源并干净地退出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:52:15.787

**对于这种情况**

如果我正确理解您的设置...

您可以做的一件事是拥有一组“标志”变量，每个线程（包括主线程）一个。当主线程准备好结束时，设置它的标志。应在其他 10 个线程中不断检查此标志。设置后，更改该特定线程的标志变量并调用`pthread_exit`. 在主退出方法中，只有在设置了所有标志变量后才终止。

假设您的程序没有由于其他原因而崩溃，这应该使所有线程能够以受控方式完成。

（或`pthread_join`在主退出函数中使用，因为`pthread_exit`返回由 使用的信息`pthread_join`）

**一般来说**

使用`pthread_exit`而不是`exit(1)`干净地退出线程。

从[LLNL](https://computing.llnl.gov/tutorials/pthreads/#CreatingThreads) POSIX 线程编程页面：

> 如果您没有显式调用 pthread_exit()，那么如果 main() 在它产生的线程之前完成，就会有一个明确的问题。它创建的所有线程都将终止，因为 main() 已完成并且不再存在以支持线程。

另请参阅 pthread_exit[手册页](https://computing.llnl.gov/tutorials/pthreads/man/pthread_exit.txt)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T09:49:50.137

您需要决定您的线程 (1) 是否需要以明确定义的方式（状态）结束，或者后者是否无关紧要 (2) 注意何时何地可以取消它们（当程序结束时隐式发生）

参考1：一种可能的方法是实现一个退出条件，当程序终止并使线程离开其`while(1)`循环时将触发该条件。在离开`main`循环调用它收到的`pthread_join()`任何调用之前。如果所有线程都终止，则剩下的连接循环和 main 结束，所有线程都已经终止。`pthread_t pthread``pthread_create()``main`

参考 2：这是更关键的情况，因为取决于线程函数的代码，不清楚它将在哪里取消，这可能导致意外行为。可以在所谓的取消点取消线程。[一些系统调用被视为这样](http://www.kernel.org/doc/man-pages/online/pages/man7/pthreads.7.html)。

无论如何，线程函数**不一定**需要`pthread_exit()`作为最后一条语句调用。仅当您希望`pthread_join()`接收传递给 的指针时才需要这样做`pthread_exit()`。

# php - 谷歌上的重复内容。htaccess 还是 robots.txt？

> ID：12827183
> 
> 赞同：3
> 
> 时间：2012-10-10T19:46:11.467
> 
> 标签：php, .htaccess, seo, robots.txt, canonical-link

在我的网站中，我有以下类别的 url 结构：

`/category.php?id=6`（id=6 用于互联网类别）

我的 SEO 友好网址如下：

```
/category/6/internet/ 
```

问题是它可以以任何这些形式访问，因此，我在谷歌上得到了重复的内容。

所以，我想知道我该如何解决这个问题。

我应该禁止`robots.txt`任何带有它的网址`?`吗？

如果是这样，我该如何正确设置它？

我应该在“永久移动”上进行重定向`.htaccess`吗？

如果是这样，我该如何正确设置它？

我的实际`.htaccess`类别是这样的：

```
RewriteRule ^category/([^/]*)/([^/]*)/$ category.php?id=$1&name=$2 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:47:17.910

您只需要在页面的头部设置规范链接标签

请参阅[http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)

和[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)

它看起来像

```
<link rel="canonical" href="http://www.example.com/category/6/internet/"/> 
```

在第 6 类页面上

您还可以通过添加为您的 .htaccess 中的 category.php 页面执行 301 重定向

```
RewriteRule ^category.php?id=([^&]*)&name=([^&]*) /category/$1/$2/ [R=301,L] 
```

如果您不想走 rewriterules 的路线，可以将以下代码放在 config.php 的顶部：

```
if(preg_match('/^\/config\.php/', $_SERVER['REQUEST_URI'])){
    header("HTTP/1.1 301 Moved Permanently");
    header("Location: /category/{$_GET['id']}/{$_GET['name']}");
    die();
} 
```

无论哪种方式都取决于你，但如果我是你，我会使用 rewriterule 选项重定向到我的 SEO 友好 URL

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:53:20.420

或者您摆脱非 SEO 网址。

*   始终生成 SEO url（无论如何你都应该这样做）
*   在 category.php 检查 $_SERVER['REQUEST_URI'] 是否是 seo 之一，如果不是重定向到它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:56:31.463

我建议在文档头中使用规范链接，以确保 Google 使用正确的 URL。[谷歌在 Rel Canonical 上](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)。

这很容易实现，只需将其发布到页面的 HEAD 部分即可。

```
<link rel="canonical" href="/your/url"/> 
```

Google 将规范链接视为 301 重定向，这意味着您不会遇到任何重复的内容问题。这也意味着大部分链接汁都被传递（在 90% 和 99% 之间）。如果您使用 robots.txt 或 .htaccess ，您屏蔽的页面将失去其所有 SEO 价值。

只需确保对每个页面都执行此操作，因为它是特定于页面的规则。链接到域根将实际上意味着您的所有页面都是 301 重定向到主页。

# xcode - 使用 Flurry

> ID：12827191
> 
> 赞同：2
> 
> 时间：2012-10-10T19:46:34.837
> 
> 标签：xcode

我有个问题。我在用目标 c 编写的项目中包含了*flurry.h* 和*libflurry.a*文件。然后我将*SystemConfiguration.framework*添加到我的应用程序中。然后在*Application Delegate:file*我导入 *Flurry.h*并在*applicationDidFinishLaunching*添加： *[Flurry startSession:@"MY_KEY"]*;

在我的 mainViewController 中，我编写了这个函数，当我点击我的按钮时调用这个函数。

```
(IBAction)Push:(id)sender {

    [Flurry setUserID:@"Flurry"];
    [Flurry setAge: 22];
    [Flurry setGender:@"m"];
    [Flurry logEvent:@"I just clicked Push!!!"];
    NSLog(@"button clicked!!!");

} 
```

但在我的 flurry.com 帐户中，我看不到任何变化。我能做些什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:05:26.820

Flurry需要几个小时才能更新（我发现有大约十个小时的延迟）。

稍后再试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:05:52.920

首先确保`Push:`调用了您的方法。然后检查您的互联网连接。然后检查您使用的应用程序密钥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T16:46:48.847

请从以下文档中注意这一点`startSession`：

*如果在模拟器上测试，请务必通过主页按钮将 App 发送到后台。Flurry 依赖于 iOS 生命周期来完成完整的报告。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T05:11:30.773

你必须试试这个。

```
#import "FlurryAnalytics.h"

(IBAction)Push:(id)sender {

    [Flurry setUserID:@"Flurry"];
    [Flurry setAge: 22];
    [Flurry setGender:@"m"];
    [FlurryAnalytics logEvent:@"I just clicked Push!!!"];
    NSLog(@"button clicked!!!");

} 
```

# cassandra - Cassandra 作为嵌入式服务并具有自定义一致性级别

> ID：12827193
> 
> 赞同：1
> 
> 时间：2012-10-10T19:46:48.570
> 
> 标签：cassandra

我正在考虑构建一个使用 Cassandra 作为其数据存储但具有低延迟要求的应用程序。我`EmbeddedCassandraService`从[这篇博文中知道](http://prettyprint.me/2010/02/14/running-cassandra-as-an-embedded-service/)

以下实现是否可行？已知的缺陷是什么（缺陷、功能限制）？

1) 将 Cassandra 作为嵌入式服务运行，将数据持久保存到磁盘（持久）。

2) Java 应用程序通过以下方式之一与本地嵌入式服务交互。有哪些优点

*   `TMemoryBuffer`（或更合适的东西？）
*   `StorageProxy`（使用这个 API 有什么陷阱？）
*   阿帕奇阿弗罗？（见下面的问题#5）

3) Java 应用程序通过 Thrift（或 Avro？）与远程 Cassandra 服务（“备份”节点）交互。

4) 写入必须始终成功到本地嵌入式 Cassandra 服务才能成功，并且至少有一个远程（非嵌入式）Cassandra 节点。这可能吗？是否可以定义自定义/复杂的一致性级别？

5）附带问题：*Cassandra：权威指南*在几个地方提到 Thrift 最终将被 Avro 取代，但似乎情况还不是这样？

正如您可能猜到的那样，我是 Cassandra 的新手，因此对特定文档页面（不是 wiki 主页）或示例项目的任何指导表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T13:33:05.257

除非您的整个数据库都位于本地机器上（即单个节点），否则您不会通过此配置获得任何收益。Cassandra 将在集群中对您的数据进行分片，因此（如其中一条评论中所述）您的写入将经常发送到拥有数据的另一个节点。假设您以至少 1 的一致性级别写入，您的调用将阻塞，直到该其他节点确认写入。这抵消了与嵌入式实例交谈的任何好处，因为无论如何您都有一些网络延迟。

# firefox - 添加到多行文本框的额外字符

> ID：12827198
> 
> 赞同：2
> 
> 时间：2012-10-10T19:47:09.987
> 
> 标签：firefox, textbox, character, carriage-return, asp.net-4.5

我遇到的问题是，当我创建一个多行文本框时，它会预先添加（回车换行）字符。

我正在使用.NET 4.5。我创建了一个只有多行文本框的空项目：

```
<asp:TextBox ID="txtTest" runat="server" TextMode="MultiLine" Rows="5" Columns="50"></asp:TextBox> 
```

在 Firefox 和 chrome 中，它呈现为：

```
<textarea name="txtTest" rows="5" cols="50" id="txtTest">&#13;&#10;</textarea> 
```

在 IE 中，这很好。

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-30T17:39:14.163

就像[jmoreno](https://stackoverflow.com/users/234954/jmoreno)建议的那样，改变

```
controlRenderingCompatibilityVersion=4.0 
```

到

```
controlRenderingCompatibilityVersion=4.5 
```

在`web.config`帮助我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T17:54:17.863

这已在 .NET 4.5 RTM 版本中修复。你用的是4.RC吗？[RTM 中修复的连接问题](http://connect.microsoft.com/VisualStudio/feedback/details/748052/textbox-with-multiline-textmode-adds-additional-linebreak-to-the-output)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T20:23:51.540

忽略文本区域的初始前导换行符（LF 或 CRLF）。

IE 8 和其他较旧的浏览器（例如 Firefox 3）在解析字符实体后会删除前导换行符。

但是，较新的浏览器在解析字符实体之前会删除前导换行符，然后将其解释为 textarea 的默认值的一部分。

我不知道为什么 .NET 会生成这些字符实体。

# java - 使用具有相同 JFrame 的多个类

> ID：12827202
> 
> 赞同：1
> 
> 时间：2012-10-10T19:47:22.683
> 
> 标签：java, class, jframe, jpanel

我在这里有点吃不消。我一直在为如何完成这样的任务而烦恼。对于我的 International Bacc，我必须为我的 Program dossier 填写某些标准，其中之一是使用继承和传递参数等。我正处于制作原型的阶段，并希望实现在同一个内使用多个 JPanel 的效果框架。我用 setVisivble() 粗略地实现了这一点，并将两个面板都添加到 JFrame 中。我知道我可以为此使用 CardLayout 并且可能会尽快实现它。

总而言之，我想要实现的是我有一个登录按钮来加载另一个 jpanel，有没有办法在单独的类中做到这一点？因为当我似乎使用 myframe.add(new mypanelClass()) 时，它会创建一个全新的 JFrame！本质上，我想将这个文件中的迷你类分离到另一个类中。另外，如何在另一个面板上制作一个注销按钮，让我从另一个班级回到登录屏幕？提前感谢您的帮助。

这是我的代码：

```
import javax.swing.*;
import java.awt.event.*;
import java.awt.*;
import java.io.*;
import java.util.*;

class Menu extends JFrame
{
JFrame container = new JFrame();
JPanel screen = new JPanel();
JPanel screenBase = new JPanel();
Image ProgramIcon = Toolkit.getDefaultToolkit().getImage("imageIco.png");
ImageIcon logo = new ImageIcon ("Logo.png");
JLabel icon = new JLabel(logo);
JLabel username = new JLabel("Username");
JLabel password = new JLabel("Password");
JTextField user = new JTextField(18);
JPasswordField pass = new JPasswordField(18);
JButton login = new JButton("Login");
JLabel errorInfo = new JLabel("");
int WIDTH = 800;
int HEIGHT = 500;

JPanel screen2 = new JPanel();
JButton logout = new JButton("Logout");
ImageIcon title = new ImageIcon("title.png");
JLabel header = new JLabel(title);

public static void main(String[] args)
{
    try {UIManager.setLookAndFeel("com.nilo.plaf.nimrod.NimRODLookAndFeel");}
    catch (UnsupportedLookAndFeelException e){ JOptionPane.showMessageDialog(null, "GUI Load Error: Unsupported");}
    catch (ClassNotFoundException e) { JOptionPane.showMessageDialog(null, "GUI Load Error: NimROD Missing");} 
    catch (InstantiationException e) { JOptionPane.showMessageDialog(null, "GUI Load Error: Instantiation Missing");} 
    catch (IllegalAccessException e) { JOptionPane.showMessageDialog(null, "GUI Load Error: Illegal Access"); } 
        Menu admin = new Menu();
}

public Menu()
{
    container.setIconImage(ProgramIcon);
    container.setTitle("Login");
    container.setSize(WIDTH,HEIGHT);
    container.setResizable(false);
    container.setVisible(true);
    container.add(screen);
    container.setDefaultCloseOperation(EXIT_ON_CLOSE);
    screen.add(username);
    screen.add(password);
    screen.add(user);
    screen.add(pass);
    screen.add(login);
    screen.add(icon);
    screen.setLayout(null);
    Dimension iconSize = icon.getPreferredSize();
    Dimension usernameSize = username.getPreferredSize();
    Dimension passwordSize = password.getPreferredSize();
    Dimension loginSize = login.getPreferredSize();
    Dimension userSize = user.getPreferredSize();
    Dimension passSize = pass.getPreferredSize();
    username.setBounds(252,170,usernameSize.width,usernameSize.height);
    password.setBounds(495,170,passwordSize.width,passwordSize.height);
    user.setBounds(180,200,userSize.width,userSize.height);
    pass.setBounds(420,200,passSize.width,passSize.height);
    login.setBounds(375,250,loginSize.width,loginSize.height);
    icon.setBounds(250,50,iconSize.width,iconSize.height);

    ButtonHandler handle = new ButtonHandler();
    login.addActionListener(handle);

    new BaseScreen();
}

public class BaseScreen
{
    public BaseScreen()
    {
        container.add(screen2);
        screen2.setLayout(null);
        screen2.add(logout);
        screen2.add(header);
        screen2.setVisible(false);
        Dimension headerSize = header.getPreferredSize();
        Dimension logoutSize = logout.getPreferredSize();
        logout.setBounds(720,440,logoutSize.width,logoutSize.height);
        header.setBounds(0,0,headerSize.width,headerSize.height);
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        ButtonHandler handle = new ButtonHandler();
        logout.addActionListener(handle);
    }
}

public class ButtonHandler implements ActionListener
{
    public void actionPerformed(ActionEvent event)
    {
        if (event.getSource() == login)
        {
            if((user.getText().equals("")) && (pass.getText().equals("")))
            {
                errorInfo.setText("Please enter username and password");
                screen.add(errorInfo);
                errorInfo.setForeground(Color.RED);
                Dimension errorInfoSize = errorInfo.getPreferredSize();
                errorInfo.setBounds(300,300,errorInfoSize.width,errorInfoSize.height);
            }

            if((user.getText().equals("admin"))&&(pass.getText().equals("password")))
            {
                screen.setVisible(false);
                screen2.setVisible(true);
                container.setTitle("Menu");
                user.setText("");
                pass.setText("");
            }
        }

        if (event.getSource() == logout)
        {
            screen2.setVisible(false);
            screen.setVisible(true);
            container.setTitle("Login");
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:27:08.040

您需要停止在扩展 JFrame 的类中实例化一个 JFrame，即 2 个 JFrame。编写 JFrame 容器 = this; 然后使用 IDE 的内联功能来内联容器字段。

如果 BaseScreen 需要访问 JFrame 'this'，您可以将该值传递给 BaseScreen 的构造函数，并且 BaseScreen 可以将该值存储为一个字段。没有“将类链接在一起”的魔法，您可以通过传递值来告诉一个对象另一个对象。如果我说的内容不熟悉，您需要访问 Java 教程的构造函数部分 - [http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)

# objective-c - 如何在 willRotateToInterfaceOrientation 中获得正确的 NavigationController 帧大小？

> ID：12827208
> 
> 赞同：1
> 
> 时间：2012-10-10T19:47:45.833
> 
> 标签：objective-c

我正在尝试获得正确的内容框架大小，它考虑了导航栏的高度大小。
但是如果在 willRotateTo~ 方法中使用 NSLog 输出帧大小，则显示较早的帧大小。
但是它在 didRotateFrom~ 方法中显示了正确的帧大小。
如何在 willRotateTo~ 方法中获得像 didRotateFrom~ 一样的帧大小？

以下是 AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.

    ViewController *rootView = [[[ViewController alloc] init] autorelease];

    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[[UINavigationController alloc] initWithRootViewController:rootView] autorelease];

    } else {
        self.viewController = [[[UINavigationController alloc] initWithRootViewController:rootView] autorelease];
    }

    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

接下来是 ViewController.m

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
    NSLog(@"willRotate size is width : %f  height : %f", self.view.frame.size.width, self.view.frame.size.height);
}

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
    NSLog(@"didRotate size is width : %f  height : %f", self.view.frame.size.width, self.view.frame.size.height);
} 
```

以下是旋转到横向时的结果。

![在此处输入图像描述](../Images/af4c1fd792d49c1fda107f64c2c06e29.png)

```
/Users/nice7285/Library/Caches/appCode10/DerivedData/testView-d007adbb/Build/Products/Debug-iphonesimulator/testView.app/testView
Simulator session started with process 3896
2012-10-11 04:28:59.719 testView[3896:11303] willRotate size is width : 320.000000  height : 416.000000
2012-10-11 04:29:00.025 testView[3896:11303] didRotate size is width : 480.000000  height : 268.000000 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-10-24T22:55:47.860

接受的答案并不能真正解决您面临的问题。如果您在 didRotateFromInterfaceOrientation 中执行 UI 更改，则 UI 更改发生在屏幕执行其旋转动画之后。这最终看起来非常丑陋和突然。

您应该使用 willAnimateRotationToInterfaceOrientation，它在发生旋转、重新计算边界后调用，并允许您为动画设置 UI 控件。这将使您能够从一个方向平滑过渡到另一个方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:20:59.340

原因是`self.view.frame`在`willRotateToInterfaceOrientation`旋转之前为您提供尺寸是因为视图尚未旋转，因此框架尚未更改。那时您唯一可以知道的是您要旋转到哪个方向。如果您想要该函数中的新维度，您必须自己对它们进行硬编码。你不应该这样做，因为`didRotateFromInterfaceOrientation`应该能够做你想做的一切。

# sql - SQL 评估两列并创建两行（可能）

> ID：12827209
> 
> 赞同：0
> 
> 时间：2012-10-10T19:47:51.700
> 
> 标签：sql

对于令人困惑的标题，我很抱歉，我不知道如何用语言表达我想要做的事情。无论如何，我需要评估两列流感和肺炎。计算列评估该行是否包含 Flu 和 Pneumonia 两列中的值，如果该行的 Flu 列包含任何内容，则返回 Flu，如果该行的 Pneumonia 列包含任何内容，则返回 Pneumonia。SQL如下：

```
CASE
WHEN FluSpecifics != '' THEN 'Flu'
WHEN PneumoniaSpecifics != '' THEN 'Pneumonia'
END as VaccineAdministered 
```

但是，正如您所看到的，如果一行包含两列中的信息，我的查询将只关心 FluSpecifics 列中的值，因为在代码中它排在第一位。为了进一步澄清表格是否如下所示：

```
 FluSpecifics          PneumoniaSpecifics
successful vaccine      successful vaccine 
```

计算的列 VaccineAdministered 将返回 Flu。如果两者都存在，我需要此列返回两者。因此，如果两列都包含信息，我需要它来创建另一行。我怎样才能做到这一点？此外，我需要将两列都编译成一个名为“Specifics”的列，其中 PneumoniaSpecifics 数据对应于在 VaccineAdministered 字段中创建的具有“肺炎”的行，而 FluSpecifics 数据对应于在 VaccineAdministered 字段中创建的具有“Flu”的行。

如果您需要任何进一步的信息，请告诉我。我不关心确切的语法，我可以自己找出来（我正在使用缓存 SQL）。我宁愿知道这样做的一般方法。非常感谢您提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:05:55.770

```
SELECT 'Flu' as VaccineAdministered
FROM table 
WHERE FluSpecifics != ''

UNION

SELECT 'Pheumonia' as VaccineAdministered
FROM table
WHERE PneumoniaSpecifics != '' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-10T19:53:25.730

```
CASE
WHEN FluSpecifics != '' AND  PneumoniaSpecifics != '' THEN 'Flu and Pneumonia'
WHEN FluSpecifics != '' THEN 'Flu'
WHEN PneumoniaSpecifics != '' THEN 'Pneumonia'
END as VaccineAdministered 
```

# .net - 正则表达式在 = 之后匹配到未注释掉的第一行的行尾

> ID：12827211
> 
> 赞同：1
> 
> 时间：2012-10-10T19:47:56.363
> 
> 标签：.net, regex, expression

对于未注释掉的行，我需要将 '=' 符号之后的任何文本匹配到行尾。你能建议一个适用于此的正则表达式吗？

```
Example:
  // Username = admin
     Username = [any text here should match regex]

  // Password = password
     Password= [any text here should match regex] 
```

**更新为以下示例：**

```
One more example just for clarification:
  // FilePath = //test/test/test.log
     FilePath= //test/test/test.log 
```

“=”之前的任何内容都是单词或单词组。其他任何事情都可以/将被忽略。

单词和“=”之间是否有空格无关紧要。我还不能实现“或”子句，但这是我正在尝试使用的当前正则表达式。如果您有更好的解决方案或可以帮助更新我的正则表达式以在游戏中工作：

```
Different permutations:
 (?<=Username=).+
 (?<=Username =).+

 (?<=Password=).+
 (?<=Password =).+ 
```

**已解决：** 感谢您提供所有示例和快速响应/帮助。以下两个正则表达式最适合我的情况，具体取决于我是想要“=”之后的所有匹配还是“=”之后基于“=”之前的特定单词的单个匹配。

```
^\s*\w+\s*=\s*(.+)$       // Returns all matches
^\s*Username\s*=\s*(.+)$  // Returns a single match for a specific field 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:58:16.557

这应该有效：

```
^\s*\w+\s*=\s*(.+)$ 
```

这是使用此正则表达式的示例：

```
using System;
using System.Text.RegularExpressions;

public class Example
{
   public static void Main()
   {
      string line = "     Username = [any text here should match regex]";

      Regex r = new Regex(@"^\s*\w+\s*=\s*(?<text>.+)$");
      Match m = r.Match(line);
      if (m.Success)
         Console.WriteLine(r.Match(line).Result("${text}")); 
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:54:21.050

这应该是诀窍：

```
^\s*(?!//)\w+\s*=\s*(.*) 
```

它说的是这样的：

`^`行首

`\s*`任意数量的空格

`(?!//)`没有意见

`\w+`至少一个单词字符（如果变量名中允许使用其他字符，则应扩展）

`\s*`任意数量的空格

`=`平等标志

`(.*)`该行的其余部分（在一个组中，因此您可以提取值）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:56:01.363

仅当代码由换行符分隔时，此选项才有效

```
^\s*[^\\]+\s*=(.+)$ 
```

使用`multiline`选项

在[这里工作](http://regexhero.net/tester/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T19:56:01.790

```
^[^/]*=(.*)$ 
```

文本将匹配到反向引用 \1。

如果找到单个 / 则失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T20:09:24.060

我可以使用以下方法来做到这一点（我`$`也在使用匹配换行符选项）：

```
Section\:(?:[^\:]*(?:=.*)?\n)*\s*Field\s*=\s*(.*?)\s*$ 
```

*   `Section`是节标识符
*   `Field`是字段标识符
*   不会匹配错误部分中的字段
*   第一个捕获组将包含等号减去前导和尾随空格之后的所有内容
*   值名称中允许使用文字冒号，但键名称中不允许使用冒号
*   忽略注释字段
*   忽略空白字段

你可以用这些东西在[正则表达式上测试它：](http://regexpal.com)

```
AnotherSection:
     SomeField = x
     AnotherField = y
Section:
     SomeField = Z
     AnotherField = Q
     TricksyBlankField
     Field
     // ^ this field is blank
  // Field = ignored because I'm a comment
     Herp = : <-- literal colon
     Field =        (everything in the parentheses get captured)        
     ExtraStuff = something 
```

RegexPal 不显示组匹配，但它存在。

# asp.net - 文本框中的电子邮件地址导致 PageRequestManagerServerErrorException

> ID：12827212
> 
> 赞同：2
> 
> 时间：2012-10-10T19:48:04.943
> 
> 标签：asp.net

我在 updatePanel 中有一个**多行文本框。**用户可以在其中输入他需要的任何注释。如果他**在尖括号内***输入*电子邮件地址，那么在提交或取消时，我会收到**PageRequestManagerServerErrorException of 500**。

 ****`myaddress.xxx.ca` *如果他在这些注释中输入了不带括号*的电子邮件地址，那么就*没有错误*。

文本框也应该允许他输入任何他想要的东西，这真的只是为了他的笔记。

我已经**尝试**在`RequestValidation = "false"`页面指令中，但这*不起作用*。

任何建议，将不胜感激。

布莱恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:08:39.447

我假设您*至少使用 .Net 4.0*？我根据你的问题做了一个小例子，并注意到了同样的行为。幸运的是，我找到了一个快速的解决方案（甚至在 Stackoverflow 上 - [**Allow html in asp.net textboxes**](https://stackoverflow.com/questions/3765198/allow-html-in-asp-net-textboxes)）。

**aspx**

```
<%@ Page Language="C#" AutoEventWireup="true" ValidateRequest="false" CodeFile="commonQuestions.aspx.cs" Inherits="commonQuestions" %>
 .....
<form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:TextBox ID="TextBox1" runat="server" Height="81px" TextMode="MultiLine" Width="264px"></asp:TextBox>
            <br />
            <asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="Send" />
        </ContentTemplate>
    </asp:UpdatePanel>
</form> 
```

**代码隐藏**

```
protected void Button1_Click(object sender, EventArgs e)
{
    // do something
    Debug.WriteLine("Text: " + TextBox1.Text);
} 
```

添加到**web.config**

```
<httpRuntime requestValidationMode="2.0" /> 
```

在这里，我们从 MS那里得到了一个很好的**解释，指**[**的是 ASP.Net 4 中的变化**](http://www.asp.net/whitepapers/aspnet4/breaking-changes#0.1__Toc256770147)

> 因此，**以前未触发错误**的请求**现在可能会发生**请求验证错误。要恢复到 ASP.NET 2.0 请求验证功能的行为，请 在 Web.config 文件中添加设置*（见上文） ：*****

# version-control - 你如何在一个明确的VOB中获取一个给定日期的VOB的所有文件？

> ID：12827214
> 
> 赞同：1
> 
> 时间：2012-10-10T19:48:29.287
> 
> 标签：version-control, clearcase, cleartool

我有一个相当大的代码库，其中包含多个目录和文件，我想查看一个视图或查看给定日期（9 月 12 日）的视图。我正在手动检查文件历史记录并这样做`ct get -to someOtherDir/FileName FilenName@@/main/##`，这非常痛苦。我想知道是否有一种方法可以一次结帐并加载特定日期的所有内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:57:27.010

最简单的方法是制作一个单独的动态视图，其配置规范包括基于**时间的选择规则**（或简称时间规则，请参阅 参考资料[`cleartool man config_spec`](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/config_spec.htm)）。

参见示例“ [ClearCase : Loading Older Version of a specific Directory?](https://stackoverflow.com/questions/634509/clearcase-loading-older-version-of-a-specific-directory/635282#635282) ”。

由于您要签出文件，因此您需要通过`mkbranch`指令来完成您的选择规则。

```
element * .../aBranch/LATEST
element /aVob/myComponent/mySubDirectory/... .../aParentBranch/LATEST -time dd-Month-yyyy -mkbranch aBranch
element * /main/LATEST 
```

如果这些元素都是在“ `aParentBranch`”上创建的，它们将在正确的日期被选中，并`aBranch`在签出时分支到一个新的分支“ ”。

如果这些元素都是 on `/main`，您可以将最后两个选择规则切换为：

```
element * /main/LATEST -time dd-Month-yyyy -mkbranch aBranch 
```

从[手册页](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/config_spec.htm)：

```
-time date-time 
```

> 修改特殊版本标签的含义`LATEST`：
> 规则从分支中选择在特定时间*之前创建的最后一个版本。*

# jquery - 更改图像属性

> ID：12827222
> 
> 赞同：0
> 
> 时间：2012-10-10T19:49:09.757
> 
> 标签：jquery

我在 dom 上有图像标签，但我无法更改它的属性

```
$('#stuff').prop("disabled", true); 
```

或者

```
$('#stuff').attr("disabled", true);
$('#stuff').click(function(){ ... }); 
```

html:

```
<img src='images/system_help.png' id='stuff' width='18px'/> 
```

使用 prop 或 attr 后，我可以点击标签

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T19:52:28.460

只有表单元素具有禁用属性。相反，请尝试取消绑定您的事件 ala：

```
$('#stuff').unbind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:51:06.013

只能禁用表单元素。 `img`不是表单元素。你想通过禁用来实现`img`什么？如果您尝试删除点击处理程序，那么

```
$('#stuff').unbind('click'); 
```

会做你想做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T19:51:08.773

没有属性`disabled`。`img`

我认为你需要`one`.

`$('#stuff').one(function(){ ... });`

# java - 部署时如何在不同的包中包含 jar 文件

> ID：12827226
> 
> 赞同：1
> 
> 时间：2012-10-10T19:49:25.090
> 
> 标签：java, eclipse, jakarta-ee, ant, build

我有一个 ant 脚本，用于构建 J2EE 应用程序和创建 jar 文件。问题如下：运行应用程序需要两个 jar 文件。

```
commons-math-2.0.jar
commons-math-1.0.jar 
```

但是，我只想将 2.0 用于应用程序内的特定包，而应用程序的其余部分使用 1.0。如何构建应用程序以仅使用 2.0 版本，例如使用 com.naurus.eventhandler.risk 之类的包名称？同样，我使用的是 Ant 脚本，但如果有更简单的方法来做这种事情，我愿意尝试。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:00:47.757

如果两个 jar 包含不同的类/包，那么将它们全部放在应用程序类路径中应该没有问题。然后，不使用另一个包中的一个 jar 中的类是一个纪律问题。

但是我猜这两个罐子包含大部分相同的类/方法？有很多方法可以使用相同类的不同版本：

*   使用不同的`ClassLoader`实例。我不会将其称为“简单”，远非意味着为一堆讨厌的错误敞开大门。（可以帮助使用像 OSGi 这样的工具）
*   将应用程序拆分为两个进程，这些进程在同一个 Ant 目标中启动并使用任何方式（CORBA、RMI、REST 等）进行通信。

不过，我不建议使用任何这些方法。**让所有包都使用相同的版本可能会更简单。**这样做有什么特别的困难吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:57:20.097

这将是有问题的，因为当您部署 J2EE 应用程序时，这两个 JAR 文件将最终位于相同的类路径中。[您可以使用OSGI bundles](http://www.javaworld.com/javaworld/jw-03-2008/jw-03-osgi1.html)实现您尝试尝试的内容，这允许每个包具有单独的依赖项。但是，这是对您的应用程序进行的相对较大的重构。

IMO，最好是：

a) 从 2.0 复制您需要的功能（如果数量很少且许可证允许，例如，打包单个类）。

或者

b) 花时间将整个应用程序升级到 2.0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:05:34.327

您可以使用 jar 中的清单来定义类路径。

[http://docs.oracle.com/javase/tutorial/deployment/jar/manifestindex.html](http://docs.oracle.com/javase/tutorial/deployment/jar/manifestindex.html)

虽然老实说这似乎有点令人费解，但这是您的要求。

# excel - 应用程序定义或对象定义的错误

> ID：12827231
> 
> 赞同：1
> 
> 时间：2012-10-10T19:49:53.947
> 
> 标签：excel, excel-2007, excel-2010, vba

我正在尝试编写如下函数：

```
Function getEntityCode(fileName As String) As Range
Dim entitySheet As Worksheet
Dim c As Range
Dim i As Integer
Dim valid As Boolean
Dim finalRow As Integer
Dim finalCol As Integer

Set entitySheet = Workbooks("OHUploads.xlsm").Worksheets("EntityCodes")
finalRow = entitySheet.Cells(Application.Rows.Count, 1).End(xlUp).Row
On Error GoTo ErrHandler:
With entitySheet
   Set c = .Range(.Cells(1, 3), .Cells(1, finalCol))
End With
valid = False
ErrHandler:
Debug.Print Error(Err)
If valid = False Then
   Set getEntityCode = entitySheet.Range(entitySheet.Cells(1, 3), entitySheet.Cells(1, finalCol))
Else
   Set getEntityCode = c
End If
End Function 
```

但是不管怎么做，当语句执行到 Set c = .Range(.Cells(1, 3), .Cells(i, finalCol)) 时总是在errHandler中结束，而且总是显示：Application-defined或对象定义的错误

我以为我已经明确定义了所有内容，看不到我做错了什么，请任何人帮助我，非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:54:46.197

您从未为 设置值`finalCol`，因此它默认为 0。

调用`Cells(1,0)`会引发错误，因为 Cells 是基于 1 而不是基于 0。或者更确切地说，第 0 行或第 0 列不存在。

我建议要么使用一行：`finalCol = 1`要么只使用 1。

# sql - TSQL - 递归 CTE 效率低下 - 需要替代方案

> ID：12827236
> 
> 赞同：6
> 
> 时间：2012-10-10T19:50:15.623
> 
> 标签：sql, sql-server, sql-server-2008, tsql, common-table-expression

这是一个包含示例数据的表格：

```
DECLARE @TestTable TABLE (
    ItemID INT,
    A INT,
    B INT,
    Month INT)

INSERT INTO @TestTable VALUES (1234, 5, 9, 1)
INSERT INTO @TestTable VALUES (1234, 6, 9, 2)
INSERT INTO @TestTable VALUES (4321, 5, 11, 1)
INSERT INTO @TestTable VALUES (4321, 12, 11, 2)
INSERT INTO @TestTable VALUES (1324, 14, 6, 1)
INSERT INTO @TestTable VALUES (1324, 5, 6, 2)
INSERT INTO @TestTable VALUES (1234, 1, 9, 3)
INSERT INTO @TestTable VALUES (1324, 9, 6, 3) 
```

需要注意的是，B 列始终与在此计算中仅使用一次相同，但在初始计算中是必需的。

我试图在第一行从 A 中减去 B，然后在后续行中从 A 中减去前一行的差异。实际上，`B - A = C`在第一行然后`C - A`在所有后续行上获取相关 ItemID。

以下是我期待的结果：

```
ItemID  A   B   C   Month   RowNumber
1234    5   9   4   1       1
1234    6   9   -2  2       2
1234    1   9   -3  3       3
1324    14  6   -8  1       1
1324    5   6   -13 2       2
1324    9   6   -22 3       3
4321    5   11  6   1       1
4321    12  11  -6  2       2 
```

这是我如何做到这一点的。

```
;WITH CTE_TestValue AS (
    SELECT 
        Main.ItemID,
        Main.A,
        Main.B,
        Main.Month,
        ROW_NUMBER() OVER (Partition BY Main.ItemID ORDER BY Main.Month) AS RowNumber
    FROM @TestTable AS Main
),
CTE_TestColumnC AS (
    SELECT 
        MainA.ItemID,
        MainA.A,
        MainA.B,
        (MainA.B - MainA.A) AS C,
        MainA.Month,
        MainA.RowNumber
    FROM CTE_TestValue AS MainA
        WHERE MainA.Rownumber = 1

    UNION ALL

    SELECT 
        MainB.ItemID,
        MainB.A,
        MainB.B,
        (Sub.C - MainB.A) AS C,
        MainB.Month,
        MainB.RowNumber
    FROM CTE_TestValue AS MainB
        INNER JOIN CTE_TestColumnC AS Sub
            ON MainB.RowNumber - 1 = Sub.RowNumber
            AND MainB.ItemID = Sub.ItemID
--      CROSS JOIN CTE_TestColumnC AS Sub
--          WHERE Sub.RowNumber + 1 = MainB.RowNumber
--          AND MainB.ItemID = Sub.ItemID 
)
SELECT 
    Main.ItemID,
    Main.A,
    Main.B,
    Main.C,
    Main.Month,
    Main.RowNumber
FROM CTE_TestColumnC AS Main
ORDER BY ItemID, Month, RowNumber 
```

这适用于小型数据样本，但我正在处理大约 20,000 个 ItemId，每个重复 10 次。它按预期立即完成所有第一行计算，然后计算时间急剧增加。

如您所见，我已经尝试过 an`INNER JOIN`和 a `CROSS JOIN`。我相信他们具有与我给出的参数相同的执行计划`CROSS JOIN`。

有没有更有效/高效的方法来实现这一点？

我昨天让它运行了 5 个小时，看看它是否结束了。它没有。

另一个注意事项：当我在测试数据上使用它时，我`SELECT`没有使用`ORDER`它来帮助加快速度。`ORDER`当我进行事实检查时，这只是为了我的方便。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T06:17:18.227

您的问题是您使用 CTE 作为递归 CTE 的来源。您的第一个 CTE 将在递归 CTE 的每次迭代中执行一次。使用您的测试数据，这意味着`CTE_TestValue`创建了 8 次。

将结果放入`CTE_TestValue`具有聚集主键的`(RowNumber, ItemID)`临时表中，并将该临时表用作递归 CTE 的数据源`CTE_TestColumnC`。

还将递归部分中的连接条件更改为`ON MainB.RowNumber = Sub.RowNumber + 1`. 这将使查询能够使用临时表上的索引。

```
DECLARE @TestTable TABLE (
    ItemID INT,
    A INT,
    B INT,
    Month INT)

INSERT INTO @TestTable VALUES (1234, 5, 9, 1)
INSERT INTO @TestTable VALUES (1234, 6, 9, 2)
INSERT INTO @TestTable VALUES (4321, 5, 11, 1)
INSERT INTO @TestTable VALUES (4321, 12, 11, 2)
INSERT INTO @TestTable VALUES (1324, 14, 6, 1)
INSERT INTO @TestTable VALUES (1324, 5, 6, 2)
INSERT INTO @TestTable VALUES (1234, 1, 9, 3)
INSERT INTO @TestTable VALUES (1324, 9, 6, 3)

CREATE TABLE #TestValue
(
  ItemID INT,
  A INT,
  B INT,
  Month INT,
  RowNumber INT,
  primary key(RowNumber, ItemID)
)

INSERT INTO #TestValue
SELECT 
    Main.ItemID,
    Main.A,
    Main.B,
    Main.Month,
    ROW_NUMBER() OVER (Partition BY Main.ItemID ORDER BY Main.Month) AS RowNumber
FROM @TestTable AS Main

;WITH CTE_TestColumnC AS (
    SELECT 
        MainA.ItemID,
        MainA.A,
        MainA.B,
        (MainA.B - MainA.A) AS C,
        MainA.Month,
        MainA.RowNumber
    FROM #TestValue AS MainA
        WHERE MainA.Rownumber = 1

    UNION ALL

    SELECT 
        MainB.ItemID,
        MainB.A,
        MainB.B,
        (Sub.C - MainB.A) AS C,
        MainB.Month,
        MainB.RowNumber
    FROM #TestValue AS MainB
        INNER JOIN CTE_TestColumnC AS Sub
            ON MainB.RowNumber = Sub.RowNumber + 1
            AND MainB.ItemID = Sub.ItemID
)
SELECT 
    Main.ItemID,
    Main.A,
    Main.B,
    Main.C,
    Main.Month,
    Main.RowNumber
FROM CTE_TestColumnC AS Main
ORDER BY ItemID, Month, RowNumber

DROP TABLE #TestValue 
```

在您的查询的查询计划中，问题显示在右下角的表扫描中。使用此测试数据执行 8 次，总共返回 64 行：

![在此处输入图像描述](../Images/ed7f0c2907160323f7fc4e8fe9f998af.png)

带有临时表的查询的查询计划： ![在此处输入图像描述](../Images/53712c6aa89e357036ee3a2649999c56.png) ![在此处输入图像描述](../Images/30c62519a7aa85dfb6cffef5fc3b56a2.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:14:51.313

我希望我能正确理解你想要做什么。
这是我的解决方案：

```
WITH DATA AS (
SELECT *, row_number() over (ORDER BY itemid) RN
FROM TestTable),
RECURSIVE AS (
   SELECT itemID, B-A AS C, RN
  FROM DATA
  WHERE RN = 1
  UNION ALL
  SELECT T1.itemID, t2.C - t1.A, t1.RN
  FROM DATA AS T1
  INNER JOIN
  RECURSIVE AS T2
  ON t1.RN = T2.Rn+1)
SELECT ItemID, C
FROM RECURSIVE 
```

[您可以在此处](http://sqlfiddle.com/#!3/8bcf6/9)找到完整示例（包含您的数据）

# grails - 将 grails 中的属性外部化

> ID：12827238
> 
> 赞同：0
> 
> 时间：2012-10-10T19:50:27.597
> 
> 标签：grails

我正在尝试将 grails 中的一些自定义属性外部化。

我找不到关于如何将某些字符串属性外部化并在我的代码中使用它们的明确方法。任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T10:30:40.693

您必须在 config.groovy 中指定外部配置文件的位置。

例如像这样：

```
if (!grails.config.locations || !(grails.config.locations instanceof List)) {
    grails.config.locations = []
}

// Internal Jetty: config-files are locates inside the /web-app/WEB-INF directory
if( GrailsUtil.isDevelopmentEnv() ) {
    def dir = System.properties["base.dir"]
    def f1 = "${dir}" + File.separator + "web-app" + File.separator + "WEB-INF" + File.separator + "${appName}-config.groovy"
    grails.config.locations << "file:${f1}"
}

// TIER Tomcat: config-files are locates inside Tomcat's conf-directory
else if( System.properties["catalina.home"] ) {
    def dir = System.properties["catalina.home"]
    def f1 = "${dir}" + File.separator + "conf" + File.separator + "${appName}-config.groovy"
    grails.config.locations << "file:${f1}"
}

// JBOSS, Glassfish etc
else {
    //
}

// Further choices: command line argument (-D{$appName}.config.location=xxx)
if( System.properties["${appName}.config.location"] ) {
  grails.config.locations << "file:" + System.properties["${appName}.config.location"]
} 
```

因此，在本地开发中，配置文件位于 WEB-INF 目录下。在生活中，您可以选择放置配置文件的位置。如果需要，您可以以相同的方式调整代码以适用于 config.properties。

# jsf - 如何在int中显示最后4个数字？

> ID：12827243
> 
> 赞同：0
> 
> 时间：2012-10-10T19:50:52.897
> 
> 标签：jsf, jsf-2

我有一个 int 字段，我想在 jsf 页面中显示其最后 4 个数字，请告知如何完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:25:58.707

您可以为此使用[模](http://en.wikipedia.org/wiki/Modulo_operation)运算，[EL](https://stackoverflow.com/tags/el/info)中也[支持](http://docs.oracle.com/javaee/6/tutorial/doc/bnaik.html)使用模运算符。`%`

```
<p>Last 4 numbers: #{bean.number % 10000}</p> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T20:17:33.887

如果您需要数字的最后四位，请使用模运算符：

```
int someInteger = 23421984;
int last4digits = someInteger % 10000;
// last4digits = 1948; 
```

# api - 使用过 The Weather Channel API 的人是否知道它是否允许逐小时预测？

> ID：12827247
> 
> 赞同：0
> 
> 时间：2012-10-10T19:51:01.380
> 
> 标签：api, weather, weather-api

您可以从他们的网站访问每小时预报，但据我阅读他们 API 上的数据预报请求仅提供每日预报，我目前正在使用 Wea​​ther Underground API，但我想知道我是否可以在支付订阅费用之前使用 TWC 执行此操作。我已经给他们发了电子邮件，但没有得到答复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T17:51:34.240

Weather Channel API*是*Weather Underground API。查看 weather.com 主页底部的“天气 API”链接。它是`http://www.wunderground.com/weather/api/?ref=twc`

如果您想要一个免费的天气 API，并且您以美国为中心，您可以查看[weather.gov SOAP Web 服务](http://graphical.weather.gov/xml/)

# c# - 如何将char数组的值设置为null？

> ID：12827251
> 
> 赞同：3
> 
> 时间：2012-10-10T19:51:09.573
> 
> 标签：c#, arrays, null, char

例如，当我写道：

```
Char[] test = new Char[3] {a,b,c};
test[2] = null; 
```

它说**无法将 null 转换为 'char'，因为它是不可为空的值类型**

如果我需要清空该字符数组，有解决方案吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-10T19:54:55.840

使用可为空的字符：

```
char?[] test = new char?[3] {a,b,c};
test[2] = null; 
```

缺点是每次*访问*数组时都必须检查一个值：

```
char c = test[1];  // illegal

if(test[1].HasValue)
{
    char c = test[1].Value;
} 
```

或者您可以使用“魔术”字符值来表示`null`，例如`\0`：

```
char[] test = new char[3] {a,b,c};
test[2] = '\0'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T19:54:37.313

你不能这样做，因为正如错误所说， char 是一种值类型。

你可以这样做：

```
char?[] test = new char?[3]{a,b,c};
test[2] = null; 
```

因为您现在正在使用可为空的字符。

如果您不想使用可为空的类型，则必须确定某个值来表示数组中的空单元格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T19:54:18.577

如错误所述，`char`不可为空。尝试`default`改用：

```
test[2] = default(char); 
```

请注意，这本质上是一个空字节“ `\0`”。这不会为您提供`null`索引值。如果您确实需要考虑一个`null`场景，那么这里的其他答案效果最好（使用可为空的类型）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-10T19:55:58.470

你可以这样做：

`test[2] = Char.MinValue;`

如果您有测试来查看代码中某处的值是否为“null”，您可以这样做：

```
if (test[someArrayIndex] == Char.MinValue)
{
   // Do stuff.
} 
```

还，`Char.MinValue == default(char)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-10T19:54:18.993

您可以将 test 设置为 null

```
test = null; 
```

但不是 test[2] 因为它是 char - 因此是值类型

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-10T20:12:53.013

我不知道你的问题的原因，但如果你改用`List<>`，你可以说

```
List<char> test = new List<char> { a, b, c, };
test.RemoveAt(2); 
```

这会改变 的长度 ( `Count`) `List<>`。

# android-intent - 在运行时注册 CATEGORY_HOME 意图

> ID：12827253
> 
> 赞同：4
> 
> 时间：2012-10-10T19:51:17.970
> 
> 标签：android-intent, broadcastreceiver, broadcast, intentfilter

我需要（在运行时）为意图过滤器注册自定义广播接收器，可以在清单中描述为

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.HOME" />
    <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

并在用户通过按应用程序中的某个按钮（或
输入密码）退出应用程序时取消注册接收器。

使用代码注册的接收方

```
receiver_ = new MyReceiver();
filter_ = new IntentFilter(Intent.ACTION_MAIN);
filter_.addCategory(Intent.CATEGORY_HOME);
filter_.addCategory(Intent.CATEGORY_DEFAULT);
registerReceiver(receiver_, filter_); 
```

不接收意图，不调用 onReceive() 函数。

我做错了什么，有没有可能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T21:42:35.423

A`BroadcastReceiver`仅由广播触发`Intent`（即：使用`Intent`发送`sendBroadcast()`）。您描述的 Intent (ACTION=MAIN, CATEGORY=HOME) 不是广播`Intent`。那是`Intent`用来启动一个活动的（即：有人`startActivity()`用`Intent`看起来像那样的一个调用）。

在我看来，您正在尝试创建主屏幕替换。如果那是你想要做的，你需要在你的清单中有一个`Activity`with that 。`<intent-filter>`您不能动态注册/注销它。

如果您需要启用/禁用您的 HOME-Screen 替换，可以使用`PackageManager`. 看看`setComponentEnabledSetting()`这里：http: [//developer.android.com/reference/android/content/pm/PackageManager.html](http://developer.android.com/reference/android/content/pm/PackageManager.html)

让我们知道你发现什么！

# java - 从 JMenuItem 调用模态内部框架时使用 100% CPU

> ID：12827254
> 
> 赞同：1
> 
> 时间：2012-10-10T19:51:17.087
> 
> 标签：java, swing, jinternalframe, jmenuitem, modality

我正在使用它`ModalityInternalFrame`（从[这里开始](http://webbyit.blogspot.com/2011/03/managing-jinternalframes-within.html)- 使用的 calass 的代码在问题的末尾）用于在其他内部框架上创建模态内部框架。
它们在从 a`JButton`的事件创建和显示时没有问题，但是当我从 a 的事件`actionPerformed`创建/显示它们时，它在可见时会使用 100% 的 CPU！`actionPerformed``JMenuItem`

问题是什么？

谢谢

* * *

**模态内部框架**：

```
package com.webbyit.swing;

import java.awt.Color;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyVetoException;
import java.beans.VetoableChangeListener;
import java.util.Random;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComponent;
import javax.swing.JDesktopPane;
import javax.swing.JInternalFrame;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;
import javax.swing.event.AncestorEvent;
import javax.swing.event.AncestorListener;
import javax.swing.event.InternalFrameAdapter;
import javax.swing.event.InternalFrameEvent;

/**
 * An extended <code>JInternalFrame</code> that provides modality in a child/parent
 * hierarchy
 * 
 * @author webbyit
 */
public class ModalityInternalFrame extends JInternalFrame {

    protected JDesktopPane desktopPane;
    protected JComponent parent;
    protected ModalityInternalFrame childFrame;
    protected JComponent focusOwner;
    private boolean wasCloseable;

    public void fixSize(){
        Dimension desktopSize = parent.getSize();
        Dimension jInternalFrameSize = this.getSize();
        if(jInternalFrameSize.getHeight()>desktopSize.getHeight()){
            this.setSize(new Dimension((int)jInternalFrameSize.getWidth(), (int)desktopSize.getHeight()));;
        }

    }

    public ModalityInternalFrame() {
        init(); // here to allow netbeans to use class in gui builder
    }

    public ModalityInternalFrame(JComponent parent) {
        this(parent, null);
    }

    public ModalityInternalFrame(JComponent parent, String title) {
        this(parent, title, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable) {
        this(parent, title, resizable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable) {
        this(parent, title, resizable, closeable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable,
                                 boolean maximizable) {
        this(parent, title, resizable, closeable, maximizable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable,
                                 boolean maximizable,
                                 boolean iconifiable) {
        super(title, resizable, closeable, maximizable, iconifiable);
        wasCloseable=closeable;
        setParentFrame(parent);
        setFocusTraversalKeysEnabled(false);
        if (parent != null && parent instanceof ModalityInternalFrame) {
            ((ModalityInternalFrame) parent).setChildFrame(ModalityInternalFrame.this);
        }

        // Add glass pane
        ModalityInternalGlassPane glassPane = new ModalityInternalGlassPane(this);
        setGlassPane(glassPane);

        // Add frame listeners
        addFrameListener();

        // Add frame veto listenr
        addFrameVetoListener();

        init();

        // calculate size and position

    }

    private void setParentFrame(JComponent parent) {
        desktopPane = JOptionPane.getDesktopPaneForComponent(parent);
        this.parent = parent == null ? JOptionPane.getDesktopPaneForComponent(parent) : parent; // default to desktop if no parent given
    }

    public JComponent getParentFrame() {
        return parent;
    }

    public void setChildFrame(ModalityInternalFrame childFrame) {
        this.childFrame = childFrame;
    }

    public ModalityInternalFrame getChildFrame() {
        return childFrame;
    }

    public boolean hasChildFrame() {
        return (childFrame != null);
    }

    protected void addFrameVetoListener() {
        addVetoableChangeListener(new VetoableChangeListener() {

            public void vetoableChange(PropertyChangeEvent evt) throws PropertyVetoException {
                if (evt.getPropertyName().equals(JInternalFrame.IS_SELECTED_PROPERTY)
                        && evt.getNewValue().equals(Boolean.TRUE)) {
                    if (hasChildFrame()) {
                        childFrame.setSelected(true);
                        if (childFrame.isIcon()) {
                            childFrame.setIcon(false);
                        }
                        throw new PropertyVetoException("no!", evt);
                    }
                }
            }
        });
    }

    /**
     * Method to control the display of the glasspane, dependant
     * on the frame being active or not
     */
    protected void addFrameListener() {
        addInternalFrameListener(new InternalFrameAdapter() {

            @Override
            public void internalFrameActivated(InternalFrameEvent e) {
                if (hasChildFrame() == true) {
                    getGlassPane().setVisible(true);
                    grabFocus();
                } else {
                    getGlassPane().setVisible(false);
                }
            }

            @Override
            public void internalFrameDeactivated(InternalFrameEvent e) {
                if (hasChildFrame() == true) {
                    getGlassPane().setVisible(true);
                    grabFocus();
                } else {
                    getGlassPane().setVisible(false);
                }
            }

            @Override
            public void internalFrameOpened(InternalFrameEvent e) {
                getGlassPane().setVisible(false);
            }

            @Override
            public void internalFrameClosing(InternalFrameEvent e) {
                if (parent != null && parent instanceof ModalityInternalFrame) {
                    ((ModalityInternalFrame) parent).childClosing();
                }
            }
        });
    }

    /**
     * Method to handle child frame closing and make this frame
     * available for user input again with no glasspane visible
     */
    protected void childClosing() {
        setClosable(wasCloseable);
        getGlassPane().setVisible(false);
        if (focusOwner != null) {
            java.awt.EventQueue.invokeLater(new Runnable() {

                public void run() {
                    try {
                        moveToFront();
                        setSelected(true);
                        focusOwner.grabFocus();
                    } catch (PropertyVetoException ex) {
                        Logger.getLogger(ModalityInternalFrame.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            });
            focusOwner.grabFocus();
        }
        getGlassPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
        setChildFrame(null);
    }

    /*
     * Method to handle child opening and becoming visible.
     */
    protected void childOpening() {
        // record the present focused component
        setClosable(false);
        focusOwner = (JComponent) getFocusOwner();
        grabFocus();
        getGlassPane().setVisible(true);
        getGlassPane().setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
    }

    @Override
    public void show() {
        if (parent != null && parent instanceof ModalityInternalFrame) {
            // Need to inform parent its about to lose its focus due
            // to child opening
            ((ModalityInternalFrame) parent).childOpening();
        }
        calculateBounds();
        super.show();
    }

    protected void init() {
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGap(0, 394, Short.MAX_VALUE));
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGap(0, 274, Short.MAX_VALUE));

        pack();
    }

    public void calculateBounds() {
        Dimension frameSize = getPreferredSize();
        Dimension parentSize = new Dimension();
        Dimension rootSize = new Dimension(); // size of desktop
        Point frameCoord = new Point();

        if (desktopPane != null) {
            rootSize = desktopPane.getSize(); // size of desktop
            frameCoord = SwingUtilities.convertPoint(parent, 0, 0, desktopPane);
            parentSize = parent.getSize();
        }

        //setBounds((rootSize.width - frameSize.width) / 2, (rootSize.height - frameSize.height) / 2, frameSize.width, frameSize.height);

        // We want dialog centered relative to its parent component
        //int x = (parentSize.width - frameSize.width) / 2 + frameCoord.x;
        //int y = (parentSize.height - frameSize.height) / 2 + frameCoord.y;
        Random RND=new Random();
        int x=RND.nextInt(frameSize.width);
        int y=RND.nextInt(frameSize.height);

        // If possible, dialog should be fully visible
        int ovrx = x + frameSize.width - rootSize.width;
        int ovry = y + frameSize.height - rootSize.height;
        x = Math.max((ovrx > 0 ? x - ovrx : x), 0);
        y = Math.max((ovry > 0 ? y - ovry : y), 0);
        setBounds(x, y, frameSize.width, frameSize.height);
    }

    /**
     * Glass pane to overlay. Listens for mouse clicks and sets selected
     * on associated modal frame. Also if modal frame has no children make
     * class pane invisible
     */
    class ModalityInternalGlassPane extends JComponent {

        private ModalityInternalFrame modalFrame;

        public ModalityInternalGlassPane(ModalityInternalFrame frame) {
            modalFrame = frame;
            addMouseListener(new MouseAdapter() {

                @Override
                public void mouseClicked(MouseEvent e) {
                    if (modalFrame.isSelected() == false) {
                        try {
                            modalFrame.setSelected(true);
                            if (modalFrame.hasChildFrame() == false) {
                                setVisible(false);
                            }
                        } catch (PropertyVetoException e1) {
                            //e1.printStackTrace();
                        }
                    }
                }
            });
        }

        @Override
        public void paint(Graphics g) {
            super.paint(g);
            g.setColor(new Color(255, 255, 255, 100));
            g.fillRect(0, 0, getWidth(), getHeight());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:07:37.543

我已经用这个额外的 main 尝试了你的代码，它没有引起任何问题。也许尝试发布[SSCCE](http://sscce.org)：

```
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyVetoException;
import java.beans.VetoableChangeListener;
import java.util.Random;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.swing.JComponent;
import javax.swing.JDesktopPane;
import javax.swing.JFrame;
import javax.swing.JInternalFrame;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;
import javax.swing.event.InternalFrameAdapter;
import javax.swing.event.InternalFrameEvent;

/**
 * An extended <code>JInternalFrame</code> that provides modality in a child/parent hierarchy
 * 
 * @author webbyit
 */
public class ModalityInternalFrame extends JInternalFrame {

    protected JDesktopPane desktopPane;
    protected JComponent parent;
    protected ModalityInternalFrame childFrame;
    protected JComponent focusOwner;
    private boolean wasCloseable;

    public void fixSize() {
        Dimension desktopSize = parent.getSize();
        Dimension jInternalFrameSize = this.getSize();
        if (jInternalFrameSize.getHeight() > desktopSize.getHeight()) {
            this.setSize(new Dimension((int) jInternalFrameSize.getWidth(), (int) desktopSize.getHeight()));
            ;
        }

    }

    public ModalityInternalFrame() {
        init(); // here to allow netbeans to use class in gui builder
    }

    public ModalityInternalFrame(JComponent parent) {
        this(parent, null);
    }

    public ModalityInternalFrame(JComponent parent, String title) {
        this(parent, title, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable) {
        this(parent, title, resizable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable) {
        this(parent, title, resizable, closeable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable, boolean maximizable) {
        this(parent, title, resizable, closeable, maximizable, false);
    }

    public ModalityInternalFrame(JComponent parent, String title, boolean resizable, boolean closeable, boolean maximizable,
            boolean iconifiable) {
        super(title, resizable, closeable, maximizable, iconifiable);
        wasCloseable = closeable;
        setParentFrame(parent);
        setFocusTraversalKeysEnabled(false);
        if (parent != null && parent instanceof ModalityInternalFrame) {
            ((ModalityInternalFrame) parent).setChildFrame(ModalityInternalFrame.this);
        }

        // Add glass pane
        ModalityInternalGlassPane glassPane = new ModalityInternalGlassPane(this);
        setGlassPane(glassPane);

        // Add frame listeners
        addFrameListener();

        // Add frame veto listenr
        addFrameVetoListener();

        init();

        // calculate size and position

    }

    private void setParentFrame(JComponent parent) {
        desktopPane = JOptionPane.getDesktopPaneForComponent(parent);
        this.parent = parent == null ? JOptionPane.getDesktopPaneForComponent(parent) : parent; // default to desktop if no parent given
    }

    public JComponent getParentFrame() {
        return parent;
    }

    public void setChildFrame(ModalityInternalFrame childFrame) {
        this.childFrame = childFrame;
    }

    public ModalityInternalFrame getChildFrame() {
        return childFrame;
    }

    public boolean hasChildFrame() {
        return childFrame != null;
    }

    protected void addFrameVetoListener() {
        addVetoableChangeListener(new VetoableChangeListener() {

            @Override
            public void vetoableChange(PropertyChangeEvent evt) throws PropertyVetoException {
                if (evt.getPropertyName().equals(JInternalFrame.IS_SELECTED_PROPERTY) && evt.getNewValue().equals(Boolean.TRUE)) {
                    if (hasChildFrame()) {
                        childFrame.setSelected(true);
                        if (childFrame.isIcon()) {
                            childFrame.setIcon(false);
                        }
                        throw new PropertyVetoException("no!", evt);
                    }
                }
            }
        });
    }

    /**
     * Method to control the display of the glasspane, dependant on the frame being active or not
     */
    protected void addFrameListener() {
        addInternalFrameListener(new InternalFrameAdapter() {

            @Override
            public void internalFrameActivated(InternalFrameEvent e) {
                if (hasChildFrame() == true) {
                    getGlassPane().setVisible(true);
                    grabFocus();
                } else {
                    getGlassPane().setVisible(false);
                }
            }

            @Override
            public void internalFrameDeactivated(InternalFrameEvent e) {
                if (hasChildFrame() == true) {
                    getGlassPane().setVisible(true);
                    grabFocus();
                } else {
                    getGlassPane().setVisible(false);
                }
            }

            @Override
            public void internalFrameOpened(InternalFrameEvent e) {
                getGlassPane().setVisible(false);
            }

            @Override
            public void internalFrameClosing(InternalFrameEvent e) {
                if (parent != null && parent instanceof ModalityInternalFrame) {
                    ((ModalityInternalFrame) parent).childClosing();
                }
            }
        });
    }

    /**
     * Method to handle child frame closing and make this frame available for user input again with no glasspane visible
     */
    protected void childClosing() {
        setClosable(wasCloseable);
        getGlassPane().setVisible(false);
        if (focusOwner != null) {
            java.awt.EventQueue.invokeLater(new Runnable() {

                @Override
                public void run() {
                    try {
                        moveToFront();
                        setSelected(true);
                        focusOwner.grabFocus();
                    } catch (PropertyVetoException ex) {
                        Logger.getLogger(ModalityInternalFrame.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            });
            focusOwner.grabFocus();
        }
        getGlassPane().setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
        setChildFrame(null);
    }

    /*
     * Method to handle child opening and becoming visible.
     */
    protected void childOpening() {
        // record the present focused component
        setClosable(false);
        focusOwner = (JComponent) getFocusOwner();
        grabFocus();
        getGlassPane().setVisible(true);
        getGlassPane().setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
    }

    @Override
    public void show() {
        if (parent != null && parent instanceof ModalityInternalFrame) {
            // Need to inform parent its about to lose its focus due
            // to child opening
            ((ModalityInternalFrame) parent).childOpening();
        }
        calculateBounds();
        super.show();
    }

    protected void init() {
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGap(0, 394, Short.MAX_VALUE));
        layout.setVerticalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGap(0, 274, Short.MAX_VALUE));

        pack();
    }

    public void calculateBounds() {
        Dimension frameSize = getPreferredSize();
        Dimension parentSize = new Dimension();
        Dimension rootSize = new Dimension(); // size of desktop
        Point frameCoord = new Point();

        if (desktopPane != null) {
            rootSize = desktopPane.getSize(); // size of desktop
            frameCoord = SwingUtilities.convertPoint(parent, 0, 0, desktopPane);
            parentSize = parent.getSize();
        }

        // setBounds((rootSize.width - frameSize.width) / 2, (rootSize.height - frameSize.height) / 2, frameSize.width, frameSize.height);

        // We want dialog centered relative to its parent component
        // int x = (parentSize.width - frameSize.width) / 2 + frameCoord.x;
        // int y = (parentSize.height - frameSize.height) / 2 + frameCoord.y;
        Random RND = new Random();
        int x = RND.nextInt(frameSize.width);
        int y = RND.nextInt(frameSize.height);

        // If possible, dialog should be fully visible
        int ovrx = x + frameSize.width - rootSize.width;
        int ovry = y + frameSize.height - rootSize.height;
        x = Math.max(ovrx > 0 ? x - ovrx : x, 0);
        y = Math.max(ovry > 0 ? y - ovry : y, 0);
        setBounds(x, y, frameSize.width, frameSize.height);
    }

    /**
     * Glass pane to overlay. Listens for mouse clicks and sets selected on associated modal frame. Also if modal frame has no children make
     * class pane invisible
     */
    class ModalityInternalGlassPane extends JComponent {

        private ModalityInternalFrame modalFrame;

        public ModalityInternalGlassPane(ModalityInternalFrame frame) {
            modalFrame = frame;
            addMouseListener(new MouseAdapter() {

                @Override
                public void mouseClicked(MouseEvent e) {
                    if (modalFrame.isSelected() == false) {
                        try {
                            modalFrame.setSelected(true);
                            if (modalFrame.hasChildFrame() == false) {
                                setVisible(false);
                            }
                        } catch (PropertyVetoException e1) {
                            // e1.printStackTrace();
                        }
                    }
                }
            });
        }

        @Override
        public void paint(Graphics g) {
            super.paint(g);
            g.setColor(new Color(255, 255, 255, 100));
            g.fillRect(0, 0, getWidth(), getHeight());
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame(ModalityInternalFrame.class.getSimpleName());
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                JDesktopPane pane = new JDesktopPane();
                ModalityInternalFrame f = new ModalityInternalFrame();
                pane.add(f);
                f.setVisible(true);
                frame.setContentPane(pane);
                frame.setSize(600, 400);
                frame.setVisible(true);
            }
        });
    }
} 
```

# python - 将 sys.stdout 缓冲区设置为零的 Python 标准习语不适用于 Unicode

> ID：12827256
> 
> 赞同：6
> 
> 时间：2012-10-10T17:32:00.327
> 
> 标签：python, unicode, buffer, stdout

当我在 Python 中编写 sysadmin 脚本时，影响每次调用 print() 的 sys.stdout 上的缓冲区很烦人，因为我不想等待缓冲区被刷新然后在一旦在屏幕上，我想在脚本生成新输出后立即获得单独的输出行。我什至不想等待换行符，所以请查看输出。

在 python 中执行此操作的常用习语是

```
import os
import sys
sys.stdout = os.fdopen(sys.stdout.fileno(), 'wb', 0) 
```

这对我来说很长一段时间都很好。现在我注意到，它不适用于 Unicode。请参阅以下脚本：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

from __future__ import print_function, unicode_literals

import os
import sys

print('Original encoding: {}'.format(sys.stdout.encoding))
sys.stdout = os.fdopen(sys.stdout.fileno(), 'wb', 0)
print('New encoding: {}'.format(sys.stdout.encoding))

text = b'Eisb\xe4r'
print(type(text))
print(text)

text = text.decode('latin-1')
print(type(text))
print(text) 
```

这导致以下输出：

```
Original encoding: UTF-8
New encoding: None
<type 'str'>
Eisb▒r
<type 'unicode'>
Traceback (most recent call last):
  File "./export_debug.py", line 18, in <module>
    print(text)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe4' in position 4: ordinal not in range(128) 
```

我花了几个小时才找到它的原因（我的原始脚本比这个最小的调试脚本长得多）。这是线

```
sys.stdout = os.fdopen(sys.stdout.fileno(), 'wb', 0) 
```

我使用了多年，所以没想到会有任何问题。只需注释掉这一行，正确的输出应该如下所示：

```
Original encoding: UTF-8
New encoding: UTF-8
<type 'str'>
Eisb▒r
<type 'unicode'>
Eisbär 
```

那么脚本要做什么呢？为了让我的 Python 2.7 代码尽可能接近 Python 3.x，我一直在使用

```
from __future__ import print_function, unicode_literals 
```

这使得 python 使用新的 print() 函数，但更重要的是：它使 Python 默认在内部将所有字符串存储为 Unicode。例如，我有很多 Latin-1 / ISO-8859-1 编码数据

```
text = b'Eisb\xe4r' 
```

要以预期的方式使用它，我需要先将其解码为 Unicode，这就是

```
text = text.decode('latin-1') 
```

是为了。由于我系统上的默认编码是 UTF-8，每当我打印一个字符串时，python 都会将内部 Unicode 字符串编码为 UTF-8。但首先它必须在内部使用完美的 Unicode。

现在一切正常，只是到目前为止还没有零字节输出缓冲区。有任何想法吗？我注意到 sys.stdout.encoding 在零缓冲行之后未设置，但我不知道如何再次设置它。它是一个只读属性，OS 环境变量 LC_ALL 或 LC_CTYPE 似乎只在 python 解释器启动时才被评估。

顺便说一句：“Eisbär”是德语中“北极熊”的意思。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T20:02:12.843

print 函数在写入文件对象时使用特殊标志，导致`PyFile_WriteObject`Python C API 的函数检索输出编码以进行 unicode 到字节的转换，并且通过替换`stdout`流您丢失了编码。不幸的是，您不能再次明确设置它：

```
encoding = sys.stdout.encoding
sys.stdout = os.fdopen(sys.stdout.fileno(), 'wb', 0)
sys.stdout.encoding = encoding  # Raises a TypeError; readonly attribute 
```

您也不能使用该[`io.open`功能](http://docs.python.org/library/io.html#io.open)，因为如果您希望能够使用所需的`encoding`选项，它不允许禁用缓冲。

立即刷新打印功能的正确方法是使用`flush=True`关键字：

```
print(something, flush=True) 
```

如果这太乏味而无法随处添加，请考虑使用*自定义*打印功能：

```
def print(*args, **kw):
    flush = kw.pop('flush', True)  # Python 2.7 doesn't support the flush keyword..   
    __builtins__.print(*args, **kw)
    if flush:
        sys.stdout.flush() 
```

由于 Python 2.7 的`print()`函数实际上还不*支持*flush 关键字（麻烦），因此您可以通过在该自定义版本中添加显式刷新来模拟它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-14T14:55:48.673

的论点中`b`说文件应该以二进制**模式**[打开](https://docs.python.org/3/library/functions.html#open)，这就是 Unicode 不起作用的原因。此外，在 Python 3 中，我无法将普通字符串打印到以这种方式配置的标准输出；它说。`'wb'``sys.stdout = os.fdopen(sys.stdout.fileno(), 'wb', 0)`**`TypeError: a bytes-like object is required, not 'str'`**

 ****对于提到的“系统管理员脚本”用例，使用行缓冲**就足够了，即每当写入换行符时都会刷新输出，例如在每个正常`print("mytext")`语句的末尾。对于行缓冲，只需编写：

```
import os
import sys

sys.stdout = os.fdopen(sys.stdout.fileno(), 'w', 1)  # 1 : line buffered 
```

`./myprogram.py | cat`我发现这是必要的，以便在标准输出被重定向到可能被另一个程序读取的管道（最简单的情况：）时进行逐行输出。

如果您需要立即冲洗部分管线，您可以使用：

```
print("mytext", end="", flush=True) 
```**

# facebook-graph-api - 获取朋友在特定应用上的打开图操作

> ID：12827257
> 
> 赞同：2
> 
> 时间：2012-10-10T19:51:21.840
> 
> 标签：facebook-graph-api, permissions, facebook-opengraph

我试图弄清楚如何查看用户的哪些朋友也是 Open Graph 应用程序的用户，然后在该特定应用程序（即 news.reads）上显示这些朋友的打开图操作。

因此，本质上是返回用户可见的应用程序上的朋友操作。

我在这里看到的示例显示了friends_actions 权限，但是像Yahoo! 这样的新闻网站 和 HuffPo 能够在没有请求该权限的情况下显示在已阅读文章的登录朋友身上（它没有在他们的身份验证对话框中列出）。

你会怎么做？

谢谢！

# ios - FBUserSettingsViewController 在关闭时崩溃

> ID：12827261
> 
> 赞同：2
> 
> 时间：2012-10-10T19:51:49.633
> 
> 标签：ios, facebook-ios-sdk

我正在尝试使用 FBUserSettingsViewController 但每次我尝试关闭它时它都会崩溃。我使用以下代码来显示它：

```
FBUserSettingsViewController *userSettings = [[FBUserSettingsViewController alloc] initWithNibName:nil bundle:nil];
userSettings.readPermissions = @[];
userSettings.publishPermissions = @[@"publish_actions"];
userSettings.defaultAudience = FBSessionDefaultAudienceEveryone;
userSettings.delegate = self;
[self.navigationController pushViewController:userSettings animated:YES]; 
```

它显示得很好，但只要我点击“返回”，我就会崩溃。崩溃是一个 EXC_BAD_ACCESS，位于：

```
#0  0x34ae85de in objc_msgSend ()
#1  0x00136916 in -[FBUserSettingsViewController dealloc] at /Users/jacl/src/release/ios-sdk/src/FBUserSettingsViewController.m:86
#2  0x389e29c8 in -[UINavigationController navigationTransitionView:didEndTransition:fromView:toView:] ()
#3  0x389e249e in -[UINavigationTransitionView _notifyDelegateTransitionDidStopWithContext:] ()
#4  0x38978a82 in -[UIViewAnimationState sendDelegateAnimationDidStop:finished:] ()
#5  0x389ed8ac in -[UIViewAnimationState animationDidStop:finished:] ()
#6  0x331a22e0 in CA::Layer::run_animation_callbacks(void*) ()
#7  0x30fe45da in _dispatch_client_callout ()
#8  0x30fe7e44 in _dispatch_main_queue_callback_4CF ()
#9  0x388c31b0 in __CFRunLoopRun ()
#10 0x3883623c in CFRunLoopRunSpecific ()
#11 0x388360c8 in CFRunLoopRunInMode ()
#12 0x30a3233a in GSEventRunModal ()
#13 0x389b7288 in UIApplicationMain ()
#14 0x00003424 in main at SNIP 
```

如果有人能告诉我我搞砸了，那就太好了，但这看起来像是 Facebook SDK 中的一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T23:31:34.227

我发现了这个问题。Facebook 编码了他们的 dealloc 错误。

在 FBUserSettingsViewController 和 FBViewController 中有 dealloc，例如：

```
- (void)dealloc {
    [super dealloc];

    [_profilePicture release];
    [_connectedStateLabel release];
    [_me release];
    [_loginLogoutButton release];
    [_permissions release];
    [_backgroundImageView release];
    [_bundle release];
} 
```

这是错误的，[super dealloc] 应该总是最后被调用。在他们尝试解除分配其成员之前，该对象已被拆除。我切换了订单（最后使用 dealloc），现在可以正常工作了。我将为此提交一个错误。

# javascript - 如何检查我的文字是否有版权符号

> ID：12827262
> 
> 赞同：0
> 
> 时间：2012-10-10T19:51:57.253
> 
> 标签：javascript, jquery

```
<ul class="scDetailLinks">
 <li>
     <h3> ONSTAR®</h3>
 </li>
</ul> 
```

如何使用 jquery 或 javascript 检查 h3 是否具有版权符号

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T19:55:51.263

怎么样只是使用`.indexOf()`，像这样：

```
if ( $('.scDetailLinks h3').html().indexOf('®') != -1 ) {
   //has copyright 
} 
```

如果您没有从哪里复制 ® 的源文本，您还可以使用：

```
if ( $('.scDetailLinks h3').html().indexOf( String.fromCharCode(174) ) != -1 ) {
   //has copyright 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:59:01.440

您可以@Nelson 的回复或执行以下操作：

```
if($(".scDetailLinks h3:contains(®)"​)​.length){
  //...
} 
```

这也检查后代：

[http://api.jquery.com/contains-selector/](http://api.jquery.com/contains-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-23T22:31:09.413

您可以使用以下解决方案来检查您的文本是否具有版权符号：

```
if ($('h3').text().includes('®')) {
  // Do stuff
} 
```

# asp.net - ASP.NET 中的 Linq 延迟执行

> ID：12827265
> 
> 赞同：0
> 
> 时间：2012-10-10T19:52:06.410
> 
> 标签：asp.net, linq, execution, deferred

我的 dbml 包含一个主表“M”和一个详细表“D1”。

我的 aspx 页面由一个用于显示 M 数据的文本框和一个用于填充 D1 数据的网格组成。我希望在单击按钮时填充网格以节省加载时间（D1 包含很多行）。

问题1：以下代码是正确的方法吗？

```
protected void Page_Load(object sender, EventArgs e)
{
    MyDataContext context = new MyDataContext();
    M m = context.Ms.Single(n => n.id == id);    // id is somehow provided

    TextBox1.Text = m.field1;
}

protected void Button1_Click(object sender, EventArgs e)
{
    MyDataContext context = new MyDataContext();
    M m = context.Ms.Single(n => n.id == id);   // id is somehow provided

    Grid1.DataSource = m.D1s;
    Grid1.DataBind();
} 
```

问题 2：由于我可以在 Page_Load 中访问 m.D1，这是否意味着已经从数据库中获取了详细数据，或者是否应用了延迟执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:57:09.897

除非您显式加载子项，否则它们将被延迟加载。如果有问题，请尝试将分析器附加到您的请求并调试程序以查看何时发出查询。

如果您想在 LINQ to SQL 中预先加载子项，请将 LoadOptions 与 LoadWith 操作一起使用。

```
 protected void Button1_Click(object sender, EventArgs e)
   {
       MyDataContext context = new MyDataContext();
       var lo = new DataLoadOptions();
       lo.LoadWith<M>(m => m.D1s);
       context.LoadOptions = lo;

       M m = context.Ms.Single(n => n.id == id);   // id is somehow provided
          Grid1.DataSource = m.D1s;
       Grid1.DataBind();
   } 
```

在这种情况下，如果您不需要 m，因为它已经在页面加载中设置，只需加载适当的 D1，而无需在按钮单击处理程序中重新加载 M：

```
protected void Button1_Click(object sender, EventArgs e)
 {
     using (MyDataContext context = new MyDataContext())
     {
        IQueryable<D> D = context.D1s.Where(d => d.Mid == id);
        // id is somehow provided
        Grid1.DataSource = D;
        Grid1.DataBind();
     } 
} 
```

# typescript - 在 TypeScript 中获取和设置

> ID：12827266
> 
> 赞同：846
> 
> 时间：2012-10-10T19:52:14.990
> 
> 标签：typescript

我正在尝试为属性创建 get 和 set 方法：

```
private _name: string;

Name() {
    get:
    {
        return this._name;
    }
    set:
    {
        this._name = ???;
    }
} 
```

设置值的关键字是什么？

* * *

## 回答 #1

> 赞同：1348
> 
> 时间：2012-10-12T00:19:25.973

TypeScript 使用类似于 ECMAScript4/ActionScript3 的 getter/setter 语法。

```
class foo {
    private _bar: boolean = false;
    get bar(): boolean {
        return this._bar;
    }
    set bar(value: boolean) {
        this._bar = value;
    }
} 
```

这将使用 ECMAScript 5`Object.defineProperty()`功能生成这个 JavaScript。

```
var foo = (function () {
    function foo() {
        this._bar = false;
    }
    Object.defineProperty(foo.prototype, "bar", {
        get: function () {
            return this._bar;
        },
        set: function (value) {
            this._bar = value;
        },
        enumerable: true,
        configurable: true
    });
    return foo;
})(); 
```

所以要使用它，

```
var myFoo = new foo();
if(myFoo.bar) {         // calls the getter
    myFoo.bar = false;  // calls the setter and passes false
} 
```

但是，为了完全使用它，您必须确保 TypeScript 编译器以 ECMAScript5 为目标。如果您正在运行命令行编译器，请使用`--target`这样的标志；

```
tsc --target ES5 
```

如果您使用的是 Visual Studio，则必须编辑项目文件以将标志添加到 TypeScriptCompile 构建工具的配置。[你可以在这里](https://stackoverflow.com/a/17261732/1733315)看到：

正如@DanFromGermany 下面所建议的那样，如果您只是在读取和写入类似的本地属性`foo.bar = true`，那么拥有一个setter 和getter 对就太过分了。如果您需要在读取或写入属性时执行某些操作（例如日志记录），您可以随时添加它们。

Getter 可用于实现只读属性。这是一个示例，它还显示了 getter 如何与只读和可选类型交互。

```
//
// type with optional readonly property.
// baz?:string is the same as baz:string|undefined
//
type Foo = {
    readonly bar: string;
    readonly baz?: string;
}
const foo:Foo = {bar: "bar"}
console.log(foo.bar) // prints 'bar'
console.log(foo.baz) // prints undefined

//
// interface with optional readonly property
//
interface iFoo {
    readonly bar: string;
    readonly baz?: string;
}

const ifoo:iFoo = {bar: "bar"}
console.log(ifoo.bar)  // prints 'bar'
console.log(ifoo.baz)  // prints undefined

//
// class implements bar as a getter, 
// but leaves off baz.
//
class iBarClass implements iFoo {

    get bar() { return "bar" }
}
const iBarInstance = new iBarClass()
console.log(iBarInstance.bar) // prints 'bar'
console.log(iBarInstance.baz) // prints 'undefined'
// accessing baz gives warning that baz does not exist 
// on iBarClass but returns undefined
// note that you could define baz as a getter
// and just return undefined to remove the warning.

//
// class implements optional readonly property as a getter
//
class iBazClass extends iBarClass {
    private readonly _baz?: string

    constructor(baz?:string) {
        super()
        this._baz = baz
    }

    get baz() { return this._baz; }
}

const iBazInstance = new iBazClass("baz")
console.log(iBazInstance.bar)  // prints bar
console.log(iBazInstance.baz)  // prints baz 
```

* * *

## 回答 #2

> 赞同：147
> 
> 时间：2016-01-15T12:53:30.823

Ezward 已经提供了一个很好的答案，但我注意到其中一条评论询问它是如何使用的。对于像我这样偶然发现这个问题的人，我认为在 Typescript 网站上获得有关 getter 和 setter 的官方文档的链接会很有用，因为这很好地解释了这一点，希望在更改时始终保持最新状态制作，并显示示例用法：

[http://www.typescriptlang.org/docs/handbook/classes.html](http://www.typescriptlang.org/docs/handbook/classes.html)

特别是，对于那些不熟悉它的人，请注意不要将“get”这个词合并到对 getter 的调用中（对于 setter 也是如此）：

```
var myBar = myFoo.getBar(); // wrong    
var myBar = myFoo.get('bar');  // wrong 
```

你应该这样做：

```
var myBar = myFoo.bar;  // correct (get)
myFoo.bar = true;  // correct (set) (false is correct too obviously!) 
```

给定一个像这样的类：

```
class foo {
  private _bar:boolean = false;

  get bar():boolean {
    return this._bar;
  }
  set bar(theBar:boolean) {
    this._bar = theBar;
  }
} 
```

然后将调用私有 '_bar' 属性的 'bar' getter。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2012-10-10T20:07:27.307

这是一个可以为您指明正确方向的工作示例：

```
class Foo {
    _name;

    get Name() {
        return this._name;
    }

    set Name(val) {
        this._name = val;
    }
} 
```

JavaScript 中的 getter 和 setter 只是普通的函数。setter 是一个函数，它接受一个参数，其值为被设置的值。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-10-11T18:32:12.370

你可以写这个

```
class Human {
    private firstName : string;
    private lastName : string;

    constructor (
        public FirstName?:string, 
        public LastName?:string) {

    }

    get FirstName() : string {
        console.log("Get FirstName : ", this.firstName);
        return this.firstName;
    }
    set FirstName(value : string) {
        console.log("Set FirstName : ", value);
        this.firstName = value;
    } 

    get LastName() : string {
        console.log("Get LastName : ", this.lastName);
        return this.lastName;
    }
    set LastName(value : string) {
        console.log("Set LastName : ", value);
        this.lastName = value;
    } 

} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-13T19:11:23.970

我想我可能明白为什么它如此混乱。在您的示例中，我们需要`_name`. 但是我们通过为不相关的类变量创建 getter 和 setter 来实现这一点`Name`。

考虑一下：

```
class Car {
    private tiresCount = 4;
    get yourCarTiresCount(){
        return this.tiresCount;
    }
    set yourCarTiresCount(count) {
        alert('You shouldn\'t change car tire count')
    }
} 
```

上面的代码执行以下操作：

1.  `get`并为（**而不是**`set`）创建getter和setter 。`yourCarTiresCount`**`tiresCount`**

吸气剂是：

```
function () {
    return this.tiresCount;
} 
```

二传手是：

```
function (count) {
    alert('You shouldn\'t change car tire count');
} 
```

意思是，每次我们这样做时`new Car().yourCarTiresCount`，getter 都会运行。并且对于每个`new Car().yourCarTiresCount('7')`二传手运行。

2.  **为 private间接**创建 getter，但不创建 setter `tireCount`。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-07-11T14:53:03.097

TS 提供了 getter 和 setter，它们允许对象属性更好地控制如何在对象**外部**访问 (getter) 或更新 (setter) 。不是直接访问或更新属性，而是调用代理函数。

**例子：**

```
class Person {
    constructor(name: string) {
        this._name = name;
    }

    private _name: string;

    get name() {
        return this._name;
    }

    // first checks the length of the name and then updates the name.
    set name(name: string) {
        if (name.length > 10) {
            throw new Error("Name has a max length of 10");
        }

        this._name = name;  
    }

    doStuff () {
        this._name = 'foofooooooofoooo';
    }

}

const person = new Person('Willem');

// doesn't throw error, setter function not called within the object method when this._name is changed
person.doStuff();  

// throws error because setter is called and name is longer than 10 characters
person.name = 'barbarbarbarbarbar'; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-10-28T18:37:10.913

根据您展示的示例，您希望传递一个数据对象并通过 get() 获取该对象的属性。为此，您需要使用泛型类型，因为数据对象是泛型的，可以是任何对象。

```
export class Attributes<T> {
    constructor(private data: T) {}
    get = <K extends keyof T>(key: K): T[K] => {
      return this.data[key];
    };
    set = (update: T): void => {
      //   this is like spread operator. it will take this.data obj and will overwrite with the update obj
      // ins tsconfig.json change target to Es6 to be able to use Object.assign()
      Object.assign(this.data, update);
    };
    getAll(): T {
      return this.data;
    }
  } 
```

<T> 指泛型。让我们初始化一个实例

```
 const myAttributes=new Attributes({name:"something",age:32})

 myAttributes.get("name")="something" 
```

注意这个语法

```
<K extends keyof T> 
```

为了能够使用它，我们应该注意两件事：

1- in typestring 字符串可以是一个类型。

2- javascript 中的所有对象属性本质上都是字符串。

当我们使用 get() 时，它接收的参数类型是传递给构造函数的对象的属性，并且由于对象属性是字符串并且字符串在打字稿中是允许的类型，我们可以使用它 `<K extends keyof T>`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-05-31T10:42:23.953

如果您正在寻找在任何对象（不是类）上使用 get 和 set 的方法`Proxy` 可能会有用： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)

```
const target = {
  message1: "hello",
  message2: "everyone"
};

const handler3 = {
  get: function (target, prop, receiver) {
    if (prop === "message2") {
      return "world";
    }
    return Reflect.get(...arguments);
  },
};

const proxy3 = new Proxy(target, handler3);

console.log(proxy3.message1); // hello
console.log(proxy3.message2); // world 
```

注意：请注意，这是不支持的新 api，旧浏览器需要 polifill

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-03-22T14:13:03.823

与创建常用方法非常相似，只需将关键字reserved`get`或`set`放在开头即可。

```
class Name{
    private _name: string;

    getMethod(): string{
        return this._name;
    }

    setMethod(value: string){
        this._name = value
    }

    get getMethod1(): string{
        return this._name;
    }

    set setMethod1(value: string){
        this._name = value
    }
}

class HelloWorld {

    public static main(){

        let test = new Name();

        test.setMethod('test.getMethod() --- need ()');
            console.log(test.getMethod());

        test.setMethod1 = 'test.getMethod1 --- no need (), and used = for set ';
            console.log(test.getMethod1);
    }
}
HelloWorld.main(); 
```

* * *

在这种情况下，您可以跳过返回类型`get getMethod1() {`

```
 get getMethod1() {
        return this._name;
    } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-09-03T09:25:07.487

下面是一个如何添加 getter 和 setter 的示例 -

```
class Person {
    private _age: number;
    private _firstName: string;
    private _lastName: string;

    public get age() {
        return this._age;
    }

    public set age(theAge: number) {
        if (theAge <= 0 || theAge >= 200) {
            throw new Error('The age is invalid');
        }
        this._age = theAge;
    }

    public getFullName(): string {
        return `${this._firstName} ${this._lastName}`;
    }
} 
```

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2017-12-28T18:34:13.083

如果您正在使用 TypeScript 模块并尝试添加一个导出的 getter，您可以执行以下操作：

```
// dataStore.ts
export const myData: string = undefined;  // just for typing support
let _myData: string;  // for memoizing the getter results

Object.defineProperty(this, "myData", {
    get: (): string => {
        if (_myData === undefined) {
            _myData = "my data";  // pretend this took a long time
        }

        return _myData;
    },
}); 
```

然后，在另一个文件中，您有：

```
import * as dataStore from "./dataStore"
console.log(dataStore.myData); // "my data" 
```

# .net - 如何获取日志记录的额外异常详细信息？

> ID：12827270
> 
> 赞同：1
> 
> 时间：2012-10-10T19:52:22.597
> 
> 标签：.net, logging, exception-handling

最近我遇到了一个问题，即尽可能多地从异常中获取详细信息。原因？好吧，当您需要解决发货产品中的问题时，日志通常是您唯一拥有的东西。

明显地

```
Exception.ToString() 
```

**工作得很好，但是当您处理FaultException**并且谁知道自定义异常会给您带来什么惊喜时，它并不是很有帮助。

那么，以适当的偏执程度获得异常详细信息的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:52:22.597

我环顾四周并用谷歌搜索了这个话题。令人惊讶的是，没有太多关于这个的讨论。无论如何，我试图在这里复合精髓。

[说话便宜。给我看代码。](https://lkml.org/lkml/2000/8/25/132)

1.  这里我们有抛出异常的示例代码。

    ```
    protected void TestExceptionDetails()
    {
        try
        {
            int zero = 0;

            try
            {
                int z = zero / zero;
            }
            catch (Exception e)
            {
                var applicationException = new ApplicationException("rethrow", e);
                // put some hint why exception occured
                applicationException.Data.Add("divider_value", zero);
                throw applicationException;
            }
        }
        catch (Exception e)
        {
            var extendedexceptionDetails = GetExtendedexceptionDetails(e);
            log.ErrorFormat("Detailed:{0}", extendedexceptionDetails);
        }
    } 
    ```

2.  下面是 GetExtendedExceptionDetails 方法：

    ```
    /// <summary>
    /// This utility method can be used for retrieving extra details from exception objects.
    /// </summary>
    /// <param name="e">Exception.</param>
    /// <param name="indent">Optional parameter. String used for text indent.</param>
    /// <returns>String with as much details was possible to get from exception.</returns>
    public static string GetExtendedexceptionDetails(object e, string indent = null)
    {
        // we want to be robust when dealing with errors logging
        try
        {
            var sb = new StringBuilder(indent);
            // it's good to know the type of exception
            sb.AppendLine("Type: " + e.GetType().FullName);
            // fetch instance level properties that we can read
            var props = e.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance).Where(p => p.CanRead);

            foreach (PropertyInfo p in props)
            {
                try
                {
                    var v = p.GetValue(e, null);

                    // in case of Fault contracts we'd like to know what Detail contains
                    if (e is FaultException && p.Name == "Detail")
                    {
                        sb.AppendLine(string.Format("{0}{1}:", indent, p.Name));
                        sb.AppendLine(GetExtendedexceptionDetails(v, "  " + indent));// recursive call
                    }
                    // Usually this is InnerException
                    else if (v is Exception)
                    {
                        sb.AppendLine(string.Format("{0}{1}:", indent, p.Name));
                        sb.AppendLine(GetExtendedexceptionDetails(v as Exception, "  " + indent));// recursive call
                    }
                    // some other property
                    else
                    {
                        sb.AppendLine(string.Format("{0}{1}: '{2}'", indent, p.Name, v));

                        // Usually this is Data property
                        if (v is IDictionary)
                        {
                            var d = v as IDictionary;
                            sb.AppendLine(string.Format("{0}{1}={2}", " " + indent, "count", d.Count));
                            foreach (DictionaryEntry kvp in d)
                            {
                                sb.AppendLine(string.Format("{0}[{1}]:[{2}]", " " + indent, kvp.Key, kvp.Value));
                            }
                        }
                    }
                }
                catch (Exception exception)
                {
                    //swallow or log
                }
            }

            //remove redundant CR+LF in the end of buffer
            sb.Length = sb.Length - 2;
            return sb.ToString();
        }
        catch (Exception exception)
        {
            //log or swallow here
            return string.Empty;
        }
    } 
    ```

如您所见，我们使用反射来获取实例属性，然后获取它们的值。我知道这很昂贵，但我们并不真正知道具体异常暴露了哪些可能的属性。我们都希望在应用程序中不会经常发生错误，以免影响性能。

现在让我们看看我们实际获得了什么。

这是 Exception.ToString 返回的：

```
System.ApplicationException: rethrow ---> System.DivideByZeroException: Attempted to divide by zero.
   at NET4.TestClasses.Other.TestExceptionDetails() in c:\tmp\prj\NET4\TestClasses\Other.cs:line 1116
   --- End of inner exception stack trace ---
   at NET4.TestClasses.Other.TestExceptionDetails() in c:\tmp\prj\NET4\TestClasses\Other.cs:line 1123 
```

这将返回我们的新方法：

```
Type: System.ApplicationException
Message: 'rethrow'
Data: 'System.Collections.ListDictionaryInternal'
 count=1
 [divider_value]:[0]
InnerException:
  Type: System.DivideByZeroException
  Message: 'Attempted to divide by zero.'
  Data: 'System.Collections.ListDictionaryInternal'
   count=0
  InnerException: ''
  TargetSite: 'Void TestExceptionDetails()'
  StackTrace: '   at NET4.TestClasses.Other.TestExceptionDetails() in c:\tmp\prj\NET4\TestClasses\Other.cs:line 1116'
  HelpLink: ''
  Source: 'NET4'
TargetSite: 'Void TestExceptionDetails()'
StackTrace: '   at NET4.TestClasses.Other.TestExceptionDetails() in c:\tmp\prj\NET4\TestClasses\Other.cs:line 1123'
HelpLink: ''
Source: 'NET4' 
```

我们使用[log4net进行日志记录，并使用](http://logging.apache.org/log4net/)[ILog.IsErrorEnabled](http://logging.apache.org/log4net/release/sdk/log4net.ILog.IsErrorEnabled.html)属性来降低性能开销。我只是在调用扩展异常处理之前检查它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T21:03:56.923

记录来自异常的信息可能很有用，但事务记录的方法可能会提供更多信息。

这个想法是尽可能多地跟踪日志消息，但不要将它们写在日志文件中，而是将它们累积在内存队列中。如果用户提交的操作已成功完成，那么您只需处置跟踪消息的集合。但是，如果抛出异常，您可以同时记录异常和执行期间积累的跟踪消息。

好处是显而易见的 - 您不仅知道出现问题的信息，而且您还知道系统内部发生了哪些导致异常的进程。

# javascript - JavaScript keydown 事件：我可以告诉以前哪个元素有焦点吗？

> ID：12827275
> 
> 赞同：1
> 
> 时间：2012-10-10T19:52:33.493
> 
> 标签：javascript, javascript-events

当用户在按下 Tab 键时专注于特定元素时，我想执行特定功能。但我不想执行此函数，除非在按下 Tab 键时该特定元素具有焦点。

有没有办法从 keydown 事件本身判断哪些元素具有（具有？）焦点？或者我应该设置一个`particularElementHasFocus`属性来响应该元素上的 onBlur 和 onFocus 事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:55:16.800

您可以使用`document.activeElement`获取当前的焦点元素。或使用以下代码

```
var particularElementHasFocus  ;
$('input, textarea, button').focus(function() {
  particularElementHasFocus = this;
});

$('input, textarea, button').blur(function() {
  particularElementHasFocus = null;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:55:41.323

使用 jQuery 可以通过测试有`.focus`问题的元素来完成。使用标准 JS，您可以使用`document.activeElement`- [https://developer.mozilla.org/en-US/docs/DOM/document.activeElement](https://developer.mozilla.org/en-US/docs/DOM/document.activeElement)

# mysql - ColdFusion 10 与 MySQL 的通信链接失败

> ID：12827279
> 
> 赞同：6
> 
> 时间：2012-10-10T19:53:00.887
> 
> 标签：mysql, coldfusion, connection, communication, reset

我们正在将一些网站迁移到运行 Windows 2008 虚拟机的云基础架构上。这些网站都运行在带有 MySQL 数据库的 ColdFusion 上。它们目前在我们的 CoLo 中运行，没有任何问题。此外，它们在我们办公室的开发网络上运行，没有任何问题。

我们正在设置我们的云，以尽可能地匹配我们当前使用的配置，本质上，CF10 + IIS 在一台服务器上，MySQL 在另一台机器上。我们已经完成了 99%，大多数事情都运行良好。然而....

我们遇到了一对夫妇，如在 2 中，我们单击链接/按钮并受到欢迎的地方：

执行数据库查询时出错。

通信链路故障 从服务器成功接收到的最后一个数据包是 0 毫秒前。最后一个成功发送到服务器的数据包是 0 毫秒前。

扫描堆栈跟踪我还发现： `Caused by: java.net.SocketException: Connection reset`

通信链路错误总是：0ms。

最令人费解的是，似乎导致这种情况的查询是在所有站点上使用的*简单查询，没有任何问题。*为什么他们在这两个特定的地方都失败了，这让我们束手无策。

我们唯一的线索是，查看调用了哪些脚本的 CF 错误描述，我们可以看到查询失败的脚本被调用了两次？例如，我们的应用程序文件中出现了一种情况：

```
>The error occurred in D:/Our_Web_Sites/oursite/Application.cfm: line 73
>Called from D:/Our_Web_Sites/oursite/Application.cfm: line 17
>Called from D:/Our_Web_Sites/oursite/Application.cfm: line 1
>Called from D:/Our_Web_Sites/oursite/Application.cfm: line 73
>Called from D:/Our_Web_Sites/oursite/Application.cfm: line 17
>Called from D:/Our_Web_Sites/oursite/Application.cfm: line 1 
```

我们在 CF 代码中找不到任何会导致脚本被调用两次的东西，所以我们猜测第一次调用在 Query 上失败，所以 CF 再次尝试……只是失败和错误。

谷歌搜索这个问题我发现了很多关于更改 MySQL 超时的帖子。这些都不起作用，我没想到它们会起作用，因为我们正在处理的似乎不是超时问题。这些页面每次都失败。

我们最接近解决方案的方法来自此博客文章： [http](http://www.talkingtree.com/blog/index.cfm/2011/1/12/Validation-Query-for-MySQL-communications-link-failure) ://www.talkingtree.com/blog/index.cfm/2011/1/12/Validation-Query-for-MySQL-communications-link-failure ！

如果我们取消选中 CFAdmin 中的“维护跨客户端请求的连接。”设置，那么错误就会消失。该博客建议将其选中，这是我们的偏好，并使用“SELECT 1;”的连接验证。试试……同样的错误。

我们还尝试了 JDBC AutoConnect=true 选项。没有效果。

下载最新的 JDBC 连接器并使用它代替标准的 CF10-MySQL 连接器。没有效果。

同样，除了这两个链接之外，99% 的网站都可以正常工作，这两个链接在我们所有其他环境中都可以正常工作。还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:46:50.553

发现问题。我们在 Savvis 的云基础架构上运行我们的网络。我们使用的 Savvis 的 Windows 服务器实例安装了 Trend Micro Deep Security Agent。这是一个入侵保护系统，这就是问题所在。禁用该服务清除了所有通信错误。我不知道为什么它拒绝了它之前刚刚接受的一些查询。我很高兴（最终）把它抛在脑后！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T13:46:22.050

每次升级 CF 或 MySQL 时，我都觉得自己遇到了类似的问题。通常，更改 JDBC 驱动程序或连接字符串会有所帮助，我看到您已经尝试过了。

您是否检查过 MySQL 错误日志以获取任何提示？我们的位于 /var/lib/mysql 中（无论您的 'datadir' 变量设置为什么），并以 .err 扩展名结尾。

另外，也许为您的版本尝试其他一些 JDBC 连接字符串选项？我看到一些您可以启用的扩展日志记录。 [http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-configuration-properties.html](http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-configuration-properties.html)

# scala - Scala 工作表中的断点？

> ID：12827281
> 
> 赞同：18
> 
> 时间：2012-10-10T19:53:06.090
> 
> 标签：scala, breakpoints, scala-ide

我想在执行 Scala 工作表时执行源代码级调试。

由于工作表在保存时会自动评估，因此我不能像使用普通项目或文件那样使用“调试为”菜单选项。

有没有办法将工作表配置为在调试模式下运行，以便我可以单步执行我的代码？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-10T22:06:46.687

这不受支持，但有一个现有的 Scala Worksheet[增强请求](https://github.com/scala-ide/scala-worksheet/issues/50)来支持此功能。

# maven-3 - 安装前备份maven工件？

> ID：12827282
> 
> 赞同：0
> 
> 时间：2012-10-10T19:53:08.407
> 
> 标签：maven-3

我希望能够在安装阶段备份仓库中的现有工件？我可以用 Maven 做到这一点吗？

目前我正在调用 mvn install 的 bat 文件中编写 xcopy，但我认为必须有更好的方法？此外，我有没有办法通过 maven 或 windows 命令提示符确定 maven 存储库位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:06:19.403

要获取当前存储库位置，您可以使用[`mvn help:effective-settings`](https://maven.apache.org/plugins/maven-help-plugin/effective-settings-mojo.html)帮助命令打印所有设置。

至于在安装前存档工件，它违背了 Maven 意识形态。基本上快照版本可以随时被覆盖，并且发布版本永远不能改变。您需要更改版本（例如增加它），而不是更新发布版本。

# java - 提交时关闭弹出窗口并在父窗口中显示结果

> ID：12827286
> 
> 赞同：0
> 
> 时间：2012-10-10T19:53:22.587
> 
> 标签：java, javascript, ajax, jsp, struts

在子窗口（弹出窗口）上单击按钮时，如何在父窗口中显示结果？

我有一个jsp页面。当我单击此页面上的按钮时，它会获取 Student 对象的列表（***studentList***），并在弹出窗口中仅显示它们的名字，如下所示。

Student 对象包含所有信息，例如名字、姓氏、出生日期、地址等。

每个名称旁边都有复选框。

```
Jack    Tom     Paige
Julie   Hank    Red
Frank   Tina    May 
```

我想要做的是，当我选中复选框并单击弹出窗口中的按钮时，我想关闭弹出窗口并显示有关在父窗口中选择的学生的所有详细信息。

在显示学生详细信息时，我打算从我已经拥有的学生列表 ( ***studentLists*** ) 中获取学生详细信息，而不是对数据库运行查询。

我正在使用 Struts 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:59:52.100

如果父窗口和子窗口的域相同，则可以使用`window.opener`. 使用 window.opener 您可以调用父窗口方法。

父窗口：

```
window.childwindowAction = function(arg1, arg2,....){

   //  do stuff
}; 
```

子窗口

```
window.opener.childwindowAction (arg2, arg2, ..); 
```

# linq - 实体框架 4 DeleteObject 未显示

> ID：12827287
> 
> 赞同：1
> 
> 时间：2012-10-10T19:53:24.357
> 
> 标签：linq, entity-framework-4

我有以下 linq：

```
 var wcd = dbContext.Programs.Where(p => p.Id == Id).ToList();
     dbContext.DeleteObject(wcd); 
     SaveChanges(); 
```

我收到一条消息，说我的模型中没有 DeleteObject 的定义。我可以做 SaveChanges() 等。

我尝试了以下方法：

```
 var wcd = dbContext.Programs.Where(p => p.Id == Id).ToList();
        dbContext.Programs.Remove(wcd); 
```

但我得到以下 'System.Data.Entity.DbSet .Remove 的最佳重载方法匹配有一些无效参数

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T19:57:59.607

它是一个 DbContext 吗？如果是这样，您将需要使用作为 DbSet 一部分的 Remove [：](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.remove%28v=vs.103%29.aspx)

编辑：

您需要遍历您的列表并单独删除：

```
foreach (var wc in wcd.ToList())
{
    dbContext.Programs.Remove(wc);
}
dbContext.SaveChanges(); 
```

# java - binarySearch 方法抛出 ArrayIndexOutOfBounds 异常 - Java

> ID：12827289
> 
> 赞同：-1
> 
> 时间：2012-10-10T19:53:28.820
> 
> 标签：java, exception, methods, binary-search, indexoutofboundsexception

我不知道为什么这个方法会抛出 ArrayIndexOutOfBounds 异常。

`When I change the initial "high"`值，我搜索`"int high = array.length - 1;"`的程序将。`return any integer value`

我究竟做错了什么？

提前致谢！

* * *

```
public class BinarySearch {

public static void main(String[] args) {

    int searchValue = 12;
    int[] givenNums = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };
    binarySearch(givenNums, searchValue);
    System.out.println("\nResult: " + searchValue);

}

public static int binarySearch(int[] array, int key) {
    int low = 0;
    int high = array.length;
    int mid = (low + high) / 2;
    int i = 0;
    System.out.println();

    while (low <= high) {
        System.out.print(i + " ");
        if (array[mid] < key) {
            low = mid + 1;
            mid = (low + high) / 2;
        } else if (array[mid] > key) {
            high = mid - 1;
            mid = (low + high) / 2;
        }
        else
            return mid;

        i++;
    }
    return -1;
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T19:56:31.237

您需要对是否意味着它可以是*包容性*或*排他性*`high`的最大值保持一致。你从它是一个排他的上限开始：

 **```
int high = array.length; 
```

但是，只有当它是一个*包容性*上限时，您的`while`循环条件才适用：

 *```
while (low <= high) 
```

您可能应该将`while`条件更改为：

```
while (low < high) 
```

...并更改`high`稍后的分配。

或者，您可以保持包容性，并将初始值更改为`array.length - 1`.

这将停止情况 where `low == high == mid == array.length`，这是它会爆炸的地方。

我还建议将`mid = (low + high) / 2`计算移动到循环中的第一个语句`while`- 然后你可以摆脱重复的代码。

```
while (low < high) {        
    mid = (low + high) / 2;
    System.out.print(i + " ");
    if (array[mid] < key) {
        low = mid + 1;
    } else if (array[mid] > key) {
        high = mid;
    }
    else {
        return mid;
    }
    i++;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T19:55:22.937

数组的最大索引是`array.length - 1`从 0 开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T19:56:49.060

java中的数组从0开始索引，这意味着...

int[] arr = 新的 int[10];

第一个值为 arr[0]，最后一个值为 arr[9]，长度为 10。***

# php - 如何获得多个匹配正则表达式

> ID：12827291
> 
> 赞同：0
> 
> 时间：2012-10-10T19:53:30.677
> 
> 标签：php, regex

我正在尝试解析特殊包含语句的文本以提取特定文件。

我有以下功能：

```
function parse_includes($text, $directory = 'includes/') {
preg_match_all('/\[include:([^,]+)\]/', $text, $matches);

foreach($matches[1] as $key => $filename) {
    ob_start();
    include($directory.$filename);
    $include = ob_get_contents();
    ob_end_clean();
    $text = str_replace($matches[0][$key], $include, $text);
}

return $text; 
```

}

在传递这个变量时：

```
$text = 'Below is the footer<br><br>[include:sidebar.php] <br><br> [include:footer.php]<br>'; 
```

并回应它：

```
echo parse_includes($text); 
```

我收到此错误：

```
Warning: include(includes/sidebar.php] <br><br> [include:footer.php) [function.include]: failed to open stream: 
```

如果只有一个`[include: *'`，它会按预期工作。

我需要如何修改我的正则表达式？请注意 HTML 或空格如何围绕在任一侧的括号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:05:55.660

正则表达式默认是*贪婪*的，这意味着它们会尝试匹配尽可能多的字符。事实证明，它`([^,]+)`匹配这个字符串：

```
sidebar.php] <br><br> [include:footer.php 
```

您可以更改正则表达式以使用*relucant* `+`：

```
preg_match_all('/\[include:([^,]+?)\]/', $text, $matches); 
```

这将导致它尽可能少地匹配，而不是尽可能多地匹配。或者，您可以在匹配的字符串中禁止左括号：

```
preg_match_all('/\[include:([^,[]+)\]/', $text, $matches); 
```

# html - 将 Web 表单与远程服务器中的 Access 2007 数据库连接

> ID：12827294
> 
> 赞同：1
> 
> 时间：2012-10-10T19:53:43.273
> 
> 标签：html, visual-studio-2010, ms-access, database-connection

我几乎没有使用服务器和 Web 应用程序的经验。目标是创建一个门户网站，用户可以输入员工数据并能够稍后检索它以打印等。我创建了具有以下形式的 html 文件（也将其保存为“hr_form.asp”）：输入字段和提交按钮等。当用户单击“提交”按钮时，我希望能够在存储在访问数据库中的输入字段中输入信息。我将使用 Access 2007；我有访问 db 文件，其中包含与 Web 表单相对应的字段（fname、lname、assignment 等）。访问数据库当前保存在我的工作站中，但需要移动到远程服务器。

我的想法包括将连接字符串放在“hr_form.asp”中以在本地连接到访问数据库（在尝试连接到远程服务器之前），然后找到一种通过 post 方法从表单请求信息的方法和将用户输入保存在访问数据库的相应字段中。

但后来我听说 Visual Studio Web Developer 是一个很好的工具，并且可以通过向导选项完成连接......

有人可以向我提供他们对此的个人方法吗？如果您不介意，可以逐步概述该过程吗？我已经搜索过，我遇到的所有回复都假设有经验并跳过一些步骤。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T16:30:38.730

使用 SQL Server 比 Access 更容易混淆连接字符串。

同样，如果需要，如果您有 Intranet SharePoint 网站集而不是 Access 数据库，则连接到 SQL 数据库要容易得多。

# html - 居中基于百分比的 div

> ID：12827295
> 
> 赞同：0
> 
> 时间：2012-10-10T19:53:44.127
> 
> 标签：html, css

我看过这个问题： [Centering a percent-based div](https://stackoverflow.com/questions/2624159/centering-a-percent-based-div)

但是我的尝试没有结果。我不太明白那个问题的答案是如何有意义的，或者如何用 100% 的宽度来做。基本上我有一个动态呈现的页面，它有两个 div - 都设置为 100% 宽度和 100% 高度，以便捕获整个输出。因此，如果两个 div 的长度不同，我想将 div 居中到身体：

```
<body>
  <div id="first">Longer Name</div>
  <div id="second">Name</div>
</body> 
```

电流输出：

```
OUTPUT LONGER
OUTPUT SHORT 
```

期望的输出：

```
OUTPUT LONGER
    OUTPUT SHORT 
```

div CSS：

```
height: 100%;
position: relative;
width: 100%; 
```

正文 CSS：

```
margin: 0;
padding: 0; 
```

由于输出的动态特性，需要基于百分比的 div。

**编辑**

我应该明确表示输出是大量的表格。我举的例子是为了展示我希望它如何居中。输出不是文本。基本上一个表格的宽度可能是 120 像素，我需要将它放在正文中（这将是较长 div 的宽度，可能是 1500 像素）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:55:53.960

```
#first, #second { text-align: center; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:03:55.683

当您使用 % 宽度时，您的网站是灵活的，当您希望所有 div 居中时，您使用此代码，此代码对任何元素内容有用，将在您的任何站点位置居中

```
#first, #second{    
  width:100%;
  text-align:center;
 } 
```

最好的祝福

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-08T10:31:14.033

您可以使用这种 css：

```
#mydiv{
position:fixed;
padding:0px;

z-index: 101;
top:50%;
left:50%;
transform: translate(-50%, -50%); /*what you actually need to center*/

width: 80%;
height: 80%;
background:rgba(0,0,0,1);
display: none;
border:1px solid #d2d2d2;
} 
```

# iphone - 使用 iOS6 中的新地图，是否可以更改图层的颜色（公园、水、建筑物）

> ID：12827301
> 
> 赞同：2
> 
> 时间：2012-10-10T19:54:07.033
> 
> 标签：iphone, ios, ipad, ios6, mapkit

我知道更改 mapkit 颜色并不理想，但特别是对于我正在创建的基于位置的游戏，我希望颜色变得不那么戏剧性和更暗。有没有内置的方法可以做到这一点？由于游戏不会特定于某个区域，因此自定义叠加层不会真正起作用。我知道使用旧的谷歌地图的唯一方法是创建地图的 javascript 版本并将其添加到 web 视图中（不适合游戏）但是有了这个新的苹果地图有没有办法重新绘制形状这些元素（公园、水、建筑）具有不同的颜色。

我不完全了解以前或当前的地图包是如何从头开始工作的，所以如果我遗漏了任何信息或感到困惑，我深表歉意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:05:20.553

不，在当前的 iOS6 地图中您无法做到这一点。

[MapKit 参考](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKit_Framework_Reference/_index.html)没有任何内置函数可以做到这一点。

我会认真地要求您重新考虑更改当前 MapKit 的颜色，即使您可以通过其他一些技巧来做到这一点。您可能会被 App Store 拒绝。

您有 2 个选项 如果您想为不同的地方更改颜色等，请使用您自己的其他供应商的地图。

湾。[叠加](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKOverlayView_class/Reference/Reference.html#//apple_ref/doc/uid/TP40009715)也是一个不错的方法，但它们在下载地图的 REST 方面是繁重的工作。我现在正在我的地图中使用它，因为我所有的地图图块都是即时生成的，我不必在 iPhone 上做太多密集的工作。

# python - PyQt 应用程序因错误而关闭

> ID：12827305
> 
> 赞同：3
> 
> 时间：2012-10-10T19:54:18.803
> 
> 标签：python, qt, pyqt

我在使用 PyQt 创建窗口应用程序时遇到了一些麻烦。例如：我们有以下 GUI 类：

```
class SampleMainWindow(QtGui.QMainWindow):   
    def __init__(self, parent=None):
         ...

    def hideEvent(self, event):
        ...

    def showEvent(self, event):
        ...

    def activate(self):
        ...

    def closeEvent(self, event):
        ... 
```

如果我们只想使用它来显示结果和接受用户输入，并且对于所有控制逻辑，我们还有另一个类，它使用实例`SampleMainWindow`作为字段：

```
class Programm:
    def __init__(self):
        self.window = SampleMainWindow()
        ....

app = QtGui.QApplication(sys.argv)
prog = Programm()
prog.window.show()
app.exec_() 
```

因此，如果我们创建 的实例`Programm`，应用程序将运行良好，但在关闭时，我们会收到 python.exe 进程无法正常完成的错误。但是如果实例`SampleMainWindow`不是类的字段：

```
class Programm:
    def __init__(self):
        win = SampleMainWindow()
        .... 
```

应用程序关闭良好。什么原因？

下面是完整版的 Gui 类：

```
class SampleMainWindow(QtGui.QMainWindow):

def initTray(self):
    self.icon = QtGui.QSystemTrayIcon()
    self.icon.setIcon(QtGui.QIcon('Tray.png'))
    self.icon.show()
    self.icon.activated.connect(self.activate)

def __init__(self, parent=None):
    QtGui.QMainWindow.__init__(self)
    moduleglobalconstants.APP_RUNNING = True
    self.initTray()
    self.newSession = True

    self.setGeometry(300, 300, 600, 400)
    self.setWindowTitle('Eye: Recently Added Lines')
    self.statusBar().showMessage('Ready')
    exitAction = QtGui.QAction(QtGui.QIcon('Exit.png')
            ,'Exit'
            ,self)

    exitAction.setShortcut('Ctrl+Q')
    exitAction.setStatusTip('Exit application')
    self.connect(exitAction
                ,QtCore.SIGNAL('triggered()')
                ,QtCore.SLOT('close()'))

    menubar = self.menuBar()
    fileMenu = menubar.addMenu('&File')
    fileMenu.addAction(exitAction)

    self.toolbar = self.addToolBar('Exit')
    self.toolbar.addAction(exitAction)

    self.textEdit = QtGui.QTextEdit()
    self.scrollPosition = self.textEdit.textCursor()
    self.textEdit.setReadOnly(True)
    self.setCentralWidget(self.textEdit)

def hideEvent(self, event):
    self.hidden = True
    self.setWindowFlags(QtCore.Qt.ToolTip)
    self.setVisible(False)

def showEvent(self, event):
    self.hidden = False
    self.setVisible(True)

def activate(self):

    self.setWindowFlags(QtCore.Qt.Window)
    self.show()
    self.setWindowState(self.windowState() & ~QtCore.Qt.WindowMinimized | QtCore.Qt.WindowActive)
    self.activateWindow()

def questionDialog(self, caption = 'Message',text = "Are you sure?"):
    self.activate()
    msgBox = QtGui.QMessageBox(self)
    msgBox.setWindowTitle("Eye")
    msgBox.setText(caption);
    msgBox.setInformativeText(text);
    msgBox.setStandardButtons(QtGui.QMessageBox.Yes| QtGui.QMessageBox.No);
    msgBox.setDefaultButton(QtGui.QMessageBox.Yes);
    return msgBox.exec_()

def criticalDialog(self,app, caption = 'Eye: Critical Error',text = "Impossible to continue working!"):
    self.activate()
    msgBox = QtGui.QMessageBox.critical(self,caption,text)
    moduleglobalconstants.APP_RUNNING = False

def closeEvent(self, event):
    reply = self.questionDialog()
    if reply == QtGui.QMessageBox.Yes:
        moduleglobalconstants.APP_RUNNING = False
        event.accept()
    else:
        event.ignore()

def showNewLines(self, singleLine = None, lines = None, mode='insert'):
    if (mode == 'rewrite'):
        self.textEdit.clear()
    if lines:
        for line in lines:
            self.textEdit.insertPlainText(line.strip() + "\n")
    elif singleLine:
        self.textEdit.insertPlainText(singleLine.strip()+"\n") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:31:53.293

这与python的垃圾收集有关 - 因为（几乎）很快一个对象不再被引用它会破坏它，所以我猜只要窗口没有被垃圾收集，这个过程就不会终止。

您可以尝试在末尾添加`del Programm.window`或类似的内容（可能有更好的方法，但我自己从未编写过 QT，所以在这里我无法为您提供帮助）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-24T17:32:44.523

看到这个：

```
from PyQt4.QtCore import * 
from PyQt4.QtGui import * 
import sys 

class MyWindow(QWidget): 
    def __init__(self, parent=None): 
        QWidget.__init__(self, parent) 
        self.label = QLabel("Hi, I'm a window", self) 
        self.button = QPushButton("&Quit", self) 
        self.connect(self.button, SIGNAL("clicked()"), QCoreApplication.instance(), SLOT("quit()")) 

        lay = QVBoxLayout() 
        lay.addWidget(self.label) 
        lay.addWidget(self.button) 
        self.setLayout(lay) 

    def closeEvent(self, event): 
        print "Closing the app" 
        self.deleteLater() 

if __name__ == '__main__': 
    app = QApplication(sys.argv) 
    mw = MyWindow() 
    mw.show() 
    sys.exit(app.exec_()) 
```

解决方案是实现 closeEvent 方法

# java - 从java中的mysql数据库读取docx文件

> ID：12827307
> 
> 赞同：1
> 
> 时间：2012-10-10T19:54:25.473
> 
> 标签：java, apache, file, docx

我有一个将 docx 文件存储到我的 MYSQL 数据库 MEDIUMBLOB 数据类型的程序。

如何从数据库中检索该文件，然后使用 APACHE POI 读取它以检查单词、段落等的数量？（最初的问题）

这是我保存文件的代码。

```
public void saveFile(String FileDirectory, String FileName)
{
    try {
        //Connecting to MYSQL Database
        Class.forName(driver).newInstance();
        con = DriverManager.getConnection(url+dbName,userName,password);

         //saving the image
        PreparedStatement psmnt = (PreparedStatement) con.prepareStatement("INSERT INTO doccompfiles VALUES(?,?,?)");
        psmnt.setInt(1, 5);
        psmnt.setNString(2, FileName);
        File f = new File(FileDirectory + FileName);
        psmnt.setBlob(3, new FileInputStream(f), f.length());
        psmnt.executeUpdate();

        con.close();
        }
    catch (Exception e) {
          JOptionPane.showMessageDialog(null, "Error saving file");
          e.printStackTrace();
     }

} 
```

研究并找到了一种方法，但我的堆栈跟踪有错误。这是检索的代码。

```
public void loadFile(String FileName)
{
    try
    {
        //Connecting to MYSQL Database
        Class.forName(driver).newInstance();
        con = DriverManager.getConnection(url+dbName,userName,password);

        Statement stmt = (Statement) con.createStatement();
        ResultSet rs = stmt.executeQuery("SELECT * FROM doccompfiles WHERE FileName = '"+ FileName +"'");
        InputStream is = rs.getBinaryStream("File");

        HWPFDocument doc = new HWPFDocument(is);
        WordExtractor we = new WordExtractor(doc);

        String[] paragraphs = we.getParagraphText();
        JOptionPane.showMessageDialog(null, "Number of Paragraphs" + paragraphs.length);
        con.close();
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

堆栈跟踪：

```
java.sql.SQLException: Before start of result set
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1074)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:988)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:974)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:919)
    at com.mysql.jdbc.ResultSetImpl.checkRowPos(ResultSetImpl.java:854)
    at com.mysql.jdbc.ResultSetImpl.getBinaryStream(ResultSetImpl.java:1553)
    at com.mysql.jdbc.ResultSetImpl.getBinaryStream(ResultSetImpl.java:1586)
    at documentComparisor.Database.loadFile(Database.java:150)
    at documentComparisor.Home$5.actionPerformed(Home.java:195)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

我可以验证文件是否存储在数据库中，并且 select 语句中的表详细信息是否正确。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:12:55.760

1.  从表中选择您的 BLOB（在处理大文件时查找 getBinaryStream，否则查找 getBlob）

2.  处理它：

    ```
    HWPFDocument doc = new HWPFDocument(binaryStream);
    WordExtractor we = new WordExtractor(doc);

    String[] paragraphs = we.getParagraphText();
    System.out.println("Total Paragraphs: "+paragraphs.length);

    (then iterate through paragraphs array and count words) 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-14T11:15:15.077

请检查以下代码以从数据库中读取和写入 blob 数据

```
public class ReadBlobData {

    public static void main(String[] args) {
        writeBlob(65, "Test.docx");
        readBlob(65, "Test.docx");

    }

    public static void readBlob(int candidateId, String filename) {

        String selectSQL = "SELECT  document_text FROM scope1.documents where id=?";
        ResultSet rs = null;

        try (Connection conn = MySQLJDBCUtil.getConnection();
                PreparedStatement pstmt = conn.prepareStatement(selectSQL);) {
            // set parameter;
            pstmt.setInt(1, candidateId);
            rs = pstmt.executeQuery();

            // write binary stream into file
            File file = new File(filename);
            FileOutputStream output = new FileOutputStream(file);

            System.out.println("Writing to file " + file.getAbsolutePath());
            while (rs.next()) {
                InputStream input = rs.getBinaryStream("document_text");
                byte[] buffer = new byte[(int) file.length()];
                while (input.read(buffer) > 0) {
                    output.write(buffer);
                }
            }
        } catch (SQLException | IOException e) {
            System.out.println(e.getMessage());
        } finally {
            try {
                if (rs != null) {
                    rs.close();
                }
            } catch (SQLException e) {
                System.out.println(e.getMessage());
            }
        }
    }

    public static void writeBlob(int candidateId, String filename) {
        // update sql
        String updateSQL = "UPDATE scope1.documents " + 
                " SET  document_text=? WHERE id=?";

        try (Connection conn = MySQLJDBCUtil.getConnection();
                PreparedStatement pstmt = conn.prepareStatement(updateSQL)) {

            // read the file
            File file = new File("/home/hardik/Desktop/Test.docx");
            FileInputStream input = new FileInputStream(file);
            System.out.println(file.length());

            // set parameters
            pstmt.setBinaryStream(1, input);
            pstmt.setInt(2, candidateId);

            // store the resume file in database
            System.out.println("Reading file " + file.getAbsolutePath());

            pstmt.executeUpdate();
            System.out.println("Store file in the database.");

        } catch (SQLException | FileNotFoundException e) {
            System.out.println(e.getMessage());
        }
    }

}

public class MySQLJDBCUtil {

    public static Connection getConnection() throws SQLException {
        Connection conn = null;

            // assign db parameters
            String url ="jdbc:mysql://localhost:3306/scope1" ;
            String user ="root" ;
            String password = "root";

            // create a connection to the database
            conn = DriverManager.getConnection(url, user, password);

        return conn;
    }

} 
```

# delphi - 使用 delphi 通过 Gmail 发送短信

> ID：12827308
> 
> 赞同：5
> 
> 时间：2012-10-10T19:54:30.887
> 
> 标签：delphi, sms, gmail

如您所知，我们可以通过 google chat 向任何手机发送短信，那么我们可以在 delphi 程序中使用此功能吗？我们可以用delphi发送短信吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T20:15:22.967

你过去可以，但谷歌花了太多钱让第三方搭载他们的服务。所以你不能再使用 API 来做到这一点：[http ://news.cnet.com/8301-17939_109-10193024-2.html](http://news.cnet.com/8301-17939_109-10193024-2.html)

# php - 从数组中获取元素

> ID：12827312
> 
> 赞同：1
> 
> 时间：2012-10-10T19:54:40.853
> 
> 标签：php, twitter, twitter-oauth

首先抱歉，如果我没有写正确的标题，因为我真的无法解释得那么好。

好的，所以我正在制作一个 twitter 应用程序，我使用了这段代码

```
if(!empty($_SESSION['username'])){
    $twitteroauth = new TwitterOAuth('MY PRIVATE CODE', 'MY PRIVATE CODE',     $_SESSION['oauth_token'], $_SESSION['oauth_secret']);
}

$home_timeline = $twitteroauth->get('/statuses/user_timeline');
print_r($home_timeline); 
```

我将它与我的 twitter 帐户相关联，这不是完整代码，只是其中的一部分。所以这回声了。

> Array ( [0] => stdClass Object ( [created_at] => Wed Oct 10 19:27:42 +0000 2012 [id] => 256113796215603202 [id_str] => 256113796215603202 [text] => 在我的推特上测试一些东西应用程序。 ） ）

它在数组中打印了一些其他的东西，但我把它剪掉了。如何从数组文本中获取文本的值？它在哪里说[文本]我想拥有它的价值？

我花了至少 30 分钟搜索，但我找不到答案。如果它是 php 已经制作的简单函数，那么你能告诉我。如果是一长串代码，你能告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T19:56:21.573

首先将 转换`object`为一个数组，例如，

```
 $array = (array) $home_timeline[0]; 
```

然后使用 . 访问您的数组键[`array_keys`](http://php.net/manual/en/function.array-keys.php)。

```
 $keys = array_keys($array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T19:56:52.277

如果你有多个状态，`$home_timeline`你会做这样的事情：

```
foreach($home_timeline as $status) {
    $hereBeYourText = $status->text;
} 
```

或者您还有其他想要实现的目标吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:26:41.280

我认为您会因为您有一个包含对象的数组而感到困惑。当您访问数组 [0] 时，您现在正在与一个对象交互。

print_r 向您显示 [text] 不是数组中的索引，因此：

数组['text'] 不存在。[文本] 是 stdObject 的一个属性。

所以要获取文本，它只是 $yourArray[0]->text。

注意：如果您将 print_r 或 var_dumps 放在 <pre> </pre> 标记之间，那么它们看起来会更好，并且不会令人困惑

# oop - 如何在 Scala 中实现类型安全的回调系统？

> ID：12827316
> 
> 赞同：1
> 
> 时间：2012-10-10T19:54:48.960
> 
> 标签：oop, scala, callback

我有一个通过套接字连接的客户端-服务器应用程序。我的 MessageHandler 类负责处理传入和传出消息。我传递了填充请求和回调所需的参数，我希望在收到响应后调用它们。我将回调存储在具有唯一请求标识符的哈希映射中。当收到响应时，我从哈希映射中获取回调，调用它并将响应作为参数传递。这是代码

```
class MessageHanlder {
  val callbacks = new HashMap[String, (AnyRef) => Unit]

  def sendAuthRequest(login: String, password: String, callback: Option[(AnyRef) => Unit]) {
    val requestId = generateRequestId()
    // create a packet with requestId, login and password
    // send the packet
    if(callback.isDefined) callbacks += ((requestId, callback.get))
  }

  private def generateRequestId() = // returns random string

  def handleAuthResponse(authResponse: AuthResponse) {
    val requestId = authResponse.requestId
    val callbackOption = callbacks.get(requestId)
    if(callbackOption.isDefined) callbackOption.get(authResponse)
  }

  def sendServerInfoRequest(callback: Option[(AnyRef) => Unit]) {
    val requestId = generateRequestId()
    // create a packet with requestId
    // send the packet
    if(callback.isDefined) callbacks += ((requestId, callback.get))
  }

  def handleServerInfoResponse(serverInfoResponse: ServerInfoResponse) {
    val requestId = serverInfoResponse.requestId
    val callbackOption = callbacks.get(requestId)
    if(callbackOption.isDefined) callbackOption.get(serverInfoResponse)
  } 
```

我的问题是回调的参数类型。它可以是 ServerInfoResponse 或 AuthResponse 或任何其他响应类型。每个响应都有自己的一组字段，我想从回调中访问这些字段。要将回调保存到 hashmap 中，我必须将参数类型概括为 AnyRef。所以在回调中我必须将 AnyRef 转换为这样的具体类型

```
val serverInfoCallback = (response: AnyRef) => {
  val serverInfoResponse = response.asInstanceOf[ServerInfoResponse] // explicit cast
  val name = serverInfoResponse.name
  val numberOfCores = serverInfoResponse.numberOfCores
  // so on
} 
```

有什么办法可以避免铸造？还是有更正确的方法来实现回调系统？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T21:14:51.490

如果响应类型不是静态已知的，您可以制作一个密封的特征 Response 并让其他类型扩展它。

然后，您可以使用模式匹配和一些编译器保证来检查所有情况。如果您不能使这些类型扩展一种密封类型，则无论如何都可以使用模式匹配，但编译器不会帮助您。

如果响应类型是静态已知的，您能否在问题中明确类型关系？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T14:22:50.863

我发现您的问题很有趣，并尝试使用令人难以置信的[无形](https://github.com/milessabin/shapeless)库找到类型安全的解决方案。开始了：

### 基本

```
/* Responses get send to the callbacks */
abstract class Response

/* Callback ids identify callbacks and also specify the type of response
 * a corresponding callback accepts.
 */
abstract class CallbackId[T <: Response] 
```

### 隐式确保类型安全

```
/* Shapeless magic that ensures a type-safe mapping from identifiers to
 * callbacks. Consider an implicit of type CME[CallbackId[R], R => Unit]
 * as the evidence that "an id promising to identify a callback that
 * accepts a response R actually maps to such a function."
 */
class CME[-K, V] /* CallbackMapEntry */

implicit val acceptAppleResponse =
  new CME[CallbackId[AppleResponse], AppleResponse => Unit]

implicit val acceptPearResponse =
  new CME[CallbackId[PearResponse], PearResponse => Unit]

implicit val acceptAnyResponse =
  new CME[CallbackId[Response], Response => Unit] 
```

### 回应

```
/* Define some responses */
case class AppleResponse() extends Response
case class PearResponse() extends Response
case class PruneResponse() extends Response 
```

### 回调

```
/* Define some callbacks */

val appleResponseCallback1 = (r: AppleResponse) => {
  println("[appleResponseCallback1]")
}

val appleResponseCallback2 = (r: AppleResponse) => {
  println("[appleResponseCallback1]")
}

val pearResponseCallback = (r: PearResponse) => {
  println("[pearResponseCallback]")
}

val anyResponseCallback = (r: Response) => {
  println("[anyResponseCallback] r is a " + r.getClass.getSimpleName)
  r match {
    case appleR: AppleResponse => // ...
    case pearR: PearResponse => // ...
    case pruneR: PruneResponse => // ...
  }
} 
```

### 身份标识

```
/* A couple of identifiers */
object appleCbId1 extends CallbackId[AppleResponse]
object appleCbId2 extends CallbackId[AppleResponse]
object pearCbId1 extends CallbackId[PearResponse]
object pearCbId2 extends CallbackId[PearResponse]
object someCbId extends CallbackId[Response] 
```

### 类型安全的回调列表

```
/* Init list of callbacks */
val callbacks = HMap[CME](
  appleCbId1 -> appleResponseCallback1,
  appleCbId2 -> appleResponseCallback2,
  pearCbId1 -> pearResponseCallback,
  pearCbId2 -> pearResponseCallback,
  someCbId -> anyResponseCallback
) 
```

### 第一个用例

```
val appleCb = callbacks.get(appleCbId1).get
val someCb = callbacks.get(someCbId).get

appleCb(AppleResponse()) /* Fine */
someCb(AppleResponse())  /* Fine */
someCb(PearResponse())   /* Fine */
// appleCb(PruneResponse()) /* Rejected by the compiler */ 
```

### 介绍请求

```
abstract class Request[R <: Response] {
  def id: CallbackId[R]
}

case class AppleRequest(id: CallbackId[AppleResponse])
  extends Request[AppleResponse]

case class PearRequest(id: CallbackId[PearResponse])
  extends Request[PearResponse]

case class RandomRequest(id: CallbackId[Response])
  extends Request[Response] 
```

### 第二个用例

```
def handleAppleRequest(r: AppleRequest) {
  // Do something with the request

  // Phone home
  val cb = callbacks.get(r.id).get
  cb(AppleResponse()) /* Fine */
  // cb(PearResponse())  /* Rejected by the compiler */
}

handleAppleRequest(AppleRequest(appleCbId1)) 
```

由于该解决方案是类型安全的（或至少尝试是），因此在不太“静态”的环境中初始化回调列表可能会更复杂，例如，如果回调是由（弱类型）工厂或由反射。

# objective-c - 强制对象在 ARC 下释放

> ID：12827319
> 
> 赞同：13
> 
> 时间：2012-10-10T19:55:00.037
> 
> 标签：objective-c, cocoa-touch, memory-management, automatic-ref-counting

我正在开发一个 iPad 照片拼贴应用程序，它可能`UIImageView`一次在屏幕上绘制数百个 s。

有一个按钮可以让用户“重新创建”，假设在所有照片上运行一个`for`循环`[photo removeFromSuperview]`，然后按该顺序初始化一个新批次。

我正在使用 ARC，我的控制台告诉我，直到绘制下一批之后才会调用我`Photo`的`dealloc`方法，这意味着我遇到了内存问题，即使我正在尝试删除第一组在添加下一组之前。

有没有办法 1) 等到所有照片都被正确地释放或 2) 强制所有照片在 ARC 下立即释放？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-10T21:18:56.553

您可能在没有意识到的情况下将图像视图放入自动释放池中。您可以通过将您自己的自动释放池包装在您的 for 循环周围来解决此问题。

例如，我做了一个非常简单的测试项目，在我的顶层视图下有一个图像视图和一个按钮。当我点击按钮时，它会删除图像视图并创建一个新视图。它通过遍历顶层视图的子视图来删除图像视图。这是代码：

```
@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    [self initImageView];
}

- (IBAction)redoWasTapped:(id)sender {
    [self destroyImageView];
    [self initImageView];
}

- (void)destroyImageView {
    for (UIView *subview in self.view.subviews) {
        if ([subview isKindOfClass:[UIImageView class]]) {
            [subview removeFromSuperview];
        }
    }
}

- (void)initImageView {
    UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"picture.jpg"]];
    imageView.frame = CGRectInset(self.view.bounds, 100, 100);
    [self.view addSubview:imageView];
}

@end 
```

当我在启用“记录引用计数”的分配工具下运行此程序时，我看到每个删除的图像视图在`destroyImageView`. 相反，它稍后在运行循环调用时被释放`-[NSAutoreleasePool release]`。

然后我改为`destroyImageView`管理自己的自动释放池：

```
- (void)destroyImageView {
    @autoreleasepool {
        for (UIView *subview in self.view.subviews) {
            if ([subview isKindOfClass:[UIImageView class]]) {
                [subview removeFromSuperview];
            }
        }
    }
} 
```

当我在 Instruments 下再次运行它时，我看到每个删除的图像视图都在块`destroyImageView`末尾的 ,期间被释放。`@autoreleasepool`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-10T19:57:32.453

ARC`dealloc`是没有强引用的任何对象。所以对于`dealloc`某事，只需将所有指向它的变量设置为`nil`并确保该对象不涉及任何循环引用。

# reporting-services - 尝试在报表生成器中重命名过滤器

> ID：12827325
> 
> 赞同：0
> 
> 时间：2012-10-10T19:55:22.500
> 
> 标签：reporting-services, reportingservices-2005

我正在使用 SSRS 2K5，我有一些问题无法通过 Google 回答，与 Report Builder 相关。我已经建立了我的报告，并且正在使用模型来生成报告。据我了解，当基础数据源是模型时，报表生成器不支持参数，因此我设置了一个过滤器，在生成报表之前提示用户填写没有问题。这是我的两个问题：

*   有问题的过滤器是一个日期字段。如果我将过滤器设置为 BETWEEN（日期从 到 ），则在运行报告之前没有选项提示用户输入值。有没有办法解决这个问题？
*   如果我能够通过将日期字段两次放置在过滤器区域中来获得上述所需的日期范围效果：一次条件为“之前”，另一个条件为“之后”。这里的问题是过滤器如何显示，即日期和日期 1。理想情况下，我希望将它们分别显示为开始日期和结束日期。有没有办法做到这一点？

如果我需要澄清任何事情或需要更多信息，请告诉我。

# android - Android：如何滚动扩展适配器视图或视图组

> ID：12827328
> 
> 赞同：3
> 
> 时间：2012-10-10T19:55:22.610
> 
> 标签：android, listview, adapter, viewgroup, scroller

跟进这个[扩展的 AdapterView](https://stackoverflow.com/questions/2563897/extending-adapterview)

我知道这可以通过这个[SO 帖子来实现](https://stackoverflow.com/questions/8796960/how-to-use-scroller-in-viewgroup-android)

请注意：试图了解 listview 和 Gallery 如何滚动和重用视图。

如何滚动自定义 ViewGroup/AdapterView？

在浏览 listview 的源代码时，发现覆盖 onTouch() 和 dispatchTouchEvent() 是可能的。（推断的 FlingRunnable 使用[Scroller](http://developer.android.com/reference/android/widget/Scroller.html)类不断更新常量）

但是，用滚动偏移量重绘整个视图的确切 API 方法是什么？

# firefox-addon - 选项卡组 - 任何 API

> ID：12827329
> 
> 赞同：2
> 
> 时间：2012-10-10T19:55:36.673
> 
> 标签：firefox-addon, firefox-addon-sdk

有什么方法可以使用高级 API 来检测选项卡是否在活动全景组中？[`tabs`](https://stackoverflow.com/)至少在模块中似乎没有提到选项卡所属的选项卡组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T06:21:15.883

目前没有计划提供选项卡组 api - Firefox 中的“全景”功能尚未证明非常流行，因此与专注于其他功能相比，可能没有太多好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-21T00:44:02.207

其实是有办法的。

我不知道如何使用 SDK 获取 XUL 选项卡，但我知道这是可能的，因为我记得有人发布过这样做的问题。也许@canuckistani 你可以帮助我们获得 xul `tab`。

无论如何，一旦你有了它，`tab`你就可以访问它的属性`_tabViewTabItem`。从这里你可以做任何你想做的事。`tab._tabViewTabItem.parent.id`就像通过去或更改组 id找出选项卡的组 id。

这是一些代码，前两行是非sdk代码。

```
var tab = gBrowser.tabContainer.childNodes[10]; //non sdk code
gBrowser.selectedTab = tab; //non sdk code
console.log(tab._tabViewTabItem.parent.id) //works both in sdk and non-sdk 
```

注意：固定选项卡没有该`_tabViewTabItem`属性。所以这就是你如何判断它是否被固定。

```
var tabs = gBrowser.tabContainer.childNodes;
for (var i=0; i<tabs.length; i++) {
  try {
   console.log(tabs[i]._tabViewTabItem.parent.id);
  } catch(ex) {
    console.warn('tab ' + i + ' ex:', ex);
    console.log('its probably pinned')
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-21T06:57:14.357

[Tab Groups](https://addons.mozilla.org/en-US/firefox/addon/tab-groups-panorama/)扩展使用[SessionStore](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISessionStore)存储它的数据。

```
var tabData = JSON.parse(SessionStore.getTabValue(tab,"tabview-tab"));
console.log(tabData.groupID); // 3 
```

有关组本身的数据存储在 browser.xul 对象（即 ownerGlobal）中。特定于每个组的数据存储为“tabview-group”，其他数据存储为“tabview-groups”。

```
var groupsData = JSON.parse(SessionStore.getWindowValue(tab.ownerGlobal, 'tabview-groups'));
console.log(groupsData); // Object { nextID: 4,
                                    activeGroupId: 3,
                                    activeGroupName: "Third Group",
                                    totalNumber: 2 }

var groupData = JSON.parse(SessionStore.getWindowValue(tab.ownerGlobal, 'tabview-group'));
console.log(tabData[3].title); // Third Group 
```

# java - Java - = 运算符不适用于`@Controller` 中的类

> ID：12827336
> 
> 赞同：0
> 
> 时间：2012-10-10T19:55:58.997
> 
> 标签：java, spring

我有一个`Message`方法`@ModelAttribute`中的类`@Controller`。当我`message = some_message_object`在方法内部执行时，它不会引发任何错误，但值`message`不会改变。相反，我必须这样做：

```
if(some_message_object != null) {
    message.setId(some_message_object.getId()) ;
    message.setFrom(some_message_object.getFrom()) ;
    message.setTo(some_message_object.getTo()) ;
} 
```

在此之后，`message`与 相同`some_message_object`。如果我使用`=`错误，请帮助我。

**编辑**

这是原始代码：

```
@RequestMapping("/readmessage")
public String readMessage(@ModelAttribute("message") Message message {
    some_message_object = someService.getMessage() ;
    message = some_message_object ;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T19:59:27.077

Java不通过引用传递方法参数：修改方法的参数只修改局部变量，*不*修改调用方法中的变量。但是，您可以通过调用对象的方法来修改对象的内容，就像您所做的那样。

假设你有

```
@Controller
public void method(@ModelAttribute Message message) {
    message = some_message_object;
} 
```

message 可以看成是方法的局部变量，修改也是局部的。您只能在参数上调用方法，而不能直接修改它们（好吧，您可以，但是调用者看不到该修改）。

* * *

如果您有多个属性要从一个对象复制到另一个对象，您可以在消息中添加更新方法：

```
public void update(Message message) {
    this.field1 = message.field1;
    this.field2 = message.field2;
    // ...
} 
```

或使用 bean 映射器，例如[Dozer](http://dozer.sourceforge.net/)，它使用反射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T15:12:16.320

在您的情况下，最好的方法是像这样设置属性：

```
@RequestMapping("/readmessage")
public String readMessage(@ModelAttribute("message") Message message,
  ModelMap map) {
    some_message_object = someService.getMessage() ;
    map.addAttribute("message", some_message_object) ;
} 
```

这样，您就不必担心`message`。它既干净又容易:)

# linux - Linux - 将命令的 STDOUT 发送到 RSS 源

> ID：12827343
> 
> 赞同：2
> 
> 时间：2012-10-10T19:56:26.393
> 
> 标签：linux, rss, stdout

我希望使用个人 RSS 提要进行系统报告，所以我想知道是否可以创建一个脚本，将其 1 美元发送到 RSS 提要，ala `self_test_command > rss_report.sh`。我目前也没有设置 RSS 提要，那么设置从 Linux 机器运行的 RSS 提要最简单的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T10:53:27.097

还有另一个使用[xmlstarlet](http://xmlstar.sourceforge.net/)的解决方案：

创建一个初始 rss 提要文件 feed.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
  <channel>
    <title>My RSS Feed</title>
    <description>This is my RSS Feed</description>
  </channel>
</rss> 
```

创建一个使用[xmlstarlet](http://xmlstar.sourceforge.net/)添加项目的 shell 脚本：

```
#!/bin/sh

TITLE="My RSS entry"
LINK="http://example.com/entry4711"
DATE="`date`"
DESC="Good news"
GUID="http://example.com/entry4711" 

xmlstarlet ed -L   -a "//channel" -t elem -n item -v ""  \
     -s "//item[1]" -t elem -n title -v "$TITLE" \
     -s "//item[1]" -t elem -n link -v "$LINK" \
     -s "//item[1]" -t elem -n pubDate -v "$DATE" \
     -s "//item[1]" -t elem -n description -v "$DESC" \
     -s "//item[1]" -t elem -n guid -v "$GUID" \
     -d "//item[position()>10]"  feed.xml ; 
```

要有一个通用的解决方案，当然更喜欢从命令行传递参数。

-d 命令确保提要不会增长 inifinet 但最多有 10 个项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T20:21:13.123

我有一个适合你的解决方案，在`command line`. 在后台使用 Perl [Template::Toolkit](http://www.template-toolkit.org/)模块（现在不需要学习 Perl）：

首先安装包`perl-template-toolkit`，然后创建模板文件`rss.tpl`：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>[% title %]</title>
    <description>[% desc %]</description>
  </channel>
  <!-- rest of the RSS -->
</rss> 
```

并运行命令：

```
tpage --define title=foobar --define desc=description --interpolate rss.tpl 
```

输出是：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>foobar</title>
    <description>description</description>
  </channel>
  <!-- rest of the RSS -->
</rss> 
```

您将在[此处找到要修改的完整模板](http://wiki.bash-hackers.org/syntax/pattern)

# python - 用于快速多维数据查找的数据模型和数据存储技术

> ID：12827349
> 
> 赞同：0
> 
> 时间：2012-10-10T19:56:49.057
> 
> 标签：python, hashmap, key-value, datastore, datamodel

我有一个`parent`hashmap 数据结构，它有一个字符串作为键，hashmap 数据结构作为子项（猜测`child1`，，`child2`...，`childN`）。每个孩子都是一个简单的键值映射，有一个数字作为键，一个字符串作为值。在伪代码中：

```
parent['key1'] = child1;    // child1 is a hash map data structure
child1[0] = 'foo';
child[1] = 'bar';
... 
```

我需要将此数据结构实现为数据库系统中的快速查找表。让我们以 Python 作为参考语言。

解决方案要求：

1.  尽快检索孩子的 hasmaps！
2.  哈希的`parent`估计总重量最多为 500 MB

用例如下：

1.  客户端 Python 程序在数据存储中查询特定的子哈希
2.  数据存储返回子哈希
3.  Python 程序将整个散列传递给特定函数，从散列中提取特定值（它已经知道要使用哪个键）并将其传递给第二个函数

您会推荐内存中的键值数据存储（例如 Redis）还是更经典的“关系”数据库解决方案？您建议我使用哪种数据模型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:02:01.337

绝对与[Redis](http://redis.io/)一起使用。它不仅速度非常快，而且可以*准确*处理您需要的结构：[http ://redis.io/commands#hash](http://redis.io/commands#hash)

在您的情况下，您可以避免读取整个“子哈希”，因为客户端“从哈希中提取特定值（它已经知道要使用哪个键）”

```
redis> HMSET myhash field1 "Hello" field2 "World"
OK
redis> HGET myhash field1
"Hello"
redis> HGET myhash field2
"World" 
```

或者，如果您确实想要整个哈希：

```
redis> HGETALL myhash
1) "field1"
2) "Hello"
3) "field2"
4) "World"
redis> 
```

当然，使用[客户端库](http://redis.io/clients)可以在一个可行的对象中提供结果，在你的例子中，一个 Python 字典。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T00:04:58.740

[使用redis-py 的](https://github.com/andymccurdy/redis-py)示例代码，假设您已经安装了 Redis（最好[是hiredis](http://pypi.python.org/pypi/hiredis)），将每个父级保存为哈希字段，将子级保存为序列化字符串，并在客户端处理序列化和反序列化：

**JSON版本：**

```
## JSON version
import json 
# you could use pickle instead, 
# just replace json.dumps/json.loads with pickle/unpickle

import redis

# set up the redis client
r = redis.StrictRedis(host = '', port = 6379, db = 0)

# sample parent dicts
parent0 = {'child0': {0:'a', 1:'b', 2:'c',}, 'child1':{5:'e', 6:'f', 7:'g'}}
parent1 = {'child0': {0:'h', 1:'i', 2:'j',}, 'child1':{5:'k', 6:'l', 7:'m'}}

# save the parents as hashfields, with the children as serialized strings
# bear in mind that JSON will convert the int keys to strings in the dumps() process
r.hmset('parent0', {key: json.dumps(parent0[key]) for key in parent0})
r.hmset('parent1', {key: json.dumps(parent0[key]) for key in parent1})

# Get a child dict from a parent
# say child1 of parent0
childstring = r.hget('parent0', 'child1') 
childdict = json.loads(childstring) 
# this could have been done in a single line... 

# if you want to convert the keys back to ints:
for key in childdict.keys():
    childdict[int(key)] = childdict[key]
    del childdict[key]

print childdict 
```

**泡菜版：**

```
## pickle version
# For pickle, you need a file-like object. 
# StringIO is the native python one, whie cStringIO 
# is the c implementation of the same.
# cStringIO is faster
# see http://docs.python.org/library/stringio.html and
# http://www.doughellmann.com/PyMOTW/StringIO/ for more information
import pickle
# Find the best implementation available on this platform
try:
    from cStringIO import StringIO
except:
    from StringIO import StringIO

import redis

# set up the redis client
r = redis.StrictRedis(host = '', port = 6379, db = 0)

# sample parent dicts
parent0 = {'child0': {0:'a', 1:'b', 2:'c',}, 'child1':{5:'e', 6:'f', 7:'g'}}
parent1 = {'child0': {0:'h', 1:'i', 2:'j',}, 'child1':{5:'k', 6:'l', 7:'m'}}

# define a class with a reusable StringIO object
class Pickler(object):
    """Simple helper class to use pickle with a reusable string buffer object"""
    def __init__(self):
        self.tmpstr = StringIO()

    def __del__(self):
        # close the StringIO buffer and delete it
        self.tmpstr.close()
        del self.tmpstr

    def dump(self, obj):
        """Pickle an object and return the pickled string"""
        # empty current buffer
        self.tmpstr.seek(0,0)
        self.tmpstr.truncate(0)
        # pickle obj into the buffer
        pickle.dump(obj, self.tmpstr)
        # move the buffer pointer to the start
        self.tmpstr.seek(0,0)
        # return the pickled buffer as a string
        return self.tmpstr.read()

    def load(self, obj):
        """load a pickled object string and return the object"""
        # empty the current buffer
        self.tmpstr.seek(0,0)
        self.tmpstr.truncate(0)
        # load the pickled obj string into the buffer
        self.tmpstr.write(obj)
        # move the buffer pointer to start
        self.tmpstr.seek(0,0)
        # load the pickled buffer into an object
        return pickle.load(self.tmpstr)

pickler = Pickler()

# save the parents as hashfields, with the children as pickled strings, 
# pickled using our helper class
r.hmset('parent0', {key: pickler.dump(parent0[key]) for key in parent0})
r.hmset('parent1', {key: pickler.dump(parent1[key]) for key in parent1})

# Get a child dict from a parent
# say child1 of parent0
childstring = r.hget('parent0', 'child1') 
# this could be done in a single line... 
childdict = pickler.load(childstring) 

# we don't need to do any str to int conversion on the keys.

print childdict 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:30:53.790

在基于[Javier](https://stackoverflow.com/users/11649/javier)提示进行快速搜索后，我想出了这个解决方案：我可以`parent`在 Redis 中实现单个哈希，其中值字段将是子哈希的字符串表示形式。通过这种方式，我可以快速阅读它们并从 Python 程序中评估它们。

举个例子，我的 Redis 数据结构类似于：

```
//write a hash with N key-value pairs: each value is an M key-value pairs hash
redis> HMSET parent_key1 child_hash "c1k1:c1v1, c1k2:c1v2, [...], c1kM:c1vM"
  OK
redis> HMSET parent_key2 child_hash "c2k1:c2v1, c2k2:c2v2, [...], c2kM:c2vM"
  OK
[...]
redis> HMSET parent_keyN child_hash "cNk1:cNv1, cNk2:cNv2, [...], cNkM:cNvM"
  OK

//read data
redis> HGET parent_key1 child_hash
  "c1k1:c1v1, c1k2:c1v2, [...], c1kM:c1vM" 
```

然后我的 Python 代码只需要使用 Redis 绑定来查询所需的子哈希并返回它们的实际字符串表示；剩下要做的就是将字符串表示转换为相应的字典，因此可以方便地查找。

示例代码（如[this answer](https://stackoverflow.com/a/4127355/152561)中所建议）：

```
>>> import ast
>>> # Redis query:
>>> #   1\. Setup Redis bindings
>>> #   2\. Ask for value at key: parent_key1
>>> #   3\. Store the value to 's' string
>>> dictionary = ast.literal_eval('{' + s + '}')
>>> d
{c1k1:c1v1, c1k2:c1v2, [...], c1kM:c1vM} 
```

希望我没有遗漏任何东西！

# android - MediaPlayer - 使用铃声音量而不是媒体音量

> ID：12827352
> 
> 赞同：5
> 
> 时间：2012-10-10T19:57:11.767
> 
> 标签：android, android-mediaplayer

如何从铃声设置音量级别而不是 MediaPlayer 上的媒体音量级别？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T20:14:55.570

用于[`setAudioStreamType(int)`](http://developer.android.com/reference/android/media/MediaPlayer.html#setAudioStreamType(int))将媒体类型设置为type `STREAM_RING`，那么它应该使用铃声音量而不是默认的`STREAM_MUSIC`。

请注意，您必须在准备媒体之前执行此操作，因此您必须手动准备它`setDataSource`而不是使用`MediaPlayer.create()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-26T10:04:20.190

由于 Lollipop，`setAudioAttributes()`是要使用过的`setAudioStreamType(int)`。

我错过的一个问题是 setAudioAttributes 如果`MediaPlayer`创建为`MediaPlayer.create()`

请参考这个答案：[https ://stackoverflow.com/a/51008956/10045546](https://stackoverflow.com/a/51008956/10045546)

# java - 在java中通过其url检索单个图像

> ID：12827356
> 
> 赞同：1
> 
> 时间：2012-10-10T19:57:24.187
> 
> 标签：java, image, swing, image-processing, binary

我有一个问题，我希望你能帮助我。我将不胜感激任何人的帮助。问题如下。

我有一台具有 http 服务的相机，我正在使用 http 与相机通信。所以问题是我发送了 http 请求并且我返回了一个 http 响应，其中我有一个二进制 jpeg 数据。但我不知道如何将该数据转换为图片。

所以我的问题是如何用java将二进制数据转换成图片？

这是一个例子

http请求：

```
GET (url to picture) 
```

http响应：

```
binary jpeg data 
```

我感谢你们所有人的帮助。

```
URL url = new URL("http://10.10.1.154" + GETIMAGESCR());
        BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
        String inputLine;
       // while ((inputLine = in.readLine()) != null){
                // inputLine = in.readLine();
                 File file = new File("D:\\alphas\\proba.bin");
                 boolean postoi = file.createNewFile();
                 FileWriter fstream = new FileWriter("D:\\alphas\\proba.bin");
                 BufferedWriter out = new BufferedWriter(fstream);
                 while ((inputLine = in.readLine()) != null){
                 out.write(in.readLine());
                // out.close();
               //  System.out.println("File created successfully.");
            System.out.println(inputLine);
            }
            System.out.println("File created successfully.");
            out.close();
            in.close(); 
```

使用此代码，我得到二进制 JPEG 数据，并且我设法将数据保存在文件中。那么现在的问题是如何将这些数据转换成图片，或者如何创建图片？顺便说一句，我不需要保存我得到的文件，如果你有办法直接创建图片，那将是最好的方法

在java中通过其url检索单个图像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T19:59:11.777

您只需要写入图像的字节数据作为响应并设置正确的内容类型，它将从 servlet 提供图像

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T19:58:52.807

```
try {
    URL url = new URL("http://site.com/image.jpeg");

    java.awt.Image image = java.awt.Toolkit.getDefaultToolkit().createImage(url);
} catch (MalformedURLException e) {
} catch (IOException e) {
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T20:40:45.857

我错过了什么还是你只是在寻找这个：

```
new ImageIcon(new URL("http://some.link.to/your/image.jpg")); 
```

如果您需要从 URL 保存数据，则只需从相应的 InputStream 读取字节并将读取的字节写入 FileOutputStream：

# iphone - 如何在顶部弹出视图控制器？

> ID：12827363
> 
> 赞同：-1
> 
> 时间：2012-10-10T19:58:00.720
> 
> 标签：iphone, ios, model-view-controller, modalviewcontroller

情况：我的应用中有很多视图控制器，它们以导航或模式视图控制器的形式呈现。该应用程序几乎从所有屏幕与服务器进行通信。我想在他/她的凭据过期时向用户显示登录屏幕。我想将登录屏幕作为模式显示在屏幕上当前视图的顶部，并在登录成功后立即将其关闭。我真的不知道我怎么能做到这一点。如果某些视图控制器在屏幕上显示了模态视图，并且登录屏幕也需要以模态形式呈现，我应该从哪里执行此操作。我尝试在 appDelegate 中切换窗口的 rootViewController ，但效果不佳并且还搞砸了很多事情。请给我建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:05:20.783

查看的呈现模态视图`UIViewController`的[`presentViewController:animated:completion:`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/presentViewController%3aanimated%3acompletion%3a)方法（只要您不是为 iOS <5.0 构建的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:30:01.470

我看到了你的问题。在我看来，最好的方法是创建一个简单的类，`LoginHandler.h`并在应用程序的生命周期内保持它。

您不必在应用程序启动时对其进行初始化。您可以实现一个方便的技巧，以便在需要时始终获取此类的相同实例：

```
// @interface
+(id)sharedHandler;

//@implementation
+(id)sharedHandler {
   static id sharedHandler = nil;
   if (sharedHandler == nil) {
      [sharedHandler = [[LoginHandler alloc] init];
   }
   return sharedHandler;
} 
```

现在您只需使用 获取共享实例`[LoginHandler sharedHandler]`，类似于用户`NSUserDefaults`或`UIApplication`。

你可以有一个像

```
-(BOOL)renewLoginFromViewController:(UIViewController*)controller`; 
```

它提供了一个模型视图控制器，如下所示：

```
[controller presentModalViewController:loginScreen]; 
```

如果登录成功则返回`YES`（或者在登录成功之前它不会消失。）

您可以处理此类中的所有登录逻辑。这将是一个很好的*[封装](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/OOP_ObjC/Articles/ooObjectModel.html#//apple_ref/doc/uid/TP40005149-CH5-SW10)*教科书示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:16:55.853

仅在应用程序启动时检查它是一件好事。这样，建议在您的 AppDelegate.m 上的 didFinishLaunchWithOptions 上执行此操作。

你可以这样做：

```
self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
// Override point for customization after application launch.
if (USER_HAS_VALID_CREDENTIALS) {
    self.viewController = [[[RootViewController alloc] initWithNibName:@"RootViewController" bundle:nil] autorelease];
} else {
    self.viewController = [[[LoginViewController alloc] initWithNibName:@"LoginViewController" bundle:nil] autorelease]; // need to get credentials
}
self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible]; 
```

请记住在成功登录后从 LoginViewController 启动 RootViewController。

# php - .htaccess 的无限重定向循环

> ID：12827368
> 
> 赞同：1
> 
> 时间：2012-10-10T19:58:13.233
> 
> 标签：php, .htaccess, zend-framework

我正在使用 Zend Framework（不是完整版，只是一些组件），但我遇到了一个小问题。我没有开发我会提供支持的软件。当我尝试安装时，第一页正在重定向，直到它破坏了我的服务器：`http://localhost/software/manager/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index/index`...

好吧，我查看了所有代码，但无法弄清楚出了什么问题。这是我的代码：

.htaccess

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule !\.(js|ico|txt|gif|jpg|png|css)$ bootstrapClass.php [NC,L]

RewriteCond %{REQUEST_URI} !^/public/
RewriteRule ^(.*)$ public/$1 [L]

php_flag magic_quotes_gpc off
php_flag register_globals off
php_value session.auto_start 0
Options -Indexes 
```

[http://pastebin.com/DTHrWJYn](http://pastebin.com/DTHrWJYn)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:00:56.817

问题出在一线

```
RewriteRule ^(.*)$ public/$1 [L] 
```

网址重写以这种方式工作。url被重写后，再次应用规则。

为避免这种情况，请使用`RewriteCond`，例如文件是否不存在：

```
RewriteCond %{REQUEST_FILENAME} !-f 
```

# mvvm - 如何使用 Caliburn Micro 动态加载外部 MVVM 和非 MVVM 控件

> ID：12827370
> 
> 赞同：0
> 
> 时间：2012-10-10T19:58:20.173
> 
> 标签：mvvm, user-controls, custom-controls, caliburn.micro

我正在从单独的 XAP 文件从 Web 服务器动态加载控件。创建实例后，我想在标签页中显示它们。控件可以是使用 CM 的 MMVM 控件，也可以是非 MVVM 标准控件。

在尝试选项卡之前，我测试了通过使用以下方法在页面上动态显示控件：

```
<ContentControl Name="TestControl" /> 
```

测试控件是 UserControl 类型的属性，通过创建动态加载控件的新实例来设置。现在这给了我一个错误，它找不到视图。如果是非 MVVM 控件，当然没有视图，那么如何加载非 MVVM 控件呢？

我试图使测试控件成为 MVVM 控件，但仍然出现无法加载视图错误。有意义，因为没有创建这样的实例。如果我在视图模型之外创建动态加载视图的实例，我如何“添加”它以便 CM 找到它？

最后但同样重要的是，如何将它绑定到 Silverlight 中的选项卡控件？这个想法是拥有一组用户控件（插件），每个控件都呈现在其单独的标签页中。

谢谢你的帮助。

（我很快就完成了，不使用 MVVM，仍然不确定 MVVM 是否值得所有复杂性）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T22:23:05.607

没有“mvvm 控制”之类的东西。MVVM 只是一种模式而不是控制类型。基本上，在 Caliburn 中，您不需要直接使用 UserControls 或 Views，但如果您选择[ViewModel 第](http://phurst.com/Blogs/WpfPatterns/ViewModel%20First%20Patterm.html)一种方法，Caliburn 框架应该能够为您找到匹配的视图。在您的情况下，由于您正在动态加载 XAP 文件，因此您需要将它们添加到 Caliburn 查找的程序集列表中以查找 View/ViewModel（并将它们绑定在一起），这是通过 IAssemblySource 接口完成的。根据[此处](http://caliburnmicro.codeplex.com/wikipage?title=Customizing%20The%20Bootstrapper)的文档：

> 那么，AssemblySoure.Instance 是什么？这是 Caliburn.Micro 寻找 Views 的地方。您可以在应用程序期间随时向其中添加程序集，以使它们可用于框架，但在 Bootstrapper 中也有一个特殊的地方可以执行此操作。

# regex - Flex RegEx 没有得到匹配？

> ID：12827373
> 
> 赞同：1
> 
> 时间：2012-10-10T19:58:37.617
> 
> 标签：regex, bison, flex-lexer

我已经使用 Flex/Bison 大约 6 个小时了，这是我无法解决的第一个问题：

我有以下文件...

```
 state state1: {
     1-3: 255
     4: 255
 } 
```

...我使用 cat 和 | 将其传递给我的 flex/bison 程序。flex 文件包含这一行：

```
\bstate\b  { return STATE; } 
```

再往下看：

```
.*         { fprintf(stderr, "Lexer error on line %d: \"%s\"\n", linenum, yytext); exit(-1); } 
```

人们应该认为 \bstate\b 应该在文件中匹配，但事实并非如此。相反，我得到以下输出：

```
"exer error on line 1: "state state1: { 
```

这在几个方面很奇怪。首先，Lexer 接缝中的 L 已被替换为 "，但更重要的是，状态没有匹配。为什么？？？

当然 \bstate\b 在 .* 之前，并且它们在正确的部分。

谢谢你的帮助，简

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T05:47:30.127

(F)Lex 不会在输入中搜索匹配项。它尝试*当前输入位置的*所有模式，并选择与最多文本匹配的模式，如果有多个匹配相同数量的文本，则选择最早的模式。下一个 lex 匹配将从前一个结束的地方开始。

`.*`匹配该行的其余部分。`\bstate\b`只会匹配七个字符。所以`.*`会赢。但`\bstate\b`实际上并不匹配，因为这是 lex，而不是 <在此处插入您最喜欢的正则表达式语法> 并且`\b`意味着退格，就像在 C 程序中那样。

字母 L 被引号覆盖的原因可能是您的输入文件是在 Windows 上创建的，并且在行尾有 \r\n。`.*`将匹配一个包括`\r`，这是一个回车。因此，当您 printf 时`"%s"\n`，替换 %s 的字符串中的最后一个字符是回车符，这会导致光标移动到当前行中的第一个位置，直到该时间点为止，其中都有一个 L 。然后 " 打印在 L 的顶部，最后打印换行符，它开始一个新行。

没有与词边界断言等效的 Lex，`\b`但这很少有问题。几乎所有编程语言的词法扫描器都必须处理保留字也将匹配标识符模式的问题；然而，最长匹配规则和首次匹配规则的组合使得这样做很容易。简而言之，*始终将保留字模式放在首位*。例如：

```
do              { return DO; }
double          { return DOUBLE; }
if              { return IF; }
/* ... */
[a-z][a-z0-9]*  { return ID; } 
```

在上面的示例中，您放置的顺序`do`无关紧要`double`，因为`double`更长，但我总是觉得您应该按字母顺序放置保留字以保持整洁。但重要的是 ID 模式放在最后，因为它也匹配所有保留字。

现在考虑对以保留字开头的标识符进行词法分析时会发生什么，例如`dog`. 在这种情况下，DO 模式和 ID 模式都将匹配，但 ID 匹配时间较长，因此它获胜，尽管较晚。

# path - Windows XP（32 位）和 Windows 7（64 位）通用的 Windows SDK 路径

> ID：12827374
> 
> 赞同：0
> 
> 时间：2012-10-10T19:58:45.287
> 
> 标签：path, winapi, program-files

我在我的 Visual Studio 项目中使用来自 Windows SDK 的工具。我需要同时支持 Windows XP（32 位）和 Windows 7（64 位）开发环境。

Windows SDK 安装`Program Files`在两个操作系统下。这就是问题！

我不知道要为路径使用什么环境变量。从像 Visual Studio 这样的 32 位进程，映射到的环境变量`Program Files`是：

*   Windows XP（32 位）：`%ProgramFiles%`
*   Windows 7（64 位）：`%ProgramW6432%`

这些是不同的，那么我如何告诉 Visual Studio 到 Windows SDK 的路径是什么？

我想避免任何特殊配置，例如硬编码路径或添加更多环境变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:12:07.943

我只是将路径指定为`%SystemDrive%\Program Files\Microsoft SDKs\Windows\v7.0`，但我不喜欢它！

# jquery - jQuery megamenu 喜欢

> ID：12827375
> 
> 赞同：-1
> 
> 时间：2012-10-10T19:58:47.447
> 
> 标签：jquery

我有一个导航菜单 UL，没什么特别的..Button1, Button2, Button 3....button 8

我想在 mouseenter div="div2" （隐藏的）只有当鼠标从 Button1 和 Div2 出来（mouseout）时才淡入和淡出。

所以我做了什么

```
$(document).ready(function() {
    $(".dropdown").hide();
    $("#menu li:nth-child(1)").addClass('menu_li1');
    $("#menu li:nth-child(2)").addClass('menu_li2');
    $("#menu li:nth-child(3)").addClass('menu_li3');
    $("#menu li:nth-child(4)").addClass('menu_li4');
    $("#menu li:nth-child(5)").addClass('menu_li5');
    $("#menu li:nth-child(6)").addClass('menu_li6');
    $("#menu li:nth-child(7)").addClass('menu_li7');
    $("#menu li:nth-child(8)").addClass('menu_li8');
    $('.menu_li1').mouseenter(function() {
        if ($('.dropdown').is(':visible')) { //.dropdown is div's class
        } else {
            $('.dropdown').fadeIn();
        }

    });
    jQuery('.dropdown').mouseout(function() {
        if ($('.dropdown').mouseleave()) {
            $('.dropdown').fadeOut();
        }
    });
});​ 
```

firebug 没有给出错误，我只是无法达到我需要的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:17:58.863

我看到你一开始还没有写**mouseout**事件。那么当你去其他地方时，你`menu_li1`会如何期望它**淡出。**

# c# - Visual Studio 2012 中的 Web 项目调试和编码

> ID：12827383
> 
> 赞同：0
> 
> 时间：2012-10-10T19:59:10.120
> 
> 标签：c#, asp.net, visual-studio-2012

我在 Visual Studio 中有一个 Web 项目。

在工作时，我可以在调试模式 (F5) 下启动项目，并设置断点。编辑后面的代码或 asp 控件。当按下 F5 时，这将刷新并显示我的新代码。

在我的家用电脑上我可以编辑，我可以按 F5，但我的更改不会显示。并且调试器将单步执行代码，就像它没有意识到它已经出现了一些新代码一样。

有谁之前经历过这个吗？这不是我第一次看到这个，但我一生都无法弄清楚如何让它刷新......

欢迎任何指点:)

编辑：

这可能与项目类型有关吗？还是web项目的编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T09:39:24.170

我弄清楚了为什么会这样。

我为我的项目选择的项目类型是 ASP.NET WEB Forms Application。这意味着项目将从 DLL 文件编译和运行。

每次进行更改时都重建它是不可能的，所以它没有。

我改变了项目类型并建立了一个网站。这种项目不会编译成 DLL，而是从我编写的文件中即时运行。因此，我可以更改我的文件，按 f5，它会自动重新加载新内容。

# asp.net - 第三级 CascadingDropDown 未将 SelectedValue 传递给 Ajax 调用

> ID：12827388
> 
> 赞同：0
> 
> 时间：2012-10-10T19:59:30.450
> 
> 标签：asp.net, .net, vb.net, cascadingdropdown

我正在尝试使用 ASP.NET **CascadingDropDown**控件来呈现值和用户选择的答案。前两个下拉菜单始终显示用户上次访问页面时选择的答案。我还可以选择新值并保存它们，它们会正确存储在数据库中。问题是下次我来此页面编辑下拉值时，前两个正确显示了用户选择的答案，但第三个没有）。

如何让第三个下拉菜单正确显示？调试时，看起来所选值未传递给服务器上的 GetTaxo 方法。

我正在使用中继器输出包含以下内容的自定义控件：

```
<asp:DropDownList id="cboResponse" DataTextField="lov_label" 
   DataValueField="lov_cd" EnableViewState="True" runat="server" />

<ajaxToolkit:CascadingDropDown ID="CDDL" runat="server" Category="-"
   EnableViewState="True" ServiceMethod="GetTaxo"
   ServicePath="/ajax/SaT.asmx" 
   TargetControlID="cboResponse" PromptValue="-1" PromptText="(Select One)" 
   LoadingText ="Loading..." /> 
```

在代码隐藏中，我设置了类别和**CascadingDropDown**的 SelectedValue ：

```
CDDL.Category = questionId
CDDL.SelectedValue = cboResponse.SelectedValue 
```

呈现页面时，我认为设置了 SelectedValue 没有问题。Category=5149 的下拉列表，但似乎没有将其 SelectedValue 传递给服务器：

```
Sys.Application.add_init(function() {
    $create(AjaxControlToolkit.CascadingDropDownBehavior, {"Category":"4548","ClientStateFieldID":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_CDDL_ClientState","LoadingText":"Loading...","PromptText":"(Select One)","PromptValue":"-1","SelectedValue":"MyAnswer","ServiceMethod":"GetTaxo","ServicePath":"/ajax/SaT.asmx","id":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_CDDL"}, null, null, $get("ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_cboResponse"));
});

document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_valSelectionRequired').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_valSelectionRequired'));
}
Sys.Application.add_init(function() {
    $create(AjaxControlToolkit.CascadingDropDownBehavior, {"Category":"4025","ClientStateFieldID":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_CDDL_ClientState","LoadingText":"Loading...","ParentControlID":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl03_ctl02_cboResponse","PromptText":"(Select One)","PromptValue":"-1","SelectedValue":"MyAnswer2","ServiceMethod":"GetTaxo","ServicePath":"/ajax/SaT.asmx","id":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_CDDL"}, null, null, $get("ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_cboResponse"));
});

document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_valSelectionRequired').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_valSelectionRequired'));
}
Sys.Application.add_init(function() {
    $create(AjaxControlToolkit.CascadingDropDownBehavior, {"Category":"5149","ClientStateFieldID":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl05_ctl02_CDDL_ClientState","LoadingText":"Loading...","ParentControlID":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl04_ctl02_cboResponse","PromptText":"(Select One)","PromptValue":"-1","SelectedValue":"MyAnswer3","ServiceMethod":"GetTaxo","ServicePath":"/ajax/SaT.asmx","id":"ucInvEdit_ucQuestionRepeater_rptQuestions_ctl05_ctl02_CDDL"}, null, null, $get("ucInvEdit_ucQuestionRepeater_rptQuestions_ctl05_ctl02_cboResponse"));
});

document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl05_ctl02_valSelectionRequired').dispose = function() {
    Array.remove(Page_Validators, document.getElementById('ucInvEdit_ucQuestionRepeater_rptQuestions_ctl05_ctl02_valSelectionRequired'));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:18:22.193

我刚刚结束了使用 ContextKey 属性将答案传递给服务器。它重复了 knownCategoryValue 的目的，但是这个控件很脆弱，我需要完成它，所以我最终使用 contextKey 来选择正确的答案。

# mongodb - MongoDB 可以成为一致的事件存储吗？

> ID：12827389
> 
> 赞同：3
> 
> 时间：2012-10-10T19:59:35.750
> 
> 标签：mongodb, nosql, event-sourcing, consistency

在事件存储中存储事件时，存储事件的顺序非常重要，尤其是在稍后投影事件以恢复实体当前状态时。

考虑到它的速度和灵活的模式（并且经常被推荐），MongoDB 似乎是持久化事件存储的一个不错的选择，但是 MongoDB 中没有事务之类的东西，这意味着无法保证正确的事件顺序。

鉴于这一事实，如果您正在寻找一致的事件存储，您应该不使用 MongoDB，而是坚持使用传统的 RDMS，还是有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:50:23.230

我不熟悉您使用的“事件存储”一词，但我可以解决您问题中的一些问题。我相信将 MongoDB 用于你想要的东西可能是合理的，但要小心一点。

在 MongoDB 中，每个文档都有一个`_id`默认`ObjectId`格式的字段，该字段由服务器标识符、时间戳和序列计数器组成。因此，您可以对该字段进行排序，并且您将按照创建顺序获取对象，前提是这些`ObjectId`s 都是在同一台机器上创建的。

大多数 MongoDB 客户端驱动程序`_id`在向数据库发送插入命令之前在本地创建字段。因此，如果您有多个客户端连接到数据库，排序方式`_id`不会做您想要的，因为它将首先按服务器哈希排序，这不是您想要的。

但是，如果您可以说服您的 MongoDB 客户端驱动程序不包含`_id`在插入命令中，那么服务器将为每个文档生成 ObjectId，并且它们将具有您想要的属性。这样做将取决于您使用的语言，因为每种语言都有自己的客户端驱动程序。仔细阅读驱动程序文档或深入研究它们的源代码——它们都是开源的。大多数驱动程序还包括一种向服务器发送原始命令的方法。所以如果你`insert`手动构建一个命令，这肯定会让你做你想做的事。

如果您的系统如此庞大以至于单个数据库服务器无法处理您的所有写入流量，这将崩溃。需要每秒写入数千条记录的 MongoDB 解决方案是设置一个分片数据库。在这种情况下，ObjectId 将再次由不同的机器创建，并且不会具有您想要的良好排序属性。如果您担心超出单个服务器的写入容量，您应该寻找另一种提供分布式序列号的技术。

# ruby - 在 ruby 中清理用户输入

> ID：12827391
> 
> 赞同：0
> 
> 时间：2012-10-10T19:59:50.513
> 
> 标签：ruby, input

在我慢慢编写日志记录脚本时，我遇到了一些障碍。我已经完成了大部分程序的工作，但现在我只是添加了一些物质享受，例如对你可以输入的内容的一些限制等等。

```
def HitsPerMinute()

print "Is there a specific hour you would like to see: "
STDOUT.flush
mhour = spectime = gets.strip

 #mhour = mhour.to_s
 if mhour == '' or mhour == '\n' or (mhour =~ /[a-z]|[A-Z].*/)
   puts "Please enter an hour you would like to see."
   HitsPerMinute()
 #else
   #mhour = mhour.to_i
  end
    mstart = 00
    mend = 59

    mstart.upto(mend) { |x|
     moment = "#{rightnow}:#{zeroadder(mhour)}:#{zeroadder(x)}".strip
     print "Server hits at '#{moment}: "
     puts `cat /home/*/var/*/logs/transfer.log | grep -c #{moment}`
      x = x.to_i
      x = x.next
     }
 end

HitsPerMinute() 
```

在大多数情况下，它工作得很好，除了它似乎存储了之前输入的变量。如此处所示。

```
Is there a specific hour you would like to see:  
Please enter an hour you would like to see.
Is there a specific hour you would like to see:  
Please enter an hour you would like to see.
Is there a specific hour you would like to see: d
Please enter an hour you would like to see.
Is there a specific hour you would like to see: 13
Server hits at '10/Oct/2012:13:00: 48
[...]
Server hits at '10/Oct/2012:13:59: 187
Server hits at '10/Oct/2012:0d:00: 0
Server hits at '10/Oct/2012:0d:01: 0
[...]
Server hits at '10/Oct/2012:0d:57: 0
Server hits at '10/Oct/2012:0d:58: 0
Server hits at '10/Oct/2012:0d:59: 0
Server hits at '10/Oct/2012::00: 0
Server hits at '10/Oct/2012::01: 0
[...] 
```

我在输入变量上使用 .strip ，但这似乎对这个问题没有任何作用。我尝试使用 .flush ，但这似乎也没有多大作用。它甚至如何存储多个变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:36:39.847

HitsPerMinute 方法被多次调用，当 if 条件结束时它会继续运行，而是在循环中执行

```
def HitsPerMinute()

  STDOUT.flush
  mhour = ''

  while mhour == '' or mhour == '\n' or (mhour =~ /[a-z]|[A-Z].*/) do
    puts "Please enter an hour you would like to see."
    mhour = spectime = gets.strip
  end

  mstart = 00
  mend = 59

  mstart.upto(mend) { |x|
    moment = "#{rightnow}:#{zeroadder(mhour)}:#{zeroadder(x)}".strip
    print "Server hits at '#{moment}: "
    puts `cat /home/*/var/*/logs/transfer.log | grep -c #{moment}`
    x = x.to_i
    x = x.next
  }
end

HitsPerMinute() 
```

*   关于变量的更新：

它没有在 mhour 变量上存储多个值，每次调用该方法时 mhour 只有一个值。用户在方法结束之前被回答输入一个新值，所以当它最终结束时，之前的调用会继续运行，也许这个例子有助于理解：

```
def method(i)
  if i < 5
    method(i+1)
  end
  puts i
end

method(1) 
```

输出：

```
$ ruby /tmp/test.rb
5
4
3
2
1 
```

# mysql - 带有 3 个表的 MySQL 查询搜索

> ID：12827394
> 
> 赞同：0
> 
> 时间：2012-10-10T19:59:57.113
> 
> 标签：mysql

我有
车辆（vin、vmaker、vmodel、vyear）
客户（SSN、cname、cgender、ccity）
购买车辆（BVSSN、BVVin、价格、年份）

我需要一个查询来找到每个制造商售价最高的车辆。

请帮忙！

例如：本田思域 $20000
本田雅阁 $25000
宝马 3 系 $22000
宝马 5 系 $40000

结果应该是：
本田雅阁
宝马5系

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:12:52.610

如果您正在寻找价格最高的车辆，您应该可以使用以下内容：

```
select v.vmaker, max(b.price) price
from vehicle v
left join buyvehicle b
    on v.vin = b.bvvin
group by v.vmaker 
```

# c# - 如何在保留选择样式的同时绑定 CheckBox 的 ListBox？

> ID：12827395
> 
> 赞同：1
> 
> 时间：2012-10-10T19:59:58.833
> 
> 标签：c#, wpf, xaml

我有以下 XAML 将数据绑定到填充有 CheckBox 的 ListBox：

```
 <ListBox Background="Transparent" Grid.Column="8" Grid.Row="3" ItemsSource="{Binding Path=StakeTypes}" Foreground="White"
        Name="lbStakes" ItemContainerStyle="{StaticResource SelectionListBoxItem}" SelectionChanged="lbStakes_SelectionChanged" SelectionMode="Extended">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <ListBoxItem IsSelected="{Binding IsSelected, Mode=TwoWay}" HorizontalContentAlignment="Stretch">
                    <CheckBox Cursor="Hand" IsChecked="{Binding IsSelected, Mode=TwoWay}" Content="{Binding Text}" HorizontalContentAlignment="Stretch" />
                </ListBoxItem>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

问题是，列表框选择的样式与我手动创建每个列表框项的样式不同：

```
 <ListBox Background="Transparent" Cursor="Hand" Grid.Column="6" Grid.Row="3" Name="lbStakes" SelectionMode="Extended">
        <ListBoxItem IsSelected="True">
            <CheckBox IsChecked="True" Foreground="White" Content="Low" />
        </ListBoxItem>
        <ListBoxItem IsSelected="True">
            <CheckBox IsChecked="True" Foreground="White" Content="Medium" />
        </ListBoxItem>
        <ListBoxItem IsSelected="True">
            <CheckBox IsChecked="True" Foreground="White" Content="High" />
        </ListBoxItem>
        <ListBoxItem IsSelected="True">
            <CheckBox IsChecked="True" Foreground="White" Content="Highest" />
        </ListBoxItem>
    </ListBox> 
```

以下是图片：

![带装订](../Images/59369fc0a5da2823eb05e9e9aac32d22.png)

![无绑定](../Images/25970e5fc3ad19b5fe34b9543b57ea80.png)

我希望它看起来像第二张图片。任何想法都非常感谢。

更新：以下是我试图应用于 ListBoxItem 的样式：

```
 <Style x:Key="SelectionListBoxItem" TargetType="ListBoxItem">
    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListBoxItem">
                <Border Name="Border" Padding="3" SnapsToDevicePixels="true">
                    <ContentPresenter />
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsSelected" Value="true">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource myBrush}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:17:15.557

这两种样式是不同的，因为在您使用的绑定 ListBox 中`ItemContainerStyle="{StaticResource SelectionListBoxItem}"`，而在您的第二个片段中，默认的列表框项目样式适用。尝试从绑定列表框中删除此样式分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T14:25:04.303

```
<Window.Resources>
    <Style x:Key="SelectionListBoxItem" TargetType="ListBoxItem">
        <Setter Property="KeyboardNavigation.TabNavigation" Value="None"></Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border Name="Border" BorderBrush="Black" BorderThickness="0.5" SnapsToDevicePixels="true">
                        <ContentPresenter />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter TargetName="Border" Property="Background" Value="Red"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</Window.Resources>
<Grid>
    <ListBox Background="Transparent" Grid.Column="8" Grid.Row="3" ItemsSource="{Binding Path=IsSelectede}" Foreground="White"
    Name="lbStakes" ItemContainerStyle="{StaticResource SelectionListBoxItem}">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <ListBoxItem IsSelected="{Binding IsSelected, Mode=TwoWay}" HorizontalContentAlignment="Stretch" KeyboardNavigation.TabNavigation="None"> 
                    <CheckBox Cursor="Hand" IsChecked="{Binding IsSelected, Mode=TwoWay}" Content="{Binding Text}" HorizontalContentAlignment="Stretch" />
                </ListBoxItem>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Grid> 
```

某些绑定属性已更改，请根据您的属性进行更正。还有画笔的样式。我希望这会有所帮助。

# jquery - jQuery keypress、keydown、keyup 黑魔法背后的理论是什么（在 Mac 上）？

> ID：12827408
> 
> 赞同：49
> 
> 时间：2012-10-10T20:01:31.580
> 
> 标签：jquery, macos, keypress, keydown, keyup

*我对keypress*、*keydown*和*keyup*的各种行为感到困惑。似乎我错过了一份重要的文档，该文档解释了这三人组的微妙之处和细微差别。有人可以帮我弄清楚我需要阅读哪个文件才能更有效地使用这些事件吗？如果您需要详细信息，请参见下文。

@ov：你让我展示一些代码，但这并不是我试图解决的代码中的一个具体问题。我试图掌握这些事件处理程序的行为，并要求了解它们的人向我指出一份好的文档。

我使用 jQuery 构建输入表单并将其插入到我的文档中。它工作得很好，主要是。我希望表单像我看到的大多数其他输入表单一样响应键盘：`esc`键应该像单击取消按钮一样关闭表单，并且由于表单上有一个`<textarea>`，`cmd`+`enter`应该与单击相同*确定*按钮。*使用keypress*事件似乎很简单。问题是 Chrome 没有调用我的*keypress*处理程序来获取`esc`key 或`cmd`+ `enter`。它会触发`ctrl`+`enter`和`option`+`enter`以及字母数字，但不会触发`cmd`+ `enter`。

所以我会改用*keyup*。我得到*keyup* for `esc`，*keyup* for `cmd`，*keyup* for `enter`，太棒了。但是当我按住时我没有得到*键*的键位。`enter``cmd`

第三次的魅力，你可能认为*keydown*似乎工作，但使用*keydown*，你会得到重复键。我知道，您所要做的就是在第一次调用时取消绑定处理程序，但是这三种不同的事件类型的行为如此不同似乎很奇怪。为什么是这样？那里有我显然没有读过的明显文件吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-10-10T20:09:22.750

**[按键](http://api.jquery.com/keypress/)：**

* * *

> 当浏览器注册键盘输入时，keypress 事件被发送到元素。这类似于 keydown 事件，**除了在 key repeats 的情况下**。如果用户按住某个键，则会**触发一次**keydown 事件，但**会为每个插入的字符触发单独的 keypress 事件**。此外，**修饰键**（如 Shift）会触发 keydown 事件，但**不会触发 keypress 事件**。

**[按键](http://api.jquery.com/keydown/)：**

* * *

> 当用户**第一次按下键盘上的键**时，keydown 事件被发送到元素。它可以附加到任何元素，但事件只发送到**具有焦点**的元素。可聚焦元素 **在浏览器之间可能会有所不同**，但表单元素总是可以获得焦点，因此是此事件类型的合理候选者。

**[键位](http://api.jquery.com/keyup/)：**

* * *

> 当用户**在键盘上释放一个键**时，keyup 事件被发送到一个元素。它可以附加到任何元素，但事件只发送到**具有焦点**的元素。可聚焦元素在浏览器之间可能会有所不同，但表单元素总是可以获得焦点，因此是此事件类型的合理候选者。

此外，这是一个方便的信息，通常被掩盖：

* * *

> 如果需要捕获任何地方的按键（例如，在页面上实现全局快捷键），则将此行为附加到**文档对象**很有用。由于事件冒泡，除非明确停止，否则所有按键都会沿 DOM 向上到达文档对象。
> 
> 要确定输入了哪个字符，请检查传递给处理函数的事件对象。虽然**浏览器使用不同的属性来存储这些信息**，但 jQuery 对**.which** 属性进行了规范化，因此您可以**可靠地使用它来检索字符代码**。
> 
> **请注意，keydown 和 keyup 提供了指示按下哪个键的代码，而 keypress 指示输入了哪个字符。**例如，小写字母“a”将被 keydown 和 keyup 报告为 65，但被 keypress 报告为 97。所有事件都将大写“A”报告为 65。由于这种区别，**当捕获特殊按键（如箭头键）时，.keydown() 或 .keyup() 是更好的选择。**

`cmd`有关MAC 上的键的更多信息：[命令键的 jQuery 键代码](https://stackoverflow.com/questions/3834175/jquery-key-code-for-command-key)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T20:09:10.933

[本文](http://www.quirksmode.org/dom/events/keys.html)是一个很好的资源，用于解释和之间`keyup`的区别。 `keydown``keypress`

简短的回答是，除了考虑不同的浏览器之外，没有简单的方法来处理它们。

我个人在[我编写的 Bootstrap 插件](https://github.com/tcrosen/twitter-bootstrap-typeahead/tree/2.0)中处理它的方式是创建一个自定义方法来检查支持哪个事件。巧合的是，不久之后官方 Bootstrap 版本中出现了一个非常相似的方法：P

```
//------------------------------------------------------------------
//
//  Check if an event is supported by the browser eg. 'keypress'
//  * This was included to handle the "exhaustive deprecation" of jQuery.browser in jQuery 1.8
//
eventSupported: function(eventName) {         
    var isSupported = (eventName in this.$element);

    if (!isSupported) {
      this.$element.setAttribute(eventName, 'return;');
      isSupported = typeof this.$element[eventName] === 'function';
    }

    return isSupported;
} 
```

后来我在我的代码中使用它来附加事件处理程序：

```
if (this.eventSupported('keydown')) {
  this.$element.on('keydown', $.proxy(this.keypress, this));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T01:43:43.700

# networking - 两层架构和三层架构有什么区别？

> ID：12827409
> 
> 赞同：0
> 
> 时间：2012-10-10T20:01:33.347
> 
> 标签：networking, web, web-architecture

我在具有业务逻辑（客户端）的应用程序中使用 JDBC。此 JDBC 连接到另一台机器（服务器）中的数据库。在这种情况下，我的 JDBC 直接与数据库连接并存储和检索数据。这是两层架构吧？

在另一个应用程序中，例如 servlet 编程，我只是在我的客户端机器上有浏览器，它是表示层（客户端层）。让我将我的业务逻辑视为应用程序层（第二层）和数据库作为数据层（第三层）。我仍然使用 JDBC 将我的应用程序（业务逻辑）与数据库连接起来。第二层和第三层现在驻留在服务器上。

通过上面的例子，在三层架构中，浏览器只是额外添加了一个浏览器，并将我的业务逻辑保留在服务器上。除了这些，我没有感觉到任何性能差异。如果我错了，请纠正我并通过其他示例向我解释 2 层和 3 层的确切架构。提前谢谢亲爱的朋友们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T01:41:50.550

你说的是对的。

1.  你的第一个例子是两层的。
2.  第二个例子是三层。

如果浏览器和服务器之间的链接比服务器和 DBMS 之间的链接慢，那么三层架构可以代表重要的性能增益。这是因为通常业务逻辑需要多次调用 DBMS 和/或只向用户呈现 DBMS 返回的一小部分信息。在客户端拥有业务逻辑而与 DBMS 的连接速度较慢将代表重要的性能损失。

在典型的 Web 场景中，客户端和服务器之间的连接通常比服务器和 DBMS 之间的连接慢几倍，并且有你的性能增益。

# mysql - 如何删除 ONE 列中的部分条目？

> ID：12827410
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:01:35.737
> 
> 标签：mysql, sql

我有 MySQL 基表，需要更改 ONE 列中的内容。

该列中的条目是：

```
Cat - Grey - small 
Cat - Grey - middle 
Dog - Grey - big 
Elephant - Grey - big 
```

我需要删除中间词，这样我才能得到 Cat - small, Cat - middle..

所以它是一列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:04:03.763

您可以使用[`REPLACE()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)：

```
UPDATE table SET column = REPLACE('- Grey -', '-', column); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:25:25.317

这是获取没有中间词的字符串的通用方法：

```
select concat(
  substring(oldcol,1,locate('-', oldcol)),
  substring(oldcol,length(oldcol) - locate("-", reverse(oldcol))+2)
) as newcol
from mytable 
```

# matlab - 求解具有一个已知系数的线性方程组的系数

> ID：12827411
> 
> 赞同：2
> 
> 时间：2012-10-10T20:01:36.587
> 
> 标签：matlab

```
clc;
clear all;

syms y a2 a3

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% [ 0.5  0.25  0.125  ]    [ a2 ]    [ y ]
% [  1     1     1    ]    [ a3 ]  = [ 3 ]
% [  2     4     8    ]    [  6 ]    [ 2 ]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

M = [0.5 0.25 0.125; 1 1 1; 2 4 8];
t = [a2 a3 6];
r = [y 3 2];

sol = M * t'

s1 = solve(sol(1), a2)   % solve for a2
s2 = solve(sol(2), a3)   % solve for a3 
```

这就是我到目前为止所拥有的。这些是我的输出

```
sol =

 conj(a2)/2 + conj(a3)/4 + 3/4
       conj(a2) + conj(a3) + 6
  2*conj(a2) + 4*conj(a3) + 48

s1 =

- conj(a3)/2 - 3/2 - Im(a3)*i

s2 =

- conj(a2) - 6 - 2*Im(a2)*i 
```

`sol`如果我们将它们放回方程形式，看起来就像我们会得到的那样：

> 0.5 * a2 + 0.25 * a3 + 0.125 * a4
> 
> a2 + a3 + a4 = 3
> 
> 2*a2 + 4*a3 + 8*a4 = 2

其中 a4 已知 == 6。

我的问题是，我对如何使用`solve`实际求解这些方程来获得 和 的值`a2`感到困惑`a3`。

`s2`解决 a3 但它与我们在纸上的不匹配（不完全）。a2 + a3 + 6 = 3 应该产生 a3 = -3 - a2。

因为想象。不知何故，我需要将矢量解决方案等同于每一行`sol`的值`[y 3 2]`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:13:29.933

您需要提供`solve`带有方程式的函数。就这么简单：

```
 sol = solve(M * t' == r'); 
```

结果你有

```
sol.a2 = 17
sol.a3 = -20
sol.y = 17/4 
```

这适用于 MATLAB R2012b。一般来说，这可以在一行中解决：

```
solve('a2 / 2 + a3 / 4 - y + 3 / 4 = 0', 'a2 + a3 + 3 = 0', '2 * a2 + 4 * a3 + 46 = 0') 
```

PS 我已经检查过了，这适用于 MATLAB R2011b。

# awk - awk 字符串并添加文本

> ID：12827413
> 
> 赞同：0
> 
> 时间：2012-10-10T20:01:42.510
> 
> 标签：awk

我在下面有一个 awk 语句，我希望在每个输出行之前和之后添加一些文本。

```
grep  "id\": \"http://mysite.com/movies/new/id/" new_id.txt | head -n1217 | awk -F/ ' { print $7 } ' | awk -F\" ' { print $1 } ' 
```

这让我得到了相关 ID 的列表，但我需要获取它输出的每一行并预先添加一些文本。我怎么能做到这一点，用awk？赛德？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:14:17.507

一种在行前添加和追加行的方法`GNU sed`：

假设`infile`有数据：

```
one
two
three 
```

和以下`script.sed`：

```
1,$ {
    i\  
Text prepended (line 1)\ 
Text prepended (line 2
    a\  
Text appended (line 1)\ 
Text appended (line 2)
} 
```

像这样运行它：

```
sed -f script.sed infile 
```

这会产生：

```
Text prepended (line 1)
Text prepended (line 2
one
Text appended (line 1)
Text appended (line 2)
Text prepended (line 1)
Text prepended (line 2
two
Text appended (line 1)
Text appended (line 2)
Text prepended (line 1)
Text prepended (line 2
three
Text appended (line 1)
Text appended (line 2) 
```

因此，您需要根据需要对其进行调整并将其添加到管道链的末端。

* * *

**编辑**：`sed`单线：

```
sed -e 's/^/Text prepended\n/; s/$/\nText appended/' infile 
```

# xml - XSL 根据属性对元素进行排序，特定元素除外

> ID：12827419
> 
> 赞同：3
> 
> 时间：2012-10-10T20:02:20.650
> 
> 标签：xml, xslt, sorting

我已经有一个 XSL，它根据属性值 @id 或 @category 对整个文档进行排序。现在我想通过定义永远不应该排序的节点来增强它。

这是一个示例 XML：

```
<root>
    [several levels of xml open]

    <elemetsToBeSorted>
        <sortMe id="8" />
        <sortMe id="2" />
        <sortMe id="4" />
    </elemetsToBeSorted>

    <elemetsNOTToBeSorted>
        <dontSortMe id="5" />
        <dontSortMe id="3" />
        <dontSortMe id="2" />
    </elemetsNOTToBeSorted>

    [several levels of xml closing]
</root> 
```

这是我的 XSL：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="xml" indent="yes" />

<!-- Sort all Elements after their id or category -->
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()">
            <xsl:sort select="@id" />
            <xsl:sort select="@category" />
        </xsl:apply-templates>
    </xsl:copy>
</xsl:template>

<!-- Next two templates clean up formatting after sorting -->
<xsl:template match="text()[not(string-length(normalize-space()))]" />

<xsl:template match="text()[string-length(normalize-space()) > 0]">
    <xsl:value-of select="translate(.,'&#xA;&#xD;', '  ')" />
</xsl:template> 
```

预期输出：

```
<root>
    [several levels of xml open]

    <elemetsToBeSorted>
        <sortMe id="2" />
        <sortMe id="4" />
        <sortMe id="8" />
    </elemetsToBeSorted>

    <elemetsNOTToBeSorted>
        <dontSortMe id="5" />
        <dontSortMe id="3" />
        <dontSortMe id="2" />
    </elemetsNOTToBeSorted>

    [several levels of xml closing]
</root> 
```

我怎样才能实现我的 XSL 忽略“elementsNOTToBeSorted”？

编辑：我有数百个元素应该排序，但只有少数元素（及其子元素）不应该排序。所以逻辑就像“排序所有，除了a和b”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T08:44:32.237

```
<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()" />
    </xsl:copy>
</xsl:template>

<!-- all elements except a few sort their children -->
<xsl:template match="*[not(self::elemetsNOTToBeSorted | self::otherElemetsNOTToBeSorted)]">
    <xsl:copy>
        <xsl:apply-templates select="@*" />
        <xsl:apply-templates>
            <xsl:sort select="@id" />
            <xsl:sort select="@category" />
        </xsl:apply-templates>
    </xsl:copy>
</xsl:template>

<!-- ... --> 
```

请注意，匹配表达式特异性在这里起作用。更具体的匹配表达式确定将运行哪个模板：

*   `node()`不那么具体`*`，因此元素节点将由`<xsl:template match="*">`
*   元素匹配`self::elemetsNOTToBeSorted | self::otherElemetsNOTToBeSorted`将由标识模板处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:47:45.353

添加这一行应该忽略 elementsNOTToBeSorted 的所有后代元素：

```
<xsl:template match="elemetsNOTToBeSorted" /> 
```

如果您希望这些元素仍然存在于输出文档中，您可以复制它们而不是抑制：

```
<xsl:template match="elemetsNOTToBeSorted">
    <xsl:copy-of select="." />
</xsl:template> 
```

# mysql - MySQL：无法创建表（错误号：150）

> ID：12827426
> 
> 赞同：4
> 
> 时间：2012-10-10T20:02:48.163
> 
> 标签：mysql, foreign-keys, mysql-workbench

我正在为我的大学作业开发我的第一个 MySQL 数据库。不幸的是，我被困了一段时间，试图在它们之间创建带有外键的实际表。

这是 MySQL Workbench 正向工程向导给出的错误：

在服务器中执行 SQL 脚本

```
ERROR: Error 1005: Can't create table 'test.fremført' (errno: 150)    

CREATE  TABLE IF NOT EXISTS `Fremført` (    
  `Plate` VARCHAR(20) NOT NULL ,
  `Verk` VARCHAR(45) NOT NULL ,
  `Artist` VARCHAR(45) NOT NULL ,
  `Dato` DATE NULL ,
  PRIMARY KEY (`Plate`, `Verk`, `Artist`) ,
  INDEX `Fremført->Artist_idx` (`Artist` ASC) ,
  INDEX `Fremført->Spor_idx` (`Plate` ASC, `Verk` ASC) ,
  CONSTRAINT `Fremført->Artist`
    FOREIGN KEY (`Artist` )
    REFERENCES `Artist` (`ArtistNavn` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Fremført->Spor`
    FOREIGN KEY (`Plate` , `Verk` )
    REFERENCES `Spor` (`Verk` , `Verk` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB 
```

有谁知道上面的脚本有什么问题，如果有，有解决方案吗？

谢谢！

编辑：这是请求的体育查询

```
DROP TABLE IF EXISTS `Spor` ;
CREATE  TABLE IF NOT EXISTS `Spor` (
  `Plate` VARCHAR(45) NOT NULL ,
  `Verk` VARCHAR(45) NOT NULL ,
  `Spilletid` DECIMAL(3,2) NULL ,
  PRIMARY KEY (`Plate`, `Verk`) ,
  INDEX `Plate_idx` (`Plate` ASC) ,
  CONSTRAINT `Plate`
    FOREIGN KEY (`Plate` )
    REFERENCES `Plate` (`KatalogNr` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

DROP TABLE IF EXISTS `Artist` ;
CREATE  TABLE IF NOT EXISTS `Artist` (
  `ArtistNavn` VARCHAR(30) NOT NULL ,
  `Artistcol` VARCHAR(45) NULL ,
  PRIMARY KEY (`ArtistNavn`) )
ENGINE = InnoDB; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:14:18.957

errno150 通常与主列和相关列的数据类型不匹配有关。它们必须完全匹配，包括字符长度。

我看到`Fremført.artist`( `VARCHAR(45)`) 和`Artist.ArtistNavn`( `VARCHAR(30)`) 之间的数据类型不匹配。这些必须相同才能使 FOREIGN KEY 约束成功。

```
CREATE  TABLE IF NOT EXISTS `Fremført` (    
  `Plate` VARCHAR(20) NOT NULL ,
  `Verk` VARCHAR(45) NOT NULL ,
  /* Must match the primary table VARCHAR(30) */
  `Artist` VARCHAR(30) NOT NULL ,
  `Dato` DATE NULL ,
  PRIMARY KEY (`Plate`, `Verk`, `Artist`) ,
  INDEX `Fremført->Artist_idx` (`Artist` ASC) ,
  INDEX `Fremført->Spor_idx` (`Plate` ASC, `Verk` ASC) ,
  CONSTRAINT `Fremført->Artist`
    FOREIGN KEY (`Artist` )
    REFERENCES `Artist` (`ArtistNavn` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `Fremført->Spor`
    FOREIGN KEY (`Plate` , `Verk` )
    /* Was this intentional, rather than (`Plate`, `Verk`)? */
    /* If not, you must also match the data type of `Plate` VARCHAR(20) to that of Spor.Plate VARCHAR(45) */
    REFERENCES `Spor` (`Verk` , `Verk` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB 
```

如上所述，如果约束`Fremført->Spor`旨在引用`Spor (Plate , Verk )`而不是`Spor (Verk , Verk )`您定义的那样，那么您还将遇到 err150 由于 和 之间的类型不`Spor.Plate`匹配`Fremført.Plate`。更改`Fremført.Plate`为`VARCHAR(45)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:10:11.503

错误 150 是外键约束问题。我怀疑您遇到的两个 FK 之一有问题。

见：[http ://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:10:20.660

**(errno: 150)**该错误意味着 FK 失败，因此创建表也......

请检查您的 FK。

*   你已经创建了吗？（PK指向这个的表）
*   你的拼写对了吗？
*   和PK的数据类型一样吗？

# c# - 如何选择具有另一列结果的值

> ID：12827430
> 
> 赞同：0
> 
> 时间：2012-10-10T20:03:04.783
> 
> 标签：c#, mysql

我正在使用 C#，我需要为 mysql 用户和密码开发一个检查系统。到目前为止，我想出的是这个，我得到的错误是它是错误的语法......

```
public bool VerifyUser(string username, string password)
{
    string returnValue = "";

    string Query = "SELECT Pass FROM Base_Character WHERE User='" + username + "'";

    MySqlCommand verifyUser = new MySqlCommand(Query, this.sqlConn);

    try
    {
        verifyUser.ExecuteNonQuery();

        MySqlDataReader myReader = verifyUser.ExecuteReader();

        while (myReader.Read() != false)
        {
            returnValue = myReader.GetString(0);
        }

        myReader.Close();
    }
    catch (Exception excp)
    {
        Exception myExcp = new Exception("Could not verify user. Error: " +
            excp.Message, excp);
        throw (myExcp);
    }

    if (returnValue == password)
    {
        return false;
    }
    else
    {
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:13:45.447

`ExecuteNonQuery`用于删除、插入和更新。每当您希望将数据作为行从数据库返回时，请使用`ExecuteReader`

您的查询应该一起检查用户名和密码，如果它们存在于一条记录中，则返回该行，否则不返回任何内容。

您仍然需要更多地了解使用 .Net 进行编码/数据库编程

```
public bool VerifyUser(string username, string password)
{
    bool returnValue = false;
    string Query = "SELECT 1 FROM Base_Character WHERE User='" + username + "' AND pass='"+password+"'";

    try
    {
        MySqlCommand command = new MySqlCommand(Query, this.sqlConn);

        MySqlDataReader myReader = command.ExecuteReader();

        if(myReader.Read())
        {
            returnValue = true;
        }

        myReader.Close();
    }
    catch (Exception excp)
    {
        throw;
    }

    return returnValue;
 } 
```

您可能不应该抛出自定义异常，因为您使用的是布尔值

```
if(VerifyUser("user123", "******"))
{
   //Congratulations
}
else
{
   //Unable to log you in
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:08:31.430

谢谢大家，但这需要mysql无法保存或处理的自定义加密，我的主要错误是忽略了executenonquery（），所以我不得不编写这样的代码：

```
if (AuthorizeTools.Encrypt.Password(Database.getPassword) != Password) //Password is already encrypted 
```

然后将mysql函数设置为：

```
public string getPassword(string username)
        {
            string returnValue = "";
            string Query = "SELECT Pass FROM Base_Character where (User=" +
                "'" + username + "') LIMIT 1";

            MySqlCommand checkUser = new MySqlCommand(Query, this.sqlConn);

            try
            {
                checkUser.ExecuteNonQuery();

                MySqlDataReader myReader = checkUser.ExecuteReader();

                while (myReader.Read() != false)
                {
                    returnValue = myReader.GetString(0);
                }

                myReader.Close();
            }
            catch (Exception excp)
            {
                Exception myExcp = new Exception("Could not grab password: " +
                    excp.Message, excp);
                throw (myExcp);
            }
            return (returnValue);
        } 
```

# arrays - 要存储在数组中的数据结构

> ID：12827431
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:03:26.277
> 
> 标签：arrays, data-structures, hierarchical-data

![给定这个数据结构](../Images/0588190341a87d4013f8d2a7b00f1e95.png) 其中 GF : 祖父 f1,f2,f3 : 父亲 c1,c2,c3 : 孩子

Q1。如何将此数据结构存储在数组 Q2 中。使用上面的数组，如何访问所有子元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T17:09:51.147

我认为这样做

```
#include <iostream>
using namespace std;

struct Father
    {
        char* Child1;
        char* Child2;
        char* Child3;
    };

struct Grandfather
{
    Father Father1 ;
    Father Father2;
    Father Father3;
};

const int MAXARRAYSIZE = 20;
Grandfather Grandfathers[MAXARRAYSIZE];

int main()
{   
    Grandfathers[0].Father1.Child1 = "The smart";
    Grandfathers[0].Father1.Child2 = "the brave";
    Grandfathers[0].Father1.Child3 = "the free";

    Grandfathers[0].Father2.Child1 = "The good";
    Grandfathers[0].Father2.Child2 = "the bad";
    Grandfathers[0].Father2.Child3 = "the ugly";

    Grandfathers[0].Father3.Child1 = "The boy";
    Grandfathers[0].Father3.Child2 = "the girl";
    Grandfathers[0].Father3.Child3 = "the other boy";

    //To print the children
    int CurrentArraySize = 1; //i can be changed with user input to accomodate more users for example, if there are 3 elements to the Grandfathers array i.e 3 different trees change CurrentArraySize to 3
    for(int i = 0; i < CurrentArraySize; i++)
    {
        cout<<"Children under Father1 are : "<<Grandfathers[i].Father1.Child1<<", "<<Grandfathers[i].Father1.Child2<<" and "<<Grandfathers[i].Father1.Child3<<endl;
        cout<<"Children under Father2 are : "<<Grandfathers[i].Father2.Child1<<", "<<Grandfathers[i].Father2.Child2<<" and "<<Grandfathers[i].Father2.Child3<<endl;
        cout<<"Children under Father3 are : "<<Grandfathers[i].Father3.Child1<<", "<<Grandfathers[i].Father3.Child2<<" and "<<Grandfathers[i].Father3.Child3<<endl;

    }
    system("pause");
} 
```

# iphone - 创建与 iPhone 静音/取消静音时相同的视觉效果（带图标的黑色圆角正方形）

> ID：12827434
> 
> 赞同：0
> 
> 时间：2012-10-10T20:03:38.633
> 
> 标签：iphone, ios, customization, uiactivityindicatorview

我不知道我想要实现的效果的正确名称，但是当您将手机静音/取消静音或使用音量按钮时，它是带有图标和标题的黑色圆角正方形，会在屏幕中央短暂显示。

我见过具有相同效果的应用程序，但图标带有旋转活动指示器，或者带有复选标记和“完成”作为标题。我想实现这两种效果，还想实现一个自定义图标和标题。

有没有内置的方法可以做到这一点？（我在不知道它叫什么的情况下搜索文档时遇到了麻烦。）

如果内置方式不存在，我应该如何创建这种效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:09:27.587

MBProgressHUD 可以做你想做的一切。看看如何定制它。[https://github.com/jdg/MBProgressHUD](https://github.com/jdg/MBProgressHUD)

# asp.net - 月视图全日历中的 24 小时活动

> ID：12827436
> 
> 赞同：0
> 
> 时间：2012-10-10T20:03:52.443
> 
> 标签：asp.net, fullcalendar

在周和日视图中，我获得了 24 小时的事件时间，但在月视图中显示为 AM/PM，因此周/日视图中的事件显示为 22:00，月视图中显示 10p“事件名称”，我该如何改变它！？我的脚本中有这个。

22:00 显示为 10p

```
timeFormat: { agenda: 'H:mm{ - HH:mm}' }, dragOpacity: { agenda: 0.5 }, minTime: 0, 
```

如果我用这个

```
timeFormat: { '': 'HH:mm' }, isRTL: false, 
```

然后它在月视图上的正确时间为 22:00，但随后在周/日视图中显示时间为 10:00。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T23:40:21.893

在所有情况下都需要 24 小时吗？尝试：`timeFormat: 'HH:mm{-HH:mm}'`

# asp.net-mvc-3 - 表单字段值未绑定到模型

> ID：12827444
> 
> 赞同：1
> 
> 时间：2012-10-10T20:04:17.450
> 
> 标签：asp.net-mvc-3

我创建了一个简单的 MVC 应用程序，它从表单中获取信息并将其传递给控制器

看法：

```
@model MvcApplication1.Models.BetChargeModel

@using (Html.BeginForm())
{
<div>
    @Html.TextBoxFor(m=>m.numerators[0])   /   @Html.TextBoxFor(m=>m.denominators[0])
</div>

<div>
    @Html.TextBoxFor(m => m.numerators[1])   /   @Html.TextBoxFor(m => m.denominators[1])
</div>

<div>
    <input type="submit" value="Calculate" />
</div>
} 
```

控制器：

```
 public ActionResult Index()
    {
        BetChargeModel model = new BetChargeModel();
        model.numerators = new List<double>();
        model.denominators = new List<double>();
        model.denominators.Add(1);
        model.denominators.Add(1);
        model.numerators.Add(0);
        model.numerators.Add(0);

        return View(model);
    }

[HttpPost]
    public ActionResult Index(BetChargeModel model)
    {
        double odds1 = model.numerators[0] / model.denominators[0];
        double odds = model.numerators[1] / model.denominators[1];

//other code
} 
```

模型：

```
 public class BetChargeModel
{
    public List<double> numerators { get; set; }

    public List<double> denominators { get; set; }

    public double result { get; set; }

} 
```

当我运行它并尝试从视图中发回信息时，模型返回为空（充满空字段和零）。为什么我的文本框中的数据没有绑定到模型？

（编辑：我已经更改了模型属性和对分子、分母和结果的引用，但为了简洁起见，这里没有更新这些）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:31:27.047

根据名称`numerators`，`denominators`您似乎已将列表实现为模型上的字段。

您应该[使用属性来代替](https://stackoverflow.com/a/7789986/700926)模型绑定以正常工作（我假设@Raphael 已经完成了）。

工作模型如下所示：

```
public class BetChargeModel
{
    public List<double> numerators { get; set; }
    public List<double> denominators { get; set; }
} 
```

...并遵循命名约定，确保重命名`numerators`为`Numerators`和.`denominators``Denominators`

但是，如果这不能解决您的模型绑定问题，请详细说明并发布您的模型实现 :)

- 更新

正如您所报告的问题仍然存在，我将根据您自己提供的示例发布我已实现的代码 - 然后您可以交叉检查以确保一切在您的机器上看起来正确 - 下面显示的代码已经过测试并且可以工作：

***模型：***

```
public class BetChargeModel
{
    public List<double> numerators { get; set; }
    public List<double> denominators { get; set; }
} 
```

***看法：***

```
@model Project.Models.BetChargeModel

@using (Html.BeginForm())
{
<div>
    @Html.TextBoxFor(m=>m.numerators[0])   /   @Html.TextBoxFor(m=>m.denominators[0])
</div>

<div>
    @Html.TextBoxFor(m => m.numerators[1])   /   @Html.TextBoxFor(m => m.denominators[1])
</div>

<div>
    <input type="submit" value="Calculate" />
</div>
} 
```

***控制器：***

```
public ActionResult Index()
{
    var model = new BetChargeModel
                    {
                        numerators = new List<double> {0, 0},
                        denominators = new List<double> {1, 1}
                    };
    return View(model);
}

[HttpPost]
public ActionResult Index(BetChargeModel model)
{
    var odds1 = model.numerators[0] / model.denominators[0];
    var odds = model.numerators[1] / model.denominators[1];
    return null;
} 
```

# php - 制作移动版论坛

> ID：12827448
> 
> 赞同：0
> 
> 时间：2012-10-10T20:04:34.163
> 
> 标签：php, mobile

我正在考虑制作一个移动版的论坛。我没有数据库访问权限。我在想我必须获取 URL 并整理主题。有没有人对如何实现这一目标有其他想法或意见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:28:06.883

你在 CSS 方面很棒吗？最简单的方法可能是为网站创建一个代理，然后注入一个样式表以使其在移动设备上正确呈现。

MediaQueries 和 CSS3 选择器，甚至一些 JQuery/JS 将成为您轻松进行转换的朋友。

根据您的脚本语言（Ruby），您可以利用 nokogiri 之类的东西来解析 XML/HTML，以确保您的 CSS 文件被注入到正确的页面中。然后将修改后的 DOM 元素作为 html 返回。棘手的部分将是管理多个客户端身份验证，但使用支持 CookieJars 的 HTTP 库将有很大帮助。我不会使用这样的代理并将我的登录信息提供给第 3 方。所以你最好的选择是让它成为一个只读应用程序？如果可能的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:37:03.343

与 j_mcnally 的答案类似，您应该查看 CSS 媒体查询。您想要做的事情听起来您对论坛本身的代码没有太多（或任何）访问权限，但您想更改外观。您绝对可以创建网站的移动版本，`mobile.yourname.com`但显然更喜欢仅`yourname.com`根据屏幕大小应用样式表。从技术上讲，您可以嗅出特定的设备并为每个设备应用样式表，但这并不可取，因为您必须为每种不同的可能屏幕尺寸创建样式。

长话短说，你有大量的选择：但使用 CSS 媒体查询。这种做法被称为响应式设计。我强烈建议您查看[Ethan Marcotte 的书](http://www.abookapart.com/products/responsive-web-design)（他几乎是响应式 CSS 背后运动的发起人）。如果你不想买这本书，我建议[从他的文章开始，](http://www.alistapart.com/articles/responsive-web-design/)这是对整本书内容的一个很好的总结。如果你想进入这类事情，任何一个都是巨大的帮助。

# ios - 自定义字体 iOS

> ID：12827452
> 
> 赞同：0
> 
> 时间：2012-10-10T20:04:48.397
> 
> 标签：ios, fonts, xcode4.5, truetype

我从互联网上下载了几个 LCD / LED 字体，但到目前为止只能在我的 iPod 上运行其中一个。它们在 XCode 4.5 的模拟器上显示良好，但是一旦我尝试在 iPod 上运行它们，它们中的大多数都失败了。我仔细检查了项目中包含的字体，字体是否通过捆绑包复制到设备，以及让它们运行所需的一切。有没有人知道为什么有些字体可以在 iDevice 上使用而有些不能？在下载或购买字体之前我需要寻找什么？

谢谢

# c++ - 将 HWND 附加到外部的现有的（windows 顺序）

> ID：12827456
> 
> 赞同：0
> 
> 时间：2012-10-10T20:05:06.933
> 
> 标签：c++, hwnd

只是一个希望不会太长的问题：在 C++ 中是否可以将 HWND 彼此“附加”到彼此？因此，无论前面是否有其他窗口，或者该窗口是否在顶部，一个人都应该始终跟随其他人。

有谁知道怎么做？请注意，HWND 实际上是我所知道的关于应该遵循的窗口的唯一信息。

提前致谢！

# java - 寻找让 Web 框架在服务器端更 OO 的最佳方式

> ID：12827458
> 
> 赞同：2
> 
> 时间：2012-10-10T20:05:14.887
> 
> 标签：java, hibernate, javabeans, pojo, oop

Web 框架似乎总是偏离良好的 OO 代码（您将代码和数据组合在一个对象中，考虑向该对象发送消息等）

主要问题似乎是bean模式的存在。您使用 bean 模式（现在通常称为 POJO，因为人们似乎不了解其中的区别）与数据库、Web 服务和大多数其他事物进行交互。

所以，不，你会被这个没有代码的 setter 和 getter 所困——所以你倾向于添加一堆——本质上是静态函数来操作这些东西。OO 代码的几乎所有优点都消失了。

我看到了我正在考虑的三个解决方案，但想知道其中任何一个是否有任何严重的缺点。

1) 使用 POJO 模式而不是 bean 模式。这意味着从您的 POJO 中消除 setter 和 getter（这样您就可以拥有封装/数据安全），而是添加业务逻辑方法。这似乎是最有意义的——事实上，我认为这就是为什么像 hibernate 这样的库从需要 Bean 转为允许 POJO 的原因，但似乎每个人仍然使用 bean 模式。

2) 使用业务逻辑类扩展您的 Bean，该业务逻辑类使用 bean 的字段作为存储。这似乎很不稳定且有问题，但是很容易将其放入现有的代码库中作为迁移的一种方式...

3) 用业务逻辑对象包装 Bean 模式对象。大多数情况下，如果＃1确实有问题，我认为这可能是必要的。

我最想知道的是为什么我从未见过#1 被使用过。我真的很想听听任何使用 Pojo 模式（有业务逻辑，没有 setter 和 getter）来处理休眠对象并且遇到问题（或者让它工作得很好）的人......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:15:34.887

我会将我的评论更改为答案。我基本上不同意你的开场白

> Web 框架似乎总是偏离良好的 OO 代码。

Java EE 或 Spring/JPA 模型中没有任何东西“远离良好的 OO 代码”。像 hibernate 这样的 JPA 提供程序允许 POJO 的事实并不意味着您不能使用在 bean 中定义业务逻辑的富域模型。对于 Java Web 应用程序，我已经看到它以两种方式完成——丰富的域模型，或者在服务层中具有业务逻辑的贫乏域模型，这不是非 OO 或糟糕的设计。

我想你的意思可能是很多应用程序没有用正确的设计和/或正确的 OO 编写。 **我**会同意的。但这与框架无关......

因此，您提出的解决方案基本上都说“使用良好的 OO 原则正确设计您的应用程序”。选项 1 是最简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:25:33.367

我对您在这里争论的确切内容感到困惑，正如您所说的那样，人们都倾向于将 bean 称为“POJO”，然后您建议不要使用 bean，而是使用“POJO”。但要回应这一点：

> 所以，不，你会被这个没有代码的 setter 和 getter 所困——所以你倾向于添加一堆——本质上是静态函数来操作这些东西。OO 代码的几乎所有优点都消失了。

我不同意这一点——如果你正在编写静态函数来操作你的对象，那么你的设计就有问题。

通常，常见/“最佳”实践是您将业务逻辑包装在类的“服务层”中，该类知道如何操作数据（在您的 bean、POJO、域对象中表示，无论您想调用它们什么）作为响应到应用程序的规则。

没有人阻止你让你的“服务层”是面向对象设计的，有子类和继承等等。

通常，您不会看到有人构建了一个应用程序，其中`Employee`保存数据的类还包含对 执行操作的方法和逻辑`Employee`，因为人们倾向于将数据（由`Employee`类表示）与逻辑分开。而且实际上，一旦你开始拥有对`Employee`类中的员工实例进行操作的方法，那么你需要让`Employee`类能够调用存储层本身，现在你使用 Hibernate 来表示结果的类查询（`Employee`类）也引用了 Hibernate 代码来加载自己，它变得一团糟。

我认为您看到的“问题”只是您对这些类型的应用程序常见的设计理念的分歧。大多数人希望将数据的表示方式与封装应用程序逻辑的代码分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T21:16:04.913

将（大部分）业务逻辑保留在数据对象之外是有充分理由的，但最佳设计将包括其中的某些部分。要做到这一点并不容易，尤其是在蓝领团队环境中，我猜这是所有 Java 开发团队的 95%。

我喜欢将一些简单的、独立的、可广泛重用的逻辑片段放入我的数据对象中；本质上与该数据耦合的代码，而不考虑任何特定的业务请求。例如一些转换、验证等。

至于 getter 和 setter，我不惜一切代价避免使用它们。您可以使用公共最终字段，或者只是普通的公共字段。getter+setter 组合为您提供与公共字段一样多的封装：零。

至于 ORM 解决方案，我严格使用 Hibernate 作为 SQL 的便利，而不是作为持久状态管理器。映射类只是作为 XML 映射的替代品。它们甚至从未在读取操作中实例化。对于插入，我单独保存每个对象，它与单个数据库行一对一映射，没有传递持久性。这基本上意味着我的 Hibernate 模型对象只是一种查看数据库行的 Java 方式（加上方便的连接列规范——没有那些冗余连接条件的 HQL 看起来要好得多）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T20:18:09.643

根据最佳实践，**业务逻辑应该与表示逻辑分开**。大多数 Web 框架都围绕数据的呈现提供了很好的功能。任何涉及数据检索/操作的业务逻辑都应该写在和`Business Layer`之间，这是一个额外的层。对象充当 和 之间的数据载体。确实是很好的候选者，因为它们是非常轻的对象，具有作为访问器方法的属性。`presentation layer``data layer``POJO``Business Layer``Presentation Layer``POJO`

休息由你决定。如果您想使用其中包含业务逻辑的复杂 bean 对象，我认为任何 Web 框架都不会阻止您这样做。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T20:22:51.520

“我最想知道的是为什么我从未见过 #1 被使用过。” 关注点分离、单一职责原则（可能是最重要的）、可测试性等。“一切都耦合到一切”的模型很方便，但客观上很糟糕。（这并不是说方便的 API 界面不好，但它们应该构建在经过良好分解的、可测试的代码之上，而不是代替它。）

例如，当您在业务逻辑层上添加一个“哑” DTO 层时，其中每个视图都映射到包含创建视图所需的所有内容的 bean，您摆脱了诸如必须保持会话打开以获取关联的问题属性，或者让 ORM 急切地获取它们。（前者还意味着有 N+1 个选择问题，这会增加数据库往返次数。）

如果每个请求都由专用服务层上的单个方法调用提供服务，它还可以更轻松地跟踪事务范围。然后，此调用是对数据的单个逻辑操作，这使得设置事务处理变得微不足道。

最后但并非最不重要的一点是，这种方法导致更容易理解和自行更改的小类。例如，如果您需要更改计算平均绩点的算法，则从那里开始`GradePointAverageCalculator`并从那里导航，而不是您需要查看的代码范围是“ `Student.java`，第 1340 到 1486 行，然后是 1502 到 1689，……”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-10T21:01:05.487

也许您可以查看其他 Knockout（一个 javascript 框架）使用的模型-视图-视图模型设计模式。在这里，视图模型作为模型和视图之间的层被引入，提供了将视图与模型分离的可能性。

在这里阅读更多信息：http: [//knockoutjs.com/documentation/observables.html](http://knockoutjs.com/documentation/observables.html) ..和这里[http://en.wikipedia.org/wiki/Model_View_ViewModel](http://en.wikipedia.org/wiki/Model_View_ViewModel)

# curl - Cakephp URL 路由

> ID：12827462
> 
> 赞同：1
> 
> 时间：2012-10-10T20:05:21.053
> 
> 标签：curl, url-rewriting, cakephp-2.0, cakephp-2.1

我是 cakePHP 新手，我希望在我的应用程序中重写我的网址。

对于我想要导航的一些控制器。

```
`controller/action/id/slug`. 
```

为此，我将规则写为，

```
Router::connect(
        '/products/:id/:slug', array('controller' => 'products', 'action' => 'view'), array('pass' => array('id'), 'id' => '[0-9]+')
); 
```

我正在写链接作为..

```
echo $this->Html->link($record['Category']['name'], array('controller' => 'categories', 'action' => 'index', 'slug' => $record['Category']['slug']), array('escape' => false)); 
```

问题

1.  规则是否仅适用于提到的控制器和操作，即产品和视图。?

2.  为什么我的网址（悬停时）显示为`controller/action/slug:slug_name`而不是`controller/action/slug_name`？

3.  在同一个控制器中，我希望使用不同的 url 重写，例如`action/id/slug_name`我发送的`/action`某个地方或我只使用 slug的某个地方`action/slug_name`。是否只有一条规则适用于所有人？或者我必须为每个控制器和操作定义单独的规则。

4.  也为所有控制器创建通用规则？

请描述更多。我试图阅读文档，但有点困惑。我的参数如何获得我提到的所有类型的请求。

现在写我只使用简单的方法来获取参数

```
 controller/action/param1:param_val1/param2:param_val2,
 echo $this->Html->link('Val', array('controller' => 'categories',
 'action' => 'index', 'param1' => param_val1, 'param2' => param_val2,),
 array('escape' => false)); 
```

等等。但我希望有非常清晰的漂亮网址以及更好更快的动作。就像传递 slug 我希望直接获取 findBySlug 或某种使它变得更好的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T06:51:00.167

1) 是的，当你创建一个Router::connect 规则时只适用于一种情况，即适用于一个url 或group os url。

2）你应该这样做

```
echo $this->Html->link($record['Category']['name'], array('controller' => 'categories', 'action' => 'index',  $record['Category']['slug']), array('escape' => false)); 
```

3）您必须为这些url创建规则，只有当url的结构不同时

根据您的示例，规则如下

```
# only for action/slug_name case
Router::connect('/products/:slug', array('controller' => 'products', 'action' => 'view'), array('pass' => array('slug'), 'slug'=>'[a-z_]+'));
# for action/id/slug_name case
Router::connect('/products/:id/:slug', array('controller' => 'products', 'action' => 'view'), array('pass' => array('id','slug'), 'id' => '[0-9]+','slug'=>'[a-z_]+')); 
```

4) 我建议你在不使用 CakePHP 的 HTML 组件的情况下编写 url。不是因为它不好，而是因为它更快更容易

**而不是这样做**：

```
controller/action/param1:param_val1/param2:param_val2,
 echo $this->Html->link('Val', array('controller' => 'categories','action' => 'index', 'param1' => param_val1, 'param2' => param_val2,),array('escape' => false)); 
```

**这样做要好得多：**

```
controller/action/param_val1/param_val2

 echo 'controller/action/'.$param_val1.DS.$param_val2; 
```

也更适合 SEO，并且对 url 友好

# powershell - PowerShell查找商标

> ID：12827465
> 
> 赞同：1
> 
> 时间：2012-10-10T20:05:26.047
> 
> 标签：powershell, unicode

我正在尝试使用`Select-String`在 docx 文件中查找商标符号-符号的 Unicode 是`0x00AE`，但是正则表达式（在 RegExpal 中确实有效）`\u00AE`不起作用我只尝试了这个简单的事情：

```
Select-String -Path *.docx "\u00AE" 
```

我有点新手，将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:11:32.027

问题是`Select-String`（[文档）在](http://technet.microsoft.com/en-us/library/hh849903.aspx)*纯文本*文件中搜索字符串。

DOCX 文件*不是*纯文本，而是 ZIP 容器中的一堆 XML 文件。这是一个二进制文件，由于压缩，甚至不会包含文档文本中的字符。

您可能想要的是一个可以读取 OOXML 文档的库；然后，您将在库返回的文本中进行搜索。

特别是，查看Codeplex 上的[Power Tools for Open XML](http://powertools.codeplex.com/)项目中的[`Select-OpenXmlString`](http://openxmldeveloper.org/wiki/w/wiki/powertools-for-open-xml-2-0-cmdlets.aspx)命令。[这篇博文](http://blogs.msdn.com/b/ericwhite/archive/2009/03/19/announcing-the-release-of-powertools-for-open-xml-v1-1.aspx)给出了描述和使用示例：

> Select-OpenXmlString[...] 具有与 PowerShell 附带的 Select-String cmdlet 类似的功能。

特别是，要使用它来搜索类似的字符串`"\u00AE"`，

> 您可以使用 Select-OpenXmlString 的 –List 参数来检索具有特定内容的所有文档的列表。在这个目录中，我有很多 Open XML 文档，并且想找到所有提到法国的文档。
> 
> ```
> Select-OpenXmlString *.docx -simpleMatch France -List | Select-Object Filename 
> ```

# hibernate - 查询中的 Hibernate 3.2.1 和 EJBQL 查询

> ID：12827479
> 
> 赞同：1
> 
> 时间：2012-10-10T20:06:31.907
> 
> 标签：hibernate, ejb, ejbql

我正在尝试确保 hibernate 3.2.1 中的 EJBQL 功能支持以下功能，但是我的 google-fu 让我失望了。我只发现 EJB 2.x 不支持嵌套查询

我可以在这样的查询中输入查询：

```
select count(*) from 
    (select myField from myTable group by myField having sum(case.....) ....... ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:03:29.530

EBJQL 不支持`from`子句中的子查询（您可以在`select`and中使用它们`where`），因此无法执行此精确查询。您可以尝试重写查询，在您的情况下，以下内容应该是等效的：

```
select count(distinct e.myField) from myEntity e group by e.myField having ... 
```

或者，只需使用`createNativeQuery()`和使用您的原始查询，而无需在 HQL 中重写它。这当然会破坏便携性。

**提示**：如果您使用的是 Eclipse，请从[http://www.jboss.org/tools](http://www.jboss.org/tools)或市场获取 Hibernate 插件。它允许您直接从 IDE 编写和执行查询（请参阅Hibernate 工具文档中的[查询原型](http://docs.jboss.org/tools/latest/en/hibernatetools/html/plugins.html#d0e3241)）。其他 IDE 也可能具有类似的功能。

# sencha-touch-2 - 在 Sencha Touch 中无法查看以显示商店数据

> ID：12827481
> 
> 赞同：0
> 
> 时间：2012-10-10T20:06:55.310
> 
> 标签：sencha-touch-2

我正在尝试在 Sencha-Touch 2 中显示简单数据列表。由于某种原因，它没有显示数据，我无法弄清楚。我得到两个标题栏：带有“最近帖子”的正确标题和下面的空白标题。我不知道为什么会这样。也许这与显示器的其余部分相冲突？

```
Ext.define('GS.view.NewBlog',{
    extend: 'Ext.navigation.View',
    xtype: 'newblog',
    requires: [
        'Ext.dataview.List',
           'Ext.TitleBar'
    ],

config: {
    title: 'Blog',
    iconCls: 'star',
            items: {
                    docked: 'top',
                    xtype: 'titlebar',
                    title: 'Recent Posts'
            }, // end items
            store: {
                fields: ['title','author'],
                data: [
                    {title: 'This is the first Title', author: 'John Smith'},
                    {title: 'This is the second title', author: 'Jane Doe'}
                ] // end data
            } // end store

    }, // end config
itemTpl: '{title}' 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:12:43.960

您需要定义一个商店：

```
Ext.define('GS.store.Posts', {`

    extend: 'Ext.data.Store',`
    config: {
        data: [
            {
                title: 'This is the first Title',
                author: 'John Smith'
            },
            {
                title: 'This is the second title',
                author: 'Jane Doe'
            }
        ],
        storeId: 'Posts',
        fields: [
            {
                name: 'title'
            },
            {
                name: 'author'
            }
        ]
    }
}); 
```

使用 Store 定义具有列表的面板：

```
Ext.define('GS.view.NewBlog', {
    extend: 'Ext.Panel',
    alias: 'widget.NewBlog',

    config: {
        layout: {
            type: 'card'
        },
        items: [
            {
                xtype: 'toolbar',
                docked: 'top',
                title: 'Recent Posts'
            },
            {
                xtype: 'list',
                itemTpl: [
                    '<div>{title} - {author}</div>'
                ],
                store: 'Posts'
            }
        ]
    }

}); 
```

你的 app.js：

```
Ext.Loader.setConfig({
    enabled: true
});

Ext.application({
    stores: [
        'Posts'
    ],
    views: [
        'NewBlog'
    ],
    name: 'GS',

    launch: function() {

        Ext.create('GS.view.NewBlog', {fullscreen: true});
    }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:39:14.930

1.  标题栏显示两次，因为您使用的是 Ext.navigation.View，默认情况下有标题栏。您正在项目中添加一个标题栏。

2.  现在在一个项目中定义 store 和 itemtpl，在 config. 您可以单独定义商店并在商店中提及商店的 id。

    items : [{ xtype : 'list', store: '商店 id 放在这里，itemTpl: '{title}' }]

# twitter-bootstrap - Bootstrap - 在焦点上显示所有 Typeahead 项目

> ID：12827483
> 
> 赞同：21
> 
> 时间：2012-10-10T20:07:15.340
> 
> 标签：twitter-bootstrap, typeahead

当文本输入 (id="Questions") 获得焦点时，我想显示所有 Typeahead 项目。我该怎么做？

Javascript：

```
function SetTypeahead() {
    $("#Questions").typeahead({
        minLength: 0,
        source: [
                "Q1?",
                "Q2?",
                "Q3?",
                "@4?"
        ]
    });
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-19T00:13:38.703

[在https://raw.github.com/michaelcox/bootstrap/6789648b36aedaa795f1f5f11b4da6ab869f7f17/js/bootstrap-typeahead.js](https://raw.github.com/michaelcox/bootstrap/6789648b36aedaa795f1f5f11b4da6ab869f7f17/js/bootstrap-typeahead.js)获取最新的 bootstrap typeahead 插件 v2.1.2

此更新将允许 minLength 为零以启用 show all for typeahead

```
<input id="typeaheadField" name="typeaheadField" type="text" placeholder="Start Typing">

$("#typeaheadField").typeahead({
                        minLength: 0,
                        items: 9999,
                        source: ["Alabama","Alaska","Arizona","Arkansas","California","Colorado", "Oregon"]    
                    }); 
```

然后您必须将 onFocus 事件附加到您的元素，因为它不是由插件定义的：

```
$("#typeaheadField").on('focus', $("#typeaheadField").typeahead.bind($("#typeaheadField"), 'lookup')); 
```

如果结果太多，在本地覆盖 bootstrap typeahead css 类以设置结果的最大高度和垂直滚动也是一个好主意。

```
.typeahead {
max-height: 200px;
overflow-y: auto;
overflow-x: hidden;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-28T14:37:48.317

**从 Github**获取最新版本*( ***`bootstrap3-typeahead.js v4.0.2`***)脚本：[***下载***](https://raw.githubusercontent.com/bassjobsen/Bootstrap-3-Typeahead/master/bootstrap3-typeahead.min.js)*[](https://raw.githubusercontent.com/bassjobsen/Bootstrap-3-Typeahead/master/bootstrap3-typeahead.min.js)**

 ******html代码：***

```
<input data-provide="typeahead" id="q" type="text" value="" /> 
```

***工作 JavaScript：***

```
// autocomplete input text
$('#q').typeahead({
    // your json data source
    source: [your json or object here],
    // on click list option set as text value
    autoSelect: true,
    // set minlength 0 to show list on focus
    minLength: 0,
    // set no of items you want here
    items: 20,
    // set true if want to list option on focus
    showHintOnFocus: true
}); 
```

***官方文档：*** [Bootstrap-3-Typeahead](https://github.com/bassjobsen/Bootstrap-3-Typeahead)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-20T18:35:09.213

对我来说，$viewValue 在选择时为空，这会阻止列表显示。我的解决方案是在 $viewValue 为空时将过滤器设置为空字符串。

```
<input type="text"
  ng-model="gear.Value"
  uib-typeahead="gear as gear.Name for gear in gears | filter:$viewValue || ''"
  typeahead-show-hint="true"
  typeahead-min-length="0"
  typeahead-show-hint="true"
  typeahead-editable='false'
  typeahead-focus-first='false'
  class="form-control"
  name="gear"
  ng-required="true"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T19:38:05.193

在引导 github 上有一个解决方案： ~~[https ://github.com/twitter/bootstrap/pull/5063](https://github.com/twitter/bootstrap/pull/5063)~~

编辑：该链接已失效，请使用 Andrew 发布的链接：[https ://github.com/ptnplanet/Bootstrap-Better-Typeahead](https://github.com/ptnplanet/Bootstrap-Better-Typeahead)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-12T06:35:59.837

对我来说，工作代码如下所示：

```
var typeHeadField = $("#typeaheadField");
typeHeadField.typeahead({
                        minLength: 0,
                        items: 9999,
                        source: ["Alabama","Alaska","Arizona","Arkansas","California","Colorado", "Oregon"]    
                    });
typeHeadField.on('focus', function() {
 $(this).trigger('propertychange');
}); 
```

换句话说，只需`'propertychange'`在您想要的事件上触发事件。Typehead 自动完成功能将打开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-03T07:57:38.650

检查来自[theophraim 的 typeahead 的这个](https://github.com/theoephraim/typeahead.js)[pull request](https://github.com/twitter/typeahead.js/pull/390)，他已经包含了这个功能，但是它还没有被合并。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-29T10:27:38.103

这是我的解决方案：

*   初始化预输入

    $("#FinalGrades", context).typeahead({ minLength: 0, items: 10, scrollBar: true, source: finalGrades });

*   触发文本框事件

    ```
    $("#FinalGrades", context).on("keyup focus", function (e) {
        var that = $(this);
        if (that.val().length > 0 || e.keyCode == 40 || e.keyCode == 38) return;
        that.select();
        var dropDown = that.next('.dropdown-menu');
        dropDown.empty();
        $("#FinalGrades", context).val(qualificationNames[0]);
        that.trigger('keyup');
        $.each(finalGrades, function (index, value) {
            var item = '<li data-value="' + value + '" class=""><a href="#">' + value + '</a></li>';
            dropDown.append(item);
        });
        that.val('');
    }); 
    ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-14T09:54:14.063

在 typeahead github 上有一个关于它的已关闭问题，链接如下：[https ://github.com/twitter/typeahead.js/issues/462](https://github.com/twitter/typeahead.js/issues/462)

如 jharding 所述，您会发现：

> “typeahead.js 旨在补充由无限数据集提供支持的搜索框。这里提出的功能并不适合我们想要的 typeahead.js。”

尽管 pricey 之前的消息显示了如何实现它。

你也可以去获取更新的版本[https://github.com/bassjobsen/Bootstrap-3-Typeahead](https://github.com/bassjobsen/Bootstrap-3-Typeahead)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-23T08:22:19.697

typeahead的最后一个版本`v3.1.0`有一个明确的选项

```
showHintOnFocus:true 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-08T21:36:01.233

WORKS 对于 bootstrap-3-typeahead，最简单的方法就是模拟一个带有退格键（chr8）的键位。

```
$("#people_lookup").typeahead({
    source: people_list,
    minLength: 0
}).on('focus', function() {
    $(this).trigger(jQuery.Event('keyup', {which: 8}));
}); 
```***

# ios - 如何在 iOS 应用中使用 Facebook 实现登录

> ID：12827484
> 
> 赞同：2
> 
> 时间：2012-10-10T20:07:21.847
> 
> 标签：ios, facebook-graph-api, single-sign-on, facebook-ios-sdk

我想实现一个使用 FaceBook 登录进入应用程序的应用程序。我怎样才能做到这一点。我见过很少这样的指导方针 [https://developers.facebook.com/docs/howtos/login-with-facebook-using-ios-sdk/](https://developers.facebook.com/docs/howtos/login-with-facebook-using-ios-sdk/)

我想支持 iOS 3.0 及更高版本。但真的很困惑如何实现这一点。有人可以指出一些有用的教程吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:26:05.257

您正在寻找的是 Facebook 的 SSO（单点登录）。您可以使用[Facebook 代码](https://github.com/facebook/facebook-ios-sdk/tree/master/samples/HelloFacebookSample)作为起点。

您将很难支持 iOS 3.x，因为 Apple 不再支持它，使用新的 xCode，您可以提交 4.3 及更高版本的应用程序，因此请考虑您是否想将宝贵的时间浪费在大多数情况下不相关的东西上进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:23:45.320

您可以使用此代码 [http://www.raywenderlich.com/77/how-to-post-on-facebook-with-your-iphone-app](http://www.raywenderlich.com/77/how-to-post-on-facebook-with-your-iphone-app)

# ruby - 检查数组的任何元素是否满足条件

> ID：12827487
> 
> 赞同：33
> 
> 时间：2012-10-10T20:07:30.677
> 
> 标签：ruby

> **可能重复：**
> [检查值是否存在于 Ruby 中的数组中](https://stackoverflow.com/questions/1986386/check-if-value-exists-in-array-in-ruby)

我有这个方法，它遍历一个字符串数组，如果任何字符串包含字符串'dog'，则返回true。它正在工作，但多个返回语句看起来很乱。有没有更雄辩的方式来做到这一点？

```
def has_dog?(acct)
  [acct.title, acct.description, acct.tag].each do |text|
    return true if text.include?("dog")
  end
  return false
end 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-10T20:10:21.673

使用[Enumerable#any?](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-any-3F)

```
def has_dog?(acct)
  [acct.title, acct.description, acct.tag].any? { |text| text.include? "dog" }
end 
```

它将返回`true`/ `false`。

# java - Java Servlet 映射

> ID：12827488
> 
> 赞同：3
> 
> 时间：2012-10-10T20:07:34.030
> 
> 标签：java, servlets

## **小服务程序映射**

我是 java ee 6 的新手。我正在尝试获取 servlet 请求。除 /category 映射外，其他所有映射都可以正常工作。这是我的 ControllerServlet 类。我使用 @webServlet 注释进行映射。我尝试在 web.xml 中进行映射，但没有运气。使用 netbeans IDE 7.2，Server Glassfish 开源。

```
 import java.io.IOException;
    import java.io.PrintWriter;
    import javax.servlet.ServletException;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;

    @WebServlet(name = "ControllerServlet",
    loadOnStartup = 1,
    urlPatterns = {
    "/addToCart",
    "/viewCart",
    "/updateCart",
    "/checkout",
    "/purchase",
    "/chooseLanguage",
    "/category"})

    public class ControllerServlet extends HttpServlet {

/**
 * Handles the HTTP
 * <code>GET</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    String userPath = request.getServletPath();

    // if cart page is requested
    if (userPath.equals("/viewCart")) {
        userPath = "/cart";
    }

    //if category page is requested
    else if (userPath.equals("/category")) { 
    } 

    // if ckeckout page is requested
    else if (userPath.equals("/checkout")){
      //  System.out.println("check");

    }

    // if user switches language
    else if (userPath.equals("/chooseLanguage")){

    }

    // use RequestDispatcher to forward request internally

    String url = "/WEB-INF/View" + userPath + ".jsp";
    System.out.print(url);

    try{
        request.getRequestDispatcher(url).forward(request, response);
    }catch(Exception ex){
        ex.printStackTrace();
    }
}

/**
 * Handles the HTTP
 * <code>POST</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    String userPath = request.getServletPath();

    // if addToCart action is called
    if (userPath.equals("/addToCart")) {
        // TODO: Implement add product to cart action

    // if updateCart action is called
    } else if (userPath.equals("/updateCart")) {
        // TODO: Implement update cart action

    // if purchase action is called
    } else if (userPath.equals("/purchase")) {
        // TODO: Implement purchase action

        userPath = "/confirmation";
    }

    // use RequestDispatcher to forward request internally
    String url = "/WEB-INF/view" + userPath + ".jsp";

    try {
        request.getRequestDispatcher(url).forward(request, response);
    } catch (Exception ex) {
        ex.printStackTrace();
    }
}
} 
```

[链接到 web-inf 目录的图像](http://www.flickr.com/photos/50915041@N04/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:17:58.183

`/categories`未在您的 servlet 中映射。`/category` *然而被*映射。

# java - Java：从 8 位 wav 文件中检索字节数组并将其规范化为 -1.0 到 1.0

> ID：12827489
> 
> 赞同：2
> 
> 时间：2012-10-10T20:07:33.873
> 
> 标签：java, audio, bytearray, wav, waveform

请耐心等待，因为我对音频工作非常陌生，而且我已经在谷歌上搜索了好几天的解决方案，但没有找到任何解决方案。

所以我用这个检索 .wav 文件的字节数组（来源：[Wav 文件转换为 java 中的字节数组](https://stackoverflow.com/questions/10397272/wav-file-convert-to-byte-array-in-java)）

```
ByteArrayOutputStream out = new ByteArrayOutputStream();
BufferedInputStream in = new BufferedInputStream(new FileInputStream(WAV_FILE));

int read;
byte[] buff = new byte[1024];
while ((read = in.read(buff)) > 0)
{
     out.write(buff, 0, read);
}
out.flush();
byte[] audioBytes = out.toByteArray(); 
```

然后我将字节数组转换为浮点数组并将其从 -1.0 标准化为 1.0。（来源：[将 wav 音频格式字节数组转换为浮点数](https://stackoverflow.com/questions/6235016/convert-wav-audio-format-byte-array-to-floating-point)）

```
ShortBuffer sbuf =
ByteBuffer.wrap(audioBytes).order(ByteOrder.LITTLE_ENDIAN).asShortBuffer();
short[] audioShorts = new short[sbuf.capacity()];
sbuf.get(audioShorts);

float[] audioFloats = new float[audioShorts.length];
for (int i = 0; i < audioShorts.length; i++) {
    audioFloats[i] = ((float)audioShorts[i])/0x8000;
}
return audioFloats; 
```

后来我将其转换为使用 java.swing 输出波形的线条图

```
class Panel2 extends JPanel {
float[] audioFloats;

    Dimension d;
    public Panel2(Dimension d, float[] audioFloats) {
        // set a preferred size for the custom panel.
        this.d = d;
        setPreferredSize(d);
        this.audioFloats = audioFloats;
    }

    @Override
    public void paint(Graphics g) {
        //super.paintComponent(g);
        super.paint(g); 

        //shift by 45 because first 44 bytes used for header
        for (int i = 45; i<audioFloats.length; i++){

            Graphics2D g2 = (Graphics2D) g;
            float inc = (i-45)*((float)d.width)/((float)(audioFloats.length-45-1));
            Line2D lin = new Line2D.Float(inc, d.height/2, inc, (audioFloats[i]*d.height+d.height/2));
            g2.draw(lin);

        }

    }
} 
```

波形仅适用于 16 位 wav 文件（我与 goldwave 交叉检查，我的波形和它们的波形对于 16 位看起来都相似）。

我如何为 8 位 .wav 文件执行此操作？

因为这是为了家庭作业，我唯一的限制是逐字节读取 wav 文件。

我也知道 wav 文件是 PCM 编码的，并保留前 44 个字节作为标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:31:01.197

音频流通常与一个数据通道交错，然后是相反的数据通道。例如，前 16 位是左声道，接下来的 16 位是右声道。这些中的每一个都被认为是一帧数据。我会确保您的 8 位流只有一个通道，因为看起来这些方法只设置为读取一个通道。

同样在您的示例中，将您抓取单个通道的帧转换为一个短，然后通过将其除以 0x8000 十六进制或有符号短的最大值来找到一个小数。

```
short[] audioShorts = new short[sbuf.capacity()];
sbuf.get(audioShorts);
...
audioFloats[i] = ((float)audioShorts[i])/0x8000; 
```

我的猜测是，您需要将 8 字节流作为“字节”类型而不是短类型读取，然后将其除以 128 或有符号 8 位值的最大值。这将涉及制作一种全新的方法来处理 8 位流而不是 16 位流。进行以下更改。

```
byte[] audioBytes = new byte[sbuf.capacity()];
sbuf.get(audioBytes);
...
audioFloats[i] = ((float)audioBytes[i])/0x80; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:22:40.733

您需要修改这部分代码：

```
ShortBuffer sbuf =
  ByteBuffer.wrap(audioBytes).order(ByteOrder.LITTLE_ENDIAN).asShortBuffer();
short[] audioShorts = new short[sbuf.capacity()];
sbuf.get(audioShorts);

float[] audioFloats = new float[audioShorts.length];
for (int i = 0; i < audioShorts.length; i++) {
    audioFloats[i] = ((float)audioShorts[i])/0x8000;
} 
```

你根本不需要`ByteBuffer`——你已经有了你的字节数组。所以只需将其转换为浮点数：

```
float[] audioFloats = new float[audioBytes.length];
for (int i = 0; i < audioBytes.length; i++) {
    audioFloats[i] = ((float)audioBytes[i])/0x80;
} 
```

# iframe - 如何在 Metro 应用程序中从 Web 上下文（Iframe）发出 javascript 警报。

> ID：12827495
> 
> 赞同：2
> 
> 时间：2012-10-10T20:08:06.963
> 
> 标签：iframe, windows-8, alert

在我的地铁应用程序中..我正在使用 iframe 加载一个 Web 应用程序 - 基本上是一个包含一些控件的表单，最后用户点击完成按钮，我想显示警报

我知道在地铁应用程序中。我们可以使用“new Windows.UI.PopupMessage”来显示警报。但是我怎样才能从网络上下文（Iframe）中做同样的事情。

我在我的 default.js 中有一个函数 (showalert();)，我在其中使用“new Windows.UI.PopupMessage”来显示消息。如果我试图从 iframe 页面访问此功能，例如“window.parent.showalert();”。我得到异常说访问被拒绝。

请有人回复此问题，因为这对我来说非常重要。

谢谢和问候古瑟姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T05:29:51.743

您可以使用 HTML 5 的[postMessage](http://msdn.microsoft.com/en-us/library/ie/cc197015(v=vs.85).aspx)在上下文之间进行通信。

下面是一个简单示例的图像，后面有相关的代码片段；[Bing Maps 旅行优化器示例](http://code.msdn.microsoft.com/Bing-Maps-trip-optimizer-c4e037f7)在更大范围内使用了相同的技术。

![](../Images/12ae2375eef6b1b683209741fb4d6df0.png)

在本地上下文中运行的主页面（default.js）包括通过以下标记在 Web 上下文中加载的 IFRAME（我省略了未更改的 <head> 元素以节省空间）：

```
<body onload="localContext.onLoad();">
   <p style="margin-top: 150px">This is default.html in the local context</p>

   <div style="background-color: azure; width: 300px">
       <iframe src="ms-appx-web:///webpage.html" />
   </div>
</body> 
```

`localContext`在 default.js 中定义为

```
var localContext = {

    onLoad: function () {
        window.attachEvent("onmessage",
            function (msg) {
                if (msg.origin == "ms-appx-web://bfddc371-2040-4560-a61a-ec479ed996b0")
                    new Windows.UI.Popups.MessageDialog(msg.origin).showAsync().then();
            });
    } 
```

};

它为 default.html 定义了一个`onLoad`函数，该函数注册了事件的侦听器`onmessage`，并且当该事件触发时，会显示[MessageDialog](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.popups.messagedialog.aspx)（或者您可以在本地上下文中执行您想要执行的任何操作）。

请注意，`message`事件回调的参数（`msg`此处）还包括一个 origin 属性，您可以检查该属性以确保您只处理来自预期发件人的消息。

IFRAME 中托管的网页在按钮的事件处理程序中调用[postMessage](http://msdn.microsoft.com/en-us/library/ie/cc197015(v=vs.85).aspx)`onclick`（您可能希望将调用拉到单独的 .js 文件而不是内联文件）

```
<!DOCTYPE html>
<html>
    <head>
        <title></title>
    </head>
    <body>
        This is webpage.html loaded into an iFrame
        <button id="button" onclick="window.parent.postMessage('Hello from Web Context', '*');">Say Hello</button>
    </body>
</html> 
```

# sql - SCOPE_IDENTITY 在这种情况下有效吗？

> ID：12827496
> 
> 赞同：5
> 
> 时间：2012-10-10T20:08:08.200
> 
> 标签：sql, sql-server, ado.net, scope-identity

我有 PK 是自增键。我需要将记录插入数据库，然后取回该 PK 并在另一个插入中使用它。

但是我想在一笔交易中做到这一点。那可能吗。这个想法是，如果我必须做的任何更新/插入失败，那么我可以回滚所有内容，但我的印象是我需要进行提交。

起初我打算在 ado.net 中执行此操作，但后来切换到存储过程，因为我认为这可能会解决这个问题。

在这种情况下，SP 会帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T20:15:40.313

是的，scope_identity 会给你最新插入的 id。作为替代方案，如果您使用的是 sql server 2005+，则可以使用[output 子句](http://blogs.msdn.com/b/sqltips/archive/2005/06/13/output-clause.aspx)。

```
INSERT INTO [MyTable]([MyCol])
OUTPUT INSERTED.ID
SELECT [MyCol] FROM [MySourceTable]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T20:16:58.120

怎么样：

```
BEGIN TRANSACTION
BEGIN TRY

   INSERT INTO dbo.YourFirstTable(.....)
   VALUES(.......)

   DECLARE @newID INT
   SELECT @newID = SCOPE_IDENTITY()

   INSERT INTO dbo.YourSecondTable(ID, .......)
   VALUES(@newID, ........)

   COMMIT TRANSACTION
END TRY
BEGIN CATCH
    SELECT 
        ERROR_NUMBER() AS ErrorNumber,
        ERROR_SEVERITY() AS ErrorSeverity,
        ERROR_STATE() AS ErrorState,
        ERROR_PROCEDURE() AS ErrorProcedure,
        ERROR_LINE() AS ErrorLine,
        ERROR_MESSAGE() AS ErrorMessage

    ROLLBACK TRANSACTION
END CATCH 
```

应该可以在任何版本的 SQL Server **2005 或更高**版本中工作。

仅仅通过获取`SCOPE_IDENTITY()`值，您绝对**不会**“破坏”事务......将其包装到例如存储过程中，或者只是从您的调用代码中调用它。

# c# - Active Directory 公钥使用

> ID：12827499
> 
> 赞同：3
> 
> 时间：2012-10-10T20:08:17.307
> 
> 标签：c#, active-directory, ldap

我有一个客户需要使用 LDAP 验证登录到我的 Web 应用程序的用户是否针对他的活动目录。在尝试使用 DirectoryEntry 和 DirectorySearcher .NET 类进行连接时，我可以连接到他的 AD 服务器，但不能访问它。

客户的 AD 服务器有一个 SSL 证书，他给了我一个公钥文件，但我不知道如何在我的 C# 代码中使用这个公钥文件。

当我通过代码发出连接命令时，我通过 Wireshark 看到我的应用程序正在发送连接请求。然后我看到服务器以“Server Hello，Certificate，Certificate Request，Server Hello Done”响应。然后我的应用程序在那之后再也没有响应。

在使用由其他人编写但我没有代码的另一个应用程序时，我看到来自服务器的相同请求，然后看到应用程序以“证书，客户端密钥交换”响应，然后应用程序连接并运行。

话虽如此，我的问题就变成了，我怎样才能让我的 C# 应用程序加载并发送我从客户端获得的密钥文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:34:42.477

密钥文件需要安装到用户机器/用户帐户中。

看看以下内容，了解如何安装数字证书...

见步骤 3...

[http://msdn.microsoft.com/en-us/library/ff649247.aspx](http://msdn.microsoft.com/en-us/library/ff649247.aspx)

步骤 3\. 请求并安装客户端证书

此过程安装客户端证书。您可以使用来自任何证书颁发机构的证书，也可以使用 Microsoft 证书服务生成您自己的证书，如以下部分所述。

此过程假定 Microsoft 证书服务已针对未决请求进行配置，这需要管理员明确颁发证书。它还可以配置为自动颁发证书以响应证书请求。

检查证书请求状态设置

在 Microsoft 证书服务计算机上，从管理工具程序组中选择证书颁发机构。展开证书颁发机构（本地），右键单击证书颁发机构并单击属性。单击策略模块选项卡，然后单击配置。检查默认操作。以下过程假定将证书请求状态设置为待处理。管理员必须明确颁发证书被选中。

请求客户端证书

启动 Internet Explorer 并导航到 http://hostname/certsrv，其中 hostname 是安装 Microsoft 证书服务的计算机的名称。单击请求证书，然后单击下一步。在选择请求类型页面上，单击用户证书，然后单击下一步。单击提交以完成请求。关闭 Internet Explorer。颁发客户端证书

从管理工具程序组中，启动证书颁发机构工具。展开您的证书颁发机构，然后选择 Pending Requests 文件夹。选择您刚刚提交的证书请求，指向“操作”菜单上的“所有任务”，然后单击“问题”。确认证书显示在已颁发证书文件夹中，然后双击它进行查看。在详细信息选项卡上，单击复制到文件以将证书保存为 Base-64 编码的 X.509 证书。关闭证书的属性窗口。关闭证书颁发机构工具。安装客户端证书

要查看证书，请启动 Windows 资源管理器，导航到在上一个过程中保存的 .cer 文件，然后双击它。单击安装证书，然后单击证书导入向导第一页上的下一步。选择根据证书类型自动选择证书存储，然后单击下一步。单击完成以完成向导。关闭确认消息框，然后单击“确定”关闭证书。步骤 4\. 验证客户端证书操作

此过程验证您是否可以使用客户端证书访问 SecureApp 应用程序。

验证客户端证书操作

启动 Internet Explorer 并导航到 http s://localhost/secureapp/webform1.aspx。确认网页显示成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T11:55:28.687

如何导出或导入 PKCS#12 证书？

PKCS#12 文件可以由许多应用程序导入和导出，包括 Microsoft IIS。它们通常与文件扩展名 .pfx 相关联。

要创建 PKCS#12 证书，您需要一个私钥和一个证书。在转换过程中，您将有机会在证书上输入“导出密码”（可以为空，如果您选择）。

# 创建一个包含密钥和自签名证书的文件

openssl req \ -x509 -nodes -days 365 \ -newkey rsa:1024 -keyout mycert.pem -out mycert.pem

# 将 mycert.pem 导出为 PKCS#12 文件 mycert.pfx

openssl pkcs12 -export \ -out mycert.pfx -in mycert.pem \ -name "My Certificate" 如果有人向您发送 PKCS#12 和使用它所需的任何密码，您可以将其导出为标准 PEM 格式。

# 导出证书和无密码密钥

openssl pkcs12 -in mycert.pfx -out mycert.pem -nodes

# 与上面相同，但系统会提示您输入密码

# 私钥

openssl pkcs12 -in mycert.pfx -out mycert.pem

# ruby-on-rails - 安装 fcgi 时出现 Rails 错误：无法构建 gem 原生扩展

> ID：12827502
> 
> 赞同：5
> 
> 时间：2012-10-10T20:08:31.910
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在运行命令

```
bundle install 
```

在我的 Rails 项目上，它给出了错误：

```
...
Using activerecord (3.0.11) 
Using activeresource (3.0.11) 
Using bigdecimal (1.1.0) 
Installing fcgi (0.8.8) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

    /home/jjboat/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb 
checking for fcgiapp.h... no
checking for fastcgi/fcgiapp.h... no
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-10T20:25:38.520

您需要安装 fcgi 开发包才能构建本机扩展（并且您还必须在此之前安装 C 构建链）。您尚未在此处指定您的发行版，但在 Red Hat（以及 Fedora 等衍生产品）上，您通常会这样做：

```
sudo yum install fcgi-devel 
```

在 Debian（和 Ubuntu）上，你可以这样做：

```
sudo apt-get install libfcgi-dev 
```

我不能 100% 确定 Debian 中的软件包名称，但您应该很容易弄清楚。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-19T12:39:39.277

如果您在 MacOS X 上使用 fcgi gem 遇到同样的错误（在 10.7.5 上测试）。您可以使用 homebrew ( [http://mxcl.github.com/homebrew/](http://mxcl.github.com/homebrew/) ) 获取所需的开发包：

```
brew install fcgi 
```

然后你应该准备好安装gem了：

```
gem install fcgi -v '0.8.8' 
```

# .htaccess - URL 重写：非重定向但改变 url

> ID：12827505
> 
> 赞同：0
> 
> 时间：2012-10-10T20:08:46.793
> 
> 标签：.htaccess, url

我已经为 url 重写配置了我的 .htaccess 文件。我只是使用 [L] 标志，没有 [R] 标志作为规则。当我在我的浏览器中测试它时，页面被调用但是......出现了参数 url。这当然是我不想要的。

我的 .htaccess 文件：

```
RewriteEngine on
RewriteRule ^testing/([0-9a-zA-z_-]+)/([0-9a-zA-z_-]+)$ http://localhost/testing/index.php?a=$1&b=$2 [L] 
```

是因为我在本地主机上测试它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T23:13:10.847

当您使用带有 FQDN 的 URL 时，它会自动重定向，这仅仅是因为为了`http://localhost/...`在 URL 文件映射处理管道的末尾将 URI 重写到处理程序的内部，无论如何都会重定向（使用 302）。您需要为目标选择本地路径，或者如果它与正在处理请求的服务器/虚拟主机位于不同的位置，请使用以下`P`标志：

指向服务器/虚拟主机的本地 URI：

```
RewriteRule ^testing/([0-9a-zA-z_-]+)/([0-9a-zA-z_-]+)$ /testing/index.php?a=$1&b=$2 [L] 
```

使用`P`标志代理请求：

```
RewriteRule ^testing/([0-9a-zA-z_-]+)/([0-9a-zA-z_-]+)$ http://localhost/testing/index.php?a=$1&b=$2 [L,P] 
```

# python - Python + Cherrypy - 为什么变量'outp'没有改变值？

> ID：12827509
> 
> 赞同：1
> 
> 时间：2012-10-10T20:09:06.213
> 
> 标签：python, cherrypy

以下行为是python固有的问题（如果引发异常，则无法更改循环内变量的值）还是cherrypy的问题（​​如果HTTPRedirect异常，则无法更改循环内变量的值被提出）？我正在尝试将“outp”的值从“ORIGINAL”更改为“NEWVALUE”。

我将以下代码片段作为名为“Root(object)”的类中的方法运行（突出显示打印语句以便于阅读）：

```
@cherrypy.expose
def tester(self, cancel=False, submit=False, clear=False, **data):
    outp = "ORIGINAL"        
    if cherrypy.request.method == 'POST':
        print outp                  ############ FIRST PRINT STATEMENT ##########
        if True:
            outp = "NEWVALUE"
            print outp + '1'        ############ SECOND PRINT STATEMENT #########
            raise cherrypy.HTTPRedirect('/tester')
    print outp + '2'                ############ THIRD PRINT STATEMENT ##########

    tmpl = loader.load('tester.html')
    stream = tmpl.generate(outp=outp)
    return stream.render('html', doctype='html') 
```

我收到以下输出：

```
ORIGINAL
NEWVALUE1
127.0.0.1 - - [10/Oct/2012:15:45:33] "POST /tester HTTP/1.1" 303 102  
"http://localhost:8080/tester" "Mozilla/5.0 (X11; Linux x86_64; rv:10.0.7) 
Gecko/20120829 Firefox/10.0.7"
ORIGINAL2 
```

outp 的值仅在 if 语句内发生变化。如果我注释掉异常引发“raise cherrypy.HTTPRedirect('/tester')”：

```
@cherrypy.expose
def tester(self, cancel=False, submit=False, clear=False, **data):
    outp = "ORIGINAL"        
    if cherrypy.request.method == 'POST':
        print outp                ############ FIRST PRINT STATEMENT ##########
        if True:
            outp = "NEWVALUE"
            print outp + '1'      ############ SECOND PRINT STATEMENT #########
            #raise cherrypy.HTTPRedirect('/tester')
    print outp + '2'              ############ THIRD PRINT STATEMENT ##########

    tmpl = loader.load('tester.html')
    stream = tmpl.generate(outp=outp)
    return stream.render('html', doctype='html') 
```

我收到以下输出：

```
ORIGINAL
NEWVALUE1
NEWVALUE2 
```

我不一定要寻找深入的答案，只是想知道这是 Python 引起的行为还是 Cherrypy 引起的行为。我无法通过将代码片段转换为它自己的 Python 脚本来模仿这种行为，因此有迹象表明这是一个 Cherrypy 问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:26:41.023

Python，主要是。HTTPRedirect 与任何 Python 异常一样，会暂停函数的执行。HTTPRedirect 本质上是告诉客户端发出另一个 HTTP 请求，这将再次运行该函数，而不会从中断的地方继续。异常不是循环：每次运行该函数时，该函数的任何本地变量都是新的。

# wordpress - wordpress 安装必须具有哪些权限才能安全但功能正常？

> ID：12827513
> 
> 赞同：1
> 
> 时间：2012-10-10T20:09:12.720
> 
> 标签：wordpress, security, ubuntu, permissions

我已经阅读了[http://codex.wordpress.org/Hardening_WordPress](http://codex.wordpress.org/Hardening_WordPress)但我无法理解它。应设置哪些权限以及由谁拥有？现在我已经设置为以下命令的结果：

```
# reset to safe defaults
find /usr/share/wordpress -exec chown www-data:www-data {} \;
find /usr/share/wordpress -type d -exec chmod 755 {} \;
find /usr/share/wordpress -type f -exec chmod 644 {} \;

# allow wordpress to manage wp-config.php (but prevent world access)
chgrp www-data /usr/share/wordpress/wp-config.php
chmod 660 /usr/share/wordpress/wp-config.php

# allow wordpress to manage .htaccess
chgrp www-data /usr/share/wordpress/.htaccess
chmod 664 /usr/share/wordpress/.htaccess

# allow wordpress to manage wp-content
find /usr/share/wordpress/wp-content -exec chgrp www-data {} \;
find /usr/share/wordpress/wp-content -type d -exec chmod 775 {} \;
find /usr/share/wordpress/wp-content -type f -exec chmod 664 {} \; 
```

完成此配置后，安装将无法使用。有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:39:48.220

以下是我如何管理服务器权限的快速回顾：

*   任何人都可以读取文件和目录
*   没有人可以在 /wp-content/uploads 目录之外写*任何东西*
*   PHP 脚本*无法*在 /wp-content/uploads 目录中执行
*   PHP 脚本*不能*直接在 /wp-includes 和 /wp-content 中执行

因此，谁拥有 .php 文件并不重要，只要 apache 用户可以读取它们即可。允许 apache 用户修改这些文件是有风险的，即使是 .htaccess。所有这些的缺点是您需要为 WordPress 提供 FTP 凭据来执行安装或删除插件、更新主题或核心等操作。这是我可以忍受的。

# python - 如何获取受 SQL Alchemy 影响的行数？

> ID：12827519
> 
> 赞同：5
> 
> 时间：2012-10-10T20:09:30.193
> 
> 标签：python, mysql, sqlalchemy, pyramid, flask-sqlalchemy

如何使用 sqlalchemy 获取更新语句受影响的行数？（我正在使用 mysql 和 python/金字塔）：

```
from sqlalchemy.engine.base import ResultProxy

@classmethod
def myupdate(cls, id, myvalue):
    DBSession.query(cls).filter(cls.id == id).update({'mycolumn': myvalue})
    if ResultProxy.rowcount == 1:
        return True
    else:
        return False 
```

注意：我看到了[这篇文章](https://stackoverflow.com/questions/702342/how-to-get-number-of-affected-rows-in-sqlalchemy)，但根据[文档](http://docs.sqlalchemy.org/en/rel_0_7/core/connections.html#sqlalchemy.engine.base.ResultProxy.rowcount)：“'rowcount' 报告了与 UPDATE 或 DELETE 语句的 WHERE 标准匹配的行数。”....换句话说，它不返回数字*受*更新或删除语句影响的行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:58:18.463

[根据文档](http://docs.sqlalchemy.org/en/rel_0_7/dialects/mysql.html#rowcount-support)，您可以通过为 DBAPI 指定正确的选项来覆盖此行为。

我没有准备好测试的 mysql，但我认为将正确的选项（`client_flag`或者`found_rows=False`取决于使用的 api）添加到配置 url 应该可以解决问题。检查[mysqlconnector](https://bitbucket.org/sqlalchemy/sqlalchemy/src/b4fdcb0c3303/lib/sqlalchemy/dialects/mysql/mysqlconnector.py?at=default#cl-96)和[oursql](https://bitbucket.org/sqlalchemy/sqlalchemy/src/b4fdcb0c3303/lib/sqlalchemy/dialects/mysql/oursql.py?at=default#cl-219)的相应来源以获取更多信息。

我希望这足以帮助你。

# database - 比 Oracle Database Union 更快的选择

> ID：12827525
> 
> 赞同：2
> 
> 时间：2012-10-10T20:10:00.130
> 
> 标签：database, performance, oracle, oracle10g, union

我有一个表，其中包含多个存储文本值的列。例如：

```
ID    FATHER_NAME    MOTHER_NAME
--------------------------------
1     Henry          Sarah
2     Martin         Rebecca
3     Martin         Nancy 
```

我想获取表中的所有名称。我知道我可以做一个工会来做到这一点：

```
(SELECT FATHER_NAME FROM MY_TABLE)
UNION
(SELECT MOTHER_NAME FROM MY_TABLE) 
```

但是，在我的真实表中，我需要合并 15 列，并且查询显然需要一段时间（大约 12 秒）。而且我仍然需要对这些名称进行连接，等等。除了联合之外还有其他选择吗？

仅供参考：我正在使用 Oracle。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T20:24:45.713

如果您使用的是 Oracle 11g，则可以使用以下`UNPIVOT`功能：

```
select id, value, col
from yourtable
unpivot
(
  value for col in (FATHER_NAME, MOTHER_NAME) -- other columns will go here
) u; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/86f7d/4)

或者你可以使用`UNION ALL`而不是`UNION`不同的是你不会得到`DISTINCT`值：

```
select id, FATHER_NAME value, 'FATHER_NAME' col
from yourtable
union all
select id, MOTHER_NAME value, 'MOTHER_NAME' col
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/86f7d/3)

由于`UNION`它试图获取`DISTINCT`值，它可能会更慢。

# c - 如何找出图像中的直线

> ID：12827526
> 
> 赞同：2
> 
> 时间：2012-10-10T20:09:59.523
> 
> 标签：c, perl, matlab, image-processing, imagemagick

我有一个图像文件。（jpg 或 png）

这只有 4 种颜色和几条黑线。（600px X 600px 图像大小）。可以有 2 或 4 或 6 条黑线。

我需要得到每条黑线的 (x1, y1) 和 (x2, y2) 。

可以用perl或c或matlab实现

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T20:13:06.713

尝试应用[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)。它在检测线条时特别有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T14:17:49.983

检测图像中线条的一种简单方法是计算[图像梯度](http://en.wikipedia.org/wiki/Image_gradient)。

为此计算 x 或 y 方向的梯度（取决于线的方向），然后对梯度进行阈值化以找出是否存在黑线。

# php - API 需要 SSH 密钥，这通常是如何完成的？

> ID：12827527
> 
> 赞同：0
> 
> 时间：2012-10-10T20:10:01.970
> 
> 标签：php, api, ssl, curl

我希望使用 Mobile Roadie API（我对平台有想法，但不适合这里）。[http://mobileroadie.com/dev/speakers/create](http://mobileroadie.com/dev/speakers/create)您会注意到它需要 SSH 并且密钥必须在 url 中。示例键是`4d4ba30d73b77f7`如何使用 PHP 创建该键？他们（Mobile Roadie）是否必须收到我认为的特定密钥？但是如何将私钥发送给他们呢？

我还假设这个 SO 问题的改编会做：[Generate SSH keypair form PHP](https://stackoverflow.com/questions/6648337/generate-ssh-keypair-form-php)

我是 cURL 的新手，我很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:15:08.467

创建帐户时，您将获得所需的密钥。你不是自己创造的。

# http - iframe 中的字符编码

> ID：12827528
> 
> 赞同：3
> 
> 时间：2012-10-10T20:10:04.917
> 
> 标签：http, browser, character-encoding

我有一个以 ISO-8859-1 编码的文本文件。如果您[在 Google Chrome 中查看它](http://nickretallack.com/experiments/encoding/iframed/content.txt)，它会正确显示。但是，如果你[iframe 它](http://nickretallack.com/experiments/encoding/iframed/)，它看起来是错误的。此外，它在 Firefox 中看起来总是错误的。

我注意到在各种不同的服务器和浏览器上都有同样的行为。但是，如果我使用 Google Chrome 并在同一台机器上运行服务器和浏览器，则 iframe 的内容会正确显示。

我应该怎么做才能使文件在所有情况下都正确显示？看起来浏览器应该能够弄清楚，但在许多情况下它无法做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:17:16.783

您正在使用 提供文件`Content-Type: text/plain`，这相当于要求浏览器猜测。显然，并非每种情况都会导致相同的猜测。

将其设置为`Content-Type: text/plain; charset=iso-8859-1`。

# android - 在适配器和对话框中查看

> ID：12827534
> 
> 赞同：0
> 
> 时间：2012-10-10T20:10:23.633
> 
> 标签：android, view, dialog, adapter

在我的应用程序中，我有一个`Adapter`可以扩展的`BaseAdapter`. 在那个类里面有方法

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View view = convertView;
    if (view == null) {
      view = lInflater.inflate(R.layout.childitem, parent, false);
    }

    Product p = getProduct(position);

    ((TextView) view.findViewById(R.id.tvDescr)).setText(p.name);
    ((TextView) view.findViewById(R.id.tvPrice)).setText(p.price + "");
    ((ImageView) view.findViewById(R.id.ivImage)).setImageResource(p.image);

    CheckBox cbBuy = (CheckBox) view.findViewById(R.id.cbBox);

    cbBuy.setOnCheckedChangeListener(myCheckChangList);

    cbBuy.setTag(position);

    cbBuy.setChecked(p.box);
    return view;
} 
```

在`MainActivity`我的应用程序中，我尝试使用 custom`AlertDialog`和两个`EditText`s 进行输入。它无法正常工作，并且已获得`View`用于访问我的资源的建议。

```
void newItemInput(){

    AlertDialog.Builder builder = new AlertDialog.Builder(this);

    LayoutInflater inflater = this.getLayoutInflater();

    final View v = inflater.inflate(R.layout.dialog_signin, null);

    builder.setView(v);

    builder.setTitle("");
    builder.setMessage("");

    builder.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int whichButton) {

            EditText item_name = (EditText) v.findViewById(R.id.item_name);
            EditText item_price =(EditText) v.findViewById(R.id.item_price);

            String text = item_name.getText().toString();
            String text_price = item_price.getText().toString();
            int price = Integer.parseInt(text_price);

            // Do something with value!
            products.add(new Product(text, price, R.drawable.unread, false));

            item_name.setText("");
            item_price.setText("");

        }
    }); 
```

`Dialog`现在，当我在以下语句中插入数据以将其用作参数时： products.add(new Product(text, price, R.drawable.unread, false)); ...它的行为方式很奇怪。是否因为`View`适配器调用和对话框之间的矛盾而发生？如果是这样，可以做些什么来解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:07:51.537

当您对适配器维护的数据进行任何更改时，您需要调用适配器的[notifyDataSetChanged](http://developer.android.com/reference/android/widget/ArrayAdapter.html#notifyDataSetChanged%28%29)方法。这将通知附加视图数据已更改，它应该自行刷新。您注意到的奇怪行为是因为这是在向列表中添加新项目的过程中调用的，而不是在添加项目之后调用的。

可以在此处找到有关使用适配器的更多信息：http: [//developer.android.com/guide/topics/ui/declaring-layout.html#AdapterViews](http://developer.android.com/guide/topics/ui/declaring-layout.html#AdapterViews)

# ios - Xcode 在 UITableRowSelection 之后显示 UIAlertView？

> ID：12827536
> 
> 赞同：0
> 
> 时间：2012-10-10T20:10:37.197
> 
> 标签：ios, cocoa-touch, uitableview, uialertview

这是我的第一个问题，如果有问题请见谅

好吧，我正在尝试创建一个视图，在该视图中我可以从表格视图中选择一个朋友，然后它应该在 UIAlertView 上显示数字和邮件，但我不知道如何做到这一点，朋友列表是从 xml 文件中获取的在我的网站上，然后解析并显示在具有自定义单元格设计的表格上

这是创建每个单元格的代码

```
- (UITableViewCell *)tableView:(UITableView *)myTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = (UITableViewCell *)[self.messageList dequeueReusableCellWithIdentifier:@"ContactListItem"];
    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"ContactListItem" owner:self options:nil];
        cell = (UITableViewCell *)[nib objectAtIndex:0];
    }

    NSDictionary *itemAtIndex = (NSDictionary *)[messages objectAtIndex:indexPath.row];
    UILabel *userLabel = (UILabel *)[cell viewWithTag:2];
    userLabel.text = [itemAtIndex objectForKey:@"user"];

    return cell;
} 
```

谢谢圣地亚哥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:19:44.677

您必须实现该`didSelectRowAtIndexPath:`方法。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
  NSDictionary *itemAtIndex = (NSDictionary *)[messages objectAtIndex:indexPath.row];
  NSString *name = [itemAtIndex objectForKey:@"user"];
  NSString *email = [itemAtIndex objectForKey:@"email"];
  NSString *phone = [itemAtIndex objectForKey:@"phone"];
  NSString *messageStr = [NSString stringWithFormat:@"Email : %@\nPhone : %@", email, phone];

  UIAlertView *alert = [[UIAlertView alloc] initWithTitle:name message:messageStr delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
  [alert show];   
  [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:15:53.247

-(void)tableView:(UITableView*)tableView didSelectRowAtIndexPath 是您需要实现的方法。这是假设您在其中呈现表视图的视图是表视图的委托。

```
-(void)tableView:(UITableView*)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     //Alert view logic happens here getting all the cell information
} 
```

# asp.net - 查询字符串模块加密不起作用

> ID：12827540
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:11:02.937
> 
> 标签：asp.net, .net, vb.net, iis, encryption

[我使用此处](http://madskristensen.net/post/HttpModule-for-query-string-encryption.aspx)提供的示例对我的项目进行了查询字符串加密。

当我在本地运行项目时，它工作正常：

![在此处输入图像描述](../Images/bf7006aa1063f46a7eab931b5b575c63.png)

但是当我将它发布到我的服务器时，加密根本不起作用。服务器上的应用程序在 Windows Server 2008 R2 和 IIS 7 上运行。

也许我必须在 IIS 上进行一些更改？我没有任何线索。任何人？

谢谢你。

编辑：这是 QueryStringModule 类的代码：

```
Imports System
Imports System.IO
Imports System.Web
Imports System.Text
Imports System.Security.Cryptography

''' <summary>
''' Summary description for QueryStringModule
''' </summary>
Public Class QueryStringModule
    Implements IHttpModule

#Region "IHttpModule Members"

    Sub Init(context As HttpApplication) Implements System.Web.IHttpModule.Init
        AddHandler context.BeginRequest, AddressOf context_BeginRequest
    End Sub

    Sub Dispose() Implements System.Web.IHttpModule.Dispose
        ' Nothing to dispose
    End Sub

#End Region

    Private Const PARAMETER_NAME As String = "enc="
    Private Const ENCRYPTION_KEY As String = "key"

    Private Sub context_BeginRequest(sender As Object, e As EventArgs)
        Dim context As HttpContext = HttpContext.Current
        If context.Request.Url.OriginalString.Contains("aspx") AndAlso context.Request.RawUrl.Contains("?") Then
            Dim query As String = ExtractQuery(context.Request.RawUrl)
            Dim path As String = GetVirtualPath()

            If query.StartsWith(PARAMETER_NAME, StringComparison.OrdinalIgnoreCase) Then
                ' Decrypts the query string and rewrites the path.
                Dim rawQuery As String = query.Replace(PARAMETER_NAME, String.Empty)
                Dim decryptedQuery As String = Decrypt(rawQuery)
                context.RewritePath(path, String.Empty, decryptedQuery)
            ElseIf context.Request.HttpMethod = "GET" Then
                ' Encrypt the query string and redirects to the encrypted URL.
                ' Remove if you don't want all query strings to be encrypted automatically.
                Dim encryptedQuery As String = Encrypt(query)
                context.Response.Redirect(path + encryptedQuery)
            End If
        End If
    End Sub

    ''' <summary>
    ''' Parses the current URL and extracts the virtual path without query string.
    ''' </summary>
    ''' <returns>The virtual path of the current URL.</returns>
    Private Shared Function GetVirtualPath() As String
        Dim path As String = HttpContext.Current.Request.RawUrl
        path = path.Substring(0, path.IndexOf("?"))
        path = path.Substring(path.LastIndexOf("/") + 1)
        Return path
    End Function

    ''' <summary>
    ''' Parses a URL and returns the query string.
    ''' </summary>
    ''' <param name="url">The URL to parse.</param>
    ''' <returns>The query string without the question mark.</returns>
    Private Shared Function ExtractQuery(url As String) As String
        Dim index As Integer = url.IndexOf("?") + 1
        Return url.Substring(index)
    End Function

#Region "Encryption/decryption"

    ''' <summary>
    ''' The salt value used to strengthen the encryption.
    ''' </summary>
    Private Shared ReadOnly SALT As Byte() = Encoding.ASCII.GetBytes(ENCRYPTION_KEY.Length.ToString())

    ''' <summary>
    ''' Encrypts any string using the Rijndael algorithm.
    ''' </summary>
    ''' <param name="inputText">The string to encrypt.</param>
    ''' <returns>A Base64 encrypted string.</returns>
    Public Shared Function Encrypt(inputText As String) As String
        Dim rijndaelCipher As New RijndaelManaged()
        Dim plainText As Byte() = Encoding.Unicode.GetBytes(inputText)
        Dim SecretKey As New PasswordDeriveBytes(ENCRYPTION_KEY, SALT)

        Using encryptor As ICryptoTransform = rijndaelCipher.CreateEncryptor(SecretKey.GetBytes(32), SecretKey.GetBytes(16))
            Using memoryStream As New MemoryStream()
                Using cryptoStream As New CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write)
                    cryptoStream.Write(plainText, 0, plainText.Length)
                    cryptoStream.FlushFinalBlock()
                    Return "?" + PARAMETER_NAME + Convert.ToBase64String(memoryStream.ToArray())
                End Using
            End Using
        End Using
    End Function

    ''' <summary>
    ''' Decrypts a previously encrypted string.
    ''' </summary>
    ''' <param name="inputText">The encrypted string to decrypt.</param>
    ''' <returns>A decrypted string.</returns>
    Public Shared Function Decrypt(inputText As String) As String
        Dim rijndaelCipher As New RijndaelManaged()
        Dim encryptedData As Byte() = Convert.FromBase64String(inputText)
        Dim secretKey As New PasswordDeriveBytes(ENCRYPTION_KEY, SALT)

        Using decryptor As ICryptoTransform = rijndaelCipher.CreateDecryptor(secretKey.GetBytes(32), secretKey.GetBytes(16))
            Using memoryStream As New MemoryStream(encryptedData)
                Using cryptoStream As New CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read)
                    Dim plainText As Byte() = New Byte(encryptedData.Length - 1) {}
                    Dim decryptedCount As Integer = cryptoStream.Read(plainText, 0, plainText.Length)
                    Return Encoding.Unicode.GetString(plainText, 0, decryptedCount)
                End Using
            End Using
        End Using
    End Function

#End Region

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-15T11:49:54.263

是的，这是一个 ISS 配置问题。

ISS 5 或 6 的 web.config 应包含 <httpModules> 标记，如[madskristensen.net](http://madskristensen.net/post/httpmodule-for-query-string-encryption)上所述。

```
<system.web>
    <httpModules>
         <add type="QueryStringModule" name="QueryStringModule"/>
    </httpModules>
</system.web> 
```

如果您的 Web 应用程序在 IIS 7 上运行，则设置应位于：

```
<system.webServer>
    <modules>
        <add type="QueryStringModule" name="QueryStringModule"/>
    </modules>
</system.webServer> 
```

此解决方案也在[此处](http://aspnetcodebehind.wordpress.com/2010/06/30/how-to-encrypt-and-decrypt-query-string/)进行了描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:28:09.293

我刚刚找到了一个解决方案： 1-在服务器上打开 IIS；2-选择所需的网站；3-选择模块；4-右键单击然后“添加托管模块”；5-为其命名，然后在下拉列表中找到您要添加的模块；6-重置 IIS。

# mysql - 试图弄清楚如何正确地为数据集编写选择

> ID：12827542
> 
> 赞同：1
> 
> 时间：2012-10-10T20:11:05.837
> 
> 标签：mysql, database

```
table:
--duedate timestamp
--submissiondate timestamp
--blocksreq numeric
--file clob
--email varchar2(60) 
```

每个条目都是一个文件，需要 blocksreq 来完成。每天分配 8 个区块（但可以稍后修改）。在我插入表格之前，我想确保在 NOW() 和 @duedate 的时间范围内有足够的块来完成它

我正在考虑以下内容，但我认为我做错了：

```
R1 = select DAY(), @blocksperday - sum(blocksreq) as free 
     from table 
     where @duedate between NOW() and @duedate 
     group by DAY() 
     order by DAY() desc

R2 = select sum(a.free) from R1 as a;

if(R2[0] <= @blocksreq){ insert into table; } 
```

请原谅部分伪代码。

SQL FIDDLE： [http ://sqlfiddle.com/#!2/5bda5](http://sqlfiddle.com/#!2/5bda5)

**警告：我的 sql fiddle 有垃圾代码......因为我不知道如何制作很多测试用例。也不将到期日期设置为 NOW()+5 天**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:13:50.793

像这样的东西？（不确定如何处理部分天数，所以忽略了那部分）

```
CREATE TABLE `DatTable` (
  `duedate` datetime DEFAULT NULL,
  `submissiondate` datetime DEFAULT NULL,
  `blocksreq` smallint(6) DEFAULT NULL
) 

SET @duedate:='2012-10-15';
SET @submissiondate:=CURRENT_TIMESTAMP;
SET @blocksreq:=5;

INSERT INTO DatTable(duedate,submissiondate,blocksreq)
SELECT @duedate,@submissiondate,@blocksreq
FROM DatTable AS b
WHERE duedate > @submissiondate
HAVING COALESCE(SUM(blocksreq),0) <= DATEDIFF(@duedate,@submissiondate)*8-@blocksreq; 
```

# typescript - TypeScript 中的私有静态属性

> ID：12827544
> 
> 赞同：24
> 
> 时间：2012-10-10T20:11:17.433
> 
> 标签：typescript

如果我在下面做这样的事情，我怎样才能在课堂上访问该属性？

```
class Person
{
    private static name: string;
}

console.log(Person.name); 
```

不是应该无法访问吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-10T20:17:27.293

这应该是一个错误，但不是。从规范，第 8.2.1 节：

> 不可能指定静态变量的可访问性——它们实际上总是公开的。

静态的可访问性修饰符是团队过去考虑过的。如果你有一个强大的用例，你应该在[codeplex](http://typescript.codeplex.com)网站上提出这个！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-16T20:52:21.237

```
class Person
{
    private static theName: string = "John";
    static get name():string{
        return Person.theName;
    }
}

console.log(Person.name); 
```

如果静态属性是私有的，我们需要提供静态 get 方法来访问它。这可能不是一个常见的解决方案，但它是我所知道的直接访问私有静态属性的唯一方法。另一方面，如果您还打算从实例化对象访问属性，则可能必须添加第二个 get 方法。两个 get 方法可以具有相同的名称，因为静态 get 方法对实例化对象是不可见的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-20T14:38:33.787

嗯，不是真的，事实上你可以。也许最重要的是询问它相关的 TypeScript*版本*。我有**v1.5 beta**，我的 VS2012 安装的一部分（是的，尽管它是针对 VS2013 的，但它仍然有效）。

我有这样的课：

```
class ItemListPreProcessor {

    private static names: string[] = [ 'Name', 'Age' ];

    static createHeader = (eltName: string) => {
        var pdiv = $(eltName);
        pdiv.html('<table><thead><tr></tr></thead></tr><tbody></tbody></table>');
        var row = $('tr', pdiv);
        ItemListPreProcessor.names.forEach((n) => {
            row.append('<th>' + n + '</th>');
        });
        return $('tbody', pdiv);
    };
} 
```

在上面的示例中，您可以同时看到`private`和`static`。该类被编译为以下 JavaScript：

```
var ItemListPreProcessor = (function () {
    function ItemListPreProcessor() {
    }
    ItemListPreProcessor.names = ['Name', 'Age'];

    ItemListPreProcessor.createHeader = function (eltName) {
        var pdiv = $(eltName);
        pdiv.html('<table><thead><tr></tr></thead></tr><tbody></tbody></table>');
        var row = $('tr', pdiv);
        ItemListPreProcessor.names.forEach(function (n) {
            row.append('<th>' + n + '</th>');
        });
        return $('tbody', pdiv);
    };
    return ItemListPreProcessor;
})(); 
```

编译它（你看到的）和执行它（你应该相信这个，或者，如果你愿意，试试）都没有问题。

# python - 使用 oauth2 通过 googleapi gmail python 发送电子邮件

> ID：12827548
> 
> 赞同：5
> 
> 时间：2012-10-10T20:11:32.570
> 
> 标签：python, smtp, gmail, google-api, oauth-2.0

我正在尝试使用 OAuth 2 以用户身份发送电子邮件。在 Google 的网站上[，他们声明](https://developers.google.com/google-apps/gmail/xoauth2_protocol#the_sasl_xoauth2_mechanism)：

> 本文档定义了与 IMAP AUTHENTICATE 和 SMTP AUTH 命令一起使用的 SASL XOAUTH2 机制。此机制允许使用 OAuth 2.0 访问令牌对用户的 Gmail 帐户进行身份验证。

使用他们提供的测试`oauth2.py`

```
smtp_conn = smtplib.SMTP('smtp.gmail.com', 587)
smtp_conn.set_debuglevel(True)
smtp_conn.ehlo('test')
smtp_conn.starttls()
smtp_conn.docmd('AUTH', 'XOAUTH2 ' + base64.b64encode(auth_string)) 
```

您可以在其中测试是否可以使用提供的访问令牌连接到他们的 smtp 服务器，它会成功，但是当我尝试使用发送电子邮件时`sendmail`失败。

如果我添加`smtp_conn.sendmail('from@test.com', 'to@test.com', 'msg')`它说我需要进行身份验证。

从文档中，当我发送`AUTH`带有所需身份验证字符串的命令时，我没有进行身份验证吗？

谢谢。

更新***

所以很明显，如果我在 try catch 语句的 catch 中重新进行身份验证，它会起作用..有什么想法吗？

```
try:
    smtp_conn.sendmail('fromt@test.com', 'to@test.com', 'cool')
except:
    smtp_conn.docmd('AUTH', 'XOAUTH2 ' + base64.b64encode(auth_string))
    smtp_conn.sendmail('from@test.com', 'to@test.com', 'cool') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T04:29:03.653

在 starttls 之后你需要另一个 ehlo 调用。所以：

```
 smtp_conn = smtplib.SMTP('smtp.gmail.com', 587)
    smtp_conn.set_debuglevel(True)
    smtp_conn.ehlo()
    smtp_conn.starttls()
    smtp_conn.ehlo()
    smtp_conn.docmd('AUTH', 'XOAUTH2 ' + base64.b64encode(auth_string)) 
```

# jquery - 用于spring表单绑定的jquery动态表单元素

> ID：12827559
> 
> 赞同：1
> 
> 时间：2012-10-10T20:12:27.180
> 
> 标签：jquery, spring, spring-mvc, spring2.x

我面临着使用 jquery 在 JSP 中动态绑定弹簧表单元素的问题。我正在尝试将动态行添加到具有不同表单元素的表中。演示：http: [//jsfiddle.net/ninadhere/f7ZdK/](http://jsfiddle.net/ninadhere/f7ZdK/)

这里的问题是新添加的表单元素具有 id 和 name 属性作为“userName[0]1”而不是“userName[1]”，因此它们没有绑定到 spring 表单。我正在使用 AbstractWizardController 并尝试在 Step1 上绑定用户的动态列表，然后在 Step2 中使用它们。

他们是一种系统地克隆表单元素（如下拉列表、复选框和文本）的方法。

有人可以指导我正确使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:14:55.620

克隆元素时传递 true 将使用克隆的元素复制所有事件。

来自[http://api.jquery.com/clone/](http://api.jquery.com/clone/)

> .clone( [withDataAndEvents] ) withDataAndEvents 一个布尔值，指示是否应将事件处理程序与元素一起复制。从 jQuery 1.4 开始，元素数据也将被复制。

替换id的整数值：

```
 id.replace(/\[\d*\]$/, "["+ i +"]")// will replace 'userName[0]' with userName[{i}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T05:53:41.633

在它非常棘手之前我已经执行过这样的事情，您需要在将动态表单字段绑定到弹簧模型时全神贯注。

请参考这个[链接](https://stackoverflow.com/questions/10614718/how-to-validate-dynamically-generated-fields-server-side)

虽然我的问题不同，但我在问题中输入的代码可能是您的答案。:)

希望这对您有所帮助。

# wcf - 调用具有许多参数的 SOAP 服务的更简单方法？

> ID：12827560
> 
> 赞同：0
> 
> 时间：2012-10-10T20:12:30.870
> 
> 标签：wcf, soap

我的网络服务生锈了，所以我希望我只是遗漏了一些明显的东西。

我有一个 WCF 服务，它部分地将它接收到的调用中继到第三方 SOAP 服务。该服务接收一个与需要发送的 SOAP 消息的正文相匹配的对象。

我已将基于 SOAP 服务的 WSDL 的服务引用添加到项目中，并创建了服务代理类的实例。我要调用的服务方法有 30 多个参数。

我可以用 调用它`MyService.TheMethod(obj.value1, obj.value2, obj.value3...)`，但最好只传递原始对象或 XML 序列化它并将 XML 作为正文传递。

有什么可以允许更简单的方法还是我需要单独将 obj 的属性传递给 SOAP 方法？

**更新**

澄清根本问题。

我的 .NET 服务接受一些“组”

```
public class Person { string Name; int Age;}
public class Group { string Name; Person[] Individuals; } 
```

然后我需要调用第三方 Web 服务 (TPWS)。从 WSDL 生成的代理类最终如下：

```
public class WSPerson { string Name; uint Age;}
public class WSGroup { string Name; WSPerson[] Individuals; } 
```

我一直在做早期的原型设计，并通过 SoapUI 使用 TPWS，并使用与我的原始（.NET）类的命名匹配的标签：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ws="http://ws.myabc123.com" xmlns:ns="http://schemas.datacontract.org/2004/07/" xmlns:sys="http://schemas.datacontract.org/2004/07/System" xmlns:arr="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
   <soapenv:Header>
      <ws:ServiceCredentials>
         <ws:SubscriberId>ABC</ws:SubscriberId>
         <ws:SubscriberUser>Joe</ws:SubscriberUser>
         <ws:SubscriberPassword>12345</ws:SubscriberPassword>
         <!--Optional:-->
         <ws:SubscriberIdentityStore></ws:SubscriberIdentityStore>
      </ws:ServiceCredentials>
   </soapenv:Header>
   <soapenv:Body>
    <Group>
      <Name>Cool People</Name>
      <Individuals>
        <Person>
          <Name>Tom</Name>
          <Age>25</Age>
        </Person>
        <Person>
          <Name>Jane</Name>
          <Age>27</Age>
        </Person>
      </Individuals>
    </Group>
   </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:22:20.080

没有简单的方法可以做你想做的事。如果你调用的服务有 30 个参数，你只需要用 30 个参数调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T14:35:45.747

也许这会帮助其他人。我正在追求[通过 HTTP POST 调用 Web 服务](http://forums.asp.net/t/928000.aspx)的想法。

原因是这个普遍的问题会以类似的方式一遍又一遍地重复。我控制传入的数据契约和第 3 方映射工具最终期望的 XML 格式。但它会为服务生成自己的合同。如果它可以识别我可以通过 XmlSerializer 生成的原始 XML，我就不必映射我的类来让第 3 方工具依次执行它自己的映射功能。

# ruby-on-rails - Rails：未定义的方法'（MODELNAME）'？

> ID：12827571
> 
> 赞同：0
> 
> 时间：2012-10-10T20:13:34.123
> 
> 标签：ruby-on-rails

嗨，我目前正在制作一个用于上传图片的网络应用程序。有用户、相册和照片。当我尝试编辑用户的个人资料信息时，我无法弄清楚发生了什么。它告诉我在 UsersController#update 中有一个未定义的方法 'album' NoMethodError ，但我什至没有在我的 #update 操作中调用专辑。

```
def update
  respond_to do |format|
    if current_user.update_attributes(params[:user])
      format.html { redirect_to current_user, notice: 'User successfully updated.'}
      format.json { render json: current_user, status: :created, location: current_user }
    else
      format.html { render action: 'edit' }
      format.json { render json: current_user.errors, status: :unprocessable_entity }
    end
  end
end 
```

该错误特别是在我的更新操作的第 2 行和第 3 行。这是错误：

`app/controllers/users_controller.rb:45:in 'block in update'`

`app/controllers/users_controller.rb:44:in`更新'`

有谁知道这到底是怎么回事？

为用户编辑表单

```
<%= form_for(@user) do |f| %>

<div class="formhold">
<div class="field">
    <% if @user.profilepic? %>
    <%= image_tag @user.profilepic.url %>
    <% end %>

    <%= f.label :profilepic, "Profile Picture" %>
    <%= f.file_field :profilepic %>
</div>
<div class="field">
    <%= f.label :name %>
    <%= f.text_field :name %>
</div>
<div class="field">
    <%= f.label :email %>
    <%= f.text_field :email %>
</div>

<div>
    <%= f.submit 'Submit', :class => 'submitbutton' %>
</div>

<% if @user.errors.any? %>
    <div id="error_exp">
        <h2><%= pluralize(@user.errors.count, "error") %> occurred.</h2>

        <ul>
        <% @user.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
        <% end %>
        </ul>
    </div>

    </div>
<% end %>
<% end %>

<%= link_to "Back", user_path(@user) %> 
```

用户模型

```
class User < ActiveRecord::Base

has_secure_password
attr_accessible :email, :name, :password, :password_confirmation, :profilepic
validates_presence_of :password, :on => :create

validates_format_of :name, :with => /[A-Za-z]+/, :on => :create
validates_format_of :email, :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i, :on => :create
validates_length_of :password, :minimum => 5, :on => :create
validates :album, :uniqueness => true

has_many :album_users
has_many :albums, :through => :album_users
accepts_nested_attributes_for :albums

has_many :friendships, :dependent => :destroy
has_many :friends, :through => :friendships, :conditions => "status = 'accepted'"
has_many :requested_friends, :through => :friendships, :source => :friend, :conditions => "status = 'requested'", :order => :created_at
has_many :pending_friends, :through => :friendships, :source => :friend, :conditions => "status = 'pending'", :order => :created_at

has_attached_file :profilepic

before_save { |user| user.email = email.downcase }

def name_with_initial
  "#{name}"
end

private

  def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:20:32.570

尝试注释掉：

```
validates :album, :uniqueness => true 
```

假设 :album 是用户的属性/方法并且失败。您应该根据您的业务逻辑处理相册模型中相册的唯一验证。您可以基于`user_id`或其他一些属性来验证它们`:scope => [:user_id]`

# optimization - AS2 优化代码

> ID：12827572
> 
> 赞同：1
> 
> 时间：2012-10-10T20:13:42.430
> 
> 标签：optimization, actionscript, actionscript-2

我正在尝试在我的代码中实现日志记录机制。我在一些论坛中读到，在 AS2 中，字符串连接不会在编译时发生，而是在运行时发生。

我想知道以下哪个代码更优化：

```
for (var i:Number = 0; i < n; i++ )
{
    var strToReplace:String = "{" + i + "}";
} 
```

或者，

```
for (var i:Number = 0; i < n; i++ )
{
    var strToReplace:String = "{%s}".split("%s").join(String(i));
} 
```

非常感谢您的帮助，因为就 AS2 而言，我是新手。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T08:41:19.957

这是一个简单的测试方法：

```
var n:Number = 100000;

var beforeTime:Number = getTimer();

for (var i:Number = 0; i < n; i++ ) {
  var strToReplace:String = "{" + i + "}";
}

var betweenTime:Number = getTimer();
trace("between : " + (betweenTime - beforeTime));

for (var i:Number = 0; i < n; i++ ) {
  var strToReplace:String = "{%s}".split("%s").join(String(i));
}

var afterTime:Number = getTimer();
trace("after : " + (afterTime - betweenTime)); 
```

我在痕迹中得到了什么：

*   之间：269
*   之后：866

第一种方法快 3 倍：split 和 join 方法必须在你的字符串中搜索才能执行。

如果您的字符串更大，则差异更大：第一个方法持续时间不会改变......第二个需要更多时间。你应该试试。

# linux - 是否可以将命令的输出从服务器传输到本地计算机？

> ID：12827574
> 
> 赞同：0
> 
> 时间：2012-10-10T20:13:47.367
> 
> 标签：linux, bash, shell, unix, ssh

我有一系列由我的学校提供​​的功能相同的服务器，它们运行各种操作系统和硬件配置。在大多数情况下，我可以交替使用其中的 5 个。不幸的是，其他学生倾向于聚集在一些机器上，找到没有陷入困境的机器很痛苦。

我想要的是 ssh 进入一台机器，运行命令：

```
w | wc -l 
```

粗略估计该服务器上的负载，并使用该信息选择受影响最小的服务器。一种客户端负载均衡器。

有没有办法做到这一点或达到相同的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:57:38.803

我会把这个放在你的`.bashrc`档案上

```
function choose_host(){
hosts="host1 ... hostn"
for host in $hosts
do
  echo $(ssh $host 'w|wc -l') $host
done | sort | head -1 | awk '{print $2}'
}

function ssh_host(){
  ssh $(choose_host)
} 
```

`choose_host`应该给你你正在寻找的那个。这绝对是矫枉过正，但我​​觉得好玩 :D `sort`将根据结果排序输出`w|wc -l`，然后`head -1`获取第一行并`awk`打印主机名！你可以打电话`ssh_host`，应该自动记录你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:19:55.117

您可以使用桌面上的[pdsh](http://linux.die.net/man/1/pdsh)命令，该命令在您指定的一组机器上运行指定的命令并返回结果。通过这种方式，您可以找出负载最少的那个。这将避免您`ssh`对每台机器执行操作并运行`w | wc -l`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:37:46.427

是的。参见例如：

```
ssh me@host "ls /etc | sort" | wc -l 
```

里面的部分`""`是远程完成的。之后的部分是本地的。

# sql-server - 如何从存储过程中捕获特定的异常类型？

> ID：12827575
> 
> 赞同：1
> 
> 时间：2012-10-10T20:13:53.413
> 
> 标签：sql-server, sql-server-2008, exception, exception-handling, cursor

我正在编写一个存储过程，它遍历服务器上的所有数据库，并用来自**一些**不同数据库的数据聚合填充一个表变量。有些数据库我不感兴趣，因为它们无关紧要。问题是当我的 CURSOR 遍历那些我不关心的数据库时，会在不存在的表上发出 SELECT 语句。如何忽略`Invalid object name`异常并继续处理？

**编辑**：

以下是我试图跳过不相关的数据库的方式：

```
DECLARE db_cursor CURSOR FOR

SELECT name
FROM MASTER.dbo.sysdatabases
WHERE name NOT IN ('master','model','msdb','tempdb') 

OPEN db_cursor 

FETCH NEXT FROM db_cursor INTO @currentDatabaseName  

WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @sql = 'SELECT COUNT(Name) FROM ' + @currentDatabaseName + '.sys.Tables WHERE Name = ''SomeTableICareAbout'''

        INSERT INTO @tableSearchResult
        EXEC sp_executesql @sql

        SET @tableCount = (SELECT COUNT(*) FROM @tableSearchResult WHERE TableCount = 1)

        --If the table I care about was found, then do the good stuff
        IF @tableCount > 0
            ... 
```

这种方法的问题是，如果执行用户（在我的情况下是服务帐户）无权访问表上的 SELECT，那么我永远不会知道该错误。如果用户没有 SELECT 访问权限，我希望引发该异常。但是，即使用户没有 SELECT 访问权限，它也可以在 sys.Tables 视图上进行 SELECT。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T20:54:38.893

您无法直接捕获错误 208，因为它是在编译时和代码实际执行之前引发的名称解析错误。该行为已[记录在案](http://msdn.microsoft.com/en-us/library/ms175976.aspx)：有关解释，请参阅名为“不受 TRY...CATCH 构造影响的错误”的部分，并且该问题的答案[有](https://stackoverflow.com/questions/4556304/what-is-wrong-with-my-try-catch-in-t-sql)一些有趣的评论。

除了文档中的“解决方案”，还可以使用动态SQL；在此示例中将捕获错误：

```
begin try
    exec('select * from dbo.ThisTableDoesNotExist');
end try
begin catch
    select error_number();
end catch; 
```

如果您要遍历所有数据库，那么您很有可能在某处使用动态 SQL，因此这可能更适合您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T14:02:04.970

如果您在存储过程中执行此操作，则可以捕获错误（此处记录的示例：http: [//msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

你也可以改变你的动态sql来做这样的事情

```
SET @sql = '
        If Exists(Select Name From  ' + @currentDatabaseName + '.sys.Tables 
            WHERE Name = ''SomeTableICareAbout'')' --+
        --Add Whatever the Good Stuff is
EXEC sp_executesql @sql 
```

但是首先检查表是否存在，而不是从表中执行 select count(1)，将防止引发该错误。

# php - 如何编写 RegEx 从 PHP 中的数组中提取字符串

> ID：12827577
> 
> 赞同：-3
> 
> 时间：2012-10-10T20:14:02.110
> 
> 标签：php, regex, arrays, extract

如何使用正则表达式从该数组中提取书名和书价。

```
$bookList = array('PHP and MySQL Web Development (4th Edition)' => 49.95,
          'Learning PHP, MySQL, and JavaScript' => 37.33,
          'Beginning PHP and MySQL: From Novice to Professional' => 23.56,
          'Head First PHP & MySQL' => 64.35); 
```

正则表达式是提取函数的最佳方法吗？

```
function getBookName($bookList)
{
$bookRegEx = '';
$matchResult = array();
if (preg_match($bookRegEx, $bookList, $matchResult)) 
{
    return intval($matchResult[0]);
}
else
{
    return 0;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:19:19.970

我不会在这里使用正则表达式。这实际上取决于您希望如何使用您构建的数组。我已经阅读了如何使用 PHP 数组。

[http://www.php.net/manual/en/book.array.php](http://www.php.net/manual/en/book.array.php)可能是您想要开始的地方。

# unit-testing - 模拟框架中的模拟与间谍活动

> ID：12827580
> 
> 赞同：159
> 
> 时间：2012-10-10T20:14:17.220
> 
> 标签：unit-testing, mocking, tdd

在模拟框架中，您可以*模拟*一个对象或*监视*它。两者之间有什么区别，我什么时候/应该使用一个而不是另一个？

例如，查看[Mockito ，我看到使用](https://site.mockito.org/)*spies*和*mocks*完成了类似的事情，但我不确定两者之间的区别。

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2012-10-10T20:22:02.437

模拟对象完全替换模拟类，返回记录或默认值。您可以“凭空”创建模拟。这是单元测试期间最常用的。

进行间谍活动时，您获取现有对象并仅“替换”某些方法。当您有一个庞大的类并且只想模拟某些方法（部分模拟）时，这很有用。让我引用[Mockito 文档](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#13)：

> 您可以创建真实对象的间谍。当您使用 spy 时，会调用**真正**的方法（除非方法被存根）。
> 
> 真正的间谍应该**小心谨慎地偶尔**使用，例如在处理遗留代码时。

如有疑问，请使用模拟。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-10-19T19:14:04.723

我将尝试在这里使用示例进行解释：

```
// Difference between mocking, stubbing and spying
@Test
public void differenceBetweenMockingSpyingAndStubbing() {
    List list = new ArrayList();
    list.add("abc");
    assertEquals(1, list.size());

    List mockedList = spy(list);
    when(mockedList.size()).thenReturn(10);
    assertEquals(10, mockedList.size());
} 
```

在这里，我们有初始的真实对象`list`，我们在其中添加了一个元素，并且预期大小为 1。

我们*窥探*真实对象，这意味着我们可以指示要*存根*的方法。所以我们声明我们存根方法 -`size()`在将返回 10 的*spy 对象*上，无论实际大小是多少。

简而言之，您将*窥探* **真实对象**并*存根* **某些方法**。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-01-17T19:04:15.887

Mockito 警告说，部分模拟不是一个好的做法，您应该修改您的面向对象架构。*建议使用间谍*（或部分模拟）来测试*遗留代码*。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-09-03T11:27:53.787

在 Mockito 中，如果您将任何对象分配给 Mock Object 的实例变量，则不会影响 Mock Object。

但是在 Spy 的情况下，如果您将任何对象分配给 Spy Object 的实例变量，那么确实会影响 Spy 对象，因为 Spy 就像实时对象修改一样。

**作为参考示例是**

```
@RunWith(MockitoJUnitRunner.class)
public class MockSpyExampleTest {

    @Mock
    private List<String> mockList;

    @Spy
    private List<String> spyList = new ArrayList();

    @Test
    public void testMockList() {
        //by default, calling the methods of mock object will do nothing
        mockList.add("test");
        assertNull(mockList.get(0));
    }

    @Test
    public void testSpyList() {
        //spy object will call the real method when not stub
        spyList.add("test");
        assertEquals("test", spyList.get(0));
    }
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-12-16T21:36:49.180

基于**Martin Fowler**的[Mocks Aren't Stubs](https://martinfowler.com/articles/mocksArentStubs.html)：

 **> **虚拟**对象被传递但从未实际使用过。通常它们仅用于填充参数列表。
> 
> **假**对象实际上有工作实现，但通常采取一些捷径，这使得它们不适合生产（内存数据库就是一个很好的例子）。
> 
> **存根**为测试期间拨打的电话提供预设答案，通常根本不响应任何超出测试程序的内容。
> 
> **间谍**是存根，它还根据调用方式记录一些信息。其中一种形式可能是电子邮件服务，它记录发送了多少消息。
> 
> **模拟**就是我们在这里讨论的内容：预先编程的对象具有期望，这些期望形成了它们期望接收的调用的规范。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-10-21T07:24:24.517

参考：http: [//javapointers.com/tutorial/difference-between-spy-and-mock-in-mockito/](http://javapointers.com/tutorial/difference-between-spy-and-mock-in-mockito/)

当使用模拟对象时，方法在非存根时的默认行为是什么都不做。简单的意思是，如果它是一个 void 方法，那么当你调用该方法时它什么也不做，或者如果它是一个有返回值的方法，那么它可能返回 null、空或默认值。

当然，在 spy 对象中，由于它是一个真实的方法，当您没有对方法进行存根时，它会调用真实的方法行为。如果要更改和模拟该方法，则需要对它进行存根。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-19T19:55:21.537

间谍有两个定义。一个是调用真实方法的地方，另一个是不调用任何功能并且只返回 null 或 null 等效值的地方，但是调用了方法，并且记录了它们的状态，通常就像方法 x 被调用了 y 次。**

# html - 如何让我的搜索栏在所有屏幕上正确对齐。（和操作系统）

> ID：12827585
> 
> 赞同：0
> 
> 时间：2012-10-10T20:14:25.957
> 
> 标签：html, css, operating-system, screens

如何让我的搜索栏在所有屏幕上正确对齐。（和操作系统）

到目前为止，她是我的代码，当我在运行 Ubuntu（12.04.1）的笔记本电脑上打开我的[网站](http://www.eurobytes.nl/)
时，当我在运行 Windows 7 的工作桌面上打开我的网站时，我的搜索栏对齐完美，我的搜索栏对齐
不完美。

HTML 4.01（通过了 w3c 标准测试（我还添加了导航栏的代码，因为我的搜索栏在导航栏内`div`））

```
<ul id="nav">
<li><a href="index.html"><img src="images/home.gif" title="Home" alt="Home"><b><font color="red">Home</font></b></a></li>
<li><a href="linux.html"><img src="images/linux_logo.gif" title="Linux" alt="Linux" height="18" width="18">Linux</a></li>
<li><a href="learn.html"><img src="images/brain.gif" title="Brain" alt="Brain" height="18" width="18">Learn</a></li>
<li><a href="../tutorials/top-games-for-ubuntu.html"><img src="images/game.png" width="18" height="18" title="Games" alt="Games">Games</a></li>
<li><a href="about.html"><img src="images/corneillie-black-red.jpg" title="about" alt="about" height="18" width="18">About</a></li>

<li id="eurobytes-search" title="Eurobytes search">
<form action="/sphider-1.3.5/search.php" method="get" class="search" style="width: 100%;height: 100%;"> 
<input name="query" id="query" size="20" onblur="if(this.value == '') { this.value = 'search' }" onfocus="if(this.value == 'search') { this.value = '' }" value="search" class="search" type="text">
<input name="search" value="1" type="hidden">
<a href="/sphider-1.3.5/search.php?adv=1" title="Advanced Search" style=" 
    background-color:#F5F5F5;  
    border-right: 0px; 
    display: inline;
    font-weight: normal;
    padding: 0px 0px;
    text-decoration: none;
    font-size: 16px;
    vertical-align:baseline;
    text-transform: uppercase;">Advanced Search</a>
<input style="display:inline; width: 30%; height: 23px;    border-color: #CCCCCC;
    border-style: solid;
    border-width: 1px;
    font-size: 100%;
    vertical-align:baseline;
    color:#000000;" value="search" type="submit" >
</form>
</li>
</ul> 
```

CSS3（搜索栏和导航栏）

```
#nav {
    background-color: #F2F2F2;
    border-bottom: 1px solid #CCCCCC;
    border-top: 1px solid #CCCCCC;
    float: left;
    height: 100%;
    list-style: none outside none;
    margin: 0;
    padding: 0;
    width: 100%;
}

#nav li {
    float: left;
}

#nav li a {
    border-right: 1px solid #CCCCCC;
    color: #006699;
    display: block;
    font-weight: bold;
    padding: 14px 15px;
    text-decoration: none;
    text-transform: uppercase;
}

#nav li a:hover {
    background-color: #FFFFFF;
    color: #CC0000;
}

#eurobytes-search {
    color: #CDCDCD;
    float: right;
    height: 100%;
    padding: 0;
    text-align: right;
    width: 244px;
}

#query {
    border-color: #CCCCCC;
    border-style: solid;
    border-width: 1px;
    font-size: 16px;
    height: 23px;
    width: 99%;
} 
```

为了简化我的问题，如何`input`在所有屏幕和操作系统上为我的命令提供相同的宽度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:40:47.513

在输入中使用像素尺寸，而不是百分比，然后使用`float:right`. 您需要在此元素之后清除浮动。

此外，您需要对他们使用基于列表的菜单的方式进行现代化改造。您应该在 A 标记上使用 CSS 背景图像，而不是内联图像。`Font`标签是绝对禁止的。将 CSS 用于外部样式表中的所有样式。内联样式是错误的形式。

查看我的教程：[我喜欢列表](http://preview.moveable.com/jm/ilovelists/)

# linux - 如何从 /usr/src/linux build 创建 /usr/src/linux-headers-$KVERS

> ID：12827588
> 
> 赞同：0
> 
> 时间：2012-10-10T20:14:38.263
> 
> 标签：linux, kernel, debian

我为**Ubuntu Lucid**制作了一个定制的 linux 内核和一个能够分发它的 live ISO。

但我不想在发行版中包含完整的 Linux 源代码，只包含头文件，以便可以安装和更新内核包，例如 VirtualBox 来宾添加。有没有办法从源代码树自动创建标题？

# android - Android：Http 响应 - 保存到文件 UTF8 编码

> ID：12827589
> 
> 赞同：1
> 
> 时间：2012-10-10T20:14:48.957
> 
> 标签：android, json, encoding, utf-8, gson

我已经阅读了很多主题，但到目前为止，它们都没有帮助。我正在尝试下载和解析包含一些 UTF8 字符的 JSON。除了对这些语法进行编码外，一切都很好。请你帮助我好吗？

```
HttpGet request = new HttpGet(uri);
HttpResponse resp = client.execute(request);
entity = resp.getEntity();
fos = context.openFileOutput(fileSavePath, Context.MODE_PRIVATE); //fos is FileOutputStream
entity.writeTo(fos);
entity.consumeContent();
fos.flush();
fos.close(); 
```

然后我像这样打开文件：

```
stream = context.openFileInput(AppConfig.CATEGORIES_JSON_PATH);
reader = new InputStreamReader(stream, StringUtils.UTF8); 
```

我相信 gson 的东西是正确的，只有打开和保存文件才重要。我也相信错误在于 entity.writeTo(fos);，因为没有指定编码。所以我尝试用字节缓冲区和OutputStreamWriter编写，但随后gson抛出了MalformedJsonException：未终止的字符串......

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T10:41:40.660

问题自己解决了。尽管在查找 sqlite 数据库时，字符不正确，但在应用程序中看起来一切正常。

# c - 计算字符串中出现的单词

> ID：12827590
> 
> 赞同：3
> 
> 时间：2012-10-10T20:14:50.137
> 
> 标签：c, algorithm, count

我正在尝试计算字符串中出现的单词。对于字符串 S，我需要显示每个单词以及该单词在字符串中出现的次数。

示例：

```
string = ";! one two, tree foor one two !:;" 
```

结果：

```
one: 2
two: 2
tree: 1
foor: 1 
```

这是我的代码，但它没有返回正确的计数：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int count_word(char * mot, char * text) {
  int n = 0;
  char *p;

  p = strstr(text, mot);

  while (p != NULL) {
    n++;
    p = strstr(p + 1, mot);
  }  

  return n;
}

void show_all_words(char * text) {
    char * p = strtok(text, " .,;-!?");

    while (p != NULL) {
      printf ("%s : %d\n", p, count_word(p, text));
      p = strtok(NULL, " .,;-!?");
    }
}

int main(char *argv[]) {

    char text[] = ";! one two, tree foor one two !:;";
    show_all_words(&text);

    return (EXIT_SUCCESS);
}; 
```

它回来了：

```
one : 1
two : 0
tree : 0
foor : 0
one : 1
two : 0
: : 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:22:00.190

该函数`strtok`更改其参数。您可以通过复制字符串、调用`strtok`一个副本和`count_word`另一个来解决问题。

另外，请注意不要将同一单词的计数输出两次。

```
int count_word(char * mot, char * text, int offset) {
  int n = 0;
  char *p;

  p = strstr(text, mot);
  assert(p != NULL);
  if (p - text < offset)
      return -1; // if the word was found at an earlier offset, return an error code 

  while (p != NULL) {
    n++;
    p = strstr(p + 1, mot);
  }  

  return n;
}

void show_all_words(char * text) {
    char *text_rw = strdup(text); // make a read-write copy to use with strtok
    char * p = strtok(text_rw, " .,;-!?");

    while (p != NULL) {
      int offset = p - text; // offset of the word inside input text
      int count = count_word(p, text, offset);
      if (count != -1) // -1 is an error code that says "already looked at that word"
          printf ("%s : %d\n", p, count );
      p = strtok(NULL, " .,;-!?");
    }
    free(text_rw); // delete the copy
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:25:48.017

你应该改变方法。您可以使用一个数组来存储每个单词第一次出现的索引和出现次数。仅在字符串中移动一次，但在辅助数组中移动更多次以检查当前单词是否已被计算在内。

我希望对你有用。

# c# - 查看一组实数的快速方法

> ID：12827594
> 
> 赞同：1
> 
> 时间：2012-10-10T20:15:00.080
> 
> 标签：c#, .net, algorithm, c#-4.0, search

我在 C# 4.0 中工作，但遇到以下问题：

给定一个实数的有限集 S 和一个参数 k（不一定在该集中），找到**S 中大于或等于 k ​​的最小数**。

显然，我可以使用平衡二叉树来做到这一点。但是，在 C# 中没有实现这种数据结构可以帮助我。C# 中有哪些算法选项和可能的实现？

编辑：

由于大多数人对批评比真正帮助更感兴趣，所以我将解释更多：

它适用于将真实函数划分为数百万个片段（或箱，如直方图）的算法，我需要找到包含 k 的片段以及在其中应用一些计算的有效方法。这些片段是 [a; b) 并且不要重叠。

我正在设计的方法需要在给定 k 的情况下获取该部分，并且对于性能至关重要，因为它应该每秒调用数千次。因此，O(n) 搜索是不可接受的。

构建 S 的数据结构所浪费的时间并不重要，也不重要，因为该集合只会构建一次并且永远不会改变（它是一个不可变的集合）。

我知道我可以使用具有 O(log n) 搜索复杂度的红黑树。但是，我想研究其他算法选项（可能还有 C# 中的现有实现）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:20:48.230

这个问题在 O(n) 时间内很容易解决。遍历所有元素，跟踪迄今为止发现的满足条件的最小元素（不小于 k）。

如果用不同的 k 重复：对有序数组进行二分搜索 O(log n)

如果最大元素大小是有界的，则类似于架构的桶排序将给出 O(1) 时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T20:27:11.330

最简单的方法是 ( `O(N)`) ：

```
double k = 3.5;
List<double> S = new List<double>() { 1, 3, 5, 7, 9, 2, 4, 5, 6, 8, 10 };

var min = S.Where(f => f >= k).Min(); //4 
```

* * *

如果您的列表已经排序，那么成本是`O(LogN)`

```
List<double> S = new List<double>() { 1, 2, 3, 4, 5, 6, 7, 8, 9 };

var index = S.BinarySearch(k);
var min = index > 0 ? S[index] : S[~index]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T20:27:25.027

好吧，您可以使用[SCG.SortedSet](http://msdn.microsoft.com/en-us/library/dd412070.aspx)，它在幕后是一棵红黑树。

您可以使用 SCG.List 或数组，对其进行排序并使用其[BinarySearch()](http://msdn.microsoft.com/en-us/library/w4e7fxsh.aspx)方法。

您也可以使用[C5 Collections Library](http://www.itu.dk/research/c5/)。

如果这是家庭作业，您可以推出自己的实现（可能是教授想要的，我想）。那里有很多选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T20:25:58.830

不是“最快的”，但`SortedList`可能是“足够快”：

```
public static class Extensions
{
    public static double FindSmallestGreaterThan(this SortedList<double,double> list, double value)
    {
       foreach(double d in list.Keys)
       {
           if(d > value) return d;
       }
       throw new IndexOutOfRangeException("No values in the list greater than " + value.ToString());
    }
} 
```

用法是：

```
SortedList<double,double> list = new SortedList<double,double>();
list.Add(0.5, 0.5);
list.Add(1.9, 1.9);

double d = list.FindSmallestGreaterThan(1.0); 
```

# java - Java：允许重复的排序集合，内存效率高并提供快速插入+更新

> ID：12827595
> 
> 赞同：23
> 
> 时间：2012-10-10T20:15:02.483
> 
> 标签：java, data-structures

具体来说，我需要一个集合，它使用一个字段 A 进行访问，使用另一个字段（字段 S）进行排序，但接受重复的排序集合就足够了。

我经常遇到这种情况，我需要这个集合，而 TreeMap 不是一个选项，因为它不允许重复。所以现在是时候在这里问了。[正如在此处](https://stackoverflow.com/q/2658356/194609)和[此处](https://stackoverflow.com/q/416266/194609)的stackoverflow上指出的那样，有几种解决方法-即：

*   **PriorityQueue**：缓慢更新（remove(Object) + add(Object)），以及原始键的装箱
*   **斐波那契堆**：内存浪费（？）
*   **`TreeMap<Field_S, List<Value>>`**：对我来说问题是列表的内存开销和原始键的装箱
*   **排序列表或数组**：问题是插入和删除速度慢 -> 我应该实现一个分段排序列表吗？
*   来自番石榴的[TreeMultimap （](http://docs.guava-libraries.googlecode.com/git-history/master/javadoc/com/google/common/collect/TreeMultimap.html)[文档](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multimap)）：外部依赖和可能内存效率低下（？）

谁有更好的建议？或者我应该扮演我自己的排序数据结构（哪一个？）？其他来源（在 Java 中，开源，带有单元测试和小型 deps）也会很好。

* * *

**更新**

目前有关我的用例的更多详细信息（尽管我上次也有类似的需求）。我有一个集合（数百万）我想要的参考资料

*   轮询或获取有关字段 S 的最小元素
*   并在字段 A 的帮助下更新字段 S
*   字段 S 的相同值可能会发生。字段 A 实际上是一个指向另一个数组的整数
*   我想要的唯一依赖是trove4j。如果需要，我可以使用不同的 mahout 集合。但不是番石榴，因为虽然是一个不错的库，但集合并没有调整为内存效率（装箱/拆箱）。

所以所有人都在呼唤斐波那契堆，但我担心每个元素的开销太大 -> 这就是我考虑使用内存效率更高的“排序+分段数组”解决方案的原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T20:25:56.680

当您需要排序集合时，您应该仔细分析您的需求。
如果大多数操作是*插入*并且只有少数要搜索，那么使用排序集合，即保持集合中的元素*不断*排序，这不是一个好的选择（由于保持元素在插入时排序的开销，这将是最常见的操作）。
在这种情况下，最好保留*未排序*的集合并仅在需要时进行排序。即在搜索之前。你甚至可以使用一个简单的`List`排序（使用`Collections.sort`即合并排序）在需要时。但我建议谨慎使用，因为为了高效，假设您在处理大数据。在非常小的数据中，即使是线性搜索也足够好。

如果大多数操作是*搜索*，那么您可以使用排序集合，从我的角度来看，有可供选择的数据结构（您已经提到了一些），您可以进行基准测试以查看哪个适合*您的*需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T20:21:00.160

番石榴[TreeMultiset](https://guava.dev/releases/19.0/api/docs/com/google/common/collect/TreeMultiset.html)怎么样？你要求什么：一个接受重复的排序集合。虽然对它的性能一无所知。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T20:15:34.617

我决定推出自己的但不是最佳解决方案，只是一个 TreeMap 变体。如果我会在内存方面微调这个集合，我会保持更新。速度已经比之前的 PriorityQueue 尝试好很多，因为我需要 collection.remove(Object) 方法（用于更新条目）：

```
package com.graphhopper.coll;

import gnu.trove.iterator.TIntIterator;
import gnu.trove.set.hash.TIntHashSet;
import java.util.Map.Entry;
import java.util.TreeMap;

/**
 * A priority queue implemented by a treemap to allow fast key update. Or should we use a standard
 * b-tree?
 */
public class MySortedCollection {

    private int size;
    private int slidingMeanValue = 20;
    private TreeMap<Integer, TIntHashSet> map;

    public MySortedCollection(int size) {
        map = new TreeMap<Integer, TIntHashSet>();
    }

    void remove(int key, int value) {
        TIntHashSet set = map.get(value);
        if (set == null || !set.remove(key))
            throw new IllegalStateException("cannot remove key " + key + " with value " + value
                    + " - did you insert " + key + "," + value + " before?");
        size--;
        if (set.isEmpty())
            map.remove(value);
    }

    public void update(int key, int oldValue, int value) {
        remove(key, oldValue);
        insert(key, value);
    }

    public void insert(int key, int value) {
        TIntHashSet set = map.get(value);
        if (set == null)
            map.put(value, set = new TIntHashSet(slidingMeanValue));
//        else
//            slidingMeanValue = Math.max(5, (slidingMeanValue + set.size()) / 2);
        if (!set.add(key))
            throw new IllegalStateException("use update if you want to update " + key);
        size++;
    }

    public int peekValue() {
        if (size == 0)
            throw new IllegalStateException("collection is already empty!?");
        Entry<Integer, TIntHashSet> e = map.firstEntry();
        if (e.getValue().isEmpty())
            throw new IllegalStateException("internal set is already empty!?");
        return map.firstEntry().getKey();
    }

    public int peekKey() {
        if (size == 0)
            throw new IllegalStateException("collection is already empty!?");
        TIntHashSet set = map.firstEntry().getValue();
        if (set.isEmpty())
            throw new IllegalStateException("internal set is already empty!?");
        return set.iterator().next();
    }

    public int pollKey() {
        size--;
        if (size < 0)
            throw new IllegalStateException("collection is already empty!?");
        Entry<Integer, TIntHashSet> e = map.firstEntry();
        TIntHashSet set = e.getValue();
        TIntIterator iter = set.iterator();
        if (set.isEmpty())
            throw new IllegalStateException("internal set is already empty!?");
        int val = iter.next();
        iter.remove();
        if (set.isEmpty())
            map.remove(e.getKey());
        return val;
    }

    public int size() {
        return size;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public int getSlidingMeanValue() {
        return slidingMeanValue;
    }

    @Override
    public String toString() {
        return "size " + size + " min=(" + peekKey() + "=>" + peekValue() + ")";
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T23:41:23.963

您需要决定是否需要外部依赖项。我不会为这样的事情推出自己的实现。

也就是说，你几乎没有告诉我们你用它做什么，以及你打算用它做什么。如果没有足够的数据，我们只能告诉你这么多——你真的需要以随机顺序访问元素吗？你希望这个系列有多大？我们真的没有足够的数据来挑选适合您需求的正确数据结构。

也就是说，这里有一些我会考虑的选项。

*   `ArrayList`或者`PriorityQueue`，取决于你是否真的需要支持`remove(Object)`。你？你*确定*吗？（即使您确实需要支持`remove(Object)`，如果集合可能保持较小，我也会选择此选项。）
*   不是`TreeList`您链接到的，而是[Apache Commons Collections`TreeList`](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/list/TreeList.html)。尽管有这个名字，它实际上并不维护排序顺序，但它所做的是支持 O(log n) 从列表中的任何位置添加、删除和获取。使用二进制搜索，您可能会根据值的排序部分实现添加、删除或查找的 O((log n)^2) 时间。
*   你链接到的`TreeList`，或者——如果你和我一样，关心`List`合同——一个定制的 Guava `ListMultimap`，用`Multimaps.newListMultimap(new TreeMap<K, Collection<V>>, new Supplier<List<V>>() { public List<V> get() { return new ArrayList<V>(); }})`.

如果您还关心原始装箱，或者不能容忍第三方依赖项，那么您将别无选择，只能编写自己的数据结构。我只是将上面的实现之一调整为您的原始类型，但这将是一个非常痛苦的过程。

最后：我*真的*很想听听您的用例。Guava 对这样的事情没有任何支持，因为我们没有足够的需求，或者没有看到更复杂的数据结构真正适合的用例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-28T22:55:08.943

我会选择[skiplist](https://en.wikipedia.org/wiki/Skip_list) - 比树更节省内存，允许重复，为插入和删除提供O（logn）。您甚至可以实现索引跳过列表，它将允许您进行索引访问，这是树很难获得的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-10T20:29:46.533

我对 TreeMultimap 有很好的经验[https://guava.dev/releases/19.0/api/docs/com/google/common/collect/TreeMultimap.html](https://guava.dev/releases/19.0/api/docs/com/google/common/collect/TreeMultimap.html)

# php - 使用 UPDATE/SET 的 SQL 语法错误

> ID：12827597
> 
> 赞同：0
> 
> 时间：2012-10-10T20:15:05.230
> 
> 标签：php, mysql

我收到的错误：**您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 6 行的 'release= `2012-09-02`, platforms= `Android`, link=`play.php?game=G'附近使用正确的语法**

编码：

```
$sql = "UPDATE
            GameInformation
        SET
            keyIndex=`GameTest`,
            name=`Game Test`,
            release=`2012-09-02`,
            platforms=`Android`,
            link=`play.php?game=GameTest`,
            icon=`img/thumb_gametest.png`,
            thumb=`img/thumb_mini_gametest.png`,
            swf=`swf/GameTest.swf`,
            height=`500`,
            width=`920`
        WHERE
            keyIndex=`GameTest2`";

$query = mysql_query($sql);

if (!$query) exit (mysql_error()); 
```

我一直在我的设置变量周围尝试不同的分隔符（大括号、撇号、引号）但无济于事。这里有保留字吗？

更新 [已解决]，更正代码：

```
$sql = 'UPDATE
                            `GameInformation`
                        SET
                            `keyIndex`="GameTest",
                            `name`="Game Test",
                            `release`="2012-09-02",
                            `platforms`="Android",
                            `link`="play.php?game=GameTest",
                            `icon`="img/thumb_gametest.png",
                            `thumb`="img/thumb_mini_gametest.png",
                            `swf`="swf/GameTest.swf",
                            `height`="500",
                            `width`="920"
                        WHERE
                            `keyIndex`="GameTest2"';
            $query = mysql_query($sql);
            if (!$query) exit (mysql_error()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T20:22:32.277

您应该使用 ` 作为表名和列名，使用 " 或 ' 作为内容。RELEASE 是[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。

```
UPDATE
            `GameInformation`
        SET
            `keyIndex`="GameTest",
            `name`="Game Test",
            `release`="2012-09-02",
            `platforms`="Android",
            `link`="play.php?game=GameTest",
            `icon`="img/thumb_gametest.png",
            `thumb`="img/thumb_mini_gametest.png",
            `swf`="swf/GameTest.swf",
            `height`="500",
            `width`="920"
        WHERE
            `keyIndex`="GameTest2" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:23:15.463

`release`是mysql中的保留字。

[http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)

# c# - 并行不适用于实体框架

> ID：12827599
> 
> 赞同：22
> 
> 时间：2012-10-10T20:15:14.643
> 
> 标签：c#, .net, multithreading, entity-framework, parallel-processing

我有一个 ID 列表，我需要在每个 ID 上运行多个存储过程。

当我使用标准的 foreach 循环时，它可以正常工作，但是当我有很多记录时，它的工作速度很慢。

我想将代码转换为与 EF 一起使用，但出现异常：“底层提供程序在打开时失败”。

我在 Parallel.ForEach 内使用此代码：

```
using (XmlEntities osContext = new XmlEntities())
{
    //The code
} 
```

但它仍然抛出异常。

知道如何将 Parallel 与 EF 一起使用吗？我需要为我正在运行的每个过程创建一个新的上下文吗？我有大约 10 个程序，所以我认为创建 10 个上下文非常糟糕，每个上下文一个。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-10-10T20:28:38.077

[Entity Framework 使用的底层数据库连接*不是*线程安全的](https://stackoverflow.com/q/9099359/50776)。您*将*需要为要执行的另一个线程上的每个操作创建一个新上下文。

您对如何并行化操作的担忧是有道理的；许多上下文的打开和关闭成本很高。

相反，您可能想要颠倒您对并行化代码的想法。似乎您正在循环多个项目，然后为每个项目串行调用存储过程。

如果可以，为每个*过程*[`Task<TResult>`](http://msdn.microsoft.com/en-us/library/dd321424.aspx)创建一个新的（或者[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)，如果您不需要结果），然后在其中打开一个上下文，遍历所有项目，然后执行存储过程。这样，您只有与并行运行的存储过程数量相等的上下文数量。*`Task<TResult>`*

 *假设您有一个`MyDbContext`带有两个存储过程的`DoSomething1`和`DoSomething2`，它们都采用一个类的实例，`MyItem`。

实现上述内容如下所示：

```
// You'd probably want to materialize this into an IList<T> to avoid
// warnings about multiple iterations of an IEnumerable<T>.
// You definitely *don't* want this to be an IQueryable<T>
// returned from a context.
IEnumerable<MyItem> items = ...;

// The first stored procedure is called here.
Task t1 = Task.Run(() => { 
    // Create the context.
    using (var ctx = new MyDbContext())
    // Cycle through each item.
    foreach (MyItem item in items)
    {
        // Call the first stored procedure.
        // You'd of course, have to do something with item here.
        ctx.DoSomething1(item);
    }
});

// The second stored procedure is called here.
Task t2 = Task.Run(() => { 
    // Create the context.
    using (var ctx = new MyDbContext())
    // Cycle through each item.
    foreach (MyItem item in items)
    {
        // Call the first stored procedure.
        // You'd of course, have to do something with item here.
        ctx.DoSomething2(item);
    }
});

// Do something when both of the tasks are done. 
```

如果您*不能*并行执行存储过程（每个都依赖于以特定顺序运行），那么您仍然可以并行化您的操作，只是稍微复杂一点。

您将考虑在您的项目之间[创建自定义分区（使用](http://msdn.microsoft.com/en-us/library/dd997411.aspx)[class](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.partitioner.aspx)上的静态[`Create`方法](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.partitioner.create.aspx)）。这将为您提供获得实现的方法（注意，这*不是*您无法克服的）。[`Partitioner`](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.partitioner.aspx)[`IEnumerator<T>`](http://msdn.microsoft.com/en-us/library/78dfe2yb.aspx) *[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)`foreach`*

 *对于您返回的每个`IEnumerator<T>`实例，您将创建一个新实例`Task<TResult>`（如果您需要一个结果），并且在`Task<TResult>`正文中，您将创建上下文，然后循环通过 . 返回的项目`IEnumerator<T>`，按顺序调用存储过程。

看起来像这样：

```
// Get the partitioner.
OrdinalPartitioner<MyItem> partitioner = Partitioner.Create(items);

// Get the partitions.
// You'll have to set the parameter for the number of partitions here.
// See the link for creating custom partitions for more
// creation strategies.
IList<IEnumerator<MyItem>> paritions = partitioner.GetPartitions(
    Environment.ProcessorCount);

// Create a task for each partition.
Task[] tasks = partitions.Select(p => Task.Run(() => { 
        // Create the context.
        using (var ctx = new MyDbContext())
        // Remember, the IEnumerator<T> implementation
        // might implement IDisposable.
        using (p)
        // While there are items in p.
        while (p.MoveNext())
        {
            // Get the current item.
            MyItem current = p.Current;

            // Call the stored procedures.  Process the item
            ctx.DoSomething1(current);
            ctx.DoSomething2(current);
        }
    })).
    // ToArray is needed (or something to materialize the list) to
    // avoid deferred execution.
    ToArray(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-10T20:28:09.953

EF 不是线程安全的，所以不能使用 Parallel。

看看[实体框架和多线程](https://stackoverflow.com/questions/9099359/entity-framework-and-multi-threading)

和这篇[文章](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/e5cb847c-1d77-4cd0-abb7-b61890d99fae/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-26T17:26:21.613

这就是我使用的并且效果很好。它还支持处理错误异常并具有调试模式，这使得跟踪事情变得更加容易

```
public static ConcurrentQueue<Exception> Parallel<T>(this IEnumerable<T> items, Action<T> action, int? parallelCount = null, bool debugMode = false)
{
    var exceptions = new ConcurrentQueue<Exception>();
    if (debugMode)
    {
        foreach (var item in items)
        {
            try
            {
                action(item);
            }
            // Store the exception and continue with the loop.                     
            catch (Exception e)
            {
                exceptions.Enqueue(e);
            }
        }
    }
    else
    {
        var partitions = Partitioner.Create(items).GetPartitions(parallelCount ?? Environment.ProcessorCount).Select(partition => Task.Factory.StartNew(() =>
        {
            while (partition.MoveNext())
            {
                try
                {
                    action(partition.Current);
                }
                // Store the exception and continue with the loop.                     
                catch (Exception e)
                {
                    exceptions.Enqueue(e);
                }
            }
        }));
        Task.WaitAll(partitions.ToArray());
    }
    return exceptions;
} 
```

您可以像下面这样使用它，其中 db 是原始 DbContext 并且 db.CreateInstance() 使用相同的连接字符串创建一个新实例。

```
 var batch = db.Set<SomeListToIterate>().ToList();
        var exceptions = batch.Parallel((item) =>
        {
            using (var batchDb = db.CreateInstance())
            {
                var batchTime = batchDb.GetDBTime();
                var someData = batchDb.Set<Permission>().Where(x=>x.ID = item.ID).ToList();
                //do stuff to someData
                item.WasMigrated = true; //note that this record is attached to db not batchDb and will only be saved when db.SaveChanges() is called
                batchDb.SaveChanges();        
            }                
        });
        if (exceptions.Count > 0)
        {
            logger.Error("ContactRecordMigration : Content: Error processing one or more records", new AggregateException(exceptions));
            throw new AggregateException(exceptions); //optionally throw an exception
        }
        db.SaveChanges(); //save the item modifications 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-20T01:11:18.313

在不知道内部异常结果（如果有的话）的情况下解决这个问题有点困难。这可能只是连接字符串或提供程序配置设置方式的问题。

通常，您必须小心并行代码和 EF。但是，您正在做的事情-应该-工作。我心中的一个问题；在并行*之前*，是否正在对该上下文的另一个实例进行任何工作？根据您的帖子，您正在每个线程中执行单独的上下文。那挺好的。然而，我的一部分想知道在多个上下文之间是否存在一些有趣的构造函数争用。如果您在该并行调用之前没有在任何地方使用该上下文，我建议您尝试对上下文运行一个简单的查询以打开它，并确保在运行并行方法之前启动所有 EF 位。我承认，我还没有*完全*尝试过你在这里所做的事情，但我已经做得很接近并且很有效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-09-24T18:24:39.280

这是我为解决我的问题所做的事情。我试图在我的 Parallel.ForEach 中获得一个与 EF 有独特连接的订单，这就是我所坚持的，但并不是真的，我每次都有相同的最后一个订单。在操作结束时删除使用并关闭连接后，它工作得很好。

简而言之，如果您使用 using，请不要在 Parallel.Foreach 内的操作结束时关闭连接

我确实替换了这个

```
using ApplicationDbContext Context = CubiCommon.GetContext<ApplicationDbContext>("APIConnection"); 
```

这样

```
ApplicationDbContext Context = CubiCommon.GetContext<ApplicationDbContext>("APIConnection"); 
```

并在操作结束时添加

```
Context.Dispose();
Context = null; 
```

也许这可以解决类似的问题**

# sql - 多个连接子查询是测试多个表的唯一方法吗？

> ID：12827602
> 
> 赞同：0
> 
> 时间：2012-10-10T20:15:29.253
> 
> 标签：sql, oracle

我正在测试几个表中的最新日期在 oracle 中都相互匹配。我想出的 SQL 看起来像：

```
select ICEAG.process_month
from (
    select *
    from (
        select process_month
        from TABLE1
        group by process_month
        order by process_month desc
    )
    where rownum <=1
) ICEAG
join (
    select *
    from (
        select process_month
        from TABLETWO
        group by process_month
        order by process_month desc
    )
    where rownum <=1
) GAI on (ICEAG.process_month = GAI.process_month) 
```

这可行，但我需要检查大约 12 个表。我应该继续加入更多的子查询，还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:40:18.697

```
SELECT COUNT(*) FROM (
(SELECT MAX(process_month) FROM TABLE1)
  UNION
(SELECT MAX(process_month) FROM TABLE2)
  UNION
(SELECT MAX(process_month) FROM TABLE3)
); 
```

当结果大于 1 时，其中一个表的最后一个 process_month 不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:41:23.883

如果您只是想匹配输出，您可以使用 intersect。

```
 select process_month
    from TABLETWO
    group by process_month
    order by process_month desc
    where rownum <=1
INTERSECT
    select process_month
    from TABLE1
    group by process_month
    order by process_month desc
    where rownum <=1 
```

# gradle - 请解释 gradle 任务定义“<<”的语法

> ID：12827612
> 
> 赞同：5
> 
> 时间：2012-10-10T20:16:29.907
> 
> 标签：gradle

Gradle 用户指南[显示](http://www.gradle.org/docs/current/userguide/userguide_single.html#N101BE)了用于创建我不理解的任务的语法：

```
task hello << {
    println 'Hello world!'
} 
```

在那里做什么`<<`？[问题/答案](https://stackoverflow.com/questions/2767888/what-is-the-difference-between-these-task-definition-syntaxes-in-gradle)
有点启发性 ，但我仍然不知道到底是什么。是groovy 还是 gradle ？`<<``<<`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-10T23:42:15.790

Bob 的回答涵盖了 Groovy 方面。对于 Gradle 部分，<< 对应于任务上的 doLast，将另一个操作添加到任务操作列表的末尾。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T20:42:21.777

这是一件很时髦的事情。通过在应用运算符的对象上声明方法，可以在 Groovy 中重载运算符。在这种情况下，方法是[leftShift()](http://gradle.org/docs/current/dsl/org.gradle.api.Task.html#org.gradle.api.Task%3aleftShift%28groovy.lang.Closure%29)。

有关详细信息，请参阅[http://groovy.codehaus.org/Operator+Overloading](http://groovy.codehaus.org/Operator+Overloading)。

# c# - 面向 .NET4.5、SL 和 Windows 应用商店应用的便携式库类的 MEF

> ID：12827617
> 
> 赞同：1
> 
> 时间：2012-10-10T20:17:12.827
> 
> 标签：c#, visual-studio-2012, mef, portable-class-library

我正在使用一个可移植的库类，我的目标是 .NET 4.5、Silverlight 5 和 Windows Store 应用程序。

根据 MSDN，可以在这三个平台中使用 MEF：http: [//msdn.microsoft.com/en-us/library/gg597391.aspx](http://msdn.microsoft.com/en-us/library/gg597391.aspx)

但我无法在这些平台中使用 MEF。在 PCL 中使用 MEF 的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T16:28:49.200

文档不正确。MEF 最初在商店应用程序的框中提供，但由于各种原因，它在 RTM 之前被撤下。目前，我们在 .NET 4.5 和商店应用程序 (https://nuget.org/packages/microsoft.composition) 之间提供了更新版本的 MEF，但在 Silverlight、.NET 和商店应用程序之间不可用。

这是我们正在考虑的未来版本。如果您觉得它很重要，您能否在 uservoice 上提出建议：http: [//visualstudio.uservoice.com/forums/121579-visual-studio/category/31481-net](http://visualstudio.uservoice.com/forums/121579-visual-studio/category/31481-net)。在确定我们下一步的工作时，客户反馈/请求的权重很大。

# css - IE7 / IE8 兼容模式特定 CSS

> ID：12827620
> 
> 赞同：0
> 
> 时间：2012-10-10T20:17:20.877
> 
> 标签：css, internet-explorer, ie8-compatibility-mode

我们最近重新设计了面向公众的网站，但有一项没有完全传达。

我们网站的某些部分使用了 CSS 中一些较新的显示类型。这在几乎所有浏览器中看起来都很好，但在 IE8 的兼容模式或 IE7 中却不行。

这不会是一个问题，除了错误传达的项目是我们确实需要支持 IE7。

出于这个原因，我最初的修复（强制 IE8 进入标准模式）被拒绝了。

我目前正在开发一个 CSS 来覆盖页面的这些部分。我们希望这是一个单独的 CSS 文件，而不是出于可维护性的原因在主样式表中使用 CSS hack。

我的理解是，我可以通过使用 IE 的条件注释将它包括在内（或不包括在内），仅用于 IE7 及以下版本。如果我使用条件注释

```
<!-- if lte IE 7> 
```

这也会包含在 IE8 的兼容模式中吗？如果不是，我如何专门针对 IE 8 兼容性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:26:44.293

至少在 IE9 中，IE 在条件注释方面确实与 IE7 一样。例如，使用以下代码：

```
<!--[if IE 7]>IE7.<![endif]-->
<!--[if IE 8]>IE8.<![endif]-->
<!--[if IE 9]>IE9.<![endif]--> 
```

“IE7”将显示在 IE9 中，通过位置栏右侧的按钮触发以兼容视图模式工作。

更新：刚刚在 IE8 中测试——它和 IE9 一样。

# php - 使用 Twitter API 已经开始给出一个抱歉页面不存在的错误，即使它之前工作过

> ID：12827627
> 
> 赞同：3
> 
> 时间：2012-10-10T20:18:01.903
> 
> 标签：php, twitter

我正在开发一个 php 项目，我试图在 Twitter 上发布消息。我有以下代码来验证 twitter，当我在大约 30 分钟前工作时，它工作正常，我可以成功验证，获取我的个人资料图片和用户名，没有任何问题。下面是代码。

```
function authenticate($oauth_token)
        {
            require ("../../../libraries/twitterLib/secret.php");
            $twitterObj = new EpiTwitter($consumer_key, $consumer_secret);
            $twitterObj->setToken($oauth_token);

            $token = $twitterObj->getAccessToken();
            $twitterObj->setToken($token->oauth_token, $token->oauth_token_secret);
            $_SESSION['ot'] = $token->oauth_token;
            $_SESSION['ots'] = $token->oauth_token_secret;
            $twitterInfo = $twitterObj->get_accountVerify_credentials();
            echo "<pre>";
            print_r($twitterInfo->response);
            echo "</pre>";
            $username = $twitterInfo->screen_name;
            $profilePic = $twitterInfo->profile_image_url;

            echo $this->addToDatabase($username, $profilePic, $token, $_GET['oauth_verifier']);
        } 
```

一旦这工作正常，我然后尝试发布一条消息，但收到`Sorry, that page does not exist`错误代码 34。我以为我只是在发布时遇到问题，但后来我尝试删除我的 oauth 令牌并重新验证，现在上面的代码工作了一半一小时前不再工作，我得到以下输出

```
Array
(
    [errors] => Array
        (
            [0] => Array
                (
                    [message] => Sorry, that page does not exist
                    [code] => 34
                )

        )

) 
```

我不明白为什么当它刚刚工作时我突然得到这个，而现在却没有，这部分代码自从它工作以来就没有改变。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T22:40:29.617

我已经通过更改 EpiTwitter.php 上的 API 连接 URL 解决了这个问题：

```
class EpiTwitter extends EpiOAuth
{
  const EPITWITTER_SIGNATURE_METHOD = 'HMAC-SHA1';
  protected $requestTokenUrl= 'https://api.twitter.com/oauth/request_token';
  protected $accessTokenUrl = 'https://api.twitter.com/oauth/access_token';
  protected $authorizeUrl   = 'https://api.twitter.com/oauth/authorize';
  protected $authenticateUrl= 'https://api.twitter.com/oauth/authenticate';
  protected $apiUrl         = 'https://api.twitter.com';
  protected $searchUrl      = 'http://search.twitter.com'; 
```

无论如何，您最好从[https://github.com/jmathai/twitter-async/tree更新文件](https://github.com/jmathai/twitter-async/tree)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T10:55:47.547

对于[Twitter 搜索](https://dev.twitter.com/docs/api/1.1/get/search/tweets)，我发现我们无法再通过[https://api.twitter.com/1/search.json](https://api.twitter.com/1/search.json)发送搜索请求。

需要使用[https://api.twitter.com/1.1/search/tweets.json](https://api.twitter.com/1.1/search/tweets.json)代替。

# java - Java Applet，适用于 eclipse，而不是 chrome

> ID：12827631
> 
> 赞同：1
> 
> 时间：2012-10-10T20:18:15.150
> 
> 标签：java, html, applet, noclassdeffounderror

我有一个非常简单的 java 小程序，我使用来自 docs.oracle( [http://docs.oracle.com/javase/tutorial/deployment/applet/getStarted.html](http://docs.oracle.com/javase/tutorial/deployment/applet/getStarted.html) ) 站点的源代码，它应该可以工作，并且可以在eclipse就好了，它把它放到了问题所在的页面上。该文件位于 localhost/applet/applet.html 的 localhost 服务器上，我在同一目录中有文件 JavaQuiz.jar。我的html文件如下。

```
<hmtl>
<applet codebase="localhost/applet/"
    code = 'JavaQuiz.jar' 
    archive = 'JavaQuiz.jar'
    width = 300
    height = 300 />
</html> 
```

有什么我想念的吗？还是需要改变？我期待任何可以提供的帮助，请尝试解释它而不是告诉我答案，以便我可以学习。:D

这就是 java colsole Java Plug-in 10.5.1.255 Using JRE version 1.7.0_05-b05 Java HotSpot(TM) Client VM 中的内容

## 用户主目录 = C:\Users\Jihoon

c：清除控制台窗口 f：在终结队列中终结对象 g：垃圾收集 h：显示此帮助消息 l：转储类加载器列表 m：打印内存使用情况 o：触发日志记录 q：隐藏控制台 r：重新加载策略配置 s：转储系统和部署属性 t：转储线程列表 v：转储线程堆栈 x：清除类加载器缓存

## 0-5：将跟踪级别设置为

plugin2manager.parentwindowDispose

Chrome 开发人员帮助的东西没有显示任何问题。当我点击小程序上的详细信息时，它只会说 classnotfounfexception: JavaQuiz

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:25:57.757

该`code`属性应该指向一个完全限定的类名，而不是一个 jar。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T20:31:34.707

此外，您应该注意`localhost...`这意味着 j.jar 位于与 html 相同的目录中名为 localhost 的文件夹中。这是真的吗？或者你的意思是`http://localhost:80/applet/`或者`/applet/`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T02:27:23.120

```
<html>
<applet 
    archive="http://localhost/applet/JavaQuiz.jar" 
    code="JavaQuiz.class"
    width = 300
    height = 300 />
</html> 
```

我认为最大的问题是没有`http://`我不完全确定其他参数。玩弄那个。

所以在你的情况下`codebase="localhost/applet/"`改为`codebase="http://localhost/applet/"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T20:27:49.377

`<hmtl>`应该`<html>`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-10T20:28:31.313

强制性的“代码”属性（在您的示例中缺少）应该指向您打算运行的类（扩展 JApplet 的类）。就像是：

```
<html>
<applet codebase="localhost/applet/" code="yourpackage.YourApplet.class"
    code = 'JavaQuiz.jar' 
    archive = 'JavaQuiz.jar'
    width = 300
    height = 300 />
</html> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-11T03:44:54.790

`http://localhost/applet/JavaQuiz.jar`在部署时将不起作用。

```
<html>
<applet 
    codebase="."
    archive="JavaQuiz.jar" 
    code="JavaQuiz"
    width = 300
    height = 300 >
</applet>
</html> 
```

由于代码库指向“当前目录”，这将适用于在本地主机上的小程序以及实时部署。

要点，其中一些已经被提及：

1.  code 属性应该是applet 类的全限定类名，没有`.class`结尾。
2.  小程序元素不能“自我关闭” - 始终用于`</applet>`关闭元素。
3.  如果省略，则代码库默认为 HTML 所在的目录，因此放置`codebase="."`是多余的。没有它它也应该工作。

# automapper-2 - Automapper 构造函数参数

> ID：12827632
> 
> 赞同：2
> 
> 时间：2012-10-10T20:18:22.633
> 
> 标签：automapper-2

我刚刚开始使用它并立即遇到将参数映射到构造函数参数的问题。

我已经尝试了我可以在 SO 上找到的每个示例，但似乎没有一个有效，而且据我所知，文档没有提到这个功能。

示例显示：

```
Mapper.CreateMap<UserProfile, UserProfileModel>().ConstructUsing(x => new UserProfileModel(x.Id); 
```

我无法弄清楚访问 UserProfile 对象上的 Id 属性的语法。

另一个例子表明：

```
Mapper.CreateMap<TypeOneDto, TypeOne>().ConstructUsing((Func<ResolutionContext, TypeOne>) (r => new TypeOne())); 
```

在使用这些 lambda 中的任何一个时，我只能访问 ResolutionContext 而不是父对象？

有任何想法吗？

# visual-studio-2010 - 为什么 InstallShield 向导不显示上次卸载页面？

> ID：12827635
> 
> 赞同：3
> 
> 时间：2012-10-10T20:18:43.960
> 
> 标签：visual-studio-2010, windows-installer, installshield, uninstallation

我有 InstallSheild 的试用版。它在我的 Windows 7 机器上运行良好。但是在其他机器上卸载它无法显示最终完成页面（最后一个卸载页面）

要清楚它正确卸载，但它只是无法显示已完成的页面。

另一台机器是否缺少我需要与安装程序一起打包的组件，还是权限问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-16T13:09:15.613

您的问题遗漏了一些关键细节：

你是如何调用卸载的？你看到的是什么用户界面？我们可以查看您的日志内容吗？

通常，大多数人通过添加删除程序（即程序和功能）卸载。在这种情况下，Windows Installer 仅显示一个进度条，然后退出，因为按照最佳实践绕过了 UI 序列。

# c# - Linq to SQL Join IQueryable 设置某些属性

> ID：12827636
> 
> 赞同：1
> 
> 时间：2012-10-10T20:18:44.053
> 
> 标签：c#, linq-to-sql, iqueryable

这可能吗？

假设我有一个简单的 IQueryable 连接，如下所示：

```
 var x = from t1 in Repo.GetThing1()
                    join t2 in Repo.GetThing2() on t1.Key equals t2.Key
                    select t1).ToList(); 
```

但是让我们在 t1 上有一个我想用 t2 设置的字段。但是我不想重新映射 t1 中的所有字段，我只想能够从 t2 映射 t1 中的特定字段...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:21:28.053

当然：

```
var query = from t1 in Repo.GetThing1()
            join t2 in Repo.GetThing2() on t1.Key equals t2.Key
            select new { Existing = t1, NewValue = t2.SomeField };

var list = query.ToList();

foreach (var pair in list)
{
    pair.Existing.SomeField = pair.NewValue;
} 
```

（当然，你可以做任何你想做的事。）

# workflow - BPM和工作流之间的区别

> ID：12827639
> 
> 赞同：1
> 
> 时间：2012-10-10T20:19:05.977
> 
> 标签：workflow, soa, esb, business-process-management, orchestration

BPM 和 Workflow 和有什么不一样？

此外，在 BPEL 和 ESB 之间？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T23:26:51.890

BPM 是一门称为业务流程管理的学科，它与技术无关。您会发现 BPM 系统或套件是指导您实施 BPM 学科不同阶段的软件。这个术语不是技术性的，而是更面向业务的。

术语工作流与 BPM 结合使用，但它最初旨在描述面向文档的公司和场景中的人与人之间的交互。术语业务流程表示系统和人类参与者交互以实现目标的更一般的情况。这个术语也可以在技术领域之外使用。

BPEL（业务流程执行语言）是一种标准，也称为 WS-BPEL，它使用 XML 格式定义系统之间的交互。该标准被许多公司广泛采用，以将他们的系统定义为系统交互（BPEL 的一大问题是缺乏对人机交互的支持）。这是一个技术性很强的事情，因为它是关于如何集成通过 Web 服务公开的系统（提供一个 Web 服务端点进行交互。）

ESB 是一种企业服务总线，ESB 通常用于集成不同的系统。主要思想是提供一组业务连接器，允许不同的应用程序在不同的协议和技术下进行交互。

我建议您看一下 BPMN2（业务流程建模和表示法 2），它是当今大多数 BPM 系统采用的新标准。查看 www.jbpm.org 了解更多信息。

干杯

# php - pyrus 与 php5.2.11？

> ID：12827640
> 
> 赞同：0
> 
> 时间：2012-10-10T20:19:07.983
> 
> 标签：php, pear, pyrus

好吧，我正在尝试在我的服务器上安装 pyrus，但安装失败。我猜这是因为我的 php 版本，所以我的问题是我们可以在使用 php5.2.11 的服务器上安装 Pyrus 吗？有最低要求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T09:00:10.627

PHP 5.2 不支持命名空间。Pyrus 使用命名空间，因此它不能与 PHP < 5.3.0 一起使用。

# .net-assembly - 将多个 .NET 程序集合并为一个有什么优势？

> ID：12827641
> 
> 赞同：2
> 
> 时间：2012-10-10T20:19:14.527
> 
> 标签：.net-assembly, ilmerge

我已经看到了有关将多个程序集合并为一个的技术的讨论（例如 ilmerge）。我正在挠头，为什么要这样做。**除了**明显的“一个文件更容易部署/跟踪/维护/引用”之外，还有其他原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T13:22:09.387

一些原因可能是：

*   小型实用程序，例如，当您只想将整个程序复制/粘贴到没有任何文件夹或任何内容的服务器时。
*   您希望保留最少数量的应复制、上传到 FTP 等文件的部署方案，例如安装程序。
*   您希望将添加的引用数量保持在最低限度的 NuGet 包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-10T21:54:46.880

应用程序冷启动时 I/O 的减少会缩短启动时间。查看可以节省多少改进时间的最佳方法是衡量每个应用程序的不同：程序集的数量、程序集的大小等。

# winapi - Windows 设备名称

> ID：12827642
> 
> 赞同：0
> 
> 时间：2012-10-10T20:19:16.347
> 
> 标签：winapi, windows-7, bluetooth, createfile

我正在尝试获取 USB 蓝牙收发器的设备名称以与 CreateFile 一起使用，但我不知道文件路径。我试过 USB 文件路径，但总是返回 SHARING_VIOLATION。

为了了解这是否是正确的设备路径，如何获取 Windows 注册的设备名称？蓝牙收发器是否有标准设备路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:45:48.573

最直接的方法可能是通过[USBDeview](http://www.nirsoft.net/utils/usb_devices_view.html)找到确切的设备名称。

而且我不知道 BT 收发器的标准名称。

# silverlight - 如何从 Silverlight 应用程序调用 Wcf 数据服务中的自定义方法？

> ID：12827645
> 
> 赞同：0
> 
> 时间：2012-10-10T20:19:20.033
> 
> 标签：silverlight, visual-studio-2012, wcf-data-services, odata, azure-table-storage

我有以下 Wcf 数据服务：

```
public class WcfDataService : DataService<WcfDataServiceContext>
{
    public static void InitializeService(DataServiceConfiguration config)
    {
        config.SetEntitySetAccessRule("*", EntitySetRights.All);
        config.SetServiceOperationAccessRule("*", ServiceOperationRights.All);
        config.UseVerboseErrors = true;
    }

    [WebGet]
    public IQueryable<Person> GetPeopleByName(string name)
    {
        WcfDataServiceContext context = this.CurrentDataSource;

        var match = from p in context.People
                    where p.FirstName == name
                    select p;

        return match;
    } 
```

我可以像这样从浏览器访问自定义方法：

```
http://127.0.0.1:8080/DataService/WcfDataService.svc/GetPeopleByName?name='Daniel' 
```

如何调用该方法并从 Silverlight 应用程序中获取 Person 列表？

我正在使用 Visual Studio 2012、Silverlight 5、.NET Framework 4.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:42:42.627

据我记得，在使用 Silverlight 时，您无法连接到与 Silverlight 应用程序来源不同的服务器，因此您只需使用相对的 Uri。如果你想使用 WCF 数据服务客户端，你可以看看这里：[http](http://forums.silverlight.net/t/208481.aspx) ://forums.silverlight.net/t/208481.aspx - 有一个代码片段显示它。但是，AFAIK WCF 数据服务客户端不支持服务操作，因此您可能需要使用 XmlReader 才能查询和解析 GetPeopleByName 函数的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T08:39:59.347

在我可以分享之前我已经这样做了。服务参考您的域：8080/DataService/WcfDataService.svc 然后对于 Person 对象使用**[DataContract]**属性，用于 Peson 的属性使用**[global::System.Runtime.Serialization.DataMemberAttribute()]** 通过这个你说序列化并创建总线端代理的方式。请注意此属性，因为它确实有效！

```
//Here is the interface attributes are important

 namespace AHBSBus.Web.Services
{
[ServiceContract]
public interface IChatService
{
    [OperationContract]
    bool LogIn(Guid userID,Guid roomID);

    [OperationContract]
    bool LogOut(Guid userID,Guid roomID);

    [OperationContract]
    IEnumerable<VW_CHATUSERDETAIL> GetLatestMessages(Guid userID,Guid roomID,Guid lastSyncMessageID);

    [OperationContract]
    bool SendMessage(Guid fromID, Guid roomID, Guid toID, string message);

    [OperationContract]
    IEnumerable<ChatUser> GetLoggedInUsers(Guid roomID);

    [OperationContract]
    bool IsLogin(Guid roomID,Guid userID);
}
}

//Implementation of service 

   [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
  public partial class ChatService:IChatService
  {
    //Here goes 
  } 
```

# java - 显示展开树的方法

> ID：12827646
> 
> 赞同：1
> 
> 时间：2012-10-10T20:19:24.327
> 
> 标签：java, data-structures, recursion, binary-search-tree, splay-tree

我已经建立了一棵张开的树，我试图将它反向打印出来，这样当你把头转向左边时，你可以以正常的方式看到树。我已经编写了以下代码，它输出的树有点正确，但是它在最右边的节点上添加了额外的空格，并且它没有为应该放置在根节点下方的所有子节点添加空格：

```
 public void printReverseInOrder() {
       if (root != null) {
           reverseInOrder(root, 0);
       }
       else {
           System.out.println();
       }
   }

public void reverseInOrder(BSTnode h, int indent) { 
    if (h != null) {
        for (int i = 0; i < indent; i++) {
            System.out.print("  ");
        }

        indent++;
        reverseInOrder(h.right, indent);

        reverseInOrder(h.left, indent);

        System.out.println(h.data);
        indent--;
    }

} 
```

我觉得这可能是我的递归或缩进加减放置的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T22:43:27.983

这工作得很好，重新排序了一些东西......

```
public class test {

   public static void main(String[] args){
      node rootNode = new node(5);
      rootNode.r = new node(4);
      rootNode.l = new node(3);
      rootNode.r.r = new node(2);
      rootNode.r.l = new node(1);
      rootNode.l.r = new node(6);
      rootNode.l.l = new node(7);

      reverseInOrder(rootNode, 0);
   }

   public static void reverseInOrder(node h, int indent) { 
      if (h != null) {
         indent++;
         reverseInOrder(h.r, indent);

         for (int i = 0; i < indent; i++) {
            System.out.print("  ");
         }
         System.out.println(h.value);

         reverseInOrder(h.l, indent);
      }
   }
} 
```

您`indent--`在通话结束时并没有真正做任何事情，因为函数结束并跳回。此外，随着缩进的增加，示例代码中的间距实际上呈指数增长（因为它每次输入时都会打印空格，所以 1space + 2 space + 3 space），我只是将其更改为仅在打印值之前添加空格本身（所以它总是等于缩进本身而不是缩进阶乘）。

输出如下所示：

```
 2
    4
      1
  5
      6
    3
      7 
```

# python - Django：解析 URL 字符串数据的 HttpResponse 对象

> ID：12827649
> 
> 赞同：0
> 
> 时间：2012-10-10T20:19:34.410
> 
> 标签：python, django

我正在为“抛出” URL 字符串错误的重定向编写 Django 测试，但我想在没有脆弱的正则表达式的情况下进行。

```
def test_redirect_contains_error_string(self):
    response = self.client.get('/sendme/', follow=True)
    // response.redirect_chain: [('https://e.com/?error=errortype', 302)]
    url = response.redirect_chain[0][0]
    self.assertTrue(re.search('error=errortype', url))
    // Ew! 
```

有没有一种方法可以将 URL 解析为类似 dict 的对象，所以我可以：

```
response_obj = something(url)
self.assertEquals(response_obj.get('error'), 'errortype') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T20:34:14.430

怎么样[`urlparse`](http://docs.python.org/library/urlparse.html)：

```
>>> import urlparse
>>> zoo = urlparse.urlparse('http://www.example.com/foo?bar=zoo')
>>> urlparse.parse_qs(zoo.query)
{'bar': ['zoo']} 
```

# php - 使用正则表达式从主题标签中获取名称

> ID：12827651
> 
> 赞同：3
> 
> 时间：2012-10-10T20:19:36.227
> 
> 标签：php, regex, hashtag

我有这个字符串/内容：

`@Salome`，`@Jessi H`和“ ”老鼠在院子里`@O'Ren`玩耍。`@Lean``@Ziggy`

好吧，我试图让所有名字都集中在上面。我已经使用`@`符号来创建像在我的网络中使用的散列一样。`@Jessi H`如果您注意到，在 like和 like 之前和之后的字符之间有空格的名称`@Ziggy`。因此，如果您建议我以另一种方式管理哈希以使其正常工作，我不同意。我在想，对于有空格的用户，可以用引号写散列，比如`@"Jessi H"`. 你怎么看？其他示例：

```
@Lean's => @"Lean"'s  
@Jessi H => @"Jessi H"  
"@Jessi H" => (sorry, I don't know how to parse it)  
@O'Ren => @"O'Ren" 
```

我有什么办法？我开始在 php 中使用正则表达式，但是一些 SO 问题对我开始很有用，所以，这些是我首先使用**preg_match_all**函数的尝试：

结果`/@(.*?)[,\" ]/`：

```
Array ( [0] => Salome [1] => Jessi [2] => Charlie [3] => Lean's [4] => Ziggy" ) ) 
```

`/@"(.*?)"/`类似名称的结果`@"name"`：

```
Empty array 
```

伙计们，我不希望你们为我做这一切。我认为伪代码或类似的东西将有助于引导我走向正确的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:43:01.850

尝试以下正则表达式：`'/@(?:"([^"]+)|([^\b]+?))\b/'`

这将返回两个匹配组，第一个包含任何带引号的名称（例如`@"Jessi H"`和`@"O'Ren"`），第二个包含任何不带引号的名称（例如`@Salome`, `@Leon`）

```
$matches = array();
preg_match_all('/@(?:"([^"]+)|([^\b]+?))\b/', '@Salome, @"Jessi H" and @"O\'Ren" were playing at the @Lean\'s yard with "@Ziggy" the mouse.', $matches);
print_r($matches); 
```

输出：

```
Array
(
    [0] => Array
        (
            [0] => @Salome
            [1] => @"Jessi H
            [2] => @"O'Ren
            [3] => @Lean
            [4] => @Ziggy
        )

    [1] => Array
        (
            [0] => 
            [1] => Jessi H
            [2] => O'Ren
            [3] => 
            [4] => 
        )

    [2] => Array
        (
            [0] => Salome
            [1] => 
            [2] => 
            [3] => Lean
            [4] => Ziggy
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:30:57.413

您是在设置这些要求还是可以选择它们？如果您可以设置要求，我建议使用`_`而不是空格，这将允许您使用正则表达式：

`/@(.+) /`

如果必须允许空格并且您要使用引号，那么引号可能应该跨越整个名称，允许使用此正则表达式：

`/@\"(.+)\" /`

# sql - SSRS - 将报告复制到新文件夹将速度提高 10 倍

> ID：12827653
> 
> 赞同：2
> 
> 时间：2012-10-10T20:19:48.957
> 
> 标签：sql, reporting-services, ssrs-2008, database-administration

我有一个每月运行 12,000 次的 SQL 2008R2 报告。每次执行平均需要 60-90 秒。

我使用 SQL 已有 12 年了，但我在 2-3 周前才开始这项工作，并且仍在努力解决其中一些 SSRS 性能问题。不用说，为了帮助这份报告，我一直在重新索引所有内容。

这是我的执行日志的图片/转储：

```
SELECT ReportPath, TimeDataRetrieval, TimeProcessing, TimeRendering, Source, [RowCount] 
FROM ReportServer.dbo.ExecutionLog2
WHERE UserName = '_________' AND ReportAction = 'Render'
ORDER BY timeStart desc 
```

[http://accessadp.com/?attachment_id=562](http://accessadp.com/?attachment_id=562)

```
ReportPath  TimeDataRetrieval   TimeProcessing  TimeRendering   Source  RowCount

/CubeReports/Freight Allocation 2954    4402    2039    Live    2348
/RS Reports/Freight Allocation  39954   4087    2380    Live    2348
/RS Reports/Freight Allocation  37718   3948    1888    Live    2348
/RS Reports/Freight Allocation  39534   4317    1937    Live    2348
/CubeReports/Freight Allocation 3257    4206    2422    Live    2348
/RS Reports/Freight Allocation            37517 4164    2402    Live    2348
/RS Reports/Freight Allocation  36127   4151    1986    Live    2348
/RS Reports/Freight Allocation  36415   39888   2569    Live    19048
/RS Reports/Freight Allocation  37544   41644   2071    Live    19048
/RS Reports/Freight Allocation  37970   41003   2187    Live    19048
/RS Reports/Freight Allocation  38057   48085   1885    Live    19048
/CubeReports/Freight Allocation 3030    4558    2056    Live    2348
/CubeReports/Freight Allocation 3534    5232    2422    Live    2348 
```

请注意，我相信我知道“RowCount”的区别是什么。我有一个运行数据集的子报表（这并不重要），我将其删除。

我认为这是性能提高的原因.. 但我已经仔细检查和三次检查 subReports 不再具有其他数据集（这在行数减少中得到了引用）。不幸的是，这并没有转化为处理时间的减少。

我从“RS Reports”下载了报告，并将其部署到“CubeReports”。我没有更改此版本报告的任何其他内容。

我用相同的参数运行它……现在报告“CubeReports”的副本实际上运行速度快了 10 倍。

我只是想不通为什么会这样？我真的需要找到解决方案并将其投入生产。

我已经检查了快照、历史记录、执行缓存......这些都没有打开，这看起来就像两个报告的默认设置......我检查了所有其他选项，但我找不到任何可以解释这一点。

我看到的仅有的三个选项：

1.  Report Builder 3.0 不像 BIDs 那样“编译报告”。
2.  让 3-4 人同时运行主要报告我正在做测试导致这个问题。（我们有 300 名员工，我真的无法在其他任何地方进行测试，因为人们每天都在运行它）。
3.  删除报告并重新部署报告，并祈祷这将使其运行速度提高 10 倍

不幸的是，我能够始终如一地复制 10 倍的速度提升，我已经运行了大约 10 次，每次使用相同的参数并获得相同的结果。请记住，只有 1 个 SSRS 服务器，与 1 个数据库服务器相对。相同的存储过程，相同的参数。

此报告的生产副本的性能差 10 倍。将其复制到新文件夹时性能提高 10 倍。

主 ERP 数据库约为 100gb，只有 4 个内核，只有 16gb RAM。SSRS 服务器在虚拟机上，它只有 2 个内核，只有 8gb 内存。

SSRS 服务器上还有一个额外的数据库；它实际上是一个相当大的数据库——但不是大量的活动。另一个数据库（Bartender）只有 9gb 数据/3gb 日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:45:08.793

您可能对文件夹名称这两个词有疑问。尝试在另一个名称中有空格的文件夹中检查。

只是我的 2 美分……但我活着看到了神圣的“我”被宣布为全球性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T21:15:23.087

我发现运行速度快`Credentials used to run this report are not stored`的报告说，运行慢的报告说`Default report parameter values are missing`。我要回去仔细检查参数的默认设置。

我的默认参数确实存在差异。我可能会继续删除报告并重新部署它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:47:59.817

我最近遇到了类似的性能问题。使用 SQL Server Profiler，我跟踪到执行完全相同的查询。它有时会导致大约 1000 倍于其他查询的读取。区别似乎在于查询是作为 SQL 调用还是通过 RPC 调用的。

进一步深入研究，并通过一些试验和错误，我发现我的案例的主要区别在于，`ARITHABORT`针对不同的连接或用户设置了不同的选项。

不幸的是，我不记得在我的情况下哪个设置是最快的。我没有收到失败的查询，但此选项的状态导致使用不同的执行计划。放置语句`SET ARITHABORT ON`或`SET ARITHABORT OFF`在我的查询开头使所有内容对齐。ARITHIGNORE 和 ANSI_WARNINGS 是类似的设置，因此您也可以查看这些设置。

# php - 物流和运输计划技术

> ID：12827670
> 
> 赞同：0
> 
> 时间：2012-10-10T20:20:58.487
> 
> 标签：php, mysql, search, architecture, logistics

我实际上正在开发一个巴士票预订系统。提供商有许多路线和不同的行程。我已经建立了一个相当全面的数据库，将所有这些映射在一起，但是当我进行交叉路线预订时，我无法让路径算法正常工作。

例如，用户想从蒙特利尔到舍布鲁克，他只会走我们这里所说的 Route #47。但如果他去萨顿而不是舍布鲁克，他现在必须在某个时候转入 53 号路线。

现在，检测一个且只有一个转移并不难。但是当我谈到他可以做哪些选择来穿越多条路线时，我有点害怕。我设计了一种可爱且相对有效的方法，仅使用 SQL 在 1-3 跳上执行此操作，但我想知道我应该如何在更广泛的范围内组织所有这些，因为客户端可能不会在其余的路径中停留是生命。

到目前为止我所想到的示例：

```
StartingStop
joins to Route
joins to StopsOfTheRoute
joins to TransfersOnThatStop
joins to TargetStopOfThatTransfer
joins to RouteOfThatStop
joins to StopsOfThatNewRoute
[wash rince repeat for more hops]
where StopsOFThatNewRoute = EndingStop 
```

问题是，如果我有超过 3 个跃点，我确信我的 SQL 服务器在压力下会很快窒息，即使我正确索引我的数据库，我也可以很容易地预测最终会出现重大故障......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T00:29:00.210

我对您的问题的理解：您正在寻找一种算法来帮助您确定合适的路径（覆盖一条或多条路线的路段）。

正如杰森正确指出的那样，这是一个寻路问题。对于这类问题，你可能应该先看看维基百科[关于寻路的文章](http://en.wikipedia.org/wiki/Pathfinding)，然后深入了解[Djikstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)的细节。这可能会让你开始。

然而，您很可能很快就会意识到您的数据模型可能会从结构和性能的角度提出问题。典型的例子是，如果您需要管理时间限制：假设您找到多条路径，哪条路径的行程时间最短？一条路径可能最短，但每天只提供一次骑行，而另一条路径可能更长，但每天提供几次骑行。

处理此问题的一种可能方法是创建一个图表，其中每个节点对应于特定时间的特定停靠点。一条边会在房间时间内从这个站点连接到其他地理站点，以及在下一个时间点连接到它自己。

我的建议是首先阅读寻路算法，然后根据您可能遇到的任何限制重新审视您的数据模型。然后，关注存储数据的结构，以及搜索路径的结构。

建议（效率不高，但如果您有足够的 RAM 可用，则可以使用）。使用关系数据库服务器存储基本信息：停靠点、哪些路线连接到哪些停靠点等。似乎你已经涵盖了这个。然后在给定约束的情况下构建图形的内存表示。您可能会为此非常快地构建自己的库（我不知道有任何此类 PHP 库）。

另一种选择是使用图形数据库，例如[Neo4j](http://neo4j.org)及其 REST 接口。我想这将需要对您的应用程序进行重大的重新设计。

希望这能给你一些有用的指示。

# php - Uploadify 加载缓慢和未捕获的错误

> ID：12827677
> 
> 赞同：5
> 
> 时间：2012-10-10T20:21:24.570
> 
> 标签：php, jquery, html, file-upload, uploadify

所以我正在尝试使用[此处](http://www.uploadify.com/)找到的uploadify插件在我的网站上实现上传功能到目前为止，这是我的html：

```
<form id="uploadForm" action="upload_file.php" method="post" enctype="multipart/form-data">
    <input type="file" name="file_upload" id="file_upload">
    <a href="javascript:$('#file_upload').uploadify('stop')">Stop Uploading</a> | <a href="javascript:$('#file_upload').uploadify('upload','*')">Upload</a>
</form> 
```

这是我的jQuery：

```
$('#file_upload').uploadify({
    'auto' : false,
    'buttonText' : "BROWSE",
    'fileSizeLimit' : '100MB',
    'queueSizeLimit' : 1,
    'fileTypeDesc' : 'Doc Files',
    'fileTypeExts' : '*.doc; *.docx',
    'buttonImage' : 'Images/browse-btn.png',
    'preventCaching' : false,
    'swf'      : 'uploadify.swf',
    'uploader' : 'upload_file.php'
}); 
```

我在文档的顶部有这个：

```
<script type="text/javascript" src="JS/jquery.uploadify.min.js"></script>
<link rel="stylesheet" type="text/css" href="CSS/uploadify.css" /> 
```

所以浏览按钮出现，所有选项都可以找到，但问题是两件事：
1）除非我刷新页面，否则上传栏不会加载。上传栏是这样的： ![上传状态](../Images/1d1bbbdc71f16b9b401170f590507a13.png)

这是一些swf问题吗？我从有人说在浏览器上加载 swf 时出现问题的人那里得到了一些东西。

2) 当我尝试点击状态栏上的 x 或尝试点击其下方的取消/上传链接时，浏览器会出现以下错误：

```
Uncaught Call to StartUpload failed jquery.uploadify.min.js:16
Uncaught Call to CancelUpload failed 
```

文件最终没有上传（显然）。知道如何解决问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T12:02:41.977

您正在使用哪个版本的 jQuery 以及在哪个浏览器上遇到错误。请在所有包含的 js 文件的顶部添加以下 jquery 版本

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script 
```

我已粘贴您的所有代码并尝试使用 uploadify 3.1 版本，但没有收到任何错误。以下是我的代码供您确认。

```
 <link rel="stylesheet" type="text/css" href="css/uploadify.css">
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="js/jquery.uploadify-3.1.min.js"></script>
    <script type="text/javascript">
    $(function() {
            $('#file_upload').uploadify({
            'auto' : false,
            'buttonText' : "BROWSE",
            'fileSizeLimit' : '100MB',
            'queueSizeLimit' : 1,
            'fileTypeDesc' : 'Doc Files',
            'fileTypeExts' : '*.doc; *.docx',           
            'preventCaching' : false,
            'swf'      : 'uploadify.swf',
            'uploader' : 'uploadify.php'
        });

    });
    </script>
</head>
<body>
<form id="uploadForm" action="upload_file.php" method="post" enctype="multipart/form-data">
    <input type="file" name="file_upload" id="file_upload">
    <a href="javascript:$('#file_upload').uploadify('stop')">Stop Uploading</a> | <a href="javascript:$('#file_upload').uploadify('upload','*')">Upload</a>
</form> 
```

这是我没有收到错误的完整代码。请尝试用上面的代码替换您的代码。

我希望它会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T13:56:05.243

检查您的闪存版本。我在 Ubuntu 上进行测试时遇到问题，因为它有点落后......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-17T13:26:23.537

**-> 检查您的上传文件夹是否具有写入权限。**

**-> 检查您的 php.ini 文件的上传设置。**

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-16T06:09:44.620

您只需要打开自动上传。为此，只需删除此行

```
'auto' : false 
```

一旦您将其添加到队列中，它将立即开始上传

# grails - 在 Amazon Elastic Beanstalk 上使用 REQUIRES_SECURE_CHANNEL 时，带有 Spring Security 插件的 Grails 不会从 http 重定向到 https

> ID：12827679
> 
> 赞同：1
> 
> 时间：2012-10-10T20:21:37.147
> 
> 标签：grails, https, amazon-web-services, spring-security, amazon-elastic-beanstalk

我正在使用带有 Spring Security 插件的 Grails 2.1。我有一些设置了 REQUIRES_SECURE_CHANNEL 的路径。当我使用“grails run-app -https”在我的机器上运行我的应用程序时，当从 http 访问需要 https 的路径时，一切正常（它们被重定向）。但是，在需要 https 的 Amazon Elastic Beanstalk 路径上，不会从 http 重定向到 https。

我已经设定

```
grails.plugins.springsecurity.secureChannel.useHeaderCheckChannelSecurity = true 
```

在 Config.groovy 中用于生产和

```
grails.plugins.springsecurity.secureChannel.useHeaderCheckChannelSecurity = false 
```

在 Config.groovy 中进行开发。

如果我远程登录到端口 80 并请求设置了 REQUIRES_SECURE_CHANNEL 的路径，这就是我在 Amazon Elastic Beanstalk 上看到的内容：

```
$ telnet www.example.com 80
Connected to www.example.com.
Escape character is '^]'.
GET /login/index HTTP/1.1
Host: www.example.com

HTTP/1.1 302 Moved Temporarily
Server: Apache-Coyote/1.1
Location: http://www.example.com/login/index
Content-Length: 0
Date: Wed, 10 Oct 2012 19:40:29 GMT 
```

如果我使用开发环境远程登录到端口 8080 并请求设置了 REQUIRES_SECURE_CHANNEL 的路径，这就是我在我的机器上看到的：

```
$ telnet localhost 8080
Trying ::1...
Connected to localhost.
Escape character is '^]'.
GET /server/login/index HTTP/1.1
Host: localhost:8080

HTTP/1.1 302 Moved Temporarily
Server: Apache-Coyote/1.1
Location: https://localhost:8443/server/login/index
Content-Length: 0
Date: Wed, 10 Oct 2012 19:27:09 GMT 
```

如何让我在 Amazon Elastic Beanstalk 上的应用程序正确转发将 REQUIRES_SECURE_CHANNEL 设置为从 http 到 https 的路径？

# google-maps-api-3 - 谷歌地图标记和折线颜色未在 IE7/8 中呈现

> ID：12827681
> 
> 赞同：2
> 
> 时间：2012-10-10T20:21:44.933
> 
> 标签：google-maps-api-3, internet-explorer-8, internet-explorer-7

我的网站上有一个显示标记和折线的 Google Maps v3。每组标记+折线都有自己的颜色（红色、黄色、蓝色等）。这在 FF/Chrome/Safari 中运行良好，但在 IE7/8 中运行良好（在 IE9 中运行良好）。

以下是 IE8/XP 中标记的样子：![没有颜色的标记](../Images/23f9cd4bda8842a62f8a43917ade7eb4.png)

标记应如下所示（在 Chrome 中）：![带有颜色的标记](../Images/bc309b02e51bc3ff7a34f0fecaeafeed.png)

DevTool 或 Firebug Lite 中没有 js 错误。

这是我用来显示标记和折线的代码：

```
Maps = {
    googleMap: null,
    paths: [],
    wayPoints: null,
    colors: ["#00aeef", "#ec008c", "#41ad49", "#d2232a", "#fff200"],
    minZoomLevel: 2,

    init: function () {
        var mapOptions = {
          zoom: Maps.minZoomLevel,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        Maps.googleMap = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

        google.maps.event.addListener(Maps.googleMap, 'zoom_changed', function() {
            if (Maps.googleMap.getZoom() < Maps.minZoomLevel)
                Maps.googleMap.setZoom(Maps.minZoomLevel);
        });
    },

    plotPaths: function (paths) {
        if (paths && paths.length === 0) {
            var latLng = new google.maps.LatLng(41.850033,-87.6500523);
            Maps.googleMap.setCenter(latLng);
            return;
        }

        Maps.paths = paths;
        //console.log(Maps.paths);
        Maps.wayPoints = [];
        for (pathIndex in Maps.paths) {
            Maps.wayPoints[pathIndex] = [];
        }

        for (pathIndex in Maps.paths) {
            for (addressIndex in Maps.paths[pathIndex]) {
                Maps.getLatLong(Maps.paths[pathIndex][addressIndex], pathIndex, Maps.addWaypoint);
            }
        }
    },

    addWaypoint: function(pathIndex, latLng, address) {
        // console.log("pathIndex: " + pathIndex);

        if (latLng === null) {
            Maps.googleMap.setCenter(new google.maps.LatLng(32.1574351, -82.90712300000001));
            return;
        }
        // console.log("callback - latLng: " + latLng.toString());

        Maps.wayPoints[pathIndex].push(latLng);

        if (Maps.wayPoints[pathIndex].length == Maps.paths[pathIndex].length) {
            if (typeof console !== "undefined") {
                console.log("Address: " + address);
                console.log(Maps.wayPoints[pathIndex]);
                console.log("Color: " + Maps.colors[pathIndex - 1]);
            }
            Maps.setShipmentPath(Maps.wayPoints[pathIndex], Maps.colors[pathIndex - 1]);
        }

        var marker = new google.maps.Marker({
            position: latLng,
            map: Maps.googleMap,
            title: address,
            icon: {
                path: google.maps.SymbolPath.CIRCLE,
                scale: 4,
                fillColor: Maps.colors[pathIndex - 1],
                fillOpacity: 1.0,
                strokeColor: Maps.colors[pathIndex - 1]
            }
        });

        Maps.googleMap.setCenter(latLng);
    },

    setShipmentPath: function (wayPoints, color) {
        var lineSymbol = {
            path: 'M 0,-1 0,1',
            strokeOpacity: 1,
            scale: 4
        };

        var shipmentPath = new google.maps.Polyline({
            path: wayPoints,
            strokeColor: color,
            strokeOpacity: 0,
            strokeWeight: 10,
            geodesic: true,
            icons: [{
                icon: lineSymbol,
                offset: '0',
                repeat: '20px'
            }]
        });

        shipmentPath.setMap(Maps.googleMap);
    },

    getLatLong: function (address, pathIndex, callback) {
        // console.log("Address: " + address);

        var geocoder = new google.maps.Geocoder();
        geocoder.geocode(
            {'address': address},
            function(results, status) {
                var latLng = null;

                if (status !== google.maps.GeocoderStatus.OK) {
                    if (typeof console !== "undefined") {
                        console.log("Error!");
                        console.log(status);
                    }
                    return;
                }

                if (results && results.length > 0) {
                    // console.log("Formatted Address: " + results[0].formatted_address);
                    // console.log("Lat Long: " + results[0].geometry.location.toString());
                    latLng = results[0].geometry.location;

                    if (callback) {
                        callback(pathIndex, latLng, results[0].formatted_address);
                    }
                }
            }
        );
    }
}; 
```

其中函数中的路径`plotPaths()`是地址列表的二维数组。例如

```
var addresses = new Array();
addresses["1"] = ["London  UK EC1", "Paris  FR "];
addresses["2"] = ["Vancouver BC CA "];
addresses["3"] = ["Melborne Vic AU "];
addresses["4"] = ["Cape Town  ZA "];
addresses["5"] = ["Tokyo  JP ", "Seoul Seoul KR 9199"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T14:46:54.923

对我来说，它最终成为这行代码：

```
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"> 
```

在我的 HTML 标题的顶部。

# python - 对象作为函数参数

> ID：12827683
> 
> 赞同：0
> 
> 时间：2012-10-10T20:21:47.180
> 
> 标签：python, object, arguments

我在 Python 中有以下类：

```
class String:    
    def clean_string(self, corpus):
        f = open(corpus, 'r')
        raw = f.read().lower()
        f.close()
        raw1 = re.sub(omissis, '', raw) 
        self.string = raw1

    def print_string(self):
        return self.string

class Set:
    def letters_set(self, string):
        self.let_set = set(re.findall(omissis, string))

class Dict:
    def __init__(self, dictionary={}):
        self.dictionary = {} 
        self.string = String()
        self.let_set = Set() 

    def generate_possible_triplets(self, let_set):
        triplet = [(ch1, ch2, ch3) for ch1 in let_set
                                   for ch2 in let_set
                                   for ch3 in let_set]
        [...] 
```

我对作为函数参数的对象有疑问。假设我想创建一个类的实例`Set`，其中一个类`String`并调用该方法`.letters_set(String.string)`。

我必须在括号内输入什么作为参数？我将创建的类字符串对象的名称？引用该对象的变量？（同样适用于中的方法`.generate_possible_triplets`。`Dict`应该`let_set`采取什么形式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:35:26.313

您可能只想让您的方法接受您的自定义类的实例......

```
class String:
    ...

class Set:
    def letters_set(self, stringObj):
        # stringObj is a String instance
        self.let_set = set(re.findall(omissis, stringObj.string))

class Dict:
    ...

    def generate_possible_triplets(self, setObj):
        # setObj is a Set instance
        triplet = [(ch1, ch2, ch3) for ch1 in setObj.let_set
                                   for ch2 in setObj.let_set
                                   for ch3 in setObj.let_set]

aString = String()
aSet = Set()
aDict = Dict()

aSet.letters_set(aString)
aDict.generate_possible_triplets(aSet) 
```

The methods can then expect to operate on those classes appropriately to access the attributes. This example is not specifically checking the capabilities of the objects being passed in, but they would obviously raise an exception when you try to access an improper object type that does not have a `.string` or `.let_set` attribute.

# datagridview - Datagridview 单元格的背景图片

> ID：12827684
> 
> 赞同：0
> 
> 时间：2012-10-10T20:21:48.223
> 
> 标签：datagridview, cell

是否可以使用图像（位图）设置 datagridview 单元格的背景？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T16:40:16.090

看看使用以下功能：

```
Private Sub DataGridView1_RowPostPaint(sender As Object, e As System.Windows.Forms.DataGridViewRowPostPaintEventArgs) Handles DataGridView1.RowPostPaint

End Sub 
```

或者

```
 Private Sub DataGridView1_CellPainting(sender As Object, e As System.Windows.Forms.DataGridViewCellPaintingEventArgs) Handles DataGridView1.CellPainting

 End Sub 
```

# javascript - Javascript日期表现怪异

> ID：12827685
> 
> 赞同：0
> 
> 时间：2012-10-10T20:21:52.163
> 
> 标签：javascript, jquery, date

好的，我听说过它，但我现在可以确认 Javascript 日期功能是一个灾难区。我用它创造了一个怪物。我有这个程序：

JSON 对象包含假期日期列表及其各自的标签。我需要找出从今天起**5 个工作日**的日期（不包括 JSON 对象中包含的星期六、星期日和节假日。）到目前为止的好东西。然后这 5 个工作日的**日期**将被 jquery 日历吞噬，作为**默认选择的日期**，它不包含在小提琴中，因为它无关紧要。（注意：日历上的开始日期是明天的日期） 又是好东西。那么，这部分来了：如果是在今天中午之前，我可以选择明天，**否则**开始日期是明天的后天。我正在详细说明这一点，因为它包含在这个小提琴中。

所以问题是处理上述功能的函数的多次初始化不会产生一致的结果。它在我的系统上计算 5 个工作日，但是当我制作这个小提琴时，它正在计算 4。**“第 5 个”**工作日的日期在每次调用时递增 1。

[http://jsfiddle.net/xXQ7j/27/](http://jsfiddle.net/xXQ7j/27/)

任何人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:38:07.700

您的问题*可能*是由时区问题引起的。

只要有可能，您应该使用它`new Date(y, m, d)`来创建一个日期对象，而不是提供一个字符串。特别是，我发现如果您指定格式的字符串，您将获得相对于 00:00 UTC 的日期，`yyyy-mm-dd`但如果您使用`yyyy/mm/dd`.

无论如何，我会建议一种不同的方法：

1.  将您的假期日期转换为对象，日期是关键
2.  生成今天的日期
3.  如果是在中午之后，请获取明天的日期 -`d.setDate(d.getDate() + 1)`
4.  创建一个空数组
5.  添加一天（根据上面的#3）
6.  检查新的一天是周六还是周日，如果是，返回#5
7.  检查新的一天是否在假期列表中，如果是，请返回#5
8.  将新日期添加到数组
9.  重复直到你有 10 个条目

这应该会给您阵列中接下来的 10 个工作日。选择您需要填写日期选择器的那些。

# javascript - Facebook 注册 - 使用 Javascript 读取数据/签名请求

> ID：12827686
> 
> 赞同：2
> 
> 时间：2012-10-10T20:21:57.193
> 
> 标签：javascript, facebook, coldfusion

我能够让注册表单与自定义字段一起使用，并通过重定向页面上的 cookie 检索自定义字段。我想不通的是如何在下一页检索 Facebook 信息（姓名、电子邮件、生日）（我不是 PHP 人）。我已经多次阅读文档，“读取数据”部分（[FB 文档](http://developers.facebook.com/docs/plugins/registration/)），并在互联网上搜索，但只能找到 PHP 和 C# 解决方案。

如果有人可以帮助我，我正在寻找 javascript、jQuery 或 ColdFusion 解决方案。

下面是我的代码作为快速参考。就目前而言，第 2 页只是转储 cookie 信息。

第 1 页

```
<html>
<head>
  <title>My Facebook Login Page</title>
</head>
<body>

<!--- Facebook Call --->
  <div id="fb-root"></div>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : 'myAppID', // App ID
        channelUrl : 'http://.../channel.html', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });
    };
    // Load the SDK Asynchronously
    (function(d){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/en_US/all.js";
       ref.parentNode.insertBefore(js, ref);
     }(document));
  </script>

<!--- Output Facebook Box---> 
<fb:registration redirect-uri="http://.../page2.cfm" 
    fields='[
        {"name":"name"},
        {"name":"email"},
        {"name":"displayName","description":"Display Name:", "type":"text"},
        {"name":"location"},
        {"name":"birthday"}
        ]'
    onvalidate="validateAndSave">
</fb:registration>

<!---Validation + set Cookie --->
<script>
     function validateAndSave(form) {
          if (!form.displayName) {
            return({"displayName":"Display Name is Required"});
          }
              document.cookie = 'fbInfo='+'displayName='+form.displayName;
              return {};
        }
</script>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T08:40:17.793

这是我基于 FB javascript API 反复试验的实现。

```
function checkFB()
{   
    if (typeof(FB) === "undefined")
    {
        var t = setTimeout("checkFB()", 1000);
        if (debug) console.log("FB is still undefined, try again in 1 second.");
    }
    else
    {
        if (debug) console.log("FB is defined, try to login -> ");

        //Function to check the current login status of facebook            
        FB.getLoginStatus(function(r)
        {
            if (r.status === "not_authorized")
            {
                if (debug) console.log("-> NOT AUTHORIZED ");
            }
            else if (r.status === "connected")
            {
                if (debug) console.log("-> connected ");

                if (r.authResponse) 
                {
                    FB.api('/me', function(rr) {
                        document.getElementById("fbFname").value = rr.first_name;
                        document.getElementById("fbLname").value = rr.last_name;
                        document.getElementById("fbEmail").value = rr.email;
                        document.getElementById("fbID").value = rr.id;
                        document.getElementById("status").value = "OK";
                    });

                    submitFB();
                } 
                else 
                {
                    document.getElementById("status").value = "NOT AUTHORIZED";
                    history.go(-1);
                    if (debug) console.log("NOT AUTHORIZED");
                }
            }
            else
            {
                if (debug) console.log("-> not connected -> POP UP BOX expected ");
                // start login process
                FB.login(function(re) 
                {
                    if (re.authResponse) 
                    {
                        FB.api('/me', function(rr) {
                            document.getElementById("fbFname").value = rr.first_name;
                            document.getElementById("fbLname").value = rr.last_name;
                            document.getElementById("fbEmail").value = rr.email;
                            document.getElementById("fbID").value = rr.id;
                            document.getElementById("status").value = "OK";
                        });
                        submitFB();
                    } 
                    else 
                    {
                        document.getElementById("status").value = "NOT AUTHORIZED";
                        history.go(-1);
                        if (debug) console.log("NOT AUTHORIZED");
                    }
                }, 
                {scope: 'email'}); // we define what information we want to get from the user
            }
        });
    }
} 
```

我希望你已经从 facebook 获得了一个 appID 并且有一个频道文件，他们需要替换 'myAppID' 和 'http://.../channel.html'。

```
 FB.init({
        appId      : 'myAppID', // App ID
        channelUrl : 'http://.../channel.html', // Channel File 
```

# google-apps-script - 无法使用 Html 服务设置 innerHeight

> ID：12827689
> 
> 赞同：0
> 
> 时间：2012-10-10T20:22:02.013
> 
> 标签：google-apps-script

这是一个带有脚本的玩具页面，该脚本将 innerHeight 分配到整个屏幕，不多也不少。

```
<html><body>
<div style="height:30px;">header<div>
<div id="box" style="border:3px solid red;"></div>
<script>document.getElementById("box").style.height=window.innerHeight-36;</script>
</body></html> 
```

如果我从以下脚本加载这样的页面：

```
function doGet() {
  return HtmlService.createTemplateFromFile('myPage').evaluate();
} 
```

javascript 代码行不起作用；也就是innerHeight的设置没有效果。有什么解决方法可以让第二个 div 填充屏幕的整个高度，不多也不少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:50:24.570

现在没有办法做到这一点。至少我知道的。在 Caja 问题跟踪器中打开了一个关于此[的](http://code.google.com/p/google-caja/issues/detail?id=1505)问题。您可能想给它加*星*标以跟踪更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:50:37.020

不，谢谢。HTML 服务似乎不接受 JavaScript 窗口方法。

# c# - 在 Firefox 中返回 false 导致我在想的 ajax 计时问题

> ID：12827690
> 
> 赞同：0
> 
> 时间：2012-10-10T20:22:10.993
> 
> 标签：c#, javascript, asp.net

我有一个添加 2 个数字的简单 ajax 页面。

当我在 IE 中运行时，异步回调起作用。

当我在 Firefox 中运行时，它不起作用。

我在 Firebug 中得到了正确的返回值，但 lblSum 在 Firefox 中保持空白。

它与btnAdd 单击处理程序末尾的**return false有关。**

有一个服务器端处理程序以防 Javascript 被禁用，所以在 Javascript 中我添加了一个 return false。

```
<script type="text/javascript">
    var pageWebForm1 = {
        txt1: document.getElementById('TextBox1'),
        txt2: document.getElementById('TextBox2'),
        lblSum: document.getElementById('LblSum'),
        btnAdd: document.getElementById('BtnAdd'),
        init: function() {
            this.btnAdd.onclick = function() {
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function() {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        xhrCallback(xhr.responseText);
                    }
                }
                xhr.open("POST", "Handler.ashx", true);
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhr.send("x=" + pageWebForm1.txt1.value + "&" + "y=" + pageWebForm1.txt2.value);
                return false;
            }
        }
    }
    pageWebForm1.init();

    function xhrCallback(retval) {
        pageWebForm1.lblSum.innerText = retval;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:31:29.470

它与 return false 语句无关。你的问题是 innerText 只是 IE。关于跨浏览器解决方案的另一个[stackoverflow 帖子。](https://stackoverflow.com/questions/1359469/innertext-works-in-ie-but-not-in-firefox)

# css - 基于输入和类的样式 CSS

> ID：12827693
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:19.813
> 
> 标签：css, css-selectors

当类是“chatInput”时，是否有一种简单的方法可以防止使用样式。示例 HTML：

```
<input type="button" value="hello" class="chatInput"/> 
```

和 CSS 类似：

```
input[type=button&class!=chatInput], input[type=submit&class!=chatInput]{
    border: 1px solid grey;
    padding: 2px 10px 2px 10px;
    margin-top: 5px;
    margin-bottom: 5px;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T20:26:59.127

您可以使用[选择器](http://reference.sitepoint.com/css/pseudoclass-not)： [`:not`](http://reference.sitepoint.com/css/pseudoclass-not)

```
input[type=button]:not(.chatInput), input[type=submit]:not(.chatInput)
    border: 1px solid grey;
    padding: 2px 10px 2px 10px;
    margin-top: 5px;
    margin-bottom: 5px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:28:51.463

在 CSS3 中，您可以使用[`:not()`选择器](http://www.w3schools.com/cssref/sel_not.asp)：

```
input[type=button]:not(.chatInput), input[type=submit]:not(.chatInput){
    border: 1px solid grey;
    padding: 2px 10px 2px 10px;
    margin-top: 5px;
    margin-bottom: 5px;
} 
```

在 CSS2 中，更具体地说是 IE8 及更低版本，您不能这样做。您必须执行以下操作：

```
input[type=button] {
    border: 1px solid grey;
    padding: 2px 10px 2px 10px;
    margin-top: 5px;
    margin-bottom: 5px;
}
input[type=button] .chatInput {
    /* Explicit default style */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:27:13.857

Mozilla 与

```
:not(.classname) input {background: red;} 
```

虽然我尽量避免负面的CSS。也许其他所有东西（除了.chatInput）都应该有一个额外的类。

# postgresql - Postgresql 9.2 触发器记录对另一个表中数据的更改

> ID：12827694
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:20.190
> 
> 标签：postgresql, stored-procedures, triggers

我有几张表，想记录对它们进行更改的时间、更改的内容以及更改的人员。PostgreSQL 9.2

```
CREATE TABLE unitsref (
unitsrefid serial primary key,
units varchar,
unitname varchar,
inuse boolean,
systemuse varchar,
keynotes integer,
linkid integer
); 
```

使用 OLD.* IS DISTINCT FROM NEW.* 的最佳做法是什么？

```
CREATE TRIGGER log_unitsref
    AFTER UPDATE ON unitsref
    FOR EACH ROW
    WHEN (OLD.* IS DISTINCT FROM NEW.*)
EXECUTE PROCEDURE log_unitsref(); 
```

我只对三个领域真正感兴趣：

```
units varchar,
unitname varchar,
inuse boolean, 
```

我想将这些更改记录在带有以下字段的表事件日志中：

```
recordtype varchar,
recordkey varchar,
changetype varchar,
personid integer,
changedate date,
changetime time,
changefrom varchar,
changeto varchar, 
```

编写函数来执行此操作的最佳语法是什么？在进行中 Openedge 我会写

```
create  EventLog.
assign  EventLog.PersonId    = glb-Personid
        EventLog.RecordType  = "UnitsRef"
        EventLog.RecordKey   = UnitsRef.Units
        EventLog.ChangeType  = "Create"
        EventLog.changeFrom  = ""
        EventLog.changeTo    = ""
        EventLog.changeDate  = today
        EventLog.changeTime  = time 
```

但我不知道 Postgresql 中的最佳方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T21:31:19.813

> 我只对这三个领域真正感兴趣

那么只在更改这些字段后调用触发器应该会更有效：

```
 CREATE TRIGGER log_unitsref
AFTER UPDATE **OF units, unitname, inuse**
ON unitsref
FOR EACH ROW
**WHEN (OLD.units, OLD.unitname, OLD.inuse) IS DISTINCT FROM
     (NEW.units, NEW.unitname, NEW.inuse)**
EXECUTE PROCEDURE log_unitsref();
```

我引用[手册`CREATE TRIGGER`](http://www.postgresql.org/docs/current/interactive/sql-createtrigger.html)：

`UPDATE OF`...

> 仅当列出的列中的至少一个列被提及为 UPDATE 命令的目标时，触发器才会触发。

`WHEN`...

> 一个布尔表达式，用于确定触发器函数是否将实际执行。

请注意，这两个元素密切相关，但既不相互排斥也不冗余。

*   如果不涉及感兴趣的列，则根本不触发触发器要便宜得多。

*   如果没有实际更改感兴趣的列，则不执行触发功能要便宜得多。

相关答案[在这里](https://stackoverflow.com/a/7915100/939860)或[这里](https://stackoverflow.com/a/9547710/939860)...

# php - PHP - preg_replace 不匹配多次出现

> ID：12827695
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:24.863
> 
> 标签：php, regex, preg-replace

试图替换一个字符串，但它似乎只匹配第一次出现，如果我有另一个出现它不匹配任何东西，所以我想我需要添加某种结束分隔符？

我的代码：

```
$mappings = array(
    'fname'     => $prospect->forename,
    'lname'     => $prospect->surname,
    'cname'     => $prospect->company,
);

foreach($mappings as $key => $mapping) if(empty($mapping)) $mappings[$key] = '$2';

$match  = '~{(.*)}(.*?){/.*}$~ise';
$source     = 'Hello {fname}Default{/fname} {lname}Last{/lname}';
// $source  = 'Hello {fname}Default{/fname}';

$text = preg_replace($match, '$mappings["$1"]', $source); 
```

因此，如果我使用已注释的 $source，它匹配得很好，但如果我使用上面代码中当前有 2 个匹配的那个，它不匹配任何东西，我得到一个错误：

```
Message: Undefined index: fname}Default{/fname} {lname

Filename: schedule.php(62) : regexp code 
```

那么我是否正确地说我需要提供一个结束分隔符或其他东西？

谢谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:30:29.650

显然你的正则表达式匹配`fname}Default{/fname} {lname`而不是`Default`.

正如我在[这里](https://stackoverflow.com/questions/12824436/i-want-to-add-a-referral-link-to-the-url-using-preg-replace/12824580#12824580)提到的，使用`{(.*?)}`而不是`{(.*)}`.

`{`在正则表达式中具有特殊含义，因此您应该对其进行转义`\\{`。

而且我建议使用[`preg_replace_callback`](http://www.php.net/manual/en/function.preg-replace-callback.php)代替`e`修饰符（您有更多的流控制和语法高亮显示，并且不可能强制您的程序执行恶意代码）。

您犯的最后一个错误是没有检查请求的索引是否存在。:)

我的解决方案是：

```
<?php

class A { // Of course with better class name :)
    public $mappings = array(
        'fname' => 'Tested'
    );

    public function callback( $match)
    {
        if( isset( $this->mappings[$match[1]])){
            return $this->mappings[$match[1]];
        }

        return $match[2];
    }   
}

$a = new A();
$match  = '~\\{([^}]+)\\}(.*?)\\{/\\1\\}~is';
$source     = 'Hello {fname}Default{/fname} {lname}Last{/lname}';

echo preg_replace_callback( $match, array($a, 'callback'), $source); 
```

这导致：

```
[vyktor@grepfruit tmp]$ php stack.php
Hello Tested Last 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:51:21.080

您的正则表达式锚定到字符串的末尾，因此您的关闭`{/whatever}` **必须**是字符串中的最后一件事。此外，由于您的开始和结束标签是简单`.*`的，因此没有任何内容可以确保它们匹配。您想要的是确保您的结束标签与您的开始标签匹配 - 使用类似的反向引用`{(.+)}(.*?){/\1}`将确保它们相同。

我敢肯定那里还有其他问题——如果你可以控制你正在使用的字符串的格式（IE——你正在使用自己的模板语言），我会认真考虑转向更简单、更容易匹配的格式。由于您没有“保存”默认值，因此使用封闭标签不会为您提供任何附加值，但会使解析更加复杂。只是 using`$VARNAME`也同样有效，并且更容易匹配 ( `\$[A-Z]+`)，而无需涉及反向引用或不必明确声明您正在使用非贪婪匹配。

# unit-testing - 在 Microsoft Moles 中创建部分存根

> ID：12827698
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:29.820
> 
> 标签：unit-testing, moles, stub

我用这个把头发拉出来。我已经查看并找不到使用 Microsoft Moles 创建和使用部分存根的简单、清晰的示例。也许我错过了一些东西，或者我的代码架构很差，但我似乎无法让它工作。

这是我的课（简化版）：

```
public class AccountService : IAccountService {
        private readonly webServiceProxy IExternalWebServiceProxy;

    public AccountService(IExternalWebServiceProxy webServiceProxy) {
        this.webServiceProxy = webServiceProxy;
    }

    public List<AccountModel> GetAccounts(string customerId) {
         var returnList = new List<AccountModel>();
         var xmlResponse = webServiceProxy.GetAllCustomerAccounts(customerId);

         var accountNodes = xmlResponse.SelectNodes("//AccountNodes");
            if (accountNodes != null)
            {
                foreach (XmlNode node in accountNodes)
                {
                    var account = this.MapAccountFromXml(node);

                    if (!string.IsNullOrEmpty(account.AccountNumber))
                    {
                        returnList.Add(account);
                    }
                }
            }

            return returnList;
    }

    public AccountModel MapAccountFromXml(XmlNode node) {
        if (!IsValidAccount(node) {
            return null;
        }

        // This performs a lot of XML manipulation getting nodes based on attributes 
        // and mapping them to the various properties of the AccountModel. It's messy 
        // and I didn't want it inline with the other code.

        return populatedAccountModel;
    {

    public bool IsValidAccount(XmlNode node) 
    {
        var taxSelectValue = node.SelectSingleNode("//FORMAT/Field[@taxSelect='1']").First().Value;
        var accountStatus = // similar to first line in that it gets a single node using a specific XPath
        var maturityDate = // similar to first line in that it gets a single node using a specific XPath
        var maturityValue = // similar to first line in that it gets a single node using a specific XPath

        return taxSelectValue != string.Empty && taxSelectValue != "0" && (accountStatusValue != "CL" || (maturityDate.Year >= DateTime.Now.AddYears(-1).Year));
    }
} 
```

我想做的是测试我的 GetAccounts() 方法。我可以存根 IExternalWebServiceProxy 调用并返回假 XML，但我的服务中发生了内部调用，因为我的 GetAccounts() 方法调用 MapAccountFromXml()，而 MapAccountFromXml() 又调用 IsValidAccount()。

也许解决方案是不用担心分解冗长且涉及的 MapAccountFromXml() 和 IsValidAccount() 代码，只需将它们内联到 GetAccount() 调用中，但我宁愿将它们分解为代码可读性。

我创建了我的 Moles 程序集，并且知道我可以像这样创建我的类的存根版本

```
var stubWebService = SIExternalWebServiceProxy {
       GetAllCustomerAccounts = delegate {
            return SomeHelper.GetFakeXmlDocument();
       }
}

var stubAccountService = new SAccountService() { callsBase = true; } 
```

我的问题是我不知道如何覆盖对 MapAccountFromXml 和 IsValidAccount 的内部调用，并且我不希望我的单元测试测试这些方法，我想隔离 GetAccounts 进行测试。我在某处读到方法需要是虚拟的才能在部分存根中被覆盖，但是找不到任何东西来说明如何创建一个覆盖几个方法的存根，同时为我想要测试的方法调用基。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T16:03:40.120

同行让我走上正轨，谢谢。

原来，我一直在寻找的东西叫做 Detours in Moles。而不是使用存根接口

```
var stubAccountService = new SIAccountService(); 
```

我需要做的是创建我的 AccountService 的一个实例，然后绕过对我想要模拟的方法的所有调用，就像这样

```
var accountService = new AccountService();

MAccountService.AllInstances.MapAccountFromXmlXmlNode = delegate { 
    return new AccountModel(); 
}; 
```

当您对您的程序集进行 Mole 时，Moles 会提供 MAccountService。唯一缺少的部分是，要使其正常工作，您需要将以下属性添加到您的测试方法中：

```
[HostType("Moles")] 
```

这在本地对我有用，但最后我无法让 TFS 进行自动构建

# **更新**

在查看 Rhino Mocks 时，我偶然发现了另一种方法。如果被模拟的类中的方法是*虚拟*的，那么您可以在模拟中覆盖它们，如下所示：

```
var accountService = new SAccountService();
accountService.MapAccountFromXmlXmlNode = delegate
    {
        return new AccountModel();
    } 
```

现在我可以打电话了

```
accountService.GetMemberAccounts(); 
```

当 accountService 调用 MapAccountFromXml 时，它将被存根捕获并在我认为必要时进行处理。没有搞乱 HostType，它就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T08:32:36.223

要单独测试您的类中的方法，您可以通过为 IsValidAccount 和 MapAccountFromXml 方法制作一个痣来使用痣。或者使用存根实现存根，让存根使用 base 调用原始方法。或者我认为是一个更好的解决方案，创建一个覆盖您想要存根的方法的测试类（这与存根所做的相同，除非您看到自己的代码中发生的所有事情）：

```
public class TestHelperAccountService : AccountService {

    public override AccountModel MapAccountFromXml(XmlNode node) {
        return new AccountModel(){
                    //Accountmodelstub
              };
    {

    public override bool IsValidAccount(XmlNode node) 
    {
        return true;
    }
} 
```

这样，您可以在您的 GetAccount 方法完全隔离运行的 TestHelperAccountService 类上对 GetAccount 方法进行测试。您可以对 MapAccountFromXml 等方法执行相同的操作来单独测试它们。

# android - 从 AsyncTask 调用 AsyncTask

> ID：12827701
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:35.703
> 
> 标签：android, android-asynctask

虽然我还没有尝试过，但从理论的角度来看，我问这个问题只是为了消除我的疑虑。

我有这样的场景： 1\. 向服务器发送请求并接收`JSON`响应。为此，我正在使用`AsyncTask`，因为接收响应可能会有延迟。2\. 从此响应中获取图像 URL。3\. 再使用一个`AsyncTask`，调用图片URL并获取图片。（再次可能需要时间来获取图像）

所以你认为使用 2 AyncTask 只是为了得到那个图像是低效的。或者，在步骤 1 中，不使用 AsyncTask，而是按顺序运行代码并设置 Timeout。

请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:53:50.030

我将继续并建议将此作为答案，最初是在我的评论中：

只需在您从中获取 JSON 的同一个 AsyncTask 中同步获取图像。例如：

```
doInBackground(Void...params){
    //fetch JSON
    // once JSON is fetched, fetch image
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:47:09.300

不知道你想如何准确地构建它，但文档说：

```
execute(Params...) must be invoked on the UI thread. 
```

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

因此您无法从其他异步任务后台方法执行新的异步任务。

即使您尝试从进度方法执行此操作，但由于 HONEYCOMB 异步任务已序列化，因此您的第二个异步任务无论如何都会排队 - 您必须使用 THREAD_POOL_EXECUTOR 使其并行运行。

# css - 样式 TD 像 TR 奇数/偶数

> ID：12827702
> 
> 赞同：1
> 
> 时间：2012-10-10T20:22:38.480
> 
> 标签：css

我需要根据奇数/偶数更改 td 的文本颜色，例如[http://jsfiddle.net/N9gEG/](http://jsfiddle.net/N9gEG/)

实际上我有一个这样做的类，但是，我想从 css 做

```
<table>
    <tr>
        <td>RED</td>
        <td class="foo">BLUE</td>
        <td>RED</td>
        <td class="foo">BLUE</td>
    </tr>
</table> 
```

对于`tr`奇数/偶数，我有以下代码：`table tr:nth-child(even)`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-10T20:25:15.620

```
td {
  color: blue;
}
td:nth-child(even) {
  color: red;
} 
```

这是因为规则的特殊性。更具体的 CSS 规则获胜。`td`没有其他任何东西都不如`td:nth-child(even)`，因此它自动适用于奇数`<td>`s。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T20:36:25.790

如果你的 jsFiddle 正确地说明了你想要什么，你可以简单地使用`:nth-child`tds 而不是 tr 上的选择器：

```
td { color: blue; }
td:nth-child(odd) { color: red; } 
```

[http://jsfiddle.net/N9gEG/2/](http://jsfiddle.net/N9gEG/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T20:35:02.643

鉴于我对您的问题的理解有限，我建议：

```
td:nth-child(even) {
    color: blue;
}
td:nth-child(odd) {
    color: red;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/N9gEG/1/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-10T20:24:54.197

使用 jQuery

```
.hover {background-color:green !important;}
.odd {background-color:blue}

$("#MyTable tr:odd").addClass("odd"); 
$("#MyTable tr").mouseover(function() { $(this).addClass("hover"); });
$("#MyTable tr").mouseout(function() { $(this).removeClass("hover"); }); 
```

# php - Mysql查询更新

> ID：12827705
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:22:50.080
> 
> 标签：php, mysql

> **可能重复：**
> [MySQL - 何时使用单引号、双引号和反引号？](https://stackoverflow.com/questions/11321491/mysql-when-to-use-single-quotes-double-quotes-and-backticks)

我有这段代码，我无法正常工作。

```
require_once("../Packages/Connection.php");

        $text = mysql_real_escape_string($_POST["articleText"]);

        $method = $_POST['method'];
        $articleId = $_POST['articleId'];

        if($method == "update")
        {
            mysql_query("UPDATE Articles SET 'text'='".$text."' WHERE 'id'='".$articleId."'") or die(mysql_error());
        } 
```

这让我很烦，这是我得到的错误 - 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''text'='tester2' WHERE 'id'='29'' 附近使用正确的语法...

预先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:24:56.567

为什么你的 SQL 中有“文本”...

它应该只是文本，仅此而已：（ID 相同）

```
mysql_query("UPDATE Articles SET text = '".$text."' WHERE id='".$articleId."'") or die(mysql_error()); 
```

您可能会将“'”与转义字符的反引号或“`”混淆并且对保留关键字很有用......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:31:42.867

尝试

```
 mysql_query("UPDATE Articles SET `text`='".$text."' WHERE `id`='".$articleId."'") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:24:11.230

```
 mysql_query("UPDATE Articles SET text='".$text."' WHERE id='".$articleId."'") or die(mysql_error()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T21:04:26.897

首先构建查询，然后执行它：

```
$sql = "UPDATE Articles SET 'text'='".$text."' WHERE 'id'='".$articleId."'";
$r = mysql_query($sql);
if (!$r) {
    echo "Query: ", $sql, "\n";
    echo "Error: ", mysql_error();
    die();
} 
```

这将允许您更好地查看您发送到数据库的*确切*内容，以便您可以实际检查错误消息向您建议*的语法。*

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-10-10T20:26:29.670

你应该用这个

```
mysql_query("UPDATE Articles SET text ={$text} WHERE id ={$articleId}") or die(mysql_error ()); 
```

# solr - Solrj pojo Java 类型如何映射到 Solr 类型？

> ID：12827709
> 
> 赞同：2
> 
> 时间：2012-10-10T20:22:53.840
> 
> 标签：solr, solrj

我是 Solr 的新手，我正在尝试使用 Solrj pojo 来创建我的文档。

我应该在我的 pojo 中遵守 Solr 类型到 Java 的映射吗？pojo 中的所有内容都是字符串吗？是否有从 Java 基本类型到 Solr 的神奇映射并且它是透明的？

这似乎是一个基本问题，但我找不到答案。

TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:57:48.233

您可以使用`@Field`注释将 pojo 映射到 solr 类型`solrj`

下面是示例代码

```
import org.apache.solr.client.solrj.beans.Field;

public class Person {

    @Field
    private int id;

    @Field("first_name")
    private String firstName;

    @Field("last_name")
    private String lastName;

    @Field
    private String age;

    // Getters & setters

} 
```

您`schema.xml`应该包含字段`id, first_name, last_name, age`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T15:53:17.603

这个问题的答案似乎是对于 Solrj bean（使用@Field），字段的 Java 类型是对应于 solr.*Field 类型的 Java *OBJECT 。*

例如 solr.BoolField 映射到 java.lang.Boolean。

Long、Integer、Float、...

我希望这可以帮助下一个可怜的灵魂:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:05:26.757

Solrj 可以使用 RequestWriter 将文档流式传输为 XML 或二进制文件。document.addField 方法确实需要一个对象，因此可以传递 Java 数据类型，但我没有看到映射。如果有的话，它可能会假设基本数据类型。如果您查看示例代码，情况就是如此。

如果我没记错的话（这是不久前的），我们只是遇到了日期问题，并为此编写了自己的格式化程序。这是从 Solr 1.2 天开始的，代码运行良好，仍在生产中

[http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/common/SolrInputDocument.html](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/common/SolrInputDocument.html)

这是 InputType 的 JavaDoc。[http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/common/SolrInputField.html](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/common/SolrInputField.html)

# ios5 - UIViewContentMode 模式指的是什么类型的内容？

> ID：12827710
> 
> 赞同：8
> 
> 时间：2012-10-10T20:22:55.743
> 
> 标签：ios5, uiview, contentmode, uiview-hierarchy

根据 UIView 关于该`contentMode`属性的官方文档：

```
The content mode specifies how the cached bitmap of the view’s layer is adjusted when the view’s bounds change 
```

这个定义中的内容是什么定义的？例如，它是子视图还是当我们为视图定义了背景颜色时。

我的第一个猜测是，它至少应该适用于视图中的子视图，但例如以下代码片段在使用 `UIViewContentModeCenter`标签时不会给我预期的结果：

```
 UIView* redView = [[UIView alloc] initWithFrame:CGRectMake(80, 80, 150, 200)];
 redView.contentMode = UIViewContentModeCenter;
 redView.backgroundColor = [UIColor redColor];

 UIView* greenView = [[UIView alloc] initWithFrame:redView.bounds];
 greenView.backgroundColor = [UIColor greenColor];
 [redView addSubview:greenView];

 redView.frame = CGRectInset(redView.frame, -5, -5);
 [self.view addSubview:redView]; 
```

我刚刚设置了一个包含 greenView 的 redView。我还将 redview 的内容模式设置为`UIViewContentModeCenter`- 为什么在我编写的代码中，当我更改其父级的框架时，greenView 没有居中？不应`UIViewContentModeCenter`该做什么？

感谢您的澄清！

**Ps：**`loadView`你可以在一个简单的视图控制器模板项目中轻松测试上面的代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-28T06:27:05.380

> 从文档中：
> 
> 内容模式指定当视图的边界发生变化时如何调整视图层的缓存位图。
> 
> 对于图像视图，这是在谈论图像。对于绘制其内容的视图，这是在谈论绘制的内容。它不影响子视图的布局。
> 
> 您需要查看子视图上的自动调整大小掩码。内容模式在这里是一个红鲱鱼。如果您无法使用自动调整大小的掩码实现所需的布局，那么您需要实现 layoutSubviews 并手动计算子视图的位置和框架。

来自 jrturton 的回答：[https ://stackoverflow.com/a/14111480/1374512](https://stackoverflow.com/a/14111480/1374512)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-20T13:18:41.230

[首先在此处](http://developer.apple.com/library/ios/documentation/windowsviews/conceptual/viewpg_iphoneos/WindowsandViews/WindowsandViews.html#//apple_ref/doc/uid/TP40009503-CH2-SW2)阅读有关*内容模式的信息*

在您的示例中，您更改了红色视图的框架。这将在视图上调用 layoutSubviews，该视图将根据布局约束或自动调整掩码重新定位绿色视图。你没有指定任何。所以绿色视图的框架将保持不变。

内容模式指定视图层在调整大小时应如何更新。根据内容模式 drawRect 是否会被调用。

您可以通过以下示例测试不同内容模式的效果：

添加一个 UIView 子类，它使用这个 drawRect 实现绘制一个圆：

```
- (void)drawRect:(CGRect)rect
{
    // Drawing code
    NSLog(@"drawRect %@", NSStringFromCGRect(rect));

    CGContextRef ctx = UIGraphicsGetCurrentContext();
    CGContextAddEllipseInRect(ctx, self.bounds);
    [[UIColor redColor] setFill];
    CGContextFillPath(ctx);
} 
```

在视图控制器中创建并添加圆形视图：

```
CircleView* circleView = [[CircleView alloc] initWithFrame:CGRectMake(10, 10, 20, 20)];
circleView.contentMode = UIViewContentModeCenter; // <- try different modes here
[self.view addSubview:circleView]; 
```

现在让帧动画，看看会发生什么：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [UIView animateWithDuration:5 animations:^{
        circleView.frame = CGRectMake(10, 10, 100, 200);
    }];
}); 
```

我正在异步执行此操作，以强制 CoreGraphics 使用原始帧至少绘制一次视图。当您不设置内容模式时，您最终会得到一个模糊的圆圈，因为它只是按比例放大而无需重绘。UIViewContentModeCenter 使小圆圈保持在中心 - 也不需要重绘。UIViewContentModeRedraw 使视图使用新框架再次绘制视图。实际上，这发生在动画开始之前。

请注意，内容模式会影响绘图性能。

# vb.net - 字典数组列表

> ID：12827712
> 
> 赞同：2
> 
> 时间：2012-10-10T20:23:16.363
> 
> 标签：vb.net, list, dictionary, multidimensional-array, webmethod

碰壁，在文档中找不到太多。

我有两本字典，我想把它们放在一个列表中。

```
Dim listOfDictionaries As List(Of Dictionary(Of String, String)) 
```

不管用。

我是否正确假设一旦我变暗，我可以 .add 传统方式？

**详细信息（编辑）**

尝试 listOfDictionaries.Add(dictionaryIWantToAdd) 时，我得到“'1-dimensional array system.collection.generic.dictionary(of string, string)'类型的值不能转换为'system.collection.generic.dictionary(of string) ， 细绳）'

**解决方案**

有助于将 () 放在数组的末尾。:P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:27:11.247

常规方式是：

```
Dim both = New List(Of Dictionary(Of String, String))()
both.Add(Dictionary1)
both.Add(Dictionary2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:41:39.797

错误说明了一切。您正在尝试将字典数组添加到列表中，但 add 方法只需要一个字典，而不是它们的数组。要么修复它，所以你只传递一个字典：

```
Dim myDictionary As Dictionary(Of String, String)
' ...
listOfDictionaries.Add(myDictionary) 
```

或者使用`AddRange`方法一次添加数组中的所有字典：

```
Dim myArrayOfDictionaries() As Dictionary(Of String, String)
' ...
listOfDictionaries.AddRange(myArrayOfDictionaries) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-07T13:10:39.893

当它像这样简单时，我倾向于使用单行解决方案，使用[`From`](https://msdn.microsoft.com/en-us/library/bb384802.aspx)关键字。

```
Dim listOfDictionaries = New List(Of Dictionary(Of String, String)) From { dictionary1, dictionary2 } 
```

# c# - 在其他线程中更改计时器间隔

> ID：12827714
> 
> 赞同：2
> 
> 时间：2012-10-10T20:23:20.983
> 
> 标签：c#, .net

我想在另一个线程中更改计时器间隔：

```
 class Context : ApplicationContext {
       private System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer();
       public Context() {
           timer.Interval = 1;
           timer.Tick += timer_Tick;
           timer.Start();
           Thread t = new Thread(ChangeTimerTest);
           t.Start();
       }
       private void ChangeTimerTest() {
           System.Diagnostics.Debug.WriteLine("thread run");
           timer.Interval = 2;
       }
       private void timer_Tick(object sender,EventArgs args) {
           System.Diagnostics.Debug.WriteLine(System.DateTime.Now.ToLongTimeString());
       }
    } 
```

但是当我更改新线程中的间隔时，计时器会停止。没有错误，计时器只是停止。为什么会发生这种情况，我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:36:11.153

试试这个，我试过了，它可以工作，我只将新的间隔从 2 更改为 2000 毫秒，这样你就可以看到输出中的差异。您必须以线程安全的方式更改间隔，因为计时器位于 UI 线程上下文中。在这些情况下，建议使用委托。

```
private System.Windows.Forms.Timer timer = new System.Windows.Forms.Timer();
    public void Context() {
        timer.Interval = 1;
        timer.Tick += timer_Tick;
        timer.Start();
        Thread t = new Thread(ChangeTimerTest);
        t.Start();
    }
    delegate void intervalChanger();
    void ChangeInterval()
    {
        timer.Interval = 2000;
    }
    void IntervalChange()
    {
        this.Invoke(new intervalChanger(ChangeInterval));
    }
    private void ChangeTimerTest() {
        System.Diagnostics.Debug.WriteLine("thread run");
        IntervalChange();
    }
    private void timer_Tick(object sender,EventArgs args) {
        System.Diagnostics.Debug.WriteLine(System.DateTime.Now.ToLongTimeString());
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T22:00:17.493

In addition to my previous answer, since you are not using Forms, try to change your System.Windows.Forms.Timer to System.Timers.Timer. Note that it has Elapsed Event, not Tick. The following is the code:

```
System.Timers.Timer timer = new System.Timers.Timer();
    public Context() {
        timer.Interval = 1;
        timer.Elapsed += new System.Timers.ElapsedEventHandler(timer_Elapsed);   

        timer.Start();
        Thread t = new Thread(ChangeTimerTest);
        t.Start();
    }

    void timer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        System.Diagnostics.Debug.WriteLine(System.DateTime.Now.ToLongTimeString());
    }

    private void ChangeTimerTest() {
        System.Diagnostics.Debug.WriteLine("thread run");
        timer.Interval = 2000;
    } 
```

Hope this will finally help!

# javascript - 加载标签在 extjs 组合框上放错了位置

> ID：12827716
> 
> 赞同：0
> 
> 时间：2012-10-10T20:23:33.013
> 
> 标签：javascript, jquery, extjs

我有一个 ext.data.store 和 Ext.form.field.ComboBox。商店每 5 秒重新加载一次来自 php 的新数据。我遇到的问题是，当我按下组合框并加载新数据时，显示预加载器的加载标签位于左上角或组合框后面或屏幕中间的某个位置（如果我移动）组合窗口。

我该如何解决这个问题或我做错了什么？

这是一个示例代码：

```
Ext.define('MyModel', {
extend: 'Ext.data.Model',
fields: [
    {name: 'id',  type: 'string'},
    {name: 'type',   type: 'int'},
    {name: 'myarray', type: 'auto'}
], 
```

});

```
var myStore = new Ext.data.Store({
model: 'MyModel',
proxy: {
    type: 'ajax',
    url : '/users.json',
    reader: {
        type: 'json',
        root: 'MyModel'
    }
},
autoLoad: true
});

var createCombo = function(){
// Create the combo box, attached to the states data store
Ext.create('Ext.form.ComboBox', {
    fieldLabel: 'Choose State',
    store: myStore ,
    queryMode: 'remote',
    displayField: 'type',
    valueField: 'id'
});

}

createCombo (); 
```

我将此代码作为我在开发中使用的代码。它运作良好，但加载标签放错了位置

# visual-c++ - 在 Windows Server 2003 上安装 Microsoft Visual C++ 2010 Redistributable 时出现 msvcrt.dll 问题

> ID：12827721
> 
> 赞同：2
> 
> 时间：2012-10-10T20:23:50.963
> 
> 标签：visual-c++, dll

当我尝试安装 Microsoft Visual C++ 2010 Redistributable 时，出现以下错误。

![在此处输入图像描述](../Images/e4960a48f941ef09b489202cf7607b57.png)

我有一个更新的 msvcrt.dll 来替换当前的，但每次我删除/替换旧的 dll 窗口时，都会将旧的重新添加到 system32 文件夹中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:40:31.763

了解您正在使用的操作系统版本会很有用。可能是 Windows 2000 或 XP（我从屏幕截图中猜测，但也可能超过 RDP）。

当`msvcrt.dll`在 XP 的生命周期中成为一等公民（即系统 DLL）时，也对其进行了一些更改。不兼容的更改，我应该添加。`msvcrt.dll`示例：如果您以前针对 VS CRT 构建了一个程序（例如，使用 WDK/DDK），您可以相信它从现有版本的最小公分母开始工作。但是，在某些时候，MS 决定为目标构建的程序（例如，XP）可以依赖于潜入较新版本的`msvcrt.dll`. 因此观察到不相容性。

使其工作的一种方法可能是`msvcrt.dll.local`在同一文件夹中添加一个文件，或者 - 如果失败 - 创建一个 shim 来强制执行您的预期行为。见[这里](http://blogs.technet.com/b/askperf/archive/2011/06/17/demystifying-shims-or-using-the-app-compat-toolkit-to-make-your-old-stuff-work-with-your-new-stuff.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T23:58:12.370

得到类似的错误。通过在安装前重新启动服务器来修复它。

# clojure - 强制 Cake 从我的 .clj 文件中重新加载函数

> ID：12827725
> 
> 赞同：1
> 
> 时间：2012-10-10T20:24:04.647
> 
> 标签：clojure, jvm

我是 Clojure 的新手，在我已经浪费了太多时间等待 Leiningen 运行我的代码之后，我正试图转向 Cake。虽然 Cake 的持久 JVM 加载速度非常快——它提出了一个更大的问题——但我的函数也是持久的！

为了演示这个问题，我开始了一个蛋糕项目（使用`cake new mess-up-with-cake`），并写在`core.clj`：

```
(ns mess-up-with-cake.core)

(defn main-function[]
  (println "I'm in the main function")
)

(println "I'm in core.clj, not inside in any function") 
```

这是`project.clj`：

```
(defproject mess-up-with-cake "0.0.1-SNAPSHOT"
  :description "TODO: add summary of your project"
  :dependencies [[clojure "1.2.0"]])

(use 'mess-up-with-cake.core)
(deftask my-task
         (println "I'm in my task")
         (main-function)
) 
```

使用 运行它时`cake my-task`，我得到：

```
I'm in core.clj, not inside in any function
I'm in my task
I'm in the main function 
```

这里没有惊喜。

现在，我改成`core.clj`了这样：

```
(ns mess-up-with-cake.core)

(defn main-function[]
  (println "I'm in the main function")
  (println "I've made a change in the main function")
)

(println "I'm in core.clj, not inside in any function")
(println "I've made a change outside the main function") 
```

当我运行它时，我得到

```
I'm in core.clj, not inside in any function
I've made a change outside the main function
I'm in my task
I'm in the main function 
```

`core.clj`显然已重新加载，但我在 main 函数中所做的更改没有打印出来！只有当我停止 JVM`cake kill`并重新运行它时，我才会得到想要的结果 - 但如果我每次更改函数时都必须重新启动 JVM，我还不如回到 lein...

知道如何强制 cake 重新加载我的函数（并且**只有**我的函数 - 重新加载整个 Clojure 运行时 + 我正在使用的任何库可能不会比重新启动 JVM 快多少..）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:37:08.083

这可能不会直接回答您的问题，但我希望它有所帮助：

如果您在哪里使用 leiningen 运行，这听起来像是您的工作流程：

*   `lein run`
*   等待JVM启动....无聊...
*   观察结果
*   编辑代码
*   重复

这是大多数语言中非常常见的模式，它偶尔用于 Clojure 开发（Cake 在这里非常有用）。Clojure 开发使用**项目的单个实例并使用 nrepl**（或 Slime 和 Swank）将编辑器连接到该实例更为常见。因为大多数人在进行开发时都会让项目继续运行，所以没有多少人会感到这种痛苦，所以我认为解决方案并不是那么好。Cake 已基本并入 Leiningen，我并不清楚 Cake 项目的未来方向（在这一点上我很可能是错误的）。在我认识的 Clojureians 中，他们都搬到了 Leiningen，并通过 Emacs 或 vim 等编辑器连接到他们的项目。

一个常见的工作流程是：

*   启动 Emacs
*   Mx nrepl 插口
*   Ctrl-c Crtl-l 重新加载所有命名空间及其所有依赖的命名空间（这接近于解决您的问题）
*   破解，加载，重复;-)

此工作流程不是 Emacs 或 VI 特定的，Eclipse 和 Intelij 使用相同的方法

回复：“重新加载整个 Clojure 运行时 + 我正在使用的任何库可能不会比重新启动 JVM 快多少”。

我发现即使在我的大型项目中也不会超过两秒

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T21:06:46.597

我曾经也为缓慢的 JVM 启动速度而苦苦挣扎，并且在使用 Cake 时取得了不同程度的成功。您可能想看看 Leiningen 的出色[autoexpect](https://github.com/jakemcc/lein-autoexpect)插件，[在作者的博](http://jakemccrary.com/blog/2011/12/16/continuous-testing-with-clojure-and-expectations/)文中有详细的解释。基本上，每次更新工作目录树时，autoexpect 都会重新加载您的代码（并评估任何`expect`子句，报告任何测试失败）。使连续测试成为一个梦想——我有时在 Emacs 中有*两个*shell——一个用于输出`lein autoexpect`，一个用于连接的 REPL，以便按照另一张海报的建议向其发送代码片段。

我非常喜欢持续测试风格，我在 Python中为我的非 Clojure 开发（[在这篇博文中描述）编写](http://johnj.com/navblog/continuous-testing-in-python-and-clojure/)[了一个类似的实用程序](https://github.com/eigenhombre/continuous-testing-helper)——对于 Clojure，我使用.`autoexpect`

# silverlight - E_FAIL COM 错误使用 Microsoft.LightSwitch.Client 创建 Silverlight 用户控件

> ID：12827729
> 
> 赞同：0
> 
> 时间：2012-10-10T20:24:17.300
> 
> 标签：silverlight, visual-studio-2012, visual-studio-lightswitch

我正在尝试按照Jan Van der Haegen 博客中的说明在 LightSwitch中[创建可重用的模式窗口。](http://janvanderhaegen.wordpress.com/2012/06/05/creating-reusable-modal-screens-2/)但是，在我单击向客户端添加新的 Silverlight 用户控件并输入 xaml 后，我遇到了错误。我将代码减少到最短的部分，这给了我一个错误：

> HRESULT E_FAIL 已从对 COM 组件的调用中返回。

来自以下 xaml：

```
<shellUtils:ScreenChildWindow
    xmlns:shellUtils="clr-namespace:Microsoft.LightSwitch.Runtime.Shell.Framework;assembly=Microsoft.LightSwitch.Client">
</shellUtils:ScreenChildWindow> 
```

我刚刚在虚拟机中安装了 Visual Studio 2012，创建了一个新项目，新的客户端 Silverlight 用户控件，并尝试了相同的代码并收到相同的错误。

我也收到了这个代码和其他引用 Microsoft.LightSwitch.Client 的代码：

```
<Framework:GroupBox
    xmlns:Framework="clr-namespace:Microsoft.LightSwitch.Presentation.Framework;assembly=Microsoft.LightSwitch.Client">
</Framework:GroupBox> 
```

博客上的评论似乎表明其他人有这个错误，但我还没有在任何地方找到解决方案。我在 Stackoverflow 上也看到了相同/相似的内容[，](https://stackoverflow.com/questions/11016025/exception-error-hresult-e-fail-with-microsoft-lightswitch-visual-studio-2012-rc)但没有得到答复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:12:40.323

是的，这是正确的，只需关闭预览窗口即可。XAML 设计器在引用 LS 程序集时很难呈现控件。您可以忽略这些错误。

如果您在其他地方看到这些错误，请告诉我，我们可以进行调查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:24:17.300

在网上搜索了最轻微的相关问题后，我发现至少在我的情况下**，设计视图错误可以完全忽略**。

即使有我没有提到的其他错误：

> 未定义的 CLR 命名空间。'clr-namespace' URI 引用了无法找到的命名空间 Microsoft.LightSwitch.Cosmopolitan.Presentation.Controls'。
> 
> 找不到类型“ctls:OverflowControl”。确认您没有丢失程序集引用并且所有引用的程序集都已构建。
> 
> 查找资源字典 /Microsoft.LightSwitch.Cosmopolitan.Client;component/Presentation/Shells/BasicStyles.xaml 时出错”

控制工作完美。所有的装配偏好都存在，所以我不知道为什么设计师另有说法。

# jqgrid - jqGrid 需要 30 秒来计算我在网格中有 110 万行

> ID：12827731
> 
> 赞同：0
> 
> 时间：2012-10-10T20:24:21.317
> 
> 标签：jqgrid, jqgrid-asp.net

我有一个大约有 1,100,000 行的数据集。

当我将它加载到我的 jqGrid 中时，SQL Profiler 告诉我返回记录数需要 29.7 秒，然后再需要 29.8 秒才能返回数据以显示在网格中。

请参阅下面的 SQL 对我的 SQL Server 表进行行计数。

```
SELECT 
[GroupBy1].[A1] AS [C1]
FROM ( SELECT 
    COUNT(1) AS [A1]
    FROM [dbo].[vw_ProductSearch_FULL] AS [Extent1]
)  AS [GroupBy1] 
```

谁能建议如何提高 jqGrid 生成的这个“计数”查询的性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T13:54:11.137

我们需要有关您的数据库的更多信息，以便为您的查询提出改进建议。但正如 Oleg 所说，您可能不需要查询计数。

至于网格中的数据，您已经看到网格中有大约 100 万行并不能很好地工作。我建议您使用分页或真正滚动行在任何给定时间仅加载一小部分行。这应该使您的表现恢复到可接受的水平。

# c# - 如何在枚举上使用多个描述属性

> ID：12827732
> 
> 赞同：2
> 
> 时间：2012-10-10T20:24:31.123
> 
> 标签：c#, enums, custom-attributes

我们如何在枚举上定义和使用多重描述属性？

```
public enum EnumWithDescription
{
    [CustomDescritption("job-view")]
    [Description("analyics-job-view")]
    JobView
}

class CustomDescritption: DescriptionAttribute
{
    private string extraInfo;
    public string ExtraInfo { get { return extraInfo; } set { extraInfo = value; } }

    public MyDescritptionAttribute(string description)
    {
        this.DescriptionValue = description;
        this.extraInfo = "";
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T20:30:31.850

用 AllowMultiple 装饰属性

```
[AttributeUsage(AllowMultiple = true)]
class MyAttribute : Attribute {} 
```

更多信息：[msdn](http://msdn.microsoft.com/en-us/library/system.attributeusageattribute.allowmultiple.aspx)

# c++ - 对象数组的默认复制行为

> ID：12827738
> 
> 赞同：5
> 
> 时间：2012-10-10T20:24:49.380
> 
> 标签：c++, arrays, copy-constructor, copy-assignment

如果我有一个以数组为成员的类：

```
class A
{
    Object array[SIZE];
}; 
```

我复制了它的一个实例：

```
A a;
A b = a;
A c;
c = a; 
```

将`array`逐字节进行 memcpy 编辑还是`Object::operator=`逐元素复制？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T20:30:34.073

C++ 中的数组对于所有第一类对象都表现良好，包括用户定义的类型（无论它们是否是 POD/非平凡可构造的）。

```
#include <cstdio>

struct Object
{
    Object()              { puts("Object");  } 
    Object(Object const&) { puts("copy");    } 
   ~Object()              { puts("~Object"); } 
};

struct A
{
    Object array[4];
};

int main()
{
    A a;
    A b = a;
} 
```

输出（另见[http://liveworkspace.org/code/40380f1617699ae6967f0107bf080026](http://liveworkspace.org/code/40380f1617699ae6967f0107bf080026)）：

```
Object
Object
Object
Object
copy
copy
copy
copy
~Object
~Object
~Object
~Object
~Object
~Object
~Object
~Object 
```

# java - IKVM.NET 对象序列化与 ObjectOutputStream 的区别

> ID：12827744
> 
> 赞同：2
> 
> 时间：2012-10-10T20:25:03.147
> 
> 标签：java, .net, serialization, objectoutputstream, ikvm

我有一个 java 程序（jar），它用 ObjectOutputStream 将一个类序列化为文件。我需要在 .NET 项目中使用这部分程序，为此我使用 ikvmc.exe 将 jar 转换为 .NET dll。一切正常，但序列化文件在某些​​部分与直接使用 java 程序序列化的文件不同。您对拥有相同的序列化文件有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:37:14.813

Java 序列化和反序列化只有在双方都使用相同的编译类时才有效。如果你序列化 Java VM 运行时的类，那么你应该在两边使用完全相同的 VM 版本。在另一种情况下，这些类可以有不同的 serialVersionUID。

根据 IKVM 版本，它取决于不同的 OpenJDK 版本。例如基于 OpenJDK 1.7.0 的 7.x 版本。

# java - ant javac 排除所有未包含的内容

> ID：12827755
> 
> 赞同：0
> 
> 时间：2012-10-10T20:25:43.980
> 
> 标签：java, ant, build, javac

我正在尝试为位于我们现有业务逻辑层之上的 REST 服务编写构建脚本，但是，我只想包含最少量的源以保持服务的小型化，并且只包含它绝对需要的内容。

下面是我当前的编译目标。我既可以包含所有内容，也可以不包含任何内容。我想我犯了一个简单的错误，我似乎无法在网上发现或找到。

```
<target name="compile">
    <mkdir dir="${build.classes.dir}"/>
    <javac source="1.6"
           target="1.6"
           encoding="UTF-8"
           debug="true"
           debuglevel="lines,vars,source"
           srcdir="${basedir}"
           destdir="${build.classes.dir}"
           includeAntRuntime="false">
        <src>
            <dirset dir="${src.eai.dir}" errorOnMissingDir="true">
                <include name="common/vo/MyPojo.java"/>
                <include name="common/SomeException.java"/>
            </dirset>
            <dirset dir="${src.ets.dir}" errorOnMissingDir="true">
                <include name="common/vo/AnotherPojo.java" />
                <include name="price/vo/YetAnotherPojo.java" />
                <include name="price/vo/OneMorePojo.java" />
            </dirset>
            <dirset dir="${src.java.dir}" errorOnMissingDir="true">
                <include name="java"/>
            </dirset>
        </src>
        <!-- this line ignores everything, without it it includes everything -->
        <exclude name="**/*.java"/>
        <classpath refid="classpath"/>
    </javac>
</target> 
```

有没有办法只包含上面指定的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:34:48.207

代替`exclude`, 尝试`include`列出用逗号 (,) 分隔的 java 文件，例如：

```
<include name="common/vo/MyPojo.java,common/SomeException.java,common/vo/AnotherPojo.java,price/vo/YetAnotherPojo.java" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:29:24.363

不要同时设置`srcdir`属性和嵌套`<src>`元素，因为我想 Ant 只是将两者结合起来。

# twitter - 按个人资料创建日期查找 Twitter 用户

> ID：12827766
> 
> 赞同：1
> 
> 时间：2012-10-10T20:26:24.620
> 
> 标签：twitter

这甚至可能吗？其实这是我需要做的。我想让所有在 2008 年创建帐户的用户都关注我。

有任何想法吗。

# facebook - Facebook 用户 url 按 id

> ID：12827775
> 
> 赞同：85
> 
> 时间：2012-10-10T20:27:08.313
> 
> 标签：facebook

我有一个 FB id 列表，有没有一种可以在没有图形查询的情况下构建其 FB url 的规范方法？

例如，我有 id 3、4、5，我想要他们的 Facebook URL，而不使用图形 api 并将它们保存下来

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-10-10T20:36:32.497

**更新 2：** facebook 不再提供此信息。有关于行为改变的官方公告（[https://developers.facebook.com/blog/post/2018/04/19/facebook-login-changes-address-abuse/](https://developers.facebook.com/blog/post/2018/04/19/facebook-login-changes-address-abuse/)）但没有替代方案。

是的，只需使用此链接并将您的 ID 附加到`id`参数：

```
https://facebook.com/profile.php?id=<UID> 
```

例如：

```
https://facebook.com/profile.php?id=4 
```

将自动将您重定向到`https://www.facebook.com/zuck`马克扎克伯格的个人资料。

如果您想对所有 id 执行此操作，则可以使用循环来执行此操作。

如果你愿意，我可以为你提供一个片段。

**更新：**或者，您也可以这样做：

```
https://facebook.com/<UID> 
```

所以那将是：[https](https://facebook.com/4) ://facebook.com/4 ，它会自动重定向到 Zuck！

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2014-12-30T00:52:44.333

接受的答案对我不起作用，这是：

```
https://www.facebook.com/app_scoped_user_id/10152384781676191 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-10-10T20:40:33.443

最简单、最正确（合法）的方式是使用graph api。

只需执行请求： http: [//graph.facebook.com/4](http://graph.facebook.com/4)

返回

```
{
   "id": "4",
   "name": "Mark Zuckerberg",
   "first_name": "Mark",
   "last_name": "Zuckerberg",
   "link": "http://www.facebook.com/zuck",
   "username": "zuck",
   "gender": "male",
   "locale": "en_US"
} 
```

并拿走`link`钥匙。

您还可以通过使用`fields`参数来减少流量：[http](http://graph.facebook.com/4?fields=link) ://graph.facebook.com/4?fields=link只获取您需要的内容：

```
{
   "link": "http://www.facebook.com/zuck",
   "id": "4"
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-11T10:15:22.257

标记的答案似乎已过时，并且不起作用。

Facebook 现在只提供与应用程序相关的唯一 ID，它不等于 userId 和 profileUrl，并且用户名将为空。

`me?fields=id,name,links`在 Graph 版本 2.4 之后，Doing也会贬值

现在唯一的选择是从您的开发者控制台请求 user_links 权限。

[![在此处输入图像描述](../Images/b6594cc11a997a1758aa203ad3709942.png)](https://i.stack.imgur.com/A08td.png)

并在进行 facebook 登录时将其传递给范围

```
scope: ['user_link'] } 
```

或通过调用 api

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-14T15:50:05.593

**截至目前（2019 年 11 月）**，graph.api V5.0

graph API 说，[参考 graph api](https://developers.facebook.com/docs/graph-api/reference/user/)

> 指向此人时间线的链接。仅当单击链接的人登录 Facebook 并且是正在查看其个人资料的人的朋友时，该链接才会解析。

[![文档](../Images/afee97d4469e3619cba275c694b59e5f.png)](https://i.stack.imgur.com/vpwL8.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-11T12:29:30.913

我一起收集了信息：

*   添加到范围`user_link`，请参阅[https://developers.facebook.com/docs/facebook-login/permissions/](https://developers.facebook.com/docs/facebook-login/permissions/)
*   添加到字段请求`link`（例如[https://graph.facebook.com/me?fields=link,name,email](https://graph.facebook.com/me?fields=link,name,email)）
*   `link`从答案中得到。要知道在我的案场长度-它是202：[https://www.facebook.com/app_scoped_user_id/YXNpZADpBWEd0SlhFZAElYa3BQT3U3Tm4xWVRLSlJfYUdUM3Y4YmIwQjBaRkM0VDBMNURQdUhhYk5NRDJoR1ZA5ZA1JOdGNwampsSTQyMDQwbW93bkp0dnZAmOXg3NTFISFVZAQlRscWQ5eEZAvcU4xZAC1B/](https://www.facebook.com/app_scoped_user_id/YXNpZADpBWEd0SlhFZAElYa3BQT3U3Tm4xWVRLSlJfYUdUM3Y4YmIwQjBaRkM0VDBMNURQdUhhYk5NRDJoR1ZA5ZA1JOdGNwampsSTQyMDQwbW93bkp0dnZAmOXg3NTFISFVZAQlRscWQ5eEZAvcU4xZAC1B/)

最后：如果没有额外的 Facebook 权限检查，它就无法工作:(

# matlab - matlab符号方程给出未确定的结果？

> ID：12827779
> 
> 赞同：2
> 
> 时间：2012-10-10T20:27:14.137
> 
> 标签：matlab, equation, symbolic-math

不太确定求解函数在 matlab 中是如何工作的？我试图求解以下符号方程，当我定义不同的参数时，它给出了 x 和 y 值交换的结果：

```
T = [0.3, 1.4, 10; 1.3, 0.4, 15; 0.02, 0.01, 1];
 syms x y j i
 q1 = (T(1,1)*x+T(1,2)*y+T(1,3))/(T(3,1)*x+T(3,2)*y+T(3,3))-j;
 q2 = (T(2,1)*x+T(2,2)*y+T(2,3))/(T(3,1)*x+T(3,2)*y+T(3,3))-i;
 [x,y] = solve(sym(q1),sym(q2),x,y);

x =

(50*j - 260*i + 3400)/(5*i + j - 340)
y =

(20*i - 200*j + 1700)/(5*i + j - 340) 
```

* * *

```
T = [0.3, 1.4, 10; 1.3, 0.4, 15; 0.02, 0.01, 1];
 syms j i jj ii
 q1 = (T(1,1)*j+T(1,2)*i+T(1,3))/(T(3,1)*j+T(3,2)*i+T(3,3))-jj;
 q2 = (T(2,1)*j+T(2,2)*i+T(2,3))/(T(3,1)*j+T(3,2)*i+T(3,3))-ii;
 [j,i] = solve(sym(q1),sym(q2),j,i);

j =

(20*ii - 200*jj + 1700)/(5*ii + jj - 340)

i =

(50*jj - 260*ii + 3400)/(5*ii + jj - 340) 
```

任何建议都会有所帮助。谢谢！</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T21:09:02.193

解决函数描述中的一个引用：

> 对于多个方程和相同数量的输出，结果按字典顺序排序并分配给输出。

第一个示例的字典顺序是参数中给出的 x, y。

第二个例子的字典顺序是 i, j。例如，它与参数的顺序相反。

似乎函数中参数的函数下降顺序并且只考虑符号变量的名称。在输出之前，这些名称按字母顺序排序。

# unicode - 谷歌计算器千位分隔符特殊字符

> ID：12827781
> 
> 赞同：2
> 
> 时间：2012-10-10T20:27:16.050
> 
> 标签：unicode, google-api, calculator, separator

注意：有关此问题的更多答案，请参阅 [Google Calculator 中的特殊字符](https://stackoverflow.com/questions/12867450/special-characters-in-google-calculator)

我注意到在获取 Google Calculator 计算的返回值时，千位被一个相当奇怪的字符隔开。它不仅仅是一个空间。

让我们以将 4,000 美元兑换成英镑为例。

如果您访问以下 Google 链接：

[http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp](http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp)

您会注意到响应是：

```
{lhs: "4000 U.S. dollars",rhs: "2 497.81441 British pounds",error: "",icc: true} 
```

这看起来很合理，千位似乎被一个空白字符隔开。

但是，如果您在命令行中输入以下内容：

```
curl -s "http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp" 
```

您会注意到响应是：

```
{lhs: "4000 U.S. dollars",rhs: "2?498.28243 British pounds",error: "",icc: true} 
```

问号 (?) 是替换字符。到底是怎么回事？

AppleScript 返回一个不同的替换字符：

```
{lhs: "4000 U.S. dollars",rhs: "2†498.28243 British pounds",error: "",icc: true} 
```

我也从其他来源获得：

```
{lhs: "4000 U.S. dollars",rhs: "2�498.28243 British pounds",error: "",icc: true} 
```

事实证明 � 是正确的 Unicode 替换字符 65533。

谁能让我深入了解谷歌传递给我的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:44:05.883

这是一个不间断的空格，U+00A0。这是为了确保数字不会在一行的末尾被打破。

但是，Google 会返回正确的编码 (UTF-8)：

```
Content-Type: text/html; charset=UTF-8 
```

所以 ...

*   如果它以普通空格 (U+0020) 的形式出现（Firefox 在复制时会这样做，这很愚蠢），那么应用程序会将某些字符转换为相似字符，可能是为了适应某种受限代码页（可能是 ASCII） .
*   如果有问号，则它被正确读取为 Unicode，但处理中的某些部分使用不包含该字符的旧字符集，因此它被转换。
*   如果有替换字符 � (U+FFFD)，那么它很可能被读取为 UTF-8，转换为包含该字符的旧字符集（例如拉丁语 1），然后重新解释为 UTF-8。
*   如果有一个完全不同的字符，例如你的匕首（†），那么我猜响应被正确读取为 Unicode，被转换为包含该字符的字符集并在另一个字符集中重新解释。快速浏览一下[Mac Roman](http://en.wikipedia.org/wiki/Mac_Roman#Codepage_layout)代码页会发现 A0 确实映射到 †。

不用说，无论您在处理该响应时使用的任何部分，就 Unicode 而言似乎都被严重破坏了。我希望在这个千年里不会经常发生的事情，但显然它仍然会发生。

* * *

通过在 PowerShell 中摆弄一下，我弄清楚了它是什么：

```
PS Home:\> $wc = new-object net.webclient
PS Home:\> $x = $wc.downloadstring('http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp')
PS Home:\> [char[]]$x|%{"$_ - " + +$_}
...
" - 34
2 - 50
  - 160
4 - 52
9 - 57
8 - 56
. - 46
2 - 50
8 - 56
2 - 50
4 - 52
... 
```

还快速查看响应标头显示编码设置正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T23:47:49.310

根据我`curl`在OSX**终端上的测试，通过更改****终端**首选项中的国际字符编码：编码是 iso latin 1。

当我将编码设置为 UTF8 时：我得到“2?498.28243”

当我将编码设置为 MacRoman 时：我得到“2†498.28243”

第一个解决方案：使用任何浏览器的**用户代理**（本例中为 OSX 10.6.8 上的 Safari）

```
curl -s -A 'Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.48 (KHTML, like Gecko) Version/5.1 Safari/534.48' 'http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp' 
```

第二种解决方案：使用`iconv`

```
curl -s 'http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp' |  iconv -t utf8 -f  iso-8859-1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:36:34.557

尝试

```
set myUrl to quoted form of "http://www.google.com/ig/calculator?hl=en&q=4000%20usd%20to%20gbp"
set xxx to do shell script "curl " & myUrl & " | sed 's/[†]/,/'" 
```

# php - 在 PHP 数组中使用 URL 变量（wordpress 相关）

> ID：12827787
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:27:39.020
> 
> 标签：php, arrays, wordpress, url, variables

我对这个棘手的问题感到非常疯狂。我的网址是：www.mysite.com/page/?id=sun

我想获取变量 (sun) 并将其放入我的 PHP 数组中：

```
<?php 
 $tag = $_GET['id'];

 wp_reset_query();

 query_posts(array('post_type'=> 'projects','technologiestags'=> $tag) );
 if(have_posts()):
 while(have_posts()):the_post();
 ?>

 <div class="technology">
 <h4><?php the_title(); ?></h4><br/><a href="<?php the_permalink(); ?>"><?php the_post_thumbnail(''); ?></a>

</br></br><div class="readmore"><a href="<?php the_permalink(); ?>">Read more&nbsp;&raquo;</a></div>

</div><!--END of technology Id-->

<?php endwhile; endif; wp_reset_query();?> 
```

如您所见，我使用了“ **. echo "$tag" .** "，但它不起作用。有没有其他方法可以获取 URL 变量并将其插入 PHP。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:28:51.527

```
query_posts(array('post_type'=> 'projects','technologiestags' => $tag); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:29:23.447

$tag 是一个变量，可以用来代替传递字符串：

```
query_posts(array('post_type'=> 'projects','technologiestags' => $tag); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:32:36.617

一些改变，试试：

```
if(isset($_GET['id'])):
        $tag = stript_tags($_GET['id']);
        wp_reset_query();
        query_posts(array(
                'post_type'=> 'projects',
                'technologiestags'=> $tag)
        );
        if(have_posts()):
            while(have_posts()):
                the_post();
                ?>
                <div class="technology">
                    <h4><?= the_title(); ?></h4>
                    <div class="post-title"><a href="<?php the_permalink(); ?>"><?= the_post_thumbnail(''); ?></a></div>
                    <div class="readmore"><a href="<?= the_permalink(); ?>">Read more&nbsp;&raquo;</a></div>
                </div>
                <?
            endwhile;
            wp_reset_query();
        endif;
    endif; 
```

# variable-assignment - Ada 声明“在 0 范围 18..20”时遇到问题

> ID：12827792
> 
> 赞同：1
> 
> 时间：2012-10-10T20:28:02.430
> 
> 标签：variable-assignment, ada, variable-declaration

我在使用这个变量声明时遇到了问题：

```
Code_Length at 0 range 18..20; 
```

我熟悉约束，但这`at 0`就是让我适应的东西，我在其他任何地方都找不到任何在线示例。

如果我不得不猜测（而且我完全在猜测），则将`at 0`值初始化为`0`，然后对任何后续赋值操作强制执行约束。但我找不到任何东西来验证这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T20:38:56.443

这不是变量声明，而是记录字段的[表示子句](http://www.ada-auth.org/standards/12rm/html/RM-13-5-1.html#I5021)。无论您从中摘录什么记录声明，都有一个名为“Code_Length”的字段。这个表示子句表明它的存储（3位）将从整个记录的存储开始偏移0个字节，并占用18到20位。

提供更多上下文代码将有助于解释。

# command - 本地目录中的 Rsync 文件和 chmod 问题

> ID：12827798
> 
> 赞同：1
> 
> 时间：2012-10-10T20:28:12.793
> 
> 标签：command, rsync

当我执行 rsync 这是我的命令：

```
rsync -a source dest 
```

我使用 dest 作为我的网络根目录`/var/www/` ，因此某些设置为`chmod 777`的文件夹不再获得`777`许可。是否也`rsync`更改文件夹权限？

在同一服务器中同步两个本地文件夹的最佳方法是什么？是否会`rsync`删除目标中所做的任何更改并使用源文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:49:31.567

的手册页是`rsync`这样说的：

```
-a, --archive    archive mode; equals -rlptgoD (no -H,-A,-X) 
```

在这些选项中`-p`，它说：

```
-p, --perms      preserve permissions 
```

所以，是的，在这种情况下，`rsync`是使权限与权限相`dest`匹配。`source`如果不需要，请阅读手册页并确定哪些选项比 更适合您的需要`rsync -a`，然后改用这些选项。在最简单的情况下，在后面添加*标志*`--no-perms`以禁用权限保留。 *`-a`*

# iphone - 始终将第一张图像从滚动视图保存到相册

> ID：12827801
> 
> 赞同：0
> 
> 时间：2012-10-10T20:28:21.530
> 
> 标签：iphone, ios6

为什么当我一直选择第二张或任何其他图像时它只将第一张图像从滚动视图保存到相册

```
- (void)handleLongPress:(UILongPressGestureRecognizer*)gestureRecognizer{
//CGPoint gesturePoint = [_gesture locationInView:_imageScrollView]; 
if (gestureRecognizer.state == UIGestureRecognizerStateBegan){
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Save Photo", nil];
    actionSheet.actionSheetStyle = UIActionSheetStyleBlackTranslucent;
    [actionSheet showInView:self.view];
    [actionSheet release];

}}

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
switch (buttonIndex) {
    case 0:
         for (int i = 0; i<=61; i++) {
             NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];
             UIImage *image = [UIImage imageNamed:imageName];
             UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
             //if     (CGRectContainsPoint(_myButton.frame,gesturePoint)){  
        UIImageWriteToSavedPhotosAlbum(imageView.image, self, @selector(image: didFinishSavingWithError:contextInfo:), nil);

       break;

    default:
        break;
} }} 
```

它应该始终保存选定的图像。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:56:29.823

您的代码有几个问题。

1.  您正在创建一个`UIImageView`但您没有使用它，只是图像。这个对象真的没有用。

2.  您应该检查`image0.png`, `image1.png`,是否`image2.png`真的存在。一个简单的`NSLog`陈述会告诉你。如果他们是`nil`，那么他们没有得救也就不足为奇了。

3.  您的代码中没有任何地方引用选择，您只需使用硬编码的 62 张图像。如果存在，您的`imageNamed`方法会将这些从应用程序包中提取出来。

# variables - VHDL 中的信号和变量

> ID：12827803
> 
> 赞同：0
> 
> 时间：2012-10-10T20:28:28.077
> 
> 标签：variables, signals, vhdl

我想问一下VHDL中的信号和变量，我知道它们之间的区别，但是我想在仿真时看到区别。

我在 Quartus Tool 中使用了这个简单的程序来查看它们之间的区别：

```
ENTITY test IS PORT (
  a : IN bit;
  y : OUT bit);
END test;

ARCHITECTURE beh OF test IS
SIGNAL x : BIT;
BEGIN
  PROCESS (a)
  BEGIN
    x <= '1';
    IF x = '1' THEN y <= '0' AFTER 8 ns;
    ELSE y <= '1' AFTER 5 ns;
    END IF;
  END PROCESS;
END BEH; 
```

对于信号和变量：

```
entity test1 is port (
  a : IN bit;
  y : OUT bit);
end test1;

architecture beh of test1 is
begin
  process (a)
  variable x : bit;
  begin
    x := '1';
    if x = '1' then y <= '0' after 8 ns;
    else y <= '1' after 5 ns;
    end if;
  end process;
end beh; 
```

我创建的波形以查看第一个程序中的差异`(y)value`应该设置为`1`at `5ns`，但它没有改变..为什么？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T16:52:41.860

您看不到波形的差异，因为波形查看器仅显示增量周期结束时的变量值（即当某个实时时间过去时）。如果您单步执行代码，或在`report`流程中添加语句，您可以看到变量的中间值：

```
signal s:integer := 0;
process
   variable v:integer := 0;
begin
   report "Signal="&integer'image(s)&" variable="&integer'image(v);
   s <= 1; v := 1;
   report "Signal="&integer'image(s)&" variable="&integer'image(v);
   wait for 0 ps; -- end the delta cycle, even 0ps counts as "time passing"
   report "Signal="&integer'image(s)&" variable="&integer'image(v);
   wait;
end process; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T07:19:12.050

您将信号“a”放在敏感列表中，然后它会导致“闩锁”。

对于更新 y，您应该将“x”放在敏感列表中或像触发信号一样更改“a”。

在您的情况下，信号和变量是相似的，因为您将其固定为常量。

此外，您应该上传带有信号“a”行为的测试平台。

* * *

**编辑：将“x”放在敏感列表中是错误的。感谢@damage**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T23:35:02.267

这段代码应该说明黑白信号和变量的差异。我将流程直接插入到测试平台中，因此可以使用您选择的 HDL 模拟器直接模拟代码。
10 ns 后`start`触发事件并评估两个进程。
然后您应该看到预期的结果，即`sig_out`再过 20 ns 后变高，而`var_out`仅 10 ns 后应该变高。

```
library ieee;
use ieee.std_logic_1164.all;

entity sigvartest is
end entity sigvartest;

architecture behav of sigvartest is

signal start : std_logic := '0'; -- event to start simulation

signal x_sig : std_logic := '0'; -- signal tested in SIGPROCESS

signal sig_out : std_logic := '0'; -- output of SIGPROCESS

signal var_out : std_logic := '0'; -- output of VARPROCESS

begin

start <= '0', '1' after 10 ns; -- pretty self-explanatory, start goes high after 10 ns

SIGPROCESS:
        process(start) is
        begin
            if(rising_edge(start)) then
                x_sig <= '1'; -- signal is scheduled to be assigned its new value, no immediate change!

                if(x_sig = '1') then
                    sig_out <= '1' after 10 ns;
                else
                    sig_out <= '1' after 20 ns; -- this part will execute
                end if;
            end if;
        end process;

VARPROCESS:
        process(start) is
                variable x_var : std_logic := '0';
        begin
                if(rising_edge(start)) then
                    x_var := '1'; -- variable is assigned immediately

                    if(x_var = '1') then
                        var_out <= '1' after 10 ns;  -- this part will execute
                    else
                        var_out <= '1' after 20 ns;
                    end if;
                end if;
        end process;

end architecture; 
```

# iphone - iOS 6 - (BOOL)shouldAutorotate 不被调用导航控制器推送视图控制器

> ID：12827804
> 
> 赞同：7
> 
> 时间：2012-10-10T20:28:29.690
> 
> 标签：iphone, objective-c, ios, xcode, ios6

对于我的应用程序`rootViewController`是`navgationController`.

我发现推控制器的

`-(BOOL)shouldAutorotate`没有被调用。

和

`-(NSUInteger)supportedInterfaceOrientations`只被调用一次。

我已在`xcode's`项目摘要（或`plist`）中正确检查了 Windows 所有方向支持。

我希望调用这些方法，因为我想以编程方式执行一些 uicontrol 定位代码以更改方向。

我通过覆盖（类别）导航控制器的以下方法解决了这个问题

```
-(BOOL)shouldAutorotate;

-(NSUInteger)supportedInterfaceOrientations; 
```

我检查了哪个控制器被推送，并相应地在导航控制器的以下方法中调用了相应的推送控制器的 uicontrol 定位代码

```
(NSUInteger)supportedInterfaceOrientations; 
```

这工作正常，但我认为这不是正确的方法。请帮助我寻求更好的解决方案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-29T05:43:37.383

您可以查看以下链接，您需要创建自定义导航以支持自动旋转

[http://mobileappdevpage.blogspot.in/2012/11/how-to-use-should-autorotateios-6-with.html](http://mobileappdevpage.blogspot.in/2012/11/how-to-use-should-autorotateios-6-with.html)

另一种方法是创建 UIViagationController 类别

.h 文件的代码是

```
@interface UINavigationController (autorotation)

-(BOOL)shouldAutorotate;
-(NSUInteger)supportedInterfaceOrientations; 
```

.m 文件的代码是

```
@implementation UINavigationController (autorotation)

-(BOOL)shouldAutorotate
{

    UIInterfaceOrientation interfaceOrientation = [UIApplication sharedApplication].statusBarOrientation;
    [self.topViewController shouldAutorotate];
    return YES;

}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAll;

}
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T15:00:02.947

我在导航控制器上也遇到了同样的问题。它适用于所有推送的视图控制器，但我的情况完全不同，我将一个视图控制器作为根推送到导航控制器（ViewControllerParent），

```
NavController
            -- rootViewController (ViewControllerParent)
                                          --- ViewControllerChild1
                                          --- ViewControllerChild2 
```

由于某些项目要求，我将 ViewControllerParent 作为基础，然后根据用户操作将子视图控制器的视图作为子视图添加到父视图。现在我有一个场景，我希望 Child1 不旋转，而 Child2 旋转。

我面临的问题是导航控制器类中的 [self.topViewController] 总是返回父对象，因为我没有将孩子推入导航堆栈。所以我的 Childs 中的 shouldAutorotate 方法永远不会被调用。所以我不得不在我父母的 shouldAutorotate 方法中进行类检查，然后返回旋转值。我在父类（ViewControllerParent）中做了类似的事情，这是一种解决方法，但它解决了这个问题

```
-(BOOL)shouldAutorotate
{
  BOOL allowRotation = YES;

   if ([currentlyLoadedChild isKindOfClass:[Child1 class]])
   {
       allowRotation = NO;
   }
   if ([currentlyLoadedChild isKindOfClass:[Child2 class]])
   {
       allowRotation = YES;
   }
   return allowRotation;
} 
```

-anoop

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:35:05.373

您可以通过以下方式检查界面方向

```
[UIApplication sharedApplication].statusBarOrientation 
```

当视图控制器被加载时，比如说，在`viewWillAppear`. 在那里你可以做你的子视图布局。一旦视图打开，`shouldAutorotate`就会在设备转动时调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T20:36:30.177

覆盖 UINavigationController 是正确的方法，但我不确定您是否以正确的方式检查推送控制器 supportInterfaceOrientations。

看看我的答案：[https ://stackoverflow.com/a/12669343/253008](https://stackoverflow.com/a/12669343/253008)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-03T05:32:51.943

我遇到过同样的问题。检查[这个答案](https://stackoverflow.com/questions/34037274/shouldautorotate-not-working-with-navigation-controllar-swift-2?answertab=active#tab-top) ，它是一个很好的方法，而不是应用 ShouldAutoRotate

# ruby-on-rails - 当我将图像移动到资产图像路径时，如何解决“没有路线匹配 [GET] image.png”？

> ID：12827813
> 
> 赞同：3
> 
> 时间：2012-10-10T20:29:12.027
> 
> 标签：ruby-on-rails, image, asset-pipeline, assets

我将图像从 public/images 移动到 assets/images 路径

我有图像：

```
 <%= image_tag("login_logo.png", :id => "login_logo") %> 
```

我将它从公用文件夹移动到资产并更改了路径。

它是可见的并且工作正常，但我在控制台中收到错误：

```
Started GET "/assets/logo_PG.png" for 127.0.0.1 at 2012-10-10 23:42:53 +0300
 Served asset /logo_PG.png - 304 Not Modified (0ms)

ActionController::RoutingError (No route matches [GET] "/images/login_logo.png") 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T20:38:15.917

assets 子目录中的所有内容（无论是图像、JS 等）默认情况下都可以在`/assets/name.extension`. 因此，只需确保您使用路径引用图像`/assets/login_logo.png`，或使用`asset_path`帮助器：

```
<%= asset_path('login_logo.png') %> 
```

# asp.net-mvc - 可能具有可为空 Guid 的 Web Api GET 方法？

> ID：12827815
> 
> 赞同：3
> 
> 时间：2012-10-10T20:29:18.357
> 
> 标签：asp.net-mvc, asp.net-web-api

我有一个 MVC Web API 获取方法，我希望能够将可为空的 Guid 作为参数传递。如果我使用“？Id=null”设置 GET，我会收到 400 响应。我可以传递一个空的 guid，但我宁愿不这样做。

无论我将 URI 更改为“id=、id=null 等”，它都不会接受 null。有谁知道如何使这项工作？

```
 [HttpGet]
  public User Get(Guid? Id) 
```

更新路由配置

```
 config.Routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{action}/{id}",
                defaults: new { id = RouteParameter.Optional }
            ); 
```

完整的 Http Get 签名，sourceId 是 id 喜欢作为 null 传递的参数。

```
 [HttpGet]
  public IEnumerable<ActionItemsListViewModel> GetPagedList(int skip, int take, int page, int pageSize, [FromUri]List<GridSortInfo> sort, [FromUri] ActionItem.ActionItemStatusTypes? actionItemStatus, Guid? sourceId) 
```

发现问题，这个过滤器说 ModelState 无效。

```
public class ApiValidationActionFilter : ActionFilterAttribute
{
    public override void OnActionExecuting(System.Web.Http.Controllers.HttpActionContext actionContext)
    {
        if (!actionContext.ModelState.IsValid )
        {
            var errors = actionContext.ModelState
                .Where(e => e.Value.Errors.Count > 0)
                .Select(e => e.Value.Errors.First().ErrorMessage).ToList();

            actionContext.Response = actionContext.Request.CreateResponse(HttpStatusCode.BadRequest, string.Join(" ", errors));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:50:47.633

尝试使用：

```
[HttpGet]
public User Get(Guid? Id = null) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T21:15:15.537

我能够将 null 传递给 Guid？当我使用

*   查询字符串参数：api/values?id=null
*   路由参数：api/values/null

控制器：

```
 public class ValuesController : ApiController
 {
     public User Get(Guid? Id)
     { ... }
 } 
```

# ruby-on-rails - Rails 3.2.8 中咖啡脚本中的独立功能

> ID：12827819
> 
> 赞同：2
> 
> 时间：2012-10-10T20:29:34.397
> 
> 标签：ruby-on-rails, ruby-on-rails-3, coffeescript, asset-pipeline

我最近开始在我的 Rails 项目中大量使用咖啡脚本。

我很好奇你如何制作一个独立的功能。所以如果我这样做：

```
foo = ->
  alert("hello world") 
```

编译为

```
(function() {
  var foo;

  foo = function() {
    return alert("hello world");
  };

}).call(this); 
```

我如何使它编译为

```
var foo;
foo = function(){
  return alert("hello world");
} 
```

我希望能够调用使用`link_to_function "foo"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-07T15:19:22.310

实际上有几种方法可以实现这一点（评论中已经给出了一种方法）。

## 在没有闭包包装的情况下编译

这会将所有功能暴露给外部范围。如果您使用可以控制构建过程的轻量级框架，这可能是一个选项。我不确定您是否能够在资产管道的上下文中使用，但在小型 sinatra 应用程序的上下文中效果很好。

```
coffee -b myfile.coffee 
```

## 附加到全局对象

如果您知道您的目标是特定的运行时，例如浏览器，您可以使用全局窗口对象。

```
window.foo = -> alert("hello world") 
```

这与评论中的解决方案效果相同，因为目标是 Rails 环境。但是使用`@`which is sugar for`this.`会将其附加到当前的任何范围`this`。假设函数没有在回调或具有绑定上下文的内部对象中定义，它可能是窗口对象。

```
@foo = -> alert("hello world") 
```

更好的是创建自己的命名空间并以这种方式附加：

```
Mine ||= {}
Mine.foo = -> alert("hello world")
@Mine = Mine 
```

## CoffeeScript 类

或者使用 CoffeeScript 的类语法通过附加到原型本身来做同样的事情：

```
class @Mine
  @foo: -> alert("hello world") # called as Mine.foo() (notice the @ declaration) 
```

在我们的 Rails 应用程序中，我们通常有一个定义命名空间的资产，也就是一个`app/assets/javascripts`名为 titled的文件`mine.coffee`：

```
window.Mine ||= {} 
```

然后在其他文件中，我们可以要求该命名空间：

```
#= require mine

class Mine.MyOtherThing
  @foo: -> alert("hello world") 
```

# webdriver - 如何使用 webdriver 验证图像是否显示在表格中

> ID：12827820
> 
> 赞同：1
> 
> 时间：2012-10-10T20:29:34.837
> 
> 标签：webdriver, selenium-webdriver

我的问题是查找图像图标是否存在于 td 中的最佳方法是什么？src="../App_Themes/Default/images/phone.gif"/

这是我的html源代码

```
 <div id="ctl00_ContentPlaceHolder1_AddControl1_pnlList">

<table id="ctl00_ContentPlaceHolder1_AddControl1_gv">

    <tr class="item">
        <td align="center"><a href="javascript:__doPostBack('ctl00$Content$AddControl1$gv','Select$2')">Edit</a></td>
        <td align="center" style="width: 15px;">
            <img id="ctl00_ContentPlaceHolder1_AddControl1_gv_ctl05_imgMobile" 
                           src="../App_Themes/Default/images/mobile.gif" 
                           src="" align="middle" style="border-width: 0px;" />
        </td>
        <td>Know For Sure</td>
        <td>&nbsp;</td>
        <td>Abacd</td>
        <td>Teachers</td>
        <td>
            <img src="../App_Themes/Default/images/check.png" alt='Active' style='display: ;' />
        </td>
        <td>3/2/2011 9:48:00 AM</td>
    </tr>

    <tr class="item">
        <td align="center"><a href="javascript:__doPostBack('ctl00$Content$AddControl1$gv','Select$2')">Edit</a></td>

        <td>Know For Sure 1</td>
        <td>&nbsp;</td>
        <td>Abacd1</td>
        <td>Teachers</td>
        <td>
            <img src="../App_Themes/Default/images/check.png" alt='Active' style='display: ;' />
        </td>
        <td>3/2/2011 9:48:00 AM</td>
    </tr>

   <tr class="item">
        <td align="center"><a href="javascript:__doPostBack('ctl00$Content$AddControl1$gv','Select$2')">Edit</a></td>
        <td align="center" style="width: 15px;">
            <img id="ctl00_ContentPlaceHolder1_AddControl1_gv_ctl05_imgMobile" 
                           src="../App_Themes/Default/images/mobile.gif" 
                           src="" align="middle" style="border-width: 0px;" />
        </td>
        <td>Know For Sure2</td>
        <td>&nbsp;</td>
        <td>Abacd2</td>
        <td>Teachers</td>
        <td>
            <img src="../App_Themes/Default/images/check.png" alt='Active' style='display: ;' />
        </td>
        <td>3/2/2011 9:48:00 AM</td>
    </tr>
</table>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T23:25:13.037

您要做的是获取 img 标签的 WebElement：

```
WebElement image = driver.findElement(By.xpath("//img[@src='../App_Themes/Default/images/phone.gif']")); 
```

然后运行 ​​JavaScript 检查图像是否已完全加载，其自然宽度！= undefined 并且大于 0 px：

```
Boolean imageLoaded = (Boolean) ((JavascriptExecutor)driver)
    .executeScript
    (
        "return arguments[0].complete && type of arguments[0].naturalWidth != \"undefined\" && arguments[0].naturalWidth > 0", image
    ) 
```

`Boolean imageLoaded``true`只有当所有 3 个参数都返回 true时才会相等。

如果您需要检查更多内容来确定您的图像是否已加载，您可以通过添加 more 来检查标签的 DOM 树中的任何元素`arguments[0].'dom element'`。

祝你好运！

**编辑**

因此，要查找标签中可能存在或不存在的图像，您可以执行以下操作

```
ArrayList<WebElement> imgElements = driver.findElements(By.xpath("//*[contains(@src, '.gif')]"); 
```

或者，如果您只想在标签中查找图像，请将`*`xpath 中的`td`

您可以尝试查找所有图像的另一件事（不确定 selenium 的内置 xpath 库是否支持这一点，因为我远离我的普通计算机）但是您可以传递多个 xpath 来获取所有图像：

```
ArrayList<WebElement> imgElements = driver.findElements(By.xpath("//*[contains(@src, '.gif')] | //*[contains(@src, '.png')]"); 
```

然后，您只需遍历您的元素数组列表：

```
for (WebElement element : imgElements)
{
     Boolean imageLoaded = (Boolean) ((JavascriptExecutor)driver)
        .executeScript
        (
            "return arguments[0].complete && type of arguments[0].naturalWidth != \"undefined\" && arguments[0].naturalWidth > 0", element
        )   

     if (!imageLoaded)
     {
         System.out.println("Found broken image: "element.getAttribute("src"))
     }
} 
```

当然，您可以根据需要处理未加载的图像。

# javascript - 重定向到带有标题信息的 URL Javascript

> ID：12827822
> 
> 赞同：0
> 
> 时间：2012-10-10T20:29:51.540
> 
> 标签：javascript, asp.net

> **可能重复：**
> [带有标头或会话 ID 的 Javascript 重定向](https://stackoverflow.com/questions/6388066/javascript-redirect-with-headers-or-session-id)

如何使用 javascript 在重定向中添加标头信息..

我认为我这样重定向（不确定）..

```
 window.location.replace('https://anotherWebSite.com'); 
```

不，我想向其中添加包含 userID="whatever" 的标头信息，因此当重定向发生时，它将通过此​​代码对 anotherWebsite.com 可用，例如..

```
 NameValueCollection headers = base.Request.Headers;
            for (int i = 0; i < headers.Count; i++)
            {
                if (headers.GetKey(i).Equals("userID"))
                {

                    _myID = headers.Get(i);
                }

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:31:17.653

我不知道将响应标头附加到 JavaScript 重定向的任何方法，但您可以将数据附加到查询字符串：

```
window.location.replace('https://anotherWebSite.com?user=[USERNAME]'); 
```

# jquery - jquery重命名所有属性

> ID：12827826
> 
> 赞同：1
> 
> 时间：2012-10-10T20:30:02.327
> 
> 标签：jquery

> **可能重复：**
> [如何使用 jQuery 更改 HTML 属性名称？](https://stackoverflow.com/questions/317170/how-can-i-change-html-attribute-names-with-jquery)

我有一个大/复杂的表格，其中包含基于先前选择的问题的不同可用问题。

为了尽量保持井井有条，我有一些相同名称的重复输入。这会产生问题，即使页面下方的输入被隐藏，也会覆盖可见输入。

为防止这种情况，我已将所有隐藏输入设置为`data-name`而不是`name`属性。

**问题** 如何更改属性名称。例如：

```
<input data-name="phone" value="" />
<input data-name="email" value="" />

To
<input name="phone" value="" />
<input name="email" value="" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:33:51.523

```
$('input[data-name]').each(function(){
    $(this).attr('name', $(this).attr('data-name')); //does the switch
    $(this).removeAttr('data-name'); //clears out the old one if you need to
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T23:14:55.230

鉴于上述 HTML 标记，我建议：

```
$('input').each(
    function(i,el){
        var data = $(el).data();
        for (datum in data) {
            if (!el[datum]) {
                el[datum] = data[datum];
                el.removeAttribute('data-' + datum);
            }
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/F85u3/)。

这使用 jQuery`data()`方法创建一个对象，其中包含数据（如果存在）附加到该方法正在迭代的当前 jQuery 对象`each()`。

实际上，在上面的示例中，`if`检查当前元素是否还没有同名的属性（因此`name`如果它已经存在则不会被覆盖），如果它不存在，则创建该属性/财产。

要显式覆盖预先存在的属性：

```
$('input').each(
    function(i, el) {
        var data = $(el).data();
        for (datum in data) {
            el[datum] = data[datum];
            el.removeAttribute('data-' + datum);
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/F85u3/1/)。

参考：

*   [`data()`](http://api.jquery.com/data/).
*   [`each()`](http://api.jquery.com/each/).
*   [`removeAttribute()`](https://developer.mozilla.org/en-US/docs/DOM/element.removeAttribute).

# asp.net - 如何从 IIS 内部访问 TCP 选项标头？

> ID：12827827
> 
> 赞同：3
> 
> 时间：2012-10-10T20:30:03.637
> 
> 标签：asp.net, iis, tcp, http-headers, nat

在某些情况下，互联网加速服务提供商（例如 Akamai 的 IPA）将对连接进行 NAT，但会在 TCP 选项中（即在 TCP 标头的末尾）提供有关原始客户端 IP 地址的信息。

某些负载均衡器（例如 BIG-IP）能够将 TCP 标头中的信息转换为 HTTP X-Forwarded-For 标头行，我们的应用程序可以读取：

[https://devcentral.f5.com/Tutorials/TechTips/tabid/63/articleType/ArticleView/articleId/1086447/Accessing-TCP-Options-from-iRules.aspx](https://devcentral.f5.com/Tutorials/TechTips/tabid/63/articleType/ArticleView/articleId/1086447/Accessing-TCP-Options-from-iRules.aspx)

但是，如果我不在这些负载平衡器之一的后面，我如何从 IIS/ASP.NET 应用程序中获取信息？

我已经考虑为此用 C++ 编写一个 CHttpModule，并且 IHttpContext 还公开了一个 GetConnection() 方法。但是返回的 IHttpConnection 接口过于简单，无法访问任何低级信息，如 TCP 选项。

[http://msdn.microsoft.com/en-us/library/ms693613(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms693613(v=vs.90).aspx)

非常感谢任何帮助、方向、指针等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T07:42:39.607

我还没有尝试过这个产品，但它听起来像你需要的 - [http://www.winfrasoft.com/products/X-Forwarded-For/](http://www.winfrasoft.com/products/X-Forwarded-For/)

克劳斯·拉斯杰

# javascript - 如何在 Ext JS 中禁用组合框中的项目？

> ID：12827828
> 
> 赞同：2
> 
> 时间：2012-10-10T20:30:05.930
> 
> 标签：javascript, extjs, combobox

如何在 Ext JS 的组合框中禁用特定项目？

例如我有这些记录

```
row_1_type_1
row_2_type_2
row_3_type_3 
```

我想禁用第三行，即它应该作为标签保留在组合中，但它会变灰并且不可点击。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-03-10T20:24:34.103

这是一个至少可以用于 Ext JS 4.2.1 的解决方案。它是一个插件，可以根据每条记录的值禁用绑定列表中的某些项目。可以配置检查是否应禁用列表项的字段名称。

让我们从如何使用插件开始。

```
{
    xtype: 'combo',
    fieldLabel: 'My combo with disabled items',
    valueField: 'value',
    displayField: 'display',
    queryMode: 'local',
    store: {
        fields: ['value', 'display', 'disabled'],
        data: [{
            value: 1, display: 'an enabled item', disabled: false
        },{
            value: 2, display: 'a disabled item', disabled: true
        }]
    },
    plugins: [{
        ptype: 'comboitemsdisableable',
        disabledField: 'disabled'
    }]
} 
```

这是插件。

```
Ext.define('Ext.ux.plugin.ComboItemsDisableable', {
    extend: 'Ext.AbstractPlugin',
    alias: 'plugin.comboitemsdisableable',

    init: function (cmp) {
        var me = this; // the plugin
        me.disabledField = me.disabledField || 'disabled';

        cmp.tpl = Ext.create('Ext.XTemplate',
            '<tpl for=".">',
            '  <tpl if="this.isDisabled(' + me.disabledField + ')">',
            '    <div class="x-boundlist-item x-item-disabled"><em>{' + cmp.displayField + '}</em></div>',
            '  <tpl else>',
            '    <div class="x-boundlist-item">{' + cmp.displayField + '}</div>',
            '  </tpl>',
            '</tpl>', {
                isDisabled: function(disabled) {
                    return disabled;
                }
            }
        );

        // make sure disabled items are not selectable
        cmp.on('beforeselect', function(combo, record, index) {
            return !record.get(me.disabledField);
        });
    }
}); 
```

这里有一些与插件一起使用的 css。它使禁用的项目变灰，并确保悬停时禁用的项目不会改变其背景以表明它是可选的。

```
.x-item-disabled.x-boundlist-item {
    color: #8c8c8c;
    cursor: default;
}

.x-item-disabled.x-boundlist-item-over {
    background: inherit;
    border-color: white;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T01:10:36.123

你可以尝试这样的事情[`listConfig`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.ComboBox-cfg-listConfig)：

```
myItems: [
    { name: 'row_1_type_1',  disabled: false},
    { name: 'row_2_type_2',  disabled: false},
    { name: 'row_3_type_3',  disabled: true }
]

listConfig: {
    getInnerTpl: function(displayField) {
        return Ext.create('Ext.XTemplate',
            '<ul><li role="option"',
            '<tpl for=".">',
            '<tpl if="disabled == true">',
                'class="x-disabled-item"',
            '<tpl else>',
                'class="x-custom-item"',
            '</tpl>',
            '>{#} - {name}</li></ul>'
        );
    }
}

//CSS
.x-disabled-item
{
}

.x-custom-item
{
} 
```

您可以在文档中找到有关[模板的更多信息](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.XTemplate)

# ios - NSRange: range.location != NSNotFound vs. range.length > 0

> ID：12827830
> 
> 赞同：15
> 
> 时间：2012-10-10T20:30:25.997
> 
> 标签：ios, objective-c, nsstring, nsrange

我正在查看我的一个应用程序中的一些旧代码，并在可能存在问题的区域修复代码。

我看到很多旧代码使用...

```
NSRange range = //determine range here....
if(range.length > 0)
{
    //do stuff
} 
```

那个代码“很好”，还是我应该把它改成这个？

```
NSRange range = //determine range here....
if(range.location != NSNotFound)
{
    //do stuff
} 
```

这两种方法本质上是否相同？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-10T20:47:45.217

这两个检查并不总是相同的。这取决于范围是如何生成的。例子：

```
NSRegularExpression *re = [NSRegularExpression
    regularExpressionWithPattern:@"(?= )" options:0 error:NULL];
NSTextCheckingResult *result = [re firstMatchInString:@"hello world"
    options:0 range:NSMakeRange(0, 11)];
NSLog(@"range = %@", NSStringFromRange(result.range)); 
```

范围的长度是 0，但它的位置是 5，而不是`NSNotFound`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-10T20:49:30.720

答案取决于您使用的功能/方法。`NSRange`只是一个结构，因此您需要阅读您正在调用的函数/方法的文档。

**例子：**

[**NSRangeFromString**](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/uid/20000055-BAJBHBDJ)
从文本表示中返回一个范围。

> ...如果 aString 不包含任何整数，则此函数返回一个 NSRange 结构，其位置和长度值都为 0。

在这种情况下，检查`NSNotFound`将不起作用。

* * *

[**-[NSString rangeOfString:]**](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/rangeOfString%3a)

> ... 如果 aString 未找到或为空 (@"")，则返回 {NSNotFound, 0}。

此处记录了 location 将为0 `NSNotFound`，`length`因此任何一项检查都可以工作，但是，我建议对照`NSNotFound`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T20:34:26.600

NSNotFound 被定义为“NSIntegerMax”。即使它们产生相同的结果，您的第二个显示器也更具可读性和自我记录性。也许您不应该全部找到它们并更改它们，而只是切换到继续前进。

# javascript - 仅当发生事件时，如何在模板中嵌入控制器？

> ID：12827831
> 
> 赞同：0
> 
> 时间：2012-10-10T20:30:25.800
> 
> 标签：javascript, symfony, twig

我的模板中有一个按钮，定义如下：

```
<input type="button" value="Button"
       onclick="callController('someValue')"/> 
```

和前面定义的 javascript 块：

```
<script type="text/javascipt">
    function callController(value)
    {
        //Code to call the controller here, passing value
    }
</script> 
```

我试着用

```
{% render "Stuff:Stuff:action" with {'value' = value } %} 
```

，但是当我单击按钮时进入页面而不是关闭该行，并且它抱怨未定义值（因为它仅在单击按钮后才定义）。我也试过

```
window.location.href = "{{ path('routeToPage', {'value' = value}) }}" 
```

但它也在定义变量之前进行了评估，所以我得到了一个错误。

我可以让它在我单击按钮后执行这条树枝线，这就是我想要的吗？还是我应该采取另一种方法？我怎么能在不使用树枝的情况下执行该动作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T22:11:30.283

假设`Stuff:Stuff:action`没有 @Route 注释，您需要编写一个包装器操作，您将在其模板中呈现它`Stuff:Stuff:action`。但是，如果来自`Stuff`Controller的“动作”**确实**有 @Route 它就更简单了。

无论如何，我想到了 AJAX：

在这里，我使用了 jQuery，但您可以自由使用您选择的库（或不使用任何库）：

```
<input id="controllerLoader" type="button" value="Button" />

$(function(){
    $('#controllerLoader').click(function(e){
        $.ajax({
            url: '{{ path('wrapperRoute')}}', // or direct call if there is a `@Route`
            type: 'post',
            dataType: 'html',
            success: function(responseHtml){
                $('#controller_embed_position').html(responseHtml);
            }
        });
     });
}); 
```

剩下的只有在没有`@Route`定义注解时才需要`Stuff:Stuff:action`。

您将需要一个虚拟控制器操作：

```
/**
 * @Template("AcmeDemoBundle::dummy.html.twig");
 * @Route("/dummy", name="wrapperRoute");
 */
public function dummyAction(){
    return array();
} 
```

最后，dummy.html.twig：

```
{% render "Stuff:Stuff:action" with {'value' = value } %} 
```

希望我没有错过什么...

# javascript - 如何在 ruby on rails 中通过关联获取另一列的值？

> ID：12827834
> 
> 赞同：0
> 
> 时间：2012-10-10T20:30:30.690
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3

如果我有两个模型，例如`Question`和`Answer`。`Question`有三列`question_id, question_type, question_text`，`Answer`有三个值`answer_id, question_id, answer_text`。

我正在为`Answer`模型创建表单。

例子：

```
<%= f.text_field :question_id %>.
<%= f.hidden_field :question_id %>. 
```

在这里，我使用`hidden field`来查找`question_type`. 我尝试了该`map`方法，但这不起作用。所以有人帮助我通过选择那个来获得`question_type`价值`question_id`。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:36:12.940

当您在控制器中提取答案时，您可以包含问题，然后您可以完全访问两者，而无需在视图中进行额外查询：

在控制器中：

```
@answer = Answer.includes(:question).where(:id => params[:answer_id]) 
```

鉴于：

```
<%= @answer.question.question_type %> 
```

如果这是一个新答案，您可以创建它并在控制器中将问题传递给它：

```
@answer = Answer.new(:question => Question.find(params[:question_id])) 
```

然后在您的表单中，您可以通过以下方式访问它：

```
<%= @answer.question.question_type %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T13:45:02.807

背诵iouri所说的话。如果您的模型中的关系设置正确，您应该能够使用点表示法来获取 question_type，如 answer.question.question_type 中所示。

您将需要类似...

```
class Question < ActiveRecord::Base
  has_many :answers
  accepts_nested_attributes_for :answers
end

class Answer < ActiveRecord::Base
  belongs_to :question
end 
```

因此，这将使您能够调用 answer.question.question_type，而不是 accept_nested_attributes_for :answers 这将有助于建立关联。

Ryan Bates 在这里有一个很好的截屏视频[http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)

祝你好运！

# rest - Rest Search Query 处理特殊字符设计标准

> ID：12827838
> 
> 赞同：1
> 
> 时间：2012-10-10T20:30:55.813
> 
> 标签：rest, special-characters

我正在设计一个rest api，用户可以使用我将定义的搜索查询语言在其中传递查询。
该语言将允许许多运算符 eq、ne、gt、lt（等于、不等于、大于、小于）等。

该语言将允许分组和逻辑运算符 AND 和 OR。

例如，关于公司的查询可能如下所示

/api/companies?q=(CompanyName eq Microsoft 或 CompanyName eq Apple) And State eq California

所以这应该给我所有公司名称等于“微软”或“苹果”并且州是加利福尼亚的公司。

所以这一切都很好，除了我正在编写 api 的系统非常灵活并且允许将几乎任何字符插入到字段值中。此外，我还必须支持自定义字段，并且可以在字段名称中包含特殊字符。

最初我主要关心的是包含括号的字段。我将将此查询转换为 SQL 服务器查询，并且我需要一种方法来确保不会将字段值中的括号与用于分组的括号混淆。我的第二个想法是强制引用字段值，但我认为这也会导致类似的问题。

我还在考虑可能有一种涉及 html 编码的简单方法，但我无法确切了解它是如何工作的。

我正在寻找的是任何合理方法的建议或示例来处理具有如此灵活数据的休息搜索查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T22:34:51.217

这是一个例子。 [http://www.sqlservercentral.com/articles/Full-Text+Search+(2008)/64248/](http://www.sqlservercentral.com/articles/Full-Text+Search+(2008)/64248/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T21:04:39.727

您应该使用百分比编码来转义查询字符串中的字符，请参阅[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)。之前[的 StackOverflow 帖子](https://stackoverflow.com/questions/5366007/why-does-the-encodings-of-a-url-and-the-query-string-part-differ)包含一些有关 URI 编码的有用背景信息。

> 最初我主要关心的是包含括号的字段。我将将此查询转换为 SQL 服务器查询，并且我需要一种方法来确保不会将字段值中的括号与用于分组的括号混淆

如果这可能是一个问题，那么听起来您的应用程序将容易受到 SQL 注入的影响。在构建 SQL 查询之前，您应该转义任何外部数据。

> /api/companies?q=(CompanyName eq Microsoft 或 CompanyName eq Apple) And State eq California

基于此示例，您可以利用 URI 查询字符串来更好地表示您的查询：

```
/api/companies?CompanyName=Microsoft%20OR%20Apple&State=California 
```

# sql - 将 SQL 查询转换为 Rails 查询

> ID：12827839
> 
> 赞同：0
> 
> 时间：2012-10-10T20:30:56.080
> 
> 标签：sql, ruby-on-rails

我可以只使用 a`find_by_sql`来完成此操作，但如果可能的话，我想以 Rails 方式进行。

我的 SQL 查询如下所示：

```
SELECT regions.id, max(updated_at) FROM demographics 
JOIN regions ON (regions.id = demographics.region_id) 
JOIN region_stats ON (region_stats.region_id = regions.id) 
WHERE region_stats.income_level = 1    
GROUP BY demographics.region_id; 
```

有没有办法将它干净地转换为 Rails？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:39:45.550

```
Demographic.find(:all,
  :conditions=>[
    "region_stats.income_level = ?",
    1
  ],
  :joins=>"as demographics JOIN regions ON (regions.id = demographics.region_id) JOIN region_stats ON (region_stats.region_id = regions.id)",
  :group=>"demographics.region_id",
  :select=>"regions.id, demographics.max(updated_at)"
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:49:28.463

未经测试：

```
Demographic.joins(:region => [:region_stats]).select('demographics.region_id, max(demographics.updated_at) as `max_date`').where(:region_stats => {:income_level => 1}).group('demographics.region_id') 
```

# c++ - 了解 Visual Studio 2010 中的此错误 (LNK 2019)

> ID：12827846
> 
> 赞同：1
> 
> 时间：2012-10-10T20:31:11.360
> 
> 标签：c++, visual-studio-2010

好的，所以我正在开发一个 C++ 项目，但我不知道如何缓解这个链接器错误。下面是：

> 1>test4.obj : 错误 LNK2019: 未解析的外部符号“private: bool __thiscall OrderedList::binarySearch(char,int &)” (?binarySearch@?$OrderedList@VRecord@@D@@AAE_NDAAH@Z) 在函数中引用“ public: virtual void __thiscall OrderedList::insert(class Record const &)" (?insert@?$OrderedList@VRecord@@D@@UAEXABVRecord@@@Z)

如果有人可以帮助分解并向我翻译 Visual Studio 2010 所说的那将是惊人的（我真的想更好地阅读输出）。我一直在阅读这个特定的错误，但我仍然不明白为什么它会应用于我的代码。

编辑： binarySearch 方法正在 OrderedList.cpp 文件中实现。我还在包含我的主文件的文件中使用#include "OrderedList.cpp" 语句。

有问题的两个功能：

插入原型：

```
virtual void insert ( const DataType &newDataItem ) throw ( logic_error ); 
```

插入：

```
template <typename DataType, typename KeyType>
void OrderedList<DataType, KeyType>::insert(const DataType &newDataItem) 
throw (logic_error ) {
int index = 0;
if (size == maxSize) {
    throw logic_error("List is full.");
} 
else { 
    KeyType searchKey = newDataItem.getKey();
    if (binarySearch(searchKey, index)) {
        cursor = index;
        dataItems[cursor] = newDataItem;
    }
    else {
        cursor = index;
        insert(newDataItem);
    }
} 
} 
```

二分搜索原型：

```
bool binarySearch ( KeyType searchKey, int &index ); 
```

二进制搜索：

```
template < typename DataType, typename KeyType >
bool binarySearch (KeyType searchKey, int &index ) {
int low  = 0;        // Low index of current search range
int high = size - 1;    // High index of current search range
bool result;            // Result returned

while ( low <= high )
{
    index = ( low + high ) / 2;               // Compute midpoint
    if ( searchKey < dataItems[index].getKey() )
       high = index - 1;                      // Search lower half
    else if ( searchKey > dataItems[index].getKey() )
       low = index + 1;                       // Search upper half
    else
       break;                                 // searchKey found
}

if ( low <= high )
   result = true;       // searchKey found
else
{
   index = high;        // searchKey not found, adjust index
   result = false;
}

return result;
} 
```

此外，记录类：

```
class Record
{
public: 
Record () { key = char(0); }
void setKey(char newKey) { key = newKey; }
char getKey() const { return key; }

private:
char key; 
```

};

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:44:43.027

除非您使用正确的模板参数调用模板函数，否则模板函数并不是真正的函数。在这种情况下，由于 OrderedList.cpp 文件不包含函数调用，因此从未生成实际的函数代码。这就是链接器找不到它的原因。

通常在头文件中定义模板函数或类来避免这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:58:53.170

这条线是否可能：

```
template < typename DataType, typename KeyType >
bool binarySearch (KeyType searchKey, int &index ) 
```

在您的 cpp 文件中，您只是忘记将其实现为：

```
template < typename DataType, typename KeyType >
bool OrderedList<DataType, KeyType>::binarySearch(KeyType searchKey, int &index) 
```

然后`binarySearch`只是一个全局函数，而不是来自`OrderedList`试图找到的链接器的函数，`OrderedList<DataType, KeyType>::binarySearch`不要将其视为指定函数？？！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T21:02:58.870

让我们逐行分解：

```
1>test4.obj : error LNK2019: unresolved external symbol 
```

这告诉您在 test4.obj 文件中，编译器无法找到它期望可用的编译对象。

```
"private: bool __thiscall OrderedList::binarySearch(char,int &)" 
```

这是无法找到的对象（在本例中为成员函数）的函数签名。

```
(?binarySearch@?    $OrderedList@VRecord@@D@@AAE_NDAAH@Z) 
```

这是上述函数的“变形名称”——编译器在目标文件中给出的名称。它为编译器提供了一种文本方式来验证名称相似但类型关联不同的对象。

```
referenced in function 
```

这一行告诉您下一个对象将是引用未解析符号的位置。

```
"public: virtual void __thiscall OrderedList::insert(class Record const &)" 
```

这是调用导致错误的符号的对象的函数签名。请注意，模板参数在这里是不可见的，但任何类型绑定的参数都是可见的，所以你知道`DataType`是 type `Record`，但你不知道是什么`KeyType`。

```
(?insert@?$OrderedList@VRecord@@D@@UAEXABVRecord@@@Z) 
```

这是上述函数的错位名称。

* * *

现在，让我们看看这意味着什么。您有一个模板方法正在调用似乎是全局函数模板的东西。该全局函数模板有两个模板参数，其中只有一个由函数调用提供。

换句话说，您没有提供`DataType`，因此编译器不知道如何生成函数 template 的模板特化`binarySearch`。

这里的好消息是您实际上并不需要`DataType`模板参数，因此您应该可以简单地消除它。那时，您的函数模板将完全专业化并且应该可以编译。

# ios - iOS 音乐控制作为任意输入

> ID：12827848
> 
> 赞同：1
> 
> 时间：2012-10-10T20:31:18.153
> 
> 标签：ios, rules

我正在阅读如何自己处理事件，并且我知道我可以拦截它们并将它们用于我自己的设计，但是 Apple 会允许这样的应用程序进入 AppStore 吗？

[http://developer.apple.com/library/IOS/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/RemoteControl/RemoteControl.html](http://developer.apple.com/library/IOS/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/RemoteControl/RemoteControl.html)

您可以想象玩游戏并在游戏中提供映射到左/右的物理后退/前进按钮选项。我的意思是当应用程序在前台处于活动状态时使用它们，在应用程序之外或在软件控制托盘中没有任何内容。

这篇文章并没有具体说不允许，但它确实暗示了这些事件只是为了控制音乐。

任何具有更多 Apple/iOS 背景的人都可以向我推荐一份指定有关使用按钮的规则的文档吗？

# python - python错误不会返回想要的结果

> ID：12827850
> 
> 赞同：0
> 
> 时间：2012-10-10T20:31:27.990
> 
> 标签：python

到目前为止，这是我的代码：

```
class Compound(Item):

    def __init__(self, itemID, name, products, itemlist):
        Item.__init__(self,itemID,name)
        self._products = products
        self._items_list = itemlist

    def get_cost(self):
        return self._cost

    def get_items_list(self):
        return self._items_list

    def get_items_str(self):
        return "".format(self._itemID, self._name)

    def set_items(self, itemlist):
        self._itemlist= itemlist

    def get_depend(self):
        allitems = []
        for a in self._set_items:
            allitems.append(n[0])
            return allitems

    def __repr__(self):
        return "{0}, {1}, {2}".format(self._itemID, self._name, self._products, self._items_list)

    def __str__(self):
        return '{0}     {1}                            {2}'.format(self._itemID, self._name, self._products, self._item_list)

class Products():
   def __init__(self):
        self._products = {}

   def get_item(self, itemID):
        return self._products.get(itemID)

    def add_item(self, itemID, product):
        self._products[itemID] = product

    def remove_item(self, itemID, product):
        if item in products:
            self._products.remove(item)
            return True
        return False

    def delete_all(self):
        self._products.clear()

    def get_keys(self):
        return self._products.keys()

    def check_depend(self, item):
        for i in self._products:
            depend = self._products(i).get_depend()
            if item in depend:
                return True
            return False 
```

当我运行以下代码时：

```
products.add_item('CWH111', Compound('CWH111', 'Mountain Bike Built Wheel', products, [('TR202', 1), ('TU227', 1), ('WH239', 1)]))
products.get_item('CWH111') 
```

我想得到

```
CWH111, Mountain Bike Built Wheel, TR202:1,TU227:1,WH239:1 
```

但相反，我得到的只是

```
CWH111, Mountain Bike Built Wheel, <____main____.Products instance at 0x0000000002727588> 
```

我尝试了很多不同的东西；有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:38:20.687

您没有在`self._items_list`此处使用指定字符串格式化程序的参数：

```
return "{0}, {1}, {2}".format(self._itemID, self._name, self._products, self._items_list) 
```

那里只有 3 个插槽（`{0}`和`{1}`）`{2}`，但传入*4 个*参数。以下已经更好了：

```
return "{0}, {1}, {2}".format(self._itemID, self._name, self._items_list) 
```

即使那不会完全打印您想要的内容。

你想格式化`self._items_list`更多：

```
il = ','.join(['{0}:{1}'.format(*item) for item in self._items_list])
return "{0}, {1}, {2}".format(self._itemID, self._name, il) 
```

# pagespeed - Google chrome pagespeed 优化图片

> ID：12827855
> 
> 赞同：0
> 
> 时间：2012-10-10T20:31:44.140
> 
> 标签：pagespeed, google-pagespeed

我可以在公共网站上自由使用使用 Pagespeed for Chrome 优化的图像吗？它们的使用是否受到任何方式（许可证）的限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T09:38:52.913

是的...所有 pagespeed 正在做的就是优化现有图像 - 谷歌不会声称对它们拥有版权，因为你是通过他们的工具运行它的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:37:06.963

我不这么认为。PageSpeed 代码库由 Apache 2.0 许可证管理。[https://developers.google.com/speed/docs/insights/faq#license](https://developers.google.com/speed/docs/insights/faq#license)

如果你想优化自己，你可以使用 jpegtran 或 pngcrush。类似的好处。

# haskell - 如何告诉 QuickCheck 只为参数生成有效的列表索引？

> ID：12827861
> 
> 赞同：16
> 
> 时间：2012-10-10T20:32:11.843
> 
> 标签：haskell, quickcheck

假设我想为该`(!!)`函数编写一些单元测试。

```
my_prop xs n = ... 
```

我想将 n 限制为仅有效索引，我知道我可以做类似的事情

```
my_prop xs n = (not.null) (drop n xs) ==> ... 
```

但这使得绝大多数生成的案例都是无效的并被丢弃。有没有办法可以设置，以便 QuickCheck`xs`首先生成列表并使用它的值来生成有效的情况`n`？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-10T20:46:55.390

使用[`forAll`](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck.html#v:forAll)，您可以指定一个依赖于早期参数的[生成器](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Gen.html)，例如`n`

```
my_prop (NonEmpty xs) = forAll (choose (0, length xs - 1)) $ \n -> ... 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-10T20:46:35.260

您可以制作一个仅创建有效索引并编写您的属性的生成器，例如

```
import Test.QuickCheck
import Test.QuickCheck.Gen
import System.Random

indices :: [a] -> Gen Int
indices xs = MkGen $ \sg _ -> fst $ randomR (0, length xs - 1) sg

my_prop :: [Char] -> Property
my_prop xs = not (null xs) ==> forAll (indices xs) (\i -> xs !! i /= '0') 
```

消除`Int`争论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-11T19:58:33.550

正如 Daniel Wagner 所建议的，一种可能性是创建我自己的数据类型并给它一个`Arbitrary`实例。

```
data ListAndIndex a = ListAndIndex [a] Int deriving (Show)

instance Arbitrary a => Arbitrary (ListAndIndex a) where
   arbitrary = do
     (NonEmpty xs) <- arbitrary
     n  <- elements [0..(length xs - 1)]
     return $ ListAndIndex xs n 
```

`NonEmpty``Test.QuickCheck.Modifiers`来自用于生成非空列表的自定义类型。

# hibernate - Hibernate 实体不会在应用程序中更新，它会在数据库中更新

> ID：12827866
> 
> 赞同：0
> 
> 时间：2012-10-10T20:32:55.150
> 
> 标签：hibernate

我要求您回答以下问题：实体状态未在应用程序中更新但在数据库中更新的原因是什么。

一个简单的例子。

```
System.print.out.println(patio.getName()); // = "HisYard"
patio.setName("MyYard");
session.saveOrUpdate(patio);
session.persists(patio);
session.flush();
session.commit();
session.disconnect();

------MySql Database-------
id_patio = 3
name = "MyYard"
------Database-------

Later on the same application...

Session session = HibernateUtil.getSessionFactory().openSession();
int niceNeigborhood = 3;
Neighborhood neighborhood = (Neighborhood)session.load(Neighborhood.class, niceNeigborhood);
session.refresh(neighborhood);
String whosYardIsThis = neighborhood.getHouse().getPatio().getName();
System.print.out.println(whosYardIsThis); // = "HisYard" !!!!!!! 
```

如您所见，没有什么，刷新，提交，刷新，保存，没有任何工作。但是我的数据库已更新，实体未更新。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T05:46:50.793

经过一整天阅读博客和帖子后，我可以找到解决此问题的方法。基本上，问题是这样的：当您想要获取给定实体的所有属性“正确”更新的更新实例时，您的业务逻辑需要遍历对象以到达给定实体，您需要设置惰性中间对象的集合映射标签中的="false"。我的例子：

```
String whosYardIsThis = neighborhood.getHouse().getPatio().getName(); 
```

要获得属性真正更新的 Patio 对象（以前在项目的其他部分中），您需要将**House**的**邻居**集合映射到

```
<set name="neighborhood" inverse="true" cascade="all-delete-orphan" lazy="false"> 
```

因此数据始终是最新的，从数据库中获取，而不是从麻烦的缓存中获取。

为了比我更好的解释，请检查专家：[6.2。集合映射](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/collections.html)。

# .net - 列出运行时从开放泛型类型创建的封闭类型

> ID：12827869
> 
> 赞同：10
> 
> 时间：2012-10-10T20:33:04.347
> 
> 标签：.net, generics, clr

当我列出当前 AppDomain 中的所有类型时，我会看到我的泛型类型带有泛型占位符。但是，如果我用一个类型实例化我的泛型类型，然后列出 appDomain 中的所有类型，我看不到新创建的封闭类型。

在下面的示例中，输出仅为：

```
Foo`1[T] 
```

我正在寻找封闭类型：

```
Foo`1[System.Int32] 
```

有没有办法根据我的开放泛型类型查看运行时为我创建的封闭类型？

```
class Foo<T>
{
}

class Program
{
    static void Main(string[] args)
    {
        var tmp = new Foo<int>();
        ListTypes();
    }

    private static void ListTypes()
    {
        var types = from assembly in AppDomain.CurrentDomain.GetAssemblies()
                        from type in assembly.GetTypes()
                        where type.Name.Contains("Foo")
                        select type;

        foreach (var type in types)
            Console.WriteLine(type.ToString());
    }
} 
```

我还尝试通过泛型参数查找所有类型，以期发现封闭类型。

```
class Foo<T>
{
}

class Bar
{
}

class Program
{
    static void Main(string[] args)
    {
        var tmp = new Foo<Bar>();
        ListTypes();
    }

    private static void ListTypes()
    {
        var types = from assembly in AppDomain.CurrentDomain.GetAssemblies()
                        from type in assembly.GetTypes()
                        where type.IsGenericType
                        && type.GetGenericArguments().Contains(typeof(Bar))
                        select type;

        foreach (var type in types)
            Console.WriteLine(type.ToString());
    }
} 
```

*这只是为了满足我的好奇心。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T21:58:16.577

据我所知，在这种情况下`Foo<T>`是一个开放的未绑定泛型类型，因此在运行时 CLR 将使用它作为蓝图/骨架来构造和关闭具有指定类型参数类型的泛型类型（`Foo<int>`,`Foo<object>`等）。所以基本上`Foo<int>`是一个运行时构造的`Foo<T>`骨架实现。

现在，在运行时，您可以`Foo<int>`通过使用`typeof(Foo<int>)`or获得类型，`typeof(Foo<>).MakeGenericType(new[] { typeof(int) })`但它并不相同`Type`，而且它没有意义。但仔细观察，您会发现两者都`typeof(Foo<T>)`共享`typeof(Foo<int>)`相同的元数据令牌和 GUID。

另一个有趣的事情是这`typeof(Foo<int>).Assembly`将是您所期望的，但是正如您已经注意到的那样，您无法从 Assembly 中获得该类型。

那是因为`Foo<int>`没有在程序集中定义（您可以使用 Reflector/ILSpy 检查程序集元数据）。在运行时，CLR 将创建（“构造”）`Foo<T>`for `Foo<int>`（如此构造的无界开放泛型类型定义的封闭类型）的专用（“封闭”）版本，并“给”它一个`Type`. 因此，除非 CLR 以某种方式直接公开它在运行时生成的封闭泛型类型列表，否则您将不走运。

这里还有一个片段可以证实我在说什么：

> 尽管每个泛型类型的构造（例如 Node<Form> 和 Node<String>）都有自己独特的类型标识，但 CLR 能够在类型实例化之间重用大部分实际的 JIT 编译代码。这极大地减少了代码膨胀并且是可能的，因为泛型类型的各种实例在运行时被扩展。在编译时存在的所有构造类型都是类型引用。当程序集 A 和 B 都引用在第三个程序集中定义的泛型类型时，它们的构造类型会在运行时扩展。这意味着，除了共享 CLR 类型标识（在适当的情况下）之外，来自程序集 A 和 B 的类型实例化还共享运行时资源，例如本机代码和扩展元数据。
> 
> [http://msdn.microsoft.com/en-us/magazine/cc163683.aspx](http://msdn.microsoft.com/en-us/magazine/cc163683.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T15:23:23.843

Ivan 的回答大部分是正确的，但声称程序集元数据不包含有关构造类型的任何信息并不完全正确。所有构造类型都在使用它们的程序集中定义，并且**Mono.Cecil**等工具让您看到它。构造类型不会通过反射暴露出来，甚至 Mono.Cecil 也很难找到它们。

基本上，您必须遍历程序集中*使用*的所有类型，例如属性类型、返回类型、局部变量类型等。这些信息包含在程序集元数据中，并且使用 Mono.Cecil 相当容易枚举。然后只需应用简单的过滤器来检测类型是否被构造。请注意，您可能必须遍历几个引用泛型类型定义的程序集才能找到从它构造的所有类型。

此解决方案有两个限制。首先，通过反射构造的类型自然不会出现在任何程序集中。其次，一些构造类型嵌入在泛型类型/方法中，并且它们的泛型类型参数只有在其父类型/方法用特定的泛型类型参数实例化后才知道。

# coldfusion - 限制cfchart的x轴

> ID：12827872
> 
> 赞同：0
> 
> 时间：2012-10-10T20:33:28.170
> 
> 标签：coldfusion, coldfusion-8, cfchart

我想限制由`cfchart`. 我看到了限制 y 轴的属性`scaleFrom`，`scaleTo`但我看不到任何限制 x 轴的东西。

另外，我在这里看到了一个类似的问题： [ColdFusion Chart x-axis label limits](https://stackoverflow.com/questions/4254515/coldfusion-chart-x-axis-label-limits) 但没有一个答案是合适的。据我所知，ScaleMin 和 ScaleMax 不存在，另一个答案比我想做的要复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T23:02:58.283

Saul 提到的`scaleMin`和`scaleMax`属性仅在使用[自定义样式](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-74f2.html#WSf01dbd23413dda0e48175ee612010006140-7fff)时可用。请注意，使用“比例”类型意味着您的 xAxis 值必须是数字。如果你想使用字符串，你可能需要使用 Ben 的方法。

这是一个在 xAxis 上创建具有 24 个点的图表的快速示例。即使查询仅包含前六 (6) 个点。

```
<!--- bare bones style --->
<cfsavecontent variable="style">
<?xml version="1.0" encoding="UTF-8"?>
<frameChart is3D="false" isInterpolated="true">
    <frame xDepth="3" yDepth="1" />
    <xAxis type="Scale" scaleMin="0" scaleMax="24" labelCount="25" isBucketed="false" />
</frameChart>
</cfsavecontent>

<!--- sample query --->
<cfset qry = queryNew("")>
<cfset queryAddColumn(qry, "xValue", listToArray("1,2,3,4,5,6"))>
<cfset queryAddColumn(qry, "yValue", listToArray("30,15,22,14,45,5"))>

<!--- chart code --->
<cfchart format="jpg" style="#style#" width="600">
    <cfchartseries type="line" 
        markerstyle="circle"
        query="qry"
        itemColumn="xValue"
        valueColumn="yValue" /> 
</cfchart> 
```

# javascript - javascript电子邮件验证的问题

> ID：12827874
> 
> 赞同：0
> 
> 时间：2012-10-10T20:33:33.577
> 
> 标签：javascript

我正在制作一个将发送电子邮件的联系表格，但我无法确保人们确实在输入数据（我知道我需要进行更深入的验证，但我想确保它首先工作）。当用户单击发送时，javascript 将检查以确保字段已填写。如果是这样，那么它将在服务器端再次验证，然后发送消息（这工作正常），如果不是，它将显示警报并且它不应该发送消息。
但是，使用此 javascript，如果字段为空，它将显示错误消息，然后仍然发送电子邮件。我在这里做错了什么？

```
<script type="text/javascript">
                function validate() {
                    var x=document.forms['mailcontact']['name'].value; 
                    var y=document.forms['mailcontact']['email'].value; 
                    var z=document.forms['mailcontact']['subject'].value; 
                    if (x == '' || x == null || x == ' name') {
                        alert("You need to enter a name");
                    }
                    else if (y == '' || y == null || y == ' email') {
                        alert("You need to enter your email");
                    }
                    else if (z == '' || z == null || z == ' subject') {
                        alert("You need to enter a subject line");
                    }   
                    else {
                        document.forms['maincontact'].submit();
                    }
                }
            </script>

            <form method="POST" action="mail.php" id="mailcontact">
                <input value=" name" size="25" id="contactname" type="text" name="name" onblur="if(this.value=='') this.value=' name';" onfocus="if(this.value==' name') this.value='';" /> 
                <input value=" email" size="25" id="contactemail" type="text" name="email" onblur="if(this.value=='') this.value=' email';" onfocus="if(this.value==' email') this.value='';" />
                <input value=" subject" size="25" id="contactsubject" type="text" name="subject" onblur="if(this.value=='') this.value=' subject';" onfocus="if(this.value==' subject') this.value='';" />
                <textarea name="message"> message</textarea>
                <input onclick="validate()" value="validate_then_send" type="image" src="../images/sendbutton.png" style=" width: 200px; border: none; position: relative; left: 360px;" />
            </form>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T20:36:26.663

```
<script type="text/javascript">
                function validate() {
                    var x=document.forms['mailcontact']['name'].value; 
                    var y=document.forms['mailcontact']['email'].value; 
                    var z=document.forms['mailcontact']['subject'].value; 
                    if (x == '' || x == null || x == ' name') {
                        alert("You need to enter a name");
                    }
                    else if (y == '' || y == null || y == ' email') {
                        alert("You need to enter your email");
                    }
                    else if (z == '' || z == null || z == ' subject') {
                        alert("You need to enter a subject line");
                    }   
                    else {
                        document.forms['maincontact'].submit();
                    }
                }
            </script>

            <form method="POST" action="mail.php" id="mailcontact">
                <input value=" name" size="25" id="contactname" type="text" name="name" onblur="if(this.value=='') this.value=' name';" onfocus="if(this.value==' name') this.value='';" /> 
                <input value=" email" size="25" id="contactemail" type="text" name="email" onblur="if(this.value=='') this.value=' email';" onfocus="if(this.value==' email') this.value='';" />
                <input value=" subject" size="25" id="contactsubject" type="text" name="subject" onblur="if(this.value=='') this.value=' subject';" onfocus="if(this.value==' subject') this.value='';" />
                <textarea name="message"> message</textarea>
                <input onclick="validate();return false;" value="validate_then_send" type="image" src="../images/sendbutton.png" style=" width: 200px; border: none; position: relative; left: 360px;" />
            </form>​ 
```

# formatting - 我想在谷歌文档中复制一个电子表格的格式做另一个电子表格。这可能吗？

> ID：12827878
> 
> 赞同：1
> 
> 时间：2012-10-10T20:33:41.647
> 
> 标签：formatting

我正在为我的数学学生开发一个反馈系统，并有一个矩阵来显示他们在测试中得到的分数。

我在这份文件中有几张纸，每个学生一张。我还为每个学生制作了一个电子表格，我将其放在 Google Drive 上的一个共享文件夹中，学生只有查看权限。

我想要做的是将整个工作表从我的主文档复制到学生的电子表格中。如果我使用导入范围函数，这一切都很好，但是格式不遵循。

是否可以使用带有命令的脚本`getBackgroundColor()`并将主表`setBackgroundColor()`转移`backgroundcolors`到学生表？

我从这样的事情开始：

```
function getColor() {
var sheet = SpreadsheetApp.openById("0ApOkn5XcO_GDdFd4SDBaaFpLSEUxXy1vN2pnNHBpYnc");
var ss=sheet.getSheetByName("Student1");
var r=ss.getRange("A1:R34");
var color = ss.getBackgroundColors(); 
```

这就是我所得到的。有人有想法吗？

# linux - NDK 会剥离调试信息吗？

> ID：12827879
> 
> 赞同：2
> 
> 时间：2012-10-10T20:33:43.690
> 
> 标签：linux, linker, android-ndk, gdb, debug-symbols

我正在构建一个带有静态库 (.a) 作为输入之一的 NDK 共享库。静态库具有 GDB 格式的调试信息。调试信息是否会出现在最终的 .SO 中？我该如何检查？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T20:44:59.487

是的，它确实。NDK 构建的最后一步是将`.so`文件从`obj`目录复制到`lib`，在途中剥离符号。您可以看到文件变小了多少`lib/armeabi`。

# java - CustomDialog，模式和关闭时处理

> ID：12827880
> 
> 赞同：0
> 
> 时间：2012-10-10T20:33:46.023
> 
> 标签：java, jdialog

我有一个`CustomDialog`可以扩展的`JDialog`.

在其中`constructor`我有

```
setModalityType(ModalityType.APPLICATION_MODAL);

setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE); 
```

它们似乎不能很好地协同工作：我认为模态卡住了`defaultcloseoperation`，最后我必须单击两次`X`才能`CustomDialog`关闭。

我应该如何采取行动来获得两者

1-始终在顶部可视化（我`application_modal`用于此）

2-关闭时处理

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T21:20:12.650

这个对我有用：

```
dialog.setModal(true);
dialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T21:00:59.087

I answer to provide people who have the same "click the X twice in order to close" behaviour a future reference.

My issue was related to a double setVisible(true), one in the constructor and one in a "initializer" function.

With only 1 setVisible(true), the issue is gone

# function - Emacs：函数中的通用参数（Cu）

> ID：12827887
> 
> 赞同：21
> 
> 时间：2012-10-10T20:34:16.903
> 
> 标签：function, emacs, arguments

我想`C-u`在一个函数（例如，正则表达式）中使用它来调用它`C-u`有不同的效果。我怎样才能在 Emacs 中做到这一点？该文档没有显示如何使用 Emacs Lisp 执行此操作。

```
(defun test ()
  (interactive)
  (align-regexp)) ; I would like to add the C-u prefix to this. 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-10T23:14:18.833

```
(defun my/test ()
  (interactive)
  (let ((current-prefix-arg 4)) ;; emulate C-u
    (call-interactively 'align-regexp) ;; invoke align-regexp interactively
    )
  ) 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-07-02T13:01:21.700

我来到这里是为了寻找一种方法来检测*我的*函数是否被 Cu 调用。这就是你的做法：

```
(defun my-function ()
 (interactive)
  (if (equal current-prefix-arg nil) ; no C-u
   ;; then
    (message "my-function was called normally")
   ;; else
    (message "my-function was called with C-u"))) 
```

原发帖人要问的是如何*从他/她的 function 内部*调用Cu的*另一个*函数。我将其发布为对上述@codyChan 评论的澄清，希望它可能对其他人有所帮助。

# macos - mac 命令键在终端中的表示是什么？

> ID：12827888
> 
> 赞同：6
> 
> 时间：2012-10-10T20:34:24.080
> 
> 标签：macos, bash, terminal, stty

就像控制键在终端中用'^'表示，命令键（mac）的等价物是什么？

我正在尝试使用 stty 重新映射我的 bash 快捷方式

例如

stty eof ^D

但不是控制，我想使用命令键。

编辑：

好的，所以我试图解决的问题是我想交换命令和控制键，因为我在 osx 和 linux 上工作，不同的组合键给我带来了很多痛苦。

所以我使用 osx 首选项交换了修饰键。但是现在所有 bash 快捷键（如 Ctrl+C 等）都等同于使用键序列 'cmd+c' - 这是不可接受的。

值得庆幸的是，iTerm2 也支持修改键的重新映射，所以对于 iTerm2，我再次反转了它们，这意味着 iTerm2 将命令识别为命令，将控制识别为控制。

所以问题暂时解决了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T20:44:54.993

The command-key shortcuts do not generate actual input for your terminal, so they are not represented in any way. Terminal allows you to bind certain key combinations to produce actual input (in `Preferences > Settings > Keybaord`), but you don't get the choice of a `Command` modifier for them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:40:48.137

在你的 bash shell 中输入：

```
stty ctlecho 
```

然后打`Command`

这将显示您需要的内容。

恢复正常

```
stty -ctlecho 
```

如果它不起作用，请尝试组合。

`Ctrl`带有+的示例`C`

```
$ stty ctlecho
$ ^C
$ stty -ctlecho
$ 
```

# android - 有没有办法在 textEdit 中打印日文字符？

> ID：12827894
> 
> 赞同：0
> 
> 时间：2012-10-10T20:34:49.197
> 
> 标签：android, eclipse

我想编写一个打印出日文字符的程序，但是当我尝试使用 eclipse 和 android SDK 开发程序时，编辑器不允许我将日文字符剪切并粘贴到 eclipse 文本编辑器中（它只显示？）。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:44:53.010

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:43:04.733

eclipse中需要设置默认编码为UTF-8才能支持unicode

> Windows > Preferences > General > Content Types > Text > {Choose file type} {Selected file type} > Default encoding > UTF-8" 并单击更新。

# java - 为什么这个简单的 SOAP 客户端不起作用（org.apache.http）？

> ID：12827900
> 
> 赞同：5
> 
> 时间：2012-10-10T20:35:05.477
> 
> 标签：java, http, post, soap, apache-commons-httpclient

我想将 XML 文件作为请求发送到 SOAP 服务器。这是我的代码：（修改自[Sending HTTP Post request with SOAP action using org.apache.http](https://stackoverflow.com/questions/10671494/sending-http-post-request-with-soap-action-using-org-apache-http)）

```
import org.apache.http.client.*;
import org.apache.http.client.methods.*;
import org.apache.http.impl.client.*;
import org.apache.http.entity.StringEntity;
import org.apache.http.protocol.HTTP;
import org.apache.http.HttpResponse;
import java.net.URI;

public static void req()   {
        try {
            HttpClient httpclient = new DefaultHttpClient();
            String body="xml here";
            String bodyLength=new Integer(body.length()).toString();

            URI uri=new URI("http://1.1.1.1:100/Service");
            HttpPost httpPost = new HttpPost(uri);
            httpPost.setHeader( "SOAPAction", "MonitoringService" );
            httpPost.setHeader("Content-Type", "text/xml;charset=UTF-8");

            StringEntity entity = new StringEntity(body, "text/xml",HTTP.DEFAULT_CONTENT_CHARSET);
            httpPost.setEntity(entity);

            RequestWrapper requestWrapper=new RequestWrapper(httpPost);
            requestWrapper.setMethod("POST");

            requestWrapper.setHeader("Content-Length",bodyLength);
            HttpResponse response = httpclient.execute(requestWrapper);
            System.out.println(response);
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

在此之前，我从服务器收到错误“http 500”（内部服务器错误），但现在我根本没有得到任何回复。我知道服务器工作正常，因为其他客户端没有问题。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T11:22:12.633

org.apache.http API 不支持 SOAP/Web 服务，因此您正在以非标准方式进行棘手的工作。该代码对 java 不是很友好或灵活，因为它不能自动将 java 对象数据“绑定”（转换）到 SOAP 请求和 SOAP 响应之外。调试和开始工作有点冗长、棘手，而且很脆弱——您是否在处理完整的 SOAP 协议，包括故障处理等？

我可以建议使用 JVM 中内置的 JAX-WS 标准吗：

**1\. 将 WSDL 文件保存到本地磁盘**
例如`<app path>/META-INF/wsdl/abc.com/calculator/Calculator.wsdl`
，如果您没有 WSDL，您可以在浏览器中键入并将结果页面保存到磁盘：
[http ://abc.com/calculator/Calculator?wsdl](http://abc.com/calculator/Calculator?wsdl)

**2.使用wsimport命令将WSDL转换为java类文件**
对于JDK，工具在`<jdkdir>\bin\wsimport.exe (or .sh)`.
对于应用服务器，将类似于`<app_server_root>\bin\wsimport.exe (or .sh)`

`<filepath>\wsimport -keep -verbose <wsdlpath>\Calculator.wsdl`

或者，如果您的 WSDL 可通过预先存在的 Web 服务获得

`<filepath>\wsimport -keep -verbose http://abc.com/calculator/Calculator?wsdl`

（也可以包含“-p com.abc.calculator”来设置生成类的包）

生成如下文件 - 在您的 java 项目中包含这些源文件：

```
com\abc\calculator\ObjectFactory.java       
com\abc\calculator\package-info.java       
com\abc\calculator\Calculator.java       ............................name = `<wsdl:portType>` name attribute      
com\abc\calculator\CalculatorService.java     ................name = `<wsdl:service>` name attribute    
com\abc\calculator\CalculatorRequestType.java  .......name = schema type used in input message    
com\abc\calculator\CalculatorResultType.java ..........name = schema type used in output message 
```

**2\. 创建 JAX-WS SOAP Web 服务客户端**

```
package com.abc.calculator.client;

import javax.xml.ws.WebServiceRef;
import com.abc.calculator.CalculatorService;
import com.abc.calculator.Calculator;

public class CalculatorClient {

    @WebServiceRef(wsdlLocation="META-INF/wsdl/abc.com/calculator/Calculator.wsdl")
    // or @WebServiceRef(wsdlLocation="http://abc.com/calculator/Calculator?wsdl")
    public static CalculatorService calculatorService;

    public CalculatorResponseType testCalculation() {
        try {
            CalculatorRequestType request = new CalculatorRequest();
            request.setSomeParameter("abc");
            request.setOtherParameter(3);
            Calculator calculator = calculatorService.getCalculatorPort();
            // automatically generate SOAP XML message, send via HTTP, 
            // receive & marshal response to java object 
            String response = calculator.doCalculation(response);
        } catch(Exception e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T15:52:27.940

尝试像这样发送请求。这就是我上次的做法：

```
try
        {
            StringBuffer strBuffer = new StringBuffer();
            HttpURLConnection connection = connectToEndPoint(endpoint);
            OutputStream outputStream = generateXMLOutput(connection, yourvalue, strDate);

            InputStream inputStream = connection.getInputStream();

            int i;
            while ((i = inputStream.read()) != -1) {
                Writer writer = new StringWriter();
                writer.write(i);
                strBuffer.append(writer.toString());

            String status = xmlOutputParse(strBuffer); 
```

以及使用的功能：

```
private static HttpURLConnection connectToEndPoint(String wsEndPoint) throws MalformedURLException, IOException {
    URL urlEndPoint = new URL(wsEndPoint);
    URLConnection urlEndPointConnection = urlEndPoint.openConnection();
    HttpURLConnection httpUrlconnection = (HttpURLConnection) urlEndPointConnection;
    httpUrlconnection.setDoOutput(true);
    httpUrlconnection.setDoInput(true);
    httpUrlconnection.setRequestMethod("POST");
    httpUrlconnection.setRequestProperty("content-type", "application/soap+xml;charset=UTF-8");
    // set connection time out to 2 seconds
    System.setProperty("sun.net.client.defaultConnectTimeout", String.valueOf(2 * 1000));
    // httpUrlconnection.setConnectTimeout(2*1000);
    // set input stream read timeout to 2 seconds
    System.setProperty("sun.net.client.defaultReadTimeout", String.valueOf(2 * 1000));
    // httpUrlconnection.setReadTimeout(2*1000);
    return httpUrlconnection;
} 
```

在哪里手动创建 xml（根据需要修改）：

```
private static OutputStream generateXMLOutput(HttpURLConnection conn, String msisdn, String strDate) throws IOException {
    OutputStream outputStream = conn.getOutputStream();

    StringBuffer buf = new StringBuffer();

    buf.append("<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:ins=\"http://yournamespace">\r\n");
    buf.append("<soap:Header xmlns:wsa=\"http://www.w3.org/2005/08/addressing\">\r\n");

    //..... append all your lines .......       

    OutputStreamWriter outputStreamWriter = new OutputStreamWriter(outputStream, "UTF-8");

    outputStreamWriter.write("<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:ins=\"http://yournamespace\">\r\n");
    outputStreamWriter.write("<soap:Header xmlns:wsa=\"http://www.w3.org/2005/08/addressing\">\r\n");
    //..... write all your lines .......    

    outputStreamWriter.flush();

    outputStream.close();
    return outputStream;
} 
```

以及返回您的 WS 答案的函数：

```
private static String xmlOutputParse(StringBuffer xmlInputParam) throws IOException, ParserConfigurationException, SAXException {
    String status = null;
    DocumentBuilderFactory docBuilderfFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder documentBuilder = docBuilderfFactory.newDocumentBuilder();
    InputSource inputSource = new InputSource();
    inputSource.setCharacterStream(new StringReader(xmlInputParam.toString()));
    Document document = documentBuilder.parse(inputSource);
    NodeList nodeList = document.getElementsByTagName("ResponseHeader");
    Element element = (Element) nodeList.item(0);
    if (element == null) {
        return null;
    }
    NodeList name = element.getElementsByTagName("Status");
    Element line = (Element) name.item(0);
    if (line == null) {
        return null;
    }
    if (line.getFirstChild() instanceof CharacterData) {
        CharacterData cd = (CharacterData) line.getFirstChild();
        status = cd.getData().trim();
    }
    return status;
} 
```

我认为这个解决方案（即使很长）适用于大多数情况。我希望你能适应你的需要。

此致 ！

# python - 如何使用 Scrapy/Python 从条件下拉字段中获取值？

> ID：12827908
> 
> 赞同：4
> 
> 时间：2012-10-10T20:35:47.083
> 
> 标签：python, web-crawler, scrapy

本[教程](http://www.pixelmender.com/2010/10/12/scraping-data-using-scrapy-framework/)帮助我收集网站上的第一个下拉列表条目。但我无法使用 Scrapy 获取第二个条件/依赖下拉框的数据。

假设以下程序是要走的路，那么第 2 步如何工作？到目前为止，这些值从未出现过......

1.  获取第一个下拉框的列表条目
2.  选择第一个下拉框的第一个值。
3.  获取所有相关的下拉值。
4.  迭代第一个下拉列表...

我认为下面的代码需要调整，因为代码用于提交表单：

```
 for i in range(len(brandCategoryList)):

        # Generate new request for each brand category's page
        yield FormRequest("http://www.xxxxxxxxxx.com",
                    method='POST',                         
                    formdata={'BrandName':'','CatBrand':brandCategoryList[i],'submit1':'Find+Product'},
                    callback=self.parseBrandPage,
                    meta={'brandCategoryId':i,'brandCategoryName':brandCategoryList[i]}) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T22:54:38.383

Scrapy 不会在您正在抓取的页面中运行任何 javascript 代码，并且依赖下拉菜单通常依赖 javascript 根据其控制下拉菜单中的选择来填充其选项。

如果您需要自动化/抓取需要 javascript 的内容，您可能需要考虑另一个库。[从这里](https://stackoverflow.com/questions/2190502/screen-scraping-with-python)开始获取一些指示。

# excel - 使用 VBA 宏计算分子和分母

> ID：12827909
> 
> 赞同：0
> 
> 时间：2012-10-10T20:35:48.180
> 
> 标签：excel, excel-2007, vba

我在使用 excel VBA 计算分子和分母时遇到问题。num 和 den 仅限于在 Excel 电子表格中输入数据的季度。

这是一个示例：我的 excel 表中有两列：

```
Date_data_entered_for each_person   Number of visits to the office
1/1/2009                                            5
1/10/2009                                           6
2/10/2009                                           7
5/12/2009                                           9 
```

基于这个例子，我必须计算每季度的“平均访问次数”=访问总和/人数。在这个 2009 年第一季度的示例中，输入了 3 人的数据，总访问次数为 5+6+7 = 18，因此平均值 = 18/3 = 6。

我写的代码是：

```
Function Visits(target_timeframe)

    Target_Quarter = Format(target_timeframe, "YYYYq")

    For vRow = 2 To 2000

        entered_timeframe = Format(Sheets("sheet1").Range("A" & vRow).Value, "YYYYq")

        Entered_Visits = Sheets("sheet1").Range("B" & vRow).Value 'equals value of column

        If (entered_timeframe = Target_Quarter) Then
            denominator = denominator + 1
            If (Entered_Visits > 0) Then
                numerator = numerator + 1
            End If
        End If
    Next

    If denominator > 0 Then
        Average = numerator / denominator
    Else
        Average = "N/A"
    End If

End Function 
```

我无法弄清楚代码有什么问题。它不计算平均值。如果有人可以帮助我解决这个问题，我将不胜感激。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:39:11.437

我认为，而不是：

```
numerator = numerator + 1 
```

你要：

```
numerator = numerator + Entered_Visits 
```

使用当前代码，您每次只需将分子加 1，而实际上您希望将访问次数添加到分子。

# sql - 同一个查询没有锁运行

> ID：12827912
> 
> 赞同：1
> 
> 时间：2012-10-10T20:35:55.157
> 
> 标签：sql, sql-server-2008

```
 if exists (select 1 from schema.TableName (nolock) where Id = @id) 
                update schema.TableName set DocumentXML = @documentXml, ClientDocumentGUID=@clientDocGuid, Incomplete = @incomplete where Id = @id
                else
                insert into schema.TableName
                select @id, @templateId, @clientVisitGuid, @clientGuid, @chartGuid, @scmDocumentGuid, @clientDocGuid, @incomplete, getdate(), @createdByGuid, @documentXml 
```

我有一个运行上述查询的 C# 程序。我遇到了行被插入两次的情况。我认为问题是这个查询。这个想法是查询可以在相同的情况下运行两次`@Id`。第一次应该是插入，第二次应该是更新。

请注意，查询有一个`(no lock)`. 这是否意味着查询不一定以 FIFO 方式运行？我相信只有当我异步运行这个查询时才会出现两行问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:53:26.973

If you have two requests processing at the same time they will both insert since your ignoring all locks on the first table. I like using [merge](http://technet.microsoft.com/en-us/library/bb510625.aspx) in these cases. Or remove your no lock and ensure your transaction isolation level is snapshot or serialized.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T20:38:48.097

根据事务隔离级别查询可以并行运行......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T02:41:14.870

使用 NOLOCK 提示会导致 SQL Server 忽略所有锁。这意味着一个查询可能最终会读取它们中间的值被更改，这会导致返回完全垃圾。

但是，删除 NOLOCK 提示是不够的。您需要确保所有语句都在调用应用程序或过程中的事务中执行。如果您使用程序，请先查看以下内容：[如何在程序中回滚](http://sqlity.net/en/585/how-to-rollback-in-procedures/)

将语句包装在事务中后，您还需要确保 IF EXISTS 语句对行进行更新或排他锁，以防止其他人在您的语句之间插入行，因此您需要 UPDLOCK 或 XLOCK暗示。由于该行可能还不存在，这也只能在可序列化事务隔离级别中实现。

在你实现了所有这些之后，你仍然在浪费这个设置的读取。这可能会在以后成为性能问题。

--

长话短说：正如 JoshBerke 建议的那样，在这种情况下，您应该真正使用 MERGE 语句。这将在更快、更容易维护的同时防止您的问题。但是，它需要 2008 或更高版本。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/bb510625.aspx](http://msdn.microsoft.com/en-us/library/bb510625.aspx)。

# apache - 500 内部服务器错误，.htaccess 文件直接从工作服务器复制

> ID：12827924
> 
> 赞同：1
> 
> 时间：2012-10-10T20:36:34.540
> 
> 标签：apache, error-handling

我收到内部服务器错误，我认为一切设置正确，我将整个站点从旧主机带到新主机，现在我收到错误。看起来像这样的相同 .htaccess 文件

```
 # Mod Rewrite
 Options +FollowSymLinks
 RewriteEngine On
 RewriteBase /
 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d
 RewriteRule . /index.php [L]

 ## adjust memory limit

 # php_value memory_limit 64M 
 php_value memory_limit 256M 
 php_value max_execution_time 18000 
```

不知道是什么问题，感谢任何帮助

请注意，该站点现在托管在 godaddy 上，我被告知我需要将以下行添加到 htaccess 以进行 modrewrite

```
#Fix Rewrite
Options -Multiviews 
```

还是行不通

好的，所以终于得到了关于这个的错误报告，

```
[Wed Oct 10 15:05:09 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhapsmisspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:05:10 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:06:07 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:06:07 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:06:51 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:06:51 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:07:10 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:10 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:10 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:10 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:12 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:12 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:12 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:12 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:13 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:13 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:13 2012] [warn] [client 64.60.65.18] (104)Connection reset by peer: mod_fcgid: error reading data from FastCGI server
[Wed Oct 10 15:07:13 2012] [error] [client 64.60.65.18] Premature end of script headers: index.php
[Wed Oct 10 15:07:18 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration
[Wed Oct 10 15:07:18 2012] [alert] [client 64.60.65.18] /var/chroot/home/content/23/9953123/html/.htaccess: Invalid command 'php_value', perhaps misspelled or defined by a module not included in the server configuration 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-13T23:52:19.820

`php_value`apache使用**fastcgi/mod_fcgid**时不能设置

 **尝试注释掉这些值，或者像这样封装它们

```
<IfModule mod_php5.c>
   php_value something_something  164M
</IfModule> 
```

当我的主机升级服务器时，我遇到了同样的问题。从*.htaccess*中删除它们后，我将我的`php_value`语句放入 php；我认为有不止一种方法可以重新实现它们。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-03T17:25:11.377

几天来，我一直试图弄清楚这一点。就像原始问题显示的那样，我的 Apache 错误日志也报告“无效命令 'php_value'，可能拼写错误或由服务器配置中未包含的模块定义”

最后，遇到评论“当 apache 使用 fastcgi / mod_fcgid 时您不能设置 php_value”是一个线索。因为我不知道那是什么意思，但它听起来与我的问题有关，所以我四处搜索并学到了很多重要的东西：

1) PHP 可以作为 Apache 模块或 CGI 二进制文件运行，这在设置 php 值方面有很大的不同。要找出你的，运行 phpinfo() [如果你不知道怎么做，请用谷歌搜索]。如果输出显示“php-fpm”，那么您的输出是作为 CGI 而不是作为 Apache 模块运行的。

2）如果你的作为 CGI 运行，那么你不能将 php_value 或任何其他 php 设置放在 .htaccess 中。您必须在 php.ini 中设置它们（其位置也在 phpinfo 输出中给出）或通过函数 ini_set 在您的 php 代码中设置。例如

```
ini_set('display_errors', '1'); 
```

3) 最重要的是：如果您更改了 php.ini，然后重新启动 Apache 并发现您的设置没有改变，这可能意味着您正在作为 CGI 而不是作为 Apache 模块运行。那么重新启动 Apache 不会重新加载 php.ini 是有道理的，因为它没有运行 php。要使更改发生，您必须重新启动 php-fpm 服务！（我已经把头发拉出来好几天了，因为我能找到的关于在 php.ini 中设置值的每个答案都说你更改了 php.ini 并重新启动 Apache 并且这只是工作。但它对我不起作用。这就是为什么.) 在我正在构建的系统上，即 Amazon AWS Linux 2 实例上，重新启动服务的命令是：

```
sudo systemctl restart php-fpm 
```

你的可能不一样。

我希望这个答案可以帮助一些像我一样沮丧的人。

坦率**

# java - 如何在 Java 中增加/减少 unicode 字符串？

> ID：12827926
> 
> 赞同：2
> 
> 时间：2012-10-10T20:36:38.650
> 
> 标签：java, string, algorithm, unicode

如何实现给定字符串 A 生成字符串 B 的函数 increment(string)，其中：

1.  B > A（使用 Java 的 compareTo 逻辑）
2.  存在 NO C 其中 B > C > A

给定字符串 A 产生字符串 B 的减量（字符串）也是如此，其中：

1.  B < A（使用 Java 的 compareTo 逻辑）
2.  存在 NO C 其中 B < C < A

**编辑**

正如评论中所指出的，如果没有一些限制，这个问题是不可能回答的。限制是您不能在字符串中追加/删除新字符，除非它是为了处理流量不足/溢出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T20:43:34.280

增量很简单：`B = A + "\u0000"`.

减量是不可能的；`"Y"`例如，小于 的最大字符串是`"X\uFFFF\uFFFF\uFFFF\uFFFF\uFFFF\uFFFF..."`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:48:26.273

我认为您可以将增量写为：

```
 str = str.substring(0, str.length()-1)+((char)(str.charAt(str.length()-1)+1)); 
```

并递减为：

```
 str = str.substring(0, str.length()-1)+((char)(str.charAt(str.length()-1)-1)); 
```

这里一定要处理边界条件，即在递增期间，如果您的字符串最高，而在递减期间，您的字符串是最小的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T23:36:24.787

试试这个：（编辑修复了一些错误，编辑2：测试工作，但比较失败）

```
import static org.junit.Assert.*;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
class Ids {
    Ids(char min,char max) {
        this.min=min;
        this.max=max;
        n=max-min+1;
    }
    String inc(String s) {
        if(print)
            System.out.println("inc "+s);
        String t="";
        char c=s.charAt(s.length()-1);
        char o=c==max?min:(char)(c+1);
        boolean carry=o==min;
        t+=o;
        for(int i=s.length()-2;i>=0;i--) {
            c=s.charAt(i);
            if(carry) {
                o=c==max?min:(char)(c+1);
                carry=o==min;
            } else o=c;
            t+=o;
        }
        if(carry)
            t+=min;
        t=reverse(t);
        if(print)
            System.out.println("inc returns "+t);
        int compare=s.compareTo(t);
        if(compare!=-1)
            System.out.println("compare fails: "+s+"<>"+t+" returns "+compare);
        return t;
    }
    private static String reverse(String t) {
        String t2="";
        for(int i=0;i<t.length();i++)
            t2+=t.charAt(t.length()-1-i);
        return t2;
    }
    String dec(String s) {
        if(print)
            System.out.println("dec "+s);
        String t="";
        char c=s.charAt(s.length()-1);
        if(c==min&&s.length()==1)
            return null;
        char o=c==min?max:(char)(c-1);
        boolean borrow=o==max;
        t+=o;
        if(print)
            System.out.println("last character, t="+t);
        for(int i=s.length()-2;i>=0;i--) {
            c=s.charAt(i);
            if(print)
                System.out.println("in loop, c="+c);
            if(borrow) {
                if(c==min) {
                    o=max;
                    borrow=true;
                } else {
                    o=--c;
                    borrow=false;
                }
                // o=c==min?max:(char)(c-1);
                // borrow=o==max;
            } else o=c;
            if(print)
                System.out.println("in loop, adding: "+o);
            t+=o;
            if(print)
                System.out.println("in loop, t="+t);
        }
        if(borrow)
            t=t.substring(0,t.length()-1);
        t=reverse(t);
        if(print)
            System.out.println("dec returns "+t);
        int compare=s.compareTo(t);
        if(compare!=1)
            System.out.println("compare fails: "+s+"<>"+t+" returns "+compare);
        return t;
    }
    void run(String s) {
        String i=inc(s);
        String d=dec(s);
        System.out.println(d+"<"+s+"<"+i);
    }
    void run() {
        print();
        run("b");
        run("c");
        run("y");
        run("z");
    }
    public static void main(String[] args) {
        new Ids('a','z').run();
    }
    void print() {
        System.out.println("min="+min+", max="+max+",range="+n);
    }
    static boolean print;
    final char min,max;
    final int n;
}
public class So12827926TestCase {
    @Before public void setUp() throws Exception {
        Ids.print=false;
    }
    @After public void tearDown() throws Exception {
        Ids.print=false;
    }
    @Test public void testIncDecOnOneCharacter() {
        for(char c=ids.min;c<ids.max;c++) {
            String original=""+(char)(c);
            String expected=""+(char)(c+1);
            String actual=ids.inc(""+(char)c);
            assertEquals(expected,actual);
            String duplicate=ids.dec(expected);
            assertEquals(original,duplicate);
        }
    }
    @Test public void testDecIncOnOneCharacter() {
        for(char c=(char)(ids.min+1);c<=ids.max;c++) {
            String original=""+(char)(c);
            String expected=""+(char)(c-1);
            String actual=ids.dec(""+(char)c);
            assertEquals(expected,actual);
            String duplicate=ids.inc(expected);
            assertEquals(original,duplicate);
        }
    }
    @Test public void testIncDecEdgeCaseOnOneCharacter() {
        String original=""+ids.max;
        String expected=""+ids.min+ids.min;
        String actual=ids.inc(original);
        assertEquals(expected,actual);
        String duplicate=ids.dec(expected);
        assertEquals(original,duplicate);
    }
    @Test public void testIncEdgeCaseOnTwoCharacters() {
        String original=""+ids.min+ids.min;
        String expected=""+ids.min+(char)(ids.min+1);
        String actual=ids.inc(original);
        assertEquals(expected,actual);
    }
    @Test public void testDecIncEdgeCaseOnOneCharacter() {
        String original=""+ids.min;
        String expected=null;
        String actual=ids.dec(original);
        assertEquals(expected,actual);
        if(expected!=null) {
            String duplicate=ids.inc(expected);
            assertEquals(original,duplicate);
        }
    }
    @Test public void testIncDecEdgeCaseOnTwoCharacters() {
        String original=""+ids.min+ids.max;
        String expected=""+(char)(ids.min+1)+ids.min;
        String actual=ids.inc(original);
        assertEquals(expected,actual);
        String duplicate=ids.dec(expected);
        assertEquals(original,duplicate);
    }
    @Test public void testDecIncEdgeCaseOnTwoCharacters() {
        String original=""+ids.max+ids.min;
        String expected=""+(char)(ids.max-1)+ids.max;
        String actual=ids.dec(original);
        assertEquals(expected,actual);
        String duplicate=ids.inc(expected);
        assertEquals(original,duplicate);
    }
    @Test public void testIncDecEdgeCaseOnThreeCharacters() {
        String original=""+ids.min+ids.max+ids.max;
        String expected=""+(char)(ids.min+1)+ids.min+ids.min;
        String actual=ids.inc(original);
        assertEquals(expected,actual);
        String duplicate=ids.dec(expected);
        assertEquals(original,duplicate);
    }
    @Test public void testDecIncEdgeCaseOnThreeCharacters() {
        String original=""+ids.max+ids.min+ids.min;
        String expected=""+(char)(ids.max-1)+ids.max+ids.max;
        String actual=ids.dec(original);
        assertEquals(expected,actual);
        String duplicate=ids.inc(expected);
        assertEquals(original,duplicate);
    }
    @Test public void testDecIntForSomeEdgeCases() {
        Ids ids=new Ids('a','z'); 
        for(int i=0;i<originals.length;i++) {
            String original=originals[i];
            String expected=expecteds[i];
            String actual=ids.dec(original);
            assertEquals(expected,actual);
            String duplicate=ids.inc(expected);
            assertEquals(original,duplicate);
        }
    }
    @Test public void testIncDecForSomeEdgeCases() {
        Ids ids=new Ids('a','z'); 
        for(int i=0;i<originals.length;i++) {
            String original=expecteds[i];
            String expected=originals[i];
            String actual=ids.inc(original);
            assertEquals(expected,actual);
            String duplicate=ids.dec(expected);
            assertEquals(original,duplicate);
        }
    }
    @Test public void testInc() {
        Ids ids=new Ids('a','z'); 
        String start=""+ids.min,s=start;
        for(int i=0;i<ids.n-1;i++) 
            s=ids.inc(s);
        assertEquals(""+ids.max,s);
    }
    @Test public void testDec() {
        Ids ids=new Ids('a','z'); 
        String start=""+ids.max,s=start;
        for(int i=0;i<ids.n-1;i++) 
            s=ids.dec(s);
        assertEquals(""+ids.min,s);
    }
    Ids ids=new Ids('a','b');
    // swap these, they will make more sense that way.
    static final String[] originals=new String[]{"baa","caa","daa","xaa","yaa","zaa"};
    static final String[] expecteds=new String[]{"azz","bzz","czz","wzz","xzz","yzz"};
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T20:47:31.220

正如你对数字所做的那样。例如，取一个数字`ABCD`。`D`通过增加 可以找到下一个数字`1`。但如果这导致`D`成为`0`，你必须增加`C`。等等。将字符串视为数字，其中每个数字实际上是一个 16 位值。减少的方法相同。如何做到这一点的技术部分掌握在您手中。

# iphone - 为什么我的 UIView 动画效果不同？

> ID：12827928
> 
> 赞同：0
> 
> 时间：2012-10-10T20:36:39.410
> 
> 标签：iphone, cocos2d-iphone, uikit, game-engine

我正在开发[一个游戏引擎](https://github.com/MosheBerman/MBTileParser)，我遇到了一个相当莫名其妙的行为。我敢肯定这很简单，但我想在继续之前弄清楚。

我`UIImageView`对多个动画精灵进行了子类化并添加了支持。我也有控制工作，但我一直看到一种奇怪的行为。当我的角色向上或离开时，动画会跳过一帧，并且看起来移动得更快。向右或向下移动会变慢并显示正确的三帧。

我已经浏览了整个调用堆栈，但我无法弄清楚。这是发生的事情：

*   用户点击虚拟手柄。
*   游戏控制器视图控制器发送通知。
*   主要播放器精灵接收到通知。
*   精灵询问代理是否允许它移动到它想去的地方。
*   如果确实允许，精灵会在给定的距离内移动。

精灵移动代码如下所示：

```
//  Move in a direction
- (void)moveInDirection:(MBSpriteMovementDirection)direction distanceInTiles:(NSInteger)distanceInTiles withCompletion:(void (^)())completion{

CGRect oldFrame = [self frame];
CGSize tileDimensions = CGSizeZero;

tileDimensions = [[self movementDataSource] tileSizeInPoints];

if (tileDimensions.height == 0 && tileDimensions.width == 0) {

    NSLog(@"The tile dimensions for the movement method are zero. Did you forget to set a data source?\nI can't do anything with this steaming pile of variables. I'm outta here!");

    return;
}

CGPoint tileCoordinates = CGPointMake(oldFrame.origin.x/tileDimensions.width, oldFrame.origin.y/tileDimensions.height);

//  Calculate the new position
if (direction == MBSpriteMovementDirectionLeft || direction == MBSpriteMovementDirectionRight) {
    oldFrame.origin.x += (tileDimensions.width * distanceInTiles);
    tileCoordinates.x += distanceInTiles;
}else{
    oldFrame.origin.y += (tileDimensions.height * distanceInTiles);
    tileCoordinates.y += distanceInTiles;
}

if (![[self movementDelegate] sprite:self canMoveToCoordinates:tileCoordinates]) {
    [self resetMovementState];
    if(completion){
        completion();
    }
    return;
}

[self startAnimating];

[UIView animateWithDuration:distanceInTiles*[self movementTimeScaleFactor] delay:0 options:UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState animations:^{

    [self setFrame:oldFrame];
}
                 completion:^(BOOL finished) {
                     //  Perform whatever the callback warrants
                     if(completion){
                         completion();
                     }
                     [self resetMovementState];
                 }];
} 
```

如果`MBSpriteMovement`方向（它是 的 typedef `NSUInteger`）是向上或向左，`distanceInTiles`则为负整数。计算出正确的距离，但由于某种原因，向下和向右似乎更慢。我确定它在向上/向左移动时确实会跳过一帧。

知道为什么吗？

（这是一个开源项目，可以在[这里找到，在 GitHub 上](https://github.com/MosheBerman/MBTileParser)。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T00:32:56.633

您需要确保赋予`UIView`动画例程的持续时间是非负数。这可以通过以下`fabs`函数轻松完成：

```
NSTimeInterval animationDuration = fabs(distanceInTiles*[self movementTimeScaleFactor]);

[UIView animateWithDuration:animationDuration
                      delay:0
                    options:UIViewAnimationOptionCurveLinear | UIViewAnimationOptionBeginFromCurrentState
                 animations:^{
                    //...
                 }]; 
```

# regex - 正则表达式将所有多行 html 组合转换为一行，除了嵌套在另一行中的那些

> ID：12827932
> 
> 赞同：0
> 
> 时间：2012-10-10T20:36:46.420
> 
> 标签：regex, regex-negation

试图找出一种使用正则表达式将所有多行 html td 组合转换为一行的方法，除了嵌套在另一个 td 中的那些

我正在尝试在visual studio中进行查找和替换（但我可以使用wildedit等其他东西）来查找跨多行运行的所有td标签，并将它们全部放在一行上。我想删除所有退货/标签。但问题是，如果我在其中嵌套了另一个表，我不想对父 td 执行此操作。

所以例如我想改变这个：

```
<table class="Top">
    <tr>
        <td class="TopLeft">
            <img src="img/spacer.gif" class="Size">
        </td>
        <td class="TopTile">
            <img src="img/spacer.gif" class="Size">
        </td>
        <td class="TopRight">
            <img src="img/spacer.gif" class="Size">
        </td>
    </tr>
    <tr>
        <td class="LeftTile">
            &nbsp;
        </td>
        <td class="TitleBar">
            Blah Blah Blah
        </td>
        <td class="RightTile">
            &nbsp;
        </td>
    </tr>
    <tr>
        <td class="LeftTile">
            &nbsp;
        </td>
        <td>
            <table cellpadding="2" cellspacing="0" border="0" class="EntryLight">
                <tr>
                    <td class="TopLeft">
                        <img src="img/spacer.gif" class="Size">
                    </td>
                    <td class="TopTile">
                        <img src="img/spacer.gif" class="Size">
                    </td>
                    <td class="TopRight">
                        <img src="img/spacer.gif" class="Size">
                    </td>
                </tr>
                <tr>
                    <td class="LeftTile">
                        &nbsp;
                    </td>
                    <td class="TitleBar">
                        Blah Blah Blah
                    </td>
                    <td class="RightTile">
                        &nbsp;
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

进入这个：

```
<table class="Top">
    <tr>
        <td class="TopLeft"><img src="img/spacer.gif" class="Size"></td>
        <td class="TopTile"><img src="img/spacer.gif" class="Size"></td>
        <td class="TopRight"><img src="img/spacer.gif" class="Size"></td>
    </tr>
    <tr>
        <td class="LeftTile">&nbsp;</td>
        <td class="TitleBar">Blah Blah Blah</td>
        <td class="RightTile">&nbsp;</td>
    </tr>
    <tr>
        <td class="LeftTile">&nbsp;</td>
        <td>
            <table cellpadding="2" cellspacing="0" border="0" class="EntryLight">
                <tr>
                    <td class="TopLeft"><img src="img/spacer.gif" class="Size"></td>
                    <td class="TopTile"><img src="img/spacer.gif" class="Size"></td>
                    <td class="TopRight"><img src="img/spacer.gif" class="Size"></td>
                </tr>
                <tr>
                    <td class="LeftTile">&nbsp;</td>
                    <td class="TitleBar">Blah Blah Blah</td>
                    <td class="RightTile">&nbsp;</td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:17:37.817

如果您安装了 Visual Studio 2012，这适用于您的示例。这是使用 .NET 正则表达式库的第一个版本：

搜索

```
(?<=<td[^>]*>)(?>\s+)(?!<table)|(?<!</table>\s*)\s+(?=</td>) 
```

并一无所有。

**解释：**

```
(?<=        # Assert that it's possible to match...
 <td[^>]*>  # an opening <td> tag
)           # before the current position,
(?>\s+)     # then match one or more whitespace characters possessively,
(?!<table)  # but only if the next tag isn't an opening <table> tag.
|           # Or:
(?<!        # (unless we're right after...
 </table>   #  a closing </table> tag
 \s*        #  which may be followed by whitespace)
)           # then
\s+         # Match whitespace
(?=</td>)   # until the next closing </td> tag 
```

# matlab - matlab中二维矩阵的3d绘图

> ID：12827934
> 
> 赞同：7
> 
> 时间：2012-10-10T20:36:47.410
> 
> 标签：matlab, plot

我有一个 MxN 矩阵、Z 和一些变量 h。该矩阵表示函数 f(x,y) 的解的点。h 是点之间的间距。例如：

```
Z(x/h,y/h) = (some value in the Z direction), where x and y are some multiple of h 
```

域从 0 到 M*h，范围从 0 到 N*h。我想对矩阵定义的解决方案进行 3d 表示。该图应该类似于使用 pdetool 生成的图。我如何在 Matlab 中做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-10T20:40:10.633

您可以使用`surf`或`bar3`。

这是文档：

冲浪： [http ://www.mathworks.fr/help/matlab/ref/surf.html;jsessionid=c680a6b29a1fa8ff47c120353c12](http://www.mathworks.fr/help/matlab/ref/surf.html;jsessionid=c680a6b29a1fa8ff47c120353c12)

![在此处输入图像描述](../Images/9206a452755e3baa56b8de405432bad9.png)

bar3： http: [//www.mathworks.fr/fr/help/matlab/ref/bar3.html](http://www.mathworks.fr/fr/help/matlab/ref/bar3.html) ![在此处输入图像描述](../Images/9132e90b49f280fac26068b6aef76b8c.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-02T14:05:11.293

这是一个`surf`在 Matlab 中绘制二维矩阵的示例。

**代码：**

```
x_offset = [78, 216, 150, 342, 258, 336;
            168, 174, 174, 222, 150, 246;
            36, 180, 54, 138, 138, 198;
            60, -72, 90, 66, 114, 36;
            -90, -108, -60, 12, 54, -24;
            -42, -78, -138, -42, -12, -114;
            -108, -30, -108, -66, -156, -114;
            -66, -114, -114, -84, -138, -96];
figure(1), surf(x_offset);
xlabel('X'), ylabel('Y'), title('X-offset Error Distribution'); 
```

**输出：**

![在此处输入图像描述](../Images/92644b06e9a1b44520821d934fda8773.png)

# hadoop - Hadoop 和多个集群

> ID：12827935
> 
> 赞同：0
> 
> 时间：2012-10-10T20:36:47.853
> 
> 标签：hadoop

除了管理工作之外，是否有任何明确的理由不创建多个 hadoop 集群来处理不同的大数据内容？

例如 PCI hadoop 集群、安全集群和应用程序日志集群。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:24:58.040

我认为，重要的是：更好的资源利用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-06T21:17:10.530

一个集群用于所有内容的优势在于能够在所有数据中找到模式。应用程序使用模式可能适用于安全性，特别是在身份盗窃方面。

用户对每个应用程序都有一个签名行为。当该行为发生变化时，您的安全数据中是否存在相关异常？

如果您将数据视为不同的，您将永远找不到多通道模式。假装你不知道你在寻找什么，也许你会开始看到需要将数据放在一个地方。

# android - 使用意图过滤器的服务绑定

> ID：12827938
> 
> 赞同：-1
> 
> 时间：2012-10-10T20:36:59.080
> 
> 标签：android, service, android-intent

我无法使用意图过滤器将我的活动绑定到我的服务应用程序。

这是我必须连接到我的服务应用程序的片段：

```
// The connection to the service.
private ServiceConnection connection = new ServiceConnection()
{
    // When the messenger gets bound to the service.
    public void onServiceConnected(ComponentName className, IBinder binder)
    {
        Log.e(TAG, "Attached");
        messenger = new Messenger(binder);
    }

    // When the messenger gets unbound from the service.
    public void onServiceDisconnected(ComponentName className)
    {
        messenger = null;
    }
};

// Bind the service connection with the service application.
private void createServiceBinding()
{
    Log.e(TAG, "binding service.");
    activity.bindService(new Intent(this.activity, TestService.class), this.connection, Context.BIND_AUTO_CREATE);
    this.isBound = true;
} 
```

这工作只是发现。我可以使用 Messenger 发送和接收消息。但是，我需要能够使用我的服务应用程序的意图过滤器而不是 TestService.class 来调用 activity.bindService。

如何使用意图过滤器（例如 com.example.testapplication.TestService 而不是 TestService.class）将活动绑定到服务应用程序？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T21:26:50.037

> 但是，我需要能够使用我的服务应用程序的意图过滤器而不是 TestService.class 来调用 activity.bindService。

更准确地说，您*希望*能够`bindService()`使用与您的服务`Intent`相匹配的呼叫。`<intent-filter>`

除非您计划将第三方应用程序绑定到您的服务，否则请坚持您现有的方法并将其`<intent-filter>`从服务中删除。这不是必需的（如您所见），默认情况下它会导出您的服务。

> 如何使用意图过滤器（例如 com.example.testapplication.TestService 而不是 TestService.class）将活动绑定到服务应用程序？

使用不同的`Intent`构造函数，加上`Intent`对象上的其他设置器，将其配置为匹配您的`<intent-filter>`. 由于您决定不提供您的`<intent-filter>`，我们无法给您具体说明。

例如，如果您`<intent-filter>`看起来像：

```
 <intent-filter>
            <action android:name="com.troje.this.is.probably.a.bad.IDEA"/>
        </intent-filter> 
```

然后您`Intent`将通过创建`new Intent("com.troje.this.is.probably.a.bad.IDEA")`用于绑定到服务。

# java - Jersey Rest Get 带有特殊字符

> ID：12827942
> 
> 赞同：3
> 
> 时间：2012-10-10T20:37:09.913
> 
> 标签：java, rest, jersey

如何创建接受“@”符号参数的 GET 休息方法？目前它不喜欢这样，因为@ 符号。我正在传递 /resource/user/my@email.com/password

```
@Path("/user/{Email}/{Password}")
@GET
@Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
public JResponse<DtoUser> ValidateUser(@PathParam("Email") String email,@PathParam("Password") String password) {
    logger.log(Level.INFO, "Validating user {0}", email);
    IUserRepository repo =  new UserRepository();
    return JResponse.ok(repo.ValidateUser(email, password)).build();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:57:29.900

看看这个[答案](https://stackoverflow.com/a/2301004/229087)。似乎您可以在通话中使用“%40”对“@”进行编码。我希望它对你有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:56:40.623

您需要对要添加到字符串中的值进行编码。例如 @ 符号转换为 %40。

`URLEncoder.encode(string,"UTF-8");` 会将字符串编码为

```
/resource/user/my%40email.com/password 
```

这方面的更多信息可以在 jdk [http://docs.oracle.com/javase/7/docs/api/java/net/URLEncoder.html的 javadocs 中找到](http://docs.oracle.com/javase/7/docs/api/java/net/URLEncoder.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:12:00.360

请在使用 URLEncoder 类之前阅读此内容：http: [//www.subbu.org/blog/2008/02/uri-escaping-and-javaneturlencoder](http://www.subbu.org/blog/2008/02/uri-escaping-and-javaneturlencoder)

一个不错的选择是 Google 的 PercentEscaper： [http ://gdata-java-client.googlecode.com/svn/tags/2.0.0-alpha/javadoc/com/google/api/data/client/v2/escape/PercentEscaper.html](http://gdata-java-client.googlecode.com/svn/tags/2.0.0-alpha/javadoc/com/google/api/data/client/v2/escape/PercentEscaper.html)

# linux-kernel - 将物理设备映射到用户空间中的指针

> ID：12827948
> 
> 赞同：7
> 
> 时间：2012-10-10T20:37:41.773
> 
> 标签：linux-kernel, device, linux-device-driver, embedded-linux, mmap

我们有一个嵌入式系统，其中连接了内存映射设备，ARM CPU 运行 Linux。设备位于地址`0x40400000`并占用一兆字节（其中大部分没有实际内存支持，但地址空间无论如何都会映射到设备）。我们目前*没有*此设备的设备驱动程序。

在设备中，地址 有一个特殊的只读寄存器（称为 CID）`0x404f0704`。该寄存器包含值`CID = 0x404`。我正在尝试从 ARM 上运行的程序中读取此寄存器。

搜索网络我了解了`mmap()`据说可以让我从用户空间访问物理地址的功能。因此，尝试遵循我找到的几个示例，我编写了以下测试：

```
 #include <sys/mman.h>
#include <fcntl.h>
#include <err.h>
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    void          *pdev = (void *) 0x40400000;
    size_t         ldev = (1024*1024);
    int           *pu;
    int  volatile *pcid;
    int  volatile  cid;

    pu = mmap(pdev, ldev, PROT_READ|PROT_WRITE, MAP_ANONYMOUS|MAP_PRIVATE, -1, 0);
    if (pu == MAP_FAILED)
        errx(1, "mmap failure");

    pcid = (int *) (((void *) pu) + 0xf0704);

    printf("pu    = %08p\n", pu);
    printf("pcid  = %08p\n", pcid);

    cid = *pcid;
    printf("CID   = %x\n", cid);

    munmap(pu, ldev);

    return (EXIT_SUCCESS);
} 

```

使用 ARM 交叉编译器进行编译：

```
a-gcc -O0 -g3 -o mmap-test.elf mmap-test.c 
```

我无法得到预期的结果。我看到的是：

```
pu   = 0x40400000
pcid = 0x404f0704
CID  = 0 
```

而不是预期的

```
CID  = 404 
```

我在这里错过了什么/做错了什么？

* * *

**更新：**

我找到了另一个演示程序，按照它的代码，我能够让我的代码工作：

```
 int main(void)
{
    off_t          dev_base = 0x40400000;
    size_t         ldev = (1024 * 1024);
    unsigned long  mask = (1024 * 1024)-1;
    int           *pu;
    void          *mapped_base;
    void          *mapped_dev_base;
    int  volatile *pcid;
    int  volatile  cid;
    int            memfd;

    memfd = open("/dev/mem", O_RDWR | O_SYNC);
    mapped_base = mmap(0, MAP_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED, memfd, dev_base & ~MAP_MASK);
    if (mapped_base == MAP_FAILED)
        errx(1, "mmap failure");
    mapped_dev_base = mapped_base + (dev_base & MAP_MASK);
    pu = mapped_dev_base;

    pcid = (int *) (((void *) pu) + 0xf0704);

    printf("pu    = %08p\n", pu);
    printf("pcid  = %08p\n", pcid);

    cid = *pcid;
    printf("CID   = %x\n", cid);

    munmap(mapped_base, ldev);
    close(memfd);

    return (EXIT_SUCCESS);
} 

```

不过，我不太确定为什么第一个版本不起作用。我的理解是，一旦你使用`MAP_ANONYMOUS`了映射，你就不需要文件句柄。此外，我显然将*addr*参数（`pepi`在我的第一个版本中）误认为是物理地址。如果我现在是，那么这实际上是虚拟地址。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T23:44:00.167

Mmap 是通常与虚拟地址一起使用的函数。当你调用`mmap(... MAP_ANONYMOUS)`（或文件）时`mmap`，`/dev/zero`它会给你一些新的虚拟内存，用零填充。返回的地址将是虚拟内存的地址。

您可以 mmap 某个文件（不带 MAP_ANONYMOUS），然后 mmap 会将文件内容映射到某个虚拟内存范围。

> 该设备位于地址 0x40400000

设备 MMIO 位于物理内存中；任何进程都可以使用虚拟地址 0x40400000；但它们会被 MMU（内存管理单元）映射（转换）到一些空闲的物理页面。您不能只向操作系统询问一些虚拟内存并期望将其映射到设备范围（它将是地狱的变体）。

但是有一个特殊的设备，/dev/mem，它可以用作包含所有物理内存的文件。当您使用`mmap`/dev/mem 时，您实际上是在要求操作系统创建一些虚拟内存到所要求的物理范围的新映射。

在您调用 mmap 时：

```
 mapped_base = mmap(0, MAP_SIZE, PROT_READ|PROT_WRITE, 
   MAP_SHARED, memfd, dev_base & ~MAP_MASK); 
```

您要求将物理内存范围`[0x40400000 .. 0x4050000-1]`（一兆字节；不包括字节 0x40500000）映射到一些兆字节的虚拟内存（其起始地址由 mmap 返回）。

# scala - Scala Lift - 在 mongo gridfs 中删除文件

> ID：12827950
> 
> 赞同：0
> 
> 时间：2012-10-10T20:37:57.583
> 
> 标签：scala, mongodb, lift, gridfs

我正在尝试找到从 mongodb gridfs 中删除文件的正确方法。

标准查询就足够了吗？

```
record.delete_! 
```

或者有没有正确的具体方法？

在此先感谢，非常感谢任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:25:44.697

GridFS 不将文件存储为记录。GridFS 让您可以处理跨越多个文档的存储文件（以超出文档大小限制）。要删除 GridFS 中的文件，您必须使用它的 API。所以为了删除文件，你必须找到它，例如使用这种方法： [http://api.mongodb.org/java/2.9.1/com/mongodb/gridfs/GridFS.html#find(org.bson. types.ObjectId](http://api.mongodb.org/java/2.9.1/com/mongodb/gridfs/GridFS.html#find(org.bson.types.ObjectId) ) 然后，当您引用文件时，您可以将其删除。示例代码可能如下所示：

```
MongoDB.use(DefaultMongoIdentifier) { db =>
  val fs = new GridFS(db)
  fs.remove(gridFsId.is)
} 
```

gridFsId 是存储在 Lift 记录中的 ObjectId，用于保存 GridFS 中的文件句柄。我希望这会有所帮助。

# css - 使用 CSS 在圆形 DIV 中安装滚动条

> ID：12827955
> 
> 赞同：3
> 
> 时间：2012-10-10T20:38:11.670
> 
> 标签：css

尽可能具体，这里是......我正在尝试在一个圆圈内实现子导航，但是内容适合形状并且需要滚动条来解决这个问题。

尽管尝试使用 CSS 使其工作，但我现在遇到了一个问题。目前，子导航上的滚动条垂直滚动到圆圈外，内容似乎出来了。

请参阅下面的屏幕截图。子导航内容超出 div 太高，滚动条向下滚动。理想情况下，我希望内容位于突出显示的红色区域内，滚动条为蓝色。

![截屏](../Images/f12fe8827875ad032a81a7d90ffb282e.png)

滚动条的 CSS (.jb_scrollbar)：

```
.jb_scrollbar { clear: both; margin: 0px 0 10px;}
.jb_scrollbar .viewport { overflow: hidden; position: relative; }
.jb_scrollbar .overview { list-style: none; position: absolute; left: 0; top: 0; }
.jb_scrollbar .thumb .end,
.jb_scrollbar .thumb { margin: 50px 0 0 0; background-color: #ccc; }
.jb_scrollbar.scroll_y .scrollbar { position: relative; float: right; width: 10px;}
.jb_scrollbar.scroll_x .scrollbar { position: relative; height: 15px;clear:both;margin:0 0 5px;}
.jb_scrollbar.scroll_y .track { height: 100%; width:13px; position: relative; padding: 0 1px;}
.jb_scrollbar.scroll_x .track { width: 100%; height:7px; position: relative; padding: 1px 0px;}
.jb_scrollbar.scroll_y .thumb { height: 20px; width: 13px; cursor: pointer; overflow: hidden; position: absolute; top: 0; background: #d5d089;}
.jb_scrollbar.scroll_x .thumb { height: 13px; cursor: pointer; overflow: hidden; position: absolute; left: 0; background: #d5d089;}
.jb_scrollbar.scroll_y .thumb .end { overflow: hidden; height: 5px; width: 13px; background: #d5d089;}
.jb_scrollbar.scroll_x .thumb .end { overflow: hidden; width: 5px; height: 0px; background: #d5d089;}
.jb_scrollbar .disable{ display: none;} 
```

子导航 (#vertmenu) 的 CSS：

```
#vertmenu { font-family: Arial, Helvetica, sans-serif; font-size: 100%; width: 221px; height: 221px; background: url(../images/subnav_bg.png) no-repeat; margin-top: 20px; float: left;  clear: both;}
#vertmenu a.nav-path-selected{ color:#000; border-bottom: 2px solid #23b3e9; margin-bottom: -2px; }
#vertmenu a:hover{ color:#000; border-bottom: 2px solid #23b3e9; margin-bottom: -2px; }
#vertmenu ul { list-style: none; margin: 40px 0 50px 10px; border: none; float:left; height: 150px; width: 130px; }
#vertmenu ul li { margin: 0px; padding: 3px 0 3px 14px; clear: both; background: url(../images/subnav_bullet_bg.png) no-repeat left center; }
#vertmenu ul li a { font-size: 14px; line-height: 14px; text-transform: none; display: block; text-decoration: none; color: #000000;} 
```

如果您能如此友善地帮助我发现问题，将不胜感激。多年来一直在 CSS 上摸索以正确定位它。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T21:55:59.853

我不知道如何使用该滚动条插件，但这里是一个仅使用 CSS 的快速演示：http: [//jsbin.com/icelih/4/edit](http://jsbin.com/icelih/4/edit)

该插件以内联样式设置大小，并且似乎需要大量样板标记，我不得不仔细研究（令人困惑的）文档，以了解您的网站的哪些部分以及插件插入/需要哪些部分。

因此，我创建了一个独立的模型，您也许可以使用它来修复您的网站：http: [//jsbin.com/ilebaz/1/edit](http://jsbin.com/ilebaz/1/edit)

# javascript - 打开输入复选框

> ID：12827961
> 
> 赞同：0
> 
> 时间：2012-10-10T20:38:45.017
> 
> 标签：javascript, jquery, underscore.js

我正在尝试重现[http://jqueryui.com/download/的“Toggle All”功能的行为](http://jqueryui.com/download/)

当我选择“Toggle All”复选框时，我想检查同一个 div 容器中的所有输入框。相反，当我取消选择“全部切换”复选框时。

现在我成功地部分地重现了这种行为。
这是我的[http://jsfiddle.net/D2RLR/2518/](http://jsfiddle.net/D2RLR/2518/)，但我想实现一些更聪明的东西。
有什么提示吗？

```
$('.toggle input').click(function () {
    var weekdays;
    for (var i = 0 ; i < 7; i++) {
        weekdays = $('#contest_data_updatePeriodicity_days_' + i);
        weekdays.prop("checked", this.checked);
    }
}); 
```

PS 我可以使用 jquery 或下划线

1）我想使用`contest_data_updatePeriodicity_days_`选择器
2）当我选择 div 容器的所有工作日时，如果不是，则应选中“Toggle All”复选框。相反，当我取消选择所有字段时。

[http://jsfiddle.net/D2RLR/2518/](http://jsfiddle.net/D2RLR/2518/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T20:41:53.667

代替

```
weekdays.prop("checked", true); 
```

尝试这个

```
weekdays.prop("checked", this.checked); 
```

**[演示](http://jsfiddle.net/D2RLR/2518/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T20:42:14.750

尝试使用`.closest`获取父 div，然后使用`this.checked`切换状态。

**固定演示：http:** [//jsfiddle.net/D2RLR/2530/](http://jsfiddle.net/D2RLR/2530/)

```
$(this)
  .closest('.control-group')
  .find(':checkbox')
  .prop("checked", this.checked); 
```

你也错过了`<label class="toggle`对照`Toggle All Hours`组。修复下面的html，

```
<label class="toggle">
   <input type="checkbox" class="ui-widget-content"> Toggle All Hours
</label> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T20:45:04.263

Or this, everyone has their own answer, but I think this is short and sweet:

EDIT: or event simple using a combination of Tats_innit's answer - [http://jsfiddle.net/D2RLR/2534/](http://jsfiddle.net/D2RLR/2534/)

```
$('.toggle input').click(function () {
    $(this).parents('div.control-group').find('input').attr("checked", this.checked);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T20:41:18.533

试试这个请**演示****更新** [http://jsfiddle.net/VqLfz/](http://jsfiddle.net/VqLfz/) **或** [http://jsfiddle.net/UPWt4/](http://jsfiddle.net/UPWt4/)

让 JQ 为您完成所有工作：`this.checked`用于布尔检查。

希望它适合这种情况`:)`

**代码**

**新的**

```
$('.toggle input').click(function () {

    var foo = this.checked;
    $(this).parent().parent().find(':input').each(function(){ 
        $(this).prop("checked", foo);
    });
});

​ 
```

**老的**

```
$('.toggle input').click(function () {
    var weekdays;
    for (var i = 0 ; i < 7; i++) {
        weekdays = $('#contest_data_updatePeriodicity_days_' + i);
        weekdays.prop("checked", this.checked);
    }
});

​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T20:49:03.997

修改[jsfiddle](http://jsfiddle.net/D2RLR/2546/)。：您错过了在切换小时复选框之前添加。

```
$('.toggle input').click(function () {
 $(this).parents('div:first').find("input:checkbox").not(this).prop("checked",              $(this).prop("checked")); 
```

});

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-10T21:23:35.960

使用`.change`工作日复选框上的事件来检测它们何时全部/未选中，然后设置切换复选框的选中状态

[jsfiddle 示例](http://jsfiddle.net/D2RLR/2564/)（[全屏](http://jsfiddle.net/D2RLR/2564/show)）

```
var $checkBoxToggle = $('.toggle [type=checkbox]'),
    $checkBoxDays = $('#contest_data_updatePeriodicity_days [type=checkbox]'),
    checkBoxDaysCount = $checkBoxDays.length;

$checkBoxToggle.change(function() {
    $checkBoxDays.prop('checked', this.checked);
});

$checkBoxDays.change(function() {
    var daysChecked = $checkBoxDays.filter(':checked').length;
    switch(daysChecked)
    {
        case 0:
            $checkBoxToggle.prop('checked', false);
            break;
        case checkBoxDaysCount:
            $checkBoxToggle.prop('checked', true);
            break;
        default:
            break;
    }
});​ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-10T21:13:09.000

另一种方法不依赖于将“全部切换”复选框包含在与要切换的容器相同的容器中。它更灵活，而且工作量稍微多一点：

```
$.fn.toggleAll = function(selector) {
    return this.each(function() {
        $(this).click(function() {
            $(selector).filter(':checkbox').prop('checked', this.checked);
        });
    });
};
$('#all-days').toggleAll('[id^=contest_data_updatePeriodicity_days_]');
$('#all-hours').toggleAll('[id^=contest_data_updatePeriodicity_hours_]'); 
```

[（这会跳过一些您可能应该做的错误检查。）您可以在http://jsfiddle.net/CrossEye/W7c9L/](http://jsfiddle.net/CrossEye/W7c9L/)上看到这一点

# php - zf2 多个模块互相工作？

> ID：12827964
> 
> 赞同：0
> 
> 时间：2012-10-10T20:38:49.003
> 
> 标签：php, logic, zend-framework2, zend-framework-modules

假设我们有一个核心模块，它有一个 AdminController

另一个名为 gallery 的模块也有一个 AdminController

我如何使画廊模块管理区域与核心模块的 AdminController 一起使用

或任何其他可能的逻辑解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T07:02:57.320

您正在描述[ZfcAdmin](https://github.com/juriansluiman/ZfcAdmin)模块背后的想法。Jurian 甚至写了一个[RFC](https://github.com/ZF-Commons/RFC/wiki/RFC%3a-ZfcAdmin)。

关于需要什么的一些想法：

您需要做的是在您的子模块中，将路由添加到管理模块的路由树。ZF2 中的路由是基于树的，因此您可以从任何模块添加到它们。由于 ModuleManager 所做的配置合并，这成为可能。

您还需要您的管理模块来提供您的子模块可以添加到的根导航配置。

最后，您需要整理布局。最简单的方法是通过管理模块上的侦听器检查路由以查看它是否在管理树中。如果是这样，它将设置管理布局。

# python - 从 pylab 中使用 ion() 会导致 matplotlib 挂起

> ID：12827969
> 
> 赞同：0
> 
> 时间：2012-10-10T20:39:09.847
> 
> 标签：python, matplotlib, ipython

我正在使用 Enthought 的 Mac 32 位 python 发行版。

如果我尝试：

```
$ ipython
In [1] from pylab import *
In [2] ion()
In [3] plot([1,2],[1,2]) 
```

该图已创建，但 python 在尝试绘图时冻结。

我做错了什么还是这是一个错误？

通过运行进行绘图`ipython --pylab`工作正常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T21:38:09.713

我正在使用“WXAgg”后端，然后切换到“macosx”，这似乎解决了问题

```
In [1]: import matplotlib

In [2]: matplotlib.get_backend()
Out[2]: 'WXAgg'

In [3]: matplotlib.use('macosx')

In [4]: matplotlib.get_backend()
Out[4]: 'MacOSX'

In [5]: from pylab import *

In [6]: ion()

In [7]: plot([1,2]) # now works fine 
```

# c++ - 无法在继承进程中读取文件

> ID：12827973
> 
> 赞同：0
> 
> 时间：2012-10-10T20:39:16.040
> 
> 标签：c++, file, winapi, systems-programming

我正在尝试在继承进程中读取文件，我通过命令行传递的文件句柄是有效的，但`GetFileSize(HANDLE,LPDWORD)`返回`0`.

```
#include"mainClass.h"

MainClass* MainClass::ptr = NULL;

MainClass::MainClass()
{
    ptr = this;
}
BOOL CALLBACK MainClass::DlgProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    switch(uMsg)
    {
        HANDLE_MSG(hwnd,WM_CLOSE,ptr->OnClose);
        HANDLE_MSG(hwnd,WM_COMMAND,ptr->OnCommand);
        HANDLE_MSG(hwnd,WM_INITDIALOG,ptr->OnInitDialog);
    }
    return false;
}

BOOL MainClass::OnInitDialog(HWND hwnd, HWND hwndFocus, LPARAM lParam)
{
    SECURITY_ATTRIBUTES sa = {sizeof(SECURITY_ATTRIBUTES),0,true};

    hFile = CreateFile(_T("D:/mutex.txt"),GENERIC_READ,0,&sa,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);

    return true;
}

void MainClass::OnClose(HWND hwnd)
{
    DestroyWindow(hwnd);
    PostQuitMessage(0);
}

void MainClass::OnCommand(HWND hwnd, int id, HWND hwndCtl, UINT codeNotify)
{

    if(codeNotify == BN_CLICKED)
    {
        if(id == IDC_BUTTON_READ_ENCRYPT)
        {
            TCHAR* cmd = new TCHAR[100];
            _stprintf(cmd,_T("readFromFile.exe %d"),(int)hFile);

            STARTUPINFO si = {sizeof(STARTUPINFO)};
            PROCESS_INFORMATION pi = {0};

            if(CreateProcess(NULL,cmd,NULL,NULL,true,NULL,NULL,NULL,&si,&pi))
            {
                //CloseHandle(hFile);
                //CloseHandle(pi.hThread);
                //CloseHandle(pi.hProcess);
            }

            delete[]cmd;
        }
    }
} 
```

继承进程是控制台应用程序：

```
#include<windows.h>
#include<stdio.h>
#include<conio.h>
#include<tchar.h>

PTSTR buf;
HANDLE hFile;

void main()
{
    int s = 100;
    buf = new TCHAR[s];
    TCHAR* temp = buf;

    _tcscpy(buf,GetCommandLine());

    while(*buf++ != _T(' '));

    hFile = (HANDLE)_ttoi(buf); 
    _tprintf(_T("%d\n"),(int)hFile);
    getch();

    buf = temp;
    delete[]buf;

    if(hFile == INVALID_HANDLE_VALUE)
    {
        MessageBox(NULL,_T("file handle invalid"),_T("Error"),NULL);
        return;
    }

    DWORD fileSize;
    GetFileSize(hFile,&fileSize);

    _tprintf(_T("%d\n"),(int)fileSize);
    getch();

    if(!fileSize)
    {
        MessageBox(NULL,_T("file is empty"),_T(""),NULL);
        return;
    }

    buf = new TCHAR[fileSize/sizeof(TCHAR)+1];
    DWORD wasRead;

    ReadFile(hFile,buf,fileSize,&wasRead,NULL);

    _tprintf(buf);

    if(buf)
        delete[]buf;
    getch();
} 
```

这里有什么问题，请帮助:)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T20:46:55.213

`GetFileSize`需要处理大于 4GB 的文件，因此它应该能够使用`long long`或`int64_t`但在通常用于 32 位整数值的 Windows API`int64_t`中，因此此函数返回低位 32 位结果作为返回值，并且仅返回高位 32 位结果在第二个参数中，您的文件小于 4GB，因此它的高 32 位始终为 0。所以使用`fileSize = GetFileSize(hFile, NULL)`并且一切都按预期工作

# ios - 以编程方式将标签/字符串添加到 UITableView，如 iPhone 设置中所示

> ID：12827975
> 
> 赞同：0
> 
> 时间：2012-10-10T20:39:16.723
> 
> 标签：ios, uitableview

我有一个应用程序，其中几个表格完全分开，就像在 iPhone 上的设置中看到的那样。我想添加一个显示在这个标签中的值，就像在设置 Wi-Fi 或蓝牙中看到的一样，在右边你有你的项目，在左边显示一个值。我怎样才能做到这一点？

设置.h

```
@interface Setting : NSObject {

NSString *_settingsID;
NSString *_catalogID;
NSString *_category;
NSString *_facings;
NSString *_quantity;
}

@property (nonatomic, retain) NSString *settingsID;
@property (nonatomic, retain) NSString *catalogID;
@property (nonatomic, retain) NSString *category;
@property (nonatomic, retain) NSString *facings;
@property (nonatomic, retain) NSString *quanity;

- (Setting *)initWithName:(NSString *)settingsID desc:(NSString *)category CategoryID:(NSString *)catalogID Facings:(NSString *)facings Quantity:(NSString *)quantity;

@end 
```

设置.m

```
@implementation Setting

@synthesize settingsID = _settingsID;
@synthesize catalogID = _catalogID;
@synthesize category = _category;
@synthesize facings = _facings;
@synthesize quanity = _quantity;

- (Setting *)initWithName:(NSString *)settingsID desc:(NSString *)category CategoryID:(NSString *)catalogID Facings:(NSString *)facings Quantity:(NSString *)quantity {

if ((self = [super init])) {

    self.settingsID = settingsID;
    self.catalogID = catalogID;
    self.category = category;
    self.facings = facings;
    self.quanity = quantity;
}

return self;

}

@end 
```

接下来在我的 connectionDidFinishLoading 中，我从 JSON 调用中获取了我的 WebAPI 的结果，并填充了这个 Setting 对象......

```
-(void) connectionDidFinishLoading:(NSURLConnection *)connection {

self.settings = [NSMutableArray array];

NSError *error = nil;

id result = [NSJSONSerialization JSONObjectWithData:receivedData options:kNilOptions error:&error];

if ([result isKindOfClass:[NSArray class]]) {

    for (NSDictionary *item in result) {

        NSString *settingsID = [item objectForKey:@"ID"];
        NSString *category = [item objectForKey:@"Category"];
        NSString *categoryID = [item objectForKey:@"CatalogID"];
        NSString *facings = [item objectForKey:@"Facings"];
        NSString *quantity = [item objectForKey:@"Quantity"];

        Setting *setting = [[Setting alloc] initWithName:settingsID desc:category CategoryID:categoryID Facings:facings Quantity:quantity];

        [self.settings addObject:setting];

    }
}

for (Setting *item in self.settings) {

    NSString *frozen = @"Frozen";
    BOOL res = [frozen isEqualToString:item.category];

    if (res == TRUE) {

        **NSLog(@"Original Value: %@, Bool Value: %@", item.facings, item.facings.boolValue == false ? @"No" : @"Yes");
        NSLog(@"Original Value: %@, Bool Value: %@", item.quantity, item.quantity.boolValue == false ? @"No" : @"Yes");
        // Frozen
        appDelegate.frozen_facing_value = item.facings.boolValue == false ? @"No" : @"Yes";
        appDelegate.frozen_quantity_value = item.quantity.boolValue == false ? @"No" : @"Yes";**
    }

    NSString *fruit = @"Fruit";
    res = [fruit isEqualToString:item.category];

    if (res == TRUE) {

        // Fruit
    }

    NSString *salads = @"Salads";
    res = [salads isEqualToString:item.category];

    if (res == TRUE) {

        // Salads
    }

    NSString *vegetables = @"Vegetables";
    res = [vegetables isEqualToString:item.category];

    if (res == TRUE) {

        // Vegetables
    }
}

NSLog(@"Finished..");
finished = TRUE;
} 
```

![当页面第一次加载...](../Images/e12c64c5189de3d5b1249df699479684.png)

![在我拉下 UI 以使 cellFroRowAtIndexPath 函数再次触发之后......](../Images/6b4c4db5304ff0d12710f8ba8e865602.png)

我在 AppDelegate.h 中合成了我的 selected_value 并使用它来存储用户单击的单元格的值。

```
@interface AppDelegate : UIResponder <UIApplicationDelegate> {    
NSString *_selected_value;
**NSString *_frozen_facing_value;**
}

@property (strong, nonatomic) UIWindow *window;

@property (strong, nonatomic) UINavigationController *navigationController;

@property (nonatomic, retain) NSString *selected_value;

**@property (nonatomic, retain) NSString *frozen_facing_value;**

@end 
```

AppDelegate.m

这是我的 cellForRowAtIndexPath

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
UITableViewCell *result = nil;

if ([tableView isEqual:self.myTableView]){

    static NSString *CellIdentifier = @"CellIdentifier";

    result = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (result == nil){
        result = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier];
    }

    NSMutableArray *sectionArray = [self.arrayOfSections objectAtIndex:indexPath.section];

    result.textLabel.text = [sectionArray objectAtIndex:indexPath.row];

    NSString *res = (NSString *)result.textLabel.text;

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    if ([[self tableView:tableView titleForHeaderInSection:indexPath.section] isEqualToString:@"Frozen"]) {

        if ([res isEqualToString:FACINGS]) {

           **result.detailTextLabel.text = appDelegate.frozen_facing_value;**

        } else if ([res isEqualToString:QUANTITY]) {

           result.detailTextLabel.text = @"Yes 2";
        }

    } else if ([[self tableView:tableView titleForHeaderInSection:indexPath.section] isEqualToString:@"Fruit"]) {

        if ([res isEqualToString:FACINGS]) {

            result.detailTextLabel.text = @"No 3";

        } else if ([res isEqualToString:QUANTITY]) {

            result.detailTextLabel.text = @"Yes 4";
        }

    } else if ([[self tableView:tableView titleForHeaderInSection:indexPath.section] isEqualToString:@"Salads"]) {

        if ([res isEqualToString:FACINGS]) {

            result.detailTextLabel.text = @"No 5";

        } else if ([res isEqualToString:QUANTITY]) {

            result.detailTextLabel.text = @"Yes 6";
        }

    } else if ([[self tableView:tableView titleForHeaderInSection:indexPath.section] isEqualToString:@"Vegetables"]) {

        if ([res isEqualToString:FACINGS]) {

            result.detailTextLabel.text = @"No 7";

        } else if ([res isEqualToString:QUANTITY]) {

            result.detailTextLabel.text = @"Yes 8";
        }
    }

    appDelegate.selected_value = result.detailTextLabel.text;

    result.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
}

return result;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

NSMutableArray *sectionArray = [self.arrayOfSections objectAtIndex:indexPath.section];

NSLog(@"Select value: %@", appDelegate.selected_value);

appDelegate.selectedSetting = [[NSString alloc] initWithFormat:@"Select value: %@ for %@, in section: %@", @"Test", [sectionArray objectAtIndex:indexPath.row], [self tableView:tableView titleForHeaderInSection:indexPath.section]];

[tableView deselectRowAtIndexPath:indexPath animated:YES];

SettingsViewController *settings = [[SettingsViewController alloc] initWithNibName:@"Settings" bundle:[NSBundle mainBundle]];

[self.navigationController pushViewController:settings animated:YES];
} 
```

在我的日志窗口中，除非我向下滚动，否则我会看到“选择值：是 6”。呈现给表格的最后一个值是我最终看到的。我知道有更好的方法可以做到这一点，我只是不知道如何。想法/建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T23:12:30.293

您需要使用 UITableViewCellStyleValue1 样式设置表格视图单元格。这是设置应用程序中用于显示黑色标题和蓝色值的类型。

使用 titleLabel 为单元格设置标题，并使用单元格的 detailTextLabel 属性设置右侧的值。

在文档中查找 UITableViewCell 和 initWithStyle:reuseIdentifier: 方法。

# box-api - 如何获取当前 Box 用户的信息？

> ID：12827976
> 
> 赞同：1
> 
> 时间：2012-10-10T20:39:21.800
> 
> 标签：box-api

有没有办法检索当前登录的 Box 用户的`user`对象？

我主要关心企业管理员帐户，其中`/users`端点被记录为返回所有用户。我如何知道这些用户中的哪一个是提出请求的用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T00:01:30.120

对于 V2 API，用户可以在 /users 上调用 GET，您将自己恢复。

```
{
    "total_count": 1,
    "entries": [
        {
            "type": "user",
            "id": "13243406",
            "name": "Robert Stark",
            "login": "rstark@winterfell.com",
            "created_at": "2011-08-24T14:00:25-07:00",
            "modified_at": "2012-10-10T04:32:24-07:00",
            "role": "user",
            "language": "en",
            "space_amount": 53687091200,
            "space_used": 48671461,
            "max_upload_size": 104857600,
            "tracking_codes": [],
            "see_managed_users": false,
            "sync_enabled": true,
            "status": "active",
            "job_title": "",
            "phone": "",
            "address": "",
            "avatar_url": "https://api.box.com/api/avatar/large/13243406"
        }
    ]
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-02T10:25:23.487

您可以使用 /users/me 端点来获取有关当前用户的信息。

[获取当前用户信息](https://docs.box.com/reference#get-the-current-users-information)

```
curl https://api.box.com/2.0/users/me
-H "Authorization: Bearer ACCESS_TOKEN" 
```

```
200
{
    "type": "user",
    "id": "17738362",
    "name": "sean rose",
    "login": "sean@box.com",
    "created_at": "2012-03-26T15:43:07-07:00",
    "modified_at": "2012-12-12T11:34:29-08:00",
    "language": "en",
    "space_amount": 5368709120,
    "space_used": 2377016,
    "max_upload_size": 262144000,
    "status": "active",
    "job_title": "Employee",
    "phone": "5555555555",
    "address": "555 Office Drive",
    "avatar_url": "https://app.box.com/api/avatar/large/17738362"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T22:50:16.007

在 Auth 过程中发生的 get_auth_token 调用中返回有关当前用户的信息。请参阅[身份验证下的步骤 4](http://developers.box.com/get-started/#authenticating)：

```
<response>
  <status>get_auth_token_ok</status>
  <auth_token>yv9usmcmbnfhtx2y8rmlvk1csnoz65oo</auth_token>
  <user>
    <login>joe@example.com</login>
    <email>joe@example.com</email>
    <access_id>31313825</access_id>
    <user_id>31313825</user_id>
    <space_amount>5361200</space_amount>
    <space_used>47477</space_used>
    <max_upload_size>104800</max_upload_size>
    <sharing_disabled/>
  </user>
</response> 
```

# sql-server - 如何从 VS 2012 数据库项目创建部署脚本？

> ID：12827977
> 
> 赞同：12
> 
> 时间：2012-10-10T20:39:22.907
> 
> 标签：sql-server, deployment, visual-studio-2012, sql-server-data-tools

使用 VS2010 数据库项目，我可以定义目标（或不）数据库，设置操作（仅创建脚本或创建脚本并部署到目标），执行“部署”（通过 VS 或 MSBuild）并获得结果脚本。

我从未使用过“创建和部署”操作，因为我只使用生成的脚本来构建安装程序，并且稍后会在安装过程中应用该脚本。

此功能允许我创建升级（仅自上一个版本以来的更改）或完整安装脚本（如果没有指向目标数据库）。

通常在使用 VS 2012 或 SSDT 时，我似乎找不到正确的选项组合来重现此“仅脚本”行为以进行升级和完整安装。

我发现[这个](https://stackoverflow.com/q/10032213/16391)问题涵盖了如何单击 VS 中的按钮，但它没有解决如何在 MSBuild 中完成此操作。

有人可以为我指出这个特定配置的有用资源吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-11T14:20:59.270

After hacking at it for several hours, I was able to get something workable. It comes down to two significant elements: getting a correct publish xml, and the correct arguments for MSBuild.

The publish xml file was the standard format that was created with VS. It looks like something this...

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <IncludeCompositeObjects>True</IncludeCompositeObjects>
    <TargetDatabaseName>BLANK</TargetDatabaseName>
    <DeployScriptFileName>DeployTarget.sql</DeployScriptFileName>
    <TargetConnectionString>Data Source=SERVER;Integrated Security=True;Pooling=False</TargetConnectionString>
    <ProfileVersionNumber>1</ProfileVersionNumber>
    <ScriptDatabaseOptions>False</ScriptDatabaseOptions>
    <BlockOnPossibleDataLoss>True</BlockOnPossibleDataLoss>
    <CommentOutSetVarDeclarations>False</CommentOutSetVarDeclarations>
  </PropertyGroup>
</Project> 
```

With the previous project format, you could leave Target DB and connection string blank and it would generate a "complete" deployment script. However in SSDT sqlproj files, you must provide something, even if its incorrect, hence the "BLANK" database name. If I change this to an actual database, it would produce a delta script.

```
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe /p:Configuration=Release;Platform=AnyCPU;SqlPublishProfilePath="<fullPathToPublishXML";UpdateDatabase=False /t:Rebuild,Publish "<fullPathToSqlProj>" 
```

This still does not honor the DeployScriptFileName that is in the publish xml (It creates a sql file with the same name as the publish profile), but does appear to create the correct content in the file.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-09T12:24:20.867

你在正确的轨道上，但你缺少一个参数。如果要提供脚本名称，则应在 msbuild 执行中使用以下参数：

```
/p:PublishScriptFileName=[your output script.sql] 
```

# ruby-on-rails - 安装 ruby 1.9.3-p194 时遇到问题

> ID：12827979
> 
> 赞同：5
> 
> 时间：2012-10-10T20:39:36.337
> 
> 标签：ruby-on-rails, rvm

我在另一台机器上对我的应用程序进行了一些编辑，我在 heroku 上部署到生产环境，这导致了一些错误，现在我突然在我的主机上遇到了一堆错误。

根据命令行，我的问题是我没有安装 ruby​​ 1.9.3-p194。我不确定我能做些什么来解决这个问题。

```
$ rvm install ruby-1.9.3-p194
No binary rubies available for: osx/10.7/x86_64/ruby-1.9.3-p194.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.

Installing Ruby from source to: /Users/glider/.rvm/rubies/ruby-1.9.3-p194, this may take a while depending on your cpu(s)...
ruby-1.9.3-p194 - #downloading ruby-1.9.3-p194, this may take a while depending on your connection...
ruby-1.9.3-p194 - #extracted to /Users/glider/.rvm/src/ruby-1.9.3-p194 (already extracted)
ruby-1.9.3-p194 - #configuring
Error running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/glider/.rvm/usr/lib ./configure --enable-shared --disable-install-doc --prefix=/Users/glider/.rvm/rubies/ruby-1.9.3-p194',
please read /Users/glider/.rvm/log/ruby-1.9.3-p194/configure.log
There has been an error while running configure. Halting the installation. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T07:18:30.917

如果您使用 railsinstaller.org 安装了 rails，/etc/rvmrc 中有一个错误。打开该文件并将定义 rvm_configure_env 的单个字符串更改为三个单独的字符串。

这是带有错误的默认代码：

```
rvm_configure_env=('LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include  CPATH=/opt/sm/pkg/active/include') 
```

这是更正后的代码：

```
rvm_configure_env=('LDFLAGS=-L/opt/sm/pkg/active/lib' 'CFLAGS=-I/opt/sm/pkg/active/include' 'CPATH=/opt/sm/pkg/active/include') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T22:23:59.473

我在使用 rvm 安装 ruby​​ 1.9.3 时遇到了类似的问题。我最初使用 Rails 安装程序安装了 ruby​​ 和 rails。这个神奇的软件使用 SM 框架来管理 ruby​​ 和 rails 所需的所有本机库。它通过修改 LDFLAGS 和 CFLAGS 来实现。

您可以从您的错误运行中看到这一点。

我通过从 OSX 中删除 SM 解决了这个问题

```
rm -rf /opt/sm 
rm /etc/rvmrc
rm /etc/profile.d/sm.sh 
```

还从文件 /etc/profile 中删除源 sm.sh 的行，然后整理所有 .bashrc、.bash_profile、.zshrc 等。

然后尝试 rvm install ruby​​ .. 瞧！作品

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T17:13:13.377

查看您遇到的其他错误会有所帮助，但我还建议您重新安装 RVM，每：[https ://stackoverflow.com/a/12851198/1019369](https://stackoverflow.com/a/12851198/1019369)

我最近买了一台新机器，当我把所有数据都带过来时，遇到了一堆 RVM 问题。卸载并重新安装 RVM 就可以了。

# ruby-on-rails - 在这种情况下，为什么我需要指定 id 而不仅仅是 ActiveRecord 对象作为参数？

> ID：12827985
> 
> 赞同：1
> 
> 时间：2012-10-10T20:40:15.040
> 
> 标签：ruby-on-rails, activerecord

根据我对 Ruby on Rails 和 ActiveRecord 的理解，当参数查找 ID 时，我可以使用 ActiveRecord 模型本身而不是其 ID。例如，如果我有一个`Foo`模型，`belongs_to`一个`Bar`模型，那么我可以写`bar = Bar.new(foo_id: foo)`而不是`bar = Bar.new(foo_id: foo.id)`. 但是，在我现在制作的模型中（用于围棋游戏应用程序），情况似乎并非如此。

以下是模型中的相关代码：

```
class User < ActiveRecord::Base
  .
  .
  .
  has_many :participations, dependent: :destroy
  has_many :games, through: :participations
end

class Game < ActiveRecord::Base
  attr_accessible :height, :width

  has_many  :participations, dependent: :destroy
  has_many  :users, through: :participations

  def black_player
    self.users.joins(:participations).where("participations.color = ?", false).first
  end

  def white_player
    self.users.joins(:participations).where("participations.color = ?", true).first
  end
end

class Participation < ActiveRecord::Base
  attr_accessible :game_id, :user_id, :color

  belongs_to :game
  belongs_to :user

  validates_uniqueness_of :color, scope: :game_id
  validates_uniqueness_of :user_id, scope: :game_id
end 
```

（颜色是一个布尔值，其中 false=black，true=white）

如果我创建了两个`Users`( `black_player`id=1) 和`white_player`(id=2) 和 a `Game` `game`，我可以这样做：

```
game.participations.create(user_id: black_player, color: false) 
```

并且`game.participations`都`black_player.participations`显示了这个新的`Participation`：

```
=> #<Participation id: 1, game_id: 1, user_id: 1, color: false, created_at: "2012-10-10 20:07:23", updated_at: "2012-10-10 20:07:23"> 
```

但是，如果我再尝试：

```
game.participations.create(user_id: white_player, color: true) 
```

那么新的`Participation`有一个`user_id`1（black_player 的 id）。当我在同一个游戏中针对重复玩家进行验证时，这不是有效的`Participation`并且不会添加到数据库中：

```
=> #<Participation id: nil, game_id: 1, user_id: 1, color: true, created_at: nil, updated_at: nil> 
```

但是，如果我这样做：

```
game.participations.create(user_id: white_player.id, color: true) 
```

然后它确实有效：

```
=> #<Participation id: 2, game_id: 1, user_id: 2, color: true, created_at: "2012-10-10 20:34:03", updated_at: "2012-10-10 20:34:03"> 
```

这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T20:58:10.913

似乎任何直接传递给 :belongs_to 子对象的父对象都被转换为布尔值，因此导致 id 为 1。解决方案之一是先启动对象，然后在保存之前直接设置父对象：

```
@participation = Participation.new
@participation.game = @game
@participation.user = @user
@participation.color = false
@participation.save 
```

其他方法是传递 ID 而不是对象，就像你现在做的那样。

> 编辑：情况并非如此，留下信息：

尝试使用`user`而不是`user_id`：

```
game.participations.create(user: white_player, color: true) 
```

我认为可能发生的事情是它试图从您的用户对象中得出一个整数，因为您明确指定了列名而不是关系。`"#<User:0x107f8a2f2584e0>"`然后变为 1 或它在字符串中找到的任何第一个有效数字，您可以尝试它`User.find(2).to_s.to_i`应该在您的情况下返回 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T03:33:36.173

ActiveRecord 将为您处理关联。但是，我可以从上面的代码中解决 2 个问题。首先，您正在尝试将对象“用户”分配给属性“用户 ID”。其次，对于 Participation 类的实例，该“用户”不可用于 mass_assignment。通过将哈希传递给创建调用来为对象分配属性，称为“mass_assignment”，黑客可以使用它来分配您可能也不想要的属性。出于这个原因，rails 提供了“attr_accessible”方法。您必须明确声明允许用户在“mass_assignment”期间设置的属性，方法是将它们作为符号传递给类定义中的“attr_accessible”方法。

```
attr_accessible :game, :user, :color 
```

现在你可以

```
game.participations.create(:user => my_player_object) 
```

请注意，如果您仍想在某些情况下分配“Id”，则还必须将其传递给 attr_accessible

```
attr_accessible :game, :user, :color, :game_id, :user_id 
```